Released RMPR*3*129 SEQ #105
Extracted from mail message
**KIDS**:RMPR*3.0*129^

**INSTALL NAME**
RMPR*3.0*129
"BLD",6246,0)
RMPR*3.0*129^PROSTHETICS^0^3060928^y
"BLD",6246,1,0)
^^6^6^3060822^
"BLD",6246,1,1,0)
1. 2421 FORM filing DELIVER TO and DELIVER TO ATTENTION in files 660 and 
"BLD",6246,1,2,0)
   664 incorrectly.
"BLD",6246,1,3,0)
 
"BLD",6246,1,4,0)
2. Full SSNs still visible in regular 2421
"BLD",6246,1,5,0)
 
"BLD",6246,1,6,0)
3. RMPRPFC missing tag 'EN' in XDRMERG0 process
"BLD",6246,4,0)
^9.64PA^^
"BLD",6246,6.3)
2
"BLD",6246,"ABPKG")
n
"BLD",6246,"INIT")
RMPR129P
"BLD",6246,"KRN",0)
^9.67PA^8989.52^19
"BLD",6246,"KRN",.4,0)
.4
"BLD",6246,"KRN",.401,0)
.401
"BLD",6246,"KRN",.402,0)
.402
"BLD",6246,"KRN",.403,0)
.403
"BLD",6246,"KRN",.5,0)
.5
"BLD",6246,"KRN",.84,0)
.84
"BLD",6246,"KRN",3.6,0)
3.6
"BLD",6246,"KRN",3.8,0)
3.8
"BLD",6246,"KRN",9.2,0)
9.2
"BLD",6246,"KRN",9.8,0)
9.8
"BLD",6246,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",6246,"KRN",9.8,"NM",1,0)
RMPR129P^^0^B3472131
"BLD",6246,"KRN",9.8,"NM",2,0)
RMPRP21^^0^B30821456
"BLD",6246,"KRN",9.8,"NM",3,0)
RMPR21A^^0^B42409806
"BLD",6246,"KRN",9.8,"NM",4,0)
RMPR21B^^0^B11589475
"BLD",6246,"KRN",9.8,"NM",5,0)
RMPR21C^^0^B9637594
"BLD",6246,"KRN",9.8,"NM","B","RMPR129P",1)

"BLD",6246,"KRN",9.8,"NM","B","RMPR21A",3)

"BLD",6246,"KRN",9.8,"NM","B","RMPR21B",4)

"BLD",6246,"KRN",9.8,"NM","B","RMPR21C",5)

"BLD",6246,"KRN",9.8,"NM","B","RMPRP21",2)

"BLD",6246,"KRN",19,0)
19
"BLD",6246,"KRN",19.1,0)
19.1
"BLD",6246,"KRN",101,0)
101
"BLD",6246,"KRN",409.61,0)
409.61
"BLD",6246,"KRN",771,0)
771
"BLD",6246,"KRN",870,0)
870
"BLD",6246,"KRN",8989.51,0)
8989.51
"BLD",6246,"KRN",8989.52,0)
8989.52
"BLD",6246,"KRN",8994,0)
8994
"BLD",6246,"KRN","B",.4,.4)

"BLD",6246,"KRN","B",.401,.401)

"BLD",6246,"KRN","B",.402,.402)

"BLD",6246,"KRN","B",.403,.403)

"BLD",6246,"KRN","B",.5,.5)

"BLD",6246,"KRN","B",.84,.84)

"BLD",6246,"KRN","B",3.6,3.6)

"BLD",6246,"KRN","B",3.8,3.8)

"BLD",6246,"KRN","B",9.2,9.2)

"BLD",6246,"KRN","B",9.8,9.8)

"BLD",6246,"KRN","B",19,19)

"BLD",6246,"KRN","B",19.1,19.1)

"BLD",6246,"KRN","B",101,101)

"BLD",6246,"KRN","B",409.61,409.61)

"BLD",6246,"KRN","B",771,771)

"BLD",6246,"KRN","B",870,870)

"BLD",6246,"KRN","B",8989.51,8989.51)

"BLD",6246,"KRN","B",8989.52,8989.52)

"BLD",6246,"KRN","B",8994,8994)

"BLD",6246,"QUES",0)
^9.62^^
"BLD",6246,"REQB",0)
^9.611^2^2
"BLD",6246,"REQB",1,0)
RMPR*3.0*90^2
"BLD",6246,"REQB",2,0)
RMPR*3.0*62^2
"BLD",6246,"REQB","B","RMPR*3.0*62",2)

"BLD",6246,"REQB","B","RMPR*3.0*90",1)

"INIT")
RMPR129P
"MBREQ")
0
"PKG",101,-1)
1^1
"PKG",101,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",101,20,0)
^9.402P^^0
"PKG",101,22,0)
^9.49I^1^1
"PKG",101,22,1,0)
3.0^2960209^2960214
"PKG",101,22,1,"PAH",1,0)
129^3060928
"PKG",101,22,1,"PAH",1,1,0)
^^6^6^3060928
"PKG",101,22,1,"PAH",1,1,1,0)
1. 2421 FORM filing DELIVER TO and DELIVER TO ATTENTION in files 660 and 
"PKG",101,22,1,"PAH",1,1,2,0)
   664 incorrectly.
"PKG",101,22,1,"PAH",1,1,3,0)
 
"PKG",101,22,1,"PAH",1,1,4,0)
2. Full SSNs still visible in regular 2421
"PKG",101,22,1,"PAH",1,1,5,0)
 
"PKG",101,22,1,"PAH",1,1,6,0)
3. RMPRPFC missing tag 'EN' in XDRMERG0 process
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","RMPR129P")
0^1^B3472131^n/a
"RTN","RMPR129P",1,0)
RMPR129P ;VMP/RB - POST INIT FOR PACKAGE FILE (#9.4) UPDATES BY PROSTHETIC BUILDS ;08/22/06
"RTN","RMPR129P",2,0)
 ;;3.0;Prosthetics;**129**;06/20/05;Build 2
"RTN","RMPR129P",3,0)
 ;;
"RTN","RMPR129P",4,0)
 ;Post install to remove erroneous Prosthetics merge nodes set
"RTN","RMPR129P",5,0)
 ;into the Package file (#9.4) for merging capabilities.  These
"RTN","RMPR129P",6,0)
 ;nodes were set in by accident as Prosthetics builds being sent to sites
"RTN","RMPR129P",7,0)
 ;did not have a null response under Install Questions, Edit PACKAGE File
"RTN","RMPR129P",8,0)
 ;response Select Affects Record Merge.  These bogus Prosthetics entries
"RTN","RMPR129P",9,0)
 ;to the Package file will be located and deleted at the 20 node level.
"RTN","RMPR129P",10,0)
 ;The package merge errors occur since the Prosthetics node ^DIC(9.4,D0,20,D1,0)
"RTN","RMPR129P",11,0)
 ;has routine RMPRPFC in piece 3 for the merge to execute.
"RTN","RMPR129P",12,0)
SRCH1 N PIEN,MIEN
"RTN","RMPR129P",13,0)
 S PIEN=0
"RTN","RMPR129P",14,0)
 F  S PIEN=$O(^DIC(9.4,PIEN)) Q:PIEN=""!(PIEN]"@")  D
"RTN","RMPR129P",15,0)
 . ;Check for Prosthetics merge entry
"RTN","RMPR129P",16,0)
 . S PACKR=$G(^DIC(9.4,PIEN,0)) Q:PACKR=""!(PACKR]"@")
"RTN","RMPR129P",17,0)
 . I PACKR["PROS"!(PACKR["Pros") D
"RTN","RMPR129P",18,0)
 .. ;KILL PROS ENTRY 20 NODES IF PIECE 3 = 'RMPRPFC'
"RTN","RMPR129P",19,0)
 .. S MIEN=0
"RTN","RMPR129P",20,0)
 .. F  S MIEN=$O(^DIC(9.4,PIEN,20,MIEN)) Q:MIEN=""  D
"RTN","RMPR129P",21,0)
 ... S MERGREC=$G(^DIC(9.4,PIEN,20,MIEN,0)) Q:MERGREC=""
"RTN","RMPR129P",22,0)
 ... I $P(MERGREC,U,3)="RMPRPFC" D
"RTN","RMPR129P",23,0)
 .... ;DELETE INVALID MERGE REC WITH ROUTINE NAME 'RMPRPFC'
"RTN","RMPR129P",24,0)
 .... S DA(1)=PIEN,DIK="^DIC(9.4,"_PIEN_",20,",DA=MIEN D ^DIK K DA,DIK
"RTN","RMPR129P",25,0)
 K MERGREC,PACKR
"RTN","RMPR129P",26,0)
SRCH2 ;clean VA(15.2)-XDR MERGE PROCESS FILE for same invalid process
"RTN","RMPR129P",27,0)
 N PIEN,MIEN
"RTN","RMPR129P",28,0)
 S PIEN=0
"RTN","RMPR129P",29,0)
 F  S PIEN=$O(^VA(15.2,PIEN)) Q:PIEN=""!(PIEN]"@")  D
"RTN","RMPR129P",30,0)
 . ;Check for Prosthetics invalid merge process entry
"RTN","RMPR129P",31,0)
 . ;KILL PROS INVALID PROS ENTRY IF PIECE 9 = 'RMPRPFC'
"RTN","RMPR129P",32,0)
 . S MIEN=0
"RTN","RMPR129P",33,0)
 . F  S MIEN=$O(^VA(15.2,PIEN,3,MIEN)) Q:MIEN=""!(MIEN]"@")  D
"RTN","RMPR129P",34,0)
 .. S PROCREC=$G(^VA(15.2,PIEN,3,MIEN,0)) Q:PROCREC=""
"RTN","RMPR129P",35,0)
 .. I $P(PROCREC,U,9)="RMPRPFC" D
"RTN","RMPR129P",36,0)
 ... ;DELETE INVALID MERGE REC WITH ROUTINE NAME 'RMPRPFC'
"RTN","RMPR129P",37,0)
 ... S DA(1)=PIEN,DIK="^VA(15.2,"_PIEN_",3,",DA=MIEN D ^DIK K DA,DIK
"RTN","RMPR129P",38,0)
 K MERGREC,PACKR,PROCREC
"RTN","RMPR129P",39,0)
 Q
"RTN","RMPR21A")
0^3^B42409806^B43366806
"RTN","RMPR21A",1,0)
RMPR21A ;PHX/HNB/JLT-CONT. CREATE 1358 TRANSACTION, POST TO 2319 ;8/29/1994
"RTN","RMPR21A",2,0)
 ;;3.0;PROSTHETICS;**12,41,50,90,129**;Feb 09, 1996;Build 2
"RTN","RMPR21A",3,0)
 ;HNC - #90, item to billing item 10/29/04
"RTN","RMPR21A",4,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR21A",5,0)
P24 ;2421 DATE REQUIRED
"RTN","RMPR21A",6,0)
 S DR="20//T+30" D ^DIE I $D(DTOUT)!($D(Y)'=0) G KILL^RMPR21
"RTN","RMPR21A",7,0)
COT ;2421'S AND NO FORM WITH CONTRACT AUTHORITY1
"RTN","RMPR21A",8,0)
 I '$D(^RMPR(664,RMPRA,3)) S ^(3)=""
"RTN","RMPR21A",9,0)
 S DR="4"
"RTN","RMPR21A",10,0)
COT1 D ^DIE I $D(DTOUT)!($D(Y)'=0) G KILL^RMPR21
"RTN","RMPR21A",11,0)
 S RMPRV=$P($G(^RMPR(664,RMPRA,0)),U,4) G:$G(RMPRV)'>0 TRAN G:'$D(^PRC(440,RMPRV,4)) TRAN K DIR S DIR(0)="PO^PRC(440,"_RMPRV_",4,:QEM" D ^DIR I (Y'>0)&(X'="")&(X'["^") S DIR("B")="" G COT1
"RTN","RMPR21A",12,0)
 I X["^" G KILL^RMPR21
"RTN","RMPR21A",13,0)
 I Y>0,$P(^PRC(440,RMPRV,4,+Y,0),U,2)<DT W $C(7),!,"Sorry, contract has expired.  Enter another contract or `return` to continue." S DR="4//""""" G COT1
"RTN","RMPR21A",14,0)
 K DIR,DA S:Y>0 (RMPRCONT,RMPRCTK)=$P(Y,U,2)
"RTN","RMPR21A",15,0)
L2 ;ENTER/EDIT 2421, NO FORM
"RTN","RMPR21A",16,0)
 W !,"----------------------------------",!
"RTN","RMPR21A",17,0)
TRAN K DIR S DIR(0)="SMAO^I:INITIAL ISSUE;R:REPLACE;S:SPARE;X:REPAIR"
"RTN","RMPR21A",18,0)
 S DIR("A")="TYPE OF TRANSACTION: " D ^DIR
"RTN","RMPR21A",19,0)
 I $D(DUOUT)!$D(DTOUT) G CHK
"RTN","RMPR21A",20,0)
 I (Y="")&($D(^RMPR(664,RMPRA,1))) G CHK
"RTN","RMPR21A",21,0)
 I (Y="")&('$D(^RMPR(664,RMPRA,1))) W !,"Please enter type of Transaction!!" G TRAN
"RTN","RMPR21A",22,0)
 S RMTYPE=Y
"RTN","RMPR21A",23,0)
PCAT K DIR S DIR(0)="SMAO^1:SC/OP;2:SC/IP;3:NSC/IP;4:NSC/OP"
"RTN","RMPR21A",24,0)
 S DIR("A")="PATIENT CATEGORY: " D ^DIR
"RTN","RMPR21A",25,0)
 I $D(DUOUT)!$D(DTOUT) G CHK
"RTN","RMPR21A",26,0)
 I (Y="")&($D(^RMPR(664,RMPRA,1))) G CHK
"RTN","RMPR21A",27,0)
 I (Y="")&('$D(^RMPRA(664,RMPRA,1))) W !,"Please enter Patient Category!!" G PCAT
"RTN","RMPR21A",28,0)
 S RMCAT=Y
"RTN","RMPR21A",29,0)
 K DIR G:RMCAT<4 ITEM
"RTN","RMPR21A",30,0)
SPES S DIR(0)="SMAO^1:SPECIAL LEGISLATION;2:A&A;3:PHC;4:ELIGIBILITY REFORM"
"RTN","RMPR21A",31,0)
 S DIR("A")="SPECIAL CATEGORY: "
"RTN","RMPR21A",32,0)
 I RMCAT=4 D ^DIR I $D(DUOUT)!$D(DTOUT) G CHK
"RTN","RMPR21A",33,0)
 I RMCAT=4 S RMSPE=Y
"RTN","RMPR21A",34,0)
ITEM ;
"RTN","RMPR21A",35,0)
 K DIR S DIR(0)="FO",DIR("A")="Select BILLING ITEM"
"RTN","RMPR21A",36,0)
 S DIR("?")="^S RFL=1 D ZDSP^RMPR21A"
"RTN","RMPR21A",37,0)
 D ^DIR G:$D(DTOUT) KILL^RMPR21 G:$D(DUOUT) CHK
"RTN","RMPR21A",38,0)
 G:$D(DIRUT)&($D(^RMPR(664,RMPRA,1))) CHK
"RTN","RMPR21A",39,0)
 S DIC=661,DIC(0)="EQMZ" D ^DIC G:+Y'>0 ITEM
"RTN","RMPR21A",40,0)
 D EDT^RMPRUTIL G:$D(DTOUT) KILL^RMPR21 G L2
"RTN","RMPR21A",41,0)
 ;
"RTN","RMPR21A",42,0)
CHK K RFL,DIR S FL=1
"RTN","RMPR21A",43,0)
 I '$D(^RMPR(664,RMPRA,1)) W !!,?5,$C(7),"REQUIRED FIELDS DO NOT EXIST ON THIS FORM",! G KILL^RMPR21
"RTN","RMPR21A",44,0)
 I $D(^RMPR(664,RMPRA,1)) S FL=0 F RI=0:0 S RI=$O(^RMPR(664,RMPRA,1,RI)) Q:RI'>0  I $D(^(RI,0)) S FL=1 I $P(^(0),U,3)=""!($P(^(0),U,4)="")!($P(^(0),U,5)="")!($P(^(0),U,9)="")!($P(^(0),U,10)="") S FL=0 Q
"RTN","RMPR21A",45,0)
 I 'FL W !!,?5,$C(7),"REQUIRED FIELDS DO NOT EXIST ON THIS FORM",! G KILL^RMPR21
"RTN","RMPR21A",46,0)
 S $P(^RMPR(664,RMPRA,0),U,9)=DUZ
"RTN","RMPR21A",47,0)
 I $D(DUOUT)&('$D(^RMPR(664,RMPRA,1))) W !,$C(7),$C(7),"Please Try Later!" G KILL^RMPR21
"RTN","RMPR21A",48,0)
 I RMPRF'=8 S DA=RMPRA,DIE=664,DR="11;17" D ^DIE
"RTN","RMPR21A",49,0)
ASK I RMPRF=2 D  D ^DIR K DIR G:$D(DTOUT) KILL^RMPR21 I $D(DIRUT)!(X="") W $C(7),"Delivery is required.  Enter '?' for additional help." G ASK
"RTN","RMPR21A",50,0)
 .K DIR
"RTN","RMPR21A",51,0)
 .S DIR(0)="SAO^1:VETERAN;2:VAMC WAREHOUSE;3:PROSTHETICS;4:OTHER;"
"RTN","RMPR21A",52,0)
 .S DIR("A")="DELIVER TO: "
"RTN","RMPR21A",53,0)
 .;S DIR("B")=$P(^RMPR(664,RMPRA,3),U,1)
"RTN","RMPR21A",54,0)
 .;D ^DIR K DIR G:$D(DTOUT) KILL^RMPR21 I $D(DIRUT) W $C(7)," ??" G ASK
"RTN","RMPR21A",55,0)
 I RMPRF=2 S RMPRDELN=Y(0),$P(^RMPR(664,RMPRA,3),U)=RMPRDELN I Y=4 D  G:$D(DTOUT) KILL^RMPR21
"RTN","RMPR21A",56,0)
 .S DIE="^RMPR(664,",DA=RMPRA,DR="21.1T" D ^DIE
"RTN","RMPR21A",57,0)
 .Q
"RTN","RMPR21A",58,0)
ASK5 S %=2 W !!,"Are you ready to POST to IFCAP and 10-2319 NOW" D YN^DICN G:%=1 FILE^RMPR21B G:$D(DTOUT) KILL^RMPR21
"RTN","RMPR21A",59,0)
 I %=0 W !,"This will Create a Daily Transaction in the 1358 Module of IFCAP,",!,"and Create an Entry on the Prosthetic 10-2319 Record" G ASK5
"RTN","RMPR21A",60,0)
 I %=-1 S %=2 R !,"Do you want to Delete this Transaction" D YN^DICN G:$D(DTOUT)!(%=1) KILL^RMPR21
"RTN","RMPR21A",61,0)
 D ^RMPRLI I RMPRX]"" G ASK5
"RTN","RMPR21A",62,0)
L W !!!,"Enter Item to Edit: " R X:DTIME G:'$T KILL^RMPR21
"RTN","RMPR21A",63,0)
 G:"^"[X ASK5 I X["?" D ZDSP G L
"RTN","RMPR21A",64,0)
 S DA(1)=RMPRA,DIC="^RMPR(664,"_RMPRA_",1,",DIC(0)="EQMZ" D ^DIC I +Y'>0 K DA,Y G L
"RTN","RMPR21A",65,0)
 ;HCPCS code
"RTN","RMPR21A",66,0)
 S:$D(RMPRCTK) RMPRCONT=RMPRCTK
"RTN","RMPR21A",67,0)
 S DA=+Y,DA(1)=RMPRA
"RTN","RMPR21A",68,0)
 S DR="8;9;S RMTYPE=$P($G(^(0)),U,9);I $P(^RMPR(664,DA(1),1,DA,0),U,10)=4 S Y=""@1"";.01;16;1;14;3;2;4;7;S Y="""";@1;10;.01;16;1;14;3;2;4;7"
"RTN","RMPR21A",69,0)
 S DIE="^RMPR(664,"_RMPRA_",1," D ^DIE
"RTN","RMPR21A",70,0)
 ;do a final check for cpt modifier
"RTN","RMPR21A",71,0)
 D CHKCPT
"RTN","RMPR21A",72,0)
 K DA
"RTN","RMPR21A",73,0)
 S FL=1 I $D(^RMPR(664,RMPRA,1)) S FL=0 F RI=0:0 S RI=$O(^RMPR(664,RMPRA,1,RI)) Q:RI'>0  I $D(^(RI,0)) S FL=1 I $P(^(0),U,3)=""!($P(^(0),U,4)="")!($P(^(0),U,5)="")!($P(^(0),U,9)="")!($P(^(0),U,10)="") S FL=0 Q
"RTN","RMPR21A",74,0)
 I 'FL W !!,?5,$C(7),"REQUIRED ITEMS DO NOT EXIST ON THIS FORM",! G KILL^RMPR21
"RTN","RMPR21A",75,0)
 K DA S DIE="^RMPR(664,",DA=RMPRA,DR="11;17" S:RMPRF=2 DR=DR_";20" D ^DIE
"RTN","RMPR21A",76,0)
 I RMPRF=2 D  G:$D(DTOUT) KILL^RMPR21 G:$D(DUOUT) ASK5
"RTN","RMPR21A",77,0)
 .S DIR(0)="SA^1:VETERAN;2:VAMC WAREHOUSE;3:PROSTHETICS;4:OTHER;"
"RTN","RMPR21A",78,0)
 .S DIR("A")="DELIVER TO: "
"RTN","RMPR21A",79,0)
 .;REMOVE DIR(?)
"RTN","RMPR21A",80,0)
 .S DIR("B")=$P(^RMPR(664,DA,3),U,1)
"RTN","RMPR21A",81,0)
 .D ^DIR K DIR
"RTN","RMPR21A",82,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","RMPR21A",83,0)
 .S RMPRDELN=Y(0)
"RTN","RMPR21A",84,0)
 .I Y=4 S:'$D(^RMPR(664,RMPRA,3)) ^(3)="" S Y1=Y,DIE="^RMPR(664,",DA=RMPRA,DR="21.1T" D ^DIE
"RTN","RMPR21A",85,0)
 G:$D(DTOUT) KILL^RMPR21 K Y1 G L
"RTN","RMPR21A",86,0)
 ;
"RTN","RMPR21A",87,0)
ZDSP ;MULTIPLE ITEM DISPLAY FOR PURCHASING AND CLOSE-OUT
"RTN","RMPR21A",88,0)
 K RAC S RMPRI=0 F  S RMPRI=$O(^RMPR(664,RMPRA,1,RMPRI)) Q:RMPRI'>0  S RMPRI1=$P(^(RMPRI,0),U,1),RMPRIT=$P(^RMPR(661,RMPRI1,0),U,1),RAC(RMPRIT)=$P(^PRC(441,RMPRIT,0),U,2)
"RTN","RMPR21A",89,0)
 W ! I $D(RAC) W !,?5,"Answer With Item # or Item Name",! F RI=0:0 S RI=$O(RAC(RI)) Q:RI'>0  W !,?5,RI,?10,RAC(RI)
"RTN","RMPR21A",90,0)
LDIC I $D(RFL) S X="?",DIC=661,DIC(0)="EQM",DIC("W")="W "" "",$P(^PRC(441,$P(^(0),U,1),0),U,2)" D ^DIC K RFL
"RTN","RMPR21A",91,0)
 Q
"RTN","RMPR21A",92,0)
PR1 ;ENTRY POINT FOR  10-2421S   ASKING THE USER IF THEY WANT TO PRINT THE PATIENT NOTIFICATION LETTER
"RTN","RMPR21A",93,0)
 Q:RMPRF'=2
"RTN","RMPR21A",94,0)
 S RMPRPN=0,%=2
"RTN","RMPR21A",95,0)
 R !,"Would you like to print a Patient Notification letter"
"RTN","RMPR21A",96,0)
 D YN^DICN I %=1 S RMPRPN=1 Q
"RTN","RMPR21A",97,0)
 G:%=0 HELP1
"RTN","RMPR21A",98,0)
 Q:(%=2)!(%=-1)
"RTN","RMPR21A",99,0)
 Q
"RTN","RMPR21A",100,0)
HELP1 ;
"RTN","RMPR21A",101,0)
 W !,"Enter `Y` for YES to print the Patient Notification letter",!,"`N` for No if you do not wish to print the letter." G PR1
"RTN","RMPR21A",102,0)
 Q
"RTN","RMPR21A",103,0)
PR ;ENTRY POINT FOR BOTH 10-2421S AND 10-55S ASKING THE USER IF THEY WANT TO PRINT THE PRIVACY ACT STATEMENT
"RTN","RMPR21A",104,0)
 S %=1 R !,"Would you like to print the Privacy Act Statement" D YN^DICN I %=1 S RMPRPRIV=1 D PR1 Q
"RTN","RMPR21A",105,0)
 G:%=0 HELP D:%=2 PR1 Q
"RTN","RMPR21A",106,0)
 Q:%=-1
"RTN","RMPR21A",107,0)
HELP W !,"Enter `Y` for YES to print the Privacy Act Statement",!,"`N` for NO if you do not want to print the statement." G PR
"RTN","RMPR21A",108,0)
 Q
"RTN","RMPR21A",109,0)
 ;
"RTN","RMPR21A",110,0)
CHKCPT ;check for cpt modifier
"RTN","RMPR21A",111,0)
 S RMCPTOLD=$P($G(^RMPR(664,DA(1),1,DA,4)),U,2)
"RTN","RMPR21A",112,0)
 S RMTYNEW=$P(^RMPR(664,DA(1),1,DA,0),U,9)
"RTN","RMPR21A",113,0)
 S RMHCPC=$P(^RMPR(664,DA(1),1,DA,0),U,16) Q:'$G(RMHCPC)
"RTN","RMPR21A",114,0)
 I ((RMTYNEW="R")!(RMTYNEW="X")),(RMCPTOLD'["RP"),($G(^RMPR(661.1,RMHCPC,4))["RP") D ADDRP
"RTN","RMPR21A",115,0)
 I ((RMTYNEW="I")!(RMTYNEW="S")),(RMCPTOLD["RP"),($G(^RMPR(661.1,RMHCPC,4))["RP") D DELRP
"RTN","RMPR21A",116,0)
 K RMCPTOLD,RMTYNEW,RMHCPC,RMF,RMCI,RMC,RMLPIECE,RMCLEN
"RTN","RMPR21A",117,0)
 Q
"RTN","RMPR21A",118,0)
DELRP ;logic for deleting 'RP' modifier with transaction change.
"RTN","RMPR21A",119,0)
 F RMCI=1:1:8 S RMC=$P(RMCPTOLD,",",RMCI) I RMC="RP" S $P(RMCPTOLD,",",RMCI)="" D
"RTN","RMPR21A",120,0)
 .S RMF=$F(RMCPTOLD,",,"),RMFPIECE=$E(RMCPTOLD,1,RMF-2)
"RTN","RMPR21A",121,0)
 .S RMLPIECE=$E(RMCPTOLD,RMF,32),RMCPTOLD=RMFPIECE_RMLPIECE
"RTN","RMPR21A",122,0)
 .S RMCLEN=$L(RMCPTOLD)
"RTN","RMPR21A",123,0)
 .I $E(RMCPTOLD,1)="," S RMCPTOLD=$E(RMCPTOLD,2,RMCLEN)
"RTN","RMPR21A",124,0)
 .I $E(RMCPTOLD,RMCLEN)="," S RMCPTOLD=$E(RMCPTOLD,1,RMCLEN-1)
"RTN","RMPR21A",125,0)
 .S $P(^RMPR(664,DA(1),1,DA,4),U,2)=RMCPTOLD
"RTN","RMPR21A",126,0)
 Q
"RTN","RMPR21A",127,0)
 ;
"RTN","RMPR21A",128,0)
ADDRP ;logic for adding 'RP' modifier with transaction change.
"RTN","RMPR21A",129,0)
 S RMCPTOLD=RMCPTOLD_",RP"
"RTN","RMPR21A",130,0)
 S $P(^RMPR(664,DA(1),1,DA,4),U,2)=RMCPTOLD
"RTN","RMPR21A",131,0)
 Q
"RTN","RMPR21A",132,0)
 ;END
"RTN","RMPR21B")
0^4^B11589475^B11554839
"RTN","RMPR21B",1,0)
RMPR21B ;PHX/HNB/JLT-CREATE 1358 TRANSACTION, POST TO 2319 ;8/29/1994
"RTN","RMPR21B",2,0)
 ;;3.0;PROSTHETICS;**129**;Feb 09, 1996;Build 2
"RTN","RMPR21B",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR21B",4,0)
FILE ;CREATE 1358 DAILY RECORD
"RTN","RMPR21B",5,0)
 I RMPRF=1!(RMPRF=2) D PR^RMPR21A G:$D(DTOUT) KILL^RMPR21 I %=-1 S RMPRGO=$S(RMPRF=1:"ASK^RMPR21",1:"ASK5^RMPR21A") G @RMPRGO
"RTN","RMPR21B",6,0)
 W !?5,"Posting Now ..."
"RTN","RMPR21B",7,0)
 S $P(^RMPR(664,RMPRA,0),U,3)=RMPROB,$P(^(0),U,14)=RMPR("STA")
"RTN","RMPR21B",8,0)
 S (R1,RMPRCT,RMPRQT,RMPRTO,RMPRI)=0
"RTN","RMPR21B",9,0)
 S RMPRSH=$S($P(^RMPR(664,RMPRA,0),U,10):$P(^(0),U,10),1:"")
"RTN","RMPR21B",10,0)
 F  S R1=$O(^RMPR(664,RMPRA,1,R1)) Q:R1'>0  D
"RTN","RMPR21B",11,0)
 .S RB=^RMPR(664,RMPRA,1,R1,0)
"RTN","RMPR21B",12,0)
 .S RMPRCT=$P(RB,U,3)
"RTN","RMPR21B",13,0)
 .S RMPRQT=$P(RB,U,4)
"RTN","RMPR21B",14,0)
 .S RMPRR=$S($P(RB,U,8)'="":RMPRR_" "_$P(RB,U,8),1:"")
"RTN","RMPR21B",15,0)
 .S RMPRTO=RMPRTO+$J(RMPRCT*RMPRQT,0,2)
"RTN","RMPR21B",16,0)
 K RB
"RTN","RMPR21B",17,0)
POST S RMPRTO=$S($D(^RMPR(664,RMPRA,2)):RMPRTO-$J((RMPRTO*$P(^(2),U,6)/100),0,2),1:RMPRTO)
"RTN","RMPR21B",18,0)
 I RMPRF'=10,RMPRF'=1 D CHECK^RMPRCT
"RTN","RMPR21B",19,0)
 I '$D(RMPRTO) G KILL^RMPR21
"RTN","RMPR21B",20,0)
 S X=RMPROB_U_DT_U_$J(RMPRTO+RMPRSH,0,2)_U_U_$E($P(RMPRNAM,",",1),1,6)_","_$E(RMPRSSN,6,9)_U_$E(RMPRR,1,60)
"RTN","RMPR21B",21,0)
 S PRCS("TYPE")="FB" K DO,DD,D0
"RTN","RMPR21B",22,0)
 D EN2^PRCS58 G:+Y'=1 ERROR^RMPR21
"RTN","RMPR21B",23,0)
 S RMPRTN=$P(Y,U,2)
"RTN","RMPR21B",24,0)
 S RMPRTRN=$P(^PRC(424,RMPRTN,0),U,1)
"RTN","RMPR21B",25,0)
M W !?5,"1358 Transaction has been assigned Number: ",RMPRTRN
"RTN","RMPR21B",26,0)
 S RMPRV=$P(^RMPR(664,RMPRA,0),U,4)
"RTN","RMPR21B",27,0)
 S $P(^RMPR(664,RMPRA,0),U,7)=RMPRTRN
"RTN","RMPR21B",28,0)
 S $P(^RMPR(664,RMPRA,0),U,6)=PRCSCPAN
"RTN","RMPR21B",29,0)
 S:'RMPRF RMPRF=9
"RTN","RMPR21B",30,0)
 S RA="1:PSC;2:2421;3:2237;4:2529-3;5:2529-7;6:2474;7:2431;8:2914;9:OTHER;10:2520;11:STOCK ISSUE;12:INVENTORY ISSUE;13:HISTORICAL DATA;"
"RTN","RMPR21B",31,0)
 S $P(^RMPR(664,RMPRA,2),U,4)=$P($P(RA,";",+RMPRF),":",2) K RA
"RTN","RMPR21B",32,0)
 I $D(RMPRPSC) S $P(^RMPR(664,RMPRA,2),U,5)=RMPRPSC
"RTN","RMPR21B",33,0)
 S:$D(RMPRDELN) $P(^RMPR(664,RMPRA,3),U)=RMPRDELN
"RTN","RMPR21B",34,0)
 S DA=RMPRA,DIK="^RMPR(664," D IX1^DIK
"RTN","RMPR21B",35,0)
 ;get AMIS grouper number
"RTN","RMPR21B",36,0)
 L +^RMPR(669.9,RMPRSITE,0):999 I $T=0 S RMPRG=DT_99 G GGC
"RTN","RMPR21B",37,0)
 S RMPRG=$P(^RMPR(669.9,RMPRSITE,0),U,7),RMPRG=RMPRG-1,$P(^(0),U,7)=RMPRG L -^RMPR(669.9,RMPRSITE,0)
"RTN","RMPR21B",38,0)
GGC S RMPRWO=$P(^RMPR(664,RMPRA,0),U,15)
"RTN","RMPR21B",39,0)
 ;check for lab
"RTN","RMPR21B",40,0)
 I RMPRWO,$D(^RMPR(664.2,+RMPRWO,0)) D
"RTN","RMPR21B",41,0)
 .F DA=0:0 S DA=$O(^RMPR(664.2,RMPRWO,1,"AC",RMPRA,DA)) Q:DA'>0  S DIK="^RMPR(664.2,"_RMPRWO_",1,",DA(1)=RMPRWO D ^DIK
"RTN","RMPR21B",42,0)
 F  S B2=$O(^RMPR(664,RMPRA,1,B2)) Q:B2'>0  D R19^RMPR21C
"RTN","RMPR21B",43,0)
 K RMPRDP G:RMPRSH="" NS
"RTN","RMPR21B",44,0)
 K DD,DO S X=DT,DIC="^RMPR(660,",DIC(0)="LZ" D FILE^DICN S (RMPR660,DA)=+Y
"RTN","RMPR21B",45,0)
 ;
"RTN","RMPR21B",46,0)
 S ^RMPR(660,RMPR660,0)=DT_U_RMPRDFN_U_DT_"^X^^^^^"_RMPRV_U_RMPR("STA")_"^^^"_RMPRF_U_RMPRS_"^^^"_RMPRSH_"^^^^^",^("AMS")=RMPRG,^("AM")=U_U_RMPRDIS_U_RMPRSC,$P(^(0),U,27)=DUZ,^(1)=RMPRTRN I $D(RMPRWO),RMPRWO S $P(^("AM"),U,2)=1 D
"RTN","RMPR21B",47,0)
 .I $D(^RMPR(664.2,RMPRWO,0)) S $P(^(0),U,6)=$P(^(0),U,6)+RMPRSH
"RTN","RMPR21B",48,0)
 S ^RMPR(660,RMPR660,3)=$P($G(^RMPR(664,RMPRA,3)),U,4)
"RTN","RMPR21B",49,0)
 S DIK="^RMPR(660," D IX1^DIK S $P(^RMPR(664,RMPRA,0),U,12)=RMPR660 K RMPRDP
"RTN","RMPR21B",50,0)
NS ;check approval
"RTN","RMPR21B",51,0)
 ;D NOW^%DTC S ^RMPR(664,"AP",RMPR("STA"),%,RMPRA)="",$P(^RMPR(664,RMPRA,4),U,9)=%,$P(^(4),U,8)=1
"RTN","RMPR21B",52,0)
 ;S $P(^RMPR(664,RMPRA,4),U)=DUZ,$P(^RMPR(664,RMPRA,4),U,2)=$P(^VA(200,DUZ,20),U,3)
"RTN","RMPR21B",53,0)
 ;e-sig
"RTN","RMPR21B",54,0)
 ;I $D(^XUSEC("RMPR WARRANT",DUZ))!($D(^XUSEC("RMPR SUPERVISOR",DUZ))) I $G(RMPRSBP)'="" D
"RTN","RMPR21B",55,0)
 ;.S $P(^RMPR(664,RMPRA,4),U,3)=DUZ,$P(^(4),U,4)=RMPRSBT
"RTN","RMPR21B",56,0)
 ;.S $P(^RMPR(664,RMPRA,4),U,7)=$$SUM^RMPRSEC(RMPRSBP),$P(^RMPR(664,RMPRA,4),U,6)=$$ENCODE^RMPRSEC(RMPRSBP,DUZ,1),$P(^RMPR(664,RMPRA,4),U,5)=DT
"RTN","RMPR21B",57,0)
 ;.K ^RMPR(664,"AP",RMPR("STA"),$P($G(^RMPR(664,RMPRA,4)),U,9),RMPRA) S $P(^RMPR(664,RMPRA,4),U,8)=""
"RTN","RMPR21B",58,0)
 W !,?5,"Updated 10-2319" G:'$D(RMPRF) EXIT^RMPR21
"RTN","RMPR21B",59,0)
 Q:$D(RMPRDP)  D:RMPRF=1 ^RMPRP55 D:RMPRF=2 ^RMPRP21
"RTN","RMPR21B",60,0)
 ;
"RTN","RMPR21B",61,0)
 I RMPRF=10 D ASK^RMPRE21
"RTN","RMPR21B",62,0)
 G EXIT^RMPR21
"RTN","RMPR21C")
0^5^B9637594^B9610410
"RTN","RMPR21C",1,0)
RMPR21C ;PHX/JLT,RVD-CONTINUATION OF RMPR21B ;8/29/1994
"RTN","RMPR21C",2,0)
 ;;3.0;PROSTHETICS;**12,28,41,62,129**;Feb 09, 1996;Build 2
"RTN","RMPR21C",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR21C",4,0)
 ;
"RTN","RMPR21C",5,0)
 ;RVD patch #62 - PCE interface
"RTN","RMPR21C",6,0)
 ;
"RTN","RMPR21C",7,0)
R19 ;PASS RMPRA AS IEN OF 644, AND B2 AS ITEM MULTIPLE
"RTN","RMPR21C",8,0)
 S:$D(RMPRCONT) $P(^RMPR(664,RMPRA,1,B2,0),U,14)=RMPRCONT
"RTN","RMPR21C",9,0)
 S RMPRI=$P(^RMPR(664,RMPRA,1,B2,0),U,1),RMPRCT=$P(^(0),U,3),RMPRQT=$P(^(0),U,4),RMPRDES=$P(^(0),U,2)
"RTN","RMPR21C",10,0)
 S RMPRIS=$P(^(0),U,5),SR=$S($D(RMPRSR(RMPRI)):RMPRSR(RMPRI),1:"")
"RTN","RMPR21C",11,0)
 S RMPRT=$P(^RMPR(664,RMPRA,1,B2,0),U,9),RMPRR=$P(^(0),U,8),RMPRDIS=$P(^(0),U,10),RMPRS=$P(^(0),U,12),RMPRSC=$P(^(0),U,11),UOI=$P(^(0),U,5)
"RTN","RMPR21C",12,0)
 S RMPRHCPC=$P(^RMPR(664,RMPRA,1,B2,0),U,16)
"RTN","RMPR21C",13,0)
 S RMCPT=$P($G(^RMPR(664,RMPRA,1,B2,4)),U,2)
"RTN","RMPR21C",14,0)
 K DD,DO S DIC="^RMPR(660,",DIC(0)="QL",X=DT,DLAYGO=660
"RTN","RMPR21C",15,0)
 D FILE^DICN K DLAYGO
"RTN","RMPR21C",16,0)
 S (RMPR660,DA)=+Y,^RMPR(660,RMPR660,0)=DT_U_RMPRDFN_U_DT_U_RMPRT_U_U_RMPRI_U_RMPRQT_U_UOI_U_RMPRV_U_RMPR("STA")_U_SR_U_U_RMPRF_U_RMPRS_U_U_$J(RMPRQT*RMPRCT,0,2)_"^^^^^^"
"RTN","RMPR21C",17,0)
 ;HCPCS code
"RTN","RMPR21C",18,0)
 S $P(^RMPR(660,RMPR660,0),U,22)=$P($G(^RMPR(661.1,RMPRHCPC,0)),U,4)
"RTN","RMPR21C",19,0)
 S ^RMPR(660,RMPR660,"AMS")=RMPRG,^RMPR(660,RMPR660,"AM")=U_U_RMPRDIS_U_RMPRSC I $D(RMPRWO),RMPRWO S $P(^("AM"),U,2)=1,$P(^RMPR(660,RMPR660,"LB"),U,5)=RMPRWO
"RTN","RMPR21C",20,0)
 S:$D(RMPRR) $P(^RMPR(660,RMPR660,0),U,18)=RMPRR
"RTN","RMPR21C",21,0)
 S $P(^RMPR(660,RMPR660,0),U,27)=DUZ,^(1)=RMPRTRN_U_RMPRDES_"^^"_RMPRHCPC_"^^"_RMCPT
"RTN","RMPR21C",22,0)
 S $P(^RMPR(664,RMPRA,1,B2,0),U,13)=RMPR660
"RTN","RMPR21C",23,0)
 S (D1,RD)=0 F  S RD=$O(^RMPR(664,RMPRA,1,B2,1,RD)) Q:RD'>0  S ^RMPR(660,RMPR660,"DES",RD,0)=^RMPR(664,RMPRA,1,B2,1,RD,0),D1=RD
"RTN","RMPR21C",24,0)
 S ^RMPR(660,RMPR660,"DES",0)="^660.028^"_D1_U_D1
"RTN","RMPR21C",25,0)
 S ^RMPR(660,RMPR660,3)=$P($G(^RMPR(664,RMPRA,3)),U,4)
"RTN","RMPR21C",26,0)
 ;modified by #62
"RTN","RMPR21C",27,0)
 S ^TMP($J,"RMPRPCE",660,RMPR660)=RMPRG_"^"_$G(RMPRDFN)
"RTN","RMPR21C",28,0)
 ;
"RTN","RMPR21C",29,0)
 S DIK="^RMPR(660,",DA=RMPR660 D IX1^DIK
"RTN","RMPR21C",30,0)
 I $D(RMPRWO),$D(^RMPR(664.2,+RMPRWO,0)) S DIC="^RMPR(664.2,"_RMPRWO_",1,",DIC("P")="664.22PA",DA(1)=RMPRWO,DIC(0)="LZ",R660=^RMPR(660,RMPR660,0),X=$P(R660,U,6) D FILE^DICN I +Y>0 D
"RTN","RMPR21C",31,0)
 .S $P(^RMPR(664.2,RMPRWO,1,+Y,0),U,2)=$P(R660,U,7),$P(^(0),U,3)=$J($P(R660,U,16)/$P(R660,U,7),0,2)
"RTN","RMPR21C",32,0)
 .S $P(^RMPR(664.2,RMPRWO,1,+Y,0),U,6)=$P(R660,U,9),$P(^(0),U,7)=$P(R660,U,8),$P(^(0),U,10)=RMPRTRN,$P(^(0),U,4)=$P(R660,U,14),$P(^(0),U,9)="PD",$P(^(0),U,11)=RMPRA,$P(^(0),U,12)=RMPR660
"RTN","RMPR21C",33,0)
 .S DIK=DIC,DA(1)=RMPRWO,DA=+Y D IX1^DIK S ^RMPR(664.2,RMPRWO,1,"AC",RMPRA,DA)=""
"RTN","RMPR21C",34,0)
 Q
"RTN","RMPRP21")
0^2^B30821456^B31670001
"RTN","RMPRP21",1,0)
RMPRP21 ;PHX/RFM-PRINT 10-2421 ;8/29/1994
"RTN","RMPRP21",2,0)
 ;;3.0;PROSTHETICS;**3,19,55,90,129**;Feb 09, 1996;Build 2
"RTN","RMPRP21",3,0)
 ;
"RTN","RMPRP21",4,0)
 ; ODJ - patch 55 - 1/29/01 - extrinsic to get mail routing code
"RTN","RMPRP21",5,0)
 ;                            from site param. replaces hard code 121
"RTN","RMPRP21",6,0)
 ;                            nois AUG-1097-32118
"RTN","RMPRP21",7,0)
 ;
"RTN","RMPRP21",8,0)
 I '$D(RMPR) D DIV4^RMPRSIT Q:$D(X)
"RTN","RMPRP21",9,0)
 I +$P(^RMPR(669.9,RMPRSITE,0),U,5) I $D(RMPRA)&($D(^%ZIS(1,$P(^RMPR(669.9,RMPRSITE,0),U,5),0))) S IOP="Q;"_$P(^(0),U,1) S %ZIS="MQ" D ^%ZIS G:POP EX S ZTIO=ION G PT
"RTN","RMPRP21",10,0)
 I $D(RMPRA)&('$P(^RMPR(669.9,RMPRSITE,0),U,5)) G ZIS
"RTN","RMPRP21",11,0)
EN ;ENTRY POINT FOR REPRINTING A 10-2421 FORM
"RTN","RMPRP21",12,0)
 I '$D(RMPR) D DIV4^RMPRSIT G:$D(X) EX
"RTN","RMPRP21",13,0)
 S RMPRACT=1,DIC="^RMPR(664,",DIC(0)="AEQM",DIC("A")="Select Transaction or Patient Name: ",RMPRF=2
"RTN","RMPRP21",14,0)
 S DIC("S")="I $D(^RMPR(664,Y,1)) S RZZZ=$O(^RMPR(664,Y,1,0)) I RZZZ S RX=$P(^(RZZZ,0),U,13) S:$D(^RMPR(660,+RX,0)) RX=$P(^(0),U,13) I RX=2,'$D(^RMPR(664,""AP"",RMPR(""STA""),Y))"
"RTN","RMPRP21",15,0)
 S DIC("W")="D EN2^RMPRD1" D ^DIC G:Y<0 EX S RMPRA=+Y I $P(^RMPR(664,+Y,0),U,5) D M2^RMPRM
"RTN","RMPRP21",16,0)
 D PR^RMPR21A I %'>0 G EX
"RTN","RMPRP21",17,0)
 ;I +$P(^RMPR(669.9,RMPRSITE,0),U,5) I $D(RMPRA)&($D(^%ZIS(1,$P(^RMPR(669.9,RMPRSITE,0),U,5),0))) S IOP="Q;"_$P(^(0),U,1),%ZIS="Q" D ^%ZIS G:POP EX S ZTIO=ION G PT
"RTN","RMPRP21",18,0)
ZIS S %ZIS="QM" D ^%ZIS G:POP EX
"RTN","RMPRP21",19,0)
 I '$D(IO("Q")) U IO G PRT
"RTN","RMPRP21",20,0)
 S ZTIO=ION
"RTN","RMPRP21",21,0)
PT S ZTDTH=$H,ZTSAVE("RMPRPN")="",ZTSAVE("RMPRA")="",ZTSAVE("RMPRSITE")="",ZTSAVE("RMPR(")="",ZTRTN="PRT^RMPRP21",ZTDESC="2421 FORM"
"RTN","RMPRP21",22,0)
  S:$D(RMPRPRIV) ZTSAVE("RMPRPRIV")="" D ^%ZTLOAD W !,$S($D(ZTSK):"<REQUEST QUEUED>",1:"<REQUEST NOT QUEUED>") D HOME^%ZIS H 3 G EX
"RTN","RMPRP21",23,0)
PRT ;ENTRY POINT TO PRINT 2421S
"RTN","RMPRP21",24,0)
 S %X="^RMPR(664,RMPRA,",%Y="R664(" D %XY^%RCR K %X,%Y
"RTN","RMPRP21",25,0)
 S RDUZ=$P(R664(0),U,9),RDUZ=$P(^VA(200,RDUZ,0),U,1),DFN=$P(R664(0),U,2),RTN=$P(R664(0),U,7),CP=$P(R664(0),U,6),CP=$P(^PRCS(410,CP,0),U,1),RMPRPAGE=2
"RTN","RMPRP21",26,0)
 D ADD^VADPT,DEM^VADPT,ELIG^VADPT
"RTN","RMPRP21",27,0)
 W:$Y>0 @IOF W ?20,"OMB Number 2900-0188",?50,"PO#: "
"RTN","RMPRP21",28,0)
 W !!?7,"***ORIGINAL COPY AND COMMERCIAL INVOICE MUST BE SUBMITTED***",!?15,"TO THE VAMC PROSTHETIC ACTIVITY LISTED BELOW"
"RTN","RMPRP21",29,0)
HDR ;PRINT HEADER FOR 2421 ADDRESS INFO
"RTN","RMPRP21",30,0)
 I $P($G(R664(4)),U,8) W !,?30,"***WORKING COPY***"
"RTN","RMPRP21",31,0)
 S (RMPRT,RMPRB)="",$P(RMPRT,"_",IOM)="",$P(RMPRB,"-",IOM)="" W !,RMPRT,!,"Department of Veterans Affairs"_"|"_"Prosthetic Authorization for Items or Services",!,RMPRB
"RTN","RMPRP21",32,0)
 W !,"1. Name and Address of Vendor",?40,"2. Name and Address of VA Facility"
"RTN","RMPRP21",33,0)
 S RMPRV=$P(R664(0),U,4),RMPRST=""
"RTN","RMPRP21",34,0)
 I $D(^PRC(440,RMPRV,0)) S RMPRV=^PRC(440,RMPRV,0) D
"RTN","RMPRP21",35,0)
 .S RMPRST=$P(RMPRV,U,7),RMPRPHON=$P(RMPRV,U,10)
"RTN","RMPRP21",36,0)
 .S RMPRAD1=$P(RMPRV,U,2),RMPRAD2=$P(RMPRV,U,3)
"RTN","RMPRP21",37,0)
 .S RMPRCITY=$P(RMPRV,U,6),RMPR90IP=$P(RMPRV,U,8)
"RTN","RMPRP21",38,0)
 .S RMPRVACN=$P($G(^PRC(440,$P(R664(0),U,4),2)),U,1)
"RTN","RMPRP21",39,0)
 I $D(^DIC(5,+RMPRST,0)) S RMPRST=$P(^(0),U,2)
"RTN","RMPRP21",40,0)
 E  S RMPRST="NO STATE ON FILE"
"RTN","RMPRP21",41,0)
 W !,?5,$E($P(RMPRV,U,1),1,30),?40
"RTN","RMPRP21",42,0)
 W $E(RMPR("NAME"),1,28)," ","(",$$STA^RMPRUTIL,"/",$$ROU^RMPRUTIL(RMPRSITE),")"
"RTN","RMPRP21",43,0)
 W !,?5,$E(RMPRAD1,1,35),?40,$E(RMPR("ADD"),1,39)
"RTN","RMPRP21",44,0)
 I RMPRAD2'="" W !,?5,$E(RMPRAD2,1,35),?40,RMPR("CITY")
"RTN","RMPRP21",45,0)
 I RMPRAD2="" W !?5,RMPRCITY_","_RMPRST_" "_RMPR90IP,?40,RMPR("CITY")
"RTN","RMPRP21",46,0)
 I RMPRAD2'="" W !?5,RMPRCITY_","_RMPRST_" "_RMPR90IP
"RTN","RMPRP21",47,0)
 W !,?5,RMPRPHON
"RTN","RMPRP21",48,0)
 ;W:$G(RMPRVACN)'="" ?22,"ACCT # ",RMPRVACN
"RTN","RMPRP21",49,0)
 W ?40,$P(^RMPR(669.9,RMPRSITE,0),U,4),!,RMPRB
"RTN","RMPRP21",50,0)
 W !,"3. Veterans Name (Last, First, MI)",?40,"4. Date of Authorization"
"RTN","RMPRP21",51,0)
 W !,?5,VADM(1) S Y=$P(R664(0),U,1) D DD^%DT W ?45,Y
"RTN","RMPRP21",52,0)
 I $D(RMPRMOR) W !,RMPRB D HDR1 Q
"RTN","RMPRP21",53,0)
 W !,RMPRB S RMPRODTE=Y
"RTN","RMPRP21",54,0)
 S RMPRDELD="" I $D(R664(3)),$P(R664(3),U,2)]"" S Y=$P(R664(3),U,2) D DD^%DT S RMPRDELD=Y
"RTN","RMPRP21",55,0)
 W !,"5. Veterans Address",?40,"6. Date Required",!,?5,VAPA(1),?45,RMPRDELD,!
"RTN","RMPRP21",56,0)
 I VAPA(2)="" W ?5,VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6),?40,$E(RMPRB,1,40),!,?40,"9. Authority For Issuance  CFR 17.115",!,?5,VAPA(8),?43,"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPRP21",57,0)
 I VAPA(2)'="" W ?5,VAPA(2),?40,$E(RMPRB,1,40),!,?5,VAPA(4)_","_$P(VAPA(5),U,2)_" "_VAPA(6),?40,"9. Authority For Issuance  CFR 17.115",!,?5,VAPA(8),?43,"CHARGE MEDICAL APPROPRIATION"
"RTN","RMPRP21",58,0)
 W !,RMPRB
"RTN","RMPRP21",59,0)
 W !,"7. Claim Number"_" "_VAEL(7),?40,"8. SSN"_" "_$P($P(VADM(2),U,2),"-",3),!,RMPRB,!,"10. Statistical Data",?30,"11. FOB Point",?46,"12. Discount",?61,"13. Delivery Time"
"RTN","RMPRP21",60,0)
 S R664("E")=$O(R664(1,0)),CAT=$P(R664(1,R664("E"),0),U,10)
"RTN","RMPRP21",61,0)
 S RMPRCAT=$S(CAT=1:"SC/OP",CAT=2:"SC/IP",CAT=3:"NSC/IP",CAT=4:"NSC/OP",1:"") S SPE=$P(R664(1,R664("E"),0),U,11)
"RTN","RMPRP21",62,0)
 S RMPRSCAT=$S(SPE=1:"SPECIAL LEGISLATION",SPE=2:"A&A",SPE=3:"PHC",SPE=4:"ELIGIBILITY REFORM",1:"")
"RTN","RMPRP21",63,0)
 W !,RMPRCAT_" "_RMPRSCAT S:+$P(R664(0),U,10) RMPRFOB=$P(R664(0),U,10) W ?34,$S($D(RMPRFOB):"ORIGIN",1:"DEST"),?49,"% " I $D(R664(2)) W $P(R664(2),U,6)
"RTN","RMPRP21",64,0)
 I $D(R664(3)) W ?66,$P(R664(3),U,3)_" Days"
"RTN","RMPRP21",65,0)
 W !,?30,$E(RMPRB,1,50),!,?30,"14. Delivery To: " W:$D(R664(3)) $P(R664(3),U) W !,RMPRB
"RTN","RMPRP21",66,0)
HDR1 ;HEADER FOR 10-2421
"RTN","RMPRP21",67,0)
 W !?17,"15. DESCRIPTION OF ITEMS OR SERVICES AUTHORIZED",!,RMPRB,!,"ITEM NUMBER",?23,"DESCRIPTION/NOMENCLATURE",?50,"QUANTITY",?60,"UNIT",?66,"UNIT",?73,"AMOUNT",!,?50,"ORDERED",?66,"PRICE",!,RMPRB Q:$D(RMPRMOR)
"RTN","RMPRP21",68,0)
 D ^RMPRP22 D:'$D(RMPRMOR1) CON^RMPRP22
"RTN","RMPRP21",69,0)
 S RMPRK=RMPRA
"RTN","RMPRP21",70,0)
 D:$D(RMPRPRIV) ^RMPRP23
"RTN","RMPRP21",71,0)
 W:$G(RMPRPN)=1 @IOF,$$EN^RMPRP24(RMPRK)
"RTN","RMPRP21",72,0)
EX ;KILL VARIABLES AND EXIT ROUTINE
"RTN","RMPRP21",73,0)
 K VADM,CP,DFN,CAT,DIC,R664,RMPRA,RMPACT,RMPRAD1,RMPRAD2,RMPRAMT,RMPRAMT1,RMPRB,RMPRCAT,RMPRCH,RMPRCITY,RMPRDELD,RMPRI,RMPRI1,RMPRIT,RMPRN,RMPRODTE,RMPRST,RMPRPHON,RMPRT,RMPRTOT,RMPRUT,RMPRV,RMPR90IP,RO,RP,J1,RTN,RMPRMOR1,RMPRPRIV
"RTN","RMPRP21",74,0)
 K SPE,VA,VAEL,VAPA,VAERR,RZZZ,RX,RX1,RDUZ,RC,RMPRACT,RMPRSCAT,RMPRDISC,RMPRAMTN,DIR,DIRUT,RMPRAMT2,RMPRFOB,RMPRDA,RMPRMOR,RMPRPAGE,RMPRPRIV,RMPRX,RMPR90,J,K,N D ^%ZISC Q
"VER")
8.0^22.0
"BLD",6246,6)
^105
**END**
**END**
