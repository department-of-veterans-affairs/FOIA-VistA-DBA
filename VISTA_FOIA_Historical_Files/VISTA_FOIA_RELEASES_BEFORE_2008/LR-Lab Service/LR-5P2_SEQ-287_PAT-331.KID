Released LR*5.2*331 SEQ #287
Extracted from mail message
**KIDS**:LR*5.2*331^

**INSTALL NAME**
LR*5.2*331
"BLD",6307,0)
LR*5.2*331^LAB SERVICE^0^3070601^y
"BLD",6307,1,0)
^9.61A^416^416^3070601^^^^
"BLD",6307,1,1,0)
Blood Bank Clearance
"BLD",6307,1,2,0)
====================
"BLD",6307,1,3,0)
VISTA Laboratory Package patch LR*5.2*331 contains changes to software
"BLD",6307,1,4,0)
controlled by VHA DIRECTIVE 2004-058, titled VISTA BLOOD BANK SOFTWARE.
"BLD",6307,1,5,0)
Changes include: 
"BLD",6307,1,6,0)
 
"BLD",6307,1,7,0)
  The patch will remove the "AD" cross-reference from the ACCESSION
"BLD",6307,1,8,0)
  field (#15) in the ACCESSION NUMBER sub-file (#68.02) in the
"BLD",6307,1,9,0)
  ACCESSION file (#68).
"BLD",6307,1,10,0)
  
"BLD",6307,1,11,0)
  The IN COMMON ACCESSION field (#15.1) is added to the ACCESSION
"BLD",6307,1,12,0)
  NUMBER sub-file (#68.02) of the ACCESSION file (#68).
"BLD",6307,1,13,0)
 
"BLD",6307,1,14,0)
  STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"BLD",6307,1,15,0)
  STORED IN ^LRO(68,D0,1,D1,1,
"BLD",6307,1,16,0)
  
"BLD",6307,1,17,0)
  DATA        NAME                  GLOBAL        DATA
"BLD",6307,1,18,0)
  ELEMENT     TITLE                 LOCATION      TYPE
"BLD",6307,1,19,0)
  -----------------------------------------------------------------------
"BLD",6307,1,20,0)
  
"BLD",6307,1,21,0)
  68.02,15    ACCESSION              .2;1 FREE TEXT
"BLD",6307,1,22,0)
  
"BLD",6307,1,23,0)
             PRINTABLE ACCESSION
"BLD",6307,1,24,0)
             INPUT TRANSFORM:  K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>15!
"BLD",6307,1,25,0)
                               ($L(X)<7) X
"BLD",6307,1,26,0)
             LAST EDITED:      MAR 03, 2005
"BLD",6307,1,27,0)
             HELP-PROMPT:      ANSWER MUST BE ACCESSION, e.g., CH 0428 125
"BLD",6307,1,28,0)
             DESCRIPTION:      The printable form of the Accession is
"BLD",6307,1,29,0)
                                 stored here.
"BLD",6307,1,30,0)
  
"BLD",6307,1,31,0)
  
"BLD",6307,1,32,0)
  68.02,15.1  IN COMMON ACCESSION    AD;1 FREE TEXT
"BLD",6307,1,33,0)
  
"BLD",6307,1,34,0)
             INPUT TRANSFORM:  K:$L(X)>15!($L(X)<7) X
"BLD",6307,1,35,0)
             LAST EDITED:      MAR 03, 2005
"BLD",6307,1,36,0)
             HELP-PROMPT:      Answer must be 7-15 characters in length
"BLD",6307,1,37,0)
             DESCRIPTION:      When this accession area is 'in common'
"BLD",6307,1,38,0)
                               with another accession area the printable
"BLD",6307,1,39,0)
                               form of the 'in common' accession is stored
"BLD",6307,1,40,0)
                               here.
"BLD",6307,1,41,0)
  
"BLD",6307,1,42,0)
  The LOG field (#.001) in the ACCESSION NUMBER sub-file (#68.02) of
"BLD",6307,1,43,0)
  the ACCESSION file (#68) is modified to increase the upper limit
"BLD",6307,1,44,0)
  of accession numbers from 9999 to 999999.
"BLD",6307,1,45,0)
  
"BLD",6307,1,46,0)
     STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"BLD",6307,1,47,0)
     STORED IN ^LRO(68,D0,1,D1,1,
"BLD",6307,1,48,0)
  
"BLD",6307,1,49,0)
     DATA         NAME                  GLOBAL        DATA
"BLD",6307,1,50,0)
     ELEMENT      TITLE                 LOCATION      TYPE
"BLD",6307,1,51,0)
     --------------------------------------------------------------------
"BLD",6307,1,52,0)
  
"BLD",6307,1,53,0)
     68.02,.001   LOG                                 NUMBER
"BLD",6307,1,54,0)
  
"BLD",6307,1,55,0)
          INPUT TRANSFORM: K:+X'=X!(X>999999)!(X<1)!(X?.E1"."1.N) X
"BLD",6307,1,56,0)
          LAST EDITED:     MAR 14, 2005
"BLD",6307,1,57,0)
          HELP-PROMPT:     Type a number between 1 and 999999, 0 Decimal
"BLD",6307,1,58,0)
                           Digits
"BLD",6307,1,59,0)
          DESCRIPTION:     The numeric part of the accession.
"BLD",6307,1,60,0)
 
"BLD",6307,1,61,0)
All of the above changes have been reviewed by the VISTA Blood Bank
"BLD",6307,1,62,0)
Developer and found to have no impact on the VISTA BLOOD BANK SOFTWARE
"BLD",6307,1,63,0)
control functions.
"BLD",6307,1,64,0)
 
"BLD",6307,1,65,0)
RISK ANALYSIS: Changes made by patch LR*5.2*331 have no effect on Blood
"BLD",6307,1,66,0)
Bank software functionality, therefore RISK is none.
"BLD",6307,1,67,0)
 
"BLD",6307,1,68,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*331 does not
"BLD",6307,1,69,0)
alter or modify any software design safeguards or safety critical elements
"BLD",6307,1,70,0)
functions.
"BLD",6307,1,71,0)
 
"BLD",6307,1,72,0)
POTENTIAL IMPACT ON SITES: This patch contains changes to 0 routines and 1
"BLD",6307,1,73,0)
file identified in Veterans Health Administration (VHA) Directive 2004-058,
"BLD",6307,1,74,0)
group B listing. The changes have no effect on Blood Bank functionality or
"BLD",6307,1,75,0)
medical device control functions. There is no adverse potential to sites.
"BLD",6307,1,76,0)
 
"BLD",6307,1,77,0)
 
"BLD",6307,1,78,0)
VALIDATION REQUIREMENTS BY OPTION: 
"BLD",6307,1,79,0)
There are no validation requirements for this patch.
"BLD",6307,1,80,0)
 
"BLD",6307,1,81,0)
MINIMAL TEST CASE SCENARIOS BY OPTION, INCLUSIVE OF ALL CONTROL FUNCTIONS:
"BLD",6307,1,82,0)
There are no test case scenarios for this patch.
"BLD",6307,1,83,0)
============================================================================
"BLD",6307,1,84,0)
 
"BLD",6307,1,85,0)
Patch Description:
"BLD",6307,1,86,0)
==================
"BLD",6307,1,87,0)
This patch addresses 3 issues in the Laboratory package pertaining to 
"BLD",6307,1,88,0)
accessioning.
"BLD",6307,1,89,0)
 
"BLD",6307,1,90,0)
 
"BLD",6307,1,91,0)
ASSOCIATED REMEDY TICKETS:
"BLD",6307,1,92,0)
==========================
"BLD",6307,1,93,0)
1.  HD0000000071160 - LOCKED ACCESSION AREA
"BLD",6307,1,94,0)
 
"BLD",6307,1,95,0)
2.  HD0000000093193 - <UNDEFINED>WN1A^LRWLST1
"BLD",6307,1,96,0)
 
"BLD",6307,1,97,0)
3.  HD0000000102626 - Error -  <SUBSCRIPT>GRID+21^LR7OGMG
"BLD",6307,1,98,0)
    Duplicates:  HD0000000102632
"BLD",6307,1,99,0)
                 HD0000000103751
"BLD",6307,1,100,0)
                 HD0000000112457
"BLD",6307,1,101,0)
                 HD0000000122951
"BLD",6307,1,102,0)
                 HD0000000131510
"BLD",6307,1,103,0)
                 HD0000000138475
"BLD",6307,1,104,0)
                 HD0000000138900
"BLD",6307,1,105,0)
                 HD0000000142655
"BLD",6307,1,106,0)
                 HD0000000154545
"BLD",6307,1,107,0)
                 HD0000000155087
"BLD",6307,1,108,0)
                 HD0000000160742
"BLD",6307,1,109,0)
                 HD0000000170863
"BLD",6307,1,110,0)
                 HD0000000179768
"BLD",6307,1,111,0)
                 HD0000000180175
"BLD",6307,1,112,0)
 
"BLD",6307,1,113,0)
 
"BLD",6307,1,114,0)
PARTICIPATING TEST SITES:
"BLD",6307,1,115,0)
=========================
"BLD",6307,1,116,0)
ASHEVILLE, NC 
"BLD",6307,1,117,0)
CENTRAL TEXAS HCS 
"BLD",6307,1,118,0)
CLEVELAND, OH 
"BLD",6307,1,119,0)
MARYLAND HCS
"BLD",6307,1,120,0)
MILWAUKEE, WI 
"BLD",6307,1,121,0)
NORTH CHICAGO, IL 
"BLD",6307,1,122,0)
SALISBURY, NC 
"BLD",6307,1,123,0)
VA GREATER LOS ANGELES HCS
"BLD",6307,1,124,0)
 
"BLD",6307,1,125,0)
 
"BLD",6307,1,126,0)
REMEDY OVERVIEW:
"BLD",6307,1,127,0)
================
"BLD",6307,1,128,0)
 
"BLD",6307,1,129,0)
1.1. HD0000000071160:
"BLD",6307,1,130,0)
---------------------
"BLD",6307,1,131,0)
A user reported encountering "FileMan DBS call failed during accessioning
"BLD",6307,1,132,0)
in routine LRWLST1" MailMan bulletins during accessioning. The generation
"BLD",6307,1,133,0)
of this bulletin occurs when Laboratory was making a duplicate FileMan DBS
"BLD",6307,1,134,0)
call during accessioning that involved an accession area being 'in common'
"BLD",6307,1,135,0)
with another accession area.  This duplicate call would occur when the
"BLD",6307,1,136,0)
accession area has a lower internal entry number in ACCESSION file (#68)
"BLD",6307,1,137,0)
than the accession area it is 'in common' with.
"BLD",6307,1,138,0)
 
"BLD",6307,1,139,0)
 
"BLD",6307,1,140,0)
1.2. HD0000000071160:
"BLD",6307,1,141,0)
----------------------
"BLD",6307,1,142,0)
During internal software review, the following issues were identified:
"BLD",6307,1,143,0)
 
"BLD",6307,1,144,0)
  a. It was determined that the "AD" CROSS-REFERENCE on ACCESSION field
"BLD",6307,1,145,0)
     (#15) in ACCESSION NUMBER sub-file (#68.02) of ACCESSION file (#68)
"BLD",6307,1,146,0)
     was not setting the reference to the 'in common' accession correctly
"BLD",6307,1,147,0)
     on the accession. The patch will remove this cross-reference from
"BLD",6307,1,148,0)
     the data dictionary. See 2b. for storing 'in common' accession
"BLD",6307,1,149,0)
     reference.
"BLD",6307,1,150,0)
 
"BLD",6307,1,151,0)
  b. Field IN COMMON ACCESSION (#15.1) in ACCESSION NUMBER sub-file
"BLD",6307,1,152,0)
     (#68.02) of ACCESSION file (#68) is added to the data dictionary
"BLD",6307,1,153,0)
     to store the reference to the 'in common' accession when this
"BLD",6307,1,154,0)
     relationship exists.  Routine LRWLST11 will update this field when
"BLD",6307,1,155,0)
     appropriate.
"BLD",6307,1,156,0)
 
"BLD",6307,1,157,0)
   STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"BLD",6307,1,158,0)
   STORED IN ^LRO(68,D0,1,D1,1,
"BLD",6307,1,159,0)
 
"BLD",6307,1,160,0)
   DATA        NAME                  GLOBAL        DATA
"BLD",6307,1,161,0)
   ELEMENT     TITLE                 LOCATION      TYPE
"BLD",6307,1,162,0)
   -----------------------------------------------------------------------
"BLD",6307,1,163,0)
 
"BLD",6307,1,164,0)
   68.02,15    ACCESSION              .2;1 FREE TEXT
"BLD",6307,1,165,0)
 
"BLD",6307,1,166,0)
              PRINTABLE ACCESSION
"BLD",6307,1,167,0)
              INPUT TRANSFORM:  K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>15!
"BLD",6307,1,168,0)
                                ($L(X)<7) X
"BLD",6307,1,169,0)
              LAST EDITED:      MAR 03, 2005
"BLD",6307,1,170,0)
              HELP-PROMPT:      ANSWER MUST BE ACCESSION, e.g., CH 0428 125
"BLD",6307,1,171,0)
              DESCRIPTION:      The printable form of the Accession is
"BLD",6307,1,172,0)
                                stored here.
"BLD",6307,1,173,0)
 
"BLD",6307,1,174,0)
 
"BLD",6307,1,175,0)
   68.02,15.1  IN COMMON ACCESSION    AD;1 FREE TEXT
"BLD",6307,1,176,0)
 
"BLD",6307,1,177,0)
              INPUT TRANSFORM:  K:$L(X)>15!($L(X)<7) X
"BLD",6307,1,178,0)
              LAST EDITED:      MAR 03, 2005
"BLD",6307,1,179,0)
              HELP-PROMPT:      Answer must be 7-15 characters in length
"BLD",6307,1,180,0)
              DESCRIPTION:      When this accession area is 'in common'
"BLD",6307,1,181,0)
                                with another accession area the printable
"BLD",6307,1,182,0)
                                form of the 'in common' accession is stored
"BLD",6307,1,183,0)
                                here.
"BLD",6307,1,184,0)
 
"BLD",6307,1,185,0)
   c. Field LOG (#.001) in ACCESSION NUMBER sub-file (#68.02) of ACCESSION
"BLD",6307,1,186,0)
      file (#68) is modified to increase the upper limit of accession
"BLD",6307,1,187,0)
      numbers from 9999 to 999999.
"BLD",6307,1,188,0)
 
"BLD",6307,1,189,0)
      STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"BLD",6307,1,190,0)
      STORED IN ^LRO(68,D0,1,D1,1,
"BLD",6307,1,191,0)
 
"BLD",6307,1,192,0)
      DATA         NAME                  GLOBAL        DATA
"BLD",6307,1,193,0)
      ELEMENT      TITLE                 LOCATION      TYPE
"BLD",6307,1,194,0)
      --------------------------------------------------------------------
"BLD",6307,1,195,0)
 
"BLD",6307,1,196,0)
      68.02,.001   LOG                                 NUMBER
"BLD",6307,1,197,0)
 
"BLD",6307,1,198,0)
           INPUT TRANSFORM: K:+X'=X!(X>999999)!(X<1)!(X?.E1"."1.N) X
"BLD",6307,1,199,0)
           LAST EDITED:     MAR 14, 2005
"BLD",6307,1,200,0)
           HELP-PROMPT:     Type a number between 1 and 999999, 0 Decimal
"BLD",6307,1,201,0)
                            Digits
"BLD",6307,1,202,0)
           DESCRIPTION:     The numeric part of the accession.
"BLD",6307,1,203,0)
 
"BLD",6307,1,204,0)
 
"BLD",6307,1,205,0)
   d. The functionality to allow the user to force an accession to a
"BLD",6307,1,206,0)
      specific number could cause a 'stack overflow' error due to how the
"BLD",6307,1,207,0)
      M NEW command was implemented. Coding changes to LRWLST1 will only
"BLD",6307,1,208,0)
      NEW certain variables once.
"BLD",6307,1,209,0)
 
"BLD",6307,1,210,0)
   e. Direct READs in routine LRWLST1 have been replaced with FileMan
"BLD",6307,1,211,0)
      supported DIR reader API calls.
"BLD",6307,1,212,0)
 
"BLD",6307,1,213,0)
 
"BLD",6307,1,214,0)
2. HD0000000093193:
"BLD",6307,1,215,0)
-------------------
"BLD",6307,1,216,0)
A user reported an <UNDEFINED>WN1A^LRWLST1 error when accessioning. This
"BLD",6307,1,217,0)
would occur when attempting to force an accession number for an accession
"BLD",6307,1,218,0)
area that did not have any accessions for the current accession day.
"BLD",6307,1,219,0)
Routine LRWLST1 will now handle displaying a default accession number 1
"BLD",6307,1,220,0)
when there are no existing accessions for the current accession day.
"BLD",6307,1,221,0)
 
"BLD",6307,1,222,0)
 
"BLD",6307,1,223,0)
3. HD0000000102626:
"BLD",6307,1,224,0)
-------------------
"BLD",6307,1,225,0)
A user reported a <SUBSCRIPT>GRID+21^LR7OGMG error when using the CPRS Lab
"BLD",6307,1,226,0)
Reports tab to display recent laboratory results.  This would occur when
"BLD",6307,1,227,0)
there are three or more tests on an accession, at least two of the tests
"BLD",6307,1,228,0)
were performed at different laboratories and a third test had a 'pending'
"BLD",6307,1,229,0)
result and therefore no performing laboratory designated.  The software
"BLD",6307,1,230,0)
was attempting to determine the performing laboratory for the pending
"BLD",6307,1,231,0)
test. Routine LR7OGMG will now ignore tests that do not have a performing
"BLD",6307,1,232,0)
laboratory when constructing the list of performing laboratories
"BLD",6307,1,233,0)
associated with an accession's test results.
"BLD",6307,1,234,0)
     
"BLD",6307,1,235,0)
  
"BLD",6307,1,236,0)
INSTALLATION INSTRUCTIONS
"BLD",6307,1,237,0)
-------------------------
"BLD",6307,1,238,0)
  The install time for this patch is less than 5 minute. This patch
"BLD",6307,1,239,0)
  can be installed when Laboratory users are on the system.
"BLD",6307,1,240,0)
  Suggested time to install: non-peak requirement hours.
"BLD",6307,1,241,0)
 
"BLD",6307,1,242,0)
 
"BLD",6307,1,243,0)
NOTE: Kernel patches must be current on the target system to avoid
"BLD",6307,1,244,0)
      problems loading and/or installing this patch.
"BLD",6307,1,245,0)
 
"BLD",6307,1,246,0)
      Patch installation needs to be coordinated with the Laboratory
"BLD",6307,1,247,0)
      Information Manager (LIM/ADPAC).
"BLD",6307,1,248,0)
 
"BLD",6307,1,249,0)
 
"BLD",6307,1,250,0)
  1.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",6307,1,251,0)
        option will load the KIDS package onto your system.
"BLD",6307,1,252,0)
 
"BLD",6307,1,253,0)
  2.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"BLD",6307,1,254,0)
      select the 'Installation' menu.
"BLD",6307,1,255,0)
 
"BLD",6307,1,256,0)
  3.  From this menu, you may then elect to use the following options
"BLD",6307,1,257,0)
      (when prompted for the INSTALL NAME, enter LR*5.2*331):
"BLD",6307,1,258,0)
        a. Print Transport Global
"BLD",6307,1,259,0)
        b. Backup a Transport Global
"BLD",6307,1,260,0)
        c. Compare Transport Global to Current System
"BLD",6307,1,261,0)
        d. Verify Checksums in Transport Global
"BLD",6307,1,262,0)
 
"BLD",6307,1,263,0)
      Use the 'Verify Checksum in Transport Global' option and verify that
"BLD",6307,1,264,0)
      all routines have the correct checksums.
"BLD",6307,1,265,0)
 
"BLD",6307,1,266,0)
  4.  Use the 'Install Package(s)' option under the 'Installation' menu
"BLD",6307,1,267,0)
      and select the package 'LR*5.2*331'.
"BLD",6307,1,268,0)
    
"BLD",6307,1,269,0)
      When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
"BLD",6307,1,270,0)
      Install? YES//' choose 'NO'. Responding 'Yes' to the prompt for
"BLD",6307,1,271,0)
      rebuilding menu trees can significantly increase install time.
"BLD",6307,1,272,0)
 
"BLD",6307,1,273,0)
      When prompted 'Want KIDS to INHIBIT LOGONs during the install?
"BLD",6307,1,274,0)
      YES// choose 'NO'. 
"BLD",6307,1,275,0)
 
"BLD",6307,1,276,0)
      When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
"BLD",6307,1,277,0)
      Protocols? YES//', choose 'NO'.
"BLD",6307,1,278,0)
 
"BLD",6307,1,279,0)
     The install will automatically disable the following options:
"BLD",6307,1,280,0)
 
"BLD",6307,1,281,0)
       Accession order then immediately enter data [LR ACC THEN DATA]
"BLD",6307,1,282,0)
       Batch data entry (chem, hem, tox, etc.) [LRSTUF]
"BLD",6307,1,283,0)
       Bypass normal data entry [LRFAST]
"BLD",6307,1,284,0)
       Fast Bypass Data Entry/Verify [LRFASTS]
"BLD",6307,1,285,0)
       Special test accessioning [LRNONCOM]
"BLD",6307,1,286,0)
       Merge Accessions [LRACC MERGE]
"BLD",6307,1,287,0)
       Add tests to a given accession [LRADD TO ACC]
"BLD",6307,1,288,0)
       Add tests to an already existing order number. [LRADD TO ORDER]
"BLD",6307,1,289,0)
       Lab add test(s) to an existing order [LRADDTST]
"BLD",6307,1,290,0)
       Delete entire order or individual tests [LRCENDEL]
"BLD",6307,1,291,0)
       Remove an accession [LRDELOG]
"BLD",6307,1,292,0)
       Referral Patient Multi-purpose Accession [LRLEDI]
"BLD",6307,1,293,0)
       Accessioning, standard (Microbiology) [LRMICROLOGIN]
"BLD",6307,1,294,0)
       Accessioning tests ordered by ward order entry [LROE]
"BLD",6307,1,295,0)
       Lab test order [LROW]
"BLD",6307,1,296,0)
       Fast lab test order (IMMEDIATE COLLECT) [LROW IMMED COLLECT]
"BLD",6307,1,297,0)
       Fast lab test order (ROUTINE) [LROW ROUTINE]
"BLD",6307,1,298,0)
       Fast lab test order (SEND PATIENT) [LROW SEND PAT]
"BLD",6307,1,299,0)
       Fast lab test order (WARD COLLECT) [LROW WARD COL]
"BLD",6307,1,300,0)
       Receipt of routine lab collection from wards [LRPHEXCPT]
"BLD",6307,1,301,0)
       Itemized routine lab collection [LRPHITEM]
"BLD",6307,1,302,0)
       Manually accession QC, Environmental, etc. [LRQCLOG]
"BLD",6307,1,303,0)
       Multipurpose accessioning [LRQUICK]
"BLD",6307,1,304,0)
       Delete test from an accession [LRTSTOUT]
"BLD",6307,1,305,0)
 
"BLD",6307,1,306,0)
 
"BLD",6307,1,307,0)
 Note: Routine LR331 will be deleted after successful patch installation. 
"BLD",6307,1,308,0)
 
"BLD",6307,1,309,0)
  
"BLD",6307,1,310,0)
INSTALLATION EXAMPLE
"BLD",6307,1,311,0)
====================
"BLD",6307,1,312,0)
 
"BLD",6307,1,313,0)
Select Installation Option:
"BLD",6307,1,314,0)
 
"BLD",6307,1,315,0)
Select Kernel Installation & Distribution System Option:  Installation
"BLD",6307,1,316,0)
 
"BLD",6307,1,317,0)
Select Installation Option: 6  Install Package(s)
"BLD",6307,1,318,0)
Select INSTALL NAME: LR*5.2*331 Loaded from Distribution  Loaded from
"BLD",6307,1,319,0)
Distribution  3/10/05@16:26:40
"BLD",6307,1,320,0)
     => LR*5.2*331 
"BLD",6307,1,321,0)
 
"BLD",6307,1,322,0)
This Distribution was loaded on Mar 10, 2005@16:26:40 with header of
"BLD",6307,1,323,0)
   LR*5.2*331 
"BLD",6307,1,324,0)
   It consisted of the following Install(s):
"BLD",6307,1,325,0)
     LR*5.2*331
"BLD",6307,1,326,0)
Checking Install for Package LR*5.2*331
"BLD",6307,1,327,0)
Will first run the Environment Check Routine, LR331
"BLD",6307,1,328,0)
 
"BLD",6307,1,329,0)
 
"BLD",6307,1,330,0)
               Sending install started alert to mail group G.LMI
"BLD",6307,1,331,0)
 
"BLD",6307,1,332,0)
                        --- Environment Check is Ok ---
"BLD",6307,1,333,0)
 
"BLD",6307,1,334,0)
Install Questions for LR*5.2*331
"BLD",6307,1,335,0)
 
"BLD",6307,1,336,0)
Incoming Files:
"BLD",6307,1,337,0)
 
"BLD",6307,1,338,0)
 
"BLD",6307,1,339,0)
   68        ACCESSION  (Partial Definition)
"BLD",6307,1,340,0)
Note:  You already have the 'ACCESSION' File.
"BLD",6307,1,341,0)
 
"BLD",6307,1,342,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// NO
"BLD",6307,1,343,0)
 
"BLD",6307,1,344,0)
 
"BLD",6307,1,345,0)
Want KIDS to INHIBIT LOGONs during the install? YES// NO
"BLD",6307,1,346,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"BLD",6307,1,347,0)
 
"BLD",6307,1,348,0)
Enter the Device you want to print the Install messages.
"BLD",6307,1,349,0)
You can queue the install by enter a 'Q' at the device prompt.
"BLD",6307,1,350,0)
Enter a '^' to abort the install.
"BLD",6307,1,351,0)
 
"BLD",6307,1,352,0)
DEVICE: HOME//  TELNET
"BLD",6307,1,353,0)
 
"BLD",6307,1,354,0)
 
"BLD",6307,1,355,0)
 Install Started for LR*5.2*331 :
"BLD",6307,1,356,0)
               Mar 10, 2005@16:27:01
"BLD",6307,1,357,0)
 
"BLD",6307,1,358,0)
Build Distribution Date: Mar 10, 2005
"BLD",6307,1,359,0)
 
"BLD",6307,1,360,0)
 Installing Routines:
"BLD",6307,1,361,0)
               Mar 10, 2005@16:27:01
"BLD",6307,1,362,0)
 
"BLD",6307,1,363,0)
 Running Pre-Install Routine: PRE^LR331
"BLD",6307,1,364,0)
 
"BLD",6307,1,365,0)
                          *** Pre install started ***
"BLD",6307,1,366,0)
 
"BLD",6307,1,367,0)
                   Deleting Field #15 in file #68, ACCESSION
"BLD",6307,1,368,0)
 
"BLD",6307,1,369,0)
              Field will be installed as part of KIDS installation
"BLD",6307,1,370,0)
 
"BLD",6307,1,371,0)
                         *** Pre install completed ***
"BLD",6307,1,372,0)
 
"BLD",6307,1,373,0)
 Installing Data Dictionaries:
"BLD",6307,1,374,0)
               Mar 10, 2005@16:27:01
"BLD",6307,1,375,0)
 
"BLD",6307,1,376,0)
 Installing PACKAGE COMPONENTS:
"BLD",6307,1,377,0)
 
"BLD",6307,1,378,0)
 Installing OPTION
"BLD",6307,1,379,0)
               Mar 10, 2005@16:27:01
"BLD",6307,1,380,0)
 
"BLD",6307,1,381,0)
 Running Post-Install Routine: POST^LR331
"BLD",6307,1,382,0)
 
"BLD",6307,1,383,0)
                          *** Post install started ***
"BLD",6307,1,384,0)
 
"BLD",6307,1,385,0)
                           *** No action required ***
"BLD",6307,1,386,0)
 
"BLD",6307,1,387,0)
                         *** Post install completed ***
"BLD",6307,1,388,0)
 
"BLD",6307,1,389,0)
              Sending install completion alert to mail group G.LMI
"BLD",6307,1,390,0)
 
"BLD",6307,1,391,0)
 Updating Routine file...
"BLD",6307,1,392,0)
 
"BLD",6307,1,393,0)
 Updating KIDS files...
"BLD",6307,1,394,0)
 
"BLD",6307,1,395,0)
 LR*5.2*331 Installed.
"BLD",6307,1,396,0)
               Mar 10, 2005@16:27:01
"BLD",6307,1,397,0)
 
"BLD",6307,1,398,0)
 Install Message sent #xxxx
"BLD",6307,1,399,0)
 
"BLD",6307,1,400,0)
Install Completed
"BLD",6307,1,401,0)
 
"BLD",6307,1,402,0)
ROUTINE SUMMARY:
"BLD",6307,1,403,0)
================
"BLD",6307,1,404,0)
The following routines are included in this patch.  The second line of
"BLD",6307,1,405,0)
each of these routines now looks like:
"BLD",6307,1,406,0)
 
"BLD",6307,1,407,0)
  <tab> ;;5.2;LAB SERVICE;**[patchlist]**;Sep 27, 1994
"BLD",6307,1,408,0)
 
"BLD",6307,1,409,0)
                 Checksum       Checksum
"BLD",6307,1,410,0)
Routine Name     Before Patch   After Patch    Patch List
"BLD",6307,1,411,0)
------------     ------------   -----------    ------------
"BLD",6307,1,412,0)
LR331             N/A            5261822       331  (Deleted by KIDS)
"BLD",6307,1,413,0)
LR7OGMG          5478031        5490638        187,230,286,290,331
"BLD",6307,1,414,0)
LRWLST1          12664045       11171614       48,65,121,153,261,286,331
"BLD",6307,1,415,0)
LRWLST11         16883055       15996378       121,128,153,202,286,331
"BLD",6307,1,416,0)

"BLD",6307,4,0)
^9.64PA^68^1
"BLD",6307,4,68,0)
68
"BLD",6307,4,68,2,0)
^9.641^68.02^1
"BLD",6307,4,68,2,68.02,0)
ACCESSION NUMBER  (sub-file)
"BLD",6307,4,68,2,68.02,1,0)
^9.6411^.001^3
"BLD",6307,4,68,2,68.02,1,.001,0)
LOG
"BLD",6307,4,68,2,68.02,1,15,0)
ACCESSION
"BLD",6307,4,68,2,68.02,1,15.1,0)
IN COMMON ACCESSION
"BLD",6307,4,68,222)
y^n^p^^^^n^^n
"BLD",6307,4,68,224)

"BLD",6307,4,"APDD",68,68.02)

"BLD",6307,4,"APDD",68,68.02,.001)

"BLD",6307,4,"APDD",68,68.02,15)

"BLD",6307,4,"APDD",68,68.02,15.1)

"BLD",6307,4,"B",68,68)

"BLD",6307,6)
5^
"BLD",6307,6.3)
7
"BLD",6307,"ABPKG")
n
"BLD",6307,"INI")
PRE^LR331
"BLD",6307,"INID")
y
"BLD",6307,"INIT")
POST^LR331
"BLD",6307,"KRN",0)
^9.67PA^8989.52^19
"BLD",6307,"KRN",.4,0)
.4
"BLD",6307,"KRN",.401,0)
.401
"BLD",6307,"KRN",.402,0)
.402
"BLD",6307,"KRN",.403,0)
.403
"BLD",6307,"KRN",.5,0)
.5
"BLD",6307,"KRN",.84,0)
.84
"BLD",6307,"KRN",3.6,0)
3.6
"BLD",6307,"KRN",3.8,0)
3.8
"BLD",6307,"KRN",9.2,0)
9.2
"BLD",6307,"KRN",9.8,0)
9.8
"BLD",6307,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",6307,"KRN",9.8,"NM",1,0)
LRWLST1^^0^B75742074
"BLD",6307,"KRN",9.8,"NM",2,0)
LRWLST11^^0^B57122966
"BLD",6307,"KRN",9.8,"NM",3,0)
LR7OGMG^^0^B11682184
"BLD",6307,"KRN",9.8,"NM","B","LR7OGMG",3)

"BLD",6307,"KRN",9.8,"NM","B","LRWLST1",1)

"BLD",6307,"KRN",9.8,"NM","B","LRWLST11",2)

"BLD",6307,"KRN",19,0)
19
"BLD",6307,"KRN",19,"NM",0)
^9.68A^24^24
"BLD",6307,"KRN",19,"NM",1,0)
LRQUICK^^5^
"BLD",6307,"KRN",19,"NM",2,0)
LR ACC THEN DATA^^5^
"BLD",6307,"KRN",19,"NM",3,0)
LRACC MERGE^^5^
"BLD",6307,"KRN",19,"NM",4,0)
LRADD TO ACC^^5^
"BLD",6307,"KRN",19,"NM",5,0)
LRADD TO ORDER^^5^
"BLD",6307,"KRN",19,"NM",6,0)
LRADDTST^^5^
"BLD",6307,"KRN",19,"NM",7,0)
LRCENDEL^^5^
"BLD",6307,"KRN",19,"NM",8,0)
LRDELOG^^5^
"BLD",6307,"KRN",19,"NM",9,0)
LRFAST^^5^
"BLD",6307,"KRN",19,"NM",10,0)
LRFASTS^^5^
"BLD",6307,"KRN",19,"NM",11,0)
LRLEDI^^5^
"BLD",6307,"KRN",19,"NM",12,0)
LRMICROLOGIN^^5^
"BLD",6307,"KRN",19,"NM",13,0)
LRNONCOM^^5^
"BLD",6307,"KRN",19,"NM",14,0)
LRQCLOG^^5^
"BLD",6307,"KRN",19,"NM",15,0)
LRSTUF^^5^
"BLD",6307,"KRN",19,"NM",16,0)
LRTSTOUT^^5^
"BLD",6307,"KRN",19,"NM",17,0)
LROW^^5^
"BLD",6307,"KRN",19,"NM",18,0)
LROE^^5^
"BLD",6307,"KRN",19,"NM",19,0)
LROW IMMED COLLECT^^5^
"BLD",6307,"KRN",19,"NM",20,0)
LROW ROUTINE^^5^
"BLD",6307,"KRN",19,"NM",21,0)
LROW SEND PAT^^5^
"BLD",6307,"KRN",19,"NM",22,0)
LROW WARD COL^^5^
"BLD",6307,"KRN",19,"NM",23,0)
LRPHITEM^^5^
"BLD",6307,"KRN",19,"NM",24,0)
LRPHEXCPT^^5^
"BLD",6307,"KRN",19,"NM","B","LR ACC THEN DATA",2)

"BLD",6307,"KRN",19,"NM","B","LRACC MERGE",3)

"BLD",6307,"KRN",19,"NM","B","LRADD TO ACC",4)

"BLD",6307,"KRN",19,"NM","B","LRADD TO ORDER",5)

"BLD",6307,"KRN",19,"NM","B","LRADDTST",6)

"BLD",6307,"KRN",19,"NM","B","LRCENDEL",7)

"BLD",6307,"KRN",19,"NM","B","LRDELOG",8)

"BLD",6307,"KRN",19,"NM","B","LRFAST",9)

"BLD",6307,"KRN",19,"NM","B","LRFASTS",10)

"BLD",6307,"KRN",19,"NM","B","LRLEDI",11)

"BLD",6307,"KRN",19,"NM","B","LRMICROLOGIN",12)

"BLD",6307,"KRN",19,"NM","B","LRNONCOM",13)

"BLD",6307,"KRN",19,"NM","B","LROE",18)

"BLD",6307,"KRN",19,"NM","B","LROW",17)

"BLD",6307,"KRN",19,"NM","B","LROW IMMED COLLECT",19)

"BLD",6307,"KRN",19,"NM","B","LROW ROUTINE",20)

"BLD",6307,"KRN",19,"NM","B","LROW SEND PAT",21)

"BLD",6307,"KRN",19,"NM","B","LROW WARD COL",22)

"BLD",6307,"KRN",19,"NM","B","LRPHEXCPT",24)

"BLD",6307,"KRN",19,"NM","B","LRPHITEM",23)

"BLD",6307,"KRN",19,"NM","B","LRQCLOG",14)

"BLD",6307,"KRN",19,"NM","B","LRQUICK",1)

"BLD",6307,"KRN",19,"NM","B","LRSTUF",15)

"BLD",6307,"KRN",19,"NM","B","LRTSTOUT",16)

"BLD",6307,"KRN",19.1,0)
19.1
"BLD",6307,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6307,"KRN",101,0)
101
"BLD",6307,"KRN",409.61,0)
409.61
"BLD",6307,"KRN",771,0)
771
"BLD",6307,"KRN",870,0)
870
"BLD",6307,"KRN",8989.51,0)
8989.51
"BLD",6307,"KRN",8989.52,0)
8989.52
"BLD",6307,"KRN",8994,0)
8994
"BLD",6307,"KRN","B",.4,.4)

"BLD",6307,"KRN","B",.401,.401)

"BLD",6307,"KRN","B",.402,.402)

"BLD",6307,"KRN","B",.403,.403)

"BLD",6307,"KRN","B",.5,.5)

"BLD",6307,"KRN","B",.84,.84)

"BLD",6307,"KRN","B",3.6,3.6)

"BLD",6307,"KRN","B",3.8,3.8)

"BLD",6307,"KRN","B",9.2,9.2)

"BLD",6307,"KRN","B",9.8,9.8)

"BLD",6307,"KRN","B",19,19)

"BLD",6307,"KRN","B",19.1,19.1)

"BLD",6307,"KRN","B",101,101)

"BLD",6307,"KRN","B",409.61,409.61)

"BLD",6307,"KRN","B",771,771)

"BLD",6307,"KRN","B",870,870)

"BLD",6307,"KRN","B",8989.51,8989.51)

"BLD",6307,"KRN","B",8989.52,8989.52)

"BLD",6307,"KRN","B",8994,8994)

"BLD",6307,"PRE")
LR331
"BLD",6307,"QUES",0)
^9.62^^
"BLD",6307,"REQB",0)
^9.611^2^1
"BLD",6307,"REQB",2,0)
LR*5.2*290^2
"BLD",6307,"REQB","B","LR*5.2*290",2)

"FIA",68)
ACCESSION
"FIA",68,0)
^LRO(68,
"FIA",68,0,0)
68I
"FIA",68,0,1)
y^n^p^^^^n^^n
"FIA",68,0,10)

"FIA",68,0,11)

"FIA",68,0,"RLRO")

"FIA",68,0,"VR")
5.2^LR
"FIA",68,68)
1
"FIA",68,68.02)
1
"FIA",68,68.02,.001)

"FIA",68,68.02,15)

"FIA",68,68.02,15.1)

"INI")
PRE^LR331
"INIT")
POST^LR331
"KRN",19,8322,-1)
5^1
"KRN",19,8322,0)
LRQUICK
"KRN",19,8333,-1)
5^9
"KRN",19,8333,0)
LRFAST
"KRN",19,8336,-1)
5^18
"KRN",19,8336,0)
LROE
"KRN",19,8337,-1)
5^17
"KRN",19,8337,0)
LROW
"KRN",19,8342,-1)
5^14
"KRN",19,8342,0)
LRQCLOG
"KRN",19,8343,-1)
5^16
"KRN",19,8343,0)
LRTSTOUT
"KRN",19,8344,-1)
5^8
"KRN",19,8344,0)
LRDELOG
"KRN",19,8360,-1)
5^24
"KRN",19,8360,0)
LRPHEXCPT
"KRN",19,8361,-1)
5^13
"KRN",19,8361,0)
LRNONCOM
"KRN",19,8378,-1)
5^6
"KRN",19,8378,0)
LRADDTST
"KRN",19,8379,-1)
5^7
"KRN",19,8379,0)
LRCENDEL
"KRN",19,8380,-1)
5^15
"KRN",19,8380,0)
LRSTUF
"KRN",19,8387,-1)
5^20
"KRN",19,8387,0)
LROW ROUTINE
"KRN",19,8408,-1)
5^4
"KRN",19,8408,0)
LRADD TO ACC
"KRN",19,8409,-1)
5^5
"KRN",19,8409,0)
LRADD TO ORDER
"KRN",19,8415,-1)
5^12
"KRN",19,8415,0)
LRMICROLOGIN
"KRN",19,8430,-1)
5^21
"KRN",19,8430,0)
LROW SEND PAT
"KRN",19,8444,-1)
5^23
"KRN",19,8444,0)
LRPHITEM
"KRN",19,8452,-1)
5^22
"KRN",19,8452,0)
LROW WARD COL
"KRN",19,8622,-1)
5^2
"KRN",19,8622,0)
LR ACC THEN DATA
"KRN",19,8782,-1)
5^10
"KRN",19,8782,0)
LRFASTS
"KRN",19,8787,-1)
5^19
"KRN",19,8787,0)
LROW IMMED COLLECT
"KRN",19,8906,-1)
5^3
"KRN",19,8906,0)
LRACC MERGE
"KRN",19,8911,-1)
5^11
"KRN",19,8911,0)
LRLEDI
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2981028^66481
"PKG",26,22,1,"PAH",1,0)
331^3070601^235
"PKG",26,22,1,"PAH",1,1,0)
^^416^416^3070601
"PKG",26,22,1,"PAH",1,1,1,0)
Blood Bank Clearance
"PKG",26,22,1,"PAH",1,1,2,0)
====================
"PKG",26,22,1,"PAH",1,1,3,0)
VISTA Laboratory Package patch LR*5.2*331 contains changes to software
"PKG",26,22,1,"PAH",1,1,4,0)
controlled by VHA DIRECTIVE 2004-058, titled VISTA BLOOD BANK SOFTWARE.
"PKG",26,22,1,"PAH",1,1,5,0)
Changes include: 
"PKG",26,22,1,"PAH",1,1,6,0)
 
"PKG",26,22,1,"PAH",1,1,7,0)
  The patch will remove the "AD" cross-reference from the ACCESSION
"PKG",26,22,1,"PAH",1,1,8,0)
  field (#15) in the ACCESSION NUMBER sub-file (#68.02) in the
"PKG",26,22,1,"PAH",1,1,9,0)
  ACCESSION file (#68).
"PKG",26,22,1,"PAH",1,1,10,0)
  
"PKG",26,22,1,"PAH",1,1,11,0)
  The IN COMMON ACCESSION field (#15.1) is added to the ACCESSION
"PKG",26,22,1,"PAH",1,1,12,0)
  NUMBER sub-file (#68.02) of the ACCESSION file (#68).
"PKG",26,22,1,"PAH",1,1,13,0)
 
"PKG",26,22,1,"PAH",1,1,14,0)
  STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"PKG",26,22,1,"PAH",1,1,15,0)
  STORED IN ^LRO(68,D0,1,D1,1,
"PKG",26,22,1,"PAH",1,1,16,0)
  
"PKG",26,22,1,"PAH",1,1,17,0)
  DATA        NAME                  GLOBAL        DATA
"PKG",26,22,1,"PAH",1,1,18,0)
  ELEMENT     TITLE                 LOCATION      TYPE
"PKG",26,22,1,"PAH",1,1,19,0)
  -----------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,20,0)
  
"PKG",26,22,1,"PAH",1,1,21,0)
  68.02,15    ACCESSION              .2;1 FREE TEXT
"PKG",26,22,1,"PAH",1,1,22,0)
  
"PKG",26,22,1,"PAH",1,1,23,0)
             PRINTABLE ACCESSION
"PKG",26,22,1,"PAH",1,1,24,0)
             INPUT TRANSFORM:  K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>15!
"PKG",26,22,1,"PAH",1,1,25,0)
                               ($L(X)<7) X
"PKG",26,22,1,"PAH",1,1,26,0)
             LAST EDITED:      MAR 03, 2005
"PKG",26,22,1,"PAH",1,1,27,0)
             HELP-PROMPT:      ANSWER MUST BE ACCESSION, e.g., CH 0428 125
"PKG",26,22,1,"PAH",1,1,28,0)
             DESCRIPTION:      The printable form of the Accession is
"PKG",26,22,1,"PAH",1,1,29,0)
                                 stored here.
"PKG",26,22,1,"PAH",1,1,30,0)
  
"PKG",26,22,1,"PAH",1,1,31,0)
  
"PKG",26,22,1,"PAH",1,1,32,0)
  68.02,15.1  IN COMMON ACCESSION    AD;1 FREE TEXT
"PKG",26,22,1,"PAH",1,1,33,0)
  
"PKG",26,22,1,"PAH",1,1,34,0)
             INPUT TRANSFORM:  K:$L(X)>15!($L(X)<7) X
"PKG",26,22,1,"PAH",1,1,35,0)
             LAST EDITED:      MAR 03, 2005
"PKG",26,22,1,"PAH",1,1,36,0)
             HELP-PROMPT:      Answer must be 7-15 characters in length
"PKG",26,22,1,"PAH",1,1,37,0)
             DESCRIPTION:      When this accession area is 'in common'
"PKG",26,22,1,"PAH",1,1,38,0)
                               with another accession area the printable
"PKG",26,22,1,"PAH",1,1,39,0)
                               form of the 'in common' accession is stored
"PKG",26,22,1,"PAH",1,1,40,0)
                               here.
"PKG",26,22,1,"PAH",1,1,41,0)
  
"PKG",26,22,1,"PAH",1,1,42,0)
  The LOG field (#.001) in the ACCESSION NUMBER sub-file (#68.02) of
"PKG",26,22,1,"PAH",1,1,43,0)
  the ACCESSION file (#68) is modified to increase the upper limit
"PKG",26,22,1,"PAH",1,1,44,0)
  of accession numbers from 9999 to 999999.
"PKG",26,22,1,"PAH",1,1,45,0)
  
"PKG",26,22,1,"PAH",1,1,46,0)
     STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"PKG",26,22,1,"PAH",1,1,47,0)
     STORED IN ^LRO(68,D0,1,D1,1,
"PKG",26,22,1,"PAH",1,1,48,0)
  
"PKG",26,22,1,"PAH",1,1,49,0)
     DATA         NAME                  GLOBAL        DATA
"PKG",26,22,1,"PAH",1,1,50,0)
     ELEMENT      TITLE                 LOCATION      TYPE
"PKG",26,22,1,"PAH",1,1,51,0)
     --------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,52,0)
  
"PKG",26,22,1,"PAH",1,1,53,0)
     68.02,.001   LOG                                 NUMBER
"PKG",26,22,1,"PAH",1,1,54,0)
  
"PKG",26,22,1,"PAH",1,1,55,0)
          INPUT TRANSFORM: K:+X'=X!(X>999999)!(X<1)!(X?.E1"."1.N) X
"PKG",26,22,1,"PAH",1,1,56,0)
          LAST EDITED:     MAR 14, 2005
"PKG",26,22,1,"PAH",1,1,57,0)
          HELP-PROMPT:     Type a number between 1 and 999999, 0 Decimal
"PKG",26,22,1,"PAH",1,1,58,0)
                           Digits
"PKG",26,22,1,"PAH",1,1,59,0)
          DESCRIPTION:     The numeric part of the accession.
"PKG",26,22,1,"PAH",1,1,60,0)
 
"PKG",26,22,1,"PAH",1,1,61,0)
All of the above changes have been reviewed by the VISTA Blood Bank
"PKG",26,22,1,"PAH",1,1,62,0)
Developer and found to have no impact on the VISTA BLOOD BANK SOFTWARE
"PKG",26,22,1,"PAH",1,1,63,0)
control functions.
"PKG",26,22,1,"PAH",1,1,64,0)
 
"PKG",26,22,1,"PAH",1,1,65,0)
RISK ANALYSIS: Changes made by patch LR*5.2*331 have no effect on Blood
"PKG",26,22,1,"PAH",1,1,66,0)
Bank software functionality, therefore RISK is none.
"PKG",26,22,1,"PAH",1,1,67,0)
 
"PKG",26,22,1,"PAH",1,1,68,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*331 does not
"PKG",26,22,1,"PAH",1,1,69,0)
alter or modify any software design safeguards or safety critical elements
"PKG",26,22,1,"PAH",1,1,70,0)
functions.
"PKG",26,22,1,"PAH",1,1,71,0)
 
"PKG",26,22,1,"PAH",1,1,72,0)
POTENTIAL IMPACT ON SITES: This patch contains changes to 0 routines and 1
"PKG",26,22,1,"PAH",1,1,73,0)
file identified in Veterans Health Administration (VHA) Directive 2004-058,
"PKG",26,22,1,"PAH",1,1,74,0)
group B listing. The changes have no effect on Blood Bank functionality or
"PKG",26,22,1,"PAH",1,1,75,0)
medical device control functions. There is no adverse potential to sites.
"PKG",26,22,1,"PAH",1,1,76,0)
 
"PKG",26,22,1,"PAH",1,1,77,0)
 
"PKG",26,22,1,"PAH",1,1,78,0)
VALIDATION REQUIREMENTS BY OPTION: 
"PKG",26,22,1,"PAH",1,1,79,0)
There are no validation requirements for this patch.
"PKG",26,22,1,"PAH",1,1,80,0)
 
"PKG",26,22,1,"PAH",1,1,81,0)
MINIMAL TEST CASE SCENARIOS BY OPTION, INCLUSIVE OF ALL CONTROL FUNCTIONS:
"PKG",26,22,1,"PAH",1,1,82,0)
There are no test case scenarios for this patch.
"PKG",26,22,1,"PAH",1,1,83,0)
============================================================================
"PKG",26,22,1,"PAH",1,1,84,0)
 
"PKG",26,22,1,"PAH",1,1,85,0)
Patch Description:
"PKG",26,22,1,"PAH",1,1,86,0)
==================
"PKG",26,22,1,"PAH",1,1,87,0)
This patch addresses 3 issues in the Laboratory package pertaining to 
"PKG",26,22,1,"PAH",1,1,88,0)
accessioning.
"PKG",26,22,1,"PAH",1,1,89,0)
 
"PKG",26,22,1,"PAH",1,1,90,0)
 
"PKG",26,22,1,"PAH",1,1,91,0)
ASSOCIATED REMEDY TICKETS:
"PKG",26,22,1,"PAH",1,1,92,0)
==========================
"PKG",26,22,1,"PAH",1,1,93,0)
1.  HD0000000071160 - LOCKED ACCESSION AREA
"PKG",26,22,1,"PAH",1,1,94,0)
 
"PKG",26,22,1,"PAH",1,1,95,0)
2.  HD0000000093193 - <UNDEFINED>WN1A^LRWLST1
"PKG",26,22,1,"PAH",1,1,96,0)
 
"PKG",26,22,1,"PAH",1,1,97,0)
3.  HD0000000102626 - Error -  <SUBSCRIPT>GRID+21^LR7OGMG
"PKG",26,22,1,"PAH",1,1,98,0)
    Duplicates:  HD0000000102632
"PKG",26,22,1,"PAH",1,1,99,0)
                 HD0000000103751
"PKG",26,22,1,"PAH",1,1,100,0)
                 HD0000000112457
"PKG",26,22,1,"PAH",1,1,101,0)
                 HD0000000122951
"PKG",26,22,1,"PAH",1,1,102,0)
                 HD0000000131510
"PKG",26,22,1,"PAH",1,1,103,0)
                 HD0000000138475
"PKG",26,22,1,"PAH",1,1,104,0)
                 HD0000000138900
"PKG",26,22,1,"PAH",1,1,105,0)
                 HD0000000142655
"PKG",26,22,1,"PAH",1,1,106,0)
                 HD0000000154545
"PKG",26,22,1,"PAH",1,1,107,0)
                 HD0000000155087
"PKG",26,22,1,"PAH",1,1,108,0)
                 HD0000000160742
"PKG",26,22,1,"PAH",1,1,109,0)
                 HD0000000170863
"PKG",26,22,1,"PAH",1,1,110,0)
                 HD0000000179768
"PKG",26,22,1,"PAH",1,1,111,0)
                 HD0000000180175
"PKG",26,22,1,"PAH",1,1,112,0)
 
"PKG",26,22,1,"PAH",1,1,113,0)
 
"PKG",26,22,1,"PAH",1,1,114,0)
PARTICIPATING TEST SITES:
"PKG",26,22,1,"PAH",1,1,115,0)
=========================
"PKG",26,22,1,"PAH",1,1,116,0)
ASHEVILLE, NC 
"PKG",26,22,1,"PAH",1,1,117,0)
CENTRAL TEXAS HCS 
"PKG",26,22,1,"PAH",1,1,118,0)
CLEVELAND, OH 
"PKG",26,22,1,"PAH",1,1,119,0)
MARYLAND HCS
"PKG",26,22,1,"PAH",1,1,120,0)
MILWAUKEE, WI 
"PKG",26,22,1,"PAH",1,1,121,0)
NORTH CHICAGO, IL 
"PKG",26,22,1,"PAH",1,1,122,0)
SALISBURY, NC 
"PKG",26,22,1,"PAH",1,1,123,0)
VA GREATER LOS ANGELES HCS
"PKG",26,22,1,"PAH",1,1,124,0)
 
"PKG",26,22,1,"PAH",1,1,125,0)
 
"PKG",26,22,1,"PAH",1,1,126,0)
REMEDY OVERVIEW:
"PKG",26,22,1,"PAH",1,1,127,0)
================
"PKG",26,22,1,"PAH",1,1,128,0)
 
"PKG",26,22,1,"PAH",1,1,129,0)
1.1. HD0000000071160:
"PKG",26,22,1,"PAH",1,1,130,0)
---------------------
"PKG",26,22,1,"PAH",1,1,131,0)
A user reported encountering "FileMan DBS call failed during accessioning
"PKG",26,22,1,"PAH",1,1,132,0)
in routine LRWLST1" MailMan bulletins during accessioning. The generation
"PKG",26,22,1,"PAH",1,1,133,0)
of this bulletin occurs when Laboratory was making a duplicate FileMan DBS
"PKG",26,22,1,"PAH",1,1,134,0)
call during accessioning that involved an accession area being 'in common'
"PKG",26,22,1,"PAH",1,1,135,0)
with another accession area.  This duplicate call would occur when the
"PKG",26,22,1,"PAH",1,1,136,0)
accession area has a lower internal entry number in ACCESSION file (#68)
"PKG",26,22,1,"PAH",1,1,137,0)
than the accession area it is 'in common' with.
"PKG",26,22,1,"PAH",1,1,138,0)
 
"PKG",26,22,1,"PAH",1,1,139,0)
 
"PKG",26,22,1,"PAH",1,1,140,0)
1.2. HD0000000071160:
"PKG",26,22,1,"PAH",1,1,141,0)
----------------------
"PKG",26,22,1,"PAH",1,1,142,0)
During internal software review, the following issues were identified:
"PKG",26,22,1,"PAH",1,1,143,0)
 
"PKG",26,22,1,"PAH",1,1,144,0)
  a. It was determined that the "AD" CROSS-REFERENCE on ACCESSION field
"PKG",26,22,1,"PAH",1,1,145,0)
     (#15) in ACCESSION NUMBER sub-file (#68.02) of ACCESSION file (#68)
"PKG",26,22,1,"PAH",1,1,146,0)
     was not setting the reference to the 'in common' accession correctly
"PKG",26,22,1,"PAH",1,1,147,0)
     on the accession. The patch will remove this cross-reference from
"PKG",26,22,1,"PAH",1,1,148,0)
     the data dictionary. See 2b. for storing 'in common' accession
"PKG",26,22,1,"PAH",1,1,149,0)
     reference.
"PKG",26,22,1,"PAH",1,1,150,0)
 
"PKG",26,22,1,"PAH",1,1,151,0)
  b. Field IN COMMON ACCESSION (#15.1) in ACCESSION NUMBER sub-file
"PKG",26,22,1,"PAH",1,1,152,0)
     (#68.02) of ACCESSION file (#68) is added to the data dictionary
"PKG",26,22,1,"PAH",1,1,153,0)
     to store the reference to the 'in common' accession when this
"PKG",26,22,1,"PAH",1,1,154,0)
     relationship exists.  Routine LRWLST11 will update this field when
"PKG",26,22,1,"PAH",1,1,155,0)
     appropriate.
"PKG",26,22,1,"PAH",1,1,156,0)
 
"PKG",26,22,1,"PAH",1,1,157,0)
   STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"PKG",26,22,1,"PAH",1,1,158,0)
   STORED IN ^LRO(68,D0,1,D1,1,
"PKG",26,22,1,"PAH",1,1,159,0)
 
"PKG",26,22,1,"PAH",1,1,160,0)
   DATA        NAME                  GLOBAL        DATA
"PKG",26,22,1,"PAH",1,1,161,0)
   ELEMENT     TITLE                 LOCATION      TYPE
"PKG",26,22,1,"PAH",1,1,162,0)
   -----------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,163,0)
 
"PKG",26,22,1,"PAH",1,1,164,0)
   68.02,15    ACCESSION              .2;1 FREE TEXT
"PKG",26,22,1,"PAH",1,1,165,0)
 
"PKG",26,22,1,"PAH",1,1,166,0)
              PRINTABLE ACCESSION
"PKG",26,22,1,"PAH",1,1,167,0)
              INPUT TRANSFORM:  K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>15!
"PKG",26,22,1,"PAH",1,1,168,0)
                                ($L(X)<7) X
"PKG",26,22,1,"PAH",1,1,169,0)
              LAST EDITED:      MAR 03, 2005
"PKG",26,22,1,"PAH",1,1,170,0)
              HELP-PROMPT:      ANSWER MUST BE ACCESSION, e.g., CH 0428 125
"PKG",26,22,1,"PAH",1,1,171,0)
              DESCRIPTION:      The printable form of the Accession is
"PKG",26,22,1,"PAH",1,1,172,0)
                                stored here.
"PKG",26,22,1,"PAH",1,1,173,0)
 
"PKG",26,22,1,"PAH",1,1,174,0)
 
"PKG",26,22,1,"PAH",1,1,175,0)
   68.02,15.1  IN COMMON ACCESSION    AD;1 FREE TEXT
"PKG",26,22,1,"PAH",1,1,176,0)
 
"PKG",26,22,1,"PAH",1,1,177,0)
              INPUT TRANSFORM:  K:$L(X)>15!($L(X)<7) X
"PKG",26,22,1,"PAH",1,1,178,0)
              LAST EDITED:      MAR 03, 2005
"PKG",26,22,1,"PAH",1,1,179,0)
              HELP-PROMPT:      Answer must be 7-15 characters in length
"PKG",26,22,1,"PAH",1,1,180,0)
              DESCRIPTION:      When this accession area is 'in common'
"PKG",26,22,1,"PAH",1,1,181,0)
                                with another accession area the printable
"PKG",26,22,1,"PAH",1,1,182,0)
                                form of the 'in common' accession is stored
"PKG",26,22,1,"PAH",1,1,183,0)
                                here.
"PKG",26,22,1,"PAH",1,1,184,0)
 
"PKG",26,22,1,"PAH",1,1,185,0)
   c. Field LOG (#.001) in ACCESSION NUMBER sub-file (#68.02) of ACCESSION
"PKG",26,22,1,"PAH",1,1,186,0)
      file (#68) is modified to increase the upper limit of accession
"PKG",26,22,1,"PAH",1,1,187,0)
      numbers from 9999 to 999999.
"PKG",26,22,1,"PAH",1,1,188,0)
 
"PKG",26,22,1,"PAH",1,1,189,0)
      STANDARD DATA DICTIONARY #68.02 -- ACCESSION NUMBER SUB-FILE
"PKG",26,22,1,"PAH",1,1,190,0)
      STORED IN ^LRO(68,D0,1,D1,1,
"PKG",26,22,1,"PAH",1,1,191,0)
 
"PKG",26,22,1,"PAH",1,1,192,0)
      DATA         NAME                  GLOBAL        DATA
"PKG",26,22,1,"PAH",1,1,193,0)
      ELEMENT      TITLE                 LOCATION      TYPE
"PKG",26,22,1,"PAH",1,1,194,0)
      --------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,195,0)
 
"PKG",26,22,1,"PAH",1,1,196,0)
      68.02,.001   LOG                                 NUMBER
"PKG",26,22,1,"PAH",1,1,197,0)
 
"PKG",26,22,1,"PAH",1,1,198,0)
           INPUT TRANSFORM: K:+X'=X!(X>999999)!(X<1)!(X?.E1"."1.N) X
"PKG",26,22,1,"PAH",1,1,199,0)
           LAST EDITED:     MAR 14, 2005
"PKG",26,22,1,"PAH",1,1,200,0)
           HELP-PROMPT:     Type a number between 1 and 999999, 0 Decimal
"PKG",26,22,1,"PAH",1,1,201,0)
                            Digits
"PKG",26,22,1,"PAH",1,1,202,0)
           DESCRIPTION:     The numeric part of the accession.
"PKG",26,22,1,"PAH",1,1,203,0)
 
"PKG",26,22,1,"PAH",1,1,204,0)
 
"PKG",26,22,1,"PAH",1,1,205,0)
   d. The functionality to allow the user to force an accession to a
"PKG",26,22,1,"PAH",1,1,206,0)
      specific number could cause a 'stack overflow' error due to how the
"PKG",26,22,1,"PAH",1,1,207,0)
      M NEW command was implemented. Coding changes to LRWLST1 will only
"PKG",26,22,1,"PAH",1,1,208,0)
      NEW certain variables once.
"PKG",26,22,1,"PAH",1,1,209,0)
 
"PKG",26,22,1,"PAH",1,1,210,0)
   e. Direct READs in routine LRWLST1 have been replaced with FileMan
"PKG",26,22,1,"PAH",1,1,211,0)
      supported DIR reader API calls.
"PKG",26,22,1,"PAH",1,1,212,0)
 
"PKG",26,22,1,"PAH",1,1,213,0)
 
"PKG",26,22,1,"PAH",1,1,214,0)
2. HD0000000093193:
"PKG",26,22,1,"PAH",1,1,215,0)
-------------------
"PKG",26,22,1,"PAH",1,1,216,0)
A user reported an <UNDEFINED>WN1A^LRWLST1 error when accessioning. This
"PKG",26,22,1,"PAH",1,1,217,0)
would occur when attempting to force an accession number for an accession
"PKG",26,22,1,"PAH",1,1,218,0)
area that did not have any accessions for the current accession day.
"PKG",26,22,1,"PAH",1,1,219,0)
Routine LRWLST1 will now handle displaying a default accession number 1
"PKG",26,22,1,"PAH",1,1,220,0)
when there are no existing accessions for the current accession day.
"PKG",26,22,1,"PAH",1,1,221,0)
 
"PKG",26,22,1,"PAH",1,1,222,0)
 
"PKG",26,22,1,"PAH",1,1,223,0)
3. HD0000000102626:
"PKG",26,22,1,"PAH",1,1,224,0)
-------------------
"PKG",26,22,1,"PAH",1,1,225,0)
A user reported a <SUBSCRIPT>GRID+21^LR7OGMG error when using the CPRS Lab
"PKG",26,22,1,"PAH",1,1,226,0)
Reports tab to display recent laboratory results.  This would occur when
"PKG",26,22,1,"PAH",1,1,227,0)
there are three or more tests on an accession, at least two of the tests
"PKG",26,22,1,"PAH",1,1,228,0)
were performed at different laboratories and a third test had a 'pending'
"PKG",26,22,1,"PAH",1,1,229,0)
result and therefore no performing laboratory designated.  The software
"PKG",26,22,1,"PAH",1,1,230,0)
was attempting to determine the performing laboratory for the pending
"PKG",26,22,1,"PAH",1,1,231,0)
test. Routine LR7OGMG will now ignore tests that do not have a performing
"PKG",26,22,1,"PAH",1,1,232,0)
laboratory when constructing the list of performing laboratories
"PKG",26,22,1,"PAH",1,1,233,0)
associated with an accession's test results.
"PKG",26,22,1,"PAH",1,1,234,0)
     
"PKG",26,22,1,"PAH",1,1,235,0)
  
"PKG",26,22,1,"PAH",1,1,236,0)
INSTALLATION INSTRUCTIONS
"PKG",26,22,1,"PAH",1,1,237,0)
-------------------------
"PKG",26,22,1,"PAH",1,1,238,0)
  The install time for this patch is less than 5 minute. This patch
"PKG",26,22,1,"PAH",1,1,239,0)
  can be installed when Laboratory users are on the system.
"PKG",26,22,1,"PAH",1,1,240,0)
  Suggested time to install: non-peak requirement hours.
"PKG",26,22,1,"PAH",1,1,241,0)
 
"PKG",26,22,1,"PAH",1,1,242,0)
 
"PKG",26,22,1,"PAH",1,1,243,0)
NOTE: Kernel patches must be current on the target system to avoid
"PKG",26,22,1,"PAH",1,1,244,0)
      problems loading and/or installing this patch.
"PKG",26,22,1,"PAH",1,1,245,0)
 
"PKG",26,22,1,"PAH",1,1,246,0)
      Patch installation needs to be coordinated with the Laboratory
"PKG",26,22,1,"PAH",1,1,247,0)
      Information Manager (LIM/ADPAC).
"PKG",26,22,1,"PAH",1,1,248,0)
 
"PKG",26,22,1,"PAH",1,1,249,0)
 
"PKG",26,22,1,"PAH",1,1,250,0)
  1.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",26,22,1,"PAH",1,1,251,0)
        option will load the KIDS package onto your system.
"PKG",26,22,1,"PAH",1,1,252,0)
 
"PKG",26,22,1,"PAH",1,1,253,0)
  2.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"PKG",26,22,1,"PAH",1,1,254,0)
      select the 'Installation' menu.
"PKG",26,22,1,"PAH",1,1,255,0)
 
"PKG",26,22,1,"PAH",1,1,256,0)
  3.  From this menu, you may then elect to use the following options
"PKG",26,22,1,"PAH",1,1,257,0)
      (when prompted for the INSTALL NAME, enter LR*5.2*331):
"PKG",26,22,1,"PAH",1,1,258,0)
        a. Print Transport Global
"PKG",26,22,1,"PAH",1,1,259,0)
        b. Backup a Transport Global
"PKG",26,22,1,"PAH",1,1,260,0)
        c. Compare Transport Global to Current System
"PKG",26,22,1,"PAH",1,1,261,0)
        d. Verify Checksums in Transport Global
"PKG",26,22,1,"PAH",1,1,262,0)
 
"PKG",26,22,1,"PAH",1,1,263,0)
      Use the 'Verify Checksum in Transport Global' option and verify that
"PKG",26,22,1,"PAH",1,1,264,0)
      all routines have the correct checksums.
"PKG",26,22,1,"PAH",1,1,265,0)
 
"PKG",26,22,1,"PAH",1,1,266,0)
  4.  Use the 'Install Package(s)' option under the 'Installation' menu
"PKG",26,22,1,"PAH",1,1,267,0)
      and select the package 'LR*5.2*331'.
"PKG",26,22,1,"PAH",1,1,268,0)
    
"PKG",26,22,1,"PAH",1,1,269,0)
      When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
"PKG",26,22,1,"PAH",1,1,270,0)
      Install? YES//' choose 'NO'. Responding 'Yes' to the prompt for
"PKG",26,22,1,"PAH",1,1,271,0)
      rebuilding menu trees can significantly increase install time.
"PKG",26,22,1,"PAH",1,1,272,0)
 
"PKG",26,22,1,"PAH",1,1,273,0)
      When prompted 'Want KIDS to INHIBIT LOGONs during the install?
"PKG",26,22,1,"PAH",1,1,274,0)
      YES// choose 'NO'. 
"PKG",26,22,1,"PAH",1,1,275,0)
 
"PKG",26,22,1,"PAH",1,1,276,0)
      When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
"PKG",26,22,1,"PAH",1,1,277,0)
      Protocols? YES//', choose 'NO'.
"PKG",26,22,1,"PAH",1,1,278,0)
 
"PKG",26,22,1,"PAH",1,1,279,0)
     The install will automatically disable the following options:
"PKG",26,22,1,"PAH",1,1,280,0)
 
"PKG",26,22,1,"PAH",1,1,281,0)
       Accession order then immediately enter data [LR ACC THEN DATA]
"PKG",26,22,1,"PAH",1,1,282,0)
       Batch data entry (chem, hem, tox, etc.) [LRSTUF]
"PKG",26,22,1,"PAH",1,1,283,0)
       Bypass normal data entry [LRFAST]
"PKG",26,22,1,"PAH",1,1,284,0)
       Fast Bypass Data Entry/Verify [LRFASTS]
"PKG",26,22,1,"PAH",1,1,285,0)
       Special test accessioning [LRNONCOM]
"PKG",26,22,1,"PAH",1,1,286,0)
       Merge Accessions [LRACC MERGE]
"PKG",26,22,1,"PAH",1,1,287,0)
       Add tests to a given accession [LRADD TO ACC]
"PKG",26,22,1,"PAH",1,1,288,0)
       Add tests to an already existing order number. [LRADD TO ORDER]
"PKG",26,22,1,"PAH",1,1,289,0)
       Lab add test(s) to an existing order [LRADDTST]
"PKG",26,22,1,"PAH",1,1,290,0)
       Delete entire order or individual tests [LRCENDEL]
"PKG",26,22,1,"PAH",1,1,291,0)
       Remove an accession [LRDELOG]
"PKG",26,22,1,"PAH",1,1,292,0)
       Referral Patient Multi-purpose Accession [LRLEDI]
"PKG",26,22,1,"PAH",1,1,293,0)
       Accessioning, standard (Microbiology) [LRMICROLOGIN]
"PKG",26,22,1,"PAH",1,1,294,0)
       Accessioning tests ordered by ward order entry [LROE]
"PKG",26,22,1,"PAH",1,1,295,0)
       Lab test order [LROW]
"PKG",26,22,1,"PAH",1,1,296,0)
       Fast lab test order (IMMEDIATE COLLECT) [LROW IMMED COLLECT]
"PKG",26,22,1,"PAH",1,1,297,0)
       Fast lab test order (ROUTINE) [LROW ROUTINE]
"PKG",26,22,1,"PAH",1,1,298,0)
       Fast lab test order (SEND PATIENT) [LROW SEND PAT]
"PKG",26,22,1,"PAH",1,1,299,0)
       Fast lab test order (WARD COLLECT) [LROW WARD COL]
"PKG",26,22,1,"PAH",1,1,300,0)
       Receipt of routine lab collection from wards [LRPHEXCPT]
"PKG",26,22,1,"PAH",1,1,301,0)
       Itemized routine lab collection [LRPHITEM]
"PKG",26,22,1,"PAH",1,1,302,0)
       Manually accession QC, Environmental, etc. [LRQCLOG]
"PKG",26,22,1,"PAH",1,1,303,0)
       Multipurpose accessioning [LRQUICK]
"PKG",26,22,1,"PAH",1,1,304,0)
       Delete test from an accession [LRTSTOUT]
"PKG",26,22,1,"PAH",1,1,305,0)
 
"PKG",26,22,1,"PAH",1,1,306,0)
 
"PKG",26,22,1,"PAH",1,1,307,0)
 Note: Routine LR331 will be deleted after successful patch installation. 
"PKG",26,22,1,"PAH",1,1,308,0)
 
"PKG",26,22,1,"PAH",1,1,309,0)
  
"PKG",26,22,1,"PAH",1,1,310,0)
INSTALLATION EXAMPLE
"PKG",26,22,1,"PAH",1,1,311,0)
====================
"PKG",26,22,1,"PAH",1,1,312,0)
 
"PKG",26,22,1,"PAH",1,1,313,0)
Select Installation Option:
"PKG",26,22,1,"PAH",1,1,314,0)
 
"PKG",26,22,1,"PAH",1,1,315,0)
Select Kernel Installation & Distribution System Option:  Installation
"PKG",26,22,1,"PAH",1,1,316,0)
 
"PKG",26,22,1,"PAH",1,1,317,0)
Select Installation Option: 6  Install Package(s)
"PKG",26,22,1,"PAH",1,1,318,0)
Select INSTALL NAME: LR*5.2*331 Loaded from Distribution  Loaded from
"PKG",26,22,1,"PAH",1,1,319,0)
Distribution  3/10/05@16:26:40
"PKG",26,22,1,"PAH",1,1,320,0)
     => LR*5.2*331 
"PKG",26,22,1,"PAH",1,1,321,0)
 
"PKG",26,22,1,"PAH",1,1,322,0)
This Distribution was loaded on Mar 10, 2005@16:26:40 with header of
"PKG",26,22,1,"PAH",1,1,323,0)
   LR*5.2*331 
"PKG",26,22,1,"PAH",1,1,324,0)
   It consisted of the following Install(s):
"PKG",26,22,1,"PAH",1,1,325,0)
     LR*5.2*331
"PKG",26,22,1,"PAH",1,1,326,0)
Checking Install for Package LR*5.2*331
"PKG",26,22,1,"PAH",1,1,327,0)
Will first run the Environment Check Routine, LR331
"PKG",26,22,1,"PAH",1,1,328,0)
 
"PKG",26,22,1,"PAH",1,1,329,0)
 
"PKG",26,22,1,"PAH",1,1,330,0)
               Sending install started alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,331,0)
 
"PKG",26,22,1,"PAH",1,1,332,0)
                        --- Environment Check is Ok ---
"PKG",26,22,1,"PAH",1,1,333,0)
 
"PKG",26,22,1,"PAH",1,1,334,0)
Install Questions for LR*5.2*331
"PKG",26,22,1,"PAH",1,1,335,0)
 
"PKG",26,22,1,"PAH",1,1,336,0)
Incoming Files:
"PKG",26,22,1,"PAH",1,1,337,0)
 
"PKG",26,22,1,"PAH",1,1,338,0)
 
"PKG",26,22,1,"PAH",1,1,339,0)
   68        ACCESSION  (Partial Definition)
"PKG",26,22,1,"PAH",1,1,340,0)
Note:  You already have the 'ACCESSION' File.
"PKG",26,22,1,"PAH",1,1,341,0)
 
"PKG",26,22,1,"PAH",1,1,342,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// NO
"PKG",26,22,1,"PAH",1,1,343,0)
 
"PKG",26,22,1,"PAH",1,1,344,0)
 
"PKG",26,22,1,"PAH",1,1,345,0)
Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",26,22,1,"PAH",1,1,346,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",26,22,1,"PAH",1,1,347,0)
 
"PKG",26,22,1,"PAH",1,1,348,0)
Enter the Device you want to print the Install messages.
"PKG",26,22,1,"PAH",1,1,349,0)
You can queue the install by enter a 'Q' at the device prompt.
"PKG",26,22,1,"PAH",1,1,350,0)
Enter a '^' to abort the install.
"PKG",26,22,1,"PAH",1,1,351,0)
 
"PKG",26,22,1,"PAH",1,1,352,0)
DEVICE: HOME//  TELNET
"PKG",26,22,1,"PAH",1,1,353,0)
 
"PKG",26,22,1,"PAH",1,1,354,0)
 
"PKG",26,22,1,"PAH",1,1,355,0)
 Install Started for LR*5.2*331 :
"PKG",26,22,1,"PAH",1,1,356,0)
               Mar 10, 2005@16:27:01
"PKG",26,22,1,"PAH",1,1,357,0)
 
"PKG",26,22,1,"PAH",1,1,358,0)
Build Distribution Date: Mar 10, 2005
"PKG",26,22,1,"PAH",1,1,359,0)
 
"PKG",26,22,1,"PAH",1,1,360,0)
 Installing Routines:
"PKG",26,22,1,"PAH",1,1,361,0)
               Mar 10, 2005@16:27:01
"PKG",26,22,1,"PAH",1,1,362,0)
 
"PKG",26,22,1,"PAH",1,1,363,0)
 Running Pre-Install Routine: PRE^LR331
"PKG",26,22,1,"PAH",1,1,364,0)
 
"PKG",26,22,1,"PAH",1,1,365,0)
                          *** Pre install started ***
"PKG",26,22,1,"PAH",1,1,366,0)
 
"PKG",26,22,1,"PAH",1,1,367,0)
                   Deleting Field #15 in file #68, ACCESSION
"PKG",26,22,1,"PAH",1,1,368,0)
 
"PKG",26,22,1,"PAH",1,1,369,0)
              Field will be installed as part of KIDS installation
"PKG",26,22,1,"PAH",1,1,370,0)
 
"PKG",26,22,1,"PAH",1,1,371,0)
                         *** Pre install completed ***
"PKG",26,22,1,"PAH",1,1,372,0)
 
"PKG",26,22,1,"PAH",1,1,373,0)
 Installing Data Dictionaries:
"PKG",26,22,1,"PAH",1,1,374,0)
               Mar 10, 2005@16:27:01
"PKG",26,22,1,"PAH",1,1,375,0)
 
"PKG",26,22,1,"PAH",1,1,376,0)
 Installing PACKAGE COMPONENTS:
"PKG",26,22,1,"PAH",1,1,377,0)
 
"PKG",26,22,1,"PAH",1,1,378,0)
 Installing OPTION
"PKG",26,22,1,"PAH",1,1,379,0)
               Mar 10, 2005@16:27:01
"PKG",26,22,1,"PAH",1,1,380,0)
 
"PKG",26,22,1,"PAH",1,1,381,0)
 Running Post-Install Routine: POST^LR331
"PKG",26,22,1,"PAH",1,1,382,0)
 
"PKG",26,22,1,"PAH",1,1,383,0)
                          *** Post install started ***
"PKG",26,22,1,"PAH",1,1,384,0)
 
"PKG",26,22,1,"PAH",1,1,385,0)
                           *** No action required ***
"PKG",26,22,1,"PAH",1,1,386,0)
 
"PKG",26,22,1,"PAH",1,1,387,0)
                         *** Post install completed ***
"PKG",26,22,1,"PAH",1,1,388,0)
 
"PKG",26,22,1,"PAH",1,1,389,0)
              Sending install completion alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,390,0)
 
"PKG",26,22,1,"PAH",1,1,391,0)
 Updating Routine file...
"PKG",26,22,1,"PAH",1,1,392,0)
 
"PKG",26,22,1,"PAH",1,1,393,0)
 Updating KIDS files...
"PKG",26,22,1,"PAH",1,1,394,0)
 
"PKG",26,22,1,"PAH",1,1,395,0)
 LR*5.2*331 Installed.
"PKG",26,22,1,"PAH",1,1,396,0)
               Mar 10, 2005@16:27:01
"PKG",26,22,1,"PAH",1,1,397,0)
 
"PKG",26,22,1,"PAH",1,1,398,0)
 Install Message sent #xxxx
"PKG",26,22,1,"PAH",1,1,399,0)
 
"PKG",26,22,1,"PAH",1,1,400,0)
Install Completed
"PKG",26,22,1,"PAH",1,1,401,0)
 
"PKG",26,22,1,"PAH",1,1,402,0)
ROUTINE SUMMARY:
"PKG",26,22,1,"PAH",1,1,403,0)
================
"PKG",26,22,1,"PAH",1,1,404,0)
The following routines are included in this patch.  The second line of
"PKG",26,22,1,"PAH",1,1,405,0)
each of these routines now looks like:
"PKG",26,22,1,"PAH",1,1,406,0)
 
"PKG",26,22,1,"PAH",1,1,407,0)
  <tab> ;;5.2;LAB SERVICE;**[patchlist]**;Sep 27, 1994
"PKG",26,22,1,"PAH",1,1,408,0)
 
"PKG",26,22,1,"PAH",1,1,409,0)
                 Checksum       Checksum
"PKG",26,22,1,"PAH",1,1,410,0)
Routine Name     Before Patch   After Patch    Patch List
"PKG",26,22,1,"PAH",1,1,411,0)
------------     ------------   -----------    ------------
"PKG",26,22,1,"PAH",1,1,412,0)
LR331             N/A            5261822       331  (Deleted by KIDS)
"PKG",26,22,1,"PAH",1,1,413,0)
LR7OGMG          5478031        5490638        187,230,286,290,331
"PKG",26,22,1,"PAH",1,1,414,0)
LRWLST1          12664045       11171614       48,65,121,153,261,286,331
"PKG",26,22,1,"PAH",1,1,415,0)
LRWLST11         16883055       15996378       121,128,153,202,286,331
"PKG",26,22,1,"PAH",1,1,416,0)

"PRE")
LR331
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","LR331")
0^^B10648764^n/a
"RTN","LR331",1,0)
LR331 ;DALOI/JMC - LR*5.2*331 PATCH ENVIRONMENT CHECK ROUTINE ; Feb 25, 2005
"RTN","LR331",2,0)
 ;;5.2;LAB SERVICE;**331**;Sep 27, 1994;Build 7
"RTN","LR331",3,0)
EN ; Does not prevent loading of the transport global.
"RTN","LR331",4,0)
 ; Environment check is done only during the install.
"RTN","LR331",5,0)
 ;
"RTN","LR331",6,0)
 N XQA,XQAMSG
"RTN","LR331",7,0)
 ;
"RTN","LR331",8,0)
 I '$G(XPDENV) D  Q
"RTN","LR331",9,0)
 . S XQAMSG="Transport global for patch "_$G(XPDNM,"Unknown patch")_" loaded on "_$$HTE^XLFDT($H)
"RTN","LR331",10,0)
 . S XQA("G.LMI")=""
"RTN","LR331",11,0)
 . D SETUP^XQALERT
"RTN","LR331",12,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Sending transport global loaded alert to mail group G.LMI",80))
"RTN","LR331",13,0)
 ;
"RTN","LR331",14,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" started on "_$$HTE^XLFDT($H)
"RTN","LR331",15,0)
 S XQA("G.LMI")=""
"RTN","LR331",16,0)
 D SETUP^XQALERT
"RTN","LR331",17,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Sending install started alert to mail group G.LMI",80))
"RTN","LR331",18,0)
 ;
"RTN","LR331",19,0)
 D CHECK
"RTN","LR331",20,0)
 D EXIT
"RTN","LR331",21,0)
 Q
"RTN","LR331",22,0)
 ;
"RTN","LR331",23,0)
CHECK ; Perform environment check
"RTN","LR331",24,0)
 I $S('$G(IOM):1,'$G(IOSL):1,$G(U)'="^":1,1:0) D  Q
"RTN","LR331",25,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Terminal Device is not defined",80))
"RTN","LR331",26,0)
 . S XPDQUIT=2
"RTN","LR331",27,0)
 I $S('$G(DUZ):1,$D(DUZ)[0:1,$D(DUZ(0))[0:1,1:0) D  Q
"RTN","LR331",28,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Please log in to set local DUZ... variables",80))
"RTN","LR331",29,0)
 . S XPDQUIT=2
"RTN","LR331",30,0)
 I $P($$ACTIVE^XUSER(DUZ),"^")'=1 D  Q
"RTN","LR331",31,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("You are not a valid user on this system",80))
"RTN","LR331",32,0)
 . S XPDQUIT=2
"RTN","LR331",33,0)
 S XPDIQ("XPZ1","B")="NO"
"RTN","LR331",34,0)
 Q
"RTN","LR331",35,0)
 ;
"RTN","LR331",36,0)
EXIT ;
"RTN","LR331",37,0)
 I $G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Install Environment Check FAILED ---",80))
"RTN","LR331",38,0)
 I '$G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Environment Check is Ok ---",80))
"RTN","LR331",39,0)
 Q
"RTN","LR331",40,0)
 ;
"RTN","LR331",41,0)
PRE ; KIDS Pre install
"RTN","LR331",42,0)
 ;
"RTN","LR331",43,0)
 N DA,DIK
"RTN","LR331",44,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Pre install started ***",80))
"RTN","LR331",45,0)
 ;
"RTN","LR331",46,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Deleting Field #15 in file #68, ACCESSION",80))
"RTN","LR331",47,0)
 S DIK="^DD(68.02,",DA=15,DA(1)=68 D ^DIK
"RTN","LR331",48,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Field will be installed as part of KIDS installation",80))
"RTN","LR331",49,0)
 ;
"RTN","LR331",50,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Pre install completed ***",80))
"RTN","LR331",51,0)
 Q
"RTN","LR331",52,0)
 ;
"RTN","LR331",53,0)
POST ; KIDS Post install
"RTN","LR331",54,0)
 N XQA,XQAMSG
"RTN","LR331",55,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install started ***",80))
"RTN","LR331",56,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** No action required ***",80))
"RTN","LR331",57,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install completed ***",80))
"RTN","LR331",58,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Sending install completion alert to mail group G.LMI",80))
"RTN","LR331",59,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" completed on "_$$HTE^XLFDT($H)
"RTN","LR331",60,0)
 S XQA("G.LMI")=""
"RTN","LR331",61,0)
 D SETUP^XQALERT
"RTN","LR331",62,0)
 S XQAMSG="LIM: Review description for "_$G(XPDNM,"Unknown patch")_" use KIDS:Utilities:Build File Print"
"RTN","LR331",63,0)
 S XQA("G.LMI")=""
"RTN","LR331",64,0)
 D SETUP^XQALERT
"RTN","LR331",65,0)
 Q
"RTN","LR7OGMG")
0^3^B11682184^B11662502
"RTN","LR7OGMG",1,0)
LR7OGMG ;DALOI/STAFF- Interim report rpc memo grid ;July 19, 2006
"RTN","LR7OGMG",2,0)
 ;;5.2;LAB SERVICE;**187,230,286,290,331**;Sep 27, 1994;Build 7
"RTN","LR7OGMG",3,0)
 ;
"RTN","LR7OGMG",4,0)
GRID(OUTCNT) ; from LR7OGMC
"RTN","LR7OGMG",5,0)
 N ACC,AGE,CDT,CMNT,DATA,DOC,FLAG,IDT,INTP,LINE,LRCW,LRX,MPLS,PLS,PORDER,PRNTCODE,RANGE,SEX,SPEC,SUB,TCNT,TESTNAME,TESTNUM
"RTN","LR7OGMG",6,0)
 N UNITS,VALUE,X,ZERO
"RTN","LR7OGMG",7,0)
 ; the variables AGE, SEX, LRCW, and X are used withing the lab's print codes and ref ranges
"RTN","LR7OGMG",8,0)
 K ^TMP("LRMPLS",$J)
"RTN","LR7OGMG",9,0)
 S AGE=$P(^TMP("LR7OG",$J,"G"),U,4),SEX=$P(^("G"),U,5),LRCW=$P(^("G"),U,6)
"RTN","LR7OGMG",10,0)
 S CDT=+$O(^TMP("LR7OG",$J,"TP",0)) Q:'CDT
"RTN","LR7OGMG",11,0)
 S IDT=9999999-CDT
"RTN","LR7OGMG",12,0)
 S ZERO=$S($D(^TMP("LR7OG",$J,"TP",CDT))#2:^(CDT),1:"")
"RTN","LR7OGMG",13,0)
 I '$P(ZERO,U,3) Q
"RTN","LR7OGMG",14,0)
 S SPEC=+$P(ZERO,U,5)
"RTN","LR7OGMG",15,0)
 S DOC=$$NAME^LR7OGMP(+$P(ZERO,U,10))
"RTN","LR7OGMG",16,0)
 S ACC=$P(ZERO,U,6)
"RTN","LR7OGMG",17,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,4,6)=SPEC_U_$P($G(^LAB(61,SPEC,0)),U)_U_ACC_U_DOC
"RTN","LR7OGMG",18,0)
 S (TCNT,MPLS,PORDER,PLS)=0
"RTN","LR7OGMG",19,0)
 S PLS=$O(^TMP("LRPLS",$J,0))
"RTN","LR7OGMG",20,0)
 I $O(^TMP("LRPLS",$J,PLS)) S MPLS=1 ; multiple performing labs
"RTN","LR7OGMG",21,0)
 F  S PORDER=$O(^TMP("LR7OG",$J,"TP",CDT,PORDER)) Q:PORDER'>0  S DATA=^(PORDER) D
"RTN","LR7OGMG",22,0)
 . I $P(DATA,U,7)="" Q
"RTN","LR7OGMG",23,0)
 . S TCNT=TCNT+1
"RTN","LR7OGMG",24,0)
 . S TESTNUM=+DATA,TESTNAME=$P(DATA,U,2),PRNTCODE=$P(DATA,U,5),SUB=$P(DATA,U,6),FLAG=$P(DATA,U,8),X=$P(DATA,U,7),UNITS=$P(DATA,U,9),RANGE=$P(DATA,U,10),PLS=$P(DATA,U,11)
"RTN","LR7OGMG",25,0)
 . I MPLS,PLS S ^TMP("LRMPLS",$J,PLS,TESTNAME)=""
"RTN","LR7OGMG",26,0)
 . I PRNTCODE="" S VALUE=$J(X,8)
"RTN","LR7OGMG",27,0)
 . E  S @("VALUE="_PRNTCODE)
"RTN","LR7OGMG",28,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=TESTNUM_U_TESTNAME_U_VALUE_U_FLAG_U_UNITS_U_RANGE
"RTN","LR7OGMG",29,0)
 . S OUTCNT=OUTCNT+1
"RTN","LR7OGMG",30,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U)=TCNT
"RTN","LR7OGMG",31,0)
 ;
"RTN","LR7OGMG",32,0)
 S PORDER=0
"RTN","LR7OGMG",33,0)
 F  S PORDER=$O(^TMP("LR7OG",$J,"TP",CDT,PORDER)) Q:PORDER'>0  S DATA=^(PORDER) D
"RTN","LR7OGMG",34,0)
 . I $O(^TMP("LR7OG",$J,"TP",CDT,PORDER,0))>0 D
"RTN","LR7OGMG",35,0)
 . . S TESTNAME=$P(DATA,U,3)
"RTN","LR7OGMG",36,0)
 . . S INTP=0
"RTN","LR7OGMG",37,0)
 . . F  S INTP=+$O(^TMP("LR7OG",$J,"TP",CDT,PORDER,INTP)) Q:INTP<1  D
"RTN","LR7OGMG",38,0)
 . . . S LINE=TESTNAME_" Eval: "_^TMP("LR7OG",$J,"TP",CDT,PORDER,INTP)
"RTN","LR7OGMG",39,0)
 . . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGMG",40,0)
 . . . S OUTCNT=OUTCNT+1
"RTN","LR7OGMG",41,0)
 ;
"RTN","LR7OGMG",42,0)
 I $D(^TMP("LR7OG",$J,"TP",CDT,"C")) D
"RTN","LR7OGMG",43,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="Comment: "
"RTN","LR7OGMG",44,0)
 . S OUTCNT=OUTCNT+1,CMNT=0
"RTN","LR7OGMG",45,0)
 . F  S CMNT=+$O(^TMP("LR7OG",$J,"TP",CDT,"C",CMNT)) Q:CMNT<1  S LINE=^(CMNT) D
"RTN","LR7OGMG",46,0)
 . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="   "_LINE
"RTN","LR7OGMG",47,0)
 . . S OUTCNT=OUTCNT+1
"RTN","LR7OGMG",48,0)
 ;
"RTN","LR7OGMG",49,0)
 D PLS
"RTN","LR7OGMG",50,0)
 Q
"RTN","LR7OGMG",51,0)
 ;
"RTN","LR7OGMG",52,0)
 ;
"RTN","LR7OGMG",53,0)
PLS ; List performing laboratories
"RTN","LR7OGMG",54,0)
 ; If multiple performing labs then list tests associated with each lab.
"RTN","LR7OGMG",55,0)
 ;
"RTN","LR7OGMG",56,0)
 N CNT,LINE,LRPLS,X
"RTN","LR7OGMG",57,0)
 S (CNT,LRPLS)=0
"RTN","LR7OGMG",58,0)
 F  S LRPLS=$O(^TMP("LRPLS",$J,LRPLS)) Q:LRPLS<1  D
"RTN","LR7OGMG",59,0)
 . I CNT S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=" ",OUTCNT=OUTCNT+1
"RTN","LR7OGMG",60,0)
 . I $D(^TMP("LRMPLS",$J,LRPLS)) D
"RTN","LR7OGMG",61,0)
 . . S TESTNAME="",LINE="For test(s): "
"RTN","LR7OGMG",62,0)
 . . F  S TESTNAME=$O(^TMP("LRMPLS",$J,LRPLS,TESTNAME)) Q:TESTNAME=""  D
"RTN","LR7OGMG",63,0)
 . . . I ($L(LINE)+$L(TESTNAME))>240 D
"RTN","LR7OGMG",64,0)
 . . . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGMG",65,0)
 . . . . S OUTCNT=OUTCNT+1,LINE=""
"RTN","LR7OGMG",66,0)
 . . . S LINE=LINE_TESTNAME_", "
"RTN","LR7OGMG",67,0)
 . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE,OUTCNT=OUTCNT+1
"RTN","LR7OGMG",68,0)
 . S LINE=$$NAME^XUAF4(LRPLS)
"RTN","LR7OGMG",69,0)
 . S X=$$PADD^XUAF4(LRPLS)
"RTN","LR7OGMG",70,0)
 . S LINE=LINE_"  "_$P(X,U)_"  "_$P(X,U,2)_", "_$P(X,U,3)_" "_$P(X,U,4)
"RTN","LR7OGMG",71,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="Performing Lab: "_LINE
"RTN","LR7OGMG",72,0)
 . S OUTCNT=OUTCNT+1,CNT=CNT+1
"RTN","LR7OGMG",73,0)
 ;
"RTN","LR7OGMG",74,0)
 K ^TMP("LRPLS",$J),^TMP("LRMPLS",$J)
"RTN","LR7OGMG",75,0)
 Q
"RTN","LRWLST1")
0^1^B75742074^B73104899
"RTN","LRWLST1",1,0)
LRWLST1 ;DALOI/CJS/RWF/FHS - ACCESSION SETUP ; July 19, 2006
"RTN","LRWLST1",2,0)
 ;;5.2;LAB SERVICE;**48,65,121,153,261,286,331**;Sep 27, 1994;Build 7
"RTN","LRWLST1",3,0)
 ;
"RTN","LRWLST1",4,0)
 ; Reference to ^DIC(42 supported by IA #10039
"RTN","LRWLST1",5,0)
 ; Reference to ^SC( supported by IA #10040
"RTN","LRWLST1",6,0)
 ;
"RTN","LRWLST1",7,0)
 S LRWLC=0
"RTN","LRWLST1",8,0)
 F  S LRWLC=$O(LRTSTS(LRWLC)) Q:LRWLC<1  S LRAD=DT D SPLIT
"RTN","LRWLST1",9,0)
 ;
"RTN","LRWLST1",10,0)
 ; If LEDI and comments came with order then copy to order in #69
"RTN","LRWLST1",11,0)
 I $G(LRORDRR)="R",$G(LR696),$D(^LRO(69.6,LR696,99)) D
"RTN","LRWLST1",12,0)
 . N LRDIE
"RTN","LRWLST1",13,0)
 . D WP^DIE(69.01,LRSN_","_LRODT_",",16,"A","^LRO(69.6,LR696,99)","LRDIE(16)")
"RTN","LRWLST1",14,0)
 ;
"RTN","LRWLST1",15,0)
 K DIC,DLAYGO,DR,DA,DIE,LRIXX
"RTN","LRWLST1",16,0)
 Q:$G(LRORDR)="P"
"RTN","LRWLST1",17,0)
 K LRNM,LRTSTS
"RTN","LRWLST1",18,0)
 K ^TMP("LR",$J,"TMP")
"RTN","LRWLST1",19,0)
 Q
"RTN","LRWLST1",20,0)
 ;
"RTN","LRWLST1",21,0)
SPLIT ;
"RTN","LRWLST1",22,0)
 N LRAA,LRX
"RTN","LRWLST1",23,0)
 ; Setup regular accessions (LRUNQ=0)
"RTN","LRWLST1",24,0)
 S LRUNQ=0,LREND=0
"RTN","LRWLST1",25,0)
 I $D(LRTSTS(LRWLC,0)) D
"RTN","LRWLST1",26,0)
 . D GTWLN
"RTN","LRWLST1",27,0)
 . I LREND Q
"RTN","LRWLST1",28,0)
 . S LRAA=0
"RTN","LRWLST1",29,0)
 . F  S LRAA=$O(LRTSTS(LRWLC,0,LRAA)) Q:LRAA<1  D
"RTN","LRWLST1",30,0)
 . . S LRSS=LRTSTS(LRWLC,0,LRAA)
"RTN","LRWLST1",31,0)
 . . D STWLN,ST2,^LRWLST11,EN^LA7ADL(LRUID)
"RTN","LRWLST1",32,0)
 . D SICA^LRWLST11
"RTN","LRWLST1",33,0)
 ;
"RTN","LRWLST1",34,0)
 ; Setup accessions requiring 'unique' accession numbers (LRUNQ=1)
"RTN","LRWLST1",35,0)
 S LRUNQ=1,LRAA=0
"RTN","LRWLST1",36,0)
 F  S LRAA=$O(LRTSTS(LRWLC,1,LRAA)) Q:LRAA<1  D
"RTN","LRWLST1",37,0)
 . S LRSS=LRTSTS(LRWLC,1,LRAA)
"RTN","LRWLST1",38,0)
 . F  D GTWLN Q:LREND  D   Q:$O(LRTSTS(LRWLC,1,LRAA,0))<1
"RTN","LRWLST1",39,0)
 . . D STWLN,ST2,^LRWLST11,EN^LA7ADL(LRUID),SICA^LRWLST11
"RTN","LRWLST1",40,0)
 Q
"RTN","LRWLST1",41,0)
 ;
"RTN","LRWLST1",42,0)
 ;
"RTN","LRWLST1",43,0)
STWLN ; Set accession number
"RTN","LRWLST1",44,0)
 ;
"RTN","LRWLST1",45,0)
 D GETLOCK(LRAA,LRAD)
"RTN","LRWLST1",46,0)
 D CHECK68(LRAA,LRAD)
"RTN","LRWLST1",47,0)
 ;
"RTN","LRWLST1",48,0)
 S LRDPF=$P(^LR(LRDFN,0),U,2),DFN=$P(^(0),U,3)
"RTN","LRWLST1",49,0)
 ;
"RTN","LRWLST1",50,0)
 ; Handle 'in common' area that was not setup in GTWLN call.
"RTN","LRWLST1",51,0)
 I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN)) D SETAN(LRAA,LRAD,LRAN)
"RTN","LRWLST1",52,0)
 ;
"RTN","LRWLST1",53,0)
 S LREND=0,LRLBLBP=1-$P(LRSS,U,2),LRSS=$P(LRSS,U)
"RTN","LRWLST1",54,0)
 S LRACC=$P(^LRO(68,LRAA,0),U,11)_" "_$S(LRAD["0000":$E(LRAD,2,3),1:$E(LRAD,4,7))_" "_LRAN
"RTN","LRWLST1",55,0)
 ;
"RTN","LRWLST1",56,0)
 S LRPRAC=""
"RTN","LRWLST1",57,0)
 I $D(^LRO(69,LRODT,1,LRSN,0)) S LRPRAC=$P(^(0),U,6) S:$D(LRNT) ^(3)=LRNT
"RTN","LRWLST1",58,0)
 ;
"RTN","LRWLST1",59,0)
 ; Location type
"RTN","LRWLST1",60,0)
 S LRCAPLOC=$P($G(^SC(+LROLLOC,0)),U,3)
"RTN","LRWLST1",61,0)
 I LRCAPLOC="" S LRCAPLOC="Z"
"RTN","LRWLST1",62,0)
 ;
"RTN","LRWLST1",63,0)
 ; File information in file #68 for this accession
"RTN","LRWLST1",64,0)
 N FDA,LR6802,LRDIE
"RTN","LRWLST1",65,0)
 S LR6802=LRAN_","_LRAD_","_LRAA_","
"RTN","LRWLST1",66,0)
 S FDA(1,68.02,LR6802,.01)=LRDFN
"RTN","LRWLST1",67,0)
 S FDA(1,68.02,LR6802,1)=LRDPF
"RTN","LRWLST1",68,0)
 S FDA(1,68.02,LR6802,2)=LRAD
"RTN","LRWLST1",69,0)
 S FDA(1,68.02,LR6802,3)=LRODT
"RTN","LRWLST1",70,0)
 S FDA(1,68.02,LR6802,4)=LRSN
"RTN","LRWLST1",71,0)
 S FDA(1,68.02,LR6802,6)=LRLLOC
"RTN","LRWLST1",72,0)
 S X=$G(^LRO(69,LRODT,1,LRSN,.1)) I X'="" S FDA(1,68.02,LR6802,14)=X
"RTN","LRWLST1",73,0)
 ;
"RTN","LRWLST1",74,0)
 ; No ordering provider/location on controls
"RTN","LRWLST1",75,0)
 I LRDPF'=62.3 D
"RTN","LRWLST1",76,0)
 . S FDA(1,68.02,LR6802,6.5)=LRPRAC
"RTN","LRWLST1",77,0)
 . S FDA(1,68.02,LR6802,94)=LROLLOC
"RTN","LRWLST1",78,0)
 ;
"RTN","LRWLST1",79,0)
 ; Only store treating specialty on file #2 patients
"RTN","LRWLST1",80,0)
 ; If no treating specialty then use specialty from file #44 location
"RTN","LRWLST1",81,0)
 I LRDPF=2 D
"RTN","LRWLST1",82,0)
 . S LRTREA=$P($G(^DPT(DFN,.103)),U)
"RTN","LRWLST1",83,0)
 . I 'LRTREA S LRTREA=$P($G(^SC(+LROLLOC,0)),U,20)
"RTN","LRWLST1",84,0)
 . I LRTREA S FDA(1,68.02,LR6802,6.6)=LRTREA
"RTN","LRWLST1",85,0)
 ;
"RTN","LRWLST1",86,0)
 S FDA(1,68.02,LR6802,6.7)=DUZ
"RTN","LRWLST1",87,0)
 S FDA(1,68.02,LR6802,15)=LRACC
"RTN","LRWLST1",88,0)
 S FDA(1,68.02,LR6802,26)=DUZ(2)
"RTN","LRWLST1",89,0)
 S FDA(1,68.02,LR6802,92)=LRCAPLOC
"RTN","LRWLST1",90,0)
 ;
"RTN","LRWLST1",91,0)
 D FILE^DIE("","FDA(1)","LRDIE(1)")
"RTN","LRWLST1",92,0)
 I $D(LRDIE(1)) D MAILALRT
"RTN","LRWLST1",93,0)
 ;
"RTN","LRWLST1",94,0)
 ; If specimen defined then set nodes, force to ien=1 since many lab
"RTN","LRWLST1",95,0)
 ; routines expect the specimen to be record number 1.
"RTN","LRWLST1",96,0)
 I $G(LRSPEC) D
"RTN","LRWLST1",97,0)
 . N FDAIEN
"RTN","LRWLST1",98,0)
 . S FDAIEN(1)=1
"RTN","LRWLST1",99,0)
 . S FDA(2,68.05,"+1,"_LR6802,.01)=LRSPEC
"RTN","LRWLST1",100,0)
 . S FDA(2,68.05,"+1,"_LR6802,1)=$P(LRSAMP,";",1)
"RTN","LRWLST1",101,0)
 . D UPDATE^DIE("","FDA(2)","FDAIEN","LRDIE(2)")
"RTN","LRWLST1",102,0)
 . I $D(LRDIE(2)) D MAILALRT
"RTN","LRWLST1",103,0)
 ;
"RTN","LRWLST1",104,0)
 ; If no specimen defined then use specimen values from file #69.
"RTN","LRWLST1",105,0)
 I $G(LRSPEC)="",$D(^LRO(69,LRODT,1,LRSN,4,0)) D
"RTN","LRWLST1",106,0)
 . N FDA,FDAIEN,LRI,LRX
"RTN","LRWLST1",107,0)
 . S LRI=0
"RTN","LRWLST1",108,0)
 . F  S LRI=$O(^LRO(69,LRODT,1,LRSN,4,LRI)) Q:'LRI  D
"RTN","LRWLST1",109,0)
 . . S FDAIEN(1)=LRI,LRX=$G(^LRO(69,LRODT,1,LRSN,4,LRI,0))
"RTN","LRWLST1",110,0)
 . . S FDA(LRI,68.05,"+1,"_LR6802,.01)=$P(LRX,"^")
"RTN","LRWLST1",111,0)
 . . D UPDATE^DIE("","FDA(LRI)","FDAIEN","LRDIE(LRI)")
"RTN","LRWLST1",112,0)
 . . I $D(LRDIE(LRI)) D MAILALRT
"RTN","LRWLST1",113,0)
 ;
"RTN","LRWLST1",114,0)
 ; Create UID.
"RTN","LRWLST1",115,0)
 S LRUID=$$LRUID^LRX(LRAA,LRAD,LRAN)
"RTN","LRWLST1",116,0)
 ;
"RTN","LRWLST1",117,0)
 I '$D(LRPHSET),('$G(LRQUIET)) W !!,"ACCESSION:  ",LRACC,"  <",LRUID,">"
"RTN","LRWLST1",118,0)
 ;
"RTN","LRWLST1",119,0)
 D UPD696
"RTN","LRWLST1",120,0)
 ;
"RTN","LRWLST1",121,0)
 L -^LRO(68,LRAA,1,LRAD,1,0)
"RTN","LRWLST1",122,0)
 Q
"RTN","LRWLST1",123,0)
 ;
"RTN","LRWLST1",124,0)
 ;
"RTN","LRWLST1",125,0)
UPD696 ; Update file #69.6 if LEDI referral patient and no existing entry
"RTN","LRWLST1",126,0)
 K LR696IEN
"RTN","LRWLST1",127,0)
 I $G(LRORDRR)="R" D
"RTN","LRWLST1",128,0)
 . S LR696IEN=0
"RTN","LRWLST1",129,0)
 . I $G(LRRSITE("SMID"))'="",$G(LRSD("RUID"))'="" S LR696IEN=+$O(^LRO(69.6,"AD",LRRSITE("SMID"),LRSD("RUID"),0))
"RTN","LRWLST1",130,0)
 . I LR696IEN Q
"RTN","LRWLST1",131,0)
 . I '$G(LRRSTAT(0)) S LRRSTAT(0)=$$FIND1^DIC(64.061,"","OMX","Specimen in process","","I $P(^LAB(64.061,Y,0),U,7)=""U""")
"RTN","LRWLST1",132,0)
 . D PSET^LRPEND(SSN(2),+LRRSITE("RSITE"),LRSD("RUID"),+LRSD("RPSITE"),LRSPEC,LRSAMP,LRRSTAT(0),LRODT,$P(LRCDT,U),LRRSITE("SDT"),LRNT,.LROT)
"RTN","LRWLST1",133,0)
 Q
"RTN","LRWLST1",134,0)
 ;
"RTN","LRWLST1",135,0)
 ;
"RTN","LRWLST1",136,0)
ST2 ; Find next available node in LR global
"RTN","LRWLST1",137,0)
 ;
"RTN","LRWLST1",138,0)
 N FDA,FDAIEN,LRDIE,LRX,LRXIDT
"RTN","LRWLST1",139,0)
 ;
"RTN","LRWLST1",140,0)
 ; Autopsy ("AU") is not a mulitple - do not attempt to set in ^LR global
"RTN","LRWLST1",141,0)
 I LRSS="AU" S LRIDT=0 Q
"RTN","LRWLST1",142,0)
 ;
"RTN","LRWLST1",143,0)
 S LRIDT=0
"RTN","LRWLST1",144,0)
 F  D  Q:LRIDT
"RTN","LRWLST1",145,0)
 . S LRXIDT=9999999-LRCDT
"RTN","LRWLST1",146,0)
 . L +^LR(LRDFN,LRSS,LRXIDT,0):5
"RTN","LRWLST1",147,0)
 . I '$T S LRCDT=$$FMADD^XLFDT(LRCDT,0,0,0,1) Q
"RTN","LRWLST1",148,0)
 . I '$D(^LR(LRDFN,LRSS,LRXIDT,0)) S LRIDT=LRXIDT Q
"RTN","LRWLST1",149,0)
 . L -^LR(LRDFN,LRSS,LRXIDT,0)
"RTN","LRWLST1",150,0)
 . S LRCDT=$$FMADD^XLFDT(LRCDT,0,0,0,1)
"RTN","LRWLST1",151,0)
 ;
"RTN","LRWLST1",152,0)
 ; Create entry in appropriate subscript in LAB DATA file (#63).
"RTN","LRWLST1",153,0)
 S LRX=$S(LRSS="CH":63.04,LRSS="MI":63.05,LRSS="BB":63.01,LRSS="SP":63.08,LRSS="CY":63.09,LRSS="EM":63.02,1:0)
"RTN","LRWLST1",154,0)
 S FDAIEN(1)=LRIDT
"RTN","LRWLST1",155,0)
 S FDA(63,LRX,"+1,"_LRDFN_",",.01)=LRCDT
"RTN","LRWLST1",156,0)
 S FDA(63,LRX,"+1,"_LRDFN_",",.06)=LRACC
"RTN","LRWLST1",157,0)
 I LRSS'="CH" S FDA(63,LRX,"+1,"_LRDFN_",",.1)=LRNT
"RTN","LRWLST1",158,0)
 I LRSS="CH" S FDA(63,LRX,"+1,"_LRDFN_",",.12)=3
"RTN","LRWLST1",159,0)
 I LRSS="MI" S FDA(63,LRX,"+1,"_LRDFN_",",38)=3
"RTN","LRWLST1",160,0)
 I LRX D UPDATE^DIE("","FDA(63)","FDAIEN","LRDIE(63)")
"RTN","LRWLST1",161,0)
 I $D(LRDIE(63)) D MAILALRT
"RTN","LRWLST1",162,0)
 ;
"RTN","LRWLST1",163,0)
 ; Uncomment following code when new field .9 in"MI" subscript is released
"RTN","LRWLST1",164,0)
 ;I LRSS="MI" D
"RTN","LRWLST1",165,0)
 ;. N LRN,ERR,IENS
"RTN","LRWLST1",166,0)
 ;. S IENS=LRIDT_","_LRDFN_",",LRN=0
"RTN","LRWLST1",167,0)
 ;. F  S LRN=$O(^LRO(69,LRODT,1,LRSN,2,LRN)) Q:LRN<1  D
"RTN","LRWLST1",168,0)
 ;. . I '$D(^LRO(69,LRODT,1,LRSN,2,LRN,1,0)) Q
"RTN","LRWLST1",169,0)
 ;. . D WP^DIE(63.05,IENS,.9,"A","^LRO(69,"_LRODT_",1,"_LRSN_",2,"_LRN_",1)","ERR")
"RTN","LRWLST1",170,0)
 ;
"RTN","LRWLST1",171,0)
 L -^LR(LRDFN,LRSS,LRIDT,0)
"RTN","LRWLST1",172,0)
 ;
"RTN","LRWLST1",173,0)
 Q
"RTN","LRWLST1",174,0)
 ;
"RTN","LRWLST1",175,0)
 ;
"RTN","LRWLST1",176,0)
GTWLN ;
"RTN","LRWLST1",177,0)
 N X
"RTN","LRWLST1",178,0)
 ;
"RTN","LRWLST1",179,0)
 ; Execute accession transform for this area.
"RTN","LRWLST1",180,0)
 S LRAN=0
"RTN","LRWLST1",181,0)
 S X=$G(^LRO(68,LRWLC,.1)) X:X'="" X
"RTN","LRWLST1",182,0)
 ;
"RTN","LRWLST1",183,0)
 D GETLOCK(LRWLC,LRAD)
"RTN","LRWLST1",184,0)
 D CHECK68(LRWLC,LRAD)
"RTN","LRWLST1",185,0)
 ;
"RTN","LRWLST1",186,0)
 S:'LRAN LRAN=1+$P($G(^LRO(68,LRWLC,1,LRAD,1,0)),U,3)
"RTN","LRWLST1",187,0)
 ;
"RTN","LRWLST1",188,0)
 I "CYEMSP"'[LRSS F  Q:'$D(^LRO(68,LRWLC,1,LRAD,1,LRAN))  S LRAN=LRAN+1
"RTN","LRWLST1",189,0)
 ;
"RTN","LRWLST1",190,0)
 ; check for AP Accessions
"RTN","LRWLST1",191,0)
 I "CYEMSP"[LRSS F  Q:'$D(^LRO(68,LRWLC,1,LRAD,1,LRAN))&'$D(^LR("A"_LRSS_"A",$E(LRAD,1,3),LRAN))  S LRAN=LRAN+1
"RTN","LRWLST1",192,0)
 ;
"RTN","LRWLST1",193,0)
 I '$D(LRPHSET),$D(LRNCWL)!$P(^LAB(69.9,1,0),U,8) D ASK Q:LREND
"RTN","LRWLST1",194,0)
 ;
"RTN","LRWLST1",195,0)
 D SETAN(LRWLC,LRAD,LRAN)
"RTN","LRWLST1",196,0)
 ;
"RTN","LRWLST1",197,0)
 L -^LRO(68,LRWLC,1,LRAD,1,0)
"RTN","LRWLST1",198,0)
 Q
"RTN","LRWLST1",199,0)
 ;
"RTN","LRWLST1",200,0)
 ;
"RTN","LRWLST1",201,0)
ASK ;
"RTN","LRWLST1",202,0)
 ; Don't ask if tasked or a "silent" call
"RTN","LRWLST1",203,0)
 I $D(ZTQUEUED)!($G(LRQUIET)) Q
"RTN","LRWLST1",204,0)
 ;
"RTN","LRWLST1",205,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,LROK,LRANX,X,Y
"RTN","LRWLST1",206,0)
 S LROK=0
"RTN","LRWLST1",207,0)
 F  D  Q:LREND!(LROK)
"RTN","LRWLST1",208,0)
 . K DIR
"RTN","LRWLST1",209,0)
 . S DIR(0)="NO^1:"_$S($P(LRLABKY,U,2):999999,1:LRAN)_":0"
"RTN","LRWLST1",210,0)
 . S DIR("A")="Force to",DIR("B")=LRAN
"RTN","LRWLST1",211,0)
 . D ^DIR
"RTN","LRWLST1",212,0)
 . I $D(DIRUT) S LREND=1 Q
"RTN","LRWLST1",213,0)
 . S LRANX=Y
"RTN","LRWLST1",214,0)
 . I LRANX<+$P($G(^LRO(68,LRWLC,1,LRAD,1,0)),U,3) D
"RTN","LRWLST1",215,0)
 . . W !,"This accession number may be already assigned either in this "
"RTN","LRWLST1",216,0)
 . . W !,"area or a common accession area."
"RTN","LRWLST1",217,0)
 . I $D(^LRO(68,LRWLC,1,LRAD,1,LRANX,0)) D  Q:'LROK
"RTN","LRWLST1",218,0)
 . . N LRDFNX S LRDFNX=LRDFN
"RTN","LRWLST1",219,0)
 . . N DFN,LRDFN,LRDPF,PNM,SSN
"RTN","LRWLST1",220,0)
 . . S LRDFN=+^LRO(68,LRWLC,1,LRAD,1,LRANX,0),LRDPF=$P(^LR(LRDFN,0),U,2),DFN=$P(^LR(LRDFN,0),U,3)
"RTN","LRWLST1",221,0)
 . . D PT^LRX
"RTN","LRWLST1",222,0)
 . . W !,"THIS NUMBER BELONGS TO ",!,PNM,"     SSN: ",SSN
"RTN","LRWLST1",223,0)
 . . D INF^LRX
"RTN","LRWLST1",224,0)
 . . I LRDFN=LRDFNX S LROK=1
"RTN","LRWLST1",225,0)
 . K DIR
"RTN","LRWLST1",226,0)
 . S DIR(0)="YO",DIR("A")="Are you sure",DIR("B")="NO"
"RTN","LRWLST1",227,0)
 . D ^DIR
"RTN","LRWLST1",228,0)
 . I $D(DIRUT) S LREND=1 Q
"RTN","LRWLST1",229,0)
 . I Y=1 S LRAN=LRANX,LROK=1
"RTN","LRWLST1",230,0)
 ;
"RTN","LRWLST1",231,0)
 ; Unlock if aborting.
"RTN","LRWLST1",232,0)
 I LREND L -^LRO(68,LRWLC,1,LRAD,1,0)
"RTN","LRWLST1",233,0)
 ;
"RTN","LRWLST1",234,0)
 Q
"RTN","LRWLST1",235,0)
 ;
"RTN","LRWLST1",236,0)
 ;
"RTN","LRWLST1",237,0)
CHECK68(LRAA,LRAD) ; Check for/set header node of ^LRO(68) 68.01 subfile.
"RTN","LRWLST1",238,0)
 ;
"RTN","LRWLST1",239,0)
 ; Call with LRAA = ien of entry in file #68
"RTN","LRWLST1",240,0)
 ;           LRAD = accession date in fileman format
"RTN","LRWLST1",241,0)
 ;
"RTN","LRWLST1",242,0)
 ; Set accession date in file #68 for this acession.
"RTN","LRWLST1",243,0)
 ; Check for existence of accession number multiple but not accession date multiple,
"RTN","LRWLST1",244,0)
 ; FileMan DBS call fails when accession number multiple exists but accession date multiple does not.
"RTN","LRWLST1",245,0)
 ; If this condition found then set missing node directly and quit.
"RTN","LRWLST1",246,0)
 ;
"RTN","LRWLST1",247,0)
 I '$D(^LRO(68,LRAA,1,LRAD,0)) D
"RTN","LRWLST1",248,0)
 . N FDA,FDAIEN,LRDIE,X
"RTN","LRWLST1",249,0)
 . S X=$Q(^LRO(68,LRAA,1,LRAD,0))
"RTN","LRWLST1",250,0)
 . I X'="",$QS(X,4)=LRAD S $P(^LRO(68,LRAA,1,LRAD,0),"^")=LRAD Q
"RTN","LRWLST1",251,0)
 . S (FDAIEN(1),FDA(1,68.01,"+1,"_LRAA_",",.01))=LRAD
"RTN","LRWLST1",252,0)
 . D UPDATE^DIE("","FDA(1)","FDAIEN","LRDIE(1)")
"RTN","LRWLST1",253,0)
 . I $D(LRDIE(1)) D MAILALRT
"RTN","LRWLST1",254,0)
 ;
"RTN","LRWLST1",255,0)
 Q
"RTN","LRWLST1",256,0)
 ;
"RTN","LRWLST1",257,0)
 ;
"RTN","LRWLST1",258,0)
GETLOCK(LRAA,LRAD) ; Obtain lock on zeroth node of this accession date
"RTN","LRWLST1",259,0)
 ; Call with LRAA = ien of entry in file #68
"RTN","LRWLST1",260,0)
 ;           LRAD = accession date in fileman format
"RTN","LRWLST1",261,0)
 ;
"RTN","LRWLST1",262,0)
 F  L +^LRO(68,LRAA,1,LRAD,1,0):10 Q:$T  D
"RTN","LRWLST1",263,0)
 . I $D(ZTQUEUED)!($G(LRQUIET)) Q
"RTN","LRWLST1",264,0)
 . W !!?5,"Accession area ",$P(^LRO(68,LRAA,0),"^")," is locked by another user.",!,$C(7)
"RTN","LRWLST1",265,0)
 Q
"RTN","LRWLST1",266,0)
 ;
"RTN","LRWLST1",267,0)
 ;
"RTN","LRWLST1",268,0)
SETAN(LRAA,LRAD,LRAN) ; Create stub entry in file #68 for this acession.
"RTN","LRWLST1",269,0)
 ;
"RTN","LRWLST1",270,0)
 ; Call with LRAA = ien of entry in file #68
"RTN","LRWLST1",271,0)
 ;           LRAD = accession date in fileman format
"RTN","LRWLST1",272,0)
 ;           LRAN = accession number
"RTN","LRWLST1",273,0)
 ;
"RTN","LRWLST1",274,0)
 N FDA,FDAIEN,LR6802,LRDIE
"RTN","LRWLST1",275,0)
 ;
"RTN","LRWLST1",276,0)
 S LR6802=LRAD_","_LRAA_","
"RTN","LRWLST1",277,0)
 S FDAIEN(1)=LRAN
"RTN","LRWLST1",278,0)
 S FDA(2,68.02,"+1,"_LR6802,.01)=LRDFN
"RTN","LRWLST1",279,0)
 D UPDATE^DIE("","FDA(2)","FDAIEN","LRDIE(2)")
"RTN","LRWLST1",280,0)
 I $D(LRDIE(2)) D MAILALRT
"RTN","LRWLST1",281,0)
 Q
"RTN","LRWLST1",282,0)
 ;
"RTN","LRWLST1",283,0)
 ;
"RTN","LRWLST1",284,0)
MAILALRT ; Send mail message alert when FileMan DBS errors returned
"RTN","LRWLST1",285,0)
 ;
"RTN","LRWLST1",286,0)
 N J,LR68,LRCNT,LRMTXT,X,XMINSTR,XMSUB,XMTO
"RTN","LRWLST1",287,0)
 ;
"RTN","LRWLST1",288,0)
 I $D(^LRO(68,LRAA,1,LRAD,1,LRAN)) M LR68=^LRO(68,LRAA,1,LRAD,1,LRAN)
"RTN","LRWLST1",289,0)
 ;
"RTN","LRWLST1",290,0)
 S LRMTXT(1)="The following debugging information is provided to assist"
"RTN","LRWLST1",291,0)
 S LRMTXT(2)="support staff in resolving error during accessioning."
"RTN","LRWLST1",292,0)
 S LRMTXT(3)=" "
"RTN","LRWLST1",293,0)
 S LRCNT=3
"RTN","LRWLST1",294,0)
 ;
"RTN","LRWLST1",295,0)
 F J="FDA","FDAIEN","LR68","LRAA","LRAD","LRAN","LRDFN","LRDIE","LRSS","LRTSTS","LRUNQ","LRWLC","XQY","XQY0" D
"RTN","LRWLST1",296,0)
 . S X=$G(@J)
"RTN","LRWLST1",297,0)
 . I X'="" S LRCNT=LRCNT+1,LRMTXT(LRCNT)=J_"="_X
"RTN","LRWLST1",298,0)
 . F  S J=$Q(@J) Q:J=""  S LRCNT=LRCNT+1,LRMTXT(LRCNT)=J_"="_@J
"RTN","LRWLST1",299,0)
 ;
"RTN","LRWLST1",300,0)
 S XMSUB="FileMan DBS call failed during accessioning in routine LRWLST1"
"RTN","LRWLST1",301,0)
 S XMTO("G.LMI")=""
"RTN","LRWLST1",302,0)
 S XMINSTR("FROM")=.5
"RTN","LRWLST1",303,0)
 S XMINSTR("ADDR FLAGS")="R"
"RTN","LRWLST1",304,0)
 D SENDMSG^XMXAPI(DUZ,XMSUB,"LRMTXT",.XMTO,.XMINSTR)
"RTN","LRWLST1",305,0)
 Q
"RTN","LRWLST11")
0^2^B57122966^B52415321
"RTN","LRWLST11",1,0)
LRWLST11 ;DALOI/CJS,RWF/FHS - ACCESSION SETUP ;July 19, 2006
"RTN","LRWLST11",2,0)
 ;;5.2;LAB SERVICE;**121,128,153,202,286,331**;Sep 27, 1994;Build 7
"RTN","LRWLST11",3,0)
 ;
"RTN","LRWLST11",4,0)
ST21 ;
"RTN","LRWLST11",5,0)
 S LRTS="",LRIX=0
"RTN","LRWLST11",6,0)
 F  S LRIX=$O(LRTSTS(LRWLC,LRUNQ,LRAA,LRIX)) Q:LRIX<1  D SET Q:LRUNQ
"RTN","LRWLST11",7,0)
 ;
"RTN","LRWLST11",8,0)
 S LRNT=$$NOW^XLFDT
"RTN","LRWLST11",9,0)
 D SCDT,SLRSS
"RTN","LRWLST11",10,0)
 ;
"RTN","LRWLST11",11,0)
COMMON ; Setup 'in common' accession if not already setup unless it will be 
"RTN","LRWLST11",12,0)
 ; when tests are acessioned to the 'in common' area.
"RTN","LRWLST11",13,0)
 I +LRWLC,+LRWLC'=+LRAA,$G(^LRO(68,LRWLC,1,LRAD,1,LRAN,0))=$G(LRDFN) D
"RTN","LRWLST11",14,0)
 . I $D(LRTSTS(LRWLC,LRUNQ,LRWLC)) Q
"RTN","LRWLST11",15,0)
 . Q:$G(^LRO(68,LRWLC,1,LRAD,1,LRAN,.1))
"RTN","LRWLST11",16,0)
 . N LRAA,LRACC,LRCDTX,LRCOMMON,LREND,LRIDT,LRNODE3,LRORDRR,LRORU3,LRQUIET,LRTJ,LRUID,X,Y
"RTN","LRWLST11",17,0)
 . S (LRQUIET,LRCOMMON)=1,LRAA=+LRWLC,LRORDRR=""
"RTN","LRWLST11",18,0)
 . S X=LRSS,LRCDTX=LRCDT
"RTN","LRWLST11",19,0)
 . N LRCDT,LRSS
"RTN","LRWLST11",20,0)
 . S LRCDT=LRCDTX,LRSS=X_U_(1+$G(LRLBLBP))
"RTN","LRWLST11",21,0)
 . D STWLN^LRWLST1 Q:$G(LREND)
"RTN","LRWLST11",22,0)
 . D ST2^LRWLST1 Q:$G(LREND)
"RTN","LRWLST11",23,0)
 . D SCDT,SLRSS
"RTN","LRWLST11",24,0)
 ;
"RTN","LRWLST11",25,0)
 Q
"RTN","LRWLST11",26,0)
 ;
"RTN","LRWLST11",27,0)
 ;
"RTN","LRWLST11",28,0)
SCDT ; Set collection, inverse and lab arrival date/times on accession
"RTN","LRWLST11",29,0)
 N FDA,LR6802,LRDIE
"RTN","LRWLST11",30,0)
 S LR6802=LRAN_","_LRAD_","_LRAA_","
"RTN","LRWLST11",31,0)
 S FDA(4,68.02,LR6802,9)=LRCDT
"RTN","LRWLST11",32,0)
 S FDA(4,68.02,LR6802,10)=LREAL
"RTN","LRWLST11",33,0)
 I '$D(LRPHSET) S FDA(4,68.02,LR6802,12)=LRNT
"RTN","LRWLST11",34,0)
 S FDA(4,68.02,LR6802,13.5)=LRIDT
"RTN","LRWLST11",35,0)
 D FILE^DIE("","FDA(4)","LRDIE(4)")
"RTN","LRWLST11",36,0)
 I $D(LRDIE(4)) D MAILALRT^LRWLST1
"RTN","LRWLST11",37,0)
 Q
"RTN","LRWLST11",38,0)
 ;
"RTN","LRWLST11",39,0)
 ;
"RTN","LRWLST11",40,0)
SLRSS ;
"RTN","LRWLST11",41,0)
 ;
"RTN","LRWLST11",42,0)
 S X=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,5,1,0)) ; change for AP
"RTN","LRWLST11",43,0)
 S H8=$S($D(LRSPEC):LRSPEC,1:X)_U_$S("CYEMSPAU"[LRSS:LRACC,1:LRACC)_U_$S(LRSS="MI":LRPRAC,1:"")_U_$S(LRSS="MI":LRLLOC,1:"")_"^^"_$S(LRSS="CH":LRPRAC,1:"")_"^"_$S(LRSS="MI":$P(LRSAMP,";",1),LRSS="CH":LRLLOC,1:"")
"RTN","LRWLST11",44,0)
 ;
"RTN","LRWLST11",45,0)
 I $S(LRSS="CH":1,LRSS="MI":1,1:0) D
"RTN","LRWLST11",46,0)
 . I $G(LRORDRR)="R",+$G(LRRSITE("RSITE")) S $P(H8,U,9)=+LRRSITE("RSITE")_";DIC(4,"
"RTN","LRWLST11",47,0)
 . I $G(LROLLOC),$G(LRORDRR)'="R" S $P(H8,U,9)=LROLLOC_";SC("
"RTN","LRWLST11",48,0)
 . S $P(H8,U,10)=$S($G(LRDUZ(2)):LRDUZ(2),1:$G(DUZ(2)))
"RTN","LRWLST11",49,0)
 ;
"RTN","LRWLST11",50,0)
 S ^LR(LRDFN,LRSS,LRIDT,0)=LRCDT_U_LREAL_"^^^"_H8
"RTN","LRWLST11",51,0)
 I $G(LRORU3)'="" S ^LR(LRDFN,LRSS,LRIDT,"ORU")=LRORU3
"RTN","LRWLST11",52,0)
 ;
"RTN","LRWLST11",53,0)
ST3 D ST4:(LRSS="MI"),LRCCOM
"RTN","LRWLST11",54,0)
 ;
"RTN","LRWLST11",55,0)
 S LRDPF=$P(^LR(LRDFN,0),U,2),DFN=$P(^(0),U,3),LRPR=1
"RTN","LRWLST11",56,0)
 S LRRB=0
"RTN","LRWLST11",57,0)
 I LRDPF=2 S LRRB=$$GET1^DIQ(2,DFN_",",.101),LRRB=$S(LRRB'="":LRRB,1:0)
"RTN","LRWLST11",58,0)
 ;
"RTN","LRWLST11",59,0)
 Q:$G(LRORDR)="P"
"RTN","LRWLST11",60,0)
 ;
"RTN","LRWLST11",61,0)
 I '$D(LRTJ) D  Q
"RTN","LRWLST11",62,0)
 . I $G(LRORDRR)="R",LRSS="CH",$G(LRORU3)'="",$P(LRORU3,"^")'=$P(LRORU3,"^",4) Q  ; Don't print, use label from sending facility.
"RTN","LRWLST11",63,0)
 . I LRLBLBP,'$G(LRCOMMON) S LRLBL(LRAA,LRAN)=LRSN_U_LRAD_U_LRODT_U_LRRB_U_LRLLOC_U_LRACC_U_$S($D(LRORD):LRORD,1:"")
"RTN","LRWLST11",64,0)
 S I=0
"RTN","LRWLST11",65,0)
 F  S I=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,I)) Q:I<.5  S LRTS=^(I,0) D Z
"RTN","LRWLST11",66,0)
 Q
"RTN","LRWLST11",67,0)
 ;
"RTN","LRWLST11",68,0)
 ;
"RTN","LRWLST11",69,0)
ST4 ;
"RTN","LRWLST11",70,0)
 S $P(^LR(LRDFN,LRSS,LRIDT,0),U,10)=$S($D(LRNT):LRNT,1:""),$P(^(0),U,8)=LRLLOC
"RTN","LRWLST11",71,0)
 ; Used to be LRSPCDSC,63.05,.9 (Word Processing field) replaces 63.05,.99
"RTN","LRWLST11",72,0)
 S:$D(LRCCOM) ^LR(LRDFN,LRSS,LRIDT,99)=LRCCOM
"RTN","LRWLST11",73,0)
 I '$D(LRPHSET) D
"RTN","LRWLST11",74,0)
 . N DA,DIE,DR
"RTN","LRWLST11",75,0)
 . S DIE="^LR("_LRDFN_",""MI"",",DA=LRIDT,DA(1)=LRDFN
"RTN","LRWLST11",76,0)
 . ;S DR=.9
"RTN","LRWLST11",77,0)
 . ;I '$G(LRQUIET) W:DR'=.9 !!,"Order comment:"
"RTN","LRWLST11",78,0)
 . S DR=.99_$S($L($G(LRGCOM)):"///"_LRGCOM,$L($G(LRCCOM)):"//"_LRCCOM,1:"")
"RTN","LRWLST11",79,0)
 . I '$G(LRQUIET) W:DR'=.99 !!,"Order comment:"
"RTN","LRWLST11",80,0)
 . D ^DIE
"RTN","LRWLST11",81,0)
 I '$G(LRQUIET),'$D(LRPHSET),'$D(LRGCOM) W !,"Description OK? Y//" D % G ST4:%["N"
"RTN","LRWLST11",82,0)
 K DR,DIC,DIE
"RTN","LRWLST11",83,0)
 Q
"RTN","LRWLST11",84,0)
 ;
"RTN","LRWLST11",85,0)
 ;
"RTN","LRWLST11",86,0)
ST5 S I("SUBSC")=$S(I("EDIT")[11.5:26,I("EDIT")[15:27,I("EDIT")[19:28,I("EDIT")[23:29,I("EDIT")[34:30,1:-1) Q:I("SUBSC")=-1
"RTN","LRWLST11",87,0)
 S I("PNTR")=$S(I("EDIT")[11.5:"^63.061A^",I("EDIT")[15:"^63.361A^",I("EDIT")[19:"^63.111A^",I("EDIT")[23:"^63.181A^",1:"^63.432A^")
"RTN","LRWLST11",88,0)
 S I("N")=1+$S($D(^LR(LRDFN,"MI",LRIDT,I("SUBSC"),0)):$P(^(0),U,4),1:0),^(0)=I("PNTR")_I("N")_U_I("N"),^(I("N"),0)=I("TEST")
"RTN","LRWLST11",89,0)
 Q
"RTN","LRWLST11",90,0)
 ;
"RTN","LRWLST11",91,0)
 ;
"RTN","LRWLST11",92,0)
SET S LRTS=LRTSTS(LRWLC,LRUNQ,LRAA,LRIX),LRIN=$P(LRTS,U,3),LRORIFN=$P(LRTS,U,4),LRTSORU=+$P(LRTS,U,6),LRTS=$P(LRTS,U,1,2),LRBACK=$P(LRTS,U,5)
"RTN","LRWLST11",93,0)
 ;
"RTN","LRWLST11",94,0)
 I '$G(LRQUIET),'$D(LRPHSET) D
"RTN","LRWLST11",95,0)
 . W !,$P(^LAB(60,+LRTS,0),U)
"RTN","LRWLST11",96,0)
 . I $D(LRSPEC),LRSPEC D
"RTN","LRWLST11",97,0)
 . . S I=$S($D(^LAB(61,+LRSPEC,0)):$P(^(0),U),1:""),J=$S($D(^LAB(62,+LRSAMP,0)):$P(^(0),U),1:"")
"RTN","LRWLST11",98,0)
 . . W ?30,J W:I'=J "  ",I
"RTN","LRWLST11",99,0)
 ;
"RTN","LRWLST11",100,0)
 I '$G(LRQUIET),'$D(LRPHSET),+LRTS,$O(^LAB(60,+LRTS,7,0))>0 D
"RTN","LRWLST11",101,0)
 . N S
"RTN","LRWLST11",102,0)
 . S DIC="^LAB(60,",DA=+LRTS,DR=7
"RTN","LRWLST11",103,0)
 . D EN^DIQ H 3
"RTN","LRWLST11",104,0)
 I '$G(LRQUIET),'$D(LRPHSET),+LRTS D
"RTN","LRWLST11",105,0)
 . N S
"RTN","LRWLST11",106,0)
 . S DIC="^LAB(60,"_(+LRTS)_",3,"
"RTN","LRWLST11",107,0)
 . S DA=+$O(^LAB(60,+LRTS,3,"B",+LRSAMP,0)),DR=2
"RTN","LRWLST11",108,0)
 . I DA>0,$O(^LAB(60,+LRTS,3,DA,2,0))>0 D EN^DIQ H 3
"RTN","LRWLST11",109,0)
 ;
"RTN","LRWLST11",110,0)
 D ORUT
"RTN","LRWLST11",111,0)
 D CAP^LRWLST12
"RTN","LRWLST11",112,0)
 K LRTSTS(LRWLC,LRUNQ,LRAA,LRIX)
"RTN","LRWLST11",113,0)
 ;
"RTN","LRWLST11",114,0)
 S ^LRO(69,LRODT,1,LRSN,2,LRIN,0)=LRTS_U_LRAD_U_LRAA_U_LRAN_"^^"_LRORIFN_"^^IP^L^^^^"_LRBACK
"RTN","LRWLST11",115,0)
 S ^LRO(69,LRODT,1,LRSN,2,"B",+LRTS,LRIN)=""
"RTN","LRWLST11",116,0)
 ;
"RTN","LRWLST11",117,0)
 ; When file 63 is enhanced to accept comments per test comments should
"RTN","LRWLST11",118,0)
 ; be put there instead of field 99.
"RTN","LRWLST11",119,0)
 I $O(^LRO(69,LRODT,1,LRSN,2,LRIN,1,0)) D
"RTN","LRWLST11",120,0)
 . I LRSS'="CH"!($D(^LR(LRDFN,LRSS,LRIDT,0))[0) Q
"RTN","LRWLST11",121,0)
 . S X=$S($D(^LR(LRDFN,LRSS,LRIDT,1,0)):$P(^(0),"^",3),1:0),I=0
"RTN","LRWLST11",122,0)
 . F  S I=$O(^LRO(69,LRODT,1,LRSN,2,LRIN,1,I)) Q:I<1  S II=^(I,0) S X=X+1,^LR(LRDFN,LRSS,LRIDT,1,X,0)=II
"RTN","LRWLST11",123,0)
 . S:X ^LR(LRDFN,LRSS,LRIDT,1,0)="^63.041^"_X_U_X
"RTN","LRWLST11",124,0)
 ;
"RTN","LRWLST11",125,0)
RUID I $G(LRORU3)'="" D
"RTN","LRWLST11",126,0)
 . N DA,DIE,DIC,DLAYGO,DR,X,Y
"RTN","LRWLST11",127,0)
 . S DLAYGO=69
"RTN","LRWLST11",128,0)
 . S DA=LRIN,DA(1)=LRSN,DA(2)=LRODT,DIC="^LRO(69,"_DA(2)_",1,"_DA(1)_",2,"
"RTN","LRWLST11",129,0)
 . S DIE=DIC,DR="13////"_$P(LRORU3,U)_";14////"_$P(LRORU3,U,2)_";15////"_$P(LRORU3,U,3)_";16////"_$P(LRORU3,U,4)_";17////"_$P(LRORU3,U,5)
"RTN","LRWLST11",130,0)
 . D ^DIE
"RTN","LRWLST11",131,0)
 Q
"RTN","LRWLST11",132,0)
 ;
"RTN","LRWLST11",133,0)
 ;
"RTN","LRWLST11",134,0)
% R %:DTIME Q:%=""!(%["N")!(%["Y")  W !,"Answer 'Y' or 'N': " G %
"RTN","LRWLST11",135,0)
 ;
"RTN","LRWLST11",136,0)
 ;
"RTN","LRWLST11",137,0)
LRCCOM ;
"RTN","LRWLST11",138,0)
 N I,LRCCOM,LRTN,X
"RTN","LRWLST11",139,0)
 S (I,LRTN,LRCCOM)=0 Q:LRSS'="CH"!($D(^LR(LRDFN,LRSS,LRIDT,0))[0)
"RTN","LRWLST11",140,0)
 F  S I=$O(^LRO(69,LRODT,1,LRSN,6,I)) Q:I<1  I $D(^(I,0)) S X=^(0),LRCCOM=LRCCOM+1,^LR(LRDFN,LRSS,LRIDT,1,LRCCOM,0)=X
"RTN","LRWLST11",141,0)
 F  S LRTN=$O(^LRO(69,LRODT,1,LRSN,2,LRTN)) Q:'LRTN  I $D(^(LRTN,0)) S X=^(0) I $P(X,"^",8),'$P(X,"^",3),$O(^(1,0)) D  ;Get comments for expanded panels
"RTN","LRWLST11",142,0)
 . S I=0 F  S I=$O(^LRO(69,LRODT,1,LRSN,2,LRTN,1,I)) Q:'I  I $D(^(I,0)) S X=^(0),LRCCOM=LRCCOM+1,^LR(LRDFN,LRSS,LRIDT,1,LRCCOM,0)=X
"RTN","LRWLST11",143,0)
 S:LRCCOM ^LR(LRDFN,LRSS,LRIDT,1,0)="^63.041^"_LRCCOM_U_LRCCOM
"RTN","LRWLST11",144,0)
 Q
"RTN","LRWLST11",145,0)
 ;
"RTN","LRWLST11",146,0)
 ;
"RTN","LRWLST11",147,0)
Z L +^LRO(69.1,LRTE)
"RTN","LRWLST11",148,0)
 S LRZ3=$S($D(^LRO(69.1,LRTE,1,0)):$P(^(0),U,3),1:0)
"RTN","LRWLST11",149,0)
Z1 S LRZ3=LRZ3+1 G:$D(^LRO(69.1,LRTE,1,LRZ3)) Z1
"RTN","LRWLST11",150,0)
 S LRZO="^LRO(69.1,"_LRTE_",1,",LRZ1="69.11P",LRZB=+LRTS,LRIFN=LRZ3
"RTN","LRWLST11",151,0)
 D Z^LRWU
"RTN","LRWLST11",152,0)
 S ^LRO(69.1,LRTE,1,LRIFN,0)=+LRTS_"^"_LRLLOC_"^"_LRRB_"^"_LRDFN_"^"_LRSN_"^"_LRTJ_"^"_LRAD_"^"_LRAA_"^"_LRAN_"^"_+LROLLOC
"RTN","LRWLST11",153,0)
 S ^LRO(69.1,"LRPH",LRTE,LRLLOC,LRRB,LRDFN,LRSN)=LRTJ_"^"_LRAD_"^"_LRIFN,^(LRSN,LRAA,LRAN,+LRTS)=+LRTS
"RTN","LRWLST11",154,0)
 L -^LRO(69.1,LRTE)
"RTN","LRWLST11",155,0)
 Q
"RTN","LRWLST11",156,0)
 ;
"RTN","LRWLST11",157,0)
 ;
"RTN","LRWLST11",158,0)
ORUT Q:'$G(LRTSORU)!($G(LRSS)'="CH")
"RTN","LRWLST11",159,0)
 N LRTT,DLAYGO,DIC,DIE,DR,LRTST,DA,LRURG
"RTN","LRWLST11",160,0)
 S DA=LRIDT,DA(1)=LRDFN
"RTN","LRWLST11",161,0)
 S LRNLT=$$NLT^LRVER1(+LRTSORU) Q:+LRNLT<1  Q:$D(^LR(DA(1),LRSS,DA,"ORUT","B",LRNLT))
"RTN","LRWLST11",162,0)
 S DR=".35///^S X=LRNLT",DR(1)=".35"
"RTN","LRWLST11",163,0)
 S DR(1,63.04)=".35///^S X=LRNLT"
"RTN","LRWLST11",164,0)
 S DR(1,63.07)=".01///^S X=LRNLT"
"RTN","LRWLST11",165,0)
 S DIC="^LR("_DA(1)_","""_LRSS_""","
"RTN","LRWLST11",166,0)
 S DIC(0)="MNL",DIE=DIC W:$G(LRDBUG) !,LRNLT
"RTN","LRWLST11",167,0)
 D ^DIE
"RTN","LRWLST11",168,0)
 ;
"RTN","LRWLST11",169,0)
ORUT2 S LRTST=$P($G(^LAM($O(^LAM("E",LRNLT,0)),0)),U) Q:LRTST=""!('$G(LR696IEN))
"RTN","LRWLST11",170,0)
 Q:'($D(^LRO(69.6,LR696IEN,0))#2)!($D(^LRO(69.6,LR696IEN,2,"C",LRNLT)))
"RTN","LRWLST11",171,0)
 S:'$D(^LRO(69.6,LR696IEN,2,0)) ^(0)="^69.64A^"
"RTN","LRWLST11",172,0)
 S DLAYGO=69.6
"RTN","LRWLST11",173,0)
 K DIC,DIE,DA,DR,DA
"RTN","LRWLST11",174,0)
 S DA=LR696IEN
"RTN","LRWLST11",175,0)
 S LRURG="R",LRURG=$S($L($P($G(^LAB(62.05,+$P(LRTS,U,2),0)),U,4)):$P(^(0),U,4),1:LRURG)
"RTN","LRWLST11",176,0)
 S (DIE,DIC)="^LRO(69.6,",DIC(0)="LM"
"RTN","LRWLST11",177,0)
 S DR=20_"///"_LRTST_";",DR(1,69.6)="20///"_LRTST_";"
"RTN","LRWLST11",178,0)
 S DR(2,69.64)=".01///"_LRTST_";1///"_LRNLT_";4///"_LRURG_";5////160;8///"_LRNT_";9///"_LRUID
"RTN","LRWLST11",179,0)
 D ^DIE
"RTN","LRWLST11",180,0)
 Q
"RTN","LRWLST11",181,0)
 ;
"RTN","LRWLST11",182,0)
 ;
"RTN","LRWLST11",183,0)
SICA ; Check accessions 'in common' and setup reference to this accession
"RTN","LRWLST11",184,0)
 N FDA,LR6802,LRDIE,LRAA
"RTN","LRWLST11",185,0)
 S LRX=$P($G(^LRO(68,LRWLC,1,LRAD,1,LRAN,.2)),"^"),LRAA=0
"RTN","LRWLST11",186,0)
 F  S LRAA=$O(LRTSTS(LRWLC,LRUNQ,LRAA)) Q:LRAA<1  I LRWLC'=LRAA D
"RTN","LRWLST11",187,0)
 . S LR6802=LRAN_","_LRAD_","_LRAA_","
"RTN","LRWLST11",188,0)
 . S FDA(5,68.02,LR6802,15.1)=LRX
"RTN","LRWLST11",189,0)
 . D FILE^DIE("","FDA(5)","LRDIE(5)")
"RTN","LRWLST11",190,0)
 . I $D(LRDIE(5)) D MAILALRT^LRWLST1
"RTN","LRWLST11",191,0)
 Q
"UP",68,68.02,-2)
68^1
"UP",68,68.02,-1)
68.01^1
"UP",68,68.02,0)
68.02
"VER")
8.0^22.0
"^DD",68,68.02,.001,0)
LOG^NJ6,0^^ ^K:+X'=X!(X>999999)!(X<1)!(X?.E1"."1.N) X
"^DD",68,68.02,.001,3)
Type a number between 1 and 999999, 0 Decimal Digits
"^DD",68,68.02,.001,21,0)
^^1^1^3050314^^^^
"^DD",68,68.02,.001,21,1,0)
The numeric part of the accession.
"^DD",68,68.02,.001,"DT")
3050314
"^DD",68,68.02,15,0)
ACCESSION^F^^.2;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>15!($L(X)<7) X
"^DD",68,68.02,15,.1)
PRINTABLE ACCESSION
"^DD",68,68.02,15,1,0)
^.1^^0
"^DD",68,68.02,15,3)
ANSWER MUST BE ACCESSION, e.g., CH 0428 125
"^DD",68,68.02,15,21,0)
^^1^1^2841126^
"^DD",68,68.02,15,21,1,0)
The printable form of the Accession is stored here.
"^DD",68,68.02,15,"DT")
3050303
"^DD",68,68.02,15.1,0)
IN COMMON ACCESSION^F^^AD;1^K:$L(X)>15!($L(X)<7) X
"^DD",68,68.02,15.1,3)
Answer must be 7-15 characters in length
"^DD",68,68.02,15.1,21,0)
^^3^3^3050303^
"^DD",68,68.02,15.1,21,1,0)
When this accession area is 'in common' with another accession
"^DD",68,68.02,15.1,21,2,0)
area the printable form of the 'in common' accession is stored
"^DD",68,68.02,15.1,21,3,0)
here.
"^DD",68,68.02,15.1,"DT")
3050303
"BLD",6307,6)
^287
**END**
**END**
