KIDS Distribution saved on Jun 09, 2004@15:34:25
LR*5.2*281 EPI
**KIDS**:LR*5.2*281^

**INSTALL NAME**
LR*5.2*281
"BLD",3974,0)
LR*5.2*281^LAB SERVICE^0^3040609^y
"BLD",3974,1,0)
^^353^353^3040609^^^^
"BLD",3974,1,1,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*281 does not 
"BLD",3974,1,2,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA  
"BLD",3974,1,3,0)
DIRECTIVE 99-053 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"BLD",3974,1,4,0)
 
"BLD",3974,1,5,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*281 does not 
"BLD",3974,1,6,0)
alter or modify any software design safeguards or safety critical
"BLD",3974,1,7,0)
elements functions.
"BLD",3974,1,8,0)
 
"BLD",3974,1,9,0)
RISK ANALYSIS: Changes made by patch LR*5.2*281 have no effect on Blood 
"BLD",3974,1,10,0)
Bank software functionality, therefore RISK is none. 
"BLD",3974,1,11,0)
 
"BLD",3974,1,12,0)
VALIDATION REQUIREMENTS BY OPTION:  Because of the nature of the changes made,
"BLD",3974,1,13,0)
no specific validation requirements exist as a result of installation of this
"BLD",3974,1,14,0)
patch.
"BLD",3974,1,15,0)
***********************************************************************
"BLD",3974,1,16,0)
Due to extensive historical data transmission requirements and mandated setups
"BLD",3974,1,17,0)
required for such, a phased installation and implementation of this patch will
"BLD",3974,1,18,0)
be utilized for release of this patch.  The software download information will
"BLD",3974,1,19,0)
be made available to sites attending one of the following national
"BLD",3974,1,20,0)
audioconference calls:
"BLD",3974,1,21,0)
 
"BLD",3974,1,22,0)
Tuesday, June 8 at 1:00 - 3:00 PM EST for VISNs 1-2-3-4-5-6 
"BLD",3974,1,23,0)
Thursday, June 10 at 3:00 - 5:00 PM EST for VISNs 7-8-9-10-11 
"BLD",3974,1,24,0)
Tuesday, June 15 at 4:00 - 6:00 PM EST for VISNs 12-15-16-17-23 
"BLD",3974,1,25,0)
Wednesday, June 16 at 2:00 - 4:00 PM EST for VISNs 18-19-20-21-22 
"BLD",3974,1,26,0)
Thursday, June 17 at 2:00 - 4:00 PM EST for those unable to attend the other
"BLD",3974,1,27,0)
calls. 
"BLD",3974,1,28,0)

"BLD",3974,1,29,0)
The VANTS telephone number is 1 800 767-1750 and the access code for all calls
"BLD",3974,1,30,0)
is 13143.
"BLD",3974,1,31,0)

"BLD",3974,1,32,0)
This patch will involve reseeding of the EPI databases for each site to allow
"BLD",3974,1,33,0)
the new data created by this patch to be captured.  It is imperative each site 
"BLD",3974,1,34,0)
attend an audioconference prior to installation and implementation of
"BLD",3974,1,35,0)
LR*5.2*281.
"BLD",3974,1,36,0)

"BLD",3974,1,37,0)
INSTRUCTIONS FOR SEEDING THE HISTORICAL DATA:
"BLD",3974,1,38,0)
 
"BLD",3974,1,39,0)
Historical data must be gathered from October 1, 2000 through June 14, 2004. 
"BLD",3974,1,40,0)
Use the Lab EPI Manual Run (Enhanced) [LREPI ENHANCE MANUAL RUN] option to run/
"BLD",3974,1,41,0)
gather and transmit 6 manual runs (consecutive runs) at a time.
"BLD",3974,1,42,0)
 
"BLD",3974,1,43,0)
** Sites DO NOT transmit on June 16 or July 4 to avoid Austin Automation Center
"BLD",3974,1,44,0)
 (AAC) capacity limitations. **
"BLD",3974,1,45,0)
 
"BLD",3974,1,46,0)
Batch #1: October 1, 2000 -March 31, 2001
"BLD",3974,1,47,0)
Batch #2: April 1, 2001 - September 30, 2001
"BLD",3974,1,48,0)
Batch #3: October 1, 2001 - March 31, 2002
"BLD",3974,1,49,0)
Batch #4: April 1, 2002 - September 30, 2002
"BLD",3974,1,50,0)
Batch #5: October 1, 2002 - March 31, 2003
"BLD",3974,1,51,0)
Batch #6: April 1, 2003 - September 30, 2003
"BLD",3974,1,52,0)
Batch #7: October 1, 2003 - March 31, 2004
"BLD",3974,1,53,0)
Batch #8: April 1, 2004 - June 14, 2004 
"BLD",3974,1,54,0)
 
"BLD",3974,1,55,0)
Sites will run 8 batches of reports. Each batch should contain 6 separate
"BLD",3974,1,56,0)
monthly extracts which are tasked separately by month, i.e., OCT 2000, NOV
"BLD",3974,1,57,0)
2000, DEC 2000, JAN 2001, FEB 2001, MAR 2001 = 1 batch and will generate six
"BLD",3974,1,58,0)
separate processing reports back to the station and transmit them over a five
"BLD",3974,1,59,0)
week period June 10, 2004 - July 12, 2004.
"BLD",3974,1,60,0)
You do not have to wait for one monthly extract to run before starting the next
"BLD",3974,1,61,0)
in a batch.
"BLD",3974,1,62,0)
You do not have to wait for one batch to complete running before queuing the
"BLD",3974,1,63,0)
next batch.
"BLD",3974,1,64,0)
If you receive any fatal errors and the monthly extract is rejected, you will
"BLD",3974,1,65,0)
need to fix the error and retransmit that month. 
"BLD",3974,1,66,0)
 
"BLD",3974,1,67,0)
Sites may transmit reports to AAC on evenings and weekends following this
"BLD",3974,1,68,0)
schedule:
"BLD",3974,1,69,0)
1. VISNs with odd numbers are asked to transmit batches on Tuesday & Thursday
"BLD",3974,1,70,0)
 during the PM hours and Saturdays.
"BLD",3974,1,71,0)
2. VISNs with even numbers are asked to transmit on Monday & Friday during the
"BLD",3974,1,72,0)
 PM hours and Sundays.
"BLD",3974,1,73,0)
 
"BLD",3974,1,74,0)
**  NO Sites may transmit on June 16 or July 4 due to AAC limitations. **
"BLD",3974,1,75,0)

"BLD",3974,1,76,0)

"BLD",3974,1,77,0)
The EPI Enhancement patch, LR*5.2*281, contains enhancements and 
"BLD",3974,1,78,0)
modifications to the Emerging Pathogens Initiative (EPI) software.
"BLD",3974,1,79,0)
The enhancements and modifications included in this patch are:
"BLD",3974,1,80,0)

"BLD",3974,1,81,0)
1) New EPI Summary Verification Report of EPI Extracted Data from Site:
"BLD",3974,1,82,0)
   The new Verification Summary Report of EPI Extracted Data from Site   
"BLD",3974,1,83,0)
   replaces the existing Emerging Pathogens Verification Report.  This 
"BLD",3974,1,84,0)
   new summary report consists of the following functionality:
"BLD",3974,1,85,0)
        1) Summary report automatically generated at the sites and sent    
"BLD",3974,1,86,0)
           to the EPI-REPORT mail group on the 15th day of each month
"BLD",3974,1,87,0)
        2) Summary pages are displayed in a human readable format used 
"BLD",3974,1,88,0)
           for quick viewing
"BLD",3974,1,89,0)
        3) Displays reporting site name and station number
"BLD",3974,1,90,0)
        4) Summary report is only 1-2 pages long
"BLD",3974,1,91,0)
        5) Summary report displays emerging pathogens total number of
"BLD",3974,1,92,0)
           occurrences during the monthly processing cycle
"BLD",3974,1,93,0)
        6) Summary report displays emerging pathogens total number of
"BLD",3974,1,94,0)
           persons with occurrences during the monthly processing cycle
"BLD",3974,1,95,0)
        7) Displays Resolution of Risk Assessment number of persons 
"BLD",3974,1,96,0)
           with the nationally rolled-up resolution Hepatitis C that 
"BLD",3974,1,97,0)
           occurred during monthly processing cycle
"BLD",3974,1,98,0)

"BLD",3974,1,99,0)
2) New Detailed Verification Report is a detailed pathogen-specific report for validation purposes.  The Print Detailed Verification Report [LREPI VERIFICATION REPORT] option prints t
"BLD",3974,1,100,0)
automatically generated when your site does an automated or manual run and data is sent to Austin Automation Center.  Six months of previous reports are kept as well as the current mo
"BLD",3974,1,101,0)

"BLD",3974,1,102,0)
3) Sites now have the ability to capture and manipulate EPI data into a 
"BLD",3974,1,103,0)
report or spreadsheet-delimited format.  A site can also add pathogens for local use and generate reports or capture data in a spreadsheet format for local use.
"BLD",3974,1,104,0)

"BLD",3974,1,105,0)
4) Additional data will be sent to Austin.  Including:
"BLD",3974,1,106,0)
        LOINC codes
"BLD",3974,1,107,0)
        Master Patient Index
"BLD",3974,1,108,0)
        County and State for patient demographics
"BLD",3974,1,109,0)
        MIC values
"BLD",3974,1,110,0)
        The new Race and Ethnicity fields
"BLD",3974,1,111,0)

"BLD",3974,1,112,0)
5) Provide the ability to capture 6 new pathogens:
"BLD",3974,1,113,0)
        All Staphylococcus aureus (Reference #18)
"BLD",3974,1,114,0)
        Methicillin-Resistant Staphylococcus aureus (MRSA)
"BLD",3974,1,115,0)
        (Reference #19)
"BLD",3974,1,116,0)
        Vancomycin-Resistant Staphylococcus aureus (VRSA)
"BLD",3974,1,117,0)
         (Reference #20)
"BLD",3974,1,118,0)
        Vancomycin-Resistant Coagulase Negative Staphylococci/Staph epi   
"BLD",3974,1,119,0)
        (VRSE)(Reference #21)
"BLD",3974,1,120,0)
        All Streptococcus pneumoniae (Reference #22)
"BLD",3974,1,121,0)
        All Enterococci (Reference #23)
"BLD",3974,1,122,0)

"BLD",3974,1,123,0)
6) EPI is also enhanced to capture the approved newer Legionella Urinary Antigen test.
"BLD",3974,1,124,0)

"BLD",3974,1,125,0)
7) A bug is fixed with the date handling for start and stop date.
"BLD",3974,1,126,0)

"BLD",3974,1,127,0)
8) The new field PREVIOUS CYCLE (#19) in the Lab Search/Extract file(#69.5) contains a numeric entry which defines the number of previous cycles to search.  These findings will be rep
"BLD",3974,1,128,0)
 
"BLD",3974,1,129,0)
NEW OPTIONS:
"BLD",3974,1,130,0)
NAME: LREPI DELETE LOCAL PATHOGEN       MENU TEXT: Delete Local Pathogen
"BLD",3974,1,131,0)
  TYPE: run routine
"BLD",3974,1,132,0)
DESCRIPTION:   This option allows deletion of local pathogens ONLY. 
"BLD",3974,1,133,0)
National pathogens CAN NOT be deleted.
"BLD",3974,1,134,0)
  ROUTINE: DELETE^LREPIPI
"BLD",3974,1,135,0)
 
"BLD",3974,1,136,0)
NAME: LREPI DELETE LOCAL REPORT
"BLD",3974,1,137,0)
  MENU TEXT: Delete Local Report or Spreadsheet
"BLD",3974,1,138,0)
  TYPE: run routine
"BLD",3974,1,139,0)
 DESCRIPTION:   This option allows you to delete local reports or local
"BLD",3974,1,140,0)
 spreadsheets.  
"BLD",3974,1,141,0)
  ROUTINE: DELETE^LREPIRS2
"BLD",3974,1,142,0)
 
"BLD",3974,1,143,0)
NAME: LREPI ENTER/EDIT LOCAL PATH       MENU TEXT: Enter/Edit Local 
"BLD",3974,1,144,0)
Pathogens
"BLD",3974,1,145,0)
  TYPE: run routine
"BLD",3974,1,146,0)
 DESCRIPTION:   This option allows you to enter or edit local pathogens 
"BLD",3974,1,147,0)
into the LAB SEARCH/EXTRACT FILE (#69.5)  These pathogens can be selected for the report/spreadsheet option.  Local pathogens WILL NOT be transmitted to Austin.
"BLD",3974,1,148,0)
  ROUTINE: LREPIPI
"BLD",3974,1,149,0)
 
"BLD",3974,1,150,0)
NAME: LREPI GENERATE REPORT/SP
"BLD",3974,1,151,0)
  MENU TEXT: Lab EPI Generate Local Report/Spreadsheet
"BLD",3974,1,152,0)
  TYPE: run routine
"BLD",3974,1,153,0)
 DESCRIPTION:   This new option is used to generate reports or spreadsheets for national EPI and local pathogen data.  The job is automatically tasked after selecting the national EPI
"BLD",3974,1,154,0)
or spreadsheet.  The report or spreadsheet can then be viewed on the screen or printed using the new LAB EPI Print Local Report/Spreadsheet option.  Note: NO data is transmitted to Au
"BLD",3974,1,155,0)
  ROUTINE: LREPIRS
"BLD",3974,1,156,0)
 
"BLD",3974,1,157,0)
NAME: LREPI LOCAL PATHOGEN MENU         MENU TEXT: Local Pathogen Menu
"BLD",3974,1,158,0)
  TYPE: menu
"BLD",3974,1,159,0)
 DESCRIPTION:   This menu contains options to enter/edit and delete local pathogens.  Also, it contains options to generate and print the local report/spreadsheet.  
"BLD",3974,1,160,0)
ITEM: LREPI ENTER/EDIT LOCAL PATH
"BLD",3974,1,161,0)
ITEM: LREPI DELETE LOCAL PATHOGEN
"BLD",3974,1,162,0)
ITEM: LREPI GENERATE REPORT/SP          SYNONYM: GEN
"BLD",3974,1,163,0)
ITEM: LREPI PRINT REPORT/SPSHT          SYNONYM: PRT
"BLD",3974,1,164,0)
 
"BLD",3974,1,165,0)
 
"BLD",3974,1,166,0)
NAME: LREPI PATHOGEN INQUIRY            MENU TEXT: Pathogen Inquiry
"BLD",3974,1,167,0)
  TYPE: run routine
"BLD",3974,1,168,0)
 DESCRIPTION:   This new option is used to inquire into the LAB
"BLD",3974,1,169,0)
SEARCH/EXTRACT file (#69.5) parameter description fields (i.e. INACTIVE:NO, LAG DAYS: 15, RUN DATE:ICT 07,2003, CYCLE:MONTHLY, PROTOCOL:LREPI, FOLLOW PTF:YES, REFERENCE NUMBER:23, and
"BLD",3974,1,170,0)
  ROUTINE: INQUIRY^LREPIPI
"BLD",3974,1,171,0)
 
"BLD",3974,1,172,0)
NAME: LREPI PRINT REPORT/SPSHT
"BLD",3974,1,173,0)
  MENU TEXT: Lab EPI Print Local Report/Spreadsheet
"BLD",3974,1,174,0)
  TYPE: run routine
"BLD",3974,1,175,0)
 DESCRIPTION:   This option allows you to print a report or spreadsheet 
"BLD",3974,1,176,0)
that was generated with the Lab EPI Generate Local Report/Spreadsheet.  
"BLD",3974,1,177,0)
  ROUTINE: LREPIRS2
"BLD",3974,1,178,0)
 
"BLD",3974,1,179,0)
NAME: LREPI VERIFICATION REPORT
"BLD",3974,1,180,0)
  MENU TEXT: Print Detailed Verification Report
"BLD",3974,1,181,0)
  TYPE: run routine
"BLD",3974,1,182,0)
 DESCRIPTION:   This option prints the Detailed Verification Report.  This 
"BLD",3974,1,183,0)
report is automatically generated when your site does an automated or 
"BLD",3974,1,184,0)
manual run and data is sent to Austin Automation Center.  Six months of 
"BLD",3974,1,185,0)
previous reports are kept as well as the current month for printing.  
"BLD",3974,1,186,0)
  ROUTINE: LREPIRP7
"BLD",3974,1,187,0)

"BLD",3974,1,188,0)
MODIFIED OPTIONS:
"BLD",3974,1,189,0)
NAME: LREPI ENHANCE MANUAL RUN          MENU TEXT: Lab EPI Manual Run (Enhanced)
"BLD",3974,1,190,0)
  TYPE: run routine
"BLD",3974,1,191,0)
DESCRIPTION:   This option is used ONLY to manually extract national EPI data
"BLD",3974,1,192,0)
 and transmit to the Austin Automation Center (AAC). When this option is run,
"BLD",3974,1,193,0)
 an EPI Summary Verification Report is generated and automatically sent to the
"BLD",3974,1,194,0)
 EPI-Report mail group. Also, a Detailed Verification Report is generated and
"BLD",3974,1,195,0)
 can be printed using the new Print Detailed Verification Report [LREPI
"BLD",3974,1,196,0)
 VERIFICATION REPORT] option. This option has been RENAMED from Lab
"BLD",3974,1,197,0)
 Search/Extract Manual Run (Enhanced) [LREPI SEARCH/EXTRACT ENHANCED MANUAL
"BLD",3974,1,198,0)
 RUN] to EPI Manual Run (Enhanced) [LREPI ENHANCE MANUAL RUN] option.  
"BLD",3974,1,199,0)
  ROUTINE: LREPIRM
"BLD",3974,1,200,0)

"BLD",3974,1,201,0)
NAME: LREPI NIGHTLY TASK                MENU TEXT: Lab EPI Nightly Task
"BLD",3974,1,202,0)
  TYPE: run routine
"BLD",3974,1,203,0)
 DESCRIPTION:   The Lab Search/Extract Nightly Task option must be scheduled to
"BLD",3974,1,204,0)
 run each night by TaskMan. This option will build a HL7 Message and send it
"BLD",3974,1,205,0)
 the defined location specified in the EPI Protocols.  
"BLD",3974,1,206,0)
  ROUTINE: AUTO^LREPIRM                 SCHEDULING RECOMMENDED: YES
"BLD",3974,1,207,0)

"BLD",3974,1,208,0)
NAME: LREPI PARAMETER SETUP             MENU TEXT: Lab EPI Parameter Setup
"BLD",3974,1,209,0)
  TYPE: ScreenMan
"BLD",3974,1,210,0)
DESCRIPTION:   This option is used to define the search criteria along with
"BLD",3974,1,211,0)
 additional information associated with the EPI extracts.  This option only
"BLD",3974,1,212,0)
 allows editing.  You are not allowed to add local pathogens with this option.  
"BLD",3974,1,213,0)
  DIC {DIC}: LAB(69.5,                  DIC(0): AEMQ
"BLD",3974,1,214,0)
  DR{DDS}: [LREPI9]                     DDSFILE: 69.5
"BLD",3974,1,215,0)

"BLD",3974,1,216,0)
MODIFIED FILE:
"BLD",3974,1,217,0)
                                          UP    SEND  DATA                USER
"BLD",3974,1,218,0)
                                          DATE  SEC.  COMES  SITE   RSLV  OVER
"BLD",3974,1,219,0)
 FILE #      NAME                         DD    CODE  W/FILE DATA   PTS   RIDE
"BLD",3974,1,220,0)
 -------------------------------------------------------------------------------
"BLD",3974,1,221,0)
 
"BLD",3974,1,222,0)
 69.5        LAB SEARCH/EXTRACT           YES   NO    YES    MERG   YES   NO
"BLD",3974,1,223,0)
 
"BLD",3974,1,224,0)
The VistA Laboratory EPI Rollup Modifications Technical and User Manual 
"BLD",3974,1,225,0)
(i.e., LR_52_281_EPI_TUM.PDF) is available on the following Office of 
"BLD",3974,1,226,0)
Information Field Offices (OIFOs) ANONYMOUS SOFTWARE directories: 
"BLD",3974,1,227,0)
 
"BLD",3974,1,228,0)
OIFOs              FTP ADDRESS                   DIRECTORY
"BLD",3974,1,229,0)
Albany             ftp.fo-albany.med.va.gov      [ANONYMOUS.SOFTWARE]
"BLD",3974,1,230,0)
Hines              ftp.fo-hines.med.va.gov       [ANONYMOUS.SOFTWARE]
"BLD",3974,1,231,0)
Salt Lake City     ftp.fo-slc.med.va.gov         [ANONYMOUS.SOFTWARE]
"BLD",3974,1,232,0)
 
"BLD",3974,1,233,0)
VistA Laboratory EPI Rollup Modifications Technical and User Manual is 
"BLD",3974,1,234,0)
exported as part of Patch LR*5.2*281 in the following formats:
"BLD",3974,1,235,0)
 
"BLD",3974,1,236,0)
FILE NAME                      CONTENTS                             FORMAT RETRIEVAL
"BLD",3974,1,237,0)

"BLD",3974,1,238,0)
LR_52_281_EPI_TUM.PDF          LR EPI Technical and User Manual     BINARY
"BLD",3974,1,239,0)
 
"BLD",3974,1,240,0)
Testing Sites:
"BLD",3974,1,241,0)
==============
"BLD",3974,1,242,0)
 Boston HCS
"BLD",3974,1,243,0)
 Cincinnati VAMC
"BLD",3974,1,244,0)
 Detroit VAMC
"BLD",3974,1,245,0)
 Durham VAMC
"BLD",3974,1,246,0)
 Manchester VAMC
"BLD",3974,1,247,0)
 Togus VAMC
"BLD",3974,1,248,0)
 
"BLD",3974,1,249,0)
 ROUTINE SUMMARY
"BLD",3974,1,250,0)
 ===============
"BLD",3974,1,251,0)
 
"BLD",3974,1,252,0)
   The following routines are included in this patch.  The second line
"BLD",3974,1,253,0)
   of each of these routines now looks like:
"BLD",3974,1,254,0)
   <tab> ;;5.2;LAB SERVICE;<patchlist>;Sep 27, 1994
"BLD",3974,1,255,0)
  
"BLD",3974,1,256,0)
                     Checksum       Checksum
"BLD",3974,1,257,0)
 
"BLD",3974,1,258,0)
 
"BLD",3974,1,259,0)
    Routine Name     Before Patch   After Patch    Patch List
"BLD",3974,1,260,0)
    ------------     ------------   -----------    ------------
"BLD",3974,1,261,0)
    LR281            N/A              4418686      281(Deleted by KIDS)
"BLD",3974,1,262,0)
    LREPI            14217525         14182167     132,175,260,281
"BLD",3974,1,263,0)
    LREPI1           10654552         11822436     132,157,175,260,281
"BLD",3974,1,264,0)
    LREPI2           7199135          8491199   132,157,175,242,260,281
"BLD",3974,1,265,0)
    LREPI2A          NEW              7574864      281
"BLD",3974,1,266,0)
    LREPI3           5462995          9184652      132,175,260,281
"BLD",3974,1,267,0)
    LREPI5           NEW              2408593      281
"BLD",3974,1,268,0)
    LREPIPH          5818757          6144410      260,281
"BLD",3974,1,269,0)
    LREPIPI          NEW              5220624      281
"BLD",3974,1,270,0)
    LREPIRM          5260075          7566388      175,281
"BLD",3974,1,271,0)
    LREPIRP          5973015          20442264     132,157,175,260,281
"BLD",3974,1,272,0)
    LREPIRP1         NEW              15133552     281
"BLD",3974,1,273,0)
    LREPIRP2         NEW              3729823      281
"BLD",3974,1,274,0)
    LREPIRP3         NEW              29061422     281
"BLD",3974,1,275,0)
    LREPIRP4         NEW              1812384      281
"BLD",3974,1,276,0)
    LREPIRP5         NEW              11788836     281
"BLD",3974,1,277,0)
    LREPIRP6         NEW              25502070     281
"BLD",3974,1,278,0)
    LREPIRP7         NEW              17171829     281
"BLD",3974,1,279,0)
    LREPIRP8         NEW              8376752      281
"BLD",3974,1,280,0)
    LREPIRP9         NEW              4718         281
"BLD",3974,1,281,0)
    LREPIRS          NEW              8576522      281
"BLD",3974,1,282,0)
    LREPIRS1         NEW              16664999     281
"BLD",3974,1,283,0)
    LREPIRS2         NEW              22133542     281
"BLD",3974,1,284,0)
    LREPIRS3         NEW              16290972     281
"BLD",3974,1,285,0)
    LREPISRV         12552990         15211664     260,281 
"BLD",3974,1,286,0)
    LREPISV1         NEW              4805594      281
"BLD",3974,1,287,0)
 
"BLD",3974,1,288,0)
 ASSOCIATED NOIS:
"BLD",3974,1,289,0)
 ================
"BLD",3974,1,290,0)
 
"BLD",3974,1,291,0)
 NONE
"BLD",3974,1,292,0)
 
"BLD",3974,1,293,0)
 E3Rs:
"BLD",3974,1,294,0)
 =====
"BLD",3974,1,295,0)
 
"BLD",3974,1,296,0)
 N/A
"BLD",3974,1,297,0)
 
"BLD",3974,1,298,0)
**********************************************************************
"BLD",3974,1,299,0)
 
"BLD",3974,1,300,0)
 
"BLD",3974,1,301,0)
INSTALLATION INSTRUCTIONS
"BLD",3974,1,302,0)
=========================
"BLD",3974,1,303,0)
 
"BLD",3974,1,304,0)
  The install time for this patch is less than 2 minutes. This patch
"BLD",3974,1,305,0)
  can be installed when Laboratory users are on the system.
"BLD",3974,1,306,0)
 
"BLD",3974,1,307,0)
NOTE: Kernel patches must be current on the target system
"BLD",3974,1,308,0)
      to avoid problems loading and/or installing this patch.
"BLD",3974,1,309,0)
 
"BLD",3974,1,310,0)
  1.  If any of the above routines are mapped, disable mapping for
"BLD",3974,1,311,0)
      them.
"BLD",3974,1,312,0)
 
"BLD",3974,1,313,0)
  2.  Use the 'Load a Distribution" option to load the Host file on to your
"BLD",3974,1,314,0)
      system.
"BLD",3974,1,315,0)
 
"BLD",3974,1,316,0)
  3.  The patch has now been loaded into a Transport global on your
"BLD",3974,1,317,0)
      system.  You now need to use KIDS to install the transport   
"BLD",3974,1,318,0)
      global.
"BLD",3974,1,319,0)
 
"BLD",3974,1,320,0)
  4.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"BLD",3974,1,321,0)
      select the 'Installation' menu.
"BLD",3974,1,322,0)
 
"BLD",3974,1,323,0)
  5.  Use the 'Verify Checksum in Transport Global' option and verify 
"BLD",3974,1,324,0)
      that all routines have the correct checksums.
"BLD",3974,1,325,0)
 
"BLD",3974,1,326,0)
  6.  On the KIDS menu, under the 'Installation' menu, use the   
"BLD",3974,1,327,0)
      following options:
"BLD",3974,1,328,0)
        Print Transport Global
"BLD",3974,1,329,0)
        Compare Transport Global to Current System
"BLD",3974,1,330,0)
        Backup a Transport Global
"BLD",3974,1,331,0)
 
"BLD",3974,1,332,0)
      If you wish to preserve a copy of the routines exported in this 
"BLD",3974,1,333,0)
      patch prior to installation, you should use the 'Backup a 
"BLD",3974,1,334,0)
      Transport Global' option at this time.  You may also compare the  
"BLD",3974,1,335,0)
      routines in your production account to the routines in the patch  
"BLD",3974,1,336,0)
      by using the 'Compare a Transport Global to Current System' 
"BLD",3974,1,337,0)
      option.
"BLD",3974,1,338,0)
  
"BLD",3974,1,339,0)
  7.  Use the 'Install Package(s)' option under the 'Installation' menu
"BLD",3974,1,340,0)
      and select the package 'LR*5.2*281'.
"BLD",3974,1,341,0)
 
"BLD",3974,1,342,0)
      If prompted ' Want KIDS to Rebuild Menu Trees Upon Completion of 
"BLD",3974,1,343,0)
      Install? YES//' choose 'NO'.
"BLD",3974,1,344,0)
 
"BLD",3974,1,345,0)
      If prompted ' Want KIDS to INHIBIT LOGONs during the install?  
"BLD",3974,1,346,0)
      YES// ' choose 'NO'.
"BLD",3974,1,347,0)
 
"BLD",3974,1,348,0)
      If prompted 'Want to DISABLE Scheduled Options, Menu Options, and
"BLD",3974,1,349,0)
      Protocols? YES//', choose 'NO'.
"BLD",3974,1,350,0)
 
"BLD",3974,1,351,0)
  8.  On a mapped system, rebuild your map set.
"BLD",3974,1,352,0)
 
"BLD",3974,1,353,0)
  9.  Routine LR281 will be deleted after successful patch installation.
"BLD",3974,4,0)
^9.64PA^69.5^1
"BLD",3974,4,69.5,0)
69.5
"BLD",3974,4,69.5,222)
y^n^f^^y^^y^m^n
"BLD",3974,4,69.5,223)

"BLD",3974,4,69.5,224)

"BLD",3974,4,"B",69.5,69.5)

"BLD",3974,"INI")
PRE^LR281
"BLD",3974,"INID")
y
"BLD",3974,"INIT")
POST^LR281
"BLD",3974,"KRN",0)
^9.67PA^8989.52^19
"BLD",3974,"KRN",.4,0)
.4
"BLD",3974,"KRN",.401,0)
.401
"BLD",3974,"KRN",.402,0)
.402
"BLD",3974,"KRN",.402,"NM",0)
^9.68A^^
"BLD",3974,"KRN",.403,0)
.403
"BLD",3974,"KRN",.403,"NM",0)
^9.68A^2^2
"BLD",3974,"KRN",.403,"NM",1,0)
LREPI    FILE #69.5^69.5^0
"BLD",3974,"KRN",.403,"NM",2,0)
LREPI9    FILE #69.5^69.5^0
"BLD",3974,"KRN",.403,"NM","B","LREPI    FILE #69.5",1)

"BLD",3974,"KRN",.403,"NM","B","LREPI9    FILE #69.5",2)

"BLD",3974,"KRN",.5,0)
.5
"BLD",3974,"KRN",.84,0)
.84
"BLD",3974,"KRN",3.6,0)
3.6
"BLD",3974,"KRN",3.8,0)
3.8
"BLD",3974,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",3974,"KRN",9.2,0)
9.2
"BLD",3974,"KRN",9.8,0)
9.8
"BLD",3974,"KRN",9.8,"NM",0)
^9.68A^28^25
"BLD",3974,"KRN",9.8,"NM",1,0)
LREPI^^0^B57448349
"BLD",3974,"KRN",9.8,"NM",2,0)
LREPI1^^0^B55919075
"BLD",3974,"KRN",9.8,"NM",3,0)
LREPI3^^0^B32820558
"BLD",3974,"KRN",9.8,"NM",4,0)
LREPISRV^^0^B27007288
"BLD",3974,"KRN",9.8,"NM",5,0)
LREPISV1^^0^B9680185
"BLD",3974,"KRN",9.8,"NM",6,0)
LREPI5^^0^B5654489
"BLD",3974,"KRN",9.8,"NM",7,0)
LREPI2^^0^B32621324
"BLD",3974,"KRN",9.8,"NM",8,0)
LREPI2A^^0^B25858178
"BLD",3974,"KRN",9.8,"NM",9,0)
LREPIRS^^0^B40087334
"BLD",3974,"KRN",9.8,"NM",10,0)
LREPIRS1^^0^B38487610
"BLD",3974,"KRN",9.8,"NM",12,0)
LREPIRM^^0^B33714924
"BLD",3974,"KRN",9.8,"NM",13,0)
LREPIRS2^^0^B92236192
"BLD",3974,"KRN",9.8,"NM",14,0)
LREPIRS3^^0^B53422919
"BLD",3974,"KRN",9.8,"NM",15,0)
LREPIRP^^0^B81822562
"BLD",3974,"KRN",9.8,"NM",16,0)
LREPIRP1^^0^B41905812
"BLD",3974,"KRN",9.8,"NM",17,0)
LREPIRP2^^0^B9462001
"BLD",3974,"KRN",9.8,"NM",18,0)
LREPIRP3^^0^B78489594
"BLD",3974,"KRN",9.8,"NM",19,0)
LREPIRP4^^0^B3163409
"BLD",3974,"KRN",9.8,"NM",20,0)
LREPIRP5^^0^B38384061
"BLD",3974,"KRN",9.8,"NM",21,0)
LREPIRP6^^0^B47406279
"BLD",3974,"KRN",9.8,"NM",23,0)
LREPIRP7^^0^B69038659
"BLD",3974,"KRN",9.8,"NM",24,0)
LREPIPI^^0^B12589955
"BLD",3974,"KRN",9.8,"NM",25,0)
LREPIRP9^^0^B14953
"BLD",3974,"KRN",9.8,"NM",27,0)
LREPIRP8^^0^B17447625
"BLD",3974,"KRN",9.8,"NM",28,0)
LREPIPH^^0^B10233288
"BLD",3974,"KRN",9.8,"NM","B","LREPI",1)

"BLD",3974,"KRN",9.8,"NM","B","LREPI1",2)

"BLD",3974,"KRN",9.8,"NM","B","LREPI2",7)

"BLD",3974,"KRN",9.8,"NM","B","LREPI2A",8)

"BLD",3974,"KRN",9.8,"NM","B","LREPI3",3)

"BLD",3974,"KRN",9.8,"NM","B","LREPI5",6)

"BLD",3974,"KRN",9.8,"NM","B","LREPIPH",28)

"BLD",3974,"KRN",9.8,"NM","B","LREPIPI",24)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRM",12)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP",15)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP1",16)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP2",17)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP3",18)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP4",19)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP5",20)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP6",21)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP7",23)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP8",27)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRP9",25)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRS",9)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRS1",10)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRS2",13)

"BLD",3974,"KRN",9.8,"NM","B","LREPIRS3",14)

"BLD",3974,"KRN",9.8,"NM","B","LREPISRV",4)

"BLD",3974,"KRN",9.8,"NM","B","LREPISV1",5)

"BLD",3974,"KRN",19,0)
19
"BLD",3974,"KRN",19,"NM",0)
^9.68A^22^17
"BLD",3974,"KRN",19,"NM",4,0)
LREPI ENTER/EDIT LOCAL PATH^^0
"BLD",3974,"KRN",19,"NM",5,0)
LREPI ENHANCE MANUAL RUN^^0
"BLD",3974,"KRN",19,"NM",6,0)
LREPILK^^0
"BLD",3974,"KRN",19,"NM",7,0)
LREPI PROTOCOL EDIT^^0
"BLD",3974,"KRN",19,"NM",10,0)
LREPI NIGHTLY TASK^^0
"BLD",3974,"KRN",19,"NM",11,0)
LREPI PARAMETER SETUP^^0
"BLD",3974,"KRN",19,"NM",12,0)
LREPI PRIMARY MENU^^1^
"BLD",3974,"KRN",19,"NM",13,0)
LREPISERVER^^0
"BLD",3974,"KRN",19,"NM",14,0)
LREPI GENERATE REPORT/SP^^0
"BLD",3974,"KRN",19,"NM",15,0)
LREPI PRINT REPORT/SPSHT^^0
"BLD",3974,"KRN",19,"NM",16,0)
LREPIDATASERVER^^0
"BLD",3974,"KRN",19,"NM",17,0)
LREPI VERIFICATION REPORT^^0
"BLD",3974,"KRN",19,"NM",18,0)
LREPI SEARCH EXTRACT MENU^^0
"BLD",3974,"KRN",19,"NM",19,0)
LREPI LOCAL PATHOGEN MENU^^0
"BLD",3974,"KRN",19,"NM",20,0)
LREPI PATHOGEN INQUIRY^^0
"BLD",3974,"KRN",19,"NM",21,0)
LREPI DELETE LOCAL PATHOGEN^^0
"BLD",3974,"KRN",19,"NM",22,0)
LREPI DELETE LOCAL REPORT^^0
"BLD",3974,"KRN",19,"NM","B","LREPI DELETE LOCAL PATHOGEN",21)

"BLD",3974,"KRN",19,"NM","B","LREPI DELETE LOCAL REPORT",22)

"BLD",3974,"KRN",19,"NM","B","LREPI ENHANCE MANUAL RUN",5)

"BLD",3974,"KRN",19,"NM","B","LREPI ENTER/EDIT LOCAL PATH",4)

"BLD",3974,"KRN",19,"NM","B","LREPI GENERATE REPORT/SP",14)

"BLD",3974,"KRN",19,"NM","B","LREPI LOCAL PATHOGEN MENU",19)

"BLD",3974,"KRN",19,"NM","B","LREPI NIGHTLY TASK",10)

"BLD",3974,"KRN",19,"NM","B","LREPI PARAMETER SETUP",11)

"BLD",3974,"KRN",19,"NM","B","LREPI PATHOGEN INQUIRY",20)

"BLD",3974,"KRN",19,"NM","B","LREPI PRIMARY MENU",12)

"BLD",3974,"KRN",19,"NM","B","LREPI PRINT REPORT/SPSHT",15)

"BLD",3974,"KRN",19,"NM","B","LREPI PROTOCOL EDIT",7)

"BLD",3974,"KRN",19,"NM","B","LREPI SEARCH EXTRACT MENU",18)

"BLD",3974,"KRN",19,"NM","B","LREPI VERIFICATION REPORT",17)

"BLD",3974,"KRN",19,"NM","B","LREPIDATASERVER",16)

"BLD",3974,"KRN",19,"NM","B","LREPILK",6)

"BLD",3974,"KRN",19,"NM","B","LREPISERVER",13)

"BLD",3974,"KRN",19.1,0)
19.1
"BLD",3974,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",3974,"KRN",101,0)
101
"BLD",3974,"KRN",101,"NM",0)
^9.68A^3^3
"BLD",3974,"KRN",101,"NM",1,0)
LREPI CLIENT^^0
"BLD",3974,"KRN",101,"NM",2,0)
LRNCH SEND CLIENT^^1^
"BLD",3974,"KRN",101,"NM",3,0)
LRNCHAAC^^1^
"BLD",3974,"KRN",101,"NM","B","LREPI CLIENT",1)

"BLD",3974,"KRN",101,"NM","B","LRNCH SEND CLIENT",2)

"BLD",3974,"KRN",101,"NM","B","LRNCHAAC",3)

"BLD",3974,"KRN",409.61,0)
409.61
"BLD",3974,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",3974,"KRN",771,0)
771
"BLD",3974,"KRN",771,"NM",0)
^9.68A^^
"BLD",3974,"KRN",870,0)
870
"BLD",3974,"KRN",8989.51,0)
8989.51
"BLD",3974,"KRN",8989.52,0)
8989.52
"BLD",3974,"KRN",8994,0)
8994
"BLD",3974,"KRN","B",.4,.4)

"BLD",3974,"KRN","B",.401,.401)

"BLD",3974,"KRN","B",.402,.402)

"BLD",3974,"KRN","B",.403,.403)

"BLD",3974,"KRN","B",.5,.5)

"BLD",3974,"KRN","B",.84,.84)

"BLD",3974,"KRN","B",3.6,3.6)

"BLD",3974,"KRN","B",3.8,3.8)

"BLD",3974,"KRN","B",9.2,9.2)

"BLD",3974,"KRN","B",9.8,9.8)

"BLD",3974,"KRN","B",19,19)

"BLD",3974,"KRN","B",19.1,19.1)

"BLD",3974,"KRN","B",101,101)

"BLD",3974,"KRN","B",409.61,409.61)

"BLD",3974,"KRN","B",771,771)

"BLD",3974,"KRN","B",870,870)

"BLD",3974,"KRN","B",8989.51,8989.51)

"BLD",3974,"KRN","B",8989.52,8989.52)

"BLD",3974,"KRN","B",8994,8994)

"BLD",3974,"PRE")
LR281
"BLD",3974,"QUES",0)
^9.62^^
"BLD",3974,"REQB",0)
^9.611^2^2
"BLD",3974,"REQB",1,0)
LR*5.2*260^2
"BLD",3974,"REQB",2,0)
PXRM*1.5*1^2
"BLD",3974,"REQB","B","LR*5.2*260",1)

"BLD",3974,"REQB","B","PXRM*1.5*1",2)

"DATA",69.5,21,0)
VANC-RES COAG NEG STAPH^0^15^3040518^M^^1696^1^21
"DATA",69.5,21,1,0)
^69.52P^^
"DATA",69.5,21,2,0)
^69.53P^7^7
"DATA",69.5,21,2,1,0)
4845
"DATA",69.5,21,2,2,0)
731
"DATA",69.5,21,2,3,0)
4847
"DATA",69.5,21,2,4,0)
732
"DATA",69.5,21,2,5,0)
733
"DATA",69.5,21,2,6,0)
4844
"DATA",69.5,21,2,7,0)
500713
"DATA",69.5,21,3,0)
^69.54P^^
"DATA",69.5,21,4,0)
^69.55P^1^1
"DATA",69.5,21,4,1,0)
30^^^
"DATA",69.5,21,5,0)
^69.56P^^
"DATA",69.5,21,8,0)
^69.515^26^26^3040518^^^^
"DATA",69.5,21,8,1,0)
Staphylococci are significant contributors to disease in humans.  Staphylococcus
"DATA",69.5,21,8,2,0)
aureus is the most virulent of the staphylococci, but the non-aureus 
"DATA",69.5,21,8,3,0)
staphylococci can also cause disease.  As a general group, these non-aureus
"DATA",69.5,21,8,4,0)
staphylococci are referred to as coagulase negative staphylococci;  some refer
"DATA",69.5,21,8,5,0)
to this group of organisms as Staphylococcus epidermidis because the
"DATA",69.5,21,8,6,0)
staphylococcal species S. epidermidis is one of the more common members of this
"DATA",69.5,21,8,7,0)
group to cause disease.   However, to be accurate, the group of organisms
"DATA",69.5,21,8,8,0)
called coagulase negative staphylococci includes many different species, even if
"DATA",69.5,21,8,9,0)
the generic terminology of Staphylococcus epidermidis (a.k.a. Staph epi) has
"DATA",69.5,21,8,10,0)
been applied.   The coagulase negative staphylococci are important emerging
"DATA",69.5,21,8,11,0)
pathogens in that they contribute to many infections acquired while in a
"DATA",69.5,21,8,12,0)
healthcare facility.  As a general rule, the coagulase negative staphylococci
"DATA",69.5,21,8,13,0)
have lesser virulence than Staphylococcus aureus, but they can still cause
"DATA",69.5,21,8,14,0)
serious, life-threatening disease in certain settings.  As with other organisms,
"DATA",69.5,21,8,15,0)
antibiotic resistance is occuring among the coagulase negative staphylococci.
"DATA",69.5,21,8,16,0)
There is concern in particular for resistance to vancomycin among this group 
"DATA",69.5,21,8,17,0)
of organisms, as it is currently the only antibiotic that has consistently
"DATA",69.5,21,8,18,0)
shown activity against infections caused by this group of organisms;  however,
"DATA",69.5,21,8,19,0)
decreased susceptibility and even resistance to vancomycin has been identified
"DATA",69.5,21,8,20,0)
in rare cases.
"DATA",69.5,21,8,21,0)
The purpose of this EPI pathogen entry is to capture all isolates from all
"DATA",69.5,21,8,22,0)
specimens that contain a coagulase negative staphylococcus that is not
"DATA",69.5,21,8,23,0)
Susceptible to vancomycin (whether your facility calls it coagulase negative 
"DATA",69.5,21,8,24,0)
staphylococcus, Staphylococcus epidermidis, Staphylococcus saprophyticus or
"DATA",69.5,21,8,25,0)
the myriad of other staphylococcal species that comprise this group).
"DATA",69.5,21,8,26,0)

"DATA",69.5,22,0)
ALL STREP PNEUMO^0^15^3040518^M^^1696^1^22
"DATA",69.5,22,2,0)
^69.53P^1^1
"DATA",69.5,22,2,1,0)
4850
"DATA",69.5,22,4)
ALL STREP PNEUMO   
"DATA",69.5,22,8,0)
^69.515^20^20^3040518^^^^
"DATA",69.5,22,8,1,0)
Streptococcus pneumoniae is a bacterium that causes serious disease in humans,
"DATA",69.5,22,8,2,0)
including pneumonia, bacteremia, meningitis and even death.  It is an important
"DATA",69.5,22,8,3,0)
pathogen to monitor in that many of the more serious sequelae of infection may
"DATA",69.5,22,8,4,0)
be ameliorated with preventive vaccination.  As with many other organisms that 
"DATA",69.5,22,8,5,0)
cause disease in humans, resistance to antibiotics is emerging in this S.
"DATA",69.5,22,8,6,0)
pneumoniae.  The presence of antibiotic resistance creates a challenge in 
"DATA",69.5,22,8,7,0)
treatment of infections with this organism.  In order to determine the 
"DATA",69.5,22,8,8,0)
prevalence of antibiotic resistance, a baseline of occurrence of ALL 
"DATA",69.5,22,8,9,0)
Streptococcus pneumoniae needs to be obtained.  This particular EPI pathogen
"DATA",69.5,22,8,10,0)
setting has been created to identify ALL culture positive isolates of
"DATA",69.5,22,8,11,0)
Streptococcus pneumoniae from any specimen site in any patient/client receiving
"DATA",69.5,22,8,12,0)
care within the VHA. 
"DATA",69.5,22,8,13,0)
Note:  Even specimens that have been obtained from patients (not the
"DATA",69.5,22,8,14,0)
environment) as part of an epidemiologic prevalence study or survey should be
"DATA",69.5,22,8,15,0)
included if they are present in the VistA laboratory package results from your
"DATA",69.5,22,8,16,0)
site.  
"DATA",69.5,22,8,17,0)
The results from this EPI pathogen setting will be coupled with the results 
"DATA",69.5,22,8,18,0)
from Reference #3 (Penicillin-Resistant Pneumococcus) to help determine the
"DATA",69.5,22,8,19,0)
percentage of all isolates of Streptococcus pneumoniae that have penicillin
"DATA",69.5,22,8,20,0)
resistance.   
"DATA",69.5,23,0)
ALL ENTEROCOCCI^0^15^3040518^M^^1696^1^23
"DATA",69.5,23,1,0)
^69.52P^^
"DATA",69.5,23,2,0)
^69.53P^5^5
"DATA",69.5,23,2,1,0)
404
"DATA",69.5,23,2,2,0)
659
"DATA",69.5,23,2,3,0)
4809
"DATA",69.5,23,2,4,0)
413
"DATA",69.5,23,2,5,0)
414
"DATA",69.5,23,3,0)
^69.54P^^
"DATA",69.5,23,4)
ALL ENTEROCOCCI   
"DATA",69.5,23,4,0)
^69.55P^^
"DATA",69.5,23,5,0)
^69.56P^^
"DATA",69.5,23,6,0)
^69.57P^^
"DATA",69.5,23,8,0)
^69.515^17^17^3040518^^^^
"DATA",69.5,23,8,1,0)
The enterococci are a group of bacteria that can cause serious disease in
"DATA",69.5,23,8,2,0)
humans, including blood stream infections, urinary tract infections, wound 
"DATA",69.5,23,8,3,0)
infections, endocarditis and even death.  As with many other organisms that 
"DATA",69.5,23,8,4,0)
cause disease in humans, resistance to antibiotics is emerging in the 
"DATA",69.5,23,8,5,0)
enterococci.  The presence of antibiotic resistance creates a challenge in
"DATA",69.5,23,8,6,0)
treatment of infections with this organism.  In order to determine the 
"DATA",69.5,23,8,7,0)
prevalence of antibiotic resistance, a baseline of occurrence of ALL enterococci
"DATA",69.5,23,8,8,0)
needs to be obtained.  This particular EPI pathogen setting has been created
"DATA",69.5,23,8,9,0)
to identify ALL culture positive isolates of enterococci from any specimen site
"DATA",69.5,23,8,10,0)
in any patient/client receiving care within the VHA.  
"DATA",69.5,23,8,11,0)
Note:  Even specimens that have been obtained from patients (not the
"DATA",69.5,23,8,12,0)
environment) as part of an epidemiologic prevalence study or survey should be
"DATA",69.5,23,8,13,0)
included if they are present in the VistA laboratory package results from your
"DATA",69.5,23,8,14,0)
site.  
"DATA",69.5,23,8,15,0)
The results from this EPI pathogen setting will be coupled with the results
"DATA",69.5,23,8,16,0)
from Reference #1 (Vancomycin-Resistant Enterococci [VRE]) to help determine
"DATA",69.5,23,8,17,0)
the percentage of all isolates of enterococci that have vancomycin resistance.
"DATA",69.5,23,9,0)
^69.58^^
"DATA",69.5,24,0)
METH-RES STAPH AUREUS^0^15^3040518^M^^1696^1^19
"DATA",69.5,24,1,0)
^69.52P^^
"DATA",69.5,24,2,0)
^69.53P^1^1
"DATA",69.5,24,2,1,0)
2
"DATA",69.5,24,3,0)
^69.54P^^
"DATA",69.5,24,4,0)
^69.55P^2^2
"DATA",69.5,24,4,1,0)
22^^^
"DATA",69.5,24,4,2,0)
36^^^
"DATA",69.5,24,5,0)
^69.56P^^
"DATA",69.5,24,8,0)
^69.515^21^21^3040518^^^^
"DATA",69.5,24,8,1,0)
Methicillin (or oxacillin)-resistant Staphylococcus aureus (MRSA) is a pathogen 
"DATA",69.5,24,8,2,0)
of continuing importance for healthcare facilities.  It is also an emerging
"DATA",69.5,24,8,3,0)
pathogen from community-acquired sources.  It is an organism that can be
"DATA",69.5,24,8,4,0)
transmitted easily within facilities and in the community.  It can produce a 
"DATA",69.5,24,8,5,0)
spectrum of illness from asymptomatic colonization to severe, life-threatening
"DATA",69.5,24,8,6,0)
disease in those patients who acquire it.  Whether this organism is causing
"DATA",69.5,24,8,7,0)
disease or not, it can contribute to spread within a healthcare facility.  The
"DATA",69.5,24,8,8,0)
purpose of this pathogen on the EPI list is to capture all cultures that have
"DATA",69.5,24,8,9,0)
MRSA present (whether the patient has disease or is just colonized).  This
"DATA",69.5,24,8,10,0)
should capture all methicillin non-Susceptible isolates of Staphylococcus
"DATA",69.5,24,8,11,0)
aureus.
"DATA",69.5,24,8,12,0)

"DATA",69.5,24,8,13,0)
Note:  This includes all positive cultures for MRSA, both clinical cultures
"DATA",69.5,24,8,14,0)
and those done as part of epidemiologic prevalence studies or surveys (such
"DATA",69.5,24,8,15,0)
as nasal and rectal swabs) at your facility. 
"DATA",69.5,24,8,16,0)

"DATA",69.5,24,8,17,0)
Any Staphylococcus aureus isolate that is resistant to methicillin (or
"DATA",69.5,24,8,18,0)
oxacillin) should be captured for this.  Laboratories may use different
"DATA",69.5,24,8,19,0)
methods to capture these data.  An appropriate National Committee on Clinical
"DATA",69.5,24,8,20,0)
Laboratory Standards (NCCLS) testing schema used and captured in VistA should
"DATA",69.5,24,8,21,0)
be adequate. 
"DATA",69.5,25,0)
ALL STAPH AUREUS^0^15^3040518^M^^1696^1^18
"DATA",69.5,25,2,0)
^69.53P^1^1
"DATA",69.5,25,2,1,0)
2
"DATA",69.5,25,5)
ALL STAPH AUREUS   
"DATA",69.5,25,8,0)
^69.515^20^20^3040518^^^
"DATA",69.5,25,8,1,0)
Staphylococcus aureus is a bacterium that causes much disease in humans,
"DATA",69.5,25,8,2,0)
including furunculosis, boils, acne, cellulitis, pneumonia, toxic shock 
"DATA",69.5,25,8,3,0)
syndrome and even death.  It has always been a significant pathogen in the 
"DATA",69.5,25,8,4,0)
community setting, as well as in the healthcare setting where transmission
"DATA",69.5,25,8,5,0)
can occur through contact and from the hands of healthcare personnel.  The
"DATA",69.5,25,8,6,0)
presence of antibiotic resistance creates a challenge in treatment of
"DATA",69.5,25,8,7,0)
infections with this organism.  In order to determine the prevalence of
"DATA",69.5,25,8,8,0)
antibiotic resistance, a baseline of occurrence of ALL Staphylococcus
"DATA",69.5,25,8,9,0)
aureus needs to be obtained.  This particular EPI pathogen setting has been
"DATA",69.5,25,8,10,0)
created to identify ALL culture positive isolates of Staphylococcus aureus
"DATA",69.5,25,8,11,0)
from any specimen site in any patient/client receiving care within the VHA.  
"DATA",69.5,25,8,12,0)
Note:  Even specimens that have been obtained from patients (not the
"DATA",69.5,25,8,13,0)
environment) as part of an epidemiologic prevalence study or survey 
"DATA",69.5,25,8,14,0)
should be included if they are present in the VistA laboratory package 
"DATA",69.5,25,8,15,0)
results from your site.  
"DATA",69.5,25,8,16,0)

"DATA",69.5,25,8,17,0)
The results from this EPI pathogen setting will be coupled with the results
"DATA",69.5,25,8,18,0)
from Reference #19 (MRSA) and Reference #20 (VRSA) to help determine the
"DATA",69.5,25,8,19,0)
percentage of all isolates of Staphylococcus aureus that have methicillin
"DATA",69.5,25,8,20,0)
(oxacillin) resistance and vancomycin resistance.  
"DATA",69.5,26,0)
VANC-RES STAPH AUREUS^0^15^3040520^M^^1696^1^20
"DATA",69.5,26,1,0)
^69.52P^^
"DATA",69.5,26,2,0)
^69.53P^1^1
"DATA",69.5,26,2,1,0)
2
"DATA",69.5,26,3,0)
^69.54P^^
"DATA",69.5,26,4,0)
^69.55P^1^1
"DATA",69.5,26,4,1,0)
30^^^
"DATA",69.5,26,5)
VANC-RES STAPH AUREUS   
"DATA",69.5,26,5,0)
^69.56P^^
"DATA",69.5,26,8,0)
^69.515^24^24^3040518^^^^
"DATA",69.5,26,8,1,0)
Vancomycin-resistant Staphylococcus aureus (VRSA) is a rare but emerging
"DATA",69.5,26,8,2,0)
pathogen for healthcare facilities.  It is of concern because the resistance
"DATA",69.5,26,8,3,0)
to this antibiotic can be combined with resistance to other antibiotics;  it is
"DATA",69.5,26,8,4,0)
this multiple resistance that will make infection with this organism difficult
"DATA",69.5,26,8,5,0)
to treat.  Staphylococci can be transmitted easily within facilities; the easy
"DATA",69.5,26,8,6,0)
transmission is of concern for this organism should it occur in a patient.  The
"DATA",69.5,26,8,7,0)
staphylococci can produce a spectrum of illness from asymptomatic colonization
"DATA",69.5,26,8,8,0)
to severe, life-threatening disease in those patients who acquire them.  Whether
"DATA",69.5,26,8,9,0)
this organism is causing disease or not, it can contribute to spread within a
"DATA",69.5,26,8,10,0)
healthcare facility.  The purpose of this pathogen on the EPI list is to capture
"DATA",69.5,26,8,11,0)
all cultures that have VRSA present (whether the patient has disease or is just
"DATA",69.5,26,8,12,0)
colonized).  This should capture all vancomycin non-Susceptible strains of
"DATA",69.5,26,8,13,0)
Staphylococcus aureus, whether the susceptibility interpretation is 
"DATA",69.5,26,8,14,0)
Intermediate or Resistant.
"DATA",69.5,26,8,15,0)

"DATA",69.5,26,8,16,0)
Note:  This includes all positive cultures for MRSA, both clinical cultures
"DATA",69.5,26,8,17,0)
and those done as part of epidemiologic prevalence studies or surveys (such as
"DATA",69.5,26,8,18,0)
nasal and rectal swabs) at your facility.  
"DATA",69.5,26,8,19,0)

"DATA",69.5,26,8,20,0)
Any Staphylococcus aureus isolate that is resistant to vancomycin should be
"DATA",69.5,26,8,21,0)
captured for this.  Laboratories may use different methods to capture these
"DATA",69.5,26,8,22,0)
data.  An appropriate National Committee on Clinical Laboratory Standard
"DATA",69.5,26,8,23,0)
(NCCLS) testing schema used and captured in VistA should be adequate. 
"DATA",69.5,26,8,24,0)

"FIA",69.5)
LAB SEARCH/EXTRACT
"FIA",69.5,0)
^LAB(69.5,
"FIA",69.5,0,0)
69.5
"FIA",69.5,0,1)
y^n^f^^y^^y^m^n
"FIA",69.5,0,10)

"FIA",69.5,0,11)

"FIA",69.5,0,"RLRO")

"FIA",69.5,0,"VR")
5.2^LR
"FIA",69.5,69.5)
0
"FIA",69.5,69.514)
0
"FIA",69.5,69.515)
0
"FIA",69.5,69.52)
0
"FIA",69.5,69.53)
0
"FIA",69.5,69.54)
0
"FIA",69.5,69.55)
0
"FIA",69.5,69.56)
0
"FIA",69.5,69.57)
0
"FIA",69.5,69.58)
0
"FRV1",69.5,"21,0",7)
LREPI
"FRV1",69.5,"21,0",7,"F")
;LAB(69.4,
"FRV1",69.5,"22,0",7)
LREPI
"FRV1",69.5,"22,0",7,"F")
;LAB(69.4,
"FRV1",69.5,"23,0",7)
LREPI
"FRV1",69.5,"23,0",7,"F")
;LAB(69.4,
"FRV1",69.5,"24,0",7)
LREPI
"FRV1",69.5,"24,0",7,"F")
;LAB(69.4,
"FRV1",69.5,"25,0",7)
LREPI
"FRV1",69.5,"25,0",7,"F")
;LAB(69.4,
"FRV1",69.5,"26,0",7)
LREPI
"FRV1",69.5,"26,0",7,"F")
;LAB(69.4,
"INI")
PRE^LR281
"INIT")
POST^LR281
"KRN",.403,44,-1)
0^1
"KRN",.403,44,0)
LREPI^@^@^^2961007.1013^^^69.5^0^0^1
"KRN",.403,44,40,0)
^.4031I^6^6
"KRN",.403,44,40,1,0)
1^^1,1^2
"KRN",.403,44,40,1,1)
Page 1
"KRN",.403,44,40,1,40,0)
^.4032IP^157^5
"KRN",.403,44,40,1,40,146,0)
LREPIHEAD^1^1,1^d
"KRN",.403,44,40,1,40,147,0)
LREPI2^2^6,1^e
"KRN",.403,44,40,1,40,147,2)
3
"KRN",.403,44,40,1,40,148,0)
LREPI3^3^13,2^e
"KRN",.403,44,40,1,40,148,2)
3
"KRN",.403,44,40,1,40,149,0)
LREPI1^4^7,2^d
"KRN",.403,44,40,1,40,157,0)
LREPI11^5^13,54^e
"KRN",.403,44,40,2,0)
2^^1,1^3^1
"KRN",.403,44,40,2,1)
Page 2
"KRN",.403,44,40,2,40,0)
^.4032IP^209^5
"KRN",.403,44,40,2,40,146,0)
LREPIHEAD^1^1,1^d
"KRN",.403,44,40,2,40,150,0)
LREPI4^2^9,1^e
"KRN",.403,44,40,2,40,150,2)
3
"KRN",.403,44,40,2,40,151,0)
LREPI95^5^14,1^e
"KRN",.403,44,40,2,40,151,2)
3
"KRN",.403,44,40,2,40,152,0)
LREPI6^4^7,1^d
"KRN",.403,44,40,2,40,209,0)
LREPI12^3^9,44^e
"KRN",.403,44,40,2,40,209,2)
3
"KRN",.403,44,40,3,0)
3^^1,1^4^2
"KRN",.403,44,40,3,1)
Page 3
"KRN",.403,44,40,3,40,0)
^.4032IP^155^4
"KRN",.403,44,40,3,40,146,0)
LREPIHEAD^1^1,1^d
"KRN",.403,44,40,3,40,153,0)
LREPI7^2^7,1^d
"KRN",.403,44,40,3,40,154,0)
LREPI8^3^11,1^e
"KRN",.403,44,40,3,40,154,2)
4
"KRN",.403,44,40,3,40,155,0)
LREPI9^4^11,40^e
"KRN",.403,44,40,3,40,155,2)
4
"KRN",.403,44,40,4,0)
4^^1,1^5^4
"KRN",.403,44,40,4,1)
Page 4
"KRN",.403,44,40,4,40,0)
^.4032IP^213^2
"KRN",.403,44,40,4,40,146,0)
LREPIHEAD^1^1,1^d
"KRN",.403,44,40,4,40,213,0)
LREPI13^2^7,1^e
"KRN",.403,44,40,5,0)
5^^1,1^1^4
"KRN",.403,44,40,5,1)
Page 5
"KRN",.403,44,40,5,40,0)
^.4032IP^156^2
"KRN",.403,44,40,5,40,146,0)
LREPIHEAD^1^1,1^d
"KRN",.403,44,40,5,40,156,0)
LREPI10^2^7,1^e
"KRN",.403,44,40,6,0)
6^^1,1^^^1^15,75
"KRN",.403,44,40,6,1)
Page 6^3,LREPI5,2
"KRN",.403,44,40,6,15,0)
^^3^3^3040226^
"KRN",.403,44,40,6,15,1,0)
 
"KRN",.403,44,40,6,15,2,0)
This pop-up page contains the INDICATOR(#1) and INDICATED VALUE (#2) 
"KRN",.403,44,40,6,15,3,0)
fields.
"KRN",.403,44,40,6,40,0)
^.4032IP^385^1
"KRN",.403,44,40,6,40,385,0)
LREPI15^1^2,4^e
"KRN",.403,92,-1)
0^2
"KRN",.403,92,0)
LREPI9^@^@^^2961007.1013^^^69.5^0^0^1
"KRN",.403,92,40,0)
^.4031I^5^5
"KRN",.403,92,40,1,0)
1^^1,1^2
"KRN",.403,92,40,1,1)
Page 1
"KRN",.403,92,40,1,40,0)
^.4032IP^^0
"KRN",.403,92,40,1,40,364,0)
LREPI9HEAD^1^1,1^d
"KRN",.403,92,40,1,40,365,0)
LREPI92^2^6,1^e
"KRN",.403,92,40,1,40,365,2)
3
"KRN",.403,92,40,1,40,366,0)
LREPI93^3^13,2^e
"KRN",.403,92,40,1,40,366,2)
3
"KRN",.403,92,40,1,40,367,0)
LREPI91^4^7,2^d
"KRN",.403,92,40,1,40,375,0)
LREPI911^5^13,54^e
"KRN",.403,92,40,2,0)
2^^1,1^3^1
"KRN",.403,92,40,2,1)
Page 2
"KRN",.403,92,40,2,40,0)
^.4032IP^^0
"KRN",.403,92,40,2,40,364,0)
LREPI9HEAD^1^1,1^d
"KRN",.403,92,40,2,40,368,0)
LREPI94^2^9,1^e
"KRN",.403,92,40,2,40,368,2)
3
"KRN",.403,92,40,2,40,369,0)
LREPI5^5^14,1^e
"KRN",.403,92,40,2,40,369,2)
3
"KRN",.403,92,40,2,40,370,0)
LREPI96^4^7,1^d
"KRN",.403,92,40,2,40,376,0)
LREPI912^3^9,44^e
"KRN",.403,92,40,2,40,376,2)
3
"KRN",.403,92,40,3,0)
3^^1,1^4^2
"KRN",.403,92,40,3,1)
Page 3
"KRN",.403,92,40,3,40,0)
^.4032IP^^0
"KRN",.403,92,40,3,40,364,0)
LREPI9HEAD^1^1,1^d
"KRN",.403,92,40,3,40,371,0)
LREPI97^2^7,1^d
"KRN",.403,92,40,3,40,372,0)
LREPI98^3^11,1^e
"KRN",.403,92,40,3,40,372,2)
4
"KRN",.403,92,40,3,40,373,0)
LREPI99^4^11,40^e
"KRN",.403,92,40,3,40,373,2)
4
"KRN",.403,92,40,4,0)
4^^1,1^5^4
"KRN",.403,92,40,4,1)
Page 4
"KRN",.403,92,40,4,40,0)
^.4032IP^^0
"KRN",.403,92,40,4,40,364,0)
LREPI9HEAD^1^1,1^d
"KRN",.403,92,40,4,40,377,0)
LREPI913^2^7,1^e
"KRN",.403,92,40,5,0)
5^^1,1^1^4
"KRN",.403,92,40,5,1)
Page 5
"KRN",.403,92,40,5,40,0)
^.4032IP^^0
"KRN",.403,92,40,5,40,364,0)
LREPI9HEAD^1^1,1^d
"KRN",.403,92,40,5,40,374,0)
LREPI910^2^7,1^e
"KRN",.404,146,0)
LREPIHEAD^69.5^
"KRN",.404,146,40,0)
^.4044I^6^6
"KRN",.404,146,40,1,0)
1^LABORATORY SEARCH/EXTRACT PARAMETERS INPUT SCREEN^1
"KRN",.404,146,40,1,2)
^^2,15
"KRN",.404,146,40,2,0)
2^NAME^3
"KRN",.404,146,40,2,1)
.01
"KRN",.404,146,40,2,2)
4,7^50^4,1
"KRN",.404,146,40,3,0)
3^INACTIVE: ^3
"KRN",.404,146,40,3,1)
1
"KRN",.404,146,40,3,2)
4,70^3^4,60^1
"KRN",.404,146,40,4,0)
4^________________________________________^1
"KRN",.404,146,40,4,2)
^^5,1
"KRN",.404,146,40,5,0)
5^________________________________________^1
"KRN",.404,146,40,5,2)
^^5,41
"KRN",.404,146,40,6,0)
6^!M^1
"KRN",.404,146,40,6,.1)
S Y="Page "_DDSPG_" of 5"
"KRN",.404,146,40,6,2)
^^2,67
"KRN",.404,147,0)
LREPI2^69.52
"KRN",.404,147,40,0)
^.4044I^3^3
"KRN",.404,147,40,1,0)
1^^3
"KRN",.404,147,40,1,1)
.01
"KRN",.404,147,40,1,2)
4,1^30
"KRN",.404,147,40,2,0)
2^^3
"KRN",.404,147,40,2,1)
1
"KRN",.404,147,40,2,2)
4,35^20
"KRN",.404,147,40,3,0)
3^^3
"KRN",.404,147,40,3,1)
2
"KRN",.404,147,40,3,2)
4,61^15
"KRN",.404,148,0)
LREPI3^69.54
"KRN",.404,148,40,0)
^.4044I^2^2
"KRN",.404,148,40,1,0)
1^^3
"KRN",.404,148,40,1,1)
.01
"KRN",.404,148,40,1,2)
3,2^7
"KRN",.404,148,40,2,0)
2^^4
"KRN",.404,148,40,2,2)
3,34^25
"KRN",.404,148,40,2,30)
S Y={.01:3}
"KRN",.404,149,0)
LREPI1^69.5^
"KRN",.404,149,40,0)
^.4044I^5^5
"KRN",.404,149,40,1,0)
1^Laboratory Test(s)^1
"KRN",.404,149,40,1,2)
^^1,1
"KRN",.404,149,40,2,0)
2^Indicator^1
"KRN",.404,149,40,2,2)
^^1,34
"KRN",.404,149,40,3,0)
3^Value^1
"KRN",.404,149,40,3,2)
^^1,60
"KRN",.404,149,40,4,0)
4^ICDM-9^1
"KRN",.404,149,40,4,2)
^^7,2
"KRN",.404,149,40,5,0)
5^ICDM-9 Description^1
"KRN",.404,149,40,5,2)
^^7,34
"KRN",.404,150,0)
LREPI4^69.53
"KRN",.404,150,40,0)
^.4044I^1^1
"KRN",.404,150,40,1,0)
1^^3
"KRN",.404,150,40,1,1)
.01
"KRN",.404,150,40,1,2)
1,1^35
"KRN",.404,151,0)
LREPI95^69.55
"KRN",.404,151,40,0)
^.4044I^3^3
"KRN",.404,151,40,1,0)
1^^3
"KRN",.404,151,40,1,1)
.01
"KRN",.404,151,40,1,2)
2,1^30
"KRN",.404,151,40,1,7)
^6
"KRN",.404,151,40,2,0)
2^^4
"KRN",.404,151,40,2,2)
2,49^30
"KRN",.404,151,40,2,30)
S Y={.01:64}
"KRN",.404,151,40,3,0)
3^^4
"KRN",.404,151,40,3,2)
2,34^12
"KRN",.404,151,40,3,30)
S Y={.01:64:1}
"KRN",.404,152,0)
LREPI6^69.5^
"KRN",.404,152,40,0)
^.4044I^5^5
"KRN",.404,152,40,1,0)
1^Selected Etiology^1
"KRN",.404,152,40,1,2)
^^1,1
"KRN",.404,152,40,2,0)
2^Antimicrobial Susceptibility^1
"KRN",.404,152,40,2,2)
^^7,1
"KRN",.404,152,40,3,0)
3^NLT Code^1
"KRN",.404,152,40,3,2)
^^7,34
"KRN",.404,152,40,4,0)
4^NLT Description^1
"KRN",.404,152,40,4,2)
^^7,49
"KRN",.404,152,40,5,0)
5^Selected Snomed Codes^1
"KRN",.404,152,40,5,2)
^^1,45
"KRN",.404,153,0)
LREPI7^69.55^
"KRN",.404,153,40,0)
^.4044I^3^3
"KRN",.404,153,40,1,0)
1^Topography Selection^1
"KRN",.404,153,40,1,2)
^^1,27
"KRN",.404,153,40,2,0)
2^Include^1
"KRN",.404,153,40,2,2)
^^3,1
"KRN",.404,153,40,3,0)
3^Exclude^1
"KRN",.404,153,40,3,2)
^^3,40
"KRN",.404,154,0)
LREPI8^69.56
"KRN",.404,154,40,0)
^.4044I^1^1
"KRN",.404,154,40,1,0)
1^^3
"KRN",.404,154,40,1,1)
.01
"KRN",.404,154,40,1,2)
1,1^30
"KRN",.404,155,0)
LREPI9^69.57
"KRN",.404,155,40,0)
^.4044I^1^1
"KRN",.404,155,40,1,0)
1^^3
"KRN",.404,155,40,1,1)
.01
"KRN",.404,155,40,1,2)
1,1^30
"KRN",.404,156,0)
LREPI10^69.5
"KRN",.404,156,40,0)
^.4044I^10^7
"KRN",.404,156,40,3,0)
1^Run Date^3
"KRN",.404,156,40,3,1)
9
"KRN",.404,156,40,3,2)
2,11^20^2,1
"KRN",.404,156,40,4,0)
2^Protocol^3
"KRN",.404,156,40,4,1)
12
"KRN",.404,156,40,4,2)
2,48^25^2,38
"KRN",.404,156,40,5,0)
3^Run Cycle^3
"KRN",.404,156,40,5,1)
10
"KRN",.404,156,40,5,2)
4,12^7^4,1
"KRN",.404,156,40,7,0)
7^Previous Cycle^3
"KRN",.404,156,40,7,1)
19
"KRN",.404,156,40,7,2)
6,16^13^6,1
"KRN",.404,156,40,8,0)
4^Lag Days^3
"KRN",.404,156,40,8,1)
10.5
"KRN",.404,156,40,8,2)
4,48^2^4,38
"KRN",.404,156,40,9,0)
8^General Description^3
"KRN",.404,156,40,9,1)
15
"KRN",.404,156,40,9,2)
8,22^1^8,1
"KRN",.404,156,40,10,0)
5^Previous Cycle^3
"KRN",.404,156,40,10,1)
19
"KRN",.404,156,40,10,2)
6,16^13^6,1
"KRN",.404,157,0)
LREPI11^69.5
"KRN",.404,157,40,0)
^.4044I^^0
"KRN",.404,209,0)
LREPI12^69.58
"KRN",.404,209,40,0)
^.4044I^1^1
"KRN",.404,209,40,1,0)
1^^3
"KRN",.404,209,40,1,1)
.01
"KRN",.404,209,40,1,2)
1,2^15
"KRN",.404,213,0)
LREPI13^69.5
"KRN",.404,213,40,0)
^.4044I^5^5
"KRN",.404,213,40,1,0)
1^FIRST ENCOUNTER^3
"KRN",.404,213,40,1,1)
11
"KRN",.404,213,40,1,2)
1,18^3^1,1
"KRN",.404,213,40,2,0)
2^FOLLOW PTF^3
"KRN",.404,213,40,2,1)
13
"KRN",.404,213,40,2,2)
1,55^3^1,43
"KRN",.404,213,40,3,0)
3^BEFORE DATE OF BIRTH^3
"KRN",.404,213,40,3,1)
17
"KRN",.404,213,40,3,2)
3,23^11^3,1
"KRN",.404,213,40,4,0)
4^AFTER DATE OF BIRTH^3
"KRN",.404,213,40,4,1)
18
"KRN",.404,213,40,4,2)
3,64^11^3,43
"KRN",.404,213,40,5,0)
5^Select SEX^3
"KRN",.404,213,40,5,1)
16
"KRN",.404,213,40,5,2)
5,13^1^5,1
"KRN",.404,364,0)
LREPI9HEAD^69.5^
"KRN",.404,364,40,0)
^.4044I^6^6
"KRN",.404,364,40,1,0)
1^LABORATORY SEARCH/EXTRACT PARAMETERS INPUT SCREEN^1
"KRN",.404,364,40,1,2)
^^2,15
"KRN",.404,364,40,2,0)
2^NAME^3
"KRN",.404,364,40,2,1)
.01
"KRN",.404,364,40,2,2)
4,7^50^4,1
"KRN",.404,364,40,3,0)
3^INACTIVE: ^3
"KRN",.404,364,40,3,1)
1
"KRN",.404,364,40,3,2)
4,70^3^4,60^1
"KRN",.404,364,40,4,0)
4^________________________________________^1
"KRN",.404,364,40,4,2)
^^5,1
"KRN",.404,364,40,5,0)
5^________________________________________^1
"KRN",.404,364,40,5,2)
^^5,41
"KRN",.404,364,40,6,0)
6^!M^1
"KRN",.404,364,40,6,.1)
S Y="Page "_DDSPG_" of 5"
"KRN",.404,364,40,6,2)
^^2,67
"KRN",.404,365,0)
LREPI92^69.52
"KRN",.404,365,40,0)
^.4044I^3^3
"KRN",.404,365,40,1,0)
1^^3
"KRN",.404,365,40,1,1)
.01
"KRN",.404,365,40,1,2)
4,1^30
"KRN",.404,365,40,2,0)
2^^3
"KRN",.404,365,40,2,1)
1
"KRN",.404,365,40,2,2)
4,35^20
"KRN",.404,365,40,3,0)
3^^3
"KRN",.404,365,40,3,1)
2
"KRN",.404,365,40,3,2)
4,61^15
"KRN",.404,366,0)
LREPI93^69.54
"KRN",.404,366,40,0)
^.4044I^2^2
"KRN",.404,366,40,1,0)
1^^3
"KRN",.404,366,40,1,1)
.01
"KRN",.404,366,40,1,2)
3,2^7
"KRN",.404,366,40,2,0)
2^^4
"KRN",.404,366,40,2,2)
3,34^25
"KRN",.404,366,40,2,30)
S Y={.01:3}
"KRN",.404,367,0)
LREPI91^69.5^
"KRN",.404,367,40,0)
^.4044I^5^5
"KRN",.404,367,40,1,0)
1^Laboratory Test(s)^1
"KRN",.404,367,40,1,2)
^^1,1
"KRN",.404,367,40,2,0)
2^Indicator^1
"KRN",.404,367,40,2,2)
^^1,34
"KRN",.404,367,40,3,0)
3^Value^1
"KRN",.404,367,40,3,2)
^^1,60
"KRN",.404,367,40,4,0)
4^ICDM-9^1
"KRN",.404,367,40,4,2)
^^7,2
"KRN",.404,367,40,5,0)
5^ICDM-9 Description^1
"KRN",.404,367,40,5,2)
^^7,34
"KRN",.404,368,0)
LREPI94^69.53
"KRN",.404,368,40,0)
^.4044I^1^1
"KRN",.404,368,40,1,0)
1^^3
"KRN",.404,368,40,1,1)
.01
"KRN",.404,368,40,1,2)
1,1^35
"KRN",.404,369,0)
LREPI5^69.55
"KRN",.404,369,40,0)
^.4044I^3^3
"KRN",.404,369,40,1,0)
1^^3
"KRN",.404,369,40,1,1)
.01
"KRN",.404,369,40,1,2)
2,1^30
"KRN",.404,369,40,2,0)
2^^4
"KRN",.404,369,40,2,2)
2,49^30
"KRN",.404,369,40,2,30)
S Y={.01:64}
"KRN",.404,369,40,3,0)
3^^4
"KRN",.404,369,40,3,2)
2,34^12
"KRN",.404,369,40,3,30)
S Y={.01:64:1}
"KRN",.404,370,0)
LREPI96^69.5^
"KRN",.404,370,40,0)
^.4044I^5^5
"KRN",.404,370,40,1,0)
1^Selected Etiology^1
"KRN",.404,370,40,1,2)
^^1,1
"KRN",.404,370,40,2,0)
2^Antimicrobial Susceptibility^1
"KRN",.404,370,40,2,2)
^^7,1
"KRN",.404,370,40,3,0)
3^NLT Code^1
"KRN",.404,370,40,3,2)
^^7,34
"KRN",.404,370,40,4,0)
4^NLT Description^1
"KRN",.404,370,40,4,2)
^^7,49
"KRN",.404,370,40,5,0)
5^Selected Snomed Codes^1
"KRN",.404,370,40,5,2)
^^1,45
"KRN",.404,371,0)
LREPI97^69.5^
"KRN",.404,371,40,0)
^.4044I^3^3
"KRN",.404,371,40,1,0)
1^Topography Selection^1
"KRN",.404,371,40,1,2)
^^1,27
"KRN",.404,371,40,2,0)
2^Include^1
"KRN",.404,371,40,2,2)
^^3,1
"KRN",.404,371,40,3,0)
3^Exclude^1
"KRN",.404,371,40,3,2)
^^3,40
"KRN",.404,372,0)
LREPI98^69.56
"KRN",.404,372,40,0)
^.4044I^1^1
"KRN",.404,372,40,1,0)
1^^3
"KRN",.404,372,40,1,1)
.01
"KRN",.404,372,40,1,2)
1,1^30
"KRN",.404,373,0)
LREPI99^69.57
"KRN",.404,373,40,0)
^.4044I^1^1
"KRN",.404,373,40,1,0)
1^^3
"KRN",.404,373,40,1,1)
.01
"KRN",.404,373,40,1,2)
1,1^30
"KRN",.404,374,0)
LREPI910^69.5
"KRN",.404,374,40,0)
^.4044I^9^6
"KRN",.404,374,40,3,0)
1^Run Date^3
"KRN",.404,374,40,3,1)
9
"KRN",.404,374,40,3,2)
2,11^20^2,1
"KRN",.404,374,40,4,0)
2^Protocol^3
"KRN",.404,374,40,4,1)
12
"KRN",.404,374,40,4,2)
2,48^25^2,38
"KRN",.404,374,40,5,0)
3^Run Cycle^3
"KRN",.404,374,40,5,1)
10
"KRN",.404,374,40,5,2)
4,12^7^4,1
"KRN",.404,374,40,7,0)
7^General Description^3
"KRN",.404,374,40,7,1)
15
"KRN",.404,374,40,7,2)
8,22^1^8,1
"KRN",.404,374,40,8,0)
4^Lag Days^3
"KRN",.404,374,40,8,1)
10.5
"KRN",.404,374,40,8,2)
4,48^2^4,38
"KRN",.404,374,40,9,0)
8^Previous Cycle^3
"KRN",.404,374,40,9,1)
19
"KRN",.404,374,40,9,2)
6,16^13^6,1
"KRN",.404,375,0)
LREPI911^69.5
"KRN",.404,375,40,0)
^.4044I^^0
"KRN",.404,376,0)
LREPI912^69.58
"KRN",.404,376,40,0)
^.4044I^1^1
"KRN",.404,376,40,1,0)
1^^3
"KRN",.404,376,40,1,1)
.01
"KRN",.404,376,40,1,2)
1,2^15
"KRN",.404,377,0)
LREPI913^69.5
"KRN",.404,377,40,0)
^.4044I^5^5
"KRN",.404,377,40,1,0)
1^FIRST ENCOUNTER^3
"KRN",.404,377,40,1,1)
11
"KRN",.404,377,40,1,2)
1,18^3^1,1
"KRN",.404,377,40,2,0)
2^FOLLOW PTF^3
"KRN",.404,377,40,2,1)
13
"KRN",.404,377,40,2,2)
1,55^3^1,43
"KRN",.404,377,40,3,0)
3^BEFORE DATE OF BIRTH^3
"KRN",.404,377,40,3,1)
17
"KRN",.404,377,40,3,2)
3,23^11^3,1
"KRN",.404,377,40,4,0)
4^AFTER DATE OF BIRTH^3
"KRN",.404,377,40,4,1)
18
"KRN",.404,377,40,4,2)
3,64^11^3,43
"KRN",.404,377,40,5,0)
5^Select SEX^3
"KRN",.404,377,40,5,1)
16
"KRN",.404,377,40,5,2)
5,13^1^5,1
"KRN",.404,385,0)
LREPI15^69.55
"KRN",.404,385,40,0)
^.4044I^4^4
"KRN",.404,385,40,1,0)
1^Indicator^1
"KRN",.404,385,40,1,2)
^^3,1
"KRN",.404,385,40,2,0)
2^Indicated Value^1
"KRN",.404,385,40,2,2)
^^3,23
"KRN",.404,385,40,3,0)
3^^3
"KRN",.404,385,40,3,1)
1
"KRN",.404,385,40,3,2)
6,2^12
"KRN",.404,385,40,4,0)
4^^3
"KRN",.404,385,40,4,1)
2
"KRN",.404,385,40,4,2)
6,24^30
"KRN",19,10022,-1)
0^6
"KRN",19,10022,0)
LREPILK^Antimicrobial Link Update^^R^^^^^^^^LAB SERVICE
"KRN",19,10022,1,0)
^^2^2^2970219^^^^
"KRN",19,10022,1,1,0)
This option will allows the user to link the ANTIMICROBIAL SUSCEPIBILTY' 
"KRN",19,10022,1,2,0)
file (#62.06) with WKLD CODE file (#64).
"KRN",19,10022,25)
EN^LREPILK
"KRN",19,10022,"U")
ANTIMICROBIAL LINK UPDATE
"KRN",19,10023,-1)
0^10
"KRN",19,10023,0)
LREPI NIGHTLY TASK^Lab EPI Nightly Task^^R^^^^^^^^LAB SERVICE
"KRN",19,10023,1,0)
3^19.06^3^3^3030910^^
"KRN",19,10023,1,1,0)
The Lab Search/Extract Nightly Task option must be scheduled to run each 
"KRN",19,10023,1,2,0)
night by TaskMan. This option will build a HL7 Message and send it the 
"KRN",19,10023,1,3,0)
defined location specified in the EPI Protocols.
"KRN",19,10023,25)
AUTO^LREPIRM
"KRN",19,10023,200.9)
y
"KRN",19,10023,"U")
LAB EPI NIGHTLY TASK
"KRN",19,10722,-1)
0^11
"KRN",19,10722,0)
LREPI PARAMETER SETUP^Lab EPI Parameter Setup^^C^^^^^^^^LAB SERVICE
"KRN",19,10722,1,0)
^19.06^3^3^3040323^^^^
"KRN",19,10722,1,1,0)
This option is used to define the search criteria along with additional 
"KRN",19,10722,1,2,0)
information associated with the EPI extracts.  This option only allows 
"KRN",19,10722,1,3,0)
editing.  You are not allowed to add local pathogens with this option.
"KRN",19,10722,30)
LAB(69.5,
"KRN",19,10722,31)
AEMQ
"KRN",19,10722,40)
[LREPI9]
"KRN",19,10722,41)
69.5
"KRN",19,10722,"U")
LAB EPI PARAMETER SETUP
"KRN",19,10723,-1)
0^18
"KRN",19,10723,0)
LREPI SEARCH EXTRACT MENU^Lab EPI Primary Menu^^M^^^^^^^^LAB SERVICE^^^^^1
"KRN",19,10723,1,0)
^19.06^2^2^3031217^^^^
"KRN",19,10723,1,1,0)
       This is the primary menu that contains the Lab Emerging Pathogens (EPI)
"KRN",19,10723,1,2,0)
options.
"KRN",19,10723,10,0)
^19.01IP^8^7
"KRN",19,10723,10,1,0)
10722^UP^5
"KRN",19,10723,10,1,"^")
LREPI PARAMETER SETUP
"KRN",19,10723,10,3,0)
10022^LK^7
"KRN",19,10723,10,3,"^")
LREPILK
"KRN",19,10723,10,4,0)
10724^ENH^1
"KRN",19,10723,10,4,"^")
LREPI ENHANCE MANUAL RUN
"KRN",19,10723,10,5,0)
10725^^6
"KRN",19,10723,10,5,"^")
LREPI PROTOCOL EDIT
"KRN",19,10723,10,6,0)
12892^LO^3
"KRN",19,10723,10,6,"^")
LREPI LOCAL PATHOGEN MENU
"KRN",19,10723,10,7,0)
12890^VR^2
"KRN",19,10723,10,7,"^")
LREPI VERIFICATION REPORT
"KRN",19,10723,10,8,0)
12893^PI^4
"KRN",19,10723,10,8,"^")
LREPI PATHOGEN INQUIRY
"KRN",19,10723,26)
W @IOF,?(IOM-20/2),"Lab EPI Primary Menu"
"KRN",19,10723,99)
59520,66532
"KRN",19,10723,99.1)
56938,7231
"KRN",19,10723,"U")
LAB EPI PRIMARY MENU
"KRN",19,10724,-1)
0^5
"KRN",19,10724,0)
LREPI ENHANCE MANUAL RUN^Lab EPI Manual Run (Enhanced)^^R^^^^^^^^LAB SERVICE
"KRN",19,10724,1,0)
^19.06^8^8^3040122^^^^
"KRN",19,10724,1,1,0)
This option is used ONLY to manually extract national EPI data and transmit to
"KRN",19,10724,1,2,0)
the Austin Automation Center (AAC). When this option is run, an EPI Summary
"KRN",19,10724,1,3,0)
Verification Report is generated and automatically sent to the EPI-Report mail
"KRN",19,10724,1,4,0)
group. Also, a Detailed Verification Report is generated and can be printed
"KRN",19,10724,1,5,0)
using the new Print Detailed Verification Report [LREPI VERIFICATION REPORT]
"KRN",19,10724,1,6,0)
option. This option has been RENAMED from Lab Search/Extract Manual Run
"KRN",19,10724,1,7,0)
(Enhanced) [LREPI SEARCH/EXTRACT ENHANCED MANUAL RUN] to EPI Manual Run
"KRN",19,10724,1,8,0)
(Enhanced) [LREPI ENHANCE MANUAL RUN] option.
"KRN",19,10724,25)
LREPIRM
"KRN",19,10724,99.1)
59114,51724
"KRN",19,10724,"U")
LAB EPI MANUAL RUN (ENHANCED)
"KRN",19,10725,-1)
0^7
"KRN",19,10725,0)
LREPI PROTOCOL EDIT^Lab EPI Protocol Edit^^C^^^^^^^^LAB SERVICE
"KRN",19,10725,1,0)
^^1^1^2990706^^^^
"KRN",19,10725,1,1,0)
Use this option to edit the LAB SEARCH/EXTRACT PROTOCOL file.
"KRN",19,10725,30)
LAB(69.4,
"KRN",19,10725,31)
AEQM
"KRN",19,10725,40)
[LREPIPROT]
"KRN",19,10725,41)
69.4
"KRN",19,10725,"U")
LAB EPI PROTOCOL EDIT
"KRN",19,11847,-1)
0^13
"KRN",19,11847,0)
LREPISERVER^LREPI Data Server^^S^^^^^^^^
"KRN",19,11847,25)
LREPISRV
"KRN",19,11847,220)
^R^^^^E
"KRN",19,11847,"U")
LREPI DATA SERVER
"KRN",19,12838,-1)
0^16
"KRN",19,12838,0)
LREPIDATASERVER^LREPI TRANSMIT DATA SERVER^^S^^^^^^^^LAB SERVICE
"KRN",19,12838,1,0)
^19.06^6^6^3030403^^
"KRN",19,12838,1,1,0)
This server allows the EPI program office to trigger retransmission 
"KRN",19,12838,1,2,0)
of monthly data or trigger extraction for a single day from sites.
"KRN",19,12838,1,3,0)
A mail group containing all sites allows a single message to trigger
"KRN",19,12838,1,4,0)
the server at all sites in the mail group.  A message will be sent to the
"KRN",19,12838,1,5,0)
mail group each time the server is triggered containing the name of the
"KRN",19,12838,1,6,0)
person who triggered the server, their location, and the action initiated.
"KRN",19,12838,25)
LREPISV1
"KRN",19,12838,220)
^R^^^^E
"KRN",19,12838,"U")
LREPI TRANSMIT DATA SERVER
"KRN",19,12844,-1)
0^14
"KRN",19,12844,0)
LREPI GENERATE REPORT/SP^Lab EPI Generate Local Report/Spreadsheet^^R^^^^^^^^LAB SERVICE
"KRN",19,12844,1,0)
^19.06^7^7^3040128^^^^
"KRN",19,12844,1,1,0)
The job is automatically tasked after selecting the national EPI or local
"KRN",19,12844,1,2,0)
pathogens, time period, segments/fields, report or spreadsheet type, and will
"KRN",19,12844,1,3,0)
take approximately 2-3 hours to generate.  When the report or spreadsheet has
"KRN",19,12844,1,4,0)
finished generating an alert is automatically sent to the user generating the
"KRN",19,12844,1,5,0)
report or spreadsheet.   The report or spreadsheet can then be viewed on the
"KRN",19,12844,1,6,0)
screen or printed using the new Lab EPI Print Local Report/Spreadsheet option.
"KRN",19,12844,1,7,0)
Note: NO data is transmitted to Austin when using this option 
"KRN",19,12844,10.1)

"KRN",19,12844,25)
LREPIRS
"KRN",19,12844,"U")
LAB EPI GENERATE LOCAL REPORT/
"KRN",19,12887,-1)
0^4
"KRN",19,12887,0)
LREPI ENTER/EDIT LOCAL PATH^Enter/Edit Local Pathogens^^R^^^^^^^^LAB SERVICE
"KRN",19,12887,1,0)
^19.06^3^3^3040122^^^^
"KRN",19,12887,1,1,0)
This option allows you to enter or edit local pathogens into the LAB SEARCH/EXTRACT
"KRN",19,12887,1,2,0)
FILE (#69.5)  These pathogens can be selected for the report/spreadsheet option.
"KRN",19,12887,1,3,0)
Local pathogens WILL NOT be transmitted to Austin.
"KRN",19,12887,25)
LREPIPI
"KRN",19,12887,30)

"KRN",19,12887,31)

"KRN",19,12887,40)

"KRN",19,12887,41)

"KRN",19,12887,"U")
ENTER/EDIT LOCAL PATHOGENS
"KRN",19,12888,-1)
0^21
"KRN",19,12888,0)
LREPI DELETE LOCAL PATHOGEN^Delete Local Pathogen^^R^^^^^^^^LAB SERVICE
"KRN",19,12888,1,0)
^19.06^2^2^3040122^^^^
"KRN",19,12888,1,1,0)
This option allows deletion of local pathogens ONLY. National emerging
"KRN",19,12888,1,2,0)
pathogens CAN NOT be deleted.
"KRN",19,12888,25)
DELETE^LREPIPI
"KRN",19,12888,"U")
DELETE LOCAL PATHOGEN
"KRN",19,12889,-1)
0^15
"KRN",19,12889,0)
LREPI PRINT REPORT/SPSHT^Lab EPI Print Local Report/Spreadsheet^^R^^^^^^^^LAB SERVICE
"KRN",19,12889,1,0)
^19.06^2^2^3040122^^
"KRN",19,12889,1,1,0)
This option allows you to print a report or spreadsheet that was generated
"KRN",19,12889,1,2,0)
with the Lab EPI Generate Local Report/Spreadsheet.
"KRN",19,12889,25)
LREPIRS2
"KRN",19,12889,"U")
LAB EPI PRINT LOCAL REPORT/SPR
"KRN",19,12890,-1)
0^17
"KRN",19,12890,0)
LREPI VERIFICATION REPORT^Print Detailed Verification Report^^R^^^^^^^^LAB SERVICE
"KRN",19,12890,1,0)
^19.06^4^4^3040129^^^^
"KRN",19,12890,1,1,0)
This option prints the Detailed Verification Report.  This report is
"KRN",19,12890,1,2,0)
automatically generated when your site does an automated or manual run
"KRN",19,12890,1,3,0)
and data is sent to Austin Automation Center.  Six months of previous
"KRN",19,12890,1,4,0)
reports are kept as well as the current month for printing.
"KRN",19,12890,25)
LREPIRP7
"KRN",19,12890,"U")
PRINT DETAILED VERIFICATION RE
"KRN",19,12892,-1)
0^19
"KRN",19,12892,0)
LREPI LOCAL PATHOGEN MENU^Local Pathogen Menu^^M^^^^^^^^LAB SERVICE
"KRN",19,12892,1,0)
^19.06^3^3^3040407^^^^
"KRN",19,12892,1,1,0)
This menu contains options to enter/edit and delete local pathogens.  Also,
"KRN",19,12892,1,2,0)
it contains options to generate and print the local report/spreadsheet.
"KRN",19,12892,1,3,0)
This menu also contains an option to delete a local report or spreadsheet.
"KRN",19,12892,10,0)
^19.01IP^5^5
"KRN",19,12892,10,1,0)
12887^ENT^1
"KRN",19,12892,10,1,"^")
LREPI ENTER/EDIT LOCAL PATH
"KRN",19,12892,10,2,0)
12888^DEL^4
"KRN",19,12892,10,2,"^")
LREPI DELETE LOCAL PATHOGEN
"KRN",19,12892,10,3,0)
12844^GEN^2
"KRN",19,12892,10,3,"^")
LREPI GENERATE REPORT/SP
"KRN",19,12892,10,4,0)
12889^PRT^3
"KRN",19,12892,10,4,"^")
LREPI PRINT REPORT/SPSHT
"KRN",19,12892,10,5,0)
12927^DRS^5
"KRN",19,12892,10,5,"^")
LREPI DELETE LOCAL REPORT
"KRN",19,12892,99)
59632,56888
"KRN",19,12892,"U")
LOCAL PATHOGEN MENU
"KRN",19,12893,-1)
0^20
"KRN",19,12893,0)
LREPI PATHOGEN INQUIRY^Pathogen Inquiry^^R^^^^^^^^LAB SERVICE
"KRN",19,12893,1,0)
^19.06^4^4^3040122^^^
"KRN",19,12893,1,1,0)
This new option is used to inquire into the LAB SEARCH/EXTRACT file (#69.5)
"KRN",19,12893,1,2,0)
parameter description fields (i.e., INACTIVE: NO, LAG DAYS: 15, RUN DATE: OCT 
"KRN",19,12893,1,3,0)
07, 2003, CYCLE: MONTHLY, PROTOCOL: LREPI, FOLLOW PTF: YES, REFERENCE NUMBER:
"KRN",19,12893,1,4,0)
23, and ETIOLOGIES) for defined pathogen.
"KRN",19,12893,25)
INQUIRY^LREPIPI
"KRN",19,12893,"U")
PATHOGEN INQUIRY
"KRN",19,12927,-1)
0^22
"KRN",19,12927,0)
LREPI DELETE LOCAL REPORT^Delete Local Report or Spreadsheet^^R^^^^^^^^LAB SERVICE
"KRN",19,12927,1,0)
^^1^1^3040407^
"KRN",19,12927,1,1,0)
This option allows you to delete local reports or local spreadsheets.
"KRN",19,12927,25)
DELETE^LREPIRS2
"KRN",19,12927,"U")
DELETE LOCAL REPORT OR SPREADS
"KRN",19,13213,-1)
1^12
"KRN",19,13213,0)
LREPI PRIMARY MENU
"KRN",101,1697,-1)
0^1
"KRN",101,1697,0)
LREPI CLIENT^EPI^^S^^^^^^^^LAB SERVICE
"KRN",101,1697,1,0)
^101.06^2^2^3040414^^^^
"KRN",101,1697,1,1,0)
This subscriber protocol defines the parameter needed by the HL7 package to 
"KRN",101,1697,1,2,0)
determine were to send the HL7 formatted message containing the EPI information.
"KRN",101,1697,99)
57125,58512
"KRN",101,1697,770)
^EPI-LAB^ORU^R01^i^P^EPI-LAB^^^2.2^ORU
"KRN",101,1697,771)

"KRN",101,1697,772)

"KRN",101,1697,773)
^
"KRN",101,4548,-1)
1^2
"KRN",101,4548,0)
LRNCH SEND CLIENT
"KRN",101,4549,-1)
1^3
"KRN",101,4549,0)
LRNCHAAC
"MBREQ")
0
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PGL",69.5,0,7,12)
PROTOCOL^P69.4I^LAB(69.4,^0;7^Q
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950528
"PKG",26,22,1,"PAH",1,0)
281^3040609
"PKG",26,22,1,"PAH",1,1,0)
^^353^353^3040609
"PKG",26,22,1,"PAH",1,1,1,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*281 does not 
"PKG",26,22,1,"PAH",1,1,2,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA  
"PKG",26,22,1,"PAH",1,1,3,0)
DIRECTIVE 99-053 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"PKG",26,22,1,"PAH",1,1,4,0)
 
"PKG",26,22,1,"PAH",1,1,5,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*281 does not 
"PKG",26,22,1,"PAH",1,1,6,0)
alter or modify any software design safeguards or safety critical
"PKG",26,22,1,"PAH",1,1,7,0)
elements functions.
"PKG",26,22,1,"PAH",1,1,8,0)
 
"PKG",26,22,1,"PAH",1,1,9,0)
RISK ANALYSIS: Changes made by patch LR*5.2*281 have no effect on Blood 
"PKG",26,22,1,"PAH",1,1,10,0)
Bank software functionality, therefore RISK is none. 
"PKG",26,22,1,"PAH",1,1,11,0)
 
"PKG",26,22,1,"PAH",1,1,12,0)
VALIDATION REQUIREMENTS BY OPTION:  Because of the nature of the changes made,
"PKG",26,22,1,"PAH",1,1,13,0)
no specific validation requirements exist as a result of installation of this
"PKG",26,22,1,"PAH",1,1,14,0)
patch.
"PKG",26,22,1,"PAH",1,1,15,0)
***********************************************************************
"PKG",26,22,1,"PAH",1,1,16,0)
Due to extensive historical data transmission requirements and mandated setups
"PKG",26,22,1,"PAH",1,1,17,0)
required for such, a phased installation and implementation of this patch will
"PKG",26,22,1,"PAH",1,1,18,0)
be utilized for release of this patch.  The software download information will
"PKG",26,22,1,"PAH",1,1,19,0)
be made available to sites attending one of the following national
"PKG",26,22,1,"PAH",1,1,20,0)
audioconference calls:
"PKG",26,22,1,"PAH",1,1,21,0)
 
"PKG",26,22,1,"PAH",1,1,22,0)
Tuesday, June 8 at 1:00 - 3:00 PM EST for VISNs 1-2-3-4-5-6 
"PKG",26,22,1,"PAH",1,1,23,0)
Thursday, June 10 at 3:00 - 5:00 PM EST for VISNs 7-8-9-10-11 
"PKG",26,22,1,"PAH",1,1,24,0)
Tuesday, June 15 at 4:00 - 6:00 PM EST for VISNs 12-15-16-17-23 
"PKG",26,22,1,"PAH",1,1,25,0)
Wednesday, June 16 at 2:00 - 4:00 PM EST for VISNs 18-19-20-21-22 
"PKG",26,22,1,"PAH",1,1,26,0)
Thursday, June 17 at 2:00 - 4:00 PM EST for those unable to attend the other
"PKG",26,22,1,"PAH",1,1,27,0)
calls. 
"PKG",26,22,1,"PAH",1,1,28,0)

"PKG",26,22,1,"PAH",1,1,29,0)
The VANTS telephone number is 1 800 767-1750 and the access code for all calls
"PKG",26,22,1,"PAH",1,1,30,0)
is 13143.
"PKG",26,22,1,"PAH",1,1,31,0)

"PKG",26,22,1,"PAH",1,1,32,0)
This patch will involve reseeding of the EPI databases for each site to allow
"PKG",26,22,1,"PAH",1,1,33,0)
the new data created by this patch to be captured.  It is imperative each site 
"PKG",26,22,1,"PAH",1,1,34,0)
attend an audioconference prior to installation and implementation of
"PKG",26,22,1,"PAH",1,1,35,0)
LR*5.2*281.
"PKG",26,22,1,"PAH",1,1,36,0)

"PKG",26,22,1,"PAH",1,1,37,0)
INSTRUCTIONS FOR SEEDING THE HISTORICAL DATA:
"PKG",26,22,1,"PAH",1,1,38,0)
 
"PKG",26,22,1,"PAH",1,1,39,0)
Historical data must be gathered from October 1, 2000 through June 14, 2004. 
"PKG",26,22,1,"PAH",1,1,40,0)
Use the Lab EPI Manual Run (Enhanced) [LREPI ENHANCE MANUAL RUN] option to run/
"PKG",26,22,1,"PAH",1,1,41,0)
gather and transmit 6 manual runs (consecutive runs) at a time.
"PKG",26,22,1,"PAH",1,1,42,0)
 
"PKG",26,22,1,"PAH",1,1,43,0)
** Sites DO NOT transmit on June 16 or July 4 to avoid Austin Automation Center
"PKG",26,22,1,"PAH",1,1,44,0)
 (AAC) capacity limitations. **
"PKG",26,22,1,"PAH",1,1,45,0)
 
"PKG",26,22,1,"PAH",1,1,46,0)
Batch #1: October 1, 2000 -March 31, 2001
"PKG",26,22,1,"PAH",1,1,47,0)
Batch #2: April 1, 2001 - September 30, 2001
"PKG",26,22,1,"PAH",1,1,48,0)
Batch #3: October 1, 2001 - March 31, 2002
"PKG",26,22,1,"PAH",1,1,49,0)
Batch #4: April 1, 2002 - September 30, 2002
"PKG",26,22,1,"PAH",1,1,50,0)
Batch #5: October 1, 2002 - March 31, 2003
"PKG",26,22,1,"PAH",1,1,51,0)
Batch #6: April 1, 2003 - September 30, 2003
"PKG",26,22,1,"PAH",1,1,52,0)
Batch #7: October 1, 2003 - March 31, 2004
"PKG",26,22,1,"PAH",1,1,53,0)
Batch #8: April 1, 2004 - June 14, 2004 
"PKG",26,22,1,"PAH",1,1,54,0)
 
"PKG",26,22,1,"PAH",1,1,55,0)
Sites will run 8 batches of reports. Each batch should contain 6 separate
"PKG",26,22,1,"PAH",1,1,56,0)
monthly extracts which are tasked separately by month, i.e., OCT 2000, NOV
"PKG",26,22,1,"PAH",1,1,57,0)
2000, DEC 2000, JAN 2001, FEB 2001, MAR 2001 = 1 batch and will generate six
"PKG",26,22,1,"PAH",1,1,58,0)
separate processing reports back to the station and transmit them over a five
"PKG",26,22,1,"PAH",1,1,59,0)
week period June 10, 2004 - July 12, 2004.
"PKG",26,22,1,"PAH",1,1,60,0)
You do not have to wait for one monthly extract to run before starting the next
"PKG",26,22,1,"PAH",1,1,61,0)
in a batch.
"PKG",26,22,1,"PAH",1,1,62,0)
You do not have to wait for one batch to complete running before queuing the
"PKG",26,22,1,"PAH",1,1,63,0)
next batch.
"PKG",26,22,1,"PAH",1,1,64,0)
If you receive any fatal errors and the monthly extract is rejected, you will
"PKG",26,22,1,"PAH",1,1,65,0)
need to fix the error and retransmit that month. 
"PKG",26,22,1,"PAH",1,1,66,0)
 
"PKG",26,22,1,"PAH",1,1,67,0)
Sites may transmit reports to AAC on evenings and weekends following this
"PKG",26,22,1,"PAH",1,1,68,0)
schedule:
"PKG",26,22,1,"PAH",1,1,69,0)
1. VISNs with odd numbers are asked to transmit batches on Tuesday & Thursday
"PKG",26,22,1,"PAH",1,1,70,0)
 during the PM hours and Saturdays.
"PKG",26,22,1,"PAH",1,1,71,0)
2. VISNs with even numbers are asked to transmit on Monday & Friday during the
"PKG",26,22,1,"PAH",1,1,72,0)
 PM hours and Sundays.
"PKG",26,22,1,"PAH",1,1,73,0)
 
"PKG",26,22,1,"PAH",1,1,74,0)
**  NO Sites may transmit on June 16 or July 4 due to AAC limitations. **
"PKG",26,22,1,"PAH",1,1,75,0)

"PKG",26,22,1,"PAH",1,1,76,0)

"PKG",26,22,1,"PAH",1,1,77,0)
The EPI Enhancement patch, LR*5.2*281, contains enhancements and 
"PKG",26,22,1,"PAH",1,1,78,0)
modifications to the Emerging Pathogens Initiative (EPI) software.
"PKG",26,22,1,"PAH",1,1,79,0)
The enhancements and modifications included in this patch are:
"PKG",26,22,1,"PAH",1,1,80,0)

"PKG",26,22,1,"PAH",1,1,81,0)
1) New EPI Summary Verification Report of EPI Extracted Data from Site:
"PKG",26,22,1,"PAH",1,1,82,0)
   The new Verification Summary Report of EPI Extracted Data from Site   
"PKG",26,22,1,"PAH",1,1,83,0)
   replaces the existing Emerging Pathogens Verification Report.  This 
"PKG",26,22,1,"PAH",1,1,84,0)
   new summary report consists of the following functionality:
"PKG",26,22,1,"PAH",1,1,85,0)
        1) Summary report automatically generated at the sites and sent    
"PKG",26,22,1,"PAH",1,1,86,0)
           to the EPI-REPORT mail group on the 15th day of each month
"PKG",26,22,1,"PAH",1,1,87,0)
        2) Summary pages are displayed in a human readable format used 
"PKG",26,22,1,"PAH",1,1,88,0)
           for quick viewing
"PKG",26,22,1,"PAH",1,1,89,0)
        3) Displays reporting site name and station number
"PKG",26,22,1,"PAH",1,1,90,0)
        4) Summary report is only 1-2 pages long
"PKG",26,22,1,"PAH",1,1,91,0)
        5) Summary report displays emerging pathogens total number of
"PKG",26,22,1,"PAH",1,1,92,0)
           occurrences during the monthly processing cycle
"PKG",26,22,1,"PAH",1,1,93,0)
        6) Summary report displays emerging pathogens total number of
"PKG",26,22,1,"PAH",1,1,94,0)
           persons with occurrences during the monthly processing cycle
"PKG",26,22,1,"PAH",1,1,95,0)
        7) Displays Resolution of Risk Assessment number of persons 
"PKG",26,22,1,"PAH",1,1,96,0)
           with the nationally rolled-up resolution Hepatitis C that 
"PKG",26,22,1,"PAH",1,1,97,0)
           occurred during monthly processing cycle
"PKG",26,22,1,"PAH",1,1,98,0)

"PKG",26,22,1,"PAH",1,1,99,0)
2) New Detailed Verification Report is a detailed pathogen-specific report for validation purposes.  The Print Detailed Verification Report [LREPI VERIFICATION REPORT] option prints t
"PKG",26,22,1,"PAH",1,1,100,0)
automatically generated when your site does an automated or manual run and data is sent to Austin Automation Center.  Six months of previous reports are kept as well as the current mo
"PKG",26,22,1,"PAH",1,1,101,0)

"PKG",26,22,1,"PAH",1,1,102,0)
3) Sites now have the ability to capture and manipulate EPI data into a 
"PKG",26,22,1,"PAH",1,1,103,0)
report or spreadsheet-delimited format.  A site can also add pathogens for local use and generate reports or capture data in a spreadsheet format for local use.
"PKG",26,22,1,"PAH",1,1,104,0)

"PKG",26,22,1,"PAH",1,1,105,0)
4) Additional data will be sent to Austin.  Including:
"PKG",26,22,1,"PAH",1,1,106,0)
        LOINC codes
"PKG",26,22,1,"PAH",1,1,107,0)
        Master Patient Index
"PKG",26,22,1,"PAH",1,1,108,0)
        County and State for patient demographics
"PKG",26,22,1,"PAH",1,1,109,0)
        MIC values
"PKG",26,22,1,"PAH",1,1,110,0)
        The new Race and Ethnicity fields
"PKG",26,22,1,"PAH",1,1,111,0)

"PKG",26,22,1,"PAH",1,1,112,0)
5) Provide the ability to capture 6 new pathogens:
"PKG",26,22,1,"PAH",1,1,113,0)
        All Staphylococcus aureus (Reference #18)
"PKG",26,22,1,"PAH",1,1,114,0)
        Methicillin-Resistant Staphylococcus aureus (MRSA)
"PKG",26,22,1,"PAH",1,1,115,0)
        (Reference #19)
"PKG",26,22,1,"PAH",1,1,116,0)
        Vancomycin-Resistant Staphylococcus aureus (VRSA)
"PKG",26,22,1,"PAH",1,1,117,0)
         (Reference #20)
"PKG",26,22,1,"PAH",1,1,118,0)
        Vancomycin-Resistant Coagulase Negative Staphylococci/Staph epi   
"PKG",26,22,1,"PAH",1,1,119,0)
        (VRSE)(Reference #21)
"PKG",26,22,1,"PAH",1,1,120,0)
        All Streptococcus pneumoniae (Reference #22)
"PKG",26,22,1,"PAH",1,1,121,0)
        All Enterococci (Reference #23)
"PKG",26,22,1,"PAH",1,1,122,0)

"PKG",26,22,1,"PAH",1,1,123,0)
6) EPI is also enhanced to capture the approved newer Legionella Urinary Antigen test.
"PKG",26,22,1,"PAH",1,1,124,0)

"PKG",26,22,1,"PAH",1,1,125,0)
7) A bug is fixed with the date handling for start and stop date.
"PKG",26,22,1,"PAH",1,1,126,0)

"PKG",26,22,1,"PAH",1,1,127,0)
8) The new field PREVIOUS CYCLE (#19) in the Lab Search/Extract file(#69.5) contains a numeric entry which defines the number of previous cycles to search.  These findings will be rep
"PKG",26,22,1,"PAH",1,1,128,0)
 
"PKG",26,22,1,"PAH",1,1,129,0)
NEW OPTIONS:
"PKG",26,22,1,"PAH",1,1,130,0)
NAME: LREPI DELETE LOCAL PATHOGEN       MENU TEXT: Delete Local Pathogen
"PKG",26,22,1,"PAH",1,1,131,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,132,0)
DESCRIPTION:   This option allows deletion of local pathogens ONLY. 
"PKG",26,22,1,"PAH",1,1,133,0)
National pathogens CAN NOT be deleted.
"PKG",26,22,1,"PAH",1,1,134,0)
  ROUTINE: DELETE^LREPIPI
"PKG",26,22,1,"PAH",1,1,135,0)
 
"PKG",26,22,1,"PAH",1,1,136,0)
NAME: LREPI DELETE LOCAL REPORT
"PKG",26,22,1,"PAH",1,1,137,0)
  MENU TEXT: Delete Local Report or Spreadsheet
"PKG",26,22,1,"PAH",1,1,138,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,139,0)
 DESCRIPTION:   This option allows you to delete local reports or local
"PKG",26,22,1,"PAH",1,1,140,0)
 spreadsheets.  
"PKG",26,22,1,"PAH",1,1,141,0)
  ROUTINE: DELETE^LREPIRS2
"PKG",26,22,1,"PAH",1,1,142,0)
 
"PKG",26,22,1,"PAH",1,1,143,0)
NAME: LREPI ENTER/EDIT LOCAL PATH       MENU TEXT: Enter/Edit Local 
"PKG",26,22,1,"PAH",1,1,144,0)
Pathogens
"PKG",26,22,1,"PAH",1,1,145,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,146,0)
 DESCRIPTION:   This option allows you to enter or edit local pathogens 
"PKG",26,22,1,"PAH",1,1,147,0)
into the LAB SEARCH/EXTRACT FILE (#69.5)  These pathogens can be selected for the report/spreadsheet option.  Local pathogens WILL NOT be transmitted to Austin.
"PKG",26,22,1,"PAH",1,1,148,0)
  ROUTINE: LREPIPI
"PKG",26,22,1,"PAH",1,1,149,0)
 
"PKG",26,22,1,"PAH",1,1,150,0)
NAME: LREPI GENERATE REPORT/SP
"PKG",26,22,1,"PAH",1,1,151,0)
  MENU TEXT: Lab EPI Generate Local Report/Spreadsheet
"PKG",26,22,1,"PAH",1,1,152,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,153,0)
 DESCRIPTION:   This new option is used to generate reports or spreadsheets for national EPI and local pathogen data.  The job is automatically tasked after selecting the national EPI
"PKG",26,22,1,"PAH",1,1,154,0)
or spreadsheet.  The report or spreadsheet can then be viewed on the screen or printed using the new LAB EPI Print Local Report/Spreadsheet option.  Note: NO data is transmitted to Au
"PKG",26,22,1,"PAH",1,1,155,0)
  ROUTINE: LREPIRS
"PKG",26,22,1,"PAH",1,1,156,0)
 
"PKG",26,22,1,"PAH",1,1,157,0)
NAME: LREPI LOCAL PATHOGEN MENU         MENU TEXT: Local Pathogen Menu
"PKG",26,22,1,"PAH",1,1,158,0)
  TYPE: menu
"PKG",26,22,1,"PAH",1,1,159,0)
 DESCRIPTION:   This menu contains options to enter/edit and delete local pathogens.  Also, it contains options to generate and print the local report/spreadsheet.  
"PKG",26,22,1,"PAH",1,1,160,0)
ITEM: LREPI ENTER/EDIT LOCAL PATH
"PKG",26,22,1,"PAH",1,1,161,0)
ITEM: LREPI DELETE LOCAL PATHOGEN
"PKG",26,22,1,"PAH",1,1,162,0)
ITEM: LREPI GENERATE REPORT/SP          SYNONYM: GEN
"PKG",26,22,1,"PAH",1,1,163,0)
ITEM: LREPI PRINT REPORT/SPSHT          SYNONYM: PRT
"PKG",26,22,1,"PAH",1,1,164,0)
 
"PKG",26,22,1,"PAH",1,1,165,0)
 
"PKG",26,22,1,"PAH",1,1,166,0)
NAME: LREPI PATHOGEN INQUIRY            MENU TEXT: Pathogen Inquiry
"PKG",26,22,1,"PAH",1,1,167,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,168,0)
 DESCRIPTION:   This new option is used to inquire into the LAB
"PKG",26,22,1,"PAH",1,1,169,0)
SEARCH/EXTRACT file (#69.5) parameter description fields (i.e. INACTIVE:NO, LAG DAYS: 15, RUN DATE:ICT 07,2003, CYCLE:MONTHLY, PROTOCOL:LREPI, FOLLOW PTF:YES, REFERENCE NUMBER:23, and
"PKG",26,22,1,"PAH",1,1,170,0)
  ROUTINE: INQUIRY^LREPIPI
"PKG",26,22,1,"PAH",1,1,171,0)
 
"PKG",26,22,1,"PAH",1,1,172,0)
NAME: LREPI PRINT REPORT/SPSHT
"PKG",26,22,1,"PAH",1,1,173,0)
  MENU TEXT: Lab EPI Print Local Report/Spreadsheet
"PKG",26,22,1,"PAH",1,1,174,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,175,0)
 DESCRIPTION:   This option allows you to print a report or spreadsheet 
"PKG",26,22,1,"PAH",1,1,176,0)
that was generated with the Lab EPI Generate Local Report/Spreadsheet.  
"PKG",26,22,1,"PAH",1,1,177,0)
  ROUTINE: LREPIRS2
"PKG",26,22,1,"PAH",1,1,178,0)
 
"PKG",26,22,1,"PAH",1,1,179,0)
NAME: LREPI VERIFICATION REPORT
"PKG",26,22,1,"PAH",1,1,180,0)
  MENU TEXT: Print Detailed Verification Report
"PKG",26,22,1,"PAH",1,1,181,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,182,0)
 DESCRIPTION:   This option prints the Detailed Verification Report.  This 
"PKG",26,22,1,"PAH",1,1,183,0)
report is automatically generated when your site does an automated or 
"PKG",26,22,1,"PAH",1,1,184,0)
manual run and data is sent to Austin Automation Center.  Six months of 
"PKG",26,22,1,"PAH",1,1,185,0)
previous reports are kept as well as the current month for printing.  
"PKG",26,22,1,"PAH",1,1,186,0)
  ROUTINE: LREPIRP7
"PKG",26,22,1,"PAH",1,1,187,0)

"PKG",26,22,1,"PAH",1,1,188,0)
MODIFIED OPTIONS:
"PKG",26,22,1,"PAH",1,1,189,0)
NAME: LREPI ENHANCE MANUAL RUN          MENU TEXT: Lab EPI Manual Run (Enhanced)
"PKG",26,22,1,"PAH",1,1,190,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,191,0)
DESCRIPTION:   This option is used ONLY to manually extract national EPI data
"PKG",26,22,1,"PAH",1,1,192,0)
 and transmit to the Austin Automation Center (AAC). When this option is run,
"PKG",26,22,1,"PAH",1,1,193,0)
 an EPI Summary Verification Report is generated and automatically sent to the
"PKG",26,22,1,"PAH",1,1,194,0)
 EPI-Report mail group. Also, a Detailed Verification Report is generated and
"PKG",26,22,1,"PAH",1,1,195,0)
 can be printed using the new Print Detailed Verification Report [LREPI
"PKG",26,22,1,"PAH",1,1,196,0)
 VERIFICATION REPORT] option. This option has been RENAMED from Lab
"PKG",26,22,1,"PAH",1,1,197,0)
 Search/Extract Manual Run (Enhanced) [LREPI SEARCH/EXTRACT ENHANCED MANUAL
"PKG",26,22,1,"PAH",1,1,198,0)
 RUN] to EPI Manual Run (Enhanced) [LREPI ENHANCE MANUAL RUN] option.  
"PKG",26,22,1,"PAH",1,1,199,0)
  ROUTINE: LREPIRM
"PKG",26,22,1,"PAH",1,1,200,0)

"PKG",26,22,1,"PAH",1,1,201,0)
NAME: LREPI NIGHTLY TASK                MENU TEXT: Lab EPI Nightly Task
"PKG",26,22,1,"PAH",1,1,202,0)
  TYPE: run routine
"PKG",26,22,1,"PAH",1,1,203,0)
 DESCRIPTION:   The Lab Search/Extract Nightly Task option must be scheduled to
"PKG",26,22,1,"PAH",1,1,204,0)
 run each night by TaskMan. This option will build a HL7 Message and send it
"PKG",26,22,1,"PAH",1,1,205,0)
 the defined location specified in the EPI Protocols.  
"PKG",26,22,1,"PAH",1,1,206,0)
  ROUTINE: AUTO^LREPIRM                 SCHEDULING RECOMMENDED: YES
"PKG",26,22,1,"PAH",1,1,207,0)

"PKG",26,22,1,"PAH",1,1,208,0)
NAME: LREPI PARAMETER SETUP             MENU TEXT: Lab EPI Parameter Setup
"PKG",26,22,1,"PAH",1,1,209,0)
  TYPE: ScreenMan
"PKG",26,22,1,"PAH",1,1,210,0)
DESCRIPTION:   This option is used to define the search criteria along with
"PKG",26,22,1,"PAH",1,1,211,0)
 additional information associated with the EPI extracts.  This option only
"PKG",26,22,1,"PAH",1,1,212,0)
 allows editing.  You are not allowed to add local pathogens with this option.  
"PKG",26,22,1,"PAH",1,1,213,0)
  DIC {DIC}: LAB(69.5,                  DIC(0): AEMQ
"PKG",26,22,1,"PAH",1,1,214,0)
  DR{DDS}: [LREPI9]                     DDSFILE: 69.5
"PKG",26,22,1,"PAH",1,1,215,0)

"PKG",26,22,1,"PAH",1,1,216,0)
MODIFIED FILE:
"PKG",26,22,1,"PAH",1,1,217,0)
                                          UP    SEND  DATA                USER
"PKG",26,22,1,"PAH",1,1,218,0)
                                          DATE  SEC.  COMES  SITE   RSLV  OVER
"PKG",26,22,1,"PAH",1,1,219,0)
 FILE #      NAME                         DD    CODE  W/FILE DATA   PTS   RIDE
"PKG",26,22,1,"PAH",1,1,220,0)
 -------------------------------------------------------------------------------
"PKG",26,22,1,"PAH",1,1,221,0)
 
"PKG",26,22,1,"PAH",1,1,222,0)
 69.5        LAB SEARCH/EXTRACT           YES   NO    YES    MERG   YES   NO
"PKG",26,22,1,"PAH",1,1,223,0)
 
"PKG",26,22,1,"PAH",1,1,224,0)
The VistA Laboratory EPI Rollup Modifications Technical and User Manual 
"PKG",26,22,1,"PAH",1,1,225,0)
(i.e., LR_52_281_EPI_TUM.PDF) is available on the following Office of 
"PKG",26,22,1,"PAH",1,1,226,0)
Information Field Offices (OIFOs) ANONYMOUS SOFTWARE directories: 
"PKG",26,22,1,"PAH",1,1,227,0)
 
"PKG",26,22,1,"PAH",1,1,228,0)
OIFOs              FTP ADDRESS                   DIRECTORY
"PKG",26,22,1,"PAH",1,1,229,0)
Albany             ftp.fo-albany.med.va.gov      [ANONYMOUS.SOFTWARE]
"PKG",26,22,1,"PAH",1,1,230,0)
Hines              ftp.fo-hines.med.va.gov       [ANONYMOUS.SOFTWARE]
"PKG",26,22,1,"PAH",1,1,231,0)
Salt Lake City     ftp.fo-slc.med.va.gov         [ANONYMOUS.SOFTWARE]
"PKG",26,22,1,"PAH",1,1,232,0)
 
"PKG",26,22,1,"PAH",1,1,233,0)
VistA Laboratory EPI Rollup Modifications Technical and User Manual is 
"PKG",26,22,1,"PAH",1,1,234,0)
exported as part of Patch LR*5.2*281 in the following formats:
"PKG",26,22,1,"PAH",1,1,235,0)
 
"PKG",26,22,1,"PAH",1,1,236,0)
FILE NAME                      CONTENTS                             FORMAT RETRIEVAL
"PKG",26,22,1,"PAH",1,1,237,0)

"PKG",26,22,1,"PAH",1,1,238,0)
LR_52_281_EPI_TUM.PDF          LR EPI Technical and User Manual     BINARY
"PKG",26,22,1,"PAH",1,1,239,0)
 
"PKG",26,22,1,"PAH",1,1,240,0)
Testing Sites:
"PKG",26,22,1,"PAH",1,1,241,0)
==============
"PKG",26,22,1,"PAH",1,1,242,0)
 Boston HCS
"PKG",26,22,1,"PAH",1,1,243,0)
 Cincinnati VAMC
"PKG",26,22,1,"PAH",1,1,244,0)
 Detroit VAMC
"PKG",26,22,1,"PAH",1,1,245,0)
 Durham VAMC
"PKG",26,22,1,"PAH",1,1,246,0)
 Manchester VAMC
"PKG",26,22,1,"PAH",1,1,247,0)
 Togus VAMC
"PKG",26,22,1,"PAH",1,1,248,0)
 
"PKG",26,22,1,"PAH",1,1,249,0)
 ROUTINE SUMMARY
"PKG",26,22,1,"PAH",1,1,250,0)
 ===============
"PKG",26,22,1,"PAH",1,1,251,0)
 
"PKG",26,22,1,"PAH",1,1,252,0)
   The following routines are included in this patch.  The second line
"PKG",26,22,1,"PAH",1,1,253,0)
   of each of these routines now looks like:
"PKG",26,22,1,"PAH",1,1,254,0)
   <tab> ;;5.2;LAB SERVICE;<patchlist>;Sep 27, 1994
"PKG",26,22,1,"PAH",1,1,255,0)
  
"PKG",26,22,1,"PAH",1,1,256,0)
                     Checksum       Checksum
"PKG",26,22,1,"PAH",1,1,257,0)
 
"PKG",26,22,1,"PAH",1,1,258,0)
 
"PKG",26,22,1,"PAH",1,1,259,0)
    Routine Name     Before Patch   After Patch    Patch List
"PKG",26,22,1,"PAH",1,1,260,0)
    ------------     ------------   -----------    ------------
"PKG",26,22,1,"PAH",1,1,261,0)
    LR281            N/A              4418686      281(Deleted by KIDS)
"PKG",26,22,1,"PAH",1,1,262,0)
    LREPI            14217525         14182167     132,175,260,281
"PKG",26,22,1,"PAH",1,1,263,0)
    LREPI1           10654552         11822436     132,157,175,260,281
"PKG",26,22,1,"PAH",1,1,264,0)
    LREPI2           7199135          8491199   132,157,175,242,260,281
"PKG",26,22,1,"PAH",1,1,265,0)
    LREPI2A          NEW              7574864      281
"PKG",26,22,1,"PAH",1,1,266,0)
    LREPI3           5462995          9184652      132,175,260,281
"PKG",26,22,1,"PAH",1,1,267,0)
    LREPI5           NEW              2408593      281
"PKG",26,22,1,"PAH",1,1,268,0)
    LREPIPH          5818757          6144410      260,281
"PKG",26,22,1,"PAH",1,1,269,0)
    LREPIPI          NEW              5220624      281
"PKG",26,22,1,"PAH",1,1,270,0)
    LREPIRM          5260075          7566388      175,281
"PKG",26,22,1,"PAH",1,1,271,0)
    LREPIRP          5973015          20442264     132,157,175,260,281
"PKG",26,22,1,"PAH",1,1,272,0)
    LREPIRP1         NEW              15133552     281
"PKG",26,22,1,"PAH",1,1,273,0)
    LREPIRP2         NEW              3729823      281
"PKG",26,22,1,"PAH",1,1,274,0)
    LREPIRP3         NEW              29061422     281
"PKG",26,22,1,"PAH",1,1,275,0)
    LREPIRP4         NEW              1812384      281
"PKG",26,22,1,"PAH",1,1,276,0)
    LREPIRP5         NEW              11788836     281
"PKG",26,22,1,"PAH",1,1,277,0)
    LREPIRP6         NEW              25502070     281
"PKG",26,22,1,"PAH",1,1,278,0)
    LREPIRP7         NEW              17171829     281
"PKG",26,22,1,"PAH",1,1,279,0)
    LREPIRP8         NEW              8376752      281
"PKG",26,22,1,"PAH",1,1,280,0)
    LREPIRP9         NEW              4718         281
"PKG",26,22,1,"PAH",1,1,281,0)
    LREPIRS          NEW              8576522      281
"PKG",26,22,1,"PAH",1,1,282,0)
    LREPIRS1         NEW              16664999     281
"PKG",26,22,1,"PAH",1,1,283,0)
    LREPIRS2         NEW              22133542     281
"PKG",26,22,1,"PAH",1,1,284,0)
    LREPIRS3         NEW              16290972     281
"PKG",26,22,1,"PAH",1,1,285,0)
    LREPISRV         12552990         15211664     260,281 
"PKG",26,22,1,"PAH",1,1,286,0)
    LREPISV1         NEW              4805594      281
"PKG",26,22,1,"PAH",1,1,287,0)
 
"PKG",26,22,1,"PAH",1,1,288,0)
 ASSOCIATED NOIS:
"PKG",26,22,1,"PAH",1,1,289,0)
 ================
"PKG",26,22,1,"PAH",1,1,290,0)
 
"PKG",26,22,1,"PAH",1,1,291,0)
 NONE
"PKG",26,22,1,"PAH",1,1,292,0)
 
"PKG",26,22,1,"PAH",1,1,293,0)
 E3Rs:
"PKG",26,22,1,"PAH",1,1,294,0)
 =====
"PKG",26,22,1,"PAH",1,1,295,0)
 
"PKG",26,22,1,"PAH",1,1,296,0)
 N/A
"PKG",26,22,1,"PAH",1,1,297,0)
 
"PKG",26,22,1,"PAH",1,1,298,0)
**********************************************************************
"PKG",26,22,1,"PAH",1,1,299,0)
 
"PKG",26,22,1,"PAH",1,1,300,0)
 
"PKG",26,22,1,"PAH",1,1,301,0)
INSTALLATION INSTRUCTIONS
"PKG",26,22,1,"PAH",1,1,302,0)
=========================
"PKG",26,22,1,"PAH",1,1,303,0)
 
"PKG",26,22,1,"PAH",1,1,304,0)
  The install time for this patch is less than 2 minutes. This patch
"PKG",26,22,1,"PAH",1,1,305,0)
  can be installed when Laboratory users are on the system.
"PKG",26,22,1,"PAH",1,1,306,0)
 
"PKG",26,22,1,"PAH",1,1,307,0)
NOTE: Kernel patches must be current on the target system
"PKG",26,22,1,"PAH",1,1,308,0)
      to avoid problems loading and/or installing this patch.
"PKG",26,22,1,"PAH",1,1,309,0)
 
"PKG",26,22,1,"PAH",1,1,310,0)
  1.  If any of the above routines are mapped, disable mapping for
"PKG",26,22,1,"PAH",1,1,311,0)
      them.
"PKG",26,22,1,"PAH",1,1,312,0)
 
"PKG",26,22,1,"PAH",1,1,313,0)
  2.  Use the 'Load a Distribution" option to load the Host file on to your
"PKG",26,22,1,"PAH",1,1,314,0)
      system.
"PKG",26,22,1,"PAH",1,1,315,0)
 
"PKG",26,22,1,"PAH",1,1,316,0)
  3.  The patch has now been loaded into a Transport global on your
"PKG",26,22,1,"PAH",1,1,317,0)
      system.  You now need to use KIDS to install the transport   
"PKG",26,22,1,"PAH",1,1,318,0)
      global.
"PKG",26,22,1,"PAH",1,1,319,0)
 
"PKG",26,22,1,"PAH",1,1,320,0)
  4.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"PKG",26,22,1,"PAH",1,1,321,0)
      select the 'Installation' menu.
"PKG",26,22,1,"PAH",1,1,322,0)
 
"PKG",26,22,1,"PAH",1,1,323,0)
  5.  Use the 'Verify Checksum in Transport Global' option and verify 
"PKG",26,22,1,"PAH",1,1,324,0)
      that all routines have the correct checksums.
"PKG",26,22,1,"PAH",1,1,325,0)
 
"PKG",26,22,1,"PAH",1,1,326,0)
  6.  On the KIDS menu, under the 'Installation' menu, use the   
"PKG",26,22,1,"PAH",1,1,327,0)
      following options:
"PKG",26,22,1,"PAH",1,1,328,0)
        Print Transport Global
"PKG",26,22,1,"PAH",1,1,329,0)
        Compare Transport Global to Current System
"PKG",26,22,1,"PAH",1,1,330,0)
        Backup a Transport Global
"PKG",26,22,1,"PAH",1,1,331,0)
 
"PKG",26,22,1,"PAH",1,1,332,0)
      If you wish to preserve a copy of the routines exported in this 
"PKG",26,22,1,"PAH",1,1,333,0)
      patch prior to installation, you should use the 'Backup a 
"PKG",26,22,1,"PAH",1,1,334,0)
      Transport Global' option at this time.  You may also compare the  
"PKG",26,22,1,"PAH",1,1,335,0)
      routines in your production account to the routines in the patch  
"PKG",26,22,1,"PAH",1,1,336,0)
      by using the 'Compare a Transport Global to Current System' 
"PKG",26,22,1,"PAH",1,1,337,0)
      option.
"PKG",26,22,1,"PAH",1,1,338,0)
  
"PKG",26,22,1,"PAH",1,1,339,0)
  7.  Use the 'Install Package(s)' option under the 'Installation' menu
"PKG",26,22,1,"PAH",1,1,340,0)
      and select the package 'LR*5.2*281'.
"PKG",26,22,1,"PAH",1,1,341,0)
 
"PKG",26,22,1,"PAH",1,1,342,0)
      If prompted ' Want KIDS to Rebuild Menu Trees Upon Completion of 
"PKG",26,22,1,"PAH",1,1,343,0)
      Install? YES//' choose 'NO'.
"PKG",26,22,1,"PAH",1,1,344,0)
 
"PKG",26,22,1,"PAH",1,1,345,0)
      If prompted ' Want KIDS to INHIBIT LOGONs during the install?  
"PKG",26,22,1,"PAH",1,1,346,0)
      YES// ' choose 'NO'.
"PKG",26,22,1,"PAH",1,1,347,0)
 
"PKG",26,22,1,"PAH",1,1,348,0)
      If prompted 'Want to DISABLE Scheduled Options, Menu Options, and
"PKG",26,22,1,"PAH",1,1,349,0)
      Protocols? YES//', choose 'NO'.
"PKG",26,22,1,"PAH",1,1,350,0)
 
"PKG",26,22,1,"PAH",1,1,351,0)
  8.  On a mapped system, rebuild your map set.
"PKG",26,22,1,"PAH",1,1,352,0)
 
"PKG",26,22,1,"PAH",1,1,353,0)
  9.  Routine LR281 will be deleted after successful patch installation.
"PRE")
LR281
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
26
"RTN","LR281")
0^^B9704798
"RTN","LR281",1,0)
LR281 ;DALOI/CKA - LR*5.2*281 PATCH ENVIRONMENT CHECK ROUTINE ;4/22/2003
"RTN","LR281",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LR281",3,0)
 ; Reference to ^ORD(101 supported by IA #872
"RTN","LR281",4,0)
EN ; Does not prevent loading of the transport global.
"RTN","LR281",5,0)
 ; Environment check is done only during the install.
"RTN","LR281",6,0)
 ;
"RTN","LR281",7,0)
 N XQA,XQAMSG
"RTN","LR281",8,0)
 ;
"RTN","LR281",9,0)
 I '$G(XPDENV) D  Q
"RTN","LR281",10,0)
 . S XQAMSG="Transport global for patch "_$G(XPDNM,"Unknown patch")_" loaded on "_$$HTE^XLFDT($H)
"RTN","LR281",11,0)
 . S XQA("G.LMI")=""
"RTN","LR281",12,0)
 . D SETUP^XQALERT
"RTN","LR281",13,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Sending transport global loaded alert to mail group G.LMI",80))
"RTN","LR281",14,0)
 ;
"RTN","LR281",15,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" started on "_$$HTE^XLFDT($H)
"RTN","LR281",16,0)
 S XQA("G.LMI")=""
"RTN","LR281",17,0)
 D SETUP^XQALERT
"RTN","LR281",18,0)
 ;
"RTN","LR281",19,0)
 D CHECK
"RTN","LR281",20,0)
 D EXIT
"RTN","LR281",21,0)
 Q
"RTN","LR281",22,0)
 ;
"RTN","LR281",23,0)
CHECK ; Perform environment check
"RTN","LR281",24,0)
 I $S('$G(IOM):1,'$G(IOSL):1,$G(U)'="^":1,1:0) D  Q
"RTN","LR281",25,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Terminal Device is not defined",80))
"RTN","LR281",26,0)
 . S XPDQUIT=2
"RTN","LR281",27,0)
 I $S('$G(DUZ):1,$D(DUZ)[0:1,$D(DUZ(0))[0:1,1:0) D  Q
"RTN","LR281",28,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Please log in to set local DUZ... variables",80))
"RTN","LR281",29,0)
 . S XPDQUIT=2
"RTN","LR281",30,0)
 I $P($$ACTIVE^XUSER(DUZ),"^")'=1 D  Q
"RTN","LR281",31,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("You are not a valid user on this system",80))
"RTN","LR281",32,0)
 . S XPDQUIT=2
"RTN","LR281",33,0)
 Q
"RTN","LR281",34,0)
 ;
"RTN","LR281",35,0)
EXIT ;
"RTN","LR281",36,0)
 I $G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Install Environment Check FAILED ---",80))
"RTN","LR281",37,0)
 I '$G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Environment Check is Ok ---",80))
"RTN","LR281",38,0)
 I '$G(XPDQUIT) D
"RTN","LR281",39,0)
 .S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" completed on "_$$HTE^XLFDT($H)
"RTN","LR281",40,0)
 .S XQA("G.LMI")=""
"RTN","LR281",41,0)
 .D SETUP^XQALERT
"RTN","LR281",42,0)
 Q
"RTN","LR281",43,0)
 ;
"RTN","LR281",44,0)
 ;
"RTN","LR281",45,0)
PRE ; KIDS Pre install for LR*5.2*281
"RTN","LR281",46,0)
 ;Pre-install entry point
"RTN","LR281",47,0)
 ;Delete NCH entries
"RTN","LR281",48,0)
 Q:'($O(^LAB(69.5,"B","NCH CHOLESTEROL",0)))
"RTN","LR281",49,0)
 Q:'($O(^LAB(69.5,"B","NCH PAP SMEAR",0)))
"RTN","LR281",50,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Deleting NCH entries from LAB/SEARCH EXTRACT file (#69.5)",80))
"RTN","LR281",51,0)
 S LRNUM(1)=$O(^LAB(69.5,"B","NCH CHOLESTEROL",0))
"RTN","LR281",52,0)
 S LRNUM(2)=$O(^LAB(69.5,"B","NCH PAP SMEAR",0))
"RTN","LR281",53,0)
 S DIK="^LAB(69.5," F LRNUM=1:1:2 S DA=LRNUM(LRNUM) D ^DIK
"RTN","LR281",54,0)
 K DIK,DA,LRNUM
"RTN","LR281",55,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Preinstall completed ***",80))
"RTN","LR281",56,0)
 Q
"RTN","LR281",57,0)
 ;
"RTN","LR281",58,0)
 ;
"RTN","LR281",59,0)
POST ; KIDS Post install for LR*5.2*281
"RTN","LR281",60,0)
 ; Set Lag Days =15 for all pathogens
"RTN","LR281",61,0)
 S LRNUM=0
"RTN","LR281",62,0)
 F  S LRNUM=$O(^LAB(69.5,LRNUM)) Q:LRNUM'>0  S $P(^LAB(69.5,LRNUM,0),U,3)=15
"RTN","LR281",63,0)
 ;
"RTN","LR281",64,0)
 ; Set Previous Cycle field for TB=1
"RTN","LR281",65,0)
 Q:'$D(^LAB(69.5,5,0))
"RTN","LR281",66,0)
 Q:$P(^LAB(69.5,5,0),U)'="TUBERCULOSIS"
"RTN","LR281",67,0)
 S $P(^LAB(69.5,5,0),U,13)=1
"RTN","LR281",68,0)
 ;Make sure the protocol is correct
"RTN","LR281",69,0)
 S LREPI=0,LRNUM=0,LREPI=$O(^ORD(101,"B","LREPI",LREPI))
"RTN","LR281",70,0)
 F  S LRNUM=$O(^LAB(69.5,LRNUM)) Q:LRNUM=""  S $P(^LAB(69.5,LRNUM,0),U,7)=LREPI
"RTN","LR281",71,0)
 ;delete the NCH protocol from 69.4-all but LREPI deleted
"RTN","LR281",72,0)
 S LRNUM=0
"RTN","LR281",73,0)
 F  S LRNUM=$O(^LAB(69.4,LRNUM)) Q:LRNUM=""  I LREPI'=LRNUM D
"RTN","LR281",74,0)
 .S DIK="^LAB(69.4,",DA=LRNUM
"RTN","LR281",75,0)
 .D ^DIK
"RTN","LR281",76,0)
 .K DIK,DA
"RTN","LR281",77,0)
 K LREPI,LRNUM
"RTN","LR281",78,0)
 Q
"RTN","LREPI")
0^1^B57448349
"RTN","LREPI",1,0)
LREPI ;DALOI/SED-EMERGING PATHOGENS SEARCH ;5/1/98
"RTN","LREPI",2,0)
 ;;5.2;LAB SERVICE;**132,175,260,281**;Sep 27, 1994
"RTN","LREPI",3,0)
 ; Reference to ^DGPT supported by IA #418
"RTN","LREPI",4,0)
 ; Reference to ^ICD9 supported by IA #10082
"RTN","LREPI",5,0)
 ; Reference to ^ORD(101 supported by IA #872
"RTN","LREPI",6,0)
 ; Reference to PATS^PXRMXX supported by IA #3134
"RTN","LREPI",7,0)
TEST S LRRPS=3000501,LRRPE=3000531,LRRTYPE=1
"RTN","LREPI",8,0)
 S LREPI(2)="",LREPI(17)="",LREPI(18)="",LREPI(19)=""
"RTN","LREPI",9,0)
 ;S D0=0 F  S D0=$O(^LAB(69.5,D0)) Q:+D0'>0  D
"RTN","LREPI",10,0)
 ;.Q:$P(^LAB(69.5,D0,0),U,2)="1"
"RTN","LREPI",11,0)
 ;.Q:$P(^LAB(69.5,D0,0),U,7)=""
"RTN","LREPI",12,0)
 ;.Q:'$D(^ORD(101,$P(^LAB(69.5,D0,0),U,7),0))
"RTN","LREPI",13,0)
 ;.S LREPI(D0)=""
"RTN","LREPI",14,0)
 S LRBEG=9999999-(LRRPE+.9),LREND=9999999-LRRPS+.999999
"RTN","LREPI",15,0)
EN ;
"RTN","LREPI",16,0)
 ;
"RTN","LREPI",17,0)
INIT ;Set up search criteria
"RTN","LREPI",18,0)
 ;Fix start and stop date problem CKA 6/2/2002
"RTN","LREPI",19,0)
 S LRBEG=(9999999-LRRPE)_".0000001",LREND=9999999-LRRPS+.999999
"RTN","LREPI",20,0)
 K ^TMP($J),^TMP("HLS",$J)
"RTN","LREPI",21,0)
 S D0=0 F  S D0=$O(LREPI(D0)) Q:+D0'>0  D
"RTN","LREPI",22,0)
 .S ^TMP($J,$P(^LAB(69.5,D0,0),U,7))=""
"RTN","LREPI",23,0)
 .S:$P(^LAB(69.5,D0,0),U,8)=1 ^TMP($J,"LREPI",D0)=""
"RTN","LREPI",24,0)
 .S LRPROT=$P(^LAB(69.5,D0,0),U,7)
"RTN","LREPI",25,0)
 .Q:LRPROT=""
"RTN","LREPI",26,0)
 .S D1=0 F  S D1=$O(^LAB(69.5,D0,1,D1)) Q:+D1'>0  D
"RTN","LREPI",27,0)
 ..S TST=$P(^LAB(69.5,D0,1,D1,0),U)
"RTN","LREPI",28,0)
 ..Q:'$D(^LAB(60,TST,0))
"RTN","LREPI",29,0)
 ..Q:$P(^LAB(60,TST,0),U,4)=""
"RTN","LREPI",30,0)
 ..I $P(^LAB(60,TST,0),U,4)="CH" D
"RTN","LREPI",31,0)
 ...Q:$P(^LAB(60,TST,0),U,5)=""
"RTN","LREPI",32,0)
 ...S ^TMP($J,"T",TST,D0)=""
"RTN","LREPI",33,0)
 ...S ^TMP($J,"TPROT",TST,LRPROT)=""
"RTN","LREPI",34,0)
 ...S LRIND=$P(^LAB(69.5,D0,1,D1,0),U,2,3)
"RTN","LREPI",35,0)
 ...S ^TMP($J,$P(^LAB(60,TST,0),U,4),TST)=$P(^LAB(60,TST,0),U,5)_U_LRIND
"RTN","LREPI",36,0)
 ..I $P(^LAB(60,TST,0),U,4)="CY" D
"RTN","LREPI",37,0)
 ...S ^TMP($J,"T",TST,D0)=""
"RTN","LREPI",38,0)
 ...S ^TMP($J,$P(^LAB(60,TST,0),U,4),TST)=""
"RTN","LREPI",39,0)
 .S D1=0 F  S D1=$O(^LAB(69.5,D0,2,D1)) Q:+D1'>0  S ^TMP($J,"E",$P(^LAB(69.5,D0,2,D1,0),U),D0)=""
"RTN","LREPI",40,0)
 .S D1=0 F  S D1=$O(^LAB(69.5,D0,9,D1)) Q:+D1'>0  S ^TMP($J,"SNO",$P(^LAB(69.5,D0,9,D1,0),U),D0)=""
"RTN","LREPI",41,0)
 .S D1=0 F  S D1=$O(^LAB(69.5,D0,3,D1)) Q:+D1'>0  S ^TMP($J,"ICD",$P(^LAB(69.5,D0,3,D1,0),U),D0)=""
"RTN","LREPI",42,0)
 K D0,D1,TST,LRIND
"RTN","LREPI",43,0)
 I $D(^TMP($J,"LREPI")) D SEARCH^LREPI4
"RTN","LREPI",44,0)
 I $D(^TMP($J,"ICD")) D PTF^LREPI5
"RTN","LREPI",45,0)
LAB63 ;Search file 63 for lab data
"RTN","LREPI",46,0)
 K LRIND
"RTN","LREPI",47,0)
 S LRDFN=0 F  S LRDFN=$O(^LR(LRDFN)) Q:+LRDFN'>0  D
"RTN","LREPI",48,0)
 .Q:'$D(^LR(LRDFN,0))
"RTN","LREPI",49,0)
 .Q:$P(^LR(LRDFN,0),U,2)'=2
"RTN","LREPI",50,0)
 .S LRPAT=$P(^LR(LRDFN,0),U,3)
"RTN","LREPI",51,0)
 .I $D(^TMP($J,"CH")) D CH
"RTN","LREPI",52,0)
 .I $D(^TMP($J,"CY")) D CYTST^LREPICY
"RTN","LREPI",53,0)
 .I $D(^TMP($J,"E")) D MI
"RTN","LREPI",54,0)
 .;I '$D(^TMP($J,"ICD"))&($D(^TMP($J,"SNO"))) D CY^LREPICY
"RTN","LREPI",55,0)
 .I $D(^TMP($J,"SNO")) D CY^LREPICY
"RTN","LREPI",56,0)
 ;Retrieve patient list from Clinical Reminders
"RTN","LREPI",57,0)
 S LRPROTX=$O(^ORD(101,"B","LREPI",""))
"RTN","LREPI",58,0)
 I LRPROTX]"" S LRSRXX="",LRSRGO=0 F  S LRSRXX=$O(LREPI(LRSRXX)) Q:'LRSRXX  I $G(^LAB(69.5,LRSRXX,0))["HEPATITIS" D  Q
"RTN","LREPI",59,0)
  . D PATS^PXRMXX(LRRPS,LRRPE,"LREPISRCH")
"RTN","LREPI",60,0)
  . S EPISRCH=0 F  S EPISRCH=$O(^TMP("LREPISRCH",$J,EPISRCH)) Q:'EPISRCH  D
"RTN","LREPI",61,0)
  . . S LRENCDT=$P(^TMP("LREPISRCH",$J,EPISRCH),"^") Q:'LRENCDT
"RTN","LREPI",62,0)
  . . Q:$D(^TMP($J,LRPROTX,EPISRCH,LRENCDT))  ;Encounter date already exists, don't update
"RTN","LREPI",63,0)
  . . S ^TMP($J,LRPROTX,EPISRCH,LRENCDT)=$P(^TMP("LREPISRCH",$J,EPISRCH),"^",2)
"RTN","LREPI",64,0)
 I $G(LRREP) D ^LREPI2A
"RTN","LREPI",65,0)
 I '$G(LRREP) D ^LREPI2
"RTN","LREPI",66,0)
EXIT ;EXIT
"RTN","LREPI",67,0)
 S D0=0
"RTN","LREPI",68,0)
 I $G(LRRTYPE)=0 F  S D0=$O(LREPI(D0)) Q:+D0'>0  D
"RTN","LREPI",69,0)
 .S $P(^LAB(69.5,D0,0),U,4)=DT
"RTN","LREPI",70,0)
 K LREPI,DFN,CNT,DA,DIE,DR,DQ,HL,ENTRY,ENDT,ENC,FD,HLECH,HLFS,HLN,HLQ
"RTN","LREPI",71,0)
 K DDER,D0,HLRST,HLSAN,LRBEG,LRCNT,LRCS,LRDATE,LRDFN,LREFG,LRENCDT
"RTN","LREPI",72,0)
 K LREND,LRETND,LRHL7,LRINV,LRINVD,LRITN,LRND,LRNL,LRNLT,LRNTE,LROBR
"RTN","LREPI",73,0)
 K LRPAT,LRPFG,LRPID,LRPROT,LRPV1,LRRPE,LRRPS,LRRTYPE,LRTND,LRTNM,MSG
"RTN","LREPI",74,0)
 K MSGCNT,PTF,RR,SEG,SP,STDT,TST,UN,TSTNM,VAERR,X,XCNP,XMDUZ,XMZ,ZTSK
"RTN","LREPI",75,0)
 K AF,D,DI,LRENT,LRIND,LRPATH,OV,LRENDT,ADMDT,EPISITE,EPISRCH
"RTN","LREPI",76,0)
 K LR31799Z,LRANTI,LRCHK,LRIC,LRIEN,LRIPT,LRMG,LRMGN,LRNX,LRO,LROK
"RTN","LREPI",77,0)
 K LROVR,LRPCNT,LRPTOT,LRSI,LRSITE,LRCYSP,LRDIS,LRDISI,LRIC,LRICD
"RTN","LREPI",78,0)
 K LRICDI,LRIEN,LRIPT,LRMG,LRMGN,LRMOR,LRMORI,LRMSG,PXRMITEM
"RTN","LREPI",79,0)
 K LRSNM,LRSNO,LRSTOP,LRSUB,LRTOP,LRTOPP,LRWKI,LRPRO,LRPROI
"RTN","LREPI",80,0)
 K LRNDC,LRNTE1,LRFIND,LRDRUG,LRCODE,LRDRSEQ,HLHDR,HLMTIEN,HLMTIENS
"RTN","LREPI",81,0)
 K HLNEXT,HLNODE,HLQUIT,HLRESLT,HLRESLTA,LRANS,LRDRSQ1,LRPROTX,LRPTY
"RTN","LREPI",82,0)
 K LRPVVV,LRSRGO,LRSRXX,LRTOLD,LRTRM,LRPREV,LRPRECYC,X1,X2,X3
"RTN","LREPI",83,0)
 K LRANTIND,LRANTINV,LRREP,LRPV1NUM
"RTN","LREPI",84,0)
 Q
"RTN","LREPI",85,0)
ENCT ;SET THE ENCOUNTER FOR PV1
"RTN","LREPI",86,0)
 S LRPROT=$P(^LAB(69.5,LRPATH,0),U,7)
"RTN","LREPI",87,0)
 S LRCHK=0 D ADDCHK^LREPI5 Q:LRCHK
"RTN","LREPI",88,0)
 S LRDATE=9999999-LRINV
"RTN","LREPI",89,0)
 K VAIN,DFN,VAINDT S DFN=LRPAT,VAINDT=LRDATE D INP^VADPT
"RTN","LREPI",90,0)
 S LRENCDT=$S(VAIN(7)'="":$P(VAIN(7),U),1:LRDATE)
"RTN","LREPI",91,0)
 I $P(^LAB(69.5,LRPATH,0),U,8)=1 D CHECK^LREPI4
"RTN","LREPI",92,0)
 S:'$D(^TMP($J,LRPROT,LRPAT,LRENCDT)) ^TMP($J,LRPROT,LRPAT,LRENCDT)=$S(VAIN(7)'="":"I",1:"O")_U_$G(VAIN(10))
"RTN","LREPI",93,0)
 S:$P(^TMP($J,LRPROT,LRPAT,LRENCDT),U)="O" ^(LRENCDT)="O"_U_$S($D(LRPATLOC):LRPATLOC,1:"")
"RTN","LREPI",94,0)
 S:'$D(^TMP($J,LRPROT,LRPAT,LRENCDT,LRPATH,LRINV,ND)) ^TMP($J,LRPROT,LRPAT,LRENCDT,LRPATH,LRINV,ND)=""
"RTN","LREPI",95,0)
 I $G(LRANTIND)="",$G(LRANTINV)="" Q
"RTN","LREPI",96,0)
 S:'$D(^TMP($J,LRPROT,LRPATH,LRENCDT,LRPAT,LRINV,ND,LRANTIND,LRANTINV)) ^TMP($J,LRPROT,LRPAT,LRENCDT,LRPATH,LRINV,ND,LRANTIND,LRANTINV)=""
"RTN","LREPI",97,0)
 Q
"RTN","LREPI",98,0)
CH ;Check the 'CH' node
"RTN","LREPI",99,0)
 S LRINV=LRBEG
"RTN","LREPI",100,0)
 F  S LRINV=$O(^LR(LRDFN,"CH",LRINV)) Q:+LRINV'>0!(LRINV>LREND)  D
"RTN","LREPI",101,0)
 .Q:$P(^LR(LRDFN,"CH",LRINV,0),U,3)=""
"RTN","LREPI",102,0)
 .S LRCNT=1,LRTST=0 F  S LRTST=$O(^TMP($J,"CH",LRTST)) Q:+LRTST'>0  D
"RTN","LREPI",103,0)
 ..S LRND=$P($P(^TMP($J,"CH",LRTST),";",2),U,1) Q:+LRND'>0
"RTN","LREPI",104,0)
 ..S LRPC=$P($P(^TMP($J,"CH",LRTST),";",3),U,1) Q:+LRPC'>0
"RTN","LREPI",105,0)
 ..S LRRES=$P($G(^LR(LRDFN,"CH",LRINV,LRND)),U,LRPC) Q:LRRES=""
"RTN","LREPI",106,0)
 ..S LRPATLOC=$P(^LR(LRDFN,"CH",LRINV,0),U,13)
"RTN","LREPI",107,0)
 ..S ^TMP($J,"TST",LRTST)=+$G(^TMP($J,"TST",LRTST))+1
"RTN","LREPI",108,0)
 ..S ^TMP($J,"TST",LRTST,LRDFN)=""
"RTN","LREPI",109,0)
 ..S LRPATH=0 F  S LRPATH=$O(^TMP($J,"T",LRTST,LRPATH)) Q:+LRPATH'>0  D CHKIND
"RTN","LREPI",110,0)
 K LRTST,LRND,LRPC,LRRES,LRNO
"RTN","LREPI",111,0)
 Q
"RTN","LREPI",112,0)
CHKIND ;Check the results
"RTN","LREPI",113,0)
 I '$D(^LAB(69.5,LRPATH,1,"B",LRTST)) Q
"RTN","LREPI",114,0)
 S LRITST=0,ND="CH",LRNO=0
"RTN","LREPI",115,0)
 F  S LRITST=$O(^LAB(69.5,LRPATH,1,"B",LRTST,LRITST)) Q:+LRITST'>0  D  D:'LRNO ENCT
"RTN","LREPI",116,0)
 .S LRNO=0
"RTN","LREPI",117,0)
 .S LRIND=$P(^LAB(69.5,LRPATH,1,LRITST,0),U,2,3)
"RTN","LREPI",118,0)
 .Q:$P(LRIND,U,1)=""
"RTN","LREPI",119,0)
 .I $P(LRIND,U,1)=1 D  Q
"RTN","LREPI",120,0)
 ..Q:'LRRES#2
"RTN","LREPI",121,0)
 ..S LRSPEC=$P($G(^LR(LRDFN,"CH",LRINV,0)),U,5) Q:LRSPEC=""
"RTN","LREPI",122,0)
 ..Q:'$D(^LAB(60,LRTST,1,LRSPEC,0))
"RTN","LREPI",123,0)
 ..S LRLOW=$P(^LAB(60,LRTST,1,LRSPEC,0),U,2),LRHIG=$P(^(0),U,3)
"RTN","LREPI",124,0)
 ..Q:'LRLOW#2!('LRHIG#2)
"RTN","LREPI",125,0)
 ..I LRRES<LRLOW!(LRRES>LRHIG) Q
"RTN","LREPI",126,0)
 ..S LRNO=1
"RTN","LREPI",127,0)
 .I $P(LRIND,U,2)="" Q
"RTN","LREPI",128,0)
 .S LRRES=$$UP^XLFSTR(LRRES),LRIND=$$UP^XLFSTR(LRIND)
"RTN","LREPI",129,0)
 .I $P(LRIND,U,1)=2,(LRRES[$P(LRIND,U,2)) Q
"RTN","LREPI",130,0)
 .I $P(LRIND,U,1)=3,(LRRES>$P(LRIND,U,2)) Q
"RTN","LREPI",131,0)
 .I $P(LRIND,U,1)=4,(LRRES<$P(LRIND,U,2)) Q
"RTN","LREPI",132,0)
 .I $P(LRIND,U,1)=5,(LRRES=$P(LRIND,U,2)) Q
"RTN","LREPI",133,0)
 .S LRNO=1
"RTN","LREPI",134,0)
 K LRITST,LRLOW,LRHIG,LRSPEC
"RTN","LREPI",135,0)
 Q
"RTN","LREPI",136,0)
MI ;Check the 'MI' node
"RTN","LREPI",137,0)
 S LRINV=LRBEG
"RTN","LREPI",138,0)
 F  S LRINV=$O(^LR(LRDFN,"MI",LRINV)) Q:+LRINV'>0!(LRINV>LREND)  D
"RTN","LREPI",139,0)
 .S LRCNT=1
"RTN","LREPI",140,0)
 .F LRMIND=3,6,9,12,17 S LRETND=0 F  S LRETND=$O(^LR(LRDFN,"MI",LRINV,LRMIND,LRETND)) Q:+LRETND'>0  D
"RTN","LREPI",141,0)
 ..I LRMIND=3,$P($G(^LR(LRDFN,"MI",LRINV,1)),U,2)'="F" Q
"RTN","LREPI",142,0)
 ..I LRMIND'=3,$P($G(^LR(LRDFN,"MI",LRINV,(LRMIND-1))),U,2)'="F" Q
"RTN","LREPI",143,0)
 ..S LRETI=$P($G(^LR(LRDFN,"MI",LRINV,LRMIND,LRETND,0)),U)
"RTN","LREPI",144,0)
 ..Q:+LRETI'>0
"RTN","LREPI",145,0)
 ..Q:'$D(^TMP($J,"E",LRETI))
"RTN","LREPI",146,0)
 ..S ^TMP($J,"EPROT",LRETI)=""
"RTN","LREPI",147,0)
 ..S ^TMP($J,"ETI",LRETI)=+$G(^TMP($J,"ETI",LRETI))+1
"RTN","LREPI",148,0)
 ..S ^TMP($J,"ETI",LRETI,LRDFN)=""
"RTN","LREPI",149,0)
 ..S LRPATH=0 F  S LRPATH=$O(^TMP($J,"E",LRETI,LRPATH)) Q:+LRPATH'>0  D
"RTN","LREPI",150,0)
 ...S ND="MI"
"RTN","LREPI",151,0)
 ...D TOP Q:LRTOP
"RTN","LREPI",152,0)
 ...I LRMIND=3 D ANTI Q
"RTN","LREPI",153,0)
 ...D ENCT
"RTN","LREPI",154,0)
 K LRMIND,LRETI
"RTN","LREPI",155,0)
 Q
"RTN","LREPI",156,0)
TOP ;CHECK TO SEE IF SCREEN ON SITE
"RTN","LREPI",157,0)
 S LRTOP=0
"RTN","LREPI",158,0)
 S LRSITE=$P($G(^LR(LRDFN,"MI",LRINV,0)),U,5) Q:+LRSITE'>0
"RTN","LREPI",159,0)
 I ($O(^LAB(69.5,LRPATH,5,0))="")&($O(^LAB(69.5,LRPATH,6,0))="") Q
"RTN","LREPI",160,0)
 I ($O(^LAB(69.5,LRPATH,5,0))'="")&($O(^LAB(69.5,LRPATH,6,0))'="") Q
"RTN","LREPI",161,0)
 I ($O(^LAB(69.5,LRPATH,5,0))'="")&($D(^LAB(69.5,LRPATH,5,"B",LRSITE))) Q
"RTN","LREPI",162,0)
 I ($O(^LAB(69.5,LRPATH,6,0))'="")&('$D(^LAB(69.5,LRPATH,6,"B",LRSITE))) Q
"RTN","LREPI",163,0)
 S LRTOP=1
"RTN","LREPI",164,0)
 Q
"RTN","LREPI",165,0)
ANTI ;LOOK FOR THE ANTIMICROBIAL SUS FOR ORGANISMS
"RTN","LREPI",166,0)
 I $O(^LAB(69.5,LRPATH,4,0))="" D ENCT Q
"RTN","LREPI",167,0)
 S LRANTI=0 F  S LRANTI=$O(^LAB(69.5,LRPATH,4,LRANTI)) Q:+LRANTI'>0  D
"RTN","LREPI",168,0)
 .S LRANT=$G(^LAB(69.5,LRPATH,4,LRANTI,0),U),LRANTIND=$P(^(0),U,2),LRANTINV=$P(^(0),U,3) Q:+LRANT'>0
"RTN","LREPI",169,0)
 .S LRAND=$P($G(^LAB(62.06,LRANT,0)),U,2) Q:LRAND=""
"RTN","LREPI",170,0)
 .Q:'$D(^LR(LRDFN,"MI",LRINV,LRMIND,LRETND,LRAND))
"RTN","LREPI",171,0)
 .Q:$P(^LR(LRDFN,"MI",LRINV,LRMIND,LRETND,LRAND),U,2)=""
"RTN","LREPI",172,0)
 .Q:$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRINV,LRMIND,LRETND,LRAND)),U,2),1,1))="S"
"RTN","LREPI",173,0)
 .D ENCT
"RTN","LREPI",174,0)
 .;CHECK MIC VALUES
"RTN","LREPI",175,0)
 .I LRANTIND=""!(LRANTINV="") Q
"RTN","LREPI",176,0)
 .S LRRES=$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRINV,LRMIND,LRETND,LRAND)),U,2),1,1)),LRANTINV=$$UP^XLFSTR(LRANTINV),LRANTIND=$$UP^XLFSTR(LRANTIND)
"RTN","LREPI",177,0)
 .I LRANTIND=1,(LRRES[LRANTINV) D ENCT Q
"RTN","LREPI",178,0)
 .I LRANTIND=2,(LRRES>LRANTINV) D ENCT Q
"RTN","LREPI",179,0)
 .I LRANTIND=3,(LRRES<LRANTINV) D ENCT Q
"RTN","LREPI",180,0)
 .I LRANTIND=4,(LRRES=LRANTINV) D ENCT Q
"RTN","LREPI",181,0)
 Q
"RTN","LREPI",182,0)
 ;
"RTN","LREPI1")
0^2^B55919075
"RTN","LREPI1",1,0)
LREPI1 ;DALOI/SED - EMERGING PATHOGENS HL7 BUILDER ; 5/9/98
"RTN","LREPI1",2,0)
 ;;5.2;LAB SERVICE;**132,157,175,260,281**;Sep 27, 1994
"RTN","LREPI1",3,0)
 ; Reference to ^DD supported by IA #999
"RTN","LREPI1",4,0)
 ; Reference to ^XLFSTR supported by IA #10104
"RTN","LREPI1",5,0)
EN(LRDFN,SS,IVDT,SEQ) ;Entry to build the HL7 Segment
"RTN","LREPI1",6,0)
 ;LRDFN=Patient ID
"RTN","LREPI1",7,0)
 ;SS=Subscripts in file 63  for results
"RTN","LREPI1",8,0)
 ;IVDT=Inverted Date and Time
"RTN","LREPI1",9,0)
 ;SEQ=Sequence Number
"RTN","LREPI1",10,0)
 ;S LRCS=$E(HL("ECH"))
"RTN","LREPI1",11,0)
 K ^TMP("HL7",$J)
"RTN","LREPI1",12,0)
 S:+$G(SEQ)'>0 SEQ=1
"RTN","LREPI1",13,0)
 S CNT=1
"RTN","LREPI1",14,0)
 Q:'$G(LRDFN)!('$G(IVDT))!('$L($G(SS)))
"RTN","LREPI1",15,0)
 I $L($T(@SS)) D @SS
"RTN","LREPI1",16,0)
EXIT ;KILL THEN EXIT
"RTN","LREPI1",17,0)
 K CNT,IND,LRAND,LRANT,LRDATA,LRES,LRINLT,LRNT,LRRDTE,LRREF,LRTST,LRUNIT
"RTN","LREPI1",18,0)
 K ND,NLT,NLTP,ORGNB,ORGPT,SEQX,SITE,TYPE,LRCODE,LRFLD
"RTN","LREPI1",19,0)
 Q SEQ
"RTN","LREPI1",20,0)
CY D CY^LREPI1A
"RTN","LREPI1",21,0)
 Q
"RTN","LREPI1",22,0)
SITECD ;Determine the HL7 Speciman code from the Site and return LRCODE
"RTN","LREPI1",23,0)
 S LRCODE=""
"RTN","LREPI1",24,0)
 Q:'$D(SITE)
"RTN","LREPI1",25,0)
 S LRCODE=$P($G(^LAB(61,SITE,0)),U,8)     ;Use if LEDI is not defined
"RTN","LREPI1",26,0)
 S LRIPT=$P($G(^LAB(61,SITE,0)),U,9) Q:+LRIPT'>0
"RTN","LREPI1",27,0)
 Q:'$D(^LAB(64.061,LRIPT,0))
"RTN","LREPI1",28,0)
 Q:$P(^LAB(64.061,LRIPT,0),U,3)=""
"RTN","LREPI1",29,0)
 S LRCODE=$P(^LAB(64.061,LRIPT,0),U,3)
"RTN","LREPI1",30,0)
 Q
"RTN","LREPI1",31,0)
CH ;BUILD HL7 MSG FOR CH SUBSCRIPT
"RTN","LREPI1",32,0)
 ;TO BUILD OBR SEGMENT FOR CHEM
"RTN","LREPI1",33,0)
 I '$D(^LR(LRDFN,SS,IVDT,0)) Q
"RTN","LREPI1",34,0)
 K LRDATA
"RTN","LREPI1",35,0)
 S $P(LRDATA,HLFS,1)=$G(SEQ)
"RTN","LREPI1",36,0)
 S $P(LRDATA,HLFS,4)="81121.0000"_LRCS_"CHEMISTRY TEST"_LRCS_"VANLT"
"RTN","LREPI1",37,0)
 S $P(LRDATA,HLFS,18)=$P(^LR(LRDFN,SS,IVDT,0),U,6)
"RTN","LREPI1",38,0)
 S $P(LRDATA,HLFS,7)=$$HLDATE^HLFNC(9999999-IVDT)
"RTN","LREPI1",39,0)
 S LRRDTE=$P($G(^LR(LRDFN,SS,IVDT,0)),U,3)
"RTN","LREPI1",40,0)
 S:+LRRDTE>0 LRRDTE=$$HLDATE^HLFNC(LRRDTE)
"RTN","LREPI1",41,0)
 S SITE=$P($G(^LR(LRDFN,SS,IVDT,0)),U,5)
"RTN","LREPI1",42,0)
 D SITECD
"RTN","LREPI1",43,0)
 S $P(LRDATA,HLFS,15)=LRCODE_LRCS_LRCS_$P($G(^LAB(61,SITE,0)),U)
"RTN","LREPI1",44,0)
 S ^TMP("HL7",$J,CNT)="OBR"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",45,0)
 ;TO BUILD OBX SEGMENT CHEM
"RTN","LREPI1",46,0)
 S (IND,SEQX)=1
"RTN","LREPI1",47,0)
 F  S IND=$O(^LR(LRDFN,"CH",IVDT,IND)) Q:+IND'>0  D
"RTN","LREPI1",48,0)
 .S LRES=^LR(LRDFN,"CH",IVDT,IND)
"RTN","LREPI1",49,0)
 .Q:LRES=""
"RTN","LREPI1",50,0)
 .Q:'$D(^LAB(60,"C","CH;"_IND_";1"))
"RTN","LREPI1",51,0)
 .K LRDATA
"RTN","LREPI1",52,0)
 .S LRTST=$O(^LAB(60,"C","CH;"_IND_";1",0))
"RTN","LREPI1",53,0)
 .Q:'$D(^TMP($J,"T",LRTST,LRPATH))
"RTN","LREPI1",54,0)
 .S $P(LRDATA,HLFS,1)=SEQX,$P(LRDATA,HLFS,2)="ST"
"RTN","LREPI1",55,0)
 .S LRUNIT=$P($G(^LAB(60,LRTST,1,SITE,0)),U,7)
"RTN","LREPI1",56,0)
 .S LRREF=$P($G(^LAB(60,LRTST,1,SITE,0)),U,2)_"-"
"RTN","LREPI1",57,0)
 .S LRREF=LRREF_$P($G(^LAB(60,LRTST,1,SITE,0)),U,3)
"RTN","LREPI1",58,0)
 .S LRINLT=+$G(^LAB(60,LRTST,64)),LRNLT=LRCS_LRCS_LRCS
"RTN","LREPI1",59,0)
 .I LRINLT'="",$D(^LAM(LRINLT,0)) D
"RTN","LREPI1",60,0)
 ..S $P(LRNLT,LRCS,2)=$P(^LAM(LRINLT,0),U,1)
"RTN","LREPI1",61,0)
 ..S $P(LRNLT,LRCS,1)=$P(^LAM(LRINLT,0),U,2)
"RTN","LREPI1",62,0)
 ..S $P(LRNLT,LRCS,3)="VANLT"
"RTN","LREPI1",63,0)
 .S $P(LRDATA,HLFS,3)=LRNLT_LRTST_LRCS_$P(^LAB(60,LRTST,0),U)_LRCS_"VA60"
"RTN","LREPI1",64,0)
 .;ADD LOINC
"RTN","LREPI1",65,0)
 .S LRLOINC=$P($P(LRES,U,3),"!",3),LRLNCNAM=""
"RTN","LREPI1",66,0)
 .S:LRLOINC'="" LRLNCNAM=$E($P($G(^LAB(95.3,LRLOINC,80)),U),1,30)
"RTN","LREPI1",67,0)
 .S $P(LRDATA,HLFS,3)=$P(LRDATA,HLFS,3)_LRCS_LRLOINC_LRCS_LRLNCNAM_LRCS_"LOINC"
"RTN","LREPI1",68,0)
 .S $P(LRDATA,HLFS,5)=$P(LRES,U,1),$P(LRDATA,HLFS,8)=$P(LRES,U,2)
"RTN","LREPI1",69,0)
 .S $P(LRDATA,HLFS,6)=LRUNIT,$P(LRDATA,HLFS,7)=LRREF
"RTN","LREPI1",70,0)
 .S $P(LRDATA,HLFS,14)=LRRDTE
"RTN","LREPI1",71,0)
 .S CNT=CNT+1,SEQX=SEQX+1,^TMP("HL7",$J,CNT)="OBX"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",72,0)
 K LRLNCNAM,LRLOINC
"RTN","LREPI1",73,0)
 Q
"RTN","LREPI1",74,0)
MI ;TO BUILD INITIAL OBR SEGMENT FOR MICRO
"RTN","LREPI1",75,0)
 I '$D(^LR(LRDFN,SS,IVDT,0)) Q
"RTN","LREPI1",76,0)
 K LRDATA
"RTN","LREPI1",77,0)
 S $P(LRDATA,HLFS,1)=$G(SEQ)
"RTN","LREPI1",78,0)
 S $P(LRDATA,HLFS,4)="87999.0000"_LRCS_"MICRO CULTURE"_LRCS_"VANLT"
"RTN","LREPI1",79,0)
 S $P(LRDATA,HLFS,7)=$$HLDATE^HLFNC(9999999-IVDT)
"RTN","LREPI1",80,0)
 S $P(LRDATA,HLFS,18)=$P(^LR(LRDFN,SS,IVDT,0),U,6)
"RTN","LREPI1",81,0)
 S SITE=$P(^LR(LRDFN,SS,IVDT,0),U,5)
"RTN","LREPI1",82,0)
 D SITECD
"RTN","LREPI1",83,0)
 S $P(LRDATA,HLFS,15)=LRCODE_LRCS_LRCS_$P($G(^LAB(61,SITE,0)),U)
"RTN","LREPI1",84,0)
 S ^TMP("HL7",$J,CNT)="OBR"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",85,0)
 ;LOOK INTO ALL MICRO SUB NODES FOR DATA AND BUILD FIRST OBX 
"RTN","LREPI1",86,0)
 F ND=3,6,9,12,17  I $D(^LR(LRDFN,SS,IVDT,ND,0)) D TYPE,MIORG
"RTN","LREPI1",87,0)
 ;SECOND LOOP TO BUILD SECONDARY OBR AND OBX
"RTN","LREPI1",88,0)
 F ND=3,12  I $D(^LR(LRDFN,SS,IVDT,ND,0)) D TYPE,@("SEC"_ND)
"RTN","LREPI1",89,0)
 Q
"RTN","LREPI1",90,0)
TYPE ;DETERMINES THE CORRECT NLT CODE TO USE 
"RTN","LREPI1",91,0)
 S:ND=3 TYPE="87993.0000"_LRCS_"BACTERIOLOGY CULTURE"_LRCS_"VANLT"
"RTN","LREPI1",92,0)
 S:ND=6 TYPE="87505.0000"_LRCS_"PARASITOLOGY"_LRCS_"VANLT"
"RTN","LREPI1",93,0)
 S:ND=9 TYPE="87994.0000"_LRCS_"MYCOLOGY CULTURE"_LRCS_"VANLT"
"RTN","LREPI1",94,0)
 S:ND=12 TYPE="87995.0000"_LRCS_"MYCOBACTERIUM CULTURE"_LRCS_"VANLT"
"RTN","LREPI1",95,0)
 S:ND=17 TYPE="87996.0000"_LRCS_"VIROLOGY CULTURE"_LRCS_"VANLT"
"RTN","LREPI1",96,0)
 Q
"RTN","LREPI1",97,0)
 ;
"RTN","LREPI1",98,0)
MIORG ;TO BUILD ORGANISM OBX SEGMENT FOR MICRO
"RTN","LREPI1",99,0)
 S ORGNB=0 F  S ORGNB=$O(^LR(LRDFN,SS,IVDT,ND,ORGNB)) Q:+ORGNB'>0  D
"RTN","LREPI1",100,0)
 .Q:'$D(^LR(LRDFN,SS,IVDT,ND,ORGNB,0))
"RTN","LREPI1",101,0)
 .S LRRDTE=""
"RTN","LREPI1",102,0)
 .S:ND=3 LRRDTE=+$P($G(^LR(LRDFN,SS,IVDT,1)),U,1)
"RTN","LREPI1",103,0)
 .S:ND'=3 LRRDTE=+$P($G(^LR(LRDFN,SS,IVDT,(ND-1))),U,1)
"RTN","LREPI1",104,0)
 .S:+LRRDTE>0 LRRDTE=$$HLDATE^HLFNC(LRRDTE)
"RTN","LREPI1",105,0)
 .S ORGPT=+$P($G(^LR(LRDFN,SS,IVDT,ND,ORGNB,0)),U,1)
"RTN","LREPI1",106,0)
 .Q:'$D(^LAB(61.2,ORGPT,0))
"RTN","LREPI1",107,0)
 .K LRDATA
"RTN","LREPI1",108,0)
 .S $P(LRDATA,HLFS,1)=ORGNB,$P(LRDATA,HLFS,2)="CE"
"RTN","LREPI1",109,0)
 .S $P(LRDATA,HLFS,3)=TYPE
"RTN","LREPI1",110,0)
 .S $P(LRDATA,HLFS,4)=ORGNB
"RTN","LREPI1",111,0)
 .S $P(LRDATA,HLFS,14)=LRRDTE
"RTN","LREPI1",112,0)
 .S $P(LRDATA,HLFS,5)=LRCS_$P(^LAB(61.2,ORGPT,0),U,1)
"RTN","LREPI1",113,0)
 .S CNT=CNT+1,^TMP("HL7",$J,CNT)="OBX"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",114,0)
 Q
"RTN","LREPI1",115,0)
SEC3 ;BUILD SUSCEPTIBILTY FOR ORGANISMS
"RTN","LREPI1",116,0)
 ;FIRST BUILD OBR THEN OBX FOR THE ANTIMICROBIAL TESTING
"RTN","LREPI1",117,0)
 S ORGNB=0 F  S ORGNB=$O(^LR(LRDFN,SS,IVDT,ND,ORGNB)) Q:+ORGNB'>0  D
"RTN","LREPI1",118,0)
 .Q:'$D(^LR(LRDFN,SS,IVDT,ND,ORGNB,0))
"RTN","LREPI1",119,0)
 .;CHECK TO SEE IF ANY ANTIMICROBIAL INFORMATION BEFORE PROCEEDING
"RTN","LREPI1",120,0)
 .S LRAND=1,LRANDFG=1
"RTN","LREPI1",121,0)
 .F  S LRAND=$O(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND)) Q:+LRAND'>0  D
"RTN","LREPI1",122,0)
 ..Q:'$D(^LAB(62.06,"AD",LRAND))
"RTN","LREPI1",123,0)
 ..S:$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U,2)'="" LRANDFG=0
"RTN","LREPI1",124,0)
 .Q:LRANDFG
"RTN","LREPI1",125,0)
 .K LRDATA,LRANDFG S SEQ=SEQ+1
"RTN","LREPI1",126,0)
 .S $P(LRDATA,HLFS,1)=SEQ
"RTN","LREPI1",127,0)
 .S $P(LRDATA,HLFS,4)="87518.0000"_LRCS_"ANTIBIOTIC MIC"_LRCS_"VANLT"
"RTN","LREPI1",128,0)
 .S $P(LRDATA,HLFS,26)=$P(TYPE,LRCS,1)_LRCS_ORGNB
"RTN","LREPI1",129,0)
 .S $P(LRDATA,HLFS,7)=$$HLDATE^HLFNC(9999999-IVDT)
"RTN","LREPI1",130,0)
 .S SITE=$P(^LR(LRDFN,SS,IVDT,0),U,5)
"RTN","LREPI1",131,0)
 .D SITECD
"RTN","LREPI1",132,0)
 .S $P(LRDATA,HLFS,15)=LRCODE_LRCS_LRCS_$P($G(^LAB(61,SITE,0)),U)
"RTN","LREPI1",133,0)
 .S CNT=CNT+1,^TMP("HL7",$J,CNT)="OBR"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",134,0)
ANTI3 .;NOW GET ANTIMICROBIAL INFORMATION
"RTN","LREPI1",135,0)
 .S SEQX=1,LRAND=1
"RTN","LREPI1",136,0)
 .F  S LRAND=$O(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND)) Q:+LRAND'>0  D
"RTN","LREPI1",137,0)
 ..Q:'$D(^LAB(62.06,"AD",LRAND))
"RTN","LREPI1",138,0)
 ..Q:$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U,2)=""
"RTN","LREPI1",139,0)
 ..K LRDATA
"RTN","LREPI1",140,0)
 ..S LRANT=$O(^LAB(62.06,"AD",LRAND,0))
"RTN","LREPI1",141,0)
 ..S $P(LRDATA,HLFS,1)=SEQX,$P(LRDATA,HLFS,2)="ST"
"RTN","LREPI1",142,0)
 ..S NLT=LRCS_LRCS_LRCS_LRANT_LRCS_$P(^LAB(62.06,LRANT,0),U,1)_LRCS_"VA62.06"
"RTN","LREPI1",143,0)
 ..S NLTP=+$G(^LAB(62.06,LRANT,64))
"RTN","LREPI1",144,0)
 ..S:$D(^LAM(NLTP,0)) $P(NLT,LRCS,1)=$P(^LAM(NLTP,0),U,2),$P(NLT,LRCS,2)=$P($P(^LAM(NLTP,0),U,1),LRCS),$P(NLT,LRCS,3)="VANLT"
"RTN","LREPI1",145,0)
 ..S $P(LRDATA,HLFS,3)=NLT
"RTN","LREPI1",146,0)
 ..S $P(LRDATA,HLFS,5)=$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U)
"RTN","LREPI1",147,0)
 ..S $P(LRDATA,HLFS,8)=$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U,2)
"RTN","LREPI1",148,0)
 ..S SEQX=SEQX+1,CNT=CNT+1,^TMP("HL7",$J,CNT)="OBX"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",149,0)
 Q
"RTN","LREPI1",150,0)
SEC12 ;
"RTN","LREPI1",151,0)
 ;FIRST BUILD OBR THEN OBX FOR THE ANTIMICROBIAL TESTING
"RTN","LREPI1",152,0)
 S ORGNB=0 F  S ORGNB=$O(^LR(LRDFN,SS,IVDT,ND,ORGNB)) Q:+ORGNB'>0  D
"RTN","LREPI1",153,0)
 .Q:'$D(^LR(LRDFN,SS,IVDT,ND,ORGNB,0))
"RTN","LREPI1",154,0)
 .;FIRST CHECK FOR ANTIMICROBIAL INFORMATION
"RTN","LREPI1",155,0)
 .S LRAND=1,LRANDFG=1
"RTN","LREPI1",156,0)
 .F  S LRAND=$O(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND)) Q:+LRAND'>0  D
"RTN","LREPI1",157,0)
 ..S:$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U,2)'="" LRANDFG=0
"RTN","LREPI1",158,0)
 .Q:LRANDFG
"RTN","LREPI1",159,0)
 .K LRDATA,LRANDFG S SEQ=SEQ+1
"RTN","LREPI1",160,0)
 .S $P(LRDATA,HLFS,1)=SEQ
"RTN","LREPI1",161,0)
 .S $P(LRDATA,HLFS,4)="87518.0000"_LRCS_"ANTIBIOTIC MIC"_LRCS_"VANLT"
"RTN","LREPI1",162,0)
 .S $P(LRDATA,HLFS,26)=$P(TYPE,LRCS,1)_LRCS_ORGNB
"RTN","LREPI1",163,0)
 .S $P(LRDATA,HLFS,7)=$$HLDATE^HLFNC(9999999-IVDT)
"RTN","LREPI1",164,0)
 .S SITE=$P(^LR(LRDFN,SS,IVDT,0),U,5)
"RTN","LREPI1",165,0)
 .D SITECD
"RTN","LREPI1",166,0)
 .S $P(LRDATA,HLFS,15)=LRCODE_LRCS_LRCS_$P($G(^LAB(61,SITE,0)),U)
"RTN","LREPI1",167,0)
 .S CNT=CNT+1,^TMP("HL7",$J,CNT)="OBR"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",168,0)
ANTI12 .;NOW GET ANTIMICROBIAL INFORMATION FOR THE MYCOBACTERIUM
"RTN","LREPI1",169,0)
 .S SEQX=1,LRAND=1
"RTN","LREPI1",170,0)
 .F  S LRAND=$O(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND)) Q:+LRAND'>0  D
"RTN","LREPI1",171,0)
 ..Q:$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U,2)=""
"RTN","LREPI1",172,0)
 ..K LRDATA
"RTN","LREPI1",173,0)
 ..S LRNT=$O(^DD(63.39,"GL",LRAND,1,0))
"RTN","LREPI1",174,0)
 .. S LRFILE=63.39,LRFLD=LRNT,LRANT=$$GET1^DID(LRFILE,LRFLD,"","TITLE","","LRERR")
"RTN","LREPI1",175,0)
 ..;S LRANT=$P($G(^DD(63.39,LRNT,.1)),U,1)replaced w/supported reference
"RTN","LREPI1",176,0)
 ..S:LRANT="" LRANT=$P(^DD(63.39,LRNT,0),U,1)
"RTN","LREPI1",177,0)
 ..S $P(LRDATA,HLFS,1)=SEQX,$P(LRDATA,HLFS,2)="ST"
"RTN","LREPI1",178,0)
 ..S $P(LRDATA,HLFS,3)=LRCS_LRCS_LRCS_LRAND_LRCS_LRANT_LRCS_"VA63.39"
"RTN","LREPI1",179,0)
 ..S $P(LRDATA,HLFS,5)=$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U)
"RTN","LREPI1",180,0)
 ..S $P(LRDATA,HLFS,8)=$P(^LR(LRDFN,SS,IVDT,ND,ORGNB,LRAND),U,2)
"RTN","LREPI1",181,0)
 ..S SEQX=SEQX+1,CNT=CNT+1,^TMP("HL7",$J,CNT)="OBX"_HLFS_$$UP^XLFSTR(LRDATA)
"RTN","LREPI1",182,0)
 Q
"RTN","LREPI2")
0^7^B32621324
"RTN","LREPI2",1,0)
LREPI2 ;DALOI/SED-EMERGING PATHOGENS HL7 BUILD ;5/1/98
"RTN","LREPI2",2,0)
 ;;5.2;LAB SERVICE;**132,157,175,242,260,281**;Sep 27, 1994
"RTN","LREPI2",3,0)
 ;
"RTN","LREPI2",4,0)
START ;START WITH THE PROTOCOL USED
"RTN","LREPI2",5,0)
 S LRPROT=0 F  S LRPROT=$O(^TMP($J,LRPROT)) Q:+LRPROT'>0  D
"RTN","LREPI2",6,0)
 .D INIT^HLFNC2(LRPROT,.HL)
"RTN","LREPI2",7,0)
 .S LRCS=$E(HL("ECH")),LRMSGNM=1,LRMSGSZ=0
"RTN","LREPI2",8,0)
 .S LRMSGDF=$S(+$P($G(^LAB(69.4,LRPROT,0)),U,3)>0:+$P($G(^LAB(69.4,LRPROT,0)),U,3),1:30000)
"RTN","LREPI2",9,0)
 .D EN I LRMSGSZ D MOVE,SEND
"RTN","LREPI2",10,0)
 .F LRTND="ETI","TST","HEP" D:$D(^TMP($J,LRTND)) TOTAL
"RTN","LREPI2",11,0)
 .D SEND,ALERT
"RTN","LREPI2",12,0)
 D REPORT^LREPIRP
"RTN","LREPI2",13,0)
 K ^TMP("HLS",$J)
"RTN","LREPI2",14,0)
 K LRMSGDF,LRMSGNM,LRMSGSZ,%,%X
"RTN","LREPI2",15,0)
 Q
"RTN","LREPI2",16,0)
ALERT ;Send a Alert if desired.
"RTN","LREPI2",17,0)
 K XQA,XQAMSG,XQAOPT,XQAROU,XQAID,XQADATA,XQAFLAG
"RTN","LREPI2",18,0)
 Q:+$G(LRRTYPE)=1
"RTN","LREPI2",19,0)
 S X="NOW",%DT="SRT" D ^%DT,DD^%DT
"RTN","LREPI2",20,0)
 S XQAMSG=$P(^LAB(69.4,LRPROT,0),U,5)_" Was processed at "_Y
"RTN","LREPI2",21,0)
 ;GET THE DUZ'S FOR ALERTS
"RTN","LREPI2",22,0)
 S LRIEN=0 F  S LRIEN=$O(^LAB(69.4,LRPROT,1,LRIEN)) Q:+LRIEN'>0  D
"RTN","LREPI2",23,0)
 .S LRDATA=$G(^LAB(69.4,LRPROT,1,LRIEN,0))
"RTN","LREPI2",24,0)
 .I $P(LRDATA,";",2)["VA(200" S XQA($P(LRDATA,";",1))=""
"RTN","LREPI2",25,0)
 .I $P(LRDATA,";",2)["XMB(3.8" D
"RTN","LREPI2",26,0)
 ..S LRMG=$P(LRDATA,";",1) ;Q:'$D(^XMB(3.8,LRMG))
"RTN","LREPI2",27,0)
 ..S LRMGN=$$GET1^DIQ(69.4,LRMG,1) Q:LRMGN=""
"RTN","LREPI2",28,0)
 ..S X=LRMGN,XMDUZ=DUZ D INST^XMA21
"RTN","LREPI2",29,0)
 ..;S LRDUZ=0 F  S LRDUZ=$O(^XMB(3.8,LRMG,1,"B",LRDUZ)) Q:+LRDUZ'>0  S XQA(LRDUZ)=""
"RTN","LREPI2",30,0)
 Q:'$D(XQA)
"RTN","LREPI2",31,0)
 D SETUP^XQALERT
"RTN","LREPI2",32,0)
 Q
"RTN","LREPI2",33,0)
SEND ;SEND THE HL7 MESSAGE
"RTN","LREPI2",34,0)
 D HEAD
"RTN","LREPI2",35,0)
 N HLP
"RTN","LREPI2",36,0)
 S HLP("NAMESPACE")="LR"
"RTN","LREPI2",37,0)
 D GENERATE^HLMA(LRPROT,"GM",1,.HLRST,"",.HLP)
"RTN","LREPI2",38,0)
 S LRMSGNM=LRMSGNM+1,LRMSGSZ=0
"RTN","LREPI2",39,0)
 K ^TMP("HLS",$J)
"RTN","LREPI2",40,0)
 Q
"RTN","LREPI2",41,0)
EN ;ENTRY TO BUILD A MESSAGE
"RTN","LREPI2",42,0)
 S (LRCNT,LRPID)=1,DFN=0
"RTN","LREPI2",43,0)
 F  S DFN=$O(^TMP($J,LRPROT,DFN)) Q:+DFN'>0  D
"RTN","LREPI2",44,0)
 .I LRMSGSZ>5000 D MOVE,SEND
"RTN","LREPI2",45,0)
 .D PID^LREPI3
"RTN","LREPI2",46,0)
 .S LRPV1=1,LRENDT=0,LRPFG="",LREFG=0,LRPVVV=0
"RTN","LREPI2",47,0)
 .F  S LRENDT=$O(^TMP($J,LRPROT,DFN,LRENDT)) S LRPFG="" Q:+LRENDT'>0!(LREFG)  D
"RTN","LREPI2",48,0)
 ..D PV1
"RTN","LREPI2",49,0)
 ..I $D(^TMP("LREPISRCH",$J,DFN)),LRPROT=LRPROTX D RXNT^LREPIPH
"RTN","LREPI2",50,0)
 ..S LRPATH=0,LRNTE=1,LRPVVV=1
"RTN","LREPI2",51,0)
 ..F  S LRPATH=$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH)) Q:+LRPATH'>0!(LREFG)  D
"RTN","LREPI2",52,0)
 ...D:LRPFG'=LRPATH NTE^LREPI3
"RTN","LREPI2",53,0)
 ...S LRPFG=LRPATH,LROBR=1,LRINVD=0
"RTN","LREPI2",54,0)
 ...F  S LRINVD=$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH,LRINVD)) Q:+LRINVD'>0!(LREFG)  D
"RTN","LREPI2",55,0)
 ....S LRND=""
"RTN","LREPI2",56,0)
 ....F  S LRND=$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH,LRINVD,LRND)) Q:LRND=""!(LREFG)  D
"RTN","LREPI2",57,0)
 .....S LRDFN=$$LRDFN^LR7OR1(DFN) Q:'LRDFN
"RTN","LREPI2",58,0)
 .....S LREFG=+$P($G(^LAB(69.5,LRPATH,0)),U,6)
"RTN","LREPI2",59,0)
 .....S:LRND'="PTF" LROBR=$$EN^LREPI1(LRDFN,LRND,LRINVD,LROBR)+1
"RTN","LREPI2",60,0)
 .....D:LRND="PTF" DG1^LREPI3
"RTN","LREPI2",61,0)
 .....D MOVE
"RTN","LREPI2",62,0)
 Q
"RTN","LREPI2",63,0)
TOTAL ;Report the total counts  ->    "ETI" or "TST" or "HEP"
"RTN","LREPI2",64,0)
 ;                                \/
"RTN","LREPI2",65,0)
 S LRITN=0 F  S LRITN=$O(^TMP($J,LRTND,LRITN)) Q:+LRITN'>0  D
"RTN","LREPI2",66,0)
 .S (LRNLT,LRTNM)=""
"RTN","LREPI2",67,0)
 .I LRTND="TST" D
"RTN","LREPI2",68,0)
 ..I '$D(^TMP($J,"TPROT",LRITN,LRPROT)) QUIT
"RTN","LREPI2",69,0)
 ..S LRTNM=$P($G(^LAB(60,LRITN,0)),U,1)
"RTN","LREPI2",70,0)
 ..S LRNL=$G(^LAB(60,LRITN,64)) Q:+LRNL'>0
"RTN","LREPI2",71,0)
 ..Q:'$D(^LAM(LRNL,0))
"RTN","LREPI2",72,0)
 ..S LRNLT=$P(^LAM(LRNL,0),U,2)
"RTN","LREPI2",73,0)
 .I LRTND="ETI" D
"RTN","LREPI2",74,0)
 ..I '$D(^TMP($J,"EPROT",LRITN)) QUIT
"RTN","LREPI2",75,0)
 ..S LRTNM=$P($G(^LAB(61.2,LRITN,0)),U,1)
"RTN","LREPI2",76,0)
 ..S LRNL=$G(^LAB(61.2,LRITN,64)) Q:+LRNL'>0
"RTN","LREPI2",77,0)
 ..Q:'$D(^LAM(LRNL,0))
"RTN","LREPI2",78,0)
 ..S LRNLT=$P(^LAM(LRNL,0),U,2)
"RTN","LREPI2",79,0)
 .I LRTND="STOT" D
"RTN","LREPI2",80,0)
 ..I '$D(^TMP($J,"SPROT",LRITN,LRPROT)) QUIT
"RTN","LREPI2",81,0)
 ..S LRTNM=""
"RTN","LREPI2",82,0)
 ..S LRNL=LRITN
"RTN","LREPI2",83,0)
 ..S LRNLT=""
"RTN","LREPI2",84,0)
 .I LRTND="HEP" D
"RTN","LREPI2",85,0)
 ..I '$D(^TMP($J,"HEP",LRITN)) QUIT
"RTN","LREPI2",86,0)
 ..S LRNLT=""
"RTN","LREPI2",87,0)
 ..I LRITN=1 S LRTNM="1-Declined Assessment for Hepatitis C"
"RTN","LREPI2",88,0)
 ..I LRITN=2 S LRTNM="2-No Risk Factors for Hepatitis C"
"RTN","LREPI2",89,0)
 ..I LRITN=3 S LRTNM="3-Previously Assessed for Hepatitis C"
"RTN","LREPI2",90,0)
 ..I LRITN=4 S LRTNM="4-Risk Factors for Hepatitis C"
"RTN","LREPI2",91,0)
 ..I LRITN=5 S LRTNM="5-Positive Test for Hepatitis C antibody"
"RTN","LREPI2",92,0)
 ..I LRITN=6 S LRTNM="6-Negative Test for Hepatitis C antibody"
"RTN","LREPI2",93,0)
 ..I LRITN=7 S LRTNM="7- Hepatitis C diagnosis (ICD-9 based)"
"RTN","LREPI2",94,0)
 .K LRDATA
"RTN","LREPI2",95,0)
 .I '$G(LRTNM) D NAME
"RTN","LREPI2",96,0)
 .S LRDATA="NTE"_HLFS_HLFS_"T"_LRCS_LRNLT_LRCS_LRTNM_LRCS_+^TMP($J,LRTND,LRITN)
"RTN","LREPI2",97,0)
 .S LRCNT=LRCNT+1
"RTN","LREPI2",98,0)
 .S ^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2",99,0)
 .S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2",100,0)
 .K LRDATA
"RTN","LREPI2",101,0)
 .S (LRPCNT,LRPTOT)=0
"RTN","LREPI2",102,0)
 .F  S LRPCNT=$O(^TMP($J,LRTND,LRITN,LRPCNT)) Q:+LRPCNT'>0  S LRPTOT=LRPTOT+1
"RTN","LREPI2",103,0)
 .Q:LRPTOT'>0
"RTN","LREPI2",104,0)
 .I '$G(LRTNM) D NAME
"RTN","LREPI2",105,0)
 .S LRDATA="NTE"_HLFS_HLFS_"T"_LRCS_LRNLT_LRCS_"PATIENTS WITH "_LRTNM_LRCS_LRPTOT ;+^TMP($J,LRPCNT,LRITN)
"RTN","LREPI2",106,0)
 .S LRCNT=LRCNT+1
"RTN","LREPI2",107,0)
 .S ^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2",108,0)
 .S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2",109,0)
 Q
"RTN","LREPI2",110,0)
NAME ;
"RTN","LREPI2",111,0)
 Q:LRTND'="TST"
"RTN","LREPI2",112,0)
 S LRTNM=$P($G(^LAB(60,LRITN,0)),U,1)
"RTN","LREPI2",113,0)
 S LRNL=$G(^LAB(60,LRITN,64)) Q:+LRNL'>0
"RTN","LREPI2",114,0)
 Q:'$D(^LAM(LRNL,0))
"RTN","LREPI2",115,0)
 S LRNLT=$P(^LAM(LRNL,0),U,2)
"RTN","LREPI2",116,0)
 ;
"RTN","LREPI2",117,0)
 QUIT
"RTN","LREPI2",118,0)
HEAD ;ENTER A NTE FOR REPORT HEADER
"RTN","LREPI2",119,0)
 K LRDATA
"RTN","LREPI2",120,0)
 S LRDATA="NTE"_HLFS_HLFS_$S(LRRTYPE:"R",1:"")_LRCS
"RTN","LREPI2",121,0)
 I $G(LR31799Z)=1 S LRDATA=LRDATA_"*** H E P A T I T I S  C  MARCH 17 1999 ***"
"RTN","LREPI2",122,0)
 S LRDATA=LRDATA_"REPORTING DATE FROM "_$$HLDATE^HLFNC(LRRPS)
"RTN","LREPI2",123,0)
 S LRDATA=LRDATA_" TO "_$$HLDATE^HLFNC(LRRPE)
"RTN","LREPI2",124,0)
 S LRDATA=LRDATA_LRCS_LRMSGNM
"RTN","LREPI2",125,0)
 I LRPROTX=LRPROT S LRDATA=LRDATA_LRCS_LRCS_"V3"
"RTN","LREPI2",126,0)
 I '$O(^TMP("HLS",$J,1)) S LRDATA=LRDATA_LRCS_"N"
"RTN","LREPI2",127,0)
 S ^TMP("HLS",$J,1)=$$UP^XLFSTR(LRDATA),LRMSGSZ=LRMSGSZ+$L(LRDATA)
"RTN","LREPI2",128,0)
 S ^TMP("LREPIREP",$J,1)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2",129,0)
 K LRDATA
"RTN","LREPI2",130,0)
 Q
"RTN","LREPI2",131,0)
MOVE S LRMOVE=0
"RTN","LREPI2",132,0)
 F  S LRMOVE=$O(^TMP("HL7",$J,LRMOVE)) Q:+LRMOVE'>0  D
"RTN","LREPI2",133,0)
 .S LRCNT=LRCNT+1
"RTN","LREPI2",134,0)
 .S ^TMP("HLS",$J,LRCNT)=^TMP("HL7",$J,LRMOVE)
"RTN","LREPI2",135,0)
 .S ^TMP("LREPIREP",$J,LRCNT)=^TMP("HL7",$J,LRMOVE)
"RTN","LREPI2",136,0)
 .S LRMSGSZ=LRMSGSZ+$L(^TMP("HL7",$J,LRMOVE))
"RTN","LREPI2",137,0)
 K ^TMP("HL7",$J),LRMOVE
"RTN","LREPI2",138,0)
 Q
"RTN","LREPI2",139,0)
 ;
"RTN","LREPI2",140,0)
PV1 ;
"RTN","LREPI2",141,0)
 ;I $O(^TMP($J,LRPROT,DFN,LRENDT,""))!('$D(^TMP("LREPISRCH",$J,DFN)))!($P(LRNDTDA,"^",3))="UPDT" D PV1^LREPI3 S LRPVVV=1
"RTN","LREPI2",142,0)
 I LRPV1>1,$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH))="",$P($G(^TMP($J,LRPROT,DFN,LRENDT)),"^",3)'="UPDT" Q
"RTN","LREPI2",143,0)
 I $P($G(^TMP($J,LRPROT,DFN,LRENDT)),"^",3)="UPDT" D PV1^LREPI3 S LRPVVV=1 Q
"RTN","LREPI2",144,0)
 I $O(^TMP($J,LRPROT,DFN,LRENDT,""))]"" D PV1^LREPI3 S LRPVVV=1 Q
"RTN","LREPI2",145,0)
 I '$D(^TMP("LREPISRCH",$J,DFN)) D PV1^LREPI3 S LRPVVV=1 Q
"RTN","LREPI2A")
0^8^B25858178
"RTN","LREPI2A",1,0)
LREPI2A ;DALOI/CKA-EMERGING PATHOGENS HL7 BUILD ;5/14/03
"RTN","LREPI2A",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPI2A",3,0)
 ;
"RTN","LREPI2A",4,0)
START ;START
"RTN","LREPI2A",5,0)
 S LRPROT=0 F  S LRPROT=$O(^TMP($J,LRPROT)) Q:+LRPROT'>0  D
"RTN","LREPI2A",6,0)
 .D INIT^HLFNC2(LRPROT,.HL)
"RTN","LREPI2A",7,0)
 .S LRMSGNM=1,LRMSGSZ=0,LRCS=$E(HL("ECH"))
"RTN","LREPI2A",8,0)
 .S LRMSGDF=$S(+$P($G(^LAB(69.4,LRPROT,0)),U,3)>0:+$P($G(^LAB(69.4,LRPROT,0)),U,3),1:30000)
"RTN","LREPI2A",9,0)
 .D EN,MOVE
"RTN","LREPI2A",10,0)
 .F LRTND="ETI","TST","HEP" D:$D(^TMP($J,LRTND)) TOTAL
"RTN","LREPI2A",11,0)
 .D EN,MOVE,SEND
"RTN","LREPI2A",12,0)
 .D ALERT
"RTN","LREPI2A",13,0)
 K LRDUZ,LRMSGDF,%,%X
"RTN","LREPI2A",14,0)
 Q
"RTN","LREPI2A",15,0)
SEND ;BUILD MESSAGE BUT DON'T SEND
"RTN","LREPI2A",16,0)
 D HEAD
"RTN","LREPI2A",17,0)
 I LRREP=2 D SPSHT^LREPIRS3 S ^XTMP("LREPILOCALSPSHT"_LRLRDT,"DONE")=1
"RTN","LREPI2A",18,0)
 I LRREP=1 D REPORT^LREPIRS1 S ^XTMP("LREPILOCALREP"_LRLRDT,"DONE")=1
"RTN","LREPI2A",19,0)
 K ^TMP("HLS",$J)
"RTN","LREPI2A",20,0)
 K LRLC,LRHDGLC,HLFS,LRSEG,LRSPSHT,MSG,LRPID,LROBR,LRX
"RTN","LREPI2A",21,0)
 Q
"RTN","LREPI2A",22,0)
ALERT ;Send a Alert if desired.
"RTN","LREPI2A",23,0)
 K XQA,XQAMSG,XQAOPT,XQAROU,XQAID,XQADATA,XQAFLAG
"RTN","LREPI2A",24,0)
 S X="NOW",%DT="SRT" D ^%DT,DD^%DT
"RTN","LREPI2A",25,0)
 S XQAMSG="The local report/spreadsheet finished generating at "_Y
"RTN","LREPI2A",26,0)
 S XQA(LRDUZ)=""
"RTN","LREPI2A",27,0)
 Q:'$D(XQA)
"RTN","LREPI2A",28,0)
 D SETUP^XQALERT
"RTN","LREPI2A",29,0)
 Q
"RTN","LREPI2A",30,0)
EN ;ENTRY TO BUILD A MESSAGE
"RTN","LREPI2A",31,0)
 S (LRCNT,LRPID)=1,DFN=0
"RTN","LREPI2A",32,0)
 F  S DFN=$O(^TMP($J,LRPROT,DFN)) Q:+DFN'>0  D
"RTN","LREPI2A",33,0)
 .D PID^LREPI3
"RTN","LREPI2A",34,0)
 .S LRPV1=1,LRENDT=0,LRPFG="",LREFG=0,LRPVVV=0
"RTN","LREPI2A",35,0)
 .F  S LRENDT=$O(^TMP($J,LRPROT,DFN,LRENDT)) S LRPFG="" Q:+LRENDT'>0!(LREFG)  D
"RTN","LREPI2A",36,0)
 ..D PV1
"RTN","LREPI2A",37,0)
 ..I $D(^TMP("LREPISRCH",$J,DFN)),LRPROT=LRPROTX D RXNT^LREPIPH
"RTN","LREPI2A",38,0)
 ..S LRPATH=0,LRNTE=1,LRPVVV=1
"RTN","LREPI2A",39,0)
 ..F  S LRPATH=$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH)) Q:+LRPATH'>0!(LREFG)  D
"RTN","LREPI2A",40,0)
 ...D:LRPFG'=LRPATH NTE^LREPI3
"RTN","LREPI2A",41,0)
 ...S LRPFG=LRPATH,LROBR=1,LRINVD=0
"RTN","LREPI2A",42,0)
 ...F  S LRINVD=$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH,LRINVD)) Q:+LRINVD'>0!(LREFG)  D
"RTN","LREPI2A",43,0)
 ....S LRND=""
"RTN","LREPI2A",44,0)
 ....F  S LRND=$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH,LRINVD,LRND)) Q:LRND=""!(LREFG)  D
"RTN","LREPI2A",45,0)
 .....S LRDFN=$$LRDFN^LR7OR1(DFN) Q:'LRDFN
"RTN","LREPI2A",46,0)
 .....S LREFG=+$P($G(^LAB(69.5,LRPATH,0)),U,6)
"RTN","LREPI2A",47,0)
 .....S:LRND'="PTF" LROBR=$$EN^LREPI1(LRDFN,LRND,LRINVD,LROBR)+1
"RTN","LREPI2A",48,0)
 .....D:LRND="PTF" DG1^LREPI3
"RTN","LREPI2A",49,0)
 .....D MOVE
"RTN","LREPI2A",50,0)
 Q
"RTN","LREPI2A",51,0)
TOTAL ;Report the total counts  ->    "ETI" or "TST" or "HEP"
"RTN","LREPI2A",52,0)
 ;                                \/
"RTN","LREPI2A",53,0)
 S LRITN=0 F  S LRITN=$O(^TMP($J,LRTND,LRITN)) Q:+LRITN'>0  D
"RTN","LREPI2A",54,0)
 .S (LRNLT,LRTNM)=""
"RTN","LREPI2A",55,0)
 .I LRTND="TST" D
"RTN","LREPI2A",56,0)
 ..I '$D(^TMP($J,"TPROT",LRITN,LRPROT)) QUIT
"RTN","LREPI2A",57,0)
 ..S LRTNM=$P($G(^LAB(60,LRITN,0)),U,1)
"RTN","LREPI2A",58,0)
 ..S LRNL=$G(^LAB(60,LRITN,64)) Q:+LRNL'>0
"RTN","LREPI2A",59,0)
 ..Q:'$D(^LAM(LRNL,0))
"RTN","LREPI2A",60,0)
 ..S LRNLT=$P(^LAM(LRNL,0),U,2)
"RTN","LREPI2A",61,0)
 .I LRTND="ETI" D
"RTN","LREPI2A",62,0)
 ..I '$D(^TMP($J,"EPROT",LRITN)) QUIT
"RTN","LREPI2A",63,0)
 ..S LRTNM=$P($G(^LAB(61.2,LRITN,0)),U,1)
"RTN","LREPI2A",64,0)
 ..S LRNL=$G(^LAB(61.2,LRITN,64)) Q:+LRNL'>0
"RTN","LREPI2A",65,0)
 ..Q:'$D(^LAM(LRNL,0))
"RTN","LREPI2A",66,0)
 ..S LRNLT=$P(^LAM(LRNL,0),U,2)
"RTN","LREPI2A",67,0)
 .I LRTND="STOT" D
"RTN","LREPI2A",68,0)
 ..I '$D(^TMP($J,"SPROT",LRITN,LRPROT)) QUIT
"RTN","LREPI2A",69,0)
 ..S LRTNM=""
"RTN","LREPI2A",70,0)
 ..S LRNL=LRITN
"RTN","LREPI2A",71,0)
 ..S LRNLT=""
"RTN","LREPI2A",72,0)
 .I LRTND="HEP" D
"RTN","LREPI2A",73,0)
 ..I '$D(^TMP($J,"HEP",LRITN)) QUIT
"RTN","LREPI2A",74,0)
 ..S LRNLT=""
"RTN","LREPI2A",75,0)
 ..I LRITN=1 S LRTNM="1-Declined Assessment for Hepatitis C"
"RTN","LREPI2A",76,0)
 ..I LRITN=2 S LRTNM="2-No Risk Factors for Hepatitis C"
"RTN","LREPI2A",77,0)
 ..I LRITN=3 S LRTNM="3-Previously Assessed for Hepatitis C"
"RTN","LREPI2A",78,0)
 ..I LRITN=4 S LRTNM="4-Risk Factors for Hepatitis C"
"RTN","LREPI2A",79,0)
 ..I LRITN=5 S LRTNM="5-Positive Test for Hepatitis C antibody"
"RTN","LREPI2A",80,0)
 ..I LRITN=6 S LRTNM="6-Negative Test for Hepatitis C antibody"
"RTN","LREPI2A",81,0)
 ..I LRITN=7 S LRTNM="7- Hepatitis C diagnosis (ICD-9 based)"
"RTN","LREPI2A",82,0)
 .K LRDATA
"RTN","LREPI2A",83,0)
 .I '$G(LRTNM) D NAME
"RTN","LREPI2A",84,0)
 .S LRDATA="NTE"_HLFS_HLFS_"T"_LRCS_LRNLT_LRCS_LRTNM_LRCS_+^TMP($J,LRTND,LRITN)
"RTN","LREPI2A",85,0)
 .S LRCNT=LRCNT+1
"RTN","LREPI2A",86,0)
 .S ^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2A",87,0)
 .K LRDATA
"RTN","LREPI2A",88,0)
 .S (LRPCNT,LRPTOT)=0
"RTN","LREPI2A",89,0)
 .F  S LRPCNT=$O(^TMP($J,LRTND,LRITN,LRPCNT)) Q:+LRPCNT'>0  S LRPTOT=LRPTOT+1
"RTN","LREPI2A",90,0)
 .Q:LRPTOT'>0
"RTN","LREPI2A",91,0)
 .I '$G(LRTNM) D NAME
"RTN","LREPI2A",92,0)
 .S LRDATA="NTE"_HLFS_HLFS_"T"_LRCS_LRNLT_LRCS_"PATIENTS WITH "_LRTNM_LRCS_LRPTOT ;+^TMP($J,LRPCNT,LRITN)
"RTN","LREPI2A",93,0)
 .S LRCNT=LRCNT+1
"RTN","LREPI2A",94,0)
 .S ^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2A",95,0)
 Q
"RTN","LREPI2A",96,0)
NAME ;
"RTN","LREPI2A",97,0)
 Q:LRTND'="TST"
"RTN","LREPI2A",98,0)
 S LRTNM=$P($G(^LAB(60,LRITN,0)),U,1)
"RTN","LREPI2A",99,0)
 S LRNL=$G(^LAB(60,LRITN,64)) Q:+LRNL'>0
"RTN","LREPI2A",100,0)
 Q:'$D(^LAM(LRNL,0))
"RTN","LREPI2A",101,0)
 S LRNLT=$P(^LAM(LRNL,0),U,2)
"RTN","LREPI2A",102,0)
 ;
"RTN","LREPI2A",103,0)
 QUIT
"RTN","LREPI2A",104,0)
HEAD ;ENTER A NTE FOR REPORT HEADER
"RTN","LREPI2A",105,0)
 K LRDATA
"RTN","LREPI2A",106,0)
 S LRDATA="NTE"_HLFS_HLFS_$S(LRRTYPE:"R",1:"")_LRCS
"RTN","LREPI2A",107,0)
 I $G(LR31799Z)=1 S LRDATA=LRDATA_"*** H E P A T I T I S  C  MARCH 17 1999 ***"
"RTN","LREPI2A",108,0)
 S LRDATA=LRDATA_"REPORTING DATE FROM "_$$HLDATE^HLFNC(LRRPS)
"RTN","LREPI2A",109,0)
 S LRDATA=LRDATA_" TO "_$$HLDATE^HLFNC(LRRPE)
"RTN","LREPI2A",110,0)
 S LRDATA=LRDATA
"RTN","LREPI2A",111,0)
 I LRPROTX=LRPROT S LRDATA=LRDATA_LRCS_LRCS_"V3"
"RTN","LREPI2A",112,0)
 I '$O(^TMP("HLS",$J,1)) S LRDATA=LRDATA_LRCS_"N"
"RTN","LREPI2A",113,0)
 S ^TMP("HLS",$J,1)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI2A",114,0)
 K LRDATA
"RTN","LREPI2A",115,0)
 Q
"RTN","LREPI2A",116,0)
MOVE S LRMOVE=0
"RTN","LREPI2A",117,0)
 F  S LRMOVE=$O(^TMP("HL7",$J,LRMOVE)) Q:+LRMOVE'>0  D
"RTN","LREPI2A",118,0)
 .S LRCNT=LRCNT+1
"RTN","LREPI2A",119,0)
 .S ^TMP("HLS",$J,LRCNT)=^TMP("HL7",$J,LRMOVE)
"RTN","LREPI2A",120,0)
 K ^TMP("HL7",$J),LRMOVE
"RTN","LREPI2A",121,0)
 Q
"RTN","LREPI2A",122,0)
 ;
"RTN","LREPI2A",123,0)
PV1 ;
"RTN","LREPI2A",124,0)
 ;I $O(^TMP($J,LRPROT,DFN,LRENDT,""))!('$D(^TMP("LREPISRCH",$J,DFN)))!($P(LRNDTDA,"^",3))="UPDT" D PV1^LREPI3 S LRPVVV=1
"RTN","LREPI2A",125,0)
 I LRPV1>1,$O(^TMP($J,LRPROT,DFN,LRENDT,LRPATH))="",$P($G(^TMP($J,LRPROT,DFN,LRENDT)),"^",3)'="UPDT" Q
"RTN","LREPI2A",126,0)
 I $P($G(^TMP($J,LRPROT,DFN,LRENDT)),"^",3)="UPDT" D PV1^LREPI3 S LRPVVV=1 Q
"RTN","LREPI2A",127,0)
 I $O(^TMP($J,LRPROT,DFN,LRENDT,""))]"" D PV1^LREPI3 S LRPVVV=1 Q
"RTN","LREPI2A",128,0)
 I '$D(^TMP("LREPISRCH",$J,DFN)) D PV1^LREPI3 S LRPVVV=1 Q
"RTN","LREPI2A",129,0)
 Q
"RTN","LREPI3")
0^3^B32820558
"RTN","LREPI3",1,0)
LREPI3 ;DALOI/SED-EMERGING PATHOGENS HL7 SEGMENTS ;5/21/98
"RTN","LREPI3",2,0)
 ;;5.2;LAB SERVICE;**132,175,260,281**;Sep 27, 1994
"RTN","LREPI3",3,0)
 ; Reference to ^DGPT supported by IA #418
"RTN","LREPI3",4,0)
 ; Reference to ^SC supported by IA #10040
"RTN","LREPI3",5,0)
 ; Reference to ^DIC(21 supported by IA #913
"RTN","LREPI3",6,0)
 ; Reference to ^ICD9 supported by IA #10082
"RTN","LREPI3",7,0)
 ; Reference to ICN supported by IA #2701
"RTN","LREPI3",8,0)
 ; Reference to VAFHLPID supported by IA # 263
"RTN","LREPI3",9,0)
 ; Reference to VAFHLPV1 supporte by IA # 3018
"RTN","LREPI3",10,0)
 ; Reference to ^DIC(5 supported by IA # 10056
"RTN","LREPI3",11,0)
 ; Reference to $$HOMELESS supported by IA #1528
"RTN","LREPI3",12,0)
 ; Reference to VADPT suppoted by IA #10061
"RTN","LREPI3",13,0)
 ; Reference to ^AUPNVPOV supported by IA # 3094
"RTN","LREPI3",14,0)
 ; Reference to $$STA^XUAF4(IEN) supported by IA #2171
"RTN","LREPI3",15,0)
NTE ;TO BUILD THE NTE SEGMENT TO DEFINE THE EPI
"RTN","LREPI3",16,0)
 S LRDATA="NTE"_HLFS_LRNTE_HLFS_$P(^LAB(69.5,LRPATH,0),U,9)_LRCS_$P(^LAB(69.5,LRPATH,0),U,1)
"RTN","LREPI3",17,0)
 S LRCNT=LRCNT+1,^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI3",18,0)
 S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI3",19,0)
 S LRMSGSZ=LRMSGSZ+$L(LRDATA)
"RTN","LREPI3",20,0)
 S LRNTE=LRNTE+1
"RTN","LREPI3",21,0)
 Q
"RTN","LREPI3",22,0)
DG1 ;BUILD THE DG1 FOR ICD9 CODES
"RTN","LREPI3",23,0)
 K ^TMP($J,"DG1")
"RTN","LREPI3",24,0)
 S IFN=+$G(^TMP($J,LRPROT,DFN,LRENDT,LRPATH,LRINVD,LRND))
"RTN","LREPI3",25,0)
DG11 Q:+IFN'>0
"RTN","LREPI3",26,0)
 Q:'$D(^DGPT(IFN))
"RTN","LREPI3",27,0)
 ;SEARCH FOR LEGIONAIRS HERE
"RTN","LREPI3",28,0)
 I $P($G(^DGPT(IFN,300)),U,3)=1 D
"RTN","LREPI3",29,0)
 .S ICD9=$O(^ICD9("BA","482.80 ",0)) Q:+ICD9'>0
"RTN","LREPI3",30,0)
 .S ^TMP($J,"DG1",ICD9)=$P($G(^DGPT(IFN,70)),"^",10)_"^"_$$HLDATE^HLFNC($P($G(^DGPT(IFN,0)),"^",2))
"RTN","LREPI3",31,0)
 I $D(^DGPT(IFN,70)) F LRI=10,11,16:1:24 D
"RTN","LREPI3",32,0)
 .S ICD9=$P(^DGPT(IFN,70),U,LRI) Q:+ICD9'>0
"RTN","LREPI3",33,0)
 .S ^TMP($J,"DG1",ICD9)=$P($G(^DGPT(IFN,70)),"^",10)_"^"_$$HLDATE^HLFNC($P($G(^DGPT(IFN,0)),"^",2))
"RTN","LREPI3",34,0)
 ;SEARCH SUB FIELDS
"RTN","LREPI3",35,0)
 S LRMV=0 F  S LRMV=$O(^DGPT(IFN,"M",LRMV)) Q:+LRMV'>0  D
"RTN","LREPI3",36,0)
 .;SEARCH FOR LEGIONAIRS HERE IN SUB FILE
"RTN","LREPI3",37,0)
 .I $P($G(^DGPT(IFN,"M",LRMV,300)),U,3)=1 D
"RTN","LREPI3",38,0)
 ..S ICD9=$O(^ICD9("BA","482.80 ",0)) Q:+ICD9'>0
"RTN","LREPI3",39,0)
 ..S ^TMP($J,"DG1",ICD9)=$P($G(^DGPT(IFN,70)),"^",10)_"^"_$$HLDATE^HLFNC($P($G(^DGPT(IFN,0)),"^",2))
"RTN","LREPI3",40,0)
 .I $D(^DGPT(IFN,"M",LRMV,0)) F LRI=5:1:9,11:1:15 D
"RTN","LREPI3",41,0)
 ..S ICD9=$P(^DGPT(IFN,"M",LRMV,0),U,LRI) Q:+ICD9'>0
"RTN","LREPI3",42,0)
 ..S ^TMP($J,"DG1",ICD9)=$P($G(^DGPT(IFN,70)),"^",10)_"^"_$$HLDATE^HLFNC($P($G(^DGPT(IFN,0)),"^",2))
"RTN","LREPI3",43,0)
 Q:'$D(^TMP($J,"DG1"))
"RTN","LREPI3",44,0)
BLD S ICD9=0 F  S ICD9=$O(^TMP($J,"DG1",ICD9)) Q:+ICD9'>0  D
"RTN","LREPI3",45,0)
 .S:'$D(DGCNT) DGCNT=1
"RTN","LREPI3",46,0)
 .K LRDATA
"RTN","LREPI3",47,0)
 .S LRDATA="DG1"_HLFS_DGCNT_HLFS_HLFS_$P(^ICD9(ICD9,0),U,1)
"RTN","LREPI3",48,0)
 .S LRDATA=LRDATA_LRCS_$P(^ICD9(ICD9,0),U,3)_LRCS_"I9"
"RTN","LREPI3",49,0)
 .I LRPROT=LRPROTX S LRDATA=LRDATA_HLFS_$P(^TMP($J,"DG1",ICD9),"^",2)_HLFS_HLFS_$S(ICD9=$P(^TMP($J,"DG1",ICD9),"^"):"PR",1:"")
"RTN","LREPI3",50,0)
 .S ^TMP("HL7",$J,DGCNT)=$$UP^XLFSTR(LRDATA),DGCNT=DGCNT+1
"RTN","LREPI3",51,0)
 K ^TMP($J,"DG1"),LRDATA,DGCNT,ICD9,LRMV
"RTN","LREPI3",52,0)
 Q
"RTN","LREPI3",53,0)
PID ;TO BUILD PID SEGMENT
"RTN","LREPI3",54,0)
 K MSG
"RTN","LREPI3",55,0)
 S FLDS="1,2,3,5,7,8,10BT,19,22BT" S MSG=$$EN^VAFHLPID(DFN,FLDS,LRPID)
"RTN","LREPI3",56,0)
 I $D(VAFPID(1)) D
"RTN","LREPI3",57,0)
 .S MSG=MSG_VAFPID(1)
"RTN","LREPI3",58,0)
 S:$P(MSG,HLFS,11)="""""~""""~0005~""""~""""~CDC" $P(MSG,HLFS,11)=""
"RTN","LREPI3",59,0)
 S:$P(MSG,HLFS,23)="""""~""""~0189~""""~""""~CDC" $P(MSG,HLFS,23)=""
"RTN","LREPI3",60,0)
 S ICN=$$GETICN^MPIF001(DFN)
"RTN","LREPI3",61,0)
 S:ICN<0 $P(MSG,HLFS,4)=$P(MSG,HLFS,4)_LRCS_""""""_LRCS_"VAMPI"
"RTN","LREPI3",62,0)
 S:ICN>0 $P(MSG,HLFS,4)=$P(MSG,HLFS,4)_LRCS_ICN_LRCS_"VAMPI"
"RTN","LREPI3",63,0)
 ;ADDITIONAL DATA ADDED HERE HOMELESSNESS
"RTN","LREPI3",64,0)
 S:$$HOMELESS^SOWKHIRM(DFN) $P(MSG,HLFS,12)="HOMELESS"
"RTN","LREPI3",65,0)
 ;NOW GET PERIOD OF SERVICE
"RTN","LREPI3",66,0)
 K VAEL D ELIG^VADPT
"RTN","LREPI3",67,0)
 S:$G(VAEL(2))'="" $P(MSG,HLFS,28)=$P($G(^DIC(21,+VAEL(2),0)),U,3)
"RTN","LREPI3",68,0)
 K VAEL
"RTN","LREPI3",69,0)
 ;GET ZIP IF THERE
"RTN","LREPI3",70,0)
 K VAPA D ADD^VADPT
"RTN","LREPI3",71,0)
 S $P(MSG,HLFS,12)=$P(MSG,HLFS,12)_LRCS_LRCS_LRCS_VAPA(5)_LRCS_$G(VAPA(6))_LRCS_LRCS_LRCS_LRCS
"RTN","LREPI3",72,0)
 I VAPA(7)'="",VAPA(5)'="" S CTY=$P(VAPA(7),U,2),CTYN=$P(VAPA(7),U) I CTYN'="" S CTYCD=$P($G(^DIC(5,$P(VAPA(5),U),1,CTYN,0)),U,3) D
"RTN","LREPI3",73,0)
 .S $P(MSG,HLFS,12)=$P(MSG,HLFS,12)_$G(CTYCD)_"^"_$G(CTY)
"RTN","LREPI3",74,0)
 K VAPA,CTY,CTYN,CTYCD
"RTN","LREPI3",75,0)
 I $P(MSG,HLFS,12)="~~~~~~~~" S $P(MSG,HLFS,12)=""
"RTN","LREPI3",76,0)
 S LRPID=LRPID+1,LRCNT=LRCNT+1,^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(MSG)
"RTN","LREPI3",77,0)
 S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(MSG)
"RTN","LREPI3",78,0)
 S LRMSGSZ=LRMSGSZ+$L(MSG)
"RTN","LREPI3",79,0)
 K FLDS,VAEL,ICN,VAFPID
"RTN","LREPI3",80,0)
 Q
"RTN","LREPI3",81,0)
PV1 ;TO BUILD PV1 SEGMENT
"RTN","LREPI3",82,0)
 K PTF,Y,C,LRDATA,MSG,LRPATLOC
"RTN","LREPI3",83,0)
 S LRDATA=""
"RTN","LREPI3",84,0)
 I $P(^TMP($J,LRPROT,DFN,LRENDT),U)="I" D
"RTN","LREPI3",85,0)
 .S FLDS="1,2,3,36,39,44,45" S LRDATA=$$IN^VAFHLPV1(DFN,LRENDT,FLDS,"","","","")
"RTN","LREPI3",86,0)
 I $P(LRDATA,HLFS)="" S $P(LRDATA,HLFS)="PV1"
"RTN","LREPI3",87,0)
 S $P(LRDATA,HLFS,2)=LRPV1
"RTN","LREPI3",88,0)
 S $P(LRDATA,HLFS,7)=""
"RTN","LREPI3",89,0)
 S $P(LRDATA,HLFS,3)=$P(^TMP($J,LRPROT,DFN,LRENDT),U)
"RTN","LREPI3",90,0)
 I $P(LRDATA,HLFS,3)="O" D
"RTN","LREPI3",91,0)
 .S LRPATLOC=$P(^TMP($J,LRPROT,DFN,LRENDT),U,2)
"RTN","LREPI3",92,0)
 .S LRFILE=$P(LRPATLOC,";",2)
"RTN","LREPI3",93,0)
 .S LRIFN=$P(LRPATLOC,";")
"RTN","LREPI3",94,0)
 .I LRFILE="SC(" D
"RTN","LREPI3",95,0)
 ..I $P($G(^SC(LRIFN,0)),U,4)'="" D
"RTN","LREPI3",96,0)
 ...S LRPATLOC=$$STA^XUAF4($P($G(^SC(LRIFN,0)),U,4))
"RTN","LREPI3",97,0)
 .I LRFILE="DIC(4" D
"RTN","LREPI3",98,0)
 ..I $$STA^XUAF4(LRIFN)'="" D
"RTN","LREPI3",99,0)
 ...S LRPATLOC=$$STA^XUAF4(LRIFN)
"RTN","LREPI3",100,0)
 .S $P(LRDATA,HLFS,39)=LRPATLOC
"RTN","LREPI3",101,0)
 .K LRPATLOC,LRFILE,LRIFN
"RTN","LREPI3",102,0)
 S:$P(^TMP($J,LRPROT,DFN,LRENDT),U,3)="UPDT" $P(LRDATA,HLFS,3)="U"
"RTN","LREPI3",103,0)
 S $P(LRDATA,HLFS,45)=$$HLDATE^HLFNC(LRENDT)
"RTN","LREPI3",104,0)
 S:$P(LRDATA,HLFS,46)="""""" $P(LRDATA,HLFS,46)=""
"RTN","LREPI3",105,0)
 S PTF=$P(^TMP($J,LRPROT,DFN,LRENDT),U,2) I +PTF>0 D
"RTN","LREPI3",106,0)
 .Q:'$D(^DGPT(PTF,0))
"RTN","LREPI3",107,0)
 .Q:$P(^DGPT(PTF,0),U,6)'=3
"RTN","LREPI3",108,0)
 .Q:'$D(^DGPT(PTF,70))
"RTN","LREPI3",109,0)
 .S:+$P(^DGPT(PTF,70),U)>0 $P(LRDATA,HLFS,46)=$$HLDATE^HLFNC($P(^DGPT(PTF,70),U))
"RTN","LREPI3",110,0)
 .S (Y,LRDTY)=$P(^DGPT(PTF,70),U,3)
"RTN","LREPI3",111,0)
 .Q:+Y'>0
"RTN","LREPI3",112,0)
 .S Y=$$EXTERNAL^DILFD(45,72,,Y) ;removed direct reference to ^DD(45,72
"RTN","LREPI3",113,0)
 .;S C=$P(^DD(45,72,0),U,2) D Y^DIQ ;RLM
"RTN","LREPI3",114,0)
 .S $P(LRDATA,HLFS,37)=LRDTY_LRCS_Y_LRCS_"VA45"
"RTN","LREPI3",115,0)
 .S $P(LRDATA,HLFS,40)=$P(^DGPT(PTF,0),U,3)
"RTN","LREPI3",116,0)
 S LRCNT=LRCNT+1,^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA),LRPV1=LRPV1+1
"RTN","LREPI3",117,0)
 S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI3",118,0)
 S LRMSGSZ=LRMSGSZ+$L(LRDATA)
"RTN","LREPI3",119,0)
 I $P(LRDATA,HLFS,3)="O" D  D MOVE^LREPI2
"RTN","LREPI3",120,0)
 .S VIFN=0
"RTN","LREPI3",121,0)
 .F  S VIFN=$O(^AUPNVPOV("AA",DFN,9999999-$P(LRENDT,"."),VIFN)) Q:+VIFN'>0  D
"RTN","LREPI3",122,0)
 ..S LRVISIT=$P(^AUPNVSIT($P(^AUPNVPOV(VIFN,0),U,3),812),U,2)
"RTN","LREPI3",123,0)
 ..I LRVISIT'=26 S LRVISIT=0 Q
"RTN","LREPI3",124,0)
 ..S ICD9N=$P($G(^AUPNVPOV(VIFN,0)),U)
"RTN","LREPI3",125,0)
 ..Q:ICD9N=""
"RTN","LREPI3",126,0)
 ..S ICD9=$P(^ICD9(ICD9N,0),U)
"RTN","LREPI3",127,0)
 ..S:'$D(DGCNT) DGCNT=1
"RTN","LREPI3",128,0)
 ..S LRDATA="DG1"_HLFS_DGCNT_HLFS_HLFS_ICD9
"RTN","LREPI3",129,0)
 ..S LRDATA=LRDATA_LRCS_$P(^ICD9(ICD9N,0),U,3)_LRCS_"I9"
"RTN","LREPI3",130,0)
 ..S LRDATA=LRDATA_HLFS_$$HLDATE^HLFNC(LRENDT)_HLFS_HLFS_$S($P(^AUPNVPOV(VIFN,0),U,12)="P":"PR",1:"")
"RTN","LREPI3",131,0)
 ..S ^TMP("HL7",$J,DGCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPI3",132,0)
 .. S DGCNT=DGCNT+1
"RTN","LREPI3",133,0)
 K DGCNT,VIFN,ICD9N,ICD9,LRDATA,LRVISIT
"RTN","LREPI3",134,0)
 Q:$G(PTF)'>0
"RTN","LREPI3",135,0)
 Q:'$D(^DGPT(PTF,0))
"RTN","LREPI3",136,0)
 Q:$P(^DGPT(PTF,0),U,6)'=3
"RTN","LREPI3",137,0)
 S IFN=PTF D DG11
"RTN","LREPI3",138,0)
 D MOVE^LREPI2
"RTN","LREPI3",139,0)
 K PTF,Y,C,LRDATA,LRDTY,IFN,ICD9,ICD9N,LROLLOC,VIFN
"RTN","LREPI3",140,0)
 Q
"RTN","LREPI3",141,0)
 ;
"RTN","LREPI5")
0^6^B5654489
"RTN","LREPI5",1,0)
LREPI5 ;DALOI/SED-EMERGING PATHOGENS SEARCH ;10/31/02
"RTN","LREPI5",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPI5",3,0)
 ; Reference to ^DGPT supported by IA #418
"RTN","LREPI5",4,0)
 ; Reference to ^ICD9 supported by IA #10082
"RTN","LREPI5",5,0)
 ; Reference to ^ORD supported by IA #872
"RTN","LREPI5",6,0)
 ; Reference to PATS^PXRMXX supported by IA #3134
"RTN","LREPI5",7,0)
 ; Reference to VADPT supported by IA #10061
"RTN","LREPI5",8,0)
 ; Reference to ^AUPNVPOV supported by IA #3094
"RTN","LREPI5",9,0)
 Q
"RTN","LREPI5",10,0)
 ;Called from LREPI
"RTN","LREPI5",11,0)
PTF ;SEARCH DISCHARGE DATES; NEED ADDITIONAL LATER SPECS
"RTN","LREPI5",12,0)
 S STDT=(LRRPS-.0001),ENDT=(LRRPE+.9999)
"RTN","LREPI5",13,0)
 F  S STDT=$O(^DGPT("ADS",STDT)) Q:+STDT'>0!(STDT>ENDT)  D
"RTN","LREPI5",14,0)
 .S IFN=0 F  S IFN=$O(^DGPT("ADS",STDT,IFN)) Q:+IFN'>0  D
"RTN","LREPI5",15,0)
 ..Q:$P($G(^DGPT(IFN,0)),U,6)'=3
"RTN","LREPI5",16,0)
 ..I $P($G(^DGPT(IFN,300)),U,3)=1 D
"RTN","LREPI5",17,0)
 ...S ICD9=$O(^ICD9("BA","482.80 ",0)) D ICD9
"RTN","LREPI5",18,0)
 ..I $D(^DGPT(IFN,70)) F LRI=10,11,16:1:24 D
"RTN","LREPI5",19,0)
 ...S ICD9=$P(^DGPT(IFN,70),U,LRI) D ICD9
"RTN","LREPI5",20,0)
 ..;SEARCH SUB FIELDS
"RTN","LREPI5",21,0)
 ..S LRMV=0 F  S LRMV=$O(^DGPT(IFN,"M",LRMV)) Q:+LRMV'>0  D
"RTN","LREPI5",22,0)
 ...I $P($G(^DGPT(IFN,"M",LRMV,300)),U,3)=1 D
"RTN","LREPI5",23,0)
 ....S ICD9=$O(^ICD9("BA","482.80 ",0)) D ICD9
"RTN","LREPI5",24,0)
 ...I $D(^DGPT(IFN,"M",LRMV,0)) F LRI=5:1:9,11:1:15 D
"RTN","LREPI5",25,0)
 ....S ICD9=$P(^DGPT(IFN,"M",LRMV,0),U,LRI) D ICD9
"RTN","LREPI5",26,0)
 K IFN,LRMV,ICD9,LRI
"RTN","LREPI5",27,0)
 Q
"RTN","LREPI5",28,0)
ICD9 ;CHECK ICD9 CODE AND SAVE
"RTN","LREPI5",29,0)
 Q:+ICD9'>0
"RTN","LREPI5",30,0)
 Q:'$D(^TMP($J,"ICD",+ICD9))
"RTN","LREPI5",31,0)
 S LRPROT=$G(LRPROT,999999) S ^TMP($J,"ICDPROT",+ICD9,LRPROT)=""
"RTN","LREPI5",32,0)
 S DFN=$P(^DGPT(IFN,0),U,1),ADMDT=$P(^DGPT(IFN,0),U,2)
"RTN","LREPI5",33,0)
 S LRPATH=0 F  S LRPATH=$O(^TMP($J,"ICD",+ICD9,LRPATH)) Q:+LRPATH'>0  D SET
"RTN","LREPI5",34,0)
 Q
"RTN","LREPI5",35,0)
SET ;SET THE TMP GLOBAL
"RTN","LREPI5",36,0)
 S LRPROT=$P(^LAB(69.5,LRPATH,0),U,7)
"RTN","LREPI5",37,0)
 S LRCHK=0 D ADDCHK Q:LRCHK
"RTN","LREPI5",38,0)
 S:'$D(^TMP($J,LRPROT,DFN,ADMDT)) ^TMP($J,LRPROT,DFN,ADMDT)="I"_U_IFN
"RTN","LREPI5",39,0)
 S ^TMP($J,LRPROT,DFN,ADMDT,LRPATH,(9999999-ADMDT),"PTF")=IFN
"RTN","LREPI5",40,0)
 Q
"RTN","LREPI5",41,0)
ADDCHK ;DO ADDITIONAL CHECKS HERE FOR AGE AND SEX SCREENING.
"RTN","LREPI5",42,0)
 ;
"RTN","LREPI5",43,0)
 I '$G(DFN) S DFN=$G(LRPAT)
"RTN","LREPI5",44,0)
 K VADM
"RTN","LREPI5",45,0)
 I $G(DFN) D DEM^VADPT
"RTN","LREPI5",46,0)
 ;
"RTN","LREPI5",47,0)
 I $P(^LAB(69.5,LRPATH,0),U,10)'="" D
"RTN","LREPI5",48,0)
 .S LRSEX=$P(^LAB(69.5,LRPATH,0),U,10)
"RTN","LREPI5",49,0)
 .I LRSEX="O"&$P(VADM(5),U,1)="M" S LRCHK=1 Q
"RTN","LREPI5",50,0)
 .I LRSEX="O"&$P(VADM(5),U,1)="F" S LRCHK=1 Q
"RTN","LREPI5",51,0)
 .I LRSEX'=$P(VADM(5),U,1) S LRCHK=1
"RTN","LREPI5",52,0)
 I $P(^LAB(69.5,LRPATH,0),U,11)'=""!$P(^LAB(69.5,LRPATH,0),U,12)'="" D
"RTN","LREPI5",53,0)
 .S LRBEF=$P(^LAB(69.5,LRPATH,0),U,11),LRAFT=$P(^LAB(69.5,LRPATH,0),U,12)
"RTN","LREPI5",54,0)
 .I LRBEF'=""&($P(VADM(3),U,1)>LRBEF) S LRCHK=1
"RTN","LREPI5",55,0)
 .I LRAFT'=""&($P(VADM(3),U,1)<LRAFT) S LRCHK=1
"RTN","LREPI5",56,0)
 K LRBEF,LRSEX,LRAFT,VADM
"RTN","LREPI5",57,0)
 Q
"RTN","LREPIPH")
0^28^B10233288
"RTN","LREPIPH",1,0)
LREPIPH ;DALOI/RLM-EMERGING PATHOGENS HL7 SEGMENT BUILDER ;1/1/98
"RTN","LREPIPH",2,0)
 ;;5.2;LAB SERVICE;**260,281**;Sep 27, 1994
"RTN","LREPIPH",3,0)
 ; Reference to ^ICD9 supported by IA #10082
"RTN","LREPIPH",4,0)
 ; Reference to ^PXD(811.9 supported by IA #1256
"RTN","LREPIPH",5,0)
 ; Reference to ^PSDRUG supported by IA #221-A
"RTN","LREPIPH",6,0)
 ; Reference to FIDATA^PXRM supported by IA #2182
"RTN","LREPIPH",7,0)
 Q
"RTN","LREPIPH",8,0)
RXNT ;Findings Data
"RTN","LREPIPH",9,0)
 K FINDINGS S LRNTE1=1,(LRDRSQ1,LRDRSEQ)=0
"RTN","LREPIPH",10,0)
 S LRDRSEQ=LRDRSEQ+1
"RTN","LREPIPH",11,0)
 M FINDINGS=^TMP("LREPISRCH",$J,DFN,"FIND")
"RTN","LREPIPH",12,0)
 S LRFIND=0 F  S LRFIND=$O(FINDINGS(LRFIND)) Q:'LRFIND  D
"RTN","LREPIPH",13,0)
  . ;S LRENDTX=$G(FINDINGS(LRFIND,"DATE"))
"RTN","LREPIPH",14,0)
  . ;D PV1
"RTN","LREPIPH",15,0)
  . I $D(FINDINGS(LRFIND,"DRUG")) S LRDRSQ1=LRDRSEQ D DRUG
"RTN","LREPIPH",16,0)
  . I $D(FINDINGS(LRFIND,"FINDING")) D FIND
"RTN","LREPIPH",17,0)
  . S LRDRSQ1=0 Q
"RTN","LREPIPH",18,0)
 K FINDINGS,^TMP("LREPISRCH",$J,DFN) S LRPVVV=0 Q
"RTN","LREPIPH",19,0)
DRUG ;
"RTN","LREPIPH",20,0)
 D PV1
"RTN","LREPIPH",21,0)
 S LRDRUG=+FINDINGS(LRFIND,"FINDING")
"RTN","LREPIPH",22,0)
 S LRDRGC=$P($G(^PSDRUG(LRDRUG,2)),"^",4)
"RTN","LREPIPH",23,0)
 S LRDATA="ZXE"_HLFS_LRDRGC_HLFS_FINDINGS(LRFIND,"DRUG")_LRCS_"NDC"_HLFS_FINDINGS(LRFIND,"DSUP")_HLFS_$$HLDATE^HLFNC($G(FINDINGS(LRFIND,"RDATE")))_HLFS_$$HLDATE^HLFNC($G(FINDINGS(LRFIND,"DATE")))_HLFS
"RTN","LREPIPH",24,0)
 S LRDATA=LRDATA_$$HLDATE^HLFNC($G(FINDINGS(LRFIND,"STOPDATE")))_HLFS_+LRDRSQ1
"RTN","LREPIPH",25,0)
 ;S LRDATA="RXO"_HLFS_LRDRGC_LRCS_FINDINGS(LRFIND,"DRUG")_LRCS_"NDC"_HLFS_LRDRGC_HLFS_HLFS_FINDINGS(LRFIND,"DSUP")_HLFS_HLFS_HLFS_HLFS_HLFS_HLFS_HLFS_HLFS_HLFS_+LRDRSQ1
"RTN","LREPIPH",26,0)
 S LRCNT=LRCNT+1,^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA),LRMSGSZ=LRMSGSZ+$L(LRDATA)
"RTN","LREPIPH",27,0)
 S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPIPH",28,0)
 K LRDRGC S LRDRSEQ=LRDRSEQ+1 Q  ;S LRPVVV=0 Q
"RTN","LREPIPH",29,0)
FIND ;
"RTN","LREPIPH",30,0)
 ;Q:$D(FINDINGS(LRFIND,"RDATE"))  ;Don't send DSP if RX data is sent.
"RTN","LREPIPH",31,0)
 D PV1
"RTN","LREPIPH",32,0)
 S LRTRM=$P($G(FINDINGS(LRFIND,"TERM")),"^")
"RTN","LREPIPH",33,0)
 S LRTOLD=$G(FINDINGS(LRFIND,"ALTTRM")) I LRTOLD'?1.N S LRTOLD="00"
"RTN","LREPIPH",34,0)
 S LRDATA="DSP"_HLFS_LRNTE1_HLFS_HLFS_$$HLDATE^HLFNC(FINDINGS(LRFIND,"DATE"),"TS")_LRCS_LRTRM_LRCS_LRTOLD_LRCS_$G(FINDINGS(LRFIND,"RESULT"))_LRCS_$G(FINDINGS(LRFIND,"S/N"))_HLFS_HLFS_+LRDRSQ1
"RTN","LREPIPH",35,0)
 S ^TMP($J,"HEP",LRTOLD)=$G(^TMP($J,"HEP",LRTOLD))+1
"RTN","LREPIPH",36,0)
 S LRNTE1=LRNTE1+1,LRCNT=LRCNT+1,^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA),LRMSGSZ=LRMSGSZ+$L(LRDATA)
"RTN","LREPIPH",37,0)
 S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPIPH",38,0)
 Q  ;S LRPVVV=0 Q
"RTN","LREPIPH",39,0)
PV1 ;Build PV1
"RTN","LREPIPH",40,0)
 Q:$G(LRPVVV)
"RTN","LREPIPH",41,0)
 S LRPTY=$P(^TMP($J,LRPROT,DFN,LRENDT),U)
"RTN","LREPIPH",42,0)
 S:$P(^TMP($J,LRPROT,DFN,LRENDT),U,3)="UPDT" LRPTY="U"
"RTN","LREPIPH",43,0)
 I $P($G(FINDINGS(LRFIND)),"^",2)]"",$P($G(FINDINGS(LRFIND)),"^",2)'="U" S LRPTY=$P($G(FINDINGS(LRFIND)),"^",2)
"RTN","LREPIPH",44,0)
 I LRPTY'="I",LRPTY'="O",LRPTY'="U" S LRPTY="U"
"RTN","LREPIPH",45,0)
 S LRDATA="PV1|"_LRPV1_"|"_LRPTY_"||||||||||||||||||||||||||||||||||||||||||"_$$HLDATE^HLFNC(LRENDT)
"RTN","LREPIPH",46,0)
 S LRCNT=LRCNT+1,^TMP("HLS",$J,LRCNT)=$$UP^XLFSTR(LRDATA),LRMSGSZ=LRMSGSZ+$L(LRDATA),LRPV1=LRPV1+1
"RTN","LREPIPH",47,0)
 S ^TMP("LREPIREP",$J,LRCNT)=$$UP^XLFSTR(LRDATA)
"RTN","LREPIPH",48,0)
 S LRPVVV=1
"RTN","LREPIPH",49,0)
 Q
"RTN","LREPIPH",50,0)
ZEOR ;LREPIPH
"RTN","LREPIPI")
0^24^B12589955
"RTN","LREPIPI",1,0)
LREPIPI ;DALOI/CKA - Local Pathogens Input;7/2/03
"RTN","LREPIPI",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIPI",3,0)
 ; Reference to $$SITE^VASITE supported by IA #10112
"RTN","LREPIPI",4,0)
 ; Reference to ^ORD(101 supported by IA #872
"RTN","LREPIPI",5,0)
EN ;
"RTN","LREPIPI",6,0)
 S LRNO="",SITE=$P($$SITE^VASITE,U)
"RTN","LREPIPI",7,0)
 S DIR(0)="FO^3:30",DIR("A")="LOCAL PATHOGEN NAME",DIR("?")="Enter the name of the local pathogen [3-30 characters].  You may also enter part of the name for look up purposes."
"RTN","LREPIPI",8,0)
 S DIR("??")="^S D=""B"",DIC=""^LAB(69.5,"",DIC(0)=""EZ"",DIC(""S"")=""I Y>99"" D DQ^DICQ K DIC"
"RTN","LREPIPI",9,0)
 D ^DIR K DIR I $D(DIRUT) G EXIT
"RTN","LREPIPI",10,0)
 S LRX=Y
"RTN","LREPIPI",11,0)
LKUP ;
"RTN","LREPIPI",12,0)
 S DIC="^LAB(69.5,",DIC("S")="I Y>99",DIC(0)="EMZ" D ^DIC K DIC S LREPIFN=+Y
"RTN","LREPIPI",13,0)
 I $G(LRDEL) Q
"RTN","LREPIPI",14,0)
 I Y="" D EXIT G EN
"RTN","LREPIPI",15,0)
 I $D(DTOUT) G NOU
"RTN","LREPIPI",16,0)
 I Y'<0 D FND
"RTN","LREPIPI",17,0)
 I Y<0 D ADD D EXIT G EN
"RTN","LREPIPI",18,0)
 G:$G(Y)["^"!($D(DTOUT)) NOU
"RTN","LREPIPI",19,0)
 G:LRNO EN D:LRY EDIT G EN
"RTN","LREPIPI",20,0)
 G EN
"RTN","LREPIPI",21,0)
 Q
"RTN","LREPIPI",22,0)
 ;
"RTN","LREPIPI",23,0)
ADD ;
"RTN","LREPIPI",24,0)
 S DIR(0)="Y",DIR("A")="Do you want to add this local pathogen",DIR("B")="YES" D ^DIR G:$D(DTOUT) NOU K DIR
"RTN","LREPIPI",25,0)
 I 'Y Q
"RTN","LREPIPI",26,0)
 S LRNUM=99
"RTN","LREPIPI",27,0)
 F  S LRNUM1=$O(^LAB(69.5,LRNUM)) Q:'LRNUM1  S LRNUM=LRNUM+1
"RTN","LREPIPI",28,0)
 S LRDA=LRNUM+1
"RTN","LREPIPI",29,0)
 K DD,DO
"RTN","LREPIPI",30,0)
 S DIC="^LAB(69.5,"
"RTN","LREPIPI",31,0)
 S DIC(0)="L"
"RTN","LREPIPI",32,0)
 S DLAYGO=69.5
"RTN","LREPIPI",33,0)
 S DINUM=LRDA
"RTN","LREPIPI",34,0)
 S X=LRX_SITE
"RTN","LREPIPI",35,0)
 D FILE^DICN
"RTN","LREPIPI",36,0)
 I Y=-1 D NOU G EN
"RTN","LREPIPI",37,0)
 S $P(^LAB(69.5,LRDA,0),U,2)=0
"RTN","LREPIPI",38,0)
 S $P(^LAB(69.5,LRDA,0),U,9)=LRDA
"RTN","LREPIPI",39,0)
 S LRPROT=0,LRPROT=$O(^ORD(101,"B","LREPI",LRPROT))
"RTN","LREPIPI",40,0)
 S $P(^LAB(69.5,LRDA,0),U,7)=LRPROT
"RTN","LREPIPI",41,0)
 S LREPIFN=LRDA
"RTN","LREPIPI",42,0)
EDIT S DA=LREPIFN
"RTN","LREPIPI",43,0)
 S DDSFILE="^LAB(69.5,"
"RTN","LREPIPI",44,0)
 S DR="[LREPI9]"
"RTN","LREPIPI",45,0)
 D ^DDS
"RTN","LREPIPI",46,0)
 K DDSFILE(1)
"RTN","LREPIPI",47,0)
 W !!
"RTN","LREPIPI",48,0)
 D EXIT
"RTN","LREPIPI",49,0)
 Q
"RTN","LREPIPI",50,0)
EXIT K DA,DD,DDSFILE,DLAYGO,DIC,DIK,DINUM,DIR,DO,DR,DTOUT,DUOUT,L,LRDA,LRDEL,LRNO,LRNUM,LRNUM1,LREPIFN,LRPROT,LRX,LRXX,LRY,SITE,X,Y Q
"RTN","LREPIPI",51,0)
FND W !,"This pathogen is already entered as a local pathogen.",!
"RTN","LREPIPI",52,0)
 S DIC="^LAB(69.5,",DA=+Y,DR="0:6;8:9" D EN^DIQ
"RTN","LREPIPI",53,0)
 S DIR(0)="Y",DIR("A")="Is this the correct one" D ^DIR K DIR
"RTN","LREPIPI",54,0)
 I 'Y S LRNO=1 W !! Q
"RTN","LREPIPI",55,0)
YN1 S DIR(0)="Y",DIR("A")="Do you want to edit this local pathogen",DIR("B")="NO"
"RTN","LREPIPI",56,0)
 D ^DIR
"RTN","LREPIPI",57,0)
 K DIR
"RTN","LREPIPI",58,0)
 S LRY=Y
"RTN","LREPIPI",59,0)
 W !! Q
"RTN","LREPIPI",60,0)
 Q
"RTN","LREPIPI",61,0)
NOU W !!,$C(7),?20,"NO UPDATING HAS OCCURRED!!!" K DIR G:$D(DTOUT) EXIT W !! G EN
"RTN","LREPIPI",62,0)
DELETE ;DELETE LOCAL PATHOGEN
"RTN","LREPIPI",63,0)
 S LRDEL=1
"RTN","LREPIPI",64,0)
 D EN
"RTN","LREPIPI",65,0)
 I '$D(Y) G EXIT
"RTN","LREPIPI",66,0)
 S LRXX=Y
"RTN","LREPIPI",67,0)
 G:$D(DTOUT)!($D(DUOUT))!(Y="") EXIT
"RTN","LREPIPI",68,0)
 S DIC="^LAB(69.5,"
"RTN","LREPIPI",69,0)
 S DIC(0)="EMZ"
"RTN","LREPIPI",70,0)
 S DIC("S")="I $P(^(0),U,9)>99"
"RTN","LREPIPI",71,0)
 D ^DIC
"RTN","LREPIPI",72,0)
 K DIC
"RTN","LREPIPI",73,0)
 I Y=-1 W !,"NO MATCH FOUND." G DELETE
"RTN","LREPIPI",74,0)
 S LRY=Y
"RTN","LREPIPI",75,0)
 S DIR(0)="Y",DIR("A")="Do you really want to delete this pathogen"
"RTN","LREPIPI",76,0)
 D ^DIR
"RTN","LREPIPI",77,0)
 K DIR
"RTN","LREPIPI",78,0)
 G:$D(DTOUT)!($D(DUOUT)) EXIT
"RTN","LREPIPI",79,0)
 I 'Y G DELETE
"RTN","LREPIPI",80,0)
 I LRY>99 S DA=+LRY D KILL G DELETE
"RTN","LREPIPI",81,0)
 G DELETE
"RTN","LREPIPI",82,0)
 ;
"RTN","LREPIPI",83,0)
KILL S DIK="^LAB(69.5,"
"RTN","LREPIPI",84,0)
 D ^DIK
"RTN","LREPIPI",85,0)
 W !!,"Entry ",$P(LRY,U,2)," deleted."
"RTN","LREPIPI",86,0)
 K DIK
"RTN","LREPIPI",87,0)
 Q
"RTN","LREPIPI",88,0)
INQUIRY S DIC="^LAB(69.5,",DIC("A")="Select Pathogen: ",DIC(0)="AEMQ" D ^DIC K DIC
"RTN","LREPIPI",89,0)
 I Y<0 K DIC,DA,D0,DR,Y Q
"RTN","LREPIPI",90,0)
INQ1 S DIC="^LAB(69.5,",DA=+Y,DR="0:6" D EN^DIQ
"RTN","LREPIPI",91,0)
 D PAUSE^LREPIRS2
"RTN","LREPIPI",92,0)
 I $G(LRQUIT) K DIC,DA,D0,DR,LRQUIT,Y Q
"RTN","LREPIPI",93,0)
 S DR="8:9" D EN^DIQ
"RTN","LREPIPI",94,0)
 K DIC,DA,DO,DR,LRQUIT,Y
"RTN","LREPIPI",95,0)
 G INQUIRY
"RTN","LREPIPI",96,0)
PRINT S L=0,DIC="^LAB(69.5,"
"RTN","LREPIPI",97,0)
 D EN1^DIP
"RTN","LREPIPI",98,0)
 Q
"RTN","LREPIRM")
0^12^B33714924
"RTN","LREPIRM",1,0)
LREPIRM ;DALOI/SED - EMERGING PATHOGENS SEARCH ; 7/16/96
"RTN","LREPIRM",2,0)
 ;;5.2;LAB SERVICE;**175,281**;Sep 27, 1994
"RTN","LREPIRM",3,0)
 ; Reference to ^ORD(101 supported by IA #972
"RTN","LREPIRM",4,0)
 ;
"RTN","LREPIRM",5,0)
 ;Search Parameters  - LREPI(#)
"RTN","LREPIRM",6,0)
 ;Search Date -Start LRRPS
"RTN","LREPIRM",7,0)
 ;             Stop  LRRPE
"RTN","LREPIRM",8,0)
 ;
"RTN","LREPIRM",9,0)
MAN ;USED TO RERUN THE OPTION FOR ANY PRIOR MONTHS 
"RTN","LREPIRM",10,0)
 S LRRTYPE=1
"RTN","LREPIRM",11,0)
 W @IOF,?(IOM/2-15),"Laboratory Search rerun option"
"RTN","LREPIRM",12,0)
PROT ;SELECT PROTOCOL
"RTN","LREPIRM",13,0)
 K DIC,LRPROT,X,Y
"RTN","LREPIRM",14,0)
 S DIC="69.4",DIC("A")="Select Protocol: "
"RTN","LREPIRM",15,0)
 S DIC(0)="AEMNQ"
"RTN","LREPIRM",16,0)
 S DIC("W")="W ?40,$P(^(0),U,5)"
"RTN","LREPIRM",17,0)
 D ^DIC
"RTN","LREPIRM",18,0)
 G:+Y'>0 EXIT
"RTN","LREPIRM",19,0)
 S LRPROT=+Y
"RTN","LREPIRM",20,0)
OVR K DIR,DIRUT
"RTN","LREPIRM",21,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Override Any Inactive indicators: "
"RTN","LREPIRM",22,0)
 S DIR("?")="Enter (Y)es if the overriding of any Inactive indicator is desired. "
"RTN","LREPIRM",23,0)
 D ^DIR
"RTN","LREPIRM",24,0)
 G:$D(DIRUT) PROT
"RTN","LREPIRM",25,0)
 S LROVR=+Y
"RTN","LREPIRM",26,0)
CRI K LRCYCLE,LREPI S LRMSG="Search Parameters" D ALL G:$D(DIRUT) OVR
"RTN","LREPIRM",27,0)
 K DIR,DIRUT,DTOUT,DUOUT,DIROUT
"RTN","LREPIRM",28,0)
 I +LRALL D PICKALL
"RTN","LREPIRM",29,0)
 I +LRALL'>0 D
"RTN","LREPIRM",30,0)
 .W @IOF
"RTN","LREPIRM",31,0)
 .F  Q:$D(DIRUT)  D
"RTN","LREPIRM",32,0)
 ..S DIR(0)="PAO^69.5:EMZ",DIR("A")="Select Search Parameters: "
"RTN","LREPIRM",33,0)
 ..S DIR("?")="Select the Search Parameters. "
"RTN","LREPIRM",34,0)
 ..S DIR("S")="D CHK^LREPIRM I LROK"
"RTN","LREPIRM",35,0)
 ..D ^DIR
"RTN","LREPIRM",36,0)
 ..Q:$D(DIRUT)
"RTN","LREPIRM",37,0)
 ..S LREPI(+Y)=""
"RTN","LREPIRM",38,0)
 G:$D(DTOUT)!$D(DUOUT)!$D(DIROUT) CRI
"RTN","LREPIRM",39,0)
 I '$D(LREPI) W !,"Sorry No Search Parameters Selected" G CRI
"RTN","LREPIRM",40,0)
DATE ;Select Search Date
"RTN","LREPIRM",41,0)
 K DIR,DIRUT
"RTN","LREPIRM",42,0)
 S DIR("A")="Select Search Date: "
"RTN","LREPIRM",43,0)
 S DIR(0)="DOA^:"_DT_":E" D ^DIR
"RTN","LREPIRM",44,0)
 G:$D(DIRUT) CRI
"RTN","LREPIRM",45,0)
 K DIR,DIRUT,LRCYCLE
"RTN","LREPIRM",46,0)
 S LRTYPE=$O(LREPI(0))
"RTN","LREPIRM",47,0)
 S LRCYCLE=$P(^LAB(69.5,LRTYPE,0),U,5)
"RTN","LREPIRM",48,0)
 S X=Y I LRCYCLE="M" D
"RTN","LREPIRM",49,0)
 .D DAYS
"RTN","LREPIRM",50,0)
 .S LRRPE=$E(Y,1,5)_X,LRRPS=$E(Y,1,5)_"01"
"RTN","LREPIRM",51,0)
 I LRCYCLE="D" S (LRRPE,LRRPS)=Y
"RTN","LREPIRM",52,0)
 K X,Y,X1,LRCYCLE,LRTYPE
"RTN","LREPIRM",53,0)
 D TASK  ;;*Cincinnati - Toggle Task On/Off*
"RTN","LREPIRM",54,0)
 ;D EN^LREPI  ;;Cincinnati - Toggle Console Execution On/Off*
"RTN","LREPIRM",55,0)
EXIT ;
"RTN","LREPIRM",56,0)
 K D0,LRAUTO,LRBEG,LRDT,LREND,LRRNDT,LREPI,LRRPE,LRRPS,LRPREV,ZTSAVE
"RTN","LREPIRM",57,0)
 K LRRSD,LRLAG,ZTREQ,ZTRTN,ZTIO,ZTDESC,ZTDTH,ZTSK,X,Y,X1,%DT
"RTN","LREPIRM",58,0)
 Q
"RTN","LREPIRM",59,0)
 ;
"RTN","LREPIRM",60,0)
TASK ;LETS TASK THIS JOB
"RTN","LREPIRM",61,0)
 Q:'$D(LREPI)
"RTN","LREPIRM",62,0)
 K ZTSAVE
"RTN","LREPIRM",63,0)
 S (ZTSAVE("LREPI("),ZTSAVE("LRRPS"),ZTSAVE("LRRPE"))=""
"RTN","LREPIRM",64,0)
 S ZTSAVE("LRRTYPE")="",ZTSAVE("LRPREV")="" S:LRRTYPE=0 ZTDTH=DT
"RTN","LREPIRM",65,0)
 S ZTIO="",ZTRTN="EN^LREPI",ZTDESC="Laboratory EPI",ZTREQ="@"
"RTN","LREPIRM",66,0)
 D ^%ZTLOAD
"RTN","LREPIRM",67,0)
 I '$D(ZTQUEUED)&($D(ZTSK)) W @IOF,!!,"The Task has been queued",!,"Task # ",$G(ZTSK) H 5
"RTN","LREPIRM",68,0)
 Q
"RTN","LREPIRM",69,0)
PICKALL ;SELECT ALL ASSOCIATED PARAMETERS
"RTN","LREPIRM",70,0)
 S Y=0 F  S Y=$O(^LAB(69.5,Y)) Q:+Y'>0!(Y>99)  D CHK S:LROK LREPI(Y)=""
"RTN","LREPIRM",71,0)
 Q
"RTN","LREPIRM",72,0)
CHK ;CHECK TO SEE IF ITS OK
"RTN","LREPIRM",73,0)
 I Y>99 S LROK=0 Q
"RTN","LREPIRM",74,0)
CHKL ;CHECK FOR LOCAL PATHOGENS
"RTN","LREPIRM",75,0)
 S:'$D(LRCYCLE) LRCYCLE=$P(^LAB(69.5,Y,0),U,5)
"RTN","LREPIRM",76,0)
 S LROK=1
"RTN","LREPIRM",77,0)
 S:$P(^LAB(69.5,Y,0),U,7)'=LRPROT LROK=0 Q
"RTN","LREPIRM",78,0)
 S:'LROVR&($P(^LAB(69.5,Y,0),U,2)="1") LROK=0 Q
"RTN","LREPIRM",79,0)
 S:$P(^LAB(69.5,Y,0),U,7)="" LROK=0 Q
"RTN","LREPIRM",80,0)
 S:'$D(^ORD(101,$P(^LAB(69.5,Y,0),U,7),0)) LROK=0 Q
"RTN","LREPIRM",81,0)
 S:$P(^LAB(69.5,Y,0),U,5)=LRCYCLE LROK=0 Q
"RTN","LREPIRM",82,0)
 Q
"RTN","LREPIRM",83,0)
ALL K DIR,DIRUT
"RTN","LREPIRM",84,0)
 S DIR(0)="Y",DIR("B")="YES",DIR("A")="Include All "_LRMSG
"RTN","LREPIRM",85,0)
 S DIR("?")="Enter (Y)es or return for all entries to be Selected"
"RTN","LREPIRM",86,0)
 D ^DIR
"RTN","LREPIRM",87,0)
 S LRALL=+Y
"RTN","LREPIRM",88,0)
 Q
"RTN","LREPIRM",89,0)
AUTO ; CHECKS TO SEE IF IT IS TIME TO RUN A SEARCH
"RTN","LREPIRM",90,0)
 K %DT,X,Y,LREPI,^TMP($J)
"RTN","LREPIRM",91,0)
 S D0=0
"RTN","LREPIRM",92,0)
 F  S D0=$O(^LAB(69.5,D0)) Q:+D0'>0!(+D0>99)  D
"RTN","LREPIRM",93,0)
 .Q:$P(^LAB(69.5,D0,0),U,2)="1"
"RTN","LREPIRM",94,0)
 .Q:$P(^LAB(69.5,D0,0),U,7)=""
"RTN","LREPIRM",95,0)
 .Q:'$D(^ORD(101,$P(^LAB(69.5,D0,0),U,7),0))
"RTN","LREPIRM",96,0)
 .S LRCYC=$P(^LAB(69.5,D0,0),U,5)
"RTN","LREPIRM",97,0)
 .Q:LRCYC=""
"RTN","LREPIRM",98,0)
 .S LRRNDT=$P(^LAB(69.5,D0,0),U,4)
"RTN","LREPIRM",99,0)
 .S LRLAG=$P(^LAB(69.5,D0,0),U,3)
"RTN","LREPIRM",100,0)
 .S:+$G(LRLAG)'>0 LRLAG="1"
"RTN","LREPIRM",101,0)
 .S X="T-"_+(LRLAG-1) D ^%DT Q:+Y'>0
"RTN","LREPIRM",102,0)
 .S LRRSD=+Y
"RTN","LREPIRM",103,0)
 .;Look at the monthly runs
"RTN","LREPIRM",104,0)
 .I LRCYC="M" D
"RTN","LREPIRM",105,0)
 ..S X=$S($E(LRRSD,4,5)="01":($E(LRRSD,1,3)-1),1:$E(LRRSD,1,3))
"RTN","LREPIRM",106,0)
 ..S X1=$S($E(LRRSD,4,5)="01":"12",1:($E(LRRSD,4,5)-1))
"RTN","LREPIRM",107,0)
 ..S:X1<10 X1="0"_X1
"RTN","LREPIRM",108,0)
 ..S X=X_X1
"RTN","LREPIRM",109,0)
 ..K X1,Y D DAYS
"RTN","LREPIRM",110,0)
 ..S LRRPS=$E(X1,1,5)_"01",LRRPE=$E(X1,1,5)_X
"RTN","LREPIRM",111,0)
 ..S:LRLAG<10 LRLAG="0"_LRLAG
"RTN","LREPIRM",112,0)
 ..S LRDT=$E(DT,1,5)_LRLAG
"RTN","LREPIRM",113,0)
 ..I LRRNDT="" S ^TMP($J,"CYC",LRCYC,LRRPS,D0)=LRRPE Q
"RTN","LREPIRM",114,0)
 ..Q:DT<LRDT
"RTN","LREPIRM",115,0)
 ..Q:DT>LRDT
"RTN","LREPIRM",116,0)
 ..S ^TMP($J,"CYC",LRCYC,LRRPS,D0)=LRRPE Q
"RTN","LREPIRM",117,0)
 .;LOOK FOR DAILY RUNS
"RTN","LREPIRM",118,0)
 .I LRCYC="D" D
"RTN","LREPIRM",119,0)
 ..S (LRRPS,LRRPE)=LRRSD
"RTN","LREPIRM",120,0)
 ..I LRRNDT="" S ^TMP($J,"CYC",LRCYC,LRRPS,D0)=LRRPE Q
"RTN","LREPIRM",121,0)
 ..;Q:LRRNDT>LRRPS
"RTN","LREPIRM",122,0)
 ..S ^TMP($J,"CYC",LRCYC,LRRPS,D0)=LRRPE Q
"RTN","LREPIRM",123,0)
 ;Lets Task the Jobs
"RTN","LREPIRM",124,0)
 K LRRPE,LRRPS,LRCYC,D0
"RTN","LREPIRM",125,0)
 F LRCYC="M","D" I $D(^TMP($J,"CYC",LRCYC)) D
"RTN","LREPIRM",126,0)
 .S LRRPS=0
"RTN","LREPIRM",127,0)
 .F  S LRRPS=$O(^TMP($J,"CYC",LRCYC,LRRPS)) Q:+LRRPS'>0  D
"RTN","LREPIRM",128,0)
 ..K LREPI
"RTN","LREPIRM",129,0)
 ..S D0=0 F  S D0=$O(^TMP($J,"CYC",LRCYC,LRRPS,D0)) Q:+D0'>0!(D0>99)  D
"RTN","LREPIRM",130,0)
 ...S LRRPE=$P(^TMP($J,"CYC",LRCYC,LRRPS,D0),U,1),LREPI(D0)=LRRPS_U_LRRPE
"RTN","LREPIRM",131,0)
 ..S LRRTYPE=0
"RTN","LREPIRM",132,0)
 ..D TASK
"RTN","LREPIRM",133,0)
 K LREPI
"RTN","LREPIRM",134,0)
 F LRCYC="M","D" I $D(^TMP($J,"CYC",LRCYC)) D
"RTN","LREPIRM",135,0)
 .S LRRPS=0
"RTN","LREPIRM",136,0)
 .F  S LRRPS=$O(^TMP($J,"CYC",LRCYC,LRRPS)) Q:+LRRPS'>0  D
"RTN","LREPIRM",137,0)
 ..K LREPI
"RTN","LREPIRM",138,0)
 ..S D0=0 F  S D0=$O(^TMP($J,"CYC",LRCYC,LRRPS,D0)) Q:+D0'>0!(D0>99)  D
"RTN","LREPIRM",139,0)
 ...Q:'$P(^LAB(69.5,D0,0),U,13)
"RTN","LREPIRM",140,0)
 ...S LRRPE=$P(^TMP($J,"CYC",LRCYC,LRRPS,D0),U,1),LREPI(D0)=LRRPS_U_LRRPE
"RTN","LREPIRM",141,0)
 ..S LRRTYPE=0
"RTN","LREPIRM",142,0)
 I $D(LREPI) D
"RTN","LREPIRM",143,0)
 .S LRPREV=1
"RTN","LREPIRM",144,0)
 .S D0=0 F  S D0=$O(LREPI(D0)) Q:D0'>0  S LRRPS=$P(LREPI(D0),U),LRRPE=$P(LREPI(D0),U,2) D PREV,TASK
"RTN","LREPIRM",145,0)
 G EXIT
"RTN","LREPIRM",146,0)
DAYS ;GET DAYS OF THE MONTH
"RTN","LREPIRM",147,0)
 S X1=X,X=+$E(X,4,5),X=$S("^1^3^5^7^8^10^12^"[(U_X_U):31,X'=2:30,$E(X1,1,3)#4:28,1:29)
"RTN","LREPIRM",148,0)
 Q
"RTN","LREPIRM",149,0)
 ;
"RTN","LREPIRM",150,0)
PREV S LRPRECYC=$P(^LAB(69.5,D0,0),U,13),LRRPS=$P(LREPI(D0),U),LRRPE=$P(LREPI(D0),U,2) D
"RTN","LREPIRM",151,0)
 .I $P(^LAB(69.5,D0,0),U,5)="D" D
"RTN","LREPIRM",152,0)
 ..S X1=$P(LRRPS,"."),X2=LRPRECYC D C^%DTC S (LRRPS,LRRPE)=X
"RTN","LREPIRM",153,0)
 .I $P(^LAB(69.5,D0,0),U,5)="M" D
"RTN","LREPIRM",154,0)
 ..S X1=$P(LRRPS,"."),X2=$E(X1,4,5),X3=X2-LRPRECYC
"RTN","LREPIRM",155,0)
 ..I X3>0 S LRRPS=$E(X1,1,3)_$S($L(X3)=1:"0"_X3,1:X3)_"01"
"RTN","LREPIRM",156,0)
 ..I X3'>0 S X3=12+X3,LRRPS=$E(X1,1,3)_$S($L(X3)=1:"0"_X3,1:X3)_"01"
"RTN","LREPIRM",157,0)
 ..S X1=$P(LRRPE,"."),X2=$E(X1,4,5),X3=X2-LRPRECYC
"RTN","LREPIRM",158,0)
 ..I X3'>0 S X3=12+X3
"RTN","LREPIRM",159,0)
 ..S DAYS=$S("^1^3^5^7^8^10^12^"[(U_+X3_U):31,+X3'=2:30,$E(X1,1,3)#4:28,1:29)
"RTN","LREPIRM",160,0)
 ..S LRRPE=$E(X1,1,3)_$S($L(X3)=1:"0"_X3,1:X3)_DAYS
"RTN","LREPIRM",161,0)
 ..K X,X1,X2,X3,DAYS
"RTN","LREPIRM",162,0)
 Q
"RTN","LREPIRM",163,0)
 ;
"RTN","LREPIRP")
0^15^B81822562
"RTN","LREPIRP",1,0)
LREPIRP ;DALOI/CKA-EMERGING PATHOGENS VERIFICATION REPORT ;9/30/03
"RTN","LREPIRP",2,0)
 ;;5.2;LAB SERVICE;**132,157,175,260,281**;Sep 27, 1994
"RTN","LREPIRP",3,0)
 ; Reference to ^DIC(21 supported by IA #2504
"RTN","LREPIRP",4,0)
 ; Reference to ^ORD(101 supported by IA #872
"RTN","LREPIRP",5,0)
 Q
"RTN","LREPIRP",6,0)
REPORT ;
"RTN","LREPIRP",7,0)
 D NOW^%DTC S LRDATE=%
"RTN","LREPIRP",8,0)
 S LRSP="                              "
"RTN","LREPIRP",9,0)
 S MSGCNT=1,HLFS=HL("FS")
"RTN","LREPIRP",10,0)
 ;SORT DATA FOR REPORT
"RTN","LREPIRP",11,0)
RPT S LRI=0
"RTN","LREPIRP",12,0)
 F  S LRI=$O(^TMP("LREPIREP",$J,LRI)) Q:'LRI  S LRTMP=^(LRI),SEG=$P(LRTMP,HLFS,1) I $L($T(@SEG)) D
"RTN","LREPIRP",13,0)
PID .;PATIENT INFO
"RTN","LREPIRP",14,0)
 .I SEG="PID" D
"RTN","LREPIRP",15,0)
 ..S (LRPV1CNT,LRDG1CNT,LROBRCNT,LROBXCNT,LRNTECNT,LRDSPCNT,LRZXECNT,LRTOTCNT)=0
"RTN","LREPIRP",16,0)
 ..S DFN=$P($P(LRTMP,HLFS,4),"~")
"RTN","LREPIRP",17,0)
 ..S ^TMP($J,"TMP",DFN,"PID")=LRTMP
"RTN","LREPIRP",18,0)
PV1 .;PATIENT VISIT ENCOUNTER
"RTN","LREPIRP",19,0)
 .I SEG="PV1" D
"RTN","LREPIRP",20,0)
 ..S (LRDG1CNT,LROBRCNT,LROBXCNT,LRNTECNT,LRDSPCNT,LRZXECNT)=0
"RTN","LREPIRP",21,0)
 ..S LRPV1CNT=LRPV1CNT+1
"RTN","LREPIRP",22,0)
 ..S ^TMP($J,"TMP",DFN,"PID","PV1",LRPV1CNT)=LRTMP
"RTN","LREPIRP",23,0)
DG1 .;DIAGNOSES
"RTN","LREPIRP",24,0)
 .I SEG="DG1" D
"RTN","LREPIRP",25,0)
 ..S LRDG1CNT=LRDG1CNT+1
"RTN","LREPIRP",26,0)
 ..S ^TMP($J,"TMP",DFN,"PID","PV1",LRPV1CNT,"DG1",LRDG1CNT)=LRTMP
"RTN","LREPIRP",27,0)
OBR .;OBSERVATION REPORTING
"RTN","LREPIRP",28,0)
 .I SEG="OBR" D
"RTN","LREPIRP",29,0)
 ..S LROBXCNT=0
"RTN","LREPIRP",30,0)
 ..S LROBRCNT=LROBRCNT+1
"RTN","LREPIRP",31,0)
 ..S ^TMP($J,"TMP",DFN,"PID","PV1",LRPV1CNT,"NTE",LRNTECNT,"OBR",LROBRCNT)=LRTMP
"RTN","LREPIRP",32,0)
OBX .;RESULTS
"RTN","LREPIRP",33,0)
 .I SEG="OBX" D
"RTN","LREPIRP",34,0)
 ..S LROBXCNT=LROBXCNT+1
"RTN","LREPIRP",35,0)
 ..S ^TMP($J,"TMP",DFN,"PID","PV1",LRPV1CNT,"NTE",LRNTECNT,"OBR",LROBRCNT,"OBX",LROBXCNT)=LRTMP
"RTN","LREPIRP",36,0)
 .I SEG="NTE",$D(DFN),$P($P(LRTMP,HLFS,3),LRCS,1)>0 D
"RTN","LREPIRP",37,0)
 ..S LROBRCNT=0
"RTN","LREPIRP",38,0)
 ..S LRNTECNT=LRNTECNT+1
"RTN","LREPIRP",39,0)
 ..S ^TMP($J,"TMP",DFN,"PID","PV1",LRPV1CNT,"NTE",LRNTECNT)=LRTMP
"RTN","LREPIRP",40,0)
ZXE .;ZXE
"RTN","LREPIRP",41,0)
 .I SEG="ZXE" D
"RTN","LREPIRP",42,0)
 ..S LRZXECNT=LRZXECNT+1
"RTN","LREPIRP",43,0)
 ..S ^TMP($J,"TMP",DFN,"PID","PV1",LRPV1CNT,"ZXE",LRZXECNT)=LRTMP
"RTN","LREPIRP",44,0)
DSP .;DSP
"RTN","LREPIRP",45,0)
 .I SEG="DSP" D
"RTN","LREPIRP",46,0)
 ..S LRDSPCNT=LRDSPCNT+1
"RTN","LREPIRP",47,0)
 ..S ^TMP($J,"TMP",DFN,"PID","PV1",LRPV1CNT,"DSP",LRDSPCNT)=LRTMP
"RTN","LREPIRP",48,0)
TOTALS .;SAVE TOTALS IN NTE
"RTN","LREPIRP",49,0)
 .I SEG="NTE"&($P($P(LRTMP,HLFS,3),LRCS)="T") S LRDONE=0 D
"RTN","LREPIRP",50,0)
 ..F LRNUM=1:1:7 I $P($P($P(LRTMP,HLFS,3),LRCS,3),"-")=LRNUM D
"RTN","LREPIRP",51,0)
 ...S ^XTMP("LREPIREP"_LRDATE,"HEPTOT",LRNUM)=$P($P(LRTMP,HLFS,3),LRCS,4)
"RTN","LREPIRP",52,0)
 ...S LRDONE=1
"RTN","LREPIRP",53,0)
 ..Q:LRDONE
"RTN","LREPIRP",54,0)
 ..S LRTOTCNT=LRTOTCNT+1
"RTN","LREPIRP",55,0)
 ..S ^XTMP("LREPIREP"_LRDATE,"TOTAL1",LRTOTCNT)=LRTMP
"RTN","LREPIRP",56,0)
 K LRDONE
"RTN","LREPIRP",57,0)
RESORT ;SAVE DATA BY NTE IN ^XTMP
"RTN","LREPIRP",58,0)
 S X1=DT,X2=180,LRUPDNUM=0 D C^%DTC
"RTN","LREPIRP",59,0)
 S ^XTMP("LREPIREP"_LRDATE,0)=X_"^"_DT_"^EPI Verification Report^"_$S($D(DUZ):DUZ,1:"UNKNOWN")
"RTN","LREPIRP",60,0)
 S DFN=0,LRCNT=1,LRZXECNT=1,LRDSPCNT=1
"RTN","LREPIRP",61,0)
 F  S DFN=$O(^TMP($J,"TMP",DFN)) Q:'DFN  D
"RTN","LREPIRP",62,0)
 .S LRPV1=0,LRDSP=0,LRZXE=0
"RTN","LREPIRP",63,0)
 .F  S LRPV1=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1)) Q:'LRPV1  S LRPV1N=^(LRPV1) D
"RTN","LREPIRP",64,0)
 ..S LRTMP=^TMP($J,"TMP",DFN,"PID")
"RTN","LREPIRP",65,0)
 ..S LRNAME=$P(LRTMP,HLFS,6),SSN=$E($P(LRTMP,HLFS,20),6,9),LRADMDT=$$CDT^LREPIRP2($P(LRPV1N,HLFS,45)),LRDISDT=$$CDT^LREPIRP2($P(LRPV1N,HLFS,46))
"RTN","LREPIRP",66,0)
 ..S TYPE=$P(LRPV1N,HLFS,3),TYPE=$S(TYPE="U":"U",TYPE="I":"Inpatient",1:"Outpatient")
"RTN","LREPIRP",67,0)
 ..I TYPE="U" D
"RTN","LREPIRP",68,0)
 ...S ^XTMP("LREPIREP"_LRDATE,"UPDATES",LRUPDNUM)=LRNAME_$E(LRSP,1,25-$L(LRNAME))_SSN_"     "_LRADMDT_$E(LRSP,1,18-$L(LRADMDT))_LRDISDT
"RTN","LREPIRP",69,0)
 ...S LRUPDNUM=LRUPDNUM+1
"RTN","LREPIRP",70,0)
 ..F  S LRDSP=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"DSP",LRDSP)) Q:'LRDSP  S LRDSPN=^(LRDSP) D  S LRDSPCNT=1
"RTN","LREPIRP",71,0)
 ...S ^XTMP("LREPIREP"_LRDATE,"DSP",$P($P(LRDSPN,HLFS,4),LRCS,2),DFN,LRDSPCNT)=SSN_"    "_LRNAME_$E(LRSP,1,25-$L(LRNAME))_TYPE_" "_$$CDT^LREPIRP2($P($P(LRDSPN,HLFS,4),LRCS))
"RTN","LREPIRP",72,0)
 ...S LRDSPCNT=LRDSPCNT+1
"RTN","LREPIRP",73,0)
 ..F  S LRZXE=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"ZXE",LRZXE)) Q:'LRZXE  S LRZXEN=^(LRZXE) D  S LRZXECNT=LRZXECNT+1
"RTN","LREPIRP",74,0)
 ...S ^XTMP("LREPIREP"_LRDATE,"ZXE",$P($P(LRZXEN,HLFS,3),LRCS),DFN,LRZXECNT)=SSN_"    "_LRNAME_$E(LRSP,1,25-$L(LRNAME))_TYPE_" "_$$CDT^LREPIRP2($P(LRZXEN,HLFS,6))
"RTN","LREPIRP",75,0)
 ...S LRZXECNT=LRZXECNT+1
"RTN","LREPIRP",76,0)
 ..S LRNTE=0
"RTN","LREPIRP",77,0)
 ..F  S LRNTE=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE)) Q:'LRNTE  D
"RTN","LREPIRP",78,0)
 ...S LRTYPE=$P($P(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE),HLFS,3),LRCS,1)
"RTN","LREPIRP",79,0)
 ...F LRNUM1=1,3,4,5,6,8,10,18,19,20,21,22,23 D:LRTYPE=LRNUM1
"RTN","LREPIRP",80,0)
 ....S LRTMP=^TMP($J,"TMP",DFN,"PID")
"RTN","LREPIRP",81,0)
 ....D PID^LREPIRP2
"RTN","LREPIRP",82,0)
 ....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1)
"RTN","LREPIRP",83,0)
 ....D PV1^LREPIRP2
"RTN","LREPIRP",84,0)
 ....S LROBR=0
"RTN","LREPIRP",85,0)
 ....F  S LROBR=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR)) Q:'LROBR  D
"RTN","LREPIRP",86,0)
 .....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR)
"RTN","LREPIRP",87,0)
 .....D OBR^LREPIRP2
"RTN","LREPIRP",88,0)
 .....S LROBX=0
"RTN","LREPIRP",89,0)
 .....F  S LROBX=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR,"OBX",LROBX)) Q:'LROBX  D
"RTN","LREPIRP",90,0)
 ......S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR,"OBX",LROBX)
"RTN","LREPIRP",91,0)
 ......D OBX^LREPIRP2
"RTN","LREPIRP",92,0)
 ...F LRNUM1=11,12,13,14 D:LRTYPE=LRNUM1
"RTN","LREPIRP",93,0)
 ....S LRTMP=^TMP($J,"TMP",DFN,"PID")
"RTN","LREPIRP",94,0)
 ....D PID^LREPIRP2
"RTN","LREPIRP",95,0)
 ....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1)
"RTN","LREPIRP",96,0)
 ....D PV1^LREPIRP2
"RTN","LREPIRP",97,0)
 ....S LRDG1=0
"RTN","LREPIRP",98,0)
 ....F  S LRDG1=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"DG1",LRDG1)) Q:'LRDG1  D
"RTN","LREPIRP",99,0)
 .....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"DG1",LRDG1)
"RTN","LREPIRP",100,0)
 .....D DG1^LREPIRP3
"RTN","LREPIRP",101,0)
 ...F LRNUM1=7,9 D:LRTYPE=LRNUM1
"RTN","LREPIRP",102,0)
 ....S LRTMP=^TMP($J,"TMP",DFN,"PID")
"RTN","LREPIRP",103,0)
 ....D PID^LREPIRP2
"RTN","LREPIRP",104,0)
 ....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1)
"RTN","LREPIRP",105,0)
 ....D PV1^LREPIRP2
"RTN","LREPIRP",106,0)
 ....S LRDG1=0
"RTN","LREPIRP",107,0)
 ....F  S LRDG1=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"DG1",LRDG1)) Q:'LRDG1  D
"RTN","LREPIRP",108,0)
 .....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"DG1",LRDG1)
"RTN","LREPIRP",109,0)
 .....D DG1^LREPIRP3
"RTN","LREPIRP",110,0)
 ....S LROBR=0
"RTN","LREPIRP",111,0)
 ....F  S LROBR=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR)) Q:'LROBR  D
"RTN","LREPIRP",112,0)
 .....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR)
"RTN","LREPIRP",113,0)
 .....D OBR^LREPIRP2
"RTN","LREPIRP",114,0)
 .....S LROBX=0
"RTN","LREPIRP",115,0)
 .....F  S LROBX=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR,"OBX",LROBX)) Q:'LROBX  D
"RTN","LREPIRP",116,0)
 ......S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR,"OBX",LROBX)
"RTN","LREPIRP",117,0)
 ......D OBX^LREPIRP2
"RTN","LREPIRP",118,0)
 ...F LRNUM1=2,15,16,17 D:LRTYPE=LRNUM1
"RTN","LREPIRP",119,0)
 ....S LROBR=0
"RTN","LREPIRP",120,0)
 ....F  S LROBR=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR)) Q:'LROBR  D
"RTN","LREPIRP",121,0)
 .....S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR)
"RTN","LREPIRP",122,0)
 .....S LRACCDT=$$CDT($P(LRTMP,HLFS,8))
"RTN","LREPIRP",123,0)
 .....S LROBX=0
"RTN","LREPIRP",124,0)
 .....F  S LROBX=$O(^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR,"OBX",LROBX)) Q:'LROBX  D
"RTN","LREPIRP",125,0)
 ......S LRTMP=^TMP($J,"TMP",DFN,"PID","PV1",LRPV1,"NTE",LRNTE,"OBR",LROBR,"OBX",LROBX)
"RTN","LREPIRP",126,0)
 ......D OBX^LREPIRP4 S LRACCDT=""
"RTN","LREPIRP",127,0)
 D HDG^LREPIRP3,HDGS^LREPIRP6
"RTN","LREPIRP",128,0)
CALTOT ;CALCULATE TOTALS
"RTN","LREPIRP",129,0)
 ;SAVE IN ^XTMP("LREPIREP"_LRDATE,"TOTAL",LRPATH)=# of Occurrences^# of persons with occurrences
"RTN","LREPIRP",130,0)
 S (LRPATH,LRDFN,LRPV1,LROBR,LRPATHCT,LRPERCNT)=0
"RTN","LREPIRP",131,0)
 F LRPATH=1,3:1:14,18:1:23 D  S ^XTMP("LREPIREP"_LRDATE,"TOTAL",LRPATH)=LRPATHCT_U_LRPERCNT,LRPATHCT=0,LRPERCNT=0,LRDFN=0
"RTN","LREPIRP",132,0)
 .F  S LRDFN=$O(^TMP($J,"TMP",LRDFN)) Q:LRDFN=""  D
"RTN","LREPIRP",133,0)
 ..S LRPV1=0,LRPV1NUM=1
"RTN","LREPIRP",134,0)
 ..F  S LRPV1=$O(^TMP($J,"TMP",LRDFN,"PID","PV1",LRPV1)) Q:LRPV1=""  D
"RTN","LREPIRP",135,0)
 ...S LRNTE=0
"RTN","LREPIRP",136,0)
 ...F  S LRNTE=$O(^TMP($J,"TMP",LRDFN,"PID","PV1",LRPV1,"NTE",LRNTE)) Q:LRNTE=""  D
"RTN","LREPIRP",137,0)
 ....S LRTYPE=$P($P(^TMP($J,"TMP",LRDFN,"PID","PV1",LRPV1,"NTE",LRNTE),HLFS,3),LRCS,1)
"RTN","LREPIRP",138,0)
 ....Q:LRTYPE'=LRPATH
"RTN","LREPIRP",139,0)
 ....I LRPV1NUM=1 S LRPERCNT=LRPERCNT+1
"RTN","LREPIRP",140,0)
 ....S LRPATHCT=LRPATHCT+1
"RTN","LREPIRP",141,0)
 ....S LRPV1NUM=LRPV1NUM+1
"RTN","LREPIRP",142,0)
 S (LRPATH,LRDFN,LRPATHCT,LRPERCNT)=0
"RTN","LREPIRP",143,0)
 F LRPATH=2,15,16,17 D  S ^XTMP("LREPIREP"_LRDATE,"TOTAL",LRPATH)=LRPATHCT_U_LRPERCNT,LRPATHCT=0,LRPERCNT=0,LRDFN=0
"RTN","LREPIRP",144,0)
 .F  S LRDFN=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN)) Q:LRDFN="HDG"!(LRDFN="")  D
"RTN","LREPIRP",145,0)
 ..S LRPERCNT=LRPERCNT+1,LRCNT=0
"RTN","LREPIRP",146,0)
 ..F  S LRCNT=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,LRCNT)) Q:LRCNT=""  D
"RTN","LREPIRP",147,0)
 ...S LRPATHCT=LRPATHCT+1
"RTN","LREPIRP",148,0)
 S ^XTMP("LREPIREP"_LRDATE,"DONE")=1
"RTN","LREPIRP",149,0)
MMMSG I $D(LRPREV) D
"RTN","LREPIRP",150,0)
 .S MSG="This report represents a second pass at aquiring data for the EPI from"
"RTN","LREPIRP",151,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",152,0)
 .S MSG="the prior month on Mycobacterium tuberculosis due to the extended"
"RTN","LREPIRP",153,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",154,0)
 .S MSG="period of time that may be expected with accessioning, growth, and"
"RTN","LREPIRP",155,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",156,0)
 .S MSG="finally reporting of results.  Since this is designed to aquire only"
"RTN","LREPIRP",157,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",158,0)
 .S MSG="the remaining Mycobacterium tuberculosis data from the prior month,"
"RTN","LREPIRP",159,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",160,0)
 .S MSG="most of the numbers present for this report will be zero.  The"
"RTN","LREPIRP",161,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",162,0)
 .S MSG="accompanying Summary Verification Report for the current month should"
"RTN","LREPIRP",163,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",164,0)
 .S MSG="contain more complete number counts on the other EPI pathogens and"
"RTN","LREPIRP",165,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",166,0)
 .S MSG="data items for this current month."
"RTN","LREPIRP",167,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP",168,0)
 D MSH
"RTN","LREPIRP",169,0)
 S LRPROT=0,LRPROT=$O(^ORD(101,"B","LREPI",LRPROT))
"RTN","LREPIRP",170,0)
 S LRMGP=$P($G(^LAB(69.4,LRPROT,0)),U,2)
"RTN","LREPIRP",171,0)
 I +LRMGP'>0 W !,"NO MAILGROUP TO SEND MESSAGE!" G EXIT
"RTN","LREPIRP",172,0)
 S LRMGPN=$$GET1^DIQ(69.4,LRPROT,1)
"RTN","LREPIRP",173,0)
 S XMSUB="EPI Summary Verification Report"
"RTN","LREPIRP",174,0)
 I $D(LRPREV) S XMSUB=XMSUB_" for prior month -TB only"
"RTN","LREPIRP",175,0)
 S XMDUZ="POSTMASTER"
"RTN","LREPIRP",176,0)
 S XMY("G."_LRMGPN)="" ;$P(^XMB(3.8,LRMGP,0),U,1))=""
"RTN","LREPIRP",177,0)
 S XMTEXT="^TMP("_$J_",""MSG"","
"RTN","LREPIRP",178,0)
 D ^XMD
"RTN","LREPIRP",179,0)
 K LRMGP,LRMGPN
"RTN","LREPIRP",180,0)
 K ISITE
"RTN","LREPIRP",181,0)
EXIT K LRACCDT,LRDSPN,LRSP,LRPREV,LRZXEN Q
"RTN","LREPIRP",182,0)
MSH ;
"RTN","LREPIRP",183,0)
 D SUMHD1^LREPIRP1
"RTN","LREPIRP",184,0)
 D SUMMARY^LREPIRP5
"RTN","LREPIRP",185,0)
 D NOTE1^LREPIRP1
"RTN","LREPIRP",186,0)
 D SUMHD3^LREPIRP1
"RTN","LREPIRP",187,0)
 D PRTHEP^LREPIRP5
"RTN","LREPIRP",188,0)
 D NOTE2^LREPIRP1
"RTN","LREPIRP",189,0)
 D PRTTOT^LREPIRP5
"RTN","LREPIRP",190,0)
 D NOTE3^LREPIRP1
"RTN","LREPIRP",191,0)
 Q
"RTN","LREPIRP",192,0)
NTE ;NOTE AND COMMENTS
"RTN","LREPIRP",193,0)
 ;D NTE^LREPIRP4
"RTN","LREPIRP",194,0)
 S TYPE=$P($P(LRHL7,HLFS,3),LRCS,1),MSG=""
"RTN","LREPIRP",195,0)
 I TYPE="T" D
"RTN","LREPIRP",196,0)
 .S MSG="TOTAL "_$P($P(LRHL7,HLFS,3),LRCS,2)_"  "
"RTN","LREPIRP",197,0)
 .S MSG=MSG_$P($P(LRHL7,HLFS,3),LRCS,3)_"  "_$P($P(LRHL7,HLFS,3),LRCS,4)
"RTN","LREPIRP",198,0)
 I +TYPE>0 D
"RTN","LREPIRP",199,0)
 .;S:$G(^TMP($J,"MSG",(MSGCNT-1)))'="" ^TMP($J,"MSG",MSGCNT)="",MSGCNT=MSGCNT+1
"RTN","LREPIRP",200,0)
 .S MSG="*********  "_TYPE_"  "_$P($P(LRHL7,HLFS,3),LRCS,2)_"  *********"
"RTN","LREPIRP",201,0)
 K TYPE
"RTN","LREPIRP",202,0)
 Q
"RTN","LREPIRP",203,0)
CDT(DATE) ;CONVERTS THE DATE AND TIME
"RTN","LREPIRP",204,0)
 S X=$E(DATE,5,6)_"-"_$E(DATE,7,8)_"-"_$E(DATE,1,4)
"RTN","LREPIRP",205,0)
 S:$E(DATE,9,12)'="" X=X_"@"_$E(DATE,9,12)
"RTN","LREPIRP",206,0)
 S:X="--" X=""
"RTN","LREPIRP",207,0)
 Q X
"RTN","LREPIRP1")
0^16^B41905812
"RTN","LREPIRP1",1,0)
LREPIRP1 ;DALOI/CKA-EMERGING PATHOGENS HL7 REPORT CONVERSION ;5/14/03
"RTN","LREPIRP1",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP1",3,0)
 ; Reference to $$SITE^VASITE supported by IA # 10112
"RTN","LREPIRP1",4,0)
 ; Reference to ^DIC(21 supported by IA #2504
"RTN","LREPIRP1",5,0)
 Q
"RTN","LREPIRP1",6,0)
 ;SUMMARY VERIFICATION REPORT HEADING
"RTN","LREPIRP1",7,0)
SUMHD1 S SITE=$$SITE^VASITE
"RTN","LREPIRP1",8,0)
 S MSG="SUMMARY VERIFICATION REPORT OF EPI EXTRACTED DATA"
"RTN","LREPIRP1",9,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP1",10,0)
 S MSG="FROM STATION "_$P(SITE,U,3)_" "_$P(SITE,U,2)
"RTN","LREPIRP1",11,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP1",12,0)
SUMHD2 S MSG="",^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP1",13,0)
 S MSG="Processing Month "_LRHDGL2
"RTN","LREPIRP1",14,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP1",15,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1,MSG=""
"RTN","LREPIRP1",16,0)
 S MSG=LRSP_LRSP_$E(LRSP,1,7)_"Number of"
"RTN","LREPIRP1",17,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",18,0)
 S MSG=LRSP_$E(LRSP,1,24)_"Number of    Persons with"
"RTN","LREPIRP1",19,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",20,0)
 S MSG=$E(LRSP,1,2)_"Emerging Pathogen"_LRSP_$E(LRSP,1,3)_"Occurrences    Occurrence"
"RTN","LREPIRP1",21,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",22,0)
 S MSG="________________________________________________________________________________"
"RTN","LREPIRP1",23,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",24,0)
 Q
"RTN","LREPIRP1",25,0)
NOTE1 S MSG="",^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",26,0)
 S MSG="For definitions of case ascertainment for each category, please refer to"
"RTN","LREPIRP1",27,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",28,0)
 S MSG="documentation in Laboratory EPI Patch LR*5.2*281 Technical and"
"RTN","LREPIRP1",29,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",30,0)
 S MSG="User Guide in conjunction with your local parameter set-up of this process."
"RTN","LREPIRP1",31,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",32,0)
 S MSG=""
"RTN","LREPIRP1",33,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",34,0)
 S MSG="If you feel that these numbers are in error, please verify with the local"
"RTN","LREPIRP1",35,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",36,0)
 S MSG="facility personnel responsible for setting the EPI Laboratory Search/Extract"
"RTN","LREPIRP1",37,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",38,0)
 S MSG="parameters.  However, do not change these parameters if they are incorrect"
"RTN","LREPIRP1",39,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",40,0)
 S MSG="without fully reading the documentation;  this will be crucial in order to"
"RTN","LREPIRP1",41,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",42,0)
 S MSG="avoid any misalignment with the concomitant Hepatitis C Extract patches"
"RTN","LREPIRP1",43,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",44,0)
 S MSG="(PXRM*1.5*1, VA-National EPI DB Update, LR*5.2*260, PSJ*5*48, Hepatitis C"
"RTN","LREPIRP1",45,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",46,0)
 S MSG="Initiative, and PSO*7*45, Hepatitis C Initiative).  In particular, the"
"RTN","LREPIRP1",47,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",48,0)
 S MSG="hepatitis C antibody positive, hepatitis C antibody negative, hepatitis A"
"RTN","LREPIRP1",49,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",50,0)
 S MSG="antibody positive and hepatitis B positive will be especially sensitive to"
"RTN","LREPIRP1",51,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",52,0)
 S MSG="changes, and concomitant changes of all of the patches may need to occur."
"RTN","LREPIRP1",53,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",54,0)
 Q
"RTN","LREPIRP1",55,0)
SUMHD3 S MSG=LRSP_LRSP_$E(LRSP,1,1)_"Number of Persons"
"RTN","LREPIRP1",56,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",57,0)
 S MSG=LRSP_LRSP_$E(LRSP,1,1)_"with the Term and"
"RTN","LREPIRP1",58,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",59,0)
 S MSG=LRSP_LRSP_$E(LRSP,1,1)_"Transmitted For"
"RTN","LREPIRP1",60,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",61,0)
 S MSG=$E(LRSP,1,18)_"Nationally rolled-up resolution term"_$E(LRSP,1,7)_"National Roll-up"
"RTN","LREPIRP1",62,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",63,0)
 S MSG="_______________________________________________________________________________"
"RTN","LREPIRP1",64,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",65,0)
 Q
"RTN","LREPIRP1",66,0)
NOTE2 S MSG="This table represents only those who had a once-lifetime resolution of the"
"RTN","LREPIRP1",67,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",68,0)
 S MSG="National Clinical Reminder for Risk Assessment for Hepatitis C.  This"
"RTN","LREPIRP1",69,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",70,0)
 S MSG="resolution will only occur once during the care of a patient (unless actively"
"RTN","LREPIRP1",71,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",72,0)
 S MSG="changed by a point-of-care practitioner at a later date)."
"RTN","LREPIRP1",73,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",74,0)
 Q
"RTN","LREPIRP1",75,0)
NOTE3 S MSG="1. For Microbiology Lab Package Organism results/isolates (e.g."
"RTN","LREPIRP1",76,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",77,0)
 S MSG="Enterococcus, or Streptococcus pneumoniae), the number corresponding"
"RTN","LREPIRP1",78,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",79,0)
 S MSG="to the name represents the total number reported from your local"
"RTN","LREPIRP1",80,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",81,0)
 S MSG="microbiology package during the processing month.  The number"
"RTN","LREPIRP1",82,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",83,0)
 S MSG="corresponding to the line 'Patients with...<Microbiology Lab"
"RTN","LREPIRP1",84,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",85,0)
 S MSG="Result/isolates> (e.g. Patients with Enterococcus or Patients with"
"RTN","LREPIRP1",86,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",87,0)
 S MSG="Streptococcus pneumoniae) represents the number of individual"
"RTN","LREPIRP1",88,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",89,0)
 S MSG="patients from whom the results were isolated."
"RTN","LREPIRP1",90,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",91,0)
 S MSG="2. For non-microbiology results (e.g. chemistry/serology results such"
"RTN","LREPIRP1",92,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",93,0)
 S MSG="as Hepatitis C antibody), the number corresponding to the name"
"RTN","LREPIRP1",94,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",95,0)
 S MSG="represents the TOTAL number of <named> tests done at your facility"
"RTN","LREPIRP1",96,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",97,0)
 S MSG="during the processing month.  The number corresponding to the line"
"RTN","LREPIRP1",98,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",99,0)
 S MSG="<Patients with...<non-Microbiology test> (e.g. Hepatitis C antibody)"
"RTN","LREPIRP1",100,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",101,0)
        S MSG="represents the number of individuals on whom the test(s) was/were"
"RTN","LREPIRP1",102,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",103,0)
 S MSG="performed.  This does not represent the number of persons who had a positive"
"RTN","LREPIRP1",104,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",105,0)
 S MSG=" test result."
"RTN","LREPIRP1",106,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",107,0)
 S MSG="3.  These results have been obtained based on specimen accession"
"RTN","LREPIRP1",108,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",109,0)
 S MSG="date and not results reported dating."
"RTN","LREPIRP1",110,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP1",111,0)
 Q
"RTN","LREPIRP2")
0^17^B9462001
"RTN","LREPIRP2",1,0)
LREPIRP2 ;DALOI/CKA-EMERGING PATHOGENS HL7 REPORT CONVERSION ;5/14/2003
"RTN","LREPIRP2",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP2",3,0)
 ; Reference to ^DIC(21 supported by IA #913
"RTN","LREPIRP2",4,0)
 Q
"RTN","LREPIRP2",5,0)
 ;NTE findings of 1,3,4,5,6,8, or 10
"RTN","LREPIRP2",6,0)
 ;Read through the TMP($,"RPT"
"RTN","LREPIRP2",7,0)
 ;Save in ^XTMP("LREPIREP"_date,path,dfn,"PID")
"RTN","LREPIRP2",8,0)
 ;        ^XTMP("LREPIREP"_date,path,dfn,"PV1",#)
"RTN","LREPIRP2",9,0)
 ;        ^XTMP("LREPIREP"_date,path,dfn,"PV1",#,"OBR",#)
"RTN","LREPIRP2",10,0)
 ;        ^XTMP("LREPIREP"_date,path,dfn,"PV1",#,"OBR",#,"OBX",#)
"RTN","LREPIRP2",11,0)
 ;save PID, PV1, OBR, and OBX data in ^XTMP.
"RTN","LREPIRP2",12,0)
 Q
"RTN","LREPIRP2",13,0)
PID ;PATIENT INFO
"RTN","LREPIRP2",14,0)
 S NM=$P(LRTMP,HLFS,6),SSN=$P(LRTMP,HLFS,20)
"RTN","LREPIRP2",15,0)
 S SSN=$E(SSN,6,9)
"RTN","LREPIRP2",16,0)
 S DOB=$$CDT($P(LRTMP,HLFS,8)),NM=$P(NM,LRCS,2)_" "_$P(NM,LRCS,1)
"RTN","LREPIRP2",17,0)
 S SX=$P(LRTMP,HLFS,9),AD=$P($P(LRTMP,HLFS,12),LRCS,1)
"RTN","LREPIRP2",18,0)
 S ZP=$P($P(LRTMP,HLFS,12),LRCS,2),POS=$P(LRTMP,HLFS,28),POSN=""
"RTN","LREPIRP2",19,0)
 I POS'="",$D(^DIC(21,"D",POS)) S POS=$O(^DIC(21,"D",POS,""))
"RTN","LREPIRP2",20,0)
 S:POS'="" POSN=$P($G(^DIC(21,POS,0)),U,1)
"RTN","LREPIRP2",21,0)
 S MSG=NM_$E(LRSP,1,30-$L(NM))_SSN_$E(LRSP,1,7-$L(SSN))_DOB_$E(LRSP,1,11-$L(DOB))_SX_$E(LRSP,1,3-$L(SX))
"RTN","LREPIRP2",22,0)
 S:POSN'="" MSG=MSG_"   "_POSN
"RTN","LREPIRP2",23,0)
 S MSG=MSG_"   "_AD_"   "_ZP
"RTN","LREPIRP2",24,0)
 S ^XTMP("LREPIREP"_LRDATE,LRTYPE,DFN,"PID")=MSG
"RTN","LREPIRP2",25,0)
 K NM,DOB,SX,POS,AD,ZP,POSN
"RTN","LREPIRP2",26,0)
 Q
"RTN","LREPIRP2",27,0)
PV1 ;PATIENT VISIT ENCOUNTER
"RTN","LREPIRP2",28,0)
 S TYPE=$P(LRTMP,HLFS,3)
"RTN","LREPIRP2",29,0)
 S ENC=$S(TYPE="O":"Accession ",1:"Admission ")_"Date:  "
"RTN","LREPIRP2",30,0)
 S TYPE=$S(TYPE="U":"Update",TYPE="I":"Inpatient",1:"Outpatient")
"RTN","LREPIRP2",31,0)
 S MSG=TYPE_"  "_ENC_$$CDT($P(LRTMP,HLFS,45))
"RTN","LREPIRP2",32,0)
 I TYPE="Inpatient" D
"RTN","LREPIRP2",33,0)
 .S MSG=MSG_"            Discharge Date:  "_$S($P(LRTMP,HLFS,46)="":"",1:$$CDT($P(LRTMP,HLFS,46)))
"RTN","LREPIRP2",34,0)
 .S MSG=MSG_"  Discharge Disposition:  "_$P($P(LRTMP,HLFS,37),LRCS,2)
"RTN","LREPIRP2",35,0)
 S ^XTMP("LREPIREP"_LRDATE,LRTYPE,DFN,"PV1",LRPV1)=MSG
"RTN","LREPIRP2",36,0)
 K TYPE
"RTN","LREPIRP2",37,0)
 Q
"RTN","LREPIRP2",38,0)
CDT(DATE) ;CONVERTS THE DATE AND TIME
"RTN","LREPIRP2",39,0)
 S X=$E(DATE,5,6)_"-"_$E(DATE,7,8)_"-"_$E(DATE,1,4)
"RTN","LREPIRP2",40,0)
 S:$E(DATE,9,12)'="" X=X_"@"_$E(DATE,9,12)
"RTN","LREPIRP2",41,0)
 S:X="--" X=""
"RTN","LREPIRP2",42,0)
 Q X
"RTN","LREPIRP2",43,0)
OBR ;OBSERVATION REPORTING
"RTN","LREPIRP2",44,0)
 S TST=$P(LRTMP,HLFS,5),TSTNM=$P(TST,LRCS,2),MSG=""
"RTN","LREPIRP2",45,0)
 S:TSTNM="" TSTNM=$P(TST,LRCS,5)
"RTN","LREPIRP2",46,0)
 S TOP=$P($P(LRTMP,HLFS,16),LRCS,3)
"RTN","LREPIRP2",47,0)
 S ENTRY=$P($P(LRTMP,HLFS,27),LRCS,2)
"RTN","LREPIRP2",48,0)
 S:+ENTRY MSG="ORG # "_ENTRY_"  "
"RTN","LREPIRP2",49,0)
 S MSG=MSG_$$CDT($P(LRTMP,HLFS,8))_"  "
"RTN","LREPIRP2",50,0)
 S LRACCDT=$$CDT($P(LRTMP,HLFS,8))
"RTN","LREPIRP2",51,0)
 S:$P(LRTMP,HLFS,19)'="" MSG=MSG_$P(LRTMP,HLFS,19)_"  "
"RTN","LREPIRP2",52,0)
 S MSG=MSG_TSTNM_"  "_TOP
"RTN","LREPIRP2",53,0)
 S ^XTMP("LREPIREP"_LRDATE,LRTYPE,DFN,"PV1",LRPV1,"OBR",LROBR)=MSG
"RTN","LREPIRP2",54,0)
 K TST,TSTNM,TOP,ENTRY
"RTN","LREPIRP2",55,0)
 Q
"RTN","LREPIRP2",56,0)
OBX ;RESULTS
"RTN","LREPIRP2",57,0)
 I $P(LRTMP,HLFS,3)="ST" D
"RTN","LREPIRP2",58,0)
 .S TST=$P(LRTMP,HLFS,4),TSTNM=$P(TST,LRCS,2)
"RTN","LREPIRP2",59,0)
 .S:TSTNM="" TSTNM=$P(TST,LRCS,5)
"RTN","LREPIRP2",60,0)
 .S OV=$P(LRTMP,HLFS,6)
"RTN","LREPIRP2",61,0)
 I $P(LRTMP,HLFS,3)="CE" D
"RTN","LREPIRP2",62,0)
 .S TSTNM=""
"RTN","LREPIRP2",63,0)
 .S OV=$P($P(LRTMP,HLFS,6),LRCS,2)
"RTN","LREPIRP2",64,0)
 S MSG="",ENTRY=$P(LRTMP,HLFS,5) S:+ENTRY MSG=ENTRY_"  "
"RTN","LREPIRP2",65,0)
 S MSG=MSG_TSTNM_$E(LRSP,1,30-$L(TSTNM))
"RTN","LREPIRP2",66,0)
 S FD=$$CDT($P(LRTMP,HLFS,15)),RR=$P(LRTMP,HLFS,8)
"RTN","LREPIRP2",67,0)
 S UN=$P(LRTMP,HLFS,7),AF=""
"RTN","LREPIRP2",68,0)
 S MSG="     "_MSG_FD_"   "_OV_$E(LRSP,1,10-$L(OV))_UN_$E(LRSP,1,10-$L(UN))_RR
"RTN","LREPIRP2",69,0)
 S MSG=MSG_$E(LRSP,1,(40-$L(MSG)))_$P(LRTMP,HLFS,9)
"RTN","LREPIRP2",70,0)
 S ^XTMP("LREPIREP"_LRDATE,LRTYPE,DFN,"PV1",LRPV1,"OBR",LROBR,"OBX",LROBX)=MSG
"RTN","LREPIRP2",71,0)
 Q
"RTN","LREPIRP3")
0^18^B78489594
"RTN","LREPIRP3",1,0)
LREPIRP3 ;DALOI/CKA-EMERGING PATHOGENS HL7 REPORT CONVERSION ;5/14/2003
"RTN","LREPIRP3",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP3",3,0)
 ; Reference to $$SITE^VASITE supported by IA #10112
"RTN","LREPIRP3",4,0)
 ; Reference to ^DIC(21 supported by IA #2504
"RTN","LREPIRP3",5,0)
 Q
"RTN","LREPIRP3",6,0)
 ;NTE findings of 11, 12, 13, or 14.
"RTN","LREPIRP3",7,0)
 ;SAVE PID, PV1, and DG1 data.
"RTN","LREPIRP3",8,0)
 Q
"RTN","LREPIRP3",9,0)
PID ;
"RTN","LREPIRP3",10,0)
 D PID^LREPIRP2
"RTN","LREPIRP3",11,0)
PV1 ;
"RTN","LREPIRP3",12,0)
 D PV1^LREPIRP2
"RTN","LREPIRP3",13,0)
DG1 ;Save DG1 data
"RTN","LREPIRP3",14,0)
 ;^XTMP("LREPIREP"_date,PATHOGEN,dfn,"PV1",#,"DG1",#)
"RTN","LREPIRP3",15,0)
 Q
"RTN","LREPIRP3",16,0)
HDG ;Save title heading in ^XTMP("LREPIREP"_date,"HDG",linecount)
"RTN","LREPIRP3",17,0)
 S SITE=$$SITE^VASITE
"RTN","LREPIRP3",18,0)
 S LRDTHDG=^TMP("LREPIREP",$J,1)
"RTN","LREPIRP3",19,0)
 S MSG=$E(LRSP,1,15)_"DETAILED VERIFICATION REPORT OF EPI EXTRACTED DATA"
"RTN","LREPIRP3",20,0)
 S ^XTMP("LREPIREP"_LRDATE,"HDG",1)=MSG
"RTN","LREPIRP3",21,0)
 S MSG=$E(LRSP,1,80-$L(" FROM STATION "_$P(SITE,U,3)_" "_$P(SITE,U,2))/2)_" FROM STATION "_$P(SITE,U,3)_" "_$P(SITE,U,2)
"RTN","LREPIRP3",22,0)
 S ^XTMP("LREPIREP"_LRDATE,"HDG",2)=MSG
"RTN","LREPIRP3",23,0)
 S MSG="PROCESSING PERIOD: "
"RTN","LREPIRP3",24,0)
 S Y=$$CDT^LREPIRP2($P($P($P(LRDTHDG,HLFS,3),LRCS,2)," ",4))
"RTN","LREPIRP3",25,0)
 S MSG=MSG_Y
"RTN","LREPIRP3",26,0)
 S Y=$$CDT^LREPIRP2($P($P($P(LRDTHDG,HLFS,3),LRCS,2)," ",6))
"RTN","LREPIRP3",27,0)
 S LRHDGL2=MSG_"  through "_Y
"RTN","LREPIRP3",28,0)
 S ^XTMP("LREPIREP"_LRDATE,"HDG",3)=$E(LRSP,1,80-$L(LRHDGL2)/2)_LRHDGL2
"RTN","LREPIRP3",29,0)
 ;Save Heading info in ^XTMP("LREPIREP"_date,nte,"HDG",linecount)
"RTN","LREPIRP3",30,0)
NTE11 ;NTE~11 Report of Malaria heading
"RTN","LREPIRP3",31,0)
 S ^XTMP("LREPIREP"_LRDATE,11,"HDG",1)="NTE~11-Report of Malaria"
"RTN","LREPIRP3",32,0)
 S MSG="These data note persons at your facility during the month who had an ICD-9"
"RTN","LREPIRP3",33,0)
 S ^XTMP("LREPIREP"_LRDATE,11,"HDG",2)=MSG
"RTN","LREPIRP3",34,0)
 S MSG="coded diagnosis for malaria.  Identifying information has been provided."
"RTN","LREPIRP3",35,0)
 S ^XTMP("LREPIREP"_LRDATE,11,"HDG",3)=MSG
"RTN","LREPIRP3",36,0)
NTE12 ;NTE~12 Report of Dengue heading
"RTN","LREPIRP3",37,0)
 S MSG="NTE~12-Report of Dengue"
"RTN","LREPIRP3",38,0)
 S ^XTMP("LREPIREP"_LRDATE,12,"HDG",1)=MSG
"RTN","LREPIRP3",39,0)
 S MSG="These data note persons at your facility during the month who had an ICD-9"
"RTN","LREPIRP3",40,0)
 S ^XTMP("LREPIREP"_LRDATE,12,"HDG",2)=MSG
"RTN","LREPIRP3",41,0)
 S MSG="coded diagnosis for dengue.  Identifying information has been provided."
"RTN","LREPIRP3",42,0)
 S ^XTMP("LREPIREP"_LRDATE,12,"HDG",3)=MSG
"RTN","LREPIRP3",43,0)
NTE13 ;NTE~13 Report of Creutzfeldt-Jakob Disease heading
"RTN","LREPIRP3",44,0)
 S MSG="NTE~13-Report of Creutzfeldt-Jakob Disease"
"RTN","LREPIRP3",45,0)
 S ^XTMP("LREPIREP"_LRDATE,13,"HDG",1)=MSG
"RTN","LREPIRP3",46,0)
 S MSG="These data note persons at your facility during the month who had an ICD-9"
"RTN","LREPIRP3",47,0)
 S ^XTMP("LREPIREP"_LRDATE,13,"HDG",2)=MSG
"RTN","LREPIRP3",48,0)
 S MSG="coded diagnosis for Creutzfeldt-Jakob disease.  Identifying information has been provided."
"RTN","LREPIRP3",49,0)
 S ^XTMP("LREPIREP"_LRDATE,13,"HDG",3)=MSG
"RTN","LREPIRP3",50,0)
NTE14 ;NTE~14 Report of Leishmaniasis heading
"RTN","LREPIRP3",51,0)
 S MSG="NTE~14-Report of Leishmaniasis"
"RTN","LREPIRP3",52,0)
 S ^XTMP("LREPIREP"_LRDATE,14,"HDG",1)=MSG
"RTN","LREPIRP3",53,0)
 S MSG="These data note persons at your facility during the month who had an ICD-9"
"RTN","LREPIRP3",54,0)
 S ^XTMP("LREPIREP"_LRDATE,14,"HDG",2)=MSG
"RTN","LREPIRP3",55,0)
 S MSG="coded diagnosis for Leishmania.  Identifying information has been provided."
"RTN","LREPIRP3",56,0)
 S ^XTMP("LREPIREP"_LRDATE,14,"HDG",3)=MSG
"RTN","LREPIRP3",57,0)
FOOT ;FOOTER FOR NTE 11,12,13,14
"RTN","LREPIRP3",58,0)
 S MSG="Initally, only inpatient cases will be captured; however, eventually it is"
"RTN","LREPIRP3",59,0)
 S ^XTMP("LREPIREP"_LRDATE,"FOOTNOTE",1)=MSG
"RTN","LREPIRP3",60,0)
 S MSG="anticiapted that this will include outpatient cases also."
"RTN","LREPIRP3",61,0)
 S ^XTMP("LREPIREP"_LRDATE,"FOOTNOTE",2)=MSG
"RTN","LREPIRP3",62,0)
NTE7 ;NTE~7 Report of Legionella/Legionaire's heading
"RTN","LREPIRP3",63,0)
 S MSG="NTE~7- Report of Legionella/Legionaire's"
"RTN","LREPIRP3",64,0)
 S ^XTMP("LREPIREP"_LRDATE,7,"HDG",1)=MSG
"RTN","LREPIRP3",65,0)
 S MSG="These data note persons at your facility during the month who had an EITHER an"
"RTN","LREPIRP3",66,0)
 S ^XTMP("LREPIREP"_LRDATE,7,"HDG",2)=MSG
"RTN","LREPIRP3",67,0)
 S MSG="ICD-9 coded diagnosis for Legionella/Legionaire's disease OR a positive"
"RTN","LREPIRP3",68,0)
 S ^XTMP("LREPIREP"_LRDATE,7,"HDG",3)=MSG
"RTN","LREPIRP3",69,0)
 S MSG="culture result.  Identifying information, along with specimen and culture"
"RTN","LREPIRP3",70,0)
 S ^XTMP("LREPIREP"_LRDATE,7,"HDG",4)=MSG
"RTN","LREPIRP3",71,0)
 S ^XTMP("LREPIREP"_LRDATE,7,"HDG",5)="results have been provided."
"RTN","LREPIRP3",72,0)
NTE9 ;NTE~9 Report of Cryptosporidium heading
"RTN","LREPIRP3",73,0)
 S MSG="NTE~9-Report of Cryptosporidium"
"RTN","LREPIRP3",74,0)
 S ^XTMP("LREPIREP"_LRDATE,9,"HDG",1)=MSG
"RTN","LREPIRP3",75,0)
 S MSG="These data note persons at your facility during the month who had EITHER an"
"RTN","LREPIRP3",76,0)
 S ^XTMP("LREPIREP"_LRDATE,9,"HDG",2)=MSG
"RTN","LREPIRP3",77,0)
 S MSG="ICD-9 coded diagnosis for Cryptosporidium OR a positive culture result."
"RTN","LREPIRP3",78,0)
 S ^XTMP("LREPIREP"_LRDATE,9,"HDG",3)=MSG
"RTN","LREPIRP3",79,0)
 S ^XTMP("LREPIREP"_LRDATE,9,"HDG",4)="Identifying information, along with specimen and culture results have been"
"RTN","LREPIRP3",80,0)
 S ^XTMP("LREPIREP"_LRDATE,9,"HDG",5)="provided."
"RTN","LREPIRP3",81,0)
 ;
"RTN","LREPIRP3",82,0)
NTE2 ;NTE 2 HEP C ANTIBODY POSITIVE HEADING
"RTN","LREPIRP3",83,0)
 S ^XTMP("LREPIREP"_LRDATE,2,"HDG",1)="NTE~2 Report of Hepatitis C antibody positive"
"RTN","LREPIRP3",84,0)
 S ^XTMP("LREPIREP"_LRDATE,2,"HDG",2)="This represents a line listing of persons reported during the month who had a"
"RTN","LREPIRP3",85,0)
 S ^XTMP("LREPIREP"_LRDATE,2,"HDG",3)="positive test for hepatitis C antibody (based on accession date and not"
"RTN","LREPIRP3",86,0)
 S ^XTMP("LREPIREP"_LRDATE,2,"HDG",4)="results reported date).  Definitions for data to be extracted are provided"
"RTN","LREPIRP3",87,0)
 S ^XTMP("LREPIREP"_LRDATE,2,"HDG",5)="in Technical and User Guide documentation for Laboratory EPI LR*5.2*281."
"RTN","LREPIRP3",88,0)
NTE15 ;NTE 15 HEP C ANTIBODY NEGATIVE HEADING
"RTN","LREPIRP3",89,0)
 S ^XTMP("LREPIREP"_LRDATE,15,"HDG",1)="NTE~15 Report of Hepatitis C antibody negative"
"RTN","LREPIRP3",90,0)
 S ^XTMP("LREPIREP"_LRDATE,15,"HDG",2)="This represents a line listing of persons reported during the month who had a"
"RTN","LREPIRP3",91,0)
 S ^XTMP("LREPIREP"_LRDATE,15,"HDG",3)="negative test for hepatitis C antibody (based on accession date and not"
"RTN","LREPIRP3",92,0)
 S ^XTMP("LREPIREP"_LRDATE,15,"HDG",4)="results reported date).  Definitions for data to be extracted are provided"
"RTN","LREPIRP3",93,0)
 S ^XTMP("LREPIREP"_LRDATE,15,"HDG",5)="in Technical and User Guide documentation for Laboratory EPI LR*5.2*281."
"RTN","LREPIRP3",94,0)
NTE16 ;NTE~16 HEP A ANTIBODY POSITIVE HEADINGS
"RTN","LREPIRP3",95,0)
 S ^XTMP("LREPIREP"_LRDATE,16,"HDG",1)="NTE~16 Report of Hepatitis A antibody positive"
"RTN","LREPIRP3",96,0)
 S ^XTMP("LREPIREP"_LRDATE,16,"HDG",2)="This represents a line listing of persons reported during the month who had a"
"RTN","LREPIRP3",97,0)
 S ^XTMP("LREPIREP"_LRDATE,16,"HDG",3)="positive test for hepatitis A antibody (based on accession date and not"
"RTN","LREPIRP3",98,0)
 S ^XTMP("LREPIREP"_LRDATE,16,"HDG",4)="results reported date).  Definitions for data to be extracted are provided"
"RTN","LREPIRP3",99,0)
 S ^XTMP("LREPIREP"_LRDATE,16,"HDG",5)="in Technical and User Guide documentation for Laboratory EPI LR*5.2*281."
"RTN","LREPIRP3",100,0)
NTE17 ;NTE~17 HEP B POSITIVE HEADING
"RTN","LREPIRP3",101,0)
 S ^XTMP("LREPIREP"_LRDATE,17,"HDG",1)="NTE~17 Report of Hepatitis B positive"
"RTN","LREPIRP3",102,0)
 S ^XTMP("LREPIREP"_LRDATE,17,"HDG",2)="This represents a line listing of persons reported during the month who had a"
"RTN","LREPIRP3",103,0)
 S ^XTMP("LREPIREP"_LRDATE,17,"HDG",3)="positive test for hepatitis B (based on accession date and not results"
"RTN","LREPIRP3",104,0)
 S ^XTMP("LREPIREP"_LRDATE,17,"HDG",4)="reported date).  Definitions for data to be extracted are provided in"
"RTN","LREPIRP3",105,0)
 S ^XTMP("LREPIREP"_LRDATE,17,"HDG",5)="Technical and User Guide documentation for Laboratory EPI LR*5.2*281."
"RTN","LREPIRP3",106,0)
UPD ;UPDATES HEADING
"RTN","LREPIRP3",107,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",1)="UPDATES"
"RTN","LREPIRP3",108,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",2)="This section presents patients who had a transmission of information during a"
"RTN","LREPIRP3",109,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",3)="month on an EPI defined topic that was incomplete.  These patients have"
"RTN","LREPIRP3",110,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",4)="information that has been transmitted during the current processing month in"
"RTN","LREPIRP3",111,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",5)="order to complete the EPI files.  This information usually contains inpatient"
"RTN","LREPIRP3",112,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",6)="information about discharge date, ICD-9 coded diagnoses and occasionally will"
"RTN","LREPIRP3",113,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",7)="contain laboratory based testing.  This line listing of patient, SSN, and"
"RTN","LREPIRP3",114,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",8)="admission date and discharge date is provided to assist with analysis should"
"RTN","LREPIRP3",115,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",9)="an processing/error report occur with your monthly automated transmission of"
"RTN","LREPIRP3",116,0)
 S ^XTMP("LREPIREP"_LRDATE,"UPDHDG",10)="this data."
"RTN","LREPIRP3",117,0)
PHARM ;PHARMACY DATA HEADINGS
"RTN","LREPIRP3",118,0)
 S ^XTMP("LREPIREP"_LRDATE,"PHHDG",1)="Pharmacy-based data extracted for EPI data base."
"RTN","LREPIRP3",119,0)
HEPC ;HEP C RISK ASSESSMENT HEADING
"RTN","LREPIRP3",120,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",1)="Detailed Listing of Hepatitis C Risk Assessment"
"RTN","LREPIRP3",121,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",2)="These Health factors/Resolved terms for hepatitis C risk assessment are the"
"RTN","LREPIRP3",122,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",3)="national Health factors used for roll-up of risk assessment data.  They may not"
"RTN","LREPIRP3",123,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",4)="reflect the terms actually utilized (seen) in the Clinical Reminder package at"
"RTN","LREPIRP3",124,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",5)="this facility.  To determine which local/facility Clinical Reminder health"
"RTN","LREPIRP3",125,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",6)="factor(s) correspond(s) to the national term, please contact your facility"
"RTN","LREPIRP3",126,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",7)="Clinical Reminder application coordinator.  Note that hepatitis C infection"
"RTN","LREPIRP3",127,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",8)="is based on a previously ICD-9 coded diagnosis of hepatitis C at your site/"
"RTN","LREPIRP3",128,0)
 S ^XTMP("LREPIREP"_LRDATE,"HEPCHDG",9)="facility."
"RTN","LREPIRP3",129,0)
 Q
"RTN","LREPIRP4")
0^19^B3163409
"RTN","LREPIRP4",1,0)
LREPIRP4 ;DALOI/CKA-EMERGING PATHOGENS HL7 REPORT CONVERSION ;5/13/03
"RTN","LREPIRP4",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP4",3,0)
 ; Reference to ^DIC(21 supported by IA #2504
"RTN","LREPIRP4",4,0)
 ;This routine builds the ^XTMP global for REF #s 2,15,16,17
"RTN","LREPIRP4",5,0)
 ;^XTMP("LREPIREP"_LRDATE,LRTYPE,DFN,#)
"RTN","LREPIRP4",6,0)
 Q
"RTN","LREPIRP4",7,0)
OBX ;RESULTS
"RTN","LREPIRP4",8,0)
 I $P(LRTMP,HLFS,3)="ST" D
"RTN","LREPIRP4",9,0)
 .S TST=$P(LRTMP,HLFS,4),TSTNM=$P(TST,LRCS,5)
"RTN","LREPIRP4",10,0)
 .;S:TSTNM="" TSTNM=$P(TST,LRCS,5)
"RTN","LREPIRP4",11,0)
 .S OV=$P(LRTMP,HLFS,6)
"RTN","LREPIRP4",12,0)
 I $P(LRTMP,HLFS,3)="CE" D
"RTN","LREPIRP4",13,0)
 .S TSTNM=""
"RTN","LREPIRP4",14,0)
 .S OV=$P($P(LRTMP,HLFS,6),LRCS,2)
"RTN","LREPIRP4",15,0)
 S ENTRY=$P(LRTMP,HLFS,5)
"RTN","LREPIRP4",16,0)
 S FD=$$CDT($P(LRTMP,HLFS,15)),RR=$P(LRTMP,HLFS,8)
"RTN","LREPIRP4",17,0)
 S UN=$P(LRTMP,HLFS,7),AF=""
"RTN","LREPIRP4",18,0)
 S ^XTMP("LREPIREP"_LRDATE,LRTYPE,DFN,LRCNT)=LRNAME_$E(LRSP,1,25-$L(LRNAME))_SSN_"   "_LRACCDT_$E(LRSP,1,16-$L(LRACCDT))_TSTNM_" "_OV
"RTN","LREPIRP4",19,0)
 S LRCNT=LRCNT+1
"RTN","LREPIRP4",20,0)
 Q
"RTN","LREPIRP4",21,0)
PV1 ;
"RTN","LREPIRP4",22,0)
 S TYPE=$P(LRTMP,HLFS,3)
"RTN","LREPIRP4",23,0)
 S ENC=$S(TYPE="O":"Accession ",1:"Admission ")_"Date  "
"RTN","LREPIRP4",24,0)
 S TYPE=$S(TYPE="U":"Update",TYPE="I":"Inpatient ",1:"Outpatient")
"RTN","LREPIRP4",25,0)
 S MSG=TYPE_"  "_ENC_$$CDT($P(LRTMP,HLFS,45))
"RTN","LREPIRP4",26,0)
 Q:$P(LRTMP,HLFS,46)=""
"RTN","LREPIRP4",27,0)
 S MSG="            Discharge Date  "_$$CDT($P(LRTMP,HLFS,46))
"RTN","LREPIRP4",28,0)
 S MSG=MSG_"  Discharge Disposition  "_$P($P(LRTMP,HLFS,37),LRCS,2)
"RTN","LREPIRP4",29,0)
 S ^TMP($J,"RPT",LRTYPE,DFN,"PV1",LRPV1)=MSG
"RTN","LREPIRP4",30,0)
 K TYPE
"RTN","LREPIRP4",31,0)
 Q
"RTN","LREPIRP4",32,0)
CDT(DATE) ;CONVERTS THE DATE AND TIME
"RTN","LREPIRP4",33,0)
 S X=$E(DATE,5,6)_"-"_$E(DATE,7,8)_"-"_$E(DATE,1,4)
"RTN","LREPIRP4",34,0)
 S:$E(DATE,9,12)'="" X=X_"@"_$E(DATE,9,12)
"RTN","LREPIRP4",35,0)
 S:X="--" X=""
"RTN","LREPIRP4",36,0)
 Q X
"RTN","LREPIRP5")
0^20^B38384061
"RTN","LREPIRP5",1,0)
LREPIRP5 ;DALOI/CKA-EMERGING PATHOGENS HL7 REPORT CONVERSION ;5/13/03
"RTN","LREPIRP5",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP5",3,0)
 ; Reference to ^DIC(21 supported by IA #2504
"RTN","LREPIRP5",4,0)
 Q
"RTN","LREPIRP5",5,0)
SUMMARY ;BUILD SUMMARY REPORT
"RTN","LREPIRP5",6,0)
 ; BUILD SUMMARY INFO
"RTN","LREPIRP5",7,0)
 S LRPATH=0
"RTN","LREPIRP5",8,0)
 F  S LRPATH=$O(^XTMP("LREPIREP"_LRDATE,"TOTAL",LRPATH)) Q:LRPATH=""  D
"RTN","LREPIRP5",9,0)
 .S LRTOT(LRPATH)=^XTMP("LREPIREP"_LRDATE,"TOTAL",LRPATH)
"RTN","LREPIRP5",10,0)
 S MSG="NTE~1-Vancomycin-resistant Enterococcus"
"RTN","LREPIRP5",11,0)
 S MSG=MSG_$E(LRSP,1,17)_$J($P(LRTOT(1),U),5)_"   "_$J($P(LRTOT(1),U,2),5)
"RTN","LREPIRP5",12,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",13,0)
 S MSG="NTE~2-Hepatitis C antibody Positive"
"RTN","LREPIRP5",14,0)
 S MSG=MSG_$E(LRSP,1,21)_$J($P(LRTOT(2),U),5)_"   "_$J($P(LRTOT(2),U,2),5)
"RTN","LREPIRP5",15,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",16,0)
 S MSG="NTE~3-Penicillin-Resistant Streptococcus pneumoniae"
"RTN","LREPIRP5",17,0)
 S MSG=MSG_$E(LRSP,1,5)_$J($P(LRTOT(3),U),5)_"   "_$J($P(LRTOT(3),U,2),5)
"RTN","LREPIRP5",18,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",19,0)
 S MSG="NTE~4-Clostridium difficile"
"RTN","LREPIRP5",20,0)
 S MSG=MSG_$E(LRSP,1,29)_$J($P(LRTOT(4),U),5)_"   "_$J($P(LRTOT(4),U,2),5)
"RTN","LREPIRP5",21,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",22,0)
 S MSG="NTE~5-Tuberculosis"
"RTN","LREPIRP5",23,0)
 S MSG=MSG_LRSP_$E(LRSP,1,8)_$J($P(LRTOT(5),U),5)_"   "_$J($P(LRTOT(5),U,2),5)
"RTN","LREPIRP5",24,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",25,0)
 S MSG="NTE~6-Streptococcus, Group A"
"RTN","LREPIRP5",26,0)
 S MSG=MSG_$E(LRSP,1,28)_$J($P(LRTOT(6),U),5)_"   "_$J($P(LRTOT(6),U,2),5)
"RTN","LREPIRP5",27,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",28,0)
 S MSG="NTE~7-Legionella/Legionaire's Disease"
"RTN","LREPIRP5",29,0)
 S MSG=MSG_$E(LRSP,1,19)_$J($P(LRTOT(7),U),5)_"   "_$J($P(LRTOT(7),U,2),5)
"RTN","LREPIRP5",30,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",31,0)
 S MSG="NTE~8-Candida bloodstream infections"
"RTN","LREPIRP5",32,0)
 S MSG=MSG_$E(LRSP,1,20)_$J($P(LRTOT(8),U),5)_"   "_$J($P(LRTOT(8),U,2),5)
"RTN","LREPIRP5",33,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",34,0)
 S MSG="NTE~9-Crytosporidium"
"RTN","LREPIRP5",35,0)
 S MSG=MSG_LRSP_$E(LRSP,1,6)_$J($P(LRTOT(9),U),5)_"   "_$J($P(LRTOT(9),U,2),5)
"RTN","LREPIRP5",36,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",37,0)
 S MSG="NTE~10-Escherichia coli O157"
"RTN","LREPIRP5",38,0)
 S MSG=MSG_$E(LRSP,1,28)_$J($P(LRTOT(10),U),5)_"   "_$J($P(LRTOT(10),U,2),5)
"RTN","LREPIRP5",39,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",40,0)
 S MSG="NTE~11-Malaria"
"RTN","LREPIRP5",41,0)
 S MSG=MSG_LRSP_$E(LRSP,1,12)_$J($P(LRTOT(11),U),5)_"   "_$J($P(LRTOT(11),U,2),5)
"RTN","LREPIRP5",42,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",43,0)
 S MSG="NTE~12-Dengue"
"RTN","LREPIRP5",44,0)
 S MSG=MSG_LRSP_$E(LRSP,1,13)_$J($P(LRTOT(12),U),5)_"   "_$J($P(LRTOT(12),U,2),5)
"RTN","LREPIRP5",45,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",46,0)
 S MSG="NTE~13-Creutzfeldt-Jakob Disease"
"RTN","LREPIRP5",47,0)
 S MSG=MSG_$E(LRSP,1,24)_$J($P(LRTOT(13),U),5)_"   "_$J($P(LRTOT(13),U,2),5)
"RTN","LREPIRP5",48,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",49,0)
 S MSG="NTE~14-Leishmaniasis"
"RTN","LREPIRP5",50,0)
 S MSG=MSG_LRSP_$E(LRSP,1,6)_$J($P(LRTOT(14),U),5)_"   "_$J($P(LRTOT(14),U,2),5)
"RTN","LREPIRP5",51,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",52,0)
 S MSG="NTE~15-Hepatitis C antibody negative"
"RTN","LREPIRP5",53,0)
 S MSG=MSG_$E(LRSP,1,20)_$J($P(LRTOT(15),U),5)_"   "_$J($P(LRTOT(15),U,2),5)
"RTN","LREPIRP5",54,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",55,0)
 S MSG="NTE~16-Hepatitis A antibody positive"
"RTN","LREPIRP5",56,0)
 S MSG=MSG_$E(LRSP,1,20)_$J($P(LRTOT(16),U),5)_"   "_$J($P(LRTOT(16),U,2),5)
"RTN","LREPIRP5",57,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",58,0)
 S MSG="NTE~17-Hepatitis B positive"
"RTN","LREPIRP5",59,0)
 S MSG=MSG_$E(LRSP,1,29)_$J($P(LRTOT(17),U),5)_"   "_$J($P(LRTOT(17),U,2),5)
"RTN","LREPIRP5",60,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",61,0)
 S MSG="NTE~18-All Staphylococcus Aureus"
"RTN","LREPIRP5",62,0)
 S MSG=MSG_$E(LRSP,1,24)_$J($P(LRTOT(18),U),5)_"   "_$J($P(LRTOT(18),U,2),5)
"RTN","LREPIRP5",63,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",64,0)
 S MSG="NTE~19-Methicillin-Resistant Staphylococcus Aureus (Mrsa)"
"RTN","LREPIRP5",65,0)
 S MSG=MSG_$J($P(LRTOT(19),U),4)_"   "_$J($P(LRTOT(19),U,2),5)
"RTN","LREPIRP5",66,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",67,0)
 S MSG="NTE~20-Vancomycin-Resistant Staphylococcus Aureus (Vrsa)"
"RTN","LREPIRP5",68,0)
 S MSG=MSG_$J($P(LRTOT(20),U),5)_"   "_$J($P(LRTOT(20),U,2),5)
"RTN","LREPIRP5",69,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",70,0)
 S MSG="NTE~21-Vancomycin-Resistant Coagulase Negative"
"RTN","LREPIRP5",71,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",72,0)
 S MSG="       Staphylococci/Staph EPI (Vrse)"
"RTN","LREPIRP5",73,0)
 S MSG=MSG_$E(LRSP,1,19)_$J($P(LRTOT(21),U),5)_"   "_$J($P(LRTOT(21),U,2),5)
"RTN","LREPIRP5",74,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",75,0)
 S MSG="NTE~22-All Streptococcus Pneumoniae"
"RTN","LREPIRP5",76,0)
 S MSG=MSG_$E(LRSP,1,21)_$J($P(LRTOT(22),U),5)_"   "_$J($P(LRTOT(22),U,2),5)
"RTN","LREPIRP5",77,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",78,0)
 S MSG="NTE~23-All Enterococci"
"RTN","LREPIRP5",79,0)
 S MSG=MSG_LRSP_$E(LRSP,1,4)_$J($P(LRTOT(23),U),5)_"   "_$J($P(LRTOT(23),U,2),5)
"RTN","LREPIRP5",80,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",81,0)
 Q
"RTN","LREPIRP5",82,0)
PRTTOT ;Print totals on summary report
"RTN","LREPIRP5",83,0)
 S MSG="",^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",84,0)
 S MSG="Processing Month: "_LRHDGL2_" for site # "_$P(SITE,U,3)_" "_$P(SITE,U,2)
"RTN","LREPIRP5",85,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",86,0)
 S MSG="Site totals"
"RTN","LREPIRP5",87,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",88,0)
 S MSG="",^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",89,0)
 S LRNUM=0
"RTN","LREPIRP5",90,0)
 F  S LRNUM=$O(^XTMP("LREPIREP"_LRDATE,"TOTAL1",LRNUM)) Q:LRNUM=""  D
"RTN","LREPIRP5",91,0)
 .S MSG=$P($P(^XTMP("LREPIREP"_LRDATE,"TOTAL1",LRNUM),HLFS,3),LRCS,3)
"RTN","LREPIRP5",92,0)
 .I 60-$L(MSG)>30 S MSG=MSG_LRSP
"RTN","LREPIRP5",93,0)
 .I 60-$L(MSG)>30 S MSG=MSG_LRSP
"RTN","LREPIRP5",94,0)
 .S MSG=MSG_$E(LRSP,1,60-$L(MSG))
"RTN","LREPIRP5",95,0)
 .S MSG=MSG_$J($P($P(^XTMP("LREPIREP"_LRDATE,"TOTAL1",LRNUM),HLFS,3),LRCS,4),5)
"RTN","LREPIRP5",96,0)
 .S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",97,0)
 Q
"RTN","LREPIRP5",98,0)
PRTHEP ;PRINT HEP C RISK ASSESSMENT TOTALS
"RTN","LREPIRP5",99,0)
 F LRNUM=1:1:7 S LRTOT(LRNUM)=+$G(^XTMP("LREPIREP"_LRDATE,"HEPTOT",LRNUM))
"RTN","LREPIRP5",100,0)
 S MSG="Resolved term-1-Declined Assessment for Hepatitis C"
"RTN","LREPIRP5",101,0)
 S MSG=MSG_$E(LRSP,1,9)_$J($P(LRTOT(1),U),5)
"RTN","LREPIRP5",102,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",103,0)
 S MSG="Resolved term-2-No Risk Factors for Hepatitis C"
"RTN","LREPIRP5",104,0)
 S MSG=MSG_$E(LRSP,1,13)_$J($P(LRTOT(2),U),5)
"RTN","LREPIRP5",105,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",106,0)
 S MSG="Resolved term-3-Previously Assessed for Hepatitis C"
"RTN","LREPIRP5",107,0)
 S MSG=MSG_$E(LRSP,1,9)_$J($P(LRTOT(3),U),5)
"RTN","LREPIRP5",108,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",109,0)
 S MSG="Resolved term-4-Risk Factors for Hepatitis C"
"RTN","LREPIRP5",110,0)
 S MSG=MSG_$E(LRSP,1,16)_$J($P(LRTOT(4),U),5)
"RTN","LREPIRP5",111,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",112,0)
 S MSG="Resolved term-5-Positive Test for Hepatitis C antibody"
"RTN","LREPIRP5",113,0)
 S MSG=MSG_$E(LRSP,1,6)_$J($P(LRTOT(5),U),5)
"RTN","LREPIRP5",114,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",115,0)
 S MSG="Resolved term-6-Negative Test for Hepatitis C antibody"
"RTN","LREPIRP5",116,0)
 S MSG=MSG_$E(LRSP,1,6)_$J($P(LRTOT(6),U),5)
"RTN","LREPIRP5",117,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",118,0)
 S MSG="Resolved term-7-Hepatitis C diagnosis (ICD-9 based)"
"RTN","LREPIRP5",119,0)
 S MSG=MSG_$E(LRSP,1,9)_$J($P(LRTOT(7),U),5)
"RTN","LREPIRP5",120,0)
 S ^TMP($J,"MSG",MSGCNT)=MSG,MSGCNT=MSGCNT+1
"RTN","LREPIRP5",121,0)
 S ^TMP($J,"MSG",MSGCNT)=LRSP_LRSP_"-----"
"RTN","LREPIRP5",122,0)
 S MSGCNT=MSGCNT+1
"RTN","LREPIRP5",123,0)
 S LRTOT=LRTOT(1)+LRTOT(2)+LRTOT(3)+LRTOT(4)+LRTOT(5)+LRTOT(6)+LRTOT(7)
"RTN","LREPIRP5",124,0)
 S ^TMP($J,"MSG",MSGCNT)="Total Hepatitis C Risk Assessment Resolution"_$E(LRSP,1,16)_$J(LRTOT,5)
"RTN","LREPIRP5",125,0)
 S MSGCNT=MSGCNT+1
"RTN","LREPIRP5",126,0)
 ;
"RTN","LREPIRP5",127,0)
 Q
"RTN","LREPIRP6")
0^21^B47406279
"RTN","LREPIRP6",1,0)
LREPIRP6 ;DALOI/CKA-EMERGING PATHOGENS DETAILED VERIFICATION REPORT ;5/14/2003
"RTN","LREPIRP6",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP6",3,0)
 ; Reference to ^DIC(21 supported by IA #2504
"RTN","LREPIRP6",4,0)
 Q
"RTN","LREPIRP6",5,0)
 ;HEADINGS of 1,3,4,5,6,8,10,18,19,20,21,22,23
"RTN","LREPIRP6",6,0)
 ;Save in ^XTMP("LREPIREP"_date,path,"HDG",#)
"RTN","LREPIRP6",7,0)
CDT(DATE) ;CONVERTS THE DATE AND TIME
"RTN","LREPIRP6",8,0)
 S X=$E(DATE,5,6)_"-"_$E(DATE,7,8)_"-"_$E(DATE,1,4)
"RTN","LREPIRP6",9,0)
 S:$E(DATE,9,12)'="" X=X_"@"_$E(DATE,9,12)
"RTN","LREPIRP6",10,0)
 S:X="--" X=""
"RTN","LREPIRP6",11,0)
 Q X
"RTN","LREPIRP6",12,0)
HDGS ;1-VANCOMYCIN-RESISTANT ENTEROCOCCUS
"RTN","LREPIRP6",13,0)
 S ^XTMP("LREPIREP"_LRDATE,1,"HDG",1)="NTE~1-Report of Vancomycin-resistant Enterococcus"
"RTN","LREPIRP6",14,0)
 S ^XTMP("LREPIREP"_LRDATE,1,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",15,0)
 S ^XTMP("LREPIREP"_LRDATE,1,"HDG",3)="result for Vancomycin-resistant Enterococcus.  Identifying information, along "
"RTN","LREPIRP6",16,0)
 S ^XTMP("LREPIREP"_LRDATE,1,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",17,0)
 ;
"RTN","LREPIRP6",18,0)
 ;3-PENICILLIN-RESISTANT STREPTOCOCCUS PNEUMONIAE
"RTN","LREPIRP6",19,0)
 S ^XTMP("LREPIREP"_LRDATE,3,"HDG",1)="NTE~3-Report of Pencillin-resistant Streptococcus pneumoniae"
"RTN","LREPIRP6",20,0)
 S ^XTMP("LREPIREP"_LRDATE,3,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",21,0)
 S ^XTMP("LREPIREP"_LRDATE,3,"HDG",3)="result for Penicillin-resistant Streptococcus pneumoniae.  Identifying"
"RTN","LREPIRP6",22,0)
 S ^XTMP("LREPIREP"_LRDATE,3,"HDG",4)=" information, along with specimen and culture results have been provided."
"RTN","LREPIRP6",23,0)
 ;
"RTN","LREPIRP6",24,0)
 ;4-clostridium difficile
"RTN","LREPIRP6",25,0)
 S ^XTMP("LREPIREP"_LRDATE,4,"HDG",1)="NTE~4-Report of Clostridium difficile"
"RTN","LREPIRP6",26,0)
 S ^XTMP("LREPIREP"_LRDATE,4,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",27,0)
 S ^XTMP("LREPIREP"_LRDATE,4,"HDG",3)="result for Clostridium difficile.  Identifying information, along "
"RTN","LREPIRP6",28,0)
 S ^XTMP("LREPIREP"_LRDATE,4,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",29,0)
 ;
"RTN","LREPIRP6",30,0)
 ;5-TUBERCULOSIS
"RTN","LREPIRP6",31,0)
 S ^XTMP("LREPIREP"_LRDATE,5,"HDG",1)="NTE~5-Report of Tuberculosis"
"RTN","LREPIRP6",32,0)
 S ^XTMP("LREPIREP"_LRDATE,5,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",33,0)
 S ^XTMP("LREPIREP"_LRDATE,5,"HDG",3)="result for Mycobacterium tuberculosis.  Identifying information, along "
"RTN","LREPIRP6",34,0)
 S ^XTMP("LREPIREP"_LRDATE,5,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",35,0)
 ;
"RTN","LREPIRP6",36,0)
 ;6-Group A Streptococcus
"RTN","LREPIRP6",37,0)
 S ^XTMP("LREPIREP"_LRDATE,6,"HDG",1)="NTE~6-Report of Group A Streptococcus"
"RTN","LREPIRP6",38,0)
 S ^XTMP("LREPIREP"_LRDATE,6,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",39,0)
 S ^XTMP("LREPIREP"_LRDATE,6,"HDG",3)="result for Group A Streptococcus.  Identifying information, along "
"RTN","LREPIRP6",40,0)
 S ^XTMP("LREPIREP"_LRDATE,6,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",41,0)
 ;
"RTN","LREPIRP6",42,0)
 ;8 - Candida Bloodstream Infections
"RTN","LREPIRP6",43,0)
 S ^XTMP("LREPIREP"_LRDATE,8,"HDG",1)="NTE~8-Report of Candida bloodstream infections"
"RTN","LREPIRP6",44,0)
 S ^XTMP("LREPIREP"_LRDATE,8,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",45,0)
 S ^XTMP("LREPIREP"_LRDATE,8,"HDG",3)="result for Candida (or other yeast) bloodstream infections.  Identifying"
"RTN","LREPIRP6",46,0)
 S ^XTMP("LREPIREP"_LRDATE,8,"HDG",4)="information, along with specimen and culture results have been provided."
"RTN","LREPIRP6",47,0)
 ;
"RTN","LREPIRP6",48,0)
 ;10- Escherichia coli O157
"RTN","LREPIRP6",49,0)
 S ^XTMP("LREPIREP"_LRDATE,10,"HDG",1)="NTE~10-Report of Escherichia coli O157"
"RTN","LREPIRP6",50,0)
 S ^XTMP("LREPIREP"_LRDATE,10,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",51,0)
 S ^XTMP("LREPIREP"_LRDATE,10,"HDG",3)="result for Escherichia coli serotype O157.  Identifying information, along "
"RTN","LREPIRP6",52,0)
 S ^XTMP("LREPIREP"_LRDATE,10,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",53,0)
 ;18-All Staphylococcus aureus
"RTN","LREPIRP6",54,0)
 S ^XTMP("LREPIREP"_LRDATE,18,"HDG",1)="NTE~18-Report of All Staphylococcus aureus"
"RTN","LREPIRP6",55,0)
 S ^XTMP("LREPIREP"_LRDATE,18,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",56,0)
 S ^XTMP("LREPIREP"_LRDATE,18,"HDG",3)="result for all Staphylococcus aureus.  Identifying information, along "
"RTN","LREPIRP6",57,0)
 S ^XTMP("LREPIREP"_LRDATE,18,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",58,0)
 ;19-Methicillin-resistant Staphylococcus aureus
"RTN","LREPIRP6",59,0)
 S ^XTMP("LREPIREP"_LRDATE,19,"HDG",1)="NTE~19-Report of methicillin-resistant Staphylococcus"
"RTN","LREPIRP6",60,0)
 S ^XTMP("LREPIREP"_LRDATE,19,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",61,0)
 S ^XTMP("LREPIREP"_LRDATE,19,"HDG",3)="result for methicillin-resistant Staphylococcus aureus.  Identifying"
"RTN","LREPIRP6",62,0)
 S ^XTMP("LREPIREP"_LRDATE,19,"HDG",4)="information, along with specimen and culture results have been provided."
"RTN","LREPIRP6",63,0)
 ;20-Vancomycin-resistant Staphylococcus aureus
"RTN","LREPIRP6",64,0)
 S ^XTMP("LREPIREP"_LRDATE,20,"HDG",1)="NTE~20-Vancomycin-resistant Staphylococcus aureus"
"RTN","LREPIRP6",65,0)
 S ^XTMP("LREPIREP"_LRDATE,20,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",66,0)
 S ^XTMP("LREPIREP"_LRDATE,20,"HDG",3)="result for Vancomycin-resistant Staphylococcus aureus.  Identifying information,"
"RTN","LREPIRP6",67,0)
 S ^XTMP("LREPIREP"_LRDATE,20,"HDG",4)="along with specimen and culture results have been provided."
"RTN","LREPIRP6",68,0)
 ;
"RTN","LREPIRP6",69,0)
 ;21-Vancomycin-resistant coagulase negative Staphylococcus
"RTN","LREPIRP6",70,0)
 S ^XTMP("LREPIREP"_LRDATE,21,"HDG",1)="NTE~21-Vancomycin-resistant coagulase negative Staphylococcus"
"RTN","LREPIRP6",71,0)
 S ^XTMP("LREPIREP"_LRDATE,21,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",72,0)
 S ^XTMP("LREPIREP"_LRDATE,21,"HDG",3)="result for Vancomycin-resistant coagulase negative staphylococcus.  Identifying"
"RTN","LREPIRP6",73,0)
 S ^XTMP("LREPIREP"_LRDATE,21,"HDG",4)="information, along with specimen and culture results have been provided."
"RTN","LREPIRP6",74,0)
 ;
"RTN","LREPIRP6",75,0)
 ;22-All Streptococcus pneumoniae
"RTN","LREPIRP6",76,0)
 S ^XTMP("LREPIREP"_LRDATE,22,"HDG",1)="NTE~22-All Streptococcus pneumoniae"
"RTN","LREPIRP6",77,0)
 S ^XTMP("LREPIREP"_LRDATE,22,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",78,0)
 S ^XTMP("LREPIREP"_LRDATE,22,"HDG",3)="result for all Streptococcus pneumoniae.  Identifying information, along "
"RTN","LREPIRP6",79,0)
 S ^XTMP("LREPIREP"_LRDATE,22,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",80,0)
 ;
"RTN","LREPIRP6",81,0)
 ;23- All enterococci
"RTN","LREPIRP6",82,0)
 S ^XTMP("LREPIREP"_LRDATE,23,"HDG",1)="NTE~23- All Enterococci"
"RTN","LREPIRP6",83,0)
 S ^XTMP("LREPIREP"_LRDATE,23,"HDG",2)="These data note persons at your facility during the month who had a positive"
"RTN","LREPIRP6",84,0)
 S ^XTMP("LREPIREP"_LRDATE,23,"HDG",3)="result for all Enterococci.  Identifying information, along "
"RTN","LREPIRP6",85,0)
 S ^XTMP("LREPIREP"_LRDATE,23,"HDG",4)="with specimen and culture results have been provided."
"RTN","LREPIRP6",86,0)
 ;
"RTN","LREPIRP6",87,0)
 Q
"RTN","LREPIRP7")
0^23^B69038659
"RTN","LREPIRP7",1,0)
LREPIRP7 ;DALOI/CKA - EPI-PRINT VERIFICATION REPORT ; 5/14/03
"RTN","LREPIRP7",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP7",3,0)
 ; Reference to X ^DD("DD") supported by IA #10017
"RTN","LREPIRP7",4,0)
 ;USED TO PRINT VERIFICATION REPORT
"RTN","LREPIRP7",5,0)
 W !?5,"Print Detailed Verification Report Option",!!
"RTN","LREPIRP7",6,0)
CHOOSE ;which date report to print
"RTN","LREPIRP7",7,0)
 S LRNODE="LREPIREP",LRDATE=0,LRNUM=1
"RTN","LREPIRP7",8,0)
 F  S LRNODE=$O(^XTMP(LRNODE)) Q:LRNODE=""!(LRNODE'["LREPIREP")  S LRDATE=$E(LRNODE,9,22) D
"RTN","LREPIRP7",9,0)
 .S Y=LRDATE X ^DD("DD") S LRREP(LRNUM)=LRDATE_"^"_Y,LRNUM=LRNUM+1
"RTN","LREPIRP7",10,0)
 F LRNUM=1:1 Q:'$D(LRREP(LRNUM))  W !,LRNUM_" "_$P(LRREP(LRNUM),"^",2)
"RTN","LREPIRP7",11,0)
 S LRNUM=LRNUM-1
"RTN","LREPIRP7",12,0)
 S DIR(0)="NO^1:"_LRNUM
"RTN","LREPIRP7",13,0)
 S DIR("A")="Choose the number for the report you wish to print"
"RTN","LREPIRP7",14,0)
 D ^DIR
"RTN","LREPIRP7",15,0)
 G:$D(DIRUT) EXIT
"RTN","LREPIRP7",16,0)
 S LRREP=Y
"RTN","LREPIRP7",17,0)
 K DIR,DIRUT
"RTN","LREPIRP7",18,0)
 G:$D(DIRUT) CHOOSE
"RTN","LREPIRP7",19,0)
 S LRDATE=$P(LRREP(LRREP),"^")
"RTN","LREPIRP7",20,0)
 I '$D(^XTMP("LREPIREP"_LRDATE,"DONE")) D  Q
"RTN","LREPIRP7",21,0)
 .W !!
"RTN","LREPIRP7",22,0)
 .W !?5,"This report is not completed generating."
"RTN","LREPIRP7",23,0)
 .W !?5,"Please try again later."
"RTN","LREPIRP7",24,0)
 .S LREND=1
"RTN","LREPIRP7",25,0)
PRIV ;PRIVACY MESSAGE
"RTN","LREPIRP7",26,0)
 W !!!,"This report will contain Confidential Information."
"RTN","LREPIRP7",27,0)
 K DIR S DIR(0)="Y",DIR("A")="Do you wish to continue/proceed"
"RTN","LREPIRP7",28,0)
 S DIR("B")="NO"
"RTN","LREPIRP7",29,0)
 D ^DIR S:$D(DIRUT) LREND=1
"RTN","LREPIRP7",30,0)
 G:'Y EXIT
"RTN","LREPIRP7",31,0)
ALL K DIR,DIRUT
"RTN","LREPIRP7",32,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Include All Pathogens"
"RTN","LREPIRP7",33,0)
 S DIR("?")="Enter (Y)es or return for all entries to be Selected"
"RTN","LREPIRP7",34,0)
 D ^DIR
"RTN","LREPIRP7",35,0)
 S LRALL=+Y
"RTN","LREPIRP7",36,0)
 K DIR
"RTN","LREPIRP7",37,0)
 I +LRALL'>0 D
"RTN","LREPIRP7",38,0)
 .W @IOF
"RTN","LREPIRP7",39,0)
 .F  Q:$D(DIRUT)  D  Q:X=""
"RTN","LREPIRP7",40,0)
 ..S DIR(0)="PAO^69.5:EMZ",DIR("A")="Select Pathogens: "
"RTN","LREPIRP7",41,0)
 ..S DIR("?")="Select the Pathogens. "
"RTN","LREPIRP7",42,0)
 ..S DIR("S")="I Y<100"
"RTN","LREPIRP7",43,0)
 ..D ^DIR
"RTN","LREPIRP7",44,0)
 ..K DIR,DTOUT,DUOUT,DIRUT
"RTN","LREPIRP7",45,0)
 ..Q:$D(DIRUT)!(Y=-1)
"RTN","LREPIRP7",46,0)
 ..S LREPI($P(^LAB(69.5,+Y,0),U,9))=+Y
"RTN","LREPIRP7",47,0)
 G:$D(DTOUT)!$D(DUOUT)!$D(DIRUT) CHOOSE
"RTN","LREPIRP7",48,0)
 I '$D(LREPI)&('LRALL) W !,"Sorry No Pathogens Selected" G CHOOSE
"RTN","LREPIRP7",49,0)
 D REP
"RTN","LREPIRP7",50,0)
EXIT ;
"RTN","LREPIRP7",51,0)
 D ^%ZISC
"RTN","LREPIRP7",52,0)
 K DIC,D0,LRAUTO,LRBEG,LRDT,LREND,LRRNDT,LREPI,LRRPE,LRRPS,ZTSAVE
"RTN","LREPIRP7",53,0)
 K ZTRTN,ZTIO,ZTDESC,ZTDTH,ZTSK,X,Y,X1,%DT,POP,%ZIS
"RTN","LREPIRP7",54,0)
 K LRCOUNT,LRLC,LRHDG,LRQUIT,LRHDGLC,LRPAGE,LRNODE
"RTN","LREPIRP7",55,0)
 K DIR,DIRUT,DTOUT,DUOUT,J,LRMSGLIN,LRREP,LRSPSHT,MSG
"RTN","LREPIRP7",56,0)
 K LRALL,LRCOUNT,LRDATE,LRDFN,LRDG1,LRDSPCNT,LRNUM,LROBR,LROBX,LRPAGE
"RTN","LREPIRP7",57,0)
 K LRPATH,LRPID,LRSEG,LRTYPE,LRUPDNUM,LRZXECNT
"RTN","LREPIRP7",58,0)
 K LRSBCNT,LRPV1,LRNOPAT,LRADMDT,LRDG1CNT,LRDISDT,LRDSP,LRDTHDG,LRHDGL2
"RTN","LREPIRP7",59,0)
 K LRI,LRNAME,LRNTECNT,LRNUM1,LROBRCNT,LROBXCNT,LRPATHCT,LRPERCNT
"RTN","LREPIRP7",60,0)
 K LRPV1CNT,LRPV1N,LRPV1ND,LRSUBCNT,LRTMP,LRTOT,LRTOTCNT,LRZXE,SITE,SSN
"RTN","LREPIRP7",61,0)
 Q
"RTN","LREPIRP7",62,0)
 ;
"RTN","LREPIRP7",63,0)
REP ;
"RTN","LREPIRP7",64,0)
Q S %ZIS="Q" D ^%ZIS Q:POP  I '$D(IO("Q")) U IO D PRT Q
"RTN","LREPIRP7",65,0)
 S ZTRTN="PRT^LREPIRP7",ZTSAVE("LR*")="",ZTDESC="PRINT EPI VERIFICATION REPORT",ZTREQ="@" D ^%ZTLOAD
"RTN","LREPIRP7",66,0)
 I $D(ZTSK)[0 W !!?5,"Report Cancelled."
"RTN","LREPIRP7",67,0)
 E  W !!?5,"The Task has been queued",!,"Task #",$G(ZTSK) H 5
"RTN","LREPIRP7",68,0)
 D HOME^%ZIS G EXIT
"RTN","LREPIRP7",69,0)
 Q
"RTN","LREPIRP7",70,0)
PRT ;Print report
"RTN","LREPIRP7",71,0)
 I 'LRALL D PATH G EXIT
"RTN","LREPIRP7",72,0)
 S LRPATH=0,LRDFN=0,LRPV1=0,LROBR=0,LROBX=0,LRPAGE=1,LRQUIT=0,LRNUM=0
"RTN","LREPIRP7",73,0)
 S LRPATH=1 D PPRT1^LREPIRP8
"RTN","LREPIRP7",74,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",75,0)
 S LRDFN=0,LRPV1=0,LRDG1=0
"RTN","LREPIRP7",76,0)
 S LRPATH=2 D PPRT3^LREPIRP8
"RTN","LREPIRP7",77,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",78,0)
 S LRDFN=0
"RTN","LREPIRP7",79,0)
 F LRPATH=3,4,5,6 D PPRT1^LREPIRP8 Q:LRQUIT  S LRDFN=0
"RTN","LREPIRP7",80,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",81,0)
 S LRDFN=0,LRPV1=0,LRDG1=0
"RTN","LREPIRP7",82,0)
 S LRPATH=7 D PPRT2^LREPIRP8
"RTN","LREPIRP7",83,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",84,0)
 S LRDFN=0,LRNUM=0
"RTN","LREPIRP7",85,0)
 S LRPATH=8 D PPRT1^LREPIRP8
"RTN","LREPIRP7",86,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",87,0)
 S LRDFN=0,LRPV1=0,LRDG1=0
"RTN","LREPIRP7",88,0)
 S LRPATH=9 D PPRT2^LREPIRP8
"RTN","LREPIRP7",89,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",90,0)
 S LRDFN=0,LRNUM=0
"RTN","LREPIRP7",91,0)
 S LRPATH=10 D PPRT1^LREPIRP8
"RTN","LREPIRP7",92,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",93,0)
 S LRDFN=0,LRPV1=0,LRDG1=0
"RTN","LREPIRP7",94,0)
 F LRPATH=11,12,13,14 D PPRT4^LREPIRP8 Q:LRQUIT
"RTN","LREPIRP7",95,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",96,0)
 S LRDFN=0,LRPV1=0,LROBR=0,LROBX=0,LRDG1=0
"RTN","LREPIRP7",97,0)
 F LRPATH=15,16,17 D PPRT3^LREPIRP8 Q:LRQUIT  S LRDFN=0
"RTN","LREPIRP7",98,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",99,0)
 S LRDFN=0
"RTN","LREPIRP7",100,0)
 F LRPATH=18,19,20,21,22,23 D PPRT1^LREPIRP8 Q:LRQUIT  S LRDFN=0
"RTN","LREPIRP7",101,0)
 I LRQUIT G EXIT
"RTN","LREPIRP7",102,0)
 S LRDFN=0,LRPV1=0,LRDG1=0
"RTN","LREPIRP7",103,0)
 W @IOF
"RTN","LREPIRP7",104,0)
 W !,?70,"  PAGE ",LRPAGE
"RTN","LREPIRP7",105,0)
 S LRHDGLC=0,LRLC=0
"RTN","LREPIRP7",106,0)
 F  S LRHDGLC=$O(^XTMP("LREPIREP"_LRDATE,"UPDHDG",LRHDGLC)) Q:LRHDGLC=""  W !,^(LRHDGLC)
"RTN","LREPIRP7",107,0)
 S LRPAGE=LRPAGE+1
"RTN","LREPIRP7",108,0)
 W !!,"Name                     LAST 4  Admission date     Discharge date"
"RTN","LREPIRP7",109,0)
 W !,"__________________________________________________________________"
"RTN","LREPIRP7",110,0)
 S LRUPDNUM=0
"RTN","LREPIRP7",111,0)
 F  S LRUPDNUM=$O(^XTMP("LREPIREP"_LRDATE,"UPDATES",LRUPDNUM)) Q:LRUPDNUM=""  W !,^(LRUPDNUM) I $Y>(IOSL+14) D NPG
"RTN","LREPIRP7",112,0)
 W @IOF
"RTN","LREPIRP7",113,0)
 W !,?70,"PAGE ",LRPAGE
"RTN","LREPIRP7",114,0)
 S LRHDGLC=0,LRLC=0
"RTN","LREPIRP7",115,0)
 F  S LRHDGLC=$O(^XTMP("LREPIREP"_LRDATE,"PHHDG",LRHDGLC)) Q:LRHDGLC=""  W !,^(LRHDGLC)
"RTN","LREPIRP7",116,0)
 S LRPAGE=LRPAGE+1
"RTN","LREPIRP7",117,0)
 W !!
"RTN","LREPIRP7",118,0)
 S LRTYPE="",LRZXECNT=0,LRCOUNT=0,LRSBCNT=0,LRDFN=0
"RTN","LREPIRP7",119,0)
 F  S LRTYPE=$O(^XTMP("LREPIREP"_LRDATE,"ZXE",LRTYPE)) Q:LRTYPE=""  D  D ZXETOT S LRSBCNT=0
"RTN","LREPIRP7",120,0)
 .W !,LRTYPE
"RTN","LREPIRP7",121,0)
 .F  S LRDFN=$O(^XTMP("LREPIREP"_LRDATE,"ZXE",LRTYPE,LRDFN)) Q:LRDFN=""  D
"RTN","LREPIRP7",122,0)
 ..F  S LRZXECNT=$O(^XTMP("LREPIREP"_LRDATE,"ZXE",LRTYPE,LRDFN,LRZXECNT)) Q:LRZXECNT=""  D
"RTN","LREPIRP7",123,0)
 ...W !,?5,^XTMP("LREPIREP"_LRDATE,"ZXE",LRTYPE,LRDFN,LRZXECNT)
"RTN","LREPIRP7",124,0)
 ...S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",125,0)
 ...I $Y>(IOSL+1) D NPG
"RTN","LREPIRP7",126,0)
 W !,"------------------------------------------------------------"
"RTN","LREPIRP7",127,0)
 W !?5,"COUNT ",LRCOUNT
"RTN","LREPIRP7",128,0)
 W @IOF
"RTN","LREPIRP7",129,0)
 W !?70,"PAGE ",LRPAGE
"RTN","LREPIRP7",130,0)
 S LRHDGLC=0,LRLC=LRLC+1,LRCOUNT=0,LRSUBCNT=0
"RTN","LREPIRP7",131,0)
 F  S LRHDGLC=$O(^XTMP("LREPIREP"_LRDATE,"HEPCHDG",LRHDGLC)) Q:LRHDGLC=""  W !,^(LRHDGLC)
"RTN","LREPIRP7",132,0)
 S LRPAGE=LRPAGE+1
"RTN","LREPIRP7",133,0)
 W !!
"RTN","LREPIRP7",134,0)
 F LRNUM=1:1:7 W !! D
"RTN","LREPIRP7",135,0)
 .I LRNUM=1 W !,"DECLINED ASSESSMENT FOR HEPATITIS C"
"RTN","LREPIRP7",136,0)
 .I LRNUM=2 W !,"NO RISK FACTORS FOR HEPATITIS C"
"RTN","LREPIRP7",137,0)
 .I LRNUM=3 W !,"PREVIOUSLY ASSESSED FOR HEPATITIS C"
"RTN","LREPIRP7",138,0)
 .I LRNUM=4 W !,"RISK FACTORS FOR HEPATITIS C"
"RTN","LREPIRP7",139,0)
 .I LRNUM=5 W !,"POSITIVE TEST FOR HEPATITIS C ANTIBODY"
"RTN","LREPIRP7",140,0)
 .I LRNUM=6 W !,"NEGATIVE TEST FOR HEPATITIS C ANTIBODY"
"RTN","LREPIRP7",141,0)
 .I LRNUM=7 W !,"HEPATITIS C DIAGNOSIS (ICD-9 BASED)"
"RTN","LREPIRP7",142,0)
 .W !,"--------------------------------------"
"RTN","LREPIRP7",143,0)
 .S LRTOT(LRNUM)=$G(^XTMP("LREPIREP"_LRDATE,"HEPTOT",LRNUM))
"RTN","LREPIRP7",144,0)
 .I LRTOT(LRNUM)="" W !!,"NO PATIENTS REPORTED FOR THE REPORT PERIOD" Q
"RTN","LREPIRP7",145,0)
 .S LRTYPE="",LRDSPCNT=0,LRCOUNT=0,LRSBCNT=0,LRDFN=0
"RTN","LREPIRP7",146,0)
 .F  S LRTYPE=$O(^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE)) Q:LRTYPE=""  D  D:LRSBCNT>0 DSPTOT S LRSBCNT=0
"RTN","LREPIRP7",147,0)
 ..F  S LRDFN=$O(^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN)) Q:LRDFN=""  D
"RTN","LREPIRP7",148,0)
 ...F  S LRDSPCNT=$O(^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT)) Q:LRDSPCNT=""  D
"RTN","LREPIRP7",149,0)
 ....I LRNUM=1&(LRTYPE="DECLINED HEP C RISK ASSESSMENT") W !?5,^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT) D:($Y>(IOSL+11)) NPG S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",150,0)
 ....I LRNUM=2&(LRTYPE="NO RISK FACTORS FOR HEP C") W !?5,^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT) D:($Y>(IOSL+11)) NPG S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",151,0)
 ....I LRNUM=3&(LRTYPE="PREVIOUSLY ASSESSED HEP C RISK") W !?5,^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT) D:($Y>(IOSL+11)) NPG S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",152,0)
 ....I LRNUM=4&(LRTYPE="RISK FACTOR FOR HEPATITIS C") W !?5,^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT) D:($Y>(IOSL+11)) NPG S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",153,0)
 ....I LRNUM=5&(LRTYPE="HEP C VIRUS ANTIBODY POSITIVE") W !?5,^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT) S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",154,0)
 ....I LRNUM=6&(LRTYPE="HEP C VIRUS ANTIBODY NEGATIVE") W !?5,^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT) S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",155,0)
 ....I LRNUM=7&(LRTYPE="HEPATITIS C INFECTION") W !?5,^XTMP("LREPIREP"_LRDATE,"DSP",LRTYPE,LRDFN,LRDSPCNT) D:($Y>(IOSL+11)) NPG S LRSBCNT=LRSBCNT+1
"RTN","LREPIRP7",156,0)
 W !,"-----------------------------------------------------------------"
"RTN","LREPIRP7",157,0)
 W !?5,"COUNT ",LRCOUNT
"RTN","LREPIRP7",158,0)
 K MSGLIN,LRSEG
"RTN","LREPIRP7",159,0)
 Q
"RTN","LREPIRP7",160,0)
PATH S LRPATH=0,LRDFN=0,LRPV1=0,LROBR=0,LROBX=0,LRPAGE=1,LRQUIT=0
"RTN","LREPIRP7",161,0)
 F  S LRPATH=$O(LREPI(LRPATH)) Q:'LRPATH  D  Q:LRQUIT  S LRDFN=0
"RTN","LREPIRP7",162,0)
 .I LRPATH=11!(LRPATH=12)!(LRPATH=13)!(LRPATH=14) D PPRT4^LREPIRP8 Q
"RTN","LREPIRP7",163,0)
 .I LRPATH=7!(LRPATH=9) D PPRT2^LREPIRP8 Q
"RTN","LREPIRP7",164,0)
 .I LRPATH=2!(LRPATH=15)!(LRPATH=16)!(LRPATH=17) D PPRT3^LREPIRP8 Q
"RTN","LREPIRP7",165,0)
 .D PPRT1^LREPIRP8
"RTN","LREPIRP7",166,0)
 G EXIT
"RTN","LREPIRP7",167,0)
 Q
"RTN","LREPIRP7",168,0)
ZXETOT ;PRINT PHARMACY SUBTOTALS
"RTN","LREPIRP7",169,0)
 W !,"---------------------------------------------------------------"
"RTN","LREPIRP7",170,0)
 W !,?5,"SUBCOUNT  ",LRSBCNT
"RTN","LREPIRP7",171,0)
 W !!
"RTN","LREPIRP7",172,0)
 S LRCOUNT=LRCOUNT+LRSBCNT
"RTN","LREPIRP7",173,0)
 Q
"RTN","LREPIRP7",174,0)
DSPTOT W !,"---------------------------------------------------------------"
"RTN","LREPIRP7",175,0)
 W !?5,"SUBCOUNT  ",LRSBCNT
"RTN","LREPIRP7",176,0)
 W !!
"RTN","LREPIRP7",177,0)
 S LRCOUNT=LRCOUNT+LRSBCNT
"RTN","LREPIRP7",178,0)
 Q
"RTN","LREPIRP7",179,0)
PAUSE ;
"RTN","LREPIRP7",180,0)
 Q:$G(LREND)
"RTN","LREPIRP7",181,0)
 K DIR S DIR(0)="E" D ^DIR
"RTN","LREPIRP7",182,0)
 S:($D(DTOUT))!($D(DUOUT)) LRQUIT=1
"RTN","LREPIRP7",183,0)
 Q
"RTN","LREPIRP7",184,0)
NPG ;NEW PAGE
"RTN","LREPIRP7",185,0)
 D:$E(IOST,1,2)="C-" PAUSE
"RTN","LREPIRP7",186,0)
 Q:$G(LRQUIT)
"RTN","LREPIRP7",187,0)
 W @IOF
"RTN","LREPIRP7",188,0)
 Q
"RTN","LREPIRP7",189,0)
HDG ;
"RTN","LREPIRP7",190,0)
 W @IOF
"RTN","LREPIRP7",191,0)
 S LRLC=0
"RTN","LREPIRP7",192,0)
 W !,?70,"  PAGE ",LRPAGE
"RTN","LREPIRP7",193,0)
 F LRHDGLC=1:1:3 S LRHDG=$G(^XTMP("LREPIREP"_LRDATE,"HDG",LRHDGLC)) D
"RTN","LREPIRP7",194,0)
 .W !,LRHDG
"RTN","LREPIRP7",195,0)
 .S LRLC=LRLC+1
"RTN","LREPIRP7",196,0)
 W ! S LRLC=LRLC+1
"RTN","LREPIRP7",197,0)
 S LRHDGLC=0
"RTN","LREPIRP7",198,0)
 F  S LRHDGLC=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,"HDG",LRHDGLC)) Q:LRHDGLC=""  D
"RTN","LREPIRP7",199,0)
 .S LRHDG=$G(^XTMP("LREPIREP"_LRDATE,LRPATH,"HDG",LRHDGLC))
"RTN","LREPIRP7",200,0)
 .W !,LRHDG
"RTN","LREPIRP7",201,0)
 .S LRLC=LRLC+1
"RTN","LREPIRP7",202,0)
 S LRPAGE=LRPAGE+1
"RTN","LREPIRP7",203,0)
 Q
"RTN","LREPIRP8")
0^27^B17447625
"RTN","LREPIRP8",1,0)
LREPIRP8 ;DALOI/CKA - EPI-PRINT VERIFICATION REPORT ; 5/14/03
"RTN","LREPIRP8",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP8",3,0)
 ;PRINT VERIFICATION REPORT CONTINUED
"RTN","LREPIRP8",4,0)
 ;
"RTN","LREPIRP8",5,0)
 ;CALLED BY LREPIRP7
"RTN","LREPIRP8",6,0)
 Q
"RTN","LREPIRP8",7,0)
PPRT1 ;Print pathogens 1,3,4,5,6,8,10,18,19,20,21,22,23 
"RTN","LREPIRP8",8,0)
 D HDG^LREPIRP7 W !
"RTN","LREPIRP8",9,0)
 S LRNOPAT="",LRNOPAT=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRNOPAT))
"RTN","LREPIRP8",10,0)
 I LRNOPAT="HDG" W !!,"NO PATIENTS REPORTED FOR THE REPORT PERIOD."
"RTN","LREPIRP8",11,0)
 F  S LRDFN=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN)) Q:'LRDFN  D  Q:LRQUIT
"RTN","LREPIRP8",12,0)
 .S LRPV1=0,LROBR=0,LROBX=0
"RTN","LREPIRP8",13,0)
 .W !!,"PATIENT NAME                  LAST 4 DOB        SEX   PERIOD OF SERVICE"
"RTN","LREPIRP8",14,0)
 .S LRPID=$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PID"))
"RTN","LREPIRP8",15,0)
 .W !,LRPID
"RTN","LREPIRP8",16,0)
 .F  S LRPV1=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1)) Q:'LRPV1  D  Q:LRQUIT
"RTN","LREPIRP8",17,0)
 ..S LROBR=0,LROBX=0
"RTN","LREPIRP8",18,0)
 ..S LRPV1ND=$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1))
"RTN","LREPIRP8",19,0)
 ..W !,$P(LRPV1ND,"            "),!,$P(LRPV1ND,"            ",2)
"RTN","LREPIRP8",20,0)
 ..I $L($P(LRPV1ND,"            ",2)) W !
"RTN","LREPIRP8",21,0)
 ..F  S LROBR=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR)) Q:'LROBR  D  Q:LRQUIT
"RTN","LREPIRP8",22,0)
 ...S LROBX=0
"RTN","LREPIRP8",23,0)
 ...W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR))
"RTN","LREPIRP8",24,0)
 ...F  S LROBX=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR,"OBX",LROBX)) Q:'LROBX  D  Q:LRQUIT
"RTN","LREPIRP8",25,0)
 ....W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR,"OBX",LROBX))
"RTN","LREPIRP8",26,0)
 .I $Y>(IOSL-6) D NPG^LREPIRP7
"RTN","LREPIRP8",27,0)
 Q
"RTN","LREPIRP8",28,0)
PPRT2 ;Print pathogens 7,9
"RTN","LREPIRP8",29,0)
 D HDG^LREPIRP7 W !
"RTN","LREPIRP8",30,0)
 S LRNOPAT="",LRNOPAT=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRNOPAT))
"RTN","LREPIRP8",31,0)
 I LRNOPAT="HDG" W !!,"NO PATIENTS REPORTED FOR THE REPORT PERIOD."
"RTN","LREPIRP8",32,0)
 F  S LRDFN=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN)) Q:'LRDFN  D  Q:LRQUIT
"RTN","LREPIRP8",33,0)
 .S LRPV1=0,LROBR=0,LROBX=0
"RTN","LREPIRP8",34,0)
 .S LRPID=$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PID"))
"RTN","LREPIRP8",35,0)
 .W !,LRPID
"RTN","LREPIRP8",36,0)
 .F  S LRPV1=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1)) Q:'LRPV1  D  Q:LRQUIT
"RTN","LREPIRP8",37,0)
 ..S LROBR=0,LROBX=0,LRDG1=0
"RTN","LREPIRP8",38,0)
 ..W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1))
"RTN","LREPIRP8",39,0)
 ..F  S LRDG1=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"DG1",LRDG1)) Q:'LRDG1  D  Q:LRQUIT
"RTN","LREPIRP8",40,0)
 ...W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"DG1",LRDG1))
"RTN","LREPIRP8",41,0)
 ...F  S LROBR=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR)) Q:'LROBR  D  Q:LRQUIT
"RTN","LREPIRP8",42,0)
 ....S LROBX=0
"RTN","LREPIRP8",43,0)
 ....W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR))
"RTN","LREPIRP8",44,0)
 ....F  S LROBX=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR,"OBX",LROBX)) Q:'LROBX  D  Q:LRQUIT
"RTN","LREPIRP8",45,0)
 .....W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"OBR",LROBR,"OBX",LROBX))
"RTN","LREPIRP8",46,0)
 ..I $Y>(IOSL-6) D NPG^LREPIRP7
"RTN","LREPIRP8",47,0)
 Q
"RTN","LREPIRP8",48,0)
PPRT3 ;Print pathogens 2,15,16,17
"RTN","LREPIRP8",49,0)
 D HDG^LREPIRP7 W !
"RTN","LREPIRP8",50,0)
 W !!,"Name                         LAST 4  Accession Date  Test Name   Test Result"
"RTN","LREPIRP8",51,0)
 W !,"____________________________________________________________________"
"RTN","LREPIRP8",52,0)
 S LRNOPAT="",LRNOPAT=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRNOPAT))
"RTN","LREPIRP8",53,0)
 I LRNOPAT="HDG" W !!,"NO PATIENTS REPORTED FOR THE REPORT PERIOD."
"RTN","LREPIRP8",54,0)
 S LRDFN=0,LRNUM=0
"RTN","LREPIRP8",55,0)
 F  S LRDFN=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN)) Q:'LRDFN  D  Q:LRQUIT  S LRNUM=0
"RTN","LREPIRP8",56,0)
 .F  S LRNUM=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,LRNUM)) Q:'LRNUM  D  Q:LRQUIT
"RTN","LREPIRP8",57,0)
 ..W !,^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,LRNUM)
"RTN","LREPIRP8",58,0)
 ..I $Y>(IOSL-6) D NPG^LREPIRP7
"RTN","LREPIRP8",59,0)
 Q
"RTN","LREPIRP8",60,0)
PPRT4 ;Print pathogens 11,12,13,14
"RTN","LREPIRP8",61,0)
 D HDG^LREPIRP7 W !
"RTN","LREPIRP8",62,0)
 S LRNOPAT="",LRNOPAT=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRNOPAT))
"RTN","LREPIRP8",63,0)
 I LRNOPAT="HDG" W !!,"NO PATIENTS REPORTED FOR THE REPORT PERIOD."
"RTN","LREPIRP8",64,0)
 F  S LRDFN=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN)) Q:'LRDFN  D  Q:LRQUIT
"RTN","LREPIRP8",65,0)
 .S LRPV1=0,LRDG1=0
"RTN","LREPIRP8",66,0)
 .S LRPID=$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PID"))
"RTN","LREPIRP8",67,0)
 .W !,LRPID
"RTN","LREPIRP8",68,0)
 .F  S LRPV1=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1)) Q:'LRPV1  D  Q:LRQUIT
"RTN","LREPIRP8",69,0)
 ..W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1))
"RTN","LREPIRP8",70,0)
 ..S LRDG1=0
"RTN","LREPIRP8",71,0)
 ..F  S LRDG1=$O(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"DG1",LRDG1)) Q:'LRDG1  D  Q:LRQUIT
"RTN","LREPIRP8",72,0)
 ...W !,$G(^XTMP("LREPIREP"_LRDATE,LRPATH,LRDFN,"PV1",LRPV1,"DG1",LRDG1))
"RTN","LREPIRP8",73,0)
 .I $Y>(IOSL-6) D NPG^LREPIRP7
"RTN","LREPIRP8",74,0)
 Q
"RTN","LREPIRP9")
0^25^B14953
"RTN","LREPIRP9",1,0)
LREPIRP9 ;DALOI/CKA-EMERGING PATHOGENS VERIFICATION REPORT ;9/30/03
"RTN","LREPIRP9",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRP9",3,0)
 ; This routine contains documentation of the ^XTMP global created
"RTN","LREPIRP9",4,0)
 ;for the verification report.
"RTN","LREPIRP9",5,0)
 Q
"RTN","LREPIRP9",6,0)
REPORT ;
"RTN","LREPIRP9",7,0)
 ;^XTMP("LREPIREP"_DATE,0)="CREATION DATE^PURGE DATE(creation date+260)^description^creator"
"RTN","LREPIRP9",8,0)
 ;HEADINGS
"RTN","LREPIRP9",9,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,"HDG",#)
"RTN","LREPIRP9",10,0)
 ;Pathogen OF 1,3,4,5,6,8,10,18,19,20,21,22,23
"RTN","LREPIRP9",11,0)
 ;NTE~1 Vancomycin-resistan Enterococcus
"RTN","LREPIRP9",12,0)
 ;NTE~3 Penicillin-resistant Steptococcus pneumoniae
"RTN","LREPIRP9",13,0)
 ;NTE~4 Report of Clostidium difficile
"RTN","LREPIRP9",14,0)
 ;NTE~5 Report of Tuberculosis
"RTN","LREPIRP9",15,0)
 ;NTE~6 Report of Group A Streptococcus
"RTN","LREPIRP9",16,0)
 ;NTE~8 Report of Candida Bloodstream Infections
"RTN","LREPIRP9",17,0)
 ;NTE~10 Report of Escherichia coli 0157
"RTN","LREPIRP9",18,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PID")
"RTN","LREPIRP9",19,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",#)
"RTN","LREPIRP9",20,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",LRPV1,"OBR",#)
"RTN","LREPIRP9",21,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",LRPV1,"OBR",LROBR,"OBX",#)
"RTN","LREPIRP9",22,0)
 ;NTES OF 11,12,13,14
"RTN","LREPIRP9",23,0)
 ;NTE~11 Report of Malaria
"RTN","LREPIRP9",24,0)
 ;NTE~12 Report of Dengue
"RTN","LREPIRP9",25,0)
 ;NTE~13 Report of Creutzfeldt-Jakob Disease
"RTN","LREPIRP9",26,0)
 ;NTE~14 Report of Leishmaniasis
"RTN","LREPIRP9",27,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PID")
"RTN","LREPIRP9",28,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",#)
"RTN","LREPIRP9",29,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",LRPV1,"DG1",#)
"RTN","LREPIRP9",30,0)
 ;NTES OF 7 AND 9
"RTN","LREPIRP9",31,0)
 ;NTE~7 Report of Legionella/Legionaire's
"RTN","LREPIRP9",32,0)
 ;NTE~9 Report of Cryptosporidium
"RTN","LREPIRP9",33,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PID")
"RTN","LREPIRP9",34,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",#)
"RTN","LREPIRP9",35,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",LRPV1,"DG1",#)
"RTN","LREPIRP9",36,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",LRPV1,"OBR",#)
"RTN","LREPIRP9",37,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,"PV1",LRPV1,"OBR",LROBR,"OBX",#)
"RTN","LREPIRP9",38,0)
 ;NTES OF 2,15,16,17
"RTN","LREPIRP9",39,0)
 ;NTE~2 Report of Hepatitis C antibody positive
"RTN","LREPIRP9",40,0)
 ;NTE~15 Report of Hepatitis C antibody negative
"RTN","LREPIRP9",41,0)
 ;NTE~16 Report of Hepatitis A antibody positive
"RTN","LREPIRP9",42,0)
 ;NTE~17 Report of Hepatitis B positive
"RTN","LREPIRP9",43,0)
 ;^XTMP("LREPIREP"_DATE,LRPATH,DFN,#)
"RTN","LREPIRP9",44,0)
 ;="Name  SSN  Date of Test  Name of Test  Result of Test"
"RTN","LREPIRP9",45,0)
 ;UPDATES
"RTN","LREPIRP9",46,0)
 ;^XTMP("LREPIREP"_DATE,"UPDATES",#)
"RTN","LREPIRP9",47,0)
 ;  ="Name  SSN  EPI/Pathogen  Admission Date   Discharge Date"
"RTN","LREPIRP9",48,0)
 ;
"RTN","LREPIRP9",49,0)
 ;PHARMACY DATA
"RTN","LREPIRP9",50,0)
 ;^XTMP("LREPIREP"_DATE,"ZXE",DRUG NAME,#)
"RTN","LREPIRP9",51,0)
 ;  ="SSN  Name  Status(Inpatient/Outpatient) Date"
"RTN","LREPIRP9",52,0)
 ;RISK ASSESSMENT DATA
"RTN","LREPIRP9",53,0)
 ;^XTMP("LREPIREP"_DATE,"DSP",RISK ASSESSMENT NAME,#)
"RTN","LREPIRP9",54,0)
 ;  ="SSN  NAME  Status  Date"
"RTN","LREPIRP9",55,0)
 Q
"RTN","LREPIRS")
0^9^B40087334
"RTN","LREPIRS",1,0)
LREPIRS ;DALOI/CKA - EPI-LOCAL REPORT/SPREADSHEET ; 5/14/03
"RTN","LREPIRS",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRS",3,0)
 ; Reference to ^ORD(101 supported by IA #872
"RTN","LREPIRS",4,0)
 ;USED TO PRINT REPORT OR SPREADSHEET 
"RTN","LREPIRS",5,0)
 D NOW^%DTC
"RTN","LREPIRS",6,0)
 S LRLRDT=% ;Set LRLRDT- local report date time=now
"RTN","LREPIRS",7,0)
 S LRRTYPE=1,LRPROT=0
"RTN","LREPIRS",8,0)
 S LRPROT=$O(^ORD(101,"B","LREPI",LRPROT))
"RTN","LREPIRS",9,0)
 W @IOF,?(IOM/2-15),"Laboratory Generate Local Report/Spreadsheet option"
"RTN","LREPIRS",10,0)
CRI K LRCYCLE,LREPI S LRMSG="Pathogens" D ALL G:$D(DIRUT) EXIT
"RTN","LREPIRS",11,0)
 K DIR,DIRUT,DTOUT,DUOUT,DIROUT
"RTN","LREPIRS",12,0)
 I +LRALL D PICKALL G DATE
"RTN","LREPIRS",13,0)
 S LRMSG="Local Pathogens" D ALL G:$D(DIRUT) CRI
"RTN","LREPIRS",14,0)
 K DIR,DIRUT,DTOUT,DUOUT,DIROUT
"RTN","LREPIRS",15,0)
 I +LRALL D LOCALL G DATE
"RTN","LREPIRS",16,0)
 I +LRALL'>0 D
"RTN","LREPIRS",17,0)
 .W @IOF
"RTN","LREPIRS",18,0)
 .F  Q:$D(DIRUT)  D
"RTN","LREPIRS",19,0)
 ..S DIR(0)="PAO^69.5:EMZ",DIR("A")="Select Pathogens: "
"RTN","LREPIRS",20,0)
 ..S DIR("S")="D CHKL^LREPIRM I LROK I $P(^(0),U,7)=LRPROT"
"RTN","LREPIRS",21,0)
 ..D ^DIR
"RTN","LREPIRS",22,0)
 ..Q:$D(DIRUT)
"RTN","LREPIRS",23,0)
 ..S LREPI(+Y)=""
"RTN","LREPIRS",24,0)
 G:$D(DTOUT)!$D(DUOUT)!$D(DIROUT) CRI
"RTN","LREPIRS",25,0)
 I '$D(LREPI) W !,"Sorry No Pathogens Selected" G EXIT
"RTN","LREPIRS",26,0)
DATE ;Select Search Date
"RTN","LREPIRS",27,0)
 K DIR,DIRUT
"RTN","LREPIRS",28,0)
 S DIR("A")="Select Start Date: "
"RTN","LREPIRS",29,0)
 S DIR(0)="DOA^:"_DT D ^DIR
"RTN","LREPIRS",30,0)
 G:$D(DIRUT) CRI
"RTN","LREPIRS",31,0)
 S LRRPS=Y
"RTN","LREPIRS",32,0)
 K DIR,DIRUT
"RTN","LREPIRS",33,0)
 S DIR("A")="Select End Date: "
"RTN","LREPIRS",34,0)
 S DIR(0)="DOA^:"_DT D ^DIR
"RTN","LREPIRS",35,0)
 G:$D(DIRUT) DATE
"RTN","LREPIRS",36,0)
 S LRRPE=Y
"RTN","LREPIRS",37,0)
RORS ;REPORT OR SPREADSHEET
"RTN","LREPIRS",38,0)
 K DIR,DIRUT
"RTN","LREPIRS",39,0)
 S DIR(0)="SO^1:REPORT;2:SPREADSHEET"
"RTN","LREPIRS",40,0)
 D ^DIR
"RTN","LREPIRS",41,0)
 G:$D(DIRUT) DATE
"RTN","LREPIRS",42,0)
 S LRREP=Y
"RTN","LREPIRS",43,0)
 W !!
"RTN","LREPIRS",44,0)
 I LRREP=1,$D(^XTMP("LREPILOCALREP"_LRLRDT)) D  G EXIT
"RTN","LREPIRS",45,0)
 .W !,"Data already exists for this date and time.  Please try again later."
"RTN","LREPIRS",46,0)
 I LRREP=2,$D(^XTMP("LREPILOCALSPSHT"_LRLRDT)) D  G EXIT
"RTN","LREPIRS",47,0)
 .W !,"Data already exists for this date and time.  Please try again later."
"RTN","LREPIRS",48,0)
 D SEG G:$D(DIRUT) RORS
"RTN","LREPIRS",49,0)
TITLE K DIR,DIRUT
"RTN","LREPIRS",50,0)
 S DIR(0)="F^3:30",DIR("A")="DOCUMENT TITLE"
"RTN","LREPIRS",51,0)
 D ^DIR
"RTN","LREPIRS",52,0)
 G:$D(DIRUT) RORS
"RTN","LREPIRS",53,0)
 S ^XTMP("LREPI"_$S(LRREP=1:"LOCALREP",1:"LOCALSPSHT")_LRLRDT,"TITLE")=Y
"RTN","LREPIRS",54,0)
 D TASK,HOME^%ZIS
"RTN","LREPIRS",55,0)
EXIT ;
"RTN","LREPIRS",56,0)
 K D0,J,LRALL,LRAUTO,LRBEG,LRCYCLE,LRDT,LREND,LREPI,LRMSG,LROK,LROVR
"RTN","LREPIRS",57,0)
 K LRDUZ,LRRNDT,LRRPE,LRREP,LRRPS,LRRTYPE,LRY,ZTSAVE
"RTN","LREPIRS",58,0)
 K ZTRTN,ZTIO,ZTDESC,ZTDTH,ZTSK,X,Y,X1,%DT
"RTN","LREPIRS",59,0)
 K LRLC,LRHDG,LRPROT,LRLRDT
"RTN","LREPIRS",60,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT,I,LRSEG
"RTN","LREPIRS",61,0)
 K ^TMP($J)
"RTN","LREPIRS",62,0)
 Q
"RTN","LREPIRS",63,0)
 ;
"RTN","LREPIRS",64,0)
TASK ;LETS TASK THIS JOB
"RTN","LREPIRS",65,0)
 Q:'$D(LREPI)
"RTN","LREPIRS",66,0)
 W !!
"RTN","LREPIRS",67,0)
 S LRDUZ=DUZ
"RTN","LREPIRS",68,0)
 K ZTSAVE
"RTN","LREPIRS",69,0)
 S ZTSAVE("LRRTYPE")="" S:LRRTYPE=0 ZTDTH=DT
"RTN","LREPIRS",70,0)
 S ZTSAVE("LR*")=""
"RTN","LREPIRS",71,0)
 S ZTIO="",ZTRTN="EN^LREPI",ZTDESC="Laboratory EPI local spreadsheet/report-generate"
"RTN","LREPIRS",72,0)
 D ^%ZTLOAD
"RTN","LREPIRS",73,0)
 I '$D(ZTQUEUED)&($D(ZTSK)) W @IOF,!!,"The Task has been queued",!,"Task # ",$G(ZTSK) H 5
"RTN","LREPIRS",74,0)
 Q
"RTN","LREPIRS",75,0)
PICKALL ;SELECT ALL ASSOCIATED PARAMETERS
"RTN","LREPIRS",76,0)
 S Y=0 F  S Y=$O(^LAB(69.5,Y)) Q:+Y'>0  D CHK S:LROK LREPI(Y)=""
"RTN","LREPIRS",77,0)
 Q
"RTN","LREPIRS",78,0)
LOCALL ;SELECT ALL LOCAL PATHOGENS
"RTN","LREPIRS",79,0)
 S Y=99 F  S Y=$O(^LAB(69.5,Y)) Q:Y'>0  D CHK S:LROK LREPI(Y)=""
"RTN","LREPIRS",80,0)
 Q
"RTN","LREPIRS",81,0)
CHK ;CHECK TO SEE IF ITS OK
"RTN","LREPIRS",82,0)
 S:'$D(LRCYCLE) LRCYCLE=$P(^LAB(69.5,Y,0),U,5)
"RTN","LREPIRS",83,0)
 S LROK=1
"RTN","LREPIRS",84,0)
 S:($P(^LAB(69.5,Y,0),U,2)="1") LROK=0 Q
"RTN","LREPIRS",85,0)
 S:$P(^LAB(69.5,Y,0),U,7)="" LROK=0 Q
"RTN","LREPIRS",86,0)
 S:'$D(^ORD(101,$P(^LAB(69.5,Y,0),U,7),0)) LROK=0 Q
"RTN","LREPIRS",87,0)
 S:$P(^LAB(69.5,Y,0),U,5)=LRCYCLE LROK=0 Q
"RTN","LREPIRS",88,0)
 Q
"RTN","LREPIRS",89,0)
ALL K DIR,DIRUT
"RTN","LREPIRS",90,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Include All "_LRMSG
"RTN","LREPIRS",91,0)
 S DIR("?")="Enter (Y)es or return to individually select pathogens."
"RTN","LREPIRS",92,0)
 D ^DIR
"RTN","LREPIRS",93,0)
 S LRALL=+Y
"RTN","LREPIRS",94,0)
 Q
"RTN","LREPIRS",95,0)
SEG ;CHOOSE SEGMENTS FOR SPREADSHEET
"RTN","LREPIRS",96,0)
 W !,"Choose the segments to capture for ",$S(LRREP=1:"report.",1:"spreadsheet.")
"RTN","LREPIRS",97,0)
 W !,"1-PID"
"RTN","LREPIRS",98,0)
 W !,"2-PV1"
"RTN","LREPIRS",99,0)
 W !,"3-DG1"
"RTN","LREPIRS",100,0)
 W !,"4-NTE"
"RTN","LREPIRS",101,0)
 W !,"5-OBR"
"RTN","LREPIRS",102,0)
 W !,"6-OBX"
"RTN","LREPIRS",103,0)
 K DIR,DIRUT
"RTN","LREPIRS",104,0)
 S DIR(0)="L^1:6"
"RTN","LREPIRS",105,0)
 D ^DIR
"RTN","LREPIRS",106,0)
 Q:$D(DIRUT)
"RTN","LREPIRS",107,0)
 S LRY=Y
"RTN","LREPIRS",108,0)
 I LRY[1 S LRSEG("PID")=1 D
"RTN","LREPIRS",109,0)
 .W !!
"RTN","LREPIRS",110,0)
 .W !,"Choose the fields from the PID segment to capture for ",$S(LRREP=1:"report.",1:"spreadsheet.")
"RTN","LREPIRS",111,0)
 .W !,"1-Set Id"
"RTN","LREPIRS",112,0)
 .W !,"2-SSN"
"RTN","LREPIRS",113,0)
 .W !,"3-MPI"
"RTN","LREPIRS",114,0)
 .W !,"4-Patient Name"
"RTN","LREPIRS",115,0)
 .W !,"5-Date of Birth"
"RTN","LREPIRS",116,0)
 .W !,"6-Sex"
"RTN","LREPIRS",117,0)
 .W !,"7-Race"
"RTN","LREPIRS",118,0)
 .W !,"8-Homeless"
"RTN","LREPIRS",119,0)
 .W !,"9-State"
"RTN","LREPIRS",120,0)
 .W !,"10-Zip Code"
"RTN","LREPIRS",121,0)
 .W !,"11-County"
"RTN","LREPIRS",122,0)
 .W !,"12-Ethnicity"
"RTN","LREPIRS",123,0)
 .W !,"13-Period of Service"
"RTN","LREPIRS",124,0)
 .K DIR,DIRUT
"RTN","LREPIRS",125,0)
 .S DIR(0)="L^1:13"
"RTN","LREPIRS",126,0)
 .D ^DIR
"RTN","LREPIRS",127,0)
 .Q:$D(DIRUT)
"RTN","LREPIRS",128,0)
 .F I=1:1:13 I Y[I S LRSEG("PID",I)=""
"RTN","LREPIRS",129,0)
 I LRY[2 S LRSEG("PV1")=1 D
"RTN","LREPIRS",130,0)
 .W !,"Choose the fields from the PV1 segment to capture for ",$S(LRREP=1:"report.",1:"spreadsheet.")
"RTN","LREPIRS",131,0)
 .W !,"1-Set Id"
"RTN","LREPIRS",132,0)
 .W !,"2-Patient Class"
"RTN","LREPIRS",133,0)
 .W !,"3-Hospital Location"
"RTN","LREPIRS",134,0)
 .W !,"4-Discharge Disposition"
"RTN","LREPIRS",135,0)
 .W !,"5-Facility"
"RTN","LREPIRS",136,0)
 .W !,"6-Admit Date/Time"
"RTN","LREPIRS",137,0)
 .W !,"7-Discharge Date/Time"
"RTN","LREPIRS",138,0)
 .K DIR,DIRUT
"RTN","LREPIRS",139,0)
 .S DIR(0)="L^1:7"
"RTN","LREPIRS",140,0)
 .D ^DIR
"RTN","LREPIRS",141,0)
 .Q:$D(DIRUT) 
"RTN","LREPIRS",142,0)
 .F I=1:1:7 I Y[I S LRSEG("PV1",I)=""
"RTN","LREPIRS",143,0)
 I LRY[3 S LRSEG("DG1")=1 D
"RTN","LREPIRS",144,0)
 .W !,"Choose the fields from the DG1 segment to capture for ",$S(LRREP=1:"report.",1:"spreadsheet.")
"RTN","LREPIRS",145,0)
 .W !,"1-Set Id"
"RTN","LREPIRS",146,0)
 .W !,"2-Diagnosis Code"
"RTN","LREPIRS",147,0)
 .W !,"3-Diagnosis"
"RTN","LREPIRS",148,0)
 .W !,"4-Admission Date"
"RTN","LREPIRS",149,0)
 .K DIR,DIRUT
"RTN","LREPIRS",150,0)
 .S DIR(0)="L^1:4"
"RTN","LREPIRS",151,0)
 .D ^DIR
"RTN","LREPIRS",152,0)
 .Q:$D(DIRUT)
"RTN","LREPIRS",153,0)
 .F I=1:1:4 I Y[I S LRSEG("DG1",I)=""
"RTN","LREPIRS",154,0)
 I LRY[4 S LRSEG("NTE")=1 D
"RTN","LREPIRS",155,0)
 .W !,"Choose the fields from the NTE segment to capture for ",$S(LRREP=1:"report.",1:"spreadsheet.")
"RTN","LREPIRS",156,0)
 .W !,"1-Set Id"
"RTN","LREPIRS",157,0)
 .W !,"2-Comment"
"RTN","LREPIRS",158,0)
 .K DIR,DIRUT
"RTN","LREPIRS",159,0)
 .S DIR(0)="L^1:2"
"RTN","LREPIRS",160,0)
 .D ^DIR
"RTN","LREPIRS",161,0)
 .Q:$D(DIRUT)
"RTN","LREPIRS",162,0)
 .F I=1:1:2 I Y[I S LRSEG("NTE",I)=""
"RTN","LREPIRS",163,0)
 I LRY[5 S LRSEG("OBR")=1 D
"RTN","LREPIRS",164,0)
 .W !,"Choose the fields from the OBR segment to capture for ",$S(LRREP=1:"report.",1:"spreadsheet.")
"RTN","LREPIRS",165,0)
 .W !,"1-Set Id"
"RTN","LREPIRS",166,0)
 .W !,"2-Test Name"
"RTN","LREPIRS",167,0)
 .W !,"3-Accession Date"
"RTN","LREPIRS",168,0)
 .W !,"4-Specimen"
"RTN","LREPIRS",169,0)
 .W !,"5-Accession Number"
"RTN","LREPIRS",170,0)
 .K DIR,DIRUT
"RTN","LREPIRS",171,0)
 .S DIR(0)="L^1:5"
"RTN","LREPIRS",172,0)
 .D ^DIR
"RTN","LREPIRS",173,0)
 .Q:$D(DIRUT)
"RTN","LREPIRS",174,0)
 .F I=1:1:5 I Y[I S LRSEG("OBR",I)=""
"RTN","LREPIRS",175,0)
 I LRY[6 S LRSEG("OBX")=1 D
"RTN","LREPIRS",176,0)
 .W !,"Choose the fields from the OBX segment to capture for ",$S(LRREP=1:"report.",1:"spreadsheet.")
"RTN","LREPIRS",177,0)
 .W !,"1-Set Id"
"RTN","LREPIRS",178,0)
 .W !,"2-Value Type"
"RTN","LREPIRS",179,0)
 .W !,"3-Test Name"
"RTN","LREPIRS",180,0)
 .W !,"4-LOINC Code"
"RTN","LREPIRS",181,0)
 .W !,"5-LOINC Name"
"RTN","LREPIRS",182,0)
 .W !,"6-Test Result"
"RTN","LREPIRS",183,0)
 .W !,"7-Units"
"RTN","LREPIRS",184,0)
 .W !,"8-Abnormal Flags"
"RTN","LREPIRS",185,0)
 .W !,"9-Verified Date/Time"
"RTN","LREPIRS",186,0)
 .K DIR,DIRUT
"RTN","LREPIRS",187,0)
 .S DIR(0)="L^1:9"
"RTN","LREPIRS",188,0)
 .D ^DIR
"RTN","LREPIRS",189,0)
 .Q:$D(DIRUT)
"RTN","LREPIRS",190,0)
 .F I=1:1:10 I Y[I S LRSEG("OBX",I)=""
"RTN","LREPIRS",191,0)
 Q
"RTN","LREPIRS1")
0^10^B38487610
"RTN","LREPIRS1",1,0)
LREPIRS1 ;DALOI/CKA-EMERGING PATHOGENS LOCAL REPORT ;9/9/03
"RTN","LREPIRS1",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRS1",3,0)
 ; Reference to ^DIC(21 supported by IA #913
"RTN","LREPIRS1",4,0)
 Q
"RTN","LREPIRS1",5,0)
REPORT ;
"RTN","LREPIRS1",6,0)
 S X1=DT,X2=180 D C^%DTC
"RTN","LREPIRS1",7,0)
 S LRSP="                              "
"RTN","LREPIRS1",8,0)
 S ^XTMP("LREPILOCALREP"_LRLRDT,0)=X_"^"_DT_"^EPI Local Report generation^"_$S($D(DUZ):DUZ,1:"UNKNOWN")
"RTN","LREPIRS1",9,0)
 S LRHDGLC=0 D SAVHDG^LREPIRS2
"RTN","LREPIRS1",10,0)
 S MSG=0,LRLC=1,LRSPSHT=""
"RTN","LREPIRS1",11,0)
 F  S MSG=$O(^TMP("HLS",$J,MSG)) Q:'MSG  S LRMSGLIN=^(MSG) D
"RTN","LREPIRS1",12,0)
 .S LRSPSHT=""
"RTN","LREPIRS1",13,0)
 .Q:$P(LRMSGLIN,"|")=""
"RTN","LREPIRS1",14,0)
 .Q:'$D(LRSEG($P(LRMSGLIN,"|")))
"RTN","LREPIRS1",15,0)
 .I $P(LRMSGLIN,"|")="PID" D
"RTN","LREPIRS1",16,0)
 ..S LRSPSHT="********************************************************************************"
"RTN","LREPIRS1",17,0)
 ..S ^XTMP("LREPILOCALREP"_LRLRDT,LRLC)=LRSPSHT S LRLC=LRLC+1
"RTN","LREPIRS1",18,0)
 .I $P(LRMSGLIN,"|")="PID" D
"RTN","LREPIRS1",19,0)
 ..I $D(LRSEG("PID",1)) S LRSPSHT=$P(LRMSGLIN,HLFS,2)_$E(LRSP,1,7-$L($P(LRMSGLIN,HLFS,2)))
"RTN","LREPIRS1",20,0)
 ..I $D(LRSEG("PID",2)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,20)_" "
"RTN","LREPIRS1",21,0)
 ..I $D(LRSEG("PID",3)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,4),LRCS,4) D
"RTN","LREPIRS1",22,0)
 ...S LRSPSHT=LRSPSHT_$E(LRSP,1,16-($L($P($P(LRMSGLIN,HLFS,4),LRCS,4))))
"RTN","LREPIRS1",23,0)
 ..I $D(LRSEG("PID",4)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,6),LRCS)_","_$P($P(LRMSGLIN,HLFS,6),LRCS,2)_" "_$P($P(LRMSGLIN,HLFS,6),LRCS,3)_"  " D
"RTN","LREPIRS1",24,0)
 ...S LRSPSHT=LRSPSHT_$E(LRSP,1,29-($L($P(LRMSGLIN,HLFS,6))))
"RTN","LREPIRS1",25,0)
 ..I $D(LRSEG("PID",5)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,8)) D
"RTN","LREPIRS1",26,0)
 ...S LRSPSHT=LRSPSHT_$E(LRSP,1,9-($L($P(LRMSGLIN,HLFS,8))))
"RTN","LREPIRS1",27,0)
 ..I $D(LRSEG("PID",6)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,9)_"  "
"RTN","LREPIRS1",28,0)
 ..I $D(LRSEG("PID",7)) D  K LRZ,LRY
"RTN","LREPIRS1",29,0)
 ...S LRZ=0,DFN=$P($P(LRMSGLIN,HLFS,4),LRCS) F LRY=1:1 S LRZ=$O(^DPT(DFN,.02,LRZ)) Q:'LRZ
"RTN","LREPIRS1",30,0)
 ...I LRY>2 S LRSPSHT=LRSPSHT_"MULTIPLE "
"RTN","LREPIRS1",31,0)
 ...E  S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,11),LRCS,2)_" "
"RTN","LREPIRS1",32,0)
 ..I $D(LRSEG("PID",8)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,12),LRCS,1)_$E(LRSP,1,9-$L($P($P(LRMSGLIN,HLFS,12),LRCS,1)))
"RTN","LREPIRS1",33,0)
 ..I $D(LRSEG("PID",9)) S LRSPSHT=LRSPSHT_$P($P($P(LRMSGLIN,HLFS,12),LRCS,4),U,2)_"  " D
"RTN","LREPIRS1",34,0)
 ...S LRSPSHT=LRSPSHT_$E(LRSP,1,15-$L($P($P($P(LRMSGLIN,HLFS,12),LRCS,4),U,2)))
"RTN","LREPIRS1",35,0)
 ..I $D(LRSEG("PID",10)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,12),LRCS,5)_" "
"RTN","LREPIRS1",36,0)
 ..I $D(LRSEG("PID",11)) S LRSPSHT=LRSPSHT_$P($P($P(LRMSGLIN,HLFS,12),LRCS,9),U,2)_$E(LRSP,1,20-$L($P($P($P(LRMSGLIN,HLFS,12),LRCS,9),U,2)))
"RTN","LREPIRS1",37,0)
 ..I $D(LRSEG("PID",12)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,23),LRCS,2)_$E(LRSP,1,20-$L($P($P(LRMSGLIN,HLFS,23),LRCS,2)))
"RTN","LREPIRS1",38,0)
 ..I $D(LRSEG("PID",13)) D  I LRPOS="" S LRSPSHT=LRSPSHT_"  "
"RTN","LREPIRS1",39,0)
 ...S LRPOS=$P(LRMSGLIN,HLFS,28)
"RTN","LREPIRS1",40,0)
 ...Q:LRPOS=""
"RTN","LREPIRS1",41,0)
 ...S LRPOSN=0
"RTN","LREPIRS1",42,0)
 ...F  S LRPOSN=$O(^DIC(21,LRPOSN)) Q:LRPOSN'>0  I $P($G(^DIC(21,LRPOSN,0)),U,3)=LRPOS S LRPOSNAM=$P(^(0),U) Q
"RTN","LREPIRS1",43,0)
 ...S LRSPSHT=LRSPSHT_LRPOSNAM_"  "
"RTN","LREPIRS1",44,0)
 ..I LRSPSHT'="" S ^XTMP("LREPILOCALREP"_LRLRDT,LRLC)=LRSPSHT S LRLC=LRLC+1 S LRSPSHT=""
"RTN","LREPIRS1",45,0)
 .K LRPOS,LRPOSN,LRPOSNAM
"RTN","LREPIRS1",46,0)
 .I $P(LRMSGLIN,"|")="PV1" D
"RTN","LREPIRS1",47,0)
 ..I $D(LRSEG("PV1",1)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,2)_$E(LRSP,1,7-$L($P(LRMSGLIN,HLFS,2)))
"RTN","LREPIRS1",48,0)
 ..I $D(LRSEG("PV1",2)) D
"RTN","LREPIRS1",49,0)
 ...S TYPE=$P(LRMSGLIN,HLFS,3),TYPE=$S(TYPE="U":"Update",TYPE="I":"Inpatient",1:"Outpatient")
"RTN","LREPIRS1",50,0)
 ...S LRSPSHT=LRSPSHT_TYPE_$E(LRSP,1,14-$L(TYPE))
"RTN","LREPIRS1",51,0)
 ...K TYPE
"RTN","LREPIRS1",52,0)
 ..I $D(LRSEG("PV1",3)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,4)_$E(LRSP,1,20-$L($P(LRMSGLIN,HLFS,4)))
"RTN","LREPIRS1",53,0)
 ..I $D(LRSEG("PV1",4)) S LRSPSHT=LRSPSHT_$S($P($P(LRMSGLIN,HLFS,37),LRCS,2)'="":$P($P(LRMSGLIN,HLFS,37),LRCS,2),1:"**No Facility**")_$E(LRSP,1,23-$L($P($P(LRMSGLIN,HLFS,37),LRCS,2)))
"RTN","LREPIRS1",54,0)
 ..I $D(LRSEG("PV1",5)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,40)_$E(LRSP,1,9-$L($P(LRMSGLIN,HLFS,40)))
"RTN","LREPIRS1",55,0)
 ..I $D(LRSEG("PV1",6)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,45))_" "
"RTN","LREPIRS1",56,0)
 ..I $D(LRSEG("PV1",7)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,46))
"RTN","LREPIRS1",57,0)
 ..I LRSPSHT'="" S ^XTMP("LREPILOCALREP"_LRLRDT,LRLC)=LRSPSHT S LRLC=LRLC+1 S LRSPSHT=""
"RTN","LREPIRS1",58,0)
 .I $P(LRMSGLIN,"|")="NTE" D
"RTN","LREPIRS1",59,0)
 ..I $D(LRSEG("NTE",1)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,2)_$E(LRSP,1,8-$L($P(LRMSGLIN,HLFS,2)))
"RTN","LREPIRS1",60,0)
 ..I $D(LRSEG("NTE",2)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,3)_"  "
"RTN","LREPIRS1",61,0)
 ..I LRSPSHT'="" S ^XTMP("LREPILOCALREP"_LRLRDT,LRLC)=LRSPSHT S LRLC=LRLC+1 S LRSPSHT=""
"RTN","LREPIRS1",62,0)
 .I $P(LRMSGLIN,"|")="OBR" D
"RTN","LREPIRS1",63,0)
 ..I $D(LRSEG("OBR",1)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,2)_$E(LRSP,1,7-$L($P(LRMSGLIN,HLFS,2)))
"RTN","LREPIRS1",64,0)
 ..I $D(LRSEG("OBR",2)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,5),LRCS,2)_$E(LRSP,1,20-$L($P($P(LRMSGLIN,HLFS,5),LRCS,2)))
"RTN","LREPIRS1",65,0)
 ..I $D(LRSEG("OBR",3)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,8))_$E(LRSP,1,17-$L($$CDT^LREPIRP($P(LRMSGLIN,HLFS,8))))
"RTN","LREPIRS1",66,0)
 ..I $D(LRSEG("OBR",4)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,16),LRCS,3)_$E(LRSP,1,20-$L($P($P(LRMSGLIN,HLFS,16),LRCS,3)))
"RTN","LREPIRS1",67,0)
 ..I $D(LRSEG("OBR",5)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,19)
"RTN","LREPIRS1",68,0)
 ..S LRSPSHT=LRSPSHT_"   "_$P($P(LRMSGLIN,HLFS,27),LRCS,2)
"RTN","LREPIRS1",69,0)
 ..I LRSPSHT'="" S ^XTMP("LREPILOCALREP"_LRLRDT,LRLC)=LRSPSHT S LRLC=LRLC+1 S LRSPSHT=""
"RTN","LREPIRS1",70,0)
 .I $P(LRMSGLIN,"|")="OBX" D
"RTN","LREPIRS1",71,0)
 ..I $P(LRMSGLIN,HLFS,3)="ST" D
"RTN","LREPIRS1",72,0)
 ...S TST=$P(LRMSGLIN,HLFS,4),TSTNM=$P($P(TST,LRCS,2),LRCS)
"RTN","LREPIRS1",73,0)
 ...S OV=$P(LRMSGLIN,HLFS,6)
"RTN","LREPIRS1",74,0)
 ..I $P(LRMSGLIN,HLFS,3)="CE" D
"RTN","LREPIRS1",75,0)
 ...S TSTNM=""
"RTN","LREPIRS1",76,0)
 ...S OV=$P($P(LRMSGLIN,HLFS,6),LRCS,2)
"RTN","LREPIRS1",77,0)
 ..S FD=$$CDT^LREPIRP($P(LRMSGLIN,HLFS,15)),RR=$P(LRMSGLIN,HLFS,9)
"RTN","LREPIRS1",78,0)
 ..S UN=$P(LRMSGLIN,HLFS,7)
"RTN","LREPIRS1",79,0)
 ..I $P($P(LRMSGLIN,HLFS,4),LRCS,9)="LOINC" D
"RTN","LREPIRS1",80,0)
 ...S LOINC=$P($P(LRMSGLIN,HLFS,4),LRCS,7),LOINCN=$P($P(LRMSGLIN,HLFS,4),LRCS,8)
"RTN","LREPIRS1",81,0)
 ..I $D(LRSEG("OBX",1)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,2)_$E(LRSP,1,7-$L($P(LRMSGLIN,HLFS,2)))
"RTN","LREPIRS1",82,0)
 ..I $D(LRSEG("OBX",2)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,3)_"  "
"RTN","LREPIRS1",83,0)
 ..I $D(LRSEG("OBX",3)) S LRSPSHT=LRSPSHT_TSTNM_"  "
"RTN","LREPIRS1",84,0)
 ..I $D(LRSEG("OBX",4)) S LRSPSHT=LRSPSHT_$G(LOINC)_"  "
"RTN","LREPIRS1",85,0)
 ..I $D(LRSEG("OBX",5)) S LRSPSHT=LRSPSHT_$G(LOINCN)_"  "
"RTN","LREPIRS1",86,0)
 ..I $D(LRSEG("OBX",6)) S LRSPSHT=LRSPSHT_OV_"  "
"RTN","LREPIRS1",87,0)
 ..I $D(LRSEG("OBX",7)) S LRSPSHT=LRSPSHT_UN_"  "
"RTN","LREPIRS1",88,0)
 ..I $D(LRSEG("OBX",8)) S LRSPSHT=LRSPSHT_RR_"  "
"RTN","LREPIRS1",89,0)
 ..I $D(LRSEG("OBX",9)) S LRSPSHT=LRSPSHT_FD_"  "
"RTN","LREPIRS1",90,0)
 ..S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,5)
"RTN","LREPIRS1",91,0)
 ..I LRSPSHT'="" S ^XTMP("LREPILOCALREP"_LRLRDT,LRLC)=LRSPSHT S LRLC=LRLC+1 S LRSPSHT=""
"RTN","LREPIRS1",92,0)
 ..K TST,TSTNM,LOINC,LOINCN,ENTRY,UN,RR,FD,OV
"RTN","LREPIRS1",93,0)
 .I $P(LRMSGLIN,"|")="DG1" D
"RTN","LREPIRS1",94,0)
 ..I $D(LRSEG("DG1",1)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,2)_$E(LRSP,1,7-$L($P(LRMSGLIN,HLFS,2)))
"RTN","LREPIRS1",95,0)
 ..I $D(LRSEG("DG1",2)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,4),LRCS,1)_" " D
"RTN","LREPIRS1",96,0)
 ...S LRSPSHT=LRSPSHT_$E(LRSP,1,14-$L($P($P(LRMSGLIN,HLFS,4),LRCS,1)))
"RTN","LREPIRS1",97,0)
 ..I $D(LRSEG("DG1",3)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,4),LRCS,2) D
"RTN","LREPIRS1",98,0)
 ...S LRSPSHT=LRSPSHT_$E(LRSP,1,39-$L($P($P(LRMSGLIN,HLFS,4),LRCS,2)))
"RTN","LREPIRS1",99,0)
 ..I $D(LRSEG("DG1",4)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,5))_" "
"RTN","LREPIRS1",100,0)
 ..I LRSPSHT'="" S ^XTMP("LREPILOCALREP"_LRLRDT,LRLC)=LRSPSHT S LRLC=LRLC+1
"RTN","LREPIRS1",101,0)
 K MSGLIN,LRSEG,ENTRY,FD,HLFS,LOINC,LOINCN,LRCS,LRHDGLC,LRLC,LRMSGLIN
"RTN","LREPIRS1",102,0)
 K LRPOS,LRSP,LRSPSHT,MSG,OV,RR,TST,TSTNM,TYPE,UN,X,X1,X2
"RTN","LREPIRS1",103,0)
 Q
"RTN","LREPIRS2")
0^13^B92236192
"RTN","LREPIRS2",1,0)
LREPIRS2 ;DALOI/CKA - EPI-PRINT LOCAL REPORT/SPREADSHEET ; 5/14/03
"RTN","LREPIRS2",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRS2",3,0)
 ; Reference to $$SITE^VASITE supported by IA #10112
"RTN","LREPIRS2",4,0)
 ; Reference to X ^DD("DD") supported by IA #10017
"RTN","LREPIRS2",5,0)
 W !?5,"Print Local Report/Spreadsheet Option"
"RTN","LREPIRS2",6,0)
RORS ;REPORT OR SPREADSHEET
"RTN","LREPIRS2",7,0)
 S DIR(0)="SO^1:REPORT;2:SPREADSHEET"
"RTN","LREPIRS2",8,0)
 S DIR("A")="Which one do you wish to print"
"RTN","LREPIRS2",9,0)
 D ^DIR
"RTN","LREPIRS2",10,0)
 G:$D(DIRUT) EXIT
"RTN","LREPIRS2",11,0)
 S LRREP=Y
"RTN","LREPIRS2",12,0)
 K DIR,DIRUT
"RTN","LREPIRS2",13,0)
CHOOSE ;CHOOSE RPT OR SPSHT TO PRINT
"RTN","LREPIRS2",14,0)
 S LRLRDTX=1,LRY=1,LRNODE="LREPI"_$S(LRREP=1:"LOCALREP",1:"LOCALSPSHT"),LRNODE1=LRNODE
"RTN","LREPIRS2",15,0)
 F  S LRNODE=$O(^XTMP(LRNODE)) Q:LRNODE=""!(LRNODE'[LRNODE1)  S LRLRDTX=$E(LRNODE,$S(LRREP=1:14,1:16),$S(LRREP=1:28,1:30))  D
"RTN","LREPIRS2",16,0)
 .Q:LRLRDTX=""
"RTN","LREPIRS2",17,0)
 .I '$D(^XTMP("LREPI"_$S(LRREP=1:"LOCALREP",1:"LOCALSPSHT")_LRLRDTX,"DONE")) Q
"RTN","LREPIRS2",18,0)
 .S Y=LRLRDTX X ^DD("DD") S LRLRDT(LRLRDTX)=Y,LRLRDT(LRY)=LRLRDTX
"RTN","LREPIRS2",19,0)
 .S LRTITLE=$G(^XTMP("LREPI"_$S(LRREP=1:"LOCALREP",1:"LOCALSPSHT")_LRLRDTX,"TITLE"))
"RTN","LREPIRS2",20,0)
 .W !,LRY," ",LRLRDT(LRLRDTX)," ",LRTITLE
"RTN","LREPIRS2",21,0)
 .S LRY=LRY+1
"RTN","LREPIRS2",22,0)
 S LRY=LRY-1
"RTN","LREPIRS2",23,0)
 I LRY=0,'$D(LRTITLE) W !,"No "_$S(LRREP=1:"report ",1:"spreadsheet ")_"is ready for printing." G RORS
"RTN","LREPIRS2",24,0)
 S DIR(0)="NO^1:"_LRY
"RTN","LREPIRS2",25,0)
 S DIR("A")="Choose the number for the "_$S(LRREP=1:"report",LRREP=2:"spreadsheet")_" you wish to print"
"RTN","LREPIRS2",26,0)
 D ^DIR
"RTN","LREPIRS2",27,0)
 G:$D(DIRUT) RORS
"RTN","LREPIRS2",28,0)
 S LRY=Y,LRLRDT=LRLRDT(LRY)
"RTN","LREPIRS2",29,0)
 K DIR,DIRUT
"RTN","LREPIRS2",30,0)
 I LRREP=2 D  D:'$D(LREND) PRIV D:'$D(LREND) READY D:'$D(LREND) SPSHT G EXIT
"RTN","LREPIRS2",31,0)
 .W !!
"RTN","LREPIRS2",32,0)
 .W !?5,"This option will print the selected fields."
"RTN","LREPIRS2",33,0)
 .W !?5,"You will need to capture this printout in a text document."
"RTN","LREPIRS2",34,0)
 .W !?5,"Using a text editor, remove any extraneous lines from the beginning"
"RTN","LREPIRS2",35,0)
 .W !?5,"and the end of the file so that only the data to be imported remains."
"RTN","LREPIRS2",36,0)
 .W !?5,"Save the edited file.  Use this file in the import function of"
"RTN","LREPIRS2",37,0)
 .W !?5,"your spreadsheet program."
"RTN","LREPIRS2",38,0)
 I LRREP=1 D:'$D(LREND) PRIV D:'$D(LREND) REP G EXIT
"RTN","LREPIRS2",39,0)
 W !!
"RTN","LREPIRS2",40,0)
EXIT ;
"RTN","LREPIRS2",41,0)
 D ^%ZISC
"RTN","LREPIRS2",42,0)
 K D0,LRAUTO,LRBEG,LRDT,LREND,LRRNDT,LREPI,LRRPE,LRRPS,ZTSAVE
"RTN","LREPIRS2",43,0)
 K ZTRTN,ZTIO,ZTDESC,ZTDTH,ZTSK,X,Y,X1,%DT,POP,%ZIS
"RTN","LREPIRS2",44,0)
 K LRLC,LRHDG,LRQUIT,LRHDGLC,LRPAGE,LRY,LRLRDT,LRDTHDG,LRLRDTX,LRNODE,LRNODE1,LRTITLE
"RTN","LREPIRS2",45,0)
 K DIR,DTOUT,DUOUT,DIRUT,I,J,LRMSGLIN,LRREP,LRSPSHT,MSG,MSGLIN
"RTN","LREPIRS2",46,0)
 Q
"RTN","LREPIRS2",47,0)
 ;
"RTN","LREPIRS2",48,0)
SPSHT ;
"RTN","LREPIRS2",49,0)
 S %ZIS="Q" D ^%ZIS Q:POP  I '$D(IO("Q")) U IO D PRTSP Q
"RTN","LREPIRS2",50,0)
 S ZTRTN="PRTSP^LREPIRS2",ZTSAVE("LR*")="",ZTDESC="PRINT EPI LOCAL SPREADSHEET",ZTREQ="@" D ^%ZTLOAD
"RTN","LREPIRS2",51,0)
 I $D(ZTSK)[0 W !!?5,"Report Cancelled."
"RTN","LREPIRS2",52,0)
 E  W !!?5,"The Task has been queued",!,"Task #",$G(ZTSK) H 5
"RTN","LREPIRS2",53,0)
 D HOME^%ZIS G EXIT
"RTN","LREPIRS2",54,0)
 Q
"RTN","LREPIRS2",55,0)
PRTSP S MSG=0,LRSPSHT="",LRLC=0,LRPAGE=1,LRQUIT=0
"RTN","LREPIRS2",56,0)
 F  S MSG=$O(^XTMP("LREPILOCALSPSHT"_LRLRDT,MSG)) Q:'MSG  S LRMSGLIN=^(MSG) D  Q:LRQUIT
"RTN","LREPIRS2",57,0)
 .W !,LRMSGLIN
"RTN","LREPIRS2",58,0)
 .I $Y>(IOSL-6) D NPG
"RTN","LREPIRS2",59,0)
 K MSGLIN,LRSEG
"RTN","LREPIRS2",60,0)
 Q
"RTN","LREPIRS2",61,0)
READY ;
"RTN","LREPIRS2",62,0)
 K DIR S DIR(0)="Y",DIR("A")="Ready to Capture"
"RTN","LREPIRS2",63,0)
 D ^DIR S:$D(DIRUT) LREND=1
"RTN","LREPIRS2",64,0)
 S:'Y LREND=1
"RTN","LREPIRS2",65,0)
 Q
"RTN","LREPIRS2",66,0)
PRIV ;PRIVACY MESSAGE
"RTN","LREPIRS2",67,0)
 W !!!,"This report will contain Confidential Information."
"RTN","LREPIRS2",68,0)
 K DIR S DIR(0)="Y",DIR("A")="Do you wish to continue/proceed"
"RTN","LREPIRS2",69,0)
 S DIR("B")="NO"
"RTN","LREPIRS2",70,0)
 D ^DIR S:$D(DIRUT) LREND=1
"RTN","LREPIRS2",71,0)
 S:'Y LREND=1
"RTN","LREPIRS2",72,0)
 Q
"RTN","LREPIRS2",73,0)
REP ;
"RTN","LREPIRS2",74,0)
 S %ZIS="Q" D ^%ZIS Q:POP  I '$D(IO("Q")) U IO D PRT Q
"RTN","LREPIRS2",75,0)
 S ZTRTN="PRT^LREPIRS2",ZTSAVE("LR*")="",ZTDESC="PRINT EPI LOCAL REPORT" D ^%ZTLOAD,HOME^%ZIS G EXIT
"RTN","LREPIRS2",76,0)
 Q
"RTN","LREPIRS2",77,0)
PRT ;Print report
"RTN","LREPIRS2",78,0)
 S MSG=0,LRLC=0,LRPAGE=1,LRQUIT=0
"RTN","LREPIRS2",79,0)
 W !,"***THIS REPORT CONTAINS CONFIDENTIAL INFORMATION.***"
"RTN","LREPIRS2",80,0)
 D HDG
"RTN","LREPIRS2",81,0)
 F  S MSG=$O(^XTMP("LREPILOCALREP"_LRLRDT,MSG)) Q:'MSG  S LRMSGLIN=^(MSG) D  Q:LRQUIT
"RTN","LREPIRS2",82,0)
 .W !,LRMSGLIN
"RTN","LREPIRS2",83,0)
 .S LRLC=LRLC+1
"RTN","LREPIRS2",84,0)
 .I $Y>(IOSL-6) D NPG
"RTN","LREPIRS2",85,0)
 K MSGLIN,LRSEG
"RTN","LREPIRS2",86,0)
 Q
"RTN","LREPIRS2",87,0)
PAUSE ;
"RTN","LREPIRS2",88,0)
 Q:$G(LREND)
"RTN","LREPIRS2",89,0)
 K DIR S DIR(0)="E" D ^DIR
"RTN","LREPIRS2",90,0)
 S:($D(DTOUT))!($D(DUOUT)) LRQUIT=1
"RTN","LREPIRS2",91,0)
 Q
"RTN","LREPIRS2",92,0)
NPG ;NEW PAGE
"RTN","LREPIRS2",93,0)
 D:$E(IOST,1,2)="C-" PAUSE
"RTN","LREPIRS2",94,0)
 Q:$G(LRQUIT)
"RTN","LREPIRS2",95,0)
 W @IOF
"RTN","LREPIRS2",96,0)
 D HDG
"RTN","LREPIRS2",97,0)
 Q
"RTN","LREPIRS2",98,0)
HDG ;
"RTN","LREPIRS2",99,0)
 S LRHDGLC=""
"RTN","LREPIRS2",100,0)
 F  S LRHDGLC=$O(^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)) Q:LRHDGLC=""  D
"RTN","LREPIRS2",101,0)
 .S LRHDG=^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)
"RTN","LREPIRS2",102,0)
 .W !,LRHDG
"RTN","LREPIRS2",103,0)
 .I LRHDGLC=0 W "   PAGE ",LRPAGE
"RTN","LREPIRS2",104,0)
 .S LRLC=LRLC+1
"RTN","LREPIRS2",105,0)
 S LRPAGE=LRPAGE+1
"RTN","LREPIRS2",106,0)
 Q
"RTN","LREPIRS2",107,0)
SAVHDG ;SAVE HEADING WHEN GENERATE REPORT
"RTN","LREPIRS2",108,0)
 ;called from LREPIRS1
"RTN","LREPIRS2",109,0)
 S Y=DT X ^DD("DD")
"RTN","LREPIRS2",110,0)
 S SITE=$$SITE^VASITE
"RTN","LREPIRS2",111,0)
 S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)="         EMERGING PATHOGENS LOCAL REPORT             "_Y
"RTN","LREPIRS2",112,0)
 S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",113,0)
 S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)="         FROM STATION "_$P(SITE,U,3)_" "_$P(SITE,U,2)
"RTN","LREPIRS2",114,0)
 S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",115,0)
 S LRDTHDG=^TMP("HLS",$J,1)
"RTN","LREPIRS2",116,0)
 S Y=$$CDT^LREPIRP2($P($P($P(LRDTHDG,HLFS,3),LRCS,2)," ",4))
"RTN","LREPIRS2",117,0)
 S MSG=Y
"RTN","LREPIRS2",118,0)
 S Y=$$CDT^LREPIRP2($P($P($P(LRDTHDG,HLFS,3),LRCS,2)," ",6))
"RTN","LREPIRS2",119,0)
 S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)="         PROCESSING PERIOD FROM "_MSG_" THROUGH "_Y
"RTN","LREPIRS2",120,0)
 S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",121,0)
 S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)="Reported Local Pathogens:"
"RTN","LREPIRS2",122,0)
 S LRI=0
"RTN","LREPIRS2",123,0)
 F  S LRI=$O(LREPI(LRI))  Q:LRI=""   D
"RTN","LREPIRS2",124,0)
 .S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=^(LRHDGLC)_$P(^LAB(69.5,LRI,0),U)_"  " I $L(^(LRHDGLC))>60 D
"RTN","LREPIRS2",125,0)
 ..S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",126,0)
 ..S:'($D(^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC))) ^(LRHDGLC)=$P(^LAB(69.5,LRI,0),U)_"   "
"RTN","LREPIRS2",127,0)
 ..E  S ^(LRHDGLC)=^(LRHDGLC)_"   "_$P(^LAB(69.5,LRI,0),U)
"RTN","LREPIRS2",128,0)
 S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",129,0)
 S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=" ",LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",130,0)
 S LRHDG=""
"RTN","LREPIRS2",131,0)
 I $D(LRSEG("PID",1)) S LRHDG="Set Id"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",132,0)
 I $D(LRSEG("PID",2)) S LRHDG=LRHDG_"SSN"_$S(LRREP=1:"       ",1:"|")
"RTN","LREPIRS2",133,0)
 I $D(LRSEG("PID",3)) S LRHDG=LRHDG_"MPI"_$S(LRREP=1:$E(LRSP,1,13),1:"|")
"RTN","LREPIRS2",134,0)
 I $D(LRSEG("PID",4)) S LRHDG=LRHDG_"Patient Name"_$S(LRREP=1:$E(LRSP,1,19),1:"|")
"RTN","LREPIRS2",135,0)
 I $D(LRSEG("PID",5)) S LRHDG=LRHDG_"Birth Date"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",136,0)
 I $D(LRSEG("PID",6)) S LRHDG=LRHDG_"Sex"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",137,0)
 I $D(LRSEG("PID",7)) S LRHDG=LRHDG_"Race"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",138,0)
 I $D(LRSEG("PID",8)) S LRHDG=LRHDG_"Homeless"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",139,0)
 I $D(LRSEG("PID",9)) S LRHDG=LRHDG_"State"_$S(LRREP=1:$E(LRSP,1,11),1:"|")
"RTN","LREPIRS2",140,0)
 I $D(LRSEG("PID",10)) S LRHDG=LRHDG_"Zip"_$S(LRREP=1:"   ",1:"|")
"RTN","LREPIRS2",141,0)
 I $D(LRSEG("PID",11)) S LRHDG=LRHDG_"County"_$S(LRREP=1:$E(LRSP,1,25),1:"|")
"RTN","LREPIRS2",142,0)
 I $D(LRSEG("PID",12)) S LRHDG=LRHDG_"Ethnicity"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",143,0)
 I $D(LRSEG("PID",13)) S LRHDG=LRHDG_"POS"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",144,0)
 I LRHDG]"" S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=LRHDG S LRHDG="" S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",145,0)
 I $D(LRSEG("PV1",1)) S LRHDG=LRHDG_"Set Id"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",146,0)
 I $D(LRSEG("PV1",2)) S LRHDG=LRHDG_"Patient Class"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",147,0)
 I $D(LRSEG("PV1",3)) S LRHDG=LRHDG_"Hospital Location"_$S(LRREP=1:"   ",1:"|")
"RTN","LREPIRS2",148,0)
 I $D(LRSEG("PV1",4)) S LRHDG=LRHDG_"Discharge Disposition"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",149,0)
 I $D(LRSEG("PV1",5)) S LRHDG=LRHDG_"Facility"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",150,0)
 I $D(LRSEG("PV1",6)) S LRHDG=LRHDG_"Admit Date/Time"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",151,0)
 I $D(LRSEG("PV1",7)) S LRHDG=LRHDG_"Discharge Date/Time"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",152,0)
 I LRHDG]"" S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=LRHDG S LRHDG="" S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",153,0)
 I $D(LRSEG("DG1",1)) S LRHDG=LRHDG_"Set Id"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",154,0)
 I $D(LRSEG("DG1",2)) S LRHDG=LRHDG_"Diagnosis Code"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",155,0)
 I $D(LRSEG("DG1",3)) S LRHDG=LRHDG_"Diagnosis"_$S(LRREP=1:$E(LRSP,1,31),1:"|")
"RTN","LREPIRS2",156,0)
 I $D(LRSEG("DG1",4)) S LRHDG=LRHDG_"Admission Date"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",157,0)
 I LRHDG]"" S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=LRHDG S LRHDG="" S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",158,0)
 I $D(LRSEG("NTE",1)) S LRHDG=LRHDG_"Set ID"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",159,0)
 I $D(LRSEG("NTE",2)) S LRHDG=LRHDG_"Comment"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",160,0)
 I LRHDG]"" S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=LRHDG S LRHDG="" S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",161,0)
 I $D(LRSEG("OBR",1)) S LRHDG=LRHDG_"Set ID"_$S(LRREP=1:" ",1:"|")
"RTN","LREPIRS2",162,0)
 I $D(LRSEG("OBR",2)) S LRHDG=LRHDG_"Test Name"_$S(LRREP=1:$E(LRSP,1,12),1:"|")
"RTN","LREPIRS2",163,0)
 I $D(LRSEG("OBR",3)) S LRHDG=LRHDG_"Accession Date"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",164,0)
 I $D(LRSEG("OBR",4)) S LRHDG=LRHDG_"Specimen"_$S(LRREP=1:$E(LRSP,1,13),1:"|")
"RTN","LREPIRS2",165,0)
 I $D(LRSEG("OBR",5)) S LRHDG=LRHDG_"Accession Number"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",166,0)
 I LRHDG]"" S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=LRHDG_$S(LRREP=1:" ",1:"|")_"OBR SUBID" S LRHDG="" S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",167,0)
 I $D(LRSEG("OBX",1)) S LRHDG=LRHDG_"Set Id"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",168,0)
 I $D(LRSEG("OBX",2)) S LRHDG=LRHDG_"Value Type"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",169,0)
 I $D(LRSEG("OBX",3)) S LRHDG=LRHDG_"Test Name"_$S(LRREP=1:$E(LRSP,1,22),1:"|")
"RTN","LREPIRS2",170,0)
 I $D(LRSEG("OBX",4)) S LRHDG=LRHDG_"LOINC Code"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",171,0)
 I $D(LRSEG("OBX",5)) S LRHDG=LRHDG_"LOINC Name"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",172,0)
 I $D(LRSEG("OBX",6)) S LRHDG=LRHDG_"Test Result"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",173,0)
 I $D(LRSEG("OBX",7)) S LRHDG=LRHDG_"Units"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",174,0)
 I $D(LRSEG("OBX",8)) S LRHDG=LRHDG_"Flags and Interp"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",175,0)
 I $D(LRSEG("OBX",9)) S LRHDG=LRHDG_"Verified Date/Time"_$S(LRREP=1:"  ",1:"|")
"RTN","LREPIRS2",176,0)
 I LRHDG]"" S ^XTMP("LREPILOCALREP"_LRLRDT,"HDG",LRHDGLC)=LRHDG_$S(LRREP=1:" ",1:"|")_"OBX SUBID" S LRHDG="" S LRHDGLC=LRHDGLC+1
"RTN","LREPIRS2",177,0)
 Q
"RTN","LREPIRS2",178,0)
DELETE ;Delete a report or spreadsheet
"RTN","LREPIRS2",179,0)
 W !?5,"Delete a Local Report/Spreadsheet Option"
"RTN","LREPIRS2",180,0)
DRORS ;REPORT OR SPREADSHEET
"RTN","LREPIRS2",181,0)
 S DIR(0)="SO^1:REPORT;2:SPREADSHEET"
"RTN","LREPIRS2",182,0)
 S DIR("A")="Which one do you wish to delete"
"RTN","LREPIRS2",183,0)
 D ^DIR
"RTN","LREPIRS2",184,0)
 G:$D(DIRUT) EXIT
"RTN","LREPIRS2",185,0)
 S LRREP=Y
"RTN","LREPIRS2",186,0)
 K DIR,DIRUT
"RTN","LREPIRS2",187,0)
DCHOOSE ;CHOOSE WHICH REPORT/SPREADSHEET TO DELETE
"RTN","LREPIRS2",188,0)
 S LRLRDTX=1,LRY=1,LRNODE="LREPI"_$S(LRREP=1:"LOCALREP",1:"LOCALSPSHT"),LRNODE1=LRNODE
"RTN","LREPIRS2",189,0)
 F  S LRNODE=$O(^XTMP(LRNODE)) Q:LRNODE=""!(LRNODE'[LRNODE1)  S LRLRDTX=$E(LRNODE,$S(LRREP=1:14,1:16),$S(LRREP=1:28,1:30))  D
"RTN","LREPIRS2",190,0)
 .Q:LRLRDTX=""
"RTN","LREPIRS2",191,0)
 .I '$D(^XTMP("LREPI"_$S(LRREP=1:"LOCALREP",1:"LOCALSPSHT")_LRLRDTX,"DONE")) Q
"RTN","LREPIRS2",192,0)
 .S Y=LRLRDTX X ^DD("DD") S LRLRDT(LRLRDTX)=Y,LRLRDT(LRY)=LRLRDTX
"RTN","LREPIRS2",193,0)
 .S LRTITLE=$G(^XTMP("LREPI"_$S(LRREP=1:"LOCALREP",1:"LOCALSPSHT")_LRLRDTX,"TITLE"))
"RTN","LREPIRS2",194,0)
 .W !,LRY," ",LRLRDT(LRLRDTX)," ",LRTITLE
"RTN","LREPIRS2",195,0)
 .S LRY=LRY+1
"RTN","LREPIRS2",196,0)
 S LRY=LRY-1
"RTN","LREPIRS2",197,0)
 I LRY=0,'$D(LRTITLE) W !,"No "_$S(LRREP=1:"report ",1:"spreadsheet ")_"is ready for printing." G RORS
"RTN","LREPIRS2",198,0)
 S DIR(0)="NO^1:"_LRY
"RTN","LREPIRS2",199,0)
 S DIR("A")="Choose the number for the "_$S(LRREP=1:"report",LRREP=2:"spreadsheet")_" you wish to delete"
"RTN","LREPIRS2",200,0)
 D ^DIR
"RTN","LREPIRS2",201,0)
 G:$D(DIRUT) RORS
"RTN","LREPIRS2",202,0)
 S LRY=Y,LRLRDT=LRLRDT(LRY)
"RTN","LREPIRS2",203,0)
 K DIR,DIRUT
"RTN","LREPIRS2",204,0)
 S LRY=Y
"RTN","LREPIRS2",205,0)
 F I=1:1 Q:$P(LRY,",",I)=""  S LRLRDT=LRLRDT($P(LRY,",",I)) D
"RTN","LREPIRS2",206,0)
 .I LRREP=2 K ^XTMP("LREPILOCALSPSHT"_LRLRDT) W !,"Spreadsheet deleted."
"RTN","LREPIRS2",207,0)
 .I LRREP=1 K ^XTMP("LREPILOCALREP"_LRLRDT) W !,"Report deleted."
"RTN","LREPIRS2",208,0)
 G EXIT
"RTN","LREPIRS3")
0^14^B53422919
"RTN","LREPIRS3",1,0)
LREPIRS3 ;DALOI/CKA-EMERGING PATHOGENS LOCAL REPORT-GENERATE SPSHT ;9/9/03
"RTN","LREPIRS3",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPIRS3",3,0)
 ; Reference to ^DIC(21 supported by IA #913
"RTN","LREPIRS3",4,0)
 Q
"RTN","LREPIRS3",5,0)
SPSHT ;
"RTN","LREPIRS3",6,0)
 S X1=DT,X2=180 D C^%DTC
"RTN","LREPIRS3",7,0)
 S ^XTMP("LREPILOCALSPSHT"_LRLRDT,0)=X_"^"_DT_"^EPI Local Report generation^"_$S($D(DUZ):DUZ,1:"UNKNOWN")
"RTN","LREPIRS3",8,0)
HDG1 ;
"RTN","LREPIRS3",9,0)
 S LRHDG="",LRLC=1,LRX=0
"RTN","LREPIRS3",10,0)
 I $D(LRSEG("PID")) S LRX("PID")=LRX,LRHDG="|"_LRX("PID")_"| |"
"RTN","LREPIRS3",11,0)
 I $D(LRSEG("PID",1)) S LRHDG=LRHDG_"PID|"
"RTN","LREPIRS3",12,0)
 I $D(LRSEG("PID",2)) S LRHDG=LRHDG_"SSN|"
"RTN","LREPIRS3",13,0)
 I $D(LRSEG("PID",3)) S LRHDG=LRHDG_"MPI|"
"RTN","LREPIRS3",14,0)
 I $D(LRSEG("PID",4)) S LRHDG=LRHDG_"Patient Name|"
"RTN","LREPIRS3",15,0)
 I $D(LRSEG("PID",5)) S LRHDG=LRHDG_"Date of Birth|"
"RTN","LREPIRS3",16,0)
 I $D(LRSEG("PID",6)) S LRHDG=LRHDG_"Sex|"
"RTN","LREPIRS3",17,0)
 I $D(LRSEG("PID",7)) S LRHDG=LRHDG_"Race|"
"RTN","LREPIRS3",18,0)
 I $D(LRSEG("PID",8)) S LRHDG=LRHDG_"Homeless|"
"RTN","LREPIRS3",19,0)
 I $D(LRSEG("PID",9)) S LRHDG=LRHDG_"State|"
"RTN","LREPIRS3",20,0)
 I $D(LRSEG("PID",10)) S LRHDG=LRHDG_"Zip|"
"RTN","LREPIRS3",21,0)
 I $D(LRSEG("PID",11)) S LRHDG=LRHDG_"County|"
"RTN","LREPIRS3",22,0)
 I $D(LRSEG("PID",12)) S LRHDG=LRHDG_"Ethnicity|"
"RTN","LREPIRS3",23,0)
 I $D(LRSEG("PID",13)) S LRHDG=LRHDG_"POS|"
"RTN","LREPIRS3",24,0)
 I LRHDG]"" S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRHDG S LRHDG="" S LRLC=LRLC+1
"RTN","LREPIRS3",25,0)
 I $D(LRSEG("PV1")) S LRX=LRX+1,LRX("PV1")=LRX,LRHDG="|"_LRX_"| |"
"RTN","LREPIRS3",26,0)
 I $D(LRSEG("PV1",1)) S LRHDG=LRHDG_"PV1|"
"RTN","LREPIRS3",27,0)
 I $D(LRSEG("PV1",2)) S LRHDG=LRHDG_"Patient Class|"
"RTN","LREPIRS3",28,0)
 I $D(LRSEG("PV1",3)) S LRHDG=LRHDG_"Hospital Location|"
"RTN","LREPIRS3",29,0)
 I $D(LRSEG("PV1",4)) S LRHDG=LRHDG_"Discharge Disposition|"
"RTN","LREPIRS3",30,0)
 I $D(LRSEG("PV1",5)) S LRHDG=LRHDG_"Facility|"
"RTN","LREPIRS3",31,0)
 I $D(LRSEG("PV1",6)) S LRHDG=LRHDG_"Admit Date/Time|"
"RTN","LREPIRS3",32,0)
 I $D(LRSEG("PV1",7)) S LRHDG=LRHDG_"Discharge Date/Time|"
"RTN","LREPIRS3",33,0)
 I LRHDG]"" S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRHDG S LRHDG="" S LRLC=LRLC+1
"RTN","LREPIRS3",34,0)
 I $D(LRSEG("DG1")) S LRX=LRX+1,LRX("DG1")=LRX,LRHDG="|"_LRX_"| |"
"RTN","LREPIRS3",35,0)
 I $D(LRSEG("DG1",1)) S LRHDG=LRHDG_"DG1|"
"RTN","LREPIRS3",36,0)
 I $D(LRSEG("DG1",2)) S LRHDG=LRHDG_"Diagnosis Code|"
"RTN","LREPIRS3",37,0)
 I $D(LRSEG("DG1",3)) S LRHDG=LRHDG_"Diagnosis|"
"RTN","LREPIRS3",38,0)
 I $D(LRSEG("DG1",4)) S LRHDG=LRHDG_"Admission Date|"
"RTN","LREPIRS3",39,0)
 I LRHDG]"" S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRHDG S LRHDG="" S LRLC=LRLC+1
"RTN","LREPIRS3",40,0)
 I $D(LRSEG("NTE")) S LRX=LRX+1,LRX("NTE")=LRX,LRHDG="|"_LRX_"| |"
"RTN","LREPIRS3",41,0)
 I $D(LRSEG("NTE",1)) S LRHDG=LRHDG_"NTE|"
"RTN","LREPIRS3",42,0)
 I $D(LRSEG("NTE",2)) S LRHDG=LRHDG_"Comment|"
"RTN","LREPIRS3",43,0)
 I LRHDG]"" S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRHDG S LRHDG="" S LRLC=LRLC+1
"RTN","LREPIRS3",44,0)
 I $D(LRSEG("OBR")) S LRX=LRX+1,LRX("OBR")=LRX,LRHDG="|"_LRX_"| |"
"RTN","LREPIRS3",45,0)
 I $D(LRSEG("OBR",1)) S LRHDG=LRHDG_"OBR|"
"RTN","LREPIRS3",46,0)
 I $D(LRSEG("OBR",2)) S LRHDG=LRHDG_"Test Name|"
"RTN","LREPIRS3",47,0)
 I $D(LRSEG("OBR",3)) S LRHDG=LRHDG_"Accession Date/Time|"
"RTN","LREPIRS3",48,0)
 I $D(LRSEG("OBR",4)) S LRHDG=LRHDG_"Specimen|"
"RTN","LREPIRS3",49,0)
 I $D(LRSEG("OBR",5)) S LRHDG=LRHDG_"Accession Number|"
"RTN","LREPIRS3",50,0)
 I LRHDG'="" S LRHDG=LRHDG_"OBR SUBID"
"RTN","LREPIRS3",51,0)
 I LRHDG]"" S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRHDG S LRHDG="" S LRLC=LRLC+1
"RTN","LREPIRS3",52,0)
 I $D(LRSEG("OBX")) S LRX=LRX+1,LRX("OBX")=LRX,LRHDG="|"_LRX_"| |"
"RTN","LREPIRS3",53,0)
 I $D(LRSEG("OBX",1)) S LRHDG=LRHDG_"OBX|"
"RTN","LREPIRS3",54,0)
 I $D(LRSEG("OBX",2)) S LRHDG=LRHDG_"Value Type|"
"RTN","LREPIRS3",55,0)
 I $D(LRSEG("OBX",3)) S LRHDG=LRHDG_"Test Name|"
"RTN","LREPIRS3",56,0)
 I $D(LRSEG("OBX",4)) S LRHDG=LRHDG_"LOINC Code|"
"RTN","LREPIRS3",57,0)
 I $D(LRSEG("OBX",5)) S LRHDG=LRHDG_"LOINC Name|"
"RTN","LREPIRS3",58,0)
 I $D(LRSEG("OBX",6)) S LRHDG=LRHDG_"Test Result|"
"RTN","LREPIRS3",59,0)
 I $D(LRSEG("OBX",7)) S LRHDG=LRHDG_"Units|"
"RTN","LREPIRS3",60,0)
 I $D(LRSEG("OBX",8)) S LRHDG=LRHDG_"Flags or Interp|"
"RTN","LREPIRS3",61,0)
 I $D(LRSEG("OBX",9)) S LRHDG=LRHDG_"Verified Date/Time|"
"RTN","LREPIRS3",62,0)
 I LRHDG'="" S LRHDG=LRHDG_"OBX SUBID"
"RTN","LREPIRS3",63,0)
 I LRHDG]"" S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRHDG S LRHDG="" S LRLC=LRLC+1
"RTN","LREPIRS3",64,0)
 S MSG=0,LRSPSHT="",LRPID="",LROBR=""
"RTN","LREPIRS3",65,0)
 F  S MSG=$O(^TMP("HLS",$J,MSG)) Q:'MSG  S LRMSGLIN=^(MSG) D
"RTN","LREPIRS3",66,0)
 .S LRSPSHT=""
"RTN","LREPIRS3",67,0)
 .Q:$P(LRMSGLIN,"|")=""
"RTN","LREPIRS3",68,0)
 .Q:'$D(LRSEG($P(LRMSGLIN,"|")))
"RTN","LREPIRS3",69,0)
 .I $P(LRMSGLIN,"|")="PID" D
"RTN","LREPIRS3",70,0)
 ..S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRSPSHT,LRLC=LRLC+1
"RTN","LREPIRS3",71,0)
 .I $P(LRMSGLIN,"|")="PID" D
"RTN","LREPIRS3",72,0)
 ..S LRSPSHT="********************************************************************************"
"RTN","LREPIRS3",73,0)
 ..I $D(LRSEG("PID")) S LRPID=$P(LRMSGLIN,HLFS,2),LRSPSHT=LRPID_"|"_LRX("PID")_"| | |"
"RTN","LREPIRS3",74,0)
 ..I $D(LRSEG("PID",2)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,20)_"|"
"RTN","LREPIRS3",75,0)
 ..I $D(LRSEG("PID",3)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,4),LRCS,4)_"|"
"RTN","LREPIRS3",76,0)
 ..I $D(LRSEG("PID",4)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,6)_"|"
"RTN","LREPIRS3",77,0)
 ..I $D(LRSEG("PID",5)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,8))_"|"
"RTN","LREPIRS3",78,0)
 ..I $D(LRSEG("PID",6)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,9)_"|"
"RTN","LREPIRS3",79,0)
 ..I $D(LRSEG("PID",7)) D  K LRZ,LRY
"RTN","LREPIRS3",80,0)
 ...S LRZ=0,DFN=$P($P(LRMSGLIN,HLFS,4),LRCS) F LRY=1:1 S LRZ=$O(^DPT(DFN,.02,LRZ)) Q:'LRZ
"RTN","LREPIRS3",81,0)
 ...I LRY>2 S LRSPSHT=LRSPSHT_"MULTIPLE|"
"RTN","LREPIRS3",82,0)
 ...E  S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,11),LRCS,2)_"|"
"RTN","LREPIRS3",83,0)
 ..I $D(LRSEG("PID",8)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,12),LRCS,1)_"|"
"RTN","LREPIRS3",84,0)
 ..I $D(LRSEG("PID",9)) S LRSPSHT=LRSPSHT_$P($P($P(LRMSGLIN,HLFS,12),LRCS,4),U,2)_"|"
"RTN","LREPIRS3",85,0)
 ..I $D(LRSEG("PID",10)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,12),LRCS,5)_"|"
"RTN","LREPIRS3",86,0)
 ..I $D(LRSEG("PID",11)) S LRSPSHT=LRSPSHT_$P($P($P(LRMSGLIN,HLFS,12),LRCS,9),U,2)_"|"
"RTN","LREPIRS3",87,0)
 ..I $D(LRSEG("PID",12)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,23),LRCS,2)_"|"
"RTN","LREPIRS3",88,0)
 ..I $D(LRSEG("PID",13)) D  I LRPOS="" S LRSPSHT=LRSPSHT_"||"
"RTN","LREPIRS3",89,0)
 ...S LRPOS=$P(LRMSGLIN,HLFS,28)
"RTN","LREPIRS3",90,0)
 ...Q:LRPOS=""
"RTN","LREPIRS3",91,0)
 ...S LRPOSN=0
"RTN","LREPIRS3",92,0)
 ...F  S LRPOSN=$O(^DIC(21,LRPOSN)) Q:LRPOSN'>0  I $P($G(^DIC(21,LRPOSN,0)),U,3)=LRPOS S LRPOSNAM=$P(^(0),U) Q
"RTN","LREPIRS3",93,0)
 ...S LRSPSHT=LRSPSHT_LRPOSNAM_"|"
"RTN","LREPIRS3",94,0)
 .K LRPOS,LRPOSN,LRPOSNAM
"RTN","LREPIRS3",95,0)
 .I $P(LRMSGLIN,"|")="PV1" D
"RTN","LREPIRS3",96,0)
 ..I $D(LRSEG("PV1")) S LRSPSHT=LRPID_"|"_LRX("PV1")_"|"_$P(LRMSGLIN,HLFS,2)_"| |"
"RTN","LREPIRS3",97,0)
 ..I $D(LRSEG("PV1",2)) D
"RTN","LREPIRS3",98,0)
 ...S TYPE=$P(LRMSGLIN,HLFS,3)
"RTN","LREPIRS3",99,0)
 ...S LRSPSHT=LRSPSHT_$S(TYPE="U":"Update",TYPE="I":"Inpatient",1:"Outpatient")_"|"
"RTN","LREPIRS3",100,0)
 ...K TYPE
"RTN","LREPIRS3",101,0)
 ..I $D(LRSEG("PV1",3)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,4)_"|"
"RTN","LREPIRS3",102,0)
 ..I $D(LRSEG("PV1",4)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,37),LRCS,2)_"|"
"RTN","LREPIRS3",103,0)
 ..I $D(LRSEG("PV1",5)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,40)_"|"
"RTN","LREPIRS3",104,0)
 ..I $D(LRSEG("PV1",6)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,45))_"|"
"RTN","LREPIRS3",105,0)
 ..I $D(LRSEG("PV1",7)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,46))_"|"
"RTN","LREPIRS3",106,0)
 .I $P(LRMSGLIN,"|")="NTE" D
"RTN","LREPIRS3",107,0)
 ..I $D(LRSEG("NTE")) S LRSPSHT=LRPID_"|"_LRX("NTE")_"|"_$P(LRMSGLIN,HLFS,2)_"| |"
"RTN","LREPIRS3",108,0)
 ..I $D(LRSEG("NTE",2)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,3)_"|"
"RTN","LREPIRS3",109,0)
 .I $P(LRMSGLIN,"|")="OBR" D
"RTN","LREPIRS3",110,0)
 ..I $D(LRSEG("OBR")) S LROBR=$P(LRMSGLIN,HLFS,2),LRSPSHT=LRPID_"|"_LRX("OBR")_"|"_LROBR_"| |"
"RTN","LREPIRS3",111,0)
 ..I $D(LRSEG("OBR",2)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,5),LRCS,2)_"|"
"RTN","LREPIRS3",112,0)
 ..I $D(LRSEG("OBR",3)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P(LRMSGLIN,HLFS,8))_"|"
"RTN","LREPIRS3",113,0)
 ..I $D(LRSEG("OBR",4)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,16),LRCS,3)_"|"
"RTN","LREPIRS3",114,0)
 ..I $D(LRSEG("OBR",5)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,19)_"|"
"RTN","LREPIRS3",115,0)
 ..S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,27),LRCS,2)
"RTN","LREPIRS3",116,0)
 .I $P(LRMSGLIN,"|")="OBX" D
"RTN","LREPIRS3",117,0)
 ..I $D(LRSEG("OBX")) S LRSPSHT=LRPID_"|"_LRX("OBX")_"|"_LROBR_"|"_$P(LRMSGLIN,HLFS,2)_"|"
"RTN","LREPIRS3",118,0)
 ..I $P(LRMSGLIN,HLFS,3)="ST" D
"RTN","LREPIRS3",119,0)
 ...S TSTNM=$P($P(LRMSGLIN,HLFS,4),LRCS,2)
"RTN","LREPIRS3",120,0)
 ...S OV=$P(LRMSGLIN,HLFS,6)
"RTN","LREPIRS3",121,0)
 ..I $P(LRMSGLIN,HLFS,3)="CE" D
"RTN","LREPIRS3",122,0)
 ...S TSTNM=""
"RTN","LREPIRS3",123,0)
 ...S OV=$P($P(LRMSGLIN,HLFS,6),LRCS,2)
"RTN","LREPIRS3",124,0)
 ..S FD=$$CDT^LREPIRP($P(LRMSGLIN,HLFS,15)),RR=$P(LRMSGLIN,HLFS,9)
"RTN","LREPIRS3",125,0)
 ..S UN=$P(LRMSGLIN,HLFS,7)
"RTN","LREPIRS3",126,0)
 ..I $P($P(LRMSGLIN,HLFS,4),LRCS,9)="LOINC" D
"RTN","LREPIRS3",127,0)
 ...S LOINC=$P($P(LRMSGLIN,HLFS,4),LRCS,7),LOINCN=$P($P(LRMSGLIN,HLFS,4),LRCS,8)
"RTN","LREPIRS3",128,0)
 ..I $D(LRSEG("OBX",2)) S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,3)_"|"
"RTN","LREPIRS3",129,0)
 ..I $D(LRSEG("OBX",3)) S LRSPSHT=LRSPSHT_TSTNM_"|"
"RTN","LREPIRS3",130,0)
 ..I $D(LRSEG("OBX",4)) S LRSPSHT=LRSPSHT_$G(LOINC)_"|"
"RTN","LREPIRS3",131,0)
 ..I $D(LRSEG("OBX",5)) S LRSPSHT=LRSPSHT_$G(LOINCN)_"|"
"RTN","LREPIRS3",132,0)
 ..I $D(LRSEG("OBX",6)) S LRSPSHT=LRSPSHT_OV_"|"
"RTN","LREPIRS3",133,0)
 ..I $D(LRSEG("OBX",7)) S LRSPSHT=LRSPSHT_UN_"|"
"RTN","LREPIRS3",134,0)
 ..I $D(LRSEG("OBX",8)) S LRSPSHT=LRSPSHT_RR_"|"
"RTN","LREPIRS3",135,0)
 ..I $D(LRSEG("OBX",9)) S LRSPSHT=LRSPSHT_FD_"|"
"RTN","LREPIRS3",136,0)
 ..S LRSPSHT=LRSPSHT_$P(LRMSGLIN,HLFS,5)
"RTN","LREPIRS3",137,0)
 ..K TST,TSTNM,LOINC,LOINCN,ENTRY,UN,RR,FD,OV
"RTN","LREPIRS3",138,0)
 .I $P(LRMSGLIN,"|")="DG1" D
"RTN","LREPIRS3",139,0)
 ..I $D(LRSEG("DG1")) S LRSPSHT=LRPID_"|"_LRX("DG1")_"|"_$P(LRMSGLIN,HLFS,2)_"| |"
"RTN","LREPIRS3",140,0)
 ..I $D(LRSEG("DG1",2)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,4),LRCS,1)_"|"
"RTN","LREPIRS3",141,0)
 ..I $D(LRSEG("DG1",3)) S LRSPSHT=LRSPSHT_$P($P(LRMSGLIN,HLFS,4),LRCS,2)_"|"
"RTN","LREPIRS3",142,0)
 ..I $D(LRSEG("DG1",4)) S LRSPSHT=LRSPSHT_$$CDT^LREPIRP($P($P(LRMSGLIN,HLFS,5),LRCS))_"|"
"RTN","LREPIRS3",143,0)
 .S ^XTMP("LREPILOCALSPSHT"_LRLRDT,LRLC)=LRSPSHT,LRLC=LRLC+1
"RTN","LREPIRS3",144,0)
 K MSGLIN,LRSEG,LRZ
"RTN","LREPIRS3",145,0)
 Q
"RTN","LREPISRV")
0^4^B27007288
"RTN","LREPISRV",1,0)
LREPISRV ;DALOI/RLM-EPI data server ;8/2/2000
"RTN","LREPISRV",2,0)
 ;;5.2;LAB SERVICE;**260,281**;Sep 27, 1994
"RTN","LREPISRV",3,0)
 ; Reference to $$SITE^VASITE supported by IA #10112
"RTN","LREPISRV",4,0)
 ; Reference to ^%ZOSF supported by IA #10096
"RTN","LREPISRV",5,0)
 ; Reference to ^ICD9( supported by IA #10082
"RTN","LREPISRV",6,0)
 ; Reference to ^ORD(101 supported by IA #872
"RTN","LREPISRV",7,0)
START ;
"RTN","LREPISRV",8,0)
 K ^TMP($J,"LREPDATA")
"RTN","LREPISRV",9,0)
 S LREPST=$P($$SITE^VASITE,"^",2)
"RTN","LREPISRV",10,0)
 ;Determine station number
"RTN","LREPISRV",11,0)
 S X=XQSUB X ^%ZOSF("UPPERCASE") S LREPSUB=Y
"RTN","LREPISRV",12,0)
 S ^TMP($J,"LREPDATA",1)=LREPSUB_" triggered at "_LREPST_" by "_XMFROM_" on "_XQDATE
"RTN","LREPISRV",13,0)
 ;The first line of the message tells who requested the action and when
"RTN","LREPISRV",14,0)
 S ^TMP($J,"LREPDATA",2)="No"_$S(LREPSUB["REPORT":" report generated",1:"thing done")_" at "_LREPST
"RTN","LREPISRV",15,0)
 ;The second line tells when the server is activated and no data can be gathered from the MailMan message.
"RTN","LREPISRV",16,0)
 S LREPLNT=1
"RTN","LREPISRV",17,0)
 I LREPSUB["REPORT" G REPORT
"RTN","LREPISRV",18,0)
 ;If the subject contains "REPORT" send a report
"RTN","LREPISRV",19,0)
EXIT ;If all went well, report that too.
"RTN","LREPISRV",20,0)
 S %H=$H D YMD^%DTC S XMDUN="EPI SYSTEM",XMDUZ=".5",XMSUB=LREPST_" EPI ("_X_%_")",XMTEXT="^TMP($J,""LREPDATA"","
"RTN","LREPISRV",21,0)
 S XMY("G.EPI-SITE@CINCINNATI.VA.GOV")=""
"RTN","LREPISRV",22,0)
 ;S XMY("ANZALDUA,CAROL@VAHVSS.FO-ALBANY.MED.VA.GOV")="" ;,XMY("CAROL.ANZALDUA@MED.VA.GOV")=""
"RTN","LREPISRV",23,0)
 D ^XMD
"RTN","LREPISRV",24,0)
 ;Mail the errors and successes back to the EPI group at Cincinnati.
"RTN","LREPISRV",25,0)
 K ^TMP($J,"LREPDATA")
"RTN","LREPISRV",26,0)
 K %,%DT,%H,D,DIC,X,XMDUN,XMDUZ,XMER,XMFROM,XMREC,XMRG,XMSUB,XMTEXT,XMY,XMZ,XQDATE,XQSUB,Y,LREPA,LREPB,LREPDA,LREPDA1,LREPDATA,LREPDFN,LREPDM,LREPDOC
"RTN","LREPISRV",27,0)
 K LREPDOM,LREPDTA,LREPED,LREPER,LREPLNT,LREPNM,LREPPT,LREPSD1,LREPSDT,LREPSSN,LREPST,LREPSUB,LREPTC,YSPR,LREPWB,LREPX,ZTQUEUED,ZTSK
"RTN","LREPISRV",28,0)
 K LRICD9,LRA,LRCOND,LRDATA,LRFILL,LRI,LRPATH,LRTEST
"RTN","LREPISRV",29,0)
 Q
"RTN","LREPISRV",30,0)
 ;F  X XMREC Q:XMER<0  S XMRG=$TR(XMRG,"- ","") D
"RTN","LREPISRV",31,0)
REPORT ;send report
"RTN","LREPISRV",32,0)
 S $P(LRFILL," ",256)=""
"RTN","LREPISRV",33,0)
 S LRA=0 F  S LRA=$O(^LAB(69.5,LRA)) Q:'LRA  D
"RTN","LREPISRV",34,0)
  . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*="
"RTN","LREPISRV",35,0)
  . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="Pathogen                       Ref# Cy LD Protocol FPTF Active"
"RTN","LREPISRV",36,0)
  . S LRPATH=$G(^LAB(69.5,LRA,0))
"RTN","LREPISRV",37,0)
  . I LRPATH="" S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="IEN # "_LRA_" damaged. (NULL)" Q
"RTN","LREPISRV",38,0)
  . I '$P(LRPATH,"^",7) S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="IEN # "_LRA_" damaged. (No Protocol)" Q
"RTN","LREPISRV",39,0)
  . S LRDATA=$P(LRPATH,"^")_$E(LRFILL,$L($P(LRPATH,"^")),30)_$J($P(LRPATH,"^",9),4)_$J($P(LRPATH,"^",5),3)_$J($P(LRPATH,"^",3),3)_$J($P(^ORD(101,$P(LRPATH,"^",7),0),"^"),9)_$J($P(LRPATH,"^",8),4)_$J($P(LRPATH,"^",2),4)
"RTN","LREPISRV",40,0)
  . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)=LRDATA
"RTN","LREPISRV",41,0)
  . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="   Lab Test                                          Indicator      Value"
"RTN","LREPISRV",42,0)
LTEST  . S LRI=0 F  S LRI=$O(^LAB(69.5,LRA,1,LRI)) Q:'LRI  D
"RTN","LREPISRV",43,0)
  . . S LRTEST=$G(^LAB(69.5,LRA,1,LRI,0))
"RTN","LREPISRV",44,0)
  . . I $P(LRTEST,"^")="" S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="IEN # "_LRA_" damaged. (No Test)" Q
"RTN","LREPISRV",45,0)
  . . S LRCOND=$P(LRTEST,"^",2),LRCOND=$S(LRCOND=1:"Ref. Range",LRCOND=2:"Contains",LRCOND=3:"Greater Than",LRCOND=4:"Less Than",LRCOND=5:"Equal To",1:"Unknown")
"RTN","LREPISRV",46,0)
  . . S LRDATA=$P($G(^LAB(60,$P(LRTEST,"^"),0),0),"^")_$E(LRFILL,$L($P($G(^LAB(60,$P(LRTEST,"^"),0),0),"^")),40)_$J(LRCOND,20)_$J($P(LRTEST,"^",3),10)
"RTN","LREPISRV",47,0)
  . . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)=LRDATA
"RTN","LREPISRV",48,0)
  . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="   Etiology"
"RTN","LREPISRV",49,0)
ETIO  . S LRI=0 F  S LRI=$O(^LAB(69.5,LRA,2,LRI)) Q:'LRI  D
"RTN","LREPISRV",50,0)
  . . S LRTEST=$G(^LAB(69.5,LRA,2,LRI,0))
"RTN","LREPISRV",51,0)
  . . I $P(LRTEST,"^")="" S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="IEN # "_LRA_" damaged. (No Etiology)" Q
"RTN","LREPISRV",52,0)
  . . S LRCOND=$P(LRTEST,"^",2),LRCOND=$S(LRCOND=1:"Ref. Range",LRCOND=2:"Contains",LRCOND=3:"Greater Than",LRCOND=4:"Less Than",LRCOND=5:"Equal To",1:"Unknown")
"RTN","LREPISRV",53,0)
  . . S LRDATA=$P($G(^LAB(61.2,$P(LRTEST,"^"),0),0),"^")
"RTN","LREPISRV",54,0)
  . . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)=LRDATA
"RTN","LREPISRV",55,0)
 .  S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="    ICD9"
"RTN","LREPISRV",56,0)
ICD9  . S LRI=0 F  S LRI=$O(^LAB(69.5,LRA,3,LRI)) Q:'LRI  D
"RTN","LREPISRV",57,0)
  . . S LRICD9=$G(^LAB(69.5,LRA,3,LRI,0))
"RTN","LREPISRV",58,0)
  . . I $P(LRICD9,"^")="" S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="IEN # "_LRA_" damaged. (No ICD9)" Q
"RTN","LREPISRV",59,0)
  . . S LRDATA=$P($G(^ICD9($P(LRICD9,"^"),0),0),"^")
"RTN","LREPISRV",60,0)
  . . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)=LRDATA
"RTN","LREPISRV",61,0)
  . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="      Microbial Susceptibility                      Indicator       Value"
"RTN","LREPISRV",62,0)
MICROB  . S LRI=0 F  S LRI=$O(^LAB(69.5,LRA,4,LRI)) Q:'LRI  D
"RTN","LREPISRV",63,0)
  . . S LRTEST=$G(^LAB(69.5,LRA,4,LRI,0))
"RTN","LREPISRV",64,0)
  . . I $P(LRTEST,"^")="" S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)="IEN # "_LRA_" damaged. (No Microbial Susceptibility)" Q
"RTN","LREPISRV",65,0)
  . . S LRCOND=$P(LRTEST,"^",2),LRCOND=$S(LRCOND=1:"Contains",LRCOND=2:"Greater Than",LRCOND=3:"Less Than",LRCOND=4:"Equal To",1:"Unknown")
"RTN","LREPISRV",66,0)
  . . S LRDATA="      "_$P($G(^LAB(62.06,$P(LRTEST,"^"),0),0),"^")_$E(LRFILL,$L($P($G(^LAB(62.06,$P(LRTEST,"^"),0),0),"^")),33)_$J(LRCOND,20)_$J($P(LRTEST,"^",3),11)
"RTN","LREPISRV",67,0)
  . . S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)=LRDATA
"RTN","LREPISRV",68,0)
 G EXIT
"RTN","LREPISRV",69,0)
OUT S LREPLNT=$G(LREPLNT)+1,^TMP($J,"LREPDATA",LREPLNT)=XMRG_LREPER_LREPST Q
"RTN","LREPISRV",70,0)
 ;Build the text for the return message here.
"RTN","LREPISRV",71,0)
ZEOR ;LREPISRV
"RTN","LREPISV1")
0^5^B9680185
"RTN","LREPISV1",1,0)
LREPISV1 ;DALOI/CKA LAB EPI EXTRACT SERVER ; 4/1/2003
"RTN","LREPISV1",2,0)
 ;;5.2;LAB SERVICE;**281**;Sep 27, 1994
"RTN","LREPISV1",3,0)
 ;
"RTN","LREPISV1",4,0)
 ; Reference to $$SITE^VASITE supported by IA #10112
"RTN","LREPISV1",5,0)
 ; Reference to ^%ZOSF supported by IA #10096
"RTN","LREPISV1",6,0)
START ;
"RTN","LREPISV1",7,0)
 K ^TMP($J,"LREPDATA")
"RTN","LREPISV1",8,0)
 ;Send message to the mail group each time the server is triggered
"RTN","LREPISV1",9,0)
 ;containing the name of the person who triggered the server, their
"RTN","LREPISV1",10,0)
 ;location, and the action initiated.
"RTN","LREPISV1",11,0)
 S LREPST=$P($$SITE^VASITE,"^",2),LRRTYPE=1
"RTN","LREPISV1",12,0)
 ;Determine station number
"RTN","LREPISV1",13,0)
 S X=XQSUB X ^%ZOSF("UPPERCASE") S LREPSUB=Y
"RTN","LREPISV1",14,0)
 S ^TMP($J,"LREPDATA",1)=LREPSUB_" triggered at "_LREPST_" by "_XMFROM_" on "_XQDATE
"RTN","LREPISV1",15,0)
 ;The first line of the message tells who requested the action and when
"RTN","LREPISV1",16,0)
 S ^TMP($J,"LREPDATA",2)=$S(LREPSUB["RETRANSMIT":" RETRANSMISSION of EPI data",1:"????")_" at "_LREPST
"RTN","LREPISV1",17,0)
 ;The second line tells when the server is activated and no data can be gathered from the MailMan message.
"RTN","LREPISV1",18,0)
 S LREPLNT=1
"RTN","LREPISV1",19,0)
 I LREPSUB'["RETRANSMIT" S ^TMP($J,"LREPDATA",3)="SUBJECT OF MAIL MESSAGE MUST BE RETRANSMIT" G EXIT
"RTN","LREPISV1",20,0)
RETRANS ;RETRANSMIT
"RTN","LREPISV1",21,0)
 ;first read the text of the message
"RTN","LREPISV1",22,0)
 S LRERROR=0
"RTN","LREPISV1",23,0)
READ F XMA=1:1  X XMREC Q:XMER<0  S XMTEXT=XMRG D
"RTN","LREPISV1",24,0)
 .;
"RTN","LREPISV1",25,0)
PROCESS .;
"RTN","LREPISV1",26,0)
 .I XMA=1,XMTEXT'="******password******" S ^TMP($J,"LREPDATA",3)="INVALID PASSWORD" S LRERROR=1 Q
"RTN","LREPISV1",27,0)
 .;
"RTN","LREPISV1",28,0)
 .S LRPROT=1696
"RTN","LREPISV1",29,0)
DATE .;
"RTN","LREPISV1",30,0)
 .I XMA=3 D
"RTN","LREPISV1",31,0)
 ..S X=XMTEXT,%DT="X" D ^%DT
"RTN","LREPISV1",32,0)
 ..I Y=-1 S ^TMP($J,"LREPDATA",3)="INVALID STOP DATE" S LRERROR=1 Q
"RTN","LREPISV1",33,0)
 ..S LRRPE=Y  ;Stop date
"RTN","LREPISV1",34,0)
 .I XMA=2 D
"RTN","LREPISV1",35,0)
 ..S X=XMTEXT,%DT="X" D ^%DT
"RTN","LREPISV1",36,0)
 ..I Y=-1 S ^TMP($J,"LREPDATA",3)="INVALID START DATE" S LRERROR=1 Q
"RTN","LREPISV1",37,0)
 ..S LRRPS=Y  ;Start date
"RTN","LREPISV1",38,0)
 .;
"RTN","LREPISV1",39,0)
TEST .;pathogens
"RTN","LREPISV1",40,0)
 .F LRI=4:1 Q:LRI'=XMA  D:XMTEXT="ALL"  Q:XMTEXT="ALL"  S LREPI(LRI)=XMTEXT  Q:'$D(XMTEXT)  S LREPI(XMTEXT)=""
"RTN","LREPISV1",41,0)
 ..S LRI=0 F  S LRI=$O(^LAB(69.5,LRI)) Q:'LRI!(LRI>99)  S LREPI(LRI)=""
"RTN","LREPISV1",42,0)
 .;
"RTN","LREPISV1",43,0)
 .;
"RTN","LREPISV1",44,0)
 I LRERROR G MAIL
"RTN","LREPISV1",45,0)
TASK ;
"RTN","LREPISV1",46,0)
 D NOW^%DTC
"RTN","LREPISV1",47,0)
 S ZTDTH=%
"RTN","LREPISV1",48,0)
 Q:'$D(LREPI)
"RTN","LREPISV1",49,0)
 K ZTSAVE
"RTN","LREPISV1",50,0)
 S ZTSAVE("LR*")=""
"RTN","LREPISV1",51,0)
 S ZTIO="",ZTRTN="EN^LREPI",ZTDESC="Laboratory Search/Extract"
"RTN","LREPISV1",52,0)
 D ^%ZTLOAD
"RTN","LREPISV1",53,0)
 I $D(ZTSK)[0 W !!?5,"Report canceled!"
"RTN","LREPISV1",54,0)
 ;
"RTN","LREPISV1",55,0)
 ;
"RTN","LREPISV1",56,0)
MAIL ;
"RTN","LREPISV1",57,0)
 ;
"RTN","LREPISV1",58,0)
 ;If the subject contains "RETRANSMIT" DATA EXTRACTION 
"RTN","LREPISV1",59,0)
EXIT ;If all went well, report that too.
"RTN","LREPISV1",60,0)
 S %H=$H D YMD^%DTC S XMDUN="EPI SYSTEM",XMDUZ=".5",XMSUB=LREPST_" EPI ("_X_%_")",XMTEXT="^TMP($J,""LREPDATA"","
"RTN","LREPISV1",61,0)
 S XMY("G.EPI-SITE@CINCINNATI.VA.GOV")=""
"RTN","LREPISV1",62,0)
 ;S XMY("ANZALDUA,CAROL@VAHVSS.FO-ALBANY.MED.VA.GOV")="" ;,XMY("CAROL.ANZALDUA@MED.VA.GOV")=""
"RTN","LREPISV1",63,0)
 D ^XMD
"RTN","LREPISV1",64,0)
 ;Mail the errors and successes back to the EPI group at Cincinnati.
"RTN","LREPISV1",65,0)
 K ^TMP($J,"LREPDATA")
"RTN","LREPISV1",66,0)
 K %,%DT,%H,D,DIC,X,XMDUN,XMDUZ,XMER,XMFROM,XMREC,XMRG,XMSUB,XMTEXT,XMY,XMZ,XQDATE,XQSUB,Y,LREPA,LREPB,LREPDA,LREPDA1,LREPDATA,LREPDFN,LREPDM,LREPDOC
"RTN","LREPISV1",67,0)
 K LREPDOM,LREPDTA,LREPED,LREPER,LREPLNT,LREPNM,LREPPT,LREPSD1,LREPSDT,LREPSSN,LREPST,LREPSUB,LREPTC,YSPR,LREPWB,LREPX,ZTQUEUED,ZTSK
"RTN","LREPISV1",68,0)
 K XMA,LRA,LRCOND,LRDATA,LRFILL,LRI,LRPATH,LRTEST,LRERROR
"RTN","LREPISV1",69,0)
 Q
"RTN","LREPISV1",70,0)
 ;
"VER")
8.0^22.0
"^DD",69.5,69.5,0)
FIELD^^19^22
"^DD",69.5,69.5,0,"DDA")
N
"^DD",69.5,69.5,0,"DT")
3040324
"^DD",69.5,69.5,0,"IX","B",69.5,.01)

"^DD",69.5,69.5,0,"IX","C",69.5,.05)

"^DD",69.5,69.5,0,"IX","D",69.5,.01)

"^DD",69.5,69.5,0,"NM","LAB SEARCH/EXTRACT")

"^DD",69.5,69.5,0,"VRPK")
LR
"^DD",69.5,69.5,.01,0)
NAME^RFX^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
"^DD",69.5,69.5,.01,1,0)
^.1
"^DD",69.5,69.5,.01,1,1,0)
69.5^B
"^DD",69.5,69.5,.01,1,1,1)
S ^LAB(69.5,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.5,.01,1,1,2)
K ^LAB(69.5,"B",$E(X,1,30),DA)
"^DD",69.5,69.5,.01,1,2,0)
69.5^D^MUMPS
"^DD",69.5,69.5,.01,1,2,1)
D UP^LRXREF S ^LAB(69.5,"D",X,DA)=""
"^DD",69.5,69.5,.01,1,2,2)
D UP^LRXREF K ^LAB(69.5,"D",X,DA)
"^DD",69.5,69.5,.01,1,2,"%D",0)
^^2^2^3040316^
"^DD",69.5,69.5,.01,1,2,"%D",1,0)
The name is converted to upper case and stored in the "D" x-ref for easier
"^DD",69.5,69.5,.01,1,2,"%D",2,0)
lookup.  ^LAB(69.5,"D",UPPERCASE NAME, IEN)
"^DD",69.5,69.5,.01,1,2,"DT")
3040316
"^DD",69.5,69.5,.01,3)
Enter a Name (3 to 30 characters) for the Search/Extract parameter you are defining.
"^DD",69.5,69.5,.01,21,0)
^.001^1^1^3040120^^^^
"^DD",69.5,69.5,.01,21,1,0)
This is the name of the Search/Extract parameter you are defining.
"^DD",69.5,69.5,.01,"DT")
3040316
"^DD",69.5,69.5,.05,0)
REFERENCE NUMBER^NJ3,0XI^^0;9^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N)!(X'>99)!$D(^LAB(69.5,"C",X)) X
"^DD",69.5,69.5,.05,1,0)
^.1
"^DD",69.5,69.5,.05,1,1,0)
69.5^C
"^DD",69.5,69.5,.05,1,1,1)
S ^LAB(69.5,"C",$E(X,1,30),DA)=""
"^DD",69.5,69.5,.05,1,1,2)
K ^LAB(69.5,"C",$E(X,1,30),DA)
"^DD",69.5,69.5,.05,1,1,"DT")
2961108
"^DD",69.5,69.5,.05,3)
Type a unique number between 100 and 999 to identify this entry. Numbers from 1 to 99 are reserved for future use.
"^DD",69.5,69.5,.05,21,0)
^^1^1^2980609^^^
"^DD",69.5,69.5,.05,21,1,0)
This is a unique number used to identify this entry.
"^DD",69.5,69.5,.05,"DT")
2961129
"^DD",69.5,69.5,1,0)
INACTIVE^S^1:YES;0:NO;^0;2^Q
"^DD",69.5,69.5,1,3)
'1' or 'YES' indicates that this is an inactive entry. '0' or 'NO' indicates that this is an active entry.
"^DD",69.5,69.5,1,21,0)
^.001^1^1^3030501^^^
"^DD",69.5,69.5,1,21,1,0)
This defines if this entry is active or not.
"^DD",69.5,69.5,1,"DT")
3020619
"^DD",69.5,69.5,2,0)
LAB TEST^69.52P^^1;0
"^DD",69.5,69.5,2,21,0)
^^1^1^2980609^
"^DD",69.5,69.5,2,21,1,0)
This is the test that is to be searched for and retrieved.
"^DD",69.5,69.5,3,0)
ETIOLOGY^69.53P^^2;0
"^DD",69.5,69.5,3,21,0)
^^1^1^2970212^
"^DD",69.5,69.5,3,21,1,0)
This defines the Etiology to search for.
"^DD",69.5,69.5,4,0)
ICD9^69.54P^^3;0
"^DD",69.5,69.5,4,21,0)
^^1^1^2980609^^
"^DD",69.5,69.5,4,21,1,0)
This defines the ICD9 to search for.
"^DD",69.5,69.5,5,0)
ANTIMICROBIAL SUSCEPTIBILITY^69.55P^^4;0
"^DD",69.5,69.5,5,21,0)
^.001^2^2^3040323^^
"^DD",69.5,69.5,5,21,1,0)
This determines that if any of the Etiologies selected are to be resistant
"^DD",69.5,69.5,5,21,2,0)
to any Antimicrobials.
"^DD",69.5,69.5,5,"DT")
2970122
"^DD",69.5,69.5,6,0)
INCLUDED SITES^69.56P^^5;0
"^DD",69.5,69.5,6,21,0)
^^1^1^2980609^^
"^DD",69.5,69.5,6,21,1,0)
This determines what Topography to screen for.
"^DD",69.5,69.5,6,"DT")
2961004
"^DD",69.5,69.5,7,0)
EXCLUDED SITES^69.57P^^6;0
"^DD",69.5,69.5,7,21,0)
^^1^1^2970212^
"^DD",69.5,69.5,7,21,1,0)
This determines what Topography to screen out.
"^DD",69.5,69.5,8,0)
SNOMED CODES^69.58^^9;0
"^DD",69.5,69.5,8,21,0)
^^1^1^2980609^^
"^DD",69.5,69.5,8,21,1,0)
This is a list of SNOMED codes to be included in the search.
"^DD",69.5,69.5,9,0)
RUN DATE^D^^0;4^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",69.5,69.5,9,.1)

"^DD",69.5,69.5,9,3)
Enter the date that the last Auto Search/Extract processed.
"^DD",69.5,69.5,9,21,0)
^^1^1^2980609^^
"^DD",69.5,69.5,9,21,1,0)
The date that the last Auto Search/Extract processed
"^DD",69.5,69.5,9,"DT")
2970206
"^DD",69.5,69.5,10,0)
CYCLE^S^M:MONTHLY;D:DAILY;^0;5^Q
"^DD",69.5,69.5,10,1,0)
^.1
"^DD",69.5,69.5,10,1,1,0)
^^TRIGGER^69.5^10.5
"^DD",69.5,69.5,10,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^LAB(69.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" X ^DD(69.5,10,1,1,1.4)
"^DD",69.5,69.5,10,1,1,1.4)
S DIH=$S($D(^LAB(69.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,3)=DIV,DIH=69.5,DIG=10.5 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",69.5,69.5,10,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^LAB(69.5,D0,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" X ^DD(69.5,10,1,1,2.4)
"^DD",69.5,69.5,10,1,1,2.4)
S DIH=$S($D(^LAB(69.5,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,3)=DIV,DIH=69.5,DIG=10.5 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",69.5,69.5,10,1,1,"CREATE VALUE")
""
"^DD",69.5,69.5,10,1,1,"DELETE VALUE")
""
"^DD",69.5,69.5,10,1,1,"FIELD")
LAG DAY
"^DD",69.5,69.5,10,3)
Select whether this parameter is to be used 'D'aily or 'M'onthly
"^DD",69.5,69.5,10,21,0)
^^2^2^2980609^^^^
"^DD",69.5,69.5,10,21,1,0)
This field defines how often the this entry is acted upon by the nightly task.
"^DD",69.5,69.5,10,21,2,0)

"^DD",69.5,69.5,10,"DT")
2971203
"^DD",69.5,69.5,10.5,0)
LAG DAYS^NJ2,0X^^0;3^S CYC=$P(^LAB(69.5,DA,0),U,5),MAX=$S(CYC="D":99,CYC="M":26,1:0) K:+X'=X!(X>MAX)!(X<1)!(X?.E1"."1N.N) X K MAX,CYC
"^DD",69.5,69.5,10.5,3)
Enter the numbers of lag days desired. The amount allowed will very depending on the cycle type.
"^DD",69.5,69.5,10.5,5,1,0)
69.5^10^1
"^DD",69.5,69.5,10.5,21,0)
^^2^2^2980609^
"^DD",69.5,69.5,10.5,21,1,0)
This is the number of days that the search should wait after the test was
"^DD",69.5,69.5,10.5,21,2,0)
ordered to ensure that the results have been entered in the system.
"^DD",69.5,69.5,10.5,"DT")
2970904
"^DD",69.5,69.5,11,0)
FIRST ENCOUNTER^S^1:YES;0:NO;^0;6^Q
"^DD",69.5,69.5,11,3)
Enter '1' to limit the output to the first encounter for the patient. '0' will list all encounters.
"^DD",69.5,69.5,11,21,0)
^^2^2^2980609^^^
"^DD",69.5,69.5,11,21,1,0)
This determines if after the first encounter is found and extracted should
"^DD",69.5,69.5,11,21,2,0)
sequential encounters be extracted.
"^DD",69.5,69.5,11,"DT")
2961230
"^DD",69.5,69.5,12,0)
PROTOCOL^P69.4I^LAB(69.4,^0;7^Q
"^DD",69.5,69.5,12,3)
Select the Protocol to be used to define the output messages.
"^DD",69.5,69.5,12,21,0)
^^2^2^2980609^^
"^DD",69.5,69.5,12,21,1,0)
This defines what protocol is associated with the parameters.
"^DD",69.5,69.5,12,21,2,0)

"^DD",69.5,69.5,12,"DT")
3031106
"^DD",69.5,69.5,13,0)
FOLLOW PTF^S^1:YES;0:NO;^0;8^Q
"^DD",69.5,69.5,13,3)
'YES' or '1' indicates that the PTF record will be followed until a discharge has been entered.  
"^DD",69.5,69.5,13,21,0)
^^2^2^2980609^
"^DD",69.5,69.5,13,21,1,0)
This determines whether the discharge information should be updated upon
"^DD",69.5,69.5,13,21,2,0)
discharge if a inpatient encounter does not have an existing discharge.
"^DD",69.5,69.5,13,"DT")
2961017
"^DD",69.5,69.5,14,0)
PTF^69.514PA^^7;0
"^DD",69.5,69.5,14,21,0)
^^1^1^2980609^
"^DD",69.5,69.5,14,21,1,0)
This is the PTF file enty to be followed.
"^DD",69.5,69.5,15,0)
Description^69.515^^8;0
"^DD",69.5,69.5,15,21,0)
^^1^1^2980609^^^^
"^DD",69.5,69.5,15,21,1,0)
This is the general description for the entry.
"^DD",69.5,69.5,16,0)
SEX^S^M:MALE;F:FEMALE;O:OTHER;^0;10^Q
"^DD",69.5,69.5,16,3)
Enter the sex code to be included in the search. Leave blank if all types are to be included.
"^DD",69.5,69.5,16,21,0)
^^2^2^2980708^^
"^DD",69.5,69.5,16,21,1,0)
This is the sex code to be included in the search.  All types will be
"^DD",69.5,69.5,16,21,2,0)
included if this field is left blank.
"^DD",69.5,69.5,16,"DT")
2971117
"^DD",69.5,69.5,17,0)
BEFORE DATE OF BIRTH^D^^0;11^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",69.5,69.5,17,3)
Enter a date to screen out patients born after the date entered.
"^DD",69.5,69.5,17,21,0)
^^1^1^2980609^
"^DD",69.5,69.5,17,21,1,0)
Patients born after the date entered will not be included in the report.
"^DD",69.5,69.5,17,"DT")
2971117
"^DD",69.5,69.5,18,0)
AFTER DATE OF BIRTH^D^^0;12^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",69.5,69.5,18,3)
A birthdate to screen patients. ie patients DOB after 1/1/1950.
"^DD",69.5,69.5,18,21,0)
^^1^1^2980609^
"^DD",69.5,69.5,18,21,1,0)
Persons born before the date entered will not be included in the report.
"^DD",69.5,69.5,18,"DT")
2971117
"^DD",69.5,69.5,19,0)
PREVIOUS CYCLE^NJ2,0I^^0;13^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1.N) X
"^DD",69.5,69.5,19,3)
Type a number between 1 and 99.
"^DD",69.5,69.5,19,21,0)
^.001^5^5^3030320^^
"^DD",69.5,69.5,19,21,1,0)
By entering a number here the Lab search engine knows to look at a 
"^DD",69.5,69.5,19,21,2,0)
previous cycle for updates to data. How far back it looks is based on the 
"^DD",69.5,69.5,19,21,3,0)
cycle and number entered. For example if the cycle is monthly and the 
"^DD",69.5,69.5,19,21,4,0)
previous cycle is 1 then the search engine will also search 1 month back
"^DD",69.5,69.5,19,21,5,0)
for data.
"^DD",69.5,69.5,19,"DT")
3030909
"^DD",69.5,69.514,0)
PTF SUB-FIELD^^1^2
"^DD",69.5,69.514,0,"DT")
2961231
"^DD",69.5,69.514,0,"IX","B",69.514,.01)

"^DD",69.5,69.514,0,"NM","PTF")

"^DD",69.5,69.514,0,"UP")
69.5
"^DD",69.5,69.514,.01,0)
PTF^P45'^DGPT(^0;1^Q
"^DD",69.5,69.514,.01,1,0)
^.1
"^DD",69.5,69.514,.01,1,1,0)
69.514^B
"^DD",69.5,69.514,.01,1,1,1)
S ^LAB(69.5,DA(1),7,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.514,.01,1,1,2)
K ^LAB(69.5,DA(1),7,"B",$E(X,1,30),DA)
"^DD",69.5,69.514,.01,3)
Enter the PTF file entry to be followed.
"^DD",69.5,69.514,.01,21,0)
^^1^1^2980609^
"^DD",69.5,69.514,.01,21,1,0)
This is the PTF file entry to be followed.
"^DD",69.5,69.514,.01,"DT")
2961017
"^DD",69.5,69.514,1,0)
DATE^D^^0;2^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",69.5,69.514,1,3)
Enter the date that the Inpatient discharge information was included in the report as an update.
"^DD",69.5,69.514,1,21,0)
^^2^2^2980609^^
"^DD",69.5,69.514,1,21,1,0)
This is the date that the Inpatient discharge information was included 
"^DD",69.5,69.514,1,21,2,0)
in the report as a update.
"^DD",69.5,69.514,1,"DT")
2961231
"^DD",69.5,69.515,0)
Description SUB-FIELD^^.01^1
"^DD",69.5,69.515,0,"DT")
2961202
"^DD",69.5,69.515,0,"NM","Description")

"^DD",69.5,69.515,0,"UP")
69.5
"^DD",69.5,69.515,.01,0)
Description^W^^0;1^Q
"^DD",69.5,69.515,.01,3)
Enter the general description for this entry.
"^DD",69.5,69.515,.01,21,0)
^^1^1^2980609^^
"^DD",69.5,69.515,.01,21,1,0)
This is the general description for this entry.
"^DD",69.5,69.515,.01,"DT")
2961202
"^DD",69.5,69.52,0)
LAB TEST SUB-FIELD^^2^3
"^DD",69.5,69.52,0,"DT")
2980205
"^DD",69.5,69.52,0,"IX","B",69.52,.01)

"^DD",69.5,69.52,0,"NM","LAB TEST")

"^DD",69.5,69.52,0,"UP")
69.5
"^DD",69.5,69.52,.01,0)
LAB TEST^M*P60'X^LAB(60,^0;1^S DIC("S")="I $P($G(^(0)),U,4)=""CH""!($P($G(^(0)),U,4)=""CY"")" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",69.5,69.52,.01,1,0)
^.1
"^DD",69.5,69.52,.01,1,1,0)
69.52^B
"^DD",69.5,69.52,.01,1,1,1)
S ^LAB(69.5,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.52,.01,1,1,2)
K ^LAB(69.5,DA(1),1,"B",$E(X,1,30),DA)
"^DD",69.5,69.52,.01,3)
Enter the lab test that is to be searched for and retrieved. Consider this synonymous with chemistry, serology, hematology "blood/serum" or Cytology tests.
"^DD",69.5,69.52,.01,12)
Only CH subscripts are selectable.
"^DD",69.5,69.52,.01,12.1)
S DIC("S")="I $P($G(^(0)),U,4)=""CH""!($P($G(^(0)),U,4)=""CY"")"
"^DD",69.5,69.52,.01,21,0)
^^1^1^2980609^^
"^DD",69.5,69.52,.01,21,1,0)
This is the lab test that is to be searched for and retrieved.
"^DD",69.5,69.52,.01,"DT")
2980204
"^DD",69.5,69.52,1,0)
INDICATOR^S^1:Use Reference Ranges;2:Contains;3:Greater Than;4:Less Than;5:Equal To;^0;2^Q
"^DD",69.5,69.52,1,3)
Select the code that will determine how to match lab results.
"^DD",69.5,69.52,1,21,0)
^^1^1^2970212^
"^DD",69.5,69.52,1,21,1,0)
This indicates if the search for the lab test is conditional.
"^DD",69.5,69.52,1,"DT")
2970205
"^DD",69.5,69.52,2,0)
INDICATED VALUE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",69.5,69.52,2,3)
Enter the data to be compared using the INDICATOR field.
"^DD",69.5,69.52,2,21,0)
^^1^1^2980609^^
"^DD",69.5,69.52,2,21,1,0)
If the search is conditional this defines the criteria. 
"^DD",69.5,69.52,2,"DT")
2980205
"^DD",69.5,69.53,0)
ETIOLOGY SUB-FIELD^^.01^1
"^DD",69.5,69.53,0,"DT")
2960829
"^DD",69.5,69.53,0,"IX","B",69.53,.01)

"^DD",69.5,69.53,0,"NM","ETIOLOGY")

"^DD",69.5,69.53,0,"UP")
69.5
"^DD",69.5,69.53,.01,0)
ETIOLOGY^MP61.2'^LAB(61.2,^0;1^Q
"^DD",69.5,69.53,.01,1,0)
^.1
"^DD",69.5,69.53,.01,1,1,0)
69.53^B
"^DD",69.5,69.53,.01,1,1,1)
S ^LAB(69.5,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.53,.01,1,1,2)
K ^LAB(69.5,DA(1),2,"B",$E(X,1,30),DA)
"^DD",69.5,69.53,.01,3)
Select the Etiology to search for.
"^DD",69.5,69.53,.01,21,0)
^^1^1^2970212^
"^DD",69.5,69.53,.01,21,1,0)
This defines the Etiology to search for. Select the appropriate Etiology.
"^DD",69.5,69.53,.01,"DT")
2960829
"^DD",69.5,69.54,0)
ICD9 SUB-FIELD^^.01^1
"^DD",69.5,69.54,0,"DT")
2960909
"^DD",69.5,69.54,0,"IX","B",69.54,.01)

"^DD",69.5,69.54,0,"NM","ICD9")

"^DD",69.5,69.54,0,"UP")
69.5
"^DD",69.5,69.54,.01,0)
ICD9^MP80'^ICD9(^0;1^Q
"^DD",69.5,69.54,.01,1,0)
^.1^^-1
"^DD",69.5,69.54,.01,1,1,0)
69.54^B
"^DD",69.5,69.54,.01,1,1,1)
S ^LAB(69.5,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.54,.01,1,1,2)
K ^LAB(69.5,DA(1),3,"B",$E(X,1,30),DA)
"^DD",69.5,69.54,.01,3)
Select the ICDM-9 standardized code, used nationwide in federal and non-federal /private health care facilities, to be included in the search.
"^DD",69.5,69.54,.01,21,0)
^^1^1^2980609^^
"^DD",69.5,69.54,.01,21,1,0)
This defines the ICD9 to search for.
"^DD",69.5,69.54,.01,"DT")
2961011
"^DD",69.5,69.55,0)
ANTIMICROBIAL SUSCEPTIBILITY SUB-FIELD^^2^3
"^DD",69.5,69.55,0,"DT")
3040324
"^DD",69.5,69.55,0,"IX","B",69.55,.01)

"^DD",69.5,69.55,0,"NM","ANTIMICROBIAL SUSCEPTIBILITY")

"^DD",69.5,69.55,0,"UP")
69.5
"^DD",69.5,69.55,.01,0)
ANTIMICROBIAL SUSCEPTIBILITY^MP62.06'^LAB(62.06,^0;1^Q
"^DD",69.5,69.55,.01,1,0)
^.1
"^DD",69.5,69.55,.01,1,1,0)
69.55^B
"^DD",69.5,69.55,.01,1,1,1)
S ^LAB(69.5,DA(1),4,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.55,.01,1,1,2)
K ^LAB(69.5,DA(1),4,"B",$E(X,1,30),DA)
"^DD",69.5,69.55,.01,3)
Enter the Antimicrobial that will be used in screening out sensitive Etiologies.
"^DD",69.5,69.55,.01,21,0)
^.001^4^4^3040323^^
"^DD",69.5,69.55,.01,21,1,0)
This determines that if any of the Etiologies selected are to be resistant
"^DD",69.5,69.55,.01,21,2,0)
to any Antimicrobials. Select the appropriate Antimicrobials to screen out the
"^DD",69.5,69.55,.01,21,3,0)
Etiologies.
"^DD",69.5,69.55,.01,21,4,0)

"^DD",69.5,69.55,.01,"DT")
2970122
"^DD",69.5,69.55,1,0)
INDICATOR^S^1:Use Reference Ranges;2:Contains;3:Greater Than;4:Less Than;5:Equal To;^0;2^Q
"^DD",69.5,69.55,1,3)
Select the code that will determine how to match lab results.
"^DD",69.5,69.55,1,21,0)
^^1^1^3040324^
"^DD",69.5,69.55,1,21,1,0)
This indicates if the search for the lab test is conditional.
"^DD",69.5,69.55,1,"DT")
3040324
"^DD",69.5,69.55,2,0)
INDICATED VALUE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",69.5,69.55,2,3)
Enter the data to be compared using the INDICATOR field.
"^DD",69.5,69.55,2,21,0)
^^1^1^3040324^
"^DD",69.5,69.55,2,21,1,0)
If the search is conditional this defines the criteria.
"^DD",69.5,69.55,2,"DT")
3040324
"^DD",69.5,69.56,0)
INCLUDED SITES SUB-FIELD^^.01^1
"^DD",69.5,69.56,0,"DT")
2961004
"^DD",69.5,69.56,0,"IX","B",69.56,.01)

"^DD",69.5,69.56,0,"NM","INCLUDED SITES")

"^DD",69.5,69.56,0,"UP")
69.5
"^DD",69.5,69.56,.01,0)
TOPOGRAPHY^MP61'^LAB(61,^0;1^Q
"^DD",69.5,69.56,.01,1,0)
^.1
"^DD",69.5,69.56,.01,1,1,0)
69.56^B
"^DD",69.5,69.56,.01,1,1,1)
S ^LAB(69.5,DA(1),5,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.56,.01,1,1,2)
K ^LAB(69.5,DA(1),5,"B",$E(X,1,30),DA)
"^DD",69.5,69.56,.01,3)
Selection of a Topography screens all others out except the ones selected. For "ALL" leave blank. Not to be used in conjunction with the exclude Topography selection.
"^DD",69.5,69.56,.01,21,0)
^^2^2^2970212^
"^DD",69.5,69.56,.01,21,1,0)
This determines what Topography to screen for. Select the appropriate 
"^DD",69.5,69.56,.01,21,2,0)
Topography to include in the extract. 
"^DD",69.5,69.56,.01,"DT")
2961004
"^DD",69.5,69.57,0)
EXCLUDED SITES SUB-FIELD^^.01^1
"^DD",69.5,69.57,0,"DT")
2961004
"^DD",69.5,69.57,0,"IX","B",69.57,.01)

"^DD",69.5,69.57,0,"NM","EXCLUDED SITES")

"^DD",69.5,69.57,0,"UP")
69.5
"^DD",69.5,69.57,.01,0)
TOPOGRAPHY^MP61'^LAB(61,^0;1^Q
"^DD",69.5,69.57,.01,1,0)
^.1
"^DD",69.5,69.57,.01,1,1,0)
69.57^B
"^DD",69.5,69.57,.01,1,1,1)
S ^LAB(69.5,DA(1),6,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.57,.01,1,1,2)
K ^LAB(69.5,DA(1),6,"B",$E(X,1,30),DA)
"^DD",69.5,69.57,.01,3)
Select the Topography to screen out. Not to be used in conjunction with the Include Topography selection.
"^DD",69.5,69.57,.01,21,0)
^^2^2^2970212^
"^DD",69.5,69.57,.01,21,1,0)
This determines what Topography to screen out. Select the appropriate 
"^DD",69.5,69.57,.01,21,2,0)
Topography to be excluded from the extract. 
"^DD",69.5,69.57,.01,"DT")
2961004
"^DD",69.5,69.58,0)
SNOMED CODES SUB-FIELD^^.01^1
"^DD",69.5,69.58,0,"DT")
2970820
"^DD",69.5,69.58,0,"IX","B",69.58,.01)

"^DD",69.5,69.58,0,"NM","SNOMED CODES")

"^DD",69.5,69.58,0,"UP")
69.5
"^DD",69.5,69.58,.01,0)
SNOMED CODES^MF^^0;1^K:$L(X)>15!($L(X)<1) X
"^DD",69.5,69.58,.01,1,0)
^.1
"^DD",69.5,69.58,.01,1,1,0)
69.58^B
"^DD",69.5,69.58,.01,1,1,1)
S ^LAB(69.5,DA(1),9,"B",$E(X,1,30),DA)=""
"^DD",69.5,69.58,.01,1,1,2)
K ^LAB(69.5,DA(1),9,"B",$E(X,1,30),DA)
"^DD",69.5,69.58,.01,3)
Enter any SNOMED codes to be included in the search. Enter one code per line.
"^DD",69.5,69.58,.01,21,0)
^^1^1^2980609^
"^DD",69.5,69.58,.01,21,1,0)
This is a list of SNOMED code to be included in the search.
"^DD",69.5,69.58,.01,"DT")
2970820
"^DIC",69.5,69.5,0)
LAB SEARCH/EXTRACT^69.5
"^DIC",69.5,69.5,0,"GL")
^LAB(69.5,
"^DIC",69.5,69.5,"%D",0)
^^4^4^2980115^^^^
"^DIC",69.5,69.5,"%D",1,0)
This file contains search criteria used by the Laboratory 
"^DIC",69.5,69.5,"%D",2,0)
Search/Extract software. This file should only be edited using  
"^DIC",69.5,69.5,"%D",3,0)
the Search/Extract Parameter Setup option [LREPI PARAMETER SETUP] provided with this software.
"^DIC",69.5,69.5,"%D",4,0)

"^DIC",69.5,"B","LAB SEARCH/EXTRACT",69.5)

**END**
**END**
