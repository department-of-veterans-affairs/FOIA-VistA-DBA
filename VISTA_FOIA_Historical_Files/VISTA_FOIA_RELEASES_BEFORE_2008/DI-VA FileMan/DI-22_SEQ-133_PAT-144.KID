Released DI*22*144 SEQ #133
Extracted from mail message
**KIDS**:DI*22.0*144^

**INSTALL NAME**
DI*22.0*144
"BLD",592,0)
DI*22.0*144^VA FILEMAN^0^3061205^y
"BLD",592,1,0)
^^2^2^3061107^
"BLD",592,1,1,0)
See patch DI*22*144 in the National Patch Module on FORUM for complete
"BLD",592,1,2,0)
information on this patch.
"BLD",592,4,0)
^9.64PA^^
"BLD",592,6.3)
5
"BLD",592,"KRN",0)
^9.67PA^8989.52^19
"BLD",592,"KRN",.4,0)
.4
"BLD",592,"KRN",.401,0)
.401
"BLD",592,"KRN",.402,0)
.402
"BLD",592,"KRN",.403,0)
.403
"BLD",592,"KRN",.5,0)
.5
"BLD",592,"KRN",.84,0)
.84
"BLD",592,"KRN",.84,"NM",0)
^9.68A^2^2
"BLD",592,"KRN",.84,"NM",1,0)
8004.1^^0
"BLD",592,"KRN",.84,"NM",2,0)
8004.2^^0
"BLD",592,"KRN",.84,"NM","B",8004.1,1)

"BLD",592,"KRN",.84,"NM","B",8004.2,2)

"BLD",592,"KRN",3.6,0)
3.6
"BLD",592,"KRN",3.8,0)
3.8
"BLD",592,"KRN",9.2,0)
9.2
"BLD",592,"KRN",9.8,0)
9.8
"BLD",592,"KRN",9.8,"NM",0)
^9.68A^13^13
"BLD",592,"KRN",9.8,"NM",1,0)
DICOMP0^^0^B15881964
"BLD",592,"KRN",9.8,"NM",2,0)
DICOMPV^^0^B15537137
"BLD",592,"KRN",9.8,"NM",3,0)
DIG^^0^B30125105
"BLD",592,"KRN",9.8,"NM",4,0)
DIH^^0^B7595077
"BLD",592,"KRN",9.8,"NM",5,0)
DINIT00G^^0^B75544162
"BLD",592,"KRN",9.8,"NM",6,0)
DIO0^^0^B16558960
"BLD",592,"KRN",9.8,"NM",7,0)
DIO1^^0^B11457291
"BLD",592,"KRN",9.8,"NM",8,0)
DIQQQ^^0^B7471721
"BLD",592,"KRN",9.8,"NM",9,0)
DIS^^0^B22841666
"BLD",592,"KRN",9.8,"NM",10,0)
DIS0^^0^B11743531
"BLD",592,"KRN",9.8,"NM",11,0)
DIS1^^0^B11677620
"BLD",592,"KRN",9.8,"NM",12,0)
DIS2^^0^B8667742
"BLD",592,"KRN",9.8,"NM",13,0)
DIWW^^0^B8555522
"BLD",592,"KRN",9.8,"NM","B","DICOMP0",1)

"BLD",592,"KRN",9.8,"NM","B","DICOMPV",2)

"BLD",592,"KRN",9.8,"NM","B","DIG",3)

"BLD",592,"KRN",9.8,"NM","B","DIH",4)

"BLD",592,"KRN",9.8,"NM","B","DINIT00G",5)

"BLD",592,"KRN",9.8,"NM","B","DIO0",6)

"BLD",592,"KRN",9.8,"NM","B","DIO1",7)

"BLD",592,"KRN",9.8,"NM","B","DIQQQ",8)

"BLD",592,"KRN",9.8,"NM","B","DIS",9)

"BLD",592,"KRN",9.8,"NM","B","DIS0",10)

"BLD",592,"KRN",9.8,"NM","B","DIS1",11)

"BLD",592,"KRN",9.8,"NM","B","DIS2",12)

"BLD",592,"KRN",9.8,"NM","B","DIWW",13)

"BLD",592,"KRN",19,0)
19
"BLD",592,"KRN",19.1,0)
19.1
"BLD",592,"KRN",101,0)
101
"BLD",592,"KRN",409.61,0)
409.61
"BLD",592,"KRN",771,0)
771
"BLD",592,"KRN",870,0)
870
"BLD",592,"KRN",8989.51,0)
8989.51
"BLD",592,"KRN",8989.52,0)
8989.52
"BLD",592,"KRN",8994,0)
8994
"BLD",592,"KRN","B",.4,.4)

"BLD",592,"KRN","B",.401,.401)

"BLD",592,"KRN","B",.402,.402)

"BLD",592,"KRN","B",.403,.403)

"BLD",592,"KRN","B",.5,.5)

"BLD",592,"KRN","B",.84,.84)

"BLD",592,"KRN","B",3.6,3.6)

"BLD",592,"KRN","B",3.8,3.8)

"BLD",592,"KRN","B",9.2,9.2)

"BLD",592,"KRN","B",9.8,9.8)

"BLD",592,"KRN","B",19,19)

"BLD",592,"KRN","B",19.1,19.1)

"BLD",592,"KRN","B",101,101)

"BLD",592,"KRN","B",409.61,409.61)

"BLD",592,"KRN","B",771,771)

"BLD",592,"KRN","B",870,870)

"BLD",592,"KRN","B",8989.51,8989.51)

"BLD",592,"KRN","B",8989.52,8989.52)

"BLD",592,"KRN","B",8994,8994)

"BLD",592,"QUES",0)
^9.62^^
"BLD",592,"REQB",0)
^9.611^7^7
"BLD",592,"REQB",1,0)
DI*22.0*2^2
"BLD",592,"REQB",2,0)
DI*22.0*6^2
"BLD",592,"REQB",3,0)
DI*22.0*61^2
"BLD",592,"REQB",4,0)
DI*22.0*97^2
"BLD",592,"REQB",5,0)
DI*22.0*113^2
"BLD",592,"REQB",6,0)
DI*22.0*114^2
"BLD",592,"REQB",7,0)
DI*22.0*138^2
"BLD",592,"REQB","B","DI*22.0*113",5)

"BLD",592,"REQB","B","DI*22.0*114",6)

"BLD",592,"REQB","B","DI*22.0*138",7)

"BLD",592,"REQB","B","DI*22.0*2",1)

"BLD",592,"REQB","B","DI*22.0*6",2)

"BLD",592,"REQB","B","DI*22.0*61",3)

"BLD",592,"REQB","B","DI*22.0*97",4)

"KRN",.84,8004.1,-1)
0^1
"KRN",.84,8004.1,0)
8004.1^3^^VA FILEMAN^HELP FOR ONE SEARCH CRITERION ('A')
"KRN",.84,8004.1,2,0)
^.844^3^3^3050131^^
"KRN",.84,8004.1,2,1,0)
To search on the condition you have just typed, hit 'Enter'.
"KRN",.84,8004.1,2,2,0)
To search for the NEGATIVE of the condition,
"KRN",.84,8004.1,2,3,0)
type "'A".  The "'" character means "negation".
"KRN",.84,8004.1,5,0)
^.841^1^1
"KRN",.84,8004.1,5,1,0)
DIS0^BAD+1
"KRN",.84,8004.1,5,"B","DIS0",1)

"KRN",.84,8004.2,-1)
0^2
"KRN",.84,8004.2,0)
8004.2^3^^VA FILEMAN^HELP AFTER 'IF: ' FOR MULTIPLE CONDITIONS
"KRN",.84,8004.2,2,0)
^^3^3^3050131^
"KRN",.84,8004.2,2,1,0)
To 'AND' Condition 'A' with Condition 'B', type 'A&B'.
"KRN",.84,8004.2,2,2,0)
To 'OR' Condition 'A' with Condition 'B', type 'A',
"KRN",.84,8004.2,2,3,0)
and then type 'B' at the next "OR:" prompt.
"KRN",.84,8004.2,5,0)
^.841^1^1
"KRN",.84,8004.2,5,1,0)
DIS0^BAD+1
"KRN",.84,8004.2,5,"B","DIS0",1)

"MBREQ")
0
"ORD",9,.84)
.84;9;;;EDEOUT^DIFROMSO(.84,DA,"",XPDA);FPRE^DIFROMSI(.84,"",XPDA);EPRE^DIFROMSI(.84,DA,"",XPDA,"",OLDA);;EPOST^DIFROMSI(.84,DA,"",XPDA);DEL^DIFROMSK(.84,"",%)
"ORD",9,.84,0)
DIALOG
"PKG",5,-1)
1^1
"PKG",5,0)
VA FILEMAN^DI^FM INIT
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
22.0^2990330^3051028^41
"PKG",5,22,1,"PAH",1,0)
144^3061205
"PKG",5,22,1,"PAH",1,1,0)
^^2^2^3061205
"PKG",5,22,1,"PAH",1,1,1,0)
See patch DI*22*144 in the National Patch Module on FORUM for complete
"PKG",5,22,1,"PAH",1,1,2,0)
information on this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
13
"RTN","DICOMP0")
0^1^B15881964^B14964350
"RTN","DICOMP0",1,0)
DICOMP0 ;SFISC/GFT-EVALUATE COMPUTED FLD EXPR ;2DEC2006
"RTN","DICOMP0",2,0)
 ;;22.0;VA FileMan;**6,76,114,144**;;Build 5
"RTN","DICOMP0",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICOMP0",4,0)
 N DICOMPI
"RTN","DICOMP0",5,0)
SETFUNC I DPS,$D(DPS(DPS,"SET")),'$D(W(DPS)) S T="""",D=$P(X,T)_$P(X,T,2) G BAD:$L(D)+2\5-1!(D'?.UN)!(D?1"D".E)!(DUZ(0)'="@") S X=T_D_T,DICOMPX(D)=D,Y=0 Q
"RTN","DICOMP0",6,0)
LIT I X?1"""".E1"""" S Y=0,%=$E(X,2,$L(X)-1) K:%[""" X "!(%[""" D @") Y S X=""""_$$CONVQQ^DILIBF(%)_"""" Q
"RTN","DICOMP0",7,0)
L S T=DLV,DICN=X
"RTN","DICOMP0",8,0)
TRY G M:'$D(J(T))!'$D(I(T)),M:+J(T)'=J(T),M:$D(^DD(J(T)))<9 S DIC="^DD("_J(T)_",",DG=$O(^DD(J(T),0,"NM",0))_" "
"RTN","DICOMP0",9,0)
 S DIC("S")=$S(W="["!($E(I,M,M+1)="'[")!$D(DICMX):"I ",1:"S %=$P(^(0),U,2) I '%,%'[""m"",")_"$$SCREEN^DICOMP0"
"RTN","DICOMP0",10,0)
 D DICS^DICOMPY:DUZ(0)'="@"
"RTN","DICOMP0",11,0)
R I X?1"#"1.NP S X=$E(X,2,99) D ^DIC G:Y>0 A:DLV,X S X="#"_X
"RTN","DICOMP0",12,0)
 D ^DIC G A:Y>0
"RTN","DICOMP0",13,0)
N I $P(X,DG)="",X=DICN S X=$P(X,DG,2,9) G R
"RTN","DICOMP0",14,0)
NUMBER I X="NUMBER" S Y=.001,Y(0)=0 G D
"RTN","DICOMP0",15,0)
 S T=T-1,X=DICN G M:T<0,TRY:$D(J(T)) F T=T-99:1 G TRY:'$D(J(T+1))
"RTN","DICOMP0",16,0)
 ;
"RTN","DICOMP0",17,0)
A F D=M:1:$L(I)+1 Q:$F(X,$E(I,1,D))-1-D  S W=$E(I,D+1)
"RTN","DICOMP0",18,0)
 I DICOMP["?",DICN'="#.01",$P(Y,U,2)'=DICN,DG_$P(Y,U,2)'=DICN D  G BAD:%<0,N:%-1
"RTN","DICOMP0",19,0)
 .W !?3,"By '"_DICN_"', do you mean "_DG_"'"_$P(Y,U,2)_"'" S %=1 D YN^DICN
"RTN","DICOMP0",20,0)
 E  S DICO("BACK",T)=+Y
"RTN","DICOMP0",21,0)
 S M=D
"RTN","DICOMP0",22,0)
X I $D(DICOMPX)#2 S %Y=J(T)_U_+Y_$E(";",1,$L(DICOMPX)) S:";"_DICOMPX_";"'[(";"_%Y) DICOMPX=%Y_DICOMPX
"RTN","DICOMP0",23,0)
D S D=$P(Y(0),"^",2),%=T\100*100,DICN=+Y,DICOMPI=W=")"&$D(DPS($$NEST^DICOMP,"INTERNAL")) D DATE:D["D"&'DICOMPI
"RTN","DICOMP0",24,0)
 I D["m"!D D MUL^DICOMPZ(D) Q
"RTN","DICOMP0",25,0)
 I $D(DICOMPX(1,J(T),+Y)) S X=DICOMPX(1,J(T),+Y) G O
"RTN","DICOMP0",26,0)
 I D["C" S:'$D(DG(%,T,+Y)) DG(%)=DG(%)+1,DG(%,T,+Y)=DG(%) S X=DQI_DG(%,T,+Y)_")" Q:D'["p"!DICOMPI  S DICN=+$P(D,"p",2),%Y=$G(^DIC(DICN,0,"GL")) Q:%Y=""  G POINT
"RTN","DICOMP0",27,0)
GET I DICOMP["G",T#100=0 S X="$$GET^DDSVAL("_J(T)_",D0,"_+Y_",,"""_$E("E",'DICOMPI)_""")" G O
"RTN","DICOMP0",28,0)
 D G^DICOMPY
"RTN","DICOMP0",29,0)
O Q:DICOMPI
"RTN","DICOMP0",30,0)
 S T=J(T)
"RTN","DICOMP0",31,0)
S ;
"RTN","DICOMP0",32,0)
 S %=DLV0,DG=W=":"&'$D(DPS(DPS,"$S"))
"RTN","DICOMP0",33,0)
 I D["O"&(D'["P"!'DG)!(D["V"&'$D(DPS(DPS,"FILE"))) D DIMP^DICOMPZ("N C S Y="_X_",C="""_D_""" D:$D(^DD("_T_","_DICN_",0)) Y^DIQ") S X=X_" S X=Y" Q
"RTN","DICOMP0",34,0)
SET I D["S" S DG(%)=DG(%)+1,DG(%,DG(%))="$C(59)_$P($G(^DD("_T_","_DICN_",0)),U,3)",X="$P($P("_DQI_DG(%)_"),$C(59)_"_X_"_"":"",2),$C(59))"
"RTN","DICOMP0",35,0)
 Q:D'["P"  S %Y=U_$P(Y(0),U,3),DICN=+$P(@(%Y_"0)"),U,2)
"RTN","DICOMP0",36,0)
POINT I W=":" G MR:'$$OKFILE^DICOMPX(DICN,DICOMP)
"RTN","DICOMP0",37,0)
 I W'=":" S D=$P($G(^DD(DICN,.01,0)),U,2) I D'["V",D'["S",D'["P" D DATE:D["D" S X="$P($G("_%Y_"+"_X_",0)),U)" Q
"RTN","DICOMP0",38,0)
P G P^DICOMPX
"RTN","DICOMP0",39,0)
 ;
"RTN","DICOMP0",40,0)
M S T=$F(X," IN ") I T S X=$E(X,1,T-5),W=":",M=T-4,I=X_W_$E(I,T,999),T=$F(I," FILE",M) S:T&$F(DPUNC,$E(I,T)) I=$E(I,1,T-6)_$E(I,T,999) G DICOMP0
"RTN","DICOMP0",41,0)
 G MR:$L(X)>30 S DICF=X,T=$O(^DD("FUNC","B",X,0))
"RTN","DICOMP0",42,0)
 G LITDATE:'$D(^DD("FUNC",+T,3)),LITDATE:^(3)
"RTN","DICOMP0",43,0)
 I $G(^(1))'="" D 2^DICOMP S Y(0)=0,K=K+1,K(K)=X D DATE:$G(^(2))?1"D".E,DPS^DICOMPW Q
"RTN","DICOMP0",44,0)
 G MR:X'?1"PRIOR"4.U S Y=X,X="$P($$LAST^DIAUTL("_J(DLV0)_",D0,""*""),U)" I Y["USER",$D(^VA(200)) S $E(X,$L(X))=",2)",DICN=200,%Y="^VA(200," G POINT
"RTN","DICOMP0",45,0)
 G DATE
"RTN","DICOMP0",46,0)
 ;
"RTN","DICOMP0",47,0)
LITDATE S %DT="T" I $L(X)>2 D ^%DT I Y>0 S X=Y,Y(0)=0 D DATE Q  ;may be a literal date
"RTN","DICOMP0",48,0)
BACKPNT S T=$O(^DIC("B",X)) I T]"",$P(T,X)=""!$D(^(X)),$D(J(0)) S T=DLV0 D ^DICOMPV I D>0 Q  ;try backwards-pointer  TOOK OFF CHECK FOR DICOMPW VARIABLE 3/28/2000
"RTN","DICOMP0",49,0)
MR I M'>$L(I),+X'=X D MR^DICOMP G L:X]""
"RTN","DICOMP0",50,0)
BAD K Y Q
"RTN","DICOMP0",51,0)
 ;
"RTN","DICOMP0",52,0)
DATE ;
"RTN","DICOMP0",53,0)
 S DATE(K+1)=1 Q
"RTN","DICOMP0",54,0)
 ;
"RTN","DICOMP0",55,0)
SCREEN() ;Screen out certain fields as we process an atom
"RTN","DICOMP0",56,0)
 I $D(DICO("BACK"))=11,$G(DICO("BACK",T))=Y Q 0
"RTN","DICOMP0",57,0)
 I Y=DA,DICO(1)=T Q 0 ;Computed field cannot refer to itself!
"RTN","DICOMP0",58,0)
 I $P(^(0),U,2) Q '$G(DBOOL) ;A multiple cannot be manipulated as a Boolean!
"RTN","DICOMP0",59,0)
 I $P(^(0),U,2)'["P" Q 1
"RTN","DICOMP0",60,0)
 N P S P=$P(^(0),U,3) I P]"",$D(@(U_P_"0)")) Q 1 ;Only allow a pointer that points to an existing file!
"RTN","DICOMP0",61,0)
 Q 0
"RTN","DICOMPV")
0^2^B15537137^B14788727
"RTN","DICOMPV",1,0)
DICOMPV ;SFISC/GFT  BACKWARD-POINTERS IN COMPUTED FIELDS ;29JAN2005
"RTN","DICOMPV",2,0)
 ;;22.0;VA FileMan;**1,6,76,114,144**;Mar 30, 1999;Build 5
"RTN","DICOMPV",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICOMPV",4,0)
 N DIX,DICOTRY,DICOLEV
"RTN","DICOMPV",5,0)
 D DRW^DICOMPX
"RTN","DICOMPV",6,0)
TRY F DICOTRY=1,2 S Y=$$BACK I Y[U Q:Y=U  D:$G(D)-.001 Y^DICOMPX G END
"RTN","DICOMPV",7,0)
 S D=0 ;'D' is a flag to the calling routine, DICOMP0, saying we've found nothing here in DICOMPV
"RTN","DICOMPV",8,0)
END Q
"RTN","DICOMPV",9,0)
 ;
"RTN","DICOMPV",10,0)
BACK() N DICOB,DICODD
"RTN","DICOMPV",11,0)
 S DICOB=DLV0,DICODD=0
"RTN","DICOMPV",12,0)
DD S DICODD=$O(^DD(J(DICOB),0,"PT",DICODD)) I DICODD'>0 S DICOB=DICOB-100,DICODD=0 G DD:DICOB'<0 Q ""
"RTN","DICOMPV",13,0)
ARCH S Y=DICODD I DICOMP["W",$P($G(^DD(Y,0,"DI")),U,2)["Y" G DD ;No editing RESTRICTED or ARCHIVE file!
"RTN","DICOMPV",14,0)
 F DICOLEV=0:-1 G DD:'$D(^DD(Y,0)) Q:'$D(^(0,"UP"))  S Y=^("UP")
"RTN","DICOMPV",15,0)
 I $D(^DIC(Y,0)),$P(^(0),X)="" X DIC("S") I $T,$D(^DIC(Y,0,"GL")) S V=^("GL"),D=0 F  S D=$O(^DD(J(DICOB),0,"PT",DICODD,D)) Q:'D  D  G Y:Y[U
"RTN","DICOMPV",16,0)
DINUM .I DICODD=Y,D=.01&(DICOTRY=1)&($P($G(^DD(Y,.01,0)),U,5,99)["DINUM=X")!(D=.001&(DICOTRY=2)) D YN("") I %=1 S %Y=V,X="D0" S:$D(DIFG) DIFG=1 D X(Y,D),P^DICOMPX S D=.001,Y=Y_U Q
"RTN","DICOMPV",17,0)
 .Q:'$D(DICMX)  ;Stop if expression can't be multiple-valued
"RTN","DICOMPV",18,0)
 .N DICOUT F DIX=0:0 S DIX=$O(^DD(DICODD,D,1,DIX)) Q:DIX'>0  S J=$G(^(DIX,0)) I +J=Y S %=$P(J,U,3,9) I $S(DICOTRY=1:%="",1:%]""&("MUMPS"[%)) D  G:$G(DICOUT) Q
"RTN","DICOMPV",19,0)
 ..D YN("Cross-reference") I %<1 S Y=U,DICOUT=1 Q
"RTN","DICOMPV",20,0)
 ..I %=1 D MP S DICOUT=1
"RTN","DICOMPV",21,0)
 .Q:DICOTRY=1
"RTN","DICOMPV",22,0)
INDEXES .F DIX=0:0 S DIX=$O(^DD("IX","F",DICODD,D,DIX)) Q:'DIX  I $P($G(^DD("IX",DIX,0)),U,4)="R",$P(^(0),U,9)=DICODD S J=$P(^(0),U,1,3) I +J=Y,$P($G(^(11.1,1,0)),U,2,4)=("F^"_DICODD_U_D) D YN("Index") G Q:%<1 I %=1 D MP G Q
"RTN","DICOMPV",23,0)
Q .Q
"RTN","DICOMPV",24,0)
 G DD
"RTN","DICOMPV",25,0)
 ;
"RTN","DICOMPV",26,0)
Y Q Y
"RTN","DICOMPV",27,0)
 ;
"RTN","DICOMPV",28,0)
 ;
"RTN","DICOMPV",29,0)
MP S DICN=$S(DA:DQI_(80+DICOB),1:"I("_DICOB_",0")_")",J=""""_$P(J,U,2)_"""",T=D S:$D(DIFG) DIFG=$P(J,"""",2)
"RTN","DICOMPV",30,0)
 I DICOMP'["W" D  G POP:$D(Y) S (Y,D)=0 Q
"RTN","DICOMPV",31,0)
 .N DICOMPIX S DICOMPIX=J
"RTN","DICOMPV",32,0)
 .S D=Y,I(DLV0+100)=V,J(DLV+100)=D
"RTN","DICOMPV",33,0)
RCR .D BACKPNT^DICOMPZ Q:'$D(Y)
"RTN","DICOMPV",34,0)
 .S Y=D,X=$P(^DD(D,.01,0),U,2) D X^DICOMPZ
"RTN","DICOMPV",35,0)
 .S D="S (D,D0)=$QS(DIMQ,$QL(DIMQ)" I DICOLEV S D=D_DICOLEV
"RTN","DICOMPV",36,0)
 .D DIMP^DICOMPZ(D_") I D,$D("_V_"D,0)) "_X_" "_DICMX)
"RTN","DICOMPV",37,0)
 .D DIMP^DICOMPZ("N DIMQ,DIMSTRT,DIMSCNT S (DIMQ,DIMSTRT)=$NA("_V_DICOMPIX_","_DICN_")),DIMSCNT=$QL(DIMQ) F  S DIMQ=$Q(@DIMQ) Q:DIMQ=""""  Q:$NA(@DIMQ,DIMSCNT)'=DIMSTRT  "_X_" Q:'$D(D)  S D=D0")
"RTN","DICOMPV",38,0)
 .S X=X_" S X="""""
"RTN","DICOMPV",39,0)
ASK D ASKE^DICOMPW I 'D,T-.01&'DS!(DICODD-Y) S D=0
"RTN","DICOMPV",40,0)
 E  S DZ=0 D ASK^DICOMPW:'D I D<0 K T Q
"RTN","DICOMPV",41,0)
 S %=D,D="N DIADD,DIC S DIC="_Y_$S(%=2:",DIADD=1",1:"")_",DIC(0)="""_$P("EQ",U,DS)_$E("L",D>0)_$E("W",$D(DICO(3)))
"RTN","DICOMPV",42,0)
CROSS I T-.01 S D=D_$P("AM",U,DS)_""",DIC(""S"")=""I $D("_V_""""_J_""","""_"_"_DICN_"_"_""",Y))"" D ^DIC S D0=+Y,DIC("_T_")="_DICN_",DIH="_Y_" D DICL^DICR:$P(Y,U,3)"
"RTN","DICOMPV",43,0)
 E  S D=D_"U"",X="_DICN_" D ^DIC S D0=+Y"
"RTN","DICOMPV",44,0)
DIM D DIMP^DICOMPZ(D) I '% S %=":$O(^(D0))>0",X=" S D0=$O("_V_J_","_DICN_",0))"_$S(DS:X_%,1:" S"_%_" D0=0")
"RTN","DICOMPV",45,0)
 S X=X_" S X=$S(D0>0:D0,1:"""")" S:$D(DICOMPX(0)) X=X_","_DICOMPX(0)_"0)=X"
"RTN","DICOMPV",46,0)
POP S Y=Y_U,D=1,DICO("PT")=+Y
"RTN","DICOMPV",47,0)
 D X(+Y,.01) Q
"RTN","DICOMPV",48,0)
 ;
"RTN","DICOMPV",49,0)
X(Y,D) S DICN=Y ;Remember that we have used this field
"RTN","DICOMPV",50,0)
 I $D(DICOMPX)#2 S DICOMPX=Y_U_D_$E(";",1,$L(DICOMPX))_DICOMPX
"RTN","DICOMPV",51,0)
 Q
"RTN","DICOMPV",52,0)
 ;
"RTN","DICOMPV",53,0)
YN(SHOW) N X
"RTN","DICOMPV",54,0)
 S X=$P(^DIC(Y,0),U)
"RTN","DICOMPV",55,0)
 S %=1 I DICOMP["?" D
"RTN","DICOMPV",56,0)
 .W !?3,"By '"_DICN_"', do you mean the "_X_" File,"
"RTN","DICOMPV",57,0)
 .W !?7,"pointing via its '"_$P(^DD(DICODD,D,0),U),"' Field" S DICV=$P(^(0),U,2)
"RTN","DICOMPV",58,0)
 .I SHOW]"" W !,"    (""",$P(J,U,2),""" ",SHOW,")"
"RTN","DICOMPV",59,0)
 .D YN^DICN
"RTN","DICOMPV",60,0)
 I %=1 F M=M:1:$L(I)+1 Q:$F(X,$E(I,1,M))-1-M  S W=$E(I,M+1)
"RTN","DICOMPV",61,0)
 Q
"RTN","DIG")
0^3^B30125105^B29732249
"RTN","DIG",1,0)
DIG ;SFISC/GFT-SUBTOTALS & SCATTERGRAM ;28SEP2004
"RTN","DIG",2,0)
 ;;22.0;VA FileMan;**2,144**;Mar 30, 1999;Build 5
"RTN","DIG",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIG",4,0)
 W ! I '$D(^DOSV(0,IO(0),2)) W "NO SUB-SUB TOTALS WERE RUN" Q
"RTN","DIG",5,0)
 N POP,IOP,ZTSK S:$D(^%ZTSK) %ZIS="QM" D ^%ZIS Q:POP
"RTN","DIG",6,0)
 G QUE:$D(IO("Q"))
"RTN","DIG",7,0)
 ;
"RTN","DIG",8,0)
DQ N DXMIN,DYMIN,DXMAX,DYMAX,DXI,N,NA,DYI
"RTN","DIG",9,0)
 S NA=$NA(^DOSV(0,IO(0)))
"RTN","DIG",10,0)
 S X=$O(@NA@(2,"")),(DXMIN,DXMAX)=X,(DYMIN,DYMAX)=$O(^(X,"")),X=""
"RTN","DIG",11,0)
 F  S X=$O(@NA@(2,X)) Q:X=""  S DXMAX=X,Y=$O(^(X,"")),DY=$O(^(""),-1) S:DYMIN>Y DYMIN=Y S:DY>DYMAX DYMAX=DY
"RTN","DIG",12,0)
 I DXMAX-DXMIN*(DYMAX-DYMIN)=0 D STATS(NA) Q
"RTN","DIG",13,0)
 ;
"RTN","DIG",14,0)
 ;here's the SCATTERGRAM
"RTN","DIG",15,0)
NUMNUM N DIGPG,DIGTYPE,%H,%T,%Y,%D,B,I,L,H,T,DIGC,X,Y,DX,DY,DXS,DYS,DXSC,DYSC
"RTN","DIG",16,0)
 D DIGC
"RTN","DIG",17,0)
 S H=DYMAX,L=DYMIN,DYS=IOSL-9,N=DYS/6
"RTN","DIG",18,0)
 D S(1)
"RTN","DIG",19,0)
 S DYMIN=B,DYSC=I/6,DYMAX=T,DYI=X
"RTN","DIG",20,0)
DYI I T-B/DYI*6'>DYS,DYI'<2 S DYI=DYI\2 G DYI
"RTN","DIG",21,0)
 S H=DXMAX,L=DXMIN,DXS=IOM-28,N=DXS/6
"RTN","DIG",22,0)
 D S(2)
"RTN","DIG",23,0)
 S DXMIN=B,DXSC=I/6,DXI=X,DXMAX=T,T=X*DXS/(T-B)
"RTN","DIG",24,0)
 S H=""
"RTN","DIG",25,0)
LOOP K ^UTILITY($J)
"RTN","DIG",26,0)
 S DIGTYPE="N",H=$O(@NA@("F",H)) G END:'H
"RTN","DIG",27,0)
 D TOP
"RTN","DIG",28,0)
 S (B,DX,DY)="" D  G LOOP:X'=U
"RTN","DIG",29,0)
I2 .S (DX,X)=$O(@NA@(2,DX)) I X="" W !?5,"(TOTAL = "_B_")",! G O
"RTN","DIG",30,0)
 .I DIGC(2,0)["D" D H^%DTC S X=%H
"RTN","DIG",31,0)
 .S X=$J(X-DXMIN/DXSC,0,0)
"RTN","DIG",32,0)
I3 .S (Y,DY)=$O(@NA@(2,DX,DY)) G I2:Y="" I DIGC(1,0)["D" S C=X,X=Y D H^%DTC S Y=%H,X=C
"RTN","DIG",33,0)
 .I $D(^(DY,H,"N")) S C=^("N"),Y=$J(Y-DYMIN/DYSC,0,0),B=B+C,^(X)=C+$G(^UTILITY($J,Y,X))
"RTN","DIG",34,0)
 .G I3
"RTN","DIG",35,0)
O .S X=0 D X W !?12,"." D P K Y S L=0 F B=DYMIN:DYI:DYMAX S Y($J(L,0,0))=$$E(B,1),L=DYI*DYS/(DYMAX-DYMIN)+L
"RTN","DIG",36,0)
 .W ".",! F Y=DYS:-1:0 D  W !
"RTN","DIG",37,0)
 ..I $D(Y(Y)) W ?12-$L(Y(Y)),Y(Y),"+"
"RTN","DIG",38,0)
 ..E  W ?12,"|"
"RTN","DIG",39,0)
 ..S X="" F  S X=$O(^UTILITY($J,Y,X)) Q:X=""  S I=^(X) W ?X+13,$S(I>9:"*",I:I,1:"")
"RTN","DIG",40,0)
 ..W ?DXS+14 I  W "+",Y(Y) Q
"RTN","DIG",41,0)
 ..W "|"
"RTN","DIG",42,0)
 .W ?13 D P W ! S X=DXI D X W !?22,"X-AXIS: ",$P(DIGC(2),U,3),"    Y-AXIS: ",$P(DIGC(1),U,3)
"RTN","DIG",43,0)
 .G EOP
"RTN","DIG",44,0)
END W:$E(IOST)'="C"&$Y @IOF
"RTN","DIG",45,0)
 K:$D(ZTSK) ^DOSV(0,IO(0))
"RTN","DIG",46,0)
Q D CLOSE^DIO4
"RTN","DIG",47,0)
 Q
"RTN","DIG",48,0)
 ;
"RTN","DIG",49,0)
X F B=DXMIN+X:DXI*2:DXMAX S Y=$$E(B,2) W ?B-DXMIN\DXSC-($L(Y)\2)+13,Y
"RTN","DIG",50,0)
 Q
"RTN","DIG",51,0)
 ;
"RTN","DIG",52,0)
S(C) I DIGC(C,0)["D" F B="H","L" S X=@B D H^%DTC S @B=%H
"RTN","DIG",53,0)
 S B=H-L,X=1 I B>1 F C=1:1 S X=X*10 Q:B'>X
"RTN","DIG",54,0)
 E  S I=1 Q:'B  F C=0:-1 Q:X/10'>B  S X=X/10
"RTN","DIG",55,0)
 S B=L-X\X*X F I=B:X/10 Q:I'<L  S B=I
"RTN","DIG",56,0)
 S T=H+X\X*X F I=T:-X/10 Q:I'>H  S T=I
"RTN","DIG",57,0)
I S I=T-B/X*10 I I>N S X=X*2 G I
"RTN","DIG",58,0)
 S X=X/10,I=T-B/N
"RTN","DIG",59,0)
 Q
"RTN","DIG",60,0)
 ;
"RTN","DIG",61,0)
 ;
"RTN","DIG",62,0)
 ;
"RTN","DIG",63,0)
STATS(NA) ;
"RTN","DIG",64,0)
 N DIGC,DIGB,DIGPG,RUN,DIGTYPE,DIG3,I,L,%T,H,DUOUT
"RTN","DIG",65,0)
 D DIGC S DIGPG=1
"RTN","DIG",66,0)
 I $D(@NA@(1)) D  G Q:$D(DUOUT),END
"RTN","DIG",67,0)
 .F H=0:0 S H=$O(@NA@("F",H)),DIGTYPE="S" Q:'H  D:$P(^(H),U,4)'["D"  S DIGTYPE="N" D  Q:$D(DUOUT)
"RTN","DIG",68,0)
 ..S Y="",L=0 F I=0:0 S Y=$O(@NA@(1,Y)) Q:Y=""  I $D(^(Y,H,DIGTYPE)) S:$L(^(DIGTYPE))>L L=$L(^(DIGTYPE)) S:$L($$E(Y,1))>I I=$L($$E(Y,1))
"RTN","DIG",69,0)
 ..I 'I!'L Q
"RTN","DIG",70,0)
 ..D TOP W !!?4,$P(DIGC(1),U,3),!
"RTN","DIG",71,0)
 ..S Y="",%T=0
"RTN","DIG",72,0)
 ..F  S Y=$O(@NA@(1,Y)) Q:Y=""  I $D(^(Y,H,DIGTYPE)) D  Q:$D(DUOUT)
"RTN","DIG",73,0)
 ...I $Y+2>IOSL D EOP Q:$D(DUOUT)  D TOP
"RTN","DIG",74,0)
 ...W !?4,$$E(Y,1),?I+7 S X=@NA@(1,Y,H,DIGTYPE) W $J(X,L) S %T=%T+X
"RTN","DIG",75,0)
 ..W !!?4,"TOTAL",?I+7,$J(%T,L) D EOP
"RTN","DIG",76,0)
 S DIGB=$NA(@NA@(2)) I $D(@DIGB)>9 D ALL2 G END
"RTN","DIG",77,0)
 S DIG3="" F  S DIG3=$O(@NA@(3,DIG3)) G END:DIG3=""!$D(DUOUT) S DIGB=$NA(@NA@(3,DIG3)) D ALL2
"RTN","DIG",78,0)
 ;
"RTN","DIG",79,0)
ALL2 F RUN=0:0 S RUN=$O(@NA@("F",RUN)) Q:'RUN  F DIGTYPE="S","N" I $P(@NA@("F",RUN),U,4)'["D"!(DIGTYPE="N") D RUN(RUN,DIGTYPE)
"RTN","DIG",80,0)
 Q
"RTN","DIG",81,0)
 ;
"RTN","DIG",82,0)
RUN(H,DIGTYPE) N %H,%Y,%D,T,C,X,Y,DX,DY,DXS,DYS,DXSC,DYSC
"RTN","DIG",83,0)
 S Y="",I=0,C=0,L=0
"RTN","DIG",84,0)
 F  S Y=$O(@DIGB@(Y)),X="" Q:Y=""  S DY=$$E(Y,2) S:$L(DY)>I I=$L(DY) D
"RTN","DIG",85,0)
 .F  S X=$O(@DIGB@(Y,X)) Q:X=""  I $D(^(X,H,DIGTYPE)) S:'$D(X(X)) C=C+1 S DX=$$E(X,1) S:$L(DX)>L L=$L(DX) S X(X)=""
"RTN","DIG",86,0)
 ;I=width of left column
"RTN","DIG",87,0)
 ;L=width of data columns
"RTN","DIG",88,0)
 ;C=number of data columns
"RTN","DIG",89,0)
 I 'C Q
"RTN","DIG",90,0)
 S Y=L+2*C+I+13
"RTN","DIG",91,0)
 I Y>IOM U IO(0) W !,"MARGIN WIDTH OF ",IOM," IS TOO SMALL FOR DISPLAY",!,"USE WIDTH OF AT LEAST ",Y Q
"RTN","DIG",92,0)
 S I=I+3,L=IOM-13-I\C ;make columns wide
"RTN","DIG",93,0)
 D TOP,SUBTOP
"RTN","DIG",94,0)
 S Y=""
"RTN","DIG",95,0)
 F  S Y=$O(@DIGB@(Y)) Q:Y=""  D  G Q:$D(DUOUT)
"RTN","DIG",96,0)
 .I $Y+2>IOSL D  Q:$D(DUOUT)  D TOP,SUBTOP
"RTN","DIG",97,0)
 ..N X D EOP
"RTN","DIG",98,0)
 .N T S X="" W !!?4,$$E(Y,2),?I+6
"RTN","DIG",99,0)
 .F N=0:1 S X=$O(X(X)) Q:X=""  S %T=$G(@DIGB@(Y,X,H,DIGTYPE)) W $J(+%T,L) S T=$G(T)+%T,DX(X)=$G(DX(X))+%T
"RTN","DIG",100,0)
 .W $J(T,7)
"RTN","DIG",101,0)
 S X="  ----------------------------------------------------"
"RTN","DIG",102,0)
 W !!?I+6 F N=1:1:N W $E(X,1,L)
"RTN","DIG",103,0)
 W $E(X,1,IOM-$X)
"RTN","DIG",104,0)
 W !!,"    TOTALS",?I+6 S (%T,X)="" F N=0:1 S X=$O(X(X)) Q:X=""  W $J(DX(X),L) S %T=%T+DX(X)
"RTN","DIG",105,0)
 W $J(%T,7)
"RTN","DIG",106,0)
EOP ;
"RTN","DIG",107,0)
 I $G(IOST)?1"C".E D
"RTN","DIG",108,0)
 .N DIR,X,Y
"RTN","DIG",109,0)
 .S DIR(0)="E" D ^DIR
"RTN","DIG",110,0)
 Q
"RTN","DIG",111,0)
 ;
"RTN","DIG",112,0)
TOP N X,Y
"RTN","DIG",113,0)
 U IO W:$Y @IOF
"RTN","DIG",114,0)
 S X=@NA@("F",H)
"RTN","DIG",115,0)
 W !,"    ",$O(^DD(+X,0,"NM",0))," FILE: "
"RTN","DIG",116,0)
 W $S(DIGTYPE="N":"COUNTS",1:"SUMS")
"RTN","DIG",117,0)
 I $P(X,U,2)'=.01 W " OF '",$P(X,U,3),"'"
"RTN","DIG",118,0)
 S Y=DT X ^DD("DD")
"RTN","DIG",119,0)
 I $G(DIGPG) S Y=Y_"    Page "_DIGPG,DIGPG=DIGPG+1
"RTN","DIG",120,0)
 W ?IOM-$L(Y)-1,Y Q
"RTN","DIG",121,0)
 ;
"RTN","DIG",122,0)
SUBTOP N Y
"RTN","DIG",123,0)
 I $D(DIG3) W !!?4,$P(DIGC(3),U,3),": ",$$E(DIG3,3),!
"RTN","DIG",124,0)
 S Y=$P(DIGC(2),U,3) F X=1:1:$L(Y," ") W !?4,$P(Y," ",X)
"RTN","DIG",125,0)
 S Y=$P(DIGC(1),U,3) W ?(IOM-I-$L(Y)\2+I+4),Y,!!
"RTN","DIG",126,0)
 W ?I+6 S X="" F  S X=$O(X(X)) Q:X=""  W $J($$E(X,1),L)
"RTN","DIG",127,0)
 W "  TOTAL"
"RTN","DIG",128,0)
 W ! F Y=1:1:IOM W "-"
"RTN","DIG",129,0)
 Q
"RTN","DIG",130,0)
 ;
"RTN","DIG",131,0)
DIGC N X,C
"RTN","DIG",132,0)
 S (X,C)="" F  S X=$O(@NA@("BY",X),-1) Q:'X  D
"RTN","DIG",133,0)
 .S C=C+1,DIGC(C)=^(X)
"RTN","DIG",134,0)
 .S DIGC(C,0)=$S($D(^DD(+DIGC(C),+$P(DIGC(C),U,2),0)):$P(^(0),U,2),1:$P(DIGC(C),U,7))
"RTN","DIG",135,0)
 Q
"RTN","DIG",136,0)
 ;
"RTN","DIG",137,0)
E(VALUE,XY) ;2=Y,1=X
"RTN","DIG",138,0)
 N %DT,Y
"RTN","DIG",139,0)
 I $P(DIGC(XY),U,4)["-" S VALUE=-VALUE
"RTN","DIG",140,0)
 I DIGC(XY,0)["O" Q VALUE
"RTN","DIG",141,0)
 I VALUE,DIGC(XY,0)["D" S Y=VALUE D DD^%DT Q Y
"RTN","DIG",142,0)
 I DIGC(XY,0)["S" S Y=$P(DIGC(XY),U,2) S:'Y Y=$P($P(DIGC(XY),U,4),"+""",2) S:Y Y=$$EXTERNAL^DILFD(+DIGC(XY),Y,,VALUE,"%DT(0)") I Y]"" Q Y
"RTN","DIG",143,0)
 Q VALUE
"RTN","DIG",144,0)
 ;
"RTN","DIG",145,0)
P S L=-1,X=0
"RTN","DIG",146,0)
PP I L<X W "+" S L=L+T
"RTN","DIG",147,0)
 E  W "-"
"RTN","DIG",148,0)
 S X=X+1 G PP:X'>DXS Q
"RTN","DIG",149,0)
 ;
"RTN","DIG",150,0)
 ;
"RTN","DIG",151,0)
QUE ;
"RTN","DIG",152,0)
 S ZTSAVE("^DOSV(0,$I,")=""
"RTN","DIG",153,0)
 S ZTIO=ION_";"_IOST_";"_IOM_";"_IOSL,ZTRTN="DQ^DIG"
"RTN","DIG",154,0)
 D ^%ZTLOAD K ZTSK G END
"RTN","DIH")
0^4^B7595077^B7378292
"RTN","DIH",1,0)
DIH ;SFISC/GFT-HISTOGRAM ;8:19 AM  28SEP2004
"RTN","DIH",2,0)
 ;;22.0;VA FileMan;**2,61,144**;Mar 30, 1999;Build 5
"RTN","DIH",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIH",4,0)
 I $O(^DOSV(0,IO(0),0))'>0 W !,$C(7),"NO SUB-COUNTS WERE RUN" Q
"RTN","DIH",5,0)
 K ZTSK S:$D(^%ZTSK) %ZIS="QM" D ^%ZIS G ENDK:POP,QUE:$D(IO("Q"))
"RTN","DIH",6,0)
DQ S J=$I,DN="=$O(^DOSV(0,J," F X=0:1 Q:'$D(^DOSV(0,J,"BY",X+1))
"RTN","DIH",7,0)
 G END:'X S A=^(1),DD=$P(A,U,3) I $D(^DD(+A,+$P(A,U,2),0)) S DD=^(0)
"RTN","DIH",8,0)
 S T=$P(DD,U,2),DP=$P(DD,U,3),DF=$S(T["S":1,T["P":2,T["D"!($P(A,U,7)["D"):3,1:0)
"RTN","DIH",9,0)
 S DMX=DN_X,DX="",F=X
"RTN","DIH",10,0)
F S DMX=DMX_",D"_F,DX=DX_"S D"_F_"="""" F X=X:0 S D"_F_DMX_")) Q:D"_F_"=""""  "_$P("S X=X+1,DS(X)=0,DD(X)=0,DV(X)="_$E("-",$P(A,U,4)["-")_"D"_X_" ",U,F=X),F=F-1 G F:F
"RTN","DIH",11,0)
 S DX=DX_"S:$D(^(D1,F,""N"")) DD(X)=DD(X)+^(""N"") S:$D(^(""S"")) DS(X)=DS(X)+^(""S"")"
"RTN","DIH",12,0)
 I $E(IOST)="C" S DIFF=1
"RTN","DIH",13,0)
 S F=-1,C="*",DIHIOM=IOM-23,DIHIOSL=IOSL-8 U IO W:$D(DIFF)&($Y) @IOF S DIFF=1
"RTN","DIH",14,0)
I S @("F"_DN_"""F"",F))") I 'F G END
"RTN","DIH",15,0)
 S X=0,T=^(F),DS=1 X DX S DIH=X
"RTN","DIH",16,0)
 D MAX G I
"RTN","DIH",17,0)
 ;
"RTN","DIH",18,0)
MAX S DMX=0 F N=1:1:DIH S:DD(N)>DMX DMX=DD(N) D LBL:DS=1&DF S DV(N)=$E(DV(N),1,14)
"RTN","DIH",19,0)
 S X=1 F S=1:1 S X=X*2 Q:DMX'>X
"RTN","DIH",20,0)
 S D1=DMX+X\X*X F S=D1:-X/2 Q:S'>DMX  S D1=S
"RTN","DIH",21,0)
 S D2=DIHIOM*X/D1
"RTN","DIH",22,0)
XX S X=X\2,D2=D2\2 I X>4,$L(X)+7<D2 G XX
"RTN","DIH",23,0)
 I DMX S S=D1/DIHIOM,D1=D2 F X=1:1:DIH D HD:X=1!'(X-1#DIHIOSL),LN,TR:X=N!'(X#DIHIOSL) I Y=U Q
"RTN","DIH",24,0)
SUM Q:$P(T,U,4)["D"!(Y=U)  I DS=1 S DS=2 F N=1:1 G:N>DIH MAX S S=DD(N),DD(N)=DS(N),DS(N)=S
"RTN","DIH",25,0)
MEAN I DS=2 S DS=3 F N=1:1 S DD(N)=$S(DS(N):DD(N)/DS(N),1:0) G MAX:N=DIH
"RTN","DIH",26,0)
 Q
"RTN","DIH",27,0)
 ;
"RTN","DIH",28,0)
END W:($E(IOST)'="C")&($Y) @IOF K:$D(ZTSK) ^DOSV(0,IO) D CLOSE^DIO4
"RTN","DIH",29,0)
ENDK K ZTSK,DIH,S,A,C,DD,DS,D1,D2,DN,T,DP,F,N,J,POP,DF,X,Y,DX,DMX,DV,DIHIOM,DIHIOSL,DIFF Q
"RTN","DIH",30,0)
 ;
"RTN","DIH",31,0)
LBL I DF=1 S D1=$F(DP,DV(N)_":") S:D1 DV(N)=$P($E(DP,D1,999),";",1) Q
"RTN","DIH",32,0)
 I DF=2 S DV(N)=$P(@(U_DP_DV(N)_",0)"),U,1) Q
"RTN","DIH",33,0)
 S DV(N)=$S($E(DV(N),4,5):+$E(DV(N),4,5)_"-",1:"")_$S($E(DV(N),6,7):+$E(DV(N),6,7)_"-",1:"")_(1700+$E(DV(N),1,3)) Q
"RTN","DIH",34,0)
 ;
"RTN","DIH",35,0)
HD U IO W:$Y+N+1>DIHIOSL @IOF W !! D  W !! Q
"RTN","DIH",36,0)
 .N H
"RTN","DIH",37,0)
 .S H=$P("COUNT^SUM^MEAN",U,DS)_", "
"RTN","DIH",38,0)
 .I $D(^DD(+T,0)) S Y=+$P(T,U,2) I Y>.01,$D(^(Y,0)) S H=H_$P(^(0),U)_", "
"RTN","DIH",39,0)
 .S H=H_"BY "_$P(DD,U) W ?IOM-$L(H)-2,H
"RTN","DIH",40,0)
LN W ?15-$L(DV(X))-1,DV(X)," |" F Y=1:1:DD(X)/S W C
"RTN","DIH",41,0)
 W ! Q
"RTN","DIH",42,0)
TR W ?15 F Y=0:1:DIHIOM W $E("-+",Y#D1=0+1)
"RTN","DIH",43,0)
 W ! F Y=1:1:DIHIOM I Y#D1=0 S D2=$J(Y*S,0,0) W ?Y+15-($L(D2)\2),D2
"RTN","DIH",44,0)
 I IOST?1"C".E W $C(7) R Y:DTIME
"RTN","DIH",45,0)
 Q
"RTN","DIH",46,0)
QUE ;
"RTN","DIH",47,0)
 S ZTSAVE("^DOSV(0,$I,")=""
"RTN","DIH",48,0)
 S ZTIO=ION_";"_IOST_";"_IOM_";"_IOSL,ZTRTN="DQ^DIH"
"RTN","DIH",49,0)
 D ^%ZTLOAD K ZTSK G END
"RTN","DIH",50,0)
 ;
"RTN","DINIT00G")
0^5^B75544162^B60459820
"RTN","DINIT00G",1,0)
DINIT00G ; SFISC/TKW-DIALOG & LANGUAGE FILE INITS ;21FEB2005
"RTN","DINIT00G",2,0)
 ;;22.0;VA FileMan;**144**;Mar 30, 1999;Build 5
"RTN","DINIT00G",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DINIT00G",4,0)
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) S @X=Y
"RTN","DINIT00G",5,0)
Q Q
"RTN","DINIT00G",6,0)
 ;;^UTILITY(U,$J,.84,8008,2,1,0)
"RTN","DINIT00G",7,0)
 ;;=Heading (S/C)
"RTN","DINIT00G",8,0)
 ;;^UTILITY(U,$J,.84,8008,5,0)
"RTN","DINIT00G",9,0)
 ;;=^.841^2^2
"RTN","DINIT00G",10,0)
 ;;^UTILITY(U,$J,.84,8008,5,1,0)
"RTN","DINIT00G",11,0)
 ;;=DIP^EN1
"RTN","DINIT00G",12,0)
 ;;^UTILITY(U,$J,.84,8008,5,2,0)
"RTN","DINIT00G",13,0)
 ;;=DIS^ENS
"RTN","DINIT00G",14,0)
 ;;^UTILITY(U,$J,.84,8004.1,0)
"RTN","DINIT00G",15,0)
 ;;=8004.1^3^^13^HELP FOR ONE SEARCH CRITERION ('A')
"RTN","DINIT00G",16,0)
 ;;^UTILITY(U,$J,.84,8004.1,2,0)
"RTN","DINIT00G",17,0)
 ;;=^.844^3^3^3050131^^
"RTN","DINIT00G",18,0)
 ;;^UTILITY(U,$J,.84,8004.1,2,1,0)
"RTN","DINIT00G",19,0)
 ;;=To search on the condition you have just typed, hit 'Enter'.
"RTN","DINIT00G",20,0)
 ;;^UTILITY(U,$J,.84,8004.1,2,2,0)
"RTN","DINIT00G",21,0)
 ;;=To search for the NEGATIVE of the condition,
"RTN","DINIT00G",22,0)
 ;;^UTILITY(U,$J,.84,8004.1,2,3,0)
"RTN","DINIT00G",23,0)
 ;;=type "'A".  The "'" character means "negation".
"RTN","DINIT00G",24,0)
 ;;^UTILITY(U,$J,.84,8004.1,5,0)
"RTN","DINIT00G",25,0)
 ;;=^.841^1^1
"RTN","DINIT00G",26,0)
 ;;^UTILITY(U,$J,.84,8004.1,5,1,0)
"RTN","DINIT00G",27,0)
 ;;=DIS0^BAD+1
"RTN","DINIT00G",28,0)
 ;;^UTILITY(U,$J,.84,8004.2,0)
"RTN","DINIT00G",29,0)
 ;;=8004.2^3^^13^HELP AFTER 'IF: ' FOR MULTIPLE CONDITIONS
"RTN","DINIT00G",30,0)
 ;;^UTILITY(U,$J,.84,8004.2,2,0)
"RTN","DINIT00G",31,0)
 ;;=^^3^3^3050131^
"RTN","DINIT00G",32,0)
 ;;^UTILITY(U,$J,.84,8004.2,2,1,0)
"RTN","DINIT00G",33,0)
 ;;=To 'AND' Condition 'A' with Condition 'B', type 'A&B'.
"RTN","DINIT00G",34,0)
 ;;^UTILITY(U,$J,.84,8004.2,2,2,0)
"RTN","DINIT00G",35,0)
 ;;=To 'OR' Condition 'A' with Condition 'B', type 'A',
"RTN","DINIT00G",36,0)
 ;;^UTILITY(U,$J,.84,8004.2,2,3,0)
"RTN","DINIT00G",37,0)
 ;;=and then type 'B' at the next "OR:" prompt.
"RTN","DINIT00G",38,0)
 ;;^UTILITY(U,$J,.84,8004.2,5,0)
"RTN","DINIT00G",39,0)
 ;;=^.841^1^1
"RTN","DINIT00G",40,0)
 ;;^UTILITY(U,$J,.84,8004.2,5,1,0)
"RTN","DINIT00G",41,0)
 ;;=DIS0^BAD+1
"RTN","DINIT00G",42,0)
 ;;^UTILITY(U,$J,.84,8009,0)
"RTN","DINIT00G",43,0)
 ;;=8009^2^^5
"RTN","DINIT00G",44,0)
 ;;^UTILITY(U,$J,.84,8009,1,0)
"RTN","DINIT00G",45,0)
 ;;=^^2^2^2940908^^^^
"RTN","DINIT00G",46,0)
 ;;^UTILITY(U,$J,.84,8009,1,1,0)
"RTN","DINIT00G",47,0)
 ;;=This is the normal help message given if user enters a question mark when
"RTN","DINIT00G",48,0)
 ;;^UTILITY(U,$J,.84,8009,1,2,0)
"RTN","DINIT00G",49,0)
 ;;=being prompted for the HEADER during a FileMan print.
"RTN","DINIT00G",50,0)
 ;;^UTILITY(U,$J,.84,8009,2,0)
"RTN","DINIT00G",51,0)
 ;;=^^3^3^2940908^
"RTN","DINIT00G",52,0)
 ;;^UTILITY(U,$J,.84,8009,2,1,0)
"RTN","DINIT00G",53,0)
 ;;=Accept default heading or enter a custom heading.
"RTN","DINIT00G",54,0)
 ;;^UTILITY(U,$J,.84,8009,2,2,0)
"RTN","DINIT00G",55,0)
 ;;=For no heading at all, type @.
"RTN","DINIT00G",56,0)
 ;;^UTILITY(U,$J,.84,8009,2,3,0)
"RTN","DINIT00G",57,0)
 ;;=To use a Print Template for the heading, type [TEMPLATE NAME].
"RTN","DINIT00G",58,0)
 ;;^UTILITY(U,$J,.84,8009,5,0)
"RTN","DINIT00G",59,0)
 ;;=^.841^2^2
"RTN","DINIT00G",60,0)
 ;;^UTILITY(U,$J,.84,8009,5,1,0)
"RTN","DINIT00G",61,0)
 ;;=DIP^EN1
"RTN","DINIT00G",62,0)
 ;;^UTILITY(U,$J,.84,8009,5,2,0)
"RTN","DINIT00G",63,0)
 ;;=DIS^ENS
"RTN","DINIT00G",64,0)
 ;;^UTILITY(U,$J,.84,8010,0)
"RTN","DINIT00G",65,0)
 ;;=8010^2^y^5
"RTN","DINIT00G",66,0)
 ;;^UTILITY(U,$J,.84,8010,1,0)
"RTN","DINIT00G",67,0)
 ;;=^^1^1^2931102^^^^
"RTN","DINIT00G",68,0)
 ;;^UTILITY(U,$J,.84,8010,1,1,0)
"RTN","DINIT00G",69,0)
 ;;=Print dialog coming from routine ^DIP31.
"RTN","DINIT00G",70,0)
 ;;^UTILITY(U,$J,.84,8010,2,0)
"RTN","DINIT00G",71,0)
 ;;=^^1^1^2931102^
"RTN","DINIT00G",72,0)
 ;;^UTILITY(U,$J,.84,8010,2,1,0)
"RTN","DINIT00G",73,0)
 ;;=** Suppress the |1|.
"RTN","DINIT00G",74,0)
 ;;^UTILITY(U,$J,.84,8010,3,0)
"RTN","DINIT00G",75,0)
 ;;=^.845^1^1
"RTN","DINIT00G",76,0)
 ;;^UTILITY(U,$J,.84,8010,3,1,0)
"RTN","DINIT00G",77,0)
 ;;=1^Text from either entry #8006 or #8007, depending on whether it's called from the SEARCH or PRINT Options.
"RTN","DINIT00G",78,0)
 ;;^UTILITY(U,$J,.84,8010,5,0)
"RTN","DINIT00G",79,0)
 ;;=^.841^2^2
"RTN","DINIT00G",80,0)
 ;;^UTILITY(U,$J,.84,8010,5,1,0)
"RTN","DINIT00G",81,0)
 ;;=DIP^EN1
"RTN","DINIT00G",82,0)
 ;;^UTILITY(U,$J,.84,8010,5,2,0)
"RTN","DINIT00G",83,0)
 ;;=DIS^ENS
"RTN","DINIT00G",84,0)
 ;;^UTILITY(U,$J,.84,8011,0)
"RTN","DINIT00G",85,0)
 ;;=8011^2^y^5
"RTN","DINIT00G",86,0)
 ;;^UTILITY(U,$J,.84,8011,1,0)
"RTN","DINIT00G",87,0)
 ;;=^^1^1^2940526^^^^
"RTN","DINIT00G",88,0)
 ;;^UTILITY(U,$J,.84,8011,1,1,0)
"RTN","DINIT00G",89,0)
 ;;=Dialog coming from routine ^DIP31
"RTN","DINIT00G",90,0)
 ;;^UTILITY(U,$J,.84,8011,2,0)
"RTN","DINIT00G",91,0)
 ;;=^^1^1^2940526^
"RTN","DINIT00G",92,0)
 ;;^UTILITY(U,$J,.84,8011,2,1,0)
"RTN","DINIT00G",93,0)
 ;;=** print |1| Criteria in heading.
"RTN","DINIT00G",94,0)
 ;;^UTILITY(U,$J,.84,8011,3,0)
"RTN","DINIT00G",95,0)
 ;;=^.845^1^1
"RTN","DINIT00G",96,0)
 ;;^UTILITY(U,$J,.84,8011,3,1,0)
"RTN","DINIT00G",97,0)
 ;;=1^The word SORT or SEARCH, depending on which option we're coming from.
"RTN","DINIT00G",98,0)
 ;;^UTILITY(U,$J,.84,8011,5,0)
"RTN","DINIT00G",99,0)
 ;;=^.841^2^2
"RTN","DINIT00G",100,0)
 ;;^UTILITY(U,$J,.84,8011,5,1,0)
"RTN","DINIT00G",101,0)
 ;;=DIP^EN1
"RTN","DINIT00G",102,0)
 ;;^UTILITY(U,$J,.84,8011,5,2,0)
"RTN","DINIT00G",103,0)
 ;;=DIS^ENS
"RTN","DINIT00G",104,0)
 ;;^UTILITY(U,$J,.84,8012,0)
"RTN","DINIT00G",105,0)
 ;;=8012^2^^5
"RTN","DINIT00G",106,0)
 ;;^UTILITY(U,$J,.84,8012,1,0)
"RTN","DINIT00G",107,0)
 ;;=^^2^2^2931102^^^
"RTN","DINIT00G",108,0)
 ;;^UTILITY(U,$J,.84,8012,1,1,0)
"RTN","DINIT00G",109,0)
 ;;=The word HEADING to be used in the prompt for the heading from the FileMan
"RTN","DINIT00G",110,0)
 ;;^UTILITY(U,$J,.84,8012,1,2,0)
"RTN","DINIT00G",111,0)
 ;;=PRINT option.
"RTN","DINIT00G",112,0)
 ;;^UTILITY(U,$J,.84,8012,2,0)
"RTN","DINIT00G",113,0)
 ;;=^^1^1^2931102^
"RTN","DINIT00G",114,0)
 ;;^UTILITY(U,$J,.84,8012,2,1,0)
"RTN","DINIT00G",115,0)
 ;;=Heading
"RTN","DINIT00G",116,0)
 ;;^UTILITY(U,$J,.84,8012,5,0)
"RTN","DINIT00G",117,0)
 ;;=^.841^2^2
"RTN","DINIT00G",118,0)
 ;;^UTILITY(U,$J,.84,8012,5,1,0)
"RTN","DINIT00G",119,0)
 ;;=DIP^EN1
"RTN","DINIT00G",120,0)
 ;;^UTILITY(U,$J,.84,8012,5,2,0)
"RTN","DINIT00G",121,0)
 ;;=DIS^ENS
"RTN","DINIT00G",122,0)
 ;;^UTILITY(U,$J,.84,8013,0)
"RTN","DINIT00G",123,0)
 ;;=8013^2^^5
"RTN","DINIT00G",124,0)
 ;;^UTILITY(U,$J,.84,8013,1,0)
"RTN","DINIT00G",125,0)
 ;;=^^3^3^2931105^^
"RTN","DINIT00G",126,0)
 ;;^UTILITY(U,$J,.84,8013,1,1,0)
"RTN","DINIT00G",127,0)
 ;;=The DD for the file of files is not completely FileMan compatible.  This
"RTN","DINIT00G",128,0)
 ;;^UTILITY(U,$J,.84,8013,1,2,0)
"RTN","DINIT00G",129,0)
 ;;=is the field name prompt for the POST-SELECTION ACTION field on the file
"RTN","DINIT00G",130,0)
 ;;^UTILITY(U,$J,.84,8013,1,3,0)
"RTN","DINIT00G",131,0)
 ;;=of files.  Prompt appears when file attributes.
"RTN","DINIT00G",132,0)
 ;;^UTILITY(U,$J,.84,8013,2,0)
"RTN","DINIT00G",133,0)
 ;;=^^1^1^2931105^^
"RTN","DINIT00G",134,0)
 ;;^UTILITY(U,$J,.84,8013,2,1,0)
"RTN","DINIT00G",135,0)
 ;;=POST-SELECTION ACTION
"RTN","DINIT00G",136,0)
 ;;^UTILITY(U,$J,.84,8013,5,0)
"RTN","DINIT00G",137,0)
 ;;=^.841^1^1
"RTN","DINIT00G",138,0)
 ;;^UTILITY(U,$J,.84,8013,5,1,0)
"RTN","DINIT00G",139,0)
 ;;=DIU0^6
"RTN","DINIT00G",140,0)
 ;;^UTILITY(U,$J,.84,8014,0)
"RTN","DINIT00G",141,0)
 ;;=8014^2^^5
"RTN","DINIT00G",142,0)
 ;;^UTILITY(U,$J,.84,8014,1,0)
"RTN","DINIT00G",143,0)
 ;;=^^3^3^2931105^
"RTN","DINIT00G",144,0)
 ;;^UTILITY(U,$J,.84,8014,1,1,0)
"RTN","DINIT00G",145,0)
 ;;=The DD for the file of files is not completely FileMan compatible.  This
"RTN","DINIT00G",146,0)
 ;;^UTILITY(U,$J,.84,8014,1,2,0)
"RTN","DINIT00G",147,0)
 ;;=is the field name prompt for the LOOK-UP PROGRAM field on the file
"RTN","DINIT00G",148,0)
 ;;^UTILITY(U,$J,.84,8014,1,3,0)
"RTN","DINIT00G",149,0)
 ;;=of files.  Prompt appears when file attributes are edited.
"RTN","DINIT00G",150,0)
 ;;^UTILITY(U,$J,.84,8014,2,0)
"RTN","DINIT00G",151,0)
 ;;=^^1^1^2931105^
"RTN","DINIT00G",152,0)
 ;;^UTILITY(U,$J,.84,8014,2,1,0)
"RTN","DINIT00G",153,0)
 ;;=LOOK-UP PROGRAM
"RTN","DINIT00G",154,0)
 ;;^UTILITY(U,$J,.84,8014,5,0)
"RTN","DINIT00G",155,0)
 ;;=^.841^1^1
"RTN","DINIT00G",156,0)
 ;;^UTILITY(U,$J,.84,8014,5,1,0)
"RTN","DINIT00G",157,0)
 ;;=DIU0^6
"RTN","DINIT00G",158,0)
 ;;^UTILITY(U,$J,.84,8015,0)
"RTN","DINIT00G",159,0)
 ;;=8015^2^^5
"RTN","DINIT00G",160,0)
 ;;^UTILITY(U,$J,.84,8015,1,0)
"RTN","DINIT00G",161,0)
 ;;=^^2^2^2931105^
"RTN","DINIT00G",162,0)
 ;;^UTILITY(U,$J,.84,8015,1,1,0)
"RTN","DINIT00G",163,0)
 ;;=Standard prompt to verify to the user that they just deleted something
"RTN","DINIT00G",164,0)
 ;;^UTILITY(U,$J,.84,8015,1,2,0)
"RTN","DINIT00G",165,0)
 ;;=with the "@".
"RTN","DINIT00G",166,0)
 ;;^UTILITY(U,$J,.84,8015,2,0)
"RTN","DINIT00G",167,0)
 ;;=^^1^1^2931105^
"RTN","DINIT00G",168,0)
 ;;^UTILITY(U,$J,.84,8015,2,1,0)
"RTN","DINIT00G",169,0)
 ;;=Deleted.
"RTN","DINIT00G",170,0)
 ;;^UTILITY(U,$J,.84,8015,5,0)
"RTN","DINIT00G",171,0)
 ;;=^.841^1^1
"RTN","DINIT00G",172,0)
 ;;^UTILITY(U,$J,.84,8015,5,1,0)
"RTN","DINIT00G",173,0)
 ;;=DIU0^6
"RTN","DINIT00G",174,0)
 ;;^UTILITY(U,$J,.84,8016,0)
"RTN","DINIT00G",175,0)
 ;;=8016^2^y^5
"RTN","DINIT00G",176,0)
 ;;^UTILITY(U,$J,.84,8016,1,0)
"RTN","DINIT00G",177,0)
 ;;=^^2^2^2931105^^^^
"RTN","DINIT00G",178,0)
 ;;^UTILITY(U,$J,.84,8016,1,1,0)
"RTN","DINIT00G",179,0)
 ;;=Called after performing routine existence test to tell user that routine
"RTN","DINIT00G",180,0)
 ;;^UTILITY(U,$J,.84,8016,1,2,0)
"RTN","DINIT00G",181,0)
 ;;=is already in their directory.
"RTN","DINIT00G",182,0)
 ;;^UTILITY(U,$J,.84,8016,2,0)
"RTN","DINIT00G",183,0)
 ;;=^^1^1^2931105^
"RTN","DINIT00G",184,0)
 ;;^UTILITY(U,$J,.84,8016,2,1,0)
"RTN","DINIT00G",185,0)
 ;;=Note that |1| is already in the routine directory.
"RTN","DINIT00G",186,0)
 ;;^UTILITY(U,$J,.84,8016,3,0)
"RTN","DINIT00G",187,0)
 ;;=^.845^1^1
"RTN","DINIT00G",188,0)
 ;;^UTILITY(U,$J,.84,8016,3,1,0)
"RTN","DINIT00G",189,0)
 ;;=1^Name of the routine.
"RTN","DINIT00G",190,0)
 ;;^UTILITY(U,$J,.84,8016,5,0)
"RTN","DINIT00G",191,0)
 ;;=^.841^4^4
"RTN","DINIT00G",192,0)
 ;;^UTILITY(U,$J,.84,8016,5,1,0)
"RTN","DINIT00G",193,0)
 ;;=DIU0^6
"RTN","DINIT00G",194,0)
 ;;^UTILITY(U,$J,.84,8016,5,2,0)
"RTN","DINIT00G",195,0)
 ;;=DIEZ^ 
"RTN","DINIT00G",196,0)
 ;;^UTILITY(U,$J,.84,8016,5,3,0)
"RTN","DINIT00G",197,0)
 ;;=DIKZ^ 
"RTN","DINIT00G",198,0)
 ;;^UTILITY(U,$J,.84,8016,5,4,0)
"RTN","DINIT00G",199,0)
 ;;=DIPZ^ 
"RTN","DINIT00G",200,0)
 ;;^UTILITY(U,$J,.84,8017,0)
"RTN","DINIT00G",201,0)
 ;;=8017^2^^5
"RTN","DINIT00G",202,0)
 ;;^UTILITY(U,$J,.84,8017,1,0)
"RTN","DINIT00G",203,0)
 ;;=^^2^2^2931105^
"RTN","DINIT00G",204,0)
 ;;^UTILITY(U,$J,.84,8017,1,1,0)
"RTN","DINIT00G",205,0)
 ;;=Message warning user that a routine does not exist in their routine
"RTN","DINIT00G",206,0)
 ;;^UTILITY(U,$J,.84,8017,1,2,0)
"RTN","DINIT00G",207,0)
 ;;=directory.
"RTN","DINIT00G",208,0)
 ;;^UTILITY(U,$J,.84,8017,2,0)
"RTN","DINIT00G",209,0)
 ;;=^^1^1^2931105^
"RTN","DINIT00G",210,0)
 ;;^UTILITY(U,$J,.84,8017,2,1,0)
"RTN","DINIT00G",211,0)
 ;;=This routine does not exist in the routine directory.
"RTN","DINIT00G",212,0)
 ;;^UTILITY(U,$J,.84,8017,5,0)
"RTN","DINIT00G",213,0)
 ;;=^.841^1^1
"RTN","DINIT00G",214,0)
 ;;^UTILITY(U,$J,.84,8017,5,1,0)
"RTN","DINIT00G",215,0)
 ;;=DIU0^6
"RTN","DINIT00G",216,0)
 ;;^UTILITY(U,$J,.84,8018,0)
"RTN","DINIT00G",217,0)
 ;;=8018^2^y^5
"RTN","DINIT00G",218,0)
 ;;^UTILITY(U,$J,.84,8018,1,0)
"RTN","DINIT00G",219,0)
 ;;=^^2^2^2931105^
"RTN","DINIT00G",220,0)
 ;;^UTILITY(U,$J,.84,8018,1,1,0)
"RTN","DINIT00G",221,0)
 ;;=Prompt showing the user a routine name previously used for compiled
"RTN","DINIT00G",222,0)
 ;;^UTILITY(U,$J,.84,8018,1,2,0)
"RTN","DINIT00G",223,0)
 ;;=routines (input templates, print templates, cross-references).
"RTN","DINIT00G",224,0)
 ;;^UTILITY(U,$J,.84,8018,2,0)
"RTN","DINIT00G",225,0)
 ;;=^^1^1^2931105^
"RTN","DINIT00G",226,0)
 ;;^UTILITY(U,$J,.84,8018,2,1,0)
"RTN","DINIT00G",227,0)
 ;;=Previously compiled under routine name |1|.
"RTN","DINIT00G",228,0)
 ;;^UTILITY(U,$J,.84,8018,3,0)
"RTN","DINIT00G",229,0)
 ;;=^.845^1^1
"RTN","DINIT00G",230,0)
 ;;^UTILITY(U,$J,.84,8018,3,1,0)
"RTN","DINIT00G",231,0)
 ;;=1^Routine name from "DIKOLD" or "ROUOLD" nodes in templates or DD for cross-references.
"RTN","DINIT00G",232,0)
 ;;^UTILITY(U,$J,.84,8018,5,0)
"RTN","DINIT00G",233,0)
 ;;=^.841^1^1
"RTN","DINIT00G",234,0)
 ;;^UTILITY(U,$J,.84,8018,5,1,0)
"RTN","DINIT00G",235,0)
 ;;=DIU0^6
"RTN","DINIT00G",236,0)
 ;;^UTILITY(U,$J,.84,8019,0)
"RTN","DINIT00G",237,0)
 ;;=8019^2^^5
"RTN","DINIT00G",238,0)
 ;;^UTILITY(U,$J,.84,8019,1,0)
"RTN","DINIT00G",239,0)
 ;;=^^3^3^2931105^^
"RTN","DINIT00G",240,0)
 ;;^UTILITY(U,$J,.84,8019,1,1,0)
"RTN","DINIT00G",241,0)
 ;;=The DD for the file of files is not completely FileMan compatible.  This
"RTN","DINIT00G",242,0)
 ;;^UTILITY(U,$J,.84,8019,1,2,0)
"RTN","DINIT00G",243,0)
 ;;=is the field name prompt for the CROSS-REFERENCE ROUTINE field on the file
"RTN","DINIT00G",244,0)
 ;;^UTILITY(U,$J,.84,8019,1,3,0)
"RTN","DINIT00G",245,0)
 ;;=of files.  Prompt appears when file attributes are edited.
"RTN","DIO0")
0^6^B16558960^B16657571
"RTN","DIO0",1,0)
DIO0 ;SFISC/GFT,TKW-BUILD SORT AND SUB-HDR ;28SEP2004
"RTN","DIO0",2,0)
 ;;22.0;VA FileMan;**2,23,138,144**;Mar 30, 1999;Build 5
"RTN","DIO0",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIO0",4,0)
 ;
"RTN","DIO0",5,0)
 S C=",",Z=Z+1,DE=$P(DN,C,Z)_"=$O("_DI_$P(DN,C,1,Z)_")),DN="_(Z+1) ;22*138
"RTN","DIO0",6,0)
 I Z=1,$G(DPP(DJK,"PTRIX"))]"" D
"RTN","DIO0",7,0)
DIOO1 . S DE="DIOO1=$O("_DPP(DJK,"PTRIX")_"DIOO1)),DN=1.5,DD00=0"
"RTN","DIO0",8,0)
 . S DY(1.5)="S DD00=$O("_DPP(DJK,"PTRIX")_"DIOO1,DD00)),DN=2 S:'DD00 DN=1"
"RTN","DIO0",9,0)
 . I DPP(DJK,"PTRIX")?.E1"""B""," S DY(1.5)=DY(1.5)_" S:DD00&($G(^(+DD00))!('($D(^(+DD00))=1))) DN=1"
"RTN","DIO0",10,0)
 . Q
"RTN","DIO0",11,0)
 I DPQ,Z=1,$D(DPP(DJK,"IX")),$O(DPP(DJK,0)) D
"RTN","DIO0",12,0)
 .S DXIX=$P(DPP(DJK),U) Q:'DXIX  S DXIX(DXIX)=U_$P(DPP(DJK,"IX"),U,2)_$S($D(DPP(DJK,"PTRIX")):"DD00,D0",1:DN)
"RTN","DIO0",13,0)
 .S W=0,%(1)="" F %=0:0 S W=$O(DPP(DJK,W)) Q:'W  S %=%+1,%(1)=%(1)_C_"D"_%
"RTN","DIO0",14,0)
 .S DXIX(DXIX)=DXIX(DXIX)_%(1)
"RTN","DIO0",15,0)
 .K %,W Q
"RTN","DIO0",16,0)
 I Z<$G(DPP(0)) S Y=$P($G(DPP(Z+1,"F")),U) I Y]""!($G(DPP(Z+1,"T"))]"") S:+$P(Y,"E")'=Y Y=""""_Y_"""" S DE=DE_","_$P(DN,C,Z+1)_"="_Y
"RTN","DIO0",17,0)
 I 'DPQ,$D(DPP(Z)) D H
"RTN","DIO0",18,0)
 I DPQ,Z=DD S DE=DE_" S:D0 DISTP=DISTP+1 D:'(DISTP#100) CSTP"_$P("^DIO2",1,$D(DIBTPGM))_" Q:'DN "
"RTN","DIO0",19,0)
 S X=DE_" I "_$P(DN,C,Z)_$S(DD=Z:"'>0",1:"=""""")
"RTN","DIO0",20,0)
 S Y="" D
"RTN","DIO0",21,0)
 .I Z=1,$D(DPP(DJK,"T")),$D(DPP(DJK,"IX")) S Y=$P(DPP(DJK,"T"),U)
"RTN","DIO0",22,0)
 .I $G(DPP(0)),Z<(DPP(0)+1) S Y=$P($G(DPP(Z,"T")),U)
"RTN","DIO0",23,0)
 .I Y]"",Y'="@",Y'="z" S X=X_"!("_$$AFT^DIOC($P(DN,C,Z),Y)_")"
"RTN","DIO0",24,0)
 .Q
"RTN","DIO0",25,0)
D0 S X=X_" S DN="_$S(Z=DD&($D(DPP(DJK,"PTRIX"))):1.5,1:(Z-1)),Y=Z-1 I Z=1 S X=X_",D0=-1" I $D(DPP(DJK,"PTRIX")) S X=X_" K DD00",$P(DN,C,1)="DD00"
"RTN","DIO0",26,0)
 I 'DPQ,$D(DPP(Y)) S:$P(DPP(Y),U,4)["!" X="DRK=DRK+1,"_X_",DRK=0",DRK=0 D SUB
"RTN","DIO0",27,0)
 S DY(Z)="S "_X
"RTN","DIO0",28,0)
 I $D(DIBTPGM) D
"RTN","DIO0",29,0)
 . S DY(Z)=$S(Z'=1:"DY"_Z,1:"EN")_" Q:'DN  "_DY(Z)_$S(Z=1:" Q",Z=2&($D(DPP(DJK,"PTRIX"))):" G DYP",Z=2:" G EN",1:" G DY"_(Z-1))
"RTN","DIO0",30,0)
 . I $D(DPP(DJK,"PTRIX")),Z=1 S DY(1.5)="DYP Q:'DN  "_DY(1.5)_" G:DN=1 EN"
"RTN","DIO0",31,0)
 . Q
"RTN","DIO0",32,0)
 G DIO0:Z<DD
"RTN","DIO0",33,0)
 F %=1:1 Q:'$D(DPP(%))  K DPP(%,"PTRIX")
"RTN","DIO0",34,0)
 S %=$S($G(DIO("SCR"))=1:"O",$D(DIS)<9:"O",$D(DIS)=11:"SCR",1:"SEARCH")
"RTN","DIO0",35,0)
 S DY(Z+1)="S DN="_Z_" " I DJ["""B"",^" S DY(Z+1)=DY(Z+1)_"I $D("_DI_$P(DN,C,1,Z)_"))'[0,'^(D0) "
"RTN","DIO0",36,0)
 S DY(Z+1)=DY(Z+1)_"D "_%,Y=Z,X=""
"RTN","DIO0",37,0)
 I 'DPQ,$D(DPP(Y)),$P(DPP(Y),U,2)=0 D SUB I  S DY(Z+1)=DY(Z+1)_" S "_$E(X,2,99)
"RTN","DIO0",38,0)
 I A=1 D:$D(DIBTPGM) SETU Q
"RTN","DIO0",39,0)
 S X=C F W=1:1:A-1 S ^DOSV(0,IO(0),"BY",W)=DPP(A(W)),X=X_$P(DN,C,A(W))_C,A(W)="Q"
"RTN","DIO0",40,0)
 S A(W)="S ^DOSV(0,IO(0)"_C_W_X_"V,DE)=Y"
"RTN","DIO0",41,0)
 D:$D(DIBTPGM) SETU Q
"RTN","DIO0",42,0)
 ;
"RTN","DIO0",43,0)
SUB I $P($G(DPP(Y)),U,4)["+" S A(A)=Y,X=X_",A="_A_" D"_$S($D(DIS)<9:"",1:":$D(DIPASS)")_" ^DIO3"_$S($D(DIS)<9:"",1:" K DIPASS"),A=A+1
"RTN","DIO0",44,0)
 Q
"RTN","DIO0",45,0)
 ;
"RTN","DIO0",46,0)
H S DOP=0 I $D(DNP) F W=1:1 G Q:'$D(DPP(W)) I DPP(W)["+" K DNP S DOP=1 Q
"RTN","DIO0",47,0)
 S Y=$P(DN,",",Z),F=$P(DPP(Z),U,5),W=$P(DPP(Z),U,4),X=$P(W,"""",2),V=+$P(DPP(Z),U,2) S:W["-" Y="(-"_Y_")" I F'[""""&'$D(DPQ(+DPP(Z),V+X))&'DOP!(W["@")!(W["'")!$D(DISH) S (Y,V)="" G F:F]"",U
"RTN","DIO0",48,0)
 I F[";TXT" S Y="$E("_Y_",2,$L("_Y_"))"
"RTN","DIO0",49,0)
 S X=$S($D(^DD(+DPP(Z),V,0)):^(0),1:$P(DPP(Z),U,6,9)) I $P(X,U,2)["D" S Y=" S Y="_Y_" D DT"
"RTN","DIO0",50,0)
 E  I $G(DPP(Z,"OUT"))]"" S DPP(Z,"OUT")=" S Y="_Y_" "_DPP(Z,"OUT"),Y=",Y"
"RTN","DIO0",51,0)
 E  I $P(X,U,2)["O"!($P(X,U,4)?.P) S Y=C_Y
"RTN","DIO0",52,0)
 E  D ^DILL
"RTN","DIO0",53,0)
 S V=$P(F,";C",2),V="?"_$S(V:V-1,1:Z*3+5)
"RTN","DIO0",54,0)
F I F[";S" S %=$P(F,";S",2) S:'% %=1 S V=$E("!!!!!!!!!!!!!!!!!!!!!!!!!!!!",1,%)_V,M=M+%
"RTN","DIO0",55,0)
 S F=$P(F,";""",2),%=$S(W["@":"",W["'":"",F]"":$P(F,"""",1,$L(F,"""")-1),Y]"":$P($P(DPP(Z),U,3),"""",1)_": ",1:""),Y=V_$S(%_Y]"":$E(",",V]"")_""""_%_"""",1:"")_Y I Y]"" S Y=" D T"_$G(DPP(Z,"OUT"))_" W "_Y
"RTN","DIO0",56,0)
U S W=W'["#" I W,Y="",$D(DPP(Z+1)) G E
"RTN","DIO0",57,0)
 S ^UTILITY($J,"H",Z)="X ^UTILITY($J,1)"_$P(":$Y>"_(DIOSL-M-2-DD+Z)_"!(DC["","")",U,W)_Y,Y="D H:DI<DN ",DE=DE_$S(Z=1:",DI=0",1:" S:DI>"_Z_" DI="_Z)
"RTN","DIO0",58,0)
 S:^UTILITY($J,99,0)'[Y ^(0)=Y_^(0)
"RTN","DIO0",59,0)
E I DOP S DNP=""
"RTN","DIO0",60,0)
Q K DOP Q
"RTN","DIO0",61,0)
 ;
"RTN","DIO0",62,0)
SETU ;PUT DY ARRAY INTO ^UTILITY FOR LATER COMPILATION
"RTN","DIO0",63,0)
 N DN
"RTN","DIO0",64,0)
 F DN=0:0 S DN=$O(DY(DN)) Q:'DN  D
"RTN","DIO0",65,0)
 .S ^TMP("DIBTC",$J,0,DICNT)=$E(" ",'$O(DY(DN)))_DY(DN),DICNT=DICNT+1
"RTN","DIO0",66,0)
 .I '$O(DY(DN)) S ^TMP("DIBTC",$J,0,DICNT)=$S(DN>2:" G DY"_(DN-1),1:" G EN"),DICNT=DICNT+1
"RTN","DIO0",67,0)
 .Q
"RTN","DIO0",68,0)
 Q
"RTN","DIO1")
0^7^B11457291^B11188570
"RTN","DIO1",1,0)
DIO1 ;SFISC/GFT,TKW-BUILD P-ARRAY (OR LINES IN COMPILED SORT) WHICH CREATES SORTED DATA ;20MAR2005
"RTN","DIO1",2,0)
 ;;22.0;VA FileMan;**2,97,113,144**;Mar 30, 1999;Build 5
"RTN","DIO1",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIO1",4,0)
 ;
"RTN","DIO1",5,0)
 F DJ=0:1:7 F DX=-1:0 S DX=$O(Y(DJ,DX)) Q:DX=""  F DPR=-1:0 S DPR=$O(Y(DJ,DX,DPR)) D  Q:DPR=""
"RTN","DIO1",6,0)
 .I DPR="" D:$D(DIBTPGM) SETU("Q") Q
"RTN","DIO1",7,0)
 .S X=0
"RTN","DIO1",8,0)
A .F  S X=$O(Y(DJ,DX,DPR,X)) Q:X=""  D
"RTN","DIO1",9,0)
B ..N DL,DIF,W,DICOND,Z,%,BACKWARD
"RTN","DIO1",10,0)
 ..S DL=Y(DJ,DX,DPR,X),W="DISX("_DL_")",DICOND="=""""",D2="" I $P(DPP(DL),U,4)["-" S BACKWARD="-"
"RTN","DIO1",11,0)
 ..I 'X,DL>$G(DPP(0)) S:'$D(DPP(DL,"CM")) W=$G(BACKWARD)_"D"_V(DX),DICOND="<0"
"RTN","DIO1",12,0)
 ..I X S Z=$P($P(^DD(DX,+X,0),U,4),";",2) S:$E(Z)="E" DICOND="?."" """
"RTN","DIO1",13,0)
 ..S Z="" S:$C(63,122)=$P($G(DPP(DL,"F")),U) Z=1 S:$P($G(DPP(DL,"T")),U)="@" Z=Z+2 ;From NULL:Z=1  To NULL:Z=2   Both:Z=3
"RTN","DIO1",14,0)
 ..S DIF=$S($D(BACKWARD):BACKWARD,$P(DPP(DL),U,10)=2:"+",1:"")_$S($D(DE(DL)):"$E("_W_",1,"_DE(DL)_")",1:W) ;DE array was set in ^DIOS
"RTN","DIO1",15,0)
 ..I Z S DIF="$S("_W_"'"_DICOND_":"_DIF_",1:""  EMPTY"")"
"RTN","DIO1",16,0)
 ..S J(DL)=W
"RTN","DIO1",17,0)
 ..I Z=3 S J(DL)=""" """ K DIF ;if just looking for NULLs
"RTN","DIO1",18,0)
 ..I $P(DPP(DL),U,4)["'" S J(DL)=1 K DIF ;if Sort Value doesn't matter
"RTN","DIO1",19,0)
 ..S P(DX)=$S($D(P(DX)):P(DX)_" ",1:"")
"RTN","DIO1",20,0)
 ..S Y=$S(W?1"DISX(".E:"S "_W_"="""" ",1:"")_DPP(DL,"GET")
"RTN","DIO1",21,0)
 ..S DICOND=$G(DPP(DL,"QCON")) I DL=DJK&$D(DPP(DL,"IX"))!(DICOND="") S DICOND="I "_W_"]"""""
"RTN","DIO1",22,0)
SORTVAL ..I $D(DIF),DIF'=W S DICOND=DICOND_" S DISX("_DL_")="_DIF
"RTN","DIO1",23,0)
 ..S Y=Y_" ",DIF="" D  S Y=DICOND,DIF="I  " D
"RTN","DIO1",24,0)
 ...I $D(DIBTPGM) D SETU(Y) D:DIF]"" SETU("Q:'$T") Q
"RTN","DIO1",25,0)
 ...I DPP>2!($L(P(DX))+$L(Y)>125) S Z=$O(P(DX,""),-1)+1,P(DX,Z)=Y,P(DX)=P(DX)_"X P("_DX_","_Z_") "_DIF Q
"RTN","DIO1",26,0)
 ...S P(DX)=P(DX)_Y
"RTN","DIO1",27,0)
BX ..S Y=DX Q
"RTN","DIO1",28,0)
UTILITY K W S W="",Z=" S:$T ^UTILITY($J,0" F X=1:1:DPP S Z=Z_","_$G(J(X),1)
"RTN","DIO1",29,0)
SUB F V=1:1:DPP I V=DPP&(W="")!(DPP(V)-DP) S F=",",Y=DP,%=1,X=0 D  S W=W_Z_F_")="""""
"RTN","DIO1",30,0)
U .S:$D(D(Y)) X=X_D(Y) S %=%+1,Y=$P(Z(V),",",%),D=Y="",F=$S(F'=",":F_",D"_X,D:",D"_X,1:",D"_X_","_V) I 'D S X=V(Y) G U
"RTN","DIO1",31,0)
 .I $L(W)+$L(Z)+$L(F)+$L(DX(DPQ))+$S(V(DPQ):38,1:0)>237 D
"RTN","DIO1",32,0)
 ..I '$D(DIBTPGM) S DIOVFL(V)=$E(W,2,999),W=" X DIOVFL("_V_")" Q
"RTN","DIO1",33,0)
 ..S %=W,(%(1),%(2))="OV",W=" D OV"_DICOV D SETU^DIOS
"RTN","DIO1",34,0)
DX F X=-1:0 S X=$O(DX(X)),DX=X Q:X=""  D
"RTN","DIO1",35,0)
 .N A,B S A=""
"RTN","DIO1",36,0)
 .I $D(DIBTPGM) S B=+$O(^TMP("DIBTC",$J,X,0)),A=$G(^(B))
"RTN","DIO1",37,0)
 .S:A="" A=DX(X)
"RTN","DIO1",38,0)
 .S:X=DPQ A=A_W_$P(",DJ=DJ+1",U,$D(DIS)>9)
"RTN","DIO1",39,0)
 .I V(X) S F="",%(0)=DX,%=DCC S:$D(DXIX(DX)) F=DXIX(DX) D:F="" GREF^DIOU(.V,.%,.F) S A=A_" "_"S D"_V(X)_"=$O("_F_")) Q:D"_V(X)_"'>0"
"RTN","DIO1",40,0)
 .S DX(X)=A Q:'$D(DIBTPGM)
"RTN","DIO1",41,0)
 .S:B ^TMP("DIBTC",$J,X,B)=A S DX(X)="D "_$P(A," ")
"RTN","DIO1",42,0)
0 S DX(0)=DX(DP),DX=0,DPQ=0 K:DP DX(DP)
"RTN","DIO1",43,0)
 ;
"RTN","DIO1",44,0)
2 K D,%,I D 2^DIO D  I $G(DIERR) G IXK^DIO
"RTN","DIO1",45,0)
 .I $G(DIERR),$D(^UTILITY($J,0))>0 D CLEAN^DILF
"RTN","DIO1",46,0)
 K DIOVFL,P,V,Y,D0,D1,D2,D3 K:'$D(DIB) DIS S:$D(DIBTPGM) DIBTPGM=""
"RTN","DIO1",47,0)
DIOO1 S V="I $D(^UTILITY($J,0" K DPP(0,"F"),DPP(0,"T") F X=1:1:DPP K DPP(X,"F"),DPP(X,"T") S V=V_",DIOO"_(DPP-X+1)
"RTN","DIO1",48,0)
 F X=-1:0 S X=$O(DX(X)) Q:X=""  I $D(DX(X,U)) S DSC(X)=V_DX(X,U)_$S($D(DSC(X)):" "_DSC(X),1:"")
"RTN","DIO1",49,0)
 K DX S DX=^UTILITY($J,"DX"),DJ=^("F"),%=$O(^("DX",-1)) S:%="" %=-1 F %=%:0 S DX(%)=^(%),%=$O(^(%)) I %="" G GO^DIO
"RTN","DIO1",50,0)
 ;
"RTN","DIO1",51,0)
SETU(%) Q:%=""  N A
"RTN","DIO1",52,0)
 S A=$G(DICP(DX)) I A S A="P"_A
"RTN","DIO1",53,0)
 S ^TMP("DIBTC",$J,"P",DICNT)=A_" "_%
"RTN","DIO1",54,0)
 K DICP(DX) S DICNT=DICNT+1
"RTN","DIO1",55,0)
 Q
"RTN","DIQQQ")
0^8^B7471721^B7816877
"RTN","DIQQQ",1,0)
DIQQQ ;SFISC/GFT,XAK-MORE HELP ;21FEB2005
"RTN","DIQQQ",2,0)
 ;;22.0;VA FileMan;**144**;Mar 30, 1999;Build 5
"RTN","DIQQQ",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIQQQ",4,0)
 ;
"RTN","DIQQQ",5,0)
DICATT W !,"IF YOU WANT THE SAME ANSWER ALLOWED FOR ",F,!,"AS FOR " Q
"RTN","DIQQQ",6,0)
 ;
"RTN","DIQQQ",7,0)
DICATT1 W !,"ENTER GLOBAL SUBSCRIPT NAME AT WHICH ",F," WILL BE STORED"
"RTN","DIQQQ",8,0)
 W !,"   ALREADY ASSIGNED: " S Y="",T=0 F  S Y=$O(^DD(A,"GL",Y)) Q:Y=""  W $J(Y,9) W:$X>66 !
"RTN","DIQQQ",9,0)
 S Y=-1 G SUB^DICATT1
"RTN","DIQQQ",10,0)
 ;
"RTN","DIQQQ",11,0)
DIS ;
"RTN","DIQQQ",12,0)
 D  W !! Q
"RTN","DIQQQ",13,0)
 .W !?8,"ENTER A VALUE WHICH '"_O(DC)_"'"
"RTN","DIQQQ",14,0)
 .W !?8,"MUST "_$P("NOT ",U,DN]"")_$P("^CONTAIN^MATCH^BE LESS THAN^EQUAL^EXCEED^FOLLOW",U,+DQ)_", IN ORDER FOR"
"RTN","DIQQQ",15,0)
 .W " TRUTH CONDITION -"_$C(DC+64)_"- TO BE TRUE",!
"RTN","DIQQQ",16,0)
 .W:+DQ=3 !?8,"(I.E., ENTER WHAT WOULD FOLLOW THE MUMPS '?' OPERATOR)",!
"RTN","DIQQQ",17,0)
 .I E["S" W ! D EN^DIQQ1(DK,DU,"?")
"RTN","DIQQQ",18,0)
 ;
"RTN","DIQQQ",19,0)
DISC W !,"YOU CAN NEGATE ANY OF THESE CONDITIONS BY PRECEDING THEM WITH ""'"" OR ""-"""
"RTN","DIQQQ",20,0)
 W !,"SO THAT ""'NULL'"" MEANS ""NOT NULL""",! G C^DIS
"RTN","DIQQQ",21,0)
 ;
"RTN","DIQQQ",22,0)
DIP1 W $C(7),!,"YOU HAVE ASKED TO SORT ON THE SAME FIELD TWICE!",!,"PLEASE RE-ENTER YOUR SORT CRITERIA!" G Q^DIP
"RTN","DIQQQ",23,0)
 ;
"RTN","DIQQQ",24,0)
DIP3 W !,"IF YOU WANT PAGE NUMBERING TO START AT A NUMBER HIGHER THAN 1, TYPE THAT NUMBER" G ^DIP3
"RTN","DIQQQ",25,0)
 ;
"RTN","DIQQQ",26,0)
DIA W "FOLLOW A FIELD NAME WITH ';""CAPTION""' TO HAVE THE FIELD ASKED AS 'CAPTION: '"
"RTN","DIQQQ",27,0)
 W !?9,"OR WITH ';T' TO USE THE FIELD 'TITLE' AS CAPTION"
"RTN","DIQQQ",28,0)
 G 2^DIA
"RTN","DIQQQ",29,0)
 ;
"RTN","DIQQQ",30,0)
DIA3 W !,$C(7),"CAPTIONS CANNOT CONTAIN ':' OR ';', OR BEGIN WITH A PERIOD OR A DIGIT",! G 2^DIA
"RTN","DIQQQ",31,0)
 ;
"RTN","DIQQQ",32,0)
DIP21 W !,"THIS TEMPLATE MAY EVENTUALLY BE USED WITH A DIFFERENT 'SORT-BY' SEQUENCE.",!
"RTN","DIQQQ",33,0)
 W "ANSWERING 'Y' HERE INSURES THAT, IN THAT CASE, USER WON'T HAVE TO REMEMBER"
"RTN","DIQQQ",34,0)
 W !,"TO TYPE THE '@' IN ORDER TO KEEP SUB-HEADERS FROM APPEARING.",! G SUB^DIP21
"RTN","DIQQQ",35,0)
 ;
"RTN","DIQQQ",36,0)
DICOMPW W !?4,"AT THE TIME THE LOOKUP OCCURS IN FILE "_Y_", THERE MAY"
"RTN","DIQQQ",37,0)
 W !?4,"BE MORE THAN 1 ENTRY FOUND.  ANSWERING 'Y' HERE MEANS THAT THE"
"RTN","DIQQQ",38,0)
 W !?4,"USER THEN WILL BE ALLOWED TO CHOOSE AMONG SEVERAL ENTRIES.",!! Q
"RTN","DIQQQ",39,0)
XPDIP21 ;from XPUT^DIP21
"RTN","DIQQQ",40,0)
 W !!,$C(7),"You must choose a template to store the fields selected for export."
"RTN","DIQQQ",41,0)
 W !,"If you do not want to save the selections, use the '^'.",! Q
"RTN","DIS")
0^9^B22841666^B15927735
"RTN","DIS",1,0)
DIS ;SFISC/GFT-GATHER SEARCH CRITERIA ;23JUN2006
"RTN","DIS",2,0)
 ;;22.0;VA FileMan;**6,97,144**;Mar 30, 1999;Build 5
"RTN","DIS",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIS",4,0)
 K ^UTILITY($J),DC,DIS,%ZIS,O,N,R D ^DICRW
"RTN","DIS",5,0)
 G Q:'$D(DIC)!$D(DTOUT)
"RTN","DIS",6,0)
EN ;
"RTN","DIS",7,0)
 S:DIC DIC=$G(^DIC(DIC,0,"GL")) Q:DIC=""
"RTN","DIS",8,0)
 K DI,DX,DY,I,J,DL,DC,DA,DTOUT,^UTILITY($J) G Q:'$D(@(DIC_"0)"))
"RTN","DIS",9,0)
 S (R,DI,I(0))=DIC,(DL,DC)=1,DY=999,N=0,Q="""",DV=""
"RTN","DIS",10,0)
R ;
"RTN","DIS",11,0)
 I +R=R S (J(N),DK)=R,R=""
"RTN","DIS",12,0)
 E  S @("(J(N),DK)=+$P("_R_"0),U,2)"),R=$P(^(0),U)
"RTN","DIS",13,0)
F ;
"RTN","DIS",14,0)
 G UP:DC>58
"RTN","DIS",15,0)
 W ! K X,DIC,DISPOINT,DE D W
"RTN","DIS",16,0)
 S DIC(0)="EZ",C=",",DIC="^DD("_DK_",",DIC("W")="S %=$P(^(0),U,2) W:% $S($P(^DD(+%,.01,0),U,2)[""W"":""   (word-processing)"",1:""   (multiple)"")",DIC("S")="I $P(^(0),U,2)'[""m"""_$S($D(DICS):" "_DICS,1:""),DU=""
"RTN","DIS",17,0)
 W "SEARCH FOR "_R_" "_$P(^DD(DK,0),U)_": "
"RTN","DIS",18,0)
 R X:DTIME S:'$T DTOUT=1 G Q:X=U!'$T,TEM^DIS2:X?1"[".E D  I Y>0 K DISPOINT S DE=Y(0),O(DC)=$P(DE,U),DU=+Y,Z=$P(DE,U,3),E=$P(DE,U,2) G G
"RTN","DIS",19,0)
 .N DISVX S DISVX=X D ^DIC S:Y=-1 X=DISVX Q
"RTN","DIS",20,0)
HARD G UP:X="",F:X?."?",Q:X=U!($D(DTOUT)),COMP^DIS2
"RTN","DIS",21,0)
 Q
"RTN","DIS",22,0)
G ;^DOPT("DIS",1,0)=NULL
"RTN","DIS",23,0)
 ;^DOPT("DIS",2,0)=CONTAINS
"RTN","DIS",24,0)
 ;^DOPT("DIS",3,0)=MATCHES
"RTN","DIS",25,0)
 ;^DOPT("DIS",4,0)=LESS THAN
"RTN","DIS",26,0)
 ;^DOPT("DIS",5,0)=EQUALS
"RTN","DIS",27,0)
 ;^DOPT("DIS",6,0)=GREATER THAN
"RTN","DIS",28,0)
 K X,DIC S DIC="^DOPT(""DIS"",",DIC(0)="QEZ" I E["B" S X="" G OK
"RTN","DIS",29,0)
 I E S N(DL)=N,N=N+1,DV(DL)=DV,DL(DL)=DK,DK=+E,J(N)=DK,X=$P($P(DE,U,4),";"),I(N)=$S(+X=X:X,1:""""_X_""""),Y(0)=^DD(DK,.01,0),DL=DL+1 G WP:$P(Y(0),U,2)["W" S DV=DV_+Y_"," G F
"RTN","DIS",30,0)
 S X=$P(E,"p",2) I X,$D(^DIC(+X,0,"GL")) S DISPOINT=$S(Y:+Y,1:-DC)_U_U_^("GL") ;Y will be FIELD lookup, unless it's COMPUTED EXPRESSION from ^DIS2
"RTN","DIS",31,0)
 I E["P" S DISPOINT=+Y_U_Y(0) S X=+$P(E,"P",2) F  Q:'X  D
"RTN","DIS",32,0)
 .S DA=$P($G(^DD(X,.01,0)),U,2) I DA["D" S E="D"_E,X="" Q
"RTN","DIS",33,0)
 .S X=+$P(DA,"P",2)
"RTN","DIS",34,0)
 I $D(DISPOINT),Y>0 S X="(#"_+Y_")",DA="DIS("""_$C(DC+64)_DL_""",",DICOMP=N S:$D(O(DC))[0 O(DC)=X D EN^DICOMP G X:'$D(X) S DA(DC)=X,DU=-DC F %=0:0 S %=$O(X(%)) Q:'%  S @(DA_%_")")=X(%)
"RTN","DIS",35,0)
C K X D W R "CONDITION: ",X:DTIME S:'$T DTOUT=1 G Q:X[U!'$T
"RTN","DIS",36,0)
 S DN=$S("'-"[$E(X):"'",1:""),X=$E(X,DN]""+1,99)
"RTN","DIS",37,0)
 S:E["S" DIC("S")="I Y<3!(Y=5)" D ^DIC K DIC("S")
"RTN","DIS",38,0)
 G:Y<0 Q:X[U,B:X="",DISC^DIQQQ:X["?",C
"RTN","DIS",39,0)
 S O=$P("NOT ",U,DN]"")_$P(Y,U,2)
"RTN","DIS",40,0)
 I +Y=1 S X=DN_"?."" """,O(DC)=O(DC)_" "_O G OK
"RTN","DIS",41,0)
 S DQ=Y
"RTN","DIS",42,0)
VALUE D W W O I E["D",Y-3 R " DATE: ",X:DTIME S:'$T DTOUT=1 G F:X=U,Q:'$T S %DT="TE" D ^%DT S X=Y_U_X G X:Y<0 X ^DD("DD") S Y=X_U_Y G GOT
"RTN","DIS",43,0)
 ;POINTERS
"RTN","DIS",44,0)
PT I $D(DISPOINT),+DQ=5 K DIC,DIS($C(DC+64)_DL) S DIC=U_$P(DISPOINT,U,4),DIC(0)="EMQ",DU=+DISPOINT W " "_$P(@(DIC_"0)"),U)_": " R X:DTIME S:'$T DTOUT=1 G F:U[X,Q:'$T D ^DIC G GOT:Y>0,PT
"RTN","DIS",45,0)
 R ": ",Y:DTIME E  S DTOUT=1 G Q
"RTN","DIS",46,0)
 G X:Y="" I Y[U,$P($G(DE),U,4)'[";E",'$P($G(DE),U,2),E'["C" G F ;We can look for "^" in WP or $E-stored actual data
"RTN","DIS",47,0)
 I +DQ=3 S X="I X?"_Y D ^DIM G GOT:$D(X) S Y="?" ;Is it a good PATTERN-MATCH?
"RTN","DIS",48,0)
 I DQ=4!(DQ=6),+Y'=Y G X ;> or < have to be numeric
"RTN","DIS",49,0)
 I Y?."?" D DIS^DIQQQ G VALUE
"RTN","DIS",50,0)
 W:Y[""""&($L(Y)>1) "    (Your answer includes quotes)"
"RTN","DIS",51,0)
SET I E["S" D  K DIS("XFORM",DC) G GOT:$D(X) K DIS(U,DC) D DIS^DIQQQ G VALUE
"RTN","DIS",52,0)
 .N D S X=1 I +DQ=5!(Y["""") D  K:D="" X Q
"RTN","DIS",53,0)
 ..N DIR,DDER S X=Y,DIR(0)="S^"_Z,DIR("V")=1 D ^DIR I $G(DDER) S D="" Q
"RTN","DIS",54,0)
 ..F X=1:1 S D=$P(Z,";",X) Q:D=""  I Y=$P(D,":") S Y=""""_$$CONVQQ^DILIBF($P(D,":"))_"""^"_$P(D,":",2) Q
"RTN","DIS",55,0)
 .N N,%,C W !?7 S Y=""""_Y_"""",N="DE"_DN_$E(" [?<=>",DQ)_Y
"RTN","DIS",56,0)
 .F X=1:1 S D=$P(Z,";",X),DE=$P(D,":",2) Q:D=""  S DIS(U,DC,$P(D,":"))=DE I @N S:'$D(%) %="[ Will match" W % S C=$G(C)+1,%="'"_DE_"'" W:C>1 "," W " " W:$X+$L(%)>73 !?7
"RTN","DIS",57,0)
 .I '$D(%) K X Q
"RTN","DIS",58,0)
 .W:C>1 "and " W %_" ]"
"RTN","DIS",59,0)
 I Y?.E2A.E S DIS("XFORM",DC)="$$UP^DILIBF(;)",Y=$$UP^DILIBF(Y)
"RTN","DIS",60,0)
 D
"RTN","DIS",61,0)
 .N P,YY,C S C="""",YY=C_$$CONVQQ^DILIBF($P(Y,U)) F P=2:1:$L(Y,U)  S YY="("_YY_"""_$C(94)_"""_$$CONVQQ^DILIBF($P(Y,U,P)),C=C_")"
"RTN","DIS",62,0)
 .S Y=YY_C
"RTN","DIS",63,0)
GOT S X=DN_$E(" [?<=>",DQ)_$P(Y,U) I E["D" D
"RTN","DIS",64,0)
 .I $P(Y,U)'[".",$E(Y,6,7) S %=$P("^^^^ any time during^ the entire day",U,DQ) I %]"" S DIS("XFORM",DC)="$P(;,""."")",O=O_%
"RTN","DIS",65,0)
 .S Y=$P(Y,U,3)_U_$P(Y,U,2)
"RTN","DIS",66,0)
 I $G(DIS("XFORM",DC))="$$UP^DILIBF(;)" S O=O_" (case-insensitive)"
"RTN","DIS",67,0)
 S O(DC)=O(DC)_" "_O_" "_Y
"RTN","DIS",68,0)
OK S DC(DC)=DV_DU_U_X,%=DL-1_U_(N#100)
"RTN","DIS",69,0)
 I DL>1,O(DC)'[R S O(DC)=R_" "_O(DC)
"RTN","DIS",70,0)
 S:DU["W" %=DL-2_U_(N#100-1) S DX(DC)=%,DC=DC+1 S:DC=27 DC=33 ;go from "Z" to "a"
"RTN","DIS",71,0)
B G F:(DU'["W"&(DC<59))
"RTN","DIS",72,0)
UP I DC>1 G ^DIS0:DL<$S('$D(DIARF0):2,1:2) S DL=DL-1,DV=DV(DL),DK=DL(DL),N=N(DL),R=$S($D(R(DL)):R(DL),1:R) K R(DL) S %=N F  S %=$O(I(%)) S:%="" %=-1 G F:%<0 K I(%),J(%)
"RTN","DIS",73,0)
Q G Q^DIS2:'$D(DIARU),^DIS2
"RTN","DIS",74,0)
 ;
"RTN","DIS",75,0)
WP S DIC("S")="I Y<3",DU=+Y_"W" G C
"RTN","DIS",76,0)
 ;
"RTN","DIS",77,0)
X ;
"RTN","DIS",78,0)
 W $C(7),"??",!! K O(DC) G B
"RTN","DIS",79,0)
 ;
"RTN","DIS",80,0)
W W !?DL*2,"-"_$C(DC+64)_"- " Q
"RTN","DIS",81,0)
 ;
"RTN","DIS",82,0)
 ;
"RTN","DIS",83,0)
 ;
"RTN","DIS",84,0)
 ;
"RTN","DIS",85,0)
 ;
"RTN","DIS",86,0)
 ;
"RTN","DIS",87,0)
 ;
"RTN","DIS",88,0)
ENS ; ENTRY POINT FOR RE-DOING THE SORT USING AN EXISTING SORT TEMPLATE
"RTN","DIS",89,0)
 G EN^DIS3
"RTN","DIS0")
0^10^B11743531^B10852001
"RTN","DIS0",1,0)
DIS0 ;SFISC/GFT-SEARCH, IF STATEMENT AND MULTIPLE COMBO'S ;30JAN2005
"RTN","DIS0",2,0)
 ;;22.0;VA FileMan;**144**;Mar 30, 1999;Build 5
"RTN","DIS0",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIS0",4,0)
 W ! K R,N,DL,DE,DJ
"RTN","DIS0",5,0)
 S O=0,E=$D(DC(2)),N="IF: A// ",DE=$S(E:"IF: ",1:N),DL=0
"RTN","DIS0",6,0)
 S C=","
"RTN","DIS0",7,0)
R W !,DE K DV R X:DTIME S:'$T DTOUT=1 G Q:X[U!'$T
"RTN","DIS0",8,0)
 I X="" S DV=1,DU=X G 1:DL S DQ="TYPE '^' TO EXIT",Y="^1^",DL=1 G BAD:E D ASKQ G L
"RTN","DIS0",9,0)
 S Y=U,P=0,DU="",D="",DL=DL+1
"RTN","DIS0",10,0)
P S P=P+1,DQ=$E(X,P) I DQ="" G BAD:Y=U,L
"RTN","DIS0",11,0)
 I DQ?.A S DV=$A(DQ)-64 I $D(DC(DV)) D ASKQ G CHK
"RTN","DIS0",12,0)
 G P:"&+ "[DQ I DU="","'-"[DQ S DU="'" G P
"RTN","DIS0",13,0)
BAD D  W !! K DJ(DL),DE(DL) S DL=DL-1 G R
"RTN","DIS0",14,0)
 .I DQ?."?" D BLD^DIALOG($S($D(DC(2)):8004.2,1:8004.1)),MSG^DIALOG("WH") Q  ;HELP depending on whether there is a CONDITION B
"RTN","DIS0",15,0)
 .W "   <",DQ,">??"
"RTN","DIS0",16,0)
 ;
"RTN","DIS0",17,0)
ASKQ S J=DC(DV),%=J["?."" """,I=J["^'"+(DU["'")#2 I J["W^" S DV(DV)=$S(I:2-%,1:%+%+1) S:% DC(DV)=$E(J,1,$L(J)-5)_"=""""" Q
"RTN","DIS0",18,0)
 S:$P(J,U)[C DV(DV)=J?.E1",.01^".E&%+(I+%#2) Q
"RTN","DIS0",19,0)
 ;
"RTN","DIS0",20,0)
CHK S %=$F(Y,U_DV) I % S %=$P($E(Y,%),U,1)'=DU,DQ=""""_DQ_""" AND """_$E("'",%)_DQ_""" IS "_$P("REDUNDANT^CONTRADICTORY",U,%+1) G BAD
"RTN","DIS0",21,0)
 S %=1,Y=Y_DV_DU_U,DU="",J=$P(DC(DV),U,1) G P:J'[C F Z=2:1 I $P(J,C,Z,99)'[C S J=$P(J,C,1,Z-1)_C Q
"RTN","DIS0",22,0)
 I J=D D SAMEQ S:%=1 DJ(DL,DV)=DX(DV)
"RTN","DIS0",23,0)
 S D=J,DJ=DV G P:%>0
"RTN","DIS0",24,0)
Q G Q^DIS2
"RTN","DIS0",25,0)
 ;
"RTN","DIS0",26,0)
SAMEQ I J<0,$P(DY(-J),U,3)="" Q
"RTN","DIS0",27,0)
 W !?8,"CONDITION -"_$C(DV+64)_"- WILL APPLY TO THE SAME MULTIPLE AS CONDITION -"_$C(DJ+64)_"-",!?8,"...OK" G YN^DICN
"RTN","DIS0",28,0)
 ;
"RTN","DIS0",29,0)
L S P=O,DL(DL)=Y,DE="OR: " F %=2:1 S X=$P(Y,U,%) Q:X=""  S O=O+1,^UTILITY($J,O,0)=$S(%>2:$S($D(DJ(DL,+X)):"  together with ",1:"   and "),O=1:"",1:" Or ")_$P("not ",U,X["'")_O(+X)
"RTN","DIS0",30,0)
 W:$X>18 ! W "   " F %=P+1:1 Q:'$D(^UTILITY($J,%,0))  S X=^(0) W:$L(X)+$X>77 !?13 W " "_$P(X,U) I $P(X,U,2)'="" W " ("_$P(X,U,2)_")"
"RTN","DIS0",31,0)
 S DV=0
"RTN","DIS0",32,0)
DV S DV=$O(DV(DV)) S:DV="" DV=-1 G:DV'>0 R:E,1 G DV:$D(DJ(DL,DV)) S I=$P(DC(DV),U,1),D=DK,DN=0,Y="DO YOU WANT THIS SEARCH SPECIFICATION TO BE CONSIDERED TRUE FOR CONDITION -"_$C(DV+64)_"-"
"RTN","DIS0",33,0)
G S DN=DN+1,P=$P(I,C,1),I=$P(I,C,2,99) G W:P["W",DV:I="" I P<0 S J=DY(-P),D=+J,R=" '"_$P(^DIC(D,0),U,1)_"' ENTRIES " G G:'$P(J,U,3)
"RTN","DIS0",34,0)
 E  S D=+$P(^DD(D,P,0),U,2),R=" '"_$O(^DD(D,0,"NM",0))_"' MULTIPLES "
"RTN","DIS0",35,0)
HOW W !!,Y,!?8,"1) WHEN AT LEAST ONE OF THE"_R_"SATISFIES IT"
"RTN","DIS0",36,0)
 W !?8,"2) WHEN ALL OF THE"_R_"SATISFY IT" S X=2
"RTN","DIS0",37,0)
 I DV(DV) W !?8,"3) WHEN ALL OF THE"_R_"SATISFY IT,",!?16,"OR WHEN THERE ARE NO"_R S X=3
"RTN","DIS0",38,0)
 W !?4,"CHOOSE 1-"_X_": " I DV(DV)>1 W 3 S %1=3
"RTN","DIS0",39,0)
 E  W 1 S %1=1
"RTN","DIS0",40,0)
 R "// ",%:DTIME,! S:'$T DTOUT=1 S:%="" %=%1 K %1 G Q:%=U!'$T,HOW:%>X!'% I %>1 S DE(DL,DV,DN)=%,O=O+1,^UTILITY($J,O,0)="   for all"_R_$P(", or when no"_R_"exist",U,%>2)
"RTN","DIS0",41,0)
 G G
"RTN","DIS0",42,0)
 ;
"RTN","DIS0",43,0)
W I DV(DV)-2 S DE(DL,DV,DN)=DV(DV) G DV
"RTN","DIS0",44,0)
 W !!,Y,!?7,"WHEN THERE IS NO '"_$P(^DD(D,+P,0),U,1)_"' TEXT AT ALL"
"RTN","DIS0",45,0)
 S %=1 D YN^DICN G Q:%<0,W:'% S DE(DL,DV,DN)=4-% G DV
"RTN","DIS0",46,0)
 ;
"RTN","DIS0",47,0)
1 K O,DX,Y G ^DIS1
"RTN","DIS1")
0^11^B11677620^B11526138
"RTN","DIS1",1,0)
DIS1 ;SFISC/GFT-BUILD DIS-ARRAY ;20MAR2005
"RTN","DIS1",2,0)
 ;;22.0;VA FileMan;**6,77,97,113,144**;Mar 30, 1999;Build 5
"RTN","DIS1",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIS1",4,0)
 K DIS0 I $D(DL)#2 S DIS0=DL
"RTN","DIS1",5,0)
 S DL(0)="" W ! G 1:$D(DE)>1!$D(DJ) I DL=1 S DL(0)=DL(1),DL=0 K DL(1)
"RTN","DIS1",6,0)
 E  F P=2:1 S Y=$P(DL(1),U,P) Q:Y=""  S Y=U_Y_U,X=2 D 2
"RTN","DIS1",7,0)
 F X=1:1 Q:'$D(DL(X))  F Y=X+1:1 Q:'$D(DL(Y))  I DL(X)=DL(Y)!(DL(Y)?.P) S DL=DL-1 K DL(Y) F P=Y:1:DL S DL(P)=DL(P+1) K DL(P+1)
"RTN","DIS1",8,0)
1 D ENT G ^DIS2:'$D(DIAR),DIS^DIS2
"RTN","DIS1",9,0)
 ;
"RTN","DIS1",10,0)
ENT S DK(0)=DK,Z="D0," F DQ=0:1:DL K R,M D  S X=0,DQ(0)=DQ,R=-1 D MAKE S %=0 F  S R=$O(R(R)) Q:R=""  I R(R)<2 S DIS(R)=DIS(R)_" K D"
"RTN","DIS1",11,0)
 . N I S I="" F  S I=$O(DI(I)) Q:'I  K DI(I)
"RTN","DIS1",12,0)
 . Q
"RTN","DIS1",13,0)
 S R=-1 Q
"RTN","DIS1",14,0)
 ;
"RTN","DIS1",15,0)
2 I X'>DL Q:DL(X)'[Y  S X=X+1 G 2
"RTN","DIS1",16,0)
 S DL(0)=U_$P(Y,U,2)_DL(0),P=P-1
"RTN","DIS1",17,0)
22 S X=X-1,DQ=$F(DL(X),Y),DL(X)=$E(DL(X),1,DQ-$L(Y))_$E(DL(X),DQ,999) G 22:X>1 Q
"RTN","DIS1",18,0)
 ;
"RTN","DIS1",19,0)
C S Y=Y_$S(DV="'":" I 'X",1:" I "_$$XFORM("X")_DV) D SD
"RTN","DIS1",20,0)
MAKE S DC=DI,DQ=+DQ,X=X+1,Y=$P(DL(DQ),U,X+1) Q:Y=""
"RTN","DIS1",21,0)
 S S=+Y,DN=$E("'",Y["'"),Y=DC(S),D=0,DL=0 I $D(DJ(DQ,S)) S D=$P(DJ(DQ,S),U,2),DL=+DJ(DQ,S) I $D(DI(DL)) S DC=DI(DL)
"RTN","DIS1",22,0)
 S DQ=DQ(DL),Z=$P(Z,",",1,D+D+1)_",",DU=$P($P(Y,U),",",DL+1,99),O=DK(DL),DV=DN_$P(Y,U,2) I DV?1"''".E S DV=$E(DV,3,999)
"RTN","DIS1",23,0)
LEV S DL=DL+1,DN=$S($D(DE(+DQ,X,DL)):DE(+DQ,X,DL),1:1)
"RTN","DIS1",24,0)
 S:$G(DI(DL-1))]"" DI(DL)=DI(DL-1)
"RTN","DIS1",25,0)
 I DU<0 G X:$D(DY(-DU)) S Y=DA(-DU) G C
"RTN","DIS1",26,0)
 S N=$P(^DD(O,+DU,0),U,4),DE=$P(N,";",1),Y=$P(N,";",2) I Y="" S Y="D"_D G M
"RTN","DIS1",27,0)
 I $P(^(0),U,2)["C" S Y=$P(^(0),U,5,99) G C
"RTN","DIS1",28,0)
 S:+DE'=DE DE=""""_DE_""""
"RTN","DIS1",29,0)
 S Z=Z_DE,E="$G("_DC_Z_"))" I Y S Y="$P("_E_",U,"_Y_")" G M
"RTN","DIS1",30,0)
 I Y'=0 S Y=$E(Y,2,99) S:$P(Y,",",2)=+Y Y=+Y S Y="$E("_E_","_Y_")" G M
"RTN","DIS1",31,0)
 F Y=65:1 S M=DQ_$C(Y) Q:'$D(DIS(M))
"RTN","DIS1",32,0)
 S D=D+1,Y="S D"_D_"=+$O("_DC_Z_",0)) X DIS("""_M_""") I $T" D SD
"RTN","DIS1",33,0)
 I $D(DIAR) S DIAR(DIARF,DQ)="X DIS("""_M_"A"")"
"RTN","DIS1",34,0)
 S DQ=M,DIS(DQ)="F  X DIS("""_DQ_"A"") X:D"_D_"'>0 ""IF "_(DN=3)_""" Q:"_$E("'",DN>1)_"$T  S D"_D_"=$O("_DC_Z_",D"_D_")) Q:D"_D_"'>0"
"RTN","DIS1",35,0)
WP S DQ=DQ_"A",DQ(DL)=DQ I DU'["," S DIS(DQ)="I "_$$XFORM("$G(^(D"_D_",0))")_DV G MAKE
"RTN","DIS1",36,0)
 S O=+$P(^(0),U,2),DK(DL)=O,Z=Z_",D"_D_","
"RTN","DIS1",37,0)
N S DU=$P(DU,",",2,99) G LEV
"RTN","DIS1",38,0)
 ;
"RTN","DIS1",39,0)
M D  S Y=Y_DV D SD G MAKE
"RTN","DIS1",40,0)
VARPOINT .I $P(^DD(O,+DU,0),U,2)["V" S Y="I "_$$XFORM("$$EXTERNAL^DIDU("_O_","_+DU_","""","_Y_")") Q
"RTN","DIS1",41,0)
OUTX .I $D(^(2)),$P(^(0),U,2)'["D",DV'["=" S M=0,Y="S Y="_Y_" "_$$OVFL(^(2))_" I "_$$XFORM("Y") Q  ;**GFT 144
"RTN","DIS1",42,0)
SET .I $D(DIS(U,S)) S Y="S Y="_Y_" I $S(Y="""":"""",$D(DIS(U,"_S_",Y)):DIS(U,"_S_",Y),1:"""")" Q
"RTN","DIS1",43,0)
 .S M=Y,Y="I "_$$XFORM(Y)
"RTN","DIS1",44,0)
 ;
"RTN","DIS1",45,0)
XFORM(Y) I '$D(DIS("XFORM",S)) Q Y
"RTN","DIS1",46,0)
 Q $P(DIS("XFORM",S),";")_Y_$P(DIS("XFORM",S),";",2)
"RTN","DIS1",47,0)
 ;
"RTN","DIS1",48,0)
SD I $D(R(DQ)),R(DQ)>1 S Y="K D "_Y_" S:$T D=1"
"RTN","DIS1",49,0)
 I '$D(DIS(DQ)) S DIS(DQ)=Y Q
"RTN","DIS1",50,0)
 I $L($G(DL(DQ)))*8+$L(DIS(DQ))+$L(Y)>180 S Y=$$OVFL(Y)_" I $T" I $L(Y)+$L(DIS(DQ))>235 S DIS(DQ)=$$OVFL(DIS(DQ))_" I "
"RTN","DIS1",51,0)
 S DIS(DQ)=DIS(DQ)_" "_Y Q
"RTN","DIS1",52,0)
 ;
"RTN","DIS1",53,0)
OVFL(Y) N I,%
"RTN","DIS1",54,0)
 F I=1:1 S %=DQ_"@"_I Q:'$D(DIS(%))
"RTN","DIS1",55,0)
 S DIS(%)=Y Q "X DIS("""_%_""")"
"RTN","DIS1",56,0)
 ;
"RTN","DIS1",57,0)
X S D=DY(-DU),O=+D,DC=U_$P(D,U,2) F %=66:1 S M=DQ_$C(%) Q:'$D(DIS(M))
"RTN","DIS1",58,0)
 I $P(D,U,3) S M=DQ_U_$P(D,U,3),Y="S DIXX="""_M_""" "_$P("X ""I 0"" ^I 1 ",U,DN=3+1)_$P(D,U,4,99)_" I $T",R(M)=DN
"RTN","DIS1",59,0)
 E  S Y=$P(D,U,4,99)_" S D0=D(0) X DIS("""_M_""") S D0=I(0,0) I $T"
"RTN","DIS1",60,0)
 D SD S DQ=M,DI(DL)=DC,DK(DL)=+D,DQ(DL)=DQ,D=0,Z="D0," G N
"RTN","DIS2")
0^12^B8667742^B8500642
"RTN","DIS2",1,0)
DIS2 ;SFISC/GFT-SEARCH, TEMPLATES & COMPUTED FIELDS;4JUN2005
"RTN","DIS2",2,0)
 ;;22.0;VA FileMan;**6,144**;Mar 30, 1999;Build 5
"RTN","DIS2",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIS2",4,0)
 K DISV G G:'DUZ
"RTN","DIS2",5,0)
0 D  K DIRUT,DIROUT I $D(DTOUT)!($D(DUOUT)) G Q
"RTN","DIS2",6,0)
 . N DIS,DIS0,DA,DC,DE,DJ,DL D S3^DIBT1 Q
"RTN","DIS2",7,0)
 I X="" G G:'$D(DIAR)
"RTN","DIS2",8,0)
 I Y<0 G Q:X=U,0
"RTN","DIS2",9,0)
 I $D(DIARU),DIARU-Y=0 W $C(7),!,"Archivers must not store results in the default template" G 0
"RTN","DIS2",10,0)
 S (DIARI,DISV)=+Y,A=$D(^DIBT(DISV,"DL")) S:$D(DIS0)#2 ^("DL")=DIS0 S:$D(DA)#2 ^("DA")=DA S:$D(DJ)#2 ^("DJ")=DJ
"RTN","DIS2",11,0)
 I $D(DIAR),'$D(DIARU) S $P(^DIAR(1.11,DIARC,0),U,3)=DISV
"RTN","DIS2",12,0)
 S Z=-1,DIS0="^DIBT(+Y," F P="DIS","DA","DC","DE","DJ","DL" S %Y=DIS0_""""_P_""",",%X=P_"(" D %XY^%RCR
"RTN","DIS2",13,0)
 S %X="^UTILITY($J,",%Y="^DIBT(DISV,""O"",",@(%X_"0)=U") D %XY^%RCR
"RTN","DIS2",14,0)
G N DISTXT S %X="^UTILITY($J,",%Y="DISTXT(" D %XY^%RCR
"RTN","DIS2",15,0)
 W ! S Y=DI D Q S DIC=Y G EN1^DIP:$D(SF)!$D(L)&'$D(DIAR),EN^DIP
"RTN","DIS2",16,0)
 ;
"RTN","DIS2",17,0)
TEM ;
"RTN","DIS2",18,0)
 K DIC S X=$P($E(X,2,99),"]",1),DIC="^DIBT(",DIC(0)="EQ",DIC("S")="I "_$S($D(DIAR):"$P(^(0),U,8)",1:"'$P(^(0),U,8)")_",$P(^(0),U,4)=DK,$P(^(0),U,5)=DUZ!'$P(^(0),U,5),$D(^(""DIS""))"
"RTN","DIS2",19,0)
 S DIC("W")="X ""F %=1:1 Q:'$D(^DIBT(Y,""""O"""",%,0))  W !?9 S I=^(0) W:$L(I)+$X>79 !?9 W I"""
"RTN","DIS2",20,0)
 D ^DIC K DIC G F^DIS:Y<0
"RTN","DIS2",21,0)
 S P="DIS",Z=-1,%X="^DIBT(+Y,P,",%Y="DIS(" D %XY^%RCR
"RTN","DIS2",22,0)
 S %Y="^UTILITY($J,",P="O" D %XY^%RCR
"RTN","DIS2",23,0)
 G DIS2
"RTN","DIS2",24,0)
 ;
"RTN","DIS2",25,0)
COMP ;
"RTN","DIS2",26,0)
 S E=X,DICMX="X DIS(DIXX)",DICOMP=N_"?",DQI="Y(",DA="DIS("""_$C(DC+64)_DL_"""," I $D(O(DC))[0 S O(DC)=X
"RTN","DIS2",27,0)
 G COLON:X?.E1":"
"RTN","DIS2",28,0)
 I X?.E1":.01",$D(O(DC))[0 S O(DC)=$E(X,1,$L(X)-4)
"RTN","DIS2",29,0)
 D EN^DICOMP,XA G X:'$D(X),X:Y["m" ;I Y["m" S X=E_":" G COMP
"RTN","DIS2",30,0)
 S DA(DC)=X,DU=-DC,E=$E("B",Y["B")_$E("D",Y["D") I Y["p" S E="p"_+$P(Y,"p",2)
"RTN","DIS2",31,0)
 G G^DIS
"RTN","DIS2",32,0)
XA S %=0 F  S %=$O(X(%)) Q:%=""  S @(DA_%_")")=X(%)
"RTN","DIS2",33,0)
 S %=-1 Q
"RTN","DIS2",34,0)
COLON D ^DICOMPW,XA G X:'$D(X)
"RTN","DIS2",35,0)
 S R(DL)=R,N(DL)=N,N=+Y,DY=DY+1,DV(DL)=DV,DL(DL)=DK,DL=DL+1,DV=DV_-DY_C,DY(DY)=DP_U_$S(Y["m":DC_"."_DL,1:"")_U_X,R=U_$P(DP,U,2)
"RTN","DIS2",36,0)
 K X G R^DIS
"RTN","DIS2",37,0)
 ;
"RTN","DIS2",38,0)
Q ;
"RTN","DIS2",39,0)
 K DIC,DA,DX,O,D,DC,DI,DK,DL,DQ,DU,DV,E,DE,DJ,N,P,Z,R,DY,DTOUT,DIRUT,DUOUT,DIROUT,^UTILITY($J)
"RTN","DIS2",40,0)
 Q
"RTN","DIS2",41,0)
 ;
"RTN","DIS2",42,0)
X K O(DC) G X^DIS
"RTN","DIS2",43,0)
 ;
"RTN","DIS2",44,0)
DIS ;PUT SET LOGIC INTO DIS FOR SUBFILE
"RTN","DIS2",45,0)
 S %X="" F %Y=1:1 S %X=$O(DIS(%X)) Q:'%X  S %=$S($D(DIAR(DIARF,%X)):DIAR(DIARF,%X),1:DIS(%X)) S:%["X DIS(" %=$P(%,"X DIS(")_"X DIFG("_DIARF_","_$P(%,"X DIS(",2) S ^DIAR(1.11,DIARC,"S",%Y,0)=%X,^(1)=%
"RTN","DIS2",46,0)
 S:%Y>1 %Y=%Y-1,^DIAR(1.11,DIARC,"S",0)="^1.1132^"_%Y_U_%Y G DIS2
"RTN","DIWW")
0^13^B8555522^B9365261
"RTN","DIWW",1,0)
DIWW ;SFISC/GFT-OUTPUT WP LINE ;02:59 PM  18 Apr 2002
"RTN","DIWW",2,0)
 ;;22.0;VA FileMan;**64,144**;Mar 30, 1999;Build 5
"RTN","DIWW",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIWW",4,0)
 F I=0:1 G:$D(DN) QQ:'DN Q:$D(^UTILITY($J,"W"))<9  D T G:$D(DN) QQ:'DN D 0
"RTN","DIWW",5,0)
T W:$X !
"RTN","DIWW",6,0)
B Q:$S($D(DN):'DN,1:0)  I '$D(DIWF) S DIWF=""
"RTN","DIWW",7,0)
 I '$D(DIOT(2)),$D(IOSL),$Y+$S($P(DIWF,"B",2):$P(DIWF,"B",2),1:2)'<IOSL,$D(^UTILITY($J,1))#2,^(1)?1U1P1E.E X ^(1) I $D(DN),'DN S D0="zzzzzz",W=9999999 Q
"RTN","DIWW",8,0)
 F I=$Y+2:1:+$P(DIWF,"T",2) W !
"RTN","DIWW",9,0)
 Q
"RTN","DIWW",10,0)
 ;
"RTN","DIWW",11,0)
A ;
"RTN","DIWW",12,0)
 D 0 G DIWW
"RTN","DIWW",13,0)
 ;
"RTN","DIWW",14,0)
NX ;
"RTN","DIWW",15,0)
 W:$X+1>DIWL ! D B G:$D(DN) Q:'DN
"RTN","DIWW",16,0)
0 ;
"RTN","DIWW",17,0)
 S I=999999,%="" F  S %=$O(^UTILITY($J,"W",%)) Q:%=""  S:$O(^(%,""))<I I=$O(^(""))
"RTN","DIWW",18,0)
1 S %="" F  S %=$O(^UTILITY($J,"W",%)) Q:%=""  I $D(^(%,I)) D W I $D(^UTILITY($J,"W",%))<9 K ^(%) I $O(^(""))="" K DIWI,DIWX,DIWTC
"RTN","DIWW",19,0)
 S:%="" %=-1 G Q
"RTN","DIWW",20,0)
 ;
"RTN","DIWW",21,0)
W G X:^(I,0)="",O:'$D(DIWF) I DIWF[" " S DIWF=$P(DIWF," ",1)_$P(DIWF," ",2) G X:^(0)?." "
"RTN","DIWW",22,0)
 W:$X+(%>0)>% ! I DIWF["L",$D(^("L")) W $E(^("L")_"   ",1,4)
"RTN","DIWW",23,0)
O W ?%-1,^(0)
"RTN","DIWW",24,0)
X D U:$D(^("U")) I $D(^("X")) S Y=^("X") D K X Y Q
"RTN","DIWW",25,0)
K K ^UTILITY($J,"W",%,I) Q
"RTN","DIWW",26,0)
 ;
"RTN","DIWW",27,0)
U Q:'$D(IOST)  Q:IOST'?1"P".E  W $C(13) F DE=1:1:$S($D(^("L")):%+3,1:%-1) W " "
"RTN","DIWW",28,0)
 S DE=1
"RTN","DIWW",29,0)
UU S %Y=$O(^UTILITY($J,"W",%,I,"U","")) I %Y="" S %Y=$L(^UTILITY($J,"W",%,I,0))+1 S:'$D(DIWFWU) DIWFWU=" " D UUU K DIWFWU Q
"RTN","DIWW",30,0)
 S Y=^(%Y) K ^(%Y) I Y="" D UUU K DIWFWU G UU
"RTN","DIWW",31,0)
 S DIWFWU=Y F DE=DE:1 G UU:DE'<%Y W " "
"RTN","DIWW",32,0)
UUU I $D(DIWFWU) F DE=DE:1 Q:DE'<%Y  W DIWFWU
"RTN","DIWW",33,0)
Q Q
"RTN","DIWW",34,0)
QQ K DIWI,DIWX,DIWTC Q
"RTN","DIWW",35,0)
 ;
"RTN","DIWW",36,0)
RCR ;
"RTN","DIWW",37,0)
 N DA,M,DQI,DA
"RTN","DIWW",38,0)
 F M="DIWX","DICMX","DIC","D","D0","D1","D2","D3","D4","D5","D6","D7","Y","I","J" M %=@M N @M M @M=%
"RTN","DIWW",39,0)
 S DQI="Y(",DA="X(",DICMX="X DICMX",DICOMP="ST" S:$D(DIA("P"))#2 J(0)=DIA("P") D EN1^DICOMP
"RTN","DIWW",40,0)
 I '$D(X) Q:DIWF'["?"!(IO(0)=IO)!$D(IO("C"))  U IO(0) W $C(7),!,$P(@(I(0)_"D0,0)"),U),"---",!?4,$P(DIWX,DIW)_": " R X:DTIME,! U IO G BACK
"RTN","DIWW",41,0)
 I Y["m" S DICMX=$S(Y["w":"D ^DIWP",1:"S DIWX=X,DIWTC=1 D DIW^DIWP S DIWI=$J("""","_$L(DIWI)_")") X X S X="" G BACK
"RTN","DIWW",42,0)
 I Y["X" S X=DIW_X_DIW G BACK
"RTN","DIWW",43,0)
 I $P(DIWX,"SETPAGE(",1)="" S ^(DIWL,^UTILITY($J,"W",DIWL),"X")=X,X="" G BACK
"RTN","DIWW",44,0)
 S DICMX=Y["D" X X I DICMX S Y=X X ^DD("DD") S X=Y
"RTN","DIWW",45,0)
 I $P(DIWX,"INDENT(")="" S X=$J(X,$P(DIWF,"I",2)-$L(DIWI)-1)
"RTN","DIWW",46,0)
BACK D C^DIWP:X]"" S X=""
"RTN","DIWW",47,0)
 Q
"RTN","DIWW",48,0)
 ;
"RTN","DIWW",49,0)
DIQ ;
"RTN","DIWW",50,0)
 S DIWF=$E("N",C["L")_"W|",DIWL=2,DIWR=IOM,X=O_":   " K ^UTILITY($J,"W")
"RTN","DIWW",51,0)
 S W=0 F  D  S W=$O(@(D(DL-1)_"W)")) Q:W'>0!(S=0)  S X=^(W,0)
"RTN","DIWW",52,0)
 .D ^DIWP
"RTN","DIWW",53,0)
 .N W D LF^DIQ
"RTN","DIWW",54,0)
 G DIWW
"RTN","DIWW",55,0)
 ;
"RTN","DIWW",56,0)
H G H^DIO2
"RTN","DIWW",57,0)
DT G DT^DIO2
"RTN","DIWW",58,0)
 ;
"RTN","DIWW",59,0)
N W ! G B
"VER")
8^22.0
"BLD",592,6)
^133
**END**
**END**
