Released PSU*4*4 SEQ #1
Extracted from mail message
**KIDS**:PSU*4.0*4^

**INSTALL NAME**
PSU*4.0*4
"BLD",5483,0)
PSU*4.0*4^PHARMACY BENEFITS MANAGEMENT^0^3050907^y
"BLD",5483,1,0)
^^3^3^3050906^
"BLD",5483,1,1,0)
This patch corrects the IV AMIS Summary report for the Pharmacy 
"BLD",5483,1,2,0)
Benefits Management (PBM) Version 4.0 extract in cases where there is 
"BLD",5483,1,3,0)
very little or no IV data available for the date range of an IV extract.
"BLD",5483,4,0)
^9.64PA^^0
"BLD",5483,"ABPKG")
n
"BLD",5483,"KRN",0)
^9.67PA^8989.52^19
"BLD",5483,"KRN",.4,0)
.4
"BLD",5483,"KRN",.401,0)
.401
"BLD",5483,"KRN",.402,0)
.402
"BLD",5483,"KRN",.403,0)
.403
"BLD",5483,"KRN",.5,0)
.5
"BLD",5483,"KRN",.84,0)
.84
"BLD",5483,"KRN",3.6,0)
3.6
"BLD",5483,"KRN",3.8,0)
3.8
"BLD",5483,"KRN",9.2,0)
9.2
"BLD",5483,"KRN",9.8,0)
9.8
"BLD",5483,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",5483,"KRN",9.8,"NM",1,0)
PSUV3^^0^B9726357
"BLD",5483,"KRN",9.8,"NM",2,0)
PSUV6^^0^B34047613
"BLD",5483,"KRN",9.8,"NM",3,0)
PSUV7^^0^B34147277
"BLD",5483,"KRN",9.8,"NM",4,0)
PSUV8^^0^B34528842
"BLD",5483,"KRN",9.8,"NM",5,0)
PSUV9^^0^B34939396
"BLD",5483,"KRN",9.8,"NM",6,0)
PSUV10^^0^B34787468
"BLD",5483,"KRN",9.8,"NM",7,0)
PSUV12^^0^B81392005
"BLD",5483,"KRN",9.8,"NM","B","PSUV10",6)

"BLD",5483,"KRN",9.8,"NM","B","PSUV12",7)

"BLD",5483,"KRN",9.8,"NM","B","PSUV3",1)

"BLD",5483,"KRN",9.8,"NM","B","PSUV6",2)

"BLD",5483,"KRN",9.8,"NM","B","PSUV7",3)

"BLD",5483,"KRN",9.8,"NM","B","PSUV8",4)

"BLD",5483,"KRN",9.8,"NM","B","PSUV9",5)

"BLD",5483,"KRN",19,0)
19
"BLD",5483,"KRN",19,"NM",0)
^9.68A^^0
"BLD",5483,"KRN",19.1,0)
19.1
"BLD",5483,"KRN",101,0)
101
"BLD",5483,"KRN",409.61,0)
409.61
"BLD",5483,"KRN",771,0)
771
"BLD",5483,"KRN",870,0)
870
"BLD",5483,"KRN",8989.51,0)
8989.51
"BLD",5483,"KRN",8989.52,0)
8989.52
"BLD",5483,"KRN",8994,0)
8994
"BLD",5483,"KRN","B",.4,.4)

"BLD",5483,"KRN","B",.401,.401)

"BLD",5483,"KRN","B",.402,.402)

"BLD",5483,"KRN","B",.403,.403)

"BLD",5483,"KRN","B",.5,.5)

"BLD",5483,"KRN","B",.84,.84)

"BLD",5483,"KRN","B",3.6,3.6)

"BLD",5483,"KRN","B",3.8,3.8)

"BLD",5483,"KRN","B",9.2,9.2)

"BLD",5483,"KRN","B",9.8,9.8)

"BLD",5483,"KRN","B",19,19)

"BLD",5483,"KRN","B",19.1,19.1)

"BLD",5483,"KRN","B",101,101)

"BLD",5483,"KRN","B",409.61,409.61)

"BLD",5483,"KRN","B",771,771)

"BLD",5483,"KRN","B",870,870)

"BLD",5483,"KRN","B",8989.51,8989.51)

"BLD",5483,"KRN","B",8989.52,8989.52)

"BLD",5483,"KRN","B",8994,8994)

"BLD",5483,"QUES",0)
^9.62^^
"BLD",5483,"REQB",0)
^9.611^1^1
"BLD",5483,"REQB",1,0)
PSU 4.0^2
"BLD",5483,"REQB","B","PSU 4.0",1)

"MBREQ")
0
"PKG",367,-1)
1^1
"PKG",367,0)
PHARMACY BENEFITS MANAGEMENT^PSU^PHARMACY BENEFITS MANAGEMENT
"PKG",367,20,0)
^9.402P^^
"PKG",367,22,0)
^9.49I^1^1
"PKG",367,22,1,0)
4.0^3050620^3050831^10000000012
"PKG",367,22,1,"PAH",1,0)
4^3050907
"PKG",367,22,1,"PAH",1,1,0)
^^3^3^3050907
"PKG",367,22,1,"PAH",1,1,1,0)
This patch corrects the IV AMIS Summary report for the Pharmacy 
"PKG",367,22,1,"PAH",1,1,2,0)
Benefits Management (PBM) Version 4.0 extract in cases where there is 
"PKG",367,22,1,"PAH",1,1,3,0)
very little or no IV data available for the date range of an IV extract.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","PSUV10")
0^6^B34787468
"RTN","PSUV10",1,0)
PSUV10 ;BIR/DAM - IV SYRINGE AMIS Summary Data ;11 March 2004
"RTN","PSUV10",2,0)
 ;;4.0;PHARMACY BENEFITS MANAGEMENT;**4**;MARCH, 2005
"RTN","PSUV10",3,0)
 ;
"RTN","PSUV10",4,0)
 ;This routine gathers IV SYRINGE AMIS summary data
"RTN","PSUV10",5,0)
 ;No DBIA's needed
"RTN","PSUV10",6,0)
 ;
"RTN","PSUV10",7,0)
EN ;Entry point to gather AMIS data.  Called from PSUV3
"RTN","PSUV10",8,0)
 ;
"RTN","PSUV10",9,0)
 K PSUIVA      ;Array to hold temporary data
"RTN","PSUV10",10,0)
 ;
"RTN","PSUV10",11,0)
 ;Initialize variables for column totals
"RTN","PSUV10",12,0)
 ;
"RTN","PSUV10",13,0)
 ;
"RTN","PSUV10",14,0)
 S PSUDIV=0
"RTN","PSUV10",15,0)
 S PSUCT=0
"RTN","PSUV10",16,0)
 F  S PSUDIV=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV)) Q:PSUDIV=""  D EN1
"RTN","PSUV10",17,0)
 Q
"RTN","PSUV10",18,0)
 ;
"RTN","PSUV10",19,0)
EN1 ;EN CONTINUED
"RTN","PSUV10",20,0)
 ;
"RTN","PSUV10",21,0)
 S PSUOR=""
"RTN","PSUV10",22,0)
 N LDSP,LREC,LDES,CLAN,NDSP,LTOT,CNDSP
"RTN","PSUV10",23,0)
 F  S PSUCT=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)) Q:PSUCT=""  D
"RTN","PSUV10",24,0)
 .K PSUAMIS
"RTN","PSUV10",25,0)
 .M PSUAMIS(PSUDIV,PSUCT)=^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)
"RTN","PSUV10",26,0)
 .;
"RTN","PSUV10",27,0)
 .S PSUP=""
"RTN","PSUV10",28,0)
 .S PSUP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,5)      ;parent record
"RTN","PSUV10",29,0)
 .;
"RTN","PSUV10",30,0)
 .S PSUTYP=""
"RTN","PSUV10",31,0)
 .S PSUTYP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,6)    ;IV TYPE
"RTN","PSUV10",32,0)
 .;
"RTN","PSUV10",33,0)
 .I PSUTYP="S" S PSUOR=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,4)    ;IV order #
"RTN","PSUV10",34,0)
 .;
"RTN","PSUV10",35,0)
 .D LVPDSP
"RTN","PSUV10",36,0)
 .D LVPREC
"RTN","PSUV10",37,0)
 .D LVPDES
"RTN","PSUV10",38,0)
 .D LVPCAN
"RTN","PSUV10",39,0)
 .D LVPNET
"RTN","PSUV10",40,0)
 .D LVPTOT
"RTN","PSUV10",41,0)
 .D CNET
"RTN","PSUV10",42,0)
 .D REC
"RTN","PSUV10",43,0)
 D TOTAL
"RTN","PSUV10",44,0)
 ;
"RTN","PSUV10",45,0)
 Q
"RTN","PSUV10",46,0)
 ;
"RTN","PSUV10",47,0)
LVPDSP ;Gather SYR Dispensed data
"RTN","PSUV10",48,0)
 ;
"RTN","PSUV10",49,0)
 I PSUTYP="S",PSUP="P" D                         ;SYRs Dispensed
"RTN","PSUV10",50,0)
 .N DSP
"RTN","PSUV10",51,0)
 .S DSP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,29)
"RTN","PSUV10",52,0)
 .S $P(PSUIVA(PSUDIV),U,1)=$P($G(PSUIVA(PSUDIV)),U,1)+DSP
"RTN","PSUV10",53,0)
 ;
"RTN","PSUV10",54,0)
 Q
"RTN","PSUV10",55,0)
 ;
"RTN","PSUV10",56,0)
LVPREC ;Gather SYR Recycled data
"RTN","PSUV10",57,0)
 ;
"RTN","PSUV10",58,0)
 I PSUTYP="S",PSUP="P" D                         ;SYR's recycled
"RTN","PSUV10",59,0)
 .N REC
"RTN","PSUV10",60,0)
 .S REC=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,30)
"RTN","PSUV10",61,0)
 .S $P(PSUIVA(PSUDIV),U,2)=$P($G(PSUIVA(PSUDIV)),U,2)+REC
"RTN","PSUV10",62,0)
 ;
"RTN","PSUV10",63,0)
 Q
"RTN","PSUV10",64,0)
 ;
"RTN","PSUV10",65,0)
LVPDES ;Gather SYR Destroyed data
"RTN","PSUV10",66,0)
 ;
"RTN","PSUV10",67,0)
 I PSUTYP="S",PSUP="P" D                        ;SYR's destroyed
"RTN","PSUV10",68,0)
 .N DES
"RTN","PSUV10",69,0)
 .S DES=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,31)
"RTN","PSUV10",70,0)
 .S $P(PSUIVA(PSUDIV),U,3)=$P($G(PSUIVA(PSUDIV)),U,3)+DES
"RTN","PSUV10",71,0)
 ;
"RTN","PSUV10",72,0)
 Q
"RTN","PSUV10",73,0)
 ;
"RTN","PSUV10",74,0)
LVPCAN ;Gather SYR Cancelled data
"RTN","PSUV10",75,0)
 ;
"RTN","PSUV10",76,0)
 I PSUTYP="S",PSUP="P" D                         ;SYR's cancelled
"RTN","PSUV10",77,0)
 .N CAN
"RTN","PSUV10",78,0)
 .S CAN=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,32)
"RTN","PSUV10",79,0)
 .S $P(PSUIVA(PSUDIV),U,4)=$P($G(PSUIVA(PSUDIV)),U,4)+CAN
"RTN","PSUV10",80,0)
 ;
"RTN","PSUV10",81,0)
 Q
"RTN","PSUV10",82,0)
 ;
"RTN","PSUV10",83,0)
LVPNET ;Calculate net amount of SYR's Dispensed
"RTN","PSUV10",84,0)
 ;
"RTN","PSUV10",85,0)
 ;
"RTN","PSUV10",86,0)
 I PSUTYP="S",PSUP="P" D
"RTN","PSUV10",87,0)
 .N NET
"RTN","PSUV10",88,0)
 .S NET=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,11)
"RTN","PSUV10",89,0)
 .S $P(PSUIVA(PSUDIV),U,5)=$P($G(PSUIVA(PSUDIV)),U,5)+NET
"RTN","PSUV10",90,0)
 Q
"RTN","PSUV10",91,0)
 ;
"RTN","PSUV10",92,0)
LVPTOT ;Calculate Total cost
"RTN","PSUV10",93,0)
 ;
"RTN","PSUV10",94,0)
 N NDIS,COST,PSUOR1
"RTN","PSUV10",95,0)
 S PSUCTA=0
"RTN","PSUV10",96,0)
 F  S PSUCTA=$O(PSUAMIS(PSUDIV,PSUCTA)) Q:PSUCTA=""  D
"RTN","PSUV10",97,0)
 .S PSUOR1=$P(PSUAMIS(PSUDIV,PSUCTA),U,4)
"RTN","PSUV10",98,0)
 .Q:(PSUOR1'=PSUOR)
"RTN","PSUV10",99,0)
 .S NDIS=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,33)
"RTN","PSUV10",100,0)
 .S COST=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,22)
"RTN","PSUV10",101,0)
 .S $P(PSUIVA(PSUDIV),U,6)=$P($G(PSUIVA(PSUDIV)),U,6)+(NDIS*$G(COST))
"RTN","PSUV10",102,0)
 .;
"RTN","PSUV10",103,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV10",104,0)
 .N A,B,C
"RTN","PSUV10",105,0)
 .;
"RTN","PSUV10",106,0)
 .I $P(PSUIVA(PSUDIV),U,6)'["." D  Q
"RTN","PSUV10",107,0)
 ..S $P(PSUIVA(PSUDIV),U,6)=$P(PSUIVA(PSUDIV),U,6)_".00"
"RTN","PSUV10",108,0)
 .;
"RTN","PSUV10",109,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,6),".")  ;Find 1st position after decimal
"RTN","PSUV10",110,0)
 .;
"RTN","PSUV10",111,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,6),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV10",112,0)
 .;
"RTN","PSUV10",113,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,6),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV10",114,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV10",115,0)
 .;
"RTN","PSUV10",116,0)
 .S $P(PSUIVA(PSUDIV),U,6)=B_C
"RTN","PSUV10",117,0)
 Q
"RTN","PSUV10",118,0)
 ;
"RTN","PSUV10",119,0)
CNET ;Calculate Cost per Net SYR's dispensed
"RTN","PSUV10",120,0)
 ;
"RTN","PSUV10",121,0)
 N CNET,TCOST
"RTN","PSUV10",122,0)
 ;
"RTN","PSUV10",123,0)
 S CNET=$P($G(PSUIVA(PSUDIV)),U,5)
"RTN","PSUV10",124,0)
 S TCOST=$P($G(PSUIVA(PSUDIV)),U,6)
"RTN","PSUV10",125,0)
 ;
"RTN","PSUV10",126,0)
 I CNET'="",CNET'=0,TCOST'="" D
"RTN","PSUV10",127,0)
 .S $P(PSUIVA(PSUDIV),U,7)=TCOST/CNET
"RTN","PSUV10",128,0)
 .;
"RTN","PSUV10",129,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV10",130,0)
 .N A,B,C
"RTN","PSUV10",131,0)
 .;
"RTN","PSUV10",132,0)
 .I $P(PSUIVA(PSUDIV),U,7)'["." D  Q
"RTN","PSUV10",133,0)
 ..S $P(PSUIVA(PSUDIV),U,7)=$P(PSUIVA(PSUDIV),U,7)_".00"
"RTN","PSUV10",134,0)
 .;
"RTN","PSUV10",135,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,7),".")  ;Find 1st position after decimal
"RTN","PSUV10",136,0)
 .;
"RTN","PSUV10",137,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,7),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV10",138,0)
 .;
"RTN","PSUV10",139,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,7),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV10",140,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV10",141,0)
 .;
"RTN","PSUV10",142,0)
 .S $P(PSUIVA(PSUDIV),U,7)=B_C
"RTN","PSUV10",143,0)
 ;
"RTN","PSUV10",144,0)
 Q
"RTN","PSUV10",145,0)
 ;
"RTN","PSUV10",146,0)
TOTAL ;Add up column totals and place into ^XTMP global
"RTN","PSUV10",147,0)
 ;
"RTN","PSUV10",148,0)
 S PSUDI=0
"RTN","PSUV10",149,0)
 F  S PSUDI=$O(PSUIVA(PSUDI)) Q:PSUDI=""  D
"RTN","PSUV10",150,0)
 .S LDSP=$G(LDSP)+$P(PSUIVA(PSUDI),U,1)   ;Total SYR's dispensed
"RTN","PSUV10",151,0)
 .;
"RTN","PSUV10",152,0)
 .S LREC=$G(LREC)+$P(PSUIVA(PSUDI),U,2)   ;Total SYR's recycled
"RTN","PSUV10",153,0)
 .;
"RTN","PSUV10",154,0)
 .S LDES=$G(LDES)+$P(PSUIVA(PSUDI),U,3)   ;Total SYR's destroyed
"RTN","PSUV10",155,0)
 .;
"RTN","PSUV10",156,0)
 .S CLAN=$G(CLAN)+$P(PSUIVA(PSUDI),U,4)   ;Total SYR's cancelled
"RTN","PSUV10",157,0)
 .;
"RTN","PSUV10",158,0)
 .S NDSP=$G(NDSP)+$P(PSUIVA(PSUDI),U,5)   ;Total Net SYR's dispensed
"RTN","PSUV10",159,0)
 .;
"RTN","PSUV10",160,0)
 .S LTOT=$G(LTOT)+$P(PSUIVA(PSUDI),U,6)   ;Total of Total cost
"RTN","PSUV10",161,0)
 .;
"RTN","PSUV10",162,0)
 .;S CNDSP=$G(CNDSP)+$P(PSUIVA(PSUDI),U,7) ;Total of cost/net column
"RTN","PSUV10",163,0)
 .I $G(NDSP) S CNDSP=$G(LTOT)/NDSP D
"RTN","PSUV10",164,0)
 ..I CNDSP'["." S CNDSP=CNDSP_".00" Q
"RTN","PSUV10",165,0)
 ..N A,B,C
"RTN","PSUV10",166,0)
 ..S A=$F(CNDSP,".")  ;Find 1st position after decimal
"RTN","PSUV10",167,0)
 ..S B=$E(CNDSP,1,(A-1))   ;Extract dollars and decimal
"RTN","PSUV10",168,0)
 ..S C=$E(CNDSP,A,(A+1))   ;Extract cents after decimal
"RTN","PSUV10",169,0)
 ..I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV10",170,0)
 ..S CNDSP=B_C
"RTN","PSUV10",171,0)
 ;
"RTN","PSUV10",172,0)
 I '$D(LDSP) S LDSP=0
"RTN","PSUV10",173,0)
 I '$D(LREC) S LREC=0
"RTN","PSUV10",174,0)
 I '$D(LDES) S LDES=0
"RTN","PSUV10",175,0)
 I '$D(CLAN) S CLAN=0
"RTN","PSUV10",176,0)
 I '$D(NDSP) S NDSP=0
"RTN","PSUV10",177,0)
 I '$D(LTOT) S LTOT="0.00"
"RTN","PSUV10",178,0)
 I '$D(CNDSP) S CNDSP="0.00"
"RTN","PSUV10",179,0)
 ;
"RTN","PSUV10",180,0)
 S ^XTMP(PSUIVSUB,"SYRTOT")=$G(LDSP)_U_$G(LREC)_U_$G(LDES)_U_$G(CLAN)_U_$G(NDSP)_U_$G(LTOT)_U_$G(CNDSP)
"RTN","PSUV10",181,0)
 ;
"RTN","PSUV10",182,0)
 Q
"RTN","PSUV10",183,0)
 ;
"RTN","PSUV10",184,0)
REC ;Place contents of arrays into ^XTMP globals
"RTN","PSUV10",185,0)
 ;
"RTN","PSUV10",186,0)
 M ^XTMP(PSUIVSUB,"SYR",PSUDIV)=PSUIVA(PSUDIV)   ;SYR RECORDS
"RTN","PSUV10",187,0)
 ;
"RTN","PSUV10",188,0)
 Q
"RTN","PSUV12")
0^7^B81392005
"RTN","PSUV12",1,0)
PSUV12 ;BIR/DAM - IV AMIS Summary Message II ;04 MAR 2004
"RTN","PSUV12",2,0)
 ;;4.0;PHARMACY BENEFITS MANAGEMENT;**4**;MARCH, 2005
"RTN","PSUV12",3,0)
 ;
"RTN","PSUV12",4,0)
 ;No DBIA's required
"RTN","PSUV12",5,0)
 ;
"RTN","PSUV12",6,0)
EN ;Entry point for MailMan message
"RTN","PSUV12",7,0)
 ;Called from PSUV11
"RTN","PSUV12",8,0)
 ;
"RTN","PSUV12",9,0)
 ;Construct IV AMIS summary message
"RTN","PSUV12",10,0)
 ;
"RTN","PSUV12",11,0)
 S Y=PSUSDT X ^DD("DD") S PSUDTS=Y
"RTN","PSUV12",12,0)
 S Y=PSUEDT X ^DD("DD") S PSUDTE=Y
"RTN","PSUV12",13,0)
 S PSUDIV=PSUSNDR D GETDIV^PSUV3
"RTN","PSUV12",14,0)
 S AMIS(1)="IV AMIS Summary for "_PSUDTS_" through "_PSUDTE_" for "_PSUDIVNM
"RTN","PSUV12",15,0)
 ;
"RTN","PSUV12",16,0)
 S AMIS(2)=""     ;Blank line
"RTN","PSUV12",17,0)
 ;
"RTN","PSUV12",18,0)
 I PSUAIS=1 S AMIS(3)="NO IV AMIS Summary data to report" Q
"RTN","PSUV12",19,0)
 ;
"RTN","PSUV12",20,0)
 S AMIS(3)="                                                NET                 Cost/"
"RTN","PSUV12",21,0)
 ;
"RTN","PSUV12",22,0)
 S AMIS(4)="                    LVPs    LVPs   LVPs   LVPs  LVPs       Total    NET LVPs"
"RTN","PSUV12",23,0)
 ;
"RTN","PSUV12",24,0)
 S AMIS(5)="Division            DISP    RET    DES    CAN   DISP       Cost     DISP"
"RTN","PSUV12",25,0)
 ;
"RTN","PSUV12",26,0)
 S $P(AMIS(6),"-",78)=""      ;Separator bar
"RTN","PSUV12",27,0)
 ;
"RTN","PSUV12",28,0)
 S PSULN=7
"RTN","PSUV12",29,0)
 ;
"RTN","PSUV12",30,0)
 ;Construct LVP DATA lines with spacing
"RTN","PSUV12",31,0)
 S PSUDIV=0
"RTN","PSUV12",32,0)
 F  S PSUDIV=$O(LVP(PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUV12",33,0)
 .D GETDIV^PSUV3
"RTN","PSUV12",34,0)
 .S PSULINE=""
"RTN","PSUV12",35,0)
 .S $E(PSULINE,1,17)=PSUDIVNM
"RTN","PSUV12",36,0)
 .S $E(PSULINE,18,24)=$J($P(LVP(PSUDIV),U,1),7)
"RTN","PSUV12",37,0)
 .S $E(PSULINE,25,31)=$J($P(LVP(PSUDIV),U,2),7)
"RTN","PSUV12",38,0)
 .S $E(PSULINE,32,38)=$J($P(LVP(PSUDIV),U,3),7)
"RTN","PSUV12",39,0)
 .S $E(PSULINE,39,45)=$J($P(LVP(PSUDIV),U,4),7)
"RTN","PSUV12",40,0)
 .S $E(PSULINE,46,52)=$J($P(LVP(PSUDIV),U,5),7)
"RTN","PSUV12",41,0)
 .S $E(PSULINE,54,55)="$"
"RTN","PSUV12",42,0)
 .S $E(PSULINE,56,64)=$J($P(LVP(PSUDIV),U,6),9)
"RTN","PSUV12",43,0)
 .S $E(PSULINE,66,67)="$"
"RTN","PSUV12",44,0)
 .S $E(PSULINE,68,75)=$J($P(LVP(PSUDIV),U,7),8)
"RTN","PSUV12",45,0)
 .;End line
"RTN","PSUV12",46,0)
 .S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",47,0)
 ;
"RTN","PSUV12",48,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",49,0)
 ;
"RTN","PSUV12",50,0)
 M LVP("TOT")=^XTMP(PSUIVSUB,"LVPTOT")        ;LVP Totals array
"RTN","PSUV12",51,0)
 ;Construct LVP Totals line
"RTN","PSUV12",52,0)
 S PSULINE=""
"RTN","PSUV12",53,0)
 S $E(PSULINE,1,17)="Total"
"RTN","PSUV12",54,0)
 S $E(PSULINE,18,24)=$J($P(LVP("TOT"),U,1),7)
"RTN","PSUV12",55,0)
 S $E(PSULINE,25,31)=$J($P(LVP("TOT"),U,2),7)
"RTN","PSUV12",56,0)
 S $E(PSULINE,32,38)=$J($P(LVP("TOT"),U,3),7)
"RTN","PSUV12",57,0)
 S $E(PSULINE,39,45)=$J($P(LVP("TOT"),U,4),7)
"RTN","PSUV12",58,0)
 S $E(PSULINE,46,52)=$J($P(LVP("TOT"),U,5),7)
"RTN","PSUV12",59,0)
 S $E(PSULINE,54,55)="$"
"RTN","PSUV12",60,0)
 S $E(PSULINE,56,64)=$J($P(LVP("TOT"),U,6),9)
"RTN","PSUV12",61,0)
 S $E(PSULINE,66,67)="$"
"RTN","PSUV12",62,0)
 S $E(PSULINE,68,75)=$J($P(LVP("TOT"),U,7),8)
"RTN","PSUV12",63,0)
 ;End line
"RTN","PSUV12",64,0)
 S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",65,0)
 ;
"RTN","PSUV12",66,0)
 F PSULN=PSULN:1:(PSULN+4) S AMIS(PSULN)=""     ;Blank lines
"RTN","PSUV12",67,0)
 S PSULN=PSULN+1
"RTN","PSUV12",68,0)
 ;
"RTN","PSUV12",69,0)
 ;
"RTN","PSUV12",70,0)
 S AMIS(PSULN)="                                                NET               Cost/"
"RTN","PSUV12",71,0)
 S PSULN=PSULN+1
"RTN","PSUV12",72,0)
 ;
"RTN","PSUV12",73,0)
 S AMIS(PSULN)="                    IVPBs   IVPBs  IVPBs  IVPBs IVPBs    Total    NET IVPBs"
"RTN","PSUV12",74,0)
 ;
"RTN","PSUV12",75,0)
 S PSULN=PSULN+1
"RTN","PSUV12",76,0)
 S AMIS(PSULN)="Division            DISP    RET    DES    CAN   DISP     Cost     DISP"
"RTN","PSUV12",77,0)
 ;
"RTN","PSUV12",78,0)
 S PSULN=PSULN+1
"RTN","PSUV12",79,0)
 ;
"RTN","PSUV12",80,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",81,0)
 ;
"RTN","PSUV12",82,0)
 ;Construct IVPB DATA lines with spacing
"RTN","PSUV12",83,0)
 S PSUDIV=0
"RTN","PSUV12",84,0)
 F  S PSUDIV=$O(PB(PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUV12",85,0)
 .D GETDIV^PSUV3
"RTN","PSUV12",86,0)
 .S PSULINE=""
"RTN","PSUV12",87,0)
 .S $E(PSULINE,1,17)=PSUDIVNM
"RTN","PSUV12",88,0)
 .S $E(PSULINE,18,24)=$J($P(PB(PSUDIV),U,1),7)
"RTN","PSUV12",89,0)
 .S $E(PSULINE,25,31)=$J($P(PB(PSUDIV),U,2),7)
"RTN","PSUV12",90,0)
 .S $E(PSULINE,32,38)=$J($P(PB(PSUDIV),U,3),7)
"RTN","PSUV12",91,0)
 .S $E(PSULINE,39,45)=$J($P(PB(PSUDIV),U,4),7)
"RTN","PSUV12",92,0)
 .S $E(PSULINE,46,52)=$J($P(PB(PSUDIV),U,5),7)
"RTN","PSUV12",93,0)
 .S $E(PSULINE,54,55)="$"
"RTN","PSUV12",94,0)
 .S $E(PSULINE,56,64)=$J($P(PB(PSUDIV),U,6),9)
"RTN","PSUV12",95,0)
 .S $E(PSULINE,66,67)="$"
"RTN","PSUV12",96,0)
 .S $E(PSULINE,68,75)=$J($P(PB(PSUDIV),U,7),8)
"RTN","PSUV12",97,0)
 .;End line
"RTN","PSUV12",98,0)
 .S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",99,0)
 ;
"RTN","PSUV12",100,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",101,0)
 ;
"RTN","PSUV12",102,0)
 M PB("TOT")=^XTMP(PSUIVSUB,"PBTOT")        ;IVPB Totals array
"RTN","PSUV12",103,0)
 ;Construct PB Totals line
"RTN","PSUV12",104,0)
 S PSULINE=""
"RTN","PSUV12",105,0)
 S $E(PSULINE,1,17)="Total"
"RTN","PSUV12",106,0)
 S $E(PSULINE,18,24)=$J($P(PB("TOT"),U,1),7)
"RTN","PSUV12",107,0)
 S $E(PSULINE,25,31)=$J($P(PB("TOT"),U,2),7)
"RTN","PSUV12",108,0)
 S $E(PSULINE,32,38)=$J($P(PB("TOT"),U,3),7)
"RTN","PSUV12",109,0)
 S $E(PSULINE,39,45)=$J($P(PB("TOT"),U,4),7)
"RTN","PSUV12",110,0)
 S $E(PSULINE,46,52)=$J($P(PB("TOT"),U,5),7)
"RTN","PSUV12",111,0)
 S $E(PSULINE,54,55)="$"
"RTN","PSUV12",112,0)
 S $E(PSULINE,56,64)=$J($P(PB("TOT"),U,6),9)
"RTN","PSUV12",113,0)
 S $E(PSULINE,66,67)="$"
"RTN","PSUV12",114,0)
 S $E(PSULINE,68,75)=$J($P(PB("TOT"),U,7),8)
"RTN","PSUV12",115,0)
 ;End line
"RTN","PSUV12",116,0)
 S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",117,0)
 ;
"RTN","PSUV12",118,0)
 F PSULN=PSULN:1:(PSULN+4) S AMIS(PSULN)=""     ;Blank lines
"RTN","PSUV12",119,0)
 S PSULN=PSULN+1
"RTN","PSUV12",120,0)
 ;
"RTN","PSUV12",121,0)
 S AMIS(PSULN)="                                                NET               Cost/"
"RTN","PSUV12",122,0)
 S PSULN=PSULN+1
"RTN","PSUV12",123,0)
 ;
"RTN","PSUV12",124,0)
 S AMIS(PSULN)="                   TPNs    TPNs    TPNs   TPNs  TPNs     Total    NET TPNs"
"RTN","PSUV12",125,0)
 ;
"RTN","PSUV12",126,0)
 S PSULN=PSULN+1
"RTN","PSUV12",127,0)
 S AMIS(PSULN)="Division           DISP    RET     DES    CAN   DISP     Cost     DISP"
"RTN","PSUV12",128,0)
 ;
"RTN","PSUV12",129,0)
 S PSULN=PSULN+1
"RTN","PSUV12",130,0)
 ;
"RTN","PSUV12",131,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",132,0)
 ;
"RTN","PSUV12",133,0)
 ;Construct TPN DATA lines with spacing
"RTN","PSUV12",134,0)
 S PSUDIV=0
"RTN","PSUV12",135,0)
 F  S PSUDIV=$O(TPN(PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUV12",136,0)
 .D GETDIV^PSUV3
"RTN","PSUV12",137,0)
 .S PSULINE=""
"RTN","PSUV12",138,0)
 .S $E(PSULINE,1,17)=PSUDIVNM
"RTN","PSUV12",139,0)
 .S $E(PSULINE,18,24)=$J($P(TPN(PSUDIV),U,1),7)
"RTN","PSUV12",140,0)
 .S $E(PSULINE,25,31)=$J($P(TPN(PSUDIV),U,2),7)
"RTN","PSUV12",141,0)
 .S $E(PSULINE,32,38)=$J($P(TPN(PSUDIV),U,3),7)
"RTN","PSUV12",142,0)
 .S $E(PSULINE,39,45)=$J($P(TPN(PSUDIV),U,4),7)
"RTN","PSUV12",143,0)
 .S $E(PSULINE,46,52)=$J($P(TPN(PSUDIV),U,5),7)
"RTN","PSUV12",144,0)
 .S $E(PSULINE,54,55)="$"
"RTN","PSUV12",145,0)
 .S $E(PSULINE,56,64)=$J($P(TPN(PSUDIV),U,6),9)
"RTN","PSUV12",146,0)
 .S $E(PSULINE,66,67)="$"
"RTN","PSUV12",147,0)
 .S $E(PSULINE,68,75)=$J($P(TPN(PSUDIV),U,7),8)
"RTN","PSUV12",148,0)
 .;End line
"RTN","PSUV12",149,0)
 .S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",150,0)
 ;
"RTN","PSUV12",151,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",152,0)
 ;
"RTN","PSUV12",153,0)
 M TPN("TOT")=^XTMP(PSUIVSUB,"TPNTOT")        ;TPN Totals array
"RTN","PSUV12",154,0)
 ;Construct TPN Totals line
"RTN","PSUV12",155,0)
 S PSULINE=""
"RTN","PSUV12",156,0)
 S $E(PSULINE,1,17)="Total"
"RTN","PSUV12",157,0)
 S $E(PSULINE,18,24)=$J($P(TPN("TOT"),U,1),7)
"RTN","PSUV12",158,0)
 S $E(PSULINE,25,31)=$J($P(TPN("TOT"),U,2),7)
"RTN","PSUV12",159,0)
 S $E(PSULINE,32,38)=$J($P(TPN("TOT"),U,3),7)
"RTN","PSUV12",160,0)
 S $E(PSULINE,39,45)=$J($P(TPN("TOT"),U,4),7)
"RTN","PSUV12",161,0)
 S $E(PSULINE,46,52)=$J($P(TPN("TOT"),U,5),7)
"RTN","PSUV12",162,0)
 S $E(PSULINE,54,55)="$"
"RTN","PSUV12",163,0)
 S $E(PSULINE,56,64)=$J($P(TPN("TOT"),U,6),9)
"RTN","PSUV12",164,0)
 S $E(PSULINE,66,67)="$"
"RTN","PSUV12",165,0)
 S $E(PSULINE,68,75)=$J($P(TPN("TOT"),U,7),8)
"RTN","PSUV12",166,0)
 ;End line
"RTN","PSUV12",167,0)
 S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",168,0)
 ;
"RTN","PSUV12",169,0)
 F PSULN=PSULN:1:(PSULN+4) S AMIS(PSULN)=""     ;Blank lines
"RTN","PSUV12",170,0)
 S PSULN=PSULN+1
"RTN","PSUV12",171,0)
 ;
"RTN","PSUV12",172,0)
 S AMIS(PSULN)="                                                NET               Cost/"
"RTN","PSUV12",173,0)
 S PSULN=PSULN+1
"RTN","PSUV12",174,0)
 ;
"RTN","PSUV12",175,0)
 S AMIS(PSULN)="                    CHEMO   CHEMO  CHEMO  CHEMO CHEMO     Total   NET CHEMOs"
"RTN","PSUV12",176,0)
 ;
"RTN","PSUV12",177,0)
 S PSULN=PSULN+1
"RTN","PSUV12",178,0)
 S AMIS(PSULN)="Division            DISP    RET    DES    CAN   DISP      Cost    DISP"
"RTN","PSUV12",179,0)
 ;
"RTN","PSUV12",180,0)
 S PSULN=PSULN+1
"RTN","PSUV12",181,0)
 ;
"RTN","PSUV12",182,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",183,0)
 ;
"RTN","PSUV12",184,0)
 ;Construct CHEMO DATA lines with spacing
"RTN","PSUV12",185,0)
 S PSUDIV=0
"RTN","PSUV12",186,0)
 F  S PSUDIV=$O(CH(PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUV12",187,0)
 .D GETDIV^PSUV3
"RTN","PSUV12",188,0)
 .S PSULINE=""
"RTN","PSUV12",189,0)
 .S $E(PSULINE,1,17)=PSUDIVNM
"RTN","PSUV12",190,0)
 .S $E(PSULINE,18,24)=$J($P(CH(PSUDIV),U,1),7)
"RTN","PSUV12",191,0)
 .S $E(PSULINE,25,31)=$J($P(CH(PSUDIV),U,2),7)
"RTN","PSUV12",192,0)
 .S $E(PSULINE,32,38)=$J($P(CH(PSUDIV),U,3),7)
"RTN","PSUV12",193,0)
 .S $E(PSULINE,39,45)=$J($P(CH(PSUDIV),U,4),7)
"RTN","PSUV12",194,0)
 .S $E(PSULINE,46,52)=$J($P(CH(PSUDIV),U,5),7)
"RTN","PSUV12",195,0)
 .S $E(PSULINE,54,55)="$"
"RTN","PSUV12",196,0)
 .S $E(PSULINE,56,64)=$J($P(CH(PSUDIV),U,6),9)
"RTN","PSUV12",197,0)
 .S $E(PSULINE,66,67)="$"
"RTN","PSUV12",198,0)
 .S $E(PSULINE,68,75)=$J($P(CH(PSUDIV),U,7),8)
"RTN","PSUV12",199,0)
 .;End line
"RTN","PSUV12",200,0)
 .S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",201,0)
 ;
"RTN","PSUV12",202,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",203,0)
 ;
"RTN","PSUV12",204,0)
 M CH("TOT")=^XTMP(PSUIVSUB,"CHTOT")        ;CHEMO Totals array
"RTN","PSUV12",205,0)
 ;Construct CHEMO Totals line
"RTN","PSUV12",206,0)
 S PSULINE=""
"RTN","PSUV12",207,0)
 S $E(PSULINE,1,17)="Total"
"RTN","PSUV12",208,0)
 S $E(PSULINE,18,24)=$J($P(CH("TOT"),U,1),7)
"RTN","PSUV12",209,0)
 S $E(PSULINE,25,31)=$J($P(CH("TOT"),U,2),7)
"RTN","PSUV12",210,0)
 S $E(PSULINE,32,38)=$J($P(CH("TOT"),U,3),7)
"RTN","PSUV12",211,0)
 S $E(PSULINE,39,45)=$J($P(CH("TOT"),U,4),7)
"RTN","PSUV12",212,0)
 S $E(PSULINE,46,52)=$J($P(CH("TOT"),U,5),7)
"RTN","PSUV12",213,0)
 S $E(PSULINE,54,55)="$"
"RTN","PSUV12",214,0)
 S $E(PSULINE,56,64)=$J($P(CH("TOT"),U,6),9)
"RTN","PSUV12",215,0)
 S $E(PSULINE,66,67)="$"
"RTN","PSUV12",216,0)
 S $E(PSULINE,68,75)=$J($P(CH("TOT"),U,7),8)
"RTN","PSUV12",217,0)
 ;End line
"RTN","PSUV12",218,0)
 S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",219,0)
 ;
"RTN","PSUV12",220,0)
 F PSULN=PSULN:1:(PSULN+4) S AMIS(PSULN)=""     ;Blank lines
"RTN","PSUV12",221,0)
 S PSULN=PSULN+1
"RTN","PSUV12",222,0)
 ;
"RTN","PSUV12",223,0)
 ;
"RTN","PSUV12",224,0)
 S AMIS(PSULN)="                                                NET               Cost/"
"RTN","PSUV12",225,0)
 S PSULN=PSULN+1
"RTN","PSUV12",226,0)
 ;
"RTN","PSUV12",227,0)
 S AMIS(PSULN)="                   SYRs    SYRs   SYRs   SYRs   SYRs     Total    NET SYRs"
"RTN","PSUV12",228,0)
 ;
"RTN","PSUV12",229,0)
 S PSULN=PSULN+1
"RTN","PSUV12",230,0)
 S AMIS(PSULN)="Division           DISP    RET    DES    CAN    DISP     Cost     DISP"
"RTN","PSUV12",231,0)
 ;
"RTN","PSUV12",232,0)
 S PSULN=PSULN+1
"RTN","PSUV12",233,0)
 ;
"RTN","PSUV12",234,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",235,0)
 ;
"RTN","PSUV12",236,0)
 ;Construct SYRINGE DATA lines with spacing
"RTN","PSUV12",237,0)
 S PSUDIV=0
"RTN","PSUV12",238,0)
 F  S PSUDIV=$O(SYR(PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUV12",239,0)
 .D GETDIV^PSUV3
"RTN","PSUV12",240,0)
 .S PSULINE=""
"RTN","PSUV12",241,0)
 .S $E(PSULINE,1,17)=PSUDIVNM
"RTN","PSUV12",242,0)
 .S $E(PSULINE,18,24)=$J($P(SYR(PSUDIV),U,1),7)
"RTN","PSUV12",243,0)
 .S $E(PSULINE,25,31)=$J($P(SYR(PSUDIV),U,2),7)
"RTN","PSUV12",244,0)
 .S $E(PSULINE,32,38)=$J($P(SYR(PSUDIV),U,3),7)
"RTN","PSUV12",245,0)
 .S $E(PSULINE,39,45)=$J($P(SYR(PSUDIV),U,4),7)
"RTN","PSUV12",246,0)
 .S $E(PSULINE,46,52)=$J($P(SYR(PSUDIV),U,5),7)
"RTN","PSUV12",247,0)
 .S $E(PSULINE,54,55)="$"
"RTN","PSUV12",248,0)
 .S $E(PSULINE,56,64)=$J($P(SYR(PSUDIV),U,6),9)
"RTN","PSUV12",249,0)
 .S $E(PSULINE,66,67)="$"
"RTN","PSUV12",250,0)
 .S $E(PSULINE,68,75)=$J($P(SYR(PSUDIV),U,7),8)
"RTN","PSUV12",251,0)
 .;End line
"RTN","PSUV12",252,0)
 .S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",253,0)
 ;
"RTN","PSUV12",254,0)
 S $P(AMIS(PSULN),"-",78)="" S PSULN=PSULN+1      ;Separator bar
"RTN","PSUV12",255,0)
 ;
"RTN","PSUV12",256,0)
 M SYR("TOT")=^XTMP(PSUIVSUB,"SYRTOT")        ;SYRINGE Totals array
"RTN","PSUV12",257,0)
 ;Construct SYRINGE Totals line
"RTN","PSUV12",258,0)
 S PSULINE=""
"RTN","PSUV12",259,0)
 S $E(PSULINE,1,17)="Total"
"RTN","PSUV12",260,0)
 S $E(PSULINE,18,24)=$J($P(SYR("TOT"),U,1),7)
"RTN","PSUV12",261,0)
 S $E(PSULINE,25,31)=$J($P(SYR("TOT"),U,2),7)
"RTN","PSUV12",262,0)
 S $E(PSULINE,32,38)=$J($P(SYR("TOT"),U,3),7)
"RTN","PSUV12",263,0)
 S $E(PSULINE,39,45)=$J($P(SYR("TOT"),U,4),7)
"RTN","PSUV12",264,0)
 S $E(PSULINE,46,52)=$J($P(SYR("TOT"),U,5),7)
"RTN","PSUV12",265,0)
 S $E(PSULINE,54,55)="$"
"RTN","PSUV12",266,0)
 S $E(PSULINE,56,64)=$J($P(SYR("TOT"),U,6),9)
"RTN","PSUV12",267,0)
 S $E(PSULINE,66,67)="$"
"RTN","PSUV12",268,0)
 S $E(PSULINE,68,75)=$J($P(SYR("TOT"),U,7),8)
"RTN","PSUV12",269,0)
 ;End line
"RTN","PSUV12",270,0)
 S AMIS(PSULN)=PSULINE S PSULN=PSULN+1
"RTN","PSUV12",271,0)
 ;
"RTN","PSUV12",272,0)
 F PSULN=PSULN:1:(PSULN+4) S AMIS(PSULN)=""     ;Blank lines
"RTN","PSUV12",273,0)
 S PSULN=PSULN+1
"RTN","PSUV12",274,0)
 Q
"RTN","PSUV3")
0^1^B9726357
"RTN","PSUV3",1,0)
PSUV3 ;BIR/CFL - Create mailman messages ;10 JUL 1999
"RTN","PSUV3",2,0)
 ;;4.0;PHARMACY BENEFITS MANAGEMENT;**4**;MARCH, 2005
"RTN","PSUV3",3,0)
 ;DBIAs
"RTN","PSUV3",4,0)
 ; Reference to file #4.3  supported by DBIA 2496
"RTN","PSUV3",5,0)
 ; Reference to file #40.8 supported by DBIA 2438
"RTN","PSUV3",6,0)
 ;
"RTN","PSUV3",7,0)
EN(PSUMSGT) ;
"RTN","PSUV3",8,0)
 ;
"RTN","PSUV3",9,0)
 S PSUNOREC="",NONE="",PSUAIS=""
"RTN","PSUV3",10,0)
 S PSUMSGT("M")=0,PSUMSGT("L")=0
"RTN","PSUV3",11,0)
 I '$D(^XTMP(PSUIVSUB,"RECORDS")) D NODATA Q  ;Do not go any further if there is no data to report
"RTN","PSUV3",12,0)
 I '$D(^XTMP("PSU_"_PSUJOB,"PSUFLAG")) D AMIS
"RTN","PSUV3",13,0)
 S PSUDIV=0,Z=0
"RTN","PSUV3",14,0)
 F  S PSUDIV=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUV3",15,0)
 .I PSUSMRY=1 D GETDIV Q  ;Print only the summary report
"RTN","PSUV3",16,0)
 .I $G(PSUMASF)!$G(PSUDUZ)!$G(PSUPBMG) D XMD,SETCNT
"RTN","PSUV3",17,0)
 .D GETDIV
"RTN","PSUV3",18,0)
 .D DRUGSUM^PSUV4
"RTN","PSUV3",19,0)
 Q
"RTN","PSUV3",20,0)
 ;
"RTN","PSUV3",21,0)
AMIS ;AMIS SUMMARY
"RTN","PSUV3",22,0)
 D EN^PSUV6    ;LVP AMIS Summary Data
"RTN","PSUV3",23,0)
 D EN^PSUV7    ;PB AMIS Summary Data
"RTN","PSUV3",24,0)
 D EN^PSUV8    ;TPN AMIS Summary Data
"RTN","PSUV3",25,0)
 D EN^PSUV9    ;CHEMO AMIS Summary Data
"RTN","PSUV3",26,0)
 D EN^PSUV10   ;SYRINGE AMIS Summary Data
"RTN","PSUV3",27,0)
 Q
"RTN","PSUV3",28,0)
XMD ;
"RTN","PSUV3",29,0)
 ;
"RTN","PSUV3",30,0)
 NEW PSUMAX,PSULC,PSUTMC,PSUTLC,PSUMC
"RTN","PSUV3",31,0)
 S PSUMAX=$$VAL^PSUTL(4.3,1,8.3)
"RTN","PSUV3",32,0)
 S PSUMAX=$S(PSUMAX="":10000,PSUMAX>10000:10000,1:PSUMAX)
"RTN","PSUV3",33,0)
 K ^XTMP(PSUIVSUB,"XMD")
"RTN","PSUV3",34,0)
 S PSUMC=1,PSUMLC=0
"RTN","PSUV3",35,0)
 F PSULC=1:1 S X=$G(^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSULC)) Q:X=""  D
"RTN","PSUV3",36,0)
 .S PSUMLC=PSUMLC+1
"RTN","PSUV3",37,0)
 .I PSUMLC>PSUMAX S PSUMC=PSUMC+1,PSUMLC=0,PSULC=PSULC-1 Q  ; +  message
"RTN","PSUV3",38,0)
 .I $L(X)<235 S ^XTMP(PSUIVSUB,"XMD",PSUMC,PSUMLC)=X Q
"RTN","PSUV3",39,0)
 .F I=235:-1:1 S Z=$E(X,I) Q:Z="^"
"RTN","PSUV3",40,0)
 .S ^XTMP(PSUIVSUB,"XMD",PSUMC,PSUMLC)=$E(X,1,I)
"RTN","PSUV3",41,0)
 .S PSUMLC=PSUMLC+1
"RTN","PSUV3",42,0)
 .S ^XTMP(PSUIVSUB,"XMD",PSUMC,PSUMLC)="*"_$E(X,I+1,999)
"RTN","PSUV3",43,0)
 ;
"RTN","PSUV3",44,0)
 ;   Count Lines sent
"RTN","PSUV3",45,0)
 S PSUTLC=0
"RTN","PSUV3",46,0)
 F PSUM=1:1:PSUMC S X=$O(^XTMP(PSUIVSUB,"XMD",PSUM,""),-1),PSUTLC=PSUTLC+X
"RTN","PSUV3",47,0)
 ;
"RTN","PSUV3",48,0)
 ;   Transmit Messages
"RTN","PSUV3",49,0)
VARS ; Setup variables for contents
"RTN","PSUV3",50,0)
 F PSUM=1:1:PSUMC D
"RTN","PSUV3",51,0)
 .D GETDIV
"RTN","PSUV3",52,0)
 .S XMSUB="V. 4.0 PBMIV "_PSUMON_" "_PSUM_"/"_PSUMC_" "_PSUDIV_" "_PSUDIVNM
"RTN","PSUV3",53,0)
 .S XMTEXT="^XTMP(PSUIVSUB,""XMD"",PSUM,"
"RTN","PSUV3",54,0)
 .S XMCHAN=1
"RTN","PSUV3",55,0)
 .S XMDUZ=DUZ
"RTN","PSUV3",56,0)
 .M XMY=PSUXMYH
"RTN","PSUV3",57,0)
 .D ^XMD
"RTN","PSUV3",58,0)
 ;
"RTN","PSUV3",59,0)
 I NONE S PSUTLC=0
"RTN","PSUV3",60,0)
 S PSUMSG("M")=PSUMC
"RTN","PSUV3",61,0)
 S PSUMSG("L")=PSUTLC
"RTN","PSUV3",62,0)
 Q
"RTN","PSUV3",63,0)
NODATA ;Send "No data to report" message
"RTN","PSUV3",64,0)
 S PSUDIV=PSUSNDR
"RTN","PSUV3",65,0)
 S ^XTMP(PSUIVSUB,"RECORDS",PSUDIV,1)="No data to report" S PSUAIS=1
"RTN","PSUV3",66,0)
 S NONE=1
"RTN","PSUV3",67,0)
 S ^XTMP("PSU_"_PSUJOB,"PSUNONE","IV")=""
"RTN","PSUV3",68,0)
 M PSUXMYH=PSUXMYS1
"RTN","PSUV3",69,0)
 D XMD
"RTN","PSUV3",70,0)
SETCNT ;Set message count and line count
"RTN","PSUV3",71,0)
 S PSUMSGT(PSUDIV,"M")=$G(PSUMSGT(PSUDIV,"M"))+PSUMSG("M")
"RTN","PSUV3",72,0)
 S PSUMSGT(PSUDIV,"L")=$G(PSUMSGT(PSUDIV,"L"))+PSUMSG("L")
"RTN","PSUV3",73,0)
 S ^XTMP("PSU_"_PSUJOB,"CONFIRM",PSUDIV,PSUOPTN,"M")=PSUMSGT(PSUDIV,"M")
"RTN","PSUV3",74,0)
 S ^XTMP("PSU_"_PSUJOB,"CONFIRM",PSUDIV,PSUOPTN,"L")=PSUMSGT(PSUDIV,"L")
"RTN","PSUV3",75,0)
 Q
"RTN","PSUV3",76,0)
GETDIV ;get division name
"RTN","PSUV3",77,0)
 S X=PSUDIV,DIC=40.8,DIC(0)="X",D="C" D IX^DIC ;**1
"RTN","PSUV3",78,0)
 S X=+Y S PSUDIVNM=$$VAL^PSUTL(40.8,X,.01)
"RTN","PSUV3",79,0)
 S ^XTMP("PSU_"_PSUJOB,"DIV",PSUDIV)=PSUDIVNM
"RTN","PSUV3",80,0)
 Q
"RTN","PSUV6")
0^2^B34047613
"RTN","PSUV6",1,0)
PSUV6 ;BIR/DAM - IV LVP AMIS Summary Data ;11 March 2004
"RTN","PSUV6",2,0)
 ;;4.0;PHARMACY BENEFITS MANAGEMENT;**4**;MARCH, 2005
"RTN","PSUV6",3,0)
 ;
"RTN","PSUV6",4,0)
 ;This routine gathers IV LVP AMIS Summary data
"RTN","PSUV6",5,0)
 ;No DBIA's needed
"RTN","PSUV6",6,0)
 ;
"RTN","PSUV6",7,0)
EN ;Entry point to gather AMIS data.  Called from PSUV3
"RTN","PSUV6",8,0)
 ;
"RTN","PSUV6",9,0)
 K PSUIVA      ;Array to hold temporary data
"RTN","PSUV6",10,0)
 ;Initialize variables for column totals
"RTN","PSUV6",11,0)
 ;
"RTN","PSUV6",12,0)
 ;
"RTN","PSUV6",13,0)
 S PSUDIV=0
"RTN","PSUV6",14,0)
 S PSUCT=0
"RTN","PSUV6",15,0)
 F  S PSUDIV=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV)) Q:PSUDIV=""  D EN1
"RTN","PSUV6",16,0)
 Q
"RTN","PSUV6",17,0)
 ;
"RTN","PSUV6",18,0)
EN1 ;EN CONTINUED
"RTN","PSUV6",19,0)
 ;
"RTN","PSUV6",20,0)
 S PSUOR=""
"RTN","PSUV6",21,0)
 N LDSP,LREC,LDES,CLAN,NDSP,LTOT,CNDSP
"RTN","PSUV6",22,0)
 F  S PSUCT=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)) Q:PSUCT=""  D
"RTN","PSUV6",23,0)
 .K PSUAMIS
"RTN","PSUV6",24,0)
 .M PSUAMIS(PSUDIV,PSUCT)=^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)
"RTN","PSUV6",25,0)
 .;
"RTN","PSUV6",26,0)
 .S PSUP=""
"RTN","PSUV6",27,0)
 .S PSUP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,5)      ;Parent record
"RTN","PSUV6",28,0)
 .;
"RTN","PSUV6",29,0)
 .S PSUTYP=""
"RTN","PSUV6",30,0)
 .S PSUTYP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,6)    ;IV TYPE
"RTN","PSUV6",31,0)
 .;
"RTN","PSUV6",32,0)
 .I PSUTYP="A" S PSUOR=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,4)    ;IV order
"RTN","PSUV6",33,0)
 .D LVPDSP
"RTN","PSUV6",34,0)
 .D LVPREC
"RTN","PSUV6",35,0)
 .D LVPDES
"RTN","PSUV6",36,0)
 .D LVPCAN
"RTN","PSUV6",37,0)
 .D LVPNET
"RTN","PSUV6",38,0)
 .D LVPTOT
"RTN","PSUV6",39,0)
 .D CNET
"RTN","PSUV6",40,0)
 .D REC
"RTN","PSUV6",41,0)
 D TOTAL
"RTN","PSUV6",42,0)
 ;
"RTN","PSUV6",43,0)
 Q
"RTN","PSUV6",44,0)
 ;
"RTN","PSUV6",45,0)
LVPDSP ;Gather LVP Dispensed data
"RTN","PSUV6",46,0)
 ;
"RTN","PSUV6",47,0)
 I PSUTYP="A",PSUP="P" D                         ;LVPs Dispensed
"RTN","PSUV6",48,0)
 .N DSP
"RTN","PSUV6",49,0)
 .S DSP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,29)
"RTN","PSUV6",50,0)
 .S $P(PSUIVA(PSUDIV),U,1)=$P($G(PSUIVA(PSUDIV)),U,1)+DSP
"RTN","PSUV6",51,0)
 ;
"RTN","PSUV6",52,0)
 Q
"RTN","PSUV6",53,0)
 ;
"RTN","PSUV6",54,0)
LVPREC ;Gather LVP Recycled data
"RTN","PSUV6",55,0)
 ;
"RTN","PSUV6",56,0)
 I PSUTYP="A",PSUP="P" D                         ;LVP's recycled
"RTN","PSUV6",57,0)
 .N REC
"RTN","PSUV6",58,0)
 .S REC=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,30)
"RTN","PSUV6",59,0)
 .S $P(PSUIVA(PSUDIV),U,2)=$P($G(PSUIVA(PSUDIV)),U,2)+REC
"RTN","PSUV6",60,0)
 ;
"RTN","PSUV6",61,0)
 Q
"RTN","PSUV6",62,0)
 ;
"RTN","PSUV6",63,0)
LVPDES ;Gather LVP Destroyed data
"RTN","PSUV6",64,0)
 ;
"RTN","PSUV6",65,0)
 I PSUTYP="A",PSUP="P" D                        ;LVP's destroyed
"RTN","PSUV6",66,0)
 .N DES
"RTN","PSUV6",67,0)
 .S DES=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,31)
"RTN","PSUV6",68,0)
 .S $P(PSUIVA(PSUDIV),U,3)=$P($G(PSUIVA(PSUDIV)),U,3)+DES
"RTN","PSUV6",69,0)
 ;
"RTN","PSUV6",70,0)
 Q
"RTN","PSUV6",71,0)
 ;
"RTN","PSUV6",72,0)
LVPCAN ;Gather LvP Cancelled data
"RTN","PSUV6",73,0)
 ;
"RTN","PSUV6",74,0)
 I PSUTYP="A",PSUP="P" D                         ;LVP's cancelled
"RTN","PSUV6",75,0)
 .N CAN
"RTN","PSUV6",76,0)
 .S CAN=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,32)
"RTN","PSUV6",77,0)
 .S $P(PSUIVA(PSUDIV),U,4)=$P($G(PSUIVA(PSUDIV)),U,4)+CAN
"RTN","PSUV6",78,0)
 ;
"RTN","PSUV6",79,0)
 Q
"RTN","PSUV6",80,0)
 ;
"RTN","PSUV6",81,0)
LVPNET ;Calculate net amount of LVP's Dispensed
"RTN","PSUV6",82,0)
 ;
"RTN","PSUV6",83,0)
 ;
"RTN","PSUV6",84,0)
 I PSUTYP="A",PSUP="P" D
"RTN","PSUV6",85,0)
 .N NET
"RTN","PSUV6",86,0)
 .S NET=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,11)
"RTN","PSUV6",87,0)
 .S $P(PSUIVA(PSUDIV),U,5)=$P($G(PSUIVA(PSUDIV)),U,5)+NET
"RTN","PSUV6",88,0)
 ;
"RTN","PSUV6",89,0)
 Q
"RTN","PSUV6",90,0)
 ;
"RTN","PSUV6",91,0)
LVPTOT ;Calculate Total cost
"RTN","PSUV6",92,0)
 ;
"RTN","PSUV6",93,0)
 N NDIS,COST,PSUOR1
"RTN","PSUV6",94,0)
 S PSUCTA=0
"RTN","PSUV6",95,0)
 F  S PSUCTA=$O(PSUAMIS(PSUDIV,PSUCTA)) Q:PSUCTA=""  D
"RTN","PSUV6",96,0)
 .S PSUOR1=$P(PSUAMIS(PSUDIV,PSUCTA),U,4)
"RTN","PSUV6",97,0)
 .Q:(PSUOR1'=PSUOR)
"RTN","PSUV6",98,0)
 .S NDIS=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,33)
"RTN","PSUV6",99,0)
 .S COST=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,22)
"RTN","PSUV6",100,0)
 .S $P(PSUIVA(PSUDIV),U,6)=$P($G(PSUIVA(PSUDIV)),U,6)+(NDIS*$G(COST))
"RTN","PSUV6",101,0)
 .;
"RTN","PSUV6",102,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV6",103,0)
 .N A,B,C
"RTN","PSUV6",104,0)
 .;
"RTN","PSUV6",105,0)
 .I $P(PSUIVA(PSUDIV),U,6)'["." D  Q
"RTN","PSUV6",106,0)
 ..S $P(PSUIVA(PSUDIV),U,6)=$P(PSUIVA(PSUDIV),U,6)_".00"
"RTN","PSUV6",107,0)
 .;
"RTN","PSUV6",108,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,6),".")  ;Find 1st position after decimal
"RTN","PSUV6",109,0)
 .;
"RTN","PSUV6",110,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,6),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV6",111,0)
 .;
"RTN","PSUV6",112,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,6),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV6",113,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV6",114,0)
 .;
"RTN","PSUV6",115,0)
 .S $P(PSUIVA(PSUDIV),U,6)=B_C
"RTN","PSUV6",116,0)
 Q
"RTN","PSUV6",117,0)
 ;
"RTN","PSUV6",118,0)
CNET ;Calculate Cost per Net LVP's dispensed
"RTN","PSUV6",119,0)
 ;
"RTN","PSUV6",120,0)
 N CNET,TCOST
"RTN","PSUV6",121,0)
 ;
"RTN","PSUV6",122,0)
 S CNET=$P($G(PSUIVA(PSUDIV)),U,5)
"RTN","PSUV6",123,0)
 S TCOST=$P($G(PSUIVA(PSUDIV)),U,6)
"RTN","PSUV6",124,0)
 ;
"RTN","PSUV6",125,0)
 I CNET'="",CNET'=0,TCOST'="" D
"RTN","PSUV6",126,0)
 .S $P(PSUIVA(PSUDIV),U,7)=TCOST/CNET
"RTN","PSUV6",127,0)
 .;
"RTN","PSUV6",128,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV6",129,0)
 .N A,B,C
"RTN","PSUV6",130,0)
 .;
"RTN","PSUV6",131,0)
 .I $P(PSUIVA(PSUDIV),U,7)'["." D  Q
"RTN","PSUV6",132,0)
 ..S $P(PSUIVA(PSUDIV),U,7)=$P(PSUIVA(PSUDIV),U,7)_".00"
"RTN","PSUV6",133,0)
 .;
"RTN","PSUV6",134,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,7),".")  ;Find 1st position after decimal
"RTN","PSUV6",135,0)
 .;
"RTN","PSUV6",136,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,7),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV6",137,0)
 .;
"RTN","PSUV6",138,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,7),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV6",139,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV6",140,0)
 .;
"RTN","PSUV6",141,0)
 .S $P(PSUIVA(PSUDIV),U,7)=B_C
"RTN","PSUV6",142,0)
 ;
"RTN","PSUV6",143,0)
 Q
"RTN","PSUV6",144,0)
 ;
"RTN","PSUV6",145,0)
TOTAL ;Add up column totals and place into ^XTMP global
"RTN","PSUV6",146,0)
 ;
"RTN","PSUV6",147,0)
 S PSUDI=0
"RTN","PSUV6",148,0)
 F  S PSUDI=$O(PSUIVA(PSUDI)) Q:PSUDI=""  D
"RTN","PSUV6",149,0)
 .S LDSP=$G(LDSP)+$P(PSUIVA(PSUDI),U,1)   ;Total LVP's dispensed
"RTN","PSUV6",150,0)
 .;
"RTN","PSUV6",151,0)
 .S LREC=$G(LREC)+$P(PSUIVA(PSUDI),U,2)   ;Total LVP's recycled
"RTN","PSUV6",152,0)
 .;
"RTN","PSUV6",153,0)
 .S LDES=$G(LDES)+$P(PSUIVA(PSUDI),U,3)   ;Total LVP's destroyed
"RTN","PSUV6",154,0)
 .;
"RTN","PSUV6",155,0)
 .S CLAN=$G(CLAN)+$P(PSUIVA(PSUDI),U,4)   ;Total LVP's cancelled
"RTN","PSUV6",156,0)
 .;
"RTN","PSUV6",157,0)
 .S NDSP=$G(NDSP)+$P(PSUIVA(PSUDI),U,5)   ;Total Net LVP's dispensed
"RTN","PSUV6",158,0)
 .;
"RTN","PSUV6",159,0)
 .S LTOT=$G(LTOT)+$P(PSUIVA(PSUDI),U,6)   ;Total of Total cost
"RTN","PSUV6",160,0)
 .;
"RTN","PSUV6",161,0)
 .;S CNDSP=$G(CNDSP)+$P(PSUIVA(PSUDI),U,7) ;Total of cost/net column
"RTN","PSUV6",162,0)
 .I $G(NDSP) S CNDSP=$G(LTOT)/NDSP D
"RTN","PSUV6",163,0)
 ..I CNDSP'["." S CNDSP=CNDSP_".00" Q
"RTN","PSUV6",164,0)
 ..N A,B,C
"RTN","PSUV6",165,0)
 ..S A=$F(CNDSP,".")  ;Find 1st position after decimal
"RTN","PSUV6",166,0)
 ..S B=$E(CNDSP,1,(A-1))   ;Extract dollars and decimal
"RTN","PSUV6",167,0)
 ..S C=$E(CNDSP,A,(A+1))   ;Extract cents after decimal
"RTN","PSUV6",168,0)
 ..I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV6",169,0)
 ..S CNDSP=B_C
"RTN","PSUV6",170,0)
 ;
"RTN","PSUV6",171,0)
 I '$D(LDSP) S LDSP=0
"RTN","PSUV6",172,0)
 I '$D(LREC) S LREC=0
"RTN","PSUV6",173,0)
 I '$D(LDES) S LDES=0
"RTN","PSUV6",174,0)
 I '$D(CLAN) S CLAN=0
"RTN","PSUV6",175,0)
 I '$D(NDSP) S NDSP=0
"RTN","PSUV6",176,0)
 I '$D(LTOT) S LTOT="0.00"
"RTN","PSUV6",177,0)
 I '$D(CNDSP) S CNDSP="0.00"
"RTN","PSUV6",178,0)
 ;
"RTN","PSUV6",179,0)
 S ^XTMP(PSUIVSUB,"LVPTOT")=LDSP_U_LREC_U_LDES_U_CLAN_U_NDSP_U_LTOT_U_CNDSP
"RTN","PSUV6",180,0)
 ;
"RTN","PSUV6",181,0)
 Q
"RTN","PSUV6",182,0)
 ;
"RTN","PSUV6",183,0)
REC ;Place contents of arrays into ^XTMP globals
"RTN","PSUV6",184,0)
 ;
"RTN","PSUV6",185,0)
 M ^XTMP(PSUIVSUB,"LVP",PSUDIV)=PSUIVA(PSUDIV)   ;LVP RECORDS
"RTN","PSUV6",186,0)
 ;
"RTN","PSUV6",187,0)
 Q
"RTN","PSUV7")
0^3^B34147277
"RTN","PSUV7",1,0)
PSUV7 ;BIR/DAM - IV PB AMIS Summary Data ;11 March 2004
"RTN","PSUV7",2,0)
 ;;4.0;PHARMACY BENEFITS MANAGEMENT;**4**;MARCH, 2005
"RTN","PSUV7",3,0)
 ;
"RTN","PSUV7",4,0)
 ;This routine gathers IV Piggyback AMIS summary data
"RTN","PSUV7",5,0)
 ;No DBIA's needed
"RTN","PSUV7",6,0)
 ;
"RTN","PSUV7",7,0)
EN ;Entry point to gather AMIS data.  Called from PSUV3
"RTN","PSUV7",8,0)
 ;
"RTN","PSUV7",9,0)
 K PSUIVA      ;Array to hold temporary data
"RTN","PSUV7",10,0)
 ;
"RTN","PSUV7",11,0)
 ;Initialize variables for column totals
"RTN","PSUV7",12,0)
 ;
"RTN","PSUV7",13,0)
 ;
"RTN","PSUV7",14,0)
 S PSUDIV=0
"RTN","PSUV7",15,0)
 S PSUCT=0
"RTN","PSUV7",16,0)
 F  S PSUDIV=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV)) Q:PSUDIV=""  D EN1
"RTN","PSUV7",17,0)
 Q
"RTN","PSUV7",18,0)
 ;
"RTN","PSUV7",19,0)
EN1 ;EN CONTINUED
"RTN","PSUV7",20,0)
 ;
"RTN","PSUV7",21,0)
 S PSUOR=""
"RTN","PSUV7",22,0)
 N LDSP,LREC,LDES,CLAN,NDSP,LTOT,CNDSP
"RTN","PSUV7",23,0)
 F  S PSUCT=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)) Q:PSUCT=""  D
"RTN","PSUV7",24,0)
 .K PSUAMIS
"RTN","PSUV7",25,0)
 .M PSUAMIS(PSUDIV,PSUCT)=^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)
"RTN","PSUV7",26,0)
 .;
"RTN","PSUV7",27,0)
 .S PSUP=""
"RTN","PSUV7",28,0)
 .S PSUP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,5)      ;parent record
"RTN","PSUV7",29,0)
 .;
"RTN","PSUV7",30,0)
 .S PSUTYP=""
"RTN","PSUV7",31,0)
 .S PSUTYP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,6)    ;IV TYPE
"RTN","PSUV7",32,0)
 .;
"RTN","PSUV7",33,0)
 .I PSUTYP="P" S PSUOR=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,4) ;IV order #
"RTN","PSUV7",34,0)
 .;
"RTN","PSUV7",35,0)
 .D LVPDSP
"RTN","PSUV7",36,0)
 .D LVPREC
"RTN","PSUV7",37,0)
 .D LVPDES
"RTN","PSUV7",38,0)
 .D LVPCAN
"RTN","PSUV7",39,0)
 .D LVPNET
"RTN","PSUV7",40,0)
 .D LVPTOT
"RTN","PSUV7",41,0)
 .D CNET
"RTN","PSUV7",42,0)
 .D REC
"RTN","PSUV7",43,0)
 D TOTAL
"RTN","PSUV7",44,0)
 ;
"RTN","PSUV7",45,0)
 Q
"RTN","PSUV7",46,0)
 ;
"RTN","PSUV7",47,0)
LVPDSP ;Gather PB Dispensed data
"RTN","PSUV7",48,0)
 ;
"RTN","PSUV7",49,0)
 I PSUTYP="P",PSUP="P" D                         ;PBs Dispensed
"RTN","PSUV7",50,0)
 .N DSP
"RTN","PSUV7",51,0)
 .S DSP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,29)
"RTN","PSUV7",52,0)
 .S $P(PSUIVA(PSUDIV),U,1)=$P($G(PSUIVA(PSUDIV)),U,1)+DSP
"RTN","PSUV7",53,0)
 ;
"RTN","PSUV7",54,0)
 Q
"RTN","PSUV7",55,0)
 ;
"RTN","PSUV7",56,0)
LVPREC ;Gather PB Recycled data
"RTN","PSUV7",57,0)
 ;
"RTN","PSUV7",58,0)
 I PSUTYP="P",PSUP="P" D                         ;PB's recycled
"RTN","PSUV7",59,0)
 .N REC
"RTN","PSUV7",60,0)
 .S REC=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,30)
"RTN","PSUV7",61,0)
 .S $P(PSUIVA(PSUDIV),U,2)=$P($G(PSUIVA(PSUDIV)),U,2)+REC
"RTN","PSUV7",62,0)
 ;
"RTN","PSUV7",63,0)
 Q
"RTN","PSUV7",64,0)
 ;
"RTN","PSUV7",65,0)
LVPDES ;Gather PB Destroyed data
"RTN","PSUV7",66,0)
 ;
"RTN","PSUV7",67,0)
 I PSUTYP="P",PSUP="P" D                        ;PB's destroyed
"RTN","PSUV7",68,0)
 .N DES
"RTN","PSUV7",69,0)
 .S DES=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,31)
"RTN","PSUV7",70,0)
 .S $P(PSUIVA(PSUDIV),U,3)=$P($G(PSUIVA(PSUDIV)),U,3)+DES
"RTN","PSUV7",71,0)
 ;
"RTN","PSUV7",72,0)
 Q
"RTN","PSUV7",73,0)
 ;
"RTN","PSUV7",74,0)
LVPCAN ;Gather PB Cancelled data
"RTN","PSUV7",75,0)
 ;
"RTN","PSUV7",76,0)
 I PSUTYP="P",PSUP="P" D                         ;PB's cancelled
"RTN","PSUV7",77,0)
 .N CAN
"RTN","PSUV7",78,0)
 .S CAN=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,32)
"RTN","PSUV7",79,0)
 .S $P(PSUIVA(PSUDIV),U,4)=$P($G(PSUIVA(PSUDIV)),U,4)+CAN
"RTN","PSUV7",80,0)
 ;
"RTN","PSUV7",81,0)
 Q
"RTN","PSUV7",82,0)
 ;
"RTN","PSUV7",83,0)
LVPNET ;Calculate net amount of PB's Dispensed
"RTN","PSUV7",84,0)
 ;
"RTN","PSUV7",85,0)
 ;
"RTN","PSUV7",86,0)
 I PSUTYP="P",PSUP="P" D
"RTN","PSUV7",87,0)
 .N NET
"RTN","PSUV7",88,0)
 .S NET=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,11)
"RTN","PSUV7",89,0)
 .S $P(PSUIVA(PSUDIV),U,5)=$P($G(PSUIVA(PSUDIV)),U,5)+NET
"RTN","PSUV7",90,0)
 Q
"RTN","PSUV7",91,0)
 ;
"RTN","PSUV7",92,0)
LVPTOT ;Calculate Total cost
"RTN","PSUV7",93,0)
 ;
"RTN","PSUV7",94,0)
 N NDIS,COST,PSUOR1
"RTN","PSUV7",95,0)
 S PSUCTA=0
"RTN","PSUV7",96,0)
 F  S PSUCTA=$O(PSUAMIS(PSUDIV,PSUCTA)) Q:PSUCTA=""  D
"RTN","PSUV7",97,0)
 .S PSUOR1=$P(PSUAMIS(PSUDIV,PSUCTA),U,4)
"RTN","PSUV7",98,0)
 .Q:(PSUOR1'=PSUOR)
"RTN","PSUV7",99,0)
 .S NDIS=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,33)
"RTN","PSUV7",100,0)
 .S COST=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,22)
"RTN","PSUV7",101,0)
 .S $P(PSUIVA(PSUDIV),U,6)=$P($G(PSUIVA(PSUDIV)),U,6)+(NDIS*$G(COST))
"RTN","PSUV7",102,0)
 .;
"RTN","PSUV7",103,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV7",104,0)
 .N A,B,C
"RTN","PSUV7",105,0)
 .;
"RTN","PSUV7",106,0)
 .I $P(PSUIVA(PSUDIV),U,6)'["." D  Q
"RTN","PSUV7",107,0)
 ..S $P(PSUIVA(PSUDIV),U,6)=$P(PSUIVA(PSUDIV),U,6)_".00"
"RTN","PSUV7",108,0)
 .;
"RTN","PSUV7",109,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,6),".")  ;Find 1st position after decimal
"RTN","PSUV7",110,0)
 .;
"RTN","PSUV7",111,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,6),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV7",112,0)
 .;
"RTN","PSUV7",113,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,6),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV7",114,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV7",115,0)
 .;
"RTN","PSUV7",116,0)
 .S $P(PSUIVA(PSUDIV),U,6)=B_C
"RTN","PSUV7",117,0)
 Q
"RTN","PSUV7",118,0)
 ;
"RTN","PSUV7",119,0)
CNET ;Calculate Cost per Net PB's dispensed
"RTN","PSUV7",120,0)
 ;
"RTN","PSUV7",121,0)
 N CNET,TCOST
"RTN","PSUV7",122,0)
 ;
"RTN","PSUV7",123,0)
 S CNET=$P($G(PSUIVA(PSUDIV)),U,5)
"RTN","PSUV7",124,0)
 S TCOST=$P($G(PSUIVA(PSUDIV)),U,6)
"RTN","PSUV7",125,0)
 ;
"RTN","PSUV7",126,0)
 I CNET'="",CNET'=0,TCOST'="" D
"RTN","PSUV7",127,0)
 .S $P(PSUIVA(PSUDIV),U,7)=TCOST/CNET
"RTN","PSUV7",128,0)
 .;
"RTN","PSUV7",129,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV7",130,0)
 .N A,B,C
"RTN","PSUV7",131,0)
 .;
"RTN","PSUV7",132,0)
 .I $P(PSUIVA(PSUDIV),U,7)'["." D  Q
"RTN","PSUV7",133,0)
 ..S $P(PSUIVA(PSUDIV),U,7)=$P(PSUIVA(PSUDIV),U,7)_".00"
"RTN","PSUV7",134,0)
 .;
"RTN","PSUV7",135,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,7),".")  ;Find 1st position after decimal
"RTN","PSUV7",136,0)
 .;
"RTN","PSUV7",137,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,7),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV7",138,0)
 .;
"RTN","PSUV7",139,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,7),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV7",140,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV7",141,0)
 .;
"RTN","PSUV7",142,0)
 .S $P(PSUIVA(PSUDIV),U,7)=B_C
"RTN","PSUV7",143,0)
 ;
"RTN","PSUV7",144,0)
 Q
"RTN","PSUV7",145,0)
 ;
"RTN","PSUV7",146,0)
TOTAL ;Add up column totals and place into ^XTMP global
"RTN","PSUV7",147,0)
 ;
"RTN","PSUV7",148,0)
 S PSUDI=0
"RTN","PSUV7",149,0)
 F  S PSUDI=$O(PSUIVA(PSUDI)) Q:PSUDI=""  D
"RTN","PSUV7",150,0)
 .S LDSP=$G(LDSP)+$P(PSUIVA(PSUDI),U,1)   ;Total PB's dispensed
"RTN","PSUV7",151,0)
 .;
"RTN","PSUV7",152,0)
 .S LREC=$G(LREC)+$P(PSUIVA(PSUDI),U,2)   ;Total PB's recycled
"RTN","PSUV7",153,0)
 .;
"RTN","PSUV7",154,0)
 .S LDES=$G(LDES)+$P(PSUIVA(PSUDI),U,3)   ;Total PB's destroyed
"RTN","PSUV7",155,0)
 .;
"RTN","PSUV7",156,0)
 .S CLAN=$G(CLAN)+$P(PSUIVA(PSUDI),U,4)   ;Total PB's cancelled
"RTN","PSUV7",157,0)
 .;
"RTN","PSUV7",158,0)
 .S NDSP=$G(NDSP)+$P(PSUIVA(PSUDI),U,5)   ;Total Net PB's dispensed
"RTN","PSUV7",159,0)
 .;
"RTN","PSUV7",160,0)
 .S LTOT=$G(LTOT)+$P(PSUIVA(PSUDI),U,6)   ;Total of Total cost
"RTN","PSUV7",161,0)
 .;
"RTN","PSUV7",162,0)
 .;S CNDSP=$G(CNDSP)+$P(PSUIVA(PSUDI),U,7) ;Total of cost/net column
"RTN","PSUV7",163,0)
 .I $G(NDSP) S CNDSP=$G(LTOT)/NDSP D
"RTN","PSUV7",164,0)
 ..I CNDSP'["." S CNDSP=CNDSP_".00" Q
"RTN","PSUV7",165,0)
 ..N A,B,C
"RTN","PSUV7",166,0)
 ..S A=$F(CNDSP,".")  ;Find 1st position after decimal
"RTN","PSUV7",167,0)
 ..S B=$E(CNDSP,1,(A-1))   ;Extract dollars and decimal
"RTN","PSUV7",168,0)
 ..S C=$E(CNDSP,A,(A+1))   ;Extract cents after decimal
"RTN","PSUV7",169,0)
 ..I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV7",170,0)
 ..S CNDSP=B_C
"RTN","PSUV7",171,0)
 ;
"RTN","PSUV7",172,0)
 I '$D(LDSP) S LDSP=0
"RTN","PSUV7",173,0)
 I '$D(LREC) S LREC=0
"RTN","PSUV7",174,0)
 I '$D(LDES) S LDES=0
"RTN","PSUV7",175,0)
 I '$D(CLAN) S CLAN=0
"RTN","PSUV7",176,0)
 I '$D(NDSP) S NDSP=0
"RTN","PSUV7",177,0)
 I '$D(LTOT) S LTOT="0.00"
"RTN","PSUV7",178,0)
 I '$D(CNDSP) S CNDSP="0.00"
"RTN","PSUV7",179,0)
 ;
"RTN","PSUV7",180,0)
 S ^XTMP(PSUIVSUB,"PBTOT")=LDSP_U_LREC_U_LDES_U_CLAN_U_NDSP_U_LTOT_U_CNDSP
"RTN","PSUV7",181,0)
 ;
"RTN","PSUV7",182,0)
 Q
"RTN","PSUV7",183,0)
 ;
"RTN","PSUV7",184,0)
REC ;Place contents of arrays into ^XTMP globals
"RTN","PSUV7",185,0)
 ;
"RTN","PSUV7",186,0)
 M ^XTMP(PSUIVSUB,"PB",PSUDIV)=PSUIVA(PSUDIV)   ;PB RECORDS
"RTN","PSUV7",187,0)
 ;
"RTN","PSUV7",188,0)
 Q
"RTN","PSUV8")
0^4^B34528842
"RTN","PSUV8",1,0)
PSUV8 ;BIR/DAM - IV TPN AMIS Summary Data ;11 March 2004
"RTN","PSUV8",2,0)
 ;;4.0;PHARMACY BENEFITS MANAGEMENT;**4**;MARCH, 2005
"RTN","PSUV8",3,0)
 ;
"RTN","PSUV8",4,0)
 ;This routine gathers IV TPN AMIS summary data
"RTN","PSUV8",5,0)
 ;No DBIA's needed
"RTN","PSUV8",6,0)
 ;
"RTN","PSUV8",7,0)
EN ;Entry point to gather AMIS data.  Called from PSUV3
"RTN","PSUV8",8,0)
 ;
"RTN","PSUV8",9,0)
 K PSUIVA      ;Array to hold temporary data
"RTN","PSUV8",10,0)
 ;
"RTN","PSUV8",11,0)
 ;Initialize variables for column totals
"RTN","PSUV8",12,0)
 ;
"RTN","PSUV8",13,0)
 ;
"RTN","PSUV8",14,0)
 S PSUDIV=0
"RTN","PSUV8",15,0)
 S PSUCT=0
"RTN","PSUV8",16,0)
 F  S PSUDIV=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV)) Q:PSUDIV=""  D EN1
"RTN","PSUV8",17,0)
 Q
"RTN","PSUV8",18,0)
 ;
"RTN","PSUV8",19,0)
EN1 ;EN CONTINUED
"RTN","PSUV8",20,0)
 ;
"RTN","PSUV8",21,0)
 S PSUOR=""
"RTN","PSUV8",22,0)
 N LDSP,LREC,LDES,CLAN,NDSP,LTOT,CNDSP
"RTN","PSUV8",23,0)
 F  S PSUCT=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)) Q:PSUCT=""  D
"RTN","PSUV8",24,0)
 .K PSUAMIS
"RTN","PSUV8",25,0)
 .M PSUAMIS(PSUDIV,PSUCT)=^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)
"RTN","PSUV8",26,0)
 .;
"RTN","PSUV8",27,0)
 .S PSUP=""
"RTN","PSUV8",28,0)
 .S PSUP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,5)      ;parent record
"RTN","PSUV8",29,0)
 .;
"RTN","PSUV8",30,0)
 .S PSUTYP=""
"RTN","PSUV8",31,0)
 .S PSUTYP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,6)    ;IV TYPE
"RTN","PSUV8",32,0)
 .;
"RTN","PSUV8",33,0)
 .I PSUTYP="H" S PSUOR=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,4)    ;IV order #
"RTN","PSUV8",34,0)
 .D LVPDSP
"RTN","PSUV8",35,0)
 .D LVPREC
"RTN","PSUV8",36,0)
 .D LVPDES
"RTN","PSUV8",37,0)
 .D LVPCAN
"RTN","PSUV8",38,0)
 .D LVPNET
"RTN","PSUV8",39,0)
 .D LVPTOT
"RTN","PSUV8",40,0)
 .D CNET
"RTN","PSUV8",41,0)
 .D REC
"RTN","PSUV8",42,0)
 D TOTAL
"RTN","PSUV8",43,0)
 ;
"RTN","PSUV8",44,0)
 Q
"RTN","PSUV8",45,0)
 ;
"RTN","PSUV8",46,0)
LVPDSP ;Gather TPN Dispensed data
"RTN","PSUV8",47,0)
 ;
"RTN","PSUV8",48,0)
 I PSUTYP="H",PSUP="P" D                         ;TPNs Dispensed
"RTN","PSUV8",49,0)
 .N DSP
"RTN","PSUV8",50,0)
 .S DSP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,29)
"RTN","PSUV8",51,0)
 .S $P(PSUIVA(PSUDIV),U,1)=$P($G(PSUIVA(PSUDIV)),U,1)+DSP
"RTN","PSUV8",52,0)
 ;
"RTN","PSUV8",53,0)
 Q
"RTN","PSUV8",54,0)
 ;
"RTN","PSUV8",55,0)
LVPREC ;Gather TPN Recycled data
"RTN","PSUV8",56,0)
 ;
"RTN","PSUV8",57,0)
 I PSUTYP="H",PSUP="P" D                         ;TPN's recycled
"RTN","PSUV8",58,0)
 .N REC
"RTN","PSUV8",59,0)
 .S REC=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,30)
"RTN","PSUV8",60,0)
 .S $P(PSUIVA(PSUDIV),U,2)=$P($G(PSUIVA(PSUDIV)),U,2)+REC
"RTN","PSUV8",61,0)
 ;
"RTN","PSUV8",62,0)
 Q
"RTN","PSUV8",63,0)
 ;
"RTN","PSUV8",64,0)
LVPDES ;Gather TPN Destroyed data
"RTN","PSUV8",65,0)
 ;
"RTN","PSUV8",66,0)
 I PSUTYP="H",PSUP="P" D                        ;TPN's destroyed
"RTN","PSUV8",67,0)
 .N DES
"RTN","PSUV8",68,0)
 .S DES=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,31)
"RTN","PSUV8",69,0)
 .S $P(PSUIVA(PSUDIV),U,3)=$P($G(PSUIVA(PSUDIV)),U,3)+DES
"RTN","PSUV8",70,0)
 ;
"RTN","PSUV8",71,0)
 Q
"RTN","PSUV8",72,0)
 ;
"RTN","PSUV8",73,0)
LVPCAN ;Gather TPN Cancelled data
"RTN","PSUV8",74,0)
 ;
"RTN","PSUV8",75,0)
 I PSUTYP="H",PSUP="P" D                         ;TPN's cancelled
"RTN","PSUV8",76,0)
 .N CAN
"RTN","PSUV8",77,0)
 .S CAN=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,32)
"RTN","PSUV8",78,0)
 .S $P(PSUIVA(PSUDIV),U,4)=$P($G(PSUIVA(PSUDIV)),U,4)+CAN
"RTN","PSUV8",79,0)
 ;
"RTN","PSUV8",80,0)
 Q
"RTN","PSUV8",81,0)
 ;
"RTN","PSUV8",82,0)
LVPNET ;Calculate net amount of TPN's Dispensed
"RTN","PSUV8",83,0)
 ;
"RTN","PSUV8",84,0)
 ;
"RTN","PSUV8",85,0)
 I PSUTYP="H",PSUP="P" D
"RTN","PSUV8",86,0)
 .N NET
"RTN","PSUV8",87,0)
 .S NET=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,11)
"RTN","PSUV8",88,0)
 .S $P(PSUIVA(PSUDIV),U,5)=$P($G(PSUIVA(PSUDIV)),U,5)+NET
"RTN","PSUV8",89,0)
 Q
"RTN","PSUV8",90,0)
 ;
"RTN","PSUV8",91,0)
LVPTOT ;Calculate Total cost
"RTN","PSUV8",92,0)
 ;
"RTN","PSUV8",93,0)
 N NDIS,COST,PSUOR1
"RTN","PSUV8",94,0)
 S PSUCTA=0
"RTN","PSUV8",95,0)
 F  S PSUCTA=$O(PSUAMIS(PSUDIV,PSUCTA)) Q:PSUCTA=""  D
"RTN","PSUV8",96,0)
 .S PSUOR1=$P(PSUAMIS(PSUDIV,PSUCTA),U,4)
"RTN","PSUV8",97,0)
 .Q:(PSUOR1'=PSUOR)
"RTN","PSUV8",98,0)
 .S NDIS=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,33)
"RTN","PSUV8",99,0)
 .S COST=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,22)
"RTN","PSUV8",100,0)
 .S $P(PSUIVA(PSUDIV),U,6)=$P($G(PSUIVA(PSUDIV)),U,6)+(NDIS*$G(COST))
"RTN","PSUV8",101,0)
 .;
"RTN","PSUV8",102,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV8",103,0)
 .N A,B,C
"RTN","PSUV8",104,0)
 .;
"RTN","PSUV8",105,0)
 .I $P(PSUIVA(PSUDIV),U,6)'["." D  Q
"RTN","PSUV8",106,0)
 ..S $P(PSUIVA(PSUDIV),U,6)=$P(PSUIVA(PSUDIV),U,6)_".00"
"RTN","PSUV8",107,0)
 .;
"RTN","PSUV8",108,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,6),".")  ;Find 1st position after decimal
"RTN","PSUV8",109,0)
 .;
"RTN","PSUV8",110,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,6),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV8",111,0)
 .;
"RTN","PSUV8",112,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,6),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV8",113,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV8",114,0)
 .;
"RTN","PSUV8",115,0)
 .S $P(PSUIVA(PSUDIV),U,6)=B_C
"RTN","PSUV8",116,0)
 Q
"RTN","PSUV8",117,0)
 ;
"RTN","PSUV8",118,0)
CNET ;Calculate Cost per Net TPN's dispensed
"RTN","PSUV8",119,0)
 ;
"RTN","PSUV8",120,0)
 N CNET,TCOST
"RTN","PSUV8",121,0)
 ;
"RTN","PSUV8",122,0)
 S CNET=$P($G(PSUIVA(PSUDIV)),U,5)
"RTN","PSUV8",123,0)
 S TCOST=$P($G(PSUIVA(PSUDIV)),U,6)
"RTN","PSUV8",124,0)
 ;
"RTN","PSUV8",125,0)
 I CNET'="",CNET'=0,TCOST'="" D
"RTN","PSUV8",126,0)
 .S $P(PSUIVA(PSUDIV),U,7)=TCOST/CNET
"RTN","PSUV8",127,0)
 .;
"RTN","PSUV8",128,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV8",129,0)
 .N A,B,C
"RTN","PSUV8",130,0)
 .;
"RTN","PSUV8",131,0)
 .I $P(PSUIVA(PSUDIV),U,7)'["." D  Q
"RTN","PSUV8",132,0)
 ..S $P(PSUIVA(PSUDIV),U,7)=$P(PSUIVA(PSUDIV),U,7)_".00"
"RTN","PSUV8",133,0)
 .;
"RTN","PSUV8",134,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,7),".")  ;Find 1st position after decimal
"RTN","PSUV8",135,0)
 .;
"RTN","PSUV8",136,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,7),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV8",137,0)
 .;
"RTN","PSUV8",138,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,7),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV8",139,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV8",140,0)
 .;
"RTN","PSUV8",141,0)
 .S $P(PSUIVA(PSUDIV),U,7)=B_C
"RTN","PSUV8",142,0)
 ;
"RTN","PSUV8",143,0)
 Q
"RTN","PSUV8",144,0)
 ;
"RTN","PSUV8",145,0)
TOTAL ;Add up column totals and place into ^XTMP global
"RTN","PSUV8",146,0)
 ;
"RTN","PSUV8",147,0)
 S PSUDI=0
"RTN","PSUV8",148,0)
 F  S PSUDI=$O(PSUIVA(PSUDI)) Q:PSUDI=""  D
"RTN","PSUV8",149,0)
 .S LDSP=$G(LDSP)+$P(PSUIVA(PSUDI),U,1)   ;Total TPN's dispensed
"RTN","PSUV8",150,0)
 .;
"RTN","PSUV8",151,0)
 .S LREC=$G(LREC)+$P(PSUIVA(PSUDI),U,2)   ;Total TPN's recycled
"RTN","PSUV8",152,0)
 .;
"RTN","PSUV8",153,0)
 .S LDES=$G(LDES)+$P(PSUIVA(PSUDI),U,3)   ;Total TPN's destroyed
"RTN","PSUV8",154,0)
 .;
"RTN","PSUV8",155,0)
 .S CLAN=$G(CLAN)+$P(PSUIVA(PSUDI),U,4)   ;Total TPN's cancelled
"RTN","PSUV8",156,0)
 .;
"RTN","PSUV8",157,0)
 .S NDSP=$G(NDSP)+$P(PSUIVA(PSUDI),U,5)   ;Total Net TPN's dispensed
"RTN","PSUV8",158,0)
 .;
"RTN","PSUV8",159,0)
 .S LTOT=$G(LTOT)+$P(PSUIVA(PSUDI),U,6)   ;Total of Total cost
"RTN","PSUV8",160,0)
 .;
"RTN","PSUV8",161,0)
 .;S CNDSP=$G(CNDSP)+$P(PSUIVA(PSUDI),U,7) ;Total of cost/net column
"RTN","PSUV8",162,0)
 .I $G(NDSP) S CNDSP=$G(LTOT)/NDSP D
"RTN","PSUV8",163,0)
 ..I CNDSP'["." S CNDSP=CNDSP_".00" Q
"RTN","PSUV8",164,0)
 ..N A,B,C
"RTN","PSUV8",165,0)
 ..S A=$F(CNDSP,".")  ;Find 1st position after decimal
"RTN","PSUV8",166,0)
 ..S B=$E(CNDSP,1,(A-1))   ;Extract dollars and decimal
"RTN","PSUV8",167,0)
 ..S C=$E(CNDSP,A,(A+1))   ;Extract cents after decimal
"RTN","PSUV8",168,0)
 ..I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV8",169,0)
 ..S CNDSP=B_C
"RTN","PSUV8",170,0)
 ;
"RTN","PSUV8",171,0)
 I '$D(LDSP) S LDSP=0
"RTN","PSUV8",172,0)
 I '$D(LREC) S LREC=0
"RTN","PSUV8",173,0)
 I '$D(LDES) S LDES=0
"RTN","PSUV8",174,0)
 I '$D(CLAN) S CLAN=0
"RTN","PSUV8",175,0)
 I '$D(NDSP) S NDSP=0
"RTN","PSUV8",176,0)
 I '$D(LTOT) S LTOT="0.00"
"RTN","PSUV8",177,0)
 I '$D(CNDSP) S CNDSP="0.00"
"RTN","PSUV8",178,0)
 ;
"RTN","PSUV8",179,0)
 S ^XTMP(PSUIVSUB,"TPNTOT")=$G(LDSP)_U_$G(LREC)_U_$G(LDES)_U_$G(CLAN)_U_$G(NDSP)_U_$G(LTOT)_U_$G(CNDSP)
"RTN","PSUV8",180,0)
 ;
"RTN","PSUV8",181,0)
 Q
"RTN","PSUV8",182,0)
 ;
"RTN","PSUV8",183,0)
REC ;Place contents of arrays into ^XTMP globals
"RTN","PSUV8",184,0)
 ;
"RTN","PSUV8",185,0)
 M ^XTMP(PSUIVSUB,"TPN",PSUDIV)=PSUIVA(PSUDIV)   ;TPN RECORDS
"RTN","PSUV8",186,0)
 ;
"RTN","PSUV8",187,0)
 Q
"RTN","PSUV9")
0^5^B34939396
"RTN","PSUV9",1,0)
PSUV9 ;BIR/DAM - IV Chemotherapy AMIS Summary Data ;11 March 2004
"RTN","PSUV9",2,0)
 ;;4.0;PHARMACY BENEFITS MANAGEMENT;**4**;MARCH, 2005
"RTN","PSUV9",3,0)
 ;
"RTN","PSUV9",4,0)
 ;This routine gathers IV CHEMO AMIS summary data
"RTN","PSUV9",5,0)
 ;No DBIA's needed
"RTN","PSUV9",6,0)
 ;
"RTN","PSUV9",7,0)
EN ;Entry point to gather AMIS data.  Called from PSUV3
"RTN","PSUV9",8,0)
 ;
"RTN","PSUV9",9,0)
 K PSUIVA      ;Array to hold temporary data
"RTN","PSUV9",10,0)
 ;
"RTN","PSUV9",11,0)
 ;Initialize variables for column totals
"RTN","PSUV9",12,0)
 ;
"RTN","PSUV9",13,0)
 ;
"RTN","PSUV9",14,0)
 S PSUDIV=0
"RTN","PSUV9",15,0)
 S PSUCT=0
"RTN","PSUV9",16,0)
 F  S PSUDIV=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV)) Q:PSUDIV=""  D EN1
"RTN","PSUV9",17,0)
 Q
"RTN","PSUV9",18,0)
 ;
"RTN","PSUV9",19,0)
EN1 ;EN CONTINUED
"RTN","PSUV9",20,0)
 ;
"RTN","PSUV9",21,0)
 S PSUOR=""
"RTN","PSUV9",22,0)
 N LDSP,LREC,LDES,CLAN,NDSP,LTOT,CNDSP
"RTN","PSUV9",23,0)
 F  S PSUCT=$O(^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)) Q:PSUCT=""  D
"RTN","PSUV9",24,0)
 .K PSUAMIS
"RTN","PSUV9",25,0)
 .M PSUAMIS(PSUDIV,PSUCT)=^XTMP(PSUIVSUB,"RECORDS",PSUDIV,PSUCT)
"RTN","PSUV9",26,0)
 .;
"RTN","PSUV9",27,0)
 .S PSUP=""
"RTN","PSUV9",28,0)
 .S PSUP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,5)      ;parent record
"RTN","PSUV9",29,0)
 .;
"RTN","PSUV9",30,0)
 .S PSUTYP=""
"RTN","PSUV9",31,0)
 .S PSUTYP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,6)    ;IV TYPE
"RTN","PSUV9",32,0)
 .;
"RTN","PSUV9",33,0)
 .I PSUTYP="C" S PSUOR=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,4)    ;IV order #
"RTN","PSUV9",34,0)
 .;
"RTN","PSUV9",35,0)
 .D LVPDSP
"RTN","PSUV9",36,0)
 .D LVPREC
"RTN","PSUV9",37,0)
 .D LVPDES
"RTN","PSUV9",38,0)
 .D LVPCAN
"RTN","PSUV9",39,0)
 .D LVPNET
"RTN","PSUV9",40,0)
 .D LVPTOT
"RTN","PSUV9",41,0)
 .D CNET
"RTN","PSUV9",42,0)
 .D REC
"RTN","PSUV9",43,0)
 D TOTAL
"RTN","PSUV9",44,0)
 ;
"RTN","PSUV9",45,0)
 Q
"RTN","PSUV9",46,0)
 ;
"RTN","PSUV9",47,0)
LVPDSP ;Gather CHEMO Dispensed data
"RTN","PSUV9",48,0)
 ;
"RTN","PSUV9",49,0)
 I PSUTYP="C",PSUP="P" D                         ;CHEMOs Dispensed
"RTN","PSUV9",50,0)
 .N DSP
"RTN","PSUV9",51,0)
 .S DSP=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,29)
"RTN","PSUV9",52,0)
 .S $P(PSUIVA(PSUDIV),U,1)=$P($G(PSUIVA(PSUDIV)),U,1)+DSP
"RTN","PSUV9",53,0)
 ;
"RTN","PSUV9",54,0)
 Q
"RTN","PSUV9",55,0)
 ;
"RTN","PSUV9",56,0)
LVPREC ;Gather CHEMO Recycled data
"RTN","PSUV9",57,0)
 ;
"RTN","PSUV9",58,0)
 I PSUTYP="C",PSUP="P" D                         ;CHEMO's recycled
"RTN","PSUV9",59,0)
 .N REC
"RTN","PSUV9",60,0)
 .S REC=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,30)
"RTN","PSUV9",61,0)
 .S $P(PSUIVA(PSUDIV),U,2)=$P($G(PSUIVA(PSUDIV)),U,2)+REC
"RTN","PSUV9",62,0)
 ;
"RTN","PSUV9",63,0)
 Q
"RTN","PSUV9",64,0)
 ;
"RTN","PSUV9",65,0)
LVPDES ;Gather CHEMO Destroyed data
"RTN","PSUV9",66,0)
 ;
"RTN","PSUV9",67,0)
 I PSUTYP="C",PSUP="P" D                        ;CHEMO's destroyed
"RTN","PSUV9",68,0)
 .N DES
"RTN","PSUV9",69,0)
 .S DES=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,31)
"RTN","PSUV9",70,0)
 .S $P(PSUIVA(PSUDIV),U,3)=$P($G(PSUIVA(PSUDIV)),U,3)+DES
"RTN","PSUV9",71,0)
 ;
"RTN","PSUV9",72,0)
 Q
"RTN","PSUV9",73,0)
 ;
"RTN","PSUV9",74,0)
LVPCAN ;Gather CHEMO Cancelled data
"RTN","PSUV9",75,0)
 ;
"RTN","PSUV9",76,0)
 I PSUTYP="C",PSUP="P" D                         ;CHEMO's cancelled
"RTN","PSUV9",77,0)
 .N CAN
"RTN","PSUV9",78,0)
 .S CAN=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,32)
"RTN","PSUV9",79,0)
 .S $P(PSUIVA(PSUDIV),U,4)=$P($G(PSUIVA(PSUDIV)),U,4)+CAN
"RTN","PSUV9",80,0)
 ;
"RTN","PSUV9",81,0)
 Q
"RTN","PSUV9",82,0)
 ;
"RTN","PSUV9",83,0)
LVPNET ;Calculate net amount of CHEMO's Dispensed
"RTN","PSUV9",84,0)
 ;
"RTN","PSUV9",85,0)
 ;
"RTN","PSUV9",86,0)
 I PSUTYP="C",PSUP="P" D
"RTN","PSUV9",87,0)
 .N NET
"RTN","PSUV9",88,0)
 .S NET=$P($G(PSUAMIS(PSUDIV,PSUCT)),U,11)
"RTN","PSUV9",89,0)
 .S $P(PSUIVA(PSUDIV),U,5)=$P($G(PSUIVA(PSUDIV)),U,5)+NET
"RTN","PSUV9",90,0)
 Q
"RTN","PSUV9",91,0)
 ;
"RTN","PSUV9",92,0)
LVPTOT ;Calculate Total cost
"RTN","PSUV9",93,0)
 ;
"RTN","PSUV9",94,0)
 N NDIS,COST,PSUOR1
"RTN","PSUV9",95,0)
 S PSUCTA=0
"RTN","PSUV9",96,0)
 F  S PSUCTA=$O(PSUAMIS(PSUDIV,PSUCTA)) Q:PSUCTA=""  D
"RTN","PSUV9",97,0)
 .S PSUOR1=$P(PSUAMIS(PSUDIV,PSUCTA),U,4)
"RTN","PSUV9",98,0)
 .Q:(PSUOR1'=PSUOR)
"RTN","PSUV9",99,0)
 .S NDIS=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,33)
"RTN","PSUV9",100,0)
 .S COST=$P($G(PSUAMIS(PSUDIV,PSUCTA)),U,22)
"RTN","PSUV9",101,0)
 .S $P(PSUIVA(PSUDIV),U,6)=$P($G(PSUIVA(PSUDIV)),U,6)+(NDIS*$G(COST))
"RTN","PSUV9",102,0)
 .;
"RTN","PSUV9",103,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV9",104,0)
 .N A,B,C
"RTN","PSUV9",105,0)
 .;
"RTN","PSUV9",106,0)
 .I $P(PSUIVA(PSUDIV),U,6)'["." D  Q
"RTN","PSUV9",107,0)
 ..S $P(PSUIVA(PSUDIV),U,6)=$P(PSUIVA(PSUDIV),U,6)_".00"
"RTN","PSUV9",108,0)
 .;
"RTN","PSUV9",109,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,6),".")  ;Find 1st position after decimal
"RTN","PSUV9",110,0)
 .;
"RTN","PSUV9",111,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,6),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV9",112,0)
 .;
"RTN","PSUV9",113,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,6),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV9",114,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV9",115,0)
 .;
"RTN","PSUV9",116,0)
 .S $P(PSUIVA(PSUDIV),U,6)=B_C
"RTN","PSUV9",117,0)
 Q
"RTN","PSUV9",118,0)
 ;
"RTN","PSUV9",119,0)
CNET ;Calculate Cost per Net CHEMO's dispensed
"RTN","PSUV9",120,0)
 ;
"RTN","PSUV9",121,0)
 N CNET,TCOST
"RTN","PSUV9",122,0)
 ;
"RTN","PSUV9",123,0)
 S CNET=$P($G(PSUIVA(PSUDIV)),U,5)
"RTN","PSUV9",124,0)
 S TCOST=$P($G(PSUIVA(PSUDIV)),U,6)
"RTN","PSUV9",125,0)
 ;
"RTN","PSUV9",126,0)
 I CNET'="",CNET'=0,TCOST'="" D
"RTN","PSUV9",127,0)
 .S $P(PSUIVA(PSUDIV),U,7)=TCOST/CNET
"RTN","PSUV9",128,0)
 .;
"RTN","PSUV9",129,0)
 .;Truncate cost to 2 decimal places
"RTN","PSUV9",130,0)
 .N A,B,C
"RTN","PSUV9",131,0)
 .;
"RTN","PSUV9",132,0)
 .I $P(PSUIVA(PSUDIV),U,7)'["." D  Q
"RTN","PSUV9",133,0)
 ..S $P(PSUIVA(PSUDIV),U,7)=$P(PSUIVA(PSUDIV),U,7)_".00"
"RTN","PSUV9",134,0)
 .;
"RTN","PSUV9",135,0)
 .S A=$F($P(PSUIVA(PSUDIV),U,7),".")  ;Find 1st position after decimal
"RTN","PSUV9",136,0)
 .;
"RTN","PSUV9",137,0)
 .S B=$E($P(PSUIVA(PSUDIV),U,7),1,(A-1)) ;Extract dollars and decimal
"RTN","PSUV9",138,0)
 .;
"RTN","PSUV9",139,0)
 .S C=$E($P(PSUIVA(PSUDIV),U,7),A,(A+1)) ;Extract cents after decimal
"RTN","PSUV9",140,0)
 .I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV9",141,0)
 .;
"RTN","PSUV9",142,0)
 .S $P(PSUIVA(PSUDIV),U,7)=B_C
"RTN","PSUV9",143,0)
 ;
"RTN","PSUV9",144,0)
 Q
"RTN","PSUV9",145,0)
 ;
"RTN","PSUV9",146,0)
TOTAL ;Add up column totals and place into ^XTMP global
"RTN","PSUV9",147,0)
 ;
"RTN","PSUV9",148,0)
 S PSUDI=0
"RTN","PSUV9",149,0)
 F  S PSUDI=$O(PSUIVA(PSUDI)) Q:PSUDI=""  D
"RTN","PSUV9",150,0)
 .S LDSP=$G(LDSP)+$P(PSUIVA(PSUDI),U,1)   ;Total CHEMO's dispensed
"RTN","PSUV9",151,0)
 .;
"RTN","PSUV9",152,0)
 .S LREC=$G(LREC)+$P(PSUIVA(PSUDI),U,2)   ;Total CHEMO's recycled
"RTN","PSUV9",153,0)
 .;
"RTN","PSUV9",154,0)
 .S LDES=$G(LDES)+$P(PSUIVA(PSUDI),U,3)   ;Total CHEMO's destroyed
"RTN","PSUV9",155,0)
 .;
"RTN","PSUV9",156,0)
 .S CLAN=$G(CLAN)+$P(PSUIVA(PSUDI),U,4)   ;Total CHEMO's cancelled
"RTN","PSUV9",157,0)
 .;
"RTN","PSUV9",158,0)
 .S NDSP=$G(NDSP)+$P(PSUIVA(PSUDI),U,5)   ;Total Net CHEMO's dispensed
"RTN","PSUV9",159,0)
 .;
"RTN","PSUV9",160,0)
 .S LTOT=$G(LTOT)+$P(PSUIVA(PSUDI),U,6)   ;Total of Total cost
"RTN","PSUV9",161,0)
 .;
"RTN","PSUV9",162,0)
 .;S CNDSP=$G(CNDSP)+$P(PSUIVA(PSUDI),U,7) ;Total of cost/net column
"RTN","PSUV9",163,0)
 .I $G(NDSP) S CNDSP=$G(LTOT)/NDSP D
"RTN","PSUV9",164,0)
 ..I CNDSP'["." S CNDSP=CNDSP_".00" Q
"RTN","PSUV9",165,0)
 ..N A,B,C
"RTN","PSUV9",166,0)
 ..S A=$F(CNDSP,".")  ;Find 1st position after decimal
"RTN","PSUV9",167,0)
 ..S B=$E(CNDSP,1,(A-1))   ;Extract dollars and decimal
"RTN","PSUV9",168,0)
 ..S C=$E(CNDSP,A,(A+1))   ;Extract cents after decimal
"RTN","PSUV9",169,0)
 ..I $L(C)'=2 S C=$E(C,1)_0
"RTN","PSUV9",170,0)
 ..S CNDSP=B_C
"RTN","PSUV9",171,0)
 ;
"RTN","PSUV9",172,0)
 I '$D(LDSP) S LDSP=0
"RTN","PSUV9",173,0)
 I '$D(LREC) S LREC=0
"RTN","PSUV9",174,0)
 I '$D(LDES) S LDES=0
"RTN","PSUV9",175,0)
 I '$D(CLAN) S CLAN=0
"RTN","PSUV9",176,0)
 I '$D(NDSP) S NDSP=0
"RTN","PSUV9",177,0)
 I '$D(LTOT) S LTOT="0.00"
"RTN","PSUV9",178,0)
 I '$D(CNDSP) S CNDSP="0.00"
"RTN","PSUV9",179,0)
 ;
"RTN","PSUV9",180,0)
 S ^XTMP(PSUIVSUB,"CHTOT")=$G(LDSP)_U_$G(LREC)_U_$G(LDES)_U_$G(CLAN)_U_$G(NDSP)_U_$G(LTOT)_U_$G(CNDSP)
"RTN","PSUV9",181,0)
 ;
"RTN","PSUV9",182,0)
 Q
"RTN","PSUV9",183,0)
 ;
"RTN","PSUV9",184,0)
REC ;Place contents of arrays into ^XTMP globals
"RTN","PSUV9",185,0)
 ;
"RTN","PSUV9",186,0)
 M ^XTMP(PSUIVSUB,"CH",PSUDIV)=PSUIVA(PSUDIV)   ;CHEMO RECORDS
"RTN","PSUV9",187,0)
 ;
"RTN","PSUV9",188,0)
 Q
"VER")
8.0^22.0
"BLD",5483,6)
^SEQ #1
**END**
**END**
