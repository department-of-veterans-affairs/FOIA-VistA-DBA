$TXT Created by GAVRILOV,SERGEY at DEV.DEV.FO-HINES.MED.VA.GOV  (KIDS) on Tuesday, 01/21/03 at 11:47
=============================================================================
Run Date: FEB 20, 2003                     Designation: ROR*1*3
Package : ROR - CLINICAL CASE REGISTRIES     Priority: Mandatory
Version : 1         SEQ #3                     Status: Released
                  Compliance Date: MAR 23, 2003
=============================================================================

Associated patches: (v)DG*5.3*415  <<= must be installed BEFORE `ROR*1*3'
                    (v)SD*5.3*254  <<= must be installed BEFORE `ROR*1*3'
                    (v)ROR*1*2     <<= must be installed BEFORE `ROR*1*3'

Subject: Race & Ethnicity

Category: 
  - Enhancement (Mandatory)
  - Routine

Description: 
============

 PLEASE, READ AND FOLLOW THE INSTALLATION INSTRUCTIONS.
  
 This patch modifies the Clinical Case Registries software according to the
 new Race & Ethnicity data model (introduced by the patches DG*5.3*415 and
 SD*5.3*254) and fixes some data extraction problems.
  
 The patch contains the following problem resolutions and enhancements:
  
 [01] Race & Ethnicity 
      ----------------
  
 The demographic data extraction code has been modified to extract the new 
 race an ethnicity data if it is available (see the documentation to the
 patches DG*5.3*415 and SD*5.3*254 for more details). Otherwise, the old
 race data is extracted (in the old format ) from the RACE (.06) field of
 the PATIENT file (#2).
  
 The code that detects changes in the demographic data since the previous
 data extraction has been modified to analyze the new RACE INFORMATION and
 ETHNICITY INFORMATION multiples of the PATIENT file (#2).
  
 The RORHL01, RORUPD50, RORUPD51 and RORUPD52 routines have been amended.
  
 [02] ROR PATIENT file redesign
      -------------------------
  
 The file has been completely redesigned to accommodate changes associated
 with the new Race & Ethnicity data model and to simplify the comparison to
 the PATIENT file data.
  
 The post-install routine of this patch automatically converts the content
 of the ROR PATIENT file (#798.4) to the new format.
  
 The RORRP4, RORUPD50, RORUPD51 and RORUPD52 routines have been amended.
  
 [03] New drug codes
      --------------
 Three new National Drug Codes (000004008694, 000004035009 and
 000004035039) are added to the DRUG THERAPY LIST multiple (17) of the ROR
 REGISTRY PARAMETERS file (#798.1) by the post-install routine (see the
 POST^RORP003 procedure for more details).
  
 [04] Historical data files
      ---------------------
  
 Some problems with the historical data extraction have been discovered 
 during the implementation of the package (especially, on the Cache sites).
 These problems were caused by the differences between underlying operating
 systems in the handling of the not-exactly-text data output into host
 files opened in text mode.
  
 The historical data extraction routines have been modified to open the 
 output files in binary mode and to do this only once for each file (the 
 files are not closed and reopened during the data extraction).
  
 The old host files with the same name(s) (with different version numbers
 where applicable) as the output file are deleted before the data
 extraction. This eliminates the possibility of using the old (possible
 invalid) data files if there is no historical data to extract and the new
 file is not created.
  
 The RORHDT04 and RORHDT05 routines have been amended.
  
 [05] Skip test patients
      ------------------
  
 The code that skips test patients during the registry update process has
 been modified to check for 5 leading zeros in patients' Social Security
 Numbers and for patient names starting with "ZZ" in addition to the TEST
 PATIENT INDICATOR field (.6) of the PATIENT file (#2).
  
 The RORUPD01, RORUPD50 and RORUTL01 routines have been amended.
  
 [06] Access to the registry files via FileMan
      ----------------------------------------
  
 Security of the ROR REGISTRY PARAMETERS (#798.1) and ROR LOG (#798.7)
 files has been enhanced. The security rules associated with the ROR LOCAL 
 REGISTRY (#798) and ROR PATIENT (798.4) files have been changed.
  
 Only users that have the appropriate security keys can access these files
 via FileMan. This is enforced by the screening logic (contained in the
 "SCR" node). A user can access records associated only with those
 registries that he/she has the keys for (for example, the ROR VA HEPC USER
 or ROR VA HEPC ADMIN keys are required to access the Hepatitis C related
 data).
  
 The programmer FileMan access code (@) will not grant full access to the 
 ROR files after installation of this patch. The ROR VA IRM security key
 must be allocated (after installation of this patch) for the IRM personnel
 designated to maintain the Clinical Case Registries software (patch
 installation, log reviews, etc). Users with the ROR VA IRM security key
 will have full access to the files.
  
 The RORACK, ROREXPR, RORLOG, RORLOG01, RORRP7, RORSET01, RORUPR1,
 RORUTL01, RORUTL02 and RORUTL05 routines have been amended.
  
 [07] Cancelled radiology exams
      -------------------------
  
 The routine that builds the radiology OBR segments has been modified so
 that it will not extract cancelled radiology exams.
  
 The RORHL04 routine has been amended.
  
 The NOIS reference for this problem is ISH-1202-41750.
  
 [08] Radiology CPT codes
      -------------------
  
 The routine that builds the radiology OBR segments has been modified so
 that it will send actual CPT codes instead of internal entry numbers of 
 the records of the CPT file (#81).
  
 The RORHL04 routine has been amended.
  
 The NOIS reference for this problem is ISH-1202-41890.
  
 [09] Old patch installation routines
      -------------------------------
  
 The following old patch installation routines (environment check,
 pre-install and post-install) are deleted from the accounts: RORENV01,
 RORENV02, RORPRE01, RORPOS01, RORPOS02, RORPOS03 and RORPOSU1.
  
 [10] Missing task parameters
      -----------------------
  
 An error message is recorded into the ROR LOG file (#798.7) in addition to
 an error recorded by the Taskman if a user has not entered the registry
 name(s) into the TASK PARAMETERS field when scheduling the nightly task 
 (the ROR TASK option).
  
 The ROR and RORERR20 routines have been amended.
  
 [11] Other enhancements
      ------------------
  
 Several new internal APIs and utilities have been designed and the
 functionality of some of the old ones has been enhanced.
  
 The RORERR, RORPUT01, RORTXT, RORUPD06 and RORUTL01 routines have been
 amended.
  
  
 Associated NOIS:
 ===============
 ISH-1202-41750
 ISH-1202-41890
 SBY-0203-30623
  
  
 Thanks to Test Sites:
 ====================
 Battle Creek
 Little Rock
 Palo Alto
  
  
 Routine Summary:
 ===============
  
 The following routines are included in this patch.  The second line of 
 each of these routines now looks like:
  
   <tab>;;1.0;CLINICAL CASE REGISTRIES;**<patchlist>**;May 14, 2002
  
                  Checksum
   Routine    Before     After   Patch List
   --------  --------  --------  ---------------------------
   ROR        2626117   2867817  2,3
   RORACK     3432402   3777678  3
   RORAPI01   2614007   2330240  3
   RORENV01   1326700       n/a
   RORENV02   2052764       n/a  2
   RORERR     2587128   3643026  3
   RORERR10  17181044  17293115  3
   RORERR20  10009159  11537436  2,3
   ROREXPR    2824404   2842752  2,3
   RORHDT04   7554610   8356244  2,3
   RORHDT05   3499618   3192213  3
   RORHL01    3080072   3306142  2,3
   RORHL04    4151190   3889494  2,3
   RORLOG     5635247   5650708  3
   RORLOG01   1572747   1593285  3
   RORNTEG    3534202   3493843  3
   RORP003        n/a   6424519  3
   RORPOS01   4925130       n/a
   RORPOS02   8457305       n/a  2
   RORPOS03   4325295       n/a  2
   RORPOSU1    665251       n/a
   RORPRE01   2036630       n/a
   RORPUT01       n/a   5750576  3
   RORRP4     5196987   5197581  3
   RORRP7     4903176   4925487  3
   RORSET01   4109746   4114786  3
   RORTXT         n/a    141117  3
   RORUPD01   8324705   8330275  2,3
   RORUPD06   2672977   3026476  3
   RORUPD50   3759178   3644334  2,3
   RORUPD51   9694351   6856241  2,3
   RORUPD52   2507568   2548867  3
   RORUPR1   11398836  11409300  2,3
   RORUTL01   5264165   6303246  3
   RORUTL02   6381475   5690818  2,3
   RORUTL05   8206633   8216179  2,3
  
  
 Data Dictionary Summary:
 =======================
  
     File     Field     Comments
   --------  -------  ---------------------------------------------
  
   798                The permanent screen logic (the "SCR" node)
                      has been modified; the file description has
                      been updated.
  
   798.1              A permanent screen (the "SCR" node) has been
                      added; the file description has been updated.
  
   798.1     .01      The field description has been updated to
                      reflect introduction of the screen.
  
   798.19    .02      New values (9:Pathology-Surgical, 10:Pathology-
                      Cyto, 11:Microbiology, 12:EKG, 13:Allergy and
                      14:IV) have been added to the set of codes in
                      preparation for the ICR v3.0 implementation.
  
   798.4     All      The file has been redesigned to simplify the
                      comparison to the PATIENT file (#2) data and
                      to accommodate changes associated with the new
                      Race & Ethnicity data model.
  
   798.7              A permanent screen (the "SCR" node) has been  
                      added; the file description has been updated.
  
   798.7     .01      The field description has been updated to
                      reflect introduction of the screen.
  
   798.7       1      New value (5:Report) has been added to the
                      set of codes in preparation for the ICR v3.0
                      implementation.
  
 Data dictionary changes were approved by the DBA.
  
  
 Installation Instructions:
 =========================
  
 Installation of this patch will not take more than 20 minutes.
  
 The patch can be installed with VistA users online.
  
 NOTE #1: The nightly task (the [ROR TASK] option) must not be running
          during the installation!
  
 NOTE #2: Make sure that nobody uses the Clinical Case Registries
          (Hep C) package during the installation!
  
 Taskman does not need to be STOPPED or placed in a WAIT state.
  
   1. AXP/DSM sites: Review your mapped routine set. If any of the 
 routine(s) listed in the ROUTINE SUMMARY section are mapped, they should
 be removed from the mapped set at this time.
  
   2. Use the "INSTALL/CHECK MESSAGE" option on the Packman menu. This 
 option loads the patch into a Transport Global on your system.
  
   3. On the KIDS menu, select the "Installation" menu, and use the 
 following options to install the Transport Global:
  
    Verify Checksums in Transport Global
    Print Transport Global
    Compare Transport Global to Current System
    Backup a Transport Global
    Install Package(s)
  
    Select INSTALL NAME: ROR*1.0*3
                         =========
    Want KIDS to INHIBIT LOGONs during the install? NO
                                                    ==
    Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES
                                                                    ===
    Enter options you wish to mark as 'Out Of Order': ROR TASK
                                                      ========
    Enter options you wish to mark as 'Out Of Order': <RET>
  
    Enter protocols you wish to mark as 'Out Of Order': <RET>
  
    Delay Install (Minutes):  (0-60): 0// <RET>
  
   4. AXP/DSM sites: After the patch has been installed, if any routines 
 were removed from the mapped set in Step 1 above, rebuild your map set.
  
   5. Allocate the ROR VA IRM security key for the IRM personnel designated
 to support and maintain the Clinical Case Registries software.
  
   6. Examine the patch installation log (using the Print Log Files option 
 of the [RORMNT MAIN] menu). If there were errors during the conversion of
 the ROR PATIENT file (due to damaged internal structure of the file), fix
 them and restart the installation using the Restart Install of Package(s)
 option of the KIDS Installation menu.
  
   7. After the installation is complete, make sure that the ROR TASK
 option is not marked Out-Of-Order.

Routine Information:
====================

Routine Name:
  - RORNTEG


Routine Checksum:

Routine Name:
  - RORERR20


Routine Checksum:

Routine Name:
  - RORHDT04


Routine Checksum:

Routine Name:
  - RORHDT05


Routine Checksum:

Routine Name:
  - RORUPD01


Routine Checksum:

Routine Name:
  - RORUPD50


Routine Checksum:

Routine Name:
  - RORUTL01


Routine Checksum:

Routine Name:
  - RORHL01


Routine Checksum:

Routine Name:
  - RORUPD06


Routine Checksum:

Routine Name:
  - ROR


Routine Checksum:

Routine Name:
  - RORERR


Routine Checksum:

Routine Name:
  - RORACK


Routine Checksum:

Routine Name:
  - ROREXPR


Routine Checksum:

Routine Name:
  - RORLOG


Routine Checksum:

Routine Name:
  - RORLOG01


Routine Checksum:

Routine Name:
  - RORP003


Routine Checksum:

Routine Name:
  - RORRP7


Routine Checksum:

Routine Name:
  - RORSET01


Routine Checksum:

Routine Name:
  - RORUPD51


Routine Checksum:

Routine Name:
  - RORUPD52


Routine Checksum:

Routine Name:
  - RORUPR1


Routine Checksum:

Routine Name:
  - RORUTL02


Routine Checksum:

Routine Name:
  - RORUTL05


Routine Checksum:

Routine Name:
  - RORRP4


Routine Checksum:

Routine Name:
  - RORPUT01


Routine Checksum:

Routine Name:
  - RORTXT


Routine Checksum:

Routine Name:
  - RORHL04


Routine Checksum:

Routine Name:
  - RORERR10


Routine Checksum:

Routine Name:
  - RORAPI01


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : GAVRILOV,SERGUEI               Date Entered : OCT 10, 2002
Completed By: PATRICK,PAT                   Date Completed: FEB 19, 2003
Released By : GIVENS,DALE S                Date Released : FEB 20, 2003
=============================================================================


Packman Mail Message:
=====================

$END TXT
