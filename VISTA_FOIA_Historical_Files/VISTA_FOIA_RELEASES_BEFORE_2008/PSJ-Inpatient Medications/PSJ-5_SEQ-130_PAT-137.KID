Released PSJ*5*137 SEQ #130
Extracted from mail message
**KIDS**:PSJ*5.0*137^

**INSTALL NAME**
PSJ*5.0*137
"BLD",5765,0)
PSJ*5.0*137^INPATIENT MEDICATIONS^0^3050317^y
"BLD",5765,1,0)
^^9^9^3050317^
"BLD",5765,1,1,0)
 1. From NOIS call BED-1004-10719, Regarding the reinstated 
"BLD",5765,1,2,0)
    medications notification email message, "It doesn't look
"BLD",5765,1,3,0)
    like the ordering clinician gets any notification."  This
"BLD",5765,1,4,0)
    patch will add the ordering physician to the list of
"BLD",5765,1,5,0)
    email recipients.
"BLD",5765,1,6,0)
    
"BLD",5765,1,7,0)
 2. BAY-0205-30845, Syntax Error at WRD+1^PSIVRNL.
"BLD",5765,1,8,0)
    This patch will correct the syntax error included in this
"BLD",5765,1,9,0)
    routine.
"BLD",5765,4,0)
^9.64PA^^
"BLD",5765,"KRN",0)
^9.67PA^8989.52^19
"BLD",5765,"KRN",.4,0)
.4
"BLD",5765,"KRN",.401,0)
.401
"BLD",5765,"KRN",.402,0)
.402
"BLD",5765,"KRN",.403,0)
.403
"BLD",5765,"KRN",.5,0)
.5
"BLD",5765,"KRN",.84,0)
.84
"BLD",5765,"KRN",3.6,0)
3.6
"BLD",5765,"KRN",3.8,0)
3.8
"BLD",5765,"KRN",9.2,0)
9.2
"BLD",5765,"KRN",9.8,0)
9.8
"BLD",5765,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5765,"KRN",9.8,"NM",1,0)
PSGOERI^^0^B16682330
"BLD",5765,"KRN",9.8,"NM",2,0)
PSIVRNL^^0^B29209489
"BLD",5765,"KRN",9.8,"NM","B","PSGOERI",1)

"BLD",5765,"KRN",9.8,"NM","B","PSIVRNL",2)

"BLD",5765,"KRN",19,0)
19
"BLD",5765,"KRN",19.1,0)
19.1
"BLD",5765,"KRN",101,0)
101
"BLD",5765,"KRN",409.61,0)
409.61
"BLD",5765,"KRN",771,0)
771
"BLD",5765,"KRN",870,0)
870
"BLD",5765,"KRN",8989.51,0)
8989.51
"BLD",5765,"KRN",8989.52,0)
8989.52
"BLD",5765,"KRN",8994,0)
8994
"BLD",5765,"KRN","B",.4,.4)

"BLD",5765,"KRN","B",.401,.401)

"BLD",5765,"KRN","B",.402,.402)

"BLD",5765,"KRN","B",.403,.403)

"BLD",5765,"KRN","B",.5,.5)

"BLD",5765,"KRN","B",.84,.84)

"BLD",5765,"KRN","B",3.6,3.6)

"BLD",5765,"KRN","B",3.8,3.8)

"BLD",5765,"KRN","B",9.2,9.2)

"BLD",5765,"KRN","B",9.8,9.8)

"BLD",5765,"KRN","B",19,19)

"BLD",5765,"KRN","B",19.1,19.1)

"BLD",5765,"KRN","B",101,101)

"BLD",5765,"KRN","B",409.61,409.61)

"BLD",5765,"KRN","B",771,771)

"BLD",5765,"KRN","B",870,870)

"BLD",5765,"KRN","B",8989.51,8989.51)

"BLD",5765,"KRN","B",8989.52,8989.52)

"BLD",5765,"KRN","B",8994,8994)

"BLD",5765,"QUES",0)
^9.62^^
"BLD",5765,"REQB",0)
^9.611^2^2
"BLD",5765,"REQB",1,0)
PSJ*5.0*3^2
"BLD",5765,"REQB",2,0)
PSJ*5.0*110^2
"BLD",5765,"REQB","B","PSJ*5.0*110",2)

"BLD",5765,"REQB","B","PSJ*5.0*3",1)

"MBREQ")
0
"PKG",221,-1)
1^1
"PKG",221,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",221,20,0)
^9.402P^^
"PKG",221,22,0)
^9.49I^1^1
"PKG",221,22,1,0)
5.0^2971215^2981113^1
"PKG",221,22,1,"PAH",1,0)
137^3050317
"PKG",221,22,1,"PAH",1,1,0)
^^9^9^3050317
"PKG",221,22,1,"PAH",1,1,1,0)
 1. From NOIS call BED-1004-10719, Regarding the reinstated 
"PKG",221,22,1,"PAH",1,1,2,0)
    medications notification email message, "It doesn't look
"PKG",221,22,1,"PAH",1,1,3,0)
    like the ordering clinician gets any notification."  This
"PKG",221,22,1,"PAH",1,1,4,0)
    patch will add the ordering physician to the list of
"PKG",221,22,1,"PAH",1,1,5,0)
    email recipients.
"PKG",221,22,1,"PAH",1,1,6,0)
    
"PKG",221,22,1,"PAH",1,1,7,0)
 2. BAY-0205-30845, Syntax Error at WRD+1^PSIVRNL.
"PKG",221,22,1,"PAH",1,1,8,0)
    This patch will correct the syntax error included in this
"PKG",221,22,1,"PAH",1,1,9,0)
    routine.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PSGOERI")
0^1^B16682330
"RTN","PSGOERI",1,0)
PSGOERI ;BIR/CML3-REINSTATE A DC'D ORDER ;06 Aug 98 / 2:17 PM
"RTN","PSGOERI",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**17,27,31,88,110,137**;16 DEC 97
"RTN","PSGOERI",3,0)
 ;
"RTN","PSGOERI",4,0)
 ; Reference to ^PS(55 is supported by DBIA# 2191
"RTN","PSGOERI",5,0)
 ;
"RTN","PSGOERI",6,0)
ENRI ;
"RTN","PSGOERI",7,0)
 S PSGALR=80,PSGFD=$P($G(^PS(55,PSGP,5,+PSGORD,2)),"^",3) I 'PSGFD W:'$D(PSJUNDC) $C(7),$C(7),!?3,"I CANNOT REINSTATE THIS ORDER!  THE OLD STOP DATE IS MISSING!" Q
"RTN","PSGOERI",8,0)
 I PSGFD'>PSGDT Q:$D(PSJUNDC)  W !!,"This order has technically expired as of ",$$ENDTC^PSGMI,"." F  S %=1 W !!,"Do you want to RENEW this order" D YN^DICN Q:%  D
"RTN","PSGOERI",9,0)
 .W !!?2,"This order has expired, and cannot be renewed.  But the order can be",!,"reinstated.  Answer 'YES' to reinstate the order now.  Answer 'NO' (or '^') if",!,"you do not want to reinstate this order now."
"RTN","PSGOERI",10,0)
 I PSGFD'>PSGDT G:%'=1 DONE S PSGRRF=0 D NEW^PSGOER,DONE^PSGOER G DONE
"RTN","PSGOERI",11,0)
 W:'$D(PSJUNDC) !!,"...reinstating this order..."
"RTN","PSGOERI",12,0)
 ;Create a list of recipients beyond normal mail group
"RTN","PSGOERI",13,0)
 D:$D(PSJUNDC)  ;  do only if from movement deletion 
"RTN","PSGOERI",14,0)
 .I $P(^PS(55,PSGP,5,+PSGORD,4),U,1)'="" S PSJSENTO($J,$P(^PS(55,PSGP,5,+PSGORD,4),U,1))="" ; Record verifying Nurse
"RTN","PSGOERI",15,0)
 .I $P(^PS(55,PSGP,5,+PSGORD,4),U,3)'="" S PSJSENTO($J,$P(^PS(55,PSGP,5,+PSGORD,4),U,3))="" ; Record verifying Pharmacist
"RTN","PSGOERI",16,0)
 .I $P(^PS(55,PSGP,5,+PSGORD,4),U,5)'="" S PSJSENTO($J,$P(^PS(55,PSGP,5,+PSGORD,4),U,5))="" ; Record Physician
"RTN","PSGOERI",17,0)
 .I $P(^PS(55,PSGP,5,+PSGORD,0),U,2)'="" S PSJSENTO($J,$P(^PS(55,PSGP,5,+PSGORD,0),U,2))="" ; Record Provider
"RTN","PSGOERI",18,0)
 ;If a duplicate order exists do not reinstate the older one.  Record in ^TMP for later advice in auto e-mail (PSJADT2)
"RTN","PSGOERI",19,0)
 D NOW^%DTC
"RTN","PSGOERI",20,0)
 I $D(PSJUNDC) I $$CHECKDUP^PSGOERI(PSGP,+PSGORD) S ^TMP("PSJNOTUNDC",$J,PSGP,PSGORD_"U")="" G DONE
"RTN","PSGOERI",21,0)
 S DR=$S(+$P($G(^PS(55,PSGP,5,+PSGORD,4)),U,18)=1:"28///H",+$P($G(^(4)),U,26)=1:"28///H",1:"28////A")_";34////"_PSGFD
"RTN","PSGOERI",22,0)
 S Z=$G(^PS(55,PSGP,5,+PSGORD,4)),$P(Z,U,11)="",$P(Z,"^",15,17)="^^" S:'$D(PSJUNDC) $P(Z,"^",PSJSYSU,PSJSYSU+1)=DUZ_"^"_PSGDT S ^(4)=Z W "."
"RTN","PSGOERI",23,0)
 N CHKIT S CHKIT=$G(^PS(55,PSGP,5,+PSGORD,0)) I $P(CHKIT,U,26)["P",($P(CHKIT,U,27)="R") S DR=DR_";105///@;107///@"
"RTN","PSGOERI",24,0)
 S DIE="^PS(55,"_PSGP_",5,",DA(1)=PSGP,DA=+PSGORD,PSGAL("C")=$S($D(PSJUNDC):40,1:(PSJSYSU*10))+18500 D ^PSGAL5 W "." D ^DIE W "."
"RTN","PSGOERI",25,0)
 S X=$P(^PS(55,PSGP,5,+PSGORD,0),"^",20),$P(^(0),"^",20)="" K:X ^PS(55,"AUDDD",X,PSGP,+PSGORD) ;Removed cross reference after reinstate order.
"RTN","PSGOERI",26,0)
 ;S X=$O(^ORD(101,"B","PS EVSEND OR",0))_";ORD(101,",PSOC="SC",PSJORDER=$$ORDER^PSJHLU(PSGORD) D EN1^XQOR:X K X
"RTN","PSGOERI",27,0)
 S ^TMP("PSJUNDC",$J,PSGP,PSGORD_"U")=""
"RTN","PSGOERI",28,0)
 D EN1^PSJHL2(PSGP,"SC",PSGORD_"U",$S($D(PSJUNDC):"AUTO REINSTATED",1:"REINSTATED"))
"RTN","PSGOERI",29,0)
 Q:$S('$D(PSJUNDC):0,PSGALO=18540:1,1:'$P($G(PSJSYSW0),U,15))
"RTN","PSGOERI",30,0)
 S PSGTOL=$S($D(PSJUNDC):3,1:2),PSGUOW=$S($D(PSJUNDC):PSJUOW,1:DUZ)
"RTN","PSGOERI",31,0)
 I $D(^PS(53.41,1,1,+PSGUOW,1,PSGP,1,1,1,+PSGORD)) K DIK,DA S DIK="^PS(53.41,"_1_",1,"_+PSGUOW_",1,"_PSGP_",1,1,1,",DA=+PSGORD,DA(1)=1,DA(2)=PSGP,DA(3)=+PSGUOW,DA(4)=1 D ^DIK
"RTN","PSGOERI",32,0)
 E  D
"RTN","PSGOERI",33,0)
 .S X=0 S:$D(PSJUNDC) X=$O(^PS(59.6,"B",+PSGUOW,0)),X=$P($G(^PS(59.6,+X,0)),U,15)
"RTN","PSGOERI",34,0)
 .I $S(X:1,'PSJSYSL:0,PSJSYSL<3:1,1:$P(^PS(55,PSGP,5,DA,4),"^",+PSJSYSU'=3+9)) D
"RTN","PSGOERI",35,0)
 ..K DA S DA=+PSGORD,DA(1)=PSGP,$P(^PS(55,PSGP,5,DA,7),"^",1,2)=PSGDT_"^RE",PSGTOO=1,PSGUOW=$S($D(PSJUNDC):+PSJUOW,1:DUZ) D ENL^PSGVDS W "."
"RTN","PSGOERI",36,0)
 W:'$D(PSJUNDC) ".DONE!" Q
"RTN","PSGOERI",37,0)
 ;
"RTN","PSGOERI",38,0)
DONE ;
"RTN","PSGOERI",39,0)
 K DA,DIE,DR,PSGAL,PSGALR,PSGFD,PSGID,PSGOD,RF,Z
"RTN","PSGOERI",40,0)
 Q
"RTN","PSGOERI",41,0)
CHECKDUP(PSGP,PSGORD) ;
"RTN","PSGOERI",42,0)
 N Z,ZZ,PSJCOM
"RTN","PSGOERI",43,0)
 S FOUND=0
"RTN","PSGOERI",44,0)
 S PSGX=+$G(^PS(55,PSGP,5,+PSGORD,.2)),PSJCOM=+$P($G(^(.2)),"^",8)
"RTN","PSGOERI",45,0)
 I PSGX'="" D
"RTN","PSGOERI",46,0)
 .F Z=%:0 S Z=$O(^PS(55,+PSGP,5,"AUS",Z)) Q:'Z!FOUND  D
"RTN","PSGOERI",47,0)
 ..F ZZ=0:0 S ZZ=$O(^PS(55,+PSGP,5,"AUS",Z,ZZ)) Q:'ZZ!FOUND  D
"RTN","PSGOERI",48,0)
 ...I PSJCOM>0 Q:+$P($G(^PS(55,+PSGP,5,ZZ,.2)),"^",8)=PSJCOM
"RTN","PSGOERI",49,0)
 ...I +$G(^PS(55,+PSGP,5,ZZ,.2))=PSGX D
"RTN","PSGOERI",50,0)
 ....S FOUND=1
"RTN","PSGOERI",51,0)
 Q FOUND
"RTN","PSIVRNL")
0^2^B29209489
"RTN","PSIVRNL",1,0)
PSIVRNL ;BIR/RGY-PRINT RENEWAL AND ACTIVE ORDER LIST ; 15 May 98 / 9:27 AM
"RTN","PSIVRNL",2,0)
 ;;5.0; INPATIENT MEDICATIONS ;**3,137**;16 DEC 97
"RTN","PSIVRNL",3,0)
 ;
"RTN","PSIVRNL",4,0)
ENRNL ;
"RTN","PSIVRNL",5,0)
 D ^PSIVXU I $D(XQUIT) K XQUIT Q
"RTN","PSIVRNL",6,0)
 D BEGRNL K DFN,I,ON,P,PSIV,PSIV1,PSIVBEG,PSIVDT,PSIVEND,PSIVRUN,WARD,WRD,WRDB,WRDE,VAERR,Z
"RTN","PSIVRNL",7,0)
 Q
"RTN","PSIVRNL",8,0)
 ;
"RTN","PSIVRNL",9,0)
BEGRNL W ! S %DT="EXT",X="Enter beginning date: ^T@0001^^^1" D ENQ^PSIV,^%DT G:X["^" QRNL G:Y<0&(X'="?") BEGRNL I X["?" S HELP="RNL" D ^PSIVHLP G BEGRNL
"RTN","PSIVRNL",10,0)
 S PSIVBEG=Y I Y'["." W $C(7),!!,"*** Please enter time with date. ***",! G BEGRNL
"RTN","PSIVRNL",11,0)
ENDRNL W ! S X="Enter ending date: ^T@2400^^^1" D ENQ^PSIV,^%DT G:X["^" QRNL G:Y<0&(X'="?") ENDRNL I X["?" S HELP="RNL" D ^PSIVHLP G ENDRNL
"RTN","PSIVRNL",12,0)
 I Y'["." W $C(7),!!,"*** Please enter time with date. ***",! G ENDRNL
"RTN","PSIVRNL",13,0)
EN1 S PSIVEND=Y K WRD
"RTN","PSIVRNL",14,0)
BEG K DIR S DIR(0)="F^1:30",DIR("A")="Start at WARD",DIR("B")="BEG"
"RTN","PSIVRNL",15,0)
 S DIR("?")="or enter any ward.",DIR("?",1)="Press <RETURN> to start from the first ward",DIR("?",2)="or enter ""^Outpatient"" for Outpatient IV"
"RTN","PSIVRNL",16,0)
 D ^DIR
"RTN","PSIVRNL",17,0)
 G QRNL:$D(DTOUT)!("^"[X) I X="BEG" S WRDB="" G END
"RTN","PSIVRNL",18,0)
 S X=$$ENLU^PSGMI(X) I "^OUTPATIENT"[X W $P("^OUTPATIENT IV",X,2) S WRDB="Outpatient IV" G END
"RTN","PSIVRNL",19,0)
 I X]"" K DA,DIC S DIC="^DIC(42,",DIC(0)="QEM" D ^DIC K DA,DIC G:Y<1 BEG
"RTN","PSIVRNL",20,0)
 S WRDB=$P(Y,"^",2)
"RTN","PSIVRNL",21,0)
END K DIR S DIR(0)="F^1:30",DIR("A")="Stop at WARD",DIR("B")="END"
"RTN","PSIVRNL",22,0)
 S DIR("?")="or enter any ward.",DIR("?",1)="Press <RETURN> to stop at the last ward",DIR("?",2)="or enter ""^Outpatient"" for Outpatient IV"
"RTN","PSIVRNL",23,0)
 D ^DIR
"RTN","PSIVRNL",24,0)
 G QRNL:$D(DTOUT)!("^"[X) I X="END" S WRDE="z" G WRD
"RTN","PSIVRNL",25,0)
 S X=$$ENLU^PSGMI(X) I "^OUTPATIENT"[X W $P("^OUTPATIENT IV",X,2) S WRDE="Outpatient IV" G WRD
"RTN","PSIVRNL",26,0)
 I X]"" K DA,DIC S DIC="^DIC(42,",DIC(0)="QEM" D ^DIC K DA,DIC G:Y<1 END
"RTN","PSIVRNL",27,0)
 S WRDE=$P(Y,"^",2)
"RTN","PSIVRNL",28,0)
WRD S WRDB=$E(WRDB,1,$L(WRDB)-1)_$C($A(WRDB,$L(WRDB))-1),WRDE=$E(WRDE,1,$L(WRDE)-1)_$C($A(WRDE,$L(WRDE))+1) K X S X(WRDE)=""
"RTN","PSIVRNL",29,0)
 I $O(X(WRDB))'=WRDE W ! K DIR S DIR(0)="E",DIR("A",1)="The starting ward must be alphabetically before the ending ward.",DIR("A")="Press <RETURN> to continue" D ^DIR K X G BEG
"RTN","PSIVRNL",30,0)
 I PSIVPR'=ION D QUERNL G QRNL
"RTN","PSIVRNL",31,0)
DEQRNL K ^UTILITY("PSIV",$J) S (WARD,^($J,WRDE))="" D NOW^%DTC S:$E(PSIVEND)=9 PSIVBEG=% S PSIVRUN=$E(%,1,12)
"RTN","PSIVRNL",32,0)
 F PSIVDT=PSIVBEG-.0001:0 S PSIVDT=$O(^PS(55,"AIV",PSIVDT)) Q:'PSIVDT!(PSIVDT>PSIVEND)  F DFN=0:0 S DFN=$O(^PS(55,"AIV",PSIVDT,DFN)) Q:'DFN  D DEQRNL1
"RTN","PSIVRNL",33,0)
 S WRD=WRDB F PSIV1=0:0 S WRD=$O(^UTILITY("PSIV",$J,WRD)) Q:WRD=""!(WRDE']WRD)  F DFN=0:0 S DFN=$O(^UTILITY("PSIV",$J,WRD,DFN)) Q:'DFN  F ON=0:0 S ON=$O(^UTILITY("PSIV",$J,WRD,DFN,ON)) Q:'ON  D SETP,CHK
"RTN","PSIVRNL",34,0)
QRNL W:'$D(PSIVPR)&($Y) @IOF K ^UTILITY("PSIV",$J) S:$D(ZTQUEUED) ZTREQ="@" Q
"RTN","PSIVRNL",35,0)
WD X ^DD("DD") W $P(Y,"@")," ",$P(Y,"@",2) Q
"RTN","PSIVRNL",36,0)
SETP S Y=^PS(55,DFN,"IV",ON,0) F X=1:1:23 S P(X)=$P(Y,"^",X)
"RTN","PSIVRNL",37,0)
 Q
"RTN","PSIVRNL",38,0)
 ;
"RTN","PSIVRNL",39,0)
DEQRNL1 ;
"RTN","PSIVRNL",40,0)
 S PSIV("NME")=$P($G(^DPT(DFN,0)),U) D INP^VADPT F ON=0:0 S ON=$O(^PS(55,"AIV",PSIVDT,DFN,ON)) Q:'ON  D SETP,UT
"RTN","PSIVRNL",41,0)
 Q
"RTN","PSIVRNL",42,0)
PRNT D:$Y+7>IOSL!(WARD'=WRD) HDR D ENIV^PSJAC W !,VAIN(5),?30 S PSIV=$O(^PS(55,DFN,"IV",ON,"AD",0)) D:PSIV ENP2 W ?80 S Y=P(3) D WD W ?105,$P($G(^VA(200,+P(6),0)),"^")
"RTN","PSIVRNL",43,0)
ENP1 W !,VADM(1)
"RTN","PSIVRNL",44,0)
 S SSNF=0
"RTN","PSIVRNL",45,0)
ENP3 I PSIV]"" S PSIV=$O(^PS(55,DFN,"IV",ON,"AD",PSIV)) I PSIV D ENP2 W ! D CHK2
"RTN","PSIVRNL",46,0)
 I PSIV]"" F PSIV=PSIV:0 S PSIV=$O(^PS(55,DFN,"IV",ON,"AD",PSIV)) Q:'PSIV  D ENP2 W ! D CHK2
"RTN","PSIVRNL",47,0)
 F PSIV=0:0 S PSIV=$O(^PS(55,DFN,"IV",ON,"SOL",PSIV)) Q:'PSIV  D
"RTN","PSIVRNL",48,0)
 .; naked ref below refers to line above
"RTN","PSIVRNL",49,0)
 .S PSIV=PSIV_"^"_^(PSIV,0) W ?30,$S($D(^PS(52.7,$P(PSIV,"^",2),0)):$P(^(0),"^")_" "_$P(PSIV,"^",3)_" "_$P(^(0),"^",4),1:"*** Undefined Solution"),! D CHK2
"RTN","PSIVRNL",50,0)
 W:P(8)]"" ?30,$P(P(8),"@"),! D CHK2
"RTN","PSIVRNL",51,0)
 W:P(9)]"" ?30,P(9) W:P(11)]"" " (",P(11),")" W:P(9)_P(11)]"" ! D CHK2
"RTN","PSIVRNL",52,0)
 S PSIV=$S($D(^PS(55,DFN,"IV",ON,3)):$P(^(3),"^"),1:"") W:PSIV]"" ?30,"Other print info.: ",PSIV,! D CHK2
"RTN","PSIVRNL",53,0)
 ; naked ref below refers to line above
"RTN","PSIVRNL",54,0)
 S PSIV=$S($D(^(1)):$P(^(1),"^"),1:"") W:PSIV]"" ?40,"Remarks: ",PSIV,! D CHK2
"RTN","PSIVRNL",55,0)
 I "OHD"[P(17) S Y=^DD(55.01,100,0),X=P(17),X=$P($P(";"_$P(Y,"^",3),";"_X_":",2),";") W ?30,"*** THIS ORDER HAS A STATUS OF '",X,"' ***",!
"RTN","PSIVRNL",56,0)
 D CHK2 K SSNF Q
"RTN","PSIVRNL",57,0)
ENP2 S PSIV=PSIV_"^"_^PS(55,DFN,"IV",ON,"AD",+PSIV,0) W ?30,$S($D(^PS(52.6,$P(PSIV,"^",2),0)):$P(^(0),"^")_" "_$P(PSIV,"^",3),1:"*** Undefined Additive") I $P(PSIV,"^",4)]"" W " (",$P(PSIV,"^",4),")"
"RTN","PSIVRNL",58,0)
 S PSIV=+PSIV Q
"RTN","PSIVRNL",59,0)
HDR W:$Y @IOF,!! I $E(PSIVEND)=9 W "Active order list"
"RTN","PSIVRNL",60,0)
 E  W "Renewal list from " S Y=PSIVBEG D WD W " to " S Y=PSIVEND D WD
"RTN","PSIVRNL",61,0)
 W !,"Printed on: " S Y=PSIVRUN D WD W !!,"Patient name",?40,"Order",?80,"Stop date",?105,"Provider",! F Y=1:1:130 W "-"
"RTN","PSIVRNL",62,0)
 S WARD=WRD W !?50,"**** Ward: ",WRD," ****" W ! Q
"RTN","PSIVRNL",63,0)
QUERNL S ZTIO=PSIVPR,ZTDESC="IV "_$S($E(PSIVEND)=9:"ACTIVE ORDER",1:"RENEWAL")_" LIST",ZTRTN="DEQRNL^PSIVRNL" F X="WRDE","WRDB","PSIVBEG","PSIVEND","PSIVSITE","PSIVSN","PSJSYSW0","PSJSYSU","PSJSYSP","PSJSYSP0" S ZTSAVE(X)=""
"RTN","PSIVRNL",64,0)
 D ^%ZTLOAD W:$D(ZTSK) !,"Queued." G QRNL
"RTN","PSIVRNL",65,0)
UT S ^UTILITY("PSIV",$J,$S($P(VAIN(4),U,2)]"":$P(VAIN(4),U,2),1:"Outpatient IV"),DFN,ON)="" Q
"RTN","PSIVRNL",66,0)
CHK I "DEPN"'[P(17),$P($G(^PS(55,DFN,"IV",ON,2)),U,2)=PSIVSN D:$S($E(PSIVEND)=9:1,1:$P(^(2),U,9)'="R") PRNT
"RTN","PSIVRNL",67,0)
 Q
"RTN","PSIVRNL",68,0)
ENTACT D NOW^%DTC S PSIVBEG=%,Y=9999999 G EN1
"RTN","PSIVRNL",69,0)
CHK2 I '$G(SSNF) W VA("BID")," [",ON,"]" S SSNF=1 Q
"VER")
8.0^22.0
"BLD",5765,6)
^SEQ #130
**END**
**END**
