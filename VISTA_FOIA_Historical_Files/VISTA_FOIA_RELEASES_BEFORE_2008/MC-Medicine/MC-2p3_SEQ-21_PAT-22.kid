Released MC*2.3*22 SEQ #21
Extracted from mail message
**KIDS**:MC*2.3*22^

**INSTALL NAME**
MC*2.3*22
"BLD",1773,0)
MC*2.3*22^MEDICINE^0^^y
"BLD",1773,1,0)
^^1^1^2990420^
"BLD",1773,1,1,0)
Medicine patch MC*2.3*22
"BLD",1773,4,0)
^9.64PA^^
"BLD",1773,"ABPKG")
n
"BLD",1773,"KRN",0)
^9.67PA^19^18
"BLD",1773,"KRN",.4,0)
.4
"BLD",1773,"KRN",.401,0)
.401
"BLD",1773,"KRN",.402,0)
.402
"BLD",1773,"KRN",.403,0)
.403
"BLD",1773,"KRN",.5,0)
.5
"BLD",1773,"KRN",.84,0)
.84
"BLD",1773,"KRN",3.6,0)
3.6
"BLD",1773,"KRN",3.8,0)
3.8
"BLD",1773,"KRN",9.2,0)
9.2
"BLD",1773,"KRN",9.8,0)
9.8
"BLD",1773,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",1773,"KRN",9.8,"NM",1,0)
MCBPFTP1^^0^B22191419
"BLD",1773,"KRN",9.8,"NM",2,0)
MCPFTP1^^0^B22427615
"BLD",1773,"KRN",9.8,"NM",3,0)
MCPFTP1A^^0^B2100260
"BLD",1773,"KRN",9.8,"NM","B","MCBPFTP1",1)

"BLD",1773,"KRN",9.8,"NM","B","MCPFTP1",2)

"BLD",1773,"KRN",9.8,"NM","B","MCPFTP1A",3)

"BLD",1773,"KRN",19,0)
19
"BLD",1773,"KRN",19.1,0)
19.1
"BLD",1773,"KRN",101,0)
101
"BLD",1773,"KRN",409.61,0)
409.61
"BLD",1773,"KRN",771,0)
771
"BLD",1773,"KRN",869.2,0)
869.2
"BLD",1773,"KRN",870,0)
870
"BLD",1773,"KRN",8994,0)
8994
"BLD",1773,"KRN","B",.4,.4)

"BLD",1773,"KRN","B",.401,.401)

"BLD",1773,"KRN","B",.402,.402)

"BLD",1773,"KRN","B",.403,.403)

"BLD",1773,"KRN","B",.5,.5)

"BLD",1773,"KRN","B",.84,.84)

"BLD",1773,"KRN","B",3.6,3.6)

"BLD",1773,"KRN","B",3.8,3.8)

"BLD",1773,"KRN","B",9.2,9.2)

"BLD",1773,"KRN","B",9.8,9.8)

"BLD",1773,"KRN","B",19,19)

"BLD",1773,"KRN","B",19.1,19.1)

"BLD",1773,"KRN","B",101,101)

"BLD",1773,"KRN","B",409.61,409.61)

"BLD",1773,"KRN","B",771,771)

"BLD",1773,"KRN","B",869.2,869.2)

"BLD",1773,"KRN","B",870,870)

"BLD",1773,"KRN","B",8994,8994)

"BLD",1773,"QUES",0)
^9.62^^
"BLD",1773,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",31,-1)
1^1
"PKG",31,0)
MEDICINE^MC^MEDICINE PACKAGE INCLUDES ALL AREAS OF MEDICINE
"PKG",31,20,0)
^9.402P^^
"PKG",31,22,0)
^9.49I^1^1
"PKG",31,22,1,0)
2.3^2960913^2980615^4558
"PKG",31,22,1,"PAH",1,0)
22
"PKG",31,22,1,"PAH",1,1,0)
^^1^1^2990420
"PKG",31,22,1,"PAH",1,1,1,0)
Medicine patch MC*2.3*22
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","MCBPFTP1")
0^1^B22191419
"RTN","MCBPFTP1",1,0)
MCBPFTP1 ;WISC/TJK,ALG-PFT BRIEF REPORT-DEMO INFO ;4/12/99  10:12
"RTN","MCBPFTP1",2,0)
 ;;2.3;Medicine;**5,14,16,17,22**;09/13/1996
"RTN","MCBPFTP1",3,0)
 ; ------------------------
"RTN","MCBPFTP1",4,0)
 ; SSN = Enternal Format of the patients SSN with the first letter
"RTN","MCBPFTP1",5,0)
 ; of the last name tacked on the end
"RTN","MCBPFTP1",6,0)
 ; ------------------------
"RTN","MCBPFTP1",7,0)
 D DEM^VADPT S MCARGNM=VADM(1),SSN=VA("PID")
"RTN","MCBPFTP1",8,0)
 S X1=$E($P(MCPFT0,U),1,7),X2=$P(VADM(3),U)
"RTN","MCBPFTP1",9,0)
 ; ---------------------
"RTN","MCBPFTP1",10,0)
 ; AGE = the patients age at the date of the procedure
"RTN","MCBPFTP1",11,0)
 ; ---------------------
"RTN","MCBPFTP1",12,0)
 S AGE=$E(X1,1,3)-$E(X2,1,3)-($E(X1,4,7)<$E(X2,4,7))
"RTN","MCBPFTP1",13,0)
 S RACE=$P(VADM(8),U,2),CLIN="" S:$P(MCPFT0,U,10) CLIN=$P(MCPFT0,U,10) I CLIN,$D(^SC(CLIN,0)) S CLIN=$P(^(0),U)
"RTN","MCBPFTP1",14,0)
 S DATE=$P(MCPFT0,U),DATE=+$E(DATE,4,5)_"/"_+$E(DATE,6,7)_"/"_$E(DATE,2,3)_$S($P(DATE,".",2):"@"_+$E(DATE,9,10)_":"_$S($L($E(DATE,11,12))=2:$E(DATE,11,12),$L($E(DATE,11,12))=1:$E(DATE,11)_"0",1:"00"),1:"")
"RTN","MCBPFTP1",15,0)
 S HT1=$P(MCPFT0,U,4),WT1=$P(MCPFT0,U,5) S $P(MCDOT,".",81)=""
"RTN","MCBPFTP1",16,0)
 S HT=HT1*2.54,WT=WT1/2.2
"RTN","MCBPFTP1",17,0)
 S:'HT HT=$P(MCPFT0,U,3),HT1=HT/2.54 S:'WT WT=$P(MCPFT0,U,6),WT1=WT*2.2
"RTN","MCBPFTP1",18,0)
 S (MC17,MCEFF,MCSEX)="" S:$D(^MCAR(700,MCARGDA,17)) MC17=^(17),MCEFF=$P(MC17,U,6),MCEFF=$S(MCEFF="G":"GOOD",MCEFF="E":"EXCELLENT",MCEFF="P":"POOR",1:"")
"RTN","MCBPFTP1",19,0)
 ;S MCSEX=$P(VADM(5),U),X=$P(VADM(3),"^",2) S MCARDOB=$S(X'="":X,1:""),X=$P(MCPFT0,U) D DTIME^MCARP S MCARGDT=X,MCARZ="PULMONARY FUNCTION TEST"
"RTN","MCBPFTP1",20,0)
 S MCSEX=$P(VADM(5),U),X=$P(VADM(3),"^",2) S MCARDOB=$S(X'="":X,1:""),X=$P(MCPFT0,U),MCARGDT=X,MCARZ="PULMONARY FUNCTION TEST"
"RTN","MCBPFTP1",21,0)
 D INP^VADPT S MCARWARD=$S(VAIN(4)'="":$P(VAIN(4),U,2),1:"NOT INPATIENT"),MCARRB=VAIN(5) D NOW^%DTC S X=% D DTIME^MCARP S MCARDTM=X
"RTN","MCBPFTP1",22,0)
 S MCARZ="PULMONARY FUNCTION TEST"
"RTN","MCBPFTP1",23,0)
 D INIT^MCARP1(MCARZ,MCARGDT,MCFILE),HEAD^MCARP
"RTN","MCBPFTP1",24,0)
 W !,"SEX: ",MCSEX,"  AGE:",AGE,?30,HT1," in/",WT1," lb",?60,"AMBIENT: ",$P(MCPFT0,U,12),"C/",$P(MCPFT0,U,7),"T" K HT1,WT1
"RTN","MCBPFTP1",25,0)
 W !,RACE S TECH=$$GETVALUE^MCU(700,MCARGDA,34)
"RTN","MCBPFTP1",26,0)
 W ?60,"TECH: ",$E(TECH,1,14)
"RTN","MCBPFTP1",27,0)
 W !,$S($P(MCPFT0,U,8)="Y":"SMOKER",$P(MCPFT0,U,8)="N":"NON-SMOKER",1:"")
"RTN","MCBPFTP1",28,0)
 W ?30 W:$P(MCPFT0,U,9)="Y" "CURRENT BRONCHODILATOR USE"
"RTN","MCBPFTP1",29,0)
 W ?60,"EFFORT: ",MCEFF
"RTN","MCBPFTP1",30,0)
 S MCFF="S DN=1,MCY="""" I $Y>(IOSL-3) R:$E(IOST,1,2)=""C-"" !!,""Press Return to Continue, '^' to escape: "",MCY:DTIME S:'$T MCY=U S:MCY=U MCOUT=1,DN=0 Q:$D(MCOUT)  D:DN HEAD^MCARP D:$D(HEAD1) HEAD1^MCBPFTP2,HEAD2^MCBPFTP2 K MCY"
"RTN","MCBPFTP1",31,0)
 K ^UTILITY("DIQ1",$J) W !!,"CONSULT DX: " S DR(700.01)=.01,DIQ(0)="E",DIC="^MCAR(700,"
"RTN","MCBPFTP1",32,0)
 F K=0:0 S K=$O(^MCAR(700,MCARGDA,1,K)) Q:K'?1N.N  S DA=MCARGDA,DA(700.01)=K,DR=11,DIQ(0)="E" D EN^DIQ1 W ?15,^UTILITY("DIQ1",$J,700.01,K,.01,"E"),! X MCFF Q:$D(MCOUT)
"RTN","MCBPFTP1",33,0)
 K ^UTILITY("DIQ1",$J),DIQ Q:$D(MCOUT)  W !,MCDOT X MCFF Q:$D(MCOUT)  D PRED
"RTN","MCBPFTP1",34,0)
 S RDATE=9999999.9999-$P(MCPFT0,U)
"RTN","MCBPFTP1",35,0)
 W:$D(MCRCN) !,MCRCN D ^MCBPFTP2
"RTN","MCBPFTP1",36,0)
 I '$D(MCOUT),$G(MCESON) D FOOTER^MCESPRT(MCFILE,MCARGDA)  ;PATCH 28
"RTN","MCBPFTP1",37,0)
EXIT D:$D(ZTSK) KILL^%ZTLOAD K ZTSK
"RTN","MCBPFTP1",38,0)
EXIT1 D KVAR^VADPT K MCOUT,ACT,AGE,CK,CLIN,D0,D1,DA,DATE,CI95
"RTN","MCBPFTP1",39,0)
 K MCARGDT2,^UTILITY($J)
"RTN","MCBPFTP1",40,0)
 K BSA,HB,PH,PACO2,PAO2,O2HB,COHB,FIO2,MHB,PAAO2,QSQT,CAO2,CVO2
"RTN","MCBPFTP1",41,0)
 K DFN,DIC,DIW,DIWL,DIWR,DIWT,DLCOSB,DN,MCDOT,DR,FEV1,FRC,FVC,MC17
"RTN","MCBPFTP1",42,0)
 K HT,I,J,K,MCARGDA,MCARGNM,MCFF,MCK,MCN,MCPI,MCREC,MCREC1,MCVCN
"RTN","MCBPFTP1",43,0)
 K MCREC2,MCTLCN,MCVN,MCX,MEAS,FEF2575,ND,ND1,P1,P2,PC,PD1,PD11,MCEFF
"RTN","MCBPFTP1",44,0)
 K PD2,PD21,PF,MCPFT0,PG,PRED,MCPV,RACE,RDATE,RDATE1,RDATE2,RV,MCSEX
"RTN","MCBPFTP1",45,0)
 K SSN,TAB,TECH,TLC,TYPE,UNIT,UNITS,VC,WT,X,Z,VA,MCRCN
"RTN","MCBPFTP1",46,0)
 K MCMVVN,MVV,PMVV,MCSP,MCP1S0,MCP1S1,MCP1S2,MCP2S0,MCP2S1,MCP2S2
"RTN","MCBPFTP1",47,0)
 K CDLCOSB,MCIAO1,MCIAO2,MCIDA,MCIDL,MCIDP,MCIFA,MCIFE
"RTN","MCBPFTP1",48,0)
 K MCIFL,MCIFV,MCIPTL,MCIRV,MCITL,MCMAIN,MCP1,MCP2,MCRC,MCRCR,MCTYPEP,MCY,MCRC1,MCRC2,MCRC3,MCRC4   ;,MCARGDA
"RTN","MCBPFTP1",49,0)
 K MCARRB,MCARDOB,MCARWARD,MCARDTM,MCARHDR,MCARZ,MCARGDT,MCDL,MCLNG D KVAR^VADPT D ^%ZISC Q
"RTN","MCBPFTP1",50,0)
PRED S (FVC,CFVC,FEV1,F,TLC,MVV)=""
"RTN","MCBPFTP1",51,0)
 Q:'HT!'WT!'AGE!'$D(^MCAR(700,MCARGDA,"PV"))  Q:'(^("PV"))
"RTN","MCBPFTP1",52,0)
 S MCPV=^MCAR(700,MCARGDA,"PV") Q:'$D(^MCAR(700.1,MCPV))
"RTN","MCBPFTP1",53,0)
 S BSA=$$BSA^MCPFTP1(HT,WT)
"RTN","MCBPFTP1",54,0)
 F I="FEV1","FVC","TLC","MVV" D
"RTN","MCBPFTP1",55,0)
    .S:$D(^MCAR(700.1,MCPV,I)) @("P"_I)="S "_I_"="_$P(^MCAR(700.2,^MCAR(700.1,MCPV,I),0),U),@("C"_I)=$P(^MCAR(700.2,^MCAR(700.1,MCPV,I),0),U,5) X:$D(^MCAR(700.1,MCPV,I)) @("P"_I)
"RTN","MCBPFTP1",56,0)
 K PDLCOSB,PFEV1,PFRC,PFVC,PFEF2575,PPF,PRV,PTLC,PVC
"RTN","MCBPFTP1",57,0)
 S MCRCR="",MCRC=$G(^MCAR(700.1,MCPV,"RC")) Q:MCRC=""
"RTN","MCBPFTP1",58,0)
 S MCRCR=$G(^MCAR(700,MCARGDA,17)) Q:MCRCR=""  Q:$P(MCRCR,U,5)'="Y"
"RTN","MCBPFTP1",59,0)
 S MCRCR=$S(RACE["BLACK":"B",RACE["ASIAN":"O",1:"") Q:MCRCR=""
"RTN","MCBPFTP1",60,0)
 F I=1:1:4 I $P(MCRC,U,I) S J=$P(MCRC,U,I) D:J
"RTN","MCBPFTP1",61,0)
    .Q:'$D(^MCAR(700.2,J,0))  S J=$P(^(0),U,1)
"RTN","MCBPFTP1",62,0)
    .S @("MCRC"_I)="S PRED="_J
"RTN","MCBPFTP1",63,0)
 K J G ORIENTAL:MCRCR="O" K MCRC2
"RTN","MCBPFTP1",64,0)
 I '$D(MCRC1),'$D(MCRC3),'$D(MCRC4) Q
"RTN","MCBPFTP1",65,0)
 S:$D(MCRC1) MCRCN="TLC,FVC,FEV1" S:$D(MCRC3) MCRCN=MCRCN_",FRC,RV" S:$D(MCRC4) MCRCN=MCRCN_",FEF25-75" S:$E(MCRCN,1)="," MCRCN=$E(MCRCN,2,30)
"RTN","MCBPFTP1",66,0)
 G NOTE
"RTN","MCBPFTP1",67,0)
ORIENTAL I '$D(MCRC2) K MCRC1,MCRC3,MCRC4 Q
"RTN","MCBPFTP1",68,0)
 S MCRC1=MCRC2 K MCRC3,MCRC4 S MCRCN="TLC,FVC,FEV1"
"RTN","MCBPFTP1",69,0)
NOTE S MCRCN="NOTE:   Race Correction done on predicted values for: "_MCRCN
"RTN","MCBPFTP1",70,0)
 Q
"RTN","MCPFTP1")
0^2^B22427615
"RTN","MCPFTP1",1,0)
MCPFTP1 ;WISC/TJK-PFT REPORT-DEMO INFO ;4/20/99  11:28
"RTN","MCPFTP1",2,0)
 ;;2.3;Medicine;**14,16,22**;09/13/1996
"RTN","MCPFTP1",3,0)
 ; ------------------------
"RTN","MCPFTP1",4,0)
 ; SSN = Enternal Format of the patients SSN with the first letter
"RTN","MCPFTP1",5,0)
 ; of the last name tacked on the end
"RTN","MCPFTP1",6,0)
 ; ------------------------
"RTN","MCPFTP1",7,0)
 D DEM^VADPT S MCARGNM=VADM(1),SSN=VA("PID")
"RTN","MCPFTP1",8,0)
 S X1=$E($P(MCPFT0,U),1,7),X2=$P(VADM(3),U)
"RTN","MCPFTP1",9,0)
 ; ---------------------
"RTN","MCPFTP1",10,0)
 ; AGE = the patients age at the date of the procedure
"RTN","MCPFTP1",11,0)
 ; ---------------------
"RTN","MCPFTP1",12,0)
 S AGE=$E(X1,1,3)-$E(X2,1,3)-($E(X1,4,7)<$E(X2,4,7))
"RTN","MCPFTP1",13,0)
 S RACE=$P(VADM(8),U,2),CLIN="" S:$P(MCPFT0,U,10) CLIN=$P(MCPFT0,U,10) I CLIN,$D(^SC(CLIN,0)) S CLIN=$P(^(0),U)
"RTN","MCPFTP1",14,0)
 S DATE=$P(MCPFT0,U),DATE=+$E(DATE,4,5)_"/"_+$E(DATE,6,7)_"/"_$E(DATE,2,3)_$S($P(DATE,".",2):"@"_+$E(DATE,9,10)_":"_$S($L($E(DATE,11,12))=2:$E(DATE,11,12),$L($E(DATE,11,12))=1:$E(DATE,11)_"0",1:"00"),1:"")
"RTN","MCPFTP1",15,0)
 S HT1=$P(MCPFT0,U,4),WT1=$P(MCPFT0,U,5) S $P(MCDOT,".",81)=""
"RTN","MCPFTP1",16,0)
 S HT=HT1*2.54,WT=WT1/2.2
"RTN","MCPFTP1",17,0)
 S:'HT HT=$P(MCPFT0,U,3),HT1=HT/2.54 S:'WT WT=$P(MCPFT0,U,6),WT1=WT*2.2
"RTN","MCPFTP1",18,0)
 S (MC17,MCEFF,MCSEX)="" S:$D(^MCAR(700,MCARGDA,17)) MC17=^(17),MCEFF=$P(MC17,U,6),MCEFF=$S(MCEFF="G":"GOOD",MCEFF="E":"EXCELLENT",MCEFF="P":"POOR",1:"")
"RTN","MCPFTP1",19,0)
 S MCSEX=$P(VADM(5),U),X=$P(VADM(3),"^",2) S MCARDOB=$S(X'="":X,1:""),X=$P(MCPFT0,U) D DTIME^MCARP S (MCARGDT,MCARGDT2)=X,MCARZ="PULMONARY FUNCTION TEST " S:MCESON MCARZ=MCARZ_" - "_MCSTAT
"RTN","MCPFTP1",20,0)
 D INP^VADPT S MCARWARD=$S(VAIN(4)'="":$P(VAIN(4),U,2),1:"NOT INPATIENT"),MCARRB=VAIN(5) D NOW^%DTC S X=% D DTIME^MCARP S MCARDTM=X
"RTN","MCPFTP1",21,0)
 D INIT^MCARP1(MCARZ,MCARGDT,MCFILE)
"RTN","MCPFTP1",22,0)
 D HEAD^MCARP
"RTN","MCPFTP1",23,0)
 W !,"SEX: ",MCSEX,"  AGE:",AGE,?30,+$J(HT1,0,1)," in/",+$J(WT1,0,1)," lb",?60,"AMBIENT: ",$P(MCPFT0,U,12),"C/",$P(MCPFT0,U,7),"T" K HT1,WT1
"RTN","MCPFTP1",24,0)
 W !,RACE S TECH=$P(MCPFT0,U,13) I TECH,$D(^VA(200,TECH,0)) S TECH=$P(^(0),U)
"RTN","MCPFTP1",25,0)
 W ?60,"TECH: ",$E(TECH,1,14)
"RTN","MCPFTP1",26,0)
 W !,$S($P(MCPFT0,U,8)="Y":"SMOKER",$P(MCPFT0,U,8)="N":"NON-SMOKER",1:"")
"RTN","MCPFTP1",27,0)
 W ?30 W:$P(MCPFT0,U,9)="Y" "CURRENT BRONCHODILATOR USE"
"RTN","MCPFTP1",28,0)
 W ?60,"EFFORT: ",MCEFF
"RTN","MCPFTP1",29,0)
 S MCFF="S DN=1,MCY="""" I $Y>(IOSL-3) R:$E(IOST,1,2)=""C-"" !!,""Press Return to Continue, '^' to escape: "",MCY:DTIME S:'$T MCY=U S:MCY=U MCOUT=1,DN=0 Q:$D(MCOUT)  D:DN HEAD^MCARP D:$D(HEAD1) HEAD1^MCPFTP2,HEAD2^MCPFTP2 K MCY"
"RTN","MCPFTP1",30,0)
 K ^UTILITY("DIQ1",$J) W !!,"CONSULT DX: " S DR(700.01)=.01,DIQ(0)="E",DIC="^MCAR(700,"
"RTN","MCPFTP1",31,0)
 F K=0:0 S K=$O(^MCAR(700,MCARGDA,1,K)) Q:K'?1N.N  S DA=MCARGDA,DA(700.01)=K,DR=11,DIQ(0)="E" D EN^DIQ1 W ?15,^UTILITY("DIQ1",$J,700.01,K,.01,"E"),! X MCFF Q:$D(MCOUT)
"RTN","MCPFTP1",32,0)
 K ^UTILITY("DIQ1",$J),DIQ Q:$D(MCOUT)  W !,MCDOT X MCFF Q:$D(MCOUT)  D PRED
"RTN","MCPFTP1",33,0)
 S RDATE=9999999.9999-$P(MCPFT0,U)
"RTN","MCPFTP1",34,0)
 W:$D(MCRCN) !,MCRCN
"RTN","MCPFTP1",35,0)
 D ^MCPFTP2
"RTN","MCPFTP1",36,0)
 I '$D(MCOUT) D:$G(MCESON) FOOTER^MCESPRT(MCFILE,MCARGDA)
"RTN","MCPFTP1",37,0)
EXIT S:$D(ZTQUEUED) ZTREQ="@" K ZTSK
"RTN","MCPFTP1",38,0)
EXIT1 ;
"RTN","MCPFTP1",39,0)
 D EXIT^MCPFTP1A
"RTN","MCPFTP1",40,0)
 Q 
"RTN","MCPFTP1",41,0)
PRED S (DLCOSB,FEV1,FRC,FVC,FEF2575,PF,RV,TLC,VC,MVV,CTLC,CVC,CFRC,CRV,CFVC,CFEV1,CPF,CFEF2575,CMVV,CDLCOSB,ACT,COHB)=""
"RTN","MCPFTP1",42,0)
 S MCPV=$$MCPV(MCARGDA)
"RTN","MCPFTP1",43,0)
 I ('HT)!('WT)!('AGE)!(MCPV=0) Q
"RTN","MCPFTP1",44,0)
 D PREDS,MCRACE Q
"RTN","MCPFTP1",45,0)
MCRACE S MCRCR="",MCRC=$G(^MCAR(700.1,MCPV,"RC")) Q:MCRC=""
"RTN","MCPFTP1",46,0)
 S MCRCR=$G(^MCAR(700,MCARGDA,17)) Q:MCRCR=""  Q:$P(MCRCR,U,5)'="Y"
"RTN","MCPFTP1",47,0)
 S MCRCR=$S(RACE["BLACK":"B",RACE["ASIAN":"O",1:"") Q:MCRCR=""
"RTN","MCPFTP1",48,0)
 F I=1:1:4 I $P(MCRC,U,I) S J=$P(MCRC,U,I) D:J
"RTN","MCPFTP1",49,0)
 .Q:'$D(^MCAR(700.2,J,0))  S J=$P(^(0),U,1)
"RTN","MCPFTP1",50,0)
 .S @("MCRC"_I)="S PRED="_J
"RTN","MCPFTP1",51,0)
 K J G ORIENTAL:MCRCR="O" K MCRC2
"RTN","MCPFTP1",52,0)
 I '$D(MCRC1),'$D(MCRC3),'$D(MCRC4) Q
"RTN","MCPFTP1",53,0)
 S:$D(MCRC1) MCRCN="TLC,VC,FVC,FEV1" S:$D(MCRC3) MCRCN=MCRCN_",FRC,RV" S:$D(MCRC4) MCRCN=MCRCN_",FEF25-75" S:$E(MCRCN,1)="," MCRCN=$E(MCRCN,2,30)
"RTN","MCPFTP1",54,0)
 G NOTE
"RTN","MCPFTP1",55,0)
ORIENTAL I '$D(MCRC2) K MCRC1,MCRC3,MCRC4 Q
"RTN","MCPFTP1",56,0)
 S MCRC1=MCRC2 K MCRC3,MCRC4 S MCRCN="TLC,VC,FVC,FEV1"
"RTN","MCPFTP1",57,0)
NOTE S MCRCN="NOTE:   Race Correction done on predicted values for: "_MCRCN
"RTN","MCPFTP1",58,0)
 Q
"RTN","MCPFTP1",59,0)
CONFID(MCPV,VALUE) ;
"RTN","MCPFTP1",60,0)
 Q $P(^MCAR(700.2,^MCAR(700.1,MCPV,VALUE),0),U,5)
"RTN","MCPFTP1",61,0)
PREDV(MCPV,VALUE)       ;
"RTN","MCPFTP1",62,0)
 N EXPRESS,FORMULA,IEN,RESULT
"RTN","MCPFTP1",63,0)
 S IEN=+$P($G(^MCAR(700.1,MCPV,VALUE)),U)
"RTN","MCPFTP1",64,0)
 S FORMULA=$P($G(^MCAR(700.2,IEN,0)),U)
"RTN","MCPFTP1",65,0)
 S RESULT=""
"RTN","MCPFTP1",66,0)
 I FORMULA]"" S EXPRESS="S RESULT="_FORMULA X EXPRESS
"RTN","MCPFTP1",67,0)
 Q $S(RESULT]"":RESULT,1:"")
"RTN","MCPFTP1",68,0)
MCPV(MCDA) ; Get the Predicted Value entry
"RTN","MCPFTP1",69,0)
 Q $S($D(^MCAR(700,MCDA,"PV")):^("PV"),1:0)
"RTN","MCPFTP1",70,0)
PREDS S BSA=+$$BSA(HT,WT),I="DLCOSB",DLCOSB=$$PREDV(MCPV,"DLCOSB"),CDLCOSB=$$CONFID(MCPV,"DLCOSB")
"RTN","MCPFTP1",71,0)
 S FEV1=$$PREDV(MCPV,"FEV1"),CFEV1=$$CONFID(MCPV,"FEV1")
"RTN","MCPFTP1",72,0)
 S FRC=$$PREDV(MCPV,"FRC"),CFRC=$$CONFID(MCPV,"FRC")
"RTN","MCPFTP1",73,0)
 S FVC=$$PREDV(MCPV,"FVC"),CFVC=$$CONFID(MCPV,"FVC")
"RTN","MCPFTP1",74,0)
 S FEF2575=$$PREDV(MCPV,"FEF2575"),CFEF2575=$$CONFID(MCPV,"FEF2575")
"RTN","MCPFTP1",75,0)
 S PF=$$PREDV(MCPV,"PF"),CPF=$$CONFID(MCPV,"PF")
"RTN","MCPFTP1",76,0)
 S RV=$$PREDV(MCPV,"RV"),CRV=$$CONFID(MCPV,"RV")
"RTN","MCPFTP1",77,0)
 S TLC=$$PREDV(MCPV,"TLC"),CTLC=$$CONFID(MCPV,"TLC")
"RTN","MCPFTP1",78,0)
 S VC=$$PREDV(MCPV,"VC"),CVC=$$CONFID(MCPV,"VC")
"RTN","MCPFTP1",79,0)
 S MVV=$$PREDV(MCPV,"MVV"),CMVV=$$CONFID(MCPV,"MVV")
"RTN","MCPFTP1",80,0)
 Q
"RTN","MCPFTP1",81,0)
BSA(HT,WT) ; Compute BSA
"RTN","MCPFTP1",82,0)
 D COMPUTE^MCARBSA
"RTN","MCPFTP1",83,0)
 Q X
"RTN","MCPFTP1A")
0^3^B2100260
"RTN","MCPFTP1A",1,0)
MCPFTP1A ;WISC/DCB-PFT Report Demo Info Exit Routine ;4/20/99  07:56
"RTN","MCPFTP1A",2,0)
 ;;2.3;Medicine;**14,22**;09/13/1996
"RTN","MCPFTP1A",3,0)
EXIT ;
"RTN","MCPFTP1A",4,0)
 K ^UTILITY($J),MCOUT,ACT,AGE,CK,CLIN,D0,D1,DA,DATE,CI95
"RTN","MCPFTP1A",5,0)
 K HB,PH,PACO2,PAO2,O2HB,COHB,FIO2,MHB,PAAO2,QSQT,CAO2,CVO2
"RTN","MCPFTP1A",6,0)
 K DFN,DIC,DIW,DIWL,DIWR,DIWT,DLCOSB,DN,MCDOT,DR,FEV1,FRC,FVC,MC17
"RTN","MCPFTP1A",7,0)
 K HT,I,J,K,MCARGNM,MCFF,MCK,MCN,MCPI,MCREC,MCREC1,MCVCN
"RTN","MCPFTP1A",8,0)
 K MCREC2,MCTLCN,MCVN,MCX,MEAS,FEF2575,ND,ND1,P1,P2,PC,PD1,PD11,MCEFF
"RTN","MCPFTP1A",9,0)
 K PD2,PD21,PF,MCPFT0,PG,PRED,MCPV,RACE,RDATE,RDATE1,RDATE2,RV,MCSEX
"RTN","MCPFTP1A",10,0)
 K SSN,TAB,TECH,TLC,TYPE,UNIT,UNITS,VC,WT,X,Z,VA,MCRCN
"RTN","MCPFTP1A",11,0)
 K MCMVVN,MVV,PMVV,MCSP,MCP1S0,MCP1S1,MCP1S2,MCP2S0,MCP2S1,MCP2S2
"RTN","MCPFTP1A",12,0)
 K CDLCOSB,MCIAO1,MCIAO2,MCIDA,MCIDL,MCIDP,MCIFA,MCIFE,MCARGDA
"RTN","MCPFTP1A",13,0)
 K MCIFL,MCIFV,MCIPTL,MCIRV,MCITL,MCMAIN,MCP1,MCP2,MCRC,MCRCR
"RTN","MCPFTP1A",14,0)
 K MCTYPEP,MCY,MCRC1,MCRC2,MCRC3,MCRC4,MCSTAT,MCFOOTER,MCOUNT
"RTN","MCPFTP1A",15,0)
 K MCARRB,MCARDOB,MCARWARD,MCARDTM,MCARHDR,MCARZ,MCARGDT,MCDL,MCLNG
"RTN","MCPFTP1A",16,0)
 D KVAR^VADPT D ^%ZISC
"RTN","MCPFTP1A",17,0)
 Q
"VER")
8.0^21.0
**END**
**END**
