Released DG*5.3*729 SEQ #673
Extracted from mail message
**KIDS**:DG*5.3*729^

**INSTALL NAME**
DG*5.3*729
"BLD",6921,0)
DG*5.3*729^REGISTRATION^0^3070726^y
"BLD",6921,4,0)
^9.64PA^45^4
"BLD",6921,4,42,0)
42
"BLD",6921,4,42,2,0)
^9.641^42^1
"BLD",6921,4,42,2,42,0)
WARD LOCATION  (File-top level)
"BLD",6921,4,42,2,42,1,0)
^9.6411^.017^1
"BLD",6921,4,42,2,42,1,.017,0)
SPECIALTY
"BLD",6921,4,42,222)
y^n^p^^^^n^^n
"BLD",6921,4,42,224)

"BLD",6921,4,42.4,0)
42.4
"BLD",6921,4,42.4,2,0)
^9.641^42.4^1
"BLD",6921,4,42.4,2,42.4,0)
SPECIALTY  (File-top level)
"BLD",6921,4,42.4,2,42.4,1,0)
^9.6411^7^3
"BLD",6921,4,42.4,2,42.4,1,.001,0)
NUMBER
"BLD",6921,4,42.4,2,42.4,1,6,0)
MPCR ACCOUNT
"BLD",6921,4,42.4,2,42.4,1,7,0)
PTF CODE
"BLD",6921,4,42.4,222)
y^n^p^^^^n^^n
"BLD",6921,4,42.4,224)

"BLD",6921,4,45,0)
45
"BLD",6921,4,45,2,0)
^9.641^45.05^3
"BLD",6921,4,45,2,45,0)
PTF  (File-top level)
"BLD",6921,4,45,2,45,1,0)
^9.6411^300.01^1
"BLD",6921,4,45,2,45,1,300.01,0)
KIDNEY SOURCE
"BLD",6921,4,45,2,45.01,0)
401  (sub-file)
"BLD",6921,4,45,2,45.01,1,0)
^9.6411^3^2
"BLD",6921,4,45,2,45.01,1,3,0)
SURGICAL SPECIALTY
"BLD",6921,4,45,2,45.01,1,300.01,0)
KIDNEY SOURCE
"BLD",6921,4,45,2,45.05,0)
601  (sub-file)
"BLD",6921,4,45,2,45.05,1,0)
^9.6411^3^1
"BLD",6921,4,45,2,45.05,1,3,0)
NUMBER OF DIALYSIS TREATMENTS
"BLD",6921,4,45,222)
y^n^p^^^^n^^n
"BLD",6921,4,45,224)

"BLD",6921,4,45.7,0)
45.7
"BLD",6921,4,45.7,2,0)
^9.641^45.7^1
"BLD",6921,4,45.7,2,45.7,0)
FACILITY TREATING SPECIALTY  (File-top level)
"BLD",6921,4,45.7,2,45.7,1,0)
^9.6411^1^1
"BLD",6921,4,45.7,2,45.7,1,1,0)
SPECIALTY
"BLD",6921,4,45.7,222)
y^n^p^^^^n^^n
"BLD",6921,4,45.7,224)

"BLD",6921,4,"APDD",42,42)

"BLD",6921,4,"APDD",42,42,.017)

"BLD",6921,4,"APDD",42.4,42.4)

"BLD",6921,4,"APDD",42.4,42.4,.001)

"BLD",6921,4,"APDD",42.4,42.4,6)

"BLD",6921,4,"APDD",42.4,42.4,7)

"BLD",6921,4,"APDD",45,45)

"BLD",6921,4,"APDD",45,45,300.01)

"BLD",6921,4,"APDD",45,45.01)

"BLD",6921,4,"APDD",45,45.01,3)

"BLD",6921,4,"APDD",45,45.01,300.01)

"BLD",6921,4,"APDD",45,45.05)

"BLD",6921,4,"APDD",45,45.05,3)

"BLD",6921,4,"APDD",45.7,45.7)

"BLD",6921,4,"APDD",45.7,45.7,1)

"BLD",6921,4,"B",42,42)

"BLD",6921,4,"B",42.4,42.4)

"BLD",6921,4,"B",45,45)

"BLD",6921,4,"B",45.7,45.7)

"BLD",6921,6)
1^
"BLD",6921,6.3)
59
"BLD",6921,"ABPKG")
n
"BLD",6921,"INID")
^
"BLD",6921,"INIT")
EN^DG53729P
"BLD",6921,"KRN",0)
^9.67PA^8989.52^19
"BLD",6921,"KRN",.4,0)
.4
"BLD",6921,"KRN",.401,0)
.401
"BLD",6921,"KRN",.402,0)
.402
"BLD",6921,"KRN",.402,"NM",0)
^9.68A^3^3
"BLD",6921,"KRN",.402,"NM",1,0)
DG601    FILE #45^45^0
"BLD",6921,"KRN",.402,"NM",2,0)
DGPT 601 CLEANUP    FILE #45^45^0
"BLD",6921,"KRN",.402,"NM",3,0)
DG401    FILE #45^45^0
"BLD",6921,"KRN",.402,"NM","B","DG401    FILE #45",3)

"BLD",6921,"KRN",.402,"NM","B","DG601    FILE #45",1)

"BLD",6921,"KRN",.402,"NM","B","DGPT 601 CLEANUP    FILE #45",2)

"BLD",6921,"KRN",.403,0)
.403
"BLD",6921,"KRN",.403,"NM",0)
^9.68A^^
"BLD",6921,"KRN",.5,0)
.5
"BLD",6921,"KRN",.84,0)
.84
"BLD",6921,"KRN",3.6,0)
3.6
"BLD",6921,"KRN",3.8,0)
3.8
"BLD",6921,"KRN",9.2,0)
9.2
"BLD",6921,"KRN",9.8,0)
9.8
"BLD",6921,"KRN",9.8,"NM",0)
^9.68A^44^35
"BLD",6921,"KRN",9.8,"NM",1,0)
DG53729P^^0^B84374010
"BLD",6921,"KRN",9.8,"NM",2,0)
DGPTAE02^^0^B19628803
"BLD",6921,"KRN",9.8,"NM",3,0)
DGPTSCAN^^0^B23094075
"BLD",6921,"KRN",9.8,"NM",5,0)
DGPT50MS^^0^B4605823
"BLD",6921,"KRN",9.8,"NM",6,0)
DGPTFM8^^0^B9470941
"BLD",6921,"KRN",9.8,"NM",10,0)
DGPTDRG^^0^B26343356
"BLD",6921,"KRN",9.8,"NM",11,0)
DGPTF41^^0^B9986685
"BLD",6921,"KRN",9.8,"NM",12,0)
DGPTFMO^^0^B26364577
"BLD",6921,"KRN",9.8,"NM",13,0)
DGPTODR^^0^B5634642
"BLD",6921,"KRN",9.8,"NM",14,0)
DGPTOLC2^^0^B22638617
"BLD",6921,"KRN",9.8,"NM",15,0)
DGPTAEE2^^0^B14108069
"BLD",6921,"KRN",9.8,"NM",17,0)
DGPTR1^^0^B26016788
"BLD",6921,"KRN",9.8,"NM",20,0)
DGPTAEE1^^0^B21428612
"BLD",6921,"KRN",9.8,"NM",21,0)
DGPTFJ^^0^B7423951
"BLD",6921,"KRN",9.8,"NM",22,0)
DGPTTS3^^0^B22744602
"BLD",6921,"KRN",9.8,"NM",23,0)
DGPTFM6^^0^B20304000
"BLD",6921,"KRN",9.8,"NM",24,0)
DGPTFVC3^^0^B10783685
"BLD",6921,"KRN",9.8,"NM",25,0)
DGPTR0^^0^B25017535
"BLD",6921,"KRN",9.8,"NM",26,0)
DGPTR2^^0^B21647835
"BLD",6921,"KRN",9.8,"NM",27,0)
DGPTR4^^0^B20160961
"BLD",6921,"KRN",9.8,"NM",30,0)
DGPTFM7^^0^B21219043
"BLD",6921,"KRN",9.8,"NM",31,0)
DGPTFM71^^0^B4775290
"BLD",6921,"KRN",9.8,"NM",32,0)
DGPT601^^0^B13957329
"BLD",6921,"KRN",9.8,"NM",33,0)
DG53729R^^0^B13019595
"BLD",6921,"KRN",9.8,"NM",34,0)
DGPTFQWK^^0^B20032997
"BLD",6921,"KRN",9.8,"NM",35,0)
DGPTFJC^^0^B48314184
"BLD",6921,"KRN",9.8,"NM",36,0)
DGPTR3^^0^B4042057
"BLD",6921,"KRN",9.8,"NM",37,0)
DGPTFTR2^^0^B15450104
"BLD",6921,"KRN",9.8,"NM",38,0)
DGPT501^^0^B11578445
"BLD",6921,"KRN",9.8,"NM",39,0)
DGPT535^^0^B8073530
"BLD",6921,"KRN",9.8,"NM",40,0)
DGPT701^^0^B13839159
"BLD",6921,"KRN",9.8,"NM",41,0)
DGACT^^0^B5237552
"BLD",6921,"KRN",9.8,"NM",42,0)
DGPT401^^0^B8757458
"BLD",6921,"KRN",9.8,"NM",43,0)
DG53729C^^0^B1899712
"BLD",6921,"KRN",9.8,"NM",44,0)
DGPTCO1^^0^B26233066
"BLD",6921,"KRN",9.8,"NM","B","DG53729C",43)

"BLD",6921,"KRN",9.8,"NM","B","DG53729P",1)

"BLD",6921,"KRN",9.8,"NM","B","DG53729R",33)

"BLD",6921,"KRN",9.8,"NM","B","DGACT",41)

"BLD",6921,"KRN",9.8,"NM","B","DGPT401",42)

"BLD",6921,"KRN",9.8,"NM","B","DGPT501",38)

"BLD",6921,"KRN",9.8,"NM","B","DGPT50MS",5)

"BLD",6921,"KRN",9.8,"NM","B","DGPT535",39)

"BLD",6921,"KRN",9.8,"NM","B","DGPT601",32)

"BLD",6921,"KRN",9.8,"NM","B","DGPT701",40)

"BLD",6921,"KRN",9.8,"NM","B","DGPTAE02",2)

"BLD",6921,"KRN",9.8,"NM","B","DGPTAEE1",20)

"BLD",6921,"KRN",9.8,"NM","B","DGPTAEE2",15)

"BLD",6921,"KRN",9.8,"NM","B","DGPTCO1",44)

"BLD",6921,"KRN",9.8,"NM","B","DGPTDRG",10)

"BLD",6921,"KRN",9.8,"NM","B","DGPTF41",11)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFJ",21)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFJC",35)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFM6",23)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFM7",30)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFM71",31)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFM8",6)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFMO",12)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFQWK",34)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFTR2",37)

"BLD",6921,"KRN",9.8,"NM","B","DGPTFVC3",24)

"BLD",6921,"KRN",9.8,"NM","B","DGPTODR",13)

"BLD",6921,"KRN",9.8,"NM","B","DGPTOLC2",14)

"BLD",6921,"KRN",9.8,"NM","B","DGPTR0",25)

"BLD",6921,"KRN",9.8,"NM","B","DGPTR1",17)

"BLD",6921,"KRN",9.8,"NM","B","DGPTR2",26)

"BLD",6921,"KRN",9.8,"NM","B","DGPTR3",36)

"BLD",6921,"KRN",9.8,"NM","B","DGPTR4",27)

"BLD",6921,"KRN",9.8,"NM","B","DGPTSCAN",3)

"BLD",6921,"KRN",9.8,"NM","B","DGPTTS3",22)

"BLD",6921,"KRN",19,0)
19
"BLD",6921,"KRN",19,"NM",0)
^9.68A^^0
"BLD",6921,"KRN",19.1,0)
19.1
"BLD",6921,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6921,"KRN",101,0)
101
"BLD",6921,"KRN",409.61,0)
409.61
"BLD",6921,"KRN",771,0)
771
"BLD",6921,"KRN",870,0)
870
"BLD",6921,"KRN",8989.51,0)
8989.51
"BLD",6921,"KRN",8989.52,0)
8989.52
"BLD",6921,"KRN",8994,0)
8994
"BLD",6921,"KRN","B",.4,.4)

"BLD",6921,"KRN","B",.401,.401)

"BLD",6921,"KRN","B",.402,.402)

"BLD",6921,"KRN","B",.403,.403)

"BLD",6921,"KRN","B",.5,.5)

"BLD",6921,"KRN","B",.84,.84)

"BLD",6921,"KRN","B",3.6,3.6)

"BLD",6921,"KRN","B",3.8,3.8)

"BLD",6921,"KRN","B",9.2,9.2)

"BLD",6921,"KRN","B",9.8,9.8)

"BLD",6921,"KRN","B",19,19)

"BLD",6921,"KRN","B",19.1,19.1)

"BLD",6921,"KRN","B",101,101)

"BLD",6921,"KRN","B",409.61,409.61)

"BLD",6921,"KRN","B",771,771)

"BLD",6921,"KRN","B",870,870)

"BLD",6921,"KRN","B",8989.51,8989.51)

"BLD",6921,"KRN","B",8989.52,8989.52)

"BLD",6921,"KRN","B",8994,8994)

"BLD",6921,"QUES",0)
^9.62^^
"BLD",6921,"REQB",0)
^9.611^12^12
"BLD",6921,"REQB",1,0)
DG*5.3*142^2
"BLD",6921,"REQB",2,0)
DG*5.3*164^2
"BLD",6921,"REQB",3,0)
DG*5.3*683^2
"BLD",6921,"REQB",4,0)
DG*5.3*635^2
"BLD",6921,"REQB",5,0)
DG*5.3*704^2
"BLD",6921,"REQB",6,0)
DG*5.3*599^2
"BLD",6921,"REQB",7,0)
DG*5.3*636^2
"BLD",6921,"REQB",8,0)
DG*5.3*696^2
"BLD",6921,"REQB",9,0)
DG*5.3*645^2
"BLD",6921,"REQB",10,0)
DG*5.3*549^2
"BLD",6921,"REQB",11,0)
DG*5.3*701^2
"BLD",6921,"REQB",12,0)
IB*2.0*364^2
"BLD",6921,"REQB","B","DG*5.3*142",1)

"BLD",6921,"REQB","B","DG*5.3*164",2)

"BLD",6921,"REQB","B","DG*5.3*549",10)

"BLD",6921,"REQB","B","DG*5.3*599",6)

"BLD",6921,"REQB","B","DG*5.3*635",4)

"BLD",6921,"REQB","B","DG*5.3*636",7)

"BLD",6921,"REQB","B","DG*5.3*645",9)

"BLD",6921,"REQB","B","DG*5.3*683",3)

"BLD",6921,"REQB","B","DG*5.3*696",8)

"BLD",6921,"REQB","B","DG*5.3*701",11)

"BLD",6921,"REQB","B","DG*5.3*704",5)

"BLD",6921,"REQB","B","IB*2.0*364",12)

"FIA",42)
WARD LOCATION
"FIA",42,0)
^DIC(42,
"FIA",42,0,0)
42I
"FIA",42,0,1)
y^n^p^^^^n^^n
"FIA",42,0,10)

"FIA",42,0,11)

"FIA",42,0,"RLRO")

"FIA",42,0,"VR")
5.3^DG
"FIA",42,42)
1
"FIA",42,42,.017)

"FIA",42.4)
SPECIALTY
"FIA",42.4,0)
^DIC(42.4,
"FIA",42.4,0,0)
42.4
"FIA",42.4,0,1)
y^n^p^^^^n^^n
"FIA",42.4,0,10)

"FIA",42.4,0,11)

"FIA",42.4,0,"RLRO")

"FIA",42.4,0,"VR")
5.3^DG
"FIA",42.4,42.4)
1
"FIA",42.4,42.4,.001)

"FIA",42.4,42.4,6)

"FIA",42.4,42.4,7)

"FIA",45)
PTF
"FIA",45,0)
^DGPT(
"FIA",45,0,0)
45IP
"FIA",45,0,1)
y^n^p^^^^n^^n
"FIA",45,0,10)

"FIA",45,0,11)

"FIA",45,0,"RLRO")

"FIA",45,0,"VR")
5.3^DG
"FIA",45,45)
1
"FIA",45,45,300.01)

"FIA",45,45.01)
1
"FIA",45,45.01,3)

"FIA",45,45.01,300.01)

"FIA",45,45.05)
1
"FIA",45,45.05,3)

"FIA",45.7)
FACILITY TREATING SPECIALTY
"FIA",45.7,0)
^DIC(45.7,
"FIA",45.7,0,0)
45.7I
"FIA",45.7,0,1)
y^n^p^^^^n^^n
"FIA",45.7,0,10)

"FIA",45.7,0,11)

"FIA",45.7,0,"RLRO")

"FIA",45.7,0,"VR")
5.3^DG
"FIA",45.7,45.7)
1
"FIA",45.7,45.7,1)

"INIT")
EN^DG53729P
"KRN",.402,85,-1)
0^3
"KRN",.402,85,0)
DG401^3061024.1041^^45^^^3070726
"KRN",.402,85,"AR",45.01,366)
1^DGPTX45
"KRN",.402,85,"AR",45.01,367)
2^DGPTX45
"KRN",.402,85,"AR",45.01,416)
3^DGPTX45
"KRN",.402,85,"AR",45.01,417)
4^DGPTX45
"KRN",.402,85,"AR",45.01,418)
5^DGPTX45
"KRN",.402,85,"DR",1,45)
40///^S X=+DGSUR;
"KRN",.402,85,"DR",2,45.01)
K DGPTIT S DGHOLD=$S($D(^DGPT(DGPTF,"S",DGSUR,0)):^(0),1:"");S:'$D(DGADD) DGADD=0;S:DGADD Y="@2";S:DGJUMP'[1 (DGNFLD,Y)="@2";.01;3;4;5;6;7;S:DGJUMP'[2 Y=0;@2;S DGNFLD="@30";I DGADD,$P(DGHOLD,U,8)]"" S Y="@30";8;
"KRN",.402,85,"DR",2,45.01,1)
I X K DGPTIT S DGNFLD="@30",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@30;S DGNFLD="@40";I DGADD,$P(DGHOLD,U,9)]"" S Y="@40";9;I X K DGPTIT S DGNFLD="@40",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@40;S DGNFLD="@50";
"KRN",.402,85,"DR",2,45.01,2)
I DGADD,$P(DGHOLD,U,10)]"" S Y="@50";10;I X K DGPTIT S DGNFLD="@50",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@50;S DGNFLD="@60";I DGADD,$P(DGHOLD,U,11)]"" S Y="@60";11;I X K DGPTIT S DGNFLD="@60",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";
"KRN",.402,85,"DR",2,45.01,3)
@60;S DGNFLD="@70";I DGADD,$P(DGHOLD,U,12)]"" S Y="@70";12;I X K DGPTIT S DGNFLD="@70",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@70;K DGNFLD S Y="";@800;D SCAN^DGPTSCAN I '$D(DGBPC) S Y="@899";I '$D(DGBPC(1)) S Y="@899";300.01;@899;
"KRN",.402,85,"DR",2,45.01,4)
K DGPTIT S Y=DGNFLD;
"KRN",.402,85,"ROU")
^DGPTX4
"KRN",.402,85,"ROUOLD")
DGPTX4
"KRN",.402,98,-1)
0^1
"KRN",.402,98,0)
DG601^3070301.0926^^45^^^3070607
"KRN",.402,98,"DR",1,45)
S DGDUP(8)=0;K DGPTIT;S DGHOLD=$S($D(^DGPT(DGPTF,"P",+P(DGZP,1),0)):^(0),1:"");60///^S X=P(DGZP,1);
"KRN",.402,98,"DR",2,45.05)
S:'$D(DGADD) DGADD=0;S:DGJUMP'[1 Y="@2";S DGNFLD="@10";.01;@10;S DGNFLD="@15";1///^D BS^DGPTFM6 S X=DGMOVM K DGMOVM;@15;S:DGJUMP'[2 Y="";@2;S DGNFLD="@25";S Y="@899";@25;I DGADD,$P(DGHOLD,U,5)]"" S Y="@40";S DGNFLD="@40";4;
"KRN",.402,98,"DR",2,45.05,1)
I X K DGPTIT S DGNFLD="@40",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@40;I DGADD,$P(DGHOLD,U,6)]"" S Y="@50";S DGNFLD="@50";5;I X K DGPTIT S DGNFLD="@50",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@50;I DGADD,$P(DGHOLD,U,7)]"" S Y="@60";
"KRN",.402,98,"DR",2,45.05,2)
S DGNFLD="@60";6;I X K DGPTIT S DGNFLD="@60",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@60;I DGADD,$P(DGHOLD,U,8)]"" S Y="@70";S DGNFLD="@70";7;I X K DGPTIT S DGNFLD="@70",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@70;
"KRN",.402,98,"DR",2,45.05,3)
I DGADD,$P(DGHOLD,U,9)]"" S Y="@80";S DGNFLD="@80";8;I X K DGPTIT S DGNFLD="@80",Y="@800",DGPTIT(X_$C(59)_"ICD0(")="";@80;K DGNFLD,DGDUP,DGADD S Y="";@800;D SCAN^DGPTSCAN;I '$D(DGBPC(8))!(DGDUP(8)) S Y="@899";3;
"KRN",.402,98,"DR",2,45.05,4)
S:X]"" DGDUP(8)=1 S:X']"" Y="@800";@899;K DGPTIT S Y=DGNFLD;@999;S Y=DGNFLD;
"KRN",.402,2245,-1)
0^2
"KRN",.402,2245,0)
DGPT 601 CLEANUP^3070215.0945^^45^^^3070321
"KRN",.402,2245,"DR",1,45)
60///^S X=P(DGZP,1);
"KRN",.402,2245,"DR",2,45.05)
I $D(DGBPC(8)),$P(DGHOLD,U,4)]"" S Y="@899";3////^S X="@";@899;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",114,-1)
1^1
"PKG",114,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",114,20,0)
^9.402P^^
"PKG",114,22,0)
^9.49I^1^1
"PKG",114,22,1,0)
5.3^2930813^2930821
"PKG",114,22,1,"PAH",1,0)
729^3070726^1000000011
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
35
"RTN","DG53729C")
0^43^B1899712^n/a
"RTN","DG53729C",1,0)
DG53729C ;ALB/MRY -Post-init routine for DG*5.3*729 Census ;7/19/2007
"RTN","DG53729C",2,0)
 ;;5.3;Registration;**729**;Aug 13, 1993;Build 59
"RTN","DG53729C",3,0)
 ;
"RTN","DG53729C",4,0)
EN ;This patch will update the closeout date for the 9/30/2007 census
"RTN","DG53729C",5,0)
 ;if an entry exists in the PTF Census Date (#45.86) file for that
"RTN","DG53729C",6,0)
 ;census.
"RTN","DG53729C",7,0)
 ;
"RTN","DG53729C",8,0)
 ;Look up 9/30/2007 census record in PTF Census Date (#45.86) file
"RTN","DG53729C",9,0)
 D BMES^XPDUTL("***** Updating PTF Census *****")
"RTN","DG53729C",10,0)
 N DIC,X,Y
"RTN","DG53729C",11,0)
 S DIC="^DG(45.86,"
"RTN","DG53729C",12,0)
 S DIC(0)="MZ"
"RTN","DG53729C",13,0)
 S X=3070930
"RTN","DG53729C",14,0)
 D ^DIC
"RTN","DG53729C",15,0)
 I +Y'>0 D  Q
"RTN","DG53729C",16,0)
 .D BMES^XPDUTL("   9/30/2007 census record does not exist in PTF Census Date (#45.86) file.  No update needed.")
"RTN","DG53729C",17,0)
 ;Check closeout date and update to 10/14/2007 if necessary.
"RTN","DG53729C",18,0)
 I $P(Y(0),U,2)=3071014 D  Q
"RTN","DG53729C",19,0)
 .D BMES^XPDUTL("   Closeout date for 9/30/2007 currently set for")
"RTN","DG53729C",20,0)
 .D MES^XPDUTL("   10/14/2007.  No updating necessary.")
"RTN","DG53729C",21,0)
 N DIE,DA,DR
"RTN","DG53729C",22,0)
 S DIE="^DG(45.86,"
"RTN","DG53729C",23,0)
 S DA=+Y
"RTN","DG53729C",24,0)
 S DR=".02////3071014"
"RTN","DG53729C",25,0)
 D ^DIE
"RTN","DG53729C",26,0)
 D BMES^XPDUTL("   Closeout date for the 9/30/2007 census changed to 10/14/2007.")
"RTN","DG53729C",27,0)
 Q
"RTN","DG53729P")
0^1^B84374010^n/a
"RTN","DG53729P",1,0)
DG53729P ;ALB/JRC - Add NURSING HOME TREATING SPECIALTIES ; 3/12/07 7:21am
"RTN","DG53729P",2,0)
 ;;5.3;Registration;**729**;Aug 13, 1993;Build 59
"RTN","DG53729P",3,0)
 ;base program: DG53683P
"RTN","DG53729P",4,0)
EN ;Add Treating Specialties to the SPECIALITY file (#42.4)
"RTN","DG53729P",5,0)
 N DGI,DGERR,DGSPEC,DGIFN,DGQUES
"RTN","DG53729P",6,0)
 S DGIFN=0
"RTN","DG53729P",7,0)
 ;add new treating specialties
"RTN","DG53729P",8,0)
 F DGI=1:1 S DGSPEC=$P($T(TRSP+DGI),";;",2) Q:DGSPEC="QUIT"  D
"RTN","DG53729P",9,0)
 .D TSPEC
"RTN","DG53729P",10,0)
 .S DGQUES=$P(DGSPEC,U,9)
"RTN","DG53729P",11,0)
 .D FAC
"RTN","DG53729P",12,0)
 .Q
"RTN","DG53729P",13,0)
 ;edit existing treating specialties
"RTN","DG53729P",14,0)
 D EDIT
"RTN","DG53729P",15,0)
 ;inactivate existing treating specialties
"RTN","DG53729P",16,0)
 D INACT
"RTN","DG53729P",17,0)
 ;edit existing surgical specialties
"RTN","DG53729P",18,0)
 D EDIT^DG53729R
"RTN","DG53729P",19,0)
 ;move ptf code (those < 100) into new austin ptf code field
"RTN","DG53729P",20,0)
 D APTFC
"RTN","DG53729P",21,0)
 ;place option out of order and remove from menu
"RTN","DG53729P",22,0)
 D MENU
"RTN","DG53729P",23,0)
 ;inactivate existing ptf expanded code categories
"RTN","DG53729P",24,0)
 D PTFCAT^DG53729R
"RTN","DG53729P",25,0)
 ;Update 9/30/2007 Census close out date, if exists
"RTN","DG53729P",26,0)
 D EN^DG53729C
"RTN","DG53729P",27,0)
 Q
"RTN","DG53729P",28,0)
TSPEC ;Add treating specialty to SPECIALTY File (#42.4)
"RTN","DG53729P",29,0)
 D BMES^XPDUTL(">>>"_$P(DGSPEC,U,2)_">>>")
"RTN","DG53729P",30,0)
 N DA,DGFILE,DGMULT,DIC,DIE,DGDA1,DINUM,DLAYGO,DR,X,Y
"RTN","DG53729P",31,0)
 S DGERR=0
"RTN","DG53729P",32,0)
 S DIC="^DIC(42.4,"
"RTN","DG53729P",33,0)
 S DIC(0)="LX"
"RTN","DG53729P",34,0)
 S DINUM=$P(DGSPEC,U)
"RTN","DG53729P",35,0)
 S X=$P(DGSPEC,U,2)
"RTN","DG53729P",36,0)
 S DLAYGO=42.4
"RTN","DG53729P",37,0)
 D ^DIC
"RTN","DG53729P",38,0)
 S (DGIFN,DGDA1)=Y
"RTN","DG53729P",39,0)
 I +DGIFN=-1 D  Q
"RTN","DG53729P",40,0)
 .D MES^XPDUTL("     Entry not added to SPECIALTY File (#42.4).  No further updating will occur.")
"RTN","DG53729P",41,0)
 .D MES^XPDUTL("     Please contact Customer Service for assistance.")
"RTN","DG53729P",42,0)
 .Q
"RTN","DG53729P",43,0)
 I $P(DGIFN,U,3)'=1&(+DGIFN'=$P(DGSPEC,U)) D  Q
"RTN","DG53729P",44,0)
 .D MES^XPDUTL("     Entry exists in SPECIALTY File (#42.4), but with a different PTF Code #.")
"RTN","DG53729P",45,0)
 .D MES^XPDUTL("     No further updating will occur.  Please review entry.")
"RTN","DG53729P",46,0)
 .S DGERR=1
"RTN","DG53729P",47,0)
 .Q 
"RTN","DG53729P",48,0)
 D MES^XPDUTL("     Entry "_$S($P(DGIFN,U,3)=1:"added to",1:"exists in")_" SPECIALTY File (#42.4).")
"RTN","DG53729P",49,0)
 D MES^XPDUTL("     Updating SPECIALTY File fields.")
"RTN","DG53729P",50,0)
 S DIE=DIC
"RTN","DG53729P",51,0)
 S DR="1///"_$P(DGSPEC,U,3)_";3///"_$P(DGSPEC,U,4)_";4///"_$P(DGSPEC,U,5)_";5///"_$P(DGSPEC,U,6)_";6///"_$P(DGSPEC,U,7)_";7///"_$P(DGSPEC,U,10)
"RTN","DG53729P",52,0)
 S DA=+DGIFN
"RTN","DG53729P",53,0)
 D ^DIE
"RTN","DG53729P",54,0)
 S DGFILE=42.4
"RTN","DG53729P",55,0)
 S DGMULT=10
"RTN","DG53729P",56,0)
 S DIC="^DIC(42.4,"_+DGIFN_",""E"","
"RTN","DG53729P",57,0)
 D MULT
"RTN","DG53729P",58,0)
 Q
"RTN","DG53729P",59,0)
FAC ;Add treating specialty to Facility Treating Specialty file (#45.7)
"RTN","DG53729P",60,0)
 N DA,DGFILE,DGMULT,DIC,DIE,DLAYGO,DR,X,Y
"RTN","DG53729P",61,0)
 S DIC="^DIC(45.7,"
"RTN","DG53729P",62,0)
 S DIC(0)="LXZ"
"RTN","DG53729P",63,0)
 S DLAYGO=45.7
"RTN","DG53729P",64,0)
 S X=$P(DGSPEC,U,2)
"RTN","DG53729P",65,0)
 D ^DIC
"RTN","DG53729P",66,0)
 S DGDA1=Y
"RTN","DG53729P",67,0)
 I +DGDA1=-1 D BMES^XPDUTL("     Entry not added to FACILITY TREATING SPECIALTY File(#45.7).") Q
"RTN","DG53729P",68,0)
 I $P(DGDA1,U,3)'=1&($P(Y(0),U,2)'=$P(DGSPEC,U)) D  Q
"RTN","DG53729P",69,0)
 .D BMES^XPDUTL("     Entry exists in FACILITY TREATING SPECIALTY File (#45.7), but with")
"RTN","DG53729P",70,0)
 .D MES^XPDUTL("     a different PTF Code #.  No further updating will occur.")
"RTN","DG53729P",71,0)
 .D MES^XPDUTL("     Please review entry.")
"RTN","DG53729P",72,0)
 .Q
"RTN","DG53729P",73,0)
 D BMES^XPDUTL("     Entry "_$S($P(DGDA1,U,3)=1:"added to",1:"exists in")_" FACILITY TREATING SPECIALTY File (#45.7).")
"RTN","DG53729P",74,0)
 D MES^XPDUTL("     Updating SPECIALTY field...")
"RTN","DG53729P",75,0)
 S DIE=DIC
"RTN","DG53729P",76,0)
 S DA=+DGDA1
"RTN","DG53729P",77,0)
 S DR="1////"_$P(DGSPEC,U)
"RTN","DG53729P",78,0)
 D ^DIE
"RTN","DG53729P",79,0)
 S DGFILE=45.7
"RTN","DG53729P",80,0)
 S DGMULT=100
"RTN","DG53729P",81,0)
 S DIC="^DIC(45.7,"_+DGDA1_",""E"","
"RTN","DG53729P",82,0)
 D MULT
"RTN","DG53729P",83,0)
 Q
"RTN","DG53729P",84,0)
MULT ;Add Effective Date
"RTN","DG53729P",85,0)
 N DA,DIE,DR
"RTN","DG53729P",86,0)
 S DA(1)=+DGDA1
"RTN","DG53729P",87,0)
 S DIC(0)="LX"
"RTN","DG53729P",88,0)
 S DIC("P")=$P(^DD(DGFILE,DGMULT,0),"^",2)
"RTN","DG53729P",89,0)
 S X=3071001
"RTN","DG53729P",90,0)
 D ^DIC
"RTN","DG53729P",91,0)
 S DA=+Y
"RTN","DG53729P",92,0)
 I +Y=-1 D MES^XPDUTL("     Effective date not added.") Q
"RTN","DG53729P",93,0)
 D MES^XPDUTL("     Effective date added.")
"RTN","DG53729P",94,0)
 S DIE=DIC
"RTN","DG53729P",95,0)
 S DR=".02///Y"
"RTN","DG53729P",96,0)
 D ^DIE
"RTN","DG53729P",97,0)
 Q
"RTN","DG53729P",98,0)
INACT ;inactivate treating specialties
"RTN","DG53729P",99,0)
 N DA,DIE,DR,X,DGTSP
"RTN","DG53729P",100,0)
 F DGTSP=1,7,34 D
"RTN","DG53729P",101,0)
 . S DIC="^DIC(42.4,"_DGTSP_",""E"","
"RTN","DG53729P",102,0)
 . S DA(1)=DGTSP
"RTN","DG53729P",103,0)
 . S DIC(0)="LX"
"RTN","DG53729P",104,0)
 . S DIC("P")=$P(^DD(42.4,10,0),"^",2)
"RTN","DG53729P",105,0)
 . S X=3071001
"RTN","DG53729P",106,0)
 . D ^DIC
"RTN","DG53729P",107,0)
 . S DA=+Y
"RTN","DG53729P",108,0)
 . I +Y=-1 D BMES^XPDUTL(">>>Inactive date not added to TS code "_DGTSP_" in the Specialty file.<<<") Q
"RTN","DG53729P",109,0)
 . D BMES^XPDUTL(">>>Inactive date added to TS code "_DGTSP_" in the Specialty file.<<<")
"RTN","DG53729P",110,0)
 . S DIE=DIC
"RTN","DG53729P",111,0)
 . S DR=".02///N"
"RTN","DG53729P",112,0)
 . D ^DIE
"RTN","DG53729P",113,0)
 . ;check for CODES in the Facility Treating Specialty File (45.7
"RTN","DG53729P",114,0)
 . ;add inactivation date of 7/1/2006
"RTN","DG53729P",115,0)
 . D BMES^XPDUTL("  ")
"RTN","DG53729P",116,0)
 . D MES^XPDUTL("     FACILITY TREATING SPECIALTY FILE being checked to see if any entries are")
"RTN","DG53729P",117,0)
 . D MES^XPDUTL("     pointing to "_DGTSP_".  If so, they will be inactivated.>>>")
"RTN","DG53729P",118,0)
 .N DAA F DAA=0:0 S DAA=$O(^DIC(45.7,"ASPEC",DGTSP,DAA)) Q:'DAA  D
"RTN","DG53729P",119,0)
 .. N DIE,DR,TS,X S TS=""
"RTN","DG53729P",120,0)
 ..S TS=$P($G(^DIC(45.7,DAA,0)),"^")
"RTN","DG53729P",121,0)
 ..S DIC="^DIC(45.7,"_DAA_",""E"","
"RTN","DG53729P",122,0)
 ..S DA(1)=DAA
"RTN","DG53729P",123,0)
 ..S DIC(0)="LX"
"RTN","DG53729P",124,0)
 ..S X=3060701
"RTN","DG53729P",125,0)
 ..D ^DIC
"RTN","DG53729P",126,0)
 ..S DA=+Y
"RTN","DG53729P",127,0)
 ..I +Y=-1 D BMES^XPDUTL("     Inactive date not added to "_TS_"in the Facility Treating Specialty file.") Q
"RTN","DG53729P",128,0)
 ..D BMES^XPDUTL("     Inactive date added to "_TS_" in the Facility Treating Specialty file.<<<")
"RTN","DG53729P",129,0)
 ..S DIE=DIC
"RTN","DG53729P",130,0)
 ..S DR=".02///N"
"RTN","DG53729P",131,0)
 ..D ^DIE
"RTN","DG53729P",132,0)
 Q
"RTN","DG53729P",133,0)
EDIT ;Edit treating specialties
"RTN","DG53729P",134,0)
 ;
"RTN","DG53729P",135,0)
 N DS,DIE,DR,DGI
"RTN","DG53729P",136,0)
 S DIE="^DIC(42.4,"
"RTN","DG53729P",137,0)
 S DIC(0)="LX"
"RTN","DG53729P",138,0)
 F DGI=1:1 S DGSPEC=$P($T(ETRSP+DGI),";;",2) Q:DGSPEC="QUIT"  D
"RTN","DG53729P",139,0)
 . S DGERR=0
"RTN","DG53729P",140,0)
 . S DA=$P(DGSPEC,U)
"RTN","DG53729P",141,0)
 . S DR=".01///"_$P(DGSPEC,U,2)_";1///"_$P(DGSPEC,U,3)_";3///"_$P(DGSPEC,U,4)_";4///"_$P(DGSPEC,U,5)_";5///"_$P(DGSPEC,U,6)_";6///"_$P(DGSPEC,U,7)
"RTN","DG53729P",142,0)
 . D ^DIE
"RTN","DG53729P",143,0)
 . D BMES^XPDUTL("  ")
"RTN","DG53729P",144,0)
 . D BMES^XPDUTL("  ")
"RTN","DG53729P",145,0)
 . D BMES^XPDUTL(">>>"_$P(DGSPEC,U)_" code updated to "_$P(DGSPEC,U,2)_" in the Specialty file.>>>")
"RTN","DG53729P",146,0)
 N DS,DIE,DR,DGI,DGII,DGSP,CNT,DGSPEC,DGSPEC1
"RTN","DG53729P",147,0)
 S DIE="^DIC(45.7,"
"RTN","DG53729P",148,0)
 S DIC(0)="LX"
"RTN","DG53729P",149,0)
 F DGI=1:1 S DGSPEC=$P($T(ETRSP+DGI),";;",2) Q:DGSPEC="QUIT"  D
"RTN","DG53729P",150,0)
 . S DGERR=0
"RTN","DG53729P",151,0)
 . S DGSP=$P(DGSPEC,U)
"RTN","DG53729P",152,0)
 . S CNT=0,DGSPEC1=0 F DGII=0:0 S DGSPEC1=$O(^DIC(45.7,"ASPEC",DGSP,DGSPEC1)) Q:'DGSPEC1  S CNT=CNT+1 D
"RTN","DG53729P",153,0)
 .. I CNT=1 D
"RTN","DG53729P",154,0)
 ... I $$ACTIVE^DGACT(45.7,DGSPEC1)'=1 S CNT=0 Q
"RTN","DG53729P",155,0)
 ... S DA=DGSPEC1,DR=".01///"_$P(DGSPEC,U,2)_";99///@"
"RTN","DG53729P",156,0)
 ... D BMES^XPDUTL("     "_$P(^DIC(45.7,DGSPEC1,0),U)_" name has been changed to "_$P(DGSPEC,U,2)_" in the Facility Treating Specialty file.")
"RTN","DG53729P",157,0)
 ... D ^DIE
"RTN","DG53729P",158,0)
 .. E  D
"RTN","DG53729P",159,0)
 ... S TS=""
"RTN","DG53729P",160,0)
 ... S TS=$P($G(^DIC(45.7,DGSPEC1,0)),"^")
"RTN","DG53729P",161,0)
 ... D BMES^XPDUTL("     Please review Facility Treating Specialty "_TS_".  The entry name may need changing or entry may need inactivating since more than one entry points to "_$P(DGSPEC,U,2)_" in the Specialty file.<<<")
"RTN","DG53729P",162,0)
 Q
"RTN","DG53729P",163,0)
TRSP ;PTF code^Specialty^Print Name^Service^Ask Psych^Billing Bedsection^CDR^^Ques#^Austin PTF Code
"RTN","DG53729P",164,0)
 ;;13^CARDIAC INTENSIVE CARE UNIT^^MEDICINE^N^GENERAL MEDICAL CARE^1117^^^13
"RTN","DG53729P",165,0)
 ;;30^PEDIATRICS^^MEDICINE^N^GENERAL MEDICAL CARE^1110^^^30
"RTN","DG53729P",166,0)
 ;;48^CARDIAC SURGERY^^SURGERY^N^SURGICAL CARE^1210^^^48
"RTN","DG53729P",167,0)
 ;;49^TRANSPLANTATION^^SURGERY^N^SURGICAL CARE^1210^^^49
"RTN","DG53729P",168,0)
 ;;78^ANESTHESIOLOGY^^SURGERY^N^SURGICAL CARE^1210^^^78
"RTN","DG53729P",169,0)
 ;;82^PM&R TRANSITIONAL REHAB^^REHAB MEDICINE^N^REHABILITATION MEDICINE^1113^^^82
"RTN","DG53729P",170,0)
 ;;97^SURGICAL STEPDOWN^^SURGERY^N^SURGICAL CARE^1210^^^97
"RTN","DG53729P",171,0)
 ;;100^SHORT STAY GRECC-NHCU^SS GRECC-NHCU^NHCU^N^NURSING HOME CARE^1430^^^1A
"RTN","DG53729P",172,0)
 ;;101^LONG STAY GRECC-NHCU^LS GRECC-NHCU^NHCU^N^NURSING HOME CARE^1410^^^1B
"RTN","DG53729P",173,0)
 ;;102^SHORT STAY GRECC-GEM-NHCU^SS GRECC-GEM-NH^NHCU^N^NURSING HOME CARE^1420^^^1C
"RTN","DG53729P",174,0)
 ;;103^GRECC-GEM-REHAB^^REHAB MEDICINE^N^REHABILITATION MEDICINE^1120^^^1D
"RTN","DG53729P",175,0)
 ;;104^GRECC-MED^^MEDICINE^N^GENERAL MEDICAL CARE^1110^^^1E
"RTN","DG53729P",176,0)
 ;;QUIT
"RTN","DG53729P",177,0)
ETRSP ;;PTF code^Specialty^Print Name^Service^Ask Psych^Billing Bedsection^CDR
"RTN","DG53729P",178,0)
 ;;12^MEDICAL ICU^^MEDICINE^N^GENERAL MEDICAL CARE^1117^^
"RTN","DG53729P",179,0)
 ;;50^GENERAL SURGERY^^SURGERY^N^SURGICAL CARE^1210^^
"RTN","DG53729P",180,0)
 ;;51^OB/GYN^^SURGERY^N^SURGICAL CARE^1210^^
"RTN","DG53729P",181,0)
 ;;55^EAR, NOSE, THROAT (ENT)^^SURGERY^N^SURGICAL CARE^1210^^
"RTN","DG53729P",182,0)
 ;;56^PLASTIC SURGERY^^SURGERY^N^SURGICAL CARE^1210^^
"RTN","DG53729P",183,0)
 ;;58^THORACIC SURGERY^^SURGERY^N^SURGICAL CARE^1210^^
"RTN","DG53729P",184,0)
 ;;60^ORAL SURGERY^^SURGERY^N^SURGICAL CARE^1210^^
"RTN","DG53729P",185,0)
 ;;QUIT
"RTN","DG53729P",186,0)
 Q
"RTN","DG53729P",187,0)
MENU ;Remove option from menu and place out of order
"RTN","DG53729P",188,0)
 N MENU,OPTION,CHECK,IEN
"RTN","DG53729P",189,0)
 S MENU="DGPT TOOLS MENU",OPTION="DG PTF SUFFIX EFF DATE EDIT"
"RTN","DG53729P",190,0)
 S CHECK=$$DELETE^XPDMENU(MENU,OPTION)
"RTN","DG53729P",191,0)
 D BMES^XPDUTL(">>> "_OPTION_" OPTION "_$S(CHECK:"REMOVED FROM ",1:"DOES NOT EXIST IN ")_MENU_" <<<")
"RTN","DG53729P",192,0)
 D OUT^XPDMENU(OPTION,"OUT OF ORDER, DO NOT USE THIS OPTION!!!")
"RTN","DG53729P",193,0)
 D BMES^XPDUTL(">>> "_OPTION_" OPTION PLACED OUT ORDER <<<")
"RTN","DG53729P",194,0)
 ;Rename CDR Inquiry [DGPT CDR INQUIRY] menu
"RTN","DG53729P",195,0)
 D BMES^XPDUTL(">>> Renaming CDR Inquiry option to MPCR Inquiry <<<")
"RTN","DG53729P",196,0)
 S IEN=$$LKOPT^XPDMENU("DGPT CDR INQUIRY")
"RTN","DG53729P",197,0)
 I 'IEN D  Q
"RTN","DG53729P",198,0)
 .D BMES^XPDUTL(">>> Was not able to locate CDR Inquiry option <<<")
"RTN","DG53729P",199,0)
 .D BMES^XPDUTL(">>> PLEASE CONTACT THE NATIONAL HELP DESK <<<")
"RTN","DG53729P",200,0)
 S DIE="^DIC(19,",DIC(0)="LX"
"RTN","DG53729P",201,0)
 S DA=IEN,DR="1///"_"MPCR INQUIRY"_";1.1///"_"MPCR INQUIRY" D ^DIE
"RTN","DG53729P",202,0)
 S ^DIC(19,IEN,1,1,0)="This option allows the user to view the MPCR information related"
"RTN","DG53729P",203,0)
 S ^DIC(19,IEN,1,3,0)="as the data shown on the 'MPCR' screen of the 'Load/Edit PTF Record'"
"RTN","DG53729P",204,0)
 D RENAME^XPDMENU("DGPT CDR INQUIRY","DGPT MPCR INQUIRY")
"RTN","DG53729P",205,0)
 D BMES^XPDUTL(">>> CDR Inquiry Menu option Succesfully renamed <<<")
"RTN","DG53729P",206,0)
 Q
"RTN","DG53729P",207,0)
APTFC ;move ptf code (those < 100) into new austin ptf code field
"RTN","DG53729P",208,0)
 N DGX,DGENTRY,DA,DR,DIE
"RTN","DG53729P",209,0)
 D BMES^XPDUTL(">>> Populating PTF CODE field (#7) of the SPECIALTY (#42.4) file")
"RTN","DG53729P",210,0)
 S DGX="" F  S DGX=$O(^DIC(42.4,"B",DGX)) Q:DGX=""  D
"RTN","DG53729P",211,0)
 . S DGENTRY=$O(^DIC(42.4,"B",DGX,0)) I DGENTRY D
"RTN","DG53729P",212,0)
 .. Q:$L(DGENTRY)>2  I ($E(DGENTRY,1)?1A)!($E(DGENTRY,2)?1A) Q
"RTN","DG53729P",213,0)
 .. S DA=DGENTRY,DR="7///"_DGENTRY,DIE="^DIC(42.4," D ^DIE
"RTN","DG53729P",214,0)
 Q 
"RTN","DG53729R")
0^33^B13019595^n/a
"RTN","DG53729R",1,0)
DG53729R ;ALB/JRC - Add NURSING HOME TREATING SPECIALTIES ; 2/21/07 12:31pm
"RTN","DG53729R",2,0)
 ;;5.3;Registration;**729**;Aug 13, 1993;Build 59
"RTN","DG53729R",3,0)
 ;Continuation of DG53729P
"RTN","DG53729R",4,0)
 ;
"RTN","DG53729R",5,0)
EDIT ;Edit surgical specialties
"RTN","DG53729R",6,0)
 N DS,DIE,DR,DGI,DGCD
"RTN","DG53729R",7,0)
 S DIE="^DIC(45.3,"
"RTN","DG53729R",8,0)
 S DIC(0)="X"
"RTN","DG53729R",9,0)
 F DGI=1:1 S DGSPEC=$P($T(ESURGSP+DGI),";;",2) Q:DGSPEC="QUIT"  D
"RTN","DG53729R",10,0)
 .S DGERR=0
"RTN","DG53729R",11,0)
 .S DGCD=$P(DGSPEC,U)
"RTN","DG53729R",12,0)
 .S DGSPEC1=0 F DGII=0:0 S DGSPEC1=$O(^DIC(45.3,"B",DGCD,DGSPEC1)) Q:'DGSPEC1  D
"RTN","DG53729R",13,0)
 ..S DA=DGSPEC1,DR="1///"_$P(DGSPEC,U,2)
"RTN","DG53729R",14,0)
 ..D ^DIE
"RTN","DG53729R",15,0)
 ..D BMES^XPDUTL(" ")
"RTN","DG53729R",16,0)
 ..D BMES^XPDUTL(" ")
"RTN","DG53729R",17,0)
 ..D BMES^XPDUTL(">>>"_$P(DGSPEC,U)_" code updated to "_$P(DGSPEC,U,2)_" in the Surgical Specialty file.>>>")
"RTN","DG53729R",18,0)
 Q
"RTN","DG53729R",19,0)
 ;
"RTN","DG53729R",20,0)
ESURGSP ;;Code^Specialty
"RTN","DG53729R",21,0)
 ;;50^GENERAL SURGERY
"RTN","DG53729R",22,0)
 ;;51^OB/GYN
"RTN","DG53729R",23,0)
 ;;55^EAR, NOSE, THROAT (ENT)
"RTN","DG53729R",24,0)
 ;;56^PLASTIC SURGERY
"RTN","DG53729R",25,0)
 ;;58^THORACIC SURGERY
"RTN","DG53729R",26,0)
 ;;60^ORAL SURGERY
"RTN","DG53729R",27,0)
 ;;QUIT
"RTN","DG53729R",28,0)
 Q
"RTN","DG53729R",29,0)
 ;
"RTN","DG53729R",30,0)
PTFCAT ;Place inactive date in PTF EXPANDED CODE CATEGORY (#.03) field
"RTN","DG53729R",31,0)
 ;Temporarily remove 'no editing' from Data Dictionary
"RTN","DG53729R",32,0)
 N SAVXI,SAVXF,SAVXC,XI,XF,XC
"RTN","DG53729R",33,0)
 S SAVXF=$P(^DD(45.88,.02,0),U,2) ;Flag field
"RTN","DG53729R",34,0)
 S XF=$P(SAVXF,"I",1)_$P(SAVXF,"I",2,99) ;REMOVE THE 'I'
"RTN","DG53729R",35,0)
 S SAVXI=$P(^DD(45.88,.03,0),U,2) ;Inactive Date field
"RTN","DG53729R",36,0)
 S XI=$P(SAVXI,"I",1)_$P(SAVXI,"I",2,99) ;REMOVE THE 'I'
"RTN","DG53729R",37,0)
 S SAVXC=$P(^DD(45.89,.01,0),U,2) ;Category field
"RTN","DG53729R",38,0)
 S XC=$P(SAVXC,"I",1)_$P(SAVXC,"I",2,99) ;REMOVE THE 'I'
"RTN","DG53729R",39,0)
 S $P(^DD(45.88,.02,0),U,2)=XF
"RTN","DG53729R",40,0)
 S $P(^DD(45.88,.03,0),U,2)=XI
"RTN","DG53729R",41,0)
 S $P(^DD(45.89,.01,0),U,2)=XC
"RTN","DG53729R",42,0)
 N I,CAT,DIC,DIE,DR,X,Y,DGPCD
"RTN","DG53729R",43,0)
 F I=1:1 S CAT=$P($T(PTFCAT1+I),";;",2) Q:CAT="QUIT"  D
"RTN","DG53729R",44,0)
 . S DIC="^DIC(45.88,",DIC(0)="X"
"RTN","DG53729R",45,0)
 . S X=$P(CAT,"^")
"RTN","DG53729R",46,0)
 . I $P(CAT,"^")="DIALYSIS TYPE" S DIC(0)="LM"
"RTN","DG53729R",47,0)
 . D ^DIC
"RTN","DG53729R",48,0)
 . I +Y>0 D
"RTN","DG53729R",49,0)
 .. S DIE=DIC,DA=+Y
"RTN","DG53729R",50,0)
 .. S DR=".03////"_$P(CAT,"^",2)
"RTN","DG53729R",51,0)
 .. I $P(CAT,"^")="DIALYSIS TYPE" S DR=".02///8"
"RTN","DG53729R",52,0)
 .. D ^DIE
"RTN","DG53729R",53,0)
 ..I $P(CAT,"^")="DIALYSIS TYPE" D
"RTN","DG53729R",54,0)
 ...D BMES^XPDUTL(">>>"_$P(CAT,"^")_" added to the PTF EXPANDED CODE CATEGORY File (#45.88).")
"RTN","DG53729R",55,0)
 ..E  D
"RTN","DG53729R",56,0)
 ...D BMES^XPDUTL(">>>Inactive date added to category "_$P(CAT,"^")_" in the")
"RTN","DG53729R",57,0)
 ...D MES^XPDUTL("   PTF EXPANDED CODE CATEGORY File (#45.88).<<<")
"RTN","DG53729R",58,0)
 ;In file 45.89, add procedure codes to newly added DIALYSIS TYPE
"RTN","DG53729R",59,0)
 F DGPCD=39.95,54.98,50.92 D
"RTN","DG53729R",60,0)
 .S DIC="^ICD0(",DIC(0)="MX",X=DGPCD D ^DIC
"RTN","DG53729R",61,0)
 .Q:+Y'>0
"RTN","DG53729R",62,0)
 .I $D(^DIC(45.89,"ASPL",+Y_";ICD0(")) D  Q
"RTN","DG53729R",63,0)
 ..D MES^XPDUTL(">>>>Entry "_$P(Y,U,2)_" exists in PTF EXPANDED CODE File (#45.89).")
"RTN","DG53729R",64,0)
 .S DIC="^DIC(45.89,",DIC(0)=""
"RTN","DG53729R",65,0)
 .S DIC("DR")=".01///6"_";.02///"_DGPCD,X="DIALYSIS TYPE"
"RTN","DG53729R",66,0)
 .K D0 D FILE^DICN
"RTN","DG53729R",67,0)
 .I +Y<0 D  Q
"RTN","DG53729R",68,0)
 ..D MES^XPDUTL(">>>>Entry not added to PTF EXPANDED CODE File (#45.89).  No further updating will occur.")
"RTN","DG53729R",69,0)
 ..D MES^XPDUTL("   Please contact Customer Service for assistance.")
"RTN","DG53729R",70,0)
 .D MES^XPDUTL(">>>>Entry "_$S($P(Y,U,3)=1:"added to",1:"exists in")_" PTF EXPANDED CODE File (#45.89).")
"RTN","DG53729R",71,0)
 ;Place 'old' value back into Data Dictionary
"RTN","DG53729R",72,0)
 S $P(^DD(45.88,.02,0),U,2)=SAVXF
"RTN","DG53729R",73,0)
 S $P(^DD(45.88,.03,0),U,2)=SAVXI
"RTN","DG53729R",74,0)
 S $P(^DD(45.89,.01,0),U,2)=SAVXC
"RTN","DG53729R",75,0)
 K DIC,DIE,DA,DR,Y,X
"RTN","DG53729R",76,0)
 ;
"RTN","DG53729R",77,0)
 ;-Remove DIALYSIS TYPE trigger xref.
"RTN","DG53729R",78,0)
 I $D(^DD(45.05,2,1,1)) D
"RTN","DG53729R",79,0)
 .D BMES^XPDUTL(">>>Removing DIALYSIS TYPE trigger cross-reference.")
"RTN","DG53729R",80,0)
 .D DELIX^DDMOD(45.05,2,1)
"RTN","DG53729R",81,0)
 Q
"RTN","DG53729R",82,0)
PTFCAT1 ;- PTF EXPANDED CODE CATEGORY items to inactivate
"RTN","DG53729R",83,0)
 ;;KIDNEY TRANSPLANT STATUS^3060701
"RTN","DG53729R",84,0)
 ;;SUICIDE INDICATOR^3060701
"RTN","DG53729R",85,0)
 ;;LEGIONNAIRE'S DISEASE^3060701
"RTN","DG53729R",86,0)
 ;;SUBSTANCE ABUSE^3060701
"RTN","DG53729R",87,0)
 ;;DIALYSIS TYPE^^8
"RTN","DG53729R",88,0)
 ;;QUIT
"RTN","DGACT")
0^41^B5237552^B715902
"RTN","DGACT",1,0)
DGACT ;ALB/CAW - Active check for facility TS or Specialty ; 7/27/94
"RTN","DGACT",2,0)
 ;;5.3;Registration;**64,683,729**;Aug 13, 1993;Build 59
"RTN","DGACT",3,0)
 ;
"RTN","DGACT",4,0)
 ;
"RTN","DGACT",5,0)
ACTIVE(FILE,IEN,DGDT) ; Extrinsic function to determine if TS entry is active
"RTN","DGACT",6,0)
 ;
"RTN","DGACT",7,0)
 ;     Input -- FILE to determine if checking facility TS or TS
"RTN","DGACT",8,0)
 ;                  FACILITY TREATING SPECIALTY (45.7)
"RTN","DGACT",9,0)
 ;                  SPECIALTY (42.4)
"RTN","DGACT",10,0)
 ;          IEN is the internal IFN of whichever file passed in
"RTN","DGACT",11,0)
 ;       DGDT as 'as of' date (uses DT if undefined)
"RTN","DGACT",12,0)
 ;    Output -- 1 if active, 0 otherwise
"RTN","DGACT",13,0)
 ;
"RTN","DGACT",14,0)
 N DGID,Y,X
"RTN","DGACT",15,0)
 S DGID=$S($G(DGDT):DGDT,1:DT)
"RTN","DGACT",16,0)
 S DGID=$S('$P(DGID,".",2):(DGID)_.2359,1:(DGID)),DGID=-DGID
"RTN","DGACT",17,0)
 S Y=0
"RTN","DGACT",18,0)
 S ID=$O(^DIC(FILE,IEN,"E","ADATE",DGID)) G:'ID ACTIVEQ
"RTN","DGACT",19,0)
 S ID=$O(^DIC(FILE,IEN,"E","ADATE",ID,0))
"RTN","DGACT",20,0)
 S X=$G(^DIC(FILE,IEN,"E",ID,0)) I 'X G ACTIVEQ
"RTN","DGACT",21,0)
 I $P(X,"^",2)=1 S Y=1
"RTN","DGACT",22,0)
ACTIVEQ Q $S(Y:1,1:0)
"RTN","DGACT",23,0)
 ;
"RTN","DGACT",24,0)
TSDATA(FILE,IEN,ARRAY,DGDT) ; Call to return TS data
"RTN","DGACT",25,0)
 ;
"RTN","DGACT",26,0)
 ;     Input -- FILE to determine if checking facility TS or TS
"RTN","DGACT",27,0)
 ;                  FACILITY TREATING SPECIALTY (45.7)
"RTN","DGACT",28,0)
 ;                  SPECIALTY (42.4)
"RTN","DGACT",29,0)
 ;          IEN is the internal IFN of whichever file passed in
"RTN","DGACT",30,0)
 ;       DGDT as 'as of' date (uses DT if undefined)
"RTN","DGACT",31,0)
 ;    Output -- 1 if entry exists, -1 otherwise
"RTN","DGACT",32,0)
 ;** Responsibility of calling routine to handle undefined array when -1
"RTN","DGACT",33,0)
 ;       ARRAY(0) := 1 if active, 0 otherwise
"RTN","DGACT",34,0)
 ;       If FILE=45.7
"RTN","DGACT",35,0)
 ;         ARRAY(1) := Name
"RTN","DGACT",36,0)
 ;         ARRAY(2) := Specialty ptr to 42.4 file^Specialty name
"RTN","DGACT",37,0)
 ;         ARRAY(3) := Abbreviation
"RTN","DGACT",38,0)
 ;         ARRAY(4) := Service ptr to 49 file^Service name
"RTN","DGACT",39,0)
 ;       If FILE=42.4
"RTN","DGACT",40,0)
 ;         ARRAY(1) := Name
"RTN","DGACT",41,0)
 ;         ARRAY(2) := Print name
"RTN","DGACT",42,0)
 ;         ARRAY(3) := Service (set value)^Service (set value) name
"RTN","DGACT",43,0)
 ;         ARRAY(4) := Ask Psychiatric Question? (set value)^null/yes/no
"RTN","DGACT",44,0)
 ;         ARRAY(5) := Billing Rate Bedsection^
"RTN","DGACT",45,0)
 ;         ARRAY(6) := MPCR Account
"RTN","DGACT",46,0)
 ;         ARRAY(7) := PTF Code (alpha-numeric)
"RTN","DGACT",47,0)
 ;
"RTN","DGACT",48,0)
 ;
"RTN","DGACT",49,0)
 K ARRAY N DGI
"RTN","DGACT",50,0)
 S FILE=$G(FILE),IEN=$G(IEN),DGDT=$G(DGDT)
"RTN","DGACT",51,0)
 I '$D(^DIC(FILE,+$G(IEN),0)) Q -1
"RTN","DGACT",52,0)
 I FILE=45.7 D
"RTN","DGACT",53,0)
 . F DGI=0:1:4 S ARRAY(DGI)=""
"RTN","DGACT",54,0)
 . S ARRAY(0)=$$ACTIVE(FILE,IEN,DGDT)
"RTN","DGACT",55,0)
 . S ARRAY(1)=$$GET1^DIQ(45.7,IEN_",",.01)
"RTN","DGACT",56,0)
 . S ARRAY(2)=$$GET1^DIQ(45.7,IEN_",",1,"I")_"^"_$$GET1^DIQ(45.7,IEN_",",1)
"RTN","DGACT",57,0)
 . S ARRAY(3)=$$GET1^DIQ(45.7,IEN_",",99)
"RTN","DGACT",58,0)
 . S ARRAY(4)=$$GET1^DIQ(45.7,IEN_",",2,"I")_"^"_$$GET1^DIQ(45.7,IEN_",",2)
"RTN","DGACT",59,0)
 I FILE=42.4 D
"RTN","DGACT",60,0)
 . F DGI=1:1:7 S ARRAY(DGI)=""
"RTN","DGACT",61,0)
 . S ARRAY(0)=$$ACTIVE(FILE,IEN,DGDT)
"RTN","DGACT",62,0)
 . S ARRAY(1)=$$GET1^DIQ(42.4,IEN_",",.01)
"RTN","DGACT",63,0)
 . S ARRAY(2)=$$GET1^DIQ(42.4,IEN_",",1)
"RTN","DGACT",64,0)
 . S ARRAY(3)=$$GET1^DIQ(42.4,IEN_",",3,"I")_"^"_$$GET1^DIQ(42.4,IEN_",",3)
"RTN","DGACT",65,0)
 . S ARRAY(4)=$$GET1^DIQ(42.4,IEN_",",4,"I")_"^"_$$GET1^DIQ(42.4,IEN_",",4)
"RTN","DGACT",66,0)
 . S ARRAY(5)=$$GET1^DIQ(42.4,IEN_",",5,"I")_"^"_$$GET1^DIQ(42.4,IEN_",",5)
"RTN","DGACT",67,0)
 . S ARRAY(6)=$$GET1^DIQ(42.4,IEN_",",6)
"RTN","DGACT",68,0)
 . S ARRAY(7)=$$GET1^DIQ(42.4,IEN_",",7)
"RTN","DGACT",69,0)
TSDATAQ Q 1
"RTN","DGPT401")
0^42^B8757458^B8445522
"RTN","DGPT401",1,0)
DGPT401 ;ALB/MTC - 401/402/403 Edits ; 16 NOV 92
"RTN","DGPT401",2,0)
 ;;5.3;Registration;**164,729**;Aug 13, 1993;Build 59
"RTN","DGPT401",3,0)
 ;
"RTN","DGPT401",4,0)
 ;Edits for 401/402/403 transmission
"RTN","DGPT401",5,0)
EN ;
"RTN","DGPT401",6,0)
 N ERROR
"RTN","DGPT401",7,0)
 S (DGPTEDFL,DGPTERC)=0,DGPTSTR=^TMP("AEDIT",$J,NODE,SEQ),DGPTERC=0
"RTN","DGPT401",8,0)
 S:$E(DGPTSTR,37,40)="2400" DGPTSTR=$E(DGPTSTR,1,36)_"2359"_$E(DGPTSTR,41,125)
"RTN","DGPT401",9,0)
SET ;
"RTN","DGPT401",10,0)
 S DGPTSDT=$E(DGPTSTR,31,40)
"RTN","DGPT401",11,0)
 S DGPTSSC=$E(DGPTSTR,41,42),DGPTSCS=$E(DGPTSTR,43),DGPTSFA=$E(DGPTSTR,44),DGPTSAT=$E(DGPTSTR,45),DGPTSSP=$E(DGPTSTR,46),DGPTSO1=$E(DGPTSTR,47,53),DGPTSO2=$E(DGPTSTR,54,60)
"RTN","DGPT401",12,0)
 S DGPTSO3=$E(DGPTSTR,61,67),DGPTSO4=$E(DGPTSTR,68,74),DGPTSO5=$E(DGPTSTR,75,81),DGPTXX=$E(DGPTSTR,82,90)
"RTN","DGPT401",13,0)
 S DGPT40PT=$E(DGPTSTR,91)
"RTN","DGPT401",14,0)
DATE ;
"RTN","DGPT401",15,0)
 S DGPTSDT=$E(DGPTSTR,31,40),(X,DGPTSDD)=$$FMDT^DGPT101($E(DGPTSDT,1,6))_"."_$E(DGPTSDT,7,10) S %DT="XT" D ^%DT K %DT I Y<0 S DGPTERC=405 D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",16,0)
 I (DGPTSDD<DGPTDTS)!(DGPTSDD>DGPTDDS) S DGPTERC=437 D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",17,0)
 I (DGPTSDD>DGPTDDS) S DGPTERC=440 D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",18,0)
 D DD^%DT S DGPTSDT=$E(Y,5,6)_"-"_$E(Y,1,3)_"-"_$E(Y,9,12)_" "_$S($P(Y,"@",2)]"":$E($P(Y,"@",2),1,5),1:"00:00")
"RTN","DGPT401",19,0)
 I DGPTSDT'?1.2N1"-"3U1"-"4N1" "2N1":"2N S DGPTERC=450 D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",20,0)
 I ($P(DGPTSDD,".",2)="0000")!($P(DGPTDTS,".",2)="0000")!($P(DGPTDDS,".",2)="0000") S DGPTERC=$S(+DGPTSDD<+DGPTDTS:437,+DGPTSDD>+DGPTDDS:440,1:0)
"RTN","DGPT401",21,0)
SPEC ;
"RTN","DGPT401",22,0)
 I ((DGPTSSC>63)!(DGPTSSC<48))&((DGPTSSC'=65)&(DGPTSSC'=78)&(DGPTSSC'=97)) S DGPTERC=406 D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",23,0)
CHFS ;
"RTN","DGPT401",24,0)
 S DGPTERC=0 D CHIEF^DGPTAE04 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",25,0)
FAST ;
"RTN","DGPT401",26,0)
 S DGPTERC=0 D FAST^DGPTAE04 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",27,0)
ANES ;
"RTN","DGPT401",28,0)
 S DGPTERC=0 D ANES^DGPTAE04 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",29,0)
SRP ;
"RTN","DGPT401",30,0)
 N I,FLAG
"RTN","DGPT401",31,0)
 I "12 "'[DGPTSSP S DGPTERC=410 D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",32,0)
 S FLAG=0 F I=20:1:26 I DGPTSTTY[U_I_U S FLAG=1 Q
"RTN","DGPT401",33,0)
 G:FLAG OPCD
"RTN","DGPT401",34,0)
 I "12"[DGPTSSP S DGPTERC=410 F I=10,11,30,40,42 I DGPTSTTY[U_I_U S FLAG=1,DGPTERC=0 Q
"RTN","DGPT401",35,0)
 I FLAG D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",36,0)
OPCD ;
"RTN","DGPT401",37,0)
 S DGPTERC=0 D FIRST^DGPTAE04 G:DGPTEDFL EXIT
"RTN","DGPT401",38,0)
TRANS ; Transplant status
"RTN","DGPT401",39,0)
 I DGPTDDS'<2911001 G GOOD
"RTN","DGPT401",40,0)
 S DGPTERC=0 D TRAN^DGPTAE04 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT401",41,0)
GOOD ;
"RTN","DGPT401",42,0)
 W:'$D(ERROR) "."
"RTN","DGPT401",43,0)
EXIT ;
"RTN","DGPT401",44,0)
 K DGPTSDT,DGPTSSC,DGPTSCS,DGPTSFA,DGPTSAT,DGPTSSP,DGPTSO1,DGPTSO2,DGPTSO3,DGPTSO4,DGPTSO5,DGPTXX,DGPTSTR
"RTN","DGPT401",45,0)
 K DGPTSDD,DGPT40PT
"RTN","DGPT401",46,0)
 Q
"RTN","DGPT401",47,0)
ERR ;
"RTN","DGPT401",48,0)
 D WRTERR^DGPTAE(DGPTERC,NODE,SEQ)
"RTN","DGPT401",49,0)
 S ERROR=1
"RTN","DGPT401",50,0)
 Q
"RTN","DGPT401",51,0)
 ;
"RTN","DGPT501")
0^38^B11578445^B11017449
"RTN","DGPT501",1,0)
DGPT501 ;ALB/MTC - Set up process 501 transmission ; 8/27/03 10:05am
"RTN","DGPT501",2,0)
 ;;5.3;Registration;**64,164,529,729**;Aug 13, 1993;Build 59
"RTN","DGPT501",3,0)
 ;
"RTN","DGPT501",4,0)
EN ;
"RTN","DGPT501",5,0)
 N ERROR
"RTN","DGPT501",6,0)
 S DGPTEDFL=0
"RTN","DGPT501",7,0)
PARSE ; Set up record string, parse record
"RTN","DGPT501",8,0)
 S DGPTSTR=^TMP("AEDIT",$J,NODE,SEQ)
"RTN","DGPT501",9,0)
 D SET^DGPT501P
"RTN","DGPT501",10,0)
DATE ;
"RTN","DGPT501",11,0)
 S DGPTMDT=$E(DGPTSTR,31,40),(X,DGPTMDTS)=$$FMDT^DGPT101($E(DGPTMDT,1,6))_"."_$E(DGPTMDT,7,10) S %DT="XT" D ^%DT K %DT I Y<0 S DGPTERC=505 D ERR G:DGPTEDFL EXIT G ELAPS
"RTN","DGPT501",12,0)
 D DD^%DT S DGPTMDT=$E(Y,5,6)_"-"_$E(Y,1,3)_"-"_$E(Y,9,12)_" "_$S($P(Y,"@",2)]"":$E($P(Y,"@",2),1,5),1:"00:00")
"RTN","DGPT501",13,0)
 I DGPTMDT'?1.2N1"-"3U1"-"4N1" "2N1":"2N S DGPTERC=505 D ERR G:DGPTEDFL EXIT G TSPEC
"RTN","DGPT501",14,0)
 I DGPTMDTS<DGPTDTS S DGPTERC=537 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",15,0)
 I DGPTMDTS>DGPTDDS S DGPTERC=540 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",16,0)
ELAPS ;
"RTN","DGPT501",17,0)
 S DGPTERC=0 S X1=DGPTMDTS D 501^DGPTAE03 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",18,0)
TSPEC ;
"RTN","DGPT501",19,0)
 N DGPTMSC1
"RTN","DGPT501",20,0)
 I DGPTMSC'?2AN S DGPTERC=506 D ERR G:DGPTEDFL EXIT G LEAV
"RTN","DGPT501",21,0)
 S DGPTSP1=$E(DGPTMSC,1),DGPTSP2=$E(DGPTMSC,2),DGPTERC=0
"RTN","DGPT501",22,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=506 D ERR G:DGPTEDFL EXIT G LEAV
"RTN","DGPT501",23,0)
 ;-- Active treating specialty edit check
"RTN","DGPT501",24,0)
 I $E(DGPTMSC,1)=0!($E(DGPTMSC,1)=" ") S DGPTMSC=$E(DGPTMSC,2)
"RTN","DGPT501",25,0)
 ; DGPTMSC  := ptf code (alpha-numeric) value (file:42.4,field:7)
"RTN","DGPT501",26,0)
 ; DGPTMSC1 := dinum value (ien, file:42.4,field:001)
"RTN","DGPT501",27,0)
 S DGPTMSC1=+$O(^DIC(42.4,"C",DGPTMSC,0))
"RTN","DGPT501",28,0)
 ;-- If not active treat spec, set flag to print error msg during
"RTN","DGPT501",29,0)
 ;-- PTF close-out error display at WRER^DGPTAEE
"RTN","DGPT501",30,0)
 I '$$ACTIVE^DGACT(42.4,DGPTMSC1,DGPTMDTS) S DGPTERC=506,DGPTSER(DGPTMDTS_501)=1 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",31,0)
LEAV ;
"RTN","DGPT501",32,0)
 I DGPTMPD'?1.3N S DGPTERC=508 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",33,0)
SPINL ;
"RTN","DGPT501",34,0)
 D SP^DGPTAE03 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",35,0)
LOCCDR ;
"RTN","DGPT501",36,0)
 I DGPTMLR'?6N S DGPTERC=575 D ERR G:DGPTEDFL EXIT G LOCTRS
"RTN","DGPT501",37,0)
 ;
"RTN","DGPT501",38,0)
LOCTRS ;
"RTN","DGPT501",39,0)
 I DGPTMLC'?2AN&(DGPTMLC'="  ") S DGPTERC=576 D ERR G:DGPTEDFL EXIT G DIAG
"RTN","DGPT501",40,0)
 I DGPTMLC="  "&(DGPTMLR="000000") G DIAG
"RTN","DGPT501",41,0)
 S DGPTSP1=$E(DGPTMLC,1),DGPTSP2=$E(DGPTMLC,2),DGPTERC=0
"RTN","DGPT501",42,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=576 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",43,0)
DIAG ;
"RTN","DGPT501",44,0)
 D ^DGPT50DI G:DGPTEDFL EXIT
"RTN","DGPT501",45,0)
BSTAT ;
"RTN","DGPT501",46,0)
 I "12345 "'[DGPTMBS S DGPTERC=515 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",47,0)
FY92 ;
"RTN","DGPT501",48,0)
 I DGPTDDS<2911001 G GOOD
"RTN","DGPT501",49,0)
LEG ; Legionnaires disease
"RTN","DGPT501",50,0)
 S DGPTERC=0 D LEG^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",51,0)
SUI ; Suicide indicator
"RTN","DGPT501",52,0)
 S DGPTERC=0 D SUI^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",53,0)
DRUG ; Drug indicator
"RTN","DGPT501",54,0)
 S DGPTERC=0 D DRUG^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",55,0)
AXES ;Axis 4 and 5
"RTN","DGPT501",56,0)
 I '$P($G(^DIC(42.4,+DGPTMSC1,0)),U,4) S (DGPTMXIV,DGPTMXV1,DGPTMXV2)=" " G SERVC
"RTN","DGPT501",57,0)
 S DGPTERC=0 D AXIV^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",58,0)
 S DGPTERC=0 D AXV1^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",59,0)
 S DGPTERC=0 D AXV2^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",60,0)
SERVC ; Service connected indicator
"RTN","DGPT501",61,0)
 S DGPTERC=0 D SRVC^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",62,0)
GOOD ;
"RTN","DGPT501",63,0)
 W:'$D(ERROR) "."
"RTN","DGPT501",64,0)
EXIT ;
"RTN","DGPT501",65,0)
 K DGPTMD1,DGPTMD2,DGPTMD3,DGPTMD4,DGPTMD5,DGPTMDT,DGPTMDTS,DGPTMLC,DGPTMLD,DGPTMLR,DGPTMPD,DGPTMSC,DGPTMSI,DGPTMSR,DGPTMXX,DGPTSTR,DGPTS,DGPTSP1,DGPTSP2
"RTN","DGPT501",66,0)
 K DGPTMLG,DGPTMSU,DGPTMDG,DGPTMXIV,DGPTMXV1,DGPTMXV2,DGPT50SR,DGPTMBS
"RTN","DGPT501",67,0)
 Q
"RTN","DGPT501",68,0)
ERR ;
"RTN","DGPT501",69,0)
 D WRTERR^DGPTAE(DGPTERC,NODE,SEQ)
"RTN","DGPT501",70,0)
 S ERROR=1
"RTN","DGPT501",71,0)
 Q
"RTN","DGPT50MS")
0^5^B4605823^B4211944
"RTN","DGPT50MS",1,0)
DGPT50MS ;ALB/MTC - 501 Edits Cont ; 16 NOV 92
"RTN","DGPT50MS",2,0)
 ;;5.3;Registration;**142,729**;Aug 13, 1993;Build 59
"RTN","DGPT50MS",3,0)
 ;
"RTN","DGPT50MS",4,0)
 ; Edits for legionnaire's, suicide, drug and psych indicators
"RTN","DGPT50MS",5,0)
 ;
"RTN","DGPT50MS",6,0)
LEG ;
"RTN","DGPT50MS",7,0)
 ;I ((+DGPTMD1=482.8)!(+DGPTMD2=482.8)!(+DGPTMD3=482.8)!(+DGPTMD3=482.8)!(+DGPTMD4=482.8)!(+DGPTMD5=482.8))&("12"'[DGPTMLG) S DGPTERC=531 Q
"RTN","DGPT50MS",8,0)
 Q
"RTN","DGPT50MS",9,0)
SUI ;
"RTN","DGPT50MS",10,0)
 N I,DGINACT
"RTN","DGPT50MS",11,0)
 S DGPTMSX=0 F I=1:1:5 I ($E(@("DGPTMD"_I),1,3)="E95")&("012345678"[$E(@("DGPTMD"_I),4)) S DGPTMSX=1 Q:DGPTMSX
"RTN","DGPT50MS",12,0)
 Q:'DGPTMSX
"RTN","DGPT50MS",13,0)
 I '$D(DGSCDT) D DC
"RTN","DGPT50MS",14,0)
 S DGINACT=$$GET1^DIQ(45.88,"2,",.03,"I")
"RTN","DGPT50MS",15,0)
 I DGINACT]"",$D(DGSCDT) Q:DGSCDT>DGINACT
"RTN","DGPT50MS",16,0)
 I "123"'[DGPTMSU S DGPTERC=532 Q
"RTN","DGPT50MS",17,0)
 Q
"RTN","DGPT50MS",18,0)
DRUG ;
"RTN","DGPT50MS",19,0)
 N I,DGINACT
"RTN","DGPT50MS",20,0)
 S DGPTMSX=0 F I=1:1:5 I ($E(@("DGPTMD"_I),1,4)="304.")&("013456"[$E(@("DGPTMD"_I),5))&("0123"[$E(@("DGPTMD"_I),6)) S DGPTMSX=1 Q:DGPTMSX
"RTN","DGPT50MS",21,0)
 G:DGPTMSX DRG1
"RTN","DGPT50MS",22,0)
 S DGPTMSX=0 F I=1:1:5 I ($E(@("DGPTMD"_I),1,4)="305.")&("234579"[$E(@("DGPTMD"_I),5))&("0123"[$E(@("DGPTMD"_I),6)) S DGPTMSX=1 Q:DGPTMSX
"RTN","DGPT50MS",23,0)
DRG1 ;
"RTN","DGPT50MS",24,0)
 Q:'DGPTMSX
"RTN","DGPT50MS",25,0)
 I '$D(DGSCDT) D DC
"RTN","DGPT50MS",26,0)
 S DGINACT=$$GET1^DIQ(45.88,"4,",.03,"I")
"RTN","DGPT50MS",27,0)
 I DGINACT]"",$D(DGSCDT) Q:DGSCDT>DGINACT
"RTN","DGPT50MS",28,0)
 I DGPTMDG'?1A3N S DGPTERC=533 Q
"RTN","DGPT50MS",29,0)
 I $E(DGPTMDG,1)'="A" S DGPTERC=533 Q
"RTN","DGPT50MS",30,0)
 I ($E(DGPTMDG,2,4))<1!($E(DGPTMDG,2,4)>18) S DGPTERC=533 Q
"RTN","DGPT50MS",31,0)
 Q
"RTN","DGPT50MS",32,0)
AXIV ;
"RTN","DGPT50MS",33,0)
 N I
"RTN","DGPT50MS",34,0)
 S DGPTMSX=0 F I=1:1:5 I ($E(@("DGPTMD"_I),1,3)'<290)&($E(@("DGPTMD"_I),1,3)<320) S DGPTMSX=1 Q:DGPTMSX
"RTN","DGPT50MS",35,0)
 Q:'DGPTMSX
"RTN","DGPT50MS",36,0)
 I "0123456"'[DGPTMXIV S DGPTERC=534 Q
"RTN","DGPT50MS",37,0)
 Q
"RTN","DGPT50MS",38,0)
AXV1 ;
"RTN","DGPT50MS",39,0)
 Q:'DGPTMSX
"RTN","DGPT50MS",40,0)
 I (DGPTMXV1<1)!(DGPTMXV1>90) S DGPTERC=535 Q
"RTN","DGPT50MS",41,0)
 Q
"RTN","DGPT50MS",42,0)
AXV2 ;
"RTN","DGPT50MS",43,0)
 Q:'DGPTMSX
"RTN","DGPT50MS",44,0)
 Q:DGPTMXV2="  "
"RTN","DGPT50MS",45,0)
 I (DGPTMXV2<1)!(DGPTMXV2>90) S DGPTERC=535 Q
"RTN","DGPT50MS",46,0)
 Q
"RTN","DGPT50MS",47,0)
SRVC ;
"RTN","DGPT50MS",48,0)
 I " 12"'[DGPT50SR S DGPTERC=530
"RTN","DGPT50MS",49,0)
 Q
"RTN","DGPT50MS",50,0)
DC ;find discharge date
"RTN","DGPT50MS",51,0)
 S DGSCDT=$S('$D(^DGPT(PTF,70)):DT,^(70):+^(70),1:DT)
"RTN","DGPT50MS",52,0)
 Q
"RTN","DGPT535")
0^39^B8073530^B7382784
"RTN","DGPT535",1,0)
DGPT535 ;ALB/MTC - Process 535 transmission ; 16 NOV 92
"RTN","DGPT535",2,0)
 ;;5.3;Registration;**64,164,729**;Aug 13, 1993;Build 59
"RTN","DGPT535",3,0)
 ;
"RTN","DGPT535",4,0)
EN ;
"RTN","DGPT535",5,0)
 S DGPTSTR=^TMP("AEDIT",$J,NODE,SEQ),DGPTEDFL=0
"RTN","DGPT535",6,0)
 S DGPTTDT=$E(DGPTSTR,31,40),(X,DGPTTDTS)=$$FMDT^DGPT101($E(DGPTTDT,1,6))_"."_$E(DGPTTDT,7,10) S %DT="XT" D ^%DT I Y<0 S DGPTERC=505 D ERR G:DGPTEDFL EXIT G SET
"RTN","DGPT535",7,0)
 D DD^%DT S DGPTTDT=$E(Y,5,6)_"-"_$E(Y,1,3)_"-"_$E(Y,8,11)_" "_$S($P(Y,"@",2)]"":$E($P(Y,"@",2),1,5),1:"00:00")
"RTN","DGPT535",8,0)
SET ;
"RTN","DGPT535",9,0)
 S DGPTTLR=$E(DGPTSTR,41,46),DGPTTLC=$E(DGPTSTR,47,48),DGPTTSR=$E(DGPTSTR,49,54),DGPTTSC=$E(DGPTSTR,55,56),DGPTTLD=$E(DGPTSTR,57,59),DGPTTPD=$E(DGPTSTR,60,62),DGPTXX=$E(DGPTSTR,63,71)
"RTN","DGPT535",10,0)
DTE ;
"RTN","DGPT535",11,0)
 S DGPTTDDS=$$FMDT^DGPT101($E(DGPTSTR,31,36))_"."_$E(DGPTSTR,37,40)
"RTN","DGPT535",12,0)
 I (DGPTTDDS'>DGPTDTS)!(DGPTTDDS'<DGPTDDS) S DGPTERC=540 D ERR G:DGPTEDFL EXIT
"RTN","DGPT535",13,0)
TSPEC ;
"RTN","DGPT535",14,0)
 N DGPTTSC1
"RTN","DGPT535",15,0)
 I DGPTTSC'?2AN S DGPTERC=506 D ERR G:DGPTEDFL EXIT
"RTN","DGPT535",16,0)
 S DGPTSP1=$E(DGPTTSC,1),DGPTSP2=$E(DGPTTSC,2),DGPTERC=0
"RTN","DGPT535",17,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=506 D ERR G:DGPTEDFL EXIT G LSPEC
"RTN","DGPT535",18,0)
 ;-- Active treating specialty edit check
"RTN","DGPT535",19,0)
 I $E(DGPTTSC,1)=0!($E(DGPTTSC,1)=" ") S DGPTTSC=$E(DGPTTSC,2)
"RTN","DGPT535",20,0)
 ; DGPTTSC  := ptf code (alpha-numeric) value (file:42.4,field:7)
"RTN","DGPT535",21,0)
 ; DGPTTSC1 := dinum value (file:42.4,field:.001)
"RTN","DGPT535",22,0)
 S DGPTTSC1=+$O(^DIC(42.4,"C",DGPTTSC,0))
"RTN","DGPT535",23,0)
 ;-- If not active treat spec, set 535 flag to print error msg during
"RTN","DGPT535",24,0)
 ;-- PTF close-out error display at WRER^DGPTAEE
"RTN","DGPT535",25,0)
 I '$$ACTIVE^DGACT(42.4,DGPTTSC1,DGPTTDTS) S DGPTERC=506,DGPTSER(DGPTTDTS_535)=1 D ERR G:DGPTEDFL EXIT
"RTN","DGPT535",26,0)
LSPEC ;
"RTN","DGPT535",27,0)
 N DGPTTLC1
"RTN","DGPT535",28,0)
 I DGPTTLC'?2AN S DGPTERC=506 D ERR G:DGPTEDFL EXIT
"RTN","DGPT535",29,0)
 S DGPTSP1=$E(DGPTTLC,1),DGPTSP2=$E(DGPTTLC,2),DGPTERC=0
"RTN","DGPT535",30,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=506 D ERR G:DGPTEDFL EXIT G LVPAS
"RTN","DGPT535",31,0)
 ;-- Active treating specialty edit check
"RTN","DGPT535",32,0)
 I $E(DGPTTLC,1)=0!($E(DGPTTLC,1)=" ") S DGPTTLC=$E(DGPTTLC,2)
"RTN","DGPT535",33,0)
 ; DGPTTLC  := ptf code (alpha-nemeric) value (file:42.4,field:7)
"RTN","DGPT535",34,0)
 ; DGPTTLC1 := dinum value (file:42.4,field:.001)
"RTN","DGPT535",35,0)
 S DGPTTLC1=+$O(^DIC(42.4,"C",DGPTTLC,0))
"RTN","DGPT535",36,0)
 ;-- If not active treat spec, set 535 flag to print error msg during
"RTN","DGPT535",37,0)
 ;-- PTF close-out error display at WRER^DGPTAEE
"RTN","DGPT535",38,0)
 I '$$ACTIVE^DGACT(42.4,DGPTTLC1,DGPTTDTS) S DGPTERC=506,DGPTSER(DGPTTDTS_5351)=1 D ERR G:DGPTEDFL EXIT
"RTN","DGPT535",39,0)
LVPAS ;
"RTN","DGPT535",40,0)
 I DGPTTLD'?1.3N&(DGPTTLD'="   ") S DGPTERC=507 D ERR G:DGPTEDFL EXIT
"RTN","DGPT535",41,0)
 I DGPTTPD'?1.3N&(DGPTTPD'="   ") S DGPTERC=508 D ERR G:DGPTEDFL EXIT
"RTN","DGPT535",42,0)
 S DGPTERC=0 S X1=DGPTTDTS D 535^DGPTAE03 D:DGPTERC ERR G:DGPTEDFL EXIT
"RTN","DGPT535",43,0)
ALLGD ;
"RTN","DGPT535",44,0)
 W "."
"RTN","DGPT535",45,0)
 ;
"RTN","DGPT535",46,0)
EXIT ;
"RTN","DGPT535",47,0)
 K DGPTTDT,DGPTTLR,DGPTTLC,DGPTTSR,DGPTTSC,DGPTTLD,DGPTTPD,DGPTSTR
"RTN","DGPT535",48,0)
 K DGPTLO1,DGPTLO2,DGPTS1,DGPTS2,DGPTTDTS,DGPTTDDS,DGPTXX,X,X1,Y
"RTN","DGPT535",49,0)
 Q
"RTN","DGPT535",50,0)
ERR ;
"RTN","DGPT535",51,0)
 D WRTERR^DGPTAE(DGPTERC,NODE,SEQ)
"RTN","DGPT535",52,0)
 Q
"RTN","DGPT601")
0^32^B13957329^B11369464
"RTN","DGPT601",1,0)
DGPT601 ;ALB/MTC - Process 601 transmission ; 17 NOV 92
"RTN","DGPT601",2,0)
 ;;5.3;Registration;**64,164,729**;Aug 13, 1993;Build 59
"RTN","DGPT601",3,0)
 ;
"RTN","DGPT601",4,0)
 ;
"RTN","DGPT601",5,0)
EN ; Process 601 transmission
"RTN","DGPT601",6,0)
 N ERROR
"RTN","DGPT601",7,0)
 K DGPTPAR
"RTN","DGPT601",8,0)
 S DGPTSTR=^TMP("AEDIT",$J,NODE,SEQ),DGPTEDFL=0,DGPTERP=7
"RTN","DGPT601",9,0)
 S:$E(DGPTSTR,37,40)="2400" DGPTSTR=$E(DGPTSTR,1,36)_"2359"_$E(DGPTSTR,41,125)
"RTN","DGPT601",10,0)
SET ;
"RTN","DGPT601",11,0)
 S DGPTPSC=$E(DGPTSTR,41,42),DGPTPDY=$E(DGPTSTR,43),DGPTPNT=$E(DGPTSTR,44,46),DGPTPC1=$E(DGPTSTR,47,53),DGPTPC2=$E(DGPTSTR,54,60),DGPTPC3=$E(DGPTSTR,61,67),DGPTPC4=$E(DGPTSTR,68,74),DGPTPC5=$E(DGPTSTR,75,81)
"RTN","DGPT601",12,0)
 S DGPTPDT=$E(DGPTSTR,31,40)
"RTN","DGPT601",13,0)
DATE ;
"RTN","DGPT601",14,0)
 S (X,DGPTPDTS)=$$FMDT^DGPT101($E(DGPTPDT,1,6))_"."_$E(DGPTPDT,7,10),%DT="XT" D ^%DT I Y<0 S DGPTERC=601 D ERR G:DGPTEDFL EXIT G TSPEC
"RTN","DGPT601",15,0)
 D DD^%DT S DGPTPDT=$E(Y,5,6)_"-"_$E(Y,1,3)_"-"_$E(Y,9,12)_" "_$S($P(Y,"@",2)]"":$E($P(Y,"@",2),1,5),1:"00:00")
"RTN","DGPT601",16,0)
 I DGPTPDT'?1.2N1"-"3U1"-"4N1" "2N1":"2N S DGPTERC=601 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",17,0)
 S X1=DGPTDDS,X2=DGPTPDTS D ^%DTC I (X<0)!(%Y<0) S DGPTERC=640 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",18,0)
 S X1=DGPTPDTS,X2=DGPTDTS D ^%DTC I (X<0)!(%Y<0) S DGPTERC=637 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",19,0)
 ;
"RTN","DGPT601",20,0)
TSPEC ;
"RTN","DGPT601",21,0)
 N DGPTPSC1
"RTN","DGPT601",22,0)
 I DGPTPSC'?2AN S DGPTERC=602 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",23,0)
 S DGPTSP1=$E(DGPTPSC,1),DGPTSP2=$E(DGPTPSC,2),DGPTERC=0
"RTN","DGPT601",24,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=602 D ERR G:DGPTEDFL EXIT G DIAL
"RTN","DGPT601",25,0)
 ;-- Active treating specialty edit check
"RTN","DGPT601",26,0)
 I $E(DGPTPSC,1)=0!($E(DGPTPSC,1)=" ") S DGPTPSC=$E(DGPTPSC,2)
"RTN","DGPT601",27,0)
 ; DGPTPSC  := ptf code (alpha-numeric) value (file:42.4, field:7)
"RTN","DGPT601",28,0)
 ; DGPTPSC1 := dinum value (ien, file:42.4, field:.001)
"RTN","DGPT601",29,0)
 S DGPTPSC1=+$O(^DIC(42.4,"C",DGPTPSC,0))
"RTN","DGPT601",30,0)
 ;-- If not active treat spec, set 601 flag to print error msg during
"RTN","DGPT601",31,0)
 ;-- PTF close-out error display at WRER^DGPTAEE
"RTN","DGPT601",32,0)
 I '$$ACTIVE^DGACT(42.4,DGPTPSC1,DGPTPDTS) S DGPTERC=602,DGPTSER(DGPTPDTS_601)=1 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",33,0)
DIAL ;
"RTN","DGPT601",34,0)
 ;I DGPTPDY'=" " D DIALE I DGPTERC G EXIT
"RTN","DGPT601",35,0)
 I DGPTPNT="   "!(+DGPTPNT'>0) D  G:DGPTEDFL EXIT
"RTN","DGPT601",36,0)
 .I DGPTPC1="3995   "!(DGPTPC1="5498   ")!(DGPTPC1="5092   ") S DGPTERC=604 D ERR
"RTN","DGPT601",37,0)
 .I DGPTPC2="3995   "!(DGPTPC2="5498   ")!(DGPTPC2="5092   ") S DGPTERC=604 D ERR
"RTN","DGPT601",38,0)
 .I DGPTPC3="3995   "!(DGPTPC3="5498   ")!(DGPTPC3="5092   ") S DGPTERC=604 D ERR
"RTN","DGPT601",39,0)
 .I DGPTPC4="3995   "!(DGPTPC4="5498   ")!(DGPTPC4="5092   ") S DGPTERC=604 D ERR
"RTN","DGPT601",40,0)
 .I DGPTPC5="3995   "!(DGPTPC5="5498   ")!(DGPTPC5="5092   ") S DGPTERC=604 D ERR
"RTN","DGPT601",41,0)
OPS ;
"RTN","DGPT601",42,0)
 S DGPTERC=0 D ^DGPT60PR G:DGPTEDFL EXIT
"RTN","DGPT601",43,0)
 ;
"RTN","DGPT601",44,0)
OPDUP ;--check for duplicate procedure codes
"RTN","DGPT601",45,0)
 I ((DGPTPDY=" ")&(DGPTPNT="   "))&(+$E(DGPTSTR,47,81)=0) S DGPTERC="605Z" D ERR G EXIT
"RTN","DGPT601",46,0)
 F DGPTL4=1:1:5 I +@("DGPTPC"_DGPTL4)'=0 S DGPTPAR(+@("DGPTPC"_DGPTL4),DGPTL4)=""
"RTN","DGPT601",47,0)
 S DGPTPAR1=0 F DGPTL4=1:1:5 S DGPTPAR1=$O(DGPTPAR(DGPTPAR1)) Q:DGPTPAR1=""  S DGPTPRA2=$O(DGPTPAR(DGPTPAR1,0)) I DGPTPRA2'="" S DGPTPRA3=$O(DGPTPAR(DGPTPAR1,DGPTPRA2)) I DGPTPRA3'="" S DGPTERC=657 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",48,0)
 K DGPTPAR
"RTN","DGPT601",49,0)
GOOD ;
"RTN","DGPT601",50,0)
 W:'$D(ERROR) "."
"RTN","DGPT601",51,0)
 ;
"RTN","DGPT601",52,0)
EXIT ;
"RTN","DGPT601",53,0)
 K DGPTERC,DGPTL3,DGPTL4,DGPTOP,DGPTOP1,DGPTP1,DGPTP2,DGPTPAR1,DGPTPC1,DGPTPC2,DGPTPC3,DGPTPC4,DGPTPC5,DGPTPDT,DGPTPDTS,DGPTPDY,DGPTPFL,DGPTPNT,DGPTPP,DGPTPRA2,DGPTPRA3,DGPTPSC,DGPTSTR,X,X1,X2,Y
"RTN","DGPT601",54,0)
 K DGPTXX
"RTN","DGPT601",55,0)
 Q
"RTN","DGPT601",56,0)
ERR ;
"RTN","DGPT601",57,0)
 D WRTERR^DGPTAE(DGPTERC,NODE,SEQ)
"RTN","DGPT601",58,0)
 S ERROR=1
"RTN","DGPT601",59,0)
 Q
"RTN","DGPT601",60,0)
DIALE ;
"RTN","DGPT601",61,0)
 I "12345678"'[DGPTPDY S DGPTERC=603 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",62,0)
 I DGPTPNT="   "!(+DGPTPNT'>0) S DGPTERC=604 D ERR G:DGPTEDFL EXIT
"RTN","DGPT601",63,0)
 Q
"RTN","DGPT601",64,0)
 ;
"RTN","DGPT701")
0^40^B13839159^B13169396
"RTN","DGPT701",1,0)
DGPT701 ;ALB/MTC - Process 701 Transaction ;10/06/1999
"RTN","DGPT701",2,0)
 ;;5.3;Registration;**64,164,251,415,729**;Aug 13, 1993;Build 59
"RTN","DGPT701",3,0)
 ; 10/06/1999 ACS - Removed Place of Disposition codes M,Y,Z from the list of
"RTN","DGPT701",4,0)
 ; invalid codes.
"RTN","DGPT701",5,0)
 ;
"RTN","DGPT701",6,0)
EN ;
"RTN","DGPT701",7,0)
 Q
"RTN","DGPT701",8,0)
SET ;
"RTN","DGPT701",9,0)
 S DGPTSTR=$G(^TMP("AEDIT",$J,"N701",DGPTAL7))
"RTN","DGPT701",10,0)
 D PARSE^DGPT701P
"RTN","DGPT701",11,0)
DTE ;
"RTN","DGPT701",12,0)
 S (X,DGPTDDS)=$$FMDT^DGPT101($E(DGPTDDTD,1,6))_"."_$E(DGPTDDTD,7,10)
"RTN","DGPT701",13,0)
 S %DT="XT" D ^%DT I Y<0 S DGPTERC=705 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",14,0)
 I Y>0 D DD^%DT S DGPTDTD=$E(Y,5,6)_"-"_$E(Y,1,3)_"-"_$E(Y,9,12)_" "_$S($P(Y,"@",2)]"":$E($P(Y,"@",2),1,5),1:"00:00")
"RTN","DGPT701",15,0)
 S X1=DGPTNOW,X2=+DGPTDDS D ^%DTC I X<0 S DGPTERC=740 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",16,0)
 S X1=+DGPTDDS,X2=+DGPTDTS D ^%DTC S DGPTELP=X I X<0 S DGPTERC=737 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",17,0)
CHECK ;
"RTN","DGPT701",18,0)
TSPEC ; CHECK TREATING SPECIALTY CODE
"RTN","DGPT701",19,0)
 N DGPTDSP1
"RTN","DGPT701",20,0)
 I DGPTDSP'?2AN S DGPTERC=706 D ERR G:DGPTEDFL EXIT G DISPTY
"RTN","DGPT701",21,0)
 S DGPTSP1=$E(DGPTDSP,1),DGPTSP2=$E(DGPTDSP,2),DGPTERC=0
"RTN","DGPT701",22,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=706 D ERR G:DGPTEDFL EXIT G DISPTY
"RTN","DGPT701",23,0)
 ;-- Active treating specialty edit check
"RTN","DGPT701",24,0)
 I $E(DGPTDSP,1)=0!($E(DGPTDSP,1)=" ") S DGPTDSP=$E(DGPTDSP,2)
"RTN","DGPT701",25,0)
 ; DGPTDSP  := ptf code (alpha-numeric) value (file:42.4,field:7)
"RTN","DGPT701",26,0)
 ; DGPTDSP1 := dinum value (ien, file:42.4,field:.001)
"RTN","DGPT701",27,0)
 S DGPTDSP1=+$O(^DIC(42.4,"C",DGPTDSP,0))
"RTN","DGPT701",28,0)
 ;-- If not active treat spec, set flag to print error msg during
"RTN","DGPT701",29,0)
 ;-- PTF Close-out Error display at WRER^DGPTAEE
"RTN","DGPT701",30,0)
 I '$$ACTIVE^DGACT(42.4,DGPTDSP1,DGPTDDS) S DGPTERC=706,DGPTSER(DGPTDDS_701)=1 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",31,0)
 ;
"RTN","DGPT701",32,0)
DISPTY ;
"RTN","DGPT701",33,0)
 I (DGPTDTY<1)!(DGPTDTY>7) S DGPTERC=707 D ERR G:DGPTEDFL EXIT G OPCAR
"RTN","DGPT701",34,0)
 S DGPTERC=0 D DISPTY^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",35,0)
OPCAR ;
"RTN","DGPT701",36,0)
 I "13 "'[DGPTDOP S DGPTERC=708 D ERR G:DGPTEDFL EXIT G VA
"RTN","DGPT701",37,0)
 I DGPTDOP'=" " S DGPTERC=0 D OP^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",38,0)
VA ;
"RTN","DGPT701",39,0)
 I "12 "'[DGPTDVA S DGPTERC=709 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",40,0)
 ;
"RTN","DGPT701",41,0)
VAOP ;-- check for inconsistencies between opcare and va aspices
"RTN","DGPT701",42,0)
 I DGPTDVA=2,DGPTDOP=1 D  G:DGPTEDFL EXIT
"RTN","DGPT701",43,0)
 . S DGPTERC=708 D ERR
"RTN","DGPT701",44,0)
 . S DGPTERC=709 D ERR
"RTN","DGPT701",45,0)
CDR ;
"RTN","DGPT701",46,0)
 I DGPTDLR'?6" "&(DGPTDLR'?." "6N) S DGPTERC=775 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",47,0)
POD ;
"RTN","DGPT701",48,0)
 ;I "68EIMNOQSVWYZ"[DGPTDPD S DGPTERC=710 D ERR G:DGPTEDFL EXIT G RECF
"RTN","DGPT701",49,0)
 I "68EINOQSVW"[DGPTDPD S DGPTERC=710 D ERR G:DGPTEDFL EXIT G RECF
"RTN","DGPT701",50,0)
 S DGPTERC=0 D POD^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",51,0)
RECF ;
"RTN","DGPT701",52,0)
 I DGPTDVA'=1!(DGPTDRF="      ") G ASIH
"RTN","DGPT701",53,0)
 I DGPTDRF[" " S DGPTDRF=$P(DGPTDRF," ",1)
"RTN","DGPT701",54,0)
 I DGPTDRF="" S DGPTERC=711 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",55,0)
ASIH ;
"RTN","DGPT701",56,0)
 I DGPTDAS'="   ",DGPTDAS'?2E1N S DGPTERC=712 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",57,0)
 ;
"RTN","DGPT701",58,0)
LEAVE ;
"RTN","DGPT701",59,0)
 S DGPTERC=0 D LEAVE^DGPTAE02 D:DGPTERC ERR G:DGPTEDFL EXIT
"RTN","DGPT701",60,0)
SC ;
"RTN","DGPT701",61,0)
 I DGPTDSC'="   "&(DGPTDSC'?3N) S DGPTERC=730 D ERR G:DGPTEDFL EXIT G CP
"RTN","DGPT701",62,0)
 S DGPTDSC=+DGPTDSC
"RTN","DGPT701",63,0)
CP ;
"RTN","DGPT701",64,0)
 S DGPTERC=0 D CANDP^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",65,0)
DIAG ;
"RTN","DGPT701",66,0)
 S DGPTERC=0 D ^DGPT70DX I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",67,0)
OVER ; Pass FY92 edits for earlier data
"RTN","DGPT701",68,0)
 I DGPTDDS'>2911001 G ONED
"RTN","DGPT701",69,0)
LEG ; LEGIONNAIRE'S DISEASE
"RTN","DGPT701",70,0)
 S DGPTERC=0 D LEG^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",71,0)
SUI ; Suicide indicator
"RTN","DGPT701",72,0)
 S DGPTERC=0 D SUI^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",73,0)
DRUG ;
"RTN","DGPT701",74,0)
 S DGPTERC=0 D DRUG^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",75,0)
AXES ; Psych axises
"RTN","DGPT701",76,0)
 I '$P($G(^DIC(42.4,+DGPTDSP1,0)),U,4) S (DGPT70X4,DGPT7X51,DGPT7X52)=" " G ONED
"RTN","DGPT701",77,0)
 S DGPTERC=0 D AXIV^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",78,0)
 S DGPTERC=0 D AXV1^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",79,0)
 S DGPTERC=0 D AXV2^DGPTAE02 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",80,0)
ONED ;
"RTN","DGPT701",81,0)
 I (DGPTDDXO=" ")&('$D(^TMP("AEDIT",$J,"N702"))&'$D(^TMP("AEDIT",$J,"N703"))) S DGPTERC=718 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",82,0)
 I (DGPTDDXO="X")&($D(^TMP("AEDIT",$J,"N072"))) S DGPTERC=719 D ERR G:DGPTEDFL EXIT
"RTN","DGPT701",83,0)
EXIT ;
"RTN","DGPT701",84,0)
 Q
"RTN","DGPT701",85,0)
ERR ;
"RTN","DGPT701",86,0)
 D WRTERR^DGPTAE(DGPTERC,"N701",DGPTAL7)
"RTN","DGPT701",87,0)
 S ERROR=1
"RTN","DGPT701",88,0)
 Q
"RTN","DGPTAE02")
0^2^B19628803^B19447484
"RTN","DGPTAE02",1,0)
DGPTAE02        ;ALB/MTC - 701 Edit Checks ;11/01/2005
"RTN","DGPTAE02",2,0)
 ;;5.3;Registration;**8,22,39,114,176,251,247,270,446,418,482,466,683,729**;Aug 13, 1993;Build 59
"RTN","DGPTAE02",3,0)
 ;10/06/1999 ACS - Added Place of Disposition codes M,Y,Z to the
"RTN","DGPTAE02",4,0)
 ;validity checks
"RTN","DGPTAE02",5,0)
 ;5/15/2000 ACS - Added Treating Specialty 37 as a valid code
"RTN","DGPTAE02",6,0)
 ;5/16/2000 MM  - Added Treating Specialties 38 & 39 as valid codes
"RTN","DGPTAE02",7,0)
 ;5/26/2000 JRP - Place of Disposition code M valid for station
"RTN","DGPTAE02",8,0)
 ;                types 10, 11, 30, and 40
"RTN","DGPTAE02",9,0)
 ;09/27/2006 JRC - Added Treating Specialties 13, 30, 48, 49, 78,
"RTN","DGPTAE02",10,0)
 ;                 82 and 97
"RTN","DGPTAE02",11,0)
 ;
"RTN","DGPTAE02",12,0)
CHECK ;
"RTN","DGPTAE02",13,0)
 I (DGPTSP1'?1AN)!(DGPTSP2'?1AN) S DGPTERC=1 Q
"RTN","DGPTAE02",14,0)
 I DGPTSP1="0"&((DGPTSP2'?1AN)!(DGPTSP2="0")) S DGPTERC=1 G EXIT
"RTN","DGPTAE02",15,0)
 ; No zero or double zeroes allowed
"RTN","DGPTAE02",16,0)
 I DGPTSP1=5 G EXIT
"RTN","DGPTAE02",17,0)
 ; All codes 50-59 allowable
"RTN","DGPTAE02",18,0)
 ; New code 95:p-418
"RTN","DGPTAE02",19,0)
 ; New code 96;p-446
"RTN","DGPTAE02",20,0)
EXIT ;
"RTN","DGPTAE02",21,0)
 K DGPTSP1,DGPTSP2
"RTN","DGPTAE02",22,0)
 Q
"RTN","DGPTAE02",23,0)
 ;
"RTN","DGPTAE02",24,0)
DISPTY ;
"RTN","DGPTAE02",25,0)
 N I
"RTN","DGPTAE02",26,0)
 S DGPTERC=0
"RTN","DGPTAE02",27,0)
 Q:"1"[DGPTDTY
"RTN","DGPTAE02",28,0)
 I DGPTDTY=2 S DGPTERC=707 F I=10,11,30,40,42 I DGPTSTTY["^"_I_"^" S DGPTERC=0 Q
"RTN","DGPTAE02",29,0)
 I DGPTERC Q
"RTN","DGPTAE02",30,0)
 ;
"RTN","DGPTAE02",31,0)
 ;-- if dis type = To Non-Bed Care then VA aus and Out pat = no
"RTN","DGPTAE02",32,0)
 ;I DGPTDTY=2,((DGPTDVA'=2)!(DGPTDOP'=3)) S DGPTERC=707 Q
"RTN","DGPTAE02",33,0)
 ;
"RTN","DGPTAE02",34,0)
 I DGPTDTY=3&(DGPTSTTY'["^42^") S DGPTERC=707 Q
"RTN","DGPTAE02",35,0)
 ;-- if dis type = Transfer then Out pat cannot be yes
"RTN","DGPTAE02",36,0)
 I DGPTDTY=5,DGPTDOP=1 S DGPTERC=707
"RTN","DGPTAE02",37,0)
 ;-- if dis type = Transfer then Out pat cannot be yes, rec sta'=""
"RTN","DGPTAE02",38,0)
 I DGPTDTY=5,DGPTDOP'=1,'DGPTDRF S DGPTERC=711 Q
"RTN","DGPTAE02",39,0)
 ;-- if dis type irr, death w/aotopsy then va asp, op care, pod = ""
"RTN","DGPTAE02",40,0)
 I "467"[DGPTDTY,(DGPTDOP!DGPTDVA!DGPTDPD) S DGPTERC=707 Q
"RTN","DGPTAE02",41,0)
 Q
"RTN","DGPTAE02",42,0)
OP ;
"RTN","DGPTAE02",43,0)
 Q:"13"'[DGPTDOP
"RTN","DGPTAE02",44,0)
 S DGPTERC=708 F I=10,11,40,42 I DGPTSTTY["^"_I_"^" S DGPTERC=0 Q
"RTN","DGPTAE02",45,0)
 Q
"RTN","DGPTAE02",46,0)
POD ;
"RTN","DGPTAE02",47,0)
 N I
"RTN","DGPTAE02",48,0)
 Q:"X012347BCDFGHJKL "[DGPTDPD
"RTN","DGPTAE02",49,0)
 ; if POD NHCU then Out=no VA aus=yes
"RTN","DGPTAE02",50,0)
 I DGPTDPD=5,((DGPTDOP'=3)!(DGPTDVA'=1)) S DGPTERC=710 Q
"RTN","DGPTAE02",51,0)
 ; if POD NHCU then Out=no VA aus=yes, rec station'=""
"RTN","DGPTAE02",52,0)
 I DGPTDPD=5,DGPTDOP=3,DGPTDVA=1,'DGPTDRF S DGPTERC=711 Q
"RTN","DGPTAE02",53,0)
 I "PR"[DGPTDPD,((DGPTSTTY'["^10^")!(DGPTSTTY'["^11^")) S DGPTERC=710 Q
"RTN","DGPTAE02",54,0)
 I DGPTDPD="M" S DGPTERC=710 F I=10,11,30,40 I DGPTSTTY["^"_I_"^" S DGPTERC=0 Q
"RTN","DGPTAE02",55,0)
 I DGPTDPD="T" S DGPTERC=710 F I=10,11,40 I DGPTSTTY["^"_I_"^" S DGPTERC=0 Q
"RTN","DGPTAE02",56,0)
 I "UYZ"[DGPTDPD S DGPTERC=710 F I=10,11,20:1:27,30,40:1:42 I DGPTSTTY["^"_I_"^" S DGPTERC=0 Q
"RTN","DGPTAE02",57,0)
 Q
"RTN","DGPTAE02",58,0)
LEAVE ;
"RTN","DGPTAE02",59,0)
 S DGPTLVDY=0
"RTN","DGPTAE02",60,0)
 S DGPTL3=0 F  S DGPTL3=$O(^TMP("AEDIT",$J,"N501",DGPTL3)) Q:DGPTL3=""  S DGPTLVDY=DGPTLVDY+$E(^TMP("AEDIT",$J,"N501",DGPTL3),49,51)+$E(^TMP("AEDIT",$J,"N501",DGPTL3),52,54)
"RTN","DGPTAE02",61,0)
 I (DGPTLVDY+DGPTDAS)>DGPTELP S DGPTERC=745
"RTN","DGPTAE02",62,0)
 K DGPTL3,DGPTLVDY
"RTN","DGPTAE02",63,0)
 Q
"RTN","DGPTAE02",64,0)
 ;
"RTN","DGPTAE02",65,0)
CANDP ;
"RTN","DGPTAE02",66,0)
 I "12345678"'[DGPTDCP S DGPTERC=714 Q
"RTN","DGPTAE02",67,0)
 ;-- if no POS then no edit
"RTN","DGPTAE02",68,0)
 Q:DGPTPOS2=9
"RTN","DGPTAE02",69,0)
 ;-- if WWI then no edit
"RTN","DGPTAE02",70,0)
 Q:DGPTPOS2=1
"RTN","DGPTAE02",71,0)
 ;-- if POW then no edit
"RTN","DGPTAE02",72,0)
 I $L(DGPTPOW)=1,("23456789AB"[DGPTPOW) Q
"RTN","DGPTAE02",73,0)
 D CONSIS Q:DGPTERC
"RTN","DGPTAE02",74,0)
 D STATYP Q:DGPTERC
"RTN","DGPTAE02",75,0)
 D CPMT Q:DGPTERC
"RTN","DGPTAE02",76,0)
 Q
"RTN","DGPTAE02",77,0)
CONSIS ;
"RTN","DGPTAE02",78,0)
 I ("01234578X"[DGPTPOS2)&("1234567"'[DGPTDCP) S DGPTERC=736 Q
"RTN","DGPTAE02",79,0)
 I ("ABCD"[DGPTPOS2) Q
"RTN","DGPTAE02",80,0)
 I DGPTPOS2="Z"&("1234567"'[DGPTDCP) S DGPTERC=736 Q
"RTN","DGPTAE02",81,0)
 Q:"012345678ABCDXZ"[DGPTPOS2
"RTN","DGPTAE02",82,0)
 S:DGPTDCP'=8 DGPTERC=736
"RTN","DGPTAE02",83,0)
 Q
"RTN","DGPTAE02",84,0)
STATYP ;
"RTN","DGPTAE02",85,0)
 Q:(DGPTSTTY["^30^")!(DGPTSTTY="^")!(DGPTSTTY="")
"RTN","DGPTAE02",86,0)
 ;Note: There is not sufficient information contained in the
"RTN","DGPTAE02",87,0)
 ;station type to adequately perform the error check of Means Test
"RTN","DGPTAE02",88,0)
 ;indicator vs admissions date.  This issue should be revisited in 5.4.
"RTN","DGPTAE02",89,0)
 ;For now, error code 143 (previously set as 744) will not be checked
"RTN","DGPTAE02",90,0)
 ;in order to be sure that an error is not erroneously generated.
"RTN","DGPTAE02",91,0)
 Q
"RTN","DGPTAE02",92,0)
MT ;
"RTN","DGPTAE02",93,0)
 I DGPTMTC="X "&((+DGPTDTS)'<2860701) S DGPTERC=143 Q
"RTN","DGPTAE02",94,0)
 Q:DGPTMTC="X "
"RTN","DGPTAE02",95,0)
 I DGPTDTS<2860701 S DGPTERC=143 Q
"RTN","DGPTAE02",96,0)
 Q
"RTN","DGPTAE02",97,0)
 ;
"RTN","DGPTAE02",98,0)
CPMT ;-- mt and c&p checks
"RTN","DGPTAE02",99,0)
 I DGPTMTC="N ",DGPTDCP'=8 S DGPTERC=753 Q
"RTN","DGPTAE02",100,0)
 I DGPTMTC="AN","24567"'[DGPTDCP S DGPTERC=753 Q
"RTN","DGPTAE02",101,0)
 I ((DGPTMTC="B ")!(DGPTMTC="C ")!(DGPTMTC="G ")),"2467"'[DGPTDCP S DGPTERC=753 Q
"RTN","DGPTAE02",102,0)
 I DGPTMTC="AS","1234567"'[DGPTDCP S DGPTERC=753 Q
"RTN","DGPTAE02",103,0)
 Q
"RTN","DGPTAE02",104,0)
LEG ;
"RTN","DGPTAE02",105,0)
 ;I DGPTDDXE=482.8&("12"'[DGPT70LG) S DGPTERC=731 Q
"RTN","DGPTAE02",106,0)
 Q
"RTN","DGPTAE02",107,0)
SUI ;
"RTN","DGPTAE02",108,0)
 N DGINACT
"RTN","DGPTAE02",109,0)
 I ($E(DGPTDDXE,1,3)="E95")&("12345678"[$E(DGPTDDXE,4))&("12"'[DGPT70SU) D
"RTN","DGPTAE02",110,0)
 . I '$D(DGSCDT) D DC
"RTN","DGPTAE02",111,0)
 . S DGINACT=$$GET1^DIQ(45.88,"2,",.03,"I")
"RTN","DGPTAE02",112,0)
 . I DGINACT]"",$D(DGSCDT) Q:DGSCDT>DGINACT
"RTN","DGPTAE02",113,0)
 . S DGPTERC=732 Q
"RTN","DGPTAE02",114,0)
 Q
"RTN","DGPTAE02",115,0)
DRUG ;
"RTN","DGPTAE02",116,0)
 S DGPTMSX=0
"RTN","DGPTAE02",117,0)
 I ($E(DGPTDDXE,1,4)="304.")&("013456"[$E(DGPTDDXE,5))&("0123"[$E(DGPTDDXE,6)) S DGPTMSX=1
"RTN","DGPTAE02",118,0)
 I ($E(DGPTDDXE,1,4)="305.")&("234579"[$E(DGPTDDXE,5))&("0123"[$E(DGPTDDXE,6)) S DGPTMSX=1
"RTN","DGPTAE02",119,0)
 Q:'DGPTMSX
"RTN","DGPTAE02",120,0)
 N DGINACT
"RTN","DGPTAE02",121,0)
 I $E(DGPT70DR,1)'="A"!($E(DGPT70DR,2,4)<1)!(+$E(DGPT70DR>16)) D
"RTN","DGPTAE02",122,0)
 . I '$D(DGSCDT) D DC
"RTN","DGPTAE02",123,0)
 . S DGINACT=$$GET1^DIQ(45.88,"4,",.03,"I")
"RTN","DGPTAE02",124,0)
 . I DGINACT]"",$D(DGSCDT) Q:DGSCDT>DGINACT
"RTN","DGPTAE02",125,0)
 . S DGPTERC=733
"RTN","DGPTAE02",126,0)
 S DGPTMSX=0 Q
"RTN","DGPTAE02",127,0)
AXIV ;
"RTN","DGPTAE02",128,0)
 I $E(DGPTDDXE,1,3)>295,$E(DGPTDDXE,1,3)<320,"0123456"'[DGPT70X4 S DGPTERC=734
"RTN","DGPTAE02",129,0)
 Q
"RTN","DGPTAE02",130,0)
AXV1 ;
"RTN","DGPTAE02",131,0)
 I (DGPTDXV1<0)!(DGPTDXV1>90) S DGPTERC=735 Q
"RTN","DGPTAE02",132,0)
 Q
"RTN","DGPTAE02",133,0)
AXV2 ;
"RTN","DGPTAE02",134,0)
 Q:DGPTDXV2="  "
"RTN","DGPTAE02",135,0)
 I (DGPTDXV2<0)!(DGPTDXV2>90) S DGPTERC=735 Q
"RTN","DGPTAE02",136,0)
 Q
"RTN","DGPTAE02",137,0)
DC ;find discharge date
"RTN","DGPTAE02",138,0)
 S DGSCDT=$S('$D(^DGPT(PTF,70)):DT,^(70):+^(70),1:DT)
"RTN","DGPTAE02",139,0)
 Q
"RTN","DGPTAEE1")
0^20^B21428612^B21418190
"RTN","DGPTAEE1",1,0)
DGPTAEE1 ;ALB/MTC - Austin Edits EAL Listing Continued ; 11/28/06 3:14pm
"RTN","DGPTAEE1",2,0)
 ;;5.3;Registration;**338,565,678,729**;Aug 13, 1993;Build 59
"RTN","DGPTAEE1",3,0)
 ;
"RTN","DGPTAEE1",4,0)
H101(REC) ;-- 101 header
"RTN","DGPTAEE1",5,0)
 ; INPUT : REC - Node that contains the error
"RTN","DGPTAEE1",6,0)
 N I,X,X1,X2
"RTN","DGPTAEE1",7,0)
 S X="ADM    SSN       ADM-DATE-TIME LAST-NAME     INIT SOU FROM  SOP POW MS SX"
"RTN","DGPTAEE1",8,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",9,0)
 S X=$E(REC,1,4)_"  "_$E(REC,5,14)_SP_$E(REC,15,16)_SP_$E(REC,17,18)_SP_$E(REC,19,20)_SP_$E(REC,21,24)_SP_$E(REC,31,42)_"   "_$E(REC,43,44)_"   "_$E(REC,45,46)_SP_$E(REC,47,52)_SP_$E(REC,53)_"   "_$E(REC,54)_"   "_$E(REC,55)_"  "_$E(REC,56)
"RTN","DGPTAEE1",10,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",11,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")<12 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE1",12,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",13,0)
 S X="BIRTHDATE    POS AGO ION ST-CNTY  ZIP   MT INCOME MST CV CV-END      ERI"
"RTN","DGPTAEE1",14,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",15,0)
 S X=$E(REC,57,58)_SP_$E(REC,59,60)_SP_$E(REC,61,64)_"   "_$E(REC,65,66)_"    "_$E(REC,67)_"   "_$E(REC,68)_"  "_$E(REC,69,73)_"  "_$E(REC,74,78)_"  "_$E(REC,79,80)_SP_$E(REC,81,86)_"  "_$E(REC,87)_"   "_$E(REC,88)_" "_$E(REC,89,94)
"RTN","DGPTAEE1",16,0)
 S X=X_"    "_$E(REC,95)_"  "_$E(REC,96)
"RTN","DGPTAEE1",17,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",18,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")>11 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE1",19,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",20,0)
 D WRER^DGPTAEE
"RTN","DGPTAEE1",21,0)
 Q
"RTN","DGPTAEE1",22,0)
 ;
"RTN","DGPTAEE1",23,0)
H401(REC) ;-- 401 header
"RTN","DGPTAEE1",24,0)
 ; INPUT : REC - Node that contains the error
"RTN","DGPTAEE1",25,0)
 N X,X1,X2
"RTN","DGPTAEE1",26,0)
 S X="SURG   SSN       ADM-DATE-TIME SURG-DATE-TIME  SPEC CATEG TECH SOP"
"RTN","DGPTAEE1",27,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",28,0)
 S X=$E(REC,1,4)_"  "_$E(REC,5,14)_SP_$E(REC,15,16)_SP_$E(REC,17,18)_SP_$E(REC,19,20)_SP_$E(REC,21,24)_"  "_$E(REC,31,32)_SP_$E(REC,33,34)_SP_$E(REC,35,36)_SP_$E(REC,37,40)_"   "
"RTN","DGPTAEE1",29,0)
 S X=X_$E(REC,41,42)_"  "_$E(REC,43)_"   "_$E(REC,44)_"   "_$E(REC,45)_"   "_$E(REC,46)
"RTN","DGPTAEE1",30,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",31,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")<9 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE1",32,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",33,0)
 S X="------------SURGICAL CODES-------------  PHY SSN   TRNSPLNT"
"RTN","DGPTAEE1",34,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",35,0)
 S X=$E(REC,47,53)_SP_$E(REC,54,60)_SP_$E(REC,61,67)_SP_$E(REC,68,74)_SP_$E(REC,75,81)_"  "_$E(REC,82,90)_"     "_$E(REC,91)
"RTN","DGPTAEE1",36,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",37,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")>8 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE1",38,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",39,0)
 D WRER^DGPTAEE
"RTN","DGPTAEE1",40,0)
 Q
"RTN","DGPTAEE1",41,0)
 ;
"RTN","DGPTAEE1",42,0)
H501(REC) ;-- 501 header
"RTN","DGPTAEE1",43,0)
 ; INPUT : REC - Node that contains the error
"RTN","DGPTAEE1",44,0)
 N X,X1,X2
"RTN","DGPTAEE1",45,0)
 S X="DIAG   SSN       ADM-DATE-TIME MOVE DATE-TIME MPCR CODE SPC LVE PASS SCI"
"RTN","DGPTAEE1",46,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",47,0)
 S X=$E(REC,1,4)_"  "_$E(REC,5,14)_SP_$E(REC,15,16)_SP_$E(REC,17,18)_SP_$E(REC,19,20)_SP_$E(REC,21,24)_SP_$E(REC,31,32)_SP_$E(REC,33,34)_SP_$E(REC,35,36)_SP_$E(REC,37,40)_SP
"RTN","DGPTAEE1",48,0)
 S X=X_"  "_$E(REC,41,46)_"  "_$E(REC,47,48)_"  "_$E(REC,49,51)_"  "_$E(REC,52,54)_"  "_$E(REC,55)
"RTN","DGPTAEE1",49,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",50,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")<10 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE1",51,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",52,0)
 S X="-----------DIAGNOSTIC CODES------------"
"RTN","DGPTAEE1",53,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",54,0)
 S X=$E(REC,56,62)_SP_$E(REC,63,69)_SP_$E(REC,70,76)_SP_$E(REC,77,83)_SP_$E(REC,84,90)
"RTN","DGPTAEE1",55,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",56,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")=10 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE1",57,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",58,0)
 S X="SSN ATTY PHY PHY LOC  CDE BSI LI SI DRUG A4 A5   SC AO IR EC"
"RTN","DGPTAEE1",59,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",60,0)
 S X=$E(REC,91,99)_"    "_$E(REC,100,105)_"    "_$E(REC,106,107)_"  "_$E(REC,108)_"   "_$E(REC,109)_"  "_$E(REC,110)_SP_$E(REC,111,114)_"  "_$E(REC,115)_SP_$E(REC,116,119)_"  "_$E(REC,120)_"  "_$E(REC,121)_"  "_$E(REC,122)_"  "_$E(REC,123)
"RTN","DGPTAEE1",61,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",62,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")>10 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE1",63,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE1",64,0)
 D WRER^DGPTAEE
"RTN","DGPTAEE1",65,0)
 Q
"RTN","DGPTAEE1",66,0)
 ;
"RTN","DGPTAEE2")
0^15^B14108069^B14101889
"RTN","DGPTAEE2",1,0)
DGPTAEE2 ;ALB/MTC - Austin Edits EAL Report Continued ; 11/28/06 3:19pm
"RTN","DGPTAEE2",2,0)
 ;;5.3;Registration;**8,338,415,565,729**;Aug 13, 1993;Build 59
"RTN","DGPTAEE2",3,0)
 ;
"RTN","DGPTAEE2",4,0)
H601(REC) ;-- 601 error processing
"RTN","DGPTAEE2",5,0)
 ; INPUT : REC - Record that contains the errors
"RTN","DGPTAEE2",6,0)
 N X,X1
"RTN","DGPTAEE2",7,0)
 S X="PROC     SSN     ADM-DATE-TIME PROC-DATE-TIME SPC  TYPE TRT"
"RTN","DGPTAEE2",8,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",9,0)
 S X=$E(REC,1,4)_"  "_$E(REC,5,14)_SP_$E(REC,15,16)_SP_$E(REC,17,18)_SP_$E(REC,19,20)_SP_$E(REC,21,24)_SP_$E(REC,31,32)_SP_$E(REC,33,34)_SP_$E(REC,35,36)_SP_$E(REC,37,40)_"  "
"RTN","DGPTAEE2",10,0)
 S X=X_$E(REC,41,42)_"     "_$E(REC,43)_"  "_$E(REC,44,46)
"RTN","DGPTAEE2",11,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",12,0)
 S X="-----------PROCEDURE CODES-------------"
"RTN","DGPTAEE2",13,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",14,0)
 S X=$E(REC,47,53)_SP_$E(REC,54,60)_SP_$E(REC,61,67)_SP_$E(REC,68,74)_SP_$E(REC,75,81)
"RTN","DGPTAEE2",15,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",16,0)
 D WRER^DGPTAEE
"RTN","DGPTAEE2",17,0)
 Q
"RTN","DGPTAEE2",18,0)
 ;
"RTN","DGPTAEE2",19,0)
H701(REC) ;-- 701 header
"RTN","DGPTAEE2",20,0)
 ; INPUT : REC - Record that contains the errors
"RTN","DGPTAEE2",21,0)
 N X,X1,X2
"RTN","DGPTAEE2",22,0)
 S X="DISP   SSN       ADM-DATE-TIME DIS-DATE-TIME SPC  TYPE OP/RX VA/AUS PLACE RECVNG"
"RTN","DGPTAEE2",23,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",24,0)
 S X=$E(REC,1,4)_"  "_$E(REC,5,14)_SP_$E(REC,15,16)_SP_$E(REC,17,18)_SP_$E(REC,19,20)_SP_$E(REC,21,24)_SP_$E(REC,31,32)_SP_$E(REC,33,34)_SP_$E(REC,35,36)_SP_$E(REC,37,40)_SP
"RTN","DGPTAEE2",25,0)
 S X=X_$E(REC,41,42)_"    "_$E(REC,43)_"     "_$E(REC,44)_"     "_$E(REC,45)_"      "_$E(REC,46)_"   "_$E(REC,47,52)
"RTN","DGPTAEE2",26,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",27,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")<11 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE2",28,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",29,0)
 S X="ASIH XXXX C/P  PDXLS  ODX MPCR CODE   PHY LOC  %SC LI SI DRUG A4 A5"
"RTN","DGPTAEE2",30,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",31,0)
 S X=$E(REC,53,55)_"    "_$E(REC,56)_"   "_$E(REC,57)_"   "_$E(REC,58,64)_"  "_$E(REC,65)_"  "_$E(REC,66,71)_"       "_$E(REC,72,73)_"     "_$E(REC,74,76)_"  "_$E(REC,77)_"  "_$E(REC,78)_SP_$E(REC,79,82)_"  "_$E(REC,83)_SP_$E(REC,84,87)
"RTN","DGPTAEE2",32,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",33,0)
 S X="",$P(X," ",80)=" " F X1=1:1 S I=$P(DGER,",",X1) Q:I=""  I $P(I,":")>10 S X2=+$P(I,":",2),X=$E(X,1,X2-1)_"#"_$E(X,X2+1,80)
"RTN","DGPTAEE2",34,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",35,0)
 S X="SC AO IR EC MST HNC ETH RACE         CV"
"RTN","DGPTAEE2",36,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",37,0)
 S X=$E(REC,88)_"  "_$E(REC,89)_"  "_$E(REC,90)_"  "_$E(REC,91)_"   "_$E(REC,92)_"   "_$E(REC,93)_"  "_$E(REC,94,95)_"  "_$E(REC,96,107)_"  "_$E(REC,108)
"RTN","DGPTAEE2",38,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",39,0)
 D WRER^DGPTAEE
"RTN","DGPTAEE2",40,0)
 Q
"RTN","DGPTAEE2",41,0)
 ;
"RTN","DGPTAEE2",42,0)
H702(REC) ;-- 702 header
"RTN","DGPTAEE2",43,0)
 ; INPUT : REC - Record that contains the errors
"RTN","DGPTAEE2",44,0)
 N X,X1
"RTN","DGPTAEE2",45,0)
 S X="ADM    SSN       ADM-DATE-TIME DIS-DATE-TIME"
"RTN","DGPTAEE2",46,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",47,0)
 S X=$E(REC,1,4)_"  "_$E(REC,5,14)_SP_$E(REC,15,16)_SP_$E(REC,17,18)_SP_$E(REC,19,20)_SP_$E(REC,21,24)_SP_$E(REC,31,32)_SP_$E(REC,33,34)_SP_$E(REC,35,36)_SP_$E(REC,37,40)
"RTN","DGPTAEE2",48,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",49,0)
 S X="----------------------------DIAGNOSTIC CODES----------------------------"
"RTN","DGPTAEE2",50,0)
 S X=$E(REC,41,47)_SP_$E(REC,48,54)_SP_$E(REC,55,61)_SP_$E(REC,62,68)_SP_$E(REC,69,75)_SP_$E(REC,76,82)_SP_$E(REC,83,89)_SP_$E(REC,90,96)_SP_$E(REC,97,103)
"RTN","DGPTAEE2",51,0)
 S VALMCNT=VALMCNT+1,^TMP("AD",$J,VALMCNT,0)=X
"RTN","DGPTAEE2",52,0)
 D WRER^DGPTAEE
"RTN","DGPTAEE2",53,0)
 Q
"RTN","DGPTAEE2",54,0)
 ;
"RTN","DGPTCO1")
0^44^B26233066^B25546385
"RTN","DGPTCO1",1,0)
DGPTCO1 ;ALB/MJK - Census Status Report ; 5/2/05 2:41pm
"RTN","DGPTCO1",2,0)
 ;;5.3;Registration;**136,383,432,696,729**;Aug 13, 1993;Build 59
"RTN","DGPTCO1",3,0)
 ;
"RTN","DGPTCO1",4,0)
EN D CHKCUR W ! D DATE
"RTN","DGPTCO1",5,0)
 S DIC("A")="Generate PTF Census Status Report for Census date: ",DIC="^DG(45.86,",DIC(0)="AEMQ" S:Y]"" DIC("B")=Y
"RTN","DGPTCO1",6,0)
 D ^DIC K DIC G ENQ:Y<0
"RTN","DGPTCO1",7,0)
 S DGCN=+Y,DGCDT=+$P(Y,U,2)_".9" K DGCHOICE
"RTN","DGPTCO1",8,0)
 D DIV^DGPTCO2 G ENQ:'$D(DGCHOICE("DIV"))
"RTN","DGPTCO1",9,0)
 D STATUS^DGPTCO2 G ENQ:'$D(DGCHOICE("STATUS"))
"RTN","DGPTCO1",10,0)
 S %ZIS="NQ" D ^%ZIS K %ZIS G ENQ:POP D DOQ G ENQ:POP S DGIOP=ION_";"_IOM_";"_IOSL
"RTN","DGPTCO1",11,0)
 I 'DGQ D START G ENQ
"RTN","DGPTCO1",12,0)
 S ZTRTN="START^DGPTCO1",ZTIO=DGIOP,ZTDESC="Census Status Report"
"RTN","DGPTCO1",13,0)
 F X="DGCHOICE(","DGCDT","DGCN","DGIOP" S ZTSAVE(X)=""
"RTN","DGPTCO1",14,0)
 D ^%ZTLOAD D ^%ZISC
"RTN","DGPTCO1",15,0)
ENQ K DGQ,DHIT,DIOEND,DGC,DGCN,DGCDT,DGIOP,DGCHOICE,DIS
"RTN","DGPTCO1",16,0)
 Q
"RTN","DGPTCO1",17,0)
 ;
"RTN","DGPTCO1",18,0)
START ; -- produce report
"RTN","DGPTCO1",19,0)
 ;Lock global to prevent duplicate entries in Census Workfile
"RTN","DGPTCO1",20,0)
 L +^DG(45.85,"DGPT CENSUS REGEN WORKFILE"):5 I '$T D   Q
"RTN","DGPTCO1",21,0)
 .N DGPTMSG
"RTN","DGPTCO1",22,0)
 .D BLDMSG^DGPTCR
"RTN","DGPTCO1",23,0)
 .I $E(IOST,1,2)'="C-" D SNDMSG^DGPTCR,ENQ Q
"RTN","DGPTCO1",24,0)
 .N DGPTLINE
"RTN","DGPTCO1",25,0)
 .S DGPTLINE=0
"RTN","DGPTCO1",26,0)
 .F  S DGPTLINE=$O(DGPTMSG(DGPTLINE)) Q:'DGPTLINE  W !,?5,DGPTMSG(DGPTLINE,0)
"RTN","DGPTCO1",27,0)
 .Q
"RTN","DGPTCO1",28,0)
 I '$D(^DG(45.85,"ACENSUS",DGCN)) D REGEN^DGPTCR
"RTN","DGPTCO1",29,0)
 S DIC="^DG(45.85,",(BY,FLDS)="[DGPT WORKFILE]",L=0,FR=DGCN_",,@",TO=DGCN_",,"
"RTN","DGPTCO1",30,0)
 I DGCHOICE("STATUS")'="All" S (FR,TO)=DGCN_",,"_DGCHOICE("STATUS")
"RTN","DGPTCO1",31,0)
 S DIS(0)="D DIS^DGPTCO1",DHIT="D DHIT^DGPTCO1",DIOEND="D DIOEND^DGPTCO1"
"RTN","DGPTCO1",32,0)
 S Y=$P(DGCDT,".") X ^DD("DD") S DHD="Census Status Report for "_Y
"RTN","DGPTCO1",33,0)
 S IOP=DGIOP K DGC
"RTN","DGPTCO1",34,0)
 D EN1^DIP,ENQ
"RTN","DGPTCO1",35,0)
 L -^DG(45.85,"DGPT CENSUS REGEN WORKFILE")
"RTN","DGPTCO1",36,0)
END Q
"RTN","DGPTCO1",37,0)
 ;
"RTN","DGPTCO1",38,0)
DIOEND ; -- logic called at end of rpt for totals
"RTN","DGPTCO1",39,0)
 I $E(IOST)="C" S DIR(0)="E" D ^DIR K DIR G DIOENDQ:X="^"
"RTN","DGPTCO1",40,0)
 N D,S,Z S D="",Z="zzzz",$P(DGLN,"-",81)="" D NOW^%DTC S Y=% X ^DD("DD")
"RTN","DGPTCO1",41,0)
 W @IOF,?30,"Census Status Report",?59,Y,!!?26,"Division Summary Statistics",!
"RTN","DGPTCO1",42,0)
 ;
"RTN","DGPTCO1",43,0)
 F I=0:0 S D=$O(DGC(D)) Q:D=""  D DIV S S="" F J=0:0 S S=$O(DGC(D,S)) Q:S=""  S C=DGC(D,S) D PRT I $O(DGC(D,S))=Z D TOT Q
"RTN","DGPTCO1",44,0)
 W !,DGLN,!
"RTN","DGPTCO1",45,0)
 I $E(IOST)="C" S DIR(0)="E" D ^DIR K DIR
"RTN","DGPTCO1",46,0)
DIOENDQ K C,DGLN Q
"RTN","DGPTCO1",47,0)
 ;
"RTN","DGPTCO1",48,0)
DIV ;
"RTN","DGPTCO1",49,0)
 W !,DGLN
"RTN","DGPTCO1",50,0)
 I D="TOT" W !!?5,"OVERALL STATISTICS:" Q
"RTN","DGPTCO1",51,0)
 W:$D(^DG(40.8,+D,0)) !?5,$P(^(0),U),":"
"RTN","DGPTCO1",52,0)
 Q
"RTN","DGPTCO1",53,0)
 ;
"RTN","DGPTCO1",54,0)
TOT ;
"RTN","DGPTCO1",55,0)
 W !?10,$S(D="TOT":"Grand Total: ",1:"Division Total: "),?30,$J(DGC(D,Z),4)
"RTN","DGPTCO1",56,0)
 Q
"RTN","DGPTCO1",57,0)
 ;
"RTN","DGPTCO1",58,0)
PRT ;
"RTN","DGPTCO1",59,0)
 W !?10,S,": ",?30,$J(C,4)
"RTN","DGPTCO1",60,0)
 S:D'="TOT" DGC("TOT",S)=$S($D(DGC("TOT",S)):DGC("TOT",S),1:0)+C,DGC("TOT",Z)=$S($D(DGC("TOT",Z)):DGC("TOT",Z),1:0)+C
"RTN","DGPTCO1",61,0)
 Q
"RTN","DGPTCO1",62,0)
 ;
"RTN","DGPTCO1",63,0)
DIS ; -- $T logic for each entry
"RTN","DGPTCO1",64,0)
 N X S X=^DG(45.85,D0,0)
"RTN","DGPTCO1",65,0)
 I DGCHOICE("DIV")=1 G DISQ
"RTN","DGPTCO1",66,0)
 I $D(DGCHOICE("DIV",$S($D(^DIC(42,+$P(X,U,6),0)):+$P(^(0),U,11),1:0)))
"RTN","DGPTCO1",67,0)
DISQ Q
"RTN","DGPTCO1",68,0)
 ;
"RTN","DGPTCO1",69,0)
DHIT ; -- logic called for each entry printed cum stats; DGC(div,status)
"RTN","DGPTCO1",70,0)
 N D,S,Z S Z="zzzz" D STATUS
"RTN","DGPTCO1",71,0)
 S S=X,D=$S($D(^DIC(42,+$P(^DG(45.85,D0,0),U,6),0)):+$P(^(0),U,11),1:0)
"RTN","DGPTCO1",72,0)
 S DGC(D,S)=$S($D(DGC(D,S)):DGC(D,S),1:0)+1,DGC(D,Z)=$S($D(DGC(D,Z)):DGC(D,Z),1:0)+1
"RTN","DGPTCO1",73,0)
 Q
"RTN","DGPTCO1",74,0)
 ;
"RTN","DGPTCO1",75,0)
FIND ; -- find CENSUS rec#
"RTN","DGPTCO1",76,0)
 ;  input: D0 := ifn of 45.85
"RTN","DGPTCO1",77,0)
 ; output: X  := status ; DGCI := census ifn ; PTF := ptf ifn
"RTN","DGPTCO1",78,0)
 ;
"RTN","DGPTCO1",79,0)
 S DGCI="",X=0,Y=$S($D(^DG(45.85,D0,0)):^(0),1:"")
"RTN","DGPTCO1",80,0)
 G FINDQ:'Y S PTF=+$P(Y,U,12)
"RTN","DGPTCO1",81,0)
 F DGCI=0:0 S DGCI=$O(^DGPT("ACENSUS",PTF,DGCI)) Q:'DGCI  I $D(^DGPT(DGCI,0)),$P(^(0),U,13)=+$P(Y,U,4) S X=+$P(^(0),U,6) Q
"RTN","DGPTCO1",82,0)
FINDQ Q
"RTN","DGPTCO1",83,0)
 ;
"RTN","DGPTCO1",84,0)
STATUS ; -- compute CENSUS status
"RTN","DGPTCO1",85,0)
 D FIND S X=$P($P($P(^DD(45,6,0),U,3),X_":",2),";")
"RTN","DGPTCO1",86,0)
 K DGCI,PTF,Y Q
"RTN","DGPTCO1",87,0)
 ;
"RTN","DGPTCO1",88,0)
CREC ; -- compute CENSUS rec#
"RTN","DGPTCO1",89,0)
 D FIND S X=DGCI
"RTN","DGPTCO1",90,0)
 K DGCI,PTF,Y Q
"RTN","DGPTCO1",91,0)
 ;
"RTN","DGPTCO1",92,0)
DATE ; -- calculate default census date
"RTN","DGPTCO1",93,0)
 S Y=$S($D(^DG(45.86,+$O(^DG(45.86,"AC",1,0)),0)):+^(0),1:"")
"RTN","DGPTCO1",94,0)
 X:Y]"" ^DD("DD")
"RTN","DGPTCO1",95,0)
 Q
"RTN","DGPTCO1",96,0)
DOQ ;-- check if output device is queued. if not ask 
"RTN","DGPTCO1",97,0)
 S DGQ=0
"RTN","DGPTCO1",98,0)
 I $D(IO("Q")) S DGQ=1 G DOQT
"RTN","DGPTCO1",99,0)
 I IO=IO(0) G DOQT
"RTN","DGPTCO1",100,0)
 S DIR(0)="Y",DIR("A")="DO YOU WANT YOUR OUTPUT QUEUED",DIR("B")="YES"
"RTN","DGPTCO1",101,0)
 D ^DIR
"RTN","DGPTCO1",102,0)
 I Y S DGQ=1
"RTN","DGPTCO1",103,0)
DOQT ;
"RTN","DGPTCO1",104,0)
 K Y,DIR
"RTN","DGPTCO1",105,0)
 Q
"RTN","DGPTCO1",106,0)
CHKCUR ; -- checks if new PTF Census Date record is needed
"RTN","DGPTCO1",107,0)
 N DGIEN,DGCLOSE,DGACT,ERR
"RTN","DGPTCO1",108,0)
 S DGIEN=$S($D(^DG(45.86,+$O(^DG(45.86,"AC",1,0)),0)):+^(0),1:"")
"RTN","DGPTCO1",109,0)
 S DGIEN=$O(^DG(45.86,"B",+$G(DGIEN),0))
"RTN","DGPTCO1",110,0)
 S ERR=0
"RTN","DGPTCO1",111,0)
 I 'DGIEN S ERR=1 D ERR Q
"RTN","DGPTCO1",112,0)
 ; look at last census closeout date
"RTN","DGPTCO1",113,0)
 S DGCLOSE=$P($G(^DG(45.86,DGIEN,0)),U,2)
"RTN","DGPTCO1",114,0)
 I 'DGCLOSE S ERR=1 D ERR Q
"RTN","DGPTCO1",115,0)
 I $P($G(^DG(45.86,DGIEN,0)),U)<3070930 D
"RTN","DGPTCO1",116,0)
 . I $E(DGCLOSE,6,7)'=19 S ERR=1
"RTN","DGPTCO1",117,0)
 E  I $E(DGCLOSE,6,7)'=14 S ERR=1
"RTN","DGPTCO1",118,0)
 S DGACT=$P($G(^DG(45.86,DGIEN,0)),U,4)
"RTN","DGPTCO1",119,0)
 I 'DGACT S ERR=1
"RTN","DGPTCO1",120,0)
 I ERR D ERR Q
"RTN","DGPTCO1",121,0)
 I DT>DGCLOSE D ADDREC
"RTN","DGPTCO1",122,0)
 Q
"RTN","DGPTCO1",123,0)
ADDREC ; -- add new record
"RTN","DGPTCO1",124,0)
 N DA,DIE,DR,DGYR,DGMONTH,DGSTRT,DGENDT,ERR,FDA,IEN696,ERR696
"RTN","DGPTCO1",125,0)
 ; first inactivate last record
"RTN","DGPTCO1",126,0)
 S DA=DGIEN,DIE="^DG(45.86,",DR=".04////0" D ^DIE
"RTN","DGPTCO1",127,0)
 S DGYR=$E(DGCLOSE,1,3)
"RTN","DGPTCO1",128,0)
 ; create new record depending on last closeout date (month)
"RTN","DGPTCO1",129,0)
 S DGMONTH=$E(DGCLOSE,4,5)
"RTN","DGPTCO1",130,0)
 I DGMONTH>"00",DGMONTH<"04" S DGSTRT=DGYR_"0101",DGENDT=DGYR_"0331",DGCLOSE=DGYR_"0414"
"RTN","DGPTCO1",131,0)
 I DGMONTH>"03",DGMONTH<"07" S DGSTRT=DGYR_"0401",DGENDT=DGYR_"0630",DGCLOSE=DGYR_"0714"
"RTN","DGPTCO1",132,0)
 I DGMONTH>"06",DGMONTH<"10" S DGSTRT=DGYR_"0701",DGENDT=DGYR_"0930",DGCLOSE=DGYR_"1014"
"RTN","DGPTCO1",133,0)
 I DGMONTH>"09",DGMONTH<"13" S DGSTRT=DGYR_"1001",DGENDT=DGYR_"1231",DGYR=DGYR+1,DGCLOSE=DGYR_"0114"
"RTN","DGPTCO1",134,0)
 ;S DIC="^DG(45.86,",X=DGENDT,DIC(0)="" K DO D FILE^DICN K DIC
"RTN","DGPTCO1",135,0)
 ;I Y'>0 S ERR=1 D ERR Q
"RTN","DGPTCO1",136,0)
 ;S DIE="^DG(45.86,",DA=+Y,DR=".02////"_DGCLOSE_";.03////2970331;.04////1;.05////"_DGSTRT
"RTN","DGPTCO1",137,0)
 ;D ^DIE K DIE,DR,DA
"RTN","DGPTCO1",138,0)
 S FDA(696,45.86,"?+1,",.01)=DGENDT
"RTN","DGPTCO1",139,0)
 S FDA(696,45.86,"?+1,",.02)=DGCLOSE
"RTN","DGPTCO1",140,0)
 S FDA(696,45.86,"?+1,",.03)=2970331
"RTN","DGPTCO1",141,0)
 S FDA(696,45.86,"?+1,",.04)=1
"RTN","DGPTCO1",142,0)
 S FDA(696,45.86,"?+1,",.05)=DGSTRT
"RTN","DGPTCO1",143,0)
 D UPDATE^DIE("","FDA(696)","IEN696","ERR696")
"RTN","DGPTCO1",144,0)
 I $D(ERR696) S ERR=1 D ERR
"RTN","DGPTCO1",145,0)
 Q
"RTN","DGPTCO1",146,0)
ERR ;
"RTN","DGPTCO1",147,0)
 D BMES^XPDUTL("Problem with PTF CENSUS DATE File (#45.86).")
"RTN","DGPTCO1",148,0)
 D BMES^XPDUTL("Please notify your Supervisor !!.")
"RTN","DGPTCO1",149,0)
 Q
"RTN","DGPTCO1",150,0)
 ;
"RTN","DGPTDRG")
0^10^B26343356^B26243029
"RTN","DGPTDRG",1,0)
DGPTDRG ;ALB/ABS - DRG Information Report User Prompts ; 11/15/06 8:31am
"RTN","DGPTDRG",2,0)
 ;;5.3;Registration;**60,441,510,559,599,606,669,729**;Aug 13, 1993;Build 59
"RTN","DGPTDRG",3,0)
 ;;ADL;Update for CSV Project;;Mar 28, 2003
"RTN","DGPTDRG",4,0)
 S U="^" D Q,DT^DICRW
"RTN","DGPTDRG",5,0)
PAT D EFFDATE G Q:$D(DUOUT),Q:$D(DTOUT)
"RTN","DGPTDRG",6,0)
 W !!,"Choose Patient from PATIENT file" S %=1 D YN^DICN G Q:%=-1
"RTN","DGPTDRG",7,0)
 I %Y["?"!('%) W !?3,"Enter <RET> for YES if you want DRGs for a patient from your PATIENT File",!?3,"Answer 'N' for NO if you want DRGs for a hypothetical patient" G PAT
"RTN","DGPTDRG",8,0)
 S DGPTHOW=% I %=2 S NAME="" G AGE
"RTN","DGPTDRG",9,0)
 N DOB S DIC="^DPT(",DIC(0)="AEQMZ" W ! D ^DIC G Q:Y'>0 S DFN=+Y,NAME=$P(Y(0),"^"),(DOB,AGE)=$P(Y(0),U,3),SEX=$P(Y(0),U,2),X1=DT,X2=AGE D ^%DTC S AGE=X\365.25 W "  AGE:",AGE
"RTN","DGPTDRG",10,0)
 ;I AGE<0!(AGE>124) W !,"Unacceptable AGE",!,"Grouper accepts age values from 0-124 years.",!,"Verify patient's age in PATIENT File before continuing." G Q
"RTN","DGPTDRG",11,0)
 S DGEXP=$S($D(^DPT(DFN,.35))#2:1,1:0) I DGEXP,'$P(^(.35),"^") S DGEXP=0
"RTN","DGPTDRG",12,0)
 G EXP:DGEXP,TRS
"RTN","DGPTDRG",13,0)
AGE R !!,"Patient's AGE: ",AGE:DTIME G Q:AGE["^"!('$T) S:AGE<0!(AGE="")!(AGE>124)!(AGE'?.N) AGE="?" I AGE["?" W !,"Enter a number for patient's age in years (0-124)" G AGE
"RTN","DGPTDRG",14,0)
SEX R !!,"Patient's SEX: MALE// ",X:DTIME G Q:X["^"!('$T) S Z="^MALE^FEMALE" I X="" S X="M" W X
"RTN","DGPTDRG",15,0)
 D IN^DGHELP I %=-1 W !?3,"Enter <RET> for MALE if hypothetical patient is male",!?3,"Enter 'F' for Female" G SEX
"RTN","DGPTDRG",16,0)
 S SEX=$E(X)
"RTN","DGPTDRG",17,0)
EXP W !!,"Did patient die during this episode" S %=2 D YN^DICN G Q:%=-1 I %Y["?"!('%) W !?3,"Enter <RET> for NO if patient did not die during the hospital",!?15,"stay for which this DRG is to be calculated",!?3,"Enter 'Y' for YES" G EXP
"RTN","DGPTDRG",18,0)
 S DGEXP=$S(%=1:1,1:0) I DGEXP S (DGTRS,DGDMS)=0 G DX
"RTN","DGPTDRG",19,0)
TRS W !!,"Transfer to an acute care facility" S %=2 D YN^DICN G Q:%=-1 I %Y["?"!('%) W !?3,"Enter <RET> for NO if patient not transfered to an acute care facility",!?3,"Enter 'Y' for YES if patient was transfered to acute care facility" G TRS
"RTN","DGPTDRG",20,0)
 S DGTRS=$S(%=1:1,1:0)
"RTN","DGPTDRG",21,0)
DMS W !!,"Discharged against medical advice" S %=2 D YN^DICN G Q:%=-1 I %Y["?"!('%) W !?3,"Enter <RET> for NO if patient did not leave against medical advice",!?3,"Enter 'Y' for YES if patient did leave against medical advice",!,*7 G DMS
"RTN","DGPTDRG",22,0)
 S DGDMS=$S(%=1:1,1:0)
"RTN","DGPTDRG",23,0)
DX N DXINF,ICDVDT S ICDVDT=DGDAT
"RTN","DGPTDRG",24,0)
 S (DGDX,DGSURG)="" S PROMPT="Enter PRINCIPAL diagnosis: "
"RTN","DGPTDRG",25,0)
 D ICDEN1^DGPTF5
"RTN","DGPTDRG",26,0)
 Q:X["^"!(X="")
"RTN","DGPTDRG",27,0)
 S Y=+$$CODEN^ICDCODE(X,80)
"RTN","DGPTDRG",28,0)
 I $P($$ICDDX^ICDCODE(Y,DGDAT),U,5) D  G DX
"RTN","DGPTDRG",29,0)
 . W !,*7,">>>You have selected diagnosis code that is not considered"
"RTN","DGPTDRG",30,0)
 . W !,"a primary diagnosis code.  Please enter a PRIMARY code."
"RTN","DGPTDRG",31,0)
 S DGPTTMP=$$ICDDX^ICDCODE(+Y,DGDAT) S:$P(DGPTTMP,U,10) DGDX=+Y,DXINF=$$ICDDX^ICDCODE(+Y,DGDAT),DGDX(1)=$P(DXINF,"^",2)_"^"_$P(DXINF,"^",4) I '$$ISVALID^ICDGTDRG(+Y,DGDAT,9) D INAC G DX
"RTN","DGPTDRG",32,0)
 S PROMPT="Enter SECONDARY diagnosis: " W !
"RTN","DGPTDRG",33,0)
 F DGI=2:1:5 D ICDEN1^DGPTF5 Q:X["^"!(X="")  S Y=+$$CODEN^ICDCODE(X,80) I +Y>0 S DGPTTMP=$$ICDDX^ICDCODE(+Y,DGDAT) S:DGPTTMP>0&($P(DGPTTMP,U,10)) DGDX=DGDX_"^"_+Y,DXINF=$$ICDDX^ICDCODE(+Y,DGDAT),DGDX(DGI)=$P(DXINF,"^",2)_"^"_$P(DXINF,"^",4) D
"RTN","DGPTDRG",34,0)
 . I '$P(DGPTTMP,U,10) D INAC S DGI=DGI-1
"RTN","DGPTDRG",35,0)
 G Q:X["^" S DIC(0)="AEQMZ",DIC("S")="I $$ISVALID^ICDGTDRG(+Y,DGDAT,0)",DIC="^ICD0(",DIC("A")="Enter Operation/Procedure: " W !
"RTN","DGPTDRG",36,0)
 F DGI=1:1:4 D ^DIC Q:X["^"!(X="")  I +Y>0 S DGSURG=+Y_"^"_DGSURG,DXINF=$$ICDOP^ICDCODE(+Y,DGDAT),DGSURG(DGI)=$P(DXINF,U,2)_U_$P(DXINF,U,5)
"RTN","DGPTDRG",37,0)
 ; added next line for DG*5.3*441
"RTN","DGPTDRG",38,0)
 S DGSURG=U_DGSURG
"RTN","DGPTDRG",39,0)
 G Q:X["^" I $D(DGPTODR) S DGVAR="AGE^NAME^SEX^DGDMS^DGEXP^DGTRS^DGDX#^DGSURG#^DGDAT",DGPGM="^DGPTODR" W ! D ZIS^DGUTQ G:POP Q U IO D ^DGPTODR,CLOSE^DGUTQ,Q S DGPTODR=1 G PAT
"RTN","DGPTDRG",40,0)
 S DGDRGPRT=1 D ^DGPTICD,Q G PAT  ;return DRG code even if inactive
"RTN","DGPTDRG",41,0)
Q K DFN,DGI,DGPGM,AGE,NAME,DGDMS,DGDX,DGEXP,DGPTHOW,DGSURG,DGTRS,DGVAR,DGDRGPRT,DRG,DIC,SEX,POP,X,Y,Z,X1,X2,%,%Y Q
"RTN","DGPTDRG",42,0)
 ;
"RTN","DGPTDRG",43,0)
EFFDATE ;prompts for effective date for DRG grouper?
"RTN","DGPTDRG",44,0)
 K DIR S DIR(0)="D^::AEX",DIR("B")="TODAY",DIR("A")="Effective Date"
"RTN","DGPTDRG",45,0)
 S DIR("?")="The effective to be used when calculating the DRG code for the patient."
"RTN","DGPTDRG",46,0)
 D ^DIR K DIR I $D(DIRUT) S QUIT=1 Q
"RTN","DGPTDRG",47,0)
 S DGDAT=Y
"RTN","DGPTDRG",48,0)
 Q
"RTN","DGPTDRG",49,0)
INAC ;
"RTN","DGPTDRG",50,0)
 W !,*7,">>> You have selected an INACTIVE diagnosis code."
"RTN","DGPTDRG",51,0)
 W !,"    This code is not used by the grouper and may cause"
"RTN","DGPTDRG",52,0)
 W !,"    the case to be grouped into DRG 470 - UNGROUPABLE.",!
"RTN","DGPTDRG",53,0)
 W !,"    Therefore, this diagnosis code will NOT be passed"
"RTN","DGPTDRG",54,0)
 W !,"    to the grouper. Please enter another code."
"RTN","DGPTF41")
0^11^B9986685^B9939139
"RTN","DGPTF41",1,0)
DGPTF41 ;ALB/JDS - PTF ENTRY/EDIT-4 ; 11/15/06 8:37am
"RTN","DGPTF41",2,0)
 ;;5.3;Registration;**64,635,729**;Aug 13, 1993;Build 59
"RTN","DGPTF41",3,0)
 ;
"RTN","DGPTF41",4,0)
ACT ; -- 701 actions
"RTN","DGPTF41",5,0)
 G ACT1:DGST
"RTN","DGPTF41",6,0)
 S DGCFL=0 I $D(DGCST),DGCST<2,'DGCST!$G(DGREL) S DGCFL=1
"RTN","DGPTF41",7,0)
 W !,"   PTF ",$J("#"_PTF,7),?15,"actions: 1=Edit   C=Close       ^N=Another Screen",!
"RTN","DGPTF41",8,0)
 I DGCFL W "CENSUS ",$S(DGCI:$J("#"_DGCI,7),1:" record"),?15,"actions: ",$S(DGCST=1:"P=Open   E=Release",1:"         L=Close")
"RTN","DGPTF41",9,0)
 S Z="^CLOSE^1 Edit"
"RTN","DGPTF41",10,0)
 I DGCFL S Z=Z_"^"_$S(DGCST=1:"P Open Census^E Release Census",1:"L Close for Census")
"RTN","DGPTF41",11,0)
 W !?15,"         ^=Abort   <RET> to Continue: "
"RTN","DGPTF41",12,0)
 D READ
"RTN","DGPTF41",13,0)
 ;
"RTN","DGPTF41",14,0)
 I X="^"!(X="") G Q^DGPTF
"RTN","DGPTF41",15,0)
 I DGCFL,DGCST=1,$E(X)="P"!($E(X)="E") G ACT^DGPTC1
"RTN","DGPTF41",16,0)
 I DGCFL,'DGCST,$E(X)="L" G ACT^DGPTC1
"RTN","DGPTF41",17,0)
 I X?1"^".E S DGPTSCRN=701 G ^DGPTFJ
"RTN","DGPTF41",18,0)
 I X?1"C".E,'DGN G CLS^DGPTF4
"RTN","DGPTF41",19,0)
 I X="O" G O^DGPTF4
"RTN","DGPTF41",20,0)
 I X="R",DGN G REL
"RTN","DGPTF41",21,0)
 I X'=1 D HELP G EN1^DGPTF4
"RTN","DGPTF41",22,0)
 S DR="[DG701]",DIE="^DGPT(",(DGPTF,DA)=PTF D ^DIE
"RTN","DGPTF41",23,0)
 F I=0,70 S B(I)="" S:$D(^DGPT(PTF,I)) B(I)=^(I)
"RTN","DGPTF41",24,0)
 K DGPTF,DR
"RTN","DGPTF41",25,0)
 G EN1^DGPTF4
"RTN","DGPTF41",26,0)
 ;
"RTN","DGPTF41",27,0)
READ ; -- read X
"RTN","DGPTF41",28,0)
 R X:DTIME S:'$T X="^",DGPTOUT="" D IN^DGHELP
"RTN","DGPTF41",29,0)
 Q
"RTN","DGPTF41",30,0)
 ;
"RTN","DGPTF41",31,0)
HELP ;
"RTN","DGPTF41",32,0)
 W !,"Enter  '1'  to edit Principal & Admit Diagnosis"
"RTN","DGPTF41",33,0)
 W !,"       'C'  to close out PTF record"
"RTN","DGPTF41",34,0)
 I DGCFL W:DGCST=1 !,"       'P'  to re-open a Census record",!,"       'E'  to release a Census record" W:'DGCST !,"       'L'  to close for Census"
"RTN","DGPTF41",35,0)
 W !,"       '^'  to stop the display"
"RTN","DGPTF41",36,0)
 W !,"       '^N' to jump to screen #N (appears in upper right of screen '<N>')"
"RTN","DGPTF41",37,0)
 W !,"      <RET> to continue on to the next screen"
"RTN","DGPTF41",38,0)
 R !!,"Enter <RET> to continue: ",XS:DTIME
"RTN","DGPTF41",39,0)
 Q
"RTN","DGPTF41",40,0)
 ;
"RTN","DGPTF41",41,0)
ACT1 ;
"RTN","DGPTF41",42,0)
 W !,"   PTF ",$J("#"_PTF,7),?15,"actions: O=Open   R=Release   ^N=Another Screen",!
"RTN","DGPTF41",43,0)
 I $D(DGCST),DGCST=1 W "CENSUS ",$J("#"_DGCI,7),?15,"action :          E=Release"
"RTN","DGPTF41",44,0)
 W !?15,"         ^=Abort    <RET> to continue: "
"RTN","DGPTF41",45,0)
 S Z="^OPEN^RELEASE PTF^E RELEASE CENSUS"
"RTN","DGPTF41",46,0)
 D READ
"RTN","DGPTF41",47,0)
 I $D(DGCST),DGCST=1,$E(X)="E" G ACT^DGPTC1
"RTN","DGPTF41",48,0)
 I X=""!(X=U) G Q^DGPTF
"RTN","DGPTF41",49,0)
 I X?1"^".E S DGPTSCRN=701 G ^DGPTFJ
"RTN","DGPTF41",50,0)
 I X="O" G O^DGPTF4
"RTN","DGPTF41",51,0)
 I X="R" G REL
"RTN","DGPTF41",52,0)
 ;
"RTN","DGPTF41",53,0)
 W !,"Enter  'O'  to re-open a PTF record"
"RTN","DGPTF41",54,0)
 W !,"       'R'  to release a PTF record"
"RTN","DGPTF41",55,0)
 I $D(DGCST),DGCST=1 W !,"       'E'  to release a Census record"
"RTN","DGPTF41",56,0)
 W !,"       '^'  to stop the display"
"RTN","DGPTF41",57,0)
 W !,"       '^N' to jump to screen #N (appears in upper right of screen '<N>')"
"RTN","DGPTF41",58,0)
 W !,"      <RET> to continue on to the next screen"
"RTN","DGPTF41",59,0)
 R !!,"Enter <RET> to continue: ",XS:DTIME
"RTN","DGPTF41",60,0)
 G EN1^DGPTF4
"RTN","DGPTF41",61,0)
 ;
"RTN","DGPTF41",62,0)
REL ;
"RTN","DGPTF41",63,0)
 S Y=1 D RTY^DGPTUTL S DGPTFLE=1,DGPTIFN=PTF D EN^DGPTFREL G ^DGPTF
"RTN","DGPTF41",64,0)
 ;
"RTN","DGPTFJ")
0^21^B7423951^B7406575
"RTN","DGPTFJ",1,0)
DGPTFJ ;ALB/MRL - JUMP BETWEEN PTF SCREENS ; 12/12/06 9:04am
"RTN","DGPTFJ",2,0)
 ;;5.3;Registration;**58,517,635,729**;Aug 13, 1993;Build 59
"RTN","DGPTFJ",3,0)
 ;
"RTN","DGPTFJ",4,0)
TEST K S,M G Q^DGPTF:X="^" S Z="^101^401^501^601^701^801^MAS^CDR",X1=X,X=$P($E(X,2,99),"-",1) G QUES:X1?1"^?".E Q:X=""  D IN^DGHELP G QUES:%=-1
"RTN","DGPTFJ",5,0)
 S Z=$T(@X) I Z="" W !!,"*** Undefined screen number. Valid screens are: ",! G QUES
"RTN","DGPTFJ",6,0)
 I X=4!(X=5) S @($S(+X=5:"DGZM0",1:"DGZS0"))=$S(X1["-":+$P(X1,"-",2),1:1)
"RTN","DGPTFJ",7,0)
 I X=6 S DGZP=$S(X1["-":+$P(X1,"-",2),1:1)
"RTN","DGPTFJ",8,0)
 I X=8 S ANS="F"_$P(X1,"-",2)
"RTN","DGPTFJ",9,0)
 K M,L1,T G @($P(Z,";",3))
"RTN","DGPTFJ",10,0)
 ;
"RTN","DGPTFJ",11,0)
HELP W !!,"PTF Screens are: ",! F I=1,5,4,6,7,8,"M","C" S T=$T(@I) Q:T=""  W !?5,I,?10,$P(T,";",4)
"RTN","DGPTFJ",12,0)
 Q
"RTN","DGPTFJ",13,0)
QUES D HELP W !!,"Press Return to continue: " R X:4
"RTN","DGPTFJ",14,0)
 I $D(DGPTSCRN) S Z=$P($T(@$E(DGPTSCRN)),";",3) K DGPTSCRN G:Z]"" @Z
"RTN","DGPTFJ",15,0)
 G WR^DGPTF1
"RTN","DGPTFJ",16,0)
Q G Q^DGPTF
"RTN","DGPTFJ",17,0)
 ;
"RTN","DGPTFJ",18,0)
PROG ;
"RTN","DGPTFJ",19,0)
1 ;;WR^DGPTF1;'101' Screen--Admission/disposition Transaction
"RTN","DGPTFJ",20,0)
5 ;;EN^DGPTFM4;'501' Screen--Patient movement transaction
"RTN","DGPTFJ",21,0)
4 ;;EN^DGPTFM5;'401' Screen--Surgical/procedure entry
"RTN","DGPTFJ",22,0)
6 ;;E^DGPTFM1;'601' Screen--Procedure entry (AVAILABLE FOR DISCHARGES AFTER 10/1/87)
"RTN","DGPTFJ",23,0)
7 ;;EN1^DGPTF4;'701' Screen--PDXLS/DRG print
"RTN","DGPTFJ",24,0)
8 ;;F^DGPTFM2;'801' Screen--CPT entry (CPT and HCPCS)
"RTN","DGPTFJ",25,0)
M ;;^DGPTFM;'MAS' screen--surgery/procedure/diagnosis code edits
"RTN","DGPTFJ",26,0)
C ;;EN^DGPTFM7;'MPCR' screen--displays MPCR information
"RTN","DGPTFJ",27,0)
 Q
"RTN","DGPTFJ",28,0)
SA ;called from input transform on SOURCE OF ADMISSION field (#20) PTF file (#45)
"RTN","DGPTFJ",29,0)
 S DGER=$S('$D(PTF):1,'$D(^DGPT(PTF,0)):1,1:0) Q:DGER!("^48^49^50^"'[(U_Y_U))  S DGSU1=$P(^(0),"^",5),DGSU0=$S($D(^DGPT(PTF,101)):$P(^(101),"^",6),1:"")
"RTN","DGPTFJ",30,0)
 S DGSTATYP=$S(Y=48:11,Y=49:40,Y=50:30)
"RTN","DGPTFJ",31,0)
 D NUMACT^DGPTSUF(DGSTATYP)
"RTN","DGPTFJ",32,0)
 I DGANUM>0 D
"RTN","DGPTFJ",33,0)
 .I Y=48 F I=1:1:DGANUM S DGER=$S(((DGSU1=DGSUFNAM(DGANUM))!(DGSU1=""))&((DGSU0=DGSUFNAM(DGANUM))!(DGSU0="")):0,1:1)
"RTN","DGPTFJ",34,0)
 .I Y=49!(Y=50) F I=1:1:DGANUM S DGER=$S((Y=49&(DGSU1=DGSUFNAM(DGANUM))&("^9AA^9AB^9AC^9AD^9AE^"[(U_DGSU0_U))):0,(Y=50&(DGSU1=DGSUFNAM(DGANUM))&("^BU^BV^BW^BX^"[(U_DGSU0_U))):0,1:1)
"RTN","DGPTFJ",35,0)
 K DGANUM,DGSTATYP,DGSUFNAM,I
"RTN","DGPTFJ",36,0)
 Q
"RTN","DGPTFJC")
0^35^B48314184^B47957071
"RTN","DGPTFJC",1,0)
DGPTFJC ;ALB/ADL - CLOSED PTF ;7/28/05 1:08pm
"RTN","DGPTFJC",2,0)
 ;;5.3;Registration;**158,510,517,590,636,635,701,729**;Aug 13, 1993;Build 59
"RTN","DGPTFJC",3,0)
 ;;ADL;;Update for CSV Project;;Mar 25, 2003
"RTN","DGPTFJC",4,0)
101 W !,"Enter '^N' for Screen N, RETURN for <MAS>,'^' to Abort: <MAS>//"
"RTN","DGPTFJC",5,0)
 D READ G Q^DGPTF:X=U,^DGPTFM:X="",^DGPTFJ:X?1"^".E D H G 101
"RTN","DGPTFJC",6,0)
 ;
"RTN","DGPTFJC",7,0)
H D HELP^DGPTFJ W ! Q
"RTN","DGPTFJC",8,0)
 ;
"RTN","DGPTFJC",9,0)
MAS W !!,"Enter '^N' for Screen N, RETURN for <",DGNUM,">,'^' to Abort: <",DGNUM,">//"
"RTN","DGPTFJC",10,0)
 D READ G Q^DGPTF:X=U,^DGPTFJ:X?1"^".E
"RTN","DGPTFJC",11,0)
 I X="" S (ST,ST1)=J+2 G @($S($D(DGZDIAG):"NDG",$D(DGZSER):"NSR",$D(DGZPRO):"NPR",$D(DGZSUR):"EN",+DGZPRF-1'=$P(DGZPRF,U,3):"NPS",1:"DONE")_"^DGPTFM")
"RTN","DGPTFJC",12,0)
 D H G MAS
"RTN","DGPTFJC",13,0)
 ;
"RTN","DGPTFJC",14,0)
401 S DGNUM=$S($D(S(DGZS0+1)):401_"-"_(DGZS0+1),1:"MAS")
"RTN","DGPTFJC",15,0)
 W !,"Enter '^N' for Screen N, RETURN for <",DGNUM,">,'^' to Abort: <",DGNUM,">//"
"RTN","DGPTFJC",16,0)
 D READ G Q^DGPTF:X=U,NEXM^DGPTFM5:X="",^DGPTFJ:X?1"^".E D H G 401
"RTN","DGPTFJC",17,0)
 ;
"RTN","DGPTFJC",18,0)
501 W !,"Enter '^N' for Screen N, RETURN for <",DGNUM,">,'^' to Abort: <",DGNUM,">//"
"RTN","DGPTFJC",19,0)
 D READ G Q^DGPTF:X=U,NEXM^DGPTFM4:X="",^DGPTFJ:X?1"^".E D H G 501
"RTN","DGPTFJC",20,0)
 ;
"RTN","DGPTFJC",21,0)
601 W !,"Enter '^N' for Screen N, RETURN for <",DGNUM,">,'^' to Abort: <",DGNUM,">//"
"RTN","DGPTFJC",22,0)
 D READ G Q^DGPTF:X=U,NEXP^DGPTFM6:X="",^DGPTFJ:X?1"^".E D H G 601
"RTN","DGPTFJC",23,0)
 ;
"RTN","DGPTFJC",24,0)
701 ;
"RTN","DGPTFJC",25,0)
 G ACT1^DGPTF41 ; new code
"RTN","DGPTFJC",26,0)
 ;
"RTN","DGPTFJC",27,0)
 ;Display screen prompt and process user response for 801 screen
"RTN","DGPTFJC",28,0)
801 W !,"Enter '^N' for Screen N, RETURN for <",DGNUM,">,'^' to Abort: <",DGNUM,">//"
"RTN","DGPTFJC",29,0)
 D READ G Q^DGPTF:X=U,NEXP^DGPTFM2:X="",^DGPTFJ:X?1"^".E D H G 801
"RTN","DGPTFJC",30,0)
READ ; -- read X
"RTN","DGPTFJC",31,0)
 R X:DTIME S:'$T X="^",DGPTOUT=""
"RTN","DGPTFJC",32,0)
 Q
"RTN","DGPTFJC",33,0)
 ;
"RTN","DGPTFJC",34,0)
EN ; DG*636
"RTN","DGPTFJC",35,0)
 ;;S K=$S($D(K):K,1:1),DGER=0 S DGPTDAT=$$GETDATE^ICDGTDRG(DA(1)),DGPTTMP=$$ICDDX^ICDCODE(+Y,DGPTDAT) I +DGPTTMP=-1!('$P(DGPTTMP,U,10)) S DGER=1 Q
"RTN","DGPTFJC",36,0)
 S K=$S($D(K):K,1:1),DGER=0 S DGPTDAT=$$GETDATE^ICDGTDRG(DA(1))
"RTN","DGPTFJC",37,0)
 ;if there is a disch and a previous movement, if disch
"RTN","DGPTFJC",38,0)
 ;is >Oct 1 (next FY) and movement <Oct 1, then use the movement date
"RTN","DGPTFJC",39,0)
 I $G(DGZM0)="" S DGZM0=1,M(DGZM0)="0^"  ; to prevent sys err from TD5^DGPTTS2 and ptf quick load (DG*701/729)
"RTN","DGPTFJC",40,0)
 N DGPTMVDT I DGPTDAT=$P($G(^DGPT(DA(1),70)),U,1)&(DGPTDAT=$P($G(^DGPT(DA(1),"M",1,0)),U,10))&($D(M(DGZM0)))&($P($G(M(DGZM0)),U)'=1) S DGPTMVDT=$P($G(^DGPT(DA(1),"M",2,0)),U,10)
"RTN","DGPTFJC",41,0)
 ;next line is if using "Add a code" in MAS screen
"RTN","DGPTFJC",42,0)
 I '$G(DGPTMVDT)&($D(DGADD))&($G(DGMOV)'=1) S DGPTMVDT=$P($G(^DGPT(DA(1),"M",2,0)),U,10)
"RTN","DGPTFJC",43,0)
 I $G(DGPTMVDT) D
"RTN","DGPTFJC",44,0)
 .;if same calendar year
"RTN","DGPTFJC",45,0)
 .I $E(DGPTDAT,1,3)=$E(DGPTMVDT,1,3),$E(DGPTDAT,4,7)>0930,$E(DGPTMVDT,4,7)<1001 S DGPTDAT=DGPTMVDT Q
"RTN","DGPTFJC",46,0)
 .;if different calendar year
"RTN","DGPTFJC",47,0)
 .I ($E(DGPTDAT,1,3)-$E(DGPTMVDT,1,3))>1 S DGPTDAT=DGPTMVDT Q
"RTN","DGPTFJC",48,0)
 .I $E(DGPTMVDT,4,7)<1001 S DGPTDAT=DGPTMVDT Q
"RTN","DGPTFJC",49,0)
 .I $E(DGPTDAT,4,7)>0930 S DGPTDAT=DGPTMVDT Q
"RTN","DGPTFJC",50,0)
 I $G(DGPMT)!$G(DGQWK) K M(DGZM0),DGZM0  ; DG*701/729
"RTN","DGPTFJC",51,0)
 S DGPTTMP=$$ICDDX^ICDCODE(+Y,DGPTDAT) I +DGPTTMP=-1!('$P(DGPTTMP,U,10)) S DGER=1 Q
"RTN","DGPTFJC",52,0)
 ;end DG*636
"RTN","DGPTFJC",53,0)
 ;===================================================================
"RTN","DGPTFJC",54,0)
 I $P(DGPTTMP,U,11)]""&($P(DGPTTMP,U,11)'=$S($D(^DPT(+^DGPT(DA(1),0),0)):$P(^(0),U,2),1:"M")) W:K<24 !,$P(DGPTTMP,U,2)," can only be used with ",$S($P(DGPTTMP,U,11)="F":"FEMALES",1:"MALES") S K=K+1,DGER=1 Q
"RTN","DGPTFJC",55,0)
 S %=$P(^DGPT(DA(1),"M",DA,0),U,DGI) I $D(^DGPT(DA(1),"M","AC",Y,DA)),%'=Y S DGER=1 Q
"RTN","DGPTFJC",56,0)
 F I=0:0 S I=$O(^ICD9(+Y,"N",I)) Q:I'>0  I $D(^DGPT(DA(1),"M","AC",I,DA)),%'=I W !,"Cannot use ",$S($D(^ICD9(+Y,0)):$P(^(0),U),1:""),"  with ",$S($D(^ICD9(I,0)):$P(^(0),U),1:"") S DGER=1 Q
"RTN","DGPTFJC",57,0)
 Q:DGER  S DG1=1 F I=0:0 S I=$O(^ICD9(+Y,"R",I)) Q:I'>0  S DG1=0 I $D(^DGPT(DA(1),"M","AC",I,DA)),%'=I S DG1=1 Q
"RTN","DGPTFJC",58,0)
 I 'DG1 W !,$S(+DGPTTMP>0&('$P(DGPTTMP,U,10)):$P(DGPTTMP,U,2),1:"")," requires additional code."
"RTN","DGPTFJC",59,0)
 Q
"RTN","DGPTFJC",60,0)
EN1 S K=$S($D(K):K,1:1),DGER=0,DGPTDAT=$$GETDATE^ICDGTDRG(DA(1)),DGICD0=$$ICDOP^ICDCODE(+Y,DGPTDAT) I +DGICD0,0!('$P(DGICD0,U,10)) S DGER=1 Q
"RTN","DGPTFJC",61,0)
 I $P(DGICD0,U,11)]""&($P(DGICD0,U,11)'=$S($D(^DPT(+^DGPT(DA(1),0),0)):$P(^(0),U,2),1:"M")) W:K<24 !,$P(DGICD0,U,2)," can only be used with ",$S($P(DGICD0,U,11)="F":"FEMALES",1:"MALES") S K=K+1,DGER=1 Q
"RTN","DGPTFJC",62,0)
 S %=$P(^DGPT(DA(1),DGSB,DA,0),U,DGI) I $D(^DGPT(DA(1),DGSB,DGCR,Y,DA)),%'=Y S DGER=1 W !,"Cannot enter the same code more than once within a ",$S(DGSB="S":"401",1:"601")," transaction" Q
"RTN","DGPTFJC",63,0)
 F I=0:0 S I=$O(^ICD0(+Y,"N",I)) Q:I'>0  I $D(^DGPT(DA(1),DGSB,DGCR,I,DA)),%'=I S DGPTTMP2=$$ICDOP^ICDCODE(I,DGPTDAT) W !,"Cannot use ",$P(DGICD0,U,2),"  with ",$S(+DGPTTMP2>0:$P(DGPTTMP2,U,2),1:"") S DGER=1 Q
"RTN","DGPTFJC",64,0)
 Q:DGER  S DG1=1 F I=0:0 S I=$O(^ICD0(+Y,"R",I)) Q:I'>0  S DG1=0 I $D(^DGPT(DA(1),DGSB,DGCR,I,DA)),%'=I S DG1=1 Q
"RTN","DGPTFJC",65,0)
 I 'DG1 W !,$P(DGICD0,U,2)," requires additional code."
"RTN","DGPTFJC",66,0)
 Q
"RTN","DGPTFJC",67,0)
EN2 S K=$S($D(K):K,1:1),DGER=0,DGPTTMP=$$ICDOP^ICDCODE(+Y,$$GETDATE^ICDGTDRG(DA)) I +DGPTTMP<0!('$P(DGPTTMP,U,10)) S DGER=1 Q
"RTN","DGPTFJC",68,0)
 I $P(DGPTTMP,U,11)]""&($P(DGPTTMP,U,11)'=$S($D(^DPT(+^DGPT(DA,0),0)):$P(^(0),U,2),1:"M")) W:K<24 !,$P(DGPTTMP,U,2)," can only be used with ",$S($P(DGPTTMP,U,11)="F":"FEMALES",1:"MALES") S K=K+1,DGER=1 Q
"RTN","DGPTFJC",69,0)
 S L=$P($S($D(^DGPT((DA),"401P")):^("401P"),1:0),U,1,5),%=$P(L,U,DGI),L=$P(L,U,1,DGI-1)_U_$P(L,U,DGI+1,5) I L[Y S DGER=1 Q
"RTN","DGPTFJC",70,0)
 Q
"RTN","DGPTFJC",71,0)
EN3 S K=$S($D(K):K,1:1),DGER=0,DGPTTMP=$$ICDDX^ICDCODE(+Y,$$GETDATE^ICDGTDRG(DA)) I +DGPTTMP<0!('$P(DGPTTMP,U,10)) S DGER=1 Q
"RTN","DGPTFJC",72,0)
 I DGI=1,$P(DGPTTMP,U,5) S DGER=1 Q
"RTN","DGPTFJC",73,0)
 I $P(DGPTTMP,U,11)]""&($P(DGPTTMP,U,11)'=$S($D(^DPT(+^DGPT(DA,0),0)):$P(^(0),U,2),1:"M")) W:K<24 !,$P(DGPTTMP,U,2)," can only be used with ",$S($P(DGPTTMP,U,11)="F":"FEMALES",1:"MALES") S K=K+1,DGER=1 Q
"RTN","DGPTFJC",74,0)
 S %=$S($D(^DGPT(DA,70)):^(70),1:""),%=U_$P(%,U,10)_U_$P(%,U,16,24)_U
"RTN","DGPTFJC",75,0)
 S:$G(^DGPT(DA,71))'="" %=%_^(71)_U S $P(%,U,DGI+1)=U I %[(U_+Y_U) S DGER=1 Q
"RTN","DGPTFJC",76,0)
 F I=0:0 S I=$O(^ICD9(+Y,"N",I)) Q:I'>0  I %[(U_I_U) S DGPTTMP2=$$ICDDX^ICDCODE(I,DGPTDAT) W !,"Cannot use ",$P($G(DGPTTMP),U,2),"  with ",$S(+DGPTTMP2>0:$P(DGPTTMP2,U,2),1:"") S DGER=1 Q
"RTN","DGPTFJC",77,0)
 Q:DGER  S DG1=1 F I=0:0 S I=$O(^ICD9(+Y,"R",I)) Q:I'>0  S DG1=0 I %[(U_I_U) S DG1=1 Q
"RTN","DGPTFJC",78,0)
 I 'DG1 W !,$S(+DGPTTMP>0:$P(DGPTTMP,U,2),1:"")," requires additional code."
"RTN","DGPTFJC",79,0)
 Q
"RTN","DGPTFJC",80,0)
EN4 S K=$S($D(K):K,1:1),DGER=0,N=$$ICDDX^ICDCODE(+Y,$$GETDATE^ICDGTDRG(DA)) I N<0!'$P(N,U,10) S DGER=1 Q
"RTN","DGPTFJC",81,0)
 I DGI=1,$P(N,U,5) S DGER=1 Q
"RTN","DGPTFJC",82,0)
 I $P(N,U,11)]""&($P(N,U,11)'=$S($D(^DPT(+^DGPT(DA(2),0),0)):$P(^(0),U,2),1:"M")) W:K<24 !,$P(N,U,2)," can only be used with ",$S($P(N,U,11)="F":"FEMALES",1:"MALES") S K=K+1,DGER=1 Q
"RTN","DGPTFJC",83,0)
 S %=$S($D(^DGPT(DA(2),"C",DA(1),"CPT",DA,0)):^(0),1:""),%=U_$P(%,U,4,7)_U,$P(%,U,DGI+1)=U I %[(U_+Y_U) S DGER=1 Q
"RTN","DGPTFJC",84,0)
 F I=0:0 S I=$O(^ICD9(+Y,"N",I)) Q:I'>0  I %[(U_I_U) W !,"Cannot use ",$S($D(^ICD9(+Y,0)):$P(^(0),U),1:""),"  with ",$S($D(^ICD9(I,0)):$P(^(0),U),1:"") S DGER=1 Q
"RTN","DGPTFJC",85,0)
 Q:DGER  S DG1=1 F I=0:0 S I=$O(^ICD9(+Y,"R",I)) Q:I'>0  S DG1=0 I %[(U_I_U) S DG1=1 Q
"RTN","DGPTFJC",86,0)
 I 'DG1 W !,$P(N,U,2)," requires additional code."       Q
"RTN","DGPTFJC",87,0)
 Q
"RTN","DGPTFJC",88,0)
EN5 S K=$S($D(K):K,1:1),DGER=0,DGPTTMP=$$ICDDX^ICDCODE(+Y,+DGZPRF(DGZP)) I +DGPTTMP<0!('$P(DGPTTMP,U,10)) S DGER=1 Q
"RTN","DGPTFJC",89,0)
 I $P(DGPTTMP,U,11)]""&($P(DGPTTMP,U,11)'=$S($D(^DPT(+^DGPT(PTF,0),0)):$P(^(0),U,2),1:"M")) W:K<24 !,$P(DGPTTMP,U,2)," can only be used with ",$S($P(DGPTTMP,U,11)="F":"FEMALES",1:"MALES") S K=K+1,DGER=1 Q
"RTN","DGPTFJC",90,0)
 S K=^DGCPT(46,DA,0) I $P(K,U,4,7)_U_$P(K,U,15,18)[Y S DGER=1 Q
"RTN","DGPTFJC",91,0)
 Q
"RTN","DGPTFJC",92,0)
EN6 I $P($G(^(0)),U,2)?.N S DGER=1 Q
"RTN","DGPTFJC",93,0)
 S DGER=0,N=$$CPT^ICPTCOD(+Y,$$GETDATE^ICDGTDRG(DA)) I N<0!'$P(N,"^",7) S DGER=1 Q
"RTN","DGPTFJC",94,0)
 S L=0 F  S L=$O(^DGCPT(46,L)) Q:L'>0  I +$G(^(L,1))=DGPRD,$P(^(1),U,3)=PTF,+^(0)=Y,'$G(^(9)) S DGER=1 Q
"RTN","DGPTFJC",95,0)
 K L Q
"RTN","DGPTFM6")
0^23^B20304000^B20936331
"RTN","DGPTFM6",1,0)
DGPTFM6 ;ALB/BOK/ADL - 601 SCREEN: PROCEDURE ENTER/EDIT ; 21 JUL 88 @ 0900
"RTN","DGPTFM6",2,0)
 ;;5.3;Registration;**164,510,729**;Aug 13, 1993;Build 59
"RTN","DGPTFM6",3,0)
 ;;ADL;Update for CSV Project;;Mar 26, 2003
"RTN","DGPTFM6",4,0)
EN I $D(^DGPTF(PTF,70)),+^(70)<2871000 W !!,"Data cannot be entered into these fields until after 10/1/1987" H 5 G ^DGPTFM
"RTN","DGPTFM6",5,0)
 I DT<2871000 W !!,"Data can not be entered into these fields until after 10/1/1987" H 5 G ^DGPTFM
"RTN","DGPTFM6",6,0)
 G @($S(X=6:"E",1:X))
"RTN","DGPTFM6",7,0)
T ;ADD PROCEDURE RECORD
"RTN","DGPTFM6",8,0)
 S DGZP=0 S:'$D(^DGPT(PTF,"P",0)) ^(0)="^45.05DA^^"
"RTN","DGPTFM6",9,0)
 S DIC="^DGPT("_PTF_",""P"",",DIC(0)="AEQLMZ",DA(1)=PTF D ^DIC G ^DGPTFM:Y'>0!('$D(^DGPT(PTF,"P",+Y))) S DGPROCM=+Y,DGPROCD=$P(Y,U,2) D MOB I DGPC F I=1:1:DGPC S:P(I,1)=DGPROCM DGZP=I
"RTN","DGPTFM6",10,0)
 G:'DGZP ^DGPTFM S DGPROC(DGZP)=DGPROCM,X="1,2"
"RTN","DGPTFM6",11,0)
EDIT G HELP:X<1!(X>2) S DIE="^DGPT(",(DA,DGPTF)=PTF,DR="[DG601]",DGJUMP=X
"RTN","DGPTFM6",12,0)
 S DIE="^DGPT(",DGJUMP=X D ^DIE,CHK601^DGPTSCAN K DR,DIE,DIC,DA,DGADD,DGJUMP D MOB
"RTN","DGPTFM6",13,0)
SET D MOB:'$D(P) S:'$D(DGZP) DGZP=1 S P(DGZP,1)=$S($D(P(DGZP,1)):P(DGZP,1),1:"") I P(DGZP,1)="" K P(DGZP) G NEXP
"RTN","DGPTFM6",14,0)
 S (P1,P(DGZP))=$S($D(^DGPT(PTF,"P",P(DGZP,1),0)):^(0),1:"")
"RTN","DGPTFM6",15,0)
WRT G:'$D(^DGPT(PTF,"P",P(DGZP,1),0)) ^DGPTFM S DGPROCI=^(0) W @IOF,HEAD,?68 S Z="<601-"_DGZP_">" W @DGVI,Z,@DGVO,!! S (Y,L)=+P(DGZP),Z=1 D D^DGPTUTL,Z^DGPTFM5 W $J("Date of Proc:  ",32),Y,!,$J("Specialty:  ",35)
"RTN","DGPTFM6",16,0)
 W $S($D(^DIC(42.4,+$P(P(DGZP),U,2),0)):$P(^(0),U),1:""),! I $P(P(DGZP),U,4) W "   Number of Dialysis Treatments:  ",$P(P(DGZP),U,4),!
"RTN","DGPTFM6",17,0)
 W !! S Z=2 D Z^DGPTFM5 W "  Procedures:   " F I=1:1:5 S L=$P(P(DGZP),U,4+I) I L S DGPTTMP=$$ICDOP^ICDCODE(+L,$$GETDATE^ICDGTDRG(PTF)) D
"RTN","DGPTFM6",18,0)
 . W $S(+DGPTTMP>0&($P(DGPTTMP,U,10)):$P(DGPTTMP,U,5)_" ("_$P(DGPTTMP,U,2)_")",1:"**************"_L),!?19
"RTN","DGPTFM6",19,0)
 F I=1:1:(IOSL-$Y-5) W !
"RTN","DGPTFM6",20,0)
 S DGNUM=$S($D(P(DGZP+1)):601_"-"_(DGZP+1),1:"MAS") G 601^DGPTFJC:DGST
"RTN","DGPTFM6",21,0)
 W "Enter <RET> to continue, 1-2 to edit,",!,"'T' to add a Procedure Segment, '^N' for screen N, or '^' to abort: <",DGNUM,">//"
"RTN","DGPTFM6",22,0)
 R X:DTIME S:'$T X="^",DGPTOUT=""
"RTN","DGPTFM6",23,0)
 K DGNUM G Q^DGPTF:X="^"
"RTN","DGPTFM6",24,0)
 I X?1"^".E S DGPTSCRN=601 G ^DGPTFJ
"RTN","DGPTFM6",25,0)
 G T:X="T"!(X="t"),HELP:X["?"
"RTN","DGPTFM6",26,0)
 I X[1!(X[2) S DA=+P(DGZP) G EDIT
"RTN","DGPTFM6",27,0)
 I X'="" G HELP
"RTN","DGPTFM6",28,0)
NEXP ;S DGZP=DGZP+1 G ^DGPTFM:'$D(P(DGZP)),SET
"RTN","DGPTFM6",29,0)
 S DGZP=DGZP+1 I '$D(P(DGZP)) S DGZP=1 G ^DGPTFM
"RTN","DGPTFM6",30,0)
 G SET
"RTN","DGPTFM6",31,0)
HELP W !,"Enter '^' to stop display and edit of data",!,"'^N' to jump to screen #N (appears in upper right of screen as <N>)",!,"<RET> to continue on to next screen or 1-2 to edit:"
"RTN","DGPTFM6",32,0)
 W !?10,"1-Procedure information",!,?10,"2-Procedure codes",!,"You may also enter any combination of the above, separated by commas (ex:1,2)",!
"RTN","DGPTFM6",33,0)
 R !!,"Enter <RET>: ",X:DTIME G WRT
"RTN","DGPTFM6",34,0)
MOB K P,P1,P2 S (I,P2)=0 F I1=1:1 S I=$O(^DGPT(PTF,"P",I)) Q:I'>0  S P(I1)=^(I,0),P(I1,1)=I I P(I1)']"" K P(I1) S I1=I1-1
"RTN","DGPTFM6",35,0)
 S DGPC=I1-1 Q
"RTN","DGPTFM6",36,0)
BS ;CALLED FROM [DG601]
"RTN","DGPTFM6",37,0)
 S I=$O(^DGPT(PTF,"M","AM",^DGPT(PTF,"P",DA,0)-.0000001)),I=$O(^(+I,0))
"RTN","DGPTFM6",38,0)
 S DGMOVM=$S($D(^DGPT(PTF,"M",$S(I:I,1:1),0)):$P(^(0),U,2),1:"")
"RTN","DGPTFM6",39,0)
 Q
"RTN","DGPTFM6",40,0)
R ;DELETE PROCEDURE RECORD
"RTN","DGPTFM6",41,0)
 G R^DGPTFM4
"RTN","DGPTFM6",42,0)
E ;EDIT PROCEDURE RECORD
"RTN","DGPTFM6",43,0)
 G E^DGPTFM1
"RTN","DGPTFM6",44,0)
P I $D(^DGPT(PTF,70)),+^(70)<2871000 G FY86
"RTN","DGPTFM6",45,0)
 I DT<2871000 G FY86
"RTN","DGPTFM6",46,0)
 S L="" F I=1:1:DGPC S L2=1 F J=5:1:9 I L2,$P(P(I),U,J)="" S L=L_I_",",L2=0
"RTN","DGPTFM6",47,0)
 I L="" W !!,"There are no procedure records that can be added to.",*7 H 2 G ^DGPTFM
"RTN","DGPTFM6",48,0)
 S L=$E(L,1,$L(L)-1) I L=+L S DGRC=+L G P2
"RTN","DGPTFM6",49,0)
P1 I 'Z W !!,"Add to procedure record <",L,"> : " R DGRC:DTIME G ^DGPTFM:DGRC[U!(DGRC="")
"RTN","DGPTFM6",50,0)
 E  S DGRC=+$E(A,2,99)
"RTN","DGPTFM6",51,0)
P2 I +DGRC'=DGRC!(","_L_","'[(","_DGRC_",")) W !!,"Enter the procedure record number to add ICD operation codes to: ",L G P1:'Z S Z="" G P1
"RTN","DGPTFM6",52,0)
 S DP=45.05,DIE="^DGPT("_PTF_",""P"",",DA(1)=PTF,DR="" F I=5:1:9 I $P(P(DGRC),U,I)="" S DR=DR_(I-1)_";"
"RTN","DGPTFM6",53,0)
 S DR=$E(DR,1,$L(DR)-1),DA=+P(DGRC,1),DA(1)=PTF D ^DIE K DR,DIE G ^DGPTFM
"RTN","DGPTFM6",54,0)
FY86 S DR="" F J=1:1:5 I $P(PROC,U,J)="" S DR=DR_(J/100+45)_";"
"RTN","DGPTFM6",55,0)
 I DR="" W !!,"No more procedures can be added.",*7 H 2 G ^DGPTFM
"RTN","DGPTFM6",56,0)
 S DR=$E(DR,1,$L(DR)-1),DP=45,DIE="^DGPT(",DA=PTF D ^DIE K DR,DIE G ^DGPTFM
"RTN","DGPTFM6",57,0)
GETVAR ;CALLED FROM GET+1^DGPTFM
"RTN","DGPTFM6",58,0)
 S PM=I1-1,I=0 F I1=1:1 S I=$O(^DGPT(PTF,"S",I)) Q:I'>0  S S(I1)=^(I,0),S(I1,1)=I
"RTN","DGPTFM6",59,0)
 K P2 S SU=I1-1 S PROC=$S($D(^DGPT(PTF,"401P")):^("401P"),1:""),P2=0 F J1=1:1:5 S:$P(PROC,U,J1) P2=P2+1,P2(P2)=J1
"RTN","DGPTFM6",60,0)
 K P S I=0 F I1=1:1 S I=$O(^DGPT(PTF,"P",I)) Q:I'>0  S P(I1)=^(I,0),P(I1,1)=I
"RTN","DGPTFM6",61,0)
 Q
"RTN","DGPTFM7")
0^30^B21219043^B21153448
"RTN","DGPTFM7",1,0)
DGPTFM7 ;ALB/MJK - Display Phys. MPCR mvts ; 11/30/06 8:31am
"RTN","DGPTFM7",2,0)
 ;;5.3;Registration;**78,590,594,683,729**;Aug 13, 1993;Build 59
"RTN","DGPTFM7",3,0)
 ;
"RTN","DGPTFM7",4,0)
EN ; entry pt to display MPCR screen
"RTN","DGPTFM7",5,0)
 ; -- PTF and DGPTFMT must be defined
"RTN","DGPTFM7",6,0)
 ;
"RTN","DGPTFM7",7,0)
 S DGMAX=7,DGPTIFN=PTF,DGTOT=0 G BYPASS:DGPTFMT<2
"RTN","DGPTFM7",8,0)
 D FDT^DGPTUTL S DGFMTDT=Y
"RTN","DGPTFM7",9,0)
 F NODE=535,"M" F I=0:0 S I=$O(^DGPT(DGPTIFN,NODE,I)) Q:'I  I $D(^(I,0)) S Y=$S($P(^(0),U,10):$P(^(0),U,10),1:DT+.2359),^UTILITY($J,"DGCDR",Y)=NODE_U_I,^UTILITY($J,"DG"_NODE,Y)=I
"RTN","DGPTFM7",10,0)
 S P=$S('$D(^DGPT(DGPTIFN,0)):DGFMTDT+1,$P(^(0),U,2)>DGFMTDT:$P(^(0),U,2),1:DGFMTDT)
"RTN","DGPTFM7",11,0)
 F I=0:0 S I=$O(^UTILITY($J,"DGCDR",I)) Q:'I  I I>DGFMTDT S DGTOT=DGTOT+1,^(I)=^(I)_"^"_P,P=I
"RTN","DGPTFM7",12,0)
BYPASS S (DGC,DGLDT)=0
"RTN","DGPTFM7",13,0)
LOOP ;
"RTN","DGPTFM7",14,0)
 D HEADER:$Y>(IOSL-15) S DGLAST("DT")=DGLDT,DGLAST("C")=DGC
"RTN","DGPTFM7",15,0)
 I DGPTFMT<2 W !!,"  MPCR information not required for this admission."
"RTN","DGPTFM7",16,0)
 F DGLDT=DGLDT:0 S DGLDT=$O(^UTILITY($J,"DGCDR",DGLDT)) Q:'DGLDT  I DGLDT>DGFMTDT S X=^(DGLDT) D PRT I 'DGPR Q:'(DGC#DGMAX)!(DGC=DGTOT)
"RTN","DGPTFM7",17,0)
 I DGPR D KILL Q
"RTN","DGPTFM7",18,0)
 W:DGC<DGTOT !,"...more movements available"
"RTN","DGPTFM7",19,0)
 F I=$Y:1:18 W !
"RTN","DGPTFM7",20,0)
 ;
"RTN","DGPTFM7",21,0)
 K X S $P(X,"-",81)="" W X
"RTN","DGPTFM7",22,0)
 I $D(DGBRCH) G @DGBRCH
"RTN","DGPTFM7",23,0)
 W !,"Enter <RET> to ",$S(DGC'<DGTOT:"go to MAS screen",1:"display more MPCR information"),!,"      '^N'  to go to screen N,  or '^' to abort: <",$S(DGC'<DGTOT:"MAS",1:"RET"),">// " R X:DTIME S:'$T X="^",DGPTOUT=""
"RTN","DGPTFM7",24,0)
 I X="^" D KILL G Q^DGPTF
"RTN","DGPTFM7",25,0)
 I X="",DGC<DGTOT G LOOP
"RTN","DGPTFM7",26,0)
 S:X="" X="^MAS"
"RTN","DGPTFM7",27,0)
 I X?1"^".E D KILL S DGPTSCRN="CDR" G ^DGPTFJ
"RTN","DGPTFM7",28,0)
 ;
"RTN","DGPTFM7",29,0)
HELP ; -- screen help
"RTN","DGPTFM7",30,0)
 I DGC<DGTOT W !,"Press return to see more MPCR information"
"RTN","DGPTFM7",31,0)
 I DGC'<DGTOT W !,"Press return to go to the 'MAS' screen"
"RTN","DGPTFM7",32,0)
 W !,"        '^'  to stop the display"
"RTN","DGPTFM7",33,0)
 W !,"        '^N' to jump to screen #N (appears in upper right of screen '<N>')"
"RTN","DGPTFM7",34,0)
 R !!,"Enter <RET>: ",X:DTIME
"RTN","DGPTFM7",35,0)
 S DGC=DGLAST("C"),DGLDT=DGLAST("DT") G LOOP
"RTN","DGPTFM7",36,0)
 ;
"RTN","DGPTFM7",37,0)
KILL ; -- kill off locals
"RTN","DGPTFM7",38,0)
 K ^UTILITY($J,"DGCDR"),^("DG535"),^("DGM"),DGCDR,DGC,DGI0,DGICDR,DGLDT,DGLVE,DGPASS,DG5SP,DG5CDR,DGMSP,DGMCDR,DGMDRG,DGMAX,DGTOT,DGWARD,DGPTIFN,DGLAST,DGFMTDT,DGLDTE,DGCDR0,DGM0,DGMTY,P,I
"RTN","DGPTFM7",39,0)
 Q
"RTN","DGPTFM7",40,0)
 ;
"RTN","DGPTFM7",41,0)
HEADER ;
"RTN","DGPTFM7",42,0)
 I DGPR D HEAD^DGPTFMO
"RTN","DGPTFM7",43,0)
 I 'DGPR W @IOF,HEAD,?72 S Z="<MPCR>" D Z^DGPTFM
"RTN","DGPTFM7",44,0)
 W !?23,"Rec",?38,"Losing Ward",?54,"PTF"
"RTN","DGPTFM7",45,0)
 W !?4,"Losing Date",?23,"Type",?28,"Ward/DRG",?38,"MPCR/Spec",?54,"MPCR/Spec",?68,"Lve/Pas/ Los"
"RTN","DGPTFM7",46,0)
 W !,"--------------------------------------------------------------------------------"
"RTN","DGPTFM7",47,0)
 Q
"RTN","DGPTFM7",48,0)
 ;
"RTN","DGPTFM7",49,0)
PRT ; -- collect 501 and 535 data and then print
"RTN","DGPTFM7",50,0)
 ; 
"RTN","DGPTFM7",51,0)
 I $P(X,U)="M" S DGMTY=501,(Z,DGM0)=^DGPT(DGPTIFN,"M",+$P(X,U,2),0),DGMDRG=$S($D(^("P")):$P(^("P"),U),1:""),Y=+$O(^UTILITY($J,"DG535",DGLDT-.0000001)),DGCDR0=$S('$D(^(Y)):"",$D(^DGPT(DGPTIFN,535,+^(Y),0)):^(0),1:"")
"RTN","DGPTFM7",52,0)
 ;
"RTN","DGPTFM7",53,0)
 I $P(X,U)="535" S DGMTY=535,(Z,DGCDR0)=^DGPT(DGPTIFN,535,+$P(X,U,2),0),Y=+$O(^UTILITY($J,"DGM",DGLDT-.0000001)),DGM0=$S('$D(^(Y)):"",$D(^DGPT(DGPTIFN,"M",+^(Y),0)):^(0),1:""),DGMDRG=""
"RTN","DGPTFM7",54,0)
 ;
"RTN","DGPTFM7",55,0)
 N DGLOS S X1=DGLDT,X2=$P(X,U,3) D ^%DTC S X=X-$P(Z,U,3),DGLOS=$J($S(X>0:X,1:1),4)
"RTN","DGPTFM7",56,0)
 S DGC=DGC+1,DGLVE=$J($P(Z,U,3),3),DGPASS=$J($P(Z,U,4),3)
"RTN","DGPTFM7",57,0)
 S Y=DGLDT X ^DD("DD") S DGLDTE=Y
"RTN","DGPTFM7",58,0)
 ;S DGMSP=$E($S($D(^DIC(42.4,+$P(DGM0,U,2),0)):$P(^(0),U),1:"UNKNOWN"),1,14),DGMCDR=$J(+$P(DGM0,U,16),7,2)
"RTN","DGPTFM7",59,0)
 ;S DG5SP=$E($S($D(^DIC(42.4,+$P(DGCDR0,U,2),0)):$P(^(0),U),1:"UNKNOWN"),1,14),DG5CDR=$J(+$P(DGCDR0,U,16),7,2)
"RTN","DGPTFM7",60,0)
 I $D(^DIC(42.4,+$P(DGM0,U,2),0)) D
"RTN","DGPTFM7",61,0)
 . S DGMSP=$P(^DIC(42.4,+$P(DGM0,U,2),0),"^",2)
"RTN","DGPTFM7",62,0)
 . I DGMSP="" S DGMSP=$P(^DIC(42.4,+$P(DGM0,U,2),0),"^")
"RTN","DGPTFM7",63,0)
 . S DGMSP=$E(DGMSP,1,14)
"RTN","DGPTFM7",64,0)
 E  S DGMSP="UNKNOWN"
"RTN","DGPTFM7",65,0)
 S DGMCDR=$J(+$P(DGM0,U,16),7,2)
"RTN","DGPTFM7",66,0)
 I $D(^DIC(42.4,+$P(DGCDR0,U,2),0)) D
"RTN","DGPTFM7",67,0)
 . S DG5SP=$P(^DIC(42.4,+$P(DGCDR0,U,2),0),"^",2)
"RTN","DGPTFM7",68,0)
 . I DG5SP="" S DG5SP=$P(^DIC(42.4,+$P(DGCDR0,U,2),0),"^")
"RTN","DGPTFM7",69,0)
 . S DGMSP=$E(DGMSP,1,14)
"RTN","DGPTFM7",70,0)
 E  S DG5SP="UNKNOWN"
"RTN","DGPTFM7",71,0)
 S DG5CDR=$J(+$P(DGCDR0,U,16),7,2)
"RTN","DGPTFM7",72,0)
 S DGWARD=$E($S($D(^DIC(42,+$P(DGCDR0,U,6),0)):$P(^(0),U),1:"UNKNOWN"),1,8)
"RTN","DGPTFM7",73,0)
 ;
"RTN","DGPTFM7",74,0)
 W !,$J(DGC,3),?4,DGLDTE,?23,DGMTY,?28,DGWARD,?38,DG5CDR,?54,DGMCDR,?68,DGLVE,"/",DGPASS,"/",DGLOS,!?28,DGMDRG,?38,DG5SP,?54,DGMSP
"RTN","DGPTFM7",75,0)
 Q
"RTN","DGPTFM7",76,0)
 ;
"RTN","DGPTFM7",77,0)
INQ ; -- entry point for inquire option
"RTN","DGPTFM7",78,0)
 ;
"RTN","DGPTFM7",79,0)
 S:'$D(DC) DC=0 S PTF=D0,DGPR=1 D EN,KILL K PTF Q:$Y<(IOSL-15)
"RTN","DGPTFM7",80,0)
 I $E(IOST,1)="C" W *7 R X:DTIME I X=U S DN=0 Q
"RTN","DGPTFM7",81,0)
 W @IOF,! X:$D(^UTILITY($J,2)) ^(2) W ! F %=1:1:IOM W "_"
"RTN","DGPTFM7",82,0)
 W !,"("_$P(^DPT(+^DGPT(D0,0),0),U,1)_")",!
"RTN","DGPTFM7",83,0)
 Q
"RTN","DGPTFM7",84,0)
DT I Y W $P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC",U,$E(Y,4,5))," " W:Y#100 $J(Y#100\1,2),"," W Y\10000+1700 W:Y#1 "  ",$E(Y_0,9,10),":",$E(Y_"000",11,12)
"RTN","DGPTFM7",85,0)
 Q
"RTN","DGPTFM7",86,0)
 ;
"RTN","DGPTFM71")
0^31^B4775290^B4760752
"RTN","DGPTFM71",1,0)
DGPTFM71 ;ALB/MJK - Display Phys. MPCR mvts ; 12/12/06 11:49am
"RTN","DGPTFM71",2,0)
 ;;5.3;Registration;**729**;Aug 13, 1993;Build 59
"RTN","DGPTFM71",3,0)
 ;
"RTN","DGPTFM71",4,0)
EN ; -- entry point for MPCR display option
"RTN","DGPTFM71",5,0)
 W ! S DIC="^DGPT(",DIC(0)="AEMZQ",DIC("S")="I '$P(^(0),U,4),$P(^(0),U,11)=1" D ^DIC K DIC
"RTN","DGPTFM71",6,0)
 G ENQ:+Y<0 S DGPTF0=Y(0),PTF=+Y,DFN=+Y(0) D UPDT^DGPTUTL:'$P(Y(0),U,6)
"RTN","DGPTFM71",7,0)
 S Y=$S($D(^DGPT(PTF,70)):+^(70),1:"") D FMT^DGPTUTL
"RTN","DGPTFM71",8,0)
 S DGPR="",DGBRCH="OPT^DGPTFM71" K DGBLK S $P(DGBLK," ",80)=""
"RTN","DGPTFM71",9,0)
 S X=$S($D(^DPT(DFN,0)):^(0),1:""),HEAD=$E($P(X,U)_" ("_$E($P(X,U,9),6,10)_")"_DGBLK,1,30)_"Adm: ",Y=$P(DGPTF0,U,2) X ^DD("DD") S HEAD=HEAD_Y_" to " S Y=$S($D(^DGPT(PTF,70)):+^(70),1:"") S:'Y Y="Present" X:Y ^DD("DD") S HEAD=HEAD_Y_" "
"RTN","DGPTFM71",10,0)
 ;S X="IORVON;IORVOFF" D ENDR^%ZISS S DGVI=IORVON,DGVO=IORVOFF K IORVON,IORVOFF
"RTN","DGPTFM71",11,0)
 S (DGVI,DGVO)=""""""
"RTN","DGPTFM71",12,0)
 D EN^DGPTFM7 G EN
"RTN","DGPTFM71",13,0)
ENQ K DGPR,HEAD,DFN,DGPTFMT,DGVI,DGVO,DGBRCH,PTF,DIC,DGPTF0,DGBLK Q
"RTN","DGPTFM71",14,0)
 ;
"RTN","DGPTFM71",15,0)
OPT I DGC'<DGTOT W !,"Enter <RET> to stop"
"RTN","DGPTFM71",16,0)
 I DGC<DGTOT W !,"Enter <RET> to display more MPCR information"
"RTN","DGPTFM71",17,0)
 I DGC>DGMAX W:$X>40 !?2 W " or  'B'  to display from beginning"
"RTN","DGPTFM71",18,0)
 W ":  <RET>// " R X:DTIME
"RTN","DGPTFM71",19,0)
 I '$T!(X="^") G OPTQ
"RTN","DGPTFM71",20,0)
 I X="" G LOOP^DGPTFM7:DGC<DGTOT,OPTQ
"RTN","DGPTFM71",21,0)
 I DGC>DGMAX,X="B" S (DGC,DGLDT)=0 G LOOP^DGPTFM7
"RTN","DGPTFM71",22,0)
 W !
"RTN","DGPTFM71",23,0)
 I DGC<DGTOT W !,"Press return to see more MPCR information"
"RTN","DGPTFM71",24,0)
 I DGC'<DGTOT W !,"Press return to stop the display"
"RTN","DGPTFM71",25,0)
 I DGC>DGMAX W !,"Enter 'B'    to display table from beginning again"
"RTN","DGPTFM71",26,0)
 W !,"      '^'    to stop the display",!
"RTN","DGPTFM71",27,0)
 G OPT
"RTN","DGPTFM71",28,0)
OPTQ D KILL^DGPTFM7 Q
"RTN","DGPTFM71",29,0)
 ;
"RTN","DGPTFM8")
0^6^B9470941^B9469877
"RTN","DGPTFM8",1,0)
DGPTFM8 ;ALB/MTC - PTF ADDITIONAL QUESTION DISPLAY FOR MAS SCREEN ; 25 APR 91
"RTN","DGPTFM8",2,0)
 ;;5.3;Registration;**729**;Aug 13, 1993;Build 59
"RTN","DGPTFM8",3,0)
 ;
"RTN","DGPTFM8",4,0)
 ; This routine has two entry points WD3 and SD3, called from
"RTN","DGPTFM8",5,0)
 ; DGPTFM. This entry points will display Additional PTF information
"RTN","DGPTFM8",6,0)
 ; on the <MAS> screen.
"RTN","DGPTFM8",7,0)
 ;
"RTN","DGPTFM8",8,0)
WD3 ;-- display infor for additional PTF questions by movement
"RTN","DGPTFM8",9,0)
 S DG300A="" I $D(M(J)),$D(^DGPT(PTF,"M",+M(J),300)) S DG300A=^(300)
"RTN","DGPTFM8",10,0)
 S DG300B="" I $D(M(J+1)),$D(^DGPT(PTF,"M",+M(J+1),300)) S DG300B=^(300)
"RTN","DGPTFM8",11,0)
 I DG300A']"",DG300B']"" G WD3Q
"RTN","DGPTFM8",12,0)
 S (DGCA,DGCB)=2
"RTN","DGPTFM8",13,0)
 D GETNUM^DGPTSCAN
"RTN","DGPTFM8",14,0)
 F DGI=0:0 S DGL=0,X=DGCA,DG300=DG300A D PRN1 S DGCA=X+1,DGL=1,X=DGCB,DG300=DG300B D PRN1 S DGCB=X+1 Q:(DGCA>DGFNUM)&(DGCB>DGFNUM)
"RTN","DGPTFM8",15,0)
WD3Q ;
"RTN","DGPTFM8",16,0)
 K DGFNUM,DGI,DG300,DG300A,DG300B,DGL,DGCA,DGCB
"RTN","DGPTFM8",17,0)
 Q
"RTN","DGPTFM8",18,0)
PRN1 ;-- display additional PTF question infomation
"RTN","DGPTFM8",19,0)
 I X=2,$P(DG300,U,2)]"" X:('DGL)!($X>40) "W !" W ?DGL*40+2,"Self Injury - "_$S($P(DG300,U,2)=1:"Attempted Suicide",$P(DG300,U,2)=2:"Accomplished Suicide",1:"Self Inflicted Injury") G PRNQ1
"RTN","DGPTFM8",20,0)
 S:X=2 X=3
"RTN","DGPTFM8",21,0)
 I X=3,$P(DG300,U,3)]"" X:('DGL)!($X>40) "W !" W ?DGL*40+2,"Legionnaire's - "_$S($P(DG300,U,3)=1:"Yes",1:"No") G PRNQ1
"RTN","DGPTFM8",22,0)
 S:X=3 X=4
"RTN","DGPTFM8",23,0)
 I X=4,$P(DG300,U,4)]"" X:('DGL)!($X>40) "W !" W ?DGL*40+2,"Substance - "_$S($D(^DIC(45.61,$P(DG300,U,4),0)):$P(^(0),U),1:"") G PRNQ1
"RTN","DGPTFM8",24,0)
 S:X=4 X=5
"RTN","DGPTFM8",25,0)
 S DGPSY=0 I "5,6,7"[X S X=7 F DGJ=5,6,7 I $P(DG300,U,DGJ)]"" S DGPSY=1 Q
"RTN","DGPTFM8",26,0)
 G PRNQ1:'DGPSY
"RTN","DGPTFM8",27,0)
 X:('DGL)!($X>40) "W !" W ?DGL*40+2,"Psy- CL:",+$P(DG300,U,5),?DGL*40+13," CR:",+$P(DG300,U,6),?DGL*40+21," HI:",+$P(DG300,U,7)
"RTN","DGPTFM8",28,0)
PRNQ1 ;
"RTN","DGPTFM8",29,0)
 K DGJ,DGPSY
"RTN","DGPTFM8",30,0)
 Q
"RTN","DGPTFM8",31,0)
SD3 ;-- tag for printing kidney donor source 
"RTN","DGPTFM8",32,0)
 ; call only by DGPTFM@SERV
"RTN","DGPTFM8",33,0)
 S DGL=0
"RTN","DGPTFM8",34,0)
 S DGSUR=J D:$D(S(DGSUR)) KID S DGL=1,DGSUR=J+1 D:$D(S(DGSUR)) KID
"RTN","DGPTFM8",35,0)
SD3Q K DGSUR,DGL
"RTN","DGPTFM8",36,0)
 Q
"RTN","DGPTFM8",37,0)
KID ;-- kidney transplant source
"RTN","DGPTFM8",38,0)
 W:('DGL)&($X>0) !
"RTN","DGPTFM8",39,0)
 I $D(^DGPT(PTF,"S",DGSUR,300)),$P(^(300),U)]"" W ?DGL*40+2,"Kidney - "_$S(+^(300)=1:"Live Donor",1:"Cadaver")
"RTN","DGPTFM8",40,0)
 Q
"RTN","DGPTFM8",41,0)
PRN2 ;-- display additional PTF question infomation
"RTN","DGPTFM8",42,0)
 I $P(DG300,U,2)]"" W !,"Self Injury - "_$S($P(DG300,U,2)=1:"Attempted Suicide",$P(DG300,U,2)=2:"Accomplished Suicide",1:"Self Inflicted Injury")
"RTN","DGPTFM8",43,0)
 I $P(DG300,U,3)]"" W !,"Legionnaire's - "_$S($P(DG300,U,3)=1:"Yes",1:"No")
"RTN","DGPTFM8",44,0)
 I $P(DG300,U,4)]"" W !,"Substance - "_$S($D(^DIC(45.61,$P(DG300,U,4),0)):$P(^(0),U),1:"")
"RTN","DGPTFM8",45,0)
 S DGPSY=0 F DGI=5,6,7 I $P(DG300,U,DGI)]"" S DGPSY=1 Q
"RTN","DGPTFM8",46,0)
 G PRNQ2:'DGPSY
"RTN","DGPTFM8",47,0)
 W !,"Psy - CL:",+$P(DG300,U,5),?12,"CR:",+$P(DG300,U,6),?19,"HI:",+$P(DG300,U,7)
"RTN","DGPTFM8",48,0)
PRNQ2 ;
"RTN","DGPTFM8",49,0)
 K DGI,DGPSY
"RTN","DGPTFM8",50,0)
 Q
"RTN","DGPTFM8",51,0)
PRN3 ;-- print kidney additional question
"RTN","DGPTFM8",52,0)
 I $P(DG300,U)]"" W !,"Kidney - "_$S(+DG300=1:"Live Donor",1:"Cadaver")
"RTN","DGPTFM8",53,0)
PRNQ3 ;
"RTN","DGPTFM8",54,0)
 Q
"RTN","DGPTFMO")
0^12^B26364577^B26139485
"RTN","DGPTFMO",1,0)
DGPTFMO ;ALB/JDS/ADL - DGPTF PRINT TEMPLATE ; 11/15/06 2:52pm
"RTN","DGPTFMO",2,0)
 ;;5.3;Registration;**195,397,510,590,594,606,683,729**;Aug 13, 1993;Build 59
"RTN","DGPTFMO",3,0)
 ;;ADL;Updated for CSV Project;;Mar 4, 2003
"RTN","DGPTFMO",4,0)
 ;FOR PTF REPORT CALLED FROM TEMPLATE DGPTF
"RTN","DGPTFMO",5,0)
EN K A,B,AD,ADA,DGDD,DGFC,HEAD,DGPTFE,DGST,DGN,T
"RTN","DGPTFMO",6,0)
 F I=0:0 S I=$O(^DGPT(D0,"M",I)) Q:I'>0  I $D(^(I,0)) S J=+$P(^(0),U,10) S:'J J=999999999 S:$D(T(J)) J=J+.01*I S T(J)=I
"RTN","DGPTFMO",7,0)
 F I=0:0 S I=$O(T(I)) Q:I'>0  S DGM=$S($D(^DGPT(D0,"M",T(I),0)):^(0),1:"") I DGM]"" D WRITE
"RTN","DGPTFMO",8,0)
 K T F I=0:0 S I=$O(^DGPT(D0,"S",I)) Q:I'>0  D SUR
"RTN","DGPTFMO",9,0)
 S DGOP1=$S($D(^DGPT(D0,"401P")):^("401P"),1:"") I DGOP1]"" D HEAD:$Y>(IOSL-10) G Q:'DN D PROC
"RTN","DGPTFMO",10,0)
 I $D(^DGPT(D0,"P")) D HEAD:$Y>(IOSL-10) G Q:'DN F I=0:0 S I=$O(^DGPT(D0,"P",I)) Q:I'>0  S DG601=^DGPT(D0,"P",I,0),Y=+DG601 D D^DGPTUTL W !!," Procedure Date: ",Y D 601
"RTN","DGPTFMO",11,0)
 S DGPT=$G(^DGPT(D0,70)) I DGPT]"" G Q:'DN D DXLS
"RTN","DGPTFMO",12,0)
 K %,DGL,DGM,DGPT,DGOP,DGOP1,DGF,DGP,DXLS,DGICD,L1,S1,T,J,K,DGPR,DGN,AGE,B,DA,DAM,DFN,DGST,DOB,DP,DRG,EXP,NO,P,PTF,DGPTFE,SD1,SEX,TAC,TRS,DGDS,DGTD,DGPROC,DG601,DGPTDAT
"RTN","DGPTFMO",13,0)
 W ! ;F I=$Y:1:IOSL-1 W !
"RTN","DGPTFMO",14,0)
 Q
"RTN","DGPTFMO",15,0)
WRITE D HEAD:$Y>(IOSL-12) G Q:'DN S Y=$P(DGM,U,10),DGL=+$P(DGM,U,2),DGL=$S($D(^DIC(42.4,DGL,0)):^(0),1:""),DGL=$P(DGL,U,1) D D^DGPTUTL
"RTN","DGPTFMO",16,0)
 W !!,"Movement Date: ",Y,?40,"Losing Specialty: ",$E(DGL,1,22),!,"Leave Days: ",$P(DGM,U,3),?40,"Pass Days: ",$P(DGM,U,4)
"RTN","DGPTFMO",17,0)
 W !,"Treated for SC condition: ",$S($P(DGM,U,18)=1:"Yes",1:"No")
"RTN","DGPTFMO",18,0)
 W:$P(DGM,U,31)'="" !,"Potentially Related to Combat: ",$S($P(DGM,U,31)="Y":"Yes",1:"No")
"RTN","DGPTFMO",19,0)
 W:$P(DGM,U,26)'="" !,"Treated for AO condition: ",$S($P(DGM,U,26)="Y":"Yes",1:"No")
"RTN","DGPTFMO",20,0)
 W:$P(DGM,U,27)'="" !,"Treated for IR condition: ",$S($P(DGM,U,27)="Y":"Yes",1:"No")
"RTN","DGPTFMO",21,0)
 W:$P(DGM,U,28)'="" !,"Treated for EC condition: ",$S($P(DGM,U,28)="Y":"Yes",1:"No")
"RTN","DGPTFMO",22,0)
 W:$P(DGM,U,29)'="" !,"Treated for MST condition: ",$S($P(DGM,U,29)="Y":"Yes",$P(DGM,U,29)="N":"No",1:"Declined to answer") ; added 6/17/98 for MST enhancement
"RTN","DGPTFMO",23,0)
 W:$P(DGM,U,30)'="" !,"Treated for HEAD/NECK CA condition: ",$S($P(DGM,U,30)="Y":"Yes",1:"No")
"RTN","DGPTFMO",24,0)
 W:T(I)=1 !,"Discharge "
"RTN","DGPTFMO",25,0)
 S DGF="" F J=5:1:15 I J#10 S DGPTTMP=$$ICDDX^ICDCODE(+$P(DGM,U,J),$$GETDATE^ICDGTDRG(D0)),DGICD=$S(+DGPTTMP>0:$P(DGPTTMP,U,2,99),1:"") I DGICD]"" D 
"RTN","DGPTFMO",26,0)
 . W:DGF="" !!?13,"DX: " W $P(DGICD,U,3)_" ("_$P(DGICD,U)_")",!?17 S DGF=1
"RTN","DGPTFMO",27,0)
 ;-- display expanded codes 
"RTN","DGPTFMO",28,0)
 S DG300=$S($D(^DGPT(D0,"M",T(I),300)):^(300),1:"") I DG300]"" D HEAD:$Y>(IOSL-6) D PRN2^DGPTFM8 W !
"RTN","DGPTFMO",29,0)
 K DG300
"RTN","DGPTFMO",30,0)
 ;Display TRANSFER DRG with description
"RTN","DGPTFMO",31,0)
 Q:'$D(^DGPT(D0,"M",T(I),"P"))  S DGTD=+^("P") Q:'$D(^ICD(DGTD,0))  W !?3,"TRANSFER DRG: ",DGTD," - "
"RTN","DGPTFMO",32,0)
 N DXD,DGDX
"RTN","DGPTFMO",33,0)
 S DXD=$$DRGD^ICDGTDRG(DGTD,"DGDX",,$$GETDATE^ICDGTDRG(D0)),DGDS=0
"RTN","DGPTFMO",34,0)
 F  S DGDS=$O(DGDX(DGDS)) Q:'+DGDS  Q:DGDX(DGDS)=" "  W !,DGDX(DGDS)
"RTN","DGPTFMO",35,0)
 Q
"RTN","DGPTFMO",36,0)
HEAD I $E(IOST,1)="C" W *7 R X:DTIME I X=U S DN=0 Q
"RTN","DGPTFMO",37,0)
 S DC=DC+1 W @IOF,! X:$D(^UTILITY($J,2)) ^(2) W ! F K=1:1:IOM W "_"
"RTN","DGPTFMO",38,0)
 W !,"("_$P(^DPT(+^DGPT(D0,0),0),U,1)_")",!
"RTN","DGPTFMO",39,0)
 Q
"RTN","DGPTFMO",40,0)
SUR D HEAD:$Y>(IOSL-7) G Q:'DN S S1=^DGPT(D0,"S",I,0),Y=+S1 D D^DGPTUTL W !!,"   Date of Surg: ",Y,?45,"Chief Surg: " S L=";"_$P(^DD(45.01,4,0),U,3),L1=";"_$P(S1,U,4)_":" W $P($P(L,L1,2),";",1)
"RTN","DGPTFMO",41,0)
 W !,"    Anesth Tech: " S L=";"_$P(^DD(45.01,6,0),U,3),L1=";"_$P(S1,U,6)_":" W $P($P(L,L1,2),";",1),?45,"First Asst: " S L=";"_$P(^DD(45.01,5,0),U,3),L1=";"_$P(S1,U,5)_":" W $P($P(L,L1,2),";",1)
"RTN","DGPTFMO",42,0)
 W !,"  Source of pay: " S L=";"_$P(^DD(45.01,7,0),U,3),L1=";"_$P(S1,U,7)_":" W $P($P(L,L1,2),";",1)
"RTN","DGPTFMO",43,0)
 W ?46,"Surg spec: ",$S($D(^DIC(45.3,+$P(S1,U,3),0)):$P(^(0),U,2),1:"")
"RTN","DGPTFMO",44,0)
 W !!,?7,"Surg/pro: " F K=1:1:5 S L=$P(S1,U,K+7) I L'="" S DGPTTMP=$$ICDOP^ICDCODE(+L,$$GETDATE^ICDGTDRG(D0)) W $S(+DGPTTMP>0:$P(DGPTTMP,U,5)_" ("_$P(DGPTTMP,U,2)_")",1:"**********-"_L),!?17
"RTN","DGPTFMO",45,0)
 ;-- display expanded codes
"RTN","DGPTFMO",46,0)
 S DG300=$S($D(^DGPT(D0,"S",I,300)):^(300),1:"") I DG300]"" D PRN3^DGPTFM8
"RTN","DGPTFMO",47,0)
 K DG300
"RTN","DGPTFMO",48,0)
 Q
"RTN","DGPTFMO",49,0)
PROC S DGF="" F I=1:1:5 S DGPTTMP=$$ICDOP^ICDCODE(+$P(DGOP1,U,I),$$GETDATE^ICDGTDRG(D0)),DGOP=$S(DGPTTMP>0:$P(DGPTTMP,U,2,99),1:"") I DGOP D 
"RTN","DGPTFMO",50,0)
 . W:'DGF !!?6,"Procedure: " W $P(DGOP,U,4)_" ("_$P(DGOP,U)_")",!?17 S DGF=1
"RTN","DGPTFMO",51,0)
 Q
"RTN","DGPTFMO",52,0)
601 ;print the procedures/dates from the 601 procedure multiple (eff. 10/1/87)
"RTN","DGPTFMO",53,0)
 F J=5:1:9 S DGPTTMP=$$ICDOP^ICDCODE(+$P(DG601,U,J),$$GETDATE^ICDGTDRG(D0)),DGPROC=$S(+DGPTTMP>0:$P(DGPTTMP,U,2,99),1:"") I DGPROC W !?17,$P(DGPROC,U,4)_" ("_$P(DGPROC,U)_")"
"RTN","DGPTFMO",54,0)
 Q
"RTN","DGPTFMO",55,0)
DXLS D HEAD:$Y>(IOSL-16) S DGPTDAT=$$GETDATE^ICDGTDRG(D0)
"RTN","DGPTFMO",56,0)
 S DGPTTMP=$$ICDDX^ICDCODE(+$P(DGPT,U,10),DGPTDAT),DXLS=$S(+DGPTTMP>0:$P(DGPTTMP,U,2,99),1:"") I DXLS]"" W !!?11,"PRINCIPAL DIAGNOSIS: ",$P(DXLS,U,3)_" ("_$P(DXLS,U)_")"
"RTN","DGPTFMO",57,0)
 I 'DXLS S DGPTTMP=$$ICDDX^ICDCODE(+$P(DGPT,U,11),DGPTDAT),DGP=$S(+DGPTTMP>0:$P(DGPTTMP,U,2,99),1:"") I DGP]"" W !!," Principal Diag: ",$P(DGP,U,3)_" ("_$P(DGP,U)_")"
"RTN","DGPTFMO",58,0)
 S K=DGPT F I=16:1:24 D DSP
"RTN","DGPTFMO",59,0)
 S K=$G(^DGPT(D0,71)) F I=1:1:4 D DSP
"RTN","DGPTFMO",60,0)
 ;-- display expanded code information
"RTN","DGPTFMO",61,0)
 S DG300=$S($D(^DGPT(D0,300)):^(300),1:"") D:DG300]"" PRN2^DGPTFM8 K DG300
"RTN","DGPTFMO",62,0)
 D EN2^DGPTF4 Q
"RTN","DGPTFMO",63,0)
Q Q
"RTN","DGPTFMO",64,0)
Q1 K ^UTILITY(U,$J),DG1 Q
"RTN","DGPTFMO",65,0)
DT I Y W $P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC",U,$E(Y,4,5))," " W:Y#100 $J(Y#100\1,2),"," W Y\10000+1700 W:Y#1 "  ",$E(Y_0,9,10),":",$E(Y_"000",11,12)
"RTN","DGPTFMO",66,0)
 Q
"RTN","DGPTFMO",67,0)
DSP S J=$$ICDDX^ICDCODE(+$P(K,U,I),DGPTDAT) I J&$P(J,U,10) D
"RTN","DGPTFMO",68,0)
 .I I#2 W ?40,$P(J,U,4)_"("_$P(J,U,2)_")" Q
"RTN","DGPTFMO",69,0)
 .W !,$P(J,U,4)_"("_$P(J,U,2)_")"
"RTN","DGPTFMO",70,0)
 Q
"RTN","DGPTFQWK")
0^34^B20032997^B17529486
"RTN","DGPTFQWK",1,0)
DGPTFQWK ;ALB/AS - QUICK/LOAD PTF DATA ;7/21/05 2:44pm
"RTN","DGPTFQWK",2,0)
 ;;5.3;Registration;**517,594,635,729**;Aug 13, 1993;Build 59
"RTN","DGPTFQWK",3,0)
 ;
"RTN","DGPTFQWK",4,0)
 S (DGPTF,DA)=PTF,DIE="^DGPT(",DR="[DGQWK"_$S('DGPTFE:"]",1:"F]") W !,"* editing 101 & 701 transactions" D ^DIE S DR="[DG701]" D ^DIE W !,"* editing 501 transactions"
"RTN","DGPTFQWK",5,0)
 F DGM=0:0 D S501 Q:Y'>0  K DA S (DGPTF,DA)=PTF S DGMOV=+Y,DGJUMP=$S('DGPTFE:"",1:"1-2"),DR=$S('DGPTFE:"[DG501]",1:"[DG501F]"),DIE="^DGPT(" D ^DIE,CHK501^DGPTSCAN K DGMOV
"RTN","DGPTFQWK",6,0)
 K DIC,DA,DR,DIE
"RTN","DGPTFQWK",7,0)
 W !,"* editing 401 transactions"
"RTN","DGPTFQWK",8,0)
 F DGM=0:0 D S401 Q:Y'>0  K DA S DGSUR=+Y,DGJUMP="1-2",DR="[DG401]",DIE="^DGPT(",(DA,DGPTF)=PTF D ^DIE,CHK401^DGPTSCAN K DGSUR
"RTN","DGPTFQWK",9,0)
 I '$P(^DGPT(PTF,0),U,4) W !,"* editing 801 transactions" D S801
"RTN","DGPTFQWK",10,0)
 K DIC,DA,DR,DIE
"RTN","DGPTFQWK",11,0)
 W !,"* editing 601 transactions"
"RTN","DGPTFQWK",12,0)
 F DGM=0:0 S DGZP=1 D S601 Q:Y'>0  K DA S P(DGZP,1)=+Y,DGJUMP="1-2",DR="[DG601]",DIE="^DGPT(",(DA,DGPTF)=PTF D ^DIE,CHK601^DGPTSCAN K P
"RTN","DGPTFQWK",13,0)
 K DIC,DA,DR,DIE
"RTN","DGPTFQWK",14,0)
 ;S DR="60",DR(2,45.05)=".01;2;S:'X Y=4;3;4:8",DIE="^DGPT(",DA=PTF D ^DIE
"RTN","DGPTFQWK",15,0)
 I '$P(^DGPT(PTF,0),"^",4)&('DGST) W !,"  Updating TRANSFER DRGs" S DGADM=$P(^DGPT(PTF,0),U,2) D SUDO1^DGPTSUDO
"RTN","DGPTFQWK",16,0)
 K DGM,DA,DGMOVENO,DIC,DIE,DR,Y,DGPTF,DGJUMP Q
"RTN","DGPTFQWK",17,0)
S501 ;-- set up 501 
"RTN","DGPTFQWK",18,0)
 S DA(1)=PTF,DIC("A")="Select 501 MOVEMENT NUMBER: ",DIC(0)="AEQ",DIC="^DGPT("_PTF_",""M""," S:'$D(^DGPT(PTF,"M",0)) ^(0)="^45.02AI^^" D ^DIC
"RTN","DGPTFQWK",19,0)
 K DA,DIC
"RTN","DGPTFQWK",20,0)
 Q
"RTN","DGPTFQWK",21,0)
 ;
"RTN","DGPTFQWK",22,0)
S401 ;-- set up 401
"RTN","DGPTFQWK",23,0)
 S DA(1)=PTF,DIC("A")="Select 401 SURGERY DATE: ",DIC(0)="AEQL",DIC="^DGPT("_PTF_",""S""," S:'$D(^DGPT(PTF,"S",0)) ^(0)="^45.01DA^^" D ^DIC
"RTN","DGPTFQWK",24,0)
 K DA,DIC
"RTN","DGPTFQWK",25,0)
 Q
"RTN","DGPTFQWK",26,0)
 ;
"RTN","DGPTFQWK",27,0)
S601 ;-- set up 601
"RTN","DGPTFQWK",28,0)
 S DA(1)=PTF,DIC("A")="Select 601 PROCEDURE DATE: ",DIC(0)="AEQL",DIC="^DGPT("_PTF_",""P""," S:'$D(^DGPT(PTF,"P",0)) ^(0)="^45.05DA^^" D ^DIC
"RTN","DGPTFQWK",29,0)
 K DA,DIC
"RTN","DGPTFQWK",30,0)
 Q
"RTN","DGPTFQWK",31,0)
S801 ;-- set up 801
"RTN","DGPTFQWK",32,0)
 F  D  D REQ:$D(PSIEN) Q:$G(RFL)=1!(Y<0)  D PCE
"RTN","DGPTFQWK",33,0)
 .S DIC("A")="Select 801 CPT DATE/TIME: "
"RTN","DGPTFQWK",34,0)
 .S DA(1)=PTF,DIC(0)="AEQLZ",DIC="^DGPT("_PTF_",""C"",",DLAYGO=45
"RTN","DGPTFQWK",35,0)
 .S:'$D(^DGPT(PTF,"C",0)) ^(0)="^45.06^^" D ^DIC
"RTN","DGPTFQWK",36,0)
 .K DA,DIC,PSIEN Q:Y'>0  S DGPRD=+Y(0),DGPSM=+Y D MOB^DGPTFM2 I $P(DGZPRF,U,3) F I=1:1:$P(DGZPRF,U,3) S:DGZPRF(I,0)=DGPSM DGZP=I
"RTN","DGPTFQWK",37,0)
 .S (DA(1),REC)=PTF,DIE="^DGPT("_PTF_",""C"",",(DA,PSIEN)=DGZPRF(DGZP,0),DR=".02;.03;.05" D FMDIE I $D(Y)>9!$D(DTOUT) S Y=-1 Q
"RTN","DGPTFQWK",38,0)
 .S DGI=0,DR=".01;" D CL^SDCO21(DFN,DGPRD,"",.SDCLY) D  S Y=1
"RTN","DGPTFQWK",39,0)
 ..F  S DGI=$O(^DGCPT(46,"C",PTF,DGI)) Q:DGI'>0  I +^DGCPT(46,DGI,1)=+DGZPRF(DGZP)&'$D(^(9)) S (DA,REC)=DGI,DR=".01;",DIE="^DGCPT(46," D GETINFO^DGPTFM21
"RTN","DGPTFQWK",40,0)
 ..F  S DA=PTF,DIC="^DGCPT(46,",DIC(0)="AELQMZ",DLAYGO=46,DIC("S")="D EN6^DGPTFJC I 'DGER" D ^DIC K DIC Q:Y'>0  D SED^DGPTFM2
"RTN","DGPTFQWK",41,0)
 ..S Y=1
"RTN","DGPTFQWK",42,0)
 K DR,DIE,DIC,DA,DGI,DGJUMP,DGPRD,DLAYGO,RFL Q
"RTN","DGPTFQWK",43,0)
REQ ;CHECK FOR REQUIRED FIELDS IN CPT RECORDS.  RECORDS MISSING ONE OR MORE REQUIRED FIELDS ARE DELETED.
"RTN","DGPTFQWK",44,0)
 S RFL=0 I '$P(^DGPT(PTF,"C",PSIEN,0),U,3) S DA(1)=PTF,DA=DGPSM,DIK="^DGPT("_PTF_",""C""," D  G REQQ
"RTN","DGPTFQWK",45,0)
 .D ^DIK K DA W !!,"No CPT records have been filed because no performing provider was specified." S RFL=1
"RTN","DGPTFQWK",46,0)
 S (I,FCPT)=0 D RESEQ^DGPTFM3(PTF)
"RTN","DGPTFQWK",47,0)
 F J=1:1 S I=$O(^DGCPT(46,"C",PTF,I)) Q:'I  D:+^DGCPT(46,I,1)=DGPRD&'$G(^(9))
"RTN","DGPTFQWK",48,0)
 .I $P(^DGCPT(46,I,0),U,4) S FCPT=1 Q
"RTN","DGPTFQWK",49,0)
 .S DA=I,DIK="^DGCPT(46,",CPT=+^DGCPT(46,I,0) D ^DIK
"RTN","DGPTFQWK",50,0)
 .W !!,"CPT " S N=$$CPT^ICPTCOD(CPT,$$GETDATE^ICDGTDRG(PTF)) W $P(N,U,2)," ",$P(N,U,3)," not filed because no diagnosis 1 was entered."
"RTN","DGPTFQWK",51,0)
 .S RFL=2
"RTN","DGPTFQWK",52,0)
 I FCPT K FCPT,I,J,N G REQQ
"RTN","DGPTFQWK",53,0)
 S DA(1)=PTF,DA=PSIEN,DIK="^DGPT("_PTF_",""C"","
"RTN","DGPTFQWK",54,0)
 D ^DIK K DA W !!,"No CPT records have been filed because no CPT codes were filed." S RFL=1 K FCPT,I,J,N
"RTN","DGPTFQWK",55,0)
REQQ ;D RESEQ^DGPTFM3(PTF)
"RTN","DGPTFQWK",56,0)
 Q
"RTN","DGPTFQWK",57,0)
SED S DR=".14////"_DGPRD_";.16////"_PTF_";",DA=+Y,DIE="^DGCPT(46,"
"RTN","DGPTFQWK",58,0)
 S REC=PTF D SDR^DGPTFM21,FMDIE Q
"RTN","DGPTFQWK",59,0)
PCE S DIR("A")="Send record to PCE? ",DIR(0)="S^Y:YES;N:NO",DIR("B")="NO"
"RTN","DGPTFQWK",60,0)
 D ^DIR K DIR Q:Y="N"!$D(DIRUT)
"RTN","DGPTFQWK",61,0)
 D MOB^DGPTFM2 S RES=$$DATA2PCE^DGAPI1(DFN,PTF,DGZP)
"RTN","DGPTFQWK",62,0)
 I RES=1 L -^DGPT(PTF) W !,"PTF Record sent to PCE" H 2 Q
"RTN","DGPTFQWK",63,0)
 W @IOF
"RTN","DGPTFQWK",64,0)
 ;F I=1:1 Q:'$D(^TMP("DGPAPI",$J,"DIERR",$J,1,"TEXT",I))  W !,^(I)
"RTN","DGPTFQWK",65,0)
 W !,"The PTF Record may not have been filed in PCE due to errors."
"RTN","DGPTFQWK",66,0)
 W !,"Press return to continue." R X:DTIME
"RTN","DGPTFQWK",67,0)
 L -^DGPT(PTF) Q
"RTN","DGPTFQWK",68,0)
FMDIE L +^DGPT(45,REC):2
"RTN","DGPTFQWK",69,0)
 I  D ^DIE S RES=$$DELVFILE^DGAPI1(DFN,PTF,DGZP) L -^DGPT(45,REC) Q
"RTN","DGPTFQWK",70,0)
ERR W !,"CPT record is being edited by another user" K DIE,REC S ERRFKG=1 H 2 Q
"RTN","DGPTFTR2")
0^37^B15450104^B14013404
"RTN","DGPTFTR2",1,0)
DGPTFTR2 ;ALB/JDS - ALB/BOK  PTF TRANSMISSION ; 01 DEC 87 @0800
"RTN","DGPTFTR2",2,0)
 ;;5.3;Registration;**729**;Aug 13, 1993;Build 59
"RTN","DGPTFTR2",3,0)
501 ;
"RTN","DGPTFTR2",4,0)
 K DGCMVT I T2'=9999999 S DGCMVT=$O(^DGPT(J,"M","AM",+$P(T2,".")_".2359")),DGCMVT=$S('DGCMVT:1,$O(^(DGCMVT,0)):$O(^(0)),1:1)
"RTN","DGPTFTR2",5,0)
 F I=0:0 S I=$O(^DGPT(J,"M",I)) G PROC:I'>0 I $D(^(I,0)) S DGM=^(0),DGTD=$P(DGM,U,10) S:$D(DGCMVT) DGTD=$S(I=DGCMVT:$P(T2,".")_".2359",1:DGTD) I $P(DGM,U,17)'="n",DGTD,DGTD'<T1,DGTD'>T2 D MOV
"RTN","DGPTFTR2",6,0)
MOV S DGM=$P(DGM,U,1,9)_U_$P(DGM,U,11,15),L=1
"RTN","DGPTFTR2",7,0)
 F Z=5:1:14 S:'$P(DGM,U,Z) DGM=$P(DGM,U,1,Z-1)_U_$P(DGM,U,Z+1,99) S:'$P(DGM,U,Z) Z=Z-1 S L=L+1 Q:L=10
"RTN","DGPTFTR2",8,0)
 S Y=$S(T1:"C",1:"N")_"501"_DGHEAD,X=$P(DGTD,".")_"       ",Y=Y_$E(X,4,5)_$E(X,6,7)_$E(X,2,3)
"RTN","DGPTFTR2",9,0)
 N DGSARRX,DGSARRY
"RTN","DGPTFTR2",10,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(DGM,U,2),.DGARRY)
"RTN","DGPTFTR2",11,0)
 S $P(DGM,U,2)=$G(DGARRY(7))
"RTN","DGPTFTR2",12,0)
 S L=2,X=DGM,Z=2 D ENTER0 S Y=Y_"  "
"RTN","DGPTFTR2",13,0)
 S L=3 F Z=3,4 D ENTER0
"RTN","DGPTFTR2",14,0)
 S L=1,X=DG57,Z=4 D ENTER S:I=1 DG502=Y
"RTN","DGPTFTR2",15,0)
 F Z=5:1:9 S F=$S($D(^ICD9(+$P(DGM,U,Z),0)):$P(^(0),U,1),1:"   ."),F=$P(F,".",1)_$E($P(F,".",2)_"    ",1,3),F=F_$E("      ",1,7-$L(F)),Y=Y_F
"RTN","DGPTFTR2",16,0)
 ; bed occupant
"RTN","DGPTFTR2",17,0)
 I T1 S Y=Y_$S(I=1:$E($P(DG70,U,14)_" "),$P(+DGTD,".")=$P(T2,"."):5,1:1)
"RTN","DGPTFTR2",18,0)
 I 'T1 S Y=Y_$S(I=1:$E($P(DG70,U,14)_" "),1:" ")
"RTN","DGPTFTR2",19,0)
 D SAVE
"RTN","DGPTFTR2",20,0)
 Q
"RTN","DGPTFTR2",21,0)
 ;
"RTN","DGPTFTR2",22,0)
PROC K DGCMVT,^UTILITY($J,"PROC") S I=0
"RTN","DGPTFTR2",23,0)
601 S I=$O(^DGPT(J,"P",I)) G 701:I'>0 S (X,DGPROC)=^(I,0) G 601:'DGPROC
"RTN","DGPTFTR2",24,0)
 G 601:DGPROC<T1!(DGPROC>T2) S DGPROCD=+^DGPT(J,"P",I,0)\1,^UTILITY($J,"PROC",DGPROCD)=$S($D(^UTILITY($J,"PROC",DGPROCD)):^(DGPROCD),1:0)+1
"RTN","DGPTFTR2",25,0)
 I ^UTILITY($J,"PROC",DGPROCD)>1 W !,"More than one procedure record on same date" S DGERR=1 Q
"RTN","DGPTFTR2",26,0)
 S Y=$S('T1:"N",1:"C")_"60"_^(DGPROCD)_DGHEAD_$E(DGPROCD,4,7)_$E(DGPROCD,2,3)
"RTN","DGPTFTR2",27,0)
 N DGARRY,DGARRX ;DG729
"RTN","DGPTFTR2",28,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(X,U,2),.DGARRY)
"RTN","DGPTFTR2",29,0)
 S $P(X,U,2)=$G(DGARRY(7))
"RTN","DGPTFTR2",30,0)
 S L=2,Z=2 D ENTER0 S L=1,Z=3 D ENTER S L=3,Z=4 D ENTER0
"RTN","DGPTFTR2",31,0)
 S L=1 F K=5:1:9 S:'$P(DGPROC,U,K) DGPROC=$P(DGPROC,U,1,K-1)_U_$P(DGPROC,U,K+1,99),K=K-1 S L=L+1 Q:L=5
"RTN","DGPTFTR2",32,0)
 F K=5:1:9 S Y=Y_$S($D(^ICD0(+$P(DGPROC,U,K),0)):$J($P($P(^(0),U,1),".",1),2)_$E($P($P(^(0),U,1),".",2)_"   ",1,3),1:"     ")_"  "
"RTN","DGPTFTR2",33,0)
 S Y=Y_"      " D SAVE G 601
"RTN","DGPTFTR2",34,0)
 Q
"RTN","DGPTFTR2",35,0)
 ;
"RTN","DGPTFTR2",36,0)
701 S Y=$S(T1:"C",1:"N")_"701"_DGHEAD,DGDDX=+DG70\1_"       ",Y=Y_$E(DGDDX,4,5)_$E(DGDDX,6,7)_$E(DGDDX,2,3)
"RTN","DGPTFTR2",37,0)
 S X=DG70
"RTN","DGPTFTR2",38,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTFTR2",39,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(X,U,2),.DGARRY)
"RTN","DGPTFTR2",40,0)
 S $P(X,U,2)=$G(DGARRY(7))
"RTN","DGPTFTR2",41,0)
 S (L,Z)=2 D ENTER0 S Y=Y_"  " K DGDDX
"RTN","DGPTFTR2",42,0)
 S X=DG70 I "467"[($P(X,U,3)\1) S Y=Y_$P(X,U,3)_"         " G J
"RTN","DGPTFTR2",43,0)
 S L=1 F Z=3:1:5 D ENTER
"RTN","DGPTFTR2",44,0)
 S Y=Y_$S($D(^DIC(45.6,+$P(X,U,6),0)):$P(^(0),U,2),1:" "),L=3,Z=12 D ENTER S Y=Y_$E($P(X,U,13)_"   ",1,3)
"RTN","DGPTFTR2",45,0)
J S L=3,Z=8 D ENTER0
"RTN","DGPTFTR2",46,0)
 S Y=Y_$S($D(^DIC(10,+$P(DG10,U,6),0)):$J($P(^(0),U,2),1),1:" ")_$J($P(DG70,U,9),1)
"RTN","DGPTFTR2",47,0)
 S DGXLS=$S($D(^ICD9(+$P(DG70,U,10),0)):$P(^(0),U,1),1:""),Y=Y_$S(DGXLS[".":$J($P(DGXLS,".",1),3)_$E($P(DGXLS,".",2)_"   ",1,3),1:$J(DGXLS,6))_" "
"RTN","DGPTFTR2",48,0)
 S L=$P(DG70,U,16,24) S DG702="" F K=1:1:9 I $D(^ICD9(+$P(L,U,K),0)) S DG702=DG702_$P(^(0),U,1)_U
"RTN","DGPTFTR2",49,0)
 I DG702']"" S Y=Y_"X"
"RTN","DGPTFTR2",50,0)
 D Y
"RTN","DGPTFTR2",51,0)
 I T1 F K=34:1:47,60 S Y=$E(Y,1,K-1)_" "_$E(Y,K+1,80)
"RTN","DGPTFTR2",52,0)
 I T1 D CEN^DGPTFTR1 S:'DGERR ^UTILITY($J,DGCNT,0)=Y,DGCNT=DGCNT+1 Q
"RTN","DGPTFTR2",53,0)
 I 'T1 D SAVE
"RTN","DGPTFTR2",54,0)
702 ;
"RTN","DGPTFTR2",55,0)
 Q:DG702']""
"RTN","DGPTFTR2",56,0)
 S Y="N702"_$E(Y,5,33)
"RTN","DGPTFTR2",57,0)
 F K=1:1:5 S F=$P(DG702,U,K),F=$P(F,".",1)_$E($P(F,".",2)_"   ",1,3),F=F_$E("      ",1,7-$L(F)),Y=Y_F
"RTN","DGPTFTR2",58,0)
 D Y
"RTN","DGPTFTR2",59,0)
 I 'DGERR S ^UTILITY($J,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTFTR2",60,0)
 S DG702=$P(DG702,U,6,9)
"RTN","DGPTFTR2",61,0)
 ;
"RTN","DGPTFTR2",62,0)
703 Q:DG702']""
"RTN","DGPTFTR2",63,0)
 S Y="N703"_$E(Y,5,33)
"RTN","DGPTFTR2",64,0)
 F K=1:1:4 S F=$P(DG702,U,K),F=$P(F,".",1)_$E($P(F,".",2)_"   ",1,3),F=F_$E("      ",1,7-$L(F)),Y=Y_F
"RTN","DGPTFTR2",65,0)
 D Y
"RTN","DGPTFTR2",66,0)
 I 'DGERR S ^UTILITY($J,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTFTR2",67,0)
 Q
"RTN","DGPTFTR2",68,0)
 ;
"RTN","DGPTFTR2",69,0)
ENTER S Y=Y_$J($P(X,U,Z),L)
"RTN","DGPTFTR2",70,0)
 Q
"RTN","DGPTFTR2",71,0)
 ;
"RTN","DGPTFTR2",72,0)
ENTER0 S Y=Y_$S($P(X,U,Z)]"":$E("00000",$L($P(X,U,Z))+1,L)_$P(X,U,Z),1:$J($P(X,U,Z),L))
"RTN","DGPTFTR2",73,0)
 Q
"RTN","DGPTFTR2",74,0)
 ;
"RTN","DGPTFTR2",75,0)
SAVE D START^DGPTFTR1 S:'DGERR ^UTILITY($J,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTFTR2",76,0)
Q Q
"RTN","DGPTFTR2",77,0)
 ;
"RTN","DGPTFTR2",78,0)
Y F K=$L(Y):1:79 S Y=Y_" "
"RTN","DGPTFVC3")
0^24^B10783685^B12511470
"RTN","DGPTFVC3",1,0)
DGPTFVC3 ;ALB/MTC - VAILIDATION CHECK FOR PTF ADDITIONAL QUESTIONS ; 18 MAR 91
"RTN","DGPTFVC3",2,0)
 ;;5.3;Registration;**164,729**;Aug 13, 1993;Build 59
"RTN","DGPTFVC3",3,0)
 ;
"RTN","DGPTFVC3",4,0)
 ; Called by Q+2^DGPTFTR
"RTN","DGPTFVC3",5,0)
 ; Variable Passed In:  PTF - Current PTF record.
"RTN","DGPTFVC3",6,0)
 ; Variable Returned :  DGERR - 1 if fails else "" 
"RTN","DGPTFVC3",7,0)
 ;
"RTN","DGPTFVC3",8,0)
EN ;
"RTN","DGPTFVC3",9,0)
 D INIT G:DGOUT ENQ
"RTN","DGPTFVC3",10,0)
 D 401,501,701
"RTN","DGPTFVC3",11,0)
ENQ ;
"RTN","DGPTFVC3",12,0)
 K DGPTF,DGHOLD,DGMOV,DGJ,DGBPC,DGPTIT,DGOUT,DGSUR,DGREC
"RTN","DGPTFVC3",13,0)
 Q
"RTN","DGPTFVC3",14,0)
501 ;-- check 501's for inconsistent data
"RTN","DGPTFVC3",15,0)
 K DGPTIT
"RTN","DGPTFVC3",16,0)
 F DGMOV=0:0 S DGMOV=$O(^DGPT(DGPTF,"M",DGMOV)) Q:DGMOV'>0  I $D(^DGPT(DGPTF,"M",DGMOV,0)) S DGHOLD=^(0) D CHKFL5
"RTN","DGPTFVC3",17,0)
 K DGMOV
"RTN","DGPTFVC3",18,0)
 Q
"RTN","DGPTFVC3",19,0)
 ;
"RTN","DGPTFVC3",20,0)
CHKFL5 ;-- check field entries
"RTN","DGPTFVC3",21,0)
 F DGJ=5:1:9 I $P(DGHOLD,U,DGJ)]"" S DGPTIT($P(DGHOLD,U,DGJ)_";ICD9(")=""
"RTN","DGPTFVC3",22,0)
 D DC^DGPTSCAN,SCAN^DGPTSCAN
"RTN","DGPTFVC3",23,0)
 I '$D(DGBPC),'$D(^DGPT(DGPTF,"M",DGMOV,300)) G CHK5Q
"RTN","DGPTFVC3",24,0)
 S DGHOLD=$S($D(^DGPT(DGPTF,"M",DGMOV,300)):^(300),1:"")
"RTN","DGPTFVC3",25,0)
 D GETNUM^DGPTSCAN
"RTN","DGPTFVC3",26,0)
 ;F DGII=2:1:DGFNUM I ('$D(DGBPC(DGII))&($P(DGHOLD,U,DGII)]""))!($D(DGBPC(DGII))&($P(DGHOLD,U,DGII)']"")) S DGERR=1 D W501
"RTN","DGPTFVC3",27,0)
 F DGII=2:1:DGFNUM I ($D(DGBPC(DGII))&($P(DGHOLD,U,DGII)']"")) S DGERR=1 D W501
"RTN","DGPTFVC3",28,0)
 ;
"RTN","DGPTFVC3",29,0)
CHK5Q K DGFNUM,DGII,DGBPC,DGPTIT
"RTN","DGPTFVC3",30,0)
 Q
"RTN","DGPTFVC3",31,0)
 ;
"RTN","DGPTFVC3",32,0)
401 ;-- check 401's for inconsistent data
"RTN","DGPTFVC3",33,0)
 K DGPTIT
"RTN","DGPTFVC3",34,0)
 F DGSUR=0:0 S DGSUR=$O(^DGPT(DGPTF,"S",DGSUR)) Q:DGSUR'>0  I $D(^DGPT(DGPTF,"S",DGSUR,0)) S DGHOLD=^(0) D CHKFL4
"RTN","DGPTFVC3",35,0)
 Q
"RTN","DGPTFVC3",36,0)
 ;
"RTN","DGPTFVC3",37,0)
CHKFL4 ;-- check field entries
"RTN","DGPTFVC3",38,0)
 F DGJ=8:1:12 I $P(DGHOLD,U,DGJ)]"" S DGPTIT($P(DGHOLD,U,DGJ)_";ICD0(")=""
"RTN","DGPTFVC3",39,0)
 D DC^DGPTSCAN,SCAN^DGPTSCAN
"RTN","DGPTFVC3",40,0)
 I '$D(DGBPC),'$D(^DGPT(DGPTF,"S",+DGSUR,300)) G CHK4Q
"RTN","DGPTFVC3",41,0)
 S DGHOLD=$S($D(^DGPT(DGPTF,"S",+DGSUR,300)):^(300),1:"")
"RTN","DGPTFVC3",42,0)
 ;I ('$D(DGBPC(1))&($P(DGHOLD,U)]""))!($D(DGBPC(1))&($P(DGHOLD,U)']"")) S DGERR=1 D W401
"RTN","DGPTFVC3",43,0)
 I ($D(DGBPC(1))&($P(DGHOLD,U)']"")) S DGERR=1 D W401
"RTN","DGPTFVC3",44,0)
CHK4Q K DGBPC,DGPTIT
"RTN","DGPTFVC3",45,0)
 Q
"RTN","DGPTFVC3",46,0)
 ;
"RTN","DGPTFVC3",47,0)
701 ;-- process 701 load DGPTIT array
"RTN","DGPTFVC3",48,0)
 K DGPTIT
"RTN","DGPTFVC3",49,0)
 G CHK7Q:'$D(^DGPT(DGPTF,70)) S DGREC=^(70)
"RTN","DGPTFVC3",50,0)
 F DGI=10,16:1:24 I $P(DGREC,U,DGI) S DGPTIT($P(DGREC,U,DGI)_";ICD9(")=""
"RTN","DGPTFVC3",51,0)
 D DC^DGPTSCAN,SCAN^DGPTSCAN,ANYPSY^DGPTSCAN
"RTN","DGPTFVC3",52,0)
 I '$D(DGBPC),'$D(^DGPT(DGPTF,"M")) G CHK7Q
"RTN","DGPTFVC3",53,0)
 S DGTREC=$S($D(^DGPT(DGPTF,300)):^(300),1:"")
"RTN","DGPTFVC3",54,0)
 S DG701="" D FLAGCHK^DGPTSCAN
"RTN","DGPTFVC3",55,0)
 D GETNUM^DGPTSCAN
"RTN","DGPTFVC3",56,0)
 ;F DGII=2:1:DGFNUM I $D(DGBPC(DGII))&($P(DGTREC,U,DGII)']"")!('$D(DGBPC(DGII))&($P(DG701,U,DGII)]"")&($P(DGTREC,U,DGII)']""))!('$D(DGBPC(DGII))&($P(DGTREC,U,DGII)]"")&($P(DG701,U,DGII)']"")) S DGERR=1 D W701
"RTN","DGPTFVC3",57,0)
 F DGII=2:1:DGFNUM I $D(DGBPC(DGII))&($P(DGTREC,U,DGII)']"") S DGERR=1 D W701
"RTN","DGPTFVC3",58,0)
CHK7Q ;
"RTN","DGPTFVC3",59,0)
 K DGII,DGFNUM,DG701,DGHOLD,DGTREC,DGI
"RTN","DGPTFVC3",60,0)
 Q
"RTN","DGPTFVC3",61,0)
 ;
"RTN","DGPTFVC3",62,0)
W401 ;-- display error message for 401
"RTN","DGPTFVC3",63,0)
 N X S X=+^DGPT(DGPTF,"S",DGSUR,0),X=$TR($$FMTE^XLFDT(X,"5DF")," ","0")
"RTN","DGPTFVC3",64,0)
 W !,"401 Surgery  date: ",X,"...",$P($T(ERRMSG+1),";",4)
"RTN","DGPTFVC3",65,0)
 Q
"RTN","DGPTFVC3",66,0)
W501 ;-- display error message for 501
"RTN","DGPTFVC3",67,0)
 N X S X=+$P(^DGPT(DGPTF,"M",DGMOV,0),"^",10),X=$TR($$FMTE^XLFDT(X,"5DF")," ","0")
"RTN","DGPTFVC3",68,0)
 W !,"501 Movement date: ",X,"...",$P($T(ERRMSG+DGII),";",4)
"RTN","DGPTFVC3",69,0)
 Q
"RTN","DGPTFVC3",70,0)
W701 ;-- display error messages for 701
"RTN","DGPTFVC3",71,0)
 W !,"701 ",$P($T(ERRMSG+DGII),";",4)
"RTN","DGPTFVC3",72,0)
 Q
"RTN","DGPTFVC3",73,0)
INIT ;
"RTN","DGPTFVC3",74,0)
 I '$D(PTF) S DGOUT=1 G INITQ
"RTN","DGPTFVC3",75,0)
 S DGOUT=0,DGPTF=PTF
"RTN","DGPTFVC3",76,0)
 I '$D(^DGPT(DGPTF)) S (DGOUT,DGERR)=1
"RTN","DGPTFVC3",77,0)
 D LO^DGUTL,HOME^%ZIS
"RTN","DGPTFVC3",78,0)
INITQ Q
"RTN","DGPTFVC3",79,0)
 ;
"RTN","DGPTFVC3",80,0)
ERRMSG ;-- error messages
"RTN","DGPTFVC3",81,0)
 ;;1;Kidney Transplant Status Data Error.
"RTN","DGPTFVC3",82,0)
 ;;2;Suicide Indicator Data Error.
"RTN","DGPTFVC3",83,0)
 ;;3;Legionnaire's Disease Indicator Data Error.
"RTN","DGPTFVC3",84,0)
 ;;4;Substance Abuse Type Data Error.
"RTN","DGPTFVC3",85,0)
 ;;5;Psychiatry Axis IV Data Error.
"RTN","DGPTFVC3",86,0)
 ;;6;Psychiatry Axis V Data Error.
"RTN","DGPTFVC3",87,0)
 ;;7;Psychiatry Axis V Data Error.
"RTN","DGPTFVC3",88,0)
 ;
"RTN","DGPTFVC3",89,0)
 ;
"RTN","DGPTODR")
0^13^B5634642^B5433832
"RTN","DGPTODR",1,0)
DGPTODR ;ALB/ABS/ADL - DRG Information Report ; 11/15/06 2:57pm
"RTN","DGPTODR",2,0)
 ;;5.3;Registration;**510,729**;Aug 13, 1993;Build 59
"RTN","DGPTODR",3,0)
 ;;ADL;Update for CSV Project;;Mar 28, 2003
"RTN","DGPTODR",4,0)
 S DGTMP=DGDX,DGDRGPRT=1,(DGPG,DGQ)=0,$P(DGLN,"=",81)="" D HDR
"RTN","DGPTODR",5,0)
 F DGX=1:1 Q:$P(DGTMP,"^",DGX)']""  D CONT:$E(IOST,1,2)="C-" Q:DGQ["^"  W !,DGLN,!?10,"PRINCIPAL DIAGNOSIS:",$J($P(DGDX(DGX),"^"),8),"  ",$P(DGDX(DGX),"^",2) D ^DGPTICD S DGDX=$P(DGDX,"^",2,99)_"^"_$P(DGDX,"^")
"RTN","DGPTODR",6,0)
Q K AGE,NAME,SEX,DGDMS,DGDRGPRT,DGDX,DGEXP,DGSURG,DGTRS,DGLN,DGPG,DGQ,DGTMP,DGX,DGPTODR,I,Y Q
"RTN","DGPTODR",7,0)
HDR ;print heading
"RTN","DGPTODR",8,0)
 S DGPG=DGPG+1 W @IOF,"DRG INFORMATION REPORT",?45,"Date: " S Y=DT X ^DD("DD") W Y,"  Page: ",DGPG,!!
"RTN","DGPTODR",9,0)
 S Y=DGDAT D DD^%DT ; Y = external format of effective date
"RTN","DGPTODR",10,0)
 W "Effective Date: ",Y,! I NAME]"" W "Patient: ",NAME,?40
"RTN","DGPTODR",11,0)
 W "Sex: ",$S(SEX="M":"Male",1:"Female"),?61,"Age: ",AGE,!,"Expired: ",$S(DGEXP:"Yes",1:"No"),?18,"Transferred to Acute Care: ",$S(DGTRS:"Yes",1:"No"),?55,"Irreg D/C: ",$S(DGDMS:"Yes",1:"No")
"RTN","DGPTODR",12,0)
 Q:DGPG'=1  W !!,"Diagnosis Codes:" F I=0:0 S I=$O(DGDX(I)) Q:I'>0  W !,$J($P(DGDX(I),"^"),8),"  ",$P(DGDX(I),"^",2)
"RTN","DGPTODR",13,0)
 I $D(DGSURG) W !!,"Operation/Procedure Codes:" F I=0:0 S I=$O(DGSURG(I)) Q:I'>0  W !,$J($P(DGSURG(I),"^"),8),"  ",$P(DGSURG(I),"^",2)
"RTN","DGPTODR",14,0)
 Q
"RTN","DGPTODR",15,0)
CONT I $Y+8>IOSL R !!?20,"Press <RET> to continue or ""^"" to abort ",DGQ:DTIME S:'$T DGQ="^" Q:DGQ["^"  D HDR
"RTN","DGPTODR",16,0)
 Q
"RTN","DGPTOLC2")
0^14^B22638617^B22527953
"RTN","DGPTOLC2",1,0)
DGPTOLC2 ;ALB/AS/ADL - SUMMARY BY ADM RPT, lists diagnoses,sur,pro (cont.) ; 11/15/06 3:15pm
"RTN","DGPTOLC2",2,0)
 ;;5.3;Registration;**164,510,559,599,729**; Aug 13, 1993;Build 59
"RTN","DGPTOLC2",3,0)
 ;;ADL;Update for CSV Project;;Mar 27, 2003
"RTN","DGPTOLC2",4,0)
 ;
"RTN","DGPTOLC2",5,0)
EN D LO^DGUTL,NOW^%DTC S DGPT=0,DGDT=$TR($$FMTE^XLFDT(DT,"5DF")," ","0")_"@",%=$P(%,".",2),DGDT=DGDT_$E(%,1,2)_":"_$E(%_"0000",3,4)
"RTN","DGPTOLC2",6,0)
 F PTF=0:0 S PTF=$O(DGPTF(PTF)) Q:PTF'>0  S DGNAME=$P(DGPTF(PTF),"^"),DGADM=$P(DGPTF(PTF),"^",2),DGPTF(DGNAME,DGADM,PTF)="" K DGPTF(PTF) ;put names in alphabetical order
"RTN","DGPTOLC2",7,0)
 F DGPTX=0:0 S DGPT=$O(DGPTF(DGPT)) Q:DGPT']""  F DGADM=0:0 S DGADM=$O(DGPTF(DGPT,DGADM)) Q:DGADM'>0  S DGPG=1,PTF=$O(DGPTF(DGPT,DGADM,0)),DFN=$S($D(^DGPT(PTF,0)):+^(0),1:"") I DFN]"" S DGPMIFN=$O(^DGPM("APTF",PTF,0)) D E,HD,D
"RTN","DGPTOLC2",8,0)
 D Q2^DGPTOLC1 Q
"RTN","DGPTOLC2",9,0)
E S DGELIG=$S('$D(^DPT(DFN,.36)):"Unknown",$D(^DIC(8,+$P(^(.36),"^"),0)):$P(^(0),"^"),1:"Unknown"),X=$S($D(^DPT(DFN,.361)):$P(^(.361),"^"),1:""),%=";"_$P(^DD(2,.3611,0),"^",3),DGSTAT=$S(X']"":"Unknown",1:$P($P(%,";"_X_":",2),";",1))
"RTN","DGPTOLC2",10,0)
 S DG70=$S($D(^DGPT(PTF,70)):^(70),1:""),DGFEE=$S($P(^DGPT(PTF,0),"^",4):1,1:"") I DGFEE S X1=$S(+DG70:+DG70,1:DT),X2=DGADM D ^%DTC S DGLOS=$S(X:X,1:1),DGLV=0,D1=0
"RTN","DGPTOLC2",11,0)
 I '+DG70 S DGPRO=$S($D(^DPT(DFN,.104)):+^(.104),1:""),DGPRO=$S($D(^VA(200,+DGPRO,0)):$P(^(0),"^"),1:"Unknown")
"RTN","DGPTOLC2",12,0)
 I +DG70 S DGPRO=$S('$D(^DGPT(PTF,"M",1,"P")):"",1:$P(^("P"),"^",5)),DGPRO=$S($D(^VA(200,+DGPRO,0)):$P(^(0),"^"),1:"") I DGPRO']"" D DGPRO
"RTN","DGPTOLC2",13,0)
 Q
"RTN","DGPTOLC2",14,0)
CRT I IOST?1"C-".E R !?20,"Enter <RETURN> to continue",Y:DTIME
"RTN","DGPTOLC2",15,0)
HD W @IOF,?21,"PATIENT SUMMARY by ADMISSION",!!?51,"Run Date: ",DGDT,!,DGPT,?32,"SSN: ",$P(^DPT(+^DGPT(PTF,0),0),"^",9),?51,"Admitted: " S X=DGADM D DT
"RTN","DGPTOLC2",16,0)
 W !,"Elig: ",DGELIG,"  (",DGSTAT,")",?50,"Discharge: " S X=$P(DG70,"^") D DT W ! W:DGFEE "Fee Basis"
"RTN","DGPTOLC2",17,0)
 I DGPMIFN>0 W "Total LOS: " D ^DGPMLOS S X=+$P(X,"^")-(+$P(X,"^",2))-(+$P(X,"^",4)) W $S(X>0:X,1:"1") W ?18,"* Provider: ",$E(DGPRO,1,19)
"RTN","DGPTOLC2",18,0)
 W ?55,"PTF #: ",PTF,?72,"Pg: ",DGPG S DGPG=DGPG+1 W:DGPMIFN>0 !,"* indicates the most recent PROVIDER entered for this admission",! Q
"RTN","DGPTOLC2",19,0)
D G S:'$D(^DGPT(PTF,"M","AC"))
"RTN","DGPTOLC2",20,0)
 K DGMD F DGS=0:0 S DGS=$O(^DGPT(PTF,"M",DGS)) Q:DGS'>0  I $D(^(DGS,0)) S DGMD=+$P(^(0),"^",10) S:'DGMD DGMD=999999999 S:$D(DGMD(DGMD)) DGMD=DGMD+.01*DGS S DGMD(DGMD)=DGS ;put movements in date order
"RTN","DGPTOLC2",21,0)
 F DGS=0:0 S DGS=$O(DGMD(DGS)) Q:DGS'>0  I $D(^DGPT(PTF,"M",DGMD(DGS),0)) S DGM=^(0),X=$P(DGM,"^",10),DGBS=+$P(DGM,"^",2) W !!,"Movement Date: " D DT W:DGMD(DGS)=1 ?40,"(Discharge 501)" D:DGFEE LOS D BS F DGC=5:1:15 I DGC#10 D C
"RTN","DGPTOLC2",22,0)
 I DG70 S DGM=DG70 W !!,"Discharge Move: (701/2/3 Diagnoses)",! F DGC=10,11,16:1:24 D C
"RTN","DGPTOLC2",23,0)
S S DGF="S" F DGS=0:0 S DGS=$O(^DGPT(PTF,"S",DGS)) Q:DGS'>0  S DGSUR=^(DGS,0),X=+DGSUR W !!,"Surgery Date: " D DT F DGC=8:1:12 D P1
"RTN","DGPTOLC2",24,0)
 K DGF I $D(^DGPT(PTF,"401P")) S DGSUR=^("401P") F DGC=1:1:5 X:'($D(DGF)) "W !!,""Procedure: (401P)"" S DGF=1" D P1
"RTN","DGPTOLC2",25,0)
 F DGS=0:0 S DGS=$O(^DGPT(PTF,"P",DGS)) Q:DGS'>0  S DGSUR=^(DGS,0),X=+DGSUR W !!,"Procedure Date: " D DT F DGC=5:1:9 D P1
"RTN","DGPTOLC2",26,0)
 W:DGFEE !,"Total LOS: ",$S(DGLOS>0:DGLOS,1:"1") W ! D:IOST?1"C-".E CONT Q
"RTN","DGPTOLC2",27,0)
C S DGPTTMP=$$ICDDX^ICDCODE(+$P(DGM,"^",DGC),$$GETDATE^ICDGTDRG(PTF),,1) Q:+DGPTTMP<0!('$P(DGPTTMP,U,10))  S DGICD=$P(DGPTTMP,U,2,99) D
"RTN","DGPTOLC2",28,0)
 . I $Y>($S($D(IOSL):IOSL,1:66)-4) D CRT W !,"Diagnosis Codes, (cont.)"
"RTN","DGPTOLC2",29,0)
 W:DGC=10 ?4,"PRINCIPAL DIAGNOSIS: " W:DGC'=10 ! W ?10,$P(DGICD,"^",3)_" ("_$P(DGICD,"^",1)_")" Q
"RTN","DGPTOLC2",30,0)
P1 S DGPTTMP=$$ICDOP^ICDCODE(+$P(DGSUR,"^",DGC),$$GETDATE^ICDGTDRG(PTF),,1) Q:+DGPTTMP<0!('$P(DGPTTMP,U,10))  S DGICD=$P(DGPTTMP,U,2,99) Q:DGICD']""  D
"RTN","DGPTOLC2",31,0)
 . I $Y>($S($D(IOSL):IOSL,1:66)-4) D CRT W !,$S('$D(DGF):"Non-OR Procedures",DGF="S":"Surgery",1:"Non-OR Procedures") W " Codes, (cont.)"
"RTN","DGPTOLC2",32,0)
 W !?10,$P(DGICD,"^",4)_" ("_$P(DGICD,"^")_")" Q
"RTN","DGPTOLC2",33,0)
DT Q:X']""  W $TR($$FMTE^XLFDT(X,"5DF")," ","0") S X=$P(X,".",2) I X]"" W "@"_$E(X,1,2)_":"_$E(X_"0000",3,4)
"RTN","DGPTOLC2",34,0)
 Q
"RTN","DGPTOLC2",35,0)
BS S DGBS=$S('DGBS:DGBS,$D(^DIC(42.4,+DGBS,0)):$P(^(0),"^",1),1:"") W !,"Losing Specialty: ",DGBS Q
"RTN","DGPTOLC2",36,0)
LOS F %=3,4 S DGLV=$P(DGM,"^",%)+DGLV
"RTN","DGPTOLC2",37,0)
 S DGLOS=DGLOS-DGLV Q
"RTN","DGPTOLC2",38,0)
CONT F Y=1:1:($S($D(IOSL):IOSL,1:66)-$Y-2) W !
"RTN","DGPTOLC2",39,0)
 R ?20,"Enter <RETURN> to continue",Y:DTIME Q
"RTN","DGPTOLC2",40,0)
DGPRO S X=$O(^DGPM("APTF",PTF,0)),VAIP("E")=$S('$D(^DGPM(+X,0)):"",1:$P(^DGPM(X,0),"^",17))
"RTN","DGPTOLC2",41,0)
 I VAIP("E") D IN5^VADPT S DGPRO=$S($P(VAIP(7),"^",2)]"":$P(VAIP(7),"^",2),1:"Unknown") K VAIP Q
"RTN","DGPTOLC2",42,0)
 S DGPRO="Unknown" K VAIP Q
"RTN","DGPTR0")
0^25^B25017535^B24220162
"RTN","DGPTR0",1,0)
DGPTR0 ;MJK/JS/ADL - PTF TRANSMISSION ; 9/26/05 6:44pm
"RTN","DGPTR0",2,0)
 ;;5.3;Registration;**114,247,338,342,510,524,565,678,729**;Aug 13, 1993;Build 59
"RTN","DGPTR0",3,0)
 ;;ADL;Update for CSV Project;;Mar 27, 2003
"RTN","DGPTR0",4,0)
 ; -- setup control data
"RTN","DGPTR0",5,0)
 ; ssn
"RTN","DGPTR0",6,0)
 S X=$P(DG10,U,9),Y=$S($E(X,10)="P":"P",1:" ")_$E(X_"         ",1,9)
"RTN","DGPTR0",7,0)
 ; -- adm d/t
"RTN","DGPTR0",8,0)
 S X=$P($P(DG0,U,2),"."),Y=Y_$E(X,4,5)_$E(X,6,7)_$E(X,2,3)_$E($P($P(DG0,U,2),".",2)_"0000",1,4)
"RTN","DGPTR0",9,0)
 ; -- facility #
"RTN","DGPTR0",10,0)
 S L=3,X=DG0,Z=3 D ENTER S Y=Y_$E($P(X,U,5)_"   ",1,3)
"RTN","DGPTR0",11,0)
 S DGHEAD=Y,Y="    "_Y D HEAD^DGPTR1
"RTN","DGPTR0",12,0)
 ;
"RTN","DGPTR0",13,0)
101 ; -- setup 101 transation
"RTN","DGPTR0",14,0)
 ; control data and name
"RTN","DGPTR0",15,0)
 ;S Y=$S(T1:"C",1:"N")_"101"_DGHEAD,DGNAM=$P(DG10,U,1) D DGNAM S Y=Y_$E($P(DGNAM,",",1)_"           ",1,12)_$J($E($P(DGNAM,",",2),1),1)_$J($E($P($P(DGNAM,",",2)," ",2),1),1)
"RTN","DGPTR0",16,0)
 S Y=$S(T1:"C",1:"N")_"101"_DGHEAD S Y=Y_$$PTFNMFT($P(DG10,U))
"RTN","DGPTR0",17,0)
 ; source of admission
"RTN","DGPTR0",18,0)
 S Y=Y_$S($D(^DIC(45.1,+DG101,0)):$J($P(^(0),U,1),2),1:"  ")
"RTN","DGPTR0",19,0)
 ; xfring fac and suffix
"RTN","DGPTR0",20,0)
 S L=3,X=DG101,Z=5 D ENTER S Y=Y_$E($P(X,U,6)_"   ",1,3)
"RTN","DGPTR0",21,0)
 ; source of payment
"RTN","DGPTR0",22,0)
 S Y=Y_$S("A0"[$P(DG0,U,5):" ",1:$J($P(DG101,U,3),1))
"RTN","DGPTR0",23,0)
 ;POW Location
"RTN","DGPTR0",24,0)
 S Y=Y_$S($P(DG52,U,5)="N":1,$P(DG52,U,5)'="Y":3,$P(DG52,U,6)>0&($P(DG52,U,6)<7):3+$P(DG52,U,6),$P(DG52,U,6)>6&($P(DG52,U,6)<9):$C($P(DG52,U,6)+58),1:" ")
"RTN","DGPTR0",25,0)
 ;marital status, sex
"RTN","DGPTR0",26,0)
 S Y=Y_$S($D(^DIC(11,+$P(DG10,U,5),0)):$E(^(0),1),1:" ")_$J($P(DG10,U,2),1)
"RTN","DGPTR0",27,0)
 ;  date of birth
"RTN","DGPTR0",28,0)
 S DGDOB=$P(DG10,U,3)\1,Y=Y_$E(DGDOB,4,5)_$E(DGDOB,6,7)_(1700+$E(DGDOB,1,3))
"RTN","DGPTR0",29,0)
 ; period of service
"RTN","DGPTR0",30,0)
 S DGPOS=$S($D(^DIC(21,+$P(DG32,U,3),0)):$P(^(0),U,3),1:"")
"RTN","DGPTR0",31,0)
 I $D(^DGPM(+$O(^DGPM("APTF",J,0)),"ODS")),+^("ODS") S DGPOS=6
"RTN","DGPTR0",32,0)
 ;-- if non vet admitting eligibility make POS 9
"RTN","DGPTR0",33,0)
 S DGPOS=$$CKPOS^DGPTUTL($P($G(^DGPT(PTF,101)),U,8),DGPOS)
"RTN","DGPTR0",34,0)
 S X=DGPOS,Z=1,L=2 D ENTER
"RTN","DGPTR0",35,0)
 ; agent orange
"RTN","DGPTR0",36,0)
 S G=" " S DGAO=$P(DG321,U,2) S:DGPOS=7 G=$S($P(DG321,U)'="Y":1,DGAO="N":2,DGAO="Y":3,1:4) S:(DGAO="Y")&($P(DG321,U,13)="K") G=5
"RTN","DGPTR0",37,0)
 ; rad exposure
"RTN","DGPTR0",38,0)
 S E=" " I "^0^2^4^5^7^8^Z^"[(U_DGPOS_U) S DGNT=$P(DG321,U,12),E=$S($P(DG321,U,3)'="Y":1,DGNT="N":2,DGNT="T":3,DGNT="B":4,1:" ")
"RTN","DGPTR0",39,0)
 S Y=Y_G_E K DGPOS,G,E
"RTN","DGPTR0",40,0)
 ; state code
"RTN","DGPTR0",41,0)
 S X=$S($D(^DIC(5,+$P(DG11,U,5),0)):^(0),1:""),L=2,Z=3 D ENTER0
"RTN","DGPTR0",42,0)
 ; county code
"RTN","DGPTR0",43,0)
 S X=$S($D(^DIC(5,+$P(DG11,U,5),1,+$P(DG11,U,7),0)):^(0),1:""),L=3,Z=3 D ENTER0
"RTN","DGPTR0",44,0)
 ; zip code
"RTN","DGPTR0",45,0)
 S X=DG11,Z=6,L=5 D ENTER
"RTN","DGPTR0",46,0)
 ; means test
"RTN","DGPTR0",47,0)
 S Y=Y_$S($P(DG70,U,26)="Y":"AS",1:$E($P(DG0,U,10)_"  ",1,2))
"RTN","DGPTR0",48,0)
 ; income
"RTN","DGPTR0",49,0)
 I $L($P(DG101,U,7))>6 S Y=Y_"999999"
"RTN","DGPTR0",50,0)
 E  S X=DG101,Z=7,L=6 D ENTER0
"RTN","DGPTR0",51,0)
 ;MST
"RTN","DGPTR0",52,0)
 S X=$$GETSTAT^DGMSTAPI(+DG0) S Y=Y_$S(X<0:"U",1:$P(X,"^",2))
"RTN","DGPTR0",53,0)
 ;Combat Vet
"RTN","DGPTR0",54,0)
 S X=$$CVEDT^DGCV(+DG0,$P(DG0,"^",2)) S Y=Y_$S((+X)>0:1,1:0)
"RTN","DGPTR0",55,0)
 S X=$P(X,"^",2)_"       " S Y=Y_$E(X,4,5)_$E(X,6,7)_$E(X,2,3)
"RTN","DGPTR0",56,0)
 ;Project 112/SHAD - send null till DG/664 is released
"RTN","DGPTR0",57,0)
 S Y=Y_" " ;S X=$$SHAD^SDCO22(+DG0) S Y=Y_$S((+X)>0:1,1:0)
"RTN","DGPTR0",58,0)
 ;Emergency Response Indicator
"RTN","DGPTR0",59,0)
 S X=$$EMGRES^DGUTL(+DG0) S Y=Y_$S("^K^"[X:X,1:" ")
"RTN","DGPTR0",60,0)
 D FILL^DGPTR2,SAVE
"RTN","DGPTR0",61,0)
 I T1 S Y=$E(Y,1,52)_" "_$E(Y,54,125)
"RTN","DGPTR0",62,0)
 ;
"RTN","DGPTR0",63,0)
P401 ; -- setup 401P transaction
"RTN","DGPTR0",64,0)
 G 401:'$D(^DGPT(J,"401P"))!(T1) S DG41=^("401P"),Y=$S(T1:"C",1:"N")_"401"_DGHEAD_"P"_"           "
"RTN","DGPTR0",65,0)
 S DG41=$S($D(^DGPT(J,"401P")):^("401P"),1:"")
"RTN","DGPTR0",66,0)
 S L=1 F K=1:1:5 S:'$P(DG41,U,K) DG41=$P(DG41,U,1,K-1)_U_$P(DG41,U,K+1,99),K=K-1 S L=L+1 Q:L=5
"RTN","DGPTR0",67,0)
 F I=1:1:5 S DGPTTMP=$$ICDOP^ICDCODE(+$P(DG41,U,I),$$GETDATE^ICDGTDRG(J)),Y=Y_$S(+DGPTTMP>0:$J($P($P(DGPTTMP,U,2),".",1),2)_$E($P($P(DGPTTMP,U,2),".",2)_"   ",1,3),1:"     ")_"  "
"RTN","DGPTR0",68,0)
 I $E(Y,40)'=" " D FILL^DGPTR2,SAVE
"RTN","DGPTR0",69,0)
 ;
"RTN","DGPTR0",70,0)
401 ; -- setup 401 transactions
"RTN","DGPTR0",71,0)
 G 501:'$D(^DGPT(J,"S")) K ^UTILITY($J,"S") S I=0
"RTN","DGPTR0",72,0)
SUR S I=$O(^DGPT(J,"S",I)) G 501:'I S DGSUR=^(I,0),DGAUX=$S($D(^DGPT(J,"S",I,300)):^(300),1:"") G SUR:'DGSUR
"RTN","DGPTR0",73,0)
 G SUR:DGSUR<T1!(DGSUR>T2) S DGSUD=+^(0)\1,^UTILITY($J,"S",DGSUD)=$S($D(^UTILITY($J,"S",DGSUD)):^(DGSUD),1:0)+1,F=$S(DGSUD<2871000:0,1:1)
"RTN","DGPTR0",74,0)
 I ^UTILITY($J,"S",DGSUD)>$S(F:3,1:2) D  I Y'=1 S DGERR=1 Q
"RTN","DGPTR0",75,0)
 .W !,"**There are more than ",$S(F:"three",1:"two")," surgeries on the same date**"
"RTN","DGPTR0",76,0)
 .S DIR(0)="Y",DIR("B")="YES",DIR("A")="OK to continue?" D ^DIR K DIR
"RTN","DGPTR0",77,0)
 S Y=$S(T1:"C",1:"N")_"40"_^(DGSUD)_DGHEAD_$E(DGSUD,4,5)_$E(DGSUD,6,7)_$E(DGSUD,2,3)_$E($P(+DGSUR,".",2)_"0000",1,4)_$S($D(^DIC(45.3,+$P(DGSUR,U,3),0)):$P(^(0),U,1),1:"  ")
"RTN","DGPTR0",78,0)
 S L=1,X=DGSUR F Z=4:1:7 D ENTER
"RTN","DGPTR0",79,0)
 S L=1 F K=8:1:12 S:'$P(DGSUR,U,K) DGSUR=$P(DGSUR,U,1,K-1)_U_$P(DGSUR,U,K+1,99),K=K-1 S L=L+1 Q:L=5
"RTN","DGPTR0",80,0)
 F K=8:1:12 S DGPTTMP=$$ICDOP^ICDCODE(+$P(DGSUR,U,K),$$GETDATE^ICDGTDRG(J)),Y=Y_$S(+DGPTTMP>0:$J($P($P(DGPTTMP,U,2),".",1),2)_$E($P($P(DGPTTMP,U,2),".",2)_"   ",1,3),1:"     ")_"  "
"RTN","DGPTR0",81,0)
 ;-- att phy
"RTN","DGPTR0",82,0)
 S Y=Y_"         "
"RTN","DGPTR0",83,0)
 ;-- additional ptf question
"RTN","DGPTR0",84,0)
 ;send null, if disch date>inactive date. DG/729
"RTN","DGPTR0",85,0)
 I +$P($G(^DIC(45.88,1,0)),U,3) S DGAUX=$S((+$G(^DGPT(J,70))<$P(^DIC(45.88,1,0),U,3)):DGAUX,1:"")
"RTN","DGPTR0",86,0)
 S Y=Y_$E($P(DGAUX,U)_" ")
"RTN","DGPTR0",87,0)
 K DGAUX
"RTN","DGPTR0",88,0)
 D FILL^DGPTR2,SAVE G SUR
"RTN","DGPTR0",89,0)
501 G 501^DGPTR2
"RTN","DGPTR0",90,0)
 Q
"RTN","DGPTR0",91,0)
ENTER S Y=Y_$J($P(X,U,Z),L)
"RTN","DGPTR0",92,0)
 Q
"RTN","DGPTR0",93,0)
ENTER0 S Y=Y_$S($P(X,U,Z)]"":$E("000000",$L($P(X,U,Z))+1,L)_$P(X,U,Z),1:$J($P(X,U,Z),L))
"RTN","DGPTR0",94,0)
 Q
"RTN","DGPTR0",95,0)
SAVE D START^DGPTR1 S:'DGERR ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTR0",96,0)
 I DGERR'>0 S DGACNT=DGACNT+1,^TMP("AEDIT",$J,$E(Y,1,4),DGACNT)=Y
"RTN","DGPTR0",97,0)
Q Q
"RTN","DGPTR0",98,0)
DGNAM S X=DGNAM I X?.E.P F I=1:1:$L(X) S Z=$E(X,I) Q:Z=","  S:Z?.P&(Z]"") X=$E(X,1,I-1)_$E(X,I+1,$L(X)),I=I-1 Q:X'?.E.P
"RTN","DGPTR0",99,0)
 I X?.E.L D UP^DGHELP
"RTN","DGPTR0",100,0)
 S DGNAM=X
"RTN","DGPTR0",101,0)
 Q
"RTN","DGPTR0",102,0)
 ;
"RTN","DGPTR0",103,0)
PTFNMFT(DG10) ;this function will format the name of the patient for
"RTN","DGPTR0",104,0)
 ; transmission of the 101 record to Austin. In addition, this
"RTN","DGPTR0",105,0)
 ; function will be used by OPC so that the format will be consistent
"RTN","DGPTR0",106,0)
 ; for OPC and PTF.
"RTN","DGPTR0",107,0)
 ;  INPUT :   DG10 - .01 field from the patient record.
"RTN","DGPTR0",108,0)
 ;  OUTPUT:   name in the format proper format.
"RTN","DGPTR0",109,0)
 ;        A = <12 - characters of last name padded with blanks>
"RTN","DGPTR0",110,0)
 ;        B = <1  - first initial of fist name>
"RTN","DGPTR0",111,0)
 ;        C = <1  - first initial of middle name>
"RTN","DGPTR0",112,0)
 ;      returns :ABC <14 - characters>
"RTN","DGPTR0",113,0)
 N X,I
"RTN","DGPTR0",114,0)
 S DGNAM=DG10 D DGNAM
"RTN","DGPTR0",115,0)
 Q $E($P(DGNAM,",",1)_"           ",1,12)_$J($E($P(DGNAM,",",2),1),1)_$J($E($P($P(DGNAM,",",2)," ",2),1),1)
"RTN","DGPTR0",116,0)
 ;
"RTN","DGPTR1")
0^17^B26016788^B25846829
"RTN","DGPTR1",1,0)
DGPTR1 ;ALB/MTC - PTF VERIFICATION ; 12/14/06 10:31am
"RTN","DGPTR1",2,0)
 ;;5.3;Registration;**58,247,338,342,423,415,565,678,696,729**;Aug 13, 1993;Build 59
"RTN","DGPTR1",3,0)
START S T=$E(Y,2,3),T=$S(T=40&($E(Y,28)="P"):"P40",1:T),ERR=$P($T(@("T"_T)),";;",2,999),W=$P($T(@(T)),";;",2,999),F=31 D L
"RTN","DGPTR1",4,0)
 I T=70 S ERR=$P($T(T701),";;",2,999),W=$P($T(701),";;",2,999),F=72 D L
"RTN","DGPTR1",5,0)
 D @("D"_T) Q
"RTN","DGPTR1",6,0)
 K DGFILL
"RTN","DGPTR1",7,0)
 Q
"RTN","DGPTR1",8,0)
 ;
"RTN","DGPTR1",9,0)
L F H=1:1 S DGO=$P(W,U,H) Q:'DGO  F Z=1:1:$P(DGO,";",3) S DGL=$P(DGLOGIC,U,+DGO),X=$E(Y,F) D @("ERR:"_DGL) S F=F+1
"RTN","DGPTR1",10,0)
 Q
"RTN","DGPTR1",11,0)
 ;
"RTN","DGPTR1",12,0)
T10 ;;1:NAME^2:SOURCE OF ADM^3:TRANS FAC.^4:SOURCE OF PAY^5:POW^6:MARITAL ST^7:SEX^8:DOB^9:POS^10:VIETNAM^11:ION RADIATION^12:RESIDENCE^13:MEANS TEST^14:INCOME^15:MST^16:COMBAT VET^17:CV END DT^18:PROJ 112/SHAD^19:ERI
"RTN","DGPTR1",13,0)
 ;
"RTN","DGPTR1",14,0)
T70 ;;1:DT OF DISP.^2:DISCH BD SEC^3:TYPE OF DIS^4:OUT TREAT^5:VA AUS^6:PL OF DIS^7:REC FAC^8:ASIH DAYS^9:NOT USED^10:C&P STAT^11:PDXLS^12:ONLY DX^13:PHY MPCR
"RTN","DGPTR1",15,0)
 ;T701 is part 2 of T70
"RTN","DGPTR1",16,0)
T701 ;;1:PHY SPEC^2:%SC^3:LEGION^4:SUICIDE^5:DRUG^6:AXIS-IV^7:AXIS-V^8:SC^9:EXP^10:MST^11:HNC^12:ETHNICITY^13:RACE^14:COMBAT VET
"RTN","DGPTR1",17,0)
 ;
"RTN","DGPTR1",18,0)
T50 ;;1:DT OF MVMT^2:LOSING BD SEC MPCR^3:LOSING BD SEC^4:LEAVE DAYS^5:PASS DAYS^6:SCI^7:DIAG^8:DOCTOR'S SSN^9:PHY MPCR^10:PHY SPEC^11:DISCHARGE STAT^^^^^16:LEGION^17:SUICIDE^18:DRUG^19:AXIS-IV^20:AXIS-V^21:SC^22:EXP^23:MST^24:HNC
"RTN","DGPTR1",19,0)
 ;
"RTN","DGPTR1",20,0)
T53 ;;1:DATE OF PHYSICAL MOVEMENT^2:LOSING PHYSICAL MPCR^3:LOSING PHYSICAL SPECIALTY^4:TR SPECIALTY MPCR^5:TR SPECIALTY^6:LEAVE DAYS^7:PASS DAYS^8:DOCTOR'S SSN (NOT USED)
"RTN","DGPTR1",21,0)
 ;
"RTN","DGPTR1",22,0)
T40 ;;1:DATE OF SURGERY^2:SURG SPEC.^3:CAT CHIEF SURGEON^4:CAT FIRST ASS^5:ANEST. TECH.^6:SOURCE OF PAY^7:OP CODE^8:DOCTOR'S SSN (NOT USED)^^^^^13:TRANSPLANT STATUS
"RTN","DGPTR1",23,0)
 ;
"RTN","DGPTR1",24,0)
TP40 ;;1:OP CODE
"RTN","DGPTR1",25,0)
 ;
"RTN","DGPTR1",26,0)
T60 ;;1:DATE OF PROCEDURE^2:LOSING BD SEC^3:DIALYSIS TYPE^4:NUMBER OF TREATMENTS^5:PROCEDURE CODE
"RTN","DGPTR1",27,0)
 ;
"RTN","DGPTR1",28,0)
LOGIC ;;X'?.N^X'?.A&(X'=" ")^X'=" "^X'?.N&(X'=" ")^X'?.A&(X'=" ")^0^X'?.N&(X'="X")^X'=" "&(X'="P")^X="E"^X="Y"^X=" "^X'="A"&(X'=" ")^(X'?.A)&(X'?.N)&(X'=" ")^(X'?.AN)&('$P(DG0,U,4))^((T1)&(X'=" "))!(('T1)&(X'?.AN)&('$P(DG0,U,4)))
"RTN","DGPTR1",29,0)
 ;
"RTN","DGPTR1",30,0)
 ; edit check# ; edit field ; # x check preformed ; display error name #
"RTN","DGPTR1",31,0)
10 ;;6;;12;1^2;1;1;1^5;1;1;1^1;2;1;2^2;2;1;2^4;3;3;3^6;;3;3^4;4;1;4^6;5;1;5^2;6;1;6^2;7;1;7^1;8;8;8^6;;1;9^11;9;1;9^4;10;1;10^4;10;1;11^1;11;5;12^7;11;5;12^2;12;1;13^6;;1;13^1;;6;14^2;;1;15^1;;1;16^4;;6;17^3;;1;18^5;;1;19^3;;29
"RTN","DGPTR1",32,0)
 ;
"RTN","DGPTR1",33,0)
70 ;;1;1;10;1^13;2;2;2^1;3;1;3^4;4;1;4^4;5;1;5^6;;1;6^4;7;3;7^6;;3;7^4;8;3;8^6;9;1;9^1;10;1;10^9;11;1;11^11;11;2;11^6;;3;11^10;11;1;11^6;;1;12^15;;6;13
"RTN","DGPTR1",34,0)
 ;701 is part 2 of 70
"RTN","DGPTR1",35,0)
701 ;;15;;2;1^1;;3;2^4;;1;3^4;;1;4^12;;1;5^4;;3;5^4;;1;6^4;;4;7^4;;1;8^5;;3;9^5;;1;10^5;;1;11^13;12;2;12^13;13;12;13^5;;1;14^3;;17
"RTN","DGPTR1",36,0)
 ;
"RTN","DGPTR1",37,0)
50 ;;1;1;10;1^1;;6;2^13;3;2;3^1;4;3;4^1;5;3;5^6;;1;6^11;7;3;7^6;;32;7^6;;9;8^14;;6;9^14;;2;10^6;;1;11^4;;1;16^4;;1;17^12;;1;18^4;;3;18^4;;1;19^4;;4;20^4;;1;21^5;;3;22^5;;1;23^5;;1;24
"RTN","DGPTR1",38,0)
 ;
"RTN","DGPTR1",39,0)
53 ;;1;;10;1^1;;6;2^13;;2;3^1;;6;4^13;;2;5^1;;3;6^1;;3;7^3;;9;8^3;;54;
"RTN","DGPTR1",40,0)
 ;
"RTN","DGPTR1",41,0)
40 ;;1;1;10;1^1;2;2;2^11;3;1;3^4;4;1;4^6;5;1;5^4;6;1;6^11;7;2;7^6;;3;7^3;7;2;7^6;;5;7^3;7;2;7^6;;5;7^3;7;2;7^6;;5;7^3;7;2;7^6;;5;7^3;7;2;7^3;;9;8^4;;1;13^3;;34;
"RTN","DGPTR1",42,0)
 ;
"RTN","DGPTR1",43,0)
P40 ;;8;;1;^3;;11;^11;1;2;1^6;;3;1^3;1;2;1^6;;5;1^3;;2;1^6;;5;1^3;;2;1^6;;5;1^3;;2;1^6;;5;1^3;;2;1^3;;48
"RTN","DGPTR1",44,0)
 ;
"RTN","DGPTR1",45,0)
60 ;;1;1;10;1^13;2;2;2^4;3;1;3^4;4;3;4^11;5;3;5^6;;32;5^3;;44
"RTN","DGPTR1",46,0)
 ;
"RTN","DGPTR1",47,0)
ERR S DGERR=1
"RTN","DGPTR1",48,0)
 W !,T,$S(T["H":" ",1:$E(Y,4)),"  "
"RTN","DGPTR1",49,0)
 W:"45"[$E(T,1) $E(Y,31,32),"-",$E(Y,33,34),"-",$E(Y,35,36),"@",$E(Y,37,40)
"RTN","DGPTR1",50,0)
 W ?25,$P($P(ERR,U,$P(DGO,";",4)),":",2),?40,"COL.",F,"  VALUE: ",$S($E(Y,F)=" ":"BLANK",1:$E(Y,F))
"RTN","DGPTR1",51,0)
 S I=$S('$D(I):1,I>0:I,1:1),^(I)=$S($D(^UTILITY("DG",$J,T_$S(T["H":"",1:$E(Y,4)),I)):^(I),1:U) I $P(DGO,";",2),^(I)'[(U_$P(DGO,";",2)_U) S ^(I)=^(I)_$P(DGO,";",2)_U
"RTN","DGPTR1",52,0)
 Q
"RTN","DGPTR1",53,0)
 ;
"RTN","DGPTR1",54,0)
D10 I $E(Y,66)="Z" S (F,H)=68,W="11;10;1;10" D L
"RTN","DGPTR1",55,0)
 I $P(^DGPT(J,0),"^",4),$P(^(0),"^",10)="U",$D(^DGPT(J,70)),+^(70)>2890700 S F=79,DGO="2;12;1;12" D ERR
"RTN","DGPTR1",56,0)
 Q
"RTN","DGPTR1",57,0)
 ;
"RTN","DGPTR1",58,0)
D40 Q
"RTN","DGPTR1",59,0)
DP40 Q
"RTN","DGPTR1",60,0)
D70 I "467"'[$E(Y,43) S F=44,W="4;4;1;4^1;5;1;5^11;6;1;6" D L
"RTN","DGPTR1",61,0)
 Q
"RTN","DGPTR1",62,0)
D50 I "A0"[$P(DG0,U,5)!("A4"[$P(DG0,U,5))!('$D(^DGPT(J,70))) S W="11;6;1;6",F=55 D L
"RTN","DGPTR1",63,0)
 I $D(^DGPT(J,70)),$S(T1:1,1:+^(70)>2871000) S W="11;6;1;6",F=55 D L
"RTN","DGPTR1",64,0)
 I $E(Y,4)=1 S W="9;7;1;7",F=56 D L
"RTN","DGPTR1",65,0)
 I I=1,'T1 S W="1;11;1;11",F=108 D L
"RTN","DGPTR1",66,0)
 Q
"RTN","DGPTR1",67,0)
D53 Q
"RTN","DGPTR1",68,0)
D60 I $E(Y,43) S F=44,W="1;4;3;4" D L
"RTN","DGPTR1",69,0)
 Q
"RTN","DGPTR1",70,0)
HEAD S ERR="1:SSN^2:ADMISSION DATE^3:FACILITY #",W="8;1;1;1^1;1;9;1^1;2;10;2^1;3;3;3^6;;3;3",F=5,DGLOGIC=$P($T(LOGIC),";;",2),T="HEADER"
"RTN","DGPTR1",71,0)
 D L
"RTN","DGPTR1",72,0)
 Q
"RTN","DGPTR1",73,0)
LOG S DGLOGIC=$P($T(LOGIC),";;",2)
"RTN","DGPTR1",74,0)
 Q
"RTN","DGPTR1",75,0)
CEN S T=70,ERR=$P($T(T70),";;",2),W=$P($T(70),";;",2,999),W="13;9;1;9"_$P(W,"13;9;1;9",2,999),F=56 D L
"RTN","DGPTR1",76,0)
 S ERR=$P($T(T701),";;",2),W=$P($T(701),";;",2,999),F=72 D L
"RTN","DGPTR1",77,0)
 Q
"RTN","DGPTR2")
0^26^B21647835^B17037574
"RTN","DGPTR2",1,0)
DGPTR2 ;ALB/JDS/MJK/MTC/ADL - ALB/BOK  PTF TRANSMISSION ; 6/6/05 11:48am
"RTN","DGPTR2",2,0)
 ;;5.3;Registration;**183,338,423,510,636,729**;Aug 13, 1993;Build 59
"RTN","DGPTR2",3,0)
 ;;ADL;Update for CSV Project;;Mar 27,2003
"RTN","DGPTR2",4,0)
501 ; -- setup 501 transactions
"RTN","DGPTR2",5,0)
 ; DG*636
"RTN","DGPTR2",6,0)
 N DGPTMVDT
"RTN","DGPTR2",7,0)
 K DGCMVT I T2'=9999999 S DGCMVT=$O(^DGPT(J,"M","AM",+$P(T2,".")_".2359")),DGCMVT=$S('DGCMVT:1,$O(^(DGCMVT,0)):$O(^(0)),1:1)
"RTN","DGPTR2",8,0)
 F I=0:0 S I=$O(^DGPT(J,"M",I)) G 535:I'>0 I $D(^(I,0)) D
"RTN","DGPTR2",9,0)
 . S DGM=^(0),DGSC=$P(DGM,U,18),DGAO=$P(DGM,U,26),DGIR=$P(DGM,U,27),DGEC=$P(DGM,U,28),DGMST=$P(DGM,U,29),DGHNC=$P(DGM,U,30),DGTD=$P(DGM,U,10),DGPTMVDT=$P(DGM,U,10)
"RTN","DGPTR2",10,0)
 . S:$D(DGCMVT) DGTD=$S(I=DGCMVT:$P(T2,".")_".2359",1:DGTD)
"RTN","DGPTR2",11,0)
 . I $P(DGM,U,17)'="n",DGTD,DGTD'<T1,DGTD'>T2 D MOV
"RTN","DGPTR2",12,0)
MOV S DGCDR=$P(DGM,U,16),DGM=$P(DGM,U,1,9)_U_$P(DGM,U,11,15),L=1 F Z=5:1:14 S:'$P(DGM,U,Z) DGM=$P(DGM,U,1,Z-1)_U_$P(DGM,U,Z+1,99) S:'$P(DGM,U,Z) Z=Z-1 S L=L+1 Q:L=10
"RTN","DGPTR2",13,0)
 S Y=$S(T1:"C",1:"N")_"501"_DGHEAD,X=$P(DGTD,".")_"       ",Y=Y_$E(X,4,5)_$E(X,6,7)_$E(X,2,3)_$E($P(DGTD,".",2)_"0000",1,4)
"RTN","DGPTR2",14,0)
 S Z=DGCDR D CDR
"RTN","DGPTR2",15,0)
 ;replace specialty pointer (ien) with ptf code (alpha-numeric)
"RTN","DGPTR2",16,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTR2",17,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(DGM,U,2),.DGARRY)
"RTN","DGPTR2",18,0)
 S $P(DGM,U,2)=$G(DGARRY(7))
"RTN","DGPTR2",19,0)
 S L=2,X=DGM,Z=2 D ENTER0
"RTN","DGPTR2",20,0)
 ; convert pass, leave days >999 to 999
"RTN","DGPTR2",21,0)
 S L=3 F Z=3,4 S:$P(X,U,Z)>999 $P(X,U,Z)=999 D ENTER0
"RTN","DGPTR2",22,0)
 S L=1,X=DG57,Z=4 D ENTER S:I=1 DG502=Y
"RTN","DGPTR2",23,0)
 F Z=5:1:9 S DGPTTMP=$$ICDDX^ICDCODE($P(DGM,U,Z),$G(DGPTMVDT)) D
"RTN","DGPTR2",24,0)
 . S F=$S(+DGPTTMP>0&($P(DGPTTMP,U,10)):$P(DGPTTMP,U,2),1:"   ."),F=$P(F,".",1)_$E($P(F,".",2)_"    ",1,3),F=F_$E("      ",1,7-$L(F)),Y=Y_F
"RTN","DGPTR2",25,0)
 S Y=Y_"         "
"RTN","DGPTR2",26,0)
 S X=""
"RTN","DGPTR2",27,0)
 I 'T1 S Z=$S(I=1:+$O(^DGPT(J,535,"ADC",0)),1:+$O(^DGPT(J,535,"AM",DGTD-.0000001))) I $D(^DGPT(J,535,+$O(^(Z,0)),0)) S X=^(0)
"RTN","DGPTR2",28,0)
 I T1 S Z=+$O(^DGPT(J,535,"AM",DGTD-.0000001)) S:'Z Z=+$O(^DGPT(J,535,"ADC",0)) I $D(^DGPT(J,535,+$O(^(Z,0)),0)) S X=^(0)
"RTN","DGPTR2",29,0)
 S Z=$P(X,U,16) D CDR
"RTN","DGPTR2",30,0)
 ;replace specialty pointer (ien) with ptf code (alpha-numeric)
"RTN","DGPTR2",31,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTR2",32,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(X,U,2),.DGARRY)
"RTN","DGPTR2",33,0)
 S $P(X,U,2)=$G(DGARRY(7))
"RTN","DGPTR2",34,0)
 S L=2,Z=2 D ENTER0
"RTN","DGPTR2",35,0)
 ; bed occupant
"RTN","DGPTR2",36,0)
 I T1 S Y=Y_$S(I=1:$E($P(DG70,U,14)_" "),$P(+DGTD,".")=$P(T2,"."):5,1:1)
"RTN","DGPTR2",37,0)
 I 'T1 S Y=Y_$S(I=1:$E($P(DG70,U,14)_" "),1:" ")
"RTN","DGPTR2",38,0)
 ;-- additional ptf questions
"RTN","DGPTR2",39,0)
 S DGAUX=$S($D(^DGPT(J,"M",I,300)):^(300),1:"")
"RTN","DGPTR2",40,0)
 D ADDQUES
"RTN","DGPTR2",41,0)
 ;-- sc related care
"RTN","DGPTR2",42,0)
 S Y=Y_$E(DGSC_" ")
"RTN","DGPTR2",43,0)
 ;-- ao related care
"RTN","DGPTR2",44,0)
 S Y=Y_$E(DGAO_" ")
"RTN","DGPTR2",45,0)
 ;-- ir related care
"RTN","DGPTR2",46,0)
 S Y=Y_$E(DGIR_" ")
"RTN","DGPTR2",47,0)
 ;-- ec related care
"RTN","DGPTR2",48,0)
 S Y=Y_$E(DGEC_" ")
"RTN","DGPTR2",49,0)
 ;-- mst related care
"RTN","DGPTR2",50,0)
 S Y=Y_$E(DGMST_" ")
"RTN","DGPTR2",51,0)
 ;-- Head/Neck CA related care
"RTN","DGPTR2",52,0)
 S Y=Y_$E(DGHNC_" ")
"RTN","DGPTR2",53,0)
 K DGAUX,DGDRUG,DGSC,DGAO,DGIR,DGEC,DGMST,DGHNC
"RTN","DGPTR2",54,0)
 D FILL^DGPTR2,SAVE
"RTN","DGPTR2",55,0)
 Q
"RTN","DGPTR2",56,0)
535 ; -- do 535's
"RTN","DGPTR2",57,0)
 D 535^DGPTR3
"RTN","DGPTR2",58,0)
 ;
"RTN","DGPTR2",59,0)
PROC ; -- setup 601 transactions
"RTN","DGPTR2",60,0)
 K ^UTILITY($J,"PROC") S I=0
"RTN","DGPTR2",61,0)
601 S I=$O(^DGPT(J,"P",I)) G 701:I'>0 S (X,DGPROC)=^(I,0) G 601:'DGPROC
"RTN","DGPTR2",62,0)
 G 601:DGPROC<T1!(DGPROC>T2) S DGPROCD=+^DGPT(J,"P",I,0),^UTILITY($J,"PROC",DGPROCD)=$S($D(^UTILITY($J,"PROC",DGPROCD)):^(DGPROCD),1:0)+1
"RTN","DGPTR2",63,0)
 I ^UTILITY($J,"PROC",DGPROCD)>1 W !,"More than one procedure record on same date/time" S DGERR=1 Q
"RTN","DGPTR2",64,0)
 S Y=$S('T1:"N",1:"C")_"60"_^(DGPROCD)_DGHEAD_$E(DGPROCD,4,7)_$E(DGPROCD,2,3)_$E($P(+X,".",2)_"0000",1,4)
"RTN","DGPTR2",65,0)
 ;replace specialty pointer (ien) with ptf code (alpha-numeric)
"RTN","DGPTR2",66,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTR2",67,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(X,U,2),.DGARRY)
"RTN","DGPTR2",68,0)
 S $P(X,U,2)=$G(DGARRY(7))
"RTN","DGPTR2",69,0)
 S L=2,Z=2 D ENTER0
"RTN","DGPTR2",70,0)
 S L=1,Z=3 S $P(X,U,Z)="" D ENTER ;null dialysis type. DG729
"RTN","DGPTR2",71,0)
 S L=3,Z=4 D ENTER0
"RTN","DGPTR2",72,0)
 S L=1 F K=5:1:9 S:'$P(DGPROC,U,K) DGPROC=$P(DGPROC,U,1,K-1)_U_$P(DGPROC,U,K+1,99),K=K-1 S L=L+1 Q:L=5
"RTN","DGPTR2",73,0)
 F K=5:1:9 S DGPTTMP=$$ICDOP^ICDCODE(+$P(DGPROC,U,K),$$GETDATE^ICDGTDRG(J)) D
"RTN","DGPTR2",74,0)
 . S Y=Y_$S(+DGPTTMP>0&($P(DGPTTMP,U,10)):$J($P($P(DGPTTMP,U,2),".",1),2)_$E($P($P(DGPTTMP,U,2),".",2)_"   ",1,3),1:"     ")_"  "
"RTN","DGPTR2",75,0)
 D FILL,SAVE G 601
"RTN","DGPTR2",76,0)
 Q
"RTN","DGPTR2",77,0)
 ;
"RTN","DGPTR2",78,0)
701 ; -- setup 701 transaction
"RTN","DGPTR2",79,0)
 D 701^DGPTR4 Q
"RTN","DGPTR2",80,0)
 ;
"RTN","DGPTR2",81,0)
ENTER S Y=Y_$J($P(X,U,Z),L)
"RTN","DGPTR2",82,0)
 Q
"RTN","DGPTR2",83,0)
 ;
"RTN","DGPTR2",84,0)
ENTER0 S Y=Y_$S($P(X,U,Z)]"":$E("00000",$L($P(X,U,Z))+1,L)_$P(X,U,Z),1:$J($P(X,U,Z),L))
"RTN","DGPTR2",85,0)
 Q
"RTN","DGPTR2",86,0)
 ;
"RTN","DGPTR2",87,0)
SAVE D START^DGPTR1 S:'DGERR ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTR2",88,0)
 I DGERR'>0 S DGACNT=DGACNT+1,^TMP("AEDIT",$J,$E(Y,1,4),DGACNT)=Y
"RTN","DGPTR2",89,0)
Q Q
"RTN","DGPTR2",90,0)
 ;
"RTN","DGPTR2",91,0)
FILL F K=$L(Y):1:124 S Y=Y_" "
"RTN","DGPTR2",92,0)
 Q
"RTN","DGPTR2",93,0)
 ;
"RTN","DGPTR2",94,0)
CDR S Y=Y_$E($P(Z,".")_"0000",1,4)_$E($P(Z,".",2)_"00",1,2)
"RTN","DGPTR2",95,0)
 Q
"RTN","DGPTR2",96,0)
ADDQUES ;-- additional PTF questions load records for trans 501/701
"RTN","DGPTR2",97,0)
 N DGADDQ
"RTN","DGPTR2",98,0)
 F DGADDQ=2,3,4 D  ;null results if discharge>inactive date. DG/729
"RTN","DGPTR2",99,0)
 . I +$P($G(^DIC(45.88,DGADDQ,0)),U,3) S $P(DGAUX,U,DGADDQ)=$S((+$G(^DGPT(J,70))<$P(^DIC(45.88,DGADDQ,0),U,3)):$P(DGAUX,U,DGADDQ),1:"")
"RTN","DGPTR2",100,0)
 S DGDRUG=$S($D(^DIC(45.61,+$P(DGAUX,U,4),0)):$P(^(0),U,2),1:"    ")
"RTN","DGPTR2",101,0)
 S Y=Y_$E($P(DGAUX,U,3)_" ")_$E($P(DGAUX,U,2)_" ")_$J($P(DGDRUG,U),4)
"RTN","DGPTR2",102,0)
 S Y=Y_$E($P(DGAUX,U,5)_" ")
"RTN","DGPTR2",103,0)
 S DGT=0,X=$P(DGAUX,U,6) I X]"" S DGT=1,Z=1,L=2 D ENTER0
"RTN","DGPTR2",104,0)
 I 'DGT S Y=Y_"  "
"RTN","DGPTR2",105,0)
 S DGT=0,X=$P(DGAUX,U,7) I X]"" S DGT=1,Z=1,L=2 D ENTER0
"RTN","DGPTR2",106,0)
 I 'DGT S Y=Y_"  "
"RTN","DGPTR2",107,0)
 Q
"RTN","DGPTR3")
0^36^B4042057^B3342657
"RTN","DGPTR3",1,0)
DGPTR3 ;ALB/JDS/MJK - ALB/BOK  PTF TRANSMISSION ; 01 DEC 87 @0800
"RTN","DGPTR3",2,0)
 ;;5.3;Registration;**183,729**;Aug 13, 1993;Build 59
"RTN","DGPTR3",3,0)
 ;
"RTN","DGPTR3",4,0)
535 ; -- setup 535 transactions
"RTN","DGPTR3",5,0)
 F I=0:0 S I=$O(^DGPT(J,535,I)) Q:'I  I $D(^(I,0)) S DGM=^(0),DGTD=+$P(DGM,U,10) I $P(DGM,U,17)'="n",'$P(DGM,U,7),'$D(^DGPT(J,"M","AM",DGTD)),DGTD'<T1,DGTD'>T2 D PHY
"RTN","DGPTR3",6,0)
 Q
"RTN","DGPTR3",7,0)
 ;
"RTN","DGPTR3",8,0)
PHY ; -- set up physcial mvt
"RTN","DGPTR3",9,0)
 S Y=$S(T1:"C",1:"N")_"535"_DGHEAD,X=$P(DGTD,".")_"       ",Y=Y_$E(X,4,5)_$E(X,6,7)_$E(X,2,3)_$E($P(DGTD,".",2)_"0000",1,4)
"RTN","DGPTR3",10,0)
 ; physical cdr
"RTN","DGPTR3",11,0)
 S Z=$P(DGM,U,16) D CDR^DGPTR2
"RTN","DGPTR3",12,0)
 ; physical specialty
"RTN","DGPTR3",13,0)
 ;replace specialty pointer (ien) with ptf code (alpha-numeric)
"RTN","DGPTR3",14,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTR3",15,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(DGM,U,2),.DGARRY)
"RTN","DGPTR3",16,0)
 S $P(DGM,U,2)=$G(DGARRY(7))
"RTN","DGPTR3",17,0)
 S L=2,X=DGM,Z=2 D ENTER0
"RTN","DGPTR3",18,0)
 ; find corresponding PTF mvt
"RTN","DGPTR3",19,0)
 S X="",Z=+$O(^DGPT(J,"M","AM",DGTD-.0000001)),Z=$S(Z:+$O(^(Z,0)),1:1) I $D(^DGPT(J,"M",Z,0)) S X=^(0) ; use d/c mvt if 'Z
"RTN","DGPTR3",20,0)
 ; specialty cdr
"RTN","DGPTR3",21,0)
 S Z=$P(X,U,16) D CDR^DGPTR2
"RTN","DGPTR3",22,0)
 ; specialty
"RTN","DGPTR3",23,0)
 ;replace specialty pointer (ien) with ptf code (alpha-numeric)
"RTN","DGPTR3",24,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTR3",25,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(X,U,2),.DGARRY)
"RTN","DGPTR3",26,0)
 S $P(X,U,2)=$G(DGARRY(7))
"RTN","DGPTR3",27,0)
 S L=2,Z=2 D ENTER0
"RTN","DGPTR3",28,0)
 ; 
"RTN","DGPTR3",29,0)
 ; convert pass, leave days >999 to 999
"RTN","DGPTR3",30,0)
 S X=DGM,L=3 F Z=3,4 S:$P(X,U,Z)>999 $P(X,U,Z)=999 D ENTER0
"RTN","DGPTR3",31,0)
 D FILL^DGPTR2,SAVE
"RTN","DGPTR3",32,0)
 K DGM,X,Z,L Q
"RTN","DGPTR3",33,0)
 ;
"RTN","DGPTR3",34,0)
ENTER S Y=Y_$J($P(X,U,Z),L)
"RTN","DGPTR3",35,0)
 Q
"RTN","DGPTR3",36,0)
 ;
"RTN","DGPTR3",37,0)
ENTER0 S Y=Y_$S($P(X,U,Z)]"":$E("00000",$L($P(X,U,Z))+1,L)_$P(X,U,Z),1:$J($P(X,U,Z),L))
"RTN","DGPTR3",38,0)
 Q
"RTN","DGPTR3",39,0)
 ;
"RTN","DGPTR3",40,0)
SAVE D START^DGPTR1 S:'DGERR ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTR3",41,0)
 I DGERR'>0 S DGACNT=DGACNT+1,^TMP("AEDIT",$J,$E(Y,1,4),DGACNT)=Y
"RTN","DGPTR3",42,0)
Q Q
"RTN","DGPTR4")
0^27^B20160961^B16197486
"RTN","DGPTR4",1,0)
DGPTR4 ;ALB/JDS/MJK/MTC/ADL - ALB/BOK  PTF TRANSMISSION ; 1/31/05 11:54am
"RTN","DGPTR4",2,0)
 ;;5.3;Registration;**338,423,415,510,565,645,729**;Aug 13, 1993;Build 59
"RTN","DGPTR4",3,0)
701 ; -- setup 701 transaction
"RTN","DGPTR4",4,0)
 S Y=$S(T1:"C",1:"N")_"701"_DGHEAD,DGDDX=$P(+DG70,".")_"       ",Y=Y_$E(DGDDX,4,5)_$E(DGDDX,6,7)_$E(DGDDX,2,3)_$E($P(+DG70,".",2)_"0000",1,4)
"RTN","DGPTR4",5,0)
 S X=DG70
"RTN","DGPTR4",6,0)
 ;replace specialty pointer (ien) with ptf code (alpha-numeric)
"RTN","DGPTR4",7,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTR4",8,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(X,U,2),.DGARRY)
"RTN","DGPTR4",9,0)
 S $P(X,U,2)=$G(DGARRY(7))
"RTN","DGPTR4",10,0)
 S (L,Z)=2 D ENTER0 K DGDDX
"RTN","DGPTR4",11,0)
 S X=DG70 I "467"[($P(X,U,3)\1) S Y=Y_$P(X,U,3)_"         " G J
"RTN","DGPTR4",12,0)
 S L=1 F Z=3:1:5 D ENTER
"RTN","DGPTR4",13,0)
 S Y=Y_$S($D(^DIC(45.6,+$P(X,U,6),0)):$P(^(0),U,2),1:" "),L=3,Z=12 D ENTER S Y=Y_$E($P(X,U,13)_"   ",1,3)
"RTN","DGPTR4",14,0)
J S L=3,Z=8 D ENTER0
"RTN","DGPTR4",15,0)
 S Y=Y_"X"_$J($P(DG70,U,9),1)
"RTN","DGPTR4",16,0)
 S DGPTDAT=$$GETDATE^ICDGTDRG(J)
"RTN","DGPTR4",17,0)
 S DGPTTMP=$$ICDDX^ICDCODE(+$P(DG70,U,10),DGPTDAT) S DGXLS=$S(+DGPTTMP>0&($P(DGPTTMP,U,10)):$P(DGPTTMP,U,2),1:""),Y=Y_$S(DGXLS[".":$J($P(DGXLS,".",1),3)_$E($P(DGXLS,".",2)_"   ",1,3),1:$J(DGXLS,6))_" "
"RTN","DGPTR4",18,0)
 S L=$P(DG70,U,16,24)_U_DG71 S DG702=""
"RTN","DGPTR4",19,0)
 F K=1:1:12 S DGPTTMP=$$ICDDX^ICDCODE(+$P(L,U,K),DGPTDAT) I +DGPTTMP>0&($P(DGPTTMP,U,10)) S DG702=DG702_$P(DGPTTMP,U,2)_U
"RTN","DGPTR4",20,0)
 S Y=Y_$S(DG702']"":"X",1:" ")
"RTN","DGPTR4",21,0)
 ; -- get phy cdr @ d/c
"RTN","DGPTR4",22,0)
 S X="",Z=+$O(^DGPT(J,535,"AM",DG70-.0000001)) I $D(^DGPT(J,535,+$O(^(Z,0)),0)) S X=^(0)
"RTN","DGPTR4",23,0)
 ; -- set phy cdr
"RTN","DGPTR4",24,0)
 S Z=$P(X,U,16) D CDR
"RTN","DGPTR4",25,0)
 ; -- set phy spec
"RTN","DGPTR4",26,0)
 ;replace specialty pointer (ien) with ptf code (alpha-numeric)
"RTN","DGPTR4",27,0)
 N DGARRX,DGARRY ;DG729
"RTN","DGPTR4",28,0)
 S DGARRX=$$TSDATA^DGACT(42.4,$P(X,U,2),.DGARRY)
"RTN","DGPTR4",29,0)
 S $P(X,U,2)=$G(DGARRY(7))
"RTN","DGPTR4",30,0)
 S L=2,Z=2 D ENTER0
"RTN","DGPTR4",31,0)
 S X=$S($P(DG3,U)="Y":$$RTEN($P(DG3,U,2)),1:"0"),L=3,Z=1 D ENTER0
"RTN","DGPTR4",32,0)
 ;-- additional ptf questions
"RTN","DGPTR4",33,0)
 S DGAUX=$S($D(^DGPT(J,300)):^(300),1:"")
"RTN","DGPTR4",34,0)
 D ADDQUES
"RTN","DGPTR4",35,0)
 K DGAUX,DGDRUG
"RTN","DGPTR4",36,0)
 ;-- sc,ao,ir,ec questions
"RTN","DGPTR4",37,0)
 S X=DG70
"RTN","DGPTR4",38,0)
 ;-- sc
"RTN","DGPTR4",39,0)
 S Y=Y_$E($P(DG70,U,25)_" ")
"RTN","DGPTR4",40,0)
 ;-- ao
"RTN","DGPTR4",41,0)
 S Y=Y_$E($P(DG70,U,26)_" ")
"RTN","DGPTR4",42,0)
 ;-- ir
"RTN","DGPTR4",43,0)
 S Y=Y_$E($P(DG70,U,27)_" ")
"RTN","DGPTR4",44,0)
 ;-- ec
"RTN","DGPTR4",45,0)
 S Y=Y_$E($P(DG70,U,28)_" ")
"RTN","DGPTR4",46,0)
 ;-- mst
"RTN","DGPTR4",47,0)
 S Y=Y_$E($P(DG70,U,29)_" ")
"RTN","DGPTR4",48,0)
 ;-- Head/Neck CA
"RTN","DGPTR4",49,0)
 S Y=Y_$E($P(DG70,U,30)_" ")
"RTN","DGPTR4",50,0)
 D ETHNIC
"RTN","DGPTR4",51,0)
 D RACE
"RTN","DGPTR4",52,0)
 ;Combat vet
"RTN","DGPTR4",53,0)
 S Y=Y_$E($P(DG70,U,31)_" ")
"RTN","DGPTR4",54,0)
 D FILL
"RTN","DGPTR4",55,0)
 I T1 F K=41:1:55,65:1:73 S Y=$E(Y,1,K-1)_" "_$E(Y,K+1,125)
"RTN","DGPTR4",56,0)
 I T1 D CEN^DGPTR1 S:'DGERR ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1 Q
"RTN","DGPTR4",57,0)
 I 'T1 D SAVE
"RTN","DGPTR4",58,0)
702 ;
"RTN","DGPTR4",59,0)
 Q:DG702']""
"RTN","DGPTR4",60,0)
 S Y="N702"_$E(Y,5,40)
"RTN","DGPTR4",61,0)
 F K=1:1:12 S F=$P(DG702,U,K),F=$P(F,".",1)_$E($P(F,".",2)_"   ",1,3),F=F_$E("      ",1,7-$L(F)),Y=Y_F
"RTN","DGPTR4",62,0)
 D FILL
"RTN","DGPTR4",63,0)
 I 'DGERR S ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTR4",64,0)
 I DGERR'>0 S DGACNT=DGACNT+1,^TMP("AEDIT",$J,$E(Y,1,4),DGACNT)=Y
"RTN","DGPTR4",65,0)
 S DG702=$P(DG702,U,6,9)
"RTN","DGPTR4",66,0)
 Q
"RTN","DGPTR4",67,0)
 ;
"RTN","DGPTR4",68,0)
ENTER S Y=Y_$J($P(X,U,Z),L)
"RTN","DGPTR4",69,0)
 Q
"RTN","DGPTR4",70,0)
 ;
"RTN","DGPTR4",71,0)
ENTER0 S Y=Y_$S($P(X,U,Z)]"":$E("00000",$L($P(X,U,Z))+1,L)_$P(X,U,Z),1:$J($P(X,U,Z),L))
"RTN","DGPTR4",72,0)
 Q
"RTN","DGPTR4",73,0)
 ;
"RTN","DGPTR4",74,0)
SAVE D START^DGPTR1 S:'DGERR ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTR4",75,0)
 I DGERR'>0 S DGACNT=DGACNT+1,^TMP("AEDIT",$J,$E(Y,1,4),DGACNT)=Y
"RTN","DGPTR4",76,0)
Q Q
"RTN","DGPTR4",77,0)
 ;
"RTN","DGPTR4",78,0)
FILL F K=$L(Y):1:124 S Y=Y_" "
"RTN","DGPTR4",79,0)
 Q
"RTN","DGPTR4",80,0)
 ;
"RTN","DGPTR4",81,0)
CDR S Y=Y_$E($P(Z,".")_"0000",1,4)_$E($P(Z,".",2)_"00",1,2)
"RTN","DGPTR4",82,0)
 Q
"RTN","DGPTR4",83,0)
ADDQUES ;-- additional PTF questions load records for trans 501/701
"RTN","DGPTR4",84,0)
 N DGADDQ
"RTN","DGPTR4",85,0)
 F DGADDQ=2,3,4 D  ;null results if discharge>inactive date. DG/729
"RTN","DGPTR4",86,0)
 . I +$P($G(^DIC(45.88,DGADDQ,0)),U,3) S $P(DGAUX,U,DGADDQ)=$S((+$G(^DGPT(J,70))<$P(^DIC(45.88,DGADDQ,0),U,3)):$P(DGAUX,U,DGADDQ),1:"")
"RTN","DGPTR4",87,0)
 S DGDRUG=$S($D(^DIC(45.61,+$P(DGAUX,U,4),0)):$P(^(0),U,2),1:"    ")
"RTN","DGPTR4",88,0)
 S Y=Y_$E($P(DGAUX,U,3)_" ")_$E($P(DGAUX,U,2)_" ")_$J($P(DGDRUG,U),4)
"RTN","DGPTR4",89,0)
 S Y=Y_$E($P(DGAUX,U,5)_" ")
"RTN","DGPTR4",90,0)
 S DGT=0,X=$P(DGAUX,U,6) I X]"" S DGT=1,Z=1,L=2 D ENTER0
"RTN","DGPTR4",91,0)
 I 'DGT S Y=Y_"  "
"RTN","DGPTR4",92,0)
 S DGT=0,X=$P(DGAUX,U,7) I X]"" S DGT=1,Z=1,L=2 D ENTER0
"RTN","DGPTR4",93,0)
 I 'DGT S Y=Y_"  "
"RTN","DGPTR4",94,0)
 Q
"RTN","DGPTR4",95,0)
RTEN(X) ; This function will round X to the nearest mulitple of ten.
"RTN","DGPTR4",96,0)
 ; 0-4 ->DOWN; 5-9->UP
"RTN","DGPTR4",97,0)
 Q (X\10)*10+$S(X#10>4:10,1:0)
"RTN","DGPTR4",98,0)
ETHNIC ;-- Ethnicity (use first active value)
"RTN","DGPTR4",99,0)
 N NODE,NUM,ETHNIC,I,X
"RTN","DGPTR4",100,0)
 S ETHNIC=""
"RTN","DGPTR4",101,0)
 S I=0
"RTN","DGPTR4",102,0)
 S NUM=1
"RTN","DGPTR4",103,0)
 F  S I=+$O(DG06(I)) Q:'I  D  Q:NUM>1
"RTN","DGPTR4",104,0)
 .S NODE=$G(DG06(I,0))
"RTN","DGPTR4",105,0)
 .Q:('NODE)!('$D(^DIC(10.2,+NODE,0)))
"RTN","DGPTR4",106,0)
 .Q:$$INACTIVE^DGUTL4(+NODE)
"RTN","DGPTR4",107,0)
 .S X=$$PTR2CODE^DGUTL4(+NODE,2,4)
"RTN","DGPTR4",108,0)
 .S ETHNIC=$S(X="":" ",1:X)
"RTN","DGPTR4",109,0)
 .S X=$$PTR2CODE^DGUTL4(+$P(NODE,"^",2),3,4)
"RTN","DGPTR4",110,0)
 .S ETHNIC=ETHNIC_$S(X="":" ",1:X)
"RTN","DGPTR4",111,0)
 .S NUM=NUM+1
"RTN","DGPTR4",112,0)
 S Y=Y_$S(ETHNIC="":"  ",1:ETHNIC)
"RTN","DGPTR4",113,0)
 Q
"RTN","DGPTR4",114,0)
RACE ;-- Race (use first 6 active values)
"RTN","DGPTR4",115,0)
 N NODE,NUM,RACE,I,X
"RTN","DGPTR4",116,0)
 S RACE=""
"RTN","DGPTR4",117,0)
 S I=0
"RTN","DGPTR4",118,0)
 S NUM=1
"RTN","DGPTR4",119,0)
 F  S I=+$O(DG02(I)) Q:'I  D  Q:NUM>6
"RTN","DGPTR4",120,0)
 .S NODE=$G(DG02(I,0))
"RTN","DGPTR4",121,0)
 .Q:('NODE)!('$D(^DIC(10,+NODE,0)))
"RTN","DGPTR4",122,0)
 .Q:$$INACTIVE^DGUTL4(+NODE)
"RTN","DGPTR4",123,0)
 .S X=$$PTR2CODE^DGUTL4(+NODE,1,4)
"RTN","DGPTR4",124,0)
 .S RACE=RACE_$S(X="":" ",1:X)
"RTN","DGPTR4",125,0)
 .S X=$$PTR2CODE^DGUTL4(+$P(NODE,"^",2),3,4)
"RTN","DGPTR4",126,0)
 .S RACE=RACE_$S(X="":" ",1:X)
"RTN","DGPTR4",127,0)
 .S NUM=NUM+1
"RTN","DGPTR4",128,0)
 S X="" S $P(X," ",12)=""
"RTN","DGPTR4",129,0)
 S RACE=$S(RACE="":"  ",1:RACE)_X
"RTN","DGPTR4",130,0)
 S Y=Y_$E(RACE,1,12)
"RTN","DGPTR4",131,0)
 Q
"RTN","DGPTSCAN")
0^3^B23094075^B19938447
"RTN","DGPTSCAN",1,0)
DGPTSCAN ;ALB/MTC - SPECIAL ACTION SCAN PROCESS ; 1 MAR 91
"RTN","DGPTSCAN",2,0)
 ;;5.3;Registration;**29,64,114,189,729**;Aug 13, 1993;Build 59
"RTN","DGPTSCAN",3,0)
 ;;MAS 5.1
"RTN","DGPTSCAN",4,0)
CHK501 ;--
"RTN","DGPTSCAN",5,0)
 D INIT G ENQ:DGOUT
"RTN","DGPTSCAN",6,0)
 G ENQ:'$D(^DGPT(DGPTF,"M",+DGMOV,0)) S DGREC=^(0)
"RTN","DGPTSCAN",7,0)
 F DGI=5:1:9 I $P(DGREC,U,DGI) S DGPTIT($P(DGREC,U,DGI)_";ICD9(")=""
"RTN","DGPTSCAN",8,0)
 S DGHOLD=$S($D(^DGPT(DGPTF,"M",+DGMOV,300)):^(300),1:"")
"RTN","DGPTSCAN",9,0)
 D SCAN
"RTN","DGPTSCAN",10,0)
 I '$D(DGBPC),DGHOLD']"" G CHK5Q
"RTN","DGPTSCAN",11,0)
 S DIE="^DGPT(",DA=DGPTF,DR="[DGPT 501 CLEANUP]"
"RTN","DGPTSCAN",12,0)
 D ^DIE
"RTN","DGPTSCAN",13,0)
 ;;
"RTN","DGPTSCAN",14,0)
 ;;ADDED FOR GAF ENHANCEMENT 6/2/98
"RTN","DGPTSCAN",15,0)
 ;;Gathers GAF Score, GAF Date, GAF Provider and sends to
"RTN","DGPTSCAN",16,0)
 ;;Mental Health package
"RTN","DGPTSCAN",17,0)
 N DGGAFSC,DGGAFDT,DGGAFPR,DGDFN
"RTN","DGPTSCAN",18,0)
 S DGGAFSC=$P(DGHOLD,"^",6),DGDFN=$P(^DGPT(DGPTF,0),"^")
"RTN","DGPTSCAN",19,0)
 S DGGAFDT=$P(^DGPT(DGPTF,0),"^",2)\1
"RTN","DGPTSCAN",20,0)
 S DGGAFPR=$P($G(^DGPT(DGPTF,"M",+DGMOV,"P")),"^",5) ;Provider
"RTN","DGPTSCAN",21,0)
 D UPD^YSGAF(DGDFN,DGGAFSC,DGGAFDT,DGGAFPR,"I")
"RTN","DGPTSCAN",22,0)
 ;;END GAF ENHANCEMENTS
"RTN","DGPTSCAN",23,0)
 ;;
"RTN","DGPTSCAN",24,0)
CHK5Q K DA,DR,DGHOLD,DGBPC,DGPTIT,DIE,DGREC,DGI,DGSCDT,DGSTART,DGTREC,DGOUT
"RTN","DGPTSCAN",25,0)
 Q
"RTN","DGPTSCAN",26,0)
 ;
"RTN","DGPTSCAN",27,0)
CHK601 ;--
"RTN","DGPTSCAN",28,0)
 D INIT G ENQ:DGOUT
"RTN","DGPTSCAN",29,0)
 G ENQ:'$D(^DGPT(DGPTF,"P",+P(DGZP,1),0)) S DGREC=^(0)
"RTN","DGPTSCAN",30,0)
 F DGI=5:1:9 I $P(DGREC,U,DGI) S DGPTIT($P(DGREC,U,DGI)_";ICD0(")=""
"RTN","DGPTSCAN",31,0)
 S DGHOLD=DGREC
"RTN","DGPTSCAN",32,0)
 D SCAN
"RTN","DGPTSCAN",33,0)
 I '$D(DGBPC(8)),$P(DGHOLD,U,4)']"" G CHK6Q
"RTN","DGPTSCAN",34,0)
 S DIE="^DGPT(",DA=DGPTF,DR="[DGPT 601 CLEANUP]"
"RTN","DGPTSCAN",35,0)
 D ^DIE
"RTN","DGPTSCAN",36,0)
CHK6Q K DA,DR,DGHOLD,DGBPC,DGPTIT,DIE,DGREC,DGI,DGOUT
"RTN","DGPTSCAN",37,0)
 Q
"RTN","DGPTSCAN",38,0)
CHK401 ;-- 
"RTN","DGPTSCAN",39,0)
 D INIT G ENQ:DGOUT
"RTN","DGPTSCAN",40,0)
 G ENQ:'$D(^DGPT(DGPTF,"S",+DGSUR,0)) S DGREC=^(0)
"RTN","DGPTSCAN",41,0)
 F DGI=8:1:12 I $P(DGREC,U,DGI) S DGPTIT($P(DGREC,U,DGI)_";ICD0(")=""
"RTN","DGPTSCAN",42,0)
 S DGHOLD=$S($D(^DGPT(DGPTF,"S",+DGSUR,300)):^(300),1:"")
"RTN","DGPTSCAN",43,0)
 D SCAN
"RTN","DGPTSCAN",44,0)
 I '$D(DGBPC),DGHOLD']"" G CHK4Q
"RTN","DGPTSCAN",45,0)
 S DIE="^DGPT(",DA=DGPTF,DR="[DGPT 401 CLEANUP]"
"RTN","DGPTSCAN",46,0)
 D ^DIE
"RTN","DGPTSCAN",47,0)
CHK4Q K DA,DR,DGHOLD,DGBPC,DGPTIT,DIE,DGREC,DGI,DGSCDT,DGSTART,DGTREC,DGOUT
"RTN","DGPTSCAN",48,0)
 Q
"RTN","DGPTSCAN",49,0)
 ;
"RTN","DGPTSCAN",50,0)
CHK701 ;-- will get data from flagchk then stuff into 701 (300 node)
"RTN","DGPTSCAN",51,0)
 G CHK7Q:'$D(^DGPT(DGPTF,70)) S DGREC=^(70)
"RTN","DGPTSCAN",52,0)
 F DGI=10,16:1:24 I $P(DGREC,U,DGI) S DGPTIT($P(DGREC,U,DGI)_";ICD9(")=""
"RTN","DGPTSCAN",53,0)
 D DC,SCAN,ANYPSY,FLAGCHK
"RTN","DGPTSCAN",54,0)
 S DGREC=$S($D(^DGPT(DGPTF,300)):^(300),1:""),DR="",DA=DGPTF,DIE="^DGPT("
"RTN","DGPTSCAN",55,0)
 D GETNUM
"RTN","DGPTSCAN",56,0)
 F DGII=2:1:DGFNUM S DR=DR_$S($P(DG701,U,DGII)]""&($P(DG701,U,DGII)'=$P(DGREC,U,DGII)):"300.0"_DGII_"////"_$P(DG701,U,DGII)_";",'$D(DGBPC(DGII))&($P(DGREC,U,DGII)]"")&($P(DG701,U,DGII)']""):"300.0"_DGII_"////@;",1:"")
"RTN","DGPTSCAN",57,0)
CHK7J I DR]"" D ^DIE
"RTN","DGPTSCAN",58,0)
CHK7Q ;
"RTN","DGPTSCAN",59,0)
 K DGII,DA,DR,DIE,DG701,DGI,DGT,DGREC,DGFNUM,DGSCDT,DGSTART,DGTREC,DGOUT
"RTN","DGPTSCAN",60,0)
 Q
"RTN","DGPTSCAN",61,0)
FLAGCHK ;-- build 701 from 501 responses, kill flags if necessary
"RTN","DGPTSCAN",62,0)
 S DG701="",DGOUT=0
"RTN","DGPTSCAN",63,0)
 F DGI=0:0 S DGI=$O(^DGPT(DGPTF,"M","AM",DGI)) Q:DGI'>0  F DGJ=0:0 S DGJ=$O(^DGPT(DGPTF,"M","AM",DGI,DGJ)) Q:DGJ'>0  I $D(^DGPT(DGPTF,"M",DGJ,300)) S DGHOLD=^(300) D FL1
"RTN","DGPTSCAN",64,0)
 S DGNDIS=$S('$D(^DGPT(DGPTF,70)):0,1:+^(70))
"RTN","DGPTSCAN",65,0)
 I DGNDIS'>0,$D(^DGPT(DGPTF,"M",1,300)) S DGHOLD=^(300) D FL1
"RTN","DGPTSCAN",66,0)
FLAGQ K DGI,DGNDIS
"RTN","DGPTSCAN",67,0)
 Q
"RTN","DGPTSCAN",68,0)
FL1 ;
"RTN","DGPTSCAN",69,0)
 D GETNUM
"RTN","DGPTSCAN",70,0)
 F DGII=2:1:DGFNUM I $P(DGHOLD,U,DGII)]"",$P(DG701,U,DGII)']"" S $P(DG701,U,DGII)=$P(DGHOLD,U,DGII) K DGBPC(DGII)
"RTN","DGPTSCAN",71,0)
FL1Q K DGII,DGHOLD,DGK,DGFNUM
"RTN","DGPTSCAN",72,0)
 Q
"RTN","DGPTSCAN",73,0)
 ;
"RTN","DGPTSCAN",74,0)
SCAN ;-- process DGPTIT array
"RTN","DGPTSCAN",75,0)
 K DGBPC
"RTN","DGPTSCAN",76,0)
 D ISPSY
"RTN","DGPTSCAN",77,0)
 G:'$D(DGPTIT) SCANQ
"RTN","DGPTSCAN",78,0)
 D DC ;return discharge date or current date in DGSCDT
"RTN","DGPTSCAN",79,0)
 S DGI="" F DGJ=0:0 S DGI=$O(DGPTIT(DGI)) Q:DGI=""  F DGK=0:0 S DGK=$O(^DIC(45.89,"ASPL",DGI,DGK)) Q:'DGK  D S1
"RTN","DGPTSCAN",80,0)
SCANQ ;
"RTN","DGPTSCAN",81,0)
 K DGSPEC,DGI,DGJ,DGK
"RTN","DGPTSCAN",82,0)
 Q
"RTN","DGPTSCAN",83,0)
 ;
"RTN","DGPTSCAN",84,0)
S1 ;-- check inactive dates, set flag array
"RTN","DGPTSCAN",85,0)
 G S1Q:'$D(^DIC(45.89,DGK,0)) S X=^(0)
"RTN","DGPTSCAN",86,0)
 I $P(X,U,3)]"",$D(DGSCDT) G S1Q:DGSCDT>$P(X,U,3)
"RTN","DGPTSCAN",87,0)
 S Y=+X
"RTN","DGPTSCAN",88,0)
 G S1Q:'$D(^DIC(45.88,Y,0)) S X=^(0)
"RTN","DGPTSCAN",89,0)
 I $P(X,U,3)]"",$D(DGSCDT) G S1Q:DGSCDT>$P(X,U,3)
"RTN","DGPTSCAN",90,0)
 I $P(X,U,2)]"" S X=$P(X,U,2) F DGII=1:1 S Y=$P(X,",",DGII) Q:'Y  D FLGFIL
"RTN","DGPTSCAN",91,0)
S1Q ;
"RTN","DGPTSCAN",92,0)
 K X,Y,DGII
"RTN","DGPTSCAN",93,0)
 Q
"RTN","DGPTSCAN",94,0)
 ;
"RTN","DGPTSCAN",95,0)
DC ;-- find discharge date
"RTN","DGPTSCAN",96,0)
 S DGSCDT=$S('$D(^DGPT(PTF,70)):DT,^(70):+^(70),1:DT)
"RTN","DGPTSCAN",97,0)
 Q
"RTN","DGPTSCAN",98,0)
 ;
"RTN","DGPTSCAN",99,0)
ENQ ;
"RTN","DGPTSCAN",100,0)
 K DG701,DGSTART,DGI,DGOUT,DGREC,DGBPC,DGPTIT,DGTREC,DGSCDT
"RTN","DGPTSCAN",101,0)
 Q
"RTN","DGPTSCAN",102,0)
 ;
"RTN","DGPTSCAN",103,0)
GETNUM ;-- returns the number of additional questions/flags
"RTN","DGPTSCAN",104,0)
 S DGFNUM=7
"RTN","DGPTSCAN",105,0)
 Q
"RTN","DGPTSCAN",106,0)
 ;
"RTN","DGPTSCAN",107,0)
INIT ;-- init routine
"RTN","DGPTSCAN",108,0)
 S DGOUT=0,(DGTREC,DGHOLD)=""
"RTN","DGPTSCAN",109,0)
 ;-- DGSTART should be set to 2910930 for national release
"RTN","DGPTSCAN",110,0)
 S DGSTART=2910930
"RTN","DGPTSCAN",111,0)
 D DC
"RTN","DGPTSCAN",112,0)
 D LO^DGUTL,HOME^%ZIS
"RTN","DGPTSCAN",113,0)
 K DGPTIT
"RTN","DGPTSCAN",114,0)
INITQ ;
"RTN","DGPTSCAN",115,0)
 Q
"RTN","DGPTSCAN",116,0)
 ;
"RTN","DGPTSCAN",117,0)
ANYPSY ;-- will go through all movements check for PSYCH specialty
"RTN","DGPTSCAN",118,0)
 N DGMOV
"RTN","DGPTSCAN",119,0)
 K DGPSY
"RTN","DGPTSCAN",120,0)
 I '$D(^DGPT(DGPTF,"M")) G ANYQ
"RTN","DGPTSCAN",121,0)
 F DGMOV=0:0 S DGMOV=$O(^DGPT(DGPTF,"M",DGMOV)) Q:'DGMOV  D ISPSY I $D(DGSPEC) S DGPSY=""
"RTN","DGPTSCAN",122,0)
 I '$D(DGPSY) K DGBPC(5),DGBPC(6),DGBPC(7)
"RTN","DGPTSCAN",123,0)
ANYQ ;
"RTN","DGPTSCAN",124,0)
 K DGSPEC
"RTN","DGPTSCAN",125,0)
 Q
"RTN","DGPTSCAN",126,0)
ISPSY ;-- check if losing specialty is in psych range set flag.
"RTN","DGPTSCAN",127,0)
 ;-- if psych then $D(DGSPEC)
"RTN","DGPTSCAN",128,0)
 K DGSPEC
"RTN","DGPTSCAN",129,0)
 I '$D(DGMOV) S DGSPEC="" G ISPSYQ
"RTN","DGPTSCAN",130,0)
 I $D(DGMOV) S DGSPEC=$P(^DGPT(DGPTF,"M",DGMOV,0),U,2) I '$P($G(^DIC(42.4,+DGSPEC,0)),U,4) K DGSPEC
"RTN","DGPTSCAN",131,0)
ISPSYQ Q
"RTN","DGPTSCAN",132,0)
 ;
"RTN","DGPTSCAN",133,0)
FLGFIL ;-- fill DGBPC with correct flag.
"RTN","DGPTSCAN",134,0)
 I '$D(DGSPEC),Y>4,Y<8 G FLGFILQ
"RTN","DGPTSCAN",135,0)
 S DGBPC(Y)=""
"RTN","DGPTSCAN",136,0)
FLGFILQ ;
"RTN","DGPTSCAN",137,0)
 Q
"RTN","DGPTSCAN",138,0)
 ;
"RTN","DGPTSCAN",139,0)
ANYSC(PTF) ;-- will go through all movements check for sc treatment
"RTN","DGPTSCAN",140,0)
 ;  INPUT - ptf record ien to check
"RTN","DGPTSCAN",141,0)
 ;  OUTPUT- 1 sc treatment, 0 no sc treatment
"RTN","DGPTSCAN",142,0)
 N DGMOV,RESULT
"RTN","DGPTSCAN",143,0)
 S RESULT=0
"RTN","DGPTSCAN",144,0)
 I '$D(^DGPT(PTF,"M")) G ANYSCQ
"RTN","DGPTSCAN",145,0)
 S DGMOV=0 F  S DGMOV=$O(^DGPT(PTF,"M",DGMOV)) Q:'DGMOV  I $P(^(DGMOV,0),U,18)=1 S RESULT=1 Q
"RTN","DGPTSCAN",146,0)
ANYSCQ ;
"RTN","DGPTSCAN",147,0)
 Q RESULT
"RTN","DGPTSCAN",148,0)
 ;
"RTN","DGPTTS3")
0^22^B22744602^B22737106
"RTN","DGPTTS3",1,0)
DGPTTS3 ;ALB/MJK - Physical Mvt ; 11/30/06 8:46am
"RTN","DGPTTS3",2,0)
 ;;5.3;Registration;**26,61,549,729**;Aug 13, 1993;Build 59
"RTN","DGPTTS3",3,0)
 ;
"RTN","DGPTTS3",4,0)
EN ; -- entry used to update PTF rec
"RTN","DGPTTS3",5,0)
 ;  input: PTF := PTF#
"RTN","DGPTTS3",6,0)
 ;         DFN := pt#
"RTN","DGPTTS3",7,0)
 ;      DGPMCA := adm mvt #
"RTN","DGPTTS3",8,0)
 ;        DGDT := d/c date
"RTN","DGPTTS3",9,0)
 ;
"RTN","DGPTTS3",10,0)
 S DGPTIFN=PTF
"RTN","DGPTTS3",11,0)
 D FDT^DGPTUTL G ENQ:$S(DGDT:DGDT,1:DT)<Y
"RTN","DGPTTS3",12,0)
 I '$D(ZTQUEUED),'$G(DGQUIET) W !,"Now updating ward MPCR information..."
"RTN","DGPTTS3",13,0)
 S (DGBEG,DGSTART,DGLAST)=Y-.0000001
"RTN","DGPTTS3",14,0)
 S X=Y I $E(X,6,7)="00" S X1=X,X2=-1 D C^%DTC
"RTN","DGPTTS3",15,0)
 S DGPFYDT=$P(X,".")_".2359" ; last date/time in previous FY
"RTN","DGPTTS3",16,0)
 D KILL
"RTN","DGPTTS3",17,0)
 N DGRT S DGRT="^DGPM(""APCA"",DFN,DGPMCA)"
"RTN","DGPTTS3",18,0)
 ;
"RTN","DGPTTS3",19,0)
 ; -- build ward table
"RTN","DGPTTS3",20,0)
 S DGDATA="",DGADM0=$S($D(^DGPM(DGPMCA,0)):^(0),1:"")
"RTN","DGPTTS3",21,0)
 I DGADM0,DGADM0'>DGSTART S DGT=DGPFYDT D ^DGINPW I +DG1 S $P(DGXFR0,U,4)=+DG1 D TABLE
"RTN","DGPTTS3",22,0)
 I DGADM0,DGADM0>DGSTART S $P(DGXFR0,U,4)=$P(DGADM0,U,6),DGBEG=+DGADM0 D TABLE
"RTN","DGPTTS3",23,0)
 F DGXDT=DGSTART:0 S DGXDT=$O(@DGRT@(DGXDT)) Q:'DGXDT  F DGMVT=0:0 S DGMVT=$O(@DGRT@(DGXDT,DGMVT)) Q:'DGMVT  I $D(^DGPM(DGMVT,0)) S X=^(0) I $P(X,U,2)=2 S DGXFR0=$P(X,U,18)_"^^^"_$P(X,U,6) D TABLE
"RTN","DGPTTS3",24,0)
 G ENQ:DGDATA=""
"RTN","DGPTTS3",25,0)
 S DGEND=$S(DGDT:DGDT,1:DT) D DAYS S DGXDT=($S(DGDT:DGDT,1:"")),$P(DGDATA,U,3,4)=LEAVE_U_PASS,$P(DGDATA,U,7)=1 D CREATE
"RTN","DGPTTS3",26,0)
 ;
"RTN","DGPTTS3",27,0)
ENQ I $D(DGSACNT),DGSACNT>25 D FLCHK
"RTN","DGPTTS3",28,0)
 S L=DGPTIFN
"RTN","DGPTTS3",29,0)
 K DGRT,DGADM0,DG1,DGDATA,DGMDT,DGPTIFN,DGXFR0,DGXDT,DGM,X,DGM0,LEAVE,PASS,DGBEG,DGEND,DGSTART,DGWD,DGCDR,DGSP,DGADM0,DGPFYDT,DGT,DGA1,DGSAFTF,DGSACNT,DGWI,DGI
"RTN","DGPTTS3",30,0)
 Q
"RTN","DGPTTS3",31,0)
 ;
"RTN","DGPTTS3",32,0)
TABLE ; -- setup 535 node data
"RTN","DGPTTS3",33,0)
 ;  DGDATA := 1:ward cdr ^ 2:ward specialty  ^ 3:leave days ^ 4:pass days ^ ^ 6:ward ^ ^ ^ ^ 10:mvt date/time
"RTN","DGPTTS3",34,0)
 ;
"RTN","DGPTTS3",35,0)
 S DGWD=+$P(DGXFR0,U,4)
"RTN","DGPTTS3",36,0)
 G TABLEQ:'$D(^DIC(42,DGWD,0)) S DGSP=+$P(^(0),U,12)
"RTN","DGPTTS3",37,0)
 G TABLEQ:'$D(^DIC(42.4,DGSP,0)) S DGCDR=$P(^(0),U,6)
"RTN","DGPTTS3",38,0)
 ; -- create MPCR mvt if ward mpcr changes
"RTN","DGPTTS3",39,0)
 I DGDATA]"",+DGDATA'=DGCDR S DGEND=DGXDT D DAYS S $P(DGDATA,U,3,4)=LEAVE_U_PASS D CREATE S DGDATA=DGCDR_"^"_DGSP_"^^^^"_DGWD,DGLAST=DGBEG,DGBEG=DGEND
"RTN","DGPTTS3",40,0)
 I DGDATA="",DGCDR]"" S DGDATA=DGCDR_"^"_DGSP_"^^^^"_DGWD
"RTN","DGPTTS3",41,0)
TABLEQ Q
"RTN","DGPTTS3",42,0)
 ;
"RTN","DGPTTS3",43,0)
CREATE ; -- create MPCR mvt
"RTN","DGPTTS3",44,0)
 L +^DGPT(DGPTIFN,535) S Y=^DGPT(DGPTIFN,535,0),I=$P(Y,U,3)
"RTN","DGPTTS3",45,0)
L S I=I+1 G L:$D(^DGPT(DGPTIFN,535,I))
"RTN","DGPTTS3",46,0)
 S $P(^DGPT(DGPTIFN,535,0),U,3,4)=I_U_($P(Y,U,4)+1)
"RTN","DGPTTS3",47,0)
 S X=DGDATA,^DGPT(DGPTIFN,535,I,0)=I_U_$P(X,U,2)_U_$P(X,U,3)_U_$P(X,U,4)_"^^"_$P(X,U,6)_"^"_$P(X,U,7)_"^^^"_DGXDT L -^DGPT(DGPTIFN,535)
"RTN","DGPTTS3",48,0)
 K DA S DA=I,DA(1)=DGPTIFN,DIK="^DGPT("_DGPTIFN_",535," D IX1^DIK
"RTN","DGPTTS3",49,0)
CREATEQ S DGSACNT=I
"RTN","DGPTTS3",50,0)
 K DA,I,DIK Q
"RTN","DGPTTS3",51,0)
 ;
"RTN","DGPTTS3",52,0)
KILL ; -- clean out ward mvts
"RTN","DGPTTS3",53,0)
 F DGWI=0:0 S DGWI=$O(^DGPT(DGPTIFN,535,DGWI)) Q:'DGWI  S:$P(^(DGWI,0),U,17)="n" DGSAFTF(DGWI)=^(0) K DA S DA(1)=DGPTIFN,DA=DGWI,DIK="^DGPT("_DGPTIFN_",535," D ^DIK K DA
"RTN","DGPTTS3",54,0)
 S:'$D(^DGPT(DGPTIFN,535,0)) ^(0)="^45.0535^"
"RTN","DGPTTS3",55,0)
 K DIK,DGWI,DA Q
"RTN","DGPTTS3",56,0)
 ;
"RTN","DGPTTS3",57,0)
T ; -- test tag
"RTN","DGPTTS3",58,0)
 S DIC(0)="AEMQZ",DIC=45,DIC("S")="I $P(^(0),U,11)=1" D ^DIC K DIC Q:Y<0
"RTN","DGPTTS3",59,0)
PTF S PTF=+Y,DGDT=$S($D(^DGPT(L,70)):+^(70),1:0),DFN=+Y(0) D PM^DGPTUTL,EN:DGPMCA
"RTN","DGPTTS3",60,0)
 Q
"RTN","DGPTTS3",61,0)
 ;
"RTN","DGPTTS3",62,0)
DAYS ; -- calc leave and pass days from DGBEG to DGEND
"RTN","DGPTTS3",63,0)
 ; -- if last 501 date is after last 535 date then
"RTN","DGPTTS3",64,0)
 ;    calc from last 535 mvt d/t to last 501 mvt d/t
"RTN","DGPTTS3",65,0)
 ;
"RTN","DGPTTS3",66,0)
 ;      535          501    501        535
"RTN","DGPTTS3",67,0)
 ;       |------------|------|----------|
"RTN","DGPTTS3",68,0)
 ;        <<<<<<<<<<< total >>>>>>>>>>
"RTN","DGPTTS3",69,0)
 ;        <<<<<<< diff >>>>>>+<< pass >>
"RTN","DGPTTS3",70,0)
 ;
"RTN","DGPTTS3",71,0)
 S (PASS,LEAVE,DGDIFP,DGDIFL)=0 D MVT
"RTN","DGPTTS3",72,0)
 I DGMDT>DGBEG S DGE=DGEND,DGEND=DGMDT D DAYS0 S DGDIFL=LEAVE,DGDIFP=PASS,DGEND=DGE
"RTN","DGPTTS3",73,0)
 ; -- calc from last 535 mvt d/t to new 535 mvt d/t
"RTN","DGPTTS3",74,0)
 S (PASS,LEAVE)=0 D DAYS0
"RTN","DGPTTS3",75,0)
 ; -- substract 'diff' from 'total'
"RTN","DGPTTS3",76,0)
 S PASS=PASS-DGDIFP,LEAVE=LEAVE-DGDIFL
"RTN","DGPTTS3",77,0)
 K DGDIFL,DGDIFP,DGE Q
"RTN","DGPTTS3",78,0)
 ;
"RTN","DGPTTS3",79,0)
DAYS0 ;
"RTN","DGPTTS3",80,0)
 N DGMVT
"RTN","DGPTTS3",81,0)
 F DGMVTDT=(DGBEG-.0000001):0 S DGMVTDT=$O(@DGRT@(DGMVTDT)) Q:'DGMVTDT  F DGMVT=0:0 S DGMVT=$O(@DGRT@(DGMVTDT,DGMVT)) Q:'DGMVT  I $D(^DGPM(DGMVT,0)),$P(^(0),U,2)=2 S C=$P(^(0),U,18) I C=1!(C=2)!(C=3) D NEXT,DAYS1
"RTN","DGPTTS3",82,0)
 K DGMVTDT Q
"RTN","DGPTTS3",83,0)
 ;
"RTN","DGPTTS3",84,0)
DAYS1 S I=DGMVTDT,X2=$S(I<DGBEG:DGBEG,1:I),X1=$S(Y>DGBEG&(Y'>DGEND):Y,Y>DGEND!('Y):DGEND,1:X2)
"RTN","DGPTTS3",85,0)
 I X1>X2 D ^%DTC S:C=1 PASS=PASS+X S:C=2 LEAVE=LEAVE+X
"RTN","DGPTTS3",86,0)
 K C,X,Y,X1,X2,I
"RTN","DGPTTS3",87,0)
 Q
"RTN","DGPTTS3",88,0)
 ;
"RTN","DGPTTS3",89,0)
NEXT ; -- find next x-ref date
"RTN","DGPTTS3",90,0)
 N DGMVT
"RTN","DGPTTS3",91,0)
 F Y=DGMVTDT:0 S Y=$O(@DGRT@(Y)) Q:'Y  F DGMVT=0:0 S DGMVT=$O(@DGRT@(Y,DGMVT)) Q:'DGMVT  I $D(^DGPM(DGMVT,0)),$P(^(0),U,2)=2 G NEXTQ
"RTN","DGPTTS3",92,0)
NEXTQ Q
"RTN","DGPTTS3",93,0)
 ;
"RTN","DGPTTS3",94,0)
MVT ; -- find last 501 mvt d/t since the last 535 mvt d/t
"RTN","DGPTTS3",95,0)
 ;    and before the new 535 mvt d/t
"RTN","DGPTTS3",96,0)
 S DGMDT=""
"RTN","DGPTTS3",97,0)
 F M=DGLAST:0 S M=$O(^DGPT(DGPTIFN,"M","AM",M)) Q:'M!(M>DGEND)  S DGMDT=M
"RTN","DGPTTS3",98,0)
 K M Q
"RTN","DGPTTS3",99,0)
 ;
"RTN","DGPTTS3",100,0)
FLCHK ; -- check if more than 25 535s, then re-set x-mit flags
"RTN","DGPTTS3",101,0)
 I '$D(DGSACNT) G FLQ
"RTN","DGPTTS3",102,0)
 I DGSACNT<25 G FLQ
"RTN","DGPTTS3",103,0)
 S DGF1=0
"RTN","DGPTTS3",104,0)
 F DGWI=0:0 S DGWI=$O(DGSAFTF(DGWI)) Q:'DGWI!('$D(^DGPT(DGPTIFN,535,+DGWI,0)))  F DGI=1,2,10,16 S:$P(^(0),U,DGI)'=$P(DGSAFTF(DGWI),U,DGI) DGF1=1
"RTN","DGPTTS3",105,0)
 I 'DGF1,'DGWI F DGWI=0:0 S DGWI=$O(DGSAFTF(DGWI)) Q:'DGWI  S DA=DGWI,DA(1)=DGPTIFN,DIE="^DGPT("_DGPTIFN_",535,",DR="17///n" D ^DIE
"RTN","DGPTTS3",106,0)
FLQ K DGI,DGF1,DGWI,DGSAFTF,DGSACNT,DR,DA,DIE
"RTN","DGPTTS3",107,0)
 Q
"RTN","DGPTTS3",108,0)
 ;
"UP",45,45.01,-1)
45^S
"UP",45,45.01,0)
45.01
"UP",45,45.05,-1)
45^P
"UP",45,45.05,0)
45.05
"VER")
8.0^22.0
"^DD",42,42,.017,0)
SPECIALTY^R*P42.4'X^DIC(42.4,^0;12^S DIC("S")="I $G(Y)=80!$$ACTIVE^DGACT(42.4,Y)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",42,42,.017,3)
Enter this ward's PTF bedsection.  This must be an active treating specialty.
"^DD",42,42,.017,12)
Allows only active treating specialties.
"^DD",42,42,.017,12.1)
S DIC("S")="I $G(Y)=80!$$ACTIVE^DGACT(42.4,Y)"
"^DD",42,42,.017,21,0)
^^4^4^3070117^
"^DD",42,42,.017,21,1,0)
Enter the PTF specialty that this ward is assign to.  The specialty
"^DD",42,42,.017,21,2,0)
and its MPCR number will be transmitted to Austin as part of the N501
"^DD",42,42,.017,21,3,0)
and N535 transactions.  This information is sent in the physcial
"^DD",42,42,.017,21,4,0)
specialty and physcial MPCR elements of those transactions.
"^DD",42,42,.017,"DT")
3060307
"^DD",42.4,42.4,.001,0)
NUMBER^NJ10,0^^ ^K:+X'=X!(X>9999999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",42.4,42.4,.001,3)
Type a Number between 1 and 9999999999
"^DD",42.4,42.4,.001,21,0)
^.001^1^1^3070328^^
"^DD",42.4,42.4,.001,21,1,0)
This field contains the IFN of the SPECIALTY record.
"^DD",42.4,42.4,.001,"DT")
3070328
"^DD",42.4,42.4,6,0)
MPCR ACCOUNT^NJ7,2^^0;6^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."3N.N) X
"^DD",42.4,42.4,6,3)
Type a Number between 0 and 9999, 2 Decimal Digits
"^DD",42.4,42.4,6,21,0)
^^4^4^3070327^
"^DD",42.4,42.4,6,21,1,0)
This field contains the Monthly Program Cost Account number that is
"^DD",42.4,42.4,6,21,2,0)
associated with the treating specialty assigned to any given ward. The 
"^DD",42.4,42.4,6,21,3,0)
MPCR account number is used for workload purposes.
"^DD",42.4,42.4,6,21,4,0)
|
"^DD",42.4,42.4,6,"DT")
3070327
"^DD",42.4,42.4,7,0)
PTF CODE^RF^^0;7^K:$L(X)>2!($L(X)<1) X
"^DD",42.4,42.4,7,1,0)
^.1
"^DD",42.4,42.4,7,1,1,0)
42.4^C
"^DD",42.4,42.4,7,1,1,1)
S ^DIC(42.4,"C",$E(X,1,30),DA)=""
"^DD",42.4,42.4,7,1,1,2)
K ^DIC(42.4,"C",$E(X,1,30),DA)
"^DD",42.4,42.4,7,1,1,"DT")
3070320
"^DD",42.4,42.4,7,3)
Answer must be 1-2 characters in length.
"^DD",42.4,42.4,7,21,0)
^.001^4^4^3070328^^^^
"^DD",42.4,42.4,7,21,1,0)
This field contains the PTF code for this entry.  It is created by the MAS
"^DD",42.4,42.4,7,21,2,0)
module and VA Fileman.  Editing of data in this file or additions/deletions
"^DD",42.4,42.4,7,21,3,0)
to this file will have negative impact on the operations of the PTF software
"^DD",42.4,42.4,7,21,4,0)
module.
"^DD",42.4,42.4,7,"DT")
3070328
"^DD",45,45,300.01,0)
KIDNEY SOURCE^SX^1:Live Donor;2:Cadaver;^300;1^S DGFLAG=1 D 401^DGPTSC01 K:DGER X K DGFLAG,DGER
"^DD",45,45,300.01,3)

"^DD",45,45,300.01,21,0)
^.001^1^1^3061024^^^^
"^DD",45,45,300.01,21,1,0)
This field will indicate where the transplanted organ was received from.
"^DD",45,45,300.01,23,0)
^.001^12^12^3061024^^
"^DD",45,45,300.01,23,1,0)
The process for loading this field consist of the 
"^DD",45,45,300.01,23,2,0)
following steps:
"^DD",45,45,300.01,23,3,0)
1) Load the DGPTIT array with the ICD codes from 
"^DD",45,45,300.01,23,4,0)
the PTF <401>, <501> or the <701> screen.
"^DD",45,45,300.01,23,5,0)
2) Scan the DGPTIT array for codes that require 
"^DD",45,45,300.01,23,6,0)
additional information. The PTF EXPANDED CODE FILE 
"^DD",45,45,300.01,23,7,0)
contains all ICD's that require special processing.
"^DD",45,45,300.01,23,8,0)
If a match is made an entry is made in the DGBPC array.
"^DD",45,45,300.01,23,9,0)
3) If the DGBPC array exist then additional questions
"^DD",45,45,300.01,23,10,0)
are required to complete the data entry for a particular
"^DD",45,45,300.01,23,11,0)
ICD. This flag is then used to prompt the user for any
"^DD",45,45,300.01,23,12,0)
additional information.
"^DD",45,45,300.01,"DT")
2910515
"^DD",45,45.01,3,0)
SURGICAL SPECIALTY^R*P45.3'^DIC(45.3,^0;3^S DIC("S")="I ($P(^(0),U)>49)&($P(^(0),U)<63)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",45,45.01,3,3)
Enter the surgical specialty from the available list.
"^DD",45,45.01,3,12)
Display two character length codes only
"^DD",45,45.01,3,12.1)
S DIC("S")="I ($P(^(0),U)>49)&($P(^(0),U)<63)"
"^DD",45,45.01,3,21,0)
^.001^1^1^3070725^^^^
"^DD",45,45.01,3,21,1,0)
This field contains the surgical specialty for this espisode of care.
"^DD",45,45.01,3,"DT")
3070620
"^DD",45,45.01,300.01,0)
KIDNEY SOURCE^SX^1:Live Donor;2:Cadaver;^300;1^S DGFLAG=1 D 401^DGPTSC01 K:DGER X K DGER,DGFLAG
"^DD",45,45.01,300.01,3)

"^DD",45,45.01,300.01,21,0)
^.001^1^1^3061024^^^^
"^DD",45,45.01,300.01,21,1,0)
This field will indicate where the transplant organ was received from.
"^DD",45,45.01,300.01,23,0)
^.001^12^12^3061024^^
"^DD",45,45.01,300.01,23,1,0)
The process for loading this field consist of the 
"^DD",45,45.01,300.01,23,2,0)
following steps:
"^DD",45,45.01,300.01,23,3,0)
1) Load the DGPTIT array with the ICD codes from 
"^DD",45,45.01,300.01,23,4,0)
the PTF <401>, <501> or the <701> screen.
"^DD",45,45.01,300.01,23,5,0)
2) Scan the DGPTIT array for codes that require 
"^DD",45,45.01,300.01,23,6,0)
additional information. The PTF EXPANDED CODE FILE (45.89)
"^DD",45,45.01,300.01,23,7,0)
contains all ICD's that require special processing.
"^DD",45,45.01,300.01,23,8,0)
If a match is made an entry is made in the DGBPC array.
"^DD",45,45.01,300.01,23,9,0)
3) If the DGBPC array exist then additional questions
"^DD",45,45.01,300.01,23,10,0)
are required to complete the data entry for a particular
"^DD",45,45.01,300.01,23,11,0)
ICD. This flag is then used to prompt the user for any
"^DD",45,45.01,300.01,23,12,0)
additional information.
"^DD",45,45.01,300.01,"DT")
2910515
"^DD",45,45.05,3,0)
NUMBER OF DIALYSIS TREATMENTS^NJ3,0^^0;4^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",45,45.05,3,3)
Type a Number between 1 and 999, 0 Decimal Digits
"^DD",45,45.05,3,21,0)
^.001^2^2^3070222^^^^
"^DD",45,45.05,3,21,1,0)
Total number of dialysis treatments received during this episode of
"^DD",45,45.05,3,21,2,0)
care.
"^DD",45,45.05,3,"DT")
3070215
"^DD",45.7,45.7,1,0)
SPECIALTY^R*P42.4'^DIC(42.4,^0;2^S DIC("S")="I $$ACTIVE^DGACT(42.4,+Y)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",45.7,45.7,1,1,0)
^.1
"^DD",45.7,45.7,1,1,1,0)
45.7^ASPEC
"^DD",45.7,45.7,1,1,1,1)
S ^DIC(45.7,"ASPEC",$E(X,1,30),DA)=""
"^DD",45.7,45.7,1,1,1,2)
K ^DIC(45.7,"ASPEC",$E(X,1,30),DA)
"^DD",45.7,45.7,1,1,1,"%D",0)
^^1^1^2950810^
"^DD",45.7,45.7,1,1,1,"%D",1,0)
This cross reference will sort facility treating specialty by specialty.
"^DD",45.7,45.7,1,1,1,"DT")
2950810
"^DD",45.7,45.7,1,3)
Enter the PTF bedsection associated with this specialty.
"^DD",45.7,45.7,1,12)
Allows only active treating specialties.
"^DD",45.7,45.7,1,12.1)
S DIC("S")="I $$ACTIVE^DGACT(42.4,+Y)"
"^DD",45.7,45.7,1,21,0)
^.001^2^2^3070402^^^^
"^DD",45.7,45.7,1,21,1,0)
This field contains the treating specialty name as entered by
"^DD",45.7,45.7,1,21,2,0)
facility or distributed with software.  Pointer to  Specialty File
"^DD",45.7,45.7,1,"DT")
3070402
"BLD",6921,6)
^673
**END**
**END**
