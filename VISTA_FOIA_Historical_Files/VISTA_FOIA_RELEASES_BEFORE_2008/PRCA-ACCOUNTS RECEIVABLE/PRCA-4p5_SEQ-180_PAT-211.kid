Released PRCA*4.5*211 SEQ #180
Extracted from mail message
**KIDS**:PRCA*4.5*211^

**INSTALL NAME**
PRCA*4.5*211
"BLD",5226,0)
PRCA*4.5*211^ACCOUNTS RECEIVABLE^0^3031210^y
"BLD",5226,1,0)
^^10^10^3031209^
"BLD",5226,1,1,0)
 
"BLD",5226,1,2,0)
A site reported that there have been three issues found since the install
"BLD",5226,1,3,0)
of PRCA*4.5*203. The first issue is that the Revenue Sources Code for
"BLD",5226,1,4,0)
Pharmacy bills don't print and it appears to happen when the category is
"BLD",5226,1,5,0)
RX CO-PAYMENT/NSC VET.  The second issue indicates that Pharmacy First 
"BLD",5226,1,6,0)
Party bills are being deposited into a fund of 5287.3 while the patch
"BLD",5226,1,7,0)
description in PRCA*4.5*203 states that the New Point Accounts for 
"BLD",5226,1,8,0)
pharmacy bill should be 5287.1.  The third issue is that the old closed
"BLD",5226,1,9,0)
receipts (FY03) prior to the installation of PRCA*4.5*203 are reporting
"BLD",5226,1,10,0)
funds for the New Point Accounts and they print in the 215 report.
"BLD",5226,4,0)
^9.64PA^^
"BLD",5226,"ABPKG")

"BLD",5226,"INI")

"BLD",5226,"KRN",0)
^9.67PA^8989.52^19
"BLD",5226,"KRN",.4,0)
.4
"BLD",5226,"KRN",.4,"NM",0)
^9.68A^^
"BLD",5226,"KRN",.401,0)
.401
"BLD",5226,"KRN",.402,0)
.402
"BLD",5226,"KRN",.403,0)
.403
"BLD",5226,"KRN",.5,0)
.5
"BLD",5226,"KRN",.84,0)
.84
"BLD",5226,"KRN",3.6,0)
3.6
"BLD",5226,"KRN",3.8,0)
3.8
"BLD",5226,"KRN",9.2,0)
9.2
"BLD",5226,"KRN",9.8,0)
9.8
"BLD",5226,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5226,"KRN",9.8,"NM",1,0)
RCDPR215^^0^B36591140
"BLD",5226,"KRN",9.8,"NM",2,0)
PRCASER^^0^B9222573
"BLD",5226,"KRN",9.8,"NM",3,0)
RCXFMSUF^^0^B17434881
"BLD",5226,"KRN",9.8,"NM","B","PRCASER",2)

"BLD",5226,"KRN",9.8,"NM","B","RCDPR215",1)

"BLD",5226,"KRN",9.8,"NM","B","RCXFMSUF",3)

"BLD",5226,"KRN",19,0)
19
"BLD",5226,"KRN",19,"NM",0)
^9.68A^^
"BLD",5226,"KRN",19.1,0)
19.1
"BLD",5226,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5226,"KRN",101,0)
101
"BLD",5226,"KRN",101,"NM",0)
^9.68A^^
"BLD",5226,"KRN",409.61,0)
409.61
"BLD",5226,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",5226,"KRN",771,0)
771
"BLD",5226,"KRN",771,"NM",0)
^9.68A^^
"BLD",5226,"KRN",870,0)
870
"BLD",5226,"KRN",870,"NM",0)
^9.68A^^
"BLD",5226,"KRN",8989.51,0)
8989.51
"BLD",5226,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",5226,"KRN",8989.52,0)
8989.52
"BLD",5226,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",5226,"KRN",8994,0)
8994
"BLD",5226,"KRN",8994,"NM",0)
^9.68A^^
"BLD",5226,"KRN","B",.4,.4)

"BLD",5226,"KRN","B",.401,.401)

"BLD",5226,"KRN","B",.402,.402)

"BLD",5226,"KRN","B",.403,.403)

"BLD",5226,"KRN","B",.5,.5)

"BLD",5226,"KRN","B",.84,.84)

"BLD",5226,"KRN","B",3.6,3.6)

"BLD",5226,"KRN","B",3.8,3.8)

"BLD",5226,"KRN","B",9.2,9.2)

"BLD",5226,"KRN","B",9.8,9.8)

"BLD",5226,"KRN","B",19,19)

"BLD",5226,"KRN","B",19.1,19.1)

"BLD",5226,"KRN","B",101,101)

"BLD",5226,"KRN","B",409.61,409.61)

"BLD",5226,"KRN","B",771,771)

"BLD",5226,"KRN","B",870,870)

"BLD",5226,"KRN","B",8989.51,8989.51)

"BLD",5226,"KRN","B",8989.52,8989.52)

"BLD",5226,"KRN","B",8994,8994)

"BLD",5226,"PRE")
PRCAP211
"BLD",5226,"QUES",0)
^9.62^^
"BLD",5226,"REQB",0)
^9.611^2^2
"BLD",5226,"REQB",1,0)
PRCA*4.5*173^2
"BLD",5226,"REQB",2,0)
PRCA*4.5*203^2
"BLD",5226,"REQB","B","PRCA*4.5*173",1)

"BLD",5226,"REQB","B","PRCA*4.5*203",2)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^^0
"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
211^3031210
"PKG",142,22,1,"PAH",1,1,0)
^^10^10^3031210
"PKG",142,22,1,"PAH",1,1,1,0)
 
"PKG",142,22,1,"PAH",1,1,2,0)
A site reported that there have been three issues found since the install
"PKG",142,22,1,"PAH",1,1,3,0)
of PRCA*4.5*203. The first issue is that the Revenue Sources Code for
"PKG",142,22,1,"PAH",1,1,4,0)
Pharmacy bills don't print and it appears to happen when the category is
"PKG",142,22,1,"PAH",1,1,5,0)
RX CO-PAYMENT/NSC VET.  The second issue indicates that Pharmacy First 
"PKG",142,22,1,"PAH",1,1,6,0)
Party bills are being deposited into a fund of 5287.3 while the patch
"PKG",142,22,1,"PAH",1,1,7,0)
description in PRCA*4.5*203 states that the New Point Accounts for 
"PKG",142,22,1,"PAH",1,1,8,0)
pharmacy bill should be 5287.1.  The third issue is that the old closed
"PKG",142,22,1,"PAH",1,1,9,0)
receipts (FY03) prior to the installation of PRCA*4.5*203 are reporting
"PKG",142,22,1,"PAH",1,1,10,0)
funds for the New Point Accounts and they print in the 215 report.
"PRE")
PRCAP211
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PRCAP211")
0^^B4000932
"RTN","PRCAP211",1,0)
PRCAP211 ;ALB/CXW - PATCH PRCA*4.5*211 ENVIRONMENT CHECK
"RTN","PRCAP211",2,0)
 ;;4.5;Accounts Receivable;**211**;Mar 20, 1995
"RTN","PRCAP211",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCAP211",4,0)
ENV ;
"RTN","PRCAP211",5,0)
 ;this is the environment check routine
"RTN","PRCAP211",6,0)
 I $$PATCH^XPDUTL("PRCA*4.5*175") D
"RTN","PRCAP211",7,0)
 . W "You are a test site for a CoreFLS version (patch PRCA*4.5*175) of Accounts",!
"RTN","PRCAP211",8,0)
 . W "Receivable. This patch has a conflict with the AR-CoreFLS test software.",!
"RTN","PRCAP211",9,0)
 . W "It must NOT be installed unless an accompanying update is made to the",!
"RTN","PRCAP211",10,0)
 . W "AR-CoreFLS software immediately after installation of this patch.",!!
"RTN","PRCAP211",11,0)
 . N DIR,DTOUT,DUOUT,Y
"RTN","PRCAP211",12,0)
 . S DIR(0)="YA"
"RTN","PRCAP211",13,0)
 . S DIR("A")="Do you have the corresponding update to the AR-CoreFLS software that is associated with this patch? (Note: Entering ""No"" here will stop the installation of this patch) Y/N//"
"RTN","PRCAP211",14,0)
 . D ^DIR
"RTN","PRCAP211",15,0)
 . I $D(DTOUT)!$D(DUOUT)!(Y'=1) W !,"Installation of this patch has been stopped!" S XPDQUIT=1 Q
"RTN","PRCAP211",16,0)
 . W !,"OK to install!"
"RTN","PRCAP211",17,0)
 Q
"RTN","PRCASER")
0^2^B9222573
"RTN","PRCASER",1,0)
PRCASER ;WASH-ISC@ALTOONA,PA/RGY-Accept bill from billing engine ;2/23/95  2:40 PM
"RTN","PRCASER",2,0)
V ;;4.5;Accounts Receivable;**90,153,203,211**;Mar 20, 1995
"RTN","PRCASER",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCASER",4,0)
 NEW PRCAX,PRCASV,PRCAEN,PRCASEG
"RTN","PRCASER",5,0)
 S PRCAX=X,Y=0 F X="SITE","SER","CAT","DEBTOR","FY","AMT","APR","BDT" S Y=Y+1,PRCASV(X)=$P(PRCAX,"^",Y)
"RTN","PRCASER",6,0)
 L +^RCD(340,PRCASV("DEBTOR"),"PRCASER"):30 I '$T S Y="-1^PRCA004^AR Package 'busy' while trying to add transaction." G Q1
"RTN","PRCASER",7,0)
 I ",3,4,5,24,25,"[(","_PRCASV("CAT")_",") S PRCASV("CARE")=PRCASV("CAT"),PRCASV("CAT")=18
"RTN","PRCASER",8,0)
 S PRCASV("FY")=PRCASV("FY")_"^"_PRCASV("AMT")
"RTN","PRCASER",9,0)
 I '$D(PRCASV("PAT")) S PRCASV("PAT")=PRCASV("DEBTOR")
"RTN","PRCASER",10,0)
 S X=$O(^RCD(340,"B",PRCASV("DEBTOR"),0)) D:PRCASV("CAT")]""&X CHKAO I $D(PRCASV("ARREC")) D:PRCASV("AMT") TRAN S Y=PRCASV("ARREC")_"^"_PRCASV("ARBIL")_"^"_$S($D(PRCAEN):PRCAEN,1:"") G Q
"RTN","PRCASER",11,0)
 D ^PRCASVC3 I PRCASV("ARREC")<0,$P(PRCASV("ARREC"),"^",2)]"" S Y=PRCASV("ARREC") G Q
"RTN","PRCASER",12,0)
 I PRCASV("ARBIL")<0 S Y=PRCASV("ARBIL") G Q
"RTN","PRCASER",13,0)
 S $P(PRCASV("FY"),"^",2)=0 D REL^PRCASVC S $P(PRCASV("FY"),"^",2)=PRCASV("AMT") I $D(PRCAERR) S Y=PRCAERR G Q
"RTN","PRCASER",14,0)
 S PRCASEG=$S($D(PRCASV("CARE")):PRCASV("CARE"),$D(PRCASV("CAT")):PRCASV("CAT"),1:0) S:PRCASEG>1 PRCASEG=$P(^PRCA(430.2,PRCASEG,0),"^",3)
"RTN","PRCASER",15,0)
 S DR="8////^S X="_$O(^PRCA(430.3,"AC",112,0))_";20.1////^S X="_PRCASEG
"RTN","PRCASER",16,0)
 S DR=DR_";203////^S X="_$$GETFUNDB^RCXFMSUF(PRCASV("ARREC"),1)
"RTN","PRCASER",17,0)
 I $D(PRCASV("CARE")) S DR=DR_";15.1////^S X="_PRCASV("CARE")
"RTN","PRCASER",18,0)
 S DA=PRCASV("ARREC"),DIE="^PRCA(430," D ^DIE D:PRCASV("AMT")>0 TRAN
"RTN","PRCASER",19,0)
 S Y=PRCASV("ARREC")_"^"_PRCASV("ARBIL")_"^"_$S($D(PRCAEN):PRCAEN,1:"")
"RTN","PRCASER",20,0)
Q L -^RCD(340,PRCASV("DEBTOR"),"PRCASER")
"RTN","PRCASER",21,0)
Q1 S X=PRCAX K PRCAERR Q
"RTN","PRCASER",22,0)
CHKAO ;
"RTN","PRCASER",23,0)
 F Y=0:0 S Y=$O(^PRCA(430,"AS",X,$O(^PRCA(430.3,"AC",112,0)),Y)) Q:'Y  D
"RTN","PRCASER",24,0)
 .I $P(^PRCA(430,Y,0),"^",2)=PRCASV("CAT"),$S(PRCASV("CAT")'=$O(^PRCA(430.2,"AC",24,0)):1,$P(^PRCA(430,Y,0),"^",16)=PRCASV("CARE"):1,1:0) S PRCASV("ARREC")=Y,PRCASV("ARBIL")=$P(^PRCA(430,Y,0),"^")
"RTN","PRCASER",25,0)
 .QUIT
"RTN","PRCASER",26,0)
 Q
"RTN","PRCASER",27,0)
TRAN ;
"RTN","PRCASER",28,0)
 NEW PRCABN,PRCAMT,PRCAA2
"RTN","PRCASER",29,0)
 D SETTR^PRCAUTL S PRCABN=PRCASV("ARREC") D PATTR^PRCAUTL
"RTN","PRCASER",30,0)
 S PRCA("ADJ")=$O(^PRCA(430.3,"AC",1,0)),DIE="^PRCA(433,",DR="[PRCA FY ADJ2 BATCH]",DA=PRCAEN D ^DIE S PRCAA2=$P(^PRCA(433,PRCAEN,4,0),"^",3) D UPFY^PRCADJ,TRANUP^PRCAUTL,UPPRIN^PRCADJ
"RTN","PRCASER",31,0)
 D PREPAY^RCBEPAYP(PRCABN,0)
"RTN","PRCASER",32,0)
 Q
"RTN","RCDPR215")
0^1^B36591140
"RTN","RCDPR215",1,0)
RCDPR215 ;WISC/RFJ-receipt processing sf215 report ;1 Jun 99
"RTN","RCDPR215",2,0)
 ;;4.5;Accounts Receivable;**114,173,211**;Mar 20, 1995
"RTN","RCDPR215",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCDPR215",4,0)
 Q
"RTN","RCDPR215",5,0)
 ;
"RTN","RCDPR215",6,0)
 ;
"RTN","RCDPR215",7,0)
DQ ;  queued report starts here, input RECEIPDA
"RTN","RCDPR215",8,0)
 ;  RCTYPE="D"etail or "A"ccrual
"RTN","RCDPR215",9,0)
 N %I,AMOUNT,BILL,BILLDA,COMMENTS,COUNT,DA,DATA,DEPOSIT,DETAIL,FMSDOCNO,FUND,NOW,PAGE,PIECE,PRINTOTL,RCSTFLAG,RCYLINE,RECEIPT,SCREEN,TOTAL,TOTLAMT,UNAPPLY,X,Y,TOT,%,REPRODT
"RTN","RCDPR215",10,0)
 ;
"RTN","RCDPR215",11,0)
 ;  calculate report
"RTN","RCDPR215",12,0)
 ;  input receipda (ien of receipt)
"RTN","RCDPR215",13,0)
 K ^TMP($J,"RCFMSCR"),^TMP($J,"RCDPR215")
"RTN","RCDPR215",14,0)
 S REPRODT=$P($P($G(^RCY(344,RECEIPDA,0)),"^",8),".")
"RTN","RCDPR215",15,0)
 D FMSLINES^RCXFMSC1(RECEIPDA)
"RTN","RCDPR215",16,0)
 I $$EDILB^RCDPEU(RECEIPDA)=1 D  ; EFT deposit receipt
"RTN","RCDPR215",17,0)
 . S TOT=0
"RTN","RCDPR215",18,0)
 . S Z=0 F  S Z=$O(^RCY(344,RECEIPDA,1,Z)) Q:'Z  S TOT=TOT+$P($G(^(Z,0)),U,4)
"RTN","RCDPR215",19,0)
 . S ^TMP($J,"RCFMSCR","5287.4/8NZZ")=TOT
"RTN","RCDPR215",20,0)
 ;
"RTN","RCDPR215",21,0)
 ;  print report
"RTN","RCDPR215",22,0)
 S DATA=$G(^RCY(344,RECEIPDA,0))
"RTN","RCDPR215",23,0)
 S RECEIPT=$P(DATA,"^")
"RTN","RCDPR215",24,0)
 S DEPOSIT=$P($G(^RCY(344.1,+$P(DATA,"^",6),0)),"^")
"RTN","RCDPR215",25,0)
 S FMSDOCNO=$P($G(^RCY(344.1,+$P(DATA,"^",6),2)),"^")
"RTN","RCDPR215",26,0)
 ;
"RTN","RCDPR215",27,0)
 D NOW^%DTC S Y=% D DD^%DT S NOW=Y
"RTN","RCDPR215",28,0)
 S PAGE=0,RCYLINE="",$P(RCYLINE,"-",81)=""
"RTN","RCDPR215",29,0)
 S SCREEN=0 I '$D(ZTQUEUED),IO=IO(0),$E(IOST)="C" S SCREEN=1
"RTN","RCDPR215",30,0)
 U IO D H
"RTN","RCDPR215",31,0)
 ;
"RTN","RCDPR215",32,0)
 S TOTAL=""  ;  stores printotal^inttotal^admintotal^marshtotal^cctotal
"RTN","RCDPR215",33,0)
 S FUND="" F  S FUND=$O(^TMP($J,"RCFMSCR",FUND)) Q:'FUND!($G(RCSTFLAG))  D
"RTN","RCDPR215",34,0)
 .   I $Y>(IOSL-6) D:SCREEN PAUSE Q:$G(RCSTFLAG)  D H
"RTN","RCDPR215",35,0)
 .   W !!?5,"Appropriation: ",FUND
"RTN","RCDPR215",36,0)
 .   I RCTYPE="D" W !
"RTN","RCDPR215",37,0)
 .   ;
"RTN","RCDPR215",38,0)
 .   S PRINTOTL=0
"RTN","RCDPR215",39,0)
 .   S COUNT=0
"RTN","RCDPR215",40,0)
 .   I FUND="5287.4/8NZZ" S PRINTOTL=PRINTOTL+$G(^TMP($J,"RCFMSCR",FUND))
"RTN","RCDPR215",41,0)
 .   S BILLDA=0 F  S BILLDA=$O(^TMP($J,"RCFMSCR",FUND,BILLDA)) Q:'BILLDA!($G(RCSTFLAG))  D
"RTN","RCDPR215",42,0)
 .   .   I $Y>(IOSL-5) D:SCREEN PAUSE Q:$G(RCSTFLAG)  D H
"RTN","RCDPR215",43,0)
 .   .   S COUNT=COUNT+1
"RTN","RCDPR215",44,0)
 .   .   S BILL=$P($G(^PRCA(430,BILLDA,0)),"^")
"RTN","RCDPR215",45,0)
 .   .   S DATA=^TMP($J,"RCFMSCR",FUND,BILLDA)
"RTN","RCDPR215",46,0)
 .   .   S PRINTOTL=PRINTOTL+$P(DATA,"^")
"RTN","RCDPR215",47,0)
 .   .   F PIECE=1:1:5 S $P(TOTAL,"^",PIECE)=$P(TOTAL,"^",PIECE)+$P(DATA,"^",PIECE)
"RTN","RCDPR215",48,0)
 .   .   ;  if accrued report, do not show detail
"RTN","RCDPR215",49,0)
 .   .   I RCTYPE="A" Q
"RTN","RCDPR215",50,0)
 .   .   ;
"RTN","RCDPR215",51,0)
 .   .   W !?5,COUNT,")",?10,BILL,?30,$J($P(DATA,"^"),10,2),?45,"DEBTOR: ",$E($$DEBTOR(BILLDA),1,25)
"RTN","RCDPR215",52,0)
 .   .   W !?15,"INT:",$J($P(DATA,"^",2),10,2)," ADMIN:",$J($P(DATA,"^",3),10,2)," MARS: ",$J($P(DATA,"^",4),10,2)," CC: ",$J($P(DATA,"^",5),10,2)
"RTN","RCDPR215",53,0)
 .   ;
"RTN","RCDPR215",54,0)
 .   I $G(RCSTFLAG) Q
"RTN","RCDPR215",55,0)
 .   I RCTYPE="D" W !?30,"----------",!?5,"TOTAL for ",FUND
"RTN","RCDPR215",56,0)
 .   W ?30,$J(PRINTOTL,10,2)
"RTN","RCDPR215",57,0)
 .   I FUND="0160a1" W ?45,"0160a1 sub-totals Champva receipts",!?45,"not sent to FMS on the CR document."
"RTN","RCDPR215",58,0)
 ;
"RTN","RCDPR215",59,0)
 I $G(RCSTFLAG) D Q Q
"RTN","RCDPR215",60,0)
 I $Y>(IOSL-6) D:SCREEN PAUSE I '$G(RCSTFLAG) D H
"RTN","RCDPR215",61,0)
 I $G(RCSTFLAG) D Q Q
"RTN","RCDPR215",62,0)
 ;
"RTN","RCDPR215",63,0)
 ;  show int, admin, etc totals
"RTN","RCDPR215",64,0)
 W !
"RTN","RCDPR215",65,0)
 W !?5,"INTEREST : (APP: 1435)",?30,$J($P(TOTAL,"^",2),10,2)
"RTN","RCDPR215",66,0)
 W !?5,"ADMIN    : (APP: 3220)",?30,$J($P(TOTAL,"^",3),10,2)
"RTN","RCDPR215",67,0)
 W !?5,"MARSHALL : (APP: 0869)",?30,$J($P(TOTAL,"^",4),10,2)
"RTN","RCDPR215",68,0)
 W !?5,"COURTCOST: (APP: 0869)",?30,$J($P(TOTAL,"^",5),10,2)
"RTN","RCDPR215",69,0)
 W !?30,"----------"
"RTN","RCDPR215",70,0)
 W !?30,$J($P(TOTAL,"^",2)+$P(TOTAL,"^",3)+$P(TOTAL,"^",4)+$P(TOTAL,"^",5),10,2)
"RTN","RCDPR215",71,0)
 ;
"RTN","RCDPR215",72,0)
 I $Y>(IOSL-8) D:SCREEN PAUSE I '$G(RCSTFLAG) D H
"RTN","RCDPR215",73,0)
 I $G(RCSTFLAG) D Q Q
"RTN","RCDPR215",74,0)
 ;
"RTN","RCDPR215",75,0)
 I $G(^TMP($J,"RCFMSCR","5287.4/8NZZ")) S $P(TOTAL,U)=$P(TOTAL,U)+^TMP($J,"RCFMSCR","5287.4/8NZZ")
"RTN","RCDPR215",76,0)
 ;  compile unapplied amounts that went to suspense
"RTN","RCDPR215",77,0)
 S DA=0 F  S DA=$O(^RCY(344,RECEIPDA,1,DA)) Q:'DA  D
"RTN","RCDPR215",78,0)
 .   S AMOUNT=$P($G(^RCY(344,RECEIPDA,1,DA,0)),"^",4) I 'AMOUNT Q
"RTN","RCDPR215",79,0)
 .   S UNAPPLY=$P($G(^RCY(344,RECEIPDA,1,DA,2)),"^",5) I UNAPPLY="" Q
"RTN","RCDPR215",80,0)
 .   ;  if amount has not been processed, show it in suspense
"RTN","RCDPR215",81,0)
 .   I '$P(^RCY(344,RECEIPDA,1,DA,0),"^",5) S ^TMP($J,"RCDPR215",DA)=UNAPPLY_"^"_AMOUNT_"^"_$P($G(^RCY(344,RECEIPDA,1,DA,1)),"^",2)
"RTN","RCDPR215",82,0)
 ;
"RTN","RCDPR215",83,0)
 ;  print unapplied amounts that went to suspense
"RTN","RCDPR215",84,0)
 I $O(^TMP($J,"RCDPR215",0)) D
"RTN","RCDPR215",85,0)
 .   W !!?5,"Appropriation: 3875"
"RTN","RCDPR215",86,0)
 .   I RCTYPE="D" W !
"RTN","RCDPR215",87,0)
 .   ;
"RTN","RCDPR215",88,0)
 .   S COUNT=0,PRINTOTL=0
"RTN","RCDPR215",89,0)
 .   S DA=0 F  S DA=$O(^TMP($J,"RCDPR215",DA)) Q:'DA!($G(RCSTFLAG))  D
"RTN","RCDPR215",90,0)
 .   .   I $Y>(IOSL-6) D:SCREEN PAUSE Q:$G(RCSTFLAG)  D H
"RTN","RCDPR215",91,0)
 .   .   ;
"RTN","RCDPR215",92,0)
 .   .   S UNAPPLY=$P(^TMP($J,"RCDPR215",DA),"^"),AMOUNT=$P(^(DA),"^",2),COMMENTS=$P(^(DA),"^",3)
"RTN","RCDPR215",93,0)
 .   .   S PRINTOTL=PRINTOTL+AMOUNT
"RTN","RCDPR215",94,0)
 .   .   S $P(TOTAL,"^")=$P(TOTAL,"^")+AMOUNT
"RTN","RCDPR215",95,0)
 .   .   ;  if accrued report, do not show detail
"RTN","RCDPR215",96,0)
 .   .   I RCTYPE="A" Q
"RTN","RCDPR215",97,0)
 .   .   ;
"RTN","RCDPR215",98,0)
 .   .   S COUNT=COUNT+1
"RTN","RCDPR215",99,0)
 .   .   W !?5,COUNT,")",?10,UNAPPLY,?30,$J(AMOUNT,10,2),?45,"COMMENTS: ",$E(COMMENTS,1,25)
"RTN","RCDPR215",100,0)
 .   .   I $TR($E(COMMENTS,26,80)," ")'="" W !?25,$E(COMMENTS,26,80)
"RTN","RCDPR215",101,0)
 .   ;
"RTN","RCDPR215",102,0)
 .   I $G(RCSTFLAG) Q
"RTN","RCDPR215",103,0)
 .   I RCTYPE="D" W !?30,"----------",!?5,"TOTAL for 3875"
"RTN","RCDPR215",104,0)
 .   W ?30,$J(PRINTOTL,10,2)
"RTN","RCDPR215",105,0)
 I $G(RCSTFLAG) D Q Q
"RTN","RCDPR215",106,0)
 ;
"RTN","RCDPR215",107,0)
 S TOTLAMT=0 F PIECE=1:1:5 S TOTLAMT=TOTLAMT+$P(TOTAL,"^",PIECE)
"RTN","RCDPR215",108,0)
 W !!,"TOTALS: "
"RTN","RCDPR215",109,0)
 W !?5,"TOTAL AMOUNT POSTED:",?30,$J(TOTLAMT,10,2)
"RTN","RCDPR215",110,0)
 ;
"RTN","RCDPR215",111,0)
 I SCREEN W !,"Press RETURN to continue: " R X:DTIME
"RTN","RCDPR215",112,0)
Q D ^%ZISC
"RTN","RCDPR215",113,0)
 K ^TMP($J,"RCFMSCR"),^TMP($J,"RCDPR215")
"RTN","RCDPR215",114,0)
 Q
"RTN","RCDPR215",115,0)
 ;
"RTN","RCDPR215",116,0)
 ;
"RTN","RCDPR215",117,0)
GETTYPE() ;  ask the type of report to print
"RTN","RCDPR215",118,0)
 N DIR,X,Y
"RTN","RCDPR215",119,0)
 S DIR(0)="S^A:ACCRUED;D:DETAILED",DIR("A")="ACCRUED OR DETAILED REPORT",DIR("B")="ACCRUED",DIR("?")="A DETAILED Report will list out accrued bills separately"
"RTN","RCDPR215",120,0)
 S DIR("?",1)="An ACCRUED Report will list just the accrued total under each appropriation"
"RTN","RCDPR215",121,0)
 D ^DIR
"RTN","RCDPR215",122,0)
 I Y'="A",Y'="D" Q ""
"RTN","RCDPR215",123,0)
 Q Y
"RTN","RCDPR215",124,0)
 ;
"RTN","RCDPR215",125,0)
 ;
"RTN","RCDPR215",126,0)
DEBTOR(DA) ;  returns the debtor name for ien of bill (da) in file 430
"RTN","RCDPR215",127,0)
 N D0,DEBTOR,DIC,DIQ,DR
"RTN","RCDPR215",128,0)
 S DIC="^PRCA(430,",DR=9,DIQ(0)="E",DIQ="DEBTOR"
"RTN","RCDPR215",129,0)
 D EN^DIQ1
"RTN","RCDPR215",130,0)
 Q $G(DEBTOR(430,DA,9,"E"))
"RTN","RCDPR215",131,0)
 ;
"RTN","RCDPR215",132,0)
 ;
"RTN","RCDPR215",133,0)
H ;  header
"RTN","RCDPR215",134,0)
 N Z
"RTN","RCDPR215",135,0)
 S PAGE=PAGE+1 I PAGE'=1!(SCREEN) W @IOF
"RTN","RCDPR215",136,0)
 W $C(13),"Page ",PAGE,?(80-$L(NOW)),NOW
"RTN","RCDPR215",137,0)
 W !,$E($TR(RCYLINE,"-","*"),1,34)," 215 REPORT ",$E($TR(RCYLINE,"-","*"),1,34)
"RTN","RCDPR215",138,0)
 W !!,"RECEIPT #: ",RECEIPT,?25,"for DEPOSIT #: ",DEPOSIT
"RTN","RCDPR215",139,0)
 I FMSDOCNO'="" W ?51,"FMS Document #: ",FMSDOCNO
"RTN","RCDPR215",140,0)
 S Z=""
"RTN","RCDPR215",141,0)
 I $P($G(^RCY(344,RECEIPDA,0)),U,18) S Z=$E(" REFERENCE ERA #: "_$P($G(^RCY(344.4,+$P($G(^RCY(344,RECEIPDA,0)),U,18),0)),U)_" ("_$P($G(^RCY(344.4,+$P($G(^RCY(344,RECEIPDA,0)),U,18),0)),U,2)_")"_$J("",51),1,51)
"RTN","RCDPR215",142,0)
 I Z'="" W !,Z
"RTN","RCDPR215",143,0)
 W !,RCYLINE
"RTN","RCDPR215",144,0)
 Q
"RTN","RCDPR215",145,0)
 ;
"RTN","RCDPR215",146,0)
 ;
"RTN","RCDPR215",147,0)
PAUSE ;  pause at end of page
"RTN","RCDPR215",148,0)
 N X U IO(0) W !,"Press RETURN to continue, '^' to exit:" R X:DTIME S:'$T X="^" S:X["^" RCSTFLAG=1 U IO
"RTN","RCDPR215",149,0)
 Q
"RTN","RCXFMSUF")
0^3^B17434881
"RTN","RCXFMSUF",1,0)
RCXFMSUF ;WISC/RFJ-calculate fms fund code for a bill ;1 Oct 97
"RTN","RCXFMSUF",2,0)
 ;;4.5;Accounts Receivable;**90,101,135,157,160,165,170,203,207,173,211**;Mar 20, 1995
"RTN","RCXFMSUF",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCXFMSUF",4,0)
 Q
"RTN","RCXFMSUF",5,0)
 ;
"RTN","RCXFMSUF",6,0)
 ;
"RTN","RCXFMSUF",7,0)
GETFUNDO(TYPE) ;  return the fund for other type associated collections
"RTN","RCXFMSUF",8,0)
 ;  type can equal:
"RTN","RCXFMSUF",9,0)
 ;  I for interest         A for admin
"RTN","RCXFMSUF",10,0)
 ;  M for marshall fee     C for court cost
"RTN","RCXFMSUF",11,0)
 I TYPE="I" Q "1435"
"RTN","RCXFMSUF",12,0)
 I TYPE="A" Q "3220"
"RTN","RCXFMSUF",13,0)
 I TYPE="M" Q "0869"
"RTN","RCXFMSUF",14,0)
 I TYPE="C" Q "0869"
"RTN","RCXFMSUF",15,0)
 Q ""
"RTN","RCXFMSUF",16,0)
 ;
"RTN","RCXFMSUF",17,0)
 ;
"RTN","RCXFMSUF",18,0)
GETFUNDB(BILLDA,DONTSTOR,RCEFT) ;  return a bills fms fund code
"RTN","RCXFMSUF",19,0)
 ;  pass DONTSTOR equal 1 to prevent storing the fund code
"RTN","RCXFMSUF",20,0)
 ;  cannot rely on data in the fund field since it may reference the
"RTN","RCXFMSUF",21,0)
 ;  old funds S FUND=$P($G(^PRCA(430,BILLDA,11)),"^",17).  since there
"RTN","RCXFMSUF",22,0)
 ;  are reports which use 11;17, set it for a bill once its computed
"RTN","RCXFMSUF",23,0)
 ;  until all references to the fund are eliminated.
"RTN","RCXFMSUF",24,0)
 ;  rceft = 1 if processing an EFT deposit
"RTN","RCXFMSUF",25,0)
 ;
"RTN","RCXFMSUF",26,0)
 N ACTDATE,CATEGDA,FUND
"RTN","RCXFMSUF",27,0)
 ;
"RTN","RCXFMSUF",28,0)
 ;  calculate a bills fund
"RTN","RCXFMSUF",29,0)
 I $G(RCEFT)=1 S FUND="5287"_$S(DT<3030926:"",1:".4") Q FUND
"RTN","RCXFMSUF",30,0)
 S CATEGDA=+$P($G(^PRCA(430,BILLDA,0)),"^",2)
"RTN","RCXFMSUF",31,0)
 I CATEGDA>39 Q ""
"RTN","RCXFMSUF",32,0)
 ;
"RTN","RCXFMSUF",33,0)
 ;  piece 5 is new fund, remove spaces
"RTN","RCXFMSUF",34,0)
 S FUND=$P($TR($T(@CATEGDA)," "),";",5)
"RTN","RCXFMSUF",35,0)
 ;
"RTN","RCXFMSUF",36,0)
 ;  if category is vendor(17), ex-employee(15), current employee(16)
"RTN","RCXFMSUF",37,0)
 ;  federal agency refund(13), federal agency reimb(14), military(12)
"RTN","RCXFMSUF",38,0)
 ;  set the fund to what is stored in the file.  This was entered
"RTN","RCXFMSUF",39,0)
 ;  by the user during the audit process.  If fund is in the file
"RTN","RCXFMSUF",40,0)
 ;  already, do not need to store it again.
"RTN","RCXFMSUF",41,0)
 I CATEGDA=17!(CATEGDA=15)!(CATEGDA=16)!(CATEGDA=13)!(CATEGDA=14)!(CATEGDA=12) D
"RTN","RCXFMSUF",42,0)
 .   I $P($G(^PRCA(430,BILLDA,11)),"^",17)'="" S FUND=$P(^(11),"^",17),DONTSTOR=1
"RTN","RCXFMSUF",43,0)
 ;
"RTN","RCXFMSUF",44,0)
 ;  public law states that bills in the category ineligible (1),
"RTN","RCXFMSUF",45,0)
 ;  emerg/human (2), torts (10), or medicare (21) which are older 
"RTN","RCXFMSUF",46,0)
 ;  than oct 1, 1992 should be reported under fund 3220.
"RTN","RCXFMSUF",47,0)
 I CATEGDA=1!(CATEGDA=2)!(CATEGDA=10)!(CATEGDA=21) D
"RTN","RCXFMSUF",48,0)
 .   S ACTDATE=$P($G(^PRCA(430,BILLDA,6)),"^",21)
"RTN","RCXFMSUF",49,0)
 .   I ACTDATE,ACTDATE<2921001 S FUND=3220 Q
"RTN","RCXFMSUF",50,0)
 .   ;
"RTN","RCXFMSUF",51,0)
 .   ;  patch157 changes ineligibles.  an ineligible activated before
"RTN","RCXFMSUF",52,0)
 .   ;  oct 1, 1992 or after sep 30, 2000 will be recorded in fund 0160A1.
"RTN","RCXFMSUF",53,0)
 .   ;  otherwise it will be recorded in fund 5287.3
"RTN","RCXFMSUF",54,0)
 .   I CATEGDA=1,ACTDATE,ACTDATE<3001001 S FUND=5287.3
"RTN","RCXFMSUF",55,0)
 ;
"RTN","RCXFMSUF",56,0)
 ;  set the fund for the bill
"RTN","RCXFMSUF",57,0)
 I $G(DONTSTOR)'=1 D STORE^RCXFMSUR(BILLDA,"",FUND)
"RTN","RCXFMSUF",58,0)
 ;
"RTN","RCXFMSUF",59,0)
 I $G(REPRODT),REPRODT<3030926,$P(FUND,".")=5287 Q 5287
"RTN","RCXFMSUF",60,0)
 I $G(REPRODT),REPRODT<3031001,$P(FUND,".")=5287,$G(REFMS) Q 5287
"RTN","RCXFMSUF",61,0)
 I DT<3030926,$P(FUND,".")=5287 Q 5287 ; Effective date
"RTN","RCXFMSUF",62,0)
 I DT<3031001,$P(FUND,".")=5287,$G(REFMS) Q 5287 ; Resubmitted documents not held
"RTN","RCXFMSUF",63,0)
 Q FUND
"RTN","RCXFMSUF",64,0)
 ;
"RTN","RCXFMSUF",65,0)
 ;
"RTN","RCXFMSUF",66,0)
 ;  this is a listing of all categories and associated funds
"RTN","RCXFMSUF",67,0)
 ;  the label is from the internal entry number in the category
"RTN","RCXFMSUF",68,0)
 ;  file 430.2.  piece 3 is a description, piece 4 is the old fund,
"RTN","RCXFMSUF",69,0)
 ;  piece 5 is the new fund
"RTN","RCXFMSUF",70,0)
0 ;;no fund                       ;       ;    
"RTN","RCXFMSUF",71,0)
1 ;;INELIGIBLE HOSP.              ;3220   ;0160A1
"RTN","RCXFMSUF",72,0)
2 ;;EMERGENCY/HUMANITARIAN        ;0160A1 ;5287.3
"RTN","RCXFMSUF",73,0)
3 ;;NURSING HOME CARE(NSC)        ;2431   ;5287.3
"RTN","RCXFMSUF",74,0)
4 ;;OUTPATIENT CARE(NSC)          ;2431   ;5287.3
"RTN","RCXFMSUF",75,0)
5 ;;HOSPITAL CARE (NSC)           ;2431   ;5287.3
"RTN","RCXFMSUF",76,0)
6 ;;WORKMAN'S COMP.               ;5014   ;5287.4
"RTN","RCXFMSUF",77,0)
7 ;;NO-FAULT AUTO ACC.            ;5014   ;5287.4
"RTN","RCXFMSUF",78,0)
8 ;;CRIME OF PER.VIO.             ;5014   ;5287.4
"RTN","RCXFMSUF",79,0)
9 ;;REIMBURS.HEALTH INS.          ;5014   ;5287.4
"RTN","RCXFMSUF",80,0)
10 ;;TORT FEASOR                   ;0160A1 ;5287.4
"RTN","RCXFMSUF",81,0)
11 ;;no entry                      ;       ;
"RTN","RCXFMSUF",82,0)
12 ;;MILITARY                      ;0160A1 ;0160A1
"RTN","RCXFMSUF",83,0)
13 ;;FEDERAL AGENCIES-REFUND       ;0160A1 ;0160A1
"RTN","RCXFMSUF",84,0)
14 ;;FEDERAL AGENCIES-REIMB.       ;0160A1 ;0160A1
"RTN","RCXFMSUF",85,0)
15 ;;EX-EMPLOYEE                   ;0160A1 ;0160A1
"RTN","RCXFMSUF",86,0)
16 ;;CURRENT EMP.                  ;0160A1 ;0160A1
"RTN","RCXFMSUF",87,0)
17 ;;VENDOR                        ;0160A1 ;0160A1
"RTN","RCXFMSUF",88,0)
18 ;;C (MEANS TEST)                ;2431   ;5287.3
"RTN","RCXFMSUF",89,0)
19 ;;SHARING AGREEMENTS            ;0160A1 ;0160A1
"RTN","RCXFMSUF",90,0)
20 ;;INTERAGENCY                   ;0160A1 ;0160A1
"RTN","RCXFMSUF",91,0)
21 ;;MEDICARE                      ;5014   ;5287.4
"RTN","RCXFMSUF",92,0)
22 ;;RX CO-PAYMENT/SC VET          ;5014   ;5287.1
"RTN","RCXFMSUF",93,0)
23 ;;RX CO-PAYMENT/NSC VET         ;5014   ;5287.1
"RTN","RCXFMSUF",94,0)
24 ;;NURSING HOME CARE PER DIEM    ;2431   ;5287.3
"RTN","RCXFMSUF",95,0)
25 ;;HOSPITAL CARE PER DIEM        ;2431   ;5287.3
"RTN","RCXFMSUF",96,0)
26 ;;PREPAYMENT                    ;5014   ;5287.3
"RTN","RCXFMSUF",97,0)
27 ;;CHAMPVA SUBSISTENCE           ;3220   ;3220
"RTN","RCXFMSUF",98,0)
28 ;;CHAMPVA THIRD PARTY           ;3220   ;3220
"RTN","RCXFMSUF",99,0)
29 ;;CHAMPVA                       ;0160A1 ;0160A1
"RTN","RCXFMSUF",100,0)
30 ;;CHAMPUS                       ;0160A1 ;0160A1
"RTN","RCXFMSUF",101,0)
31 ;;CHAMPUS PATIENT               ;0160A1 ;0160A1
"RTN","RCXFMSUF",102,0)
32 ;;CHAMPUS THIRD PARTY           ;0160A1 ;0160A1
"RTN","RCXFMSUF",103,0)
33 ;;ADULT DAY HEALTH CARE         ;       ;4032
"RTN","RCXFMSUF",104,0)
34 ;;DOMICILIARY                   ;       ;4032
"RTN","RCXFMSUF",105,0)
35 ;;RESPITE CARE-INSTITUTIONAL    ;       ;4032
"RTN","RCXFMSUF",106,0)
36 ;;RESPITE CARE-NON-INSTITUTIONAL;       ;4032
"RTN","RCXFMSUF",107,0)
37 ;;GERIATRIC EVAL-INSTITUTIONAL  ;       ;4032
"RTN","RCXFMSUF",108,0)
38 ;;GERIATRIC EVAL-NON-INSTITUTION;       ;4032
"RTN","RCXFMSUF",109,0)
39 ;;NURSING HOME CARE-LTC         ;       ;4032
"VER")
8.0^22
**END**
**END**
