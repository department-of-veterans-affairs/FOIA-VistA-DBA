Released XU*8*73 SEQ #57
Extracted from mail message
**KIDS**:XU*8.0*73^

**INSTALL NAME**
XU*8.0*73
"BLD",28,0)
XU*8.0*73^KERNEL^0^2980211^y
"BLD",28,1,0)
^^79^79^2980224^
"BLD",28,1,1,0)
*** This patch is a high priority because it is needed by the OpenM ***
"BLD",28,1,2,0)
*** sites to adjust to changes made by Intersystem in build 52e that***
"BLD",28,1,3,0)
*** is going out to the sites.                                      ***
"BLD",28,1,4,0)
 
"BLD",28,1,5,0)
 
"BLD",28,1,6,0)
ISL-0198-51102  XUSTERM  Didn't have code to call the extended-action option
"BLD",28,1,7,0)
                         in XUSTERM2.
"BLD",28,1,8,0)
                         
"BLD",28,1,9,0)
                XQ33    Fix from IHS about deleting options.
"BLD",28,1,10,0)
                   
"BLD",28,1,11,0)
                ZTER    Change to allow OpenM sites to use the new error
"BLD",28,1,12,0)
                        trapping.  The check was conditional because early
"BLD",28,1,13,0)
                        versions didn't support this.  Then OpenM started
"BLD",28,1,14,0)
                        changing its name with each version. Fixed to remove
"BLD",28,1,15,0)
                        version checking, assume all VA site running current
"BLD",28,1,16,0)
                        version that supports standard error trapping.
"BLD",28,1,17,0)
                        
"BLD",28,1,18,0)
                        The options XUDEV RES-ONE and XUDEV RES-CLEAR didn't
"BLD",28,1,19,0)
                        get linked to the XUTIO menu in patch 49.
"BLD",28,1,20,0)
                        Resending to link them up.
"BLD",28,1,21,0)
                        
"BLD",28,1,22,0)
BIL-0298-30193          Alert tracking file 8992.1 was missing field .08
"BLD",28,1,23,0)
                        to control retention of alerts.
"BLD",28,1,24,0)
                        
"BLD",28,1,25,0)
                 Checksum
"BLD",28,1,26,0)
Routine         Old       New      2nd Line
"BLD",28,1,27,0)
XQ33          8946889   9007179    **49,73**
"BLD",28,1,28,0)
XUSTERM                14376497    **36,73**
"BLD",28,1,29,0)
ZTER         18727059  19441177    **8,18,32,24,36,63,73**
"BLD",28,1,30,0)
 
"BLD",28,1,31,0)
========================================================================= 
"BLD",28,1,32,0)
Installation:
"BLD",28,1,33,0)
 
"BLD",28,1,34,0)
  1.  DSM sites - Some of these routines are usually mapped,
"BLD",28,1,35,0)
      so you will need to disable mapping for the effected routines.
"BLD",28,1,36,0)
      
"BLD",28,1,37,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",28,1,38,0)
      option will load the KIDS package onto your system.
"BLD",28,1,39,0)
      
"BLD",28,1,40,0)
  3.  The patch has now been loaded into a Transport global on your
"BLD",28,1,41,0)
      system. You now need to use KIDS to install the Transport global.
"BLD",28,1,42,0)
      On the KIDS menu, under the 'Installation' menu, use the following
"BLD",28,1,43,0)
      options:
"BLD",28,1,44,0)
      
"BLD",28,1,45,0)
         Verify Checksum's in Transport Global
"BLD",28,1,46,0)
         Print Transport Global
"BLD",28,1,47,0)
         Compare Transport Global to Current System
"BLD",28,1,48,0)
         Backup a Transport Global
"BLD",28,1,49,0)
         
"BLD",28,1,50,0)
 4.   Users can remain on the system. This patch can be loaded any
"BLD",28,1,51,0)
      non-peek time.
"BLD",28,1,52,0)
      
"BLD",28,1,53,0)
  5.  On the KIDS menu, under the 'Installation' menu, use the following
"BLD",28,1,54,0)
      option:
"BLD",28,1,55,0)
         Install Package(s)  'XU*8.0*73'
"BLD",28,1,56,0)
                              =========
"BLD",28,1,57,0)
         
"BLD",28,1,58,0)
  7.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",28,1,59,0)
      other CPUs?'. Enter the names of your Compute and Print server(s).
"BLD",28,1,60,0)
      
"BLD",28,1,61,0)
  8.  After installing this patch, 
"BLD",28,1,62,0)
      DSM/MSM sites - you need to move one routines from 
"BLD",28,1,63,0)
      your production account to each manager account:
"BLD",28,1,64,0)
      OpenM Sites - you don't need to move anything, skip this step.
"BLD",28,1,65,0)
      ZTER
"BLD",28,1,66,0)
      
"BLD",28,1,67,0)
      And in the manager account,  (OpenM sites remain in VAH)
"BLD",28,1,68,0)
       
"BLD",28,1,69,0)
      All sites:
"BLD",28,1,70,0)
      DO RELOAD^ZTMGRSET
"BLD",28,1,71,0)
      Select the System
"BLD",28,1,72,0)
      Patch number to load: 73
"BLD",28,1,73,0)
                            ==
"BLD",28,1,74,0)
       
"BLD",28,1,75,0)
  9.  MSM sites move these routines to the MGR accounts on other CPU's.
"BLD",28,1,76,0)
        
"BLD",28,1,77,0)
 10.  DSM Sites, after patch has installed, rebuild your map set.
"BLD",28,1,78,0)
 
"BLD",28,1,79,0)
=========================================================================
"BLD",28,4,0)
^9.64PA^8992.1^1
"BLD",28,4,8992.1,0)
8992.1
"BLD",28,4,8992.1,2,0)
^9.641^8992.1^1
"BLD",28,4,8992.1,2,8992.1,0)
ALERT TRACKING  (File-top level)
"BLD",28,4,8992.1,2,8992.1,1,0)
^9.6411^.08^1
"BLD",28,4,8992.1,2,8992.1,1,.08,0)
RETENTION DATE
"BLD",28,4,8992.1,222)
y^y^p^^^^n
"BLD",28,4,"APDD",8992.1,8992.1)

"BLD",28,4,"APDD",8992.1,8992.1,.08)

"BLD",28,4,"B",8992.1,8992.1)

"BLD",28,"KRN",0)
^9.67PA^19^15
"BLD",28,"KRN",.4,0)
.4
"BLD",28,"KRN",.401,0)
.401
"BLD",28,"KRN",.402,0)
.402
"BLD",28,"KRN",.403,0)
.403
"BLD",28,"KRN",.5,0)
.5
"BLD",28,"KRN",.84,0)
.84
"BLD",28,"KRN",3.6,0)
3.6
"BLD",28,"KRN",3.8,0)
3.8
"BLD",28,"KRN",9.2,0)
9.2
"BLD",28,"KRN",9.8,0)
9.8
"BLD",28,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",28,"KRN",9.8,"NM",1,0)
XQ33^^0^B11437563
"BLD",28,"KRN",9.8,"NM",2,0)
XUSTERM^^0^B23337826
"BLD",28,"KRN",9.8,"NM",3,0)
ZTER^^0^B28413046
"BLD",28,"KRN",9.8,"NM","B","XQ33",1)

"BLD",28,"KRN",9.8,"NM","B","XUSTERM",2)

"BLD",28,"KRN",9.8,"NM","B","ZTER",3)

"BLD",28,"KRN",19,0)
19
"BLD",28,"KRN",19,"NM",0)
^9.68A^3^3
"BLD",28,"KRN",19,"NM",1,0)
XUTIO^^2
"BLD",28,"KRN",19,"NM",2,0)
XUDEV RES-ONE^^0
"BLD",28,"KRN",19,"NM",3,0)
XUDEV RES-CLEAR^^0
"BLD",28,"KRN",19,"NM","B","XUDEV RES-CLEAR",3)

"BLD",28,"KRN",19,"NM","B","XUDEV RES-ONE",2)

"BLD",28,"KRN",19,"NM","B","XUTIO",1)

"BLD",28,"KRN",19.1,0)
19.1
"BLD",28,"KRN",101,0)
101
"BLD",28,"KRN",869.2,0)
869.2
"BLD",28,"KRN",8994,0)
8994
"BLD",28,"KRN","B",.4,.4)

"BLD",28,"KRN","B",.401,.401)

"BLD",28,"KRN","B",.402,.402)

"BLD",28,"KRN","B",.403,.403)

"BLD",28,"KRN","B",.5,.5)

"BLD",28,"KRN","B",.84,.84)

"BLD",28,"KRN","B",3.6,3.6)

"BLD",28,"KRN","B",3.8,3.8)

"BLD",28,"KRN","B",9.2,9.2)

"BLD",28,"KRN","B",9.8,9.8)

"BLD",28,"KRN","B",19,19)

"BLD",28,"KRN","B",19.1,19.1)

"BLD",28,"KRN","B",101,101)

"BLD",28,"KRN","B",869.2,869.2)

"BLD",28,"KRN","B",8994,8994)

"BLD",28,"QUES",0)
^9.62^^
"BLD",28,"REQB",0)
^9.611^1^1
"BLD",28,"REQB",1,0)
XU*8.0*63^2
"BLD",28,"REQB","B","XU*8.0*63",1)

"FIA",8992.1)
ALERT TRACKING
"FIA",8992.1,0)
^XTV(8992.1,
"FIA",8992.1,0,0)
8992.1A
"FIA",8992.1,0,1)
y^y^p^^^^n
"FIA",8992.1,0,10)

"FIA",8992.1,0,11)

"FIA",8992.1,0,"RLRO")

"FIA",8992.1,0,"VR")
8.0^XU
"FIA",8992.1,8992.1)
1
"FIA",8992.1,8992.1,.08)

"KRN",19,11,-1)
2^1
"KRN",19,11,0)
XUTIO^Device Management^^M^.5^^91^^^n^^^n^^
"KRN",19,11,10,0)
^19.01PI^19^19
"KRN",19,11,10,18,0)
601
"KRN",19,11,10,18,"^")
XUDEV RES-ONE
"KRN",19,11,10,19,0)
600
"KRN",19,11,10,19,"^")
XUDEV RES-CLEAR
"KRN",19,11,"U")
DEVICE MANAGEMENT
"KRN",19,600,-1)
0^3
"KRN",19,600,0)
XUDEV RES-CLEAR^Clear all resources^^R^^^^^^^^KERNEL
"KRN",19,600,1,0)
^^5^5^2961115^
"KRN",19,600,1,1,0)
This option should only be used as a TaskMan Startup option or by
"KRN",19,600,1,2,0)
a knowledgeable site person.
"KRN",19,600,1,3,0)
 
"KRN",19,600,1,4,0)
This option will loop through all entries in the Resource file (3.54)
"KRN",19,600,1,5,0)
and remove any slot in use entries.
"KRN",19,600,25)
RELALL^XUDHRES
"KRN",19,600,200.9)
y
"KRN",19,600,"U")
CLEAR ALL RESOURCES
"KRN",19,601,-1)
0^2
"KRN",19,601,0)
XUDEV RES-ONE^Clear one Resource^^R^^^^^^^^KERNEL
"KRN",19,601,1,0)
^^2^2^2961125^
"KRN",19,601,1,1,0)
This option will allow the clearing/reseting of one entry of one
"KRN",19,601,1,2,0)
resource.  This is to be used by IRM personal to clear problems.
"KRN",19,601,25)
RELONE^XUDHRES
"KRN",19,601,"U")
CLEAR ONE RESOURCE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
73^2980211
"PKG",3,22,1,"PAH",1,1,0)
^^79^79^2980224
"PKG",3,22,1,"PAH",1,1,1,0)
*** This patch is a high priority because it is needed by the OpenM ***
"PKG",3,22,1,"PAH",1,1,2,0)
*** sites to adjust to changes made by Intersystem in build 52e that***
"PKG",3,22,1,"PAH",1,1,3,0)
*** is going out to the sites.                                      ***
"PKG",3,22,1,"PAH",1,1,4,0)
 
"PKG",3,22,1,"PAH",1,1,5,0)
 
"PKG",3,22,1,"PAH",1,1,6,0)
ISL-0198-51102  XUSTERM  Didn't have code to call the extended-action option
"PKG",3,22,1,"PAH",1,1,7,0)
                         in XUSTERM2.
"PKG",3,22,1,"PAH",1,1,8,0)
                         
"PKG",3,22,1,"PAH",1,1,9,0)
                XQ33    Fix from IHS about deleting options.
"PKG",3,22,1,"PAH",1,1,10,0)
                   
"PKG",3,22,1,"PAH",1,1,11,0)
                ZTER    Change to allow OpenM sites to use the new error
"PKG",3,22,1,"PAH",1,1,12,0)
                        trapping.  The check was conditional because early
"PKG",3,22,1,"PAH",1,1,13,0)
                        versions didn't support this.  Then OpenM started
"PKG",3,22,1,"PAH",1,1,14,0)
                        changing its name with each version. Fixed to remove
"PKG",3,22,1,"PAH",1,1,15,0)
                        version checking, assume all VA site running current
"PKG",3,22,1,"PAH",1,1,16,0)
                        version that supports standard error trapping.
"PKG",3,22,1,"PAH",1,1,17,0)
                        
"PKG",3,22,1,"PAH",1,1,18,0)
                        The options XUDEV RES-ONE and XUDEV RES-CLEAR didn't
"PKG",3,22,1,"PAH",1,1,19,0)
                        get linked to the XUTIO menu in patch 49.
"PKG",3,22,1,"PAH",1,1,20,0)
                        Resending to link them up.
"PKG",3,22,1,"PAH",1,1,21,0)
                        
"PKG",3,22,1,"PAH",1,1,22,0)
BIL-0298-30193          Alert tracking file 8992.1 was missing field .08
"PKG",3,22,1,"PAH",1,1,23,0)
                        to control retention of alerts.
"PKG",3,22,1,"PAH",1,1,24,0)
                        
"PKG",3,22,1,"PAH",1,1,25,0)
                 Checksum
"PKG",3,22,1,"PAH",1,1,26,0)
Routine         Old       New      2nd Line
"PKG",3,22,1,"PAH",1,1,27,0)
XQ33          8946889   9007179    **49,73**
"PKG",3,22,1,"PAH",1,1,28,0)
XUSTERM                14376497    **36,73**
"PKG",3,22,1,"PAH",1,1,29,0)
ZTER         18727059  19441177    **8,18,32,24,36,63,73**
"PKG",3,22,1,"PAH",1,1,30,0)
 
"PKG",3,22,1,"PAH",1,1,31,0)
========================================================================= 
"PKG",3,22,1,"PAH",1,1,32,0)
Installation:
"PKG",3,22,1,"PAH",1,1,33,0)
 
"PKG",3,22,1,"PAH",1,1,34,0)
  1.  DSM sites - Some of these routines are usually mapped,
"PKG",3,22,1,"PAH",1,1,35,0)
      so you will need to disable mapping for the effected routines.
"PKG",3,22,1,"PAH",1,1,36,0)
      
"PKG",3,22,1,"PAH",1,1,37,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",3,22,1,"PAH",1,1,38,0)
      option will load the KIDS package onto your system.
"PKG",3,22,1,"PAH",1,1,39,0)
      
"PKG",3,22,1,"PAH",1,1,40,0)
  3.  The patch has now been loaded into a Transport global on your
"PKG",3,22,1,"PAH",1,1,41,0)
      system. You now need to use KIDS to install the Transport global.
"PKG",3,22,1,"PAH",1,1,42,0)
      On the KIDS menu, under the 'Installation' menu, use the following
"PKG",3,22,1,"PAH",1,1,43,0)
      options:
"PKG",3,22,1,"PAH",1,1,44,0)
      
"PKG",3,22,1,"PAH",1,1,45,0)
         Verify Checksum's in Transport Global
"PKG",3,22,1,"PAH",1,1,46,0)
         Print Transport Global
"PKG",3,22,1,"PAH",1,1,47,0)
         Compare Transport Global to Current System
"PKG",3,22,1,"PAH",1,1,48,0)
         Backup a Transport Global
"PKG",3,22,1,"PAH",1,1,49,0)
         
"PKG",3,22,1,"PAH",1,1,50,0)
 4.   Users can remain on the system. This patch can be loaded any
"PKG",3,22,1,"PAH",1,1,51,0)
      non-peek time.
"PKG",3,22,1,"PAH",1,1,52,0)
      
"PKG",3,22,1,"PAH",1,1,53,0)
  5.  On the KIDS menu, under the 'Installation' menu, use the following
"PKG",3,22,1,"PAH",1,1,54,0)
      option:
"PKG",3,22,1,"PAH",1,1,55,0)
         Install Package(s)  'XU*8.0*73'
"PKG",3,22,1,"PAH",1,1,56,0)
                              =========
"PKG",3,22,1,"PAH",1,1,57,0)
         
"PKG",3,22,1,"PAH",1,1,58,0)
  7.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",3,22,1,"PAH",1,1,59,0)
      other CPUs?'. Enter the names of your Compute and Print server(s).
"PKG",3,22,1,"PAH",1,1,60,0)
      
"PKG",3,22,1,"PAH",1,1,61,0)
  8.  After installing this patch, 
"PKG",3,22,1,"PAH",1,1,62,0)
      DSM/MSM sites - you need to move one routines from 
"PKG",3,22,1,"PAH",1,1,63,0)
      your production account to each manager account:
"PKG",3,22,1,"PAH",1,1,64,0)
      OpenM Sites - you don't need to move anything, skip this step.
"PKG",3,22,1,"PAH",1,1,65,0)
      ZTER
"PKG",3,22,1,"PAH",1,1,66,0)
      
"PKG",3,22,1,"PAH",1,1,67,0)
      And in the manager account,  (OpenM sites remain in VAH)
"PKG",3,22,1,"PAH",1,1,68,0)
       
"PKG",3,22,1,"PAH",1,1,69,0)
      All sites:
"PKG",3,22,1,"PAH",1,1,70,0)
      DO RELOAD^ZTMGRSET
"PKG",3,22,1,"PAH",1,1,71,0)
      Select the System
"PKG",3,22,1,"PAH",1,1,72,0)
      Patch number to load: 73
"PKG",3,22,1,"PAH",1,1,73,0)
                            ==
"PKG",3,22,1,"PAH",1,1,74,0)
       
"PKG",3,22,1,"PAH",1,1,75,0)
  9.  MSM sites move these routines to the MGR accounts on other CPU's.
"PKG",3,22,1,"PAH",1,1,76,0)
        
"PKG",3,22,1,"PAH",1,1,77,0)
 10.  DSM Sites, after patch has installed, rebuild your map set.
"PKG",3,22,1,"PAH",1,1,78,0)
 
"PKG",3,22,1,"PAH",1,1,79,0)
=========================================================================
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","XQ33")
0^1^B11437563
"RTN","XQ33",1,0)
XQ33 ;SEA/AMF/JLI/MJM - REMOVE UNREFERENCED OPTIONS ;1/9/98  11:42
"RTN","XQ33",2,0)
 ;;8.0;KERNEL;**49,73**;Jul 10, 1995
"RTN","XQ33",3,0)
DUO ; Entry point to delete unreferenced options from the option file.
"RTN","XQ33",4,0)
 W !!,*7,"Do you want to delete unreferenced options" S %=2 D YN^DICN Q:%<0!(%=2)  I '% W !,"Enter a 'Y' if you want an opportunity to delete orphan options which are not",!,"primary menus, secondary menus, or tasked." G DUO
"RTN","XQ33",5,0)
 K ^TMP($J) S IOP="HOME" D ^%ZIS K IOP S XQENT=0
"RTN","XQ33",6,0)
 R !!,"Select PACKAGE/OPTION name: ALL// ",X:DTIME S:'$T X=U S DIC=9.4,DIC(0)="EMZ" Q:X[U  S:'$L(X) X="ALL"
"RTN","XQ33",7,0)
 I X="ALL" S XQS="@z",XQE="zzz" G GET
"RTN","XQ33",8,0)
 D ^DIC I Y>0 S XQS=$P(Y(0),U,2),XQE=XQS_"zzz" G GET
"RTN","XQ33",9,0)
 S DIC=19,DIC(0)="QEMZ" D ^DIC G:Y<0 DUO S XQE=$P(Y(0),U,1),XQS=$E(XQE,1,$L(XQE)-1)_$C($A($E(XQE,$L(XQE))-1))_"zzz"
"RTN","XQ33",10,0)
GET W !,"Getting the list of unreferenced options..." D LP W ! I '$D(^TMP($J)) W "...NONE FOUND",! G OUT
"RTN","XQ33",11,0)
 S XQI=0 F XQII=0:1 S DIC="^DIC(19,",DR="",XQI=$O(^TMP($J,XQI)) Q:XQI'>0  S DA=XQI W @IOF K S D EN^DIQ D DUO1 Q:XQUIT
"RTN","XQ33",12,0)
 G OUT
"RTN","XQ33",13,0)
DUO1 ;
"RTN","XQ33",14,0)
 W !!,"Want to delete this option" S %=2,XQUIT=0 D YN^DICN S:%<0 XQUIT=1 Q:%<0!(%=2)  I '% W !,"Enter a 'Y' if you want to remove this option from the option file" G DUO1
"RTN","XQ33",15,0)
 S DIK="^DIC(19," D ^DIK ;S DIE=19,DR=".01///@" D ^DIE
"RTN","XQ33",16,0)
 Q
"RTN","XQ33",17,0)
LP S XQUI=0,XQJ=XQS F  S XQJ=$O(^DIC(19,"B",XQJ)) Q:XQJ=""!XQUI!(XQJ]XQE)  D LP1
"RTN","XQ33",18,0)
 Q
"RTN","XQ33",19,0)
LP1 S XQI=0 F  S XQI=$O(^DIC(19,"B",XQJ,XQI)) Q:XQI'>0!XQUI  D LP2
"RTN","XQ33",20,0)
 Q
"RTN","XQ33",21,0)
LP2 I "BOQSX"[$P(^DIC(19,XQI,0),U,4) K XQFL Q  ;Special options
"RTN","XQ33",22,0)
 S XQFL="" W:XQENT !,XQJ,?31 I '$D(^DIC(19,"AD",XQI)) W:XQENT "** no parents **" G PRI
"RTN","XQ33",23,0)
 K XQFL S (XQK,XQLEN,XQNM)=0
"RTN","XQ33",24,0)
 I XQENT F  S XQK=$O(^DIC(19,"AD",XQI,XQK)) Q:XQK'>0  I $D(^DIC(19,XQK,0)) S L=$P(^DIC(19,XQK,0),U,1) S:XQLEN+$L(L)+2>34 XQLEN=0 W:'XQLEN&XQNM !?31 W:XQNM&XQLEN ", " W $P(^DIC(19,XQK,0),U,1) S XQLEN=XQLEN+$L(L)+2,XQNM=XQNM+1
"RTN","XQ33",25,0)
PRI ;
"RTN","XQ33",26,0)
 I $D(^VA(200,"AP",XQI)) W:XQENT ?65,"-P-" K XQFL ;Primary Menu
"RTN","XQ33",27,0)
 I $D(^VA(200,"AD",XQI)) W:XQENT ?70,"-S-" K XQFL ;Secondary Menu
"RTN","XQ33",28,0)
 I $D(^DIC(19,XQI,200.9)),^(200.9)["y" W:XQENT&($P(^(200.9),U)["y") ?75,"-T-" K XQFL ;Taskman or don't delete
"RTN","XQ33",29,0)
 E  I $D(^DIC(19.2,"B",XQI)) W:XQENT ?75,"-T-" K XQFL ;Taskman
"RTN","XQ33",30,0)
 I $D(XQFL) S ^TMP($J,XQI)=""
"RTN","XQ33",31,0)
 Q
"RTN","XQ33",32,0)
 ;
"RTN","XQ33",33,0)
OUT D ^%ZISC
"RTN","XQ33",34,0)
 K XQUI,XQJ,XQS,XQE,XQK,XQLEN,XQNM,XQI,I,J,K,C,L,DIC,POP,X,XQDSH,XQENT,XQHDR,XQP,Y,ZISI,ZTDTH,ZTSAVE,ZTRTN,ZTDESC,%A1,S,XQFL
"RTN","XQ33",35,0)
 K %Y,A,D0,D1,DA,DIW,DIWF,DIWL,DIWR,DIWT,DK,DL,DN,DR,DX,XQUIT
"RTN","XQ33",36,0)
 Q
"RTN","XUSTERM")
0^2^B23337826
"RTN","XUSTERM",1,0)
XUSTERM ;SEA/AMF/WDE - DEACTIVATE USER ;02/24/98  11:15
"RTN","XUSTERM",2,0)
 ;;8.0;KERNEL;**36,73**;Jul 10, 1995
"RTN","XUSTERM",3,0)
LKUP S (DIC,DIE)=200,DIC("S")="I $P(^(0),U,3)]""""",DIC(0)="AEQMZ",DIC("A")="Select USER to be deactivated: "
"RTN","XUSTERM",4,0)
 D ^DIC K DIC G END:Y<0
"RTN","XUSTERM",5,0)
 S XUDA=+Y,DR="["_$$GET^XUPARAM("XUSERDEACT","N")_"]" D GET,XUDIE^XUS5
"RTN","XUSTERM",6,0)
 S XUDT=$P(^VA(200,DA,0),U,11),XUACT=XUDT&(XUDT>DT) G END:'XUDT
"RTN","XUSTERM",7,0)
 ;
"RTN","XUSTERM",8,0)
WHEN I XUACT W !!,XUNAM," will be deactivated on date specified." S ZTDTH=XUDT,ZTRTN="DQ1^XUSTERM1",ZTDESC="DEACTIVATE USER",ZTSAVE("XUDA")="",ZTIO="" D ^%ZTLOAD G END
"RTN","XUSTERM",9,0)
NOW S DIR("A")=XUNAM_" will be deactivated now.  Do you wish to proceed",DIR("B")="YES",DIR("??")="XUUSER-DEACT",DIR(0)="Y" D ^DIR G:"Yy"'[$E(X_U) END
"RTN","XUSTERM",10,0)
 W ! S XUVE=1 D ACT G END
"RTN","XUSTERM",11,0)
 ;
"RTN","XUSTERM",12,0)
GET ;XUGRP=mail group, XUKEY=keys, XUSUR=mail surrogates, XUJ=# baskets, XUK=# mail msg, XUIN=# in-basket msg
"RTN","XUSTERM",13,0)
 ;XUTX1, XUTX2 used in edit templates
"RTN","XUSTERM",14,0)
 K XUGRP,XUKEY,XUSUR,XUTX1,XUTX2 N %,XU10,XU11,XU20,XU21,XU30
"RTN","XUSTERM",15,0)
 S (XU10,XU20)=0,(XU11,XU21,XU31)=""
"RTN","XUSTERM",16,0)
 S DA=XUDA,XUNAM=$P(^VA(200,XUDA,0),U,1)
"RTN","XUSTERM",17,0)
 F XUI=0:0 S XUI=$O(^XMB(3.8,"AB",XUDA,XUI)) Q:XUI'>0  D  ;Mail groups
"RTN","XUSTERM",18,0)
 . S XUK=^XMB(3.8,XUI,0) S:'$L($P(XUK,U,2)) $P(XUK,U,2)="PU"
"RTN","XUSTERM",19,0)
 . S XUGRP(XUI)=$P(XUK,U,1,2)_U_$S('$D(^XMB(3.8,XUI,3)):0,1:^(3)=XUDA)
"RTN","XUSTERM",20,0)
 . S XU10=XU10+1 S:$L(XU11)<70 XU11=XU11_","_$P(XUK,U)
"RTN","XUSTERM",21,0)
 F XUI=0:0 S XUI=$O(^VA(200,XUDA,51,XUI)) Q:XUI'>0  D  ;Get keys
"RTN","XUSTERM",22,0)
 . S %=$G(^DIC(19.1,XUI,0)),XU20=XU20+1
"RTN","XUSTERM",23,0)
 . S:$L(XU21)<70 XU21=XU21_","_$P(%,U)
"RTN","XUSTERM",24,0)
 . Q:$P(%,U,4)="y"  ;Don't count keep at terminate keys
"RTN","XUSTERM",25,0)
 . S XUKEY(XUI)=""
"RTN","XUSTERM",26,0)
 F XUI=0:0 S XUI=$O(^XMB(3.7,"AB",XUDA,XUI)) Q:XUI'>0  D
"RTN","XUSTERM",27,0)
 . S XUSUR(XUI)="" S:$L(XU31)<70 XU31=XU31_","_$P(^VA(200,XUI,0),U)
"RTN","XUSTERM",28,0)
 S (XUJ,XUK,XUIN,XUNUM)=0 F I=.9:0 S I=$O(^XMB(3.7,XUDA,2,I)) Q:I'>0  S XUJ=XUJ+1,XUNUM=$P($G(^XMB(3.7,XUDA,2,I,0)),U,5) S:XUNUM>0 XUK=XUK+XUNUM S:I=1 XUIN=XUNUM
"RTN","XUSTERM",29,0)
 S XUTX1(1)="User has "_XUK_" messages in "_XUJ_" baskets, Member of "_XU10_" Mail Groups."
"RTN","XUSTERM",30,0)
 S:XU10 XUTX1(2)="Mail Groups: "_$E(XU11,2,80) S:$L(XU31) XUTX1(3)="Surrogate for: "_$E(XU31,2,80)
"RTN","XUSTERM",31,0)
 S XUTX2(1)="User has "_XU20_" keys" S:XU20 XUTX2(2)=$E(XU21,2,80)
"RTN","XUSTERM",32,0)
 S XUEMP='($D(XUSUR)!$D(XUKEY)!$D(XUGRP)!XUJ!XUK!XUIN!$L($P(^VA(200,XUDA,0),U,3)))
"RTN","XUSTERM",33,0)
 Q
"RTN","XUSTERM",34,0)
ACT ;First let others clean-up, Then do our part.
"RTN","XUSTERM",35,0)
 D ^XUSTERM2 ;Cleanup by other packages.
"RTN","XUSTERM",36,0)
 K DIC S DA=XUDA,XUJ=^VA(200,XUDA,0),XUNAM=$P(XUJ,U,1),XUACT(19)=$S($D(^VA(200,XUDA,19)):^(19),1:"") F XUI=5,6,10 S XUACT(XUI)=$P(XUJ,U,XUI)
"RTN","XUSTERM",37,0)
ACT1 K ^DISV(XUDA) ; WARNING: This only gets ^DISV entries on current CPU
"RTN","XUSTERM",38,0)
 ;keys
"RTN","XUSTERM",39,0)
 I XUACT(6)="y" F XUI=0:0 S XUI=$O(^VA(200,XUDA,51,XUI)) Q:XUI'>0  I $P($G(^DIC(19.1,XUI,0)),U,4)'="y" S DA=XUI,DA(1)=XUDA,DIK="^VA(200,XUDA,51," D ^DIK W:XUVE "..."
"RTN","XUSTERM",40,0)
 ;delegated keys
"RTN","XUSTERM",41,0)
 I XUACT(6)="y" F XUI=0:0 S XUI=$O(^VA(200,XUDA,52,XUI)) Q:XUI'>0  S DA=XUI,DA(1)=XUDA,DIK="^VA(200,XUDA,52," D ^DIK W:XUVE "..."
"RTN","XUSTERM",42,0)
 ;Access;Verify;PAC;Last signon;SMD delagate;electronic signature,Primary menu,Hinq Employee #
"RTN","XUSTERM",43,0)
 S DIE=200,DA=XUDA,DR="2///@;11///@;14///@;1.1///@;19///@;19.2///@;20.4///@;201///@;14.9///@" D ^DIE
"RTN","XUSTERM",44,0)
 ;Delegated options
"RTN","XUSTERM",45,0)
 S DIK="^VA(200,XUDA,19.5,",DA(1)=XUDA F XUI=0:0 S XUI=$O(^VA(200,XUDA,19.5,XUI)) Q:XUI'>0  S DA=XUI D ^DIK
"RTN","XUSTERM",46,0)
 ;Menu templates
"RTN","XUSTERM",47,0)
 S DIK="^VA(200,XUDA,19.8,",DA(1)=XUDA F XUI=0:0 S XUI=$O(^VA(200,XUDA,19.8,XUI)) Q:XUI'>0  S DA=XUI D ^DIK
"RTN","XUSTERM",48,0)
 ;Secondary Menus
"RTN","XUSTERM",49,0)
 S DIK="^VA(200,XUDA,203,",DA(1)=XUDA F XUI=0:0 S XUI=$O(^VA(200,XUDA,203,XUI)) Q:XUI'>0  S DA=XUI D ^DIK
"RTN","XUSTERM",50,0)
 S DA=0,DA(1)=XUDA D D2^XUFILE1 ;Remove all access to files.
"RTN","XUSTERM",51,0)
ACT2 ;XUACT(5) All Mail access,  Mail groups
"RTN","XUSTERM",52,0)
 I XUACT(5)="y" F XUI=0:0 S XUI=$O(XUGRP(XUI)) Q:XUI=""  F XUJ=0:0 S XUJ=$O(^XMB(3.8,"AB",XUDA,XUI,XUJ)) Q:XUJ'>0  S DA=XUJ,DA(1)=XUI,DIK="^XMB(3.8,XUI,1," D ^DIK W:XUVE "..."
"RTN","XUSTERM",53,0)
 ; Personal Mail Groups
"RTN","XUSTERM",54,0)
 I XUACT(5)="y" F XUI=0:0 S XUI=$O(^XMB(3.8,XUI)) Q:XUI'>0  I $P(^(XUI,0),U,6)=1,$D(^(3))#2,^(3)=XUDA S DA=XUI,DIK="^XMB(3.8," D ^DIK W:XUVE "..."
"RTN","XUSTERM",55,0)
 ;Allways remove as authorized sender
"RTN","XUSTERM",56,0)
 S XUGP=0 F I=1:1 S XUGP=$O(^XMB(3.8,XUGP)) Q:+XUGP'=XUGP  S DIC="^XMB(3.8,"_XUGP_",4,",DA=$O(@(DIC_"""B"",XUDA,0)")) I +DA>0 S DIK=DIC,DA(1)=XUGP D ^DIK W:XUVE "..."
"RTN","XUSTERM",57,0)
 ;Remove as mail surrogate
"RTN","XUSTERM",58,0)
 F XUDB=0:0 S XUDB=$O(^XMB(3.7,"AB",XUDA,XUDB)) Q:XUDB'>0  S DA=$O(^XMB(3.7,"AB",XUDA,XUDB,0)),%=$D(^XMB(3.7,XUDB,9,DA,0)) K:%=0 ^XMB(3.7,"AB",XUDA,XUDB) I % S DA(1)=XUDB,DIK="^XMB(3.7,XUDB,9," D ^DIK
"RTN","XUSTERM",59,0)
 ;Mail basket
"RTN","XUSTERM",60,0)
 I XUACT(5)="y",$D(^XMB(3.7,XUDA,0)) W:XUVE "..." S DIK="^XMB(3.7,",DA=XUDA D ^DIK K DIK
"RTN","XUSTERM",61,0)
 ;Remove latered messages
"RTN","XUSTERM",62,0)
 I XUACT(5)="y" S DA=0 F  S DA=$O(^XMB(3.73,"C",XUDA,DA)) Q:DA'>0  S DIK="^XMB(3.73," D ^DIK K DIK
"RTN","XUSTERM",63,0)
 K ^XMB(3.7,"AB",XUDA) K:XUACT(5)="y" ^XMB(3.8,"AB",XUDA) ;Clean up X-refs
"RTN","XUSTERM",64,0)
 W:XUVE "... DONE" Q
"RTN","XUSTERM",65,0)
END K C,D,D0,DI,DR,DIC,DIE,DA,DIR,XUEMP,XUDA,XUI,XUJ,XUK,XUACT,XUKEY,XUGRP,XUSUR,XUNAM,XUF,XUDT,XUIN,DIC,XUDB,XUDC,XUDP,XUGP,XUNUM,XUVE,Y
"RTN","XUSTERM",66,0)
 K XUTX1,XUTX2
"RTN","XUSTERM",67,0)
 Q
"RTN","ZTER")
0^3^B28413046
"RTN","ZTER",1,0)
%ZTER ; ISC-SF.SEA/JLI - ERROR TRAP TO LOG ERRORS ;02/04/98  09:36
"RTN","ZTER",2,0)
 ;;8.0;KERNEL;**8,18,32,24,36,63,73**;JUL 10, 1995
"RTN","ZTER",3,0)
 I $ZE["-ALLOC,"!($ZE["<STORE>") D @$S('$D(^%ZOSF("OS")):"^%ET",^("OS")["DTM":"^%errlog",1:"^%ET") D H^XUS
"RTN","ZTER",4,0)
 S %ZTERZE=$ZE,%ZT("^XUTL(""XQ"",$J)")="" S:'$D(%ZTERLGR) %ZTERLGR=$$LGR^%ZOSV()
"RTN","ZTER",5,0)
 G:$$SCREEN($ZE) EXIT ;Let site screen errors
"RTN","ZTER",6,0)
 S %ZTER11N=$P($G(^%ZTER(1,+$H,0)),"^",2)+1,^%ZTER(1,+$H,0)=(+$H)_"^"_%ZTER11N,^(1,0)="^3.0751^"_%ZTER11N_"^"_%ZTER11N
"RTN","ZTER",7,0)
 S ^%ZTER(1,+$H,1,%ZTER11N,0)=%ZTER11N,^("ZE")=%ZTERZE S:$D(%ZTERLGR) ^("GR")=%ZTERLGR K %ZTERLGR I %ZTER11N=1 S ^%ZTER(1,0)=$P(^%ZTER(1,0),"^",1,2)_"^"_(+$H)_"^"_($P(^%ZTER(1,0),"^",4)+1)
"RTN","ZTER",8,0)
 S %ZTER11B="" F %ZTER11I=1:1:$L($ZB) S %ZTER11A=$E($ZB,%ZTER11I),%ZTER11B=%ZTER11B_$S(%ZTER11A?1C:$C($A(%ZTER11A)+32#128),1:%ZTER11A)
"RTN","ZTER",9,0)
 S %ZTER11I="" I $D(^%ZOSF("UCI")) K %ZTER11A S:$D(Y) %ZTER11A="" S:($D(Y)#2) %ZTER11A=Y X ^%ZOSF("UCI") S %ZTER11I=Y K:'$D(%ZTER11A) Y S:$D(%ZTER11A) Y=%ZTER11A
"RTN","ZTER",10,0)
 S ^%ZTER(1,+$H,1,%ZTER11N,"H")=$H,^("J")=$J_"^^^"_%ZTER11I_"^"_$J,^("I")=$I_"^"_$S($I[":":$ZA,1:"")_"^"_%ZTER11B_"^"_$S($D(IO("ZIO")):IO("ZIO"),1:"")
"RTN","ZTER",11,0)
 S %ZTERROR=$S($ZE["%DSM-E":$P($P($ZE,"%DSM-E-",2),","),1:$P($P($ZE,"<",2),">"))
"RTN","ZTER",12,0)
 S %ZTER11C=0 I $$NEWERR() D STACK^%ZTER1
"RTN","ZTER",13,0)
 I ^%ZOSF("OS")["VAX DSM" K %ZTER11A,%ZTER11B D VXD^%ZTER1 I 1
"RTN","ZTER",14,0)
 E  S %ZTERVAR="%" D:$D(%) VAR:$D(%)#2,SUBS:$D(%)>9 F %ZTER11Z=0:0 S %ZTERVAR=$O(@%ZTERVAR) Q:%ZTERVAR=""  D VAR:$D(@%ZTERVAR)#2,SUBS:$D(@%ZTERVAR)>9
"RTN","ZTER",15,0)
 D GLOB S:%ZTER11C>0 ^%ZTER(1,+$H,1,%ZTER11N,"ZV",0)="^3.0752^"_%ZTER11C_"^"_%ZTER11C S:'$D(^%ZTER(1,"B",+$H)) ^(+$H,+$H)="" S ^%ZTER(1,+$H,1,"B",%ZTER11N,%ZTER11N)=""
"RTN","ZTER",16,0)
LIN ;
"RTN","ZTER",17,0)
 S %ZTY=$P($ZE,","),%ZTX=$P(%ZTY,"^") S:%ZTX[">" %ZTX=$P(%ZTX,">",2)
"RTN","ZTER",18,0)
 I %ZTX'="" S X=$P($P(%ZTY,"^",2),":") I X'="" X ^%ZOSF("TEST") I $T D
"RTN","ZTER",19,0)
 .S XCNP=0,DIF="^TMP($J,""XTER1""," X ^%ZOSF("LOAD") S %ZTY=$P(%ZTX,"+",1) D
"RTN","ZTER",20,0)
 ..I %ZTY'="" F X=0:0 S X=$O(^TMP($J,"XTER1",X)) Q:X'>0  I $P(^(X,0)," ")=%ZTY S X=X+$P(%ZTX,"+",2),%ZTZLIN=^TMP($J,"XTER1",X,0) Q
"RTN","ZTER",21,0)
 ..I %ZTY="" S X=+$P(%ZTX,"+",2) Q:X'>0  S %ZTZLIN=^TMP($J,"XTER1",X,0)
"RTN","ZTER",22,0)
 K ^TMP($J,"XTER1"),XCNP,DIF,%ZTY,%ZTX,X,Y
"RTN","ZTER",23,0)
 S:$D(%ZTZLIN) ^%ZTER(1,+$H,1,%ZTER11N,"LINE")=%ZTZLIN K %ZTZLIN
"RTN","ZTER",24,0)
 I %ZTERROR'="",$D(^%ZTER(2,"B",%ZTERROR)) S %ZTERROR=%ZTERROR_"^"_$P(^%ZTER(2,+$O(^(%ZTERROR,0)),0),"^",2)
"RTN","ZTER",25,0)
EXIT K %ZTER11A,%ZTER11B,%ZTER11C,%ZTER11S,%ZTER11Z,%ZTERVAP,%ZTERVAR,%ZTERSUB,%ZTER11I,%ZTER11D,%ZTER11L,%ZTER11Q,%,%ZTER111,%ZTER112,%H,%ZTER11N
"RTN","ZTER",26,0)
 S:$$NEWERR $EC=""
"RTN","ZTER",27,0)
 Q
"RTN","ZTER",28,0)
 ;
"RTN","ZTER",29,0)
VAR I ",%ZTERVAR,%ZTER11Z,%ZTER11A,%ZTER11B,%ZTER11C,%ZTER11N,%ZTER11I,%ZTER11L,%ZTER11S,%ZTERVAP,%ZTERSUB,"'[(","_%ZTERVAR_",") S %ZTER11C=%ZTER11C+1,^%ZTER(1,+$H,1,%ZTER11N,"ZV",%ZTER11C,0)=%ZTERVAR D
"RTN","ZTER",30,0)
 . I $L(@%ZTERVAR)'>255 S ^%ZTER(1,+$H,1,%ZTER11N,"ZV",%ZTER11C,"D")=@%ZTERVAR Q
"RTN","ZTER",31,0)
 . S ^%ZTER(1,+$H,1,%ZTER11N,"ZV",%ZTER11C,"D")=" **** VALUE IS GREATER THAN 255 CHARACTERS (SEE SUBNODES FOR DATA) *** "
"RTN","ZTER",32,0)
 . N %ZTER11,%ZTER12
"RTN","ZTER",33,0)
 . F %ZTER11=1:1 S %ZTER12=$E(@%ZTERVAR,1,245) Q:%ZTER12=""  S @%ZTERVAR=$E(@%ZTERVAR,246,$L(@%ZTERVAR)),^%ZTER(1,+$H,1,%ZTER11N,"ZV",%ZTER11C,"D",%ZTER11)=%ZTER12
"RTN","ZTER",34,0)
 . Q
"RTN","ZTER",35,0)
 Q
"RTN","ZTER",36,0)
 ;
"RTN","ZTER",37,0)
SUBS S %ZTER11S="" Q:"%ZT("=$E(%ZTERVAR,1,4)  Q:",%ZTER11S,%ZTER11L,"[(","_%ZTERVAR_",")  S %ZTERVAP=%ZTERVAR_"(",%ZTERSUB="%ZTER11S)"
"RTN","ZTER",38,0)
 ;
"RTN","ZTER",39,0)
DESC S %ZTER11I=%ZTER11I+1,%ZTER11S(%ZTER11I)=%ZTER11S,%ZTER11S="",%ZTER11L(%ZTER11I)=$L(%ZTERSUB)-9 F %ZTER11Z=0:0 S %ZTER11S=$O(@(%ZTERVAP_%ZTERSUB)) Q:%ZTER11S=""  D SUBX
"RTN","ZTER",40,0)
 S %ZTER11S=%ZTER11S(%ZTER11I) K %ZTER11S(%ZTER11I),%ZTER11L(%ZTER11I) S %ZTER11I=%ZTER11I-1
"RTN","ZTER",41,0)
 Q
"RTN","ZTER",42,0)
 ;
"RTN","ZTER",43,0)
SUBX I $D(@(%ZTERVAP_%ZTERSUB))#10 S %ZTER11C=%ZTER11C+1,^%ZTER(1,+$H,1,%ZTER11N,"ZV",%ZTER11C,0)=$P(%ZTERVAP_%ZTERSUB,"%ZTER11S",1)_""""_%ZTER11S_""""_$P(%ZTERVAP_%ZTERSUB,"%ZTER11S",2),^("D")=@(%ZTERVAP_%ZTERSUB)
"RTN","ZTER",44,0)
 I $D(@(%ZTERVAP_%ZTERSUB))\10 S %ZTERSUB=$E(%ZTERSUB,1,%ZTER11L(%ZTER11I))_""""_%ZTER11S_""""_",%ZTER11S)" D DESC S %ZTERSUB=$E(%ZTERSUB,1,%ZTER11L(%ZTER11I))_"%ZTER11S)"
"RTN","ZTER",45,0)
 Q
"RTN","ZTER",46,0)
 ;
"RTN","ZTER",47,0)
GLOB ;
"RTN","ZTER",48,0)
 S %ZTER11D="" F %ZTER11I=0:0 S %ZTER11D=$O(%ZT(%ZTER11D)) Q:%ZTER11D=""  S %ZTER11A=%ZTER11D S:%ZTER11A["$J" %ZTER11B=$J,%ZTER11A=$P(%ZTER11A,"$J",1)_%ZTER11B_$P(%ZTER11A,"$J",2,99) S %ZTER11B=$P(%ZTER11A,")",1) D LOOP
"RTN","ZTER",49,0)
 Q
"RTN","ZTER",50,0)
 ;
"RTN","ZTER",51,0)
LOOP ;
"RTN","ZTER",52,0)
 F %ZTER11I=0:0 S %ZTER11A=$ZO(@%ZTER11A) Q:%ZTER11A'[%ZTER11B  S %ZTER11C=%ZTER11C+1,^%ZTER(1,+$H,1,%ZTER11N,"ZV",%ZTER11C,0)=$P(%ZTER11D,")")_$P(%ZTER11A,%ZTER11B,2),^%ZTER(1,+$H,1,%ZTER11N,"ZV",%ZTER11C,"D")=@%ZTER11A
"RTN","ZTER",53,0)
 Q
"RTN","ZTER",54,0)
 ;
"RTN","ZTER",55,0)
SCREEN(ERR) ;Screen out certain errors.
"RTN","ZTER",56,0)
 N %ZTE,%ZTI S:'$D(ERR) ERR=$$EC^%ZOSV
"RTN","ZTER",57,0)
 S %ZTE="",%ZTI=0 F  S %ZTI=$O(^%ZTER(2,"AC",2,%ZTI)) Q:%ZTI=""  S %ZTE=$S($D(^%ZTER(2,%ZTI,2)):^(2),1:$P(^(0),"^")) Q:ERR[%ZTE
"RTN","ZTER",58,0)
 I %ZTI>0 D  Q 1 ;Skip the recording of the error.
"RTN","ZTER",59,0)
 . I $P(^%ZTER(2,%ZTI,0),U,4) L +^%ZTER(2,%ZTI) S ^(3)=$G(^%ZTER(2,%ZTI,3))+1 L -^%ZTER(2,%ZTI)
"RTN","ZTER",60,0)
 . Q
"RTN","ZTER",61,0)
 Q 0 ;record error
"RTN","ZTER",62,0)
 ;
"RTN","ZTER",63,0)
UNWIND ;Unwind stack for new error trap. Called by app code.
"RTN","ZTER",64,0)
 Q:'$$NEWERR()
"RTN","ZTER",65,0)
 S $ECODE="" S $ETRAP="D UNW^%ZTER Q" S $ECODE=",U1,"
"RTN","ZTER",66,0)
UNW Q:$ESTACK>1  S $ECODE="" Q:'$QUIT  Q 0
"RTN","ZTER",67,0)
 ;
"RTN","ZTER",68,0)
NEWERR() ;Does this OS support the M95 error trapping
"RTN","ZTER",69,0)
 N % S %=$G(^%ZOSF("OS")) Q:%="" 0
"RTN","ZTER",70,0)
 I %["VAX DSM" Q 1
"RTN","ZTER",71,0)
 I %["MSM",$P($ZV,"Version ",2)'<4.3 Q 1
"RTN","ZTER",72,0)
 I %["OpenM" Q 1 ;For version >7.0 or NexGen or Cache
"RTN","ZTER",73,0)
 Q 0
"RTN","ZTER",74,0)
ABORT ;Pop the stack all the way.
"RTN","ZTER",75,0)
 S $ETRAP="Q:$ST>1  S $ECODE="""" Q"
"RTN","ZTER",76,0)
 Q
"VER")
8.0^21.0
"^DD",8992.1,8992.1,.08,0)
RETENTION DATE^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",8992.1,8992.1,.08,21,0)
^^3^3^2980209^
"^DD",8992.1,8992.1,.08,21,1,0)
This field is used to set a retention date that will prevent the 
"^DD",8992.1,8992.1,.08,21,2,0)
deletion of the alert by the "Delete old (>14 day) Alerts" option
"^DD",8992.1,8992.1,.08,21,3,0)
until this date.
"^DD",8992.1,8992.1,.08,"DT")
2980209
**END**
**END**
