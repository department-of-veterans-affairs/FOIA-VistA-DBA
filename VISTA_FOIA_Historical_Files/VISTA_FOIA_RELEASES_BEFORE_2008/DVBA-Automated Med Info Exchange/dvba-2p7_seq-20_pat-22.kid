Released DVBA*2.7*22 SEQ #20
Extracted from mail message
**KIDS**:DVBA*2.7*22^

**INSTALL NAME**
DVBA*2.7*22
"BLD",912,0)
DVBA*2.7*22^AUTOMATED MED INFO EXCHANGE^0^2980522^y
"BLD",912,1,0)
^^1^1^2980522^
"BLD",912,1,1,0)
Maintain integrity of file #396.4.
"BLD",912,4,0)
^9.64PA^^
"BLD",912,"KRN",0)
^9.67PA^19^18
"BLD",912,"KRN",.4,0)
.4
"BLD",912,"KRN",.401,0)
.401
"BLD",912,"KRN",.402,0)
.402
"BLD",912,"KRN",.403,0)
.403
"BLD",912,"KRN",.5,0)
.5
"BLD",912,"KRN",.84,0)
.84
"BLD",912,"KRN",3.6,0)
3.6
"BLD",912,"KRN",3.8,0)
3.8
"BLD",912,"KRN",9.2,0)
9.2
"BLD",912,"KRN",9.8,0)
9.8
"BLD",912,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",912,"KRN",9.8,"NM",1,0)
DVBCEEXM^^0^B14074952
"BLD",912,"KRN",9.8,"NM","B","DVBCEEXM",1)

"BLD",912,"KRN",19,0)
19
"BLD",912,"KRN",19.1,0)
19.1
"BLD",912,"KRN",101,0)
101
"BLD",912,"KRN",409.61,0)
409.61
"BLD",912,"KRN",771,0)
771
"BLD",912,"KRN",869.2,0)
869.2
"BLD",912,"KRN",870,0)
870
"BLD",912,"KRN",8994,0)
8994
"BLD",912,"KRN","B",.4,.4)

"BLD",912,"KRN","B",.401,.401)

"BLD",912,"KRN","B",.402,.402)

"BLD",912,"KRN","B",.403,.403)

"BLD",912,"KRN","B",.5,.5)

"BLD",912,"KRN","B",.84,.84)

"BLD",912,"KRN","B",3.6,3.6)

"BLD",912,"KRN","B",3.8,3.8)

"BLD",912,"KRN","B",9.2,9.2)

"BLD",912,"KRN","B",9.8,9.8)

"BLD",912,"KRN","B",19,19)

"BLD",912,"KRN","B",19.1,19.1)

"BLD",912,"KRN","B",101,101)

"BLD",912,"KRN","B",409.61,409.61)

"BLD",912,"KRN","B",771,771)

"BLD",912,"KRN","B",869.2,869.2)

"BLD",912,"KRN","B",870,870)

"BLD",912,"KRN","B",8994,8994)

"BLD",912,"QUES",0)
^9.62^^
"BLD",912,"REQB",0)
^9.611^^
"OER",223,0)
223^DVBA
"OER",223,1,0)
^100.9951PA^5^5
"OER",223,1,1,0)
634
"OER",223,1,1,1,0)
^100.99511PA^1^1
"OER",223,1,1,1,1,0)
1106
"OER",223,1,2,0)
635
"OER",223,1,2,1,0)
^100.99511PA^1^1
"OER",223,1,2,1,1,0)
1106
"OER",223,1,3,0)
644
"OER",223,1,3,1,0)
^100.99511PA^1^1
"OER",223,1,3,1,1,0)
1106
"OER",223,1,4,0)
642
"OER",223,1,4,1,0)
^100.99511PA^2^2
"OER",223,1,4,1,1,0)
1106
"OER",223,1,4,1,2,0)
1303
"OER",223,1,5,0)
1305
"OER",223,1,5,1,0)
^100.99511PA^1^1
"OER",223,1,5,1,1,0)
414
"PKG",223,-1)
1^1
"PKG",223,0)
AUTOMATED MED INFO EXCHANGE^DVBA^The entire AMIE package 7131/2507.
"PKG",223,22,0)
^9.49I^1^1
"PKG",223,22,1,0)
2.7^2950410^2950508
"PKG",223,22,1,"PAH",1,0)
22^2980522
"PKG",223,22,1,"PAH",1,1,0)
^^1^1^2980522
"PKG",223,22,1,"PAH",1,1,1,0)
Maintain integrity of file #396.4.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DVBCEEXM")
0^1^B14074952
"RTN","DVBCEEXM",1,0)
DVBCEEXM ;ALB/GTS-557/THM-COMPILE EXISTING 2507 EXAMS ; 5/24/91  7:07 AM
"RTN","DVBCEEXM",2,0)
 ;;2.7;AMIE;**22**;Apr 10, 1995
"RTN","DVBCEEXM",3,0)
 ;
"RTN","DVBCEEXM",4,0)
EN ;only need DFN to return data
"RTN","DVBCEEXM",5,0)
 I '$D(^DVB(396.4,"APE",DFN)) W !!,"No Requests are currently on file." Q
"RTN","DVBCEEXM",6,0)
 ;;;I '$D(^DVB(396.4,"APE",DFN)) W !!,"Press [RETURN] to continue"
"RTN","DVBCEEXM",7,0)
 ;;;I '$D(^DVB(396.4,"APE",DFN)) R DVBCIN:DTIME K DVBCIN Q
"RTN","DVBCEEXM",8,0)
 W "Requested exams currently on file:",!!
"RTN","DVBCEEXM",9,0)
 D SORT
"RTN","DVBCEEXM",10,0)
 F JX=1:1:80 W "-"
"RTN","DVBCEEXM",11,0)
 K DVBAEXM,DVBAEXST,DVBADA,DVBADONE,DVBAPDT,DVBAST,DVBARO,JX,DVBCX
"RTN","DVBCEEXM",12,0)
 Q
"RTN","DVBCEEXM",13,0)
 ;
"RTN","DVBCEEXM",14,0)
STAT S DVBAST=$P(^DVB(396.4,DVBADA,0),U,4)
"RTN","DVBCEEXM",15,0)
 S:$D(^DVB(396.4,DVBADA,"TRAN")) DVBCX=$P(^("TRAN"),U,3)
"RTN","DVBCEEXM",16,0)
 S DVBAST=$S(DVBAST="C":"Completed",DVBAST="RX":"Cancelled by RO",DVBAST="X":"Cancelled by MAS",DVBAST="F":"Cancelled, failed to report",DVBAST="O":"Open",DVBAST="T":"Transferred",1:"Unknown status")
"RTN","DVBCEEXM",17,0)
 Q
"RTN","DVBCEEXM",18,0)
 ;
"RTN","DVBCEEXM",19,0)
CON I $Y>12,IOST?1"C-".E W !!,"Press [RETURN] to continue or ""^"" to end display of existing exams" R ANS:DTIME W ! I '$T!(ANS=U) S DVBADONE=1
"RTN","DVBCEEXM",20,0)
 I $Y>12,IOST?1"C-".E W:(DVBADONE'=1) @IOF,"Exams currently on file, continued --",!!!
"RTN","DVBCEEXM",21,0)
 I ($Y>45),(IOST?1"P-".E) D HDR
"RTN","DVBCEEXM",22,0)
 Q
"RTN","DVBCEEXM",23,0)
 ;
"RTN","DVBCEEXM",24,0)
HDR S PG=PG+1
"RTN","DVBCEEXM",25,0)
 W @IOF,!,"Date: ",FDT(0),?(80-$L(PGHD)\2),PGHD,?71,"Page: ",PG,!,?(80-$L($$SITE^DVBCUTL4)\2),$$SITE^DVBCUTL4 I PG>1 W !!,"Name: ",PNAM,?44,"SSN: ",SSN,?63,"C-NUM: ",CNUM
"RTN","DVBCEEXM",26,0)
 W ! F XLINE=1:1:80 W "="
"RTN","DVBCEEXM",27,0)
 W !!,"Requested exams currently on file:",!
"RTN","DVBCEEXM",28,0)
 W ! Q
"RTN","DVBCEEXM",29,0)
 ;
"RTN","DVBCEEXM",30,0)
SORT ;  ** Explore 396.4 file; display exams already requested **
"RTN","DVBCEEXM",31,0)
 N DVBAEXM,DVBADA,DVBADONE,DVBAPDT,DVBAST,DVBARO,DVBARQDT
"RTN","DVBCEEXM",32,0)
 S (DVBAEXM,DVBADA,DVBADONE,DVBAPDT,DVBAST,DVBARO,DVBARQDT)=""
"RTN","DVBCEEXM",33,0)
 F  S DVBAEXM=$O(^DVB(396.4,"APE",DFN,DVBAEXM)) Q:DVBAEXM=""!(DVBADONE=1)  F  S DVBARQDT=$O(^DVB(396.4,"APE",DFN,DVBAEXM,DVBARQDT)) Q:DVBARQDT=""  D FLOOP Q:DVBADONE=1
"RTN","DVBCEEXM",34,0)
 Q
"RTN","DVBCEEXM",35,0)
 ;
"RTN","DVBCEEXM",36,0)
FLOOP ;  **  Final loop of "APE" index **
"RTN","DVBCEEXM",37,0)
 F  S DVBADA=$O(^DVB(396.4,"APE",DFN,DVBAEXM,DVBARQDT,DVBADA)) Q:DVBADA=""  D BLD,CON Q:DVBADONE=1  D PRINT
"RTN","DVBCEEXM",38,0)
 Q
"RTN","DVBCEEXM",39,0)
 ;
"RTN","DVBCEEXM",40,0)
BLD ;  ** Set variables to be printed to screen **
"RTN","DVBCEEXM",41,0)
 N DA,DIK,DATA,DVBAREQ,DVBASTAT,DVBATYPE
"RTN","DVBCEEXM",42,0)
 ;don't continue if record doesn't exist in file #396.4
"RTN","DVBCEEXM",43,0)
 I '$D(^DVB(396.4,DVBADA,0)) D  Q
"RTN","DVBCEEXM",44,0)
 .;kill xref if record doesn't exist
"RTN","DVBCEEXM",45,0)
 .K ^DVB(396.4,"APE",DFN,DVBAEXM,DVBARQDT,DVBADA)
"RTN","DVBCEEXM",46,0)
 ;don't continue if record doesn't exist in file #396.3
"RTN","DVBCEEXM",47,0)
 S DVBAREQ=$P(^DVB(396.4,DVBADA,0),U,2) D  Q:'DVBAREQ
"RTN","DVBCEEXM",48,0)
 .I '$D(^DVB(396.3,DVBAREQ)) D
"RTN","DVBCEEXM",49,0)
 ..;delete record in file #396.4 if its 'parent' in file #396.3 doesn't exist
"RTN","DVBCEEXM",50,0)
 ..;remove reference to file #396.3 so call to ^dik won't error out
"RTN","DVBCEEXM",51,0)
 ..S DATA=^DVB(396.4,DVBADA,0),$P(^(0),U,2)=""
"RTN","DVBCEEXM",52,0)
 ..;delete "c" xref and mumps xrefs manually because reference to file #396.3 was removed
"RTN","DVBCEEXM",53,0)
 ..S DVBATYPE=$P(DATA,U,3),DVBASTAT=$P(DATA,U,4)
"RTN","DVBCEEXM",54,0)
 ..K ^DVB(396.4,"C",DVBAREQ,DVBADA)
"RTN","DVBCEEXM",55,0)
 ..K ^DVB(396.4,"APE",DFN,DVBAEXM,DVBARQDT,DVBADA)
"RTN","DVBCEEXM",56,0)
 ..K ^DVB(396.4,"APS",DFN,DVBATYPE,DVBASTAT,DVBADA)
"RTN","DVBCEEXM",57,0)
 ..K ^DVB(396.4,"ARQ"_DVBAREQ,DVBATYPE,DVBADA)
"RTN","DVBCEEXM",58,0)
 ..;proceed with fm delete
"RTN","DVBCEEXM",59,0)
 ..S DIK="^DVB(396.4,",DA=DVBADA D ^DIK
"RTN","DVBCEEXM",60,0)
 ..S DVBAREQ=0
"RTN","DVBCEEXM",61,0)
 S Y=DVBARQDT X ^DD("DD") S DVBAPDT=Y
"RTN","DVBCEEXM",62,0)
 S DVBARO=$P(^DVB(396.3,DVBAREQ,0),U,3)
"RTN","DVBCEEXM",63,0)
 S DVBARO=$S($D(^DIC(4,+DVBARO,0)):$P(^(0),U,1),1:"Unknown RO")
"RTN","DVBCEEXM",64,0)
 D STAT
"RTN","DVBCEEXM",65,0)
 Q
"RTN","DVBCEEXM",66,0)
 ;
"RTN","DVBCEEXM",67,0)
PRINT ;  **  Print an entry from list of requested exams **
"RTN","DVBCEEXM",68,0)
 W DVBAEXM,!,"Requested on ",DVBAPDT," by ",DVBARO," - ",DVBAST,!!
"RTN","DVBCEEXM",69,0)
 Q
"VER")
8.0^21.0
**END**
**END**
