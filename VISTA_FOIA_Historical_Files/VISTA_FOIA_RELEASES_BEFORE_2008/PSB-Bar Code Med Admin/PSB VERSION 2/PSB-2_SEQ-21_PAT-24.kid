Released PSB*2*24 SEQ #21
Extracted from mail message
**KIDS**:PSB*2.0*24^

**INSTALL NAME**
PSB*2.0*24
"BLD",4211,0)
PSB*2.0*24^BAR CODE MED ADMIN^0^3030618^y
"BLD",4211,1,0)
^^45^45^3030603^^
"BLD",4211,1,1,0)
1. Bar Code Medication Administration (BCMA) will provide a visual
"BLD",4211,1,2,0)
indicator on the Virtual Due List (VDL) to identify which schedule types
"BLD",4211,1,3,0)
have active orders within the specified start and stop date/time for the
"BLD",4211,1,4,0)
selected Medication Tab. A green "alert light" to the left of the
"BLD",4211,1,5,0)
Schedule Type indicates that it has active orders for the specified
"BLD",4211,1,6,0)
timeframe, and a gray "alert light" to the left of the Schedule Type
"BLD",4211,1,7,0)
indicates that it has no active orders for the specified timeframe.
"BLD",4211,1,8,0)
 
"BLD",4211,1,9,0)
2. PRN medications will display on the VDL if the PRN Schedule Types
"BLD",4211,1,10,0)
check box is selected in the GUI BCMA Site Parameters application. All
"BLD",4211,1,11,0)
other schedule types will remain selected on the VDL by default when the
"BLD",4211,1,12,0)
user opens a patient's record.
"BLD",4211,1,13,0)
 
"BLD",4211,1,14,0)
3. The VDL will display a BCMA Clinical Reminders marquee at the lower
"BLD",4211,1,15,0)
right hand corner. The "count" is the number of PRN medications
"BLD",4211,1,16,0)
without Effectiveness comments within the hours defined in the
"BLD",4211,1,17,0)
"PRN Documentation" field on the Parameters tab of the GUI BCMA Site
"BLD",4211,1,18,0)
Parameters application or within the current admission whichever is 
"BLD",4211,1,19,0)
greater.
"BLD",4211,1,20,0)
A mouse-over list displays the last four undocumented PRN orders.
"BLD",4211,1,21,0)
When the user double clicks anywhere on the PRN Effectiveness row of
"BLD",4211,1,22,0)
the BCMA Clinical Reminders marquee, the PRN Effectiveness Log dialog box
"BLD",4211,1,23,0)
displays all PRN orders that need PRN Effectiveness and allowing
"BLD",4211,1,24,0)
documentation of PRN Effectiveness comments for each order listed.
"BLD",4211,1,25,0)
 
"BLD",4211,1,26,0)
The "count" will update/refresh when the user:
"BLD",4211,1,27,0)
a) opens a patient file.
"BLD",4211,1,28,0)
b) administers a PRN medication order.
"BLD",4211,1,29,0)
c) completes the documentation of a PRN Effectiveness.
"BLD",4211,1,30,0)
d) refreshes the VDL.
"BLD",4211,1,31,0)
 
"BLD",4211,1,32,0)
A Med History button has been added to display the Medication
"BLD",4211,1,33,0)
Administration History for the order selected.
"BLD",4211,1,34,0)
 
"BLD",4211,1,35,0)
4. When administering a PRN medication, the units given column
"BLD",4211,1,36,0)
within the Last Four Actions table and a drop down box for the users to
"BLD",4211,1,37,0)
select the PRN Reason have been added to the Medication Log dialog box.
"BLD",4211,1,38,0)
Units given will not display for orders with multiple dispensed drugs.
"BLD",4211,1,39,0)
 
"BLD",4211,1,40,0)
5. An updated PRN Effectiveness Log dialog will ease the process of
"BLD",4211,1,41,0)
PRN Effectiveness documentation. It displays a list of undocumented PRN
"BLD",4211,1,42,0)
medications for a specific order, or across orders, including PRN 
"BLD",4211,1,43,0)
medications from previous or expired orders. The dialog box
"BLD",4211,1,44,0)
includes a "units given" column, which will not display units for orders
"BLD",4211,1,45,0)
with multiple dispensed drugs. The division column has been removed.
"BLD",4211,4,0)
^9.64PA^^0
"BLD",4211,"ABPKG")
n
"BLD",4211,"INID")
n^y^n
"BLD",4211,"INIT")
PSBPAR1
"BLD",4211,"KRN",0)
^9.67PA^8989.52^19
"BLD",4211,"KRN",.4,0)
.4
"BLD",4211,"KRN",.401,0)
.401
"BLD",4211,"KRN",.402,0)
.402
"BLD",4211,"KRN",.403,0)
.403
"BLD",4211,"KRN",.403,"NM",0)
^9.68A^^0
"BLD",4211,"KRN",.5,0)
.5
"BLD",4211,"KRN",.84,0)
.84
"BLD",4211,"KRN",3.6,0)
3.6
"BLD",4211,"KRN",3.8,0)
3.8
"BLD",4211,"KRN",9.2,0)
9.2
"BLD",4211,"KRN",9.8,0)
9.8
"BLD",4211,"KRN",9.8,"NM",0)
^9.68A^7^5
"BLD",4211,"KRN",9.8,"NM",2,0)
PSBOHDR^^0^B15108436
"BLD",4211,"KRN",9.8,"NM",3,0)
PSBOML^^0^B32021267
"BLD",4211,"KRN",9.8,"NM",4,0)
PSBPRN^^0^B19400750
"BLD",4211,"KRN",9.8,"NM",5,0)
PSBRPC3^^0^B300186
"BLD",4211,"KRN",9.8,"NM",7,0)
PSBVDLVL^^0^B53235495
"BLD",4211,"KRN",9.8,"NM","B","PSBOHDR",2)

"BLD",4211,"KRN",9.8,"NM","B","PSBOML",3)

"BLD",4211,"KRN",9.8,"NM","B","PSBPRN",4)

"BLD",4211,"KRN",9.8,"NM","B","PSBRPC3",5)

"BLD",4211,"KRN",9.8,"NM","B","PSBVDLVL",7)

"BLD",4211,"KRN",19,0)
19
"BLD",4211,"KRN",19,"NM",0)
^9.68A^^
"BLD",4211,"KRN",19.1,0)
19.1
"BLD",4211,"KRN",101,0)
101
"BLD",4211,"KRN",101,"NM",0)
^9.68A^^
"BLD",4211,"KRN",409.61,0)
409.61
"BLD",4211,"KRN",771,0)
771
"BLD",4211,"KRN",771,"NM",0)
^9.68A^^0
"BLD",4211,"KRN",870,0)
870
"BLD",4211,"KRN",870,"NM",0)
^9.68A^^0
"BLD",4211,"KRN",8989.51,0)
8989.51
"BLD",4211,"KRN",8989.51,"NM",0)
^9.68A^5^5
"BLD",4211,"KRN",8989.51,"NM",1,0)
PSB PRN DOCUMENTATION^^0
"BLD",4211,"KRN",8989.51,"NM",2,0)
PSB VDL INCL ON-CALL^^0
"BLD",4211,"KRN",8989.51,"NM",3,0)
PSB VDL INCL ONE-TIME^^0
"BLD",4211,"KRN",8989.51,"NM",4,0)
PSB VDL INCL PRN^^0
"BLD",4211,"KRN",8989.51,"NM",5,0)
PSB VDL INCL CONT^^0
"BLD",4211,"KRN",8989.51,"NM","B","PSB PRN DOCUMENTATION",1)

"BLD",4211,"KRN",8989.51,"NM","B","PSB VDL INCL CONT",5)

"BLD",4211,"KRN",8989.51,"NM","B","PSB VDL INCL ON-CALL",2)

"BLD",4211,"KRN",8989.51,"NM","B","PSB VDL INCL ONE-TIME",3)

"BLD",4211,"KRN",8989.51,"NM","B","PSB VDL INCL PRN",4)

"BLD",4211,"KRN",8989.52,0)
8989.52
"BLD",4211,"KRN",8994,0)
8994
"BLD",4211,"KRN",8994,"NM",0)
^9.68A^2^2
"BLD",4211,"KRN",8994,"NM",1,0)
PSB GETPRNS^^0
"BLD",4211,"KRN",8994,"NM",2,0)
PSB VALIDATE ORDER^^0
"BLD",4211,"KRN",8994,"NM","B","PSB GETPRNS",1)

"BLD",4211,"KRN",8994,"NM","B","PSB VALIDATE ORDER",2)

"BLD",4211,"KRN","B",.4,.4)

"BLD",4211,"KRN","B",.401,.401)

"BLD",4211,"KRN","B",.402,.402)

"BLD",4211,"KRN","B",.403,.403)

"BLD",4211,"KRN","B",.5,.5)

"BLD",4211,"KRN","B",.84,.84)

"BLD",4211,"KRN","B",3.6,3.6)

"BLD",4211,"KRN","B",3.8,3.8)

"BLD",4211,"KRN","B",9.2,9.2)

"BLD",4211,"KRN","B",9.8,9.8)

"BLD",4211,"KRN","B",19,19)

"BLD",4211,"KRN","B",19.1,19.1)

"BLD",4211,"KRN","B",101,101)

"BLD",4211,"KRN","B",409.61,409.61)

"BLD",4211,"KRN","B",771,771)

"BLD",4211,"KRN","B",870,870)

"BLD",4211,"KRN","B",8989.51,8989.51)

"BLD",4211,"KRN","B",8989.52,8989.52)

"BLD",4211,"KRN","B",8994,8994)

"BLD",4211,"QUES",0)
^9.62^^
"BLD",4211,"REQB",0)
^9.611^2^1
"BLD",4211,"REQB",2,0)
PSB*2.0*19^2
"BLD",4211,"REQB","B","PSB*2.0*19",2)

"INIT")
PSBPAR1
"KRN",8989.51,34,-1)
0^2
"KRN",8989.51,34,0)
PSB VDL INCL ON-CALL^Include On Call Meds^0^^INCLUDE ON CALL MEDS ON DUE LIST^0
"KRN",8989.51,34,1)
Y^^Enter 'Y' to have On-Call Meds included in the initial VDL
"KRN",8989.51,34,20,0)
^8989.512^2^2^3030509^^
"KRN",8989.51,34,20,1,0)
Determines wether initial Due List View contains On Call
"KRN",8989.51,34,20,2,0)
medications.
"KRN",8989.51,34,30,0)
^8989.513I^1^1
"KRN",8989.51,34,30,1,0)
1^4
"KRN",8989.51,37,-1)
0^5
"KRN",8989.51,37,0)
PSB VDL INCL CONT^Include Continuous Meds^0^^INCLUDE CONTINUOUS MEDS ON DUE LIST^0
"KRN",8989.51,37,1)
Y^^Enter 'Y' to have Continuous Meds included in the initial VDL
"KRN",8989.51,37,20,0)
^8989.512^2^2^3030509^^
"KRN",8989.51,37,20,1,0)
Determines wheter initial Due List View contains continuous 
"KRN",8989.51,37,20,2,0)
medications.
"KRN",8989.51,37,30,0)
^8989.513I^1^1
"KRN",8989.51,37,30,1,0)
1^4
"KRN",8989.51,226,-1)
0^1
"KRN",8989.51,226,0)
PSB PRN DOCUMENTATION^PRN Documentation Timeframe^0
"KRN",8989.51,226,1)
N^1:999^Enter number of hours (1-999, 72 is default)
"KRN",8989.51,226,20,0)
^8989.512^1^1^3030401^^
"KRN",8989.51,226,20,1,0)
This will store the number of hours for the PRN Documentation Timeframe on the BCMA Site Parameters screen.
"KRN",8989.51,226,30,0)
^8989.513I^1^1
"KRN",8989.51,226,30,1,0)
1^4
"KRN",8989.51,266,-1)
0^4
"KRN",8989.51,266,0)
PSB VDL INCL PRN^Include PRN Meds^0^^INCLUDE PRN MEDS ON DUE LIST^0
"KRN",8989.51,266,1)
Y^^Enter 'Y' to have PRN Meds included in the initial VDL
"KRN",8989.51,266,20,0)
^8989.512^1^1^3030509^^^^
"KRN",8989.51,266,20,1,0)
Determines wether initial Due List View contains PRN medications.
"KRN",8989.51,266,30,0)
^8989.513I^3^1
"KRN",8989.51,266,30,3,0)
1^4
"KRN",8989.51,267,-1)
0^3
"KRN",8989.51,267,0)
PSB VDL INCL ONE-TIME^Include One-Time Meds^0^^INCLUDE ONE-TIME MEDS ON DUE LIST^0
"KRN",8989.51,267,1)
Y^^Enter 'Y' to have One-Time Meds included in the initial VDL
"KRN",8989.51,267,20,0)
^8989.512^2^2^3030509^^
"KRN",8989.51,267,20,1,0)
Determines wether initial Due List View contains One-Time
"KRN",8989.51,267,20,2,0)
medications.
"KRN",8989.51,267,30,0)
^8989.513I^1^1
"KRN",8989.51,267,30,1,0)
1^4
"KRN",8994,687,-1)
0^2
"KRN",8994,687,0)
PSB VALIDATE ORDER^EN^PSBVDLVL^2^P^^^^2
"KRN",8994,687,2,0)
^8994.02A^9^9
"KRN",8994,687,2,1,0)
DFN^1^10^1^1
"KRN",8994,687,2,1,1,0)
^8994.021^1^1^3030318^^
"KRN",8994,687,2,1,1,1,0)
Patient IEN
"KRN",8994,687,2,2,0)
PSBIEN^1^^1^2
"KRN",8994,687,2,2,1,0)
^8994.021^1^1^3030318^^
"KRN",8994,687,2,2,1,1,0)
Medication Order Number
"KRN",8994,687,2,3,0)
PSBTYPE^1^2^1^3
"KRN",8994,687,2,3,1,0)
^^4^4^3030318^
"KRN",8994,687,2,3,1,1,0)
Order Type
"KRN",8994,687,2,3,1,2,0)
 
"KRN",8994,687,2,3,1,3,0)
U for unit dose order
"KRN",8994,687,2,3,1,4,0)
V for IV order
"KRN",8994,687,2,4,0)
PSBADMIN^1^^0^4
"KRN",8994,687,2,4,1,0)
^8994.021^1^1^3030318^^
"KRN",8994,687,2,4,1,1,0)
Administration date/time, if one is present.
"KRN",8994,687,2,5,0)
PSBTAB^1^10^1^5
"KRN",8994,687,2,5,1,0)
^^1^1^3030318^
"KRN",8994,687,2,5,1,1,0)
Medication tab the order is on.
"KRN",8994,687,2,6,0)
PSBUID^1^^1^6
"KRN",8994,687,2,6,1,0)
^^1^1^3030318^
"KRN",8994,687,2,6,1,1,0)
The actual scan value.
"KRN",8994,687,2,7,0)
PSBASTS^1^^0^7
"KRN",8994,687,2,7,1,0)
^8994.021^1^1^3030318^^
"KRN",8994,687,2,7,1,1,0)
Current scan status of the VDL of the medication.
"KRN",8994,687,2,8,0)
PSBORSTS^1^^1^8
"KRN",8994,687,2,8,1,0)
^^1^1^3030318^
"KRN",8994,687,2,8,1,1,0)
Current order status on the VDL>
"KRN",8994,687,2,9,0)
PSBRMV^^^0^9
"KRN",8994,687,2,9,1,0)
^8994.021^1^1^3030507^^^^
"KRN",8994,687,2,9,1,1,0)
Action the user is trying to take.
"KRN",8994,687,2,"B","DFN",1)

"KRN",8994,687,2,"B","PSBADMIN",4)

"KRN",8994,687,2,"B","PSBASTS",7)

"KRN",8994,687,2,"B","PSBIEN",2)

"KRN",8994,687,2,"B","PSBORSTS",8)

"KRN",8994,687,2,"B","PSBRMV",9)

"KRN",8994,687,2,"B","PSBTAB",5)

"KRN",8994,687,2,"B","PSBTYPE",3)

"KRN",8994,687,2,"B","PSBUID",6)

"KRN",8994,687,2,"PARAMSEQ",1,1)

"KRN",8994,687,2,"PARAMSEQ",2,2)

"KRN",8994,687,2,"PARAMSEQ",3,3)

"KRN",8994,687,2,"PARAMSEQ",4,4)

"KRN",8994,687,2,"PARAMSEQ",5,5)

"KRN",8994,687,2,"PARAMSEQ",6,6)

"KRN",8994,687,2,"PARAMSEQ",7,7)

"KRN",8994,687,2,"PARAMSEQ",8,8)

"KRN",8994,687,2,"PARAMSEQ",9,9)

"KRN",8994,687,3,0)
^8994.03^21^21^3030507^^^^
"KRN",8994,687,3,1,0)
Results[0] = number of nodes
"KRN",8994,687,3,2,0)
 
"KRN",8994,687,3,3,0)
Results[0] = 1^Data Successfully Filed^Med Log IEN
"KRN",8994,687,3,4,0)
                       or
"KRN",8994,687,3,5,0)
               Message
"KRN",8994,687,3,6,0)
 
"KRN",8994,687,3,7,0)
            -1^Error message
"KRN",8994,687,3,8,0)
 
"KRN",8994,687,3,9,0)
 
"KRN",8994,687,3,10,0)
For PRN medication order:
"KRN",8994,687,3,11,0)
Results[0] = number of nodes
"KRN",8994,687,3,12,0)
 
"KRN",8994,687,3,13,0)
Results[1] = 1^Brief Adminstration History
"KRN",8994,687,3,14,0)
Results[2] = 1^ 1
"KRN",8994,687,3,15,0)
             2^ Admin date&time (Fileman format)
"KRN",8994,687,3,16,0)
             3^ Admin status
"KRN",8994,687,3,17,0)
             4^ Schedule Type
"KRN",8994,687,3,18,0)
             5^ Reason
"KRN",8994,687,3,19,0)
             6^ Injection site
"KRN",8994,687,3,20,0)
             7^ Doses given
"KRN",8994,687,3,21,0)
             8^ Unit of administration (free text)
"KRN",8994,691,-1)
0^1
"KRN",8994,691,0)
PSB GETPRNS^GETPRNS^PSBPRN^4^P^^^1^2
"KRN",8994,691,1,0)
^8994.01^4^4^3030507^^^^
"KRN",8994,691,1,1,0)
Returns all administrations of a PRN order that have NOT had the PRN
"KRN",8994,691,1,2,0)
Effectiveness documented in the current admission or within the hours 
"KRN",8994,691,1,3,0)
defined in PRN documentation site parameter whichever is greater of the 
"KRN",8994,691,1,4,0)
two.
"KRN",8994,691,2,0)
^8994.02A^2^2
"KRN",8994,691,2,1,0)
DFN^1^^1^1
"KRN",8994,691,2,1,1,0)
^^1^1^3010907^
"KRN",8994,691,2,1,1,1,0)
Patient IEN number.
"KRN",8994,691,2,2,0)
PSBORD^1^^0^2
"KRN",8994,691,2,2,1,0)
^8994.021^5^5^3030507^^^^
"KRN",8994,691,2,2,1,1,0)
Order number from Inpatient Medications. If order number is passed then 
"KRN",8994,691,2,2,1,2,0)
returns all PRN effectiveness not documented for that order.
"KRN",8994,691,2,2,1,3,0)
 
"KRN",8994,691,2,2,1,4,0)
If order number is NOT passed, then returns all PRN effectiveness not 
"KRN",8994,691,2,2,1,5,0)
documented for that patient.
"KRN",8994,691,2,"B","DFN",1)

"KRN",8994,691,2,"B","PSBORD",2)

"KRN",8994,691,2,"PARAMSEQ",1,1)

"KRN",8994,691,2,"PARAMSEQ",2,2)

"KRN",8994,691,3,0)
^^16^16^3030507^
"KRN",8994,691,3,1,0)
Results[0] = Number of Nodes.
"KRN",8994,691,3,2,0)
Results[1]= ^1 Med Log IEN
"KRN",8994,691,3,3,0)
            ^2 Patient IEN
"KRN",8994,691,3,4,0)
            ^3 Patient Location
"KRN",8994,691,3,5,0)
            ^4 Administration Date/Time (Fileman format)
"KRN",8994,691,3,6,0)
            ^5 Action By
"KRN",8994,691,3,7,0)
            ^6 Administration Medication
"KRN",8994,691,3,8,0)
            ^7 PRN Reason
"KRN",8994,691,3,9,0)
            ^8 Orderable item IEN
"KRN",8994,691,3,10,0)
            ^9 Order Number
"KRN",8994,691,3,11,0)
Results[2]= ^1 Special Instructions
"KRN",8994,691,3,12,0)
Results[3]= ^1 "DD/ADD/SOL"
"KRN",8994,691,3,13,0)
            ^2 Name of dispense drug/additive/solution
"KRN",8994,691,3,14,0)
            ^3 Dose given
"KRN",8994,691,3,15,0)
            ^4 Unit of administration (free text)
"KRN",8994,691,3,16,0)
Results[4]= ^1 "END"
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",536,-1)
1^1
"PKG",536,0)
BAR CODE MED ADMIN^PSB^BAR CODE MEDICATION ADMINISTRATION
"PKG",536,20,0)
^9.402P^^
"PKG",536,22,0)
^9.49I^1^1
"PKG",536,22,1,0)
2.0^3020514^3020719^10000000027
"PKG",536,22,1,"PAH",1,0)
24^3030618^10000000039
"PKG",536,22,1,"PAH",1,1,0)
^^45^45^3030618
"PKG",536,22,1,"PAH",1,1,1,0)
1. Bar Code Medication Administration (BCMA) will provide a visual
"PKG",536,22,1,"PAH",1,1,2,0)
indicator on the Virtual Due List (VDL) to identify which schedule types
"PKG",536,22,1,"PAH",1,1,3,0)
have active orders within the specified start and stop date/time for the
"PKG",536,22,1,"PAH",1,1,4,0)
selected Medication Tab. A green "alert light" to the left of the
"PKG",536,22,1,"PAH",1,1,5,0)
Schedule Type indicates that it has active orders for the specified
"PKG",536,22,1,"PAH",1,1,6,0)
timeframe, and a gray "alert light" to the left of the Schedule Type
"PKG",536,22,1,"PAH",1,1,7,0)
indicates that it has no active orders for the specified timeframe.
"PKG",536,22,1,"PAH",1,1,8,0)
 
"PKG",536,22,1,"PAH",1,1,9,0)
2. PRN medications will display on the VDL if the PRN Schedule Types
"PKG",536,22,1,"PAH",1,1,10,0)
check box is selected in the GUI BCMA Site Parameters application. All
"PKG",536,22,1,"PAH",1,1,11,0)
other schedule types will remain selected on the VDL by default when the
"PKG",536,22,1,"PAH",1,1,12,0)
user opens a patient's record.
"PKG",536,22,1,"PAH",1,1,13,0)
 
"PKG",536,22,1,"PAH",1,1,14,0)
3. The VDL will display a BCMA Clinical Reminders marquee at the lower
"PKG",536,22,1,"PAH",1,1,15,0)
right hand corner. The "count" is the number of PRN medications
"PKG",536,22,1,"PAH",1,1,16,0)
without Effectiveness comments within the hours defined in the
"PKG",536,22,1,"PAH",1,1,17,0)
"PRN Documentation" field on the Parameters tab of the GUI BCMA Site
"PKG",536,22,1,"PAH",1,1,18,0)
Parameters application or within the current admission whichever is 
"PKG",536,22,1,"PAH",1,1,19,0)
greater.
"PKG",536,22,1,"PAH",1,1,20,0)
A mouse-over list displays the last four undocumented PRN orders.
"PKG",536,22,1,"PAH",1,1,21,0)
When the user double clicks anywhere on the PRN Effectiveness row of
"PKG",536,22,1,"PAH",1,1,22,0)
the BCMA Clinical Reminders marquee, the PRN Effectiveness Log dialog box
"PKG",536,22,1,"PAH",1,1,23,0)
displays all PRN orders that need PRN Effectiveness and allowing
"PKG",536,22,1,"PAH",1,1,24,0)
documentation of PRN Effectiveness comments for each order listed.
"PKG",536,22,1,"PAH",1,1,25,0)
 
"PKG",536,22,1,"PAH",1,1,26,0)
The "count" will update/refresh when the user:
"PKG",536,22,1,"PAH",1,1,27,0)
a) opens a patient file.
"PKG",536,22,1,"PAH",1,1,28,0)
b) administers a PRN medication order.
"PKG",536,22,1,"PAH",1,1,29,0)
c) completes the documentation of a PRN Effectiveness.
"PKG",536,22,1,"PAH",1,1,30,0)
d) refreshes the VDL.
"PKG",536,22,1,"PAH",1,1,31,0)
 
"PKG",536,22,1,"PAH",1,1,32,0)
A Med History button has been added to display the Medication
"PKG",536,22,1,"PAH",1,1,33,0)
Administration History for the order selected.
"PKG",536,22,1,"PAH",1,1,34,0)
 
"PKG",536,22,1,"PAH",1,1,35,0)
4. When administering a PRN medication, the units given column
"PKG",536,22,1,"PAH",1,1,36,0)
within the Last Four Actions table and a drop down box for the users to
"PKG",536,22,1,"PAH",1,1,37,0)
select the PRN Reason have been added to the Medication Log dialog box.
"PKG",536,22,1,"PAH",1,1,38,0)
Units given will not display for orders with multiple dispensed drugs.
"PKG",536,22,1,"PAH",1,1,39,0)
 
"PKG",536,22,1,"PAH",1,1,40,0)
5. An updated PRN Effectiveness Log dialog will ease the process of
"PKG",536,22,1,"PAH",1,1,41,0)
PRN Effectiveness documentation. It displays a list of undocumented PRN
"PKG",536,22,1,"PAH",1,1,42,0)
medications for a specific order, or across orders, including PRN 
"PKG",536,22,1,"PAH",1,1,43,0)
medications from previous or expired orders. The dialog box
"PKG",536,22,1,"PAH",1,1,44,0)
includes a "units given" column, which will not display units for orders
"PKG",536,22,1,"PAH",1,1,45,0)
with multiple dispensed drugs. The division column has been removed.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","PSBOHDR")
0^2^B15108436
"RTN","PSBOHDR",1,0)
PSBOHDR ;BIRMINGHAM/EFC-REPORT HEADERS ;May 2002
"RTN","PSBOHDR",2,0)
 ;;2.0;BAR CODE MED ADMIN;**24**;May 2002
"RTN","PSBOHDR",3,0)
 ;
"RTN","PSBOHDR",4,0)
 ; Reference/IA
"RTN","PSBOHDR",5,0)
 ; ^GMRADPT/10099
"RTN","PSBOHDR",6,0)
 ; EN6^GMRVUTL/1120
"RTN","PSBOHDR",7,0)
 ; WARD^NURSUT5/3052
"RTN","PSBOHDR",8,0)
 ; IN5^VADPT/10061
"RTN","PSBOHDR",9,0)
 ; DEM^VADPT/10061
"RTN","PSBOHDR",10,0)
 ;
"RTN","PSBOHDR",11,0)
PT(DFN,PSBHDR,PSBCONT,PSBDT) ; 
"RTN","PSBOHDR",12,0)
 ; DFN:     Patient File IEN
"RTN","PSBOHDR",13,0)
 ; PSBCONT: True if this is a continuation page
"RTN","PSBOHDR",14,0)
 ; PSBDT:   Date of Pt Information (Default to DT)
"RTN","PSBOHDR",15,0)
 W:$Y>1 @IOF
"RTN","PSBOHDR",16,0)
 W:$X>1 !
"RTN","PSBOHDR",17,0)
 S:'$G(PSBDT) PSBDT=DT
"RTN","PSBOHDR",18,0)
 ; BUILD PSBHDR WITH ALL HEADER STUFF
"RTN","PSBOHDR",19,0)
 D:'$D(PSBHDR("NAME"))
"RTN","PSBOHDR",20,0)
 .S VAIP("D")="LAST"
"RTN","PSBOHDR",21,0)
 .D DEM^VADPT,IN5^VADPT
"RTN","PSBOHDR",22,0)
 .S PSBHDR("NAME")=VADM(1)
"RTN","PSBOHDR",23,0)
 .S PSBHDR("SSN")=$P(VADM(2),U,2)
"RTN","PSBOHDR",24,0)
 .S PSBHDR("DOB")=$P(VADM(3),U,2)
"RTN","PSBOHDR",25,0)
 .S PSBHDR("AGE")=VADM(4)
"RTN","PSBOHDR",26,0)
 .S PSBHDR("SEX")=$P(VADM(5),U,2)
"RTN","PSBOHDR",27,0)
 .S PSBHDR("MVMTTYPE")=$P(VAIP(2),U,2)
"RTN","PSBOHDR",28,0)
 .S PSBHDR("MVMTLAST")=$P(VAIP(3),U,2)
"RTN","PSBOHDR",29,0)
 .S PSBHDR("WARD")=$P(VAIP(5),U,2)
"RTN","PSBOHDR",30,0)
 .S PSBHDR("ROOM")=$P(VAIP(6),U,2)
"RTN","PSBOHDR",31,0)
 .S PSBHDR("DX")=VAIP(9)
"RTN","PSBOHDR",32,0)
 .K VAIP,VADM
"RTN","PSBOHDR",33,0)
 .S GMRVSTR="HT" D EN6^GMRVUTL
"RTN","PSBOHDR",34,0)
 .S X=+$P(X,U,8) S:X X=X*2.54\1 S PSBHDR("HEIGHT")=$S(X:X_"cm",1:"*")
"RTN","PSBOHDR",35,0)
 .S GMRVSTR="WT" D EN6^GMRVUTL
"RTN","PSBOHDR",36,0)
 .S X=+$P(X,U,8) S:X X=X*.45\1 S PSBHDR("WEIGHT")=$S(X:X_"kg",1:"*")
"RTN","PSBOHDR",37,0)
 .S GMRA="0^0^111" D EN1^GMRADPT S X=0,Y=""
"RTN","PSBOHDR",38,0)
 .F  S X=$O(GMRAL(X)) Q:'X  D
"RTN","PSBOHDR",39,0)
 ..S Z=$P(GMRAL(X),U,2) Q:Z=""
"RTN","PSBOHDR",40,0)
 ..D:$L(Y_Z)>(IOM-22)
"RTN","PSBOHDR",41,0)
 ...S PSBHDR("REAC",$O(PSBHDR("REAC",""),-1)+1)=Y,Y=""
"RTN","PSBOHDR",42,0)
 ..S Y=Y_$S(Y]"":", ",1:"")_$P(GMRAL(X),U,2)
"RTN","PSBOHDR",43,0)
 .S:Y]"" PSBHDR("REAC",$O(PSBHDR("REAC",""),-1)+1)=Y
"RTN","PSBOHDR",44,0)
 .I '$D(PSBHDR("REAC")) S PSBHDR("REAC",1)="None Entered"
"RTN","PSBOHDR",45,0)
 .K GMRAL,GMRVSTR,GMRA
"RTN","PSBOHDR",46,0)
 .D NOW^%DTC S Y=+$E(%,1,12) D D^DIQ S PSBHDR("DATE")="Run Date: "_Y
"RTN","PSBOHDR",47,0)
 .S PSBHDR("PAGE")=0
"RTN","PSBOHDR",48,0)
 W $C(13),$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",49,0)
 W !,$G(PSBHDR(0))
"RTN","PSBOHDR",50,0)
 W !,$G(PSBHDR(1)),?(IOM-$L(PSBHDR("DATE"))),PSBHDR("DATE")
"RTN","PSBOHDR",51,0)
 S PSBHDR("PAGE")=PSBHDR("PAGE")+1
"RTN","PSBOHDR",52,0)
 W !,$G(PSBHDR(2)),?(IOM-10),$J("Page: "_PSBHDR("PAGE"),10)
"RTN","PSBOHDR",53,0)
 F X=3:1 Q:'$D(PSBHDR(X))  W !,PSBHDR(X)  ; More Lines If Needed
"RTN","PSBOHDR",54,0)
 I $G(PSBCONT) W !?(IOM-35\2),"*** CONTINUED FROM PREVIOUS PAGE ***"
"RTN","PSBOHDR",55,0)
 W !!,"Patient:",?10,PSBHDR("NAME")
"RTN","PSBOHDR",56,0)
 W ?40,"SSN:       ",PSBHDR("SSN")
"RTN","PSBOHDR",57,0)
 W ?75,"DOB:",?82,PSBHDR("DOB")," (",PSBHDR("AGE"),")"
"RTN","PSBOHDR",58,0)
 D:'$G(PSBCONT)
"RTN","PSBOHDR",59,0)
 .W !,"Sex: ",?10,PSBHDR("SEX")
"RTN","PSBOHDR",60,0)
 .W ?40,"Ht/Wt:     ",PSBHDR("HEIGHT"),"/",PSBHDR("WEIGHT")
"RTN","PSBOHDR",61,0)
 .W ?75,"Ward: ",?82,PSBHDR("WARD")," Rm ",PSBHDR("ROOM")
"RTN","PSBOHDR",62,0)
 .W !,"Dx:",?10,PSBHDR("DX"),?40,"Last Mvmt: ",PSBHDR("MVMTLAST")
"RTN","PSBOHDR",63,0)
 .W ?75,"Type:  ",PSBHDR("MVMTTYPE")
"RTN","PSBOHDR",64,0)
 .; Reactions/Allergies
"RTN","PSBOHDR",65,0)
 .W !!,"Reactions:"
"RTN","PSBOHDR",66,0)
 .F X=0:0 S X=$O(PSBHDR("REAC",X)) Q:'X  D
"RTN","PSBOHDR",67,0)
 ..W:$X>12 ! W ?12,PSBHDR("REAC",X)
"RTN","PSBOHDR",68,0)
 .; Local Mods Allowed Here and showup only on First Page
"RTN","PSBOHDR",69,0)
 .; Immunizations
"RTN","PSBOHDR",70,0)
 .;D SHOT80^ASFSHOTF
"RTN","PSBOHDR",71,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",72,0)
 Q
"RTN","PSBOHDR",73,0)
 ;
"RTN","PSBOHDR",74,0)
WARD(PSBWP,PSBHDR,PSBCONT,PSBDT) ; 
"RTN","PSBOHDR",75,0)
 ; WARD:    Nurse Location File IEN
"RTN","PSBOHDR",76,0)
 ; PSBCONT: True if this is a continuation page
"RTN","PSBOHDR",77,0)
 ; PSBDT:   Date of Pt Information (Default to DT)
"RTN","PSBOHDR",78,0)
 N PSBWRDA
"RTN","PSBOHDR",79,0)
 S:'$G(PSBDT) PSBDT=DT
"RTN","PSBOHDR",80,0)
 D:'$D(PSBHDR("DATE"))
"RTN","PSBOHDR",81,0)
 .D NOW^%DTC S Y=+$E(%,1,12) D D^DIQ S PSBHDR("DATE")="Run Date: "_Y
"RTN","PSBOHDR",82,0)
 S:'$D(PSBHDR("PAGE")) PSBHDR("PAGE")=0
"RTN","PSBOHDR",83,0)
 W:$Y>1 @IOF
"RTN","PSBOHDR",84,0)
 W:$X>0 !
"RTN","PSBOHDR",85,0)
 W $TR($J("",IOM)," ","=")
"RTN","PSBOHDR",86,0)
 W !,$G(PSBHDR(0))
"RTN","PSBOHDR",87,0)
 W !,$G(PSBHDR(1)),?(IOM-$L(PSBHDR("DATE"))),PSBHDR("DATE")
"RTN","PSBOHDR",88,0)
 S PSBHDR("PAGE")=PSBHDR("PAGE")+1
"RTN","PSBOHDR",89,0)
 W !,$G(PSBHDR(2)),?(IOM-10),$J("Page: "_PSBHDR("PAGE"),10)
"RTN","PSBOHDR",90,0)
 F X=3:1 Q:'$D(PSBHDR(X))  W !,PSBHDR(X)  ; More Lines If Needed
"RTN","PSBOHDR",91,0)
 I $G(PSBCONT) W !?(IOM-35\2),"*** CONTINUED FROM PREVIOUS PAGE ***"
"RTN","PSBOHDR",92,0)
 D WARD^NURSUT5("L^"_PSBWP,.PSBWRDA)
"RTN","PSBOHDR",93,0)
 W !!,"Ward Location: "_$P(PSBWRDA(PSBWP,.01),U,2)
"RTN","PSBOHDR",94,0)
 S X="Division: "_$P(PSBWRDA(PSBWP,.02),U,2)
"RTN","PSBOHDR",95,0)
 W ?(IOM-$L(X)),X
"RTN","PSBOHDR",96,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",97,0)
 Q
"RTN","PSBOHDR",98,0)
 ;
"RTN","PSBOHDR",99,0)
PTFTR() ; [Extrinsic] Patient Page footer
"RTN","PSBOHDR",100,0)
 ;
"RTN","PSBOHDR",101,0)
 I (IOSL<100) F  Q:$Y>(IOSL-6)  W !
"RTN","PSBOHDR",102,0)
 W !,$TR($J("",IOM)," ","=")
"RTN","PSBOHDR",103,0)
 S X="Ward: "_PSBHDR("WARD")_"  Room-Bed: "_PSBHDR("ROOM")
"RTN","PSBOHDR",104,0)
 W !,PSBHDR("NAME"),?(IOM-11\2),PSBHDR("SSN"),?(IOM-$L(X)),X
"RTN","PSBOHDR",105,0)
 Q ""
"RTN","PSBOHDR",106,0)
 ;
"RTN","PSBOML")
0^3^B32021267
"RTN","PSBOML",1,0)
PSBOML ;BIRMINGHAM/EFC-MEDICATION LOG ;May 2002
"RTN","PSBOML",2,0)
 ;;2.0;BAR CODE MED ADMIN;**12,24**;May 2002
"RTN","PSBOML",3,0)
 ;
"RTN","PSBOML",4,0)
 ; Reference/IA
"RTN","PSBOML",5,0)
 ; ^DPT/10035
"RTN","PSBOML",6,0)
 ;
"RTN","PSBOML",7,0)
 ;
"RTN","PSBOML",8,0)
EN ; Begin printing
"RTN","PSBOML",9,0)
 N PSBSTRT,PSBSTOP,PSBHDR,DFN
"RTN","PSBOML",10,0)
 S PSBSTRT=$P(PSBRPT(.1),U,6)+$P(PSBRPT(.1),U,7)
"RTN","PSBOML",11,0)
 S PSBSTOP=$P(PSBRPT(.1),U,8)+$P(PSBRPT(.1),U,9)
"RTN","PSBOML",12,0)
 S PSBAUDF=$P(PSBRPT(.2),U,9)
"RTN","PSBOML",13,0)
 S PSBHDR(0)="Medication Log Report"
"RTN","PSBOML",14,0)
 S PSBHDR(1)="Continuing/PRN/Stat/One Time Medication/Treatment Record (Detailed Log) (VAF 10-2970 B, C, D)"
"RTN","PSBOML",15,0)
 ;
"RTN","PSBOML",16,0)
 ; Patient Report
"RTN","PSBOML",17,0)
 ;
"RTN","PSBOML",18,0)
 D:$P(PSBRPT(.1),U,1)="P"
"RTN","PSBOML",19,0)
 .S PSBHDR(2)="Log Type: INDIVIDUAL PATIENT"
"RTN","PSBOML",20,0)
 .S DFN=+$P(PSBRPT(.1),U,2)
"RTN","PSBOML",21,0)
 .W $$PTHDR()
"RTN","PSBOML",22,0)
 .S X=$O(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",23,0)
 .I X>PSBSTOP!(X="") D  Q
"RTN","PSBOML",24,0)
 ..W !!?10,"<<<< NO MEDICATIONS FOUND FOR THIS TIME FRAME >>>>",!!
"RTN","PSBOML",25,0)
 .S PSBGBL=$NAME(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",26,0)
 .F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'="AADT"!($QS(PSBGBL,3)'=DFN)!($QS(PSBGBL,4)>PSBSTOP)  D
"RTN","PSBOML",27,0)
 ..S PSBIEN=$QS(PSBGBL,5) Q:'$D(^PSB(53.79,PSBIEN))
"RTN","PSBOML",28,0)
 ..I $P(^PSB(53.79,PSBIEN,0),U,6)'=$QS(PSBGBL,4) Q
"RTN","PSBOML",29,0)
 ..I $Y>(IOSL-10) W $$PTFTR^PSBOHDR(),$$PTHDR()
"RTN","PSBOML",30,0)
 ..W $$LINE(PSBIEN)
"RTN","PSBOML",31,0)
 .W $$PTFTR^PSBOHDR()
"RTN","PSBOML",32,0)
 ;
"RTN","PSBOML",33,0)
 ; Ward Output
"RTN","PSBOML",34,0)
 ;
"RTN","PSBOML",35,0)
 D:$P(PSBRPT(.1),U,1)="W"
"RTN","PSBOML",36,0)
 .S PSBHDR(2)="LOG TYPE: WARD"
"RTN","PSBOML",37,0)
 .W $$WDHDR(PSBWRD)
"RTN","PSBOML",38,0)
 .S PSBTMPG=$NAME(^TMP("PSBO",$J,"B"))
"RTN","PSBOML",39,0)
 .F  S PSBTMPG=$Q(@PSBTMPG) Q:PSBTMPG=""  Q:$QS(PSBTMPG,1)'="PSBO"!($QS(PSBTMPG,2)'=$J)  D
"RTN","PSBOML",40,0)
 ..S DFN=$QS(PSBTMPG,5)
"RTN","PSBOML",41,0)
 ..I $Y>(IOSL-14) W $$WDHDR(PSBWRD)
"RTN","PSBOML",42,0)
 ..W !,$P(^DPT(DFN,0),U),"  (",$P(^(0),U,9),")"
"RTN","PSBOML",43,0)
 ..W !,"Ward: ",$G(^DPT(DFN,.1),"***"),"  Rm-Bed: ",$G(^DPT(DFN,.101),"***"),!
"RTN","PSBOML",44,0)
 ..S X=$O(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",45,0)
 ..I X>PSBSTOP!(X="") D  Q
"RTN","PSBOML",46,0)
 ...W !!?10,"<<<< NO MEDICATIONS FOUND FOR THIS TIME FRAME >>>>",!!
"RTN","PSBOML",47,0)
 ..S PSBGBL=$NAME(^PSB(53.79,"AADT",DFN,PSBSTRT-.0000001))
"RTN","PSBOML",48,0)
 ..F  S PSBGBL=$Q(@PSBGBL) Q:PSBGBL=""  Q:$QS(PSBGBL,2)'="AADT"!($QS(PSBGBL,3)'=DFN)!($QS(PSBGBL,4)>PSBSTOP)  D
"RTN","PSBOML",49,0)
 ...S PSBIEN=$QS(PSBGBL,5) I $P(^PSB(53.79,PSBIEN,0),U,6)'=$QS(PSBGBL,4) Q
"RTN","PSBOML",50,0)
 ...W:$Y>(IOSL-10) $$WDHDR(PSBWRD)
"RTN","PSBOML",51,0)
 ...W $$LINE(PSBIEN)
"RTN","PSBOML",52,0)
 Q
"RTN","PSBOML",53,0)
 ;
"RTN","PSBOML",54,0)
LINE(PSBIEN) ; Displays the med log entry in PSBIEN
"RTN","PSBOML",55,0)
 N PSBX,PSBASTUS
"RTN","PSBOML",56,0)
 S X=$P($G(^PSB(53.79,PSBIEN,.1)),U)
"RTN","PSBOML",57,0)
 I X="" D  Q ""
"RTN","PSBOML",58,0)
 .W !,"Error: Med Log Entry ",PSBIEN," has no order reference number!"
"RTN","PSBOML",59,0)
 I 'PSBAUDF,$P(^PSB(53.79,PSBIEN,0),U,9)="N" Q ""
"RTN","PSBOML",60,0)
 D CLEAN^PSBVT
"RTN","PSBOML",61,0)
 D PSJ1^PSBVT(DFN,X)
"RTN","PSBOML",62,0)
 I PSBDFN="-1" W !,"Error: Inpatient Meds API Failure!" Q ""
"RTN","PSBOML",63,0)
 M PSBX=^PSB(53.79,PSBIEN)
"RTN","PSBOML",64,0)
 S Y=$P(PSBX(0),U,4)+.0000001
"RTN","PSBOML",65,0)
 W !,$E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)
"RTN","PSBOML",66,0)
 W " ",$E(Y,9,10),":",$E(Y,11,12)
"RTN","PSBOML",67,0)
 S Y=$$GET1^DIQ(53.79,PSBIEN_",",.08)
"RTN","PSBOML",68,0)
 S Y=Y_" ["_PSBDOSE_PSBIFR_" "_PSBSCH
"RTN","PSBOML",69,0)
 S Y=Y_" "_PSBMRAB
"RTN","PSBOML",70,0)
 S:$P($G(^PSB(53.79,PSBIEN,.1)),U,6)]"" Y=Y_" Inj Site: "_$P(^(.1),U,6)
"RTN","PSBOML",71,0)
 S Y=Y_"]"
"RTN","PSBOML",72,0)
 W $$WRAP^PSBO(16,32,Y)
"RTN","PSBOML",73,0)
 W ?50,$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:INITIAL")
"RTN","PSBOML",74,0)
 S X=$P(PSBX(0),U,9)
"RTN","PSBOML",75,0)
 S PSBASTUS=$S(X="G":"Given",X="H":"Held",X="R":"Refused",X="I":"Infusing",X="C":"Completed",X="S":"Stopped",X="N":"Not Given",X="RM":"Removed",X="M":"Missing dose",1:"Status Missing")
"RTN","PSBOML",76,0)
 S Y=$P(PSBX(0),U,6)+.0000001
"RTN","PSBOML",77,0)
 S Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3)_" "_$E(Y,9,10)_":"_$E(Y,11,12)
"RTN","PSBOML",78,0)
 S Y=Y_" "_PSBASTUS
"RTN","PSBOML",79,0)
 W $$WRAP^PSBO(57,15,Y)
"RTN","PSBOML",80,0)
 W:$P(PSBX(.1),U)["V" ?75,"Bag ID #",$$GET1^DIQ(53.79,PSBIEN,"IV UNIQUE ID")
"RTN","PSBOML",81,0)
 W:$P(PSBX(.1),U)["V" ?107,"NA",?115,"NA",?120,"NA"
"RTN","PSBOML",82,0)
 W !,$TR($$FMTE^XLFDT(PSBOST,2),"@"," ")_">"
"RTN","PSBOML",83,0)
 F PSBZ=.5,.6,.7 S PSBDHIT=0 F PSBY=0:0 S PSBY=$O(PSBX(PSBZ,PSBY)) Q:'PSBY  D
"RTN","PSBOML",84,0)
 .W:$X>75 !
"RTN","PSBOML",85,0)
 .S PSBDD=$S(PSBZ=.5:53.795,PSBZ=.6:53.796,1:53.797)
"RTN","PSBOML",86,0)
 .S Y=$$EXTERNAL^DILFD(PSBDD,.01,"",$P(PSBX(PSBZ,PSBY,0),U,1))
"RTN","PSBOML",87,0)
 .W $$WRAP^PSBO(75,28,Y)
"RTN","PSBOML",88,0)
 .D:$P(PSBX(.1),U)["U"
"RTN","PSBOML",89,0)
 ..W ?105,$J($P(PSBX(PSBZ,PSBY,0),U,2),6,2)
"RTN","PSBOML",90,0)
 ..W ?113,$J($P(PSBX(PSBZ,PSBY,0),U,3),6,2)
"RTN","PSBOML",91,0)
 ..I 'PSBDHIT W $$WRAP^PSBO(120,12,$P(PSBX(PSBZ,PSBY,0),U,4)) S PSBDHIT=1
"RTN","PSBOML",92,0)
 .D:$P(PSBX(.1),U)["V"
"RTN","PSBOML",93,0)
 ..I $X+3+$L($P(PSBX(PSBZ,PSBY,0),U,3))>105 W !?75
"RTN","PSBOML",94,0)
 ..W " - ",$P(PSBX(PSBZ,PSBY,0),U,3)
"RTN","PSBOML",95,0)
 D:$P($G(^PSB(53.79,PSBIEN,.1)),U,2)="P"
"RTN","PSBOML",96,0)
 .W !?16,"PRN Reason: ",?30,$$GET1^DIQ(53.79,PSBIEN_",",.21)
"RTN","PSBOML",97,0)
 .W !?16,"PRN Effectiveness: "
"RTN","PSBOML",98,0)
 .I $P($G(^PSB(53.79,PSBIEN,.2)),U,2)="" D  Q
"RTN","PSBOML",99,0)
 ..W "<No PRN Effectiveness Entered>"
"RTN","PSBOML",100,0)
 .W $$GET1^DIQ(53.79,PSBIEN_",",.22)
"RTN","PSBOML",101,0)
 .W !?20,"Entered By: ",$$GET1^DIQ(53.79,PSBIEN_",",.23)
"RTN","PSBOML",102,0)
 .W " Date/Time: ",$$GET1^DIQ(53.79,PSBIEN_",",.24)
"RTN","PSBOML",103,0)
 .W " Minutes: ",$$GET1^DIQ(53.79,PSBIEN_",",.25)
"RTN","PSBOML",104,0)
 D:$P(PSBRPT(.2),U,8)
"RTN","PSBOML",105,0)
 .W !?16,"Comments: ",?30 I '$O(PSBX(.3,0)) W "<No Comments>"
"RTN","PSBOML",106,0)
 .F PSBY=0:0 S PSBY=$O(PSBX(.3,PSBY)) Q:'PSBY  D
"RTN","PSBOML",107,0)
 ..W:$X>30 !?30
"RTN","PSBOML",108,0)
 ..S Y=$P(PSBX(.3,PSBY,0),U,3)+.0000001
"RTN","PSBOML",109,0)
 ..W $E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)
"RTN","PSBOML",110,0)
 ..W " ",$E(Y,9,10),":",$E(Y,11,12)
"RTN","PSBOML",111,0)
 ..W ?46,$$GET1^DIQ(53.793,PSBY_","_PSBIEN_",","ENTERED BY:INITIAL")
"RTN","PSBOML",112,0)
 ..W $$WRAP^PSBO(52,70,$P(PSBX(.3,PSBY,0),U,1))
"RTN","PSBOML",113,0)
 W !,$TR($$FMTE^XLFDT(PSBOSP,2),"@"," ")_"<"
"RTN","PSBOML",114,0)
 D:PSBAUDF
"RTN","PSBOML",115,0)
 .W !?16,"Audits: ",?30 I '$O(PSBX(.9,0)) W "<No Audits>" Q
"RTN","PSBOML",116,0)
 .F PSBY=0:0 S PSBY=$O(PSBX(.9,PSBY)) Q:'PSBY  D
"RTN","PSBOML",117,0)
 ..W:$X>30 !?30
"RTN","PSBOML",118,0)
 ..S Y=$P(PSBX(.9,PSBY,0),U,1)+.0000001
"RTN","PSBOML",119,0)
 ..W $E(Y,4,5),"/",$E(Y,6,7),"/",$E(Y,2,3)
"RTN","PSBOML",120,0)
 ..W " ",$E(Y,9,10),":",$E(Y,11,12)
"RTN","PSBOML",121,0)
 ..W ?46,$$GET1^DIQ(53.799,PSBY_","_PSBIEN_",","USER:INITIAL")
"RTN","PSBOML",122,0)
 ..W $$WRAP^PSBO(52,70,$P(PSBX(.9,PSBY,0),U,3))
"RTN","PSBOML",123,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOML",124,0)
 Q ""
"RTN","PSBOML",125,0)
 ;
"RTN","PSBOML",126,0)
WDHDR(PSBWARD) ;
"RTN","PSBOML",127,0)
 D WARD^PSBOHDR(PSBWARD,.PSBHDR)
"RTN","PSBOML",128,0)
 W $$SUB()
"RTN","PSBOML",129,0)
 Q ""
"RTN","PSBOML",130,0)
 ;
"RTN","PSBOML",131,0)
PTHDR() ;
"RTN","PSBOML",132,0)
 D PT^PSBOHDR(DFN,.PSBHDR)
"RTN","PSBOML",133,0)
 W $$SUB()
"RTN","PSBOML",134,0)
 Q ""
"RTN","PSBOML",135,0)
 ;
"RTN","PSBOML",136,0)
SUB() ; Med Log Sub Header
"RTN","PSBOML",137,0)
 W:$X>1 !
"RTN","PSBOML",138,0)
 W "Activity Date",?16,"Orderable Item",?50,"Action",?57,"Action"
"RTN","PSBOML",139,0)
 W !,"Start Date>",?16,"[Dose/Sched/Route/Inj Site]",?50,"By"
"RTN","PSBOML",140,0)
 W ?57,"Date/Time",?75,"Drug/Additive/Solution",?105," U/Ord"
"RTN","PSBOML",141,0)
 W ?113," U/Gvn",?120,"Unit",!,"Stop Date<"
"RTN","PSBOML",142,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","PSBOML",143,0)
 Q ""
"RTN","PSBOML",144,0)
 ;
"RTN","PSBPAR1")
0^^B331503
"RTN","PSBPAR1",1,0)
PSBPAR1 ;BIRMINGHAM/VRN-BCMA PARAMETER MANAGEMENT ;May 2002
"RTN","PSBPAR1",2,0)
 ;;2.0;BAR CODE MED ADMIN;**24**;May, 2002
"RTN","PSBPAR1",3,0)
 ;
"RTN","PSBPAR1",4,0)
 ;Reference to $$GET^XPAR is supported by DBIA 2263
"RTN","PSBPAR1",5,0)
 ;Reference to $$EN^XPAR is supported by DBIA 2263
"RTN","PSBPAR1",6,0)
 ;
"RTN","PSBPAR1",7,0)
 ;Set the PSB PRN DOCUMENTATION parameter to 72 in the PARAMETER
"RTN","PSBPAR1",8,0)
 ;file (#8989.5), if there is no existing data or value.
"RTN","PSBPAR1",9,0)
 ;
"RTN","PSBPAR1",10,0)
 I '$$GET^XPAR("DIV","PSB PRN DOCUMENTATION") D EN^XPAR("DIV","PSB PRN DOCUMENTATION",1,72)
"RTN","PSBPAR1",11,0)
 Q
"RTN","PSBPRN")
0^4^B19400750
"RTN","PSBPRN",1,0)
PSBPRN ;BIRMINGHAM/EFC-BCMA PRN FUNCTIONS ;May, 2002
"RTN","PSBPRN",2,0)
 ;;2.0;BAR CODE MED ADMIN;**6,24**;May, 2002
"RTN","PSBPRN",3,0)
 ;
"RTN","PSBPRN",4,0)
 ;IN5^VADPT/10061
"RTN","PSBPRN",5,0)
 ;
"RTN","PSBPRN",6,0)
EN ;
"RTN","PSBPRN",7,0)
 Q
"RTN","PSBPRN",8,0)
 ;
"RTN","PSBPRN",9,0)
EDIT ; Edit Medication Log PRN Effectiveness
"RTN","PSBPRN",10,0)
 NEW DFN ;* Undef DFN at EDIT+7^PSBPRN (NOIS: HUN-0699-21494)
"RTN","PSBPRN",11,0)
 W !! S DA=""
"RTN","PSBPRN",12,0)
 S DIC="^DPT(",DIC(0)="AEQM",DIC("A")="Select Patient Name: "
"RTN","PSBPRN",13,0)
 D ^DIC K DIC Q:+Y<1
"RTN","PSBPRN",14,0)
 S DFN=+Y
"RTN","PSBPRN",15,0)
 D EDIT1
"RTN","PSBPRN",16,0)
 K DFN,DA
"RTN","PSBPRN",17,0)
 G EDIT
"RTN","PSBPRN",18,0)
 ;
"RTN","PSBPRN",19,0)
EDIT1 ;
"RTN","PSBPRN",20,0)
 S %DT="AEQ",%DT("A")="Select Date to Begin Searching Back From: "
"RTN","PSBPRN",21,0)
 S %DT("B")="Today"
"RTN","PSBPRN",22,0)
 W !! D ^%DT Q:+Y<1  S PSBDT=Y
"RTN","PSBPRN",23,0)
 F  D  Q:'PSBDT
"RTN","PSBPRN",24,0)
 .W @IOF,!,"Searching Date " S Y=PSBDT D D^DIQ W Y
"RTN","PSBPRN",25,0)
 .W !," #  Medication",?45,"St",?50,"D/T Given",?75,"Int"
"RTN","PSBPRN",26,0)
 .W !,$TR($J("",IOM)," ","-")
"RTN","PSBPRN",27,0)
 .S PSBSRCH=PSBDT+.9,PSBCNT=0
"RTN","PSBPRN",28,0)
 .K PSBTMP
"RTN","PSBPRN",29,0)
 .F  S PSBSRCH=$O(^PSB(53.79,"APRN",DFN,PSBSRCH),-1) Q:'PSBSRCH!(PSBSRCH<PSBDT)  D
"RTN","PSBPRN",30,0)
 ..S PSBIEN=""
"RTN","PSBPRN",31,0)
 ..F  S PSBIEN=$O(^PSB(53.79,"APRN",DFN,PSBSRCH,PSBIEN),-1) Q:'PSBIEN  D
"RTN","PSBPRN",32,0)
 ...Q:$P($G(^PSB(53.79,PSBIEN,.2)),U,2)]""
"RTN","PSBPRN",33,0)
 ...;Q:$P($G(^PSB(53.79,PSBIEN,0)),U,9)'="G"
"RTN","PSBPRN",34,0)
 ...S PSBCNT=PSBCNT+1,PSBTMP(PSBCNT)=PSBIEN
"RTN","PSBPRN",35,0)
 ...D:$Y>19
"RTN","PSBPRN",36,0)
 ....W ! S DIR(0)="E" D ^DIR
"RTN","PSBPRN",37,0)
 ....W @IOF,!,"Searching Date " S Y=PSBDT D D^DIQ W Y
"RTN","PSBPRN",38,0)
 ....W !," #  Medication",?45,"St",?50,"D/T Given",?75,"Int"
"RTN","PSBPRN",39,0)
 ....W !,$TR($J("",IOM)," ","-")
"RTN","PSBPRN",40,0)
 ...W !,$J(PSBCNT,2),". "
"RTN","PSBPRN",41,0)
 ...W ?5,$$GET1^DIQ(53.79,PSBIEN_",",.08)
"RTN","PSBPRN",42,0)
 ...W ?45,$P(^PSB(53.79,PSBIEN,0),U,9)
"RTN","PSBPRN",43,0)
 ...W ?50,$$GET1^DIQ(53.79,PSBIEN_",",.06)
"RTN","PSBPRN",44,0)
 ...W ?75,$$GET1^DIQ(53.79,PSBIEN_",","ACTION BY:INITIAL")
"RTN","PSBPRN",45,0)
 .I PSBCNT D  Q:Y
"RTN","PSBPRN",46,0)
 ..W ! S DIR(0)="NO^1:"_PSBCNT_":0" D ^DIR
"RTN","PSBPRN",47,0)
 ..I Y S DA=PSBTMP(Y),PSBDT=""
"RTN","PSBPRN",48,0)
 .I 'PSBCNT W !!?5,"No Meds Found!"
"RTN","PSBPRN",49,0)
 .S X1=PSBDT,X2=-1 D C^%DTC S (PSBDT,Y)=X D D^DIQ
"RTN","PSBPRN",50,0)
 .W !!,"Continue With ",Y
"RTN","PSBPRN",51,0)
 .S %=1 D YN^DICN I %'=1 S PSBDT=0
"RTN","PSBPRN",52,0)
 I DA D  G:%=1 EDIT1
"RTN","PSBPRN",53,0)
 .S DDSFILE=53.79,DR="[PSB PRN EFFECTIVENESS]" D ^DDS
"RTN","PSBPRN",54,0)
 .S %=2 W !,"Edit another entry" D YN^DICN
"RTN","PSBPRN",55,0)
 K PSBCNT,PSBDT,PSBIEN,PSBSRCH,PSBTMP,DA,DR,DDSFILE
"RTN","PSBPRN",56,0)
 Q
"RTN","PSBPRN",57,0)
 ;
"RTN","PSBPRN",58,0)
GETPRNS(RESULTS,DFN,PSBORD) ; Get the PRN's for a pt needing effectness
"RTN","PSBPRN",59,0)
 ;
"RTN","PSBPRN",60,0)
 ; RPC PSB GETPRNS
"RTN","PSBPRN",61,0)
 ;
"RTN","PSBPRN",62,0)
 ; Description:
"RTN","PSBPRN",63,0)
 ; Returns all administrations of a PRN order that have NOT had
"RTN","PSBPRN",64,0)
 ; the PRN Effectiveness documented for the last 30 days
"RTN","PSBPRN",65,0)
 ;
"RTN","PSBPRN",66,0)
 N PSBIEN,PSBSTOP,PSBFLAG
"RTN","PSBPRN",67,0)
 K ^TMP("PSB",$J),RESULTS
"RTN","PSBPRN",68,0)
 S VAIP("D")="LAST" D IN5^VADPT S PSBTRDT=+VAIP(3)
"RTN","PSBPRN",69,0)
 S PSBHOUR=$$GET^XPAR("DIV","PSB PRN DOCUMENTATION") I PSBHOUR="" S PSBHOUR=72
"RTN","PSBPRN",70,0)
 D NOW^%DTC S PSBSTRT=%,PSBPRNDT=$$FMADD^XLFDT(PSBSTRT,"",-PSBHOUR)
"RTN","PSBPRN",71,0)
 S PSBFLAG=0
"RTN","PSBPRN",72,0)
 I PSBPRNDT'<PSBTRDT S PSBFLAG=1
"RTN","PSBPRN",73,0)
 S PSBSTRT="" F  S PSBSTRT=$O(^PSB(53.79,"APRN",DFN,PSBSTRT),-1) Q:PSBSTRT<PSBPRNDT&(PSBFLAG=0)  Q:PSBSTRT<PSBTRDT&(PSBFLAG=1)  D
"RTN","PSBPRN",74,0)
 .S PSBIEN=""
"RTN","PSBPRN",75,0)
 .F  S PSBIEN=$O(^PSB(53.79,"APRN",DFN,PSBSTRT,PSBIEN),-1) Q:'PSBIEN  D
"RTN","PSBPRN",76,0)
 ..Q:PSBORD'=""&($P(^PSB(53.79,PSBIEN,.1),U)'=PSBORD)  ;  Not the right order
"RTN","PSBPRN",77,0)
 ..I ($P(^PSB(53.79,PSBIEN,0),U,9)'="G")&($P(^PSB(53.79,PSBIEN,0),U,9)'="RM") Q    ; Med was never given
"RTN","PSBPRN",78,0)
 ..Q:$P($G(^PSB(53.79,PSBIEN,.2)),U,2)]""  ; Already entered
"RTN","PSBPRN",79,0)
 ..S PSBX=PSBIEN_U_DFN,PSBIENS=PSBIEN_","
"RTN","PSBPRN",80,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.02)
"RTN","PSBPRN",81,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.06,"I")
"RTN","PSBPRN",82,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.07)
"RTN","PSBPRN",83,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.08)
"RTN","PSBPRN",84,0)
 ..S PSBX=PSBX_U_$$GET1^DIQ(53.79,PSBIENS,.21)
"RTN","PSBPRN",85,0)
 ..D PSJ1^PSBVT(DFN,$$GET1^DIQ(53.79,PSBIENS,.11))
"RTN","PSBPRN",86,0)
 ..S PSBX=PSBX_U_PSBOIT_U_PSBONX
"RTN","PSBPRN",87,0)
 ..S Y=$O(^TMP("PSB",$J,""),-1)+1
"RTN","PSBPRN",88,0)
 ..S ^TMP("PSB",$J,Y)=PSBX
"RTN","PSBPRN",89,0)
 ..;Special instructions
"RTN","PSBPRN",90,0)
 ..S Y=Y+1,^TMP("PSB",$J,Y)=PSBOTXT
"RTN","PSBPRN",91,0)
 ..F PSBZ=.5,.6,.7 F PSBY=0:0 S PSBY=$O(^PSB(53.79,PSBIEN,PSBZ,PSBY)) Q:'PSBY  D
"RTN","PSBPRN",92,0)
 ...S PSBDD=$S(PSBZ=.5:53.795,PSBZ=.6:53.796,1:53.797)
"RTN","PSBPRN",93,0)
 ...S PSBSOL=$S(PSBZ=.5:"DD",PSBZ=.6:"ADD",1:"SOL")
"RTN","PSBPRN",94,0)
 ...Q:'$D(^PSB(53.79,PSBIEN,PSBZ,PSBY))
"RTN","PSBPRN",95,0)
 ...S PSBUNIT=$$GET1^DIQ(PSBDD,PSBY_","_PSBIEN_",",.03)
"RTN","PSBPRN",96,0)
 ...S PSBUNFR=$$GET1^DIQ(PSBDD,PSBY_","_PSBIEN_",",.04)
"RTN","PSBPRN",97,0)
 ...S Y=Y+1
"RTN","PSBPRN",98,0)
 ...S ^TMP("PSB",$J,Y)=PSBSOL_U_$$GET1^DIQ(PSBDD,PSBY_","_PSBIEN_",",.01)_U_PSBUNIT_U_PSBUNFR
"RTN","PSBPRN",99,0)
 ..S Y=Y+1,^TMP("PSB",$J,Y)="END"
"RTN","PSBPRN",100,0)
 S ^TMP("PSB",$J,0)=+$O(^TMP("PSB",$J,""),-1)
"RTN","PSBPRN",101,0)
 S RESULTS=$NAME(^TMP("PSB",$J))
"RTN","PSBPRN",102,0)
 K PSBTRDT,PSBHOUR,PSBPRNDT
"RTN","PSBPRN",103,0)
 D CLEAN^PSBVT
"RTN","PSBPRN",104,0)
 Q
"RTN","PSBPRN",105,0)
 ;
"RTN","PSBRPC3")
0^5^B300186
"RTN","PSBRPC3",1,0)
PSBRPC3 ;BIRMINGHAM/VRN-BCMA RPC BROKER CALLS ;May 2002
"RTN","PSBRPC3",2,0)
 ;;2.0;BAR CODE MED ADMIN;**8,20,19,24**;May 2002
"RTN","PSBRPC3",3,0)
 ;
"RTN","PSBRPC3",4,0)
GUICHK(RESULTS,DUMMY) ;
"RTN","PSBRPC3",5,0)
 ;
"RTN","PSBRPC3",6,0)
 ; RPC : PSB VERSION CHECK
"RTN","PSBRPC3",7,0)
 ;
"RTN","PSBRPC3",8,0)
 K RESULTS
"RTN","PSBRPC3",9,0)
 N PSBCURR,PSBPREV,PSBCNT
"RTN","PSBRPC3",10,0)
 S PSBCURR="2.0.24.13",PSBPREV="",PSBCNT=0
"RTN","PSBRPC3",11,0)
 S PSBCNT=PSBCNT+1
"RTN","PSBRPC3",12,0)
 S RESULTS(PSBCNT)=PSBCURR_U_PSBPREV
"RTN","PSBRPC3",13,0)
 S RESULTS(0)=PSBCNT
"RTN","PSBRPC3",14,0)
 Q
"RTN","PSBVDLVL")
0^7^B53235495
"RTN","PSBVDLVL",1,0)
PSBVDLVL ;BIRMINGHAM/EFC-BCMA VIRTUAL DUE LIST FUNCTIONS ;May 2002
"RTN","PSBVDLVL",2,0)
 ;;2.0;BAR CODE MED ADMIN;**6,19,24**;May 2002
"RTN","PSBVDLVL",3,0)
 ;
"RTN","PSBVDLVL",4,0)
EN(RESULTS,DFN,PSBIEN,PSBTYPE,PSBADMIN,PSBTAB,PSBUID,PSBASTS,PSBORSTS,PSBRMV) ;
"RTN","PSBVDLVL",5,0)
 ;
"RTN","PSBVDLVL",6,0)
 ; RPC: PSB VALIDATE ORDER
"RTN","PSBVDLVL",7,0)
 ;
"RTN","PSBVDLVL",8,0)
 ; Description: Final check of order against an actual administration
"RTN","PSBVDLVL",9,0)
 ;              date/time used immediately after scanned med has been
"RTN","PSBVDLVL",10,0)
 ;              validated to be a good un-administered order.
"RTN","PSBVDLVL",11,0)
 ;
"RTN","PSBVDLVL",12,0)
 K PSBOKAY D CLEAN^PSBVT,PSJ1^PSBVT(DFN,PSBIEN_PSBTYPE) S PSB=0
"RTN","PSBVDLVL",13,0)
 S RESULTS(0)=1,RESULTS(1)="-1^***Unable to determine administration" ; Default Flag will be overwritten by anything
"RTN","PSBVDLVL",14,0)
 D NOW^%DTC
"RTN","PSBVDLVL",15,0)
 I PSBORSTS'=PSBOSTS,((PSBSCHT'="O")&(PSBOSTS'="E")) S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-2^ORDER STATUS MISMATCH" Q
"RTN","PSBVDLVL",16,0)
 I ((PSBTAB="UDTAB")!(PSBTAB="PBTAB")),((PSBRMV="RM")!(PSBRMV="N")) D  Q
"RTN","PSBVDLVL",17,0)
 .S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^OKAY TO REMOVE"  ;  is a patch removal does not follow rest of validte rules
"RTN","PSBVDLVL",18,0)
 .I PSBASTS="" Q  ;status is not given - don't check for missmatch
"RTN","PSBVDLVL",19,0)
 .I $D(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN)) D
"RTN","PSBVDLVL",20,0)
 ..S X=$O(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN,""))
"RTN","PSBVDLVL",21,0)
 ..I $P($G(^PSB(53.79,+X,0)),U,9)'=PSBASTS  S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-2^Admin status mismatch"
"RTN","PSBVDLVL",22,0)
 I PSBTYPE="V",PSBSCHT'="P",((PSBUID="")!(PSBUID["WS")) S RESULTS(0)=1,RESULTS(1)="0^Okay to administer" Q
"RTN","PSBVDLVL",23,0)
 I PSBTYPE="V",PSBUID'="" D  Q:PSBTAB="IVTAB"  ; validate IV bags Piggybacks have additional tests
"RTN","PSBVDLVL",24,0)
 .S PSB=0
"RTN","PSBVDLVL",25,0)
 .;I ((PSBASTS="I")!(PSBASTS="S"))&((PSBORSTS="D")!(PSBORSTS="R")) Q
"RTN","PSBVDLVL",26,0)
 .S PSBSUID=PSBUID D EN^PSBPOIV(DFN,PSBIEN_PSBTYPE)
"RTN","PSBVDLVL",27,0)
 .S X="" F  S X=$O(^TMP("PSBAR",$J,X)) Q:X=""  D
"RTN","PSBVDLVL",28,0)
 ..I PSBSUID'=X Q
"RTN","PSBVDLVL",29,0)
 ..S PSBUIDS=^TMP("PSBAR",$J,X)
"RTN","PSBVDLVL",30,0)
 ..I $P(PSBUIDS,U,2)="I"!($P(PSBUIDS,U,2)="S") D  Q  ; is infusing or stopped
"RTN","PSBVDLVL",31,0)
 ...S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^Okay to administer"
"RTN","PSBVDLVL",32,0)
 ..I $P(PSBUIDS,U,1)="I" D  Q
"RTN","PSBVDLVL",33,0)
 ...S Y=$P(^TMP("PSBAR",$J,"I"),U,2) D DD^%DT
"RTN","PSBVDLVL",34,0)
 ...S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=$P(^TMP("PSBAR",$J,"I"),U,3,99)_"  "_Y
"RTN","PSBVDLVL",35,0)
 ..I $P(PSBUIDS,U,1)["W" S PSBWS=$P(PSBUIDS,U,1) F PSBWM=2:1 Q:$P(PSBWS,";",PSBWM)=""  D
"RTN","PSBVDLVL",36,0)
 ...S Y=$P(^TMP("PSBAR",$J,"W",$P(PSBWS,";",PSBWM)),U,2) D DD^%DT
"RTN","PSBVDLVL",37,0)
 ...S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=$P(^TMP("PSBAR",$J,"W",$P(PSBWS,";",PSBWM)),U,3,99)_" "_Y
"RTN","PSBVDLVL",38,0)
 ..S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^Okay to administer"
"RTN","PSBVDLVL",39,0)
 .K ^TMP("PSBAR",$J)
"RTN","PSBVDLVL",40,0)
 ;
"RTN","PSBVDLVL",41,0)
 ; no IV orders
"RTN","PSBVDLVL",42,0)
 ;
"RTN","PSBVDLVL",43,0)
 D NOW^%DTC
"RTN","PSBVDLVL",44,0)
 I PSBOSTS="H" S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="0^Order is on Provider Hold" Q
"RTN","PSBVDLVL",45,0)
 I PSBSCHT'="O"&(%<($$FMADD^XLFDT(PSBOST,"","",$$GET^XPAR("ALL","PSB ADMIN BEFORE")*-1))) S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-1^Order Not Active" Q
"RTN","PSBVDLVL",46,0)
 I PSBSCHT'="O"&(%>PSBOSP) S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)="-1^Order Not Active" Q
"RTN","PSBVDLVL",47,0)
 I (PSBSCHT="C")!((PSBSCHT="P")&(PSBDOSEF="PATCH")) D
"RTN","PSBVDLVL",48,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",49,0)
 .I PSBOSTS'="A",PSBOSTS'="R",PSBOSTS'="O" D  Q
"RTN","PSBVDLVL",50,0)
 ..S PSBOKAY="-1^Order Not Active"
"RTN","PSBVDLVL",51,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",52,0)
 .I $D(^PSB(53.79,"AORDX",DFN,PSBIEN_PSBTYPE)) D  Q:X
"RTN","PSBVDLVL",53,0)
 ..S X=0,PSBLADT=$O(^PSB(53.79,"AORDX",DFN,PSBIEN_PSBTYPE,""),-1),PSBLAIEN=$O(^PSB(53.79,"AORDX",DFN,PSBIEN_PSBTYPE,PSBLADT,""),-1)
"RTN","PSBVDLVL",54,0)
 ..I $P($G(^PSB(53.79,PSBLAIEN,0)),U,9)="G",$P($G(^PSB(53.79,PSBLAIEN,.5,1,0)),U,4)="PATCH" D
"RTN","PSBVDLVL",55,0)
 ...S X=1,PSBOKAY="-1^Previous patch has not been removed"
"RTN","PSBVDLVL",56,0)
 .I $D(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN)) D  Q:+PSBOKAY=-2
"RTN","PSBVDLVL",57,0)
 ..I PSBASTS=""  Q
"RTN","PSBVDLVL",58,0)
 ..S X=$O(^PSB(53.79,"AORD",DFN,PSBIEN_PSBTYPE,+PSBADMIN,""))
"RTN","PSBVDLVL",59,0)
 ..I $P($G(^PSB(53.79,+X,0)),U,9)'=PSBASTS S PSBOKAY="-2^Admin status mismatch"
"RTN","PSBVDLVL",60,0)
 .; Minutes before
"RTN","PSBVDLVL",61,0)
 .S PSBWIN1=$$GET^XPAR("DIV","PSB ADMIN BEFORE")*-1
"RTN","PSBVDLVL",62,0)
 .; Minutes After
"RTN","PSBVDLVL",63,0)
 .S PSBWIN2=$$GET^XPAR("DIV","PSB ADMIN AFTER")
"RTN","PSBVDLVL",64,0)
 .D NOW^%DTC S PSBMIN=$$DIFF^PSBUTL(PSBADMIN,%)
"RTN","PSBVDLVL",65,0)
 .; PENDING A PC SOLUTION!
"RTN","PSBVDLVL",66,0)
 .I PSBMIN<PSBWIN1 D  Q
"RTN","PSBVDLVL",67,0)
 ..S PSBOKAY="1^Admin is "_(PSBMIN*-1)_" minutes before the scheduled administration time"
"RTN","PSBVDLVL",68,0)
 .I PSBMIN>PSBWIN2 D  Q
"RTN","PSBVDLVL",69,0)
 ..S PSBOKAY="1^Admin is "_(PSBMIN)_" minutes after the scheduled administration time"
"RTN","PSBVDLVL",70,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",71,0)
 ; Validate a PRN Order
"RTN","PSBVDLVL",72,0)
 D:(PSBSCHT="P")
"RTN","PSBVDLVL",73,0)
 .I PSBOSTS'="A",PSBOSTS'="R",PSBOSTS'="O" D  Q
"RTN","PSBVDLVL",74,0)
 ..S PSBOKAY="-1^Order Not Active"
"RTN","PSBVDLVL",75,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",76,0)
 .I (+($G(PSBOKAY))<0)&(PSBDOSEF="PATCH") Q  ;A Patch may have to be removed.
"RTN","PSBVDLVL",77,0)
 .S PSBOKAY="1^"
"RTN","PSBVDLVL",78,0)
 .; Get Last Four Givens
"RTN","PSBVDLVL",79,0)
 .S PSBDT=""
"RTN","PSBVDLVL",80,0)
 .F  S PSBDT=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,PSBDT),-1) Q:PSBDT=""  D
"RTN","PSBVDLVL",81,0)
 ..S PSBDA=""
"RTN","PSBVDLVL",82,0)
 ..F  S PSBDA=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,PSBDT,PSBDA),-1) Q:'PSBDA  D
"RTN","PSBVDLVL",83,0)
 ...S (PSBCNT1,PSBCNT2,PSBCNT3)=0
"RTN","PSBVDLVL",84,0)
 ...S PSBLADT=$$GET1^DIQ(53.79,PSBDA_",",.06,"I")  ;$P(^PSB(53.79,PSBDA,0),U,6)
"RTN","PSBVDLVL",85,0)
 ...S PSBSTUS=$$GET1^DIQ(53.79,PSBDA_",",.09)
"RTN","PSBVDLVL",86,0)
 ...S PSBSCH=$$GET1^DIQ(53.79,PSBDA_",",.12)
"RTN","PSBVDLVL",87,0)
 ...S PSBRSN=$$GET1^DIQ(53.79,PSBDA_",",.21)
"RTN","PSBVDLVL",88,0)
 ...S PSBINJ=$$GET1^DIQ(53.79,PSBDA_",",.16)
"RTN","PSBVDLVL",89,0)
 ...Q:$P(^PSB(53.79,PSBDA,0),U,9)="N"
"RTN","PSBVDLVL",90,0)
 ...F PSBZ=.5,.6,.7 F PSBY=0:0 S PSBY=$O(^PSB(53.79,PSBDA,PSBZ,PSBY)) Q:'PSBY  D
"RTN","PSBVDLVL",91,0)
 ....Q:'$D(^PSB(53.79,PSBDA,PSBZ,PSBY))
"RTN","PSBVDLVL",92,0)
 ....S PSBDD=$S(PSBZ=.5:53.795,PSBZ=.6:53.796,1:53.797)
"RTN","PSBVDLVL",93,0)
 ....S PSBUNIT=$$GET1^DIQ(PSBDD,PSBY_","_PSBDA_",",.03)
"RTN","PSBVDLVL",94,0)
 ....S PSBUNFR=$$GET1^DIQ(PSBDD,PSBY_","_PSBDA_",",.04)
"RTN","PSBVDLVL",95,0)
 ....I PSBZ=.5 S PSBCNT1=PSBCNT1+1
"RTN","PSBVDLVL",96,0)
 ....I PSBZ=.6 S PSBCNT2=PSBCNT2+1
"RTN","PSBVDLVL",97,0)
 ....I PSBZ=.7 S PSBCNT3=PSBCNT3+1
"RTN","PSBVDLVL",98,0)
 ...;Units given or free text not to display for multiple dispense drugs or additives and solution
"RTN","PSBVDLVL",99,0)
 ...I (PSBCNT1>1)!(PSBCNT2>0)!(PSBCNT3>0) S (PSBUNIT,PSBUNFR)=""
"RTN","PSBVDLVL",100,0)
 ...S X=PSBLADT_U
"RTN","PSBVDLVL",101,0)
 ...S X=X_PSBSTUS_U_PSBSCH_U_$G(PSBRSN)_U_$G(PSBINJ)_U_$G(PSBUNIT)_U_$G(PSBUNFR)
"RTN","PSBVDLVL",102,0)
 ...S PSBOKAY($O(PSBOKAY(""),-1)+1)=3_U_X
"RTN","PSBVDLVL",103,0)
 ...S:$D(PSBOKAY(4)) PSBDT=0
"RTN","PSBVDLVL",104,0)
 ; Validate a One-Time Order
"RTN","PSBVDLVL",105,0)
 D:PSBSCHT="O"
"RTN","PSBVDLVL",106,0)
 .S (PSBGVN,X,Y)=""
"RTN","PSBVDLVL",107,0)
 .F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1)  Q:'X  D
"RTN","PSBVDLVL",108,0)
 ..F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBVDLVL",109,0)
 ...I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLVL",110,0)
 .I PSBGVN S PSBOKAY="-1^Dose Already on medication Log" Q
"RTN","PSBVDLVL",111,0)
 .; One Time are automatically expired so we don't check STATUS here
"RTN","PSBVDLVL",112,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",113,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",114,0)
 ; Validate an On Call Order
"RTN","PSBVDLVL",115,0)
 D:PSBSCHT="OC"
"RTN","PSBVDLVL",116,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",117,0)
 .S (PSBGVN,X,Y)=""
"RTN","PSBVDLVL",118,0)
 .F  S X=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X),-1)  Q:'X  D
"RTN","PSBVDLVL",119,0)
 ..F  S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,X,Y),-1) Q:'Y  D
"RTN","PSBVDLVL",120,0)
 ...I $P(^PSB(53.79,Y,.1),U)=PSBONX,$P(^PSB(53.79,Y,0),U,9)="G" S PSBGVN=1,(X,Y)=0
"RTN","PSBVDLVL",121,0)
 .I PSBGVN&('$$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL")) S PSBOKAY="-1^Dose Already on medication Log" Q
"RTN","PSBVDLVL",122,0)
 .I PSBOSTS'="A",PSBOSTS'="R",PSBOSTS'="O" D  Q
"RTN","PSBVDLVL",123,0)
 ..S PSBOKAY="-1^Order Not Active"
"RTN","PSBVDLVL",124,0)
 .I PSBNGF S PSBOKAY="-1^marked DO NOT GIVE" Q
"RTN","PSBVDLVL",125,0)
 .I PSBGVN&($$GET^XPAR("DIV","PSB ADMIN MULTIPLE ONCALL"))&(PSBDOSEF="PATCH") S PSBOKAY="-1^Previous patch has not been removed" Q
"RTN","PSBVDLVL",126,0)
 .S PSBOKAY="0^Okay to administer"
"RTN","PSBVDLVL",127,0)
 ;
"RTN","PSBVDLVL",128,0)
 D:+PSBOKAY'=-1
"RTN","PSBVDLVL",129,0)
 .N PSBDIFF,Y
"RTN","PSBVDLVL",130,0)
 .;D:(PSBSCHT="C"&('$D(^PSB(53.79,"AORD",DFN,PSBONX))))!(PSBSCHT="OC"&('$G(PSBGVN)))
"RTN","PSBVDLVL",131,0)
 .D:(PSBSCHT="C")!(PSBSCHT="OC"&('$G(PSBGVN)))
"RTN","PSBVDLVL",132,0)
 ..; Ok, now we know it is on-call or cont and not on the log.
"RTN","PSBVDLVL",133,0)
 ..S Y=$O(^PSB(53.79,"AOIP",DFN,PSBOIT,""),-1)
"RTN","PSBVDLVL",134,0)
 ..S PSBDIFF=$$FMDIFF^XLFDT($$NOW^XLFDT(),Y,2)
"RTN","PSBVDLVL",135,0)
 ..Q:PSBDIFF>7200  ; Greater than 2 hours
"RTN","PSBVDLVL",136,0)
 ..;Check for the status of the medication and insert status in the text
"RTN","PSBVDLVL",137,0)
 ..I Y]"" S X=$O(^PSB(53.79,"AOIP",DFN,+PSBOIT,Y,""),-1),PSBSTUS=$P(^PSB(53.79,X,0),U,9)
"RTN","PSBVDLVL",138,0)
 ..I (PSBSTUS="G")!(PSBSTUS="H")!(PSBSTUS="R")!(PSBSTUS="RM") D
"RTN","PSBVDLVL",139,0)
 ...S PSBSTUS=$S(PSBSTUS="G":"GIVEN",PSBSTUS="H":"HELD",PSBSTUS="R":"REFUSED",PSBSTUS="RM":"REMOVED",1:"")
"RTN","PSBVDLVL",140,0)
 ...I PSBSTUS'="" D
"RTN","PSBVDLVL",141,0)
 ....S Y="1^*** NOTICE, "_PSBOITX_" was "_PSBSTUS_" "_(PSBDIFF\60)_" minutes ago."
"RTN","PSBVDLVL",142,0)
 ....I +PSBOKAY=1 S PSBOKAY(1)=Y
"RTN","PSBVDLVL",143,0)
 ....E  S PSBOKAY=Y
"RTN","PSBVDLVL",144,0)
 ;
"RTN","PSBVDLVL",145,0)
 S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=PSBOKAY
"RTN","PSBVDLVL",146,0)
 F X=1:1 Q:'$D(PSBOKAY(X))  D
"RTN","PSBVDLVL",147,0)
 .S PSB=PSB+1,RESULTS(0)=PSB,RESULTS(PSB)=PSBOKAY(X)
"RTN","PSBVDLVL",148,0)
 Q
"RTN","PSBVDLVL",149,0)
 ;
"VER")
8.0^22.0
**END**
**END**
