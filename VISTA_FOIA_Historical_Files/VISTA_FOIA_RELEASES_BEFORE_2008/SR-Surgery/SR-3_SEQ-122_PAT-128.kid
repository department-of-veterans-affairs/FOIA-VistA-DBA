Released SR*3*128 SEQ #122
Extracted from mail message
**KIDS**:SR*3.0*128^

**INSTALL NAME**
SR*3.0*128
"BLD",4838,0)
SR*3.0*128^SURGERY^0^3040422^y
"BLD",4838,1,0)
^^20^20^3040422^
"BLD",4838,1,1,0)
This patch addresses follow-up issues related to the Surgery Electronic 
"BLD",4838,1,2,0)
Signature for Operative Reports patch (SR*3*100).
"BLD",4838,1,3,0)
 
"BLD",4838,1,4,0)
1. Converted documents for historical surgical/non-OR cases are stored in 
"BLD",4838,1,5,0)
   the TIU DOCUMENT file (#8925) with a status of COMPLETED, but they 
"BLD",4838,1,6,0)
   have no signature date. Therefore, when one of these converted
"BLD",4838,1,7,0)
   documents is printed, the following line is printed at the end of the
"BLD",4838,1,8,0)
   document text:
"BLD",4838,1,9,0)
 
"BLD",4838,1,10,0)
**DRAFT COPY - DRAFT COPY -- ABOVE NOTE IS UNSIGNED-- DRAFT COPY - DRAFT COPY**
"BLD",4838,1,11,0)
 
"BLD",4838,1,12,0)
   This patch modifies the routine SROESPR1 to prevent the display of this
"BLD",4838,1,13,0)
   line if the document has a status of COMPLETED. See NOIS
"BLD",4838,1,14,0)
   FAR-0104-40622.
"BLD",4838,1,15,0)
 
"BLD",4838,1,16,0)
2. The input template SROARPT is used by the Anesthesia Report [SROARPT] 
"BLD",4838,1,17,0)
   option to edit fields that are part of the Anesthesia Report. This 
"BLD",4838,1,18,0)
   patch modifies this input template to remove the INTRAOPERATIVE
"BLD",4838,1,19,0)
   OCCURRENCES field (#1.14) and the POSTOP OCCURRENCE field (#1.16) since
"BLD",4838,1,20,0)
   these two fields do not appear on the Anesthesia Report.
"BLD",4838,4,0)
^9.64PA^^
"BLD",4838,"ABPKG")
n
"BLD",4838,"KRN",0)
^9.67PA^8989.52^19
"BLD",4838,"KRN",.4,0)
.4
"BLD",4838,"KRN",.401,0)
.401
"BLD",4838,"KRN",.402,0)
.402
"BLD",4838,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",4838,"KRN",.402,"NM",1,0)
SROARPT    FILE #130^130^0
"BLD",4838,"KRN",.402,"NM","B","SROARPT    FILE #130",1)

"BLD",4838,"KRN",.403,0)
.403
"BLD",4838,"KRN",.5,0)
.5
"BLD",4838,"KRN",.84,0)
.84
"BLD",4838,"KRN",3.6,0)
3.6
"BLD",4838,"KRN",3.8,0)
3.8
"BLD",4838,"KRN",9.2,0)
9.2
"BLD",4838,"KRN",9.8,0)
9.8
"BLD",4838,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4838,"KRN",9.8,"NM",1,0)
SROESPR1^^0^B64764154
"BLD",4838,"KRN",9.8,"NM","B","SROESPR1",1)

"BLD",4838,"KRN",19,0)
19
"BLD",4838,"KRN",19.1,0)
19.1
"BLD",4838,"KRN",101,0)
101
"BLD",4838,"KRN",409.61,0)
409.61
"BLD",4838,"KRN",771,0)
771
"BLD",4838,"KRN",870,0)
870
"BLD",4838,"KRN",8989.51,0)
8989.51
"BLD",4838,"KRN",8989.52,0)
8989.52
"BLD",4838,"KRN",8994,0)
8994
"BLD",4838,"KRN","B",.4,.4)

"BLD",4838,"KRN","B",.401,.401)

"BLD",4838,"KRN","B",.402,.402)

"BLD",4838,"KRN","B",.403,.403)

"BLD",4838,"KRN","B",.5,.5)

"BLD",4838,"KRN","B",.84,.84)

"BLD",4838,"KRN","B",3.6,3.6)

"BLD",4838,"KRN","B",3.8,3.8)

"BLD",4838,"KRN","B",9.2,9.2)

"BLD",4838,"KRN","B",9.8,9.8)

"BLD",4838,"KRN","B",19,19)

"BLD",4838,"KRN","B",19.1,19.1)

"BLD",4838,"KRN","B",101,101)

"BLD",4838,"KRN","B",409.61,409.61)

"BLD",4838,"KRN","B",771,771)

"BLD",4838,"KRN","B",870,870)

"BLD",4838,"KRN","B",8989.51,8989.51)

"BLD",4838,"KRN","B",8989.52,8989.52)

"BLD",4838,"KRN","B",8994,8994)

"BLD",4838,"QUES",0)
^9.62^^
"BLD",4838,"REQB",0)
^9.611^1^1
"BLD",4838,"REQB",1,0)
SR*3.0*100^1
"BLD",4838,"REQB","B","SR*3.0*100",1)

"KRN",.402,2100,-1)
0^1
"KRN",.402,2100,0)
SROARPT^3040421.1422^^130^^^3040421
"KRN",.402,2100,"DIAB",1,0,130,0)
.02;T
"KRN",.402,2100,"DIAB",1,1,130.04,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.06,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.16,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.33,0)
.01;T
"KRN",.402,2100,"DIAB",1,1,130.41,0)
.01;T
"KRN",.402,2100,"DIAB",1,2,130.34,0)
.01;T
"KRN",.402,2100,"DIAB",1,2,130.47,0)
.01;T
"KRN",.402,2100,"DIAB",1,2,130.49,0)
.01;T
"KRN",.402,2100,"DIAB",2,0,130,0)
.31;T
"KRN",.402,2100,"DIAB",2,1,130.04,0)
1;T
"KRN",.402,2100,"DIAB",2,1,130.06,0)
.05;T
"KRN",.402,2100,"DIAB",2,1,130.16,0)
2;T
"KRN",.402,2100,"DIAB",2,1,130.33,0)
1;T
"KRN",.402,2100,"DIAB",2,1,130.41,0)
3;T
"KRN",.402,2100,"DIAB",2,2,130.34,0)
4;T
"KRN",.402,2100,"DIAB",2,2,130.47,0)
1;T
"KRN",.402,2100,"DIAB",2,2,130.49,0)
1;T
"KRN",.402,2100,"DIAB",3,0,130,0)
.32;T
"KRN",.402,2100,"DIAB",3,1,130.04,0)
3;T
"KRN",.402,2100,"DIAB",3,1,130.06,0)
24;T
"KRN",.402,2100,"DIAB",3,1,130.41,0)
1;T
"KRN",.402,2100,"DIAB",3,2,130.34,0)
2;T
"KRN",.402,2100,"DIAB",3,2,130.49,0)
2;T
"KRN",.402,2100,"DIAB",4,0,130,0)
.34;T
"KRN",.402,2100,"DIAB",4,1,130.04,0)
4;T
"KRN",.402,2100,"DIAB",4,1,130.06,0)
41;T
"KRN",.402,2100,"DIAB",4,1,130.41,0)
2;T
"KRN",.402,2100,"DIAB",4,2,130.34,0)
3;T
"KRN",.402,2100,"DIAB",5,0,130,0)
.345;T
"KRN",.402,2100,"DIAB",5,1,130.06,0)
42;T
"KRN",.402,2100,"DIAB",5,2,130.34,0)
5;T
"KRN",.402,2100,"DIAB",6,0,130,0)
.33;T
"KRN",.402,2100,"DIAB",6,1,130.06,0)
3;T
"KRN",.402,2100,"DIAB",7,0,130,0)
.21;T
"KRN",.402,2100,"DIAB",7,1,130.06,0)
4;T
"KRN",.402,2100,"DIAB",8,0,130,0)
.24;T
"KRN",.402,2100,"DIAB",8,1,130.06,0)
5;T
"KRN",.402,2100,"DIAB",9,0,130,0)
1.13;T
"KRN",.402,2100,"DIAB",9,1,130.06,0)
6;T
"KRN",.402,2100,"DIAB",10,0,130,0)
.46;T
"KRN",.402,2100,"DIAB",10,1,130.06,0)
7;T
"KRN",.402,2100,"DIAB",11,0,130,0)
.37;T
"KRN",.402,2100,"DIAB",11,1,130.06,0)
8;T
"KRN",.402,2100,"DIAB",12,0,130,0)
26;T
"KRN",.402,2100,"DIAB",12,1,130.06,0)
9;T
"KRN",.402,2100,"DIAB",13,0,130,0)
.42;T
"KRN",.402,2100,"DIAB",13,1,130.06,0)
10;T
"KRN",.402,2100,"DIAB",14,0,130,0)
.375;T
"KRN",.402,2100,"DIAB",14,1,130.06,0)
11;T
"KRN",.402,2100,"DIAB",15,0,130,0)
.36;T
"KRN",.402,2100,"DIAB",15,1,130.06,0)
12;T
"KRN",.402,2100,"DIAB",16,0,130,0)
.293;T
"KRN",.402,2100,"DIAB",16,1,130.06,0)
21;T
"KRN",.402,2100,"DIAB",17,0,130,0)
.27;T
"KRN",.402,2100,"DIAB",17,1,130.06,0)
39;T
"KRN",.402,2100,"DIAB",18,0,130,0)
.25;T
"KRN",.402,2100,"DIAB",18,1,130.06,0)
22;T
"KRN",.402,2100,"DIAB",19,0,130,0)
.255;T
"KRN",.402,2100,"DIAB",19,1,130.06,0)
17;T
"KRN",.402,2100,"DIAB",20,0,130,0)
1.11;T
"KRN",.402,2100,"DIAB",20,1,130.06,0)
18;T
"KRN",.402,2100,"DIAB",21,0,130,0)
1.12;T
"KRN",.402,2100,"DIAB",21,1,130.06,0)
25;T
"KRN",.402,2100,"DIAB",22,0,130,0)
1.19;T
"KRN",.402,2100,"DIAB",22,1,130.06,0)
26;T
"KRN",.402,2100,"DIAB",23,0,130,0)
1.2;T
"KRN",.402,2100,"DIAB",23,1,130.06,0)
27;T
"KRN",.402,2100,"DIAB",24,0,130,0)
.28;T
"KRN",.402,2100,"DIAB",24,1,130.06,0)
29;T
"KRN",.402,2100,"DIAB",25,1,130.06,0)
43;T
"KRN",.402,2100,"DIAB",26,1,130.06,0)
34;T
"KRN",.402,2100,"DIAB",27,1,130.06,0)
35;T
"KRN",.402,2100,"DIAB",28,1,130.06,0)
44;T
"KRN",.402,2100,"DIAB",29,1,130.06,0)
38;T
"KRN",.402,2100,"DR",1,130)
.02T~;.31T~;.32T~;.34T~;.345T~;.33T~;.21T~;.24T~;1.13T~;.46T~;.37T~;26T~;.42T~;.375T~;.36T~;.293T~;.27T~;.25T~;.255T~;1.11T~;1.12T~;1.19T~;1.2T~;.28T~;
"KRN",.402,2100,"DR",2,130.04)
.01T~;1T~;3T~;4T~;
"KRN",.402,2100,"DR",2,130.06)
.01T~;.05T~;24T~;41T~;42T~;3T~;4T~;5T~;6T~;7T~;8T~;9T~;10T~;11T~;12T~;21T~;39T~;22T~;17T~;18T~;25T~;26T~;27T~;29T~;43T~;34T~;35T~;44T~;38T~;Q;
"KRN",.402,2100,"DR",2,130.16)
.01T~;2T~;
"KRN",.402,2100,"DR",2,130.33)
.01T~;1T~;
"KRN",.402,2100,"DR",2,130.41)
.01T~;3T~;1T~;2T~;
"KRN",.402,2100,"DR",3,130.34)
.01T~;4T~;2T~;3T~;5T~;
"KRN",.402,2100,"DR",3,130.47)
.01T~;1T~;
"KRN",.402,2100,"DR",3,130.49)
.01T~;1T~;2T~;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",167,-1)
1^1
"PKG",167,0)
SURGERY^SR^SURGICAL DATA COLLECTION AND OPERATIONS SCHEDULING
"PKG",167,20,0)
^9.402P^^
"PKG",167,22,0)
^9.49I^1^1
"PKG",167,22,1,0)
3.0^2930624^2930811
"PKG",167,22,1,"PAH",1,0)
128^3040422
"PKG",167,22,1,"PAH",1,1,0)
^^20^20^3040422
"PKG",167,22,1,"PAH",1,1,1,0)
This patch addresses follow-up issues related to the Surgery Electronic 
"PKG",167,22,1,"PAH",1,1,2,0)
Signature for Operative Reports patch (SR*3*100).
"PKG",167,22,1,"PAH",1,1,3,0)
 
"PKG",167,22,1,"PAH",1,1,4,0)
1. Converted documents for historical surgical/non-OR cases are stored in 
"PKG",167,22,1,"PAH",1,1,5,0)
   the TIU DOCUMENT file (#8925) with a status of COMPLETED, but they 
"PKG",167,22,1,"PAH",1,1,6,0)
   have no signature date. Therefore, when one of these converted
"PKG",167,22,1,"PAH",1,1,7,0)
   documents is printed, the following line is printed at the end of the
"PKG",167,22,1,"PAH",1,1,8,0)
   document text:
"PKG",167,22,1,"PAH",1,1,9,0)
 
"PKG",167,22,1,"PAH",1,1,10,0)
**DRAFT COPY - DRAFT COPY -- ABOVE NOTE IS UNSIGNED-- DRAFT COPY - DRAFT COPY**
"PKG",167,22,1,"PAH",1,1,11,0)
 
"PKG",167,22,1,"PAH",1,1,12,0)
   This patch modifies the routine SROESPR1 to prevent the display of this
"PKG",167,22,1,"PAH",1,1,13,0)
   line if the document has a status of COMPLETED. See NOIS
"PKG",167,22,1,"PAH",1,1,14,0)
   FAR-0104-40622.
"PKG",167,22,1,"PAH",1,1,15,0)
 
"PKG",167,22,1,"PAH",1,1,16,0)
2. The input template SROARPT is used by the Anesthesia Report [SROARPT] 
"PKG",167,22,1,"PAH",1,1,17,0)
   option to edit fields that are part of the Anesthesia Report. This 
"PKG",167,22,1,"PAH",1,1,18,0)
   patch modifies this input template to remove the INTRAOPERATIVE
"PKG",167,22,1,"PAH",1,1,19,0)
   OCCURRENCES field (#1.14) and the POSTOP OCCURRENCE field (#1.16) since
"PKG",167,22,1,"PAH",1,1,20,0)
   these two fields do not appear on the Anesthesia Report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SROESPR1")
0^1^B64764154
"RTN","SROESPR1",1,0)
SROESPR1 ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 04/21/04  12:08 PM ]
"RTN","SROESPR1",2,0)
 ;;3.0; Surgery ;**100,128**;24 Jun 93
"RTN","SROESPR1",3,0)
 ;
"RTN","SROESPR1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESPR1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESPR1",6,0)
 ;**         are prohibited.
"RTN","SROESPR1",7,0)
 ;
"RTN","SROESPR1",8,0)
 ; Reference to EXTRACT^TIULQ supported by DBIA #2693
"RTN","SROESPR1",9,0)
 ;
"RTN","SROESPR1",10,0)
 ; This routine was cloned in part or in whole from TIUPRPN1.
"RTN","SROESPR1",11,0)
PRINT(SRFLAG,SRSPG) ; Print Summary
"RTN","SROESPR1",12,0)
 ; ^TMP("SRPR",$J) is array of records passed by reference
"RTN","SROESPR1",13,0)
 ; SRFLAG=1 --> Chart Copy     SRSPG=1 --> Contiguous
"RTN","SROESPR1",14,0)
 ; SRFLAG=0 --> Work Copy      SRSPG=0 --> Fresh Page- each note
"RTN","SROESPR1",15,0)
 N SRI,SRJ,SRPAGE,SRFOOT,SRK,SRDA,SRCONT,SRPGRP,SRTYP
"RTN","SROESPR1",16,0)
 N SRPFHDR,SRPFNBR,SROPAGE
"RTN","SROESPR1",17,0)
 S SRFLAG=+$G(SRFLAG),SRSPG=+$G(SRSPG)
"RTN","SROESPR1",18,0)
 S SRI=0 F  S SRI=$O(^TMP("SRPR",$J,SRI)) Q:SRI=""  D  Q:'SRCONT
"RTN","SROESPR1",19,0)
 . N DFN,SR,SRERR
"RTN","SROESPR1",20,0)
 . I SRI["$" S SRPGRP=$P(SRI,"$"),SRPFHDR=$P($P(SRI,";"),"$",2)
"RTN","SROESPR1",21,0)
 . E  S SRPFHDR="Surgery Reports"
"RTN","SROESPR1",22,0)
 . I $G(SRPGRP)'=2 S SRSPG=0
"RTN","SROESPR1",23,0)
 . S DFN=$P(SRI,";",2)
"RTN","SROESPR1",24,0)
 . D PAT^SROESPR(.SRFOOT,DFN)
"RTN","SROESPR1",25,0)
 . I +$G(SRSPG) D HEADER^SROESPR2(.SRFOOT,SRFLAG,.SRPFHDR)
"RTN","SROESPR1",26,0)
 . S SRJ=0 F  S SRJ=$O(^TMP("SRPR",$J,SRI,SRJ)) Q:'SRJ  D  Q:'SRCONT
"RTN","SROESPR1",27,0)
 . . S SRK=0 F  S SRK=$O(^TMP("SRPR",$J,SRI,SRJ,SRK)) Q:'SRK  D  Q:'+$G(SRCONT)
"RTN","SROESPR1",28,0)
 . . . N SRERR1,SRW K SRCONT1 S SRPFNBR=^(SRK)
"RTN","SROESPR1",29,0)
 . . . ; If the document has been deleted, QUIT
"RTN","SROESPR1",30,0)
 . . . D EXTRACT^TIULQ(SRK,"SRW",.SRERR1,".01") I $P($G(SRERR1),"^")=1 S SRCONT=1 Q
"RTN","SROESPR1",31,0)
 . . . I '+$G(SRSPG) D HEADER^SROESPR2(.SRFOOT,SRFLAG,.SRPFHDR)
"RTN","SROESPR1",32,0)
 . . . S SRDA=SRK
"RTN","SROESPR1",33,0)
 . . . D REPORT(SRDA) Q:'+$G(SRCONT)
"RTN","SROESPR1",34,0)
 . . . I '+$G(SRSPG) K SRCONT1 D SETCONT(1)
"RTN","SROESPR1",35,0)
 . . . I $E(IOST)="C",'$O(^TMP("SRPR",$J,SRI,SRJ,SRK)) S SRCONT=0
"RTN","SROESPR1",36,0)
 . Q:'SRCONT  I $E(IOST)="C" S SRCONT=$$STOP^SROESPR2() Q:'SRCONT
"RTN","SROESPR1",37,0)
 . I +$G(SRSPG),$E(IOST)'="C" K SRCONT1 D SETCONT(1)
"RTN","SROESPR1",38,0)
 Q
"RTN","SROESPR1",39,0)
REPORT(SRDA) ; Report Text
"RTN","SROESPR1",40,0)
 N DIW,DIWF,DIWL,DIWR,DIWT,SRERR,SR,SRI,SRLINE,X,Z,SRY,LOC
"RTN","SROESPR1",41,0)
 K ^TMP("SRLQ",$J)
"RTN","SROESPR1",42,0)
 S SRLINE=0
"RTN","SROESPR1",43,0)
 D EXTRACT^TIULQ(+SRDA,"^TMP(""SRLQ"",$J)",.SRERR,"",SRLINE,1)
"RTN","SROESPR1",44,0)
 I +$G(SRERR) W !,$P(SRERR,U,2) Q
"RTN","SROESPR1",45,0)
 Q:'$D(^TMP("SRLQ",$J))
"RTN","SROESPR1",46,0)
 S SRY=4,SRCONT=1
"RTN","SROESPR1",47,0)
 D SETCONT() Q:'SRCONT
"RTN","SROESPR1",48,0)
 W "NOTE DATED: "
"RTN","SROESPR1",49,0)
 W $$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,1301,"I"),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",50,0)
 W ?30,$$UP^XLFSTR(^TMP("SRLQ",$J,SRDA,.01,"E")),!
"RTN","SROESPR1",51,0)
 I +$G(^TMP("SRLQ",$J,SRDA,1205,"I")) D
"RTN","SROESPR1",52,0)
 .S LOC=$G(^TMP("SRLQ",$J,SRDA,1205,"I")) Q:'$D(^SC(LOC,0))
"RTN","SROESPR1",53,0)
 .W $S($P(^SC(LOC,0),U,3)="W":"ADMITTED: ",1:"VISIT: ")
"RTN","SROESPR1",54,0)
 .W $$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,.07,"I"),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",55,0)
 .W " ",$G(^TMP("SRLQ",$J,SRDA,1205,"E"))
"RTN","SROESPR1",56,0)
 I ^TMP("SRLQ",$J,SRDA,1701,"E")]"" W !,"SUBJECT: ",^("E"),!
"RTN","SROESPR1",57,0)
 S SRCONT1=1
"RTN","SROESPR1",58,0)
 I $D(^TMP("SRLQ",$J,SRDA,"PROBLEM")) D  Q:'SRCONT
"RTN","SROESPR1",59,0)
 .D SETCONT() Q:'SRCONT
"RTN","SROESPR1",60,0)
 .W !,"ASSOCIATED PROBLEMS:"
"RTN","SROESPR1",61,0)
 .N SRI S SRI=0
"RTN","SROESPR1",62,0)
 .F  S SRI=$O(^TMP("SRLQ",$J,SRDA,"PROBLEM",SRI)) Q:'SRI  D  Q:'SRCONT
"RTN","SROESPR1",63,0)
 ..W !,^(SRI,0)
"RTN","SROESPR1",64,0)
 ..D SETCONT() Q:'SRCONT
"RTN","SROESPR1",65,0)
 W !
"RTN","SROESPR1",66,0)
 ;
"RTN","SROESPR1",67,0)
 S SRI=0,DIWF="WN",DIWL=1,DIWR=79 K ^UTILITY($J,"W")
"RTN","SROESPR1",68,0)
 F  S SRI=$O(^TMP("SRLQ",$J,SRDA,"TEXT",SRI)) Q:SRI'>0  D  Q:'SRCONT  ; D ^DIWW
"RTN","SROESPR1",69,0)
 . D SETCONT() Q:'SRCONT
"RTN","SROESPR1",70,0)
 . S X=^TMP("SRLQ",$J,SRDA,"TEXT",SRI,0) S:X="" X=" " D ^DIWP
"RTN","SROESPR1",71,0)
 D ^DIWW K ^UTILITY($J,"W")
"RTN","SROESPR1",72,0)
 Q:'SRCONT
"RTN","SROESPR1",73,0)
RPTSIG ; Signature should be on bottom of form, Addenda on Subsequent pages
"RTN","SROESPR1",74,0)
 N AUTHOR,EXPSIGNR,EXPCOSNR,SIGNDATE,SIGNEDBY,SIGNNAME,SIGTITL,SIGNMODE
"RTN","SROESPR1",75,0)
 N COSGDATE,COSGEDBY,COSGNAME,COSGTITL,COSGMODE,SIGCHRT,COSCHRT,SRLINE
"RTN","SROESPR1",76,0)
 S $P(SRLINE,"-",81)=""
"RTN","SROESPR1",77,0)
 S AUTHOR=$G(^TMP("SRLQ",$J,SRDA,1202,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",78,0)
 S EXPSIGNR=$G(^TMP("SRLQ",$J,SRDA,1204,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",79,0)
 S EXPCOSNR=$G(^TMP("SRLQ",$J,SRDA,1208,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",80,0)
 S SIGNDATE=$G(^TMP("SRLQ",$J,SRDA,1501,"I"))
"RTN","SROESPR1",81,0)
 S SIGNEDBY=$G(^TMP("SRLQ",$J,SRDA,1502,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",82,0)
 S SIGNNAME=$G(^TMP("SRLQ",$J,SRDA,1503,"E"))
"RTN","SROESPR1",83,0)
 S SIGTITL=$G(^TMP("SRLQ",$J,SRDA,1504,"E"))
"RTN","SROESPR1",84,0)
 S SIGNMODE=$G(^TMP("SRLQ",$J,SRDA,1505,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",85,0)
 S COSGDATE=$G(^TMP("SRLQ",$J,SRDA,1507,"I"))
"RTN","SROESPR1",86,0)
 S COSGEDBY=$G(^TMP("SRLQ",$J,SRDA,1508,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",87,0)
 S COSGNAME=$G(^TMP("SRLQ",$J,SRDA,1509,"E"))
"RTN","SROESPR1",88,0)
 S COSGTITL=$G(^TMP("SRLQ",$J,SRDA,1510,"E"))
"RTN","SROESPR1",89,0)
 S COSGMODE=$G(^TMP("SRLQ",$J,SRDA,1511,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",90,0)
 S SIGCHRT=$G(^TMP("SRLQ",$J,SRDA,1512,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",91,0)
 S COSCHRT=$G(^TMP("SRLQ",$J,SRDA,1513,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",92,0)
 D SETCONT() Q:'SRCONT  W !
"RTN","SROESPR1",93,0)
 D SIGBLK Q:'SRCONT
"RTN","SROESPR1",94,0)
ADDENDA ; Surgery Reports Addenda
"RTN","SROESPR1",95,0)
 N DIW,DIWF,DIWL,DIWR,DIWT,X,Z,SRI,SRADD
"RTN","SROESPR1",96,0)
 S SRADD=0,DIWF="WN",DIWL=1,DIWR=79 K ^UTILITY($J,"W")
"RTN","SROESPR1",97,0)
 F  S SRADD=$O(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD)) Q:SRADD'>0  D  Q:'SRCONT
"RTN","SROESPR1",98,0)
 . S SRY=4 D SETCONT() Q:'SRCONT
"RTN","SROESPR1",99,0)
 . W !!,$$DATE^SROESPR(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1301,"I"),"MM/DD/CCYY HR:MIN"),?21,"ADDENDUM"
"RTN","SROESPR1",100,0)
 . S SRI=0
"RTN","SROESPR1",101,0)
 . F  S SRI=$O(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,"TEXT",SRI)) Q:SRI'>0  D  Q:'SRCONT
"RTN","SROESPR1",102,0)
 . . D SETCONT() Q:'SRCONT
"RTN","SROESPR1",103,0)
 . . S X=^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,"TEXT",SRI,0) S:X="" X=" " D ^DIWP
"RTN","SROESPR1",104,0)
 . D ^DIWW
"RTN","SROESPR1",105,0)
 . D:SRCONT ADDENSIG
"RTN","SROESPR1",106,0)
 K ^UTILITY($J,"W")
"RTN","SROESPR1",107,0)
 ; Write 2 linefeeds between records
"RTN","SROESPR1",108,0)
 Q:'SRCONT  W !!
"RTN","SROESPR1",109,0)
 Q
"RTN","SROESPR1",110,0)
ADDENSIG ;
"RTN","SROESPR1",111,0)
 N AUTHOR,EXPSIGNR,ATTNDING,SIGNDATE,SIGNEDBY,SIGNNAME,SIGNMODE
"RTN","SROESPR1",112,0)
 N COSGDATE,COSGEDBY,COSGNAME,COSGMODE,SRLINE S $P(SRLINE,"-",80)=""
"RTN","SROESPR1",113,0)
 S AUTHOR=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1202,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",114,0)
 S EXPSIGNR=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1204,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",115,0)
 S ATTNDING=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1209,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",116,0)
 S SIGNDATE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1501,"I"))
"RTN","SROESPR1",117,0)
 S SIGNEDBY=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1502,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",118,0)
 S SIGNNAME=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1503,"E"))
"RTN","SROESPR1",119,0)
 S SIGTITL=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1504,"E"))
"RTN","SROESPR1",120,0)
 S SIGNMODE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1505,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",121,0)
 S COSGDATE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1507,"I"))
"RTN","SROESPR1",122,0)
 S COSGEDBY=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1508,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",123,0)
 S COSGNAME=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1509,"E"))
"RTN","SROESPR1",124,0)
 S COSGTITL=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1510,"E"))
"RTN","SROESPR1",125,0)
 S COSGMODE=$G(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD,1511,"I"))_";"_$G(^("E"))
"RTN","SROESPR1",126,0)
 S SRY=11
"RTN","SROESPR1",127,0)
SIGBLK N SRGROOT S SRGROOT=$NA(^TMP("SRLQ",$J,SRDA))
"RTN","SROESPR1",128,0)
 I '+SIGNDATE D  D SETCONT() Q:'SRCONT
"RTN","SROESPR1",129,0)
 .I $$STATUS^SROESUTL(SRDA)'=7 W !,"**DRAFT COPY - DRAFT COPY -- ABOVE NOTE IS UNSIGNED-- DRAFT COPY - DRAFT COPY**"
"RTN","SROESPR1",130,0)
 I SIGNEDBY]"",(+SIGNEDBY'=+AUTHOR)  D
"RTN","SROESPR1",131,0)
 . W ?21,"Author:      ",$P(AUTHOR,";",2),!
"RTN","SROESPR1",132,0)
 I +SIGNDATE D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",133,0)
 . W ?18,"Signed by:",$S($P(SIGNMODE,";")="C":" /s/  ",1:" /es/ "),?34,$S(SIGNNAME]"":SIGNNAME,1:$P(SIGNEDBY,";",2))
"RTN","SROESPR1",134,0)
 . W !?34,SIGTITL
"RTN","SROESPR1",135,0)
 . I $L(SIGTITL)>30 W !?34
"RTN","SROESPR1",136,0)
 . E  W " "
"RTN","SROESPR1",137,0)
 . W $$DATE^SROESPR(+SIGNDATE,"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",138,0)
 . I '+$G(SRFLAG)!($E(IOST)="C") D
"RTN","SROESPR1",139,0)
 . . I $P($$BEEP^SROESPR(+SIGNEDBY),U) W !?34,"Analog Pager:  ",$P($$BEEP^SROESPR(+SIGNEDBY),U)
"RTN","SROESPR1",140,0)
 . . I $P($$BEEP^SROESPR(+SIGNEDBY),U,2) W !?34,"Digital Pager: ",$P($$BEEP^SROESPR(+SIGNEDBY),U,2)
"RTN","SROESPR1",141,0)
 I $G(^TMP("SRLQ",$J,SRDA,.05,"E"))="UNCOSIGNED" D
"RTN","SROESPR1",142,0)
 . W !?34,"**REQUIRES COSIGNATURE**",!
"RTN","SROESPR1",143,0)
 I +SIGCHRT,$P(SIGNMODE,";")="C" D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",144,0)
 . W !?2,"Marked signed on chart by:",?34,$P(SIGCHRT,";",2)
"RTN","SROESPR1",145,0)
 I +$G(SRADD) S SRGROOT=$NA(^TMP("SRLQ",$J,SRDA,"ZADD",SRADD))
"RTN","SROESPR1",146,0)
 I +$D(@SRGROOT@("EXTRASGNR")) D
"RTN","SROESPR1",147,0)
 . N SRI S SRI=0
"RTN","SROESPR1",148,0)
 . D SETCONT() Q:'SRCONT  W !?4,"Receipt Acknowledged By:"
"RTN","SROESPR1",149,0)
 . F  S SRI=$O(@SRGROOT@("EXTRASGNR",SRI)) Q:'SRI  D
"RTN","SROESPR1",150,0)
 . . I +$G(@SRGROOT@("EXTRASGNR",SRI,"DATE"))'>0 Q
"RTN","SROESPR1",151,0)
 . . I SRI>1 D SETCONT() Q:'SRCONT  W !
"RTN","SROESPR1",152,0)
 . . W ?29,"/es/ ",$G(@SRGROOT@("EXTRASGNR",SRI,"NAME"))
"RTN","SROESPR1",153,0)
 . . W !?34,$G(@SRGROOT@("EXTRASGNR",SRI,"TITLE"))
"RTN","SROESPR1",154,0)
 . . I $L($G(@SRGROOT@("EXTRASGNR",SRI,"TITLE")))>30 W !?34
"RTN","SROESPR1",155,0)
 . . E  W " "
"RTN","SROESPR1",156,0)
 . . W $$DATE^SROESPR($G(@SRGROOT@("EXTRASGNR",SRI,"DATE")),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",157,0)
 . . I '+$G(SRFLAG)!($E(IOST)="C") D
"RTN","SROESPR1",158,0)
 . . . N BEEP
"RTN","SROESPR1",159,0)
 . . . S BEEP=$$BEEP^SROESPR(+$G(@SRGROOT@("EXTRASGNR",SRI,"EXTRA")))
"RTN","SROESPR1",160,0)
 . . . I +BEEP W !?34,"Analog Pager:  ",$P(BEEP,U)
"RTN","SROESPR1",161,0)
 . . . I +$P(BEEP,U,2) W !?34,"Digital Pager: ",$P(BEEP,U,2)
"RTN","SROESPR1",162,0)
 . K @SRGROOT@("EXTRASGNR")
"RTN","SROESPR1",163,0)
 I +COSGDATE,(+COSGEDBY'=+SIGNEDBY) D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",164,0)
 . W !?16,"Cosigned by:",$S($P(COSGMODE,";")="C":" /s/  ",1:" /es/ "),?34,$S(COSGNAME]"":COSGNAME,1:$P(COSGEDBY,";",2))
"RTN","SROESPR1",165,0)
 . W !?34,COSGTITL," "
"RTN","SROESPR1",166,0)
 . W $$DATE^SROESPR(+COSGDATE,"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",167,0)
 . I '+$G(SRFLAG)!($E(IOST)="C") D
"RTN","SROESPR1",168,0)
 . . I $P($$BEEP^SROESPR(+COSGEDBY),U) W !?34,"Analog Pager: ",$P($$BEEP^SROESPR(+COSGEDBY),U)
"RTN","SROESPR1",169,0)
 . . I $P($$BEEP^SROESPR(+COSGEDBY),U,2) W !?34,"Digital Pager:",$P($$BEEP^SROESPR(+COSGEDBY),U,2)
"RTN","SROESPR1",170,0)
 I +COSCHRT,$P(COSGMODE,";")="C" D SETCONT() Q:'SRCONT  D
"RTN","SROESPR1",171,0)
 . W !,"Marked cosigned on chart by:",?34,$P(COSCHRT,";",2)
"RTN","SROESPR1",172,0)
 W !
"RTN","SROESPR1",173,0)
 K SRCONT1
"RTN","SROESPR1",174,0)
AMEND ; signature blocks of amender
"RTN","SROESPR1",175,0)
 S SRY=4 D SETCONT() Q:'SRCONT
"RTN","SROESPR1",176,0)
 I +$G(@SRGROOT@(1601,"I")) D
"RTN","SROESPR1",177,0)
 . W !!?12,"Amendment Filed:",?34,$$DATE^SROESPR(@SRGROOT@(1601,"I"),"MM/DD/CCYY HR:MIN")
"RTN","SROESPR1",178,0)
 . I $G(@SRGROOT@(1603,"E"))']"" D
"RTN","SROESPR1",179,0)
 . . W !!?29 F SRI=1:1:40 W "_"
"RTN","SROESPR1",180,0)
 . . W !?29,$$SIGNAME^SROESPR(@SRGROOT@(1602,"I"))
"RTN","SROESPR1",181,0)
 . . W !?29,$$SIGTITL^SROESPR(@SRGROOT@(1602,"I"))
"RTN","SROESPR1",182,0)
 . I $G(@SRGROOT@(1604,"E"))]"" D
"RTN","SROESPR1",183,0)
 . . W !?29,"/es/",?34,@SRGROOT@(1604,"E")
"RTN","SROESPR1",184,0)
 . . W !?34,@SRGROOT@(1605,"E")
"RTN","SROESPR1",185,0)
 Q
"RTN","SROESPR1",186,0)
SETCONT(SRHEAD) ;Does footer and sets SRCONT
"RTN","SROESPR1",187,0)
 S SRCONT=$$FOOTER^SROESPR2(.SRFOOT,SRFLAG,SRPFNBR,$G(SRHEAD),$G(SRCONT1),SRDA)
"RTN","SROESPR1",188,0)
 Q
"VER")
8.0^22.0
**END**
**END**
