Released SD*5.3*408 SEQ #325
Extracted from mail message
**KIDS**:SD*5.3*408^

**INSTALL NAME**
SD*5.3*408
"BLD",5894,0)
SD*5.3*408^SCHEDULING^0^3041217^y
"BLD",5894,1,0)
^^2^2^3041207^
"BLD",5894,1,1,0)
Dis-allow scheduling appointments on days where availablity has been 
"BLD",5894,1,2,0)
canceled via the option "SET UP A CLINIC".
"BLD",5894,4,0)
^9.64PA^^
"BLD",5894,"KRN",0)
^9.67PA^8989.52^19
"BLD",5894,"KRN",.4,0)
.4
"BLD",5894,"KRN",.401,0)
.401
"BLD",5894,"KRN",.402,0)
.402
"BLD",5894,"KRN",.403,0)
.403
"BLD",5894,"KRN",.5,0)
.5
"BLD",5894,"KRN",.84,0)
.84
"BLD",5894,"KRN",3.6,0)
3.6
"BLD",5894,"KRN",3.8,0)
3.8
"BLD",5894,"KRN",9.2,0)
9.2
"BLD",5894,"KRN",9.8,0)
9.8
"BLD",5894,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5894,"KRN",9.8,"NM",1,0)
SDM1^^0^B34474088
"BLD",5894,"KRN",9.8,"NM","B","SDM1",1)

"BLD",5894,"KRN",19,0)
19
"BLD",5894,"KRN",19.1,0)
19.1
"BLD",5894,"KRN",101,0)
101
"BLD",5894,"KRN",409.61,0)
409.61
"BLD",5894,"KRN",771,0)
771
"BLD",5894,"KRN",870,0)
870
"BLD",5894,"KRN",8989.51,0)
8989.51
"BLD",5894,"KRN",8989.52,0)
8989.52
"BLD",5894,"KRN",8994,0)
8994
"BLD",5894,"KRN","B",.4,.4)

"BLD",5894,"KRN","B",.401,.401)

"BLD",5894,"KRN","B",.402,.402)

"BLD",5894,"KRN","B",.403,.403)

"BLD",5894,"KRN","B",.5,.5)

"BLD",5894,"KRN","B",.84,.84)

"BLD",5894,"KRN","B",3.6,3.6)

"BLD",5894,"KRN","B",3.8,3.8)

"BLD",5894,"KRN","B",9.2,9.2)

"BLD",5894,"KRN","B",9.8,9.8)

"BLD",5894,"KRN","B",19,19)

"BLD",5894,"KRN","B",19.1,19.1)

"BLD",5894,"KRN","B",101,101)

"BLD",5894,"KRN","B",409.61,409.61)

"BLD",5894,"KRN","B",771,771)

"BLD",5894,"KRN","B",870,870)

"BLD",5894,"KRN","B",8989.51,8989.51)

"BLD",5894,"KRN","B",8989.52,8989.52)

"BLD",5894,"KRN","B",8994,8994)

"BLD",5894,"QUES",0)
^9.62^^
"BLD",5894,"REQB",0)
^9.611^1^1
"BLD",5894,"REQB",1,0)
SD*5.3*273^2
"BLD",5894,"REQB","B","SD*5.3*273",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
408^3041217
"PKG",16,22,1,"PAH",1,1,0)
^^2^2^3041217
"PKG",16,22,1,"PAH",1,1,1,0)
Dis-allow scheduling appointments on days where availablity has been 
"PKG",16,22,1,"PAH",1,1,2,0)
canceled via the option "SET UP A CLINIC".
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SDM1")
0^1^B34474088
"RTN","SDM1",1,0)
SDM1 ;SF/GFT - MAKE APPOINTMENT ; 27 Nov 2000 11:15 AM
"RTN","SDM1",2,0)
 ;;5.3;Scheduling;**32,167,168,80,223,263,273,408**;Aug 13, 1993
"RTN","SDM1",3,0)
1 L  Q:$D(SDXXX)  S CCXN=0 K MXOK,COV,SDPROT Q:DFN<0  S SC=+SC
"RTN","SDM1",4,0)
 S X1=DT,SDEDT=365 S:$D(^SC(SC,"SDP")) SDEDT=$P(^SC(SC,"SDP"),"^",2)
"RTN","SDM1",5,0)
 S X2=SDEDT D C^%DTC S SDEDT=X D WRT
"RTN","SDM1",6,0)
 I $D(^SC(SC,"SI")),$O(^("SI",0))>0 W !,*7,?8,"**** SPECIAL INSTRUCTIONS ****",! S %I=0 F %=0:1 S %I=$O(^SC(SC,"SI",%I)) Q:%I'>0  W ^(%I,0) W:% ! I '%,$O(^SC(SC,"SI",%I))>0 S POP=0 D SPIN Q:POP
"RTN","SDM1",7,0)
 I $D(SDINA),SDINA>DT D IN W !,?8,@SDMSG K SDMSG
"RTN","SDM1",8,0)
 G:SDMM RDTY^SDMM
"RTN","SDM1",9,0)
 ;
"RTN","SDM1",10,0)
ADT S:'$D(SDW) SDW=""
"RTN","SDM1",11,0)
 S SDSOH=$S('$D(^SC(SC,"SL")):0,$P(^("SL"),"^",8)']"":0,1:1),CCX=""
"RTN","SDM1",12,0)
 S SDONCE=$G(SDONCE)+1  ;Prevent repetitive iteration
"RTN","SDM1",13,0)
 S X=$S(SDONCE<2:$G(SDSDATE),1:"")  ;Use default date/time if specified as 'desired date'  
"RTN","SDM1",14,0)
 I 'X R !,"DATE/TIME: ",X:DTIME G:X="M"!(X="m") MORDIS^SDM0 I "^"[X D  Q
"RTN","SDM1",15,0)
 .;
"RTN","SDM1",16,0)
 .;Wait List Hook/teh patch 263
"RTN","SDM1",17,0)
 .;
"RTN","SDM1",18,0)
WL .I $D(SC) S SDWLFLG=0 D
"RTN","SDM1",19,0)
 ..I $D(^SDWL(409.32,"B",+SC)) S SDWLFLG=1
"RTN","SDM1",20,0)
 ..I 'SDWLFLG S SDWLDSS=$P($G(^SC(+SC,0)),U,7) I $D(^SDWL(409.31,"B",SDWLDSS)) S SDWLFLG=2
"RTN","SDM1",21,0)
 ..I SDWLFLG=1 S SDWLSC=$O(^SDWL(409.32,"B",+SC,0)) I $P(^SDWL(409.32,SDWLSC,0),U,4) S SDWLFLG=0
"RTN","SDM1",22,0)
 ..I SDWLFLG=2 S SDWLDS=$O(^SDWL(409.31,"E",DUZ(2),0)) I $D(^SDWL(409.31,SDWLDSS,"I",+SDWLDS,0)),$P(^(0),U,4) S SDWLFLG=0
"RTN","SDM1",23,0)
 ..I SDWLFLG D
"RTN","SDM1",24,0)
 ...K SDWLSC,SDWLDSS,SDWLDS,SDWLFLG
"RTN","SDM1",25,0)
 ...S SDWLOPT=1,SDWLERR=0 D OPT^SDWLE D EN^SDWLKIL
"RTN","SDM1",26,0)
 .Q
"RTN","SDM1",27,0)
 .;
"RTN","SDM1",28,0)
 I X="D"!(X="d") S X=$$REDDT() G:X>0 MORD2^SDM0 S X="" W "  ??",! G ADT
"RTN","SDM1",29,0)
 I X?1"?".E D  G ADT
"RTN","SDM1",30,0)
 .W !,"Enter a date/time for the appointment"
"RTN","SDM1",31,0)
 .W:$D(SD) " or a space to choose the same date/time as the patient you have just previously scheduled into this clinic"
"RTN","SDM1",32,0)
 .W ".",!,"You may also select 'M' to display the next month's availability or"
"RTN","SDM1",33,0)
 .W !,"'D' to specify an earlier or later date to begin the availability display."
"RTN","SDM1",34,0)
 I X=" ",$D(SD),SD S Y=SD D AT^SDUTL W Y S Y=SD G OVR
"RTN","SDM1",35,0)
 I $E($P(X,"@",2),1,4)?1.4"0" K %DT S X=$P(X,"@"),X=$S($L(X):X,1:"T"),%DT="XF" D ^%DT G ADT:Y'>0 S X1=Y,X2=-1 D C^%DTC S X=X_.24
"RTN","SDM1",36,0)
 K %DT S %DT="TXEF" D ^%DT
"RTN","SDM1",37,0)
 ;SD*5.3*408  verify that day hasn't been canceled via "SET UP A CLINIC"
"RTN","SDM1",38,0)
 I $G(^SC(+SC,"ST",$P(Y,"."),1))'="",^SC(+SC,"ST",$P(Y,"."),1)'["[" D  G ADT
"RTN","SDM1",39,0)
 .W !,"There is no availability for this date/time.",!
"RTN","SDM1",40,0)
 I $P(Y,".",2)=24 S X1=$P(Y,"."),X2=1 D C^%DTC S Y=X_".000001"
"RTN","SDM1",41,0)
OVR I $D(^HOLIDAY($P(Y,"."),0)),'SDSOH W *7,?50,$P(^(0),U,2),"??" K SDSDATE G ADT
"RTN","SDM1",42,0)
 I $D(SDINA),$P(Y,".")'<SDINA,$S('$D(SDRE):1,SDRE>$P(Y,".")!('SDRE):1,1:0) D IN W !,*7,@SDMSG K SDMSG K SDSDATE G ADT
"RTN","SDM1",43,0)
 I Y#1=0 K SDSDATE G 1
"RTN","SDM1",44,0)
 I $P(Y,".")'<SDEDT W !,*7,"EXCEEDS MAXIMUM DAYS FOR FUTURE APPOINTMENT!!",*7 K SDSDATE G ADT
"RTN","SDM1",45,0)
 ;
"RTN","SDM1",46,0)
EN1 S (X,SD)=Y,SM=0 D DOW
"RTN","SDM1",47,0)
 F S=$P(SD,"."):0 S S=+$O(^DPT(DFN,"S",S)) Q:$P(S,".")-($P(SD,"."))  S I=+^(S,0) G ^SDM2:$P(^(0),U,2)'["C"
"RTN","SDM1",48,0)
 ;
"RTN","SDM1",49,0)
PRECAN I $D(^DPT(DFN,"S",SD,0)),$P(^(0),U,2)["P" S %=1 W !,"THIS TIME WAS PREVIOUSLY CANCELLED BY THE PATIENT",!,"ARE YOU SURE THAT YOU WANT TO PROCEED" D YN^DICN W:'% !,"ANSWER WITH (Y)ES OR (N)O" I (%-1) K SDSDATE G ADT
"RTN","SDM1",50,0)
 W !
"RTN","SDM1",51,0)
 ;
"RTN","SDM1",52,0)
S I '$D(^SC(SC,"ST",$P(SD,"."),1)) S SS=+$O(^SC(+SC,"T"_Y,SD)) G XW:SS'>0,XW:^(SS,1)="" S ^SC(+SC,"ST",$P(SD,"."),1)=$E($P($T(DAY),U,Y+2),1,2)_" "_$E(SD,6,7)_$J("",SI+SI-6)_^(1),^(0)=$P(SD,".")
"RTN","SDM1",53,0)
LEN I $P(SL,U,2)]"" W !,"LENGTH OF APPOINTMENT (IN MINUTES): ",+SL,"// " R S:DTIME I S]"" G:$L(S)>3 LEN Q:U[S  S POP=0 D L G LEN:POP,S:S\5*5'=S,S:S>360,S:S<5 S SL=S_U_$P(SL,U,2,99)
"RTN","SDM1",54,0)
 ;
"RTN","SDM1",55,0)
SC S SDLOCK=$S('$D(SDLOCK):1,1:SDLOCK+1) G:SDLOCK>9 LOCK
"RTN","SDM1",56,0)
 L ^SC(SC,"ST",$P(SD,"."),1):5 G:'$T SC
"RTN","SDM1",57,0)
 S SDLOCK=0,S=^SC(SC,"ST",$P(SD,"."),1)
"RTN","SDM1",58,0)
 S I=SD#1-SB*100,ST=I#1*SI\.6+($P(I,".")*SI),SS=SL*HSI/60*SDDIF+ST+ST
"RTN","SDM1",59,0)
 G X:(I<1!'$F(S,"["))&(S'["CAN")
"RTN","SDM1",60,0)
 I SM<7 S %=$F(S,"[",SS-1) S:'%!($P(SL,"^",6)<3) %=999 I $F(S,"]",SS)'<%!(SDDIF=2&$E(S,ST+ST+1,SS-1)["[") S SM=7
"RTN","SDM1",61,0)
 ;
"RTN","SDM1",62,0)
SP I ST+ST>$L(S),$L(S)<80 S S=S_" " G SP
"RTN","SDM1",63,0)
 S SDNOT=1
"RTN","SDM1",64,0)
 F I=ST+ST:SDDIF:SS-SDDIF S ST=$E(S,I+1) S:ST="" ST=" " S Y=$E(STR,$F(STR,ST)-2) G C:S["CAN"!(ST="X"&($D(^SC(+SC,"ST",$P(SD,"."),"CAN")))),X:Y="" S:Y'?1NL&(SM<6) SM=6 S ST=$E(S,I+2,999) S:ST="" ST=" " S S=$E(S,1,I)_Y_ST
"RTN","SDM1",65,0)
 Q:SDMM  G OK^SDM1A:SM#9=0,^SDM3:$P(SL,U,7)]""&('$D(MXOK))
"RTN","SDM1",66,0)
 ;
"RTN","SDM1",67,0)
E G:'$D(^XUSEC("SDOB",DUZ)) NOOB
"RTN","SDM1",68,0)
 S %=2 W *7,!,$E($T(@SM),5,99),"...OK" D YN^DICN
"RTN","SDM1",69,0)
 I '% W !,"RESPOND YES OR NO" G E
"RTN","SDM1",70,0)
 S SM=9 G SC:'(%-1) K SDSDATE G 1
"RTN","SDM1",71,0)
 ;
"RTN","SDM1",72,0)
LOCK Q:SDMM  W !,*7,"ANOTHER USER HAS LOCKED THIS DATE - TRY AGAIN LATER" Q
"RTN","SDM1",73,0)
 ;
"RTN","SDM1",74,0)
6 ;;OVERBOOK!
"RTN","SDM1",75,0)
7 ;;THAT TIME IS NOT WITHIN SCHEDULED PERIOD!
"RTN","SDM1",76,0)
C S POP=1 W !,*7,"CAN'T BOOK WITHIN A CANCELLED TIME PERIOD!",!
"RTN","SDM1",77,0)
 Q:SDMM  K SDSDATE G 1
"RTN","SDM1",78,0)
 ;
"RTN","SDM1",79,0)
DAY ;;^SUN^MON^TUES^WEDNES^THURS^FRI^SATUR
"RTN","SDM1",80,0)
 ;
"RTN","SDM1",81,0)
DOW S %=$E(X,1,3),Y=$E(X,4,5),Y=Y>2&'(%#4)+$E("144025036146",Y)
"RTN","SDM1",82,0)
 F %=%:-1:281 S Y=%#4=1+1+Y
"RTN","SDM1",83,0)
 S Y=$E(X,6,7)+Y#7 Q
"RTN","SDM1",84,0)
 ;
"RTN","SDM1",85,0)
X I SDMM S POP=1 Q
"RTN","SDM1",86,0)
 G:I<1 XW
"RTN","SDM1",87,0)
 S:Y'?1NL&(SM<6) SM=6
"RTN","SDM1",88,0)
 G OK^SDM1A:SM#9=0,^SDM3:$P(SL,U,7)]""&('$D(MXOK))
"RTN","SDM1",89,0)
XW W *7,"  WHEN??" K SDSDATE G 1
"RTN","SDM1",90,0)
 ;
"RTN","SDM1",91,0)
NOOB W !,"NO OPEN SLOTS THEN",*7 K SDSDATE G 1
"RTN","SDM1",92,0)
 ;
"RTN","SDM1",93,0)
WRT W !,+SL," MINUTE APPOINTMENTS "
"RTN","SDM1",94,0)
 W $S($P(SL,U,2)["V":"(VARIABLE LENGTH)",1:"") Q
"RTN","SDM1",95,0)
 ;
"RTN","SDM1",96,0)
L S SDSL=$S($P(SL,"^",6)]"":60/$P(SL,"^",6),1:"") Q:'SDSL
"RTN","SDM1",97,0)
 I S\(SDSL)*(SDSL)'=S W *7,!,"Appt. length must = or be a multiple of the increment minutes per hour (",SDSL,")",! S POP=1
"RTN","SDM1",98,0)
 Q
"RTN","SDM1",99,0)
 ;
"RTN","SDM1",100,0)
IN S SDHY=$S($D(Y):Y,1:""),Y=SDINA D DTS^SDUTL S Y1=Y,Y=SDRE
"RTN","SDM1",101,0)
 D:Y DTS^SDUTL
"RTN","SDM1",102,0)
 S SDMSG="""*** Note: Clinic is scheduled to be inactivated on "","_""""_Y1_""""_$S(SDRE:",!,?10,"_""" and reactivated on "","_""""_Y_"""",1:""),Y=SDHY K Y1,SDHY
"RTN","SDM1",103,0)
 Q
"RTN","SDM1",104,0)
 ;
"RTN","SDM1",105,0)
SPIN W !,"There are more special instructions. Do you want to display them"
"RTN","SDM1",106,0)
 S %=2 D YN^DICN
"RTN","SDM1",107,0)
 I '% W !,"Enter Y to see the remaining special instructions, or N if you don't wish to see them" G SPIN
"RTN","SDM1",108,0)
 I (%-1) S POP=1 Q
"RTN","SDM1",109,0)
 W !,^SC(SC,"SI",%I,0),! Q
"RTN","SDM1",110,0)
 ;
"RTN","SDM1",111,0)
REDDT() ;Prompt for availability redisplay date
"RTN","SDM1",112,0)
 N %DT,X,Y
"RTN","SDM1",113,0)
 S %DT="AEX"
"RTN","SDM1",114,0)
 S %DT("A")="DATE TO BEGIN THE RE-DISPLAY OF CLINIC AVAILABILITY: "
"RTN","SDM1",115,0)
 W ! D ^%DT
"RTN","SDM1",116,0)
 Q Y
"VER")
8.0^22
**END**
**END**
