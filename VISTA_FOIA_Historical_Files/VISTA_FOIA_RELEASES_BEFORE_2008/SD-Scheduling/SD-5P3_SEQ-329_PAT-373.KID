Released SD*5.3*373 SEQ #329
Extracted from mail message
**KIDS**:SD*5.3*373^

**INSTALL NAME**
SD*5.3*373
"BLD",5572,0)
SD*5.3*373^SCHEDULING^0^3050104^y
"BLD",5572,1,0)
^^2^2^3041217^
"BLD",5572,1,1,0)
Fix problem reading date input and reporting of clinic activity and 
"BLD",5572,1,2,0)
availability on the Appointment List. 
"BLD",5572,4,0)
^9.64PA^^
"BLD",5572,"ABPKG")
n
"BLD",5572,"KRN",0)
^9.67PA^8989.52^19
"BLD",5572,"KRN",.4,0)
.4
"BLD",5572,"KRN",.401,0)
.401
"BLD",5572,"KRN",.402,0)
.402
"BLD",5572,"KRN",.403,0)
.403
"BLD",5572,"KRN",.5,0)
.5
"BLD",5572,"KRN",.84,0)
.84
"BLD",5572,"KRN",3.6,0)
3.6
"BLD",5572,"KRN",3.8,0)
3.8
"BLD",5572,"KRN",9.2,0)
9.2
"BLD",5572,"KRN",9.8,0)
9.8
"BLD",5572,"KRN",9.8,"NM",0)
^9.68A^2^1
"BLD",5572,"KRN",9.8,"NM",2,0)
SDAL0^^0^B34357046
"BLD",5572,"KRN",9.8,"NM","B","SDAL0",2)

"BLD",5572,"KRN",19,0)
19
"BLD",5572,"KRN",19.1,0)
19.1
"BLD",5572,"KRN",101,0)
101
"BLD",5572,"KRN",409.61,0)
409.61
"BLD",5572,"KRN",771,0)
771
"BLD",5572,"KRN",870,0)
870
"BLD",5572,"KRN",8989.51,0)
8989.51
"BLD",5572,"KRN",8989.52,0)
8989.52
"BLD",5572,"KRN",8994,0)
8994
"BLD",5572,"KRN","B",.4,.4)

"BLD",5572,"KRN","B",.401,.401)

"BLD",5572,"KRN","B",.402,.402)

"BLD",5572,"KRN","B",.403,.403)

"BLD",5572,"KRN","B",.5,.5)

"BLD",5572,"KRN","B",.84,.84)

"BLD",5572,"KRN","B",3.6,3.6)

"BLD",5572,"KRN","B",3.8,3.8)

"BLD",5572,"KRN","B",9.2,9.2)

"BLD",5572,"KRN","B",9.8,9.8)

"BLD",5572,"KRN","B",19,19)

"BLD",5572,"KRN","B",19.1,19.1)

"BLD",5572,"KRN","B",101,101)

"BLD",5572,"KRN","B",409.61,409.61)

"BLD",5572,"KRN","B",771,771)

"BLD",5572,"KRN","B",870,870)

"BLD",5572,"KRN","B",8989.51,8989.51)

"BLD",5572,"KRN","B",8989.52,8989.52)

"BLD",5572,"KRN","B",8994,8994)

"BLD",5572,"QUES",0)
^9.62^^
"BLD",5572,"REQB",0)
^9.611^2^1
"BLD",5572,"REQB",2,0)
SD*5.3*305^2
"BLD",5572,"REQB","B","SD*5.3*305",2)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
373^3050104
"PKG",16,22,1,"PAH",1,1,0)
^^2^2^3050104
"PKG",16,22,1,"PAH",1,1,1,0)
Fix problem reading date input and reporting of clinic activity and 
"PKG",16,22,1,"PAH",1,1,2,0)
availability on the Appointment List. 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SDAL0")
0^2^B34357046
"RTN","SDAL0",1,0)
SDAL0 ;ALB/GRR,TMP,MJK - APPOINTMENT LIST (CONTINUED FROM SDAL) ; 29 Jun 99  04:11PM
"RTN","SDAL0",2,0)
 ;;5.3;Scheduling;**28,37,106,149,171,177,193,305,373**;Aug 13, 1993
"RTN","SDAL0",3,0)
LOOP I 'VAUTC,$G(^SC(SC,"ST",SDD,1))["CANCELLED"  D  Q
"RTN","SDAL0",4,0)
 .S SDPAGE=1 D HED^SDAL
"RTN","SDAL0",5,0)
 .S SDPCT="Clinic cancelled for this date!"
"RTN","SDAL0",6,0)
 .W !!?(IOM-$L(SDPCT)\2),SDPCT
"RTN","SDAL0",7,0)
 I $$CHECK(),$$NCHECK(),$$ACTIVE() D
"RTN","SDAL0",8,0)
 .I VAUTC,SDCOPY>1 S VAUTC(SD)=SC
"RTN","SDAL0",9,0)
 .S SDPAGE=1 D HED^SDAL Q:SDEND  S SDPCT=0
"RTN","SDAL0",10,0)
 .S SDT=SDD F  S SDT=$O(^SC(SC,"S",SDT)) Q:'SDT!(SDT\1-SDD)!SDEND  D MORE
"RTN","SDAL0",11,0)
 .W ! D CCLK Q:SDEND
"RTN","SDAL0",12,0)
 .I 'SDPCT S SDPCT="No activity found for this clinic date!" W !!?(IOM-$L(SDPCT)\2),SDPCT
"RTN","SDAL0",13,0)
 S SDPAGE=1 Q
"RTN","SDAL0",14,0)
 ;
"RTN","SDAL0",15,0)
PTL N SDAPPT
"RTN","SDAL0",16,0)
 S DFN=+^SC(SC,"S",SDT,1,K,0),SDOI=$P(^(0),"^",4)
"RTN","SDAL0",17,0)
 S (SDAPPT,X)=$G(^DPT(DFN,"S",SDT,0))
"RTN","SDAL0",18,0)
 Q:$S('X:1,$P(X,"^",2)="NT":0,$P(X,"^",2)["C"!($P(X,"^",2)["N"):1,1:0)
"RTN","SDAL0",19,0)
 D ^VAUQWK,GETA
"RTN","SDAL0",20,0)
 I ($Y+7>IOSL) D HED^SDAL Q:SDEND
"RTN","SDAL0",21,0)
 I '$D(SDFS) S SDFS=1,X=PT D TM^SDROUT0 W !,$J(X,8)
"RTN","SDAL0",22,0)
 N SDCLY D CL^SDCO21(DFN,SDT,"",.SDCLY)
"RTN","SDAL0",23,0)
 N SDY S SDY=$Y
"RTN","SDAL0",24,0)
 W ! D:SDBC BARC^SDAL(85,$P(VAQK(2),"^"))
"RTN","SDAL0",25,0)
 ;check for Combat Vet
"RTN","SDAL0",26,0)
 N SDCV
"RTN","SDAL0",27,0)
 S SDCV=$$CVEDT^DGCV(DFN,$G(SDD))
"RTN","SDAL0",28,0)
 S SDCV=$P(SDCV,U,3)
"RTN","SDAL0",29,0)
 W !?3,$S($G(SDCV)=1:"(CV)",1:""),?9,$S($D(^SC(SC,"S",SDT,1,K,"OB")):"*",1:""),?10,$S(VAQK(1)]"":VAQK(1),1:"UNKNOWN PATIENT"),?41,$S(VAQK(2)]"":$E(VAQK(2),1,9),1:"")
"RTN","SDAL0",30,0)
 S INC=0 F SDZ=3,4,5 S X=SDZ(SDZ) D:X]"" TM^SDROUT0 S INC=SDZ#3*8+3 W ?48+INC,$J(X,8) W:INC<16 "  "
"RTN","SDAL0",31,0)
 I VAQK(12)]"" W !,?41,VAQK(12) W:VAQK(13)]"" !,?41,VAQK(13)
"RTN","SDAL0",32,0)
 W:SDOI]"" !,?15,SDOI W:SDEM]"" !,?15,SDEM,$S($D(SDCP):$P(^SC(SDCP,0),"^"),1:$P(^SC(SC,0),"^")),!,?15,SDEM1
"RTN","SDAL0",33,0)
 S SDX="" F I=7:1:9 I VAQK(I) S SDX=1 Q
"RTN","SDAL0",34,0)
 ;Primary Care information
"RTN","SDAL0",35,0)
 I +$G(SDPCMM) D TDATA^SDPPTEM(DFN,"",SDD,"P",15)
"RTN","SDAL0",36,0)
 ;I SDPCMM D TDATA^SDPPTEM(DFN,"",SDD,"P",15)
"RTN","SDAL0",37,0)
 ;I SDX W !,?15,"** Requires Special Survey Disposition **"
"RTN","SDAL0",38,0)
 ;; GAF SCORE CHECK
"RTN","SDAL0",39,0)
 N SDGAF,SDGAFST
"RTN","SDAL0",40,0)
 I $$MHCLIN^SDUTL2(SC),'($$COLLAT^SDUTL2(+VAQK(6))!$P(SDAPPT,U,11)) D
"RTN","SDAL0",41,0)
 . S SDGAF=$$NEWGAF^SDUTL2(DFN),SDGAFST=$P(SDGAF,"^")
"RTN","SDAL0",42,0)
 . W:SDGAFST !,?15,"** New GAF Score Required **"
"RTN","SDAL0",43,0)
 ;;
"RTN","SDAL0",44,0)
 I $O(SDCLY(0))  D
"RTN","SDAL0",45,0)
 .N PCL
"RTN","SDAL0",46,0)
 .S PCL=0
"RTN","SDAL0",47,0)
 .W !,?15,"** Required for facility workload credit => "
"RTN","SDAL0",48,0)
 .F  S PCL=$O(SDCLY(PCL)) Q:'PCL  W " ",SDCLAR(PCL)," "
"RTN","SDAL0",49,0)
 .W "**"
"RTN","SDAL0",50,0)
 I $P(VAQK(11),"^",2)]"" W !,?15,"Means Test: ** ",$P(VAQK(11),"^",2)," **" W "   Last Test: ",$$FDATE^SDUL1($P($$LST^DGMTU(DFN),U,2))
"RTN","SDAL0",51,0)
 S SDCOPS=$$LST^DGMTU(DFN,DT,2) I +SDCOPS W !,?15,"Co-Pay Status: ","**"_$P(SDCOPS,U,3)_"**"," Last Test: ",$$FDATE^SDUL1($P(SDCOPS,U,2)) K SDCOPS
"RTN","SDAL0",52,0)
 I $D(^DIC(8,+VAQK(6),0)),$P(^(0),U,9)=13 W !,?15,"** COLLATERAL **" G Q
"RTN","SDAL0",53,0)
 I $P($G(^SC(SC,"S",SDT,1,K,0)),"^",10)]"" D  I V W !,?15,"** COLLATERAL **" G Q
"RTN","SDAL0",54,0)
 .S V=$P(^(0),"^",10),V=$S($D(^DIC(8,+V,0)):$P(^(0),"^",9)=13,1:0)
"RTN","SDAL0",55,0)
 I $P(SDAPPT,U,11) W !,?15,"** COLLATERAL VISIT **"
"RTN","SDAL0",56,0)
 S:($P($G(^SC(SC,"S",SDT,1,K,0)),"^",10)=0) V=0
"RTN","SDAL0",57,0)
Q I SDBC,(SDY+5)>$Y F I=1:1 Q:(SDY+5)'>$Y  W !
"RTN","SDAL0",58,0)
 I SDBC W !?9,$E(SDASH,9,255)
"RTN","SDAL0",59,0)
 S SDPCT=SDPCT+1 K V,SDX,SDMT,VAQK Q
"RTN","SDAL0",60,0)
 ;
"RTN","SDAL0",61,0)
GETA K SDCP S (SDZ(3),SDZ(4),SDZ(5))="" I $D(^DPT(DFN,"S",SDT,0)) F SDZ=3,4,5 S SDZ(SDZ)=$P(^(0),"^",SDZ)
"RTN","SDAL0",62,0)
 S SDEM="",SDEC=+VAQK(6) Q:'SDEC
"RTN","SDAL0",63,0)
 S SDXX=$S('$D(^DIC(8,SDEC,0)):1,$P(^(0),"^",5)'="Y":1,$P(^(0),"^",4)=4:0,$P(^(0),"^",4)=5:0,1:1) Q:SDXX
"RTN","SDAL0",64,0)
 I $D(^SC(SC,"SL")),$P(^("SL"),U,5)]"",$D(^SC($P(^("SL"),U,5),0)) S SDCP=$P(^SC(SC,"SL"),U,5)
"RTN","SDAL0",65,0)
 S SDCP=$S($D(SDCP):SDCP,1:SC) I $D(^DPT(DFN,"DE","B",SDCP)),VAQK(12)']"" S SDEA=$O(^DPT(DFN,"DE","B",SDCP,0)) I $D(^DPT(DFN,"DE",+SDEA,0)),$P(^(0),"^",2)']"",$O(^(1,0))'="" D CKCED
"RTN","SDAL0",66,0)
 Q
"RTN","SDAL0",67,0)
 ;
"RTN","SDAL0",68,0)
MORE K SDFS I $D(^SC(SC,"S",SDT,1)) S PT=SDT S K=0 F  S K=$O(^SC(SC,"S",SDT,1,K)) Q:'K!SDEND  I $P(^(K,0),"^",9)'["C" D PTL
"RTN","SDAL0",69,0)
 Q
"RTN","SDAL0",70,0)
 ;
"RTN","SDAL0",71,0)
CCLK S SDCC=0 F  S SDCC=$O(^SC(SC,"C",SDD,1,SDCC)) Q:'SDCC!SDEND  S SDPT0=$G(^DPT(+^(SDCC,0),0)) I $L(SDPT0) D
"RTN","SDAL0",72,0)
 .I ($Y+4>IOSL) D HED^SDAL Q:SDEND  W !
"RTN","SDAL0",73,0)
 .W !,"CHART REQUEST: ",$P(SDPT0,"^",1),?34,$P(SDPT0,"^",9)
"RTN","SDAL0",74,0)
 Q
"RTN","SDAL0",75,0)
 ;
"RTN","SDAL0",76,0)
CKCED S A=0 F  S A=$O(^DPT(DFN,"DE",SDEA,1,A)) Q:'A  I $P(^DPT(DFN,"DE",SDEA,1,A,0),"^",3)']"" D ENR Q
"RTN","SDAL0",77,0)
 Q
"RTN","SDAL0",78,0)
 ;
"RTN","SDAL0",79,0)
ENR S SDEDT=$P(^(0),"^",1)\1,SDDIF=DT-SDEDT,SDREV=$P(^(0),"^",5),SDDIF1=$S(SDREV:DT-SDREV,1:"") ;NAKED REFERENCE - ^DPT(DFN,"DE",SDEA,1,A,0)
"RTN","SDAL0",80,0)
 I $P(^DPT(DFN,"DE",SDEA,1,A,0),"^",2)="O",$S(SDDIF1']""&(SDDIF>10000):1,SDDIF1>10000:1,1:0) S SDEM="PATIENT HAS BEEN ENROLLED IN ",SDEM1="FOR MORE THAN 1 YEAR, PLEASE RE-EVALUATE"
"RTN","SDAL0",81,0)
 Q
"RTN","SDAL0",82,0)
 ;
"RTN","SDAL0",83,0)
CHECK() I $D(^SC(SC,0)),$P(^(0),"^",3)="C",$S(VAUTD:1,$D(VAUTD(+$P(^(0),"^",15))):1,'$P(^(0),"^",15)&$D(VAUTD(+$O(^DG(40.8,0)))):1,1:0)
"RTN","SDAL0",84,0)
 I $T,$D(^SC(SC,"ST",SDD,1)),^(1)'["**CANCELLED",$S('$D(^SC(SC,"I")):1,+^("I")'>0:1,+^("I")>SDD:1,+^("I")'>SDD&(+$P(^("I"),"^",2)>SDD!(+$P(^("I"),"^",2)=0)):0,1:1) Q 1
"RTN","SDAL0",85,0)
 Q 0
"RTN","SDAL0",86,0)
 ;
"RTN","SDAL0",87,0)
NCOUNT ;COUNT, NON-COUNT, or BOTH FOR CLINIC SELECTION
"RTN","SDAL0",88,0)
 W !,"Count, Non Count, or Both: C//" R SDCONC:DTIME
"RTN","SDAL0",89,0)
 I '$T!(SDCONC="") S SDCONC="C" Q
"RTN","SDAL0",90,0)
 Q:SDCONC=U
"RTN","SDAL0",91,0)
 I $L(SDCONC)=1,$E(SDCONC)="?" W !,"Type C, N or B" G NCOUNT
"RTN","SDAL0",92,0)
 I $E(SDCONC,1,2)="??" D  G NCOUNT
"RTN","SDAL0",93,0)
 . W !!,"Choosing ""C"" will limit the selection to COUNT clinics."
"RTN","SDAL0",94,0)
 . W !,"         ""N"" will limit the selection to NON COUNT clinics."
"RTN","SDAL0",95,0)
 . W !,"         ""B"" will give BOTH count and non count clinics.",!
"RTN","SDAL0",96,0)
 S SDCONC=$E(SDCONC),SDCONC=$TR(SDCONC,"bcn","BCN")
"RTN","SDAL0",97,0)
 I "BCN"'[SDCONC W !,"C, N or B" G NCOUNT
"RTN","SDAL0",98,0)
 Q
"RTN","SDAL0",99,0)
 ;
"RTN","SDAL0",100,0)
NCHECK() ;EXTEND $T LOGIC COUNT, NO COUNT,or BOTH  
"RTN","SDAL0",101,0)
 N NOC S NOC=$P($G(^SC(SC,0)),U,17)
"RTN","SDAL0",102,0)
 I SDCONC="B" Q 1
"RTN","SDAL0",103,0)
 I SDCONC="C"&(NOC="N") Q 1
"RTN","SDAL0",104,0)
 I SDCONC="N"&(NOC="Y") Q 1
"RTN","SDAL0",105,0)
 Q 0
"RTN","SDAL0",106,0)
 ;
"RTN","SDAL0",107,0)
NCLINIC ;SCREEN CLINICS
"RTN","SDAL0",108,0)
 N NOCC
"RTN","SDAL0",109,0)
 I SDCONC="B" S NOCC="&1"
"RTN","SDAL0",110,0)
 I SDCONC="N" S NOCC="&($P(^(0),U,17)=""Y"")"
"RTN","SDAL0",111,0)
 I SDCONC="C" S NOCC="&($P(^(0),U,17)=""N"")"
"RTN","SDAL0",112,0)
 S DIC="^SC(",DIC("S")="I $P(^(0),U,3)=""C""&'$G(^(""OOS""))"_NOCC_"&$S(VAUTD:1,$D(VAUTD(+$P(^(0),U,15))):1,'+$P(^(0),U,15)&$D(VAUTD(+$O(^DG(40.8,0)))):1,1:0)",VAUTSTR="clinic",VAUTVB="VAUTC" G FIRST^VAUTOMA
"RTN","SDAL0",113,0)
 ;
"RTN","SDAL0",114,0)
ACTIVE() ;Determine if clinic has activity to print
"RTN","SDAL0",115,0)
 ;Output: '1' if activity or selected clinic, '0' otherwise
"RTN","SDAL0",116,0)
 Q:'VAUTC 1  ;selected clinics
"RTN","SDAL0",117,0)
 Q:$O(^SC(SC,"C",SDD,1,0)) 1  ;chart request list
"RTN","SDAL0",118,0)
 N SDX S SDX=0 F SDT=SDD:0 S SDT=$O(^SC(SC,"S",SDT)) Q:'SDT!(SDT\1-SDD)!SDX  D
"RTN","SDAL0",119,0)
 .F K=0:0 S K=$O(^SC(SC,"S",SDT,1,K)) Q:'K!SDX  I $P(^(K,0),"^",9)'["C" S SDX=1
"RTN","SDAL0",120,0)
 .Q  ;patient appointment activity
"RTN","SDAL0",121,0)
 Q SDX
"VER")
8.0^22
**END**
**END**
