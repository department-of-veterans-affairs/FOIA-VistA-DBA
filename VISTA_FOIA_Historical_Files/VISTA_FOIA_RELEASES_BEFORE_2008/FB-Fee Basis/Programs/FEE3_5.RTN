Saved by %RS from [DEV,FEY] on 17-MAR-1995 14:33:59.10
FEE BASIS V3.5
FBAA79
FBAA79	;AISC/GRR-PRINT FORM 7079 REQUEST FOR OUTPATIENT MEDICAL SERVICES ;24MAR86 ; 30 Oct 86  9:47 AM
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	W !,"Print 7079's for: " D DT^DICRW,DATE^FBAAUTL G:FBPOP END D SITEP^FBAAUTL G:FBPOP END
	I '$D(^FBAAA("AF",2)) W !!,*7,"There are no 7079's to be printed!",! G END
	S FBAASCR=""
RDHOW	W ! S DIR("A")="Want only those that have not yet been printed",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR G END:$D(DIRUT) S:Y FBAASCR="Y"
	D OUTPUT^FBAAS79
	S VAR="BEGDATE^ENDDATE^FBAASCR",VAL=BEGDATE_"^"_ENDDATE_"^"_FBAASCR,PGM="START^FBAA79",IOP="Q" D ZIS^FBAAUTL G:FBPOP END
START	D SITEP^FBAAUTL G END:FBPOP
	S UL="",ULL="----------",FBPG=0 F Z=1:1:12 S UL=UL_ULL
	U IO S FBAASCR=$S(FBAASCR="":"I 1",FBAASCR="Y":"I $S('$D(^FBAAA(DFN,1,FBK,1)):1,$P(^FBAAA(DFN,1,FBK,1),""^"",2)']"""":1,1:0)",1:"I 1")
	S FBJ=BEGDATE-.001,(DFN,FBK)=0 F ZZ=0:0 S FBJ=$O(^FBAAA("AF",2,FBJ)) Q:FBJ'>0!(FBJ>ENDDATE)  F  S DFN=$O(^FBAAA("AF",2,FBJ,DFN)) Q:DFN'>0  F  S FBK=$O(^FBAAA("AF",2,FBJ,DFN,FBK)) Q:FBK'>0  X FBAASCR I  D GOT
END	K FBJ,FBK,DFN,Z,FBS,V,FBI,FBPATT,FBPG,FBSITE,UL,ULL,POV,NOV,POS,CC,PSTCD,SSTCD,VSTCD,BEGDATE,ENDDATE,PIDC,VDX,CODE,STATCD,D,FBAASCR,FBDX,FBIDC,FBOUT,FBPDX,FBREM,FBRR,NAME,PGM,POW,VAL,VAR,VFN,VFROM,VTO,YOB,ZZ
	K FB7078,FBAABDT,FBAAEDT,FBASSOC,FBLOC,FBPOV,FBPSA,FBPT,FBTT,FBTYPE,FBVEN,FTP,CNT,FBAAOUT,FBAUT,FBPROG,I,J,M,PI,Q,SEX,SSN,TA,DATE,S,Y,DA,DIC
	D CLOSE^FBAAUTL Q
	Q
GOT	Q:'$D(^DPT(DFN,0))  S Y(0)=^(0),NAME=$P(Y(0),"^",1),NAME=$P(NAME,",",2)_" "_$P(NAME,",",1),SEX=$P(Y(0),"^",2)
	S SSN=$TR($$SSN^FBAAUTL(DFN),"-",""),YOB=$E($P(Y(0),"^",3),2,3),POS=$S($D(^DPT(DFN,.32)):$P(^(.32),"^",3),1:""),POS=$S(POS]"":$P(^DIC(21,POS,0),"^",3),1:"")
	F I=1:1:7 S FBI(I)=""
	I $D(^DPT(DFN,.11)) F I=1:1:7 S FBI(I)=$P(^(.11),"^",I)
	S POW=$P($G(^DPT(DFN,.52)),"^",5)
	Q:'$D(^FBAAA(DFN,1,FBK))  S Y(0)=^(FBK,0),VFROM=$P(Y(0),"^",1),VTO=$P(Y(0),"^",2),VFN=$P(Y(0),"^",4) I $S($P(Y(0),"^",3)=6:1,$P(Y(0),"^",3)=7:1,1:"") Q
	S VDX=$P(Y(0),"^",8),FBPATT=$P(Y(0),"^",18),POV=$$EXTPV^FBAAUTL5($P(Y(0),"^",7)),CODE=$P(Y(0),"^",13),PIDC=$P(Y(0),"^",12),NOV=$P($G(^FBAAA(DFN,1,FBK,1)),"^")
	S FBDX=$G(^FBAAA(DFN,1,FBK,3))
	S FBIDC=$P($G(^FBAAA(DFN,4)),"^")
	S STATCD=FBI(5),CC=FBI(7) F V=1:1:14 S V(V)=""
	S CC=$S(CC']"":"",$D(^DIC(5,+STATCD,1,CC,0)):$P(^(0),"^",3),1:"")
	S Y(0)=$S(VFN']"":"",'$D(^FBAAV(VFN,0)):"",$D(^FBAAV(VFN,0)):^(0),1:"") G:$S(VFN']"":1,'$D(^FBAAV(VFN,0)):1,1:0) OVR
	F V=2,1,3,14,4,5,6,10 S V(V)=$P(Y(0),"^",V)
OVR	F S=1:1:9 S FBS(S)=$P(FBSITE(0),"^",S)
	S VSTCD=$S(V(5)']"":"  ",$D(^DIC(5,V(5),0)):$P(^(0),"^",2),1:"  "),SSTCD=$S(FBS(5)']"":"  ",$D(^DIC(5,+FBS(5),0)):$P(^(0),"^",2),1:"  "),PSTCD=$S(FBI(5)']"":"  ",$D(^DIC(5,+FBI(5),0)):$P(^(0),"^",2),1:"  ")
	W:FBPG @IOF W UL,!,?46,"Department of Veterans Affairs",?100,"ID Card Number: ",FBIDC,!,?35,"R E Q U E S T   F O R   O U T P A T I E N T   S E R V I C E S",!,UL S FBREM=0,FBOUT=0
	;
	W !,"(1) Veterans Name",?31,"|(2) ID Number | Period of Validity",!,?31,"|",?46,"|"
	W !,NAME,?31,"|",?32,SSN,?46,"|"," FROM: ",$E(VFROM,4,5)_"/"_$E(VFROM,6,7)_"/"_$E(VFROM,2,3),"   TO: ",$E(VTO,4,5)_"/"_$E(VTO,6,7)_"/"_$E(VTO,2,3),!,UL
	W !,"(3) ADDRESS",?31,"|DATE OF ISSUE",?46,"| CONDITIONS FOR WHICH SERVICES ARE REQUESTED (DESCRIPTION OF DISABILITY)",!,?31,"|",?46,"|"
	W !,FBI(1),?31,"|",?33,$E(FBJ,4,5)_"/"_$E(FBJ,6,7)_"/"_$E(FBJ,2,3),?46,"|","  ",VDX S FBPDX=0
	I FBI(2)]"" W !,FBI(2),?31,"|",?46,"|","  " S FBPDX=FBPDX+1 W ?48,$P(FBDX,"^",FBPDX)
	I FBI(3)]"" W !,FBI(3),?31,"|",?46,"|","  " S FBPDX=FBPDX+1 W ?48,$P(FBDX,"^",FBPDX)
	W !,FBI(4)," ",PSTCD," ",FBI(6),?31,"|",?46,"|" S FBPDX=FBPDX+1 W ?48,$P(FBDX,"^",FBPDX),!,$E(UL,1,45),?46,"|" S FBPDX=FBPDX+1 W ?48,$P(FBDX,"^",FBPDX)
	W !,"Name and Address of Fee Participant",?46,"|" S FBPDX=FBPDX+1 W ?48,$P(FBDX,"^",FBPDX)
	W !,?46,"|",!,V(1),?46,"|",!,V(3),?46,"|" W:V(14)]"" !,V(14),?46,"|"
	W !,V(4)," ",VSTCD," ",V(6),?46,"|",!,V(2),?46,"|","AUTHORIZATION #: ",DFN,"-",FBK,!,UL,!
	W ?49,"AUTHORIZATION REMARKS",!,?49,$E(UL,1,21)
	D ^FBAA79A S $P(^FBAAA(DFN,1,FBK,1),"^",2)=DT,FBPG=1 Q

FBAA79A
FBAA79A	;AISC/GRR-PRINT 7079 CONTINUED ;24MAR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S DIWL=1,DIWF="WC120" K ^UTILITY($J,"W")
	I $D(^FBAAA(DFN,1,FBK,2)) F FBRR=0:0 S FBRR=$O(^FBAAA(DFN,1,FBK,2,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	W !,?40,"FOR VA USE ONLY",!,UL
	W !," (5) STATE CODE | (6) COUNTY CODE | (7) TYPE OF | (8) YEAR OF BIRTH | (9) WAR | (10) PURPOSE |",!,?16,"|",?34,"|",?37,"PATIENT",?48,"|",?68,"|",?78,"|",?93,"|"
	W !,?7,FBI(5),?16,"|",?23,CC,?34,"|",?41,FBPATT,?48,"|",?59,YOB,?68,"|",?74,POS,?78,"|",?87,POV,?93,"|",!,UL
	W !,"STATION OF JURISDICTION",?48,"|",?78,"|",?80," (11) CODE",?100,"| (12) SEX",!,?48,"|",?78,"|",?100,"|","  ",$S(SEX="F":"FEMALE",1:"MALE")
	W !,"Veterans Administration",?48,"|",?78,"|",?100,"|",$E(UL,101,120)
	W !,FBS(2),?48,"|",?78,"|",?80,$S(CODE=1:"SHORT TERM - 1",CODE=2:"HOME NURSING - 2",CODE=3:"ID CARD STATUS - 3",1:""),?100,"| (13) POW"
	W:FBS(3)]"" !,FBS(3),?48,"|",?78,"|",?100,"|","  ",$S(POW="Y":"YES",1:"NO")
	W !,FBS(4)," ",SSTCD," ",FBS(6),?48,"|",?78,"|",?100,"|" W:FBS(3)']"" "  ",$S(POW="Y":"YES",1:"NO") W !,?48,$E(UL,49,120)
	W !,?48,"| APPROVED BY (Name and Title)",?110,"(",$S($D(^VA(200,DUZ,0)):$P(^(0),"^",2),1:""),")",!,?48,"|"
	W !,"TELEPHONE: ",FBS(7),?48,"|",?50,FBS(8),!,?48,"|",?50,FBS(9),!,UL
	W !,?32,"Information On Veterans Administration Program",!
	W !,"Acceptance of this request to render the prescribed services will constitute an agreement which is subject",!,"to the following: ",!
	W !,?3,"I. SERVICES. If services are not initiated, please return this document to the Station of Jurisdiction with a brief"
	W !,?5,"explanation. Unless approved by the VA, services are limited in type and extent to those shown.",!
	W !,?3,"II. PERIOD OF VALIDITY. Service must be performed within the period of validity indicated.",!,?5,"If a longer time is needed, please request an extension.",!
	W !,?3,"III. REPORTS. Clinical reports are required when an examination only has been requested. Please ",!,?5,"submit reports promptly to the Station Of Jurisdiction.",!
	W !,?3,"IV. STATEMENT OF ACCOUNTS. Submit a Statement of Account in your usual manner. Your statement must",!,?5,"include: (1) Patient's Name; (2) Identification NO.; (3) Treatment (CPT) and Dates Rendered; and (4) Fees.",!
	W !,?3,"V. FEES. Fees claimed may not exceed those made to the general public for like services.",!
	W !,?3,"VI. PAYMENT. Payment by the VA for services rendered and approved is payment in full.",!
	W !,?3,"VII. HOSPITALIZATION. When a need for hospital care is indicated, please call the Station of Jurisdiction",!,?5,"for assistance in admitting the veteran to a VA hospital.",!
	W !,?3,"VIII. INQUIRIES. Additional information when required may be obtained by contacting the Station Of Jurisdiction.",!,UL
	W !?3,"VA Form 10-7079"
	S Y=DT D PDF^FBAAUTL W ?85,"Date Printed: ",Y,!
	Q

FBAAAUT
FBAAAUT	;AISC/DMK-ENTER/EDIT AUTHORIZATION ;18MAY92 
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D SITEP^FBAAUTL G Q:FBPOP S FBAADDYS=+$P(FBSITE(0),"^",13),FBAAASKV=$P(FBSITE(1),"^",1),FBPROG=$S($P(FBSITE(1),"^",6)="":"I 1",1:"I $P(^(0),U,3)=2")
	W ! S DIC="^DPT(",DIC(0)="QEAZM" D ^DIC G Q:Y<0 S DFN=+Y
	I $P($G(^DPT(DFN,.361)),"^")="" W !!,"ELIGIBILITY HAS NOT BEEN DETERMINED NOR PENDING, CANNOT ENTER AN AUTHORIZATION." G FBAAAUT
CONT	I $P($G(^DPT(DFN,.32)),"^",4)=2 W !!?4,"VETERAN HAS A DISHONORABLE DISCHARGE, " S X=$P($G(^(.321)),"^") W $S(X="Y":"ONLY ELIGIBLE FOR AGENT ORANGE EXAM.",1:"NOT ELIGIBLE FOR BENEFITS.")
	I "N"[$E(X) W ! S DIR("A")="Do you want to continue",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR G FBAAAUT:$S($D(DIRUT):1,'Y:1,1:0)
1	S DA=DFN I '$D(^FBAAA(DA,0)) L +^FBAAA(DA) K DD,DO S (X,DINUM)=DA,DIC="^FBAAA(",DIC(0)="LM",DLAYGO=161 D FILE^DICN L -^FBAAA(DFN) K DIC G:Y<0 Q
	S:'$D(^FBAAA(DFN,1,0)) ^(0)="^161.01D^^"
	D ^FBAADEM
2	W ! S (HID,NID,FBAAP79,FBANEW)="",DA=DFN,DIE="^FBAAA(",DIE("NO^")="",DR="[FBAA AUTHORIZATION]" D ^DIE I $D(FBD1) S FBANEW=$G(^FBAAA(DFN,1,FBD1,0))
	D:'$D(Y)&(HID'="")&(HID'=NID) TRIG K HID,NID,NIDR,TIME G FBAAAUT:FBANEW']"" S X=FBANEW,K=FBD1,J=DT
	I FBAAP79="Y" S $P(^FBAAA(DFN,1,FBD1,1),"^",2)="",FBDFN=DFN D CHEKP79 S DFN=FBDFN
	I $D(FBAOLD),FBAOLD'=FBANEW,$D(FBAALT),FBAALT="Y" S FBTTYPE="A",FBMST=$S($P(FBANEW,"^",13)=1:"Y",1:""),FBFDC=$S($P(FBAOLD,"^")'=$P(FBANEW,"^"):1,1:"") D MORE
	I '$D(^FBAAC(DFN,0)) K DD,DO S (X,DINUM)=DFN,DIC(0)="L",DLAYGO=162,DIC="^FBAAC(" D FILE^DICN K DIC,DLAYGO
	G FBAAAUT
TRIG	;Add an entry in Fee Basis ID Card Audit file
	I '$D(^FBAA(161.83,DFN)) K DD,DO S (X,DINUM)=DFN,DIC="^FBAA(161.83,",DIC(0)="L",DLAYGO=161.83 D FILE^DICN Q:Y<0
	S:'$D(^FBAA(161.83,DFN,1,0)) ^(0)="^161.831DA^^"
	S %DT="XT",X="NOW" D ^%DT K %DT S TIME=Y
	L +^FBAA(161.83,DFN) S DIC="^FBAA(161.83,"_DFN_",1,",DIC(0)="LM",DINUM=9999999.9999-TIME,X=TIME,DIC("DR")="1////^S X=HID;2////^S X=NIDR;3////^S X=DUZ",DA(1)=DFN K DD,DO D FILE^DICN I Y<0 L -^FBAA(161.83,DFN) Q
	K DIE,DIC,DA,DLAYGO L -^FBAA(161.83,DFN)
	Q
ENT	;ENTRY POINT FROM ^FBAAPM TO CREATE MRA TRANSACTION
MORE	;check vet mra file.  If short term flag set and already transmitted
	;delete flag before updating entry
	I $D(^FBAA(161.26,"AC","T",+$G(DFN))) D
	. S DA=+DFN,DIK="^FBAA(161.26," D ^DIK K DA,DIK
	S DLAYGO=161.26,DIC="^FBAA(161.26,",DIC(0)="LN",X="`"_DFN,DR="1///^S X=""P"";2///^S X=FBD1;3///^S X=FBTTYPE;5////^S X=FBFDC;6////^S X=FBMST",DIE=DIC D ^DIC K DLAYGO S DA=+Y D ^DIE K DIE,DIC,DR Q
	;
CHEKP79	W ! S DIR("A")="Want to Print 7079 for this patient now",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR I Y S FBK=FBD1 D EN1^FBAAS79
	Q
Q	K DA,DAT,DFN,DR,F,FBAASKV,FBAADDYS,FBAALT,FBAAP79,FBAATT,FBANEW,FBAOLD,FBCOUNTY,FBDX,FBI,FBRR,FBSITE,FBTYPE,FBXX,I,J,K,PI,S,T,Z,ZZ,FBAAASKV,FBPROG,DIC,DIE,FBAAX,X,Y,PTYPE,FBPRG,FBAAOUT,FBDFN
	K FBAUT,FBD1,FBPOP
	Q

FBAAAV
FBAAAV	;AISC/GRR-FLAG VENDOR FOR ADDITION IN CENTRAL FEE ;10JUL86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
UPDATE	;enter here to update FMS vendor file - called from fbaa fms update option
	N FBDA,FBSAY S FBSAY=1 ;flag, if 1 then write
	W !! S DIC(0)="AEQM",DIC="^FBAAV(",DIC("S")="N FBVC S FBVC=$P($G(^FBAA(161.25,+Y,0)),U,2,3),FBVC=$TR(FBVC,U) I FBVC'[""C""&(FBVC'[""N"")&('$D(^FBAA(161.25,""AF"",+Y)))" D ^DIC G EXIT:X="^"!(X=""),UPDATE:Y<0 S (FBDA,DA)=+Y
	D EN1^FBAAVD
	W ! S DIR(0)="Y",DIR("A")="Is this vendor information correct",DIR("B")="No" D ^DIR K DIR G EXIT:$D(DIRUT),VER:Y
	I '$D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ)) W !!,*7,"You must contact a vendorizing clerk or supervisor to update this record!" G EXIT
	S FBHDA=DA D EDITV^FBAAVD S DA=FBHDA
	S FBVC=$P($G(^FBAA(161.25,DA,0)),U,2,3),FBVC=$TR(FBVC,U) I FBVC["C" W !!?5,"Vendor flagged for updating!" G UPDATE
VER	W ! S DIR(0)="Y",DIR("A")="Are you sure you want to update this Vendor in the FMS and Central Fee vendor   files",DIR("B")="NO",DIR("??")="^D HELP^FBAAAV"
	D ^DIR K DIR G:$D(DIRUT) EXIT I 'Y W !!,*7,"Will NOT be Updated" G UPDATE
	D SET(FBDA) G UPDATE
	;
SET(DA,FBSAY)	;INPUT:  DA = ien of record to be updated
	;        FBSAY = flag to write: 1 for on (optional)
	Q:'+$G(DA)  N DIE,DR,FBIEN1,FBLOCK,FBT S FBT="C",FBIEN1=DA D SETGL^FBAAVD W:$G(FBSAY) !!,*7,"Vendor flagged for updating!"
	S DIE="^FBAAV(",DA=FBIEN1,DR="30.01///@;9///@;13///@" D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAAV(DA)
	;K DA,DIE,DR,FBLOCK
	;G UPDATE:FBSAY
EXIT	K FBT,FBTOV,X,FBEXDT,FBEXNDT,DIC,DIE,Y,DA,DIRUT,FBHDA,FBIEN1,FBTOV,FEEO,Z,Z1,ZZ,FBAAPN,FBDEL,FBID,FBLIEN,FBPARCD,FBTV,FBVIEN,FBV1,FBVC,FBZ,FBX,FBCNUM Q
UPDT(FBDA)	;entry point from fbaavd2 - non-interactive
	;INPUT:  FBDA = ien of vendor in vendor file
	;OUTPUT: set in vendor correction file as update (link to itself) if vendor does not exist, or another vendor is not already linked to it.
	Q:'+$G(FBDA)  N FBSAY S FBSAY=0
	;S DIC(0)="M",DIC="^FBAAV(" D ^DIC G EXIT:Y'>0 S FBDA=+Y
	I '$D(^FBAA(161.25,FBDA,0))&('$D(^FBAA(161.25,"AF",FBDA))) D SET(FBDA)
	Q
HELP	;help for update of fms vendor file
	W !?10,"This option should only be used to update the FMS and Central"
	W !?10,"Fee vendor files in Austin with the appropriate information."
	W !?10,"(NOTE:  The vendor may not exist in the FMS vendor file,"
	W !?10,"        or may exist, but the information in the FMS vendor"
	W !?10,"        file does not reflect accurate information.)"
	W !
	W !?10,"Use of this option should update the FMS system to reflect"
	W !?10,"what is currently in the DHCP system.  Information at all"
	W !?10,"other VA Medical Centers using this vendor will also be updated."

FBAABDL
FBAABDL	;AISC/DMK-DELETE A BATCH ;23JUL93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;This routine allows the deletion of a batch that has no line
	;items associated with it.  Access is restricted to the user
	;who opened the batch or the holder of the 'FBAASUPERVISOR'
	;security key.
BT	;select batch
	S FBNO=1
	W ! S DIC="^FBAA(161.7,",DIC(0)="AEQZ",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"",1:"I $P(^(0),U,5)=DUZ")
	D ^DIC K DIC G END:X=""!(X="^") G BT:Y<0 S FBBAT=+Y,FBBAT(0)=Y(0)
	;
	;reset batch line count and total dollars first
	I $G(FBBAT) N FBTOTAL,FBLCNT D
	.  D CNTTOT^FBAARB(FBBAT) S DA=FBBAT,DIE="^FBAA(161.7,",DR="10////^S X=FBLCNT;8////^S X=FBTOTAL;S:FBLCNT!(FBTOTAL) Y="""";9///@" D ^DIE K DIE,DR,DA D
	..S:FBTOTAL=0 $P(^FBAA(161.7,+FBBAT,0),U,9)=""
	..S:FBLCNT=0 $P(^FBAA(161.7,+FBBAT,0),U,11)=""
	. S FBBAT(0)=^FBAA(161.7,+FBBAT,0)
	;
	;check to see if batch meets criteria for deletion
	;Total Dollars '>0        Invoice Count '>0
	;Payment Line Count '>0        Rejects Pending flag '= "Y"
	;
	F I=9,10,11 I $P(FBBAT(0),U,I)>0 W !!?5,$P($T(NOGO+(I-8)),";;",2) S FBNO=0 D END G BT
	;check to see if any invoices point to batch
	S FBTYPE=$P(^FBAA(161.7,FBBAT,0),"^",3) I $S(FBTYPE="B3":$D(^FBAAC("AC",FBBAT)),FBTYPE="B5":$D(^FBAA(162.1,"AE",FBBAT)),FBTYPE="B9":$D(^FBAAI("AC",FBBAT)),FBTYPE="B2":$D(^FBAAC("AD",FBBAT)),1:0) D  D END G BT
	.W !!?5,$P($T(NOGO+5),";;",2)
	I $P(FBBAT(0),U,17)="Y" W !!?5,$P($T(NOGO+4),";;",2) S FBNO=0 D END G BT
	;display batch and ask if sure want to delete
	W !! S DIC="^FBAA(161.7,",DA=FBBAT,DR="0;ST" D EN^DIQ K DIC,DR,DA
	;
	S DIR(0)="Y",DIR("B")="No",DIR("A")="Sure you want to DELETE this batch" D ^DIR K DIR S:'Y FBNO=0
	I $D(DIRUT)!('Y) D END G BT
	;
	;delete batch
	I $G(FBNO) S DA=FBBAT,DIK="^FBAA(161.7," D ^DIK K DIK
	W !!?5,*7,"Batch Deleted.",!
	D END G BT
	;
END	K DA,I,FBBAT,FBNO,X,Y,FBTYPE Q
	;
NOGO	;reasons why batch cannot be deleted
	;;TOTAL DOLLARS in batch is greater than zero.
	;;INVOICE COUNT in batch is greater than zero.
	;;PAYMENT LINE COUNT in batch is greater than zero.
	;;REJECTS PENDING flag in batch is set to 'YES'.
	;;Batch has INVOICES associated with it.

FBAABET
FBAABET	;AISC/ EDIT BATCH ;09AUG85
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	W !! S DIC="^FBAA(161.7,",DIC(0)="AEQZ",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"I $G(^(""ST""))=""O""",1:"I $P(^(0),U,5)=DUZ&($G(^(""ST""))=""O"")") D ^DIC K DIC G END:X="^"!(X=""),RD:Y<0 S FBDA=+Y,FBDA(0)=Y(0)
	S FBON=$P(FBDA(0),U,2),PRC("SITE")=$P(FBDA(0),U,8),FBTYPE=$P(FBDA(0),U,3)
	;
OB	W !,"Obligation Number:  ",FBON,"//"
	S DIR(0)="Y",DIR("A")="Do you want to change the Obligation Number",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT) D GETOB:Y
	S DIE="^FBAA(161.7,",DA=FBDA,DR="[FBAA BATCH EDIT]" D ^DIE K DIE,DIC,DR
	G RD
	;
END	K DR,DIC,DIE,X,DO,DA,DI,DQ,Z,ZZ,PRC,FBHOLDX,FBPOP,FBSITE,FBON,FBDA,DIRUT,DUOUT,DTOUT,PRCS,PRCSCPAN,Y,FBI,FBJ,FBK,FBL
	Q
	;
GETOB	;Get valid Obligation Number
	S PRCS("A")="Select Obligation Number:  " K PRCS("X"),DR S PRCS("TYPE")="FB" D EN1^PRCS58 Q:Y=-1  S FBON=$P($P(Y,"^",2),"-",2) D
	. ;find if any payments are associated with this batch and change
	. ;obligation number
	. I FBTYPE="B3",$D(^FBAAC("AC",FBDA)) D
	..S (FBI,FBJ,FBK,FBL)=0 F  S FBI=$O(^FBAAC("AC",FBDA,FBI)) Q:'FBI  F  S FBJ=$O(^FBAAC("AC",FBDA,FBI,FBJ)) Q:'FBJ  F  S FBK=$O(^FBAAC("AC",FBDA,FBI,FBJ,FBK)) Q:'FBK  D
	... F  S FBL=$O(^FBAAC("AC",FBDA,FBI,FBJ,FBK,FBL)) Q:'FBL  I $G(^FBAAC(FBI,1,FBJ,1,FBK,1,FBL,0)),$P(^(0),U,8)=FBDA D
	.... S DA(3)=FBI,DA(2)=FBJ,DA(1)=FBK,DA=FBL,DIE="^FBAAC("_FBI_",1,"_FBJ_",1,"_FBK_",1,",DR="8////^S X=FBON" D ^DIE K DIC,DIE,DR,DA
	. I FBTYPE="B5",$D(^FBAA(162.1,"AE",FBDA)) D
	.. S (FBI,FBJ)=0 F  S FBI=$O(^FBAA(162.1,"AE",FBDA,FBI)) Q:'FBI  F  S FBJ=$O(^FBAA(162.1,"AE",FBDA,FBI,FBJ)) Q:'FBJ  I $G(^FBAA(162.1,FBI,"RX",FBJ,0)),$P(^(0),U,17)=FBDA D
	... S DA(1)=FBI,DA=FBJ,DIE="^FBAA(162.1,"_FBI_",""RX"",",DR="14////^S X=FBON" D ^DIE K DIC,DIE,DR,DA
	Q

FBAABPG
FBAABPG	;AISC/DMK-PURGE BATCH FILE ;01SEP89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I $S('($D(DUZ)#2):1,'($D(DUZ(0))#2):1,'DUZ:1,1:0) W *7,!!,"DUZ and DUZ(0) must be defined as a valid user to run the batch purge.",!! Q
	I DUZ(0)'="@" W *7,!!,"You must have programmer access (DUZ(0)='@') before running the batch purge.",!! Q
	D DT^DICRW S Y=DT D PDF^FBAAUTL S FBPGDT=Y
	I '$D(^FBAA(161.7,"AF")) W !,*7,?7,"There are no batches finalized !!" Q
RD	S DIR(0)="Y",DIR("A")="This option is used to purge Fee Basis batch numbers for a time frame in the    past.  Do you want to continue",DIR("B")="NO",DIR("?")="Answer ""Yes"" if you wish to proceed with Fee Basis batch number purging!"
	D ^DIR K DIR I 'Y!$D(DIRUT) G END
SETDT	W !! S %DT="AEP",%DT(0)=-DT,%DT("A")="Purge batch #'s PRIOR to date : " D ^%DT G:Y<0 END K %DT S PDAT=Y
	S VAR="PDAT^FBPGDT",VAL=PDAT_"^"_FBPGDT,PGM="START^FBAABPG" D ZIS^FBAAUTL G:FBPOP END
START	U IO W:$E(IOST,1,2)="C-" @IOF W ?15,"*** BEGIN FEE BASIS BATCH NUMBER PURGE ***",!!! S CNT=0
	F PD=0:0 S PD=$O(^FBAA(161.7,"AF",PD)) Q:PD'>0!(PD'<PDAT)  F I=0:0 S I=$O(^FBAA(161.7,"AF",PD,I)) Q:I'>0  I $D(^FBAA(161.7,I,0)) D MORE
	G PRT
MORE	S Y(0)=^FBAA(161.7,I,0),B=$P(Y(0),"^",1),FBTYPE=$P(Y(0),"^",3),FBDUZ=$P(Y(0),"^",5) D MEDP:FBTYPE="B3",TRAVP:FBTYPE="B2",RPHP:FBTYPE="B5",CHP:FBTYPE="B9"
	Q
MEDP	F J=0:0 S J=$O(^FBAAC("AC",I,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AC",I,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AC",I,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AC",I,J,K,L,M)) Q:M'>0  I $D(^FBAAC(J,1,K,1,L,1,M,0)) S $P(^(0),"^",8)=""
	K ^FBAAC("AC",I) D GOT Q
TRAVP	F J=0:0 S J=$O(^FBAAC("AD",I,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AD",I,J,K)) Q:K'>0  I $D(^FBAAC(J,3,K,0)) S $P(^(0),"^",2)=""
	K ^FBAAC("AD",I) D GOT Q
RPHP	F J=0:0 S J=$O(^FBAA(162.1,"AE",I,J)) Q:J'>0  F K=0:0 S K=$O(^FBAA(162.1,"AE",I,J,K)) Q:K'>0  I $D(^FBAA(162.1,J,"RX",K,0)) S $P(^(0),"^",17)=""
	K ^FBAA(162.1,"AE",I),^FBAA(162.1,"AJ",I) D GOT Q
GOT	S CNT=CNT+1 W "." S DIK="^FBAA(161.7,",DA=I D ^DIK Q
PRT	I CNT=0 W !!,?10,"There are no batch numbers to purge for this time frame !! " G END
	W:CNT>0 !!,?10,"This option has purged  ",CNT,"  batch numbers",!!,?16,"finalized prior to  ",$E(PDAT,4,5)_"/"_$E(PDAT,6,7)_"/"_$E(PDAT,2,3)," ."
	S ^FBAA(161.4,1,"PURGE")=DT
	W !!!!,?15,"***  FEE BASIS BATCH NUMBER PURGE FINISHED ***"
	S XMB(1)=$S($D(^VA(200,DUZ,0)):$P(^(0),"^",1),1:"Unknown User"),XMB(2)=FBPGDT,Y=PDAT D PDF^FBAAUTL S XMB(3)=Y,XMB(4)=CNT,XMB="FBAA BATCH PURGE" D ^XMB
END	K I,J,K,L,M,Y,DA,D0,D1,CNT,DIC,DIRUT,DIW,DIWL,DIWT,DN,X,DIK,PDAT,VAR,VAL,FBPGDT,FBTYPE,B,PD,PGM,FBDUZ,XM1,XMA,XMDT,XMM,XMB D CLOSE^FBAAUTL Q
CHP	F J=0:0 S J=$O(^FBAAI("AC",I,J)) Q:J'>0  I $D(^FBAAI(J,0)),'$D(^("FBREJ")) S $P(^FBAAI(J,0),"^",17)=""
	K ^FBAAI("AC",I),^FBAAI("AE",I) D GOT Q

FBAABS
FBAABS	;AISC/GRR-DISPLAY BATCH STATUS ;02MAY86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
BT	K FBAANQ W !! S DIC="^FBAA(161.7,",DIC(0)="AEQM" D ^DIC G Q:X="^"!(X=""),BT:Y<0 S DA=+Y
	S VAR="DA",VAL=DA,PGM="START^FBAABS" D ZIS^FBAAUTL G Q:FBPOP S:IO=IO(0) FBAANQ=1
START	U IO W:$E(IOST,1,2)="C-" @IOF S DIC="^FBAA(161.7,",DIC(0)="AEQM",DR="0;ST" D EN^DIQ
	G:$D(FBAANQ) BT
Q	D CLOSE^FBAAUTL K DIC,DA,DR,X,Y,FBAANQ,A,D0,DL,DRX,PGM,S,VAL,VAR Q

FBAABT
FBAABT	;AISC/CMR-OUTPUT FOR BATCHES
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBSTAT=0,DIR(0)="YA",DIR("A")="Do you want to print ALL Fee Basis Batch Status':  ",DIR("B")="No" D ^DIR K DIR Q:$D(DIRUT)  I Y S FBSTAT=1 D
	.F J="C","S","O","T","P","A","R" S FBSTAT(J)=$S(J="C":"CLERK CLOSED",J="S":"SUPERVISOR CLOSED",J="O":"OPEN",J="T":"TRANSMITTED",J="P":"FORWARDED TO PRICER",J="A":"ASSIGNED PRICE",J="R":"REVIEWED AFTER PRICER")
SEL	I 'FBSTAT S DIR(0)="S^C:CLERK CLOSED;S:SUPERVISOR CLOSED;O:OPEN;T:TRANSMITTED;P:FORWARDED TO PRICER;A:ASSIGNED PRICE;R:REVIEWED AFTER PRICER",DIR("A")="Select STATUS to print" D ^DIR K DIR G END:$D(DIRUT) S FBSTAT(Y)=Y(0)
	I 'FBSTAT S DIR(0)="YA",DIR("A")="Do you want to select another STATUS:  ",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT),SEL:Y
	S (J,VAR,VAL)="" F  S J=$O(FBSTAT(J)) Q:J=""  S VAR="FBSTAT(",VAL=VAR
	S PGM="START^FBAABT" D ZIS^FBAAUTL G END:FBPOP
	;
START	K ^TMP($J,"FBBATO") S (FBST,FBCHK)="",(FBIEN,FBAAOUT)=0,Q="-",$P(Q,"-",17)="-",QQ="=",$P(QQ,"=",80)="=" U IO W:$E(IOST,1,2)["C-" @IOF D HED
	F  S FBST=$O(FBSTAT(FBST)) Q:FBST=""  F  S FBIEN=$O(^FBAA(161.7,"AC",FBST,FBIEN)) Q:FBIEN'>0  D
	.Q:'$D(^FBAA(161.7,FBIEN,0))  S FB(0)=^FBAA(161.7,FBIEN,0),FBBAT=+FB(0),FBDT=+$P(FB(0),"^",4),FBCLK=+$P(FB(0),"^",5),FBTYPE=$P(FB(0),"^",3) S ^TMP($J,"FBBATO",FBST,FBIEN)=FBBAT_"^"_FBDT_"^"_FBCLK_"^"_FBTYPE
	S FBST="",FBIEN=0
	F  S FBST=$O(^TMP($J,"FBBATO",FBST)) Q:FBST=""!(FBAAOUT)  F  S FBIEN=$O(^TMP($J,"FBBATO",FBST,FBIEN)) Q:FBIEN'>0!(FBAAOUT)  D
	.S FB(0)=^TMP($J,"FBBATO",FBST,FBIEN),FBBAT=+FB(0),FBDT=$P(FB(0),"^",2),FBCLK=+$P(FB(0),"^",3),FBTYPE=$P(FB(0),"^",4) D PRINT
END	K FBAAOUT,FBSTAT,FBST,FBIEN,FBBAT,FBDT,FBCLK,FB(0),FBCHK,FBTYPE,J,Q,QQ,^TMP($J,"FBBATO") D CLOSE^FBAAUTL
	Q
PRINT	I $Y+5>IOSL,($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+5>IOSL W @IOF D HED
	I FBST'=FBCHK D HED1 S FBCHK=FBST
	W !?2,FBBAT,?9,$S(FBTYPE="B3":"MEDICAL & STAT PAYMENTS",FBTYPE="B5":"HOMETOWN PHARMACY PAYMENTS",FBTYPE="B2":"TRAVEL PAYMENTS",FBTYPE="B9":"CH/CNH",1:""),?38,$$DATX^FBAAUTL(FBDT),?50,$P(^VA(200,FBCLK,0),"^")
	Q
HED	W !?30,"STATUS OF BATCHES",!?30,Q
	W !!!?1,"BATCH #",?12,"BATCH TYPE",?36,"DATE OPENED",?55,"CLERK",!,QQ
	Q
HED1	W !!,"STATUS:  ",FBSTAT(FBST),!
	Q

FBAACCB
FBAACCB	;AISC/GRR-CLERK CLOSE BATCH ;09SEP86 ;
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K QQ D DT^DICRW
BT	W !! S DIC="^FBAA(161.7,",DIC(0)="AEQ",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"I $G(^(""ST""))=""O""",1:"I $P(^(0),U,5)=DUZ&($G(^(""ST""))=""O"")") D ^DIC K DIC("S")
	G Q^FBAACCB0:X="^"!(X=""),BT:Y<0 S B=+Y,FZ=^FBAA(161.7,B,0),FBTYPE=$P(FZ,"^",3)
	I FBTYPE="B3",'$D(^FBAAC("AC",B)) W !!,*7,"No payments in Batch yet!",! G BT
	I FBTYPE="B2",'$D(^FBAAC("AD",B)) W !!,*7,"No Payments in Batch yet!",! G BT
	I FBTYPE="B5",'$D(^FBAA(162.1,"AE",B)) W !!,*7,"No Payments in Batch yet!",! G BT
	I FBTYPE="B9",'$D(^FBAAI("AC",B)) W !!,*7,"No Payments in Batch yet!",! G BT
RDD	S DIR(0)="Y",DIR("A")="Want to review batch",DIR("B")="NO",DIR("?")="If you want a detail list of each payment line, answer ""Yes"" otherwise press Return key" D ^DIR K DIR
	G BT:$D(DIRUT) W:Y @IOF D:Y LIST:FBTYPE="B3",LISTP:FBTYPE="B5",LISTT^FBAACCB0:FBTYPE="B2",LISTC^FBAACCB1:FBTYPE="B9"
RDD1	S DIR(0)="Y",DIR("A")="Do you still want to close Batch",DIR("B")="YES" D ^DIR K DIR G BT:'Y!$D(DIRUT)
	S C=0,T=0 G PHARM^FBAACCB1:FBTYPE="B5",TRAV^FBAACCB1:FBTYPE="B2",CHNH^FBAACCB1:FBTYPE="B9"
	F J=0:0 S J=$O(^FBAAC("AC",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AC",B,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AC",B,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AC",B,J,K,L,M)) Q:M'>0  D GOT
FIN	S $P(FZ,"^",9)=T,$P(FZ,"^",11)=C
	S $P(FZ,"^",13)=DT,^FBAA(161.7,B,0)=FZ,^FBAA(161.7,B,"ST")="C",^FBAA(161.7,"AC","C",B)="",DA=B,DR="0;ST" K ^FBAA(161.7,"AC","O",B),^FBAA(161.7,"AB","O",$P(^FBAA(161.7,B,0),"^",5),B) W !! D EN^DIQ W !!,"Batch Closed" G BT
GOT	S Y(0)=$G(^FBAAC(J,1,K,1,L,1,M,0)),FBIN=$P(Y(0),"^",16)
	I $P(Y(0),"^",3)>0 S T=T+$P(Y(0),"^",3),C=C+1
	Q
LIST	S Q="",$P(Q,"=",80)="="
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
ENM	D HED S (FBIN,FBINOLD)="",(FBAAOUT,FBINTOT)=0 F XY=0:0 S FBIN=$O(^FBAAC("AJ",B,FBIN)) Q:FBIN=""!($G(FBAAOUT))  D INTOT^FBAACCB0 F J=0:0 S J=$O(^FBAAC("AJ",B,FBIN,J)) Q:J'>0!($G(FBAAOUT))  D GMORE^FBAACCB0
	I '$G(FBAAOUT) S FBIN=0 D INTOT^FBAACCB0
	Q
SET	S N=$S($D(^DPT(J,0)):$P(^DPT(J,0),"^",1),1:""),S=$S(N]"":$P(^DPT(J,0),"^",9),1:""),V=$S($D(^FBAAV(K,0)):$P(^FBAAV(K,0),"^",1),1:""),VID=$S(V]"":$P(^(0),"^",2),1:"")
	S D=+$G(^FBAAC(J,1,K,1,L,0)) Q:'D
	S Y=$G(^FBAAC(J,1,K,1,L,1,M,0)) Q:Y']""  S T=$P(Y,"^",5),FBIN=$P(Y,"^",16),ZS=$P(Y,"^",20),FBVP=$S($P(Y,"^",21)="VP":"#",1:""),CPTDESC=$S($D(^ICPT(+$P(Y,"^",1),0)):$P(^(0),"^",2),1:""),FBAACPT=$S(CPTDESC]"":$P(^(0),"^",1),1:"")
	S FBVCHDT=$P(Y,"^",6),FBIN(1)=$P(Y,"^",15) D FBCKO^FBAACCB2(J,K,L,M)
	S FBMOD=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),"^",7)
GO	S A1=$P(Y,"^",2)+.0001,A2=$P(Y,"^",3)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2),FBINTOT=FBINTOT+A2
	D WRT:FBTYPE'="B2",WRTT^FBAACCB0:FBTYPE="B2"
	Q
WRT	I $Y+8>IOSL D ASKH^FBAACCB0:$E(IOST,1,2)["C-" Q:FBAAOUT  W @IOF D HED
	S B(1617)=$S(B="":"",$D(^FBAA(161.7,B,0)):$P(^(0),"^"),1:"")
	W !!,N,?35,$$SSN^FBAAUTL(J),?58,B(1617),?67,$$DATX^FBAAUTL($G(FBVCHDT)),!,?3,V,?42,VID,?55,FBIN,?67,$$DATX^FBAAUTL(FBIN(1))
	W !,$S($D(QQ):QQ_")",1:""),$S(ZS="R":"*",1:""),$S(FBTYPE="B3":FBVP,1:""),$S(FBTYPE="B5":FBPV,1:""),$S($G(FBCAN)]"":"+",1:"")
	W ?4,$$DATX^FBAAUTL(D),?14,FBAACPT_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:""),?25,$J(A1,6),?35,$J(A2,6),?45,T,?49,CPTDESC
	D PMNT^FBAACCB2 S FBINOLD=FBIN
	Q
HED	W "Patient Name",?20,"('*' Reimbursement to Patient   '+' Cancellation Activity)",!,?13,"('#' Voided Payment)",?58,"Batch #",?67,"Voucher Date"
	W !,?3,"Vendor Name",?42,"Vendor ID",?53,"Invoice #",?67,"Date Rec'd."
	W !,?1,$S(FBTYPE="B3":"SVC DATE    CPT-MOD",1:"RX  DATE   RX #  "),"   CLAIMED",?35," PAID",?43,"CODE",?49,$S(FBTYPE="B5":"DRUG NAME",1:"SERVICE PROVIDED"),!,Q,!
	Q
LISTP	S Q="",$P(Q,"=",80)="="
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
ENP	D HED S (FBAAOUT,FBINTOT)=0,FBINOLD=""
	F A=0:0 S A=$O(^FBAA(162.1,"AE",B,A)) Q:A'>0!($G(FBAAOUT))  S FBIN=A D SETV^FBAACCB0 F B2=0:0 S B2=$O(^FBAA(162.1,"AE",B,A,B2)) Q:B2'>0!($G(FBAAOUT))  D INTOT^FBAACCB0 I $D(^FBAA(162.1,A,"RX",B2,0)) S Z(0)=^(0) D MORE^FBAACCB1
	I '$G(FBAAOUT) S FBIN=0 D INTOT^FBAACCB0
	Q

FBAACCB0
FBAACCB0	;AISC/GRR-CLERK CLOSE BATCH CONTINUED ;08SEP86 ;
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
LISTT	S Q="",$P(Q,"=",80)="="
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
ENT	D HEDP F J=0:0 S J=$O(^FBAAC("AD",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AD",B,J,K)) Q:K'>0  I $D(^FBAAC(J,3,K,0)) S Y(0)=^(0) D SETT
	Q
HEDP	W ?23,"'+' Represents Cancellation Activity",!?4,"Patient Name",?36,"SSN",?49,"Date",?56,"Travel Amount",!,Q,! Q
WRTT	I $Y+7>IOSL D ASKH:$E(IOST,1,2)["C-" Q:FBAAOUT  W @IOF D HEDP
	I A2'=".00" W !,$S($D(QQ):QQ_") ",1:""),$S($G(FBCAN)]"":"+",1:""),?4,N,?32,$E(S,1,3),"-",$E(S,4,5),"-",$E(S,6,10),?47,$E(D,4,5),"/",$E(D,6,7),"/",$E(D,2,3),?59,"$ ",$J(A2,4,2)  D PMNT^FBAACCB2 Q
SETT	S N=$S($D(^DPT(J,0)):$P(^(0),"^",1),1:""),S=$S(N]"":$P(^(0),"^",9),1:""),A2=$P(Y(0),"^",3),D=$P(Y(0),"^",1) D FBCKT(J,K),WRTT Q
	Q
SETV	S K=$S($D(^FBAA(162.1,A,0)):$P(^(0),"^",4),1:"")
ENV	S (V,VID)="" I K]"" S V=$S($D(^FBAAV(K,0)):$P(^(0),"^",1),1:""),VID=$S(V]"":$P(^(0),"^",2),1:"")
	Q
ASKH	S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q
GMORE	F K=0:0 S K=$O(^FBAAC("AJ",B,FBIN,J,K)) Q:K'>0!(FBAAOUT)  F L=0:0 S L=$O(^FBAAC("AJ",B,FBIN,J,K,L)) Q:L'>0!(FBAAOUT)  F M=0:0 S M=$O(^FBAAC("AJ",B,FBIN,J,K,L,M)) Q:M'>0!(FBAAOUT)  D SET^FBAACCB
	Q
INTOT	I FBINOLD'=FBIN&(FBINTOT>0) W !!,?15,"Invoice #: "_FBINOLD_"   Totals: $ "_$J(FBINTOT,1,2) S FBINTOT=0 Q
	Q
Q	K C,B,J,K,L,M,T,X,Y,FZ,A,A1,A2,B2,CPTDESC,DO,DA,DIC,DIRUT,DL,DR,DRX,DX,FBAACPT,FBAAOUT,FBIN,FBINOLD,FBINTOT,FBVP,FBTYPE,FBPV,N,Q,S,V,VID,ZIS,XY,ZS,FBMOD,FBVCHDT
	K FBAC,FBAP,FBDX,FBFD,FBI,FBK,FBLISTC,FBPDT,FBSC,FBTD Q
FBCKT(J,K)	;set travel check variables
	;j,k required variables j=DA(1),k=DA
	I 'J!('K) S (FBCAN,FBCK,FBCANDT,FBCANR,FBDIS,FBCKDT,FBCKINT)="" Q
	S FBCKIN=$G(^FBAAC(J,3,K,0))
	S FBCAN=$P(FBCKIN,"^",10),FBCK=$P(FBCKIN,"^",7),FBCANDT=$P(FBCKIN,"^",8),FBCANR=$P(FBCKIN,"^",9),FBDIS=$P(FBCKIN,"^",11),FBCKDT=$P(FBCKIN,"^",6),FBCKINT=$P(FBCKIN,"^",12)
	K FBCKIN Q

FBAACCB1
FBAACCB1	;AISC/GRR-CLERK CLOSE BATCH CONTINUED ;09MAR87
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PHARM	;ENTRY FOR PHARMACY BATCH CALCULATE TOTAL DOLLARS AND LINE COUNT
	F A=0:0 S A=$O(^FBAA(162.1,"AE",B,A)) Q:A'>0  F B2=0:0 S B2=$O(^FBAA(162.1,"AE",B,A,B2)) Q:B2'>0  I $D(^FBAA(162.1,A,"RX",B2,0)) S Z(0)=^(0) D:$P(Z(0),"^",16)>0 MOREP
	G FIN^FBAACCB
MOREP	S T=T+$P(Z(0),"^",16),C=C+1 Q
TRAV	;ENTRY FOR TRAVEL BATCH CALCULATE TOTAL DOLLARS AND LINE COUNT
	F J=0:0 S J=$O(^FBAAC("AD",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AD",B,J,K)) Q:K'>0  I $D(^FBAAC(J,3,K,0)) S Z(0)=^(0) D:$P(Z(0),"^",3)>0 MORET
	G FIN^FBAACCB
MORET	S T=T+$P(Z(0),"^",3),C=C+1 Q
LISTC	S Q="",$P(Q,"=",80)="=",(FBAAOUT,FBLISTC)=0,IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
PRTC	D HEDC
	F I=0:0 S I=$O(^FBAAI("AC",B,I)) Q:I'>0!(FBAAOUT)  I $D(^FBAAI(I,0)) S Z(0)=^(0) D CMORE
	Q
CMORE	S K=$P(Z(0),"^",3),J=$P(Z(0),"^",4) D ENV^FBAACCB0 S N=$$NAME^FBCHREQ2(J),S=$$SSN^FBAAUTL(J),FBIN=I,FBAC=$P(Z(0),"^",8)+.0001,FBAP=$P(Z(0),"^",9)+.0001,FBVP=$P(Z(0),"^",14),ZS=$P(Z(0),"^",13)
	S FBAC=$P(FBAC,".",1)_"."_$E($P(FBAC,".",2),1,2),FBAP=$P(FBAP,".",1)_"."_$E($P(FBAP,".",2),1,2)
	S FBSC=$P(Z(0),"^",11),FBSC=$S(FBSC="":"",$D(^FBAA(161.27,FBSC,0)):$P(^(0),"^",1),1:""),FBFD=$P(Z(0),"^",6),FBTD=$P(Z(0),"^",7) S FBPDT=FBFD D CDAT S FBFD=FBPDT,FBPDT=FBTD D CDAT S FBTD=FBPDT
	D FBCKI(I)
	S B(1617)=$S(B="":"",$D(^FBAA(161.7,B,0)):$P(^(0),"^"),1:"")
	S FBIN(1)=$P(Z(0),"^",2)
	D WRITC
	Q
WRITC	I $Y+7>IOSL D ASKH^FBAACCB0:$E(IOST,1,2)["C-" Q:FBAAOUT  W @IOF D HEDC
	W !!,$S('$D(ZS):"",ZS="R":"*",1:"")
	W N,?35,S,?60,B(1617),!,?3,V,?45,VID,?58,FBIN,?70,$$DATX^FBAAUTL($E(FBIN(1),1,7)),!,$S($D(QQ):QQ_")",1:""),FBVP,$S(FBCAN]"":"+",1:""),?4,FBFD,?13,FBTD,?22,$J(FBAC,6),?32,$J(FBAP,6),?45,FBSC
	W:$P(Z(0),"^",24) ?56,"Discharge ",$P($G(^ICD(+$P(Z(0),"^",24),0)),"^") W !
	I $D(^FBAAI(I,"DX")) S FBDX=^("DX") F FBK=1:1:5 Q:$P(FBDX,"^",FBK)=""  D WRTDX
	I $D(^FBAAI(I,"PROC")) S FBPROC=^("PROC") W ! F FBL=1:1:5 Q:$P(FBPROC,"^",FBL)=""  D WRTPC
	S A2=FBAP D PMNT^FBAACCB2 K A2
	Q
CDAT	S FBPDT=$E(FBPDT,4,5)_"/"_$S($E(FBPDT,6,7)="00":$E(FBPDT,2,3),1:$E(FBPDT,6,7)_"/"_$E(FBPDT,2,3))
	Q
HEDC	W "Patient Name",?20,"('*' Reimbursement to Veteran   '+' Cancellation Activity)",!,?13,"('#' Voided Payment)",?60,"Batch Number"
	W !,?3,"Vendor Name",?45,"Vendor ID",?57,"Invoice #",?68,"Dt Inv Rec'd",!,?3,"FR DATE",?14,"TO DATE  CLAIMED   PAID",?41,"SUSP CODE",!,Q,!
	Q
CHNH	S (J,FZ("CNT"))=0 F  S J=$O(^FBAAI("AC",B,J)) Q:J'>0  I $D(^FBAAI(J,0)) S Z(0)=^(0) D:$P(Z(0),"^",9)>0!($P(FZ,"^",15)="Y") MORECH D:$P(FZ,U,15)'="Y" INVCNT
	S:$G(FZ("CNT")) $P(FZ,U,10)=FZ("CNT") K FZ("CNT") G FIN^FBAACCB
MORECH	S T=T+$P(Z(0),"^",9),C=C+1 Q
WRTDX	W ?4,"Dx: ",$S($D(^ICD9($P(FBDX,"^",FBK),0)):$P(^(0),"^"),1:""),"  " Q
WRTPC	W ?4,"Proc: ",$S($D(^ICD0($P(FBPROC,"^",FBL),0)):$P(^(0),"^"),1:""),"  " Q
MORE	S J=$P(Z(0),"^",5),D=$P(Z(0),"^",3),FBAACPT=$P(Z(0),"^",1),N=$S($D(^DPT(J,0)):$P(^(0),"^",1),1:""),S=$S(N]"":$P(^DPT(J,0),"^",9),1:""),FBIN=A,CPTDESC=$P(Z(0),"^",2)
	S Y="",$P(Y,"^",2)=$P(Z(0),"^",4),$P(Y,"^",3)=$P(Z(0),"^",16),$P(Y,"^",12)=0,T=$P(Z(0),"^",8),T=$S(T="":"",$D(^FBAA(161.27,T,0)):^(0),1:""),$P(Y,"^",9)=$P(Z(0),"^",1),ZS=$P(Z(0),"^",20),FBPV=""
	D FBCKP(A,B2)
	S FBIN(1)=$P($G(^FBAA(162.1,+A,0)),"^",2)
	G GO^FBAACCB
INVCNT	;set invoice count for cnh batch
	S FZ("CNT")=FZ("CNT")+1
	Q
FBCKI(FBI)	;set inpatient check variables
	;fbi=DA
	I '$G(FBI) S (FBCKDT,FBCK,FBCANDT,FBCANR,FBCAN,FBDIS,FBCKINT)="" Q
	S FBCKIN=$G(^FBAAI(FBI,2))
	S U="^",FBCKDT=+FBCKIN,FBCK=$P(FBCKIN,U,4),FBCANDT=$P(FBCKIN,U,5),FBCANR=$P(FBCKIN,U,6),FBCAN=$P(FBCKIN,U,7),FBDIS=$P(FBCKIN,U,8),FBCKINT=$P(FBCKIN,U,9) K FBCKIN
	Q
FBCKP(J,K)	;set pharmacy check variables
	;j,k required input variables to = da(1) and da respectively (162.1)
	I '$G(J)!('$G(K)) Q
	S FBCKIN=$G(^FBAA(162.1,J,"RX",K,2))
	S U="^",FBCKDT=$P(FBCKIN,U,8),FBCK=$P(FBCKIN,U,10),FBCANDT=$P(FBCKIN,U,11),FBCANR=$P(FBCKIN,U,12),FBCAN=$P(FBCKIN,U,13),FBDIS=$P(FBCKIN,U,14),FBCKINT=$P(FBCKIN,U,15) K FBCKIN
	Q

FBAACCB2
FBAACCB2	;AISC/CMR-CLERK CLOSE BATCH ;JUN 21, 1994
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PMNT	;displays check and cancellation information if any exist
	I $G(FBCK)]"" W !?4,">>>Check # ",FBCK I $G(FBCKDT) W "  Date Paid:  ",$$DATX^FBAAUTL(FBCKDT),$S(FBCKINT>0:"  Interest: "_$FN(FBCKINT,",",2),1:""),"<<<" D
	.I FBDIS-FBCKINT'=+A2 W !,*7,?4,">>>Amount paid altered to $ ",$FN((FBDIS-FBCKINT),",",2)," on the Fee Payment Voucher document.<<<"
	I $G(FBCANDT)>0 W !?4,">>>Check cancelled on: ",$$DATX^FBAAUTL(FBCANDT) I +FBCANR W "   Reason:  ",$P($G(^FB(162.95,+FBCANR,0)),"^"),"<<<" D
	.W !,?7,$S(FBCAN="R":"Check WILL be replaced.",FBCAN="C":"Check WILL be re-issued.",FBCAN="X":"Check WILL NOT be replaced.",1:"")
PMTCLN	K FBCAN,FBCK,FBCKDT,FBCANDT,FBCANR,FBCKINT,FBDIS,FBCKIN
	Q
FBCKO(J,K,L,M)	;set outpatient check variables
	;J,K,L,M must be defined to DA(3),DA(2),DA(1) and DA respectively
	I 'J!('K)!('L)!('M) S (FBCAN,FBCK,FBCANDT,FBCANR,FBDIS,FBCKINT,FBCKDT)="" Q
	S FBCKIN=$G(^FBAAC(J,1,K,1,L,1,M,2))
	S FBCAN=$P(FBCKIN,"^",6),FBCK=$P(FBCKIN,"^",3),FBCANDT=$P(FBCKIN,"^",4),FBCANR=$P(FBCKIN,"^",5),FBDIS=$P(FBCKIN,"^",8),FBCKINT=$P(FBCKIN,"^",9)
	S FBCKDT=$P($G(^FBAAC(J,1,K,1,L,1,M,0)),"^",14)
	K FBCKIN
	Q

FBAACH
FBAACH	;AISC/GRR-DISPLAY ID CARD HISTORY FOR PATIENT ;13APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP S UL="" F A=1:1:79 S UL=UL_"="
RD	K FBOUT W !! S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC G Q:X="^"!(X=""),RD:Y<0 S DFN=+Y
	I '$D(^FBAAA(DFN,4)),'$D(^FBAA(161.83,DFN)) W !!,"Patient has never been assigned ID Card!" G RD
	S FBNM=$S($D(^DPT(DFN,0)):$P(^(0),"^"),1:""),FBSSN=$$SSN^FBAAUTL(DFN)
	I '$D(^FBAAA(DFN,4)),$D(^FBAA(161.83,DFN)) D HED,NOC,HED2,LISTH G RD
	S Y(0)=^FBAAA(DFN,4),FBIDC=$P(Y(0),"^",1),FBDT=$P(Y(0),"^",2)
	D HED W !,?6,"Current ID Card: ",FBIDC,?32,"Date Issued: ",$E(FBDT,4,5),"/",$E(FBDT,6,7),"/",$E(FBDT,2,3)
	I $D(^FBAA(161.83,DFN)) D HED2,LISTH G RD
	W !!,?5,"No previous ID Cards!",! G RD
HED	W @IOF,"Patient: ",FBNM,?41,"SSN: ",FBSSN,! Q
NOC	W !,"Does not currently have ID Card!",! Q
HED2	W !!,"Date/Time Changed",?22,"Old Card #",?35,"Person Who Changed",!,?5,"Reason For Change",!,UL Q
LISTH	I $D(^FBAA(161.83,DFN,1)) F J=0:0 S J=$O(^FBAA(161.83,DFN,1,J)) Q:J'>0  I $D(^(J,0)) S Y(0)=^(0) D GOT Q:$G(FBOUT)
	Q
GOT	S FBDT=$P(Y(0),"^"),FBIDC=$P(Y(0),"^",2),FBR=$P(Y(0),"^",3),FBUSER=$P(Y(0),"^",4)
	S X=FBDT D TM^FBAAUTL S Y=FBDT D PDF^FBAAUTL S FBUSER=$S(FBUSER="":"UNKNOWN",$D(^VA(200,FBUSER,0)):$P(^(0),"^",1),1:"UNKNOWN")
	I $Y+2>IOSL S DIR(0)="E" D ^DIR K DIR S:$D(DIRUT) FBOUT=1 Q:$G(FBOUT)  D HED,HED2
	W !,Y,?10,$J(X,8),?23,FBIDC,?35,FBUSER,!,?1,FBR,!
	Q
Q	K DFN,A,FBIDC,FBDT,FBOUT,FBUSER,FBNM,FBSSN,X,Y,UL,FBR,DIC,C,DIYS,I,J,Z Q

FBAACIE
FBAACIE	;AISC/GRR-COMPLETE PHARMACY INVOICE ;27MAR86 ;
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW,HOME^%ZIS I '$D(^FBAA(162.1,"AC",2)) W !!,*7,"There are no Invoices Pending completion!",!! Q
	D SITEP^FBAAUTL I FBPOP W !,*7,"Fee Site Parameters must be Initialized!" K FBPOP Q
	S FBAAOUT=1,FBMDF=$P(FBSITE(0),"^",10),UL="",$P(UL,"=",79)="="
RINV	W ! S FBINTOT=0,DIC="^FBAA(162.1,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,5)=2&($D(^(""RX"",""AC"",2)))" D ^DIC K DIC("S") G END:X="^"!(X=""),RINV:Y<0 S FBIN=+Y,FBINTOT=+$P(^(0),"^",7)
	I '$D(^FBAA(162.1,FBIN,"RX","AC",2)) G RINV
	S J=0 F  S J=$O(^FBAA(162.1,FBIN,"RX","AC",2,J)) Q:'J  I $D(^FBAA(162.1,FBIN,"RX",J,0)) S Y(0)=^(0) D GOT
	I '$D(^FBAA(162.1,FBIN,"RX","AC",2)) K ^FBAA(162.1,"AC",2,FBIN) S ^FBAA(162.1,"AC",3,FBIN)="",$P(^FBAA(162.1,FBIN,0),"^",5)=3
	I $D(^FBAA(162.1,"AC",3,FBIN)) W !!,"Invoice is Complete",?30,"Totals: $ "_$J(FBINTOT,1,2)
	G RINV
END	K FBAAOUT,FBIN,FBRX,FBSITE,FBDATEF,FBDRUG,FBPATN,FBPID,FBVNAME,FBVID,FBAC,FBAAPR,DA,X,Y,D0,D1,DI,DIC,DIE,DIRUT,DIV,DQ,DR,FBAP,FBGEN,FBGENSUB,FBINTOT,FBMDF,FBQTY,FBRBC,FBSTR,FBVEN,S,UL,ULL,POP,J,DFN,Z,ZZ,FBSW,FBPOP
	Q
GOT	S FBDRUG=$P(Y(0),"^",2),FBGEN=$P(Y(0),"^",10),FBGENSUB=$P(^(0),"^",21),FBRX=$P(Y(0),"^"),FBDATEF=$P(Y(0),"^",3),FBAC=$P(Y(0),"^",4),DFN=+$P(Y(0),"^",5),FBPATN=$$VET^FBUCUTL(DFN),FBPID=$$SSN^FBAAUTL(DFN)
	S FBSTR=$P(Y(0),"^",12),FBQTY=$P(Y(0),"^",13),FBAAPR=$P(Y(0),"^",22)
	S Y=$S($D(^FBAA(162.1,FBIN,0)):^(0),1:"")
	S FBVEN=+$P(Y,"^",4),FBVNAME=$$VEN^FBUCUTL(FBVEN),FBVID=$P($G(^FBAAV(FBVEN,0)),"^",2)
	W @IOF,"Vendor: ",FBVNAME,"   Vendor ID: ",FBVID
	W !!,"Patient: ",FBPATN,"   Patient ID: ",FBPID
	W !!,"Drug Name",?32,"   RX #  "," Strength  ","  Qty","   Amt Claimed   ",!,UL
	W !,FBDRUG,?34,FBRX,?43,FBSTR,?54,FBQTY,?63,FBAC
	W:FBGENSUB="Y" !!,*7,*7,?4,"Generic Drug Substituted: ",$S($D(^PSDRUG(+FBGEN,0)):$P(^(0),"^"),1:"Unknown")
	W:FBAAPR]"" !!,?5,"Pharmacy Remarks: ",FBAAPR
FEE	S DIR(0)="161.4,9",DIR("B")=FBMDF,DIR("?")="Hit Return to accept default dispensing fee or enter a dollar amount between .01 and 20" D ^DIR K DIR Q:$D(DIRUT)
	W !! S FBMDF=+Y K FBAP
	S DA(1)=FBIN,DIE="^FBAA(162.1,"_FBIN_",""RX"",",DA=J,DIC=DIE,DR="5;S FBRBC=X;6.5//^S X=$S(FBRBC+FBMDF>FBAC:FBAC,1:FBRBC+FBMDF);S FBAP=X"
	S DR(1,162.11,1)="I FBAP>FBAC S $P(^FBAA(162.1,DA(1),""RX"",DA,0),U,16)="""" W !,*7,""Amount Paid cannot be greater than the Amount Claimed"" S Y=6.5"
	S DR(1,162.11,2)="S:(FBAC-FBAP)'>0 Y=8;6///^S X=FBAC-FBAP;Q;6R;7R;S:X'=4 Y=8;20;8////^S X=3"
	D ^DIE K DIE Q:$D(Y)'=0  S:$D(FBAP) FBINTOT=FBINTOT+FBAP S $P(^FBAA(162.1,FBIN,0),"^",7)=FBINTOT G:$D(DTOUT) H^XUS
	Q

FBAACLU
FBAACLU	;AISC/DMK-CLERK WHO ENTERED AUTHORIZATION ;01JAN89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !!,*7,"This option is restricted to holders of the 'FBAASUPERVISOR' security key.",! G END
ASKVET	S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),ASKVET:Y<0 S DA=+Y
	S:'$D(^FBAAA(DA,1,0)) ^(0)="^161.01D^^"
	W ! S DIC="^FBAAA("_DA_",1,",DIC(0)="AEQM" D ^DIC G ASKVET:X="^"!(X="")!(Y<0) S FBAUTH=+Y
	S FBDUZ=$S('$D(^FBAAA(DA,1,FBAUTH,0)):"UNKNOWN",'$D(^FBAAA(DA,1,FBAUTH,100)):"UNKNOWN",1:$P(^FBAAA(DA,1,FBAUTH,100),"^")),FBUSER=$S($D(^VA(200,FBDUZ,0)):$P(^(0),"^",1),1:"UNKNOWN")
	W !!,"The last user to enter/edit this Authorization was "_FBUSER_".",! G ASKVET
END	K DA,DIC,FBAUTH,FBDUZ,FBUSER,X,Y Q

FBAACO
FBAACO	;AISC/GRR-ENTER MEDICAL PAYMENT ;08MAY87 ;
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN583	;driver for opt payments (entry point for uc)
	K FBAAOUT,FBPOP
	D SITE G Q:$G(FBPOP) D BT G Q:$G(FBAAOUT)
1	K FBAAID,FBAAVID,FBAAOUT,FBDL,FBAAMM D SITE G Q:$G(FBPOP) S FBINTOT=0 W !!
	I '$D(FB583) K FBDL,FBAR D GETVET^FBAAUTL1 G EN583:'DFN K FBAAOUT,FBDMRA D GETAUTH^FBAAUTL1 G 1:FTP']""
	K FBAAOUT
	I $G(FBCHCO) S FB7078=$S($G(FB7078):FB7078_";FB7078(",$D(FB583):FB583_";FB583(",1:"")
	D:FBAAPTC="R" ^FBAACO0
	D ^FBAAEAR:$P(FBSITE(1),"^",4)="Y"
	D PAT,GETVEN1^FBAACO1:$D(FB583),GETVEN^FBAACO1:'$D(FB583) I $G(FBAAOUT) G Q:$D(FB583),1
	W !! D FILEV^FBAACO5(DFN,FBV) I $G(FBAAOUT) G Q:$D(FB583),1
	;check for payments against all linked vendors
	S DA=+Y D CHK^FBAACO4 K FBAACK1,FBAAOUT,DA,X,Y
	K FBAAID,FBAAVID D GETINV^FBAACO1 I $G(FBAAOUT) Q:$D(FBCHCO)  G Q:$D(FB583),1
	I '$D(FBAAID)!('$D(FBAAVID)) D GETINDT^FBAACO1 I $G(FBAAOUT) D OUT G Q:$D(FB583),1:'$D(FBCHCO) Q
	D MM G Q:$G(FBAAOUT),1^FBAAMP:$G(FBMP)
SVDT	K FBAAOUT W !! D GETSVDT^FBAACO5(DFN,FBV,FBASSOC,1) I $G(FBAAOUT) K FBAADT,FBX,FBAACP W:FBINTOT>0 !!,"Invoice: "_FBAAIN_" Totals $ "_$J(FBINTOT,1,2) G Q:$D(FB583)!($G(FBCHCO)),1
	D SETO^FBAACO3,DISPINV^FBAACO1
CPT	K FBAAOUT W ! D ^FBAALU I X=""!(X="^")!('FBGOT) D DEL^FBAACO3 G SVDT
	K FBMOD S DIR(0)="162.03,39" D ^DIR K DIR I +Y>0 S FBMOD=+Y
	D CHK2^FBAACO4 I FBJ']"" G SVPR
CHKE	;determines what action to take on duplicate services entered
	K FBAAOUT W !!,*7,"Service selected for that date already in system."
	S DIR(0)="Y",DIR("A")="Do you want to add another service for the SAME DATE",DIR("B")="No" D ^DIR K DIR G Q:$D(DIRUT),SVPR:Y
	I FBJ]"",FBJ'=FBV W !!,*7,"You must use the 'EDIT PAYMENT' option to edit the service previously",!,"entered for that date." D DEL^FBAACO3 G SVDT
	S DIR(0)="Y",DIR("A")="Want to edit it",DIR("B")="No" D ^DIR K DIR G Q:$D(DIRUT) I Y D DOEDIT^FBAACO3 G SVDT:'$D(FBDL)!($G(FBAAOUT)),Q:$D(FB583),1
	D ^FBAACO2 G CPT:'$G(FBDEN)
SVPR	K FBAAOUT D SVCPR^FBAACO1 G CPT:$G(FBAAOUT)
	S FBAMTPD=0 D FILE^FBAACO2 I $D(FBAAOUT) G Q:$D(FB583),1:$D(FBDL),Q
	D OUT^FBAACO3 W:Z1>(FBAAMPI-20) !,*7,"Warning, you can only enter ",(FBAAMPI-Z1)," more line(s)!" G CPT:Z1'>(FBAAMPI-1) D WARN^FBAACO3 G EN583
	G 1
	;
Q	;exit point for outpatient payment routines
	K FBAAPTC,DIC,Y,A,I,DFN,BO,DA,DI,DQ,DR,E,FBAABDT,FBAABE,FBFY,FBDL,FBAAID,FBAAIN,FBAAMPI,FBAAOPA,FBAAPN,FBCONT,FBDX,FBGOT,FBPOV,FBPT,DLAYGO,FBPSA,FBASSOC,FBZBN,FBZBS,FBDEN,FBV,FBSDI,FBAACPI,FBAACP,FBX,FBLOCK
	K FBSP,FBTPD,FBTT,FBTYPE,FTP,FBDEL,FY,FBINTOT,G,H,MAJN,NO,PI,Q,R,SUB,SUBN,TA,TP,UL,W,X1,Z,Z1,ZZ,FBAADT,K,L,J,FBTOV,FBPARCD,FBT,FEEO,Z2,FBSITE,FBAUT,T,FBLOC,FBSSN,FBVEN,FBD1,Z0,FB583
	K A1,A2,B1,B2,DAT,DIE,FBAACPT,FBAMTPD,FBAAEDT,FBAAOUT,FBAAPD,FBI,FBIN,FBPROG,FBRR,FBXX,PTYPE,S,VAL,X,V,ZS,FB7078,FBFDC,FBCOUNTY,FBMST,FBTTYPE,FBTV,HY,FBDMRA,DIRUT,FBPOP,FBJ,FBAACK1,FBAR,FBDA,FBST
	K FBMP,FBK,FBAAAS,%DT,FBDT,FBMAX,FBAMFS,FBAASC,FBHCFA,FBSI,FBCNP,FBAAAMT,FBAAVID,FBAAMM,FBAAMM1,VAPA,FBZX,FBTST,HOLDY,FBAOT
AUTHQ	K DIC,DFN,CNT,FB7078,FBAABDT,FBAAEDT,FBAAOUT,FBASSOC,FBAUT,FBPOV,FBPROG,FBPSA,FBPT,FBTT,FBTYPE,FBVEN,FBTP,PI,TA,FBMOD
	Q
	;
SITE	;set up site variables
	D:'$D(FBSITE(0)) SITEP^FBAAUTL Q:$G(FBPOP)  I '$G(FBPROG) D
	.I $G(FBCHCO) S FBPROG="I ($P(^(0),""^"",3)=6!($P(^(0),""^"",3)=7))&($P(^(0),U,9)'[""FB583"")" Q
	.S FBPROG=$S($P(FBSITE(1),"^",6)="":"I $P(^(0),""^"",9)'[""FB583""",1:"I $P(^(0),""^"",3)=2,($P(^(0),""^"",9)'[""FB583"")")
	S:'$D(FBAAPTC) FBAAPTC="V"
	S FBAAMPI=$P($G(^FBAA(161.4,1,"FBNUM")),"^",3),FBAAMPI=$S(FBAAMPI]"":FBAAMPI,1:100)
	Q
	;
BT	;select batch
	S DIC="^FBAA(161.7,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,3)=""B3""&($G(^(""ST""))=""O"")&(($P(^(0),U,5)=DUZ)!($D(^XUSEC(""FBAASUPERVISOR"",DUZ))))",DIC("W")="W !,""  Obligation #: "",$P(^(0),U,2)" W !! D ^DIC K DIC I X["^"!(X="") S FBAAOUT=1 Q
	G BT:Y<0 S (DA,FBAABE)=+Y,Y(0)=^FBAA(161.7,DA,0)
	I $P(Y(0),"^",11)>(FBAAMPI-1) W !!,"This Batch already has the maximum number of Payments!" G BT
	S Z1=$P(Y(0),"^",11),FB7078="",BO=$P(^FBAA(161.7,DA,0),"^",2)
	Q
PAT	;set up patient in patient file
	;required input variable DFN
	I '$D(^FBAAC(DFN,0)) K DD,DO S (X,DINUM)=DFN,DIC(0)="L",DLAYGO=162,DIC="^FBAAC(" D FILE^DICN K DLAYGO,DIC,DINUM,DD,DO,DA
	Q
MM	;check for money management of entire invoice
	I FBAAPTC="R" S FBAAMM="" Q
	W ! S DIR(0)="Y",DIR("A")="Will any line items in this invoice be for contracted services",DIR("B")="No",DIR("?")="Answering no indicates interest will not be paid for any line items." D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 Q
	S FBAAMM=$S(Y=1:1,1:"")
	Q
OUT	K FBAADT,FBX,FBAACP W:FBINTOT>0 !!,"Invoice: "_FBAAIN_" Totals $ "_$J(FBINTOT,1,2) Q

FBAACO0
FBAACO0	;AISC/GRR-DISPLAY PATIENT ADDRESS DATA AND EDIT ;06FEB87 ;
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBMST=$S(FBTT=1:"Y",1:""),FBTTYPE="A",FBFDC=""
	W @IOF,?19,"Patient:  ",$P(^DPT(DFN,0),"^") S (Y(0),HY(0))=$G(^DPT(DFN,.11)) I Y(0)="" W !,*7,"No Address information for this patient!" G EDIT
	S VAPA("P")="" D ADD^VADPT
	F Z=1:1:3 I VAPA(Z)]"" W !?12,"Address Line ",Z,":  ",VAPA(Z)
	W !?22,"City:  ",VAPA(4),!?21,"State:  ",$P(VAPA(5),U,2)
	W !?23,"Zip:  ",$S(+$G(VAPA(11)):$P(VAPA(11),U,2),1:VAPA(6)),!?20,"County:  ",$P(VAPA(7),U,2)
	K VAPA,VAERR
RD	W ! S DIR("A")="Want to edit Address data",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR Q:$D(DIRUT)  G EDIT:Y,MRA
	Q
EDIT	W !! S HY(0)=$G(^DPT(DFN,.11)),DA=DFN,DIC="^DPT(",DIE=DIC,DR="[FBAA ADDRESS EDIT]" D LOCK^FBUCUTL("^DPT(",DFN) G:'FBLOCK RD D ^DIE L -^DPT(DFN)
MRA	I FBTT=1!($G(^DPT(DFN,.11))'=$G(HY(0))) S FBD1=FTP D ENT^FBAAAUT K FBD1
	Q
FEE	;calculates amount paid based on fee schedule
	S FBFY=FY-1 I '$G(FBAMTPD) S FBAMTPD=$$FEELU^FBAAUTL4(FBAACP,FBFY,$G(FBMOD)),FBAMTPD=$S(FBAMTPD>J:J,1:FBAMTPD) I $D(FBCHCO) S FBAMTPD=""
AMTPD	W !,"AMOUNT PAID: "_$S(FBAMTPD]"":FBAMTPD_"//",1:"") R X:DTIME S:X="" X=FBAMTPD G KILL:$E(X)="^",HELP1:$E(X)="?" S:X["$" X=$P(X,"$",2) I +X'=X&(X'?.N.1".".2N)!(+X>+J)!(+X<0) G HELPPD
	I FBAMTPD]"",X>FBAMTPD&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) D  G AMTPD
	.W !!,*7,"You must be a holder of the 'FBAASUPERVISOR' key to",!,"exceed the Fee Schedule. Entering an up-arrow ('^') will",!,"delete the payment or you can accept the default.",!
	S FBAMTPD=X Q
KILL	W !!,*7,"Entering an '^' will delete this payment!" R !,?5,"Do you want to delete? No//",X:DTIME S:X="" X="N" D VALCK^FBAAUTL1 G KILL:'VAL,AMTPD:"Nn"[$E(X)
	S DIK="^FBAAC("_DA(3)_",1,"_DA(2)_",1,"_DA(1)_",1," D WAIT^DICD,^DIK W !,?3,"<DELETED>" K DA,J,K,DIC,DIK,FBAACP,FBAADT,FBX S Y=0,FBDL=1 Q
HELP1	W !!,"Enter a dollar amount that does not exceed the amount claimed.",!,"Entering an '^' will delete the payment.",!
	I FBAMTPD>0 W !,"Only the holder of the 'FBAASUPERVISOR' key may exceed the",!,"Fee Schedule.",!
	G AMTPD
HELPPD	W !!,*7,"Enter a dollar amount that does not exceed the amount claimed.",! G AMTPD

FBAACO1
FBAACO1	;AISC/GRR-ENTER PAYMENT CONTINUED ;5/5/93  09:24
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
SVCPR	;set up service provided multiple
	I '$D(^FBAAC(DFN,1,FBV,1,FBSDI,1,0)) S ^FBAAC(DFN,1,FBV,1,FBSDI,1,0)="^162.03A^0^0"
	W ! S DLAYGO=162,DIC="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DIC(0)=$S($G(FBCNP):"QL",1:"EQL"),X=""""_FBX_"""",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI D ^DIC K DIC,DLAYGO,DA I Y<0 S FBAAOUT=1 Q
	S (FBAACPI,DA)=+Y
	I $G(FBMOD)>0 S DIE="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI,DA=FBAACPI,DR="39////^S X=FBMOD" D ^DIE K DIE,DA,DR
	Q
	;
PPT	;establishes prompt pay type for entry
	;fbaamm=ppt if 1 ask for each line item; if 0 don't ask
	;fbaamm1=the ppt for each line item
	N Y I FBAAMM="" S FBAAMM1="" Q
	I FBAAMM=1  S DIR(0)="Y",DIR("A")="Is this line item for a contracted service",DIR("B")="No",DIR("?")="Answering no indicates that interest will not be paid for this line item." D ^DIR K DIR I $D(DIRUT) W !,*7,"Required Response!" G PPT
	S FBAAMM1=$S(Y=1:1,1:"")
	Q
Q	K FBAADT,FBX,FBAACP W:FBINTOT>0 !!,"Invoice: "_FBAAIN_"  Totals $ "_$J(FBINTOT,1,2) G Q^FBAACO:$D(FB583),1^FBAACO:'$D(FBCHCO) Q
	;
GETVEN	;select vendor from vendor file
	W !! S DLAYGO=161.2,DIC="^FBAAV(",DIC(0)="AEQLM" D ^DIC K DLAYGO I X="^"!(X="") S FBAAOUT=1 Q
	;if new vendor, call in to new vendor setup routine
	G GETVEN:Y<0 S DA=+Y,DIE=DIC D:$P(Y,"^",3)=1 NEW^FBAAVD K DIE,DIC,DR,X,DLAYGO
GETVEN1	I $D(FB583) S DA=FBVEN
	I $D(^FBAAV(DA,0)),$P($G(^("ADEL")),U)="Y" W !!,*7,"Vendor has been flagged for Austin deletion!" G GETVEN:'$D(FB583) S FBAAOUT=1 Q
	D:$P(FBSITE(0),"^",11)="Y" EN1^FBAAVD
GETVEN2	I $P(FBSITE(0),"^",11)="Y",$D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ)) S DIR(0)="Y",DIR("A")="Want to Edit data",DIR("B")="NO" D ^DIR K DIR S:$D(DIRUT) FBAAOUT=1 Q:$D(DIRUT)  D:Y EDITV^FBAAVD
	I $P(FBSITE(0),"^",11)'="Y"!('$D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ))) S DIR(0)="E" D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 Q
	S FBV=DA,FBAR(DA)="" D ^FBAACO4
	Q
	;
GETINV	;assign invoice number or select existing invoice number
	K FBAAOUT S FBINTOT=0 S DIR(0)="Y",DIR("A")="Want a new Invoice number assigned",DIR("B")="YES" D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 Q
	I Y D GETNXI^FBAAUTL W !!,"Invoice # ",FBAAIN," assigned to this Invoice" Q
GETINV1	;selects existing invoice if user does not choose to assign new number
	S DIR(0)="N",DIR("A")="Select Invoice number",DIR("?")="Select one of the previously entered Invoice #'s" D ^DIR K DIR I $D(DIRUT)!(X="") G GETINV:'$G(FB583) S FBAAOUT=1 Q
	D CHK1^FBAACO4 G GETINV1:'$G(FBAACK1) K FBAACK1
	S FBAAIN=X D CALC^FBAACO3 W:FBINTOT>0 ?33,"Current Total: $ "_$J(FBINTOT,1,2)
	Q
	;
GETINDT	;get invoice dates
	;input requires FBAABDT (authorization from date)
	K FBAAOUT W !,"Enter Date Correct Invoice Received or Last Date of Service" S %DT("A")="(whichever is later): " S:$G(FBAAID) %DT("B")=$$DATX^FBAAUTL(FBAAID) I $G(FBCNH) S %DT(0)=$G(FBENDDT)
	S %DT="AEXP" D ^%DT K %DT I X="^"!(X="") S FBAAOUT=1 Q
	S FBAAID=Y I '$G(FBCNP) I FBAAID<FBAABDT W !!,*7,"Invoice date is earlier than Patient's Authorization date!!" K FBAAID G GETINDT
GETIND1	W ! S %DT("A")="Enter Vendor Invoice Date: ",%DT="AEXP" S:$G(FBAAVID) %DT("B")=$$DATX^FBAAUTL(FBAAVID) D ^%DT K %DT G GETINDT:X="" I X="^" S FBAAOUT=1 Q
	S FBAAVID=Y I FBAAVID>FBAAID W !!,*7,"Vendor's invoice date is later than the date you received it!!" K FBAAVID G GETIND1
	Q
	;
DISPINV	;display invoice totals
	;required inputs FBAADT (auth dt),DFN
	S H=$E(FBAADT,1,5)_"00",R=9999999.9999-H,S=$E(FBAADT,1,5)_31,S=9999999.9999-S,G=+$E(FBAADT,4,5)_+$E(FBAADT,2,3) D CKMAX^FBAACO3
	S FBTPD=0 I $D(^FBAAC(DFN,3,"AB",FBAADT)) S FBZX=$O(^FBAAC(DFN,3,"AB",FBAADT,0)) I $D(^FBAAC(DFN,3,FBZX,0)) W !!,"$ ",$P(^(0),"^",3)," for travel already entered for this date of service" S FBTPD=1
	W:'$D(FBCHCO) !!,"Total already paid on ID Card for month:   $ ",A,"   Maximum allowed: $ ",$P(FBSITE(1),"^",9),!,"Total already paid on All/Other for month: $ ",FBAOT
	Q

FBAACO2
FBAACO2	;AISC/GRR-PAYMENT PROCESS FOR DUPLICATE ;03DEC86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	S DIR(0)="Y",DIR("A")="Want this payment stored as a Medical Denial",DIR("B")="YES",DIR("?")="Enter 'Yes' to store payment entry as a denial and send a Suspension letter.  Enter 'No' to have nothing happen." D ^DIR K DIR Q:$D(DIRUT)!('Y)
	S FBDEN=1 Q
FILE	;files sp multiple entry
	K DR S TP="" I $G(FBDEN) S FBAMTPD=0
	S DR="1;S J=X;I $G(FBDEN) S Y=2;D FEE^FBAACO0;2///^S X=FBAMTPD;S K=X;S:J-K=0 Y=6;3//^S X=$S(J-K:J-K,1:"""");S:'X Y=6;3.5///^S X=DT;@4;4;I X']"""" D SC^FBAACO3;S:X'=4 Y=6;22;6////^S X=DUZ;7////^S X=FBAABE"
	S DR(1,162.03,1)="8////^S X=BO;13///^S X=FBAAID;14///^S X=FBAAIN;33///^S X=FBAAVID;I $G(FBDEN) S FBTST=1"
	I '$G(FBDEN) D
	.S DR(1,162.03,2)="D PPT^FBAACO1;34///^S X=$G(FBAAMM1);S:$$EXTPV^FBAAUTL5(FBPOV)=""01"" Y=""@1"";S:FB7078]""""!($D(FB583)) Y=30;28R;30;31;32R;S Y=15;@1;28;30;31"
	.S DR(1,162.03,3)="15///^S X=FBPT;16////^S X=FBPOV;17///^S X=FBTT;18///^S X=FBAAPTC;23////^S X=FBTYPE;26////^S X=FBPSA;S:$D(FBV583) Y=""@2"";27////^S X=FB7078;S Y=""@99"";@2;27////^S X=FBV583;@99;S FBTST=1"
	S DIE="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI,DA=FBAACPI D LOCK^FBUCUTL("^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",FBAACPI,1),^DIE L -^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI)
	I $D(DTOUT) D KILL Q
	I '$G(FBTST),$G(DA) S DIR(0)="YA",DIR("A")="Entering an '^' will delete "_$S($G(FBDEN):"denial",1:"payment")_".  Are you sure you want to delete? ",DIR("B")="No" D ^DIR K DIR G FILE:'$D(DIRUT)&('Y) D KILL Q
	K FBTST,FBDEN,FBAAMM1,DIE,DR,DA
	I $D(FBDL) S FBAAOUT=1 Q
	Q
KILL	S DIK=DIE D ^DIK K DIE,DIK I '$G(FBCNP) D Q^FBAACO S FBAAOUT=1
	W !,"Deleted" Q

FBAACO3
FBAACO3	;AISC/GRR-ENTER PAYMENT CONTINUED ;5/5/93  09:27
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DOEDIT	W ! S X=FBAACP,DIC="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DIC(0)="EQM",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI D ^DIC I Y<0 S FBAAOUT=1 Q
	S (DA,FBAACPI)=+Y,K=$P(^(0),"^",3),FBZBN=$P(^(0),"^",8),FBZBS=$S(FBZBN="":"",$D(^FBAA(161.7,FBZBN,"ST")):$P(^("ST"),"^",1),1:"")
	I FBZBS=""!(FBZBS="V") D NOGO S FBAAOUT=1 Q
	D SETO K DR
	S DR="39;S FBMOD=X;1;S J=X;Q;D FEEDT^FBAACO3;2//^S X=FBAMTPD;D CHKIT^FBAACO3;S K=X;3//^S X=$S(J-K:J-K,1:"""");4;S:X'=4 Y=6;22;6////^S X=DUZ;13;33;34"
	S DR(1,162.03,1)="S:$$EXTPV^FBAAUTL5(FBPOV)=""01"" Y=""@1"";S Y=$S('$D(FB7078):28,FB7078]"""":30,1:28);28R;30;31;32R;S Y="""";@1;28;30;31"
	S DIE=DIC,DIE("NO^")="",FBOT=1 D LOCK^FBUCUTL("^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",FBAACPI) I 'FBLOCK S FBAAOUT=1 Q
	D ^DIE L -^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI) K FBOT,DIE,DR,DA
	Q:$D(FBDL)
	I $G(FBAAIN) S FBINTOT=0 D CALC
	Q
SETO	S FY=$E(FBAADT,1,3)+1700+$S($E(FBAADT,4,5)>9:1,1:0)
	Q
OUT	I K>0 S Z1=$P(^FBAA(161.7,FBAABE,0),"^",11)+1,$P(^(0),"^",11)=Z1,FBINTOT=FBINTOT+K
	Q
CKMAX	S (FBAOT,A)=0,O="" F Z=S-.1:0 S Z=$O(^FBAAC(DFN,"AB",Z)) Q:Z'>0!(Z>R)  F Q=0:0 S Q=$O(^FBAAC(DFN,"AB",Z,Q)) Q:Q'>0  S W=$O(^FBAAC(DFN,"AB",Z,Q,0)) I $D(^FBAAC(DFN,1,Q,1,W,0)) D SMORE
	I A>$P(FBSITE(1),"^",9) G NO
	Q
SMORE	N FBA,FBB S FBB=$P($G(^FBAAC(+DFN,1,+Q,1,+W,0)),U,4),E=0
	F  S E=$O(^FBAAC(DFN,1,Q,1,W,1,E)) Q:'E  S FBA=$G(^(E,0)) I $P(FBA,"^",9)=2,$P(FBA,"^",18)'=1 D
	.I $$IDCHK^FBAAUTL3(DFN,FBB) S A=A+$P(FBA,"^",3) Q
	.S FBAOT=FBAOT+$P(FBA,U,3)
	Q
NO	W !!,*7,"Warning Patient already at maximum allowed for month of service",! Q
WARN	W !!,*7,"You have reached the maximum number of payments for a Batch!",!,"You must select another Batch for entering Payments!"
CALC	;Calculate Current Invoice Total
	F J=0:0 S J=$O(^FBAAC("C",FBAAIN,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("C",FBAAIN,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("C",FBAAIN,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("C",FBAAIN,J,K,L,M)) Q:M'>0  D CALC1
	K J,K,L,M,FZNODE Q
CALC1	S FZNODE=^FBAAC(J,1,K,1,L,1,M,0),A2=$P(FZNODE,"^",3),FBINTOT=FBINTOT+A2,FBAAID=$P(FZNODE,"^",15),FBAAVID=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),"^")
	Q
FEEDT	D SETO:'$G(FY) S FBFY=FY-1,FBAMTPD=$$FEELU^FBAAUTL4(FBAACP,FBFY,$G(FBMOD)),FBAMTPD=$S(FBAMTPD="":J,FBAMTPD>J:J,1:FBAMTPD)
	I $D(FBCHCO) S FBAMTPD=J
	Q
CHKIT	I X>FBAMTPD&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,"You must be a holder of the 'FBAASUPERVISOR' security key in order to",!,"exceed the Fee Schedule.",! S $P(^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,0),"^",3)=K,Y=2 Q
	Q
NOGO	W !!,*7,"This payment CANNOT be edited.  The batch the payment is in",!,"has been Vouchered.  You may void the payment with the Void Payment option.",!
	Q
	;
SC	W *7,!?4,"Suspense code is required!",! S Y="@4" Q
	;
DEL	;delete date of service if no service provided entered
	I '$O(^FBAAC(DFN,1,FBV,1,FBSDI,1,0)) D
	.S DIK="^FBAAC(DFN,1,FBV,1,",DA(2)=DFN,DA(1)=FBV,DA=FBSDI D ^DIK W !!?5,*7,"Incomplete payment entry deleted.",!
	K DIK,DA Q

FBAACO4
FBAACO4	;AISC/CMR-ENTER PAYMENT CONTINUED ;4/6/93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBJ=0,FBDA=DA
CORRF	I $D(^FBAA(161.25,"AF",FBDA)) F  S FBJ=$O(^FBAA(161.25,"AF",FBDA,FBJ)) Q:'FBJ  S:'$D(FBAR(FBJ)) FBA(FBJ)=""
	S FBJ=0 I $D(^FBAA(161.25,FBDA,0)) S FBJ=$P(^(0),"^",6) I $G(FBJ)]"",(FBJ'=FBDA) S:'$D(FBAR(FBJ)) FBA(FBJ)=""
	S FBDA=0,FBDA=$O(FBA(FBDA)) Q:'FBDA  S FBAR(FBDA)="" K FBA(FBDA) D CORRF
	Q
CHK	;Checks for payments against all linked vendors.
	S FBDA=DA,FBAAOUT=0
	S FBJ=0 F  S FBJ=$O(FBAR(FBJ)) Q:'FBJ  I $D(^FBAAC(DFN,FBJ,"AD")) S FBAACK1=1,DA=FBJ N FBAADT,FBAACPT,FBMOD D EN1^FBAAVS Q:$G(FBAAOUT)  S DIR(0)="E" D ^DIR K DIR Q:'Y
	I '$G(FBAACK1) W !!,"Vendor has no prior payments for this patient",!
	S DA=FBDA Q
CHK1	;Checks for valid invoice selected from all linked vendors.
	K FBAACK1
	I $D(^FBAAC("C",X)) S FBJ=0 F  S FBJ=$O(FBAR(FBJ)) Q:'FBJ  D  K X(1) I $G(FBAACK1) S FBV=FBJ Q
	.I '$G(FBCNP) I $D(^FBAAC("C",X,DFN,FBJ)) S FBAACK1=1
	.I $G(FBCNP) S X(1)=$O(^FBAAC("C",X,0)) I $D(^FBAAC("C",X,X(1),FBJ)) S FBAACK1=1
	I '$G(FBAACK1) W !,*7,"That number not valid for this vendor!"
	Q
CHK2	;Checks for duplicate payments on all linked vendors.
	I $D(^FBAAC("AE",DFN,FBV,FBAADT,FBAACP_$S($G(FBMOD)]"":"-"_FBMOD,1:""))) S FBJ=FBV Q
	S FBJ=0 F  S FBJ=$O(FBAR(FBJ)) Q:$S('FBJ:1,$D(^FBAAC("AE",DFN,FBJ,FBAADT,FBAACP_$S($G(FBMOD)]"":"-"_FBMOD,1:""))):1,1:0)
	Q

FBAACO5
FBAACO5	;AISC/GRR-ENTER PAYMENT CONTINUED ;5/5/93  09:24
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
FILEV(DFN,FBV)	;files vendor multiple in outpatient payment file
	;required input variable DFN,FBV (vendor ien)
	K FBAAOUT
	I '$G(DFN)!('FBV) S FBAAOUT=1 Q
	S:'$D(^FBAAC(DFN,1,0)) ^FBAAC(DFN,1,0)="^162.01P^0^0"
	S DLAYGO=162,DIC="^FBAAC("_DFN_",1,",DIC(0)="QLNM",DA(1)=DFN,X="`"_FBV D ^DIC K DIC,DLAYGO I Y<0 W !,*7,"Cannot select this Vendor at this time" S FBAAOUT=1 Q
	Q
GETSVDT(DFN,FBV,FBASSOC,FBA,X)	;set date of service multiple
	;required input DFN,FBV (vendor ien),FBASSOC (auth ptr,0 if not known)
	;required input FBA (1=ask dt,0=do not ask dt)
	;optional/required input X (dt) - X req if FBA=0 (do not ask)
	;output FBSDI=ien of svc date mult,FBAADT=svc date
	K FBAAOUT
	I '$G(DFN)!('$G(FBV))!('$D(FBASSOC))!('$D(FBA)) S FBAAOUT=1 Q
	I FBA=0,('$G(X)) S FBAAOUT=1 Q
	I $G(FBA) S DIC("A")="Date of Service: ",DIC(0)="AEQLM"
	I '$G(FBA) S DIC(0)="QLMN"
	I '$D(^FBAAC(DFN,1,FBV,1,0)) S ^FBAAC(DFN,1,FBV,1,0)="^162.02DA^0^0"
	S DLAYGO=162,DA(2)=DFN,DA(1)=FBV,DIC="^FBAAC("_DFN_",1,"_FBV_",1," D ^DIC K DLAYGO,DIC,DA I X=""!(X="^")!(Y<0) S FBAAOUT=1 Q
	S FBSDI=+Y,FBAADT=$P(Y,"^",2) I FBASSOC>0 S $P(^FBAAC(DFN,1,FBV,1,FBSDI,0),"^",4)=FBASSOC
	Q

FBAACP
FBAACP	;AISC/CMR - C&P PAYMENT DRIVER ;29MAR94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K FBAAOUT,FBPOP S FBCNP=1 ;C&P flag
	D SITE^FBAACO G Q:$G(FBPOP) D BT^FBAACO G Q:$G(FBAAOUT)
1	K FBAR,FBAAOUT,FBDL,FBAAMM D GETVEN1^FBAACO1:$D(FB583),GETVEN^FBAACO1:'$D(FB583) G CLN:$G(FBAAOUT)
	D GETINV^FBAACO1 G CLN:$G(FBAAOUT)
	D GETINDT^FBAACO1 G CLN:$G(FBAAOUT)
	D MM^FBAACO G CLN:$G(FBAAOUT)
SVDT	W !! S %DT="AEXP",%DT("A")="Date of Service: " D ^%DT I X="^" G CLN
	I Y<0!(Y>FBAAID) W *7,!!,"Enter the date the Vendor provided the service to the Patient.",!,"The date must be prior to the date the invoice is received.",! G SVDT
	S FBAADT=Y D SETO^FBAACO3,^FBAALU I X=""!(X="^")!('FBGOT) G CLN
	K FBMOD S DIR(0)="162.03,39" D ^DIR K DIR I +Y>0 S FBMOD=+Y
	S FBAAAMT=0 D AMTPD I $G(FBAAOUT)!('$G(FBAAAMT)) G CLN
	D HCFA G CLN:$G(FBAAOUT)
MULT	;begin unique patient entry
	W:FBINTOT>0 !,"Invoice: "_FBAAIN_" Totals: $ "_FBINTOT
	K FBAAOUT,FBDL S (DFN,FTP)="" D SITE^FBAACO G Q:$G(FBPOP) W !!
	I '$D(FB583) K FBDL D GETVET^FBAAUTL1 G CLN:'DFN K FBDMRA D GETAUTH^FBAAUTL1 G MULT:FTP']""
	K FBAAOUT S I=28,DIR(0)="PO^80:EMQZ",DIR("A")="PRIMARY DIAGNOSIS" D DIR G Q:$G(FBAAOUT)
	D PPT^FBAACO1,PAT^FBAACO W !! D FILEV^FBAACO5(DFN,FBV) I $G(FBAAOUT) G Q:$D(FB583),CLN
	;check for payments against all linked vendors
	S DA=+Y D CHK^FBAACO4 K FBAACK1,FBAAOUT,DA,X,Y
	W !! D GETSVDT^FBAACO5(DFN,FBV,FBASSOC,0,FBAADT) I $G(FBAAOUT) D AUTHQ^FBAACO G MULT
	D SETO^FBAACO3,CHK2^FBAACO4 I FBJ']"" G SVPR
CHKE	;determines what action to take on duplicate services entered
	K FBAAOUT W !!,*7,"Service selected for that date already in system."
	S DIR(0)="Y",DIR("A")="Do you want to add another service for the SAME DATE",DIR("B")="No" D ^DIR K DIR G SVPR:Y I $D(DIRUT) D DEL^FBAACO3 G Q
	W !!,*7,"You must use the 'EDIT PAYMENT' option to edit the service previously",!,"entered for that date." D DEL^FBAACO3
	G MULT
SVPR	K FBAAOUT D SVCPR^FBAACO1 G CHKE:$G(FBAAOUT)
	D FILE^FBAACP1 I Z1>(FBAAMPI-1) W !!,*7,"You have reached the maximum number of payments for a batch!",!,"You must select another Batch for entering Payments!" G CLN
	G MULT
Q	;kill variables and exit
	D Q^FBAACO
	Q
	;
AMTPD	;get amount paid
	S FBFY=FY-1,FBAMTPD=$$FEELU^FBAAUTL4(FBAACP,FBFY,$G(FBMOD)) I FBAMTPD=0 D  Q:$G(FBAAOUT)
	. ;if fee schedule = 0 write message and quit
	. W !,"You must use the Enter Payment option for CPT codes that have a",!,"Fee Schedule set equal to zero.",!
	. S FBAAOUT=1
	S DIR(0)="162.03,1",DIR("A")="Enter Amount Paid:  $",DIR("?")="Enter a dollar amount that does not exceed the FEE Schedule" S:FBAMTPD'="" DIR("B")=FBAMTPD D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 Q
	I $G(FBAMTPD),+Y>FBAMTPD&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"You must be a holder of the 'FBAASUPERVISOR' security key to",!,"exceed the FEE Schedule.  Enter an '^' to quit or accept the default.",! G AMTPD
	S FBAAAMT=+Y
	Q
HCFA	;get HCFA fields
	F I=28,30,31 S FBHCFA(I)=""
	W ! F I=30,31 S DIR(0)="PO^"_$S(I=30:"353.1",I=31:"353.2")_":EMQZ" D DIR Q:$G(FBAAOUT)
	K DIR Q
DIR	;generic DIR call for HCFA
	D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S FBAAOUT=1 Q
	S:Y'=-1 FBHCFA(I)=$P(Y,"^")
	Q
CLN	G Q:$D(FB583)
	D Q G FBAACP
	Q

FBAACP1
FBAACP1	;AISC/CMR - C&P PAYMENT DRIVER ;29MAR94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
FILE	;files sp multiple entry
	S DIE="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI,DA=FBAACPI
	S TP="",DR="1///^S X=FBAAAMT;Q;2///^S X="_$S($G(FBDEN):0,1:FBAAAMT)_";I '$G(FBDEN) S Y=6;3//^S X=FBAAAMT;3.5///^S X=DT;@4;4;I X']"""" D SC^FBAACO3;S:X'=4 Y=6;22;6////^S X=DUZ;7////^S X=FBAABE"
	S DR=DR_";8////^S X=BO;13///^S X=FBAAID;14///^S X=FBAAIN;15///^S X=FBPT;23////^S X=2;33///^S X=FBAAVID;16////^S X=FBPOV;17///^S X=FBTT;18///^S X=FBAAPTC;26////^S X=FBPSA"
	S DR(1,162.03,1)="34///^S X=$G(FBAAMM1);28////^S X=FBHCFA(28);30///^S X=FBHCFA(30);31////^S X=FBHCFA(31);S FBTST=1"
	D LOCK^FBUCUTL("^FBAAC(",DFN,1),^DIE L -^FBAAC(DFN)
	I '$G(FBTST),$G(DA) S DIR(0)="YA",DIR("A")="Entering an '^' will delete "_$S($G(FBDEN):"denial",1:"payment")_".  Are you sure you want to delete? ",DIR("B")="No" D ^DIR K DIR G FILE:'$D(DIRUT)&('Y) D KILL^FBAACO2 Q
	S FBINTOT=FBINTOT+FBAAAMT
	I FBAAAMT>0 S Z1=$P(^FBAA(161.7,FBAABE,0),"^",11)+1,$P(^(0),"^",11)=Z1
	W !,$S($G(FBDEN):"Denial",1:"Payment")," Data Entered for Patient"
	K FBDEN,FBAAMM1,FBTST,DIE,DR,DA
	Q
	;
PAID	;called from fbaacp to reset fee schedule if user opts to edit
	;a service.  If fee schedule of new cpt_modifier=0 tell user
	;not allowed in this option and refer to edit payment option.
	;

FBAACR
FBAACR	;AISC/CMR-OPT MED Cost Report ;4/28/93  10:57
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DATE^FBAAUTL Q:FBPOP
	S VAR="BEGDATE^ENDDATE",VAL=BEGDATE_"^"_ENDDATE,PGM="START^FBAACR" D ZIS^FBAAUTL G END:FBPOP
START	K ^TMP($J,"FBAACR") S (FBAAOUT,DFN,FBA,FBB,FBC)=0,BEGDT=BEGDATE-1,Q="-",$P(Q,"-",25)="-",QQ="=",$P(QQ,"=",80)="=" U IO W:$E(IOST,1,2)["C-" @IOF D HED
	F FBDT=BEGDT:0 S FBDT=$O(^FBAAC("AK",FBDT)) Q:FBDT'>0!(FBDT>ENDDATE)  F  S DFN=$O(^FBAAC("AK",FBDT,DFN)) Q:DFN'>0  F  S FBA=$O(^FBAAC("AK",FBDT,DFN,FBA)) Q:FBA'>0  D
	.F  S FBB=$O(^FBAAC("AK",FBDT,DFN,FBA,FBB)) Q:FBB'>0  F  S FBC=$O(^FBAAC("AK",FBDT,DFN,FBA,FBB,FBC)) Q:FBC'>0  S FBPMT=^FBAAC(DFN,1,FBA,1,FBB,1,FBC,0) I $P(FBPMT,"^",13)="" D
	..S FBPTC=$P(FBPMT,"^",17),FBAMT=$P(FBPMT,"^",3),FBNAME=$$NAME^FBCHREQ2(DFN),FBCPT=$P(FBPMT,"^"),^TMP($J,"FBAACR",FBNAME)=DFN,^TMP($J,"FBAACR",FBNAME,FBA,FBB,FBC)=FBPTC_"^"_FBAMT_"^"_FBCPT
	S (FBNAME,FBNM)="",(FBA,FBB,FBC,DFN,FBPTC,FBAMT,FBPAMT,FBTAMT,FBCPT,FBCTR,FBTPT)=0
	F  S FBNAME=$O(^TMP($J,"FBAACR",FBNAME)) Q:FBNAME=""!(FBAAOUT)  S DFN=+^TMP($J,"FBAACR",FBNAME) S FBTPT=FBTPT+1,FBPCTR=0 D  D PSUM
	.F  S FBA=$O(^TMP($J,"FBAACR",FBNAME,FBA)) Q:FBA'>0!(FBAAOUT)  F  S FBB=$O(^TMP($J,"FBAACR",FBNAME,FBA,FBB)) Q:FBB'>0!(FBAAOUT)  F  S FBC=$O(^TMP($J,"FBAACR",FBNAME,FBA,FBB,FBC)) Q:FBC'>0!(FBAAOUT)  S FBCTR=FBCTR+1,FBPCTR=FBPCTR+1 D
	..S FBPMT=^TMP($J,"FBAACR",FBNAME,FBA,FBB,FBC),FBPTC=$P(FBPMT,"^"),FBAMT=$P(FBPMT,"^",2),FBCPT=$P(^ICPT(+$P(FBPMT,"^",3),0),"^",2),FBPAMT=FBPAMT+FBAMT,FBTAMT=FBTAMT+FBAMT D PRINT
	G END:FBAAOUT
	W !!,QQ,!!,"TOTAL PAYMENTS:  ",?25,$J(FBCTR,7),?40,"TOTAL PATIENTS:  ",?65,$J(FBTPT,7),!,"AVE. PAID FOR A PAYMENT:",?25 W:FBCTR>0 $J($FN(FBTAMT/FBCTR,",",2),10) W ?40,"AVE. PAID FOR A PATIENT:",?65 W:FBTPT>0 $J($FN(FBTAMT/FBTPT,",",2),10)
END	K FBPMT,FBNAME,DFN,FBAAOUT,FBA,FBB,FBC,FBAMT,FBPTC,FBPAMT,FBTAMT,FBCTR,FBDT,FBCPT,FBNM,FBPCTR,FBPTC1,FBTPT,BEGDT,BEGDATE,ENDDATE,J,Q,QQ,^TMP($J,"FBAACR") D CLOSE^FBAAUTL
	Q
PRINT	D CHK Q:FBAAOUT  S FBPTC1=""
	S:FBPTC="" FBPTC="99" F I=1:1:8 S J=$T(TEXT+I) I $P(J,";;",2)=FBPTC S FBPTC1=$P(J,";;",3) Q
	I FBNAME=FBNM W !?30,$E(FBPTC1,1,16),?48,$E(FBCPT,1,20),?70,$J($FN(FBAMT,",",2),10)
	I FBNAME'=FBNM W !!,$E(FBNAME,1,20),?22,$$SSN^FBAAUTL(DFN,1),?30,$E(FBPTC1,1,16),?48,$E(FBCPT,1,20),?70,$J($FN(FBAMT,",",2),10) S FBNM=FBNAME
	Q
HED	W !?25,"OUTPATIENT COST REPORT",!?24,$$DATX^FBAAUTL(BEGDATE)," THROUGH ",$$DATX^FBAAUTL(ENDDATE),!,?24,Q,!!!,?21,"PATIENT",?31,"TREATING",!,"PATIENT NAME",?21,"  ID",?31,"SPECIALTY",?52,"CPT CODE",?69,"AMOUNT PAID",!,QQ
	Q
CHK	I $Y+5>IOSL,$E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+5>IOSL W @IOF D HED
	Q
PSUM	W !?70,"----------",!?70,$J($FN(FBPAMT,",",2),10)
	S FBPAMT=0
	Q
TEXT	;
	;;00;;SURGICAL
	;;10;;MEDICAL
	;;60;;HOME NURSING SERVICE
	;;85;;PSYCHIATRIC-CONTRACT
	;;86;;PSYCHIATRIC
	;;95;;NEUROLOGICAL-CONTRACT
	;;96;;NEUROLOGICAL
	;;99;;UNKNOWN

FBAADCB
FBAADCB	;AISC/GRR-DISPLAY CLOSED BATCHES ;03JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^FBAA(161.7,"AC","C")) W !!,*7,"There are No Closed Batches that have not been Certified!",!! G Q
	W ! S PGM="START^FBAADCB",VAR="" D ZIS^FBAAUTL G Q:FBPOP
	;
START	U IO S FBAAOUT=0,Q="",$P(Q,"=",80)="=" W:$E(IOST,1,2)="C-" @IOF D HED
	F B=0:0 S B=$O(^FBAA(161.7,"AC","C",B)) Q:B'>0!(FBAAOUT)  I $D(^FBAA(161.7,B,0)) S Z=^(0) D WRT
	F B=0:0 S B=$O(^FBAA(161.7,"AC","A",B)) Q:B'>0!(FBAAOUT)  I $D(^FBAA(161.7,B,0)) S Z=^(0) D WRT
	;
Q	K A,B1,B2,B3,B4,B5,B6,Q,X,ZZ,Z,B,D,Y,FBAAOUT,PRC,PRCSCPAN,DIRUT
	D CLOSE^FBAAUTL Q
	;
HED	W !?22,"FEE BATCHES PENDING RELEASE",!!,"Batch #",?10,"Date Closed",?25,"Clerk Who Opened",?54,"FCP-Obligation #",?72,"Total $",!,Q
	Q
WRT	I $Y+5>IOSL D HANG Q:FBAAOUT
	S B1=$P(Z,"^"),B4=$P(Z,"^",2),B2=$P(Z,"^",13),B2=$E(B2,4,5)_"/"_$E(B2,6,7)_"/"_$E(B2,2,3)
	S B3=$P($G(^VA(200,+$P(Z,"^",5),0)),"^"),B5=$P(Z,"^",9)+.0001,B5=$P(B5,".",1)_"."_$E($P(B5,".",2),1,2)
	D FCP S B4=$S(B6="":B4,1:B6_"-"_B4)
	W !!,B1,?11,B2,?25,B3,?55,B4,?71,$J(B5,8)
	Q
HANG	I $E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	W @IOF D HED
	Q
FCP	;GET FCP FROM IFCAP
	I $P(Z,"^",8)="" S B6="" Q
	S PRC("SITE")=$P(Z,"^",8),PRCS("X")=PRC("SITE")_"-"_B4
	N Z,B,B1,B2,B3,B4,B5,Q
	D EN1^PRCS58
	S B6=$S(Y=-1:"",1:+$P(Y,"^",3))
	Q

FBAADD
FBAADD	;AISC/GRR-REJECT ENTIRE BATCH ;08AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	S DIR(0)="Y",DIR("A")="Are you sure you want to reject all line items in this batch",DIR("B")="NO" D ^DIR K DIR G Q^FBAAVR:$D(DIRUT),RD1^FBAAVR:'Y
	D CK1358^FBAAUTL1 G Q^FBAAVR:$D(FBERR)
	S FBAARA=$P(FZ,"^",9),FBAAON=$P(FZ,"^",2) I FBAARA'>0!($P(FZ,"^",11)'>0) G NOLINE
RR	S DIR(0)="F^2:40",DIR("A")="Enter reason for rejecting (2-40 characters)",DIR("?")="Please enter the reason this item was rejected" D ^DIR K DIR G:$D(DIRUT) Q^FBAAVR S FBRR=X
	D WAIT^DICD,ALLM:FBTYPE="B3",ALLT:FBTYPE="B2",ALLP:FBTYPE="B5",ALLC:FBTYPE="B9"
	G RDD^FBAAVR
ALLM	F J=0:0 S J=$O(^FBAAC("AC",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AC",B,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AC",B,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AC",B,J,K,L,M)) Q:M'>0  D REJM
ADONE	S $P(FZ,"^",9)=0,$P(FZ,"^",10)=0,$P(FZ,"^",11)=0,$P(FZ,"^",17)="Y",^FBAA(161.7,B,0)=FZ
	W !!,"All items in batch flagged as rejected!!" S:FBTYPE'="B9" FBRFLAG=1 Q
REJM	S $P(^FBAAC(J,1,K,1,L,1,M,"FBREJ"),"^",3)=$P(^FBAAC(J,1,K,1,L,1,M,0),"^",8),$P(^(0),"^",8)="",FBIN=$P(^(0),"^",16),$P(^("FBREJ"),"^",1)="P",$P(^("FBREJ"),"^",2)=FBRR,^FBAAC("AH",B,J,K,L,M)=""
	K ^FBAAC("AC",B,J,K,L,M),^FBAAC("AJ",B,FBIN,J,K,L,M) Q
ALLT	F J=0:0 S J=$O(^FBAAC("AD",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AD",B,J,K)) Q:K'>0  D REJT
	G ADONE
REJT	;SETUP REJECT FIELDS FOR TRAVEL
	S $P(^FBAAC(J,3,K,"FBREJ"),"^",3)=$P(^FBAAC(J,3,K,0),"^",2),$P(^(0),"^",2)="" K ^FBAAC("AD",B,J,K) S ^FBAAC("AG",B,J,K)="",$P(^FBAAC(J,3,K,"FBREJ"),"^",2)=FBRR,$P(^("FBREJ"),"^",1)="P"
	Q
ALLP	F J=0:0 S J=$O(^FBAA(162.1,"AE",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAA(162.1,"AE",B,J,K)) Q:K'>0  D REJP
	G ADONE
REJP	S $P(^FBAA(162.1,J,"RX",K,"FBREJ"),"^",1)="P",$P(^("FBREJ"),"^",2)=FBRR,$P(^("FBREJ"),"^",3)=B,$P(^(0),"^",17)="",FBPID=$P(^(0),"^",5),^FBAA(162.1,"AF",B,J,K)="" K ^FBAA(162.1,"AE",B,J,K),^FBAA(162.1,"AJ",B,FBPID,J,K)
	Q
ALLC	F J=0:0 S J=$O(^FBAAI("AC",B,J)) Q:J'>0  S J(0)="P"_"^"_FBRR_"^"_B,^FBAAI(J,"FBREJ")=J(0),$P(^FBAAI(J,0),"^",17)="",^FBAAI("AH",B,J)="" K ^FBAAI("AC",B,J),^FBAAI("AE",B,$P(^FBAAI(J,0),"^",4),J) D
	.S FBAAMT=-($P(^FBAAI(J,0),"^",9)),FBII78=$P(^(0),"^",5),FBMM=$E($P(^(0),U,6),4,5) D INPOST^FBAARD3
	G ADONE
NOLINE	W *7,!!,"Total dollars/Line count of batch is equal zero!",! D Q^FBAAVR G ^FBAAVR
	Q

FBAADEM
FBAADEM	;AISC/DMK-DISPLAY PATIENT DEMOGRAPHICS ;14MAY92
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(IOSL) D HOME^%ZIS
	I $S('$D(DFN):1,'DFN:1,1:0) Q
	S VAPA("P")="" D 6^VADPT G END:VAERR
	S:'$D(IOF) IOF="#" S FBAAOUT=""
	I $E(IOST,1,2)="C-" W @IOF
	W !
	W:+VADM(6) !,*7,"*** Patient Died on ",$P(VADM(6),"^",2)
	W !,VADM(1),?39,"Pt.ID: ",$P(VADM(2),"^",2)
	W !,VAPA(1),?41,"DOB: ",$P(VADM(3),"^",2)
	I VAPA(2)]"" W !,VAPA(2)
	I VAPA(3)]"" W !,VAPA(3)
	W !,VAPA(4),?41,"TEL: ",$S(VAPA(8)]"":VAPA(8),1:"Not on File")
	W !,$P(VAPA(5),"^",2)_" "_$S('+$G(VAPA(11)):VAPA(6),$P(VAPA(11),U,2)]"":$P(VAPA(11),U,2),1:VAPA(6)),?37,"CLAIM #: ",$S(VAEL(7)]"":VAEL(7),1:"Not on File")
	S FBCOUNTY=$S($P(VAPA(7),"^",2)]"":$P(VAPA(7),"^",2),1:"Not on File")
	W !?38,"COUNTY: ",FBCOUNTY
	D ELIG,DIS^DGRPDB
	D INS^DGRPDB
	I '$G(FBPHOUT) D ^FBUINS ;I $D(DIRUT) S FBAAOUT=1 D END Q
	I $G(FBPHOUT),$E(IOST,1,2)="C-" W ! S DIR(0)="E" D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 D END Q
	I $E(IOST,1,2)="C-" W @IOF
	I $D(^FBAAA(DFN,0)) D ^FBAADEM1
	;
END	D KVA^VADPT K FBCOUNTY,FBDEL Q
	;
ELIG	N I,I1 W !!,"Primary Elig. Code: ",$P(VAEL(1),"^",2),"  --  ",$S(VAEL(8)']"":"NOT VERIFIED",1:$P(VAEL(8),"^",2))
	I VAEL(8)]"" S Y=$P($G(^DPT(DFN,.361)),"^",2) W "  " D DT^DIQ
	W !,"Other Elig. Code(s): " I $D(VAEL(1))>9 S (I,I1)=0 F  S I=$O(VAEL(1,I)) Q:'I  S I1=I1+1 W:I1>1 !?21 W $P(VAEL(1,I),"^",2)
	E  W "NO ADDITIONAL ELIGIBILITIES IDENTIFIED"
	Q

FBAADEM1
FBAADEM1	;AISC/DMK-DISPLAY PATIENT DEMOGRAPHICS ;14MAY92
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	N FBDX,FBI,FBRR,FBT,FBTYPE,FBV,FBZ,PSA
	S Y=$G(^FBAAA(DFN,4)) W:$P(Y,"^")]"" !,"Fee ID Card #: ",$P(Y,"^"),?40,"Fee Card Issue Date: " S Y=$P(Y,"^",2) D PDF W Y,!
	S:'$D(FBPROG) FBPROG="I 1" D
	.   I $O(^FBAAA(DFN,1,0)) D  Q:FBAAOUT
	..  D HANG:$Y+5>IOSL Q:FBAAOUT  W !,"Patient Name: ",VADM(1),?55,"Pt.ID: ",$P(VADM(2),"^",2),!!,"AUTHORIZATIONS:",! K FBAUT
	..  S (FBZ,FBI)=0 F  S FBI=$O(^FBAAA(DFN,1,FBI)) Q:'FBI!(FBAAOUT)  I $D(^(FBI,0)) X FBPROG I  S FBZ=FBZ+1,X=^(0) D  Q:FBAAOUT
	... S Y=+X,PSA=$P(X,"^",5),FBT=$P(X,"^",13),FBV=+$P(X,"^",4) D PDF
	... W ?3,"(",FBZ,")",?7,"FR: ",Y,?25,"VENDOR: ",$S($D(^FBAAV(FBV,0)):$P(^(0),"^")_" - "_$P(^(0),"^",2),1:"Not Specified")
	... S FBDX=$G(^FBAAA(DFN,1,FBI,3)) W !?7,"TO: " S Y=$P(X,"^",2) D PDF W Y,!?25,"Authorization Type: " D
	....S FBTYPE=$P(X,"^",3),FBTYPE=$S(FBTYPE=2:"Outpatient - "_$S(FBT=1:"Short Term",FBT=2:"Home Health",FBT=3:"ID Card",1:""),$D(^FBAA(161.8,+FBTYPE,0)):$P(^(0),"^"),1:"Unknown")
	... W FBTYPE W:$P(X,"^",7) !,?11,"Purpose of Visit: ",$P($G(^FBAA(161.82,$P(X,"^",7),0)),"^") I $P(X,"^",9)["FB583(" W !?25,">> Unauthorized Claim <<"
	... W !?11,"DX: ",$P(X,"^",8) W:$P(FBDX,"^")]"" !?15,$P(FBDX,"^") W:$P(FBDX,"^",2)]"" !?15,$P(FBDX,"^",2)
	... S FBAUT($P(X,"^"))=$P(X,"^",2)
	... W !?7,"County: ",FBCOUNTY,?40,"PSA: ",$S($D(^DIC(4,+PSA,0)):$P(^(0),"^"),1:"Unknown"),!
	... S FBDEL=$G(^FBAAA(DFN,1,FBI,"ADEL")) I FBDEL]"" S Y=$P(FBDEL,"^",2) D PDF W ?12,">> DELETE MRA SENT TO AUSTIN ON - ",Y," >>",!
	... I $D(^FBAAA(DFN,1,FBI,2,0)) K ^UTILITY($J,"W") S DIWL=15,DIWR=70,DIWF="W" D HANG:$Y+6>IOSL Q:FBAAOUT  W !?11,"REMARKS:" D
	....S FBRR=0 F  S FBRR=$O(^FBAAA(DFN,1,FBI,2,FBRR)) Q:'FBRR  S (FBXX,X)=^(FBRR,0) D ^DIWP
	... D ^DIWW:$D(FBXX) K FBXX W !
	... K X,FBDX,FBT,FBTYPE,FBV,PSA D HANG:$Y+5>IOSL
	.   D HANG:$Y+5>IOSL Q:FBAAOUT  D:$O(^FBAAA(DFN,2,0))>0  Q:FBAAOUT
	..  W !,"VENDOR CONTACTS:"
	..  S (FBZ,FBI)=0 F  S FBI=$O(^FBAAA(DFN,2,FBI)) Q:'FBI!(FBAAOUT)  S FBZ=FBZ+1,X=$G(^(FBI,0)),Y=+X D PDF D
	... W !?3,"(",FBZ,")",?7,"DATE: ",Y,?25,"VENDOR: ",$P(X,"^",2),?55,"PHONE: ",$S($P(X,"^",3)]"":$P(X,"^",3),1:"Not Found")
	... I $D(^FBAAA(DFN,2,FBI,1,0)) K ^UTILITY($J,"W") S DIWL=20,DIWR=70,DIWF="W" D HANG:$Y+5>IOSL Q:FBAAOUT  W !?11,"NARRATIVE:",! D
	....S FBRR=0 F  S FBRR=$O(^FBAAA(DFN,2,FBI,1,FBRR)) Q:'FBRR  S FBXX=^(FBRR,0) D HANG:$Y+5>IOSL Q:FBAAOUT  S X=FBXX D ^DIWP
	... D ^DIWW:$D(FBXX) K FBXX W !
	Q
	;
HANG	I $E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1
	W @IOF I 'FBAAOUT W !,"Patient Name: ",VADM(1),?55,"Pt.ID: ",$P(VADM(2),"^",2),!
	Q
	;
PDF	S:Y Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3)
	Q

FBAADOB
FBAADOB	;AISC/GRR-DISPLAY OPEN BATCHES ;03JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP S Q="",$P(Q,"=",80)="=",FBAAOUT=0
	I '$D(^FBAA(161.7,"AC","O")) W !!,*7,"There are No Open Batches!",!! G Q
	D HED
	F B=0:0 S B=$O(^FBAA(161.7,"AC","O",B)) Q:B'>0!(FBAAOUT)  I $D(^FBAA(161.7,B,0)) S Z=^(0) D WRT
Q	K A,B1,B2,B3,B4,B5,Q,Z,B,BT,D,FBAAOUT,J,K,POP,X,Y Q
HED	W @IOF W !,"Batch #","  Type",?22,"Dt Open",?32,"Clerk Who Opened",?65,"Obligation #",!,Q
	Q
WRT	I $Y+5>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  W @IOF D HED
	S B1=$P(Z,"^",1),B4=$P(Z,"^",2),B2=$$DATX^FBAAUTL($P(Z,"^",4)),BT=$P(Z,"^",3)
	S BT=$S(BT="B3":"Medical",BT="B5":"Pharmacy",BT="B2":"Travel",BT="B9":"CH/CNH",1:"Unknown")
	S BT=$S($P($G(Z),U,19):BT_"-STAT",1:BT)
	S B3=$S($P(Z,"^",5)]"":$P(Z,"^",5),1:""),B3=$S(B3="":"",$D(^VA(200,B3,0)):$P(^VA(200,B3,0),"^",1),1:"")
	W !!,B1,?7,BT,?22,B2,?32,B3,?65,B4
	Q

FBAADV
FBAADV	;AISC/GRR-FLAG VENDOR FOR DELETION IN CENTRAL FEE ;10JUL86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW
RD	W !! S DIC(0)="AEQM",DIC="^FBAAV(" D ^DIC G END:X="^"!(X=""),RD:Y<0 S DA=+Y I $$CKVEN(DA) W !!?5,*7,"Unable to delete, vendor is Awaiting Austin Approval." G RD
ASK	S DIR(0)="Y",DIR("A")="Are you sure you want to place this vendor in delete status",DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT) END W !! I 'Y W *7,"Not Deleted" G RD
	S DIE="^FBAAV(",DR="9////Y;13////^S X=DT" D LOCK^FBUCUTL(DIE,DA) I FBLOCK D ^DIE L -^FBAAV(DA) K DIE W !!,*7,"Vendor flagged for deletion!" G RD
	W !!,*7,"Unable to delete vendor record at this time." G RD
END	K FBZ,X,DIC,DIRUT,Y,DA,FBLOCK Q
CKVEN(FBVIEN)	;Checks to see if a change or add is pending in the Fee Basis Vendor Corrections file (#161.25)
	;fbvien = internal entry # of vendor from Fee Basis Vendor file (#161.2)
	;output: 1 = change or add awaiting austin approval, 0 = nothing pending, 2 = change or add on linked vendor awaiting austin approval
	N FBVC S FBVC=$P($G(^FBAA(161.25,FBVIEN,0)),U,2,3),FBVC=$TR(FBVC,U) Q $S(FBVC["C":1,FBVC["N":1,$D(^FBAA(161.25,"AF",+FBVIEN)):2,1:0)

FBAAEAR
FBAAEAR	;AISC/GRR-EDIT AUTHORIZATION REMARKS ;05FEB87
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S DA(1)=DFN,DA=FTP,DIE="^FBAAA("_DFN_",1,",DR=".021;.08:.086" D ^DIE K DIE,DR
	Q

FBAAELT
FBAAELT	;AISC/GRR-ENTER/EDIT LETTERS ;22APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	W !! S DLAYGO=161.3,DIC="^FBAA(161.3,",DIC(0)="AEQL" D ^DIC G Q:X=""!(X="^"),RD:Y<0 S DA=+Y,DIE=DIC,DR="[FBAA LETTERS]" D ^DIE G RD
Q	K DIC,DIE,DA,DR,X,Y,D0,DWLW,I,J,X1,Z,DLAYGO Q

FBAAEPI
FBAAEPI	;AISC/GRR-EDIT PREVIOUSLY ENTERED PHARMACY INVOICE ;15MAY86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	W ! S DIC="^FBAA(162.1,",DIC(0)="AEQM",DIC("A")="Select Invoice #: ",DIC("S")="I $P(^(0),U,5)'=4!($P(^(0),U,5)=4&$D(^XUSEC(""FBAASUPERVISOR"",DUZ)))" D ^DIC K DIC("S") G END:X=""!(X="^"),RD:Y<0
	S (DA,FBDA)=+Y,DIE=DIC,DR="1;Q;12;3;5" D ^DIE K DIC
	S DIC="^FBAA(162.1,DA,""RX"",",DIC(0)="AEQM",DIC("W")="W ?30,""DATE RX FILLED: "",$E($P(^(0),U,3),4,5)_""/""_$E($P(^(0),U,3),6,7)_""/""_$E($P(^(0),U,3),2,3)" D ^DIC G END:X=""!(X="^"),RD:Y<0 W !
	S (FBJ,FBK)=0
	;check status of batch rx is in.
	S DA=+Y,DA(1)=FBDA S FBSTAT=$P($G(^FBAA(161.7,+$P($G(^FBAA(162.1,+FBDA,"RX",+DA,0)),U,17),"ST")),U) I FBSTAT]"" D
	.I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) D
	.. I $S(FBSTAT="O":0,FBSTAT="C":0,1:1) D
	... W !,*7,"You cannot edit a payment once released by a supervisor.",! S FBOUT=1 Q
	.I $S(FBSTAT="T":1,FBSTAT="V":1,1:0) D
	.. W !,*7,"You cannot edit an invoice when the batch has a status of transmitted",!,"or vouchered.",! S FBOUT=1
	I $G(FBOUT) D END G FBAAEPI
	S DIE="^FBAA(162.1,FBDA,""RX"",",DR=".01;1;1.5;1.6;3;S FBJ=X;I $P(^FBAA(162.1,DA(1),""RX"",DA,0),U,9)=1 S Y="""";I 1;5;@12;S FBHAP=$P(^FBAA(162.1,DA(1),""RX"",DA,0),U,16);6.5;S FBK=X"
	S DR(1,162.11,1)="I FBK>FBJ S $P(^FBAA(162.1,DA(1),""RX"",DA,0),U,16)=FBHAP W !,*7,""Amount Paid cannot be greater than the Amount Claimed"" S Y=""@12"""
	S DR(1,162.11,2)="S:FBJ=FBK Y=""@5"";6////^S X=FBJ-FBK;Q;6R;7R;S:X'=4 Y=""@6"";20;S Y=""@6"";@5;6///@;7///@;20///@;@6;8"
	D ^DIE
END	K D,DA,DIC,DIE,DR,FBJ,FBK,FBDA,FBOUT,FBSTAT,FBHAP,X,Y
	Q

FBAAESP
FBAAESP	;AISC/GRR-ENTER SITE PARAMETERS ;08JUN88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	W !! S DIC("A")="Select Site: ",DIC="^FBAA(161.4,",DIC(0)="AELQ",DLAYGO=161.4 D ^DIC K DIC("A") G END:X=""!(X="^"),RD:Y<0 S DA=+Y
	S DIE=DIC,DR="[FBAA SITE PARAMETERS]" D ^DIE G RD
END	K DIC,DLAYGO,Y,X,DIE,V,W,Z,DR,DA Q

FBAAETA
FBAAETA	;AISC/GRR,DMK/CMR-ENTER TRAVEL PAYMENT ONLY ;05JAN87
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	;set site parameters
	S:$G(FBAAPTC)']"" FBAAPTC="R"
	D SITE^FBAACO G END:$G(FBPOP)
	;get veteran
	D GETVET^FBAAUTL1 I '$G(DFN) D END Q
	;get authorization
	D GETAUTH^FBAAUTL1 G RD:'$G(FTP)
	;call to verify veteran address data
	D ^FBAACO0
	;if site parameter set to 'yes' allow edit of authorization remarks
	D ^FBAAEAR:$P(FBSITE(1),U,4)="Y"
	;check for travel multiple dd reference
	S DA(1)=+$G(DFN)
	I '$D(^FBAAC(DA(1),3,0)) S ^(0)="^162.04DA^^"
RD1	W !! S DIC="^FBAAC(DA(1),3,",DIC(0)="AEQLM",DLAYGO=162 D ^DIC K DLAYGO
	G END:X="^"!(X=""),RD1:Y<0 S DA=+Y,FBNEW=$P(Y,"^",3)
	S FBTRVDT=$P(Y,U,2)
	;check if travel date within selected authorization if 'kill and reask
	I $G(FBAABDT),$G(FBAAEDT),(FBTRVDT<FBAABDT!(FBTRVDT>FBAAEDT)) D  D KILL G RD1
	. W !!,*7,"Date of Travel is ",$S(FBTRVDT<FBAABDT:"prior to",1:"after")," authorization date.",!
	;set travel payment
	S DIE=DIC,DR=".01;1;2;3.5///^S X=FBAAPTC" D ^DIE I $G(FBNEW)&($D(Y)'=0) D KILL,END
	G RD
	;
END	K DIC,DIE,DR,X,Y,DA,C,D0,D1,DI,DIYS,Z,FBNEW,DLAYGO,FB1,FB2,FBTRVDT
	D Q^FBAACO
	Q
KILL	;KILLS ENTRY IF USER UP-ARROWED DURING ENTRY
	W !!,*7,"Travel Payment entry not complete.   Deleting entry..."
	S DIK="^FBAAC("_DA(1)_",3," D ^DIK Q

FBAALB
FBAALB	;AISC/GRR-LIST PAYMENT RECORDS FOR A BATCH ;01JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
BT	K FBAANQ W !! S DIC="^FBAA(161.7,",DIC(0)="AEQM" D ^DIC G Q:X="^"!(X=""),BT:Y<0 S B=+Y,Z=^FBAA(161.7,B,0),FBTYPE=$P(Z,"^",3)
	S VAR="FBTYPE^B",VAL=FBTYPE_"^"_B,PGM="START^FBAALB" D ZIS^FBAAUTL G:FBPOP Q S:IO=IO(0) FBAANQ=1
START	S Q="",$P(Q,"=",80)="=",FBAAOUT=0 U IO W:$E(IOST,1,2)="C-" @IOF D ENM^FBAACCB:FBTYPE="B3",ENP^FBAACCB:FBTYPE="B5",ENT^FBAACCB0:FBTYPE="B2",PRTC^FBAACCB1:FBTYPE="B9"
	G:$D(FBAANQ) BT
Q	D CLOSE^FBAAUTL K DIC,A,B,J,K,L,M,D,T,Y,Z,FBAANQ,FBAAOUT,FBTYPE,FBAC,FBAP,FBFD,FBPDT,FBSC,FBTD,A1,A2,CPTDESC,FBAACPT,FBIN,N,PGM,Q,S,V,VAL,VAR,VID,XY,ZS,FBVP,FBPV,DK,FBINTOT,FBINOLD,HDUZ,I,X,FBDX,FBI,FBK,FBL,FBPROC Q

FBAALPI
FBAALPI	;AISC/GRR-LIST INVOICES READY FOR MAS COMPLETION ;27MAR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW I '$D(^FBAA(162.1,"AC",2)) W !!,*7,"There are no Invoices pending completion!" Q
	D HOME^%ZIS W @IOF,?5,"Pharmacy Invoices Pending MAS completion",! S C=0,FBAAOUT=0
	F J=0:0 S J=$O(^FBAA(162.1,"AC",2,J)) Q:J'>0!FBAAOUT  I $D(^FBAA(162.1,J,"RX","AC",2)) S C=0 F K=0:0 S K=$O(^FBAA(162.1,J,"RX","AC",2,K)) D:K'>0!FBAAOUT&(C>0) WRT Q:K'>0  S C=C+1
	G END:FBAAOUT I C'>0 W !!,"No invoices Pending MAS completion.",! G END
RD	S DIR(0)="Y",DIR("A")="Want to complete one of them now",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT)!'Y END
	G ^FBAACIE
END	K C,J,K,X,Y,DIC,DIRUT,FBAAOUT,FBMDF,J,S,UL,ULL,Z,ZZ,K,PI Q
WRT	I ($Y+2)>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  W @IOF,?5,"Pharmacy Invoices Pending MAS completion",!
	W !,"Invoice No: ",J," has ",C," line items to be completed"
	Q

FBAALU
FBAALU	;AISC/GRR-CPT CODE LOOKUP ;02APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	S UL="==================",FBGOT=0 G RDIC
CHK	S DIR(0)="Y",DIR("A")="Is this correct",DIR("B")="YES" D ^DIR K DIR G END:$D(DIRUT),RD:'Y S FBGOT=1
END	K N,L,M,O,P,DIRUT Q
RDIC	S DIC="^ICPT(",DIC(0)="AQE",DIC("A")="Select Service Provided: " D ^DIC K DIC("A") G:X="^"!(X="") END G:Y<0 RDIC S DA=+Y,P=$P(Y,"^",2),FBX=P,FBAACP=+Y
	S SUB=$P(^ICPT(DA,0),"^",3),SUBN=$S(SUB']"":"",$D(^DIC(81.1,SUB,0)):$P(^(0),"^",1),1:""),MAJN=$S(SUBN="":"",1:$P(^(0),"^",3)),MAJN=$S(MAJN="":"",$D(^DIC(81.1,MAJN,0)):$P(^(0),"^",1),1:"")
	W !!,"Major Category: ",MAJN,!,?2,"Sub-Category: ",SUBN
WPROC	W !,?6,"Procedure: ",$P(^ICPT(DA,0),"^",2),!!,?20,"Detail Description ",!,?20,UL F ZZ=0:0 S ZZ=$O(^ICPT(DA,"D",ZZ)) Q:ZZ'>0  W !,^(ZZ,0)
	G CHK

FBAAMP
FBAAMP	;AISC/CMR-MULTIPLE PAYMENT ENTRY ;13AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBMP=1 ;multiple payment flag
	G ^FBAACO
1	;return from FBAACO
	K FBAAOUT W ! D ^FBAALU I X=""!(X="^")!('FBGOT) G Q1
	K FBMOD W ! S DIR(0)="162.03,39" D ^DIR I +Y>0 S FBMOD=+Y
	S FY=$E(DT,1,3)+1700+$S($E(DT,4,5)>9:1,1:0)
AMTCL	S DIR(0)="162.03,1",DIR("A")="Amount Claimed:  $",DIR("?")="Enter the amount being claimed by the vendor" D ^DIR K DIR G Q:$D(DIRUT) S FBJ=+Y
	W ! S DIR("A")="Is $"_FBJ_" correct for Amount Claimed",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR G Q:$D(DIRUT),AMTCL:'Y
RDAP	D FEE G Q:$G(FBAAOUT) S FBK=FBAMTPD
	W ! S DIR("A")="Is $"_FBK_" correct for Amount Paid",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR G Q:$D(DIRUT),RDAP:'Y
	S FBAAAS=0 I FBJ-FBK D SUSP^FBAAMP1 I $G(FBAAOUT) G Q:$D(DUOUT),Q1
	S FBJ=+FBJ,FBK=+FBK,FBAAAS=+FBAAAS
	D HCFA^FBAAMP1 G Q1:$G(FBAAOUT)
MULT	W:FBINTOT>0 !,"Invoice: "_FBAAIN_" Totals: $ "_FBINTOT
	W !! S %DT("A")="Date of Service: ",%DT="AEPX" D ^%DT G Q1:X=""!(X="^")
	D DATCK^FBAAUTL G MULT:'$D(X)!(Y<0)
	S FBDT=Y S DIR(0)="Y",DIR("A")="Is "_($$DATX^FBAAUTL(FBDT))_" correct",DIR("B")="Yes" D ^DIR K DIR G MULT:$D(DIRUT)!('Y)
	S FBAADT=FBDT
	I $D(^FBAAC("AE",DFN,FBV,FBAADT,FBAACP_$S($G(FBMOD)]"":"-"_FBMOD,1:""))) S DIR(0)="Y",DIR("A")="Code already exists for that date!  Want to add another service for the SAME DATE",DIR("B")="No" D ^DIR K DIR G MULT:$D(DIRUT)!('Y)
	W !! D GETSVDT^FBAACO5(DFN,FBV,FBASSOC,0,FBAADT) G Q:$G(FBAAOUT)
	D SETO^FBAACO3,SVCPR^FBAACO1 G Q:$G(FBAAOUT) D PPT^FBAACO1
FILE	S TP="",DR="1///^S X=FBJ;Q;2///^S X=FBK"
	S DR=DR_$S(FBJ-FBK:";3///^S X=FBAAAS;3.5////^S X=DT;4////^S X=FBAASC;D DESC^FBAAMP1",1:"")
	S DR(1,162.03,1)="6////^S X=DUZ;7////^S X=FBAABE;8////^S X=BO;13///^S X=FBAAID;14///^S X=FBAAIN;15///^S X=FBPT;16////^S X=FBPOV;17///^S X=FBTT;18///^S X=FBAAPTC;23////^S X=2;26////^S X=FBPSA"
	S DR(1,162.03,2)="34///^S X=$G(FBAAMM1);28////^S X=FBHCFA(28);30////^S X=FBHCFA(30);31////^S X=FBHCFA(31);32////^S X=FBHCFA(32);33///^S X=FBAAVID"
	S DIE="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DA=FBAACPI,DA(1)=FBSDI,DA(2)=FBV,DA(3)=DFN D LOCK^FBUCUTL(DIE,FBAACPI,1),^DIE L -^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI) S FBINTOT=FBINTOT+FBK W " ....OK, DONE...."
	I FBK>0 S Z1=$P(^FBAA(161.7,FBAABE,0),"^",11)+1,$P(^(0),"^",11)=Z1
	W:Z1>(FBAAMPI-20) !,*7,"Warning, you can only enter ",(FBAAMPI-Z1)," more line items!" I Z1>(FBAAMPI-1) D  S FBMAX=1 G Q1
	.W !!,*7,"You have reached the maximum number of payments for a Batch!",!,"You must select another Batch for entering Payments!"
	G MULT
Q1	K FBAADT,FBX,FBAACP,DIC,DIE,X,Y,DIRUT,DUOUT,DTOUT,FBOUT,FBSI G ^FBAACO:$D(FBMAX),1^FBAACO
	;
Q	;kill variables and exit
	D Q^FBAACO
	Q
FEE	S FBFY=FY-1,FBAMFS=$$FEELU^FBAAUTL4(FBAACP,FBFY,$G(FBMOD))
	S FBAMFS=$S($G(FBJ)>FBAMFS:FBAMFS,1:FBJ)
	I $G(FBCHCO) S FBAMFS=""
AMTPD	S DIR(0)="162.5,9",DIR("A")="Amount Paid: $",DIR("B")=$G(FBAMFS),DIR("?")="^D HELP1^FBAAMP" K:$G(FBAMFS)="" DIR("B") D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 Q
	I +Y>FBJ W !!,*7,"Amount paid cannot be greater than the amount claimed." G AMTPD
	I FBAMFS]"" I +Y>FBAMFS&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"You must be a holder of the 'FBAASUPERVISOR' key in order to",!,"exceed the Fee Schedule.",! G AMTPD
	S FBAMTPD=+Y K FBAMFS Q
HELP1	W !!,"Enter a dollar amount that does not exceed the amount claimed.",!
	I FBAMFS>0 W "Only the holder of the 'FBAASUPERVISOR' key may exceed the",!,"Fee Schedule.",!
	Q
	;
ANCIL	;ENTRY POINT FOR mutiple ancillary payment option
	S FBCHCO=1 D ^FBAAMP
	K FBCHCO Q

FBAAMP1
FBAAMP1	;AISC/CMR-MULTIPLE PAYMENT ENTRY ;13AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
SUSP	;enter suspense data
	S DIR(0)="162.5,9",DIR("A")="Amount Suspended: $",DIR("B")=FBJ-FBK,DIR("?")="Press Return if $ "_(FBJ-FBK)_" is Amount Suspended, otherwise enter correct suspension amount" D ^DIR K DIR
	I $D(DIRUT) W !!,"Invalid entry, enter a number between .01 and 999999" G SUSP
	S FBAAAS=+Y
	I +Y'=(FBJ-FBK) S FBAAAS=+Y W ! S DIR("A")="Is $"_FBAAAS_" correct for Amount Suspended",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR I $D(DIRUT) S FBAAOUT=1 Q
	G SUSP:'Y
	W !! S DIC="^FBAA(161.27,",DIC(0)="AEQ" D ^DIC I X["^" S FBAAOUT=1 Q
	S FBAASC=+Y
SUSP1	I FBAASC=4 K ^TMP($J,"FBWP") W !!,"Suspension Description: " S DIC="^TMP($J,""FBWP"",",DWLW=80,DWPK=1 D EN^DIWE K DIC,DWLW,DWPK I '$O(^TMP($J,"FBWP",0)) W !!,*7,"Description of Suspense is required." G SUSP1
	Q
HCFA	F FBSI=28,30,31,32 S FBHCFA(FBSI)=""
	W ! F FBSI=28,30,31 S DIR(0)="P"_$S(FBSI=28&($$EXTPV^FBAAUTL5(FBPOV)="01"):"O^80",FBSI=28&($$EXTPV^FBAAUTL5(FBPOV)'="01"):"^80",FBSI=30:"O^353.1",FBSI=31:"O^353.2")_":EMZ" D HCFA1 Q:$G(FBAAOUT)
	Q:$G(FBAAOUT)  W ! I $$EXTPV^FBAAUTL5(FBPOV)'="01" S FBSI=32,DIR(0)="Y",DIR("A")="Service connected condition"
	S DIR("?")="^W !!,""Respond by answering 'Yes' or 'No'."",! I $G(DFN) W !?1,*7,""Patient:  "",$$NAME^FBCHREQ2(DFN) D DIS^DGRPDB W !!" D HCFA1 I $D(DIRUT) S FBAAOUT=1 Q
	Q
HCFA1	D ^DIR I $D(DTOUT)!($D(DUOUT)) S FBAAOUT=1 Q
	I Y'=-1 D
	.I DIR(0)["P" S FBHCFA(FBSI)=$P(Y,"^")
	.I DIR(0)="Y" S FBHCFA(FBSI)=$S(Y=1:"Y",1:"N")
	K DIR Q
DESC	N FBJ
	I FBAASC=4,$D(^TMP($J,"FBWP",0)) S ^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,1,0)=^(0) F FBJ=1:1 Q:'$D(^TMP($J,"FBWP",FBJ,0))  S ^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,1,FBJ,0)=^(0)
	Q

FBAAMPG1
FBAAMPG1	;AISC/DMK/CMR-PURGE TRANSMITTED MRA'S ;07JUL89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S:'$D(DTIME) DTIME=999 I '$D(DT) S %DT="",X=T D ^%DT S DT=Y K X,Y
	I '$D(^FBAA(161.25,"AD")),'$D(^FBAA(161.26,"AD")) G END ;W !!,*7,"No transmitted MRA's currently on file!",! G END
	S (CNT,MCNT)=0
	F I=0:0 S I=$O(^FBAA(161.26,"AD",I)) Q:I'>0!(I>DT)  F J=0:0 S J=$O(^FBAA(161.26,"AD",I,J)) Q:J'>0  I $D(^FBAA(161.26,J,0)) S DA=J D DELVET S CNT=CNT+1
	F I=0:0 S I=$O(^FBAA(161.25,"AD",I)) Q:I'>0!(I>DT)  F J="O","P" F K=0:0 S K=$O(^FBAA(161.25,"AD",I,J,K)) Q:K'>0  I $D(^FBAA(161.25,K,0)),($S($P(^(0),"^",3)="C":0,$P(^(0),"^",2)="C":0,$P(^(0),"^",3)="N":0,$P(^(0),"^",2)="N":0,1:1)) D
	.S DA=K D DELVEN S MCNT=MCNT+1
	F I="O","P" F J=0:0 S J=$O(^FBAA(161.25,"AE",I,J)) Q:'J  I $D(^FBAA(161.25,J,0)),'$D(^FBAAV(J,0)) S DA=J D DELVEN S MCNT=MCNT+1
	F I=0:0 S I=$O(^FBAA(161.26,"AC","P",I)) Q:'I  I $D(^FBAA(161.26,I,0)) S J=+$P(^(0),"^",3) I '$D(^FBAAA(I,1,J,0)) S DA=I D DELVET S CNT=CNT+1
BULLET	S XMB(1)=CNT,XMB(2)=MCNT,XMB="FBAA PURGE TRANSMITTED MRA'S",XMDUZ=$S($G(DUZ):DUZ,1:.5) D ^XMB
END	K F,I,J,K,CNT,MCNT,FBAAPD,X,Y Q
DELVET	S DIK="^FBAA(161.26," D ^DIK Q
DELVEN	S DIK="^FBAA(161.25," D ^DIK Q

FBAAMPRG
FBAAMPRG	;AISC/DMK-PURGE TRANSMITTED MRA'S ;07JUL89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASK	W !! S %DT("A")="Purge Veteran and Vendor MRA's transmitted PRIOR to: ",%DT="AEXP",%DT(0)=-DT D ^%DT K %DT G END:X="^"!(X=""),ASK:Y<0 S FBAAPD=Y
	I '$D(^FBAA(161.25,"AD")),'$D(^FBAA(161.26,"AD")) W !!,*7,"No transmitted MRA's currently on file!",! G END
	S (CNT,MCNT)=0 W !,?25,"Deleting....",!
	F I=0:0 S I=$O(^FBAA(161.26,"AD",I)) Q:I'>0!(I>FBAAPD)  F J=0:0 S J=$O(^FBAA(161.26,"AD",I,J)) Q:J'>0  I $D(^FBAA(161.26,J,0)) S DA=J D DELVET S CNT=CNT+1
	F I=0:0 S I=$O(^FBAA(161.25,"AD",I)) Q:I'>0!(I>FBAAPD)  F J="O","P" F K=0:0 S K=$O(^FBAA(161.25,"AD",I,J,K)) Q:K'>0  I $D(^FBAA(161.25,K,0)),($S($P(^(0),"^",3)="C":0,$P(^(0),"^",2)="C":0,$P(^(0),"^",3)="N":0,$P(^(0),"^",2)="N":0,1:1)) D
	.S DA=K D DELVEN S MCNT=MCNT+1
	F I="O","P" F J=0:0 S J=$O(^FBAA(161.25,"AE",I,J)) Q:'J  I $D(^FBAA(161.25,J,0)),'$D(^FBAAV(J,0)) S DA=J D DELVEN S MCNT=MCNT+1
	F I=0:0 S I=$O(^FBAA(161.26,"AC","P",I)) Q:'I  I $D(^FBAA(161.26,I,0)) S J=+$P(^(0),"^",3) I '$D(^FBAAA(I,1,J,0)) S DA=I D DELVET S CNT=CNT+1
	W !!,?16,"Total Veteran MRA's deleted: ",CNT,!,?16,"Total Vendor MRA's deleted: ",MCNT,!
END	K F,I,J,K,CNT,MCNT,FBAAPD,X,Y Q
DELVET	S DIK="^FBAA(161.26," D ^DIK Q
DELVEN	S DIK="^FBAA(161.25," D ^DIK Q

FBAAOB
FBAAOB	;AISC/GRR-OPEN BATCHES ;29JUL86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D:'$D(DT) DT^DICRW D:'$D(FBSITE(1)) SITEP^FBAAUTL G:+$G(FBPOP) KILL
	I '$D(^FBAA(161.4,1,0)) W !!,*7,"Site Parameters have not been entered. Must be entered",!,"before using this option",! Q
	S DIC="^FBAA(161.7,",DIC(0)="LQ",DLAYGO=161.7
RMED	S DIR(0)="Y",DIR("A")="Want to create a Medical batch",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT) KILL I Y D MED,KILL Q
RPHARM	S DIR(0)="Y",DIR("A")="Want to create a Pharmacy Batch",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT) KILL I Y D PHARM,KILL Q
	Q:$D(FBPHOPT)
RTRAV	S DIR(0)="Y",DIR("A")="Want to create a Travel Batch",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT) KILL I Y D TRAV,KILL Q
	D KILL Q
TRAV	D GETNXB^FBAAUTL W !!,"Travel Batch number assigned is: ",FBBN
	W !! S X=FBBN,DIC(0)="LEQ",(DIE,DIC)="^FBAA(161.7,",DIC("DR")="",DLAYGO=161.7 D ^DIC K DLAYGO G:Y<0 UHOH S FBDA=+Y
	D GETOB Q:'$D(FBSTN)  S DA=FBDA,DR="[FBAA TRAV IFCAP]" D ^DIE,KILL
	Q
MED	D GETNXB^FBAAUTL W !!,"Medical Batch number assigned is: ",FBBN
	W !! S X=FBBN,DIC(0)="LEQ",(DIE,DIC)="^FBAA(161.7,",DIC("DR")="",DLAYGO=161.7 D ^DIC K DLAYGO G:Y<0 UHOH S FBDA=+Y,FBY=Y K DR
	D GETOB Q:'$D(FBSTN)  S DA=FBDA,DR="[FBAA MED IFCAP]" D ^DIE,KILL
	Q
PHARM	D GETNXB^FBAAUTL W !!,"Pharmacy Batch number assigned is: ",FBBN
	W !! S X=FBBN,DLAYGO=161.7,DIC(0)="LEQ",(DIE,DIC)="^FBAA(161.7,",DIC("DR")="" D ^DIC G:Y<0 UHOH S FBDA=+Y,FBY=Y K DR,DLAYGO
	D GETOB Q:'$D(FBSTN)  S DA=FBDA,DR="[FBAA PHARM IFCAP]" D ^DIE,KILL
	Q
RCHNH	I '$D(FBSITE(1)) D SITEP^FBAAUTL G:FBPOP KILL
	S DIR(0)="Y",DIR("A")="Want to create a Community Nursing Home batch",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT) KILL I Y D CHNH,KILL
	D KILL Q
CHNH	D GETNXB^FBAAUTL W !!,"Batch number assigned is: ",FBBN
	W !! S X=FBBN,DLAYGO=161.7,DIC(0)="LQ",(DIE,DIC)="^FBAA(161.7,",DIC("DR")="" D ^DIC G:Y<0 UHOH S FBDA=+Y K DR,DLAYGO
	D GETOB Q:'$D(FBSTN)  S DA=FBDA,DR="[FB CHNH OPEN BATCH]" D ^DIE,KILL
	Q
GETOB	S PRCS("A")="Select Obligation Number: " K PRCS("X"),DR S PRCS("TYPE")="FB" D EN1^PRCS58 G:Y=-1 BACKOUT S FBSTN=$E($P(Y,"^",2),1,3),FBOBN=$P($P(Y,"^",2),"-",2) K PRCS D:$S($G(FBSTN)']"":1,$G(FBOBN)']"":1,1:0) BACKOUT Q
	;
BACKOUT	S DIK="^FBAA(161.7,",DA=FBDA D ^DIK W !,*7,"Batch # ",FBBN," deleted because Obligation number was not selected!",!,"You must be an authorized user in IFCAP package to select an obligation." K FBSTN Q
	;
RCHOP	I '$D(FBSITE(1)) D SITEP^FBAAUTL G:FBPOP KILL
	S DIR(0)="Y",DIR("A")="Want to create a Contract Hospital Batch",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT)!('Y) KILL I Y D CH
	;FBAABE is set from FBCHEP to ask user to open a new batch
	I $D(FBAABE) S FBAABE=FBDA
	D KILL Q
CH	D GETNXB^FBAAUTL W !!,"Batch number assigned is: ",FBBN
	S DLAYGO=161.7
	W !! S X=FBBN,DIC(0)="LQ",(DIE,DIC)="^FBAA(161.7,",DIC("DR")="",DLAYGO=161.7 D ^DIC G:Y<0 UHOH S FBDA=+Y K DR,DLAYGO
	D GETOB Q:'$D(FBSTN)  S DA=FBDA,DR="[FB CH OPEN BATCH]" D ^DIE
	Q
ANCOB	I '$D(FBSITE(1)) D SITEP^FBAAUTL G:FBPOP KILL
	S DLAYGO=161.7
	S DIR(0)="Y",DIR("A")="Want to create an Ancillary Payment Medical Batch",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT) KILL I Y D MED,KILL
	D KILL Q
UHOH	W !!,*7,"Batch was not created!" Q
KILL	K DA,D,DR,DIC,DIE,DIK,FBDA,FBOBN,FBPOP,FBSTN,FBSITE,Y,FBY,PRC,X,FBBN,Z,DLAYGO,D0,DQ,DIRUT,PRCSCPAN
	Q

FBAAODP
FBAAODP	;AISC/GRR-DELETE PAYMENT ;02APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S:'$D(^FBAAC(DFN,1,0)) ^FBAAC(DFN,1,0)="^162.01P^0^0"
RDV	W !! S DIC="^FBAAC("_DFN_",1,",DIC(0)="AEQM",DA(1)=DFN D ^DIC G Q:X="^"!(X=""),RDV:Y<0 S (FBV,DA)=+Y
	I '$D(^FBAAC(DFN,FBV,"AD")) W !,"Vendor has no prior claims",! G RDV
	D EN1^FBAAVS
RDATE	K FBSDI,FBAACPI W !! I '$D(^FBAAC(DFN,1,FBV,1,0)) S ^FBAAC(DFN,1,FBV,1,0)="^162.02DA^0^0"
	S DA(2)=DFN,DA(1)=FBV,DIC(0)="AEQM",DIC("A")="Date of Service: ",DIC="^FBAAC("_DFN_",1,"_FBV_",1," D ^DIC K DIC,DA G RDV:X="^"!(X=""),RDATE:Y<0 S FBSDI=+Y,FBAADT=$P(Y,"^",2)
	I '$D(^FBAAC(DFN,1,FBV,1,FBSDI,1,0)) S ^FBAAC(DFN,1,FBV,1,FBSDI,1,0)="^162.03A^0^0"
LOOK	G CHKE
Q	K FBAADT,FBX,FBAACP,FBAAOBN,FBAAODUZ,FBAAOPA,FBAACPI,FBSDI,FBMOD Q
CHKE	S DIC="^FBAAC("_DFN_",1,"_FBV_",1,"_FBSDI_",1,",DIC(0)="AEQM",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI D ^DIC Q:X=""!(X="^")  G RDATE:Y<0 S (FBAACPI,DA)=+Y D SETO
	I FBAABE'=FBAAOBN W !,*7,"Sorry, that payment is not in the Batch you selected!",*7 G RDATE
RD	W ! S DIR("A")="Are you sure you want to delete this payment record",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR Q:$D(DIRUT)  I 'Y G RDATE
	S DIK=DIC D ^DIK D  K A,B,J,K W !,"Payment record Deleted!",! G RDATE
	.; reset batch total and line count
	. I +$G(FBAABE) N DA,FBTOTAL,FBLCNT D CNTTOT^FBAARB(+FBAABE) D
	..S DA=+FBAABE,DIE="^FBAA(161.7,",DR="10////^S X=FBLCNT;8////^S X=FBTOTAL;S:FBLCNT!(FBTOTAL) Y="""";9///@" D ^DIE K DIE,DR
	..S:FBTOTAL=0 $P(^FBAA(161.7,+FBAABE,0),U,9)=""
	..S:FBLCNT=0 $P(^FBAA(161.7,+FBAABE,0),U,11)=""
	Q
SETO	S FBAAOPA=$S($P(Y,"^",3)=1:0,$D(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0)):$P(^(0),"^",3),1:0),FBAAODUZ=$P(^(0),"^",7),FBAAOBN=$P(^(0),"^",8)
	S FY=$E(FBAADT,1,3)+1700+$S($E(FBAADT,4,5)>9:1,1:0)
	Q

FBAAODP0
FBAAODP0	;AISC/GRR-DELETE PAYMENT ;05APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW
BT	S DIC="^FBAA(161.7,",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"I $G(^(""ST""))=""O"",$P(^(0),U,3)=""B3""",1:"I $P(^(0),U,5)=DUZ,$P(^(0),U,3)=""B3"",$G(^(""ST""))=""O""")
	S DIC(0)="AEQM",DIC("W")="W ""  Obligation #: "",$P(^(0),U,2)" W !! D ^DIC K DIC("W"),DIC("S")
	G Q:X["^"!(X="") I Y>0 S (DA,FBAABE)=+Y
	S FBAABO=$P(^FBAA(161.7,DA,0),"^",2)
1	I '$D(FBPROG) D SITEP^FBAAUTL S FBPROG=$S($P(FBSITE(1),"^",6)="":"I 1",1:"I $P(^(0),U,3)=2")
	D GETVET^FBAAUTL1 G BT:'DFN
	D GETAUTH^FBAAUTL1 G 1:FTP']""
	D ^FBAAODP G 1
Q	K DIC,CNT,Y,X,X1,I,DIC,D0,DFN,A1,A2,B1,B2,DA,DR,F,FBI,FBPROG,FBRR,FBXX,PTYPE,FBAABDT,FBAABE,FBAABO,FBAACPT,FBAAEDT,FBAAPD,FBAATA,FBDX,FBGOT,FBIN,FBPOV,FBPT,FBTT,FBTYPE,FY,H,HDA,HOLDDA,MAJN,PI,Q,SUB,SUBN,UL,Z,ZS,ZZ
	K A,TA,FBAAOUT,FBAUT,L,K,V,FBVEN,FTP,FBSITE,FBLOC,FBASSOC,FB7078,FBPSA,FBAADT,FBAAOBN,FBAAODUZ,FBAAOPA,FBPOP,FBST,FBV,FBAOT,FBVCHDT,FB583
	Q

FBAAPAA
FBAAPAA	;AISC/DMK-ADD/EDIT FEE SCHEDULE ;07JUL89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASK	W ! S DIC="^FBAA(163.99,",DIC(0)="AEQLM",DLAYGO=163.99 D ^DIC G END:X=""!(X="^"),ASK:Y<0 S DA=+Y
	W ! S DIE=DIC,DR="[FBAA EDIT SCHEDULE]" D ^DIE G ASK
END	K DA,DIC,DIE,DLAYGO,DR,X,Y Q
WRITE	;write CPT & MOD as identifiers
	N FBAAFS
	S FBAAFS=$P(^FBAA(163.99,+Y,0),U)
	I $X>19 W !
	W ?20,"CPT: ",$P(^ICPT(+$O(^ICPT("B",$P(FBAAFS,"-"),0)),0),U,2)
	I $P(FBAAFS,"-",2)]"" W !?20,"MOD: ",$P(^DIC(81.3,+$O(^DIC(81.3,"B",$P(FBAAFS,"-",2),0)),0),U,2)
	Q

FBAAPAY
FBAAPAY	;AISC/DMK-COMPILE CPT CODE SCHEDULE ;23MAR89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASKDT	S FBFL=0,FBFY="" W !!,?20,"*** DATE RANGE SELECTION ***",!!,?12,"Enter fiscal year or date range within fiscal year.",!!
	S %DT="AE",%DT("A")="  Beginning Date : " D ^%DT Q:Y<0  G FYCK:'$E(Y,4,7) S BEGDATE=Y-.1,%DT(0)=Y W ! S %DT("A")="  Ending Date : " D ^%DT K %DT Q:Y<0  W ! D DATECK G:FBFL ASKDT S ENDDATE=Y+.9
QUE	S VAR="BEGDATE^ENDDATE^FBFY",VAL=BEGDATE_"^"_ENDDATE_"^"_FBFY,PGM="START^FBAAPAY" D ZIS^FBAAUTL G END:FBPOP
	;
START	K ^TMP($J) S (CNT,PAY)="",%DT="X",X="TODAY" D ^%DT S FBRUN=Y_"^"_BEGDATE_"^"_ENDDATE,FBFY=FBFY+1700
	;
RD	F I=0:0 S I=$O(^FBAAC(I)) Q:I'>0  F J=0:0 S J=$O(^FBAAC(I,1,J)) Q:J'>0  I $D(^(J,0)) F K=0:0 S K=$O(^FBAAC(I,1,J,1,K)) Q:K'>0  I $D(^(K,0)) D RD1
	S I=0 F  S I=$O(^TMP($J,I)) Q:I=""  I +^(I)>7 S VARR=+^(I) D SET,80
	S ^FBAA(163.99,"AC",FBFY,FBFY)="" D START^FBAASOUT
	;
END	K AC,AP,%DT("A"),FBCPT,FBAAFY,FBEDT,FBRUN,PGM,Q,QQ,VAL,FBFL,FBFY,VARR,CNT,NUM,NUM1,PAY,I,II,J,K,L,NOD,VAR,X,Y,ZZ,BEGDATE,ENDDATE ;,^TMP($J),FBDESC,FBI
	D CLOSE^FBAAUTL Q
	;
SET	S FBI=$O(^FBAA(163.99,"B",I,0)) D:'FBI
	.S X=I,DIC(0)="L",DIC="^FBAA(163.99,"
	.K DD,DO D FILE^DICN Q:Y<0  S FBI=+Y K DIC,DD,DO
	Q:'$G(FBI)
	S:'$D(^FBAA(163.99,FBI,"FY",0)) ^FBAA(163.99,FBI,"FY",0)="^163.991A^^"
	S Y(2)=^FBAA(163.99,FBI,"FY",0),$P(Y(2),"^",3)=FBFY,$P(Y(2),"^",4)=$P(Y(2),"^",4)+1,^FBAA(163.99,FBI,"FY",0)=Y(2)
	S ^FBAA(163.99,FBI,"FY",FBFY,0)=FBFY_"^"_VARR
	Q
RD1	I +^FBAAC(I,1,J,1,K,0)>BEGDATE&(+^FBAAC(I,1,J,1,K,0)<ENDDATE) F L=0:0 S L=$O(^FBAAC(I,1,J,1,K,1,L)) Q:L'>0  I $D(^(L,0)) D LOOK
	Q
LOOK	S Y(1)=^FBAAC(I,1,J,1,K,1,L,0),FBMOD=$$CPTMOD^FBAAUTL4(I,J,K,L,1),FBMOD=$$MOD^FBAAUTL4(FBMOD),II=$$CPT^FBAAUTL4($P(Y(1),"^"))_$S($G(FBMOD)]"":"-"_FBMOD,1:"")
	S AC=$P(Y(1),"^",2),AP=$P(Y(1),"^",3) S:'$D(^TMP($J,II)) ^TMP($J,II)=0
	I AP>0 S Y=^TMP($J,II),$P(^(II),"^",1)=$P(Y,"^",1)+1,$P(^(II),"^",2)=$P(Y,"^",2)+AC,$P(^(II),"^",3)=$P(Y,"^",3)+AP,CNT=CNT+1,^TMP($J,II,+AC,+AP,CNT)=""
	Q
FILE	F J=0:0 S J=$O(^TMP($J,I,J)) Q:J'>0  F K=0:0 S K=$O(^TMP($J,I,J,K)) Q:K'>0  F L=0:0 S L=$O(^TMP($J,I,J,K,L)) Q:L'>0  S CNT=CNT+1 S:CNT=VAR $P(^FBAA(163.99,FBI,"FY",FBFY,0),"^",NOD)=J,$P(^(0),"^",6,8)=FBRUN
	K FBI Q
	;
80	Q:'$G(FBI)
	S VAR=VARR*.75,VAR=$S($P(VAR,".",2)>5:$P(VAR,".",1)+1,1:$P(VAR,".",1)) S (CNT,NUM,NUM1,PAY)=0,NOD=5 D FILE Q
	;
FYCK	S FBFY=$E(Y,1,3),BEGDATE=(FBFY-1_"1000"),ENDDATE=(FBFY_"0930") G QUE
	;
DATECK	S FBFY=$S($E(BEGDATE,4,5)>9:($E(BEGDATE,1,3)+1),1:$E(BEGDATE,1,3)) I Y>(FBFY_"1001") W !,*7," Dates must be within a fiscal year. " S FBFL=1 Q
	Q

FBAAPCC
FBAAPCC	;AISC/GRR-PRINT CURRENTLY ISSUED CARDS ;15APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S VAR="",PGM="START^FBAAPCC" D ZIS^FBAAUTL G:FBPOP Q
START	U IO S UL="",FBAAOUT=0 W:$E(IOST,1,2)["C-" @IOF F A=1:1:80 S UL=UL_"="
	D HED S J=0 F JJ=0:0 S J=$O(^FBAAA("AE",J)) Q:J'>0!(FBAAOUT)  F DFN=0:0 S DFN=$O(^FBAAA("AE",J,DFN)) Q:DFN'>0!(FBAAOUT)  I $D(^FBAAA(DFN,4)) S Y(0)=^(4) D GOT
Q	W ! K A,J,DFN,UL,I,JJ,X,Y,FBAAOUT,FBDT,FBNM,FBSSN D CLOSE^FBAAUTL
	Q
GOT	S FBDT=$P(Y(0),"^",2),FBNM=$P($G(^DPT(+DFN,0)),"^"),FBSSN=$$SSN^FBAAUTL(DFN)
	I $Y+4>IOSL D HANG Q:FBAAOUT  W @IOF D HED
	W !!,J,?10,FBNM,?42,FBSSN,?61,$$DATX^FBAAUTL(FBDT)
	Q
HED	W !,"Card No.",?10,"Patient Name",?42,"Patient SSN",?61,"Issue Date",!,UL Q
HANG	I $E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1
	Q

FBAAPDM
FBAAPDM	;AISC/GRR-CREATE PATIENT MRA DELETE TRANSACTION ;27AUG87
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	W !! S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),RD:Y<0 S (DA,DFN)=+Y
	I '$D(^DPT(DFN,0)) W !!,"Patient has been deleted from the Patient file, cannot create transaction!" G RD
	S FBTTYPE="D",D1="" D MORE^FBAAAUT W !!,"Delete MRA has been created!" G RD
END	K DA,DFN,DIC,Y,D1 Q

FBAAPET
FBAAPET	;AISC/DMK-EDIT PAYMENT ;22FEB88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBOT=1
GETPT	I $G(BAT) D
	.I '$D(^FBAAC("AC",+BAT)) F I=9,10,11 S $P(^FBAA(161.7,+BAT,0),U,I)=""
	.I $D(^FBAAC("AC",+BAT)) D  S $P(^FBAA(161.7,+BAT,0),U,11)=I,$P(^(0),U,9)=$G(FBTOT) K I,FBTOT
	..N J,K,L,M S (I,J,K,L,M,FBTOT)=0
	..F  S J=$O(^FBAAC("AC",+BAT,J)) Q:'J  F  S K=$O(^FBAAC("AC",+BAT,J,K)) Q:'K  F  S L=$O(^FBAAC("AC",+BAT,J,K,L)) Q:'L  F  S M=$O(^FBAAC("AC",+BAT,J,K,L,M)) Q:'M  I $D(^FBAAC(J,1,K,1,L,1,M,0)) S I=I+1,FBTOT=FBTOT+$P(^(0),U,3)
	W !! S DIC="^FBAAC(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),GETPT:Y<0 S (DFN,FBDA(3))=+Y
	S:'$D(^FBAAC(DFN,1,0)) ^FBAAC(DFN,1,0)="^162.01P^0^0"
	S DIC=DIC_DFN_",1,"
GETVD	W !! S DIC(0)="AEQM" D ^DIC G GETPT:X="^"!(X=""),GETVD:Y<0 S (FBV,FBVD,FBDA(2))=+Y
	S:'$D(^FBAAC(DFN,1,FBDA(2),1,0)) ^FBAAC(DFN,1,FBDA(2),1,0)="^162.02DA^0^0"
	S DIC=DIC_FBVD_",1,"
GETDT	S DIC(0)="AEQM",DIC("A")="Date of Service: " D ^DIC K DIC("A") G GETPT:X="^"!(X=""),GETDT:Y<0 S (FBSD,FBSDI,FBDA(1))=+Y,FBAADT=$P(Y,U,2)
	S:'$D(^FBAAC(DFN,1,FBDA(2),1,FBDA(1),1,0)) ^FBAAC(DFN,1,FBDA(2),1,FBDA(1),1,0)="^162.03A^0^0"
	S FBZ=DIC_FBSD_",1,"
SERV	S DA(3)=FBDA(3),DA(2)=FBDA(2),DA(1)=FBDA(1)
	S DIC("W")="W $S($P($G(^(2)),U,7):""    CPT Modifier: ""_$P($G(^DIC(81.3,+$P(^(2),U,7),0)),U),1:"""")"
	S DIC=FBZ,DIC(0)="AEQM" D ^DIC G GETPT:X="^"!(X=""),SERV:Y<0 S (FBSV,FBAACPI,FBDA)=+Y,BAT=$P(^FBAAC(FBDA(3),1,FBDA(2),1,FBDA(1),1,FBDA,0),"^",8),FBDUZ=$P(^(0),"^",7),FBAACP=$P(Y,"^",2),K=$P(^(0),"^",3)
	I FBDUZ'=DUZ&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"Sorry,only the clerk who entered the payment ",!," or a supervisor can edit this payment." G GETPT
	G:BAT']"" EDIT
	I $G(^FBAA(161.7,BAT,"ST"))]"",$P(^FBAA(161.7,BAT,"ST"),"^")="S"!($P(^FBAA(161.7,BAT,"ST"),"^")="T")&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"Sorry, only the Supervisor can edit a payment once the batch has been released." G GETPT
	I $G(^FBAA(161.7,BAT,"ST"))]"",$P(^FBAA(161.7,BAT,"ST"),"^")="V" W !!,*7,"Sorry,you cannot edit a payment once the batch has been Finalized." G GETPT
EDIT	S DA=FBSV,DR=".01;S FBAACP=X;39;S FBMOD=X;1;S J=X;Q;D FEEDT^FBAACO3;2//^S X=FBAMTPD;D CHKIT^FBAACO3;S K=X;3////^S X=$S(J-K:J-K,1:"""");I X S Y=""@11"";4////@;S Y=26;@11;3R;4R;S:X'=4 Y=26;22"
	S DR(1,162.03,1)="26;S PRC(""SITE"")=X;8;13;Q;33;S FBAAMM=1 D PPT^FBAACO1;34////@;34////^S X=FBAAMM1"
	S DR(1,162.03,2)="15;17;16;S:X=1 Y=""@1"";28R;30;31;32R;S Y="""";@1;28;30;31"
	S DIE=DIC D ^DIE K FBSV W !! G SERV
END	K DR,DIC,DIE,X,DFN,FBOT,FBVD,FBSD,BAT,FBAADT,FBSV,DA,FBDA,FBZ,FBDUZ,FBAACP,FBFY,FY,FBAMTPD,J,K,Y,ZZ,PRC,FBHOLDX,FBV,FBSDI,FBAACPI
	Q

FBAAPH
FBAAPH	;AISC/DMK,GRR-LIST PAYMENT HISTORY ;14DEC86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW
RD	K FBAANQ,FB,FBTRX W !! S FBAAOUT=0,DIC="^FBAAC(",DIC(0)="AEQMNZ",DIC("A")="Select Fee Patient: " D ^DIC K DIC("A") G Q:X="^"!(X=""),RD:Y<0 S DFN=+Y,FBNAME=Y(0,0)
	I '$D(^FBAAC(DFN,"AB")) W !!,"No payments for this patient!",! G RD
	S FBSSN=$$SSN^FBAAUTL(DFN)
	D HOME^%ZIS ;S VAR="FBNAME^DFN",VAL=FBNAME_"^"_DFN,PGM="LIST^FBAAPH" D ZIS^FBAAUTL G:FBPOP Q S:IO=IO(0) FBAANQ=1
LIST	S:'$D(FBNAME) FBNAME=$P($G(^DPT(+DFN,0)),"^")
	S FBPHOUT=1
	U IO S FBAAOUT=0 D ^FBAADEM I FBAAOUT'=1,$E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR G Q:$D(DIRUT)
	K Q S $P(Q,"=",80)="="
	S FBAAOUT=0 W:$E(IOST,1,2)["C-" @IOF D HED S J=DFN
	F I=0:0 S I=$O(^FBAAC(J,"AB",I)) Q:I=""!(FBAAOUT)  F K=0:0 S K=$O(^FBAAC(J,"AB",I,K)) Q:K=""!(FBAAOUT)  F L=0:0 S L=$O(^FBAAC(J,"AB",I,K,L)) Q:L=""!(FBAAOUT)  D SETTR F M=0:0 S M=$O(^FBAAC(J,1,K,1,L,1,M)) Q:M=""  D SET Q:FBAAOUT
	G RD:FBAAOUT!('$D(FB)) S FBTRCK=1,D=0 F  S D=$O(FB(D)) Q:'D  S FBTRX=0 F  S FBTRX=$O(FB(D,FBTRX)) Q:'FBTRX  D WRTCK Q:FBAAOUT  W:$G(FBTRCK) !!,?5,"TRAVEL PAYMENTS: " D  K FBTRCK
	.W ?22,$$DATX^FBAAUTL(D),?35,$P(FB(D,FBTRX),"^") I $P(FB(D,FBTRX),"^",3)]"" W ?44,"Check #: ",$P(FB(D,FBTRX),"^",2),?63,"Paid: ",$$DATX^FBAAUTL($P(FB(D,FBTRX),"^",3))
	G RD
	W !! D CLOSE^FBAAUTL K FBNAME,DFN,J,FBAANQ,FBAAOUT,DIC,VAL,VAR,PGM Q
SET	S V=$P($G(^FBAAV(K,0)),"^"),FBVID=$S(V]"":$P(^(0),"^",2),1:"")
	S Y=^FBAAC(J,1,K,1,L,1,M,0),T=$P(Y,"^",5),D2=$P(Y,"^",6),FBDOS=D2,D2=$S(D2="":"",1:$E(D2,4,5)_"/"_$E(D2,6,7)_"/"_$E(D2,2,3)),FBCP=$P(Y,"^",18),FBCP=$S(FBCP=1:"(C&P)",1:"")
	S FBAACPTC=$P($G(^ICPT(+Y,0)),"^"),FBOB=$P(Y,"^",10)
	I T]"" S T=$P($G(^FBAA(161.27,+T,0)),"^")
	S A1=$P(Y,"^",2)+.0001,A2=$P(Y,"^",3)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2)
	S FBTYPE=$P(Y,"^",20),FBVP=$P(Y,"^",21),FBIN=$P(Y,"^",16),FBBN=$P(Y,"^",8),FBBN=$S(FBBN']"":"",$D(^FBAA(161.7,FBBN,0)):$P(^(0),"^"),1:""),FBBN=$S(FBBN="":"",1:$E("00000",$L(FBBN)+1,5)_FBBN)
	D FBCKO^FBAACCB2(J,K,L,M),WRT
	S FBMOD=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),"^",7)
	Q
WRT	D WRTCK Q:FBAAOUT
	W !!,"Vendor: ",$E(V,1,33),"     Vendor ID: ",FBVID,?66," Obl.#: "_FBOB,!,$S(FBTYPE="R":"*",1:" "),$S(FBVP="VP":"#",1:""),$S($G(FBCAN)]"":"+",1:""),$$DATX^FBAAUTL(D)
	W ?12,FBAACPTC,FBCP_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:""),?28,$J(A1,6),?38,$J(A2,6),?48,T,?57,FBBN,?63,$J(FBIN,7),?71,D2
	D PMNT^FBAACCB2
	Q
WRTCK	I ($Y+5)>IOSL,$E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR  S:'Y FBAAOUT=1 Q:FBAAOUT
	I ($Y+5)>IOSL W @IOF D HED
	Q
HED	I $E(IOST,1,2)'="C-" W !?24,"MEDICAL PAYMENT HISTORY",!?23,$E(Q,1,25)
	W !,"Patient: ",FBNAME,?40,"SSN: ",$$SSN^FBAAUTL(DFN),!,?10,"('*' Reimb. to Patient  '+' Cancel. Activity  '#' Voided Payment)"
	W !,?2,"Svc Date",?11,"CPT-MOD",?28,"Amount",?38," Amount",?48,"Susp",?57,"Batch",?63,"Invoice",?71,"Voucher",!,?28,"Claimed",?38,"Paid",?48,"Code",?58,"Num",?64,"Num",?72,"Date",!,Q,!
	Q
Q	K D,D2,J,K,L,M,DIC,T,Y,Q,I,A1,A2,A3,C,DAT,DIYS,F,FBAACPTC,FBAANQ,FBAAOUT,FBBN,FBCOUNTY,FBCP,FBOB,FBDOS,FBDX,FBIN,FBTA,FBTYPE,FBVID,FBNAME,PGM,PI,V,VAL,VAR,Z,ZZ,A,A1,A2,BE,CPTDESC,FBVP,PSA,FBPHOUT,FBAUT
	K B1AUT,B2,DFN,FBAADOD,PTYPE,FBI,FBRR,FBPROG,FBXX,FBSSN,X1,FBAACPT,FBAADT,FBAAPD,FBIN,I,K,L,Q,Y,Z,ZS,FB,FBTRX,FBMOD
	D CLOSE^FBAAUTL Q
SETTR	S D=$S($D(^FBAAC(J,1,K,1,L,0)):$P(^(0),"^",1),1:""),A3=""
	I D]"",$D(^FBAAC(J,3,"AB",D)) S (FBTA,FBCTR)=0 F  S FBTA=$O(^FBAAC(J,3,"AB",D,FBTA)) Q:'FBTA  S B3=$G(^FBAAC(J,3,FBTA,0)),A3=$P(B3,"^",3) I A3>0 S FBCTR=FBCTR+1,FB(D,FBCTR)=$J(A3,6,2)_"^"_$P(B3,"^",7)_"^"_$P(B3,"^",6)
	K A3,B3,FBTA,FBCTR Q

FBAAPHV
FBAAPHV	;AISC/DMK-PHARMACY PAYMENT VOID ;12JUL88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;Variable 'FBVOID' is set if cancelling a voided payment.
	D DT^DICRW
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !!,*7,"You must be a Fee supervisor to use this option.",! Q
RD	S DIC="^FBAA(162.1,",DIC(0)="AEQM",DIC("A")="Select Invoice number: ",DIC("S")="I $P(^(0),U,5)=4" D ^DIC G Q:X["^"!(X=""),RD:Y<0 S FBAAIN=+Y K DIC("A"),DIC("S")
RX	W ! S DIC="^FBAA(162.1,FBAAIN,""RX"",",DIC(0)="AEQM",DIC("A")="Select Prescription # : " D ^DIC G Q:X["^"!(X=""),RD:Y<0
	S (DA,RX)=+Y,RXN=$P(Y,"^",2) K DIC
	I $D(FBVOID),'$D(^FBAA(162.1,FBAAIN,"RX",RX,2)) W !,*7,"Payment not voided!",! K DA G RD
	I '$D(FBVOID),$D(^FBAA(162.1,FBAAIN,"RX",RX,2)),$P(^(2),"^",3)="V" W !,*7,"Payment already voided!",! K DA G RD
	W !! S DIC="^FBAA(162.1,FBAAIN,""RX"",",DIC(0)="AEQM",DR="" D EN^DIQ
RD1	S DIR(0)="Y",DIR("A")="Is this the prescription you want to "_$S($D(FBVOID):"Cancel the void on ",1:"Void"),DIR("B")="NO",DIR("?")="Answer 'Yes' if you want to "_$S($D(FBVOID):"Cancel the void on ",1:"Void ")_"this prescription."
	D ^DIR K DIR G RD:$D(DIRUT),RX:'Y
	S V=$S($D(FBVOID):"",1:"VOID"),DR=$S($D(FBVOID):"23///@;23.5///@;24///@",1:"23////^S X=""V"";23.5R;24////^S X=DUZ"),DIE="^FBAA(162.1,FBAAIN,""RX""," D ^DIE
	S FBON=$P(^FBAA(162.1,FBAAIN,"RX",DA,0),"^",18),A2=$P(^(0),"^",16),DFN=$P(^(0),"^",5) D ^FBAAVP0 W !,?5,"...  Done.",!
Q	K DA,DIC,DIE,DIRUT,RX,RXN,X,Y,A2,DFN,DR,FBAACB,FBAAIN,FBON,FBVOID,ON,P3,P4,RX,RXN,V,VAL Q

FBAAPI
FBAAPI	;AISC/GRR-PATIENT INQUIRY ;03JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	K FBAANQ W !! S DIC="^DPT(",DIC(0)="AEQM" D ^DIC G Q:X="^"!(X=""),RD:Y<0 S DFN=+Y
	S VAR="DFN",VAL=DFN,PGM="START^FBAAPI" D ZIS^FBAAUTL G:FBPOP Q S:IO=IO(0) FBAANQ=1
START	U IO
	W ! D ^FBAADEM
	I $E(IOST,1,2)="C-" D
	. Q:'$O(^FBAA(161.5,"D",DFN,0))
	.W !!,"Patient also has Inpatient Report(s) of Contact with the following date(s):",!
	. S I=0 F  S I=$O(^FBAA(161.5,"D",DFN,I)) Q:'I  S Y=$P($G(^FBAA(162.2,I,0)),"^") D DD^%DT W !?10,Y
	G:$D(FBAANQ) RD
Q	K DIC,X,Y,FBAAOUT,FBAUT,FBPROG,PTYPE,X1,FBAANQ,DFN,DAT,F,FBCOUNTY,FBDX,FBI,FBRR,FBXX,I,PGM,PI,T,VAL,VAR,Z,ZZ,M,Q
	D CLOSE^FBAAUTL Q

FBAAPIE
FBAAPIE	;AISC/GRR-ENTER FEE PHARMACY INVOICE ;29JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D SITEP^FBAAUTL W:FBPOP !!,*7,"Fee site parameters must be initialized!!" Q:FBPOP  S FBMDF=$P(FBSITE(0),"^",10),FBAAPTC=$S($D(FBAAPTC):FBAAPTC,1:"V")
RD1	W ! S DIR("A")="Are you sure you want to enter a new invoice",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR G Q^FBAAPIE1:$D(DIRUT),RDM^FBAAPIE1:'Y
ENTER	S (LCNT,TAC,FBINTOT)=0,STAT(0)="",FBAAOUT=1 K FBTOUT
	D GETNXI^FBAAUTL S X=FBAAIN
	S DLAYGO=162.1,DIC="^FBAA(162.1,",DIC(0)="LQ" D ^DIC K DLAYGO G:Y<0 PROB^FBAAPIE1 W !!,"Invoice # assigned is: ",X S IN=X,DA(1)=IN
RDV	I '$D(FB583) W !! S DLAYGO=161.2,(DIE,DIC)="^FBAAV(",DIC(0)="AEQLM" D ^DIC K DLAYGO G CHK:Y<0 S DA=+Y D NEW^FBAAVD:$P(Y,"^",3)=1
	I $D(FB583) S DA=FBVEN
	I $D(^FBAAV(DA,0)),$P($G(^("ADEL")),"^")="Y" W !!,"Vendor is flagged for Austin deletion!" G RDV:'$D(FB583),Q^FBAAPIE1
	D EN1^FBAAVD:$P(FBSITE(0),"^",12)="Y" S VIN=DA
RDV1	I $D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ)) W ! S DIR("A")="Want to edit Vendor data",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G CHK:$D(DIRUT) D:Y EDITV^FBAAVD S VIN=DA
	S FBAR(DA)="" D ^FBAACO4
	W !! S %DT="AEQXP",%DT(0)=-DT,%DT("A")="Date Correct Invoice Received: " D ^%DT K %DT(0),%DT("A") G CHK:Y<0 S INVDATE=Y
	W !! S %DT="AEQXP",%DT(0)=-INVDATE,%DT("A")="Vendor Invoice Date:  " D ^%DT K %DT(0),%DT("A") G CHK:Y<0 S FBVINVDT=Y
	S (DIE,DIC)="^FBAA(162.1,",DA=IN,DR="1////^S X=INVDATE;1.5////^S X=DT;2////^S X=DUZ;3////^S X=VIN;5////^S X=1;12////^S X=FBVINVDT" D ^DIE
	I '$D(^FBAA(162.1,IN,"RX",0)) S ^FBAA(162.1,IN,"RX",0)="^162.11A^^"
RDP	S FBPHARM=1 W:FBINTOT>0 !,?15,"Pharmacy Invoice #: "_IN_"  Totals: $ "_$J(FBINTOT,1,2) D ^FBAASAP K FBPHARM I 'DFN K DFN G CHK
	I FBTT=1 S FBMST="Y",FBTTYPE="A",FBFDC="",FBD1=FTP D ENT^FBAAAUT
	D HOME^%ZIS,FBPH^FBAAUTL2 I $D(DIRUT),$D(FB583) G CHK
RDD	W !! S %DT(0)=-DT,%DT="AEXP",%DT("A")="DATE PRESCRIPTION FILLED: " D ^%DT K %DT G:X["^"!(X="") RDP G RDD:Y<0 S DATEF=Y
	I DATEF<FBAABDT!(DATEF>FBAAEDT) W !!,*7,"Date Prescription Filled is ",$S(DATEF<FBAABDT:" prior to ",1:"later than "),"authorization period!!" G RDD
	I '$D(^FBAA(162.1,IN,"RX",0)) S ^FBAA(162.1,IN,"RX",0)="^162.11A^^"
RDRX	S DIR(0)="162.11,.01",DIR("A")="Select PRESCRIPTION NUMBER" D ^DIR K DIR G CHK:Y="^"!(Y="") S PSRX=Y,AC=0
	I $D(^FBAA(162.1,IN,"RX","B",PSRX)) G RX2^FBAAPIE1
	D CHK2^FBAAPIE1 I FBJ]"" K FBJ G CHKK^FBAAPIE1
RXADD	K DA S DLAYGO=162.1,DA(1)=IN,DIC="^FBAA(162.1,"_IN_",""RX"",",DIC(0)="EQL",X=""""_PSRX_"""" D ^DIC K DLAYGO G:Y<0 RDRX S FBDA=+Y
	S DIE="^FBAA(162.1,",DA=IN,DR="[FB ADD RX]" D ^DIE I $D(DTOUT)!('$G(FBUP)) G DELRX
	S LCNT=LCNT+1,TAC=TAC+AC K FBUP
RDDER	W !!,*7,"Prescription referred to Pharmacy Service for determination.",! S X="Y"
	S STAT(1)="" G RDP:'$D(FB583),Q^FBAAPIE1
	S $P(^FBAA(162.1,IN,"RX",DA,2),"^")="P",^FBAA(162.1,"AH","P",IN,DA)="",$P(^FBAA(162.1,IN,0),"^",10)="P"
	S DA(1)=IN,DIE=DIC
HERE	S:$D(FBAP) FBINTOT=FBINTOT+FBAP S:$D(DTOUT) FBTOUT="" G OVR:$D(DTOUT),RDD
CHK	I LCNT'>0 W !!,"Since you didn't enter any line items",!,"Invoice # ",IN," has been Deleted!!",*7 D KILL G Q^FBAAPIE1:$D(FBTOUT),MORE:'$D(FB583),Q^FBAAPIE1
OVR	K DTOUT,DR,DQ,DG
	K STAT(2)
	S (DIE,DIC)="^FBAA(162.1,",DA=IN,STAT=$O(STAT(0)),DR="5////^S X=STAT;6///^S X=TAC;7///^S X=FBINTOT;8///^S X=LCNT" D ^DIE G:$D(FBTOUT) Q^FBAAPIE1 W !!,"Invoice No.: ",IN," Completed!" W:FBINTOT>0 ?45,"Invoice Total: $ ",$J(FBINTOT,1,2)
MORE	K STAT,FBHX W ! S DIR("A")="Want to enter another Invoice",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G Q^FBAAPIE1:$D(DIRUT)!('Y),ENTER
	Q
KILL	S DIK="^FBAA(162.1,",DA=IN D ^DIK K DIK Q
DELRX	S DIK="^FBAA(162.1,"_DA(1)_",""RX"",",DA=FBDA D ^DIK K DTOUT,DQ,DR,DG S FBTOUT="" W !,"Incomplete prescription entry.  Deleted.",! G CHK

FBAAPIE1
FBAAPIE1	;AISC/GRR-ENTER FEE PHARMACY INVOICE ;29JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
LISTLI	I '$D(^FBAA(162.1,DA,"RX","AB")) W !,"No prescriptions currently in this invoice.",! Q
	D HOME^%ZIS S FSW=1
	S FBAAOUT=0 F J=0:0 S J=$O(^FBAA(162.1,DA,"RX",J)) Q:J'>0  I $D(^FBAA(162.1,DA,"RX",J,0)) S Y(0)=^(0) D GETIT Q:FBAAOUT
	Q
Q	K DIE,DIC,STAT,IN,VIN,DA,LCNT,AC,TAC,DATEF,DR,X,%DT,INVDATE,CNT,DAT,FBAABDT,FBAAEDT,FBAAIN,FBAAOUT,FBAAPN,FBAAPTC,FBBATCH,FBDRUG,FBDX,FBI,FBINTOT,FBINVN,FBMDF,FBPD,FBPOV,FBPT,FBSITE,FBRBC,FBREIM,PSRX,Y,Z,FBFDC,FBMST,FBTTYPE,FBPOP
	K FBRR,FBT,FBTOV,FBTT,FBTV,FBTYPE,FEEO,FTP,FY,I,J,K,N,NAME,S,SSN,VAL,VAR,VID,VNAM,Z1,Z2,ZZ,D,F,FBAC,FBAP,FBFD,FBPROG,FBRX,FBXX,FSW,PI,POP,PTYPE,T,TA,DFN,D0,FBDEL,FBAUT,FBPSA,A1,A2,CHN,DOB,FBPV,FBQTY,FBSTR,FBSUSP,FID,L,PSA,Q,X1
	K FB7078,FBASSOC,FBD1,FBLOC,FBVEN,DIRUT,FBAR,FBDA,FBJ,FBID,FBPARCD,FBTOUT,FBVINVDT
	Q
GETIT	S FBRX=$P(Y(0),"^"),FBFD=$P(Y(0),"^",3),FBAC=$P(Y(0),"^",4),DFN=+$P(Y(0),"^",5)
	S SSN=$$SSN^FBAAUTL(DFN),VID=+$P($G(^FBAA(162.1,DA,0)),"^",4),VNAM=$P($G(^FBAAV(VID,0)),"^")
	I FSW S FSW=0 D HED
	I $Y+5>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT   D HED
	W !,SSN,?19,$E(FBFD,4,5),"-",$E(FBFD,6,7),"-",$E(FBFD,2,3),?31,FBRX,?44,FBAC
	Q
HED	W @IOF,"Invoice #: ",DA,?25,"Vendor Name: ",VNAM,!!,"Patient  I.D.",?18,"Fill Date",?30," RX  #",?40,"Amt Claimed",!
	Q
CHKK	W !!,*7,"There already is a prescription number entered, from this vendor, ",!,"for that fill date. The invoice number is ",$O(^FBAA(162.1,"AL",VIN,PSRX,DATEF,""))_" ."
	G RDD^FBAAPIE
CALC	;Calculate Invoice Total
	S FBINTOT=0 I $D(^FBAA(162.1,IN,"RX")) F I=0:0 S I=$O(^FBAA(162.1,IN,"RX",I)) Q:I'>0  I $D(^(I,0)) S FBINTOT=FBINTOT+$P(^FBAA(162.1,IN,"RX",I,0),"^",16)
	K I Q
RDM	W ! S DIR("A")="Do you want to continue a previously entered Invoice",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G Q:$D(DIRUT)!('Y)
RD2	W !! S DIC="^FBAA(162.1,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,5)'=4" D ^DIC G Q:X="^"!(X=""),RD2:Y<0 S (DA,DA(1),IN)=+Y,VIN=$P(^(0),"^",4)
	D CALC W:FBINTOT>0 !,?30,"Current Total: $ "_$J(FBINTOT,1,2)
RD3	W ! S DIR("A")="Want to list previously entered line items",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G Q:$D(DIRUT) D:Y LISTLI
	S LCNT=+$P(^FBAA(162.1,IN,0),"^",9),TAC=+$P(^(0),"^",6),STAT=+$P(^(0),"^",5),STAT(STAT)="" G RDP^FBAAPIE
	Q
RX2	W !!,*7,"This prescription number already exsists in this invoice.",!
	W ! S DIR("A")="Do you wish to enter this prescription again",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G CHK^FBAAPIE:$D(DIRUT),RDRX^FBAAPIE:'Y,RXADD^FBAAPIE
	Q
PROB	W !!,"You do not have access to the Fee Invoice File, contact your IRM Service.",! G Q
CHK2	;Checks for duplicate payments on all linked vendors.
	S FBJ=0 F  S FBJ=$O(FBAR(FBJ)) Q:$S('FBJ:1,$D(^FBAA(162.1,"AL",FBJ,PSRX,DATEF)):1,1:0)
	Q

FBAAPII
FBAAPII	;AISC/GRR-PHARMACY INVOICE DISPLAY ;03JUN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	W !! S DIC="^FBAA(162.1,",DIC(0)="AEQM" D ^DIC G Q:X=""!(X="^"),RD:Y<0 S DA=+Y
	S VAR="DA",VAL=DA,PGM="START^FBAAPII" D ZIS^FBAAUTL G:FBPOP Q S:IO=IO(0) FBAANQ=1
START	U IO W:$E(IOST,1,2)["C-" @IOF S DIC="^FBAA(162.1,",DIC(0)="AEQM",DR="0;RX" D EN^DIQ
Q	D CLOSE^FBAAUTL K DIC,DIE,DR,DA,X,Y,A,D0,DQ,DL,DRX,DX,PGM,S,VAL,VAR
	I $D(FBAANQ) K FBAANQ G RD
	Q

FBAAPIN
FBAAPIN	;AISC/GRR-INVOICE DISPLAY ;16MAR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW
RD1	W ! S (FBHDONE,FBAAOUT,FBINTOT)=0,FBSW=0 K FBHED S DIR(0)="NO",DIR("A")="Select Invoice Number",DIR("?")="^D HELP^FBAAPIN1" D ^DIR K DIR G Q:$D(DIRUT)!'Y
	I '$D(^FBAAC("C",X)) W !,*7,"Invalid selection.",! G RD1
	S HX=X,FBAAIN=X D LIST S X=HX G RD1
LIST	S Q="",$P(Q,"=",80)="="
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
	F J=0:0 S J=$O(^FBAAC("C",FBAAIN,J)) Q:J'>0!(FBAAOUT)  D MMORE
	Q
SET	S FBFILE="^FBAAC("_J_",1,"_K_",1,"_L_",1,"_M_",1,",D=$P($G(^FBAAC(J,1,K,1,L,0)),"^",1),FBYY=$G(^FBAAC(J,1,K,1,L,1,M,0)),FBYY("REJ")=$S($D(^FBAAC(J,1,K,1,L,1,M,"FBREJ")):^("FBREJ"),1:""),FBY=$G(^FBAAC(J,1,K,1,L,1,M,2)) D SET2
	Q
SET2	S N=$S($D(^DPT(J,0)):$P(^(0),"^",1),1:""),S=$S(N]"":$P(^DPT(J,0),"^",9),1:""),V=$S($D(^FBAAV(K,0)):$P(^FBAAV(K,0),"^",1),1:"")
	S T=$P(FBYY,"^",5),D2=$P(FBYY,"^",6),ZS=$P(FBYY,"^",20),VP=$P(FBYY,"^",21)
	S T=$P($G(^FBAA(161.27,+T,0)),U)
	S FBAACPT=$P(FBYY,"^",1) I FBAACPT]"" S FBAACPT=$S($D(^ICPT(FBAACPT,0)):$P(^(0),"^",1),1:""),FBMOD=$P(FBY,U,7)
	S A1=$P(FBYY,"^",2)+.0001,A2=$P(FBYY,"^",3)+.0001,A3=$P(FBYY,"^",12)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2),A3=$P(A3,".",1)_"."_$E($P(A3,".",2),1,2),FBINTOT=FBINTOT+A2+.0001
	S FBINTOT=$P(FBINTOT,".")_"."_$E($P(FBINTOT,".",2),1,2)
	S FBBN=$S($P(FBYY,"^",8)]"":$S($D(^FBAA(161.7,$P(FBYY,"^",8),0)):$P(^(0),"^",1),1:""),$P(FBYY("REJ"),"^",3)]"":$S($D(^FBAA(161.7,$P(FBYY("REJ"),"^",3),0)):$P(^(0),"^",1),1:""),1:"")
	D FBCKO^FBAACCB2(J,K,L,M)
	I '$D(FBHED) D HED
	D WRT S FBHED=1
	Q
WRT	I ($Y+5)>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  D HED
	W !!,N,!,$S(ZS="R":"*",1:""),$S(VP="VP":"#",1:""),$S($G(FBCAN)]"":"+",1:""),?3,$$DATX^FBAAUTL(D),?12,FBAACPT_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:"")
	W ?23,"$",$J(A1,8),?35,"$",$J(A2,8),?47,T,?57,FBBN,?70,$S(FBYY("REJ")]"":"Rejected",1:$$DATX^FBAAUTL(D2))
	D:T=4 ^FBAAPIN1
	D PMNT^FBAACCB2
	Q
HED	W @IOF,!,"Invoice Number: ",FBAAIN,?30,"Vendor Name: ",V,!,?2,"Date Received: ",FBINDAT ;,!,"Patient Name",?10,"('*' Reimb. to Patient  '+' Cancel. Activity  '#' Voided Payment)"
	I +$G(FBY) W ?33,"Invoice Date: ",$$DATX^FBAAUTL(+FBY)
	W !?10,"('*' Reimb. to Patient  '+' Cancel. Activity  '#' Voided Payment)"
	W !,"SVC DATE"," CPT-MOD ","   AMT CLAIMED",?35,"AMT PAID",?47,"CODE",?57,"BATCH NO.",?67,"VOUCHER DATE",!,?5,"Other Suspension Description",!,$$REPEAT^XLFSTR("=",79),!
	Q
Q	K D,N,V,D2,J,K,L,M,DIC,T,FBYY,Q,I,A1,A2,A3,C,DIYS,FBAACPT,FBAAIN,FBAAOUT,FBBN,FBINTOT,FBINDAT,FBSW,FBHDONE,HX,S,VP,Z,ZS,FBHED,FBFILE,DIRUT,FBY,FBMOD Q
ERR	W !,*7,"Please enter a whole number! Alpha characters and puctuation are invalid" G RD1
SETHD	S V=$S($D(^FBAAV(K,0)):$P(^(0),"^",1),1:"") D INDAT:FBSW S FBHDONE=1 Q
MMORE	S FBSW=1 F K=0:0 S K=$O(^FBAAC("C",FBAAIN,J,K)) Q:K=""!(FBAAOUT)  D SETHD F L=0:0 S L=$O(^FBAAC("C",FBAAIN,J,K,L)) Q:L=""!(FBAAOUT)  F M=0:0 S M=$O(^FBAAC("C",FBAAIN,J,K,L,M)) Q:M'>0  D SET Q:FBAAOUT
	Q
INDAT	S L=$O(^FBAAC("C",FBAAIN,J,K,"")),M=$O(^FBAAC("C",FBAAIN,J,K,L,"")),FBINDAT=$P($G(^FBAAC(J,1,K,1,L,1,M,0)),"^",15),FBINDAT=$S(FBINDAT="":"Unknown",1:$E(FBINDAT,4,5)_"/"_$E(FBINDAT,6,7)_"/"_$E(FBINDAT,2,3)),FBSW=0 K L,M Q
	Q

FBAAPIN1
FBAAPIN1	;AISC/GRR-INVOICE DISPLAY CONTINUED ;04APR90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K ^UTILITY($J,"W") S DIWL=3,DIWF="WC79"
	F FBRR=0:0 S FBRR=$O(@(FBFILE_FBRR_")")) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP I ($Y+5)>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  D HED^FBAAPIN
	Q:FBAAOUT
	D ^DIWW:$D(FBXX) K FBXX
	Q
HELP	I X=" " W !,*7,"Answer must be numeric" Q
	W @IOF S DIC="^FBAAC(",DIC(0)="",D="C",DZ="??" D DQ^DICQ
	Q

FBAAPIP
FBAAPIP	;AISC/GRR-ESTABLISH BATCH FOR INVOICE AND CLOSE-OUT ;28MAR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW S FBSW=1
RD1	W !! S DIC="^FBAA(162.1,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,5)=3" D ^DIC K DIC G Q:X="^"!(X=""),RD1:Y<0 S (DA,IN,FBIN)=+Y,FBINTOT=0 D CALC^FBAAPIE1,WRT,EN1 G RD1
EN1	;ENTRY FROM THE MAS CLOSE-OUT OPTION (FBAACIE)
	S FY=$E(DT,1,3)+1700+$S($E(DT,4,5)>9:1,1:0)
	S FBAAMPI=$S($D(^FBAA(161.4,1,"FBNUM")):$P(^("FBNUM"),"^",3),1:100),FBAAMPI=$S(FBAAMPI]"":FBAAMPI,1:100),FBSW=1
	D BT Q:'$D(FBBN)  D WAIT^DICD S (TIC,TAC,TAP,FBSW,FBAATPV)=0 D GO Q
BT	W !! S DIC="^FBAA(161.7,",DIC(0)="AEQM",DIC("A")="Select Batch for this Invoice: ",DIC("S")="I $P(^(0),U,3)=""B5""&($G(^(""ST""))=""O"")"
	S DIC("W")="W !,""  Obligation #: "",$P(^(0),U,2)" D ^DIC K DIC G Q:X="^"!(X=""),BT:Y<0 S (DA,FBBN)=+Y
	I $P(Y,"^",3)'=1 G NOTYOU:$P(^FBAA(161.7,DA,0),"^",5)'=DUZ,NOTPH:$P(^(0),"^",3)'="B5",NOTOP:$P(^("ST"),"^",1)'="O"
	S Z(0)=^FBAA(161.7,DA,0),FBAABO=$P(Z(0),"^",2),FBBTA=$P(Z(0),"^",9),FBBIC=$P(Z(0),"^",10)+1,FBBLC=$P(Z(0),"^",11)
	G:FBBLC>(FBAAMPI-1) WARN
	Q
GO	S FBAAVIN=$P(^FBAA(162.1,FBIN,0),"^",4) F FBJ=0:0 S FBJ=$O(^FBAA(162.1,FBIN,"RX",FBJ)) Q:FBJ'>0  S Y(0)=^FBAA(162.1,FBIN,"RX",FBJ,0) D:$P(Y(0),"^",16)>0 GOT
	D RSET W !!,"Invoice Closed out!!" S FBSW=1
Q	Q:'FBSW  K J,FBAABO,FBBN,FBIN,TAC,TAP,TIC,DIC,D0,DA,DI,DIE,DQ,DR,IN,FBINTOT,FBAAMPI,FBAATPV,FBAAVIN,FBBIC,FBBLC,FBBTA,FBJ,FY,FBZZ,X,Y,Z,FBSTN Q
GOT	S TAC=TAC+$P(Y(0),"^",4),TAP=TAP+$P(Y(0),"^",16),TIC=TIC+1,FBBLC=FBBLC+1,FBSW=0 I $P(Y(0),"^",20)'="R" S FBAATPV=FBAATPV+$P(Y(0),"^",16)
	S DIC="^FBAA(162.1,"_FBIN_",""RX"",",DA=FBJ,DA(1)=FBIN,DIE=DIC,DR="13////^S X=FBBN;14////^S X=FBAABO;15////^S X=DT;8////^S X=4"
	D ^DIE
	I FBBLC>(FBAAMPI-1) D FULL
	Q
RSET	S DIC="^FBAA(162.1,",DA=FBIN,DIE=DIC,DR="5////^S X=4;6///^S X=TAC;7///^S X=TAP;8///^S X=TIC" D ^DIE
RSET2	S FBBTA=FBBTA+TAP,$P(Z(0),"^",9)=FBBTA,$P(Z(0),"^",10)=FBBIC,$P(Z(0),"^",11)=FBBLC,^FBAA(161.7,FBBN,0)=Z(0)
	Q
NOTYOU	W !!,*7,"Batch selected established by another user, choose another." G BT
NOTPH	W !!,*7,"Batch selected is NOT a Pharmacy type batch, choose another." G BT
NOTOP	W !!,*7,"Batch selected not in Open status, choose another." G BT
FULL	D RSET2 W !!,*7,"Batch has reached maximum allowable payment entries!",!,"Now openning another batch for you.",! K FBBN
	D NEWBT G BT:'$D(FBBN)
	Q
WARN	W !!,*7,"That Batch already has maximum allowable payment items!" K FBBN G BT
OUT	Q
WRT	W !,?20,"Invoice Totals: $ "_$J(FBINTOT,1,2) Q
NEWBT	;OPEN NEW BATCH IF NEEDED TO CLOSEOUT INVOICE
	S FBSTN=$P(Z(0),"^",8),FBAAOB=$P(Z(0),"^",2) W ! D GETNXB^FBAAUTL W !!,*7,"New Batch to closeout invoice is: ",FBBN
	S DIC="^FBAA(161.7,",DLAYGO=161.7,X=FBBN,DIC(0)="LQ",DIC("DR")="1////^S X=FBAAOB;2////^S X=""B5"";3////^S X=DT;4////^S X=DUZ;11////^S X=""O"";16////^S X=FBSTN"
	K DD,DO D FILE^DICN K DLAYGO S FBBN=+Y,Z(0)=^FBAA(161.7,FBBN,0)
	S FBAAOB=$P(Z(0),"^",2),FBBTA=$P(Z(0),"^",9),FBBIC=$P(Z(0),"^",10)+1,FBBLC=$P(Z(0),"^",11)
	Q

FBAAPIS
FBAAPIS	;AISC/GRR-PHARMACY INVOICE STATUS ;06MAR87
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	W !! S DIC="^FBAA(162.1,",DIC(0)="AEQ" D ^DIC G Q:X=""!(X="^"),RD:Y<0 S DA=+Y,DIE=DIC,DR=0 W ! D EN^DIQ G RD
Q	K DR,DA,X,Y,DIE,DIC,A,D0,DRX,S Q

FBAAPLU
FBAAPLU	;AISC/DMK-PHARMACY VENDOR LOOK-UP ;27JUL88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW
RDV	K FBAANQ W !! S FBAAOUT=0,DIC="^FBAAV(",DIC(0)="AEQM",DIC("A")="Select Pharmacy Vendor: ",DIC("S")="I $P(^(0),""^"",7)=3" D ^DIC K DIC("A"),DIC("S") G Q:X="^"!(X=""),RDV:Y<0 S FDA=+Y,FBVEN=$P(Y,"^",2)
	D DATE^FBAAUTL G:FBPOP RDV S ZZ=9999999,BEG=ZZ-ENDDATE,END=ZZ-BEGDATE
	S VAR="FDA^BEG^END^FBVEN",VAL=FDA_"^"_BEG_"^"_END_"^"_FBVEN,PGM="START^FBAAPLU" D ZIS^FBAAUTL G:FBPOP Q S:IO=IO(0) FBAANQ=1
	;
START	S Q="",$P(Q,"=",80)="=",HNAM="" U IO W:$E(IOST,1,2)="C-" @IOF D HED
	S (J,K,L)=0
	F I=BEG-1:0 S I=$O(^FBAA(162.1,"AK",FDA,I)) Q:I>END!(I'>0)!(FBAAOUT)  F  S J=$O(^FBAA(162.1,"AK",FDA,I,J)) Q:J'>0!(FBAAOUT)  F  S K=$O(^FBAA(162.1,"AK",FDA,I,J,K)) Q:K'>0!(FBAAOUT)  D  Q:FBAAOUT
	.F  S L=$O(^FBAA(162.1,"AK",FDA,I,J,K,L)) Q:L'>0!(FBAAOUT)  D  Q:FBAAOUT
	..I K]"" Q:'$D(^FBAA(162.1,K,0))&('$D(^FBAA(162.1,K,"RX",L,0)))  S Y(0)=^(0),Y(1)=$G(^FBAA(162.1,K,"RX",L,2))
	..S FBINVN=$P(^FBAA(162.1,K,0),"^"),N=$P(Y(0),"^",5),FBNM=$S($D(^DPT(N,0)):$P(^DPT(N,0),"^"),1:""),FBSSN=$S(N]"":$TR($$SSN^FBAAUTL(N),"-",""),1:"")
	..S FBRX=$P(Y(0),"^"),FBDRUG=$P(Y(0),"^",2),FBFD=$P(Y(0),"^",3),FBAC=$P(Y(0),"^",4),FBAP=$P(Y(0),"^",16),FBSUSP=$P(Y(0),"^",8),FBPD=$P(Y(0),"^",19),FBBATCH=$P(Y(0),"^",17) Q:FBBATCH']""
	..Q:$P(^FBAA(161.7,FBBATCH,0),"^",12)']""  S FBBATCH=$P($G(^FBAA(161.7,FBBATCH,0)),"^")
	..I FBSUSP]"" S FBSUSP=$P($G(^FBAA(161.27,FBSUSP,0)),"^")
	..S FBREIM=$S($P(Y(0),"^",20)="R":"*",1:""),FBSTR=$P(Y(0),"^",12),FBQTY=$P(Y(0),"^",13),A1=FBAC+.00001,A2=FBAP+.00001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2),FBPV=""
	..I $D(Y(1)) S FBPV=$S($P(Y(1),"^",3)="V":"#",1:"")
	..D FBCKP^FBAACCB1(K,L)
	..D WRT
	G:$D(FBAANQ) RDV
Q	K J,K,L,DIC,BEG,BEGDATE,END,ENDDATE,FBNM,FBSSN,FBVEN,FDA,HNAM,I,X,ZZ,FBRX,FBFD,FBAC,FBAP,A1,A2,FBPV,FBSUSP,FBSTR,FBQTY,FBAAOUT,FBBATCH,FBDRUG,FBINVN,FBPD,FBREIM,N,Q,VAL,VAR,PGM,Y
	D CLOSE^FBAAUTL
	Q
WRT	I $E(IOST,1,2)["C-",$Y+4>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  W @IOF D HED
	E  I $Y+4>IOSL W @IOF D HED
	W:FBNM'=HNAM !,FBNM,?40,FBSSN,!
	W !,FBREIM,FBPV,$S($G(FBCAN)]"":"+",1:""),?3,$$DATX^FBAAUTL(FBFD),!," Rx: "_FBRX,?15,FBDRUG,?45,FBSTR,?63,FBQTY
	W !,?4,$J(A1,4),?12,$J(A2,4),?20,FBSUSP,?24,FBINVN,?35,FBBATCH,?53,$$DATX^FBAAUTL(FBPD),!
	D PMNT^FBAACCB2
	S HNAM=FBNM
	Q
HED	S FBAAOUT=0 W ?20,"** PHARMACY VENDOR LOOK-UP **",!,!,"Vendor: ",FBVEN,?40,"ID #: ",$P(^FBAAV(FDA,0),"^",2),?60,"Chain #: ",$P(^(0),"^",10),!!,?15,"('*' Reimbursement to Patient   '+' Cancellation Activity)",!,?15,"('#' Voided Payment)",!
	W ?3,"Patient",?40,"SSN",!,"Fill Date",?15,"Drug Name",?44,"Strength",?60,"Quantity",!,?2,"Claimed",?11," Paid",?19,"Code",?24,"Invoice #",?35,"Batch #",?50,"Date Finalized",!,Q
	Q

FBAAPM
FBAAPM	;AISC/DMK,GRR-CREATE PATIENT MRA TRANSACTION ;08MAY87
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
1	Q:'$D(FBMTYPE)
	D GETVET^FBAAUTL1 G END:'DFN
	D GETAUTH^FBAAUTL1 G 1:FTP']""
	S FBD1=+FTP
3	W ! S DIR("A")="Are you sure you want to create a '"_$S(FBMTYPE="A":"Add",FBMTYPE="D":"Delete",FBMTYPE="C":"Change",FBMTYPE="R":"Reinstate",1:"")_"' type MRA for this patient",DIR("B")="Yes",DIR(0)="Y" D ^DIR
	K DIR G 1:$D(DIRUT)!('Y)
	S FBMST=$S($P(^FBAAA(DFN,1,FBD1,0),"^",13)=1:"Y",1:""),DIC="^FBAA(161.26,",DIC(0)="LN",DLAYGO=161.26
	I $D(^FBAA(161.26,"AC","T",+$G(DFN))) D
	. S DA=+DFN,DIK="^FBAA(161.26," D ^DIK K DA,DIK
	S X="`"_DFN,DR="1////^S X=""P"";2////^S X=FBD1;S Y=$S(FBMST="""":3,1:6);6////^S X=FBMST;3////^S X=FBMTYPE;S:FBMTYPE'=""C"" Y="""";5;",DIE=DIC D ^DIC K DLAYGO G:Y<0 END S DA=+Y D ^DIE
	I $D(Y)>0 S DIK=DIE D ^DIK W !,*7,"MRA deleted.",! G 1
	W !!,"Transaction Created!"
	I FBMTYPE="D" S $P(^FBAAA(DFN,1,FBD1,"ADEL"),"^",1,2)="Y^"_DT
	I FBMTYPE="R"!(FBMTYPE="A") S:$D(^FBAAA(DFN,1,FBD1,"ADEL")) ^("ADEL")=""
	G 1
END	K DIC,CNT,Y,X,I,DIC,D0,DFN,F,C,FBD1,DA,DAT,DI,DIE,DQ,DR,PE,FBMST,FBMTYPE,FBVEN,FTP,FBPSA,FBLOC,FBASSOC,FB7078,FBAABDT,FBAAEDT,FBAAOUT,FBAUT,FBPOV,FBPROG,FBPT,FBTT,FBTYPE,PI,TA,Z,FBDMRA
	Q

FBAAPOC
FBAAPOC	;AISC/GRR-PRINT OBSOLETE CARDS ;15APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S VAR="",PGM="START^FBAAPOC" D ZIS^FBAAUTL G:FBPOP Q
START	S FBOUT=0 U IO S UL="" F A=1:1:80 S UL=UL_"="
	W:$E(IOST,1,2)="C-" @IOF D HED
	S J=0 F JJ=0:0 S J=$O(^FBAA(161.83,"C",J)) Q:J'>0!($G(FBOUT))  F K=0:0 S K=$O(^FBAA(161.83,"C",J,K)) Q:K'>0!($G(FBOUT))  F L=0:0 S L=$O(^FBAA(161.83,"C",J,K,L)) Q:L'>0!($G(FBOUT))  I $D(^FBAA(161.83,K,1,L,0)) S Y(0)=^(0) D GOT Q:FBOUT
Q	W ! K A,J,K,JJ,UL,FBOUT,FBDT,FBNM,FBSSN,FBR,FBPOP,L,Y
	D CLOSE^FBAAUTL Q
GOT	S FBDT=$P(Y(0),"^"),FBNM=$S($D(^DPT(K,0)):$P(^(0),"^"),1:""),FBSSN=$S(FBNM="":"",1:$$SSN^FBAAUTL(K)),FBDT=$S(FBDT[".":$P(FBDT,"."),1:FBDT),FBR=$P(Y(0),"^",3)
	I $E(IOST,1,2)["C-",$Y+4>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBOUT=1 Q:FBOUT  W @IOF D HED
	E  I $Y+4>IOSL W @IOF
	W !!,J,?10,FBNM,?42,$G(FBSSN),?61,$$DATX^FBAAUTL(FBDT),!,?2,FBR
	Q
HED	W !,"Old Card ",?10,"Patient Name",?42,"Pt.ID",?61,"Change Date",!?1,"Number",!?2,"Reason For Change",!,UL Q

FBAAPP
FBAAPP	;AISC/GRR-ENTER FEE PHARMACY DETERMINATION ;09FEB86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D HOME^%ZIS S FBAAOUT=0 K ^TMP($J,"FBWP") D DT^DICRW
	I '$D(^FBAA(162.1,"AC",1)) W !!,"There are no Fee Basis prescriptions Pending Pharmacy review" G END
	D WAIT^DICD S (CNT,L,M)=0 F  S L=$O(^FBAA(162.1,"AC",1,L)) Q:L'>0  I $D(^FBAA(162.1,L,"RX","AC",1)) F  S M=$O(^FBAA(162.1,L,"RX","AC",1,M)) Q:M'>0  S CNT=CNT+1
	W !!,*7,"There are ",CNT," Fee Prescription(s) Pending Pharmacy review"
ASKRV	Q:CNT'>0  W ! S DIR("A")="Want to review some now",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR G END:$D(DIRUT)!('Y)
RDIN	W ! S FBAAOUT=0,DIC="^FBAA(162.1,",DIC(0)="AEQ",DIC("S")="S ZZ=^(0) I $P(ZZ,U,5)=1&($D(^FBAA(162.1,+ZZ,""RX"",""AC"",1))) K ZZ" D ^DIC K DIC G END:X=""!(X="^"),HELPI^FBAAPP0:X["?" S FBJ=+Y
	L +^FBAA(162.1,"AC",1,FBJ):1 G:'$T ALRDY^FBAAPP0 I $D(^FBAA(162.1,FBJ,"RX","AC",1)) S FBK=0 F  S FBK=$O(^FBAA(162.1,FBJ,"RX","AC",1,FBK)) Q:FBK'>0!(FBAAOUT)  I $D(^FBAA(162.1,FBJ,"RX",FBK,0)) S FBY(0)=^(0) D GOT,CHK:$D(^FBAA(162.1,"AC",1))
	L -^FBAA(162.1,"AC",1,FBJ) I '$D(^FBAA(162.1,"AC",1)) W !,*7,"No more prescriptions pending review!" G END
	G RDIN
END	K DFN,FBJ,FBK,Y,X,FBAAOUT,L,CNT,STAT,DA,DAT,DIC,FBAAGP,FBAAPR,FBDX,FDT,SSN,HY,I,T,VIFN,Z,ZZ,VAL,FBAASC,M,W,FBY,FBASSOC,FB583,FB7078,FBPROG,FBTYPE,FBDMRA,FBAUT,^TMP($J,"FBWP")
	K FBNO1,FBNO2,FBDA,FBDRUG
	Q
GOT	S STAT=2,DFN=$P(FBY(0),"^",5) Q:'$D(^DPT(+DFN,0))
	S FBPROG=$P($G(^FBAA(162.1,FBJ,"RX",FBK,2)),"^",7),FBPROG=$S(FBPROG:"I FBI="_FBPROG,1:"")
	S HY=Y,PI="" D ^FBAADEM
	D FBPH^FBAAUTL2 W ! F X=1:1:IOM-1 W "-"
	I $Y+5>IOSL,$E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR Q:'Y  W @IOF
	S Y=HY,VIFN=$P(^FBAA(162.1,FBJ,0),"^",4)
	W !!,"Vendor: ",$P($G(^FBAAV(+VIFN,0)),"^"),!
	I $P(FBY(0),"^",20)="R" W *7,!?20,">> PATIENT REIMBURSEMENT <<",!
	S FDT=$P(FBY(0),"^",3) W !,"Prescription #: ",$P(FBY(0),"^"),"    Drug: ",$P(FBY(0),"^",2),!!,"Fill Date: ",$E(FDT,4,5),"/",$E(FDT,6,7),"/",$E(FDT,2,3),"    Strength: ",$P(FBY(0),"^",12)
	W "  Qty: ",$P(FBY(0),"^",13)
DIR	; DISPLAY FOR PHARMACY EDIT
	S (FBAAGP,FBNO1,FBNO2)="Yes",(FBAAPR,FBAASC)="" I '$D(IOM) D HOME^%ZIS
DIR1	S DIR("A")="Is Prescription for an Authorized Condition",DIR("B")=FBNO1,DIR(0)="Y",DIR("?")="A 'No' answer will deny payment." D ^DIR K DIR Q:$D(DIRUT)  I 'Y S FBNO1="No" S (FBNO2,FBAAGP)="" D NO1^FBAAPP0 Q:'FBAASC  G REVIEW
	S:FBAAGP]"" DIR("B")=FBAAGP S DIR("A")="Was a Generic Drug issued to patient",DIR(0)="Y",DIR("?")="A 'No' answer alerts FEE to pay the generic equivalent, if one exists." D ^DIR K DIR Q:$D(DIRUT)  S:'Y FBAAGP="No"
	S DIR("A")="Enter VA Generic Drug equivalent",DIR("?")="Match the drug entered by FEE to an entry in the VA Drug file.",DIR(0)="P^50:EM" D ^DIR K DIR Q:$D(DIRUT)!('Y)  S FBDA=+Y,FBDRUG=$P(Y,"^",2)
	S:FBNO2]"" DIR("B")=FBNO2 S DIR("A")="Is this an emergency medication",DIR("?")="A 'No' answer will DENY payment.",DIR(0)="Y" D ^DIR K DIR Q:$D(DIRUT)  I 'Y S FBNO2="No" D NO1^FBAAPP0 Q:'FBAASC
REVIEW	W ! S:FBAAPR]"" DIR("B")=FBAAPR S DIR("A")="Optional Pharmacy Remarks ",DIR(0)="162.11,22" D ^DIR K DIR Q:$D(DUOUT)!($D(DTOUT))  S FBAAPR=Y
	W ! F I=1:1:IOM-2 W "-"
	W !!?22,">>>  PRESCRIPTION REVIEW  <<<",!
	W !,"Rx for Authorized condition: ",$S(FBNO1="No":"No",1:"Yes")
	W ?36,"Emergency Medication: ",$S(FBNO2="":"",FBNO2="No":"No",1:"Yes")
	W !,"Generic Drug Issued: ",$S('$D(FBAAGP):"",1:FBAAGP)
	W ?36,"Generic Drug Name: ",$S($D(FBDRUG):$E(FBDRUG,1,25),1:"")
	I $D(FBAASC),FBAASC W !,"Suspense Code: ",$G(^FBAA(161.27,+FBAASC,2))
	I $G(FBAASC),(FBAASC=4) W !,"Suspension Description:  " I $D(^TMP($J,"FBWP",0)) F FBI=1:1 Q:'$D(^TMP($J,"FBWP",FBI,0))  W !,?5,^(0)
	W !!,"Optional Pharmacy Remarks: ",FBAAPR
	W ! S DIR("A")="Want to edit prior to release",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR Q:$D(DIRUT)  G DIR1:Y
	I $D(FBAASC),FBAASC G GOON^FBAAPP0
	S $P(FBY(0),"^",10)=FBDA
OVR	S $P(FBY(0),"^",11)=1,$P(FBY(0),"^",14)=DUZ,$P(FBY(0),"^",15)=DT,$P(FBY(0),"^",9)=2
	G RSET^FBAAPP0
	;
CHK	S FBAAOUT=0 W ! S DIR("A")="Want to review another Prescription",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR S:'Y FBAAOUT=1 K ^TMP($J,"FBWP")
	Q

FBAAPP0
FBAAPP0	;AISC/GRR-ENTER FEE PHARMACY DETERMINATION CONT ;09FEB86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
HELPI	W !!,"Enter Invoice number you wish to make a determination on.  Must",!,"be an invoice which is 'Pending Determination' status." G RDIN^FBAAPP
ALRDY	W !,*7,"Someone is editing that invoice now!" G RDIN^FBAAPP
	;
NO1	;ASK PHARMACIST TO SELECT SUSPENSE CODE
	S FBAASC=""
	S DIR(0)="P^161.27:EQM",DIR("A")="Select Suspense Code" D ^DIR K DIR Q:$D(DIRUT)!(Y=-1)  S FBAASC=+Y D:FBAASC=4 SUSP
	Q
SUSP	;ASK TO ENTER SUSPENSION DESCRIPTION
	I $D(^TMP($J,"FBWP",0)) G SUSP1
	I $D(^FBAA(162.1,FBJ,"RX",FBK,1)) S:$D(^(0)) ^TMP($J,"FBWP",0)=^(0) F FBI=1:1 Q:'$D(^FBAA(162.1,FBJ,"RX",FBK,1,FBI,0))  S ^TMP($J,"FBWP",FBI,0)=^(0)
SUSP1	S DIC="^TMP("_$J_",""FBWP"",",DWPK=1 W !,"Suspension Description" D EN^DIWE I '$O(^TMP($J,"FBWP",0)) W !!,*7,"Suspension description is required for a suspense code of 'OTHER'." G SUSP
	Q
	;
GOON	S ^FBAA(162.1,"AG",VIFN,DT,DFN,FBAASC,FBJ,FBK)=""
	S STAT=3,$P(FBY(0),"^",8)=FBAASC,$P(FBY(0),"^",11)=0,$P(FBY(0),"^",14)=DUZ,$P(FBY(0),"^",15)=DT,$P(FBY(0),"^",9)=3,$P(FBY(0),"^",16)=0,$P(FBY(0),"^",7)=$P(FBY(0),"^",4)
RSET	S $P(FBY(0),"^",21)=FBAAGP,$P(FBY(0),"^",22)=FBAAPR,^FBAA(162.1,FBJ,"RX",FBK,0)=FBY(0)
	K ^FBAA(162.1,FBJ,"RX","AC",1,FBK) S ^FBAA(162.1,FBJ,"RX","AC",STAT,FBK)="",$P(^FBAA(162.1,FBJ,0),"^",5)=$S($D(^FBAA(162.1,FBJ,"RX","AC",1)):1,$D(^(2)):2,$D(^(3)):3,1:0)
	I '$D(^FBAA(162.1,FBJ,"RX","AC",1)) K ^FBAA(162.1,"AC",1,FBJ) S ^FBAA(162.1,"AC",2,FBJ)=""
	I $O(^TMP($J,"FBWP",0)) S ^FBAA(162.1,FBJ,"RX",FBK,1,0)=^(0) F FBI=1:1 Q:'$D(^TMP($J,"FBWP",FBI,0))  S ^FBAA(162.1,FBJ,"RX",FBK,1,FBI,0)=^(0)
	Q

FBAAPPH
FBAAPPH	;AISC/GRR-PHARMACY HISTORY LIST FOR PATIENT ;03APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW S FBAAOUT=0
RD	K FBAANQ W !! S FBAAOUT=0,DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC G Q:X=""!(X="^"),RD:Y<0 S DFN=+Y
	I '$D(^FBAA(162.1,"AD",DFN)) W !!,*7,"No payments for this patient!" G RD
	S VAR="DFN",VAL=DFN,PGM="LIST^FBAAPPH" D ZIS^FBAAUTL G:FBPOP Q S:IO=IO(0) FBAANQ=1
LIST	S Q="" S $P(Q,"=",80)="="
	S FSW=1 U IO I $E(IOST,1,2)="C-" W @IOF
	S (FBAAOUT,J,K,L)=0
	I '$O(^FBAA(162.1,"AD",DFN,0)) W !,"Patient has no Pharmacy payment history.",! Q
	F  S J=$O(^FBAA(162.1,"AD",DFN,J)) Q:J'>0!(FBAAOUT)  F  S K=$O(^FBAA(162.1,"AD",DFN,J,K)) Q:K'>0!(FBAAOUT)  F  S L=$O(^FBAA(162.1,"AD",DFN,J,K,L)) Q:L'>0!(FBAAOUT)  D GOT Q:FBAAOUT
	I FBAAOUT,$E(IOST,1,2)="C-" W @IOF
	G:$D(FBAANQ) RD
Q	K DIC,DOB,J,K,L,DFN,FBAANQ,FBRX,FBFD,FBAC,FBAP,A1,A2,FBPV,FBSUSP,FBSTR,FBQTY,FBAAOUT,FSW,FID,CHN,FBBATCH,FBDRUG,FBINVN,FBPD,FBREIM,N,NAME,Q,FBSSN,VAL,VAR,VID,PGM,VNAM,X,Y,I,FBSAR,FBI
	W:$E(IOST,1,2)'="C-" @IOF D CLOSE^FBAAUTL Q
	;
GOT	S FBSSN=$$SSN^FBAAUTL(DFN),N=$G(^DPT(+DFN,0)),NAME=$P(N,"^"),DOB=$P(N,"^",3),DOB=$S(DOB]"":$E(DOB,4,5)_"/"_$E(DOB,6,7)_"/"_$E(DOB,2,3),1:"")
	Q:'$D(^FBAA(162.1,K,0))&('$D(^FBAA(162.1,K,"RX",L,0)))  S Y(0)=$G(^FBAA(162.1,K,"RX",L,0))
	S Y(2)=$G(^FBAA(162.1,+K,0)) I $D(^FBAA(162.1,K,"RX",L,2)) S Y(1)=^(2)
	S FBINVN=$P(Y(2),"^"),VID=$P(Y(2),"^",4),CHN=$G(^FBAAV(+VID,0)),VNAM=$P(CHN,"^"),FID=$P(CHN,"^",2),CHN=$P(CHN,"^",10)
	S FBRX=$P(Y(0),"^",1),FBDRUG=$P(Y(0),"^",2),FBFD=$P(Y(0),"^",3),FBAC=$P(Y(0),"^",4),FBAP=$P(Y(0),"^",16),FBSUSP=$P(Y(0),"^",8),FBPD=$P(Y(0),"^",19),FBBATCH=$P(Y(0),"^",17),FBBATCH=$P($G(^FBAA(161.7,+FBBATCH,0)),"^")
	I FBSUSP=4 S FBI=0 F  S FBI=$O(^FBAA(162.1,K,"RX",L,1,FBI)) Q:'FBI  S FBSAR(FBI)=^(FBI,0)
	I FBSUSP]"" S FBSUSP=$P($G(^FBAA(161.27,+FBSUSP,0)),"^")
	S FBREIM=$S($P(Y(0),"^",20)="R":"*",1:""),FBSTR=$P(Y(0),"^",12),FBQTY=$P(Y(0),"^",13),A1=FBAC+.00001,A2=FBAP+.00001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2),FBPV=""
	I $D(Y(1)) S FBPV=$S($P(Y(1),"^",3)="V":"#",1:"")
	D FBCKP^FBAACCB1(K,L)
WRT	I FSW S FSW=0 D HED
	I $E(IOST,1,2)="C-",$Y+7>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  W @IOF D HED
	I $Y+6>IOSL W @IOF D HED
	W !!,VNAM,?48,FID,?60,CHN,!,FBREIM,FBPV,?3,$E(FBFD,4,5),"/",$E(FBFD,6,7),"/",$E(FBFD,2,3),!," Rx: "_FBRX,?15,FBDRUG,?45,FBSTR,?63,FBQTY
	W !,?4,$J(A1,4),?12,$J(A2,4),?20,FBSUSP,?24,FBINVN,?35,FBBATCH,?53,$S(FBPD="":"",1:$E(FBPD,4,5)_"/"_$E(FBPD,6,7)_"/"_$E(FBPD,2,3))
	I $D(FBSAR) W !?4," Suspension Description: " S FBI=0 F  S FBI=$O(FBSAR(FBI)) Q:'FBI  W " ",FBSAR(FBI)
	D PMNT^FBAACCB2
	K FBSAR Q
HED	W:$E(IOST,1,2)'="C-" !?25,"PHARMACY PAYMENT HISTORY",!?24,$E(Q,1,26)
	W !,"Patient: ",NAME,?41,"Pt ID: ",FBSSN,?60,"DOB: ",DOB,!?15,"('*' Re-imbursement to Patient   '+' Cancellation Activity)",!,?15,"('#' Voided Payment)",!,?2,"Vendor Name",?48,"ID #",?59,"Chain #"
	W !,?4,"Fill Date",!,?15,"Drug Name",?44,"Strength",?60,"Quantity",!,?2,"Claimed",?11," Paid",?19,"Code",?24,"Invoice #",?35,"Batch #",?50,"Date Certified",!,Q
	Q

FBAAPRC
FBAAPRC	;AISC/DMK-PRINT REPORT OF CONTACT ;08/02/88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW,SITEP^FBAAUTL
RD	S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC Q:X=""!(X="^")  G:Y<0 RD S DFN=+Y G:$O(^FBAAA(DFN,2,0))'>0 NONE S DIC="^FBAAA("_DFN_",2," D ^DIC Q:Y<0  S ROC=+Y,SITE=$P(FBSITE(0),"^",1)
	S VAR="DFN^ROC^SITE",VAL=DFN_"^"_ROC_"^"_SITE,PGM="START^FBAAPRC" D ZIS^FBAAUTL G:FBPOP Q
START	U IO S I=ROC,(USR,VEN,J)="",FBX=$G(^FBAAA(DFN,2,I,0)),USR=$P($G(^FBAAA(DFN,2,I,100)),"^"),VEN=$P(FBX,"^",2),Y=+FBX,VENTEL=$P(FBX,"^",3) F J=1:1:6 S J(J)="" D DATE
	Q:'$D(^DPT(DFN))  S NAM=$P(^(DFN,0),"^")
	I $D(^DPT(DFN,.11)) F J=1:1:6 S J(J)=$P(^(.11),"^",J)
	S TEL=$S($D(^DPT(DFN,.13)):$P(^DPT(DFN,.13),"^"),1:"None on File"),STAT=$S(J(5)']"":" ",$D(^DIC(5,J(5),0)):$P(^(0),"^",2),1:" ")
	S FBCON=$P($G(^FBAAA(DFN,2,ROC,0)),"^",6),FBCON=$S(FBCON="T":"Telephone",FBCON="P":"Personal",1:"Unknown")
	S L="|",(PI,QQ,Q)="",$P(Q,"-",80)="-",$P(QQ,"=",80)="=" W !!!,QQ,!,?40,L,"VA Office",?58,L,"SSN #",!
	W ?40,L,?58,L,!,?8,">>  REPORT  OF  CONTACT  <<",?40,L,$E(SITE,1,18),?58,L,?60,$P(^DPT(DFN,0),"^",9),!,?40,L,$E(SITE,19,30),?58,L,!,Q,!,?3," Name of Veteran",?34,L,"Telephone No. of Vet.",?58,L,"Date of Contact",!
	W ?34,L,?58,L,!,?3,$E(NAM,1,30),?34,L,TEL,?58,L,?61,DAT,!,Q,!,?3," Address of Veteran",?58,L,"Type of Contact",!,?3,J(1),?58,L,!,?3,J(4) I J(5)]"" W ",",STAT," ",J(6)
	W ?58,L,?63,FBCON,!,Q,!,?3," Person Contacted",?58,L,"Telephone Number of",!,?58,L,"  Person Contacted",!,?3,VEN,?58,L,?61,VENTEL,!,Q,!,?3,"Brief statement of information requested and given",!
ALRT1	W !!! Q:'$D(^FBAAA(DFN,2,I,1,0))  K ^UTILITY($J,"W") S DIWL=10,DIWR=70,DIWF="W" S FBI=I
	F FBRR=0:0 S FBRR=$O(^FBAAA(DFN,2,FBI,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX S I=FBI
BOT	W ! S BOT=IOSL-($Y+8) F BT=1:1:BOT W !
	W Q,!,?6,"Division or Section",?40,L,"   Executed by(signature and title)",!,?10,"FEE BASIS",?40,L,"   ",$$SIGBLK^FBAAPRC(USR),!,QQ,!,"VA form 119"
Q	D CLOSE^FBAAUTL K DFN,DIC,Y,X,I,J,L,NAM,TEL,ROC,S,PI,FBI,FBSITE,PGM,VAL,VAR,Z,FBCON,FBRR,USR,Q,QQ,VEN,BOT,BT,SITE,STAT,VENTEL,D0,D1,DAT,DIW,DIWF,DIWL,DIWR,DIWT,DIYS,DWLW,FBX Q 
DATE	S DAT=$P(FBX,"^"),DAT=$$DATX^FBAAUTL(DAT) Q
NONE	W !!,"There are no Reports of Contact on line for this patient.",!! G Q
	;
SIGBLK(X)	;returns the signature block printed name if in 200
	;if not will return the .01 field.
	;if entry does not exist will return null
	;X equal to duz
	;
	I $S('$G(X):1,'$D(^VA(200,X,0)):1,1:0) Q ""
	Q $S($P($G(^VA(200,X,20)),U,2)]"":$P(^(20),U,2),1:$P(^VA(200,X,0),U))

FBAAPRGS
FBAAPRGS	;AISC/DMK-STATUS OF PURGE ;15JUL92
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^XUTL("FBAAPURGE")) W !?5,"Fee Purge is not running!",! Q
	;
	W !?5,"Total Payment Line Items to be Purged:  ",$FN($P(^XUTL("FBAAPURGE"),"^"),",")
	W !!?5,"Number of Line Items Purged as of now:  ",$FN($P(^XUTL("FBAAPURGE"),"^",2),",")
	Q

FBAAPV
FBAAPV	;AISC/CMR-Vendors Pending Austin Approval;9/17/93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S (VAR,VAL)="",PGM="START^FBAAPV" D ZIS^FBAAUTL G EXIT:FBPOP
START	S (FBAAOUT,FBI)=0 F  S FBI=$O(^FBAA(161.25,FBI)) Q:'FBI  D
	.S FBIN=$G(^FBAA(161.25,FBI,0)) I FBIN["N"!(FBIN["C") S FBDT=$P(FBIN,"^",5),FBNAME=$$VNAME^FBNHEXP(FBI),^TMP($J,"FBPV",FBNAME,FBI)=FBDT
	I '$D(^TMP($J,"FBPV")) G MSG
	U IO W:$E(IOST,1,2)["C-" @IOF D HED
	S FBNAME="",FBI=0 F  S FBNAME=$O(^TMP($J,"FBPV",FBNAME)) Q:FBNAME']""!FBAAOUT  F  S FBI=$O(^TMP($J,"FBPV",FBNAME,FBI)) Q:'FBI!FBAAOUT  S FBDT=+^(FBI) D
	.I $Y+3>IOSL,($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	.I $Y+3>IOSL W @IOF D HED
	.F FBT=2,3,4,5,6,14 S FBT(FBT)=$P(^FBAAV(FBI,0),"^",FBT)
	.W !!,FBNAME,?35,FBT(2),?60,$S(FBDT>0:$$DATX^FBAAUTL(FBDT),1:"Not Transmitted"),!?5,FBT(3) W:FBT(14)]"" !?5,FBT(14) W !?5,FBT(4),"  ",$P($G(^DIC(5,+FBT(5),0)),U,2),"   ",FBT(6)
EXIT	K FBI,FBIN,FBDT,FBNAME,FBQ,FBAAOUT,^TMP($J,"FBPV")
	D CLOSE^FBAAUTL
	Q
HED	W !?18,"FEE BASIS VENDORS AWAITING AUSTIN APPROVAL"
	W !?33,$$DATX^FBAAUTL(DT),!?18 F FBQ=1:1:42 W "-"
	W !!,"VENDOR",?38,"ID",?54,"DATE TRANSMITTED TO AUSTIN" F FBQ=1:1:80 W "="
	W ! Q
MSG	W !!,"There are no venders awaiting Austin approval."
	G EXIT

FBAARB
FBAARB	;AISC/GRR,dmk-RE-OPEN BATCH PREVIOUSLY CLOSED ;18OCT94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
BT	W !!
	S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"I $G(^(""ST""))=""C""",1:"I $P(^(0),U,5)=DUZ&($G(^(""ST""))=""C"")")
	D ^DIC K DIC G Q:X="^"!(X=""),BT:Y<0
	S FBBAT=+Y,FBTYPE=$P(Y(0),U,3)
	;FBBAT=ien of batch in 161.7  FBTYPE= batch type (B2,B3,B5,B9)
	;reset payment line item total and total dollars
	D CNTTOT(FBBAT)
	S DIE="^FBAA(161.7,",DR="4////^S X=DUZ;4.5///@;10////^S X=FBLCNT;8////^S X=FBTOTAL;11////^S X=""O"";S:$G(FBTYPE)'=""B9"" Y="""";9////^S X=FBLCNT",DA=FBBAT
	D ^DIE K DIE,DR
	S:FBTOTAL=0 $P(^FBAA(161.7,+FBBAT,0),U,9)=""
	S:FBLCNT=0 $P(^FBAA(161.7,+FBBAT,0),U,11)=""
	W !! D EN^DIQ W !,"Batch has been Re-opened!" D Q G BT
	;
Q	K DA,FBLCNT,FBTOTAL,FBBAT,Y
	Q
	;
CNTTOT(B)	;called to determine line count and total dollars for a batch
	; INPUT:  B = IEN of batch in 161.7
	; OUTPUT: FBLCNT = total line items in batch
	;         FBTOTAL= total dollars in batch
	;
	N A
	S (FBLCNT,FBTOTAL)=0
	Q:'$G(B)
	Q:'$D(^FBAA(161.7,+B,0))  S A=$P($G(^(0)),U,3)
	Q:A']""
	D @A
	Q
B2	;travel batch use ^FBAAC("AD", to locate line items
	N I,J
	S (I,J)=0 F  S I=$O(^FBAAC("AD",B,I)) Q:'I  F  S J=$O(^FBAAC("AD",B,I,J)) Q:'J  I $D(^FBAAC(I,3,J,0)) D
	. S FBLCNT=FBLCNT+1,FBTOTAL=FBTOTAL+$P(^(0),U,3)
	Q
	;
B3	;outpatient batch use ^FBAAC("AC", to locate line items
	N I,J,K,L
	S (I,J,K,L)=0
	F  S I=$O(^FBAAC("AC",B,I)) Q:'I  F  S J=$O(^FBAAC("AC",B,I,J)) Q:'J  F  S K=$O(^FBAAC("AC",B,I,J,K)) Q:'K  F  S L=$O(^FBAAC("AC",B,I,J,K,L)) Q:'L  I $D(^FBAAC(I,1,J,1,K,1,L,0)) D
	. S FBLCNT=FBLCNT+1,FBTOTAL=FBTOTAL+$P(^(0),U,3)
	Q
	;
B5	;pharmacy batch use ^FBAA(162.1,"AE", to locate line items
	N I,J
	S (I,J)=0
	F  S I=$O(^FBAA(162.1,"AE",B,I)) Q:'I  F  S J=$O(^FBAA(162.1,"AE",B,I,J)) Q:'J  I $D(^FBAA(162.1,I,"RX",J,0)) D
	. S FBLCNT=FBLCNT+1,FBTOTAL=FBTOTAL+$P(^(0),U,16)
	Q
	;
B9	;inpatient batch use ^FBAAI("AC", to locate line items
	N I
	S I=0
	F  S I=$O(^FBAAI("AC",B,I)) Q:'I  I $D(^FBAAI(I,0)) D
	. S FBLCNT=FBLCNT+1,FBTOTAL=FBTOTAL+$P(^(0),U,9)
	Q

FBAARD
FBAARD	;AISC/DMK-VOUCHER AUDIT DELETE REJECTS ENTERED IN ERROR ;08JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
	S Q="",$P(Q,"=",80)="=",UL="",$P(UL,"-",80)="-",(CNT,FBAAOUT,FBINTOT)=0
	D DT^DICRW
BT	K QQ W !! S DIC="^FBAA(161.7,",DIC(0)="AEQMN",DIC("S")="I $G(^(""ST""))=""V""&($P(^(0),U,17)]"""")" D ^DIC K DIC("S") G Q:X="^"!(X=""),BT:Y<0 S FBN=+Y,B=FBN,FZ=^FBAA(161.7,FBN,0),FBTYPE=$P(FZ,"^",3),FBAAON=$P(FZ,"^",2),FBAARA=0
	I FBTYPE="B9",$P(FZ,"^",15)="" S FBCNH=1
	S FBAAB=$P(FZ,"^"),FBAAOB=$P(FZ,"^",8)_"-"_FBAAON,FBCOMM="Rejects deleted from batch "_FBAAB
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !!,*7,"Sorry, only Supervisor can Delete reject flag!" G Q
	I '$S(FBTYPE="B3":$D(^FBAAC("AH",B)),FBTYPE="B2":$D(^FBAAC("AG",B)),FBTYPE="B5":$D(^FBAA(162.1,"AF",B)),FBTYPE="B9":$D(^FBAAI("AH",B)),1:0) W !!,*7,"No items rejected in this batch!" G BT
	S DA=FBN,DR="0;ST" W !! D EN^DIQ
	S FBNUM=$P(^FBAA(161.7,B,0),"^",1),FBVD=$P(^(0),"^",12),FBVDUZ=$P(^(0),"^",16)
ASKLL	S B=FBN,FBNNP=1 S DIR(0)="Y",DIR("A")="Want line items listed",DIR("B")="NO" D ^DIR K DIR W:Y @IOF D:Y MORE^FBAARJP:FBTYPE="B3",PMORE^FBAARJP:FBTYPE="B5",TMORE^FBAARJP:FBTYPE="B2",CMORE^FBAARJP:FBTYPE="B9" K FBNNP
RD0	S DIR(0)="Y",DIR("A")="Want to delete rejection codes for the entire Batch",DIR("B")="NO",DIR("?")="^D ^FBAARD0" D ^DIR K DIR G Q:$D(DIRUT),^FBAARD1:Y
RD1	S DIR(0)="Y",DIR("A")="Want to delete rejection code for any line items",DIR("B")="NO" D ^DIR K DIR G Q:'Y,Q:$D(DIRUT) D DELT^FBAARD2:FBTYPE="B2",DELM:FBTYPE="B3",DELP^FBAARD2:FBTYPE="B5",DELC^FBAARD0:FBTYPE="B9"
	G Q:$D(FBERR)
RDD	;
FIN	S $P(FZ,"^",12)=DT,$P(FZ,"^",16)=DUZ,^FBAA(161.7,FBN,0)=FZ,^FBAA(161.7,FBN,"ST")="V",^FBAA(161.7,"AC","V",FBN)="",^FBAA(161.7,"AF",DT,FBN)="" K ^FBAA(161.7,"AC","T",FBN)
	S DIC="^FBAA(161.7,",DA=FBN,DR="0;ST" W !! D EN^DIQ G BT
Q	K B,J,K,L,M,X,Y,Z,DIC,ERR,A,A1,A2,CPTDESC,DIRUT,DR,FBAACB,FBAACPT,FBAAON,FBAAOUT,FBAARA,FBIN,FBINOLD,FBINTOT,FBNUM,FBRR,FBTYPE,FBVD,FBVDUZ,FBVP,FZ,FBN,CNT,Q,P3,P4,UL,VAL,FBERR,FBAAMT,FBAAOB,FBCOMM,FBAAB,V,VID
	K FBAC,FBAP,FBDX,FBFD,FBK,FBX,FBPDT,FBSC,FBTD,S,ZS,PRCSCPAN,FBCNH,DUOUT
	Q
ERR	S ERR=1 W !!,"Invalid entry, must enter a number between 1 and ",QQ,!,"or an '^' to exit!" Q
GET	W !! S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC Q:X="^"!(X="")  G GET:Y<0 S DA=+Y,J=DA Q
DELM	K QQ D GET Q:X="^"!(X="")  I '$D(^FBAAC("AH",B,J)) W !!,*7,"No payments in this batch for that patient!" G DELM
	S QQ=0,FBAAOUT="" W @IOF D HED^FBAACCB
	F K=0:0 S K=$O(^FBAAC("AH",B,J,K)) Q:K'>0!(FBAAOUT)  F L=0:0 S L=$O(^FBAAC("AH",B,J,K,L)) Q:L'>0!(FBAAOUT)  F M=0:0 S M=$O(^FBAAC("AH",B,J,K,L,M)) Q:M'>0!(FBAAOUT)  D WRITM
RL1	S DIR(0)="Y",DIR("A")="Delete Reject flag for all items for this patient",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  G LOOP:Y
RL	S ERR=0 S DIR(0)="N^1:"_QQ,DIR("A")="Delete reject for which line item" D ^DIR K DIR Q:$D(DIRUT)  S HX=X
	I '$D(QQ(HX)) W !,*7,"You already deleted that one!!" G RL
ASUR	S DIR(0)="Y",DIR("A")="Are you sure you want to delete reject for item number "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RL
	S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2),L=$P(QQ(HX),"^",3),M=$P(QQ(HX),"^",4)
	D STUFF^FBAARD3 Q:$D(FBERR)
RDMORE	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Item Deleted.  ")_"Want to delete another",DIR("B")="YES" D ^DIR K DIR G RL:Y,DELM
WRITM	S QQ=QQ+1,QQ(QQ)=J_"^"_K_"^"_L_"^"_M D SET^FBAACCB Q
LOOP	F HX=0:0 S HX=$O(QQ(HX)) Q:HX'>0!($D(FBERR))  S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2),L=$P(QQ(HX),"^",3),M=$P(QQ(HX),"^",4) D STUFF^FBAARD3 Q:$D(FBERR)
	W !,"...DONE!" G DELM

FBAARD0
FBAARD0	;AISC/GRR-VOUCHER AUDIT DELETE REJECTS ENTERED IN ERROR CONT. ;01JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
HELPD	W !!,"If you answer 'Yes' to this question, all payment items in this batch",!,"will be flagged as rejected! If you answer 'No', you will be asked if you"
	W !,"want to reject specific line items!"
	Q
DELC	S (QQ,FBAAOUT)=0 W @IOF D HEDC^FBAACCB1 F I=0:0 S I=$O(^FBAAI("AH",B,I)) Q:I'>0!(FBAAOUT)  I $D(^FBAAI(I,0)) S Z(0)=^(0) D WRITC
RL	S ERR=0 S DIR(0)="N^1:"_QQ,DIR("A")="Delete reject flag for which line item" D ^DIR K DIR Q:$D(DIRUT)  S HX=X
	I '$D(QQ(HX)) W !,*7,"You already did that one !!" G RL
ASKSU	S DIR(0)="Y",DIR("A")="Are you sure you want to delete the reject on item number "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RL
	S I=QQ(HX),(FBAAAP,FBAAMT)=+$P(^FBAAI(I,0),"^",9),FBII78=$P($G(^(0)),"^",5),FBMM=$E($P(^(0),U,6),4,5) S FBINVI=I D INPOST^FBAARD3 S I=FBINVI K FBINVI I $D(FBERR) G PROB^FBAARD1
	S $P(^FBAAI(I,0),"^",17)=$P(^FBAAI(I,"FBREJ"),"^",3),^FBAAI("AC",B,I)="",^FBAAI("AE",B,$P(^FBAAI(I,0),"^",4),I)="" K FBMM,^FBAAI("AH",B,I),^FBAAI(I,"FBREJ") S FBAARA=FBAARA+FBAAAP
	S $P(FZ,"^",9)=$P(FZ,"^",9)+FBAAAP,$P(FZ,"^",10)=$P(FZ,"^",10)+1,$P(FZ,"^",11)=$P(FZ,"^",11)+1 I '$D(^FBAAI("AH",B)) S $P(FZ,"^",17)="",^FBAA(161.7,B,0)=FZ W !,"...Done" Q
	S ^FBAA(161.7,B,0)=FZ W !,"...Done"
RDMORE	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Item Deleted.  ")_"Want to delete another",DIR("B")="YES" D ^DIR K DIR G RDMORE:$D(DIRUT),RL:Y
	Q
WRITC	S QQ=QQ+1,QQ(QQ)=I D CMORE^FBAACCB1 Q

FBAARD1
FBAARD1	;AISC/GRR-FEE BASIS VOUCHER AUDIT DELETE REJECT FLAG ;8AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	S DIR(0)="Y",DIR("A")="Are you sure you want to delete reject code for all rejected items in this      batch",DIR("B")="NO" D ^DIR K DIR G Q^FBAARD:$D(DIRUT),RD1^FBAARD:'Y
	D WAIT^DICD,ALLM:FBTYPE="B3",ALLT:FBTYPE="B2",ALLP:FBTYPE="B5",ALLC:FBTYPE="B9"
	G Q^FBAARD:$D(FBERR)
	G RDD^FBAARD
ALLM	S (TM1,TM2)=0
	F J=0:0 S J=$O(^FBAAC("AH",B,J)) Q:J'>0!($D(FBERR))  F K=0:0 S K=$O(^FBAAC("AH",B,J,K)) Q:K'>0!($D(FBERR))  F L=0:0 S L=$O(^FBAAC("AH",B,J,K,L)) Q:L'>0!($D(FBERR))  F M=0:0 S M=$O(^FBAAC("AH",B,J,K,L,M)) Q:M'>0!($D(FBERR))  D REJM Q:$D(FBERR)
	Q:$D(FBERR)
	D INVCNT
ADONE	S $P(FZ,"^",9)=($P(FZ,"^",9)+TM1),$P(FZ,"^",11)=($P(FZ,"^",11)+TM2),$P(FZ,"^",17)="",^FBAA(161.7,B,0)=FZ,FBAARA=TM1
	W !!,"Reject codes for all items have been deleted!" Q
REJM	S FBAAMT=+$P(^FBAAC(J,1,K,1,L,1,M,0),"^",3) D POST^FBAARD3 I $D(FBERR) G PROB
	S $P(^FBAAC(J,1,K,1,L,1,M,0),"^",8)=$P(^FBAAC(J,1,K,1,L,1,M,"FBREJ"),"^",3),^FBAAC("AC",B,J,K,L,M)="" K ^FBAAC("AH",B,J,K,L,M),^FBAAC(J,1,K,1,L,1,M,"FBREJ")
	S TM1=TM1+$P(^FBAAC(J,1,K,1,L,1,M,0),"^",3),TM2=TM2+1
	S FBIN=$P(^FBAAC(J,1,K,1,L,1,M,0),"^",16),^FBAAC("AJ",B,FBIN,J,K,L,M)=""
	Q
ALLT	S (TM1,TM2)=0 F J=0:0 S J=$O(^FBAAC("AG",B,J)) Q:J'>0!($D(FBERR))  F K=0:0 S K=$O(^FBAAC("AG",B,J,K)) Q:K'>0!($D(FBERR))  D REJT Q:$D(FBERR)
	G ADONE
REJT	;SETUP REJECT FIELDS FOR TRAVEL
	S FBAAMT=$P(^FBAAC(J,3,K,0),"^",3) D POST^FBAARD3 I $D(FBERR) G PROB
	S $P(^FBAAC(J,3,K,0),"^",2)=$P(^FBAAC(J,3,K,"FBREJ"),"^",3) K ^FBAAC("AG",B,J,K) S ^FBAAC("AD",B,J,K)="" K ^FBAAC(J,3,K,"FBREJ") S TM1=TM1+$P(^FBAAC(J,3,K,0),"^",3),TM2=TM2+1
	Q
ALLP	S (TM1,TM2)=0 F J=0:0 S J=$O(^FBAA(162.1,"AF",B,J)) Q:J'>0!($D(FBERR))  F K=0:0 S K=$O(^FBAA(162.1,"AF",B,J,K)) Q:K'>0!($D(FBERR))  D REJP Q:$D(FBERR)
	G ADONE
REJP	S FBAAMT=+$P(^FBAA(162.1,J,"RX",K,0),"^",16) D POST^FBAARD3 I $D(FBERR) G PROB
	S $P(^FBAA(162.1,J,"RX",K,0),"^",17)=B,FBPID=$P(^(0),"^",5),TM1=TM1+$P(^(0),"^",16),^FBAA(162.1,"AE",B,J,K)="",^FBAA(162.1,"AJ",B,FBPID,J,K)="",TM2=TM2+1 K ^FBAA(162.1,"AF",B,J,K),^FBAA(162.1,J,"RX",K,"FBREJ")
	Q
ALLC	S (TM1,TM2)=0 F J=0:0 S J=$O(^FBAAI("AH",B,J)) Q:J'>0!($D(FBERR))  I $D(^FBAAI(J,0)) D REJC Q:$D(FBERR)
	S $P(FZ,"^",10)=$P(FZ,"^",10)+TM2 G ADONE
REJC	S FBAAMT=+$P(^FBAAI(J,0),"^",9),FBII78=$P($G(^(0)),"^",5),FBMM=$E($P(^(0),U,6),4,5) D INPOST^FBAARD3 I $D(FBERR) G PROB
	S $P(^FBAAI(J,0),"^",17)=$P(^FBAAI(J,"FBREJ"),"^",3),^FBAAI("AC",B,J)="",^FBAAI("AE",B,$P(^FBAAI(J,0),"^",4),J)="" K FBMM,^FBAAI("AH",B,J),^FBAAI(J,"FBREJ") S TM1=TM1+FBAAMT,TM2=TM2+1 Q
PROB	W !!,*7,"There is a problem with your 1358. Unable to delete reject flag!",! Q
	;
INVCNT	;GET # OF INVOICES IN A BATCH
	N I,CNT
	S (I,CNT)=0
	;FBN=ien of batch in 161.7
	;will go through "AJ" x-ref in 162 to get total invoices in medical
	;batch.
	Q:'$G(FBN)
	F  S I=$O(^FBAAC("AJ",FBN,I)) Q:'I  S CNT=CNT+1
	S $P(FZ,U,10)=CNT
	Q

FBAARD2
FBAARD2	;AISC/GRR-FEE BASIS VOUCHER AUDIT DELETE REJECT CODE FOR AN ITEM ;10AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DELT	;TRAVEL LINE ITEM REJECT
	K QQ
	D GET^FBAAVR2 Q:X="^"!(X="")  I '$D(^FBAAC("AG",B,J)) W !!,*7,"No payments rejected in this batch for that patient!" G DELT
	S (QQ,TM1,TM2)=0 W @IOF D HEDP^FBAACCB0
	F K=0:0 S K=$O(^FBAAC("AG",B,J,K)) Q:K'>0  S QQ=QQ+1,QQ(QQ)=J_"^"_K S Y(0)=^FBAAC(J,3,K,0) D SETT^FBAACCB0
RLT1	S DIR(0)="Y",DIR("A")="Delete Reject flag for all items for this patient",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  G LOOPT:Y
RLT	 S DIR(0)="N^1:"_QQ,DIR("A")="Delete reject for which line item" D ^DIR K DIR Q:$D(DIRUT)  S HX=X
	I '$D(QQ(HX)) W !!,*7,"You just deleted that one!!" G RLT
ASKK	S DIR(0)="Y",DIR("A")="Are you sure you want to delete reject for item number "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RLT
	S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2)
	D STUFFT G RDMORT
STUFFT	D REJT^FBAARD1 S (FBAAMT,FBAAAP)=$P(^FBAAC(J,3,K,0),"^",3) D POST^FBAARD3 I $D(FBERR) G PROB^FBAARD1
	S $P(FZ,"^",9)=($P(FZ,"^",9)+FBAAAP),$P(FZ,"^",11)=($P(FZ,"^",11)+1) K QQ(HX) S FBAARA=FBAARA+FBAAAP
	S $P(^FBAA(161.7,B,0),"^",9)=$P(FZ,"^",9),$P(^(0),"^",11)=$P(FZ,"^",11)
	Q
RDMORT	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Item Deleted.  ")_"Want to delete another",DIR("B")="YES" D ^DIR K DIR G RDMORT:$D(DIRUT),RLT:Y
	I '$D(^FBAAC("AG",B)) S $P(FZ,"^",17)="",$P(^FBAA(161.7,B,0),"^",17)=""
	Q
DELP	;PHARMACY LINE ITEM DELETE REJECT DESIGNATION
RDI	K QQ W !! S DIC="^FBAA(162.1,",DIC(0)="AEQ" D ^DIC Q:X="^"!(X="")  G:Y<0 RDI S A=+Y I '$D(^FBAA(162.1,"AF",B,A)) W !!,*7,"No payments rejected in this batch for that Invoice!" G RDI
	S (QQ,TM1,TM2)=0,FBIN=A W @IOF D SETV^FBAACCB0,HED^FBAACCB
	F B2=0:0 S B2=$O(^FBAA(162.1,"AF",B,A,B2)) Q:B2'>0  S QQ=QQ+1,QQ(QQ)=A_"^"_B2 S Z(0)=^FBAA(162.1,A,"RX",B2,0) D MORE^FBAACCB1
RLP1	S DIR(0)="Y",DIR("A")="Delete Reject code for all items for this patient",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  G LOOPP:Y
RLP	S DIR(0)="N^1:"_QQ,DIR("A")="Delete reject code for which line item" D ^DIR K DIR Q:$D(DIRUT)  S HX=X
	I '$D(QQ(HX)) W !!,*7,"You just deleted that one!!" G RLP
ASKJJ	S DIR(0)="Y",DIR("A")="Are you sure you want to delete reject for item number "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RLP
	S A=$P(QQ(HX),"^",1),B2=$P(QQ(HX),"^",2)
	D STUFFP G RDMORP
STUFFP	S (FBAAAP,FBAAMT)=$P(^FBAA(162.1,A,"RX",B2,0),"^",16) D POST^FBAARD3 I $D(FBERR) G PROB^FBAARD1
	S $P(^FBAA(162.1,A,"RX",B2,0),"^",17)=B,FBPID=$P(^(0),"^",5)
	S FBAARA=FBAARA+FBAAAP,$P(FZ,"^",9)=($P(FZ,"^",9)+$P(^FBAA(162.1,A,"RX",B2,0),"^",16)),$P(FZ,"^",11)=($P(FZ,"^",11)+1),^FBAA(162.1,"AE",B,A,B2)="",^FBAA(162.1,"AJ",B,FBPID,A,B2)="" K ^FBAA(162.1,"AF",B,A,B2),^FBAA(162.1,A,"RX",B2,"FBREJ")
	S $P(^FBAA(161.7,B,0),"^",9)=$P(FZ,"^",9),$P(^(0),"^",11)=$P(FZ,"^",11)
	Q
RDMORP	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Reject code deleted!  ")_"Want to delete another",DIR("B")="YES" D ^DIR K DIR G RDMORP:$D(DIRUT),RLP:Y
	I '$D(^FBAA(162.1,"AF",B)) S $P(FZ,"^",17)="",$P(^FBAA(161.7,B,0),"^",17)=""
	Q
LOOPT	F HX=0:0 S HX=$O(QQ(HX)) Q:HX'>0  S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2) D STUFFT
	W !,"...DONE!"
	I '$D(^FBAAC("AG",B)) S $P(FZ,"^",17)="",$P(FBAA(161.7,B,0),"^",17)=""
	G DELT
LOOPP	F HX=0:0 S HX=$O(QQ(HX)) Q:HX'>0  S A=$P(QQ(HX),"^",1),B2=$P(QQ(HX),"^",2) D STUFFP
	I '$D(^FBAA(162.1,"AF",B)) S $P(FZ,"^",17)="",$P(^FBAA(161.7,B,0),"^",17)=""
	W !,"...DONE!" G DELP

FBAARD3
FBAARD3	;AISC/GRR-VOUCHER AUDIT DELETE REJECTS ENTERED IN ERROR ;08JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
STUFF	S (FBAAMT,FBAAAP)=+$P(^FBAAC(J,1,K,1,L,1,M,0),"^",3) D POST G PROB^FBAARD1:$D(FBERR)
	S $P(^FBAAC(J,1,K,1,L,1,M,0),"^",8)=$P(^FBAAC(J,1,K,1,L,1,M,"FBREJ"),"^",3),FBAARA=FBAARA+FBAAAP,FBIN=$P(^FBAAC(J,1,K,1,L,1,M,0),"^",16)
	S ^FBAAC("AC",B,J,K,L,M)="",^FBAAC("AJ",B,FBIN,J,K,L,M)="" K ^FBAAC("AH",B,J,K,L,M) S $P(FZ,"^",9)=($P(FZ,"^",9)+FBAAAP),$P(FZ,"^",11)=($P(FZ,"^",11)+1)
	K ^FBAAC(J,1,K,1,L,1,M,"FBREJ")
	I '$D(^FBAAC("AH",B)) S $P(FZ,"^",17)=""
	Q
	;
POST	;entry point to put dollars back into an authorization on the 1358
	;if rejected in error
	;first will locate interface ID from PRC(424,"E",IEN of 161.7)
	;if interface not exist use old call to POST^FBAASCB
	;I '$$VER^FBAAUTL1() D POST^FBAASCB Q
	I '$O(^PRC(424,"E",+$G(FBN),0)) D POST^FBAASCB Q
	D ADD^FBAAUTL1 Q
	;
INPOST	;call to put money back into 1358 for inpatient invoices
	;call will handle both v4 and v3.6 of ifcap
	;I $G(FBCNH),'$$VER^FBAAUTL1() D POST^FBAASCB Q
	I FBII78["FB583(" D POST Q
	;find 7078 entry and build variables needed for call
	I '$D(^FB7078(+FBII78,0)) W !,"No 7078 on file for invoice ",J,".  Could not determine 1358.",! S FBERR=1 Q
	S FBI78=$P(^FB7078(+FBII78,0),"^"),DFN=+$P(^(0),"^",3),FBI78=$P(FZ,"^",8)_"-"_$P(FBI78,".")_"-"_$P(FBI78,".",2) D
	.I $D(FBCNH),'$D(^PRC(424,"E",DFN_";"_+FBII78_";"_FBAAON_";"_FBMM)) D POST Q
	.D INPOST^FBAASCB0:$$INTER^FBAASCB0()
	Q

FBAARJP
FBAARJP	;AISC/GRR-PRINT REJECTS PENDING MAS ACTION ;08AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S VAR="",VAL="",PGM="START^FBAARJP"
	D ZIS^FBAAUTL G:FBPOP END
START	U IO W:$E(IOST,1,2)="C-" @IOF K QQ,B S (Q,UL)="",$P(Q,"=",80)="=",$P(UL,"-",80)="-",(FBAAOUT,CNT,FBINTOT)=0
	D MED:$D(^FBAAC("AH")) G END:FBAAOUT D TRAV:$D(^FBAAC("AG")) G END:FBAAOUT D PHARM:$D(^FBAA(162.1,"AF")) G END:FBAAOUT D CHNH:$D(^FBAAI("AH")) G END:FBAAOUT
	I 'CNT W !!,*7,"No Rejects Pending!"
END	K FBTYPE,FBVDUZ,FBVD,FBPV,CNT,D,I,PGM,Q,UL,VAL,VAR,Y,Z,A1,A2,A3,B,FBAACPT,FBIN,FBNUM,FBRR,FBINTOT,CPTDESC,FBAAOUT,FBVP,J,K,T,X,L,M,N,S,V,VID,XY,ZS,POP,A,B2,FBINOLD
	K FBAC,FBAP,FBDX,FBK,FBL,FBPDT,FBPROC,FBSC,FBTD,FBFD
	D CLOSE^FBAAUTL Q
MED	F B=0:0 S B=$O(^FBAAC("AH",B)) Q:B'>0!(FBAAOUT)  I $D(^FBAA(161.7,B,0)),^("ST")="V" S B(0)=^(0),FBTYPE=$P(B(0),"^",3),FBNUM=$P(B(0),"^",1),FBVD=$P(B(0),"^",12),FBVDUZ=$P(B(0),"^",16) D MORE
	Q
MORE	D HED,HED^FBAACCB,HEDB
	F J=0:0 S J=$O(^FBAAC("AH",B,J)) Q:J'>0!(FBAAOUT)  F K=0:0 S K=$O(^FBAAC("AH",B,J,K)) Q:K'>0!(FBAAOUT)  F L=0:0 S L=$O(^FBAAC("AH",B,J,K,L)) Q:L'>0!(FBAAOUT)  F M=0:0 S M=$O(^FBAAC("AH",B,J,K,L,M)) Q:M'>0!(FBAAOUT)  D SET^FBAACCB,WRITM
	Q:FBAAOUT  W !,UL,! D ASKH^FBAACCB0:$E(IOST,1,2)["C-"&('$G(FBNNP)) Q:FBAAOUT  W:'$G(FBNNP) @IOF
	Q
HEDB	W !,"Batch Number: ",FBNUM,?21,"Voucher Date: ",$$DATX^FBAAUTL(FBVD),?44,"Voucherer: ",$S(FBVDUZ="":"",$D(^VA(200,FBVDUZ,0)):$P(^(0),"^",1),1:"Unknown"),!
	Q
WRITM	Q:FBAAOUT  S CNT=CNT+1,FBRR=$P(^FBAAC(J,1,K,1,L,1,M,"FBREJ"),"^",2) W !,?7,"Reject Reason: ",FBRR,!,?7,"Old Batch #: ",$S($D(^FBAA(161.7,+$P(^("FBREJ"),"^",3),0)):$P(^(0),"^"),1:"") Q
TRAV	F B=0:0 S B=$O(^FBAAC("AG",B)) Q:B'>0!(FBAAOUT)  I $D(^FBAA(161.7,B,0)),^("ST")="V" S B(0)=^(0),FBTYPE=$P(B(0),"^",3),FBNUM=$P(B(0),"^",1),FBVD=$P(B(0),"^",12),FBVDUZ=$P(B(0),"^",16) D TMORE
	Q
TMORE	D HED,HEDP^FBAACCB0,HEDB
	F J=0:0 S J=$O(^FBAAC("AG",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AG",B,J,K)) Q:K'>0  S Y(0)=^FBAAC(J,3,K,0) D SETT^FBAACCB0,WRITT
	Q:FBAAOUT  W !,UL,! D ASKH^FBAACCB0:$E(IOST,1,2)["C-"&('$G(FBNNP)) Q:FBAAOUT  W:'$G(FBNNP) @IOF
	Q
WRITT	S CNT=CNT+1,FBRR=$P(^FBAAC(J,3,K,"FBREJ"),"^",2) W !,?7,"Reject Reason: ",FBRR Q
PHARM	F B=0:0 S B=$O(^FBAA(162.1,"AF",B)) Q:B'>0!(FBAAOUT)  I $D(^FBAA(161.7,B,0)),^("ST")="V" S B(0)=^(0),FBTYPE=$P(B(0),"^",3),FBNUM=$P(B(0),"^",1),FBVD=$P(B(0),"^",12),FBVDUZ=$P(B(0),"^",16) D PMORE
	Q
PMORE	D HED,HED^FBAACCB,HEDB
	F A=0:0 S A=$O(^FBAA(162.1,"AF",B,A)) Q:A'>0!(FBAAOUT)  S FBIN=A D SETV^FBAACCB0 F B2=0:0 S B2=$O(^FBAA(162.1,"AF",B,A,B2)) Q:B2'>0!(FBAAOUT)  I $D(^FBAA(162.1,A,"RX",B2,0)) S Z(0)=^(0) D MORE^FBAACCB1,WRITP
	Q:FBAAOUT  W !,UL,! D ASKH^FBAACCB0:$E(IOST,1,2)="C-"&('$G(FBNNP)) Q:FBAAOUT  W:'$G(FBNNP) @IOF
	Q
WRITP	S CNT=CNT+1,FBRR=$P(^FBAA(162.1,A,"RX",B2,"FBREJ"),"^",2) W !,?7,"Reject Reason: ",FBRR,!,?7,"Old Batch #: ",$S($D(^FBAA(161.7,$P(^("FBREJ"),"^",3),0)):$P(^(0),"^"),1:"") Q
CHNH	F B=0:0 S B=$O(^FBAAI("AH",B)) Q:B'>0!(FBAAOUT)  I $D(^FBAA(161.7,B,0)),^("ST")="V" S B(0)=^(0),FBTYPE=$P(B(0),"^",3),FBNUM=$P(B(0),"^",1),FBVD=$P(B(0),"^",12),FBVDUZ=$P(B(0),"^",16) D CMORE
	Q
CMORE	D HED,HEDC^FBAACCB1,HEDB
	F I=0:0 S I=$O(^FBAAI("AH",B,I)) Q:I'>0!(FBAAOUT)  I $D(^FBAAI(I,0)) S Z(0)=^(0) D CMORE^FBAACCB1,WRITC
	Q:FBAAOUT  W !,UL,! D ASKH^FBAACCB0:$E(IOST,1,2)="C-"&('$G(FBNNP)) Q:FBAAOUT  W:'$G(FBNNP) @IOF
	Q
WRITC	Q:FBAAOUT  S CNT=CNT+1,FBRR=$P(^FBAAI(I,"FBREJ"),"^",2) W !,?7,"Reject Reason: ",FBRR,!,?7,"Old Batch #: ",$S($D(^FBAA(161.7,$P(^("FBREJ"),"^",3),0)):$P(^(0),"^"),1:"") Q
	;
HED	;write header for report if sent to printer
	Q:$E(IOST,1,2)="C-"
	W !?31,"REJECTS PENDING ACTION",!?30,$E(Q,1,24),!
	Q

FBAARMRA
FBAARMRA	;AISC/DMK-RETRANSMIT MRS's FOR A DATE ;25OCT89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASK	W !! S %DT("A")="Re-transmit MRA's for which date: ",%DT="AEXP",%DT(0)=-DT D ^%DT K %DT(0),%DT("A") G END:X="^"!(X=""),ASK:Y<0 S FBAATD=Y
	I '$D(^FBAA(161.25,"AD",FBAATD)),'$D(^FBAA(161.26,"AD",FBAATD)) W !!,*7,"No MRA's were transmitted on that date!" G ASK
	D VEND:$D(^FBAA(161.25,"AD",FBAATD)),VET:$D(^FBAA(161.26,"AD",FBAATD))
	D RTRAN^FBAAV0
END	K D0,FBAATD,OCTD,J,K,XCNP,VAT Q
VEND	F J="O","P" F K=0:0 S K=$O(^FBAA(161.25,"AD",FBAATD,J,K)) Q:K'>0  I $D(^FBAA(161.25,K)) S $P(^(K,0),"^",5)="",^FBAA(161.25,"AE",J,K)="" K ^FBAA(161.25,"AD",FBAATD,J,K)
	Q
VET	W !!,?20,"Re-Transmitting",! F K=0:0 S K=$O(^FBAA(161.26,"AD",FBAATD,K)) Q:K'>0  I $D(^FBAA(161.26,K)) S $P(^(K,0),"^",5)="",$P(^(0),"^",2)="P",^FBAA(161.26,"AC","P",K)="" K ^FBAA(161.26,"AD",FBAATD,K),^FBAA(161.26,"AC","T",K)
	Q

FBAAROC
FBAAROC	;AISC/GRR-ENTER/EDIT REPORT OF CONTACT ;06JUL86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
2	W !! S DIC="^DPT(",DIC(0)="QEAZM" D ^DIC G Q:Y<0!(X="")!(X="^") S FBDA=+Y
ENT	;
	I '$D(^FBAAA(FBDA)) K DD,DO S DIC="^FBAAA(",DIC(0)="LQ",DLAYGO=161,(X,DINUM)=FBDA D FILE^DICN S FBDA=+Y
	I '$D(^FBAAA(FBDA,2,0)) S ^FBAAA(FBDA,2,0)="^161.02D^^"
	S DA=FBDA
	I $D(DA) S DIE="^FBAAA(",DR="[FBAA REPORT OF CONTACT]" D ^DIE G 2:'$D(FBD1),2:$D(Y)'=0
	I '$D(^FBAAA(FBDA,2,FBD1,0)) K DIE,DR G 2
	D SITEP^FBAAUTL G:FBPOP Q S SITE=$P(FBSITE(0),"^",1),ROC=FBD1,DFN=FBDA
PRINT	S DIR(0)="Y",DIR("A")="Want to print this Report of Contact",DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y 2
	S VAR="DFN^ROC^SITE",VAL=DFN_"^"_ROC_"^"_SITE,PGM="START^FBAAPRC" D ZIS^FBAAUTL G 2:FBPOP
	D START^FBAAPRC G 2
Q	K DAT,FBDA,FBD1,D0,D1,DA,DFN,DI,DIC,DIE,DIRUT,DR,DQ,DWLW,J,X,Y,F,FBCOUNTY,FBDX,I,PGM,PI,T,VAL,VAR,Z,ZZ,ROC,SITE,DFN,FBSITE,FBDAT
	D CLOSE^FBAAUTL Q

FBAARP
FBAARP	;AISC/GRR-FEE BASIS REIMBURSEMENT PAYMENT ;22APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBAAPTC="R",FBINTOT=0 G ^FBAACO

FBAARR
FBAARR	;AISC/GRR-RE-INITIATE REJECTED LINE ITEMS ;13AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
	S Q="",$P(Q,"=",80)="=",UL="",$P(UL,"-",80)="-",(FBAAOUT,CNT,FBINTOT)=0
	D DT^DICRW
BT	K QQ W !!
	S DIC="^FBAA(161.7,",DIC(0)="AEQMN",DIC("A")="Select Batch with Rejects: ",DIC("S")="I $G(^(""ST""))=""V""&($P(^(0),U,17)]"""")" D ^DIC K DIC("S"),DIC("A") G Q:X="^"!(X=""),BT:Y<0 S FBN=+Y,B=FBN,FZ=^FBAA(161.7,FBN,0),FBTYPE=$P(FZ,"^",3)
	S FBOB=$P(FZ,"^",2),FBEXMPT=$S($P(FZ,"^",18)]"":$P(FZ,"^",18),1:"N")
	I '$S(FBTYPE="B3":$D(^FBAAC("AH",B)),FBTYPE="B2":$D(^FBAAC("AG",B)),FBTYPE="B5":$D(^FBAA(162.1,"AF",B)),FBTYPE="B9":$D(^FBAAI("AH",B)),1:0) W !!,*7,"No items rejected in this batch!" D  G BT
	.S $P(^FBAA(161.7,B,0),U,17)=""
	I FBTYPE="B9",$P(FZ,"^",15)="Y" D NEWBT^FBAARR0 G ASKLL
BTN	W !! S DIC("A")="Select New Batch number: ",DIC("S")="I $P(^(0),U,3)=FBTYPE&($P(^(0),U,5)=DUZ)&($G(^(""ST""))=""O"")" D ^DIC K DIC("A"),DIC("S") G BT:X=""!(X="^"),HELP^FBAARR0:X["?",BTN:Y<0 S FBNB=+Y
	D BATCNT^FBAARR1 I '$D(FBNB) D KILL^FBAARR1 G BT
	S FBNUM=$P(^FBAA(161.7,B,0),"^",1),FBVD=$P(^(0),"^",12),FBVDUZ=$P(^(0),"^",16),FBNOB=$P(^FBAA(161.7,FBNB,0),"^",2) G:FBNOB'=FBOB CHKOB^FBAARR0
ASKLL	S B=FBN,FBNNP=1 S DIR(0)="Y",DIR("A")="Want line items listed",DIR("B")="NO" D ^DIR K DIR W:Y @IOF D:Y MORE^FBAARJP:FBTYPE="B3",PMORE^FBAARJP:FBTYPE="B5",TMORE^FBAARJP:FBTYPE="B2",CMORE^FBAARJP:FBTYPE="B9" K FBNNP
RD0	S DIR(0)="Y",DIR("A")="Want to re-initiate all rejected items in the Batch",DIR("B")="NO",DIR("?")="'Yes' will re-initiate all rejected payment items for this batch, 'No' will prompt for re-initiation of specific line items"
	D ^DIR K DIR G:Y ^FBAARR1
RD1	S DIR(0)="Y",DIR("A")="Want to re-initiate any line items",DIR("B")="NO" D ^DIR K DIR Q:$D(DIRUT)!'Y  D DELT^FBAARR2:FBTYPE="B2",DELM:FBTYPE="B3",DELP^FBAARR2:FBTYPE="B5",DELC^FBAARR0:FBTYPE="B9"
RDD	;
FIN	S $P(FZ,"^",12)=DT,$P(FZ,"^",16)=DUZ,^FBAA(161.7,FBN,0)=FZ,^FBAA(161.7,FBN,"ST")="V",^FBAA(161.7,"AC","V",FBN)="",^FBAA(161.7,"AF",DT,FBN)="" K ^FBAA(161.7,"AC","T",FBN)
	S DIC="^FBAA(161.7,",DA=FBN,DR="0;ST" W !! D EN^DIQ G BT
Q	D KILL^FBAARR1
	Q
GET	W !! S DIC="^FBAAA(",DIC(0)="AEQ" D ^DIC G RDD:X="^"!(X=""),GET:Y<0 S DA=+Y,J=DA Q
DELM	K QQ W !! S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),DELM:Y<0 S DA=+Y,J=DA I '$D(^FBAAC("AH",B,J)) W !!,*7,"No payments in this batch for that patient!" G DELM
	S QQ=0 W @IOF D HED^FBAACCB
	F K=0:0 S K=$O(^FBAAC("AH",B,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AH",B,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AH",B,J,K,L,M)) Q:M'>0  D WRITM
RL	S ERR=0 S DIR(0)="N^1:"_QQ,DIR("A")="Re-initiate which line item" D ^DIR K DIR G:$D(DIRUT) END S HX=X
	I '$D(QQ(HX)) W !,*7,"You already did that one!!" G RL
ASKSU	S DIR(0)="Y",DIR("A")="Are you sure you want to re-initiate line item number "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RL
	S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2),L=$P(QQ(HX),"^",3),M=$P(QQ(HX),"^",4)
STUFF	I $P(^FBAAC(J,1,K,1,L,1,M,0),"^",21)="VP" S FBIN=+$P(^(0),"^",16) D VOID^FBAARR1 Q
	S $P(^FBAAC(J,1,K,1,L,1,M,0),"^",8)=FBNB,FBAAAP=+$P(^(0),"^",3),FBIN=+$P(^(0),"^",16)
	S ^FBAAC("AC",FBNB,J,K,L,M)="",^FBAAC("AJ",FBNB,FBIN,J,K,L,M)="" K ^FBAAC("AH",B,J,K,L,M)
	S $P(^FBAA(161.7,FBNB,0),"^",9)=($P(^FBAA(161.7,FBNB,0),"^",9)+FBAAAP),$P(^(0),"^",11)=($P(^(0),"^",11)+1) K ^FBAAC(J,1,K,1,L,1,M,"FBREJ")
ASKRI	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Item Re-initiated.  ")_"Want to re-initiate another",DIR("B")="YES" D ^DIR K DIR G ASKRI:$D(DIRUT),DELM:Y,END
WRITM	S QQ=QQ+1,QQ(QQ)=J_"^"_K_"^"_L_"^"_M D SET^FBAACCB Q
END	I '$D(^FBAAC("AH",B)) S $P(^FBAA(161.7,B,0),"^",17)=""
	Q

FBAARR0
FBAARR0	;AISC/GRR-REINITIATE BATCH CONTINUED ;26MAY88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
HELP	W !!,"Enter the batch number to which the rejected items you re-initiate will",!,"be assigned to. It must be an open batch and assigned to you." G BTN^FBAARR
CHKOB	W !!,*7,"The obligation number from the batch with rejects",!,"is not the same as the new batch selected !"
	S DIR(0)="Y",DIR("A")="Do you want to continue",DIR("B")="NO" D ^DIR K DIR G BT^FBAARR:$D(DIRUT)!'Y,ASKLL^FBAARR:Y
	Q
DELC	S (QQ,FBAAOUT)=0 W @IOF D HEDC^FBAACCB1
	F I=0:0 S I=$O(^FBAAI("AH",B,I)) Q:I'>0!(FBAAOUT)  I $D(^FBAAI(I,0)) S Z(0)=^(0) D WRITC
RL	S ERR=0 S DIR(0)="N^1:"_QQ,DIR("A")="Re-Initiate which line item" D ^DIR K DIR G:$D(DIRUT) END^FBAARR S HX=X
	I '$D(QQ(HX)) W !,*7,"You already did that one !!" G RL
ASKSU	S DIR(0)="Y",DIR("A")="Are you sure you want to re-initiate line item number:  "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RL
	S I=QQ(HX) I $P(^FBAAI(I,0),"^",14)="VP" S FBIN=I D VOID^FBAARR1 Q
	S $P(^FBAAI(I,0),"^",17)=FBNB,FBAAAP=+$P(^(0),"^",9),^FBAAI("AC",FBNB,I)="",^FBAAI("AE",FBNB,$P(^FBAAI(I,0),"^",4),I)="" K ^FBAAI("AH",B,I)
	S FZ(0)=^FBAA(161.7,FBNB,0),$P(FZ(0),"^",9)=$P(FZ(0),"^",9)+FBAAAP,$P(FZ(0),"^",10)=$P(FZ(0),"^",10)+1,$P(FZ(0),"^",11)=$P(FZ(0),"^",11)+1,^FBAA(161.7,FBNB,0)=FZ(0) K ^FBAAI(I,"FBREJ")
ASKRI	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Item Re-initiated.  ")_"Want to re-initiate another",DIR("B")="YES" D ^DIR K DIR G ASKRI:$D(DIRUT),DELC:Y
FIN	I '$D(^FBAAI("AH",FBN)) S $P(^FBAA(161.7,FBN,0),"^",17)=""
	Q
WRITC	S QQ=QQ+1,QQ(QQ)=I D CMORE^FBAACCB1 Q
	;
NEWBT	S FBSTN=$P(FZ,"^",8),FBDCB=$P(FZ,"^",13)
	W ! D GETNXB^FBAAUTL W !!,*7,"New Batch for Rejects is: ",FBBN
	S DLAYGO=161.7,X=FBBN,DIC(0)="LQ",DIC("DR")="1////^S X=FBOB;2////^S X=""B9"";3////^S X=DT;4////^S X=DUZ;4.5////^S X=FBDCB;11////^S X=$S(FBEXMPT[""Y"":""O"",1:""A"");16////^S X=FBSTN;17////^S X=""Y"";18////^S X=FBEXMPT"
	K DD,DO D FILE^DICN K DIC S FBNB=+Y
	S FBNUM=$P(FZ,"^",1),FBVD=$P(FZ,"^",12),FBVDUZ=$P(FZ,"^",16),FBNOB=FBOB
	Q

FBAARR1
FBAARR1	;AISC/GRR-FEE BASIS RE-INITIATE ENTIRE BATCH ;8AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD	S DIR(0)="Y",DIR("A")="Are you sure you want to re-initiate all line items in this batch",DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RD1^FBAARR
	S FZ=^FBAA(161.7,FBNB,0) D WAIT^DICD,ALLM:FBTYPE="B3",ALLT:FBTYPE="B2",ALLP:FBTYPE="B5",ALLC:FBTYPE="B9"
	K FBRJV G BT^FBAARR
ALLM	S (TM1,TM2)=0 F J=0:0 S J=$O(^FBAAC("AH",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AH",B,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AH",B,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AH",B,J,K,L,M)) Q:M'>0  D REJM
ADONE	S $P(FZ,"^",9)=($P(FZ,"^",9)+TM1),$P(FZ,"^",11)=($P(FZ,"^",11)+TM2),^FBAA(161.7,FBNB,0)=FZ I '$G(FBRJV) S $P(^FBAA(161.7,B,0),"^",17)="" W !!,"All rejected items have been re-initiated!" Q
	I $G(FBRJV) W !!,"All rejected items (except for voided payments) have been re-initiated!" Q
REJM	I $P(^FBAAC(J,1,K,1,L,1,M,0),"^",21)="VP" S FBIN=+$P(^(0),"^",16) D VOID S FBRJV=1 Q
	S $P(^FBAAC(J,1,K,1,L,1,M,0),"^",8)=FBNB,FBIN=+$P(^(0),"^",16),^FBAAC("AC",FBNB,J,K,L,M)="" K ^FBAAC("AH",B,J,K,L,M),^FBAAC(J,1,K,1,L,1,M,"FBREJ")
	S TM1=TM1+$P(^FBAAC(J,1,K,1,L,1,M,0),"^",3),TM2=TM2+1
	S ^FBAAC("AJ",FBNB,FBIN,J,K,L,M)="" Q
ALLT	S (TM1,TM2)=0 F J=0:0 S J=$O(^FBAAC("AG",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AG",B,J,K)) Q:K'>0  D REJT
	G ADONE
REJT	;SETUP REJECT FIELDS FOR TRAVEL
	S $P(^FBAAC(J,3,K,0),"^",2)=FBNB K ^FBAAC("AG",B,J,K) S ^FBAAC("AD",FBNB,J,K)="" K ^FBAAC(J,3,K,"FBREJ") S TM1=TM1+$P(^FBAAC(J,3,K,0),"^",3),TM2=TM2+1
	Q
ALLP	S (TM1,TM2)=0 F J=0:0 S J=$O(^FBAA(162.1,"AF",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAA(162.1,"AF",B,J,K)) Q:K'>0  D REJP
	G ADONE
REJP	I $P($G(^FBAA(162.1,J,"RX",K,2)),"^",3)="V" S FBIN=J D VOID S FBRJV=1 Q
	S FBPID=$P(^FBAA(162.1,J,"RX",K,0),"^",5),$P(^(0),"^",17)=FBNB,TM1=TM1+$P(^(0),"^",16),^FBAA(162.1,"AE",FBNB,J,K)="",^FBAA(162.1,"AJ",FBNB,FBPID,J,K)="",TM2=TM2+1 K ^FBAA(162.1,"AF",B,J,K),^FBAA(162.1,J,"RX",K,"FBREJ")
	Q
ALLC	S (TM1,TM2,TM3)=0 F J=0:0 S J=$O(^FBAAI("AH",B,J)) Q:J'>0  I $D(^FBAAI(J,0)) D REJC
	S $P(FZ,"^",10)=$P(FZ,"^",10)+TM3 G ADONE
REJC	I $P(^FBAAI(J,0),"^",14)="VP" S FBIN=J D VOID S FBRJV=1 Q
	S $P(^FBAAI(J,0),"^",17)=FBNB,$P(^(0),"^",16)="",^FBAAI("AC",FBNB,J)="",^FBAAI("AE",FBNB,$P(^FBAAI(J,0),"^",4),J)="" K ^FBAAI("AH",B,J),^FBAAI(J,"FBREJ") S TM1=TM1+$P(^FBAAI(J,0),"^",9),TM2=TM2+1,TM3=TM3+1 Q
	Q
KILL	K A,A1,A2,B,CPTDESC,D0,DA,FBAACPT,FBAAOUT,FBVP,J,K,L,M,X,Y,Z,DIC,ERR,FBIN,FBNB,FBNUM,FBPV,FBRR,FBTYPE,FBVD,FBVDUZ,FZ,I,POP,DR,IOP,V,VID,ZS,FBN,FBOB,FBNOB,CNT,Q,UL,VAL,FBINTOT,PRCS,PRCSI,FBFDC,FBMST,FBTTYPE,FBSTN,FBDCB,FBBN
	K FBAAAP,FBAC,FBAP,FBDX,FBFD,FBK,FBL,FBPDT,FBPROC,FBSC,FBINOLD,FBTD,TM1,TM2,TM3,N,S,FBCNT,FBNBCNT,I,DIRUT,FBEXMPT
	Q
BATCNT	;GET NUMBER OF REJECTS IN OLD BATCH
	S:'$D(FBAAMPI) FBAAMPI=$S($D(^FBAA(161.4,1,"FBNUM")):$P(^("FBNUM"),"^",3),1:100),FBAAMPI=$S(FBAAMPI]"":FBAAMPI,1:100)
	Q:'$D(FBN)  S FBCNT=0
	F I=0:0 S I=$O(^FBAAC("AH",FBN,I)) Q:'I  F J=0:0 S J=$O(^FBAAC("AH",FBN,I,J)) Q:'J  F K=0:0 S K=$O(^FBAAC("AH",FBN,I,J,K)) Q:'K  F L=0:0 S L=$O(^FBAAC("AH",FBN,I,J,K,L)) Q:'L  I $D(^FBAAC(I,1,J,1,K,1,L,"FBREJ")) S FBCNT=FBCNT+1
	Q:'$D(FBNB)
	S FBNBCT=$S($D(^FBAA(161.7,FBNB,0)):(FBAAMPI-$P(^(0),"^",11)),1:0)
	I FBCNT>FBNBCT W !!,*7,"New Batch selected does not have enough room to fit the",!,FBCNT," rejects pending from batch ",$P(FZ,"^")," !",!! K FBNB Q
	Q
VOID	W !!,*7,"Invoice #: ",FBIN," has a status of VOID.  Please delete the VOID",!,"before re-initiating this rejected payment."
	Q

FBAARR2
FBAARR2	;AISC/GRR-RE-INITIATE REJECTED LINE ITEMS ;13AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DELT	;TRAVEL LINE ITEM RE-INITIATE
	K QQ
	D GET^FBAAVR2 I '$D(^FBAAC("AG",B,J)) W !!,*7,"No payments rejected in this batch for that patient!" G DELT
	S (QQ,TM1,TM2)=0 W @IOF D HEDP^FBAACCB0
	F K=0:0 S K=$O(^FBAAC("AG",B,J,K)) Q:K'>0  S QQ=QQ+1,QQ(QQ)=J_"^"_K S Y(0)=^FBAAC(J,3,K,0) D SETT^FBAACCB0
RLT	S DIR(0)="N^1:"_QQ,DIR("A")="Re-initiate which line item" D ^DIR K DIR G:$D(DIRUT) ENDT S HX=X
	I '$D(QQ(HX)) W !!,*7,"You just did that one!!" G RLT
RIN	S DIR(0)="Y",DIR("A")="Are you sure you want to re-initiate line item number: "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RLT
	S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2)
	D REJT^FBAARR1 S FBAAAP=$P(^FBAAC(J,3,K,0),"^",3),$P(^FBAA(161.7,FBNB,0),"^",9)=($P(^FBAA(161.7,FBNB,0),"^",9)+FBAAAP),$P(^(0),"^",11)=($P(^(0),"^",11)+1) K QQ(HX)
RASK	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Line Re-initiated.  ")_"Want to re-initiate another",DIR("B")="YES" D ^DIR K DIR G RASK:$D(DIRUT),ENDT:'Y,DELT:Y
ENDT	I '$D(^FBAAC("AG",B)) S $P(^FBAA(161.7,B,0),"^",17)=""
	Q
DELP	;PHARMACY LINE ITEM RE-INITIATE
RDI	K QQ W !! S DIC="^FBAA(162.1,",DIC(0)="AEQ" D ^DIC Q:X="^"!(X="")  G:Y<0 RDI S A=+Y I '$D(^FBAA(162.1,"AF",B,A)) W !!,*7,"No payments rejected in this batch for that Invoice!" G RDI
	S (QQ,TM1,TM2)=0,FBIN=A W @IOF D SETV^FBAACCB0,HED^FBAACCB
	F B2=0:0 S B2=$O(^FBAA(162.1,"AF",B,A,B2)) Q:B2'>0  S QQ=QQ+1,QQ(QQ)=A_"^"_B2 S Z(0)=^FBAA(162.1,A,"RX",B2,0) D MORE^FBAACCB1
RLP	S DIR(0)="N^1:"_QQ,DIR("A")="Re-initiate which line item" D ^DIR K DIR G:$D(DIRUT) ENDP S HX=X
	I '$D(QQ(HX)) W !!,*7,"You just did that one!!" G RLP
PRIN	S DIR(0)="Y",DIR("A")="Are you sure you want to re-initiate item number: "_HX,DIR("B")="NO" D ^DIR K DIR G:$D(DIRUT)!'Y RLP
	S A=$P(QQ(HX),"^",1),B2=$P(QQ(HX),"^",2)
	I $P($G(^FBAA(162.1,A,"RX",B2,2)),"^",3)="V" S FBIN=A D VOID^FBAARR1 Q
	S FBPID=$P(^FBAA(162.1,A,"RX",B2,0),"^",5),$P(^(0),"^",17)=FBNB,FBAAAP=$P(^(0),"^",16),^FBAA(162.1,"AE",FBNB,A,B2)="",^FBAA(162.1,"AJ",FBNB,FBPID,A,B2)="" K ^FBAA(162.1,"AF",B,A,B2),^FBAA(162.1,A,"RX",B2,"FBREJ")
	S $P(^FBAA(161.7,FBNB,0),"^",9)=($P(^FBAA(161.7,FBNB,0),"^",9)+FBAAAP),$P(^(0),"^",11)=($P(^(0),"^",11)+1)
PASK	S DIR(0)="Y",DIR("A")=$S($G(FBERR):"",1:"Reject code deleted.  ")_"Want to delete another",DIR("B")="YES" D ^DIR K DIR G PASK:$D(DIRUT),DELP:Y,ENDP
ENDP	I '$D(^FBAA(162.1,"AF",B)) S $P(^FBAA(161.7,B,0),"^",17)=""
	Q

FBAARV
FBAARV	;AISC/CMR-FLAG VENDOR FOR REINSTATE IN CENTRAL FEE ;2/4/94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;this routine calls into the update routine, since the reinstate and update options now perform the same function
	G ^FBAAAV

FBAAS79
FBAAS79	;AISC/GRR-PRINT SINGLE 7079 ;07OCT86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D:'$D(FBSITE(0)) SITEP^FBAAUTL S FBPROG=$S($P(FBSITE(1),"^",6)="":"I 1",1:"I $P(^(0),""^"",3)=2")
1	D GETVET^FBAAUTL1 G Q:'DFN
	D GETAUTH^FBAAUTL1 G 1:FTP']""
	S FBK=+FTP
EN1	;ENTRY POINT FROM AUTHORIZATION OPTION (FBAAAUT)
	Q:'$D(^FBAAA(DFN,1,FBK,0))  S FBZZ(0)=^(0),J=$P(FBZZ(0),"^",13)
	S J=$S(J=1:$P(FBZZ(0),"^"),J=2:$P(FBZZ(0),"^"),J=3:$S($D(^FBAAA(DFN,4)):$P(^(4),"^",2),1:$P(FBZZ(0),"^")),1:$P(FBZZ(0),"^")) K FBZZ
	D OUTPUT
2	S FBJ=DT,VAR="DFN^FBK^FBJ",VAL=DFN_"^"_FBJ_"^"_FBK,PGM="START^FBAAS79",IOP="Q" D ZIS^FBAAUTL G Q:FBPOP
	;
START	D SITEP^FBAAUTL S UL="",$P(UL,"-",120)="-",FBPG=0 U IO D GOT^FBAA79
	;
Q	D END^FBAA79,CLOSE^FBAAUTL Q
OUTPUT	;
	W !!?8,"This report produces a 132 character output.",! Q

FBAASAP
FBAASAP	;AISC/DMK-GET VET AND AUTHORIZATION FOR PHARMACY ;21MAY92
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
1	I '$D(FB583) W ! K DFN D GETVET^FBAAUTL1 Q:'DFN  S:'$D(FBPROG) FBPROG="I $P(^(0),U,9)'[""FB583""" D GETAUTH^FBAAUTL1 G 1:FTP']""
	D:FBAAPTC="R" ^FBAACO0
	S FB7078=$S(FB7078:FB7078_";FB7078(",$D(FB583):FB583_";FB583(",1:"")
	Q
Q	K FBAAPTC,DIC,CNT,Y,X,I,DIC,D0,DFN,F Q

FBAASCB
FBAASCB	;AISC/GRR-SUPERVISOR RELEASE ;01JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBERR=0 D DT^DICRW
	I '$D(^FBAA(161.7,"AC","C"))&('$D(^FBAA(161.7,"AC","A"))) W !!,*7,"There are no batches Pending Release!" Q
BT	W !! S DIC="^FBAA(161.7,",DIC(0)="AEQ",DIC("S")="I ($G(^(""ST""))=""C""!($G(^(""ST""))=""A""))&('$G(^XTMP(""FBAASCB"",+Y)))" D ^DIC K DIC("S") G Q:X="^"!(X=""),BT:Y<0 S FBN=+Y,^XTMP("FBAASCB",FBN)=1
	D LOCK^FBUCUTL("^FBAA(161.7,",FBN) I 'FBLOCK W !!,*7,"Try releasing batch at another time." D Q G FBAASCB
	S FZ=^FBAA(161.7,FBN,0),FBTYPE=$P(FZ,"^",3),FBAAON=$P(FZ,"^",2),FBAAB=$P(FZ,"^")
	I $G(FBTYPE)="B9",$P(FZ,"^",15)="Y",$P(^FBAA(161.7,FBN,"ST"),"^")="C",$P(FZ,"^",18)'="Y" W !!,*7,"Batch needs to be released to Pricer first.",! G Q
	I $G(FBTYPE)="B9",$P(FZ,"^",15)="" S FBCNH=1
	S FBSTAT=^FBAA(161.7,FBN,"ST"),FBSTAT=$S(FBSTAT="C":"S",FBSTAT="A":"R",1:FBSTAT)
	S FBAAOB=$P(FZ,"^",8)_"-"_FBAAON,FBAAMT=$P(FZ,"^",9),FBCOMM="Release of batch "_FBAAB
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !!,*7,"Sorry, only Supervisor can Release batch!" D Q G FBAASCB
	S DA=FBN,DR="0;ST" W !! D EN^DIQ
RD	S B=FBN S DIR(0)="Y",DIR("A")="Want line items listed",DIR("B")="NO" D ^DIR K DIR G Q:$D(DIRUT) W:Y @IOF D:Y LIST^FBAACCB:FBTYPE="B3",LISTP^FBAACCB:FBTYPE="B5",LISTT^FBAACCB0:FBTYPE="B2",LISTC^FBAACCB1:FBTYPE="B9"
RDD	S DIR(0)="Y",DIR("A")="Do you want to Release Batch as Correct",DIR("B")="NO" D ^DIR K DIR G Q:$D(DIRUT) I 'Y W !!,"Batch has NOT been Released!",*7 D Q G FBAASCB
	D WAIT^DICD I FBTYPE="B9" D ^FBAASCB0 G SHORT:$D(FBERR),FIN
	D POST I $D(FBERR) G SHORT
	G:FBTYPE="B5" FIN
	G:FBTYPE="B9" FIN
FIN	S $P(FZ,"^",6)=DT,$P(FZ,"^",7)=DUZ,^FBAA(161.7,FBN,0)=FZ
	S DA=FBN,(DIC,DIE)="^FBAA(161.7,",DIC(0)="LQ",DR="11////"_FBSTAT,DLAYGO=161.7 D ^DIE K DA,DIE,DIC,DR,DLAYGO
	S DA=FBN,DR="0;ST",DIC="^FBAA(161.7," W !! D EN^DIQ W !!," Batch has been Released!" D Q G FBAASCB
Q	I $G(FBN) K ^XTMP("FBAASCB",FBN) L -^FBAA(161.7,FBN)
	K B,J,K,L,M,X,Y,Z,DIC,FBN,A,A1,A2,BE,CPTDESC,D0,DA,DL,DR,DRX,DX,FBAACB,FBAACPT,FBAAON,FBAAOUT,FBVP,FBIN,DK,N,XY,FBINOLD,FBINTOT,FBTYPE,FZ,P3,P4,Q,S,T,V,VID,ZS,FBAAB,FBAAMT,FBAAOB,FBCOMM,FBAUT,FBSITE,I,X,Y,Z,FBERR,DIRUT,FBSTAT,FBLOCK
	K FBAC,FBAP,FBCNH,FBFD,FBI,FBLISTC,FBPDT,FBSC,FBTD,PRCSCPAN,DFN
	Q
SHORT	W !!,*7,"This batch CANNOT be released. Check your 1358.",! L -^FBAA(161.7,FBN) D Q G FBAASCB
POST	;FBAAOB=FULL OBLIGATION NUMBER(STA-CXXXXX)
	;FBCOMM=COMMENT FOR 1358
	;FBAAMT=TOTAL AMOUNT OF BATCH
	;FBAAB=BATCH NUMBER
	;IF CALL FAILS FBERR RETURNED=1
	;FBN added as 7th peice of 'X'. It is the interface ID
	K FBERR
	S PRCS("X")=FBAAOB,PRCS("TYPE")="FB" D EN3^PRCS58 I Y=-1 W !!,*7,?5,"1358 not available for posting!",! S FBERR=1 Q
	D NOW^%DTC S X=FBAAOB_"^"_%_"^^"_FBAAMT_"^"_$S($L(FBAAB)<3:$$PADZ^FBAAV01(FBAAB,4),1:FBAAB)_"^"_FBCOMM_"^"_FBN_"^"_1,PRCS("TYPE")="FB" D EN2^PRCS58 I +Y=0 W !!,*7,Y,! S FBERR=1 Q
	K PRCS("SITE"),PRCSI Q

FBAASCB0
FBAASCB0	;AISC/DMK-POST 1358 FOR INPATIENT 7078'S ;03MAY91
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K FBERR,^TMP($J) S FBRJC=0,FBINTOT=$P(FZ,U,10)
	I '$O(^FBAAI("AC",FBN,0)) W !,*7,"No invoices found for this batch. Unable to release.",! S FBERR=1 Q
	;
	S FBII=0 F  S FBII=$O(^FBAAI("AC",FBN,FBII)) Q:'FBII!($D(FBERR))  S FBII78=$P($G(^FBAAI(FBII,0)),"^",5),FBAAMT=$P($G(^(0)),"^",9),FBMM=$E($P(^(0),U,6),4,5) D GET78:FBII78["FB7078(",POST^FBAASCB:FBII78["FB583("
	I $G(FBRJC),FBRJC=FBINTOT S FBERR=1 D KILL Q
	I $G(FBRJC) K FBERR S (FBRJC,FBII)=0 F  S FBII=$O(^TMP($J,FBII)) Q:'FBII  S X=$G(^FBAAI(FBII,0)),FBII78=$P(X,U,5),FBAAMT=$P(X,U,9),FBMM=$E($P(X,U,6),4,5) K X,^TMP($J,FBII) D GET78
	I $G(FBRJC) S (FBAAMT,FBINTOT)=0 D NEWBT S FBII=0 F  S FBII=$O(^TMP($J,FBII)) Q:'FBII  D
	.S DA=FBII,DIE="^FBAAI(",DR="20////^S X=FBBN" D ^DIE K DR,DA,DIE
	.S FBAAMT=FBAAMT+$P(^FBAAI(FBII,0),U,9),FBINTOT=FBINTOT+1
	D:$G(FBRJC) RESETBT
	;
KILL	K FBII,FBII78,FBAAMT,FBI78,FBMM,PRCSX,FBRJC,FBSTN,FBBN,FBINTOT,FBCNH,^TMP($J) Q
	;
GET78	I '$D(^FB7078(+FBII78,0)) W !,*7,"No associated 7078 for invoice ",FBII,". Unable to release batch.",! S FBERR=1 Q
	S FBI78=$P(^FB7078(+FBII78,0),"^"),DFN=+$P(^(0),"^",3),FBI78=$P(FZ,"^",8)_"-"_$P(FBI78,".")_"-"_$P(FBI78,".",2) D
	. ;
	. ;I $D(FBCNH),'$D(^PRC(424,"E",DFN_";"_+FBII78_";"_FBAAON_";"_FBMM)) D POST^FBAASCB
	.D INPOST:$$INTER()
	.I $D(FBCNH),'$$INTER S FBERR=1 W !!,$$NAME^FBCHREQ2(DFN),"  ",$$SSN^FBAAUTL(DFN),!,*7,"Unable to locate reference number on 1358.  Run Post Commitments for",!,"Obligation option."
	.I $D(FBCNH),$D(FBERR) S ^TMP($J,+FBII)="",FBRJC=FBRJC+1 K FBERR
	Q
	;
INPOST	;PRCSX=INTERNAL DAILY REF #^INTERNAL DATE/TIME^AMT OF PAYMENT^COMMENTS^COMPLETE FLAG
	;FBI78=AUTHORIZATION NAME IN 424 (STA-CXXXXX-REF #)
	;FBERR RETURNED IF IFCAP CALL FAILS
	;FBCOMM=COMMENT
	;FBAAMT=ACTUAL AMOUNT OF PAYMENT
	;INTERFACE ID = DFN_";"_INTERNAL ENTRY NUMBER OF 7078_";"_FBAAON  (OBLIGATION)_";" if CNH _FBMM (month of service)
	;INTERNAL DAILY REF # = $O(^PRC(424,"B","STA #-OBLIGATION #-REF #",0))
	;NEW INTERNAL DAILY REF # LOOKUP=$O(^PRC(424,"E",INTERFACE ID,0))
	I '$$INTER() W !,*7,"Unable to locate reference number on 1358.",! S FBERR=1 Q
	S PRCS("X")=FBAAOB,PRCS("TYPE")="FB" D EN3^PRCS58 I Y=-1 W !!,*7,"1358 not available for posting!",! S FBERR=1 Q
	D NOW^%DTC
	S PRCSX=$$INTER()_"^"_%_"^"_FBAAMT_"^"_$S($D(FBCOMM):FBCOMM,1:"")_"^"_1
	D ^PRCS58CC I Y'=1 W !!,$$NAME^FBCHREQ2(DFN),"  (",$$SSN^FBAAUTL(DFN,1),")",!,*7,$P(Y,"^",2),! S FBERR=1 Q
	Q
	;
INTER()	;get internal entry number from file 424
	;first check for new INTERFACE ID "E" x-ref in 424
	;2nd check is to "B" x-ref to stay backward compatible with IFCAP 3.6
	;
	I '$D(FBCNH),$D(^PRC(424,"E",DFN_";"_+FBII78_";"_FBAAON)) Q $O(^(DFN_";"_+FBII78_";"_FBAAON,0))
	I $D(FBCNH),$D(^PRC(424,"E",DFN_";"_+FBII78_";"_FBAAON_";"_FBMM)) Q $O(^(DFN_";"_+FBII78_";"_FBAAON_";"_FBMM,0))
	I '$D(FBCNH),$D(^PRC(424,"B",FBI78)) Q $O(^(FBI78,0))
	Q 0
	;
NEWBT	;open new batch for cnh line items unable to post to 1358
	S FBSTN=$P(FZ,U,8) W ! D GETNXB^FBAAUTL
	S DIC="^FBAA(161.7,",DIC(0)="LQ",X=FBBN,DIC("DR")="1////^S X=FBAAON;2////^S X=""B9"";3////^S X=DT;4////^S X=$P(FZ,U,5);11////^S X=""O"";16////^S X=FBSTN",DLAYGO=161.7
	K DD,DO D FILE^DICN S FBBN=+Y K DIC,DLAYGO
	Q
RESETBT	;reset original batch total $ set new batch totals
	S X=$G(^FBAA(161.7,FBBN,0)),$P(X,U,9)=FBAAMT,$P(X,U,10)=FBINTOT,$P(X,U,11)=FBINTOT,^(0)=X K X
	S $P(FZ,U,9)=$P(FZ,U,9)-FBAAMT,$P(FZ,U,10)=$P(FZ,U,10)-FBINTOT,$P(FZ,U,11)=$P(FZ,U,11)-FBINTOT,^FBAA(161.7,FBN,0)=FZ
	W !!,*7,"A new batch, number ",$P(^FBAA(161.7,FBBN,0),U),", was opened for invoices unable to post to 1358.",!,"Adjust 1358 and take action on new batch.",!
	Q

FBAASL
FBAASL	;AISC/CMR-SUSPENSE LETTERS CONT. ;4/28/93  10:59
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;Allows selection of one/many/all Fee Programs and one/many/all
	;letters to print.
	S DIR(0)="Y",DIR("A")="Print Denials only",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT) I Y S FBDEN=1
	S DIR(0)="Y",DIR("A")="Do you want to print letters for ALL Fee Basis programs",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT)  I Y S FBPRG=1 D
	.F J="I","O","P","C" S FBPRG(J)=""
SELP	I 'FBPRG S DIR(0)="S^I:INPATIENT PAYMENT;O:OUTPATIENT PAYMENT;P:PHARMACY PAYMENT;C:CH NOTIFICATION/DENIAL",DIR("A")="Select PROGRAM to print letter for" D ^DIR K DIR G END:$D(DIRUT) S FBPRG(Y)=""
	I 'FBPRG S DIR(0)="Y",DIR("A")="Do you want to choose another Program",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT),SELP:Y
	S J="" F  S J=$O(FBPRG(J)) Q:J=""  S FBCTR=FBCTR+1
SELLT	K FBERR I FBCTR>1 S DIR(0)="Y",DIR("A")="Do you want to choose a different letter for each of the PROGRAMS you have      selected",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT) S FBY=Y
	S DIC="^FBAA(161.3,",DIC(0)="AEQ",K=0
	D LTR:FBCTR=1!'FBY G END:$G(FBLOUT),SELLT:$G(FBERR) F J=1:1:FBCTR S K=$O(FBPRG(K)) D MULT:FBCTR>1&(FBY) G END:$G(FBLOUT),SELLT:$G(FBERR) S FBPRG(K)=+Y
	Q
END	K FBPRG,FBCTR,J,K,FBLOUT,FBERR S FBAAOUT=1
	Q
MULT	S DIC("A")="Select letter to print for "_$S(K="I":"Inpatient Payments",K="O":"Outpatient Payments",K="P":"Pharmacy Payments",K="C":"CH Notification/Denials")_":  " D LTR Q:$G(FBLOUT)!$G(FBERR)
	Q
LTR	D ^DIC K DIC("A") S:$D(DUOUT)!($D(DTOUT))!(X="") FBLOUT=1 S:Y<0 FBERR=1
	Q
INDIV	;select pt and/or vendor to print suspension letters for
	D DT^DICRW S DFN="",U="^" W !! S DIC="^FBAAA(",DIC(0)="AEQMZ",DIC("A")="Select Patient (or RETURN to select all):" D ^DIC K DIC G:$D(DTOUT)!($D(DUOUT)) END1 I Y>0 S DFN=+Y
	S DIC("A")="Select Vendor (or RETURN to select all):" D GETVEN^FBAAUTL1 K DIC,D0 G:$D(DTOUT)!($D(DUOUT)) END1
	G ^FBAASLP
END1	;
	K DFN,FBV,DUOUT,DTOUT
	Q

FBAASL1
FBAASL1	;AISC/GRR-PRINT SUSPENSION LETTERS CONTINUED ;14OCT86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F K=0:0 S K=$O(^FBAA(162.1,"AG",K)) Q:K'>0  I $S($G(IFN):IFN=K,1:1) S FBSW=1,FBDT=BEGDATE-.001 F ZZ=0:0 S FBDT=$O(^FBAA(162.1,"AG",K,FBDT)) D WPBOT:FBDT'>0&(FBSW=0)!(FBDT>ENDDATE)&(FBSW=0) Q:FBDT'>0!(FBDT>ENDDATE)  D MORE
	Q
MORE	F J=0:0 S J=$O(^FBAA(162.1,"AG",K,FBDT,J)) Q:J'>0  I $S($G(DFN):DFN=J,1:1) D:$D(^DPT(J,0)) GOTP^FBAASLP I $D(^FBAAV(K,0)) D MID
	Q
GOTV	S Y(0)=^FBAAV(K,0),VNAM=$P(Y(0),"^",1),FBSW=0
	I VNAM["," S VNAM=$P(VNAM,",",2)_" "_$P(VNAM,",",1)
	S VST1=$P(Y(0),"^",3),VST2=$P(Y(0),"^",14),VCITY=$P(Y(0),"^",4),VSTATE=$S($D(^DIC(5,+$P(Y(0),"^",5),0)):$P(^(0),"^",2),1:"  "),VZIP=$P(Y(0),"^",6)
	W @IOF,!!!!!!!,?5,VNAM,!,?5,VST1,! I VST2]"" W ?5,VST2,!
	W ?5,VCITY,"  ",VSTATE,"  ",VZIP,!!!!
WPBEG	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	I $D(^FBAA(161.3,FBLET,1,1)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	D HED
	Q
MID	S FBA=0 F FBAA=0:0 S FBA=$O(^FBAA(162.1,"AG",K,FBDT,J,FBA)) Q:FBA=""  I $S(FBSLW=0:1,FBSLW=1&($D(FBAAS(FBA))):1,1:0) D MORE2
	Q
MORE2	F L=0:0 S L=$O(^FBAA(162.1,"AG",K,FBDT,J,FBA,L)) Q:L'>0  F M=0:0 S M=$O(^FBAA(162.1,"AG",K,FBDT,J,FBA,L,M)) Q:M'>0  I $D(^FBAA(162.1,L,"RX",M,0)) S Z(0)=^(0) D:$P(Z(0),"^",20)'="R" BOT
	Q
WPBOT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W") W !!
	I $D(^FBAA(161.3,FBLET,2)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,2,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
BOT	Q:$S($G(FBDEN):$P(Z(0),U,16)>0,1:0)
	I FBSW=1 D GOTV^FBAASLP,HED S FBSW=0,FBGOT=1
	S FBDOS=$P(Z(0),"^",3),FBDRUG=$P(Z(0),"^",2)
	S FBRX=$P(Z(0),"^",1),A1=$P(Z(0),"^",4)+.0001,A2=$P(Z(0),"^",16)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2)
	I $Y+4>IOSL W @IOF D HED
	W !!,PNAME,?32,PSSN,?47,$E(FBDOS,4,5),"/",$E(FBDOS,6,7),"/",$E(FBDOS,2,3),?57,FBRX,!,?15,$J(A1,6),?30,$J(A2,6),?50,FBDRUG,!
	G:FBA=4&($D(^FBAA(162.1,L,"RX",M,1))) WPFT
	S DIWL=1,DIWF="WC79",FBI=FBA K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAA(161.27,FBI,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
HED	W !,"PATIENT NAME",?36,"SSN",?47,"RX DATE",?56,"RX #",!,?15,"AMT CLAIMED",?30,"AMT PAID",?50,"DRUG NAME",!,"   REASON FOR SUSPENSION",!,UL,! Q
GOTP	S Y(0)=^DPT(J,0),PNAME=$P(Y(0),"^",1),PSSN=$TR($$SSN^FBAAUTL(J),"-","")
	I PNAME["," S PNAME=$P(PNAME,",",2)_" "_$P(PNAME,",",1)
	Q
WPFT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAA(162.1,L,"RX",M,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q

FBAASL1B
FBAASL1B	;AISC/GRR-PRINT SUSPENSION LETTERS CONTINUED ;14OCT86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F K=0:0 S K=$O(^FBAA(162.1,"AG",K)) Q:K'>0  S FBSW=1 F FBDT=BEGDATE-.001:0 S FBDT=$O(^FBAA(162.1,"AG",K,FBDT)) D WPBOT:FBDT'>0&(FBSW=0)!(FBDT>ENDDATE)&(FBSW=0) Q:FBDT'>0!(FBDT>ENDDATE)  D MORE
	Q
MORE	F J=0:0 S J=$O(^FBAA(162.1,"AG",K,FBDT,J)) Q:J'>0  D:$D(^DPT(J,0)) GOTP^FBAASLP I $D(^FBAAV(K,0)) D MID
	Q
GOTV	S Y(0)=^FBAAV(K,0),VNAM=$P(Y(0),"^",1),FBSW=0
	I VNAM["," S VNAM=$P(VNAM,",",2)_" "_$P(VNAM,",",1)
	S VST1=$P(Y(0),"^",3),VST2=$P(Y(0),"^",14),VCITY=$P(Y(0),"^",4),VSTATE=$S($D(^DIC(5,+$P(Y(0),"^",5),0)):$P(^(0),"^",2),1:"  "),VZIP=$P(Y(0),"^",6)
	W:$Y+11>IOSL @IOF
	F FBLN=0:0 W ! Q:$Y+11>IOSL
	W !,?5,VNAM,!,?5,VST1,! I VST2]"" W ?5,VST2,!
	W ?5,VCITY,"  ",VSTATE,"  ",VZIP,@IOF
	Q
WPBEG	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	I $D(^FBAA(161.3,FBLET,1,1)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	D HED
	Q
MID	S FBA=0 F FBAA=0:0 S FBA=$O(^FBAA(162.1,"AG",K,FBDT,J,FBA)) Q:FBA=""  I $S(FBSLW=0:1,FBSLW=1&($D(FBAAS(FBA))):1,1:0) D MORE2
	Q
MORE2	F L=0:0 S L=$O(^FBAA(162.1,"AG",K,FBDT,J,FBA,L)) Q:L'>0  F M=0:0 S M=$O(^FBAA(162.1,"AG",K,FBDT,J,FBA,L,M)) Q:M'>0  I $D(^FBAA(162.1,L,"RX",M,0)) S Z(0)=^(0) D:$P(Z(0),"^",20)'="R" BOT
	Q
WPBOT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W") W !!
	I $D(^FBAA(161.3,FBLET,2)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,2,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX D GOTV
	Q
BOT	I FBSW=1 D WPBEG^FBAASLP,HED S FBSW=0
	S FBDOS=$P(Z(0),"^",3),FBDRUG=$P(Z(0),"^",2)
	S FBRX=$P(Z(0),"^",1),A1=$P(Z(0),"^",4)+.0001,A2=$P(Z(0),"^",16)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2)
	I $Y+4>IOSL W @IOF D HED
	W !!,PNAME,?32,PSSN,?47,$E(FBDOS,4,5),"/",$E(FBDOS,6,7),"/",$E(FBDOS,2,3),?57,FBRX,!,?15,$J(A1,6),?30,$J(A2,6),?50,FBDRUG,!
	G:FBA=4&($D(^FBAA(162.1,L,"RX",M,1))) WPFT
	S DIWL=1,DIWF="WC79",FBI=FBA K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAA(161.27,FBI,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
HED	W !,"PATIENT NAME",?36,"SSN",?47,"RX DATE",?56,"RX #",!,?15,"AMT CLAIMED",?30,"AMT PAID",?50,"DRUG NAME",!,"   REASON FOR SUSPENSION",!,UL,! Q
GOTP	S Y(0)=^DPT(J,0),PNAME=$P(Y(0),"^",1),PSSN=$TR($$SSN^FBAAUTL(J),"-","")
	I PNAME["," S PNAME=$P(PNAME,",",2)_" "_$P(PNAME,",",1)
	Q
WPFT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAAC(J,1,K,1,L,1,M,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q

FBAASLP
FBAASLP	;AISC/GRR-PRINT SUSPENSION LETTERS ;14OCT86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DATE^FBAAUTL G END:FBPOP  K FBAAS S (FBAAOUT,FBSLW,FBPRG,FBCTR,FBY)=0,UL="",$P(UL,"=",80)="="
	D ^FBAASL G END:FBAAOUT
RDCODE	S DIR(0)="Y",DIR("A")="For All Suspension codes",DIR("B")="YES",DIR("?")="'Yes' to print suspension letters for all suspension codes, 'No' to select specific codes." D ^DIR K DIR W ! G END:$D(DUOUT),END:$D(DTOUT),SEL:'Y
AHEAD	S VAR="BEGDATE^ENDDATE^FBSLW",VAL=BEGDATE_"^"_ENDDATE_"^"_FBSLW
	I $G(DFN) S VAR="DFN^"_VAR,VAL=DFN_"^"_VAL
	I $G(IFN) S VAR="IFN^"_VAR,VAL=IFN_"^"_VAL
	I $G(FBDEN) S VAR="FBDEN^"_VAR,VAL=FBDEN_"^"_VAL
	S K=0 F J=1:1:FBCTR S K=$O(FBPRG(K)) S VAR=VAR_"^FBPRG("""_K_""")",VAL=VAL_"^"_+FBPRG(K)
	I $D(FBAAS) F J=0:0 S J=$O(FBAAS(J)) Q:J'>0  S VAR=VAR_"^FBAAS("_J_")",VAL=VAL_"^"
	S PGM="START^FBAASLP",IOP="Q" D ZIS^FBAAUTL G:FBPOP END
START	K ^UTILITY($J),^TMP($J) U IO S UL="",$P(UL,"=",80)="=",FBPG=1
	I $G(FBPRG("O")) S FBLET=+FBPRG("O") F K=0:0 S K=$O(^FBAAC("AI",K)) Q:K'>0  I $S($G(IFN):IFN=K,1:1) D STRT
	I $G(FBPRG("P")),$D(^FBAA(162.1,"AG")) S FBLET=+FBPRG("P") D ^FBAASL1 K ^TMP($J)
	I $G(FBPRG("C")),$D(^FBAA(162.2,"AI")) S FBLET=+FBPRG("C") D ^FBCHSLP
	I $G(FBPRG("I")),$D(^FBAAI("AI")) S FBLET=+FBPRG("I") D ^FBCHSL1
	I '$G(FBGOT) W !,"There are no suspension letters found that meet the criteria you have",!,"specified."
END	K FBAAS,UL,X,J,K,L,M,VNAM,VST1,VST2,VCITY,VSTATE,FBDT,FBA,VZIP,PNAME,A1,A2,CPT,FBDOS,FBRR,FBXX,DIC,DIWL,DIWF,BEGDATE,ENDDATE,FBAA,FBDRUG,FBFORM,FBI,FBLET,FBPDT,FBRX,FBSLW,FBSW,I,PGM,VAL,VAR,Z,ZZ,FBAAPGM,Y,PSSN,DIRUT
	K FBAAOUT,FBCTR,FBPRG,FBY,FBMOD,DFN,IFN,FBDEN,FBGOT
	K ^UTILITY($J),^TMP($J)
	D CLOSE^FBAAUTL Q
MORE	F J=0:0 S J=$O(^FBAAC("AI",K,FBDT,J)) Q:J'>0  I $S($G(DFN):DFN=J,1:1) D:$D(^DPT(J,0)) GOTP I $D(^FBAAV(K,0)) D MID
	Q
GOTV	S Y(0)=^FBAAV(K,0),VNAM=$P(Y(0),"^",1),FBSW=0
	I VNAM["," S VNAM=$P(VNAM,",",2)_" "_$P(VNAM,",",1)
	S VST1=$P(Y(0),"^",3),VST2=$P(Y(0),"^",14),VCITY=$P(Y(0),"^",4),VSTATE=$S($D(^DIC(5,+$P(Y(0),"^",5),0)):$P(^(0),"^",2),1:"  "),VZIP=$P(Y(0),"^",6) S Y=DT D PDATE^FBAAUTL
	W:'$G(FBPG) @IOF K:$G(FBPG) FBPG W:(IOSL)>70 !!!! W !!!!!!!!!!!,?5,VNAM,?60,FBPDT,!,?5,VST1,! I VST2]"" W ?5,VST2,!
	W ?5,VCITY,"  ",VSTATE,"  ",VZIP,!!!!
WPBEG	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	I $D(^FBAA(161.3,FBLET,1,1)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
MID	S FBA=0 F FBAA=0:0 S FBA=$O(^FBAAC("AI",K,FBDT,J,FBA)) Q:FBA=""  I $S(FBSLW=0:1,FBSLW=1&($D(FBAAS(FBA))):1,1:0) D MORE2
	Q
MORE2	F L=0:0 S L=$O(^FBAAC("AI",K,FBDT,J,FBA,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AI",K,FBDT,J,FBA,L,M)) Q:M'>0  I $D(^FBAAC(J,1,K,1,L,1,M,0)) S Z(0)=^(0) D:$P(Z(0),"^",20)'="R" BOT
	Q
WPBOT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W") W !!
	I $D(^FBAA(161.3,FBLET,2)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,2,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
BOT	Q:$S($G(FBDEN):$P(Z(0),U,3)>0,1:0)
	I FBSW=1 D GOTV,HED S FBSW=0,FBGOT=1
	S FBDOS=$S($D(^FBAAC(J,1,K,1,L,0)):$P(^(0),"^",1),1:"")
	S CPT=$P(Z(0),"^",1),A1=$P(Z(0),"^",2)+.0001,A2=$P(Z(0),"^",3)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2)
	I CPT]"" S CPT=$S($D(^ICPT(CPT,0)):$P(^(0),"^",1),1:"")
	S FBMOD=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),"^",7)
	I $Y+4>IOSL W @IOF D HED
	W !!,$E(PNAME,1,26),?28,PSSN,?42,$$DATX^FBAAUTL(FBDOS),?51,CPT_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:""),?62,$J(A1,6),?71,$J(A2,6),!
	G:FBA=4&($D(^FBAAC(J,1,K,1,L,1,M,1))) WPFT
	S DIWL=1,DIWF="WC79",FBI=FBA K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAA(161.27,FBI,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
HED	W !,"PATIENT NAME",?32,"SSN",?42,"SVC",?51,"CPT-",?64,"AMT",?72,"AMT",!,"   REASON FOR SUSPENSION",?42,"DATE",?51,"MOD",?62,"CLAIMED",?71,"PAID",!,UL Q
GOTP	S Y(0)=^DPT(J,0),PNAME=$P(Y(0),"^",1),PSSN=$TR($$SSN^FBAAUTL(J),"-","")
	I PNAME["," S PNAME=$P(PNAME,",",2)_" "_$P(PNAME,",",1)
	Q
SEL	W !! S DIC="^FBAA(161.27,",DIC(0)="AEQM" D ^DIC G ENDSL:X=""!(X="^"),SEL:Y<0 S DA=+Y,FBAAS(DA)="",FBSLW=1 G SEL
ENDSL	I '$D(FBAAS) W !!,*7,"No suspension codes selected!" G END
	G AHEAD
PSEL	F FBA=0:0 S FBA=$O(FBAAS(FBA)) Q:FBA'>0  I $D(^FBAAC("AI",FBA)) F FBDT=BEGDATE-.001:0 S FBDT=$O(^FBAAC("AI",FBA,FBDT)) Q:FBDT'>0!(FBDT>ENDDATE)  D MORE
	G END
WPFT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAAC(J,1,K,1,L,1,M,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
STRT	S FBSW=1 S Z=$O(^FBAAC("AI",K,BEGDATE-.001)) S FBDT=BEGDATE-.001 F ZZ=0:0 S FBDT=$O(^FBAAC("AI",K,FBDT)) D WPBOT:FBDT'>0&(FBSW=0)!(FBDT>ENDDATE)&(FBSW=0) Q:FBDT'>0!(FBDT>ENDDATE)  D MORE
	Q

FBAASOUT
FBAASOUT	;AISC/DMK-OUTPUT FOR CPT FEE SCHEDULE ;30AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASKDT	S %DT="AE",%DT("A")="Select Fiscal Year: " D ^%DT K %DT("A") G END:Y<0 S FBFY=$S('$E(Y,4,7):($E(Y,1,3)+1700),$E(Y,4,5)>9:($E(Y,1,3)+1701),1:($E(Y,1,3)+1700)) I '$D(^FBAA(163.99,"AC",FBFY)) G HELP
	S VAR="FBFY",VAL=FBFY,PGM="START^FBAASOUT" D ZIS^FBAAUTL G:FBPOP END
	;
START	S FBAAOUT=0,FBPAGE=1
	K ^TMP("FBCPT",$J)
	U IO W:$E(IOST,1,2)["C-" @IOF D HEAD
	;locate schedule for selected fiscal year and set in ^TMP for sort
	S I=0 F  S I=$O(^FBAA(163.99,I)) Q:'I!(FBAAOUT)  I $D(^FBAA(163.99,I,"FY",FBFY)) S FBY(0)=^(FBFY,0),FBCPT=$P($G(^FBAA(163.99,I,0)),U) D:FBCPT]""
	. S ^TMP("FBCPT",$J,1_$P(FBCPT,"-"),$S(FBCPT'["-":0,1:$P(FBCPT,"-",2)))=FBY(0)
	;go through TMP and print out in cpt order
	S FBI=0,FBJ=""
	F  S FBI=$O(^TMP("FBCPT",$J,FBI)) Q:'+FBI!($G(FBAAOUT))  F  S FBJ=$O(^TMP("FBCPT",$J,FBI,FBJ)) Q:FBJ=""!($G(FBAAOUT))  S FBY(0)=^(FBJ),FBCPT=$E(FBI,2,99)_$S(FBJ=0:"",1:"-"_FBJ) D  D PRINT
	.N FBI,FBJ
	.S (FBDESC,FBDESC(1))=""
	.S FBI=$O(^ICPT("B",$P(FBCPT,"-"),0)) Q:'FBI  S FBDESC=$E($P($G(^ICPT(FBI,0)),U,2),1,39)
	.I $P(FBCPT,"-",2)]"" D  ;get text for CPT Modifier
	.. S FBJ=$O(^DIC(81.3,"B",$P(FBCPT,"-",2),0)) Q:'FBJ  S FBDESC(1)=$E($P($G(^DIC(81.3,FBJ,0)),U,2),1,36)
	D END Q
	;
PRINT	I $Y+5>IOSL D HANG^FBAAUTL1:$E(IOST,1,2)["C-" Q:FBAAOUT  W @IOF S FBPAGE=FBPAGE+1 D HEAD
	F FBY=1,2,5,6,7,8 S FBY(FBY)=$P(FBY(0),"^",FBY)
	I $E(FBY(7),6,7)="00" S FBY(7)=$E(FBY(7),1,5)_"01"
	F K=6,7,8 S FBY(K)=$$DATX^FBAAUTL($P(FBY(K),"."))
	W !,FBCPT,?12,FBY(2),?26,$J(FBY(5),1,2),?42,FBY(6),?60,$S(FBY(7)]"":FBY(7)_" - "_FBY(8),1:"    Add/Edit"),!,?2,FBDESC_$S(FBDESC(1)]"":" - "_FBDESC(1),1:""),!,$$REPEAT^XLFSTR("-",80)
	Q
	;
HEAD	W !!,?19,"****  REPORT OF FEE SCHEDULE  ****",!!,?26,"For Fiscal Year ",FBFY,?70,"Page ",$G(FBPAGE),!!,$$REPEAT^XLFSTR("=",80)
	W !!,"CPT-MOD",?10,"Total #",?25,"75 %ile",?40,"Date Compiled",?65,"Date Range ",!,?2,"Description",!,$$REPEAT^XLFSTR("=",80),!
	Q
	;
END	K DIRUT,DUOUT,DTOUT,FBCPT,FBAAOUT,FBFY,FBI,FBJ,FBPAGE,FBY,I,K,PGM,Q,QQ,VAL,VAR,X,Y,FBDESC,^TMP("FBCPT",$J)
	D CLOSE^FBAAUTL
	Q
	;
HELP	W *7,!!,"There is no data on file for fiscal year ",FBFY,! G ASKDT

FBAASTA
FBAASTA	;AISC/GRR-SIGNON STATUS DISPLAY ;28JUL86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^FBAA(161.4,1,0)) W !!,*7,"Site parameters must be entered before using the Fee system!",!,*7 Q
	K UL S $P(UL,"-",40)="-"
	I '$D(^FBAA(161.7,"AB","O",DUZ)) G NONE
SHOW	D HED
	F J=0:0 S J=$O(^FBAA(161.7,"AB","O",DUZ,J)) Q:J'>0  I $D(^FBAA(161.7,J,0)) S Y(0)=^(0) D MORE
END	K FBBN,FBBT,FBON,FBDO,J,UL Q
MORE	S FBBN=$P(Y(0),"^",1),FBON=$P(Y(0),"^",2),FBBT=$P(Y(0),"^",3),FBDO=$P(Y(0),"^",4)
	W !,FBBN,?9,$S(FBBT="B3":"Medical",FBBT="B5":"Pharmacy",FBBT="B2":"Travel",FBBT="B9":"CH/CNH",1:"Unknown"),?21,FBON,?30,$E(FBDO,4,5),"/",$E(FBDO,6,7),"/",$E(FBDO,2,3)
	Q
NONE	W !,*7,"You have no open Batches!!",!
	G END
HED	D HOME^%ZIS W @IOF,"You currently have the following Batches Open",!!,"Batch",?9,"Batch",?19,"Obligation",?30," Date",!,"  #  ",?10,"Type",?22,"Number",?30,"Opened",!,UL,!

FBAATIC
FBAATIC	;AISC/CMR-TERMINATE ID CARD ;15 APR 1993
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D SITEP^FBAAUTL G Q:FBPOP S FBPROG="I $P(^(0),U,3)=2"
RD	W ! S DIC="^DPT(",DIC(0)="QEAZM" D ^DIC K DIC G Q:Y<0 S DFN=+Y
	I $P($G(^FBAAA(DFN,4)),"^")']"" W !!,"There is no FEE ID Card information on file for this patient!" G Q
	D ^FBAADEM
	S HID=$P(^FBAAA(DFN,4),"^"),NIDR=$P(^(4),"^",3) W !!,"Fee ID Card #: ",HID,!
	S DIR(0)="Y",DIR("A")="Are you sure you want to terminate this ID Card",DIR("B")="No" D ^DIR K DIR G Q:$D(DIRUT),RD:'Y
	S DA=DFN,DIE="^FBAAA(",DR=".5////^S X=""@"";.65///^S X=""T"";.7TERMINATION REASON~;S NIDR=X",DIE("NO^")="" D ^DIE K DIE
	D TRIG^FBAAAUT
	G RD
Q	K Y,DFN,FBPOP,HID,NIDR,DA,FBSITE,X,FBAAOUT,DR,FBAUT,FBPROG,TIME,NID
	Q

FBAAUTL
FBAAUTL	;AISC/GRR-Fee Basis Utility Routine ;02NOV85
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DATE	N FBDT S FBPOP=0 K BEGDATE,ENDDATE K:$G(%DT)'["A" %DT W !!,"**** Date Range Selection ****"
	S FBDT=$S($D(%DT):1,1:0) W ! S %DT=$S(FBDT:%DT,1:"APEX"),%DT("A")="   Beginning DATE : " D ^%DT S:Y<0 FBPOP=1 Q:Y<0  S (%DT(0),BEGDATE)=Y
	W ! S %DT=$S(FBDT:%DT,1:"AEX"),%DT("A")="   Ending    DATE : " D ^%DT K %DT S:Y<0 FBPOP=1 Q:Y<0  W ! S ENDDATE=Y
	Q
	;
ZIS	S ZTRTN=PGM,ZTSAVE="",FBPOP=0 F I=1:1 Q:$P(VAR,"^",I)']""  S ZTSAVE($P(VAR,"^",I))=""
	I '$D(ZTDESC) S ZTDESC=$S($D(PGM):PGM,1:"UNKNOWN OPTION")
	W ! S %ZIS="QMP" D ^%ZIS S:POP FBPOP=1 Q:POP  I $D(IO("Q")) K IO("Q"),ZTIO D ^%ZTLOAD W:$D(ZTSK) !,*7,"REQUEST QUEUED",!,"Task #: ",$G(ZTSK) K I,ZTSK,ZTIO,ZTSAVE,ZTRTN D HOME^%ZIS S FBPOP=1 Q
	Q
	;
CLOSE	I '$D(ZTQUEUED) D ^%ZISC
	K IOP,ZTDESC,ZTRTN,ZTSAVE,ZTDTH,VAR,VAL,PGM,FBPOP,POP Q
	;
D	S Y=$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",$E(Y,4,5))_" "_$S(Y#100:$J(Y#100\1,2)_",",1:"")_(Y\10000+1700)_$S(Y#1:"  "_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),1:"") Q
SITEP	;SET FBSITE(0),FBSITE(1) VARIABLE TO FEE SITE PARAMETERS
	S FBPOP=0,FBSITE(0)=$G(^FBAA(161.4,1,0)) S:FBSITE(0)']"" FBPOP=1
	S FBSITE(1)=$G(^FBAA(161.4,1,1)) S:FBSITE(1)']"" FBPOP=1
	W:FBPOP !,*7,"Fee Basis Site Parameters must be entered to proceed",!
	Q
TM	S X=$E($P(X,".",2)_"0000",1,4),%=X>1159 S:X>1259 X=X-1200 S X=X\100_":"_$E(X#100+100,2,3)_" "_$E("AP",%+1)_"M" Q
PDF	S:Y Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3) Q
GETNXB	;GET NEXT AVAILABLE BATCH NUMBER
	L +^FBAA(161.4) I '$D(^FBAA(161.4,1,"FBNUM")) S ^FBAA(161.4,1,"FBNUM")="1^1"
	I '$P($G(^FBAA(161.4,1,"FBNUM")),"^") S $P(^("FBNUM"),"^")=1
	S FBBN=$P(^FBAA(161.4,1,"FBNUM"),"^")
	I FBBN>99899,$S('$D(^FBAA(161.4,1,"PURGE")):1,$P(^FBAA(161.4,1,"PURGE"),"^",1)'>0:1,1:"") D WARNBT
	S $P(^FBAA(161.4,1,"FBNUM"),"^",1)=$S(FBBN+1>99999:1,1:FBBN+1) I '$$CHKBI^FBAAUTL4(FBBN,1) L -^FBAA(161.4) G GETNXB
	L -^FBAA(161.4) Q
WARNBT	W !,*7,"There are ",99999-FBBN," batches left before the BATCH PURGE routine",!,"needs to be run. Contact your IRM Service!",!!
	Q
GETNXI	;GET NEXT AVAILABLE INVOICE NUMBER 
	L +^FBAA(161.4) I '$D(^FBAA(161.4,1,"FBNUM")) S ^FBAA(161.4,1,"FBNUM")="1^1"
	I '$P($G(^FBAA(161.4,1,"FBNUM")),U,2) S $P(^("FBNUM"),U,2)=1
	S FBAAIN=$P(^FBAA(161.4,1,"FBNUM"),"^",2),$P(^("FBNUM"),"^",2)=$S(FBAAIN+1>9999999:1,1:FBAAIN+1) I '$$CHKBI^FBAAUTL4(FBAAIN) L -^FBAA(161.4) G GETNXI
	L -^FBAA(161.4) Q
PDATE	S FBPDT=$P("January^February^March^April^May^June^July^August^September^October^November^December","^",$E(Y,4,5))_" "_$S(Y#100:$J(Y#100\1,2)_", ",1:"")_(Y\10000+1700)_$S(Y#1:"  "_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),1:"") Q
DATCK	S HOLDY=Y,HOLDY=$S($P(HOLDY,"^",2):$P(HOLDY,"^",2),1:HOLDY)
	I $D(FBAAID),Y>FBAAID W !!,*7,"Date of Service cannot be later than Invoice Date!" K X Q
	I $D(FBAABDT),$D(FBAAEDT),(Y<FBAABDT!(Y>FBAAEDT)) W !!,*7,"Date of Service ",$S(Y<FBAABDT:"prior to ",1:"later than "),"Authorization period.",! K X
	S Y=HOLDY Q
	;
DATX(X)	;external output function for date format
	;INPUT = FM internal date format (time optional)
	;OUTPUT = date/time with slashes
	Q $$FMTE^XLFDT(X,2)
	;
STATION	;GET STATION NUMBER FROM INSTITUTION FILE
	I '$D(FBSITE(1)) D SITEP
	I $S('$D(FBSITE(1)):1,$P(FBSITE(1),"^",3)="":1,'$D(^DIC(4,$P(FBSITE(1),"^",3),0)):1,'$D(^DIC(4,$P(FBSITE(1),"^",3),99)):1,'+$P(^DIC(4,$P(FBSITE(1),"^",3),99),"^"):1,1:0) G NOSTA
	S (FBSN,FBAASN)=$S($D(^DIC(4,$P(FBSITE(1),"^",3),99)):$E(^(99),1,3),1:999)
	Q
NOSTA	S FB("ERROR")=1 I '$D(ZTQUEUED) W !!,*7,"Unable to determine Station Number. Check Fee Site Parameters or Station Number in the Institution File.",!!
	Q
	;
HD	;set transmission header
	I '$D(FBSITE(1)) S FBSITE(1)=$G(^FBAA(161.4,1,1))
	S FBHD=$$HDR^FBAAUTL3() I FBHD']"" S FB("ERROR")=1 W !,"Transmission header must exist in FEE BASIS SITE PARAMETER file",!,"before you can proceed.",*7,!
	Q
	;
SSN(PID,BID,DOD)	;
	;PID = DFN of Patient. If this is all that is past,
	;full Pt.ID (000-00-0000) will be returned.
	;If BID = 1 the call will return last 4 of Pt.ID only.
	;If DOD is defined to internal entry # of eligibility the appropriate
	;Pt.ID will be returned.
	N DFN,FBSSN
	S DFN=PID
	I 'DFN Q "Unknown"
	S:'$D(BID) BID="" S:$D(DOD) VAPTYP=DOD
	D PID^VADPT6 I VAERR K VAERR Q "Unknown"
	S FBSSN=$S(BID:VA("BID"),1:VA("PID"))
	K VA("BID"),VA("PID"),VAERR,VAPTYP
	Q FBSSN
	;

FBAAUTL1
FBAAUTL1	;AISC/GRR-Fee Basis Utility Routine ;02NOV85
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PLUSOB	;ENTRY POINT TO INCREASE OBLIGATION ADJUSTMENT
	S FBAAMT="-"_FBAARA
	D ADD Q
	;D NOW^%DTC S X=FBAAOB_"^"_%_"^^"_FBAAMT_"^"_FBAAB_"^"_FBCOMM,PRCS("TYPE")="FB" D EN2^PRCS58 I +Y=0 W !!,*7,Y,! S FBERR=1 Q
	Q
VALCK	;DETERMINE VALIDITY OF RESPONSE
	S VAL=0 I $E(X)="?"!("YyNn"'[$E(X,1)) D HELPYN Q
	S VAL=1
	Q
HELPYN	;DISPLAY HELP TEXT FOR YES OR NO
	W !!,"Please enter 'Yes' or 'No'."
	Q
GETVET	D DT^DICRW S DFN="",U="^" W !! S DIC="^FBAAA(",DIC(0)="AEMQZ",DIC("A")="Select Patient: " D ^DIC K DIC("A"),DIC("S") Q:Y<0  S (D0,DFN)=+Y
	Q
GETAUTH	S CNT=0,FTP="" N FB I '$D(^FBAAA(DFN,1)) W !!,"PATIENT HAS NO AUTHORIZATIONS " Q
	S FBPROG=$S($D(FBPROG):FBPROG,1:"I 1"),I=0 F  S I=$O(^FBAAA(DFN,1,I)) Q:'I  I $D(^(I,0)) X FBPROG I  S CNT=CNT+1,CNT(CNT)=I
	S PI="" D HOME^%ZIS D ^FBAADEM
	I CNT<1 W !!,"Veteran does NOT have an Authorization for the Fee Program being used !!" G Q
RD	I CNT=1 S DIR(0)="Y",DIR("A")="Is this the correct Authorization period (Y/N)",DIR("B")="Yes" D ^DIR K DIR G:Y=0!($D(DIRUT)) NOAUTH S X=1 G 2
CHOOS	W !! S DIR(0)="N^1:"_CNT D ^DIR K DIR Q:$D(DUOUT)  G H^XUS:$D(DTOUT)
2	S (FTP,X)=CNT(X),FB=$G(^FBAAA(DFN,1,X,0)),FBAABDT=$P(FB,"^"),FBAAEDT=$P(FB,"^",2),FBTYPE=$P(FB,"^",3),TA=$P(FB,"^",11),FBTT=$P(FB,"^",13),FBPOV=$P(FB,"^",7),FBPT=$P(FB,"^",18),FBPSA=$P(FB,"^",5),FBVEN=$P(FB,"^",4),FB7078=""
	I $P(FB,"^",9)[";FB7078(" S FB7078=+$P(FB,"^",9)
	I $P(FB,"^",9)[";FB583(" S FB583=+$P(FB,"^",9)
	S FBDMRA=$G(^FBAAA(DFN,1,X,"ADEL")) I FBDMRA']"" K FBDMRA
	S FBASSOC=X
	I FB7078]"" S FBVEN=+$P($G(^FB7078(+FB7078,0)),U,2)
Q	Q
DAYS	;CALCULATES THE NUMBER OF DAYS IN MONTH
	S X1=X,X=+$E(X,4,5),X=$S("^1^3^5^7^8^10^12^"[("^"_X_"^"):31,X=2:28,1:30) I X=28,'($E(X1,1,3)#4) S X=29
	Q
DATCK2	I $D(FBAABDT),$D(FBAAEDT),Y<FBAABDT!(Y\1>FBAAEDT) W !!,*7,"Date ",$S(Y<FBAABDT:"prior to ",1:"later than "),"Authorization period",! K X Q
	I $D(FBTRT),$D(FBLTD),(9999999.999999-Y)'<FBLTD W !,*7,"There is already an existing admission for this authorization!",! K X
	Q
DATCK3	I $D(FBLTTYP),FBLTTYP]"",FBLTTYP<4,(X-3)'=FBLTTYP W !!,*7,"That transfer type NOT consistent with last transfer type!",! K X
	I $D(FBLTT),FBLTT="A",X>3 W !!,*7,"A 'Transfer From' type transaction can only follow a 'Transfer To' type!",! K X
	Q
WRONGT	;WRONG TYPE OF AUTHORIZATION SELECTED
	W !!,"Authorization type selected inconsistent with option being used" Q
GETVEN	;LOOKUP VENDOR
	W ! S DIC=161.2,DIC(0)="AEQM",IFN="" D ^DIC Q:Y<0  S IFN=+Y Q
HANG	;IF $E(IOST,1,2)["C-" ASK TO CONTINUE
	S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q
CKOB	D STATION^FBAAUTL I $D(FB("ERROR")) K FB("ERROR"),X Q
	S PRC("SITE")=$S($D(PRC("SITE")):PRC("SITE"),1:FBSN) K FBSN,FBAASN
	I '$D(^PRC(442,"B",PRC("SITE")_"-"_X)) W !,"This Obligation number does not exist in the IFCAP file!",! K PRC,X
	Q
CK1358	;CHECK TO SEE IF 1358 AVAILABLE
	;FBAAOB=FULL OBLIGATION NUMBER (STA-CXXXXX)
	;RETURNS Y=1 IF OK
	S PRCS("X")=FBAAOB,PRCS("TYPE")="FB" D EN3^PRCS58 I Y=-1 W !!,*7,"1358 not available for posting!",! S FBERR=1 Q
	Q
NOAUTH	S (FTP,X)="" Q
LOCK	W !!,*7,"Queueing has been initiated by another user and is now in progress!",!! Q
	;
XSET	;SET X-REF IN FILE 161.27 FOR LOOK-UP BY SHORT DESCRIPTION
	S ZZ=^FBAA(161.27,DA,2) D TRANS S ^FBAA(161.27,"C",$E(ZZ,1,30),DA)=""
	K ZZ Q
XKILL	;
	S ZZ=^FBAA(161.27,DA,2) D TRANS K ^FBAA(161.27,"C",$E(ZZ,1,30),DA)
	K ZZ Q
	;
TRANS	;
	S ZZ=$TR(ZZ,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
	Q
	;
VER()	;no parameters passed
	;returns 1 if site is running version 4 of IFCAP
	;S X=$G(^DIC(9.4,+$O(^DIC(9.4,"C","PRC",0)),"VERSION"))
	N X
	S X=$$VERSION^XPDUTL("PRC")
	Q $S(+X=4:1,1:0)
	;
ADD	;call to add money back into 1358 when version of IFCAP>3.6
	;uses interface ID look-up to get internal entry number
	;interface ID = IEN of batch from 161.7
	;find ien to 424 by $O(^PRC(424,"E",FBN,0))
	;call NOT used for civil hospital/cnh
	S PRCS("X")=FBAAOB,PRCS("TYPE")="FB" D EN3^PRCS58 I Y=-1 W !!,*7,"1358 not available for posting!",! S FBERR=1 Q
	N FBADDX S FBADDX=$O(^PRC(424,"E",+$G(FBN),0)) I 'FBADDX S FBERR=1 Q
	D NOW^%DTC
	S PRCSX=FBADDX_"^"_%_"^"_FBAAMT_"^"_FBCOMM_"^"_1
	D ^PRCS58CC I Y'=1 W !!,*7,$P(Y,U,2),! S FBERR=1
	Q

FBAAUTL2
FBAAUTL2	;AISC/GRR-FEE UTILITY ROUTINE ;19APR90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
CONDAT	;called from input transform in 161.21,.02-.03
	S (FBOUT,Z)=0
	F  S Z=$O(^FBAA(161.21,"C",+$G(FBVIEN),Z)) Q:'Z  I $P($G(^FBAA(161.21,Z,0)),U,2) S Z(0)=^(0),FBVCON($P(Z(0),U,2))=$P(Z(0),U,3)
	K FBVCON(+$P(^FBAA(161.21,DA,0),U,2))
	S Z=0 F  S Z=$O(FBVCON(Z)) Q:Z'>0!(FBOUT)  I X'<Z&(X'>FBVCON(Z)) S FBOUT=1 W !,*7,"Date entered overlaps existing contract dates!",! K X,Z,FBVCON Q
	K Z,FBVCON
	Q
DATES	;ASK FROM AND TO DATES AND ENSURE THEY DO NOT OVERLAP PRIOR AUTHORIZATIONS
	;variables FBO and FB1 are set in FBNHEDAT as default dates
	S FBFLAG=1 K FBAUT
FDAT	S (FBBEGDT,FBENDDT)="",%DT("A")="Select FROM DATE: ",%DT="AEX" S:$S($G(FBO):1,1:0) %DT("B")=$$DATX^FBAAUTL(FBO) D ^%DT G:Y'>0 END S FBBEGDT=Y
	G:FBFLAG=2 EN1
EDAT	S FBOUT=0,%DT("A")="Select TO DATE: ",%DT="AEXF",%DT(0)=FBBEGDT S:$S($G(FB1):1,1:0) %DT("B")=$$DATX^FBAAUTL(FB1) D ^%DT K %DT(0) G:Y'>0 END S FBENDDT=Y
EN1	;CHECK WHETHER AUTHORIZATION FROM DATE OVERLAPS PREVIOUS ENTRIES
	S (FBOUT,FBLG)=0 F Z=0:0 S Z=$O(^FBAAA(DFN,1,Z)) Q:Z'>0  I $D(^(Z,0)) S Z(0)=^(0) I $P(Z(0),"^",3)=FBPROG S FBAUT($P(Z(0),"^"))=$P(Z(0),"^",2)
	I $G(FBO),($G(FB1)),($G(FBAUT(FBO))=FB1) K FBAUT(FBO)
	F Z=0:0 S Z=$O(FBAUT(Z)) Q:Z'>0!(FBOUT)  D CHKDT:FBFLAG=1,CHKBO:FBFLAG=2,ERRD:FBLG>0
	I FBOUT S FBOUT=0 G:FBLG>0&(FBFLAG=1) FDAT
	Q
END	S (FBBEGDT,FBENDDT)="" K Z,FBAUT,FBOUT,FBLG Q
CHKDT	I FBBEGDT<Z&(FBENDDT<Z) S FBLG=0,FBOUT=1 Q
	I FBBEGDT<Z&(FBENDDT'<Z) S FBLG=2,FBOUT=1 Q
	I FBPROG=7,FBAUT(Z)>DT S FBLG=0,FBOUT=1,FBBEGDT="" K FBAUT W !!?5,"There already is an active CNH authorization on file.",!?5,"Use the 'Edit CNH Authorization' option.",! Q
	I FBPROG=7,FBBEGDT=FBAUT(Z) Q
CHKBO	I FBBEGDT'<Z&(FBBEGDT'>FBAUT(Z)) S FBLG=1,FBOUT=1 Q
	Q
ERRD	W !,*7,$S(FBLG=1:"FROM ",1:"TO "),"DATE entered overlaps a previous Authorization!",!
	Q
	;
UPDT	;UPDATE BATCH STATUS
	S DA=J,(DIC,DIE)="^FBAA(161.7,",DR="11////^S X=FBSTAT;12////^S X=DT" D ^DIE Q
	Q
	;
PAT	S FBSSN=$P(Y(0),"^",9) S:$L(FBSSN)=9 FBSSN=FBSSN_" " S FBSEX=$P(Y(0),"^",2),FBSEX=$S(FBSEX="F":FBSEX,1:"M")
	S FBDOB=$P(Y(0),"^",3),FBDOB=$S(FBDOB="":"        ",1:$E(FBDOB,4,7)_($E(FBDOB,1,3)+1700))
	S FBNAME=$P(Y(0),"^",1),FBLNAM=$E($P(FBNAME,",",1),1,5),FBFLNAM=$E($P(FBNAME,",",1),1,21),FBFLNAM=FBFLNAM_$E(PAD,$L(FBFLNAM)+1,21)
	S:$L(FBLNAM)<5 FBLNAM=FBLNAM_$E("     ",$L(FBLNAM)+1,5)
	S FBFI=$E($P(FBNAME,",",2),1),FBMI=$P(FBNAME,",",2),A=$F(FBMI," "),FBMI=$S(A<1:" ",1:$E(FBMI,A)),FBMI=$S(FBMI="":" ",1:FBMI)
	Q
	;
ASKVOK	S DIR(0)="Y",DIR("A")="Is this the correct vendor",DIR("B")="YES" D ^DIR K DIR G:$D(DIRUT) VENOUT S:'Y FBVENO=1
	Q
VENOUT	S FBVENOT=1 K DIRUT Q
	;
FBPH	W ! S DIR("A")="Want to review fee pharmacy payment history",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR
	I Y,$D(DFN),$D(^DPT(+DFN,0)) S N=$P(^(0),"^"),FBHDFN=DFN N FBAAOUT D LIST^FBAAPPH S DFN=FBHDFN K FBHDFN
	Q
PRPRDT	D NOW^%DTC S Y=% X ^DD("DD") W ?60,Y
	Q
IFCAP	S PRCF("X")="S" D ^PRCFSITE S PRC("SITE")=$S($D(PRC("SITE")):PRC("SITE"),1:"") I PRC("SITE")="" S FBERR(1)=1 Q
	S FB("SITE")=PRC("SITE")
	Q
POV	;GET POV/TREATMENT TYPE FROM 161 FOR TRANSMISSION OF PAYMENTS
	S (FBTT,POV)="" Q:'$D(^FBAAC(K,1,L,1,M,0))  S POV(0)=$P(^(0),"^",4) Q:POV(0)=""
	Q:'$D(^FBAAA(K,1,POV(0),0))  S POV=$P(^(0),"^",7),FBTT=$P(^(0),"^",13)
	Q
XREF	;SET X-REF FOR PRINT AUTHORIZATION FIELD (161.01,1)
	Q:'$D(^FBAAA(DA(1),1,DA,0))  N FBZZ S FBZZ(0)=^(0),FBZZ(1)=$P(FBZZ(0),"^",3)
	S FBZZ(2)=$S(FBZZ(1)=2:"",FBZZ(1)=3:"",FBZZ(1)=11:"",1:1) I FBZZ(2) S ZZZ="" Q
	S ZZZ=$P(FBZZ(0),"^",13),ZZZ=$S(ZZZ=1:$P(FBZZ(0),"^"),ZZZ=2:$P(FBZZ(0),"^"),ZZZ=3:$S($D(^FBAAA(DA(1),4)):$P(^(4),"^",2),1:""),1:"")
	Q
ADD	S ZZZ="" D XREF Q:ZZZ=""  S ^FBAAA("AF",$P(^FBAAA(DA(1),1,DA,0),"^",3),ZZZ,DA(1),DA)=""
	Q
KILL	S ZZZ="" D XREF Q:ZZZ=""  K ^FBAAA("AF",$P(^FBAAA(DA(1),1,DA,0),"^",3),ZZZ,DA(1),DA)
	Q
	;
VER(X)	;determine version of a file based on DD node
	;X= file number
	Q $S('X:0,1:+$P($G(^DD(X,0,"VR")),U))

FBAAUTL3
FBAAUTL3	;AISC/DMK-FEE BASIS UTILITY ROUTINE ;5/12/93  13:42
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
HDR()	;this is a supported call to be used by IFCAP to determine
	;the System Identifier for the 994 code sheets
	;Q $S($P($G(^FBAA(161.4,1,1)),U,10)]"":$P(^(1),U,10),1:"FEN")
	Q $S($$VER5():"FEN",1:"FEE")
	;
POV(X)	;determine ien of pov based on austin code
	;INPUT:  X = pov code
	;OUTPUT: ien of active record containing passed pov code or 0
	S:X']"" X=0
	Q +$O(^FBAA(161.82,"AC",X,0))
	;
RCOMP	;entry point to re-compile templates
	S:'$D(DTIME) DTIME=300 S U="^"
	S DIR(0)="Y",DIR("A")="Re-compile FB input templates" D ^DIR K DIR G RCOMPQ:'Y
	S $P(QQ,"=",81)="" W !!?17,"Recompilation of Fee Basis Input Templates",!,QQ
	S FBMAX=^DD("ROU") F FBX="FB VENDOR UPDATE","FBAA AUTHORIZATION" S Y=$O(^DIE("B",FBX,0)) Q:'Y  I $D(^DIE(Y,"ROUOLD")),^("ROUOLD")]"",$D(^(0)) S X=$P(^("ROUOLD"),"^"),DMAX=FBMAX D EN^DIEZ
RCOMPQ	;kill off variables and exit re-compile option
	K DMAX,FBX,Y,X,QQ,FBMAX
	Q
	;
UP(X)	;entry point to convert lower case to upper case letters
	I $G(X)']"" Q 0
	Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
	;
YN	;called from input transform on Yes - No type fields to allow
	;a user to enter:
	;              1 = Yes     0 = No  stores Y or N
	;
	S X=$E($$UP^FBAAUTL3(X))
	S X=$S(X:"Y",X="Y":X,X="N":X,X=0:"N",1:2)
	I X'=2 W "  (",$S(X="Y":"YES",1:"NO"),")" Q
	W *7,!?4,"NOT A VALID ENTRY!" K X
	Q
	;
OUTYN	;called from output transform on fields that are defined as Y/N
	;
	S Y=$S(Y="Y":"YES",Y="N":"NO",1:"")
	Q
	;
VER5()	;returns '1' if site is running version 5 of IFCAP
	;used to handle record layouts for FMS payments
	N X
	;S X=$G(^DIC(9.4,+$O(^DIC(9.4,"C","PRC",0)),"VERSION"))
	S X=$$VERSION^XPDUTL("PRC")
	Q $S(+X>4:1,1:0)
	;
IDCHK(DFN,AUTH)	;call to check if authorization being paid is
	;an ID card.  Called during payment process.
	;DFN = patients internal entry number
	;AUTH= internal entry number of authorization in 161.
	;both are required
	I $S('$G(DFN):1,'$G(AUTH):1,1:0) Q 0
	Q $S('$D(^FBAAA(+DFN,1,+AUTH,0)):0,$P(^(0),U,13)=3:1,1:0)

FBAAUTL4
FBAAUTL4	;AISC/CMR-"AE" X-REF MANIPULATOR (FILE 162);JUNE 10, 1994
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
SCPT(X,Y)	;set "AE" x-ref when CPT field is added or modified
	;INPUT   X = ien of CPT
	;        Y = ien of Modifier (optional...should be sent if it exists)
	Q:'$G(X)
	S ^FBAAC("AE",DA(3),DA(2),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),0),U),X_$S($G(Y)]"":"-"_Y,1:""),DA)=""
	Q
KCPT(X,Y)	;kill "AE" x-ref if CPT field is deleted or modified
	;INPUT   X = ien of CPT
	;        Y = ien of Modifier (optional...should be sent if it exists)
	Q:'$G(X)
	I $D(^FBAAC("AE",DA(3),DA(2),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),0),U),X,DA)) K ^(DA)
	Q:'$G(Y)
	I $D(^FBAAC("AE",DA(3),DA(2),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),0),U),X_"-"_Y,DA)) K ^(DA)
	Q
SMOD(X,Y)	;set "AE" x-ref if modifier is added or modified
	;INPUT   X = ien of CPT
	;        Y = ien of modifier
	Q:'$G(X)!('$G(Y))
	K:$D(^FBAAC("AE",DA(3),DA(2),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),0),U),X,DA)) ^(DA) ;kill CPT ref. if no mod prev.
	S ^FBAAC("AE",DA(3),DA(2),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),0),U),X_"-"_Y,DA)=""
	Q
KMOD(X,Y)	;kill "AE" x-ref if modifier is deleted or modified
	;INPUT   X = ien of CPT
	;        Y = ien of modifier
	Q:'$G(X)!('$G(Y))
	K:$D(^FBAAC("AE",DA(3),DA(2),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),0),U),X_"-"_Y,DA)) ^(DA) S ^FBAAC("AE",DA(3),DA(2),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),0),U),X,DA)=""
	Q
CPT(X,Y)	;return external format of CPT code
	;INPUT   X = ien of CPT
	;optional Y I Y return description, I 'Y return external format of CPT
	;OUTPUT  external format of CPT code or description of CPT code
	I '$G(X) Q ""
	Q $S('$G(Y):$P($G(^ICPT(X,0)),U),1:$P($G(^ICPT(X,0)),U,2))
	;
MOD(X,Y)	;return external format of modifier
	;INPUT   X = ien of modifier
	;optional Y I Y return description, I 'Y return external format of mod
	;OUTPUT  external format of modifier or description of CPT code
	I '$G(X) Q ""
	Q $S('$G(Y):$P($G(^DIC(81.3,X,0)),U),1:$P($G(^DIC(81.3,X,0)),U,2))
	;
CPTMOD(W,X,Y,Z,F)	;get internal ien of CPT or Modifier
	;INPUT   W = DA(3) FILE 162
	;        X = DA(2) FILE 162
	;        Y = DA(1) FILE 162
	;        Z = DA FILE 162
	;        F (optional) "" returns CPT, 1  returns Modifier
	;OUTPUT  internal ien of CPT
	I '$G(W)!('$G(X))!('$G(Y))!('$G(Z)) Q ""
	I $G(F)']"" Q $P($G(^FBAAC(W,1,X,1,Y,1,Z,0)),U)
	I $G(F)=1 Q $P($G(^FBAAC(W,1,X,1,Y,1,Z,2)),U,7)
	;
FEELU(X,Y,Z)	;look-up fee schedule in 163.99
	;x=ien of CPT code
	;y=fiscal year
	;z=cpt modifier (optional)
	I '$G(X)!('$G(Y)) Q ""
	S X=$$CPT(X)
	S Z=$S($G(Z):$$MOD(Z),1:"")
	N I,J
	S I=X_$S($G(Z)]"":"-"_Z,1:"")
	I '$D(^FBAA(163.99,"B",I)) Q ""
	S J=$O(^FBAA(163.99,"B",I,0)) I 'J Q ""
	Q $P($G(^FBAA(163.99,J,"FY",+Y,0)),U,5)
	;
CHKBI(X,Y)	;called to determine if batch number or invoice number
	;already exists
	;X= next batch/invoice number
	;Y=1 if Batch
	;Y undefined if invoice number passed
	;returns a truth if X is ok for next batch/invoice #
	;
	I 'X Q ""
	I $G(Y),$D(^FBAA(161.7,"B",X)) Q ""
	Q $S($D(^FBAA(162.1,"B",X)):"",$D(^FBAAI("B",X)):"",1:1)

FBAAUTL5
FBAAUTL5	;ACAMPUS/DMK-UTILITY ROUTINE ;1/27/95  11:52
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
INPUT	;called from input transform of 163.99 to determine if CPT and
	;or modifier is a valid entry in appropriate file.
	Q:'$D(X)
	N A,B
	S A=$P(X,"-"),B=$P(X,"-",2)
	I '$D(^ICPT("B",A)) D:$G(DIC(0))["E"  K X Q
	. W !,*7,"CPT code not valid!",!
	;
	I B]"",'$D(^DIC(81.3,"B",B)) D:$G(DIC(0))["E"  K X Q
	. W !,*7,"CPT Modifier not valid!",!
	W !?20,"CPT: ",$P(^ICPT(+$O(^ICPT("B",A,0)),0),U,2)
	I B]"" W !?20,"MOD: ",$P(^DIC(81.3,+$O(^DIC(81.3,"B",B,0)),0),U,2)
	Q
PSA(X)	;get psa from institution
	;input   X = ien of psa
	;output  station number from instutution file\
	Q $S($D(^DIC(4,+$G(X),99)):$E(^(99),1,3),1:"")
	;
EXTPV(X)	;call used to determine Purpose of Visit Austin code
	;               x = pointer to 161.82
	;               Output = Austin code
	Q $S('$G(X):"",1:$P($G(^FBAA(161.82,+X,0)),U,3))

FBAAV0
FBAAV0	;AISC/GRR-ELECTRONICALLY TRANSMIT FEE DATA ;10:32 AM  19 Apr 1990
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K ^TMP($J,"FBAABATCH"),^TMP($J,"FBVADAT") D DT^DICRW
	I '$D(^FBAA(161.7,"AC","S")),'$D(^FBAA(161.7,"AC","R")),'$D(^FBAA(161.25,"AE")),$S('$D(^FBAA(161.26,"AC","P")):1,$O(^FBAA(161.26,"AC","P",0))'>0:1,1:0) W !,*7,"There are no transactions requiring transmission",*7 Q
	W !!,"This option will transmit all Batches and MRA's ready to be transmitted",!,"to Austin"
RD	W !! S DIR(0)="Y",DIR("A")="Are you sure you want to continue",DIR("B")="No" D ^DIR K DIR G END:'Y
	L +^FBAA(161.7,"AC"):0 G:'$T LOCK^FBAAUTL1
	W !!,"The following Batches will be transmitted: " F FBSTAT="S","R" F J=0:0 S J=$O(^FBAA(161.7,"AC",FBSTAT,J)) Q:J'>0  S FBATCH=$G(^FBAA(161.7,J,0)) D
	.Q:'+FBATCH
	.I (FBSTAT="S"&($P(FBATCH,U,15)="Y"))!(+$P(FBATCH,U,9)) S ^TMP($J,"FBAABATCH",J)="" W !,+FBATCH
RTRAN	;Entry from Re-transmit MRA routine
	D ADDRESS^FBAAV01 G END:VATERR K VAT
	D WAIT^DICD,STATION^FBAAUTL,HD^FBAAUTL I $D(FB("ERROR")) G END
	S TOTSTR=0,$P(PAD," ",200)=" "
	D ^FBAAV1:$D(^FBAA(161.25,"AE"))
	D ^FBAAV4:$D(^FBAA(161.26,"AC","P"))
	F J=0:0 S J=$O(^TMP($J,"FBAABATCH",J)) Q:J'>0  I $D(^FBAA(161.7,J,0)) S Y(0)=^(0) D SET1,DET:FBAABT="B3",DETP^FBAAV2:FBAABT="B5",DETT^FBAAV3:FBAABT="B2",^FBAAV5:FBAABT="B9"
END	L -^FBAA(161.7,"AC") D KILL^FBAAV1 Q
SET1	S FBAABN=$P(Y(0),"^",1),FBAABN=$E("00000",$L(FBAABN)+1,5)_FBAABN,FBAAON=$E($P(Y(0),"^",2),3,6),FBAACD=$E(DT,4,7)_$E(DT,2,3),FBAACP=$E($P(Y(0),"^",2),1,2)
	S FBAABT=$P(Y(0),"^",3),FBAAAP=$P(Y(0),"^",9)+.00001,FBAAAP=$P(FBAAAP,".",1)_$E($P(FBAAAP,".",2),1,2)
	S FBSTAT=$P(^FBAA(161.7,J,"ST"),"^"),FBCHB=$P(Y(0),"^",15),FBEXMPT=$P(Y(0),"^",18),FBAAAP=$E("0000000000",$L(FBAAAP)+1,10)_FBAAAP,FBAASN=$S(+$P(Y(0),U,8):$P(Y(0),U,8),1:FBAASN),FBAASN=FBAASN_$E("      ",$L(FBAASN)+1,6)
	I FBSTAT="R"!(FBSTAT="S"&(FBCHB'["Y"))!(FBSTAT="S"&($G(FBEXMPT)="Y")) S FBSTR=FBHD_$S(FBAABT="B2":"BT",1:FBAABT)_FBAACD_FBAASN_FBAABN_FBAAAP_FBAACP_" $"
	Q
DET	;entry point to get data for outpatient (B3)
	S FBTXT=0
	D CKB3V^FBAAV01 I $G(FBERR) K FBERR Q
	F K=0:0 S K=$O(^FBAAC("AC",J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AC",J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AC",J,K,L,M)) Q:M'>0  F N=0:0 S N=$O(^FBAAC("AC",J,K,L,M,N)) Q:N'>0  S Y(0)=$G(^FBAAC(K,1,L,1,M,1,N,0)) I Y(0)]"",+$P(Y(0),U,3) D
	.S FBPICN=K_U_L_U_M_U_N
	.S FBY=$G(^FBAAC(K,1,L,1,M,1,N,2))
	.I 'FBTXT S FBTXT=1 D NEWMSG^FBAAV01,STORE^FBAAV01,UPD
	.D GOT
	D:FBTXT XMIT^FBAAV01 Q
GOT	S FBPAYT=$P(Y(0),"^",20),FBPAYT=$S(FBPAYT]"":FBPAYT,1:"V"),FBVID=$P($G(^FBAAV(L,0)),U,2)
	D POV^FBAAUTL2
	S POV=$S(POV']"":"",POV="A":6,POV="B":7,POV="C":8,POV="D":9,POV="E":10,1:POV),POV=$S(POV']"":99,$D(^FBAA(161.82,POV,0)):$P(^(0),"^",3),1:99),FBPOV=POV
	S FBCPT=$P(Y(0),"^"),FBCPT=$S(FBCPT="":"     ",$D(^ICPT(FBCPT,0)):$P(^(0),"^"),1:"     "),FBPSA=$P(Y(0),"^",12),FBPSA=$S(FBPSA="":+FBAASN,$D(^DIC(4,FBPSA,99)):$E($P(^(99),"^",1),1,3),1:+FBAASN)
	S FBVID=FBVID_$E(PAD,$L(FBVID)+1,11)
	S FBTT=$S(FBTT]"":FBTT,1:1),FBPATT=$P(Y(0),"^",17),FBPATT=$S(FBPATT]"":FBPATT,1:10),FBTD=$P($G(^FBAAC(K,1,L,1,M,0)),"^")
	S FBTD=$S(FBTD]"":$E(FBTD,4,7)_$E(FBTD,2,3),1:"      "),FBSUSP=$P(Y(0),"^",5),FBSUSP=$S(FBSUSP]"":FBSUSP,1:" "),FBAP=$P(Y(0),"^",3)+.00001,FBAP=$P(FBAP,".",1)_$E($P(FBAP,".",2),1,2),FBAP=$E("00000000",$L(FBAP)+1,8)_FBAP
	S FBPOS=+$P(Y(0),"^",25),FBPOS=$S(FBPOS:$P(^IBE(353.1,FBPOS,0),"^"),1:"  "),FBHCFA=+$P(Y(0),"^",26),FBHCFA=$S(FBHCFA:$P(^IBE(353.2,FBHCFA,0),"^"),1:""),FBHCFA=$E(PAD,$L(FBHCFA)+1,2)_FBHCFA
	S FBVTOS=+$P(Y(0),"^",24),FBVTOS=$S(FBVTOS:$P(^FBAA(163.85,FBVTOS,0),"^",2),1:"  "),FBPD=+$P(Y(0),"^",23),FBPD=$S(FBPD:$P(^ICD9(FBPD,0),"^"),1:""),FBPD=$E(PAD,$L(FBPD)+1,7)_FBPD
	S VAPA("P")="",FBSUSP=$S(FBSUSP=" ":" ",$D(^FBAA(161.27,+FBSUSP,0)):$P(^(0),"^"),1:" "),FBINVN=$P(Y(0),"^",16),DFN=K,FBDIN=$P(Y(0),"^",15),Y(0)=$G(^DPT(+K,0)) Q:Y(0)']""  D PAT^FBAAUTL2,ADD^VADPT
	S FBST=$S($P(VAPA(5),"^")="":"  ",$D(^DIC(5,$P(VAPA(5),"^"),0)):$P(^(0),"^",2),1:"  "),FBCTY=$S($P(VAPA(7),"^",1)="":"   ",FBST="  ":"   ",$D(^DIC(5,$P(VAPA(5),"^"),1,$P(VAPA(7),"^"),0)):$P(^(0),"^",3),1:"   ")
	S FBZIP=$S('+$G(VAPA(11)):VAPA(6),+VAPA(11):$P(VAPA(11),U),1:VAPA(6)),FBZIP=$TR(FBZIP,"-","")_$E("000000000",$L(FBZIP)+1,9)
	I $L(FBCTY)'=3 S FBCTY=$E("000",$L(FBCTY)+1,3)_FBCTY
	S FBDIN=$E(FBDIN,4,7)_$E(FBDIN,2,3),FBINVN=$E("000000000",$L(FBINVN)+1,9)_FBINVN,FBFLNAM=$E(FBFLNAM,1,11)
	S:FBPAYT="R" FBVID=$E(PAD,1,11)
	D STRING^FBAAV01
	Q
UPD	N Y S DA=J,(DIC,DIE)="^FBAA(161.7,",DR="11////^S X=""T"";12////^S X=DT" D ^DIE Q
STORE	D STORE^FBAAV01 Q

FBAAV01
FBAAV01	;AISC/GRR-ELECTRONICALLY TRANSMIT FEE DATA CONTINUED ;17MAR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
NEWMSG	;get new message number, reset line counter
	;FBLN=line counter, FBFEE=FEE message counter, FBNVP=NVP message counter
	;FBOKTX=1 if message pending, 0 otherwise
	S FBXMZ=0,FBJ=$G(J),FBK=$G(K) S:'$D(FBFEE) FBFEE=1 S:'$D(FBNVP) FBNVP=1
	S XMSUB=$S('$D(FBFLAG):"FEE BASIS MESSAGE # "_FBFEE,1:"FEE NON-VA HOSP TO PRICER MESSAGE # "_FBNVP),XMDUZ=DUZ
	S FBOKTX=0
	D XMZ^XMA2
	I '$D(XMZ)!(XMZ'>0) G NEWMSG
	S FBXMZ=XMZ,FBLN=0,FBOKTX=1,J=FBJ,K=FBK K XMZ
	Q
	;
XMIT	;send message, increment message counter
	;FBLN=line counter, FBFEE=FEE message counter, FBNVP=NVP message counter
	;FBXMFEE(=FEE recipient array, FBXMNVP(=NVP recipient array
	S FBJ=J,FBK=K K XMY D ROUT
	S XMZ=FBXMZ,^XMB(3.9,XMZ,2,0)="^3.92A^"_FBLN_"^"_FBLN_"^"_DT
	S XMDUN=$P(^VA(200,DUZ,0),U) D ENT1^XMD
	S FBLN=0,FBOKTX=0
	D INCRM ;increment message counter
	S J=FBJ,K=FBK
	Q
	;
ROUT	;set up recipients for message
	I $D(FBFLAG) S FBI=0 F  S FBI=$O(FBXMNVP(FBI)) Q:'FBI  S X=FBXMNVP(FBI),XMN=0,XMDF="" D INST^XMA21 K XMN,XMDF
	I '$D(FBFLAG) S FBI=0 F  S FBI=$O(FBXMFEE(FBI)) Q:'FBI  S X=FBXMFEE(FBI),XMN=0,XMDF="" D INST^XMA21 K XMN,XMDF
	S XMY(DUZ)="",XMDUZ=DUZ Q
	;
INCRM	;increment message counter
	I $D(FBFLAG) S FBNVP=FBNVP+1
	E  S FBFEE=FBFEE+1
	Q
	;
INCRL	;increment line counter
	S FBLN=FBLN+1 Q
	;
STORE	;set message string
	D INCRL S ^XMB(3.9,FBXMZ,2,FBLN,0)=FBSTR
	Q
	;
ADDRESS	;set up recipient array, FBXMFEE( for FEE router, FBXMNVP( for NVP router
	F VATNAME="FEE","NVP" D ^VATRAN G:VATERR ADDQ S FBI=0 F  S FBI=$O(VAT(FBI)) Q:'FBI  S FBVAR="FBXM"_VATNAME_"("_FBI_")" S @FBVAR=VAT(FBI)
ADDQ	Q
	;Following checks for Austin Name Field in Vendor file in order to continue transmitting that batch.
CKB3V	F FB1=0:0 S FB1=$O(^FBAAC("AC",J,FB1)) Q:'FB1!($G(FBERR))  F FB2=0:0 S FB2=$O(^FBAAC("AC",J,FB1,FB2)) Q:FB2'>0!($G(FBERR))  D CHKV
	Q
CKB5V	F FB1=0:0 S FB1=$O(^FBAA(162.1,"AE",J,FB1)) Q:'FB1!($G(FBERR))  I $G(^FBAA(162.1,FB1,0)) S FB2=+$P(^(0),"^",4) D CHKV
	Q
CKB9V	F FB1=0:0 S FB1=$O(^FBAAI("AC",J,FB1)) Q:'FB1!($G(FBERR))  I $G(^FBAAI(FB1,0)) S FB2=+$P(^(0),"^",3) D CHKV
	Q
CHKV	I $$CKVEN^FBAADV(FB2) W !!,*7,"VENDOR: ",$$VNAME^FBNHEXP(FB2)," Not approved in Austin yet.",!,"Batch # ",FBAABN," CANNOT BE TRANSMITTED!!!" S FBERR=1
	Q
	;
STRING	;called from FBAAV0 to build 'B3' payment record
	;
	;N X S X=0,$P(X,0,30)=0,FBPICN=$E(X,$L(FBPICN)+1,30)_FBPICN
	S FBPICN=$$PADZ(FBPICN,30)
	S FBSTR=3_FBAASN_FBSSN_FBPAYT_FBFI_FBMI_FBFLNAM_FBVID_"  "_FBAP_FBAAON_FBSUSP_FBPOV_FBPATT_FBTD_FBTT_FBDIN_FBINVN_FBST_FBCTY_FBZIP_$E(FBPSA,1,3)_FBCPT_FBPOS_FBHCFA_FBVTOS_FBPD
	I $$VER5^FBAAUTL3() S FBSTR=FBSTR_+$P($G(FBY),U,2)_$E(PAD,1,6)_FBPICN_$S(+FBY:$$AUSDT^FBAAV3(+FBY),1:FBDIN)_"$"
	I '$$VER5^FBAAUTL3() S FBSTR=FBSTR_"0"_$E(PAD,1,6)_"$"
	D STORE K FBPICN,FBY
	Q
	;
PADZ(X,Y)	;call to pad 'X' with leading zeros' to a field length of 'Y'
	;
	I $S('$L(X):1,'Y:1,Y<$L(X):1,1:0) Q ""
	N Z S Z=0,$P(Z,0,Y)=0
	Q $E(Z,$L(X)+1,Y)_X

FBAAV1
FBAAV1	;AISC/GRR-ELECTRONICALLY TRANSMIT FEE (VENDOR MRA'S) PART 2 ;19MAR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S (ZMCNT,ZPCNT,FB("M"),FB("P"))=0
	;D STATION^FBAAUTL,HD^FBAAUTL Q:$D(FB("ERROR"))
	S FBTXT=0
	F J="O","P" I $D(^FBAA(161.25,"AE",J)) F K=0:0 S K=$O(^FBAA(161.25,"AE",J,K)) Q:K'>0  S FBTC=$G(^FBAA(161.25,K,0)),FBTC=$S(FBTC']"":"N",J="P":$P(FBTC,U,2),J="O":$P(FBTC,U,3),1:"N") S Y(0)=$G(^FBAAV(K,0)) I Y(0)]"" D
	.S Y(1)=$G(^FBAAV(K,"ADEL")),Y(2)=$G(^FBAAV(K,"AMS"))
	.I 'FBTXT S FBTXT=1 D NEWMSG^FBAAV01
	.D GOT
	D:+$G(FBOKTX) XMIT^FBAAV01 Q
GOT	S FBNAME=$P(Y(0),"^",1),FBNAME=$S(FBNAME[",":$E($P(FBNAME,",",2),1)_" "_$E($P(FBNAME,",",2),$F($P(FBNAME,",",2)," "))_$S($F($P(FBNAME,",",2)," "):" ",1:"  ")_$P(FBNAME,",",1),1:FBNAME)
	S FBNAME=$S($L(FBNAME)<30:FBNAME_$E(PAD,$L(FBNAME)+1,30),1:$E(FBNAME,1,30)),FBID=$P(Y(0),"^",2),FBID=FBID_$E(PAD,$L(FBID)+1,11),FBPART=$P(Y(0),"^",7),FBSN=FBSN_$E("      ",$L(FBSN)+1,6)
	S FBSC=$S($P(Y(0),"^",8)]"":$P(Y(0),"^",8),1:"  "),FBSC=$S(FBSC="  ":FBSC,$D(^FBAA(161.6,FBSC,0)):$P(^(0),"^",2),1:"  "),FBTC=$S(FBTC]"":FBTC,1:"N"),OCDT=$S(Y(1)]"":$P(Y(1),"^",2),1:"")
	S FBPC=$S($P(Y(0),"^",9)]"":$P(Y(0),"^",9),1:"  "),FBPC=$S(FBPC="  ":FBPC,$D(^FBAA(161.81,FBPC,0)):$P(^(0),"^",2),1:"  ")
	S FBTC=$S(FBTC="N":"A",1:FBTC),FBAD=$P(Y(0),"^",3),FBAD=FBAD_$E(PAD,$L(FBAD)+1,30),FBAD1=$P(Y(0),"^",14),FBAD1=FBAD1_$E(PAD,$L(FBAD1)+1,30),FBCITY=$E($P(Y(0),"^",4),1,19),FBCITY=FBCITY_$E(PAD,$L(FBCITY)+1,19)
	S FBSTCD=$P(Y(0),"^",5),FBSTATE=$S(FBSTCD']"":"  ",$D(^DIC(5,FBSTCD,0)):$P(^(0),"^",2),1:"  "),FBSTATE=$S($L(FBSTATE)'=2:"  ",1:FBSTATE),FBZIP=$P(Y(0),"^",6),FBZIP=$TR(FBZIP,"-","")_$E("000000000",$L(FBZIP)+1,9)
	S FBMRC=$P(Y(0),"^",18),FBMRC=$S(FBMRC]"":FBMRC,1:"  "),FBCHAIN=$P(Y(0),"^",10),FBCHAIN=$E("0000",$L(FBCHAIN)+1,4)_FBCHAIN
	S STCC=$P(Y(0),"^",13),FBCC="000" I STCC]"",FBSTCD]"" S FBCC=$S($D(^DIC(5,FBSTCD,1,STCC,0)):$P(^(0),"^",3),1:"000")
	S FBCC=$E("000",$L(FBCC)+1,3)_FBCC,FBRT=$S(J="P":4,1:1),FBICN=$E(FBSN,1,3)_K,FBICN=$E("000000000000000",$L(FBICN)+1,15)_FBICN,FBTID=$P(Y(2),"^",6),FBTID=$S(FBTID]"":FBTID,1:"T"),FBFMST=$P(Y(2),"^",4),FBFMST=$S(FBFMST]"":FBFMST,1:"C")
	D SETP:J="P",SETM:J="O",UPDT
	;S ^FBAA(161.25,"AD","T",K)="",$P(^FBAA(161.25,K,0),"^",3)="T" K ^FBAA(161.25,"AD",J,K)
	D STORE Q
SETM	S ZMCNT=ZMCNT+1 D:FB("M")=0!(ZMCNT>100) BHEDM S FBSTR=FBRT_FBTC_FBSN_FBID_"  "_$S(FBTC="D"!(FBTC="R"):"$",1:"1"_FBSC_FBPC_FBNAME_FBAD_FBAD1_FBCITY_FBSTATE_FBZIP_FBMRC_FBCC_"B"_FBTID_"Y"_FBFMST_FBICN_"$")
	Q
SETP	S ZPCNT=ZPCNT+1 D:FB("P")=0!(ZPCNT>100) BHEDP S FBSTR=FBRT_FBTC_FBSN_$E(FBID,1,9)_FBCHAIN_$S(FBTC="D"!(FBTC="R"):"$",1:"1"_FBNAME_FBAD_FBAD1_FBCITY_FBSTATE_FBZIP_FBMRC_FBCC_"B"_FBTID_"Y"_FBFMST_FBICN_"$")
	Q
BHEDM	S BTYPE="M" D GETB S FB("M")=1,FBSTR=FBHD_"C1"_$E(DT,4,7)_$E(DT,2,3)_FBSN_FBZBNM_"$" D STORE S ZMCNT=1 Q
BHEDP	S BTYPE="P" D GETB S FB("P")=1,FBSTR=FBHD_"C4"_$E(DT,4,7)_$E(DT,2,3)_FBSN_FBZBNP_"$" D STORE S ZPCNT=1 Q
UPDT	L +^FBAA(161.25,K) K ^FBAA(161.25,"AE",J,K)
	;I $D(^FBAA(161.25,"AE",$S(J="P":"O",1:"P"),K)) S $P(^FBAA(161.25,K,0),"^",3)="N" L -^FBAA(161.25,K) Q  ;commented out since don't know why it is set
	;K:OCDT]"" ^FBAAV("AC",OCDT,K) S $P(^FBAAV(K,0),"^",15)=DT,^FBAAV("AC",DT,K)="" L -^FBAA(161.25,K)
	S DA=K,(DIC,DIE)="^FBAA(161.25,",DR="4///^S X=DT" D ^DIE L -^FBAA(161.25,K)
	S DIE="^FBAAV(",DA=K,DR="12///^S X=DT" D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAAV(DA)
	K DA,DIE,DR,FBLOCK Q
GETB	D GETNXB^FBAAUTL
	I BTYPE="M" S FBZBNM=$E("00000",$L(FBBN)+1,5)_FBBN Q
	I BTYPE="P" S FBZBNP=$E("00000",$L(FBBN)+1,5)_FBBN
	Q
STORE	I TOTSTR+$L(FBSTR)>13900!(ZMCNT>100)!(ZPCNT>100) S TOTSTR=0 D XMIT^FBAAV01,NEWMSG^FBAAV01 S FBTMP=FBSTR D BHEDM:J="O",BHEDP:J="P" S FBSTR=FBTMP K FBTMP
	S TOTSTR=TOTSTR+$L(FBSTR) D STORE^FBAAV01
	Q
KILL	K FBATCH,FBCHB,J,K,L,M,N,FBAABN,FBAAON,FBAASN,FBAACP,FBAACD,FBAABT,FBAAAP,FBSTR,PAD,PAD1,FBPAYT,FBVID,FBPOV,FBTT,FBPATT,FBTD,FBSUSP,FBAP,FBEXMPT,FBFNI,FBFNY,^TMP($J)
	K A,FBTYPE,DO,DI,DIC,DIE,DOD,DQ,ER,FBADD,FBAUTH,FBBD,FBBN,FBCHAIN,FBFDC,FBFLNAM,FBFR,FBLNAM,FBMST,FBRECT,FBRT,FBSEX,FBSTAT,FBSTCD,FBTC,FBTO,BTYPE,POS,POV,POW,STCC,STCD,T,TOTSTR,XMKK,XMLOCK,XMR,XMSUB,XMT,XMTEXT,XMZ,ZMCNT,ZPCNT
	K FBINVN,FBDIN,FBSSN,FBNAME,FBLNAME,FBFI,FBMI,XMDUZ,DA,DR,X,Y,FBPART,FBC,FBSN,FBID,FEEO,FBSC,FBPC,FBAD,FBCITY,FBSTATE,FBZIP,FBCC,FBZBN,FBZBNM,FBZBNP,FB,D,Z,Q,VAT,VATERR,VATNAME,FBSDI
	K FBCTY,FBDX,FBFTD,FBPRC,FBPSA,FBST,OCDT,X1,X2,FB7078,FBBILL,FBCLAIM,FBCTY,FBDISP,FBDOB,FBFDT,FBJ,FBLOS,FBMED,FBPART1,FBSTABR,FBTDT,FBTTD,FBVEN,PAD,VAPA,FBSITE,FBK
	K FB0,FBFEE,FBHD,FBI,FBLN,FBNVP,FBOKTX,FBTXT,FBVAR,FBXMFEE,FBXMNVP,FBXMZ,XMDUN,FBRESUB,FBAD1,FBFMST,FBICN,FBMRC,FBTID,FBPOP,FBCPT,FBHCFA,FBPD,FBPOS,FBVTOS,FBAC,FBCSN,FBRX,FBVFN
	Q

FBAAV2
FBAAV2	;AISC/GRR-ELECTRONICALLY TRANSMIT PHARMACY PAYMENTS ;02MAR86 
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DETP	; ENTRY FROM FBAAV0
	S FBTXT=0
	D CKB5V^FBAAV01 I $G(FBERR) K FBERR Q
	F K=0:0 S K=$O(^FBAA(162.1,"AE",J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAA(162.1,"AE",J,K,L)) Q:L'>0  S Y(0)=$G(^FBAA(162.1,K,"RX",L,0)),Y(2)=$G(^(2)),Y=$G(^FBAA(162.1,K,0)) I Y(0)]"",Y]"",+$P(Y(0),U,16) D
	.S FBPICN=K_U_L
	.S FBY=$S($P(Y,U,12):$P(Y,U,12),1:$P(Y,U,2))_U_+$P(Y(2),U,9)
	.I 'FBTXT S FBTXT=1 D NEWMSG^FBAAV01,STORE^FBAAV01,UPD^FBAAV0
	.D GOTP
	D:FBTXT XMIT^FBAAV01 Q
GOTP	S FBPAYT=$P(Y(0),"^",20),FBPAYT=$S(FBPAYT]"":FBPAYT,1:"V"),FBVFN=$P(Y,"^",4),FBINVN=$P(Y,"^"),FBDIN=$P(Y,"^",2),FBVID=$P($G(^FBAAV(FBVFN,0)),U,2)
	S FBCSN=$S(FBVID]"":$P(^(0),"^",10),1:""),FBCSN=$E("0000",$L(FBCSN)+1,4)_FBCSN,FBRX=$P(Y(0),"^",1),FBRX=$E("00000000",$L(FBRX)+1,8)_FBRX
	I '$L($G(FBAASN)) D STATION^FBAAUTL
	S FBPSA=$P(Y(2),"^",5),FBPSA=$S(FBPSA="":FBAASN,$D(^DIC(4,+FBPSA,99)):$E($P(^(99),"^",1),1,3),1:FBAASN)
	S FBVID=$E(FBVID,1,9)_$E(PAD,$L(FBVID)+1,9)
	S FBTD=$P(Y(0),"^",3),FBTD=$S(FBTD]"":$$AUSDT^FBAAV3(FBTD),1:"      "),FBSUSP=$P(Y(0),"^",8),FBSUSP=$S(FBSUSP="":" ",$D(^FBAA(161.27,+FBSUSP,0)):$P(^(0),"^"),1:" ")
	S FBAC=$P(Y(0),"^",4)+.00001,FBAC=$P(FBAC,".",1)_$E($P(FBAC,".",2),1,2),FBAC=$E("00000000",$L(FBAC)+1,8)_FBAC,FBAP=$P(Y(0),"^",16)+.00001,FBAP=$P(FBAP,".",1)_$E($P(FBAP,".",2),1,2),FBAP=$E("00000000",$L(FBAP)+1,8)_FBAP
	S FBDIN=$$AUSDT^FBAAV3(FBDIN),FBINVN=$E("000000000",$L(FBINVN)+1,9)_FBINVN,DFN=$P(Y(0),"^",5) Q:'$D(^DPT(+DFN,0))  S VAPA("P")="",Y(0)=^(0) D PAT^FBAAUTL2,ADD^VADPT
	S FBFLNAM=$E(FBFLNAM,1,11)
	S FBST=$S($P(VAPA(5),"^")="":"  ",$D(^DIC(5,$P(VAPA(5),"^"),0)):$P(^(0),"^",2),1:"  "),FBCTY=$S($P(VAPA(7),"^")="":"   ",FBST="  ":"   ",$D(^DIC(5,$P(VAPA(5),"^"),1,$P(VAPA(7),"^"),0)):$P(^(0),"^",3),1:"   ")
	I $L(FBCTY)'=3 S FBCTY=$E("000",$L(FBCTY)+1,3)_FBCTY
	S FBZIP=$S('+$G(VAPA(11)):VAPA(6),+VAPA(11):$P(VAPA(11),U),1:VAPA(6)),FBZIP=$TR(FBZIP,"-","")_$E("000000000",$L(FBZIP)+1,9)
	I FBAC=FBAP S FBAP="        "
	I FBPAYT="R" S FBVID=$E(PAD,1,9),FBCSN=$E(PAD,1,4)
	S FBSTR=5_FBAASN_FBSSN_FBPAYT_FBFI_FBMI_FBFLNAM_FBVID_FBCSN_FBAC_FBAP_FBAAON_FBSUSP_FBTD_FBRX_FBDIN_FBINVN_FBST_FBCTY_FBZIP_$E(FBPSA,1,3)
	I '$$VER5^FBAAUTL3() S FBSTR=FBSTR_"0"_$E(PAD,1,6)_"$"
	I $$VER5^FBAAUTL3() S FBSTR=FBSTR_$P(FBY,U,2)_$E(PAD,1,6)_$$PADZ^FBAAV01(FBPICN,30)_$$AUSDT^FBAAV3(+FBY)_"$"
	D STORE^FBAAV01 K FBPICN,FBY
	Q

FBAAV3
FBAAV3	;AISC/GRR-CREATE & ELECTRONICALLY TRANSMIT TRANSACTIONS FOR TRAVEL PAYMENTS ;08APR86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DETT	S FBTXT=0
	F K=0:0 S K=$O(^FBAAC("AD",J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AD",J,K,L)) Q:L'>0  S Y(0)=$G(^FBAAC(K,3,L,0)) I Y(0)]"",+$P(Y(0),U,3) D
	.S FBPICN=K_U_L
	.I 'FBTXT S FBTXT=1 D NEWMSG^FBAAV01,STORE^FBAAV01,UPD^FBAAV0
	.D GOT
	D:FBTXT XMIT^FBAAV01 Q
GOT	S FBTD=$$AUSDT($P(Y(0),U)),FBAP=$P(Y(0),"^",3)+.00001,FBAP=$P(FBAP,".",1)_$E($P(FBAP,".",2),1,2),FBAP=$E("00000000",$L(FBAP)+1,8)_FBAP
	S DFN=K Q:'DFN  Q:'$D(^DPT(DFN,0))  S Y(0)=^(0) D PAT^FBAAUTL2
	S FBFLNAM=$E(FBFLNAM,1,11)
	S FBSTR="T"_FBAASN_FBSSN_"T"_FBFI_FBMI_FBFLNAM_FBAP_FBAAON_FBTD_"0"_$E(PAD,1,6)
	I '$$VER5^FBAAUTL3() S FBSTR=FBSTR_"$"
	I $$VER5^FBAAUTL3() S FBSTR=FBSTR_$$PADZ^FBAAV01(FBPICN,30)_FBTD_"$"
	D STORE^FBAAV01 K FBPICN
	Q
	;
AUSDT(X)	;called to format date from internal to MMDDYY
	;
	I '$G(X) Q ""
	Q $E(X,4,7)_$E(X,2,3)

FBAAV4
FBAAV4	;AISC/GRR-ELECTRONICALLY TRANSMIT PATIENT MRA'S ;02MAY86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;D STATION^FBAAUTL,HD^FBAAUTL Q:$D(FB("ERROR"))
	S FBTXT=0,ZMCNT=1
GO	S J=0 F  S J=$O(^FBAA(161.26,"AC","P",J)) Q:J'>0  S FB0=$G(^FBAA(161.26,J,0)),Y(0)=$G(^DPT(J,0)) I FB0]"",Y(0)]"" S FBTYPE=$S($P(FB0,U,4)]"":$P(FB0,U,4),1:"A"),FBFDC=$P(FB0,U,6),FBMST=$P(FB0,U,7) D
	.I 'FBTXT S FBTXT=1 D GETBT,NEWMSG^FBAAV01,STORE^FBAAV01
	.D GOT
	D:+$G(FBOKTX) XMIT^FBAAV01 Q
	;
GETBT	D GETNXB^FBAAUTL
	S FBZBN=$E("00000",$L(FBBN)+1,5)_FBBN,FBSN=FBSN_$E("      ",$L(FBSN)+1,6)
	S FBSTR=FBHD_"C2"_$E(DT,4,7)_$E(DT,2,3)_FBSN_FBZBN_"$" Q
	;
GOT	D PAT^FBAAUTL2
	S DFN=+J
	D DEM^VADPT Q:$G(VAERR)
	S FBBD=$P(VADM(3),"^"),FBBD=$E(FBBD,4,7)_$E(FBBD,2,3)
	S FBBD=$S(FBBD="":"      ",1:FBBD),FBSEX=$P(VADM(5),"^"),FBSEX=$S(FBSEX="F":2,1:1)
	S DOD=$P($P(VADM(6),"^"),".")
	K VADM,VAERR
	;S Y(0)=$S($D(^DPT(J,.11)):^(.11),1:"") Q:Y(0)']""
	;S FBADD=$E($P(Y(0),"^",1),1,21),FBADD=FBADD_$E(PAD,$L(FBADD)+1,21),FBCITY=$E($P(Y(0),"^",4),1,13),FBCITY=FBCITY_$E(PAD,$L(FBCITY)+1,13),FBSTAT="  "
	;S STCD=$P(Y(0),"^",5) I STCD]"" S FBSTAT=$S($D(^DIC(5,STCD,0)):$P(^(0),"^",2),1:"  ")
	S VAPA("P")="" D ADD^VADPT Q:$G(VAERR)
	S FBADD=$E(VAPA(1),1,21),FBADD=FBADD_$E(PAD,$L(FBADD)+1,21)
	S FBCITY=$E(VAPA(4),1,13),FBCITY=FBCITY_$E(PAD,$L(FBCITY)+1,13),FBSTAT="  "
	S STCD=+VAPA(5) I STCD S FBSTAT=$S($D(^DIC(5,STCD,0)):$P(^(0),"^",2),1:"  ")
	S FBZIP=$S('+$G(VAPA(11)):VAPA(6),+VAPA(11):$P(VAPA(11),"^"),1:VAPA(6))
	S FBZIP=$TR(FBZIP,"-","")_$E("000000000",$L(FBZIP)+1,9)
	S STCC=+VAPA(7),FBCC="000" I STCC,STCD S FBCC=$S($D(^DIC(5,STCD,1,STCC,0)):$P(^(0),"^",3),1:"000")
	K VAPA,VAERR
	D ELIG^VADPT
	S POS=$S(+VAEL(2):+VAEL(2),1:"")
	K VAEL,VAERR
	S POS=$S(POS="":8,$D(^DIC(21,POS,0)):$P(^(0),"^",3),1:8)
	S DOD=$S(DOD="":"000000",1:$E(DOD,4,7)_$E(DOD,2,3))
	D SVC^VADPT
	S POW=$S(+VASV(4):+VASV(4),1:""),POW=$S(POW="":2,POW=1:1,1:2)
	D KVAR^VADPT
	S FBAUTH=$P(^FBAA(161.26,J,0),"^",3) Q:FBAUTH']""  Q:'$D(^FBAAA(J,1,FBAUTH,0))  S Y(0)=^(0)
	S FBFR=$P(Y(0),"^"),FBTO=$P(Y(0),"^",2),POV=$P(Y(0),"^",7),POV=$S(POV="":"",$D(^FBAA(161.82,POV,0)):$P(^(0),"^",3),1:""),POV=$S(POV]"":POV,1:"05"),FBTT=$P(Y(0),"^",13),FBTT=$S(FBTT]"":FBTT,1:1)
	S FBRECT=$S(FBTT=2:"S",$G(POV)>29&($G(POV)<50):"C",1:2),FBFR=$E(FBFR,4,7)_$E(FBFR,2,3),FBTO=$E(FBTO,4,7)_$E(FBTO,2,3) I FBTYPE="C" S FBTO=$S(FBFDC=1:"      ",1:FBTO)
	I FBTT=2,POV>73!(POV<70) S POV=71
	S ZMCNT=ZMCNT+1 I ZMCNT>100 D GETBT,STORE S ZMCNT=ZMCNT+1
	I FBTYPE="D"!(FBTYPE="R") S FBRECT=$S(FBTT=2:"S",$G(POV)=31:"C",1:2),FBSTR=FBRECT_FBTYPE_FBSN_FBSSN_"$" D ZAP Q:FBTYPE="D"  S FBTYPE="C"
	S FBTT=$S(FBMST="Y":0,1:FBTT),FBSTR=FBRECT_FBTYPE_FBSN_FBSSN_FBFI_FBMI_FBFLNAM_FBADD_FBCITY_FBSTAT_FBZIP_FBFR_FBTO_FBCC_FBBD_POV_" "_FBTT_FBSEX_POW_DOD_" "_POS_"$"
ZAP	D STORE
	S DA=J,(DIC,DIE)="^FBAA(161.26,",T="T",DR="1///^S X=T;4///^S X=DT" D ^DIE
	Q
SKIP	S FBRECT=$S(FBTT=2:"S",1:2),FBSTR=FBRECT_FBTYPE_FBSN_FBSSN_"$" G ZAP
STORE	I ZMCNT>100 D XMIT^FBAAV01,NEWMSG^FBAAV01 S ZMCNT=1
	D STORE^FBAAV01
	Q

FBAAV5
FBAAV5	;AISC/GRR-CREATE TRANSACTIONS FOR CH/CNH PAYMENTS; 25APR89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D CKB9V^FBAAV01 I $G(FBERR) K FBERR Q
	G:FBSTAT="S"&(FBCHB="Y")&($P(Y(0),"^",18)'="Y") ^FBAAV6
DETCH	S FBTXT=0
	F K=0:0 S K=$O(^FBAAI("AC",J,K)) Q:K'>0  S Y(0)=$G(^FBAAI(K,0)),Y(2)=$G(^(2)) I Y(0)]"",+$P(Y(0),U,9) D
	.S FBPICN=K
	.S FBY=$S($P(Y(2),U,2):$P(Y(2),U,2),1:$P(Y(0),U,2))_U_+$P(Y(2),U,3)
	.I 'FBTXT S FBTXT=1 D NEWMSG^FBAAV01,STORE^FBAAV01,UPD^FBAAV0
	.D GOT
	D:FBTXT XMIT^FBAAV01 Q
GOT	I '$L($G(FBAASN)) D STATION^FBAAUTL
	S FBPSA=$P(Y(0),"^",20),FBPSA=$S(FBPSA="":+FBAASN,$D(^DIC(4,+FBPSA,99)):$E($P(^(99),"^",1),1,3),1:+FBAASN)
	S FBPAYT=$P(Y(0),"^",13),FBPAYT=$S(FBPAYT]"":FBPAYT,1:"V"),L=$P(Y(0),"^",3),FBVID=$S($D(^FBAAV(L,0)):$P(^(0),"^",2),1:""),FBVMID=$S($D(^FBAAV(L,0)):$P(^(0),"^",17),1:""),FBVMID=$E(PAD,$L(FBVMID)+1,6)_FBVMID,POV=$P(Y(0),"^",18)
	S POV=$S(POV']"":"",POV="A":6,POV="B":7,POV="C":8,POV="D":9,POV="E":10,1:POV),POV=$S(POV']"":40,$D(^FBAA(161.82,POV,0)):$P(^(0),"^",3),1:40),FBPOV=POV
	S FBVID=FBVID_$E(PAD,$L(FBVID)+1,11)
	S FBPATT=$P(Y(0),"^",19),FBPATT=$S(FBPATT]"":FBPATT,1:10),FBFTD=$P(Y(0),"^",6),FBTTD=$P(Y(0),"^",7),FBFTD=$S(FBFTD]"":$E(FBFTD,4,7)_$E(FBFTD,2,3),1:"      ")
	S FBTTD=$S(FBTTD]"":$E(FBTTD,4,7)_$E(FBTTD,2,3),1:"      "),FBSUSP=$P(Y(0),"^",11),FBSUSP=$S(FBSUSP="":" ",$D(^FBAA(161.27,FBSUSP,0)):$P(^(0),"^",1),1:" ")
	S FBINVN=$P(Y(0),"^",1),FBDIN=$P(Y(0),"^",2),DFN=$P(Y(0),"^",4),FBDIN=$E(FBDIN,4,7)_$E(FBDIN,2,3),FBINVN=$E("000000000",$L(FBINVN)+1,9)_FBINVN
	S:FBPAYT="R" FBVID=$E(PAD,1,11) S FBAP=$P(Y(0),"^",9)+.00001,FBAP=$P(FBAP,".",1)_$E($P(FBAP,".",2),1,2),FBAP=$E("00000000",$L(FBAP)+1,8)_FBAP
	S FBAC=$P(Y(0),"^",8)+.00001,FBAC=$P(FBAC,".",1)_$E($P(FBAC,".",2),1,2),FBAC=$E("00000000",$L(FBAC)+1,8)_FBAC,FBPA=$P(Y(0),"^",26)+.00001,FBPA=$P(FBPA,".",1)_$E($P(FBPA,".",2),1,2),FBPA=$E("00000000",$L(FBPA)+1,8)_FBPA
	S FBDRG=$P(Y(0),"^",24),FBDRG=$E(PAD,$L(FBDRG)+1,4)_FBDRG
	K FBDX,FBPRC F I=1:1:5 S (FBDX(I),FBPRC(I))="       "
	I $D(^FBAAI(K,"DX")) S Y("DX")=^("DX") F M=1:1:5 Q:$P(Y("DX"),"^",M)=""  S FBDX(M)=$S($D(^ICD9($P(Y("DX"),"^",M),0)):$P(^(0),"^",1),1:"       ") I $L(FBDX(M))<7 S FBDX(M)=$E(PAD,$L(FBDX(M))+1,7)_FBDX(M)
	I $D(^FBAAI(K,"PROC")) S Y("PROC")=^("PROC") F M=1:1:5 Q:$P(Y("PROC"),"^",M)=""  S FBPRC(M)=$S($D(^ICD0($P(Y("PROC"),"^",M),0)):$P(^(0),"^",1),1:"       ") I $L(FBPRC(M))<7 S FBPRC(M)=$E("       ",$L(FBPRC(M))+1,7)_FBPRC(M)
	S VAPA("P")="",Y(0)=$S($D(^DPT(DFN,0)):^(0),1:"") D PAT^FBAAUTL2,ADD^VADPT
	S FBST=$S($P(VAPA(5),"^",1)="":"  ",$D(^DIC(5,$P(VAPA(5),"^",1),0)):$P(^(0),"^",2),1:"  "),FBCTY=$S($P(VAPA(7),"^",1)="":"   ",FBST="  ":"   ",$D(^DIC(5,$P(VAPA(5),"^",1),1,$P(VAPA(7),"^",1),0)):$P(^(0),"^",3),1:"   ")
	I $L(FBCTY)'=3 S FBCTY=$E("000",$L(FBCTY)+1,3)_FBCTY
	S FBZIP=$S('+$G(VAPA(11)):VAPA(6),+VAPA(11):$P(VAPA(11),U),1:VAPA(6)),FBZIP=$TR(FBZIP,"-","")_$E("000000000",$L(FBZIP)+1,9),FBFLNAM=$E(FBFLNAM,1,11)
	S FBSTR=9_FBAASN_FBSSN_FBPAYT_FBFI_FBMI_FBFLNAM_FBVID_"  "_FBAP_FBAAON_FBSUSP_FBPOV_FBPATT_FBFTD_FBTTD_FBDIN_FBINVN_FBVMID_FBST_FBCTY_FBZIP_FBPSA_$P(FBY,U,2)_$E(PAD,1,12)
	F I=1:1:5 S FBSTR=FBSTR_FBDX(I)
	I '$$VER5^FBAAUTL3() S FBSTR=FBSTR_$E(PAD,1,29)
	I $$VER5^FBAAUTL3 S FBSTR=FBSTR_$$PADZ^FBAAV01(FBPICN,23)_$$AUSDT^FBAAV3(+FBY)
	F I=1:1:5 S FBSTR=FBSTR_FBPRC(I)
	S FBSTR=FBSTR_FBAC_FBPA_FBDRG_" "_"$"
	D STORE^FBAAV01 K FBY,FBPICN
	Q

FBAAV6
FBAAV6	;AISC/GRR-CREATE TRANSACTIONS TO SEND TO PRICER SYSTEM ;4/28/93  10:59
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBFLAG=1,FBTXT=0
	S FBSTAT="P",FBJ=J D UPDT^FBAAUTL2 S J=FBJ F K=0:0 S K=$O(^FBAAI("AC",J,K)) Q:K'>0  S Y(0)=$G(^FBAAI(K,0)) I Y(0)]"" D
	.I 'FBTXT S FBTXT=1 D NEWMSG^FBAAV01
	.D GOT
	D:FBTXT XMIT^FBAAV01 K FBFLAG Q
GOT	S FBPAYT=$P(Y(0),"^",13),FBPAYT=$S(FBPAYT]"":$S(FBPAYT="R":"P",1:FBPAYT),1:"V"),FBVID=$P(Y(0),"^",3),FBVEN=FBVID I FBVID]"" S FBVID=$S($D(^FBAAV(FBVID,0)):$P(^(0),"^",17),1:$E(PAD,1,6))
	S:FBVID']"" FBVID=$E(PAD,1,6)
	S FB7078=$P(Y(0),"^",5) I FB7078]"" D
	.I FB7078["FB7078(",$D(^FB7078(+FB7078,0)) S FBFNY=^FB7078(+FB7078,0),FBFDT=$S($P(FBFNY,"^",15):$P(FBFNY,"^",15),1:$P(FBFNY,"^",4)),FBTDT=$S($P(FBFNY,"^",16):$P(FBFNY,"^",16),1:$P(FBFNY,"^",5))
	.I FB7078["FB583(",$D(^FB583(+FB7078,0)) S FBFNY=^FB583(+FB7078,0),FBFDT=$S($P(FBFNY,"^",5)]"":$P(FBFNY,"^",5),1:$P(FBFNY,"^",13)),FBTDT=$S($P(FBFNY,"^",6)]"":$P(FBFNY,"^",6),1:$P(FBFNY,"^",14))
	S X1=FBTDT,X2=FBFDT D ^%DTC S FBLOS=$S(X<1:1,1:X),FBFDT=$E(FBFDT,4,7)_($E(FBFDT,1,3)+1700)
	S FBTDT=$E(FBTDT,4,7)_($E(FBTDT,1,3)+1700),FBLOS=$E("000",$L(FBLOS)+1,3)_FBLOS,FBRESUB=+$P(Y(0),"^",25)
	S FBDISP=$P(Y(0),"^",21) I FBDISP]"" S FBDISP=$S($D(^FBAA(162.6,FBDISP,0)):$P(^(0),"^",2),1:"00")
	S FBDISP=$E("00",$L(FBDISP)+1,2)_FBDISP,FBBILL=$P(Y(0),"^",22)+.00001,FBBILL=$P(FBBILL,".",1)_$E($P(FBBILL,".",2),1,2),FBBILL=$E("00000000",$L(FBBILL)+1,8)_FBBILL
	S FBCLAIM=$P(Y(0),"^",8)+.00001,FBCLAIM=$P(FBCLAIM,".",1)_$E($P(FBCLAIM,".",2),1,2),FBCLAIM=$E("00000000",$L(FBCLAIM)+1,8)_FBCLAIM
	S FBSTAT=$S(FBVEN']"":"",$D(^FBAAV(FBVEN,0)):$P(^(0),"^",5),1:"")
	S FBSTABR=$S(FBSTAT']"":"  ",$D(^DIC(5,FBSTAT,0)):$P(^(0),"^",2),1:"  "),FBSTABR=$E("  ",$L(FBSTABR)+1,2)_FBSTABR,FBAUTH=""
	I FB7078]"" S FBAUTH=$S(FB7078["FB583(":" ",$D(^FB7078(+FB7078,0)):$P(^(0),"^",6),1:" ")
	S FBAUTH=$$AUTH(FBAUTH)
	S DFN=+$P(Y(0),"^",4),FBMED=$P(Y(0),"^",23),FBMED=$S(FBMED="":"N",1:FBMED),Y(0)=$G(^DPT(DFN,0)) D PAT^FBAAUTL2 S FBLNAM=$E(FBFLNAM,1,12),FBSSN=$E(FBSSN,10)_$E(FBSSN,1,9)_" "
	K FBDX,FBPRC F I=1:1:5 S (FBDX(I),FBPRC(I))="       "
	I '$D(^FBAAI(K,"DX")) G OVR
	S Y("DX")=^("DX") F M=1:1:5 Q:$P(Y("DX"),"^",M)=""  S FBDX(M)=$S($D(^ICD9($P(Y("DX"),"^",M),0)):$P(^(0),"^",1),1:FBDX(M)),FBDX(M)=$S(FBDX(M)'[".":FBDX(M),1:$P(FBDX(M),".",1)_$P(FBDX(M),".",2)),FBDX(M)=FBDX(M)_$E(PAD,$L(FBDX(M))+1,7)
OVR	I '$D(^FBAAI(K,"PROC")) G OVR2
	S Y("PROC")=^("PROC") F M=1:1:3 Q:$P(Y("PROC"),"^",M)=""  S FBPRC(M)=$S($D(^ICD0($P(Y("PROC"),"^",M),0)):$P(^(0),"^",1),1:FBPRC(M)) D MORE
OVR2	S FBPART1=FBSSN_FBFDT_FBAASN
	S FBSTR=FBPART1_FBRESUB_"1"_FBLNAM_FBFI_FBMI_FBSEX_FBDOB_FBLOS_FBDISP_FBBILL_FBCLAIM_FBAUTH_FBPAYT_FBAACP_FBAAON_"Y" D STORE
	S FBSTR=FBPART1_FBRESUB_"2"_FBVID_FBMED_$E(PAD,1,29)_FBTDT_FBSTABR_FBDX(1) D STORE
	S FBSTR=FBPART1_FBRESUB_"3"_FBDX(2)_FBDX(3)_FBDX(4)_FBDX(5)_FBPRC(1)_FBPRC(2)_FBPRC(3)_"    " D STORE
	Q
STORE	D STORE^FBAAV01 ;S FBLN=FBLN+1,^XMB(3.9,FBXMZ,2,FBLN,0)=FBSTR ;,^TMP($J,"FBPRICER",FBCN3,1,FBCN4,0)=FBSTR
	Q
MORE	S FBPRC(M)=$S(FBPRC(M)'[".":FBPRC(M),1:$P(FBPRC(M),".",1)_$P(FBPRC(M),".",2)),FBPRC(M)=FBPRC(M)_$E(PAD,$L(FBPRC(M))+1,7)
	Q
AUTH(X)	;Function call to provide the Admitting Regulation.
	;X is equal to the internal entry number of the VA Admitting Reg file
	;User is returned with an alpha dependent on the Admitting Reg chosen
	N CFR,FBCFR
	S CFR=$P($G(^DIC(43.4,+X,0)),"^",3) I '$G(CFR) Q "A"
	S FBCFR=$S(CFR="17.50b(a)(1)(i)":"A",CFR="17.50b(a)(1)(iii)":"B",CFR="17.50b(a)(1)(iv)":"C",CFR="17.50b(a)(3)":"H",CFR="17.50b(a)(4)":"D",CFR="17.50b(a)(5)":"E",CFR="17.50b(a)(6)":"F",CFR="17.50b(a)(8)":"G",1:"")
	I FBCFR="" S FBCFR=$S(CFR="17.50b(a)(9)":"I",CFR="17.80(a)(i)":"L",CFR="17.80(a)(iii)":"J",1:"A")
	Q FBCFR

FBAAVD
FBAAVD	;AISC/DMK-DISPLAY/EDIT VENDOR DEMOGRAPHICS ;02MAR93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;FBTEMP set = 1 if called from input template
RDV	;ask vendor
	W ! K DFN,FBRATE S FEEO="",DIC="^FBAAV(",DIC(0)="AEQLM",DLAYGO=161.2 D ^DIC K DIC,DLAYGO G Q:$D(DTOUT)!(X="")!($D(DUOUT)),RDV:Y<0 S DA=+Y
	D NEW:$P(Y,U,3)=1 D EN1
	I $G(DA) W ! I $D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ)) S DIR(0)="Y",DIR("B")="No",DIR("A")="Want to edit data" D ^DIR K DIR I $G(Y) D EDITV
	Q:$G(FBTEMP)
	G RDV
	;
EN1	;display vendor demographics
	;DA = IEN of vendor in file 161.2
	;
	Q:'$G(DA)
	S Z=$G(^FBAAV(DA,0)),V=$G(^(1)),T=$G(^("AMS")),A=$G(^("ADEL"))
	F X=1:1:17 S Z(X)=$P(Z,U,X)
	S FBDEL=$S($P(A,U)="Y":1,1:0),FBAAPN=$P(V,U),FBAAFN=$P(V,U,9)
	;Z=zero node,V=one node,T=ams node,A=adel node
	;
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS W @IOF K IOP
	I +$G(DFN)>0 W !,"Patient Name: ",$P($G(^DPT(DFN,0)),U),?48,"Pt.ID: ",$$SSN^FBAAUTL(DFN),!
	W !?22,"***  VENDOR DEMOGRAPHICS  ***" D
	.I FBDEL W !?19,"==> FLAGGED FOR DELETION <==" Q
	.I $$CKVEN^FBAADV(DA) W !?20,"==> AWAITING AUSTIN APPROVAL <=="
	W !!,$J("Name:",13),?15,$E(Z(1),1,30),?48,"ID Number: ",Z(2)
	W !,$J("Address:",13),?15,Z(3),?48,"Specialty: ",$E($P($G(^FBAA(161.6,+Z(8),0)),U),1,20)
	I Z(14)]"" W !,$J("Address [2]:",13),?15,Z(14)
	W !,$J("City:",13),?15,Z(4),?53,"Type:",?59,$P($P(^DD(161.2,6,0),Z(7)_":",2),";")
	;
	W !,$J("State:",13),?15,$P($G(^DIC(5,+Z(5),0)),U),?39,"Participation Code:",?59,$S($D(^FBAA(161.81,+Z(9),0)):$E($P(^(0),U),1,21),1:"UNKNOWN")
	W !,$J("ZIP:",13),?15,Z(6),?39,"Medicare ID Number:",?59,Z(17)
	W !,$J("County:",13),?15,$P($G(^DIC(5,+Z(5),1,+Z(13),0)),U)
	W ?52,"Chain: ",Z(10),!,$J("Phone:",13),?15,FBAAPN,!,$J("Fax:",13),?15,FBAAFN
	W:$P(T,U,2)="Y" ?44,"Pricer Exempt: Yes"
	W !,$J("Austin Name:",13),?15,$P(T,U)
	W !,$J("Last Change ",13),?44,"Last Change" I $P(A,U,5)]"" W " by ",$S($P(A,U,5)="000":"Non-Fee User",1:"Station "_$P(A,U,5))
	W !,$J("TO Austin:",13),?15,$$DATX^FBAAUTL($P(A,U,2))
	W ?46,"FROM Austin:  ",$$DATX^FBAAUTL($P(A,U,4))
	;
	I Z(9)=5 D ^FBAAVD1
	K A,T,V,Z,FBAAFN
	Q
	;
NEW	;called when adding a new vendor
	Q:'$G(DA)
	S FBT="N",DIE="^FBAAV(",DR="[FBAA NEW VENDOR]" D ^DIE S Y=$G(^FBAAV(DA,0)) S FBOVEN="" D  I +FBOVEN K FBOVEN W ! S DR="3;4;5;5.5" D ^DIE K DIE,DR D CHKVEN Q:'$G(DA)
	.I $P(Y,U,4)']"" S FBOVEN=1
	.I '$P(Y,U,5) S FBOVEN=$S(+FBOVEN:FBOVEN_"^"_2,1:2)
	.I $P(Y,U,6)']"" S FBOVEN=$S(+FBOVEN:FBOVEN_"^"_3,1:3)
	.I $P(Y,U,13)']"" S FBOVEN=$S(+FBOVEN:FBOVEN_"^"_4,1:4)
	.I +FBOVEN D  K XX,X
	..W !!?9,"The following data must be entered when adding a new vendor:",!
	..W !?28,">>> W A R N I N G <<<",!?14,"Entering an '^' at this point will delete vendor!",!
	..F XX=1:1 S X=$P(FBOVEN,U,XX) Q:'X  D
	...W !?8,$P($T(ERROR+X),";;",2)
	D SETGL
	S FBVIEN=DA D CONTR^FBAAVD2 S DA=FBVIEN Q
	;
EDITV	;called when editing an existing vendor
	N FBHDA Q:'$G(DA)
	N FBAAOUT G:$G(FBT)="N" EDITV1 I $D(^FBAA(161.25,DA,0))!($D(^FBAA(161.25,"AF",DA))) W !!?5,*7,"Current Vendor information is pending Austin processing.  Changing Vendor" D  I $G(FBAAOUT) K FBAAOUT Q
	.W !?5,"information at this time may jeopardize the processing of the existing",!?5,"Master Record Adjustment!",! D
	..S DIR(0)="Y",DIR("A")="Do you wish to continue editing this Vendor",DIR("B")="No" D ^DIR K DIR S:$D(DIRUT)!('Y) FBAAOUT=1
EDITV1	D ^FBAAVD2 K FBCIEN,FBR,FBT
	Q
	;
SETGL	;called to file an entry in 161.25 (vendor correction file)
	I $S('$G(DA):1,$G(FBT)="C"&('$D(FBIEN1)):1,1:0) Q
	S Z1=$G(^FBAAV(DA,0)),FBTOV=$S($P(Z1,U,7)=3:"P",1:"O")
	I $G(FBT)="N"!($G(FBT)="R") S DIE="^FBAAV(",DR="9///@;13///@" D ^DIE K DIE
	I '$D(^FBAA(161.25,DA,0)) L +^FBAA(161.25,DA) K DD,DO S (X,DINUM)=DA,DIC="^FBAA(161.25,",DIC(0)="L",DLAYGO=161.25 D FILE^DICN K DLAYGO L -^FBAA(161.25,DA) Q:Y<0
NEXT	L +^FBAA(161.25,DA):1 I '$T W:'$D(ZTQUEUED) !,"Unable to setup MRA transaction.  Trying again.",! G NEXT
	S DIE="^FBAA(161.25,",DR="[FBAA VENDOR MRA]" D ^DIE L -^FBAA(161.25,DA)
	K DIE,DIC,Y
	Q
	;
Q	K DA,DR,DIC,DIE,DIRUT,DTOUT,DUOUT,A,D,FBX,FBOUT,X2,FY,FBAAPN,FEEO,FBDEL,FBPARCD,FBT,FBTOV,FBTV,X,Y,Z0,Z1,Z2,ZZ,FBCNUM,FBID,FBVIEN,FBLIEN,FBAAFN
	Q
ERROR	;edit check text when adding a new vendor
	;;CITY
	;;STATE
	;;ZIP CODE
	;;COUNTY CODE
CHKVEN	;check if fields 3,4,5,5.5 have been answered. If not delete vendor
	S Y=$G(^FBAAV(DA,0))
	F X=4,5,6,13 I $P(Y,U,X)']"" D  Q
	.S DIK="^FBAAV(" D ^DIK K DIK,DA W !?3,$C(7),".... Vendor deleted",!

FBAAVD1
FBAAVD1	;AISC/DMK/GRR-COMMUNITY NURSING HOME VENDOR DISPLAY  ;4/28/93  14:10
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	W !?23,">>> CNH INFORMATION <<<",!
	W !,$J("Total Beds:",13),?15,$P(V,"^",8),?37,"Inspected/Accredited:",?59,$S($P(V,"^",4)="I":"Inspected by VA",$P(V,"^",4)="A":"Accredited by JCAH",$P(V,"^",4)="B":"Inspect. & Accred.",1:"")
	Q:'$D(^FBAA(161.21,"C",DA))
	S FBX=$$CNH(DA,1)
	W !,$J("Contract #:",13),?15,$P(FBX,U)
	W ?40,$J("Medicare/Medicaid:",13),?59,$S($P(V,"^",5)=1:"Not Cert. for either",$P(V,"^",5)=2:"Cert. for Medicare",$P(V,"^",5)=3:"Cert. for Medicaid",$P(V,"^",5)=4:"Cert. for both",1:"")
	W !,$J("Effect. DT:",13),?15,$$DATX^FBAAUTL($P(FBX,U,2))
	W ?42,"Last Assessment:",?59,$$DATX^FBAAUTL($P(V,"^",6))
	W !,$J("End Date:",13),?15,$$DATX^FBAAUTL($P(FBX,U,3))
	S FBCNUM=$P(FBX,U) K FBX
	W !
	S FBVIEN=DA D DISPLAY K FBVIEN
	Q
	;
CNH(X,Z)	;retrieve latest vendor contract
	;X=IEN for vendor
	;returns contract number
	;if Z=1 returns array C#^effect dt^expire dt
	N Y
	I $S('$G(X):1,'$D(^FBAAV(+X,0)):1,1:0) Q ""
	S Y=$P($G(^FBAA(161.21,+$O(^(+$O(^FBAA(161.21,"ACR",X,-DT-.9)),0)),0)),U,1,3)
	I Y="" S Y=$P($G(^FBAA(161.21,+$O(^(+$O(^FBAA(161.21,"AC",X,DT)),0)),0)),U,1,3)
	Q $S($G(Z):Y,1:$P(Y,U))
	;
RATE(X)	;retrieve rates 
	;X=contract number
	;returns rates delimited by '^'
	N I,CNT,Y
	I $S('$D(X):1,X']"":1,'$D(^FBAA(161.21,"B",X)):1,1:0) Q ""
	S X=$O(^FBAA(161.21,"B",X,0))
	S (I,CNT)=0,Y="" F  S I=$O(^FBAA(161.22,"AC",X,I)) Q:'I  I $D(^FBAA(161.22,I,0)) S CNT=CNT+1 D
	.S $P(Y,"^",CNT)=$P(^FBAA(161.22,I,0),"^",2)
	Q Y
	;
DISPLAY	;
	;will display rates on screen for selection
	;if FBRATE is passed in the display will allow user
	;selection and return 'FBRATE' equal to the dollar amount
	;FBCNUM=contract number
	;must pass in IEN of vendor in 161.2 as FBVIEN
	I $S('$G(FBVIEN):1,'$D(^FBAAV(FBVIEN,0)):1,1:0) S FBX="" Q
	I $S($G(FBCNUM)']"":1,'$D(^FBAA(161.21,"B",FBCNUM)):1,1:0) S FBX="" Q
	N I,J
	S:'$D(FBX) FBX=$$RATE(FBCNUM) I FBX']"" S FBRATE="" Q
	S J="" F I=1:1 S J=$P(FBX,U,I) Q:'J  S X=J,X2="2$" D COMMA^%DTC S J=X D
	.W:I#2 !?10,$S($D(FBRATE):I_")"_J,1:"RATE "_I_":"_J)
	.W:I#2=0 ?40,$S($D(FBRATE):I_")"_J,1:"RATE "_I_":"_J)
	Q:'$D(FBRATE)
	W ! S DIR(0)="N^1:"_(I-1) D ^DIR K DIR I $D(DIRUT) S FBRATE="" Q
	S FBRATE=$P(FBX,U,Y)
	Q

FBAAVD2
FBAAVD2	;AISC/DMK-EDIT VENDOR DEMOGRAPHICS ;4/28/93  11:00
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EDITV	;entry to edit vendor demographic data
	;DA defined to IEN of vendor file (161.2)
	Q:'$G(DA)  N FBADT,FBDA S FBDA=DA L +^FBAAV(DA):1 I '$T W !,"Unable to access vendor record. Trying again.",! G EDITV
	S FBT=$S($D(FBT):FBT,1:""),FBT=$S(FBT="N":FBT,1:"C")
	S FEEO="",DIE="^FBAAV(",DR="[FBAA EDIT VENDOR]",DIE("NO^")="BACKOUTOK"
	S Z1=$G(^FBAAV(DA,0)),Z3=$G(^(1)),Z4=$G(^("AMS")),Z5=$G(^("ADEL"))
	D ^DIE I $P($G(^FBAAV(DA,0)),"^",13)']"" S DR="3;4;5;5.5",DIE("NO^")="" D ^DIE
	K DIE L -^FBAAV(DA) I $D(^FBAAV(DA,0)),(($P(Z1,U,2,6)'=$P(^FBAAV(DA,0),U,2,6))!($P(Z1,U,8,16)'=$P(^FBAAV(DA,0),U,8,16))) D
	.S FBVNAME=$P(^(0),"^"),FBIEN1=DA,FBADT=$P(Z5,U,4)
	.;check if date last received from austin, version 3.  If so, then did not receive in upload - send update instead of change
	.;fbadt = date received from austin.
	.I '$$CKVEN^FBAADV(DA),FBADT']"" D UPDT^FBAAAV(FBDA) Q  ;,FBADT<FBINSTAL D UPDT^FBAAAV(DA) Q
	.;if austin deleted is yes, send update instead of change
	.I $P($G(^FBAAV(FBDA,"ADEL")),"^")="Y" D UPDT^FBAAAV(FBDA) Q
	.;if editing a newly added vendor, send update instead of change
	.I FBT="N" D UPDT^FBAAAV(FBDA) Q
	.;If date from austin not null then add vendor entry for a change
	.K DD,DO S DIC="^FBAAV(",DIC(0)="L",DLAYGO=161.2,X=FBVNAME D FILE^DICN Q:Y<0  S FBIEN=+Y
	.L +^FBAAV(FBIEN) S ^FBAAV(FBIEN,0)=$G(^FBAAV(FBIEN1,0)),^FBAAV(FBIEN,1)=$G(^FBAAV(FBIEN1,1)),^FBAAV(FBIEN,"AMS")=$G(^FBAAV(FBIEN1,"AMS")),$P(^FBAAV(FBIEN,"AMS"),"^")="",DIK="^FBAAV(",DA=FBIEN D IX1^DIK L -^FBAAV(FBIEN)
	.L +^FBAAV(FBIEN1) S DIE="^FBAAV(",DA=FBIEN1,DR="[FB VENDOR UPDATE]" D ^DIE K DIE L -^FBAAV(FBIEN1)
	.S DA=FBIEN D SETGL^FBAAVD
	K FBVNAME,FBIEN,FBIEN1,Z3,Z4,Z5
	;
CONTR	;enter contract information for a CNH vendor
	Q:$S('$D(FBPARCD):1,FBPARCD'=5:1,1:0)
	Q:'$G(DA)  S FBVIEN=DA
	S FBLIEN=$P($G(^FBAA(161.25,FBVIEN,0)),"^",6) I FBLIEN]"",FBLIEN'=FBVIEN W !!,*7,"Cannot add contract information to this vendor until change has been",!,"approved by Austin." Q
	W ! S DIC="^FBAA(161.21,",DIC(0)="AEQLM",DLAYGO=161.21,DIC("S")="I $P(^(0),U,4)="_FBVIEN
	D ^DIC K DIC,DLAYGO Q:X=""!(X="^")  G CONTR:Y<0
	S DA=+Y,FBCNUM=$P(Y,"^",2),DIE="^FBAA(161.21," L +^FBAA(161.21,DA)
	S ZO1=^FBAA(161.21,DA,0),DR="[FBNH ENTER CONTRACT]",DIE("NO^")="" D ^DIE K DIE,DR
	I '$G(DA) K ZO1 Q
	I $D(^FBAA(161.22,"AC",DA)) D
	.Q:$P(ZO1,"^",1,2)=$P(^FBAA(161.21,DA,0),"^",1,2)  W !!,*7,"You cannot change contract numbers or effective dates on",!,"a contract that has rates associated with it."
	.S DIE="^FBAA(161.21,",DR=".01////^S X=$P(ZO1,U);.02////^S X=$P(ZO1,U,2);.03////^S X=$P(ZO1,U,3);.04////^S X=$P(ZO1,U,4)" D ^DIE K DIE,DR W !!,"Contract information reset"
	L -^FBAA(161.21,DA) K ZO1
	Q:$D(DTOUT)
	I $G(FBEXNDT)<$G(FBEXDT) D URATE K FBCIEN,FBEXDT,FBEXNDT,FBURT
	;create rates for a contract. Rates cannot be changed, but the
	;user can enter multiple rates for a contract.
	;FBCIEN=internal entry number for contract in 161.21
	S FBCIEN=DA K FBX
RATE	K DA W ! S DIR(0)="161.22,.02",DIR("A")="Enter Nursing Home Rate",DIR("?")="^K FBX D DISPLAY^FBAAVD1 W !,""Enter an amount between .01 and 9999999.99""" D ^DIR
	K DIR Q:$D(DIRUT)  Q:'Y  S FBR=+Y
	I $D(^FBAA(161.22,"AD",FBCIEN,FBR)) K FBR W !,*7,"Rate already exists for that contract!",! G RATE
	S X=$P(^FBAA(161.22,0),U,3)
RETRY	S X=X+1 G:$D(^FBAA(161.22,X)) RETRY
	L +^FBAA(161.22,X)
	K DD,DO S DIC="^FBAA(161.22,",DIC(0)="L",DLAYGO=161.22,DIC("DR")=".02////^S X="_FBR_";.03////^S X="_FBCIEN D FILE^DICN K DIC,DLAYGO
	L -^FBAA(161.22,+Y)
	G RATE
	;
GETVEN	K FBRATE D GETVEN^FBAAUTL1 G END:'IFN
	S DA=IFN K DIC,IFN
	S FBPARCD=$P($G(^FBAAV(DA,0)),U,9)
	I FBPARCD'=5 W !?5,*7,"Vendor selected is not a Community Nursing Home.",! G GETVEN
	D CONTR G GETVEN
END	K DIC,DA,FBVIEN,IFN,FBPARCD,X,Y,FBLIEN
	Q
URATE	;Update rate when user backs up contract dates.
	N DA S (FBCIEN,FBURT)=0
	F  S FBURT=$O(^FBAA(161.23,"AE",FBCNUM,FBURT)) Q:'FBURT  F  S FBCIEN=$O(^FBAA(161.23,"AE",FBCNUM,FBURT,FBCIEN)) Q:'FBCIEN  I $P($G(^FBAA(161.23,FBCIEN,0)),"^",2)>FBEXNDT D
	.I +$G(^FBAA(161.23,FBCIEN,0))>FBEXNDT S DIK="^FBAA(161.23,",DA=FBCIEN D ^DIK K DIK Q
	.S DIE="^FBAA(161.23,",DA=FBCIEN,DR=".02////^S X=FBEXNDT" D ^DIE K DIE

FBAAVLU
FBAAVLU	;AISC/DMK-LOOK UP VENDOR FOR TIME FRAME ;26JUL88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW
RDV	S FBAAOUT=0 K FBAANQ W !! S DIC="^FBAAV(",DIC(0)="AEQM",DIC("A")="Select Medical Vendor: ",DIC("S")="I $P(^(0),""^"",7)'=3" D ^DIC K DIC("S"),DIC("A") G Q:X="^"!(X=""),RDV:Y<0 S DA=+Y
	D DATE^FBAAUTL G:FBPOP RDV S ZZ=9999999.9999,BEG=ZZ-ENDDATE,END=ZZ-BEGDATE
	S VAR="DA^BEG^END",VAL=DA_"^"_BEG_"^"_END,PGM="START^FBAAVLU" D ZIS^FBAAUTL G:FBPOP Q S:IO=IO(0) FBAANQ=1
START	S Q="",$P(Q,"-",80)="-",HNAM="",FBDEL=$S($P($G(^FBAAV(DA,"ADEL")),"^")="Y":1,1:0) U IO W:$E(IOST,1,2)["C-" @IOF D HED
	F J=0:0 S J=$O(^FBAAC("AB",DA,J)) Q:J'>0!(FBAAOUT)  F FBK=BEG-1:0 S FBK=$O(^FBAAC(J,DA,"AD",FBK)) Q:FBK>END!(FBK'>0)!(FBAAOUT)  S K=DA D MORE
	G:$D(FBAANQ) RDV
Q	D CLOSE^FBAAUTL K DA,%DT,M,HNAM,J,BEG,BEGDATE,V,DIC,END,ENDDATE,A1,A2,B,B1,B2,PI,T,FBAACPT,FBAADT,FBAAPD,FBIN,FBAANQ,FBAAOUT,K,L,PTNAM,ZS,PGM,Q,VAL,VAR,X,Y,ZZ,FBDEL,FBMOD Q
MORE	F L=0:0 S L=$O(^FBAAC(J,DA,"AD",FBK,L)) Q:L'>0!(FBAAOUT)  F M=0:0 S M=$O(^FBAAC(J,1,DA,1,L,1,M)) Q:M'>0!(FBAAOUT)  S B=^(M,0) Q:$P(B,"^",6)']""  S T=$P(B,"^",5),FBAAPD=$P(B,"^",14),ZS=$P(B,"^",20),V=$P(B,"^",21) D
	.D FBCKO^FBAACCB2(J,K,L,M),WRT
	Q
WRT	I $E(IOST,1,2)["C-",$Y+4>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  W @IOF D HED
	E  I $Y+4>IOSL W @IOF D HED
	S FBAADT=$P(^FBAAC(J,1,DA,1,L,0),"^",1),FBAADT=$E(FBAADT,4,5)_"/"_$E(FBAADT,6,7)_"/"_$E(FBAADT,2,3),B1=$P(B,"^",8),B2=$S(B1="":"",$D(^FBAA(161.7,B1,0)):$P(^FBAA(161.7,B1,0),"^",1),1:""),PTNAM=$S($D(^DPT(J,0)):$P(^DPT(J,0),"^"),1:"")
	S FBAAPD=$S(FBAAPD]"":$E(FBAAPD,4,5)_"/"_$E(FBAAPD,6,7)_"/"_$E(FBAAPD,2,3),1:"NOT PAID")
	S A1=$P(B,"^",2)+.0001,A2=$P(B,"^",3)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2),FBIN=$P(B,"^",16)
	S FBAACPT=$P(B,"^",1),FBAACPT=$S($L(FBAACPT)<6:FBAACPT,1:$S($D(^ICPT(FBAACPT,0)):$P(^(0),"^",1),1:""))
	S FBMOD=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),"^",7)
	W:PTNAM'=HNAM !,PTNAM
	W !,$S(ZS="R":"*",1:""),$S(V="VP":"#",1:""),$S($G(FBCAN)]"":"+",1:""),?2,FBAADT,?12,FBAACPT_$S($G(FBMOD)]"":"-"_FBMOD,1:""),?21,"$",$J(A1,8),?32,"$",$J(A2,8),?43,T,?47,FBIN,?58,B2,?66,FBAAPD D PMNT^FBAACCB2
	S HNAM=PTNAM
	Q
HED	S FBAAOUT=0 W ?26,"** VENDOR LOOK-UP **",!,!,?23,"Vendor: ",$P(^FBAAV(DA,0),"^",1),!,?14,"('*' Reimb. to Patient  '+' Cancel. Activity)",!,"PATIENT",?14,"('#' Voided Payment)"
	W !," SVC DATE",?11,"CPT-MOD",?20,"AMT CLAIMED",?32,"AMT PAID",?42,"CODE",?47,"INVOICE #",?57,"BATCH #",?66,"DATE PAID",!,Q,!
	Q

FBAAVP
FBAAVP	;AISC/DMK-VOID & CANCEL VOIDED MEDICAL PAYMENT ;01JUN88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;Variable 'FBVOID' is set if cancelling a voided payment.
	D DT^DICRW
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !!,*7,"Sorry,you must be a supervisor to use this option.",! Q
RDP	K ^TMP($J) W !! S DIC="^FBAAC(",DIC(0)="AEQM",DIC("A")="Select Patient: " D ^DIC K DIC("A") G Q:X="^"!(X=""),RDP:Y<0 S DFN=+Y
	S:'$D(^FBAAC(DFN,1,0)) ^FBAAC(DFN,1,0)="^162.01P^0^0"
RDV	W !! S DIC="^FBAAV(",DIC(0)="AEQM",DA(1)=DFN D ^DIC G RDP:X="^"!(X=""),RDV:Y<0 S DA=+Y G:'$D(^FBAAC(DFN,DA,"AD")) NOCL^FBAAVP0 D EN1
	I CNT'>0 G NVOID^FBAAVP0
	D CPAY G Q
EN1	S Q="",$P(Q,"-",80)="-",CNT=0
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP D HED
	F D=0:0 S D=$O(^FBAAC(DFN,DA,"AD",D)) Q:D'>0  F B=0:0 S B=$O(^FBAAC(DFN,DA,"AD",D,B)) Q:B'>0  F K=0:0 S K=$O(^FBAAC(DFN,1,DA,1,B,1,K)) Q:K'>0  S L=^(K,0) Q:$D(^FBAAC(DFN,1,DA,1,B,1,K,"FBREJ"))  D EN2
	Q
EN2	S T=$P(L,"^",5),FBAAPD=$P(L,"^",14),ZS=$P(L,"^",20),FD=$P(L,"^",6),FBON=$P(L,"^",10),V=$P(L,"^",21) I FD]""&$S($D(FBVOID):(V="VP"),1:(V="")) D WRT
	Q
WRT	S FBDT=$P(^FBAAC(DFN,1,DA,1,B,0),"^"),FBAADT=$E(FBDT,4,5)_"/"_$E(FBDT,6,7)_"/"_$E(FBDT,2,3),B1=$P(L,"^",8),B2=$S(B1="":"",$D(^FBAA(161.7,B1,0)):$P(^FBAA(161.7,B1,0),"^"),1:""),CNT=CNT+1,FBVD=DA,FBSD=B,FBSV=K
	D FBCKO^FBAACCB2(DFN,FBVD,FBSD,FBSV)
	S FBAAPD=$S(FBAAPD]"":$E(FBAAPD,4,5)_"/"_$E(FBAAPD,6,7)_"/"_$E(FBAAPD,2,3),1:"")
	S A1=$P(L,"^",2)+.0001,A2=$P(L,"^",3)+.0001,A1=$P(A1,".")_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".")_"."_$E($P(A2,".",2),1,2),FBIN=$P(L,"^",16)
	S FBAACPT=$P(L,"^"),FBAACPT=$S($L(FBAACPT)<6:FBAACPT,1:$S($D(^ICPT(FBAACPT,0)):$P(^(0),"^"),1:""))
	S FBMOD=$P($G(^FBAAC(DFN,1,DA,1,B,1,K,2)),"^",7)
	W !,CNT_") ",$S(ZS="R":"*",1:""),$S(V="VP":"#",1:""),?3,FBAADT,?14,FBAACPT_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:""),?23,"$",$J(A1,8),?34,"$",$J(A2,8),?45,T,?49,FBIN,?60,B2,?68,FBAAPD
	D PMNT^FBAACCB2
	I $D(^FBAAC(DFN,1,DA,1,B,1,K,"R")),^("R")]"" W !?3,"Reason:",!?10,^("R"),!
	S ^TMP($J,CNT)=FBAADT_"^"_FBAACPT_"^"_$J(A1,8)_"^"_$J(A2,8)_"^"_T_"^"_FBIN_"^"_B2_"^"_FBAAPD_"^"_FBSD_"^"_FBSV_"^"_FD_"^"_A2_"^"_FBON Q
	Q
HED	W @IOF,"Patient Name: ",$P(^DPT(DFN,0),"^"),?50,"Pt.ID ",$$SSN^FBAAUTL(DFN),!!,?2,"VENDOR: ",$P(^FBAAV(DA,0),"^"),!,?10,"('*' Reimb. to Patient   '#' Voided Payment)"
	W !," SVC DATE",?11,"CPT-MOD",?20,"AMT CLAIMED",?32,"AMT PAID",?42,"CODE",?47,"INVOICE #",?57,"BATCH #",?66,"DATE PAID",!,Q,!
	Q
Q	K DIC,DIE,DA,DF,DA(1),^TMP($J),A,A1,A2,B,B1,B2,C,CNT,D,D0,D1,D2,D3,DI,DR,DFN,DIYS,FBAACB,FBAACPT,FBAADT,FBAAPD,FBX,DIR,FBDT,FBIN,FBON,FBSD,FBSV,FD,FBVD,FBVOID,I,K,L,ON,POP,P3,P4,Q,T,V,X,Y,VP,VAL,ZS,Z,ZZ,FBSSN,DIRUT,FBMOD Q
CPAY	W !!,"Which payment item(s) would you like to ",$S($D(FBVOID):"Cancel the void on",1:"Void")," ? " S DIR(0)="L^1:"_CNT D ^DIR
	G RDV:$D(DIRUT) S FBX=Y D HED
	F A=1:1:CNT S X=$P(FBX,",",A) Q:X=""  S Y(0)=^TMP($J,X),FBSD=$P(Y(0),"^",9),FBSV=$P(Y(0),"^",10),FD=$P(Y(0),"^",11),A2=$P(Y(0),"^",12),FBON=$P(Y(0),"^",13),^TMP($J,"VOID",X)=DFN_"^"_FBVD_"^"_FBSD_"^"_FBSV_"^"_FD_"^"_A2_"^"_FBON D PRT2
VERF	S DIR(0)="Y",DIR("A")="Are you sure you want to "_$S($D(FBVOID):"Cancel the void on ",1:"Void ")_"the payment(s)",DIR("B")="NO" D ^DIR K DIR G RDP:$D(DIRUT)!'Y
	F I=0:0 S I=$O(^TMP($J,"VOID",I)) Q:I'>0  S Y(0)=^(I),DFN=$P(Y(0),"^"),FBVD=$P(Y(0),"^",2),FBSD=$P(Y(0),"^",3),FBSV=$P(Y(0),"^",4),A2=$P(Y(0),"^",6),FBON=$P(Y(0),"^",7) D SETN,^FBAAVP0 W !,?5,".... Done.",!
	K FBVR Q
SETN	S DA=FBSV,VP=$S($D(FBVOID):"",1:"VOID")
	I $D(FBVOID) S DR="24///@;24.5///@;25///@"
	I '$D(FBVOID) S DR="24///^S X=VP;25////^S X=DUZ"_$S($D(FBVR):";24.5////^S X=FBVR",1:";24.5R;S FBVR=X")
	S DIE="^FBAAC("_DFN_",1,"_FBVD_",1,"_FBSD_",1,",DIDEL=162 D ^DIE K DIDEL Q
PRT2	D FBCKO^FBAACCB2(DFN,FBVD,FBSD,FBSV)
	W !,$P(Y(0),"^",1),?14,$P(Y(0),"^",2),?23,$P(Y(0),"^",3),?34,$P(Y(0),"^",4),?45,$P(Y(0),"^",5),?49,$P(Y(0),"^",6),?62,$P(Y(0),"^",7),?68,$P(Y(0),"^",8),!
	D PMNT^FBAACCB2
	Q

FBAAVP0
FBAAVP0	;AISC/DMK-READJUST OBLIGATION BALANCE ;01JUN88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	G:$D(FBVOID) VOID
	W !,?10,"Void payment for "_$E($S($D(^DPT(DFN,0)):$P(^(0),"^"),1:""),1,30),!,*7,"You must adjust control point accordingly through IFCAP!"
	Q
VOID	W !,?10,"Cancel Voided payment for "_$E($S($D(^DPT(DFN,0)):$P(^(0),"^"),1:""),1,30),!,*7,"You must adjust control point accordingly through IFCAP!"
	Q
NOCL	W !,"Vendor has no Payment data for this Patient!",! G RDV^FBAAVP
NVOID	W !!,"There are no finalized payments for this vendor ",$S($D(FBVOID):"that have been voided.",1:"that may be voided.") G RDV^FBAAVP

FBAAVR
FBAAVR	;AISC/GRR-FINALIZE BATCH ;01JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S Q="",$P(Q,"=",80)="=",IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS
	D DT^DICRW
BT	K DIC S (FBRFLAG,FBINTOT)=0 K QQ W !! S DIC="^FBAA(161.7,",DIC(0)="AEQ",DIC("S")="I $G(^(""ST""))=""T""!($G(^(""ST""))=""V"")" D ^DIC K DIC("S") G Q:X="^"!(X=""),BT:Y<0 S FBN=+Y,FZ=^FBAA(161.7,FBN,0),FBTYPE=$P(FZ,"^",3)
	I FBTYPE="B9",$P(FZ,"^",15)="" S FBCNH=1
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !!,*7,"Sorry, only Supervisor can Finalize batch!" G Q
	S FBAAON=$P(FZ,"^",2),FBAARA=0,FBAAB=$P(FZ,"^"),FBAAOB=$P(FZ,"^",8)_"-"_FBAAON,FBCOMM="Rejected items from batch "_FBAAB
	I $G(^FBAA(161.7,FBN,"ST"))'="T",$G(^("ST"))'="V" G ERR^FBAAVR0
	S DIC="^FBAA(161.7,",DA=FBN,DR="0;ST" W !! D EN^DIQ
BTL	S B=FBN S DIR(0)="Y",DIR("A")="Want line items listed",DIR("B")="NO" D ^DIR K DIR G Q:$D(DIRUT) W:Y @IOF D:Y LIST^FBAACCB:FBTYPE="B3",LISTP^FBAACCB:FBTYPE="B5",LISTT^FBAACCB0:FBTYPE="B2",LISTC^FBAACCB1:FBTYPE="B9"
RD0	S DIR(0)="Y",DIR("A")="Want to reject the entire Batch",DIR("B")="NO",DIR("?")="'Yes' will flag all payment items in batch as rejected, 'No' will prompt for rejection of specific line items." D ^DIR K DIR G Q:$D(DIRUT),^FBAADD:Y
RD1	S DIR(0)="Y",DIR("A")="Want to reject any line items",DIR("B")="NO" D ^DIR K DIR G Q:$D(DIRUT)
	I Y,($P(FZ,U,9)'>0!($P(FZ,U,11)'>0)) G NOLINE^FBAADD
	I $G(Y) D CK1358^FBAAUTL1 G Q:$D(FBERR) D DELT^FBAAVR1:FBTYPE="B2",DELM^FBAAVR2:FBTYPE="B3",DELP^FBAAVR1:FBTYPE="B5",DELC^FBAAVR0:FBTYPE="B9"
RDD	S DIC="^FBAA(161.7,",DA=FBN,DR="0;ST" W !! D EN^DIQ
RDD1	D:FBRFLAG PLUSOB^FBAAUTL1 S FBRFLAG=0 S DIR(0)="Y",DIR("A")="Do you want to Finalize Batch as Correct",DIR("B")="NO" D ^DIR K DIR  G Q:$D(DIRUT) W:'Y&($P($G(^FBAA(161.7,FBN,"ST")),U)'="V") !!,"Batch has NOT been Finalized!",*7 G BT:'Y
	D MEDV:FBTYPE="B3",VCHNH^FBAAVR0:FBTYPE="B9"
FIN	S DA=FBN,(DIC,DIE)="^FBAA(161.7,",DIC(0)="LQ",DR="13////^S X=DT;14////^S X=DUZ;11////^S X=""V""",DLAYGO=161.7 D ^DIE K DIE,DIC,DA,DLAYGO
	W !!," Batch has been Finalized!" D Q G FBAAVR
Q	K B,J,K,L,M,X,Y,Z,DIC,ERR,FBN,FBAAOUT,FBAC,FBAP,FBFD,FBPDT,FBSC,FBTD,FBVP,POP,FBRFLAG,Q,QQ,A,A1,A2,DO,DA,DL,DR,DRX,DX,FBAAAP,FBAACB,FBAACPT,FBAAON,FBAARA,FBINTOT,FBIN,FBRR,FBTYPE,FZ,HX,I,P3,P4,S,V,VAL,VID,XY,ZS,FBAAB,FBAAOB,DIRUT
	K FBAAON,FBCOMM,FBERR,FBI,FBLIST,PRCS("TYPE"),FBLISTC,FBINOLD,FBDX,FBK,FBL,FBPROC,FBCNH,FBAAMT,FBII78
	Q
MEDV	F J=0:0 S J=$O(^FBAAC("AC",B,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AC",B,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AC",B,J,K,L)) Q:L'>0  F M=0:0 S M=$O(^FBAAC("AC",B,J,K,L,M)) Q:M'>0  D SETXFR
	Q
SETXFR	I '$D(^FBAAC(J,1,K,1,L,1,M,"FBREJ")),$D(^FBAAC(J,1,K,1,L,1,M,0)) S DA(3)=J,DA(2)=K,DA(1)=L,DA=M,DIE="^FBAAC(DA(3),1,DA(2),1,DA(1),1,",DR="5///^S X=DT" D ^DIE K DIE,DA,DR
	Q

FBAAVR0
FBAAVR0	;AISC/GRR-REJECT ITEMS ;01JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
STUFF	S FBRFLAG=1,$P(^FBAAC(J,1,K,1,L,1,M,"FBREJ"),"^",3)=$P(^FBAAC(J,1,K,1,L,1,M,0),"^",8),FBIN=$P(^(0),"^",16),$P(^(0),"^",8)="",$P(^("FBREJ"),"^",1)="P",$P(^("FBREJ"),"^",2)=FBRR,FBAAAP=+$P(^(0),"^",3),FBAARA=FBAARA+FBAAAP
	K ^FBAAC("AC",B,J,K,L,M),^FBAAC("AJ",B,FBIN,J,K,L,M),QQ(HX) S ^FBAAC("AH",B,J,K,L,M)="",$P(FZ,"^",9)=($P(FZ,"^",9)-FBAAAP),$P(FZ,"^",11)=($P(FZ,"^",11)-1),$P(FZ,"^",17)="Y"
	S $P(^FBAA(161.7,B,0),"^",9)=$P(FZ,"^",9),$P(^(0),"^",11)=$P(FZ,"^",11),$P(^(0),"^",17)="Y"
	Q
VCHNH	F J=0:0 S J=$O(^FBAAI("AC",B,J)) Q:J'>0  I '$D(^FBAAI(J,"FBREJ")),$D(^FBAAI(J,0)) S DA=J,(DIE,DIC)="^FBAAI(",DIC(0)="LQ",DR="19////^S X=DT",DLAYGO=162.5 D ^DIE
	K DIE,DIC,DA,DLAYGO Q
ERR	S FBST=^FBAA(161.7,FBN,"ST")
	I FBST="O" W !,*7,"Batch is still Open!" G BT^FBAAVR
	I FBST="C" W !,*7,"Supervisor has not Released Batch yet!" G BT^FBAAVR
	I FBST="S" W !,*7,"Batch has not been Transmitted yet!" G BT^FBAAVR
DELC	K QQ W !! S DIC=161,DIC("A")="Select Patient: ",DIC(0)="AEMZ",DIC("S")="I $D(^FBAAI(""AE"",B,+Y))" D ^DIC Q:X=""!($D(DTOUT))!($D(DUOUT))  G DELC:Y<0 S FBDFN=+Y K DIC
	;I $D(^FBAAI(FBI,"FBREJ")) W !!,*7,"Payment already rejected!",! G DELC
	S (QQ,FBAAOUT)=0 W @IOF D HEDC^FBAACCB1 F I=0:0 S I=$O(^FBAAI("AE",B,FBDFN,I)) Q:I'>0!(FBAAOUT)  I $D(^FBAAI(I,0)) S Z(0)=^(0),FBI=I D WRITC
RL	S DIR(0)="Y",DIR("A")="Want all line items rejected for this patient",DIR("B")="YES" D ^DIR K DIR G DELC:$D(DIRUT),LOOP:Y
RL1	S DIR(0)="NO^1:"_QQ,DIR("A")="Reject which line item" D ^DIR K DIR G DELC:X=""!$D(DIRUT) S HX=X
	I '$D(QQ(HX)) W !,*7,"You already rejected that one!!" G RL1
RJT	S DIR(0)="Y",DIR("A")="Are you sure you want to reject item number: "_HX,DIR("B")="NO" D ^DIR K DIR G RL1:$D(DIRUT)!'Y
RDR1	S DIR(0)="F^2:40",DIR("A")="Enter reason for rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) RDR1 S FBRR=X
	S I=QQ(HX) D RESET
RDMORE	S DIR(0)="Y",DIR("A")="Item rejected.  Want to reject another",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  G RL1:Y
	Q
WRITC	S QQ=QQ+1,QQ(QQ)=I D CMORE^FBAACCB1 Q
LOOP	S DIR(0)="F^2:40",DIR("A")="Reason for rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) LOOP S FBRR=X
	F HX=0:0 S HX=$O(QQ(HX)) Q:HX'>0  S I=QQ(HX) D RESET
	W !,"...DONE!" G DELC
RESET	K DR S (DIC,DIE)="^FBAAI(",DA=I,DR="20///^S X=""@"";13////^S X=""P"";14////^S X=FBRR;15////^S X=B" D ^DIE K DIC,DIE
	S FBAAAP=+$P(^FBAAI(I,0),"^",9),FBMM=$E($P(^(0),U,6),4,5),$P(FZ,"^",9)=$P(FZ,"^",9)-FBAAAP,$P(FZ,"^",10)=$P(FZ,"^",10)-1,$P(FZ,"^",11)=$P(FZ,"^",11)-1,$P(FZ,"^",17)="Y",^FBAA(161.7,B,0)=FZ,FBAARA=FBAARA+FBAAAP K QQ(HX)
	S FBAAMT=-FBAAAP,FBII78=$P(^FBAAI(I,0),"^",5) D INPOST^FBAARD3
	Q

FBAAVR1
FBAAVR1	;AISC/GRR-FEE BASIS VOUCHER AUDIT DELETE AN ITEM ;10AUG86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DELT	;TRAVEL LINE ITEM REJECT
	D GET Q:X="^"!(X="")  I '$D(^FBAAC("AD",B,J)) W !!,*7,"No payments in this batch for that patient!" G DELT
	S (QQ,FBAAOUT)=0 W @IOF D HEDP^FBAACCB0
	F K=0:0 S K=$O(^FBAAC("AD",B,J,K)) Q:K'>0!(FBAAOUT)  S QQ=QQ+1,QQ(QQ)=J_"^"_K S Y(0)=^FBAAC(J,3,K,0) D SETT^FBAACCB0
RLT1	S DIR(0)="Y",DIR("A")="Reject all line items for this patient",DIR("B")="YES" D ^DIR K DIR G DELT:$D(DIRUT),LOOPT:Y
RLT	S DIR(0)="NO^1:"_QQ,DIR("A")="Reject which line item" D ^DIR K DIR G DELT:X=""!$D(DIRUT) S HX=X
	I '$D(QQ(HX)) W !!,*7,"You just deleted that one!!" G RLT
RASK	S DIR(0)="Y",DIR("A")="Are you sure you want to reject line item number: "_HX,DIR("B")="NO" D ^DIR K DIR G RLT:$D(DIRUT)!'Y
	S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2),FBRFLAG=1,XMB(2)="some"
RDR2	S DIR(0)="F^2:40",DIR("A")="Enter reason for rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) RDR2 S FBRR=X
	D STUFFT G RDMORT
STUFFT	D REJT^FBAADD S FBAAAP=$P(^FBAAC(J,3,K,0),"^",3),$P(FZ,"^",9)=($P(FZ,"^",9)-FBAAAP),$P(FZ,"^",11)=($P(FZ,"^",11)-1),$P(FZ,"^",17)="Y",FBAARA=FBAARA+FBAAAP K QQ(HX)
	S $P(^FBAA(161.7,B,0),"^",9)=$P(FZ,"^",9),$P(^(0),"^",11)=$P(FZ,"^",11),$P(^(0),"^",17)="Y"
	Q
RDMORT	S DIR(0)="Y",DIR("A")="Item Rejected!  Want to reject another",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  G RLT:Y
	G DELT
DELP	;PHARMACY LINE ITEM REJECT
RDI	K QQ W !! S DIC="^FBAAA(",DIC(0)="AEMQ" D ^DIC Q:X="^"!(X="")  G:Y<0 RDI S DFN=+Y I '$D(^FBAA(162.1,"AJ",B,DFN)) W !!,*7,"No payments in this batch for that patient!" G RDI
	S (FBAAOUT,QQ,TM1,TM2)=0 W @IOF D HED^FBAACCB
	F W1=0:0 S W1=$O(^FBAA(162.1,"AJ",B,DFN,W1)) Q:W1'>0!(FBAAOUT)  F W2=0:0 S W2=$O(^FBAA(162.1,"AJ",B,DFN,W1,W2)) Q:W2'>0!(FBAAOUT)  S (A,FBIN)=W1,B2=W2,QQ=QQ+1,QQ(QQ)=A_"^"_B2 S Z(0)=^FBAA(162.1,A,"RX",B2,0) D SETV^FBAACCB0,MORE^FBAACCB1
RLP1	S DIR(0)="Y",DIR("A")="Reject all line items for this patient",DIR("B")="YES" D ^DIR K DIR G DELP:$D(DIRUT),LOOPP:Y
RLP	S DIR(0)="NO^1:"_QQ,DIR("A")="Reject which line item" D ^DIR K DIR G DELP:X=""!$D(DIRUT) S HX=X
	I '$D(QQ(HX)) W !!,*7,"You just did that one!" G RLP
RLI	S DIR(0)="Y",DIR("A")="Are you sure you want to reject line item number: "_HX,DIR("B")="NO" D ^DIR K DIR G RLP:$D(DIRUT)!'Y
	S A=$P(QQ(HX),"^",1),B2=$P(QQ(HX),"^",2),J=A,K=B2,FBRFLAG=1,XMB(2)="some"
RDR3	S DIR(0)="F^2:40",DIR("A")="Enter reason for rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) RDR3 S FBRR=X
	D STUFFP G RDMORP
STUFFP	D REJP^FBAADD S FBAAAP=$P(^FBAA(162.1,A,"RX",B2,0),"^",16),$P(FZ,"^",9)=($P(FZ,"^",9)-FBAAAP),$P(FZ,"^",11)=($P(FZ,"^",11)-1),$P(FZ,"^",17)="Y",$P(^FBAA(161.7,B,0),"^",9)=$P(FZ,"^",9),$P(^(0),"^",11)=$P(FZ,"^",11),$P(^(0),"^",17)="Y"
	S FBAARA=FBAARA+FBAAAP K QQ(HX)
	Q
RDMORP	S DIR(0)="Y",DIR("A")="Item rejected, want to reject another",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  G RLP:Y
	G DELP
GET	K QQ W !! S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC Q:X=""!(X="^")  G:Y<0 GET S DA=+Y,J=DA Q
LOOPT	S DIR(0)="F^2:40",DIR("A")="Reason for Rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) LOOPT S FBRR=X
	F HX=0:0 S HX=$O(QQ(HX)) Q:HX'>0  S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2),FBRFLAG=1,XMB(2)="some" D STUFFT
	W !,"...DONE!" G DELT
LOOPP	S DIR(0)="F^2:40",DIR("A")="Reason for Rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) LOOPP S FBRR=X
	F HX=0:0 S HX=$O(QQ(HX)) Q:HX'>0  S A=$P(QQ(HX),"^",1),B2=$P(QQ(HX),"^",2),J=A,K=B2,FBRFLAG=1,XMB(2)="some" D STUFFP
	W !,"...DONE!" G DELP

FBAAVR2
FBAAVR2	;AISC/GRR-FINALIZE BATCH ;01JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
GET	W !! S DIC="^FBAAA(",DIC(0)="AEQM" D ^DIC Q:X="^"!(X="")  G GET:Y<0 S DA=+Y,J=DA Q
DELM	K QQ D GET Q:X="^"!(X="")  I '$D(^FBAAC("AC",B,J)) W !!,*7,"No payments in this batch for that patient!" G DELM
	S (QQ,FBAAOUT)=0 W @IOF D HED^FBAACCB
	F K=0:0 S K=$O(^FBAAC("AC",B,J,K)) Q:K'>0!(FBAAOUT)  F L=0:0 S L=$O(^FBAAC("AC",B,J,K,L)) Q:L'>0!(FBAAOUT)  F M=0:0 S M=$O(^FBAAC("AC",B,J,K,L,M)) Q:M'>0!(FBAAOUT)  D WRITM
RL1	S DIR(0)="Y",DIR("A")="Want all line items rejected for this patient",DIR("B")="YES" D ^DIR K DIR G DELM:$D(DIRUT),LOOP:Y
RL	S DIR(0)="N^1:"_QQ,DIR("A")="Reject which line item" D ^DIR K DIR G DELM:X=""!$D(DIRUT) S HX=X
	I '$D(QQ(HX)) W !,*7,"You already rejected that one!!" G RL
RJT	S DIR(0)="Y",DIR("A")="Are you sure you want to reject item number: "_HX,DIR("B")="NO" D ^DIR K DIR G RL:$D(DIRUT)!'Y
	S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2),L=$P(QQ(HX),"^",3),M=$P(QQ(HX),"^",4)
RDR1	S DIR(0)="F^2:40",DIR("A")="Enter reason for rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) RDR1 S FBRR=X
	D ^FBAAVR0
RDMORE	S DIR(0)="Y",DIR("A")="Item rejected.  Want to reject another",DIR("B")="YES" D ^DIR K DIR Q:$D(DIRUT)  G RL:Y,DELM
WRITM	S QQ=QQ+1,QQ(QQ)=J_"^"_K_"^"_L_"^"_M D SET^FBAACCB Q
LOOP	S DIR(0)="F^2:40",DIR("A")="Reason for rejecting" D ^DIR K DIR W:$D(DIRUT) !!,"Required Response!!" G:$D(DIRUT) LOOP S FBRR=X
	F HX=0:0 S HX=$O(QQ(HX)) Q:HX'>0  S J=$P(QQ(HX),"^",1),K=$P(QQ(HX),"^",2),L=$P(QQ(HX),"^",3),M=$P(QQ(HX),"^",4) D ^FBAAVR0
	W !,"...DONE!" G DELM
Q	Q

FBAAVS
FBAAVS	;AISC/GRR-DISPLAY VENDOR PAYMENT RECORDS ;17DEC85
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RDP	W !! S DIC="^FBAAC(",DIC(0)="AEQM",DIC("A")="Select Patient: " D ^DIC K DIC("A") G Q:X="^"!(X=""),RDP:Y<0 S DFN=+Y
	S:'$D(^FBAAC(DFN,1,0)) ^FBAAC(DFN,1,0)="^162.01P^0^0"
RDV	W !! S DIC="^FBAAV(",DIC(0)="AEQM",DA(1)=DFN D ^DIC G RDP:X="^"!(X=""),RDV:Y<0 S DA=+Y G:'$D(^FBAAC(DFN,DA,"AD")) NOCL D EN1
	G RDV
EN1	S Q="" F A=1:1:79 S Q=Q_"-",FBAAOUT=0
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP D HED
	F D=0:0 S D=$O(^FBAAC(DFN,DA,"AD",D)) Q:D'>0!(FBAAOUT)  F B=0:0 S B=$O(^FBAAC(DFN,DA,"AD",D,B)) Q:B'>0!(FBAAOUT)  F K=0:0 S K=$O(^FBAAC(DFN,1,DA,1,B,1,K)) Q:K'>0!(FBAAOUT)  S L=^(K,0),FBMOD=$P($G(^FBAAC(DFN,1,DA,1,B,1,K,2)),"^",7) D MORE
	W ! K B,C,D,T
	Q
HED	W @IOF,"Patient Name: ",$P(^DPT(DFN,0),"^",1),?50,"SSN: ",$P(^(0),"^",9),!!,?2,"VENDOR: ",$P(^FBAAV(DA,0),"^",1),!?5,$P(^FBAAV(DA,0),"^",3) S FBST=$P(^FBAAV(DA,0),"^",5)
	W !?5,$P(^FBAAV(DA,0),"^",4)_", "_$P($G(^DIC(5,+FBST,0)),U)_"   "_$P(^FBAAV(DA,0),"^",6)
	W !,?10,"('*' Reimb. to Patient  '+' Cancel. Activity   '#' Voided Payment)"
	W !," SVC DATE",?11,"CPT-MODIFIER",?30,"AMT CLAIMED",?42,"AMT PAID",?52,"CODE",?59,"INVOICE #",?69,"BATCH #",!,Q,!
	Q
WRT	I $E(IOST,1,2)["C-",$Y+3>IOSL S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1 Q:FBAAOUT  D HED
	S FBAADT=$P(^FBAAC(DFN,1,DA,1,B,0),"^",1),FBAADT=$E(FBAADT,4,5)_"/"_$E(FBAADT,6,7)_"/"_$E(FBAADT,2,3),B1=$P(L,"^",8),B2=$S(B1="":"",$D(^FBAA(161.7,B1,0)):$P(^FBAA(161.7,B1,0),"^",1),1:"")
	S A1=$P(L,"^",2)+.0001,A2=$P(L,"^",3)+.0001,A1=$P(A1,".",1)_"."_$E($P(A1,".",2),1,2),A2=$P(A2,".",1)_"."_$E($P(A2,".",2),1,2),FBIN=$P(L,"^",16)
	S FBAACPT=$P(L,"^",1),FBAACPT=$S($L(FBAACPT)<6:FBAACPT,1:$S($D(^ICPT(FBAACPT,0)):$P(^(0),"^",1),1:""))
	D FBCKO^FBAACCB2(DFN,DA,B,K)
	W !,$S(ZS="R":"*",1:""),$S(V="VP":"#",1:""),$S($G(FBCAN)]"":"+",1:""),?2,FBAADT,?12,FBAACPT_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:""),?30,"$",$J(A1,8),?42,"$",$J(A2,8),?52,T,?59,FBIN,?69,B2 D PMNT^FBAACCB2
	Q
Q	K DIC,DIE,DA,DF,DA(1),FBAAOUT,A,A1,A2,B1,B2,D1,FBAACPT,FBAADT,FBAAPD,FBIN,K,L,Q,X,Y,ZS,V,FBST
	Q
MORE	S T=$P(L,"^",5),T=$S(T>9:$P(^FBAA(161.27,T,0),"^"),1:T),ZS=$P(L,"^",20),V=$P(L,"^",21) D WRT
	Q
NOCL	W !,"Vendor has no Payment data for this Patient!",! G RDV

FBAUTHP
FBAUTHP	;AISC/CMR - PRINT AUTH. BY AUTH # ;OCT 5, 1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	W !! S DIR(0)="FO^1:50^K:X'?.N1""-"".N X",DIR("A")="Enter Authorization Number",DIR("?")="Enter the Authorization Number that appears on the 7079",DIR("?",1)="Enter numerics followed by a dash followed by numerics."
	D ^DIR K DIR I $D(DIRUT)!(Y']"") G END
	S DFN=+$P(Y,"-"),FBPROG=+$P(Y,"-",2)
	I 'DFN!('FBPROG) G ERR
	I '$D(^FBAAA(DFN,1,FBPROG)) G ERR
	S FBPROG="I FBI="_FBPROG,PI=""
	D ^FBAADEM,END G FBAUTHP
END	K FBPROG,DFN,FBAUT,FBAAOUT,PI,POP,X,Y,Z,DTOUT,DUOUT,DIRUT
	Q
ERR	W !,*7,"Invalid Authorization Number" D END G FBAUTHP

FBCH78
FBCH78	;AISC/DMK-SETS UP 7078/AUTHORIZATION FOR CONTRACT HOSPITAL ;27AUG89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S DIC("S")="I $P(^(0),U,15)=3&($P(^(0),U,12)=""Y"")" D ASKV^FBCHREQ G END:$E(X)="^"!($E(X)="")!('$D(FBDA))
	I $P(^FBAA(162.2,FBDA,0),"^",17)]"" W !!,*7,"There already is a 7078 set up for this request.",!,"The number is ",$P(^FB7078($P(^FBAA(162.2,FBDA,0),"^",17),0),"^")," .",! G END
EN	S FBVEN=$P(^FBAA(162.2,FBDA,0),"^",2)_";FBAAV(",FBVET=$P(^(0),"^",4),FBFRDT=$P(^(0),"^",5),FBFRDT=FBFRDT\1,FBDOA=$S($P(^(0),"^",19):$P(^(0),"^",19)\1,1:""),FBDXS=$P(^(0),"^",6) K DA
	W !! S %DT="APEX",%DT("A")="AUTHORIZATION TO DATE: " D ^%DT K %DT G END:X="^" S FBTODT=$S(X="":"",1:Y)
	I FBTODT]"",FBFRDT>FBTODT W !!,*7,?5,"Authorization To Date must be after Authorization From Date!",! G EN
	W !! S %DT="APEX",%DT("A")="DATE OF DISCHARGE: ",%DT("B")=$$DATX^FBAAUTL(FBTODT) D ^%DT K %DT G END:X="^" S FBDOD=$S(X="":"",1:Y)
	I FBDOD]"",FBTODT>FBDOD W !!,*7,?5,"Date of Discharge must not be earlier than the Authorization To Date!",! G EN
	S DIR(0)="162.4,5",DIR("A")="ADMITTING AUTHORITY" D ^DIR K DIR
	G END:$D(DIRUT) S FBADMIT=+Y
	S DIR(0)="162.4,6" D ^DIR K DIR
	G END:$D(DIRUT) S FBEST=+Y
FBPDIS	I FBTODT="" S DIR(0)="162.4,12" D ^DIR K DIR G END:$D(DUOUT),END:$D(DTOUT),NULL^FBCH780:X="" S FBPDIS=+Y
	;
ASKPT	I FBTODT]"" S DIR(0)="SAO^00:SURGICAL;10:MEDICAL;86:PSYCHIATRY",DIR("A")="BEDSECTION/TREATING SPECIALTY: ",DIR("?")="^D HELP^FBCH780" D ^DIR K DIR D NOUP^FBCHCD:$D(DIRUT) G ASKPT:$D(DIRUT) S FBPT=Y
7078	S PRCS("A")="Select Obligation Number: ",PRCS("TYPE")="FB" D EN1^PRCS58 G:Y=-1 NOGOOD S (X,FBCHOB)=$P(Y,"^",2) K PRCS("A") S PRCS("TYPE")="FB" D EN1^PRCSUT31 G:Y="" NOGOOD S FB7078=$P(FBCHOB,"-",2)_"."_Y S FBSEQ=Y
	S DIC="^FB7078(",DIC(0)="LQ",DLAYGO=162.4,X=FB7078 D ^DIC G:Y<0 PROB S (DA,FBAA78)=+Y
	S DIE="^FBAA(162.2,",DA=FBDA,DR="16////^S X=FBAA78" D ^DIE K DIE,DIC,DA,DR
SET78	S DIE="^FB7078(",DA=FBAA78,DR="[FBCH ENTER 7078]" D ^DIE K DIC,DIE,DR,DA
	D ^FBCH780 I $G(FBOUT) W !!,*7,"...deleting 7078." D DEL G END
	I +Y=0 W !!,*7,Y,!,"...deleting 7078.  Use 'Set-up a 7078' after adjusting 1358.",! D DEL G END
	K DIE,DIC,DA
	I $G(FBVET) S:'$G(DFN) DFN=FBVET D PTF^FBCH780
	G SHOW:FBTODT=""
AUTH	D HOME^%ZIS
	D:'$D(FBSITE(1)) SITEP^FBAAUTL Q:FBPOP  S FBPSA=$S($P(FBSITE(1),"^",3)="":"",$D(^DIC(4,$P(FBSITE(1),"^",3),0)):$P(^(0),"^"),1:"")
	S FBVEN=$P(FBVEN,";")
	I '$D(^FBAAA(FBVET,0)) L +^FBAAA(FBVET) K DD,DO S (X,DINUM)=FBVET,DIC="^FBAAA(",DIC(0)="LM",DLAYGO=161 D FILE^DICN L -^FBAAA(FBVET) G:Y<0 END
	S:'$D(^FBAAA(FBVET,1,0)) ^(0)="^161.01D^^"
	K DE,DQ,DR,DIE,DLAYGO
FBDCHG	S DIR(0)="161.01,.06" D ^DIR K DIR G END:$D(DTOUT),END:$D(DUOUT) D NULL1^FBCH780:X="" G FBDCHG:X="" S FBDCHG=+Y
FBPUR	S FBTYPE=6,DIR(0)="161.01,.07" D ^DIR K DIR S FBPUR=+Y
	G END:$D(DTOUT),END:$D(DUOUT)
FBPSA	S DIR(0)="161.01,101" D ^DIR K DIR G END:$D(DTOUT),END:$D(DUOUT) D NULL1^FBCH780:X="" G FBPSA:X="" S FBPSA=+Y
	;file entry in authorization multiple of file 161
	S DIC="^FBAAA("_FBVET_",1,",DIC(0)="LM",DLAYGO=161,DA(1)=FBVET,X=FBFRDT K DD,DO D FILE^DICN G:Y<0 END S DA=+Y,DIE("NO^")="" ;DA(1)=FBVET
	S FB78=FBAA78_";FB7078("
	S DIE=DIC,DR=".02////^S X=FBTODT;.03////^S X=6;100////^S X=DUZ;1////^S X=""YES"";.055////^S X=FB78;.06////^S X=FBDCHG;S FBTYPE=6;.04////^S X=FBVEN;.065////^S X=FBPT;101////^S X=FBPSA;.095////^S X=1"
	S DR(1,161.01,1)="I $D(^FB7078(FBAA78,1,0)) S ^FBAAA(DA(1),1,DA,2,0)=^(0) F FBI=1:1 Q:'$D(^FB7078(FBAA78,1,FBI,0))  I $D(^(0)) S ^FBAAA(DA(1),1,DA,2,FBI,0)=^(0);.07////^S X=FBPUR;.08///^S X=FBDXS;.096;.097//^S X=""N"""
	D ^DIE K DIE,DR
	S (DIC,DIE)="^FB7078(",DA=FBAA78,DR="9///^S X=""C"";12///^S X=""@""" D ^DIE K DIE,DIE,DA,X
SHOW	W !! S DA=FBAA78,DR="0;1",DIC="^FB7078(" D EN^DIQ
	;
END	K D,DA,DIC,DIE,DIR,DLAYGO,DR,FBDA,FB7078,FBAA78,FBPT,FBTYPE,FBVEN,FBZ,FBVET,FBFRDT,FBTODT,J,S,POP,X,Y,DFN,FBCHOB,FBCOMM,FBDFN,FBEST,FBI,FBLENT,FBMENT,FBNAME,FBSEQ,FBSSN,FBSW,I,K,PRC,VAL,FB,FBFLG,ZZ,FBPSA,FBSITE,FB78,FBOUT
	K FBDCHG,FBPUR,FBPDIS,FBADMIT,FBDXS,A,D0,D1,X1,DIRUT,DTOUT,DUOUT,FBDOA,FBDOD,FBPOP,FBZZ,ZZZ,PRCSCPAN
	Q
PROB	W !!,"The reference number did not get set up with the",!,"IFCAP software. Contact your package coordinator." G END
NOGOOD	S DIR(0)="Y",DIR("A")="Obligation number selected is invalid or you are not a control point user in the IFCAP package!  Try again",DIR("B")="YES" D ^DIR K DIR G END:$D(DIRUT)!'Y,7078
	;
OUTP	;ENTRY TO DISPLAY A 7078
	S DIC="^FB7078(",DIC(0)="AEQM",D="D",DIC("A")="Select Patient: " D IX^DIC G END:X=""!(X="^") S (DA,FBDA)=+Y,DR="0;1" W !! D EN^DIQ
	I $$DISCH^FBCH780(FBDA)]"" W ?2,"DISCHARGE TYPE: ",$$DISCH^FBCH780(FBDA),!
	G OUTP
DEL	S DA=FBAA78,DIK="^FB7078(" D ^DIK K DIK S DA=$O(^FBAA(162.2,"AM",+FBAA78,0)) I DA S DIE="^FBAA(162.2,",DR="16///@" D ^DIE

FBCH780
FBCH780	;AISC/DMK-7078/AUTHORIZATION CON'T ;08JUN90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DISP	D HOME^%ZIS W @IOF
	W !! S DA=FBAA78,DR="0;1",DIC="^FB7078(" D EN^DIQ
ASK	S DIR(0)="Y",DIR("A")="Is this Correct",DIR("B")="NO" D ^DIR K DIR S:$D(DIRUT) FBOUT=1 Q:$G(FBOUT)  G EDIT:'Y
	S DFN=+$P($G(^FB7078(+FBAA78,0)),"^",3)
	W !,?2,"....Posting to 1358",! D WAIT^DICD,POST Q
END	W ! Q
EDIT	W ! S (DIC,DIE)="^FB7078(",DA=FBAA78,DR="[FBCH EDIT 7078]" D ^DIE
	G DISP
HELP	W !!,"Select one of the following: ",!,?18,"'00' FOR SURGICAL",!,?18,"'10' FOR MEDICAL",!,?18,"'86' FOR PSYCHIATRY",! Q
POST	S PRCS("X")=FBCHOB,PRCS("TYPE")="FB" D EN3^PRCS58 I Y=-1 W !!,*7,"1358 not available for posting!",! Q
	S FBCOMM=$S($D(FBNAME):FBNAME_" - "_FBSSN,1:"Estimated amount")
	D NOW^%DTC S X=FBCHOB_"^"_%_"^"_FBEST_"^"_""_"^"_FBSEQ_"^"_FBCOMM_"^"_DFN_";"_+FBAA78_";"_$P(FBCHOB,"-",2),PRCS("TYPE")="FB"
	D EN2^PRCS58 Q
NULL	W !,*7,"Enter the reason for pending disposition or an '^' to exit",! G FBPDIS^FBCH78
NULL1	W !,*7,"This is a required response. Enter an '^' to exit.",! Q
	;
DISCH(X)	;X = Pointer for 7078
	;output = patient's Type of Discharge
	N Y
	S Y=$O(^FBAAI("E",X_";FB7078(",0))
	I 'Y Q Y
	S Y=+$P($G(^FBAAI(Y,0)),U,21)
	Q $S($P($G(^FBAA(162.6,Y,0)),U)]"":$P(^(0),U),1:"")
	;
PTF	;called to create a non-va ptf record at admission time for an
	;authorized claim.  Called from FBCH78.
	;
	I '$G(DFN)!('$G(FBAA78)) W !?5,*7,"Unable to create Non-VA PTF Record.",! Q
	S Y=$P($G(^FB7078(+FBAA78,0)),U,4)_"^"_1
	D WAIT^DICD,CREATE^DGPTFCR
	W !?5,*7,$S(Y>0:"Non-VA PTF Record Created.",1:"Unable to create Non-VA PTF Record."),!
	Q

FBCH78A
FBCH78A	;AISC/DMK-PRINT 7078 CONTINUED FROM FBCHP78 ;06FEB89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
HED	W:'$G(FBPG) @IOF K:$G(FBPG) FBPG W UL,!,?5,"Department of Veterans Affairs",?58,"AUTHORIZATION AND INVOICE FOR MEDICAL AND HOSPITAL SERVICES",!,UL,!
	Q
BOT	W !,"SPECIAL PROVISIONS: Acceptance of this authorization to render service is governed by the following:",!!
	W "1. ACCEPTANCE OF THIS AUTHORIZATION AND PROVIDING OF SUCH TREATMENT OR SERVICES SUBJECTS YOU, THE PROVIDER OF CARE, TO",!,?3,"THE PROVISIONS OF PUBLIC LAW 93-579, THE PRIVACY ACT OF 1974, TO THE EXTENT OF THE RECORDS "
	W "PERTAINING TO THE VA",!,?3,"AUTHORIZED TREATMENT OR SERVICES OF THIS VETERAN.",!
	W !,"2. Fees or rates listed represent maximum allowance for services specified. In no event should charges be made to the",!,?3,"VA in excess of usual and customary charges to the general public for similar services.",!
	W !,"3. Payment by the VA is payment in full for authorized services rendered.",!
	W !,"4. Unless otherwise approved by the VA, services are limited in type and extent to those shown on this authorization.",!,?3,"If services are not initiated for any reason, return a copy of the authorization to the issuing ",!
	W ?3,"office with a brief explanation.",!
	W !,"5. A copy of the Operative Report will be forwarded to the Authorizing station within one week following any major",!,?3,"surgery.",!
	W !,"6. A copy of the hospital summary will be forwarded to the authorizing station within ten work days following the ",!,?3,"release of the patient from the hospital.",!
	W UL,!,?16,"All questions relating to this authorization should be referred to the issuing VA Office",!,UL,!,"VA Form 10-7078" Q
	;
FISCAL	;SETS THE FISCAL SYMBOL BLOCK FOR 7078
	S PRC("SITE")=FB("SITE"),PRCS("X")=PRC("SITE")_"-"_$P($P(FB(0),"^"),"."),PRCS("TYPE")="FB" D EN1^PRCS58
	S FB("SYM")=$P(Y,"^",4)_" "_$P(FB(0),"^")_"  FCP "_$P(Y,U,3) K PRC("SITE"),PRCSI,Y Q
	;
CONT(X,Y)	;get contract for CNH authorization
	;X=IEN of vendor
	;Y=from date of authorization
	I $S('$G(X):1,'$G(Y):1,1:0) Q ""
	I '$O(^FBAA(161.21,"ACR",X,-Y+.9)) Q ""
	N Z
	S Z=$P(^FBAA(161.21,+$O(^(+$O(^FBAA(161.21,"ACR",X,-Y+.9)),0)),0),U,1,3)
	Q $S($P(Z,U,3)>Y:$P(Z,U),1:"")

FBCHACT
FBCHACT	;AISC/DMK-CALCULATES NON-VA HOSP ACTIVITY ;03MAY90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S Q="",$P(Q,"-",80)="-"
	W !!?18,"NON-VA HOSPITAL ACTIVITY REPORTS",!?17,$E(Q,1,34),!
	S DIR(0)="S^1:PUBLIC HOSPITAL;2:PRIVATE HOSPITAL;3:FEDERAL HOSPITAL" D ^DIR K DIR G END:$D(DUOUT),H^XUS:$D(DTOUT) S FBK=+Y
	S FBK=$S(FBK=1:1,FBK=2:9,FBK=3:10,1:"")
	G END:FBK="" S FBHED=Y(0)
EN	W !!,?5,"This option will calculate the ",FBHED," Activity Report. ",!!
ASKDT	S FBTYPE=6,%DT="EAP",%DT("A")="Enter Month and Year: " D ^%DT G END:X="^"!(X="") S X=Y X $S($E(X,6,7)'="00":"K X W !,""Do not specify day of month""",X>DT:"K X W !,""Not future dates""",1:"") I '$D(X) G ASKDT
	S FBCHDT=X D DAYS^FBAAUTL1 S FBENDDT=FBCHDT+X
	S VAR="FBCHDT^FBENDDT^FBK^FBHED",VAL=FBCHDT_"^"_FBENDDT_"^"_FBK_"^"_FBHED,PGM="START^FBCHACT" D ZIS^FBAAUTL G:FBPOP END
START	U IO W:$E(IOST,1,2)["C-" @IOF S DCNT=0,FBTYPE=6 K ^TMP("FBCH",$J)
	F I=FBCHDT:0 S I=$O(^FB7078("AD",FBTYPE,I)) Q:I'>0!(I>FBENDDT)  F J=0:0 S J=$O(^FB7078("AD",FBTYPE,I,J)) Q:J'>0  D VENTYPE Q:'FBVENTP  S DCNT=DCNT+1,^TMP("FBCH",$J,"AD",FBVENTP,J,I)=""
	S ACNT=0
	F I=FBCHDT:0 S I=$O(^FB7078("AA",FBTYPE,I)) Q:I'>0!(I>FBENDDT)  F J=0:0 S J=$O(^FB7078("AA",FBTYPE,I,J)) Q:J'>0  D VENTYPE Q:'FBVENTP  S ACNT=ACNT+1,^TMP("FBCH",$J,"AA",FBVENTP,J,I)=""
	S RCNT=0
	F K=0:0 S K=$O(^FB7078("AA",FBTYPE,K)) Q:K'>0!(K>FBENDDT)  F J=0:0 S J=$O(^FB7078("AA",FBTYPE,K,J)) Q:J'>0  I $P(^FB7078(J,0),"^",5)]""&($P(^(0),"^",5)>FBENDDT) D VENTYPE Q:'FBVENTP  S RCNT=RCNT+1,^TMP("FBCH",$J,"AR",FBVENTP,J,K)=""
	I $D(^FB7078("AC","I")) F I=0:0 S I=$O(^FB7078("AC","I",I)) Q:I'>0  F J=0:0 S J=$O(^FB7078("AC","I",I,J)) Q:J'>0  D VENTYPE Q:'FBVENTP  S RCNT=RCNT+1
	D ^FBCHACT1,^FBCHACT0
END	K ACNT,DCNT,RCNT,DUOUT,DTOUT,DIRUT,I,J,K,L,Q,QQ,FBK,FBHED,X,Y,FBCHDT,FBENDDT,^TMP("FBCH",$J),ZZ,FBADMIT,FB,FBBED,PTYPE,VTYPE,DAYS,^TMP("FB",$J),FBVENTP
	D CLOSE^FBAAUTL Q
VENTYPE	;GET VENDOR TYPE
	S FBVENTP="" Q:'J  Q:'$D(^FB7078(J,0))
	Q:$P($G(^FB7078(J,0)),U,9)="DC"
	S FBVENTP=$S($P($P(^FB7078(J,0),"^",2),";",2)="FBAAV(":$P($P(^(0),"^",2),";",1),1:""),FBVENTP=$S(FBVENTP="":"",1:$S($D(^FBAAV(FBVENTP,0)):$P(^(0),"^",7),1:""))
	I FBVENTP="" S FBVENTP=1
	Q

FBCHACT0
FBCHACT0	;AISC/DMK-NON-VA HOSPITAL ACTIVITY CONT ;18APR90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ENT	S (SCNT,MCNT,PCNT,SDED,MDED,PDED,ASCNT,AMCNT,APCNT,DSCNT,DMCNT,DPCNT,RSCNT,RMCNT,RPCNT,FBDAYS,FBMDAY,FBSDAY,FBPDAY)=0,FBBED=""
	F J="AA","AD","AR" F I=0:0 S I=$O(^TMP("FBCH",$J,J,FBK,I)) Q:I'>0  I $D(^FBAAA("AG",I_";FB7078(")) D 161
	D EN,WRT
	K AMCNT,APCNT,ASCNT,DMCNT,DPCNT,DSCNT,FBADDT,FBCHDT,FBDA,FBDAYS,FBDED,FBFRDT,FBMDAY,FBPDAY,FBSDAY,FBTODT,FBTYPE,I,J,MCNT,PCNT,PDED,Q,QQ,RMCNT,RPCNT,RSCNT,SCNT,SDED,X,Y,MDED Q
161	S FBDA(1)=$O(^FBAAA("AG",I_";FB7078(",0)),FBDA=$O(^FBAAA("AG",I_";FB7078(",FBDA(1),0)) Q:'$D(^FBAAA(FBDA(1),1,FBDA,0))  S FBADDT=$P(^(0),"^",18),FBFRDT=$P(^(0),"^"),FBTODT=$P(^(0),"^",2)
	S FBFRDT=$S(FBCHDT>FBFRDT:FBCHDT,1:FBFRDT),FBTODT=$S(FBTODT="":FBENDDT,FBTODT>FBENDDT:FBENDDT,1:FBTODT)
	I FBADDT="00" S SCNT=SCNT+1
	I FBADDT=10 S MCNT=MCNT+1
	I FBADDT=86 S PCNT=PCNT+1
	I J="AA" S ASCNT=ASCNT+SCNT,AMCNT=AMCNT+MCNT,APCNT=APCNT+PCNT D RESET Q
	I J="AD" S DSCNT=DSCNT+SCNT,DMCNT=DMCNT+MCNT,DPCNT=DPCNT+PCNT D RESET Q
	I J="AR" S RSCNT=RSCNT+SCNT,RMCNT=RMCNT+MCNT,RPCNT=RPCNT+PCNT D RESET Q
	Q
WRT	D HED
	W !,"MEDICINE",!,"--------" D HED1
	W ?3,AMCNT,?17,DMCNT-MDED,?32,MDED,?45,RMCNT,?59,FBMDAY,?73,^TMP("FB",$J,FBK,"00"),!
	W !,"SURGERY",!,"-------" D HED1
	W ?5,ASCNT,?20,DSCNT-SDED,?32,SDED,?45,RSCNT,?59,FBSDAY,?73,^TMP("FB",$J,FBK,10),!
	W !,"PSYCHIATRY",!,"----------" D HED1
	W ?5,APCNT,?20,DPCNT-PDED,?32,PDED,?45,RPCNT,?59,FBPDAY,?73,^TMP("FB",$J,FBK,86),!
	Q
HED	S Q="=",$P(Q,"=",79)="=",Y=FBCHDT X ^DD("DD") S FBCHDT=Y
	W !,?21,FBHED_" ACTIVITY REPORT",!,?21,"----------------------------------",!,?1,"For the month of: ",FBCHDT,!,Q,! Q
RESET	S (MCNT,SCNT,PCNT)=0 Q
DAYS	S FBDAYS=0,X1=FBTODT,X2=FBFRDT D D^%DTC S FBDAYS=$S(X<1:1,1:X)
	Q
HED1	W !?41,"PATIENTS",?57,"DAYS OF",?70,"DAYS OF",!?1,"ADMISSIONS",?15,"DISCHARGES",?30,"DEATHS",?40,"REMAINING",?58,"CARE",?69,"UNAUTH CARE",! F QQ=1:1:80 W "-"
	W ! Q
EN	F I=FBCHDT:0 S I=$O(^FB7078("AD",FBTYPE,I)) Q:I'>0  F J=0:0 S J=$O(^FB7078("AD",FBTYPE,I,J)) Q:J'>0  D VENTYPE^FBCHACT Q:FBVENTP'=FBK  I $D(^FB7078(J,0)) S FBADMIT=$P(^(0),"^",4),FBTODT=I D GETBED,CHK
	Q
CHK	Q:FBADMIT>FBENDDT  S FBFRDT=$S(FBADMIT<FBCHDT:FBCHDT,1:FBADMIT)
	S FBTODT=$S(FBTODT>FBENDDT:FBENDDT,1:FBTODT)
	D DAYS I FBFRDT>FBCHDT&(FBTODT=FBENDDT) S FBDAYS=FBDAYS-1
	I FBBED="00" S FBSDAY=FBSDAY+FBDAYS I FBDED=2!(FBDED=3) S SDED=SDED+1 K FBDED
	I FBBED=10 S FBMDAY=FBMDAY+FBDAYS I FBDED=2!(FBDED=3) S MDED=MDED+1 K FBDED
	I FBBED=86 S FBPDAY=FBPDAY+FBDAYS I FBDED=2!(FBDED=3) S PDED=PDED+1 K FBDED
	S FBBED="" Q
GETBED	S FB(1)=$O(^FBAAA("AG",J_";FB7078(",0)) Q:FB(1)=""  S FB=$O(^FBAAA("AG",J_";FB7078(",FB(1),0)) Q:FB=""  I $D(^FBAAA(FB(1),1,FB,0)) S FBBED=$P(^(0),"^",18),FBDED=$P(^(0),"^",15)
	Q

FBCHACT1
FBCHACT1	;AISC/DMK-NON VA UNAUTHORIZED DAYS FOR ACTIVITY ;14SEP90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K ^TMP("FB",$J) F I="00",10,86 S DAYS(I)=0,^TMP("FB",$J,FBK,I)=0
	F I=FBCHDT:0 S I=$O(^FB583("AD",FBTYPE,I)) Q:I'>0!(I>FBENDDT)  F J=0:0 S J=$O(^FB583("AD",FBTYPE,I,J)) Q:J'>0  I $D(^FB583(J,0)) S FB(0)=^(0) D VTYPE S ^TMP("FB",$J,VTYPE,PTYPE)=DAYS(PTYPE)
	Q
VTYPE	S VTYPE=$P(FB(0),"^",3),VTYPE=$S(VTYPE="":"",1:$S($D(^FBAAV(VTYPE,0)):$P(^(0),"^",7),1:""))
	I VTYPE="" S VTYPE=1
	S PTYPE=$P(FB(0),"^",10)
	S FBFRDT=$P(FB(0),"^",13),FBFRDT=$S(FBFRDT<(FBCHDT+1):FBCHDT+1,1:FBFRDT)
	S FBTODT=$P(FB(0),"^",14) D DAYS^FBCHACT0
	Q:VTYPE'=FBK
	I PTYPE="00" S DAYS(PTYPE)=DAYS(PTYPE)+FBDAYS
	I PTYPE=10 S DAYS(PTYPE)=DAYS(PTYPE)+FBDAYS Q
	I PTYPE=86 S DAYS(PTYPE)=DAYS(PTYPE)+FBDAYS Q
	Q

FBCHC78
FBCHC78	;AISC/DMK-CANCEL A 7078 ;9/23/92  15:05
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;check if user holds 'FBAASUPERVISOR' security key
	Q:'$G(DUZ)
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !,"You must be a holder of the 'FBAASUPERVISOR' key to cancel a 7078.",! Q
	;
	;get station number from site parameter file
	D SITEP^FBAAUTL G END:FBPOP
	S FBPSA=$E($P($G(^DIC(4,+$P($G(FBSITE(1)),"^",3),99)),"^"),1,3)
	;
ASK	;get 7078 entry to cancel
	W ! S DIC(0)="AEQMZ",DIC="^FB7078(",D="D",DIC("A")="Select Patient: ",DIC("S")="I $P(^(0),U,9)'=""DC""&($P(^(0),U,11)=$S($D(FBNH):7,1:6))" D IX^DIC K DIC,D G END:X=""!(X="^"),ASK:Y<0
	S FB7078=+Y_";FB7078(",FBAAOB=FBPSA_"-"_$P(Y(0,0),".")_"-"_$P(Y(0,0),".",2),DFN=+$P(Y(0),"^",3),FB(161)=+$O(^FBAAA("AG",FB7078,DFN,0)),FBMM=$E($P(Y(0),U,4),4,5)
	S FBADDT=$P(Y(0),U,4),FBVEN=$P(Y(0),U,2)
	I $D(FBNH) S DIC="^FBAACNH(",DIC(0)="MZ",DIC("S")="I $P(^(0),U,2)=DFN&($P(^(0),U,10)=FB(161))",X=$P(Y(0),U,4) D ^DIC K DIC I +Y>0 W !,*7,"Must delete all movements associated with this authorization before canceling.",! G END
	;
	;check if payments made against the 7078
	;if so do not allow a user to cancel
	I $D(^FBAAI("E",FB7078)) W !!,*7,"There is already an invoice entered for this hospitalization.  Cannot delete!",!! G END
	I $D(^FBAAC("AM",FB7078)) W !!,*7,"There already are ancillary services entered against this authorization.  Cannot delete!",!! G END
	;
	;display 7078 and ask if ok to cancel
	S DA=+FB7078,DIC="^FB7078(",DR="0;1" D EN^DIQ
	W ! S DIR(0)="Y",DIR("A")="Are you sure you want to cancel",DIR("B")="No" D ^DIR K DIR G FBCHC78:'Y,END:$D(DIRUT)
	;
	;cancelling 7078 and associated athorization in file 161
	;deleting associated 7078 from the notification file in civil hospital
	;remove entries assoiciated with CNH in 161.23
	;removing estimated amount from 1358
	I '$D(FBNH) S DA=$O(^FBAA(162.2,"AM",+FB7078,0)) I DA S DIE="^FBAA(162.2,",DR="16///@" D ^DIE K DIC,DIE W " ."
	S DA(1)=DFN,DA=$O(^FBAAA("AG",FB7078,DFN,0)) I DA S DIK="^FBAAA("_DFN_",1," D ^DIK K DIK,DA W "."
	S DA=+FB7078,DIE="^FB7078(",DR=".013////^S X=DUZ;.014////^S X=DT;9////^S X=""DC""" D ^DIE K DIE,DIC W "."
	I $D(FBNH) S FBI=0 F  S FBI=$O(^FBAA(161.23,"AC",+FB7078,FBI)) Q:'FBI  I $D(^FBAA(161.23,FBI,0)) D
	. S DA=FBI,DIK="^FBAA(161.23," D ^DIK K DIK W "."
	D PTF
	W !!,"Authorization cancelled.  Now updating 1358.",!
	D 1358 I $D(FBERR) W !,"Unable to affect 1358 adjustment.  Use appropriate IFCAP options.",!
	W "...  Finished",!
	;
END	K DA,DR,DIE,DIC,DFN,FB,FBI,FB7078,FBAAOB,FBERR,PRC,PRCS,PRCSX,FBPSA,FBZZ,FBSITE,X,Y,FBPOP,FBNH,FBMM,FBADDT,FBVEN
	Q
1358	;subtract estimated dollar amount from 1358
	;FBAAOB=FULL OBLIGATION NUMBER (STATION #-OBLIGATION #-REF #)
	;FBERR returned if IFCAP call fails
	;internal entry # in 424 = $O(^PRC(424,"B",FBAAOB,0))
	;
	;check if 1358 available for posting
	I '$$INTER() W !,*7,"Unable to locate reference number on 1358.",! S FBERR=1 Q
	S PRCS("X")=$P(FBAAOB,"-",1,2),PRCS("TYPE")="FB" D EN3^PRCS58 I Y=-1 W !,*7,"1358 Not available for posting.",! S FBERR=1 Q
	D NOW^%DTC
	S PRCSX=$$INTER()_"^"_%_"^"_0_"^"_"Authorization has been cancelled"_"^"_1_"^"
	S PRCS("TYPE")="FB" D ^PRCS58CC I Y'=1 W !,*7,$P(Y,"^",2),! S FBERR=1 Q
	Q
	;
INTER()	;get internal entry number from file 424
	;first check interface id x-ref
	;second check is to "B" x-ref to stay backward compatible with IFCAP3.6
	;
	I '$G(FBNH),$D(^PRC(424,"E",DFN_";"_+FB7078_";"_$P(FBAAOB,"-",2))) Q $O(^(DFN_";"_+FB7078_";"_$P(FBAAOB,"-",2),0))
	I $G(FBNH),$D(^PRC(424,"E",DFN_";"_+FB7078_";"_$P(FBAAOB,"-",2)_";"_FBMM)) Q $O(^(DFN_";"_+FB7078_";"_$P(FBAAOB,"-",2)_";"_FBMM,0))
	I $D(^PRC(424,"B",FBAAOB)) Q $O(^(FBAAOB,0))
	Q 0
	;
CNH	;entry point to cancel an authorization associated with the
	;community nursing home program.
	S FBNH=1 G FBCHC78
	Q
PTF	;locate and delete PTF record
	;FBADDT=Authorized from Date
	;FBVEN= ien of vendor
	S DA=$O(^DGPT("AFEE",DFN,FBADDT,0)) I $S('$G(DA):1,$D(^DGP(45.84,DA)):1,$D(^DGP(45.83,"C",DA)):1,1:0) G ERR
	S DIK="^DGPT(" D ^DIK K DA,DIK W "." Q
	;
ERR	;write ptf error and quit
	W !?5,"Unable to delete PTF record.",!
	K DA Q

FBCHCD
FBCHCD	;AISC/DMK-COMPLETE DISPOSITION ;23JAN88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASK	S DIC="^FB7078(",DIC(0)="AEQMZ",D="D",DIC("A")="Select Veteran: ",DIC("S")="I $P(^(0),U,9)=""I""" D IX^DIC G END:$E(X)="^"!(X=""),ASK:Y<0 S (DA,FBAA78)=+Y,FBTYPE=6,FB(0)=Y(0),FBDXS="",FBFRDT=$P(FB(0),"^",4) K DIC("S"),D
EN	S DIR(0)="162.4,4",DIR("A")="AUTHORIZATION TO DATE" D ^DIR
	G END:$D(DUOUT),END:+Y'>0,H^XUS:$D(DTOUT) S FBTODT=+Y K DIR,X,Y
	I FBTODT]"",FBFRDT>FBTODT W !!,*7,?5,"Authorization To Date must be after Authorization From Date!",! G EN
	S DIR(0)="162.4,4.5",DIR("A")="DATE OF DISCHARGE" D ^DIR K DIR
	G END:$D(DUOUT),END:+Y'>0,H^XUS:$D(DTOUT) S FBDOD=+Y K X,Y
	I FBDOD]"",FBTODT>FBDOD W !!,*7,?5,"Date of Discharge must not be earlier than the Authorization To Date!",! G EN
	S FBVEN=$P(FB(0),"^",2),FBVET=$P(FB(0),"^",3),DIE=DIC,DR="4////^S X=FBTODT;S:X="""" (Y,FBTODT)="""";S FBTODT=X;4.5////^S X=FBDOD" D ^DIE G END:FBTODT=""
ASKPT	W ! S DIR(0)="SAO^00:SURGICAL;10:MEDICAL;86:PSYCHIATRY",DIR("A")="BEDSECTION/TREATING: ",DIR("?")="^D HELP^FBCH780" D ^DIR D NOUP:$D(DIRUT) G ASKPT:$D(DIRUT) S FBPT=Y K X,Y,DIRUT,DIR G AUTH^FBCH78
EDIT	;ENTRY TO EDIT A COMPLETED DISPOSITION
	S FBEDAT=0
	S DIC="^FB7078(",DIC(0)="AEMQZ",D="D",DIC("A")="Select Patient: ",DIC("S")="I $P(^(0),U,9)=""C""&($P(^(0),U,11)=6)" D IX^DIC G END:X="^"!(X=""),EDIT:Y<0 S FB7078=+Y,FBVET=$P(Y(0),"^",3),FBHTDT=$P(Y(0),"^",5),FBHFDT=$P(Y(0),"^",4)
	G END:'$D(^FBAAA("AG",FB7078_";FB7078("))
	I $D(^FBAAI("E",FB7078_";FB7078(")) S FBEDAT=1 W !!,*7,"Payment already exists for this disposition, editing of dates not allowed!",!
	I 'FBEDAT S DA=$O(^FBAA(162.2,"AM",+FB7078,0)) I DA]"" S DIE="^FBAA(162.2,",DR="4;S FBFRDT=(X\1)",DIE("NO^")="" D ^DIE K DIE,DR
	I 'FBEDAT,(DA']"") G END
	I 'FBEDAT,$G(FBFRDT) S DIE="^FB7078(",DA=+FB7078,DR=$S(FBHFDT'=FBFRDT:"3///^S X=FBFRDT;I 1;",1:"")_"4;S FBTODT=X",DIE("NO^")="" D ^DIE K DIE,DR
	G END:+$G(FBTODT)'>0,END:'$G(FBFRDT)
	I 'FBEDAT,(FBHTDT'=FBTODT),(FBTODT>$P(^FB7078(+FB7078,0),"^",16)) W !!,*7,"Date of Discharge must now be edited to be equal to or later than",!,"the Authorization To Date.",! S FBDR="4.5////^S X=FBTODT;I 1;"
	I 'FBEDAT S FBDR=$G(FBDR)_"4.5;"
	S FBTYPE=6,DIE="^FB7078(",DA=+FB7078,DR=$S($G(FBDR):FBDR,1:"")_"7///^S X=""@"";5ADMITTING AUTHORITY~",DIE("NO^")="" D ^DIE K DIC,DIE,D,DR,DA,FBDR
	S DA(1)=FBVET,DIC="^FBAAA("_FBVET_",1,",DIC(0)="EQM",DA=$O(^FBAAA("AG",FB7078_";FB7078(",FBVET,0))
	S DR=$S(FBEDAT'=1:".01////^S X=FBFRDT;",1:"")_$S(FBEDAT'=1:".02////^S X=FBTODT;",1:"")_".06;D DEFPTC^FBCHCD;.065///^S X=FBPT;.07;.021;.096;.097//^S X=""NO"""
	S DR(1,161.01,1)="I $D(^FBAAA(FBVET,1,DA,2,0)) S ^FB7078(FB7078,1,0)=^(0) F FBI=1:1 Q:'$D(^FBAAA(FBVET,1,DA,2,FBI,0))  I $D(^(0)) S ^FB7078(FB7078,1,FBI,0)=^(0);101",DIE=DIC,DIE("NO^")="" W ! D ^DIE K DIE,DR,DIC
	W !! G EDIT
END	K DIC,DIE,DA,DR,FB,FBPROG,FBAAOUT,FBSW,FBVET,FB7078,FBHTDT,FBTODT,FBTYPE,FBAA78,FBFRDT,FBVEN,K,PTYPE,X,Y,Z,FBDEF,FBPT,FBI,FBHFDT,J,FBZZ,FBDA,FBDFN,FBDXS,FBNAME,FBSSN,FBZZ,ZZZ,FBDOD,FBEDAT
	Q
DEFPTC	S FBDEF=$P(^FBAAA(FBVET,1,DA,0),U,18),FBDEF=$S(FBDEF="00":"SURGICAL",FBDEF=10:"MEDICAL",FBDEF=86:"PSYCHIATRY",1:"")
	N X,DP,Y,DQ S DIR(0)="SA^00:SURGICAL;10:MEDICAL;86:PSYCHIATRY",DIR("A")="BEDSECTION/TREATING SPECIALTY: ",DIR("?")="^D HELP^FBCH780",DIR("B")=FBDEF D ^DIR D NOUP:$D(DUOUT) G DEFPTC:$D(DIRUT) S FBPT=Y K DIR,DIRUT Q
NOUP	W !!,*7,?5,"This is a mandatory response. Entering an '^' is not allowed!",! D HELP^FBCH780 Q

FBCHCO
FBCHCO	;AISC/DMK-CONTRACT HOSPITAL OUTPATIENT PAYMENTS ;16MAY90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN583	;entry point for 583
	S FBCHCO=1 D ^FBAACO
Q	K FB583,FB7078,FBCHCO,FBCNUM,FBCONT,FBD1,FBLOC,FBPOP,FBPSA,FBSITE,FBVEN,PRC,PRCSI,FBFLG,FBSW,FBTV,PSA,TBN,XCNP,X,Y Q
	;
PRBT	;entry point for patient reimbursement
	S FBAAPTC="R"
	G FBCHCO

FBCHCR
FBCHCR	;AISC/CMR-CIVIL HOSPITAL COST REPORT ;4/28/93  11:01
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;FBTP SET IN OPTION ENTRANCE ACTION (6=CH/7=CNH)
	;FBREF SET IN OPTION ENTRANCE ACTION (FBREF="FB7078" OR "FB583")
	D DATE^FBAAUTL G END:FBPOP
	S DIR(0)="S^D:DETAILED REPORT;S:SUMMARY ONLY",DIR("A")="Choose Report Type",DIR("B")="S" D ^DIR K DIR G END:$D(DIRUT)  S FBRT=Y W !
	S VAR="BEGDATE^ENDDATE^FBTP^FBREF^FBRT",VAL=BEGDATE_"^"_ENDDATE_"^"_FBTP_"^"_FBREF_"^"_FBRT,PGM="START^FBCHCR",IOP="Q" D ZIS^FBAAUTL G END:FBPOP
START	K ^TMP($J,"FBCHCR") S (FBIEN,FBCTR,FBTAMT,FBTLOS,FBAAOUT)=0,BEGDT=BEGDATE-1,Q="-",$P(Q,"-",30)="-",QQ="=",$P(QQ,"=",80)="="
	F FBDT=BEGDT:0 S FBDT=$O(^FBAAI("AD",FBDT)) Q:FBDT'>0!(FBDT>ENDDATE)  F  S FBIEN=$O(^FBAAI("AD",FBDT,FBIEN)) Q:FBIEN'>0  S FBTYPE=$P($G(^FBAAI(FBIEN,0)),"^",12) I FBTYPE]"",(FBTP=FBTYPE) D
	.S FBINV=^FBAAI(FBIEN,0),FBPTC=$P(FBINV,"^",19) S:FBPTC="" FBPTC="99" S @FBREF=$S($P(FBINV,"^",5)[FBREF:+$P(FBINV,"^",5),1:"") Q:@FBREF<1
	.S DFN=$P(FBINV,"^",4) Q:'$G(DFN)  S FBNAME=$$NAME^FBCHREQ2(DFN),FBAMT=$P(FBINV,"^",9),FBDRG=$P(FBINV,"^",24),X1=$P(FBINV,"^",7),X2=$P(FBINV,"^",6) D ^%DTC S FBLOS=$S(X>0:X,1:1)
	.I FBLOS>0 S FBSUM=$G(^TMP($J,"FBCHCR","SUM",FBPTC,FBLOS)),$P(FBSUM,"^")=($P(FBSUM,"^")+1),$P(FBSUM,"^",2)=($P(FBSUM,"^",2)+FBAMT) D
	..S ^TMP($J,"FBCHCR","SUM",FBPTC,FBLOS)=FBSUM
	.S ^TMP($J,"FBCHCR",FBPTC,FBNAME,@FBREF,"INV",FBIEN)=DFN_"^"_FBAMT_"^"_FBDRG_"^"_FBLOS
	D ANCIL^FBCHCR1
	U IO W:$E(IOST,1,2)["C-" @IOF I '$D(^TMP($J,"FBCHCR")) S FBEND=1 D HED W !!,"No payments found within specified timeframe!" G END
DETAIL	S (FBIEN,FBPTC,FBREF1,DFN,FBAMT,FBLOS,FBANC,L,M,N)=0,(FBNAME,FBDRG,FBCHK)=""
	I FBRT="D" D HED
	F  S FBPTC=$O(^TMP($J,"FBCHCR",FBPTC)) Q:FBPTC=""!(FBAAOUT)  F  S FBNAME=$O(^TMP($J,"FBCHCR",FBPTC,FBNAME)) Q:FBNAME=""!(FBAAOUT)   F  S FBREF1=$O(^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1)) Q:FBREF1'>0!(FBAAOUT)  D
	.I $D(^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"INV")) D
	..F  S FBIEN=$O(^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"INV",FBIEN)) Q:FBIEN=""!(FBAAOUT)  S FBCTR=FBCTR+1 D
	...S FBINV=^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"INV",FBIEN),DFN=+FBINV,FBAMT=$P(FBINV,"^",2),FBDRG=$P(FBINV,"^",3),FBLOS=$P(FBINV,"^",4),FBTAMT=FBTAMT+FBAMT,FBTLOS=FBTLOS+FBLOS D PRINT:FBRT="D"
	.I $D(^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"ANC")) F  S L=$O(^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"ANC",L)) Q:'L!(FBAAOUT)  D
	..F  S M=$O(^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"ANC",L,M)) Q:'M!(FBAAOUT)  F  S N=$O(^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"ANC",L,M,N)) Q:'N!(FBAAOUT)  D
	...S FBANC=1,FBINV=^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"ANC",L,M,N),DFN=+FBINV,FBAMT=$P(FBINV,"^",2),FBDRG="",FBLOS="" D PRINT:FBRT="D" S FBANC=0
	G END:FBAAOUT I FBRT="D" W !!!,?22,"** Indicates an Ancillary Payment"
	D SUMMARY^FBCHCR1
END	K FBNAME,FBPTC,FBIEN,DFN,FBAMT,FBDRG,FBCHK,FBLOS,FB7078,FBANC,Q,QQ,FBCTR,FBTAMT,FBTLOS,FBDT,BEGDATE,ENDDATE,BEGDT,FBTP,FBTYPE,FBINV,FBAAOUT,I,J,K,L,M,N,FBJ,FBREF,FBREF1,FB583,FB7078,FBEND,FBSUM,FBSUM1,FBSUM2,FBRT
	K ^TMP($J,"FBCHCR") D CLOSE^FBAAUTL
	Q
PRINT	I $Y+5>IOSL W !!!?22,"** Indicates an Ancillary Payment"
	D PGCHK Q:FBAAOUT
	I FBPTC'=FBCHK D HED1 S FBCHK=FBPTC
	W !,$E(FBNAME,1,23),?24,$$SSN^FBAAUTL(DFN),?40,$S(FBREF="FB7078":$P(^FB7078(FBREF1,0),"^"),1:$$DATX^FBAAUTL($P(^FB583(FBREF1,0),"^"))),?53,$S($G(FBAMT):$J($FN(FBAMT,",",2),10),1:""),?63,$S(FBANC:"**",1:""),?71,FBDRG,?75,$J(FBLOS,5)
	Q
HED	I FBREF="FB583" W !?30,"UNAUTHORIZED CLAIMS"
	W !,@$S(FBTP=6:"?25",1:"?22"),"COST REPORT FOR ",$S(FBTP=6:"CIVIL HOSPITAL",1:"CONTRACT NURSING HOME"),!?28,$$DATX^FBAAUTL(BEGDATE)," THROUGH ",$$DATX^FBAAUTL(ENDDATE),!,@$S(FBTP=6:"?25",1:"?22"),Q I FBTP=7 F J=1:1:7 W "-"
	I $G(FBEND) D HED2 Q
	W !!!,"PATIENT NAME",?25,"PATIENT ID"
	I FBREF="FB583" W ?40,"DT CLAIM REC"
	I FBREF="FB7078" W ?40,"ASSOC 7078"
	W ?55,"AMT PAID",?66,"FINAL DRG",?77,"LOS",!,QQ
	Q
HED1	W !!?5,"TREATING SPECIALTY:  " F I=1:1:8 S J=$T(TEXT+I) I $P(J,";",3)=FBPTC W $P(J,";",4) Q
	Q
HED2	W !!,?35,"SUMMARY",!!?22,"LOS",?40,"# CASES",?60,"AVE. AMT. PAID",!,QQ
	Q
PGCHK	I $Y+5>IOSL,($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+5>IOSL W @IOF D HED
	Q
TEXT	;
	;;00;SURGICAL
	;;10;MEDICAL
	;;60;HOME NURSING SERVICE
	;;85;PSYCHIATRIC-CONTRACT
	;;86;PSYCHIATRIC
	;;95;NEUROLOGICAL-CONTRACT
	;;96;NEUROLOGICAL
	;;99;UNKNOWN

FBCHCR1
FBCHCR1	;AISC/CMR-CH & CNH COST REPORT CONT. ;7/1/93  15:25
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ANCIL	S J="",(K,L,M,N)=0,FBDT=BEGDATE
	F  S J=$O(^FBAAC("AM",J)) Q:J=""  I J[FBREF F  S K=$O(^FBAAC("AM",J,K)) Q:K'>0  F  S L=$O(^FBAAC("AM",J,K,L)) Q:L'>0  F  S M=$O(^FBAAC("AM",J,K,L,M)) Q:M'>0  F  S N=$O(^FBAAC("AM",J,K,L,M,N)) Q:N'>0  D
	.I $P(^FBAAC(K,1,L,1,M,1,N,0),"^",9)=FBTP,$P(^(0),"^",6)>(FBDT-1),$P(^(0),"^",6)<(ENDDATE+1) D
	..S FBINV=^(0),FBPTC=$P(FBINV,"^",17) S:FBPTC="" FBPTC="99" S DFN=K,FBNAME=$$NAME^FBCHREQ2(DFN),FBAMT=$P(FBINV,"^",3),FBREF1=$P(J,";")
	..S FBSUM=$G(^TMP($J,"FBCHCR","SUM","ANC")),$P(FBSUM,"^")=($P(FBSUM,"^")+1),$P(FBSUM,"^",2)=($P(FBSUM,"^",2)+FBAMT) S ^TMP($J,"FBCHCR","SUM","ANC")=FBSUM
	..S ^TMP($J,"FBCHCR",FBPTC,FBNAME,FBREF1,"ANC",L,M,N)=DFN_"^"_FBAMT_"^^"
	Q
SUMMARY	I FBRT="D",($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR K DIR Q:'Y
	W @IOF S FBEND=1 D HED^FBCHCR
	S (FBPTC,FBLOS)=0,FBCHK=""
	F  S FBPTC=$O(^TMP($J,"FBCHCR","SUM",FBPTC)) Q:FBPTC=""!(FBAAOUT)  F  S FBLOS=$O(^TMP($J,"FBCHCR","SUM",FBPTC,FBLOS)) Q:FBLOS=""!(FBAAOUT)  S FBSUM=^(FBLOS),FBSUM1=+FBSUM,FBSUM2=$P(FBSUM,"^",2) D
	.D PGCHK^FBCHCR Q:$G(FBAAOUT)
	.I FBPTC'=FBCHK D HED1^FBCHCR S FBCHK=FBPTC
	.W !?20,$J(FBLOS,5),?40,$J(FBSUM1,5),?60,$J((FBSUM2/FBSUM1),10,2)
	W !!,QQ,!!?4,"TOTAL CASES:  ",FBCTR,?24,"AVERAGE AMOUNT PAID:  ",$S($G(FBTAMT):$FN((FBTAMT/FBCTR),",",2),1:""),?56,"AVERAGE LOS:  ",$S($G(FBTLOS):$FN((FBTLOS/FBCTR),",",2),1:"")
	I $D(^TMP($J,"FBCHCR","SUM","ANC")) S FBSUM=^("ANC"),FBSUM1=+FBSUM,FBSUM2=$P(FBSUM,"^",2) W !!?4,"TOTAL ANCILLARY PAYMENTS:  ",$J(FBSUM1,5),?40,"AVERAGE AMOUNT PAID:  ",$J((FBSUM2/FBSUM1),10,2)
	Q

FBCHDEL
FBCHDEL	;AISC/DMK-DELETE NOTIFICATION/REQUEST ;29MAY90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D HOME^%ZIS S DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"I $P(^(0),U,17)=""""",1:"I $P(^(0),U,17)=""""&($P(^(0),U,8)=DUZ)") D ASKV^FBCHREQ G END:X=""!(X="^")
	W !! S DR="0:99" D EN^DIQ
ASK	S DIR(0)="Y",DIR("A")="Are you sure you want to delete this Request",DIR("B")="NO" D ^DIR K DIR G END:$D(DIRUT)!'Y
EN	I $D(DA),DA S FBDA=DA,DIK="^FBAA(162.2," D ^DIK W !,?3,"...request deleted",!
	I $D(FBDA),FBDA,$D(^FBAA(161.5,FBDA,0)) S DA=FBDA,DIK="^FBAA(161.5," D ^DIK
END	K DIC,DIK,DIRUT,DA,FBDA,X,VAL,FBDA,DR,FBDFN,FBNAME,FBSSN,S,Y Q

FBCHDI
FBCHDI	;AISC/DMK,TET-DISPLAY INVOICE ;10/22/92  12:35
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASKIN	K FBAANQ W !! S DIC="^FBAAI(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),ASKIN:Y<0 S FBI=+Y
	S VAR="FBI",VAL=FBI,PGM="START^FBCHDI" D ZIS^FBAAUTL G:FBPOP END S:IO=IO(0) FBAANQ=1
START	S Q="",$P(Q,"=",80)="=",FBAAOUT=0 U IO D VET
EN	K ^TMP($J,"FB") D:'$D(FBPG) INIT
	D SET^FBPAY67 D:$G(FBLISTC)&($E(IOST,1,2)["C-") CR^FBPAY21 G:FBOUT END D EN1^FBPAY671 G:FBAAOUT!(FBOUT) END
	F J=5,16,17 S FBIN(J)=$P(FBIN,"^",J)
	S Y=FBIN(16) D PDF^FBAAUTL S FBIN(16)=Y S:$P(FBIN(5),";",2)="FB583(" FBIN(5)="" I FBIN(5)]"" S FBIN(5)=$S($D(^FB7078(+FBIN(5),0)):$P(^(0),"^",1),1:"")
	I FBIN(17)]"" S FBIN(17)=$S($D(^FBAA(161.7,FBIN(17),0)):$P(^(0),"^",1),1:"")
	I FBIN(5)]"" W !,?4,"Associated 7078: ",FBIN(5)
	W !,?4,"Batch #: ",FBIN(17),?40,"Date Finalized: ",FBIN(16),!
	I $D(^FBAAI(FBI,"FBREJ")),$P(^("FBREJ"),"^",1)]"" W ?4,"Rejects Pending!",?25,"Reject reason: ",$P(^("FBREJ"),"^",2),!,?4,"Old Batch #: ",$S($P(^("FBREJ"),"^",3):$S($D(^FBAA(161.7,$P(^("FBREJ"),"^",3),0)):$P(^(0),"^"),1:""),1:"")
	Q:$D(FBLISTC)
	G:$D(FBAANQ) ASKIN
END	K VA,FBINODE,FBNODE,FBPRGNAM,FBPROG,FBDX,FBDX1,FBPAT,FBPROC,FBVEN,FBPG,FBAAOUT,FBPROC1,Q D KILL^FBPAY Q
INIT	;initialize variables needed in fbpay67&671
	S (FBPROG,FBSORT)=1,FBPG=$S($G(FBLISTC):1,1:0),FBCRT=$S($E(IOST,1,2)="C-":1,1:0),$P(FBDASH,"=",80)="",$P(FBDASH1,"-",80)="",FBOUT=0
	Q
VET	;set vet variables
	S FBINODE=$G(^FBAAI(FBI,0)),DFN=+$P(FBINODE,U,4),FBPNAME=$P($G(^DPT(DFN,0)),U),FBPID=$$SSN^FBAAUTL(DFN),FBPROG=$P(FBINODE,U,12),FBPRGNAM=$P($G(^FBAA(161.8,+FBPROG,0)),U),FBPROG(+FBPROG)=FBPRGNAM
	S FBIEN=DFN,FBPI=FBPROG,FBM=+$P(FBINODE,U,6) S:FBPNAME']"" FBPNAME="UNKNOWN" S:FBPRGNAM']"" FBPRGNAM="UNKNOWN"
	Q

FBCHDI2
FBCHDI2	;AISC/DMK-DISPLAY INVOICE ;08FEB89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASKIN	K FBAANQ W !! S DIC="^FBAAI(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),ASKIN:Y<0 S FBI=+Y
	S VAR="FBI",VAL=FBI,PGM="START^FBCHDI2" D ZIS^FBAAUTL G:FBPOP END S:IO=IO(0) FBAANQ=1
START	S Q="",$P(Q,"=",80)="=",FBAAOUT=0,FBPG=$S($E(IOST,1,2)="C-":0,1:1)
	U IO D HEDC^FBCHVH
EN	D GETINV^FBCHVH Q:FBAAOUT
	F J=5,16,17 S FBIN(J)=$P(FBIN,"^",J)
	S Y=FBIN(16) D PDF^FBAAUTL S FBIN(16)=Y S:$P(FBIN(5),";",2)="FB583(" FBIN(5)="" I FBIN(5)]"" S FBIN(5)=$S($D(^FB7078(+FBIN(5),0)):$P(^(0),"^",1),1:"")
	I FBIN(17)]"" S FBIN(17)=$S($D(^FBAA(161.7,FBIN(17),0)):$P(^(0),"^",1),1:"")
	I FBIN(5)]"" W !,?4,"Associated 7078: ",FBIN(5)
	W !,?4,"Batch #: ",FBIN(17),?40,"Date Finalized: ",FBIN(16),!
	I $D(^FBAAI(FBI,"FBREJ")),$P(^("FBREJ"),"^",1)]"" W ?4,"Rejects Pending!",?25,"Reject reason: ",$P(^("FBREJ"),"^",2),!,?4,"Old Batch #: ",$S($P(^("FBREJ"),"^",3):$S($D(^FBAA(161.7,$P(^("FBREJ"),"^",3),0)):$P(^(0),"^"),1:""),1:"")
	Q:$D(FBLISTC)
	G:$D(FBAANQ) ASKIN
END	K VA D END^FBCHVH Q

FBCHDIN
FBCHDIN	;AISC/DMK-DELETE INPATIENT INVOICE ;1/12/93  08:10
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
BAT	;ask batch Number
	;cannot delete an invoice from a batch that has a status of
	;supervisor closed, reviewed after pricer, transmitted or vouchered.
	;A clerk may delete an invoice in a batch
	;they own if the status is open, closed, forwarded to pricer or
	;assigned price.
	;
	D HOME^%ZIS
	W ! S DIC="^FBAA(161.7,",DIC(0)="AEQMZ"
	S DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"I ""TV""'[$G(^(""ST""))",1:"I $P(^(0),U,5)=DUZ&(""TVRS""'[($G(^(""ST""))))")_"&($P(^(0),U,3)=""B9"")"
	D ^DIC K DIC G END:X=""!(X="^")
	L +^FBAA(161.7,+Y)
	S FBBAT=+Y,FBBAT(0)=Y(0)
	;
INV	;get invoice user wants to delete in batch selected
	W ! S DIC="^FBAAI(",DIC(0)="AEQZ",DIC("S")="I $D(^FBAAI(""AC"",FBBAT,X))"
	S DIC("A")="Select Invoice to delete: " D ^DIC K DIC I X=""!(X="^") L -^FBAA(161.7,FBBAT) G BAT
	S FBDINV=Y,FBDINV(0)=Y(0),FBI=+Y,FBLISTC=0 D START^FBCHDI
	W ! S DIR(0)="Y",DIR("B")="No",DIR("A")="Sure you want to delete this invoice" D ^DIR K DIR G END:$D(DIRUT) I 'Y L -^FBAA(161.7,FBBAT) G BAT
	;
	S DA=+FBDINV,DIK="^FBAAI(" W !?5,".... deleting!",!
	D ^DIK K DIK
	;
	;reset batch dollar amount, total payment items and invoice count
	D CNTTOT^FBAARB(FBBAT)
	S $P(FBBAT(0),"^",9)=+FBTOTAL
	S $P(FBBAT(0),"^",10)=+FBLCNT
	S $P(FBBAT(0),"^",11)=+FBLCNT
	S:$P(FBBAT(0),"^",10)'>0 $P(FBBAT(0),"^",18)=""
	S $P(^FBAA(161.7,FBBAT,0),"^",9,11)=$P(FBBAT(0),"^",9,11),$P(^FBAA(161.7,FBBAT,0),"^",18)=$P(FBBAT(0),"^",18)
END	I $G(FBBAT) L -^FBAA(161.7,FBBAT)
	K DA,FBBAT,FBLISTC,FBDINV,FBAAOUT,FBDX,FBDX1,FBPAT,FBPROC,FBVEN,X,Y,Q
	D END^FBCHDI Q

FBCHDUC
FBCHDUC	;AISC/DMK,TET-DISPLAY UNAUTHORIZED CLAIM(583) ;10/22/92  12:37
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
OUTP	D HOME^%ZIS
	W !! S DIC="^FB583(",DIC(0)="AEQM",DIC("A")="Select Veteran: " D ^DIC K DIC("A") G END:X=""!(X="^") S (DA,FBDA)=+Y,DR="",DIQ(0)="C" W @IOF D EN^DIQ K DIQ
	S FBDA=FBDA_";FB583(",FBLISTC=1,FBOUT=0,FBAAOUT="",Q="",$P(Q,"-",80)="-",FB("PD")=0
	F FBI=0:0 S FBI=$O(^FBAAI("E",FBDA,FBI)) Q:FBI'>0!(FBAAOUT)  S FBNODE=$G(^FBAAI(FBI,0)) I FBNODE]"" S FB("PD")=FB("PD")+$P(FBNODE,U,9) D VET^FBCHDI S FB("DFN")=DFN D EN^FBCHDI Q:$G(FBOUT)
	D END G OUTP
HED	W !?25,"ASSOCIATED INVOICES",!,?24,$E(Q,1,21),!
	Q
END	K DA,DR,DFN,DIC,FB,FBAAOUT,FBDA,FBDX,FBI,FBIN,FBLISTC,FBVEN,FBVID,J,K,Q,S,VA,VADM,X,Y,ZZ,FBPROC,L,VAERR,FBINODE,FBNODE,FBPRGNAM,FBPROG D KILL^FBPAY
	Q
OPT	I $O(^FBAAC("AM",FBDA,0)) F II=0:0 S II=$O(^FBAAC("AM",FBDA,FB("DFN"),II)) Q:'II  F JJ=0:0 S JJ=$O(^FBAAC("AM",FBDA,FB("DFN"),II,JJ)) Q:'JJ  F KK=0:0 S KK=$O(^FBAAC("AM",FBDA,FB("DFN"),II,JJ,KK)) Q:'KK  D GETPD
	K II,JJ,KK Q
GETPD	I $D(^FBAAC(FB("DFN"),1,II,1,JJ,1,KK,0)) S FB("PD")=FB("PD")+$P(^(0),"^",3) Q

FBCHEAP
FBCHEAP	;AISC/DMK-ENTER AMOUNT PAID FROM PRICER ;18APR90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DIC	W ! S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,15)=""Y""&($G(^(""ST""))=""P"")"_$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"",1:"&($P(^(0),U,5)=DUZ)") D ^DIC
	G END:X="^"!(X=""),DIC:Y<0 S FBN=+Y,FBN(0)=Y(0)
ASK	S DIR(0)="Y",DIR("A")="Would you like to reject any invoices from the pricer",DIR("B")="NO" D ^DIR K DIR G END:$D(DIRUT),REJECT:Y
DIC1	W !! S DIC="^FBAAI(",DIC(0)="AEQMZ",DIC("A")="Select Patient: ",D="D",DIC("S")="I $P(^(0),U,17)=FBN",DIC("W")="W ?25,$S($D(^DPT($P(^(0),U,4),0)):$P(^(0),U),1:"""")" D ^DIC S DIE=DIC K DIC,D G END:X="^",DIC:X=""!(Y<0)
	S (DA,FBI)=+Y,FBI(0)=Y(0) G END:'$D(^FBAAI(FBI,0))
DISP	S FBLISTC="" D HOME^%ZIS,START^FBCHDI2
	W !! S FBJ=$P(FBI(0),"^",8)
	S DR="26;8;S FBK=X;S:(FBJ-FBK)'>0 Y=24;9//^S X=$S(FBJ-FBK:FBJ-FBK,1:"""");S:'X Y=24;10;S:X'=4 Y=24;18;24R",DIE("NO^")="" D ^DIE K DIE("NO^")
	G END:$D(DIRUT)
	D TOT S $P(FBN(0),"^",9)=FBK(1),^FBAA(161.7,FBN,0)=FBN(0)
	D CHK I $D(FBCHSW) K FBCHSW G DIC1
	I '$D(FBCHSW) S DA=FBN,(DIC,DIE)="^FBAA(161.7,",DIC(0)="LQ",DR="11////^S X=""A""",DLAYGO=161.7 D ^DIE G DIC
	G DIC1:$O(^FBAAI("AC",FBN,FBI))
END	K DA,DFN,DIC,DIE,DR,FBAAOUT,FBDX,FBI,FBIN,FBJ,FBK,FBLISTC,FBN,FBPROC,FBVEN,FBVID,I,J,K,L,POP,Q,U,VA,VADM,X,POP,YS,VAL,ZZ,Y,FBRR,FBTYPE,FBCHSW,DIRUT
	D END^FBCHDI
	Q
REJECT	S FBTYPE="B9"
	W ! S DIC="^FBAAI(",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,17)=FBN&($P(^(0),U,9)="""")",DIC("W")="W ?25,$S($D(^DPT($P(^(0),U,4),0)):$P(^(0),U),1:"""")" D ^DIC G END:X=""!(X="^"),REJECT:Y<0 S FBI=+Y,FBI(0)=Y(0)
	S FBLISTC="" D HOME^%ZIS,START^FBCHDI2
RASK	S DIR(0)="F^2:40",DIR("A")="Enter reason for rejecting (2-40 characters)",DIR("?")="Enter a reason for rejecting payment from Austin Pricer" D ^DIR K DIR G END:$D(DIRUT) S FBRR=X
ASKSU	S DIR(0)="Y",DIR("A")="Are you sure you want to reject this item",DIR("B")="NO" D ^DIR K DIR G END:$D(DIRUT),DIC:'Y
	S (DLAYGO,DIDEL)=162.5,DIC(0)="AEQLM"
	S (DIC,DIE)="^FBAAI(",DA=FBI,DR="13////^S X=""P"";14////^S X=FBRR;15////^S X=FBN;20///^S X=""@""" D ^DIE
	S $P(FBN(0),"^",10)=$P(FBN(0),"^",10)-1,$P(FBN(0),"^",11)=$P(FBN(0),"^",11)-1,$P(FBN(0),"^",17)="Y",^FBAA(161.7,FBN,0)=FBN(0)
RASKSU	I $O(^FBAAI("AC",FBN,FBI)) S DIR(0)="Y",DIR("A")="Reject another",DIR("B")="NO" D ^DIR K DIR G END:$D(DIRUT),REJECT:Y
	I $P(^FBAA(161.7,FBN,0),"^",11)=0 S (DIC,DIE)="^FBAA(161.7,",DIC(0)="AEQM",DA=FBN,DR="11////^S X=""V"";12////^S X=DT" D ^DIE G DIC
	G END
CHK	F I=0:0 S I=$O(^FBAAI("AC",FBN,I)) Q:I'>0  I $D(^FBAAI(I,0)),$P(^(0),"^",9)="" S FBCHSW=1
	Q
TOT	S FBK(1)=0 F I=0:0 S I=$O(^FBAAI("AC",FBN,I)) Q:'I  S FBK(1)=FBK(1)+$P($G(^FBAAI(I,0)),"^",9)
	Q

FBCHEP
FBCHEP	;AISC/DMK-ENTER PAYMENT FOR CONTRACT HOSPITAL ;08FEB89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBAAPTC="V",FBAAOUT=0
RD	K FBAAID,FBAAVID S FBRESUB="" D GETVET^FBAAUTL1 G:DFN']"" Q
	S FBPROG="I $P(^(0),U,3)=6,($P(^(0),U,9)'[""FB583"")" D GETAUTH^FBAAUTL1 G RD:$D(DUOUT),RD:FTP']""
	;W !!,?25,"<  ASSOCIATED 7078  >",!!
	;S DIC="^FB7078(",DA=FB7078,DR="0;1" D EN^DIQ
	I FB7078="" W !,*7,"No 7078 on file for this authorization." G RD
	S FBI7078=FB7078_";FB7078("
	I $D(^FBAAI("E",FBI7078)) S FBAAIN=$O(^FBAAI("E",FBI7078,0)) G OUT
SETINV	S FBZ(0)=^FB7078(FB7078,0),FBVET=$P(FBZ(0),"^",3),FBVEN=$P(FBZ(0),"^",2),FBVEN=$P(FBVEN,";",1)
	;
EN583	;Entry from 583 enter payment
	I FBAAPTC="R" D ^FBAACO0
	S DA=FBVEN D EN1^FBAAVD
	I $P($G(^FBAAV(FBVEN,"ADEL")),U)="Y" W !!,*7,"Vendor is flagged for Austin deletion!" G Q
	D SITEP^FBAAUTL G Q:FBPOP
	;
RDV	S FBVE="" S:$D(^FBAAV(DA,"AMS")) FBVE=$P(^("AMS"),"^",2) S:$G(FBVE)'="Y" FBVE="N"
	I FBVE="Y" W *7,!!,"Vendor is listed as 'exempt from the pricer'." S DIR(0)="Y",DIR("A")="Do you wish to keep this invoice exempt from the pricer",DIR("B")="Yes" D ^DIR K DIR G Q:$D(DIRUT) S FBVE=$S(Y=1:"Y",1:"N")
	I $G(FBVE)'="Y",($P($G(^FBAAV(FBVEN,0)),"^",17)']"") W !!,*7,"Medicare ID Number is needed for this Vendor!" S DIE="^FBAAV(",DR=22 D ^DIE K DIE G Q:$D(DTOUT)!('$L(X))
	;
BAT	S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,3)=""B9""&($P(^(0),U,5)=DUZ)&($P(^(0),U,15)=""Y"")&($G(^(""ST""))=""O"")" W ! D ^DIC K DIC
	G Q:X="^"!(X=""),BAT:Y<0 S FBAABE=+Y,FBY(0)=Y(0),Z1=$P(FBY(0),"^",11),BO=$P(FBY(0),"^",2),Z2=$P(FBY(0),"^",10),FBSTN=$P(FBY(0),"^",8),FBCHOB=FBSTN_"-"_$P(FBY(0),"^",2),FBEXMPT=$P(FBY(0),"^",18) S FBAAOUT=0 D CHK I FBAAOUT K Y,Y(0),FBAABE G BAT
	I FBI7078["FB7078(",BO'=$P($P(FBZ(0),U),".") W !,*7,"Obligation number on batch does not match 1358.",!,"Obligation number on batch must be ",$P($P(FBZ(0),U),"."),".",! G BAT
	S FBINC=$S($P(FBY(0),"^",10)="":0,1:$P(FBY(0),"^",10)),FBLN=$S($P(FBY(0),"^",11)="":0,1:$P(FBY(0),"^",11))
GETNXI	D GETNXI^FBAAUTL
	W !!,"Invoice # ",FBAAIN," assigned to this Invoice"
RIN	D GETINDT^FBAACO1 G Q:$G(FBAAOUT)
	S FBAAMM=$S(FBAAPTC="R":"",1:1) D PPT^FBAACO1
DIC	S DIC="^FBAAI(",DIC(0)="LQ",DLAYGO=162.5,X=FBAAIN D ^DIC G Q:Y<0
	S DA=+Y,DIE=DIC,DR="[FBCH ENTER PAYMENT]",DIE("NO^")="" D ^DIE K DIE,DIC,D,DA,DR
	S $P(FBY(0),"^",10)=FBINC+1,$P(FBY(0),"^",11)=FBLN+1,$P(FBY(0),"^",18)=FBEXMPT,^FBAA(161.7,FBAABE,0)=FBY(0) D:'$D(FBNOPTF) PTF G Q:$D(FB583),RD
OUT	W !!,*7,?3,"Invoice number ",FBAAIN," has already been entered for this authorization.",!,?3,"Use the Contract Hospital 'Invoice Edit' option if needed.",!
	;check if user wants to add a second invoice for this 7078
	W ! S DIR("A")="Want to add another invoice for this episode of care",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR I Y S (FBNOPTF,FBRESUB)=1 G SETINV
Q	K BO,CNT,D,DA,DAT,DIC,DIE,DLAYGO,DR,FB7078,FBAABDT,FBAABE,FBAAEDT,FBAAID,FBAAIN,FBAAOUT,FBAAPTC,FBDX,FBTT,FBTYPE,FBVEN,FBVET,FBXX,FTP,I,J,FBK,PI,FBPOP,PTYPE,S,FBZ,Z1,FBI,FBPROG,FBRR,FBSW,FBPOV,FBPT,FBY,T,Y,Z1,Z2,ZZ,FBPSA,A,FBI7078
	K FBCHOB,FBAUT,FBSEQ,X,FBSITE,F,FBSTN,FBASSOC,FBLOC,DUOUT,PSA,FBCOUNTY,DFN,FBNOPTF,DIRUT,FBVE,FBAAOUT,FBEXMPT,FBAAPN,FBAMTC,FBDEL,FBINC,FBLN,FBRESUB
	K FBD1,FBFDC,FBMST,FBTTYPE,FB583
	Q
PTF	I $G(FBVET),$G(FBI7078)["FB583" S:'$G(DFN) DFN=FBVET S Y=$P(FBZ(0),"^",4)_"^"_1 D WAIT^DICD,CREATE^DGPTFCR W !,*7,$S(Y>0:"Non-VA PTF Record Created.",1:"Unable to create Non VA PTF Record."),!
	Q
PRBT	;Entry point for patient reimbursement option
	;
	S FBAAPTC="R"
	G RD
CHK	;Check for vendor and batch being exempt from pricer
	I $G(FBVE)'="Y"&($G(FBVE)'="N") S FBVE="N"
	I $G(FBEXMPT)="Y" Q:FBVE="Y"  G OPEN:FBVE="N"
	I $G(FBEXMPT)="N" Q:FBVE="N"  G OPEN:FBVE="Y"
	I '$G(FBEXMPT)&($G(Z2)'>0) S FBEXMPT=FBVE Q
	I '$G(FBEXMPT)&($G(Z2)>0) S $P(^FBAA(161.7,FBAABE,0),"^",18)="N",FBEXMPT="N" G CHK
	Q
OPEN	W *7,!!,"This Invoice may not be added to Batch # ",+FBY(0),".",!,"***You may not add a ",$S(FBVE="Y":"pricer exempt",1:"non-exempt")," invoice to a ",$S(FBVE="Y":"non-exempt",1:"pricer exempt")," batch.***"
	S DIR(0)="Y",DIR("A")="Do you want to open a new batch at this time",DIR("B")="Y" D ^DIR K DIR S:$D(DIRUT)!('Y) FBAAOUT=1 Q:FBAAOUT  D RCHOP^FBAAOB S FBEXMPT=FBVE D
	.S FBY(0)=$G(^FBAA(161.7,FBAABE,0)),Z1=$P(FBY(0),"^",11),BO=$P(FBY(0),"^",2),Z2=$P(FBY(0),"^",10),FBSTN=$P(FBY(0),"^",8),FBCHOB=FBSTN_"-"_$P(FBY(0),"^",2)
	Q

FBCHEP1
FBCHEP1	;AISC/DMK-EDIT PAYMENT FOR CONTRACT HOSPITAL ;13SEP90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EDIT	;ENTRY POINT TO EDIT PAYMENT
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
BT	W ! S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,3)=""B9""&($P(^(0),U,15)=""Y"")",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):DIC("S"),1:DIC("S")_"&($P(^(0),U,5)=DUZ)") D ^DIC
	G END:X=""!(X="^"),BT:Y<0 S FBN=+Y,FBN(0)=Y(0)
	S FBEXMPT=$P(FBN(0),"^",18)
	S FBSTAT=^FBAA(161.7,FBN,"ST"),FBBAMT=$S($P(FBN(0),"^",9)="":0,1:$P(FBN(0),"^",9))
	I FBSTAT="C"&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,?3,"You must Reopen the batch prior to editting the invoice.",! G END
	I FBSTAT="S"!(FBSTAT="P")!(FBSTAT="R")&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,?3,"You must be a holder of the 'FBAASUPERVISOR' security key",!,?3,"to edit this invoice.",! G END
	I FBSTAT="T"!(FBSTAT="V") W !!,?3,"Batch has already been sent to Austin for payment.",! G END
INV	W ! S DIC="^FBAAI(",DIC(0)="AEQZ",DIC("S")="I $P(^(0),U,17)=FBN" D ^DIC K DIC("S") G BT:X=""!(X="^"),INV:Y<0 S FBI=+Y
	S FBK=$S($P(^FBAAI(FBI,0),"^",9)="":0,1:$P(^(0),"^",9))
	S FBLISTC="",FBAAI=FBI W @IOF D START^FBCHDI2 S FBI=FBAAI I $P(^FBAAI(FBI,0),"^",9)="" S FBPRICE=""
	S (DIE,DIC)="^FBAAI(",DIC(0)="AEQM",DA=FBI,DR="[FBCH EDIT PAYMENT]" W ! D ^DIE
	K FBAAMM,FBAAMM1
	S FBNK=$P(^FBAAI(FBI,0),"^",9)
	I FBNK-FBK S $P(^FBAA(161.7,FBN,0),"^",9)=FBBAMT+(FBNK-FBK)
END	K DA,DFN,DIC,DIE,DR,FBAAOUT,FBDX,FBI,FBIN,FBLISTC,FBN,FBPROC,FBSTAT,FBVEN,FBVID,J,K,L,POP,Q,VA,VADM,X,FBIFN,Y,FBPRICE,FBK,FBNK,FB583,FBAAPN,FBASSOC,FBDEL,FBLOC,DAT
	K CNT,D0,FB7078,FBAABDT,FBAAEDT,FBASSOC,FBAUT,FBLOC,FBPROG,FBPSA,FBPT,FBRR,FBTT,FBTYPE,FBXX,FTP,PI,PTYPE,T,Z,ZZ,F,FBPOV,I,TA,VAL,DUOUT,FBVET,FBBAMT,FBAAI,FBEXMPT
	D END^FBCHDI
	Q

FBCHEUC
FBCHEUC	;AISC/DMK-ENTER UNAUTHORIZED CLAIM(583) ;24AUG90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D SITEP^FBAAUTL G END:FBPOP S FBPSA=$S($P(FBSITE(1),"^",3)="":"",1:$P(FBSITE(1),"^",3)),FBTYPE=6,(FBELIG,FBSW)="",FBDFPSA=$S(FBPSA="":"",$D(^DIC(4,FBPSA,0)):$P(^(0),"^"),1:"")
GETVET	S DIC="^DPT(",DIC(0)="AEQM" D ^DIC G END:X=""!(X="^"),GETVET:Y<0 S (FBVET,DFN)=+Y D ELIG^VADPT S VAEL(8)=$P(VAEL(8),"^",1) D ELIG G END:FBELIG
ADD	W !! S DIC="^FB583(",DIC(0)="AEQLM",DLAYGO=162.7,DIC("S")="I $P(^(0),U,4)=DFN",DIC("A")="DATE/TIME VALID CLAIM ACCEPTED:",DIC("DR")="" D ^DIC K DIC("A"),DIC("S") G END:X=""!(X="^"),ADD:Y<0 S FBUIFN=+Y
EN	S DIE=DIC,DA=FBUIFN,DR="[FBCH UNAUTHORIZED CLAIM]" D ^DIE K DIC,DIE,DA G H^XUS:$D(DTOUT),END:$D(Y)'=0 I $D(FBUIFN),FBUIFN,FBSW D EN^FBCHEUC1
END	K FBAAPTV,FBDCHG,FBDIAG,FBDISP,FBELIG,FBFRDT,FBPOV,FBPSA,FBPT,FBSITE,FBSW,FBTODT,FBTYPE,FBU,FBUIFN,FBVEN,FBVET,FBZZ,I,J,VAEL,VAERR,X,ZZ,DFN,DR,Y,DIC,DA,DLAYGO,FBDFPSA,FBHFRDT,FBHTODT,FBPOP
	Q
ELIG	;CHECK IF VET ELIG IS PENDING OR VERIFIED AND ELIGIBLE
	I '$D(VAEL) S FBELIG=1 Q
	S ZZ=$S(VAEL(8)="V":0,VAEL(8)="P":0,1:1) I ZZ W !!,*7,"Veteran's eligibility status is not Verified or Pending verification.",!,"Unable to continue.",! S FBELIG=1 Q
	I VAEL(5)'=1 W !!,*7,"Veteran is Ineligible for care. The ineligible date is ",$P(VAEL(5,1),"^",2),".",! S DIR(0)="Y",DIR("A")="Do you want to continue",DIR("B")="No" D ^DIR K DIR I Y=0!($D(DUOUT)) S FBELIG=1 Q
	I $D(DTOUT) G H^XUS
	Q

FBCHEUC1
FBCHEUC1	;AISC/DMK-UNAUTHORIZED CLAIM CON'T ;13SEP90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASKV	W !! S DIC="^FB583(",DIC(0)="AEQM",DIC("A")="Select Veteran: ",DIC("S")="I $P(^(0),U,11)=4" D ^DIC K DIC("S") Q:X=""!(X="^")  G ASKV:Y<0 S FBUIFN=+Y
	S FBDUC=1,FBSW="",DA=FBUIFN,DIE=DIC,DR="[FBCH UNAUTHORIZED CLAIM]",DIE("NO^")="" D ^DIE K DIC,DIE,DR G H^XUS:$D(DTOUT),END:$D(Y)'=0!('FBSW)
EN	G END:'$D(^FB583(FBUIFN,0)) S FBU(0)=^(0) G END:$P(FBU(0),"^",14)=""
	I $P(FBU(0),"^",11)'=1,$D(^FBAAA("AG",FBUIFN_";FB583(",$P(FBU(0),"^",4))) S DA=$O(^($P(FBU(0),"^",4),0)),DA(1)=$P(FBU(0),"^",4),DIK="^FBAAA("_DA(1)_",1," D ^DIK G END
	G END:$P(FBU(0),"^",11)'=1 S $P(^FB583(FBUIFN,0),"^",12)=DT
	S DIR(0)="161.01,.06",DIR("B")="DISCHARGE" D ^DIR K DIR G END:$D(DUOUT),H^XUS:$D(DTOUT) S FBDCHG=+Y G END:FBDCHG=0
	S FBTYPE=$P(FBU(0),"^",2),FBVEN=$P(FBU(0),"^",3),FBVET=$P(FBU(0),"^",4),FBDIAG=$S('$D(^FB583(FBUIFN,"DX")):"",1:^FB583(FBUIFN,"DX")),FBPSA=$P(FBU(0),"^",7),FBPT=$P(FBU(0),"^",10),FBPOV=31
	S FBAAPTV="V",FBFRDT=$P(FBU(0),"^",13),FBTODT=$P(FBU(0),"^",14) Q:FBFRDT=""!(FBTODT="")
	I '$D(^FBAAA(FBVET,0)) K DD,DO S (X,DINUM)=FBVET,DIC="^FBAAA(",DIC(0)="LM",DLAYGO=161 D FILE^DICN K DIC,DLAYGO
	S:'$D(^FBAAA(FBVET,1,0)) ^(0)="^161.01D^^"
	I $D(^FBAAA("AG",FBUIFN_";FB583(",FBVET)) S FBHIFN=$O(^(FBVET,0)) G CHK161
	W !! S DA(1)=FBVET,DIC="^FBAAA("_FBVET_",1,",DIC(0)="LM",DLAYGO=161,X=FBFRDT D ^DIC Q:Y<0  S DIE=DIC,DA=+Y ;,DA(1)=FBVET
	S FBIFN=FBUIFN_";FB583("
	S DR=".02////^S X=FBTODT;.03////^S X=FBTYPE;.04////^S X=FBVEN;.055////^S X=FBIFN;.06////^S X=FBDCHG;.065////^S X=FBPT;.07////^S X=FBPOV;.08////^S X=FBDIAG;.095////^S X=1;1////^S X=""N"";100////^S X=DUZ;101////^S X=FBPSA;.096;.097//^S X=""NO"""
	D ^DIE K DIC,DIE,DLAYGO,DA,DR
END	K D,DA,FBAAPTV,FBDCHG,FBDIAG,FBFRDT,FBPOV,FBPSA,FBPT,FBTODT,FBTYPE,FBU,FBUIFN,FBVEN,FBVET,FBZZ,S,X,ZZZ,FBDISP,FBDUC,FBSW,I,J,Y,FBIFN,FBHIFN,FBHFRDT,FBHTODT
	Q
CHK161	;
	G END:'$D(FBHFRDT)
	I FBFRDT'=FBHFRDT,$D(^FBAAA(FBVET,1,FBHIFN,0)) S $P(^(0),"^",1)=FBFRDT
	I FBTODT'=FBHTODT,$D(^FBAAA(FBVET,1,FBHIFN,0)) S $P(^(0),"^",2)=FBTODT
	G END

FBCHEUC2
FBCHEUC2	;AISC/DMK-EDIT UNAUTHORIZED CLAIM ;14SEP90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D SITEP^FBAAUTL G END:FBPOP  S FBPSA=$S($P(FBSITE(1),"^",3)="":"",1:$P(FBSITE(1),"^",3)),FBDFPSA=$S(FBPSA="":"",$D(^DIC(4,FBPSA,0)):$P(^(0),"^"),1:"")
GETVET	W !! S DIC="^FB583(",DIC(0)="AEQMZ",DIC("A")="Select Veteran: " D ^DIC K DIC("A"),DIC("S") G:X=""!(X="^") END  G GETVET:Y<0 S FBUIFN=+Y
	S DA=FBUIFN,FBVET=$P(Y(0),"^",4),FBTYPE=$P(Y(0),"^",2),FBSW="",FBHFRDT=$P(Y(0),"^",13),FBHTODT=$P(Y(0),"^",14)
	G EN^FBCHEUC
END	K FBSITE,FBPSA,FBDFPSA,FBPOP,DIC,DIE,X,Y Q

FBCHP78
FBCHP78	;AISC/DMK-GENERATE 7078 ;02FEB89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^FBAA(161.4,1,0)) W !,"Site Parameters must be entered prior",!," to using this option." Q
GET78	S DIC="^FB7078(",DIC(0)="AEQMZ",DIC("A")="Select Veteran: ",D="D",DIC("S")="I $P(^(0),U,9)'=""DC""" D IX^DIC G END:X="^"!(X=""),GET78:Y<0 S FB7078=+Y,FB(0)=Y(0) K DIC,D
	S DA=FB7078,DIC="^FB7078(",DR=0 D EN^DIQ
ASK	S DIR(0)="Y",DIR("A")="Is this the correct 7078",DIR("B")="YES" D ^DIR K DIR G END:$D(DIRUT),GET78:'Y
	D SITEP^FBAAUTL S FBO=$S($D(FBSITE(1)):$P(FBSITE(1),"^",7),1:""),FBNUM=$S($D(FBSITE(1)):$P(FBSITE(1),"^",5),1:"")
	S FBT=$S($D(FBSITE(1)):$P(FBSITE(1),"^",8),1:"")
	D FBO G END:$D(DIRUT)
	S PRCF("X")="S" D ^PRCFSITE S PRC("SITE")=$S($D(PRC("SITE")):PRC("SITE"),1:"") I PRC("SITE")="" W ! G GET78
	S FB("SITE")=PRC("SITE")
QUE	S VAR="FB7078^FBNUM^FBO^FBT^FB(""SITE"")",VAL=FB7078_"^"_FBNUM_"^"_FBO_"^"_FBT_"^"_FB("SITE"),PGM="START^FBCHP78" D ZIS^FBAAUTL G:FBPOP END
	;
START	S FB(0)=^FB7078(FB7078,0) S:$E(IOST,1,2)'["C-" FBPG=1 F FBM=1:1:FBNUM D 7078
END	K DA,DFN,DIC,DINAME,DIRUT,DIWF,DIWL,DR,FB,FB7078,FBFD,FBID,FBNM,FBNUM,FBO,FBRR,FBSITE,FBTD,FBV,FBVEN,FBT,I,L,FBM,PGM,S,UL,VA,VADM,VAEL,VAERR,VAL,VAPA,VAR,X,Y,Z,PRC,PRCS,^UTILITY($J),PRCSCPAN
	D CLOSE^FBAAUTL Q
	;
7078	U IO S UL="",$P(UL,"-",120)="-",L="|" D HED^FBCH78A
	S DFN=$P(^FB7078(FB7078,0),"^",3) G END:'$D(DFN)#2!('$D(^DPT(+DFN,0)))
	S VAPA("P")="" D SITEP^FBAAUTL,6^VADPT
	F FBNM=1:1:7 S FBNM(FBNM)=$P(FBSITE(0),"^",FBNM)
	S FBNM(5)=$S($D(^DIC(5,FBNM(5))):$P(^(FBNM(5),0),"^",2),1:"")
	S Y=$P(FB(0),"^",10) D DATE S FBID=Y,FBVEN=$P(FB(0),"^",2),(FBVEN,FBV(0))=$P(FBVEN,";",1),FBVEN=$S($D(^FBAAV(FBVEN,0)):$P(^(0),"^",1),1:"Unknown"),FBVEN(1)=$S($D(^FBAAV(FBV(0),0)):$P(^(0),"^",2),1:"")
	F I=3:1:6,14 S FBV(I)=$S($D(^FBAAV(FBV(0),0)):$P(^(0),"^",I),1:"")
	I FBV(5)]"" S FBV(5)=$S($D(^DIC(5,FBV(5),0)):$P(^(0),"^",2),1:"")
	S Y=$P(FB(0),"^",4) D DATE S FBFD=Y,Y=$S($P(FB(0),"^",5)]"":$P(FB(0),"^",5),1:"Disposition") D DATE:Y>0 S FBTD=Y
	S FB(6)=$P(FB(0),"^",6) I FB(6)]"" S FB(6)=$S($D(^DIC(43.4,FB(6),0)):$P(^(0),"^",3),1:"")
	W "Issuing Office",?66,L,"1. Date of Issue",!,?5,FBNM(1),?66,L,?70,FBFD,!,?5,FBNM(2),?66,L,$E(UL,1,52),!,?5,$S(FBNM(3)]"":FBNM(3),1:FBNM(4)_", "_FBNM(5)_" "_FBNM(6)),?66,L,"2. Veteran's Name",!
	I FBNM(3)]"" W ?5,FBNM(4)_", "_FBNM(5)_" "_FBNM(6)
	W ?66,L,?70,VADM(1),!,UL,!,"Name of Physician or Station",?66,L,"3. Address",!,?5,FBVEN,?66,L,?68,VAPA(1),!,?5,FBV(3),?66,L,?68,VAPA(2),!,?5,FBV(14)
	W ?66,L,?68,VAPA(3),!?5,FBV(4)_", "_FBV(5)_" "_FBV(6),?66,L,?68,VAPA(4)_", "_$P(VAPA(5),"^",2)_" "_$S('+$G(VAPA(11)):VAPA(6),$P(VAPA(11),U,2)]"":$P(VAPA(11),U,2),1:VAPA(6)),!?5,"ID#: ",FBVEN(1)
	W ?66,L,$E(UL,1,53),!,?66,L,?68,"4. Veteran's Claim No.",?93,L,?95,"4A. SSN",!,?66,L,?68,VAEL(7),?93,L,?95,$P(VADM(2),"^",2),!,?66,L,$E(UL,1,53),!,?66,L,?75,"5. Authorization Valid",!,?66,L,$E(UL,1,53),!
	W ?66,L,"From",?93,L,"To",!,?66,L,?68,FBFD,?93,L,?95,FBTD,!,UL,!,?45,"PART 1. - SERVICES AUTHORIZED",!,UL,!,"6. Services shown below are authorized for the period indicated in Item 5 above.",?104,L,?107,"7. Fee",!
	W ?12,"(See Special Provisions below.)",?104,L,"$",!
	S DIWL=1,DIWF="WC103" K ^UTILITY($J,"W")
	I $D(^FB7078(FB7078,1,0)) F FBRR=0:0 S FBRR=$O(^FB7078(FB7078,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	D FISCAL^FBCH78A
	W UL,!,"8. Fee Schedule or Contract",?33,L,"9. Authority",?66,L,"9A.",?93,L,"10. Estimated Amount",!?5,$$CONT^FBCH78A(+$P(FB(0),U,2),$P(FB(0),U,4)),?33,L,?35,FB(6),?66,L,?93,L,?95,"$"
	K X2 S X=$P(FB(0),"^",7),X3=$L(+X)+2 D COMMA^%DTC K X3 W X,!,UL,!
	W "11. Fiscal Symbols",?66,L,"12. Authorized by (Name and Title)",!,?5,FB("SYM"),?66,L,?68,FBO,"  ",FBT,!,UL
	D BOT^FBCH78A
	Q
DATE	S Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3) Q
	;
FBO	S DIR(0)="F^3:45",DIR("A")="Approving Official for 7078",DIR("B")=FBO,DIR("?")="Enter <return> to accept the default or enter a name from 3 to 45 characters in length" D ^DIR K DIR Q:$D(DIRUT)  S FBO=X
FBT	S DIR(0)="F^3:45",DIR("A")="Title of Approving Official",DIR("B")=FBT,DIR("?")="Enter <return> to accept the default title or enter a title from 3 to 45 characters in length" D ^DIR K DIR Q:$D(DIRUT)  S FBT=X
ASKN	S DIR(0)="N^1:5",DIR("A")="# of copies of 7078",DIR("B")=FBNUM,DIR("?")="Select a number between 1 and 5.  This number represents the number of copies of the 7078 you would like printed" D ^DIR K DIR Q:$D(DIRUT)  S FBNUM=X

FBCHPET
FBCHPET	;AISC/DMK-EDIT ANCILLARY PAYMENT ;15FEB90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FY=$E(DT,1,3)+1700+$S($E(4,5)>9:1,1:0)
GETPT	I $G(BAT) D
	.I '$D(^FBAAC("AC",+BAT)) F I=9,10,11 S $P(^FBAA(161.7,+BAT,0),U,I)=""
	.I $D(^FBAAC("AC",+BAT)) D  S $P(^FBAA(161.7,+BAT,0),U,11)=I,$P(^(0),U,9)=$G(FBTOT) K I,FBTOT
	..N J,K,L,M S (I,J,K,L,M,FBTOT)=0
	..F  S J=$O(^FBAAC("AC",+BAT,J)) Q:'J  F  S K=$O(^FBAAC("AC",+BAT,J,K)) Q:'K  F  S L=$O(^FBAAC("AC",+BAT,J,K,L)) Q:'L  F  S M=$O(^FBAAC("AC",+BAT,J,K,L,M)) Q:'M  I $D(^FBAAC(J,1,K,1,L,1,M,0)) S I=I+1,FBTOT=FBTOT+$P(^(0),U,3)
	W !! S DIC="^FBAAC(",DIC(0)="AEQM" D ^DIC G END:X="^"!(X=""),GETPT:Y<0 S (DFN,FBDA(3))=+Y
	S:'$D(^FBAAC(DFN,1,0)) ^FBAAC(DFN,1,0)="^162.01P^0^0"
	S DIC=DIC_DFN_",1,"
GETVD	W !! S DIC(0)="AEQM" D ^DIC G GETPT:X="^"!(X=""),GETVD:Y<0 S (FBV,FBVD,FBDA(2))=+Y
	S:'$D(^FBAAC(DFN,1,FBDA(2),1,0)) ^FBAAC(DFN,1,FBDA(2),1,0)="^162.02DA^0^0"
	S DIC=DIC_FBVD_",1,"
GETDT	S DIC(0)="AEQM",DIC("A")="Date of Service: " D ^DIC K DIC("A") G GETPT:X="^"!(X=""),GETDT:Y<0 S (FBSD,FBSDI,FBDA(1))=+Y,FBAADT=$P(Y,"^",2)
	S:'$D(^FBAAC(DFN,1,FBDA(2),1,FBDA(1),1,0)) ^FBAAC(DFN,1,FBDA(2),1,FBDA(1),1,0)="^162.03A^0^0"
	S FBZ=DIC_FBSD_",1,"
SERV	S DA(3)=FBDA(3),DA(2)=FBDA(2),DA(1)=FBDA(1)
	S DIC("W")="W $S($P($G(^(2)),U,7):""    CPT Modifier: ""_$P($G(^DIC(81.3,+$P(^(2),U,7),0)),U),1:"""")"
	S DIC=FBZ,DIC(0)="AEQM" D ^DIC G GETPT:X="^"!(X=""),SERV:Y<0 S (FBSV,FBAACPI,FBDA)=+Y,BAT=$P(^FBAAC(FBDA(3),1,FBDA(2),1,FBDA(1),1,FBDA,0),"^",8),FBDUZ=$P(^(0),"^",7),FBAACP=$P(Y,"^",2),K=$P(^(0),"^",3)
	I FBDUZ'=DUZ&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"Sorry,only the clerk who entered the payment ",!," or a supervisor can edit this payment." G GETPT
	G:BAT']"" EDIT
	I $P(^FBAA(161.7,BAT,"ST"),"^",1)="S"!($P(^FBAA(161.7,BAT,"ST"),"^",1)="T")&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,"Sorry, only the Supervisor can edit a payment once the batch has been released." G GETPT
	I $P(^FBAA(161.7,BAT,"ST"),"^",1)="V" W !!,*7,"Sorry,you cannot edit a payment once the batch has been Finalized." G GETPT
EDIT	S DA=FBSV,DR=".01;39;1;S J=X;2;S K=X;3////^S X=$S(J-K:J-K,1:"""");I X S Y=""@11"";4////@;S Y=26;@11;3R;4R;S:X'=4 Y=26;22"
	S DR(1,162.03,1)="26;S PRC(""SITE"")=X;8;13;Q;33;34;15;16;17////^S X=1"
	S DIE=DIC D ^DIE K FBSV W !! G SERV
END	K DR,DIC,DIE,X,DFN,FBVD,FBSD,BAT,FBSV,DA,FBDA,FBZ,FBDUZ,FBAACP,FBFY,FY,FBAMTPD,J,K,Y,PRC,FBHOLDX,ZZ,FBAADT,FBV,FBSDI,FBAACPI Q

FBCHPH
FBCHPH	;AISC/DMK-PATIENT PAYMENT HISTORY ;29AUG90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
GETVET	K FBAANQ D GETVET^FBAAUTL1 G END:DFN']""
	I '$D(^FBAAI("AG",DFN)) W !,*7,"No invoices on line for this patient." G GETVET
	D DATE^FBAAUTL G:FBPOP GETVET S ZZ=9999999.9999,FBBEG=ZZ-ENDDATE,FBEND=ZZ-BEGDATE
	S VAR="DFN^BEGDATE^ENDDATE^FBBEG^FBEND"_$S($D(FBPROG):"^FBPROG",1:""),VAL=DFN_"^"_BEGDATE_"^"_ENDDATE_"^"_FBBEG_"^"_FBEND_$S($D(FBPROG):"^"_FBPROG,1:""),PGM="START^FBCHPH" D ZIS^FBAAUTL G:FBPOP END S:IO=IO(0) FBAANQ=1
START	S:'$D(FBPROG) FBPROG=6 S FBHEAD="VETERAN",Q="",$P(Q,"=",80)="=",FBAAOUT=0 U IO D GETDAT^FBCHVH S:$E(IOST,1,2)'["C-" FBPG=1 D HEDC^FBCHVH,DEM^VADPT
	F FBM=FBBEG-.1:0 S FBM=$O(^FBAAI("AG",DFN,FBM)) Q:FBM'>0!(FBM>FBEND)!(FBAAOUT)  F FBI=0:0 S FBI=$O(^FBAAI("AG",DFN,FBM,FBI)) Q:FBI'>0!(FBAAOUT)  I $D(^FBAAI(FBI,0)),$P(^(0),"^",12)=FBPROG,'$D(^("FBREJ")) D GETINV
	G:$D(FBAANQ) GETVET
END	K DFN,DIC,FBM,BEGDATE,ENDDATE,FBBEG,FBEND,FBHEAD,FBAANQ,FBAAOUT,FBDX,FBI,FBIN,FBPROC,FBVEN,FBVID,FBI,J,K,L,PGM,Q,VADM,VAERR,VAL,VAR,X,Y,ZZ,VA,FBPROG,FBPG
	D CLOSE^FBAAUTL Q
GETINV	S FBIN=^FBAAI(FBI,0) F J=1,2,3,5,6,7,8,9,11,13,14 S FBIN(J)=$P(FBIN,"^",J)
	S FBVEN=$S($D(^FBAAV(FBIN(3),0)):$P(^(0),"^",1),1:"") I FBVEN]"" S FBVID=$P(^(0),"^",2)
	S Y=FBIN(2) D CDAT^FBCHVH S FBIN(2)=Y
	S Y=FBIN(6) D CDAT^FBCHVH S FBIN(6)=Y,Y=FBIN(7) D CDAT^FBCHVH S FBIN(7)=Y
WRT	I $Y+6>IOSL D HANG^FBAAUTL1:$E(IOST,1,2)["C-" Q:FBAAOUT  D HEDC^FBCHVH
	W !,$S('$D(FBIN(13)):"",FBIN(13)="R":"*",1:"")
	W VADM(1)_"  "_$P(VADM(2),"^",2),!,?4,FBVEN,?45,FBVID,?62,FBIN(1),!,$S(FBIN(13)["R":"*",1:""),$S(FBIN(14)]"":"#",1:""),?4,FBIN(6),?14,FBIN(7),?24,$J(FBIN(8),1,2),?33,$J(FBIN(9),1,2),?43,FBIN(11),?59,FBIN(2),!
	I $D(^FBAAI(FBI,"DX")) S FBDX=^("DX") F K=1:1:5 Q:$P(FBDX,"^",K)=""  D WRTDX
	I $D(^FBAAI(FBI,"PROC")) S FBPROC=^("PROC") W ! F L=1:1:5 Q:$P(FBPROC,"^",L)=""  D WRTPC
	D ^FBCHPH0
	Q
WRTDX	I $P(FBDX,"^",K)]"" W ?4,"Dx: ",$S($D(^ICD9($P(FBDX,"^",K),0)):$P(^(0),"^"),1:""),"  " Q
	Q
WRTPC	I $P(FBPROC,"^",L)]"" W ?4,"Proc: ",$S($D(^ICD0($P(FBPROC,"^",L),0)):$P(^(0),"^"),1:""),"   " Q
	Q

FBCHPH0
FBCHPH0	;AISC/DMK-PATIENT PAYMENT HISTORY CON'T ;18JAN91
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;Called from FBCHPH to print any associated payments made against 7078/583
	I '$D(DFN),'$D(FBIN(5)) Q
	I DFN,+FBIN(5),$D(^FBAAC("AM",FBIN(5),DFN)) D HED,PAY
KILL	K FBA,X2,X3 Q
PAY	F FBA("I")=0:0 S FBA("I")=$O(^FBAAC("AM",FBIN(5),DFN,FBA("I"))) Q:'FBA("I")  F FBA("J")=0:0 S FBA("J")=$O(^FBAAC("AM",FBIN(5),DFN,FBA("I"),FBA("J"))) Q:'FBA("J")  D LOOP
	Q
LOOP	F FBA("K")=0:0 S FBA("K")=$O(^FBAAC("AM",FBIN(5),DFN,FBA("I"),FBA("J"),FBA("K"))) Q:'FBA("K")  I $D(^FBAAC(DFN,1,FBA("I"),1,FBA("J"),1,FBA("K"),0)) S FBA(0)=^(0) D PRINT
	Q
PRINT	S FBA("V")=$S($D(^FBAAV(FBA("I"),0)):$P(^(0),"^"),1:"")
	I FBA("V")'="" S FBA("V",1)=$P(^FBAAV(FBA("I"),0),"^",2)
	S FBA("D")=$S($D(^FBAAC(DFN,1,FBA("I"),1,FBA("J"),0)):$P(^(0),"^"),1:"")
	I FBA("D") S Y=FBA("D") D PDF^FBAAUTL S FBA("D")=Y
	I $P(FBA(0),"^")]"" S FBA("CPT")=$S($D(^ICPT($P(FBA(0),"^"),0)):$P(^(0),"^"),1:"")
	;S FBA("FDT")=$P(FBA(0),"^",6) I FBA("FDT") S Y=FBA("FDT") D PDF^FBAAUTL S FBA("FDT")=Y
	S FBA("BAT")=$P(FBA(0),"^",8) I FBA("BAT"),$D(^FBAA(161.7,FBA("BAT"),0)) S FBA("BAT")=$P(^(0),"^")
	S FBA("SUS")=$P(FBA(0),"^",5) I FBA("SUS")]"",$D(^FBAA(161.27,FBA("SUS"),0)) S FBA("SUS")=$P(^(0),"^")
	S X=$P(FBA(0),"^",2) D DOLLAR S FBA("AC")=X
	S X=$P(FBA(0),"^",3) D DOLLAR S FBA("PD")=X
	W !,"Vendor: ",$E(FBA("V"),1,30),?40,"ID: ",FBA("V",1),?60,"Srv Dt.: ",FBA("D"),!?13,FBA("CPT"),?23,FBA("AC"),?33,FBA("PD"),?42,FBA("SUS"),?51,FBA("BAT"),?60,$P(FBA(0),"^",16),!
	Q
DOLLAR	Q:'$D(X)  K X2 S X3=6 D COMMA^%DTC
	Q
HED	W !?20,">>> ANCILLARY SERVICE PAYMENTS <<<",! S FBA("Q")="",$P(FBA("Q"),"-",80)="-"
	W !?13,"CPT ",?23,"Amount",?33,"Amount",?42,"Susp",?51,"Batch",?60,"Invoice",?69,!?13,"Code",?23,"Claimed",?33,"Paid",?42,"Code",?51,"Number",?60,"Number",!,?12,$E(FBA("Q"),1,60),!
	Q

FBCHPRC
FBCHPRC	;AISC/DMK-PRINT ROC FOR CONTRACT HOSPITAL ;15AUG90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ROC	S DIC="^FBAA(161.5,",DIC(0)="AEQM",D="D",DIC("A")="Select Veteran: ",DIC("W")="W ?30,$S($D(^FBAAV($P(^(0),U,2),0)):$P(^(0),U),1:"""")" D IX^DIC K D,DIC G END:X=""!(X="^"),ROC:Y<0 S FBIFN=+Y
EN	S VAR="FBIFN",VAL=FBIFN,PGM="START^FBCHPRC" D ZIS^FBAAUTL G END:FBPOP
START	U IO W:$E(IOST,1,2)["C-" @IOF S L="|",Q="",$P(Q,"-",80)="-",FB("PG")=1
	G END:'$D(^FBAA(161.5,FBIFN,0)) S FB(0)=^(0),FB1(0)="" I $D(^FBAA(161.5,FBIFN,1)) S FB1(0)=^(1)
	F J=1:1:14 S FB(J)=$P(FB(0),"^",J)
	F I=1:1:4 S FB(J+I)=$P(FB1(0),"^",I)
	S FB(J+5)=$P(FB1(0),"^",7)
	S DFN=FB(3),VAPA("P")="" D 6^VADPT,SITEP^FBAAUTL S FBSITE=$P(FBSITE(0),"^"),Y=FB(4) D DATE S FB(4)=$E(Y,1,17)
	S FB(17)=$S(FB(17)="":"Unknown",$D(^DGBT(392.4,FB(17),0)):$P(^(0),"^"),1:"Unknown")
	I FB(5)]"" S FB(5)=$$DATX^FBAAUTL(FB(5))
	I FB(19)]"" S FB(19)=$$DATX^FBAAUTL(FB(19))
	D VEN,^FBCHPRC1
END	K DIWF,DIWL,BT,BOT,DIWR,DFN,FB1,FB,FBI,FBIFN,FBRR,FBSITE,FBVEN,I,J,L,PGM,Q,VA,VADM,VAEL,VAERR,VAL,VAR,VAPA,X,Y,Z D CLOSE^FBAAUTL
	Q
VEN	;GET VENDOR DEMOGRAPHICS
	S FBVEN(0)=$S(FB(2)="":"",$D(^FBAAV(FB(2),0)):^(0),1:"") I FBVEN(0)="" S FBVEN="Unknown" Q
	S FBVEN(6)=$S($D(^FBAAV(FB(2),1)):$P(^(1),"^"),1:""),FBVEN=$P(FBVEN(0),"^")
	S FBVEN(1)=$P(FBVEN(0),"^",3),FBVEN(2)=$P(FBVEN(0),"^",14),FBVEN(3)=$P(FBVEN(0),"^",4)
	S FBVEN(4)=$S($P(FBVEN(0),"^",5)']"":"Unknown",$D(^DIC(5,$P(FBVEN(0),"^",5),0)):$P(^(0),"^"),1:"Unknown")
	S FBVEN(5)=$P(FBVEN(0),"^",6)
	K FBVEN(0) Q
USER	;GET USER IN FILE 200
	S FB("USER")=$S(FB("DUZ")="":"Unknown",$D(^VA(200,FB("DUZ"),0)):$P(^(0),"^"),1:"Unknown")
	Q
RPTC	;RETRIEVE DATE,USER AND NARRATIVE OF ROC
	S DIWL=7,DIWR=74,DIWF="W"
	F FBI=0:0 S FBI=$O(^FBAA(161.5,FBIFN,2,FBI)) Q:FBI'>0  I $D(^FBAA(161.5,FBIFN,2,FBI,0)) S FB("DATE")=$P(^(0),"^"),FB("DUZ")=$P(^(0),"^",2) D GETNAR
	Q
GETNAR	K ^UTILITY($J,"W") S Y=FB("DATE") D DATE S FB("DATE")=Y D USER
	W !,"DATE: ",FB("DATE"),?53,"USER: ",$E(FB("USER"),1,22)
	F FBRR=0:0 S FBRR=$O(^FBAA(161.5,FBIFN,2,FBI,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	I $Y+11>IOSL S FB("PG")=FB("PG")+1 W @IOF,!,?70,"Page ",FB("PG"),!!?25,"REPORT OF CONTACT CONTINUED",!,?24,$E(Q,1,29),!,?1,"For: ",VADM(1),!,Q,!
	Q
DATE	X ^DD("DD") Q

FBCHPRC1
FBCHPRC1	;AISC/DMK-PRINT REPORT OF CONTACT CONT ;08/02/88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	W ?70,"Page ",FB("PG"),!
	W ?40,L,?58,L,!,?8,">>  REPORT  OF  CONTACT  <<",?40,L,$E(FBSITE,1,18),?58,L,?60,$P(VADM(2),"^",2),!,?40,L,$E(FBSITE,19,30),?58,L,"DOB: ",$P(VADM(3),"^",2),!,Q,!,?3," Name of Veteran",?34,L,"Telephone No. of Vet.",?58,L,"Date of Contact",!
	W ?34,L,?58,L,!,?3,$E(VADM(1),1,30),?34,L,VAPA(8),?58,L,?61,FB(4),!,Q,!,?3," Address of Veteran",?58,L,"Type of Contact",!,?3,VAPA(1),?58,L,!,?3,VAPA(4),",",$P(VAPA(5),"^",2)
	W " ",$S('+$G(VAPA(11)):VAPA(6),$P(VAPA(11),U,2)]"":$P(VAPA(11),U,2),1:VAPA(6)),?58,L
	W ?63,$S(FB(6)="T":"Telephone",1:"Personal"),!,Q,!,?3," Person Contacted",?58,L,"Telephone Number of",!,?3,FB(7),?58,L,"  Person Contacted",!,?3,FB(8),?58,L,?61,FB(18)
	W !?3,$S(FB(9)]"":FB(9),1:FB(10)_", "_$S(FB(11)="":"Unknown",$D(^DIC(5,FB(11),0)):$P(^(0),"^"),1:"Unknown")_", "_FB(12)) I FB(9)="" W !,Q
	I FB(9)]"" W !?3,FB(10),", ",$S($D(^DIC(5,+FB(11),0)):$P(^(0),"^"),1:"Unknown"),", ",FB(12),!,Q
	W !?15,"NOTIFICATION OF ADMISSION TO PRIVATE HOSPITAL",!?14,$E(Q,1,47)
	W !?3,"AUTHORIZATION FROM DATE/TIME: ",FB(5),!?3,"DATE/TIME OF ADMISSION: ",FB(19),!?9,"NAME of HOSPITAL: ",FBVEN,!?18,"ADDRESS: ",FBVEN(1),?54,"PHONE: ",FBVEN(6),!?27,$S(FBVEN(2)]"":FBVEN(2),1:FBVEN(3)_", "_FBVEN(4)_" "_FBVEN(5))
	I FBVEN(2)]"" W !?27,FBVEN(3),", ",FBVEN(4)," ",FBVEN(5)
	W !?9,"PHYSICIAN'S NAME: ",$S(FB(13)="":"Not Entered",1:FB(13))
	W ?50,"PHONE: ",FB(14)
	W !?6,"TENTATIVE DIAGNOSIS: ",FB(15),!?11,"INSURANCE TYPE: ",FB(16),!?3,"MODE of TRANSPORTATION: ",FB(17)
	W !,?3,"ELIGIBILITY: ",$P(VAEL(1),"^",2),", " I $O(VAEL(1,0)) F J=0:0 S J=$O(VAEL(1,J)) Q:J'>0  S X=$P(VAEL(1,J),"^",2)_", " W:$X+$L(X)>80 !,?16 W X
	W !,Q D RPTC^FBCHPRC
BOT	W ! S BOT=IOSL-($Y+11) F BT=1:1:BOT W !
	W ?3,"APPROVED/DISAPPROVED",!!?2,"______________________"
	W !?3,$$SIGBLK^FBAAPRC($P(FB1(0),U,6))
	W !,Q,!,?6,"Division or Section",?40,L,"   Executed by(signature and title)",!,?7,"FEE BASIS SECTION",?40,L,"   ",!,Q,!?3,"VA form 119C"
	Q

FBCHPSA
FBCHPSA	;AISC/DMK-CALCULATES COSTS BY PSA ;13JUN90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	S FBPSA=0
	S DIR(0)="Y",DIR("A")="Do you want this report for all PSAs",DIR("B")="YES" D ^DIR K DIR G END:$D(DIRUT),SELECT:'Y
ASKDT	D PROG^FBCHPSA1 G END:'$O(FBPROG(0))
	D DATE^FBAAUTL G END:FBPOP S FBBEG=9999999-ENDDATE,FBEND=9999999-BEGDATE
	S VAR="FBBEG^FBEND^FBPSA^BEGDATE^ENDDATE^FBPROG(",PGM="START^FBCHPSA" S IOP="Q" D ZIS^FBAAUTL G END:FBPOP
	;
START	; start output
	S BEGDATE=$$DATX^FBAAUTL(BEGDATE),ENDDATE=$$DATX^FBAAUTL(ENDDATE)
	S:$E(IOST,1,2)'="C-" FBPG=1
	S (FBAAOUT,FBCNT)=0,QQ="=",$P(QQ,"=",80)="=",Q="-",$P(Q,"-",80)="-"
	K ^TMP("FBPSA",$J)
	S FBPROG=0
	S FBHPSA=FBPSA
	F  S FBPROG=$O(FBPROG(FBPROG)) Q:'FBPROG!($G(FBAAOUT))  D  G END:$G(FBAAOUT) S FBPSA=FBHPSA
	. I FBPROG=6 D REPORT Q:$G(FBAAOUT)
	. I FBPROG=7 D REPORT Q:$G(FBAAOUT)
	. I FBPROG=3 D ^FBCHPSA1 Q:$G(FBAAOUT)
	. I FBPROG=2 D ^FBCHPSA0 Q:$G(FBAAOUT)
	;
	G END:$G(FBAAOUT)
	D PSATOT^FBCHPSA0
	G END
REPORT	U IO
	K ^TMP("FBPSA",$J) D HED
	I FBPSA>0 F FBI=FBBEG-.1:0 S FBI=$O(^FBAAI("AP",FBPSA,FBI)) Q:FBI'>0!(FBI>FBEND)!(FBAAOUT)  F FBJ=0:0 S FBJ=$O(^FBAAI("AP",FBPSA,FBI,FBJ)) Q:FBJ'>0!(FBAAOUT)  I $D(^FBAAI(FBJ,0)) S FBY(0)=^(0) D MORE
	I FBPSA=0 F FBPSA=0:0 S FBPSA=$O(^FBAAI("AP",FBPSA)) Q:FBPSA'>0!(FBAAOUT)  F FBI=FBBEG-.1:0 S FBI=$O(^FBAAI("AP",FBPSA,FBI)) Q:FBI'>0!(FBI>FBEND)!(FBAAOUT)  F FBJ=0:0 S FBJ=$O(^FBAAI("AP",FBPSA,FBI,FBJ)) Q:FBJ'>0!(FBAAOUT)  D MORE1
	Q:FBAAOUT
	I $D(^TMP("FBPSA",$J)) D HED1 F I=0:0 S I=$O(^TMP("FBPSA",$J,I)) Q:I'>0  S FBSTA=$S($D(^DIC(4,I,0)):$P(^(0),"^"),1:"Unknown") W !?2,FBSTA,?44,"$  ",$P(^TMP("FBPSA",$J,I),"^")
	I '$D(^TMP("FBPSA",$J)) D NONE^FBCHPSA1
	D HANG
	Q
	;
END	K DFN,DIR,DIRUT,ENDDATE,BEGDATE,FBAAOUT,FBAMTPD,FBBEG,FBDFN,FBCNT,FBCOUNTY,FBEND,FBI,FBJ,FBINV,FBNAME,FBPDDT,FBPPSA,FBPSA,FBSSN,FBSTA,FBY,Q,QQ,VAERR,VAPA,VAL,I,X,^TMP("FBPSA",$J),I,J,K,L,FBAMT,FB7078,FBZ,FBPROG,FBHPSA,IOP
	K FBK,FBL,FBM,VA,VADM,Y,ZZ,FBOBL,^TMP("FBTOT",$J) D CLOSE^FBAAUTL
	Q
MORE1	Q:'$D(^FBAAI(FBJ,0))  S FBY(0)=^(0)
MORE	S (FBDFN,DFN)=$P(FBY(0),"^",4),FBINV=$P(FBY(0),"^"),FBPPSA=$P(FBY(0),"^",20),FBAMTPD=$P(FBY(0),"^",9),FBPDDT=$P(FBY(0),"^",16),FBPDDT=$$DATX^FBAAUTL(FBPDDT) S VAPA("P")="" D ADD^VADPT S FBCOUNTY=$P(VAPA(7),"^",2)
	Q:$P(FBY(0),"^",12)'=FBPROG
	S FB7078=$P(FBY(0),"^",5) Q:FB7078=""  D EN1 S FBAMTPD=FBAMTPD+FBAMT
	S FBNAME=$$NAME^FBCHREQ2(FBDFN),FBSSN=$$SSN^FBAAUTL(FBDFN)
	S FBSTA=$S($D(^DIC(4,FBPPSA,0)):$P(^(0),"^"),1:"Unknown")
	S FBOBL=$P(FBY(0),"^",17),FBOBL=$S(FBOBL="":"Unknown",1:$S($D(^FBAA(161.7,FBOBL,0)):$P(^(0),"^",2),1:"Unknown"))
	I $Y+4>IOSL D HANG Q:FBAAOUT  D HED
	W !,$E(FBNAME,1,30)," -",$$SSN^FBAAUTL(FBDFN,1),?42,FBOBL,?57,FBCOUNTY,!,?4,FBINV,?21,FBAMTPD,?39,FBPDDT,?60,FBSTA,!,Q,!
	S:'$D(^TMP("FBPSA",$J,FBPPSA)) ^TMP("FBPSA",$J,FBPPSA)=0
	S ^TMP("FBPSA",$J,FBPPSA)=^TMP("FBPSA",$J,FBPPSA)+FBAMTPD
	S:'$D(^TMP("FBTOT",$J,FBPPSA)) ^TMP("FBTOT",$J,FBPPSA)=0
	S ^TMP("FBTOT",$J,FBPPSA)=^TMP("FBTOT",$J,FBPPSA)+FBAMTPD
	Q
HED	W:'$G(FBPG) @IOF I $G(FBPG) K FBPG
	W !?25,$S(FBPROG=6:"CIVIL HOSPITAL PSA REPORT",FBPROG=2:"OUTPATIENT MEDICAL PSA REPORT",FBPROG=3:"PHARMACY PSA REPORT",1:"COMMUNITY N.H. PSA REPORT")
	W !?24,"-------------------------------",!,"Patient Name",?40,"Obligation #",?56,"County Code",!
	W ?3,"Invoice #",?20,"Amount Paid",?38,"Date Finalized",?59,"PSA",!,QQ
	Q
SELECT	S DIR(0)="161.01,101" D ^DIR G END:$D(DUOUT),H^XUS:$D(DTOUT),EN:X="" S FBPSA=+Y G ASKDT
HANG	I $E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR S:'Y FBAAOUT=1
	Q
HED1	W !,QQ,!?7,"Total Dollars spent by PSA for the dates of ",BEGDATE," to ",ENDDATE,". ",!!?5,"PSA",?40,"TOTAL AMOUNT PAID",!,?4,"-----",?39,"--------------------" Q
EN1	S FBAMT=0 Q:'$D(^FBAAC("AM",FB7078))
	F I=0:0 S I=$O(^FBAAC("AM",FB7078,I)) Q:I'>0  F J=0:0 S J=$O(^FBAAC("AM",FB7078,I,J)) Q:J'>0  F K=0:0 S K=$O(^FBAAC("AM",FB7078,I,J,K)) Q:K'>0  F L=0:0 S L=$O(^FBAAC("AM",FB7078,I,J,K,L)) Q:L'>0  I $D(^FBAAC(I,1,J,1,K,1,L,0)) S FBZ(0)=^(0) D GT
	Q
GT	S FBAMT=FBAMT+$P(FBZ(0),"^",3) Q

FBCHPSA0
FBCHPSA0	;AISC/DMK-PSA OUTPUT CONTINUED ;13JUN90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D HED^FBCHPSA K ^TMP("FBPSA",$J)
EN	I FBPSA>0 F FBI=FBBEG-.1:0 S FBI=$O(^FBAAC("AQ",FBPSA,FBI)) Q:FBI'>0!(FBI>FBEND)!(FBAAOUT)  F FBJ=0:0 S FBJ=$O(^FBAAC("AQ",FBPSA,FBI,FBJ)) Q:FBJ'>0!(FBAAOUT)  F FBK=0:0 S FBK=$O(^FBAAC("AQ",FBPSA,FBI,FBJ,FBK)) Q:FBK'>0!(FBAAOUT)  D MORE
	I FBPSA=0 F FBPSA=0:0 S FBPSA=$O(^FBAAC("AQ",FBPSA)) Q:FBPSA'>0!(FBAAOUT)  F FBI=FBBEG-.1:0 S FBI=$O(^FBAAC("AQ",FBPSA,FBI)) Q:FBI'>0!(FBI>FBEND)!(FBAAOUT)  F FBJ=0:0 S FBJ=$O(^FBAAC("AQ",FBPSA,FBI,FBJ)) Q:FBJ'>0  D MORE1
	Q:FBAAOUT
	I $D(^TMP("FBPSA",$J)) D HED1^FBCHPSA F I=0:0 S I=$O(^TMP("FBPSA",$J,I)) Q:I'>0  S FBSTA=$S($D(^DIC(4,I,0)):$P(^(0),"^"),1:"Unknown") W !?2,FBSTA,?44,"$ ",$P(^TMP("FBPSA",$J,I),"^")
	I '$D(^TMP("FBPSA",$J)) D NONE^FBCHPSA1
	D HANG^FBCHPSA
	Q
	;
PSATOT	Q:'$O(^TMP("FBTOT",$J,0))  D HED2
	F I=0:0 S I=$O(^TMP("FBTOT",$J,I)) Q:I'>0  S FBSTA=$S($D(^DIC(4,I,0)):$P(^(0),"^"),1:"Unknown") W !?2,FBSTA,?44,"$ ",^TMP("FBTOT",$J,I)
	Q
HED2	W @IOF,!?13,"TOTALS DOLLAR AMOUNT BY PSA FOR ALL SELECTED PROGRAMS",!?12,$E(Q,1,55),!!,"For Date Range: ",BEGDATE," to ",ENDDATE,!,QQ
	W !?5,"PSA",?40,"TOTAL AMOUNT",!,?4,"-----",?39,"--------------------"
	Q
MORE	F FBL=0:0 S FBL=$O(^FBAAC("AQ",FBPSA,FBI,FBJ,FBK,FBL)) Q:FBL'>0!(FBAAOUT)  F FBM=0:0 S FBM=$O(^FBAAC("AQ",FBPSA,FBI,FBJ,FBK,FBL,FBM)) Q:FBM'>0  I $D(^FBAAC(FBJ,1,FBK,1,FBL,1,FBM,0)) S FBY(0)=^(0) D GET
	Q
GET	S DFN=FBJ,VAPA("P")="" D 4^VADPT S FBNAME=VADM(1),FBCOUNTY=$P(VAPA(7),"^",2),FBINV=$P(FBY(0),"^",16),FBAMTPD=$P(FBY(0),"^",3),FBPDDT=$P(FBY(0),"^",6),FBPDDT=$$DATX^FBAAUTL(FBPDDT),FBPPSA=$P(FBY(0),"^",12)
	S FBOBL=$S($P(FBY(0),"^",10)="":"Unknown",1:$P(FBY(0),"^",10))
	S FBSTA=$S($D(^DIC(4,FBPPSA,0)):$P(^(0),"^"),1:"Unknown")
	I $Y+4>IOSL D HANG^FBCHPSA Q:FBAAOUT  D HED^FBCHPSA
	W !,$E(FBNAME,1,30)," -",VA("BID"),?42,FBOBL,?57,FBCOUNTY,!,?4,FBINV,?21,FBAMTPD,?39,FBPDDT,?60,FBSTA,!,Q,!
	S:'$D(^TMP("FBPSA",$J,FBPSA)) ^TMP("FBPSA",$J,FBPSA)=0
	S ^TMP("FBPSA",$J,FBPSA)=^TMP("FBPSA",$J,FBPSA)+FBAMTPD
	S:'$D(^TMP("FBTOT",$J,FBPSA)) ^TMP("FBTOT",$J,FBPSA)=0
	S ^TMP("FBTOT",$J,FBPSA)=^TMP("FBTOT",$J,FBPSA)+FBAMTPD
	Q
MORE1	F FBK=0:0 S FBK=$O(^FBAAC("AQ",FBPSA,FBI,FBJ,FBK)) Q:FBK'>0!(FBAAOUT)  F FBL=0:0 S FBL=$O(^FBAAC("AQ",FBPSA,FBI,FBJ,FBK,FBL)) Q:FBL'>0!(FBAAOUT)  F FBM=0:0 S FBM=$O(^FBAAC("AQ",FBPSA,FBI,FBJ,FBK,FBL,FBM)) Q:FBM'>0  D MORE2
	Q
MORE2	I $D(^FBAAC(FBJ,1,FBK,1,FBL,1,FBM,0)) S FBY(0)=^(0) D GET
	Q

FBCHPSA1
FBCHPSA1	;AISC/DMK-PSA OUTPUT CONTINUED ; 18JUN90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RX	;
	D HED^FBCHPSA K ^TMP("FBPSA",$J)
	I FBPSA>0 F FBI=FBBEG-.1:0 S FBI=$O(^FBAA(162.1,"AI",FBPSA,FBI)) Q:FBI'>0!(FBI>FBEND)!(FBAAOUT)  D MORE
	I FBPSA=0 F FBPSA=0:0 S FBPSA=$O(^FBAA(162.1,"AI",FBPSA)) Q:FBPSA'>0!(FBAAOUT)  F FBI=FBBEG-.1:0 S FBI=$O(^FBAA(162.1,"AI",FBPSA,FBI)) Q:FBI'>0!(FBI>FBEND)!(FBAAOUT)  D MORE
	Q:FBAAOUT
	I $D(^TMP("FBPSA",$J)) D HED1^FBCHPSA F I=0:0 S I=$O(^TMP("FBPSA",$J,I)) Q:I'>0  S FBSTA=$S($D(^DIC(4,I,0)):$P(^(0),"^"),1:"Unknown") W !,?2,FBSTA,?44,"$ ",$P(^TMP("FBPSA",$J,I),"^")
	I '$D(^TMP("FBPSA",$J)) D NONE
	D HANG^FBCHPSA
	Q
MORE	F FBK=0:0 S FBK=$O(^FBAA(162.1,"AI",FBPSA,FBI,FBK)) Q:FBK'>0!(FBAAOUT)  F FBL=0:0 S FBL=$O(^FBAA(162.1,"AI",FBPSA,FBI,FBK,FBL)) Q:FBL'>0!(FBAAOUT)  I $D(^FBAA(162.1,FBK,"RX",FBL,0)) S FBI(0)=^(0),FBK(0)=^(2) D WRT
	Q
WRT	S DFN=$P(FBI(0),"^",5) D 4^VADPT S FBNAME=VADM(1),FBCOUNTY=$P(VAPA(7),"^",2),FBINV=FBK,FBAMTPD=$P(FBI(0),"^",16),FBPDDT=$P(FBI(0),"^",19),FBPDDT=$$DATX^FBAAUTL(FBPDDT),FBPPSA=$P(FBK(0),"^",5)
	S FBOBL=$S($P(FBI(0),"^",18)="":"Unknown",1:$P(FBI(0),"^",18))
	S FBSTA=$S($D(^DIC(4,FBPPSA,0)):$P(^(0),"^"),1:"Unknown")
	I $Y+4>IOSL D HANG^FBCHPSA Q:FBAAOUT  D HED^FBCHPSA
	W !,$E(FBNAME,1,30)," -",VA("BID"),?42,FBOBL,?57,FBCOUNTY,!,?4,FBINV,?21,FBAMTPD,?39,FBPDDT,?60,FBSTA,!,Q,!
	S:'$D(^TMP("FBPSA",$J,FBPSA)) ^TMP("FBPSA",$J,FBPSA)=0
	S ^TMP("FBPSA",$J,FBPSA)=^TMP("FBPSA",$J,FBPSA)+FBAMTPD
	S:'$D(^TMP("FBTOT",$J,FBPSA)) ^TMP("FBTOT",$J,FBPSA)=0
	S ^TMP("FBTOT",$J,FBPSA)=^TMP("FBTOT",$J,FBPSA)+FBAMTPD
	Q
	;
PROG	;one/many/all fee programs
	;    returns FBPROG(ien)=external value
	;
	N DIC,VAUTSTR,VAUTNI,VAUTVB
	S DIC="^FBAA(161.8,",DIC("S")="I $P(^(0),U,3)"
	S VAUTSTR="FEE PROGRAM",VAUTNI=2,VAUTVB="FBPROG"
	D FIRST^VAUTOMA
	I 'FBPROG&('$O(FBPROG(0))) Q
	I FBPROG D
	.   N X S X=0
	.   F  S X=$O(^FBAA(161.8,X)) Q:'X  S X(0)=$G(^(X,0)) I $P(X(0),U,3) S FBPROG(X)=$P(X(0),U)
	Q
	;
NONE	;write no payments found for this program and quit
	W !!,"No payments found for this Fee Program.",!
	Q

FBCHREQ
FBCHREQ	;AISC/DMK-USED FOR FEE NOTIFICATION/REQUEST ;13DEC88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ADD	;Entry point for entering a notification/request
	D FEE^DGREG G END:'$D(DFN)
	W ! S DIC="^FBAA(162.2,",DIC(0)="AQLMZ",DLAYGO=162.2,DIC("S")="I $P(^(0),U,4)=DFN" D ^DIC K DIC("S")
	G END:X=""!(X="^"),ADD:Y<0 S FBDA=+Y,FBN=$P(Y,"^",3)
	W *7,?55,$$DATX^FBAAUTL($P(Y,"^",2))
	I FBN="",$P(Y(0),U,15)=3 W !,*7,"This notification has a status of complete.  Cannot edit.",! K FBN D END G ADD
	I FBN="" S FBCHVEN=$P(^FBAA(162.2,FBDA,0),"^",2)
	D VENDOR^FBCHREQ1:FBN I '$D(FBCHVEN) S DA=FBDA G EN^FBCHREQ1
	W ! S DIE="^FBAA(162.2,",DA=FBDA,DR="[FBCH ENTER REQUEST]" D ^DIE
	G END:'$D(DA) I FBN G:$D(Y)'=0!($G(FBOUT)) EN^FBCHREQ1
	I FBLG>0 W !,*7,"Admission overlaps another request for this patient.",! G EN^FBCHREQ1
	I FBUP W !!,?15,"REPORT OF CONTACT INFORMATION",! D ^FBCHROC
	K DIC,DIE,DLAYGO,DA,DR,DFN,FBAUT,FBBEGDT,FBFLAG,FBLG,FBOUT,FBPROG,FBVT,Z,FBN,FBSW,VAL,FBX,HY,FBUP,FBAAPN,FBDA,FBDEL,FBPER,J,VA,X,X1,X2,D,FBCHTEL,FBCHVEN,FBDATE,FBVD,FBZZ,Y,ZZZ,FBDOA
	Q
	;
LENT	;Entry point for enter/edit legal entitlement
	S DIC("S")="I $P(^(0),U,15)'=3" D ASKV G END:X="^"!(X="") S FBLENT=""
LENT1	S DFN=+$P(^FBAA(162.2,DA,0),"^",4),X=$G(^DPT(DFN,.361))
	I $P(X,"^")="" W !!,?10,"ELIGIBILITY HAS NOT BEEN DETERMINED NOR PENDING",!,?10,"CANNOT ENTER ENTITLEMENT." G END
ELIG	I $D(^DPT(DFN,.32)),$P(^(.32),"^",4)=2 W !,?4,"VETERAN HAS A DISHONORABLE DISCHARGE, " S X=$S($D(^(.321)):$P(^(.321),"^",1),1:"") W $S(X="Y":"ONLY ELIGIBLE FOR AGENT ORANGE EXAM.",1:"NOT ELIGIBLE FOR BENEFITS.")
	I "N"[$E(X) S DIR(0)="Y",DIR("A")="Do you want to continue",DIR("B")="NO" D ^DIR K DIR G END:$D(DIRUT) I 'Y D INELI G END
	W !! S DIE=DIC,DR="8;S FBLENT=X;S:FBLENT']"""" Y=0;S:FBLENT=""Y"" Y=9;11///^S X=""N"";12////^S X=DT;14;S:X'=4 Y=9;15;9////^S X=DT;10////^S X=DUZ;100////^S X=$S(FBLENT=""N"":3,1:2)" D ^DIE G END:FBLENT="N"!(FBLENT="")
	;
ASK	S DIR(0)="Y",DIR("A")="Do you want to determine Medical Entitlement now",DIR("B")="YES" D ^DIR K DIR G END:$D(DIRUT)!'Y,MENT1:Y
	Q
	;
MENT	;Entry point for enter/edit medical entitlement
	S DIC("S")="S FZ=^(0) I $P(FZ,U,9)=""Y""&($P(FZ,U,17)="""")&($S($P(FZ,U,12)="""":1,$P(FZ,U,12)=""Y"":1,1:0)) K FZ"
	D ASKV G END:X="^"!(X="")
MENT1	S FBMENT="" W !! S DIE=DIC,DR="11;S FBMENT=X;S:FBMENT']"""" Y=0;12////^S X=DT;S:FBMENT=""Y"" Y=13;14;S:X'=4 Y=13;15;13////^S X=DUZ;100////^S X=3" D ^DIE
	;
SETUP	I FBMENT="Y" S DIR(0)="Y",DIR("A")="Do you want to setup a 7078 now",DIR("B")="NO" D ^DIR K DIR G END:$D(DIRUT)!'Y,EN^FBCH78:Y
END	K DA,FBAUT,FBBEGDT,FBDA,FBOUT,FBFLAG,FBLG,FBPROG,FBVT,Z,FBADA,FBV,FBVT,FBLENT,FBDFN,FBNAME,FBSSN,FBMENT,FBX,DIC,DIE,DR,DLAYGO,D,DFN,VAL,X,Y,FBSUSP,FBUP,FBPHY,FBCHTEL,FBAAPN,FBAADT,DF,FBAUT,FBBEGDT,FBCHVEN,FBDEL,FBFLAG
	K FB,FB1,FBOUT,FBPER,FBPROG,FBSW,FBVD,VAL,D0,S,A,DIRUT,DUOUT,DTOUT,FBDOA,FBADDT
	Q
	;
ASKV	;Look-Up call by veteran for file 162.2
	W ! S DIC="^FBAA(162.2,",DIC(0)="AEQMZ",DIC("A")="Select Patient: ",D="D" D IX^DIC K DIC("A"),DIC("S"),D Q:X="^"!(X="")  G ASKV:Y<0 S (DA,FBDA)=+Y
	S FBDFN=+$P(Y(0),"^",4) I $D(^DPT(FBDFN,0)) S FBNAME=$P(^(0),"^"),FBSSN=$TR($$SSN^FBAAUTL(FBDFN),"-","") Q
	Q
	;
CHEK	;Check for another request for same pt. not completed
	S FBVT=DFN I $D(^FB7078("AC","I",FBVT)) S FB7078=$O(^FB7078("AC","I",FBVT,0)),FB7078=$S($D(^FB7078(FB7078,0)):$P(^(0),"^",1),1:"") G KILL
	Q
	;
KILL	W !!,"There is an incomplete 7078 for this patient.",!,"The reference number is "_FB7078 S DIK="^FBAA(162.2," D ^DIK S Y=0 W !!,?19,"< NEW REQUEST DELETED >" K FB7078,FBVT,DFN,DIK,DA,D,FBN Q
	;
INELI	S DIR(0)="162.2,14" D ^DIR G END:$D(DUOUT),H^XUS:$D(DTOUT)
	S FBSUSP=+Y G END:X=""!(X="^"),INELI:Y<0
	S DIE=DIC,DR="12////^S X=DT;7////^S X=DUZ;8////^S X=""N"";14////^S X=FBSUSP;S:X'=4 Y=9;15;9////^S X=DT;10////^S X=DUZ;11////^S X=""N"";100////^S X=3" D ^DIE Q
	;
OUTP	;Entry to inquire about a notification/request
	D ASKV G END:X="^"!(X="") W !! S DR="0:99" D EN^DIQ
	G OUTP

FBCHREQ1
FBCHREQ1	;AISC/DMK-FEE NOTIFICATION CONT ;31AUG90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
VENDOR	;ASK VENDOR FOR NOTIFICATION
	W ! K FBCHVEN S DIC="^FBAAV(",DIC(0)="AEQLM",DLAYGO=161.2 D ^DIC G END:X=""!(X="^"),VENDOR:Y<0 S (DA,FBCHVEN)=+Y,DIE=DIC I $P(Y,"^",3)=1 S FBVENEW=1 D NEW^FBAAVD K DIC,DIE,DA,DLAYGO Q
ASKVOK	I '$D(FBVENEW) D EN1^FBAAVD S DIR(0)="Y",DIR("A")="Is this the correct vendor",DIR("B")="YES" D ^DIR K DIR G VENDOR:$D(DIRUT)!'Y
END	K DIC,DIE,DLAYGO
	Q
TIMCK	;72 hour time check called from FBAA ENTER REQUEST template
	S X1=$P(^FBAA(162.2,DA,0),"^",1),X=$P(^(0),"^",19),HY=Y,FBSW=""
	S Y=$E(X1_"000",9,10)-$E(X_"000",9,10)*60+$E(X1_"00000",11,12)-$E(X_"00000",11,12),X2=X,X=$P(X,".",1)'=$P(X1,".",1) D ^%DTC:X S FBX=X*1440+Y
SURE	I FBX>4320 W *7,!!,"This Authorization From Date exceeds the 72 hour notification period. ",!,?8,"Do you want to continue ? No// " R X:DTIME S:X="" X="N" G HELP:X["^" D VALCK^FBAAUTL1 G SURE:'VAL I "Nn"[$E(X,1) S FBSW=1,Y=HY Q
	S Y=HY Q
HELP	W !,"Entering an '^' is not allowed.  Please answer 'Yes' or 'No'." G SURE
EN	I $D(DA),DA S FBDA(0)=DA,DIE="^FBAA(162.2,",DR=".01////@" D ^DIE
	I '$D(DA)  W *7,!?3,"...request deleted",! I $D(^FBAA(161.5,FBDA(0),0)) S DA=FBDA(0),DIK="^FBAA(161.5," D ^DIK
	K DIC,DIE,DIK,DA,X,FBDA,DR,DLAYGO,FBDATE,FBLG,FBN,FBUP,FBVT,VA D END^FBCHREQ
	Q
EDIT	;EDIT A REQUEST THAT'S NOT COMPLETE
	S DIC("S")="I $P(^(0),U,15)'=3" D ASKV^FBCHREQ K DIC("S") G Q:X=""!(X="^") S DA=+Y,FB(0)=^FBAA(162.2,DA,0),FBDOA=$P(FB(0),"^",19),FBFRDT=$P(FB(0),"^",5)
	S DIE="^FBAA(162.2,",DR="1;2;3.5;S:X=FBDOA!(X<FBFRDT) Y=""@10"";S FBDOA=X;4////^S X=FBDOA;I 1;@10;4:6;S FBCHVEN=X" D ^DIE S FBN(0)=^FBAA(162.2,DA,0)
	I FB(0)'=FBN(0) S DR="7////^S X=DUZ" D ^DIE
	I $D(DA),$D(^FBAA(161.5,DA,0)) D
	.I FB(0)'=FBN(0) S $P(^FBAA(161.5,DA,0),"^",2)=$P(FBN(0),"^",2),$P(^(0),"^",5)=$P(FBN(0),"^",5),$P(^FBAA(161.5,DA,1),"^",7)=$P(FBN(0),"^",19),$P(^(1),U)=$P(FBN(0),U,6),DIK="^FBAA(161.5," D IX^DIK K DIK
	.S FBREQED=1,DIC="^FBAA(161.5,",DIC(0)="AEQM" D EN^FBCHROC
Q	K DIE,DIC,DIRUT,DUOUT,DTOUT,X,Y,DR,FB,FBN,FBDA,FBDFN,FBNAME,FBSSN,DA,FBCHVEN,FBREQED,FBDOA,FBFRDT,J
	Q
DATCK	;Verify authorized from date is > or = date of admission.
	S FBDOA=$P(^FBAA(162.2,DA,0),"^",19) I $G(FBDOA),X<FBDOA W !,*7,"Authorized From Date must be equal to or greater than the Date of Admission" S FBOUT=1
	Q

FBCHREQ2
FBCHREQ2	;AISC/DMK-RECONSIDER A DENIED NOTIFICATION ;4/28/93  11:01
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;check if user holds 'FBAASUPERVISOR' key
	Q:'$G(DUZ)
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !,*7,"You must be a holder of the 'FBAASUPERVIVOR' key to reconsider a denied request.",! Q
	;look-up a request that has been previously denied
	S DIC("S")="S FBZ=^(0) I $P(FBZ,U,15)=3&($P(FBZ,U,9)=""N""!($P(FBZ,U,12)=""N"")) K FBZ"
	D ASKV^FBCHREQ G END:X=""!(X="^") K DIC
	;display selected request for reconsideration
	Q:'$G(DA)  W ! S DR="0:99",DIC="^FBAA(162.2," D EN^DIQ K DIC
	;ask if correct selection
	S DIR(0)="Y",DIR("A")="Is this the correct request",DIR("B")="Yes" D ^DIR K DIR G FBCHREQ2:'Y
	;continue and determine if legal or medical denial, reset fields
	S FB=$G(^FBAA(162.2,+FBDA,0)) G END:FB']""
	S FB1=$S($P(FB,"^",9)="N":1,$P(FB,"^",12)="N":2,1:"") G FBCHREQ2:'FB1
	S DIE="^FBAA(162.2,",DR="[FBCH REOPEN REQUEST]" D ^DIE K DIE,DR G FBCHREQ2:$D(DTOUT)!($D(DUOUT))
	S FBLENT="",DA=FBDA,DIC="^FBAA(162.2,"
	G @$S(FB1=1:"LENT1^FBCHREQ",FB1=2:"MENT1^FBCHREQ",1:"FBCHREQ2")
	;kill variables and exit
END	K DA,FBDA,FBNAME,FBSSN,FB,FB1,FBDFN,DIC,DIE,ZZ
	Q
DISPLAY	;display for a data range those requests that have been reconsidered
	;ask date range
	D DATE^FBAAUTL Q:FBPOP
	S FBBEG=BEGDATE-.1,FBEND=ENDDATE+.9
	I '$O(^DIA(162.2,"C",0)) W !?5,*7,"No audit data on file.",! G Q
	;check Audit file for entries
	S PGM="START^FBCHREQ2",VAR="FBBEG^FBEND^BEGDATE^ENDDATE" D ZIS^FBAAUTL G Q:FBPOP
START	;
	U IO I $E(IOST,1,2)="C-" W @IOF
	S J=0,QQ="=",$P(QQ,"=",80)="=" D HED
	F I=FBBEG:0 S I=$O(^DIA(162.2,"C",I)) Q:'I!(I>FBEND)  F  S J=$O(^(I,J)) Q:'J  S FB(1)=$G(^DIA(162.2,+J,0)),FB=$G(^FBAA(162.2,+FB(1),0)) D:FB]""
	.W !,$$NAME($P(FB,"^",4))," -",$$SSN^FBAAUTL($P(FB,"^",4),1)
	.W ?50,$$DATX^FBAAUTL($P(FB,"^"))
	.W !?5,"Field changed: ",$P(^DD(162.2,+$P(FB(1),"^",3),0),"^"),"  By: ",$P($G(^VA(200,+$P(FB(1),"^",4),0)),"^")
	.W !?10,"Date of Change: ",$$DATX^FBAAUTL($P(FB(1),"^",2))
	.I $E(IOST,1,2)="C-",$Y+4>IOSL S DIR(0)="E" D ^DIR S:'Y FBOUT=1 I Y W @IOF D HED
	.E  I $Y+4>IOSL W @IOF D HED
	I '$D(FBOUT),$E(IOST,1,2)="C-" W ! S DIR(0)="E",DIR("A")="Press RETURN to continue" D ^DIR K DIR
Q	W ! K FB,FBOUT,FBBEG,FBEND,I,J,QQ,Y,DUOUT,DIRUT,DTOUT,BEGDATE,ENDDATE
	D CLOSE^FBAAUTL Q
NAME(X)	;
	;X=DFN  returns patient name
	I $D(X),X Q $E($P($G(^DPT(X,0)),"^"),1,40)
	Q "Unknown"
HED	;
	W !?15,"AUDIT on FEE NOTIFICATION ENTITLEMENT CHANGE",!?25,$$DATX^FBAAUTL(BEGDATE)," TO ",$$DATX^FBAAUTL(ENDDATE),!?14,$E(QQ,1,46),!
	W !,"PATIENT NAME",?49,"DATE/TIME of NOTIFICATION",!?5,"FIELD CHANGED",?39,"SUPERVISOR",!,QQ,!!
	Q

FBCHRJP
FBCHRJP	;AISC/DMK/CMR-PRINT REJECTED PAYMENTS FROM PRICER ;18APR90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^FBAAI("AH")) W !,*7,"No payments rejected!",! Q
	S (VAR,VAL)="",PGM="START^FBCHRJP" D ZIS^FBAAUTL G END:FBPOP
START	K ^TMP($J,"FB") S (FBAAOUT,FBLISTC)=0,Q="",$P(Q,"=",80)="=",QQ="-",$P(QQ,"-",39)="-" U IO W:$E(IOST,1,2)["C-" @IOF D HED
	F FBA=0:0 S FBA=$O(^FBAAI("AH",FBA)) Q:FBA=""  I $D(^FBAA(161.7,FBA,0)),$P(^(0),"^",15)="Y" S FBN=+^(0) D
	.F FBI=0:0 S FBI=$O(^FBAAI("AH",FBA,FBI)) Q:FBI'>0  I $D(^FBAAI(FBI,0)),$P(^(0),"^",9)="",$D(^FBAAI(FBI,"FBREJ")) D
	..S FBSORT=1 D VET^FBCHDI,SET^FBPAY67
	S (FBVEN,FBNAME)="",(FBDT,FBI)=0 K FBIN
	F  S FBVEN=$O(^TMP($J,"FB",6,FBVEN)) Q:FBVEN=""!(FBAAOUT)  F  S FBNAME=$O(^TMP($J,"FB",6,FBVEN,FBNAME)) Q:FBNAME=""!(FBAAOUT)  F  S FBDT=$O(^TMP($J,"FB",6,FBVEN,FBNAME,FBDT)) Q:FBDT'>0!(FBAAOUT)  D
	.F  S FBI=$O(^TMP($J,"FB",6,FBVEN,FBNAME,FBDT,FBI)) Q:FBI'>0!(FBAAOUT)  D  D PRINT
	..F I=1:1:9 S FBIN(I)=$P(^TMP($J,"FB",6,FBVEN,FBNAME,FBDT,FBI),"^",I)
	..S FB7078=$P(^FB7078(+$P(^FBAAI(FBI,0),"^",5),0),"^") F I=1:1:3 S FBREJ(I)=$P(^FBAAI(FBI,"FBREJ"),"^",I)
END	K DFN,FB,FBA,FBAAOUT,FBDX,FBI,FBIN,FBLISTC,FBN,FBPROC,FBVEN,FBVID,J,K,L,PGM,Q,QQ,VA,VADM,VAL,VAR,Y,FB7078,FBPROC1,FBREJ,^TMP($J)
	D CLOSE^FBAAUTL,END^FBCHDI
	Q
PRINT	I $Y+5>IOSL,$E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+5>IOSL W @IOF D HED
	W !!,"Vendor: ",$P(FBVEN,";"),?41,"Vendor ID: ",+$P(FBVEN,";",2)
	W !,"Patient: ",$P(FBNAME,";"),?41,"Patient ID: ",$$SSN^FBAAUTL($P(FBNAME,";",2))
	W ! W:FBIN(8)["R" "*" W:FBIN(9)]"" "#" W ?3,FBIN(1),?23,FBIN(2),?33,FBIN(3),?42,FBIN(4),?49,FBIN(5),?61,FBIN(6),?72,FBIN(7)
	W !?3,"DX: ",+^TMP($J,"FB",6,FBVEN,FBNAME,FBDT,FBI,"DX")
	W !?3,"Associated 7078: ",FB7078,!?3,$S(FBREJ(1)="P":"Rejects Pending!",FBREJ(1)="C":"Rejected!",1:""),?23,"Reject Reason: ",FBREJ(2),!?3,"Old Batch #: ",FBREJ(3)
	Q
HED	W !?18,"CIVIL HOSPITAL REJECTED PAYMENT HISTORY",!?18,QQ
	W !!?3,"('*' Represents Reimbursement to Patient",?50,"'#' Represents Voided Payment)"
	W !?2,"Inv Date",?23,"Amount",?33," Amount",?42,"Susp",?49,"Invoice",?61,"From",?73,"To"
	W !?23,"Claimed",?35,"Paid",?42,"Code",?53,"Num",?61,"Date",?71,"Date",!,Q
	Q

FBCHROC
FBCHROC	;AISC/DMK-REPORT OF CONTACT FOR CONTRACT HOSPITAL ;13AUG90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(FBDA),'$D(FBVD),'$D(FBDATE),'$D(DFN),'$D(DUZ),'$D(FBADDT),'$D(FBPHY),'$D(FBDIAG) Q
	W ! K DD,DO S DIC="^FBAA(161.5,",DIC(0)="L",DLAYGO=161.5,(X,DINUM)=FBDA D FILE^DICN K DLAYGO S DA=+Y,FBDATE=$E(FBDATE,1,12)
	I '$D(^FBAA(161.5,FBDA,2,0)) S ^FBAA(161.5,FBDA,2,0)="^161.517D^^"
	S DIE=DIC,DR="[FBCH ENTER ROC]" D ^DIE K DIC,DIE
	S DA(1)=FBDA,DIC="^FBAA(161.5,"_FBDA_",2,",DIC(0)="L",DLAYGO=161.5,X=FBDATE D ^DIC K DIC Q:Y<0  S DA=+Y,DA(1)=FBDA
	S DIE="^FBAA(161.5,"_DA(1)_",2,",DR=".01////^S X=FBDATE;2////^S X=DUZ;1" D ^DIE K DIE
END	K FBVD,FBDATE,FBADDT,FBPHY,FBDIAG,DIC,DIE,DR,DA Q
	;
ADD	W !! S DIC="^FBAA(161.5,",DIC(0)="AEQM",D="D",DIC("A")="Select Veteran: " D IX^DIC K D,DIC("A") G END:X=""!(X="^")
	S FBDA=+Y
	S DIE="^FBAA(161.5,",DA=FBDA,DR="[FBCH ADD ROC]" D ^DIE
	K DIC,DIE,FBDA G ADD
	;
EDIT	W !! S DIC="^FBAA(161.5,",DIC(0)="AEQM",D="D",DIC("A")="Select Veteran: " D IX^DIC K D,DIC("A") G END:X=""!(X="^") S DA=+Y
EN	S DIE=DIC,DR="[FBCH EDIT ROC]" D ^DIE
	Q:$D(FBREQED)
	K DIC,DIE,DA,X,Y G EDIT

FBCHRR
FBCHRR	;AISC/DMK-RE-INITIATE REJECTS FROM PRICER;18APR90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DIC	S FBTYPE="B9"
	W ! S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,15)=""Y""&($P(^(0),U,17)]"""")"_$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"",1:"&($P(^(0),U,5)=DUZ)"),DIC("A")="Select Batch with Pricer Rejects: " D ^DIC
	G END:X="^"!(X=""),DIC:Y<0 S FBN=+Y,FBN(0)=Y(0)
	I '$D(^FBAAI("AH",FBN)) W !!,*7,"No items rejected for this batch!",! G DIC
DIC1	W !! S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("A")="Select New Batch Number: ",DIC("S")="I $P(^(0),U,3)=FBTYPE&($P(^(0),U,5)=DUZ)&($P(^(0),U,15)=""Y"")&($G(^(""ST""))=""O"")&($P(^(0),U,18)'[""Y"")"
	D ^DIC K DIC G DIC:$E(X)="^"!(X=""),DIC1:Y<0 S FBNB=+Y,FBNB(0)=Y(0)
DIC2	W ! S DIC="^FBAAI(",DIC(0)="AEQMZ",DIC("A")="Select Patient: ",D="D",DIC("S")="I $D(^(""FBREJ"")),$P(^(""FBREJ""),U,3)=FBN" D IX^DIC G DIC:$E(X)="^"!(X=""),DIC2:Y<0 S FBI=+Y,FBI(0)=Y(0) G END:'$D(^FBAAI(FBI,0))
	S FBLISTC="" D HOME^%ZIS,START^FBCHDI2
ASK	S DIR(0)="Y",DIR("A")="Want to re-initiate this payment",DIR("B")="NO" D ^DIR K DIR G END:$D(DIRUT),DIC:'Y
	S (DIC,DIE)="^FBAAI(",DIC(0)="AEQM",DA=FBI,DR="20////^S X=FBNB" D ^DIE
	K ^FBAAI(FBI,"FBREJ"),^FBAAI("AH",FBN,FBI) S $P(FBNB(0),"^",10)=$P(FBNB(0),"^",10)+1,$P(FBNB(0),"^",11)=$P(FBNB(0),"^",11)+1,$P(FBNB(0),"^",18)="N",^FBAA(161.7,FBNB,0)=FBNB(0)
	I '$D(^FBAAI("AH",FBN)) S $P(FBN(0),"^",17)="",^FBAA(161.7,FBN,0)=FBN(0)
	I $D(^FBAAI("AH",FBN)) G DIC2
EDIT	S DIR(0)="Y",DIR("A")="Want to edit payment now",DIR("B")="YES" D ^DIR K DIR G END:$D(DIRUT)!'Y
	S FBPRICE="",(DIC,DIE)="^FBAAI(",DA=FBI,DR="[FBCH EDIT PAYMENT]" D ^DIE G END:$D(DUOUT),H^XUS:$D(DTOUT)
END	K DIC,D,DA,DIRUT,DR,DTOUT,DUOUT,FBPRICE,VAL,DIE,FBI,FBN,FBNB,FBTYPE,I,POP,X,Y,FBLISTC D END^FBCHDI
	Q

FBCHSCB
FBCHSCB	;AISC/GRR-SUPERVISOR RELEASE ;01JAN86
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW
	I '$D(^FBAA(161.7,"AC","C")) W !!,*7,"There are no batches Pending Release!" Q
BT	W !! S DIC="^FBAA(161.7,",DIC(0)="AEQZ",DIC("S")="I $P(^(0),U,15)=""Y"",$G(^(""ST""))=""C""" D ^DIC K DIC("S") G Q:X="^"!(X=""),BT:Y<0 S FBN=+Y,FZ=Y(0),FBTYPE=$P(FZ,"^",3),FBAAON=$P(FZ,"^",2),FBAAB=$P(FZ,"^")
	I $P(FZ,"^",18)["Y" W !!,*7,"This Batch is exempt from the Pricer!!!",!,"Please use the 'Release a Batch' option to forward this batch for payment." G Q
	S DA=FBN,DR="0;ST" W !! D EN^DIQ
RD	S B=FBN S DIR(0)="Y",DIR("A")="Want line items listed",DIR("B")="NO" D ^DIR K DIR G BT:$D(DIRUT) D:Y LISTC
RDD	S DIR(0)="Y",DIR("A")="Do you want to Release Batch as Correct",DIR("B")="NO" D ^DIR K DIR G BT:$D(DIRUT) I 'Y W !!,"Batch has NOT been Released!",*7 G BT
	S $P(FZ,"^",6)=DT,$P(FZ,"^",7)=DUZ,^FBAA(161.7,FBN,0)=FZ
	S DA=FBN,(DIC,DIE)="^FBAA(161.7,",DIC(0)="LQ",DR="11////^S X=""S""",DLAYGO=161.7 D ^DIE
	S DA=FBN,DR="0;ST",DIC="^FBAA(161.7," W !! D EN^DIQ W !!," Batch has been Released!" G BT
Q	K B,J,K,L,M,X,Y,Z,DIC,FBN,A,A1,A2,BE,CPTDESC,D0,DA,DL,DR,DRX,DX,FBAACB,FBAACPT,FBAAON,FBAAOUT,FBVP,FBIN,DK,N,XY,FBINOLD,FBINTOT,FBTYPE,FZ,P3,P4,Q,S,T,V,VID,ZS,FBAAB,FBAAMT,FBAAOB,FBCOMM,FBAUT,FBSITE,I,X,Y,Z,FBERR,DIRUT,DUOUT,DTOUT
	K FBK,FBL,FBPDT,FBTD
	K DLAYGO,FBLISTC D END^FBCHDI Q
	;
LISTC	D HOME^%ZIS W @IOF
	D LISTC^FBAACCB1 Q

FBCHSL1
FBCHSL1	;AISC/DMK-PRINT SUSPENSION LETTERS CONTINUED ;16MAY90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F K=0:0 S K=$O(^FBAAI("AI",K)) Q:K'>0  I $S($G(IFN):IFN=K,1:1) S FBSW=1,FBDT=BEGDATE-.001 F ZZ=0:0 S FBDT=$O(^FBAAI("AI",K,FBDT)) D WPBOT:FBDT'>0&(FBSW=0)!(FBDT>ENDDATE)&(FBSW=0) Q:FBDT'>0!(FBDT>ENDDATE)  D MORE
	K FBCHAD,FBCHDT,FBAMTC,FBAMTP,FBAMTS Q
MORE	F J=0:0 S J=$O(^FBAAI("AI",K,FBDT,J)) Q:J'>0  I $S($G(DFN):DFN=J,1:1) D:$D(^DPT(J,0)) GOTP^FBAASLP I $D(^FBAAV(K,0)) D MID
	Q
GOTV	S Y(0)=^FBAAV(K,0),VNAM=$P(Y(0),"^",1),FBSW=0
	I VNAM["," S VNAM=$P(VNAM,",",2)_" "_$P(VNAM,",",1)
	S VST1=$P(Y(0),"^",3),VST2=$P(Y(0),"^",14),VCITY=$P(Y(0),"^",4),VSTATE=$S($D(^DIC(5,+$P(Y(0),"^",5),0)):$P(^(0),"^",2),1:"  "),VZIP=$P(Y(0),"^",6)
	W @IOF,!!!!!!!,?5,VNAM,!,?5,VST1,! I VST2]"" W ?5,VST2,!
	W ?5,VCITY,"  ",VSTATE,"  ",VZIP,!!!!
WPBEG	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	I $D(^FBAA(161.3,FBLET,1,1)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	D HED
	Q
MID	S FBA=0 F FBAA=0:0 S FBA=$O(^FBAAI("AI",K,FBDT,J,FBA)) Q:FBA=""  I $S(FBSLW=0:1,FBSLW=1&($D(FBAAS(FBA))):1,1:0) D MORE2
	Q
MORE2	F L=0:0 S L=$O(^FBAAI("AI",K,FBDT,J,FBA,L)) Q:L'>0  I $D(^FBAAI(L,0)) S Z(0)=^(0) D BOT
	Q
WPBOT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W") W !!
	I $D(^FBAA(161.3,FBLET,2)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,2,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
BOT	Q:$S($G(FBDEN):$P(Z(0),U,9)>0,1:0)  ;quit if not den (if prn den's only)
	I FBSW=1 D GOTV^FBAASLP,HED S FBSW=0,FBGOT=1
	S Y=$P(Z(0),"^",7) D PDATE^FBAAUTL S FBCHDT=FBPDT,Y=$P(Z(0),"^",6) D PDATE^FBAAUTL S FBCHAD=FBPDT,FBAMTC=$P(Z(0),"^",8),FBAMTP=$P(Z(0),"^",9),FBAMTS=$P(Z(0),"^",10)
	I $Y+4>IOSL W @IOF D HED
	W !!,PNAME,?32,PSSN,?56,FBCHAD,!,?2,FBCHDT,?23,"$ ",FBAMTC,?41,"$ ",FBAMTP,?60,"$ ",FBAMTS,!
	G:FBA=4&($D(^FBAAI(L,1,0))) WPFT
	S DIWL=1,DIWF="WC79",FBI=FBA K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAA(161.27,FBI,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
HED	W !,"PATIENT NAME",?36,"SSN",?53,"ADMISSION DATE",!,?1,"DISCHARGE DATE",?22,"AMOUNT CLAIMED",?40,"AMOUNT PAID",?59,"AMOUNT SUSPENDED",!,"   REASON FOR SUSPENSION",!,UL,! Q
GOTP	S Y(0)=^DPT(J,0),PNAME=$$NAME^FBCHREQ2(J),PSSN=$TR($$SSN^FBAAUTL(J),"-","")
	I PNAME["," S PNAME=$P(PNAME,",",2)_" "_$P(PNAME,",",1)
	Q
WPFT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAAI(L,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
HELP	W !,"Answer 'Yes' to print suspension letters for all suspension",!,"codes, otherwise answer 'No' to select specific codes." G RDCODE^FBAASLP

FBCHSLP
FBCHSLP	;AISC/DMK-PRINT SUSPENSION LETTERS CONTINUED ;16MAY90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F K=0:0 S K=$O(^FBAA(162.2,"AI",K)) Q:K'>0  I $S($G(IFN):IFN=K,1:1) S FBSW=1,FBDT=BEGDATE-.001 F ZZ=0:0 S FBDT=$O(^FBAA(162.2,"AI",K,FBDT)) D WPBOT:FBDT'>0&(FBSW=0)!(FBDT>ENDDATE)&(FBSW=0) Q:FBDT'>0!(FBDT>ENDDATE)  D MORE
	K FBCHAD,FBCHDT,FBCHPHY Q
MORE	F J=0:0 S J=$O(^FBAA(162.2,"AI",K,FBDT,J)) Q:J'>0  I $S($G(DFN):DFN=J,1:1) D:$D(^DPT(J,0)) GOTP^FBAASLP I $D(^FBAAV(K,0)) D MID
	Q
GOTV	S Y(0)=^FBAAV(K,0),VNAM=$P(Y(0),"^",1),FBSW=0
	I VNAM["," S VNAM=$P(VNAM,",",2)_" "_$P(VNAM,",",1)
	S VST1=$P(Y(0),"^",3),VST2=$P(Y(0),"^",14),VCITY=$P(Y(0),"^",4),VSTATE=$S($D(^DIC(5,+$P(Y(0),"^",5),0)):$P(^(0),"^",2),1:"  "),VZIP=$P(Y(0),"^",6)
	W @IOF,!!!!!!!,?5,VNAM,!,?5,VST1,! I VST2]"" W ?5,VST2,!
	W ?5,VCITY,"  ",VSTATE,"  ",VZIP,!!!!
WPBEG	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	I $D(^FBAA(161.3,FBLET,1,1)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	D HED
	Q
MID	S FBA=0 F FBAA=0:0 S FBA=$O(^FBAA(162.2,"AI",K,FBDT,J,FBA)) Q:FBA=""  I $S(FBSLW=0:1,FBSLW=1&($D(FBAAS(FBA))):1,1:0) D MORE2
	Q
MORE2	F L=0:0 S L=$O(^FBAA(162.2,"AI",K,FBDT,J,FBA,L)) Q:L'>0  I $D(^FBAA(162.2,L,0)) S Z(0)=^(0) D BOT
	Q
WPBOT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W") W !!
	I $D(^FBAA(161.3,FBLET,2)) F FBRR=0:0 S FBRR=$O(^FBAA(161.3,FBLET,2,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
BOT	I FBSW=1 D GOTV^FBAASLP,HED S FBSW=0,FBGOT=1
	S Y=$P($P(Z(0),"^"),".") D PDATE^FBAAUTL S FBCHDT=FBPDT,Y=$P($P(Z(0),"^",5),".") D PDATE^FBAAUTL S FBCHAD=FBPDT,FBCHPHY=$P(Z(0),"^",7)
	D GOTPHY
	I $Y+4>IOSL W @IOF D HED
	W !!,PNAME,?32,PSSN,?56,FBCHDT,!,?18,FBCHAD,?46,FBCHPHY,!
	G:FBA=4&($D(^FBAA(162.2,L,1,0))) WPFT
	S DIWL=1,DIWF="WC79",FBI=FBA K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAA(161.27,FBI,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
HED	W !,"PATIENT NAME",?36,"SSN",?53,"NOTIFICATION DATE",!,?15,"ADMISSION DATE",?43,"ATTENDING PHYSICIAN",!,"   REASON FOR SUSPENSION",!,UL,! Q
GOTP	S Y(0)=^DPT(J,0),PNAME=$$NAME^FBCHREQ2(J),PSSN=$TR($$SSN^FBAAUTL(J),"-","")
	I PNAME["," S PNAME=$P(PNAME,",",2)_" "_$P(PNAME,",",1)
	Q
WPFT	S DIWL=1,DIWF="WC79" K ^UTILITY($J,"W")
	F FBRR=0:0 S FBRR=$O(^FBAA(162.2,L,1,FBRR)) Q:FBRR'>0  S FBXX=^(FBRR,0),X=FBXX D ^DIWP
	D ^DIWW:$D(FBXX) K FBXX
	Q
HELP	W !,"Answer 'Yes' to print suspension letters for all suspension",!,"codes, otherwise answer 'No' to select specific codes." G RDCODE^FBAASLP
GOTPHY	S FBCHPHY=$S(FBCHPHY="":"Unknown",1:FBCHPHY)
	I FBCHPHY["," S FBCHPHY=$P(FBCHPHY,",",2)_" "_$P(FBCHPHY,",")
	Q

FBCHSTA
FBCHSTA	;AISC/DMK-DISPLAYS PENDING INPATIENT DISPOSITIONS ;13DEC88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D HOME^%ZIS,^FBAASTA S DIR(0)="E" D ^DIR K DIR Q:'Y  W @IOF
EN	D DT^DICRW S FBDT=DT,FBSW=1,CNT=0
	S Q="-",$P(Q,"-",80)="-" D HED
	F I=FBDT:0 S I=$O(^FB7078("AD",6,I)) Q:I'>0  F J=0:0 S J=$O(^FB7078("AD",6,I,J)) Q:J'>0  D TRANS
STAT1	I $D(^FB7078("AC","I")) F I=0:0 S I=$O(^FB7078("AC","I",I)) Q:I'>0  F J=0:0 S J=$O(^FB7078("AC","I",I,J)) Q:J'>0  D TRANS
END	W:CNT'>0 !,$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):"There are ",1:"You have "),"no inpatients pending disposition." K CNT,FBAD,FBDT,FBDUZ,FBTYPE,FBVEN,FBVET,I,J,POP,Q,Y,FBFLG Q
TRANS	S Y(0)=^FB7078(J,0) Q:$P(Y(0),"^",9)="DC"
	S FBVET=$P(Y(0),"^",3),FBVEN=$P(Y(0),"^",2),FBVEN=$P(FBVEN,";"),FBAD=$P(Y(0),"^",4),FBDUZ=$P(Y(0),"^",8),FBTYPE=$P(Y(0),"^",11)
	Q:FBTYPE'=6
	Q:DUZ'=FBDUZ&('$D(^XUSEC("FBAASUPERVISOR",DUZ)))
	S FBVET=$P(^DPT(FBVET,0),"^",1),FBVEN=$S($D(^FBAAV(FBVEN)):$P(^FBAAV(FBVEN,0),"^",1),1:"UNKNOWN")
	S X1=FBDT,X2=FBAD D D^%DTC
	S FBFLG=$S(X>10:"++",1:""),Y=FBAD D PDF^FBAAUTL S FBAD=Y
	W !,FBFLG,?5,FBVET,?35,FBVEN,?65,FBAD
	S CNT=CNT+1 Q
HED	;S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP W @IOF
	W !,?29,"PENDING 7078's",!,?21,"('++' indicates LOS > 10 days)",!,"Veteran",?35,"Vendor",?65,"Admission Date",!,Q Q

FBCHSTAT
FBCHSTAT	;AISC/DMK-REQUEST STATS ;04MAY90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	D DATE^FBAAUTL G END:FBPOP S FBFRDT=BEGDATE,FBTODT=ENDDATE+.99999
	S VAR="FBFRDT^FBTODT",VAL=FBFRDT_"^"_FBTODT,PGM="START^FBCHSTAT" D ZIS^FBAAUTL G END:FBPOP
START	U IO W:$E(IOST,1,2)="C-" @IOF S (FBTOT,FBINEL,FBAAOUT,FBPCNT)=0,FB(1)="" D HED
	F I=FBFRDT:0 S I=$O(^FBAA(162.2,"B",I)) Q:I'>0!(I>FBTODT)!(FBAAOUT)  F J=0:0 S J=$O(^FBAA(162.2,"B",I,J)) Q:J'>0!(FBAAOUT)  I $D(^FBAA(162.2,J,0)) S FB(0)=^(0) D GET
	W:'FBAAOUT !!,"Total Requests: ",FBTOT,!,"# of Requests Denied: ",FBINEL,!,"# of Requests Pending: ",FBPCNT
END	K ENDDATE,FB,FBPCNT,FBAAOUT,FBDATE,FBFRDT,FBTODT,FBINEL,FBTOT,FBVEN,FBVET,I,J,Q,QQ,X,Y D CLOSE^FBAAUTL Q
GET	Q:'$P(FB(0),U,4)  S FBVET=+$P(FB(0),"^",4),FBVET=$P($G(^DPT(FBVET,0)),U) S:FBVET']"" FBVET="UNKNOWN" S FBVEN=+$P(FB(0),"^",2),FBVEN=$P($G(^FBAAV(FBVEN,0)),U),FBVEN=$S(FBVEN]"":$E(FBVEN,1,35),1:"UNKNOWN")
	S FBTOT=FBTOT+1,FBINEL=FBINEL+$S($P(FB(0),"^",9)="N":1,$P(FB(0),"^",12)="N":1,1:0),FB(1)=""
	I $P(FB(0),"^",9)="N" S FB(1)="!"
	I $P(FB(0),"^",12)="N" S FB(1)="!"
	S Y=$P(FB(0),"^",5) X ^DD("DD") S FBDATE=$P(Y,"@")
	I $P(FB(0),"^",15)'=3 S FBPCNT=FBPCNT+1,FB(1)="+"
	W !,FB(1),?3,FBVET,?32,FBVEN,?69,FBDATE
	I $Y+4>IOSL,$E(IOST)="C" D HANG^FBAAUTL1 Q:FBAAOUT  W @IOF D HED
	E  I $Y+4>IOSL W @IOF D HED
	Q
HED	S Q="",$P(Q,"=",80)="=",QQ="",$P(QQ,"-",38)="-"
	W !,?16,"CONTRACT HOSPITAL REQUEST STATISTICS",!,?15,QQ,!,?22,"('+' Request Pending)",!,?22,"('!' Request Denied)",!
	W ?1,"VETERAN",?32,"VENDOR",?69,"ADMISSION",!,Q,!!
	Q

FBCHVH
FBCHVH	;AISC/DMK-VENDOR PAYMENT HISTORY ;02FEB89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
GETVEN	K FBAANQ D GETVEN^FBAAUTL1 G END:IFN']""
	D DATE^FBAAUTL G:FBPOP GETVEN S ZZ=9999999.9999,FBBEG=ZZ-ENDDATE,FBEND=ZZ-BEGDATE
	I '$D(^FBAAI("AF",IFN)) W !,*7,"No invoices on line for this vendor." G GETVEN
	S VAR="IFN^FBBEG^FBEND^BEGDATE^ENDDATE"_$S($D(FBPROG):"^FBPROG",1:""),VAL=IFN_"^"_FBBEG_"^"_FBEND_"^"_BEGDATE_"^"_ENDDATE_$S($D(FBPROG):"^"_FBPROG,1:""),PGM="START^FBCHVH" D ZIS^FBAAUTL G:FBPOP END S:IO=IO(0) FBAANQ=1
START	S:'$D(FBPROG) FBPROG=6 S FBHEAD="VENDOR",Q="",$P(Q,"=",80)="=",FBAAOUT=0 U IO D GETDAT S:$E(IOST,1,2)'["C-" FBPG=1 D HEDC
	F FBM=FBBEG-.1:0 S FBM=$O(^FBAAI("AF",IFN,FBM)) Q:FBM'>0!(FBM>FBEND)  F FBI=0:0 S FBI=$O(^FBAAI("AF",IFN,FBM,FBI)) Q:FBI'>0!(FBAAOUT)  I $D(^FBAAI(FBI,0)),$P(^(0),"^",12)=FBPROG,'$D(^("FBREJ")) D GETINV
	G:$D(FBAANQ) GETVEN
END	K DA,DFN,BEGDATE,ENDDATE,FBBEG,FBEND,DIC,FBAANQ,FBAAOUT,FBDX,FBI,FBIN,FBPROC,FBVEN,FBVID,IFN,J,K,L,PGM,Q,VADM,VAERR,VAL,VAR,X,Y,VA,ZZ,FBM,FBHEAD,FBPROG,FBPG,FBVINDT
	D CLOSE^FBAAUTL Q
GETINV	S FBIN=^FBAAI(FBI,0) F J=1,2,3,4,6,7,8,9,11,13,14 S FBIN(J)=$P(FBIN,"^",J)
	S FBVINDT=$P($G(^FBAAI(+FBI,2)),"^",2) D FBCKI^FBAACCB1(FBI)
	S FBVEN=$S($D(^FBAAV(+FBIN(3),0)):$P(^(0),"^",1),1:"") I FBVEN]"" S FBVID=$P(^(0),"^",2)
	S DFN=FBIN(4) Q:'DFN  D DEM^VADPT
	S Y=FBIN(2) D CDAT S FBIN(2)=Y
	S Y=FBIN(6) D CDAT S FBIN(6)=Y,Y=FBIN(7) D CDAT S FBIN(7)=Y
WRT	I $Y+6>IOSL D HANG^FBAAUTL1:$E(IOST,1,2)["C-" Q:FBAAOUT  D HEDC
	W !,$S('$D(FBIN(13)):"",FBIN(13)="R":"*",1:""),$S($G(FBCAN)]"":"+",1:"")
	W VADM(1)_"  "_$P(VADM(2),"^",2),!,?4,FBVEN,?45,FBVID,?62,FBIN(1),!,$S(FBIN(13)["R":"*",1:""),$S(FBIN(14)]"":"#",1:""),?4,FBIN(6),?14,FBIN(7),?24,$J(FBIN(8),1,2),?33,$J(FBIN(9),1,2),?43,FBIN(11),?59,FBIN(2),?69,$$DATX^FBAAUTL(FBVINDT),!
	I $D(^FBAAI(FBI,"DX")) S FBDX=^("DX") F K=1:1:5 D WRTDX
	I $D(^FBAAI(FBI,"PROC")) S FBPROC=^("PROC") W ! F L=1:1:5 D WRTPC
	N A2 S A2=FBIN(9) D PMNT^FBAACCB2
	Q
WRTDX	I $P(FBDX,"^",K)]"" W ?4,"Dx: ",$S($D(^ICD9(+$P(FBDX,"^",K),0)):$P(^(0),"^"),1:""),"  " Q
	Q
WRTPC	I $P(FBPROC,"^",L)]"" W ?4,"Proc: ",$S($D(^ICD0(+$P(FBPROC,"^",L),0)):$P(^(0),"^"),1:""),"   " Q
	Q
HEDC	I $D(FBHEAD) W:'$G(FBPG) @IOF K:$G(FBPG) FBPG W ?25,FBHEAD_" PAYMENT HISTORY",!,?24,$E(Q,1,24),!?48,"Date Range: ",BEGDATE_" to "_ENDDATE
	I '$D(FBHEAD) W:'$G(FBPG) @IOF K:$G(FBPG) FBPG W !?32,"INVOICE DISPLAY",!,?31,$E(Q,1,17),!
	W !,"Veteran's Name",?17,"('*'Reimbursement to Veteran   '+' Cancellation Activity)",!,?17,"('#' Voided Payment)"
	W !,?3,"Vendor Name",?45,"Vendor ID",?59,"Invoice #",!,?3,"Fr Date",?14,"To Date  Claimed   Paid",?41,"Sus Code",?59,"Dt. Rec.",?69,"Inv. Date",!,Q,!
	Q
CDAT	S Y=$E(Y,4,5)_"/"_$S($E(Y,6,7)="00":$E(Y,2,3),1:$E(Y,6,7)_"/"_$E(Y,2,3)) Q
GETDAT	S Y=BEGDATE D PDF^FBAAUTL S BEGDATE=Y,Y=ENDDATE D PDF^FBAAUTL S ENDDATE=Y
	Q

FBCHVP
FBCHVP	;AISC/CMR-VOID & CANCEL VOIDED INPATIENT PAYMENT ;3/3/93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;Variable 'FBVOID' is set if cancelling a voided payment.
	;Variable 'FBTYPE' is set to 6 for CH or 7 for CNH.
	D DT^DICRW
	I '$D(^XUSEC("FBAASUPERVISOR",DUZ)) W !!,*7,"Sorry, you must be a supervisor to use this option.",! Q
RDP	;Get veteran if they have an inpatient invoice (DFN).
	K ^TMP($J) W !! S DIC=161,DIC(0)="AEMZ",DIC("S")="I $D(^FBAAI(""AK"",+Y))" D ^DIC K DIC G Q:X=""!($D(DTOUT))!($D(DUOUT)),RDP:Y<0 S DFN=+Y
RDV	;Get vendor if an inpatient provider for this patient (FBV).
	W !! S DIC=161.2,DIC(0)="AEMZ",DIC("S")="I $D(^FBAAI(""AK"",DFN,+Y))" D ^DIC K DIC G Q:X=""!($D(DTOUT))!($D(DUOUT)),RDV:Y<0 S FBV=+Y
	D EN1
	I FBCTR=0 W !!?12,*7,"Vendor has no",$S($D(FBVOID):" VOIDED",1:"")," finalized payments ",$S('$D(FBVOID):"to VOID",1:""),!?12,"for this patient under the ",$S(FBTYPE=6:"CIVIL HOSPITAL",1:"COMMUNITY NURSING HOME")," program." G RDV
	W !!,"Which payment item(s) would you like to ",$S($D(FBVOID):"Cancel the void on",1:"Void")," ? " S DIR(0)="L^1:"_FBCTR D ^DIR G RDV:$D(DIRUT) S FBX=Y W @IOF D HED
	F A=1:1:FBCTR S X=$P(FBX,",",A) Q:X=""  S FBI=+FBI(X),FBINV=^TMP($J,"FBCHVP",FBI),FBVD=$P(FBINV,"^",14) W ! D WRT1 S ^TMP($J,"FBCHVP","VOID",FBI)=""
	W ! S DIR(0)="Y",DIR("A")="Are you sure you want to "_$S($D(FBVOID):"Cancel the void on",1:"Void")_" the payment(s)",DIR("B")="No" D ^DIR K DIR G RDP:$D(DIRUT)!'Y
	S FBI=0 F  S FBI=$O(^TMP($J,"FBCHVP","VOID",FBI)) Q:FBI'>0  D SETR,CONF W !,?5,".... Done.",!
Q	K DFN,FBV,FBI,FBTYPE,FBVOID,FBCTR,FBAMTC,FBAMTP,FBBAT,FBDRG,FBFDT,FBINV,FBNUM,FBREIM,FBTDT,FBVD,Q,FBX,VP,^TMP($J,"FBCHVP"),Y,DIE,DR,FBVR,DA
	Q
EN1	;Find finalized payments that match FBTYPE and store in ^TMP.
	S (FBI,FBCTR)=0,Q="-",$P(Q,"-",80)="-"
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
	F  S FBI=$O(^FBAAI("AK",DFN,FBV,FBI)) Q:FBI'>0  I $D(^FBAAI(FBI,0)),'$D(^("FBREJ")) S FBINV=^(0),FBVD=$P(FBINV,"^",14) I $P(FBINV,"^",16)'=""&($P(FBINV,"^",12)=FBTYPE)&($S($D(FBVOID):(FBVD="VP"),1:(FBVD=""))) D WRT
	Q
WRT	S ^TMP($J,"FBCHVP",FBI)=FBINV
	I FBCTR=0!($Y+5>IOSL) W @IOF D HED
	S FBCTR=FBCTR+1,FBI(FBCTR)=FBI
	W !,FBCTR_") " D WRT1 I $D(FBVOID)&($D(^FBAAI(FBI,"R"))) W !?3,"Reason:",!?10,^("R"),!
	Q
WRT1	S FBREIM=$P(FBINV,"^",13),FBFDT=$P(FBINV,"^",6),FBTDT=$P(FBINV,"^",7),FBDRG=$P(FBINV,"^",24),FBAMTC=$P(FBINV,"^",8),FBAMTP=$P(FBINV,"^",9),FBNUM=+FBINV,FBBAT=$P(FBINV,"^",17)
	D FBCKI^FBAACCB1(FBI)
	W $S(FBREIM="R":"*",1:""),$S(FBVD="VP":"#",1:""),?3,$$DATX^FBAAUTL(FBFDT),?16,$$DATX^FBAAUTL(FBTDT)
	W ?26,$S($G(FBDRG):$J($P(^ICD(FBDRG,0),"^"),4),1:""),?35,$J($FN(FBAMTC,",",2),8),?48,$J($FN(FBAMTP,",",2),8),?62,$J(FBNUM,5),?72,$J($P($G(^FBAA(161.7,+FBBAT,0)),"^"),6)
	N A2 S A2=+FBAMTP D PMNT^FBAACCB2
	Q
HED	W !,"Patient Name: ",$P(^DPT(DFN,0),"^"),?50,"Pt.ID ",$$SSN^FBAAUTL(DFN),!!,?2,"VENDOR: ",$P(^FBAAV(FBV,0),"^"),!,?10,"('*' Represents Reimbursement to Patient)",!,?10,"('#' Represents a Voided Payment)"
	W !,"   FROM DATE",?16,"TO DATE",?26,"DRG",?33,"AMT CLAIMED",?48,"AMT PAID",?60,"INVOICE #",?72,"BATCH #",!,Q,!
	Q
SETR	;Set/delete void node on record.
	S DA=FBI,VP=$S($D(FBVOID):"",1:"VOID")
	I $D(FBVOID) S DR="16///@;16.5///@;17///@"
	I '$D(FBVOID) S DR="16///^S X=VP;17////^S X=DUZ"_$S($D(FBVR):";16.5////^S X=FBVR",1:";16.5R;S FBVR=X")
	S DIE="^FBAAI(",DIDEL=162.5 D ^DIE K DIDEL
	Q
CONF	;Print void/cancel void confirmation.
	W !,?10,$S($D(FBVOID):"Cancel Voided",1:"Void")," payment for ",$$NAME^FBCHREQ2(DFN),!,*7,"You must adjust control point accordingly through IFCAP!"
	Q

FBCKDIS
FBCKDIS	;AISC/CMR - OUTPUT BY CHECK # ;20APR94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;FBCN=Check Number               FBPROG=Fee payment type
	;FBPR is set if called from the phone menu.  If this variable exists,
	;     the user will not be returned to the TOP to select another ck #.
TOP	W ! S DIR(0)="FO^1:8",DIR("A")="Select Check Number" D ^DIR K DIR Q:Y=""!(Y="^")  S FBCN=Y
	I '$D(^FBAAC("ACK",FBCN)),('$D(^FBAAC("ACKT",FBCN))),('$D(^FBAAI("ACK",FBCN))),('$D(^FBAA(162.1,"ACK",FBCN))) W !!,*7,"There is no record of that check number." G TOP
	S VAR="FBCN",VAL=FBCN,PGM="START^FBCKDIS" D ZIS^FBAAUTL G END:FBPOP
START	S Q="-",$P(Q,"-",80)="-",QQ="=",$P(QQ,"=",80)="=",FBPG=1 K ^TMP($J,"FBCK")
	N FBV,DFN D ^FBCKDIS1
	U IO W:$E(IOST,1,2)["C-" @IOF
	F FBPROG="OPT","CH","CNH","PHAR","TRAV" I $D(^TMP($J,"FBCK",FBPROG)) D PGCHK D  Q:$G(FBAAOUT)
	.S FBV=0 F  S FBV=$O(^TMP($J,"FBCK",FBPROG,FBV)) Q:FBV']""!($G(FBAAOUT))  W:FBPROG'="TRAV" !!,"VENDOR:  ",$$VNAME^FBNHEXP(FBV),?40,"  VENDOR ID:  ",$$VID^FBNHEXP(FBV) D
	..S DFN=0 F  S DFN=$O(^TMP($J,"FBCK",FBPROG,FBV,DFN)) Q:'DFN!($G(FBAAOUT))  D:$Y+8>IOSL PGCHK Q:$G(FBAAOUT)  W !!,"Patient:  ",$$NAME^FBCHREQ2(DFN),?40,"Patient ID:  ",$$SSN^FBAAUTL(DFN) D
	...S FBCNT=0 F  S FBCNT=$O(^TMP($J,"FBCK",FBPROG,FBV,DFN,FBCNT)) Q:'FBCNT!($G(FBAAOUT))  S FBDA=^(FBCNT) D @FBPROG,OUTPUT,CLEAN
END	K FBCN,FBCNT,DFN,FBV,FBPROG,FBPG,DIRUT,DTOUT,DUOUT,Q,QQ,^TMP($J,"FBCK")
	D CLOSE^FBAAUTL
	I $G(FBAAOUT) K FBAAOUT Q
	Q:$G(FBPR)]""!($G(ZTQUEUED))
	W !! S DIR(0)="E" D ^DIR K DIR Q:'Y  G TOP
OPT	;gather payment line item for outpatient
	F I=1:1:4 S FB(I)=+$P(FBDA,U,I)
	S FBA=^FBAAC(FB(1),1,FB(2),1,FB(3),1,FB(4),0),FBB=^(2),FBDOS=+^FBAAC(FB(1),1,FB(2),1,FB(3),0),FBSRV=$P(^ICPT(+FBA,0),U),FBMOD=$$MOD^FBAAUTL4($P(FBB,U,7)),FBSRV=FBSRV_$S($G(FBMOD)]"":"-"_FBMOD,1:""),FBAMCL=$P(FBA,U,2),FBAMPD=$P(FBA,U,3)
	S FBSUSP=$P(FBA,U,5) D SUSP^FBCKDIS1
	S FBVP=$P(FBA,U,21),FBREIM=$P(FBA,U,20),FBBAT=$P(FBA,U,8),FBINV=$P(FBA,U,16)
	D FBCKO^FBAACCB2(FB(1),FB(2),FB(3),FB(4))
	Q
CH	;gather payment line item for ch
CNH	;gather payment line item for cnh
	S FBA=^FBAAI(FBDA,0),FBB=^(2),FBDOS=$P(FBA,U,6)_"-"_$P(FBA,U,7),FBAMCL=$P(FBA,U,8),FBAMPD=$P(FBA,U,9),FBSUSP=$P(FBA,U,11) D SUSP^FBCKDIS1
	S FBVP=$P(FBA,U,14),FBREIM=$P(FBA,U,13),FBBAT=$P(FBA,U,17),FBINV=+FBA
	D FBCKI^FBAACCB1(FBDA)
	Q
PHAR	;gather payment line item for pharmacy
	F I=1,2 S FB(I)=$P(FBDA,U,I)
	S FBA=^FBAA(162.1,FB(1),"RX",FB(2),0),FBB=^(2),FBDOS=$P(FBA,U,3),FBSRV=$P(FBA,"^"),FBAMCL=$P(FBA,U,4),FBAMPD=$P(FBA,U,16),FBSUSP=$P(FBA,U,8) D SUSP^FBCKDIS1
	S FBVP=$P(FBB,U,3),FBREIM=$P(FBA,U,20),FBBAT=$P($G(FBA),U,17),FBINV=+$G(^FBAA(162.1,FB(1),0))
	D FBCKP^FBAACCB1(FB(1),FB(2))
	Q
TRAV	;gather payment line item for travel
	F I=1,2 S FB(I)=$P(FBDA,U,I)
	S FBA=^FBAAC(FB(1),3,FB(2),0),FBDOS=+FBA,FBAMCL=$P(FBA,U,3),FBAMPD=FBAMCL,FBVP="",FBREIM="R",FBBAT=$P(FBA,U,2),FBINV=""
	D FBCKT^FBAACCB0(FB(1),FB(2))
	Q
CLEAN	;clean up variables
	K I,FB,FBA,FBB,FBDOS,FBSRV,FBMOD,FBAMCL,FBAMPD,FBSUSP,FBVP,FBREIM,FBBAT,FBINV,FBDA
	Q
OUTPUT	;display line items for check number
	I $Y+5>IOSL D PGCHK Q:$G(FBAAOUT)
	W ! W:FBVP="VP" "#" W:FBREIM="R" "*" W:FBCAN]"" "+" D
	.I FBPROG["C" W ?3,$$DATX^FBAAUTL($P(FBDOS,"-")),?12,$$DATX^FBAAUTL($P(FBDOS,"-",2)),?22,$J($FN(FBAMCL,",",2),10),?33,$J($FN(FBAMPD,",",2),10),?47,FBSUSP,?57,+$G(^FBAA(161.7,+FBBAT,0)),?69,FBINV Q
	.W ?3,$$DATX^FBAAUTL(FBDOS) W:FBPROG'="TRAV" ?13,FBSRV W ?20,$J($FN(FBAMCL,",",2),10),?32,$J($FN(FBAMPD,",",2),10) W:FBPROG'="TRAV" ?47,FBSUSP W ?53,+$G(^FBAA(161.7,+FBBAT,0)),?65,FBINV Q
	S A2=FBAMPD D PMNT^FBAACCB2 K A2
	Q
HED	W !?20,"PAYMENT HISTORY FOR CHECK # ",FBCN,!,?20,$E(Q,1,(28+$L(FBCN))),?70,"Page: ",FBPG
	W !!,?22,"FEE PROGRAM:  ",$S(FBPROG="OPT":"OUTPATIENT",FBPROG="CH":"CIVIL HOSPITAL",FBPROG="CNH":"COMMUNITY NURSING HOME",FBPROG="PHAR":"PHARMACY",FBPROG="TRAV":"TRAVEL",1:"")
	W !?1,"('*' Reimbursement to Patient  '#' Voided Payment  '+' Cancellation Activity)"
	I FBPROG["C" W !?3,"From",?12,"To",?23,"Amount",?34,"Amount",?43,"Susp",?55,"Batch",?67,"Invoice",!?3,"Date",?12,"Date",?23,"Claimed",?35,"Paid",?43,"Code",?55,"Number",?67,"Number",!,QQ Q
	I FBPROG="TRAV" W !?3,"Travel Dt",?21,"Amount",?33,"Amount",?50,"Batch",?62,"Invoice",!,?21,"Claimed",?34,"Paid",?50,"Number",?62,"Number",!,QQ Q
	W !?3,$S(FBPROG="OPT":"Svc Date",1:"Fill Dt"),?13,$S(FBPROG="OPT":"CPT-",1:"RX #"),?21,"Amount",?33,"Amount",?44,"Susp",?50,"Batch",?62,"Invoice",!?13,$S(FBPROG="OPT":"MOD",1:""),?21,"Claimed",?34,"Paid"
	W ?44,"Code",?50,"Number",?62,"Number",!,QQ Q
	Q
PGCHK	I FBPG>1,($E(IOST,1,2)["C-") W !! S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	W:FBPG>1 @IOF D HED
	S FBPG=FBPG+1 Q

FBCKDIS1
FBCKDIS1	;AISC/CMR - OUTPUT BY CHECK # cont. ;20APR94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D OPT,INPT,PHARM,TRAV
	Q
OPT	;find outpatient payments for check #
	Q:'$D(^FBAAC("ACK",FBCN))
	S FBPROG="OPT",FBCNT=0
	S FB1=0 F  S FB1=$O(^FBAAC("ACK",FBCN,FB1)) Q:'FB1  S FB2=0 F  S FB2=$O(^FBAAC("ACK",FBCN,FB1,FB2)) Q:'FB2  S FB3=0 F  S FB3=$O(^FBAAC("ACK",FBCN,FB1,FB2,FB3)) Q:'FB3  S FB4=0 F  S FB4=$O(^FBAAC("ACK",FBCN,FB1,FB2,FB3,FB4)) Q:'FB4  D
	.Q:$S('$D(^FBAAC(FB1,1,FB2,1,FB3,1,FB4,0)):1,'$D(^FBAAC(FB1,1,FB2,1,FB3,1,FB4,2)):1,'$D(^FBAAC(FB1,1,FB2,1,FB3,0)):1,1:0)
	.S FBCNT=FBCNT+1,FBDA=FB1_"^"_FB2_"^"_FB3_"^"_FB4,DFN=FB1,FBV=FB2
	.D SETMP
	D CLN Q
INPT	;find inpatient payments for check #
	Q:'$D(^FBAAI("ACK",FBCN))
	S (FBCNTCH,FBCNTCNH)=0
	S FB1=0 F  S FB1=$O(^FBAAI("ACK",FBCN,FB1)) Q:'FB1  D
	.Q:$S('$D(^FBAAI(FB1,0)):1,'$D(^FBAAI(FB1,2)):1,1:0)
	.S FBA=^FBAAI(FB1,0),DFN=$P(FBA,U,4),FBV=$P(FBA,U,3)
	.S FBPROG=$S($P(FBA,U,12)=6:"CH",$P(FBA,U,12)=7:"CNH",1:"") Q:FBPROG']""
	.I FBPROG="CH" S FBCNTCH=FBCNTCH+1,FBCNT=FBCNTCH
	.I FBPROG="CNH" S FBCNTCNH=FBCNTCNH+1,FBCNT=FBCNTCNH
	.S FBDA=FB1
	.D SETMP
	D CLN Q
PHARM	;find pharmacy payments for check #
	Q:'$D(^FBAA(162.1,"ACK",FBCN))
	S FBCNT=0,FBPROG="PHAR"
	S FB1=0 F  S FB1=$O(^FBAA(162.1,"ACK",FBCN,FB1)) Q:'FB1  S FB2=0 F  S FB2=$O(^FBAA(162.1,"ACK",FBCN,FB1,FB2)) Q:'FB2  D
	.Q:$S('$D(^FBAA(162.1,FB1,"RX",FB2,0)):1,'$D(^FBAA(162.1,FB1,"RX",FB2,2)):1,'$D(^FBAA(162.1,FB1,0)):1,1:0)
	.S FBCNT=FBCNT+1
	.S FBA=^FBAA(162.1,FB1,"RX",FB2,0),DFN=$P(FBA,U,5),FBV=$P(^FBAA(162.1,FB1,0),U,4)
	.S FBDA=FB1_"^"_FB2
	.D SETMP
	D CLN Q
TRAV	;find travel payments for check #
	Q:'$D(^FBAAC("ACKT",FBCN))
	S FBCNT=0,FBPROG="TRAV"
	S FB1=0 F  S FB1=$O(^FBAAC("ACKT",FBCN,FB1)) Q:'FB1  S FB2=0 F  S FB2=$O(^FBAAC("ACKT",FBCN,FB1,FB2)) Q:'FB2  D
	.Q:'$D(^FBAAC(FB1,3,FB2,0))
	.S FBCNT=FBCNT+1
	.S DFN=FB1,FBV="R"
	.S FBDA=FB1_"^"_FB2
	.D SETMP
	D CLN Q
SETMP	;set up tmp global
	S ^TMP($J,"FBCK",FBPROG,FBV,DFN,FBCNT)=FBDA
	Q
CLN	K FB1,FB2,FB3,FB4,FBA,FBCNT,DFN,FBCNTCH,FBCNTCNH,FBPROG Q
SUSP	;get suspense code
	S FBSUSP=$S(FBSUSP="":"",$D(^FBAA(161.27,FBSUSP,0)):^FBAA(161.27,FBSUSP,0),1:"")
	Q

FBCNHCEN
FBCNHCEN	;AISC/CMR-CNH/CH CENSUS DATA ;4/28/93  11:02
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;FBI is set in option entry action, 6=CH, 7=CNH
	I $G(FBI)'=6&($G(FBI)'=7) W "Inpatient type is not identified." Q
	W !!,"****CENSUS DATE SELECTION****"
	W ! S %DT="APEX",%DT("A")="   Census DATE:  " D ^%DT G END:Y<0  S FBDT=Y K %DT
	W ! S DIR(0)="Y",DIR("A")="Display Address for Vendors",DIR("B")="No" D ^DIR K DIR Q:$D(DIRUT)  S FBADDCK=Y
	S VAR="FBDT^FBI^FBADDCK",VAL=FBDT_"^"_FBI_"^"_FBADDCK,PGM="START^FBCNHCEN" D ZIS^FBAAUTL G END:FBPOP
START	S Q="=",$P(Q,"=",80)="=",QQ="-",$P(QQ,"-",38)="-",FBAAOUT=0 K ^TMP($J) U IO W:$E(IOST,1,2)["C-" @IOF D HED
	S FBK=0,FBJ=(FBDT-.1) F  S FBJ=$O(^FB7078("AD",FBI,FBJ)) Q:FBJ'>0  F  S FBK=$O(^FB7078("AD",FBI,FBJ,FBK)) Q:FBK'>0  D
	.S FBAFDT=$P(^FB7078(FBK,0),"^",4) I FBAFDT'>FBDT S FB7078=^(0) Q:$P(FB7078,U,9)="DC"  D GOT
	S (FBL,FBK)=0 F  S FBL=$O(^FB7078("AC","I",FBL)) Q:FBL'>0  F  S FBK=$O(^FB7078("AC","I",FBL,FBK)) Q:FBK'>0  D
	.S FBAFDT=$P(^FB7078(FBK,0),"^",4),FBJ=$P(^FB7078(FBK,0),"^",5) I FBAFDT'>FBDT,(FBJ'<FBDT),($P(^(0),"^",11)=FBI) S FB7078=^(0) Q:$P(FB7078,U,9)="DC"  D GOT
	S FBVNAME="",FBVIEN=0
	F  S FBVNAME=$O(^TMP($J,"FBCEN",FBVNAME)) Q:FBVNAME=""!(FBAAOUT)  F  S FBVIEN=$O(^TMP($J,"FBCEN",FBVNAME,FBVIEN)) Q:'FBVIEN  S FBNAME=0 D HED1 Q:FBAAOUT  F  S FBNAME=$O(^TMP($J,"FBCEN",FBVNAME,FBVIEN,FBNAME)) Q:FBNAME=""!(FBAAOUT)  D
	.S DFN=0 F  S DFN=$O(^TMP($J,"FBCEN",FBVNAME,FBVIEN,FBNAME,DFN)) Q:'DFN  S FB7078=^TMP($J,"FBCEN",FBVNAME,FBVIEN,FBNAME,DFN),FBDOB=+FB7078,FBAFD=$P(FB7078,"^",2),FBPSA=$P(FB7078,"^",3) D PRINT
END	K FBDT,Q,QQ,FBAAOUT,FBI,FBJ,FBK,FBVNAME,FBNAME,FB7078,DFN,FBDOB,FBAFD,FBZ,^TMP($J,"FBCEN"),FBPSA,JJ,X,Y,FBOUT,FBL,FBAFDT,FBACT,FBCKDT,FBIEN,FBREC,FBTRAN,FBTRDT,FBTRTYP,FBOUT,FBADDCK
	D CLOSE^FBAAUTL Q
GOT	S DFN=$P(FB7078,"^",3),FBZ=$P(FB7078,"^",2) Q:$P(FBZ,";",2)'="FBAAV("
	I FBI=7 K FBOUT S FBCKDT=FBAFDT D ASIH Q:$G(FBOUT)
	S FBNAME=$$NAME^FBCHREQ2(DFN),FBDOB=$P(^DPT(DFN,0),"^",3),FBAFD=$P(FB7078,"^",4)
	S FBVNAME=$P($G(^FBAAV(+FBZ,0)),"^") Q:FBVNAME=""  S FBVNAME=$E(FBVNAME,1,23)
	S JJ=0,FBPSA="",JJ=$O(^FBAAA("AG",FBK_";FB7078(",DFN,JJ)) I JJ S FBPSA=$P($G(^FBAAA(DFN,1,JJ,0)),"^",5)
	S ^TMP($J,"FBCEN",FBVNAME,+FBZ)="",^TMP($J,"FBCEN",FBVNAME,+FBZ,FBNAME,DFN)=FBDOB_"^"_FBAFD_"^"_FBPSA_"^"_FBK
	Q
PRINT	I $Y+3>IOSL,($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+3>IOSL W @IOF D HED,HED1
	W !?5,FBNAME,?33,$$DATX^FBAAUTL(FBDOB),?43,$$SSN^FBAAUTL(DFN),?58,$$PSA^FBAAUTL5(FBPSA),?68,$$DATX^FBAAUTL(FBAFD)
	Q
HED	W !?20,"FEE BASIS ",$S(FBI=6:"CIVIL HOSPITAL",FBI=7:"CONTRACT NURSING HOME",1:"UNKNOWN")," CENSUS",!?31,$$DATX^FBAAUTL(FBDT),!?20,$S(FBI=6:$E(QQ,1,31),1:QQ)
	W !!,"VENDOR NAME",?40,"VENDOR ID",!?5,"VETERAN NAME",?35,"DOB",?43,"VETERAN ID",?58,"PSA",?65,"AUTH FROM DATE",!,Q
	Q
HED1	I $Y+8>IOSL,($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR I 'Y S FBAAOUT=1 Q
	I $Y+8>IOSL W @IOF D HED
	W !!!,FBVNAME I FBADDCK S Y=FBVIEN D ^FBVDISP Q
	W ?40,$$VID^FBNHEXP(FBVIEN) Q
ASIH	;Checks to see if vet has been transferred ASIH on specified date.
	S FBACT=$O(^FBAACNH("AG",DFN,+FBZ,FBCKDT)) I 'FBACT!(FBACT>FBJ) S FBOUT=1 Q
	S FBIEN=$O(^FBAACNH("AG",DFN,+FBZ,FBACT,0)) I 'FBIEN S FBOUT=1 Q
	I $P(^FBAACNH(FBIEN,0),"^",3)'="A" S FBCKDT=FBACT G ASIH
	S FBTRAN=FBIEN F  S FBTRAN=$O(^FBAACNH("AC",FBIEN,FBTRAN)) Q:FBTRAN=""  Q:($P(^FBAACNH(FBTRAN,0),"^",3)="D")  D
	.S FBREC=$G(^FBAACNH(FBTRAN,0)),FBTRTYP=$P(FBREC,"^",7) Q:'FBTRTYP  S FBTRDT=+FBREC
	.I FBTRTYP<4,($P(FBTRDT,".")=FBDT) S FBOUT=1
	.I FBTRTYP<4 I FBTRDT'>FBDT S FBOUT=1
	.I FBTRTYP>3 I FBTRDT'>(FBDT+.99) K FBOUT

FBDOC
FBDOC	;ALBISC\TET - ROUTINE DOCUMENTATION ;10/9/92  11:24
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;Routine contains documentation of other routines.  Name sets
	;  of routines are indicated in line label.
FBPCR	;
	;POTENTIAL COST RECOVERY REPORT
	;user selects primary service areas and date range.
	;output will sort by primary service area, patient, program, vendor, date.
	;only those that are means test category c/agree to pay deductible
	;  or for non-service connected treatment are printed, as well as
	;  insurance information.
	;outpatient info - program 2 - fbpcr2 uses date finalized for date range sort
	;      o for each service on a treatment date the value of the
	;        'service connected y/n' field is checked.
	;        if no, flag to collect from insurance is set.
	;      o for the date finalized, checks if patient was cat c and agreed
	;        to pay deductible.  if true, flag to collect from patient is set.
	;       o if service is for C&P, or both of the above two flags are 
	;         negative, record is bypassed.
	;pharmacy info - program 3 - fbpcr3 uses date certified for payment for date range sort
	;       o for each invoice number, RX number for a patient within the
	;         specified date range, the value of the rx fill date field is
	;         obtained and checked against the authorization in the fee 
	;         patient file.  a check is made to see if the value of the
	;         potential cost recovery field is yes for an authorization
	;         which encompasses the fill date.
	;         if yes, flag to collect from insurance is set.
	;       o for date certified for payment, checks if patient was cat c
	;         and agreed to pay deductible.  if true, flag to collect
	;         from patient is set.
	;       o if both of the above two flags are negative, record is bypassed.
	;ch/cnh info - programs 6 and 7 - fbpcr67* uses date finalized for date range sort
	;       o for each record, for a patient within the specified date
	;         range, the value of the treatment from date is obtained
	;         and checked against the authorization in the fee patient file.
	;         a check is made to see if the value of the potential cost
	;         recovery field is yes for an authorization which encompasses
	;         the treatment from date.
	;         if yes, flag to collect from insurance is set.
	;       o for date finalized, checks if patient was cat c and agreed
	;         to pay deductible.  if true, flag to collect from patient 
	;         is set.
	;       o if both of the above two flags are negative, record is bypassed.

FBINI001
FBINI001	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161,0,"GL")
	;;=^FBAAA(
	;;^DIC("B","FEE BASIS PATIENT",161)
	;;=
	;;^DIC(161,"%D",0)
	;;=^^3^3^2940819^^^^
	;;^DIC(161,"%D",1,0)
	;;=CONTAINS ALL AUTHORIZATIONS FOR FEE BASIS SERVICES.
	;;^DIC(161,"%D",2,0)
	;;= 
	;;^DIC(161,"%D",3,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161,0)
	;;=FIELD^^104^10
	;;^DD(161,0,"DDA")
	;;=N
	;;^DD(161,0,"DT")
	;;=2940714
	;;^DD(161,0,"IX","ACV",161.01,.04)
	;;=
	;;^DD(161,0,"IX","AE",161,.5)
	;;=
	;;^DD(161,0,"IX","AF",161.01,1)
	;;=
	;;^DD(161,0,"IX","AIC",161.01,.097)
	;;=
	;;^DD(161,0,"IX","AIC1",161.01,.01)
	;;=
	;;^DD(161,0,"IX","ATST",161.01,.01)
	;;=
	;;^DD(161,0,"IX","B",161,.01)
	;;=
	;;^DD(161,0,"IX","C",161,.5)
	;;=
	;;^DD(161,0,"NM","FEE BASIS PATIENT")
	;;=
	;;^DD(161,0,"PT",161.23,.04)
	;;=
	;;^DD(161,0,"PT",162.11,4)
	;;=
	;;^DD(161,0,"PT",162.3,1)
	;;=
	;;^DD(161,0,"PT",162.5,3)
	;;=
	;;^DD(161,.01,0)
	;;=NAME^RP2'X^DPT(^0;1^S:$D(X) DINUM=X
	;;^DD(161,.01,1,0)
	;;=^.1
	;;^DD(161,.01,1,1,0)
	;;=161^B
	;;^DD(161,.01,1,1,1)
	;;=S ^FBAAA("B",$E(X,1,30),DA)=""
	;;^DD(161,.01,1,1,2)
	;;=K ^FBAAA("B",$E(X,1,30),DA)
	;;^DD(161,.01,3)
	;;=
	;;^DD(161,.01,21,0)
	;;=^^2^2^2930514^^
	;;^DD(161,.01,21,1,0)
	;;=The name of the patient who is requesting authorization for obtaining
	;;^DD(161,.01,21,2,0)
	;;=Fee services.
	;;^DD(161,.5,0)
	;;=FEE ID CARD NUMBER^FX^^4;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>7!($L(X)<5) X I $D(X),$D(^FBAAA("AE",X))!($D(^FBAA(161.83,"C",X))) W !,"You cannot assign that number because it already has been assigned!" K X
	;;^DD(161,.5,1,0)
	;;=^.1
	;;^DD(161,.5,1,1,0)
	;;=161^AE
	;;^DD(161,.5,1,1,1)
	;;=S ^FBAAA("AE",$E(X,1,30),DA)=""
	;;^DD(161,.5,1,1,2)
	;;=K ^FBAAA("AE",$E(X,1,30),DA)
	;;^DD(161,.5,1,3,0)
	;;=161^C
	;;^DD(161,.5,1,3,1)
	;;=S ^FBAAA("C",$E(X,1,30),DA)=""
	;;^DD(161,.5,1,3,2)
	;;=K ^FBAAA("C",$E(X,1,30),DA)
	;;^DD(161,.5,1,3,"%D",0)
	;;=^^2^2^2930423^
	;;^DD(161,.5,1,3,"%D",1,0)
	;;=This cross-reference will allow a user to look-up a fee patient
	;;^DD(161,.5,1,3,"%D",2,0)
	;;=with the Fee ID Card number.
	;;^DD(161,.5,1,3,"DT")
	;;=2930423
	;;^DD(161,.5,3)
	;;=ANSWER MUST BE 5-7 CHARACTERS IN LENGTH
	;;^DD(161,.5,21,0)
	;;=^^2^2^2870108^
	;;^DD(161,.5,21,1,0)
	;;=The number pre-printed on the Fee ID Card assigned (given) to the patient.
	;;^DD(161,.5,21,2,0)
	;;=The patient can only have one number assigned to him/her at a given time.
	;;^DD(161,.5,"DT")
	;;=2930701
	;;^DD(161,.6,0)
	;;=FEE ID CARD ISSUE DATE^D^^4;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161,.6,21,0)
	;;=^^1^1^2870108^
	;;^DD(161,.6,21,1,0)
	;;=The date that the Fee ID Card was issued to the patient.
	;;^DD(161,.6,"DT")
	;;=2851212
	;;^DD(161,.65,0)
	;;=FEE ID CARD EXPIRATION DATE^D^^4;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161,.65,21,0)
	;;=^^2^2^2880608^^^
	;;^DD(161,.65,21,1,0)
	;;=This field contains the expiration date for a patient's
	;;^DD(161,.65,21,2,0)
	;;=ID card.
	;;^DD(161,.65,"DT")
	;;=2870129
	;;^DD(161,.7,0)
	;;=REASON FOR CARD NUMBER CHANGE^RF^^4;3^K:$L(X)>80!($L(X)<2) X
	;;^DD(161,.7,3)
	;;=ANSWER MUST BE 2-80 CHARACTERS IN LENGTH
	;;^DD(161,.7,21,0)
	;;=^^1^1^2930601^^
	;;^DD(161,.7,21,1,0)
	;;=The reason that the patient's Fee ID Card number was changed or terminated.
	;;^DD(161,.7,"DT")
	;;=2860411
	;;^DD(161,1,0)
	;;=AUTHORIZATION^161.01ID^^1;0
	;;^DD(161,1,21,0)
	;;=^^2^2^2930603^^^^
	;;^DD(161,1,21,1,0)
	;;=This data is related to specific validity periods where the veteran
	;;^DD(161,1,21,2,0)
	;;=is authorized to obtain Fee services and the VA will reimburse.
	;;^DD(161,1,"DT")
	;;=2930603
	;;^DD(161,2,0)
	;;=REPORT OF CONTACT^161.02D^^2;0
	;;^DD(161,2,21,0)
	;;=^^3^3^2930514^^
	;;^DD(161,2,21,1,0)
	;;=Contains information relating to the initial contact between the VA and
	;;^DD(161,2,21,2,0)
	;;=a patient's representative, regarding patient treatment at a non-VA
	;;^DD(161,2,21,3,0)
	;;=facility.
	;;^DD(161,102,0)
	;;=*AUSTIN DELETED^S^Y:YES;^ADEL;1^Q
	;;^DD(161,102,21,0)
	;;=^^3^3^2940714^
	;;^DD(161,102,21,1,0)
	;;=This is a flag that is set internally when a patient
	;;^DD(161,102,21,2,0)
	;;=has been deleted from the Austin file.  This only occurs

FBINI002
FBINI002	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161,102,21,3,0)
	;;=after inactivity for a year.
	;;^DD(161,102,"DT")
	;;=2940714
	;;^DD(161,103,0)
	;;=*DATE OF AUSTIN DELETE^D^^ADEL;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161,103,21,0)
	;;=^^1^1^2940714^
	;;^DD(161,103,21,1,0)
	;;=This is the date of Austin deletion.
	;;^DD(161,103,"DT")
	;;=2940714
	;;^DD(161,104,0)
	;;=*DATE TRANSMITTED TO AUSTIN^D^^ADEL;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161,104,21,0)
	;;=^^2^2^2940714^
	;;^DD(161,104,21,1,0)
	;;=This is the date that the last MRA was transmitted to
	;;^DD(161,104,21,2,0)
	;;=Austin.
	;;^DD(161,104,"DT")
	;;=2940714
	;;^DD(161.01,0)
	;;=AUTHORIZATION SUB-FIELD^NL^4^23
	;;^DD(161.01,0,"DT")
	;;=2940714
	;;^DD(161.01,0,"IX","AA",161.01,.096)
	;;=
	;;^DD(161.01,0,"IX","AC",161.01,.097)
	;;=
	;;^DD(161.01,0,"IX","AF",161.01,1)
	;;=
	;;^DD(161.01,0,"IX","AG",161.01,.055)
	;;=
	;;^DD(161.01,0,"NM","AUTHORIZATION")
	;;=
	;;^DD(161.01,0,"UP")
	;;=161
	;;^DD(161.01,.01,0)
	;;=FROM DATE^DX^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.01,.01,1,0)
	;;=^.1
	;;^DD(161.01,.01,1,1,0)
	;;=161^AIC1^MUMPS
	;;^DD(161.01,.01,1,1,1)
	;;=S:$P(^FBAAA(DA(1),1,DA,0),U,20)]"" ^FBAAA("AIC",DA(1),-X,$P(^FBAAA(DA(1),1,DA,0),U,20),DA)=""
	;;^DD(161.01,.01,1,1,2)
	;;=K:$P(^FBAAA(DA(1),1,DA,0),U,20)]"" ^FBAAA("AIC",DA(1),-X,$P(^FBAAA(DA(1),1,DA,0),U,20),DA)
	;;^DD(161.01,.01,1,1,"%D",0)
	;;=2^^2^2^2930514^^^
	;;^DD(161.01,.01,1,1,"%D",1,0)
	;;=Cross-reference used to identify potential billables using inverse date.
	;;^DD(161.01,.01,1,1,"%D",2,0)
	;;=Used to set "AIC" cross-reference on field .097, POTENTIAL COST RECOVERY CASE.
	;;^DD(161.01,.01,1,1,"DT")
	;;=2930326
	;;^DD(161.01,.01,1,2,0)
	;;=161^ATST
	;;^DD(161.01,.01,1,2,1)
	;;=S ^FBAAA("ATST",$E(X,1,30),DA(1),DA)=""
	;;^DD(161.01,.01,1,2,2)
	;;=K ^FBAAA("ATST",$E(X,1,30),DA(1),DA)
	;;^DD(161.01,.01,1,2,"DT")
	;;=2921014
	;;^DD(161.01,.01,21,0)
	;;=^^4^4^2930603^^^^
	;;^DD(161.01,.01,21,1,0)
	;;=The beginning date for which the patient is authorized to obtain services
	;;^DD(161.01,.01,21,2,0)
	;;=from private vendors. For every claim made by a vendor for this patient,
	;;^DD(161.01,.01,21,3,0)
	;;=this date will be checked to insure that the date the service was provided
	;;^DD(161.01,.01,21,4,0)
	;;=was on or after this date.
	;;^DD(161.01,.01,"DEL",.01,0)
	;;=I $$DELA^FBUCDD1(.DA,1)
	;;^DD(161.01,.01,"DT")
	;;=2930603
	;;^DD(161.01,.02,0)
	;;=TO DATE^RDX^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X),$P(^FBAAA(DA(1),1,DA,0),U,1)>X K X W !!,"To Date cannot be earlier than From Date!",!
	;;^DD(161.01,.02,21,0)
	;;=^^4^4^2930603^^^^
	;;^DD(161.01,.02,21,1,0)
	;;=The date through which the veteran may obtain services from private vendors,
	;;^DD(161.01,.02,21,2,0)
	;;=and which the VA will reimburse. For every claim submitted by a vendor,
	;;^DD(161.01,.02,21,3,0)
	;;=this date is compared with the date the service was provided, and 
	;;^DD(161.01,.02,21,4,0)
	;;=service date must be on or before this date.
	;;^DD(161.01,.02,"DT")
	;;=2900529
	;;^DD(161.01,.021,0)
	;;=AUTHORIZATION REMARKS^161.06^^2;0
	;;^DD(161.01,.021,21,0)
	;;=^^3^3^2880225^
	;;^DD(161.01,.021,21,1,0)
	;;=Used to identify limitations or detail specifics regarding the 
	;;^DD(161.01,.021,21,2,0)
	;;=authorization. The information contained here is displayed during the
	;;^DD(161.01,.021,21,3,0)
	;;=enter payment option and also on patient inquiry option.
	;;^DD(161.01,.03,0)
	;;=FEE PROGRAM^RP161.8'^FBAA(161.8,^0;3^Q
	;;^DD(161.01,.03,1,0)
	;;=^.1^^0
	;;^DD(161.01,.03,3)
	;;=
	;;^DD(161.01,.03,21,0)
	;;=^^2^2^2880225^
	;;^DD(161.01,.03,21,1,0)
	;;=Links this authorization to one of the valid Fee programs (ie Medical,
	;;^DD(161.01,.03,21,2,0)
	;;=Contract Hospital, Community Nursing Home).
	;;^DD(161.01,.03,"DT")
	;;=2860109
	;;^DD(161.01,.04,0)
	;;=VENDOR^P161.2^FBAAV(^0;4^Q
	;;^DD(161.01,.04,1,0)
	;;=^.1
	;;^DD(161.01,.04,1,1,0)
	;;=161^ACV^MUMPS
	;;^DD(161.01,.04,1,1,1)
	;;=S ^FBAAA("ACV",$E(X,1,30),DA(1),DA)=""
	;;^DD(161.01,.04,1,1,2)
	;;=K ^FBAAA("ACV",$E(X,1,30),DA(1),DA)
	;;^DD(161.01,.04,1,1,"DT")
	;;=2931223
	;;^DD(161.01,.04,21,0)
	;;=^^2^2^2880225^

FBINI003
FBINI003	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.01,.04,21,1,0)
	;;=The name of the vendor providing the veteran service if the authorization
	;;^DD(161.01,.04,21,2,0)
	;;=is limited to one specific vendor.
	;;^DD(161.01,.04,"DT")
	;;=2931223
	;;^DD(161.01,.055,0)
	;;=ASSOCIATED 7078/583^V^^0;9^Q
	;;^DD(161.01,.055,1,0)
	;;=^.1
	;;^DD(161.01,.055,1,1,0)
	;;=161.01^AG^MUMPS
	;;^DD(161.01,.055,1,1,1)
	;;=S ^FBAAA("AG",$E(X,1,30),DA(1),DA)=""
	;;^DD(161.01,.055,1,1,2)
	;;=K ^FBAAA("AG",$E(X,1,30),DA(1),DA)
	;;^DD(161.01,.055,3)
	;;=
	;;^DD(161.01,.055,21,0)
	;;=^^2^2^2930514^^
	;;^DD(161.01,.055,21,1,0)
	;;=This field contains the related 7078/583 for the authorization.  It
	;;^DD(161.01,.055,21,2,0)
	;;=points to the 7078 file or the 583 file for an unauthorized claim.
	;;^DD(161.01,.055,"DT")
	;;=2900919
	;;^DD(161.01,.055,"V",0)
	;;=^.12P^2^2
	;;^DD(161.01,.055,"V",1,0)
	;;=162.4^Select associated 7078^1^FB7078^n^n
	;;^DD(161.01,.055,"V",2,0)
	;;=162.7^Select associated 583^2^FB583^n^n
	;;^DD(161.01,.06,0)
	;;=DISCHARGE TYPE^S^1:TRANSFER TO VA;2:DEATH WITH AUTOPSY;3:DEATH WITHOUT AUTOPSY;4:DISCHARGE;^0;15^Q
	;;^DD(161.01,.06,21,0)
	;;=^^2^2^2890131^
	;;^DD(161.01,.06,21,1,0)
	;;=This field is filled in as part of the disposition process
	;;^DD(161.01,.06,21,2,0)
	;;=in contract hospital.
	;;^DD(161.01,.06,"DT")
	;;=2890131
	;;^DD(161.01,.065,0)
	;;=PATIENT TYPE CODE^S^00:SURGICAL;10:MEDICAL;60:HOME NURSING SERVICE;85:PSYCHIATRIC-CONTRACT;86:PSYCHIATRIC;95:NEUROLOGICAL-CONTRACT;96:NEUROLOGICAL;^0;18^Q
	;;^DD(161.01,.065,21,0)
	;;=^^3^3^2880225^
	;;^DD(161.01,.065,21,1,0)
	;;=The code which indicates whether the patient is a medical, surgical,
	;;^DD(161.01,.065,21,2,0)
	;;=psychiatric or one of the other valid codes. See M-1, Part I, Chapter 18
	;;^DD(161.01,.065,21,3,0)
	;;=for specific detail.
	;;^DD(161.01,.065,"DT")
	;;=2860221
	;;^DD(161.01,.07,0)
	;;=PURPOSE OF VISIT CODE^R*P161.82'^FBAA(161.82,^0;7^S DIC("S")="I $S('$G(^(""I"")):1,DT'>^(""I""):1,1:0),$S('$D(FBTYPE):1,$P(^(0),U,2)=FBTYPE:1,1:0)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(161.01,.07,12)
	;;=Allows selection of POV related to FEE Program being used...disallows selection of an inactive POV Code.
	;;^DD(161.01,.07,12.1)
	;;=S DIC("S")="I $S('$G(^(""I"")):1,DT'>^(""I""):1,1:0),$S('$D(FBTYPE):1,$P(^(0),U,2)=FBTYPE:1,1:0)"
	;;^DD(161.01,.07,21,0)
	;;=^^4^4^2930204^^^
	;;^DD(161.01,.07,21,1,0)
	;;=Used to indicate the purpose for the visit to the provider. Selection
	;;^DD(161.01,.07,21,2,0)
	;;=of these are screened based on the Fee program entered earlier. For 
	;;^DD(161.01,.07,21,3,0)
	;;=example, if Outpatient Medical Fee Program is selected Purpose of visit
	;;^DD(161.01,.07,21,4,0)
	;;=of 'Authorized Contract Hospitalization' could not be selected.
	;;^DD(161.01,.07,"DT")
	;;=2930204
	;;^DD(161.01,.08,0)
	;;=DX LINE 1^F^^0;8^K:$L(X)>60!($L(X)<3) X
	;;^DD(161.01,.08,.1)
	;;=DIAGNOSIS
	;;^DD(161.01,.08,3)
	;;=ANSWER MUST BE 3-60 CHARACTERS IN LENGTH
	;;^DD(161.01,.08,21,0)
	;;=^^1^1^2931012^^^^
	;;^DD(161.01,.08,21,1,0)
	;;=Patient's diagnosis for which this authorization is being issued.[LINE 1]
	;;^DD(161.01,.08,"DT")
	;;=2870316
	;;^DD(161.01,.085,0)
	;;=DX LINE 2^F^^3;1^K:$L(X)>60!($L(X)<2) X
	;;^DD(161.01,.085,3)
	;;=ANSWER MUST BE 2-60 CHARACTERS IN LENGTH
	;;^DD(161.01,.085,21,0)
	;;=^^2^2^2931012^^^^
	;;^DD(161.01,.085,21,1,0)
	;;=An additional 60 characters to continue the description of patient's 
	;;^DD(161.01,.085,21,2,0)
	;;=diagnosis for which this authorization is being issued.
	;;^DD(161.01,.085,"DT")
	;;=2870316
	;;^DD(161.01,.086,0)
	;;=DX LINE 3^F^^3;2^K:$L(X)>60!($L(X)<2) X
	;;^DD(161.01,.086,3)
	;;=ANSWER MUST BE 2-60 CHARACTERS IN LENGTH
	;;^DD(161.01,.086,21,0)
	;;=^^2^2^2931012^^^^
	;;^DD(161.01,.086,21,1,0)
	;;=An additional 60 characters to continue describing patient's diagnosis.
	;;^DD(161.01,.086,21,2,0)
	;;=This is the diagnosis applicable to this authorization.
	;;^DD(161.01,.086,"DT")
	;;=2870316
	;;^DD(161.01,.095,0)
	;;=TREATMENT TYPE CODE^RS^1:SHORT TERM FEE STATUS;2:HOME NURSING SERVICES;3:I.D. CARD STATUS;^0;13^Q

FBINI004
FBINI004	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.01,.095,21,0)
	;;=^^2^2^2880225^
	;;^DD(161.01,.095,21,1,0)
	;;=Indicates what the type of treatment this authorization is related to.
	;;^DD(161.01,.095,21,2,0)
	;;=See M-1, Part 1, Chapter 18, for valid entries.
	;;^DD(161.01,.095,"DT")
	;;=2860722
	;;^DD(161.01,.096,0)
	;;=ACCIDENT RELATED (Y/N)^FXO^^0;19^I $D(X) D YN^FBAAUTL3
	;;^DD(161.01,.096,1,0)
	;;=^.1
	;;^DD(161.01,.096,1,1,0)
	;;=161.01^AA^MUMPS
	;;^DD(161.01,.096,1,1,1)
	;;=S ^FBAAA("AA",X,$P(^FBAAA(DA(1),1,DA,0),U,1),DA(1),DA)=""
	;;^DD(161.01,.096,1,1,2)
	;;=K ^FBAAA("AA",X,$P(^FBAAA(DA(1),1,DA,0),U,1),DA(1),DA)
	;;^DD(161.01,.096,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.01,.096,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.01,.096,3)
	;;=Answer 'Yes' or '1' for YES and a 'No' or '0' for NO.
	;;^DD(161.01,.096,21,0)
	;;=^^2^2^2940318^^^
	;;^DD(161.01,.096,21,1,0)
	;;=This field allows the fee system to track those authorizations
	;;^DD(161.01,.096,21,2,0)
	;;=that were issued for an accident related condition.
	;;^DD(161.01,.096,"DT")
	;;=2940318
	;;^DD(161.01,.097,0)
	;;=POTENTIAL COST RECOVERY CASE^RFXO^^0;20^I $D(X) D YN^FBAAUTL3
	;;^DD(161.01,.097,.1)
	;;=POTENTIAL COST RECOVERY CASE (Y/N)
	;;^DD(161.01,.097,1,0)
	;;=^.1
	;;^DD(161.01,.097,1,1,0)
	;;=161.01^AC^MUMPS
	;;^DD(161.01,.097,1,1,1)
	;;=S ^FBAAA("AC",X,$P(^FBAAA(DA(1),1,DA,0),U,1),DA(1),DA)=""
	;;^DD(161.01,.097,1,1,2)
	;;=K ^FBAAA("AC",X,$P(^FBAAA(DA(1),1,DA,0),U,1),DA(1),DA)
	;;^DD(161.01,.097,1,2,0)
	;;=161^AIC^MUMPS
	;;^DD(161.01,.097,1,2,1)
	;;=S:$P(^FBAAA(DA(1),1,DA,0),U) ^FBAAA("AIC",DA(1),-($P(^FBAAA(DA(1),1,DA,0),U)),X,DA)=""
	;;^DD(161.01,.097,1,2,2)
	;;=K:$P(^FBAAA(DA(1),1,DA,0),U) ^FBAAA("AIC",DA(1),-($P(^FBAAA(DA(1),1,DA,0),U)),X,DA)
	;;^DD(161.01,.097,1,2,"%D",0)
	;;=^^1^1^2930514^^^^
	;;^DD(161.01,.097,1,2,"%D",1,0)
	;;=Cross-reference used to identify potential billables using inverse date.
	;;^DD(161.01,.097,1,2,"DT")
	;;=2930326
	;;^DD(161.01,.097,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.01,.097,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.01,.097,3)
	;;=Answer a 'Yes' or '1' for YES and a 'No' or '0' for NO.
	;;^DD(161.01,.097,21,0)
	;;=^^2^2^2930514^
	;;^DD(161.01,.097,21,1,0)
	;;=Determines if payment can be recovered from the veteran's insurance, or
	;;^DD(161.01,.097,21,2,0)
	;;=if payment can be recovered due to the veteran being a Cat. C patient.
	;;^DD(161.01,.097,"DT")
	;;=2940318
	;;^DD(161.01,1,0)
	;;=PRINT AUTHORIZATION (Y/N)^FX^^C;1^I $D(X) D YN^FBAAUTL3
	;;^DD(161.01,1,1,0)
	;;=^.1
	;;^DD(161.01,1,1,1,0)
	;;=161.01^AF^MUMPS
	;;^DD(161.01,1,1,1,1)
	;;=D ADD^FBAAUTL2
	;;^DD(161.01,1,1,1,2)
	;;=D KILL^FBAAUTL2
	;;^DD(161.01,1,3)
	;;=Answer a 'Yes' or '1' for YES and a 'No' or '0' for NO.
	;;^DD(161.01,1,4)
	;;=
	;;^DD(161.01,1,21,0)
	;;=^^2^2^2940701^^
	;;^DD(161.01,1,21,1,0)
	;;=Used to indicate whether a VA Form 7079, Request For Outpatient Services,
	;;^DD(161.01,1,21,2,0)
	;;=should be printed at the completion of entering the authorization data.
	;;^DD(161.01,1,"DT")
	;;=2940525
	;;^DD(161.01,2,0)
	;;=TYPE OF CARE^S^1:C&P;2:OPT NSC;3:OPT SC;^0;14^Q
	;;^DD(161.01,2,21,0)
	;;=^^2^2^2880225^
	;;^DD(161.01,2,21,1,0)
	;;=Defines whether this authorization is related to OPT/NSC, OPT/SC, or C&P
	;;^DD(161.01,2,21,2,0)
	;;=type of care.
	;;^DD(161.01,2,"DT")
	;;=2880324
	;;^DD(161.01,3,0)
	;;=DATE PRINTED^D^^1;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.01,3,21,0)
	;;=^^1^1^2880225^^
	;;^DD(161.01,3,21,1,0)
	;;=The date the last 7079 was printed for this authorization.
	;;^DD(161.01,4,0)
	;;=*CNH LEVEL OF CARE^S^S:SKILLED;I:INTERMEDIATE;^CNH;1^Q
	;;^DD(161.01,4,21,0)
	;;=^^1^1^2940714^
	;;^DD(161.01,4,21,1,0)
	;;=The level of care authorized for this authorization.
	;;^DD(161.01,4,"DT")
	;;=2940714
	;;^DD(161.01,100,0)
	;;=CLERK^P200'^VA(200,^100;1^Q
	;;^DD(161.01,100,21,0)
	;;=^^1^1^2880608^^^^
	;;^DD(161.01,100,21,1,0)
	;;=The last user to enter/edit data for this authorization.
	;;^DD(161.01,100,"DT")
	;;=2900405
	;;^DD(161.01,101,0)
	;;=PRIMARY SERVICE AREA^RP4'^DIC(4,^0;5^Q
	;;^DD(161.01,101,.1)
	;;=PRIMARY SERVICE FACILITY
	;;^DD(161.01,101,21,0)
	;;=^^1^1^2941128^

FBINI005
FBINI005	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.01,101,21,1,0)
	;;=The VA Hospital responsible for the veterans care.
	;;^DD(161.01,101,"DT")
	;;=2900403
	;;^DD(161.01,102,0)
	;;=AUSTIN DELETE FLAG^FXO^^ADEL;1^I $D(X) D YN^FBAAUTL3
	;;^DD(161.01,102,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.01,102,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.01,102,3)
	;;=Answer 'Yes' or '1' for YES and 'No' or '0' for NO.
	;;^DD(161.01,102,21,0)
	;;=^^3^3^2920526^
	;;^DD(161.01,102,21,1,0)
	;;=This field will be populated when a 'Delete MRA' is transmitted to
	;;^DD(161.01,102,21,2,0)
	;;=Austin DPC. This field will also be used to screen out selection
	;;^DD(161.01,102,21,3,0)
	;;=for payments made to Austin.
	;;^DD(161.01,102,"DT")
	;;=2940318
	;;^DD(161.01,103,0)
	;;=DATE DELETE MRA TRANSMITTED^D^^ADEL;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.01,103,21,0)
	;;=^^3^3^2920526^
	;;^DD(161.01,103,21,1,0)
	;;=This field will be set internally when a 'Delete Veteran MRA' is sent
	;;^DD(161.01,103,21,2,0)
	;;=to Austin.  It will be used to screen selection during the enter
	;;^DD(161.01,103,21,3,0)
	;;=payment options.
	;;^DD(161.01,103,"DT")
	;;=2920526
	;;^DD(161.02,0)
	;;=REPORT OF CONTACT SUB-FIELD^NL^100^8
	;;^DD(161.02,0,"NM","REPORT OF CONTACT")
	;;=
	;;^DD(161.02,0,"UP")
	;;=161
	;;^DD(161.02,.01,0)
	;;=DATE OF CONTACT^MDX^^0;1^S %DT="EX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(161.02,.01,21,0)
	;;=^^1^1^2880608^^^
	;;^DD(161.02,.01,21,1,0)
	;;=Date the contact occurred. The actual date that a communication occurred.
	;;^DD(161.02,.01,"DT")
	;;=2900605
	;;^DD(161.02,1,0)
	;;=VENDOR/PROVIDER^F^^0;2^K:$L(X)>46!($L(X)<2) X
	;;^DD(161.02,1,3)
	;;=ANSWER MUST BE 2-46 CHARACTERS IN LENGTH
	;;^DD(161.02,1,21,0)
	;;=^^1^1^2880229^
	;;^DD(161.02,1,21,1,0)
	;;=The vendor/provider with whom the contact took place.
	;;^DD(161.02,1,"DT")
	;;=2860107
	;;^DD(161.02,1.5,0)
	;;=VENDOR/PROVIDER TELEPHONE NO.^F^^0;3^K:$L(X)>20!($L(X)<3) X
	;;^DD(161.02,1.5,3)
	;;=ANSWER MUST BE 3-20 CHARACTERS IN LENGTH
	;;^DD(161.02,1.5,21,0)
	;;=^^2^2^2930514^
	;;^DD(161.02,1.5,21,1,0)
	;;=Contains the phone number of the vendor/provider who initially treated
	;;^DD(161.02,1.5,21,2,0)
	;;=the patient.
	;;^DD(161.02,1.5,"DT")
	;;=2880802
	;;^DD(161.02,2,0)
	;;=NARRATIVE^161.04^^1;0
	;;^DD(161.02,2,21,0)
	;;=^^2^2^2880229^
	;;^DD(161.02,2,21,1,0)
	;;=Detail accounting of the discussion or topic of the contact. Clearly
	;;^DD(161.02,2,21,2,0)
	;;=describes the main points and purpose of the contact.
	;;^DD(161.02,3,0)
	;;=DX^F^^0;4^K:$L(X)>45!($L(X)<1) X
	;;^DD(161.02,3,3)
	;;=ANSWER MUST BE 1-45 CHARACTERS IN LENGTH
	;;^DD(161.02,3,21,0)
	;;=^^1^1^2931012^^^
	;;^DD(161.02,3,21,1,0)
	;;=Diagnosis of the patient to whom the contact was related.
	;;^DD(161.02,3.5,0)
	;;=TYPE OF CONTACT^RS^P:personal;T:telephonic;^0;6^Q
	;;^DD(161.02,3.5,21,0)
	;;=^^2^2^2930514^
	;;^DD(161.02,3.5,21,1,0)
	;;=Field indicates whether initial contact with VA on behalf of a patient
	;;^DD(161.02,3.5,21,2,0)
	;;=was personal or telephonic.
	;;^DD(161.02,3.5,"DT")
	;;=2881031
	;;^DD(161.02,5,0)
	;;=INPUT DATE^DX^^0;5^S %DT="EX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(161.02,5,21,0)
	;;=^^2^2^2880527^^
	;;^DD(161.02,5,21,1,0)
	;;=This is the date that the report of contact was entered into the
	;;^DD(161.02,5,21,2,0)
	;;=DHCP Fee package.
	;;^DD(161.02,5,"DT")
	;;=2901016
	;;^DD(161.02,100,0)
	;;=CLERK^P200'^VA(200,^100;1^Q
	;;^DD(161.02,100,21,0)
	;;=^^1^1^2880526^^
	;;^DD(161.02,100,21,1,0)
	;;=Clerk entering this report of contact.
	;;^DD(161.02,100,"DT")
	;;=2900405
	;;^DD(161.04,0)
	;;=NARRATIVE SUB-FIELD^NL^.01^1
	;;^DD(161.04,0,"NM","NARRATIVE")
	;;=
	;;^DD(161.04,0,"UP")
	;;=161.02
	;;^DD(161.04,.01,0)
	;;=NARRATIVE^W^^0;1^Q
	;;^DD(161.04,.01,"DT")
	;;=2860107
	;;^DD(161.06,0)
	;;=AUTHORIZATION REMARKS SUB-FIELD^NL^.01^1
	;;^DD(161.06,0,"NM","AUTHORIZATION REMARKS")
	;;=
	;;^DD(161.06,0,"UP")
	;;=161.01
	;;^DD(161.06,.01,0)
	;;=AUTHORIZATION REMARKS^W^^0;1^Q
	;;^DD(161.06,.01,"DT")
	;;=2860127

FBINI006
FBINI006	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.2,0,"GL")
	;;=^FBAAV(
	;;^DIC("B","FEE BASIS VENDOR",161.2)
	;;=
	;;^DIC(161.2,"%D",0)
	;;=^^3^3^2940622^^^^
	;;^DIC(161.2,"%D",1,0)
	;;=Contains all Vendors established for payment of Fee Basis services.
	;;^DIC(161.2,"%D",2,0)
	;;= 
	;;^DIC(161.2,"%D",3,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.2,0)
	;;=FIELD^^13.1^34
	;;^DD(161.2,0,"DDA")
	;;=N
	;;^DD(161.2,0,"DT")
	;;=2941130
	;;^DD(161.2,0,"ID",1)
	;;=W ""
	;;^DD(161.2,0,"ID",6)
	;;=W ""
	;;^DD(161.2,0,"ID",7)
	;;=W ""
	;;^DD(161.2,0,"ID",8)
	;;=W ""
	;;^DD(161.2,0,"ID","WRITE")
	;;=D ^FBVDISP
	;;^DD(161.2,0,"IX","AC",161.2,12)
	;;=
	;;^DD(161.2,0,"IX","AD",161.2,8)
	;;=
	;;^DD(161.2,0,"IX","AD1",161.2,1)
	;;=
	;;^DD(161.2,0,"IX","B",161.2,.01)
	;;=
	;;^DD(161.2,0,"IX","BS",161.2,1)
	;;=
	;;^DD(161.2,0,"IX","C",161.2,1)
	;;=
	;;^DD(161.2,0,"IX","D",161.2,30.01)
	;;=
	;;^DD(161.2,0,"IX","E",161.2,1)
	;;=
	;;^DD(161.2,0,"NM","FEE BASIS VENDOR")
	;;=
	;;^DD(161.2,0,"PT",161.01,.04)
	;;=
	;;^DD(161.2,0,"PT",161.21,.04)
	;;=
	;;^DD(161.2,0,"PT",161.25,.01)
	;;=
	;;^DD(161.2,0,"PT",161.5,1)
	;;=
	;;^DD(161.2,0,"PT",162.01,.01)
	;;=
	;;^DD(161.2,0,"PT",162.1,3)
	;;=
	;;^DD(161.2,0,"PT",162.2,1)
	;;=
	;;^DD(161.2,0,"PT",162.3,8)
	;;=
	;;^DD(161.2,0,"PT",162.4,1)
	;;=
	;;^DD(161.2,0,"PT",162.5,2)
	;;=
	;;^DD(161.2,0,"PT",162.7,1)
	;;=
	;;^DD(161.2,0,"PT",162.7,23)
	;;=
	;;^DD(161.2,.01,0)
	;;=NAME^RFX^^0;1^K:$L(X)>46!($L(X)<2)!'(X'?1P.E)!(X[", ") X I $D(X) S X=$$UP^FBAAUTL3(X) I $D(X),'$D(ZTQUEUED),'$D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ)) K X W !!,*7,"You do not have the required key to add a new vendor to the Vendor file!",!
	;;^DD(161.2,.01,1,0)
	;;=^.1^^-1
	;;^DD(161.2,.01,1,1,0)
	;;=161.2^B
	;;^DD(161.2,.01,1,1,1)
	;;=S ^FBAAV("B",$E(X,1,46),DA)=""
	;;^DD(161.2,.01,1,1,2)
	;;=K ^FBAAV("B",$E(X,1,46),DA)
	;;^DD(161.2,.01,3)
	;;=ANSWER MUST BE 2-46 CHARACTERS IN LENGTH. YOU MUST BE ASSIGNED A KEY TO BE ABLE TO ADD A NEW VENDOR.  IF USING FORMAT LAST,FIRST DO NOT INCLUDE SPACES AFTER COMMA.
	;;^DD(161.2,.01,21,0)
	;;=^^1^1^2930507^^^^
	;;^DD(161.2,.01,21,1,0)
	;;=Name of the private vendor/provider providing fee services.
	;;^DD(161.2,.01,"DEL",.01,0)
	;;=W !,*7,"You cannot delete vendors from the DHCP Vendor file!!"
	;;^DD(161.2,.01,"DT")
	;;=2950111
	;;^DD(161.2,.05,0)
	;;=SPECIALTY CODE^P161.6'^FBAA(161.6,^0;8^Q
	;;^DD(161.2,.05,3)
	;;=
	;;^DD(161.2,.05,21,0)
	;;=^^3^3^2880229^
	;;^DD(161.2,.05,21,1,0)
	;;=The specialty code which describes this vendors area of expertise 
	;;^DD(161.2,.05,21,2,0)
	;;=(ie Dermatology, Anesthesiology, Neurology). Valid codes are documented
	;;^DD(161.2,.05,21,3,0)
	;;=in M-1, Part I, chapter 18, Appendix A.
	;;^DD(161.2,.05,"DT")
	;;=2860501
	;;^DD(161.2,.18,0)
	;;=NUMBER OF CNH BEDS^NJ4,0^^1;8^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.2,.18,3)
	;;=Type a Number between 1 and 9999, 0 Decimal Digits
	;;^DD(161.2,.18,21,0)
	;;=^^1^1^2930514^
	;;^DD(161.2,.18,21,1,0)
	;;=Indicates the number of Contract Nursing Home Beds for this vendor.
	;;^DD(161.2,.18,"DT")
	;;=2930301
	;;^DD(161.2,1,0)
	;;=ID NUMBER^RFOX^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>11!($L(X)<9)!(+X=0)!(X'?9N.2AN) X
	;;^DD(161.2,1,1,0)
	;;=^.1
	;;^DD(161.2,1,1,1,0)
	;;=161.2^C
	;;^DD(161.2,1,1,1,1)
	;;=S ^FBAAV("C",$E(X,1,30),DA)=""
	;;^DD(161.2,1,1,1,2)
	;;=K ^FBAAV("C",$E(X,1,30),DA)
	;;^DD(161.2,1,1,2,0)
	;;=161.2^BS^MUMPS
	;;^DD(161.2,1,1,2,1)
	;;=S ^FBAAV("BS",$E(X,6,9),DA)=""
	;;^DD(161.2,1,1,2,2)
	;;=K ^FBAAV("BS",$E(X,6,9),DA)
	;;^DD(161.2,1,1,3,0)
	;;=161.2^AD1^MUMPS
	;;^DD(161.2,1,1,3,1)
	;;=S:$P(^FBAAV(DA,0),U,10) ^FBAAV("AD",X_$E("0000",$L($P(^(0),U,10))+1,4)_$P(^(0),U,10),DA)=""
	;;^DD(161.2,1,1,3,2)
	;;=K:$P(^FBAAV(DA,0),U,10) ^FBAAV("AD",X_$E("0000",$L($P(^(0),U,10))+1,4)_$P(^(0),U,10),DA)
	;;^DD(161.2,1,1,3,"%D",0)
	;;=^^3^3^2930514^^
	;;^DD(161.2,1,1,3,"%D",1,0)
	;;=X-Ref used to update the AD X-Ref located on the Chain Store field.  If
	;;^DD(161.2,1,1,3,"%D",2,0)
	;;=Vendor Id is changed, the AD1 X-Ref will delete the associated AD X-Ref
	;;^DD(161.2,1,1,3,"%D",3,0)
	;;=and add a new X-Ref (^FBAAV("AD",(VENDOR ID_CHAIN STORE),DA).

FBINI007
FBINI007	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.2,1,1,3,"DT")
	;;=2930323
	;;^DD(161.2,1,1,4,0)
	;;=161.2^E^MUMPS
	;;^DD(161.2,1,1,4,1)
	;;=S ^FBAAV("E",$E(X,1,9),DA)=""
	;;^DD(161.2,1,1,4,2)
	;;=K ^FBAAV("E",$E(X,1,9),DA)
	;;^DD(161.2,1,1,4,"%D",0)
	;;=^^3^3^2940121^^
	;;^DD(161.2,1,1,4,"%D",1,0)
	;;=This cross-reference is on the base 9 of the Tax-ID number.  It will
	;;^DD(161.2,1,1,4,"%D",2,0)
	;;=group all alpha and numeric suffixes when the base 9 is typed in for
	;;^DD(161.2,1,1,4,"%D",3,0)
	;;=look-up.
	;;^DD(161.2,1,1,4,"DT")
	;;=2931126
	;;^DD(161.2,1,2)
	;;=S Y(0)=Y S Y=$E(Y,1,3)_"-"_$E(Y,4,5)_"-"_$E(Y,6,99)
	;;^DD(161.2,1,2.1)
	;;=S Y=$E(Y,1,3)_"-"_$E(Y,4,5)_"-"_$E(Y,6,99)
	;;^DD(161.2,1,3)
	;;=Answer must be 9-11 characters in length.  Nine zeros is not a valid ID.
	;;^DD(161.2,1,21,0)
	;;=^^4^4^2940610^^^^
	;;^DD(161.2,1,21,1,0)
	;;=Provider's Federal ID Tax number. The first 9 characters of the
	;;^DD(161.2,1,21,2,0)
	;;=ID number must be numeric. If the ID number is
	;;^DD(161.2,1,21,3,0)
	;;=11 characters long the 10th and 11th characters may be alphanumeric.
	;;^DD(161.2,1,21,4,0)
	;;=An ID number of '000000000' is not valid.
	;;^DD(161.2,1,"DT")
	;;=2940610
	;;^DD(161.2,2,0)
	;;=STREET ADDRESS^F^^0;3^K:$L(X)>30!($L(X)<2) X
	;;^DD(161.2,2,3)
	;;=ANSWER MUST BE 2-30 CHARACTERS IN LENGTH
	;;^DD(161.2,2,21,0)
	;;=^^1^1^2880616^^
	;;^DD(161.2,2,21,1,0)
	;;=First line of vendor's street address.
	;;^DD(161.2,2.5,0)
	;;=STREET ADDRESS 2^F^^0;14^K:$L(X)>30!($L(X)<2) X
	;;^DD(161.2,2.5,3)
	;;=ANSWER MUST BE 2-30 CHARACTERS IN LENGTH
	;;^DD(161.2,2.5,21,0)
	;;=^^1^1^2880616^^
	;;^DD(161.2,2.5,21,1,0)
	;;=Second line of vendor's street address.
	;;^DD(161.2,2.5,"DT")
	;;=2860324
	;;^DD(161.2,3,0)
	;;=CITY^RF^^0;4^K:$L(X)>33!($L(X)<1) X
	;;^DD(161.2,3,3)
	;;=Answer must be 1-33 characters in length.
	;;^DD(161.2,3,21,0)
	;;=^^1^1^2880617^^^
	;;^DD(161.2,3,21,1,0)
	;;=City in which the vendor's mailing address is located.
	;;^DD(161.2,3,"DT")
	;;=2931021
	;;^DD(161.2,4,0)
	;;=STATE^RP5'^DIC(5,^0;5^Q
	;;^DD(161.2,4,1,0)
	;;=^.1
	;;^DD(161.2,4,1,1,0)
	;;=^^TRIGGER^161.2^5.5
	;;^DD(161.2,4,1,1,1)
	;;=Q
	;;^DD(161.2,4,1,1,2)
	;;=K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^FBAAV(D0,0)):^(0),1:"") S X=$P(Y(1),U,13) S DIU=X K Y S X=DIV S X="" X ^DD(161.2,4,1,1,2.4)
	;;^DD(161.2,4,1,1,2.4)
	;;=S DIH=$S($D(^FBAAV(DIV(0),0)):^(0),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,12,99))  S DIH=DIH_U" S %=$P(DIH,U,14,999),DIU=$P(DIH,U,13),^(0)=$P(DIH,U,1,12)_U_DIV_$S(%]"":U_%,1:""),DIH=161.2,DIG=5.5 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(161.2,4,1,1,"CREATE VALUE")
	;;=NO EFFECT
	;;^DD(161.2,4,1,1,"DELETE VALUE")
	;;=@
	;;^DD(161.2,4,1,1,"FIELD")
	;;=COUNTY
	;;^DD(161.2,4,21,0)
	;;=^^1^1^2880616^^
	;;^DD(161.2,4,21,1,0)
	;;=State in which the vendor's mailing address is located.
	;;^DD(161.2,4,"DT")
	;;=2931021
	;;^DD(161.2,5,0)
	;;=ZIP CODE^RFX^^0;6^K:$L(X)<5!(X'?5N.E)!($L(X)>5&(X'?5N1"-"4N))!(X?5"0") X
	;;^DD(161.2,5,3)
	;;=Answer must be 5-10 characters in length in 12345-1234 format.
	;;^DD(161.2,5,21,0)
	;;=^^1^1^2880616^^
	;;^DD(161.2,5,21,1,0)
	;;=Zip Code in which the vendor's mailing address is located.
	;;^DD(161.2,5,"DT")
	;;=2931022
	;;^DD(161.2,5.18,0)
	;;=MAIL ROUTE CODE^F^^0;18^K:$L(X)>2!($L(X)<2)!'(X?2N) X
	;;^DD(161.2,5.18,3)
	;;=Answer must be 2 numerics in length.
	;;^DD(161.2,5.18,21,0)
	;;=^^2^2^2930301^
	;;^DD(161.2,5.18,21,1,0)
	;;=This field will eventually be populated with the Postal Service mail
	;;^DD(161.2,5.18,21,2,0)
	;;=router.
	;;^DD(161.2,5.18,23,0)
	;;=^^1^1^2930301^
	;;^DD(161.2,5.18,23,1,0)
	;;=This field will hold the "plus 2" in Zip+4+2.
	;;^DD(161.2,5.18,"DT")
	;;=2930301
	;;^DD(161.2,5.5,0)
	;;=COUNTY^RNJ4,0XO^^0;13^S Z0=$S($P(^FBAAV(D0,0),"^",5)]"":$P(^(0),"^",5),1:0) K:'Z0 X Q:'Z0!'$D(^DIC(5,Z0,1,0))  S DIC="^DIC(5,Z0,1,",DIC(0)="QEMN" D ^DIC S X=+Y K:Y'>0 X K Z0,DIC
	;;^DD(161.2,5.5,2)
	;;=S Y(0)=Y S Y(0)=Y Q:Y']""  S Z0=$S($D(^FBAAV(D0,0)):+$P(^(0),"^",5),1:"") Q:'Z0  S Y=$P($S($D(^DIC(5,Z0,1,Y,0)):^(0),1:""),"^",1)
	;;^DD(161.2,5.5,2.1)
	;;=S Y(0)=Y Q:Y']""  S Z0=$S($D(^FBAAV(D0,0)):+$P(^(0),"^",5),1:"") Q:'Z0  S Y=$P($S($D(^DIC(5,Z0,1,Y,0)):^(0),1:""),"^",1)

FBINI008
FBINI008	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.2,5.5,3)
	;;=Enter the county  or county code (whole number between 1 and 9999).  The counties are based upon the value for STATE.
	;;^DD(161.2,5.5,4)
	;;=S FBZD=D,X="?",Z0=$S($P(^FBAAV(D0,0),"^",5)]"":$P(^(0),"^",5),1:0) Q:'Z0!'$D(^DIC(5,Z0,1,0))  S DIC="^DIC(5,Z0,1,",DIC(0)="QEM" D ^DIC S DIC=DIE,D=FBZD K FBZD
	;;^DD(161.2,5.5,5,1,0)
	;;=161.2^4^1
	;;^DD(161.2,5.5,21,0)
	;;=^^1^1^2930818^^
	;;^DD(161.2,5.5,21,1,0)
	;;=The County in which the vendor is located.
	;;^DD(161.2,5.5,"DT")
	;;=2930916
	;;^DD(161.2,6,0)
	;;=TYPE OF VENDOR^RS^1:PUBLIC HOSPITAL;2:PHYSICIAN;3:PHARMACY;4:PROSTHETICS;5:TRAVEL;6:RADIOLOGY;7:LABORATORY;8:OTHER;9:PRIVATE HOSPITAL;10:FEDERAL HOSPITAL;^0;7^Q
	;;^DD(161.2,6,1,0)
	;;=^.1^^0
	;;^DD(161.2,6,21,0)
	;;=^^2^2^2900622^^^^
	;;^DD(161.2,6,21,1,0)
	;;=Identifies the type of services this vendor provides.  
	;;^DD(161.2,6,21,2,0)
	;;=(ie HOSPITAL, PHYSICIAN, OR PHARMACY)
	;;^DD(161.2,6,"DT")
	;;=2900817
	;;^DD(161.2,7,0)
	;;=PART CODE^RP161.81'^FBAA(161.81,^0;9^Q
	;;^DD(161.2,7,3)
	;;=
	;;^DD(161.2,7,21,0)
	;;=^^2^2^2880608^^
	;;^DD(161.2,7,21,1,0)
	;;=This field is a pointer to the Participation code file which is
	;;^DD(161.2,7,21,2,0)
	;;=a description of the type of vendor.
	;;^DD(161.2,7,"DT")
	;;=2860501
	;;^DD(161.2,8,0)
	;;=CHAIN^FX^^0;10^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>4!($L(X)<3)!(X'?3N.1N) X
	;;^DD(161.2,8,1,0)
	;;=^.1
	;;^DD(161.2,8,1,1,0)
	;;=161.2^AD^MUMPS
	;;^DD(161.2,8,1,1,1)
	;;=S:$P(^FBAAV(DA,0),U,2) ^FBAAV("AD",$P(^(0),U,2)_$E("0000",$L(X)+1,4)_X,DA)=""
	;;^DD(161.2,8,1,1,2)
	;;=K:$P(^FBAAV(DA,0),U,2) ^FBAAV("AD",$P(^(0),U,2)_$E("0000",$L(X)+1,4)_X,DA)
	;;^DD(161.2,8,1,1,"%D",0)
	;;=^^3^3^2930514^^^^
	;;^DD(161.2,8,1,1,"%D",1,0)
	;;=Sets up mumps X-Ref on the Chain Store field using vendor id_chain store
	;;^DD(161.2,8,1,1,"%D",2,0)
	;;=combination.  Used for lookups for pharmacy vendors when receiving MRA's
	;;^DD(161.2,8,1,1,"%D",3,0)
	;;=back from Austin.
	;;^DD(161.2,8,1,1,"DT")
	;;=2930323
	;;^DD(161.2,8,3)
	;;=Answer must be 3-4 numerics.
	;;^DD(161.2,8,21,0)
	;;=^^2^2^2880608^^
	;;^DD(161.2,8,21,1,0)
	;;=This is a number that pharmacies use to identify multiple
	;;^DD(161.2,8,21,2,0)
	;;=stores in the chain.
	;;^DD(161.2,8,"DT")
	;;=2930323
	;;^DD(161.2,9,0)
	;;=AUSTIN DELETED^S^Y:YES;^ADEL;1^Q
	;;^DD(161.2,9,21,0)
	;;=^^3^3^2930223^
	;;^DD(161.2,9,21,1,0)
	;;= 
	;;^DD(161.2,9,21,2,0)
	;;=This is a flag that is set by the fee software when a delete
	;;^DD(161.2,9,21,3,0)
	;;=vendor master record adjustment is transmitted to Austin.
	;;^DD(161.2,9,"DT")
	;;=2930223
	;;^DD(161.2,12,0)
	;;=DATE LAST CORRECTION TO AUSTIN^D^^ADEL;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.2,12,1,0)
	;;=^.1
	;;^DD(161.2,12,1,1,0)
	;;=161.2^AC
	;;^DD(161.2,12,1,1,1)
	;;=S ^FBAAV("AC",$E(X,1,30),DA)=""
	;;^DD(161.2,12,1,1,2)
	;;=K ^FBAAV("AC",$E(X,1,30),DA)
	;;^DD(161.2,12,1,1,"%D",0)
	;;=^^2^2^2930309^
	;;^DD(161.2,12,1,1,"%D",1,0)
	;;=Allows for the retrieval of when the last correction was sent to
	;;^DD(161.2,12,1,1,"%D",2,0)
	;;=Austin via master record transaction.
	;;^DD(161.2,12,1,1,"DT")
	;;=2930309
	;;^DD(161.2,12,21,0)
	;;=^^3^3^2930828^^
	;;^DD(161.2,12,21,1,0)
	;;= 
	;;^DD(161.2,12,21,2,0)
	;;=This field contains the date the last master record adjustment
	;;^DD(161.2,12,21,3,0)
	;;=was sent to Austin for this vendor.
	;;^DD(161.2,12,23,0)
	;;=^^1^1^2930828^
	;;^DD(161.2,12,23,1,0)
	;;= 
	;;^DD(161.2,12,"DT")
	;;=2930309
	;;^DD(161.2,12.1,0)
	;;=DATE LAST UPDATE FROM AUSTIN^D^^ADEL;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.2,12.1,3)
	;;=Date the last master record adjustment was received from Austin for this vendor.
	;;^DD(161.2,12.1,21,0)
	;;=^^3^3^2930828^
	;;^DD(161.2,12.1,21,1,0)
	;;=This field contains the date the last master record adjustment was received from Austin for this vendor.
	;;^DD(161.2,12.1,21,2,0)
	;;=  
	;;^DD(161.2,12.1,21,3,0)
	;;=This field is updated as the record is processed by the server.
	;;^DD(161.2,12.1,"DT")
	;;=2930828
	;;^DD(161.2,13,0)
	;;=DATE OF AUSTIN DELETE^D^^ADEL;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X

FBINI009
FBINI009	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.2,13,21,0)
	;;=^^2^2^2930223^
	;;^DD(161.2,13,21,1,0)
	;;=This field contains the date that a delete master record transaction
	;;^DD(161.2,13,21,2,0)
	;;=was sent to Austin, for this vendor.
	;;^DD(161.2,13,"DT")
	;;=2930223
	;;^DD(161.2,13.1,0)
	;;=STATION AFFECTING LAST CHANGE^F^^ADEL;5^K:$L(X)>3!($L(X)<3) X
	;;^DD(161.2,13.1,3)
	;;=Answer must be 3 numerics in length.
	;;^DD(161.2,13.1,21,0)
	;;=^^5^5^2941130^
	;;^DD(161.2,13.1,21,1,0)
	;;=This field stores the station number that made the
	;;^DD(161.2,13.1,21,2,0)
	;;=last change to the vendor.  If the station number
	;;^DD(161.2,13.1,21,3,0)
	;;=is set to '000', that means the change was picked
	;;^DD(161.2,13.1,21,4,0)
	;;=up off the 'VLOG' file in Austin and affected by
	;;^DD(161.2,13.1,21,5,0)
	;;=a non-fee system.
	;;^DD(161.2,13.1,"DT")
	;;=2941130
	;;^DD(161.2,14,0)
	;;=PHONE NUMBER^F^^1;1^K:$L(X)>20!($L(X)<3) X
	;;^DD(161.2,14,3)
	;;=ANSWER MUST BE 3-20 CHARACTERS IN LENGTH
	;;^DD(161.2,14,21,0)
	;;=^^2^2^2941011^^^
	;;^DD(161.2,14,21,1,0)
	;;=This field allows the user to enter the telephone
	;;^DD(161.2,14,21,2,0)
	;;=number of the vendor.
	;;^DD(161.2,14,"DT")
	;;=2870602
	;;^DD(161.2,16,0)
	;;=*NUMBER OF SKILLED BEDS^NJ3,0^^1;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
	;;^DD(161.2,16,3)
	;;=Type a Number between 0 and 999, 0 Decimal Digits
	;;^DD(161.2,16,21,0)
	;;=^^2^2^2940714^
	;;^DD(161.2,16,21,1,0)
	;;=This field is no longer supported.
	;;^DD(161.2,16,21,2,0)
	;;=The number of beds the nursing home has at the skilled rate.
	;;^DD(161.2,16,"DT")
	;;=2940714
	;;^DD(161.2,17,0)
	;;=*NUMBER OF INTERMEDIATE BEDS^NJ3,0^^1;3^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
	;;^DD(161.2,17,3)
	;;=Type a Number between 0 and 999, 0 Decimal Digits
	;;^DD(161.2,17,21,0)
	;;=^^2^2^2940714^
	;;^DD(161.2,17,21,1,0)
	;;=This field is no longer supported.
	;;^DD(161.2,17,21,2,0)
	;;=The number of beds the nursing home has at the skilled rate.
	;;^DD(161.2,17,"DT")
	;;=2940714
	;;^DD(161.2,18,0)
	;;=INSPECTED/ACCREDITED^RS^I:INSPECTED BY VA;A:ACCREDITED BY JCAH;B:BOTH INSPECTED AND ACCREDITED;^1;4^Q
	;;^DD(161.2,18,21,0)
	;;=^^2^2^2930519^
	;;^DD(161.2,18,21,1,0)
	;;=This field allows the user to track the status of the CNH as of
	;;^DD(161.2,18,21,2,0)
	;;=the last assesment.
	;;^DD(161.2,18,"DT")
	;;=2880902
	;;^DD(161.2,19,0)
	;;=CERTIFIED MEDICARE/MEDICAID^RS^1:NOT CERTIFIED FOR EITHER;2:CERTIFIED FOR MEDICARE;3:CERTIFIED FOR MEDICAID;4:CERTIFIED FOR BOTH;^1;5^Q
	;;^DD(161.2,19,21,0)
	;;=^^1^1^2930514^^
	;;^DD(161.2,19,21,1,0)
	;;=Indicates that the Nursing Home has been certified by Medicare/Medicaid.
	;;^DD(161.2,19,"DT")
	;;=2900514
	;;^DD(161.2,20,0)
	;;=DATE OF LAST ASSESSMENT^DX^^1;6^S %DT="EX",%DT(0)="-"_DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(161.2,20,21,0)
	;;=^^2^2^2930514^^
	;;^DD(161.2,20,21,1,0)
	;;=The date that the nursing home was last evaluated by either a partial or
	;;^DD(161.2,20,21,2,0)
	;;=full VA team.
	;;^DD(161.2,20,"DT")
	;;=2900514
	;;^DD(161.2,21,0)
	;;=*LEVELS OF CARE PROVIDED^S^S:SKILLED;I:INTERMEDIATE;B:BOTH;^1;7^Q
	;;^DD(161.2,21,"DT")
	;;=2940714
	;;^DD(161.2,22,0)
	;;=MEDICARE ID NUMBER^F^^0;17^K:$L(X)>6!($L(X)<6) X
	;;^DD(161.2,22,3)
	;;=Answer must be 6 characters in length.
	;;^DD(161.2,22,21,0)
	;;=^^1^1^2930514^
	;;^DD(161.2,22,21,1,0)
	;;=The Medicare Provider ID number assigned to this vendor.
	;;^DD(161.2,22,"DT")
	;;=2940713
	;;^DD(161.2,23,0)
	;;=FAX NUMBER^F^^1;9^K:$L(X)>20!($L(X)<3) X
	;;^DD(161.2,23,3)
	;;=Answer must be 3-20 characters in length.
	;;^DD(161.2,23,21,0)
	;;=^^2^2^2941130^^
	;;^DD(161.2,23,21,1,0)
	;;=This field allows the user to enter the fax
	;;^DD(161.2,23,21,2,0)
	;;=number of the vendor.
	;;^DD(161.2,23,"DT")
	;;=2941011
	;;^DD(161.2,30.01,0)
	;;=AUSTIN NAME FIELD^FX^^AMS;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<2)!'(X'?1P.E) X
	;;^DD(161.2,30.01,1,0)
	;;=^.1
	;;^DD(161.2,30.01,1,1,0)
	;;=161.2^D
	;;^DD(161.2,30.01,1,1,1)
	;;=S ^FBAAV("D",$E(X,1,30),DA)=""
	;;^DD(161.2,30.01,1,1,2)
	;;=K ^FBAAV("D",$E(X,1,30),DA)
	;;^DD(161.2,30.01,1,1,"%D",0)
	;;=^^3^3^2930519^^

FBINI00A
FBINI00A	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.2,30.01,1,1,"%D",1,0)
	;;=This field, populated by the data returned from Austin contains
	;;^DD(161.2,30.01,1,1,"%D",2,0)
	;;=a match with central fee and FMS name fields.  It will allow
	;;^DD(161.2,30.01,1,1,"%D",3,0)
	;;=the user to lookup vendors both ways.
	;;^DD(161.2,30.01,1,1,"DT")
	;;=2930309
	;;^DD(161.2,30.01,3)
	;;=Answer must be 2-30 characters in length.
	;;^DD(161.2,30.01,21,0)
	;;=^^2^2^2930519^^^^
	;;^DD(161.2,30.01,21,1,0)
	;;=This field is populated by the software.  It reflects the vendor name
	;;^DD(161.2,30.01,21,2,0)
	;;=as it is on the centralized Austin databases.
	;;^DD(161.2,30.01,23,0)
	;;=^^4^4^2930519^^^
	;;^DD(161.2,30.01,23,1,0)
	;;=This field is populated by the background server.  It contains the
	;;^DD(161.2,30.01,23,2,0)
	;;=vendor name as entered into the FMS vendor table in Austin.  Until
	;;^DD(161.2,30.01,23,3,0)
	;;=this field is populated, no payments can be sent to Austin for
	;;^DD(161.2,30.01,23,4,0)
	;;=processing.
	;;^DD(161.2,30.01,"DT")
	;;=2930309
	;;^DD(161.2,30.02,0)
	;;=PRICER EXEMPT^FXO^^AMS;2^I $D(X) D YN^FBAAUTL3
	;;^DD(161.2,30.02,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.2,30.02,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.2,30.02,3)
	;;=Answer 'Yes' or '1' for YES and a 'No' or '0' for NO.
	;;^DD(161.2,30.02,21,0)
	;;=^^2^2^2930519^^
	;;^DD(161.2,30.02,21,1,0)
	;;=There are certain vendors that are exempt from the medicare payment
	;;^DD(161.2,30.02,21,2,0)
	;;=methodology and are paid at a percentage of what is claimed.
	;;^DD(161.2,30.02,23,0)
	;;=^^2^2^2930519^^
	;;^DD(161.2,30.02,23,1,0)
	;;=This flag will tell the software that any inpatient payments made
	;;^DD(161.2,30.02,23,2,0)
	;;=to this vendor will not pass through the Austin Pricer system.
	;;^DD(161.2,30.02,"DT")
	;;=2940318
	;;^DD(161.2,30.03,0)
	;;=1099 VENDOR^FXO^^AMS;3^I $D(X) D YN^FBAAUTL3
	;;^DD(161.2,30.03,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.2,30.03,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.2,30.03,3)
	;;=Answer 'Yes' or '1' for YES and a 'No' or '0' for NO.
	;;^DD(161.2,30.03,21,0)
	;;=^^3^3^2930519^^
	;;^DD(161.2,30.03,21,1,0)
	;;=This is a flag that tells the central vendor unit is Austin whether
	;;^DD(161.2,30.03,21,2,0)
	;;=or not a 1099 tax form should be sent to the vendor.  At this time
	;;^DD(161.2,30.03,21,3,0)
	;;=a decision from finance is that all Fee vendors are 1099 vendors.
	;;^DD(161.2,30.03,23,0)
	;;=^^3^3^2930519^^
	;;^DD(161.2,30.03,23,1,0)
	;;=This is a flag, that will always be set to yes currrently.  If
	;;^DD(161.2,30.03,23,2,0)
	;;=finance should change their position on 1099 vendors, this flag
	;;^DD(161.2,30.03,23,3,0)
	;;=will be used to notify Austin which vendors should receive 1099s.
	;;^DD(161.2,30.03,"DT")
	;;=2940318
	;;^DD(161.2,30.04,0)
	;;=FMS VENDOR TYPE^S^C:commercial;I:individual;F:federal;^AMS;4^Q
	;;^DD(161.2,30.04,21,0)
	;;=^^2^2^2930301^
	;;^DD(161.2,30.04,21,1,0)
	;;=This field is sent with other vendor data to let the central vendorizing
	;;^DD(161.2,30.04,21,2,0)
	;;=unit know the type of vendor for the FMS vendor table.
	;;^DD(161.2,30.04,23,0)
	;;=^^2^2^2930301^
	;;^DD(161.2,30.04,23,1,0)
	;;=This set of codes that will be determined by field 6 ('Type of Vendor').
	;;^DD(161.2,30.04,23,2,0)
	;;=It is a manditory data element with the FMS vendor table.
	;;^DD(161.2,30.04,"DT")
	;;=2930301
	;;^DD(161.2,30.05,0)
	;;=PROVIDER CODE^S^B:both;V:vendor only;P:provider only;^AMS;5^Q
	;;^DD(161.2,30.05,21,0)
	;;=^^3^3^2930514^^
	;;^DD(161.2,30.05,21,1,0)
	;;=This flag is a mandatory field on the FMS vendor table.
	;;^DD(161.2,30.05,21,2,0)
	;;=Choices are V for VENDOR ONLY, P for PROVIDER ONLY or
	;;^DD(161.2,30.05,21,3,0)
	;;=B for both.  All Fee vendors are classified as both.
	;;^DD(161.2,30.05,23,0)
	;;=^^1^1^2930514^^
	;;^DD(161.2,30.05,23,1,0)
	;;=Currently always set to 'B' by the software.
	;;^DD(161.2,30.05,"DT")
	;;=2930301
	;;^DD(161.2,30.06,0)
	;;=TAX ID/SSN FLAG^RS^T:TAX ID NUMBER;S:SSN NUMBER;^AMS;6^Q
	;;^DD(161.2,30.06,.1)
	;;=TAX ID/SSN (Enter 'T' or 'S')
	;;^DD(161.2,30.06,21,0)
	;;=^^3^3^2930301^

FBINI00B
FBINI00B	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.2,30.06,21,1,0)
	;;=This field will be populated and sent to central vendorizing unit
	;;^DD(161.2,30.06,21,2,0)
	;;=to notify the IRS if the 'ID NUMBER' is a Tax ID number or the
	;;^DD(161.2,30.06,21,3,0)
	;;=vendor's SSN number.
	;;^DD(161.2,30.06,23,0)
	;;=^^2^2^2930301^
	;;^DD(161.2,30.06,23,1,0)
	;;=Flag used by the FMS vendor table to know if the ID NUMBER sent to
	;;^DD(161.2,30.06,23,2,0)
	;;=the table is a TAX ID number or SSN number.
	;;^DD(161.2,30.06,"DT")
	;;=2930305

FBINI00C
FBINI00C	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.21)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.21,0,"GL")
	;;=^FBAA(161.21,
	;;^DIC("B","FEE BASIS CNH CONTRACT",161.21)
	;;=
	;;^DIC(161.21,"%D",0)
	;;=^^3^3^2940622^^^^
	;;^DIC(161.21,"%D",1,0)
	;;=This file contains CNH vendor contract information.
	;;^DIC(161.21,"%D",2,0)
	;;= 
	;;^DIC(161.21,"%D",3,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.21,0)
	;;=FIELD^^.04^4
	;;^DD(161.21,0,"DDA")
	;;=N
	;;^DD(161.21,0,"DT")
	;;=2930303
	;;^DD(161.21,0,"ID",.02)
	;;=W ""
	;;^DD(161.21,0,"ID",.03)
	;;=W ""
	;;^DD(161.21,0,"IX","AC",161.21,.04)
	;;=
	;;^DD(161.21,0,"IX","AC1",161.21,.02)
	;;=
	;;^DD(161.21,0,"IX","ACR",161.21,.04)
	;;=
	;;^DD(161.21,0,"IX","ACR1",161.21,.02)
	;;=
	;;^DD(161.21,0,"IX","ADR",161.21,.04)
	;;=
	;;^DD(161.21,0,"IX","ADR1",161.21,.03)
	;;=
	;;^DD(161.21,0,"IX","B",161.21,.01)
	;;=
	;;^DD(161.21,0,"IX","C",161.21,.04)
	;;=
	;;^DD(161.21,0,"NM","FEE BASIS CNH CONTRACT")
	;;=
	;;^DD(161.21,0,"PT",161.22,.03)
	;;=
	;;^DD(161.21,.01,0)
	;;=NUMBER^RFX^^0;1^K:$L(X)>15!($L(X)<3)!'(X'?1P.E) X I $D(X),$D(^FBAA(161.21,"B",X)) W !,*7,"Contract already exists for another vendor.",! K X
	;;^DD(161.21,.01,1,0)
	;;=^.1
	;;^DD(161.21,.01,1,1,0)
	;;=161.21^B
	;;^DD(161.21,.01,1,1,1)
	;;=S ^FBAA(161.21,"B",$E(X,1,30),DA)=""
	;;^DD(161.21,.01,1,1,2)
	;;=K ^FBAA(161.21,"B",$E(X,1,30),DA)
	;;^DD(161.21,.01,3)
	;;=Answer must be 3-15 characters in length.
	;;^DD(161.21,.01,21,0)
	;;=^^2^2^2930303^
	;;^DD(161.21,.01,21,1,0)
	;;=This is the Contract number assigned by contracting for the
	;;^DD(161.21,.01,21,2,0)
	;;=Community Nursing Home.
	;;^DD(161.21,.01,"DEL",.01,0)
	;;=I $D(^FBAA(161.22,"AC",DA)) W !,*7,"You cannot delete a contract that has rates associated with it.",!
	;;^DD(161.21,.01,"DT")
	;;=2930903
	;;^DD(161.21,.02,0)
	;;=EFFECTIVE DATE^RDX^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X) D CONDAT^FBAAUTL2
	;;^DD(161.21,.02,1,0)
	;;=^.1
	;;^DD(161.21,.02,1,1,0)
	;;=161.21^ACR1^MUMPS
	;;^DD(161.21,.02,1,1,1)
	;;=S:$P(^FBAA(161.21,DA,0),U,4) ^FBAA(161.21,"ACR",$P(^(0),U,4),-$E(X,1,30),DA)=""
	;;^DD(161.21,.02,1,1,2)
	;;=K:$P(^FBAA(161.21,DA,0),U,4) ^FBAA(161.21,"ACR",$P(^(0),U,4),-$E(X,1,30),DA)
	;;^DD(161.21,.02,1,1,"%D",0)
	;;=^^1^1^2930514^^^^
	;;^DD(161.21,.02,1,1,"%D",1,0)
	;;=update the 'ACR' cross-reference on the vendor field (.04).
	;;^DD(161.21,.02,1,1,"DT")
	;;=2930308
	;;^DD(161.21,.02,1,2,0)
	;;=161.21^AC1^MUMPS
	;;^DD(161.21,.02,1,2,1)
	;;=S:$P(^FBAA(161.21,DA,0),U,4) ^FBAA(161.21,"AC",$P(^(0),U,4),$E(X,1,30),DA)=""
	;;^DD(161.21,.02,1,2,2)
	;;=K:$P(^FBAA(161.21,DA,0),U,4) ^FBAA(161.21,"AC",$P(^(0),U,4),$E(X,1,30),DA)
	;;^DD(161.21,.02,1,2,"%D",0)
	;;=^^1^1^2930514^^^
	;;^DD(161.21,.02,1,2,"%D",1,0)
	;;=This will keep the 'AC' x-ref on the vendor field updated.
	;;^DD(161.21,.02,1,2,"DT")
	;;=2930325
	;;^DD(161.21,.02,21,0)
	;;=^^1^1^2930303^^
	;;^DD(161.21,.02,21,1,0)
	;;=This is the beginning date of the contract.
	;;^DD(161.21,.02,"DT")
	;;=2930325
	;;^DD(161.21,.03,0)
	;;=EXPIRATION DATE^RDX^^0;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X) D CONDAT^FBAAUTL2 I $D(X),$P(^FBAA(161.21,DA,0),U,2)>X K X W !!,"Expiration date must be after the effective date.",!
	;;^DD(161.21,.03,1,0)
	;;=^.1
	;;^DD(161.21,.03,1,1,0)
	;;=161.21^ADR1^MUMPS
	;;^DD(161.21,.03,1,1,1)
	;;=S:$P(^FBAA(161.21,DA,0),U,4) ^FBAA(161.21,"ADR",$P(^(0),U,4),-$E(X,1,30),DA)=""
	;;^DD(161.21,.03,1,1,2)
	;;=K:$P(^FBAA(161.21,DA,0),U,4) ^FBAA(161.21,"ADR",$P(^(0),U,4),-X,DA)
	;;^DD(161.21,.03,1,1,"%D",0)
	;;=^^1^1^2930514^^^^
	;;^DD(161.21,.03,1,1,"%D",1,0)
	;;=Updates the vendor cross-reference if the expiration date is changed.
	;;^DD(161.21,.03,1,1,"DT")
	;;=2930303
	;;^DD(161.21,.03,21,0)
	;;=^^1^1^2930303^
	;;^DD(161.21,.03,21,1,0)
	;;=This is the date the contract expires.
	;;^DD(161.21,.03,"DT")
	;;=2930308
	;;^DD(161.21,.04,0)
	;;=VENDOR^RP161.2'^FBAAV(^0;4^Q
	;;^DD(161.21,.04,1,0)
	;;=^.1
	;;^DD(161.21,.04,1,1,0)
	;;=161.21^C
	;;^DD(161.21,.04,1,1,1)
	;;=S ^FBAA(161.21,"C",$E(X,1,30),DA)=""
	;;^DD(161.21,.04,1,1,2)
	;;=K ^FBAA(161.21,"C",$E(X,1,30),DA)
	;;^DD(161.21,.04,1,1,"%D",0)
	;;=^^1^1^2930303^

FBINI00D
FBINI00D	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.21)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.21,.04,1,1,"%D",1,0)
	;;=This cross-reference allows look-up by vendor.
	;;^DD(161.21,.04,1,1,"DT")
	;;=2930303
	;;^DD(161.21,.04,1,2,0)
	;;=161.21^ADR^MUMPS
	;;^DD(161.21,.04,1,2,1)
	;;=S:$P(^FBAA(161.21,DA,0),U,3) ^FBAA(161.21,"ADR",$E(X,1,30),-$P(^(0),U,3),DA)=""
	;;^DD(161.21,.04,1,2,2)
	;;=K:$P(^FBAA(161.21,DA,0),U,3) ^FBAA(161.21,"ADR",X,-$P(^(0),U,3),DA)
	;;^DD(161.21,.04,1,2,"%D",0)
	;;=^^2^2^2930514^^^^
	;;^DD(161.21,.04,1,2,"%D",1,0)
	;;=Cross-reference by vendor, negative date. Used to retrieve the latest
	;;^DD(161.21,.04,1,2,"%D",2,0)
	;;=contract for a vendor.
	;;^DD(161.21,.04,1,2,"DT")
	;;=2930303
	;;^DD(161.21,.04,1,3,0)
	;;=161.21^ACR^MUMPS
	;;^DD(161.21,.04,1,3,1)
	;;=S:$P(^FBAA(161.21,DA,0),U,2) ^FBAA(161.21,"ACR",$E(X,1,30),-$P(^(0),U,2),DA)=""
	;;^DD(161.21,.04,1,3,2)
	;;=K:$P(^FBAA(161.21,DA,0),U,2) ^FBAA(161.21,"ACR",X,-$P(^(0),U,2),DA)
	;;^DD(161.21,.04,1,3,"%D",0)
	;;=^^1^1^2930514^^
	;;^DD(161.21,.04,1,3,"%D",1,0)
	;;=Inverse date order cross-reference vendor, from date of contract.
	;;^DD(161.21,.04,1,3,"DT")
	;;=2930308
	;;^DD(161.21,.04,1,4,0)
	;;=161.21^AC^MUMPS
	;;^DD(161.21,.04,1,4,1)
	;;=S:$P(^FBAA(161.21,DA,0),U,2) ^FBAA(161.21,"AC",X,$P(^(0),U,2),DA)=""
	;;^DD(161.21,.04,1,4,2)
	;;=K:$P(^FBAA(161.21,DA,0),U,2) ^FBAA(161.21,"AC",X,$P(^(0),U,2),DA)
	;;^DD(161.21,.04,1,4,"%D",0)
	;;=^^2^2^2930514^^
	;;^DD(161.21,.04,1,4,"%D",1,0)
	;;=used to find next available contract when multiple contracts involved
	;;^DD(161.21,.04,1,4,"%D",2,0)
	;;=with an authorization period.
	;;^DD(161.21,.04,1,4,"DT")
	;;=2930325
	;;^DD(161.21,.04,21,0)
	;;=^^1^1^2930303^
	;;^DD(161.21,.04,21,1,0)
	;;=Contains the vendor for which the contract applies.
	;;^DD(161.21,.04,"DT")
	;;=2930325

FBINI00E
FBINI00E	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.22)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.22,0,"GL")
	;;=^FBAA(161.22,
	;;^DIC("B","FEE BASIS CNH RATE",161.22)
	;;=
	;;^DIC(161.22,"%D",0)
	;;=^^5^5^2940622^^^
	;;^DIC(161.22,"%D",1,0)
	;;=This file contains all the negotiated rates for CNH vendors.
	;;^DIC(161.22,"%D",2,0)
	;;=The file was created to handle multiple rates for a single
	;;^DIC(161.22,"%D",3,0)
	;;=nursing home.
	;;^DIC(161.22,"%D",4,0)
	;;= 
	;;^DIC(161.22,"%D",5,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.22,0)
	;;=FIELD^^.03^3
	;;^DD(161.22,0,"DT")
	;;=2930303
	;;^DD(161.22,0,"IX","AC",161.22,.03)
	;;=
	;;^DD(161.22,0,"IX","AD",161.22,.03)
	;;=
	;;^DD(161.22,0,"IX","AD1",161.22,.02)
	;;=
	;;^DD(161.22,0,"NM","FEE BASIS CNH RATE")
	;;=
	;;^DD(161.22,.01,0)
	;;=NUMBER^RNJ7,0^^0;1^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.22,.01,1,0)
	;;=^.1^^0
	;;^DD(161.22,.01,3)
	;;=Type a Number between 1 and 9999999, 0 Decimal Digits
	;;^DD(161.22,.01,21,0)
	;;=^^2^2^2930519^^
	;;^DD(161.22,.01,21,1,0)
	;;=This field is a system generated number.  It has no meaning other
	;;^DD(161.22,.01,21,2,0)
	;;=than to make the entry unique.
	;;^DD(161.22,.01,"DT")
	;;=2930303
	;;^DD(161.22,.02,0)
	;;=DOLLAR AMOUNT^RNJ10,2^^0;2^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999999.99)!(X<.01) X
	;;^DD(161.22,.02,1,0)
	;;=^.1
	;;^DD(161.22,.02,1,1,0)
	;;=161.22^AD1^MUMPS
	;;^DD(161.22,.02,1,1,1)
	;;=S:$P(^FBAA(161.22,DA,0),U,3) ^FBAA(161.22,"AD",$P(^(0),U,3),$E(X,1,30),DA)=""
	;;^DD(161.22,.02,1,1,2)
	;;=K:$P(^FBAA(161.22,DA,0),U,3) ^FBAA(161.22,"AD",$P(^(0),U,3),$E(X,1,30),DA)
	;;^DD(161.22,.02,1,1,"%D",0)
	;;=^^1^1^2930514^^
	;;^DD(161.22,.02,1,1,"%D",1,0)
	;;=This is a check to maintain the integrity of the 'AD' x-ref on field .03.
	;;^DD(161.22,.02,1,1,"DT")
	;;=2930308
	;;^DD(161.22,.02,3)
	;;=Type a Dollar Amount between .01 and 9999999.99, 2 Decimal Digits
	;;^DD(161.22,.02,21,0)
	;;=^^1^1^2930303^
	;;^DD(161.22,.02,21,1,0)
	;;=This field contains the dollar amounts associated with a contract.
	;;^DD(161.22,.02,"DT")
	;;=2930308
	;;^DD(161.22,.03,0)
	;;=CONTRACT^RP161.21'^FBAA(161.21,^0;3^Q
	;;^DD(161.22,.03,1,0)
	;;=^.1
	;;^DD(161.22,.03,1,1,0)
	;;=161.22^AC
	;;^DD(161.22,.03,1,1,1)
	;;=S ^FBAA(161.22,"AC",$E(X,1,30),DA)=""
	;;^DD(161.22,.03,1,1,2)
	;;=K ^FBAA(161.22,"AC",$E(X,1,30),DA)
	;;^DD(161.22,.03,1,1,"%D",0)
	;;=^^1^1^2930303^
	;;^DD(161.22,.03,1,1,"%D",1,0)
	;;=Used to group all rates for a given contract together.
	;;^DD(161.22,.03,1,1,"DT")
	;;=2930303
	;;^DD(161.22,.03,1,2,0)
	;;=161.22^AD^MUMPS
	;;^DD(161.22,.03,1,2,1)
	;;=S:$P(^FBAA(161.22,DA,0),U,2) ^FBAA(161.22,"AD",X,$P(^(0),U,2),DA)=""
	;;^DD(161.22,.03,1,2,2)
	;;=K:$P(^FBAA(161.22,DA,0),U,2) ^FBAA(161.22,"AD",+$P(^(0),U,2),DA)
	;;^DD(161.22,.03,1,2,"%D",0)
	;;=^^2^2^2930514^^^^
	;;^DD(161.22,.03,1,2,"%D",1,0)
	;;=Used to make sure there is not the same rate entered twice for the
	;;^DD(161.22,.03,1,2,"%D",2,0)
	;;=same contract.
	;;^DD(161.22,.03,1,2,"DT")
	;;=2930308
	;;^DD(161.22,.03,21,0)
	;;=^^2^2^2930514^^^
	;;^DD(161.22,.03,21,1,0)
	;;=Contains the contract number associated with this rate as listed in the FEE
	;;^DD(161.22,.03,21,2,0)
	;;=Basis CNH Contract file.
	;;^DD(161.22,.03,"DT")
	;;=2930308

FBINI00F
FBINI00F	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.23)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.23,0,"GL")
	;;=^FBAA(161.23,
	;;^DIC("B","FEE BASIS CNH AUTHORIZATION RATE",161.23)
	;;=
	;;^DIC(161.23,"%D",0)
	;;=^^6^6^2940622^^^
	;;^DIC(161.23,"%D",1,0)
	;;=In order to keep track of rate changes for an authorization in
	;;^DIC(161.23,"%D",2,0)
	;;=the CNH program, this file was developed.  It stores the rate
	;;^DIC(161.23,"%D",3,0)
	;;=that is paid for an authorization time frame.  When new contracts
	;;^DIC(161.23,"%D",4,0)
	;;=are negotiated for a CNH new entries must be created in this file.
	;;^DIC(161.23,"%D",5,0)
	;;= 
	;;^DIC(161.23,"%D",6,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.23,0)
	;;=FIELD^^.06^6
	;;^DD(161.23,0,"DDA")
	;;=N
	;;^DD(161.23,0,"DT")
	;;=2930423
	;;^DD(161.23,0,"IX","AC",161.23,.03)
	;;=
	;;^DD(161.23,0,"IX","AD",161.23,.03)
	;;=
	;;^DD(161.23,0,"IX","ADR1",161.23,.02)
	;;=
	;;^DD(161.23,0,"IX","AE",161.23,.06)
	;;=
	;;^DD(161.23,0,"IX","AE1",161.23,.05)
	;;=
	;;^DD(161.23,0,"IX","B",161.23,.01)
	;;=
	;;^DD(161.23,0,"IX","C",161.23,.04)
	;;=
	;;^DD(161.23,0,"NM","FEE BASIS CNH AUTHORIZATION RATE")
	;;=
	;;^DD(161.23,.01,0)
	;;=FROM DATE^RD^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.23,.01,1,0)
	;;=^.1
	;;^DD(161.23,.01,1,1,0)
	;;=161.23^B
	;;^DD(161.23,.01,1,1,1)
	;;=S ^FBAA(161.23,"B",$E(X,1,30),DA)=""
	;;^DD(161.23,.01,1,1,2)
	;;=K ^FBAA(161.23,"B",$E(X,1,30),DA)
	;;^DD(161.23,.01,3)
	;;=
	;;^DD(161.23,.01,21,0)
	;;=^^1^1^2930303^
	;;^DD(161.23,.01,21,1,0)
	;;=This is the beginning date of the authorization rate.
	;;^DD(161.23,.01,"DT")
	;;=2930303
	;;^DD(161.23,.02,0)
	;;=TO DATE^RD^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.23,.02,1,0)
	;;=^.1
	;;^DD(161.23,.02,1,1,0)
	;;=161.23^ADR1^MUMPS
	;;^DD(161.23,.02,1,1,1)
	;;=S:$P(^FBAA(161.23,DA,0),U,3) ^FBAA(161.23,"AD",$E($P(^FBAA(161.23,DA,0),U,3),1,30),-X,DA)=""
	;;^DD(161.23,.02,1,1,2)
	;;=K:$P(^FBAA(161.23,DA,0),U,3) ^FBAA(161.23,"AD",$P(^FBAA(161.23,DA,0),U,3),-X,DA)
	;;^DD(161.23,.02,1,1,"%D",0)
	;;=^^2^2^2930514^
	;;^DD(161.23,.02,1,1,"%D",1,0)
	;;=Updates the AD X-Reference on field .03 if the To Date for this
	;;^DD(161.23,.02,1,1,"%D",2,0)
	;;=CNH Authorization Rate changes.
	;;^DD(161.23,.02,1,1,"DT")
	;;=2930422
	;;^DD(161.23,.02,21,0)
	;;=^^1^1^2930303^
	;;^DD(161.23,.02,21,1,0)
	;;=This is the ending date for this patients care at a given rate.
	;;^DD(161.23,.02,"DT")
	;;=2930422
	;;^DD(161.23,.03,0)
	;;=ASSOCIATED 7078^RP162.4'^FB7078(^0;3^Q
	;;^DD(161.23,.03,1,0)
	;;=^.1
	;;^DD(161.23,.03,1,1,0)
	;;=161.23^AC^MUMPS
	;;^DD(161.23,.03,1,1,1)
	;;=S ^FBAA(161.23,"AC",$E(X,1,30),DA)=""
	;;^DD(161.23,.03,1,1,2)
	;;=K ^FBAA(161.23,"AC",$E(X,1,30),DA)
	;;^DD(161.23,.03,1,1,"%D",0)
	;;=^^1^1^2930330^^
	;;^DD(161.23,.03,1,1,"%D",1,0)
	;;=Allows the look-up of all dates associated with this authorization.
	;;^DD(161.23,.03,1,1,"DT")
	;;=2930330
	;;^DD(161.23,.03,1,2,0)
	;;=161.23^AD^MUMPS
	;;^DD(161.23,.03,1,2,1)
	;;=S ^FBAA(161.23,"AD",$E(X,1,30),-$P(^FBAA(161.23,DA,0),U,2),DA)=""
	;;^DD(161.23,.03,1,2,2)
	;;=K ^FBAA(161.23,"AD",X,-$P(^FBAA(161.23,DA,0),U,2),DA)
	;;^DD(161.23,.03,1,2,"%D",0)
	;;=^^2^2^2930514^^^^
	;;^DD(161.23,.03,1,2,"%D",1,0)
	;;=This inverse date crossreference puts the newest rate for a given
	;;^DD(161.23,.03,1,2,"%D",2,0)
	;;=authorization at the top of the stack.
	;;^DD(161.23,.03,1,2,"DT")
	;;=2930404
	;;^DD(161.23,.03,3)
	;;=
	;;^DD(161.23,.03,21,0)
	;;=^^2^2^2930308^^
	;;^DD(161.23,.03,21,1,0)
	;;=This field holds the pointer to file 162.4, 7078 FILE.
	;;^DD(161.23,.03,21,2,0)
	;;=The field is populated by the system.
	;;^DD(161.23,.03,"DT")
	;;=2930404
	;;^DD(161.23,.04,0)
	;;=PATIENT^RP161'^FBAAA(^0;4^Q
	;;^DD(161.23,.04,1,0)
	;;=^.1
	;;^DD(161.23,.04,1,1,0)
	;;=161.23^C
	;;^DD(161.23,.04,1,1,1)
	;;=S ^FBAA(161.23,"C",$E(X,1,30),DA)=""
	;;^DD(161.23,.04,1,1,2)
	;;=K ^FBAA(161.23,"C",$E(X,1,30),DA)
	;;^DD(161.23,.04,1,1,"%D",0)
	;;=^^1^1^2930403^
	;;^DD(161.23,.04,1,1,"%D",1,0)
	;;=Used to locate entries for a patient
	;;^DD(161.23,.04,1,1,"DT")
	;;=2930403
	;;^DD(161.23,.04,21,0)
	;;=^^1^1^2930303^
	;;^DD(161.23,.04,21,1,0)
	;;=The name of the Fee Basis Patient.

FBINI00G
FBINI00G	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.23)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.23,.04,"DT")
	;;=2930403
	;;^DD(161.23,.05,0)
	;;=PER DIEM RATE^RNJ10,2^^0;5^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999999.99)!(X<.01) X
	;;^DD(161.23,.05,1,0)
	;;=^.1
	;;^DD(161.23,.05,1,1,0)
	;;=161.23^AE1^MUMPS
	;;^DD(161.23,.05,1,1,1)
	;;=S:$P(^FBAA(161.23,DA,0),"^",6) ^FBAA(161.23,"AE",$P(^FBAA(161.23,DA,0),"^",6),X,DA)=""
	;;^DD(161.23,.05,1,1,2)
	;;=K:$P(^FBAA(161.23,DA,0),"^",6) ^FBAA(161.23,"AE",$P(^FBAA(161.23,DA,0),"^",6),X,DA)
	;;^DD(161.23,.05,1,1,"%D",0)
	;;=^^3^3^2930617^^^^
	;;^DD(161.23,.05,1,1,"%D",1,0)
	;;=Cross Reference built on Contract Number.  It uses the Perdium Rate as a
	;;^DD(161.23,.05,1,1,"%D",2,0)
	;;=second piece in the X-Ref.  Whenever a change is made to the perdium rate,
	;;^DD(161.23,.05,1,1,"%D",3,0)
	;;=an update to the AE X-Ref. will be made.
	;;^DD(161.23,.05,1,1,"DT")
	;;=2930616
	;;^DD(161.23,.05,3)
	;;=Type a Dollar Amount between .01 and 9999999.99, 2 Decimal Digits
	;;^DD(161.23,.05,21,0)
	;;=^^1^1^2930303^
	;;^DD(161.23,.05,21,1,0)
	;;=This is the dollar amount for this patient's care for a given timeframe.
	;;^DD(161.23,.05,"DT")
	;;=2930818
	;;^DD(161.23,.06,0)
	;;=CONTRACT^F^^0;6^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>15!($L(X)<3) X
	;;^DD(161.23,.06,1,0)
	;;=^.1
	;;^DD(161.23,.06,1,1,0)
	;;=161.23^AE^MUMPS
	;;^DD(161.23,.06,1,1,1)
	;;=S:$P(^FBAA(161.23,DA,0),"^",5) ^FBAA(161.23,"AE",X,$P(^FBAA(161.23,DA,0),"^",5),DA)=""
	;;^DD(161.23,.06,1,1,2)
	;;=K:$P(^FBAA(161.23,DA,0),"^",5) ^FBAA(161.23,"AE",X,$P(^FBAA(161.23,DA,0),"^",5),DA)
	;;^DD(161.23,.06,1,1,"%D",0)
	;;=^^4^4^2930617^^^^
	;;^DD(161.23,.06,1,1,"%D",1,0)
	;;=Cross Reference on Contract # field used to identify all rates associated
	;;^DD(161.23,.06,1,1,"%D",2,0)
	;;=with a particular contract.  The rate is a secondary piece of the X-Ref,
	;;^DD(161.23,.06,1,1,"%D",3,0)
	;;=and an associated entry is made to update the X-Ref whenever a rate
	;;^DD(161.23,.06,1,1,"%D",4,0)
	;;=changes or is added.
	;;^DD(161.23,.06,1,1,"DT")
	;;=2930616
	;;^DD(161.23,.06,3)
	;;=Answer must be 3-15 characters in length.
	;;^DD(161.23,.06,21,0)
	;;=^^2^2^2930514^
	;;^DD(161.23,.06,21,1,0)
	;;=Contains the contract number associated with this authorization period as
	;;^DD(161.23,.06,21,2,0)
	;;=listed in the FEE Basis CNH Contract file.
	;;^DD(161.23,.06,"DT")
	;;=2930616

FBINI00H
FBINI00H	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.25)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.25,0,"GL")
	;;=^FBAA(161.25,
	;;^DIC("B","FEE BASIS VENDOR CORRECTION",161.25)
	;;=
	;;^DIC(161.25,"%D",0)
	;;=^^5^5^2940622^^^^
	;;^DIC(161.25,"%D",1,0)
	;;=Contains those vendors whose master record information has changed and which
	;;^DIC(161.25,"%D",2,0)
	;;=must be sent to the Austin Centralized Fee system for updating the master
	;;^DIC(161.25,"%D",3,0)
	;;=record data.
	;;^DIC(161.25,"%D",4,0)
	;;= 
	;;^DIC(161.25,"%D",5,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.25,0)
	;;=FIELD^^5^6
	;;^DD(161.25,0,"DDA")
	;;=N
	;;^DD(161.25,0,"DT")
	;;=2931020
	;;^DD(161.25,0,"IX","AC",161.25,2)
	;;=
	;;^DD(161.25,0,"IX","AD",161.25,4)
	;;=
	;;^DD(161.25,0,"IX","AE",161.25,1)
	;;=
	;;^DD(161.25,0,"IX","AF",161.25,5)
	;;=
	;;^DD(161.25,0,"IX","B",161.25,.01)
	;;=
	;;^DD(161.25,0,"NM","FEE BASIS VENDOR CORRECTION")
	;;=
	;;^DD(161.25,.01,0)
	;;=NAME^RP161.2'X^FBAAV(^0;1^S:$D(X) DINUM=X
	;;^DD(161.25,.01,1,0)
	;;=^.1
	;;^DD(161.25,.01,1,1,0)
	;;=161.25^B
	;;^DD(161.25,.01,1,1,1)
	;;=S ^FBAA(161.25,"B",$E(X,1,30),DA)=""
	;;^DD(161.25,.01,1,1,2)
	;;=K ^FBAA(161.25,"B",$E(X,1,30),DA)
	;;^DD(161.25,.01,3)
	;;=
	;;^DD(161.25,.01,21,0)
	;;=^^1^1^2930519^^
	;;^DD(161.25,.01,21,1,0)
	;;=Vendor to whom this master record adjustment pertains.
	;;^DD(161.25,.01,"DT")
	;;=2930324
	;;^DD(161.25,1,0)
	;;=PHARMACY TYPE ACTION^S^N:NEW;C:CHANGE;D:DELETE;R:REINSTATE;^0;2^Q
	;;^DD(161.25,1,1,0)
	;;=^.1
	;;^DD(161.25,1,1,1,0)
	;;=161.25^AE^MUMPS
	;;^DD(161.25,1,1,1,1)
	;;=S:$P(^FBAA(161.25,DA,0),U,5)="" ^FBAA(161.25,"AE","P",DA)=""
	;;^DD(161.25,1,1,1,2)
	;;=K ^FBAA(161.25,"AE","P",DA)
	;;^DD(161.25,1,1,1,"%D",0)
	;;=^^2^2^2931012^
	;;^DD(161.25,1,1,1,"%D",1,0)
	;;=This cross-reference is used to determine which vendors need to
	;;^DD(161.25,1,1,1,"%D",2,0)
	;;=be transmitted to Austin.  It is deleted when data is transmitted.
	;;^DD(161.25,1,1,1,"DT")
	;;=2930324
	;;^DD(161.25,1,21,0)
	;;=^^2^2^2930324^
	;;^DD(161.25,1,21,1,0)
	;;=For pharmacy type vendors, the type of MRA transaction
	;;^DD(161.25,1,21,2,0)
	;;=(ie new, change) is entered here.
	;;^DD(161.25,1,"DT")
	;;=2930324
	;;^DD(161.25,2,0)
	;;=NON PHARMACY TYPE OF CORR^RS^N:NEW;C:CHANGE;D:DELETED;R:REINSTATE;^0;3^Q
	;;^DD(161.25,2,1,0)
	;;=^.1
	;;^DD(161.25,2,1,1,0)
	;;=161.25^AC^MUMPS
	;;^DD(161.25,2,1,1,1)
	;;=S:$P(^FBAA(161.25,DA,0),U,5)="" ^FBAA(161.25,"AE","O",DA)=""
	;;^DD(161.25,2,1,1,2)
	;;=K ^FBAA(161.25,"AE","O",DA)
	;;^DD(161.25,2,1,1,"%D",0)
	;;=^^2^2^2931012^
	;;^DD(161.25,2,1,1,"%D",1,0)
	;;=This cross-reference is used to determine which vendors need to
	;;^DD(161.25,2,1,1,"%D",2,0)
	;;=be transmitted to Austin.  It is deleted when data is transmitted.
	;;^DD(161.25,2,1,1,"DT")
	;;=2930324
	;;^DD(161.25,2,21,0)
	;;=^^2^2^2930324^
	;;^DD(161.25,2,21,1,0)
	;;=For non-pharmacy type vendors, the master record adjustment
	;;^DD(161.25,2,21,2,0)
	;;=transaction type (ie new,change) is entered here.
	;;^DD(161.25,2,"DT")
	;;=2931020
	;;^DD(161.25,3,0)
	;;=FEE ONLY INDICATOR^S^Y:YES;^0;4^Q
	;;^DD(161.25,3,21,0)
	;;=2
	;;^DD(161.25,3,21,1,0)
	;;=If the data to be changed should ONLY affect the Central Fee file and
	;;^DD(161.25,3,21,2,0)
	;;=not the CALM file, this field must be set.
	;;^DD(161.25,3,"DT")
	;;=2930324
	;;^DD(161.25,4,0)
	;;=DATE TRANSMITTED^D^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.25,4,1,0)
	;;=^.1
	;;^DD(161.25,4,1,1,0)
	;;=161.25^AD^MUMPS
	;;^DD(161.25,4,1,1,1)
	;;=S ^FBAA(161.25,"AD",$E(X,1,30),$S($P(^FBAA(161.25,DA,0),U,2)]"":"P",1:"O"),DA)=""
	;;^DD(161.25,4,1,1,2)
	;;=K ^FBAA(161.25,"AD",$E(X,1,30),$S($P(^FBAA(161.25,DA,0),U,2)]"":"P",1:"O"),DA)
	;;^DD(161.25,4,1,1,"%D",0)
	;;=^^3^3^2931012^
	;;^DD(161.25,4,1,1,"%D",1,0)
	;;=This cross-reference is used when exercising the purging of MRA's
	;;^DD(161.25,4,1,1,"%D",2,0)
	;;=for a transmitted dated range.  It is also used in the retransmit
	;;^DD(161.25,4,1,1,"%D",3,0)
	;;=MRA's for a date.
	;;^DD(161.25,4,1,1,"DT")
	;;=2930324
	;;^DD(161.25,4,21,0)
	;;=^^2^2^2930324^
	;;^DD(161.25,4,21,1,0)
	;;=The date that the last master record adjustment for this vendor

FBINI00I
FBINI00I	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.25)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.25,4,21,2,0)
	;;=was transmitted to Austin.
	;;^DD(161.25,4,"DT")
	;;=2930324
	;;^DD(161.25,5,0)
	;;=LINKED VENDOR^NJ14,0^^0;6^K:+X'=X!(X>99999999999999)!(X<0)!(X?.E1"."1N.N) X
	;;^DD(161.25,5,1,0)
	;;=^.1
	;;^DD(161.25,5,1,1,0)
	;;=161.25^AF
	;;^DD(161.25,5,1,1,1)
	;;=S ^FBAA(161.25,"AF",$E(X,1,30),DA)=""
	;;^DD(161.25,5,1,1,2)
	;;=K ^FBAA(161.25,"AF",$E(X,1,30),DA)
	;;^DD(161.25,5,1,1,"%D",0)
	;;=^^2^2^2930330^
	;;^DD(161.25,5,1,1,"%D",1,0)
	;;=Cross-reference on Linked Vendor field to determine what vendor this
	;;^DD(161.25,5,1,1,"%D",2,0)
	;;=change was made from.
	;;^DD(161.25,5,1,1,"DT")
	;;=2930330
	;;^DD(161.25,5,3)
	;;=Type a Number between 0 and 99999999999999, 0 Decimal Digits
	;;^DD(161.25,5,21,0)
	;;=^^4^4^2930517^^
	;;^DD(161.25,5,21,1,0)
	;;=If the vendor correction is a change, this entry will contain the internal
	;;^DD(161.25,5,21,2,0)
	;;=entry number of the vendor the change was originated from.  This will
	;;^DD(161.25,5,21,3,0)
	;;=allow for reference to the original vendor, if Austin processes the record
	;;^DD(161.25,5,21,4,0)
	;;=and indicates the two vendors are the same.
	;;^DD(161.25,5,"DT")
	;;=2930517

FBINI00J
FBINI00J	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.26)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.26,0,"GL")
	;;=^FBAA(161.26,
	;;^DIC("B","FEE BASIS PATIENT MRA",161.26)
	;;=
	;;^DIC(161.26,"%D",0)
	;;=^^5^5^2940622^^^^
	;;^DIC(161.26,"%D",1,0)
	;;=Contains the entry of veterans whose master record information has 
	;;^DIC(161.26,"%D",2,0)
	;;=changed. The updated information must be sent to the Centralized Fee 
	;;^DIC(161.26,"%D",3,0)
	;;=system in Austin for the updating of their master veteran records.
	;;^DIC(161.26,"%D",4,0)
	;;= 
	;;^DIC(161.26,"%D",5,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.26,0)
	;;=FIELD^^6^7
	;;^DD(161.26,0,"IX","AC",161.26,1)
	;;=
	;;^DD(161.26,0,"IX","AD",161.26,4)
	;;=
	;;^DD(161.26,0,"IX","B",161.26,.01)
	;;=
	;;^DD(161.26,0,"NM","FEE BASIS PATIENT MRA")
	;;=
	;;^DD(161.26,.01,0)
	;;=NAME^RP2'X^DPT(^0;1^S DINUM=X
	;;^DD(161.26,.01,1,0)
	;;=^.1
	;;^DD(161.26,.01,1,1,0)
	;;=161.26^B
	;;^DD(161.26,.01,1,1,1)
	;;=S ^FBAA(161.26,"B",$E(X,1,30),DA)=""
	;;^DD(161.26,.01,1,1,2)
	;;=K ^FBAA(161.26,"B",$E(X,1,30),DA)
	;;^DD(161.26,.01,3)
	;;=
	;;^DD(161.26,.01,21,0)
	;;=^^1^1^2930519^^
	;;^DD(161.26,.01,21,1,0)
	;;=The veteran for whom this master record adjustment is created. 
	;;^DD(161.26,1,0)
	;;=STATUS^RS^P:PENDING TRANSMISSION;T:TRANSMITTED;^0;2^Q
	;;^DD(161.26,1,1,0)
	;;=^.1
	;;^DD(161.26,1,1,1,0)
	;;=161.26^AC
	;;^DD(161.26,1,1,1,1)
	;;=S ^FBAA(161.26,"AC",$E(X,1,30),DA)=""
	;;^DD(161.26,1,1,1,2)
	;;=K ^FBAA(161.26,"AC",$E(X,1,30),DA)
	;;^DD(161.26,1,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.26,1,21,1,0)
	;;=This field identifies whether this master record adjustment is pending
	;;^DD(161.26,1,21,2,0)
	;;=transmission to Austin or has already been transmitted.
	;;^DD(161.26,2,0)
	;;=POINTER TO AUTHORIZATION NODE^RNJ10,0^^0;3^K:+X'=X!(X>9999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.26,2,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 9999999999
	;;^DD(161.26,2,21,0)
	;;=^^5^5^2931012^^
	;;^DD(161.26,2,21,1,0)
	;;=This field contains the internal entry number of the authorization 
	;;^DD(161.26,2,21,2,0)
	;;=record selected for the veteran. This is needed because master record
	;;^DD(161.26,2,21,3,0)
	;;=adjustments are related to specific authorizations. The user does NOT
	;;^DD(161.26,2,21,4,0)
	;;=enter this field directly. The data is captured automatically when the
	;;^DD(161.26,2,21,5,0)
	;;=user selects the authorization.
	;;^DD(161.26,2,23,0)
	;;=^^2^2^2931012^
	;;^DD(161.26,2,23,1,0)
	;;=This field contains the 'DA' value from Fee Basis Patient file.  It is
	;;^DD(161.26,2,23,2,0)
	;;=the internal entry number at the authorization multiple. [^FBAAA(DA(1),1,DA]
	;;^DD(161.26,2,"DT")
	;;=2860425
	;;^DD(161.26,3,0)
	;;=TYPE^RS^A:ADD;R:REINSTATE;D:DELETE;C:CHANGE;^0;4^Q
	;;^DD(161.26,3,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.26,3,21,1,0)
	;;=Indicates the type (ie add, change) of master record adjustment this
	;;^DD(161.26,3,21,2,0)
	;;=is.
	;;^DD(161.26,3,"DT")
	;;=2860915
	;;^DD(161.26,4,0)
	;;=DATE TRANSMITTED^D^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.26,4,1,0)
	;;=^.1
	;;^DD(161.26,4,1,1,0)
	;;=161.26^AD
	;;^DD(161.26,4,1,1,1)
	;;=S ^FBAA(161.26,"AD",$E(X,1,30),DA)=""
	;;^DD(161.26,4,1,1,2)
	;;=K ^FBAA(161.26,"AD",$E(X,1,30),DA)
	;;^DD(161.26,4,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.26,4,21,1,0)
	;;=The date that last master record adjustment for this veteran was 
	;;^DD(161.26,4,21,2,0)
	;;=transmitted to Austin.
	;;^DD(161.26,4,"DT")
	;;=2860710
	;;^DD(161.26,5,0)
	;;=AUTH. FROM DATE CHANGED^S^1:YES;2:NO;^0;6^Q
	;;^DD(161.26,5,21,0)
	;;=^^6^6^2880304^
	;;^DD(161.26,5,21,1,0)
	;;=This field is used as a flag to indicate that the authorization From Date
	;;^DD(161.26,5,21,2,0)
	;;=is being changed by this master record adjustment. If this field is set
	;;^DD(161.26,5,21,3,0)
	;;=to yes, the authorization To Date is set to spaces when the transaction
	;;^DD(161.26,5,21,4,0)
	;;=is created. An Austin requirement is to change the From Date, the To
	;;^DD(161.26,5,21,5,0)
	;;=date must be blank. This field only pertains to a 'Change' type 
	;;^DD(161.26,5,21,6,0)
	;;=transaction.
	;;^DD(161.26,5,"DT")
	;;=2901012

FBINI00K
FBINI00K	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.26)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.26,6,0)
	;;=SHORT TERM MRA^S^Y:yes;^0;7^Q
	;;^DD(161.26,6,21,0)
	;;=^^6^6^2880304^
	;;^DD(161.26,6,21,1,0)
	;;=This field is used as a flag and relates to outpatient medical 
	;;^DD(161.26,6,21,2,0)
	;;=reimbursements for a veteran with only a short term authorization.
	;;^DD(161.26,6,21,3,0)
	;;= For those reimbursements the system automatically creates
	;;^DD(161.26,6,21,4,0)
	;;=a master record adjustment sending the most current data. This field is
	;;^DD(161.26,6,21,5,0)
	;;=used to identify that this transaction is only temporary and not to
	;;^DD(161.26,6,21,6,0)
	;;=establish a long term master record.
	;;^DD(161.26,6,"DT")
	;;=2871203

FBINI00L
FBINI00L	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.27)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.27,0,"GL")
	;;=^FBAA(161.27,
	;;^DIC("B","FEE BASIS SUSPENSION",161.27)
	;;=
	;;^DIC(161.27,"%D",0)
	;;=^^3^3^2940622^^^^
	;;^DIC(161.27,"%D",1,0)
	;;=Contains all the valid Suspense codes available to the Fee basis system.
	;;^DIC(161.27,"%D",2,0)
	;;= 
	;;^DIC(161.27,"%D",3,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.27,0)
	;;=FIELD^^2^3
	;;^DD(161.27,0,"ID",2)
	;;=W:$D(^(2)) "   ",$P(^(2),U,1)
	;;^DD(161.27,0,"IX","B",161.27,.01)
	;;=
	;;^DD(161.27,0,"IX","C",161.27,2)
	;;=
	;;^DD(161.27,0,"NM","FEE BASIS SUSPENSION")
	;;=
	;;^DD(161.27,0,"PT",162.03,4)
	;;=
	;;^DD(161.27,0,"PT",162.11,7)
	;;=
	;;^DD(161.27,0,"PT",162.2,14)
	;;=
	;;^DD(161.27,0,"PT",162.5,10)
	;;=
	;;^DD(161.27,.01,0)
	;;=CODE^RF^^0;1^K:$L(X)>2!($L(X)<1)!'(X'?1P.E) X
	;;^DD(161.27,.01,1,0)
	;;=^.1
	;;^DD(161.27,.01,1,1,0)
	;;=161.27^B
	;;^DD(161.27,.01,1,1,1)
	;;=S ^FBAA(161.27,"B",$E(X,1,30),DA)=""
	;;^DD(161.27,.01,1,1,2)
	;;=K ^FBAA(161.27,"B",$E(X,1,30),DA)
	;;^DD(161.27,.01,3)
	;;=ANSWER MUST BE 1-2 CHARACTERS IN LENGTH
	;;^DD(161.27,.01,21,0)
	;;=^^2^2^2880617^^^^
	;;^DD(161.27,.01,21,1,0)
	;;=These codes represent reasons for payment suspense. They are
	;;^DD(161.27,.01,21,2,0)
	;;=identified by the 'Short Description' field.
	;;^DD(161.27,1,0)
	;;=DESCRIPTION^161.28^^1;0
	;;^DD(161.27,1,21,0)
	;;=^^3^3^2880304^
	;;^DD(161.27,1,21,1,0)
	;;=This field represents the expanded explanation of the
	;;^DD(161.27,1,21,2,0)
	;;=suspense codes.They are used during the printing of
	;;^DD(161.27,1,21,3,0)
	;;=the suspense letters.
	;;^DD(161.27,2,0)
	;;=SHORT DESCRIPTION^F^^2;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>40!($L(X)<3) X
	;;^DD(161.27,2,1,0)
	;;=^.1^^-1
	;;^DD(161.27,2,1,1,0)
	;;=161.27^C^MUMPS
	;;^DD(161.27,2,1,1,1)
	;;=D XSET^FBAAUTL1
	;;^DD(161.27,2,1,1,2)
	;;=D XKILL^FBAAUTL1
	;;^DD(161.27,2,1,1,"%D",0)
	;;=^^2^2^2920903^
	;;^DD(161.27,2,1,1,"%D",1,0)
	;;=Sets a cross-reference in capital letters that allows look-up by
	;;^DD(161.27,2,1,1,"%D",2,0)
	;;=short description.
	;;^DD(161.27,2,1,1,"DT")
	;;=2920903
	;;^DD(161.27,2,3)
	;;=ANSWER MUST BE 3-40 CHARACTERS IN LENGTH
	;;^DD(161.27,2,21,0)
	;;=^^2^2^2880304^^^^
	;;^DD(161.27,2,21,1,0)
	;;=This field contains an abbreviated text of the suspense codes.
	;;^DD(161.27,2,21,2,0)
	;;=They are used in the help text when entering suspense codes.
	;;^DD(161.27,2,"DT")
	;;=2920903
	;;^DD(161.28,0)
	;;=DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(161.28,0,"NM","DESCRIPTION")
	;;=
	;;^DD(161.28,0,"UP")
	;;=161.27
	;;^DD(161.28,.01,0)
	;;=DESCRIPTION^W^^0;1^Q

FBINI00M
FBINI00M	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(161.27)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,161.27)
	;;=^FBAA(161.27,
	;;^UTILITY(U,$J,161.27,0)
	;;=FEE BASIS SUSPENSION^161.27I^18^18
	;;^UTILITY(U,$J,161.27,1,0)
	;;=1
	;;^UTILITY(U,$J,161.27,1,1,0)
	;;=^^1^1^2920903^^^^
	;;^UTILITY(U,$J,161.27,1,1,1,0)
	;;=Charge exceeds maximum amount payable in accordance with VA policy.
	;;^UTILITY(U,$J,161.27,1,2)
	;;=Charge exceeds maximum payable
	;;^UTILITY(U,$J,161.27,2,0)
	;;=2
	;;^UTILITY(U,$J,161.27,2,1,0)
	;;=^^1^1^2880601^^^^
	;;^UTILITY(U,$J,161.27,2,1,1,0)
	;;=Adjustment was made to correct mathematical error on your invoice.
	;;^UTILITY(U,$J,161.27,2,2)
	;;=Math error
	;;^UTILITY(U,$J,161.27,3,0)
	;;=3
	;;^UTILITY(U,$J,161.27,3,1,0)
	;;=^^2^2^2880601^^^^
	;;^UTILITY(U,$J,161.27,3,1,1,0)
	;;=Medical service/Rx was provided for condition which is not authorized
	;;^UTILITY(U,$J,161.27,3,1,2,0)
	;;=at VA expense.
	;;^UTILITY(U,$J,161.27,3,2)
	;;=Not entitled to treatment
	;;^UTILITY(U,$J,161.27,4,0)
	;;=4
	;;^UTILITY(U,$J,161.27,4,1,0)
	;;=^^2^2^2920903^^^^
	;;^UTILITY(U,$J,161.27,4,1,1,0)
	;;=Amount differs from amount claimed.  Explanatory letter being forwarded
	;;^UTILITY(U,$J,161.27,4,1,2,0)
	;;=under separate cover.
	;;^UTILITY(U,$J,161.27,4,2)
	;;=Other
	;;^UTILITY(U,$J,161.27,5,0)
	;;=5
	;;^UTILITY(U,$J,161.27,5,1,0)
	;;=^^2^2^2880601^^^^
	;;^UTILITY(U,$J,161.27,5,1,1,0)
	;;=Fees for service previously processed.  If payment not received, notify
	;;^UTILITY(U,$J,161.27,5,1,2,0)
	;;=Fiscal Service.
	;;^UTILITY(U,$J,161.27,5,2)
	;;=Previously paid
	;;^UTILITY(U,$J,161.27,6,0)
	;;=6
	;;^UTILITY(U,$J,161.27,6,1,0)
	;;=^^2^2^2880601^^^^
	;;^UTILITY(U,$J,161.27,6,1,1,0)
	;;=Fees for this invoice exceed the monthly dollar limitation established
	;;^UTILITY(U,$J,161.27,6,1,2,0)
	;;=for this veteran.
	;;^UTILITY(U,$J,161.27,6,2)
	;;=Exceed monthly dollar limitation
	;;^UTILITY(U,$J,161.27,7,0)
	;;=7
	;;^UTILITY(U,$J,161.27,7,1,0)
	;;=^^1^1^2880601^^^^
	;;^UTILITY(U,$J,161.27,7,1,1,0)
	;;=Physician's signature missing on Rx.
	;;^UTILITY(U,$J,161.27,7,2)
	;;=Physician's signature missing
	;;^UTILITY(U,$J,161.27,8,0)
	;;=8
	;;^UTILITY(U,$J,161.27,8,1,0)
	;;=^^1^1^2880601^^^^
	;;^UTILITY(U,$J,161.27,8,1,1,0)
	;;=Patient/representative's signature missing on Statement of Receipt.
	;;^UTILITY(U,$J,161.27,8,2)
	;;=Patient's signature missing
	;;^UTILITY(U,$J,161.27,9,0)
	;;=9
	;;^UTILITY(U,$J,161.27,9,1,0)
	;;=^^1^1^2931112^^^^
	;;^UTILITY(U,$J,161.27,9,1,1,0)
	;;=No evidence of record that medication needed immediately.
	;;^UTILITY(U,$J,161.27,9,2)
	;;=Medication not emergent.
	;;^UTILITY(U,$J,161.27,10,0)
	;;=A
	;;^UTILITY(U,$J,161.27,10,1,0)
	;;=^^1^1^2880601^^^
	;;^UTILITY(U,$J,161.27,10,1,1,0)
	;;=Pharmacist's certification missing on copy.
	;;^UTILITY(U,$J,161.27,10,2)
	;;=Pharmacist's certification missing
	;;^UTILITY(U,$J,161.27,11,0)
	;;=B
	;;^UTILITY(U,$J,161.27,11,1,0)
	;;=^^1^1^2880601^^^^
	;;^UTILITY(U,$J,161.27,11,1,1,0)
	;;=Certification not signed by pharmacist.
	;;^UTILITY(U,$J,161.27,11,2)
	;;=Pharmacist's signature missing
	;;^UTILITY(U,$J,161.27,12,0)
	;;=C
	;;^UTILITY(U,$J,161.27,12,1,0)
	;;=^^2^2^2880601^^^^
	;;^UTILITY(U,$J,161.27,12,1,1,0)
	;;=NDC Code, name of manufacturer, brand name, strength
	;;^UTILITY(U,$J,161.27,12,1,2,0)
	;;=or quantity dispensed, is missing.
	;;^UTILITY(U,$J,161.27,12,2)
	;;=Required drug information missing
	;;^UTILITY(U,$J,161.27,13,0)
	;;=D
	;;^UTILITY(U,$J,161.27,13,1,0)
	;;=^^2^2^2880601^^^^
	;;^UTILITY(U,$J,161.27,13,1,1,0)
	;;=Item not a medical requisite paid for by the VA.  (Do not return
	;;^UTILITY(U,$J,161.27,13,1,2,0)
	;;=prescription.)
	;;^UTILITY(U,$J,161.27,13,2)
	;;=Item not on payable list
	;;^UTILITY(U,$J,161.27,14,0)
	;;=E
	;;^UTILITY(U,$J,161.27,14,1,0)
	;;=^^1^1^2880601^^^^
	;;^UTILITY(U,$J,161.27,14,1,1,0)
	;;=Veteran's full name, address or social security number missing.
	;;^UTILITY(U,$J,161.27,14,2)
	;;=Veteran information missing
	;;^UTILITY(U,$J,161.27,15,0)
	;;=F
	;;^UTILITY(U,$J,161.27,15,1,0)
	;;=^^1^1^2880601^^^^
	;;^UTILITY(U,$J,161.27,15,1,1,0)
	;;=Payment for personal items or private room not permitted.

FBINI00N
FBINI00N	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(161.27)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,161.27,15,2)
	;;=Personal items/Private Room
	;;^UTILITY(U,$J,161.27,16,0)
	;;=G
	;;^UTILITY(U,$J,161.27,16,1,0)
	;;=^^2^2^2880601^^^^
	;;^UTILITY(U,$J,161.27,16,1,1,0)
	;;=Veteran refused transfer to VA hospital.  Payment made to date
	;;^UTILITY(U,$J,161.27,16,1,2,0)
	;;=stabilized or date of refusal.
	;;^UTILITY(U,$J,161.27,16,2)
	;;=Vet refused transfer
	;;^UTILITY(U,$J,161.27,17,0)
	;;=H
	;;^UTILITY(U,$J,161.27,17,1,0)
	;;=^^2^2^2880601^^^
	;;^UTILITY(U,$J,161.27,17,1,1,0)
	;;=Rx is for a recurring/refill medication not paid by VA.
	;;^UTILITY(U,$J,161.27,17,1,2,0)
	;;=(Do not return this prescription.)
	;;^UTILITY(U,$J,161.27,17,2)
	;;=For recurring or refill medication
	;;^UTILITY(U,$J,161.27,18,0)
	;;=I
	;;^UTILITY(U,$J,161.27,18,1,0)
	;;=^^2^2^2940425^^^^
	;;^UTILITY(U,$J,161.27,18,1,1,0)
	;;=Payment for generic equivalent.  Prescription did not prohibit
	;;^UTILITY(U,$J,161.27,18,1,2,0)
	;;=substitution.
	;;^UTILITY(U,$J,161.27,18,2)
	;;=Payment made for Generic drug

FBINI00O
FBINI00O	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.3,0,"GL")
	;;=^FBAA(161.3,
	;;^DIC("B","FEE BASIS LETTER",161.3)
	;;=
	;;^DIC(161.3,"%D",0)
	;;=^^5^5^2940622^^^^
	;;^DIC(161.3,"%D",1,0)
	;;=This file is presently used for storing facility designed suspension
	;;^DIC(161.3,"%D",2,0)
	;;=and/or unauthorized claims letter(s). Future versions may utilize this 
	;;^DIC(161.3,"%D",3,0)
	;;=file for other types of correspondence.
	;;^DIC(161.3,"%D",4,0)
	;;= 
	;;^DIC(161.3,"%D",5,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.3,0)
	;;=FIELD^^.02^4
	;;^DD(161.3,0,"DT")
	;;=2930405
	;;^DD(161.3,0,"IX","B",161.3,.01)
	;;=
	;;^DD(161.3,0,"NM","FEE BASIS LETTER")
	;;=
	;;^DD(161.3,0,"PT",162.92,.05)
	;;=
	;;^DD(161.3,.01,0)
	;;=NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
	;;^DD(161.3,.01,1,0)
	;;=^.1
	;;^DD(161.3,.01,1,1,0)
	;;=161.3^B
	;;^DD(161.3,.01,1,1,1)
	;;=S ^FBAA(161.3,"B",$E(X,1,30),DA)=""
	;;^DD(161.3,.01,1,1,2)
	;;=K ^FBAA(161.3,"B",$E(X,1,30),DA)
	;;^DD(161.3,.01,3)
	;;=NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
	;;^DD(161.3,.01,21,0)
	;;=^^1^1^2930514^^
	;;^DD(161.3,.01,21,1,0)
	;;=Name assigned to this letter for later selection.
	;;^DD(161.3,.02,0)
	;;=TYPE OF LETTER^*S^1:UNAUTHORIZED CLAIM;^0;2^Q
	;;^DD(161.3,.02,3)
	;;=Select the appropriate letter category.
	;;^DD(161.3,.02,12)
	;;=Select appropriate letter.
	;;^DD(161.3,.02,12.1)
	;;=S DIC("S")="I $S('$D(FBUC):0,$D(FBUC):1,1:0)"
	;;^DD(161.3,.02,21,0)
	;;=^^1^1^2930405^
	;;^DD(161.3,.02,21,1,0)
	;;=Used to designate the appropriate letter category.
	;;^DD(161.3,.02,23,0)
	;;=^^1^1^2930405^
	;;^DD(161.3,.02,23,1,0)
	;;=Used to screen unauthorized claim letters.
	;;^DD(161.3,.02,"DT")
	;;=2930405
	;;^DD(161.3,1,0)
	;;=BEGINNING OF LETTER^161.31^^1;0
	;;^DD(161.3,1,21,0)
	;;=^^4^4^2880617^^^^
	;;^DD(161.3,1,21,1,0)
	;;=Any number of paragraphs which will be printed at the top
	;;^DD(161.3,1,21,2,0)
	;;=of the letter. This same data will be printed on every suspense
	;;^DD(161.3,1,21,3,0)
	;;=letter generated, therefore it should be as generic as possible. 
	;;^DD(161.3,1,21,4,0)
	;;=See the SAMPLE letter sent out with the DHCP Fee package.
	;;^DD(161.3,2,0)
	;;=END OF LETTER^161.32^^2;0
	;;^DD(161.3,2,21,0)
	;;=^^4^4^2880527^^
	;;^DD(161.3,2,21,1,0)
	;;=This can be any number of paragraphs and will be printed after the 
	;;^DD(161.3,2,21,2,0)
	;;=specific suspended line items are printed. This, like field #1
	;;^DD(161.3,2,21,3,0)
	;;=will be printed on all suspense letters generated, therefore it must be
	;;^DD(161.3,2,21,4,0)
	;;=generic. See the Sample letter sent out with the system.
	;;^DD(161.31,0)
	;;=BEGINNING OF LETTER SUB-FIELD^^.01^1
	;;^DD(161.31,0,"NM","BEGINNING OF LETTER")
	;;=
	;;^DD(161.31,0,"UP")
	;;=161.3
	;;^DD(161.31,.01,0)
	;;=BEGINNING OF LETTER^WL^^0;1^Q
	;;^DD(161.31,.01,21,0)
	;;=^^3^3^2880608^^^
	;;^DD(161.31,.01,21,1,0)
	;;=Any number of paragraphs which will be printed at the top of the letter.
	;;^DD(161.31,.01,21,2,0)
	;;=This same data will be printed on every suspense letter generated, 
	;;^DD(161.31,.01,21,3,0)
	;;=this has to be generic type information.
	;;^DD(161.31,.01,"DT")
	;;=2880209
	;;^DD(161.32,0)
	;;=END OF LETTER SUB-FIELD^^.01^1
	;;^DD(161.32,0,"NM","END OF LETTER")
	;;=
	;;^DD(161.32,0,"UP")
	;;=161.3
	;;^DD(161.32,.01,0)
	;;=END OF LETTER^WL^^0;1^Q
	;;^DD(161.32,.01,21,0)
	;;=^^1^1^2940811^^
	;;^DD(161.32,.01,21,1,0)
	;;= 
	;;^DD(161.32,.01,"DT")
	;;=2880209

FBINI00P
FBINI00P	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(161.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,161.3)
	;;=^FBAA(161.3,
	;;^UTILITY(U,$J,161.3,0)
	;;=FEE BASIS LETTER^161.3^3^3
	;;^UTILITY(U,$J,161.3,1,0)
	;;=SAMPLE SUSPENSION
	;;^UTILITY(U,$J,161.3,1,1,0)
	;;=^^3^3^2941227^^^^
	;;^UTILITY(U,$J,161.3,1,1,1,0)
	;;=We recently processed your invoice(s) and for various reasons adjustments
	;;^UTILITY(U,$J,161.3,1,1,2,0)
	;;=had to be made to line items. The following is a list of those items
	;;^UTILITY(U,$J,161.3,1,1,3,0)
	;;=that were changed and the reasons why:
	;;^UTILITY(U,$J,161.3,1,2,0)
	;;=^^4^4^2941227^^^^
	;;^UTILITY(U,$J,161.3,1,2,1,0)
	;;=Should you have any questions regarding this letter, feel free to contact
	;;^UTILITY(U,$J,161.3,1,2,2,0)
	;;=us at the VA Medical Center. Thank you for your cooperation.
	;;^UTILITY(U,$J,161.3,1,2,3,0)
	;;=                            Medical Center Director
	;;^UTILITY(U,$J,161.3,1,2,4,0)
	;;=                            James A Jones, MD
	;;^UTILITY(U,$J,161.3,2,0)
	;;=UNAUTHORIZED DISPOSITION^1
	;;^UTILITY(U,$J,161.3,2,1,0)
	;;=^^2^2^2930917^^^^
	;;^UTILITY(U,$J,161.3,2,1,1,0)
	;;=We have carefully reviewed your claim for payment of unauthorized medical
	;;^UTILITY(U,$J,161.3,2,1,2,0)
	;;=services.  The following decision has been made:
	;;^UTILITY(U,$J,161.3,2,2,0)
	;;=^^15^15^2930917^^^^
	;;^UTILITY(U,$J,161.3,2,2,1,0)
	;;=If you do not agree with the decision you have the right to appeal.  Your
	;;^UTILITY(U,$J,161.3,2,2,2,0)
	;;=appeal rights should be attached for your review, if your claim was not 
	;;^UTILITY(U,$J,161.3,2,2,3,0)
	;;=approved.
	;;^UTILITY(U,$J,161.3,2,2,4,0)
	;;=  
	;;^UTILITY(U,$J,161.3,2,2,5,0)
	;;=If you have any questions concerning this matter, please contact us at the
	;;^UTILITY(U,$J,161.3,2,2,6,0)
	;;=above address.  A copy of this letter is being furnished to the provider(s)
	;;^UTILITY(U,$J,161.3,2,2,7,0)
	;;=of care, if applicable.
	;;^UTILITY(U,$J,161.3,2,2,8,0)
	;;=   
	;;^UTILITY(U,$J,161.3,2,2,9,0)
	;;=  
	;;^UTILITY(U,$J,161.3,2,2,10,0)
	;;=Sincerely,
	;;^UTILITY(U,$J,161.3,2,2,11,0)
	;;=  
	;;^UTILITY(U,$J,161.3,2,2,12,0)
	;;=  
	;;^UTILITY(U,$J,161.3,2,2,13,0)
	;;=  
	;;^UTILITY(U,$J,161.3,2,2,14,0)
	;;=  
	;;^UTILITY(U,$J,161.3,2,2,15,0)
	;;=Chief, Medical Administration Service
	;;^UTILITY(U,$J,161.3,3,0)
	;;=UNAUTHORIZED REQUEST INFO^1
	;;^UTILITY(U,$J,161.3,3,1,0)
	;;=^^1^1^2931014^^^^
	;;^UTILITY(U,$J,161.3,3,1,1,0)
	;;=We have received your request for payment of medical services which were not authorized.  Before we are able to process your claim the following information is needed:
	;;^UTILITY(U,$J,161.3,3,2,0)
	;;=^^15^15^2931014^^^^
	;;^UTILITY(U,$J,161.3,3,2,1,0)
	;;=We ask that you be prompt in supplying the requested information.  Failure to provide all the information within a year will result in an automatic disapproval.
	;;^UTILITY(U,$J,161.3,3,2,2,0)
	;;=Legislation requires that we notify you if your claim cannot be processed if entitlement to the services rendered has not been established.  Without the information requested above, we cannot consider your request
	;;^UTILITY(U,$J,161.3,3,2,3,0)
	;;=for payment as a proper invoice.
	;;^UTILITY(U,$J,161.3,3,2,4,0)
	;;=  
	;;^UTILITY(U,$J,161.3,3,2,5,0)
	;;=If you wish us to process this claim, please resubmit the entire claim with the items listed to the above address.  We will notify you of our decision.
	;;^UTILITY(U,$J,161.3,3,2,6,0)
	;;=  
	;;^UTILITY(U,$J,161.3,3,2,7,0)
	;;=The U.S. Department of Veterans Affairs assumes no financial responsibility for any costs incurred in obtaining the above information.
	;;^UTILITY(U,$J,161.3,3,2,8,0)
	;;=  
	;;^UTILITY(U,$J,161.3,3,2,9,0)
	;;=  
	;;^UTILITY(U,$J,161.3,3,2,10,0)
	;;=Sincerely,
	;;^UTILITY(U,$J,161.3,3,2,11,0)
	;;=  
	;;^UTILITY(U,$J,161.3,3,2,12,0)
	;;= 
	;;^UTILITY(U,$J,161.3,3,2,13,0)
	;;= 
	;;^UTILITY(U,$J,161.3,3,2,14,0)
	;;= 
	;;^UTILITY(U,$J,161.3,3,2,15,0)
	;;=Chief, Medical Administration Service

FBINI00Q
FBINI00Q	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.4,0,"GL")
	;;=^FBAA(161.4,
	;;^DIC("B","FEE BASIS SITE PARAMETERS",161.4)
	;;=
	;;^DIC(161.4,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(161.4,"%D",1,0)
	;;=Contains the site specific data for Fee basis functionality. One and only
	;;^DIC(161.4,"%D",2,0)
	;;=one entry can exist in this file per installation.
	;;^DIC(161.4,"%D",3,0)
	;;= 
	;;^DIC(161.4,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.4,0)
	;;=FIELD^^37^38
	;;^DD(161.4,0,"DT")
	;;=2940714
	;;^DD(161.4,0,"IX","B",161.4,.01)
	;;=
	;;^DD(161.4,0,"NM","FEE BASIS SITE PARAMETERS")
	;;=
	;;^DD(161.4,.001,0)
	;;=NUMBER^NJ1,0^^ ^K:+X'=X!(X>1)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,.001,3)
	;;=Type a Number between 1 and 1, 0 Decimal Digits
	;;^DD(161.4,.001,21,0)
	;;=^^2^2^2941128^
	;;^DD(161.4,.001,21,1,0)
	;;=This field is used to prevent the addition of more than one
	;;^DD(161.4,.001,21,2,0)
	;;=entry into the site parameter file.
	;;^DD(161.4,.001,"DT")
	;;=2940318
	;;^DD(161.4,.01,0)
	;;=STATION OF JURISDICTION NAME^RFX^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
	;;^DD(161.4,.01,1,0)
	;;=^.1
	;;^DD(161.4,.01,1,1,0)
	;;=161.4^B
	;;^DD(161.4,.01,1,1,1)
	;;=S ^FBAA(161.4,"B",$E(X,1,30),DA)=""
	;;^DD(161.4,.01,1,1,2)
	;;=K ^FBAA(161.4,"B",$E(X,1,30),DA)
	;;^DD(161.4,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(161.4,.01,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.4,.01,21,1,0)
	;;=The name of this Clinic of Jurisdiction for which these site parameters
	;;^DD(161.4,.01,21,2,0)
	;;=are defined. There can be only 1 entry in this file.
	;;^DD(161.4,.01,"DT")
	;;=2940318
	;;^DD(161.4,1,0)
	;;=STATION ADDRESS LINE 1^RF^^0;2^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.4,1,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(161.4,1,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.4,1,21,1,0)
	;;=Street address line 1 of this COJ. This data will be printed on the
	;;^DD(161.4,1,21,2,0)
	;;=Authorization form 7079.
	;;^DD(161.4,2,0)
	;;=STATION ADDRESS LINE 2^F^^0;3^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.4,2,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(161.4,2,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.4,2,21,1,0)
	;;=Street address line 2 of this COJ. This address line will also print on
	;;^DD(161.4,2,21,2,0)
	;;=the Authorization form 7079.
	;;^DD(161.4,3,0)
	;;=CITY^RF^^0;4^K:$L(X)>23!($L(X)<2) X
	;;^DD(161.4,3,3)
	;;=ANSWER MUST BE 2-23 CHARACTERS IN LENGTH
	;;^DD(161.4,3,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.4,3,21,1,0)
	;;=The city in which the COJ receives it's mail.
	;;^DD(161.4,4,0)
	;;=STATE^RP5'^DIC(5,^0;5^Q
	;;^DD(161.4,4,21,0)
	;;=^^1^1^2930519^^
	;;^DD(161.4,4,21,1,0)
	;;=The state in which the COJ's mailing address resides.
	;;^DD(161.4,5,0)
	;;=ZIP^RF^^0;6^K:$L(X)>9!($L(X)<5) X
	;;^DD(161.4,5,3)
	;;=ANSWER MUST BE 5-9 CHARACTERS IN LENGTH
	;;^DD(161.4,5,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.4,5,21,1,0)
	;;=Zip code for the COJ.
	;;^DD(161.4,6,0)
	;;=STATION TELEPHONE NUMBER^RF^^0;7^K:$L(X)>20!($L(X)<6) X
	;;^DD(161.4,6,3)
	;;=ANSWER MUST BE 6-20 CHARACTERS IN LENGTH
	;;^DD(161.4,6,21,0)
	;;=^^1^1^2880608^^^
	;;^DD(161.4,6,21,1,0)
	;;=The telephone number where Fee inquiries should be directed.
	;;^DD(161.4,7,0)
	;;=APPROVING OFFICIAL FOR 7079^RF^^0;8^K:$L(X)>45!($L(X)<3) X
	;;^DD(161.4,7,3)
	;;=ANSWER MUST BE 3-45 CHARACTERS IN LENGTH
	;;^DD(161.4,7,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.4,7,21,1,0)
	;;=The name of the approving official authorizing fee services. This name 
	;;^DD(161.4,7,21,2,0)
	;;=will be printed on the authorization form 7079.
	;;^DD(161.4,8,0)
	;;=TITLE OF APPROVING OFFICIAL^RF^^0;9^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.4,8,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(161.4,8,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.4,8,21,1,0)
	;;=The title of the approving official which will also be printed on the
	;;^DD(161.4,8,21,2,0)
	;;=authorization form 7079.
	;;^DD(161.4,9,0)
	;;=MEDICAID DISPENSING FEE^RNJ5,2^^0;10^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>20)!(X<.01) X
	;;^DD(161.4,9,3)
	;;=Type a Dollar Amount between .01 and 20, 2 Decimal Digits
	;;^DD(161.4,9,21,0)
	;;=^^2^2^2930519^^^^

FBINI00R
FBINI00R	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.4,9,21,1,0)
	;;=The medicaid dispensing fee for this COJ. Dispensing fees vary from 
	;;^DD(161.4,9,21,2,0)
	;;=COJ to COJ. Medicaid approves dispensing fee's.
	;;^DD(161.4,9,"DT")
	;;=2930105
	;;^DD(161.4,10,0)
	;;=NEXT BATCH NUMBER^RNJ5,0I^^FBNUM;1^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,10,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 99999
	;;^DD(161.4,10,21,0)
	;;=^^2^2^2880617^^^^
	;;^DD(161.4,10,21,1,0)
	;;=The next batch number which will be assigned by the system. This cannot
	;;^DD(161.4,10,21,2,0)
	;;=be edited or changed.
	;;^DD(161.4,10,"DT")
	;;=2940725
	;;^DD(161.4,11,0)
	;;=NEXT INVOICE NUMBER^RNJ7,0I^^FBNUM;2^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,11,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 9999999
	;;^DD(161.4,11,21,0)
	;;=^^2^2^2880617^^^^
	;;^DD(161.4,11,21,1,0)
	;;=The next invoice number which will automatically be assigned by the
	;;^DD(161.4,11,21,2,0)
	;;=system. This number cannot be edited or deleted.
	;;^DD(161.4,11,"DT")
	;;=2940725
	;;^DD(161.4,12,0)
	;;=MEDICAL PAYMENT VENDOR DISPLAY^FXO^^0;11^I $D(X) D YN^FBAAUTL3
	;;^DD(161.4,12,.1)
	;;=DISPLAY VENDOR DEMOGRAPHICS DURING MEDICAL PAYMENT PROCESS
	;;^DD(161.4,12,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.4,12,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.4,12,3)
	;;=Answer 'Yes' or '1' for YES and 'No' or '0' for NO.
	;;^DD(161.4,12,21,0)
	;;=^^3^3^2880304^
	;;^DD(161.4,12,21,1,0)
	;;=This parameter is used to indicate whether the vendor's demographic
	;;^DD(161.4,12,21,2,0)
	;;=data will be displayed and made editable during the entering of a medical
	;;^DD(161.4,12,21,3,0)
	;;=payment.
	;;^DD(161.4,12,"DT")
	;;=2940318
	;;^DD(161.4,13,0)
	;;=PHARMACY PAYMNT VENDOR DISPLAY^FXO^^0;12^I $D(X) D YN^FBAAUTL3
	;;^DD(161.4,13,.1)
	;;=DISPLAY VENDOR DEMOGRAPHICS DURING THE ENTER PHARMACY INVOICE OPTION
	;;^DD(161.4,13,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.4,13,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.4,13,3)
	;;=Enter 'Yes' or '1' if you want Vendor Demographics to display during Enter Pharmacy Invoice option, otherwise answer 'No' or '0' for No.
	;;^DD(161.4,13,21,0)
	;;=^^1^1^2880304^^
	;;^DD(161.4,13,21,1,0)
	;;=If there is a 'Y' in this field, the Vendor Demographics will be displayed during the Enter Pharmacy Invoice option.
	;;^DD(161.4,13,"DT")
	;;=2940318
	;;^DD(161.4,14,0)
	;;=DEFAULT AUTH. TIME RANGE^NJ4,0^^0;13^K:+X'=X!(X>1095)!(X<0)!(X?.E1"."1N.N) X
	;;^DD(161.4,14,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 0 AND 1095
	;;^DD(161.4,14,21,0)
	;;=^^5^5^2880304^
	;;^DD(161.4,14,21,1,0)
	;;=The number of days that is the usual long term authorization. The data
	;;^DD(161.4,14,21,2,0)
	;;=entered here will be added to the Authorization From date and that date
	;;^DD(161.4,14,21,3,0)
	;;=will become the default 'To Date' for the authorization. For example,
	;;^DD(161.4,14,21,4,0)
	;;=if the normal long term authorization is one year, 364 would be entered
	;;^DD(161.4,14,21,5,0)
	;;=in this parameter.
	;;^DD(161.4,14,"DT")
	;;=2870223
	;;^DD(161.4,15,0)
	;;=ASK VENDOR DURING AUTH.^S^y:YES;^1;1^Q
	;;^DD(161.4,15,21,0)
	;;=^^1^1^2880608^
	;;^DD(161.4,15,21,1,0)
	;;=A 'yes' results in asking for Vendor in Enter Authorization.
	;;^DD(161.4,15,"DT")
	;;=2860911
	;;^DD(161.4,16,0)
	;;=STATION ADDRESS LINE 3^F^^1;2^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.4,16,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(161.4,16,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.4,16,21,1,0)
	;;=Line 3 of the COJ's street address.
	;;^DD(161.4,16,"DT")
	;;=2860922
	;;^DD(161.4,17,0)
	;;=MAX # PAYMENT LINE ITEMS^NJ3,0^^FBNUM;3^K:+X'=X!(X>100)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,17,3)
	;;=Type a Number between 1 and 100, 0 Decimal Digits
	;;^DD(161.4,17,21,0)
	;;=^^5^5^2901127^^^
	;;^DD(161.4,17,21,1,0)
	;;=The maximum number of payment line items that will be allowed in a batch.
	;;^DD(161.4,17,21,2,0)
	;;=Any number between 1 and 100 is acceptable. This value is checked
	;;^DD(161.4,17,21,3,0)
	;;=during the enter payment options and will warn the clerks when they 
	;;^DD(161.4,17,21,4,0)
	;;=are within 20 of the maximum. It will prevent the clerks from exceeding

FBINI00S
FBINI00S	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.4,17,21,5,0)
	;;=this number.
	;;^DD(161.4,17,"DT")
	;;=2901127
	;;^DD(161.4,19,0)
	;;=EDIT AUTH. DURING PAYMENT^FXO^^1;4^I $D(X) D YN^FBAAUTL3
	;;^DD(161.4,19,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.4,19,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.4,19,3)
	;;=Answer 'Yes' or '1' for YES and 'No' or '0' for NO.
	;;^DD(161.4,19,21,0)
	;;=^^5^5^2930826^^^
	;;^DD(161.4,19,21,1,0)
	;;=This field is used to indicate that editing of the Authorization Remarks
	;;^DD(161.4,19,21,2,0)
	;;=field and the 3 DX fields is allowable during the Enter Payment options.
	;;^DD(161.4,19,21,3,0)
	;;=Normally used for six months immediately after installing Fee system.
	;;^DD(161.4,19,21,4,0)
	;;=This is because the Remarks and DX data was not available for downloading
	;;^DD(161.4,19,21,5,0)
	;;=from Central Fee system.
	;;^DD(161.4,19,"DT")
	;;=2940318
	;;^DD(161.4,21,0)
	;;=*ASK PROGRAM SPECIFIC AUTH.^S^Y:YES;^1;6^Q
	;;^DD(161.4,21,21,0)
	;;=^^3^3^2881117^
	;;^DD(161.4,21,21,1,0)
	;;=A yes answer to this site parameter will show only those authorizations
	;;^DD(161.4,21,21,2,0)
	;;=that are program specific. An example would be the display for selection
	;;^DD(161.4,21,21,3,0)
	;;=of only Community Nursing Home authorizations when entering CNH payments.
	;;^DD(161.4,21,"DT")
	;;=2940318
	;;^DD(161.4,22,0)
	;;=APPROVING OFFICIAL FOR 7078^F^^1;7^K:$L(X)>45!($L(X)<3) X
	;;^DD(161.4,22,3)
	;;=ANSWER MUST BE 3-45 CHARACTERS IN LENGTH
	;;^DD(161.4,22,21,0)
	;;=^^1^1^2930519^^
	;;^DD(161.4,22,21,1,0)
	;;=The default approving official for 7078s.
	;;^DD(161.4,22,"DT")
	;;=2890203
	;;^DD(161.4,23,0)
	;;=TITLE 7078 APPROVING OFFICIAL^F^^1;8^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.4,23,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(161.4,23,21,0)
	;;=^^1^1^2930519^^
	;;^DD(161.4,23,21,1,0)
	;;=The title of the default approving official for 7078s.
	;;^DD(161.4,23,"DT")
	;;=2890203
	;;^DD(161.4,25,0)
	;;=COPIES OF 7078 TO BE PRINTED^RNJ1,0^^1;5^K:+X'=X!(X>5)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,25,3)
	;;=Type a Number between 1 and 5, 0 Decimal Digits
	;;^DD(161.4,25,21,0)
	;;=^^2^2^2930514^
	;;^DD(161.4,25,21,1,0)
	;;=Indicates the default number of copies to be printed for each 7078
	;;^DD(161.4,25,21,2,0)
	;;=generated.
	;;^DD(161.4,25,"DT")
	;;=2900306
	;;^DD(161.4,27,0)
	;;=PSA DEFAULT INSTITUTION^RP4'^DIC(4,^1;3^Q
	;;^DD(161.4,27,.1)
	;;=PRIMARY SERVICE FACILITY
	;;^DD(161.4,27,21,0)
	;;=^^2^2^2920617^^^^
	;;^DD(161.4,27,21,1,0)
	;;=The station number for the transmission of data to Austin is determined
	;;^DD(161.4,27,21,2,0)
	;;=using this field.
	;;^DD(161.4,27,"DT")
	;;=2900404
	;;^DD(161.4,28,0)
	;;=7078 DEFAULT AUTH SERVICE TEXT^161.428^^S;0
	;;^DD(161.4,28,21,0)
	;;=^^3^3^2930826^^
	;;^DD(161.4,28,21,1,0)
	;;=If data exists in this field it will be used as the default
	;;^DD(161.4,28,21,2,0)
	;;=for the 'Authorized Services' field on the 7078 for CONTRACT
	;;^DD(161.4,28,21,3,0)
	;;=HOSPITAL.
	;;^DD(161.4,29,0)
	;;=DATE BATCH PURGE LAST RUN^D^^PURGE;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.4,29,21,0)
	;;=^^1^1^2930519^^
	;;^DD(161.4,29,21,1,0)
	;;=Indicates the date the last batch purge was run on the system.
	;;^DD(161.4,29,"DT")
	;;=2901115
	;;^DD(161.4,30,0)
	;;=OUTPATIENT MONTHLY LIMITATION^RNJ5,0^^1;9^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,30,3)
	;;=Type a Number between 1 and 99999, 0 Decimal Digits. This amount is set by the program office.
	;;^DD(161.4,30,21,0)
	;;=^^2^2^2920515^
	;;^DD(161.4,30,21,1,0)
	;;=This field should contain the monthly Outpatient Medical dollar
	;;^DD(161.4,30,21,2,0)
	;;=limitation set by the program office.
	;;^DD(161.4,30,23,0)
	;;=^^3^3^2920515^
	;;^DD(161.4,30,23,1,0)
	;;=This field will replace the hard set dollar amount in the fee routines.
	;;^DD(161.4,30,23,2,0)
	;;=By do this, if the program office changes the dollar limitation, a
	;;^DD(161.4,30,23,3,0)
	;;=routine patch will not have to be issued.
	;;^DD(161.4,30,"DT")
	;;=2920515
	;;^DD(161.4,31,0)
	;;=TRANSMISSION HEADER^RFX^^1;10^K:$L(X)>3!($L(X)<3) X I $D(X) K:X'="FEN" X
	;;^DD(161.4,31,3)
	;;=Answer must be either 'FEE' or 'FEN', depending upon the version.

FBINI00T
FBINI00T	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.4,31,21,0)
	;;=^^5^5^2920629^^
	;;^DD(161.4,31,21,1,0)
	;;=The Transmission Header field is used as part of the header information
	;;^DD(161.4,31,21,2,0)
	;;=for transmissions sent to Austin.  Header names change alternately
	;;^DD(161.4,31,21,3,0)
	;;=to FEE or FEN in FEE releases which contain changes to transmission
	;;^DD(161.4,31,21,4,0)
	;;=data/Austin record layouts.  Austin uses the Transmission Header to 
	;;^DD(161.4,31,21,5,0)
	;;=distinguish the record layout to be used.
	;;^DD(161.4,31,23,0)
	;;=^^2^2^2920629^
	;;^DD(161.4,31,23,1,0)
	;;=The variable FBHD is set to this piece.  It can be found in the 
	;;^DD(161.4,31,23,2,0)
	;;=transmission routines subset, FBAAV0:FBAAV6, FBAAV01.
	;;^DD(161.4,31,"DT")
	;;=2940413
	;;^DD(161.4,32,0)
	;;=TRACK INCOMPLETE UNAUTH CLAIM?^S^1:YES;0:NO;^UC;1^Q
	;;^DD(161.4,32,.1)
	;;=TRACK INCOMPLETE UNAUTHORIZED CLAIMS?
	;;^DD(161.4,32,3)
	;;=Indicate yes if incomplete unauthorized claims will be tracked.
	;;^DD(161.4,32,21,0)
	;;=^^2^2^2930511^
	;;^DD(161.4,32,21,1,0)
	;;=Indicate whether or not incomplete unauthorized claims should be tracked.
	;;^DD(161.4,32,21,2,0)
	;;=Yes is to track incomplete claims, otherwise can only track complete claims.
	;;^DD(161.4,32,"DT")
	;;=2930318
	;;^DD(161.4,32.5,0)
	;;='INITIAL ENTRY' STATUS FOR U/C^S^1:ACTIVATE;^UC;7^Q
	;;^DD(161.4,32.5,3)
	;;=If you wish to activate the 'INITIAL ENTRY' status then fill in this field.  Activation will result in minimum data input when entering in an unauthorized claim.
	;;^DD(161.4,32.5,21,0)
	;;=^^6^6^2930913^^
	;;^DD(161.4,32.5,21,1,0)
	;;=If this field is filled in, then minimum data is required for entering in
	;;^DD(161.4,32.5,21,2,0)
	;;=an unauthorized claim.  This is designed for sites who have streamlined
	;;^DD(161.4,32.5,21,3,0)
	;;=their workload, where only one user enters in the unauthorized claims
	;;^DD(161.4,32.5,21,4,0)
	;;=received, and another reviews the claim for completeness and makes the 
	;;^DD(161.4,32.5,21,5,0)
	;;=necessary requests, etc.
	;;^DD(161.4,32.5,21,6,0)
	;;=  
	;;^DD(161.4,32.5,23,0)
	;;=^^6^6^2930913^^
	;;^DD(161.4,32.5,23,1,0)
	;;=The code in routine FBUCEN, enter routine, will branch depending upon the
	;;^DD(161.4,32.5,23,2,0)
	;;=value of this field.  If it is not filled in, the user will be required to
	;;^DD(161.4,32.5,23,3,0)
	;;=enter the necessary data in order to determine if the claim is INCOMPLETE
	;;^DD(161.4,32.5,23,4,0)
	;;=or COMPLETE/PENDING REVIEW.  Otherwise, claim is given the INTIAL ENTRY 
	;;^DD(161.4,32.5,23,5,0)
	;;=status, which means further follow up by Fee clerk is required.
	;;^DD(161.4,32.5,23,6,0)
	;;= VENDOR and TREATMENT TO DATE fields are optional.
	;;^DD(161.4,32.5,"DT")
	;;=2930707
	;;^DD(161.4,33,0)
	;;=UNAUTHORIZED CLAIM PRINTER^FX^^UC;2^K:$L(X)>30!($L(X)<1) X K:$D(X)&($$DEV^FBUCDD1(X)) X
	;;^DD(161.4,33,3)
	;;=Enter the name of a default printer to which unauthorized letters will print.  The printer name should exactly match a name of a printer in the device file.
	;;^DD(161.4,33,4)
	;;=D XHELP^FBUCDD1
	;;^DD(161.4,33,12)
	;;=Select a device with a printer subtype.
	;;^DD(161.4,33,12.1)
	;;=S DIC("S")="S Z=$G(^%ZIS(1,+Y,""SUBTYPE"")),Z=$G(^%ZIS(2,Z,0)) I $E($P(Z,U),1)=""P"" K Z"
	;;^DD(161.4,33,21,0)
	;;=^^2^2^2930420^^^^
	;;^DD(161.4,33,21,1,0)
	;;=Field should contain the name of a printer device to which unauthorized
	;;^DD(161.4,33,21,2,0)
	;;=claim letters will print, if filled in.  Entry in this field is optional.
	;;^DD(161.4,33,23,0)
	;;=^^2^2^2930420^^
	;;^DD(161.4,33,23,1,0)
	;;=Input transform limits entry to valid device name with a subtype which
	;;^DD(161.4,33,23,2,0)
	;;=begins with "P" for printer terminal types.
	;;^DD(161.4,33,"DT")
	;;=2930910
	;;^DD(161.4,34,0)
	;;=UNAUTHORIZED CLAIM LETTER^S^A:AUTOMATIC PRINT;B:BATCH PRINT;^UC;3^Q
	;;^DD(161.4,34,3)
	;;=Enter 'A'utomatic if your printer is dedicated, 'B'atch to print the letters using the option.  If automatic, a printer must be designated in the UNAUTHORIZED CLAIM PRINTER parameter.
	;;^DD(161.4,34,21,0)
	;;=^^6^6^2930402^^

FBINI00U
FBINI00U	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.4,34,21,1,0)
	;;=Indicate how you wish your unauthorized claim letters to print.
	;;^DD(161.4,34,21,2,0)
	;;= Enter a 'A' if the Unauthorized Claim Printer is dedicated and you always
	;;^DD(161.4,34,21,3,0)
	;;=wish a letter to print when it has been changed to the apppropriate status.
	;;^DD(161.4,34,21,4,0)
	;;= Enter a 'B' if the Unauthorized Claim Printer is not dedicated, or you wish
	;;^DD(161.4,34,21,5,0)
	;;=to batch print letters of claims which have changed to the appropriate status.
	;;^DD(161.4,34,21,6,0)
	;;= Do not enter anything if you will be manually generating your own form letter.
	;;^DD(161.4,34,23,0)
	;;=^^3^3^2930402^^
	;;^DD(161.4,34,23,1,0)
	;;=If value of field is set to 'B'atch or if value is set to 'A'utomatic but
	;;^DD(161.4,34,23,2,0)
	;;=the UNAUTHORIZED CLAIM PRINTER has no value, a cross-reference will get set
	;;^DD(161.4,34,23,3,0)
	;;=when a letter needs to be printed.
	;;^DD(161.4,34,"DT")
	;;=2930402
	;;^DD(161.4,35,0)
	;;=NUMBER OF COPIES^NJ1,0^^UC;4^K:+X'=X!(X>5)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,35,3)
	;;=Enter the default number of copies you wish to print for an unauthorized claim letter.  Maximum number of copies allowed is five.
	;;^DD(161.4,35,21,0)
	;;=^^2^2^2930628^^^^
	;;^DD(161.4,35,21,1,0)
	;;=The number of copies of a letter to be printed.
	;;^DD(161.4,35,21,2,0)
	;;=Maximum number of copies allowed is five.
	;;^DD(161.4,35,23,0)
	;;=^^3^3^2930628^^^
	;;^DD(161.4,35,23,1,0)
	;;=Field is used in printing of unauthorized claim letters.  If the user is 
	;;^DD(161.4,35,23,2,0)
	;;=not prompted for the number of copies, the value in this field will be used.
	;;^DD(161.4,35,23,3,0)
	;;=If no value exists, only one copy will print.
	;;^DD(161.4,35,"DT")
	;;=2930406
	;;^DD(161.4,35.5,0)
	;;=PRINT U/C ON LETTERHEAD?^S^1:Y;^UC;8^Q
	;;^DD(161.4,35.5,3)
	;;=Enter a value in this field if your unauthorized claims letters will print on VA letterhead.  If there is no entry, the station name and address from the FEE BASIS SITE PARAMETERS file will print.
	;;^DD(161.4,35.5,4)
	;;=W !,"No entry is necessary if you will not be printing letters."
	;;^DD(161.4,35.5,21,0)
	;;=^^2^2^2941128^
	;;^DD(161.4,35.5,21,1,0)
	;;=Answer 'Yes' if you will be printing Unauthorized Claims' letters
	;;^DD(161.4,35.5,21,2,0)
	;;=on VHA letterhead.
	;;^DD(161.4,35.5,"DT")
	;;=2930707
	;;^DD(161.4,35.6,0)
	;;=STATION NAME (EDITABLE)^RF^^UC;9^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.4,35.6,3)
	;;=Enter the first line of return address, 3-30 characters.
	;;^DD(161.4,35.6,21,0)
	;;=^^1^1^2930911^
	;;^DD(161.4,35.6,21,1,0)
	;;=First line of return address.  Data pulled from .01; but is editable.
	;;^DD(161.4,35.6,"DT")
	;;=2930911
	;;^DD(161.4,36,0)
	;;=*LAST UC UPDATED^NJ7,0^^UC;5^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.4,36,3)
	;;=Last unauthorized claim record which was updated in the conversion.
	;;^DD(161.4,36,21,0)
	;;=^^1^1^2940714^
	;;^DD(161.4,36,21,1,0)
	;;=Last unauthorized claim record which was updated in the conversion.
	;;^DD(161.4,36,23,0)
	;;=^^2^2^2940714^
	;;^DD(161.4,36,23,1,0)
	;;=Field is populated by the post-init in FEE, version 3.  It is used
	;;^DD(161.4,36,23,2,0)
	;;=as a starting point, in the event the post-init must be re-run.
	;;^DD(161.4,36,"DT")
	;;=2940714
	;;^DD(161.4,37,0)
	;;=*DATE UC CONVERSION COMPLETED^D^^UC;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.4,37,3)
	;;=Date the post init completed converting unauthorized claims.
	;;^DD(161.4,37,21,0)
	;;=^^1^1^2940714^
	;;^DD(161.4,37,21,1,0)
	;;=Date the post init completed converting unauthorized claims.
	;;^DD(161.4,37,23,0)
	;;=^^1^1^2940714^
	;;^DD(161.4,37,23,1,0)
	;;=Checked in the post-init.  If a value exists the post-init will not re-run.
	;;^DD(161.4,37,"DT")
	;;=2940714
	;;^DD(161.428,0)
	;;=7078 DEFAULT AUTH SERVICE TEXT SUB-FIELD^^.01^1
	;;^DD(161.428,0,"NM","7078 DEFAULT AUTH SERVICE TEXT")
	;;=
	;;^DD(161.428,0,"UP")
	;;=161.4
	;;^DD(161.428,.01,0)
	;;=7078 DEFAULT AUTH SERVICE TEXT^WL^^0;1^Q
	;;^DD(161.428,.01,"DT")
	;;=2900409

FBINI00V
FBINI00V	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.5,0,"GL")
	;;=^FBAA(161.5,
	;;^DIC("B","FEE CH REPORT OF CONTACT",161.5)
	;;=
	;;^DIC(161.5,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(161.5,"%D",1,0)
	;;=Stores report of contact information for contract (civil) hospital
	;;^DIC(161.5,"%D",2,0)
	;;=program.
	;;^DIC(161.5,"%D",3,0)
	;;= 
	;;^DIC(161.5,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.5,0)
	;;=FIELD^^19^22
	;;^DD(161.5,0,"DT")
	;;=2940318
	;;^DD(161.5,0,"ID",2)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^DPT(+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(161.5,0,"IX","B",161.5,.01)
	;;=
	;;^DD(161.5,0,"IX","D",161.5,2)
	;;=
	;;^DD(161.5,0,"NM","FEE CH REPORT OF CONTACT")
	;;=
	;;^DD(161.5,.01,0)
	;;=ASSOCIATED REQUEST^P162.2'X^FBAA(162.2,^0;1^S:$D(X) DINUM=X
	;;^DD(161.5,.01,1,0)
	;;=^.1
	;;^DD(161.5,.01,1,1,0)
	;;=161.5^B
	;;^DD(161.5,.01,1,1,1)
	;;=S ^FBAA(161.5,"B",$E(X,1,30),DA)=""
	;;^DD(161.5,.01,1,1,2)
	;;=K ^FBAA(161.5,"B",$E(X,1,30),DA)
	;;^DD(161.5,.01,3)
	;;=
	;;^DD(161.5,.01,21,0)
	;;=^^2^2^2930514^^
	;;^DD(161.5,.01,21,1,0)
	;;=This is the report of contact associated with a notification/
	;;^DD(161.5,.01,21,2,0)
	;;=request in contract hospital.
	;;^DD(161.5,1,0)
	;;=VENDOR^RP161.2'^FBAAV(^0;2^Q
	;;^DD(161.5,1,21,0)
	;;=^^2^2^2900813^
	;;^DD(161.5,1,21,1,0)
	;;=This is the Fee Basis Vendor, associated with the Contract
	;;^DD(161.5,1,21,2,0)
	;;=Hospital Notification/Request.
	;;^DD(161.5,2,0)
	;;=VETERAN^P2'^DPT(^0;3^Q
	;;^DD(161.5,2,1,0)
	;;=^.1
	;;^DD(161.5,2,1,1,0)
	;;=161.5^D
	;;^DD(161.5,2,1,1,1)
	;;=S ^FBAA(161.5,"D",$E(X,1,30),DA)=""
	;;^DD(161.5,2,1,1,2)
	;;=K ^FBAA(161.5,"D",$E(X,1,30),DA)
	;;^DD(161.5,2,21,0)
	;;=^^2^2^2900813^
	;;^DD(161.5,2,21,1,0)
	;;=This is the name of the veteran who is requesting contract hospital
	;;^DD(161.5,2,21,2,0)
	;;=services from the VA.
	;;^DD(161.5,2,"DT")
	;;=2900814
	;;^DD(161.5,3,0)
	;;=INITIAL DATE OF CONTACT^D^^0;4^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.5,3,21,0)
	;;=^^2^2^2900813^
	;;^DD(161.5,3,21,1,0)
	;;=This field corresponds to the Date/Time field of the Fee
	;;^DD(161.5,3,21,2,0)
	;;=Notification/Request file.
	;;^DD(161.5,4,0)
	;;=AUTHORIZATION FROM DATE^D^^0;5^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.5,4,21,0)
	;;=^^1^1^2900813^
	;;^DD(161.5,4,21,1,0)
	;;=This field contains the date/time of admission of the veteran.
	;;^DD(161.5,4,"DT")
	;;=2930312
	;;^DD(161.5,5,0)
	;;=TYPE OF CONTACT^RS^T:telephone;P:personal;^0;6^Q
	;;^DD(161.5,5,21,0)
	;;=^^1^1^2901109^^^^
	;;^DD(161.5,5,21,1,0)
	;;=This is a way of identifying how the report of contact was initiated.
	;;^DD(161.5,6,0)
	;;=PERSON CONTACTED^F^^0;7^K:$L(X)>40!($L(X)<3) X
	;;^DD(161.5,6,3)
	;;=Answer must be 3-40 characters in length.
	;;^DD(161.5,6,21,0)
	;;=^^1^1^2900813^
	;;^DD(161.5,6,21,1,0)
	;;=This is the name of the person who called.
	;;^DD(161.5,6.5,0)
	;;=PHONE # OF PERSON CONTACTED^F^^1;4^K:$L(X)>20!($L(X)<3) X
	;;^DD(161.5,6.5,3)
	;;=Answer must be 3-20 characters in length.
	;;^DD(161.5,6.5,21,0)
	;;=^^1^1^2930519^^
	;;^DD(161.5,6.5,21,1,0)
	;;=The phone number of the person with whom initial contact was made.
	;;^DD(161.5,6.5,"DT")
	;;=2900816
	;;^DD(161.5,7,0)
	;;=STREET ADDRESS[1] OF CONTACT^F^^0;8^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.5,7,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(161.5,7,21,0)
	;;=^^1^1^2900813^
	;;^DD(161.5,7,21,1,0)
	;;=This is the street address of person who called.
	;;^DD(161.5,8,0)
	;;=STREET ADDRESS[2] OF CONTACT^F^^0;9^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.5,8,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(161.5,8,21,0)
	;;=^^2^2^2900813^
	;;^DD(161.5,8,21,1,0)
	;;=This is a continuation line for the street address of the
	;;^DD(161.5,8,21,2,0)
	;;=person who called.
	;;^DD(161.5,9,0)
	;;=CITY OF CONTACT^F^^0;10^K:$L(X)>30!($L(X)<2) X
	;;^DD(161.5,9,3)
	;;=Answer must be 2-30 characters in length.
	;;^DD(161.5,9,21,0)
	;;=^^1^1^2900813^
	;;^DD(161.5,9,21,1,0)
	;;=This is the city of the person who called.
	;;^DD(161.5,10,0)
	;;=STATE OF CONTACT^P5'^DIC(5,^0;11^Q

FBINI00W
FBINI00W	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.5,10,21,0)
	;;=^^1^1^2900813^^
	;;^DD(161.5,10,21,1,0)
	;;=This is the state of the person who called.
	;;^DD(161.5,11,0)
	;;=ZIP CODE OF CONTACT^FX^^0;12^K:$L(X)>5!($L(X)<5)!'(X?5N) X
	;;^DD(161.5,11,3)
	;;=Answer must be 5 characters in length.
	;;^DD(161.5,11,21,0)
	;;=^^2^2^2900813^
	;;^DD(161.5,11,21,1,0)
	;;=This is the zip code associated with the address of the
	;;^DD(161.5,11,21,2,0)
	;;=person who called.
	;;^DD(161.5,12,0)
	;;=ATTENDING PHYSICIAN^F^^0;13^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.5,12,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(161.5,12,21,0)
	;;=^^2^2^2900831^^^
	;;^DD(161.5,12,21,1,0)
	;;=This is the name of the attending physician treating the
	;;^DD(161.5,12,21,2,0)
	;;=patient at the contract hospital.
	;;^DD(161.5,12,"DT")
	;;=2900831
	;;^DD(161.5,13,0)
	;;=ATTEND.PHYSICIAN TELEPHONE NO.^F^^0;14^K:$L(X)>20!($L(X)<3) X
	;;^DD(161.5,13,3)
	;;=Answer must be 3-20 characters in length.
	;;^DD(161.5,13,21,0)
	;;=^^2^2^2900831^^
	;;^DD(161.5,13,21,1,0)
	;;=This is the number where the attending physician may
	;;^DD(161.5,13,21,2,0)
	;;=be reached.
	;;^DD(161.5,14,0)
	;;=TENTATIVE DIAGNOSIS^F^^1;1^K:$L(X)>45!($L(X)<3) X
	;;^DD(161.5,14,3)
	;;=Answer must be 3-45 characters in length.
	;;^DD(161.5,14,21,0)
	;;=^^1^1^2900813^^
	;;^DD(161.5,14,21,1,0)
	;;=Initial diagnosis given at the time of notification.
	;;^DD(161.5,15,0)
	;;=INSURANCE TYPE^F^^1;2^K:$L(X)>30!($L(X)<3) X
	;;^DD(161.5,15,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(161.5,15,21,0)
	;;=^^2^2^2900813^
	;;^DD(161.5,15,21,1,0)
	;;=This allows the user to document any other insurance the
	;;^DD(161.5,15,21,2,0)
	;;=veteran may have.
	;;^DD(161.5,16,0)
	;;=MODE OF TRANSPORTATION^P392.4'^DGBT(392.4,^1;3^Q
	;;^DD(161.5,16,3)
	;;=
	;;^DD(161.5,16,21,0)
	;;=^^2^2^2900813^
	;;^DD(161.5,16,21,1,0)
	;;=This field allows the user to enter in the planned transportation
	;;^DD(161.5,16,21,2,0)
	;;=of the veteran at time of transfer from contract hospital.
	;;^DD(161.5,16,"DT")
	;;=2900816
	;;^DD(161.5,16.5,0)
	;;=VETERAN HAVE OTHER INSURANCE^FXO^^1;5^I $D(X) D YN^FBAAUTL3
	;;^DD(161.5,16.5,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(161.5,16.5,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(161.5,16.5,3)
	;;=Answer 'Yes' or '1' for YES and 'No' or '0' for NO.
	;;^DD(161.5,16.5,21,0)
	;;=^^2^2^2900816^
	;;^DD(161.5,16.5,21,1,0)
	;;=If the user answers 'Yes' to this question then they will be
	;;^DD(161.5,16.5,21,2,0)
	;;=asked Insurance type.
	;;^DD(161.5,16.5,"DT")
	;;=2940318
	;;^DD(161.5,17,0)
	;;=DATE/TIME OF CONTACT^161.517D^^2;0
	;;^DD(161.5,17,21,0)
	;;=^^3^3^2941128^
	;;^DD(161.5,17,21,1,0)
	;;=This multiple allows the CH user to enter contacts
	;;^DD(161.5,17,21,2,0)
	;;=that were made with the VA on behalf of
	;;^DD(161.5,17,21,3,0)
	;;=a patient who was admitted to a non-VA facility for treatment.
	;;^DD(161.5,18,0)
	;;=APPROVING OFFICIAL^P200'^VA(200,^1;6^Q
	;;^DD(161.5,18,21,0)
	;;=^^2^2^2900817^
	;;^DD(161.5,18,21,1,0)
	;;=This is the official who is approving/disapproving the
	;;^DD(161.5,18,21,2,0)
	;;=contract hospitalization.
	;;^DD(161.5,18,"DT")
	;;=2900817
	;;^DD(161.5,19,0)
	;;=DATE/TIME OF ADMISSION^DX^^1;7^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.5,19,21,0)
	;;=^^1^1^2930514^
	;;^DD(161.5,19,21,1,0)
	;;=The date and time the veteran was admitted to a non-VA facility for care.
	;;^DD(161.5,19,"DT")
	;;=2930312
	;;^DD(161.517,0)
	;;=DATE/TIME OF CONTACT SUB-FIELD^^2^3
	;;^DD(161.517,0,"IX","B",161.517,.01)
	;;=
	;;^DD(161.517,0,"NM","DATE/TIME OF CONTACT")
	;;=
	;;^DD(161.517,0,"UP")
	;;=161.5
	;;^DD(161.517,.01,0)
	;;=DATE/TIME OF CONTACT^DX^^0;1^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.517,.01,1,0)
	;;=^.1
	;;^DD(161.517,.01,1,1,0)
	;;=161.517^B
	;;^DD(161.517,.01,1,1,1)
	;;=S ^FBAA(161.5,DA(1),2,"B",$E(X,1,30),DA)=""
	;;^DD(161.517,.01,1,1,2)
	;;=K ^FBAA(161.5,DA(1),2,"B",$E(X,1,30),DA)
	;;^DD(161.517,.01,21,0)
	;;=^^2^2^2941128^^
	;;^DD(161.517,.01,21,1,0)
	;;=The date and time initial contact was made with the VA on behalf of
	;;^DD(161.517,.01,21,2,0)
	;;=a patient who was admitted to a non-VA facility for treatment.

FBINI00X
FBINI00X	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.517,.01,"DT")
	;;=2900814
	;;^DD(161.517,1,0)
	;;=NARRATIVE^161.5171^^1;0
	;;^DD(161.517,1,21,0)
	;;=^^1^1^2900813^
	;;^DD(161.517,1,21,1,0)
	;;=This contains the contents of the report of contact.
	;;^DD(161.517,2,0)
	;;=USER^RP200'^VA(200,^0;2^Q
	;;^DD(161.517,2,21,0)
	;;=^^2^2^2941128^
	;;^DD(161.517,2,21,1,0)
	;;=This field captures the name of the user who enters the
	;;^DD(161.517,2,21,2,0)
	;;=report of contact.
	;;^DD(161.5171,0)
	;;=NARRATIVE SUB-FIELD^^.01^1
	;;^DD(161.5171,0,"NM","NARRATIVE")
	;;=
	;;^DD(161.5171,0,"UP")
	;;=161.517
	;;^DD(161.5171,.01,0)
	;;=NARRATIVE^W^^0;1^Q

FBINI00Y
FBINI00Y	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.6,0,"GL")
	;;=^FBAA(161.6,
	;;^DIC("B","FEE BASIS SPECIALTY CODE",161.6)
	;;=
	;;^DIC(161.6,"%D",0)
	;;=^^3^3^2940622^^^^
	;;^DIC(161.6,"%D",1,0)
	;;=Contains all valid Specialty codes which can be assigned to a vendor.
	;;^DIC(161.6,"%D",2,0)
	;;= 
	;;^DIC(161.6,"%D",3,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.6,0)
	;;=FIELD^^1^2
	;;^DD(161.6,0,"DDA")
	;;=N
	;;^DD(161.6,0,"ID",1)
	;;=W:$D(^(0)) "   ",$P(^(0),U,2)
	;;^DD(161.6,0,"IX","B",161.6,.01)
	;;=
	;;^DD(161.6,0,"IX","C",161.6,1)
	;;=
	;;^DD(161.6,0,"NM","FEE BASIS SPECIALTY CODE")
	;;=
	;;^DD(161.6,0,"PT",161.2,.05)
	;;=
	;;^DD(161.6,.01,0)
	;;=NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
	;;^DD(161.6,.01,1,0)
	;;=^.1
	;;^DD(161.6,.01,1,1,0)
	;;=161.6^B
	;;^DD(161.6,.01,1,1,1)
	;;=S ^FBAA(161.6,"B",$E(X,1,30),DA)=""
	;;^DD(161.6,.01,1,1,2)
	;;=K ^FBAA(161.6,"B",$E(X,1,30),DA)
	;;^DD(161.6,.01,3)
	;;=NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
	;;^DD(161.6,.01,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.6,.01,21,1,0)
	;;=The name of this specialty code. Each vendor must be assigned a specialty
	;;^DD(161.6,.01,21,2,0)
	;;=code which identifies their area of expertise.
	;;^DD(161.6,1,0)
	;;=SPECIALTY CODE^RF^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>2!($L(X)<2)!'(X?2N) X
	;;^DD(161.6,1,1,0)
	;;=^.1
	;;^DD(161.6,1,1,1,0)
	;;=161.6^C
	;;^DD(161.6,1,1,1,1)
	;;=S ^FBAA(161.6,"C",$E(X,1,30),DA)=""
	;;^DD(161.6,1,1,1,2)
	;;=K ^FBAA(161.6,"C",$E(X,1,30),DA)
	;;^DD(161.6,1,3)
	;;=ANSWER MUST BE 2 CHARACTERS IN LENGTH
	;;^DD(161.6,1,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.6,1,21,1,0)
	;;=The specialty code for this entry. Detail description and list of most
	;;^DD(161.6,1,21,2,0)
	;;=current codes can be found in M-1, Part I, Chapter 18.

FBINI00Z
FBINI00Z	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(161.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,161.6)
	;;=^FBAA(161.6,
	;;^UTILITY(U,$J,161.6,0)
	;;=FEE BASIS SPECIALTY CODE^161.6I^35^35
	;;^UTILITY(U,$J,161.6,1,0)
	;;=ALLERGY AND IMMUNOLOGY^16
	;;^UTILITY(U,$J,161.6,2,0)
	;;=ANESTHESIOLOGY^01^^^^^^^455^^1
	;;^UTILITY(U,$J,161.6,3,0)
	;;=DERMATOLOGY^30
	;;^UTILITY(U,$J,161.6,4,0)
	;;=INTERNAL MEDICINE^32
	;;^UTILITY(U,$J,161.6,5,0)
	;;=NEUROLOGICAL SURGERY^04
	;;^UTILITY(U,$J,161.6,6,0)
	;;=NEUROLOGY^50
	;;^UTILITY(U,$J,161.6,7,0)
	;;=OBSTETRICS AND GYNECOLOGY^03
	;;^UTILITY(U,$J,161.6,8,0)
	;;=OPHTHALMOLOGY^06
	;;^UTILITY(U,$J,161.6,9,0)
	;;=ORTHOPEDIC^07
	;;^UTILITY(U,$J,161.6,10,0)
	;;=OTOLARYNGOLOGY (ENT)^08
	;;^UTILITY(U,$J,161.6,11,0)
	;;=FAMILY PRACTICE^15
	;;^UTILITY(U,$J,161.6,12,0)
	;;=NUCLEAR MEDICINE^17
	;;^UTILITY(U,$J,161.6,13,0)
	;;=PATHOLOGY^72
	;;^UTILITY(U,$J,161.6,14,0)
	;;=PEDIATRICS^40
	;;^UTILITY(U,$J,161.6,15,0)
	;;=PHYSICAL MEDICINE AND REHAB.^73
	;;^UTILITY(U,$J,161.6,16,0)
	;;=PLASTIC SURGERY^09
	;;^UTILITY(U,$J,161.6,17,0)
	;;=PREVENTIVE MED./PUBLIC HEALTH^41
	;;^UTILITY(U,$J,161.6,18,0)
	;;=COLON AND RECTAL SURGERY^10
	;;^UTILITY(U,$J,161.6,19,0)
	;;=PSYCHIATRY^51
	;;^UTILITY(U,$J,161.6,20,0)
	;;=PSYCHIATRY AND NEUROLOGY^52
	;;^UTILITY(U,$J,161.6,21,0)
	;;=RADIOLOGY^61
	;;^UTILITY(U,$J,161.6,22,0)
	;;=SURGERY^02
	;;^UTILITY(U,$J,161.6,23,0)
	;;=THORACIC SURGERY^11
	;;^UTILITY(U,$J,161.6,24,0)
	;;=UROLOGY^12
	;;^UTILITY(U,$J,161.6,25,0)
	;;=PHYSICIANS-NONDIPLOMATS^99
	;;^UTILITY(U,$J,161.6,26,0)
	;;=PULMONARY^13
	;;^UTILITY(U,$J,161.6,27,0)
	;;=CARDIOLOGY^14
	;;^UTILITY(U,$J,161.6,28,0)
	;;=NEPHROLOGY^18
	;;^UTILITY(U,$J,161.6,29,0)
	;;=INFECTIOUS DISEASE^19
	;;^UTILITY(U,$J,161.6,30,0)
	;;=OPTOMETRY^20
	;;^UTILITY(U,$J,161.6,31,0)
	;;=RHEUMATOLOGY^21
	;;^UTILITY(U,$J,161.6,32,0)
	;;=GASTROENTEROLOGY^22
	;;^UTILITY(U,$J,161.6,33,0)
	;;=PODIATRY^23
	;;^UTILITY(U,$J,161.6,34,0)
	;;=ONCOLOGY^24
	;;^UTILITY(U,$J,161.6,35,0)
	;;=ENDOCRINOLOGY^25

FBINI010
FBINI010	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.7,0,"GL")
	;;=^FBAA(161.7,
	;;^DIC("B","FEE BASIS BATCH",161.7)
	;;=
	;;^DIC(161.7,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(161.7,"%D",1,0)
	;;=Contain all batches established by Fee Basis users. Payments are assigned
	;;^DIC(161.7,"%D",2,0)
	;;=to a batch and payment data is transmitted for payment in batches.
	;;^DIC(161.7,"%D",3,0)
	;;= 
	;;^DIC(161.7,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.7,0)
	;;=FIELD^^19^20
	;;^DD(161.7,0,"DT")
	;;=2940921
	;;^DD(161.7,0,"ID",1)
	;;=W "   ",$P($G(^(0)),U,2)
	;;^DD(161.7,0,"IX","AB",161.7,11)
	;;=
	;;^DD(161.7,0,"IX","AC",161.7,11)
	;;=
	;;^DD(161.7,0,"IX","AF",161.7,13)
	;;=
	;;^DD(161.7,0,"IX","B",161.7,.01)
	;;=
	;;^DD(161.7,0,"IX","C",161.7,4)
	;;=
	;;^DD(161.7,0,"NM","FEE BASIS BATCH")
	;;=
	;;^DD(161.7,0,"PT",162.03,7)
	;;=
	;;^DD(161.7,0,"PT",162.03,21)
	;;=
	;;^DD(161.7,0,"PT",162.04,1)
	;;=
	;;^DD(161.7,0,"PT",162.04,6)
	;;=
	;;^DD(161.7,0,"PT",162.1,10)
	;;=
	;;^DD(161.7,0,"PT",162.11,13)
	;;=
	;;^DD(161.7,0,"PT",162.11,19)
	;;=
	;;^DD(161.7,0,"PT",162.5,15)
	;;=
	;;^DD(161.7,0,"PT",162.5,20)
	;;=
	;;^DD(161.7,.01,0)
	;;=NUMBER^RFIX^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>5!($L(X)<1)!'(X'?1P.E)!(X'?.ANP) X I $D(X),'$$CHKBI^FBAAUTL4(X,1) K X
	;;^DD(161.7,.01,1,0)
	;;=^.1^^-1
	;;^DD(161.7,.01,1,1,0)
	;;=161.7^B
	;;^DD(161.7,.01,1,1,1)
	;;=S ^FBAA(161.7,"B",$E(X,1,30),DA)=""
	;;^DD(161.7,.01,1,1,2)
	;;=K ^FBAA(161.7,"B",$E(X,1,30),DA)
	;;^DD(161.7,.01,3)
	;;=ANSWER MUST BE 1-5 CHARACTERS IN LENGTH
	;;^DD(161.7,.01,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.7,.01,21,1,0)
	;;=The number identifying this batch. The batch number is automatically
	;;^DD(161.7,.01,21,2,0)
	;;=assigned to the batch when a clerk opens a batch. 
	;;^DD(161.7,.01,"DEL",.01,0)
	;;=S Z=$P(^FBAA(161.7,D0,0),U,3) I $S(Z="B3":$S($D(^FBAAC("AC",D0)):1,1:0),Z="B2":$S($D(^FBAAC("AD",D0)):1,1:0),Z="B5":$S($D(^FBAA(162.1,"AE",D0)):1,1:0),1:0) W !,*7,"Batch has activity, cannot be deleted!"
	;;^DD(161.7,.01,"DT")
	;;=2940722
	;;^DD(161.7,1,0)
	;;=OBLIGATION NUMBER^RFX^^0;2^K:$L(X)>6!($L(X)<6) X D:$D(X) CKOB^FBAAUTL1
	;;^DD(161.7,1,3)
	;;=ANSWER MUST BE 6 CHARACTERS IN LENGTH
	;;^DD(161.7,1,21,0)
	;;=^^5^5^2880304^
	;;^DD(161.7,1,21,1,0)
	;;=The obligation number (which must exist in the obligation file) 
	;;^DD(161.7,1,21,2,0)
	;;=associated with this batch number. When this batch is processed
	;;^DD(161.7,1,21,3,0)
	;;=by the Austin Central Fee system, and passed to the CALM payment
	;;^DD(161.7,1,21,4,0)
	;;=system, the funds for these payments will be from the obligation
	;;^DD(161.7,1,21,5,0)
	;;=number identified here.
	;;^DD(161.7,1,"DT")
	;;=2890720
	;;^DD(161.7,2,0)
	;;=TYPE^RS^B3:MEDICAL PAYMENTS;B5:HOMETOWN PHARMACY PAYMENTS;C1:VENDOR FILE ACTIVITIES;C2:VETERAN MRA ACTIVITIES;C4:PHARMACY FILE ACTIVITIES;B2:TRAVEL PAYMENTS;B9:CH/CNH;^0;3^Q
	;;^DD(161.7,2,21,0)
	;;=^^3^3^2880304^
	;;^DD(161.7,2,21,1,0)
	;;=The type field identifies what type of records will be contained in this
	;;^DD(161.7,2,21,2,0)
	;;=batch. For example, this could be a 'Pharmacy Payment' type batch or 
	;;^DD(161.7,2,21,3,0)
	;;=could be a 'Medical Payment' type batch.
	;;^DD(161.7,2,"DT")
	;;=2940921
	;;^DD(161.7,3,0)
	;;=DATE OPENED^DX^^0;4^S %DT="EX",%DT(0)="-"_DT D ^%DT S X=Y K:Y<1 X
	;;^DD(161.7,3,21,0)
	;;=^^2^2^2930519^^^
	;;^DD(161.7,3,21,1,0)
	;;=The date this batch was opened by the clerk or the date it was last 
	;;^DD(161.7,3,21,2,0)
	;;=reopened by the clerk or supervisor.
	;;^DD(161.7,3,"DT")
	;;=2900507
	;;^DD(161.7,4,0)
	;;=CLERK WHO OPENED^P200'^VA(200,^0;5^Q
	;;^DD(161.7,4,1,0)
	;;=^.1
	;;^DD(161.7,4,1,1,0)
	;;=161.7^C
	;;^DD(161.7,4,1,1,1)
	;;=S ^FBAA(161.7,"C",$E(X,1,30),DA)=""
	;;^DD(161.7,4,1,1,2)
	;;=K ^FBAA(161.7,"C",$E(X,1,30),DA)
	;;^DD(161.7,4,21,0)
	;;=^^2^2^2930519^^
	;;^DD(161.7,4,21,1,0)
	;;=The clerk who opened the batch or the clerk or supervisor who last 
	;;^DD(161.7,4,21,2,0)
	;;=reopened this batch.
	;;^DD(161.7,4,"DT")
	;;=2900405
	;;^DD(161.7,4.5,0)
	;;=DATE CLERK CLOSED^DX^^0;13^S %DT="EX",%DT(0)="-"_DT D ^%DT S X=Y K:Y<1 X

FBINI011
FBINI011	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.7,4.5,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.7,4.5,21,1,0)
	;;=The date that the clerk closed the batch. Payments cannot be entered
	;;^DD(161.7,4.5,21,2,0)
	;;=after the batch is closed.
	;;^DD(161.7,4.5,"DT")
	;;=2900507
	;;^DD(161.7,5,0)
	;;=DATE SUPERVISOR CLOSED^RDX^^0;6^S %DT="EX",%DT(0)="-"_DT D ^%DT S X=Y K:Y<1 X
	;;^DD(161.7,5,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.7,5,21,1,0)
	;;=The date that the supervisor reviewed and released for payment. 
	;;^DD(161.7,5,"DT")
	;;=2900507
	;;^DD(161.7,6,0)
	;;=SUPERVISOR WHO CERTIFIED^RP200'^VA(200,^0;7^Q
	;;^DD(161.7,6,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.7,6,21,1,0)
	;;=The supervisor who reviewed the batch to release/certify that the batch
	;;^DD(161.7,6,21,2,0)
	;;=was approved for transmission to Austin for payment.
	;;^DD(161.7,6,"DT")
	;;=2900405
	;;^DD(161.7,8,0)
	;;=TOTAL DOLLARS^RNJ8,2^^0;9^S:X["$" X=$P(X,"$",2) K:+X'=X&(X'?.N1"."2N)!(X>99999.99)!(X<.01) X
	;;^DD(161.7,8,3)
	;;=TYPE A NUMBER BETWEEN .01 AND 99999.99
	;;^DD(161.7,8,5,1,0)
	;;=162.04^2^1
	;;^DD(161.7,8,5,2,0)
	;;=163.04^2^1
	;;^DD(161.7,8,9)
	;;=^
	;;^DD(161.7,8,21,0)
	;;=^^3^3^2880304^
	;;^DD(161.7,8,21,1,0)
	;;=The total dollars that will be paid for items in this batch. This field
	;;^DD(161.7,8,21,2,0)
	;;=is calculated when the batch is closed. This field will NOT be accurate
	;;^DD(161.7,8,21,3,0)
	;;=if the batch has NOT been closed.
	;;^DD(161.7,9,0)
	;;=INVOICE COUNT^NJ2,0^^0;10^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.7,9,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 99
	;;^DD(161.7,9,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.7,9,21,1,0)
	;;=The number of individual invoices associated/included in this batch.
	;;^DD(161.7,10,0)
	;;=PAYMENT LINE COUNT^RNJ3,0^^0;11^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.7,10,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 999
	;;^DD(161.7,10,5,1,0)
	;;=162.04^2^2
	;;^DD(161.7,10,5,2,0)
	;;=163.04^2^2
	;;^DD(161.7,10,5,3,0)
	;;=163.04^2^3
	;;^DD(161.7,10,5,4,0)
	;;=162.04^2^3
	;;^DD(161.7,10,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.7,10,21,1,0)
	;;=The total number of payment line items included in this batch.
	;;^DD(161.7,11,0)
	;;=STATUS^RS^C:CLERK CLOSED;S:SUPERVISOR CLOSED;O:OPEN;T:TRANSMITTED;V:VOUCHERED;P:FORWARDED TO PRICER;A:ASSIGNED PRICE;R:REVIEWED AFTER PRICER;^ST;1^Q
	;;^DD(161.7,11,1,0)
	;;=^.1
	;;^DD(161.7,11,1,1,0)
	;;=161.7^AC
	;;^DD(161.7,11,1,1,1)
	;;=S ^FBAA(161.7,"AC",$E(X,1,30),DA)=""
	;;^DD(161.7,11,1,1,2)
	;;=K ^FBAA(161.7,"AC",$E(X,1,30),DA)
	;;^DD(161.7,11,1,2,0)
	;;=161.7^AB^MUMPS
	;;^DD(161.7,11,1,2,1)
	;;=I $P(^FBAA(161.7,DA,0),U,5)]"" S ^FBAA(161.7,"AB",$E(X,1,30),$P(^FBAA(161.7,DA,0),U,5),DA)=""
	;;^DD(161.7,11,1,2,2)
	;;=I $P(^FBAA(161.7,DA,0),U,5)]"" K ^FBAA(161.7,"AB",$E(X,1,30),$P(^FBAA(161.7,DA,0),U,5),DA)
	;;^DD(161.7,11,21,0)
	;;=^^1^1^2900409^^
	;;^DD(161.7,11,21,1,0)
	;;=The current status of the batch (ie Open, Clerk Closed, Transmitted).
	;;^DD(161.7,11,"DT")
	;;=2910111
	;;^DD(161.7,12,0)
	;;=DATE TRANSMITTED^DX^^0;14^S %DT="EX",%DT(0)="-"_DT D ^%DT S X=Y K:Y<1 X
	;;^DD(161.7,12,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.7,12,21,1,0)
	;;=The date/time the supervisor used the 'Queue Data for Transmission' 
	;;^DD(161.7,12,21,2,0)
	;;=option. This is NOT the actual date/time the transmission occurred.
	;;^DD(161.7,12,"DT")
	;;=2900507
	;;^DD(161.7,13,0)
	;;=DATE FINALIZED^DX^^0;12^S %DT="EX",%DT(0)="-"_DT D ^%DT S X=Y K:Y<1 X
	;;^DD(161.7,13,1,0)
	;;=^.1^^0
	;;^DD(161.7,13,1,1,0)
	;;=161.7^AF
	;;^DD(161.7,13,1,1,1)
	;;=S ^FBAA(161.7,"AF",$E(X,1,30),DA)=""
	;;^DD(161.7,13,1,1,2)
	;;=K ^FBAA(161.7,"AF",$E(X,1,30),DA)
	;;^DD(161.7,13,21,0)
	;;=^^4^4^2930519^^
	;;^DD(161.7,13,21,1,0)
	;;=This is the date that the batch is finalized. This occurs after the
	;;^DD(161.7,13,21,2,0)
	;;=batch has been sent to Austin and the Austin processing has
	;;^DD(161.7,13,21,3,0)
	;;=occurred. This is the final step where any items rejected by the Austin
	;;^DD(161.7,13,21,4,0)
	;;=system have been rejected and the batch is finalized.
	;;^DD(161.7,13,"DT")
	;;=2900507
	;;^DD(161.7,14,0)
	;;=PERSON WHO COMPLETED^P200'^VA(200,^0;16^Q

FBINI012
FBINI012	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.7,14,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.7,14,21,1,0)
	;;=The supervisor who completed/finalized the batch.
	;;^DD(161.7,14,"DT")
	;;=2900405
	;;^DD(161.7,15,0)
	;;=REJECTS PENDING^S^Y:YES;^0;17^Q
	;;^DD(161.7,15,21,0)
	;;=^^2^2^2930519^^
	;;^DD(161.7,15,21,1,0)
	;;=A flag which indicates whether this batch has any line items which
	;;^DD(161.7,15,21,2,0)
	;;=were rejected and have yet to be reassigned to a new batch.
	;;^DD(161.7,15,"DT")
	;;=2860815
	;;^DD(161.7,16,0)
	;;=STATION NUMBER^F^^0;8^K:$L(X)>3!($L(X)<3) X
	;;^DD(161.7,16,3)
	;;=ANSWER MUST BE 3 CHARACTERS IN LENGTH
	;;^DD(161.7,16,21,0)
	;;=^^2^2^2930514^
	;;^DD(161.7,16,21,1,0)
	;;=The station number (as defined centrally) for the station that is processing
	;;^DD(161.7,16,21,2,0)
	;;=this batch.
	;;^DD(161.7,16,"DT")
	;;=2890731
	;;^DD(161.7,17,0)
	;;=CONTRACT HOSPITAL BATCH^S^Y:yes;^0;15^Q
	;;^DD(161.7,17,21,0)
	;;=^^1^1^2930514^
	;;^DD(161.7,17,21,1,0)
	;;=A flag set to 'Yes' if the batch is a Contract Hospital batch.
	;;^DD(161.7,17,"DT")
	;;=2900409
	;;^DD(161.7,18,0)
	;;=BATCH EXEMPT^S^Y:YES;N:NO;^0;18^Q
	;;^DD(161.7,18,21,0)
	;;=^^2^2^2930514^
	;;^DD(161.7,18,21,1,0)
	;;=Population of this field indicates the batch is exempt from processing
	;;^DD(161.7,18,21,2,0)
	;;=by the Austin Pricer.
	;;^DD(161.7,18,"DT")
	;;=2930301
	;;^DD(161.7,19,0)
	;;=STATISTICAL BATCH^S^1:YES;0:NO;^0;19^Q
	;;^DD(161.7,19,21,0)
	;;=^^3^3^2940919^
	;;^DD(161.7,19,21,1,0)
	;;=This flag is set by the software.  Batches with this flag set to
	;;^DD(161.7,19,21,2,0)
	;;='1' (YES) will NOT make payment through FMS.  It is used to
	;;^DD(161.7,19,21,3,0)
	;;=update payment records both in DHCP and Central Fee.
	;;^DD(161.7,19,23,0)
	;;=^^2^2^2940919^
	;;^DD(161.7,19,23,1,0)
	;;=Set to '1' if sending Austin a statistical payment.  We only allow
	;;^DD(161.7,19,23,2,0)
	;;=statistical payments to be put into a batch with this flag set.
	;;^DD(161.7,19,"DT")
	;;=2940919

FBINI013
FBINI013	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.8)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.8,0,"GL")
	;;=^FBAA(161.8,
	;;^DIC("B","FEE BASIS PROGRAM",161.8)
	;;=
	;;^DIC(161.8,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(161.8,"%D",1,0)
	;;=Contains all valid Fee Basis functional programs (ie Outpatient Medical,
	;;^DIC(161.8,"%D",2,0)
	;;=Contract Hospital, Community Nursing Home).
	;;^DIC(161.8,"%D",3,0)
	;;= 
	;;^DIC(161.8,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.8,0)
	;;=FIELD^^2^3
	;;^DD(161.8,0,"DDA")
	;;=N
	;;^DD(161.8,0,"DT")
	;;=2920811
	;;^DD(161.8,0,"IX","B",161.8,.01)
	;;=
	;;^DD(161.8,0,"NM","FEE BASIS PROGRAM")
	;;=
	;;^DD(161.8,0,"PT",161.01,.03)
	;;=
	;;^DD(161.8,0,"PT",161.82,2)
	;;=
	;;^DD(161.8,0,"PT",162.02,1.5)
	;;=
	;;^DD(161.8,0,"PT",162.03,23)
	;;=
	;;^DD(161.8,0,"PT",162.4,.5)
	;;=
	;;^DD(161.8,0,"PT",162.5,11)
	;;=
	;;^DD(161.8,0,"PT",162.7,.5)
	;;=
	;;^DD(161.8,.01,0)
	;;=NAME^RF^^0;1^K:$L(X)>46!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
	;;^DD(161.8,.01,1,0)
	;;=^.1
	;;^DD(161.8,.01,1,1,0)
	;;=161.8^B
	;;^DD(161.8,.01,1,1,1)
	;;=S ^FBAA(161.8,"B",$E(X,1,30),DA)=""
	;;^DD(161.8,.01,1,1,2)
	;;=K ^FBAA(161.8,"B",$E(X,1,30),DA)
	;;^DD(161.8,.01,3)
	;;=ANSWER MUST BE 3-46 CHARACTERS IN LENGTH
	;;^DD(161.8,.01,21,0)
	;;=^^2^2^2880617^^^^
	;;^DD(161.8,.01,21,1,0)
	;;=The name of this Fee Basis program. Fee has many different programs such
	;;^DD(161.8,.01,21,2,0)
	;;=as Outpatient Medical, Contract Hospital, Dental, Oxygen etc. .
	;;^DD(161.8,.01,"DT")
	;;=2860115
	;;^DD(161.8,1,0)
	;;=CENTRAL FEE SYSTEM IDENTIFIER^RF^^0;2^K:$L(X)>1!($L(X)<1) X
	;;^DD(161.8,1,3)
	;;=ANSWER MUST BE 1 CHARACTER IN LENGTH
	;;^DD(161.8,1,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.8,1,21,1,0)
	;;=The code the Austin Central system uses to distinguish the different
	;;^DD(161.8,1,21,2,0)
	;;=Fee programs. This will be the code identifying this Fee program.
	;;^DD(161.8,2,0)
	;;=ACTIVE?^S^1:YES;0:NO;^0;3^Q
	;;^DD(161.8,2,3)
	;;=Indicate whether or not the fee program is active.
	;;^DD(161.8,2,21,0)
	;;=^^2^2^2920811^
	;;^DD(161.8,2,21,1,0)
	;;=This field should indicate whether or not a fee program used in the FEE
	;;^DD(161.8,2,21,2,0)
	;;=Basis package is active.  If active, user's will be able to select.
	;;^DD(161.8,2,23,0)
	;;=^^1^1^2920811^
	;;^DD(161.8,2,23,1,0)
	;;=The 'Active?' field is used to screen out inactive programs.
	;;^DD(161.8,2,"DT")
	;;=2920811

FBINI014
FBINI014	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(161.8)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,161.8)
	;;=^FBAA(161.8,
	;;^UTILITY(U,$J,161.8,0)
	;;=FEE BASIS PROGRAM^161.8^11^13
	;;^UTILITY(U,$J,161.8,2,0)
	;;=OUTPATIENT^3^1
	;;^UTILITY(U,$J,161.8,3,0)
	;;=PHARMACY^5^1
	;;^UTILITY(U,$J,161.8,4,0)
	;;=COMP & PENSION^3
	;;^UTILITY(U,$J,161.8,5,0)
	;;=DENTAL^3
	;;^UTILITY(U,$J,161.8,6,0)
	;;=CIVIL HOSPITAL^9^1
	;;^UTILITY(U,$J,161.8,7,0)
	;;=CONTRACT NURSING HOME^9^1
	;;^UTILITY(U,$J,161.8,8,0)
	;;=CHAMPVA^7^
	;;^UTILITY(U,$J,161.8,9,0)
	;;=CONTRACT READJUSTMENT COUNSELING^3
	;;^UTILITY(U,$J,161.8,10,0)
	;;=CONTRACT HALFWAY HOUSES^3
	;;^UTILITY(U,$J,161.8,11,0)
	;;=HOME HEALTH SERVICES^3
	;;^UTILITY(U,$J,161.8,12,0)
	;;=OTHER INSTITUTIONAL SERVICES^3
	;;^UTILITY(U,$J,161.8,13,0)
	;;=DIALYSIS^3
	;;^UTILITY(U,$J,161.8,14,0)
	;;=OXYGEN SERVICES^3

FBINI015
FBINI015	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.81)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.81,0,"GL")
	;;=^FBAA(161.81,
	;;^DIC("B","FEE BASIS PARTICIPATION CODE",161.81)
	;;=
	;;^DIC(161.81,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(161.81,"%D",1,0)
	;;=Contains all the valid Participation Code types that can be assigned to
	;;^DIC(161.81,"%D",2,0)
	;;=a vendor.
	;;^DIC(161.81,"%D",3,0)
	;;= 
	;;^DIC(161.81,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.81,0)
	;;=FIELD^^1^3
	;;^DD(161.81,0,"ID",1)
	;;=W "   ",$P(^(0),U,2)
	;;^DD(161.81,0,"IX","B",161.81,.01)
	;;=
	;;^DD(161.81,0,"IX","C",161.81,1)
	;;=
	;;^DD(161.81,0,"NM","FEE BASIS PARTICIPATION CODE")
	;;=
	;;^DD(161.81,0,"PT",161.2,7)
	;;=
	;;^DD(161.81,.001,0)
	;;=NUMBER^NJ7,0^^ ^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(161.81,.001,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 9999999
	;;^DD(161.81,.001,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.81,.001,21,1,0)
	;;=The internal entry number of the Participation Code in this file.
	;;^DD(161.81,.001,"DT")
	;;=2860117
	;;^DD(161.81,.01,0)
	;;=NAME^RF^^0;1^K:$L(X)>46!($L(X)<3)!'(X'?1P.E)!(X'?.ANP) X
	;;^DD(161.81,.01,1,0)
	;;=^.1
	;;^DD(161.81,.01,1,1,0)
	;;=161.81^B
	;;^DD(161.81,.01,1,1,1)
	;;=S ^FBAA(161.81,"B",$E(X,1,30),DA)=""
	;;^DD(161.81,.01,1,1,2)
	;;=K ^FBAA(161.81,"B",$E(X,1,30),DA)
	;;^DD(161.81,.01,3)
	;;=ANSWER MUST BE 3-46 CHARACTERS IN LENGTH
	;;^DD(161.81,.01,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.81,.01,21,1,0)
	;;=The name for this Participation code. Each vendor must have a 
	;;^DD(161.81,.01,21,2,0)
	;;=participation code.
	;;^DD(161.81,1,0)
	;;=CODE REPORTED TO AUSTIN^RF^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>2!($L(X)<2) X
	;;^DD(161.81,1,1,0)
	;;=^.1
	;;^DD(161.81,1,1,1,0)
	;;=161.81^C
	;;^DD(161.81,1,1,1,1)
	;;=S ^FBAA(161.81,"C",$E(X,1,30),DA)=""
	;;^DD(161.81,1,1,1,2)
	;;=K ^FBAA(161.81,"C",$E(X,1,30),DA)
	;;^DD(161.81,1,1,1,"%D",0)
	;;=^^1^1^2930909^
	;;^DD(161.81,1,1,1,"%D",1,0)
	;;=Used to get internal entry number in the server routines.
	;;^DD(161.81,1,1,1,"DT")
	;;=2930909
	;;^DD(161.81,1,3)
	;;=ANSWER MUST BE 2 CHARACTERS IN LENGTH
	;;^DD(161.81,1,21,0)
	;;=^^2^2^2880304^
	;;^DD(161.81,1,21,1,0)
	;;=The acceptable code the Austin Central system expects for this 
	;;^DD(161.81,1,21,2,0)
	;;=participation code.
	;;^DD(161.81,1,"DT")
	;;=2930909

FBINI016
FBINI016	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(161.81)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,161.81)
	;;=^FBAA(161.81,
	;;^UTILITY(U,$J,161.81,0)
	;;=FEE BASIS PARTICIPATION CODE^161.81I^14^14
	;;^UTILITY(U,$J,161.81,1,0)
	;;=DOCTOR OF MEDICINE^01
	;;^UTILITY(U,$J,161.81,2,0)
	;;=DOCTOR OF OSTEOPATHY^02
	;;^UTILITY(U,$J,161.81,3,0)
	;;=HOME NURSING CARE^03
	;;^UTILITY(U,$J,161.81,4,0)
	;;=DENTIST^04
	;;^UTILITY(U,$J,161.81,5,0)
	;;=COMMUNITY NURSING HOME^05
	;;^UTILITY(U,$J,161.81,6,0)
	;;=NON-VA HOSPITAL^06
	;;^UTILITY(U,$J,161.81,7,0)
	;;=CONTRACT READJUSTMENT COUNSELING^07
	;;^UTILITY(U,$J,161.81,8,0)
	;;=CONTRACT HALFWAY HOUSES^08
	;;^UTILITY(U,$J,161.81,9,0)
	;;=HOME IMPROVEMENT AND STRUCTURAL ALTERATION^09
	;;^UTILITY(U,$J,161.81,10,0)
	;;=HOME HEALTH SERVICES^10
	;;^UTILITY(U,$J,161.81,11,0)
	;;=DIALYSIS^11
	;;^UTILITY(U,$J,161.81,12,0)
	;;=ALL OTHER INDIVIDUAL PARTICIPANTS^12
	;;^UTILITY(U,$J,161.81,13,0)
	;;=ALL OTHER PARTICIPANTS, NOT INDIVIDUALS^13
	;;^UTILITY(U,$J,161.81,14,0)
	;;=PHARMACY^  

FBINI017
FBINI017	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.82)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.82,0,"GL")
	;;=^FBAA(161.82,
	;;^DIC("B","FEE BASIS PURPOSE OF VISIT",161.82)
	;;=
	;;^DIC(161.82,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(161.82,"%D",1,0)
	;;=Contains all valid Purpose of Visit codes which can be assigned to a 
	;;^DIC(161.82,"%D",2,0)
	;;=veteran in the Authorization option.
	;;^DIC(161.82,"%D",3,0)
	;;= 
	;;^DIC(161.82,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.82,0)
	;;=FIELD^^3^5
	;;^DD(161.82,0,"DT")
	;;=2941214
	;;^DD(161.82,0,"ID",3)
	;;=W "   ",$P(^(0),U,3)
	;;^DD(161.82,0,"IX","AC",161.82,3)
	;;=
	;;^DD(161.82,0,"IX","AC1",161.82,4)
	;;=
	;;^DD(161.82,0,"IX","B",161.82,.01)
	;;=
	;;^DD(161.82,0,"IX","C",161.82,3)
	;;=
	;;^DD(161.82,0,"NM","FEE BASIS PURPOSE OF VISIT")
	;;=
	;;^DD(161.82,0,"PT",161.01,.07)
	;;=
	;;^DD(161.82,0,"PT",162.03,16)
	;;=
	;;^DD(161.82,0,"PT",162.5,21)
	;;=
	;;^DD(161.82,.01,0)
	;;=NAME^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>200!($L(X)<2)!'(X'?1P.E)!(X'?.ANP) X
	;;^DD(161.82,.01,1,0)
	;;=^.1
	;;^DD(161.82,.01,1,1,0)
	;;=161.82^B^MUMPS
	;;^DD(161.82,.01,1,1,1)
	;;=S ^FBAA(161.82,"B",$E(X,1,63),DA)=""
	;;^DD(161.82,.01,1,1,2)
	;;=K ^FBAA(161.82,"B",$E(X,1,63),DA)
	;;^DD(161.82,.01,3)
	;;=ANSWER MUST BE 2-200 CHARACTERS IN LENGTH
	;;^DD(161.82,.01,21,0)
	;;=^^1^1^2930519^^^
	;;^DD(161.82,.01,21,1,0)
	;;=The name of the Purpose of Visit to which a payment will be related.
	;;^DD(161.82,.01,"DT")
	;;=2880607
	;;^DD(161.82,1,0)
	;;=DEFINITION^161.821^^1;0
	;;^DD(161.82,1,21,0)
	;;=^^2^2^2880608^^
	;;^DD(161.82,1,21,1,0)
	;;=This allows the input of a more detailed description
	;;^DD(161.82,1,21,2,0)
	;;=of the 'Purpose of Visit' code.
	;;^DD(161.82,2,0)
	;;=FEE PROGRAM ASSOCIATED WITH^P161.8'^FBAA(161.8,^0;2^Q
	;;^DD(161.82,2,21,0)
	;;=^^4^4^2930519^^^
	;;^DD(161.82,2,21,1,0)
	;;=The Fee program to which this Purpose of Visit is related. A Purpose of
	;;^DD(161.82,2,21,2,0)
	;;=Visit can relate to only one Fee program.
	;;^DD(161.82,2,21,3,0)
	;;=For example, purpose of visit 'Community Nursing Home for SC Disabilities'
	;;^DD(161.82,2,21,4,0)
	;;=is ONLY related to the 'Community Nursing Home' fee program.
	;;^DD(161.82,2,"DT")
	;;=2941214
	;;^DD(161.82,3,0)
	;;=AUSTIN CODE^F^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>2!($L(X)<2) X
	;;^DD(161.82,3,1,0)
	;;=^.1
	;;^DD(161.82,3,1,1,0)
	;;=161.82^C
	;;^DD(161.82,3,1,1,1)
	;;=S ^FBAA(161.82,"C",$E(X,1,30),DA)=""
	;;^DD(161.82,3,1,1,2)
	;;=K ^FBAA(161.82,"C",$E(X,1,30),DA)
	;;^DD(161.82,3,1,2,0)
	;;=161.82^AC^MUMPS
	;;^DD(161.82,3,1,2,1)
	;;=S:'+$G(^FBAA(161.82,DA,"I")) ^FBAA(161.82,"AC",X,DA)=""
	;;^DD(161.82,3,1,2,2)
	;;=K ^FBAA(161.82,"AC",X,DA)
	;;^DD(161.82,3,1,2,"%D",0)
	;;=^^1^1^2931004^^^
	;;^DD(161.82,3,1,2,"%D",1,0)
	;;=Cross-reference those POV's which are active.
	;;^DD(161.82,3,1,2,"DT")
	;;=2931004
	;;^DD(161.82,3,3)
	;;=ANSWER MUST BE 2 CHARACTERS IN LENGTH
	;;^DD(161.82,3,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.82,3,21,1,0)
	;;=The Austin system code required for this Purpose of Visit.
	;;^DD(161.82,3,"DT")
	;;=2931004
	;;^DD(161.82,4,0)
	;;=INACTIVATION DATE^D^^I;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(161.82,4,1,0)
	;;=^.1
	;;^DD(161.82,4,1,1,0)
	;;=161.82^AC1^MUMPS
	;;^DD(161.82,4,1,1,1)
	;;=K:$P($G(^FBAA(161.82,DA,0)),U,3)]"" ^FBAA(161.82,"AC",$P(^(0),U,3),DA)
	;;^DD(161.82,4,1,1,2)
	;;=S:$P($G(^FBAA(161.82,DA,0)),U,3)]"" ^FBAA(161.82,"AC",$P(^(0),U,3),DA)=""
	;;^DD(161.82,4,1,1,"%D",0)
	;;=^^1^1^2931004^^^^
	;;^DD(161.82,4,1,1,"%D",1,0)
	;;=Cross-reference Purpose of Visit file on active codes.
	;;^DD(161.82,4,1,1,"DT")
	;;=2931004
	;;^DD(161.82,4,21,0)
	;;=^^3^3^2930204^
	;;^DD(161.82,4,21,1,0)
	;;=This field allowed the Fee Basis software clean-up any duplicates
	;;^DD(161.82,4,21,2,0)
	;;=that may have resided in this file without re-indexing all payment
	;;^DD(161.82,4,21,3,0)
	;;=records.
	;;^DD(161.82,4,"DT")
	;;=2931004
	;;^DD(161.821,0)
	;;=DEFINITION SUB-FIELD^NL^.01^1
	;;^DD(161.821,0,"NM","DEFINITION")
	;;=
	;;^DD(161.821,0,"UP")
	;;=161.82
	;;^DD(161.821,.01,0)
	;;=DEFINITION^W^^0;1^Q
	;;^DD(161.821,.01,21,0)
	;;=^^1^1^2880608^^^^

FBINI018
FBINI018	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.82)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(161.821,.01,21,1,0)
	;;=A more detail description of the Purpose of Visit code.

FBINI019
FBINI019	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(161.83)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161.83,0,"GL")
	;;=^FBAA(161.83,
	;;^DIC("B","FEE BASIS ID CARD AUDIT",161.83)
	;;=
	;;^DIC(161.83,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(161.83,"%D",1,0)
	;;=Contains a history of all 'old' ID card numbers and relevant data 
	;;^DIC(161.83,"%D",2,0)
	;;=relating to prior non-current ID cards issued.
	;;^DIC(161.83,"%D",3,0)
	;;= 
	;;^DIC(161.83,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(161.83,0)
	;;=FIELD^^1^2
	;;^DD(161.83,0,"IX","B",161.83,.01)
	;;=
	;;^DD(161.83,0,"IX","C",161.831,1)
	;;=
	;;^DD(161.83,0,"NM","FEE BASIS ID CARD AUDIT")
	;;=
	;;^DD(161.83,.01,0)
	;;=NAME^RP2'X^DPT(^0;1^S DINUM=X
	;;^DD(161.83,.01,1,0)
	;;=^.1
	;;^DD(161.83,.01,1,1,0)
	;;=161.83^B
	;;^DD(161.83,.01,1,1,1)
	;;=S ^FBAA(161.83,"B",$E(X,1,30),DA)=""
	;;^DD(161.83,.01,1,1,2)
	;;=K ^FBAA(161.83,"B",$E(X,1,30),DA)
	;;^DD(161.83,.01,3)
	;;=
	;;^DD(161.83,.01,21,0)
	;;=^^1^1^2880318^^
	;;^DD(161.83,.01,21,1,0)
	;;=Veteran for whom ID card was changed.
	;;^DD(161.83,.01,"DT")
	;;=2860411
	;;^DD(161.83,1,0)
	;;=DATE/TIME CARD NUMBER CHANGED^161.831DA^^1;0
	;;^DD(161.83,1,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.83,1,21,1,0)
	;;=Date and time the ID card number was modified.
	;;^DD(161.831,0)
	;;=DATE/TIME CARD NUMBER CHANGED SUB-FIELD^^3^4
	;;^DD(161.831,0,"NM","DATE/TIME CARD NUMBER CHANGED")
	;;=
	;;^DD(161.831,0,"UP")
	;;=161.83
	;;^DD(161.831,.01,0)
	;;=DATE/TIME CARD NUMBER CHANGED^RDX^^0;1^S %DT="ETX" D ^%DT S X=Y K:Y<1 X I $D(X) S DINUM=(9999999.9999-X)
	;;^DD(161.831,.01,1,0)
	;;=^.1^^0
	;;^DD(161.831,.01,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.831,.01,21,1,0)
	;;=The date and time the ID card number was changed for this veteran.
	;;^DD(161.831,.01,"DT")
	;;=2860411
	;;^DD(161.831,1,0)
	;;=CARD NUMBER^RF^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>7!($L(X)<5) X
	;;^DD(161.831,1,1,0)
	;;=^.1
	;;^DD(161.831,1,1,1,0)
	;;=161.83^C
	;;^DD(161.831,1,1,1,1)
	;;=S ^FBAA(161.83,"C",$E(X,1,30),DA(1),DA)=""
	;;^DD(161.831,1,1,1,2)
	;;=K ^FBAA(161.83,"C",$E(X,1,30),DA(1),DA)
	;;^DD(161.831,1,3)
	;;=ANSWER MUST BE 5-7 CHARACTERS IN LENGTH
	;;^DD(161.831,1,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.831,1,21,1,0)
	;;=The ID card number before it was changed.
	;;^DD(161.831,1,"DT")
	;;=2860411
	;;^DD(161.831,2,0)
	;;=REASON FOR CHANGE^RF^^0;3^K:$L(X)>80!($L(X)<2) X
	;;^DD(161.831,2,3)
	;;=ANSWER MUST BE 2-80 CHARACTERS IN LENGTH
	;;^DD(161.831,2,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.831,2,21,1,0)
	;;=The reason the ID card number was changed.
	;;^DD(161.831,2,"DT")
	;;=2860411
	;;^DD(161.831,3,0)
	;;=PERSON WHO CHANGED^RP200'^VA(200,^0;4^Q
	;;^DD(161.831,3,21,0)
	;;=^^1^1^2880304^
	;;^DD(161.831,3,21,1,0)
	;;=The clerk/user who changed the veterans ID card.
	;;^DD(161.831,3,"DT")
	;;=2900405

FBINI01A
FBINI01A	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162,0,"GL")
	;;=^FBAAC(
	;;^DIC("B","FEE BASIS PAYMENT",162)
	;;=
	;;^DIC(162,"%D",0)
	;;=^^5^5^2940622^^^^
	;;^DIC(162,"%D",1,0)
	;;=Contains all Fee Outpatient medical payment data.  Include's payment
	;;^DIC(162,"%D",2,0)
	;;=ancillary data for Contract Hospital as of version 2. Does NOT include 
	;;^DIC(162,"%D",3,0)
	;;=Pharmacy payment data.
	;;^DIC(162,"%D",4,0)
	;;= 
	;;^DIC(162,"%D",5,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162,0)
	;;=FIELD^^99^4
	;;^DD(162,0,"DT")
	;;=2940926
	;;^DD(162,0,"IX","AB",162.01,.01)
	;;=
	;;^DD(162,0,"IX","AC",162.03,7)
	;;=
	;;^DD(162,0,"IX","ACK",162.03,35)
	;;=
	;;^DD(162,0,"IX","ACKT",162.04,9)
	;;=
	;;^DD(162,0,"IX","AD",162.04,1)
	;;=
	;;^DD(162,0,"IX","AE1",162.03,39)
	;;=
	;;^DD(162,0,"IX","AG",162.04,6)
	;;=
	;;^DD(162,0,"IX","AH",162.03,21)
	;;=
	;;^DD(162,0,"IX","AI",162.03,4)
	;;=
	;;^DD(162,0,"IX","AJ",162.03,14)
	;;=
	;;^DD(162,0,"IX","AK",162.03,5)
	;;=
	;;^DD(162,0,"IX","AL",162.04,7)
	;;=
	;;^DD(162,0,"IX","AM",162.03,27)
	;;=
	;;^DD(162,0,"IX","AN",162.03,23)
	;;=
	;;^DD(162,0,"IX","AP",162.03,5)
	;;=
	;;^DD(162,0,"IX","AX",162.02,.01)
	;;=
	;;^DD(162,0,"IX","B",162,.01)
	;;=
	;;^DD(162,0,"IX","C",162.03,14)
	;;=
	;;^DD(162,0,"NM","FEE BASIS PAYMENT")
	;;=
	;;^DD(162,.01,0)
	;;=PATIENT^RP2X^DPT(^0;1^S:$D(X) DINUM=X
	;;^DD(162,.01,1,0)
	;;=^.1
	;;^DD(162,.01,1,1,0)
	;;=162^B
	;;^DD(162,.01,1,1,1)
	;;=S ^FBAAC("B",$E(X,1,30),DA)=""
	;;^DD(162,.01,1,1,2)
	;;=K ^FBAAC("B",$E(X,1,30),DA)
	;;^DD(162,.01,3)
	;;=
	;;^DD(162,.01,21,0)
	;;=^^1^1^2880301^
	;;^DD(162,.01,21,1,0)
	;;=The veteran for which service was provided.
	;;^DD(162,6,0)
	;;=VENDOR^162.01P^^1;0
	;;^DD(162,6,21,0)
	;;=^^2^2^2941128^
	;;^DD(162,6,21,1,0)
	;;=This mutiple keeps track of all the vendors used by the
	;;^DD(162,6,21,2,0)
	;;=Fee Basis patient.
	;;^DD(162,7,0)
	;;=TRAVEL PAYMENT DATE^162.04DA^^3;0
	;;^DD(162,7,21,0)
	;;=^^2^2^2941128^
	;;^DD(162,7,21,1,0)
	;;=This multiple keeps track of any travel paid to a Fee Basis
	;;^DD(162,7,21,2,0)
	;;=patient, in conjunction with an outpatient service.
	;;^DD(162,99,0)
	;;=DATE OF PURGE^162.099DA^^PURGE;0
	;;^DD(162,99,21,0)
	;;=^^3^3^2930514^
	;;^DD(162,99,21,1,0)
	;;=Date that the purge routine was run which resulted in the purging of
	;;^DD(162,99,21,2,0)
	;;=payment data for this patient.  This data will exist ONLY IF data was
	;;^DD(162,99,21,3,0)
	;;=purged for the patient for the specific purge run.
	;;^DD(162.01,0)
	;;=VENDOR SUB-FIELD^NL^1^2
	;;^DD(162.01,0,"DT")
	;;=2940426
	;;^DD(162.01,0,"IX","AB",162.02,.01)
	;;=
	;;^DD(162.01,0,"IX","AC",162.01,.01)
	;;=
	;;^DD(162.01,0,"IX","AD",162.02,.01)
	;;=
	;;^DD(162.01,0,"NM","VENDOR")
	;;=
	;;^DD(162.01,0,"UP")
	;;=162
	;;^DD(162.01,.01,0)
	;;=VENDOR^RP161.2X^FBAAV(^0;1^S:$D(X) DINUM=X
	;;^DD(162.01,.01,1,0)
	;;=^.1
	;;^DD(162.01,.01,1,1,0)
	;;=162.01^AC
	;;^DD(162.01,.01,1,1,1)
	;;=S ^FBAAC(DA(1),1,"AC",$E(X,1,30),DA)=""
	;;^DD(162.01,.01,1,1,2)
	;;=K ^FBAAC(DA(1),1,"AC",$E(X,1,30),DA)
	;;^DD(162.01,.01,1,2,0)
	;;=162^AB
	;;^DD(162.01,.01,1,2,1)
	;;=S ^FBAAC("AB",$E(X,1,30),DA(1),DA)=""
	;;^DD(162.01,.01,1,2,2)
	;;=K ^FBAAC("AB",$E(X,1,30),DA(1),DA)
	;;^DD(162.01,.01,4)
	;;=
	;;^DD(162.01,.01,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.01,.01,21,1,0)
	;;=The vendor/provider who's bill is being entered for payment.
	;;^DD(162.01,.01,"DT")
	;;=2860116
	;;^DD(162.01,1,0)
	;;=INITIAL TREATMENT DATE^162.02DA^^1;0
	;;^DD(162.01,1,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.01,1,21,1,0)
	;;=The date that the treatment or service was provided.
	;;^DD(162.02,0)
	;;=INITIAL TREATMENT DATE SUB-FIELD^NL^3^4
	;;^DD(162.02,0,"DT")
	;;=2940426
	;;^DD(162.02,0,"NM","INITIAL TREATMENT DATE")
	;;=
	;;^DD(162.02,0,"UP")
	;;=162.01
	;;^DD(162.02,.01,0)
	;;=INITIAL TREATMENT DATE^RDX^^0;1^S %DT="ETXP" D ^%DT S X=Y D DATCK^FBAAUTL
	;;^DD(162.02,.01,1,0)
	;;=^.1
	;;^DD(162.02,.01,1,1,0)
	;;=162.01^AB^MUMPS
	;;^DD(162.02,.01,1,1,1)
	;;=S ^FBAAC(DA(2),"AB",(9999999.9999-X),DA(1),DA)=""
	;;^DD(162.02,.01,1,1,2)
	;;=K ^FBAAC(DA(2),"AB",(9999999.9999-X),DA(1),DA)
	;;^DD(162.02,.01,1,2,0)
	;;=162.01^AD^MUMPS

FBINI01B
FBINI01B	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.02,.01,1,2,1)
	;;=S ^FBAAC(DA(2),DA(1),"AD",(9999999.9999-X),DA)=""
	;;^DD(162.02,.01,1,2,2)
	;;=K ^FBAAC(DA(2),DA(1),"AD",(9999999.9999-X),DA)
	;;^DD(162.02,.01,1,3,0)
	;;=162^AX^MUMPS
	;;^DD(162.02,.01,1,3,1)
	;;=S ^FBAAC("AX",DA(1),(9999999.9999-X),DA(2),DA)=""
	;;^DD(162.02,.01,1,3,2)
	;;=K ^FBAAC("AX",DA(1),(9999999.9999-X),DA(2),DA)
	;;^DD(162.02,.01,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.02,.01,21,1,0)
	;;=The date that the treatment/service took place.
	;;^DD(162.02,.01,"DT")
	;;=2930512
	;;^DD(162.02,1.5,0)
	;;=*FEE PROGRAM^RP161.8'^FBAA(161.8,^0;3^Q
	;;^DD(162.02,1.5,3)
	;;=
	;;^DD(162.02,1.5,21,0)
	;;=^^3^3^2930514^^
	;;^DD(162.02,1.5,21,1,0)
	;;=The Fee Basis program which this payment is related to. For example,
	;;^DD(162.02,1.5,21,2,0)
	;;=is this a payment related to the Outpatient Medical program or a payment
	;;^DD(162.02,1.5,21,3,0)
	;;=related to the Contract Hospital program.
	;;^DD(162.02,1.5,"DT")
	;;=2860218
	;;^DD(162.02,2,0)
	;;=SERVICE PROVIDED^162.03IPA^^1;0
	;;^DD(162.02,2,21,0)
	;;=^^2^2^2941128^
	;;^DD(162.02,2,21,1,0)
	;;=This multiple contains all the outpatient and ancillary services
	;;^DD(162.02,2,21,2,0)
	;;=provided the Fee Basis patient.
	;;^DD(162.02,3,0)
	;;=AUTHORIZATION POINTER^NJ7,0^^0;4^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.02,3,3)
	;;=Type a Number between 1 and 9999999, 0 Decimal Digits
	;;^DD(162.02,3,21,0)
	;;=^^4^4^2941128^^
	;;^DD(162.02,3,21,1,0)
	;;=This field is set to the internal entry number of the
	;;^DD(162.02,3,21,2,0)
	;;=appropriate authorization in file 161. It is used
	;;^DD(162.02,3,21,3,0)
	;;=to retrieve the appropriate purpose of visit code
	;;^DD(162.02,3,21,4,0)
	;;=when payments are sent to Austin.
	;;^DD(162.02,3,"DT")
	;;=2900820
	;;^DD(162.03,0)
	;;=SERVICE PROVIDED SUB-FIELD^NL^41^41
	;;^DD(162.03,0,"DT")
	;;=2940426
	;;^DD(162.03,0,"IX","AE",162.03,.01)
	;;=
	;;^DD(162.03,0,"IX","AI1",162.03,3.5)
	;;=
	;;^DD(162.03,0,"IX","AQ",162.03,5)
	;;=
	;;^DD(162.03,0,"NM","SERVICE PROVIDED")
	;;=
	;;^DD(162.03,0,"UP")
	;;=162.02
	;;^DD(162.03,.01,0)
	;;=SERVICE PROVIDED^MRP81'^ICPT(^0;1^Q
	;;^DD(162.03,.01,1,0)
	;;=^.1^^-1
	;;^DD(162.03,.01,1,1,0)
	;;=162.03^AE^MUMPS
	;;^DD(162.03,.01,1,1,1)
	;;=D SCPT^FBAAUTL4(X,$$CPTMOD^FBAAUTL4(DA(3),DA(2),DA(1),DA,1))
	;;^DD(162.03,.01,1,1,2)
	;;=D KCPT^FBAAUTL4(X,$$CPTMOD^FBAAUTL4(DA(3),DA(2),DA(1),DA,1))
	;;^DD(162.03,.01,1,1,"%D",0)
	;;=^^10^10^2940629^^^^
	;;^DD(162.03,.01,1,1,"%D",1,0)
	;;=Cross-reference built to concatenate CPT with Modifier for duplicate payment
	;;^DD(162.03,.01,1,1,"%D",2,0)
	;;=checks.  The cross-reference is set by both the Service Provided field,
	;;^DD(162.03,.01,1,1,"%D",3,0)
	;;=as well as the CPT Modifier field.
	;;^DD(162.03,.01,1,1,"%D",4,0)
	;;= 
	;;^DD(162.03,.01,1,1,"%D",5,0)
	;;=***If the need arises to re-index the entire cross-reference, it
	;;^DD(162.03,.01,1,1,"%D",6,0)
	;;=should be done by re-indexing the Service Provided field and not
	;;^DD(162.03,.01,1,1,"%D",7,0)
	;;=the CPT Modifier field.  As a Service Provided (CPT code) is mandatory
	;;^DD(162.03,.01,1,1,"%D",8,0)
	;;=for each payment entry, but a CPT Modifier is not, to assure a complete
	;;^DD(162.03,.01,1,1,"%D",9,0)
	;;=cross-reference, the re-indexing should be done on the Service Provided
	;;^DD(162.03,.01,1,1,"%D",10,0)
	;;=field.
	;;^DD(162.03,.01,1,1,"DT")
	;;=2940610
	;;^DD(162.03,.01,3)
	;;=
	;;^DD(162.03,.01,21,0)
	;;=^^2^2^2901106^^^
	;;^DD(162.03,.01,21,1,0)
	;;=The Current Procedural Terminology Code (CPT Code) as specified on the
	;;^DD(162.03,.01,21,2,0)
	;;=vendors invoice identifying the service the vendor provided to the veteran.
	;;^DD(162.03,.01,"DT")
	;;=2940610
	;;^DD(162.03,1,0)
	;;=AMOUNT CLAIMED^RNJ9,2^^0;2^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<.01) X
	;;^DD(162.03,1,3)
	;;=Type a Dollar Amount between .01 and 999999, 2 Decimal Digits
	;;^DD(162.03,1,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.03,1,21,1,0)
	;;=The amount the vendor is billing us for this service provided.
	;;^DD(162.03,1,"DT")
	;;=2880301
	;;^DD(162.03,2,0)
	;;=AMOUNT PAID^RNJ9,2X^^0;3^S:X["$" X=$P(X,"$",2) K:+X'=X&(X'?.N.1".".2N)!(X>999999)!(X<0) X I $D(X),$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),"^",2)<X W !,*7,"Amount Paid cannot be greater than Amount Claimed!",! K X

FBINI01C
FBINI01C	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.03,2,1,0)
	;;=^.1^^0
	;;^DD(162.03,2,3)
	;;=TYPE A NUMBER BETWEEN 0 AND 999999
	;;^DD(162.03,2,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.03,2,21,1,0)
	;;=The amount that the VA is going to pay for this service provided.
	;;^DD(162.03,2,"DT")
	;;=2940722
	;;^DD(162.03,3,0)
	;;=AMOUNT SUSPENDED^NJ10,2^^0;4^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999999)!(X<.01) X
	;;^DD(162.03,3,3)
	;;=Type a Dollar Amount between .01 and 9999999, 2 Decimal Digits
	;;^DD(162.03,3,21,0)
	;;=^^3^3^2880616^^^^
	;;^DD(162.03,3,21,1,0)
	;;=The portion of the vendor's claimed amount that the VA will not pay for
	;;^DD(162.03,3,21,2,0)
	;;=various reasons. This amount is usually the difference between the
	;;^DD(162.03,3,21,3,0)
	;;=vendor's amount claimed and the amount paid.
	;;^DD(162.03,3,"DT")
	;;=2880301
	;;^DD(162.03,3.5,0)
	;;=DATE SUSPENDED^D^^0;11^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.03,3.5,1,0)
	;;=^.1
	;;^DD(162.03,3.5,1,1,0)
	;;=162.03^AI1^MUMPS
	;;^DD(162.03,3.5,1,1,1)
	;;=S:$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,5) ^FBAAC("AI",DA(2),$E(X,1,30),DA(3),$P(^(0),U,5),DA(1),DA)=""
	;;^DD(162.03,3.5,1,1,2)
	;;=K:$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,5) ^FBAAC("AI",DA(2),$E(X,1,30),DA(3),$P(^(0),U,5),DA(1),DA)
	;;^DD(162.03,3.5,1,1,"%D",0)
	;;=^^2^2^2930514^
	;;^DD(162.03,3.5,1,1,"%D",1,0)
	;;=This will update the cross-reference on the suspense code field if the
	;;^DD(162.03,3.5,1,1,"%D",2,0)
	;;=Date suspended has been changed.
	;;^DD(162.03,3.5,1,1,"DT")
	;;=2930514
	;;^DD(162.03,3.5,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.03,3.5,21,1,0)
	;;=The date that this payment is suspended.
	;;^DD(162.03,3.5,"DT")
	;;=2930514
	;;^DD(162.03,4,0)
	;;=SUSPEND CODE^P161.27'^FBAA(161.27,^0;5^Q
	;;^DD(162.03,4,1,0)
	;;=^.1
	;;^DD(162.03,4,1,1,0)
	;;=162^AI^MUMPS
	;;^DD(162.03,4,1,1,1)
	;;=S:$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,11) ^FBAAC("AI",DA(2),$P(^(0),U,11),DA(3),$E(X,1,30),DA(1),DA)=""
	;;^DD(162.03,4,1,1,2)
	;;=K:$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,11) ^FBAAC("AI",DA(2),$P(^(0),U,11),DA(3),$E(X,1,30),DA(1),DA)
	;;^DD(162.03,4,1,1,"%D",0)
	;;=^^1^1^2930514^^
	;;^DD(162.03,4,1,1,"%D",1,0)
	;;=This cross-reference is used to sort suspense letters.
	;;^DD(162.03,4,1,1,"DT")
	;;=2930514
	;;^DD(162.03,4,3)
	;;=
	;;^DD(162.03,4,4)
	;;=
	;;^DD(162.03,4,21,0)
	;;=^^3^3^2880301^
	;;^DD(162.03,4,21,1,0)
	;;=The code that identifies why the amount paid was less than the amount
	;;^DD(162.03,4,21,2,0)
	;;=claimed. The valid list of codes are contained in the Fee Basis 
	;;^DD(162.03,4,21,3,0)
	;;=Suspension file.
	;;^DD(162.03,4,"DT")
	;;=2930514
	;;^DD(162.03,5,0)
	;;=DATE FINALIZED^D^^0;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.03,5,1,0)
	;;=^.1
	;;^DD(162.03,5,1,1,0)
	;;=162^AP^MUMPS
	;;^DD(162.03,5,1,1,1)
	;;=S ^FBAAC("AP",DA(2),$E(X,1,30),DA(3),DA(1),DA)=""
	;;^DD(162.03,5,1,1,2)
	;;=K ^FBAAC("AP",DA(2),$E(X,1,30),DA(3),DA(1),DA)
	;;^DD(162.03,5,1,2,0)
	;;=162^AK
	;;^DD(162.03,5,1,2,1)
	;;=S ^FBAAC("AK",$E(X,1,30),DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,5,1,2,2)
	;;=K ^FBAAC("AK",$E(X,1,30),DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,5,1,3,0)
	;;=162.03^AQ^MUMPS
	;;^DD(162.03,5,1,3,1)
	;;=I $P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,12)]"" S ^FBAAC("AQ",$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,12),9999999-$E(X,1,30),DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,5,1,3,2)
	;;=I $P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,12)]"" K ^FBAAC("AQ",$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,12),9999999-$E(X,1,30),DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,5,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.03,5,21,1,0)
	;;=The date that this payment line item was finalized (Certified) by the
	;;^DD(162.03,5,21,2,0)
	;;=Fee Supervisor.
	;;^DD(162.03,5,"DT")
	;;=2900611
	;;^DD(162.03,6,0)
	;;=CLERK^RP200'^VA(200,^0;7^Q
	;;^DD(162.03,6,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.03,6,21,1,0)
	;;=The Fee clerk who entered in the payment data.
	;;^DD(162.03,6,"DT")
	;;=2900405
	;;^DD(162.03,7,0)
	;;=BATCH NUMBER^*P161.7'^FBAA(161.7,^0;8^S DIC("S")="I $P(^(""ST""),U,1)=""O""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.03,7,1,0)
	;;=^.1^^-1
	;;^DD(162.03,7,1,1,0)
	;;=162^AC

FBINI01D
FBINI01D	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.03,7,1,1,1)
	;;=S ^FBAAC("AC",$E(X,1,30),DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,7,1,1,2)
	;;=K ^FBAAC("AC",$E(X,1,30),DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,7,12)
	;;=ALLOWS SELECTION OF ONLY BATCHES THAT ARE OPEN
	;;^DD(162.03,7,12.1)
	;;=S DIC("S")="I $P(^(""ST""),U,1)=""O"""
	;;^DD(162.03,7,21,0)
	;;=^^2^2^2930519^^
	;;^DD(162.03,7,21,1,0)
	;;=The batch number with which this payment was associated. If the batch
	;;^DD(162.03,7,21,2,0)
	;;=file has been purged this may be blank.
	;;^DD(162.03,7,"DT")
	;;=2880122
	;;^DD(162.03,8,0)
	;;=OBLIGATION NUMBER^RFX^^0;10^K:$L(X)>6!($L(X)<6) X D:$D(X) CKOB^FBAAUTL1
	;;^DD(162.03,8,3)
	;;=ANSWER MUST BE 6 CHARACTERS IN LENGTH
	;;^DD(162.03,8,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.03,8,21,1,0)
	;;=The obligation number identifying which funds this payment will be paid
	;;^DD(162.03,8,21,2,0)
	;;=with.
	;;^DD(162.03,8,"DT")
	;;=2900412
	;;^DD(162.03,12,0)
	;;=DATE PAID^D^^0;14^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.03,12,3)
	;;=This is the date of the check, as issued by the treasury.
	;;^DD(162.03,12,21,0)
	;;=^^7^7^2940308^^^
	;;^DD(162.03,12,21,1,0)
	;;=This is the date of the check, as issued by the treasury.  This
	;;^DD(162.03,12,21,2,0)
	;;=information will be passed back to DHCP from the Financial Management
	;;^DD(162.03,12,21,3,0)
	;;=System (FMS) when the check is issued to the vendor.  This field will
	;;^DD(162.03,12,21,4,0)
	;;=use the check date beginning with version 3.5 of Fee Basis.  Entries
	;;^DD(162.03,12,21,5,0)
	;;=prior to version 3.5 are the date the system automatically entered when
	;;^DD(162.03,12,21,6,0)
	;;=the payment line item was queued to be transmitted to the Austin Automation
	;;^DD(162.03,12,21,7,0)
	;;=Center for payment.
	;;^DD(162.03,12,"DT")
	;;=2860102
	;;^DD(162.03,13,0)
	;;=DATE CORRECT INVOICE RECEIVED^RDX^^0;15^S %DT="EX" D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(162.03,13,21,0)
	;;=^^4^4^2940315^^
	;;^DD(162.03,13,21,1,0)
	;;=Date that the VA receives what it feels to be a complete/correct invoice.
	;;^DD(162.03,13,21,2,0)
	;;=This date is very important since it is the date used by the Central Fee
	;;^DD(162.03,13,21,3,0)
	;;=system in determining if interest should be paid because of untimely
	;;^DD(162.03,13,21,4,0)
	;;=processing by VA. Requirements for the prompt payment act apply.
	;;^DD(162.03,13,"DT")
	;;=2930308
	;;^DD(162.03,14,0)
	;;=INVOICE NUMBER^NJ9,0X^^0;16^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N)!('$$CHKBI^FBAAUTL4(X)) X
	;;^DD(162.03,14,1,0)
	;;=^.1
	;;^DD(162.03,14,1,1,0)
	;;=162^C
	;;^DD(162.03,14,1,1,1)
	;;=S ^FBAAC("C",$E(X,1,30),DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,14,1,1,2)
	;;=K ^FBAAC("C",$E(X,1,30),DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,14,1,2,0)
	;;=162^AJ^MUMPS
	;;^DD(162.03,14,1,2,1)
	;;=I +$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,8) S ^FBAAC("AJ",$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,8),$E(X,1,30),DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,14,1,2,2)
	;;=I +$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,8) K ^FBAAC("AJ",$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),U,8),$E(X,1,30),DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,14,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 999999999
	;;^DD(162.03,14,21,0)
	;;=^^1^1^2880617^^^
	;;^DD(162.03,14,21,1,0)
	;;=An automatically generated number associated with a vendor's bill.
	;;^DD(162.03,14,"DT")
	;;=2940722
	;;^DD(162.03,15,0)
	;;=PATIENT TYPE CODE^RS^00:SURGICAL;10:MEDICAL;60:HOME NURSING SERVICE;85:PSYCHIATRIC-CONTRACT;86:PSYCHIATRIC;95:NEUROLOGICAL-CONTACT;96:NEUROLOGICAL;^0;17^Q
	;;^DD(162.03,15,21,0)
	;;=^^3^3^2910111^^
	;;^DD(162.03,15,21,1,0)
	;;=The patient's type code (ie medical, surgical) related to this payment
	;;^DD(162.03,15,21,2,0)
	;;=line item. This is based on the authorization that is selected during
	;;^DD(162.03,15,21,3,0)
	;;=the payment process.
	;;^DD(162.03,15,"DT")
	;;=2910111
	;;^DD(162.03,16,0)
	;;=PURPOSE OF VISIT^R*P161.82'X^FBAA(161.82,^0;18^N FBZ S FBZ=$P($G(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0)),U,9),DIC("S")="I $S($G(FBZ):$P(^(0),U,2)=FBZ,1:1)&($S('$G(^(""I"")):1,DT'>^(""I""):1,1:0))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X

FBINI01E
FBINI01E	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.03,16,12)
	;;=A Purpose of Visit that matches the Fee Program selected and the POV must not have an inactive date.
	;;^DD(162.03,16,12.1)
	;;=S DIC("S")="I $S($G(FBZ):$P(^(0),U,2)=FBZ,1:1)&($S('$G(^(""I"")):1,DT'>^(""I""):1,1:0))"
	;;^DD(162.03,16,21,0)
	;;=^^3^3^2880301^
	;;^DD(162.03,16,21,1,0)
	;;=This identifies the purpose that the veteran received the service
	;;^DD(162.03,16,21,2,0)
	;;=provided. This data is obtained from the authorization data for
	;;^DD(162.03,16,21,3,0)
	;;=the patient, at the time of payment entry.
	;;^DD(162.03,16,"DT")
	;;=2950113
	;;^DD(162.03,17,0)
	;;=TREATMENT TYPE CODE^RS^1:SHORT TERM FEE STATUS;2:HOME NURSING SERVICE;3:I.D. CARD STATUS;^0;19^Q
	;;^DD(162.03,17,21,0)
	;;=^^3^3^2880301^
	;;^DD(162.03,17,21,1,0)
	;;=The treatment type code this payment is related to. It is obtained from
	;;^DD(162.03,17,21,2,0)
	;;=the authorization data for the patient which was selected at the time 
	;;^DD(162.03,17,21,3,0)
	;;=of payment entry.
	;;^DD(162.03,17,"DT")
	;;=2930129
	;;^DD(162.03,18,0)
	;;=PAYMENT TYPE CODE^RS^R:REIMBURSEMENT;S:STATISTICAL;V:VENDOR;SR:STAT-REIMBURSEMENT;^0;20^Q
	;;^DD(162.03,18,21,0)
	;;=^^5^5^2940926^^
	;;^DD(162.03,18,21,1,0)
	;;=Identifies whether this is a payment to a vendor, a reimbursement to the
	;;^DD(162.03,18,21,2,0)
	;;=veteran, a statistical payment which only updates veteran year-to-date
	;;^DD(162.03,18,21,3,0)
	;;=amounts and results in NO payment and a statistical reimbursement
	;;^DD(162.03,18,21,4,0)
	;;=which allows the user to update payment record with a
	;;^DD(162.03,18,21,5,0)
	;;=reimbursement paid out of system.
	;;^DD(162.03,18,"DT")
	;;=2860424
	;;^DD(162.03,19,0)
	;;=REJECT STATUS^S^P:REJECTED, PENDING;C:REJECTED, COMPLETED;^FBREJ;1^Q
	;;^DD(162.03,19,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.03,19,21,1,0)
	;;=Identifies whether this line item has been rejected and is pending 
	;;^DD(162.03,19,21,2,0)
	;;=assignment to another batch.
	;;^DD(162.03,19,"DT")
	;;=2941026
	;;^DD(162.03,20,0)
	;;=REJECT REASON^F^^FBREJ;2^K:$L(X)>40!($L(X)<2) X
	;;^DD(162.03,20,3)
	;;=ANSWER MUST BE 2-40 CHARACTERS IN LENGTH
	;;^DD(162.03,20,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.03,20,21,1,0)
	;;=The reason this line item was rejected for payment. Normally, the Austin
	;;^DD(162.03,20,21,2,0)
	;;=reject code is entered. 
	;;^DD(162.03,20,"DT")
	;;=2860811
	;;^DD(162.03,21,0)
	;;=OLD BATCH NUMBER^P161.7'^FBAA(161.7,^FBREJ;3^Q
	;;^DD(162.03,21,1,0)
	;;=^.1
	;;^DD(162.03,21,1,1,0)
	;;=162^AH
	;;^DD(162.03,21,1,1,1)
	;;=S ^FBAAC("AH",$E(X,1,30),DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,21,1,1,2)
	;;=K ^FBAAC("AH",$E(X,1,30),DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,21,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.03,21,21,1,0)
	;;=The batch number this line item was associated with before the line 
	;;^DD(162.03,21,21,2,0)
	;;=item was rejected. 
	;;^DD(162.03,21,"DT")
	;;=2860811
	;;^DD(162.03,22,0)
	;;=DESCRIPTION OF SUSPENSION^162.05^^1;0
	;;^DD(162.03,22,21,0)
	;;=^^3^3^2880919^^^
	;;^DD(162.03,22,21,1,0)
	;;=This field is used only when the suspend code entered is '4' meaning 
	;;^DD(162.03,22,21,2,0)
	;;='Other'. This allows the entering of the reason that the payment amount
	;;^DD(162.03,22,21,3,0)
	;;=was not in full. This will be printed on the suspense letter.
	;;^DD(162.03,23,0)
	;;=FEE PROGRAM^P161.8'^FBAA(161.8,^0;9^Q
	;;^DD(162.03,23,1,0)
	;;=^.1^^-1
	;;^DD(162.03,23,1,1,0)
	;;=162^AN^MUMPS
	;;^DD(162.03,23,1,1,1)
	;;=S:X'=2 ^FBAAC("AN",X,DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,23,1,1,2)
	;;=K ^FBAAC("AN",X,DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,23,1,1,"%D",0)
	;;=^^2^2^2920908^
	;;^DD(162.03,23,1,1,"%D",1,0)
	;;=Cross-reference is used to easily identify those fee services which
	;;^DD(162.03,23,1,1,"%D",2,0)
	;;=belong to fee programs other than outpatient medical.
	;;^DD(162.03,23,1,1,"DT")
	;;=2920908
	;;^DD(162.03,23,21,0)
	;;=^^2^2^2930519^^
	;;^DD(162.03,23,21,1,0)
	;;=The Fee program that this line item is associated with (ie Outpatient
	;;^DD(162.03,23,21,2,0)
	;;=Medical, Contract Hospital).
	;;^DD(162.03,23,"DT")
	;;=2920908
	;;^DD(162.03,24,0)
	;;=VOID PAYMENT^S^VP:VOID;^0;21^Q

FBINI01F
FBINI01F	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.03,24,21,0)
	;;=^^5^5^2941128^
	;;^DD(162.03,24,21,1,0)
	;;=This field is set when a payment was made in error and the
	;;^DD(162.03,24,21,2,0)
	;;=site has initiated a bill of collection to retrieve the
	;;^DD(162.03,24,21,3,0)
	;;=dollars expended.
	;;^DD(162.03,24,21,4,0)
	;;=The ability to void a payment is restricted to the holder
	;;^DD(162.03,24,21,5,0)
	;;=of the FBAASUPERVISOR security key.
	;;^DD(162.03,24,"DT")
	;;=2880325
	;;^DD(162.03,24.5,0)
	;;=REASON FOR VOIDED PAYMENT^F^^R;1^K:$L(X)>75!($L(X)<3) X
	;;^DD(162.03,24.5,3)
	;;=Answer must be 3-75 characters in length.
	;;^DD(162.03,24.5,21,0)
	;;=^^2^2^2920831^
	;;^DD(162.03,24.5,21,1,0)
	;;=This field will allow the Fee Supervisor to store the reason why
	;;^DD(162.03,24.5,21,2,0)
	;;=they had to void a payment.
	;;^DD(162.03,24.5,"DT")
	;;=2920831
	;;^DD(162.03,25,0)
	;;=SUPERVISOR^P200'^VA(200,^0;22^Q
	;;^DD(162.03,25,21,0)
	;;=^^1^1^2880325^
	;;^DD(162.03,25,21,1,0)
	;;=This is the Fee Supervisor who cancelled(voided) the payment.
	;;^DD(162.03,25,"DT")
	;;=2900405
	;;^DD(162.03,26,0)
	;;=PRIMARY SERVICE FACILITY^P4'^DIC(4,^0;12^Q
	;;^DD(162.03,26,21,0)
	;;=^^1^1^2941128^^^
	;;^DD(162.03,26,21,1,0)
	;;=The VA Hospital responsible for the veterans care.
	;;^DD(162.03,26,"DT")
	;;=2900419
	;;^DD(162.03,27,0)
	;;=ASSOCIATED 7078/583^V^^0;13^Q
	;;^DD(162.03,27,1,0)
	;;=^.1
	;;^DD(162.03,27,1,1,0)
	;;=162^AM
	;;^DD(162.03,27,1,1,1)
	;;=S ^FBAAC("AM",$E(X,1,30),DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,27,1,1,2)
	;;=K ^FBAAC("AM",$E(X,1,30),DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,27,3)
	;;=
	;;^DD(162.03,27,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.03,27,21,1,0)
	;;=Contains the related 7078 or 583 if an unauthorized claim.
	;;^DD(162.03,27,"DT")
	;;=2900918
	;;^DD(162.03,27,"V",0)
	;;=^.12P^2^2
	;;^DD(162.03,27,"V",1,0)
	;;=162.4^Select associated 7078^1^FB7078^^n
	;;^DD(162.03,27,"V",2,0)
	;;=162.7^Select associated 583^2^FB583^^n
	;;^DD(162.03,28,0)
	;;=PRIMARY DIAGNOSIS^P80'^ICD9(^0;23^Q
	;;^DD(162.03,28,21,0)
	;;=^^2^2^2920610^
	;;^DD(162.03,28,21,1,0)
	;;=This field contains the primary diagnosis of the patient for the
	;;^DD(162.03,28,21,2,0)
	;;=service provided.
	;;^DD(162.03,28,23,0)
	;;=^^2^2^2920610^
	;;^DD(162.03,28,23,1,0)
	;;=This field is a pointer to the ICD DIAGNOSIS (#80) file.  It is
	;;^DD(162.03,28,23,2,0)
	;;=used to attach a diagnosis to a CPT code.
	;;^DD(162.03,28,"DT")
	;;=2930526
	;;^DD(162.03,29,0)
	;;=VA TYPE OF SERVICE^P163.85'^FBAA(163.85,^0;24^Q
	;;^DD(162.03,29,21,0)
	;;=^^4^4^2920610^^
	;;^DD(162.03,29,21,1,0)
	;;=The information recorded in this field will be sent with the
	;;^DD(162.03,29,21,2,0)
	;;=payment record to the Austin DPC.  It will allow the program
	;;^DD(162.03,29,21,3,0)
	;;=office to do some comparisons between VA supplied services
	;;^DD(162.03,29,21,4,0)
	;;=and those supplied by Fee Basis.
	;;^DD(162.03,29,23,0)
	;;=^^2^2^2920610^
	;;^DD(162.03,29,23,1,0)
	;;=This filed is a pointer to Fee Basis VA Type of Service (#163.85) file.
	;;^DD(162.03,29,23,2,0)
	;;=It is a static table file populated by the program office.
	;;^DD(162.03,29,"DT")
	;;=2920630
	;;^DD(162.03,30,0)
	;;=PLACE OF SERVICE^P353.1'O^IBE(353.1,^0;25^Q
	;;^DD(162.03,30,2)
	;;=S Y(0)=Y S Y=$P(^IBE(353.1,+Y,0),U,2)_" ("_$P(^(0),U)_")"
	;;^DD(162.03,30,2.1)
	;;=S Y=$P(^IBE(353.1,+Y,0),U,2)_" ("_$P(^(0),U)_")"
	;;^DD(162.03,30,21,0)
	;;=^^2^2^2920610^
	;;^DD(162.03,30,21,1,0)
	;;=This field determines where the service was administered to the
	;;^DD(162.03,30,21,2,0)
	;;=veteran.
	;;^DD(162.03,30,23,0)
	;;=^^3^3^2920610^
	;;^DD(162.03,30,23,1,0)
	;;=This field is a pointer to the Place of Service (#353.1) file.
	;;^DD(162.03,30,23,2,0)
	;;=It contains data supplied by the Health Care Finance Administration
	;;^DD(162.03,30,23,3,0)
	;;=and is recorded on HCFA form 1500.
	;;^DD(162.03,30,"DT")
	;;=2940412
	;;^DD(162.03,31,0)
	;;=HCFA TYPE OF SERVICE^P353.2'O^IBE(353.2,^0;26^Q
	;;^DD(162.03,31,2)
	;;=S Y(0)=Y S Y=$P(^IBE(353.2,+Y,0),U,2)_" ("_$P(^(0),U)_")"
	;;^DD(162.03,31,2.1)
	;;=S Y=$P(^IBE(353.2,+Y,0),U,2)_" ("_$P(^(0),U)_")"

FBINI01G
FBINI01G	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.03,31,21,0)
	;;=^^2^2^2920610^
	;;^DD(162.03,31,21,1,0)
	;;=This information will be used to determine payment amounts in the
	;;^DD(162.03,31,21,2,0)
	;;=future.  It is currently asked on the HCFA 1500 form.
	;;^DD(162.03,31,23,0)
	;;=^^3^3^2920610^
	;;^DD(162.03,31,23,1,0)
	;;=This field is a pointer to the Type of Service (#353.2) file. It
	;;^DD(162.03,31,23,2,0)
	;;=is a table file with data supplied by the Health Care finance
	;;^DD(162.03,31,23,3,0)
	;;=Administration.
	;;^DD(162.03,31,"DT")
	;;=2940412
	;;^DD(162.03,32,0)
	;;=SERVICE CONNECTED CONDITION?^FXO^^0;27^I $D(X) D YN^FBAAUTL3
	;;^DD(162.03,32,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(162.03,32,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(162.03,32,3)
	;;=Answer 'Yes' or '1' for YES and 'No' or '0' for NO.
	;;^DD(162.03,32,4)
	;;=I $G(DFN) W !?1,*7,"Patient:  ",$$NAME^FBCHREQ2(DFN) D DIS^DGRPDB W !!
	;;^DD(162.03,32,21,0)
	;;=^^3^3^2930723^^^^
	;;^DD(162.03,32,21,1,0)
	;;=Indicates whether the service provided was for a Service Connected
	;;^DD(162.03,32,21,2,0)
	;;=condition.  Answer 'Yes' if service provided was for a Service
	;;^DD(162.03,32,21,3,0)
	;;=Connected condition, 'No' if eligible under NSC such as Aid and Attendance.
	;;^DD(162.03,32,23,0)
	;;=^^1^1^2930723^
	;;^DD(162.03,32,23,1,0)
	;;= 
	;;^DD(162.03,32,"DT")
	;;=2940318
	;;^DD(162.03,33,0)
	;;=VENDOR INVOICE DATE^RDX^^2;1^S %DT="E" D ^%DT S X=Y K:Y<1 X I X>$P(^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA,0),"^",15) W !,*7,"Vendor Invoice Date cannot be later than the Date Correct Invoice Received" K X
	;;^DD(162.03,33,3)
	;;=Enter the date the vendor issued the invoice.
	;;^DD(162.03,33,21,0)
	;;=^^1^1^2940315^^
	;;^DD(162.03,33,21,1,0)
	;;=This is the date that the vendor issued the invoice.
	;;^DD(162.03,33,"DT")
	;;=2940414
	;;^DD(162.03,34,0)
	;;=PROMPT PAY TYPE^S^1:MONEY MANAGED;^2;2^Q
	;;^DD(162.03,34,3)
	;;=Set equal to 1 if payment is subject to interest payments.
	;;^DD(162.03,34,21,0)
	;;=^^2^2^2940315^^
	;;^DD(162.03,34,21,1,0)
	;;=Field is set to 1 if the payment is subject to interest payments (prompt
	;;^DD(162.03,34,21,2,0)
	;;=pay).  Otherwise it remains blank.
	;;^DD(162.03,34,"DT")
	;;=2940318
	;;^DD(162.03,35,0)
	;;=CHECK NUMBER^F^^2;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<1)!'(X?.NA) X
	;;^DD(162.03,35,1,0)
	;;=^.1
	;;^DD(162.03,35,1,1,0)
	;;=162^ACK^MUMPS
	;;^DD(162.03,35,1,1,1)
	;;=S ^FBAAC("ACK",X,DA(3),DA(2),DA(1),DA)=""
	;;^DD(162.03,35,1,1,2)
	;;=K ^FBAAC("ACK",X,DA(3),DA(2),DA(1),DA)
	;;^DD(162.03,35,1,1,"%D",0)
	;;=^^2^2^2940425^
	;;^DD(162.03,35,1,1,"%D",1,0)
	;;=This cross-reference is used for finding payment items for specific check
	;;^DD(162.03,35,1,1,"%D",2,0)
	;;=numbers.
	;;^DD(162.03,35,1,1,"DT")
	;;=2940425
	;;^DD(162.03,35,3)
	;;=Answer must be 1-8 characters in length.
	;;^DD(162.03,35,21,0)
	;;=^^3^3^2940315^^
	;;^DD(162.03,35,21,1,0)
	;;=Contains the check number as issued by the treasury.  This field is updated
	;;^DD(162.03,35,21,2,0)
	;;=after the check is issued, through a server option that records actual
	;;^DD(162.03,35,21,3,0)
	;;=payment information for each Fee payment made.
	;;^DD(162.03,35,"DT")
	;;=2940425
	;;^DD(162.03,36,0)
	;;=CANCELLATION DATE^D^^2;4^S %DT="E" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.03,36,3)
	;;=The date the check was cancelled by the treasury.
	;;^DD(162.03,36,21,0)
	;;=^^3^3^2940315^^
	;;^DD(162.03,36,21,1,0)
	;;=This is the date the treasury cancelled the check.  This field is updated
	;;^DD(162.03,36,21,2,0)
	;;=through a server option that records cancellations of previously recorded
	;;^DD(162.03,36,21,3,0)
	;;=payment data.
	;;^DD(162.03,36,"AUDIT")
	;;=
	;;^DD(162.03,36,"DT")
	;;=2940315
	;;^DD(162.03,37,0)
	;;=REASON CODE^P162.95'^FB(162.95,^2;5^Q
	;;^DD(162.03,37,3)
	;;=Enter the reason the check was cancelled.
	;;^DD(162.03,37,21,0)
	;;=^^3^3^2940315^^
	;;^DD(162.03,37,21,1,0)
	;;=This field contains a pointer to the Fee Basis Check Cancellation Reason
	;;^DD(162.03,37,21,2,0)
	;;=file.  It is populated through a server option that updates the payment
	;;^DD(162.03,37,21,3,0)
	;;=record when the treasury cancels a check that was previously payed.

FBINI01H
FBINI01H	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.03,37,"DT")
	;;=2940315
	;;^DD(162.03,38,0)
	;;=CANCELLATION ACTIVITY^S^R:WILL BE REPLACED;C:WILL BE REISSUED;X:WILL NOT BE REISSUED;^2;6^Q
	;;^DD(162.03,38,3)
	;;=Field will contain the cancellation code if there has been cancellation activity on this payment.
	;;^DD(162.03,38,21,0)
	;;=^^7^7^2940426^^
	;;^DD(162.03,38,21,1,0)
	;;=This field is populated when a cancellation is recorded for the payment
	;;^DD(162.03,38,21,2,0)
	;;=referenced.  This field will always remain populated, to indicate that
	;;^DD(162.03,38,21,3,0)
	;;=there was cancellation activity on this payment at one time.  New payments
	;;^DD(162.03,38,21,4,0)
	;;=will replace the cancellation date and reason code fields, but the
	;;^DD(162.03,38,21,5,0)
	;;=cancellation activity flag will not be overwritten.  This flag will allow
	;;^DD(162.03,38,21,6,0)
	;;=the user to know that previous cancellation activity existed, and to
	;;^DD(162.03,38,21,7,0)
	;;=review the cancellation history output for further information.
	;;^DD(162.03,38,"DT")
	;;=2940426
	;;^DD(162.03,39,0)
	;;=CPT MODIFIER^P81.3'^DIC(81.3,^2;7^Q
	;;^DD(162.03,39,1,0)
	;;=^.1
	;;^DD(162.03,39,1,1,0)
	;;=162^AE1^MUMPS
	;;^DD(162.03,39,1,1,1)
	;;=D SMOD^FBAAUTL4($$CPTMOD^FBAAUTL4(DA(3),DA(2),DA(1),DA),X)
	;;^DD(162.03,39,1,1,2)
	;;=D KMOD^FBAAUTL4($$CPTMOD^FBAAUTL4(DA(3),DA(2),DA(1),DA),X)
	;;^DD(162.03,39,1,1,"%D",0)
	;;=^^10^10^2940610^^
	;;^DD(162.03,39,1,1,"%D",1,0)
	;;=Cross-reference built to concatenate CPT with Modifier for duplicate payment
	;;^DD(162.03,39,1,1,"%D",2,0)
	;;=checks.  The cross-reference is set by both the Service Provided field,
	;;^DD(162.03,39,1,1,"%D",3,0)
	;;=as well as the CPT Modifier field.
	;;^DD(162.03,39,1,1,"%D",4,0)
	;;= 
	;;^DD(162.03,39,1,1,"%D",5,0)
	;;=***If the need arises to re-index the entire cross-reference, it should
	;;^DD(162.03,39,1,1,"%D",6,0)
	;;=be done by re-indexing the Service Provided field and not the
	;;^DD(162.03,39,1,1,"%D",7,0)
	;;=CPT Modifier field.  As a Service Provided (CPT code) is mandatory for
	;;^DD(162.03,39,1,1,"%D",8,0)
	;;=each payment entry, but a CPT Modifier is not, to assure a complete
	;;^DD(162.03,39,1,1,"%D",9,0)
	;;=cross-reference, the re-indexing should be done on the Service Provided
	;;^DD(162.03,39,1,1,"%D",10,0)
	;;=field.
	;;^DD(162.03,39,1,1,"DT")
	;;=2940610
	;;^DD(162.03,39,21,0)
	;;=^^3^3^2941128^
	;;^DD(162.03,39,21,1,0)
	;;=This field is used to better describe the service (CPT) rendered.
	;;^DD(162.03,39,21,2,0)
	;;=The modifier will be combined with the CPT code to build the
	;;^DD(162.03,39,21,3,0)
	;;=Fee Schedule and to check for duplicate payment entry.
	;;^DD(162.03,39,"DT")
	;;=2940610
	;;^DD(162.03,40,0)
	;;=DISBURSED AMOUNT^NJ9,2^^2;8^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.03,40,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.03,40,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.03,40,21,1,0)
	;;=This is the dollar amount paid by the treasury, less any interest paid.
	;;^DD(162.03,40,"DT")
	;;=2940421
	;;^DD(162.03,41,0)
	;;=INTEREST AMOUNT^NJ9,2^^2;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.03,41,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.03,41,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.03,41,21,1,0)
	;;=The interest amount paid on this line item by the treasury.
	;;^DD(162.03,41,"DT")
	;;=2940421
	;;^DD(162.04,0)
	;;=TRAVEL PAYMENT DATE SUB-FIELD^^3.5^16
	;;^DD(162.04,0,"DT")
	;;=2940926
	;;^DD(162.04,0,"IX","AB",162.04,.01)
	;;=
	;;^DD(162.04,0,"NM","TRAVEL PAYMENT DATE")
	;;=
	;;^DD(162.04,0,"UP")
	;;=162
	;;^DD(162.04,.01,0)
	;;=TRAVEL PAYMENT DATE^MDX^^0;1^S %DT="EX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(162.04,.01,1,0)
	;;=^.1
	;;^DD(162.04,.01,1,1,0)
	;;=162.04^AB
	;;^DD(162.04,.01,1,1,1)
	;;=S ^FBAAC(DA(1),3,"AB",$E(X,1,30),DA)=""
	;;^DD(162.04,.01,1,1,2)
	;;=K ^FBAAC(DA(1),3,"AB",$E(X,1,30),DA)
	;;^DD(162.04,.01,21,0)
	;;=^^1^1^2930603^^^^
	;;^DD(162.04,.01,21,1,0)
	;;=The date the travel being paid was performed.

FBINI01I
FBINI01I	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.04,.01,"DT")
	;;=2870320
	;;^DD(162.04,1,0)
	;;=TRAVEL BATCH NUMBER^R*P161.7'^FBAA(161.7,^0;2^S DIC("S")="I $P(^(0),U,3)=""B2""&($P(^(0),U,5)=DUZ)&(^(""ST"")=""O"")" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.04,1,1,0)
	;;=^.1
	;;^DD(162.04,1,1,1,0)
	;;=162^AD
	;;^DD(162.04,1,1,1,1)
	;;=S ^FBAAC("AD",$E(X,1,30),DA(1),DA)=""
	;;^DD(162.04,1,1,1,2)
	;;=K ^FBAAC("AD",$E(X,1,30),DA(1),DA)
	;;^DD(162.04,1,12)
	;;=Allows selection of travel batches in open status, which were opened by this specific user.
	;;^DD(162.04,1,12.1)
	;;=S DIC("S")="I $P(^(0),U,3)=""B2""&($P(^(0),U,5)=DUZ)&(^(""ST"")=""O"")"
	;;^DD(162.04,1,21,0)
	;;=^^1^1^2930514^^
	;;^DD(162.04,1,21,1,0)
	;;=The batch number that this travel payment will be associated with.
	;;^DD(162.04,1,"DT")
	;;=2861216
	;;^DD(162.04,2,0)
	;;=TRAVEL AMOUNT^RNJ6,2^^0;3^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999)!(X<.01) X
	;;^DD(162.04,2,1,0)
	;;=^.1^^-1
	;;^DD(162.04,2,1,1,0)
	;;=^^TRIGGER^161.7^8
	;;^DD(162.04,2,1,1,1)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA X ^DD(162.04,2,1,1,1.2) S X=DIV S X=DIU+DIV X ^DD(162.04,2,1,1,1.4)
	;;^DD(162.04,2,1,1,1.2)
	;;=X ^DD(162.04,2,1,1,89.2) K DIC S DIC="^FBAA(161.7,",DIC(0)="NMF" D ^DIC S (D,D0,DIV(0))=+Y S Y(101)=$S($D(^FBAA(161.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,9) S D0=I(0,0) S D1=I(1,0) S DIU=X K Y
	;;^DD(162.04,2,1,1,1.4)
	;;=S DIH=$S($D(^FBAA(161.7,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) X "F %=0:0 Q:$L($P(DIH,U,8,99))  S DIH=DIH_U" S %=$P(DIH,U,10,999),DIU=$P(DIH,U,9),^(0)=$P(DIH,U,1,8)_U_DIV_$S(%]"":U_%,1:""),DIH=161.7,DIG=8 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.04,2,1,1,2)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA X ^DD(162.04,2,1,1,2.2) S X=DIV S X=DIU-X X ^DD(162.04,2,1,1,2.4)
	;;^DD(162.04,2,1,1,2.2)
	;;=X ^DD(162.04,2,1,1,89.2) K DIC S DIC="^FBAA(161.7,",DIC(0)="NMF" D ^DIC S (D,D0,DIV(0))=+Y S Y(101)=$S($D(^FBAA(161.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,9) S D0=I(0,0) S D1=I(1,0) S DIU=X K Y
	;;^DD(162.04,2,1,1,2.4)
	;;=S DIH=$S($D(^FBAA(161.7,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) X "F %=0:0 Q:$L($P(DIH,U,8,99))  S DIH=DIH_U" S %=$P(DIH,U,10,999),DIU=$P(DIH,U,9),^(0)=$P(DIH,U,1,8)_U_DIV_$S(%]"":U_%,1:""),DIH=161.7,DIG=8 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.04,2,1,1,89.2)
	;;=S I(1,0)=$S($D(D1):D1,1:""),I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^FBAAC(D0,3,D1,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S X=X
	;;^DD(162.04,2,1,1,"CREATE VALUE")
	;;=TOTAL DOLLARS+TRAVEL AMOUNT
	;;^DD(162.04,2,1,1,"DELETE VALUE")
	;;=TOTAL DOLLARS-OLD TRAVEL AMOUNT
	;;^DD(162.04,2,1,1,"DIC")
	;;=LOOKUP
	;;^DD(162.04,2,1,1,"FIELD")
	;;=TRAVEL BATCH NUMBER:FEE BASIS BATCH:TOTAL DOLLARS
	;;^DD(162.04,2,1,2,0)
	;;=^^TRIGGER^161.7^10
	;;^DD(162.04,2,1,2,1)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA X ^DD(162.04,2,1,2,1.2) S X=DIV S X=DIU+1 X ^DD(162.04,2,1,2,1.4)
	;;^DD(162.04,2,1,2,1.2)
	;;=X ^DD(162.04,2,1,2,89.2) K DIC S DIC="^FBAA(161.7,",DIC(0)="NMF" D ^DIC S (D,D0,DIV(0))=+Y S Y(101)=$S($D(^FBAA(161.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,11) S D0=I(0,0) S D1=I(1,0) S DIU=X K Y
	;;^DD(162.04,2,1,2,1.4)
	;;=S DIH=$S($D(^FBAA(161.7,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) X "F %=0:0 Q:$L($P(DIH,U,10,99))  S DIH=DIH_U" S %=$P(DIH,U,12,999),DIU=$P(DIH,U,11),^(0)=$P(DIH,U,1,10)_U_DIV_$S(%]"":U_%,1:""),DIH=161.7,DIG=10 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.04,2,1,2,2)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA X ^DD(162.04,2,1,2,2.2) S X=DIV S X=DIU-1 X ^DD(162.04,2,1,2,2.4)
	;;^DD(162.04,2,1,2,2.2)
	;;=X ^DD(162.04,2,1,2,89.2) K DIC S DIC="^FBAA(161.7,",DIC(0)="NMF" D ^DIC S (D,D0,DIV(0))=+Y S Y(101)=$S($D(^FBAA(161.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,11) S D0=I(0,0) S D1=I(1,0) S DIU=X K Y
	;;^DD(162.04,2,1,2,2.4)
	;;=S DIH=$S($D(^FBAA(161.7,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) X "F %=0:0 Q:$L($P(DIH,U,10,99))  S DIH=DIH_U" S %=$P(DIH,U,12,999),DIU=$P(DIH,U,11),^(0)=$P(DIH,U,1,10)_U_DIV_$S(%]"":U_%,1:""),DIH=161.7,DIG=10 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.04,2,1,2,89.2)
	;;=S I(1,0)=$S($D(D1):D1,1:""),I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^FBAAC(D0,3,D1,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S X=X S:X]"" X="`"_X

FBINI01J
FBINI01J	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.04,2,1,2,"CREATE VALUE")
	;;=PAYMENT LINE COUNT+1
	;;^DD(162.04,2,1,2,"DELETE VALUE")
	;;=PAYMENT LINE COUNT-1
	;;^DD(162.04,2,1,2,"DIC")
	;;=LOOKUP
	;;^DD(162.04,2,1,2,"FIELD")
	;;=TRAVEL BATCH NUMBER:FEE BASIS BATCH:PAYMENT LINE COUNT
	;;^DD(162.04,2,1,3,0)
	;;=^^TRIGGER^161.7^10
	;;^DD(162.04,2,1,3,1)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA X ^DD(162.04,2,1,3,1.2) S X=DIV S X=DIU+1 X ^DD(162.04,2,1,3,1.4)
	;;^DD(162.04,2,1,3,1.2)
	;;=X ^DD(162.04,2,1,3,89.2) K DIC S DIC="^FBAA(161.7,",DIC(0)="NMF" D ^DIC S (D,D0,DIV(0))=+Y S Y(101)=$S($D(^FBAA(161.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,11) S D0=I(0,0) S D1=I(1,0) S DIU=X K Y
	;;^DD(162.04,2,1,3,1.4)
	;;=S DIH=$S($D(^FBAA(161.7,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) X "F %=0:0 Q:$L($P(DIH,U,10,99))  S DIH=DIH_U" S %=$P(DIH,U,12,999),DIU=$P(DIH,U,11),^(0)=$P(DIH,U,1,10)_U_DIV_$S(%]"":U_%,1:""),DIH=161.7,DIG=10 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.04,2,1,3,2)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA X ^DD(162.04,2,1,3,2.2) S X=DIV S X=DIU-1 X ^DD(162.04,2,1,3,2.4)
	;;^DD(162.04,2,1,3,2.2)
	;;=X ^DD(162.04,2,1,3,89.2) K DIC S DIC="^FBAA(161.7,",DIC(0)="NMF" D ^DIC S (D,D0,DIV(0))=+Y S Y(101)=$S($D(^FBAA(161.7,D0,0)):^(0),1:"") S X=$P(Y(101),U,11) S D0=I(0,0) S D1=I(1,0) S DIU=X K Y
	;;^DD(162.04,2,1,3,2.4)
	;;=S DIH=$S($D(^FBAA(161.7,DIV(0),0)):^(0),1:""),DIV=X I $D(^(0)) X "F %=0:0 Q:$L($P(DIH,U,10,99))  S DIH=DIH_U" S %=$P(DIH,U,12,999),DIU=$P(DIH,U,11),^(0)=$P(DIH,U,1,10)_U_DIV_$S(%]"":U_%,1:""),DIH=161.7,DIG=10 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.04,2,1,3,89.2)
	;;=S I(1,0)=$S($D(D1):D1,1:""),I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^FBAAC(D0,3,D1,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S X=X
	;;^DD(162.04,2,1,3,"CREATE VALUE")
	;;=PAYMENT LINE COUNT+1
	;;^DD(162.04,2,1,3,"DELETE VALUE")
	;;=PAYMENT LINE COUNT-1
	;;^DD(162.04,2,1,3,"DIC")
	;;=LOOKUP
	;;^DD(162.04,2,1,3,"FIELD")
	;;=TRAVEL BATCH NUMBER:FEE BASIS BATCH:PAYMENT LINE COUNT
	;;^DD(162.04,2,3)
	;;=Type a Dollar Amount between .01 and 999, 2 Decimal Digits
	;;^DD(162.04,2,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.04,2,21,1,0)
	;;=The amount to be paid for the travel.
	;;^DD(162.04,2,"DT")
	;;=2880301
	;;^DD(162.04,3,0)
	;;=TRAVEL OBLIGATION NUMBER^F^^0;4^K:$L(X)>6!($L(X)<6) X
	;;^DD(162.04,3,3)
	;;=ANSWER MUST BE 6 CHARACTERS IN LENGTH
	;;^DD(162.04,3,21,0)
	;;=^^2^2^2930519^^
	;;^DD(162.04,3,21,1,0)
	;;=The obligation number identifying the funds from which this travel payment
	;;^DD(162.04,3,21,2,0)
	;;=will be paid.
	;;^DD(162.04,3,"DT")
	;;=2860805
	;;^DD(162.04,3.5,0)
	;;=PAYMENT TYPE CODE^S^R:REIMBURSEMENT;S:STATISTICAL;SR:STAT-REIMBURSEMENT;V:VENDOR;^0;13^Q
	;;^DD(162.04,3.5,21,0)
	;;=^^8^8^2940926^
	;;^DD(162.04,3.5,21,1,0)
	;;=An entry of 'R' will indicate the travel is for a reimbursement to the
	;;^DD(162.04,3.5,21,2,0)
	;;=veteran.
	;;^DD(162.04,3.5,21,3,0)
	;;=An entry of 'S' will indicate the travel was paid "out of system"
	;;^DD(162.04,3.5,21,4,0)
	;;=to a vendor and allows the update of the payment history files.
	;;^DD(162.04,3.5,21,5,0)
	;;=An entry of 'SR' will indicate a statistical reimbursement to a
	;;^DD(162.04,3.5,21,6,0)
	;;=party other than the vendor.
	;;^DD(162.04,3.5,21,7,0)
	;;=An entry of 'V' or 'S' is not used currently.  Travel is only paid to
	;;^DD(162.04,3.5,21,8,0)
	;;=a veteran.
	;;^DD(162.04,3.5,"DT")
	;;=2940926
	;;^DD(162.04,4,0)
	;;=REJECT STATUS^S^P:REJECTED, PENDING;C:REJECTED, COMPLETED;^FBREJ;1^Q
	;;^DD(162.04,4,1,0)
	;;=^.1^^0
	;;^DD(162.04,4,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.04,4,21,1,0)
	;;=Identifies whether this line item is in a reject status pending
	;;^DD(162.04,4,21,2,0)
	;;=assignment to another batch.
	;;^DD(162.04,4,"DT")
	;;=2860811
	;;^DD(162.04,5,0)
	;;=REJECT REASON^F^^FBREJ;2^K:$L(X)>40!($L(X)<2) X
	;;^DD(162.04,5,3)
	;;=ANSWER MUST BE 2-40 CHARACTERS IN LENGTH
	;;^DD(162.04,5,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.04,5,21,1,0)
	;;=The reason this line item was rejected for payment. Usually, the error
	;;^DD(162.04,5,21,2,0)
	;;=code identified by the Austin Central Fee system is entered.

FBINI01K
FBINI01K	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.04,5,"DT")
	;;=2860811
	;;^DD(162.04,6,0)
	;;=OLD BATCH NUMBER^P161.7'^FBAA(161.7,^FBREJ;3^Q
	;;^DD(162.04,6,1,0)
	;;=^.1
	;;^DD(162.04,6,1,1,0)
	;;=162^AG
	;;^DD(162.04,6,1,1,1)
	;;=S ^FBAAC("AG",$E(X,1,30),DA(1),DA)=""
	;;^DD(162.04,6,1,1,2)
	;;=K ^FBAAC("AG",$E(X,1,30),DA(1),DA)
	;;^DD(162.04,6,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.04,6,21,1,0)
	;;=The batch number this line item was associated with prior to being
	;;^DD(162.04,6,21,2,0)
	;;=rejected.
	;;^DD(162.04,6,"DT")
	;;=2860811
	;;^DD(162.04,7,0)
	;;=DATE FINALIZED^D^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.04,7,1,0)
	;;=^.1
	;;^DD(162.04,7,1,1,0)
	;;=162^AL
	;;^DD(162.04,7,1,1,1)
	;;=S ^FBAAC("AL",$E(X,1,30),DA(1),DA)=""
	;;^DD(162.04,7,1,1,2)
	;;=K ^FBAAC("AL",$E(X,1,30),DA(1),DA)
	;;^DD(162.04,7,21,0)
	;;=^^1^1^2930519^^
	;;^DD(162.04,7,21,1,0)
	;;=Indicates the date and time the travel payment was vouchered by Fiscal.
	;;^DD(162.04,7,"DT")
	;;=2880321
	;;^DD(162.04,8,0)
	;;=DATE PAID^D^^0;6^S %DT="E" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.04,8,3)
	;;=This is the date of the check, as issued by the treasury.
	;;^DD(162.04,8,21,0)
	;;=^^4^4^2940324^^
	;;^DD(162.04,8,21,1,0)
	;;=This is the date of the check, as issued by the treasury.  This
	;;^DD(162.04,8,21,2,0)
	;;=information will be passed back to DHCP from the Financial Management
	;;^DD(162.04,8,21,3,0)
	;;=System (FMS) when the check is issued to the vendor.  This field will
	;;^DD(162.04,8,21,4,0)
	;;=be populated beginning in version 3.5 of Fee Basis.
	;;^DD(162.04,8,"DT")
	;;=2940324
	;;^DD(162.04,9,0)
	;;=CHECK NUMBER^F^^0;7^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<1)!'(X?.NA) X
	;;^DD(162.04,9,1,0)
	;;=^.1
	;;^DD(162.04,9,1,1,0)
	;;=162^ACKT^MUMPS
	;;^DD(162.04,9,1,1,1)
	;;=S ^FBAAC("ACKT",X,DA(1),DA)=""
	;;^DD(162.04,9,1,1,2)
	;;=K ^FBAAC("ACKT",X,DA(1),DA)
	;;^DD(162.04,9,1,1,"%D",0)
	;;=^^2^2^2940425^
	;;^DD(162.04,9,1,1,"%D",1,0)
	;;=This cross-reference is used to located payment items for a specific
	;;^DD(162.04,9,1,1,"%D",2,0)
	;;=check number.
	;;^DD(162.04,9,1,1,"DT")
	;;=2940425
	;;^DD(162.04,9,3)
	;;=Answer must be 1-8 characters in length.
	;;^DD(162.04,9,21,0)
	;;=^^3^3^2940324^^
	;;^DD(162.04,9,21,1,0)
	;;=Contains the check number as issued by the treasury.  This field is updated
	;;^DD(162.04,9,21,2,0)
	;;=after the check is issued, through a server option that records actual
	;;^DD(162.04,9,21,3,0)
	;;=payment information for each Fee payment made.
	;;^DD(162.04,9,"DT")
	;;=2940425
	;;^DD(162.04,10,0)
	;;=CANCELLATION DATE^D^^0;8^S %DT="E" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.04,10,3)
	;;=The date the check was cancelled by the treasury.
	;;^DD(162.04,10,21,0)
	;;=^^3^3^2940324^^
	;;^DD(162.04,10,21,1,0)
	;;=This is the date the treasury cancelled the check.  This field is updated
	;;^DD(162.04,10,21,2,0)
	;;=through a server option that records cancellations of previously recorded
	;;^DD(162.04,10,21,3,0)
	;;=payment data.
	;;^DD(162.04,10,"DT")
	;;=2940324
	;;^DD(162.04,11,0)
	;;=REASON CODE^P162.95'^FB(162.95,^0;9^Q
	;;^DD(162.04,11,3)
	;;=Enter the reason the check was cancelled.
	;;^DD(162.04,11,21,0)
	;;=^^3^3^2940324^^
	;;^DD(162.04,11,21,1,0)
	;;=This field contains a pointer to the Fee Basis Check Cancellation Reason
	;;^DD(162.04,11,21,2,0)
	;;=file.  It is populated through a server option that updates the payment
	;;^DD(162.04,11,21,3,0)
	;;=record when the treasury cancels a check that was previously payed.
	;;^DD(162.04,11,"DT")
	;;=2940324
	;;^DD(162.04,12,0)
	;;=CANCELLATION ACTIVITY^S^R:WILL BE REPLACED;C:WIL BE REISSUED;X:WILL NOT BE REISSUED;^0;10^Q
	;;^DD(162.04,12,3)
	;;=Field will contain the cancellation code if there has been cancellation activity on this payment.
	;;^DD(162.04,12,21,0)
	;;=^^7^7^2940324^^
	;;^DD(162.04,12,21,1,0)
	;;=This field is populated when a cancellation is recorded for the payment
	;;^DD(162.04,12,21,2,0)
	;;=referenced.  This field will always remain populated, to indicate that
	;;^DD(162.04,12,21,3,0)
	;;=there was cancellation activity on this payment at one time.  New payments
	;;^DD(162.04,12,21,4,0)
	;;=will replace the cancellation date and reason code fields, but the

FBINI01L
FBINI01L	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.04,12,21,5,0)
	;;=cancellation activity flag will not be overwritten.  This flag will allow
	;;^DD(162.04,12,21,6,0)
	;;=the user to know that previous cancellation activity existed, and to
	;;^DD(162.04,12,21,7,0)
	;;=review the cancellation history output for further information.
	;;^DD(162.04,12,"DT")
	;;=2940426
	;;^DD(162.04,13,0)
	;;=DISBURSED AMOUNT^NJ9,2^^0;11^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.04,13,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.04,13,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.04,13,21,1,0)
	;;=This is the dollar amount paid by the treasury, less any interest paid.
	;;^DD(162.04,13,"DT")
	;;=2940421
	;;^DD(162.04,14,0)
	;;=INTEREST AMOUNT^NJ9,2^^0;12^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.04,14,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.04,14,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.04,14,21,1,0)
	;;=The interest amount paid on this line item by the treasury.
	;;^DD(162.04,14,"DT")
	;;=2940421
	;;^DD(162.05,0)
	;;=DESCRIPTION OF SUSPENSION SUB-FIELD^^.01^1
	;;^DD(162.05,0,"NM","DESCRIPTION OF SUSPENSION")
	;;=
	;;^DD(162.05,0,"UP")
	;;=162.03
	;;^DD(162.05,.01,0)
	;;=DESCRIPTION OF SUSPENSION^W^^0;1^Q
	;;^DD(162.05,.01,"DT")
	;;=2861010
	;;^DD(162.099,0)
	;;=DATE OF PURGE SUB-FIELD^^3^4
	;;^DD(162.099,0,"NM","DATE OF PURGE")
	;;=
	;;^DD(162.099,0,"UP")
	;;=162
	;;^DD(162.099,.01,0)
	;;=PURGE DATE^DX^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X) S DINUM=X
	;;^DD(162.099,.01,21,0)
	;;=^^3^3^2930514^^^
	;;^DD(162.099,.01,21,1,0)
	;;=Date that the purge routine was run which resulted in the purging of
	;;^DD(162.099,.01,21,2,0)
	;;=payment data for this patient. This data will exist ONLY IF data was 
	;;^DD(162.099,.01,21,3,0)
	;;=purged for the patient for the specific purge run.
	;;^DD(162.099,.01,"DT")
	;;=2920715
	;;^DD(162.099,1,0)
	;;=OPT MEDICAL DATA PURGED^S^Y:YES;^0;2^Q
	;;^DD(162.099,1,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.099,1,21,1,0)
	;;=This field will be populated ONLY if the purge has been run for Outpatient
	;;^DD(162.099,1,21,2,0)
	;;=Medical data for this patient.
	;;^DD(162.099,1,"DT")
	;;=2880321
	;;^DD(162.099,2,0)
	;;=PHARMACY DATA PURGED^S^Y:YES;^0;3^Q
	;;^DD(162.099,2,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.099,2,21,1,0)
	;;=This field will be populated ONLY if the purge has been run for Pharmacy
	;;^DD(162.099,2,21,2,0)
	;;=data for this patient.
	;;^DD(162.099,2,"DT")
	;;=2880321
	;;^DD(162.099,3,0)
	;;=TRAVEL DATA PURGED^S^Y:YES;^0;4^Q
	;;^DD(162.099,3,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.099,3,21,1,0)
	;;=This field will be populated ONLY if the purge has been run for Travel
	;;^DD(162.099,3,21,2,0)
	;;=data for this patient.
	;;^DD(162.099,3,"DT")
	;;=2880321

FBINI01M
FBINI01M	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.1,0,"GL")
	;;=^FBAA(162.1,
	;;^DIC("B","FEE BASIS PHARMACY INVOICE",162.1)
	;;=
	;;^DIC(162.1,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(162.1,"%D",1,0)
	;;=Contains Pharmacy invoices and payment data associated with hometown
	;;^DIC(162.1,"%D",2,0)
	;;=pharmacy payments.
	;;^DIC(162.1,"%D",3,0)
	;;= 
	;;^DIC(162.1,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.1,0)
	;;=FIELD^^12^15
	;;^DD(162.1,0,"DT")
	;;=2940926
	;;^DD(162.1,0,"IX","AA",162.11,15)
	;;=
	;;^DD(162.1,0,"IX","AC",162.1,5)
	;;=
	;;^DD(162.1,0,"IX","ACK",162.11,30)
	;;=
	;;^DD(162.1,0,"IX","AD",162.11,4)
	;;=
	;;^DD(162.1,0,"IX","AE",162.11,13)
	;;=
	;;^DD(162.1,0,"IX","AF",162.11,19)
	;;=
	;;^DD(162.1,0,"IX","AG",162.11,7)
	;;=
	;;^DD(162.1,0,"IX","AH",162.11,21)
	;;=
	;;^DD(162.1,0,"IX","AJ",162.11,13)
	;;=
	;;^DD(162.1,0,"IX","AN",162.1,3)
	;;=
	;;^DD(162.1,0,"IX","AO",162.11,26)
	;;=
	;;^DD(162.1,0,"IX","B",162.1,.01)
	;;=
	;;^DD(162.1,0,"NM","FEE BASIS PHARMACY INVOICE")
	;;=
	;;^DD(162.1,.01,0)
	;;=NUMBER^RNJ9,0X^^0;1^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N)!('$$CHKBI^FBAAUTL4(X)) X S:$D(X) DINUM=X
	;;^DD(162.1,.01,1,0)
	;;=^.1
	;;^DD(162.1,.01,1,1,0)
	;;=162.1^B
	;;^DD(162.1,.01,1,1,1)
	;;=S ^FBAA(162.1,"B",$E(X,1,30),DA)=""
	;;^DD(162.1,.01,1,1,2)
	;;=K ^FBAA(162.1,"B",$E(X,1,30),DA)
	;;^DD(162.1,.01,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 1 AND 999999999
	;;^DD(162.1,.01,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,.01,21,1,0)
	;;=This is an autogenerated number by the FEE system used to enter
	;;^DD(162.1,.01,21,2,0)
	;;=payments for a provider.
	;;^DD(162.1,.01,"DT")
	;;=2940722
	;;^DD(162.1,1,0)
	;;=DATE CORRECT INVOICE RECV'D^RDX^^0;2^S %DT="EX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(162.1,1,21,0)
	;;=^^2^2^2930519^^
	;;^DD(162.1,1,21,1,0)
	;;=This is the date FEE service receives the correct invoice
	;;^DD(162.1,1,21,2,0)
	;;=from the pharmacy provider.
	;;^DD(162.1,1,"DT")
	;;=2901104
	;;^DD(162.1,1.5,0)
	;;=DATE INVOICE ENTERED^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.1,1.5,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,1.5,21,1,0)
	;;=This is the date the data entry clerk begins to enter in
	;;^DD(162.1,1.5,21,2,0)
	;;=the invoice from the pharmacy provider.
	;;^DD(162.1,1.5,"DT")
	;;=2860129
	;;^DD(162.1,2,0)
	;;=DATA ENTRY CLERK^RP200'^VA(200,^0;3^Q
	;;^DD(162.1,2,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,2,21,1,0)
	;;=This is the Fee employee who enters the invoice into DHCP
	;;^DD(162.1,2,21,2,0)
	;;=from the pharmacy provider.
	;;^DD(162.1,2,"DT")
	;;=2900405
	;;^DD(162.1,3,0)
	;;=VENDOR^RP161.2^FBAAV(^0;4^Q
	;;^DD(162.1,3,1,0)
	;;=^.1
	;;^DD(162.1,3,1,1,0)
	;;=162.1^AN
	;;^DD(162.1,3,1,1,1)
	;;=S ^FBAA(162.1,"AN",$E(X,1,30),DA)=""
	;;^DD(162.1,3,1,1,2)
	;;=K ^FBAA(162.1,"AN",$E(X,1,30),DA)
	;;^DD(162.1,3,1,1,"%D",0)
	;;=^^2^2^2930622^^
	;;^DD(162.1,3,1,1,"%D",1,0)
	;;=Used to sort by vendor.
	;;^DD(162.1,3,1,1,"%D",2,0)
	;;= 
	;;^DD(162.1,3,1,1,"DT")
	;;=2920901
	;;^DD(162.1,3,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,3,21,1,0)
	;;=This is the name of the pharmacy provider whose invoice
	;;^DD(162.1,3,21,2,0)
	;;=is being entered for payment.
	;;^DD(162.1,3,"DT")
	;;=2920901
	;;^DD(162.1,3.1,0)
	;;=CHAIN STORE^CJ4^^ ; ^X ^DD(162.1,3.1,9.2) S Y(162.1,3.1,101)=$S($D(^FBAAV(D0,0)):^(0),1:"") S X=$P(Y(162.1,3.1,101),U,10) S D0=Y(162.1,3.1,80)
	;;^DD(162.1,3.1,9)
	;;=^
	;;^DD(162.1,3.1,9.01)
	;;=161.2^8;162.1^3
	;;^DD(162.1,3.1,9.1)
	;;=VENDOR:CHAIN
	;;^DD(162.1,3.1,9.2)
	;;=S Y(162.1,3.1,80)=$S($D(D0):D0,1:""),Y(162.1,3.1,1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:""),D0=$P(Y(162.1,3.1,1),U,4) S:'$D(^FBAAV(+D0,0)) D0=-1
	;;^DD(162.1,3.1,21,0)
	;;=^^2^2^2940926^^
	;;^DD(162.1,3.1,21,1,0)
	;;=This is a four digit number that is assigned by chain stores    
	;;^DD(162.1,3.1,21,2,0)
	;;=to differentiate one store in the chain from another.
	;;^DD(162.1,4,0)
	;;=PRESCRIPTION NUMBER^162.11^^RX;0
	;;^DD(162.1,4,21,0)
	;;=^^2^2^2941128^
	;;^DD(162.1,4,21,1,0)
	;;=This multiple allows the user to enter all prescriptions included
	;;^DD(162.1,4,21,2,0)
	;;=on a pharmacy invoice.
	;;^DD(162.1,5,0)
	;;=INVOICE STATUS^RS^1:PENDING PHARMACY DETERMINATION;2:PENDING MAS COMPLETION;3:PENDING PAYMENT PROCESS;4:COMPLETED;^0;5^Q

FBINI01N
FBINI01N	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.1,5,1,0)
	;;=^.1
	;;^DD(162.1,5,1,1,0)
	;;=162.1^AC
	;;^DD(162.1,5,1,1,1)
	;;=S ^FBAA(162.1,"AC",$E(X,1,30),DA)=""
	;;^DD(162.1,5,1,1,2)
	;;=K ^FBAA(162.1,"AC",$E(X,1,30),DA)
	;;^DD(162.1,5,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,5,21,1,0)
	;;=This field shows the current status of the invoice in the
	;;^DD(162.1,5,21,2,0)
	;;=payment process.
	;;^DD(162.1,5,"DT")
	;;=2860331
	;;^DD(162.1,6,0)
	;;=TOTAL AMOUNT CLAIMED^NJ9,2^^0;6^S:X["$" X=$P(X,"$",2) K:+X'=X&(X'?.N1"."2N)!(X>999999.99)!(X<.01) X
	;;^DD(162.1,6,3)
	;;=TYPE A NUMBER BETWEEN .01 AND 999999.99
	;;^DD(162.1,6,5,1,0)
	;;=162.11^3^1
	;;^DD(162.1,6,21,0)
	;;=^^2^2^2880301^^
	;;^DD(162.1,6,21,1,0)
	;;=This is the total dollar amount for each of the line
	;;^DD(162.1,6,21,2,0)
	;;=items in the invoice claimed by the pharmacy provider.
	;;^DD(162.1,7,0)
	;;=TOTAL AMOUNT PAID^NJ9,2X^^0;7^S:X["$" X=$P(X,"$",2) K:+X'=X&(X'?.N1"."2N)!(X>999999.99)!(X<0) X
	;;^DD(162.1,7,3)
	;;=TYPE A NUMBER BETWEEN .01 AND 999999.99
	;;^DD(162.1,7,5,1,0)
	;;=162.11^6.5^1
	;;^DD(162.1,7,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,7,21,1,0)
	;;=This is the total dollar amount for each of the line
	;;^DD(162.1,7,21,2,0)
	;;=items in the invoice paid to the pharmacy provider.
	;;^DD(162.1,7,"DT")
	;;=2900709
	;;^DD(162.1,8,0)
	;;=TOTAL LINE COUNT^NJ3,0^^0;9^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
	;;^DD(162.1,8,3)
	;;=TYPE A WHOLE NUMBER BETWEEN 0 AND 999
	;;^DD(162.1,8,5,1,0)
	;;=162.11^.01^2
	;;^DD(162.1,8,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,8,21,1,0)
	;;=This is the total number of line items contained
	;;^DD(162.1,8,21,2,0)
	;;=in the invoice.
	;;^DD(162.1,8,"DT")
	;;=2860129
	;;^DD(162.1,9,0)
	;;=GENERIC DRUG NAME STATUS^S^P:PENDING;^0;10^Q
	;;^DD(162.1,9,21,0)
	;;=^^3^3^2880617^^^^
	;;^DD(162.1,9,21,1,0)
	;;=This field tells you if pharmacy service has not made
	;;^DD(162.1,9,21,2,0)
	;;=a correlation between the drug entered by the FEE employee
	;;^DD(162.1,9,21,3,0)
	;;=and the Generic drug in the VA drug file.
	;;^DD(162.1,9,"DT")
	;;=2861230
	;;^DD(162.1,10,0)
	;;=BATCH ASSIGNED^*P161.7'^FBAA(161.7,^0;11^S DIC("S")="I $P(^(0),U,3)=""B5""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.1,10,12)
	;;=Allows selection of only 'Pharmacy' batch types.
	;;^DD(162.1,10,12.1)
	;;=S DIC("S")="I $P(^(0),U,3)=""B5"""
	;;^DD(162.1,10,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.1,10,21,1,0)
	;;=This is the batch number assigned by the FEE employee
	;;^DD(162.1,10,21,2,0)
	;;=to this invoice for payment.
	;;^DD(162.1,10,"DT")
	;;=2870325
	;;^DD(162.1,11,0)
	;;=PAID TO DATE^NJ8,2^^1;E1,245^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>99999.99)!(X<0) X
	;;^DD(162.1,11,3)
	;;=Type a Dollar Amount between 0 and 99999.99, 2 Decimal Digits
	;;^DD(162.1,11,21,0)
	;;=^^3^3^2941128^
	;;^DD(162.1,11,21,1,0)
	;;=This field is populated when payment information is passed back
	;;^DD(162.1,11,21,2,0)
	;;=to DHCP from the Financial Management System in Austin.
	;;^DD(162.1,11,21,3,0)
	;;=It is the date the check is issued.
	;;^DD(162.1,11,"DT")
	;;=2881103
	;;^DD(162.1,12,0)
	;;=VENDOR INVOICE DATE^RDX^^0;12^S %DT="E" D ^%DT S X=Y K:Y<1 X I $D(X) I X>$P(^FBAA(162.1,DA,0),"^",2) W !,*7,"Vendor Invoice Date cannot be later than the Date Correct Invoice Received" K X
	;;^DD(162.1,12,3)
	;;=Enter the date the vendor issued the invoice.
	;;^DD(162.1,12,21,0)
	;;=^^1^1^2940316^^
	;;^DD(162.1,12,21,1,0)
	;;=This is the date that the vendor issued the invoice.
	;;^DD(162.1,12,"DT")
	;;=2940509
	;;^DD(162.11,0)
	;;=PRESCRIPTION NUMBER SUB-FIELD^NL^35^42
	;;^DD(162.11,0,"DT")
	;;=2940926
	;;^DD(162.11,0,"IX","AB",162.11,.01)
	;;=
	;;^DD(162.11,0,"IX","AC",162.11,8)
	;;=
	;;^DD(162.11,0,"IX","AI",162.11,15)
	;;=
	;;^DD(162.11,0,"IX","AK",162.11,13)
	;;=
	;;^DD(162.11,0,"IX","AL",162.11,2)
	;;=
	;;^DD(162.11,0,"IX","AM",162.11,.01)
	;;=
	;;^DD(162.11,0,"IX","B",162.11,.01)
	;;=
	;;^DD(162.11,0,"IX","C",162.11,4)
	;;=
	;;^DD(162.11,0,"NM","PRESCRIPTION NUMBER")
	;;=
	;;^DD(162.11,0,"UP")
	;;=162.1
	;;^DD(162.11,.01,0)
	;;=PRESCRIPTION NUMBER^RFX^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<1)!($F(X," "))!(X?1P.E) X

FBINI01O
FBINI01O	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.11,.01,1,0)
	;;=^.1
	;;^DD(162.11,.01,1,1,0)
	;;=162.11^AB
	;;^DD(162.11,.01,1,1,1)
	;;=S ^FBAA(162.1,DA(1),"RX","AB",$E(X,1,30),DA)=""
	;;^DD(162.11,.01,1,1,2)
	;;=K ^FBAA(162.1,DA(1),"RX","AB",$E(X,1,30),DA)
	;;^DD(162.11,.01,1,2,0)
	;;=^^TRIGGER^162.1^8
	;;^DD(162.11,.01,1,2,1)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA S Y(0)=X I '$D(FBAAOUT) I X S X=DIV S Y(1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,9),X=X S DIU=X K Y S X=DIV S X=DIU+1 X ^DD(162.11,.01,1,2,1.4)
	;;^DD(162.11,.01,1,2,1.4)
	;;=S DIH=$S($D(^FBAA(162.1,DIV(0),0)):^(0),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,8,99))  S DIH=DIH_U" S %=$P(DIH,U,10,999),DIU=$P(DIH,U,9),^(0)=$P(DIH,U,1,8)_U_DIV_$S(%]"":U_%,1:""),DIH=162.1,DIG=8 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.11,.01,1,2,2)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA S Y(1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,9),X=X S DIU=X K Y S X=DIV S X=DIU-1 X ^DD(162.11,.01,1,2,2.4)
	;;^DD(162.11,.01,1,2,2.4)
	;;=S DIH=$S($D(^FBAA(162.1,DIV(0),0)):^(0),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,8,99))  S DIH=DIH_U" S %=$P(DIH,U,10,999),DIU=$P(DIH,U,9),^(0)=$P(DIH,U,1,8)_U_DIV_$S(%]"":U_%,1:""),DIH=162.1,DIG=8 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.11,.01,1,2,"CREATE CONDITION")
	;;=I '$D(FBAAOUT)
	;;^DD(162.11,.01,1,2,"CREATE VALUE")
	;;=TOTAL LINE COUNT+1
	;;^DD(162.11,.01,1,2,"DELETE VALUE")
	;;=TOTAL LINE COUNT-1
	;;^DD(162.11,.01,1,2,"DIC")
	;;=
	;;^DD(162.11,.01,1,2,"FIELD")
	;;=TOTAL LINE COUNT
	;;^DD(162.11,.01,1,3,0)
	;;=162.11^B
	;;^DD(162.11,.01,1,3,1)
	;;=S ^FBAA(162.1,DA(1),"RX","B",$E(X,1,30),DA)=""
	;;^DD(162.11,.01,1,3,2)
	;;=K ^FBAA(162.1,DA(1),"RX","B",$E(X,1,30),DA)
	;;^DD(162.11,.01,1,4,0)
	;;=162.11^AM^MUMPS
	;;^DD(162.11,.01,1,4,1)
	;;=I $D(^FBAA(162.1,DA(1),0)),$P(^(0),U,4)]"",$D(^FBAA(162.1,DA(1),"RX",DA,0)),$P(^(0),U,3)]"" S ^FBAA(162.1,"AL",$P(^FBAA(162.1,DA(1),0),U,4),$E(X,1,30),$P(^FBAA(162.1,DA(1),"RX",DA,0),U,3),DA(1),DA)=""
	;;^DD(162.11,.01,1,4,2)
	;;=I $D(^FBAA(162.1,DA(1),0)),$P(^(0),U,4)]"",$D(^FBAA(162.1,DA(1),"RX",DA,0)),$P(^(0),U,3)]"" K ^FBAA(162.1,"AL",$P(^FBAA(162.1,DA(1),0),U,4),$E(X,1,30),$P(^FBAA(162.1,DA(1),"RX",DA,0),U,3),DA(1),DA)
	;;^DD(162.11,.01,1,4,"%D",0)
	;;=^^2^2^2930514^
	;;^DD(162.11,.01,1,4,"%D",1,0)
	;;=Updates the AL X-Ref on field 2 if there is a change to the prescription
	;;^DD(162.11,.01,1,4,"%D",2,0)
	;;=number.
	;;^DD(162.11,.01,3)
	;;=ANSWER MUST BE 1-8 CHARACTERS IN LENGTH AND NOT CONTAIN BLANKS OR LEADING PUNCTUATION.
	;;^DD(162.11,.01,21,0)
	;;=^^2^2^2901107^^^
	;;^DD(162.11,.01,21,1,0)
	;;=This is a reference number assigned by a pharmacy provider
	;;^DD(162.11,.01,21,2,0)
	;;=for a prescription.
	;;^DD(162.11,.01,"DT")
	;;=2901107
	;;^DD(162.11,1,0)
	;;=DRUG NAME^RF^^0;2^K:$L(X)>45!($L(X)<3) X
	;;^DD(162.11,1,3)
	;;=ANSWER MUST BE 3-45 CHARACTERS IN LENGTH
	;;^DD(162.11,1,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,1,21,1,0)
	;;=This is the name of the medication that was dispensed to the
	;;^DD(162.11,1,21,2,0)
	;;=patient by the FEE provider.
	;;^DD(162.11,1.4,0)
	;;=MANUFACTURER^F^^2;2^K:$L(X)>30!($L(X)<3) X
	;;^DD(162.11,1.4,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(162.11,1.4,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,1.4,21,1,0)
	;;=This is the name of the company whose drug was
	;;^DD(162.11,1.4,21,2,0)
	;;=dispensed to the patient.
	;;^DD(162.11,1.4,"DT")
	;;=2870505
	;;^DD(162.11,1.5,0)
	;;=STRENGTH^F^^0;12^K:$L(X)>20!($L(X)<2) X
	;;^DD(162.11,1.5,3)
	;;=ANSWER MUST BE 2-20 CHARACTERS IN LENGTH
	;;^DD(162.11,1.5,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,1.5,21,1,0)
	;;=This field contains the labeled strength of the medication
	;;^DD(162.11,1.5,21,2,0)
	;;=dispensed to the patient.
	;;^DD(162.11,1.5,"DT")
	;;=2870225
	;;^DD(162.11,1.6,0)
	;;=QUANTITY^RF^^0;13^K:$L(X)>15!($L(X)<1) X
	;;^DD(162.11,1.6,3)
	;;=ANSWER MUST BE 1-15 CHARACTERS IN LENGTH
	;;^DD(162.11,1.6,21,0)
	;;=^^1^1^2880301^
	;;^DD(162.11,1.6,21,1,0)
	;;=This is the total number of units dispensed to the patient.
	;;^DD(162.11,1.6,"DT")
	;;=2870225
	;;^DD(162.11,2,0)
	;;=DATE PRESCRIPTION FILLED^RD^^0;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X

FBINI01P
FBINI01P	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.11,2,1,0)
	;;=^.1
	;;^DD(162.11,2,1,1,0)
	;;=162.11^AL^MUMPS
	;;^DD(162.11,2,1,1,1)
	;;=I $D(^FBAA(162.1,DA(1),0)),$P(^(0),U,4)]"" S ^FBAA(162.1,"AL",$P(^FBAA(162.1,DA(1),0),U,4),$P(^FBAA(162.1,DA(1),"RX",DA,0),U,1),$E(X,1,30),DA(1),DA)=""
	;;^DD(162.11,2,1,1,2)
	;;=I $D(^FBAA(162.1,DA(1),0)),$P(^(0),U,4)]"" K ^FBAA(162.1,"AL",$P(^FBAA(162.1,DA(1),0),U,4),$P(^FBAA(162.1,DA(1),"RX",DA,0),U,1),$E(X,1,30),DA(1),DA)
	;;^DD(162.11,2,1,1,"%D",0)
	;;=^^1^1^2930514^
	;;^DD(162.11,2,1,1,"%D",1,0)
	;;=X-Referenced to identify the Prescription number and date RX filled.
	;;^DD(162.11,2,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,2,21,1,0)
	;;=This is the date the provider has filled the prescription
	;;^DD(162.11,2,21,2,0)
	;;=for dispensing to the patient.
	;;^DD(162.11,2,"DT")
	;;=2880927
	;;^DD(162.11,3,0)
	;;=AMOUNT CLAIMED^RNJ7,2^^0;4^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999.99)!(X<.01) X
	;;^DD(162.11,3,1,0)
	;;=^.1
	;;^DD(162.11,3,1,1,0)
	;;=^^TRIGGER^162.1^6
	;;^DD(162.11,3,1,1,1)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA S Y(0)=X I '$D(FBAAOUT) I X S X=DIV S Y(1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X=DIV S X=DIU+DIV X ^DD(162.11,3,1,1,1.4)
	;;^DD(162.11,3,1,1,1.4)
	;;=S DIH=$S($D(^FBAA(162.1,DIV(0),0)):^(0),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,5,99))  S DIH=DIH_U" S %=$P(DIH,U,7,999),DIU=$P(DIH,U,6),^(0)=$P(DIH,U,1,5)_U_DIV_$S(%]"":U_%,1:""),DIH=162.1,DIG=6 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.11,3,1,1,2)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA S Y(0)=X I '$D(FBAAOUT) I X S X=DIV S Y(1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X=DIV S X=DIU-X X ^DD(162.11,3,1,1,2.4)
	;;^DD(162.11,3,1,1,2.4)
	;;=S DIH=$S($D(^FBAA(162.1,DIV(0),0)):^(0),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,5,99))  S DIH=DIH_U" S %=$P(DIH,U,7,999),DIU=$P(DIH,U,6),^(0)=$P(DIH,U,1,5)_U_DIV_$S(%]"":U_%,1:""),DIH=162.1,DIG=6 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.11,3,1,1,"CREATE CONDITION")
	;;=I '$D(FBAAOUT)
	;;^DD(162.11,3,1,1,"CREATE VALUE")
	;;=TOTAL AMOUNT CLAIMED+AMOUNT CLAIMED
	;;^DD(162.11,3,1,1,"DELETE CONDITION")
	;;=I '$D(FBAAOUT)
	;;^DD(162.11,3,1,1,"DELETE VALUE")
	;;=TOTAL AMOUNT CLAIMED-OLD AMOUNT CLAIMED
	;;^DD(162.11,3,1,1,"DIC")
	;;=
	;;^DD(162.11,3,1,1,"FIELD")
	;;=TOTAL AMOUNT CLAIMED
	;;^DD(162.11,3,3)
	;;=Type a Dollar Amount between .01 and 9999.99, 2 Decimal Digits
	;;^DD(162.11,3,21,0)
	;;=^^2^2^2880301^^
	;;^DD(162.11,3,21,1,0)
	;;=This is the dollar amount claimed by the FEE provider for
	;;^DD(162.11,3,21,2,0)
	;;=the prescription supplied to the patient.
	;;^DD(162.11,3,"DT")
	;;=2880216
	;;^DD(162.11,4,0)
	;;=PATIENT^RP161'^FBAAA(^0;5^Q
	;;^DD(162.11,4,1,0)
	;;=^.1
	;;^DD(162.11,4,1,1,0)
	;;=162.11^C
	;;^DD(162.11,4,1,1,1)
	;;=S ^FBAA(162.1,DA(1),"RX","C",$E(X,1,30),DA)=""
	;;^DD(162.11,4,1,1,2)
	;;=K ^FBAA(162.1,DA(1),"RX","C",$E(X,1,30),DA)
	;;^DD(162.11,4,1,2,0)
	;;=162.1^AD^MUMPS
	;;^DD(162.11,4,1,2,1)
	;;=S ^FBAA(162.1,"AD",$E(X,1,30),9999999-$P(^FBAA(162.1,DA(1),"RX",DA,0),U,3),DA(1),DA)=""
	;;^DD(162.11,4,1,2,2)
	;;=K ^FBAA(162.1,"AD",$E(X,1,30),9999999-$P(^FBAA(162.1,DA(1),"RX",DA,0),U,3),DA(1),DA)
	;;^DD(162.11,4,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,4,21,1,0)
	;;=This is the name of the patient whose prescription/s
	;;^DD(162.11,4,21,2,0)
	;;=are being submitted by the FEE provider for payment.
	;;^DD(162.11,4,"DT")
	;;=2880914
	;;^DD(162.11,5,0)
	;;=RED BOOK COST^NJ7,2^^0;6^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999.99)!(X<0) X
	;;^DD(162.11,5,3)
	;;=Type a Dollar Amount between 0 and 9999.99, 2 Decimal Digits
	;;^DD(162.11,5,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,5,21,1,0)
	;;=This is the cost of the generic drug dispensed
	;;^DD(162.11,5,21,2,0)
	;;=to the patient as listed in the 'RED BOOK'.
	;;^DD(162.11,5,"DT")
	;;=2930831
	;;^DD(162.11,6,0)
	;;=AMOUNT SUSPENDED^NJ7,2^^0;7^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999.99)!(X<0) X
	;;^DD(162.11,6,3)
	;;=Type a Dollar Amount between 0 and 9999.99, 2 Decimal Digits
	;;^DD(162.11,6,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,6,21,1,0)
	;;=This is the difference between the amount claimed by the

FBINI01Q
FBINI01Q	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.11,6,21,2,0)
	;;=FEE provider and the amount paid by the VA.
	;;^DD(162.11,6,"DT")
	;;=2880216
	;;^DD(162.11,6.5,0)
	;;=AMOUNT PAID^NJ7,2^^0;16^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999.99)!(X<0) X
	;;^DD(162.11,6.5,1,0)
	;;=^.1^^-1
	;;^DD(162.11,6.5,1,1,0)
	;;=^^TRIGGER^162.1^7
	;;^DD(162.11,6.5,1,1,1)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA S Y(0)=X I '$D(FBAAOUT) I X S X=DIV S Y(1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X=DIV S X=DIU+DIV X ^DD(162.11,6.5,1,1,1.4)
	;;^DD(162.11,6.5,1,1,1.4)
	;;=S DIH=$S($D(^FBAA(162.1,DIV(0),0)):^(0),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,6,99))  S DIH=DIH_U" S %=$P(DIH,U,8,999),DIU=$P(DIH,U,7),^(0)=$P(DIH,U,1,6)_U_DIV_$S(%]"":U_%,1:""),DIH=162.1,DIG=7 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.11,6.5,1,1,2)
	;;=K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA S Y(0)=X I '$D(FBAAOUT) I X S X=DIV S Y(1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X=DIV S X=DIU-X X ^DD(162.11,6.5,1,1,2.4)
	;;^DD(162.11,6.5,1,1,2.4)
	;;=S DIH=$S($D(^FBAA(162.1,DIV(0),0)):^(0),1:""),DIV=X X "F %=0:0 Q:$L($P(DIH,U,6,99))  S DIH=DIH_U" S %=$P(DIH,U,8,999),DIU=$P(DIH,U,7),^(0)=$P(DIH,U,1,6)_U_DIV_$S(%]"":U_%,1:""),DIH=162.1,DIG=7 D ^DICR:$N(^DD(DIH,DIG,1,0))>0
	;;^DD(162.11,6.5,1,1,"CREATE CONDITION")
	;;=I '$D(FBAAOUT)
	;;^DD(162.11,6.5,1,1,"CREATE VALUE")
	;;=TOTAL AMOUNT PAID+AMOUNT PAID
	;;^DD(162.11,6.5,1,1,"DELETE CONDITION")
	;;=I '$D(FBAAOUT)
	;;^DD(162.11,6.5,1,1,"DELETE VALUE")
	;;=TOTAL AMOUNT PAID-OLD AMOUNT PAID
	;;^DD(162.11,6.5,1,1,"DIC")
	;;=
	;;^DD(162.11,6.5,1,1,"FIELD")
	;;=TOTAL AMOUNT PAID
	;;^DD(162.11,6.5,3)
	;;=Type a Dollar Amount between 0 and 9999.99, 2 Decimal Digits
	;;^DD(162.11,6.5,21,0)
	;;=^^3^3^2930514^^
	;;^DD(162.11,6.5,21,1,0)
	;;=This field is either the amount claimed by the FEE provider
	;;^DD(162.11,6.5,21,2,0)
	;;=or the sum of RED BOOK cost and the professional dispensing fee
	;;^DD(162.11,6.5,21,3,0)
	;;=- whichever is less.
	;;^DD(162.11,6.5,"DT")
	;;=2881108
	;;^DD(162.11,7,0)
	;;=SUSPEND CODE^P161.27'^FBAA(161.27,^0;8^Q
	;;^DD(162.11,7,1,0)
	;;=^.1
	;;^DD(162.11,7,1,1,0)
	;;=162.1^AG^MUMPS
	;;^DD(162.11,7,1,1,1)
	;;=N FBPHZ S FBPHZ=^FBAA(162.1,DA(1),"RX",DA,0) S:$P(^FBAA(162.1,DA(1),0),U,8) ^FBAA(162.1,"AG",$P(^(0),U,4),$P(^(0),U,8),$P(FBPHZ,U,5),$E(X,1,30),DA(1),DA)=""
	;;^DD(162.11,7,1,1,2)
	;;=N FBPHZ S FBPHZ=^FBAA(162.1,DA(1),"RX",DA,0) K:$P(^FBAA(162.1,DA(1),0),U,8) ^FBAA(162.1,"AG",$P(^(0),U,4),$P(^(0),U,8),$P(FBPHZ,U,5),$E(X,1,30),DA(1),DA)
	;;^DD(162.11,7,1,1,"%D",0)
	;;=^^1^1^2930514^^
	;;^DD(162.11,7,1,1,"%D",1,0)
	;;=This cross-reference is used for date sort when printing suspense letters.
	;;^DD(162.11,7,1,1,"DT")
	;;=2930514
	;;^DD(162.11,7,3)
	;;=
	;;^DD(162.11,7,21,0)
	;;=^^4^4^2880301^
	;;^DD(162.11,7,21,1,0)
	;;=This is the explanation why the amount claimed by the FEE
	;;^DD(162.11,7,21,2,0)
	;;=provider is not the same as the amount paid.These codes
	;;^DD(162.11,7,21,3,0)
	;;=are listed in M-1,Part I,Chapter 18,Appendix A for
	;;^DD(162.11,7,21,4,0)
	;;=reference.
	;;^DD(162.11,7,"DT")
	;;=2930514
	;;^DD(162.11,8,0)
	;;=LINE ITEM STATUS^RS^1:PENDING PHARMACY DETERMINATION;2:PENDING MAS COMPLETION;3:PENDING PAYMENT PROCESS;4:COMPLETED;0:COMPLETED, WILL NOT PAY;^0;9^Q
	;;^DD(162.11,8,1,0)
	;;=^.1
	;;^DD(162.11,8,1,1,0)
	;;=162.11^AC
	;;^DD(162.11,8,1,1,1)
	;;=S ^FBAA(162.1,DA(1),"RX","AC",$E(X,1,30),DA)=""
	;;^DD(162.11,8,1,1,2)
	;;=K ^FBAA(162.1,DA(1),"RX","AC",$E(X,1,30),DA)
	;;^DD(162.11,8,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,8,21,1,0)
	;;=This tells the current status of review of this line item
	;;^DD(162.11,8,21,2,0)
	;;=within the invoice.
	;;^DD(162.11,8,"DT")
	;;=2860515
	;;^DD(162.11,8.5,0)
	;;=SUBSTITUTE GENERIC DRUG^S^Y:YES;^0;21^Q
	;;^DD(162.11,8.5,21,0)
	;;=^^2^2^2901105^^
	;;^DD(162.11,8.5,21,1,0)
	;;=This field shows if a generic drug was or could have been
	;;^DD(162.11,8.5,21,2,0)
	;;=dispensed to the patient.
	;;^DD(162.11,8.5,"DT")
	;;=2861209
	;;^DD(162.11,9,0)
	;;=GENERIC DRUG^RP50'^PSDRUG(^0;10^Q
	;;^DD(162.11,9,3)
	;;=

FBINI01R
FBINI01R	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.11,9,21,0)
	;;=^^2^2^2880617^^^
	;;^DD(162.11,9,21,1,0)
	;;=This is the name of the generic equivalent found in the
	;;^DD(162.11,9,21,2,0)
	;;=VA drug file that was dispensed to the patient.
	;;^DD(162.11,9,"DT")
	;;=2861209
	;;^DD(162.11,10,0)
	;;=PHARMACY DETERMINATION^S^1:APPROVED FOR PAYMENT;0:DISAPPROVED FOR PAYMENT;^0;11^Q
	;;^DD(162.11,10,21,0)
	;;=^^4^4^2880617^^^
	;;^DD(162.11,10,21,1,0)
	;;=This is a professional determination by the VA pharmacist
	;;^DD(162.11,10,21,2,0)
	;;=to determine if the medication dispensed was for
	;;^DD(162.11,10,21,3,0)
	;;=an authorized condition and whether or not the drug is on the
	;;^DD(162.11,10,21,4,0)
	;;='inactive drug list' .
	;;^DD(162.11,10,"DT")
	;;=2860327
	;;^DD(162.11,11,0)
	;;=PHARMACIST^P200'^VA(200,^0;14^Q
	;;^DD(162.11,11,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,11,21,1,0)
	;;=This is the name of the VA pharmacist who reviewed
	;;^DD(162.11,11,21,2,0)
	;;=the patient's prescriptions for appropriateness.
	;;^DD(162.11,11,"DT")
	;;=2900405
	;;^DD(162.11,12,0)
	;;=DATE OF DETERMINATION^D^^0;15^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.11,12,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,12,21,1,0)
	;;=This is the date the VA pharmacist reviewed the prescriptions
	;;^DD(162.11,12,21,2,0)
	;;=for appropriateness of payment.
	;;^DD(162.11,12,"DT")
	;;=2860210
	;;^DD(162.11,13,0)
	;;=BATCH NUMBER^RP161.7'^FBAA(161.7,^0;17^Q
	;;^DD(162.11,13,1,0)
	;;=^.1
	;;^DD(162.11,13,1,1,0)
	;;=162.1^AE
	;;^DD(162.11,13,1,1,1)
	;;=S ^FBAA(162.1,"AE",$E(X,1,30),DA(1),DA)=""
	;;^DD(162.11,13,1,1,2)
	;;=K ^FBAA(162.1,"AE",$E(X,1,30),DA(1),DA)
	;;^DD(162.11,13,1,2,0)
	;;=162.1^AJ^MUMPS
	;;^DD(162.11,13,1,2,1)
	;;=S ^FBAA(162.1,"AJ",$E(X,1,30),$P(^FBAA(162.1,DA(1),"RX",DA,0),"^",5),DA(1),DA)=""
	;;^DD(162.11,13,1,2,2)
	;;=K ^FBAA(162.1,"AJ",$E(X,1,30),$P(^FBAA(162.1,DA(1),"RX",DA,0),"^",5),DA(1),DA)
	;;^DD(162.11,13,1,3,0)
	;;=162.11^AK^MUMPS
	;;^DD(162.11,13,1,3,1)
	;;=I $D(^FBAA(162.1,DA(1),0)),$P(^(0),"^",4)]"" S ^FBAA(162.1,"AK",$P(^FBAA(162.1,DA(1),0),"^",4),9999999-$P(^FBAA(162.1,DA(1),"RX",DA,0),"^",3),$P(^(0),"^",5),DA(1),DA)=""
	;;^DD(162.11,13,1,3,2)
	;;=I $D(^FBAA(162.1,DA(1),0)),$P(^(0),"^",4)]"" K ^FBAA(162.1,"AK",$P(^FBAA(162.1,DA(1),0),"^",4),9999999-$P(^FBAA(162.1,DA(1),"RX",DA,0),"^",3),$P(^(0),"^",5),DA(1),DA)
	;;^DD(162.11,13,3)
	;;=
	;;^DD(162.11,13,21,0)
	;;=^^2^2^2880301^
	;;^DD(162.11,13,21,1,0)
	;;=This is the Batch number associated with this line item
	;;^DD(162.11,13,21,2,0)
	;;=for payment.
	;;^DD(162.11,13,"DT")
	;;=2880801
	;;^DD(162.11,14,0)
	;;=OBLIGATION NUMBER^RFX^^0;18^K:$L(X)>6!($L(X)<6) X D:$D(X) CKOB^FBAAUTL1
	;;^DD(162.11,14,3)
	;;=ANSWER MUST BE 6 CHARACTERS IN LENGTH
	;;^DD(162.11,14,21,0)
	;;=^^2^2^2880302^
	;;^DD(162.11,14,21,1,0)
	;;=This is the account from which the money is taken to pay
	;;^DD(162.11,14,21,2,0)
	;;=the line item.
	;;^DD(162.11,14,"DT")
	;;=2900412
	;;^DD(162.11,15,0)
	;;=DATE CERTIFIED FOR PAYMENT^D^^0;19^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.11,15,1,0)
	;;=^.1
	;;^DD(162.11,15,1,1,0)
	;;=162.1^AA^MUMPS
	;;^DD(162.11,15,1,1,1)
	;;=I $D(^FBAA(162.1,DA(1),"RX",DA,0)),$P(^(0),"^",5)]"" S FBZZ=$P(^(0),"^",5),^FBAA(162.1,"AA",$E(X,1,30),FBZZ,DA(1),DA)=""
	;;^DD(162.11,15,1,1,2)
	;;=I $D(^FBAA(162.1,DA(1),"RX",DA,0)),$P(^(0),"^",5)]"" S FBZZ=$P(^(0),"^",5) K ^FBAA(162.1,"AA",$E(X,1,30),FBZZ,DA(1),DA)
	;;^DD(162.11,15,1,2,0)
	;;=162.11^AI^MUMPS
	;;^DD(162.11,15,1,2,1)
	;;=I $D(^FBAA(162.1,DA(1),"RX",DA,0)),$P(^(0),U,17)]"",$D(^(2)),$P(^(2),U,5)]"" S ^FBAA(162.1,"AI",$P(^FBAA(162.1,DA(1),"RX",DA,2),U,5),9999999-$E(X,1,30),DA(1),DA)=""
	;;^DD(162.11,15,1,2,2)
	;;=I $D(^FBAA(162.1,DA(1),"RX",DA,0)),$P(^(0),U,17)]"",$D(^(2)),$P(^(2),U,5) K ^FBAA(162.1,"AI",$P(^FBAA(162.1,DA(1),"RX",DA,2),U,5),9999999-$E(X,1,30),DA(1),DA)
	;;^DD(162.11,15,21,0)
	;;=^^2^2^2880302^
	;;^DD(162.11,15,21,1,0)
	;;=This is the date that the line item has been approved,
	;;^DD(162.11,15,21,2,0)
	;;=by FEE, for payment.
	;;^DD(162.11,15,"DT")
	;;=2900618
	;;^DD(162.11,16,0)
	;;=PAYMENT TYPE CODE^S^V:VENDOR;R:REIMBURSEMENT;S:STATISTICAL;SR:STAT-REIMBURSEMENT;^0;20^Q

FBINI01S
FBINI01S	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.11,16,21,0)
	;;=^^3^3^2940926^^^^
	;;^DD(162.11,16,21,1,0)
	;;=This field represents what type of payment this line item
	;;^DD(162.11,16,21,2,0)
	;;=is. The choices are payment to a Vendor, patient Reimbursement or
	;;^DD(162.11,16,21,3,0)
	;;=paid 'out-of-system' for Statistical and stat reimbursement reporting.
	;;^DD(162.11,16,"DT")
	;;=2940926
	;;^DD(162.11,17,0)
	;;=REJECT STATUS^S^P:REJECTED, PENDING;C:REJECTED, COMPLETED;^FBREJ;1^Q
	;;^DD(162.11,17,1,0)
	;;=^.1^^0
	;;^DD(162.11,17,21,0)
	;;=^^2^2^2880617^^^
	;;^DD(162.11,17,21,1,0)
	;;=This field represents the status of the Rejected line item in
	;;^DD(162.11,17,21,2,0)
	;;=the invoice. It would either be Pending or Completed.
	;;^DD(162.11,17,"DT")
	;;=2860811
	;;^DD(162.11,18,0)
	;;=REJECT REASON^F^^FBREJ;2^K:$L(X)>40!($L(X)<2) X
	;;^DD(162.11,18,3)
	;;=ANSWER MUST BE 2-40 CHARACTERS IN LENGTH
	;;^DD(162.11,18,21,0)
	;;=^^2^2^2880302^
	;;^DD(162.11,18,21,1,0)
	;;=This is a free text field that allows comment on why Fee
	;;^DD(162.11,18,21,2,0)
	;;=rejected this line item payment.
	;;^DD(162.11,18,"DT")
	;;=2860811
	;;^DD(162.11,19,0)
	;;=OLD BATCH NUMBER^P161.7'^FBAA(161.7,^FBREJ;3^Q
	;;^DD(162.11,19,1,0)
	;;=^.1
	;;^DD(162.11,19,1,1,0)
	;;=162.1^AF
	;;^DD(162.11,19,1,1,1)
	;;=S ^FBAA(162.1,"AF",$E(X,1,30),DA(1),DA)=""
	;;^DD(162.11,19,1,1,2)
	;;=K ^FBAA(162.1,"AF",$E(X,1,30),DA(1),DA)
	;;^DD(162.11,19,21,0)
	;;=^^2^2^2880302^
	;;^DD(162.11,19,21,1,0)
	;;=When a line item was rejected then assigned to a new batch
	;;^DD(162.11,19,21,2,0)
	;;=this field stores the old batch number it belonged to.
	;;^DD(162.11,19,"DT")
	;;=2860811
	;;^DD(162.11,20,0)
	;;=SUSPENSION DESCRIPTION^162.12^^1;0
	;;^DD(162.11,20,21,0)
	;;=^^3^3^2880608^^
	;;^DD(162.11,20,21,1,0)
	;;=This field allows the entry of a description of why the 
	;;^DD(162.11,20,21,2,0)
	;;=amount claimed for a prescription is not the same as
	;;^DD(162.11,20,21,3,0)
	;;=the amount paid .
	;;^DD(162.11,21,0)
	;;=GENERIC DRUG ONLY STATUS^S^P:PENDING;^2;1^Q
	;;^DD(162.11,21,1,0)
	;;=^.1
	;;^DD(162.11,21,1,1,0)
	;;=162.1^AH
	;;^DD(162.11,21,1,1,1)
	;;=S ^FBAA(162.1,"AH",$E(X,1,30),DA(1),DA)=""
	;;^DD(162.11,21,1,1,2)
	;;=K ^FBAA(162.1,"AH",$E(X,1,30),DA(1),DA)
	;;^DD(162.11,21,21,0)
	;;=^^2^2^2880302^
	;;^DD(162.11,21,21,1,0)
	;;=This field reflects whether or not pharmacy has made the
	;;^DD(162.11,21,21,2,0)
	;;=match with the drug dispensed in the VA Drug File.
	;;^DD(162.11,21,"DT")
	;;=2861209
	;;^DD(162.11,22,0)
	;;=PHARMACY REMARKS^F^^0;22^K:$L(X)>30!($L(X)<3) X
	;;^DD(162.11,22,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(162.11,22,21,0)
	;;=^^2^2^2880302^
	;;^DD(162.11,22,21,1,0)
	;;=This allows pharmacy service to enter in remarks on their
	;;^DD(162.11,22,21,2,0)
	;;=decision for payment of the prescription.
	;;^DD(162.11,22,"DT")
	;;=2870225
	;;^DD(162.11,23,0)
	;;=VOID PAYMENT^S^V:VOID;^2;3^Q
	;;^DD(162.11,23,21,0)
	;;=^^2^2^2900613^^
	;;^DD(162.11,23,21,1,0)
	;;=This field shows if a Fee supervisor voided this payment
	;;^DD(162.11,23,21,2,0)
	;;=after the invoice had been completed.
	;;^DD(162.11,23,"DT")
	;;=2880331
	;;^DD(162.11,23.5,0)
	;;=REASON FOR VOIDED PAYMENT^F^^R;1^K:$L(X)>75!($L(X)<3) X
	;;^DD(162.11,23.5,3)
	;;=Answer must be 3-75 characters in length.
	;;^DD(162.11,23.5,21,0)
	;;=^^2^2^2920831^
	;;^DD(162.11,23.5,21,1,0)
	;;=This field is used by the supervisor to enter a reason why a payment
	;;^DD(162.11,23.5,21,2,0)
	;;=had to be voided.
	;;^DD(162.11,23.5,"DT")
	;;=2920831
	;;^DD(162.11,24,0)
	;;=SUPERVISOR^P200'^VA(200,^2;4^Q
	;;^DD(162.11,24,21,0)
	;;=^^1^1^2880331^
	;;^DD(162.11,24,21,1,0)
	;;=This field stores the supervisor who voided a payment.
	;;^DD(162.11,24,"DT")
	;;=2900405
	;;^DD(162.11,25,0)
	;;=PRIMARY SERVICE FACILITY^P4'^DIC(4,^2;5^Q
	;;^DD(162.11,25,21,0)
	;;=^^1^1^2941128^
	;;^DD(162.11,25,21,1,0)
	;;=The VA Hospital responsible for the veterans care.
	;;^DD(162.11,25,"DT")
	;;=2900419
	;;^DD(162.11,26,0)
	;;=ASSOCIATED 7078/583^V^^2;6^Q
	;;^DD(162.11,26,1,0)
	;;=^.1
	;;^DD(162.11,26,1,1,0)
	;;=162.1^AO
	;;^DD(162.11,26,1,1,1)
	;;=S ^FBAA(162.1,"AO",$E(X,1,30),DA(1),DA)=""

FBINI01T
FBINI01T	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.11,26,1,1,2)
	;;=K ^FBAA(162.1,"AO",$E(X,1,30),DA(1),DA)
	;;^DD(162.11,26,1,1,"DT")
	;;=2930111
	;;^DD(162.11,26,3)
	;;=
	;;^DD(162.11,26,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.11,26,21,1,0)
	;;=This field contains the related 7078 or 583 if an unauthorized claim.
	;;^DD(162.11,26,"DT")
	;;=2930111
	;;^DD(162.11,26,"V",0)
	;;=^.12P^2^2
	;;^DD(162.11,26,"V",1,0)
	;;=162.4^Select associated 7078^1^FB7078^n^n
	;;^DD(162.11,26,"V",2,0)
	;;=162.7^Select associated 583^2^FB583^^n
	;;^DD(162.11,27,0)
	;;=AUTHORIZATION POINTER^NJ7,0^^2;7^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.11,27,3)
	;;=Type a Number between 1 and 9999999, 0 Decimal Digits
	;;^DD(162.11,27,21,0)
	;;=^^4^4^2920603^
	;;^DD(162.11,27,21,1,0)
	;;=This field is set internally to the patient's authorization in the
	;;^DD(162.11,27,21,2,0)
	;;=Fee Basis Patient file. It is used to display only the authorization
	;;^DD(162.11,27,21,3,0)
	;;=associated with the prescription to the pharmacist during their
	;;^DD(162.11,27,21,4,0)
	;;=review.
	;;^DD(162.11,27,"DT")
	;;=2920603
	;;^DD(162.11,28,0)
	;;=DATE PAID^D^^2;8^S %DT="E" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.11,28,3)
	;;=This is the date of the check, as issued by the treasury.
	;;^DD(162.11,28,21,0)
	;;=^^4^4^2940316^^
	;;^DD(162.11,28,21,1,0)
	;;=This is the date of the check, as issued by the treasury.  This
	;;^DD(162.11,28,21,2,0)
	;;=information will be passed back to DHCP from the Financial Management
	;;^DD(162.11,28,21,3,0)
	;;=System (FMS) when the check is issued to the vendor.  This field will
	;;^DD(162.11,28,21,4,0)
	;;=use the check date beginning with version 3.5 of Fee Basis.
	;;^DD(162.11,28,"DT")
	;;=2940316
	;;^DD(162.11,29,0)
	;;=PROMPT PAY TYPE^S^1:MONEY MANAGED;^2;9^Q
	;;^DD(162.11,29,3)
	;;=Set equal to 1 if payment is subject to interest payments.
	;;^DD(162.11,29,21,0)
	;;=^^2^2^2940316^^
	;;^DD(162.11,29,21,1,0)
	;;=Field is set to 1 if the payment is subject to interest payments (prompt
	;;^DD(162.11,29,21,2,0)
	;;=pay).  Otherwise it remains blank.
	;;^DD(162.11,29,"DT")
	;;=2940318
	;;^DD(162.11,30,0)
	;;=CHECK NUMBER^F^^2;10^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<1)!'(X?.AN) X
	;;^DD(162.11,30,1,0)
	;;=^.1
	;;^DD(162.11,30,1,1,0)
	;;=162.1^ACK^MUMPS
	;;^DD(162.11,30,1,1,1)
	;;=S ^FBAA(162.1,"ACK",X,DA(1),DA)=""
	;;^DD(162.11,30,1,1,2)
	;;=K ^FBAA(162.1,"ACK",X,DA(1),DA)
	;;^DD(162.11,30,1,1,"%D",0)
	;;=^^2^2^2940425^^^
	;;^DD(162.11,30,1,1,"%D",1,0)
	;;=This cross-reference is used to find payment line items for a specific
	;;^DD(162.11,30,1,1,"%D",2,0)
	;;=check number.
	;;^DD(162.11,30,1,1,"DT")
	;;=2940425
	;;^DD(162.11,30,3)
	;;=Answer must be 1-8 characters in length.
	;;^DD(162.11,30,21,0)
	;;=^^3^3^2940316^^
	;;^DD(162.11,30,21,1,0)
	;;=Contains the check number as issued by the treasury.  This field is updated
	;;^DD(162.11,30,21,2,0)
	;;=after the check is issued, through a server option that records actual
	;;^DD(162.11,30,21,3,0)
	;;=payment information for each Fee payment made.
	;;^DD(162.11,30,"DT")
	;;=2940425
	;;^DD(162.11,31,0)
	;;=CANCELLATION DATE^D^^2;11^S %DT="E" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.11,31,3)
	;;=The date the check was cancelled by the treasury.
	;;^DD(162.11,31,21,0)
	;;=^^3^3^2940316^^
	;;^DD(162.11,31,21,1,0)
	;;=This is the date the treasury cancelled the check.  This field is updated
	;;^DD(162.11,31,21,2,0)
	;;=through a server option that records cancellations of previously recorded
	;;^DD(162.11,31,21,3,0)
	;;=payment data.
	;;^DD(162.11,31,"DT")
	;;=2940316
	;;^DD(162.11,32,0)
	;;=REASON CODE^P162.95'^FB(162.95,^2;12^Q
	;;^DD(162.11,32,3)
	;;=Enter the reason the check was cancelled.
	;;^DD(162.11,32,21,0)
	;;=^^3^3^2940316^^
	;;^DD(162.11,32,21,1,0)
	;;=This field contains a pointer to the Fee Basis Check Cancellation Reason
	;;^DD(162.11,32,21,2,0)
	;;=file.  It is populated through a server option that updates the payment
	;;^DD(162.11,32,21,3,0)
	;;=record when the treasury cancels a check that was previously payed.
	;;^DD(162.11,32,"DT")
	;;=2940316
	;;^DD(162.11,33,0)
	;;=CANCELLATION ACTIVITY^S^R:WILL BE REPLACED;C:WILL BE REISSUED;X:WILL NOT BE REISSUED;^2;13^Q

FBINI01U
FBINI01U	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.11,33,3)
	;;=Field will contain cancellation code if there has been cancellation activity on this payment.
	;;^DD(162.11,33,21,0)
	;;=^^7^7^2940316^^
	;;^DD(162.11,33,21,1,0)
	;;=This field is populated when a cancellation is recorded for the payment
	;;^DD(162.11,33,21,2,0)
	;;=referenced.  This field will always remain populated, to indicate that
	;;^DD(162.11,33,21,3,0)
	;;=there was cancellation activity on this payment at one time.  New payments
	;;^DD(162.11,33,21,4,0)
	;;=will replace the cancellation date and reason code fields, but the
	;;^DD(162.11,33,21,5,0)
	;;=cancellation activity flag will not be overwritten.  This flag will allow
	;;^DD(162.11,33,21,6,0)
	;;=the user to know that previous cancellation activity existed, and to
	;;^DD(162.11,33,21,7,0)
	;;=review the cancellation history output for further information.
	;;^DD(162.11,33,"DT")
	;;=2940426
	;;^DD(162.11,34,0)
	;;=DISBURSED AMOUNT^NJ9,2^^2;14^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.11,34,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.11,34,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.11,34,21,1,0)
	;;=This is the dollar amount paid by the treasury, less any interest paid.
	;;^DD(162.11,34,"DT")
	;;=2940421
	;;^DD(162.11,35,0)
	;;=INTEREST AMOUNT^NJ9,2^^2;15^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.11,35,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.11,35,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.11,35,21,1,0)
	;;=The interest amount paid on this line item by the treasury.
	;;^DD(162.11,35,"DT")
	;;=2940421
	;;^DD(162.12,0)
	;;=SUSPENSION DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(162.12,0,"NM","SUSPENSION DESCRIPTION")
	;;=
	;;^DD(162.12,0,"UP")
	;;=162.11
	;;^DD(162.12,.01,0)
	;;=SUSPENSION DESCRIPTION^W^^0;1^Q
	;;^DD(162.12,.01,21,0)
	;;=^^2^2^2880527^^
	;;^DD(162.12,.01,21,1,0)
	;;=This allows the entry of a description of why the amount claimed for
	;;^DD(162.12,.01,21,2,0)
	;;=the line item does not match the amount paid.
	;;^DD(162.12,.01,"DT")
	;;=2861023

FBINI01V
FBINI01V	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.2,0,"GL")
	;;=^FBAA(162.2,
	;;^DIC("B","FEE NOTIFICATION/REQUEST",162.2)
	;;=
	;;^DIC(162.2,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(162.2,"%D",1,0)
	;;=This file contains the information gathered when a site is notified
	;;^DIC(162.2,"%D",2,0)
	;;=that a veteran has been admitted to a civil hospital.
	;;^DIC(162.2,"%D",3,0)
	;;= 
	;;^DIC(162.2,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.2,0)
	;;=FIELD^^3.5^20
	;;^DD(162.2,0,"DT")
	;;=2940318
	;;^DD(162.2,0,"ID",1)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^FBAAV(+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(161.2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(162.2,0,"ID",3)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^DPT(+$P(^(0),U,4),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(162.2,0,"IX","AI",162.2,14)
	;;=
	;;^DD(162.2,0,"IX","AM",162.2,16)
	;;=
	;;^DD(162.2,0,"IX","B",162.2,.01)
	;;=
	;;^DD(162.2,0,"IX","C",162.2,1)
	;;=
	;;^DD(162.2,0,"IX","D",162.2,3)
	;;=
	;;^DD(162.2,0,"NM","FEE NOTIFICATION/REQUEST")
	;;=
	;;^DD(162.2,0,"PT",161.5,.01)
	;;=
	;;^DD(162.2,.01,0)
	;;=DATE/TIME^MRDX^^0;1^S %DT="ESTXR",%DT(0)="-NOW" D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(162.2,.01,1,0)
	;;=^.1
	;;^DD(162.2,.01,1,1,0)
	;;=162.2^B
	;;^DD(162.2,.01,1,1,1)
	;;=S ^FBAA(162.2,"B",$E(X,1,30),DA)=""
	;;^DD(162.2,.01,1,1,2)
	;;=K ^FBAA(162.2,"B",$E(X,1,30),DA)
	;;^DD(162.2,.01,3)
	;;=
	;;^DD(162.2,.01,21,0)
	;;=^^2^2^2890124^^
	;;^DD(162.2,.01,21,1,0)
	;;=Date and Time that the vendor notifies the COJ of this episode of
	;;^DD(162.2,.01,21,2,0)
	;;=hospitalization.
	;;^DD(162.2,.01,"DEL",.01,0)
	;;=I $P(^FBAA(162.2,DA,0),"^",17)]"" W !!,*7,"Cannot delete a Request because a 7078 entry has already been established!",!
	;;^DD(162.2,.01,"DT")
	;;=2901023
	;;^DD(162.2,1,0)
	;;=VENDOR^RP161.2^FBAAV(^0;2^Q
	;;^DD(162.2,1,1,0)
	;;=^.1
	;;^DD(162.2,1,1,1,0)
	;;=162.2^C
	;;^DD(162.2,1,1,1,1)
	;;=S ^FBAA(162.2,"C",$E(X,1,30),DA)=""
	;;^DD(162.2,1,1,1,2)
	;;=K ^FBAA(162.2,"C",$E(X,1,30),DA)
	;;^DD(162.2,1,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.2,1,21,1,0)
	;;=Name of the vendor who is notifying you of a veteran
	;;^DD(162.2,1,21,2,0)
	;;=request for care.
	;;^DD(162.2,2,0)
	;;=PERSON WHO CALLED^F^^0;3^K:$L(X)>30!($L(X)<3) X
	;;^DD(162.2,2,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(162.2,2,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.2,2,21,1,0)
	;;=This is a free text field that contains the name of
	;;^DD(162.2,2,21,2,0)
	;;=the person who is notifying you.
	;;^DD(162.2,3,0)
	;;=VETERAN^RP2'^DPT(^0;4^Q
	;;^DD(162.2,3,1,0)
	;;=^.1
	;;^DD(162.2,3,1,1,0)
	;;=162.2^D
	;;^DD(162.2,3,1,1,1)
	;;=S ^FBAA(162.2,"D",$E(X,1,30),DA)=""
	;;^DD(162.2,3,1,1,2)
	;;=K ^FBAA(162.2,"D",$E(X,1,30),DA)
	;;^DD(162.2,3,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.2,3,21,1,0)
	;;=This is name of the veteran who is requesting services
	;;^DD(162.2,3,21,2,0)
	;;=from the VA.
	;;^DD(162.2,3,"DT")
	;;=2890103
	;;^DD(162.2,3.5,0)
	;;=DATE/TIME OF ADMISSION^RDX^^0;19^S %DT="ESTXR",%DT(0)="-NOW" D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(162.2,3.5,21,0)
	;;=^^2^2^2930312^
	;;^DD(162.2,3.5,21,1,0)
	;;=This field contains the date and time of admission to the civil
	;;^DD(162.2,3.5,21,2,0)
	;;=hospital.
	;;^DD(162.2,3.5,"DT")
	;;=2930312
	;;^DD(162.2,4,0)
	;;=AUTHORIZED FROM DATE/TIME^RDX^^0;5^S %DT="ESTXR" D ^%DT K %DT(0) S X=Y D DATCK^FBCHREQ1 K:Y<1!$G(FBOUT) X,FBOUT
	;;^DD(162.2,4,1,0)
	;;=^.1^^0
	;;^DD(162.2,4,21,0)
	;;=^^3^3^2930519^^^^
	;;^DD(162.2,4,21,1,0)
	;;=This field contains the date and time that you begin
	;;^DD(162.2,4,21,2,0)
	;;=accepting responsibility for bills incurred if the veteran
	;;^DD(162.2,4,21,3,0)
	;;=is found to be legally and medically entitled.
	;;^DD(162.2,4,"DT")
	;;=2930312
	;;^DD(162.2,5,0)
	;;=ADMITTING DIAGNOSIS^F^^0;6^K:$L(X)>45!($L(X)<3) X
	;;^DD(162.2,5,3)
	;;=Answer must be 3-45 characters in length.
	;;^DD(162.2,5,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.2,5,21,1,0)
	;;=This is the admitting diagnosis of the veteran which
	;;^DD(162.2,5,21,2,0)
	;;=is usually obtained from the person who called.

FBINI01W
FBINI01W	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.2,6,0)
	;;=ATTENDING PHYSICIAN^F^^0;7^K:$L(X)>30!($L(X)<3) X
	;;^DD(162.2,6,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(162.2,6,21,0)
	;;=^^2^2^2930519^^^^
	;;^DD(162.2,6,21,1,0)
	;;=This field is a free text field. Please enter the name of the
	;;^DD(162.2,6,21,2,0)
	;;=attending physician for this patient.
	;;^DD(162.2,6.5,0)
	;;=ATTEN.PHYSICIAN PHONE NUMBER^F^^0;18^K:$L(X)>20!($L(X)<3) X
	;;^DD(162.2,6.5,3)
	;;=Answer must be 3-20 characters in length.
	;;^DD(162.2,6.5,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.2,6.5,21,1,0)
	;;=This field contains the phone number of the attending physician while
	;;^DD(162.2,6.5,21,2,0)
	;;=the patient was residing in the non-VA facility.
	;;^DD(162.2,6.5,"DT")
	;;=2900831
	;;^DD(162.2,7,0)
	;;=USER ENTERING NOTIFICATION^P200'^VA(200,^0;8^Q
	;;^DD(162.2,7,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.2,7,21,1,0)
	;;=This field contains the name of the user who entered the
	;;^DD(162.2,7,21,2,0)
	;;=notification.
	;;^DD(162.2,7,"DT")
	;;=2900405
	;;^DD(162.2,8,0)
	;;=LEGAL ENTITLEMENT^FaXO^^0;9^I $D(X) D YN^FBAAUTL3
	;;^DD(162.2,8,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(162.2,8,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(162.2,8,3)
	;;=Answer 'Yes' or '1' for YES or 'No' or '0' for NO.
	;;^DD(162.2,8,21,0)
	;;=^^3^3^2930507^^
	;;^DD(162.2,8,21,1,0)
	;;=If a veteran is determined not to be legally entitled
	;;^DD(162.2,8,21,2,0)
	;;=then s/he is assumed not medically entitled and the status
	;;^DD(162.2,8,21,3,0)
	;;=of the request becomes complete.
	;;^DD(162.2,8,"AUDIT")
	;;=e
	;;^DD(162.2,8,"DT")
	;;=2940318
	;;^DD(162.2,9,0)
	;;=DATE OF LEGAL DETERMINATION^D^^0;10^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.2,9,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.2,9,21,1,0)
	;;=This is the date that the legal entitlement was entered
	;;^DD(162.2,9,21,2,0)
	;;=into the computer.
	;;^DD(162.2,10,0)
	;;=USER ENTERING LEGAL DETERM.^P200'^VA(200,^0;11^Q
	;;^DD(162.2,10,21,0)
	;;=^^1^1^2890124^
	;;^DD(162.2,10,21,1,0)
	;;=The user who entered the legal entitlement.
	;;^DD(162.2,10,"DT")
	;;=2900405
	;;^DD(162.2,11,0)
	;;=MEDICAL ENTITLEMENT^FaXO^^0;12^I $D(X) D YN^FBAAUTL3
	;;^DD(162.2,11,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(162.2,11,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(162.2,11,3)
	;;=Answer 'Yes' or '1' for YES and 'No' or '0' for NO.
	;;^DD(162.2,11,21,0)
	;;=^^3^3^2890124^
	;;^DD(162.2,11,21,1,0)
	;;=Once the legal entitlement has been determined the
	;;^DD(162.2,11,21,2,0)
	;;=medical entitlement must be determined following
	;;^DD(162.2,11,21,3,0)
	;;=VA regulations.
	;;^DD(162.2,11,"AUDIT")
	;;=e
	;;^DD(162.2,11,"DT")
	;;=2940318
	;;^DD(162.2,12,0)
	;;=DATE OF MEDICAL DETERMINATION^D^^0;13^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.2,12,21,0)
	;;=^^1^1^2890124^
	;;^DD(162.2,12,21,1,0)
	;;=Date the user entered the Medical determination.
	;;^DD(162.2,13,0)
	;;=USER ENTERING MEDICAL DETERM.^P200'^VA(200,^0;14^Q
	;;^DD(162.2,13,21,0)
	;;=^^1^1^2890124^
	;;^DD(162.2,13,21,1,0)
	;;=Name of the user who entered the medical determination.
	;;^DD(162.2,13,"DT")
	;;=2900405
	;;^DD(162.2,14,0)
	;;=SUSPENSE CODE^P161.27'^FBAA(161.27,^0;16^Q
	;;^DD(162.2,14,1,0)
	;;=^.1
	;;^DD(162.2,14,1,1,0)
	;;=162.2^AI^MUMPS
	;;^DD(162.2,14,1,1,1)
	;;=S ^FBAA(162.2,"AI",$P(^FBAA(162.2,DA,0),U,2),$P(^(0),U,13),$P(^(0),U,4),$E(X,1,30),DA)=""
	;;^DD(162.2,14,1,1,2)
	;;=K ^FBAA(162.2,"AI",$P(^FBAA(162.2,DA,0),U,2),$P(^(0),U,13),$P(^(0),U,4),$E(X,1,30),DA)
	;;^DD(162.2,14,21,0)
	;;=^^2^2^2890131^
	;;^DD(162.2,14,21,1,0)
	;;=A pointer to the Fee Basis Suspension file, allows the user to
	;;^DD(162.2,14,21,2,0)
	;;=enter in a suspense reason for Legal or Medical denial.
	;;^DD(162.2,14,"DT")
	;;=2900529
	;;^DD(162.2,15,0)
	;;=DESCRIPTION OF SUSPENSION^162.215^^1;0
	;;^DD(162.2,15,21,0)
	;;=^^2^2^2890131^
	;;^DD(162.2,15,21,1,0)
	;;=If the user enters a '4' for 'other' in the suspense field
	;;^DD(162.2,15,21,2,0)
	;;=s/he can enter a word processing text for reason why.
	;;^DD(162.2,16,0)
	;;=ASSOCIATED 7078^P162.4'^FB7078(^0;17^Q
	;;^DD(162.2,16,1,0)
	;;=^.1
	;;^DD(162.2,16,1,1,0)
	;;=162.2^AM^MUMPS
	;;^DD(162.2,16,1,1,1)
	;;=S ^FBAA(162.2,"AM",$E(X,1,30),DA)=""

FBINI01X
FBINI01X	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.2,16,1,1,2)
	;;=K ^FBAA(162.2,"AM",$E(X,1,30),DA)
	;;^DD(162.2,16,1,1,"%D",0)
	;;=^^4^4^2920922^
	;;^DD(162.2,16,1,1,"%D",1,0)
	;;=This cross-reference is used to locate a notification that has a
	;;^DD(162.2,16,1,1,"%D",2,0)
	;;=7078 associated with it.  It is used in the 'Cancel a 7078' option
	;;^DD(162.2,16,1,1,"%D",3,0)
	;;=which allows the code to break the association with the request.
	;;^DD(162.2,16,1,1,"%D",4,0)
	;;=This usually is only used when a 7078 is entered in error.
	;;^DD(162.2,16,1,1,"DT")
	;;=2920922
	;;^DD(162.2,16,21,0)
	;;=^^3^3^2900530^
	;;^DD(162.2,16,21,1,0)
	;;=This field is set by the system when the user sets-up a 7078
	;;^DD(162.2,16,21,2,0)
	;;=for an associated request. This prevents multiple 7078's for
	;;^DD(162.2,16,21,3,0)
	;;=one request.
	;;^DD(162.2,16,"DT")
	;;=2920922
	;;^DD(162.2,100,0)
	;;=REQUEST STATUS^RS^1:PENDING ENTITLEMENT;2:PENDING PHYSICIAN CONTACT;3:COMPLETE;^0;15^Q
	;;^DD(162.2,100,1,0)
	;;=^.1^^0
	;;^DD(162.2,100,21,0)
	;;=^^5^5^2890124^
	;;^DD(162.2,100,21,1,0)
	;;=This status is determined based on the medical and legal
	;;^DD(162.2,100,21,2,0)
	;;=entitlement questions being answered. The status is 'Pending
	;;^DD(162.2,100,21,3,0)
	;;=Entitlement' until the legal entitlement is determined. The
	;;^DD(162.2,100,21,4,0)
	;;=status goes to 'Pending Physician Contact' until the Medical
	;;^DD(162.2,100,21,5,0)
	;;=determination has been entered.
	;;^DD(162.2,100,"DT")
	;;=2890120
	;;^DD(162.215,0)
	;;=DESCRIPTION OF SUSPENSION SUB-FIELD^^.01^1
	;;^DD(162.215,0,"NM","DESCRIPTION OF SUSPENSION")
	;;=
	;;^DD(162.215,0,"UP")
	;;=162.2
	;;^DD(162.215,.01,0)
	;;=DESCRIPTION OF SUSPENSION^WL^^0;1^Q
	;;^DD(162.215,.01,"DT")
	;;=2890131

FBINI01Y
FBINI01Y	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.3,0,"GL")
	;;=^FBAACNH(
	;;^DIC("B","FEE CNH ACTIVITY",162.3)
	;;=
	;;^DIC(162.3,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(162.3,"%D",1,0)
	;;=This file contains all bed movement activity associated with the
	;;^DIC(162.3,"%D",2,0)
	;;=community nursing home program.
	;;^DIC(162.3,"%D",3,0)
	;;= 
	;;^DIC(162.3,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.3,0)
	;;=FIELD^^9^11
	;;^DD(162.3,0,"ID",1)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^FBAAA(+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(161,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(162.3,0,"ID",2)
	;;=W "   ",@("$P($P($C(59)_$S($D(^DD(162.3,2,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,3)_"":"",2),$C(59),1)")
	;;^DD(162.3,0,"IX","AC",162.3,4)
	;;=
	;;^DD(162.3,0,"IX","AD",162.3,3)
	;;=
	;;^DD(162.3,0,"IX","AE",162.3,1)
	;;=
	;;^DD(162.3,0,"IX","AF",162.3,1)
	;;=
	;;^DD(162.3,0,"IX","AG",162.3,1)
	;;=
	;;^DD(162.3,0,"IX","AH",162.3,8)
	;;=
	;;^DD(162.3,0,"IX","B",162.3,.01)
	;;=
	;;^DD(162.3,0,"NM","FEE CNH ACTIVITY")
	;;=
	;;^DD(162.3,0,"PT",162.3,4)
	;;=
	;;^DD(162.3,.001,0)
	;;=NUMBER^NJ9,0^^ ^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.3,.001,3)
	;;=Type a Number between 1 and 999999999, 0 Decimal Digits
	;;^DD(162.3,.001,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.3,.001,21,1,0)
	;;=The internal entry number for each CNH Activity.
	;;^DD(162.3,.001,"DT")
	;;=2890411
	;;^DD(162.3,.01,0)
	;;=DATE/TIME^RDX^^0;1^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X I $D(X) D DATCK2^FBAAUTL1
	;;^DD(162.3,.01,1,0)
	;;=^.1
	;;^DD(162.3,.01,1,1,0)
	;;=162.3^B
	;;^DD(162.3,.01,1,1,1)
	;;=S ^FBAACNH("B",$E(X,1,30),DA)=""
	;;^DD(162.3,.01,1,1,2)
	;;=K ^FBAACNH("B",$E(X,1,30),DA)
	;;^DD(162.3,.01,3)
	;;=
	;;^DD(162.3,.01,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.3,.01,21,1,0)
	;;=The date and time of this activity (admission, discharge or transfer).
	;;^DD(162.3,.01,"DT")
	;;=2880830
	;;^DD(162.3,1,0)
	;;=VETERAN^RP161'^FBAAA(^0;2^Q
	;;^DD(162.3,1,1,0)
	;;=^.1
	;;^DD(162.3,1,1,1,0)
	;;=162.3^AE
	;;^DD(162.3,1,1,1,1)
	;;=S ^FBAACNH("AE",$E(X,1,30),DA)=""
	;;^DD(162.3,1,1,1,2)
	;;=K ^FBAACNH("AE",$E(X,1,30),DA)
	;;^DD(162.3,1,1,2,0)
	;;=162.3^AF^MUMPS
	;;^DD(162.3,1,1,2,1)
	;;=S ^FBAACNH("AF",$E(X,1,30),9999999.999999-$P(^FBAACNH(DA,0),"^",1),DA)=""
	;;^DD(162.3,1,1,2,2)
	;;=K ^FBAACNH("AF",$E(X,1,30),9999999.999999-$P(^FBAACNH(DA,0),"^",1),DA)
	;;^DD(162.3,1,1,3,0)
	;;=162.3^AG^MUMPS
	;;^DD(162.3,1,1,3,1)
	;;=I $P(^FBAACNH(DA,0),U,9)]"" S ^FBAACNH("AG",$E(X,1,30),$P(^FBAACNH(DA,0),U,9),$P(^FBAACNH(DA,0),U,1),DA)=""
	;;^DD(162.3,1,1,3,2)
	;;=I $P(^FBAACNH(DA,0),U,9)]"" K ^FBAACNH("AG",$E(X,1,30),$P(^FBAACNH(DA,0),U,9),$P(^FBAACNH(DA,0),U,1),DA)
	;;^DD(162.3,1,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.3,1,21,1,0)
	;;=The name of the Fee Basis patient associated with this activity.
	;;^DD(162.3,1,"DT")
	;;=2910111
	;;^DD(162.3,2,0)
	;;=ACTIVITY TYPE^S^A:ADMISSION;T:TRANSFER;D:DISCHARGE;^0;3^Q
	;;^DD(162.3,2,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.3,2,21,1,0)
	;;=Entry into this field indicates whether activity was an admission,
	;;^DD(162.3,2,21,2,0)
	;;=discharge or transfer.
	;;^DD(162.3,3,0)
	;;=ACTIVE ADMISSION^S^Y:YES;^0;4^Q
	;;^DD(162.3,3,1,0)
	;;=^.1
	;;^DD(162.3,3,1,1,0)
	;;=162.3^AD^MUMPS
	;;^DD(162.3,3,1,1,1)
	;;=S ^FBAACNH("AD",$P(^FBAACNH(DA,0),"^",2),DA)=""
	;;^DD(162.3,3,1,1,2)
	;;=K ^FBAACNH("AD",$P(^FBAACNH(DA,0),"^",2),DA)
	;;^DD(162.3,3,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.3,3,21,1,0)
	;;=An entry into this field will indicate that the activity at hand is part
	;;^DD(162.3,3,21,2,0)
	;;=of an "active" admission.
	;;^DD(162.3,4,0)
	;;=ASSOCIATED ADMISSION^R*P162.3'X^FBAACNH(^0;5^S DIC("S")="I $P(^(0),U,3)=""A""&($P(^(0),U,4)=""Y"")" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.3,4,1,0)
	;;=^.1
	;;^DD(162.3,4,1,1,0)
	;;=162.3^AC
	;;^DD(162.3,4,1,1,1)
	;;=S ^FBAACNH("AC",$E(X,1,30),DA)=""
	;;^DD(162.3,4,1,1,2)
	;;=K ^FBAACNH("AC",$E(X,1,30),DA)
	;;^DD(162.3,4,12)
	;;=Allows only activity which is Admission type and active.
	;;^DD(162.3,4,12.1)
	;;=S DIC("S")="I $P(^(0),U,3)=""A""&($P(^(0),U,4)=""Y"")"

FBINI01Z
FBINI01Z	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.3,4,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.3,4,21,1,0)
	;;=This field points all activities back to the admission that they are
	;;^DD(162.3,4,21,2,0)
	;;=associated with.  It allows for the ability to tie an admission with
	;;^DD(162.3,4,21,3,0)
	;;=all associated transfers and a final discharge if one exists.
	;;^DD(162.3,5,0)
	;;=ADMISSION TYPE^RS^1:AFTER RE-HOSPITALIZATION > 15 DAYS;2:TRANSFER FROM OTHER CNH;3:FROM ASIH < 15 DAYS;4:ALL OTHER;^0;6^Q
	;;^DD(162.3,5,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.3,5,21,1,0)
	;;=Field populated for activity types of 'admission' only.  Indicates the
	;;^DD(162.3,5,21,2,0)
	;;=type of admission for veteran.
	;;^DD(162.3,5,"DT")
	;;=2900910
	;;^DD(162.3,6,0)
	;;=TRANSFER TYPE^RSX^1:TO AUTHORIZED ABSENCE;2:TO UN-AUTHORIZED ABSENCE;3:TO ASIH;4:FROM AUTHORIZED ABSENCE;5:FROM UN-AUTHORIZED ABSENCE;6:FROM ASIH < 15 DAYS;^0;7^D DATCK3^FBAAUTL1
	;;^DD(162.3,6,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.3,6,21,1,0)
	;;=Field is populated for activity type of 'transfer' only.  Indicates the
	;;^DD(162.3,6,21,2,0)
	;;=type of transfer for each veteran.
	;;^DD(162.3,6,"DT")
	;;=2880831
	;;^DD(162.3,7,0)
	;;=DISCHARGE TYPE^S^1:REGULAR;2:DEATH;3:TRANSFER TO OTHER CNH;4:ASIH;5:DEATH WHILE ASIH;6:REGULAR - PRIVATE PAY;^0;8^Q
	;;^DD(162.3,7,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.3,7,21,1,0)
	;;=Field is populated for activity type of 'discharge' only.  Indicates
	;;^DD(162.3,7,21,2,0)
	;;=the type of discharge for each veteran.
	;;^DD(162.3,7,"DT")
	;;=2880824
	;;^DD(162.3,8,0)
	;;=NURSING HOME^*P161.2'^FBAAV(^0;9^S DIC("S")="I $P(^(0),U,9)=5" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.3,8,1,0)
	;;=^.1
	;;^DD(162.3,8,1,1,0)
	;;=162.3^AH
	;;^DD(162.3,8,1,1,1)
	;;=S ^FBAACNH("AH",$E(X,1,30),DA)=""
	;;^DD(162.3,8,1,1,2)
	;;=K ^FBAACNH("AH",$E(X,1,30),DA)
	;;^DD(162.3,8,1,1,"DT")
	;;=2930330
	;;^DD(162.3,8,12)
	;;=Only vendors with Participation Code of Community Nursing Home
	;;^DD(162.3,8,12.1)
	;;=S DIC("S")="I $P(^(0),U,9)=5"
	;;^DD(162.3,8,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.3,8,21,1,0)
	;;=Reference to the Vendor file, this field indicates the name of the
	;;^DD(162.3,8,21,2,0)
	;;=Nursing Home to which this activity is associated with (i.e. where the
	;;^DD(162.3,8,21,3,0)
	;;=veteran is residing).
	;;^DD(162.3,8,"DT")
	;;=2930330
	;;^DD(162.3,9,0)
	;;=ASSOCIATED AUTHORIZATION^NJ9,0^^0;10^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.3,9,3)
	;;=Type a Number between 1 and 999999999, 0 Decimal Digits
	;;^DD(162.3,9,21,0)
	;;=^^3^3^2930514^^
	;;^DD(162.3,9,21,1,0)
	;;=The internal entry number of the Authorization associated with the
	;;^DD(162.3,9,21,2,0)
	;;=admission entry.  Transfer and Discharge entries will not have this
	;;^DD(162.3,9,21,3,0)
	;;=data.
	;;^DD(162.3,9,"DT")
	;;=2900516

FBINI020
FBINI020	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.4,0,"GL")
	;;=^FB7078(
	;;^DIC("B","VA FORM 10-7078",162.4)
	;;=
	;;^DIC(162.4,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(162.4,"%D",1,0)
	;;=This file contains the information associated with a 7078
	;;^DIC(162.4,"%D",2,0)
	;;=authorization.
	;;^DIC(162.4,"%D",3,0)
	;;= 
	;;^DIC(162.4,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.4,0)
	;;=FIELD^^4.5^17
	;;^DD(162.4,0,"DT")
	;;=2930510
	;;^DD(162.4,0,"ID",1)
	;;=S DIY=$S($D(@(DIC_(+Y)_",""0"")")):$P(^("0"),U,2),1:"") D NAME^DICM2 W "   ",DINAME,@("$E("_DIC_"Y,0),0)")
	;;^DD(162.4,0,"ID",2)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^DPT(+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(162.4,0,"ID",9)
	;;=W "   ",@("$P($P($C(59)_$S($D(^DD(162.4,9,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,9)_"":"",2),$C(59),1)")
	;;^DD(162.4,0,"IX","AA",162.4,3)
	;;=
	;;^DD(162.4,0,"IX","AB",162.4,2)
	;;=
	;;^DD(162.4,0,"IX","AC",162.4,9)
	;;=
	;;^DD(162.4,0,"IX","AC1",162.4,2)
	;;=
	;;^DD(162.4,0,"IX","AD",162.4,4)
	;;=
	;;^DD(162.4,0,"IX","B",162.4,.01)
	;;=
	;;^DD(162.4,0,"IX","C",162.4,1)
	;;=
	;;^DD(162.4,0,"IX","D",162.4,2)
	;;=
	;;^DD(162.4,0,"NM","VA FORM 10-7078")
	;;=
	;;^DD(162.4,0,"PT",161.01,.055)
	;;=
	;;^DD(162.4,0,"PT",161.23,.03)
	;;=
	;;^DD(162.4,0,"PT",162.03,27)
	;;=
	;;^DD(162.4,0,"PT",162.11,26)
	;;=
	;;^DD(162.4,0,"PT",162.2,16)
	;;=
	;;^DD(162.4,0,"PT",162.5,4)
	;;=
	;;^DD(162.4,.01,0)
	;;=REFERENCE NUMBER^RFX^^0;1^K:$L(X)>11!($L(X)<7)!'(X?2AN4N1"."4N) X
	;;^DD(162.4,.01,1,0)
	;;=^.1
	;;^DD(162.4,.01,1,1,0)
	;;=162.4^B
	;;^DD(162.4,.01,1,1,1)
	;;=S ^FB7078("B",$E(X,1,30),DA)=""
	;;^DD(162.4,.01,1,1,2)
	;;=K ^FB7078("B",$E(X,1,30),DA)
	;;^DD(162.4,.01,3)
	;;=Answer must be 7-11 characters in length.
	;;^DD(162.4,.01,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.4,.01,21,1,0)
	;;=This number is internally generated and tracked by
	;;^DD(162.4,.01,21,2,0)
	;;=the IFCAP software.
	;;^DD(162.4,.01,"DT")
	;;=2890210
	;;^DD(162.4,.013,0)
	;;=USER WHO CANCELLED^P200'^VA(200,^0;13^Q
	;;^DD(162.4,.013,21,0)
	;;=^^1^1^2920922^
	;;^DD(162.4,.013,21,1,0)
	;;=This field contains the name of the supervisor who cancelled the 7078.
	;;^DD(162.4,.013,"DT")
	;;=2920922
	;;^DD(162.4,.014,0)
	;;=DATE CANCELLED^D^^0;14^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.4,.014,21,0)
	;;=^^1^1^2920922^
	;;^DD(162.4,.014,21,1,0)
	;;=This field contains the date that a supervisor cancelled the 7078.
	;;^DD(162.4,.014,"DT")
	;;=2920922
	;;^DD(162.4,.5,0)
	;;=FEE PROGRAM^RP161.8'^FBAA(161.8,^0;11^Q
	;;^DD(162.4,.5,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.4,.5,21,1,0)
	;;=This field contains the valid Fee Program associated with this 7078, as
	;;^DD(162.4,.5,21,2,0)
	;;=defined in the Fee Basis Program file (i.e. Outpatient Medical, Contract
	;;^DD(162.4,.5,21,3,0)
	;;=Hospital, Community Nursing Home).
	;;^DD(162.4,.5,"DT")
	;;=2890210
	;;^DD(162.4,1,0)
	;;=VENDOR^RVO^^0;2^Q
	;;^DD(162.4,1,1,0)
	;;=^.1
	;;^DD(162.4,1,1,1,0)
	;;=162.4^C
	;;^DD(162.4,1,1,1,1)
	;;=S ^FB7078("C",$E(X,1,30),DA)=""
	;;^DD(162.4,1,1,1,2)
	;;=K ^FB7078("C",$E(X,1,30),DA)
	;;^DD(162.4,1,2)
	;;=S Y(0)=Y S Y(0)=Y Q:Y']""  S Z0=$P(^FB7078(D0,0),U,2) I $P(Z0,";",2)="FBAAV(" S Y=$S($D(^FBAAV(+Z0,0)):$E($P(^(0),U),1,20)_" "_$P(^(0),U,2),1:"") K Z0
	;;^DD(162.4,1,2.1)
	;;=S Y(0)=Y Q:Y']""  S Z0=$P(^FB7078(D0,0),U,2) I $P(Z0,";",2)="FBAAV(" S Y=$S($D(^FBAAV(+Z0,0)):$E($P(^(0),U),1,20)_" "_$P(^(0),U,2),1:"") K Z0
	;;^DD(162.4,1,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.4,1,21,1,0)
	;;=This is the vendor that is entered in the request/
	;;^DD(162.4,1,21,2,0)
	;;=notification process.
	;;^DD(162.4,1,"DT")
	;;=2900904
	;;^DD(162.4,1,"V",0)
	;;=^.12P^1^1
	;;^DD(162.4,1,"V",1,0)
	;;=161.2^FEE VENDOR^1^FB^^y
	;;^DD(162.4,2,0)
	;;=VETERAN^RP2'^DPT(^0;3^Q
	;;^DD(162.4,2,1,0)
	;;=^.1
	;;^DD(162.4,2,1,1,0)
	;;=162.4^D
	;;^DD(162.4,2,1,1,1)
	;;=S ^FB7078("D",$E(X,1,30),DA)=""
	;;^DD(162.4,2,1,1,2)
	;;=K ^FB7078("D",$E(X,1,30),DA)
	;;^DD(162.4,2,1,2,0)
	;;=162.4^AB^MUMPS
	;;^DD(162.4,2,1,2,1)
	;;=S ^FB7078("AB",$E(X,1,30),$P($P(^FB7078(DA,0),"^",1),".",1),DA)=""

FBINI021
FBINI021	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.4,2,1,2,2)
	;;=K ^FB7078("AB",$E(X,1,30),$P($P(^FB7078(DA,0),"^",1),".",1),DA)
	;;^DD(162.4,2,1,2,"%D",0)
	;;=^^1^1^2930820^
	;;^DD(162.4,2,1,2,"%D",1,0)
	;;= 
	;;^DD(162.4,2,1,3,0)
	;;=162.4^AC1^MUMPS
	;;^DD(162.4,2,1,3,1)
	;;=S:$P(^FB7078(DA,0),U,9)]"" ^FB7078("AC",$E($P(^FB7078(DA,0),U,9),1,30),X,DA)=""
	;;^DD(162.4,2,1,3,2)
	;;=K:$P(^FB7078(DA,0),U,9)]"" ^FB7078("AC",$E($P(^FB7078(DA,0),U,9),1,30),X,DA)
	;;^DD(162.4,2,1,3,"%D",0)
	;;=^^1^1^2930820^
	;;^DD(162.4,2,1,3,"%D",1,0)
	;;=Cross reference by status and veteran.
	;;^DD(162.4,2,1,3,"DT")
	;;=2930820
	;;^DD(162.4,2,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.4,2,21,1,0)
	;;=This is the veteran that was entered in the request/
	;;^DD(162.4,2,21,2,0)
	;;=notification process.
	;;^DD(162.4,2,"DT")
	;;=2930820
	;;^DD(162.4,3,0)
	;;=AUTHORIZATION FROM DATE^D^^0;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.4,3,1,0)
	;;=^.1
	;;^DD(162.4,3,1,1,0)
	;;=162.4^AA^MUMPS
	;;^DD(162.4,3,1,1,1)
	;;=S ^FB7078("AA",$P(^FB7078(DA,0),U,11),$E(X,1,30),DA)=""
	;;^DD(162.4,3,1,1,2)
	;;=K ^FB7078("AA",$P(^FB7078(DA,0),U,11),$E(X,1,30),DA)
	;;^DD(162.4,3,21,0)
	;;=^^2^2^2930315^^
	;;^DD(162.4,3,21,1,0)
	;;=This is the date that is entered in the 'Authorization From Date'
	;;^DD(162.4,3,21,2,0)
	;;=field during the request/notification process.
	;;^DD(162.4,3,"DT")
	;;=2900501
	;;^DD(162.4,3.5,0)
	;;=DATE OF ADMISSION^D^^0;15^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.4,3.5,21,0)
	;;=^^2^2^2930315^
	;;^DD(162.4,3.5,21,1,0)
	;;=This is the date that is entered in the 'Date of Admission'
	;;^DD(162.4,3.5,21,2,0)
	;;=field during the request/notification process.
	;;^DD(162.4,3.5,"DT")
	;;=2930315
	;;^DD(162.4,4,0)
	;;=AUTHORIZATION TO DATE^RDX^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X),$P(^FB7078(DA,0),U,4)>X K X W !!,"To Date cannot be earlier than the From Date!",!
	;;^DD(162.4,4,1,0)
	;;=^.1
	;;^DD(162.4,4,1,1,0)
	;;=162.4^AD^MUMPS
	;;^DD(162.4,4,1,1,1)
	;;=S ^FB7078("AD",$P(^FB7078(DA,0),"^",11),$E(X,1,30),DA)=""
	;;^DD(162.4,4,1,1,2)
	;;=K ^FB7078("AD",$P(^FB7078(DA,0),"^",11),$E(X,1,30),DA)
	;;^DD(162.4,4,21,0)
	;;=^^2^2^2930315^^
	;;^DD(162.4,4,21,1,0)
	;;=This is the date you determine
	;;^DD(162.4,4,21,2,0)
	;;=the VA will no longer cover the veteran.
	;;^DD(162.4,4,"DT")
	;;=2930510
	;;^DD(162.4,4.5,0)
	;;=DATE OF DISCHARGE^DX^^0;16^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X),$P(^FB7078(DA,0),U,5)>X K X W !!,"Date of Discharge cannot be earlier than the Authorization To Date!",!
	;;^DD(162.4,4.5,21,0)
	;;=^^1^1^2930315^
	;;^DD(162.4,4.5,21,1,0)
	;;=This is the actual date of discharge.
	;;^DD(162.4,4.5,"DT")
	;;=2930315
	;;^DD(162.4,5,0)
	;;=AUTHORITY^RP43.4'^DIC(43.4,^0;6^Q
	;;^DD(162.4,5,21,0)
	;;=^^2^2^2890124^
	;;^DD(162.4,5,21,1,0)
	;;=This field is the Admitting Authority used for the
	;;^DD(162.4,5,21,2,0)
	;;=authorization.
	;;^DD(162.4,5,"DT")
	;;=2890130
	;;^DD(162.4,6,0)
	;;=ESTIMATED AMOUNT^RNJ9,2^^0;7^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<.01) X
	;;^DD(162.4,6,3)
	;;=Type a Dollar Amount between .01 and 999999, 2 Decimal Digits
	;;^DD(162.4,6,21,0)
	;;=^^3^3^2901104^^
	;;^DD(162.4,6,21,1,0)
	;;=This dollar amount is the best estimate of costs that
	;;^DD(162.4,6,21,2,0)
	;;=will be incurred by the veteran. This dollar amount is
	;;^DD(162.4,6,21,3,0)
	;;=passed to IFCAP.
	;;^DD(162.4,7,0)
	;;=AUTHORIZED SERVICES^162.47^^1;0
	;;^DD(162.4,7,21,0)
	;;=^^6^6^2900409^^
	;;^DD(162.4,7,21,1,0)
	;;=This is a word processing field that should contain a statement
	;;^DD(162.4,7,21,2,0)
	;;=similar to the following:
	;;^DD(162.4,7,21,3,0)
	;;= "Hospitalization and Professional care necessary until the
	;;^DD(162.4,7,21,4,0)
	;;=  patients condition is stabilized or improved enough to permit
	;;^DD(162.4,7,21,5,0)
	;;=  transfer without hazard to a VA or other Federal facility for
	;;^DD(162.4,7,21,6,0)
	;;=  continued treatment." or "Hospitalization and Professional Care".
	;;^DD(162.4,8,0)
	;;=USER ENTERING^P200'^VA(200,^0;8^Q
	;;^DD(162.4,8,21,0)
	;;=^^1^1^2890124^
	;;^DD(162.4,8,21,1,0)
	;;=This is the name of the user that enters the authorization.

FBINI022
FBINI022	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.4,8,"DT")
	;;=2900405
	;;^DD(162.4,9,0)
	;;=STATUS^S^C:COMPLETE;I:INCOMPLETE;DC:CANCELLED;^0;9^Q
	;;^DD(162.4,9,1,0)
	;;=^.1
	;;^DD(162.4,9,1,1,0)
	;;=162.4^AC^MUMPS
	;;^DD(162.4,9,1,1,1)
	;;=S:+$P(^FB7078(DA,0),U,3) ^FB7078("AC",$E(X,1,30),$P(^FB7078(DA,0),U,3),DA)=""
	;;^DD(162.4,9,1,1,2)
	;;=K:+$P(^FB7078(DA,0),U,3) ^FB7078("AC",$E(X,1,30),$P(^FB7078(DA,0),U,3),DA)
	;;^DD(162.4,9,1,1,"%D",0)
	;;=^^1^1^2930820^
	;;^DD(162.4,9,1,1,"%D",1,0)
	;;=Cross-reference by status and patient.
	;;^DD(162.4,9,1,1,"DT")
	;;=2930820
	;;^DD(162.4,9,21,0)
	;;=^^4^4^2890124^
	;;^DD(162.4,9,21,1,0)
	;;=The status of the 7078/authorization remains 'Incomplete'
	;;^DD(162.4,9,21,2,0)
	;;=until a discharge date is entered. At that time the status
	;;^DD(162.4,9,21,3,0)
	;;=is updated to complete and a corresponding authorization
	;;^DD(162.4,9,21,4,0)
	;;=is built in file 161.
	;;^DD(162.4,9,"DT")
	;;=2930820
	;;^DD(162.4,10,0)
	;;=DATE OF ISSUE^D^^0;10^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.4,10,21,0)
	;;=^^1^1^2890124^
	;;^DD(162.4,10,21,1,0)
	;;=This is the date the user sets up the 7078.
	;;^DD(162.4,12,0)
	;;=REASON FOR PENDING DISPOSITION^S^1:FOLLOW-UP/NOT STABLE;2:AWAITING DISCHARGE/TRANSFER;^0;12^Q
	;;^DD(162.4,12,21,0)
	;;=^^3^3^2890124^
	;;^DD(162.4,12,21,1,0)
	;;=If the status of a 7078 is Incomplete, that is the discharge
	;;^DD(162.4,12,21,2,0)
	;;=date has not been entered, the user is prompted with this field.
	;;^DD(162.4,12,21,3,0)
	;;=Once the status of the 7078 is Complete this field is set to null.
	;;^DD(162.4,12,"DT")
	;;=2890124
	;;^DD(162.47,0)
	;;=AUTHORIZED SERVICES SUB-FIELD^^.01^1
	;;^DD(162.47,0,"NM","AUTHORIZED SERVICES")
	;;=
	;;^DD(162.47,0,"UP")
	;;=162.4
	;;^DD(162.47,.01,0)
	;;=AUTHORIZED SERVICES^W^^0;1^Q
	;;^DD(162.47,.01,"DT")
	;;=2910117

FBINI023
FBINI023	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.5,0,"GL")
	;;=^FBAAI(
	;;^DIC("B","FEE BASIS INVOICE",162.5)
	;;=
	;;^DIC(162.5,"%D",0)
	;;=^^4^4^2940622^^^^
	;;^DIC(162.5,"%D",1,0)
	;;=This file contains the payment data associated with the inpatient
	;;^DIC(162.5,"%D",2,0)
	;;=hospital programs of FEE Basis.
	;;^DIC(162.5,"%D",3,0)
	;;= 
	;;^DIC(162.5,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.5,0)
	;;=FIELD^^53^50
	;;^DD(162.5,0,"DT")
	;;=2940426
	;;^DD(162.5,0,"IX","AA",162.5,5)
	;;=
	;;^DD(162.5,0,"IX","AC",162.5,20)
	;;=
	;;^DD(162.5,0,"IX","ACK",162.5,48)
	;;=
	;;^DD(162.5,0,"IX","AD",162.5,19)
	;;=
	;;^DD(162.5,0,"IX","AE",162.5,20)
	;;=
	;;^DD(162.5,0,"IX","AF",162.5,2)
	;;=
	;;^DD(162.5,0,"IX","AG",162.5,3)
	;;=
	;;^DD(162.5,0,"IX","AH",162.5,15)
	;;=
	;;^DD(162.5,0,"IX","AI",162.5,10)
	;;=
	;;^DD(162.5,0,"IX","AI1",162.5,1)
	;;=
	;;^DD(162.5,0,"IX","AJ",162.5,4)
	;;=
	;;^DD(162.5,0,"IX","AK",162.5,3)
	;;=
	;;^DD(162.5,0,"IX","AK1",162.5,2)
	;;=
	;;^DD(162.5,0,"IX","AP",162.5,19)
	;;=
	;;^DD(162.5,0,"IX","B",162.5,.01)
	;;=
	;;^DD(162.5,0,"IX","C",162.5,2)
	;;=
	;;^DD(162.5,0,"IX","D",162.5,3)
	;;=
	;;^DD(162.5,0,"NM","FEE BASIS INVOICE")
	;;=
	;;^DD(162.5,.01,0)
	;;=NUMBER^RNJ8,0X^^0;1^K:+X'=X!(X>99999999)!(X<1)!(X?.E1"."1N.N)!('$$CHKBI^FBAAUTL4(X)) X S:$D(X) DINUM=X
	;;^DD(162.5,.01,1,0)
	;;=^.1
	;;^DD(162.5,.01,1,1,0)
	;;=162.5^B
	;;^DD(162.5,.01,1,1,1)
	;;=S ^FBAAI("B",$E(X,1,30),DA)=""
	;;^DD(162.5,.01,1,1,2)
	;;=K ^FBAAI("B",$E(X,1,30),DA)
	;;^DD(162.5,.01,3)
	;;=Type a Number between 1 and 99999999, 0 Decimal Digits
	;;^DD(162.5,.01,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,.01,21,1,0)
	;;=This field contains the internal entry number for the Fee Basis Invoice.
	;;^DD(162.5,.01,"DT")
	;;=2940722
	;;^DD(162.5,1,0)
	;;=INVOICE DATE RECEIVED^RD^^0;2^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.5,1,1,0)
	;;=^.1
	;;^DD(162.5,1,1,1,0)
	;;=162.5^AI1^MUMPS
	;;^DD(162.5,1,1,1,1)
	;;=N FBCHZ S FBCHZ=^FBAAI(DA,0) S:$P(FBCHZ,U,11) ^FBAAI("AI",$P(FBCHZ,U,3),$E(X,1,30),$P(FBCHZ,U,4),$P(FBCHZ,U,11),DA)=""
	;;^DD(162.5,1,1,1,2)
	;;=N FBCHZ S FBCHZ=^FBAAI(DA,0) K:$P(FBCHZ,U,11) ^FBAAI("AI",$P(FBCHZ,U,3),$E(X,1,30),$P(FBCHZ,U,4),$P(FBCHZ,U,11),DA)
	;;^DD(162.5,1,1,1,"%D",0)
	;;=^^2^2^2930514^^
	;;^DD(162.5,1,1,1,"%D",1,0)
	;;=This cross-reference will update the 'AI' cross-reference on the suspense
	;;^DD(162.5,1,1,1,"%D",2,0)
	;;=code field if the date invoice received has been changed.
	;;^DD(162.5,1,1,1,"DT")
	;;=2930514
	;;^DD(162.5,1,21,0)
	;;=^^2^2^2930519^^^
	;;^DD(162.5,1,21,1,0)
	;;=This field contains the date the correct invoice was received.  It is
	;;^DD(162.5,1,21,2,0)
	;;=used by Austin for the calculation of any applicable interest payments.
	;;^DD(162.5,1,"DT")
	;;=2930514
	;;^DD(162.5,2,0)
	;;=VENDOR^RP161.2'^FBAAV(^0;3^Q
	;;^DD(162.5,2,1,0)
	;;=^.1
	;;^DD(162.5,2,1,1,0)
	;;=162.5^C
	;;^DD(162.5,2,1,1,1)
	;;=S ^FBAAI("C",$E(X,1,30),DA)=""
	;;^DD(162.5,2,1,1,2)
	;;=K ^FBAAI("C",$E(X,1,30),DA)
	;;^DD(162.5,2,1,2,0)
	;;=162.5^AF^MUMPS
	;;^DD(162.5,2,1,2,1)
	;;=S ^FBAAI("AF",$E(X,1,30),9999999.9999-$P(^FBAAI(DA,0),U,2),DA)=""
	;;^DD(162.5,2,1,2,2)
	;;=K ^FBAAI("AF",$E(X,1,30),9999999.9999-$P(^FBAAI(DA,0),U,2),DA)
	;;^DD(162.5,2,1,3,0)
	;;=162.5^AK1^MUMPS
	;;^DD(162.5,2,1,3,1)
	;;=S:$P(^FBAAI(DA,0),U,4) ^FBAAI("AK",$P(^(0),U,4),$E(X,1,30),DA)=""
	;;^DD(162.5,2,1,3,2)
	;;=K:$P(^FBAAI(DA,0),U,4) ^FBAAI("AK",$P(^(0),U,4),$E(X,1,30),DA)
	;;^DD(162.5,2,1,3,"%D",0)
	;;=^^2^2^2930514^^
	;;^DD(162.5,2,1,3,"%D",1,0)
	;;=Update cross-reference on veteran field, which includes vendor.
	;;^DD(162.5,2,1,3,"%D",2,0)
	;;=Used for displaying payment data by veteran.
	;;^DD(162.5,2,1,3,"DT")
	;;=2930303
	;;^DD(162.5,2,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,2,21,1,0)
	;;=Reference to the vendor file, this field contains the name of the vendor
	;;^DD(162.5,2,21,2,0)
	;;=associated with this invoice.
	;;^DD(162.5,2,"DT")
	;;=2930303
	;;^DD(162.5,3,0)
	;;=VETERAN^RP161'^FBAAA(^0;4^Q
	;;^DD(162.5,3,1,0)
	;;=^.1
	;;^DD(162.5,3,1,1,0)
	;;=162.5^D
	;;^DD(162.5,3,1,1,1)
	;;=S ^FBAAI("D",$E(X,1,30),DA)=""
	;;^DD(162.5,3,1,1,2)
	;;=K ^FBAAI("D",$E(X,1,30),DA)

FBINI024
FBINI024	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.5,3,1,2,0)
	;;=162.5^AG^MUMPS
	;;^DD(162.5,3,1,2,1)
	;;=S ^FBAAI("AG",$E(X,1,30),9999999.9999-$P(^FBAAI(DA,0),U,2),DA)=""
	;;^DD(162.5,3,1,2,2)
	;;=K ^FBAAI("AG",$E(X,1,30),9999999.9999-$P(^FBAAI(DA,0),U,2),DA)
	;;^DD(162.5,3,1,3,0)
	;;=162.5^AK^MUMPS
	;;^DD(162.5,3,1,3,1)
	;;=S:$P(^FBAAI(DA,0),U,3) ^FBAAI("AK",$E(X,1,30),$P(^FBAAI(DA,0),U,3),DA)=""
	;;^DD(162.5,3,1,3,2)
	;;=K:$P(^FBAAI(DA,0),U,3) ^FBAAI("AK",$E(X,1,30),$P(^(0),U,3),DA)
	;;^DD(162.5,3,1,3,"%D",0)
	;;=^^1^1^2930514^^^^
	;;^DD(162.5,3,1,3,"%D",1,0)
	;;=Cross-reference on veteran field to  include vendor.
	;;^DD(162.5,3,1,3,"DT")
	;;=2930303
	;;^DD(162.5,3,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,3,21,1,0)
	;;=Reference the Fee Basis Patient file, this field contains the name of
	;;^DD(162.5,3,21,2,0)
	;;=the veteran for which this invoice is established.
	;;^DD(162.5,3,"DT")
	;;=2930303
	;;^DD(162.5,4,0)
	;;=ASSOCIATED 7078/583^V^^0;5^Q
	;;^DD(162.5,4,1,0)
	;;=^.1
	;;^DD(162.5,4,1,1,0)
	;;=162.5^AJ^MUMPS
	;;^DD(162.5,4,1,1,1)
	;;=S ^FBAAI("E",$E(X,1,30),DA)=""
	;;^DD(162.5,4,1,1,2)
	;;=K ^FBAAI("E",$E(X,1,30),DA)
	;;^DD(162.5,4,3)
	;;=
	;;^DD(162.5,4,21,0)
	;;=^^2^2^2930514^^
	;;^DD(162.5,4,21,1,0)
	;;=This field contains the pointer to the appropriate 7078 or
	;;^DD(162.5,4,21,2,0)
	;;=583 file.
	;;^DD(162.5,4,"DT")
	;;=2901011
	;;^DD(162.5,4,"V",0)
	;;=^.12P^2^2
	;;^DD(162.5,4,"V",1,0)
	;;=162.4^Select associated 7078^1^AUTH^^n
	;;^DD(162.5,4,"V",2,0)
	;;=162.7^Select associated 583^2^UNAUTH^^n
	;;^DD(162.5,5,0)
	;;=TREATMENT FROM DATE^RD^^0;6^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.5,5,1,0)
	;;=^.1
	;;^DD(162.5,5,1,1,0)
	;;=162.5^AA^MUMPS
	;;^DD(162.5,5,1,1,1)
	;;=S ^FBAAI("AA",$P(^FBAAI(DA,0),U,3),$P(^(0),U,4),$E($P(X,"."),1,5),DA)=""
	;;^DD(162.5,5,1,1,2)
	;;=K ^FBAAI("AA",$P(^FBAAI(DA,0),U,3),$P(^(0),U,4),$E($P(X,"."),1,5),DA)
	;;^DD(162.5,5,21,0)
	;;=^^2^2^2930514^^
	;;^DD(162.5,5,21,1,0)
	;;=Information in this field indicates the starting date for this invoice.
	;;^DD(162.5,5,21,2,0)
	;;=(i.e. the starting treatment date for which this billing covers).
	;;^DD(162.5,5,"DT")
	;;=2890113
	;;^DD(162.5,6,0)
	;;=TREATMENT TO DATE^RDX^^0;7^S %DT="ETX" D ^%DT S X=Y K:Y<1 X I $D(X),$P(^FBAAI(DA,0),U,6)>X K X W !,*7,"To Date cannot be before From date!",!
	;;^DD(162.5,6,3)
	;;=
	;;^DD(162.5,6,21,0)
	;;=^^2^2^2930519^^
	;;^DD(162.5,6,21,1,0)
	;;=Information in this field indicates the ending date for this invoice.
	;;^DD(162.5,6,21,2,0)
	;;=(i.e. the ending treatment date this billing covers).
	;;^DD(162.5,6,"DT")
	;;=2910129
	;;^DD(162.5,6.5,0)
	;;=DISCHARGE TYPE CODE^P162.6'^FBAA(162.6,^0;21^Q
	;;^DD(162.5,6.5,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,6.5,21,1,0)
	;;=This field contains the code pertaining to the type of discharge
	;;^DD(162.5,6.5,21,2,0)
	;;=associated with this invoice.
	;;^DD(162.5,6.5,"DT")
	;;=2900416
	;;^DD(162.5,6.6,0)
	;;=BILLED CHARGES^RNJ9,2^^0;22^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999.99)!(X<.01) X
	;;^DD(162.5,6.6,3)
	;;=Type a Dollar Amount between .01 and 999999.99, 2 Decimal Digits
	;;^DD(162.5,6.6,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,6.6,21,1,0)
	;;=This field contains cost information on the amount the VA was initially
	;;^DD(162.5,6.6,21,2,0)
	;;=billed by the vendor for an inpatient stay.
	;;^DD(162.5,6.6,"DT")
	;;=2900416
	;;^DD(162.5,6.7,0)
	;;=PAYMENT BY MEDICARE/FED AGENCY^RFXO^^0;23^I $D(X) D YN^FBAAUTL3
	;;^DD(162.5,6.7,2)
	;;=S Y(0)=Y D OUTYN^FBAAUTL3
	;;^DD(162.5,6.7,2.1)
	;;=D OUTYN^FBAAUTL3
	;;^DD(162.5,6.7,3)
	;;=Answer 'Yes' or '1' for YES and 'No' or '0' for NO.
	;;^DD(162.5,6.7,21,0)
	;;=^^3^3^2940906^^^^
	;;^DD(162.5,6.7,21,1,0)
	;;=Answer 'Yes' if Medicare or some other
	;;^DD(162.5,6.7,21,2,0)
	;;=federal agency has paid some of the
	;;^DD(162.5,6.7,21,3,0)
	;;=bill for contract hospital.
	;;^DD(162.5,6.7,"DT")
	;;=2940318
	;;^DD(162.5,7,0)
	;;=AMOUNT CLAIMED^RNJ9,2X^^0;8^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<.01) X I $D(X),$P(^FBAAI(DA,0),U,12)=6,$P(^(0),U,22)<X K X W !,*7,"Amount Claimed cannot be greater than the 'BILLED CHARGES'.",!
	;;^DD(162.5,7,3)
	;;=Type a Dollar Amount between .01 and 999999, 2 Decimal Digits

FBINI025
FBINI025	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.5,7,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.5,7,21,1,0)
	;;=The portion of the billed charges that the vendor is requesting payment
	;;^DD(162.5,7,21,2,0)
	;;=for from the VA.  Usually the billed charges and the amount claimed
	;;^DD(162.5,7,21,3,0)
	;;=will be the same.
	;;^DD(162.5,7,"DT")
	;;=2910204
	;;^DD(162.5,8,0)
	;;=AMOUNT PAID^RNJ9,2X^^0;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<.01) X I $D(X),$P(^FBAAI(DA,0),U,12)'=6,$P(^FBAAI(DA,0),U,8)<X W !,*7,"Amount Paid cannot be greater than Amount Claimed !",! K X
	;;^DD(162.5,8,1,0)
	;;=^.1^^0
	;;^DD(162.5,8,3)
	;;=Type a Dollar Amount between .01 and 999999, 2 Decimal Digits
	;;^DD(162.5,8,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,8,21,1,0)
	;;=The dollar amount that was actually paid to the vendor for the service
	;;^DD(162.5,8,21,2,0)
	;;=provided.
	;;^DD(162.5,8,"DT")
	;;=2910201
	;;^DD(162.5,9,0)
	;;=AMOUNT SUSPENDED^NJ9,2^^0;10^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.5,9,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.5,9,21,0)
	;;=^^2^2^2950110^^^
	;;^DD(162.5,9,21,1,0)
	;;=This field allows the user to enter in a dollar amount which cannot exceed
	;;^DD(162.5,9,21,2,0)
	;;=$999,999 dollars.
	;;^DD(162.5,9,"DT")
	;;=2900614
	;;^DD(162.5,10,0)
	;;=SUSPEND CODE^P161.27'^FBAA(161.27,^0;11^Q
	;;^DD(162.5,10,1,0)
	;;=^.1
	;;^DD(162.5,10,1,1,0)
	;;=162.5^AI^MUMPS
	;;^DD(162.5,10,1,1,1)
	;;=S:$P(^FBAAI(DA,0),U,2) ^FBAAI("AI",$P(^FBAAI(DA,0),U,3),$P(^(0),U,2),$P(^FBAAI(DA,0),U,4),$E(X,1,30),DA)=""
	;;^DD(162.5,10,1,1,2)
	;;=K:$P(^FBAAI(DA,0),U,3) ^FBAAI("AI",$P(^FBAAI(DA,0),U,3),$P(^(0),U,3),$P(^FBAAI(DA,0),U,4),$E(X,1,30),DA)
	;;^DD(162.5,10,1,1,"%D",0)
	;;=^^2^2^2930514^
	;;^DD(162.5,10,1,1,"%D",1,0)
	;;=This cross-reference is used for printing suspense letters for a date
	;;^DD(162.5,10,1,1,"%D",2,0)
	;;=range.
	;;^DD(162.5,10,1,1,"DT")
	;;=2930514
	;;^DD(162.5,10,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,10,21,1,0)
	;;=If an amount was suspended, the user is requested to indicate the reason
	;;^DD(162.5,10,21,2,0)
	;;=for suspense from the selection of suspense codes.
	;;^DD(162.5,10,"DT")
	;;=2930514
	;;^DD(162.5,11,0)
	;;=FEE PROGRAM^RP161.8'^FBAA(161.8,^0;12^Q
	;;^DD(162.5,11,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.5,11,21,1,0)
	;;=This field contains the valid Fee Program associated with this Invoice
	;;^DD(162.5,11,21,2,0)
	;;=as contained in the Fee Basis Program file (i.e. Contract Hospital or
	;;^DD(162.5,11,21,3,0)
	;;=Community Nursing Home for an inpatient stay).
	;;^DD(162.5,12,0)
	;;=PAYMENT TYPE CODE^S^R:REIMBURSEMENT;V:VENDOR;S:STATISTICAL;SR:STAT-REIMBURSEMENT;^0;13^Q
	;;^DD(162.5,12,21,0)
	;;=^^8^8^2940926^^^
	;;^DD(162.5,12,21,1,0)
	;;=An entry of 'R' will indicate the invoice is for a reimbursement to the
	;;^DD(162.5,12,21,2,0)
	;;=veteran for services that he/she has already paid.
	;;^DD(162.5,12,21,3,0)
	;;=An entry of 'V' will indicate the invoice is for a payment directly to
	;;^DD(162.5,12,21,4,0)
	;;=a vendor.
	;;^DD(162.5,12,21,5,0)
	;;=An entry of 'S' will indicate the invoice was paid "out of system"
	;;^DD(162.5,12,21,6,0)
	;;=to a vendor and allows the update of the payment history files.
	;;^DD(162.5,12,21,7,0)
	;;=An entry of 'SR' will indicate a statistical reimbursement to a
	;;^DD(162.5,12,21,8,0)
	;;=party other than the vendor.
	;;^DD(162.5,13,0)
	;;=REJECT STATUS^S^P:REJECTED, PENDING ACTION;C:REJECTED, COMPLETED;^FBREJ;1^Q
	;;^DD(162.5,13,21,0)
	;;=^^4^4^2930514^
	;;^DD(162.5,13,21,1,0)
	;;=An entry in this field will indicate that the invoice has been rejected.
	;;^DD(162.5,13,21,2,0)
	;;=An entry of 'P' will indicate the invoice has been rejected
	;;^DD(162.5,13,21,3,0)
	;;=and it is awaiting action.  An entry of 'C' will indicate the invoice
	;;^DD(162.5,13,21,4,0)
	;;=has been rejected and action on it has been completed.
	;;^DD(162.5,14,0)
	;;=REJECT REASON^F^^FBREJ;2^K:$L(X)>40!($L(X)<2) X
	;;^DD(162.5,14,3)
	;;=Answer must be 2-40 characters in length.
	;;^DD(162.5,14,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,14,21,1,0)
	;;=If the invoice has a status of rejected, the user will be prompted to

FBINI026
FBINI026	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.5,14,21,2,0)
	;;=enter a reason that the reject has occurred.
	;;^DD(162.5,15,0)
	;;=OLD BATCH NUMBER^P161.7'^FBAA(161.7,^FBREJ;3^Q
	;;^DD(162.5,15,1,0)
	;;=^.1
	;;^DD(162.5,15,1,1,0)
	;;=162.5^AH^MUMPS
	;;^DD(162.5,15,1,1,1)
	;;=S ^FBAAI("AH",$E(X,1,30),DA)=""
	;;^DD(162.5,15,1,1,2)
	;;=K ^FBAAI("AH",$E(X,1,30),DA)
	;;^DD(162.5,15,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.5,15,21,1,0)
	;;=This field is populated only if there is a reject pending.  It will contain
	;;^DD(162.5,15,21,2,0)
	;;=the batch number of the old batch associated with the invoice.  This is
	;;^DD(162.5,15,21,3,0)
	;;=to provide a link back to that batch if the user deletes the reject.
	;;^DD(162.5,15,"DT")
	;;=2890131
	;;^DD(162.5,16,0)
	;;=VOID PAYMENT^S^VP:VOIDED PAYMENT;^0;14^Q
	;;^DD(162.5,16,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,16,21,1,0)
	;;=Entry into this field is made when the user indicates the payment must
	;;^DD(162.5,16,21,2,0)
	;;=be voided.
	;;^DD(162.5,16.5,0)
	;;=REASON FOR VOIDED PAYMENT^F^^R;1^K:$L(X)>75!($L(X)<3) X
	;;^DD(162.5,16.5,3)
	;;=Answer must be 3-75 characters in length.
	;;^DD(162.5,16.5,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,16.5,21,1,0)
	;;=This field is only populated if the Void Payment field is flagged for a
	;;^DD(162.5,16.5,21,2,0)
	;;=void.  The user is prompted to enter a reason the payment was voided.
	;;^DD(162.5,16.5,"DT")
	;;=2930304
	;;^DD(162.5,17,0)
	;;=SUPERVISOR WHO VOIDED^P200'^VA(200,^0;15^Q
	;;^DD(162.5,17,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.5,17,21,1,0)
	;;=This field is only populated when the Void Payment field is flagged for
	;;^DD(162.5,17,21,2,0)
	;;=a void.  The field is stuffed with the user who voided the payment (and
	;;^DD(162.5,17,21,3,0)
	;;=in all instances, the user must be a supervisor).
	;;^DD(162.5,17,"DT")
	;;=2900405
	;;^DD(162.5,18,0)
	;;=DESCRIPTION OF SUSPENSION^162.518^^1;0
	;;^DD(162.5,18,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.5,18,21,1,0)
	;;=This field is only populated when there is a dollar amount that has been
	;;^DD(162.5,18,21,2,0)
	;;=suspended.  The user is prompted to enter a description of the suspension
	;;^DD(162.5,18,21,3,0)
	;;=in word-processing format.
	;;^DD(162.5,19,0)
	;;=DATE FINALIZED^D^^0;16^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.5,19,1,0)
	;;=^.1
	;;^DD(162.5,19,1,1,0)
	;;=162.5^AP^MUMPS
	;;^DD(162.5,19,1,1,1)
	;;=S:$P(^FBAAI(DA,0),U,20)]"" ^FBAAI("AP",$P(^FBAAI(DA,0),U,20),9999999-$E(X,1,30),DA)=""
	;;^DD(162.5,19,1,1,2)
	;;=K:$P(^FBAAI(DA,0),U,20)]"" ^FBAAI("AP",$P(^FBAAI(DA,0),U,20),9999999-$E(X,1,30),DA)
	;;^DD(162.5,19,1,2,0)
	;;=162.5^AD
	;;^DD(162.5,19,1,2,1)
	;;=S ^FBAAI("AD",$E(X,1,30),DA)=""
	;;^DD(162.5,19,1,2,2)
	;;=K ^FBAAI("AD",$E(X,1,30),DA)
	;;^DD(162.5,19,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,19,21,1,0)
	;;=This field contains the date the invoice was vouchered by Fiscal.
	;;^DD(162.5,19,"DT")
	;;=2900611
	;;^DD(162.5,20,0)
	;;=BATCH NUMBER^*P161.7'^FBAA(161.7,^0;17^S DIC("S")="I $P(^(0),U,3)=""B9""&($P(^(0),U,5)=DUZ)&($P(^(""ST""),U,1)=""O"")" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.5,20,1,0)
	;;=^.1
	;;^DD(162.5,20,1,1,0)
	;;=162.5^AC^MUMPS
	;;^DD(162.5,20,1,1,1)
	;;=S ^FBAAI("AC",$E(X,1,30),DA)=""
	;;^DD(162.5,20,1,1,2)
	;;=K ^FBAAI("AC",$E(X,1,30),DA)
	;;^DD(162.5,20,1,2,0)
	;;=162.5^AE^MUMPS
	;;^DD(162.5,20,1,2,1)
	;;=S ^FBAAI("AE",$E(X,1,30),$P(^FBAAI(DA,0),U,4),DA)=""
	;;^DD(162.5,20,1,2,2)
	;;=K ^FBAAI("AE",$E(X,1,30),$P(^FBAAI(DA,0),U,4),DA)
	;;^DD(162.5,20,12)
	;;=ONLY BATCHES WITH A STATUS OF 'OPEN'
	;;^DD(162.5,20,12.1)
	;;=S DIC("S")="I $P(^(0),U,3)=""B9""&($P(^(0),U,5)=DUZ)&($P(^(""ST""),U,1)=""O"")"
	;;^DD(162.5,20,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,20,21,1,0)
	;;=This field contains the batch number associated with this invoice.
	;;^DD(162.5,20,21,2,0)
	;;=(The batch number that the invoice resides in).
	;;^DD(162.5,20,"DT")
	;;=2900816
	;;^DD(162.5,21,0)
	;;=PURPOSE OF VISIT^*P161.82'^FBAA(161.82,^0;18^S DIC("S")="I $S('$G(^(""I"")):1,DT'>^(""I""):1,1:0)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.5,21,12)
	;;=An inactive Purpose of Visit Code may not be selected.

FBINI027
FBINI027	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.5,21,12.1)
	;;=S DIC("S")="I $S('$G(^(""I"")):1,DT'>^(""I""):1,1:0)"
	;;^DD(162.5,21,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,21,21,1,0)
	;;=Contains the valid Purpose of Visit code as defined in the Fee Basis
	;;^DD(162.5,21,21,2,0)
	;;=Purpose of Visit file.
	;;^DD(162.5,21,"DT")
	;;=2930205
	;;^DD(162.5,22,0)
	;;=PATIENT TYPE CODE^S^00:SURGICAL;10:MEDICAL;60:HOME NURSING SERVICE;85:PSYCHIATRIC-CONTRACT;86:PSYCHIATRIC;95:NEUROLOGICAL-CONTRACT;96:NEUROLOGICAL;^0;19^Q
	;;^DD(162.5,22,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,22,21,1,0)
	;;=This field requires the entry of the type of treatment being provided
	;;^DD(162.5,22,21,2,0)
	;;=to the patient (i.e. Surgical, Medical, Home Nursing Service, etc.)
	;;^DD(162.5,22,"DT")
	;;=2890425
	;;^DD(162.5,23,0)
	;;=PRIMARY SERVICE FACILITY^P4'^DIC(4,^0;20^Q
	;;^DD(162.5,23,1,0)
	;;=^.1^^0
	;;^DD(162.5,23,21,0)
	;;=^^1^1^2941130^^
	;;^DD(162.5,23,21,1,0)
	;;=The VA Hospital responsible for that Veterans care.
	;;^DD(162.5,23,"DT")
	;;=2900604
	;;^DD(162.5,24,0)
	;;=DISCHARGE DRG^P80.2'^ICD(^0;24^Q
	;;^DD(162.5,24,21,0)
	;;=^^2^2^2930514^^
	;;^DD(162.5,24,21,1,0)
	;;=This field should contain the discharge DRG that is returned from the
	;;^DD(162.5,24,21,2,0)
	;;=Austin Pricer System.
	;;^DD(162.5,24,23,0)
	;;=^^2^2^2930111^
	;;^DD(162.5,24,23,1,0)
	;;=This field is a pointer to the DRG file, however it is the grouped DRG
	;;^DD(162.5,24,23,2,0)
	;;=as calculated by the Austin Pricer system.
	;;^DD(162.5,24,"DT")
	;;=2930111
	;;^DD(162.5,25,0)
	;;=RESUBMISSION^S^1:YES;^0;25^Q
	;;^DD(162.5,25,21,0)
	;;=^^3^3^2930514^
	;;^DD(162.5,25,21,1,0)
	;;=Entry into this field indicates that this invoice is a resubmission.
	;;^DD(162.5,25,21,2,0)
	;;=Failure to annotate an invoice in such a manner would cause Austin to 
	;;^DD(162.5,25,21,3,0)
	;;=reject the payment as duplicate.
	;;^DD(162.5,25,"DT")
	;;=2930304
	;;^DD(162.5,26,0)
	;;=NVH PRICER AMOUNT^NJ9,2^^0;26^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999.99)!(X<.01) X
	;;^DD(162.5,26,3)
	;;=Type a Dollar Amount between .01 and 999999.99, 2 Decimal Digits
	;;^DD(162.5,26,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,26,21,1,0)
	;;=The amount for this payment as determined by the Austin Pricer.
	;;^DD(162.5,26,"DT")
	;;=2930322
	;;^DD(162.5,30,0)
	;;=ICD1^RP80'^ICD9(^DX;1^Q
	;;^DD(162.5,30,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,30,21,1,0)
	;;=The first valid ICD code associated with this payment.
	;;^DD(162.5,30,"DT")
	;;=2900529
	;;^DD(162.5,31,0)
	;;=ICD2^P80'^ICD9(^DX;2^Q
	;;^DD(162.5,31,3)
	;;=
	;;^DD(162.5,31,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,31,21,1,0)
	;;=The second valid ICD code (if one exists) associated with this payment.
	;;^DD(162.5,32,0)
	;;=ICD3^P80'^ICD9(^DX;3^Q
	;;^DD(162.5,32,3)
	;;=
	;;^DD(162.5,32,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,32,21,1,0)
	;;=The third valid ICD code (if one exists) associated with this payment.
	;;^DD(162.5,33,0)
	;;=ICD4^P80'^ICD9(^DX;4^Q
	;;^DD(162.5,33,3)
	;;=
	;;^DD(162.5,33,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,33,21,1,0)
	;;=The fourth valid ICD code (if one exists) associated with this payment.
	;;^DD(162.5,34,0)
	;;=ICD5^P80'^ICD9(^DX;5^Q
	;;^DD(162.5,34,3)
	;;=
	;;^DD(162.5,34,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,34,21,1,0)
	;;=The fifth valid ICD code (if one exists) associated with this payment.
	;;^DD(162.5,40,0)
	;;=PROC1^P80.1'^ICD0(^PROC;1^Q
	;;^DD(162.5,40,21,0)
	;;=^^1^1^2930514^
	;;^DD(162.5,40,21,1,0)
	;;=The first valid procedure code (if one exists) associated with this payment.
	;;^DD(162.5,41,0)
	;;=PROC2^P80.1'^ICD0(^PROC;2^Q
	;;^DD(162.5,41,3)
	;;=
	;;^DD(162.5,41,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,41,21,1,0)
	;;=The second valid procedure code (if one exists) associated with this
	;;^DD(162.5,41,21,2,0)
	;;=payment.
	;;^DD(162.5,42,0)
	;;=PROC3^P80.1'^ICD0(^PROC;3^Q
	;;^DD(162.5,42,3)
	;;=
	;;^DD(162.5,42,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,42,21,1,0)
	;;=The third valid procedure code (if one exists) associated with this
	;;^DD(162.5,42,21,2,0)
	;;=payment.
	;;^DD(162.5,43,0)
	;;=PROC4^P80.1'^ICD0(^PROC;4^Q
	;;^DD(162.5,43,3)
	;;=
	;;^DD(162.5,43,21,0)
	;;=^^2^2^2930514^

FBINI028
FBINI028	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.5,43,21,1,0)
	;;=The fourth valid procedure code (if one exists) associated with this
	;;^DD(162.5,43,21,2,0)
	;;=payment.
	;;^DD(162.5,44,0)
	;;=PROC5^P80.1'^ICD0(^PROC;5^Q
	;;^DD(162.5,44,3)
	;;=
	;;^DD(162.5,44,21,0)
	;;=^^2^2^2930514^
	;;^DD(162.5,44,21,1,0)
	;;=The fifth valid procedure code (if one exists) associated with this
	;;^DD(162.5,44,21,2,0)
	;;=payment.
	;;^DD(162.5,45,0)
	;;=DATE PAID^D^^2;1^S %DT="E" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.5,45,3)
	;;=This is the date of the check, as issued by the treasury.
	;;^DD(162.5,45,21,0)
	;;=^^4^4^2940315^^
	;;^DD(162.5,45,21,1,0)
	;;=This is the date of the check, as issued by the treasury.  This
	;;^DD(162.5,45,21,2,0)
	;;=information will be passed back to DHCP from the Financial Management
	;;^DD(162.5,45,21,3,0)
	;;=System (FMS) when the check is issued to the vendor.  This field will
	;;^DD(162.5,45,21,4,0)
	;;=use the check date beginning with version 3.5 of Fee Basis.
	;;^DD(162.5,45,"DT")
	;;=2940315
	;;^DD(162.5,46,0)
	;;=VENDOR INVOICE DATE^RDX^^2;2^S %DT="E" D ^%DT S X=Y K:Y<1 X I X>$P(^FBAAI(DA,0),U,2) W !,*7,"Vendor Invoice Date cannot be later than the Date Correct Invoice Received" K X
	;;^DD(162.5,46,3)
	;;=Enter the date the vendor issued the invoice.
	;;^DD(162.5,46,21,0)
	;;=^^1^1^2940315^^
	;;^DD(162.5,46,21,1,0)
	;;=This is the date that the vendor issued the invoice.
	;;^DD(162.5,46,"DT")
	;;=2940415
	;;^DD(162.5,47,0)
	;;=PROMPT PAY TYPE^S^1:MONEY MANAGED;^2;3^Q
	;;^DD(162.5,47,3)
	;;=Set equal to 1 if payment is subject to interest payments.
	;;^DD(162.5,47,21,0)
	;;=^^2^2^2940315^^
	;;^DD(162.5,47,21,1,0)
	;;=Field is set to 1 if the payment is subject to interest payments (prompt
	;;^DD(162.5,47,21,2,0)
	;;=pay).
	;;^DD(162.5,47,"DT")
	;;=2940318
	;;^DD(162.5,48,0)
	;;=CHECK NUMBER^F^^2;4^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<1)!'(X?.AN) X
	;;^DD(162.5,48,1,0)
	;;=^.1
	;;^DD(162.5,48,1,1,0)
	;;=162.5^ACK^MUMPS
	;;^DD(162.5,48,1,1,1)
	;;=S ^FBAAI("ACK",$E(X,1,30),DA)=""
	;;^DD(162.5,48,1,1,2)
	;;=K ^FBAAI("ACK",X,DA)
	;;^DD(162.5,48,1,1,"%D",0)
	;;=^^2^2^2940425^^
	;;^DD(162.5,48,1,1,"%D",1,0)
	;;=This cross-reference is used to find payment line items for specific
	;;^DD(162.5,48,1,1,"%D",2,0)
	;;=check numbers.
	;;^DD(162.5,48,1,1,"DT")
	;;=2940425
	;;^DD(162.5,48,3)
	;;=Answer must be 1-8 characters in length.
	;;^DD(162.5,48,21,0)
	;;=^^3^3^2940315^^
	;;^DD(162.5,48,21,1,0)
	;;=Contains the check number as issued by the treasury.  This field is updated
	;;^DD(162.5,48,21,2,0)
	;;=after the check is issued, through a server option that records actual
	;;^DD(162.5,48,21,3,0)
	;;=payment information for each Fee payment made.
	;;^DD(162.5,48,"DT")
	;;=2940425
	;;^DD(162.5,49,0)
	;;=CANCELLATION DATE^D^^2;5^S %DT="E" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.5,49,3)
	;;=The date the check was cancelled by the treasury.
	;;^DD(162.5,49,21,0)
	;;=^^3^3^2940315^^
	;;^DD(162.5,49,21,1,0)
	;;=This is the date the treasury cancelled the check.  This field is updated
	;;^DD(162.5,49,21,2,0)
	;;=through a server option that records cancellations of previously recorded
	;;^DD(162.5,49,21,3,0)
	;;=payment data.
	;;^DD(162.5,49,"DT")
	;;=2940315
	;;^DD(162.5,50,0)
	;;=REASON CODE^P162.95'^FB(162.95,^2;6^Q
	;;^DD(162.5,50,3)
	;;=Enter the reason the check was cancelled.
	;;^DD(162.5,50,21,0)
	;;=^^3^3^2940315^^
	;;^DD(162.5,50,21,1,0)
	;;=This field contains a pointer to the Fee Basis Check Cancellation Reason
	;;^DD(162.5,50,21,2,0)
	;;=file.  It is populated through a server option that updates the payment
	;;^DD(162.5,50,21,3,0)
	;;=record when the treasury cancels a check that was previously payed.
	;;^DD(162.5,50,"DT")
	;;=2940315
	;;^DD(162.5,51,0)
	;;=CANCELLATION ACTIVITY^S^R:WILL BE REPLACED;C:WILL BE REISSUED;X:WILL NOT BE REISSUED;^2;7^Q
	;;^DD(162.5,51,3)
	;;=Field will contain cancellation code if there has been cancellation activity on this payment.
	;;^DD(162.5,51,21,0)
	;;=^^7^7^2940315^^
	;;^DD(162.5,51,21,1,0)
	;;=This field is populated when a cancellation is recorded for the payment
	;;^DD(162.5,51,21,2,0)
	;;=referenced.  This field will always remain populated, to indicate that

FBINI029
FBINI029	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.5,51,21,3,0)
	;;=there was cancellation activity on this payment at one time.  New payments
	;;^DD(162.5,51,21,4,0)
	;;=will replace the cancellation date and reason code fields, but the
	;;^DD(162.5,51,21,5,0)
	;;=cancellation activity flag will not be overwritten.  This flag will allow
	;;^DD(162.5,51,21,6,0)
	;;=the user to know that previous cancellation activity existed, and to
	;;^DD(162.5,51,21,7,0)
	;;=review the cancellation history output for further information.
	;;^DD(162.5,51,"DT")
	;;=2940426
	;;^DD(162.5,52,0)
	;;=DISBURSED AMOUNT^NJ9,2^^2;8^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.5,52,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.5,52,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.5,52,21,1,0)
	;;=This is the dollar amount paid by the treasury, less any interest paid.
	;;^DD(162.5,52,"DT")
	;;=2940421
	;;^DD(162.5,53,0)
	;;=INTEREST AMOUNT^NJ9,2^^2;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
	;;^DD(162.5,53,3)
	;;=Type a Dollar Amount between 0 and 999999, 2 Decimal Digits
	;;^DD(162.5,53,21,0)
	;;=^^1^1^2940420^^
	;;^DD(162.5,53,21,1,0)
	;;=The interest amount paid on this line item by the treasury.
	;;^DD(162.5,53,"DT")
	;;=2940421
	;;^DD(162.518,0)
	;;=DESCRIPTION OF SUSPENSION SUB-FIELD^^.01^1
	;;^DD(162.518,0,"NM","DESCRIPTION OF SUSPENSION")
	;;=
	;;^DD(162.518,0,"UP")
	;;=162.5
	;;^DD(162.518,.01,0)
	;;=DESCRIPTION OF SUSPENSION^WL^^0;1^Q
	;;^DD(162.518,.01,"DT")
	;;=2910117

FBINI02A
FBINI02A	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.6,0,"GL")
	;;=^FBAA(162.6,
	;;^DIC("B","FEE BASIS DISPOSITION CODE",162.6)
	;;=
	;;^DIC(162.6,"%D",0)
	;;=^^4^4^2940622^^^
	;;^DIC(162.6,"%D",1,0)
	;;=This file contains the disposition choices when moving a patient
	;;^DIC(162.6,"%D",2,0)
	;;=in the inpatient programs.
	;;^DIC(162.6,"%D",3,0)
	;;= 
	;;^DIC(162.6,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.6,0)
	;;=FIELD^^1^3
	;;^DD(162.6,0,"IX","B",162.6,.01)
	;;=
	;;^DD(162.6,0,"IX","C",162.6,1)
	;;=
	;;^DD(162.6,0,"IX","D",162.6,1)
	;;=
	;;^DD(162.6,0,"NM","FEE BASIS DISPOSITION CODE")
	;;=
	;;^DD(162.6,0,"PT",162.5,6.5)
	;;=
	;;^DD(162.6,.001,0)
	;;=NUMBER^NJ9,0^^ ^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.6,.001,3)
	;;=Type a Number between 1 and 999999999, 0 Decimal Digits
	;;^DD(162.6,.001,21,0)
	;;=^^1^1^2941128^
	;;^DD(162.6,.001,21,1,0)
	;;=This is the internal number of this file.
	;;^DD(162.6,.001,"DT")
	;;=2900731
	;;^DD(162.6,.01,0)
	;;=NAME^RF^^0;1^K:$L(X)>45!($L(X)<3)!'(X'?1P.E) X
	;;^DD(162.6,.01,1,0)
	;;=^.1
	;;^DD(162.6,.01,1,1,0)
	;;=162.6^B
	;;^DD(162.6,.01,1,1,1)
	;;=S ^FBAA(162.6,"B",$E(X,1,30),DA)=""
	;;^DD(162.6,.01,1,1,2)
	;;=K ^FBAA(162.6,"B",$E(X,1,30),DA)
	;;^DD(162.6,.01,3)
	;;=Answer must be 3-45 characters in length.
	;;^DD(162.6,.01,21,0)
	;;=^^2^2^2930519^
	;;^DD(162.6,.01,21,1,0)
	;;=The disposition of a patient used during the inpatient payment
	;;^DD(162.6,.01,21,2,0)
	;;=process.
	;;^DD(162.6,1,0)
	;;=CODE^RNJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.6,1,1,0)
	;;=^.1
	;;^DD(162.6,1,1,1,0)
	;;=162.6^C
	;;^DD(162.6,1,1,1,1)
	;;=S ^FBAA(162.6,"C",$E(X,1,30),DA)=""
	;;^DD(162.6,1,1,1,2)
	;;=K ^FBAA(162.6,"C",$E(X,1,30),DA)
	;;^DD(162.6,1,1,2,0)
	;;=162.6^D^MUMPS
	;;^DD(162.6,1,1,2,1)
	;;=S ^FBAA(162.6,"D",$E("00",$L(X)+1,2)_X,DA)=""
	;;^DD(162.6,1,1,2,2)
	;;=K ^FBAA(162.6,"D",$E("00",$L(X)+1,2)_X,DA)
	;;^DD(162.6,1,3)
	;;=Type a Number between 1 and 99, 0 Decimal Digits
	;;^DD(162.6,1,21,0)
	;;=^^2^2^2930519^
	;;^DD(162.6,1,21,1,0)
	;;=This is the code associated with a disposition and is sent with
	;;^DD(162.6,1,21,2,0)
	;;=the payment record to Austin.
	;;^DD(162.6,1,"DT")
	;;=2900418

FBINI02B
FBINI02B	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(162.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,162.6)
	;;=^FBAA(162.6,
	;;^UTILITY(U,$J,162.6,0)
	;;=FEE BASIS DISPOSITION CODE^162.6^9^9
	;;^UTILITY(U,$J,162.6,1,0)
	;;=TO HOME OR SELF CARE^1
	;;^UTILITY(U,$J,162.6,2,0)
	;;=TO ANOTHER SHORT-TERM FACILITY^2
	;;^UTILITY(U,$J,162.6,3,0)
	;;=TO SKILLED NURSING FACILITY^3
	;;^UTILITY(U,$J,162.6,4,0)
	;;=TO INTERMEDIATE NURSING FACILITY^4
	;;^UTILITY(U,$J,162.6,5,0)
	;;=TO ANOTHER TYPE OF FACILITY^5
	;;^UTILITY(U,$J,162.6,6,0)
	;;=TO HOME FOR HOME HEALTH SERVICES^6
	;;^UTILITY(U,$J,162.6,7,0)
	;;=LEFT AGAINST MEDICAL ADVICE^7
	;;^UTILITY(U,$J,162.6,8,0)
	;;=DIED^20
	;;^UTILITY(U,$J,162.6,9,0)
	;;=STILL A PATIENT^30

FBINI02C
FBINI02C	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.7,0,"GL")
	;;=^FB583(
	;;^DIC("B","FEE BASIS UNAUTHORIZED CLAIMS",162.7)
	;;=
	;;^DIC(162.7,"%D",0)
	;;=^^7^7^2940622^^^^
	;;^DIC(162.7,"%D",1,0)
	;;=This file contains unauthorized claim information for active fee programs.
	;;^DIC(162.7,"%D",2,0)
	;;=Sites have the ability to either track only complete claims or incomplete
	;;^DIC(162.7,"%D",3,0)
	;;=claims, depending upon the value in the site parameter field.
	;;^DIC(162.7,"%D",4,0)
	;;=A claim is considered complete once all information is received in order 
	;;^DIC(162.7,"%D",5,0)
	;;=to make a determination (dispostion).
	;;^DIC(162.7,"%D",6,0)
	;;= 
	;;^DIC(162.7,"%D",7,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.7,0)
	;;=FIELD^^55^38
	;;^DD(162.7,0,"DT")
	;;=2940329
	;;^DD(162.7,0,"ID",1)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^FBAAV(+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(161.2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(162.7,0,"ID",2)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^DPT(+$P(^(0),U,4),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(162.7,0,"ID",24)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^FB(162.92,+$P(^(0),U,24),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(162.92,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(162.7,0,"ID","WRITE")
	;;=S FBZ=$$FBZ^FBUCUTL(Y) W:FBZ]"" ! W:$P(FBZ,U,5) ?7,"Treatment From: ",$$DATX^FBAAUTL($P(FBZ,U,5)) W:$P(FBZ,U,6) ?35,"Treatment To: ",$$DATX^FBAAUTL($P(FBZ,U,6)) K FBZ
	;;^DD(162.7,0,"IX","AA",162.7,12)
	;;=
	;;^DD(162.7,0,"IX","AA1",162.7,.5)
	;;=
	;;^DD(162.7,0,"IX","AC",162.7,10)
	;;=
	;;^DD(162.7,0,"IX","AD",162.7,13)
	;;=
	;;^DD(162.7,0,"IX","AD1",162.7,.5)
	;;=
	;;^DD(162.7,0,"IX","AES",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","AES1",162.7,26)
	;;=
	;;^DD(162.7,0,"IX","AID",162.7,.01)
	;;=
	;;^DD(162.7,0,"IX","AL",162.7,19)
	;;=
	;;^DD(162.7,0,"IX","ALP",162.7,19.5)
	;;=
	;;^DD(162.7,0,"IX","AMC",162.7,20)
	;;=
	;;^DD(162.7,0,"IX","AMP",162.7,20)
	;;=
	;;^DD(162.7,0,"IX","AMS",162.7,20)
	;;=
	;;^DD(162.7,0,"IX","AOMS",162.7,23)
	;;=
	;;^DD(162.7,0,"IX","AOMS1",162.7,20)
	;;=
	;;^DD(162.7,0,"IX","AOMS2",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","AOS",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","AOS1",162.7,23)
	;;=
	;;^DD(162.7,0,"IX","APF",162.7,2)
	;;=
	;;^DD(162.7,0,"IX","APF1",162.7,3)
	;;=
	;;^DD(162.7,0,"IX","APMS",162.7,2)
	;;=
	;;^DD(162.7,0,"IX","APMS1",162.7,20)
	;;=
	;;^DD(162.7,0,"IX","APMS2",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","APS",162.7,2)
	;;=
	;;^DD(162.7,0,"IX","APS1",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","AS",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","ASD",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","ASD1",162.7,25)
	;;=
	;;^DD(162.7,0,"IX","AVF",162.7,1)
	;;=
	;;^DD(162.7,0,"IX","AVF1",162.7,3)
	;;=
	;;^DD(162.7,0,"IX","AVMS",162.7,1)
	;;=
	;;^DD(162.7,0,"IX","AVMS1",162.7,20)
	;;=
	;;^DD(162.7,0,"IX","AVMS2",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","AVS",162.7,1)
	;;=
	;;^DD(162.7,0,"IX","AVS1",162.7,24)
	;;=
	;;^DD(162.7,0,"IX","B",162.7,.01)
	;;=
	;;^DD(162.7,0,"IX","C",162.7,1)
	;;=
	;;^DD(162.7,0,"IX","D",162.7,2)
	;;=
	;;^DD(162.7,0,"NM","FEE BASIS UNAUTHORIZED CLAIMS")
	;;=
	;;^DD(162.7,0,"PT",161.01,.055)
	;;=
	;;^DD(162.7,0,"PT",162.03,27)
	;;=
	;;^DD(162.7,0,"PT",162.11,26)
	;;=
	;;^DD(162.7,0,"PT",162.5,4)
	;;=
	;;^DD(162.7,0,"PT",162.7,20)
	;;=
	;;^DD(162.7,0,"PT",162.8,.02)
	;;=
	;;^DD(162.7,.01,0)
	;;=DATE CLAIM RECEIVED^RDX^^0;1^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,.01,1,0)
	;;=^.1
	;;^DD(162.7,.01,1,1,0)
	;;=162.7^B
	;;^DD(162.7,.01,1,1,1)
	;;=S ^FB583("B",$E(X,1,30),DA)=""
	;;^DD(162.7,.01,1,1,2)
	;;=K ^FB583("B",$E(X,1,30),DA)
	;;^DD(162.7,.01,1,2,0)
	;;=162.7^AID^MUMPS
	;;^DD(162.7,.01,1,2,1)
	;;=S ^FB583("AID",-X,DA)=""
	;;^DD(162.7,.01,1,2,2)
	;;=K ^FB583("AID",-X,DA)
	;;^DD(162.7,.01,1,2,"%D",0)
	;;=^^1^1^2930301^
	;;^DD(162.7,.01,1,2,"%D",1,0)
	;;=Sort entries by inverse date unauthorized claim received.
	;;^DD(162.7,.01,1,2,"DT")
	;;=2930301
	;;^DD(162.7,.01,3)
	;;=Enter when an Unauthorized Claim, complete or incomplete, is received.

FBINI02D
FBINI02D	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,.01,21,0)
	;;=^^2^2^2930511^^^^
	;;^DD(162.7,.01,21,1,0)
	;;=This is the Date that the valid 583 was accepted for
	;;^DD(162.7,.01,21,2,0)
	;;=processing. Usually the date the claim is being entered.
	;;^DD(162.7,.01,"DEL",.01,0)
	;;=D DEL^FBUCDD1(DA)
	;;^DD(162.7,.01,"DT")
	;;=2930423
	;;^DD(162.7,.5,0)
	;;=FEE PROGRAM^R*P161.8'^FBAA(161.8,^0;2^S DIC("S")="I +$P(^(0),U,3)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.7,.5,1,0)
	;;=^.1
	;;^DD(162.7,.5,1,1,0)
	;;=162.7^AA1^MUMPS
	;;^DD(162.7,.5,1,1,1)
	;;=S:$P(^FB583(DA,0),U,13) ^FB583("AA",X,$P(^(0),U,13),DA)=""
	;;^DD(162.7,.5,1,1,2)
	;;=K:$P(^FB583(DA,0),U,13) ^FB583("AA",X,$P(^(0),U,13),DA)
	;;^DD(162.7,.5,1,1,"%D",0)
	;;=^^1^1^2930301^^^^
	;;^DD(162.7,.5,1,1,"%D",1,0)
	;;=Cross reference by fee program, authorization from date.
	;;^DD(162.7,.5,1,1,"DT")
	;;=2930301
	;;^DD(162.7,.5,1,2,0)
	;;=162.7^AD1^MUMPS
	;;^DD(162.7,.5,1,2,1)
	;;=S:$P(^FB583(DA,0),U,14) ^FB583("AD",X,$P(^(0),U,14),DA)=""
	;;^DD(162.7,.5,1,2,2)
	;;=K:$P(^FB583(DA,0),U,14) ^FB583("AD",X,$P(^(0),U,14),DA)
	;;^DD(162.7,.5,1,2,"%D",0)
	;;=^^1^1^2930301^^^
	;;^DD(162.7,.5,1,2,"%D",1,0)
	;;=Cross reference by fee program and authorization to date.
	;;^DD(162.7,.5,1,2,"DT")
	;;=2930301
	;;^DD(162.7,.5,3)
	;;=Enter the appropriate active fee program to which this claim pertains.
	;;^DD(162.7,.5,12)
	;;=Only active fee programs can be selected.
	;;^DD(162.7,.5,12.1)
	;;=S DIC("S")="I +$P(^(0),U,3)"
	;;^DD(162.7,.5,21,0)
	;;=^^2^2^2940329^
	;;^DD(162.7,.5,21,1,0)
	;;=The appropriate fee program to which this unauthorized claim pertains.
	;;^DD(162.7,.5,21,2,0)
	;;=Only active fee programs can be selected.
	;;^DD(162.7,.5,"DT")
	;;=2940329
	;;^DD(162.7,1,0)
	;;=VENDOR^RP161.2'^FBAAV(^0;3^Q
	;;^DD(162.7,1,1,0)
	;;=^.1
	;;^DD(162.7,1,1,1,0)
	;;=162.7^C
	;;^DD(162.7,1,1,1,1)
	;;=S ^FB583("C",$E(X,1,30),DA)=""
	;;^DD(162.7,1,1,1,2)
	;;=K ^FB583("C",$E(X,1,30),DA)
	;;^DD(162.7,1,1,2,0)
	;;=162.7^AVF^MUMPS
	;;^DD(162.7,1,1,2,1)
	;;=S:$P(^FB583(DA,0),U,5) ^FB583("AVF",X,$P(^(0),U,5),DA)=""
	;;^DD(162.7,1,1,2,2)
	;;=K:$P(^FB583(DA,0),U,5) ^FB583("AVF",X,$P(^(0),U,5),DA)
	;;^DD(162.7,1,1,2,"%D",0)
	;;=^^1^1^2930301^
	;;^DD(162.7,1,1,2,"%D",1,0)
	;;=Cross reference by vendor, treatment from date and record number.
	;;^DD(162.7,1,1,2,"DT")
	;;=2930301
	;;^DD(162.7,1,1,3,0)
	;;=162.7^AVS^MUMPS
	;;^DD(162.7,1,1,3,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,24) ^FB583("AVS",X,$P(FBZ,U,24),DA)="" K FBZ
	;;^DD(162.7,1,1,3,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) K:$P(FBZ,U,24) ^FB583("AVS",X,$P(FBZ,U,24),DA) K FBZ
	;;^DD(162.7,1,1,3,"%D",0)
	;;=^^1^1^2930319^
	;;^DD(162.7,1,1,3,"%D",1,0)
	;;=Cross-reference used to group claims by vendor and status.
	;;^DD(162.7,1,1,3,"DT")
	;;=2930702
	;;^DD(162.7,1,1,4,0)
	;;=162.7^AVMS^MUMPS
	;;^DD(162.7,1,1,4,1)
	;;=D MSIX^FBUCDD(X,DA,1,1,"AVMS")
	;;^DD(162.7,1,1,4,2)
	;;=D MSIX^FBUCDD(X,DA,1,2,"AVMS")
	;;^DD(162.7,1,1,4,"%D",0)
	;;=^^5^5^2930518^^
	;;^DD(162.7,1,1,4,"%D",1,0)
	;;=This cross-reference sets/kill the 'AVMS' cross-reference.  It is used to
	;;^DD(162.7,1,1,4,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,1,1,4,"%D",3,0)
	;;=Fields involved are:  Vendor, Master Claim and Status, having the
	;;^DD(162.7,1,1,4,"%D",4,0)
	;;=respective index of 'AVMS', 'AVMS1' or 'AVMS2'.  In order to re-set the
	;;^DD(162.7,1,1,4,"%D",5,0)
	;;='AVMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,1,1,4,"DT")
	;;=2930518
	;;^DD(162.7,1,3)
	;;=Enter the vendor who provided the services being charged.
	;;^DD(162.7,1,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,1,21,1,0)
	;;=The vendor who provided the services being charged.
	;;^DD(162.7,1,"DT")
	;;=2930702
	;;^DD(162.7,2,0)
	;;=VETERAN^RP2'^DPT(^0;4^Q
	;;^DD(162.7,2,1,0)
	;;=^.1
	;;^DD(162.7,2,1,1,0)
	;;=162.7^D
	;;^DD(162.7,2,1,1,1)
	;;=S ^FB583("D",$E(X,1,30),DA)=""
	;;^DD(162.7,2,1,1,2)
	;;=K ^FB583("D",$E(X,1,30),DA)
	;;^DD(162.7,2,1,2,0)
	;;=162.7^APF^MUMPS
	;;^DD(162.7,2,1,2,1)
	;;=S:$P(^FB583(DA,0),U,5) ^FB583("APF",X,$P(^(0),U,5),DA)=""
	;;^DD(162.7,2,1,2,2)
	;;=K:$P(^FB583(DA,0),U,5) ^FB583("APF",X,$P(^(0),U,5),DA)

FBINI02E
FBINI02E	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,2,1,2,"%D",0)
	;;=^^1^1^2930301^
	;;^DD(162.7,2,1,2,"%D",1,0)
	;;=Cross reference by patient, treatment from date, record number.
	;;^DD(162.7,2,1,2,"DT")
	;;=2930301
	;;^DD(162.7,2,1,3,0)
	;;=162.7^APS^MUMPS
	;;^DD(162.7,2,1,3,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,24) ^FB583("APS",X,$P(FBZ,U,24),DA)="" K FBZ
	;;^DD(162.7,2,1,3,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) K:$P(FBZ,U,24) ^FB583("APS",X,$P(FBZ,U,24),DA) K FBZ
	;;^DD(162.7,2,1,3,"%D",0)
	;;=^^1^1^2930319^
	;;^DD(162.7,2,1,3,"%D",1,0)
	;;=Cross-reference used to group claims by veteran (patient) and status.
	;;^DD(162.7,2,1,3,"DT")
	;;=2930702
	;;^DD(162.7,2,1,4,0)
	;;=162.7^APMS^MUMPS
	;;^DD(162.7,2,1,4,1)
	;;=D MSIX^FBUCDD(X,DA,2,1,"APMS")
	;;^DD(162.7,2,1,4,2)
	;;=D MSIX^FBUCDD(X,DA,2,2,"APMS")
	;;^DD(162.7,2,1,4,"%D",0)
	;;=^^5^5^2930518^^
	;;^DD(162.7,2,1,4,"%D",1,0)
	;;=This cross-reference sets/kill the 'APMS' cross-reference.  It is used to
	;;^DD(162.7,2,1,4,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,2,1,4,"%D",3,0)
	;;=Fields involved are:  Patient, Master Claim and Status, having the
	;;^DD(162.7,2,1,4,"%D",4,0)
	;;=respective index of 'APMS', 'APMS1' or 'APMS2'.  In order to re-set the
	;;^DD(162.7,2,1,4,"%D",5,0)
	;;='APMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,2,1,4,"DT")
	;;=2930518
	;;^DD(162.7,2,3)
	;;=Enter the veteran who received the services being claimed.
	;;^DD(162.7,2,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,2,21,1,0)
	;;=The name of the veteran who received the services being claimed.
	;;^DD(162.7,2,"DT")
	;;=2930702
	;;^DD(162.7,3,0)
	;;=TREATMENT FROM DATE^RDX^^0;5^S %DT="EPX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y K:Y<1 X
	;;^DD(162.7,3,1,0)
	;;=^.1
	;;^DD(162.7,3,1,1,0)
	;;=162.7^APF1^MUMPS
	;;^DD(162.7,3,1,1,1)
	;;=S:$P(^FB583(DA,0),U,4) ^FB583("APF",$P(^(0),U,4),X,DA)=""
	;;^DD(162.7,3,1,1,2)
	;;=K:$P(^FB583(DA,0),U,4) ^FB583("APF",$P(^(0),U,4),X,DA)
	;;^DD(162.7,3,1,1,"%D",0)
	;;=^^1^1^2930301^
	;;^DD(162.7,3,1,1,"%D",1,0)
	;;=Cross reference by patient, treatment from date and record number.
	;;^DD(162.7,3,1,1,"DT")
	;;=2930301
	;;^DD(162.7,3,1,2,0)
	;;=162.7^AVF1^MUMPS
	;;^DD(162.7,3,1,2,1)
	;;=S:$P(^FB583(DA,0),U,3) ^FB583("AVF",$P(^(0),U,3),X,DA)=""
	;;^DD(162.7,3,1,2,2)
	;;=K:$P(^FB583(DA,0),U,3) ^FB583("AVF",$P(^(0),U,3),X,DA)
	;;^DD(162.7,3,1,2,"%D",0)
	;;=^^1^1^2930301^
	;;^DD(162.7,3,1,2,"%D",1,0)
	;;=Cross reference by vendor, treatment from date and record number.
	;;^DD(162.7,3,1,2,"DT")
	;;=2930301
	;;^DD(162.7,3,3)
	;;=Enter the date treatment began for this particular Fee program and claim.  Date can not be in the future.
	;;^DD(162.7,3,21,0)
	;;=^^2^2^2930311^^
	;;^DD(162.7,3,21,1,0)
	;;=Date which treatment began for submitted unauthorized claim.
	;;^DD(162.7,3,21,2,0)
	;;=Date cannot be in the future.
	;;^DD(162.7,3,"DT")
	;;=2930505
	;;^DD(162.7,4,0)
	;;=TREATMENT TO DATE^RDX^^0;6^S %DT="EPX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y Q:'$G(DA)  S FBZZ=4 K:$$INPUT^FBUCDD(DA,X,Y,FBZZ) X K FBZZ
	;;^DD(162.7,4,3)
	;;=Enter the date treatment ended for this particular Fee program and claim.  Date cannot be in the future.  Treatment To Date cannot be earlier than Treatment From Date.
	;;^DD(162.7,4,21,0)
	;;=^^2^2^2930311^^
	;;^DD(162.7,4,21,1,0)
	;;=Date which treatment ended for sumbitted unauthorized claim.
	;;^DD(162.7,4,21,2,0)
	;;=Date cannot be in the future or be earlier than Treatment From date.
	;;^DD(162.7,4,"DT")
	;;=2930916
	;;^DD(162.7,5,0)
	;;=DIAGNOSIS^F^^DX;1^K:$L(X)>120!($L(X)<3) X
	;;^DD(162.7,5,3)
	;;=Answer must be 3-120 characters in length.
	;;^DD(162.7,5,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,5,21,1,0)
	;;=Enter the diagnosis upon which services were rendered.
	;;^DD(162.7,6,0)
	;;=PRIMARY SERVICE FACILITY^P4'^DIC(4,^0;7^Q
	;;^DD(162.7,6,3)
	;;=Enter the facility which is responsible for reimbursing the COJ.
	;;^DD(162.7,6,21,0)
	;;=^^1^1^2930513^^
	;;^DD(162.7,6,21,1,0)
	;;=The name of the facility which will reimburse the COJ.
	;;^DD(162.7,7,0)
	;;=DATE VALID CLAIM RECEIVED^DX^^0;8^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y S FBZZ=7 K:$$INPUT^FBUCDD(DA,X,Y,FBZZ) X K FBZZ

FBINI02F
FBINI02F	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,7,1,0)
	;;=^.1^^0
	;;^DD(162.7,7,3)
	;;=Enter date valid claim was received.  Valid claim includes all supporting information/documentation.
	;;^DD(162.7,7,21,0)
	;;=^^1^1^2930304^^
	;;^DD(162.7,7,21,1,0)
	;;=Date complete (valid) unauthorized claim received for medical review.
	;;^DD(162.7,7,23,0)
	;;=^^1^1^2930403^
	;;^DD(162.7,7,23,1,0)
	;;=This field is automatically updated in the update routine.
	;;^DD(162.7,7,"DT")
	;;=2931015
	;;^DD(162.7,8,0)
	;;=AMOUNT CLAIMED^NJ9,2^^0;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999.99)!(X<0) X
	;;^DD(162.7,8,3)
	;;=Type a Dollar Amount between 0 and 999999.99, 2 Decimal Digits
	;;^DD(162.7,8,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,8,21,1,0)
	;;=The dollar amount being claimed.
	;;^DD(162.7,8,"DT")
	;;=2910207
	;;^DD(162.7,9,0)
	;;=PATIENT TYPE CODE^RS^00:SURGICAL;10:MEDICAL;86:PSYCHIATRIC;^0;10^Q
	;;^DD(162.7,9,.1)
	;;=TREATING SPECIALTY
	;;^DD(162.7,9,3)
	;;=Enter the appropriate patient type code for services received.
	;;^DD(162.7,9,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,9,21,1,0)
	;;=The appropriate patient type code for services which were received.
	;;^DD(162.7,9,"DT")
	;;=2900912
	;;^DD(162.7,10,0)
	;;=DISPOSITION^*P162.91'X^FB(162.91,^0;11^S DIC("S")="I $P(^(0),U,2)" D ^DIC K DIC S DIC=DIE,X=+Y S FBZZ=10 K:$$INPUT^FBUCDD(DA,X,Y,FBZZ) X K FBZZ
	;;^DD(162.7,10,1,0)
	;;=^.1^^-1
	;;^DD(162.7,10,1,1,0)
	;;=162.7^AC^MUMPS
	;;^DD(162.7,10,1,1,1)
	;;=S ^FB583("AC",$E(X,1,30),DA)=""
	;;^DD(162.7,10,1,1,2)
	;;=K ^FB583("AC",$E(X,1,30),DA)
	;;^DD(162.7,10,3)
	;;=Select the appropriate dispostion reason.  An approved, approved to stabilization or disapproved disposition requires a Complete status.
	;;^DD(162.7,10,12)
	;;=Allow selection of active dispositions.
	;;^DD(162.7,10,12.1)
	;;=S DIC("S")="I $P(^(0),U,2)"
	;;^DD(162.7,10,21,0)
	;;=^^5^5^2930916^^^^
	;;^DD(162.7,10,21,1,0)
	;;=Only active dispositions can be selected.  If the disposition has been 
	;;^DD(162.7,10,21,2,0)
	;;=approved, or approved to stabilization and payments made, then the
	;;^DD(162.7,10,21,3,0)
	;;=disposition can not be changed unless the FBAASUPERVISOR key is held.
	;;^DD(162.7,10,21,4,0)
	;;=An approved, approved to stabilization, or disapproved disposition requires
	;;^DD(162.7,10,21,5,0)
	;;=a Complete status.
	;;^DD(162.7,10,23,0)
	;;=^^9^9^2930916^^^^
	;;^DD(162.7,10,23,1,0)
	;;=If date valid claim received is null, then only reason for disposition 
	;;^DD(162.7,10,23,2,0)
	;;= should be for cancelled/withdrawn or abandoned. <INPUT TRANSFORM>
	;;^DD(162.7,10,23,3,0)
	;;=If a disposition is not approved, and there are payments made against
	;;^DD(162.7,10,23,4,0)
	;;= the claim, the user may change the value only if s/he holds the 
	;;^DD(162.7,10,23,5,0)
	;;= supervisor security key.  <INPUT TRANSFORM>
	;;^DD(162.7,10,23,6,0)
	;;=  
	;;^DD(162.7,10,23,7,0)
	;;=When the status or disposition changes, a letter needs to be printed.
	;;^DD(162.7,10,23,8,0)
	;;=Once printed, the expiration date is calculated.  The number of days is
	;;^DD(162.7,10,23,9,0)
	;;=derived from the status.
	;;^DD(162.7,10,"DT")
	;;=2930513
	;;^DD(162.7,11,0)
	;;=DATE OF DISPOSITION^DX^^0;12^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,11,3)
	;;=Enter date claim dispositioned.
	;;^DD(162.7,11,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,11,21,1,0)
	;;=The date the claim was dispositioned.
	;;^DD(162.7,11,"DT")
	;;=2931015
	;;^DD(162.7,12,0)
	;;=AUTHORIZED FROM DATE^DX^^0;13^S %DT="EPX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y Q:'$D(DA)  S FBZZ=12 K:$$INPUT^FBUCDD(DA,X,Y,FBZZ) X K FBZZ
	;;^DD(162.7,12,1,0)
	;;=^.1
	;;^DD(162.7,12,1,1,0)
	;;=162.7^AA^MUMPS
	;;^DD(162.7,12,1,1,1)
	;;=S:$P(^FB583(DA,0),U,2) ^FB583("AA",$P(^(0),U,2),X,DA)=""
	;;^DD(162.7,12,1,1,2)
	;;=K:$P(^FB583(DA,0),U,2) ^FB583("AA",$P(^(0),U,2),X,DA)
	;;^DD(162.7,12,1,1,"%D",0)
	;;=^^1^1^2930301^^^^
	;;^DD(162.7,12,1,1,"%D",1,0)
	;;=Cross refernece by fee program and authorization from date.
	;;^DD(162.7,12,1,1,"DT")
	;;=2930301
	;;^DD(162.7,12,3)
	;;=Enter the beginning date which fee services are authorized.  Date cannot be in the future.  Date cannot be before Treatment From date or after Treatment To date.

FBINI02G
FBINI02G	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,12,4)
	;;=W !?5,"Treatment From: ",$$DATX^FBAAUTL(+$P(^FB583(DA,0),U,5)),"  Treatment To: ",$$DATX^FBAAUTL(+$P(^FB583(DA,0),U,6)),!
	;;^DD(162.7,12,21,0)
	;;=^^2^2^2930311^^
	;;^DD(162.7,12,21,1,0)
	;;=The beginning date from which fee services for unauthorized claim
	;;^DD(162.7,12,21,2,0)
	;;=are authorized.  Date cannot be in the future or before Treatment From date.
	;;^DD(162.7,12,"DT")
	;;=2930505
	;;^DD(162.7,13,0)
	;;=AUTHORIZED TO DATE^DX^^0;14^S %DT="EPX",%DT(0)=-DT D ^%DT K %DT(0) S X=Y Q:'$D(DA)  S FBZZ=13 K:$$INPUT^FBUCDD(DA,X,Y,FBZZ) X K FBZZ
	;;^DD(162.7,13,1,0)
	;;=^.1
	;;^DD(162.7,13,1,1,0)
	;;=162.7^AD^MUMPS
	;;^DD(162.7,13,1,1,1)
	;;=S:$P(^FB583(DA,0),U,2) ^FB583("AD",$P(^(0),U,2),X,DA)=""
	;;^DD(162.7,13,1,1,2)
	;;=K:$P(^FB583(DA,0),U,2) ^FB583("AD",$P(^(0),U,2),X,DA)
	;;^DD(162.7,13,1,1,"%D",0)
	;;=^^1^1^2930301^^^^
	;;^DD(162.7,13,1,1,"%D",1,0)
	;;=Cross reference by fee programs, authorization to date.
	;;^DD(162.7,13,1,1,"DT")
	;;=2930301
	;;^DD(162.7,13,3)
	;;=Enter the date treatment authorized to.  Date cannot be in the future or earlier than the Authorized From Date.  Authorized To date cannot be after Treatment To date.
	;;^DD(162.7,13,4)
	;;=W !?5,"Treatment From: ",$$DATX^FBAAUTL(+$P(^FB583(DA,0),U,5)),"  Treatment To: ",$$DATX^FBAAUTL(+$P(^FB583(DA,0),U,6)),!
	;;^DD(162.7,13,21,0)
	;;=^^3^3^2930511^^
	;;^DD(162.7,13,21,1,0)
	;;=The ending date which fee services are authorized.  Date cannot be in the
	;;^DD(162.7,13,21,2,0)
	;;=future or before the Authorized From date.  Authorized To date cannot be
	;;^DD(162.7,13,21,3,0)
	;;=greater than Treatment To date.
	;;^DD(162.7,13,"DT")
	;;=2930505
	;;^DD(162.7,14,0)
	;;=AMOUNT APPROVED^NJ9,2^^0;15^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999.99)!(X<.01) X
	;;^DD(162.7,14,3)
	;;=Enter the authorized amount for payment of unauthorized claim.  Dollar amount can be as low as .01 and as high as 999999.99.
	;;^DD(162.7,14,21,0)
	;;=^^1^1^2930419^
	;;^DD(162.7,14,21,1,0)
	;;=The authorized amount for payment of an unauthorized claim.
	;;^DD(162.7,14,"DT")
	;;=2930419
	;;^DD(162.7,15,0)
	;;=REASON FOR DISAPPROVAL^162.715PA^^D;0
	;;^DD(162.7,15,12)
	;;=Allow selection of active disapproval reason(s) for claim with a dispostion of other than APPROVED.
	;;^DD(162.7,15,12.1)
	;;=S DIC("S")="I $P(^(0),U,2),$P(^FB583(DA,0),U,11)>1"
	;;^DD(162.7,15,21,0)
	;;=^^1^1^2930511^^
	;;^DD(162.7,15,21,1,0)
	;;=Provides reason(s) why a claim was disapproved.
	;;^DD(162.7,15,23,0)
	;;=^^1^1^2930511^^
	;;^DD(162.7,15,23,1,0)
	;;=Only completed if disposition is DISAPPROVED.
	;;^DD(162.7,16,0)
	;;=*DISPOSITON DESCRIPTION^162.716^^1;0
	;;^DD(162.7,16,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,16,21,1,0)
	;;=The description of the disposition.  Replaced by the REASON FOR DISAPPROVAL field.
	;;^DD(162.7,16,"DT")
	;;=2930511
	;;^DD(162.7,17,0)
	;;=*REASON FOR PENDING^162.717^^2;0
	;;^DD(162.7,17,21,0)
	;;=^^2^2^2930511^^
	;;^DD(162.7,17,21,1,0)
	;;=The reason the claim was pending.  Replaced by the FEE BASIS UNAUTHORIZED
	;;^DD(162.7,17,21,2,0)
	;;=REQUESTED INFORMATION file (# 162.93).
	;;^DD(162.7,17,"DT")
	;;=2930511
	;;^DD(162.7,19,0)
	;;=PRINT LETTER?^S^1:YES;^0;16^Q
	;;^DD(162.7,19,1,0)
	;;=^.1^^-1
	;;^DD(162.7,19,1,1,0)
	;;=162.7^AL
	;;^DD(162.7,19,1,1,1)
	;;=S ^FB583("AL",$E(X,1,30),DA)=""
	;;^DD(162.7,19,1,1,2)
	;;=K ^FB583("AL",$E(X,1,30),DA)
	;;^DD(162.7,19,1,1,"%D",0)
	;;=^^1^1^2930702^^
	;;^DD(162.7,19,1,1,"%D",1,0)
	;;=Cross-reference is used to determine which claims need a letter printed.
	;;^DD(162.7,19,1,1,"DT")
	;;=2930403
	;;^DD(162.7,19,3)
	;;=Enter YES if letter needs to be printed.
	;;^DD(162.7,19,21,0)
	;;=^^1^1^2930511^^
	;;^DD(162.7,19,21,1,0)
	;;=If this field has a YES value, an unauthorized claim letter needs to be printed.
	;;^DD(162.7,19,23,0)
	;;=^^4^4^2930403^^
	;;^DD(162.7,19,23,1,0)
	;;=When the status or disposition changes, a letter needs to be printed.
	;;^DD(162.7,19,23,2,0)
	;;=Once printed, the expiration date is calculated.  The number of days is
	;;^DD(162.7,19,23,3,0)
	;;=derived from the status.

FBINI02H
FBINI02H	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,19,23,4,0)
	;;=This field is automatically updated.
	;;^DD(162.7,19,"DT")
	;;=2930405
	;;^DD(162.7,19.5,0)
	;;=DATE LETTER SENT^DX^^0;19^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,19.5,1,0)
	;;=^.1
	;;^DD(162.7,19.5,1,1,0)
	;;=162.7^ALP
	;;^DD(162.7,19.5,1,1,1)
	;;=S ^FB583("ALP",$E(X,1,30),DA)=""
	;;^DD(162.7,19.5,1,1,2)
	;;=K ^FB583("ALP",$E(X,1,30),DA)
	;;^DD(162.7,19.5,1,1,"%D",0)
	;;=^^2^2^2930403^
	;;^DD(162.7,19.5,1,1,"%D",1,0)
	;;=Cross-reference is used to determine if a letter has been printed.
	;;^DD(162.7,19.5,1,1,"%D",2,0)
	;;=It may be used to reprint letters.
	;;^DD(162.7,19.5,1,1,"DT")
	;;=2930403
	;;^DD(162.7,19.5,3)
	;;=Enter the date the follow-up or disposition letter was sent to submitter.  Date can not be in the future.
	;;^DD(162.7,19.5,21,0)
	;;=^^1^1^2930403^
	;;^DD(162.7,19.5,21,1,0)
	;;=Date letter sent to submitter.
	;;^DD(162.7,19.5,23,0)
	;;=^^4^4^2930403^
	;;^DD(162.7,19.5,23,1,0)
	;;=When the status or disposition changes, a letter needs to be printed.
	;;^DD(162.7,19.5,23,2,0)
	;;=Once printed, the expiration date is calculated.  The number of days is
	;;^DD(162.7,19.5,23,3,0)
	;;=derived from the status.
	;;^DD(162.7,19.5,23,4,0)
	;;=This field is automatically updated.
	;;^DD(162.7,19.5,"DT")
	;;=2930421
	;;^DD(162.7,20,0)
	;;=MASTER CLAIM^R*P162.7'^FB583(^0;20^S DIC("S")="S FBZ=^FB583(DA,0) I $P(^FB583(+Y,0),U,4)=$P(FBZ,U,4),'+$P(^FB583(+Y,0),U,11) K FBZ" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.7,20,1,0)
	;;=^.1
	;;^DD(162.7,20,1,1,0)
	;;=162.7^AMS^MUMPS
	;;^DD(162.7,20,1,1,1)
	;;=S:X'=DA ^FB583("AMS",X,DA)=""
	;;^DD(162.7,20,1,1,2)
	;;=K:X'=DA ^FB583("AMS",X,DA)
	;;^DD(162.7,20,1,1,"%D",0)
	;;=^^1^1^2930512^
	;;^DD(162.7,20,1,1,"%D",1,0)
	;;=Cross-reference secondary claims...those claims which point to another.
	;;^DD(162.7,20,1,1,"DT")
	;;=2930512
	;;^DD(162.7,20,1,2,0)
	;;=162.7^AMP^MUMPS
	;;^DD(162.7,20,1,2,1)
	;;=S:X=DA ^FB583("AMP",X,DA)=""
	;;^DD(162.7,20,1,2,2)
	;;=K:X=DA ^FB583("AMP",X,DA)
	;;^DD(162.7,20,1,2,"%D",0)
	;;=^^1^1^2930511^
	;;^DD(162.7,20,1,2,"%D",1,0)
	;;=Cross reference primary claims...those master claims which point to themselves.
	;;^DD(162.7,20,1,2,"DT")
	;;=2930511
	;;^DD(162.7,20,1,3,0)
	;;=162.7^AMC
	;;^DD(162.7,20,1,3,1)
	;;=S ^FB583("AMC",$E(X,1,30),DA)=""
	;;^DD(162.7,20,1,3,2)
	;;=K ^FB583("AMC",$E(X,1,30),DA)
	;;^DD(162.7,20,1,3,"%D",0)
	;;=^^1^1^2930512^
	;;^DD(162.7,20,1,3,"%D",1,0)
	;;=Cross-reference claims by master number for sorting.
	;;^DD(162.7,20,1,3,"DT")
	;;=2930512
	;;^DD(162.7,20,1,4,0)
	;;=162.7^APMS1^MUMPS
	;;^DD(162.7,20,1,4,1)
	;;=D MSIX^FBUCDD(X,DA,20,1,"APMS")
	;;^DD(162.7,20,1,4,2)
	;;=D MSIX^FBUCDD(X,DA,20,2,"APMS")
	;;^DD(162.7,20,1,4,"%D",0)
	;;=^^5^5^2930518^^
	;;^DD(162.7,20,1,4,"%D",1,0)
	;;=This cross-reference sets/kill the 'APMS' cross-reference.  It is used to
	;;^DD(162.7,20,1,4,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,20,1,4,"%D",3,0)
	;;=Fields involved are:  Patient, Master Claim and Status, having the
	;;^DD(162.7,20,1,4,"%D",4,0)
	;;=respective index of 'APMS', 'APMS1' or 'APMS2'.  In order to re-set the
	;;^DD(162.7,20,1,4,"%D",5,0)
	;;='APMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,20,1,4,"DT")
	;;=2930518
	;;^DD(162.7,20,1,5,0)
	;;=162.7^AVMS1^MUMPS
	;;^DD(162.7,20,1,5,1)
	;;=D MSIX^FBUCDD(X,DA,20,1,"AVMS")
	;;^DD(162.7,20,1,5,2)
	;;=D MSIX^FBUCDD(X,DA,20,2,"AVMS")
	;;^DD(162.7,20,1,5,"%D",0)
	;;=^^5^5^2930518^^
	;;^DD(162.7,20,1,5,"%D",1,0)
	;;=This cross-reference sets/kill the 'AVMS' cross-reference.  It is used to
	;;^DD(162.7,20,1,5,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,20,1,5,"%D",3,0)
	;;=Fields involved are:  Vendor, Master Claim and Status, having the
	;;^DD(162.7,20,1,5,"%D",4,0)
	;;=respective index of 'AVMS', 'AVMS1' or 'AVMS2'.  In order to re-set the
	;;^DD(162.7,20,1,5,"%D",5,0)
	;;='AVMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,20,1,5,"DT")
	;;=2930518
	;;^DD(162.7,20,1,6,0)
	;;=162.7^AOMS1^MUMPS

FBINI02I
FBINI02I	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,20,1,6,1)
	;;=D MSIX^FBUCDD(X,DA,20,1,"AOMS")
	;;^DD(162.7,20,1,6,2)
	;;=D MSIX^FBUCDD(X,DA,20,2,"AOMS")
	;;^DD(162.7,20,1,6,"%D",0)
	;;=^^5^5^2930518^
	;;^DD(162.7,20,1,6,"%D",1,0)
	;;=This cross-reference sets/kill the 'AOMS' cross-reference.  It is used to
	;;^DD(162.7,20,1,6,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,20,1,6,"%D",3,0)
	;;=Fields involved are:  Submitter, Master Claim and Status, having the
	;;^DD(162.7,20,1,6,"%D",4,0)
	;;=respective index of 'AOMS', 'AOMS1' or 'AOMS2'.  In order to re-set the
	;;^DD(162.7,20,1,6,"%D",5,0)
	;;='AOMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,20,1,6,"DT")
	;;=2930518
	;;^DD(162.7,20,3)
	;;=Enter the existing claim which this claim relates to.  If there is none, relate it to itself.
	;;^DD(162.7,20,12)
	;;=Select only those records containing the same veteran, having no dispostion.
	;;^DD(162.7,20,12.1)
	;;=S DIC("S")="S FBZ=^FB583(DA,0) I $P(^FB583(+Y,0),U,4)=$P(FBZ,U,4),'+$P(^FB583(+Y,0),U,11) K FBZ"
	;;^DD(162.7,20,21,0)
	;;=^^2^2^2930511^^
	;;^DD(162.7,20,21,1,0)
	;;=Enter the claim to which this claim is related.  It may be related to itself.
	;;^DD(162.7,20,21,2,0)
	;;=Select only those records containing the same veteran which have no disposition.
	;;^DD(162.7,20,23,0)
	;;=^^4^4^2930511^^
	;;^DD(162.7,20,23,1,0)
	;;=Automatically set upon entry of claim.  If claim submission involves
	;;^DD(162.7,20,23,2,0)
	;;=different fee programs for the same episode of care, claims entered
	;;^DD(162.7,20,23,3,0)
	;;=after the first for that episode of care will point to the first.
	;;^DD(162.7,20,23,4,0)
	;;=The first one becomes the 'master'.  Used for displaying claims.
	;;^DD(162.7,20,"DT")
	;;=2930521
	;;^DD(162.7,21,0)
	;;=REOPEN CLAIM DATE^D^^0;21^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.7,21,3)
	;;=Enter date dispositioned claim reopened (not appealed) for review.
	;;^DD(162.7,21,12)
	;;=Reopen those claims which do not have a disposition of APPROVED.
	;;^DD(162.7,21,12.1)
	;;=S DIC("S")="S FBZ=^FB583(DA,0) I $P(^FB583(+Y,0),U,4)=$P(FBZ,U,4),+$P(^(0),U,11)>1 K FBZ"
	;;^DD(162.7,21,21,0)
	;;=^^1^1^2930315^
	;;^DD(162.7,21,21,1,0)
	;;=Date dispositioned claim reopended for review.
	;;^DD(162.7,21,23,0)
	;;=^^2^2^2930403^
	;;^DD(162.7,21,23,1,0)
	;;=Automatically updated when claim is reopened.
	;;^DD(162.7,21,23,2,0)
	;;= (Edit template will stuff if action type is REOpen.)
	;;^DD(162.7,21,"DT")
	;;=2930315
	;;^DD(162.7,22,0)
	;;=DATE OF ORIGINAL DISPOSITION^DX^^0;22^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,22,3)
	;;=Enter date unauthorized claim was originally dispositioned.
	;;^DD(162.7,22,21,0)
	;;=^^2^2^2930318^
	;;^DD(162.7,22,21,1,0)
	;;=Date unauthorized claim was originally dispostioned.  Used in determining
	;;^DD(162.7,22,21,2,0)
	;;=expiration date in the case of appeal status'.
	;;^DD(162.7,22,23,0)
	;;=^^1^1^2930403^^
	;;^DD(162.7,22,23,1,0)
	;;=Automatically updated when status is determined.
	;;^DD(162.7,22,"DT")
	;;=2931015
	;;^DD(162.7,23,0)
	;;=CLAIM SUBMITTED BY^RVX^^0;23^Q:'$G(DA)  N FBZZ S FBZZ=23 K:$$INPUT^FBUCDD(DA,X,Y,FBZZ) X K FBZZ
	;;^DD(162.7,23,1,0)
	;;=^.1
	;;^DD(162.7,23,1,1,0)
	;;=162.7^AOS1^MUMPS
	;;^DD(162.7,23,1,1,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,24)&(X["VA(200") ^FB583("AOS",+X,$P(FBZ,U,24),DA)="" K FBZ
	;;^DD(162.7,23,1,1,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,24)&(X["VA(200") ^FB583("AOS",+X,$P(FBZ,U,24),DA)="" K FBZ
	;;^DD(162.7,23,1,1,"%D",0)
	;;=^^2^2^2930909^^^^
	;;^DD(162.7,23,1,1,"%D",1,0)
	;;=Cross-reference used to group claims by other party (new persons) and
	;;^DD(162.7,23,1,1,"%D",2,0)
	;;=status.
	;;^DD(162.7,23,1,1,"DT")
	;;=2930702
	;;^DD(162.7,23,1,2,0)
	;;=162.7^AOMS^MUMPS
	;;^DD(162.7,23,1,2,1)
	;;=D:X["VA(200" MSIX^FBUCDD(X,DA,23,1,"AOMS")
	;;^DD(162.7,23,1,2,2)
	;;=D:X["VA(200" MSIX^FBUCDD(X,DA,23,2,"AOMS")
	;;^DD(162.7,23,1,2,"%D",0)
	;;=^^5^5^2930909^^^^
	;;^DD(162.7,23,1,2,"%D",1,0)
	;;=This cross-reference sets/kill the 'AOMS' cross-reference.  It is used to

FBINI02J
FBINI02J	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,23,1,2,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,23,1,2,"%D",3,0)
	;;=Fields involved are:  Submitter, Master Claim and Status, having the
	;;^DD(162.7,23,1,2,"%D",4,0)
	;;=respective index of 'AOMS', 'AOMS1' or 'AOMS2'.  In order to re-set the
	;;^DD(162.7,23,1,2,"%D",5,0)
	;;='AOMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,23,1,2,"DT")
	;;=2930518
	;;^DD(162.7,23,3)
	;;=Identify the submitter of the Unauthorized Claim.  If the submitter is a vendor, must be same value as entered in the VENDOR field; if veteran, must be same as VETERAN field.
	;;^DD(162.7,23,21,0)
	;;=^^4^4^2930910^^^^
	;;^DD(162.7,23,21,1,0)
	;;=Identify the submitter of the unauthorized claim.  The submitter may differ
	;;^DD(162.7,23,21,2,0)
	;;=from the vendor or veteran involved with the claim.
	;;^DD(162.7,23,21,3,0)
	;;= If the submitter is a vendor, must be same value as entered in the VENDOR
	;;^DD(162.7,23,21,4,0)
	;;=field; if veteran, must be same as VETERAN field.
	;;^DD(162.7,23,23,0)
	;;=^^2^2^2930910^^^
	;;^DD(162.7,23,23,1,0)
	;;=The address for correspondence is determined from this field.  If there is
	;;^DD(162.7,23,23,2,0)
	;;=no entry, the default is the veteran's address.
	;;^DD(162.7,23,"DT")
	;;=2930910
	;;^DD(162.7,23,"V",0)
	;;=^.12P^3^3
	;;^DD(162.7,23,"V",1,0)
	;;=2^Patient^1^p^n^n
	;;^DD(162.7,23,"V",2,0)
	;;=161.2^Vendor^2^v^n^n
	;;^DD(162.7,23,"V",3,0)
	;;=200^Other party^3^o^n^n
	;;^DD(162.7,24,0)
	;;=STATUS^R*P162.92'X^FB(162.92,^0;24^S DIC("S")="I $P(^(0),U,2)" D ^DIC K DIC S DIC=DIE,X=+Y S FBZZ=24 K:$$INPUT^FBUCDD(DA,X,Y,FBZZ) X K FBZZ
	;;^DD(162.7,24,1,0)
	;;=^.1
	;;^DD(162.7,24,1,1,0)
	;;=162.7^ASD^MUMPS
	;;^DD(162.7,24,1,1,1)
	;;=S:$P(^FB583(DA,0),U,25) ^FB583("ASD",X,$P(^(0),U,25),DA)=""
	;;^DD(162.7,24,1,1,2)
	;;=K:$P(^FB583(DA,0),U,25) ^FB583("ASD",X,$P(^(0),U,25),DA)
	;;^DD(162.7,24,1,1,"%D",0)
	;;=^^1^1^2930301^
	;;^DD(162.7,24,1,1,"%D",1,0)
	;;=Cross reference by status, status date and record number.
	;;^DD(162.7,24,1,1,"DT")
	;;=2930301
	;;^DD(162.7,24,1,2,0)
	;;=162.7^APMS2^MUMPS
	;;^DD(162.7,24,1,2,1)
	;;=D MSIX^FBUCDD(X,DA,24,1,"APMS")
	;;^DD(162.7,24,1,2,2)
	;;=D MSIX^FBUCDD(X,DA,24,2,"APMS")
	;;^DD(162.7,24,1,2,"%D",0)
	;;=^^5^5^2930518^^
	;;^DD(162.7,24,1,2,"%D",1,0)
	;;=This cross-reference sets/kill the 'APMS' cross-reference.  It is used to
	;;^DD(162.7,24,1,2,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,24,1,2,"%D",3,0)
	;;=Fields involved are:  Patient, Master Claim and Status, having the
	;;^DD(162.7,24,1,2,"%D",4,0)
	;;=respective index of 'APMS', 'APMS1' or 'APMS2'.  In order to re-set the
	;;^DD(162.7,24,1,2,"%D",5,0)
	;;='APMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,24,1,2,"DT")
	;;=2930518
	;;^DD(162.7,24,1,3,0)
	;;=162.7^AES^MUMPS
	;;^DD(162.7,24,1,3,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,26) ^FB583("AES",$$ORDER^FBUCUTL(+X),-$P(FBZ,U,26),DA)="" K FBZ
	;;^DD(162.7,24,1,3,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) K:$P(FBZ,U,26) ^FB583("AES",$$ORDER^FBUCUTL(+X),-$P(FBZ,U,26),DA) K FBZ
	;;^DD(162.7,24,1,3,"%D",0)
	;;=^^1^1^2930706^^^^
	;;^DD(162.7,24,1,3,"%D",1,0)
	;;=Cross-reference by status order and inverse expiration date.
	;;^DD(162.7,24,1,3,"DT")
	;;=2930706
	;;^DD(162.7,24,1,4,0)
	;;=162.7^APS1^MUMPS
	;;^DD(162.7,24,1,4,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,4) ^FB583("APS",$P(FBZ,U,4),X,DA)="" K FBZ
	;;^DD(162.7,24,1,4,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) K:$P(FBZ,U,4) ^FB583("APS",$P(FBZ,U,4),X,DA) K FBZ
	;;^DD(162.7,24,1,4,"%D",0)
	;;=^^1^1^2930517^^^^
	;;^DD(162.7,24,1,4,"%D",1,0)
	;;=Cross-reference used to group claims by veteran (patient) and status.
	;;^DD(162.7,24,1,4,"DT")
	;;=2930702
	;;^DD(162.7,24,1,5,0)
	;;=162.7^AVS1^MUMPS
	;;^DD(162.7,24,1,5,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,3) ^FB583("AVS",$P(FBZ,U,3),X,DA)="" K FBZ
	;;^DD(162.7,24,1,5,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) K:$P(FBZ,U,3) ^FB583("AVS",$P(FBZ,U,3),X,DA) K FBZ
	;;^DD(162.7,24,1,5,"%D",0)
	;;=^^1^1^2930319^

FBINI02K
FBINI02K	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,24,1,5,"%D",1,0)
	;;=Cross-reference used to group claims by vendor and status.
	;;^DD(162.7,24,1,5,"DT")
	;;=2930702
	;;^DD(162.7,24,1,6,0)
	;;=162.7^AS
	;;^DD(162.7,24,1,6,1)
	;;=S ^FB583("AS",$E(X,1,30),DA)=""
	;;^DD(162.7,24,1,6,2)
	;;=K ^FB583("AS",$E(X,1,30),DA)
	;;^DD(162.7,24,1,6,"%D",0)
	;;=^^1^1^2930319^
	;;^DD(162.7,24,1,6,"%D",1,0)
	;;=Cross-refernece claims by status.
	;;^DD(162.7,24,1,6,"DT")
	;;=2930319
	;;^DD(162.7,24,1,7,0)
	;;=162.7^AOS^MUMPS
	;;^DD(162.7,24,1,7,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,23)["VA(200" ^FB583("AOS",+$P(FBZ,U,23),X,DA)="" K FBZ
	;;^DD(162.7,24,1,7,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) K:$P(FBZ,U,23)["VA(200" ^FB583("AOS",+$P(FBZ,U,23),X,DA) K FBZ
	;;^DD(162.7,24,1,7,"%D",0)
	;;=^^2^2^2930422^
	;;^DD(162.7,24,1,7,"%D",1,0)
	;;=Cross-reference used to group claims by other party (new persons) and
	;;^DD(162.7,24,1,7,"%D",2,0)
	;;=status.
	;;^DD(162.7,24,1,7,"DT")
	;;=2930702
	;;^DD(162.7,24,1,8,0)
	;;=162.7^AVMS2^MUMPS
	;;^DD(162.7,24,1,8,1)
	;;=D MSIX^FBUCDD(X,DA,24,1,"AVMS")
	;;^DD(162.7,24,1,8,2)
	;;=D MSIX^FBUCDD(X,DA,24,2,"AVMS")
	;;^DD(162.7,24,1,8,"%D",0)
	;;=^^5^5^2930518^^
	;;^DD(162.7,24,1,8,"%D",1,0)
	;;=This cross-reference sets/kill the 'AVMS' cross-reference.  It is used to
	;;^DD(162.7,24,1,8,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,24,1,8,"%D",3,0)
	;;=Fields involved are:  Vendor, Master Claim and Status, having the
	;;^DD(162.7,24,1,8,"%D",4,0)
	;;=respective index of 'AVMS', 'AVMS1' or 'AVMS2'.  In order to re-set the
	;;^DD(162.7,24,1,8,"%D",5,0)
	;;='AVMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,24,1,8,"DT")
	;;=2930518
	;;^DD(162.7,24,1,9,0)
	;;=162.7^AOMS2^MUMPS
	;;^DD(162.7,24,1,9,1)
	;;=D MSIX^FBUCDD(X,DA,24,1,"AOMS")
	;;^DD(162.7,24,1,9,2)
	;;=D MSIX^FBUCDD(X,DA,24,2,"AOMS")
	;;^DD(162.7,24,1,9,"%D",0)
	;;=^^5^5^2930518^
	;;^DD(162.7,24,1,9,"%D",1,0)
	;;=This cross-reference sets/kill the 'AOMS' cross-reference.  It is used to
	;;^DD(162.7,24,1,9,"%D",2,0)
	;;=display the relationship between primary/secondary claims.
	;;^DD(162.7,24,1,9,"%D",3,0)
	;;=Fields involved are:  Submitter, Master Claim and Status, having the
	;;^DD(162.7,24,1,9,"%D",4,0)
	;;=respective index of 'AOMS', 'AOMS1' or 'AOMS2'.  In order to re-set the
	;;^DD(162.7,24,1,9,"%D",5,0)
	;;='AOMS' index you only need to re-index ONE of these fields.
	;;^DD(162.7,24,1,9,"DT")
	;;=2930518
	;;^DD(162.7,24,3)
	;;=Select an active status for this unauthorized claim.
	;;^DD(162.7,24,12)
	;;=Allow selection of active status.
	;;^DD(162.7,24,12.1)
	;;=S DIC("S")="I $P(^(0),U,2)"
	;;^DD(162.7,24,21,0)
	;;=^^2^2^2930317^^
	;;^DD(162.7,24,21,1,0)
	;;=Select the appropriate status from FEE BASIS UNAUTHORIZED CLAIMS STATUS file.
	;;^DD(162.7,24,21,2,0)
	;;=Status is automatically determined and stuffed, it should not be edited.
	;;^DD(162.7,24,23,0)
	;;=5^^10^10^2930403^
	;;^DD(162.7,24,23,1,0)
	;;=Only active status' can be selected. <SCREEN>
	;;^DD(162.7,24,23,2,0)
	;;=If valid claim received, status should be greater than informal or returned.
	;;^DD(162.7,24,23,3,0)
	;;=If claim is dipositioned, status should only be dispositioned.
	;;^DD(162.7,24,23,4,0)
	;;=If claim has not been dispositioned, status should not be dispositioned.
	;;^DD(162.7,24,23,5,0)
	;;=  <INPUT TRANSFORM>
	;;^DD(162.7,24,23,6,0)
	;;=Status is automatically determined, based on the status order field in 162.92.
	;;^DD(162.7,24,23,7,0)
	;;=When the status or disposition changes, a letter needs to be printed.
	;;^DD(162.7,24,23,8,0)
	;;=Once printed, the expiration date is calculated.  The number of days is
	;;^DD(162.7,24,23,9,0)
	;;=derived from the status.
	;;^DD(162.7,24,23,10,0)
	;;=This field is automatically updated.
	;;^DD(162.7,24,"DT")
	;;=2930706
	;;^DD(162.7,25,0)
	;;=DATE OF CURRENT STATUS^RDX^^0;25^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,25,1,0)
	;;=^.1
	;;^DD(162.7,25,1,1,0)
	;;=162.7^ASD1^MUMPS
	;;^DD(162.7,25,1,1,1)
	;;=S:$P(^FB583(DA,0),U,24) ^FB583("ASD",$P(^(0),U,24),X,DA)=""

FBINI02L
FBINI02L	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,25,1,1,2)
	;;=K:$P(^FB583(DA,0),U,24) ^FB583("ASD",$P(^(0),U,24),X,DA)
	;;^DD(162.7,25,1,1,"%D",0)
	;;=^^1^1^2930301^
	;;^DD(162.7,25,1,1,"%D",1,0)
	;;=Cross reference by status, status date and record number.
	;;^DD(162.7,25,1,1,"DT")
	;;=2930301
	;;^DD(162.7,25,3)
	;;=Enter the date on which the current status was updated.
	;;^DD(162.7,25,21,0)
	;;=^^1^1^2930519^
	;;^DD(162.7,25,21,1,0)
	;;=This field contains the date on which the current status was entered or updated.
	;;^DD(162.7,25,"DT")
	;;=2931015
	;;^DD(162.7,26,0)
	;;=EXPIRATION DATE OF CLAIM^D^^0;26^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.7,26,1,0)
	;;=^.1
	;;^DD(162.7,26,1,1,0)
	;;=162.7^AES1^MUMPS
	;;^DD(162.7,26,1,1,1)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) S:$P(FBZ,U,24) ^FB583("AES",$$ORDER^FBUCUTL(+$P(FBZ,U,24)),-X,DA)="" K FBZ
	;;^DD(162.7,26,1,1,2)
	;;=N FBZ S FBZ=$$FBZ^FBUCUTL(DA) K:$P(FBZ,U,24) ^FB583("AES",$$ORDER^FBUCUTL(+$P(FBZ,U,24)),-X,DA) K FBZ
	;;^DD(162.7,26,1,1,"%D",0)
	;;=^^1^1^2930706^^^^
	;;^DD(162.7,26,1,1,"%D",1,0)
	;;=Cross-reference by status order and inverse expiration date.
	;;^DD(162.7,26,1,1,"DT")
	;;=2930706
	;;^DD(162.7,26,3)
	;;=Enter the date, if applicable, by which a response should be received.
	;;^DD(162.7,26,21,0)
	;;=^^6^6^2930511^
	;;^DD(162.7,26,21,1,0)
	;;=The date by which a response should be received before the claim expires.
	;;^DD(162.7,26,21,2,0)
	;;=If the expiration date arrives with no response, then the appropriate action
	;;^DD(162.7,26,21,3,0)
	;;=may need to be taken (action varies with status of claim).  No further
	;;^DD(162.7,26,21,4,0)
	;;=processing should be allowed.  (If awaiting information, claim should be
	;;^DD(162.7,26,21,5,0)
	;;=dispositioned to abandoned; if already dispostioned, appeal or BVA appeal
	;;^DD(162.7,26,21,6,0)
	;;=can not be entered.)  This field is automatically updated.
	;;^DD(162.7,26,23,0)
	;;=^^4^4^2930511^^
	;;^DD(162.7,26,23,1,0)
	;;=When the status or disposition changes, a letter needs to be printed.
	;;^DD(162.7,26,23,2,0)
	;;=Once printed, the expiration date is calculated.  The number of days is
	;;^DD(162.7,26,23,3,0)
	;;=derived from the status.
	;;^DD(162.7,26,23,4,0)
	;;=This field is automatically updated.
	;;^DD(162.7,26,"DT")
	;;=2930706
	;;^DD(162.7,27,0)
	;;=ENTERED/LAST EDITED BY^P200'^VA(200,^0;17^Q
	;;^DD(162.7,27,3)
	;;=Enter the person who entered the claim.
	;;^DD(162.7,27,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,27,21,1,0)
	;;=The name of the person who entered the claim.
	;;^DD(162.7,27,"DT")
	;;=2930731
	;;^DD(162.7,28,0)
	;;=DATE ENTERED/LAST EDITED^DX^^0;18^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,28,3)
	;;=Enter the date on which the claim was entered.
	;;^DD(162.7,28,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.7,28,21,1,0)
	;;=The date on which the unauthorized claim was entered.
	;;^DD(162.7,28,"DT")
	;;=2931015
	;;^DD(162.7,29,0)
	;;=DISCHARGE TYPE^CJ21,0^^ ; ^S X=$$DISCHTYP^FBUCDD(DA)
	;;^DD(162.7,29,9)
	;;=^
	;;^DD(162.7,29,9.01)
	;;=
	;;^DD(162.7,29,9.1)
	;;=S X=$$DISCHTYP^FBUCDD(DA)
	;;^DD(162.7,29,21,0)
	;;=^^1^1^2930527^
	;;^DD(162.7,29,21,1,0)
	;;=Display DISCHARGE TYPE of related entry in authorization subfile.
	;;^DD(162.7,29,23,0)
	;;=^^3^3^2930527^
	;;^DD(162.7,29,23,1,0)
	;;=Fee Basis Patient file (161), Authorization sub-file (161.01),
	;;^DD(162.7,29,23,2,0)
	;;=Discharge Type field (.06) is referenced is entry is found in the field's
	;;^DD(162.7,29,23,3,0)
	;;='AG' cross-reference.  The value of the set is displayed.
	;;^DD(162.7,29,"DT")
	;;=2930527
	;;^DD(162.7,30,0)
	;;=AUTHORIZATION^NJ5,0^^0;27^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.7,30,3)
	;;=Enter the authorization to which this unauthorized claim is related.
	;;^DD(162.7,30,21,0)
	;;=^^2^2^2941128^
	;;^DD(162.7,30,21,1,0)
	;;=This field is set to the internal entry number of the
	;;^DD(162.7,30,21,2,0)
	;;=appropriate authorization in file 161.
	;;^DD(162.7,30,"DT")
	;;=2930720
	;;^DD(162.7,50,0)
	;;=NOTICE OF DISAGREEMENT RECV'D^DX^^A;1^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,50,.1)
	;;=DATE NOTICE OF DISAGREEMENT RECV'D

FBINI02M
FBINI02M	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.7,50,3)
	;;=Enter date Notice of Agreement (VAF 21-4138) was received.
	;;^DD(162.7,50,21,0)
	;;=^^1^1^2930315^
	;;^DD(162.7,50,21,1,0)
	;;=Date Notice of Agreement (VAF 21-4138) received.
	;;^DD(162.7,50,"DT")
	;;=2931015
	;;^DD(162.7,51,0)
	;;=STATEMENT OF THE CASE ISSUED^DX^^A;2^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,51,.1)
	;;=DATE STATEMENT OF THE CASE ISSUED
	;;^DD(162.7,51,3)
	;;=Enter date Statement of the Case was issued.
	;;^DD(162.7,51,21,0)
	;;=^^1^1^2930315^
	;;^DD(162.7,51,21,1,0)
	;;=Date Statement of the Case was issued.
	;;^DD(162.7,51,"DT")
	;;=2931015
	;;^DD(162.7,52,0)
	;;=DATE SUBSTANTIVE APPEAL RECV'D^DX^^A;3^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,52,3)
	;;=Enter date Substantive Appeal (VAF 1-9) was received.
	;;^DD(162.7,52,21,0)
	;;=^^1^1^2930315^
	;;^DD(162.7,52,21,1,0)
	;;=Date Substantive Appeal was received.
	;;^DD(162.7,52,"DT")
	;;=2931015
	;;^DD(162.7,53,0)
	;;=DATE APPEAL DISPOSITIONED^DX^^A;4^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,53,3)
	;;=Enter date BVA decided appeal.
	;;^DD(162.7,53,21,0)
	;;=^^1^1^2930319^^^
	;;^DD(162.7,53,21,1,0)
	;;=Date appeal decision rendered by Board of Veterans Appeal (BVA).
	;;^DD(162.7,53,"DT")
	;;=2931015
	;;^DD(162.7,54,0)
	;;=DATE APPEALED TO COVA^DX^^A;5^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,54,3)
	;;=Enter date BVA decision was appealed to Court of Veteran Affairs (COVA).
	;;^DD(162.7,54,21,0)
	;;=^^2^2^2931008^^
	;;^DD(162.7,54,21,1,0)
	;;=Date Board of Veterans Appeal decision was appealed to Court of Veteran Affairs (COVA).
	;;^DD(162.7,54,21,2,0)
	;;=A timely appeal must be within 120 days of the BVA decision.
	;;^DD(162.7,54,"DT")
	;;=2931015
	;;^DD(162.7,55,0)
	;;=DATE COVA APPEAL DISPOSITIONED^DX^^A;6^S %DT="EX",%DT(0)=-DT D ^%DT K %DT S X=Y K:Y<1 X
	;;^DD(162.7,55,3)
	;;=Enter date a dispositon to a COVA appeal made.
	;;^DD(162.7,55,21,0)
	;;=^^1^1^2931008^^
	;;^DD(162.7,55,21,1,0)
	;;=Date a decision to a COVA appeal rendered.
	;;^DD(162.7,55,"DT")
	;;=2931015
	;;^DD(162.715,0)
	;;=REASON FOR DISAPPROVAL SUB-FIELD^^.01^1
	;;^DD(162.715,0,"DT")
	;;=2930401
	;;^DD(162.715,0,"IX","B",162.715,.01)
	;;=
	;;^DD(162.715,0,"NM","REASON FOR DISAPPROVAL")
	;;=
	;;^DD(162.715,0,"UP")
	;;=162.7
	;;^DD(162.715,.01,0)
	;;=REASON FOR DISAPPROVAL^M*P162.94'X^FB(162.94,^0;1^S DIC("S")="I $P(^(0),U,2)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.715,.01,1,0)
	;;=^.1
	;;^DD(162.715,.01,1,1,0)
	;;=162.715^B
	;;^DD(162.715,.01,1,1,1)
	;;=S ^FB583(DA(1),"D","B",$E(X,1,30),DA)=""
	;;^DD(162.715,.01,1,1,2)
	;;=K ^FB583(DA(1),"D","B",$E(X,1,30),DA)
	;;^DD(162.715,.01,3)
	;;=Identify the reason(s) why the unauthorized claim was disapproved.
	;;^DD(162.715,.01,12)
	;;=Select only active disapproval reasons if the unauthorized claim has a disposition of other than approved.
	;;^DD(162.715,.01,12.1)
	;;=S DIC("S")="I $P(^(0),U,2)"
	;;^DD(162.715,.01,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.715,.01,21,1,0)
	;;=Reason why claim was not approved.
	;;^DD(162.715,.01,23,0)
	;;=^^4^4^2930511^^
	;;^DD(162.715,.01,23,1,0)
	;;=Reason for disapproval is only prompted if the disposition type is other
	;;^DD(162.715,.01,23,2,0)
	;;= than APPROVED.
	;;^DD(162.715,.01,23,3,0)
	;;=If the disposition was changed to APPROVED, all disapproval reason will be
	;;^DD(162.715,.01,23,4,0)
	;;= deleted.
	;;^DD(162.715,.01,"DT")
	;;=2930402
	;;^DD(162.716,0)
	;;=*DISPOSITON DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(162.716,0,"NM","*DISPOSITON DESCRIPTION")
	;;=
	;;^DD(162.716,0,"UP")
	;;=162.7
	;;^DD(162.716,.01,0)
	;;=DISPOSITION DESCRIPTION^WL^^0;1^Q
	;;^DD(162.717,0)
	;;=*REASON FOR PENDING SUB-FIELD^^.01^1
	;;^DD(162.717,0,"NM","*REASON FOR PENDING")
	;;=
	;;^DD(162.717,0,"UP")
	;;=162.7
	;;^DD(162.717,.01,0)
	;;=REASON FOR PENDING^WL^^0;1^Q
	;;^DD(162.717,.01,"DT")
	;;=2900822

FBINI02N
FBINI02N	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.8)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.8,0,"GL")
	;;=^FBAA(162.8,
	;;^DIC("B","FEE BASIS UNAUTHORIZED CLAIMS PENDING INFO",162.8)
	;;=
	;;^DIC(162.8,"%D",0)
	;;=^^6^6^2940622^^
	;;^DIC(162.8,"%D",1,0)
	;;=This file contains the information requested on an incomplete claim.  The
	;;^DIC(162.8,"%D",2,0)
	;;=Unauthorized Claim can only move to the next status once all pending 
	;;^DIC(162.8,"%D",3,0)
	;;=information for a claim is received.  Each item which is pending is entered
	;;^DIC(162.8,"%D",4,0)
	;;=as a separate record into this file.
	;;^DIC(162.8,"%D",5,0)
	;;= 
	;;^DIC(162.8,"%D",6,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.8,0)
	;;=FIELD^^.07^7
	;;^DD(162.8,0,"DT")
	;;=2930303
	;;^DD(162.8,0,"IX","AC",162.8,.02)
	;;=
	;;^DD(162.8,0,"IX","ACD",162.8,.01)
	;;=
	;;^DD(162.8,0,"IX","ACD1",162.8,.02)
	;;=
	;;^DD(162.8,0,"IX","ACD2",162.8,.05)
	;;=
	;;^DD(162.8,0,"IX","AQ",162.8,.03)
	;;=
	;;^DD(162.8,0,"IX","AUI",162.8,.02)
	;;=
	;;^DD(162.8,0,"IX","AUI1",162.8,.03)
	;;=
	;;^DD(162.8,0,"IX","B",162.8,.01)
	;;=
	;;^DD(162.8,0,"NM","FEE BASIS UNAUTHORIZED CLAIMS PENDING INFO")
	;;=
	;;^DD(162.8,.01,0)
	;;=DATE INFORMATION REQUESTED^RD^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.8,.01,1,0)
	;;=^.1
	;;^DD(162.8,.01,1,1,0)
	;;=162.8^B
	;;^DD(162.8,.01,1,1,1)
	;;=S ^FBAA(162.8,"B",$E(X,1,30),DA)=""
	;;^DD(162.8,.01,1,1,2)
	;;=K ^FBAA(162.8,"B",$E(X,1,30),DA)
	;;^DD(162.8,.01,1,2,0)
	;;=162.8^ACD^MUMPS
	;;^DD(162.8,.01,1,2,1)
	;;=S:$P(^FBAA(162.8,DA,0),U,2)&('$P(^(0),U,5)) ^FBAA(162.8,"ACD",$P(^(0),U,2),X,DA)=""
	;;^DD(162.8,.01,1,2,2)
	;;=K:$P(^FBAA(162.8,DA,0),U,2) ^FBAA(162.8,"ACD",$P(^(0),U,2),X,DA)
	;;^DD(162.8,.01,1,2,"%D",0)
	;;=^^2^2^2930312^^^^
	;;^DD(162.8,.01,1,2,"%D",1,0)
	;;=Cross reference by claim number and request date, only if date information
	;;^DD(162.8,.01,1,2,"%D",2,0)
	;;=received is null.
	;;^DD(162.8,.01,1,2,"DT")
	;;=2930312
	;;^DD(162.8,.01,3)
	;;=Enter the date information was requested for completion of an unauthorized claim.
	;;^DD(162.8,.01,21,0)
	;;=^^1^1^2930519^^^^
	;;^DD(162.8,.01,21,1,0)
	;;=Date information was requested for completion of an unauthorized claim.
	;;^DD(162.8,.01,"DT")
	;;=2930312
	;;^DD(162.8,.02,0)
	;;=UNAUTHORIZED CLAIM^R*P162.7'^FB583(^0;2^S DIC("S")="S FBDFN=+$P($G(^FB583(DA,0)),U,4) I +$P(^FB583(Y,0),U,4)=FBDFN,'$P(^FB583(+Y,0),U,11) K FBDFN" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.8,.02,1,0)
	;;=^.1
	;;^DD(162.8,.02,1,1,0)
	;;=162.8^AC
	;;^DD(162.8,.02,1,1,1)
	;;=S ^FBAA(162.8,"AC",$E(X,1,30),DA)=""
	;;^DD(162.8,.02,1,1,2)
	;;=K ^FBAA(162.8,"AC",$E(X,1,30),DA)
	;;^DD(162.8,.02,1,1,"%D",0)
	;;=^^1^1^2930302^^
	;;^DD(162.8,.02,1,1,"%D",1,0)
	;;=Cross reference by unauthorized claim.
	;;^DD(162.8,.02,1,1,"DT")
	;;=2930301
	;;^DD(162.8,.02,1,2,0)
	;;=162.8^ACD1^MUMPS
	;;^DD(162.8,.02,1,2,1)
	;;=S:'$P(^FBAA(162.8,DA,0),U,5) ^FBAA(162.8,"ACD",X,$P(^(0),U),DA)=""
	;;^DD(162.8,.02,1,2,2)
	;;=K ^FBAA(162.8,"ACD",X,$P(^FBAA(162.8,DA,0),U),DA)
	;;^DD(162.8,.02,1,2,"%D",0)
	;;=^^2^2^2930302^^^
	;;^DD(162.8,.02,1,2,"%D",1,0)
	;;=Cross reference by claim number and request date, if date information
	;;^DD(162.8,.02,1,2,"%D",2,0)
	;;=received is null.
	;;^DD(162.8,.02,1,2,"DT")
	;;=2930302
	;;^DD(162.8,.02,1,3,0)
	;;=162.8^AUI^MUMPS
	;;^DD(162.8,.02,1,3,1)
	;;=S:$P(^FBAA(162.8,DA,0),U,3) ^FBAA(162.8,"AUI",X,$P(^FBAA(162.8,DA,0),U,3),DA)=""
	;;^DD(162.8,.02,1,3,2)
	;;=K:$P(^FBAA(162.8,DA,0),U,3) ^FBAA(162.8,"AUI",X,$P(^FBAA(162.8,DA,0),U,3),DA)
	;;^DD(162.8,.02,1,3,"%D",0)
	;;=^^1^1^2930616^^^
	;;^DD(162.8,.02,1,3,"%D",1,0)
	;;=Group pending information by unauthorized claim.
	;;^DD(162.8,.02,1,3,"DT")
	;;=2930616
	;;^DD(162.8,.02,3)
	;;=Select unauthorized claim for veteran.
	;;^DD(162.8,.02,12)
	;;=Display only those claims which have not been dispositioned.
	;;^DD(162.8,.02,12.1)
	;;=S DIC("S")="S FBDFN=+$P($G(^FB583(DA,0)),U,4) I +$P(^FB583(Y,0),U,4)=FBDFN,'$P(^FB583(+Y,0),U,11) K FBDFN"
	;;^DD(162.8,.02,21,0)
	;;=^^2^2^2930511^
	;;^DD(162.8,.02,21,1,0)
	;;=The unauthorized claim associated with the requested information.  Claim

FBINI02O
FBINI02O	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.8)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.8,.02,21,2,0)
	;;=must not have been dispostioned.
	;;^DD(162.8,.02,"DT")
	;;=2930616
	;;^DD(162.8,.03,0)
	;;=INFORMATION REQUESTED^R*P162.93'^FB(162.93,^0;3^S DIC("S")="I $P(^(0),U,2)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.8,.03,1,0)
	;;=^.1
	;;^DD(162.8,.03,1,1,0)
	;;=162.8^AQ
	;;^DD(162.8,.03,1,1,1)
	;;=S ^FBAA(162.8,"AQ",$E(X,1,30),DA)=""
	;;^DD(162.8,.03,1,1,2)
	;;=K ^FBAA(162.8,"AQ",$E(X,1,30),DA)
	;;^DD(162.8,.03,1,1,"%D",0)
	;;=^^1^1^2930408^
	;;^DD(162.8,.03,1,1,"%D",1,0)
	;;=Cross-reference used to determine if information already requested.
	;;^DD(162.8,.03,1,1,"DT")
	;;=2930408
	;;^DD(162.8,.03,1,2,0)
	;;=162.8^AUI1^MUMPS
	;;^DD(162.8,.03,1,2,1)
	;;=S:$P(^FBAA(162.8,DA,0),U,2) ^FBAA(162.8,"AUI",$P(^FBAA(162.8,DA,0),U,2),X,DA)=""
	;;^DD(162.8,.03,1,2,2)
	;;=K:$P(^FBAA(162.8,DA,0),U,2) ^FBAA(162.8,"AUI",$P(^FBAA(162.8,DA,0),U,2),X,DA)
	;;^DD(162.8,.03,1,2,"%D",0)
	;;=^^1^1^2930616^^
	;;^DD(162.8,.03,1,2,"%D",1,0)
	;;=Group pending information by unauthorized claim.
	;;^DD(162.8,.03,1,2,"DT")
	;;=2930616
	;;^DD(162.8,.03,3)
	;;=Select the information which is requested.
	;;^DD(162.8,.03,12)
	;;=Allow selection of active requested information.
	;;^DD(162.8,.03,12.1)
	;;=S DIC("S")="I $P(^(0),U,2)"
	;;^DD(162.8,.03,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.8,.03,21,1,0)
	;;=The information which is being requested.  Only active ones may be selected.
	;;^DD(162.8,.03,"DT")
	;;=2930616
	;;^DD(162.8,.04,0)
	;;=COMMENTS^F^^0;4^K:$L(X)>65!($L(X)<3) X
	;;^DD(162.8,.04,3)
	;;=Answer must be 3-65 characters in length.
	;;^DD(162.8,.04,21,0)
	;;=^^2^2^2931007^^
	;;^DD(162.8,.04,21,1,0)
	;;=The elaborated reason why information is being requested.  Should only be
	;;^DD(162.8,.04,21,2,0)
	;;=entered/displayed when information requested is OTHER.
	;;^DD(162.8,.04,23,0)
	;;=^^1^1^2931007^^
	;;^DD(162.8,.04,23,1,0)
	;;=This field will be prompted to the user whenever the reason is OTHER.
	;;^DD(162.8,.04,"DT")
	;;=2930224
	;;^DD(162.8,.05,0)
	;;=DATE INFORMATION RECEIVED^RDI^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(162.8,.05,1,0)
	;;=^.1^^-1
	;;^DD(162.8,.05,1,1,0)
	;;=162.8^ACD2^MUMPS
	;;^DD(162.8,.05,1,1,1)
	;;=K:$P(^FBAA(162.8,DA,0),U,2) ^FBAA(162.8,"ACD",$P(^(0),U,2),$P(^(0),U),DA)
	;;^DD(162.8,.05,1,1,2)
	;;=S:$P(^FBAA(162.8,DA,0),U,2) ^FBAA(162.8,"ACD",$P(^(0),U,2),$P(^(0),U),DA)=""
	;;^DD(162.8,.05,1,1,"%D",0)
	;;=^^4^4^2930302^^^
	;;^DD(162.8,.05,1,1,"%D",1,0)
	;;=Cross reference by claim number and request date, if date information
	;;^DD(162.8,.05,1,1,"%D",2,0)
	;;=received is null.  If it is not null, kill previously set cross-reference.
	;;^DD(162.8,.05,1,1,"%D",3,0)
	;;=Cross reference is to determine if there are any pending information for
	;;^DD(162.8,.05,1,1,"%D",4,0)
	;;=a claim.
	;;^DD(162.8,.05,1,1,"DT")
	;;=2930302
	;;^DD(162.8,.05,3)
	;;=Enter date the requested information was received.
	;;^DD(162.8,.05,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.8,.05,21,1,0)
	;;=The date the requested information was received.
	;;^DD(162.8,.05,"DT")
	;;=2930513
	;;^DD(162.8,.06,0)
	;;=RECEIVED BY^P200'^VA(200,^0;6^Q
	;;^DD(162.8,.06,3)
	;;=Enter user who received the information.
	;;^DD(162.8,.06,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.8,.06,21,1,0)
	;;=The user who received the information.
	;;^DD(162.8,.06,"DT")
	;;=2930224
	;;^DD(162.8,.07,0)
	;;=REQUESTED BY^P200'^VA(200,^0;7^Q
	;;^DD(162.8,.07,3)
	;;=Enter the user who requested the information.
	;;^DD(162.8,.07,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.8,.07,21,1,0)
	;;=The user who requested the information.
	;;^DD(162.8,.07,"DT")
	;;=2930224

FBINI02P
FBINI02P	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.91)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.91,0,"GL")
	;;=^FB(162.91,
	;;^DIC("B","FEE BASIS UNAUTHORIZED CLAIMS DISPOSITIONS",162.91)
	;;=
	;;^DIC(162.91,"%D",0)
	;;=^^6^6^2940714^^^^
	;;^DIC(162.91,"%D",1,0)
	;;=This file contains a listing of dispositions used in the Unauthorized
	;;^DIC(162.91,"%D",2,0)
	;;=Claims sub-module.  The description of the disposition is used as text
	;;^DIC(162.91,"%D",3,0)
	;;=in the unauthorized claim disposition letter.
	;;^DIC(162.91,"%D",4,0)
	;;=            *** ENTRIES SHOULD NOT BE ADDED TO THIS FILE ***
	;;^DIC(162.91,"%D",5,0)
	;;= 
	;;^DIC(162.91,"%D",6,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.91,0)
	;;=FIELD^^.03^5
	;;^DD(162.91,0,"DT")
	;;=2930526
	;;^DD(162.91,0,"IX","B",162.91,.01)
	;;=
	;;^DD(162.91,0,"NM","FEE BASIS UNAUTHORIZED CLAIMS DISPOSITIONS")
	;;=
	;;^DD(162.91,0,"PT",162.7,10)
	;;=
	;;^DD(162.91,.001,0)
	;;=NUMBER^NJ9,0^^ ^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.91,.001,3)
	;;=Type a Number between 1 and 999999999, 0 Decimal Digits
	;;^DD(162.91,.001,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.91,.001,21,1,0)
	;;=The internal entry number of the record in the file.
	;;^DD(162.91,.001,"DT")
	;;=2930304
	;;^DD(162.91,.01,0)
	;;=DISPOSITION^RFI^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
	;;^DD(162.91,.01,1,0)
	;;=^.1
	;;^DD(162.91,.01,1,1,0)
	;;=162.91^B
	;;^DD(162.91,.01,1,1,1)
	;;=S ^FB(162.91,"B",$E(X,1,30),DA)=""
	;;^DD(162.91,.01,1,1,2)
	;;=K ^FB(162.91,"B",$E(X,1,30),DA)
	;;^DD(162.91,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(162.91,.01,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.91,.01,21,1,0)
	;;=Enter the dispositon.
	;;^DD(162.91,.01,"DT")
	;;=2930304
	;;^DD(162.91,.02,0)
	;;=ACTIVE?^S^1:YES;^0;2^Q
	;;^DD(162.91,.02,3)
	;;=Indicate if disposition is active.
	;;^DD(162.91,.02,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.91,.02,21,1,0)
	;;=This field indicates if dispostion is active.
	;;^DD(162.91,.02,"DT")
	;;=2921102
	;;^DD(162.91,.03,0)
	;;=CODE^RF^^0;3^K:$L(X)>2!($L(X)<2) X
	;;^DD(162.91,.03,3)
	;;=Answer must be 2 characters in length.
	;;^DD(162.91,.03,21,0)
	;;=^^1^1^2930526^
	;;^DD(162.91,.03,21,1,0)
	;;=Code used to identify dispositioned status in outputs.
	;;^DD(162.91,.03,"DT")
	;;=2930526
	;;^DD(162.91,1,0)
	;;=DESCRIPTION^162.911^^1;0
	;;^DD(162.91,1,21,0)
	;;=^^3^3^2930511^
	;;^DD(162.91,1,21,1,0)
	;;=This field contains a detailed description of the disposition.
	;;^DD(162.91,1,21,2,0)
	;;=This description is used in the letter which prints when a claim
	;;^DD(162.91,1,21,3,0)
	;;=is dispositioned.
	;;^DD(162.911,0)
	;;=DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(162.911,0,"DT")
	;;=2921102
	;;^DD(162.911,0,"NM","DESCRIPTION")
	;;=
	;;^DD(162.911,0,"UP")
	;;=162.91
	;;^DD(162.911,.01,0)
	;;=DESCRIPTION^WL^^0;1^Q
	;;^DD(162.911,.01,"DT")
	;;=2921102

FBINI02Q
FBINI02Q	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(162.91)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,162.91)
	;;=^FB(162.91,
	;;^UTILITY(U,$J,162.91,0)
	;;=FEE BASIS UNAUTHORIZED CLAIMS DISPOSITIONS^162.91^5^5
	;;^UTILITY(U,$J,162.91,1,0)
	;;=APPROVED^1^AP
	;;^UTILITY(U,$J,162.91,1,1,0)
	;;=^^1^1^2940909^^
	;;^UTILITY(U,$J,162.91,1,1,1,0)
	;;=Claim has been approved for authorization of care and payment.
	;;^UTILITY(U,$J,162.91,2,0)
	;;=DISAPPROVED^1^DA
	;;^UTILITY(U,$J,162.91,2,1,0)
	;;=3^^12^12^2930521^^^
	;;^UTILITY(U,$J,162.91,2,1,1,0)
	;;=Claim has been disapproved.
	;;^UTILITY(U,$J,162.91,2,1,2,0)
	;;=  
	;;^UTILITY(U,$J,162.91,2,1,3,0)
	;;=Payment may be made only if all three of the following criteria are met:
	;;^UTILITY(U,$J,162.91,2,1,4,0)
	;;=(1)  Care or services were rendered for an adjudicated service-connected
	;;^UTILITY(U,$J,162.91,2,1,5,0)
	;;=disability or for any condition of a veteran who has been determined to be
	;;^UTILITY(U,$J,162.91,2,1,6,0)
	;;=totally and permanently disabled as a result of a service-connected
	;;^UTILITY(U,$J,162.91,2,1,7,0)
	;;=disabilty;  (2)  Care and services were rendered in a medical emergency
	;;^UTILITY(U,$J,162.91,2,1,8,0)
	;;=of such a nature that delay would have been hazardous to life or health;
	;;^UTILITY(U,$J,162.91,2,1,9,0)
	;;=(3)  VA or other federal facilities were not feasibly available.
	;;^UTILITY(U,$J,162.91,2,1,10,0)
	;;=  
	;;^UTILITY(U,$J,162.91,2,1,11,0)
	;;=The absence of any one of these criteria precludes payment by the 
	;;^UTILITY(U,$J,162.91,2,1,12,0)
	;;=US Department of Veteran Affairs.
	;;^UTILITY(U,$J,162.91,3,0)
	;;=CANCELLED/WITHDRAWN^1^CW
	;;^UTILITY(U,$J,162.91,3,1,0)
	;;=^^1^1^2930303^^^^
	;;^UTILITY(U,$J,162.91,3,1,1,0)
	;;=Claim has been cancelled.
	;;^UTILITY(U,$J,162.91,4,0)
	;;=APPROVED TO STABILIZATION^1^AS
	;;^UTILITY(U,$J,162.91,4,1,0)
	;;=^^6^6^2930429^^
	;;^UTILITY(U,$J,162.91,4,1,1,0)
	;;=Claim has been approved for authorization of care and payment authorized
	;;^UTILITY(U,$J,162.91,4,1,2,0)
	;;=up until the point the medical conditon has stabilized.
	;;^UTILITY(U,$J,162.91,4,1,3,0)
	;;=  
	;;^UTILITY(U,$J,162.91,4,1,4,0)
	;;=Since the medical condition had stabilized and VA facilities were feasibly
	;;^UTILITY(U,$J,162.91,4,1,5,0)
	;;=available for care, transfer to a VA medical center could have been safely
	;;^UTILITY(U,$J,162.91,4,1,6,0)
	;;=effected.  We may, therefore, pay for care only to that date.
	;;^UTILITY(U,$J,162.91,5,0)
	;;=ABANDONED^1^AB
	;;^UTILITY(U,$J,162.91,5,1,0)
	;;=^^2^2^2930310^
	;;^UTILITY(U,$J,162.91,5,1,1,0)
	;;=Claim is considered abandoned, since no action has been taken by the submitter
	;;^UTILITY(U,$J,162.91,5,1,2,0)
	;;=within the appropriate time frames.

FBINI02R
FBINI02R	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.92)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.92,0,"GL")
	;;=^FB(162.92,
	;;^DIC("B","FEE BASIS UNAUTHORIZED CLAIMS STATUS",162.92)
	;;=
	;;^DIC(162.92,"%D",0)
	;;=^^8^8^2940622^^^^
	;;^DIC(162.92,"%D",1,0)
	;;=Each unauthorized claim is assigned a status.  This file contains the
	;;^DIC(162.92,"%D",2,0)
	;;=possible status' which an unauthorized claim may be assigned.  Associated
	;;^DIC(162.92,"%D",3,0)
	;;=with a status is the status order.  This is the order in which a 
	;;^DIC(162.92,"%D",4,0)
	;;=claim may progress.  Also associated with each status is the number of days
	;;^DIC(162.92,"%D",5,0)
	;;=before the claim expires, if applicable.
	;;^DIC(162.92,"%D",6,0)
	;;=               *** ENTRIES SHOULD NOT BE ADDED TO THIS FILE ***
	;;^DIC(162.92,"%D",7,0)
	;;= 
	;;^DIC(162.92,"%D",8,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.92,0)
	;;=FIELD^^.05^7
	;;^DD(162.92,0,"DT")
	;;=2931007
	;;^DD(162.92,0,"IX","AO",162.92,.04)
	;;=
	;;^DD(162.92,0,"IX","B",162.92,.01)
	;;=
	;;^DD(162.92,0,"NM","FEE BASIS UNAUTHORIZED CLAIMS STATUS")
	;;=
	;;^DD(162.92,0,"PT",162.7,24)
	;;=
	;;^DD(162.92,.001,0)
	;;=NUMBER^NJ9,0^^ ^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.92,.001,3)
	;;=Type a Number between 1 and 999999999, 0 Decimal Digits
	;;^DD(162.92,.001,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.92,.001,21,1,0)
	;;=The internal entry number of the record in the file.
	;;^DD(162.92,.001,"DT")
	;;=2930304
	;;^DD(162.92,.01,0)
	;;=STATUS^RFI^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
	;;^DD(162.92,.01,1,0)
	;;=^.1
	;;^DD(162.92,.01,1,1,0)
	;;=162.92^B
	;;^DD(162.92,.01,1,1,1)
	;;=S ^FB(162.92,"B",$E(X,1,30),DA)=""
	;;^DD(162.92,.01,1,1,2)
	;;=K ^FB(162.92,"B",$E(X,1,30),DA)
	;;^DD(162.92,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(162.92,.01,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.92,.01,21,1,0)
	;;=This field contains the status of an unauthorized claim.
	;;^DD(162.92,.01,"DT")
	;;=2931008
	;;^DD(162.92,.02,0)
	;;=ACTIVE?^S^1:YES;^0;2^Q
	;;^DD(162.92,.02,3)
	;;=Indicate if the status is active.
	;;^DD(162.92,.02,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.92,.02,21,1,0)
	;;=This field indicates if the status is active.
	;;^DD(162.92,.02,"DT")
	;;=2921102
	;;^DD(162.92,.03,0)
	;;=DAYS PRIOR EXPIRATION^NJ3,0^^0;3^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.92,.03,3)
	;;=Enter the days which constitute a timely claim before proceeding to next status, if appropriate for a given status.
	;;^DD(162.92,.03,21,0)
	;;=^^2^2^2930511^^
	;;^DD(162.92,.03,21,1,0)
	;;=If filled in, allowable number of days a claim has before proceeding to the
	;;^DD(162.92,.03,21,2,0)
	;;=next status.
	;;^DD(162.92,.03,23,0)
	;;=^^4^4^2930315^^
	;;^DD(162.92,.03,23,1,0)
	;;=Expiration date field in file 162.7 is calculated using this date.
	;;^DD(162.92,.03,23,2,0)
	;;=Claims with a disposition staus of 5 (appeal pending) may vary, since the
	;;^DD(162.92,.03,23,3,0)
	;;=time period is remainder of year from date dispostitioned or 60 days
	;;^DD(162.92,.03,23,4,0)
	;;=from date statement of the case issued, whichever is greater.
	;;^DD(162.92,.03,"DT")
	;;=2930315
	;;^DD(162.92,.04,0)
	;;=STATUS ORDER^RNJ2,0X^^0;4^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N)!($D(^FB(162.92,"AO",X))) X
	;;^DD(162.92,.04,1,0)
	;;=^.1
	;;^DD(162.92,.04,1,1,0)
	;;=162.92^AO
	;;^DD(162.92,.04,1,1,1)
	;;=S ^FB(162.92,"AO",$E(X,1,30),DA)=""
	;;^DD(162.92,.04,1,1,2)
	;;=K ^FB(162.92,"AO",$E(X,1,30),DA)
	;;^DD(162.92,.04,1,1,"%D",0)
	;;=^^2^2^2930317^
	;;^DD(162.92,.04,1,1,"%D",1,0)
	;;=Cross-reference is used to determine the IEN of status, as well as
	;;^DD(162.92,.04,1,1,"%D",2,0)
	;;=existence of previous status order.
	;;^DD(162.92,.04,1,1,"DT")
	;;=2930317
	;;^DD(162.92,.04,3)
	;;=Type a whole number between 1 and 99.  The number represents the sequential order of the status.  It must be unique.
	;;^DD(162.92,.04,21,0)
	;;=^^2^2^2930511^^
	;;^DD(162.92,.04,21,1,0)
	;;=A whole number which represents the sequential order of the status. 
	;;^DD(162.92,.04,21,2,0)
	;;=Entry must be unique.  Software controls status, based on this value.

FBINI02S
FBINI02S	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.92)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(162.92,.04,"DT")
	;;=2930317
	;;^DD(162.92,.05,0)
	;;=LETTER^*P161.3'^FBAA(161.3,^0;5^S DIC("S")="I $P(^(0),U,2)=1" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(162.92,.05,3)
	;;=The letter associated with this status.
	;;^DD(162.92,.05,12)
	;;=Only unauthorized claim letters are selectable.
	;;^DD(162.92,.05,12.1)
	;;=S DIC("S")="I $P(^(0),U,2)=1"
	;;^DD(162.92,.05,21,0)
	;;=^^3^3^2930522^
	;;^DD(162.92,.05,21,1,0)
	;;=This field is a pointer to file 161.3, Fee Basis Letter.  A letter will be
	;;^DD(162.92,.05,21,2,0)
	;;=printed if there is an entry in this field.  Only unauthorized claim type
	;;^DD(162.92,.05,21,3,0)
	;;=letters are selectable.
	;;^DD(162.92,.05,"DEL",.05,0)
	;;=I 1 W !,"Letters are not deletable."
	;;^DD(162.92,.05,"DT")
	;;=2931007
	;;^DD(162.92,1,0)
	;;=DESCRIPTION^162.921^^1;0
	;;^DD(162.92,1,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.92,1,21,1,0)
	;;=This field contains the detailed description of the status.
	;;^DD(162.921,0)
	;;=DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(162.921,0,"DT")
	;;=2921102
	;;^DD(162.921,0,"NM","DESCRIPTION")
	;;=
	;;^DD(162.921,0,"UP")
	;;=162.92
	;;^DD(162.921,.01,0)
	;;=DESCRIPTION^WL^^0;1^Q
	;;^DD(162.921,.01,"DT")
	;;=2921102

FBINI02T
FBINI02T	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(162.92)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,162.92)
	;;=^FB(162.92,
	;;^UTILITY(U,$J,162.92,0)
	;;=FEE BASIS UNAUTHORIZED CLAIMS STATUS^162.92^11^11
	;;^UTILITY(U,$J,162.92,1,0)
	;;=INCOMPLETE UNAUTHORIZED CLAIM^1^366^10^
	;;^UTILITY(U,$J,162.92,1,1,0)
	;;=^^3^3^2930513^^^
	;;^UTILITY(U,$J,162.92,1,1,1,0)
	;;=Unauthorized claim is not complete, and therefore invalid.  Claim is
	;;^UTILITY(U,$J,162.92,1,1,2,0)
	;;=considered incomplete and cannot proceed to the next status, 
	;;^UTILITY(U,$J,162.92,1,1,3,0)
	;;=COMPLETE/PENDING REVIEW, until all the requested information has been received.
	;;^UTILITY(U,$J,162.92,2,0)
	;;=PENDING - REASON UNKNOWN^^^20
	;;^UTILITY(U,$J,162.92,2,1,0)
	;;=^^4^4^2930310^^^^
	;;^UTILITY(U,$J,162.92,2,1,1,0)
	;;=Prior to version 3 of FEE, Unauthorized Claims could have been pending
	;;^UTILITY(U,$J,162.92,2,1,2,0)
	;;=for either additional information from the requestor or medical review or
	;;^UTILITY(U,$J,162.92,2,1,3,0)
	;;=other reason.  Any unauthorized claim having this inactive status should
	;;^UTILITY(U,$J,162.92,2,1,4,0)
	;;=be updated to an active status.
	;;^UTILITY(U,$J,162.92,3,0)
	;;=COMPLETE/PENDING REVIEW^1^^30
	;;^UTILITY(U,$J,162.92,3,1,0)
	;;=^^3^3^2930513^^^^
	;;^UTILITY(U,$J,162.92,3,1,1,0)
	;;=Unauthorized claim is pending disposition upon completion
	;;^UTILITY(U,$J,162.92,3,1,2,0)
	;;=of legal/medical/PSA review.  A claim is updated to this status if it is
	;;^UTILITY(U,$J,162.92,3,1,3,0)
	;;=received as complete, or edited and no requested information is outstanding.
	;;^UTILITY(U,$J,162.92,4,0)
	;;=DISPOSITIONED^1^366^40^
	;;^UTILITY(U,$J,162.92,4,1,0)
	;;=^^1^1^2930310^^^^
	;;^UTILITY(U,$J,162.92,4,1,1,0)
	;;=Unauthorized claim has been dispositioned.
	;;^UTILITY(U,$J,162.92,5,0)
	;;=APPEAL/NOTICE OF DISAGREE RECV^1^^50
	;;^UTILITY(U,$J,162.92,5,1,0)
	;;=^^7^7^2930513^^^^
	;;^UTILITY(U,$J,162.92,5,1,1,0)
	;;=The disposition of the unauthorized claim is being appealed.
	;;^UTILITY(U,$J,162.92,5,1,2,0)
	;;=The notice of disagreement letter has been received by the submitter
	;;^UTILITY(U,$J,162.92,5,1,3,0)
	;;=of the appeal.  The statement of the case must be issued and a response
	;;^UTILITY(U,$J,162.92,5,1,4,0)
	;;=received before the appeal can be complete for review.
	;;^UTILITY(U,$J,162.92,5,1,5,0)
	;;=The appeal application is incomplete.
	;;^UTILITY(U,$J,162.92,5,1,6,0)
	;;=  
	;;^UTILITY(U,$J,162.92,5,1,7,0)
	;;=Entry of NOTICE OF AGREEMENT RECV'D will trigger this status.
	;;^UTILITY(U,$J,162.92,6,0)
	;;=APPEAL COMPLETE/PENDING REVIEW^1^^60
	;;^UTILITY(U,$J,162.92,6,1,0)
	;;=^^3^3^2930513^^^^
	;;^UTILITY(U,$J,162.92,6,1,1,0)
	;;=The appeal to the unauthorized claim is complete and pending review.
	;;^UTILITY(U,$J,162.92,6,1,2,0)
	;;=  
	;;^UTILITY(U,$J,162.92,6,1,3,0)
	;;=Entry of DATE SUBSTANTIVE APPEAL RECV'D will trigger this status.
	;;^UTILITY(U,$J,162.92,7,0)
	;;=APPEAL DISPOSITIONED^1^121^70^
	;;^UTILITY(U,$J,162.92,7,1,0)
	;;=^^3^3^2930513^^
	;;^UTILITY(U,$J,162.92,7,1,1,0)
	;;=The appeal to the unauthorized claim has been dispostioned.
	;;^UTILITY(U,$J,162.92,7,1,2,0)
	;;=  
	;;^UTILITY(U,$J,162.92,7,1,3,0)
	;;=Entry of DATE APPEAL DISPOSITIONED will trigger this status.
	;;^UTILITY(U,$J,162.92,8,0)
	;;=COVA APPEAL^1^^80
	;;^UTILITY(U,$J,162.92,8,1,0)
	;;=^^4^4^2931008^^^^
	;;^UTILITY(U,$J,162.92,8,1,1,0)
	;;=The decision by the Board of Veterans Appeals (BVA) is being appealed
	;;^UTILITY(U,$J,162.92,8,1,2,0)
	;;=to the Court of Veterans Affairs (COVA).
	;;^UTILITY(U,$J,162.92,8,1,3,0)
	;;=  
	;;^UTILITY(U,$J,162.92,8,1,4,0)
	;;=Entry of DATE APPEALED TO COVA will trigger this status.
	;;^UTILITY(U,$J,162.92,9,0)
	;;=COVA DISPOSITION^1^^90^
	;;^UTILITY(U,$J,162.92,9,1,0)
	;;=^^4^4^2931008^^^^
	;;^UTILITY(U,$J,162.92,9,1,1,0)
	;;=The decision by the Court of Veterans Affairs has been made, and the COVA
	;;^UTILITY(U,$J,162.92,9,1,2,0)
	;;=appeal of the Board of Veterans Appeals (BVA) appeal has been dispositioned.
	;;^UTILITY(U,$J,162.92,9,1,3,0)
	;;=  
	;;^UTILITY(U,$J,162.92,9,1,4,0)
	;;=Entry of DATE COVA APPEAL DISPOSITONED will trigger this status.

FBINI02U
FBINI02U	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(162.92)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,162.92,10,0)
	;;=APPEAL/ISSUED STATMENT OF CASE^1^366^55
	;;^UTILITY(U,$J,162.92,10,1,0)
	;;=^^6^6^2930513^^
	;;^UTILITY(U,$J,162.92,10,1,1,0)
	;;=The statement of the case has been issued to the submitter.  A response
	;;^UTILITY(U,$J,162.92,10,1,2,0)
	;;=must be submitted within the appropriate time frame for the appeal to be
	;;^UTILITY(U,$J,162.92,10,1,3,0)
	;;=considered.
	;;^UTILITY(U,$J,162.92,10,1,4,0)
	;;=The appeal is considered incomplete for review until the response is received.
	;;^UTILITY(U,$J,162.92,10,1,5,0)
	;;=  
	;;^UTILITY(U,$J,162.92,10,1,6,0)
	;;=Entry of STATEMENT OF THE CASE ISSUED will trigger this status.
	;;^UTILITY(U,$J,162.92,11,0)
	;;=INITAL ENTRY^1^^5
	;;^UTILITY(U,$J,162.92,11,1,0)
	;;=^^8^8^2930708^
	;;^UTILITY(U,$J,162.92,11,1,1,0)
	;;=The unauthorized claim has been received at the facility, but is pending 
	;;^UTILITY(U,$J,162.92,11,1,2,0)
	;;=review to determine if the claim is complete, in which case it would
	;;^UTILITY(U,$J,162.92,11,1,3,0)
	;;=progress to COMPLETE/PENDING REVIEW status, or if further information is
	;;^UTILITY(U,$J,162.92,11,1,4,0)
	;;=required, in which case it would progress to INCOMPLETE status.
	;;^UTILITY(U,$J,162.92,11,1,5,0)
	;;=A claim in this status, INITIAL ENTRY, is not currently being acted upon.
	;;^UTILITY(U,$J,162.92,11,1,6,0)
	;;=  
	;;^UTILITY(U,$J,162.92,11,1,7,0)
	;;=A parameter in the FEE BASIS SITE PARAMTERES file determines if this status
	;;^UTILITY(U,$J,162.92,11,1,8,0)
	;;=is used.  The activation of the status will override the parameter.

FBINI02V
FBINI02V	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.93)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.93,0,"GL")
	;;=^FB(162.93,
	;;^DIC("B","FEE BASIS UNAUTHORIZED REQUESTED INFORMATION",162.93)
	;;=
	;;^DIC(162.93,"%D",0)
	;;=^^6^6^2940622^^^^
	;;^DIC(162.93,"%D",1,0)
	;;=Data contained in this file pertains to information needed in order 
	;;^DIC(162.93,"%D",2,0)
	;;=to process an unauthorized claim.  Sites have the ability to add local entries.
	;;^DIC(162.93,"%D",3,0)
	;;=The description of the requested information is printed as part of the text
	;;^DIC(162.93,"%D",4,0)
	;;=in the letter which is mailed to the submitter requesting the information.
	;;^DIC(162.93,"%D",5,0)
	;;= 
	;;^DIC(162.93,"%D",6,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.93,0)
	;;=FIELD^^.001^4
	;;^DD(162.93,0,"DDA")
	;;=N
	;;^DD(162.93,0,"DT")
	;;=2930317
	;;^DD(162.93,0,"IX","B",162.93,.01)
	;;=
	;;^DD(162.93,0,"NM","FEE BASIS UNAUTHORIZED REQUESTED INFORMATION")
	;;=
	;;^DD(162.93,0,"PT",162.8,.03)
	;;=
	;;^DD(162.93,.001,0)
	;;=NUMBER^NJ9,0^^ ^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.93,.001,3)
	;;=Type a Number between 1 and 999999999, 0 Decimal Digits
	;;^DD(162.93,.001,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.93,.001,21,1,0)
	;;=This field contains the internal entry number of the record in this file.
	;;^DD(162.93,.001,"DT")
	;;=2930304
	;;^DD(162.93,.01,0)
	;;=REASON^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
	;;^DD(162.93,.01,1,0)
	;;=^.1
	;;^DD(162.93,.01,1,1,0)
	;;=162.93^B
	;;^DD(162.93,.01,1,1,1)
	;;=S ^FB(162.93,"B",$E(X,1,30),DA)=""
	;;^DD(162.93,.01,1,1,2)
	;;=K ^FB(162.93,"B",$E(X,1,30),DA)
	;;^DD(162.93,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(162.93,.01,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.93,.01,21,1,0)
	;;=This field contains the requested information.
	;;^DD(162.93,.01,"DT")
	;;=2930310
	;;^DD(162.93,.02,0)
	;;=ACTIVE?^S^1:YES;^0;2^Q
	;;^DD(162.93,.02,3)
	;;=Indicate if the requested information is active.
	;;^DD(162.93,.02,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.93,.02,21,1,0)
	;;=This field indicates if the requested information is active.
	;;^DD(162.93,.02,"DT")
	;;=2921102
	;;^DD(162.93,1,0)
	;;=DESCRIPTION^162.931^^1;0
	;;^DD(162.93,1,21,0)
	;;=^^3^3^2930511^
	;;^DD(162.93,1,21,1,0)
	;;=This field contains a detailed description of the requested information.
	;;^DD(162.93,1,21,2,0)
	;;=The description is printed as part of the text of the letter whenever 
	;;^DD(162.93,1,21,3,0)
	;;=information is requested.
	;;^DD(162.93,1,22)
	;;=%
	;;^DD(162.931,0)
	;;=DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(162.931,0,"DT")
	;;=2921102
	;;^DD(162.931,0,"NM","DESCRIPTION")
	;;=
	;;^DD(162.931,0,"UP")
	;;=162.93
	;;^DD(162.931,.01,0)
	;;=DESCRIPTION^WL^^0;1^Q
	;;^DD(162.931,.01,"DT")
	;;=2921102

FBINI02W
FBINI02W	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.94)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.94,0,"GL")
	;;=^FB(162.94,
	;;^DIC("B","FEE BASIS UNAUTHORIZED DISAPPROVAL REASONS",162.94)
	;;=
	;;^DIC(162.94,"%",0)
	;;=^1.005
	;;^DIC(162.94,"%D",0)
	;;=^^6^6^2940622^^^^
	;;^DIC(162.94,"%D",1,0)
	;;=This file contains various reasons why the claim was disapproved.  
	;;^DIC(162.94,"%D",2,0)
	;;=The description of the disapproval reason is entered as part of the text
	;;^DIC(162.94,"%D",3,0)
	;;=in the disposition letter which is mailed to the submitter of the claim.
	;;^DIC(162.94,"%D",4,0)
	;;=               *** ENTRIES SHOULD NOT BE ADDED TO THIS FILE ***
	;;^DIC(162.94,"%D",5,0)
	;;= 
	;;^DIC(162.94,"%D",6,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.94,0)
	;;=FIELD^^.001^4
	;;^DD(162.94,0,"DDA")
	;;=N
	;;^DD(162.94,0,"DT")
	;;=2930511
	;;^DD(162.94,0,"IX","B",162.94,.01)
	;;=
	;;^DD(162.94,0,"NM","FEE BASIS UNAUTHORIZED DISAPPROVAL REASONS")
	;;=
	;;^DD(162.94,0,"PT",162.715,.01)
	;;=
	;;^DD(162.94,.001,0)
	;;=NUMBER^NJ9,0^^ ^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(162.94,.001,3)
	;;=Type a Number between 1 and 999999999, 0 Decimal Digits
	;;^DD(162.94,.001,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.94,.001,21,1,0)
	;;=This field contains the internal entry number of the record in the file.
	;;^DD(162.94,.001,"DT")
	;;=2930304
	;;^DD(162.94,.01,0)
	;;=NAME^RFI^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
	;;^DD(162.94,.01,1,0)
	;;=^.1
	;;^DD(162.94,.01,1,1,0)
	;;=162.94^B
	;;^DD(162.94,.01,1,1,1)
	;;=S ^FB(162.94,"B",$E(X,1,30),DA)=""
	;;^DD(162.94,.01,1,1,2)
	;;=K ^FB(162.94,"B",$E(X,1,30),DA)
	;;^DD(162.94,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(162.94,.01,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.94,.01,21,1,0)
	;;=This field contains the disapproval reason.
	;;^DD(162.94,.01,"DT")
	;;=2930511
	;;^DD(162.94,.02,0)
	;;=ACTIVE?^S^1:YES;^0;2^Q
	;;^DD(162.94,.02,3)
	;;=Indicate if disapproval reason is active.
	;;^DD(162.94,.02,21,0)
	;;=^^1^1^2930511^
	;;^DD(162.94,.02,21,1,0)
	;;=This field indicates if the disapproval reason is active.
	;;^DD(162.94,.02,"DT")
	;;=2930224
	;;^DD(162.94,1,0)
	;;=DESCRIPTION^162.941^^1;0
	;;^DD(162.94,1,21,0)
	;;=^^4^4^2930519^^
	;;^DD(162.94,1,21,1,0)
	;;=This field contains a detailed description of the disapproval reason.
	;;^DD(162.94,1,21,2,0)
	;;=The description may appear as part of the text in a letter when an
	;;^DD(162.94,1,21,3,0)
	;;=unauthorized claim is dispositioned.  It will appear only if REASON FOR
	;;^DD(162.94,1,21,4,0)
	;;=DISAPPROVAL has data.
	;;^DD(162.941,0)
	;;=DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(162.941,0,"DT")
	;;=2930224
	;;^DD(162.941,0,"NM","DESCRIPTION")
	;;=
	;;^DD(162.941,0,"UP")
	;;=162.94
	;;^DD(162.941,.01,0)
	;;=DESCRIPTION^W^^0;1^Q
	;;^DD(162.941,.01,"DT")
	;;=2930224

FBINI02X
FBINI02X	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(162.94)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,162.94)
	;;=^FB(162.94,
	;;^UTILITY(U,$J,162.94,0)
	;;=FEE BASIS UNAUTHORIZED DISAPPROVAL REASONS^162.94^7^7
	;;^UTILITY(U,$J,162.94,1,0)
	;;=NSC VETERAN^1
	;;^UTILITY(U,$J,162.94,1,1,0)
	;;=^^1^1^2930224^
	;;^UTILITY(U,$J,162.94,1,1,1,0)
	;;=Veteran has no service connected disabilities.
	;;^UTILITY(U,$J,162.94,2,0)
	;;=NSC CONDITION^1
	;;^UTILITY(U,$J,162.94,2,1,0)
	;;=^^3^3^2930429^^
	;;^UTILITY(U,$J,162.94,2,1,1,0)
	;;=Medical treatment was for non-service connected condition which was
	;;^UTILITY(U,$J,162.94,2,1,2,0)
	;;=clinically determined not an adjunct condition to the service connected
	;;^UTILITY(U,$J,162.94,2,1,3,0)
	;;=disability.
	;;^UTILITY(U,$J,162.94,3,0)
	;;=NON-EMERGENT CARE^1
	;;^UTILITY(U,$J,162.94,3,1,0)
	;;=^^3^3^2930429^^
	;;^UTILITY(U,$J,162.94,3,1,1,0)
	;;=A medical emergency must have existed.  Care and services were not rendered
	;;^UTILITY(U,$J,162.94,3,1,2,0)
	;;=in a medical emergency of such nature that delay would have been hazardous
	;;^UTILITY(U,$J,162.94,3,1,3,0)
	;;=to life or health.
	;;^UTILITY(U,$J,162.94,4,0)
	;;=VA FACILITIES AVAILABLE^1
	;;^UTILITY(U,$J,162.94,4,1,0)
	;;=^^1^1^2930429^^
	;;^UTILITY(U,$J,162.94,4,1,1,0)
	;;=VA facilities were feasibly available to provide the care.
	;;^UTILITY(U,$J,162.94,5,0)
	;;=PREVIOUSLY AUTHORIZED^1
	;;^UTILITY(U,$J,162.94,5,1,0)
	;;=^^1^1^2930310^^
	;;^UTILITY(U,$J,162.94,5,1,1,0)
	;;=Claim was previously authorized.
	;;^UTILITY(U,$J,162.94,6,0)
	;;=NOT TIMELY FILED^1
	;;^UTILITY(U,$J,162.94,6,1,0)
	;;=^^6^6^2930506^^^^
	;;^UTILITY(U,$J,162.94,6,1,1,0)
	;;=Claim needs to be submitted within the appropriate time frame after care
	;;^UTILITY(U,$J,162.94,6,1,2,0)
	;;=or services were rendered, or previous claim denied.
	;;^UTILITY(U,$J,162.94,6,1,3,0)
	;;=  
	;;^UTILITY(U,$J,162.94,6,1,4,0)
	;;=TWO YEARS:  Within two years after care or services were rendered, (if continuous care, date claim filed) or date the veteran was notified by VA of the allowance of the award of service-connection.
	;;^UTILITY(U,$J,162.94,6,1,5,0)
	;;=  
	;;^UTILITY(U,$J,162.94,6,1,6,0)
	;;=ONE YEAR:   Appeal of a previous denied claim must be filed within one year of disapproval.
	;;^UTILITY(U,$J,162.94,7,0)
	;;=ADJUDICATION REQUESTED^1
	;;^UTILITY(U,$J,162.94,7,1,0)
	;;=^^7^7^2930429^
	;;^UTILITY(U,$J,162.94,7,1,1,0)
	;;=We have asked for adjudicative rating action to determine whether the
	;;^UTILITY(U,$J,162.94,7,1,2,0)
	;;=condition treated was due to or caused by your service-connected disability.
	;;^UTILITY(U,$J,162.94,7,1,3,0)
	;;=You will be notified by the VA Regional Office when they have reached a
	;;^UTILITY(U,$J,162.94,7,1,4,0)
	;;=decision.  If service connection is granted for the condition treated,
	;;^UTILITY(U,$J,162.94,7,1,5,0)
	;;=please resubmit a claim to us with a copy of this letter and a copy of the
	;;^UTILITY(U,$J,162.94,7,1,6,0)
	;;=award letter received from the VA Regional Office.  Such rating
	;;^UTILITY(U,$J,162.94,7,1,7,0)
	;;=determinations normally require 60-90 days.

FBINI02Y
FBINI02Y	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(162.95)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.95,0,"GL")
	;;=^FB(162.95,
	;;^DIC("B","FEE BASIS CHECK CANCELLATION REASON",162.95)
	;;=
	;;^DIC(162.95,"%D",0)
	;;=^^6^6^2940714^^^^
	;;^DIC(162.95,"%D",1,0)
	;;=This file stores the check cancellation reasons and codes used by the
	;;^DIC(162.95,"%D",2,0)
	;;=Financial Management System (FMS).  These reasons will be returned to
	;;^DIC(162.95,"%D",3,0)
	;;=the site from FMS when a check is cancelled.  This file will be pointed
	;;^DIC(162.95,"%D",4,0)
	;;=to by all payment files.
	;;^DIC(162.95,"%D",5,0)
	;;= 
	;;^DIC(162.95,"%D",6,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(162.95,0)
	;;=FIELD^^2^3
	;;^DD(162.95,0,"DDA")
	;;=N
	;;^DD(162.95,0,"DT")
	;;=2940308
	;;^DD(162.95,0,"IX","B",162.95,.01)
	;;=
	;;^DD(162.95,0,"IX","C",162.95,1)
	;;=
	;;^DD(162.95,0,"NM","FEE BASIS CHECK CANCELLATION REASON")
	;;=
	;;^DD(162.95,0,"PT",162.03,37)
	;;=
	;;^DD(162.95,0,"PT",162.04,11)
	;;=
	;;^DD(162.95,0,"PT",162.11,32)
	;;=
	;;^DD(162.95,0,"PT",162.5,50)
	;;=
	;;^DD(162.95,.01,0)
	;;=CANCELLATION REASON^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
	;;^DD(162.95,.01,1,0)
	;;=^.1
	;;^DD(162.95,.01,1,1,0)
	;;=162.95^B
	;;^DD(162.95,.01,1,1,1)
	;;=S ^FB(162.95,"B",$E(X,1,30),DA)=""
	;;^DD(162.95,.01,1,1,2)
	;;=K ^FB(162.95,"B",$E(X,1,30),DA)
	;;^DD(162.95,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(162.95,.01,21,0)
	;;=^^2^2^2941128^
	;;^DD(162.95,.01,21,1,0)
	;;=This reason is passed back from the treasury when a
	;;^DD(162.95,.01,21,2,0)
	;;=check has been cancelled.
	;;^DD(162.95,.01,"DT")
	;;=2940308
	;;^DD(162.95,1,0)
	;;=REASON CODE^RF^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>1!($L(X)<1) X
	;;^DD(162.95,1,1,0)
	;;=^.1
	;;^DD(162.95,1,1,1,0)
	;;=162.95^C
	;;^DD(162.95,1,1,1,1)
	;;=S ^FB(162.95,"C",$E(X,1,30),DA)=""
	;;^DD(162.95,1,1,1,2)
	;;=K ^FB(162.95,"C",$E(X,1,30),DA)
	;;^DD(162.95,1,1,1,"%D",0)
	;;=^^2^2^2940308^
	;;^DD(162.95,1,1,1,"%D",1,0)
	;;=Cross-reference used to look up check cancellation reason on the reason
	;;^DD(162.95,1,1,1,"%D",2,0)
	;;=code provided by the Financial Management System (FMS).
	;;^DD(162.95,1,1,1,"DT")
	;;=2940308
	;;^DD(162.95,1,3)
	;;=Answer must be 1 character in length.
	;;^DD(162.95,1,21,0)
	;;=^^2^2^2941128^
	;;^DD(162.95,1,21,1,0)
	;;=This is the actual code that is passed back from Austin
	;;^DD(162.95,1,21,2,0)
	;;=when a check has been cancelled.
	;;^DD(162.95,1,"DT")
	;;=2940308
	;;^DD(162.95,2,0)
	;;=INACTIVATION FLAG^S^1:INACTIVE;^0;3^Q
	;;^DD(162.95,2,21,0)
	;;=^^2^2^2941128^
	;;^DD(162.95,2,21,1,0)
	;;=This field was added to this file in the event that the
	;;^DD(162.95,2,21,2,0)
	;;=treasury decides to stop using a code.
	;;^DD(162.95,2,"DT")
	;;=2940308

FBINI02Z
FBINI02Z	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(162.95)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,162.95)
	;;=^FB(162.95,
	;;^UTILITY(U,$J,162.95,0)
	;;=FEE BASIS CHECK CANCELLATION REASON^162.95^11^11
	;;^UTILITY(U,$J,162.95,1,0)
	;;=BETTER ADDRESS^B
	;;^UTILITY(U,$J,162.95,2,0)
	;;=DUPLICATE PAYMENT^D
	;;^UTILITY(U,$J,162.95,3,0)
	;;=DECEASED^E
	;;^UTILITY(U,$J,162.95,4,0)
	;;=PAYMENT ID^I
	;;^UTILITY(U,$J,162.95,5,0)
	;;=NOT ENTITLED^N
	;;^UTILITY(U,$J,162.95,6,0)
	;;=SUPPLIES/SERVICES CANCELLED^O
	;;^UTILITY(U,$J,162.95,7,0)
	;;=PARTIAL WRONG PAYEE^P
	;;^UTILITY(U,$J,162.95,8,0)
	;;=MIS-SPELLED NAME^S
	;;^UTILITY(U,$J,162.95,9,0)
	;;=UNKNOWN^U
	;;^UTILITY(U,$J,162.95,10,0)
	;;=WRONG PAYEE^W
	;;^UTILITY(U,$J,162.95,11,0)
	;;=CONVERSION CANCEL REASON^X

FBINI030
FBINI030	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(163.85)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(163.85,0,"GL")
	;;=^FBAA(163.85,
	;;^DIC("B","FEE BASIS VA TYPE OF SERVICE",163.85)
	;;=
	;;^DIC(163.85,"%D",0)
	;;=^^4^4^2940622^^
	;;^DIC(163.85,"%D",1,0)
	;;=This file is controlled by the program office and will be used for
	;;^DIC(163.85,"%D",2,0)
	;;=helping sites do cost analysis.
	;;^DIC(163.85,"%D",3,0)
	;;= 
	;;^DIC(163.85,"%D",4,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(163.85,0)
	;;=FIELD^^1^3
	;;^DD(163.85,0,"DT")
	;;=2920610
	;;^DD(163.85,0,"ID",.02)
	;;=W "   ",$P(^(0),U,2)
	;;^DD(163.85,0,"IX","B",163.85,.01)
	;;=
	;;^DD(163.85,0,"IX","C",163.85,.02)
	;;=
	;;^DD(163.85,0,"NM","FEE BASIS VA TYPE OF SERVICE")
	;;=
	;;^DD(163.85,0,"PT",162.03,29)
	;;=
	;;^DD(163.85,.01,0)
	;;=NAME^RF^^0;1^K:$L(X)>50!($L(X)<3)!'(X'?1P.E) X
	;;^DD(163.85,.01,1,0)
	;;=^.1
	;;^DD(163.85,.01,1,1,0)
	;;=163.85^B
	;;^DD(163.85,.01,1,1,1)
	;;=S ^FBAA(163.85,"B",$E(X,1,30),DA)=""
	;;^DD(163.85,.01,1,1,2)
	;;=K ^FBAA(163.85,"B",$E(X,1,30),DA)
	;;^DD(163.85,.01,3)
	;;=Answer must be 3-50 characters in length.
	;;^DD(163.85,.01,21,0)
	;;=^^10^10^2930519^^^
	;;^DD(163.85,.01,21,1,0)
	;;=VA Type of Service Codes are codes that have been created to track
	;;^DD(163.85,.01,21,2,0)
	;;="types" of medical services provided to fee basis patients so
	;;^DD(163.85,.01,21,3,0)
	;;=that a cost analysis can be completed.  With this information we can
	;;^DD(163.85,.01,21,4,0)
	;;=compare outpatient VA costs to outpatient fee basis costs for "types"
	;;^DD(163.85,.01,21,5,0)
	;;=of care provided.  When assigning the VA Type of Service Code we are
	;;^DD(163.85,.01,21,6,0)
	;;=trying to "group" types of VA outpatient care which is recorded by
	;;^DD(163.85,.01,21,7,0)
	;;=outpatient stop code and are reflected in the Cost Distribution
	;;^DD(163.85,.01,21,8,0)
	;;=Report(CDR).  When uncertain of what fee basis VA Type of Service
	;;^DD(163.85,.01,21,9,0)
	;;=code to use - determine how you would designate the care provided
	;;^DD(163.85,.01,21,10,0)
	;;=if you were recording VA outpatient treatment.
	;;^DD(163.85,.01,23,0)
	;;=^^2^2^2920609^
	;;^DD(163.85,.01,23,1,0)
	;;=This file is populated by Medical Administration in Central Office.
	;;^DD(163.85,.01,23,2,0)
	;;=It is sent out with data and should not be added to by the sites.
	;;^DD(163.85,.01,"DT")
	;;=2920609
	;;^DD(163.85,.02,0)
	;;=VA CODE^RF^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>2!($L(X)<2) X
	;;^DD(163.85,.02,1,0)
	;;=^.1
	;;^DD(163.85,.02,1,1,0)
	;;=163.85^C
	;;^DD(163.85,.02,1,1,1)
	;;=S ^FBAA(163.85,"C",$E(X,1,30),DA)=""
	;;^DD(163.85,.02,1,1,2)
	;;=K ^FBAA(163.85,"C",$E(X,1,30),DA)
	;;^DD(163.85,.02,1,1,"%D",0)
	;;=^^2^2^2920610^
	;;^DD(163.85,.02,1,1,"%D",1,0)
	;;=This cross-reference will allow the user to select the VA Type of
	;;^DD(163.85,.02,1,1,"%D",2,0)
	;;=Service by VA Code.
	;;^DD(163.85,.02,1,1,"DT")
	;;=2920610
	;;^DD(163.85,.02,3)
	;;=Answer must be 2 characters in length.
	;;^DD(163.85,.02,21,0)
	;;=^^2^2^2920610^
	;;^DD(163.85,.02,21,1,0)
	;;=This field contains the two character code which is sent with the
	;;^DD(163.85,.02,21,2,0)
	;;=payment record to Central Fee in Austin.
	;;^DD(163.85,.02,23,0)
	;;=^^2^2^2920610^
	;;^DD(163.85,.02,23,1,0)
	;;=This is a two byte numeric field containing padded leading zeros.
	;;^DD(163.85,.02,23,2,0)
	;;=It is sent with the payment data to Central Fee in Austin.
	;;^DD(163.85,.02,"DT")
	;;=2920610
	;;^DD(163.85,1,0)
	;;=DESCRIPTION^163.851^^1;0
	;;^DD(163.85,1,21,0)
	;;=^^2^2^2930519^^
	;;^DD(163.85,1,21,1,0)
	;;=This field contains a detailed explanation of the VA Type of Service
	;;^DD(163.85,1,21,2,0)
	;;=Code.
	;;^DD(163.85,1,23,0)
	;;=^^2^2^2920609^
	;;^DD(163.85,1,23,1,0)
	;;=This description will be used to help the user determine the most
	;;^DD(163.85,1,23,2,0)
	;;=appropriate code to select for a service provided.
	;;^DD(163.851,0)
	;;=DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(163.851,0,"DT")
	;;=2920609
	;;^DD(163.851,0,"NM","DESCRIPTION")
	;;=
	;;^DD(163.851,0,"UP")
	;;=163.85
	;;^DD(163.851,.01,0)
	;;=DESCRIPTION^WL^^0;1^Q
	;;^DD(163.851,.01,"DT")
	;;=2920609

FBINI031
FBINI031	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(163.85)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q

FBINI032
FBINI032	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(163.85)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,163.85)
	;;=^FBAA(163.85,
	;;^UTILITY(U,$J,163.85,0)
	;;=FEE BASIS VA TYPE OF SERVICE^163.85I^15^14
	;;^UTILITY(U,$J,163.85,1,0)
	;;=GENERAL MEDICINE^01
	;;^UTILITY(U,$J,163.85,1,1,0)
	;;=^^6^6^2920611^^
	;;^UTILITY(U,$J,163.85,1,1,1,0)
	;;=Includes general medicine evaluation and treatment, allergy and
	;;^UTILITY(U,$J,163.85,1,1,2,0)
	;;=immunology, cardiology, dermatology, endocrine disorders,
	;;^UTILITY(U,$J,163.85,1,1,3,0)
	;;=gastroenterology, hematology, hypertension, infectious diseases,
	;;^UTILITY(U,$J,163.85,1,1,4,0)
	;;=pacemaker follow-up, pulmonary-chest, renal-nephrology disorders,
	;;^UTILITY(U,$J,163.85,1,1,5,0)
	;;=rheumatology-arthritis, neurology, oncology-tumor, and geriatric
	;;^UTILITY(U,$J,163.85,1,1,6,0)
	;;=clinics.  Equates to CDR account 2110.00.
	;;^UTILITY(U,$J,163.85,2,0)
	;;=DIAGNOSTIC^02
	;;^UTILITY(U,$J,163.85,2,1,0)
	;;=^^4^4^2941024^^^
	;;^UTILITY(U,$J,163.85,2,1,1,0)
	;;=Includes diagnostic testing such as pulmonary function, laboratory,
	;;^UTILITY(U,$J,163.85,2,1,2,0)
	;;=radiology, EEG, EKG, nuclear medicine, evoked potential, 
	;;^UTILITY(U,$J,163.85,2,1,3,0)
	;;=topographical brain monitoring, prolonged video EEG and ultrasound.
	;;^UTILITY(U,$J,163.85,2,1,4,0)
	;;=Equates to CDR account 2612.00.
	;;^UTILITY(U,$J,163.85,3,0)
	;;=ANCILLARY^03
	;;^UTILITY(U,$J,163.85,3,1,0)
	;;=^^2^2^2920609^
	;;^UTILITY(U,$J,163.85,3,1,1,0)
	;;=Includes nursing, dietetics and nutrition and social work
	;;^UTILITY(U,$J,163.85,3,1,2,0)
	;;=services.  Equates to CDR account 2610.00.
	;;^UTILITY(U,$J,163.85,4,0)
	;;=ROUTINE AMBULATORY PROCEDURES^04
	;;^UTILITY(U,$J,163.85,4,1,0)
	;;=^^7^7^2920609^
	;;^UTILITY(U,$J,163.85,4,1,1,0)
	;;=Includes the following clinics/treatment and performance of routine
	;;^UTILITY(U,$J,163.85,4,1,2,0)
	;;=procedures as follows:  anesthesia pre-op, neurosurgery, gynecology,
	;;^UTILITY(U,$J,163.85,4,1,3,0)
	;;=ophthalmology, optometry, ENT, plastic surgery, hand surgery, orthopedics,
	;;^UTILITY(U,$J,163.85,4,1,4,0)
	;;=podiatry, thoracic surgery, urology, vascular surgery, pain clinic,
	;;^UTILITY(U,$J,163.85,4,1,5,0)
	;;=vascular lab, and cast application and removal.  Includes the general
	;;^UTILITY(U,$J,163.85,4,1,6,0)
	;;=clinic visit and completion of procedures which are not considered
	;;^UTILITY(U,$J,163.85,4,1,7,0)
	;;=to be Nationally Active by the VA.  Equates to CDR account 2210.00.
	;;^UTILITY(U,$J,163.85,6,0)
	;;=DENTAL^05
	;;^UTILITY(U,$J,163.85,6,1,0)
	;;=^^2^2^2920615^^
	;;^UTILITY(U,$J,163.85,6,1,1,0)
	;;=Includes dental examinations and treatments.  Equates to CDR
	;;^UTILITY(U,$J,163.85,6,1,2,0)
	;;=account 2710.00.
	;;^UTILITY(U,$J,163.85,7,0)
	;;=DRUG, ALCOHOL, and/or SUBSTANCE ABUSE^06
	;;^UTILITY(U,$J,163.85,7,1,0)
	;;=^^2^2^2920615^^
	;;^UTILITY(U,$J,163.85,7,1,1,0)
	;;=Includes drug, alcohol, and/or substance abuse or dependence
	;;^UTILITY(U,$J,163.85,7,1,2,0)
	;;=treatment or counseling.  Equates to CDR account 2316.00.
	;;^UTILITY(U,$J,163.85,8,0)
	;;=REHABILITATIVE MEDICINE^07
	;;^UTILITY(U,$J,163.85,8,1,0)
	;;=^^3^3^2920615^^
	;;^UTILITY(U,$J,163.85,8,1,1,0)
	;;=Includes rehabilitative medicine, audiology, speach pathology,
	;;^UTILITY(U,$J,163.85,8,1,2,0)
	;;=physical therapy, occupational therapy, EMG, corrective therapy,
	;;^UTILITY(U,$J,163.85,8,1,3,0)
	;;=and amputation follow-up.  Equates to CDR account 2611.00.
	;;^UTILITY(U,$J,163.85,9,0)
	;;=PSYCHIATRY/PSYCHOLOGY, GROUP^08
	;;^UTILITY(U,$J,163.85,9,1,0)
	;;=^^2^2^2920611^^
	;;^UTILITY(U,$J,163.85,9,1,1,0)
	;;=Includes any group therapy (including Post Traumatic Stress
	;;^UTILITY(U,$J,163.85,9,1,2,0)
	;;=Disorder [PTSD]).  Equates to CDR account 2310.00.
	;;^UTILITY(U,$J,163.85,10,0)
	;;=PSYCHIATRY/PSYCHOLOGY, INDIVIDUAL^09
	;;^UTILITY(U,$J,163.85,10,1,0)
	;;=^^2^2^2920611^^
	;;^UTILITY(U,$J,163.85,10,1,1,0)
	;;=Includes any individual therapy, including PTSD.  Equates
	;;^UTILITY(U,$J,163.85,10,1,2,0)
	;;=to CDR account 2311.00.
	;;^UTILITY(U,$J,163.85,11,0)
	;;=DIALYSIS^10
	;;^UTILITY(U,$J,163.85,11,1,0)
	;;=^^4^4^2920609^

FBINI033
FBINI033	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQR(163.85)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,163.85,11,1,1,0)
	;;=Includes, but is not limited to, hemodialysis, peritoneal
	;;^UTILITY(U,$J,163.85,11,1,2,0)
	;;=dialysis, limited self-care dialysis, home hemodialysis
	;;^UTILITY(U,$J,163.85,11,1,3,0)
	;;=training, and limited self peritoneal dialysis.  Equates
	;;^UTILITY(U,$J,163.85,11,1,4,0)
	;;=to CDR account 2510.00.
	;;^UTILITY(U,$J,163.85,12,0)
	;;=ADULT DAY HEALTH CARE^11
	;;^UTILITY(U,$J,163.85,12,1,0)
	;;=^^3^3^2920609^
	;;^UTILITY(U,$J,163.85,12,1,1,0)
	;;=Includes VA approved adult day health care programs which provide
	;;^UTILITY(U,$J,163.85,12,1,2,0)
	;;=medical and rehabilitation services.  Equates to CDR account
	;;^UTILITY(U,$J,163.85,12,1,3,0)
	;;=2510.00.
	;;^UTILITY(U,$J,163.85,13,0)
	;;=PROSTETICS/ORTHOTICS^12
	;;^UTILITY(U,$J,163.85,13,1,0)
	;;=^^4^4^2920609^
	;;^UTILITY(U,$J,163.85,13,1,1,0)
	;;=Includes prosthetic services as a follow-up from an amputation,
	;;^UTILITY(U,$J,163.85,13,1,2,0)
	;;=measuring and fitting for a prosthetic device or instruction
	;;^UTILITY(U,$J,163.85,13,1,3,0)
	;;=regarding use of a prosthetic device.  Equates to CDR account
	;;^UTILITY(U,$J,163.85,13,1,4,0)
	;;=2614.00.
	;;^UTILITY(U,$J,163.85,14,0)
	;;=HOME BASED HEALTH CARE^13
	;;^UTILITY(U,$J,163.85,14,1,0)
	;;=^^5^5^2920609^
	;;^UTILITY(U,$J,163.85,14,1,1,0)
	;;=Includes health care provided in the home (include home health
	;;^UTILITY(U,$J,163.85,14,1,2,0)
	;;=and home nursing services).  This equates to CDR account 5110.00
	;;^UTILITY(U,$J,163.85,14,1,3,0)
	;;=which is used for VACO approved Home Based Health Care programs.
	;;^UTILITY(U,$J,163.85,14,1,4,0)
	;;=Only facilities who have a VACO approved HBHC program should use
	;;^UTILITY(U,$J,163.85,14,1,5,0)
	;;=this VA Type of Care code.
	;;^UTILITY(U,$J,163.85,15,0)
	;;=OTHER^99
	;;^UTILITY(U,$J,163.85,15,1,0)
	;;=^^2^2^2920609^
	;;^UTILITY(U,$J,163.85,15,1,1,0)
	;;=Types of non-VA outpatient care that cannot be "categorized"
	;;^UTILITY(U,$J,163.85,15,1,2,0)
	;;=consistent with the reporting of VA outpatient treatment.

FBINI034
FBINI034	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(163.99)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(163.99,0,"GL")
	;;=^FBAA(163.99,
	;;^DIC("B","FEE BASIS FEE SCHEDULE",163.99)
	;;=
	;;^DIC(163.99,"%D",0)
	;;=^^5^5^2940622^^^^
	;;^DIC(163.99,"%D",1,0)
	;;=This file stores the default amount paid for outpatient medical
	;;^DIC(163.99,"%D",2,0)
	;;=payments. It is populated using the fee schedule option found on
	;;^DIC(163.99,"%D",3,0)
	;;=the supervisor menu.
	;;^DIC(163.99,"%D",4,0)
	;;= 
	;;^DIC(163.99,"%D",5,0)
	;;=Per VHA Directive 10-93-142, this file definition should not be modified.
	;;^DD(163.99,0)
	;;=FIELD^^1^2
	;;^DD(163.99,0,"DT")
	;;=2940627
	;;^DD(163.99,0,"ID","WRITE")
	;;=D WRITE^FBAAPAA
	;;^DD(163.99,0,"IX","B",163.99,.01)
	;;=
	;;^DD(163.99,0,"NM","FEE BASIS FEE SCHEDULE")
	;;=
	;;^DD(163.99,.01,0)
	;;=CPT CODE-MODIFIER^RFX^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<5)!('(X?5AN)&'(X?5AN1"-"2AN)) X I $D(X) D INPUT^FBAAUTL5
	;;^DD(163.99,.01,1,0)
	;;=^.1
	;;^DD(163.99,.01,1,1,0)
	;;=163.99^B
	;;^DD(163.99,.01,1,1,1)
	;;=S ^FBAA(163.99,"B",$E(X,1,30),DA)=""
	;;^DD(163.99,.01,1,1,2)
	;;=K ^FBAA(163.99,"B",$E(X,1,30),DA)
	;;^DD(163.99,.01,3)
	;;=Answer must be 5-8 characters in length.  Answer must be a valid CPT code or valid CPT code followed by a dash (-) followed by a valid CPT Modifier.   Eg. 90050, 74020-26
	;;^DD(163.99,.01,21,0)
	;;=^^3^3^2940627^^
	;;^DD(163.99,.01,21,1,0)
	;;=This file contains historical cost statistics which will
	;;^DD(163.99,.01,21,2,0)
	;;=be used to calculate the Fee Schedule. This data is compiled by
	;;^DD(163.99,.01,21,3,0)
	;;=running the FBAA FEE SCHEDULE option.
	;;^DD(163.99,.01,23,0)
	;;=^^2^2^2940627^
	;;^DD(163.99,.01,23,1,0)
	;;=This field is free text.  However, the input transform checks for the
	;;^DD(163.99,.01,23,2,0)
	;;=validity of the CPT Code or CPT Code-Modifier combination.
	;;^DD(163.99,.01,"DT")
	;;=2940906
	;;^DD(163.99,1,0)
	;;=FISCAL YEAR^163.991^^FY;0
	;;^DD(163.99,1,21,0)
	;;=^^2^2^2890322^^^
	;;^DD(163.99,1,21,1,0)
	;;=This is a multiple field that will allow for the storage
	;;^DD(163.99,1,21,2,0)
	;;=of historical costing data by fiscal year.
	;;^DD(163.991,0)
	;;=FISCAL YEAR SUB-FIELD^^7^6
	;;^DD(163.991,0,"IX","AC",163.991,.01)
	;;=
	;;^DD(163.991,0,"NM","FISCAL YEAR")
	;;=
	;;^DD(163.991,0,"UP")
	;;=163.99
	;;^DD(163.991,.01,0)
	;;=FISCAL YEAR^RNJ4,0X^^0;1^K:+X'=X!(X>9999)!(X<1900)!(X?.E1"."1N.N)!(X>(1900+($E(DT,2,3)+$S($E(DT,4,5)>9:1,1:0)))) X S:$D(X) DINUM=X
	;;^DD(163.991,.01,1,0)
	;;=^.1
	;;^DD(163.991,.01,1,1,0)
	;;=163.991^AC^MUMPS
	;;^DD(163.991,.01,1,1,1)
	;;=S ^FBAA(163.99,"AC",$E(X,1,30),DA)=""
	;;^DD(163.991,.01,1,1,2)
	;;=K ^FBAA(163.99,"AC",$E(X,1,30),DA)
	;;^DD(163.991,.01,3)
	;;=Type a Number between 1900 and 9999, 0 Decimal Digets. Answer CANNOT exceed current Fiscal Year.
	;;^DD(163.991,.01,21,0)
	;;=^^3^3^2890822^^^^
	;;^DD(163.991,.01,21,1,0)
	;;=This is the fiscal year for which the report was run. There is only one
	;;^DD(163.991,.01,21,2,0)
	;;=entry per fiscal year regardless of the date range as long as the
	;;^DD(163.991,.01,21,3,0)
	;;=dates fall within the fiscal year.
	;;^DD(163.991,.01,"DT")
	;;=2890822
	;;^DD(163.991,1,0)
	;;=TOTAL OCCURANCES^RNJ7,0^^0;2^K:+X'=X!(X>9999999)!(X<8)!(X?.E1"."1N.N) X
	;;^DD(163.991,1,3)
	;;=Type a Number between 8 and 9999999, 0 Decimal Digits
	;;^DD(163.991,1,21,0)
	;;=^^3^3^2930519^^^
	;;^DD(163.991,1,21,1,0)
	;;=Total number of payments for a specific CPT code during
	;;^DD(163.991,1,21,2,0)
	;;=a fiscal year. There must be at least 8 occurrences in
	;;^DD(163.991,1,21,3,0)
	;;=order to be used in calculating the Fee schedule.
	;;^DD(163.991,4,0)
	;;=SEVENTY-FIFTH PERCENTILE^RNJ10,2^^0;5^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999999.99)!(X<0) X
	;;^DD(163.991,4,3)
	;;=Type a Dollar Amount between 0 and 9999999.99, 2 Decimal Digits
	;;^DD(163.991,4,21,0)
	;;=^^3^3^2930519^^^^
	;;^DD(163.991,4,21,1,0)
	;;=This is internally calculated and stores the 75th percentile
	;;^DD(163.991,4,21,2,0)
	;;=dollar amount based on amount claimed by the vendor for the
	;;^DD(163.991,4,21,3,0)
	;;=CPT code.
	;;^DD(163.991,4,"DT")
	;;=2910930

FBINI035
FBINI035	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:'DIFQ(163.99)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(163.991,5,0)
	;;=DATE COMPILED^RD^^0;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(163.991,5,21,0)
	;;=^^1^1^2890412^
	;;^DD(163.991,5,21,1,0)
	;;=This is the date that the FBAAPAY routine was run.
	;;^DD(163.991,5,"DT")
	;;=2890322
	;;^DD(163.991,6,0)
	;;=BEGINNING DATE^RD^^0;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(163.991,6,21,0)
	;;=^^4^4^2930519^^
	;;^DD(163.991,6,21,1,0)
	;;=The user can enter a date range within a fiscal
	;;^DD(163.991,6,21,2,0)
	;;=year. This is the beginning date of that range.
	;;^DD(163.991,6,21,3,0)
	;;=If a fiscal year is selected this field gets
	;;^DD(163.991,6,21,4,0)
	;;=set to 10/1.
	;;^DD(163.991,6,"DT")
	;;=2890322
	;;^DD(163.991,7,0)
	;;=ENDING DATE^RD^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
	;;^DD(163.991,7,21,0)
	;;=^^4^4^2890412^
	;;^DD(163.991,7,21,1,0)
	;;=The user can enter a date range within a fiscal
	;;^DD(163.991,7,21,2,0)
	;;=year. This is the ending date for that range. If
	;;^DD(163.991,7,21,3,0)
	;;=a fiscal year is selected this field gets set
	;;^DD(163.991,7,21,4,0)
	;;=to 9/30.
	;;^DD(163.991,7,"DT")
	;;=2890322

FBINI036
FBINI036	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I DSEC F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(161,0,"DD")
	;;=@
	;;^DIC(161,0,"DEL")
	;;=#
	;;^DIC(161,0,"LAYGO")
	;;=#
	;;^DIC(161,0,"RD")
	;;=#
	;;^DIC(161,0,"WR")
	;;=#
	;;^DD(161.01,3,8.5)
	;;=~
	;;^DD(161.01,100,8.5)
	;;=~
	;;^DD(161.02,100,8.5)
	;;=~
	;;^DIC(161.2,0,"DD")
	;;=@
	;;^DIC(161.2,0,"DEL")
	;;=#
	;;^DIC(161.2,0,"LAYGO")
	;;=#
	;;^DIC(161.2,0,"RD")
	;;=#
	;;^DIC(161.2,0,"WR")
	;;=#
	;;^DIC(161.21,0,"AUDIT")
	;;=#
	;;^DIC(161.21,0,"DD")
	;;=@
	;;^DIC(161.21,0,"DEL")
	;;=#
	;;^DIC(161.21,0,"LAYGO")
	;;=#
	;;^DIC(161.21,0,"RD")
	;;=#
	;;^DIC(161.21,0,"WR")
	;;=#
	;;^DIC(161.22,0,"AUDIT")
	;;=#
	;;^DIC(161.22,0,"DD")
	;;=@
	;;^DIC(161.22,0,"DEL")
	;;=#
	;;^DIC(161.22,0,"LAYGO")
	;;=#
	;;^DIC(161.22,0,"RD")
	;;=#
	;;^DIC(161.22,0,"WR")
	;;=#
	;;^DIC(161.23,0,"AUDIT")
	;;=#
	;;^DIC(161.23,0,"DD")
	;;=@
	;;^DIC(161.23,0,"DEL")
	;;=#
	;;^DIC(161.23,0,"LAYGO")
	;;=#
	;;^DIC(161.23,0,"RD")
	;;=#
	;;^DIC(161.23,0,"WR")
	;;=#
	;;^DIC(161.25,0,"AUDIT")
	;;=#
	;;^DIC(161.25,0,"DD")
	;;=@
	;;^DIC(161.25,0,"DEL")
	;;=#
	;;^DIC(161.25,0,"LAYGO")
	;;=#
	;;^DIC(161.25,0,"RD")
	;;=#
	;;^DIC(161.25,0,"WR")
	;;=#
	;;^DIC(161.26,0,"DD")
	;;=@
	;;^DIC(161.26,0,"DEL")
	;;=#
	;;^DIC(161.26,0,"LAYGO")
	;;=#
	;;^DIC(161.26,0,"RD")
	;;=#
	;;^DIC(161.26,0,"WR")
	;;=#
	;;^DD(161.26,2,8)
	;;=#
	;;^DD(161.26,2,8.5)
	;;=#
	;;^DD(161.26,2,9)
	;;=#
	;;^DIC(161.27,0,"DD")
	;;=@
	;;^DIC(161.27,0,"DEL")
	;;=@
	;;^DIC(161.27,0,"LAYGO")
	;;=@
	;;^DIC(161.27,0,"RD")
	;;=#
	;;^DIC(161.27,0,"WR")
	;;=@
	;;^DIC(161.3,0,"DD")
	;;=@
	;;^DIC(161.3,0,"DEL")
	;;=#
	;;^DIC(161.3,0,"LAYGO")
	;;=#
	;;^DIC(161.3,0,"RD")
	;;=#
	;;^DIC(161.3,0,"WR")
	;;=#
	;;^DIC(161.4,0,"DD")
	;;=@
	;;^DIC(161.4,0,"DEL")
	;;=#
	;;^DIC(161.4,0,"LAYGO")
	;;=#
	;;^DIC(161.4,0,"RD")
	;;=#
	;;^DIC(161.4,0,"WR")
	;;=#
	;;^DD(161.4,10,8.5)
	;;=~
	;;^DD(161.4,10,9)
	;;=~
	;;^DD(161.4,11,8.5)
	;;=~
	;;^DD(161.4,11,9)
	;;=~
	;;^DD(161.4,31,9)
	;;=@
	;;^DIC(161.5,0,"AUDIT")
	;;=#
	;;^DIC(161.5,0,"DD")
	;;=@
	;;^DIC(161.5,0,"DEL")
	;;=#
	;;^DIC(161.5,0,"LAYGO")
	;;=#
	;;^DIC(161.5,0,"RD")
	;;=#
	;;^DIC(161.5,0,"WR")
	;;=#
	;;^DIC(161.6,0,"DD")
	;;=@
	;;^DIC(161.6,0,"DEL")
	;;=@
	;;^DIC(161.6,0,"LAYGO")
	;;=@
	;;^DIC(161.6,0,"RD")
	;;=#
	;;^DIC(161.6,0,"WR")
	;;=@
	;;^DIC(161.7,0,"DD")
	;;=@
	;;^DIC(161.7,0,"DEL")
	;;=#
	;;^DIC(161.7,0,"LAYGO")
	;;=#
	;;^DIC(161.7,0,"RD")
	;;=#
	;;^DIC(161.7,0,"WR")
	;;=#
	;;^DIC(161.8,0,"DD")
	;;=@
	;;^DIC(161.8,0,"DEL")
	;;=@
	;;^DIC(161.8,0,"LAYGO")
	;;=@
	;;^DIC(161.8,0,"RD")
	;;=#
	;;^DIC(161.8,0,"WR")
	;;=@
	;;^DIC(161.81,0,"DD")
	;;=@
	;;^DIC(161.81,0,"DEL")
	;;=@
	;;^DIC(161.81,0,"LAYGO")
	;;=@
	;;^DIC(161.81,0,"RD")
	;;=#
	;;^DIC(161.81,0,"WR")
	;;=@
	;;^DIC(161.82,0,"DD")
	;;=@
	;;^DIC(161.82,0,"DEL")
	;;=@
	;;^DIC(161.82,0,"LAYGO")
	;;=@
	;;^DIC(161.82,0,"RD")
	;;=#
	;;^DIC(161.82,0,"WR")
	;;=@
	;;^DIC(161.83,0,"DD")
	;;=@
	;;^DIC(161.83,0,"DEL")
	;;=@
	;;^DIC(161.83,0,"LAYGO")
	;;=#
	;;^DIC(161.83,0,"RD")
	;;=#
	;;^DIC(161.83,0,"WR")
	;;=#
	;;^DIC(162,0,"DD")
	;;=@
	;;^DIC(162,0,"DEL")
	;;=#
	;;^DIC(162,0,"LAYGO")
	;;=#
	;;^DIC(162,0,"RD")
	;;=#
	;;^DIC(162,0,"WR")
	;;=#
	;;^DD(162.02,2,8)
	;;=#
	;;^DD(162.02,2,9)
	;;=#
	;;^DIC(162.1,0,"DD")
	;;=@
	;;^DIC(162.1,0,"DEL")
	;;=#
	;;^DIC(162.1,0,"LAYGO")
	;;=#
	;;^DIC(162.1,0,"RD")
	;;=#
	;;^DIC(162.1,0,"WR")
	;;=#
	;;^DIC(162.2,0,"DD")
	;;=@
	;;^DIC(162.2,0,"DEL")
	;;=#
	;;^DIC(162.2,0,"LAYGO")
	;;=#
	;;^DIC(162.2,0,"RD")
	;;=#
	;;^DIC(162.2,0,"WR")
	;;=#
	;;^DIC(162.3,0,"DD")
	;;=@
	;;^DIC(162.3,0,"DEL")
	;;=#
	;;^DIC(162.3,0,"LAYGO")
	;;=#
	;;^DIC(162.3,0,"RD")
	;;=#
	;;^DIC(162.3,0,"WR")
	;;=#
	;;^DIC(162.4,0,"DD")
	;;=@
	;;^DIC(162.4,0,"DEL")
	;;=#
	;;^DIC(162.4,0,"LAYGO")
	;;=#
	;;^DIC(162.4,0,"RD")
	;;=#
	;;^DIC(162.4,0,"WR")
	;;=#
	;;^DIC(162.5,0,"DD")
	;;=@
	;;^DIC(162.5,0,"DEL")
	;;=#
	;;^DIC(162.5,0,"LAYGO")
	;;=#
	;;^DIC(162.5,0,"RD")
	;;=#
	;;^DIC(162.5,0,"WR")
	;;=#
	;;^DIC(162.6,0,"DD")
	;;=@
	;;^DIC(162.6,0,"DEL")
	;;=@
	;;^DIC(162.6,0,"LAYGO")
	;;=@
	;;^DIC(162.6,0,"RD")
	;;=#
	;;^DIC(162.6,0,"WR")
	;;=@
	;;^DIC(162.7,0,"DD")
	;;=@
	;;^DIC(162.7,0,"DEL")
	;;=#
	;;^DIC(162.7,0,"LAYGO")
	;;=#
	;;^DIC(162.7,0,"RD")
	;;=#
	;;^DIC(162.7,0,"WR")
	;;=#
	;;^DIC(162.8,0,"AUDIT")
	;;=#
	;;^DIC(162.8,0,"DD")
	;;=@
	;;^DIC(162.8,0,"DEL")
	;;=#
	;;^DIC(162.8,0,"LAYGO")
	;;=#

FBINI037
FBINI037	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I DSEC F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(162.8,0,"RD")
	;;=#
	;;^DIC(162.8,0,"WR")
	;;=#
	;;^DIC(162.91,0,"AUDIT")
	;;=@
	;;^DIC(162.91,0,"DD")
	;;=@
	;;^DIC(162.91,0,"DEL")
	;;=@
	;;^DIC(162.91,0,"LAYGO")
	;;=@
	;;^DIC(162.91,0,"RD")
	;;=#
	;;^DIC(162.91,0,"WR")
	;;=@
	;;^DIC(162.92,0,"AUDIT")
	;;=@
	;;^DIC(162.92,0,"DD")
	;;=@
	;;^DIC(162.92,0,"DEL")
	;;=@
	;;^DIC(162.92,0,"LAYGO")
	;;=@
	;;^DIC(162.92,0,"RD")
	;;=#
	;;^DIC(162.92,0,"WR")
	;;=@
	;;^DIC(162.93,0,"AUDIT")
	;;=#
	;;^DIC(162.93,0,"DD")
	;;=@
	;;^DIC(162.93,0,"DEL")
	;;=#
	;;^DIC(162.93,0,"LAYGO")
	;;=#
	;;^DIC(162.93,0,"RD")
	;;=#
	;;^DIC(162.93,0,"WR")
	;;=#
	;;^DIC(162.94,0,"AUDIT")
	;;=@
	;;^DIC(162.94,0,"DD")
	;;=@
	;;^DIC(162.94,0,"DEL")
	;;=@
	;;^DIC(162.94,0,"LAYGO")
	;;=@
	;;^DIC(162.94,0,"RD")
	;;=#
	;;^DIC(162.94,0,"WR")
	;;=@
	;;^DIC(162.95,0,"DD")
	;;=@
	;;^DIC(162.95,0,"DEL")
	;;=@
	;;^DIC(162.95,0,"LAYGO")
	;;=@
	;;^DIC(162.95,0,"RD")
	;;=#
	;;^DIC(162.95,0,"WR")
	;;=@
	;;^DIC(163.85,0,"AUDIT")
	;;=@
	;;^DIC(163.85,0,"DD")
	;;=@
	;;^DIC(163.85,0,"DEL")
	;;=@
	;;^DIC(163.85,0,"LAYGO")
	;;=@
	;;^DIC(163.85,0,"RD")
	;;=#
	;;^DIC(163.85,0,"WR")
	;;=@
	;;^DIC(163.99,0,"DD")
	;;=@
	;;^DIC(163.99,0,"DEL")
	;;=#
	;;^DIC(163.99,0,"LAYGO")
	;;=#
	;;^DIC(163.99,0,"RD")
	;;=#
	;;^DIC(163.99,0,"WR")
	;;=#

FBINI038
FBINI038	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"BUL",48,0)
	;;=FBAA PURGE^Fee Payment Data Purged
	;;^UTILITY(U,$J,"BUL",48,1,0)
	;;=^^7^7^2880714^^^^
	;;^UTILITY(U,$J,"BUL",48,1,1,0)
	;;=|1| has run the Fee Purge data routine. The data was purged on |2|.
	;;^UTILITY(U,$J,"BUL",48,1,2,0)
	;;=All payment data which was Finalized prior to |3| was purged. A report
	;;^UTILITY(U,$J,"BUL",48,1,3,0)
	;;=containing all purged data (by veteran name) was created.
	;;^UTILITY(U,$J,"BUL",48,1,4,0)
	;;=                                                                   
	;;^UTILITY(U,$J,"BUL",48,1,5,0)
	;;=|4| Outpatient Medical payments were purged.                                          
	;;^UTILITY(U,$J,"BUL",48,1,6,0)
	;;=|5| Pharmacy payments were purged.                                                                      
	;;^UTILITY(U,$J,"BUL",48,1,7,0)
	;;=|6| Travel payments were purged.                                                                             
	;;^UTILITY(U,$J,"BUL",48,3,0)
	;;=^^1^1^2880714^^^^
	;;^UTILITY(U,$J,"BUL",48,3,1,0)
	;;=Informs Fee Supervisor(s) when IRM staff executes the Fee Purge routine.
	;;^UTILITY(U,$J,"BUL",48,4,0)
	;;=^3.64A^6^6
	;;^UTILITY(U,$J,"BUL",48,4,1,0)
	;;=1
	;;^UTILITY(U,$J,"BUL",48,4,1,1,0)
	;;=^^1^1^2880322^
	;;^UTILITY(U,$J,"BUL",48,4,1,1,1,0)
	;;=User name who executed the Purge routine.
	;;^UTILITY(U,$J,"BUL",48,4,2,0)
	;;=2
	;;^UTILITY(U,$J,"BUL",48,4,2,1,0)
	;;=^^1^1^2880322^
	;;^UTILITY(U,$J,"BUL",48,4,2,1,1,0)
	;;=The date the Purge routine was run.
	;;^UTILITY(U,$J,"BUL",48,4,3,0)
	;;=3
	;;^UTILITY(U,$J,"BUL",48,4,3,1,0)
	;;=^^2^2^2880322^
	;;^UTILITY(U,$J,"BUL",48,4,3,1,1,0)
	;;=The cut-off date for the purge. Meaning data prior to this date was 
	;;^UTILITY(U,$J,"BUL",48,4,3,1,2,0)
	;;=purged.
	;;^UTILITY(U,$J,"BUL",48,4,4,0)
	;;=4
	;;^UTILITY(U,$J,"BUL",48,4,4,1,0)
	;;=^^1^1^2880322^
	;;^UTILITY(U,$J,"BUL",48,4,4,1,1,0)
	;;=Total number of Outpatient Medical payments purged.
	;;^UTILITY(U,$J,"BUL",48,4,5,0)
	;;=5
	;;^UTILITY(U,$J,"BUL",48,4,5,1,0)
	;;=^^1^1^2880322^
	;;^UTILITY(U,$J,"BUL",48,4,5,1,1,0)
	;;=Total number of Pharmacy payments purged.
	;;^UTILITY(U,$J,"BUL",48,4,6,0)
	;;=6
	;;^UTILITY(U,$J,"BUL",48,4,6,1,0)
	;;=^^1^1^2880714^^^^
	;;^UTILITY(U,$J,"BUL",48,4,6,1,1,0)
	;;=Total number of travel payments purged.
	;;^UTILITY(U,$J,"BUL",49,0)
	;;=FBAA BATCH PURGE^Fee Batch Numbers Purged
	;;^UTILITY(U,$J,"BUL",49,1,0)
	;;=^^1^1^2920709^^^^
	;;^UTILITY(U,$J,"BUL",49,1,1,0)
	;;=|1| has run the Fee Batch Number purge routine.  The batches were purged on |2|.  All batches that were finalized prior to |3| were purged.  The total number of batches purged was |4|.
	;;^UTILITY(U,$J,"BUL",49,3,0)
	;;=^^2^2^2920709^^^^
	;;^UTILITY(U,$J,"BUL",49,3,1,0)
	;;=Informs Fee Supervisor(s) when the IRM staff executes the Fee Batch
	;;^UTILITY(U,$J,"BUL",49,3,2,0)
	;;=Number purge routine.
	;;^UTILITY(U,$J,"BUL",49,4,0)
	;;=^3.64A^4^4
	;;^UTILITY(U,$J,"BUL",49,4,1,0)
	;;=1
	;;^UTILITY(U,$J,"BUL",49,4,1,1,0)
	;;=^^1^1^2900625^^^
	;;^UTILITY(U,$J,"BUL",49,4,1,1,1,0)
	;;=User name who executed the purge routine.
	;;^UTILITY(U,$J,"BUL",49,4,2,0)
	;;=2
	;;^UTILITY(U,$J,"BUL",49,4,2,1,0)
	;;=^^1^1^2900625^^
	;;^UTILITY(U,$J,"BUL",49,4,2,1,1,0)
	;;=The date the purge routine was run.
	;;^UTILITY(U,$J,"BUL",49,4,3,0)
	;;=3
	;;^UTILITY(U,$J,"BUL",49,4,3,1,0)
	;;=^^2^2^2900625^^
	;;^UTILITY(U,$J,"BUL",49,4,3,1,1,0)
	;;=The cut-off date for the purge.  Meaning all batches
	;;^UTILITY(U,$J,"BUL",49,4,3,1,2,0)
	;;=finalized prior to this date were purged.
	;;^UTILITY(U,$J,"BUL",49,4,4,0)
	;;=4
	;;^UTILITY(U,$J,"BUL",49,4,4,1,0)
	;;=^^2^2^2920709^^^^
	;;^UTILITY(U,$J,"BUL",49,4,4,1,1,0)
	;;=Total number of batch numbers that were purged during this purge
	;;^UTILITY(U,$J,"BUL",49,4,4,1,2,0)
	;;=session.
	;;^UTILITY(U,$J,"BUL",73,0)
	;;=FB INSURANCE CHANGE^FEE NOTIFICATION OF INSURANCE CHANGE
	;;^UTILITY(U,$J,"BUL",73,1,0)
	;;=^^5^5^2941110^^^^
	;;^UTILITY(U,$J,"BUL",73,1,1,0)
	;;=There appears to be a change of insurance information 
	;;^UTILITY(U,$J,"BUL",73,1,2,0)
	;;=for |1| with PT.ID of |2|.

FBINI039
FBINI039	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"BUL",73,1,3,0)
	;;=The explanation of change is as follows:
	;;^UTILITY(U,$J,"BUL",73,1,4,0)
	;;= 
	;;^UTILITY(U,$J,"BUL",73,1,5,0)
	;;=   |3|
	;;^UTILITY(U,$J,"BUL",73,3,0)
	;;=^^4^4^2941110^^^^
	;;^UTILITY(U,$J,"BUL",73,3,1,0)
	;;=This bulletin will be used to notify MCCR that there is a possible
	;;^UTILITY(U,$J,"BUL",73,3,2,0)
	;;=discrepancy found on a patient's insurance information.  Fee Basis
	;;^UTILITY(U,$J,"BUL",73,3,3,0)
	;;=is not allowed to directly change a patient's insurance information
	;;^UTILITY(U,$J,"BUL",73,3,4,0)
	;;=that is the reason for this bulletin.
	;;^UTILITY(U,$J,"BUL",73,4,0)
	;;=^3.64A^3^3
	;;^UTILITY(U,$J,"BUL",73,4,1,0)
	;;=1
	;;^UTILITY(U,$J,"BUL",73,4,1,1,0)
	;;=^^1^1^2930806^^
	;;^UTILITY(U,$J,"BUL",73,4,1,1,1,0)
	;;=The name of the patient with a possible insurance discrepancy.
	;;^UTILITY(U,$J,"BUL",73,4,2,0)
	;;=2
	;;^UTILITY(U,$J,"BUL",73,4,2,1,0)
	;;=^^1^1^2940304^^^
	;;^UTILITY(U,$J,"BUL",73,4,2,1,1,0)
	;;=The patient identifier (SSN).
	;;^UTILITY(U,$J,"BUL",73,4,3,0)
	;;=3
	;;^UTILITY(U,$J,"BUL",73,4,3,1,0)
	;;=^^2^2^2941110^^^^
	;;^UTILITY(U,$J,"BUL",73,4,3,1,1,0)
	;;=A free text explanation of the discrepancy found on the
	;;^UTILITY(U,$J,"BUL",73,4,3,1,2,0)
	;;=insurance information in the patient file.
	;;^UTILITY(U,$J,"BUL",77,0)
	;;=FBAA PURGE TRANSMITTED MRA'S^PURGE OF TRANSMITTED MRA'S
	;;^UTILITY(U,$J,"BUL",77,1,0)
	;;=^^4^4^2930402^^
	;;^UTILITY(U,$J,"BUL",77,1,1,0)
	;;=The purge of transmitted MRA's has completed.
	;;^UTILITY(U,$J,"BUL",77,1,2,0)
	;;= 
	;;^UTILITY(U,$J,"BUL",77,1,3,0)
	;;=Total Veteran MRA's deleted: |1|.
	;;^UTILITY(U,$J,"BUL",77,1,4,0)
	;;=Total Vendor MRA's deleted: |2|.
	;;^UTILITY(U,$J,"BUL",77,3,0)
	;;=2
	;;^UTILITY(U,$J,"BUL",77,3,1,0)
	;;=Bulletin is triggered upon completion of the 'Purge Transmitted MRA's'
	;;^UTILITY(U,$J,"BUL",77,3,2,0)
	;;=option.
	;;^UTILITY(U,$J,"BUL",77,4,0)
	;;=^3.64A^2^2
	;;^UTILITY(U,$J,"BUL",77,4,1,0)
	;;=1
	;;^UTILITY(U,$J,"BUL",77,4,1,1,0)
	;;=^^1^1^2930311^
	;;^UTILITY(U,$J,"BUL",77,4,1,1,1,0)
	;;=A numeric count of the total Veteran MRA's deleted.
	;;^UTILITY(U,$J,"BUL",77,4,2,0)
	;;=2
	;;^UTILITY(U,$J,"BUL",77,4,2,1,0)
	;;=^^1^1^2930311^
	;;^UTILITY(U,$J,"BUL",77,4,2,1,1,0)
	;;=A numeric count of the total Vendor MRA's deleted.
	;;^UTILITY(U,$J,"DIBT",707,0)
	;;=FB BATCH LIST^2920826.1111^@^161.7^705^@^2941219
	;;^UTILITY(U,$J,"DIBT",707,2,1)
	;;=161.7^.01^NUMBER^]@^
	;;^UTILITY(U,$J,"DIBT",707,2,1,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",707,2,1,"F")
	;;=99.99999^100
	;;^UTILITY(U,$J,"DIBT",707,2,1,"IX")
	;;=^FBAA(161.7,"B",^FBAA(161.7,^2
	;;^UTILITY(U,$J,"DIBT",707,2,1,"T")
	;;=199^199
	;;^UTILITY(U,$J,"DIBT",707,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIBT",707,"%D",1,0)
	;;=List batch
	;;^UTILITY(U,$J,"DIBT",708,0)
	;;=FBAA RX PENDING^2920827.1421^^162.1^705^^2950110
	;;^UTILITY(U,$J,"DIBT",708,2,1)
	;;=162.11^^PATIENT^"4^
	;;^UTILITY(U,$J,"DIBT",708,2,1,162.1)
	;;=RX
	;;^UTILITY(U,$J,"DIBT",708,2,1,"CM")
	;;=X DPP(1,"OVF1",9.2) S Y(101)=$S($D(^FBAAA(D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(Y(101),U,1),0)):"",1:$P(^(0),U,1)) S D0=I(0,0) S D1=I(1,0) I D1>0 S X(1)=X
	;;^UTILITY(U,$J,"DIBT",708,2,1,"OVF1",9.2)
	;;=S I(1,0)=$S($D(D1):D1,1:""),I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^FBAA(162.1,D0,"RX",D1,0)):^(0),1:""),D0=$P(Y(1),U,5) S:'$D(^FBAAA(+D0,0)) D0=-1
	;;^UTILITY(U,$J,"DIBT",708,2,2)
	;;=162.1^5^INVOICE STATUS^@^
	;;^UTILITY(U,$J,"DIBT",708,2,2,"F")
	;;=.99999^1
	;;^UTILITY(U,$J,"DIBT",708,2,2,"IX")
	;;=^FBAA(162.1,"AC",^FBAA(162.1,^2
	;;^UTILITY(U,$J,"DIBT",708,2,2,"T")
	;;=1^1
	;;^UTILITY(U,$J,"DIBT",708,2,3)
	;;=162.11^8^LINE ITEM STATUS^@^
	;;^UTILITY(U,$J,"DIBT",708,2,3,162.1)
	;;=RX
	;;^UTILITY(U,$J,"DIBT",708,2,3,"F")
	;;=.99999^1
	;;^UTILITY(U,$J,"DIBT",708,2,3,"T")
	;;=1^1
	;;^UTILITY(U,$J,"DIBT",708,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIBT",708,"%D",1,0)
	;;=Prescriptions pending pharmacy review
	;;^UTILITY(U,$J,"DIBT",710,0)
	;;=FBCH PENDING REQUEST^2920917.1434^@^162.2^705^@^2941219
	;;^UTILITY(U,$J,"DIBT",710,2,1)
	;;=162.2^100^REQUEST STATUS^]^

FBINI03A
FBINI03A	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIBT",710,2,1,"F")
	;;=.99999^1
	;;^UTILITY(U,$J,"DIBT",710,2,1,"T")
	;;=2^2
	;;^UTILITY(U,$J,"DIBT",710,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIBT",710,"%D",1,0)
	;;=Fee notifications/requests pending entitlement
	;;^UTILITY(U,$J,"DIBT",714,0)
	;;=FBCH 7078 CANCEL^2930518.1108^@^162.4^705^@^2941219
	;;^UTILITY(U,$J,"DIBT",714,2,1)
	;;=162.4^9^STATUS^@^
	;;^UTILITY(U,$J,"DIBT",714,2,1,"F")
	;;=DBz^DC
	;;^UTILITY(U,$J,"DIBT",714,2,1,"T")
	;;=DC^DC
	;;^UTILITY(U,$J,"DIBT",714,2,2)
	;;=162.4^.014^DATE CANCELLED^@^
	;;^UTILITY(U,$J,"DIBT",714,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIBT",714,"%D",1,0)
	;;=Listing of cancelled 7078s
	;;^UTILITY(U,$J,"DIBT",825,0)
	;;=FBUC STATUS BY PATIENT^2940422.1248^@^162.7^10226^@^2950117
	;;^UTILITY(U,$J,"DIBT",825,2,1)
	;;=162.7^.01^DATE CLAIM RECEIVED^@'^
	;;^UTILITY(U,$J,"DIBT",825,2,1,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",825,2,1,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",825,2,1,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",825,2,2)
	;;=162.7^^PRIMARY SERVICE FACILITY^#+"6^
	;;^UTILITY(U,$J,"DIBT",825,2,2,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",825,2,2,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^DIC(4,+$P(Y(1),U,7),0)):"",1:$P(^(0),U,1)) I D0>0 S X(2)=X
	;;^UTILITY(U,$J,"DIBT",825,2,2,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",825,2,2,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",825,2,3)
	;;=162.92^.04^STATUS ORDER^@"^;S2
	;;^UTILITY(U,$J,"DIBT",825,2,3,162.7,100)
	;;=162.92^FB(162.92,^0^S I(0,0)=D0 S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$P(Y(1),U,24),X=X S D(0)=+X
	;;^UTILITY(U,$J,"DIBT",825,2,3,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",825,2,3,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",825,2,3,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",825,2,4)
	;;=162.7^^STATUS^'+"24^
	;;^UTILITY(U,$J,"DIBT",825,2,4,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^FB(162.92,+$P(Y(1),U,24),0)):"",1:$P(^(0),U,1)) I D0>0 S X(4)=X
	;;^UTILITY(U,$J,"DIBT",825,2,5)
	;;=162.7^^VETERAN^"2^
	;;^UTILITY(U,$J,"DIBT",825,2,5,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",825,2,5,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(Y(1),U,4),0)):"",1:$P(^(0),U,1)) I D0>0 S X(5)=X
	;;^UTILITY(U,$J,"DIBT",825,2,5,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",825,2,5,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",825,2,6)
	;;=162.7^^VENDOR^"1^
	;;^UTILITY(U,$J,"DIBT",825,2,6,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",825,2,6,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^FBAAV(+$P(Y(1),U,3),0)):"",1:$P(^(0),U,1)) I D0>0 S X(6)=X
	;;^UTILITY(U,$J,"DIBT",825,2,6,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",825,2,6,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",825,2,7)
	;;=162.7^26^EXPIRATION DATE OF CLAIM^^
	;;^UTILITY(U,$J,"DIBT",825,2,7,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",825,2,7,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",825,2,7,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",825,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIBT",825,"%D",1,0)
	;;=Status listing of unauthorized claims by patient
	;;^UTILITY(U,$J,"DIBT",826,0)
	;;=FBUC STATUS BY VENDOR^2940422.1249^@^162.7^10226^@^2940422
	;;^UTILITY(U,$J,"DIBT",826,2,1)
	;;=162.7^.01^DATE CLAIM RECEIVED^@'^
	;;^UTILITY(U,$J,"DIBT",826,2,1,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",826,2,1,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",826,2,1,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",826,2,2)
	;;=162.7^^PRIMARY SERVICE FACILITY^#+"6^
	;;^UTILITY(U,$J,"DIBT",826,2,2,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",826,2,2,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^DIC(4,+$P(Y(1),U,7),0)):"",1:$P(^(0),U,1)) I D0>0 S X(2)=X
	;;^UTILITY(U,$J,"DIBT",826,2,2,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",826,2,2,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",826,2,3)
	;;=162.92^.04^STATUS ORDER^@"^;S2
	;;^UTILITY(U,$J,"DIBT",826,2,3,162.7,100)
	;;=162.92^FB(162.92,^0^S I(0,0)=D0 S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$P(Y(1),U,24),X=X S D(0)=+X
	;;^UTILITY(U,$J,"DIBT",826,2,3,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",826,2,3,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",826,2,3,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",826,2,4)
	;;=162.7^^STATUS^'+"24^
	;;^UTILITY(U,$J,"DIBT",826,2,4,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^FB(162.92,+$P(Y(1),U,24),0)):"",1:$P(^(0),U,1)) I D0>0 S X(4)=X

FBINI03B
FBINI03B	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIBT",826,2,5)
	;;=162.7^^VENDOR^"1^
	;;^UTILITY(U,$J,"DIBT",826,2,5,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",826,2,5,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^FBAAV(+$P(Y(1),U,3),0)):"",1:$P(^(0),U,1)) I D0>0 S X(5)=X
	;;^UTILITY(U,$J,"DIBT",826,2,5,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",826,2,5,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",826,2,6)
	;;=162.7^^VETERAN^"2^
	;;^UTILITY(U,$J,"DIBT",826,2,6,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",826,2,6,"CM")
	;;=S Y(1)=$S($D(^FB583(D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(Y(1),U,4),0)):"",1:$P(^(0),U,1)) I D0>0 S X(6)=X
	;;^UTILITY(U,$J,"DIBT",826,2,6,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",826,2,6,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",826,2,7)
	;;=162.7^26^EXPIRATION DATE OF CLAIM^^
	;;^UTILITY(U,$J,"DIBT",826,2,7,"ASK")
	;;=
	;;^UTILITY(U,$J,"DIBT",826,2,7,"F")
	;;=?z^@
	;;^UTILITY(U,$J,"DIBT",826,2,7,"T")
	;;=z^
	;;^UTILITY(U,$J,"DIBT",826,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIBT",826,"%D",1,0)
	;;=Status listing of unauthorized claims by vendor
	;;^UTILITY(U,$J,"DIE",261,0)
	;;=FBAA ADDRESS EDIT^2930722.1216^^2^705^^2950118
	;;^UTILITY(U,$J,"DIE",261,"DR",1,2)
	;;=.111;.112;S:X="" Y=.114;.113;.114;.115;I +$G(^DG(43,1,"VERSION"))<5.3 S Y=.116;.1112;S Y=.117;.116;.117;
	;;^UTILITY(U,$J,"DIE",342,0)
	;;=FBAA AUTHORIZATION^2950110.1411^^161^1^^2950127
	;;^UTILITY(U,$J,"DIE",342,"%D",0)
	;;=^^1^1^2920513^
	;;^UTILITY(U,$J,"DIE",342,"%D",1,0)
	;;=This template is used for creating new authorizations for Fee Basis.
	;;^UTILITY(U,$J,"DIE",342,"DIAB",2,1,161.01,3)
	;;=101;T
	;;^UTILITY(U,$J,"DIE",342,"DR",1,161)
	;;=S FBPRG="";1;I '$D(FBAATT) S Y="";I FBAATT'=3 S Y="";Q;S HID=$S($D(^FBAAA(DA,4)):$P(^(4),"^"),1:"");.5;Q;S NID=X;.6//^S X="TODAY";S Y=$S(HID="":"",HID=NID:"",NID="":.65,1:.7);.65;.7;S NIDR=X;
	;;^UTILITY(U,$J,"DIE",342,"DR",2,161.01)
	;;=S FBAOLD=^FBAAA(DA(1),1,DA,0),FBAALT=$S($P(FBAOLD,"^",13)=2:"Y",$P(FBAOLD,"^",13)=3:"Y",1:""),FBPRG=$P(FBAOLD,"^",3);I FBPRG,FBPRG'=2 W !!,*7,"You are only allowed to edit an outpatient authorization using this option.",!! S Y="";
	;;^UTILITY(U,$J,"DIE",342,"DR",2,161.01,1)
	;;=@1;.01;S FBTODT=X;I $P(FBAOLD,U,2)']"" S Y="@2";I X'>$P(FBAOLD,U,2) S Y="@2";.01////^S X=+FBAOLD;W !,*7,"From Date cannot be later than the To Date!";S Y="@1";@2;
	;;^UTILITY(U,$J,"DIE",342,"DR",2,161.01,2)
	;;=S:'$D(FBAADDYS) FBAADDYS=0 S X1=FBTODT,X2=FBAADDYS D C^%DTC S FBAAX=X;S FBD1=DA;.02//^S X=$E(FBAAX,4,5)_"-"_$E(FBAAX,6,7)_"-"_$E(FBAAX,2,3);I $P(^FBAAA(DA(1),1,DA,0),"^",7)]"" K DIE("NO^");.03////^S X=$S(FBPRG:FBPRG,1:2);
	;;^UTILITY(U,$J,"DIE",342,"DR",2,161.01,3)
	;;=S FBTYPE=$S(FBPRG:FBPRG,1:2);101T~;.07;.065;.095;S FBAATT=X;S FBAALT=$S(X=2:"Y",X=3:"Y",1:"");K DIE("NO^");.08;S:X="" Y=.021;.085;S:X="" Y=.021;.086;.021;2;S:'$D(FBAAASKV) FBAAASKV="N";S:FBAAASKV'="y" Y=100;.04;Q;100////^S X=DUZ;
	;;^UTILITY(U,$J,"DIE",342,"DR",2,161.01,4)
	;;=W !!;.096;.097//^S X="NO";1//^S X="YES";S FBAAP79=$S(X["Y":"Y",1:"");I X["Y" S Y="";1///^S X="@";
	;;^UTILITY(U,$J,"DIE",342,"ROU")
	;;=^FBCTAU
	;;^UTILITY(U,$J,"DIE",342,"ROUOLD")
	;;=FBCTAU
	;;^UTILITY(U,$J,"DIE",343,0)
	;;=FBAA EDIT VENDOR^2941011.0907^^161.2^1555^^2950124
	;;^UTILITY(U,$J,"DIE",343,"DIAB",6,0,161.2,0)
	;;=30.06;T
	;;^UTILITY(U,$J,"DIE",343,"DIAB",13,0,161.2,0)
	;;=.05;REQ
	;;^UTILITY(U,$J,"DIE",343,"DIAB",22,0,161.2,1)
	;;=22;REQ
	;;^UTILITY(U,$J,"DIE",343,"DR",1,161.2)
	;;=S FBTV="",FBPARCD="";.01;1;S FBID=X;W !,"Is the ID NUMBER a Tax # or SSN?";30.06T~;6;S FBTV=X;I FBTV=3&(FBID'?9N) W !!,*7,"Pharmacy Vendor ID must be 9 numerics only!!" S Y=1;7;S FBPARCD=X;S:FBTV'=2 Y="@3";.05R~;S Y=2;@3;.05///@;2;
	;;^UTILITY(U,$J,"DIE",343,"DR",1,161.2,1)
	;;=2.5;3;4;5;5.5;14;23;30.03////Y;30.05////B;30.04////^S X=$S(FBTV=2:"I",FBTV=10:"F",1:"C");S:FBPARCD=6 Y="@22";S:FBPARCD=14 Y=8;22;S:FBPARCD=5 Y=.18;S:FBTV'=3 Y="";8;S Y="";@22;30.02;S FBEXMPT=X;S:$G(FBEXMPT)="Y" Y="@23";22R~;S Y="";
	;;^UTILITY(U,$J,"DIE",343,"DR",1,161.2,2)
	;;=@23;22;K FBEXMPT S Y="";.18;18;19;20;
	;;^UTILITY(U,$J,"DIE",344,0)
	;;=FBAA NEW VENDOR^2941011.0906^^161.2^1555^^2950118

FBINI03C
FBINI03C	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",344,"DIAB",6,0,161.2,0)
	;;=30.06;T
	;;^UTILITY(U,$J,"DIE",344,"DIAB",14,0,161.2,0)
	;;=.05;REQ
	;;^UTILITY(U,$J,"DIE",344,"DIAB",18,0,161.2,1)
	;;=22;REQ
	;;^UTILITY(U,$J,"DIE",344,"DR",1,161.2)
	;;=S FBPARCD="";.01;1;S FBID=X;W !,"Is the ID NUMBER a Tax # or SSN?";30.06T~;6;S FBTV=X;I FBTV=3&(FBID'?9N) W !!,*7,"Pharmacy Vendor ID must be 9 numerics!" S Y=1;S:FBTV=3 FBPARCD=14,Y=2;7;S FBPARCD=X;S:FBTV'=2 Y=2;.05R~;2;2.5;3;4;5;
	;;^UTILITY(U,$J,"DIE",344,"DR",1,161.2,1)
	;;=5.5;14;23;30.03////Y;30.05////B;30.04////^S X=$S(FBTV=2:"I",FBTV=10:"F",1:"C");S:FBPARCD=6 Y="@22";S:FBPARCD=14 Y=8;22;S:FBPARCD=5 Y=.18;S:FBTV'=3 Y="";8;S Y="";@22;30.02;S FBEXMPT=X;S:FBEXMPT="Y" Y="@23";22R~;S Y="";@23;22;
	;;^UTILITY(U,$J,"DIE",344,"DR",1,161.2,2)
	;;=K FBEXMPT S Y="";.18;18;19;20;
	;;^UTILITY(U,$J,"DIE",345,0)
	;;=FBAA REPORT OF CONTACT^2901104.1837^^161^^^2941221^
	;;^UTILITY(U,$J,"DIE",345,"DR",1,161)
	;;=2;K FBDAT;
	;;^UTILITY(U,$J,"DIE",345,"DR",2,161.02)
	;;=.01;S FBDAT=X;S FBD1=DA;1;1.5;2;Q;Q;Q;100////^S X=DUZ;@1;5//^S X="TODAY";I X<FBDAT W !,*7,"Input date must be after date of contact!" S Y="@1";3.5;
	;;^UTILITY(U,$J,"DIE",346,0)
	;;=FBAA INVOICE EDIT^2890519^^162.1^^^2930518
	;;^UTILITY(U,$J,"DIE",346,"DR",1,162.1)
	;;=.01;1;3;4;5;
	;;^UTILITY(U,$J,"DIE",346,"DR",2,162.11)
	;;=.01;1;1.5;1.6;2;3;4;I $P(^FBAA(162.1,DA(1),"RX",DA,0),U,9)=1 S Y="";I 1;5;6;6.5;7;S:X'=4 Y=8;20;8;16;
	;;^UTILITY(U,$J,"DIE",350,0)
	;;=FBAA BATCH EDIT^2930504.1115^^161.7^1555^^2950105
	;;^UTILITY(U,$J,"DIE",350,"DR",1,161.7)
	;;=.01;1////^S X=FBON;3;
	;;^UTILITY(U,$J,"DIE",353,0)
	;;=FBAA SITE PARAMETERS^2930911.1321^^161.4^10116^^2941227
	;;^UTILITY(U,$J,"DIE",353,"DIAB",13,0,161.4,0)
	;;=32;T
	;;^UTILITY(U,$J,"DIE",353,"DR",1,161.4)
	;;=.01;I $$VER^FBAAUTL2(161.4)=3,$D(^FBAA(161.4,1,0)) S $P(^(1),U,10)="FEE";I $D(^FBAA(161.4,1,0)),$P(^(1),U,9)="" S $P(^(1),U,9)=125;1;2;16;3:8;9;12:14;15;17:19;21:28;32T~;32.5;33;34;35;35.5;35.6;
	;;^UTILITY(U,$J,"DIE",353,"DR",2,161.428)
	;;=.01
	;;^UTILITY(U,$J,"DIE",354,0)
	;;=FBAA LETTERS^2870224^^161.3^^^2941227
	;;^UTILITY(U,$J,"DIE",354,"DR",1,161.3)
	;;=.01;1;2;
	;;^UTILITY(U,$J,"DIE",356,0)
	;;=FBCH ENTER REQUEST^2930318.0916^^162.2^1555^^2941219
	;;^UTILITY(U,$J,"DIE",356,"DR",1,162.2)
	;;=Q;S FBUP="",FBLG=0;D:FBN CHEK^FBCHREQ;.01;S FBDA=DA;S FBDATE=X;@1;W !;1////^S X=FBCHVEN;S FBVD=X;@2;2;S FBPER=X;3////^S X=DFN;3.5;S FBDOA=X;I 1;4//^S X=FBDOA;S FBADDT=X;W !;S FBBEGDT=X;
	;;^UTILITY(U,$J,"DIE",356,"DR",1,162.2,1)
	;;=S FBPROG=6,FBFLAG=2 D EN1^FBAAUTL2 S:FBLG>0 FBSW=1,Y=7;D TIMCK^FBCHREQ1;S (FBDIAG,FBPHY,FBCHTEL)="";S:FBSW FBOUT=1,Y="";5;S FBDIAG=X;6;S FBPHY=X;S:FBPHY="" Y="@7";6.5;S FBCHTEL=X;@7;S:'FBN Y=0;7////^S X=DUZ;
	;;^UTILITY(U,$J,"DIE",356,"DR",1,162.2,2)
	;;=100////^S X=$S(FBSW:3,1:1);S:'FBSW Y="@99";8////^S X="N";9////^S X=DT;10////^S X=DUZ;@99;S FBUP=1;K FBVENEW;
	;;^UTILITY(U,$J,"DIE",358,0)
	;;=FBCH ENTER 7078^2930819.1319^^162.4^705^^2941219
	;;^UTILITY(U,$J,"DIE",358,"DR",1,162.4)
	;;=.5////^S X=6;9////^S X="I";1////^S X=FBVEN;2////^S X=FBVET;3////^S X=FBFRDT;3.5////^S X=FBDOA;4////^S X=FBTODT;4.5////^S X=FBDOD;5////^S X=FBADMIT;10////^S X=DT;8////^S X=DUZ;6////^S X=FBEST;
	;;^UTILITY(U,$J,"DIE",358,"DR",1,162.4,1)
	;;=I $D(^FBAA(161.4,1,0)),$D(^("S")) S:$D(^("S",0)) ^FB7078(DA,1,0)=^(0) F FBI=1:1 Q:'$D(^FBAA(161.4,1,"S",FBI,0))  I $D(^(0)) S ^FB7078(DA,1,FBI,0)=^(0);7;S Y=$S(FBTODT:0,1:12);12////^S X=FBPDIS;9////^S X="I";
	;;^UTILITY(U,$J,"DIE",362,0)
	;;=FBCH ENTER PAYMENT^2940415.1503^^162.5^1555^^2941205
	;;^UTILITY(U,$J,"DIE",362,"DR",1,162.5)
	;;=1////^S X=FBAAID;46////^S X=FBAAVID;47////^S X=FBAAMM1;2////^S X=FBVEN;3////^S X=FBVET;4////^S X=FBI7078;5////^S X=FBAABDT;6////^S X=FBAAEDT;23////^S X=FBPSA;21////^S X=FBPOV;22////^S X=FBPT;11////^S X=FBTYPE;12////^S X=FBAAPTC;
	;;^UTILITY(U,$J,"DIE",362,"DR",1,162.5,1)
	;;=20////^S X=FBAABE;W !;6.5;6.6;I 1;7;S FBAMTC=X;I $G(FBEXMPT)'="Y" S Y="@25";8;I FBAMTC=X S Y="@25";9;10;@20;I $G(FBEXMPT)="Y" S Y="@25";24;@25;6.7;I 1;@30;30;31;S:X="" Y=40;32;S:X="" Y=40;33;S:X="" Y=40;34;40;S:X="" Y="@99";41;

FBINI03D
FBINI03D	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",362,"DR",1,162.5,2)
	;;=S:X="" Y="@99";42;S:X="" Y="@99";43;S:X="" Y="@99";44;@99;I $D(^FBAAI(DA,"DX")),$P(^("DX"),U)="" W !!,*7,"The 'ICD1' field is a manditory field!",! S Y="@30";25////^S X=FBRESUB;
	;;^UTILITY(U,$J,"DIE",363,0)
	;;=FBCH EDIT PAYMENT^2950113.1351^^162.5^1555^^2950113
	;;^UTILITY(U,$J,"DIE",363,"DIAB",1,0,162.5,1)
	;;=9;REQ
	;;^UTILITY(U,$J,"DIE",363,"DIAB",2,0,162.5,1)
	;;=10;REQ
	;;^UTILITY(U,$J,"DIE",363,"DIAB",7,0,162.5,1)
	;;=24;REQ
	;;^UTILITY(U,$J,"DIE",363,"DR",1,162.5)
	;;=1;Q;Q;I 1;46;S FBAAMM=1;D PPT^FBAACO1;47////@;47///^S X=FBAAMM1;6.5;6.6;I 1;6.7;7;S:$D(FBPRICE) Y="@25";S FBJJ=X;I $G(FBEXMPT)="Y" S Y=8;26;8;S FBKK=X;9////^S X=$S(FBJJ-FBKK>0:FBJJ-FBKK,1:"");I X S Y="@22";10////@;S Y="@24";@22;
	;;^UTILITY(U,$J,"DIE",363,"DR",1,162.5,1)
	;;=9R~;10R~;S:X'=4 Y="@24";18;@24;I $G(FBEXMPT)="Y" S Y=30;24R~;@25;30;S:X="" Y=40;31;S:X="" Y=40;32;S:X="" Y=40;33;S:X="" Y=40;34;40;S:X="" Y="@99";41;S:X="" Y="@99";42;S:X="" Y="@99";43;S:X="" Y="@99";44;@99;K FBJJ,FBKK;
	;;^UTILITY(U,$J,"DIE",372,0)
	;;=FB CHNH OPEN BATCH^2940920.1506^^161.7^705^^2950106
	;;^UTILITY(U,$J,"DIE",372,"DR",1,161.7)
	;;=S:'$D(FBSTN) FBSTN="";4////^S X=DUZ;Q;11////^S X="O";2////^S X="B9";3////^S X=DT;1////^S X=FBOBN;16////^S X=FBSTN;S:'$G(FBBSTAT) Y="";19////1;
	;;^UTILITY(U,$J,"DIE",619,0)
	;;=FBAA MED IFCAP^2940920.1507^^161.7^705^^2950125
	;;^UTILITY(U,$J,"DIE",619,"DR",1,161.7)
	;;=3////^S X=DT;4////^S X=DUZ;2///^S X="B3";11///^S X="O";1////^S X=FBOBN;16////^S X=FBSTN;S:'$G(FBBSTAT) Y="";19////1;
	;;^UTILITY(U,$J,"DIE",620,0)
	;;=FBAA PHARM IFCAP^2940920.1512^^161.7^705^^2941227
	;;^UTILITY(U,$J,"DIE",620,"DR",1,161.7)
	;;=3////^S X=DT;4////^S X=DUZ;2///^S X="B5";11///^S X="O";1////^S X=FBOBN;16////^S X=FBSTN;S:'$G(FBBSTAT) Y="";19////1;
	;;^UTILITY(U,$J,"DIE",621,0)
	;;=FBAA TRAV IFCAP^2940920.1514^^161.7^705^^2940921
	;;^UTILITY(U,$J,"DIE",621,"DR",1,161.7)
	;;=3////^S X=DT;4////^S X=DUZ;2///^S X="B2";11///^S X="O";1////^S X=FBOBN;16////^S X=FBSTN;S:'$G(FBBSTAT) Y="";19////1;
	;;^UTILITY(U,$J,"DIE",634,0)
	;;=FBAA EDIT SCHEDULE^2940908.0902^^163.99^1555^^2950125
	;;^UTILITY(U,$J,"DIE",634,"DR",1,163.99)
	;;=1;
	;;^UTILITY(U,$J,"DIE",634,"DR",2,163.991)
	;;=.01;4;5///^S X=DT;S $P(^FBAA(163.99,DA(1),"FY",DA,0),U,7,8)="";
	;;^UTILITY(U,$J,"DIE",680,0)
	;;=FBNH ENTER 7078^2900307.0851^^162.4^^^2950109
	;;^UTILITY(U,$J,"DIE",680,"DIAB",6,0,162.4,0)
	;;=5;"ADMITTING AUTHORITY"
	;;^UTILITY(U,$J,"DIE",680,"DR",1,162.4)
	;;=.5////^S X=7;1////^S X=FBVEN;2////^S X=DFN;3////^S X=FBBEGDT;4////^S X=FBENDDT;5ADMITTING AUTHORITY~;10////^S X=DT;8////^S X=DUZ;6////^S X=FBDEFP;9////^S X="C";
	;;^UTILITY(U,$J,"DIE",681,0)
	;;=FBNH ENTER AUTHORIZATION^2930326.1315^^161^^^^
	;;^UTILITY(U,$J,"DIE",681,"DR",1,161)
	;;=1;
	;;^UTILITY(U,$J,"DIE",681,"DR",2,161.01)
	;;=.02////^S X=FBENDDT;.03////^S X=7;S FBTYPE=7;100////^S X=DUZ;1////^S X="YES";.04;.07;.021;.08;S:X="" Y="";.085;S:X="" Y="";.086;
	;;^UTILITY(U,$J,"DIE",684,0)
	;;=FB CH OPEN BATCH^2940921.1133^^161.7^705^^2941219
	;;^UTILITY(U,$J,"DIE",684,"DR",1,161.7)
	;;=S:'$D(FBSTN) FBSTN="";4////^S X=DUZ;11////^S X="O";2////^S X="B9";3////^S X=DT;1////^S X=FBOBN;16////^S X=FBSTN;17////^S X="Y";S:'$G(FBBSTAT) Y="";19////1;18////Y;
	;;^UTILITY(U,$J,"DIE",685,0)
	;;=FBNH EDIT AUTHORIZATION^2930326.1314^^161^^^^
	;;^UTILITY(U,$J,"DIE",685,"DR",1,161)
	;;=1;S FBNEW=^(0);
	;;^UTILITY(U,$J,"DIE",685,"DR",2,161.01)
	;;=S FBOLD=^(0);.01;.02;.04;.065;.07;.021;.08;S:X="" Y=101;.085;S:X="" Y=101;.086;101;
	;;^UTILITY(U,$J,"DIE",690,0)
	;;=FBNH EDIT PAYMENT^2950113.1321^^162.5^1555^^2950113
	;;^UTILITY(U,$J,"DIE",690,"DIAB",1,0,162.5,3)
	;;=10;REQ
	;;^UTILITY(U,$J,"DIE",690,"DIAB",3,0,162.5,0)
	;;=1;"(whichever is later)"
	;;^UTILITY(U,$J,"DIE",690,"DIAB",6,0,162.5,3)
	;;=20;REQ
	;;^UTILITY(U,$J,"DIE",690,"DIAB",7,0,162.5,3)
	;;=21;REQ
	;;^UTILITY(U,$J,"DIE",690,"DIAB",8,0,162.5,3)
	;;=22;REQ
	;;^UTILITY(U,$J,"DIE",690,"DIAB",9,0,162.5,3)
	;;=23;REQ
	;;^UTILITY(U,$J,"DIE",690,"DIAB",11,0,162.5,2)
	;;=9//^S X=FBBAL;REQ

FBINI03E
FBINI03E	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",690,"DR",1,162.5)
	;;=@1;W !!,"Enter Date Correct Invoice Received or Last Date of Service";1(whichever is later)~;I $P(^FBAAI(DA,0),U,7)>X W !?4,"Invoice date cannot be before Treatment To Date.",! S Y="@1";46;2;3;5;6;
	;;^UTILITY(U,$J,"DIE",690,"DR",1,162.5,1)
	;;=I $P(^FBAAI(DA,0),U,6)>X W !,*7,"To date cannot be before from date.",! S Y=5;@12;S FBHAC=$P(^FBAAI(DA,0),U,8);7;S FBAC=X;S FBHAP=$P(^FBAAI(DA,0),U,9);8;S FBAP=X;
	;;^UTILITY(U,$J,"DIE",690,"DR",1,162.5,2)
	;;=I FBAP>FBAC S $P(^FBAAI(DA,0),U,9)=FBHAP,$P(^(0),U,8)=FBHAC W !,*7,"Amount Paid cannot be greater than the Amount Claimed" S Y="@12";S:FBAC'=FBAP Y="@11";9////@;10////@;S Y=12;@11;S FBBAL=FBAC-FBAP;9////@;Q;I 1;9R~//^S X=FBBAL;
	;;^UTILITY(U,$J,"DIE",690,"DR",1,162.5,3)
	;;=10R~;S:X'=4 Y=12;18;12////^S X="V";S DIE("NO^")="OUTOK";20R~;21R~;22R~;23R~;
	;;^UTILITY(U,$J,"DIE",693,0)
	;;=FBCH EDIT 7078^2931012.1418^^162.4^705^^2931012
	;;^UTILITY(U,$J,"DIE",693,"DIAB",4,0,162.4,0)
	;;=5;"ADMITTING AUTHORITY"
	;;^UTILITY(U,$J,"DIE",693,"DR",1,162.4)
	;;=4;S FBTODT=X;4.5;5ADMITTING AUTHORITY~;6;7;S:'FBTODT Y="@12";12///^S X="@";9////^S X="C";S Y="@99";@12;12;9////^S X="I";@99;
	;;^UTILITY(U,$J,"DIE",696,0)
	;;=FBCH ENTER ROC^2930819.1241^^161.5^705^^2941219
	;;^UTILITY(U,$J,"DIE",696,"DR",1,161.5)
	;;=1////^S X=FBVD;2////^S X=DFN;3////^S X=FBDATE;4////^S X=FBADDT;5;6///^S X=FBPER;6.5:11;12////^S X=FBPHY;13////^S X=FBCHTEL;14///^S X=FBDIAG;16.5;S:X="" Y=16;S:X="N" Y=16;15;16;18;19////^S X=FBDOA;
	;;^UTILITY(U,$J,"DIE",697,0)
	;;=FBCH ADD ROC^2900817.0903^^161.5^^^2941219
	;;^UTILITY(U,$J,"DIE",697,"DR",1,161.5)
	;;=17;
	;;^UTILITY(U,$J,"DIE",697,"DR",2,161.517)
	;;=.01;2////^S X=DUZ;1;S FBDA(1)=DA;
	;;^UTILITY(U,$J,"DIE",698,0)
	;;=FBCH EDIT ROC^2930818.1957^^161.5^10116^^2941219
	;;^UTILITY(U,$J,"DIE",698,"DR",1,161.5)
	;;=5;6.5:11;I $D(FBCHVEN) S $P(^FBAA(161.5,DA,0),U,13)=FBCHVEN;I 1;12;S $P(^FBAA(162.2,DA,0),U,7)=X;13;S $P(^FBAA(162.2,DA,0),U,18)=X;16.5;S:X'="Y" Y="@1";15;S Y="@2";@1;15///@;@2;16;18;17;
	;;^UTILITY(U,$J,"DIE",698,"DR",2,161.517)
	;;=.01;1;2////^S X=DUZ;
	;;^UTILITY(U,$J,"DIE",1070,0)
	;;=FBCH REOPEN REQUEST^2920908.1018^^162.2^705^^2941219
	;;^UTILITY(U,$J,"DIE",1070,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1070,"%D",1,0)
	;;=Reopen CH request/notification
	;;^UTILITY(U,$J,"DIE",1070,"DR",1,162.2)
	;;=I '$D(FB1),'FB1 S Y="";S FB2=$P(^FBAA(162.2,DA,0),U,16);I FB1=2 S Y=11;8///@;9///@;10///@;11///@;14///@;12///@;13///@;I FB2'=4 S Y=100;15///@;100///^S X=FB1;K FB2;
	;;^UTILITY(U,$J,"DIE",1178,0)
	;;=FBNH ENTER CONTRACT^2931007.1236^^161.21^705^^2950124
	;;^UTILITY(U,$J,"DIE",1178,"%D",0)
	;;=^^1^1^2931012^^
	;;^UTILITY(U,$J,"DIE",1178,"%D",1,0)
	;;=Enter Contract Nursing Home contract information
	;;^UTILITY(U,$J,"DIE",1178,"DR",1,161.21)
	;;=S:'$G(FBVIEN) Y="";.01;.04////^S X=FBVIEN;.02;S FBEXDT=$P(^FBAA(161.21,DA,0),U,3);.03;S FBEXNDT=X;I $P(^FBAA(161.21,DA,0),U,2)>$P(^(0),U,3) W !,*7,"Expiration Date must be after the Effective Date.",! S Y=.02;
	;;^UTILITY(U,$J,"DIE",1179,0)
	;;=FB UNAUTHORIZED ENTER^2930910.1636^^162.7^10116^^2941227
	;;^UTILITY(U,$J,"DIE",1179,"%D",0)
	;;=^^1^1^2931012^^
	;;^UTILITY(U,$J,"DIE",1179,"%D",1,0)
	;;=Enter unauthorized claim
	;;^UTILITY(U,$J,"DIE",1179,"DIAB",1,1,162.715,0)
	;;=ALL
	;;^UTILITY(U,$J,"DIE",1179,"DIAB",5,0,162.7,3)
	;;=12//^S X=FBX;REQ
	;;^UTILITY(U,$J,"DIE",1179,"DIAB",6,0,162.7,2)
	;;=6;REQ
	;;^UTILITY(U,$J,"DIE",1179,"DIAB",7,0,162.7,3)
	;;=13//^S X=$S(FBDISP=1:FBTTO,1:"");REQ
	;;^UTILITY(U,$J,"DIE",1179,"DIAB",8,0,162.7,2)
	;;=9;T;DUP
	;;^UTILITY(U,$J,"DIE",1179,"DR",1,162.7)
	;;=S:'$D(FBVET)!('$D(FBVEN))!('$D(FBMASTER))!('$D(FBORDER))!('$D(FBTFROM))!('$D(FBTTO))!('$D(FBOK))!('$D(FBPR))!('$D(FBDA))!('$D(FBUC))!('$D(FBINENT)) Y="@999";2////^S X=FBVET;S:'FBVEN&(FBINENT) Y="@51";1////^S X=FBVEN;@51;
	;;^UTILITY(U,$J,"DIE",1179,"DR",1,162.7,1)
	;;=.5////^S X=FBPR;3///^S X=FBTFROM;S:'FBTTO&(FBINENT) Y="@52";4///^S X=FBTTO;@52;24////^S X=$$STATUS^FBUCUTL(FBORDER);20////^S X=FBMASTER;27////^S X=DUZ;28///^S X=DT;S:'FBOK Y="@1";7///^S X=DT;@1;S:'FBVEN&(FBINENT) Y="@53";23;@53;

FBINI03F
FBINI03F	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",1179,"DR",1,162.7,2)
	;;=.01;S:FBPR=7 FBX=3,Y="@4";S:$$DTC^FBUCUTL(DT,$S(FBPR=6!(FBPR=7):DT,1:FBTFROM))>730 FBX=6,Y="@4";S:$P(FBUC,U,7) Y="@999";5;6R~;8;9d~T~;S:'FBOK!($D(^FBAA(162.8,"ACD",FBDA))) Y="@99";10;S FBDISP=X;S:FBDISP FBORDER=40;
	;;^UTILITY(U,$J,"DIE",1179,"DR",1,162.7,3)
	;;=S Y=$S(FBDISP=1!(FBDISP=4):"@2",FBDISP=2:"@3",1:"@99");@2;S FBZDAYS=$$CDTC^FBUCUTL(+$G(^FB583(DA,0)),-731);S FBX=$S(FBTTO>FBZDAYS&(FBTFROM<FBZDAYS):FBZDAYS,1:FBTFROM);12R~//^S X=FBX;K FBX,FBZDAYS;13R~//^S X=$S(FBDISP=1:FBTTO,1:"");
	;;^UTILITY(U,$J,"DIE",1179,"DR",1,162.7,4)
	;;=14;S Y="@99";@3;15;S Y="@99";@4;D UNTIME^FBUCUTL(FBX);10////^S X=2;D DISAP^FBUCUTL(DA,FBX);S FBORDER=40;@99;S:FBORDER'=40 Y="@999";24////^S X=$$STATUS^FBUCUTL(FBORDER);@999;K FBDISP,FBX;
	;;^UTILITY(U,$J,"DIE",1179,"DR",2,162.715)
	;;=.01
	;;^UTILITY(U,$J,"DIE",1180,0)
	;;=FB UNAUTHORIZED PENDING^2930323.191^@^162.8^10116^@^2940811
	;;^UTILITY(U,$J,"DIE",1180,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1180,"%D",1,0)
	;;=Enter the appropriate information on pending unauthorized claim
	;;^UTILITY(U,$J,"DIE",1180,"DR",1,162.8)
	;;=I '$D(FBDA)!('$D(FBPEND))!('$D(FBARY))!('$D(FBOTHER)) S Y="@99";.02////^S X=FBDA;.03////^S X=FBPEND;I FBOTHER']"" S Y="@1";.04///^S X=FBOTHER;@1;.07////^S X=DUZ;@99;
	;;^UTILITY(U,$J,"DIE",1186,0)
	;;=FBAA VENDOR MRA^2930816.1353^^161.25^10116^^2950118
	;;^UTILITY(U,$J,"DIE",1186,"%D",0)
	;;=^^1^1^2931012^^
	;;^UTILITY(U,$J,"DIE",1186,"%D",1,0)
	;;=Create a vendor MRA to send to Austin
	;;^UTILITY(U,$J,"DIE",1186,"DR",1,161.25)
	;;=S:'$D(FBTOV)!('$D(FBT)) Y="";S:'$D(FEEO) FEEO="";S:FBT="C"&('$D(FBIEN1)) Y="";4////@;S:FBT'="C" Y="@43";5////^S X=FBIEN1;@43;S:FBTOV'="P" Y=2;1////^S X=FBT;S Y=$S(FEEO="":"@99",FEEO="Y":3,1:"@99");2////^S X=FBT;
	;;^UTILITY(U,$J,"DIE",1186,"DR",1,161.25,1)
	;;=S Y=$S(FEEO="":"@99",FEEO="Y":3,1:"@99");3////^S X=FEEO;S Y="";@99;3////@;
	;;^UTILITY(U,$J,"DIE",1187,0)
	;;=FB UNAUTHORIZED UPDATE^2931012.1241^@^162.7^10116^@^2950130
	;;^UTILITY(U,$J,"DIE",1187,"%D",0)
	;;=^^1^1^2931012^^^
	;;^UTILITY(U,$J,"DIE",1187,"%D",1,0)
	;;=Update certain unauthorized claims fields upon completion of enter/edit
	;;^UTILITY(U,$J,"DIE",1187,"DR",1,162.7)
	;;=S:'$D(FBSTATUS)!('$D(FBEXP))!('$D(FBORIG))!('$D(FBVALID))!('$D(FBLET))!('$D(FBDISPDT))!('$D(DT)) Y="@99";S:FBEXP=0 Y="@1";S:FBEXP'="@" Y="@40";26///@;S Y="@1";@40;26///^S X=FBEXP;@1;S:FBORIG=0 Y="@2";S:FBORIG'="@" Y="@41";22///@;
	;;^UTILITY(U,$J,"DIE",1187,"DR",1,162.7,1)
	;;=S Y="@2";@41;22///^S X=FBORIG;@2;S:FBVALID=0 Y="@3";S:FBVALID'="@" Y="@42";7///@;S Y="@3";@42;7///^S X=FBVALID;@3;S:FBLET=0 Y="@4";S:FBLET'="@" Y="@43";19///@;S Y="@4";@43;19///^S X=FBLET;@4;S:FBDISPDT=0 Y="@5";
	;;^UTILITY(U,$J,"DIE",1187,"DR",1,162.7,2)
	;;=S:FBDISPDT'="@" Y="@44";11///@;S Y="@5";@44;11///^S X=FBDISPDT;@5;S:'FBSTATUS Y="@99";S:FBSTATUS'="@" Y="@45";24///@;S Y=25;@45;24////^S X=FBSTATUS;25///^S X=DT;@99;
	;;^UTILITY(U,$J,"DIE",1188,0)
	;;=FB UNAUTHORIZED UPDATE^2940912.1048^^161^1555^^2950130
	;;^UTILITY(U,$J,"DIE",1188,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1188,"%D",1,0)
	;;=Enter authorization based on discharge type of unauthorized claim
	;;^UTILITY(U,$J,"DIE",1188,"DIAB",2,1,161.01,2)
	;;=.096;REQ
	;;^UTILITY(U,$J,"DIE",1188,"DIAB",3,1,161.01,2)
	;;=.097;REQ
	;;^UTILITY(U,$J,"DIE",1188,"DR",1,161)
	;;=S:'$D(FBIEN)!('$D(FBDA))!('$D(FBV))!('$D(FBDCHG))!('$D(FBUCA)) Y="@99";1///^S X="`"_+FBIEN;@99;
	;;^UTILITY(U,$J,"DIE",1188,"DR",2,161.01)
	;;=W !,"Entering authorization...",!;S:'+FBDCHG Y="@1";.06////^S X=+FBDCHG;@1;.02///^S X=$P(FBUCA,U,14);.03////^S X=$P(FBUCA,U,2);.04////^S X=$P(FBUCA,U,3);.055////^S X=FBV;.065///^S X=$P(FBUCA,U,10);
	;;^UTILITY(U,$J,"DIE",1188,"DR",2,161.01,1)
	;;=.07////^S X=$S(+$P(FBUCA,U,2)=6!(+$P(FBUCA,U,2)=7):$$POV^FBAAUTL3(31),1:$$POV^FBAAUTL3("02"));.08///^S X=$G(^FB583(FBDA,"DX"));.095////^S X=1;1////^S X="N";100////^S X=DUZ;101////^S X=$P(FBUCA,U,7);
	;;^UTILITY(U,$J,"DIE",1188,"DR",2,161.01,2)
	;;=W !?3,"No: ",FBDA,?15,"Treatment From: ",$$DATX^FBAAUTL($P(FBUCA,U,5)) W:$P(FBUCA,U,6) ?40,"Treatment To: ",$$DATX^FBAAUTL($P(FBUCA,U,6));.096R~;.097R~;

FBINI03G
FBINI03G	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",1190,0)
	;;=FB UNAUTHORIZED EDIT^2940519.1055^@^162.7^10226^@^2941227
	;;^UTILITY(U,$J,"DIE",1190,"%D",0)
	;;=^^1^1^2931012^^
	;;^UTILITY(U,$J,"DIE",1190,"%D",1,0)
	;;=Modify/reopen an unauthorized claim
	;;^UTILITY(U,$J,"DIE",1190,"DIAB",1,1,162.715,0)
	;;=ALL
	;;^UTILITY(U,$J,"DIE",1190,"DIAB",2,0,162.7,5)
	;;=13;REQ
	;;^UTILITY(U,$J,"DIE",1190,"DIAB",4,0,162.7,3)
	;;=12;REQ
	;;^UTILITY(U,$J,"DIE",1190,"DR",1,162.7)
	;;=S:'$$EDOK^FBUCUTL3(DA,1) Y="@89";S:'$D(FBUCP)!('$D(FBACT)) Y="@99";S DIE("NO^")="BACKOUTOK";S:FBACT'="REO" Y=.01;21///^S X=DT;.01;S Y=$S(FBACT'="REO":"@51",$$PAY^FBUCUTL(DA,"FB583("):"@55",1:"@51");@51;.5;1;S:FBACT="REO" Y="@53";2;
	;;^UTILITY(U,$J,"DIE",1190,"DR",1,162.7,1)
	;;=@53;23;S DIE("NO^")="BACK";3;4;5;6;8;9;@55;S DIE("NO^")="BACK";S:$$ORDER^FBUCUTL(+$P(FBUCP,U,24))=5 Y="@99";
	;;^UTILITY(U,$J,"DIE",1190,"DR",1,162.7,2)
	;;=S FBDISP(0)=$G(^FB583(DA,0)),FBDISP("FRTO")=$P(FBDISP(0),U,5,6),FBDISP("FR")=$P(FBDISP("FRTO"),U),FBDISP("TO")=$P(FBDISP("FRTO"),U,2);10;S FBDISP=X;S Y=$S(FBDISP="":"@99",'(FBDISP=1!(FBDISP=4)):"@1",1:"@10");@10;
	;;^UTILITY(U,$J,"DIE",1190,"DR",1,162.7,3)
	;;=S FBZDAYS=$$CDTC^FBUCUTL($P(FBDISP(0),U),-731);S FBX=$S(FBDISP("TO")>FBZDAYS&(FBDISP("FR")<FBZDAYS):FBZDAYS,1:FBDISP("FR"));12///^S X=$S($P(FBUCP,U,13)&($P(FBUCP,U,13)'>FBDISP("FR")):$P(FBUCP,U,13),1:FBX);12R~;K FBX,FBZDAYS;
	;;^UTILITY(U,$J,"DIE",1190,"DR",1,162.7,4)
	;;=S Y=$S('$P(FBUCP,U,14):"@13",FBDISP=4&(FBDISP'=$P(FBUCP,U,11)):"@12",FBDISP=4:"@13",1:"@11");@11;13///^S X=$S($P(FBUCP,U,14)&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),1:FBDISP("TO"));S Y="@13";@12;13///@;@13;
	;;^UTILITY(U,$J,"DIE",1190,"DR",1,162.7,5)
	;;=13///^S X=$S(FBDISP=1&($P(FBUCP,U,14))&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),FBDISP=1:FBDISP("TO"),1:"");13R~;@89;14;S Y="@99";@1;15;12///@;13///@;14///@;@99;K FBDISP,DIE("NO^");
	;;^UTILITY(U,$J,"DIE",1190,"DR",2,162.715)
	;;=.01
	;;^UTILITY(U,$J,"DIE",1191,0)
	;;=FB UNAUTHORIZED APPEAL^2940328.1532^@^162.7^10226^@^2950130
	;;^UTILITY(U,$J,"DIE",1191,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1191,"%D",1,0)
	;;=Initiate appeal of unauthorized claim
	;;^UTILITY(U,$J,"DIE",1191,"DIAB",1,1,162.715,0)
	;;=ALL
	;;^UTILITY(U,$J,"DIE",1191,"DIAB",2,0,162.7,0)
	;;=50;"T"
	;;^UTILITY(U,$J,"DIE",1191,"DIAB",2,0,162.7,4)
	;;=13;REQ
	;;^UTILITY(U,$J,"DIE",1191,"DIAB",3,0,162.7,2)
	;;=12;REQ
	;;^UTILITY(U,$J,"DIE",1191,"DIAB",6,0,162.7,0)
	;;=51;"T"
	;;^UTILITY(U,$J,"DIE",1191,"DIAB",12,0,162.7,0)
	;;=10;REQ
	;;^UTILITY(U,$J,"DIE",1191,"DR",1,162.7)
	;;=S:'$D(FBUCP) Y="@99";50T~;S:X']"" Y="@99";S FBDT=X;S:+$P(FBUCP,U,26)&(FBDT>+$P(FBUCP,U,26)) FBX=6,Y="@4";51T~;S:X']"" Y="@99";52;S:X']"" Y="@99";53;S:X']"" Y="@99";10R~;S FBDISP=X;
	;;^UTILITY(U,$J,"DIE",1191,"DR",1,162.7,1)
	;;=S FBDISP("FR")=$P(FBUCP,U,5),FBDISP("TO")=$P(FBUCP,U,6);S Y=$S(FBDISP="":"@99",'(FBDISP=1!(FBDISP=4)):"@1",1:"@10");@10;S FBZDAYS=$$CDTC^FBUCUTL($P(FBUCP,U),-731);
	;;^UTILITY(U,$J,"DIE",1191,"DR",1,162.7,2)
	;;=S FBX=$S(FBDISP("TO")>FBZDAYS&(FBDISP("FR")<FBZDAYS):FBZDAYS,1:FBDISP("FR"));12///^S X=$S($P(FBUCP,U,13)&($P(FBUCP,U,13)'>FBDISP("FR")):$P(FBUCP,U,13),1:FBX);12R~;K FBX,FBZDAYS;
	;;^UTILITY(U,$J,"DIE",1191,"DR",1,162.7,3)
	;;=S Y=$S('$P(FBUCP,U,14):"@13",FBDISP=4&(FBDISP'=$P(FBUCP,U,11)):"@12",FBDISP=4:"@13",1:"@11");@11;13///^S X=$S($P(FBUCP,U,14)&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),1:FBDISP("TO"));S Y="@13";@12;13///@;@13;
	;;^UTILITY(U,$J,"DIE",1191,"DR",1,162.7,4)
	;;=13///^S X=$S(FBDISP=1&($P(FBUCP,U,14))&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),FBDISP=1:FBDISP("TO"),1:"");13R~;14;S Y="@99";@1;15;S:FBDISP=4 Y="@99";12///@;13///@;14///@;S Y="@99";@4;D UNTIME^FBUCUTL(FBX);10////^S X=2;
	;;^UTILITY(U,$J,"DIE",1191,"DR",1,162.7,5)
	;;=D DISAP^FBUCUTL(DA,FBX);@99;K FBDISP,FBDT,FBX;
	;;^UTILITY(U,$J,"DIE",1191,"DR",2,162.715)
	;;=.01
	;;^UTILITY(U,$J,"DIE",1192,0)
	;;=FB UNAUTHORIZED APPEAL EDIT^2940328.1546^@^162.7^10226^@^2950130
	;;^UTILITY(U,$J,"DIE",1192,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1192,"%D",1,0)
	;;=Edit unauthorized claim

FBINI03H
FBINI03H	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",1192,"DIAB",1,0,162.7,5)
	;;=13;REQ
	;;^UTILITY(U,$J,"DIE",1192,"DIAB",1,1,162.715,0)
	;;=ALL
	;;^UTILITY(U,$J,"DIE",1192,"DIAB",2,0,162.7,0)
	;;=50;"T"
	;;^UTILITY(U,$J,"DIE",1192,"DIAB",2,0,162.7,3)
	;;=12;REQ
	;;^UTILITY(U,$J,"DIE",1192,"DIAB",4,0,162.7,0)
	;;=51;"T"
	;;^UTILITY(U,$J,"DIE",1192,"DIAB",6,0,162.7,1)
	;;=10;REQ
	;;^UTILITY(U,$J,"DIE",1192,"DR",1,162.7)
	;;=S:'$D(FBUCP)!('$D(FBUCPA)) Y="@99";50T~;S:X']"" Y=$S($P(FBUCPA,U,4):"@96",$P(FBUCPA,U,3):"@97",$P(FBUCPA,U,2):"@98",1:"@99");51T~;S:X']"" Y=$S($P(FBUCPA,U,4):"@96",$P(FBUCPA,U,3):"@97",1:"@99");52;
	;;^UTILITY(U,$J,"DIE",1192,"DR",1,162.7,1)
	;;=S:X']"" Y=$S($P(FBUCPA,U,4):"@96",1:"@99");S FBDT=X S:+$P(FBUCP,U,26)&(FBDT>+$P(FBUCP,U,26)) FBX=6,Y="@4";53;S:X']"" Y="@99";S FBDISP("FR")=$P(FBUCP,U,5),FBDISP("TO")=$P(FBUCP,U,6);10R~;
	;;^UTILITY(U,$J,"DIE",1192,"DR",1,162.7,2)
	;;=S FBDISP=X S Y=$S(FBDISP="":"@99",'(FBDISP=1!(FBDISP=4)):"@1",1:"@10");@10;S FBZDAYS=$$CDTC^FBUCUTL($P(FBUCP,U),-731);S FBX=$S(FBDISP("TO")>FBZDAYS&(FBDISP("FR")<FBZDAYS):FBZDAYS,1:FBDISP("FR"));
	;;^UTILITY(U,$J,"DIE",1192,"DR",1,162.7,3)
	;;=12///^S X=$S($P(FBUCP,U,13)&($P(FBUCP,U,13)'>FBDISP("FR")):$P(FBUCP,U,13),1:FBX);12R~;K FBX,FBZDAYS;S Y=$S('$P(FBUCP,U,14):"@13",FBDISP=4&(FBDISP'=$P(FBUCP,U,11)):"@12",FBDISP=4:"@13",1:"@11");@11;
	;;^UTILITY(U,$J,"DIE",1192,"DR",1,162.7,4)
	;;=13///^S X=$S($P(FBUCP,U,14)&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),1:FBDISP("TO"));S Y="@13";@12;13///@;@13;13///^S X=$S(FBDISP=1&($P(FBUCP,U,14))&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),FBDISP=1:FBDISP("TO"),1:"");
	;;^UTILITY(U,$J,"DIE",1192,"DR",1,162.7,5)
	;;=13R~;14;S Y="@99";@1;15;S:FBDISP=4 Y="@99";12///@;13///@;14///@;S Y="@99";@4;D UNTIME^FBUCUTL(FBX);10////^S X=2;D DISAP^FBUCUTL(DA,FBX);S Y="@99";@96;53///@;@97;52///@;@98;51///@;@99;K FBDISP,FBDT,FBX;
	;;^UTILITY(U,$J,"DIE",1192,"DR",2,162.715)
	;;=.01
	;;^UTILITY(U,$J,"DIE",1194,0)
	;;=FB UNAUTHORIZED COVA APPEAL^2940328.156^@^162.7^10226^@^2940328
	;;^UTILITY(U,$J,"DIE",1194,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1194,"%D",1,0)
	;;=COVA appeal enter/edit
	;;^UTILITY(U,$J,"DIE",1194,"DIAB",1,1,162.715,0)
	;;=ALL
	;;^UTILITY(U,$J,"DIE",1194,"DIAB",2,0,162.7,4)
	;;=13;REQ
	;;^UTILITY(U,$J,"DIE",1194,"DIAB",3,0,162.7,2)
	;;=12;REQ
	;;^UTILITY(U,$J,"DIE",1194,"DR",1,162.7)
	;;=S:'$D(FBUCP)!('$D(FBUCPA)) Y="@99";S FBO=$$STATUS^FBUCUTL($P(FBUCP,U,24));54;S Y=$S(X']""&($P(FBUCPA,U,6)):"@98",X="":Y="@99",1:"@9");@9;S FBDT=X S:+$P(FBUCP,U,26)&(+$P(FBUCP,U,26)) FBX=6,Y="@4";55;S:X']"" Y="@99";
	;;^UTILITY(U,$J,"DIE",1194,"DR",1,162.7,1)
	;;=S FBDISP("FR")=$P(FBUCP,U,5),FBDISP("TO")=$P(FBUCP,U,6);10;S FBDISP=X,Y=$S(FBDISP="":"@99",'(FBDISP=1!(FBDISP=4)):"@1",1:"@10");@10;S FBZDAYS=$$CDTC^FBUCUTL($P(FBUCP,U),-731);
	;;^UTILITY(U,$J,"DIE",1194,"DR",1,162.7,2)
	;;=S FBX=$S(FBDISP("TO")>FBZDAYS&(FBDISP("FR")<FBZDAYS):FBZDAYS,1:FBDISP("FR"));12///^S X=$S($P(FBUCP,U,13)&($P(FBUCP,U,13)'>FBDISP("FR")):$P(FBUCP,U,13),1:FBX);12R~;K FBX,FBZDAYS;
	;;^UTILITY(U,$J,"DIE",1194,"DR",1,162.7,3)
	;;=S Y=$S('$P(FBUCP,U,14):"@13",FBDISP=4&(FBDISP'=$P(FBUCP,U,11)):"@12",FBDISP=4:"@13",1:"@11");@11;13///^S X=$S($P(FBUCP,U,14)&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),1:FBDISP("TO"));S Y="@13";@12;13///@;@13;
	;;^UTILITY(U,$J,"DIE",1194,"DR",1,162.7,4)
	;;=13///^S X=$S(FBDISP=1&($P(FBUCP,U,14))&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),FBDISP=1:FBDISP("TO"),1:"");13R~;14;S Y="@99";@1;15;S:FBDISP=4 Y="@99";12///@;13///@;14///@;S Y="@99";@4;D UNTIME^FBUCUTL(FBX);10////^S X=2;
	;;^UTILITY(U,$J,"DIE",1194,"DR",1,162.7,5)
	;;=D DISAP^FBUCUTL(DA,FBX);S Y="@99";@98;55///@;@99;K FBDISP,FBDT,FBO,FBX;
	;;^UTILITY(U,$J,"DIE",1194,"DR",2,162.715)
	;;=.01
	;;^UTILITY(U,$J,"DIE",1196,0)
	;;=FB UNAUTHORIZED DISPOSITION^2940519.1102^@^162.7^10226^@^2950130
	;;^UTILITY(U,$J,"DIE",1196,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1196,"%D",1,0)
	;;=Disposition an unauthorized claim
	;;^UTILITY(U,$J,"DIE",1196,"DIAB",1,1,162.715,0)
	;;=ALL
	;;^UTILITY(U,$J,"DIE",1196,"DIAB",2,0,162.7,4)
	;;=13;REQ

FBINI03I
FBINI03I	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",1196,"DIAB",3,0,162.7,2)
	;;=12;REQ
	;;^UTILITY(U,$J,"DIE",1196,"DR",1,162.7)
	;;=S:'$$EDOK^FBUCUTL3(DA,1) Y="@89";S:'$D(FBUCP)!('$D(FBUCPA)) Y="@99";S FBO=$$ORDER^FBUCUTL($P(FBUCP,U,24));10;S FBDISP=X;S FBDISP("FR")=$P(FBUCP,U,5),FBDISP("TO")=$P(FBUCP,U,6);
	;;^UTILITY(U,$J,"DIE",1196,"DR",1,162.7,1)
	;;=S Y=$S(FBDISP']""&(FBO=90):"@94",FBDISP']""&(FBO=60):"@93",FBDISP']"":"@99",'(FBDISP=1!(FBDISP=4)):"@2",1:"@10");@10;S FBZDAYS=$$CDTC^FBUCUTL($P(FBUCP,U),-731);
	;;^UTILITY(U,$J,"DIE",1196,"DR",1,162.7,2)
	;;=S FBX=$S(FBDISP("TO")>FBZDAYS&(FBDISP("FR")<FBZDAYS):FBZDAYS,1:FBDISP("FR"));12///^S X=$S($P(FBUCP,U,13)&($P(FBUCP,U,13)'>FBDISP("FR")):$P(FBUCP,U,13),1:FBX);12R~;K FBX,FBZDAYS;
	;;^UTILITY(U,$J,"DIE",1196,"DR",1,162.7,3)
	;;=S Y=$S('$P(FBUCP,U,14):"@1",FBDISP=4&(FBDISP'=$P(FBUCP,U,11)):"@12",FBDISP=4:"@1",1:"@11");@11;13///^S X=$S($P(FBUCP,U,14)&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),1:FBDISP("TO"));S Y="@1";@12;13///@;@1;
	;;^UTILITY(U,$J,"DIE",1196,"DR",1,162.7,4)
	;;=13///^S X=$S(FBDISP=1&($P(FBUCP,U,14))&($P(FBUCP,U,14)'>FBDISP("TO")):$P(FBUCP,U,14),FBDISP=1:FBDISP("TO"),1:"");13R~;@89;14;S Y="@3";@2;15;12///@;13///@;14///@;@3;S Y=$S('$G(FBO):"@99",FBO=60:"@5",FBO=80:"@4",1:"@99");@4;
	;;^UTILITY(U,$J,"DIE",1196,"DR",1,162.7,5)
	;;=53///^S X=DT;S Y="@99";@5;55///^S X=DT;S Y="@99";@93;53///@;S Y="@99";@94;55///@;@99;K FBDISP,FBO;
	;;^UTILITY(U,$J,"DIE",1196,"DR",2,162.715)
	;;=.01
	;;^UTILITY(U,$J,"DIE",1206,0)
	;;=FB UNAUTHORIZED PREVIOUS^2930610.1417^@^162.7^10116^@^2930610
	;;^UTILITY(U,$J,"DIE",1206,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1206,"%D",1,0)
	;;=Return previous values due to incomplete transaction
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7)
	;;=S:'$D(FBACT)!('$D(FBUCP))!('$D(FBUCPA))!('$D(FBUCA))!('$D(FBUCAA)) Y="@99";S:FBUCP=FBUCA&(FBUCPA=FBUCAA) Y="@99";S Y=$S(FBACT="EDT"!(FBACT="REO"):"@3",FBACT="APL"!(FBACT="AED"):"@2",FBACT="DIS":"@5",FBACT="BVA":"@1",1:"@99");@1;
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7,1)
	;;=S FBX=$S($P(FBUCPA,U,5)]"":$P(FBUCPA,U,5),1:"@");54///^S X=FBX;S FBX=$S($P(FBUCPA,U,6)]"":$P(FBUCPA,U,6),1:"@");55///^S X=FBX;S:$P(FBUCAA,U,6) Y="@5";S Y="@99";@2;S FBX=$S($P(FBUCPA,U)]"":$P(FBUCPA,U),1:"@");50///^S X=FBX;
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7,2)
	;;=S FBX=$S($P(FBUCPA,U,2)]"":$P(FBUCPA,U,2),1:"@");51///^S X=FBX;S FBX=$S($P(FBUCPA,U,3)]"":$P(FBUCPA,U,3),1:"@");52///^S X=FBX;S FBX=$S($P(FBUCPA,U,4)]"":$P(FBUCPA,U,4),1:"@");53///^S X=FBX;S:$P(FBUCAA,U,4) Y="@5";S Y="@99";@3;
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7,3)
	;;=S FBX=$P(FBUCP,U);.01///^S X=FBX;S FBX=$S($P(FBUCP,U,2)]"":$P(FBUCP,U,2),1:"@");.5////^S X=FBX;S FBX=$S($P(FBUCP,U,3)]"":$P(FBUCP,U,3),1:"@");1////^S X=FBX;S FBX=$S($P(FBUCP,U,4)]"":$P(FBUCP,U,4),1:"@");2////^S X=FBX;
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7,4)
	;;=S FBX=$S($P(FBUCP,U,5)]"":$P(FBUCP,U,5),1:"@");3///^S X=FBX;S FBX=$S($P(FBUCP,U,6)]"":$P(FBUCP,U,6),1:"@");4///^S X=FBX;S:'$D(FBUCPDX) Y="@4";S FBX=$S(FBUCPDX]"":FBUCPDX,1:"@");5///^S X=FBX;@4;
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7,5)
	;;=S FBX=$S($P(FBUCP,U,7)]"":$P(FBUCP,U,7),1:"@");6////^S X=FBX;S FBX=$S($P(FBUCP,U,9)]"":$P(FBUCP,U,9),1:"@");8///^S X=FBX;S FBX=$S($P(FBUCP,U,10)]"":$P(FBUCP,U,10),1:"@");9///^S X=FBX;
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7,6)
	;;=S FBX=$S($P(FBUCP,U,21)]"":$P(FBUCP,U,21),1:"@");21///^S X=FBX;S FBX=$S($P(FBUCP,U,23)]"":$P(FBUCP,U,23),1:"@");23///^S X=FBX;@5;S:$P(FBUCP,U,11)=$P(FBUCA,U,11) Y="@99";S FBX=$S($P(FBUCP,U,11)]"":$P(FBUCP,U,11),1:"@");
	;;^UTILITY(U,$J,"DIE",1206,"DR",1,162.7,7)
	;;=10////^S X=FBX;S FBX=$S($P(FBUCP,U,13)]"":$P(FBUCP,U,13),1:"@");12///^S X=FBX;S FBX=$S($P(FBUCP,U,14)]"":$P(FBUCP,U,14),1:"@");13///^S X=FBX;S:$P(FBUCA,U,11)=1!($P(FBUCA,U,11)=4) Y="@99";D DELDAP^FBUCUTL3(DA);@99;K FBX;
	;;^UTILITY(U,$J,"DIE",1209,0)
	;;=FB UNAUTHORIZED LETTER UPDATE^2930407.1252^@^162.7^10116^@^2940920
	;;^UTILITY(U,$J,"DIE",1209,"%D",0)
	;;=^^1^1^2931012^^
	;;^UTILITY(U,$J,"DIE",1209,"%D",1,0)
	;;=Update unauthorized claim with information regarding letter (used if not sending letters with software)

FBINI03J
FBINI03J	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIE",1209,"DR",1,162.7)
	;;=S:'$D(FBEXP)!('$D(FBLET))!('$D(FBLETDT)) Y="@99";S:FBEXP=0 Y="@1";26///^S X=FBEXP;@1;S:FBLET=0 Y="@99";19///^S X=FBLET;S:FBLETDT=0 Y="@99";19.5///^S X=FBLETDT;@99;
	;;^UTILITY(U,$J,"DIE",1213,0)
	;;=FB VENDOR UPDATE^2940405.1041^^161.2^1555^^2950118
	;;^UTILITY(U,$J,"DIE",1213,"%D",0)
	;;=^^1^1^2931012^^
	;;^UTILITY(U,$J,"DIE",1213,"%D",1,0)
	;;=Update Austin vendor information
	;;^UTILITY(U,$J,"DIE",1213,"DR",1,161.2)
	;;=S:'$D(Z1) Y="@10";.01////^S X=$P(Z1,U);1////^S X=$P(Z1,U,2);2////^S X=$P(Z1,U,3);3////^S X=$P(Z1,U,4);4////^S X=$P(Z1,U,5);5////^S X=$P(Z1,U,6);6////^S X=$P(Z1,U,7);.05////^S X=$P(Z1,U,8);7////^S X=$P(Z1,U,9);8////^S X=$P(Z1,U,10);
	;;^UTILITY(U,$J,"DIE",1213,"DR",1,161.2,1)
	;;=5.5////^S X=$P(Z1,U,13);2.5////@;2.5////^S X=$P(Z1,U,14);22////^S X=$P(Z1,U,17);5.18////^S X=$P(Z1,U,18);@10;S:'$D(Z3) Y="@20";14////^S X=$P(Z3,U,1);@20;S:'$D(Z4) Y="";S:$G(FBTMPCK) Y="@30";30.01////^S X=$P(Z4,U);@30;
	;;^UTILITY(U,$J,"DIE",1213,"DR",1,161.2,2)
	;;=30.02////^S X=$P(Z4,U,2);30.03////^S X=$P(Z4,U,3);30.04////^S X=$P(Z4,U,4);30.05////^S X=$P(Z4,U,5);30.06////^S X=$P(Z4,U,6);
	;;^UTILITY(U,$J,"DIE",1213,"ROU")
	;;=^FBCTV
	;;^UTILITY(U,$J,"DIE",1213,"ROUOLD")
	;;=FBCTV
	;;^UTILITY(U,$J,"DIE",1219,0)
	;;=FB ADD RX^2930915.1039^^162.1^705^^2950119
	;;^UTILITY(U,$J,"DIE",1219,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIE",1219,"%D",1,0)
	;;=Add pharmacy prescription
	;;^UTILITY(U,$J,"DIE",1219,"DR",1,162.1)
	;;=S:'$D(FBDA)!('$D(DATEF))!('$D(DFN))!('$D(FBPSA))!('$D(FB7078))!('$D(FBASSOC))!('$D(FBAAPTC)) Y="";K FBUP;4///^S X="`"_+FBDA;@99;
	;;^UTILITY(U,$J,"DIE",1219,"DR",2,162.11)
	;;=2///^S X=DATEF;4////^S X=DFN;25////^S X=FBPSA;S Y=$S($D(FBV583):"@1",1:"@2");@1;S:FBV583']"" Y="@3";26////^S X=FBV583;S Y="@3";@2;S:FB7078']"" Y="@3";26////^S X=FB7078;@3;27///^S X=FBASSOC;16///^S X=FBAAPTC;3;S AC=X;1;1.4;1.5;1.6;
	;;^UTILITY(U,$J,"DIE",1219,"DR",2,162.11,1)
	;;=8///^S X=1;S FBUP=1;
	;;^UTILITY(U,$J,"DIE",1222,0)
	;;=FB UNAUTHORIZED EDIT^2931027.141^^161^10116^^2940429
	;;^UTILITY(U,$J,"DIE",1222,"%D",0)
	;;=^^3^3^2931012^^^
	;;^UTILITY(U,$J,"DIE",1222,"%D",1,0)
	;;=If dispositioned claim has been reopened, this template is 
	;;^UTILITY(U,$J,"DIE",1222,"%D",2,0)
	;;=used to keep the authorization information in synch with the unauthorized
	;;^UTILITY(U,$J,"DIE",1222,"%D",3,0)
	;;=claim
	;;^UTILITY(U,$J,"DIE",1222,"DIAB",3,1,161.01,0)
	;;=.06;REQ
	;;^UTILITY(U,$J,"DIE",1222,"DR",1,161)
	;;=S:'$D(FBIEN) Y="@99";1///^S X="`"_+FBIEN;@99;
	;;^UTILITY(U,$J,"DIE",1222,"DR",2,161.01)
	;;=W !,"Editing authorization...",!;S:$P(FBUCP,U,2)'=6 Y="@1";.06R~;@1;.096;.097;
	;;^UTILITY(U,$J,"DIE",1224,0)
	;;=FB UNAUTHORIZED UPDATE1^2931004.122^^161^10116^^2940314
	;;^UTILITY(U,$J,"DIE",1224,"%D",0)
	;;=^^1^1^2931013^^
	;;^UTILITY(U,$J,"DIE",1224,"%D",1,0)
	;;=Update authorization based on changes to unauthorized claim
	;;^UTILITY(U,$J,"DIE",1224,"DR",1,161)
	;;=S:'$D(FBIEN)!('$D(FBDA))!('$D(FBV))!('$D(FBUCA)) Y="@99";1///^S X="`"_+FBIEN;@99;
	;;^UTILITY(U,$J,"DIE",1224,"DR",2,161.01)
	;;=W !,"Updating authorization...",!;.01///^S X=$P(FBUCA,U,13);.02///^S X=$P(FBUCA,U,14);.03////^S X=$P(FBUCA,U,2);.04////^S X=$P(FBUCA,U,3);.055////^S X=FBV;.065///^S X=$P(FBUCA,U,10);
	;;^UTILITY(U,$J,"DIE",1224,"DR",2,161.01,1)
	;;=.07////^S X=$S(+$P(FBUCA,U,2)=6!(+$P(FBUCA,U,2)=7):$$POV^FBAAUTL3(31),1:$$POV^FBAAUTL3("02"));.08///^S X=$G(^FB583(FBDA,"DX"));.095////^S X=1;1///^S X="N";
	;;^UTILITY(U,$J,"DIPT",919,0)
	;;=FB BATCH LIST^2930111.0813^@^161.7^705^@^2941219
	;;^UTILITY(U,$J,"DIPT",919,"%D",0)
	;;=^^1^1^2931012^^^^
	;;^UTILITY(U,$J,"DIPT",919,"%D",1,0)
	;;=List batch
	;;^UTILITY(U,$J,"DIPT",919,"F",2)
	;;=.01;"BATCH NUMBER"~1~2;"FEE PROGRAM"~11~
	;;^UTILITY(U,$J,"DIPT",919,"H")
	;;=FEE BASIS BATCH LIST
	;;^UTILITY(U,$J,"DIPT",921,0)
	;;=FBAA RX PENDING^2950110.1251^@^162.1^705^@^2950110
	;;^UTILITY(U,$J,"DIPT",921,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIPT",921,"%D",1,0)
	;;=Prescriptions pending pharmacy review
	;;^UTILITY(U,$J,"DIPT",921,"F",1)
	;;=4,-161,^FBAAA(^^S I(1,0)=D1 S I(0,0)=D0 S DIP(1)=$S($D(^FBAA(162.1,D0,"RX",D1,0)):^(0),1:"") S X=$P(DIP(1),U,5),X=X S D(0)=+X;Z;"PATIENT:"~

FBINI03K
FBINI03K	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIPT",921,"F",2)
	;;=4,-161,-2,^DPT(^^S I(100,0)=D0 S DIP(101)=$S($D(^FBAAA(D0,0)):^(0),1:"") S X=$P(DIP(101),U,1),X=X S D(0)=+X;Z;".01:"~
	;;^UTILITY(U,$J,"DIPT",921,"F",3)
	;;=4,-161,-2,S DIP(201)=$S($D(^DPT(D0,.36)):^(.36),1:"") S X="Pt.ID: "_$P(DIP(201),U,3) W X K DIP;C20;N;"";Z;""Pt.ID: "_PRIMARY LONG"~
	;;^UTILITY(U,$J,"DIPT",921,"F",4)
	;;=0;C1;L9;S1;"INVOICE #"~3;C13;L42~-161.2,^FBAAV(^^S I(0,0)=D0 S DIP(1)=$S($D(^FBAA(162.1,D0,0)):^(0),1:"") S X=$P(DIP(1),U,4),X=X S D(0)=+X;Z;"VEN:"~
	;;^UTILITY(U,$J,"DIPT",921,"F",5)
	;;=-161.2,1;C59;L15;"VENDOR ID"~4,"Date Filled: ";C3;""~4,2;C16;""~4,"RX #: ";C45;""~4,.01;C51;""~4,1;C7;L35~4,1.5;C44;L15~4,1.6;C63;L15~W "";"";Z;"W """~
	;;^UTILITY(U,$J,"DIPT",921,"H")
	;;=PRESCRIPTIONS PENDING PHARMACY REVIEW
	;;^UTILITY(U,$J,"DIPT",925,0)
	;;=FBCH PENDING REQUEST^2930315.1147^@^162.2^1555^@^2941219
	;;^UTILITY(U,$J,"DIPT",925,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIPT",925,"%D",1,0)
	;;=Fee notifications/requests pending entitlement
	;;^UTILITY(U,$J,"DIPT",925,"DXS",1,9.2)
	;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^FBAA(162.2,D0,0)):^(0),1:""),D0=$P(DIP(1),U,4) S:'$D(^DPT(+D0,0)) D0=-1 S DIP(101)=$S($D(^DPT(D0,0)):^(0),1:"")
	;;^UTILITY(U,$J,"DIPT",925,"F",1)
	;;=W "";"";Z;"W """~.01;"DATE of REQUEST";S1~3;"PATIENT NAME"~X DXS(1,9.2) S X=$P(DIP(101),U,9) S D0=I(0,0) W X K DIP;"Pt.ID";Z;"VET:SSN"~
	;;^UTILITY(U,$J,"DIPT",925,"F",2)
	;;="Authorized From Date: ";C3~4;""~"Admission Date: ";C3~3.5~
	;;^UTILITY(U,$J,"DIPT",925,"H")
	;;=FEE NOTIFICATION/REQUEST PENDING ENTITLEMENT
	;;^UTILITY(U,$J,"DIPT",929,0)
	;;=FBCH 7078 CANCEL^2921008.1505^@^162.4^705^@^2941219
	;;^UTILITY(U,$J,"DIPT",929,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIPT",929,"%D",1,0)
	;;=Listing of cancelled 7078s
	;;^UTILITY(U,$J,"DIPT",929,"F",2)
	;;=.01;C1;S1;R11;"7078"~2;C13;R30;"PATIENT NAME"~1;C45;R33~3;C2;R11;"FROM DATE"~8;C16;"CLERK ENTERING 7078"~.014;C50;R14"DATE CANCELLED"~
	;;^UTILITY(U,$J,"DIPT",929,"H")
	;;=CANCELLED 7078s
	;;^UTILITY(U,$J,"DIPT",1086,0)
	;;=FBUC STATUS BY PATIENT^2930706.1435^@^162.7^10116^@^2950117
	;;^UTILITY(U,$J,"DIPT",1086,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIPT",1086,"%D",1,0)
	;;=Status listing of unauthorized claims by patient
	;;^UTILITY(U,$J,"DIPT",1086,"DCL","162.7^24")
	;;=!
	;;^UTILITY(U,$J,"DIPT",1086,"DXS",1,9)
	;;=S FBZ=$G(^FB583(D0,0)) W:"^40^70^90^"[$$ORDER^FBUCUTL($P(FBZ,U,24)) "-"_$$CODE^FBUCOUT($P(FBZ,U,11))_"  "
	;;^UTILITY(U,$J,"DIPT",1086,"DXS",2,9)
	;;=W $S('FBZEXP:"",FBZEXP<FBZLOW!(FBZEXP>FBZHI):"",FBZORDER=10!(FBZORDER=55):"*",1:"") K FBZ
	;;^UTILITY(U,$J,"DIPT",1086,"F",1)
	;;=2;L20~1;L20~24;L15~X DXS(1,9);X;Z;"S FBZ=$G(^FB583(D0,0)) W:"^40^70^90^"[$$ORDER^FBUCUTL($P(FBZ,U,24)) "-"_$$CODE^FBUCOUT($P(FBZ,U,11))_"  ""~
	;;^UTILITY(U,$J,"DIPT",1086,"F",2)
	;;=26;"EXPIRES"~S FBZEXP=$P(FBZ,U,26),FBZORDER=$$ORDER^FBUCUTL(+$P(FBZ,U,24));X;Z;"S FBZEXP=$P(FBZ,U,26),FBZORDER=$$ORDER^FBUCUTL(+$P(FBZ,U,24))"~
	;;^UTILITY(U,$J,"DIPT",1086,"F",3)
	;;=X DXS(2,9);X;Z;"W $S('FBZEXP:"",FBZEXP<FBZLOW!(FBZEXP>FBZHI):"",FBZORDER=10!(FBZORDER=55):"*",1:"") K FBZ"~K FBZEXP,FBZORDER;X;Z;"K FBZEXP,FBZORDER"~
	;;^UTILITY(U,$J,"DIPT",1086,"H")
	;;=STATUS LISTING OF UNAUTHORIZED CLAIMS
	;;^UTILITY(U,$J,"DIPT",1087,0)
	;;=FBUC STATUS BY VENDOR^2930706.1449^@^162.7^10116^@^2931214
	;;^UTILITY(U,$J,"DIPT",1087,"%D",0)
	;;=^^1^1^2931012^
	;;^UTILITY(U,$J,"DIPT",1087,"%D",1,0)
	;;=Status listing of unauthorized claims by vendor
	;;^UTILITY(U,$J,"DIPT",1087,"DCL","162.7^24")
	;;=!
	;;^UTILITY(U,$J,"DIPT",1087,"DXS",1,9)
	;;=S FBZ=$G(^FB583(D0,0)) W:"^40^70^90^"[$$ORDER^FBUCUTL($P(FBZ,U,24)) "-"_$$CODE^FBUCOUT($P(FBZ,U,11))
	;;^UTILITY(U,$J,"DIPT",1087,"DXS",2,9)
	;;=W $S('FBZEXP:"",FBZEXP<FBZLOW!(FBZEXP>FBZHI):"",FBZORDER=10!(FBZORDER=55):"*",1:"") K FBZ
	;;^UTILITY(U,$J,"DIPT",1087,"F",1)
	;;=1;L20~2;L20~24;L15~X DXS(1,9);X;Z;"S FBZ=$G(^FB583(D0,0)) W:"^40^70^90^"[$$ORDER^FBUCUTL($P(FBZ,U,24)) "-"_$$CODE^FBUCOUT($P(FBZ,U,11))"~26;"EXPIRES"~
	;;^UTILITY(U,$J,"DIPT",1087,"F",2)
	;;=S FBZEXP=$P(FBZ,U,26),FBZORDER=$$ORDER^FBUCUTL(+$P(FBZ,U,24));X;Z;"S FBZEXP=$P(FBZ,U,26),FBZORDER=$$ORDER^FBUCUTL(+$P(FBZ,U,24))"~

FBINI03L
FBINI03L	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIPT",1087,"F",3)
	;;=X DXS(2,9);X;Z;"W $S('FBZEXP:"",FBZEXP<FBZLOW!(FBZEXP>FBZHI):"",FBZORDER=10!(FBZORDER=55):"*",1:"") K FBZ"~K FBZEXP,FBZORDER;X;Z;"K FBZEXP,FBZORDER"~
	;;^UTILITY(U,$J,"DIPT",1087,"H")
	;;=STATUS LISTING OF UNAUTHORIZED CLAIMS
	;;^UTILITY(U,$J,"KEY",21,0)
	;;=FBAASUPERVISOR^^
	;;^UTILITY(U,$J,"KEY",21,1,0)
	;;=^^2^2^2930303^^^^
	;;^UTILITY(U,$J,"KEY",21,1,1,0)
	;;=This key provides the capability to Certify a Batch for Payment in the
	;;^UTILITY(U,$J,"KEY",21,1,2,0)
	;;=Fee Basis system.
	;;^UTILITY(U,$J,"KEY",39,0)
	;;=FBAA ESTABLISH VENDOR^^
	;;^UTILITY(U,$J,"KEY",39,1,0)
	;;=^^1^1^2930420^^^^
	;;^UTILITY(U,$J,"KEY",39,1,1,0)
	;;=Allows the capability to add a new vendor to the Vendor file.
	;;^UTILITY(U,$J,"KEY",39,1,2,0)
	;;=vendor file.
	;;^UTILITY(U,$J,"OPT",438,0)
	;;=FBAA VENDOR DEMOGRAPHICS^Display,Enter,Edit Demographics^^R^^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",438,1,0)
	;;=^^1^1^2930322^^^
	;;^UTILITY(U,$J,"OPT",438,1,1,0)
	;;=Option displays Vendor demographics and allows editing data.
	;;^UTILITY(U,$J,"OPT",438,15)
	;;=K FBEXDT,FBEXNDT
	;;^UTILITY(U,$J,"OPT",438,25)
	;;=FBAAVD
	;;^UTILITY(U,$J,"OPT",438,"U")
	;;=DISPLAY,ENTER,EDIT DEMOGRAPHIC
	;;^UTILITY(U,$J,"OPT",439,0)
	;;=FBAA VENDOR OPTIONS^Vendor Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",439,1,0)
	;;=^^1^1^2900515^^^
	;;^UTILITY(U,$J,"OPT",439,1,1,0)
	;;=Main menu for Vendor Optns
	;;^UTILITY(U,$J,"OPT",439,10,0)
	;;=^19.01PI^4^4
	;;^UTILITY(U,$J,"OPT",439,10,1,0)
	;;=438^
	;;^UTILITY(U,$J,"OPT",439,10,1,"^")
	;;=FBAA VENDOR DEMOGRAPHICS
	;;^UTILITY(U,$J,"OPT",439,10,2,0)
	;;=440^
	;;^UTILITY(U,$J,"OPT",439,10,2,"^")
	;;=FBAA VENDOR PAYMENT DISPLAY
	;;^UTILITY(U,$J,"OPT",439,10,3,0)
	;;=1274^
	;;^UTILITY(U,$J,"OPT",439,10,3,"^")
	;;=FBAA VENDOR LOOKUP
	;;^UTILITY(U,$J,"OPT",439,10,4,0)
	;;=1275^
	;;^UTILITY(U,$J,"OPT",439,10,4,"^")
	;;=FBAA PHARMACY LOOKUP
	;;^UTILITY(U,$J,"OPT",439,99)
	;;=56204,44948
	;;^UTILITY(U,$J,"OPT",439,"U")
	;;=VENDOR MENU
	;;^UTILITY(U,$J,"OPT",440,0)
	;;=FBAA VENDOR PAYMENT DISPLAY^Payment Display for Patient^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",440,1,0)
	;;=^^1^1^2851223^
	;;^UTILITY(U,$J,"OPT",440,1,1,0)
	;;=Displays Payment data for Patient and Vendor selected
	;;^UTILITY(U,$J,"OPT",440,25)
	;;=FBAAVS
	;;^UTILITY(U,$J,"OPT",440,"U")
	;;=PAYMENT DISPLAY FOR PATIENT
	;;^UTILITY(U,$J,"OPT",441,0)
	;;=FBAA SUPERVISOR OPTIONS^Supervisor Main Menu^^M^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",441,1,0)
	;;=^^1^1^2930304^^^^
	;;^UTILITY(U,$J,"OPT",441,1,1,0)
	;;=Main Menu for Supervisor options.
	;;^UTILITY(U,$J,"OPT",441,10,0)
	;;=^19.01PI^25^17
	;;^UTILITY(U,$J,"OPT",441,10,1,0)
	;;=998^
	;;^UTILITY(U,$J,"OPT",441,10,1,"^")
	;;=FBAA SUPERVISOR RELEASE
	;;^UTILITY(U,$J,"OPT",441,10,2,0)
	;;=459^
	;;^UTILITY(U,$J,"OPT",441,10,2,"^")
	;;=FBAA LIST CLOSED BATCHES
	;;^UTILITY(U,$J,"OPT",441,10,8,0)
	;;=792^
	;;^UTILITY(U,$J,"OPT",441,10,8,"^")
	;;=FBAA REINITIATE REJECTS
	;;^UTILITY(U,$J,"OPT",441,10,9,0)
	;;=791^
	;;^UTILITY(U,$J,"OPT",441,10,9,"^")
	;;=FBAA REJECT PRINT
	;;^UTILITY(U,$J,"OPT",441,10,10,0)
	;;=936^
	;;^UTILITY(U,$J,"OPT",441,10,10,"^")
	;;=FBAA ENTER SITE PARAMETERS
	;;^UTILITY(U,$J,"OPT",441,10,11,0)
	;;=939^
	;;^UTILITY(U,$J,"OPT",441,10,11,"^")
	;;=FBAA ENTER/EDIT LETTERS
	;;^UTILITY(U,$J,"OPT",441,10,14,0)
	;;=1146^
	;;^UTILITY(U,$J,"OPT",441,10,14,"^")
	;;=FBAA QUEUE DATA FOR TRANS.
	;;^UTILITY(U,$J,"OPT",441,10,15,0)
	;;=1023^
	;;^UTILITY(U,$J,"OPT",441,10,15,"^")
	;;=FBAA EDIT INVOICE STATUS
	;;^UTILITY(U,$J,"OPT",441,10,17,0)
	;;=789^
	;;^UTILITY(U,$J,"OPT",441,10,17,"^")
	;;=FBAA FINALIZE BATCH
	;;^UTILITY(U,$J,"OPT",441,10,18,0)
	;;=790^
	;;^UTILITY(U,$J,"OPT",441,10,18,"^")
	;;=FBAA VOUCHER DELETE REJECT
	;;^UTILITY(U,$J,"OPT",441,10,19,0)
	;;=1280^
	;;^UTILITY(U,$J,"OPT",441,10,19,"^")
	;;=FBAA CLERK LOOK-UP
	;;^UTILITY(U,$J,"OPT",441,10,20,0)
	;;=1286^
	;;^UTILITY(U,$J,"OPT",441,10,20,"^")
	;;=FBAA VOID PAYMENT MENU
	;;^UTILITY(U,$J,"OPT",441,10,21,0)
	;;=2115^
	;;^UTILITY(U,$J,"OPT",441,10,21,"^")
	;;=FBAA FEE SCHEDULE
	;;^UTILITY(U,$J,"OPT",441,10,22,0)
	;;=2261^

FBINI03M
FBINI03M	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",441,10,22,"^")
	;;=FB MRA MAIN MENU
	;;^UTILITY(U,$J,"OPT",441,10,23,0)
	;;=2276
	;;^UTILITY(U,$J,"OPT",441,10,23,"^")
	;;=FBCH PRICER RELEASE
	;;^UTILITY(U,$J,"OPT",441,10,24,0)
	;;=4033
	;;^UTILITY(U,$J,"OPT",441,10,24,"^")
	;;=FBUC REQUEST INFO FILE
	;;^UTILITY(U,$J,"OPT",441,10,25,0)
	;;=4073
	;;^UTILITY(U,$J,"OPT",441,10,25,"^")
	;;=FBUC ADD NEW PERSON
	;;^UTILITY(U,$J,"OPT",441,99)
	;;=56204,45535
	;;^UTILITY(U,$J,"OPT",441,"U")
	;;=SUPERVISOR MAIN MENU
	;;^UTILITY(U,$J,"OPT",442,0)
	;;=FBAA ENTER PAYMENT^Enter Payment^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",442,1,0)
	;;=^^1^1^2860514^
	;;^UTILITY(U,$J,"OPT",442,1,1,0)
	;;=Used to enter or edit Medical Payment data.
	;;^UTILITY(U,$J,"OPT",442,25)
	;;=FBAACO
	;;^UTILITY(U,$J,"OPT",442,99)
	;;=55726,47541
	;;^UTILITY(U,$J,"OPT",442,"U")
	;;=ENTER PAYMENT
	;;^UTILITY(U,$J,"OPT",443,0)
	;;=FBAA PAYMENT MENU^Payment menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",443,1,0)
	;;=^^1^1^2900405^^^^
	;;^UTILITY(U,$J,"OPT",443,1,1,0)
	;;=Main Menu for Payment options.
	;;^UTILITY(U,$J,"OPT",443,10,0)
	;;=^19.01PI^11^9
	;;^UTILITY(U,$J,"OPT",443,10,1,0)
	;;=442^
	;;^UTILITY(U,$J,"OPT",443,10,1,"^")
	;;=FBAA ENTER PAYMENT
	;;^UTILITY(U,$J,"OPT",443,10,2,0)
	;;=445^
	;;^UTILITY(U,$J,"OPT",443,10,2,"^")
	;;=FBAA DELETE PAYMENT
	;;^UTILITY(U,$J,"OPT",443,10,4,0)
	;;=618^
	;;^UTILITY(U,$J,"OPT",443,10,4,"^")
	;;=FBAA INVOICE DISPLAY
	;;^UTILITY(U,$J,"OPT",443,10,5,0)
	;;=783^
	;;^UTILITY(U,$J,"OPT",443,10,5,"^")
	;;=FBAA MEDICAL REIMBURSEMENT
	;;^UTILITY(U,$J,"OPT",443,10,6,0)
	;;=792^
	;;^UTILITY(U,$J,"OPT",443,10,6,"^")
	;;=FBAA REINITIATE REJECTS
	;;^UTILITY(U,$J,"OPT",443,10,7,0)
	;;=883^
	;;^UTILITY(U,$J,"OPT",443,10,7,"^")
	;;=FBAA TRAVEL ENTRY
	;;^UTILITY(U,$J,"OPT",443,10,9,0)
	;;=941^
	;;^UTILITY(U,$J,"OPT",443,10,9,"^")
	;;=FBAA MULTIPLE PAYMENT ENTRY
	;;^UTILITY(U,$J,"OPT",443,10,10,0)
	;;=1021^
	;;^UTILITY(U,$J,"OPT",443,10,10,"^")
	;;=FBAA EDIT PAYMENT
	;;^UTILITY(U,$J,"OPT",443,10,11,0)
	;;=2262^
	;;^UTILITY(U,$J,"OPT",443,10,11,"^")
	;;=FBAA C&P ENTER PAYMENT
	;;^UTILITY(U,$J,"OPT",443,99)
	;;=56204,45130
	;;^UTILITY(U,$J,"OPT",443,"U")
	;;=PAYMENT MENU
	;;^UTILITY(U,$J,"OPT",444,0)
	;;=FBAA MEDICAL MAIN MENU^Medical Fee Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",444,1,0)
	;;=^^1^1^2930415^^^^
	;;^UTILITY(U,$J,"OPT",444,1,1,0)
	;;=Main Menu for Fee Medical.
	;;^UTILITY(U,$J,"OPT",444,10,0)
	;;=^19.01PI^9^8
	;;^UTILITY(U,$J,"OPT",444,10,1,0)
	;;=443^
	;;^UTILITY(U,$J,"OPT",444,10,1,"^")
	;;=FBAA PAYMENT MENU
	;;^UTILITY(U,$J,"OPT",444,10,3,0)
	;;=441^
	;;^UTILITY(U,$J,"OPT",444,10,3,"^")
	;;=FBAA SUPERVISOR OPTIONS
	;;^UTILITY(U,$J,"OPT",444,10,4,0)
	;;=439^
	;;^UTILITY(U,$J,"OPT",444,10,4,"^")
	;;=FBAA VENDOR OPTIONS
	;;^UTILITY(U,$J,"OPT",444,10,5,0)
	;;=449^
	;;^UTILITY(U,$J,"OPT",444,10,5,"^")
	;;=FBAA REGISTRATION MAIN MENU
	;;^UTILITY(U,$J,"OPT",444,10,6,0)
	;;=452^
	;;^UTILITY(U,$J,"OPT",444,10,6,"^")
	;;=FBAA BATCH MENU
	;;^UTILITY(U,$J,"OPT",444,10,7,0)
	;;=624^
	;;^UTILITY(U,$J,"OPT",444,10,7,"^")
	;;=FBAA OUTPUTS MENU
	;;^UTILITY(U,$J,"OPT",444,10,8,0)
	;;=446^
	;;^UTILITY(U,$J,"OPT",444,10,8,"^")
	;;=FBAA ENTER AUTHORIZATION
	;;^UTILITY(U,$J,"OPT",444,10,9,0)
	;;=4050
	;;^UTILITY(U,$J,"OPT",444,10,9,"^")
	;;=FBAA TERMINATE ID CARD
	;;^UTILITY(U,$J,"OPT",444,99)
	;;=56204,45528
	;;^UTILITY(U,$J,"OPT",444,"U")
	;;=MEDICAL FEE MAIN MENU
	;;^UTILITY(U,$J,"OPT",445,0)
	;;=FBAA DELETE PAYMENT^Delete Payment Entry^^R^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",445,1,0)
	;;=^^2^2^2940105^^^^
	;;^UTILITY(U,$J,"OPT",445,1,1,0)
	;;=Used to delete a payment transaction. User must be same as user who entered
	;;^UTILITY(U,$J,"OPT",445,1,2,0)
	;;=payment.
	;;^UTILITY(U,$J,"OPT",445,20)
	;;=
	;;^UTILITY(U,$J,"OPT",445,25)
	;;=FBAAODP0
	;;^UTILITY(U,$J,"OPT",445,"U")
	;;=DELETE PAYMENT ENTRY
	;;^UTILITY(U,$J,"OPT",446,0)
	;;=FBAA ENTER AUTHORIZATION^Enter Authorization^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",446,1,0)
	;;=^^1^1^2930706^^^
	;;^UTILITY(U,$J,"OPT",446,1,1,0)
	;;=Used to enter or edit an Authorization for Fee services.
	;;^UTILITY(U,$J,"OPT",446,25)
	;;=FBAAAUT
	;;^UTILITY(U,$J,"OPT",446,"U")
	;;=ENTER AUTHORIZATION

FBINI03N
FBINI03N	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",449,0)
	;;=FBAA REGISTRATION MAIN MENU^Registration Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",449,1,0)
	;;=^^1^1^2871228^^
	;;^UTILITY(U,$J,"OPT",449,1,1,0)
	;;=Main Menu for Registration options.
	;;^UTILITY(U,$J,"OPT",449,10,0)
	;;=^19.01PI^6^4
	;;^UTILITY(U,$J,"OPT",449,10,3,0)
	;;=450^
	;;^UTILITY(U,$J,"OPT",449,10,3,"^")
	;;=FBAA REPORT OF CONTACT
	;;^UTILITY(U,$J,"OPT",449,10,4,0)
	;;=457^
	;;^UTILITY(U,$J,"OPT",449,10,4,"^")
	;;=FBAA PATIENT INQUIRY
	;;^UTILITY(U,$J,"OPT",449,10,5,0)
	;;=1273^
	;;^UTILITY(U,$J,"OPT",449,10,5,"^")
	;;=FBAA PRINT REPORT OF CONTACT
	;;^UTILITY(U,$J,"OPT",449,10,6,0)
	;;=4782
	;;^UTILITY(U,$J,"OPT",449,10,6,"^")
	;;=FBAA AUTHORIZATION DISPLAY
	;;^UTILITY(U,$J,"OPT",449,99)
	;;=56204,45734
	;;^UTILITY(U,$J,"OPT",449,"U")
	;;=REGISTRATION MENU
	;;^UTILITY(U,$J,"OPT",450,0)
	;;=FBAA REPORT OF CONTACT^Report of Contact^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",450,1,0)
	;;=^^1^1^2860514^
	;;^UTILITY(U,$J,"OPT",450,1,1,0)
	;;=Used to enter a Report of Contact.
	;;^UTILITY(U,$J,"OPT",450,25)
	;;=FBAAROC
	;;^UTILITY(U,$J,"OPT",450,"U")
	;;=REPORT OF CONTACT
	;;^UTILITY(U,$J,"OPT",451,0)
	;;=FBAA BATCH STATUS^Status of Batch^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",451,1,0)
	;;=^^4^4^2861002^
	;;^UTILITY(U,$J,"OPT",451,1,1,0)
	;;=Option will display all information available for selected batch.
	;;^UTILITY(U,$J,"OPT",451,1,2,0)
	;;=If batch is in open status, the only information available is 
	;;^UTILITY(U,$J,"OPT",451,1,3,0)
	;;=date opened, clerk who opened, batch type. If status is 'clerk
	;;^UTILITY(U,$J,"OPT",451,1,4,0)
	;;=closed', total dollars and payment line count are also displayed.
	;;^UTILITY(U,$J,"OPT",451,25)
	;;=FBAABS
	;;^UTILITY(U,$J,"OPT",451,"U")
	;;=STATUS OF BATCH
	;;^UTILITY(U,$J,"OPT",452,0)
	;;=FBAA BATCH MENU^Batch Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",452,1,0)
	;;=^^1^1^2861002^
	;;^UTILITY(U,$J,"OPT",452,1,1,0)
	;;=Main Menu for Batch options.
	;;^UTILITY(U,$J,"OPT",452,10,0)
	;;=^19.01PI^11^11
	;;^UTILITY(U,$J,"OPT",452,10,1,0)
	;;=451^
	;;^UTILITY(U,$J,"OPT",452,10,1,"^")
	;;=FBAA BATCH STATUS
	;;^UTILITY(U,$J,"OPT",452,10,2,0)
	;;=453^
	;;^UTILITY(U,$J,"OPT",452,10,2,"^")
	;;=FBAA LIST BATCH
	;;^UTILITY(U,$J,"OPT",452,10,3,0)
	;;=454^
	;;^UTILITY(U,$J,"OPT",452,10,3,"^")
	;;=FBAA CLOSE BATCH
	;;^UTILITY(U,$J,"OPT",452,10,4,0)
	;;=455^
	;;^UTILITY(U,$J,"OPT",452,10,4,"^")
	;;=FBAA REOPEN BATCH
	;;^UTILITY(U,$J,"OPT",452,10,5,0)
	;;=458^
	;;^UTILITY(U,$J,"OPT",452,10,5,"^")
	;;=FBAA DISPLAY OPEN BATCHES
	;;^UTILITY(U,$J,"OPT",452,10,6,0)
	;;=786^
	;;^UTILITY(U,$J,"OPT",452,10,6,"^")
	;;=FBAA OPEN BATCH
	;;^UTILITY(U,$J,"OPT",452,10,7,0)
	;;=882^
	;;^UTILITY(U,$J,"OPT",452,10,7,"^")
	;;=FBAA BATCH EDIT
	;;^UTILITY(U,$J,"OPT",452,10,8,0)
	;;=3596
	;;^UTILITY(U,$J,"OPT",452,10,8,"^")
	;;=FBAA BATCH RANGE
	;;^UTILITY(U,$J,"OPT",452,10,9,0)
	;;=3922
	;;^UTILITY(U,$J,"OPT",452,10,9,"^")
	;;=FBAA ACTIVE BATCH LISTING
	;;^UTILITY(U,$J,"OPT",452,10,10,0)
	;;=4118
	;;^UTILITY(U,$J,"OPT",452,10,10,"^")
	;;=FBAA BATCH DELETE
	;;^UTILITY(U,$J,"OPT",452,10,11,0)
	;;=998
	;;^UTILITY(U,$J,"OPT",452,10,11,"^")
	;;=FBAA SUPERVISOR RELEASE
	;;^UTILITY(U,$J,"OPT",452,99)
	;;=56204,45548
	;;^UTILITY(U,$J,"OPT",452,"U")
	;;=BATCH MAIN MENU
	;;^UTILITY(U,$J,"OPT",453,0)
	;;=FBAA LIST BATCH^List Items in Batch^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",453,1,0)
	;;=^^1^1^2930122^^^
	;;^UTILITY(U,$J,"OPT",453,1,1,0)
	;;=Will list all payment records for a Batch.
	;;^UTILITY(U,$J,"OPT",453,25)
	;;=FBAALB
	;;^UTILITY(U,$J,"OPT",453,"U")
	;;=LIST ITEMS IN BATCH
	;;^UTILITY(U,$J,"OPT",454,0)
	;;=FBAA CLOSE BATCH^Close-out Batch^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",454,1,0)
	;;=^^2^2^2860102^
	;;^UTILITY(U,$J,"OPT",454,1,1,0)
	;;=Closes a Batch. Once batch is closed, no further payments may be added
	;;^UTILITY(U,$J,"OPT",454,1,2,0)
	;;=to Batch.Travel dollars and Payment line count are tabulated.
	;;^UTILITY(U,$J,"OPT",454,25)
	;;=FBAACCB
	;;^UTILITY(U,$J,"OPT",454,"U")
	;;=CLOSE-OUT BATCH
	;;^UTILITY(U,$J,"OPT",455,0)
	;;=FBAA REOPEN BATCH^Re-open Batch^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",455,1,0)
	;;=^^2^2^2860102^

FBINI03O
FBINI03O	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",455,1,1,0)
	;;=Re-open a Batch which was previously closed. This will alliow 
	;;^UTILITY(U,$J,"OPT",455,1,2,0)
	;;=additional payments to be entered into batch.
	;;^UTILITY(U,$J,"OPT",455,25)
	;;=FBAARB
	;;^UTILITY(U,$J,"OPT",455,"U")
	;;=RE-OPEN BATCH
	;;^UTILITY(U,$J,"OPT",457,0)
	;;=FBAA PATIENT INQUIRY^Fee Patient Inquiry^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",457,1,0)
	;;=^^1^1^2860103^
	;;^UTILITY(U,$J,"OPT",457,1,1,0)
	;;=Displays patient demographics and Fee Basis Authorizations.
	;;^UTILITY(U,$J,"OPT",457,25)
	;;=FBAAPI
	;;^UTILITY(U,$J,"OPT",457,"U")
	;;=FEE PATIENT INQUIRY
	;;^UTILITY(U,$J,"OPT",458,0)
	;;=FBAA DISPLAY OPEN BATCHES^Display Open Batches^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",458,1,0)
	;;=^^1^1^2860107^^^^
	;;^UTILITY(U,$J,"OPT",458,1,1,0)
	;;=Displays info for Batches which are in open status.
	;;^UTILITY(U,$J,"OPT",458,25)
	;;=FBAADOB
	;;^UTILITY(U,$J,"OPT",458,"U")
	;;=DISPLAY OPEN BATCHES
	;;^UTILITY(U,$J,"OPT",459,0)
	;;=FBAA LIST CLOSED BATCHES^List Batches Pending Release^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",459,1,0)
	;;=^^2^2^2860103^
	;;^UTILITY(U,$J,"OPT",459,1,1,0)
	;;=Displays Batches that have been closed but not yet Certified by the
	;;^UTILITY(U,$J,"OPT",459,1,2,0)
	;;=Supervisor.
	;;^UTILITY(U,$J,"OPT",459,25)
	;;=FBAADCB
	;;^UTILITY(U,$J,"OPT",459,"U")
	;;=LIST BATCHES PENDING RELEASE
	;;^UTILITY(U,$J,"OPT",462,0)
	;;=FBAA MAIN MENU^Fee Basis Main Menu^^M^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",462,1,0)
	;;=^^1^1^2940804^^^^
	;;^UTILITY(U,$J,"OPT",462,1,1,0)
	;;=This is the Main menu for the Fee Basis system.
	;;^UTILITY(U,$J,"OPT",462,10,0)
	;;=^19.01PI^6^6
	;;^UTILITY(U,$J,"OPT",462,10,1,0)
	;;=444^
	;;^UTILITY(U,$J,"OPT",462,10,1,"^")
	;;=FBAA MEDICAL MAIN MENU
	;;^UTILITY(U,$J,"OPT",462,10,2,0)
	;;=463^
	;;^UTILITY(U,$J,"OPT",462,10,2,"^")
	;;=FBAA PHARMACY MAIN MENU
	;;^UTILITY(U,$J,"OPT",462,10,3,0)
	;;=1296^
	;;^UTILITY(U,$J,"OPT",462,10,3,"^")
	;;=FBCH MAIN MENU
	;;^UTILITY(U,$J,"OPT",462,10,4,0)
	;;=2251^
	;;^UTILITY(U,$J,"OPT",462,10,4,"^")
	;;=FBCNH MAIN MENU
	;;^UTILITY(U,$J,"OPT",462,10,5,0)
	;;=4037
	;;^UTILITY(U,$J,"OPT",462,10,5,"^")
	;;=FBUC MAIN
	;;^UTILITY(U,$J,"OPT",462,10,6,0)
	;;=4624
	;;^UTILITY(U,$J,"OPT",462,10,6,"^")
	;;=FB PHONE MENU
	;;^UTILITY(U,$J,"OPT",462,20)
	;;=D ^VACPT,^FBAASTA
	;;^UTILITY(U,$J,"OPT",462,99)
	;;=56204,45674
	;;^UTILITY(U,$J,"OPT",462,99.1)
	;;=53569,40017
	;;^UTILITY(U,$J,"OPT",462,"U")
	;;=FEE BASIS MAIN MENU
	;;^UTILITY(U,$J,"OPT",463,0)
	;;=FBAA PHARMACY MAIN MENU^Pharmacy Fee Main Menu^^M^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",463,1,0)
	;;=^^1^1^2930504^^^^
	;;^UTILITY(U,$J,"OPT",463,1,1,0)
	;;=Main Menu for Pharmacy options.
	;;^UTILITY(U,$J,"OPT",463,10,0)
	;;=^19.01PI^17^16
	;;^UTILITY(U,$J,"OPT",463,10,1,0)
	;;=464^
	;;^UTILITY(U,$J,"OPT",463,10,1,"^")
	;;=FBAA ENTER PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",463,10,2,0)
	;;=465^
	;;^UTILITY(U,$J,"OPT",463,10,2,"^")
	;;=FBAA PHARMACY REVIEW
	;;^UTILITY(U,$J,"OPT",463,10,4,0)
	;;=728^
	;;^UTILITY(U,$J,"OPT",463,10,4,"^")
	;;=FBAA CLOSE OUT INVOICE
	;;^UTILITY(U,$J,"OPT",463,10,5,0)
	;;=729^
	;;^UTILITY(U,$J,"OPT",463,10,5,"^")
	;;=FBAA COMPLETE PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",463,10,6,0)
	;;=730^
	;;^UTILITY(U,$J,"OPT",463,10,6,"^")
	;;=FBAA PENDING MAS COMPLETION
	;;^UTILITY(U,$J,"OPT",463,10,7,0)
	;;=906^
	;;^UTILITY(U,$J,"OPT",463,10,7,"^")
	;;=FBAA REIMBURSEMENT PHARMACY
	;;^UTILITY(U,$J,"OPT",463,10,8,0)
	;;=1009^
	;;^UTILITY(U,$J,"OPT",463,10,8,"^")
	;;=FBAA EDIT PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",463,10,9,0)
	;;=1014^
	;;^UTILITY(U,$J,"OPT",463,10,9,"^")
	;;=FBAA PHARMACY INVOICE STATUS
	;;^UTILITY(U,$J,"OPT",463,10,10,0)
	;;=1020^
	;;^UTILITY(U,$J,"OPT",463,10,10,"^")
	;;=FBAA PHARMACY INVOICE DISPLAY
	;;^UTILITY(U,$J,"OPT",463,10,11,0)
	;;=2366^
	;;^UTILITY(U,$J,"OPT",463,10,11,"^")
	;;=FBAA PHARMACY BATCH OPTIONS
	;;^UTILITY(U,$J,"OPT",463,10,12,0)
	;;=3600
	;;^UTILITY(U,$J,"OPT",463,10,12,"^")
	;;=FBAA LIST PENDING RX
	;;^UTILITY(U,$J,"OPT",463,10,13,0)
	;;=4042
	;;^UTILITY(U,$J,"OPT",463,10,13,"^")
	;;=FB PAY VENDOR
	;;^UTILITY(U,$J,"OPT",463,10,14,0)
	;;=4043

FBINI03P
FBINI03P	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",463,10,14,"^")
	;;=FB PAY VETERAN
	;;^UTILITY(U,$J,"OPT",463,10,15,0)
	;;=3905
	;;^UTILITY(U,$J,"OPT",463,10,15,"^")
	;;=FB PCR
	;;^UTILITY(U,$J,"OPT",463,10,16,0)
	;;=4112
	;;^UTILITY(U,$J,"OPT",463,10,16,"^")
	;;=FBAA PHARMACY HISTORY
	;;^UTILITY(U,$J,"OPT",463,10,17,0)
	;;=4607
	;;^UTILITY(U,$J,"OPT",463,10,17,"^")
	;;=FB CHECK DISPLAY
	;;^UTILITY(U,$J,"OPT",463,20)
	;;=D ^FBAASTA
	;;^UTILITY(U,$J,"OPT",463,99)
	;;=56204,45670
	;;^UTILITY(U,$J,"OPT",463,"U")
	;;=PHARMACY FEE MAIN MENU
	;;^UTILITY(U,$J,"OPT",464,0)
	;;=FBAA ENTER PHARMACY INVOICE^Enter Pharmacy Invoice^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",464,1,0)
	;;=^^1^1^2930322^^
	;;^UTILITY(U,$J,"OPT",464,1,1,0)
	;;=Used to enter Fee Basis Pharmacy Invoices.
	;;^UTILITY(U,$J,"OPT",464,25)
	;;=FBAAPIE
	;;^UTILITY(U,$J,"OPT",464,"U")
	;;=ENTER PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",465,0)
	;;=FBAA PHARMACY REVIEW^Review Fee Prescription^^R^^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",465,1,0)
	;;=^^3^3^2901104^^
	;;^UTILITY(U,$J,"OPT",465,1,1,0)
	;;=This option allows a Pharmacist to review a Fee Basis prescription to
	;;^UTILITY(U,$J,"OPT",465,1,2,0)
	;;=determine whether the prescription was for a Service connected disability
	;;^UTILITY(U,$J,"OPT",465,1,3,0)
	;;=and whether the payment should be based on a Generic Drug.
	;;^UTILITY(U,$J,"OPT",465,15)
	;;=K FBI,FBXX,FBRR
	;;^UTILITY(U,$J,"OPT",465,25)
	;;=FBAAPP
	;;^UTILITY(U,$J,"OPT",465,99)
	;;=55693,50670
	;;^UTILITY(U,$J,"OPT",465,"U")
	;;=REVIEW FEE PRESCRIPTION
	;;^UTILITY(U,$J,"OPT",618,0)
	;;=FBAA INVOICE DISPLAY^Invoice Display^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",618,1,0)
	;;=^^1^1^2860314^
	;;^UTILITY(U,$J,"OPT",618,1,1,0)
	;;=Displays detail line items associated with selected Invoice.
	;;^UTILITY(U,$J,"OPT",618,25)
	;;=FBAAPIN
	;;^UTILITY(U,$J,"OPT",618,"U")
	;;=INVOICE DISPLAY
	;;^UTILITY(U,$J,"OPT",624,0)
	;;=FBAA OUTPUTS MENU^Outputs Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",624,1,0)
	;;=^^1^1^2930720^^^^
	;;^UTILITY(U,$J,"OPT",624,1,1,0)
	;;=Menu for all output options.
	;;^UTILITY(U,$J,"OPT",624,10,0)
	;;=^19.01PI^19^16
	;;^UTILITY(U,$J,"OPT",624,10,2,0)
	;;=634^
	;;^UTILITY(U,$J,"OPT",624,10,2,"^")
	;;=FBAA ID CARDS CURRENT LIST
	;;^UTILITY(U,$J,"OPT",624,10,3,0)
	;;=635^
	;;^UTILITY(U,$J,"OPT",624,10,3,"^")
	;;=FBAA OBSOLETE ID CARDS
	;;^UTILITY(U,$J,"OPT",624,10,4,0)
	;;=791^
	;;^UTILITY(U,$J,"OPT",624,10,4,"^")
	;;=FBAA REJECT PRINT
	;;^UTILITY(U,$J,"OPT",624,10,5,0)
	;;=618^
	;;^UTILITY(U,$J,"OPT",624,10,5,"^")
	;;=FBAA INVOICE DISPLAY
	;;^UTILITY(U,$J,"OPT",624,10,7,0)
	;;=919^
	;;^UTILITY(U,$J,"OPT",624,10,7,"^")
	;;=FBAA DISPLAY ID CARD HISTORY
	;;^UTILITY(U,$J,"OPT",624,10,8,0)
	;;=942^^1
	;;^UTILITY(U,$J,"OPT",624,10,8,"^")
	;;=FBAA SUSPENSION LETTER PRINT
	;;^UTILITY(U,$J,"OPT",624,10,9,0)
	;;=999^
	;;^UTILITY(U,$J,"OPT",624,10,9,"^")
	;;=FBAA PRINT 7079 GROUP
	;;^UTILITY(U,$J,"OPT",624,10,10,0)
	;;=1015^
	;;^UTILITY(U,$J,"OPT",624,10,10,"^")
	;;=FBAA PRINT 7079 SINGLE
	;;^UTILITY(U,$J,"OPT",624,10,11,0)
	;;=2332^
	;;^UTILITY(U,$J,"OPT",624,10,11,"^")
	;;=FBCH PSA OUTPUT
	;;^UTILITY(U,$J,"OPT",624,10,13,0)
	;;=3925
	;;^UTILITY(U,$J,"OPT",624,10,13,"^")
	;;=FBAA COST REPORT
	;;^UTILITY(U,$J,"OPT",624,10,14,0)
	;;=4042
	;;^UTILITY(U,$J,"OPT",624,10,14,"^")
	;;=FB PAY VENDOR
	;;^UTILITY(U,$J,"OPT",624,10,15,0)
	;;=4043
	;;^UTILITY(U,$J,"OPT",624,10,15,"^")
	;;=FB PAY VETERAN
	;;^UTILITY(U,$J,"OPT",624,10,16,0)
	;;=3905
	;;^UTILITY(U,$J,"OPT",624,10,16,"^")
	;;=FB PCR
	;;^UTILITY(U,$J,"OPT",624,10,17,0)
	;;=4111
	;;^UTILITY(U,$J,"OPT",624,10,17,"^")
	;;=FBAA PAYMENT HISTORY DISPLAY
	;;^UTILITY(U,$J,"OPT",624,10,18,0)
	;;=4607
	;;^UTILITY(U,$J,"OPT",624,10,18,"^")
	;;=FB CHECK DISPLAY
	;;^UTILITY(U,$J,"OPT",624,10,19,0)
	;;=4781^^2
	;;^UTILITY(U,$J,"OPT",624,10,19,"^")
	;;=FBAA SUSPENSION LETTER INDIV
	;;^UTILITY(U,$J,"OPT",624,99)
	;;=56204,45734
	;;^UTILITY(U,$J,"OPT",624,"U")
	;;=OUTPUTS MAIN MENU
	;;^UTILITY(U,$J,"OPT",634,0)
	;;=FBAA ID CARDS CURRENT LIST^Valid ID Cards List^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",634,1,0)
	;;=^^1^1^2921223^^
	;;^UTILITY(U,$J,"OPT",634,1,1,0)
	;;=Lists those ID Cards that are still in effect and have not expired.

FBINI03Q
FBINI03Q	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",634,25)
	;;=FBAAPCC
	;;^UTILITY(U,$J,"OPT",634,"U")
	;;=VALID ID CARDS LIST
	;;^UTILITY(U,$J,"OPT",635,0)
	;;=FBAA OBSOLETE ID CARDS^Obsolete ID Cards List^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",635,1,0)
	;;=^^1^1^2921223^^^
	;;^UTILITY(U,$J,"OPT",635,1,1,0)
	;;=Lists Cards which have expired or been deleted.
	;;^UTILITY(U,$J,"OPT",635,25)
	;;=FBAAPOC
	;;^UTILITY(U,$J,"OPT",635,"U")
	;;=OBSOLETE ID CARDS LIST
	;;^UTILITY(U,$J,"OPT",728,0)
	;;=FBAA CLOSE OUT INVOICE^Closeout Pharmacy Invoice^^R^^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",728,1,0)
	;;=^^3^3^2860512^^
	;;^UTILITY(U,$J,"OPT",728,1,1,0)
	;;=This option must be used to assign a Batch Number to a Pharmacy Invoice
	;;^UTILITY(U,$J,"OPT",728,1,2,0)
	;;=prior to Payment being sent to Austin. Option allows selection of 
	;;^UTILITY(U,$J,"OPT",728,1,3,0)
	;;=only those Invoices which have been Completed by MAS.
	;;^UTILITY(U,$J,"OPT",728,15)
	;;=K FBSW Q
	;;^UTILITY(U,$J,"OPT",728,25)
	;;=FBAAPIP
	;;^UTILITY(U,$J,"OPT",728,"U")
	;;=CLOSEOUT PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",729,0)
	;;=FBAA COMPLETE PHARMACY INVOICE^Complete Pharmacy Invoice^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",729,1,0)
	;;=^^3^3^2901108^^
	;;^UTILITY(U,$J,"OPT",729,1,1,0)
	;;=Used to enter the remaining payment data for those items within the 
	;;^UTILITY(U,$J,"OPT",729,1,2,0)
	;;=Invoice which required a determination by Pharmacy service. MAS must 
	;;^UTILITY(U,$J,"OPT",729,1,3,0)
	;;=enter the remaining data prior to Close-out.
	;;^UTILITY(U,$J,"OPT",729,25)
	;;=FBAACIE
	;;^UTILITY(U,$J,"OPT",729,99)
	;;=55642,31672
	;;^UTILITY(U,$J,"OPT",729,"U")
	;;=COMPLETE PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",730,0)
	;;=FBAA PENDING MAS COMPLETION^List Invoices Pending MAS Completion^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",730,1,0)
	;;=^^3^3^2860512^^
	;;^UTILITY(U,$J,"OPT",730,1,1,0)
	;;=Lists all Invoices that have been entered and have incomplete items due
	;;^UTILITY(U,$J,"OPT",730,1,2,0)
	;;=to an item requiring a determination by Pharmacy, and the Pharmacy determinations have
	;;^UTILITY(U,$J,"OPT",730,1,3,0)
	;;=been completed.
	;;^UTILITY(U,$J,"OPT",730,25)
	;;=FBAALPI
	;;^UTILITY(U,$J,"OPT",730,"U")
	;;=LIST INVOICES PENDING MAS COMP
	;;^UTILITY(U,$J,"OPT",783,0)
	;;=FBAA MEDICAL REIMBURSEMENT^Reimbursement Payment Entry^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",783,1,0)
	;;=^^1^1^2860722^^^
	;;^UTILITY(U,$J,"OPT",783,1,1,0)
	;;=Used to enter a Reimbursement Payment for Medical Services.
	;;^UTILITY(U,$J,"OPT",783,25)
	;;=FBAARP
	;;^UTILITY(U,$J,"OPT",783,"U")
	;;=REIMBURSEMENT PAYMENT ENTRY
	;;^UTILITY(U,$J,"OPT",786,0)
	;;=FBAA OPEN BATCH^Open a Batch^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",786,1,0)
	;;=^^1^1^2860730^
	;;^UTILITY(U,$J,"OPT",786,1,1,0)
	;;=Allows user to create and open a new Batch. 
	;;^UTILITY(U,$J,"OPT",786,25)
	;;=FBAAOB
	;;^UTILITY(U,$J,"OPT",786,"U")
	;;=OPEN A BATCH
	;;^UTILITY(U,$J,"OPT",789,0)
	;;=FBAA FINALIZE BATCH^Finalize a Batch^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",789,1,0)
	;;=^^1^1^2890202^^^^
	;;^UTILITY(U,$J,"OPT",789,1,1,0)
	;;=Used to reject payment items and release a batch.
	;;^UTILITY(U,$J,"OPT",789,25)
	;;=FBAAVR
	;;^UTILITY(U,$J,"OPT",789,99)
	;;=55626,34279
	;;^UTILITY(U,$J,"OPT",789,"U")
	;;=FINALIZE A BATCH
	;;^UTILITY(U,$J,"OPT",790,0)
	;;=FBAA VOUCHER DELETE REJECT^Delete reject flag^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",790,1,0)
	;;=^^2^2^2890202^^
	;;^UTILITY(U,$J,"OPT",790,1,1,0)
	;;=Used to delete the reject flag previously entered for selected items in
	;;^UTILITY(U,$J,"OPT",790,1,2,0)
	;;=a batch, or for all items in a batch.
	;;^UTILITY(U,$J,"OPT",790,25)
	;;=FBAARD
	;;^UTILITY(U,$J,"OPT",790,"U")
	;;=DELETE REJECT FLAG
	;;^UTILITY(U,$J,"OPT",791,0)
	;;=FBAA REJECT PRINT^Print Rejected Payment Items^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",791,1,0)
	;;=^^1^1^2860815^
	;;^UTILITY(U,$J,"OPT",791,1,1,0)
	;;=Prints items which have been rejected and not yet Re-initiated.
	;;^UTILITY(U,$J,"OPT",791,25)
	;;=FBAARJP
	;;^UTILITY(U,$J,"OPT",791,"U")
	;;=PRINT REJECTED PAYMENT ITEMS
	;;^UTILITY(U,$J,"OPT",792,0)
	;;=FBAA REINITIATE REJECTS^Re-initiate Rejected Payment Items^^R^^^^^^^^

FBINI03R
FBINI03R	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",792,1,0)
	;;=^^1^1^2930426^^^
	;;^UTILITY(U,$J,"OPT",792,1,1,0)
	;;=Used to re-initiate rejected items and assign to a new Batch.
	;;^UTILITY(U,$J,"OPT",792,25)
	;;=FBAARR
	;;^UTILITY(U,$J,"OPT",792,99)
	;;=55756,63230
	;;^UTILITY(U,$J,"OPT",792,"U")
	;;=RE-INITIATE REJECTED PAYMENT I
	;;^UTILITY(U,$J,"OPT",859,0)
	;;=FBAA MRA DELETE VENDOR^Delete Vendor MRA^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",859,1,0)
	;;=^^17^17^2941228^^^^
	;;^UTILITY(U,$J,"OPT",859,1,1,0)
	;;=The 'Delete Vendor MRA' option is used to place a vendor locally
	;;^UTILITY(U,$J,"OPT",859,1,2,0)
	;;=in delete status whenever a vendor becomes inactive or cancels
	;;^UTILITY(U,$J,"OPT",859,1,3,0)
	;;=FEE care.  This option will not send a delete request to the
	;;^UTILITY(U,$J,"OPT",859,1,4,0)
	;;=Central Fee system in Austin.
	;;^UTILITY(U,$J,"OPT",859,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",859,1,6,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",859,1,7,0)
	;;= 1)  If the vendor is in delete status on both your system as well as
	;;^UTILITY(U,$J,"OPT",859,1,8,0)
	;;=     Central FEE, you only need to use the 'Reinstate Vendor MRA' option.
	;;^UTILITY(U,$J,"OPT",859,1,9,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",859,1,10,0)
	;;= 2)  If the vendor is in delete status on your system, but no longer
	;;^UTILITY(U,$J,"OPT",859,1,11,0)
	;;=     resides on the Central FEE system, use the 'Update FMS Vendor File 
	;;^UTILITY(U,$J,"OPT",859,1,12,0)
	;;=     in Austin' option.
	;;^UTILITY(U,$J,"OPT",859,1,13,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",859,1,14,0)
	;;= 3)  If a vendor which you were now adding to your system somehow
	;;^UTILITY(U,$J,"OPT",859,1,15,0)
	;;=     already resided on the Central FEE system, but in delete status,
	;;^UTILITY(U,$J,"OPT",859,1,16,0)
	;;=     you would need to add the vendor to your systemonly.  Doing so
	;;^UTILITY(U,$J,"OPT",859,1,17,0)
	;;=     will re-activate the vendor in the Central system.
	;;^UTILITY(U,$J,"OPT",859,25)
	;;=FBAADV
	;;^UTILITY(U,$J,"OPT",859,"U")
	;;=DELETE VENDOR MRA
	;;^UTILITY(U,$J,"OPT",862,0)
	;;=FBAA VENDOR MRA MAIN MENU^Vendor MRA Main Menu^^M^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",862,1,0)
	;;=^^1^1^2930917^^^^
	;;^UTILITY(U,$J,"OPT",862,1,1,0)
	;;=Main Menu for Vendor MRA options.
	;;^UTILITY(U,$J,"OPT",862,10,0)
	;;=^19.01PI^7^4
	;;^UTILITY(U,$J,"OPT",862,10,1,0)
	;;=859^^2
	;;^UTILITY(U,$J,"OPT",862,10,1,"^")
	;;=FBAA MRA DELETE VENDOR
	;;^UTILITY(U,$J,"OPT",862,10,4,0)
	;;=1147^^3
	;;^UTILITY(U,$J,"OPT",862,10,4,"^")
	;;=FBAA MRA VENDOR REINSTATE
	;;^UTILITY(U,$J,"OPT",862,10,5,0)
	;;=4123^^1
	;;^UTILITY(U,$J,"OPT",862,10,5,"^")
	;;=FBAA FMS UPDATE
	;;^UTILITY(U,$J,"OPT",862,10,7,0)
	;;=4177^^5
	;;^UTILITY(U,$J,"OPT",862,10,7,"^")
	;;=FBAA MRA'S AWAITING APPROVAL
	;;^UTILITY(U,$J,"OPT",862,99)
	;;=56204,45564
	;;^UTILITY(U,$J,"OPT",862,"U")
	;;=VENDOR MRA MAIN MENU
	;;^UTILITY(U,$J,"OPT",882,0)
	;;=FBAA BATCH EDIT^Edit Batch data^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",882,1,0)
	;;=^^1^1^2930706^^^
	;;^UTILITY(U,$J,"OPT",882,1,1,0)
	;;=Allows the editing of Obligation number and Date Batch Opened.
	;;^UTILITY(U,$J,"OPT",882,25)
	;;=FBAABET
	;;^UTILITY(U,$J,"OPT",882,30)
	;;=
	;;^UTILITY(U,$J,"OPT",882,31)
	;;=
	;;^UTILITY(U,$J,"OPT",882,50)
	;;=
	;;^UTILITY(U,$J,"OPT",882,51)
	;;=
	;;^UTILITY(U,$J,"OPT",882,"U")
	;;=EDIT BATCH DATA
	;;^UTILITY(U,$J,"OPT",883,0)
	;;=FBAA TRAVEL ENTRY^Travel Payment Only^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",883,1,0)
	;;=^^2^2^2880304^
	;;^UTILITY(U,$J,"OPT",883,1,1,0)
	;;=This option is used to enter/edit/delete a travel payment
	;;^UTILITY(U,$J,"OPT",883,1,2,0)
	;;=for a fee patient.
	;;^UTILITY(U,$J,"OPT",883,25)
	;;=FBAAETA
	;;^UTILITY(U,$J,"OPT",883,"U")
	;;=TRAVEL PAYMENT ONLY
	;;^UTILITY(U,$J,"OPT",906,0)
	;;=FBAA REIMBURSEMENT PHARMACY^Patient Re-imbursement^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",906,1,0)
	;;=^^1^1^2861211^
	;;^UTILITY(U,$J,"OPT",906,1,1,0)
	;;=Used to pay the Patient rather than a Vendor for a Pharmacy claim.
	;;^UTILITY(U,$J,"OPT",906,20)
	;;=S FBAAPTC="R" D ^FBAAPIE K FBAAPTC
	;;^UTILITY(U,$J,"OPT",906,99)
	;;=55775,36398

FBINI03S
FBINI03S	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",906,"U")
	;;=PATIENT RE-IMBURSEMENT
	;;^UTILITY(U,$J,"OPT",919,0)
	;;=FBAA DISPLAY ID CARD HISTORY^Display ID Card History for Patient^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",919,1,0)
	;;=^^3^3^2880304^
	;;^UTILITY(U,$J,"OPT",919,1,1,0)
	;;=This option shows an ID Card history for a FEE patient,including 
	;;^UTILITY(U,$J,"OPT",919,1,2,0)
	;;=current ID card # and issue date.Also displays any old card #'s,
	;;^UTILITY(U,$J,"OPT",919,1,3,0)
	;;=reason for change and which user made the change.
	;;^UTILITY(U,$J,"OPT",919,25)
	;;=FBAACH
	;;^UTILITY(U,$J,"OPT",919,"U")
	;;=DISPLAY ID CARD HISTORY FOR PA
	;;^UTILITY(U,$J,"OPT",936,0)
	;;=FBAA ENTER SITE PARAMETERS^Site Parameter Enter/Edit^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",936,1,0)
	;;=^^3^3^2901011^^^^
	;;^UTILITY(U,$J,"OPT",936,1,1,0)
	;;=This option is used to enter/edit the site specific FEE Basis
	;;^UTILITY(U,$J,"OPT",936,1,2,0)
	;;=parameters.After one entry you may only edit and not add
	;;^UTILITY(U,$J,"OPT",936,1,3,0)
	;;=a second entry.
	;;^UTILITY(U,$J,"OPT",936,25)
	;;=FBAAESP
	;;^UTILITY(U,$J,"OPT",936,30)
	;;=
	;;^UTILITY(U,$J,"OPT",936,31)
	;;=
	;;^UTILITY(U,$J,"OPT",936,32)
	;;=
	;;^UTILITY(U,$J,"OPT",936,34)
	;;=
	;;^UTILITY(U,$J,"OPT",936,35)
	;;=
	;;^UTILITY(U,$J,"OPT",936,50)
	;;=
	;;^UTILITY(U,$J,"OPT",936,51)
	;;=
	;;^UTILITY(U,$J,"OPT",936,"U")
	;;=SITE PARAMETER ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",939,0)
	;;=FBAA ENTER/EDIT LETTERS^Enter/Edit Suspension Letters^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",939,1,0)
	;;=^^1^1^2930514^^
	;;^UTILITY(U,$J,"OPT",939,1,1,0)
	;;=This option is used to enter/edit suspension and unauthorized claim letters.
	;;^UTILITY(U,$J,"OPT",939,25)
	;;=FBAAELT
	;;^UTILITY(U,$J,"OPT",939,"U")
	;;=ENTER/EDIT SUSPENSION LETTERS
	;;^UTILITY(U,$J,"OPT",941,0)
	;;=FBAA MULTIPLE PAYMENT ENTRY^Multiple Payment Entry^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",941,1,0)
	;;=^^3^3^2880304^
	;;^UTILITY(U,$J,"OPT",941,1,1,0)
	;;=This option is used to enter identical medical
	;;^UTILITY(U,$J,"OPT",941,1,2,0)
	;;=payments for a specific patient and vendor.Only
	;;^UTILITY(U,$J,"OPT",941,1,3,0)
	;;=the date of service may differ.
	;;^UTILITY(U,$J,"OPT",941,25)
	;;=FBAAMP
	;;^UTILITY(U,$J,"OPT",941,"U")
	;;=MULTIPLE PAYMENT ENTRY
	;;^UTILITY(U,$J,"OPT",942,0)
	;;=FBAA SUSPENSION LETTER PRINT^Suspension Letter Print^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",942,1,0)
	;;=^^1^1^2940916^^
	;;^UTILITY(U,$J,"OPT",942,1,1,0)
	;;=Print Suspension Letters.
	;;^UTILITY(U,$J,"OPT",942,25)
	;;=FBAASLP
	;;^UTILITY(U,$J,"OPT",942,"U")
	;;=SUSPENSION LETTER PRINT
	;;^UTILITY(U,$J,"OPT",998,0)
	;;=FBAA SUPERVISOR RELEASE^Release a Batch^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",998,1,0)
	;;=^^1^1^2860912^^
	;;^UTILITY(U,$J,"OPT",998,1,1,0)
	;;=Used by the Supervisor to Release batch for payment.
	;;^UTILITY(U,$J,"OPT",998,25)
	;;=FBAASCB
	;;^UTILITY(U,$J,"OPT",998,"U")
	;;=RELEASE A BATCH
	;;^UTILITY(U,$J,"OPT",999,0)
	;;=FBAA PRINT 7079 GROUP^Group 7079 Print^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",999,1,0)
	;;=^^1^1^2930610^^^^
	;;^UTILITY(U,$J,"OPT",999,1,1,0)
	;;=Prints VA Form 7079 the Request for Outpatient Medical Services for a group.
	;;^UTILITY(U,$J,"OPT",999,25)
	;;=FBAA79
	;;^UTILITY(U,$J,"OPT",999,"U")
	;;=GROUP 7079 PRINT
	;;^UTILITY(U,$J,"OPT",1009,0)
	;;=FBAA EDIT PHARMACY INVOICE^Edit Pharmacy Invoice^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1009,1,0)
	;;=^^1^1^2870318^
	;;^UTILITY(U,$J,"OPT",1009,1,1,0)
	;;=ALLOWS EDITING OF PREVIOUSLY ENTERED PHARMACY INVOICE.
	;;^UTILITY(U,$J,"OPT",1009,25)
	;;=FBAAEPI
	;;^UTILITY(U,$J,"OPT",1009,"U")
	;;=EDIT PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",1014,0)
	;;=FBAA PHARMACY INVOICE STATUS^Pharmacy Invoice Status^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1014,1,0)
	;;=^^1^1^2870318^
	;;^UTILITY(U,$J,"OPT",1014,1,1,0)
	;;=DISPLAYS THE STATUS OF A PHARMACY INVOICE.
	;;^UTILITY(U,$J,"OPT",1014,25)
	;;=FBAAPIS
	;;^UTILITY(U,$J,"OPT",1014,"U")
	;;=PHARMACY INVOICE STATUS
	;;^UTILITY(U,$J,"OPT",1015,0)
	;;=FBAA PRINT 7079 SINGLE^7079 Print for Selected Patient^^R^^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",1015,1,0)
	;;=^^1^1^2930610^^^^

FBINI03T
FBINI03T	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1015,1,1,0)
	;;=Prints individual 7079 for selected patient.
	;;^UTILITY(U,$J,"OPT",1015,15)
	;;=K DFN,PSA
	;;^UTILITY(U,$J,"OPT",1015,25)
	;;=FBAAS79
	;;^UTILITY(U,$J,"OPT",1015,"U")
	;;=7079 PRINT FOR SELECTED PATIEN
	;;^UTILITY(U,$J,"OPT",1020,0)
	;;=FBAA PHARMACY INVOICE DISPLAY^Display Pharmacy Invoice^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1020,1,0)
	;;=^^1^1^2870318^
	;;^UTILITY(U,$J,"OPT",1020,1,1,0)
	;;=Displays all invoice items for an invoice.
	;;^UTILITY(U,$J,"OPT",1020,25)
	;;=FBAAPII
	;;^UTILITY(U,$J,"OPT",1020,"U")
	;;=DISPLAY PHARMACY INVOICE
	;;^UTILITY(U,$J,"OPT",1021,0)
	;;=FBAA EDIT PAYMENT^Edit Payment^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1021,1,0)
	;;=^^2^2^2880304^
	;;^UTILITY(U,$J,"OPT",1021,1,1,0)
	;;=This option is used to edit payments already entered in the
	;;^UTILITY(U,$J,"OPT",1021,1,2,0)
	;;=system.
	;;^UTILITY(U,$J,"OPT",1021,25)
	;;=FBAAPET
	;;^UTILITY(U,$J,"OPT",1021,30)
	;;=
	;;^UTILITY(U,$J,"OPT",1021,31)
	;;=
	;;^UTILITY(U,$J,"OPT",1021,50)
	;;=
	;;^UTILITY(U,$J,"OPT",1021,51)
	;;=
	;;^UTILITY(U,$J,"OPT",1021,"U")
	;;=EDIT PAYMENT
	;;^UTILITY(U,$J,"OPT",1023,0)
	;;=FBAA EDIT INVOICE STATUS^Edit Pharmacy Invoice Status^^E^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1023,1,0)
	;;=^^1^1^2930507^^^
	;;^UTILITY(U,$J,"OPT",1023,1,1,0)
	;;=USED TO CHANGE THE STATUS OF A PHARMACY INVOICE.
	;;^UTILITY(U,$J,"OPT",1023,30)
	;;=FBAA(162.1,
	;;^UTILITY(U,$J,"OPT",1023,31)
	;;=AEQM
	;;^UTILITY(U,$J,"OPT",1023,50)
	;;=FBAA(162.1,
	;;^UTILITY(U,$J,"OPT",1023,51)
	;;=5
	;;^UTILITY(U,$J,"OPT",1023,"U")
	;;=EDIT PHARMACY INVOICE STATUS
	;;^UTILITY(U,$J,"OPT",1141,0)
	;;=FBAA MRA VETERAN DELETE TYPE^Delete type Veteran MRA^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",1141,1,0)
	;;=^^2^2^2860915^^
	;;^UTILITY(U,$J,"OPT",1141,1,1,0)
	;;=Creates a Patient MRA delete type transaction which will result in the
	;;^UTILITY(U,$J,"OPT",1141,1,2,0)
	;;=deleting of that patient master record in the Fee centralized system.
	;;^UTILITY(U,$J,"OPT",1141,20)
	;;=S FBMTYPE="D" D ^FBAAPM
	;;^UTILITY(U,$J,"OPT",1141,25)
	;;=
	;;^UTILITY(U,$J,"OPT",1141,"U")
	;;=DELETE TYPE VETERAN MRA
	;;^UTILITY(U,$J,"OPT",1142,0)
	;;=FBAA MRA VETERAN ADD TYPE^Add type Veteran MRA^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",1142,1,0)
	;;=^^3^3^2930706^^^
	;;^UTILITY(U,$J,"OPT",1142,1,1,0)
	;;=Creates an Add type Veteran MRA transaction to be sent to the Centralized
	;;^UTILITY(U,$J,"OPT",1142,1,2,0)
	;;=Fee system in Austin. Will result in the creation of a new Patient entry
	;;^UTILITY(U,$J,"OPT",1142,1,3,0)
	;;=in the Central Patient file.
	;;^UTILITY(U,$J,"OPT",1142,20)
	;;=S FBMTYPE="A" D ^FBAAPM
	;;^UTILITY(U,$J,"OPT",1142,"U")
	;;=ADD TYPE VETERAN MRA
	;;^UTILITY(U,$J,"OPT",1143,0)
	;;=FBAA MRA VETERAN CHANGE TYPE^Change type Veteran MRA^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",1143,1,0)
	;;=^^2^2^2860915^
	;;^UTILITY(U,$J,"OPT",1143,1,1,0)
	;;=Creates Change type patient MRA to be sent to the Austin Central Fee system.
	;;^UTILITY(U,$J,"OPT",1143,1,2,0)
	;;=Will result in the change of the Patient master record on that system.
	;;^UTILITY(U,$J,"OPT",1143,20)
	;;=S FBMTYPE="C" D ^FBAAPM
	;;^UTILITY(U,$J,"OPT",1143,"U")
	;;=CHANGE TYPE VETERAN MRA
	;;^UTILITY(U,$J,"OPT",1144,0)
	;;=FBAA MRA VETERAN REINSTATE^Reinstate type Veteran MRA^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",1144,1,0)
	;;=^^2^2^2860915^
	;;^UTILITY(U,$J,"OPT",1144,1,1,0)
	;;=Creates patient MRA 'Reinstate' type transaction. Will Reinstate patient
	;;^UTILITY(U,$J,"OPT",1144,1,2,0)
	;;=(previously deleted) in the Central Fee system.
	;;^UTILITY(U,$J,"OPT",1144,20)
	;;=S FBMTYPE="R" D ^FBAAPM
	;;^UTILITY(U,$J,"OPT",1144,"U")
	;;=REINSTATE TYPE VETERAN MRA
	;;^UTILITY(U,$J,"OPT",1145,0)
	;;=FBAA VETERAN MRA MAIN MENU^Veteran MRA Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1145,1,0)
	;;=^^1^1^2860915^
	;;^UTILITY(U,$J,"OPT",1145,1,1,0)
	;;=Main Menu for Patient MRA options.
	;;^UTILITY(U,$J,"OPT",1145,10,0)
	;;=^19.01PI^4^4
	;;^UTILITY(U,$J,"OPT",1145,10,1,0)
	;;=1142^
	;;^UTILITY(U,$J,"OPT",1145,10,1,"^")
	;;=FBAA MRA VETERAN ADD TYPE
	;;^UTILITY(U,$J,"OPT",1145,10,2,0)
	;;=1143^

FBINI03U
FBINI03U	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1145,10,2,"^")
	;;=FBAA MRA VETERAN CHANGE TYPE
	;;^UTILITY(U,$J,"OPT",1145,10,3,0)
	;;=1141^
	;;^UTILITY(U,$J,"OPT",1145,10,3,"^")
	;;=FBAA MRA VETERAN DELETE TYPE
	;;^UTILITY(U,$J,"OPT",1145,10,4,0)
	;;=1144^
	;;^UTILITY(U,$J,"OPT",1145,10,4,"^")
	;;=FBAA MRA VETERAN REINSTATE
	;;^UTILITY(U,$J,"OPT",1145,99)
	;;=56204,44918
	;;^UTILITY(U,$J,"OPT",1145,"U")
	;;=VETERAN MRA MAIN MENU
	;;^UTILITY(U,$J,"OPT",1146,0)
	;;=FBAA QUEUE DATA FOR TRANS.^Queue Data for Transmission^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",1146,1,0)
	;;=^^2^2^2901104^^
	;;^UTILITY(U,$J,"OPT",1146,1,1,0)
	;;=This option is used by the supervisor to transmit to Austin
	;;^UTILITY(U,$J,"OPT",1146,1,2,0)
	;;=FEE payments and MRA's via electronic mail.
	;;^UTILITY(U,$J,"OPT",1146,25)
	;;=FBAAV0
	;;^UTILITY(U,$J,"OPT",1146,"U")
	;;=QUEUE DATA FOR TRANSMISSION
	;;^UTILITY(U,$J,"OPT",1147,0)
	;;=FBAA MRA VENDOR REINSTATE^Reinstate Vendor MRA^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1147,1,0)
	;;=^^14^14^2931025^^
	;;^UTILITY(U,$J,"OPT",1147,1,1,0)
	;;=The 'Reinstate Vendor MRA' option is used to reactivate a vendor formerly in delete status.
	;;^UTILITY(U,$J,"OPT",1147,1,2,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",1147,1,3,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",1147,1,4,0)
	;;= 1)  If the vendor is in delete status on both your system as well as
	;;^UTILITY(U,$J,"OPT",1147,1,5,0)
	;;=     Central FEE, you only need to use the 'Reinstate Vendor MRA' option.
	;;^UTILITY(U,$J,"OPT",1147,1,6,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",1147,1,7,0)
	;;= 2)  If the vendor is in delete status on your system, but no longer
	;;^UTILITY(U,$J,"OPT",1147,1,8,0)
	;;=     resides on the Central FEE system, use the 'Update FMS Vendor File 
	;;^UTILITY(U,$J,"OPT",1147,1,9,0)
	;;=     in Austin' option.
	;;^UTILITY(U,$J,"OPT",1147,1,10,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",1147,1,11,0)
	;;= 3)  If a vendor which you were now adding to your system somehow
	;;^UTILITY(U,$J,"OPT",1147,1,12,0)
	;;=     already resided on the Central FEE system, but in delete status,
	;;^UTILITY(U,$J,"OPT",1147,1,13,0)
	;;=     you would need to add the vendor to your system, transmit data
	;;^UTILITY(U,$J,"OPT",1147,1,14,0)
	;;=     to Austin, and then invoke the 'Reinstate Vendor MRA' option.
	;;^UTILITY(U,$J,"OPT",1147,25)
	;;=FBAARV
	;;^UTILITY(U,$J,"OPT",1147,"U")
	;;=REINSTATE VENDOR MRA
	;;^UTILITY(U,$J,"OPT",1273,0)
	;;=FBAA PRINT REPORT OF CONTACT^Print Report of Contact^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1273,1,0)
	;;=^^2^2^2881014^
	;;^UTILITY(U,$J,"OPT",1273,1,1,0)
	;;=This option generates a hard copy of a Fee Basis Patient
	;;^UTILITY(U,$J,"OPT",1273,1,2,0)
	;;=Report of Contact in the format of VA FORM 119.
	;;^UTILITY(U,$J,"OPT",1273,25)
	;;=FBAAPRC
	;;^UTILITY(U,$J,"OPT",1273,"U")
	;;=PRINT REPORT OF CONTACT
	;;^UTILITY(U,$J,"OPT",1274,0)
	;;=FBAA VENDOR LOOKUP^Payment Look-up for Medical Vendor^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1274,1,0)
	;;=^^2^2^2881014^
	;;^UTILITY(U,$J,"OPT",1274,1,1,0)
	;;=This option may be used to look-up payment history for a
	;;^UTILITY(U,$J,"OPT",1274,1,2,0)
	;;=selected time frame for a Medical vendor.
	;;^UTILITY(U,$J,"OPT",1274,25)
	;;=FBAAVLU
	;;^UTILITY(U,$J,"OPT",1274,"U")
	;;=PAYMENT LOOK-UP FOR MEDICAL VE
	;;^UTILITY(U,$J,"OPT",1275,0)
	;;=FBAA PHARMACY LOOKUP^Pharmacy Vendor Payment Look-Up^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1275,1,0)
	;;=^^2^2^2881014^
	;;^UTILITY(U,$J,"OPT",1275,1,1,0)
	;;=This option may be used to look-up payment history, for a selected time
	;;^UTILITY(U,$J,"OPT",1275,1,2,0)
	;;=frame, for a Pharmacy vendor.
	;;^UTILITY(U,$J,"OPT",1275,25)
	;;=FBAAPLU
	;;^UTILITY(U,$J,"OPT",1275,"U")
	;;=PHARMACY VENDOR PAYMENT LOOK-U
	;;^UTILITY(U,$J,"OPT",1276,0)
	;;=FBAA MEDICAL VOID PAYMENT^Medical Void Payment^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1276,1,0)
	;;=^^6^6^2930517^^^^
	;;^UTILITY(U,$J,"OPT",1276,1,1,0)
	;;=This option, available to the Fee Supervisor, allows for voiding
	;;^UTILITY(U,$J,"OPT",1276,1,2,0)
	;;=a payment that has already been finalized. This option is useful
	;;^UTILITY(U,$J,"OPT",1276,1,3,0)
	;;=in the circumstance that a check is returned by a vendor. You can

FBINI03V
FBINI03V	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1276,1,4,0)
	;;=retain the payment history but flag the payment as void(#).
	;;^UTILITY(U,$J,"OPT",1276,1,5,0)
	;;=The dollars for the payment must be added back into
	;;^UTILITY(U,$J,"OPT",1276,1,6,0)
	;;=the appropriate obligation using the appropriate IFCAP option.
	;;^UTILITY(U,$J,"OPT",1276,25)
	;;=FBAAVP
	;;^UTILITY(U,$J,"OPT",1276,"U")
	;;=MEDICAL VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",1277,0)
	;;=FBAA PHARMACY VOID PAYMENT^Pharmacy Void Payment^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1277,1,0)
	;;=^^5^5^2900713^^^
	;;^UTILITY(U,$J,"OPT",1277,1,1,0)
	;;=This option, available to the Fee Supervisor, allows for voiding a
	;;^UTILITY(U,$J,"OPT",1277,1,2,0)
	;;=payment to a Pharmacy vendor that has already been Finalized. By
	;;^UTILITY(U,$J,"OPT",1277,1,3,0)
	;;=using this option you have the ability to retain the payment history
	;;^UTILITY(U,$J,"OPT",1277,1,4,0)
	;;=yet, for some reason, void the payment. The dollar amount must be added
	;;^UTILITY(U,$J,"OPT",1277,1,5,0)
	;;=back to the obligation using the appropriate IFCAP option.
	;;^UTILITY(U,$J,"OPT",1277,25)
	;;=FBAAPHV
	;;^UTILITY(U,$J,"OPT",1277,"U")
	;;=PHARMACY VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",1278,0)
	;;=FBAA CANCEL MEDICAL VOID^Medical Delete Void Payment^^R^^^^^^^^^^1^1
	;;^UTILITY(U,$J,"OPT",1278,1,0)
	;;=^^3^3^2900713^^^
	;;^UTILITY(U,$J,"OPT",1278,1,1,0)
	;;=This option will delete the void flag. The dollar amount for the payment
	;;^UTILITY(U,$J,"OPT",1278,1,2,0)
	;;=must be subtracted from the obligation using the appropriate
	;;^UTILITY(U,$J,"OPT",1278,1,3,0)
	;;=IFCAP option.
	;;^UTILITY(U,$J,"OPT",1278,15)
	;;=K FBVOID
	;;^UTILITY(U,$J,"OPT",1278,20)
	;;=S FBVOID=1
	;;^UTILITY(U,$J,"OPT",1278,25)
	;;=FBAAVP
	;;^UTILITY(U,$J,"OPT",1278,"U")
	;;=MEDICAL DELETE VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",1279,0)
	;;=FBAA CANCEL PHARMACY VOID^Pharmacy Delete Void Payment^^R^^^^^^^^^^1^1
	;;^UTILITY(U,$J,"OPT",1279,1,0)
	;;=^^3^3^2900713^^
	;;^UTILITY(U,$J,"OPT",1279,1,1,0)
	;;=This option will delete the void flag. The dollar amount for the payment
	;;^UTILITY(U,$J,"OPT",1279,1,2,0)
	;;=must be subtracted from the obligation using the appropriate
	;;^UTILITY(U,$J,"OPT",1279,1,3,0)
	;;=IFCAP obligation.
	;;^UTILITY(U,$J,"OPT",1279,15)
	;;=K FBVOID
	;;^UTILITY(U,$J,"OPT",1279,20)
	;;=S FBVOID=1
	;;^UTILITY(U,$J,"OPT",1279,25)
	;;=FBAAPHV
	;;^UTILITY(U,$J,"OPT",1279,"U")
	;;=PHARMACY DELETE VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",1280,0)
	;;=FBAA CLERK LOOK-UP^Clerk Look-Up For An Authorization^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1280,1,0)
	;;=^^3^3^2890106^
	;;^UTILITY(U,$J,"OPT",1280,1,1,0)
	;;=This option allows the holder of the FBAASUPERVISOR security
	;;^UTILITY(U,$J,"OPT",1280,1,2,0)
	;;=key to look-up who was the last user to enter and/or edit
	;;^UTILITY(U,$J,"OPT",1280,1,3,0)
	;;=a selected authorization.
	;;^UTILITY(U,$J,"OPT",1280,25)
	;;=FBAACLU
	;;^UTILITY(U,$J,"OPT",1280,"U")
	;;=CLERK LOOK-UP FOR AN AUTHORIZA
	;;^UTILITY(U,$J,"OPT",1286,0)
	;;=FBAA VOID PAYMENT MENU^Void Payment Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1286,1,0)
	;;=^^2^2^2900713^^
	;;^UTILITY(U,$J,"OPT",1286,1,1,0)
	;;=This menu contains the options to void and/or cancel a
	;;^UTILITY(U,$J,"OPT",1286,1,2,0)
	;;=void on a payment that has already been finalized.
	;;^UTILITY(U,$J,"OPT",1286,10,0)
	;;=^19.01PI^8^8
	;;^UTILITY(U,$J,"OPT",1286,10,1,0)
	;;=1276^
	;;^UTILITY(U,$J,"OPT",1286,10,1,"^")
	;;=FBAA MEDICAL VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",1286,10,2,0)
	;;=1277^
	;;^UTILITY(U,$J,"OPT",1286,10,2,"^")
	;;=FBAA PHARMACY VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",1286,10,3,0)
	;;=1278^
	;;^UTILITY(U,$J,"OPT",1286,10,3,"^")
	;;=FBAA CANCEL MEDICAL VOID
	;;^UTILITY(U,$J,"OPT",1286,10,4,0)
	;;=1279^
	;;^UTILITY(U,$J,"OPT",1286,10,4,"^")
	;;=FBAA CANCEL PHARMACY VOID
	;;^UTILITY(U,$J,"OPT",1286,10,5,0)
	;;=3927
	;;^UTILITY(U,$J,"OPT",1286,10,5,"^")
	;;=FBCH VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",1286,10,6,0)
	;;=3928
	;;^UTILITY(U,$J,"OPT",1286,10,6,"^")
	;;=FBCH DELETE VOID
	;;^UTILITY(U,$J,"OPT",1286,10,7,0)
	;;=3929
	;;^UTILITY(U,$J,"OPT",1286,10,7,"^")
	;;=FBCNH VOID PAYMENT

FBINI03W
FBINI03W	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1286,10,8,0)
	;;=3930
	;;^UTILITY(U,$J,"OPT",1286,10,8,"^")
	;;=FBCNH DELETE VOID
	;;^UTILITY(U,$J,"OPT",1286,99)
	;;=56204,45495
	;;^UTILITY(U,$J,"OPT",1286,"U")
	;;=VOID PAYMENT MAIN MENU
	;;^UTILITY(U,$J,"OPT",1287,0)
	;;=FBCH ENTER REQUEST^Enter a Request/Notification^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1287,1,0)
	;;=^^2^2^2890126^
	;;^UTILITY(U,$J,"OPT",1287,1,1,0)
	;;=This is the entry point for contract hospitalization. The
	;;^UTILITY(U,$J,"OPT",1287,1,2,0)
	;;=option allows the user to enter the request for services.
	;;^UTILITY(U,$J,"OPT",1287,25)
	;;=FBCHREQ
	;;^UTILITY(U,$J,"OPT",1287,"U")
	;;=ENTER A REQUEST/NOTIFICATION
	;;^UTILITY(U,$J,"OPT",1288,0)
	;;=FBCH LEGAL ENTITLEMENT^Legal Entitlement^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1288,1,0)
	;;=^^3^3^2930315^^
	;;^UTILITY(U,$J,"OPT",1288,1,1,0)
	;;=Legal entitlement must be determined by the user before
	;;^UTILITY(U,$J,"OPT",1288,1,2,0)
	;;=medical entitlement. If the veteran is determined not
	;;^UTILITY(U,$J,"OPT",1288,1,3,0)
	;;=to be legally entitled then the request is completed.
	;;^UTILITY(U,$J,"OPT",1288,25)
	;;=LENT^FBCHREQ
	;;^UTILITY(U,$J,"OPT",1288,"U")
	;;=LEGAL ENTITLEMENT
	;;^UTILITY(U,$J,"OPT",1289,0)
	;;=FBCH MEDICAL ENTITLEMENT^Medical Entitlement^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1289,1,0)
	;;=^^3^3^2900424^^
	;;^UTILITY(U,$J,"OPT",1289,1,1,0)
	;;=This option is used to enter the medical entitlement of a
	;;^UTILITY(U,$J,"OPT",1289,1,2,0)
	;;=veteran. Legal entitlement has to be determined , for the
	;;^UTILITY(U,$J,"OPT",1289,1,3,0)
	;;=veteran, prior to using this option.
	;;^UTILITY(U,$J,"OPT",1289,25)
	;;=MENT^FBCHREQ
	;;^UTILITY(U,$J,"OPT",1289,"U")
	;;=MEDICAL ENTITLEMENT
	;;^UTILITY(U,$J,"OPT",1290,0)
	;;=FBCH COMPLETE 7078^Complete 7078/Authorization^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1290,1,0)
	;;=^^3^3^2890126^
	;;^UTILITY(U,$J,"OPT",1290,1,1,0)
	;;=If the discharge date was not determined at the time of the
	;;^UTILITY(U,$J,"OPT",1290,1,2,0)
	;;=medical entitlement, this option is used to complete
	;;^UTILITY(U,$J,"OPT",1290,1,3,0)
	;;=the 7078.
	;;^UTILITY(U,$J,"OPT",1290,25)
	;;=FBCHCD
	;;^UTILITY(U,$J,"OPT",1290,"U")
	;;=COMPLETE 7078/AUTHORIZATION
	;;^UTILITY(U,$J,"OPT",1291,0)
	;;=FBCH EDIT 7078^Edit Completed 7078^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1291,1,0)
	;;=^^9^9^2900725^^^
	;;^UTILITY(U,$J,"OPT",1291,1,1,0)
	;;=This option allows the user to edit a completed 7078/authorization.
	;;^UTILITY(U,$J,"OPT",1291,1,2,0)
	;;=The following fields may be editted using this option:
	;;^UTILITY(U,$J,"OPT",1291,1,3,0)
	;;=         - Admitting Authority
	;;^UTILITY(U,$J,"OPT",1291,1,4,0)
	;;=         - To Date
	;;^UTILITY(U,$J,"OPT",1291,1,5,0)
	;;=         - Discharge Type
	;;^UTILITY(U,$J,"OPT",1291,1,6,0)
	;;=         - Bedsection/Treating Specialty
	;;^UTILITY(U,$J,"OPT",1291,1,7,0)
	;;=         - Purpose of Visit
	;;^UTILITY(U,$J,"OPT",1291,1,8,0)
	;;=         - Authorization Remarks
	;;^UTILITY(U,$J,"OPT",1291,1,9,0)
	;;=         - Primary Service Area
	;;^UTILITY(U,$J,"OPT",1291,25)
	;;=EDIT^FBCHCD
	;;^UTILITY(U,$J,"OPT",1291,99)
	;;=55647,37357
	;;^UTILITY(U,$J,"OPT",1291,"U")
	;;=EDIT COMPLETED 7078
	;;^UTILITY(U,$J,"OPT",1292,0)
	;;=FBCH DISPLAY 7078^Display 7078/Authorization^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1292,1,0)
	;;=^^1^1^2890126^
	;;^UTILITY(U,$J,"OPT",1292,1,1,0)
	;;=Displays the information for a 7078.
	;;^UTILITY(U,$J,"OPT",1292,25)
	;;=OUTP^FBCH78
	;;^UTILITY(U,$J,"OPT",1292,"U")
	;;=DISPLAY 7078/AUTHORIZATION
	;;^UTILITY(U,$J,"OPT",1293,0)
	;;=FBCH DISPLAY REQUEST^Display a Request/Notification^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1293,1,0)
	;;=^^1^1^2930315^^
	;;^UTILITY(U,$J,"OPT",1293,1,1,0)
	;;=Displays a request/notification by entering a veteran's name.
	;;^UTILITY(U,$J,"OPT",1293,25)
	;;=OUTP^FBCHREQ
	;;^UTILITY(U,$J,"OPT",1293,"U")
	;;=DISPLAY A REQUEST/NOTIFICATION
	;;^UTILITY(U,$J,"OPT",1294,0)
	;;=FBCH ENTER PAYMENT^Enter Invoice/Payment^^R^^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",1294,1,0)
	;;=^^3^3^2890131^^
	;;^UTILITY(U,$J,"OPT",1294,1,1,0)
	;;=This option is used to enter a payment for the first time.

FBINI03X
FBINI03X	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1294,1,2,0)
	;;=The user has to use the 'Edit payment' option to make
	;;^UTILITY(U,$J,"OPT",1294,1,3,0)
	;;=changes.
	;;^UTILITY(U,$J,"OPT",1294,15)
	;;=K FB583 Q
	;;^UTILITY(U,$J,"OPT",1294,25)
	;;=FBCHEP
	;;^UTILITY(U,$J,"OPT",1294,99)
	;;=55769,39621
	;;^UTILITY(U,$J,"OPT",1294,"U")
	;;=ENTER INVOICE/PAYMENT
	;;^UTILITY(U,$J,"OPT",1295,0)
	;;=FBCH EDIT PAYMENT^Invoice Edit^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1295,1,0)
	;;=^^2^2^2890127^
	;;^UTILITY(U,$J,"OPT",1295,1,1,0)
	;;=This option is used to edit the dollar amounts as well
	;;^UTILITY(U,$J,"OPT",1295,1,2,0)
	;;=as any diagnostic and/or procedure codes.
	;;^UTILITY(U,$J,"OPT",1295,25)
	;;=FBCHEP1
	;;^UTILITY(U,$J,"OPT",1295,"U")
	;;=INVOICE EDIT
	;;^UTILITY(U,$J,"OPT",1296,0)
	;;=FBCH MAIN MENU^Civil Hospital Main Menu^^M^^^^^^^^^^1^1
	;;^UTILITY(U,$J,"OPT",1296,1,0)
	;;=^^1^1^2931228^^^^
	;;^UTILITY(U,$J,"OPT",1296,1,1,0)
	;;=Main menu for processing claims for civil/contract hospital.
	;;^UTILITY(U,$J,"OPT",1296,10,0)
	;;=^19.01PI^8^7
	;;^UTILITY(U,$J,"OPT",1296,10,1,0)
	;;=1297^^1
	;;^UTILITY(U,$J,"OPT",1296,10,1,"^")
	;;=FBCH NOTIFICATION MENU
	;;^UTILITY(U,$J,"OPT",1296,10,2,0)
	;;=1298^^2
	;;^UTILITY(U,$J,"OPT",1296,10,2,"^")
	;;=FBCH DISPOSITION MENU
	;;^UTILITY(U,$J,"OPT",1296,10,3,0)
	;;=1300^^5
	;;^UTILITY(U,$J,"OPT",1296,10,3,"^")
	;;=FBCH OUTPUT MENU
	;;^UTILITY(U,$J,"OPT",1296,10,4,0)
	;;=1299^^3
	;;^UTILITY(U,$J,"OPT",1296,10,4,"^")
	;;=FBCH PAYMENT MENU
	;;^UTILITY(U,$J,"OPT",1296,10,5,0)
	;;=1306^^4
	;;^UTILITY(U,$J,"OPT",1296,10,5,"^")
	;;=FBCH BATCH OPTIONS
	;;^UTILITY(U,$J,"OPT",1296,10,6,0)
	;;=1146^
	;;^UTILITY(U,$J,"OPT",1296,10,6,"^")
	;;=FBAA QUEUE DATA FOR TRANS.
	;;^UTILITY(U,$J,"OPT",1296,10,8,0)
	;;=3590
	;;^UTILITY(U,$J,"OPT",1296,10,8,"^")
	;;=FBCH GENERIC PRICER
	;;^UTILITY(U,$J,"OPT",1296,15)
	;;=K FBSW
	;;^UTILITY(U,$J,"OPT",1296,20)
	;;=I '$D(FBSW) D ^FBCHSTA
	;;^UTILITY(U,$J,"OPT",1296,99)
	;;=56204,45431
	;;^UTILITY(U,$J,"OPT",1296,99.1)
	;;=54531,42132
	;;^UTILITY(U,$J,"OPT",1296,"U")
	;;=CIVIL HOSPITAL MAIN MENU
	;;^UTILITY(U,$J,"OPT",1297,0)
	;;=FBCH NOTIFICATION MENU^Notification/Request Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1297,1,0)
	;;=^^1^1^2890127^^^
	;;^UTILITY(U,$J,"OPT",1297,1,1,0)
	;;=Main menu for the request/notification process.
	;;^UTILITY(U,$J,"OPT",1297,10,0)
	;;=^19.01PI^12^12
	;;^UTILITY(U,$J,"OPT",1297,10,1,0)
	;;=1287^^1
	;;^UTILITY(U,$J,"OPT",1297,10,1,"^")
	;;=FBCH ENTER REQUEST
	;;^UTILITY(U,$J,"OPT",1297,10,2,0)
	;;=1288^^2
	;;^UTILITY(U,$J,"OPT",1297,10,2,"^")
	;;=FBCH LEGAL ENTITLEMENT
	;;^UTILITY(U,$J,"OPT",1297,10,3,0)
	;;=1289^^3
	;;^UTILITY(U,$J,"OPT",1297,10,3,"^")
	;;=FBCH MEDICAL ENTITLEMENT
	;;^UTILITY(U,$J,"OPT",1297,10,4,0)
	;;=1293^^4
	;;^UTILITY(U,$J,"OPT",1297,10,4,"^")
	;;=FBCH DISPLAY REQUEST
	;;^UTILITY(U,$J,"OPT",1297,10,5,0)
	;;=2325^
	;;^UTILITY(U,$J,"OPT",1297,10,5,"^")
	;;=FBCH DELETE REQUEST
	;;^UTILITY(U,$J,"OPT",1297,10,6,0)
	;;=2362^
	;;^UTILITY(U,$J,"OPT",1297,10,6,"^")
	;;=FBCH PRINT REPORT OF CONTACT
	;;^UTILITY(U,$J,"OPT",1297,10,7,0)
	;;=2363^
	;;^UTILITY(U,$J,"OPT",1297,10,7,"^")
	;;=FBCH UPDATE REPORT OF CONTACT
	;;^UTILITY(U,$J,"OPT",1297,10,8,0)
	;;=2364^
	;;^UTILITY(U,$J,"OPT",1297,10,8,"^")
	;;=FBCH EDIT REPORT OF CONTACT
	;;^UTILITY(U,$J,"OPT",1297,10,9,0)
	;;=2370^^1.5
	;;^UTILITY(U,$J,"OPT",1297,10,9,"^")
	;;=FBCH EDIT REQUEST
	;;^UTILITY(U,$J,"OPT",1297,10,10,0)
	;;=3604
	;;^UTILITY(U,$J,"OPT",1297,10,10,"^")
	;;=FBCH PRINT REQUEST AUDIT
	;;^UTILITY(U,$J,"OPT",1297,10,11,0)
	;;=3603
	;;^UTILITY(U,$J,"OPT",1297,10,11,"^")
	;;=FBCH REOPEN REQUEST
	;;^UTILITY(U,$J,"OPT",1297,10,12,0)
	;;=3605
	;;^UTILITY(U,$J,"OPT",1297,10,12,"^")
	;;=FBCH PENDING REQUEST
	;;^UTILITY(U,$J,"OPT",1297,99)
	;;=56204,45435
	;;^UTILITY(U,$J,"OPT",1297,"U")
	;;=NOTIFICATION/REQUEST MENU
	;;^UTILITY(U,$J,"OPT",1298,0)
	;;=FBCH DISPOSITION MENU^Disposition Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1298,1,0)
	;;=^^3^3^2890127^^^^
	;;^UTILITY(U,$J,"OPT",1298,1,1,0)
	;;=This menu contains the ability to complete,
	;;^UTILITY(U,$J,"OPT",1298,1,2,0)
	;;=edit and display a 7078/authorization for

FBINI03Y
FBINI03Y	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1298,1,3,0)
	;;=civil/contract hospital.
	;;^UTILITY(U,$J,"OPT",1298,10,0)
	;;=^19.01PI^6^6
	;;^UTILITY(U,$J,"OPT",1298,10,1,0)
	;;=1290^^1
	;;^UTILITY(U,$J,"OPT",1298,10,1,"^")
	;;=FBCH COMPLETE 7078
	;;^UTILITY(U,$J,"OPT",1298,10,2,0)
	;;=1291^^2
	;;^UTILITY(U,$J,"OPT",1298,10,2,"^")
	;;=FBCH EDIT 7078
	;;^UTILITY(U,$J,"OPT",1298,10,3,0)
	;;=1292^^3
	;;^UTILITY(U,$J,"OPT",1298,10,3,"^")
	;;=FBCH DISPLAY 7078
	;;^UTILITY(U,$J,"OPT",1298,10,4,0)
	;;=2285^
	;;^UTILITY(U,$J,"OPT",1298,10,4,"^")
	;;=FBCH 7078 SETUP
	;;^UTILITY(U,$J,"OPT",1298,10,5,0)
	;;=3606
	;;^UTILITY(U,$J,"OPT",1298,10,5,"^")
	;;=FBCH CANCEL 7078
	;;^UTILITY(U,$J,"OPT",1298,10,6,0)
	;;=3620
	;;^UTILITY(U,$J,"OPT",1298,10,6,"^")
	;;=FBCH PRINT CANCELLED 7078
	;;^UTILITY(U,$J,"OPT",1298,99)
	;;=56204,45439
	;;^UTILITY(U,$J,"OPT",1298,"U")
	;;=DISPOSITION MENU
	;;^UTILITY(U,$J,"OPT",1299,0)
	;;=FBCH PAYMENT MENU^Payment Process Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1299,1,0)
	;;=^^2^2^2890127^
	;;^UTILITY(U,$J,"OPT",1299,1,1,0)
	;;=This menu has the options needed to enter and
	;;^UTILITY(U,$J,"OPT",1299,1,2,0)
	;;=edit a contract hospital payment.
	;;^UTILITY(U,$J,"OPT",1299,10,0)
	;;=^19.01PI^10^9
	;;^UTILITY(U,$J,"OPT",1299,10,1,0)
	;;=1294^
	;;^UTILITY(U,$J,"OPT",1299,10,1,"^")
	;;=FBCH ENTER PAYMENT
	;;^UTILITY(U,$J,"OPT",1299,10,2,0)
	;;=1295^
	;;^UTILITY(U,$J,"OPT",1299,10,2,"^")
	;;=FBCH EDIT PAYMENT
	;;^UTILITY(U,$J,"OPT",1299,10,3,0)
	;;=2277^
	;;^UTILITY(U,$J,"OPT",1299,10,3,"^")
	;;=FBCH COMPLETE PAYMENT
	;;^UTILITY(U,$J,"OPT",1299,10,4,0)
	;;=2310^
	;;^UTILITY(U,$J,"OPT",1299,10,4,"^")
	;;=FBCH ANCILLARY PAYMENT
	;;^UTILITY(U,$J,"OPT",1299,10,5,0)
	;;=2361^
	;;^UTILITY(U,$J,"OPT",1299,10,5,"^")
	;;=FBCH EDIT ANCILLARY PAYMENT
	;;^UTILITY(U,$J,"OPT",1299,10,7,0)
	;;=3621
	;;^UTILITY(U,$J,"OPT",1299,10,7,"^")
	;;=FBCH REIMBURSEMENT INVOICE
	;;^UTILITY(U,$J,"OPT",1299,10,8,0)
	;;=3897
	;;^UTILITY(U,$J,"OPT",1299,10,8,"^")
	;;=FBCH DELETE INVOICE
	;;^UTILITY(U,$J,"OPT",1299,10,9,0)
	;;=3903
	;;^UTILITY(U,$J,"OPT",1299,10,9,"^")
	;;=FBCH ANCILLARY REIMBURSEMENT
	;;^UTILITY(U,$J,"OPT",1299,10,10,0)
	;;=4780
	;;^UTILITY(U,$J,"OPT",1299,10,10,"^")
	;;=FBCH MULTIPLE PAYMENTS
	;;^UTILITY(U,$J,"OPT",1299,99)
	;;=56204,45734
	;;^UTILITY(U,$J,"OPT",1299,"U")
	;;=PAYMENT PROCESS MENU
	;;^UTILITY(U,$J,"OPT",1300,0)
	;;=FBCH OUTPUT MENU^Output Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1300,1,0)
	;;=^^2^2^2930423^^^
	;;^UTILITY(U,$J,"OPT",1300,1,1,0)
	;;=Main menu for output reports such as payment history,
	;;^UTILITY(U,$J,"OPT",1300,1,2,0)
	;;=7078's, 10 day report, etc.
	;;^UTILITY(U,$J,"OPT",1300,10,0)
	;;=^19.01PI^19^15
	;;^UTILITY(U,$J,"OPT",1300,10,1,0)
	;;=458^
	;;^UTILITY(U,$J,"OPT",1300,10,1,"^")
	;;=FBAA DISPLAY OPEN BATCHES
	;;^UTILITY(U,$J,"OPT",1300,10,2,0)
	;;=459^
	;;^UTILITY(U,$J,"OPT",1300,10,2,"^")
	;;=FBAA LIST CLOSED BATCHES
	;;^UTILITY(U,$J,"OPT",1300,10,3,0)
	;;=791^
	;;^UTILITY(U,$J,"OPT",1300,10,3,"^")
	;;=FBAA REJECT PRINT
	;;^UTILITY(U,$J,"OPT",1300,10,4,0)
	;;=1307^
	;;^UTILITY(U,$J,"OPT",1300,10,4,"^")
	;;=FBCH PRINT 7078
	;;^UTILITY(U,$J,"OPT",1300,10,7,0)
	;;=1310^
	;;^UTILITY(U,$J,"OPT",1300,10,7,"^")
	;;=FBCH INVOICE DISPLAY
	;;^UTILITY(U,$J,"OPT",1300,10,8,0)
	;;=2304^
	;;^UTILITY(U,$J,"OPT",1300,10,8,"^")
	;;=FBCH PRICER REJECTS
	;;^UTILITY(U,$J,"OPT",1300,10,9,0)
	;;=2305^
	;;^UTILITY(U,$J,"OPT",1300,10,9,"^")
	;;=FBCH HOSPITAL ACTIVITY
	;;^UTILITY(U,$J,"OPT",1300,10,10,0)
	;;=2306^
	;;^UTILITY(U,$J,"OPT",1300,10,10,"^")
	;;=FBCH REQUEST STATS
	;;^UTILITY(U,$J,"OPT",1300,10,12,0)
	;;=3920
	;;^UTILITY(U,$J,"OPT",1300,10,12,"^")
	;;=FBCH COST REPORT
	;;^UTILITY(U,$J,"OPT",1300,10,14,0)
	;;=4042
	;;^UTILITY(U,$J,"OPT",1300,10,14,"^")
	;;=FB PAY VENDOR
	;;^UTILITY(U,$J,"OPT",1300,10,15,0)
	;;=4043
	;;^UTILITY(U,$J,"OPT",1300,10,15,"^")
	;;=FB PAY VETERAN
	;;^UTILITY(U,$J,"OPT",1300,10,16,0)
	;;=3905
	;;^UTILITY(U,$J,"OPT",1300,10,16,"^")
	;;=FB PCR
	;;^UTILITY(U,$J,"OPT",1300,10,17,0)
	;;=4110
	;;^UTILITY(U,$J,"OPT",1300,10,17,"^")
	;;=FBCH UC COST REPORT
	;;^UTILITY(U,$J,"OPT",1300,10,18,0)
	;;=4175
	;;^UTILITY(U,$J,"OPT",1300,10,18,"^")
	;;=FBCH CENSUS REPORT

FBINI03Z
FBINI03Z	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1300,10,19,0)
	;;=4607
	;;^UTILITY(U,$J,"OPT",1300,10,19,"^")
	;;=FB CHECK DISPLAY
	;;^UTILITY(U,$J,"OPT",1300,99)
	;;=56204,45670
	;;^UTILITY(U,$J,"OPT",1300,"U")
	;;=OUTPUT MENU
	;;^UTILITY(U,$J,"OPT",1301,0)
	;;=FBCH OPEN BATCH^Open a Batch^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1301,1,0)
	;;=^^1^1^2900409^^
	;;^UTILITY(U,$J,"OPT",1301,1,1,0)
	;;=This option is used to open a batch for Contract Hospital.
	;;^UTILITY(U,$J,"OPT",1301,25)
	;;=RCHOP^FBAAOB
	;;^UTILITY(U,$J,"OPT",1301,"U")
	;;=OPEN A BATCH
	;;^UTILITY(U,$J,"OPT",1306,0)
	;;=FBCH BATCH OPTIONS^Batch Main Menu - CH^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1306,1,0)
	;;=^^1^1^2890202^
	;;^UTILITY(U,$J,"OPT",1306,1,1,0)
	;;=Main menu for all batch options.
	;;^UTILITY(U,$J,"OPT",1306,10,0)
	;;=^19.01PI^16^14
	;;^UTILITY(U,$J,"OPT",1306,10,1,0)
	;;=451^^9
	;;^UTILITY(U,$J,"OPT",1306,10,1,"^")
	;;=FBAA BATCH STATUS
	;;^UTILITY(U,$J,"OPT",1306,10,2,0)
	;;=453^^10
	;;^UTILITY(U,$J,"OPT",1306,10,2,"^")
	;;=FBAA LIST BATCH
	;;^UTILITY(U,$J,"OPT",1306,10,3,0)
	;;=454^^3
	;;^UTILITY(U,$J,"OPT",1306,10,3,"^")
	;;=FBAA CLOSE BATCH
	;;^UTILITY(U,$J,"OPT",1306,10,4,0)
	;;=455^^4
	;;^UTILITY(U,$J,"OPT",1306,10,4,"^")
	;;=FBAA REOPEN BATCH
	;;^UTILITY(U,$J,"OPT",1306,10,6,0)
	;;=1301^^1
	;;^UTILITY(U,$J,"OPT",1306,10,6,"^")
	;;=FBCH OPEN BATCH
	;;^UTILITY(U,$J,"OPT",1306,10,7,0)
	;;=882^^2
	;;^UTILITY(U,$J,"OPT",1306,10,7,"^")
	;;=FBAA BATCH EDIT
	;;^UTILITY(U,$J,"OPT",1306,10,8,0)
	;;=790^^8
	;;^UTILITY(U,$J,"OPT",1306,10,8,"^")
	;;=FBAA VOUCHER DELETE REJECT
	;;^UTILITY(U,$J,"OPT",1306,10,9,0)
	;;=789^^6
	;;^UTILITY(U,$J,"OPT",1306,10,9,"^")
	;;=FBAA FINALIZE BATCH
	;;^UTILITY(U,$J,"OPT",1306,10,11,0)
	;;=792^^7
	;;^UTILITY(U,$J,"OPT",1306,10,11,"^")
	;;=FBAA REINITIATE REJECTS
	;;^UTILITY(U,$J,"OPT",1306,10,12,0)
	;;=2276^^5
	;;^UTILITY(U,$J,"OPT",1306,10,12,"^")
	;;=FBCH PRICER RELEASE
	;;^UTILITY(U,$J,"OPT",1306,10,13,0)
	;;=998^^5.5
	;;^UTILITY(U,$J,"OPT",1306,10,13,"^")
	;;=FBAA SUPERVISOR RELEASE
	;;^UTILITY(U,$J,"OPT",1306,10,14,0)
	;;=2303^^5.3
	;;^UTILITY(U,$J,"OPT",1306,10,14,"^")
	;;=FBCH REINITIATE PRICER REJECTS
	;;^UTILITY(U,$J,"OPT",1306,10,15,0)
	;;=2323^
	;;^UTILITY(U,$J,"OPT",1306,10,15,"^")
	;;=FBCH OPEN ANCILLARY BATCH
	;;^UTILITY(U,$J,"OPT",1306,10,16,0)
	;;=4118
	;;^UTILITY(U,$J,"OPT",1306,10,16,"^")
	;;=FBAA BATCH DELETE
	;;^UTILITY(U,$J,"OPT",1306,99)
	;;=56204,45548
	;;^UTILITY(U,$J,"OPT",1306,"U")
	;;=BATCH MAIN MENU - CH
	;;^UTILITY(U,$J,"OPT",1307,0)
	;;=FBCH PRINT 7078^7078 Print^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1307,1,0)
	;;=^^1^1^2890207^
	;;^UTILITY(U,$J,"OPT",1307,1,1,0)
	;;=This option generates the 10-7078 (pinky).
	;;^UTILITY(U,$J,"OPT",1307,25)
	;;=FBCHP78
	;;^UTILITY(U,$J,"OPT",1307,"U")
	;;=7078 PRINT
	;;^UTILITY(U,$J,"OPT",1310,0)
	;;=FBCH INVOICE DISPLAY^Invoice Display^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1310,1,0)
	;;=^^2^2^2890208^
	;;^UTILITY(U,$J,"OPT",1310,1,1,0)
	;;=This option displays/prints a copy of an invoice.
	;;^UTILITY(U,$J,"OPT",1310,1,2,0)
	;;=The user is asked to enter an invoice number.
	;;^UTILITY(U,$J,"OPT",1310,25)
	;;=FBCHDI2
	;;^UTILITY(U,$J,"OPT",1310,"U")
	;;=INVOICE DISPLAY
	;;^UTILITY(U,$J,"OPT",1311,0)
	;;=FBCNH POST COMMITMENTS^Post Commitments for Obligation^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",1311,1,0)
	;;=^^5^5^2950130^^^^
	;;^UTILITY(U,$J,"OPT",1311,1,1,0)
	;;=Used to post commitments for Community Nursing Home obligation. The data
	;;^UTILITY(U,$J,"OPT",1311,1,2,0)
	;;=is based on previously entered VA FORM 10-7078 file entries.
	;;^UTILITY(U,$J,"OPT",1311,1,3,0)
	;;=This option passes data to the IFCAP system, specifically, the 1358 module.
	;;^UTILITY(U,$J,"OPT",1311,1,4,0)
	;;=This option can  only be used if the CNH program uses one control point and 
	;;^UTILITY(U,$J,"OPT",1311,1,5,0)
	;;=obligation per month.
	;;^UTILITY(U,$J,"OPT",1311,25)
	;;=FBNHPC
	;;^UTILITY(U,$J,"OPT",1311,"U")
	;;=POST COMMITMENTS FOR OBLIGATIO
	;;^UTILITY(U,$J,"OPT",1312,0)
	;;=FBCNH ESTIMATE FUNDS^Estimate Funds for Obligation^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",1312,1,0)
	;;=^^2^2^2930920^^^
	;;^UTILITY(U,$J,"OPT",1312,1,1,0)
	;;=Used to estimate funds needed in the future. Estimate is based on 

FBINI040
FBINI040	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",1312,1,2,0)
	;;=previously entered data in the VA FORM 10-7078 file.
	;;^UTILITY(U,$J,"OPT",1312,20)
	;;=S FBNHCC=1,(FBSEQ,FBOBN)="" D EN1^FBNHPC Q
	;;^UTILITY(U,$J,"OPT",1312,99)
	;;=55780,50178
	;;^UTILITY(U,$J,"OPT",1312,"U")
	;;=ESTIMATE FUNDS FOR OBLIGATION
	;;^UTILITY(U,$J,"OPT",2115,0)
	;;=FBAA FEE SCHEDULE^Fee Schedule Main Menu^^M^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",2115,1,0)
	;;=^^2^2^2900830^^
	;;^UTILITY(U,$J,"OPT",2115,1,1,0)
	;;=This menu contains all the options for the calculating
	;;^UTILITY(U,$J,"OPT",2115,1,2,0)
	;;=of the Fee Schedule.
	;;^UTILITY(U,$J,"OPT",2115,10,0)
	;;=^19.01PI^3^3
	;;^UTILITY(U,$J,"OPT",2115,10,1,0)
	;;=2118^
	;;^UTILITY(U,$J,"OPT",2115,10,1,"^")
	;;=FBAA EDIT SCHEDULE
	;;^UTILITY(U,$J,"OPT",2115,10,2,0)
	;;=2117^
	;;^UTILITY(U,$J,"OPT",2115,10,2,"^")
	;;=FBAA PRINT SCHEDULE
	;;^UTILITY(U,$J,"OPT",2115,10,3,0)
	;;=2116^
	;;^UTILITY(U,$J,"OPT",2115,10,3,"^")
	;;=FBAA CALCULATE SCHEDULE
	;;^UTILITY(U,$J,"OPT",2115,99)
	;;=56204,45105
	;;^UTILITY(U,$J,"OPT",2115,"U")
	;;=FEE SCHEDULE MAIN MENU
	;;^UTILITY(U,$J,"OPT",2116,0)
	;;=FBAA CALCULATE SCHEDULE^Compile Fee Schedule^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2116,1,0)
	;;=^^6^6^2890822^
	;;^UTILITY(U,$J,"OPT",2116,1,1,0)
	;;=This option will compile your Fee Schedule based on
	;;^UTILITY(U,$J,"OPT",2116,1,2,0)
	;;=a specified date range. In order to be effective at
	;;^UTILITY(U,$J,"OPT",2116,1,3,0)
	;;=least one year of data should be on line. Since this
	;;^UTILITY(U,$J,"OPT",2116,1,4,0)
	;;=option will go through the payment file for the
	;;^UTILITY(U,$J,"OPT",2116,1,5,0)
	;;=specified date range it should be a QUEUED output.
	;;^UTILITY(U,$J,"OPT",2116,1,6,0)
	;;=This option must be run yearly.
	;;^UTILITY(U,$J,"OPT",2116,25)
	;;=FBAAPAY
	;;^UTILITY(U,$J,"OPT",2116,"U")
	;;=COMPILE FEE SCHEDULE
	;;^UTILITY(U,$J,"OPT",2117,0)
	;;=FBAA PRINT SCHEDULE^Print Fee Schedule^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2117,1,0)
	;;=^^2^2^2890822^
	;;^UTILITY(U,$J,"OPT",2117,1,1,0)
	;;=An output report of the Fee Schedule for a specified
	;;^UTILITY(U,$J,"OPT",2117,1,2,0)
	;;=Fiscal year.
	;;^UTILITY(U,$J,"OPT",2117,25)
	;;=FBAASOUT
	;;^UTILITY(U,$J,"OPT",2117,"U")
	;;=PRINT FEE SCHEDULE
	;;^UTILITY(U,$J,"OPT",2118,0)
	;;=FBAA EDIT SCHEDULE^Add/Edit Fee Schedule^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2118,1,0)
	;;=^^3^3^2941222^^
	;;^UTILITY(U,$J,"OPT",2118,1,1,0)
	;;=This option can be used to enter a CPT code into
	;;^UTILITY(U,$J,"OPT",2118,1,2,0)
	;;=the Fee Schedule file for use as a default Amount
	;;^UTILITY(U,$J,"OPT",2118,1,3,0)
	;;=Paid in the Outpatient Medical program.
	;;^UTILITY(U,$J,"OPT",2118,25)
	;;=FBAAPAA
	;;^UTILITY(U,$J,"OPT",2118,"U")
	;;=ADD/EDIT FEE SCHEDULE
	;;^UTILITY(U,$J,"OPT",2250,0)
	;;=FBCNH OPEN BATCH^Open CNH Batch^^A^^^^^^^^FEE BASIS^y^1
	;;^UTILITY(U,$J,"OPT",2250,1,0)
	;;=^^1^1^2930517^^^
	;;^UTILITY(U,$J,"OPT",2250,1,1,0)
	;;=Used to open a Community Nursing Home Batch type.
	;;^UTILITY(U,$J,"OPT",2250,20)
	;;=D RCHNH^FBAAOB
	;;^UTILITY(U,$J,"OPT",2250,"U")
	;;=OPEN CNH BATCH
	;;^UTILITY(U,$J,"OPT",2251,0)
	;;=FBCNH MAIN MENU^Community Nursing Home Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2251,1,0)
	;;=^^1^1^2900515^^^^
	;;^UTILITY(U,$J,"OPT",2251,1,1,0)
	;;=Main Menu for Community Nursing Home options and menus.
	;;^UTILITY(U,$J,"OPT",2251,10,0)
	;;=^19.01PI^10^9
	;;^UTILITY(U,$J,"OPT",2251,10,1,0)
	;;=2280^^
	;;^UTILITY(U,$J,"OPT",2251,10,1,"^")
	;;=FBCNH BATCH MAIN MENU
	;;^UTILITY(U,$J,"OPT",2251,10,2,0)
	;;=2283^^
	;;^UTILITY(U,$J,"OPT",2251,10,2,"^")
	;;=FBCNH AUTHORIZATION MAIN MENU
	;;^UTILITY(U,$J,"OPT",2251,10,3,0)
	;;=2282^^
	;;^UTILITY(U,$J,"OPT",2251,10,3,"^")
	;;=FBCNH PAYMENT MAIN MENU
	;;^UTILITY(U,$J,"OPT",2251,10,4,0)
	;;=2284^^
	;;^UTILITY(U,$J,"OPT",2251,10,4,"^")
	;;=FBCNH FUND CONTROL MAIN MENU
	;;^UTILITY(U,$J,"OPT",2251,10,5,0)
	;;=2252^^
	;;^UTILITY(U,$J,"OPT",2251,10,5,"^")
	;;=FBCNH MOVEMENT MAIN MENU
	;;^UTILITY(U,$J,"OPT",2251,10,6,0)
	;;=2289^
	;;^UTILITY(U,$J,"OPT",2251,10,6,"^")
	;;=FBCNH OUTPUTS MAIN MENU
	;;^UTILITY(U,$J,"OPT",2251,10,8,0)
	;;=2308^

FBINI041
FBINI041	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2251,10,8,"^")
	;;=FBCNH VENDOR ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",2251,10,9,0)
	;;=1146
	;;^UTILITY(U,$J,"OPT",2251,10,9,"^")
	;;=FBAA QUEUE DATA FOR TRANS.
	;;^UTILITY(U,$J,"OPT",2251,10,10,0)
	;;=4125
	;;^UTILITY(U,$J,"OPT",2251,10,10,"^")
	;;=FBCNH UPDATE VENDOR CONTRACT
	;;^UTILITY(U,$J,"OPT",2251,99)
	;;=56238,42022
	;;^UTILITY(U,$J,"OPT",2251,"U")
	;;=COMMUNITY NURSING HOME MAIN ME
	;;^UTILITY(U,$J,"OPT",2252,0)
	;;=FBCNH MOVEMENT MAIN MENU^Movement Main Menu - CNH^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2252,1,0)
	;;=^^2^2^2900524^^^^
	;;^UTILITY(U,$J,"OPT",2252,1,1,0)
	;;=Menu containing the Admit, Transfer, and Discharge options for 
	;;^UTILITY(U,$J,"OPT",2252,1,2,0)
	;;=Community Nursing Home.
	;;^UTILITY(U,$J,"OPT",2252,10,0)
	;;=^19.01PI^6^6
	;;^UTILITY(U,$J,"OPT",2252,10,1,0)
	;;=2253^^
	;;^UTILITY(U,$J,"OPT",2252,10,1,"^")
	;;=FBCNH ADMIT
	;;^UTILITY(U,$J,"OPT",2252,10,2,0)
	;;=2254^^
	;;^UTILITY(U,$J,"OPT",2252,10,2,"^")
	;;=FBCNH TRANSFER
	;;^UTILITY(U,$J,"OPT",2252,10,3,0)
	;;=2255^^
	;;^UTILITY(U,$J,"OPT",2252,10,3,"^")
	;;=FBCNH DISCHARGE
	;;^UTILITY(U,$J,"OPT",2252,10,4,0)
	;;=2294^
	;;^UTILITY(U,$J,"OPT",2252,10,4,"^")
	;;=FBCNH EDIT MOVEMENT
	;;^UTILITY(U,$J,"OPT",2252,10,5,0)
	;;=2295^
	;;^UTILITY(U,$J,"OPT",2252,10,5,"^")
	;;=FBCNH DELETE MOVEMENT MENU
	;;^UTILITY(U,$J,"OPT",2252,10,6,0)
	;;=2290^
	;;^UTILITY(U,$J,"OPT",2252,10,6,"^")
	;;=FBCNH DISPLAY EPISODE OF CARE
	;;^UTILITY(U,$J,"OPT",2252,99)
	;;=56204,45137
	;;^UTILITY(U,$J,"OPT",2252,"U")
	;;=MOVEMENT MAIN MENU - CNH
	;;^UTILITY(U,$J,"OPT",2253,0)
	;;=FBCNH ADMIT^Admit To CNH^^R^^^^^^^^FEE BASIS^y
	;;^UTILITY(U,$J,"OPT",2253,1,0)
	;;=^^1^1^2900326^
	;;^UTILITY(U,$J,"OPT",2253,1,1,0)
	;;=Used to Admit a veteran to a Community Nursing Home.
	;;^UTILITY(U,$J,"OPT",2253,25)
	;;=FBNHEA
	;;^UTILITY(U,$J,"OPT",2253,"U")
	;;=ADMIT TO CNH
	;;^UTILITY(U,$J,"OPT",2254,0)
	;;=FBCNH TRANSFER^Transfer Movement^^R^^^^^^^^FEE BASIS^y
	;;^UTILITY(U,$J,"OPT",2254,1,0)
	;;=^^2^2^2900326^
	;;^UTILITY(U,$J,"OPT",2254,1,1,0)
	;;=Used to Transfer veteran from ASIH or to ASIH within the Community
	;;^UTILITY(U,$J,"OPT",2254,1,2,0)
	;;=Nursing Home program.
	;;^UTILITY(U,$J,"OPT",2254,25)
	;;=FBNHET
	;;^UTILITY(U,$J,"OPT",2254,"U")
	;;=TRANSFER MOVEMENT
	;;^UTILITY(U,$J,"OPT",2255,0)
	;;=FBCNH DISCHARGE^Discharge From CNH^^R^^^^^^^^FEE BASIS^y
	;;^UTILITY(U,$J,"OPT",2255,1,0)
	;;=^^1^1^2900425^^
	;;^UTILITY(U,$J,"OPT",2255,1,1,0)
	;;=Used to enter a Discharge from a Community Nursing Home.
	;;^UTILITY(U,$J,"OPT",2255,25)
	;;=FBNHED
	;;^UTILITY(U,$J,"OPT",2255,"U")
	;;=DISCHARGE FROM CNH
	;;^UTILITY(U,$J,"OPT",2256,0)
	;;=FBCNH ENTER AUTHORIZATION^Enter CNH Authorization^^R^^^^^^^^FEE BASIS^y
	;;^UTILITY(U,$J,"OPT",2256,1,0)
	;;=^^2^2^2900326^
	;;^UTILITY(U,$J,"OPT",2256,1,1,0)
	;;=Used to enter a new Community Nursing Home authorization only.  This
	;;^UTILITY(U,$J,"OPT",2256,1,2,0)
	;;=option cannot be used to edit a previously entered authorization.
	;;^UTILITY(U,$J,"OPT",2256,25)
	;;=FBNHEAUT
	;;^UTILITY(U,$J,"OPT",2256,99)
	;;=55816,53431
	;;^UTILITY(U,$J,"OPT",2256,"U")
	;;=ENTER CNH AUTHORIZATION
	;;^UTILITY(U,$J,"OPT",2257,0)
	;;=FBCNH ENTER PAYMENT^Enter CNH Payment^^R^^^^^^^^FEE BASIS^y
	;;^UTILITY(U,$J,"OPT",2257,1,0)
	;;=^^1^1^2900423^^
	;;^UTILITY(U,$J,"OPT",2257,1,1,0)
	;;=Used to enter a Community Nursing Home payment.
	;;^UTILITY(U,$J,"OPT",2257,25)
	;;=FBNHEP
	;;^UTILITY(U,$J,"OPT",2257,"U")
	;;=ENTER CNH PAYMENT
	;;^UTILITY(U,$J,"OPT",2259,0)
	;;=FBAA REQUEUE MRA^Re-Transmit MRA's^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",2259,1,0)
	;;=^^5^5^2900405^
	;;^UTILITY(U,$J,"OPT",2259,1,1,0)
	;;=This option can be used to retransmit already transmitted MRA's
	;;^UTILITY(U,$J,"OPT",2259,1,2,0)
	;;=for a specific date. Veteran and Vendor MRAs are kept on file
	;;^UTILITY(U,$J,"OPT",2259,1,3,0)
	;;=till the purge option is used to delete them. This option
	;;^UTILITY(U,$J,"OPT",2259,1,4,0)
	;;=would be used in instances when for some reason Austin did not
	;;^UTILITY(U,$J,"OPT",2259,1,5,0)
	;;=receive transmission.

FBINI042
FBINI042	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2259,25)
	;;=FBAARMRA
	;;^UTILITY(U,$J,"OPT",2259,"U")
	;;=RE-TRANSMIT MRA'S
	;;^UTILITY(U,$J,"OPT",2260,0)
	;;=FBAA MRA PURGE^Purge Transmitted MRAs^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",2260,1,0)
	;;=^^4^4^2930514^^^
	;;^UTILITY(U,$J,"OPT",2260,1,1,0)
	;;=This option should be used after it is known that Austin has
	;;^UTILITY(U,$J,"OPT",2260,1,2,0)
	;;=accepted your MRA transmissions. Once this option is run you
	;;^UTILITY(U,$J,"OPT",2260,1,3,0)
	;;=will not be able to re-transmit the purged MRAs.
	;;^UTILITY(U,$J,"OPT",2260,1,4,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",2260,25)
	;;=FBAAMPRG
	;;^UTILITY(U,$J,"OPT",2260,"U")
	;;=PURGE TRANSMITTED MRAS
	;;^UTILITY(U,$J,"OPT",2261,0)
	;;=FB MRA MAIN MENU^MRA Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2261,1,0)
	;;=^^1^1^2900405^^
	;;^UTILITY(U,$J,"OPT",2261,1,1,0)
	;;=MRA Main Menu containing all MRA options.
	;;^UTILITY(U,$J,"OPT",2261,10,0)
	;;=^19.01PI^4^4
	;;^UTILITY(U,$J,"OPT",2261,10,1,0)
	;;=862^^1
	;;^UTILITY(U,$J,"OPT",2261,10,1,"^")
	;;=FBAA VENDOR MRA MAIN MENU
	;;^UTILITY(U,$J,"OPT",2261,10,2,0)
	;;=1145^^2
	;;^UTILITY(U,$J,"OPT",2261,10,2,"^")
	;;=FBAA VETERAN MRA MAIN MENU
	;;^UTILITY(U,$J,"OPT",2261,10,3,0)
	;;=2259^^3
	;;^UTILITY(U,$J,"OPT",2261,10,3,"^")
	;;=FBAA REQUEUE MRA
	;;^UTILITY(U,$J,"OPT",2261,10,4,0)
	;;=2260^^4
	;;^UTILITY(U,$J,"OPT",2261,10,4,"^")
	;;=FBAA MRA PURGE
	;;^UTILITY(U,$J,"OPT",2261,99)
	;;=56204,45129
	;;^UTILITY(U,$J,"OPT",2261,"U")
	;;=MRA MAIN MENU
	;;^UTILITY(U,$J,"OPT",2262,0)
	;;=FBAA C&P ENTER PAYMENT^C&P/Multiple Patient Payment Entry^^R^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",2262,1,0)
	;;=^^1^1^2941026^^
	;;^UTILITY(U,$J,"OPT",2262,1,1,0)
	;;=Used to enter C&P payments.
	;;^UTILITY(U,$J,"OPT",2262,25)
	;;=FBAACP
	;;^UTILITY(U,$J,"OPT",2262,"U")
	;;=C&P/MULTIPLE PATIENT PAYMENT E
	;;^UTILITY(U,$J,"OPT",2276,0)
	;;=FBCH PRICER RELEASE^Pricer Batch Release^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2276,1,0)
	;;=^^3^3^2940711^^^^
	;;^UTILITY(U,$J,"OPT",2276,1,1,0)
	;;=This option is used by the supervisor to review payments
	;;^UTILITY(U,$J,"OPT",2276,1,2,0)
	;;=for contract hospital and mark them for transmission to the
	;;^UTILITY(U,$J,"OPT",2276,1,3,0)
	;;=Austin Pricer for grouping and price.
	;;^UTILITY(U,$J,"OPT",2276,25)
	;;=FBCHSCB
	;;^UTILITY(U,$J,"OPT",2276,"U")
	;;=PRICER BATCH RELEASE
	;;^UTILITY(U,$J,"OPT",2277,0)
	;;=FBCH COMPLETE PAYMENT^Complete a Payment^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2277,1,0)
	;;=^^4^4^2930517^^^^
	;;^UTILITY(U,$J,"OPT",2277,1,1,0)
	;;=This option is used to enter the amount paid for a contract hospital
	;;^UTILITY(U,$J,"OPT",2277,1,2,0)
	;;=bill received from the Austin pricer. The status of the batch must be
	;;^UTILITY(U,$J,"OPT",2277,1,3,0)
	;;=equal to "P" and the user must be the owner of the batch or hold the
	;;^UTILITY(U,$J,"OPT",2277,1,4,0)
	;;='FBAASUPERVISOR' security key in order to complete the batch.
	;;^UTILITY(U,$J,"OPT",2277,25)
	;;=FBCHEAP
	;;^UTILITY(U,$J,"OPT",2277,99)
	;;=55685,43203
	;;^UTILITY(U,$J,"OPT",2277,"U")
	;;=COMPLETE A PAYMENT
	;;^UTILITY(U,$J,"OPT",2279,0)
	;;=FBCNH EDIT AUTHORIZATION^Edit CNH Authorization^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2279,1,0)
	;;=^^1^1^2940803^^^
	;;^UTILITY(U,$J,"OPT",2279,1,1,0)
	;;=Used to edit a previously entered Community Nursing Home authorization.
	;;^UTILITY(U,$J,"OPT",2279,25)
	;;=FBNHEDAT
	;;^UTILITY(U,$J,"OPT",2279,"U")
	;;=EDIT CNH AUTHORIZATION
	;;^UTILITY(U,$J,"OPT",2280,0)
	;;=FBCNH BATCH MAIN MENU^Batch Main Menu - CNH^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2280,1,0)
	;;=^^1^1^2900425^^
	;;^UTILITY(U,$J,"OPT",2280,1,1,0)
	;;=Main Menu for Community Nursing Home Batch options.
	;;^UTILITY(U,$J,"OPT",2280,10,0)
	;;=^19.01PI^13^13
	;;^UTILITY(U,$J,"OPT",2280,10,1,0)
	;;=2250^^
	;;^UTILITY(U,$J,"OPT",2280,10,1,"^")
	;;=FBCNH OPEN BATCH
	;;^UTILITY(U,$J,"OPT",2280,10,2,0)
	;;=882^
	;;^UTILITY(U,$J,"OPT",2280,10,2,"^")
	;;=FBAA BATCH EDIT
	;;^UTILITY(U,$J,"OPT",2280,10,3,0)
	;;=454^
	;;^UTILITY(U,$J,"OPT",2280,10,3,"^")
	;;=FBAA CLOSE BATCH
	;;^UTILITY(U,$J,"OPT",2280,10,4,0)
	;;=455^

FBINI043
FBINI043	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2280,10,4,"^")
	;;=FBAA REOPEN BATCH
	;;^UTILITY(U,$J,"OPT",2280,10,5,0)
	;;=998^
	;;^UTILITY(U,$J,"OPT",2280,10,5,"^")
	;;=FBAA SUPERVISOR RELEASE
	;;^UTILITY(U,$J,"OPT",2280,10,6,0)
	;;=789^
	;;^UTILITY(U,$J,"OPT",2280,10,6,"^")
	;;=FBAA FINALIZE BATCH
	;;^UTILITY(U,$J,"OPT",2280,10,7,0)
	;;=792^
	;;^UTILITY(U,$J,"OPT",2280,10,7,"^")
	;;=FBAA REINITIATE REJECTS
	;;^UTILITY(U,$J,"OPT",2280,10,8,0)
	;;=790^
	;;^UTILITY(U,$J,"OPT",2280,10,8,"^")
	;;=FBAA VOUCHER DELETE REJECT
	;;^UTILITY(U,$J,"OPT",2280,10,9,0)
	;;=451^
	;;^UTILITY(U,$J,"OPT",2280,10,9,"^")
	;;=FBAA BATCH STATUS
	;;^UTILITY(U,$J,"OPT",2280,10,10,0)
	;;=453^
	;;^UTILITY(U,$J,"OPT",2280,10,10,"^")
	;;=FBAA LIST BATCH
	;;^UTILITY(U,$J,"OPT",2280,10,11,0)
	;;=4118
	;;^UTILITY(U,$J,"OPT",2280,10,11,"^")
	;;=FBAA BATCH DELETE
	;;^UTILITY(U,$J,"OPT",2280,10,12,0)
	;;=458
	;;^UTILITY(U,$J,"OPT",2280,10,12,"^")
	;;=FBAA DISPLAY OPEN BATCHES
	;;^UTILITY(U,$J,"OPT",2280,10,13,0)
	;;=459
	;;^UTILITY(U,$J,"OPT",2280,10,13,"^")
	;;=FBAA LIST CLOSED BATCHES
	;;^UTILITY(U,$J,"OPT",2280,99)
	;;=56204,45548
	;;^UTILITY(U,$J,"OPT",2280,"U")
	;;=BATCH MAIN MENU - CNH
	;;^UTILITY(U,$J,"OPT",2281,0)
	;;=FBCNH EDIT PAYMENT^Edit CNH Payment^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",2281,1,0)
	;;=^^1^1^2930308^^^^
	;;^UTILITY(U,$J,"OPT",2281,1,1,0)
	;;=Used to edit a previously entered Community Nursing Home payment.
	;;^UTILITY(U,$J,"OPT",2281,20)
	;;=D EDIT^FBNHEDPA
	;;^UTILITY(U,$J,"OPT",2281,"U")
	;;=EDIT CNH PAYMENT
	;;^UTILITY(U,$J,"OPT",2282,0)
	;;=FBCNH PAYMENT MAIN MENU^Payment Main Menu - CNH^^M^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",2282,1,0)
	;;=^^1^1^2900425^^
	;;^UTILITY(U,$J,"OPT",2282,1,1,0)
	;;=Main menu for Community Nursing Home payment options.
	;;^UTILITY(U,$J,"OPT",2282,10,0)
	;;=^19.01PI^3^3
	;;^UTILITY(U,$J,"OPT",2282,10,1,0)
	;;=2257^^
	;;^UTILITY(U,$J,"OPT",2282,10,1,"^")
	;;=FBCNH ENTER PAYMENT
	;;^UTILITY(U,$J,"OPT",2282,10,2,0)
	;;=2281^^
	;;^UTILITY(U,$J,"OPT",2282,10,2,"^")
	;;=FBCNH EDIT PAYMENT
	;;^UTILITY(U,$J,"OPT",2282,10,3,0)
	;;=3897
	;;^UTILITY(U,$J,"OPT",2282,10,3,"^")
	;;=FBCH DELETE INVOICE
	;;^UTILITY(U,$J,"OPT",2282,99)
	;;=56204,45487
	;;^UTILITY(U,$J,"OPT",2282,"U")
	;;=PAYMENT MAIN MENU - CNH
	;;^UTILITY(U,$J,"OPT",2283,0)
	;;=FBCNH AUTHORIZATION MAIN MENU^Authorization Main Menu - CNH^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2283,1,0)
	;;=^^1^1^2930614^^^^
	;;^UTILITY(U,$J,"OPT",2283,1,1,0)
	;;=Main menu for Community Nursing Home Authorization options.
	;;^UTILITY(U,$J,"OPT",2283,10,0)
	;;=^19.01PI^8^8
	;;^UTILITY(U,$J,"OPT",2283,10,1,0)
	;;=2256^^1
	;;^UTILITY(U,$J,"OPT",2283,10,1,"^")
	;;=FBCNH ENTER AUTHORIZATION
	;;^UTILITY(U,$J,"OPT",2283,10,2,0)
	;;=2279^^2
	;;^UTILITY(U,$J,"OPT",2283,10,2,"^")
	;;=FBCNH EDIT AUTHORIZATION
	;;^UTILITY(U,$J,"OPT",2283,10,3,0)
	;;=3899
	;;^UTILITY(U,$J,"OPT",2283,10,3,"^")
	;;=FBCNH DISPLAY 7078
	;;^UTILITY(U,$J,"OPT",2283,10,4,0)
	;;=3620
	;;^UTILITY(U,$J,"OPT",2283,10,4,"^")
	;;=FBCH PRINT CANCELLED 7078
	;;^UTILITY(U,$J,"OPT",2283,10,5,0)
	;;=4022
	;;^UTILITY(U,$J,"OPT",2283,10,5,"^")
	;;=FBCNH CANCEL 7078
	;;^UTILITY(U,$J,"OPT",2283,10,6,0)
	;;=4049
	;;^UTILITY(U,$J,"OPT",2283,10,6,"^")
	;;=FBCNH ENTER VETERAN RATES
	;;^UTILITY(U,$J,"OPT",2283,10,7,0)
	;;=4072
	;;^UTILITY(U,$J,"OPT",2283,10,7,"^")
	;;=FBCNH RATE CHANGE
	;;^UTILITY(U,$J,"OPT",2283,10,8,0)
	;;=4099
	;;^UTILITY(U,$J,"OPT",2283,10,8,"^")
	;;=FBCNH DELETE RATE
	;;^UTILITY(U,$J,"OPT",2283,99)
	;;=56204,45542
	;;^UTILITY(U,$J,"OPT",2283,"U")
	;;=AUTHORIZATION MAIN MENU - CNH
	;;^UTILITY(U,$J,"OPT",2284,0)
	;;=FBCNH FUND CONTROL MAIN MENU^Fee Fund Control Main Menu - CNH^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2284,1,0)
	;;=^^1^1^2900425^^
	;;^UTILITY(U,$J,"OPT",2284,1,1,0)
	;;=Fund Control main menu for Community Nursing Home options.
	;;^UTILITY(U,$J,"OPT",2284,10,0)
	;;=^19.01PI^2^2
	;;^UTILITY(U,$J,"OPT",2284,10,1,0)
	;;=1312^^
	;;^UTILITY(U,$J,"OPT",2284,10,1,"^")
	;;=FBCNH ESTIMATE FUNDS
	;;^UTILITY(U,$J,"OPT",2284,10,2,0)
	;;=1311^^
	;;^UTILITY(U,$J,"OPT",2284,10,2,"^")
	;;=FBCNH POST COMMITMENTS
	;;^UTILITY(U,$J,"OPT",2284,99)
	;;=56277,27635

FBINI044
FBINI044	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2284,"U")
	;;=FEE FUND CONTROL MAIN MENU - C
	;;^UTILITY(U,$J,"OPT",2285,0)
	;;=FBCH 7078 SETUP^Set-up a 7078^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2285,1,0)
	;;=^^2^2^2900425^
	;;^UTILITY(U,$J,"OPT",2285,1,1,0)
	;;=This option is used to set-up a 7078 Contract Hospital authorization.
	;;^UTILITY(U,$J,"OPT",2285,1,2,0)
	;;=There must be a "completed" request on file for this option.
	;;^UTILITY(U,$J,"OPT",2285,25)
	;;=FBCH78
	;;^UTILITY(U,$J,"OPT",2285,"U")
	;;=SET-UP A 7078
	;;^UTILITY(U,$J,"OPT",2289,0)
	;;=FBCNH OUTPUTS MAIN MENU^Output Main Menu - CNH^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2289,1,0)
	;;=^^1^1^2930504^^^^
	;;^UTILITY(U,$J,"OPT",2289,1,1,0)
	;;=Main menu for Community Nursing Home output options.
	;;^UTILITY(U,$J,"OPT",2289,10,0)
	;;=^19.01PI^25^18
	;;^UTILITY(U,$J,"OPT",2289,10,1,0)
	;;=1307^
	;;^UTILITY(U,$J,"OPT",2289,10,1,"^")
	;;=FBCH PRINT 7078
	;;^UTILITY(U,$J,"OPT",2289,10,3,0)
	;;=1310^
	;;^UTILITY(U,$J,"OPT",2289,10,3,"^")
	;;=FBCH INVOICE DISPLAY
	;;^UTILITY(U,$J,"OPT",2289,10,5,0)
	;;=791^
	;;^UTILITY(U,$J,"OPT",2289,10,5,"^")
	;;=FBAA REJECT PRINT
	;;^UTILITY(U,$J,"OPT",2289,10,9,0)
	;;=2290^
	;;^UTILITY(U,$J,"OPT",2289,10,9,"^")
	;;=FBCNH DISPLAY EPISODE OF CARE
	;;^UTILITY(U,$J,"OPT",2289,10,10,0)
	;;=2309^
	;;^UTILITY(U,$J,"OPT",2289,10,10,"^")
	;;=FBCNH PRINT ROSTER
	;;^UTILITY(U,$J,"OPT",2289,10,11,0)
	;;=2333^
	;;^UTILITY(U,$J,"OPT",2289,10,11,"^")
	;;=FBCNH LIST PAYMENT & TOTALS
	;;^UTILITY(U,$J,"OPT",2289,10,12,0)
	;;=2334^
	;;^UTILITY(U,$J,"OPT",2289,10,12,"^")
	;;=FBCNH EXPIRATION REPORT
	;;^UTILITY(U,$J,"OPT",2289,10,15,0)
	;;=2369^
	;;^UTILITY(U,$J,"OPT",2289,10,15,"^")
	;;=FBCNH AMIS
	;;^UTILITY(U,$J,"OPT",2289,10,16,0)
	;;=3921
	;;^UTILITY(U,$J,"OPT",2289,10,16,"^")
	;;=FBCNH COST REPORT
	;;^UTILITY(U,$J,"OPT",2289,10,17,0)
	;;=3923
	;;^UTILITY(U,$J,"OPT",2289,10,17,"^")
	;;=FBCNH CENSUS REPORT
	;;^UTILITY(U,$J,"OPT",2289,10,18,0)
	;;=3924
	;;^UTILITY(U,$J,"OPT",2289,10,18,"^")
	;;=FBCNH AMIE
	;;^UTILITY(U,$J,"OPT",2289,10,19,0)
	;;=4042
	;;^UTILITY(U,$J,"OPT",2289,10,19,"^")
	;;=FB PAY VENDOR
	;;^UTILITY(U,$J,"OPT",2289,10,20,0)
	;;=4043
	;;^UTILITY(U,$J,"OPT",2289,10,20,"^")
	;;=FB PAY VETERAN
	;;^UTILITY(U,$J,"OPT",2289,10,21,0)
	;;=3905
	;;^UTILITY(U,$J,"OPT",2289,10,21,"^")
	;;=FB PCR
	;;^UTILITY(U,$J,"OPT",2289,10,22,0)
	;;=4074
	;;^UTILITY(U,$J,"OPT",2289,10,22,"^")
	;;=FBCNH ACTIVITY REPORT
	;;^UTILITY(U,$J,"OPT",2289,10,23,0)
	;;=4097
	;;^UTILITY(U,$J,"OPT",2289,10,23,"^")
	;;=FBCNH ADMISSIONS > 90 DAYS
	;;^UTILITY(U,$J,"OPT",2289,10,24,0)
	;;=4607
	;;^UTILITY(U,$J,"OPT",2289,10,24,"^")
	;;=FB CHECK DISPLAY
	;;^UTILITY(U,$J,"OPT",2289,10,25,0)
	;;=4623
	;;^UTILITY(U,$J,"OPT",2289,10,25,"^")
	;;=FBCNH RCS 10-0168 REPORT
	;;^UTILITY(U,$J,"OPT",2289,99)
	;;=56204,45674
	;;^UTILITY(U,$J,"OPT",2289,"U")
	;;=OUTPUT MAIN MENU - CNH
	;;^UTILITY(U,$J,"OPT",2290,0)
	;;=FBCNH DISPLAY EPISODE OF CARE^Display Episode Of Care^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2290,1,0)
	;;=^^2^2^2900524^^
	;;^UTILITY(U,$J,"OPT",2290,1,1,0)
	;;=Displays Admission, transfers and discharge information for one
	;;^UTILITY(U,$J,"OPT",2290,1,2,0)
	;;=episode of care in a Community Nursing Home.
	;;^UTILITY(U,$J,"OPT",2290,25)
	;;=FBNHDIEP
	;;^UTILITY(U,$J,"OPT",2290,"U")
	;;=DISPLAY EPISODE OF CARE
	;;^UTILITY(U,$J,"OPT",2291,0)
	;;=FBCNH EDIT ADMISSION^Admission Edit^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2291,1,0)
	;;=^^1^1^2900426^
	;;^UTILITY(U,$J,"OPT",2291,1,1,0)
	;;=Used to edit admission data.
	;;^UTILITY(U,$J,"OPT",2291,25)
	;;=FBNHEDAD
	;;^UTILITY(U,$J,"OPT",2291,"U")
	;;=ADMISSION EDIT
	;;^UTILITY(U,$J,"OPT",2292,0)
	;;=FBCNH EDIT TRANSFER^Transfer Edit^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2292,1,0)
	;;=^^1^1^2930510^^
	;;^UTILITY(U,$J,"OPT",2292,1,1,0)
	;;=Edit Transfer in Fee Basis CNH Activity file.
	;;^UTILITY(U,$J,"OPT",2292,25)
	;;=FBNHEDTR
	;;^UTILITY(U,$J,"OPT",2292,"U")
	;;=TRANSFER EDIT
	;;^UTILITY(U,$J,"OPT",2293,0)
	;;=FBCNH EDIT DISCHARGE^Discharge Edit^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2293,1,0)
	;;=^^1^1^2930510^^
	;;^UTILITY(U,$J,"OPT",2293,1,1,0)
	;;=Used to edit discharge data in Fee Basis CNH Activity file.

FBINI045
FBINI045	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2293,25)
	;;=FBNHEDDI
	;;^UTILITY(U,$J,"OPT",2293,"U")
	;;=DISCHARGE EDIT
	;;^UTILITY(U,$J,"OPT",2294,0)
	;;=FBCNH EDIT MOVEMENT^Edit Movement Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2294,1,0)
	;;=^^1^1^2900426^
	;;^UTILITY(U,$J,"OPT",2294,1,1,0)
	;;=Main menu containing edit movement options.
	;;^UTILITY(U,$J,"OPT",2294,10,0)
	;;=^19.01PI^3^3
	;;^UTILITY(U,$J,"OPT",2294,10,1,0)
	;;=2291^
	;;^UTILITY(U,$J,"OPT",2294,10,1,"^")
	;;=FBCNH EDIT ADMISSION
	;;^UTILITY(U,$J,"OPT",2294,10,2,0)
	;;=2292^
	;;^UTILITY(U,$J,"OPT",2294,10,2,"^")
	;;=FBCNH EDIT TRANSFER
	;;^UTILITY(U,$J,"OPT",2294,10,3,0)
	;;=2293^
	;;^UTILITY(U,$J,"OPT",2294,10,3,"^")
	;;=FBCNH EDIT DISCHARGE
	;;^UTILITY(U,$J,"OPT",2294,99)
	;;=56204,45137
	;;^UTILITY(U,$J,"OPT",2294,"U")
	;;=EDIT MOVEMENT MENU
	;;^UTILITY(U,$J,"OPT",2295,0)
	;;=FBCNH DELETE MOVEMENT MENU^Delete Movement Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2295,1,0)
	;;=^^1^1^2941228^^^
	;;^UTILITY(U,$J,"OPT",2295,1,1,0)
	;;=Main menu for delete movement options.
	;;^UTILITY(U,$J,"OPT",2295,10,0)
	;;=^19.01PI^3^3
	;;^UTILITY(U,$J,"OPT",2295,10,1,0)
	;;=2296^
	;;^UTILITY(U,$J,"OPT",2295,10,1,"^")
	;;=FBCNH DELETE ADMISSION
	;;^UTILITY(U,$J,"OPT",2295,10,2,0)
	;;=2297^
	;;^UTILITY(U,$J,"OPT",2295,10,2,"^")
	;;=FBCNH DELETE TRANSFER
	;;^UTILITY(U,$J,"OPT",2295,10,3,0)
	;;=2298^
	;;^UTILITY(U,$J,"OPT",2295,10,3,"^")
	;;=FBCNH DELETE DISCHARGE
	;;^UTILITY(U,$J,"OPT",2295,99)
	;;=56204,45138
	;;^UTILITY(U,$J,"OPT",2295,"U")
	;;=DELETE MOVEMENT MENU
	;;^UTILITY(U,$J,"OPT",2296,0)
	;;=FBCNH DELETE ADMISSION^Admission Delete^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2296,1,0)
	;;=^^1^1^2900426^
	;;^UTILITY(U,$J,"OPT",2296,1,1,0)
	;;=Used to delete an admission.
	;;^UTILITY(U,$J,"OPT",2296,25)
	;;=FBNHDLAD
	;;^UTILITY(U,$J,"OPT",2296,"U")
	;;=ADMISSION DELETE
	;;^UTILITY(U,$J,"OPT",2297,0)
	;;=FBCNH DELETE TRANSFER^Transfer Delete^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2297,1,0)
	;;=^^1^1^2900426^
	;;^UTILITY(U,$J,"OPT",2297,1,1,0)
	;;=Used to delete a transfer movement.
	;;^UTILITY(U,$J,"OPT",2297,25)
	;;=FBNHDLTR
	;;^UTILITY(U,$J,"OPT",2297,"U")
	;;=TRANSFER DELETE
	;;^UTILITY(U,$J,"OPT",2298,0)
	;;=FBCNH DELETE DISCHARGE^Discharge Delete^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2298,1,0)
	;;=^^1^1^2900426^
	;;^UTILITY(U,$J,"OPT",2298,1,1,0)
	;;=Used to delete a discharge.
	;;^UTILITY(U,$J,"OPT",2298,25)
	;;=FBNHDLDI
	;;^UTILITY(U,$J,"OPT",2298,"U")
	;;=DISCHARGE DELETE
	;;^UTILITY(U,$J,"OPT",2303,0)
	;;=FBCH REINITIATE PRICER REJECTS^Re-initiate Pricer Rejected Items^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2303,1,0)
	;;=^^3^3^2930517^^^
	;;^UTILITY(U,$J,"OPT",2303,1,1,0)
	;;=This option is used to reinitiate rejects from the Austin
	;;^UTILITY(U,$J,"OPT",2303,1,2,0)
	;;=Pricer system. You will be given the opportunity to edit the
	;;^UTILITY(U,$J,"OPT",2303,1,3,0)
	;;=payment after reinitiating.
	;;^UTILITY(U,$J,"OPT",2303,25)
	;;=FBCHRR
	;;^UTILITY(U,$J,"OPT",2303,"U")
	;;=RE-INITIATE PRICER REJECTED IT
	;;^UTILITY(U,$J,"OPT",2304,0)
	;;=FBCH PRICER REJECTS^Pending Pricer Rejects^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2304,1,0)
	;;=^^1^1^2900501^
	;;^UTILITY(U,$J,"OPT",2304,1,1,0)
	;;=This option will print rejects pending from Austin Pricer.
	;;^UTILITY(U,$J,"OPT",2304,25)
	;;=FBCHRJP
	;;^UTILITY(U,$J,"OPT",2304,"U")
	;;=PENDING PRICER REJECTS
	;;^UTILITY(U,$J,"OPT",2305,0)
	;;=FBCH HOSPITAL ACTIVITY^Non-VA Hospital Activity Report^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2305,1,0)
	;;=^^2^2^2900503^
	;;^UTILITY(U,$J,"OPT",2305,1,1,0)
	;;=This option will generate the number of admissions, discharges,
	;;^UTILITY(U,$J,"OPT",2305,1,2,0)
	;;=patients remaining and number of days of care for Contract Hospital.
	;;^UTILITY(U,$J,"OPT",2305,25)
	;;=FBCHACT
	;;^UTILITY(U,$J,"OPT",2305,"U")
	;;=NON-VA HOSPITAL ACTIVITY REPOR
	;;^UTILITY(U,$J,"OPT",2306,0)
	;;=FBCH REQUEST STATS^Request Statistics^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2306,1,0)
	;;=^^2^2^2900504^
	;;^UTILITY(U,$J,"OPT",2306,1,1,0)
	;;=This option will generate the total number of requests, the number denied
	;;^UTILITY(U,$J,"OPT",2306,1,2,0)
	;;=and the number still pending for a date range.

FBINI046
FBINI046	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2306,25)
	;;=FBCHSTAT
	;;^UTILITY(U,$J,"OPT",2306,"U")
	;;=REQUEST STATISTICS
	;;^UTILITY(U,$J,"OPT",2308,0)
	;;=FBCNH VENDOR ENTER/EDIT^Vendor Enter/Edit^^R^^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",2308,1,0)
	;;=^^1^1^2900515^
	;;^UTILITY(U,$J,"OPT",2308,1,1,0)
	;;=Used to enter/edit Vendor demographics.
	;;^UTILITY(U,$J,"OPT",2308,15)
	;;=K FBEXDT,FBEXNDT
	;;^UTILITY(U,$J,"OPT",2308,25)
	;;=FBAAVD
	;;^UTILITY(U,$J,"OPT",2308,"U")
	;;=VENDOR ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",2309,0)
	;;=FBCNH PRINT ROSTER^Roster Print^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2309,1,0)
	;;=^^1^1^2900516^
	;;^UTILITY(U,$J,"OPT",2309,1,1,0)
	;;=Prints Roster of Nursing Homes and currently admitted Fee veterans.
	;;^UTILITY(U,$J,"OPT",2309,25)
	;;=FBNHROS
	;;^UTILITY(U,$J,"OPT",2309,"U")
	;;=ROSTER PRINT
	;;^UTILITY(U,$J,"OPT",2310,0)
	;;=FBCH ANCILLARY PAYMENT^Ancillary Contract Hosp/CNH Payment^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2310,1,0)
	;;=^^4^4^2900814^^^^
	;;^UTILITY(U,$J,"OPT",2310,1,1,0)
	;;=This option is used to enter payments for ancillary services
	;;^UTILITY(U,$J,"OPT",2310,1,2,0)
	;;=incurred while a contract hospital or community nursing home patient.
	;;^UTILITY(U,$J,"OPT",2310,1,3,0)
	;;=The option allows the selection of a MEDICAL batch ('B3')
	;;^UTILITY(U,$J,"OPT",2310,1,4,0)
	;;=and a Contract Hospital or Community Nursing Home authorization.
	;;^UTILITY(U,$J,"OPT",2310,25)
	;;=FBCHCO
	;;^UTILITY(U,$J,"OPT",2310,99)
	;;=55747,68179
	;;^UTILITY(U,$J,"OPT",2310,"U")
	;;=ANCILLARY CONTRACT HOSP/CNH PA
	;;^UTILITY(U,$J,"OPT",2323,0)
	;;=FBCH OPEN ANCILLARY BATCH^Open Ancillary Payment Batch^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2323,1,0)
	;;=^^2^2^2900814^^
	;;^UTILITY(U,$J,"OPT",2323,1,1,0)
	;;=This option is used to open a batch that is used for entering
	;;^UTILITY(U,$J,"OPT",2323,1,2,0)
	;;=ancillary payments associated with a contract hospital admission.
	;;^UTILITY(U,$J,"OPT",2323,25)
	;;=ANCOB^FBAAOB
	;;^UTILITY(U,$J,"OPT",2323,"U")
	;;=OPEN ANCILLARY PAYMENT BATCH
	;;^UTILITY(U,$J,"OPT",2325,0)
	;;=FBCH DELETE REQUEST^Delete Notification/Request^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2325,1,0)
	;;=^^4^4^2930823^^
	;;^UTILITY(U,$J,"OPT",2325,1,1,0)
	;;=This option allows you to delete a Request/Notification as long
	;;^UTILITY(U,$J,"OPT",2325,1,2,0)
	;;=as there is not a 7078 set up for the request. In order to delete the
	;;^UTILITY(U,$J,"OPT",2325,1,3,0)
	;;=request, you must either be the user who entered the request or be
	;;^UTILITY(U,$J,"OPT",2325,1,4,0)
	;;=the holder of the FBAASUPERVISOR security key.
	;;^UTILITY(U,$J,"OPT",2325,25)
	;;=FBCHDEL
	;;^UTILITY(U,$J,"OPT",2325,"U")
	;;=DELETE NOTIFICATION/REQUEST
	;;^UTILITY(U,$J,"OPT",2332,0)
	;;=FBCH PSA OUTPUT^PSA Output Report^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2332,1,0)
	;;=^^4^4^2900619^^^^
	;;^UTILITY(U,$J,"OPT",2332,1,1,0)
	;;=This report will allow you to generate a report by PSA for
	;;^UTILITY(U,$J,"OPT",2332,1,2,0)
	;;=Outpatient Medical, Pharmacy, Contract Hospital and Community Nursing
	;;^UTILITY(U,$J,"OPT",2332,1,3,0)
	;;=Home for a selected date range. This report will take a while
	;;^UTILITY(U,$J,"OPT",2332,1,4,0)
	;;=to compile and should be queued to an output device.
	;;^UTILITY(U,$J,"OPT",2332,25)
	;;=FBCHPSA
	;;^UTILITY(U,$J,"OPT",2332,"U")
	;;=PSA OUTPUT REPORT
	;;^UTILITY(U,$J,"OPT",2333,0)
	;;=FBCNH LIST PAYMENT & TOTALS^Payment & Totals Report - CNH^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2333,1,0)
	;;=^^3^3^2900821^^
	;;^UTILITY(U,$J,"OPT",2333,1,1,0)
	;;=Prints payments and totals for Community Nursing Homes for the month 
	;;^UTILITY(U,$J,"OPT",2333,1,2,0)
	;;=selected. This report may take time to compile and print. Queuing
	;;^UTILITY(U,$J,"OPT",2333,1,3,0)
	;;=is recommended.
	;;^UTILITY(U,$J,"OPT",2333,25)
	;;=FBNHPLT
	;;^UTILITY(U,$J,"OPT",2333,"U")
	;;=PAYMENT & TOTALS REPORT - CNH
	;;^UTILITY(U,$J,"OPT",2334,0)
	;;=FBCNH EXPIRATION REPORT^Contract Expiration List^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2334,1,0)
	;;=^^2^2^2930310^^
	;;^UTILITY(U,$J,"OPT",2334,1,1,0)
	;;=Prints report of Nursing Homes with contracts expiring within a user

FBINI047
FBINI047	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2334,1,2,0)
	;;=specified date range.
	;;^UTILITY(U,$J,"OPT",2334,25)
	;;=FBNHEXP
	;;^UTILITY(U,$J,"OPT",2334,"U")
	;;=CONTRACT EXPIRATION LIST
	;;^UTILITY(U,$J,"OPT",2361,0)
	;;=FBCH EDIT ANCILLARY PAYMENT^Edit Ancillary Payment^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2361,1,0)
	;;=^^1^1^2930315^^^
	;;^UTILITY(U,$J,"OPT",2361,1,1,0)
	;;=This is an edit payment option for ancillary payments.
	;;^UTILITY(U,$J,"OPT",2361,25)
	;;=FBCHPET
	;;^UTILITY(U,$J,"OPT",2361,"U")
	;;=EDIT ANCILLARY PAYMENT
	;;^UTILITY(U,$J,"OPT",2362,0)
	;;=FBCH PRINT REPORT OF CONTACT^Print Report of Contact - CH^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2362,1,0)
	;;=^^2^2^2900817^
	;;^UTILITY(U,$J,"OPT",2362,1,1,0)
	;;=This option is used to print a report of contact for
	;;^UTILITY(U,$J,"OPT",2362,1,2,0)
	;;=Contract hospital.
	;;^UTILITY(U,$J,"OPT",2362,25)
	;;=FBCHPRC
	;;^UTILITY(U,$J,"OPT",2362,"U")
	;;=PRINT REPORT OF CONTACT - CH
	;;^UTILITY(U,$J,"OPT",2363,0)
	;;=FBCH UPDATE REPORT OF CONTACT^Update Report of Contact - CH^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2363,1,0)
	;;=^^2^2^2900817^
	;;^UTILITY(U,$J,"OPT",2363,1,1,0)
	;;=This option allows a user to enter an update to the
	;;^UTILITY(U,$J,"OPT",2363,1,2,0)
	;;=initial notification.
	;;^UTILITY(U,$J,"OPT",2363,25)
	;;=ADD^FBCHROC
	;;^UTILITY(U,$J,"OPT",2363,99)
	;;=55644,52228
	;;^UTILITY(U,$J,"OPT",2363,"U")
	;;=UPDATE REPORT OF CONTACT - CH
	;;^UTILITY(U,$J,"OPT",2364,0)
	;;=FBCH EDIT REPORT OF CONTACT^Edit Report of Contact - CH^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2364,1,0)
	;;=^^3^3^2901018^^^
	;;^UTILITY(U,$J,"OPT",2364,1,1,0)
	;;=This option allows you to edit demographic data of
	;;^UTILITY(U,$J,"OPT",2364,1,2,0)
	;;=the contact person, insurance information, mode of
	;;^UTILITY(U,$J,"OPT",2364,1,3,0)
	;;=transportation, approving official and narrative text.
	;;^UTILITY(U,$J,"OPT",2364,25)
	;;=EDIT^FBCHROC
	;;^UTILITY(U,$J,"OPT",2364,"U")
	;;=EDIT REPORT OF CONTACT - CH
	;;^UTILITY(U,$J,"OPT",2365,0)
	;;=FBAA OPEN PHARMACY BATCH^Open a Pharmacy Batch^^A^^^^^^^^^^1^1
	;;^UTILITY(U,$J,"OPT",2365,1,0)
	;;=^^2^2^2930517^^
	;;^UTILITY(U,$J,"OPT",2365,1,1,0)
	;;=This option is on the Pharmacy batch menu, and allows the user to
	;;^UTILITY(U,$J,"OPT",2365,1,2,0)
	;;=open pharmacy batches only.
	;;^UTILITY(U,$J,"OPT",2365,15)
	;;=K FBPHOPT
	;;^UTILITY(U,$J,"OPT",2365,20)
	;;=S FBPHOPT=1 D RPHARM^FBAAOB
	;;^UTILITY(U,$J,"OPT",2365,25)
	;;=
	;;^UTILITY(U,$J,"OPT",2365,"U")
	;;=OPEN A PHARMACY BATCH
	;;^UTILITY(U,$J,"OPT",2366,0)
	;;=FBAA PHARMACY BATCH OPTIONS^Batch Menu - Pharmacy^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2366,1,0)
	;;=^^3^3^2900820^
	;;^UTILITY(U,$J,"OPT",2366,1,1,0)
	;;=This menu contains options to open, close, list, reopen, display, edit,
	;;^UTILITY(U,$J,"OPT",2366,1,2,0)
	;;=list and check status of a batch. It eliminates the need to go to
	;;^UTILITY(U,$J,"OPT",2366,1,3,0)
	;;=the medical main menu to exercise batch options.
	;;^UTILITY(U,$J,"OPT",2366,10,0)
	;;=^19.01PI^9^9
	;;^UTILITY(U,$J,"OPT",2366,10,1,0)
	;;=2365^
	;;^UTILITY(U,$J,"OPT",2366,10,1,"^")
	;;=FBAA OPEN PHARMACY BATCH
	;;^UTILITY(U,$J,"OPT",2366,10,2,0)
	;;=454^
	;;^UTILITY(U,$J,"OPT",2366,10,2,"^")
	;;=FBAA CLOSE BATCH
	;;^UTILITY(U,$J,"OPT",2366,10,3,0)
	;;=458^
	;;^UTILITY(U,$J,"OPT",2366,10,3,"^")
	;;=FBAA DISPLAY OPEN BATCHES
	;;^UTILITY(U,$J,"OPT",2366,10,4,0)
	;;=882^
	;;^UTILITY(U,$J,"OPT",2366,10,4,"^")
	;;=FBAA BATCH EDIT
	;;^UTILITY(U,$J,"OPT",2366,10,5,0)
	;;=453^
	;;^UTILITY(U,$J,"OPT",2366,10,5,"^")
	;;=FBAA LIST BATCH
	;;^UTILITY(U,$J,"OPT",2366,10,6,0)
	;;=455^
	;;^UTILITY(U,$J,"OPT",2366,10,6,"^")
	;;=FBAA REOPEN BATCH
	;;^UTILITY(U,$J,"OPT",2366,10,7,0)
	;;=451^
	;;^UTILITY(U,$J,"OPT",2366,10,7,"^")
	;;=FBAA BATCH STATUS
	;;^UTILITY(U,$J,"OPT",2366,10,8,0)
	;;=998
	;;^UTILITY(U,$J,"OPT",2366,10,8,"^")
	;;=FBAA SUPERVISOR RELEASE
	;;^UTILITY(U,$J,"OPT",2366,10,9,0)
	;;=4118
	;;^UTILITY(U,$J,"OPT",2366,10,9,"^")
	;;=FBAA BATCH DELETE
	;;^UTILITY(U,$J,"OPT",2366,99)
	;;=56204,45548
	;;^UTILITY(U,$J,"OPT",2366,"U")
	;;=BATCH MENU - PHARMACY
	;;^UTILITY(U,$J,"OPT",2369,0)
	;;=FBCNH AMIS^AMIS 349 Print^^R^^^^^^^^

FBINI048
FBINI048	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",2369,1,0)
	;;=^^1^1^2900904^
	;;^UTILITY(U,$J,"OPT",2369,1,1,0)
	;;=Calculates and prints AMIS 349.
	;;^UTILITY(U,$J,"OPT",2369,25)
	;;=FBNHAMIS
	;;^UTILITY(U,$J,"OPT",2369,"U")
	;;=AMIS 349 PRINT
	;;^UTILITY(U,$J,"OPT",2370,0)
	;;=FBCH EDIT REQUEST^Notification/Request Edit^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",2370,1,0)
	;;=^^2^2^2900904^
	;;^UTILITY(U,$J,"OPT",2370,1,1,0)
	;;=This option allows the user to edit a request that has not been
	;;^UTILITY(U,$J,"OPT",2370,1,2,0)
	;;=completed.
	;;^UTILITY(U,$J,"OPT",2370,25)
	;;=EDIT^FBCHREQ1
	;;^UTILITY(U,$J,"OPT",2370,99)
	;;=55747,71171
	;;^UTILITY(U,$J,"OPT",2370,"U")
	;;=NOTIFICATION/REQUEST EDIT
	;;^UTILITY(U,$J,"OPT",3590,0)
	;;=FBCH GENERIC PRICER^Generic Pricer Interface^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",3590,1,0)
	;;=^^6^6^2930510^^
	;;^UTILITY(U,$J,"OPT",3590,1,1,0)
	;;=This option may be used to send a case to the NVHS Pricer system in
	;;^UTILITY(U,$J,"OPT",3590,1,2,0)
	;;=Austin.  The option does not require the patient to be in the
	;;^UTILITY(U,$J,"OPT",3590,1,3,0)
	;;=Patient file.  The same is true for the vendor.  The data that is sent
	;;^UTILITY(U,$J,"OPT",3590,1,4,0)
	;;=using this option will not be stored in the pricer database.  Cases can
	;;^UTILITY(U,$J,"OPT",3590,1,5,0)
	;;=be resubmitted.  The intent of this option is to help eliminate any
	;;^UTILITY(U,$J,"OPT",3590,1,6,0)
	;;=need for the use of FALCON.
	;;^UTILITY(U,$J,"OPT",3590,25)
	;;=FBPRICE
	;;^UTILITY(U,$J,"OPT",3590,"U")
	;;=GENERIC PRICER INTERFACE
	;;^UTILITY(U,$J,"OPT",3596,0)
	;;=FBAA BATCH RANGE^Batch status for a Range of Batches^^P^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",3596,1,0)
	;;=^^2^2^2920917^^^^
	;;^UTILITY(U,$J,"OPT",3596,1,1,0)
	;;=This option will allow a user to enter a range of batches and list
	;;^UTILITY(U,$J,"OPT",3596,1,2,0)
	;;=the current status as well as obligation number, Fee Program.
	;;^UTILITY(U,$J,"OPT",3596,20)
	;;=W !!,"ENTER BATCH NUMBER RANGE:",!,"---------------------------"
	;;^UTILITY(U,$J,"OPT",3596,60)
	;;=FBAA(161.7,
	;;^UTILITY(U,$J,"OPT",3596,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",3596,63)
	;;=[FB BATCH LIST]
	;;^UTILITY(U,$J,"OPT",3596,64)
	;;=[FB BATCH LIST]
	;;^UTILITY(U,$J,"OPT",3596,"U")
	;;=BATCH STATUS FOR A RANGE OF BA
	;;^UTILITY(U,$J,"OPT",3600,0)
	;;=FBAA LIST PENDING RX^Prescriptions Pending Pharmacy Review^^P^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",3600,1,0)
	;;=^^4^4^2920827^
	;;^UTILITY(U,$J,"OPT",3600,1,1,0)
	;;=This option will allow Pharmacy to print the prescriptions that are
	;;^UTILITY(U,$J,"OPT",3600,1,2,0)
	;;=pending their review.  This will give them the ability to look at
	;;^UTILITY(U,$J,"OPT",3600,1,3,0)
	;;=their Pharmacy profile and check for prescriptions dispensed by their
	;;^UTILITY(U,$J,"OPT",3600,1,4,0)
	;;=Pharmacy Service.
	;;^UTILITY(U,$J,"OPT",3600,60)
	;;=FBAA(162.1,
	;;^UTILITY(U,$J,"OPT",3600,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",3600,63)
	;;=[FBAA RX PENDING]
	;;^UTILITY(U,$J,"OPT",3600,64)
	;;=[FBAA RX PENDING]
	;;^UTILITY(U,$J,"OPT",3600,99)
	;;=55770,47545
	;;^UTILITY(U,$J,"OPT",3600,"U")
	;;=PRESCRIPTIONS PENDING PHARMACY
	;;^UTILITY(U,$J,"OPT",3603,0)
	;;=FBCH REOPEN REQUEST^Reconsider a Denied Request^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",3603,1,0)
	;;=^^3^3^2930514^^^^
	;;^UTILITY(U,$J,"OPT",3603,1,1,0)
	;;=This option is restricted to the holder of the 'FBAASUPERVISOR' key.
	;;^UTILITY(U,$J,"OPT",3603,1,2,0)
	;;=It allows the supervisor to reconsider a previously denied request.
	;;^UTILITY(U,$J,"OPT",3603,1,3,0)
	;;=There is an audit on the Legal and Medical Entitlement fields.
	;;^UTILITY(U,$J,"OPT",3603,25)
	;;=FBCHREQ2
	;;^UTILITY(U,$J,"OPT",3603,"U")
	;;=RECONSIDER A DENIED REQUEST
	;;^UTILITY(U,$J,"OPT",3604,0)
	;;=FBCH PRINT REQUEST AUDIT^Print Entitlement Audit^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",3604,1,0)
	;;=^^2^2^2930514^^
	;;^UTILITY(U,$J,"OPT",3604,1,1,0)
	;;=This option allows the FEE Supervisor to print out the audit of
	;;^UTILITY(U,$J,"OPT",3604,1,2,0)
	;;=requests previously denied that have been reconsidered.
	;;^UTILITY(U,$J,"OPT",3604,25)
	;;=DISPLAY^FBCHREQ2

FBINI049
FBINI049	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",3604,"U")
	;;=PRINT ENTITLEMENT AUDIT
	;;^UTILITY(U,$J,"OPT",3605,0)
	;;=FBCH PENDING REQUEST^Requests Pending Entitlement^^P^^^^^^^^
	;;^UTILITY(U,$J,"OPT",3605,1,0)
	;;=^^2^2^2930315^^^
	;;^UTILITY(U,$J,"OPT",3605,1,1,0)
	;;=This option will allow the user to generate a list of requests/notifications
	;;^UTILITY(U,$J,"OPT",3605,1,2,0)
	;;=that are still pending legal or medical entitlement.
	;;^UTILITY(U,$J,"OPT",3605,60)
	;;=FBAA(162.2,
	;;^UTILITY(U,$J,"OPT",3605,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",3605,63)
	;;=[FBCH PENDING REQUEST]
	;;^UTILITY(U,$J,"OPT",3605,64)
	;;=[FBCH PENDING REQUEST]
	;;^UTILITY(U,$J,"OPT",3605,"U")
	;;=REQUESTS PENDING ENTITLEMENT
	;;^UTILITY(U,$J,"OPT",3606,0)
	;;=FBCH CANCEL 7078^Cancel 7078 Entered in Error^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",3606,1,0)
	;;=^^3^3^2920924^
	;;^UTILITY(U,$J,"OPT",3606,1,1,0)
	;;=This option, restricted to the holder of a Fee Supervisor, will cancel
	;;^UTILITY(U,$J,"OPT",3606,1,2,0)
	;;=a 7078 that was entered in error.  When used, the estimated dollars
	;;^UTILITY(U,$J,"OPT",3606,1,3,0)
	;;=will be freed up on the 1358.
	;;^UTILITY(U,$J,"OPT",3606,25)
	;;=FBCHC78
	;;^UTILITY(U,$J,"OPT",3606,"U")
	;;=CANCEL 7078 ENTERED IN ERROR
	;;^UTILITY(U,$J,"OPT",3620,0)
	;;=FBCH PRINT CANCELLED 7078^Print List of Cancelled 7078^^P^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",3620,1,0)
	;;=^^2^2^2930518^^^
	;;^UTILITY(U,$J,"OPT",3620,1,1,0)
	;;=This option will print out those 7078s
	;;^UTILITY(U,$J,"OPT",3620,1,2,0)
	;;=cancelled by a holder of the FBAASUPERVISOR key.
	;;^UTILITY(U,$J,"OPT",3620,60)
	;;=FB7078(
	;;^UTILITY(U,$J,"OPT",3620,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",3620,63)
	;;=[FBCH 7078 CANCEL]
	;;^UTILITY(U,$J,"OPT",3620,64)
	;;=[FBCH 7078 CANCEL]
	;;^UTILITY(U,$J,"OPT",3620,99)
	;;=55644,54057
	;;^UTILITY(U,$J,"OPT",3620,"U")
	;;=PRINT LIST OF CANCELLED 7078
	;;^UTILITY(U,$J,"OPT",3621,0)
	;;=FBCH REIMBURSEMENT INVOICE^Reimbursement for Inpatient Hospital Invoice^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",3621,1,0)
	;;=^^5^5^2921013^
	;;^UTILITY(U,$J,"OPT",3621,1,1,0)
	;;=This option is used to enter a patient reimbursement for an inpatient
	;;^UTILITY(U,$J,"OPT",3621,1,2,0)
	;;=hospital stay.
	;;^UTILITY(U,$J,"OPT",3621,1,3,0)
	;;=The payment will be sent through the Austin Pricer just like a direct
	;;^UTILITY(U,$J,"OPT",3621,1,4,0)
	;;=vendor invoice and the patient is reimbursed the same as 
	;;^UTILITY(U,$J,"OPT",3621,1,5,0)
	;;=the private facility.
	;;^UTILITY(U,$J,"OPT",3621,25)
	;;=PRBT^FBCHEP
	;;^UTILITY(U,$J,"OPT",3621,"U")
	;;=REIMBURSEMENT FOR INPATIENT HO
	;;^UTILITY(U,$J,"OPT",3897,0)
	;;=FBCH DELETE INVOICE^Delete Inpatient Invoice^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",3897,1,0)
	;;=^^2^2^2930113^
	;;^UTILITY(U,$J,"OPT",3897,1,1,0)
	;;=This option will allow a user to delete an invoice entered in error.
	;;^UTILITY(U,$J,"OPT",3897,1,2,0)
	;;=The invoice must be in a batch that has not been released for payment.
	;;^UTILITY(U,$J,"OPT",3897,25)
	;;=FBCHDIN
	;;^UTILITY(U,$J,"OPT",3897,"U")
	;;=DELETE INPATIENT INVOICE
	;;^UTILITY(U,$J,"OPT",3899,0)
	;;=FBCNH DISPLAY 7078^Display 7078/Authorization - CNH^^A^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",3899,1,0)
	;;=^^1^1^2930120^
	;;^UTILITY(U,$J,"OPT",3899,1,1,0)
	;;=This option will display 7078s for the CNH program.
	;;^UTILITY(U,$J,"OPT",3899,20)
	;;=S DIC("S")="I $P(^(0),U,11)=7" D OUTP^FBCH78
	;;^UTILITY(U,$J,"OPT",3899,"U")
	;;=DISPLAY 7078/AUTHORIZATION - C
	;;^UTILITY(U,$J,"OPT",3903,0)
	;;=FBCH ANCILLARY REIMBURSEMENT^Patient Reimbursement for Ancillary Services^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",3903,1,0)
	;;=^^2^2^2930202^
	;;^UTILITY(U,$J,"OPT",3903,1,1,0)
	;;=This option is used to reimburse a patient for ancillary services
	;;^UTILITY(U,$J,"OPT",3903,1,2,0)
	;;=paid for by the patient.  
	;;^UTILITY(U,$J,"OPT",3903,25)
	;;=PRBT^FBCHCO
	;;^UTILITY(U,$J,"OPT",3903,"U")
	;;=PATIENT REIMBURSEMENT FOR ANCI
	;;^UTILITY(U,$J,"OPT",3905,0)
	;;=FB PCR^Potential Cost Recovery Report^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",3905,1,0)
	;;=44^^45^45^2930628^^^^
	;;^UTILITY(U,$J,"OPT",3905,1,1,0)
	;;=This option is intended to identify costs for fee services which may be

FBINI04A
FBINI04A	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",3905,1,2,0)
	;;=able to be recovered.
	;;^UTILITY(U,$J,"OPT",3905,1,3,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",3905,1,4,0)
	;;=The user selects the primary service facility(s) and date range.  All
	;;^UTILITY(U,$J,"OPT",3905,1,5,0)
	;;=active fee programs are reviewed for the selected search criteria. 
	;;^UTILITY(U,$J,"OPT",3905,1,6,0)
	;;=The data is sorted by division, patient, fee program, and vendor and date.
	;;^UTILITY(U,$J,"OPT",3905,1,7,0)
	;;=The data displayed/printed is similar to the payment outputs, only for
	;;^UTILITY(U,$J,"OPT",3905,1,8,0)
	;;=patients that are means test category C/agree to pay deductible or
	;;^UTILITY(U,$J,"OPT",3905,1,9,0)
	;;=for non-service connected treatment.  Insurance information is also
	;;^UTILITY(U,$J,"OPT",3905,1,10,0)
	;;=displayed/printed.
	;;^UTILITY(U,$J,"OPT",3905,1,11,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",3905,1,12,0)
	;;= Outpatient program (FBPCR2) - uses date finalized for date range sort.
	;;^UTILITY(U,$J,"OPT",3905,1,13,0)
	;;=   o  For each service on a treatment date, the value of the 
	;;^UTILITY(U,$J,"OPT",3905,1,14,0)
	;;=      SERVICE CONNECTED Y/N field is checked.  If set to no, the
	;;^UTILITY(U,$J,"OPT",3905,1,15,0)
	;;=      flag to collect from insurance is set.
	;;^UTILITY(U,$J,"OPT",3905,1,16,0)
	;;=   o  Check is also made if patient was Cat C and agreed to pay deductible
	;;^UTILITY(U,$J,"OPT",3905,1,17,0)
	;;=      on INITIAL TREATMENT DATE.  If true, flag to collect from patient is set.
	;;^UTILITY(U,$J,"OPT",3905,1,18,0)
	;;=   o  If service is for C&P, or both of the above two flags are negative,
	;;^UTILITY(U,$J,"OPT",3905,1,19,0)
	;;=      the record is bypassed.
	;;^UTILITY(U,$J,"OPT",3905,1,20,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",3905,1,21,0)
	;;= Pharmacy program (FBPCR3) - uses date certified for payment for date range
	;;^UTILITY(U,$J,"OPT",3905,1,22,0)
	;;=                              sort.
	;;^UTILITY(U,$J,"OPT",3905,1,23,0)
	;;=   o  For each invoice number, RX number for a patient within the specified
	;;^UTILITY(U,$J,"OPT",3905,1,24,0)
	;;=      date range, the value of the DATE PRESCRIPTION FILLED field is obtained
	;;^UTILITY(U,$J,"OPT",3905,1,25,0)
	;;=      and checked against the authorization in the FEE BASIS PATIENT file.
	;;^UTILITY(U,$J,"OPT",3905,1,26,0)
	;;=      A check is made to see if the value of the POTENTIAL COST RECOVERY
	;;^UTILITY(U,$J,"OPT",3905,1,27,0)
	;;=      field is yes for an authorization which encompasses the RX FILL DATE.
	;;^UTILITY(U,$J,"OPT",3905,1,28,0)
	;;=      If yes, flag to collect from insurance is set.
	;;^UTILITY(U,$J,"OPT",3905,1,29,0)
	;;=   o  Check is also made if patient was Cat C and agreed to pay deductible
	;;^UTILITY(U,$J,"OPT",3905,1,30,0)
	;;=      on DATE PRESCRIPTION FILLED and agreed to pay deductible.
	;;^UTILITY(U,$J,"OPT",3905,1,31,0)
	;;=      If true, flag to collect from patient is set.
	;;^UTILITY(U,$J,"OPT",3905,1,32,0)
	;;=   o  If both of the above two flags are negative, record is bypassed.
	;;^UTILITY(U,$J,"OPT",3905,1,33,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",3905,1,34,0)
	;;= CH/CNH program (FBPCR67*) - uses date finalized for date range sort
	;;^UTILITY(U,$J,"OPT",3905,1,35,0)
	;;=   o  For each record, for a patient within the specified date range,
	;;^UTILITY(U,$J,"OPT",3905,1,36,0)
	;;=      the value of the TREATMENT FROM date is obtained and checked
	;;^UTILITY(U,$J,"OPT",3905,1,37,0)
	;;=      against the authorization in the FEE BASIS PATIENT file.
	;;^UTILITY(U,$J,"OPT",3905,1,38,0)
	;;=      A check is made to see if the value of the POTENTIAL COST RECOVERY
	;;^UTILITY(U,$J,"OPT",3905,1,39,0)
	;;=      field is set to yes for an authorization which encompasses the
	;;^UTILITY(U,$J,"OPT",3905,1,40,0)
	;;=      TREATMENT FROM DATE.  If yes, flag to collect from insurance is set.
	;;^UTILITY(U,$J,"OPT",3905,1,41,0)
	;;=   o  Check is also made if patient was Cat C and agreed to pay deductible
	;;^UTILITY(U,$J,"OPT",3905,1,42,0)
	;;=      on TREATMENT FROM DATE (and TREATMENT TO DATE, if flag is not set).

FBINI04B
FBINI04B	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",3905,1,43,0)
	;;=      If true anytime during the date range, flag to collect from patient
	;;^UTILITY(U,$J,"OPT",3905,1,44,0)
	;;=      is set.
	;;^UTILITY(U,$J,"OPT",3905,1,45,0)
	;;=   o  If both of the above two flags are negative, record is bypassed.
	;;^UTILITY(U,$J,"OPT",3905,2)
	;;=y
	;;^UTILITY(U,$J,"OPT",3905,25)
	;;=FBPCR
	;;^UTILITY(U,$J,"OPT",3905,99)
	;;=55612,50918
	;;^UTILITY(U,$J,"OPT",3905,"U")
	;;=POTENTIAL COST RECOVERY REPORT
	;;^UTILITY(U,$J,"OPT",3920,0)
	;;=FBCH COST REPORT^Cost Report for Civil Hospital^^R^^^^^^^^FEE BASIS^^1
	;;^UTILITY(U,$J,"OPT",3920,1,0)
	;;=^^2^2^2940127^^
	;;^UTILITY(U,$J,"OPT",3920,1,1,0)
	;;=Cost report for Civil Hospital sorted by Patient Type Code.  Outputs total
	;;^UTILITY(U,$J,"OPT",3920,1,2,0)
	;;=cases, average amount paid and average length of stay on total report.
	;;^UTILITY(U,$J,"OPT",3920,20)
	;;=S FBTP=6,FBREF="FB7078"
	;;^UTILITY(U,$J,"OPT",3920,25)
	;;=FBCHCR
	;;^UTILITY(U,$J,"OPT",3920,"U")
	;;=COST REPORT FOR CIVIL HOSPITAL
	;;^UTILITY(U,$J,"OPT",3921,0)
	;;=FBCNH COST REPORT^Cost Report for Contract Nursing Home^^R^^^^^^^^FEE BASIS^^1
	;;^UTILITY(U,$J,"OPT",3921,1,0)
	;;=^^3^3^2930223^^
	;;^UTILITY(U,$J,"OPT",3921,1,1,0)
	;;=Cost report for Contract Nursing Home sorted by Date Finalized and Patient
	;;^UTILITY(U,$J,"OPT",3921,1,2,0)
	;;=Type Code.  Output includes total cases found, average amount paid, and 
	;;^UTILITY(U,$J,"OPT",3921,1,3,0)
	;;=average LOS for total report.
	;;^UTILITY(U,$J,"OPT",3921,20)
	;;=S FBTP=7,FBREF="FB7078"
	;;^UTILITY(U,$J,"OPT",3921,25)
	;;=FBCHCR
	;;^UTILITY(U,$J,"OPT",3921,"U")
	;;=COST REPORT FOR CONTRACT NURSI
	;;^UTILITY(U,$J,"OPT",3922,0)
	;;=FBAA ACTIVE BATCH LISTING^Active Batch Listing by Status^^R^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",3922,1,0)
	;;=^^3^3^2930610^^^
	;;^UTILITY(U,$J,"OPT",3922,1,1,0)
	;;=Print Active Batches for one/many/all batch statuses.
	;;^UTILITY(U,$J,"OPT",3922,1,2,0)
	;;=Report is sorted by batch status, and excludes all batches with a status
	;;^UTILITY(U,$J,"OPT",3922,1,3,0)
	;;=of vouchered.
	;;^UTILITY(U,$J,"OPT",3922,25)
	;;=FBAABT
	;;^UTILITY(U,$J,"OPT",3922,99)
	;;=55616,33537
	;;^UTILITY(U,$J,"OPT",3922,"U")
	;;=ACTIVE BATCH LISTING BY STATUS
	;;^UTILITY(U,$J,"OPT",3923,0)
	;;=FBCNH CENSUS REPORT^CNH Census Report^^R^^^^^^^^FEE BASIS^^1
	;;^UTILITY(U,$J,"OPT",3923,1,0)
	;;=^^4^4^2930915^^^^
	;;^UTILITY(U,$J,"OPT",3923,1,1,0)
	;;=This output provides a listing for all Contract Nursing Home patients
	;;^UTILITY(U,$J,"OPT",3923,1,2,0)
	;;=for a user specified census date.  Output includes the Vendor name and
	;;^UTILITY(U,$J,"OPT",3923,1,3,0)
	;;=Participation Code, veteran specifics such as DOB and ID, as well as
	;;^UTILITY(U,$J,"OPT",3923,1,4,0)
	;;=the Primary Service Area and the Authorization From Date.
	;;^UTILITY(U,$J,"OPT",3923,20)
	;;=S FBI=7
	;;^UTILITY(U,$J,"OPT",3923,25)
	;;=FBCNHCEN
	;;^UTILITY(U,$J,"OPT",3923,"U")
	;;=CNH CENSUS REPORT
	;;^UTILITY(U,$J,"OPT",3924,0)
	;;=FBCNH AMIE^Report of Admissions/Discharges for CNH^^R^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",3924,1,0)
	;;=^^2^2^2930507^^^
	;;^UTILITY(U,$J,"OPT",3924,1,1,0)
	;;=Output report listing Admissions to and Discharges from a Contract Nursing
	;;^UTILITY(U,$J,"OPT",3924,1,2,0)
	;;=Home within a user specified date range.
	;;^UTILITY(U,$J,"OPT",3924,25)
	;;=FBNHAMIE
	;;^UTILITY(U,$J,"OPT",3924,"U")
	;;=REPORT OF ADMISSIONS/DISCHARGE
	;;^UTILITY(U,$J,"OPT",3925,0)
	;;=FBAA COST REPORT^Outpatient Cost Report^^R^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",3925,1,0)
	;;=^^2^2^2930223^
	;;^UTILITY(U,$J,"OPT",3925,1,1,0)
	;;=Cost report for Outpatient payments for a user specified date range.
	;;^UTILITY(U,$J,"OPT",3925,1,2,0)
	;;=Report is sorted by the DATE FINALIZED field.
	;;^UTILITY(U,$J,"OPT",3925,25)
	;;=FBAACR
	;;^UTILITY(U,$J,"OPT",3925,"U")
	;;=OUTPATIENT COST REPORT
	;;^UTILITY(U,$J,"OPT",3927,0)
	;;=FBCH VOID PAYMENT^CH Void Payment^^R^^^^^^^^FEE BASIS^^1
	;;^UTILITY(U,$J,"OPT",3927,1,0)
	;;=^^3^3^2930304^
	;;^UTILITY(U,$J,"OPT",3927,1,1,0)
	;;=Searches all finalized payments that do not contain a VOID status for

FBINI04C
FBINI04C	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",3927,1,2,0)
	;;=a specific patient and vendor.  Provides user with a list of payments from
	;;^UTILITY(U,$J,"OPT",3927,1,3,0)
	;;=which they may choose to void one/many/all.
	;;^UTILITY(U,$J,"OPT",3927,20)
	;;=S FBTYPE=6
	;;^UTILITY(U,$J,"OPT",3927,25)
	;;=FBCHVP
	;;^UTILITY(U,$J,"OPT",3927,"U")
	;;=CH VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",3928,0)
	;;=FBCH DELETE VOID^CH Delete Void Payment^^R^^^^^^^^FEE BASIS^^1
	;;^UTILITY(U,$J,"OPT",3928,1,0)
	;;=^^3^3^2930304^
	;;^UTILITY(U,$J,"OPT",3928,1,1,0)
	;;=Searches all finalized payments that contain a VOID status for a
	;;^UTILITY(U,$J,"OPT",3928,1,2,0)
	;;=specified patient and vendor.  Provides user with a list of voided
	;;^UTILITY(U,$J,"OPT",3928,1,3,0)
	;;=payments from which they may choose to cancel the void on one/many/all.
	;;^UTILITY(U,$J,"OPT",3928,20)
	;;=S FBTYPE=6,FBVOID=1
	;;^UTILITY(U,$J,"OPT",3928,25)
	;;=FBCHVP
	;;^UTILITY(U,$J,"OPT",3928,"U")
	;;=CH DELETE VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",3929,0)
	;;=FBCNH VOID PAYMENT^CNH Void Payment^^R^^^^^^^^FEE BASIS^^1
	;;^UTILITY(U,$J,"OPT",3929,1,0)
	;;=^^3^3^2930304^
	;;^UTILITY(U,$J,"OPT",3929,1,1,0)
	;;=Searches all finalized payments that do not contain a VOID status for
	;;^UTILITY(U,$J,"OPT",3929,1,2,0)
	;;=a specific patient and vendor.  Provides user with a list of payments from
	;;^UTILITY(U,$J,"OPT",3929,1,3,0)
	;;=which they may choose to void one/many/all.
	;;^UTILITY(U,$J,"OPT",3929,20)
	;;=S FBTYPE=7
	;;^UTILITY(U,$J,"OPT",3929,25)
	;;=FBCHVP
	;;^UTILITY(U,$J,"OPT",3929,"U")
	;;=CNH VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",3930,0)
	;;=FBCNH DELETE VOID^CNH Delete Void Payment^^R^^^^^^^^FEE BASIS^^1
	;;^UTILITY(U,$J,"OPT",3930,1,0)
	;;=^^3^3^2930304^
	;;^UTILITY(U,$J,"OPT",3930,1,1,0)
	;;=Searches all finalized payments that contain a VOID status for a
	;;^UTILITY(U,$J,"OPT",3930,1,2,0)
	;;=specific patient and vendor.  Provides user with a list of Voided payments
	;;^UTILITY(U,$J,"OPT",3930,1,3,0)
	;;=from which they may choose to cancel the void on one/many/all.
	;;^UTILITY(U,$J,"OPT",3930,20)
	;;=S FBTYPE=7,FBVOID=1
	;;^UTILITY(U,$J,"OPT",3930,25)
	;;=FBCHVP
	;;^UTILITY(U,$J,"OPT",3930,"U")
	;;=CNH DELETE VOID PAYMENT
	;;^UTILITY(U,$J,"OPT",3951,0)
	;;=FBAA MRA PURGE AUTO^Automatically Purge MRA's^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",3951,1,0)
	;;=^^7^7^2930517^^^^
	;;^UTILITY(U,$J,"OPT",3951,1,1,0)
	;;=This option is taskable, and will purge transmitted MRA's.  It should be
	;;^UTILITY(U,$J,"OPT",3951,1,2,0)
	;;=used only when you are sure Austin has received your MRA transmissions,
	;;^UTILITY(U,$J,"OPT",3951,1,3,0)
	;;=since use of this option will prevent you from being able to re-transmit
	;;^UTILITY(U,$J,"OPT",3951,1,4,0)
	;;=MRA's.
	;;^UTILITY(U,$J,"OPT",3951,1,5,0)
	;;=Upon successful completion of the purge, a mail message will be sent to
	;;^UTILITY(U,$J,"OPT",3951,1,6,0)
	;;=a mail group confirming the purge specifics.
	;;^UTILITY(U,$J,"OPT",3951,1,7,0)
	;;=Remember to add a mail group to the FBAA PURGE TRANSMITTED MRA'S bulletin.
	;;^UTILITY(U,$J,"OPT",3951,25)
	;;=FBAAMPG1
	;;^UTILITY(U,$J,"OPT",3951,"U")
	;;=AUTOMATICALLY PURGE MRA'S
	;;^UTILITY(U,$J,"OPT",3952,0)
	;;=FBAA MRA SERVER^Fee Basis MRA Mail Message Server^^S^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",3952,1,0)
	;;=^^2^2^2940222^^^^
	;;^UTILITY(U,$J,"OPT",3952,1,1,0)
	;;=This server processes all incoming MRA messages received
	;;^UTILITY(U,$J,"OPT",3952,1,2,0)
	;;=through Mailman from Austin.
	;;^UTILITY(U,$J,"OPT",3952,25)
	;;=FBMRASVR
	;;^UTILITY(U,$J,"OPT",3952,220)
	;;=^R^FEE^N^N^N
	;;^UTILITY(U,$J,"OPT",3952,"U")
	;;=FEE BASIS MRA MAIL MESSAGE SER
	;;^UTILITY(U,$J,"OPT",4022,0)
	;;=FBCNH CANCEL 7078^Cancel Authorization Entered in Error^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",4022,1,0)
	;;=^^3^3^2930510^^
	;;^UTILITY(U,$J,"OPT",4022,1,1,0)
	;;=This option should be used when an authorization has been set up and
	;;^UTILITY(U,$J,"OPT",4022,1,2,0)
	;;=has been determined that it was entered in error.  Once cancelled,
	;;^UTILITY(U,$J,"OPT",4022,1,3,0)
	;;=a user can re-enter the correct authorization.

FBINI04D
FBINI04D	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4022,25)
	;;=CNH^FBCHC78
	;;^UTILITY(U,$J,"OPT",4022,99)
	;;=55610,33111
	;;^UTILITY(U,$J,"OPT",4022,"U")
	;;=CANCEL AUTHORIZATION ENTERED I
	;;^UTILITY(U,$J,"OPT",4024,0)
	;;=FBUC ENTER^Enter Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4024,1,0)
	;;=^^7^7^2930517^^^^
	;;^UTILITY(U,$J,"OPT",4024,1,1,0)
	;;=Enter a new unauthorized claim.  If you have indicated that you will be
	;;^UTILITY(U,$J,"OPT",4024,1,2,0)
	;;=tracking incomplete claims in your Fee Basis Site Parameters file, you may 
	;;^UTILITY(U,$J,"OPT",4024,1,3,0)
	;;=enter an incomplete claim.  If you have not entered anything in the 
	;;^UTILITY(U,$J,"OPT",4024,1,4,0)
	;;=parameter, you can only enter complete unauthorized claims.
	;;^UTILITY(U,$J,"OPT",4024,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4024,1,6,0)
	;;=A claim is considered complete when a VA form 10-583 and all documentation
	;;^UTILITY(U,$J,"OPT",4024,1,7,0)
	;;=has been received in order to determine legal and medical entitlement.
	;;^UTILITY(U,$J,"OPT",4024,25)
	;;=FBUCEN
	;;^UTILITY(U,$J,"OPT",4024,99)
	;;=55647,57709
	;;^UTILITY(U,$J,"OPT",4024,"U")
	;;=ENTER UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4025,0)
	;;=FBUC MODIFY UNAUTHORIZED CLAIM^Modify Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4025,1,0)
	;;=^^2^2^2930708^^
	;;^UTILITY(U,$J,"OPT",4025,1,1,0)
	;;=Edit an unauthorized claim.  Only claims which were never dispositioned
	;;^UTILITY(U,$J,"OPT",4025,1,2,0)
	;;=may be edited.
	;;^UTILITY(U,$J,"OPT",4025,25)
	;;=EDT^FBUCED
	;;^UTILITY(U,$J,"OPT",4025,"U")
	;;=MODIFY UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4026,0)
	;;=FBUC DISPOSITION UNAUTH CLAIM^Disposition Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4026,1,0)
	;;=^^4^4^2930708^^^^
	;;^UTILITY(U,$J,"OPT",4026,1,1,0)
	;;=Disposition an unauthorized claim.  Any claim may be selected.
	;;^UTILITY(U,$J,"OPT",4026,1,2,0)
	;;=If the disposition reason is changed from APPROVED to a reason other than
	;;^UTILITY(U,$J,"OPT",4026,1,3,0)
	;;=APPROVED, and payments have been made, only a user who holds the
	;;^UTILITY(U,$J,"OPT",4026,1,4,0)
	;;=supervisor's security key may change the disposition.
	;;^UTILITY(U,$J,"OPT",4026,25)
	;;=DIS^FBUCED
	;;^UTILITY(U,$J,"OPT",4026,99)
	;;=55787,64747
	;;^UTILITY(U,$J,"OPT",4026,"U")
	;;=DISPOSITION UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4027,0)
	;;=FBUC REOPEN^Re-open Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4027,1,0)
	;;=^^4^4^2930708^^^
	;;^UTILITY(U,$J,"OPT",4027,1,1,0)
	;;=Reopen a claim which has been dispositioned.  This is essentially the same
	;;^UTILITY(U,$J,"OPT",4027,1,2,0)
	;;=as the MODIFY UNAUTHORIZED CLAIM option, only selection is limited to claims
	;;^UTILITY(U,$J,"OPT",4027,1,3,0)
	;;=with a status of DISPOSITIONED, and the date the claim was reopened is
	;;^UTILITY(U,$J,"OPT",4027,1,4,0)
	;;=entered.
	;;^UTILITY(U,$J,"OPT",4027,25)
	;;=REO^FBUCED
	;;^UTILITY(U,$J,"OPT",4027,99)
	;;=55644,52684
	;;^UTILITY(U,$J,"OPT",4027,"U")
	;;=RE-OPEN UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4028,0)
	;;=FBUC INITIATE APPEAL^Initiate Appeal for Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4028,1,0)
	;;=^^3^3^2931008^^^^
	;;^UTILITY(U,$J,"OPT",4028,1,1,0)
	;;=Initiate an appeal to Board of Veterans Appeals (BVA).
	;;^UTILITY(U,$J,"OPT",4028,1,2,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4028,1,3,0)
	;;=Selection of claims is limited to only those claims which have a status of DISPOSITIONED.
	;;^UTILITY(U,$J,"OPT",4028,25)
	;;=APL^FBUCED
	;;^UTILITY(U,$J,"OPT",4028,"U")
	;;=INITIATE APPEAL FOR UNAUTHORIZ
	;;^UTILITY(U,$J,"OPT",4029,0)
	;;=FBUC APPEAL EDIT^Appeal Edit for Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4029,1,0)
	;;=^^5^5^2931008^^^^
	;;^UTILITY(U,$J,"OPT",4029,1,1,0)
	;;=Edit a claim which has been appealed to the Board of Veterans Appeals (BVA).
	;;^UTILITY(U,$J,"OPT",4029,1,2,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4029,1,3,0)
	;;=Selection of claims is limited to only those claims which have a status
	;;^UTILITY(U,$J,"OPT",4029,1,4,0)
	;;=of APPEAL/NOTICE OF DISAGREE RECV, APPEAL/ISSUED STATMENT OF CASE,

FBINI04E
FBINI04E	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4029,1,5,0)
	;;=APPEAL COMPLETE/PENDING REVIEW or APPEAL DISPOSITIONED.
	;;^UTILITY(U,$J,"OPT",4029,25)
	;;=AED^FBUCED
	;;^UTILITY(U,$J,"OPT",4029,"U")
	;;=APPEAL EDIT FOR UNAUTHORIZED C
	;;^UTILITY(U,$J,"OPT",4030,0)
	;;=FBUC COVA APPEAL^COVA Appeal Enter/Edit^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4030,1,0)
	;;=^^6^6^2931008^^^^
	;;^UTILITY(U,$J,"OPT",4030,1,1,0)
	;;=This option is used to enter or edit an appeal to the Court of Veterans
	;;^UTILITY(U,$J,"OPT",4030,1,2,0)
	;;=Affairs (COVA).  This is an appeal of the Board of Veterans Affairs (BVA)
	;;^UTILITY(U,$J,"OPT",4030,1,3,0)
	;;=decision.
	;;^UTILITY(U,$J,"OPT",4030,1,4,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4030,1,5,0)
	;;=Selection of claims is limited to those claims which have a status
	;;^UTILITY(U,$J,"OPT",4030,1,6,0)
	;;=of APPEAL DISPOSITIONED, COVA APPEAL or COVA DISPOSITION.
	;;^UTILITY(U,$J,"OPT",4030,25)
	;;=COVA^FBUCED
	;;^UTILITY(U,$J,"OPT",4030,99)
	;;=55633,36628
	;;^UTILITY(U,$J,"OPT",4030,"U")
	;;=COVA APPEAL ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",4031,0)
	;;=FBUC REQUEST INFORMATION^Request Information on Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4031,1,0)
	;;=^^8^8^2930630^^
	;;^UTILITY(U,$J,"OPT",4031,1,1,0)
	;;=Request information on an unauthorized claim.  Selection of claims
	;;^UTILITY(U,$J,"OPT",4031,1,2,0)
	;;=is limited to those claims which have a status of INCOMPLETE UNAUTHORIZED
	;;^UTILITY(U,$J,"OPT",4031,1,3,0)
	;;=CLAIM, PENDING - REASON UNKNOWN, COMPLETE/PENDING REVIEW,
	;;^UTILITY(U,$J,"OPT",4031,1,4,0)
	;;=APPEAL/NOTICE OF DISAGREE RECV or APPEAL/ISSUED STATMENT OF CASE.
	;;^UTILITY(U,$J,"OPT",4031,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4031,1,6,0)
	;;=A letter will print or be flagged for printing (depending upon your
	;;^UTILITY(U,$J,"OPT",4031,1,7,0)
	;;=parameter set-up) if the request causes the status to change, or 
	;;^UTILITY(U,$J,"OPT",4031,1,8,0)
	;;=requests additional information.
	;;^UTILITY(U,$J,"OPT",4031,25)
	;;=REQ^FBUCED
	;;^UTILITY(U,$J,"OPT",4031,"U")
	;;=REQUEST INFORMATION ON UNAUTHO
	;;^UTILITY(U,$J,"OPT",4032,0)
	;;=FBUC RECEIVE INFORMATION^Receive Requested Information^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4032,1,0)
	;;=^^4^4^2930923^^
	;;^UTILITY(U,$J,"OPT",4032,1,1,0)
	;;=Receive information which was requested for a claim.  Selection of claims
	;;^UTILITY(U,$J,"OPT",4032,1,2,0)
	;;=is limited to those claims which have a status of INCOMPLETE
	;;^UTILITY(U,$J,"OPT",4032,1,3,0)
	;;=UNAUTHORIZED CLAIM, APPEAL/NOTICE OF DISAGREE RECV or
	;;^UTILITY(U,$J,"OPT",4032,1,4,0)
	;;=APPEAL/ISSUED STATMENT OF CASE.
	;;^UTILITY(U,$J,"OPT",4032,25)
	;;=REC^FBUCED
	;;^UTILITY(U,$J,"OPT",4032,"U")
	;;=RECEIVE REQUESTED INFORMATION
	;;^UTILITY(U,$J,"OPT",4033,0)
	;;=FBUC REQUEST INFO FILE^Request Info File Enter/Edit^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4033,1,0)
	;;=^^2^2^2930409^
	;;^UTILITY(U,$J,"OPT",4033,1,1,0)
	;;=Enter/edit data in the Fee Basis Unauthorized Requested Information file
	;;^UTILITY(U,$J,"OPT",4033,1,2,0)
	;;=(# 162.93).
	;;^UTILITY(U,$J,"OPT",4033,25)
	;;=REQENT^FBUCED
	;;^UTILITY(U,$J,"OPT",4033,"U")
	;;=REQUEST INFO FILE ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",4034,0)
	;;=FBUC UPDATE DATE LETTER SENT^Update Date Letter Sent^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4034,1,0)
	;;=^^3^3^2930409^
	;;^UTILITY(U,$J,"OPT",4034,1,1,0)
	;;=This option should be used if you are not generating your letters.
	;;^UTILITY(U,$J,"OPT",4034,1,2,0)
	;;=It will update the date the letter was sent.  If applicable, the
	;;^UTILITY(U,$J,"OPT",4034,1,3,0)
	;;=expiration date will also be updated.
	;;^UTILITY(U,$J,"OPT",4034,25)
	;;=LET^FBUCED
	;;^UTILITY(U,$J,"OPT",4034,"U")
	;;=UPDATE DATE LETTER SENT
	;;^UTILITY(U,$J,"OPT",4035,0)
	;;=FBUC BATCH PRINT LETTERS^Batch Print Letters^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4035,1,0)
	;;=^^7^7^2930409^
	;;^UTILITY(U,$J,"OPT",4035,1,1,0)
	;;=This option will batch print letters which have been flagged for printing,
	;;^UTILITY(U,$J,"OPT",4035,1,2,0)
	;;=but for some reason could not be printed.  A site parameter exists
	;;^UTILITY(U,$J,"OPT",4035,1,3,0)
	;;=for an output device for your letters.  If you have not filled this, or

FBINI04F
FBINI04F	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4035,1,4,0)
	;;=if this parameter contains an invalid device, and you have indicated
	;;^UTILITY(U,$J,"OPT",4035,1,5,0)
	;;=that your letters will be either automatically or batch printed, you
	;;^UTILITY(U,$J,"OPT",4035,1,6,0)
	;;=can print your pending letters using this option.
	;;^UTILITY(U,$J,"OPT",4035,1,7,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4035,25)
	;;=BATCH^FBUCLET
	;;^UTILITY(U,$J,"OPT",4035,99)
	;;=55616,66143
	;;^UTILITY(U,$J,"OPT",4035,"U")
	;;=BATCH PRINT LETTERS
	;;^UTILITY(U,$J,"OPT",4036,0)
	;;=FBUC QUEUE BATCH PRINT^Queue Batch Print Letters^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4036,1,0)
	;;=^^2^2^2930409^^
	;;^UTILITY(U,$J,"OPT",4036,1,1,0)
	;;=If you are batch printing your letters, this option should be run at least
	;;^UTILITY(U,$J,"OPT",4036,1,2,0)
	;;=once a day.
	;;^UTILITY(U,$J,"OPT",4036,25)
	;;=BATCHDQ^FBUCLET0
	;;^UTILITY(U,$J,"OPT",4036,99)
	;;=55747,58628
	;;^UTILITY(U,$J,"OPT",4036,200)
	;;=^^1D
	;;^UTILITY(U,$J,"OPT",4036,"U")
	;;=QUEUE BATCH PRINT LETTERS
	;;^UTILITY(U,$J,"OPT",4037,0)
	;;=FBUC MAIN^Unauthorized Claim Main Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4037,1,0)
	;;=^^1^1^2930409^
	;;^UTILITY(U,$J,"OPT",4037,1,1,0)
	;;=Main menu for unauthorized claims processing.
	;;^UTILITY(U,$J,"OPT",4037,10,0)
	;;=^19.01IP^13^8
	;;^UTILITY(U,$J,"OPT",4037,10,6,0)
	;;=4031^^2
	;;^UTILITY(U,$J,"OPT",4037,10,6,"^")
	;;=FBUC REQUEST INFORMATION
	;;^UTILITY(U,$J,"OPT",4037,10,7,0)
	;;=4032^^3
	;;^UTILITY(U,$J,"OPT",4037,10,7,"^")
	;;=FBUC RECEIVE INFORMATION
	;;^UTILITY(U,$J,"OPT",4037,10,8,0)
	;;=4039^^4
	;;^UTILITY(U,$J,"OPT",4037,10,8,"^")
	;;=FBUC LETTERS
	;;^UTILITY(U,$J,"OPT",4037,10,9,0)
	;;=4040^^6
	;;^UTILITY(U,$J,"OPT",4037,10,9,"^")
	;;=FBUC OUTPUTS
	;;^UTILITY(U,$J,"OPT",4037,10,10,0)
	;;=4041^^1
	;;^UTILITY(U,$J,"OPT",4037,10,10,"^")
	;;=FBUC ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",4037,10,11,0)
	;;=4066^^7
	;;^UTILITY(U,$J,"OPT",4037,10,11,"^")
	;;=FBUC DISPLAY UNAUTHORIZED
	;;^UTILITY(U,$J,"OPT",4037,10,12,0)
	;;=4070^^5
	;;^UTILITY(U,$J,"OPT",4037,10,12,"^")
	;;=FBUC PAYMENTS
	;;^UTILITY(U,$J,"OPT",4037,10,13,0)
	;;=4085^^8
	;;^UTILITY(U,$J,"OPT",4037,10,13,"^")
	;;=FBUC UTILITIES
	;;^UTILITY(U,$J,"OPT",4037,99)
	;;=56204,45538
	;;^UTILITY(U,$J,"OPT",4037,"U")
	;;=UNAUTHORIZED CLAIM MAIN MENU
	;;^UTILITY(U,$J,"OPT",4039,0)
	;;=FBUC LETTERS^Letters for Unauthorized Claim^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4039,1,0)
	;;=^^1^1^2930617^^
	;;^UTILITY(U,$J,"OPT",4039,1,1,0)
	;;=Menu option for printing or updating letters.
	;;^UTILITY(U,$J,"OPT",4039,10,0)
	;;=^19.01IP^3^3
	;;^UTILITY(U,$J,"OPT",4039,10,1,0)
	;;=4034^^1
	;;^UTILITY(U,$J,"OPT",4039,10,1,"^")
	;;=FBUC UPDATE DATE LETTER SENT
	;;^UTILITY(U,$J,"OPT",4039,10,2,0)
	;;=4035^^2
	;;^UTILITY(U,$J,"OPT",4039,10,2,"^")
	;;=FBUC BATCH PRINT LETTERS
	;;^UTILITY(U,$J,"OPT",4039,10,3,0)
	;;=4100
	;;^UTILITY(U,$J,"OPT",4039,10,3,"^")
	;;=FBUC REPRINT LETTER(S)
	;;^UTILITY(U,$J,"OPT",4039,99)
	;;=56204,45542
	;;^UTILITY(U,$J,"OPT",4039,"U")
	;;=LETTERS FOR UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4040,0)
	;;=FBUC OUTPUTS^Outputs for Unauthorized Claims^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4040,1,0)
	;;=^^1^1^2930528^^^
	;;^UTILITY(U,$J,"OPT",4040,1,1,0)
	;;=Menu option for outputs related to unauthorized claims.
	;;^UTILITY(U,$J,"OPT",4040,10,0)
	;;=^19.01IP^9^9
	;;^UTILITY(U,$J,"OPT",4040,10,1,0)
	;;=4066
	;;^UTILITY(U,$J,"OPT",4040,10,1,"^")
	;;=FBUC DISPLAY UNAUTHORIZED
	;;^UTILITY(U,$J,"OPT",4040,10,2,0)
	;;=4042
	;;^UTILITY(U,$J,"OPT",4040,10,2,"^")
	;;=FB PAY VENDOR
	;;^UTILITY(U,$J,"OPT",4040,10,3,0)
	;;=4043
	;;^UTILITY(U,$J,"OPT",4040,10,3,"^")
	;;=FB PAY VETERAN
	;;^UTILITY(U,$J,"OPT",4040,10,4,0)
	;;=4091
	;;^UTILITY(U,$J,"OPT",4040,10,4,"^")
	;;=FBUC STATUS OUTPUT
	;;^UTILITY(U,$J,"OPT",4040,10,5,0)
	;;=4092
	;;^UTILITY(U,$J,"OPT",4040,10,5,"^")
	;;=FBUC STATS OUTPUT
	;;^UTILITY(U,$J,"OPT",4040,10,6,0)
	;;=4090
	;;^UTILITY(U,$J,"OPT",4040,10,6,"^")
	;;=FBUC ALL CLAIMS OUTPUT
	;;^UTILITY(U,$J,"OPT",4040,10,7,0)
	;;=4089
	;;^UTILITY(U,$J,"OPT",4040,10,7,"^")
	;;=FBUC EXPIRE OUTPUT
	;;^UTILITY(U,$J,"OPT",4040,10,8,0)
	;;=4110

FBINI04G
FBINI04G	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4040,10,8,"^")
	;;=FBCH UC COST REPORT
	;;^UTILITY(U,$J,"OPT",4040,10,9,0)
	;;=4607
	;;^UTILITY(U,$J,"OPT",4040,10,9,"^")
	;;=FB CHECK DISPLAY
	;;^UTILITY(U,$J,"OPT",4040,99)
	;;=56204,45670
	;;^UTILITY(U,$J,"OPT",4040,"U")
	;;=OUTPUTS FOR UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4041,0)
	;;=FBUC ENTER/EDIT^Enter/Edit Unauthorized Claim Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4041,1,0)
	;;=^^1^1^2930409^
	;;^UTILITY(U,$J,"OPT",4041,1,1,0)
	;;=Menu of enter and edit options for an unauthorized claim.
	;;^UTILITY(U,$J,"OPT",4041,10,0)
	;;=^19.01IP^7^7
	;;^UTILITY(U,$J,"OPT",4041,10,1,0)
	;;=4024^^1
	;;^UTILITY(U,$J,"OPT",4041,10,1,"^")
	;;=FBUC ENTER
	;;^UTILITY(U,$J,"OPT",4041,10,2,0)
	;;=4025^^2
	;;^UTILITY(U,$J,"OPT",4041,10,2,"^")
	;;=FBUC MODIFY UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4041,10,3,0)
	;;=4028^^5
	;;^UTILITY(U,$J,"OPT",4041,10,3,"^")
	;;=FBUC INITIATE APPEAL
	;;^UTILITY(U,$J,"OPT",4041,10,4,0)
	;;=4029^^6
	;;^UTILITY(U,$J,"OPT",4041,10,4,"^")
	;;=FBUC APPEAL EDIT
	;;^UTILITY(U,$J,"OPT",4041,10,5,0)
	;;=4030^^7
	;;^UTILITY(U,$J,"OPT",4041,10,5,"^")
	;;=FBUC COVA APPEAL
	;;^UTILITY(U,$J,"OPT",4041,10,6,0)
	;;=4026^^3
	;;^UTILITY(U,$J,"OPT",4041,10,6,"^")
	;;=FBUC DISPOSITION UNAUTH CLAIM
	;;^UTILITY(U,$J,"OPT",4041,10,7,0)
	;;=4027^^4
	;;^UTILITY(U,$J,"OPT",4041,10,7,"^")
	;;=FBUC REOPEN
	;;^UTILITY(U,$J,"OPT",4041,99)
	;;=56204,45526
	;;^UTILITY(U,$J,"OPT",4041,"U")
	;;=ENTER/EDIT UNAUTHORIZED CLAIM 
	;;^UTILITY(U,$J,"OPT",4042,0)
	;;=FB PAY VENDOR^Vendor Payments Output^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4042,1,0)
	;;=^^3^3^2930504^^^
	;;^UTILITY(U,$J,"OPT",4042,1,1,0)
	;;=The user selects the vendor, date range and fee program.  The data is sorted
	;;^UTILITY(U,$J,"OPT",4042,1,2,0)
	;;=by fee program, vendor, patient and date.  Pertinent payment information
	;;^UTILITY(U,$J,"OPT",4042,1,3,0)
	;;=related to the fee program is displayed.
	;;^UTILITY(U,$J,"OPT",4042,10,0)
	;;=^19.01IP^0^0
	;;^UTILITY(U,$J,"OPT",4042,25)
	;;=GETVEN^FBPAY
	;;^UTILITY(U,$J,"OPT",4042,99)
	;;=55616,70374
	;;^UTILITY(U,$J,"OPT",4042,"U")
	;;=VENDOR PAYMENTS OUTPUT
	;;^UTILITY(U,$J,"OPT",4043,0)
	;;=FB PAY VETERAN^Veteran Payments Output^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4043,1,0)
	;;=^^3^3^2930504^^
	;;^UTILITY(U,$J,"OPT",4043,1,1,0)
	;;=The user selects the veteran, date range and fee program.  The data is
	;;^UTILITY(U,$J,"OPT",4043,1,2,0)
	;;=sorted by fee program, vendor, patient and date.  Pertinent payment
	;;^UTILITY(U,$J,"OPT",4043,1,3,0)
	;;=information related to the fee program is displayed.
	;;^UTILITY(U,$J,"OPT",4043,25)
	;;=GETVET^FBPAY
	;;^UTILITY(U,$J,"OPT",4043,99)
	;;=55707,42256
	;;^UTILITY(U,$J,"OPT",4043,"U")
	;;=VETERAN PAYMENTS OUTPUT
	;;^UTILITY(U,$J,"OPT",4049,0)
	;;=FBCNH ENTER VETERAN RATES^Enter Veteran Rates under new Vendor Contract^^R^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",4049,1,0)
	;;=^^3^3^2930730^^
	;;^UTILITY(U,$J,"OPT",4049,1,1,0)
	;;=Allows user to choose a vendor who may have a new contract.  It will prompt
	;;^UTILITY(U,$J,"OPT",4049,1,2,0)
	;;=them for all patients who require rate choices as a result of the new
	;;^UTILITY(U,$J,"OPT",4049,1,3,0)
	;;=contract.
	;;^UTILITY(U,$J,"OPT",4049,25)
	;;=FBNHRAT
	;;^UTILITY(U,$J,"OPT",4049,"U")
	;;=ENTER VETERAN RATES UNDER NEW 
	;;^UTILITY(U,$J,"OPT",4050,0)
	;;=FBAA TERMINATE ID CARD^Terminate ID Card^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4050,1,0)
	;;=^^1^1^2931008^^^
	;;^UTILITY(U,$J,"OPT",4050,1,1,0)
	;;=This option is used to terminate the Fee ID card number.
	;;^UTILITY(U,$J,"OPT",4050,25)
	;;=FBAATIC
	;;^UTILITY(U,$J,"OPT",4050,"U")
	;;=TERMINATE ID CARD
	;;^UTILITY(U,$J,"OPT",4066,0)
	;;=FBUC DISPLAY UNAUTHORIZED^Display Unauthorized Claim^^R^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",4066,1,0)
	;;=^^12^12^2930528^^^^
	;;^UTILITY(U,$J,"OPT",4066,1,1,0)
	;;=This option is used to display an unauthorized claim.
	;;^UTILITY(U,$J,"OPT",4066,1,2,0)
	;;=You can select the claim by either vendor, veteran or other party name,
	;;^UTILITY(U,$J,"OPT",4066,1,3,0)
	;;=and the claim which you would like to view.
	;;^UTILITY(U,$J,"OPT",4066,1,4,0)
	;;= The following information is displayed:

FBINI04H
FBINI04H	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4066,1,5,0)
	;;=   o The unauthorized claim which you have selected.
	;;^UTILITY(U,$J,"OPT",4066,1,6,0)
	;;=   o The discharge type if the unauthorized claim has been dispositioned
	;;^UTILITY(U,$J,"OPT",4066,1,7,0)
	;;=      to either approved or approved to stabilization.
	;;^UTILITY(U,$J,"OPT",4066,1,8,0)
	;;=   o The pending items if the unauthorized claim has any pending
	;;^UTILITY(U,$J,"OPT",4066,1,9,0)
	;;=      information in the FEE BASIS UNAUTHORIZED CLAIMS PENDING INFO file.
	;;^UTILITY(U,$J,"OPT",4066,1,10,0)
	;;=   o A brief listing of other claims which are associated with the selected
	;;^UTILITY(U,$J,"OPT",4066,1,11,0)
	;;=      claim.
	;;^UTILITY(U,$J,"OPT",4066,1,12,0)
	;;=   o A message which indicates that payments have been made for this claim.
	;;^UTILITY(U,$J,"OPT",4066,25)
	;;=FBUCDIS
	;;^UTILITY(U,$J,"OPT",4066,99)
	;;=55634,54512
	;;^UTILITY(U,$J,"OPT",4066,"U")
	;;=DISPLAY UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4070,0)
	;;=FBUC PAYMENTS^Payments for Unauthorized Claims^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4070,1,0)
	;;=^^2^2^2930628^^^^
	;;^UTILITY(U,$J,"OPT",4070,1,1,0)
	;;=This option should be used to enter payments for an unauthorized claim
	;;^UTILITY(U,$J,"OPT",4070,1,2,0)
	;;=which has been dispositioned to approved or approved to stabilization.
	;;^UTILITY(U,$J,"OPT",4070,10,0)
	;;=^19.01IP^0^0
	;;^UTILITY(U,$J,"OPT",4070,25)
	;;=FBUCPAY
	;;^UTILITY(U,$J,"OPT",4070,99)
	;;=55640,35436
	;;^UTILITY(U,$J,"OPT",4070,"U")
	;;=PAYMENTS FOR UNAUTHORIZED CLAI
	;;^UTILITY(U,$J,"OPT",4072,0)
	;;=FBCNH RATE CHANGE^Change Existing Contract Rate for a Patient^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4072,1,0)
	;;=^^6^6^2930518^^^
	;;^UTILITY(U,$J,"OPT",4072,1,1,0)
	;;=Selection of a patient and an authorization will allow the user to
	;;^UTILITY(U,$J,"OPT",4072,1,2,0)
	;;=see all rates associated with that authorization.  If they wish to change
	;;^UTILITY(U,$J,"OPT",4072,1,3,0)
	;;=the rate for this patient, they are prompted to enter an effective date
	;;^UTILITY(U,$J,"OPT",4072,1,4,0)
	;;=of the change and to choose a new rate.  If the rates are the same, the
	;;^UTILITY(U,$J,"OPT",4072,1,5,0)
	;;=change will not take effect.  The user will see the new rates for this
	;;^UTILITY(U,$J,"OPT",4072,1,6,0)
	;;=authorization upon completion of the change.
	;;^UTILITY(U,$J,"OPT",4072,25)
	;;=FBNHRC
	;;^UTILITY(U,$J,"OPT",4072,99)
	;;=55797,36376
	;;^UTILITY(U,$J,"OPT",4072,"U")
	;;=CHANGE EXISTING CONTRACT RATE 
	;;^UTILITY(U,$J,"OPT",4073,0)
	;;=FBUC ADD NEW PERSON^Add New Person for Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4073,1,0)
	;;=^^6^6^2930628^^
	;;^UTILITY(U,$J,"OPT",4073,1,1,0)
	;;=This option allows entry to the New Person file.
	;;^UTILITY(U,$J,"OPT",4073,1,2,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4073,1,3,0)
	;;=If an Unauthorized Claim is submitted by an other party (ie not veteran or
	;;^UTILITY(U,$J,"OPT",4073,1,4,0)
	;;=not vendor), name and address of submitter needs to be entered into the
	;;^UTILITY(U,$J,"OPT",4073,1,5,0)
	;;=New Person file if it does not already exist.  This will allow correspondence
	;;^UTILITY(U,$J,"OPT",4073,1,6,0)
	;;= and/or payments to efficiently reach the appropriate party.
	;;^UTILITY(U,$J,"OPT",4073,25)
	;;=ADD^FBUCUTL3
	;;^UTILITY(U,$J,"OPT",4073,99)
	;;=55634,39955
	;;^UTILITY(U,$J,"OPT",4073,"U")
	;;=ADD NEW PERSON FOR UNAUTHORIZE
	;;^UTILITY(U,$J,"OPT",4074,0)
	;;=FBCNH ACTIVITY REPORT^Activity Report for CNH^^R^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",4074,1,0)
	;;=^^3^3^2930504^
	;;^UTILITY(U,$J,"OPT",4074,1,1,0)
	;;=This option prompts the user for input of a date range.  The output
	;;^UTILITY(U,$J,"OPT",4074,1,2,0)
	;;=includes all activity (admissions transfers and discharges) that fall
	;;^UTILITY(U,$J,"OPT",4074,1,3,0)
	;;=within the date range.
	;;^UTILITY(U,$J,"OPT",4074,25)
	;;=FBNHACT
	;;^UTILITY(U,$J,"OPT",4074,"U")
	;;=ACTIVITY REPORT FOR CNH
	;;^UTILITY(U,$J,"OPT",4084,0)
	;;=FBUC ASSOCIATE^Associate an Unauthorized Claim to a Primary^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4084,1,0)
	;;=^^3^3^2930514^

FBINI04I
FBINI04I	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4084,1,1,0)
	;;=This option should be used when you wish to associate unauthorized claims
	;;^UTILITY(U,$J,"OPT",4084,1,2,0)
	;;=to a primary claim.  The primary claim is the first claim which was entered
	;;^UTILITY(U,$J,"OPT",4084,1,3,0)
	;;=for a veteran and episode of care (same treatment from and to dates).
	;;^UTILITY(U,$J,"OPT",4084,25)
	;;=EDIT^FBUCLINK
	;;^UTILITY(U,$J,"OPT",4084,"U")
	;;=ASSOCIATE AN UNAUTHORIZED CLAI
	;;^UTILITY(U,$J,"OPT",4085,0)
	;;=FBUC UTILITIES^Utilities for Unauthorized Claims^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4085,1,0)
	;;=^^2^2^2930911^^
	;;^UTILITY(U,$J,"OPT",4085,1,1,0)
	;;=This menu option contains miscellaneous utility options related to
	;;^UTILITY(U,$J,"OPT",4085,1,2,0)
	;;=processing unauthorized claims.
	;;^UTILITY(U,$J,"OPT",4085,10,0)
	;;=^19.01IP^6^6
	;;^UTILITY(U,$J,"OPT",4085,10,1,0)
	;;=2308^^1
	;;^UTILITY(U,$J,"OPT",4085,10,1,"^")
	;;=FBCNH VENDOR ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",4085,10,2,0)
	;;=4073^^2
	;;^UTILITY(U,$J,"OPT",4085,10,2,"^")
	;;=FBUC ADD NEW PERSON
	;;^UTILITY(U,$J,"OPT",4085,10,3,0)
	;;=4084^^3
	;;^UTILITY(U,$J,"OPT",4085,10,3,"^")
	;;=FBUC ASSOCIATE
	;;^UTILITY(U,$J,"OPT",4085,10,4,0)
	;;=4113^^5
	;;^UTILITY(U,$J,"OPT",4085,10,4,"^")
	;;=FBUC DELETE UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4085,10,5,0)
	;;=4172^^4
	;;^UTILITY(U,$J,"OPT",4085,10,5,"^")
	;;=FBUC DISASSOCIATE
	;;^UTILITY(U,$J,"OPT",4085,10,6,0)
	;;=4173^^6
	;;^UTILITY(U,$J,"OPT",4085,10,6,"^")
	;;=FBUC RETURN ADDRESS DIS/ED
	;;^UTILITY(U,$J,"OPT",4085,99)
	;;=56204,45563
	;;^UTILITY(U,$J,"OPT",4085,"U")
	;;=UTILITIES FOR UNAUTHORIZED CLA
	;;^UTILITY(U,$J,"OPT",4088,0)
	;;=FBUC ABANDONED^Abandoned Unauthorized Claims Update^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4088,1,0)
	;;=^^8^8^2930702^^^
	;;^UTILITY(U,$J,"OPT",4088,1,1,0)
	;;=This option should be queued to run daily.  A device needs to be specified.
	;;^UTILITY(U,$J,"OPT",4088,1,2,0)
	;;=It will search the unauthorized claims file for those claims that have the
	;;^UTILITY(U,$J,"OPT",4088,1,3,0)
	;;=status of INCOMPLETE UNAUTHORIZED CLAIM or APPEAL/ISSUED STATMENT OF CASE,
	;;^UTILITY(U,$J,"OPT",4088,1,4,0)
	;;=beginning with the prior date.
	;;^UTILITY(U,$J,"OPT",4088,1,5,0)
	;;=   
	;;^UTILITY(U,$J,"OPT",4088,1,6,0)
	;;=If the expiration date for these claims is met, the claim will be
	;;^UTILITY(U,$J,"OPT",4088,1,7,0)
	;;=dispositioned to ABANDONED.  A printout of those claims which were updated
	;;^UTILITY(U,$J,"OPT",4088,1,8,0)
	;;=will print to the specified device.
	;;^UTILITY(U,$J,"OPT",4088,25)
	;;=ABAND^FBUCEX
	;;^UTILITY(U,$J,"OPT",4088,99)
	;;=55686,57685
	;;^UTILITY(U,$J,"OPT",4088,200)
	;;=^^1D
	;;^UTILITY(U,$J,"OPT",4088,"U")
	;;=ABANDONED UNAUTHORIZED CLAIMS 
	;;^UTILITY(U,$J,"OPT",4089,0)
	;;=FBUC EXPIRE OUTPUT^Expiration Display/Print^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4089,1,0)
	;;=^^2^2^2930528^
	;;^UTILITY(U,$J,"OPT",4089,1,1,0)
	;;=This option will display/print those unauthorized claims which will
	;;^UTILITY(U,$J,"OPT",4089,1,2,0)
	;;=expire within the selected time frame.
	;;^UTILITY(U,$J,"OPT",4089,25)
	;;=EXPIRE^FBUCEX
	;;^UTILITY(U,$J,"OPT",4089,"U")
	;;=EXPIRATION DISPLAY/PRINT
	;;^UTILITY(U,$J,"OPT",4090,0)
	;;=FBUC ALL CLAIMS OUTPUT^All Claims by Vendor/Veteran/Other^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4090,1,0)
	;;=^^15^15^2930608^^^
	;;^UTILITY(U,$J,"OPT",4090,1,1,0)
	;;=This option allows the user to display/print all unauthorized claims for
	;;^UTILITY(U,$J,"OPT",4090,1,2,0)
	;;=a single vendor or veteran or other party.
	;;^UTILITY(U,$J,"OPT",4090,1,3,0)
	;;=The output is sorted by episode of care, grouping claims which are associated
	;;^UTILITY(U,$J,"OPT",4090,1,4,0)
	;;=with one another.  Since the primary may not be the first to display, the
	;;^UTILITY(U,$J,"OPT",4090,1,5,0)
	;;=secondaries are flagged with an asterisk ('*'), which preceeds the name.
	;;^UTILITY(U,$J,"OPT",4090,1,6,0)
	;;=If you select a vendor, the output will display veteran, otherwise it
	;;^UTILITY(U,$J,"OPT",4090,1,7,0)
	;;=will display vendor.  The Fee program, status and disposition codes are

FBINI04J
FBINI04J	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4090,1,8,0)
	;;=also displayed.
	;;^UTILITY(U,$J,"OPT",4090,1,9,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4090,1,10,0)
	;;=  (Note:  The disposition code will only display if the unauthorized claim
	;;^UTILITY(U,$J,"OPT",4090,1,11,0)
	;;=has a status of either DISPOSITIONED, APPEAL DISPOSITIONED or
	;;^UTILITY(U,$J,"OPT",4090,1,12,0)
	;;=BVA DISPOSITION.)
	;;^UTILITY(U,$J,"OPT",4090,1,13,0)
	;;=  The codes are:
	;;^UTILITY(U,$J,"OPT",4090,1,14,0)
	;;= AP for Approved, AS for Approved to Stabilization, DA for Disapproved,
	;;^UTILITY(U,$J,"OPT",4090,1,15,0)
	;;=    CW for Canceled/Withdrawn,  AB for Abandoned
	;;^UTILITY(U,$J,"OPT",4090,25)
	;;=ONE^FBUCOUT1
	;;^UTILITY(U,$J,"OPT",4090,"U")
	;;=ALL CLAIMS BY VENDOR/VETERAN/O
	;;^UTILITY(U,$J,"OPT",4091,0)
	;;=FBUC STATUS OUTPUT^Status Display/Print of Unauthorized Claims^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4091,1,0)
	;;=^^17^17^2930608^^^
	;;^UTILITY(U,$J,"OPT",4091,1,1,0)
	;;=This option displays/prints unauthorized claims by PSA and status.
	;;^UTILITY(U,$J,"OPT",4091,1,2,0)
	;;=You have the option to sort by either vendor or veteran for the primary
	;;^UTILITY(U,$J,"OPT",4091,1,3,0)
	;;=sort.  The report will then sort by what you did not select.  You have
	;;^UTILITY(U,$J,"OPT",4091,1,4,0)
	;;=the option to group all veterans within a vendor or all vendors which
	;;^UTILITY(U,$J,"OPT",4091,1,5,0)
	;;=serviced a veteran.  The output also subtototals the number of claims
	;;^UTILITY(U,$J,"OPT",4091,1,6,0)
	;;=within a status, and displays the expiration date, if one exists.  If
	;;^UTILITY(U,$J,"OPT",4091,1,7,0)
	;;=the unauthorized claim is due to expire within thirty days of the date
	;;^UTILITY(U,$J,"OPT",4091,1,8,0)
	;;=the output was generated an asterisk ('*') will follow the expiration date.
	;;^UTILITY(U,$J,"OPT",4091,1,9,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4091,1,10,0)
	;;=A disposition code will appear after those unauthorized claims having
	;;^UTILITY(U,$J,"OPT",4091,1,11,0)
	;;=a dispositioned status.
	;;^UTILITY(U,$J,"OPT",4091,1,12,0)
	;;=  (Note:  The disposition code will only display if the unauthorized claim
	;;^UTILITY(U,$J,"OPT",4091,1,13,0)
	;;=has a status of either DISPOSITIONED, APPEAL DISPOSITIONED or
	;;^UTILITY(U,$J,"OPT",4091,1,14,0)
	;;=BVA DISPOSITION.)
	;;^UTILITY(U,$J,"OPT",4091,1,15,0)
	;;=  The codes are:
	;;^UTILITY(U,$J,"OPT",4091,1,16,0)
	;;= AP for Approved, AS for Approved to Stabilization, DA for Disapproved,
	;;^UTILITY(U,$J,"OPT",4091,1,17,0)
	;;=    CW for Canceled/Withdrawn,  AB for Abandoned
	;;^UTILITY(U,$J,"OPT",4091,25)
	;;=ASK^FBUCOUT
	;;^UTILITY(U,$J,"OPT",4091,99)
	;;=55676,44625
	;;^UTILITY(U,$J,"OPT",4091,"U")
	;;=STATUS DISPLAY/PRINT OF UNAUTH
	;;^UTILITY(U,$J,"OPT",4092,0)
	;;=FBUC STATS OUTPUT^Disposition/Status Statistics Display/Print^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4092,1,0)
	;;=^^6^6^2930608^^
	;;^UTILITY(U,$J,"OPT",4092,1,1,0)
	;;=This option provides a statistical report on unauthorized claims within
	;;^UTILITY(U,$J,"OPT",4092,1,2,0)
	;;=a selected date range.   It provides totals of dispositioned unauthorized
	;;^UTILITY(U,$J,"OPT",4092,1,3,0)
	;;=claims by disposition type (approved,disapproved, etc.) as well as
	;;^UTILITY(U,$J,"OPT",4092,1,4,0)
	;;=disposition status.  The report also supplies the total of unauthorized
	;;^UTILITY(U,$J,"OPT",4092,1,5,0)
	;;=claims which have not been dispositioned, with a subtotal breakdown by
	;;^UTILITY(U,$J,"OPT",4092,1,6,0)
	;;=the claims status.  Total approved dollars by PSA are also provided.
	;;^UTILITY(U,$J,"OPT",4092,25)
	;;=FBUCSTAT
	;;^UTILITY(U,$J,"OPT",4092,"U")
	;;=DISPOSITION/STATUS STATISTICS 
	;;^UTILITY(U,$J,"OPT",4097,0)
	;;=FBCNH ADMISSIONS > 90 DAYS^CNH Stays in Excess of 90 Days^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4097,1,0)
	;;=5^^5^5^2930610^
	;;^UTILITY(U,$J,"OPT",4097,1,1,0)
	;;=This option will prompt the user for an effective date.  This date should
	;;^UTILITY(U,$J,"OPT",4097,1,2,0)
	;;=be representative of the day the user wishes to see all ACTIVE CNH stays
	;;^UTILITY(U,$J,"OPT",4097,1,3,0)
	;;=for a patient that meet or exceed 90 days.  The Length of Stay (LOS) will

FBINI04K
FBINI04K	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4097,1,4,0)
	;;=be displayed for all records that meet the above criteria.  It should be
	;;^UTILITY(U,$J,"OPT",4097,1,5,0)
	;;=noted that the length of stay is as of the effective date only.
	;;^UTILITY(U,$J,"OPT",4097,25)
	;;=FBNHAMI2
	;;^UTILITY(U,$J,"OPT",4097,"U")
	;;=CNH STAYS IN EXCESS OF 90 DAYS
	;;^UTILITY(U,$J,"OPT",4099,0)
	;;=FBCNH DELETE RATE^Delete CNH Rate^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4099,1,0)
	;;=^^7^7^2930614^
	;;^UTILITY(U,$J,"OPT",4099,1,1,0)
	;;=This option allows the deletion of a CNH Rate, only if the rate has not
	;;^UTILITY(U,$J,"OPT",4099,1,2,0)
	;;=been used by a patient yet (i.e. found in the Fee Basis CNH Authorization
	;;^UTILITY(U,$J,"OPT",4099,1,3,0)
	;;=Rate File 161.23).  The option prompts for the contract number, and will
	;;^UTILITY(U,$J,"OPT",4099,1,4,0)
	;;=display all valid rates for that contract.  The user may choose from the
	;;^UTILITY(U,$J,"OPT",4099,1,5,0)
	;;=rates displayed.  If successful, the rate will be deleted from the file.
	;;^UTILITY(U,$J,"OPT",4099,1,6,0)
	;;=If the rate is found to be in use, a message will display to the user,
	;;^UTILITY(U,$J,"OPT",4099,1,7,0)
	;;=indicating that the rate may not be deleted.
	;;^UTILITY(U,$J,"OPT",4099,25)
	;;=FBNHRDEL
	;;^UTILITY(U,$J,"OPT",4099,"U")
	;;=DELETE CNH RATE
	;;^UTILITY(U,$J,"OPT",4100,0)
	;;=FBUC REPRINT LETTER(S)^Reprint Letter(s)^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4100,1,0)
	;;=^^9^9^2930628^^
	;;^UTILITY(U,$J,"OPT",4100,1,1,0)
	;;=This option allows you to reprint letters which were already printed,
	;;^UTILITY(U,$J,"OPT",4100,1,2,0)
	;;=provided that the current status of the unauthorized claim involves a 
	;;^UTILITY(U,$J,"OPT",4100,1,3,0)
	;;=letter.
	;;^UTILITY(U,$J,"OPT",4100,1,4,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4100,1,5,0)
	;;=You have the option to reprint for a date range (probably useful in the
	;;^UTILITY(U,$J,"OPT",4100,1,6,0)
	;;=event of a printer jam or malfunction when the original letters were
	;;^UTILITY(U,$J,"OPT",4100,1,7,0)
	;;=printed) or selective claims.  You also have the option to update the 
	;;^UTILITY(U,$J,"OPT",4100,1,8,0)
	;;=expiration date.  (You would want to update the expiration date if the 
	;;^UTILITY(U,$J,"OPT",4100,1,9,0)
	;;=original letters were never mailed, in the case of hardware problems.)
	;;^UTILITY(U,$J,"OPT",4100,25)
	;;=REPRINT^FBUCLET
	;;^UTILITY(U,$J,"OPT",4100,99)
	;;=55686,68126
	;;^UTILITY(U,$J,"OPT",4100,"U")
	;;=REPRINT LETTER(S)
	;;^UTILITY(U,$J,"OPT",4110,0)
	;;=FBCH UC COST REPORT^Unauthorized Claims Cost Report for Civil Hospital^^R^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",4110,1,0)
	;;=^^5^5^2930628^
	;;^UTILITY(U,$J,"OPT",4110,1,1,0)
	;;=Output report to display the unauthorized claims payments for Civil Hospital
	;;^UTILITY(U,$J,"OPT",4110,1,2,0)
	;;=for a user date range selected.  Report does not list any payment which
	;;^UTILITY(U,$J,"OPT",4110,1,3,0)
	;;=does not have a date finalized.  Output includes both payments and
	;;^UTILITY(U,$J,"OPT",4110,1,4,0)
	;;=ancillary payments sorted by treating specialty.  Included in output is
	;;^UTILITY(U,$J,"OPT",4110,1,5,0)
	;;=the Patient ID, Date Claim Received, Amount Paid, Final DRG and LOS.
	;;^UTILITY(U,$J,"OPT",4110,20)
	;;=S FBTP=6,FBREF="FB583"
	;;^UTILITY(U,$J,"OPT",4110,25)
	;;=FBCHCR
	;;^UTILITY(U,$J,"OPT",4110,"U")
	;;=UNAUTHORIZED CLAIMS COST REPOR
	;;^UTILITY(U,$J,"OPT",4111,0)
	;;=FBAA PAYMENT HISTORY DISPLAY^Payment History Display^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4111,1,0)
	;;=^^3^3^2940429^^^^
	;;^UTILITY(U,$J,"OPT",4111,1,1,0)
	;;=This option will display eligibility, disabilities, insurance
	;;^UTILITY(U,$J,"OPT",4111,1,2,0)
	;;=information, authorizations and medical payment information
	;;^UTILITY(U,$J,"OPT",4111,1,3,0)
	;;=for a patient.
	;;^UTILITY(U,$J,"OPT",4111,25)
	;;=FBAAPH
	;;^UTILITY(U,$J,"OPT",4111,"U")
	;;=PAYMENT HISTORY DISPLAY
	;;^UTILITY(U,$J,"OPT",4112,0)
	;;=FBAA PHARMACY HISTORY^List Pharmacy History^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4112,1,0)
	;;=^^1^1^2930720^^
	;;^UTILITY(U,$J,"OPT",4112,1,1,0)
	;;=Lists the Fee Basis prescriptions for a selected patient.

FBINI04L
FBINI04L	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4112,25)
	;;=FBAAPPH
	;;^UTILITY(U,$J,"OPT",4112,"U")
	;;=LIST PHARMACY HISTORY
	;;^UTILITY(U,$J,"OPT",4113,0)
	;;=FBUC DELETE UNAUTHORIZED CLAIM^Delete Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4113,1,0)
	;;=^^6^6^2930702^
	;;^UTILITY(U,$J,"OPT",4113,1,1,0)
	;;=This options allows you to delete unauthorized claims which have not been
	;;^UTILITY(U,$J,"OPT",4113,1,2,0)
	;;=dispositioned.  Dispostioned claims should edited to a disposition status 
	;;^UTILITY(U,$J,"OPT",4113,1,3,0)
	;;=of Canceled/Withdrawn.
	;;^UTILITY(U,$J,"OPT",4113,1,4,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4113,1,5,0)
	;;=If an unauthorized claim is deleted, any pending information on file is
	;;^UTILITY(U,$J,"OPT",4113,1,6,0)
	;;=also deleted.
	;;^UTILITY(U,$J,"OPT",4113,25)
	;;=DEL^FBUCED1
	;;^UTILITY(U,$J,"OPT",4113,99)
	;;=55734,55541
	;;^UTILITY(U,$J,"OPT",4113,"U")
	;;=DELETE UNAUTHORIZED CLAIM
	;;^UTILITY(U,$J,"OPT",4118,0)
	;;=FBAA BATCH DELETE^Batch Delete^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4118,1,0)
	;;=^^8^8^2930723^^
	;;^UTILITY(U,$J,"OPT",4118,1,1,0)
	;;=This option allows the user who opened a batch, or any user who holds
	;;^UTILITY(U,$J,"OPT",4118,1,2,0)
	;;=the 'FBAASUPERVISOR' security key, the ability to delete a batch from
	;;^UTILITY(U,$J,"OPT",4118,1,3,0)
	;;=the system.  The batch must meet the following criteria in order
	;;^UTILITY(U,$J,"OPT",4118,1,4,0)
	;;=to be deleted.
	;;^UTILITY(U,$J,"OPT",4118,1,5,0)
	;;=    1. Total Dollars equal zero
	;;^UTILITY(U,$J,"OPT",4118,1,6,0)
	;;=    2. Invoice Count equal zero
	;;^UTILITY(U,$J,"OPT",4118,1,7,0)
	;;=    3. Payment Line Count equal zero
	;;^UTILITY(U,$J,"OPT",4118,1,8,0)
	;;=    4. Rejects Pending flag not set to yes
	;;^UTILITY(U,$J,"OPT",4118,25)
	;;=FBAABDL
	;;^UTILITY(U,$J,"OPT",4118,"U")
	;;=BATCH DELETE
	;;^UTILITY(U,$J,"OPT",4123,0)
	;;=FBAA FMS UPDATE^Update FMS Vendor File in Austin^^R^^FBAASUPERVISOR^^^^^^
	;;^UTILITY(U,$J,"OPT",4123,1,0)
	;;=^^13^13^2930816^^^
	;;^UTILITY(U,$J,"OPT",4123,1,1,0)
	;;=This option creates a Master Record Adjustment (MRA) transaction which
	;;^UTILITY(U,$J,"OPT",4123,1,2,0)
	;;=results in the updating of selected vendor demographic data in the FMS
	;;^UTILITY(U,$J,"OPT",4123,1,3,0)
	;;=vendor file in Austin.
	;;^UTILITY(U,$J,"OPT",4123,1,4,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4123,1,5,0)
	;;=This option should only be used if a vendor entry is correctly entered into
	;;^UTILITY(U,$J,"OPT",4123,1,6,0)
	;;=the DHCP Fee Basis Vendor file but needs to update the FMS vendor file
	;;^UTILITY(U,$J,"OPT",4123,1,7,0)
	;;=with the appropriate information.
	;;^UTILITY(U,$J,"OPT",4123,1,8,0)
	;;= (NOTE:  The vendor may not exist on the FMS system or may exist, but
	;;^UTILITY(U,$J,"OPT",4123,1,9,0)
	;;=         the information does not reflect accurate information.)
	;;^UTILITY(U,$J,"OPT",4123,1,10,0)
	;;=  
	;;^UTILITY(U,$J,"OPT",4123,1,11,0)
	;;=Use of this option should update the FMS vendor file to reflect what is
	;;^UTILITY(U,$J,"OPT",4123,1,12,0)
	;;=currently in the DHCP system.  Information at all other VA Medical Centers
	;;^UTILITY(U,$J,"OPT",4123,1,13,0)
	;;=using this vendor will also be updated.
	;;^UTILITY(U,$J,"OPT",4123,25)
	;;=UPDATE^FBAAAV
	;;^UTILITY(U,$J,"OPT",4123,99)
	;;=55743,65034
	;;^UTILITY(U,$J,"OPT",4123,"U")
	;;=UPDATE FMS VENDOR FILE IN AUST
	;;^UTILITY(U,$J,"OPT",4125,0)
	;;=FBCNH UPDATE VENDOR CONTRACT^Update Vendor Contract/Rates - CNH^^R^^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",4125,1,0)
	;;=^^2^2^2930822^
	;;^UTILITY(U,$J,"OPT",4125,1,1,0)
	;;=This option allows the user to enter/edit Community Nursing Home
	;;^UTILITY(U,$J,"OPT",4125,1,2,0)
	;;=vendor contracts and rates.
	;;^UTILITY(U,$J,"OPT",4125,15)
	;;=K FBCIEN,FBCNUM,FBEXDT,FBEXNDT,FBX
	;;^UTILITY(U,$J,"OPT",4125,25)
	;;=GETVEN^FBAAVD2
	;;^UTILITY(U,$J,"OPT",4125,99)
	;;=55797,39877
	;;^UTILITY(U,$J,"OPT",4125,"U")
	;;=UPDATE VENDOR CONTRACT/RATES -
	;;^UTILITY(U,$J,"OPT",4172,0)
	;;=FBUC DISASSOCIATE^Disassociate an Unauthorized Claim^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4172,1,0)
	;;=^^2^2^2930911^
	;;^UTILITY(U,$J,"OPT",4172,1,1,0)
	;;=This option will allow you to disassociate an unauthorized claim which

FBINI04M
FBINI04M	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4172,1,2,0)
	;;=has been associated to others.
	;;^UTILITY(U,$J,"OPT",4172,25)
	;;=DISASSOC^FBUCLINK
	;;^UTILITY(U,$J,"OPT",4172,"U")
	;;=DISASSOCIATE AN UNAUTHORIZED C
	;;^UTILITY(U,$J,"OPT",4173,0)
	;;=FBUC RETURN ADDRESS DIS/ED^Return Address Display/Edit^^R^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",4173,1,0)
	;;=^^3^3^2930911^
	;;^UTILITY(U,$J,"OPT",4173,1,1,0)
	;;=This option will display the return address which will appear on an
	;;^UTILITY(U,$J,"OPT",4173,1,2,0)
	;;=Unauthorized Claim letter, if letterhead is not used.  You can also edit
	;;^UTILITY(U,$J,"OPT",4173,1,3,0)
	;;=the return address using this option.
	;;^UTILITY(U,$J,"OPT",4173,25)
	;;=RETURN^FBUCDIS
	;;^UTILITY(U,$J,"OPT",4173,"U")
	;;=RETURN ADDRESS DISPLAY/EDIT
	;;^UTILITY(U,$J,"OPT",4175,0)
	;;=FBCH CENSUS REPORT^Civil Hospital Census Report^^R^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",4175,1,0)
	;;=^^4^4^2930915^
	;;^UTILITY(U,$J,"OPT",4175,1,1,0)
	;;=This output provides a listing for all Civil Hospital patients
	;;^UTILITY(U,$J,"OPT",4175,1,2,0)
	;;=for a user specified census date.  Output includes the vendor name and
	;;^UTILITY(U,$J,"OPT",4175,1,3,0)
	;;=Participation Code, veteran specifics such as DOB and ID, as well as
	;;^UTILITY(U,$J,"OPT",4175,1,4,0)
	;;=the Primary Service Area and the Authorization To Date.
	;;^UTILITY(U,$J,"OPT",4175,20)
	;;=S FBI=6
	;;^UTILITY(U,$J,"OPT",4175,25)
	;;=FBCNHCEN
	;;^UTILITY(U,$J,"OPT",4175,"U")
	;;=CIVIL HOSPITAL CENSUS REPORT
	;;^UTILITY(U,$J,"OPT",4177,0)
	;;=FBAA MRA'S AWAITING APPROVAL^MRA'S Awaiting Austin Approval^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4177,1,0)
	;;=5
	;;^UTILITY(U,$J,"OPT",4177,1,1,0)
	;;=This option will output the vendors that have an MRA action pending, and
	;;^UTILITY(U,$J,"OPT",4177,1,2,0)
	;;=therefore are still awaiting Austin approval.  The output lists the
	;;^UTILITY(U,$J,"OPT",4177,1,3,0)
	;;=vendor and the date the MRA was transmitted to Austin.  Records with
	;;^UTILITY(U,$J,"OPT",4177,1,4,0)
	;;=no date transmitted indicate an MRA has just been initiated, but the
	;;^UTILITY(U,$J,"OPT",4177,1,5,0)
	;;=transmission has not left the local station yet.
	;;^UTILITY(U,$J,"OPT",4177,25)
	;;=FBAAPV
	;;^UTILITY(U,$J,"OPT",4177,"U")
	;;=MRA'S AWAITING AUSTIN APPROVAL
	;;^UTILITY(U,$J,"OPT",4541,0)
	;;=FBAA PAID SERVER^Fee Basis Payment Message Server^^S^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"OPT",4541,1,0)
	;;=^^2^2^2940629^^^
	;;^UTILITY(U,$J,"OPT",4541,1,1,0)
	;;=This server processes incoming payment information sent from
	;;^UTILITY(U,$J,"OPT",4541,1,2,0)
	;;=FMS.
	;;^UTILITY(U,$J,"OPT",4541,25)
	;;=FBPAID
	;;^UTILITY(U,$J,"OPT",4541,220)
	;;=^R^FEE^^N^N
	;;^UTILITY(U,$J,"OPT",4541,"U")
	;;=FEE BASIS PAYMENT MESSAGE SERV
	;;^UTILITY(U,$J,"OPT",4607,0)
	;;=FB CHECK DISPLAY^Check Display^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4607,1,0)
	;;=^^3^3^2940629^^
	;;^UTILITY(U,$J,"OPT",4607,1,1,0)
	;;=This option will display all payments included on a check that was
	;;^UTILITY(U,$J,"OPT",4607,1,2,0)
	;;=issued after the payment conversion from CALM to the Financial
	;;^UTILITY(U,$J,"OPT",4607,1,3,0)
	;;=Management System.
	;;^UTILITY(U,$J,"OPT",4607,25)
	;;=FBCKDIS
	;;^UTILITY(U,$J,"OPT",4607,"U")
	;;=CHECK DISPLAY
	;;^UTILITY(U,$J,"OPT",4623,0)
	;;=FBCNH RCS 10-0168 REPORT^Nursing Home 10-0168 Report^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4623,1,0)
	;;=^^2^2^2940718^^
	;;^UTILITY(U,$J,"OPT",4623,1,1,0)
	;;=This option will generate the data for the Community Nursing Home
	;;^UTILITY(U,$J,"OPT",4623,1,2,0)
	;;=Code sheet 10-0168.  This is the old RCS 18-3 report.
	;;^UTILITY(U,$J,"OPT",4623,25)
	;;=FBNHRCS
	;;^UTILITY(U,$J,"OPT",4623,"U")
	;;=NURSING HOME 10-0168 REPORT
	;;^UTILITY(U,$J,"OPT",4624,0)
	;;=FB PHONE MENU^Telephone Inquiry Menu^^M^^^^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4624,1,0)
	;;=^^2^2^2940804^^^
	;;^UTILITY(U,$J,"OPT",4624,1,1,0)
	;;=This menu is designed to contain all options that are used to answer
	;;^UTILITY(U,$J,"OPT",4624,1,2,0)
	;;=inquiries from vendors and/or veterans regarding payments or checks.
	;;^UTILITY(U,$J,"OPT",4624,10,0)
	;;=^19.01IP^4^4

FBINI04N
FBINI04N	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4624,10,1,0)
	;;=4607
	;;^UTILITY(U,$J,"OPT",4624,10,1,"^")
	;;=FB CHECK DISPLAY
	;;^UTILITY(U,$J,"OPT",4624,10,2,0)
	;;=4625
	;;^UTILITY(U,$J,"OPT",4624,10,2,"^")
	;;=FB VENDOR/VETERAN PAYMENTS
	;;^UTILITY(U,$J,"OPT",4624,10,3,0)
	;;=4042
	;;^UTILITY(U,$J,"OPT",4624,10,3,"^")
	;;=FB PAY VENDOR
	;;^UTILITY(U,$J,"OPT",4624,10,4,0)
	;;=4043
	;;^UTILITY(U,$J,"OPT",4624,10,4,"^")
	;;=FB PAY VETERAN
	;;^UTILITY(U,$J,"OPT",4624,15)
	;;=
	;;^UTILITY(U,$J,"OPT",4624,20)
	;;=
	;;^UTILITY(U,$J,"OPT",4624,99)
	;;=56204,45675
	;;^UTILITY(U,$J,"OPT",4624,"U")
	;;=TELEPHONE INQUIRY MENU
	;;^UTILITY(U,$J,"OPT",4625,0)
	;;=FB VENDOR/VETERAN PAYMENTS^Payment Listing for Vendor/Veteran^^A^^^^^^^^^^1^1
	;;^UTILITY(U,$J,"OPT",4625,1,0)
	;;=^^4^4^2940804^
	;;^UTILITY(U,$J,"OPT",4625,1,1,0)
	;;=This option will prompt the user to select the vendor calling, and the
	;;^UTILITY(U,$J,"OPT",4625,1,2,0)
	;;=veteran information is requested upon.  It will then call in to list
	;;^UTILITY(U,$J,"OPT",4625,1,3,0)
	;;=manager to display a listing of payments for all programs in the order
	;;^UTILITY(U,$J,"OPT",4625,1,4,0)
	;;=of date service provided (with the most recent displaying first).
	;;^UTILITY(U,$J,"OPT",4625,15)
	;;=K DFN,FBV
	;;^UTILITY(U,$J,"OPT",4625,20)
	;;=K XQORS,VALMEVL D ^FBPHON,EN^VALM("FBPHONE MENU")
	;;^UTILITY(U,$J,"OPT",4625,"U")
	;;=PAYMENT LISTING FOR VENDOR/VET
	;;^UTILITY(U,$J,"OPT",4780,0)
	;;=FBCH MULTIPLE PAYMENTS^Multiple Ancillary Payments^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4780,1,0)
	;;=^^3^3^2940919^^
	;;^UTILITY(U,$J,"OPT",4780,1,1,0)
	;;=This option is used to enter identical ancillary services incurred while
	;;^UTILITY(U,$J,"OPT",4780,1,2,0)
	;;=in a Non-VA Hospital for a specific patient and vendor.  Only the date of
	;;^UTILITY(U,$J,"OPT",4780,1,3,0)
	;;=service may differ.
	;;^UTILITY(U,$J,"OPT",4780,25)
	;;=ANCIL^FBAAMP
	;;^UTILITY(U,$J,"OPT",4780,"U")
	;;=MULTIPLE ANCILLARY PAYMENTS
	;;^UTILITY(U,$J,"OPT",4781,0)
	;;=FBAA SUSPENSION LETTER INDIV^Individual Suspension Letter Print^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4781,1,0)
	;;=^^2^2^2940919^^^
	;;^UTILITY(U,$J,"OPT",4781,1,1,0)
	;;=This option allows printing of the suspension letters for an individual
	;;^UTILITY(U,$J,"OPT",4781,1,2,0)
	;;=patient and/or vendor.
	;;^UTILITY(U,$J,"OPT",4781,25)
	;;=INDIV^FBAASL
	;;^UTILITY(U,$J,"OPT",4781,"U")
	;;=INDIVIDUAL SUSPENSION LETTER P
	;;^UTILITY(U,$J,"OPT",4782,0)
	;;=FBAA AUTHORIZATION DISPLAY^Authorization Display^^R^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4782,1,0)
	;;=^^3^3^2941006^^
	;;^UTILITY(U,$J,"OPT",4782,1,1,0)
	;;=This option displays an authorization on screen for a user specified
	;;^UTILITY(U,$J,"OPT",4782,1,2,0)
	;;=authorization number.  The authorization number appears on the printed
	;;^UTILITY(U,$J,"OPT",4782,1,3,0)
	;;=7079.
	;;^UTILITY(U,$J,"OPT",4782,25)
	;;=FBAUTHP
	;;^UTILITY(U,$J,"OPT",4782,"U")
	;;=AUTHORIZATION DISPLAY
	;;^UTILITY(U,$J,"OR",60,0)
	;;=60^FB
	;;^UTILITY(U,$J,"OR",60,1,0)
	;;=^100.9951PA^11^11
	;;^UTILITY(U,$J,"OR",60,1,1,0)
	;;=FB BATCH STATUS
	;;^UTILITY(U,$J,"OR",60,1,2,0)
	;;=FB INVOICE DISPLAY
	;;^UTILITY(U,$J,"OR",60,1,3,0)
	;;=FB DISPLAY VENDOR
	;;^UTILITY(U,$J,"OR",60,1,4,0)
	;;=FB LIST BATCH
	;;^UTILITY(U,$J,"OR",60,1,5,0)
	;;=FB DISPLAY AUTHORIZATION
	;;^UTILITY(U,$J,"OR",60,1,6,0)
	;;=FB PHONE MENU
	;;^UTILITY(U,$J,"OR",60,1,7,0)
	;;=FB CHANGE VENDOR
	;;^UTILITY(U,$J,"OR",60,1,8,0)
	;;=FB CHANGE VETERAN
	;;^UTILITY(U,$J,"OR",60,1,9,0)
	;;=FB DISPLAY CHECK
	;;^UTILITY(U,$J,"OR",60,1,10,0)
	;;=FB EXPAND VIEW
	;;^UTILITY(U,$J,"OR",60,1,11,0)
	;;=FB CPT DESCRIPTION
	;;^UTILITY(U,$J,"OR",60,5,0)
	;;=^100.9955
	;;^UTILITY(U,$J,"PKG",60,0)
	;;=FEE BASIS^FB^Used to pay private vendors
	;;^UTILITY(U,$J,"PKG",60,1,0)
	;;=^^9^9^2950117^^^^
	;;^UTILITY(U,$J,"PKG",60,1,1,0)
	;;=System used by Medical Administration service to process and pay 
	;;^UTILITY(U,$J,"PKG",60,1,2,0)
	;;=invoices from private vendors for authorized procedures provided
	;;^UTILITY(U,$J,"PKG",60,1,3,0)
	;;=to veterans. Initial version will include the the processing of

FBINI04O
FBINI04O	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PKG",60,1,4,0)
	;;=Hometown Pharmacy, Patient Travel, and Outpatient Medical claims.
	;;^UTILITY(U,$J,"PKG",60,1,5,0)
	;;=Version 2 includes Contract Hospital and Community Nursing Home.
	;;^UTILITY(U,$J,"PKG",60,1,6,0)
	;;=Unauthorized claims has been added in version 3.  Also in this
	;;^UTILITY(U,$J,"PKG",60,1,7,0)
	;;=version is an update to the vendor file for the conversion of
	;;^UTILITY(U,$J,"PKG",60,1,8,0)
	;;=CALM to FMS in Austin.  The Community Nursing Home has been
	;;^UTILITY(U,$J,"PKG",60,1,9,0)
	;;=modified to handle multiple rates.
	;;^UTILITY(U,$J,"PKG",60,2,0)
	;;=^9.42A^^0
	;;^UTILITY(U,$J,"PKG",60,4,0)
	;;=^9.44PA^44^33
	;;^UTILITY(U,$J,"PKG",60,4,1,0)
	;;=161
	;;^UTILITY(U,$J,"PKG",60,4,1,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,2,0)
	;;=161.2
	;;^UTILITY(U,$J,"PKG",60,4,2,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,3,0)
	;;=161.25
	;;^UTILITY(U,$J,"PKG",60,4,3,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,5,0)
	;;=161.6
	;;^UTILITY(U,$J,"PKG",60,4,5,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,6,0)
	;;=161.7
	;;^UTILITY(U,$J,"PKG",60,4,6,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,7,0)
	;;=161.8
	;;^UTILITY(U,$J,"PKG",60,4,7,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,8,0)
	;;=161.81
	;;^UTILITY(U,$J,"PKG",60,4,8,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,9,0)
	;;=161.82
	;;^UTILITY(U,$J,"PKG",60,4,9,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,10,0)
	;;=161.83
	;;^UTILITY(U,$J,"PKG",60,4,10,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,11,0)
	;;=162
	;;^UTILITY(U,$J,"PKG",60,4,11,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,12,0)
	;;=162.1
	;;^UTILITY(U,$J,"PKG",60,4,12,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,15,0)
	;;=161.4
	;;^UTILITY(U,$J,"PKG",60,4,15,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,16,0)
	;;=161.26
	;;^UTILITY(U,$J,"PKG",60,4,16,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,17,0)
	;;=161.27
	;;^UTILITY(U,$J,"PKG",60,4,17,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,21,0)
	;;=161.3
	;;^UTILITY(U,$J,"PKG",60,4,21,222)
	;;=y^y^^n^^^y^m^n
	;;^UTILITY(U,$J,"PKG",60,4,27,0)
	;;=162.5
	;;^UTILITY(U,$J,"PKG",60,4,27,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,28,0)
	;;=162.2
	;;^UTILITY(U,$J,"PKG",60,4,28,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,29,0)
	;;=162.3
	;;^UTILITY(U,$J,"PKG",60,4,29,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,30,0)
	;;=163.99
	;;^UTILITY(U,$J,"PKG",60,4,30,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,31,0)
	;;=162.4
	;;^UTILITY(U,$J,"PKG",60,4,31,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,32,0)
	;;=162.6
	;;^UTILITY(U,$J,"PKG",60,4,32,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,33,0)
	;;=161.5
	;;^UTILITY(U,$J,"PKG",60,4,33,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,34,0)
	;;=162.7
	;;^UTILITY(U,$J,"PKG",60,4,34,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,35,0)
	;;=163.85
	;;^UTILITY(U,$J,"PKG",60,4,35,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,36,0)
	;;=161.21
	;;^UTILITY(U,$J,"PKG",60,4,36,222)
	;;=y^y^^n^^^n
	;;^UTILITY(U,$J,"PKG",60,4,37,0)
	;;=161.22
	;;^UTILITY(U,$J,"PKG",60,4,37,222)
	;;=y^y^^n^^^n
	;;^UTILITY(U,$J,"PKG",60,4,38,0)
	;;=161.23
	;;^UTILITY(U,$J,"PKG",60,4,38,222)
	;;=y^y^^n^^^n
	;;^UTILITY(U,$J,"PKG",60,4,39,0)
	;;=162.8
	;;^UTILITY(U,$J,"PKG",60,4,39,222)
	;;=y^y^^n^^^n
	;;^UTILITY(U,$J,"PKG",60,4,40,0)
	;;=162.91
	;;^UTILITY(U,$J,"PKG",60,4,40,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,41,0)
	;;=162.92
	;;^UTILITY(U,$J,"PKG",60,4,41,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,42,0)
	;;=162.93
	;;^UTILITY(U,$J,"PKG",60,4,42,222)
	;;=y^y^^n^^^n^^
	;;^UTILITY(U,$J,"PKG",60,4,43,0)
	;;=162.94
	;;^UTILITY(U,$J,"PKG",60,4,43,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,44,0)
	;;=162.95
	;;^UTILITY(U,$J,"PKG",60,4,44,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",60,4,"B",161,1)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.2,2)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.21,36)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.22,37)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.23,38)
	;;=

FBINI04P
FBINI04P	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.25,3)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.26,16)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.27,17)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.3,21)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.4,15)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.5,33)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.6,5)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.7,6)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.8,7)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.81,8)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.82,9)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",161.83,10)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162,11)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.1,12)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.2,28)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.3,29)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.4,31)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.5,27)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.6,32)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.7,34)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.8,39)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.91,40)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.92,41)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.93,42)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.94,43)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",162.95,44)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",163.85,35)
	;;=
	;;^UTILITY(U,$J,"PKG",60,4,"B",163.99,30)
	;;=
	;;^UTILITY(U,$J,"PKG",60,5)
	;;=ALBANY
	;;^UTILITY(U,$J,"PKG",60,7)
	;;=ALBANY^^I
	;;^UTILITY(U,$J,"PKG",60,8,0)
	;;=^9.404ID
	;;^UTILITY(U,$J,"PKG",60,9)
	;;=503^
	;;^UTILITY(U,$J,"PKG",60,11)
	;;=161^163.99
	;;^UTILITY(U,$J,"PKG",60,22,0)
	;;=^9.49I^30^35
	;;^UTILITY(U,$J,"PKG",60,22,1,0)
	;;=1^2860415^2870507
	;;^UTILITY(U,$J,"PKG",60,22,1.1,0)
	;;=1.1^2880608
	;;^UTILITY(U,$J,"PKG",60,22,1.11,0)
	;;=1.11^2880712
	;;^UTILITY(U,$J,"PKG",60,22,1.12,0)
	;;=1.12^2881013
	;;^UTILITY(U,$J,"PKG",60,22,1.13,0)
	;;=1.13
	;;^UTILITY(U,$J,"PKG",60,22,1.99,0)
	;;=1.99^2910206^2900926
	;;^UTILITY(U,$J,"PKG",60,22,2,0)
	;;=2.0^2910212
	;;^UTILITY(U,$J,"PKG",60,22,2.1,0)
	;;=2.1^2910225
	;;^UTILITY(U,$J,"PKG",60,22,4,0)
	;;=3.0T1^2930410
	;;^UTILITY(U,$J,"PKG",60,22,5,0)
	;;=3.0T2^2930415
	;;^UTILITY(U,$J,"PKG",60,22,6,0)
	;;=3.0T3^2930423
	;;^UTILITY(U,$J,"PKG",60,22,7,0)
	;;=3.0T4^2930429
	;;^UTILITY(U,$J,"PKG",60,22,8,0)
	;;=3.0T5^2930517
	;;^UTILITY(U,$J,"PKG",60,22,9,0)
	;;=3.0T6^2930524
	;;^UTILITY(U,$J,"PKG",60,22,10,0)
	;;=3.0T7^2930602
	;;^UTILITY(U,$J,"PKG",60,22,11,0)
	;;=3.0T8^2930614
	;;^UTILITY(U,$J,"PKG",60,22,12,0)
	;;=3.0T9^2930709
	;;^UTILITY(U,$J,"PKG",60,22,13,0)
	;;=3.0V1^2930731
	;;^UTILITY(U,$J,"PKG",60,22,14,0)
	;;=3.0V2^2930819
	;;^UTILITY(U,$J,"PKG",60,22,15,0)
	;;=3.0V3^2930917
	;;^UTILITY(U,$J,"PKG",60,22,16,0)
	;;=3.0V4^2931004
	;;^UTILITY(U,$J,"PKG",60,22,17,0)
	;;=3.0V5^2931015
	;;^UTILITY(U,$J,"PKG",60,22,18,0)
	;;=3.0^2931126
	;;^UTILITY(U,$J,"PKG",60,22,19,0)
	;;=3.5T1^2940609
	;;^UTILITY(U,$J,"PKG",60,22,20,0)
	;;=3.5T2^2940622
	;;^UTILITY(U,$J,"PKG",60,22,21,0)
	;;=3.5T3^2940629
	;;^UTILITY(U,$J,"PKG",60,22,22,0)
	;;=3.5T4^2940713
	;;^UTILITY(U,$J,"PKG",60,22,23,0)
	;;=3.5T5^2940729
	;;^UTILITY(U,$J,"PKG",60,22,24,0)
	;;=3.5T6^2940805
	;;^UTILITY(U,$J,"PKG",60,22,25,0)
	;;=3.5T7^2941011
	;;^UTILITY(U,$J,"PKG",60,22,26,0)
	;;=3.5V1^2941012
	;;^UTILITY(U,$J,"PKG",60,22,27,0)
	;;=3.5V2^2941201
	;;^UTILITY(U,$J,"PKG",60,22,28,0)
	;;=3.5V3^2941221
	;;^UTILITY(U,$J,"PKG",60,22,29,0)
	;;=3.5V4^2950112
	;;^UTILITY(U,$J,"PKG",60,22,30,0)
	;;=3.5^2950130
	;;^UTILITY(U,$J,"PKG",60,22,"B",1,1)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B",1.1,1.1)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B",1.11,1.11)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B",1.12,1.12)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B",1.13,1.13)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B",1.99,1.99)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B",2.1,2.1)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B",3.5,30)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","2.0",2)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0",18)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T1",4)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T2",5)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T3",6)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T4",7)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T5",8)
	;;=

FBINI04Q
FBINI04Q	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T6",9)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T7",10)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T8",11)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0T9",12)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0V1",13)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0V2",14)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0V3",15)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0V4",16)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.0V5",17)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5T1",19)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5T2",20)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5T3",21)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5T4",22)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5T5",23)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5T6",24)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5T7",25)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5V1",26)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5V2",27)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5V3",28)
	;;=
	;;^UTILITY(U,$J,"PKG",60,22,"B","3.5V4",29)
	;;=
	;;^UTILITY(U,$J,"PKG",60,"DEV")
	;;=D. Kaplon/T. Tanous/C. Rhodes Albany ISC
	;;^UTILITY(U,$J,"PKG",60,"DIE",0)
	;;=^9.47^1^1
	;;^UTILITY(U,$J,"PKG",60,"DIE",1,0)
	;;=FBAA ADDRESS EDIT^2
	;;^UTILITY(U,$J,"PKG",60,"EX",0)
	;;=^9.432^2^2
	;;^UTILITY(U,$J,"PKG",60,"EX",1,0)
	;;=FBAAZ
	;;^UTILITY(U,$J,"PKG",60,"EX",2,0)
	;;=FBZ
	;;^UTILITY(U,$J,"PKG",60,"INI")
	;;=^
	;;^UTILITY(U,$J,"PKG",60,"INIT")
	;;=FBPST35^
	;;^UTILITY(U,$J,"PKG",60,"PRE")
	;;=FBPRE35^
	;;^UTILITY(U,$J,"PKG",60,"ST",0)
	;;=^9.444D^2930312^3
	;;^UTILITY(U,$J,"PKG",60,"ST",2880304,0)
	;;=2880304
	;;^UTILITY(U,$J,"PKG",60,"ST",2880608,0)
	;;=2880608
	;;^UTILITY(U,$J,"PKG",60,"ST",2930312,0)
	;;=2930312
	;;^UTILITY(U,$J,"SBF",161,161)
	;;=
	;;^UTILITY(U,$J,"SBF",161,161.01)
	;;=
	;;^UTILITY(U,$J,"SBF",161,161.02)
	;;=
	;;^UTILITY(U,$J,"SBF",161,161.04)
	;;=
	;;^UTILITY(U,$J,"SBF",161,161.06)
	;;=
	;;^UTILITY(U,$J,"SBF",161.2,161.2)
	;;=
	;;^UTILITY(U,$J,"SBF",161.21,161.21)
	;;=
	;;^UTILITY(U,$J,"SBF",161.22,161.22)
	;;=
	;;^UTILITY(U,$J,"SBF",161.23,161.23)
	;;=
	;;^UTILITY(U,$J,"SBF",161.25,161.25)
	;;=
	;;^UTILITY(U,$J,"SBF",161.26,161.26)
	;;=
	;;^UTILITY(U,$J,"SBF",161.27,161.27)
	;;=
	;;^UTILITY(U,$J,"SBF",161.27,161.28)
	;;=
	;;^UTILITY(U,$J,"SBF",161.3,161.3)
	;;=
	;;^UTILITY(U,$J,"SBF",161.3,161.31)
	;;=
	;;^UTILITY(U,$J,"SBF",161.3,161.32)
	;;=
	;;^UTILITY(U,$J,"SBF",161.4,161.4)
	;;=
	;;^UTILITY(U,$J,"SBF",161.4,161.428)
	;;=
	;;^UTILITY(U,$J,"SBF",161.5,161.5)
	;;=
	;;^UTILITY(U,$J,"SBF",161.5,161.517)
	;;=
	;;^UTILITY(U,$J,"SBF",161.5,161.5171)
	;;=
	;;^UTILITY(U,$J,"SBF",161.6,161.6)
	;;=
	;;^UTILITY(U,$J,"SBF",161.7,161.7)
	;;=
	;;^UTILITY(U,$J,"SBF",161.8,161.8)
	;;=
	;;^UTILITY(U,$J,"SBF",161.81,161.81)
	;;=
	;;^UTILITY(U,$J,"SBF",161.82,161.82)
	;;=
	;;^UTILITY(U,$J,"SBF",161.82,161.821)
	;;=
	;;^UTILITY(U,$J,"SBF",161.83,161.83)
	;;=
	;;^UTILITY(U,$J,"SBF",161.83,161.831)
	;;=
	;;^UTILITY(U,$J,"SBF",162,162)
	;;=
	;;^UTILITY(U,$J,"SBF",162,162.01)
	;;=
	;;^UTILITY(U,$J,"SBF",162,162.02)
	;;=
	;;^UTILITY(U,$J,"SBF",162,162.03)
	;;=
	;;^UTILITY(U,$J,"SBF",162,162.04)
	;;=
	;;^UTILITY(U,$J,"SBF",162,162.05)
	;;=
	;;^UTILITY(U,$J,"SBF",162,162.099)
	;;=
	;;^UTILITY(U,$J,"SBF",162.1,162.1)
	;;=
	;;^UTILITY(U,$J,"SBF",162.1,162.11)
	;;=
	;;^UTILITY(U,$J,"SBF",162.1,162.12)
	;;=
	;;^UTILITY(U,$J,"SBF",162.2,162.2)
	;;=
	;;^UTILITY(U,$J,"SBF",162.2,162.215)
	;;=
	;;^UTILITY(U,$J,"SBF",162.3,162.3)
	;;=
	;;^UTILITY(U,$J,"SBF",162.4,162.4)
	;;=
	;;^UTILITY(U,$J,"SBF",162.4,162.47)
	;;=
	;;^UTILITY(U,$J,"SBF",162.5,162.5)
	;;=
	;;^UTILITY(U,$J,"SBF",162.5,162.518)
	;;=
	;;^UTILITY(U,$J,"SBF",162.6,162.6)
	;;=
	;;^UTILITY(U,$J,"SBF",162.7,162.7)
	;;=
	;;^UTILITY(U,$J,"SBF",162.7,162.715)
	;;=
	;;^UTILITY(U,$J,"SBF",162.7,162.716)
	;;=
	;;^UTILITY(U,$J,"SBF",162.7,162.717)
	;;=
	;;^UTILITY(U,$J,"SBF",162.8,162.8)
	;;=
	;;^UTILITY(U,$J,"SBF",162.91,162.91)
	;;=
	;;^UTILITY(U,$J,"SBF",162.91,162.911)
	;;=
	;;^UTILITY(U,$J,"SBF",162.92,162.92)
	;;=
	;;^UTILITY(U,$J,"SBF",162.92,162.921)
	;;=
	;;^UTILITY(U,$J,"SBF",162.93,162.93)
	;;=
	;;^UTILITY(U,$J,"SBF",162.93,162.931)
	;;=
	;;^UTILITY(U,$J,"SBF",162.94,162.94)
	;;=

FBINI04R
FBINI04R	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"SBF",162.94,162.941)
	;;=
	;;^UTILITY(U,$J,"SBF",162.95,162.95)
	;;=
	;;^UTILITY(U,$J,"SBF",163.85,163.85)
	;;=
	;;^UTILITY(U,$J,"SBF",163.85,163.851)
	;;=
	;;^UTILITY(U,$J,"SBF",163.99,163.99)
	;;=
	;;^UTILITY(U,$J,"SBF",163.99,163.991)
	;;=

FBINIS
FBINIS	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PAC(PKG,VER)	; called from package init (DIFROM7 created this routine)
	; PKG = $T(IXF) of the INIT routine.
	; VER is an array that is contained in DIFROM from the INIT routine
	;
	N %,%I,%H,DATE,DIFROM,NOW,PACKAGE,RUN,SERVER,SITE,START,X,XMDUZ,XMSUB,XMTEXT,XMY,Y K ^TMP("FBINIS",$J)
	;
	; Site tracking updates only occur if run in a VA production primary domain
	; account.
	I $G(^XMB("NETNAME"))'[".VA.GOV" Q
	Q:'$D(^%ZOSF("UCI"))  Q:'$D(^%ZOSF("PROD"))
	X ^%ZOSF("UCI") I Y'=^%ZOSF("PROD") Q
	;
	S SERVER="S.A5CSTS@FORUM.VA.GOV"
	S PACKAGE=$P($P(PKG,";",3),U)
	S SITE=$G(^XMB("NETNAME"))
	S START=$P($G(^DIC(9.4,VER(0),"PRE")),U,2) I '$L(START) S START="Unknown"
	D  ; check if ok to use kernel functions
	.S X="XLFDT" X ^%ZOSF("TEST") I $T D  Q
	..S NOW=$$HTFM^XLFDT($H)
	..S RUN="Unknown" I START S RUN=$$FMDIFF^XLFDT(NOW,START,3)
	..S START=$$FMTE^XLFDT(START)
	..S DATE=NOW\1
	..S NOW=$$FMTE^XLFDT(NOW)
	.D NOW^%DTC S NOW=%,DATE=X
	.S RUN="" ; don't bother to compute
	.S Y=START D DD^%DT S START=Y
	.S Y=NOW D DD^%DT S NOW=Y
	;
	; Message for server
	S ^TMP("FBINIS",$J,1,0)="PACKAGE INSTALL"
	S ^TMP("FBINIS",$J,2,0)="SITE: "_SITE
	S ^TMP("FBINIS",$J,3,0)="PACKAGE: "_PACKAGE
	S ^TMP("FBINIS",$J,4,0)="VERSION: "_VER
	S ^TMP("FBINIS",$J,5,0)="Start time: "_START
	S ^TMP("FBINIS",$J,6,0)="Completion time: "_NOW
	S ^TMP("FBINIS",$J,7,0)="Run time: "_RUN
	S ^TMP("FBINIS",$J,8,0)="DATE: "_DATE
	;
	; Data is sent to server on FORUM - S.A5CSTS
	S XMY(SERVER)="",XMDUZ=.5,XMTEXT="^TMP(""FBINIS"",$J,",XMSUB=PACKAGE_" VERSION "_VER_" INSTALLATION"
	D ^XMD
	K ^TMP("FBINIS",$J)
	Q

FBINIT
FBINIT	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	K DIF,DIFQ,DIFQR,DIFQN,DIK,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DIFROM,DFR,DTN,DIX,DZ,DIRUT,DTOUT,DUOUT
	S U="^",DIFQ=0,DIFROM="3.5" W !,"This version (#3.5) of 'FBINIT' was created on 30-JAN-1995"
	W !?9,"(at ALBANY ISC VAX DEVELOPMENT, by VA FileMan V.20.0)",!
	I $D(^DD("VERSION")),^("VERSION")'<20 G GO
	W !,"FIRST, I'LL FRESHEN UP YOUR VA FILEMAN...." D N^DINIT
	I ^DD("VERSION")<20 W !,"BUT I NEED VERSION 20 OF THE VA FILEMAN!" G Q
GO	;
	W !,"I HAVE TO RUN AN ENVIRONMENT CHECK ROUTINE." D PKG,^FBPRE35 Q:'$D(DIFQ)  D NOW^%DTC S DIFROM("PRE")=%
EN	; ENTER HERE TO BYPASS THE PRE-INIT PROGRAM
	S DIFQ=0 K DIRUT,DTOUT,DUOUT
	F DIFRIR=1:1:1 S DIFRRTN="^FBINIT"_$E("5",DIFRIR) D @DIFRRTN
	W:1 !,"I AM GOING TO SET UP THE FOLLOWING FILES:" F I=1:2:66 S DIF(I)=^UTILITY("DIF",$J,I) D 1 G Q:DIFQ!$D(DIRUT) K DIF(I)
	S DIFROM="3.5" D PKG:'$D(DIFROM(0)),^FBINIT1 G Q:'$D(DIFQ) S DIK(0)="AB"
	F DIF=1:2:66 S %=^UTILITY("DIF",$J,DIF),DIK=$P(%,";",5),N=$P(%,";",3),D=$P(%,";",4)_U_N D D K DIFQ(N)
	K DIFQR D ^FBINIT2,^FBINIT3
	L  S DUZ=DIDUZ W:1 !,"NO"_$P("TE THAT FILE",U,DSEC)_" SECURITY-CODE PROTECTION HAS BEEN MADE"
	D ^FBPST35,NOW^%DTC S DIFROM("INIT")=%
	I DIFROM F DIF=1:2:66 S %=^UTILITY("DIF",$J,DIF),N=+$P(%,";",3) I N,$P(%,";",8)="y" S ^DD(N,0,"VR")=DIFROM
	I DIFROM(0)>0 F %="PRE","INI","INIT" S:$D(DIFROM(%)) $P(^DIC(9.4,DIFROM(0),%),U,2)=DIFROM(%)
	I $G(DIFQN) S $P(^(0),U,3,4)=$P(DIFQN,U,2)_U_($P(^DIC(0),U,4)+DIFQN) K DIFQN
	I DIFROM,$D(^%ZTSK) S X="FBINIS" X ^%ZOSF("TEST") D:$T PAC^FBINIS($T(IXF),.DIFROM)
	S:DIFROM(0)>0 ^DIC(9.4,DIFROM(0),"VERSION")=DIFROM G Q^DIFROM0
D	S:$D(^DIC(+N,0))[0 ^(0)=D S X=$D(@(DIK_"0)")),^(0)=D_U_$S(X#2:$P(^(0),U,3,9),1:U)
	S DIFQR=DIFQR(+N) I ^DD("VERSION")>17.5,$D(^DD(+N,0,"DIK"))#2 S X=^("DIK"),Y=+N,DMAX=^DD("ROU") D EN^DIKZ
	I DIFQR D IXALL^DIK:$O(@(DIK_"0)")) W "."
	Q
R	G REP^FBINIT2
	;
1	S N=+$P(DIF(I),";",3),DIF=$P(DIF(I),";",4),S=$P(DIF(I),";",5)
	W !!?3,N,?13,DIF,$P("  (Partial Definition)",U,$P(DIF(I),";",6)),$P("  (including data)",U,$P(DIF(I),";",13)="y") S Z=$S($D(^DIC(N,0))#2:^(0),1:"")
	I Z="" S DIFQ(N)=1,DIFQN=$G(DIFQN)+1_U_N G S
	I $L($P(Z,DIF)) W $C(7),!,"*BUT YOU ALREADY HAVE '",$P(Z,U),"' AS FILE #",N,"!" D R Q:DIFQ  G S:$D(DIFKEP(N)),1
	S DIFQ(N)=$P(DIF(I),";",7)'="n"
	I $L(Z) W $C(7),!,"Note:  You already have the '",$P(Z,U),"' File." S DIFQ(0)=1
	S %=$E(^UTILITY("DIF",$J,I+1),4,245) I %]"" X % S DIFQ(N)=$T W:'$T !,"Screen on this Data Dictionary did not pass--DD will not be installed!" G S
	I $L(Z),$P(DIF(I),";",10)="y" S DIR("A")="Shall I write over the existing Data Definition",DIR("??")="^D DD^DIFROMH1",DIR("B")="YES",DIR(0)="Y" D ^DIR S DIFQ(N)=Y
S	S DIFQR(N)=0 Q:$P(DIF(I),";",13)'="y"!$D(DIRUT)
	I $P(DIF(I),";",15)="y",$O(@(S_"0)"))>0 S DIF=$P(DIF(I),";",14)="o",DIR("A")="Want my data "_$P("merged with^to overwrite",U,DIF+1)_" yours",DIR("??")="^D DTA^DIFROMH1",DIR(0)="Y" D ^DIR S DIFQR(N)=$S('Y:Y,1:Y+DIF) Q
	S %=$P(DIF(I),";",14)="o" W !,$C(7),"I will ",$P("MERGE^OVERWRITE",U,%+1)," your data with mine." S DIFQR(N)=%+1
	Q
Q	W $C(7),!!,"NO UPDATING HAS OCCURRED!" G Q^DIFROM0
	;
PKG	S X=$P($T(IXF),";",3),DIC="^DIC(9.4,",DIC(0)="",DIC("S")="I $P(^(0),U,2)="""_$P(X,U,2)_"""",X=$P(X,U) D ^DIC S DIFROM(0)=+Y K DIC
	Q
	;
IXF	;;FEE BASIS^FB;705
ERX	W $C(7),!!,"This INIT was built as a Network Mail Message and can ONLY be installed",!,"within the Mail system!!" G Q

FBINIT1
FBINIT1	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	; LOADS AND INDEXES DD'S
	;
	K DIF,DIK,D,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DFR,DTN,DIX,DZ D DT^DICRW S %=1,U="^",DSEC=1
	S NO=$P("I 0^I $D(@X)#2,X[U",U,%) I %<1 K DIFQ Q
ASK	I %=1,$D(DIFQ(0)) W !,"SHALL I WRITE OVER FILE SECURITY CODES" S %=2 D YN^DICN S DSEC=%=1 I %<1 K DIFQ Q
	F X="BUL","DIB","DIE","DIP","KEY","OPT" D W Q:'$D(DIFQ)
	Q:'$D(DIFQ)  S %=2 W !!,"ARE YOU SURE EVERYTHING'S OK" D YN^DICN I %-1 K DIFQ Q
	I $D(DIFKEP) F DIDIU=0:0 S DIDIU=$O(DIFKEP(DIDIU)) Q:DIDIU'>0  S DIU=DIDIU,DIU(0)=DIFKEP(DIDIU) D EN^DIU2
	D DT^DICRW K ^UTILITY(U,$J),^UTILITY("DIK",$J) D WAIT^DICD
	S DN="^FBINI" F R=1:1:171 D @(DN_$$B36(R)) W "."
	F  S D=$O(^UTILITY(U,$J,"SBF","")) Q:D'>0  K:'DIFQ(D) ^(D) S D=$O(^(D,"")) I D>0  K ^(D) D IX
DATA	W "." S (D,DDF(1),DDT(0))=$O(^UTILITY(U,$J,0)) Q:D'>0
	I DIFQR(D) S DTO=0,DMRG=1,DTO(0)=^(D),Z=^(D)_"0)",D0=^(D,0),@Z=D0,DFR(1)="^UTILITY(U,$J,DDF(1),D0,",DKP=DIFQR(D)'=2 F D0=0:0 S D0=$O(^UTILITY(U,$J,DDF(1),D0)) S:D0="" D0=-1 Q:'$D(^(D0,0))  S Z=^(0) D I^DITR
	K ^UTILITY(U,$J,DDF(1)),DDF,DDT,DTO,DFR,DFN,DTN G DATA
	;
W	S Y=$P($T(@X),";",2) W !,"NOTE: This package also contains "_Y_"S",! Q:'$D(DIFQ(0))
	S %=1 W ?6,"SHALL I WRITE OVER EXISTING "_Y_"S OF THE SAME NAME" D YN^DICN I '% W !?6,"Answer YES to replace the current "_Y_"S with the incoming ones." G W
	S:%=2 DIFQ(X)=0 K:%<0 DIFQ
	Q
	;
OPT	;OPTION
RTN	;ROUTINE DOCUMENTATION NOTE
FUN	;FUNCTION
BUL	;BULLETIN
KEY	;SECURITY KEY
HEL	;HELP FRAME
DIP	;PRINT TEMPLATE
DIE	;INPUT TEMPLATE
DIB	;SORT TEMPLATE
DIS	;SCREEN TEMPLATE
	;
SBF	;FILE AND SUB FILE NUMBERS
IX	W "." S DIK="A" F %=0:0 S DIK=$O(^DD(D,DIK)) Q:DIK=""  K ^(DIK)
	S DA(1)=D,DIK="^DD("_D_"," D IXALL^DIK
	I $D(^DIC(D,"%",0)) S DIK="^DIC(D,""%""," G IXALL^DIK
	Q
B36(X)	Q $$N(X\(36*36)#36+1)_$$N(X\36#36+1)_$$N(X#36+1)
N(%)	Q $E("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",%)
MSG	;
	I $P(^XMB(3.9,XMZ,0),U,7)'="X" Q
	S X=$S($D(^XMB(3.9,XMZ,2,XCN,0)):^(0),1:"") Q:X=""
M0	D M1 Q:$P(X,"$END MESSAGE")=""  D SAVE,NT G M0
NT	S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:XCN'?1.N  S X=^(XCN,0) Q
SAVE	D NT Q:$E(X)="$"  S Y=X D NT Q:$E(X)="$"
	I $A(X)=126 S A0=X D NT S X=A0_$E(X,2,999) K A0
	S:% @Y=$E(X,2,999) G SAVE
	Q
M1	S Y=$E(X,2,4),%=0 I Y="DDD" S D=+$P(X,"(#",2),%=DIFQ(D) Q:D  S:$P(X,"(#",2)["FILE SECURITY" %=DSEC Q
	Q:Y="END"
	I Y="DTA" S %=DIFQR(D) Q
	I (Y="OR ")!(Y="PKG") S %=1 Q
	I $T(@Y)]"" S %=1 Q
	Q

FBINIT2
FBINIT2	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	;
	K ^UTILITY("DIFROM",$J),DIC S DIDUZ=0 S:$D(DUZ)#2 DIDUZ=DUZ S DUZ=.5
	I $D(^DIC(9.2,0))#2,^(0)?1"HEL".E S (DIC,DLAYGO)=9.2,N="HEL",DIC(0)="LX" G ADD
	Q
	;
ADD	F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R'>0  S X=$P(^(R,0),U,1) W "." K DA D ^DIC I Y>0,'$D(DIFQ(N))!$P(Y,U,3) S ^UTILITY("DIFROM",$J,N,X)=+Y K ^DIC(9.2,+Y,1),^(2),^(3),^(10) S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y D %XY^%RCR
	S DIK=DIC
HELP	S R=$O(^UTILITY("DIFROM",$J,N,R)) Q:R=""  W !,"'"_R_"' Help Frame filed." S DA=^(R)
	F X=0:0 S X=$O(^DIC(9.2,DA,2,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$P(I,U,2) S:Y]"" Y=$O(^DIC(9.2,"B",Y,0)) S ^(0)=$P(^DIC(9.2,DA,2,X,0),U,1)_U_$S(Y>0:Y,1:"")_U_$P(^(0),U,3,99)
	S I=0 F X=0:0 S X=$O(^DIC(9.2,DA,10,X)) Q:'X  I $D(^(X,0)) S Y=$P(^(0),U),Y=$S(Y]"":$O(^MAG("B",Y,0)),1:0) S:Y $P(^DIC(9.2,DA,10,X,0),U)=Y,I=I+1,%=X I 'Y K ^DIC(9.2,DA,10,X,0)
	I I S $P(^DIC(9.2,DA,10,0),U,3,4)=%_U_I
IX	D IX1^DIK G HELP
	;
U	I $D(DIRUT) S DIFQ=1
	W ! Q
REP	S DIR(0)="Y",DIR("A")="Shall I change the NAME of the file to "_DIF
	S DIR("??")="^D REP^DIFROMH1",DIR("B")="NO" D ^DIR G U:$D(DIRUT)
	I Y S DIE=1,DIFQ=0,DA=N,DR=".01////"_DIF D ^DIE Q
	S DIR("A")="Shall I replace your file with mine"
	S DIR("??")="^D AG^DIFROMH1" D ^DIR G U:$D(DIRUT)!'Y
	S DIU(0)="E",DIR("A")="Do you want to keep the Data"
	S DIR("??")="^D CHG^DIFROMH1" D ^DIR G U:$D(DIRUT)
	S:'Y DIU(0)=DIU(0)_"D"
	S DIR("A")="Do you want to keep the Templates"
	S DIR("??")="^D TEMP^DIFROMH1" D ^DIR G U:$D(DIRUT) S:'Y DIU(0)=DIU(0)_"T"
	S DIFQ(N)=1,DIFKEP(N)=DIU(0) W !?15," (",DIF,") " Q

FBINIT3
FBINIT3	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	;
	K ^UTILITY("DIFROM",$J) S DIC(0)="LX",(DIC,DLAYGO)=3.6,N="BUL" D ADD:$D(^XMB(3.6,0))
	S X=0 F R=0:0 S X=$O(^UTILITY("DIFROM",$J,N,X)) Q:X=""  W !,"'",X,"' BULLETIN FILED -- Remember to add mail groups for new bulletins."
	I $D(^DIC(9.4,0))#2,^(0)?1"PACK".E S N="PKG",(DIC,DLAYGO)=9.4 D ADD
	G NP:'$D(DA) S %=+$O(^DIC(9.4,DA,22,"B",DIFROM,0)) I $D(^DIC(9.4,DA,22,%,0)) S $P(^(0),U,3)=DT
	I $D(^DIC(9.4,DA,0))#2 S %=$P(^(0),U,4) I %]"" S %=$O(^DIC(9.2,"B",%,0)) S:%]"" $P(^DIC(9.4,DA,0),U,4)=%
OR	I $D(^ORD(100.99))&$O(^UTILITY(U,$J,"OR","")) D EN^FBINIT4
NP	K DIC,^UTILITY("DIFROM",$J) S DIC(0)="LX" I $D(^DIC(19,0))#2,^(0)?1"OPTION".E S (DIC,DLAYGO)=19,N="OPT" D ADD,OP
	I $D(^DIC(19.1,0))#2,($P(^(0),U)?1"SECUR".E)!($P(^(0),U)="KEY") S (DIC,DLAYGO)=19.1,N="KEY" D ADD K ^UTILITY("DIFROM",$J)
	I $D(^DIC(9.8,0))#2,^(0)?1"ROUTINE^".E S (DIC,DLAYGO)=9.8,N="RTN" D ADD
	S DIC=.5,DLAYGO=0,N="FUN" D ADD
	S DIC("S")="I $P(^(0),U,4)=DIFL" F N="DIPT","DIBT","DIE" S DIC=U_N_"(" D ADD
	K DIC("S") S N="DIST(.404,",DIC=U_N,DLAYGO=.404 D ADD
	S DIC("S")="I $P(^(0),U,8)=DIFL",N="DIST(.403,",DIC=U_N,DLAYGO=.403 D ADD
	K ^UTILITY(U,$J),DIC,DLAYGO F DIFR="DIE","DIPT" D DIEZ
	K ^UTILITY("DIFROM",$J) Q
DIEZ	I ^DD("VERSION")>17.4,'$D(DISYS) D OS^DII
	E  S DISYS=^DD("OS")
	Q:'$D(^DD("OS",DISYS,"ZS"))
	S DIFR1=""
DZ1	S DIFR1=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1)) Q:DIFR1=""
	F DIFR2=0:0 S DIFR2=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1,DIFR2)) Q:'DIFR2  S Y=DIFR2 I $D(@(U_DIFR_"(Y,""ROU"")")) K ^("ROU") I $D(^("ROUOLD")) S X=^("ROUOLD"),DMAX=^DD("ROU") D:X]"" @("EN^DI"_$E(DIFR,3)_"Z")
	G DZ1
	;
OP	S R=$O(^UTILITY("DIFROM",$J,N,R)) I R="" K ^UTILITY("DIFROM",$J) G Q
	W !,"'"_R_"' Option Filed" S DA=+^UTILITY("DIFROM",$J,N,R) G:$P(^(R),U,2,3)="XUCORE^"!($P(^(R),U,2,3)="XUCOMMAND^") OP
	I $D(^DIC(19,DA,220)) S %=$P(^(220),U) S:%]"" %=$O(^XMB(3.6,"B",%,0)) S $P(^DIC(19,DA,220),U)=%,%=$P(^(220),U,3) S:%]"" %=$O(^XMB(3.8,"B",%,0)) S $P(^DIC(19,DA,220),U,3)=%
	S %=$P(^DIC(19,DA,0),U,12) S:%]"" %=$O(^DIC(9.4,"B",%,0))
	S $P(^DIC(19,DA,0),U,12)=%,%=$P(^(0),U,7),(DZ,DIX)=0
	D:$D(^DIC(19,DA,10,"B")) KAD(DA) S:%]"" %=$O(^DIC(9.2,"B",%,0)) S $P(^DIC(19,DA,0),U,7)=%,%=$P(^(0),U,4),%="MOQXL"[% K ^(10,"B"),^("C")
	F X=0:0 S X=$O(^DIC(19,DA,10,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$S($D(^(U)):^(U),1:"") K ^DIC(19,DA,10,X) I Y]"",% S D=$O(^DIC(19,"B",Y,0)) I D S ^DIC(19,DA,10,X,0)=D_U_$P(I,U,2,9),DZ=DZ+1,DIX=X
	S:% ^DIC(19,DA,10,0)="^19.01PI^"_DIX_U_DZ D IX1^DIK G OP
	;
ADD	F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R=""  S X=$P(^(R,0),U),DIFL=$S(N="DIST(.403,":$P(^(0),U,8),N="DIST(.404,":$P(^(0),U,2),1:$P(^(0),U,4)) W "." K DA D ^DIC I Y>0,'$D(DIFQ($E(N,1,3)))!$P(Y,U,3) S Y=Y_U D A
Q	Q
A	I N="BUL" K % S %(0)=$G(@(DIC_"+Y,2,0)")) F %=0:0 S %=$O(@(DIC_"+Y,2,%)")) Q:'%  S %(%)=$G(^(%,0))
	K:N'="KEY"&(N'="OPT") @(DIC_"+Y)") S ^UTILITY("DIFROM",$J,N,X)=Y S:$E(N,1,2)="DI" ^(X,+Y)="" S:N="PKG" DIFROM(0)=+Y Q:$P(Y,U,2,3)="XUCORE^"!($P(Y,U,2,3)="XUCOMMAND^")
	I N="BUL",%(0)]"" S @(DIC_"+Y,2,0)")=%(0) F %=0:0 S %=$O(%(%)) Q:'%  S @(DIC_"+Y,2,%,0)")=%(%)
	I $E(N,1,2)="DI",('DIFL)!('$D(^DD(+DIFL))) W !,"**WARNING--"_$S(N="DIE":"INPUT",N="DIPT":"PRINT",N="DIBT":"SORT",1:"FORM or BLOCK")_" template "_$P(Y,U,2)_" has been installed,",!,"but associated file "_DIFL_" not on your system!"
	I N="OPT" S:$P(^DIC(19,+Y,0),U,6)]"" DIOPT=$P(^(0),U,6) I $O(^UTILITY(U,$J,N,R,1,0)) K ^DIC(19,+Y,1)
	I N="DIST(.403," D BLK
	S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y,DIK=DIC D %XY^%RCR
	D IX1^DIK:N'="OPT" I N="OPT",$D(DIOPT) S:$P(^DIC(19,DA,0),U,6)="" $P(^(0),U,6)=DIOPT K DIOPT
	Q
BLK	F J=0:0 S J=$O(^UTILITY(U,$J,N,R,40,J)) Q:'J  I $D(^(J,0)) S %=$P(^(0),U,2) S:%]"" %=$O(^DIST(.404,"B",%,0)) S:% $P(^UTILITY(U,$J,N,R,40,J,0),U,2)=% D B1
	K A0,A1,A2,J,L Q
B1	F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,40,L)) Q:'L  S A0=$G(^(L,0)),%=$P(A0,U) I %]"" S %=$O(^DIST(.404,"B",%,0)) I % S $P(A0,U)=%,^UTILITY(U,$J,N,R,40,J,"BLK",%,0)=A0
	S A0=$G(^UTILITY(U,$J,N,R,40,J,40,0)) Q:A0=""  K ^UTILITY(U,$J,N,R,40,J,40) S (A1,A2)=0
	F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,"BLK",L)) Q:'L  S ^UTILITY(U,$J,N,R,40,J,40,L,0)=^(L,0),A1=L,A2=A2+1
	S $P(A0,U,3,4)=A1_U_A2,^UTILITY(U,$J,N,R,40,J,40,0)=A0 K ^UTILITY(U,$J,N,R,40,J,"BLK")
	Q
KAD(D0)	N D1,X
	S X=0 F  S X=$O(^DIC(19,D0,10,"B",X)) Q:X'>0  S D1=0 F  S D1=$O(^DIC(19,D0,10,"B",X,D1)) Q:D1'>0  K ^DIC(19,"AD",X,D0,D1)
	Q

FBINIT4
FBINIT4	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	;
EN	S DA(1)=1,DIK="^ORD(100.99,1,5," I $D(^ORD(100.99,1,5,DA)) D ^DIK
	S %X="^UTILITY(U,$J,""OR"","_$O(^UTILITY(U,$J,"OR",""))_",",%Y=DIK_DA_","
	S:'$D(^ORD(100.99,1,5,0)) ^(0)="^100.995P^^" S $P(^(0),U,3,4)=DA_U_($P(^(0),U,4)+1)
	D %XY^%RCR S $P(^ORD(100.99,1,5,DA,0),U)=DA,%=$P(^(0),U,4)
	I %]"" S %=$O(^ORD(100.98,"B",%,0)) I %>0 S $P(^ORD(100.99,1,5,DA,0),U,4)=%
	D OR
	S DA(1)=1 D IX1^DIK
	Q
OR	S (N,I)=0,X=""
	F  S N=$O(^ORD(100.99,1,5,DA,1,N)) Q:'N  S X=$P(^(N,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,0)=% S X=N,I=I+1,(R,J)=0,Y="" D OR1
	S:I $P(^ORD(100.99,1,5,DA,1,0),U,3,4)=X_U_I S (N,I)=0,X=""
	F  S N=$O(^ORD(100.99,1,5,DA,5,N)) Q:'N  S X=$P(^(N,0),U,3) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% $P(^ORD(100.99,1,5,DA,5,N,0),U,3)=% S X=N,I=I+1
	S:I $P(^ORD(100.99,1,5,DA,5,0),U,3,4)=X_U_I K N,R,X,Y,I,J
	Q
OR1	N X F  S R=$O(^ORD(100.99,1,5,DA,1,N,1,R)) Q:'R  S X=$P(^(R,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,1,R,0)=% S Y=R,J=J+1
	S:J $P(^ORD(100.99,1,5,DA,1,N,1,0),U,3,4)=Y_U_J
	Q
ADDP	N I,J,N,R,DA,DLAYGO S %=""
	S DIC="^ORD(101,",DIC(0)="LX",DLAYGO=101 D FILE^DICN K DIC Q:Y=-1  S %=+Y Q

FBINIT5
FBINIT5	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K ^UTILITY("DIF",$J) S DIFRDIFI=1 F I=1:1:66 S ^UTILITY("DIF",$J,DIFRDIFI)=$T(IXF+I),DIFRDIFI=DIFRDIFI+1
	Q
IXF	;;FEE BASIS^FB
	;;161P;FEE BASIS PATIENT;^FBAAA(;0;y;y;;n;;;n;;
	;;
	;;161.2I;FEE BASIS VENDOR;^FBAAV(;0;y;y;;n;;;n;;
	;;
	;;161.21I;FEE BASIS CNH CONTRACT;^FBAA(161.21,;0;y;y;;n;;;n
	;;
	;;161.22;FEE BASIS CNH RATE;^FBAA(161.22,;0;y;y;;n;;;n
	;;
	;;161.23D;FEE BASIS CNH AUTHORIZATION RATE;^FBAA(161.23,;0;y;y;;n;;;n
	;;
	;;161.25P;FEE BASIS VENDOR CORRECTION;^FBAA(161.25,;0;y;y;;n;;;n;;
	;;
	;;161.26P;FEE BASIS PATIENT MRA;^FBAA(161.26,;0;y;y;;n;;;n;;
	;;
	;;161.27I;FEE BASIS SUSPENSION;^FBAA(161.27,;0;y;y;;n;;;y;o;n
	;;
	;;161.3;FEE BASIS LETTER;^FBAA(161.3,;0;y;y;;n;;;y;m;n
	;;
	;;161.4;FEE BASIS SITE PARAMETERS;^FBAA(161.4,;0;y;y;;n;;;n;;
	;;
	;;161.5PI;FEE CH REPORT OF CONTACT;^FBAA(161.5,;0;y;y;;n;;;n;;
	;;
	;;161.6I;FEE BASIS SPECIALTY CODE;^FBAA(161.6,;0;y;y;;n;;;y;o;n
	;;
	;;161.7I;FEE BASIS BATCH;^FBAA(161.7,;0;y;y;;n;;;n;;
	;;
	;;161.8;FEE BASIS PROGRAM;^FBAA(161.8,;0;y;y;;n;;;y;o;n
	;;
	;;161.81I;FEE BASIS PARTICIPATION CODE;^FBAA(161.81,;0;y;y;;n;;;y;o;n
	;;
	;;161.82I;FEE BASIS PURPOSE OF VISIT;^FBAA(161.82,;0;y;y;;n;;;n;;
	;;
	;;161.83P;FEE BASIS ID CARD AUDIT;^FBAA(161.83,;0;y;y;;n;;;n;;
	;;
	;;162P;FEE BASIS PAYMENT;^FBAAC(;0;y;y;;n;;;n;;
	;;
	;;162.1;FEE BASIS PHARMACY INVOICE;^FBAA(162.1,;0;y;y;;n;;;n;;
	;;
	;;162.2DI;FEE NOTIFICATION/REQUEST;^FBAA(162.2,;0;y;y;;n;;;n;;
	;;
	;;162.3ID;FEE CNH ACTIVITY;^FBAACNH(;0;y;y;;n;;;n;;
	;;
	;;162.4I;VA FORM 10-7078;^FB7078(;0;y;y;;n;;;n;;
	;;
	;;162.5;FEE BASIS INVOICE;^FBAAI(;0;y;y;;n;;;n;;
	;;
	;;162.6;FEE BASIS DISPOSITION CODE;^FBAA(162.6,;0;y;y;;n;;;y;o;n
	;;
	;;162.7ID;FEE BASIS UNAUTHORIZED CLAIMS;^FB583(;0;y;y;;n;;;n;;
	;;
	;;162.8D;FEE BASIS UNAUTHORIZED CLAIMS PENDING INFO;^FBAA(162.8,;0;y;y;;n;;;n
	;;
	;;162.91;FEE BASIS UNAUTHORIZED CLAIMS DISPOSITIONS;^FB(162.91,;0;y;y;;n;;;y;o;n
	;;
	;;162.92;FEE BASIS UNAUTHORIZED CLAIMS STATUS;^FB(162.92,;0;y;y;;n;;;y;o;n
	;;
	;;162.93;FEE BASIS UNAUTHORIZED REQUESTED INFORMATION;^FB(162.93,;0;y;y;;n;;;n;;
	;;
	;;162.94;FEE BASIS UNAUTHORIZED DISAPPROVAL REASONS;^FB(162.94,;0;y;y;;n;;;y;o;n
	;;
	;;162.95;FEE BASIS CHECK CANCELLATION REASON;^FB(162.95,;0;y;y;;n;;;y;o;n
	;;
	;;163.85I;FEE BASIS VA TYPE OF SERVICE;^FBAA(163.85,;0;y;y;;n;;;y;o;n
	;;
	;;163.99I;FEE BASIS FEE SCHEDULE;^FBAA(163.99,;0;y;y;;n;;;n;;
	;;

FBMRASV1
FBMRASV1	;AISC/CMR-Server Routine for MRA Messages Cont'd;4/1/93 ;7/29/93  20:26
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
CHANGE	;Process Austin Change Record
	;if fbinc=fbinc1 then transaction was to update fms vendor file, nothing needs to be repointed, and since it is not a duplicate, vendor should not be deleted.
	I FBSTN'=FBSN D
	.N EC S (FBICN,FBOUT)=0,FBERR=1,EC="" D
	..F  S FBICN=$O(^FBAAV("C",FBVID,FBICN)) Q:'FBICN!(FBOUT)  D
	...Q:$P($G(^FBAAV(FBICN,"ADEL")),"^")="Y"
	...S EC="" I FBRT=4 Q:$P(^FBAAV(FBICN,0),U,7)'=3  Q:$P(^FBAAV(FBICN,0),U,10)'=FBCHAIN
	...I FBRT=1 Q:$P($G(^FBAAV(FBICN,0)),U,7)=3
	...I $E(FBVNAME,1,5)'=$E($P($G(^FBAAV(FBICN,"AMS")),U),1,5),'+$P($G(^FBAAV(FBICN,"ADEL")),U,4) S EC=4 Q
	...S FBCNT=FBCNT+1,FBOUT=1,FBERR=0 D FILEV^FBMRASVR
	.I FBERR S:EC']"" EC=4.1 D ER^FBMRASV2(EC,FBJ,.FBER) S FBERR=0
	Q:FBSTN'=FBSN
	I FBSTN=FBSN D GET^FBMRASVR D:FBMRA']"" ER^FBMRASV2(5,FBJ,.FBER) Q:FBMRA']""  S FBICN1=FBICN,FBICN=$P(FBMRA,"^",6) I 'FBICN K FBICN1 Q
	S FBCNT=FBCNT+1 D FILEV^FBMRASVR,DELMRA^FBMRASVR I FBICN']""!(FBICN=FBICN1) K FBICN1 Q
REPOINT	;Re-point pointers to appropriate vendor entry.
	I $D(^FBAAA("ACV",FBICN1)) S K=0 F  S K=$O(^FBAAA("ACV",FBICN1,K)) Q:'K  S FBJ=0 F  S FBJ=$O(^FBAAA("ACV",FBICN1,K,FBJ)) Q:'FBJ  S DIE="^FBAAA(K,1,",DA=FBJ,DA(1)=K,DR=".04////^S X=FBICN" D ^DIE K DIE
	I $D(^FBAA(161.21,"C",FBICN1)) S FBJ=0 F  S FBJ=$O(^FBAA(161.21,"C",FBICN1,FBJ)) Q:'FBJ  S DIE="^FBAA(161.21,",DA=FBJ,DR=".04////^S X=FBICN" D ^DIE K DIE
	I $D(^FBAAC("AB",FBICN1)) S FBK=0 F  S FBK=$O(^FBAAC("AB",FBICN1,FBK)) Q:'FBK  D
	.L +^FBAAC(FBK)
	.S FBOGN=0
	.I '$D(^FBAAC(FBK,1,FBICN,0)) S DIC="^FBAAC(FBK,1,",DA(1)=FBK,(X,DINUM)=FBICN,DIC(0)="" D FILE^DICN
	.F  S FBOGN=$O(^FBAAC(FBK,1,FBICN1,1,FBOGN)) Q:'FBOGN  K DD,DO S DIC="^FBAAC(FBK,1,FBICN,1,",DA(1)=FBICN,DA(2)=FBK,DIC(0)="",DIC("P")="162.02DA",X=$P(^FBAAC(FBK,1,FBICN1,1,FBOGN,0),"^") D FILE^DICN I +$P(Y,U,3) S FBNGN=+Y D
	..S %X="^FBAAC(FBK,1,FBICN1,1,FBOGN,",%Y="^FBAAC(FBK,1,FBICN,1,FBNGN," D %XY^%RCR
	..S DIK="^FBAAC(FBK,1,FBICN,1,",DA(2)=FBK,DA(1)=FBICN,DA=FBNGN D IX1^DIK K DIK
	.S DIK="^FBAAC(FBK,1,",DA(1)=FBK,DA=FBICN1 D ^DIK K DIK L -^FBAAC(FBK)
	I $D(^FBAA(162.1,"AN",FBICN1)) S FBJ=0 F  S FBJ=$O(^FBAA(162.1,"AN",FBICN1,FBJ)) Q:'FBJ  S DIE="^FBAA(162.1,",DA=FBJ,DR="3////^S X=FBICN" D
	.D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAA(162.1,DA)
	.K DIE,FBLOCK
	I $D(^FBAA(162.2,"C",FBICN1)) S FBJ=0 D
	.F  S FBJ=$O(^FBAA(162.2,"C",FBICN1,FBJ)) Q:'FBJ  S DIE="^FBAA(162.2,",DA=FBJ,DR="1////^S X=FBICN" D
	..D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAA(162.2,DA)
	..K FBLOCK S DIE="^FBAA(161.5," D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAA(161.5,DA)
	..K DIE,FBLOCK
	I $D(^FBAACNH("AH",FBICN1)) S FBJ=0 F  S FBJ=$O(^FBAACNH("AH",FBICN1,FBJ)) Q:'FBJ  S DIE="^FBAACNH(",DA=FBJ,DR="8////^S X=FBICN" D
	.D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAACNH(DA)
	.K DIE,FBLOCK
	I $D(^FB7078("C",FBICN1_";FBAAV(")) S FBJ=0 D
	.F  S FBJ=$O(^FB7078("C",FBICN1_";FBAAV(",FBJ)) Q:'FBJ  S DIE="^FB7078(",DA=FBJ,FBTMP=FBICN_";FBAAV(",DR="1////^S X=FBTMP" D
	..D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FB7078(DA)
	..K DIE,FBLOCK,FBTMP
	I $D(^FBAAI("C",FBICN1)) S FBJ=0 F  S FBJ=$O(^FBAAI("C",FBICN1,FBJ)) Q:'FBJ  S DIE="^FBAAI(",DA=FBJ,DR="2////^S X=FBICN" D
	.D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAAI(DA)
	.K DIE,FBLOCK
	I $D(^FB583("C",FBICN1)) S FBJ=0,FBCHK=";FBAAV(" F  S FBJ=$O(^FB583("C",FBICN1,FBJ)) Q:'FBJ  S DIE="^FB583(",DA=FBJ,DR="1////^S X=FBICN" S:$P($G(^FB583(FBJ,0)),"^",23)=(FBICN1_FBCHK) DR=DR_";23////^S X=FBICN_FBCHK" D
	.D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FB583(DA)
	.K DIE,FBLOCK
	;Delete second vendor from vendor file.
	K DIC,DA
	S DIK="^FBAAV(",DA=FBICN1 D ^DIK K DIK,FBICN1
	Q

FBMRASV2
FBMRASV2	;AISC/TET - Server routine (Cont'd)
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EXIT	S XMSER="S."_XQSOP,XMZ=XQMSG D REMSBMSG^XMA1C
	K I,XMER,XMRG,FBI,FBID,FBER,FBERR,FBSITE,FBPOP,FBSN,FBAASN,FBJ,FBRT,FBAC,FBSTN,FBVID,FBCHAIN,FBFEEO,FBVNAME,FBADD1,FBADD2,FBCITY,FBST,FBZIP,FBMRC,FBCC,FBPC,FBTID,FB1099,FBVT,FBICN,FBSC,FBPART,FBSTATE,FBICN1,K,DIE,DA,DR,X,DLAYGO
	K FBOGN,DIC,FBNGN,%X,%Y,DIK,FBTMP,FBMRA,FBCNT,FBATOT,FBCTOT,FBQTOT,FBZIP1,FBCHK,FBOUT,XMSER,XMZ,^TMP("FBMRA",$J),^TMP("FBER",$J)
	Q
EDIT	;edit check if fbac=q
	;INPUT:  FBAC = action code; should only come here if = 'Q'
	;        FBVID = vendor tax id number
	;        FBCHAIN = chain store (optional - only if pharmacy record type)
	;        FBICN = internal control number
	;        FBVNAME = vendor name from autsin transmission
	;OUTPUT: FBAC may be changed from 'Q' to 'C' if id's have not changed,
	;         or if venid exists on file and austin name matches FBVNAME
	;         to avoid leaving duplicate vendors in site's vendor file. 
	;VAR:  FBI = internal entry of vendor in vendor file with same id as FBVID
	;  FBVC = internal entry of vendor in vendor correction file (with station number stripped)
	N FBI,FBVCI S FBI=0,FBVCI=$E(FBICN,4,$L(FBICN))
	S:FBVID=$P($G(^FBAAV(+FBVCI,0)),U,2) FBAC="C" I FBAC="Q" S FBI=$O(^FBAAV("C",FBVID,0)) I FBI,FBVNAME=$P($G(^FBAAV(FBI,"AMS")),U) S FBAC="C"
	Q
TRAP	;trap error, have bulletin message record error, send server message to group and reset trap to server error trap and exit.
	D @^%ZOSF("ERRTN")
	S XQSTXT(0)=""
	S XQSTXT(1)="*** Error detected by FEE while processing the above server message. ***"
	S XQSTXT(2)="Details recorded in the Kernel error trap."
	S XQSTXT(3)="Please contact your IRM representative immediately."
	S XQSTXT(4)="",XQSTXT(5)="The above message # has been forwarded to the FEE mail group."
	S XQSTXT(6)="Once the problem has been identified AND corrected, forward the server message"
	S XQSTXT(7)=$S($G(FBPAID):"  to S.FBAA PAID SERVER",1:"  to S.FBAA MRA SERVER")_" server to complete processing."
	;S %ZTERLGR=$$LGR^%ZOSV D ^%ZTER
	;S X="ERROR^XQSRV2",@^%ZOSF("TRAP")
SEND	K XMY S XMY("G.FEE")="" D ENT1^XMD ;send message to be processed
	D EXIT
	Q
MSG	;set up server bulletin upon successful completion of processing
	S XQSTXT(0)="",XQSTXT(1)="Total Vendor MRA's Received: "_(FBATOT+FBCTOT+FBQTOT)_"     Processed: "_FBCNT_"     Errors: "_FBER
	S XQSTXT(2)="ADDS: "_FBATOT,XQSTXT(3)="CHANGES:  "_FBCTOT,XQSTXT(4)="UNSOLICITED ADDS: "_FBQTOT
	I +FBER S XQSTXT(5)="",XQSTXT(6)="*** "_FBER_" Error"_$S(FBER>1:"s",1:"")_" detected by FEE while processing the above server message. ***",XQSTXT(7)="" D
	.N EC,QCT
	.S QCT=7,EC="" F  S EC=$O(^TMP("FBER",$J,EC)) Q:EC']""  D  S QCT=QCT+1,XQSTXT(QCT)=""
	..N I,DATA
	..S QCT=QCT+1,XQSTXT(QCT)="ERROR CODE "_EC_":  "
	..I EC<4 S XQSTXT(QCT)=XQSTXT(QCT)_$S(EC=1:"Invalid Vendor ID",EC=2:"Invalid Record Length",EC=3:"Invalid Station Number",1:"")
	..I EC'<4 S XQSTXT(QCT)=XQSTXT(QCT)_$S(EC=4:"Vendor names do not match",EC=4.1:"Vendor not found in file or vendor in delete status",EC=5:"Vendor change already processed",1:"")
	..S XQSTXT(QCT)=" ===> "_XQSTXT(QCT)
	..S QCT=QCT+1,XQSTXT(QCT)="       "_$S(EC<3:"Action necessary.",EC=3:"Action may be necessary.",1:"Information only.")_"  Refer to the Vendor Error Code documentation."
	..S QCT=QCT+1,XQSTXT(QCT)="",I=0 F  S I=$O(^TMP("FBER",$J,EC,I)) Q:'I  S DATA=^(I),QCT=QCT+1,XQSTXT(QCT)=DATA
	G EXIT
ER(EC,J,FBER)	;set error & error count
	;INPUT:  EC = error code
	;            1 = invalid vendor id (action needed)
	;            2 = invalid record length (action needed)
	;            3 = invalid station number (action may be necessary)
	;            4 = vendor names do not match (ignore)
	;           4.1 = vendor not found or in delete status (ignore)
	;            5 = record already processed (ignore)
	;        J = data string from message/mra record
	;        FBER = error count
	;OUTPUT: FBER updated
	I $S($G(FBER)']"":1,J']"":1,'+$G(EC):1,1:0) Q
	N FBCHAIN,FBRT,FBVID,FBVNAME
	I EC'=2 S FBRT=$E(J,1),FBVID=$S(FBRT=1:$E(J,9,19),1:$E(J,9,17)),FBVNAME=$S(FBRT=1:$E(J,27,56),1:$E(J,23,52)),FBCHAIN=$S(FBRT=1:"",1:" "_$E(J,18,21))
	S FBER=FBER+1,^TMP("FBER",$J,EC,FBER)=$S(EC=2:J,1:FBVNAME_"     "_FBVID_FBCHAIN)
	Q

FBMRASVR
FBMRASVR	;AISC/CMR-Server Routine for MRA Messages ;8/28/93  13:43
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S X="TRAP^FBMRASV2" S @^%ZOSF("TRAP")
	;K XMY S XMY("G.FEE DEVELOPERS@ISC-ALBANY.VA.GOV")="" D ENT1^XMD
	K ^TMP("FBMRA",$J),^TMP("FBER",$J)
	F I=1:1 X XMREC Q:XMER<0   S:$S($E(XMRG,1)=1:1,$E(XMRG,1)=4:1,1:0)&($S($E(XMRG,2)="C":1,$E(XMRG,2)="A":1,$E(XMRG,2)="Q":1,1:0)) ^TMP("FBMRA",$J,I)=XMRG
TEST	S (FBCNT,FBATOT,FBCTOT,FBQTOT,FBI,FBID,FBER)=0 D STATION^FBAAUTL
	F  S FBI=$O(^TMP("FBMRA",$J,FBI)) Q:'FBI  S FBERR=0,FBJ=^(FBI),FBRT=$E(FBJ,1),FBAC=$E(FBJ,2) D PARSE D
	.I 'FBERR D EXTRACT S FBID=$$CKID(FBVID) S FBERR=$S('FBID:1,1:0) D:'FBERR ADD:FBAC="A"!(FBAC="Q"),CHANGE^FBMRASV1:FBAC="C" I FBERR D ER^FBMRASV2(1,FBJ,.FBER)
	.S:FBAC="A" FBATOT=FBATOT+1 S:FBAC="C" FBCTOT=FBCTOT+1 S:FBAC="Q" FBQTOT=FBQTOT+1
	D MSG^FBMRASV2 Q
PARSE	;Extracts pharmacy or medical mra data
	D:FBRT=4  ;pharmacy record
	.I $L(FBJ)'=167 D ER^FBMRASV2(2,FBJ,.FBER) S FBERR=1 Q
	.S FBVID=$E(FBJ,9,17),FBCHAIN=$E(FBJ,18,21),FBFEEO=$E(FBJ,22),FBVNAME=$E(FBJ,23,52),FBADD1=$E(FBJ,53,82),FBADD2=$E(FBJ,83,112),FBCITY=$E(FBJ,113,131),FBST=$E(FBJ,132,133),FBZIP=$E(FBJ,134,142),FBMRC=$E(FBJ,143,144)
	.S FBCC=$E(FBJ,145,147),FBPC=$E(FBJ,148),FBTID=$E(FBJ,149),FB1099=$E(FBJ,150),FBVT=$E(FBJ,151),FBICN=$E(FBJ,152,166)
	.S FBCHAIN=$$EXTRL(FBCHAIN,1),FBCHAIN=$S(FBCHAIN=0:"",1:FBCHAIN)
	D:FBRT=1  ;medical record
	.I $L(FBJ)'=171 D ER^FBMRASV2(2,FBJ,.FBER) S FBERR=1 Q
	.S FBVID=$E(FBJ,9,19),FBFEEO=$E(FBJ,22),FBSC=$E(FBJ,23,24),FBPART=$E(FBJ,25,26),FBVNAME=$E(FBJ,27,56),FBADD1=$E(FBJ,57,86),FBADD2=$E(FBJ,87,116),FBCITY=$E(FBJ,117,135),FBST=$E(FBJ,136,137),FBZIP=$E(FBJ,138,146)
	.S FBMRC=$E(FBJ,147,148),FBCC=$E(FBJ,149,151),FBPC=$E(FBJ,152),FBTID=$E(FBJ,153),FB1099=$E(FBJ,154),FBVT=$E(FBJ,155),FBICN=$E(FBJ,156,170)
	.S FBSC=$S(FBSC="  ":"",$O(^FBAA(161.6,"C",FBSC,0))>0:$O(^FBAA(161.6,"C",FBSC,0)),1:""),FBPART=$$EXTRL(FBPART),FBPART=$O(^FBAA(161.81,"C",+FBPART,0))
	Q
EXTRACT	;Calls to remove leading/trailing spaces and zeros
	D:$D(XRTL) T0^%ZOSV
	S FBVID=$$EXTRT(FBVID),FBVNAME=$$EXTRT(FBVNAME),FBADD1=$$EXTRT(FBADD1),FBADD2=$$EXTRT(FBADD2),FBCITY=$$EXTRT(FBCITY),FBICN=$$EXTRL(FBICN,1),FBST=$$EXTRT(FBST),FBSTN=$E(FBICN,1,3)
	S FBMRC=$$EXTRL(FBMRC)
	;Conversion from external to internal format.
	S FBSTATE=$S(FBST']"":"",$D(^DIC(5,"C",FBST)):$O(^DIC(5,"C",FBST,0)),1:""),FBZIP=$S($L(FBZIP)>5:$E(FBZIP,1,5)_"-"_$E(FBZIP,6,$L(FBZIP)),1:FBZIP),FBZIP1=$E(FBZIP,6,9) I '+FBZIP1 S FBZIP=$E(FBZIP,1,5)
	S FBCC=$S(FBCC="   ":"",FBCC']"":"",FBCC="000":"",$D(^DIC(5,+FBSTATE,1,"C",FBCC)):$O(^(FBCC,0)),1:"") I FBCC']"" S FBCC=$P($G(^FBAAV(+FBICN,0)),"^",13)
	D:FBAC="Q" EDIT^FBMRASV2
	I $D(XRT0) S XRTN=$T(+0) D T1^%ZOSV
	Q
CKID(X)	;determine if 1st 9 char of id is numeric
	;INPUT:  X = vendor id
	;OUTPUT: 1 if ok, 0 if not
	Q $S('+$G(X):0,X'?9N.2AN:0,1:1) ;$E(X,1,9)?9N:1,1:0)
	;
ADD	;Process Add or Unsolicted Add Record
	I FBSTN'=FBSN D ER^FBMRASV2(3,FBJ,.FBER) Q
	D GET D:FBMRA']"" ER^FBMRASV2(5,FBJ,.FBER) I FBMRA]"" S FBCNT=FBCNT+1 D FILEV,DELMRA
	Q
GET	;Get ICN and MRA entry from MRA file.
	S FBICN=$E(FBICN,4,$L(FBICN))
	S FBMRA=$G(^FBAA(161.25,FBICN,0))
	Q
FILEV	;Files MRA fm Austin in Vendor file.
	Q:'$D(^FBAAV(FBICN,0))  N FBNAM S:'FBCC FBCC=$P(^(0),"^",13) S:"ST"'[FBTID FBTID=""
	I FBAC="C",($G(FBICN1)]"") S DIK="^FBAAV(FBICN,",DA=FBICN D ^DIK K DA,DIK S %X="^FBAAV(FBICN1,",%Y="^FBAAV(FBICN," D %XY^%RCR K %X,%Y S DIK="^FBAAV(FBICN,",DA=FBICN D IX1^DIK K DIK,DA
	S DIE="^FBAAV(",DA=FBICN
	S DR="1////^S X=FBVID;2////^S X=FBADD1;2.5////@;2.5////^S X=FBADD2;3////^S X=FBCITY;4////^S X=FBSTATE;5////^S X=FBZIP;5.5////^S X=FBCC;5.18////^S X=FBMRC;"_$S(FBRT=1:".05////^S X=FBSC;7////^S X=FBPART",1:"8////^S X=FBCHAIN")
	S DR(1,161.2,1)="12.1////^S X=DT;13.1////^S X=$S(FBSTN]"""":FBSTN,1:""000"");30.01////^S X=FBVNAME;30.03////^S X=FB1099;30.04////^S X=FBVT;30.05////^S X=FBPC;30.06////^S X=FBTID"
	L +^FBAAV(FBICN):1 D ^DIE L -^FBAAV(FBICN) K DIE,DA,DR
	Q
DELMRA	;Deletes MRA entry in FB Vendor Correction File.
	S FBVIEN=$S(FBAC="C":FBICN1,1:FBICN),DIE="^FBAA(161.25,"
	I FBAC="C"!(FBAC="Q"),$D(^FBAA(161.25,"AF",FBVIEN)) S FB1=0 F  S FB1=$O(^FBAA(161.25,"AF",FBVIEN,FB1)) Q:'FB1  S DA=FB1,FBLDA=$P($G(^FBAA(161.25,FBVIEN,0)),"^",6),DR="5////^S X=FBLDA" D
	.D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAA(161.25,DA)
	.K FBLOCK
	S DA=FBVIEN,DIK="^FBAA(161.25," D ^DIK K DA,DIK,FB1,FBLDA,FBVIEN
	Q
EXTRL(V,T)	;Removes leading spaces or zeros.
	;V=variable to be parced
	;T=1 remove leading zeros, T="" remove leading spaces
	;Q VAR
	S T=$S($D(T):0,1:" ")
	F  Q:$E(V)'=T  S V=$E(V,2,$L(V))
	Q V
EXTRT(V,T)	;Removes trailing spaces or zeros.
	;V=variable to be parced
	;T=1 remove trailing zeros, T="" remove tralinig spaces
	N FBL
	S T=$S($D(T):0,1:" ")
	F  S FBL=$L(V) Q:$E(V,FBL)'=T  S V=$E(V,1,FBL-1)
	Q V

FBNHACT
FBNHACT	;AISC/DMK - COMMMUNITY NURSING HOME ACTIVITY REPORT ;4/28/93  11:03
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D HED
	D DATE^FBAAUTL G END:FBPOP
	S FBBEG=9999999.9999-(ENDDATE+.2399),FBEND=9999999.9999-BEGDATE
	S VAR="FBBEG^FBEND",VAL=FBBEG_"^"_FBEND,PGM="START^FBNHACT" D ZIS^FBAAUTL G END:FBPOP
START	S QQ="",$P(QQ,"=",80)="=",FBOUT="" U IO W @IOF D HED1
	F FBDFN=0:0 S FBDFN=$O(^FBAACNH("AF",FBDFN)) Q:'FBDFN!(FBOUT)  F I=FBBEG:0 S I=$O(^FBAACNH("AF",FBDFN,I)) Q:'I!(I>FBEND)!(FBOUT)  F J=0:0 S J=$O(^FBAACNH("AF",FBDFN,I,J)) Q:'J!(FBOUT)  I $D(^FBAACNH(J,0)) S FB(0)=^(0) D SET
END	K BEGDATE,DFN,ENDDATE,FB,FBBEG,FBDFN,FBEND,FBNAME,FBOUT,FBVEN,I,J,K,QQ,X,Y
	D CLOSE^FBAAUTL Q
SET	F K=3:1:9 S FB(K)=$P(FB(0),"^",K)
	S FBNAME=$$NAME^FBCHREQ2(FBDFN)_" -"_$$SSN^FBAAUTL(FBDFN,1)
	D VENDOR
	S FB("AC")=$S(FB(3)="A":"ADMISSION",FB(3)="T":"TRANSFER",FB(3)="D":"DISCHARGE",1:"")
	S FB("ADTP")=$S(FB(6)=4:"ALL OTHER",FB(6)=3:"FROM ASIH <15 DAYS",FB(6)=1:"AFTER RE-HOSPITALIZATION >15 DAYS",FB(6)=2:"TRANSFER FROM OTHER CNH",1:"")
	S FB("TR")=$S(FB(7)=1:"TO AUTHORIZED ABSENSE",FB(7)=2:"TO UNAUTHORIZED ABSENSE",FB(7)=3:"TO ASIH",FB(7)=4:"FROM AUTHORIZED ABSENSE",FB(7)=5:"FROM UN-AUTHORIZED ABSENSE",FB(7)=6:"FROM ASIH <15 DAYS",1:"")
	S FB("DC")=$S(FB(8)=1:"REGULAR",FB(8)=2:"DEATH",FB(8)=3:"TRANSFER FROM OTHER CNH",FB(8)=4:"ASIH",FB(8)=5:"DEATH WHILE ASIH",FB(8)=6:"REGULAR - PRIVATE PAY",1:"")
WRT	W !,$S(FB(4)="Y":"*",1:""),?2,FBNAME,?40,FBVEN,!?3,FB("DAT"),?30,FB("AC"),"  -  ",$S(FB(3)="A":FB("ADTP"),FB(3)="T":FB("TR"),FB(3)="D":FB("DC"),1:""),!
	I $Y+5>IOSL D HANG Q:FBOUT  D HED1
	Q
HED	W !?20,"COMMUNITY NURSING HOME REPORT",!?19,"-------------------------------",! Q
HED1	D HED W ?18,"('*' Represents ACTIVE ADMISSION)",!,"PATIENT NAME",?48,"VENDOR",!?3,"ACTIVITY DATE",?30,"ACTIVITY TYPE",!,QQ,! Q
VENDOR	I FB(9) S FBVEN=$E($$VNAME^FBNHEXP(FB(9)),1,33)_" -"_$E($$VID^FBNHEXP(FB(9)),6,9)
	S FB("DAT")=$$DATX^FBAAUTL(9999999.9999-I) Q
HANG	I $E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR I 'Y S FBOUT=1
	W @IOF Q

FBNHAMI1
FBNHAMI1	;AISC/CMR-CALCULATE/VALIDATE AMIS 349 ;11/18/94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
NEXT	;
	F FBDD=FBPAYDT:0 S FBDD=$O(^FB7078("AD",7,FBDD)) Q:FBDD'>0  F FBIFN=0:0 S FBIFN=$O(^FB7078("AD",7,FBDD,FBIFN)) Q:FBIFN'>0  S FBZ=$G(^FB7078(FBIFN,0)) I $P(FBZ,U,9)'="DC",($P(FBZ,U,4)'>FBENDDT) D
	.S DFN=+$P(FBZ,"^",3),IFN=+$P(FBZ,"^",2) D MORE I $G(FBCUR) S TOTDAYS=TOTDAYS+FBTRDYS D TMP(15) S FBTRDYS=0
	Q:'$G(FBCUR)
	S TOTDAYS=$FN(TOTDAYS,",",0) D ^FBNHPAMS G END^FBNHAMIS
MORE	K FB S FBNAC=$O(^FBAACNH("AG",DFN,IFN,FBPAYDT)) G:'FBNAC!($P(FBNAC,".")>FBENDDT) NOAC
	F FBNAC=FBPAYDT:0 S FBNAC=$O(^FBAACNH("AG",DFN,IFN,FBNAC)) Q:'FBNAC!(FBNAC>FBENDDT)  F FBRIFN=0:0 S FBRIFN=$O(^FBAACNH("AG",DFN,IFN,FBNAC,FBRIFN)) Q:'FBRIFN  S Z=$G(^FBAACNH(FBRIFN,0)),Z(0)=$P(Z,"^",3) D
	.N FBZZ S FBZZ=$S(Z(0)="A":+$P(Z,"^",10),1:+$P(^FBAACNH($P(Z,"^",5),0),"^",10)) Q:'$D(^FBAAA("AG",FBIFN_";FB7078(",DFN,FBZZ))
	.S FB(FBRIFN)=FBNAC\1_"^"_Z(0)_"^"_$S(Z(0)="A":9,Z(0)="D":0,1:$P(Z,"^",7))
	S I=0,FBPNAC=FBPAYDT+1,(FBPSW,FBSW)=""
	F  S I=$O(FB(I)) Q:'I  D:$P(FB(I),"^")'>FBENDDT
	.S FBNAC=$P(FB(I),"^"),FBSW=$P(FB(I),"^",3) I FBSW<4&(FBPSW="") D
	..S FBPREV=$O(^FBAACNH("AF",+DFN,(9999999.9999-FBPAYDT))) Q:'FBPREV  S FBPREV=$O(^(FBPREV,0)),Z=$G(^FBAACNH(+FBPREV,0)),Z(0)=$P(Z,"^",3),FBPSW=$S(Z(0)="A":9,Z(0)="D":0,1:$P(Z,"^",7))
	.S:FBSW<4&(FBPSW>3!(FBPSW="")) FBTRDYS=FBTRDYS+$S((FBNAC-FBPNAC)>0:(FBNAC-FBPNAC),((FBPSW>3)&(+$E(FBNAC,6,7)=1)&(FBNAC'=+$P(Z,"."))):0,1:1) S FBPNAC=FBNAC,FBPSW=FBSW
	I FBSW>3 S FBTRDYS=FBTRDYS+$S((FBENDDT\1-FBNAC)>0:(FBENDDT\1-FBNAC),FBENDDT\1=FBNAC:0,1:1),FBTRDYS=$S(FBTRDYS>0:(FBTRDYS+1),1:1) D
	.S FBR(1)=FBR(1)+1 D TMP(9)
	.I $P($G(^DPT(+DFN,0)),"^",2)="F" S FBFEM=FBFEM+1 D TMP(12)
	I FBSW<4 D
	.I $S(FBSW=1:1,FBSW=2:1,1:0) S FBR(2)=FBR(2)+1 D TMP(10)
	.I FBSW=3 S FBR(3)=FBR(3)+1 D TMP(11)
	I $D(FB) D ERR
	Q
NOAC	S FBPREV=$O(^FBAACNH("AF",DFN,(9999999.9999-FBPAYDT))) Q:'FBPREV  S FBPIFN=$O(^(FBPREV,0)),Z=$G(^FBAACNH(FBPIFN,0)) Q:$P(Z,"^",3)="D"  S Z(0)=$P(Z,"^",3)
	N FBZZ S FBZZ=$S(Z(0)="A":+$P(Z,"^",10),1:+$P(^FBAACNH($P(Z,"^",5),0),"^",10))
	Q:'$D(^FBAAA("AG",FBIFN_";FB7078(",DFN,FBZZ))
	D ERR
	I $P(Z,"^",3)="T"&($P(Z,"^",7)<4) S:$P(Z,"^",7)=3 FBR(3)=FBR(3)+1 D TMP(11) Q
	S FBTRDYS=FBDAYS,FBR(1)=FBR(1)+1 D TMP(9)
	I $P($G(^DPT(+DFN,0)),"^",2)="F" S FBFEM=FBFEM+1 D TMP(12)
	I $S($P(Z,"^",7)=1:1,$P(Z,"^",7)=2:1,1:0) S FBR(2)=FBR(2)+1 D TMP(10)
	Q
TMP(X)	;set tmp
	Q:'X!('$G(FBCUR))!('$G(FBVAL))
	S ^TMP($J,"FBAMIS",X,FBIFN)=$S(X=15:FBTRDYS,1:"")
	Q
ERR	;check if authorization to date has been exceeded
	Q:FBDD>FBENDDT
	N FBDATE,FBIEN,FBZM
	S FBER(DFN,FBDD)=$G(FBCUR)
	S FBDATE=$S($P(FBZ,U,4)>FBPAYDT:$P(FBZ,U,4),1:FBPAYDT)
	F  S FBDATE=$O(^FBAACNH("AG",DFN,IFN,FBDATE)) Q:'FBDATE!(FBDATE>($E(FBDD,1,7)_.9999))  S FBIEN=0 F  S FBIEN=$O(^FBAACNH("AG",DFN,IFN,FBDATE,FBIEN)) Q:'FBIEN  S FBZM=$G(^FBAACNH(FBIEN,0)) D:$P(FBZM,"^",3)["D"  K FBZM
	.S FBZZ=+$P(^FBAACNH($P(FBZM,"^",5),0),"^",10) I $D(^FBAAA("AG",FBIFN_";FB7078(",DFN,FBZZ)) K FBER(DFN,FBDD)
	Q

FBNHAMI2
FBNHAMI2	;AISC/CMR-CNH STAYS IN EXCESS OF 90 DAYS ;6/9/93  11:04
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	W !!,"Use of this option will provide you with all 'ACTIVE' stays that are in excess",!,"of 90 days.  The active stays are as of the date you choose.",!
	S %DT="APEX",%DT("A")="Enter Effective Date : " D ^%DT G END:Y<0 S FBDT=Y
	S VAR="FBDT",VAL=FBDT,PGM="START^FBNHAMI2" D ZIS^FBAAUTL G END:FBPOP
START	K ^TMP($J,"FBSTAY") S FBHD="=",$P(FBHD,"=",80)="=",FBUL="-",$P(FBUL,"-",37)="-" U IO W:$E(IOST,1,2)["C-" @IOF D HED
	S (FBADM,FBASSOC)=0
	F  S FBADM=$O(^FBAACNH("AC",FBADM)) Q:'FBADM  S FBCHK=0 D  I FBCHK=0 D SET
	.F  S FBASSOC=$O(^FBAACNH("AC",FBADM,FBASSOC)) Q:'FBASSOC  D
	..Q:FBADM=FBASSOC
	..S FBI=$G(^FBAACNH(FBASSOC,0)),FBTYPE=$P(FBI,"^",3) Q:FBTYPE'="D"  S FBDDT=$P(FBI,"^") I FBDDT'>FBDT S FBCHK=1
	S FBNAME=""
	F  S FBNAME=$O(^TMP($J,"FBSTAY",FBNAME)) Q:FBNAME']""!($G(FBAAOUT))  S DFN=0 F  S DFN=$O(^TMP($J,"FBSTAY",FBNAME,DFN)) Q:'DFN!($G(FBAAOUT))  D
	.S FBI=^TMP($J,"FBSTAY",FBNAME,DFN),FBID=$P(FBI,"^"),FBADT=$P(FBI,"^",2),FBVNAME=$P(FBI,"^",3),FBLOS=$P(FBI,"^",4) D PRINT
	G END:$G(FBAAOUT)
	W !!?5,"***LOS = Length of Stay as of ",$$DATX^FBAAUTL(FBDT)
	S DIR(0)="E" D ^DIR K DIR
END	;
	K FBDT,FBAAOUT,DFN,FBNAME,FBID,FBVNAME,FBHD,FBTYPE,FBUL,VAR,VAL,PGM,FBPOP,FBADM,FBASSOC,FBCHK,FBI,FBDDT,FBADT,FBLOS,^TMP($J,"FBSTAY"),FBMS,VA,VADM
	D CLOSE^FBAAUTL
	Q
SET	;SETS UP TMP GLOBAL
	S FBADT=+^FBAACNH(FBADM,0)
	S FBLOS=$$DTC^FBUCUTL(FBDT,FBADT)
	Q:FBLOS<90
	S FBI=$G(^FBAACNH(FBADM,0)),DFN=$P(FBI,"^",2) Q:'$G(DFN)  S FBNAME=$$NAME^FBCHREQ2(DFN),FBID=$$SSN^FBAAUTL(DFN),FBVNAME=$P($G(^FBAAV($P(FBI,"^",9),0)),"^")
	S ^TMP($J,"FBSTAY",FBNAME,DFN)=FBID_"^"_FBADT_"^"_FBVNAME_"^"_FBLOS_"^"_DFN
	K FBNAME,FBID,FBVNAME,FBLOS,DFN Q
PRINT	;
	I $E(IOST,1,2)["C-",$Y+2>IOSL S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+2>IOSL W @IOF D HED
	W !,$E(FBNAME,1,15),?18,FBID
	D DEM^VADPT S FBMS=$E($P(VADM(10),"^",2),1) K VA,VADM
	W ?32,FBMS,?35,$$DATX^FBAAUTL($E(FBADT,1,7)),?45,$J(FBLOS,6),?53,$E(FBVNAME,1,27)
	Q
HED	;
	W !?22,"ACTIVE CNH STAYS IN EXCESS OF 90 DAYS",!?33,"AS OF ",$$DATX^FBAAUTL(FBDT),!?22,FBUL,!!
	W ?28,"MARITAL",!,"VETERAN",?20,"Pt. ID",?30,"ST.",?35,"ADM. DATE",?48,"LOS",?60,"VENDOR",!,FBHD
	Q

FBNHAMIE
FBNHAMIE	;AISC/CMR-CNH Admission/Discharge Output ;4/28/93  11:04
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DATE^FBAAUTL Q:FBPOP
	S VAR="BEGDATE^ENDDATE",VAL=BEGDATE_"^"_ENDDATE,PGM="START^FBNHAMIE" D ZIS^FBAAUTL G END:FBPOP
START	S FBHD="=",$P(FBHD,"=",80)="=",FBUL="-",$P(FBUL,"-",29)="-",FBAAOUT=0 U IO W:$E(IOST,1,2)["C-" @IOF D HED
	F FBDT=BEGDATE-.001:0 S FBDT=$O(^FBAACNH("B",FBDT)) Q:'FBDT!(FBDT>(ENDDATE+.9999))!(FBAAOUT)  F FBIEN=0:0 S FBIEN=$O(^FBAACNH("B",FBDT,FBIEN)) Q:'FBIEN!(FBAAOUT)  S FB(0)=$G(^FBAACNH(+FBIEN,0)) I FB(0)]"" D
	.S (FBTP,FB("TP"))="",FBTYPE=$S($P(FB(0),"^",3)="A":"ADMISSION",$P(FB(0),"^",3)="D":"DISCHARGE",1:0) Q:FBTYPE=0  D  Q:FBAAOUT
	..I $E(FBTYPE)="A" S FBTP=$P(FB(0),"^",6),FB("TP")=$S(FBTP=4:"ALL OTHER",FBTP=3:"FROM ASIH <15 DAYS",FBTP=1:"AFTER RE-HOSPITALIZATION >15 DAYS",FBTP=2:"TRANSFER FROM OTHER CNH",1:"")
	..I $E(FBTYPE)="D" S FBTP=$P(FB(0),"^",8),FB("TP")=$S(FBTP=1:"REGULAR",FBTP=2:"DEATH",FBTP=3:"TRANSFER FROM OTHER CNH",FBTP=4:"ASIH",FBTP=5:"DEATH WHILE ASIH",FBTP=6:"REGULAR - PRIVATE PAY",1:"")
	..S DFN=$P(FB(0),"^",2) Q:'$G(DFN)  S FBNAME=$$NAME^FBCHREQ2(DFN),FBID=$$SSN^FBAAUTL(DFN),FTP=+$P(FB(0),"^",9)
	..S FBVEN=$G(^FBAAV(FTP,0)),FBVNAME=$P(FBVEN,"^"),FBVID=$P(FBVEN,"^",2),FBVSTR=$P(FBVEN,"^",3),FBVCITY=$P(FBVEN,"^",4),FBVST=$P($G(^DIC(5,+$P(FBVEN,"^",5),0)),"^"),FBVZIP=$P(FBVEN,"^",6)
	..S FBPHONE=$P($G(^FBAAV(FTP,1)),U),FBPHONE=$S(FBPHONE="":"Not entered",1:FBPHONE)
	..D ELIG^VADPT,PRINT
END	;
	K BEGDATE,ENDDATE,FBDT,FBAAOUT,FBIEN,FB,DFN,FBPHONE,FBNAME,FBID,FBPSA,FTP,FBVEN,FBVNAME,FBVID,FBVSTR,FBVCITY,FBVST,FBVZIP,FBHD,FBTYPE,FBUL,VAEL,VAERR,FBTP
	D CLOSE^FBAAUTL Q
PRINT	;
	I $E(IOST,1,2)["C-",$Y+8>IOSL S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+8>IOSL W @IOF D HED
	W !!,FBNAME,?32,FBID,?48,$P(VAEL(1),"^",2),!?3,FBTYPE," DATE: ",$$DATX^FBAAUTL(FBDT),?36,FBTYPE," TYPE: ",$E(FB("TP"),1,28)
	I $G(FTP) W !?10,FBVNAME,?42,FBVID,!?10,FBVSTR,!?10,FBVCITY,"   ",FBVST,"  ",FBVZIP,!?10,"Phone #: ",FBPHONE
	Q
HED	;
	W !?22,"CNH ADMISSIONS AND DISCHARGES",!?24,$$DATX^FBAAUTL(BEGDATE)," THROUGH ",$$DATX^FBAAUTL(ENDDATE),!?22,FBUL,!
	Q

FBNHAMIS
FBNHAMIS	;AISC/GRR-CALCULATE AMIS 349 ;3/30/92  08:31
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D DT^DICRW S %DT="AEP",%DT(0)=-$E(DT,1,5)_31,%DT("A")="Calculate AMIS for which Month/Year: " D ^%DT G:X=""!(X="^") END S FBPAYDT=$E(+Y,1,5)_"00",FBMM=$E(+Y,4,5),FBYY=$E(+Y,2,3),X=+Y D DAYS^FBAAUTL1
	W ! S FBDAYS=X,FBENDDT=$E(+Y,1,5)_FBDAYS+.9
	S DIR(0)="Y",DIR("A")="Do you want data validation with this output",DIR("B")="No",DIR("?")="Answering 'Yes' will print who is found for each AMIS segment." D ^DIR K DIR G:$D(DIRUT) END I Y S FBVAL=1
	S VAR="FBPAYDT^FBENDDT^FBDAYS^FBYY^FBVAL",VAL=FBPAYDT_"^"_FBENDDT_"^"_FBDAYS_"^"_FBYY_"^"_$G(FBVAL),PGM="START^FBNHAMIS",IOP="Q" D ZIS^FBAAUTL G:FBPOP END W !
START	K FBOUT U IO D PRIOR
	K ^TMP($J,"FBAMIS") S FBCUR=1 ;current month flag
	F I=1:1:4 S FBG(I)=0
	F I=1:1:4 S FBL(I)=0
	F I=1,2,3 S FBR(I)=0
	S (FBASDIS,FBASDEAD,FBTRDYS,FBSC,FBFEM,TOTDAYS)=0,FBMONTH=$E(FBPAYDT,1,5)_"01^"_$E(FBENDDT,1,7)
	F FBJ=FBPAYDT:0 S FBJ=$O(^FBAACNH("B",FBJ)) Q:FBJ'>0!(FBJ>FBENDDT)  F FBIFN=0:0 S FBIFN=$O(^FBAACNH("B",FBJ,FBIFN)) Q:'FBIFN  I $D(^FBAACNH(FBIFN,0)) S Y(0)=^(0),FBTYPE=$P(Y(0),"^",3) D ADD:FBTYPE="A",TRAN:FBTYPE="T",DIS:FBTYPE="D"
	G ^FBNHAMI1
END	K FB,FBSW,FBG,FBL,FBR,IFN,DFN,FBLTT,FBNAC,FBPNAC,FBZ,FBPRTR,FBDD,FBENDDT,FBPAYDT,FBDAYS,TOTDAYS,FBRIFN,FBPIFN,FBTRDYS,FBFEM,FBSC,FBASIH,Z,Y,FBJ,FBTYPE,ATYPE,DTYPE,TTYPE,VAR,VAL,PGM,FBCUR,FBCHK,FBPRIOR,FBMOV,FBPG
	K FBABD,FBASDEAD,FBASDIS,FBDEFP,FBEDT,FBERR,FBHIFN,FBIFN,FBIRAT,FBMM,FBMONTH,FBMULT,FBNHCC,FBONE,FBPREV,FBSRAT,FBSUB,FBTDT,FBTOTAL,FBTWO,FBUL,FBVCAR,FBYY,I,X,X1,Z1,Z2,FBTOT,FBCOUNT,FBPSW,FBER,FBZZ,FBVAL,FBDV,FBOUT,^TMP($J,"FBAMIS")
	D CLOSE^FBAAUTL
	Q
PRIOR	;calculate bed occupants remaining from previous month's amis
	S FBPAYHDT=FBPAYDT
	N FBR,FBPAYDT,FBENDDT,FBDAYS,FBMM,FBYY,FBFEM,FBTRDYS
	F I=1,2,3 S FBR(I)=0
	S (FBFEM,FBTRDYS)=0
	S FBMM=$E(FBPAYHDT,4,5),FBYY=$E(FBPAYHDT,2,3) S FBMM=$S(FBMM="01":12,1:FBMM-1) I FBMM=12 S FBYY=FBYY-1
	I $L(FBMM)=1 S FBMM="0"_FBMM
	I $L(FBYY)=1 S FBYY="0"_FBYY
	S FBPAYDT=2_FBYY_FBMM_"00",X=+FBPAYDT D DAYS^FBAAUTL1 S FBDAYS=X
	S FBENDDT=$E(+FBPAYDT,1,5)_FBDAYS+.9
	D NEXT^FBNHAMI1
	S FBPRIOR=FBR(1)+FBR(2) K FBPAYHDT
	Q
ADD	S ATYPE=$P(Y(0),"^",6) Q:ATYPE=""
	S FBSUB=$S(ATYPE=1:1,ATYPE=2:3,1:2),FBG(FBSUB)=FBG(FBSUB)+1 D TMP^FBNHAMI1(FBSUB)
	S DFN=$P(Y(0),"^",2) I $$EXTPV^FBAAUTL5($P($G(^FBAAA(DFN,1,+$P(Y(0),"^",10),0)),"^",7))=40 S FBSC=FBSC+1 D TMP^FBNHAMI1(16)
	Q
DIS	S DTYPE=$P(Y(0),"^",8) Q:DTYPE=""
	I DTYPE<4!(DTYPE=6) S FBSUB=$S(DTYPE=1:1,DTYPE=6:1,1:DTYPE),FBL(FBSUB)=FBL(FBSUB)+1 D TMP^FBNHAMI1(FBSUB+4) Q
	I DTYPE=4 S FBASDIS=FBASDIS+1 D TMP^FBNHAMI1(13) Q
	S FBASDEAD=FBASDEAD+1 D TMP^FBNHAMI1(14)
	Q
TRAN	S TTYPE=$P(Y(0),"^",7) Q:TTYPE=""
	I TTYPE=6 S FBG(4)=FBG(4)+1 D TMP^FBNHAMI1(4) Q
	I TTYPE=3 S FBL(4)=FBL(4)+1 D TMP^FBNHAMI1(8) Q
	Q
DISCR	;print out pts whose authorization dates have been exceeded
	Q:'$D(FBER)
	W @IOF D HDR^FBNHPAMS
	W !?5,">>>NOTICE OF INCOMPLETE PATIENT MOVEMENTS AFFECTING AMIS TOTALS<<<",!!!,"The following patient(s) have met or exceeded their authorizations, and have",!,"not been discharged.  This will result in inaccurate AMIS 349 calculations"
	W !,"for the current month's amis, and will affect the balancing segment for",!,"subsequent months!!",!!,"To obtain an accurate AMIS, you must either discharge the patient,"
	W !,"or extend their Authorization To Date.  Once the data has been corrected,",!,"you may run the AMIS 349 again to obtain accurate figures."
	W !!?10,"PATIENT",?44,"PT. ID",?55,"AUTHORIZATION TO DATE",!
	S FBZ=0 F  S FBZ=$O(FBER(FBZ)) Q:'FBZ!($G(FBOUT))  S FBDD=0 F  S FBDD=$O(FBER(FBZ,FBDD)) Q:'FBDD!($G(FBOUT))  D PGCK^FBNHPAMS(3) Q:$G(FBOUT)  D
	.W !,$S(FBER(FBZ,FBDD)=1:"",1:"**"),?5,$$NAME^FBCHREQ2(FBZ),?40,$$SSN^FBAAUTL(FBZ),?60,$$DATX^FBAAUTL(FBDD) I FBER(FBZ,FBDD)="" S FBMOV=1
	I $G(FBMOV) D PGCK^FBNHPAMS(4) Q:$G(FBOUT)  W !!,"** indicates movement problem from the prior month that is affecting",!,"the balancing segment."
	Q

FBNHDEC
FBNHDEC	;AISC/GRR-DISPLAY EPISODE OF CARE ;25AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D HED F J=0:0 S J=$O(^FBAACNH("AC",IFN,J)) Q:J'>0  I $D(^FBAACNH(J,0)) S Z=^(0) D:$Y>(IOSL+4) HED S Y=$P(Z,"^",1),FBAAAD=Y,FBTYPE=$P(Z,"^",3) D PDATE^FBAAUTL D ADD:FBTYPE="A",TRAN:FBTYPE="T",DIS:FBTYPE="D"
	K J,Z Q
ADD	S FBAT=$P(Z,"^",6) W !,FBPDT,?26,"Admission",?40,$P($T(ADDT+FBAT),";;",2) Q
TRAN	S FBAT=$P(Z,"^",7) W !,FBPDT,?26,"Transfer",?40,$P($T(TRANT+FBAT),";;",2) Q
DIS	S FBAT=$P(Z,"^",8) W !,FBPDT,?26,"Discharge",?40,$P($T(DIST+FBAT),";;",2) Q
HED	W @IOF,"Veteran: ",$P(^DPT(DFN,0),"^",1),?43,"SSN: ",$$SSN^FBAAUTL(DFN),!,?5,"Date/Time",?25,"Transaction",?42,"Type",!
	Q
ADDT	;;
	;;After Re-hospitalization > 15 Days
	;;Transfer from Other CNH
	;;From ASIH < 15 Days
	;;All Other
TRANT	;;
	;;To Authorized Absence
	;;To Un-authorized Absence
	;;To ASIH
	;;From Authorized Absence
	;;From Un-authorized Absence
	;;From ASIH
DIST	;;
	;;Regular
	;;Death
	;;Transfer to Other CNH
	;;ASIH
	;;Death While ASIH
	;;Regular - Private Pay

FBNHDIEP
FBNHDIEP	;AISC/GRR-DISPLAY EPISODE OF CARE FOR NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
RD2	S DIC("S")="I $P(^(0),U,3)=""A""&($P(^(0),U,2)=DFN)",DIC="^FBAACNH(",DIE=DIC,DIC(0)="AEQMZ",DLAYGO=162.3,DIC("A")="Select Admission Date/Time: " D ^DIC K DIC,DLAYGO G RD1:X="^"!(X=""),RD2:Y<0 S DA=+Y,IFN=DA
	D ^FBNHDEC G RD1
Q	K DIC,DIE,DR,DA,DFN,FBTYPE,FTP,Y,X,FBPROG,FBAAAD,FBAT,FBPDT,IFN
	Q

FBNHDLAD
FBNHDLAD	;AISC/GRR-DELETE ADMISSION FOR NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q W !
RD2	S DIC("S")="I $P(^(0),U,3)=""A""&($P(^(0),U,2)=DFN)",DIC="^FBAACNH(",DIE=DIC,DIC(0)="AEQMZ",DLAYGO=162.3,DIC("A")="Select Admission Date/Time: " D ^DIC K DIC,DLAYGO G RD1:X="^"!(X=""),RD2:Y<0 S DA=+Y
	S FB(161)=$P(Y(0),"^",10)
	I $O(^FBAACNH("AC",DA,DA))>0 W !!,*7,"Other movements associated with this admission are still on file.",!,"You cannot delete the admission when other movements exist!" G CKVEIW
	S DIR("A")="Are you sure you want to delete this admission",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR G H^XUS:$D(DTOUT),Q:$D(DUOUT),RD1:Y=0
	I FB(161),$D(^FBAAA(DFN,1,FB(161),0)) S FB(78)=$P($P(^(0),"^",9),";")
	I $G(FB(78)) S FB(1625)=+$O(^FBAAI("E",FB(78)_";FB7078(",0))
	I $G(FB(1625)),$D(^FBAAI(FB(1625),0)) W *7,!,"Unable to delete. Payments already made against this admission!",!! G RD1
	S DIK=DIE D ^DIK W !?5,"...deleted",!
	K FB,DIK G RD1
Q	K DIC,DIE,DR,DA,DFN,FBTYPE,FTP,Y,X,FBPROG,FB,FBZZ,ZZZ
	Q
CKVEIW	S DIR("A")="Want data related to this admission displayed",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G H^XUS:$D(DTOUT),RD1:$D(DUOUT)!(Y=0) S IFN=DA D ^FBNHDEC
	G RD1

FBNHDLDI
FBNHDLDI	;AISC/GRR-DELETE DISCHARGE FOR NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
	I $D(^FBAACNH("AD",DFN)) W !!,*7,"Veteran presently has an active admission.",!,"You cannot delete a discharge when there is an active admission!",! G CKVEIW
RD2	S DIC("S")="I $P(^(0),U,3)=""D""&($P(^(0),U,2)=DFN)",DIC="^FBAACNH(",DIE=DIC,DIC(0)="AEQMZ",DLAYGO=162.3,DIC("A")="Select Discharge Date/Time: " D ^DIC K DIC,DLAYGO G RD1:X="^"!(X=""),RD2:Y<0 S DA=+Y
	S FBCKDT=+Y(0) I $O(^FBAACNH("AF",DFN,0))<(9999999.9999-FBCKDT) W !!,*7,"There is activity following this discharge date.",!,"You must delete all subsequent activity before deleting this discharge." G RD1
	S FBDA=$P(^FBAACNH(DA,0),"^",5)
	S DIR("A")="Are you sure you want to delete this discharge",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR G H^XUS:$D(DTOUT),RD1:$D(DUOUT)!(Y=0)
	S DIK="^FBAACNH(" D ^DIK S DIE="^FBAACNH(",DR="3////^S X=""Y""",DA=FBDA D ^DIE W !?5,"... deleted" D ALERT G RD1
Q	K DIC,DIE,DR,DA,DFN,FBTYPE,FTP,Y,X,FBPROG,FBDA,FBCKDT
	Q
CKVEIW	S DIR("A")="Want data related to active admission displayed",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G H^XUS:$D(DTOUT),RD1:$D(DUOUT)!(Y=0) S IFN=$O(^FBAACNH("AD",DFN,0)) D ^FBNHDEC
	G RD1
ALERT	W !!,*7,"It will be necessary to adjust the 'TO DATE' of this patient's authorization",!,"using the 'EDIT CNH AUTHORIZATION' option."

FBNHDLTR
FBNHDLTR	;AISC/GRR-DELETE TRANSFER FOR NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
RD2	S DIC("S")="I $P(^(0),U,3)=""T""&($P(^(0),U,2)=DFN)",DIC="^FBAACNH(",DIE=DIC,DIC(0)="AEQMZ",DLAYGO=162.3,DIC("A")="Select Transfer Date/Time: " D ^DIC K DIC,DLAYGO G RD1:X="^"!(X=""),RD2:Y<0 S DA=+Y
	S FBDA(0)=Y(0),FBDA=$P(FBDA(0),U,5) D  G Q:$D(FBERR)
	.I $O(^FBAACNH("AC",FBDA,DA)) W !,*7,"There are movements following this transfer that must be deleted first.",!! S FBERR=1
	S DIR("A")="Are you sure you want to delete this transfer",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR G H^XUS:$D(DTOUT),RD1:$D(DUOUT)!(Y=0)
	S DIK="^FBAACNH(" D ^DIK K FBDA G RD1
Q	K DIC,DIE,DR,DA,DFN,DIR,FBTYPE,FTP,Y,X,FBPROG,FBDA,FBERR
	Q

FBNHEA
FBNHEA	;AISC/GRR-ENTER ADMISSION TO NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
	I $D(^FBAACNH("AD",DFN)) G CKVEIW
RD0	S FBPROG="I $P(^(0),U,3)=7" D GETAUTH^FBAAUTL1 G RD1:FTP']"",RD1:$D(DUOUT),H^XUS:$D(DTOUT) I FBTYPE'=7 D WRONGT^FBAAUTL1 G RD0
RD2	I $D(^FBAACNH("AD",DFN)) G CKVEIW
	S FBLTD=$O(^FBAACNH("AF",DFN,0)) K:FBLTD<1 FBLTD S FBTRT="A",DIR(0)="DA^"_FBAABDT_".000001:"_FBAABDT_".999999:EXR",DIR("A")="Enter Admission Date/Time:  ",DIR("?")="Enter date pt. admitted to CNH facility (time is required)"
	D ^DIR K DIR G:$D(DIRUT)!'Y Q S FBY=+Y D DATCK2^FBAAUTL1 G:'$D(X) RD2
	S DIR(0)="S^1:AFTER RE-HOSPITALIZATION >15 DAYS;2:TRANSFER FROM OTHER CNH;3:FROM ASIH <15 DAYS;4:ALL OTHER",DIR("A")="Enter Admission Type" D ^DIR K DIR G:$D(DIRUT) Q S FBZ=+Y
	K DD,DO S X=FBY,DIC="^FBAACNH(",DIE=DIC,DIC(0)="LM",DLAYGO=162.3 D FILE^DICN G RD1:$D(DUOUT)!($D(DTOUT)),RD2:Y<0 S DA=+Y K DIC,DLAYGO
	S DR="8////^S X=FBVEN;Q;9////^S X=FTP;1////^S X=DFN;2////^S X=""A"";3////^S X=""Y"";4////^S X=DA;5////^S X=FBZ" L +FBAACNH(DA) D ^DIE L -FBAACNH(DA) I '$D(DTOUT) D PTF I '$G(FBRCHK) G RD1
Q	K DIC,DIE,DR,DA,DFN,FBTYPE,FTP,Y,X,FBPROG,FBVEN,CNT,DAT,F,FB7078,FBAABDT,FBAAEDT,FBAAOUT,FBASSOC,FBAUT,FBDX,FBI,FBLOC,FBPOV,FBPSA,FBPT,I,FBRR,FBTT,PI,PTYPE,T,TA,Z,ZZ,CNT,FBAUT,TA,DIRUT,DUOUT,DTOUT,FBY,FBLTD,FBTRT
	K FBZ,FBRCHK
	Q
CKVEIW	W !!,*7,"Veteran already has an active admission, you may use the edit option to edit it.",!
	S DIR(0)="Y",DIR("A")="Want data related to active admission displayed",DIR("B")="NO" D ^DIR K DIR I Y S IFN=$O(^FBAACNH("AD",DFN,0)) D ^FBNHDEC
	I '$G(FBRCHK) G RD1
	Q
PTF	S Y=FBY_"^"_1 D WAIT^DICD,CREATE^DGPTFCR W !,*7,$S(Y>0:"Non-VA PTF Record Created.",1:"Unable to create Non-VA PTF Record."),!
	Q

FBNHEAU1
FBNHEAU1	;AISC/dmk - continue FBNHEAUT cnh authorization ;4/28/93  11:04
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
END	K DA,DR,F,FBAASKV,FBAADDYS,FBAALT,FBAAP79,FBAATT,FBANEW,FBAOLD,FBCOUNTY,FBDX,FBI,FBRR,FBSITE,FBTYPE,FBXX,I,J,K,PI,S,T,Z,ZZ,FBPROG,PRC,PRCS,PRCSCPAN,DFN,CNT,X1,X2,FBMM
	K DIC,DIE,FB7078,FBAA78,FBAADA,FBAAASKV,FBBEGDT,FBCD,FBDAYS,FBDEFP,FBDEV,FBENDDT,FBERR,FBNAME,FBNUM,FBO,FBOBN,FBPAYDT,FBPAYEDT,FBPOSDT,FBPSADF,FBSEQ,FBSSN,FBT,FBVEN,FBVCAR,FTP,IFN,PGM,VAL,VAR,X,Y
	K FB("SITE"),FBAAADA,FBABD,FBDD,FBEDT,FBEND,FBFLAG,FBLG,FBMULT,FBONE,FBOUT,FBPOP,FBRIFN,FBTDT,FBTOT,FBTRDYS,FBTWO,FBZZ,FB,FBRIFN,FBRATE,FBC,FBID,FBAAOUT,FBVIEN,FBX,FBATODT,FBCNUM,FBFR
	Q
	;
NOGOOD	;ERROR
	W !!,"No valid Obligation Number selected" G END
	;
PROB	;ERROR
	W !!,"Unable to get Obligation Sequence number from IFCAP!",!,"Check with IFCAP package coordinator!" Q
	;
PROB2	;ERROR
	W !!,"Unable to add an entry in the VA Form 7078 file.  Please see Computer Staff!" Q
	Q

FBNHEAU2
FBNHEAU2	;AISC/dmk - ask rates for cnh authorization ;4/28/93  11:04
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
GETRAT	S FBERR="",FBMULT=0,FBVIEN=IFN I '$D(^FBAA(161.21,"C",IFN)) S FBERR=1 W !,"Vendor: ",$P(^FBAAV(IFN,0),"^")," has no Contract data on file" Q
	S FBRIFN=$O(^FBAA(161.21,"ACR",IFN,-(FBPAYDT+.9))) I 'FBRIFN W !,"Vendor: ",$P(^FBAAV(IFN,0),"^")," has no current Contract data on file" S FBERR=1 Q
	S FBRIFN=$O(^FBAA(161.21,"ACR",IFN,FBRIFN,0)),FBC(0)=^FBAA(161.21,+FBRIFN,0),FBCNUM=$P(FBC(0),U),FBRIFN(0)=FBC(0)
	S FBEDT=$P(FBC(0),U,2),FBTDT=$P(FBC(0),U,3)
	I FBTDT<FBENDDT D
	.S CNT=0,FBMULT=1
	.F I=FBTDT+.9:0 S I=$O(^FBAA(161.21,"AC",IFN,I)) Q:'I!(I>FBENDDT)  S CNT=CNT+1,FBRIFN(CNT)=^FBAA(161.21,$O(^(I,0)),0)
	I FBPAYDT>FBTDT S FBERR=1 W !,"Vendor: ",$P(^FBAAV(IFN,0),U)," has no current contract on file.",! Q
	;display rates for selection
	W !!?25,"VENDOR RATE SELECTION",!!
	I FBMULT=0 S FBVIEN=IFN,FBX=$$RATE^FBAAVD1(FBCNUM),FBRATE="" D DISPLAY^FBAAVD1 S FB(0)=FBBEGDT_"^"_$S(FBTDT>FBENDDT:FBENDDT,1:FBTDT)_"^"_FBRATE_"^"_FBCNUM S:'FBRATE FBERR=1
	I FBMULT S I="",FBRATE=0 F  S I=$O(FBRIFN(I)) Q:I=""!(FBERR)  D
	. S FBX=$$RATE^FBAAVD1($P(FBRIFN(I),U)),FBFR=$$FR(FBPAYDT,$P(FBRIFN(I),U,2)),FBTO=$$TO(FBENDDT,$P(FBRIFN(I),U,3)),FBCNUM=$P(FBRIFN(I),U)
	.W !?14,"For dates ",$$DATX^FBAAUTL(FBFR)_" - "_$$DATX^FBAAUTL(FBTO)_" : ",! D DISPLAY^FBAAVD1 S:'FBRATE FBERR=1 Q:FBERR  D
	.. S FB(I)=FBFR_"^"_FBTO_"^"_FBRATE_"^"_FBCNUM
	;I FBMULT S FBCHECK=1 D EST K FBCHECK,FBATODT,FBTO,FBDEFP I FBERR D
	;. W !,*7,"Insufficient contract data on file for current month.",!
	I FBMULT K FBATODT,FBTO
	Q
	;
FR(X,Y)	;return date that should be used as from date at prompt
	;x=authorization from date
	;y=contract from date
	Q $S(X>Y:X,1:Y)
	;
TO(X,Y)	;return date that is default to date
	;x=last day of authorization or month
	;y=last day of contract
	Q $S(X>Y:Y,1:X)
	;
EST	;calculate estimate amount to post to 1358 for month of authorization
	;the FB( array contains all rate information currently available
	;for this patient based on vendor contract information.
	;FBPAYDT=begin date of autorization
	;FBENDDT=end date of authorization
	;FBATODT=either end of month or end of autorization (whichever less)
	S Z=$Q(FB) I Z="" S FBERR=1 D ERROR Q
	I '$D(FBATODT) S FBATODT=$S($E(FBPAYDT,1,5)_"00"+(FBDAYS)>FBENDDT:FBENDDT,1:$E(FBPAYDT,1,5)_"00"+(FBDAYS))
	S FBDEFP=0,X=@Z
	I FBATODT'>$P(X,U,2) S FBDEFP=($$DTC^FBUCUTL(FBATODT,FBPAYDT)+1)*$P(X,U,3) Q
	S FBDEFP=FBDEFP+($$DTC^FBUCUTL($P(X,U,2),$P(X,U))+1*$P(X,U,3))
MORE	S Z=$Q(@Z) I Z="" S FBERR=1 D ERROR Q
	S X=@Z,FBTO=$S($P(X,U,2)'>FBATODT:$P(X,U,2),1:FBATODT)
	I FBTO<$P(X,U) S FBERR=1 D ERROR Q
	I FBTO'>$P(X,U,2) S FBDEFP=FBDEFP+($$DTC^FBUCUTL(FBTO,$P(X,U))+1*$P(X,U,3)) Q
	S FBDEFP=FBDEFP+($$DTC^FBUCUTL($P(X,U,2),$P(X,U))+1*$P(X,U,3))
	G MORE
ERROR	W:'$D(FBCHECK) *7,!,"Unable to calculate total estimated amount.  Check CNH contracts.",!
	Q
	;
FILE	;file entries for the patients authorization in file 161.23.
	;this file contains from and to dates and the rate we paid
	;during that time frame for the 7078.
	I $Q(FB)="" S FBERR=1 Q
	I '$G(DFN) S FBERR=1 Q
	I '$G(FBAA78) S FBERR=1 Q
	N DA,DIC,DIE,DR,DLAYGO,FBI S FBI=""
	F  S FBI=$O(FB(FBI)) Q:FBI=""  D
	. S X=$P(FB(FBI),U),DIC="^FBAA(161.23,",DIC(0)="L",DLAYGO=161.23 K DD,DO D FILE^DICN I Y<0 S FBERR=1 Q
	.S DA=+Y,DIE=DIC,DR=".02////^S X=$P(FB(FBI),U,2);.03////^S X=FBAA78;.04////^S X=DFN;.05////^S X=$P(FB(FBI),U,3);.06////^S X=$P(FB(FBI),U,4)" D ^DIE
	Q

FBNHEAUT
FBNHEAUT	;AISC/DMK,GRR-ENTER/EDIT AUTHORIZATION ;12OCT89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D SITEP^FBAAUTL Q:FBPOP  S FBAADDYS=+$P(FBSITE(0),"^",13),FBAAASKV=$P(FBSITE(1),"^"),FBPROG=$S($P(FBSITE(1),"^",6)="":"I 1",1:"I $P(^(0),U,3)=7") W !!
	;
	S PRCS("TYPE")="FB",PRCS("A")="Select Obligation Number: " K PRCS("X") D EN1^PRCS58 G:Y<0 NOGOOD^FBNHEAU1 S FBOBN=$P(Y,"^",2) K PRCS("A")
	;
	W !! S DIC="^DPT(",DIC(0)="QEAZM" D ^DIC G END:Y<0 S DFN=+Y
	I $P($G(^DPT(DFN,.361)),"^")="" W !!,"ELIGIBILITY HAS NOT BEEN DETERMINED NOR PENDING, CANNOT ENTER AN AUTHORIZATION." G FBNHEAUT
	I $P($G(^DPT(DFN,.32)),"^",4)=2 W !!,"VETERAN HAS A DISHONORABLE DISCHARGE, " S X=$P($G(^(.321)),"^") W $S(X="Y":"ONLY ELIGIBLE FOR AGENT ORANGE.",1:"NOT ELIGIBLE FOR BENEFITS.")
	I "N"[$E(X) W ! S DIR("A")="Do you want to continue",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR G FBNHEAUT:$S($D(DIRUT):1,'Y:1,1:0)
	S DA=DFN I '$D(^FBAAA(DFN,0)) K DD,DO S (X,DINUM)=DFN,DIC="^FBAAA(",DIC(0)="LM",DLAYGO=161 D FILE^DICN K DIC,DLAYGO G:Y<0 END
	S:'$D(^FBAAA(DFN,1,0)) ^(0)="^161.01D^^"
	D ^FBAADEM ;G FBNHEAUT:FBAAOUT
	;
GETVEN	S FBPROG=7 D DATES^FBAAUTL2 G:FBBEGDT="" FBNHEAUT
	D GETVEN^FBAAUTL1 G END:X="^"!(X=""),GETVEN:IFN="" S FBVEN=IFN,FBPAYDT=FBBEGDT,X=+FBBEGDT D DAYS^FBAAUTL1 S FBDAYS=$S(X>(FBENDDT-FBBEGDT):(FBENDDT-FBBEGDT),1:X)
	D GETRAT^FBNHEAU2 G:FBERR GETVEN
	;CREATE AN ENTRY IN FILE 161
	K DD,DO S DLAYGO=161,DA(1)=DFN,(DIE,DIC)="^FBAAA("_DA(1)_",1,",DIC(0)="LQ",X=FBBEGDT D FILE^DICN K DLAYGO S DA=+Y,FBAAADA=DA
	S DIE=DIC,FBPSADF=$S($D(FBSITE(1)):$P(^DIC(4,$P(FBSITE(1),"^",3),0),"^",1),1:"")
	S DR=".02////^S X=FBENDDT;.03////^S X=7;S FBTYPE=7;100////^S X=DUZ;1////^S X=""YES"";.04////^S X=FBVEN;.095////1;101T;.065;.07;.021;.097;.08;S:X="""" Y="""";.085;S:X="""" Y="""";.086" D ^DIE
	I $D(DTOUT)!('$D(Y)=0) S DIC="^FBAAA("_DFN_",1," G DEL
	S FBVEN=FBVEN_";FBAAV("
	;
	S X=FBPAYDT D DAYS^FBAAUTL1 S FBATODT=$S($E(FBPAYDT,1,5)_"00"+X>FBENDDT:FBENDDT-1,1:$E(FBPAYDT,1,5)_"00"+X)
	D EST^FBNHEAU2
	I $G(FBDEFP)'>0 W !,*7,"Unable to determine estimated dollar amount, based on authorization",!,"dates and current vendor contracts.",! S DA=FBAAADA,DA(1)=DFN,DIC="^FBAAA("_DFN_",1," G DEL
	;CHECK 1358 and get next point number. create entry in 162.4
	S X=FBOBN K PRCS("A") S PRCS("TYPE")="FB" D EN1^PRCSUT31 I Y<0 S DIC="^FBAAA("_DFN_",1," D PROB^FBNHEAU1 G DEL
	S FB7078=$P(FBOBN,"-",2)_"."_Y,FBSEQ=Y,DIC="^FB7078(",DIC(0)="LQ",DLAYGO=162.4,X=FB7078 D ^DIC K DLAYGO I Y<0 S DIC="^FBAAA("_DFN_",1," D PROB2^FBNHEAU1 G DEL
	S (DA,FBAA78)=+Y
	S DIE=DIC,DR="[FBNH ENTER 7078]" D ^DIE
	I $O(^FBAAA(DFN,1,FBAAADA,2,0))>0 S ^FB7078(FBAA78,1,0)=^FBAAA(DFN,1,FBAAADA,2,0) F Z=0:0 S Z=$O(^FBAAA(DFN,1,FBAAADA,2,Z)) Q:Z'>0  S ^FB7078(FBAA78,1,Z,0)=^FBAAA(DFN,1,FBAAADA,2,Z,0)
	S $P(^FBAAA(DFN,1,FBAAADA,0),"^",9)=FBAA78_";FB7078(",^FBAAA("AG",FBAA78_";FB7078(",DFN,FBAAADA)=""
	;call to create entries in file 161.23, time sensitive file
	;that will store patient rates
	S FBERR=0 D FILE^FBNHEAU2 I FBERR W !,"Unable to create entry in Authorization Rate file (161.23).  Contact IRM.",! G ADM
	;call to create entry in ifcap 424.
	S FBMM=$E(FBBEGDT,4,5)
	S PRCS("TYPE")="FB" K PRCS("A") S FBNAME=$$NAME^FBCHREQ2(DFN),FBSSN=$$SSN^FBAAUTL(DFN) D NOW^%DTC S FBPOSDT=%,X=FBOBN_"^"_FBPOSDT_"^"_FBDEFP_"^^"_FBSEQ_"^"_FBNAME_"  ("_FBSSN_")"_"^"_DFN_";"_FBAA78_";"_$P(FBOBN,"-",2)_";"_FBMM D EN2^PRCS58
	I +Y=0 W !!,"Error trying to Post to 1358, DID NOT POST. Error was:",!,Y,!?7,"Adjust the 1358 for $",$FN(FBDEFP,",",2)," then use the",!?7,"Post Commitments for Obligation option!",!,*7 G ADM
	W !!,$J(FBDEFP,7,2),"  Posted to 1358"
	;
	;
CHEKP78	S FBNUM=$P(FBSITE(1),"^",5),FBO=$P(FBSITE(1),"^",7),FBT=$P(FBSITE(1),"^",8) D FBO^FBCHP78 G END:$D(DIRUT) S IOP="Q",FB7078=FBAA78 W !
	D IFCAP^FBAAUTL2
	I '$D(FBERR(1)) S VAR="FB7078^FBNUM^FBO^FBT^FB(""SITE"")",VAL=FB7078_"^"_FBNUM_"^"_FBO_"^"_FBT_"^"_FB("SITE"),PGM="START^FBCHP78",%ZIS("B")="" W ! D ZIS^FBAAUTL
	;
ADM	S DIR(0)="Y",DIR("A")="Do you want to Admit Patient to CNH now",DIR("B")="YES" D ^DIR K DIR I Y S FBVEN=+FBVEN,FTP=FBAAADA,FBAABDT=FBBEGDT,FBAAEDT=FBENDDT,FBEND=1,FBRCHK=1 D RD2^FBNHEA
	;
END	D END^FBNHEAU1
	Q
	;
DEL	S DIK=DIC D ^DIK K DIK,DIC D END^FBNHEAU1 G FBNHEAUT

FBNHED
FBNHED	;AISC/GRR-ENTER DISCHARGE FROM NURSING HOME ;30AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
	I '$D(^FBAACNH("AD",DFN)) W !!,*7,"Veteran does NOT have an active admission!" G RD1
RD0	S FBPROG="I $P(^(0),U,3)=7" D GETAUTH^FBAAUTL1 G RD1:FTP']"",RD1:$D(DUOUT),H^XUS:$D(DTOUT) I FBTYPE'=7 D WRONGT^FBAAUTL1 G RD0
	S IFN=+$O(^FBAACNH("AD",DFN,0)),FBTRT="D",FB(0)=$G(^FBAACNH(IFN,0)),FBLAD=$P(FB(0),"^",1),FBLTD=$O(^FBAACNH("AF",DFN,0)) D ^FBNHDEC
RD2	S DIR(0)="DA^::EXR",DIR("A")="Enter Discharge Date/Time:  ",DIR("?")="Enter date of discharge (time is required)" D ^DIR K DIR G:$D(DIRUT)!'Y Q S FBY=+Y D DATCK2^FBAAUTL1 G:'$D(X) RD2
	;check to see if enough rate info to date of discharge
	D DRIV^FBNHRAT(DFN,IFN,.FB,$P(FBY,".")) I $D(FBUNR) D  D Q G RD1
	.W !!,*7,"Unable to establish rates for the following timeframes:"
	.S J=0 F  S J=$O(FBUNR(J)) Q:'J  W !?5,$$DATX^FBAAUTL(J)," through ",$$DATX^FBAAUTL($O(FBUNR(J,0)))
	.W !!,*7,"You can not discharge this patient without sufficient rate information.",!,"Check your contract!"
	S FBJ=0 F  S FBJ=$O(^FBAACNH("AF",DFN,FBJ)) Q:'FBJ  S FBK=$O(^FBAACNH("AF",DFN,FBJ,0)) I $P($G(^FBAACNH(FBK,0)),"^",5)=IFN D  Q
	.I $P(^FBAACNH(FBK,0),"^",7)=3 S FBASIH=1
	S DIR(0)=$S($G(FBASIH):"S^4:ASIH;5:DEATH WHILE ASIH",1:"S^1:REGULAR;2:DEATH;3:TRANSFER TO OTHER CNH;6:REGULAR - PRIVATE PAY"),DIR("A")="Enter Discharge Type:  " D ^DIR K DIR G:$D(DIRUT) Q S FBZ=+Y
	K DD,DO S X=FBY,DIC="^FBAACNH(",DIE=DIC,DIC(0)="LM",DLAYGO=162.3 D FILE^DICN G RD1:$D(DUOUT)!($D(DTOUT)),RD2:Y<0 S DA=+Y K DIC,DLAYGO
	S DR="8////^S X=FBVEN;1////^S X=DFN;2////^S X=""D"";4////^S X=IFN;7////^S X=FBZ" L +^FBAACNH(DA) D ^DIE L -^FBAACNH(DA) K DIE
	S DIE="^FBAACNH(",DA=IFN,DR="3///@" D ^DIE
	D UPDT
	G RD1
Q	K FBTRT,FBTYPE,FBLAD,FTP,FBPROG,CNT,DAT,DIC,FBAUT,F,FBAAOUT,FBDX,FBI,FBRR,FBXX,I,PI,PTYPE,T,X,Y,Z,ZZ,FBY,FB7078,FBAAAD,FBAABDT,FBAAEDT,FBASSOC,FBAT,FBLOC,FBLTD,FBPDT,FBPOV,FBY1,FBNHED,FBUNR,DFN,IFN,FBASIH,FBJ,FBK
	K FBPSA,FBPT,FBTT,FBVEN D Q^FBNHRAT Q
UPDT	S DA(1)=DFN,FBY1=$P(FBY,".")
	S DIE="^FBAAA("_DA(1)_",1,",DR=".02////^S X=FBY1",DA=FTP D ^DIE K DIE,DR
	K DA S DIE="^FB7078(",DR="4////^S X=FBY1",DA=FB7078 D ^DIE K DIE,DR
	;update rate sensitive file since To Date of authorization is changed
	Q:FBY1>FBAAEDT
	S (FBO,FBAA(1))=FBAABDT,FB1=FBAAEDT,FBAA(2)=FBY1
	D UPDATE^FBNHEDA1
	K FBO,FBAA,FB1,FBZ
	Q

FBNHEDA1
FBNHEDA1	;AISC/DMK-EDIT CNH AUTHORIZATION CONT ;4/28/93  11:05
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I FBO'=FBAA(1) D  Q:FBERR
	.D CK I FBERR D
	..S DA(1)=$G(DFN),DA=$G(FTP),DIE="^FBAAA("_DA(1)_",1,",DR=".01////^S X=FBO;.02////^S X=FB1" D ^DIE K DIE,DR
	.D DEL
	.D FILE^FBNHEAU2
	;
UPDATE	;called from edit authorization and FBNHED (enter discharge)
	I FBO=FBAA(1),FB1'=FBAA(2) D GET D
	.I FB1>FBAA(2) S (X,HOLDX)=$O(FBZ(FBAA(2)-.9)),X=$G(FBZ(+X)) I X D
	..S DA=X,DIE="^FBAA(161.23,",DR=".02////^S X="_FBAA(2) D ^DIE K DIE,DR
	..N FBI F FBI=HOLDX:0 S FBI=$O(FBZ(FBI)) Q:'FBI  D
	...S DA=FBZ(FBI),DIK="^FBAA(161.23," D ^DIK K DIK
	.I FBAA(2)>FB1 D
	..S X=$O(^FBAA(161.23,"AD",FB7078,-(FB1+.9)))
	..S (FBPAYDT,FBBEGDT)=$S(X>-FB1:$FN(X,"-"),1:FB1),(FBPAYDT,FBBEGDT)=$$CDTC^FBUCUTL(FBPAYDT,1),FBENDDT=FBAA(2) D  Q:FBERR
	...S X=+FBPAYDT D DAYS^FBAAUTL1 S FBDAYS=$S(X>(FBENDDT-FBBEGDT):(FBENDDT-FBBEGDT),1:X)
	...S IFN=+$P(FBNEW,U,4) D GETRAT^FBNHEAU2 Q:$G(FBERR)
	...D FILE^FBNHEAU2
	;
	Q
	;
DEL	;if from date of authorization is changed locate and delete
	;current entries in CNH authorization rate file.
	;FB7078 equal to internal entry number of 7078 for authorization
	I '$G(FB7078) S FBERR=1 Q
	N FBI S FBI=0
	F  S FBI=$O(^FBAA(161.23,"AC",FB7078,FBI)) Q:'FBI  I $D(^FBAA(161.23,FBI,0)) D
	.S DA=FBI,DIK="^FBAA(161.23," D ^DIK K DIK
	Q
	;
CK	;check if vendor has sufficient contract data
	N X,X1,Y
	S IFN=$P(FBNEW,U,4)
	S (FBBEGDT,FBPAYDT)=FBAA(1),FBENDDT=FBAA(2),X=+FBAA(1) D DAYS^FBAAUTL1 S FBDAYS=$S(X>(FBENDDT-FBBEGDT):(FBENDDT-FBBEGDT),1:X)
	D GETRAT^FBNHEAU2
	Q
	;
GET	I '$G(FB7078) S FBERR=1 Q
	I '$D(^FBAA(161.23,"AC",FB7078)) S FBERR=1 Q
	S FBZ=0
	F  S FBZ=$O(^FBAA(161.23,"AC",FB7078,FBZ)) Q:'FBZ  I $D(^FBAA(161.23,FBZ,0)) S FBZ(0)=^(0) D
	.S FBZ($P(FBZ(0),U,2))=FBZ
	K FBZ(0) Q

FBNHEDAD
FBNHEDAD	;AISC/GRR-EDIT ADMISSION TYPE FOR NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
RD2	S DIC("S")="I $P(^(0),U,3)=""A""&($P(^(0),U,2)=DFN)",DIC="^FBAACNH(",DIE=DIC,DIC(0)="AEQMZ",DLAYGO=162.3,DIC("A")="Select Admission Date/Time: " D ^DIC K DIC,DLAYGO G RD1:X="^"!(X=""),RD2:Y<0 S DA=+Y
	S DR="5;8" D ^DIE G H^XUS:$D(DTOUT),RD1
Q	K DIC,DIE,DR,DA,DFN,FBTYPE,FTP,Y,X,FBPROG
	Q

FBNHEDAT
FBNHEDAT	;AISC/GRR-ENTER/EDIT AUTHORIZATION ;02:07 PM  11 Apr 1990;
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D SITEP^FBAAUTL
RD1	S U="^" D GETVET^FBAAUTL1 G:DFN="" END
	S FBPROG="I $P(^(0),U,3)=7" D GETAUTH^FBAAUTL1 G RD1:'CNT!(FTP']"")!($D(DIRUT)) S (FBOLD,FBNEW,FBERR)=""
	K FBAUT,CNT S (DA(1),D0)=DFN,FBOLD=^FBAAA(DFN,1,FTP,0),DA=FTP,FBAAADA=DA,DIE="^FBAAA("_DFN_",1,",FBO=$P(FBOLD,"^"),(FB1,FBAA(2))=$P(FBOLD,"^",2)
	S FBPROG=7 D DATES^FBAAUTL2 S FBAA(1)=$S($G(FBBEGDT):FBBEGDT,1:FBO),FBAA(2)=$S($G(FBENDDT):FBENDDT,1:FB1)
DR	S DR=".01////^S X=FBAA(1);.02////^S X=FBAA(2)"
	S DR(1,161.01,1)="@2;.065;.07;.021;.08;S:X="""" Y=101;.085;S:X="""" Y=101;.086;101;.097" D ^DIE
	S FBNEW=$S('$D(DA):"",'$D(^FBAAA(DFN,1,DA,0)):"",1:^(0)) K DR
	I $D(Y)>0,FBNEW=""!(FBNEW=FBOLD) G RD1
	I FBNEW'=FBOLD,$P(FBNEW,"^")>$P(FBNEW,"^",2) S DR=".01////^S X=FBO;.02////^S X=FB1" D ^DIE K DR D ER G DR
	;
	S FBAA78=FB7078 D ^FBNHEDA1 K FBAA78 I FBERR S DA(1)=DFN,DA=FTP,DIE="^FBAAA("_DA(1)_",1,",DR=".01////^S X=FBO;.02////^S X=FB1" D ^DIE G END
	;
	S DIE="^FB7078(",DA=FB7078,FBAA78=DA,DR="5;6" I 'DA W !!,*7,"No 7078 on file!",! G END
	D:FBOLD'=FBNEW CHANGED
GO	D ^DIE
	I $O(^FBAAA(DFN,1,FBAAADA,2,0))>0 K ^FB7078(FBAA78,1) S ^FB7078(FBAA78,1,0)=^FBAAA(DFN,1,FBAAADA,2,0) F Z=0:0 S Z=$O(^FBAAA(DFN,1,FBAAADA,2,Z)) Q:Z'>0  S ^FB7078(FBAA78,1,Z,0)=^FBAAA(DFN,1,FBAAADA,2,Z,0)
RD2	S DIR(0)="Y",DIR("A")="Want to Queue 7078 for printing",DIR("B")=$S(FBOLD=FBNEW:"No",1:"Yes") D ^DIR K DIR G:Y'>0 RD1
CHEKP78	S FBNUM=$P(FBSITE(1),"^",5),FBO=$P(FBSITE(1),"^",7),FBT=$P(FBSITE(1),"^",8) D FBO^FBCHP78 G END:$D(DIRUT) S IOP="Q",%ZIS("B")="",FB7078=FBAA78,FB("SITE")=$P(FBSITE(1),"^",3) W !
	S VAR="FB7078^FBNUM^FBO^FBT^FB(""SITE"")",VAL=FB7078_"^"_FBNUM_"^"_FBO_"^"_FBT_"^"_FB("SITE"),PGM="START^FBCHP78" W ! D ZIS^FBAAUTL
	;
END	K D0,DA,FBAASKV,FBAADDYS,FBAALT,FBAAP79,FBAATT,FBNUM,FBDEV,FBO,FBT,FB7078,FBAA78,FBCOUNTY,FBDX,FBI,FBRR,FBVEN,FBTYPE,FBXX,I,J,K,PI,FBOLD,FBNEW,FBPSADF,FBAADA,FB1,FBERR,FBOUT,FBIFN,FBZ,FBBEGDT,FBENDDT,FBAUT
	K DIE,DIR,FBAAADA,FTP,PGM,VAL,VAR,X,Y,Z,DIC,A,FBAABDT,FBAAEDT,FBAAOUT,FBASSOC,FBLOC,FBPOV,FBPROG,FBPSA,FBPT,FBSITE,FBTT,PTYPE,T,ZZ,FB("SITE"),FBPOP,FBAA,FBBDT,FBTDAYS,HOLDX
	D END^FBNHEAU1
	D CLOSE^FBAAUTL
	Q
	;
CHANGED	S:$P(FBOLD,"^",1)'=$P(FBNEW,"^",1) DR="3////^S X=$P(FBNEW,U,1);"_DR
	S:$P(FBOLD,"^",2)'=$P(FBNEW,"^",2) DR="4////^S X=$P(FBNEW,U,2);"_DR
	Q
	;
ER	W !,*7,"From Date cannot be greater than the To Date.",!
	Q
	;
ER1	W !,*7,"This patient has movements after the authorization to date.  You must",!,"edit the patient's movements first.",!
	Q

FBNHEDDI
FBNHEDDI	;AISC/GRR-EDIT DISCHARGE FOR NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
RD2	S DIC("S")="I $P(^(0),U,3)=""D""&($P(^(0),U,2)=DFN)",DIC="^FBAACNH(",DIE=DIC,DIC(0)="AEQMZ",DLAYGO=162.3,DIC("A")="Select Discharge Date/Time: " D ^DIC K DIC,DLAYGO G RD1:X="^"!(X=""),RD2:Y<0 S DA=+Y,FBAADT=$P(Y,U,2)
	S FBDIST=$P(^FBAACNH(DA,0),U,8)
	S FBJ=9999999.999999-FBAADT F  S FBJ=$O(^FBAACNH("AF",DFN,FBJ)) Q:'FBJ  S FBK=$O(^FBAACNH("AF",DFN,FBJ,0)) I $P($G(^FBAACNH(FBK,0)),"^",5)=$P(^FBAACNH(DA,0),"^",5) D  Q
	.I $P(^FBAACNH(FBK,0),"^",7)=3 S FBASIH=1
	S DIR(0)=$S($G(FBASIH):"S^4:ASIH;5:DEATH WHILE ASIH",1:"S^1:REGULAR;2:DEATH;3:TRANSFER TO OTHER CNH;6:REGULAR - PRIVATE PAY"),DIR("A")="Discharge Type: ",DIR("B")=FBDIST D ^DIR K DIR Q:$D(DIRUT)  S FBZ=+Y
	S DR="7////^S X=FBZ" D ^DIE G RD1
Q	K DIC,DIE,DR,DA,DFN,FBTYPE,FTP,Y,X,FBPROG,FBASIH,FBK,FBJ,FBAADT,FBDIST,FBZ
	Q

FBNHEDPA
FBNHEDPA	;AISC/GRR-EDIT PAYMENT FOR COMMUNITY NURSING HOME ;08FEB90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EDIT	;ENTRY POINT TO EDIT PAYMENT
	S IOP=$S($D(ION):ION,1:"HOME") D ^%ZIS K IOP
BT	S DIC="^FBAA(161.7,",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,3)=""B9""",DIC("S")=$S($D(^XUSEC("FBAASUPERVISOR",DUZ)):DIC("S"),1:DIC("S")_"&($P(^(0),U,5)=DUZ)") D ^DIC
	G END:X=""!(X="^"),BT:Y<0 S FBN=+Y,FBN(0)=Y(0)
	S FBSTAT=^FBAA(161.7,FBN,"ST")
	I FBSTAT="C"&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,?3,"You must Reopen the batch prior to editting the invoice.",! G END
	I FBSTAT="S"!(FBSTAT="P")!(FBSTAT="R")&('$D(^XUSEC("FBAASUPERVISOR",DUZ))) W !!,*7,?3,"You must be a holder of the 'FBAASUPERVISOR' security key",!,?3,"to edit this invoice.",! G END
	I FBSTAT="T"!(FBSTAT="V") W !!,?3,"Batch has already been sent to Austin for payment.",! G END
INV	W ! S DIC("A")="Select Invoice Number: ",DIC="^FBAAI(",DIC(0)="AEQMZ",DIC("S")="I $P(^(0),U,17)=FBN" D ^DIC K DIC G BT:X=""!(X="^"),INV:Y<0 S FBI=+Y,FBOLD(0)=Y(0)
	S FBLISTC="",FBHDI=FBI W @IOF D START^FBCHDI S FBI=FBHDI K FBHDI
	K FBHAP,FBAP S (DIE,DIC)="^FBAAI(",DIC(0)="AEQM",DA=FBI,DR="[FBNH EDIT PAYMENT]",DIE("NO^")="" W ! N FBHAC D ^DIE K DIE("NO^")
	I $D(DTOUT) S DR="5///^S X="_$P(FBOLD(0),U,6)_";6///^S X="_$P(FBOLD(0),U,7) D ^DIE
	I $D(FBHAP),$D(FBAP),FBAP-FBHAP S FBDIF=FBAP-FBHAP,$P(^FBAA(161.7,FBN,0),"^",9)=$P(^FBAA(161.7,FBN,0),"^",9)+FBDIF
END	K DA,DFN,DIC,DIE,DR,FBAAOUT,FBDX,FBI,FBIN,FBLISTC,FBN,FBPROC,FBSTAT,FBVEN,FBVID,J,K,L,POP,Q,VA,VADM,X,Y,FBAC,FBAP,FBBAL,FBHAP,FBDIF
	D KILL^FBPAY K FBOLD,FBINODE,FBPAT,FBPRGNAM
	Q

FBNHEDTR
FBNHEDTR	;AISC/GRR-EDIT TRANSFER TYPE FOR NURSING HOME ;29AUG88
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D GETVET^FBAAUTL1 G:DFN']"" Q
	;
RD2	S DIC("S")="I $P(^(0),U,3)=""T""&($P(^(0),U,2)=DFN)",DIC="^FBAACNH(",DIE=DIC,DIC(0)="AEQMZ",DLAYGO=162.3,DIC("A")="Select Transfer Date/Time: " D ^DIC K DIC,DLAYGO G RD1:X="^"!(X=""),RD2:Y<0 S (DA,IFN)=+Y,FBAADT=$P(Y,U,2)
	S FBDA=$P(Y(0),U,5) D  I $G(FBERR) D Q G RD1
	.  I $O(^FBAACNH("AC",FBDA,DA)) W !,*7,"There are movements following this transfer that must be deleted first.",!! S FBERR=1
	;
	S FBTR=$P(Y(0),U,7),FBLTTYP=""
	S FBJ=9999999.999999-FBAADT F  S FBJ=$O(^FBAACNH("AF",DFN,FBJ)) Q:'FBJ  S FBK=$O(^FBAACNH("AF",DFN,FBJ,0)) I $P($G(^FBAACNH(FBK,0)),"^",5)=$P(^FBAACNH(DA,0),"^",5) D  Q
	. S FBLTTYP=$P(^FBAACNH(FBK,0),U,7)
	S DR="@1;6;S FBNTR=X;D CHKTR^FBNHEDTR;6////^S X=FBTR;S Y=""@1"""
	D ^DIE K DIE G Q:$D(DTOUT)
	D Q G RD1
	;
Q	K DIC,DIE,DR,DA,DFN,FBTYPE,FTP,Y,X,FBPROG,FBTR,FBNTR,IFN,FBAADT,FBJ,FBK,FBASIH,FBDA,FBERR,FBLTTYP
	Q
CHKTR	;called from dr string to make sure that the transfer type is
	;consistant, that is if the old transfer type (FBTR) is a loss
	;then the new transfer type (FBNTR) is also a loss.
	;
	I '$G(FBLTTYP),(FBTR>3&(FBNTR'>3)) D ERROR1 Q
	I '$G(FBLTTYP),(FBTR<4&(FBNTR'<4)) D ERROR Q
	S Y=""
	Q
	;
ERROR	;write inconsistant movement type which will reset the movement type
	;to original and allow user to re-edit.
	;
	W !?5,*7,"Movement Type must be consistant. A transfer that is a loss",!?5,"may only be editted to another 'loss' type.",!
	Q
ERROR1	;write inconsistant movement type 'gain', reset transfer type and re-edit
	;
	W !?5,*7,"Movement Type must be consistant.  A transfer that is a gain",!?5,"may only be editted to another 'gain' type.",!
	Q

FBNHEP
FBNHEP	;AISC/GRR-ENTER NURSING HOME PAYMENT ;4/7/93  17:33
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^FBAA(161.7,"AB","O",DUZ)) G NOBAT^FBNHEP2
	S FBOUT=1 F I=0:0 S I=$O(^FBAA(161.7,"AB","O",DUZ,I)) Q:I'>0  I $D(^FBAA(161.7,I,0)),$P(^(0),"^",3)="B9",$P(^(0),"^",15)="" S FBOUT=0 Q
	G:FBOUT NOBAT^FBNHEP2
	D GETBAT^FBNHEP2 G Q:FBOUT!('$D(FBBAT)) W !
	;
RD	S FBAAPTC="V",FBER=0,%DT="AEP",%DT("A")="Payments for which Month/Year: " D ^%DT G:X="^"!(X="") Q
	S FBPAYDT=$E(+Y,1,5)_"00",FBMM=$E(+Y,4,5),FBYY=$E(+Y,2,3),X=+Y S FBDAYS=$$DAYS^FBNHEP1(X),(FBENDDT,FBPAYEDT)=$E(+Y,1,5)_FBDAYS
	;
GETVET	K FB,FB7078,FBAABDT,FBAAEDT,FBASSOC,FBAT,FBAUT,FBBEG,FBDEFP,FBEND,FBHI,FBPDT,FBPOV,FBPREV,FBPROG,FBPRTR,FBPSA,FBPT,FBRIFN,FBTRDYS,FBTT,FBTYPE,FBVEN,FBZ,FTP,IFN,FBAAID,FBAAVID
	S FBENDDT=$E(+FBENDDT,1,5)_$$DAYS^FBNHEP1(FBENDDT) D GETVET^FBAAUTL1 G:DFN']"" Q S FBPROG="I $P(^(0),U,3)=7,($P(^(0),U,9)'[""FB583"")" D GETAUTH^FBAAUTL1 G GETVET:FTP']"",GETVET:$D(DIRUT) K FBAAOUT
	I $E(FBPAYDT,1,5)<$E(FBAABDT,1,5)!($E(FBPAYDT,1,5)>$E(FBAAEDT,1,5)) W !!,*7,"Payment Period is NOT within the veterans authorized dates!" G GETVET
	;
GETVEN	S FBERR=0,IFN=$G(FBVEN) D:'IFN GETVEN^FBAAUTL1 G:IFN'>0 Q S FBENDFLG=$S(FBAAEDT'>FBENDDT:1,1:""),FBENDDT=$S(FBENDDT>FBAAEDT:FBAAEDT,1:FBENDDT)
	I $P($G(^FBAAV(+IFN,"ADEL")),U)="Y" W !!,*7,"Vendor is flagged for Austin deletion!",! G Q
	K FB D CKRAT^FBNHEP2 G:FBERR GETVET
	I $D(^FBAAI("AA",IFN,DFN,$E(FBPAYDT,1,5))) S FBINA=$O(^FBAAI("AA",IFN,DFN,$E(FBPAYDT,1,5),0)) W !!,*7,"Invoice (# ",FBINA,") already exists for treatment provided in the",!,"month and year selected.",! G CHKAHD
	;
LETSGO	D GETACT G:FBERR GETVET
	D:$D(FBNOAC) CALC^FBNHEP2 G:FBERR GETVET
	;
ADDMOR	I '$D(FBNOAC) D DAYS^FBNHEP2,CALC1^FBNHEP2
	I FBTRDYS>0 W !!!,"Amount based on ",FBTRDYS," days of care."
	W !!,"    Total Amount calculated is: $",$J(FBDEFP,7,2),!
	;
RD3	S DIR(0)="Y",DIR("A")="Want to Continue with Payment Entry",DIR("B")="YES" D ^DIR K DIR G ^FBNHEP1:Y,GETVET
	;
GETACT	D HED^FBNHDEC S (FBTRDYS,FBTRDYS(2))=0,FBPRTR="",FBNAC=$O(^FBAACNH("AG",DFN,FBVEN,$S(FBAABDT>(FBPAYDT+1):FBAABDT,1:FBPAYDT))) G:FBNAC'>0!($P(FBNAC,".")>FBENDDT) NOAC
	;
	S FBRIFN=$O(^FBAACNH("AG",DFN,FBVEN,FBNAC,0)),Z=$G(^FBAACNH(FBRIFN,0)) Q:Z=""
	I '$D(FBPNAC),$P(Z,"^",3)="T"&($P(Z,"^",7)<4) D
	.S FBHZ=Z D GETPRV S Z=FBPRTR Q:Z=""  D DISPAC S Z=FBHZ,FBPNAC=FBPAYDT+1 D
	..S FBTRDYS=FBTRDYS+(($P(FBNAC,".")-FBPNAC)),FBTRDYS=$S(FBTRDYS>0:FBTRDYS,((FBAABDT<FBAAEDT)&(+$E(FBAAEDT,6,7)=1)):0,1:1)
	S FBPNAC=FBNAC,FBCOUNT=$S($P(Z,"^",3)="A":1,$P(Z,"^",3)="T":$S($P(Z,"^",7)>3:1,1:0),1:0) S FBLTT=$P(Z,"^",3) D:FBLTT'="D" DISPAC G:$P(Z,"^",3)'="D" CONT
	S FBHZ=Z D GETPRV S Z=FBPRTR G:FBPRTR="" GETVET D DISPAC S Z=FBHZ D DISPAC I $P(FBPRTR,"^",3)="T"&($P(FBPRTR,"^",7)<4) G SKIPC
	S FBTRDYS=FBTRDYS+($P(FBNAC,".",1)-FBPAYDT)-1,FBTRDYS=$S(FBTRDYS>0:FBTRDYS,((FBAABDT<FBAAEDT)&(+$E(FBAAEDT,6,7)=1)):0,1:1)
	;
SKIPC	S FBCOUNT=0
	;
CONT	F I=0:0 S FBNAC=$O(^FBAACNH("AG",DFN,FBVEN,FBNAC)) Q:FBNAC'>0!($P(FBNAC,".")>FBENDDT)  S FBRIFN=$O(^FBAACNH("AG",DFN,FBVEN,FBNAC,0)) I $D(^FBAACNH(FBRIFN,0)) S Z=^(0),FBLTT=$P(Z,"^",3) D MORE
	I FBCOUNT S FBTRDYS=FBTRDYS+(FBENDDT-$P(FBPNAC,".",1))+$S(FBLTT="D":0,FBLTT="T":$S($P(Z,"^",7)<4:0,1:1),1:1),FBTRDYS=$S(FBTRDYS>0:FBTRDYS,((FBAABDT<FBAAEDT)&(+$E(FBAAEDT,6,7)=1)):0,1:1)
	G ENDACT
	;
MORE	D DISPAC S FBTRDYS=FBTRDYS+($P(FBNAC,".",1)-$P(FBPNAC,".",1)+$S(FBLTT="D":0,FBLTT="T":$S($P(Z,"^",7)<4:0,1:1),1:1)),FBTRDYS=$S(FBTRDYS>0:FBTRDYS,((FBAABDT<FBAAEDT)&(+$E(FBAAEDT,6,7)=1)):0,1:1)
AHEAD	S FBPNAC=FBNAC,FBLTT=$P(Z,"^",3),FBCOUNT=$S(FBLTT="A":1,FBLTT="T":$S($P(Z,"^",7)>3:1,1:0),1:0)
	Q
ENDACT	K FBCOUNT,FBNAC,FBPNAC,FBLTT Q
	;
GETPRV	S FBPRTR="",FBPREV=$O(^FBAACNH("AF",DFN,(9999999-FBPAYDT))) G:FBPREV'>0 PROB^FBNHEP1 S (FBPIFN,FBRIFN)=$O(^(FBPREV,0)),FBPRTR=$G(^FBAACNH(FBPIFN,0))
	Q
	;
NOAC	D GETPRV G:FBPRTR="" ENDACT S Z=FBPRTR,FBNOAC=1
	W !!,"No movements during payment period. Last transaction prior was:",! D DISPAC
	I $P(Z,"^",3)="D" W !,*7,"Veteran not provided care during Payment Period!" G ENDACT
	I $P(Z,"^",3)="T"&($P(Z,"^",7)<4) W !,*7,"Veteran has not been in Nursing Home during Payment Period" G ENDACT
	S FBTRDYS=$E(FBENDDT,6,7)-$G(FBENDFLG) G ENDACT
	;
DISPAC	S Y=$P(Z,"^"),FBTYPE=$P(Z,"^",3) D PDATE^FBAAUTL,ADD^FBNHDEC:FBTYPE="A",TRAN^FBNHDEC:FBTYPE="T",DIS^FBNHDEC:FBTYPE="D"
	S FBZ(FBRIFN)=$P($P(Z,"^"),".")_"^"_$S($P(Z,U,3)="A":1,$P(Z,U,3)="T":$S($P(Z,U,7)>3:1,1:0),1:0)
	Q
	;
Q	K FBAAAD,FBAT,FBBDT,FBIFN,FBPDT,FBTDAYS,FBPAYEDT,PSA,DIRUT,DUOUT,DTOUT,FBNOAC,FB,FBZ,FBZZ,FBDEFP,FBBEG,FBEND,FBHI,FBX1,FBAMTP,FBNHAC,DFN,FB583,FBENDFLG
	G Q^FBNHEP2
	;
CHKAHD	S DIR(0)="Y",DIR("A")="Do you want to continue entering this payment",DIR("B")="No" D ^DIR K DIR G GETVET:Y=0,GETVET:$D(DIRUT),LETSGO
	Q

FBNHEP1
FBNHEP1	;AISC/GRR-PAYMENT PROCESS CONTINUED ;09AUG89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	K FBAAID,FBAAVID D GETNXI^FBAAUTL W !!,"Invoice # ",FBAAIN," assigned to this invoice"
	S DIC="^FBAAI(",X=FBAAIN,DIC(0)="L",DLAYGO=162.5 D ^DIC S DA=+Y K DLAYGO
RID	D GETINDT^FBAACO1 G DEL:$G(FBAAOUT)
	S DIE=DIC,FBNL=""
	S DR="1////^S X=FBAAID;46////^S X=FBAAVID;47////^S X=1;2////^S X=IFN;3////^S X=DFN;20////^S X=FBBAT;7;S FBNHAC=X;5////^S X=$S(FBPAYDT>FBAABDT:(FBPAYDT+1),1:FBAABDT)"
	S DR=DR_";6////^S X=FBENDDT;8//^S X=$S(FBNHAC>FBDEFP:FBDEFP,1:FBNHAC);S FBAMTP=X;S:FBNHAC-FBAMTP=0 Y=11"
	S FBI7078=FB7078_";FB7078("
	S DR(1,162.5,1)="9//^S X=FBNHAC-FBAMTP;10R;S:X'=4 Y=11;18;11////^S X=7;12////^S X=FBAAPTC;23////^S X=FBPSA;4////^S X=FBI7078;21////^S X=FBPOV;22////^S X=FBPT;S FBTST=1"
	D ^DIE I '$G(FBTST) W !,*7,"Entering an '^' will delete this payment" S DIR(0)="Y",DIR("A")="Shall I delete",DIR("B")="No" D ^DIR G DEL:$D(DIRUT)!(Y),RID
	K FBTST G GETVET^FBNHEP
DEL	S DIK="^FBAAI(" W !!,"Deleting Invoice !" D ^DIK K DIK G GETVET^FBNHEP
	Q
PROB	W !,*7,"The patient was not in this vendor's facility for the month and year selected!",!,"Use the Display Episode of Care option to review this veteran's activity!" S FBERR=1
	Q
	;
TRUB	W !!,*7,"Check Contract data for Community Nursing Home: ",$P(^FBAAV(IFN,0),"^",1),!,"It is not complete",!! S FBERR=1 Q
	;
DAYS(X)	;CALCULATES THE NUMBER OF DAYS IN MONTH
	N X1
	S X1=X,X=+$E(X,4,5),X=$S("^1^3^5^7^8^10^12^"[("^"_X_"^"):31,X=2:28,1:30) I X=28,'($E(X1,1,3)#4) S X=29
	Q X

FBNHEP2
FBNHEP2	;AISC/GRR-ENTER NURSING HOME PAYMENT ;12:05 PM  13 Jun 1990;
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
NOBAT	W !!,*7,"You do not have an open CNH Batch.  You must have an open",!,"CNH type Batch before you can enter a payment!",!
	D Q
	Q
	;
GETBAT	S FBOUT=0,DIC="^FBAA(161.7,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,3)=""B9""&($P(^(0),U,5)=DUZ)&($P(^(0),U,15)="""")&($G(^(""ST""))=""O"")" W ! D ^DIC K DIC
	I X=""!(X="^") S FBOUT=1 Q
	G GETBAT:Y<0 S FBBAT=+Y,FBCNH=1
	Q
Q	K FBYY,FBMM,FBDAYS,FBPAYDT,FBENDDT,Z,Y,DIC,FBRIFN,CNT,%DT,FBAABDT,FBAAEDT,FBAAPTC,FBDEFP,FBER,FBERR,FBHZ,FBINA,FBIRAT,FBPIFN,FBPREV,FBPROG,FBPRTR,FBSRAT,FBTRDYS,FBTYPE,FBVCAR,I,IFN,VAL,X,DA,DIE,DR,FBAAID,FBAAIN,FBNL,FBI7078,FBBAT,FBOUT
	K DAT,F,FBAUT,FBDX,FBEDT,FBI,FBMULT,FBRR,FBTDT,FBXX,FTP,PI,PTYPE,T,ZZ,FB7078,FBAAOUT,FBASSOC,FBLOC,FBPOV,FBPSA,FBPT,FBTT,FBVEN,TA,FBCNH
	Q
	;
CKRAT	;check rates and fill gaps if needed
	K FB S FBERR=0 N I,J,FBVIEN,FBCHFDT,FBCHTDT,FBCIEN,FBCNUM,FBDDT,FBEXDT,FBEXNDT,FBFND,FBRFDT,FBRTDT,FBRT,FBUNR S I=0
	F  S I=$O(^FBAA(161.23,"AC",FB7078,I)) Q:'I  I $D(^FBAA(161.23,I,0)) S J=^(0) D
	.S FBRT($P(J,U))=$P(J,U,5)_"^"_$P(J,U,2)
	S FBRFDT=0,FBCHFDT=$S(FBAABDT<FBPAYDT:$E(FBPAYDT,1,5)_"01",1:FBAABDT),(FBCHTDT,FBDDT)=FBENDDT,I=DFN,FBVIEN=IFN
	D GETRAT^FBNHRAT,CKFRDT^FBNHRAT
	I $D(FBUNR) S FBERR=1 D ERR K FB Q
	D GETRAT
	Q
GETRAT	N I,J,FBCK S I=0
	F  S I=$O(^FBAA(161.23,"AC",FB7078,I)) Q:'I  I $D(^FBAA(161.23,I,0)) S J=^(0) D
	.S FB($P(J,U,2))=$P(J,U,5)_"^"_$P(J,U)
	I $O(FB(FBPAYDT+.9))="" S FBERR=1 D ERR Q
	Q
	;
CALC	;get dollar amount to pay when no movements in month.
	;FBPAYS=# of days in month
	;FBTRDYS=# of treatment days
	;FBPAYDT=month of payment
	;FBENDDT=last day of payment month or last day of authorization
	S FBDEFP=0 N FBCT S FBCT=0
	I $G(FBDAYS) S FBTRDYS=$S(FBTRDYS>FBDAYS:FBDAYS,1:FBTRDYS)
	S X=$S(FBAABDT>(FBPAYDT):FBAABDT-1,1:FBPAYDT)
	S Y=$O(FB(X)) I FBENDDT'>Y S FBDEFP=FBTRDYS*+FB(Y) Q
RATE	S X1=$O(FB(X)),FBCT=FBCT+1 I 'X1 S FBERR=1 Q
	S FBX1=($S(X1>(FBENDDT-$G(FBENDFLG)):(FBENDDT-$G(FBENDFLG)),1:X1)-X) S:FBCT'>0 FBX1=FBX1+1 S FBDEFP=FBDEFP+(FBX1*$P(FB(X1),U)) S X=X1
	I FBENDDT>X G RATE
	Q
	;
ERR	W !,"Insufficient Authorization Rate data on file for patient: ",$$NAME^FBCHREQ2(DFN) ;,!,"Use the Edit Authorization option prior to entering payment.",!!
	W !,"Take the appropriate action prior to entering a payment:"
	W !?3,"Use the Edit Authorization option to modify the authorization period or",!?3,"assure a contract with valid rates exists for the payment period before",!?8,"continuing with this payment entry.",!!
	Q
	;calculate dollars when at least one movement in month.
CALC1	S (I,J,Z,FBDEFP)=0
	F  S J=$O(FBZZ(J)) Q:'J  D
	.S I=$O(FBZZ(0)) Q:'I  D
	..F  Q:'$D(FBZZ(I))  S X=$P(FBZZ(I),"^"),Y=$O(FB(X-.1)),X1=$O(FB(X-.1)) Q:'Y  D
	...I $P(FBZZ(I),"^",2)>Y S Z=1 D DEFP S Z=0 S $P(FBZZ(I),"^")=Y+1 Q
	...S Y=$P(FBZZ(I),"^",2) D DEFP K FBZZ(I)
	K I,J,X,Y,X1 Q
	;
DEFP	S FBDEFP=FBDEFP+(($S(FBAABDT=FBAAEDT:1,1:Y-X)+$P(FBZZ(I),"^",3)+Z)*+FB(X1))
	Q
	;
DAYS	S (I,FBTRDYS)=0 K FBPREV,FBHI
	S FBBEG=FBPAYDT+1
	F  S I=$O(FBZ(I)) Q:'I  D
	.I '$D(FBPREV),$P(FBZ(I),U,2) S FBBEG=$S($P(FBZ(I),U)>FBPAYDT:$P(FBZ(I),U),1:FBPAYDT),FBPREV=1
	.I '$P(FBZ(I),U,2),$S('$D(FBHI):1,1:$P(FBZ(+FBHI),U,2)) S FBEND=$P(FBZ(I),U),FBTRDYS=FBTRDYS+($S(FBEND-FBBEG:FBEND-FBBEG,((FBAABDT<FBAAEDT)&(+$E(FBAAEDT,6,7)=1)):0,1:1))+$P(FBZ(I),U,2) S FBZZ(I)=FBBEG_"^"_FBEND
	.I $D(FBHI),$P(FBZ(I),U,2) S FBBEG=$P(FBZ(I),U)
	.S FBHI=I
	I FBENDDT>$P(FBZ(FBHI),U),$P(FBZ(FBHI),U,2) S FBTRDYS=FBTRDYS+($S(FBENDDT-FBBEG:FBENDDT-FBBEG,1:1))+1,$P(FBZZ(FBHI),U,3)=1 I '+FBZZ(FBHI) S $P(FBZZ(FBHI),"^",1,2)=FBBEG_"^"_FBENDDT
	I FBENDDT=$P(FBZ(FBHI),U),$P(FBZ(FBHI),U,2) S FBTRDYS=FBTRDYS+1 I '+$G(FBZZ(FBHI)) S $P(FBZZ(FBHI),"^",1,2)=FBBEG_"^"_FBENDDT
	Q
CHECK	N FBCK,FBCK1
	S FBCK=$S(FBABD<FBPAYDT:($E(FBPAYDT,1,5)_"01"),1:FBABD),FBCK1=$O(FB(FBCK-.1)) I $P(FB(FBCK1),"^",2)>FBCK S FBERR=1 D ERR Q
	Q

FBNHET
FBNHET	;AISC/GRR-ENTER TRANSFER FOR NURSING HOME ;09AUG89
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
RD1	D Q,GETVET^FBAAUTL1 G:DFN']"" Q
	I '$D(^FBAACNH("AD",DFN)) W !!,*7,"Veteran does NOT have an active admission!" G RD1
RD0	S FBPROG="I $P(^(0),U,3)=7" D GETAUTH^FBAAUTL1 G RD1:FTP']"",RD1:$D(DUOUT),H^XUS:$D(DTOUT) I FBTYPE'=7 D WRONGT^FBAAUTL1 G RD0
	S IFN=$O(^FBAACNH("AD",DFN,0)),FBTRT="T",FBLTD=$O(^FBAACNH("AF",DFN,0)),FBIFN=$O(^FBAACNH("AF",DFN,FBLTD,0)),FBLTT=$P(^FBAACNH(FBIFN,0),"^",3),FBLTTYP=$S(FBLTT'="T":"",1:$P(^(0),"^",7))
	;
RD2	D ^FBNHDEC
	W ! S DIR(0)="DA^::EXR",DIR("A")="Enter Transfer Date/Time: ",DIR("?")="Enter date of transfer (time is required)" D ^DIR K DIR G:$D(DIRUT)!('Y) RD1
	I $D(FBTRT),$D(FBLTD),(9999999.999999-Y)'<FBLTD D  G RD2:'$G(X)
	.  W !,*7,"The date/time must follow an existing movement.",! H 2
	.  K X
	S FBY=+Y
	S DIR(0)="S^1:TO AUTHORIZED ABSENCE;2:TO UN-AUTHORIZED ABSENCE;3:TO ASIH"
	S DIR(0)=$S('$G(FBLTTYP):DIR(0),FBLTTYP<4:"S^"_$P($T(TRANS+(3+FBLTTYP)),";;",2),1:DIR(0))
	S DIR("A")="Enter Transfer Type"
	I $G(FBLTTYP),FBLTTYP<4 S DIR("B")=$P($P(DIR(0),"^",2),":",2)
	D ^DIR K DIR
	G RD1:$D(DIRUT) S FBZ=+Y
	S (DIC,DIE)="^FBAACNH(",DIC(0)="L",DLAYGO=162.3,X=FBY
	K DD,DO D FILE^DICN K DLAYGO,DIC G RD1:$D(DIRUT),RD2:Y<0
	S DA=+Y L +^FBAACNH(DA)
	S DR="8////^S X=FBVEN;Q;1////^S X=DFN;2////^S X=""T"";4////^S X=IFN;6////^S X=FBZ" D ^DIE K DIE L -^FBAACNH(DA) I $D(Y)'=0 G DEL
	G RD1
DEL	W !!,*7,"Deleting Transfer because of incomplete transaction!" S DIK="^FBAACNH(" D ^DIK K DIK G RD1
	;
Q	K FBLTT,FBLTTYP,FBINF,FBTRT,FBLTD,DFN,IFN,DIK,FBPROG,CNT,DAT,DIC,F,FBAUT,FBDX,FBEDT,FBI,FBMULT,FBRR,FBTDT,FBXX,FTP,I,PI,PTYPE,T,X,Z,ZZ,FBAAOUT,Y,FBAABDT,FB7078,FBAAEDT,FBAAOUT,FBASSOC,FBDX,FBI,FBPOV,FBY
	K FBPSA,FBPT,I,PI,PTYPE,T,TA,VAL,FBTT,FBLOC,FBAAAD,FBAT,FBIFN,FBPDT,FBTYPE,FBVEN,DA,DR,FBASIH,FBJ,FBK,FBZ
	Q
	;
TRANS	;transfer types
	;;1:TO AUTHORIZED ABSENCE
	;;2:TO UNAUTHORIZED ABSENCE
	;;3:TO ASIH
	;;4:FROM AUTHORIZED ABSENCE
	;;5:FROM UNAUTHORIZED ABSENCE
	;;6:FROM ASIH < 15 DAYS

FBNHEXP
FBNHEXP	;AISC/CMR CNH WITH CONTRACT EXPIRING WITHIN DATE RANGE;10MAR93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S %DT="AEX" D DATE^FBAAUTL K %DT G END:$G(FBPOP)
	W !,"This option will list nursing homes with contracts expiring between",!,$$DATX^FBAAUTL(BEGDATE)," and ",$$DATX^FBAAUTL(ENDDATE),".",!
	S DIR("A")="Are you sure you want to continue",DIR(0)="Y",DIR("B")="Yes" D ^DIR K DIR G END:$D(DIRUT)!(Y=0)
	S VAR="BEGDATE^ENDDATE",VAL=BEGDATE_"^"_ENDDATE,PGM="START^FBNHEXP" D ZIS^FBAAUTL G END:FBPOP
	;
START	S Q="",$P(Q,"=",80)="=",FBAAOUT=0 U IO W:$E(IOST,1,2)["C-" @IOF D HED
	F FBV=0:0 S FBV=$O(^FBAA(161.21,"ADR",FBV)) Q:FBV'>0!(FBAAOUT)   F FBDT=-(ENDDATE+.001):0 S FBDT=$O(^FBAA(161.21,"ADR",FBV,FBDT)) Q:FBDT=""!(FBDT>-BEGDATE)!(FBAAOUT)  F FBI=0:0 S FBI=$O(^FBAA(161.21,"ADR",FBV,FBDT,FBI)) Q:FBI'>0!(FBAAOUT)  D
	.I $Y+4>IOSL,($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	.I $Y+4>IOSL W @IOF D HED
	.W !,$$VNAME(FBV),?47,$$VID(FBV),?58,$P(^FBAA(161.21,FBI,0),"^"),?72,$$DATX^FBAAUTL($P(^(0),"^",3))
END	I '$G(FBAAOUT),'$G(FBPOP),$E(IOST,1,2)="C-" W ! S DIR(0)="E",DIR("A")="Press Return to continue" D ^DIR K DIR
	K BEGDATE,ENDDATE,FBAAOUT,FBDT,FBI,FBV,Q,X,Y
	D CLOSE^FBAAUTL
	Q
HED	W !?12,"CNH CONTRACTS EXPIRING BETWEEN ",$$DATX^FBAAUTL(BEGDATE)," AND ",$$DATX^FBAAUTL(ENDDATE)
	W !?12,$E(Q,1,52),!!!,"Vendor Name",?47,"Vendor ID",?58,"Contract #",?72,"Exp. Dt.",!,Q
	Q
VNAME(X)	;INPUT - VENDOR IEN
	;OUTPUTS VENDOR NAME
	I $G(X),$D(^FBAAV(X,0)) Q $P(^(0),"^")
	Q "UNKNOWN"
	;
VID(X)	;INPUT - VENDOR IEN
	;OUTPUTS VENDOR ID
	I $G(X),$D(^FBAAV(X,0)) Q $P(^(0),"^",2)
	Q "UNKNOWN"

FBNHPAMS
FBNHPAMS	;AISC/GRR-PRINT AMIS ; 21JUN90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBUL="",$P(FBUL,"-",40)="-",(FBDV,FBPG)=0
	W:$E(IOST,1,2)["C-" @IOF D HDR I $D(FBER) W ?30,">>>NOTICE<<<",!?5,">>>Incomplete patient movements affect the AMIS totals below<<<",!,?24,">>>Refer to last page for details<<<",!
	W "G A I N S",!,$E(FBUL,1,9)
	W !,?4,"ADMISSIONS"
	W !!,?10,"01  AFTER REHOSP > 15 DAYS",?40,$J(FBG(1),5) D DV Q:$G(FBOUT)  W !,?10,"02  ALL OTHER",?40,$J(FBG(2),5) D DV Q:$G(FBOUT)
	W !!,?4,"TRANSFERS IN"
	W !!,?10,"03  FROM OTHER CNH",?40,$J(FBG(3),5) D DV Q:$G(FBOUT)  W !,?10,"04  FROM ASIH",?40,$J(FBG(4),5) D DV Q:$G(FBOUT)
	D PGCK(9) Q:$G(FBOUT)  W !!,"L O S S E S",!,$E(FBUL,1,11)
	D PGCK(6) Q:$G(FBOUT)  W !?4,"DISCHARGES & DEATHS",!!,?10,"05  DISCHARGES",?40,$J(FBL(1),5) D DV Q:$G(FBOUT)  W !,?10,"06  DEATHS",?40,$J(FBL(2),5) D DV Q:$G(FBOUT)
	D PGCK(7) Q:$G(FBOUT)  W !!?4,"TRANSFERS OUT",!!,?10,"07  TO OTHER CNH",?40,$J(FBL(3),5) D DV Q:$G(FBOUT)  W !,?10,"08  TO ASIH",?40,$J(FBL(4),5) D DV Q:$G(FBOUT)
	D PGCK(8) Q:$G(FBOUT)  W !!,"R E M A I N I N G",!,$E(FBUL,1,17),!
	F I=1:1:3 W !,?10,$P($T(PR+I),";;",2),?40,$J(FBR(I),5) D DV Q:$G(FBOUT)
	Q:$G(FBOUT)
	W !,?10,"12  FEMALE BED OCCUPANTS",?40,$J(FBFEM,5) D DV Q:$G(FBOUT)
	D PGCK(8) Q:$G(FBOUT)  W !!,"L O S S E S    F R O M    A S I H",!,$E(FBUL,1,33)
	W !!,?10,"13  DISCHARGES",?40,$J(FBASDIS,5) D DV Q:$G(FBOUT)  W !,?10,"14  DEATHS",?40,$J(FBASDEAD,5) D DV Q:$G(FBOUT)
	D PGCK(8) Q:$G(FBOUT)  W !!,"M I S C    T O T A L S",!,$E(FBUL,1,22),!!,?10,"15  PATIENT DAYS OF CARE",?40,$J(TOTDAYS,5) D DV Q:$G(FBOUT)  W !,?10,"16  SC PLACEMENTS",?40,$J(FBSC,5) D DV Q:$G(FBOUT)
	D PGCK(12) Q:$G(FBOUT)  W !!,"AMIS BALANCING SEGMENT",!,$E(FBUL,1,22),!!?5,"PRIOR MONTH FIELDS 09 AND 10",?60,$J(FBPRIOR,6),!?5,"+ CURRENT MONTH FIELDS 01, 02, 03 AND 04",?60,$J("+"_(FBG(1)+FBG(2)+FBG(3)+FBG(4)),6)
	W !?5,"- CURRENT MONTH FIELDS 05, 06, 07 AND 08",?60,$J("-"_(FBL(1)+FBL(2)+FBL(3)+FBL(4)),6),!?60,"------"
	W !?5,"= CURRENT MONTH FIELDS 09 AND 10",?45,$J((FBR(1)+FBR(2)),5),"  <======>" S FBCHK=FBPRIOR+FBG(1)+FBG(2)+FBG(3)+FBG(4)-FBL(1)-FBL(2)-FBL(3)-FBL(4) W ?60,$J(FBCHK,6)
	W !,"**",$S(FBCHK=(FBR(1)+FBR(2)):"BALANCING SEGMENT OK",1:"PROBLEM FOUND IN BALANCING (see last page for details)")
	I $E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR Q:'Y
	D:$D(FBER) DISCR^FBNHAMIS
BAL	I FBCHK'=(FBR(1)+FBR(2)),('$G(FBMOV)) D
	.I '$D(FBER) W @IOF D HDR^FBNHPAMS
	.W ! F I=1:1:22 D PGCK(3) Q:$G(FBOUT)  W !,$P($T(TEXT+I),";;",2)
	Q
HDR	S FBPG=FBPG+1 I FBPG>1 W "Page ",FBPG
	D PRPRDT^FBAAUTL2 W !,?15,"COMMUNITY NURSING HOME CARE ACTIVITY - AMIS 349",!,?21,$$DATX^FBAAUTL(+FBMONTH),"  THRU  ",$$DATX^FBAAUTL($P(FBMONTH,"^",2)),!!
	Q
DV	;
	I $G(FBVAL) D
	.S FBIFN=0,FBDV=FBDV+1
	.F  S FBIFN=$O(^TMP($J,"FBAMIS",FBDV,FBIFN)) Q:'FBIFN  D  Q:$G(FBOUT)
	..D PGCK(3) Q:$G(FBOUT)
	..I (FBDV>8&(FBDV<13))!(FBDV=15) W !,?17,$$NAME^FBCHREQ2($P($G(^FB7078(FBIFN,0)),"^",3))
	..I (FBDV<9)!(FBDV=13)!(FBDV=14)!(FBDV=16) W !,?17,$$NAME^FBCHREQ2($P($G(^FBAACNH(FBIFN,0)),"^",2)),?50,$$DATX^FBAAUTL(+$G(^FBAACNH(FBIFN,0)))
	..I FBDV=15 W ?47,+^TMP($J,"FBAMIS",FBDV,FBIFN)
	Q:$G(FBOUT)
	D PGCK(3)
	Q
PGCK(X)	;
	I '$G(X) S X=1
	I ($Y+X)>IOSL D
	.I $E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR I 'Y S FBOUT=1 Q
	.W @IOF D HDR
	Q
PR	;;
	;;09  BED OCCUPANTS
	;;10  ABSENT BED OCCUPANTS
	;;11  ABSENT SICK IN HOSP.
	Q
TEXT	;;
	;;          Fixing AMIS BALANCING SEGMENT problems:
	;;
	;; 1)  Obtain a listing of all patients in a CNH during the month.
	;;     Use either the Estimate Funds for Obligation option for the
	;;     month or the CNH Census Report for each day of the month.
	;; 2)  Verify all movements agree with those that preceed them
	;;     by running the Display Episode of Care option for each patient.
	;;      ***Transfers TO ASIH must be followed by one of the movement
	;;         types listed below.  Any other movement types followed
	;;         by the types listed below will result in Segment Balancing
	;;         problems.
	;;              a) a transfer type of From ASIH < 15 days
	;;              b) a discharge type of ASIH
	;;              c) a discharge type of Death while ASIH
	;;
	;; 3)  Use the Movement menu to edit the movement types for those found
	;;     to be inappropriate.
	;; 4)  Re-run the AMIS 349 once the movements have been updated.

FBNHPC
FBNHPC	;AISC/GRR-POST COMMITMENTS TO 1358 ;4/9/93  09:37
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S PRCS("TYPE")="FB",(FBNHCC,FBTOT)=0,PRCS("A")="Select Obligation Number: " K PRCS("X") D EN1^PRCS58 G:Y<0 Q S FBOBN=$P(Y,"^",2)
	;entry point for estimate report FBNHCC=1,(FBSEQ,FBOBN)=""
EN1	S FBTOT=0,%DT=$S(FBNHCC:"AEF",1:"AEP"),%DT("A")=$S(FBNHCC:"Calculate ",1:"Post ")_"Commitments for which Month/Year: " D ^%DT G:X="^"!(X="") Q S FBPAYDT=$E(+Y,1,5)_"00",FBMM=$E(+Y,4,5),FBYY=$E(+Y,2,3),X=+Y D DAYS^FBAAUTL1 S FBDAYS=X
	S VAR="FBOBN^FBPAYDT^FBMM^FBYY^FBDAYS^FBNHCC",VAL=FBOBN_"^"_FBPAYDT_"^"_FBMM_"^"_FBYY_"^"_FBDAYS_"^"_FBNHCC,PGM="START^FBNHPC" D ZIS^FBAAUTL G:FBPOP END
	;
START	K ^TMP($J,"FBNHPC") S (FBPAYEDT,FBENDDT)=$E(FBPAYDT,1,5)_FBDAYS,Q="",$P(Q,"=",80)="=",(FBTOT,FBTOTAL,FBOUT)=0 U IO W:$E(IOST,1,2)["C-" @IOF D HED^FBNHPC1
	N FBCNT S FBCNT=0
	S FBIFN=0,^XTMP("FBPOST",0)=$$CDTC^FBUCUTL(DT,1)_"^"_DT
	F FBDD=FBPAYDT:0 S FBDD=$O(^FB7078("AD",7,FBDD)) Q:FBDD'>0!(FBOUT)  D
	.F  S FBIFN=$O(^FB7078("AD",7,FBDD,FBIFN)) Q:'FBIFN!(FBOUT)  I $D(^FB7078(FBIFN,0)) S FBZ=^(0) I $P(FBZ,U,9)'="DC" S (FBHIFN,FB7078)=FBIFN,FBABD=$P(FBZ,"^",4),IFN=+$P(FBZ,"^",2),DFN=+$P(FBZ,"^",3) D
	..D L(FBIFN,1) I $G(FBLERR) S FBNAME=$$NAME^FBCHREQ2(DFN),FBSSN=$$SSN^FBAAUTL(DFN),Y="Another user is editing 7078." D ERR K FBLERR,Y W ! Q
	..I '$D(^XTMP("FBPOST",FBIFN)) D CHECK^FBNHPC1,L(FBIFN,2)
	G END:FBOUT
	D PRT^FBNHPC1
	I $$WRT() W !!?10,"No funds currently need to be posted.",! G END
Q	W !!,?10,"Total ",$S(FBNHCC:"Estimated: ",1:"Posted: "),$J(FBTOT,10,2),?50,"Total Days: ",$S($D(FBTOTAL):FBTOTAL,1:0),!
	;
END	K FBMM,FBYY,FBDEFP,FBABD,FBPAYDT,FBDAYS,FBIFN,Z1,Z2,FBVCAR,FBCD,FBSEQ,FBOBN,FBNAME,FBSSN,FBPOSDT,FBNHCC,FBTOTAL,FBPAYEDT,FB7078,FBAABDT,FBX1,FBOUT,DFN,FBVEN,FBENDFLG,FBLERR
	K %,%DT,DIC,FBDD,FBERR,FBTOT,IFN,PGM,Q,VAL,VAR,Z,FBEDT,FBENDDT,FBHIFN,FBRIFN,FBTDT,FBTRDYS,FBZ,FB,I,PRCS,Y,PRC,PRCSCPAN,X,X1,^TMP($J,"FBNHPC")
	K ^XTMP("FBPOST") D CLOSE^FBAAUTL Q
	;
WRT()	;determine if write to output
	;return 1 if nothing to post
	Q $S('$G(FBTOT):1,'$G(FBTOTAL):1,1:0)
	;
ERR	W !!,*7,"Unable to Post the following transaction because of the following:",!,Y,!?7,FBNAME,?40,FBSSN I '$G(FBLERR) W ?60,"$"_$FN(FBDEFP,",",2)
	Q
	;
L(FBDA,FBL)	;lock/unlock 7078
	;INPUT:  FBDA = ien (fbifn) of 7078 file
	;        FBL = lock code:  1 to lock, 2 to unlock
	;OUTPUT:  no output variables; fb7078 entry will be locked or unlocked
	N FBLCTR S FBLCTR=0
L1	I $S('+$G(FBDA):1,'+$G(FBL):1,1:0) Q
	I FBL=1 L +^FB7078(FBDA):2 I '$T S FBLCTR=FBLCTR+1 G:FBLCTR<5 L1 S FBLERR=1 Q
	I FBL=2 K ^XTMP("FBPOST",FBDA) L -^FB7078(FBDA)
	Q

FBNHPC1
FBNHPC1	;AISC/CMR-POST COMMITMENTS TO 1358 cont. ;9/20/94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
CHECK	S ^XTMP("FBPOST",FBIFN)=""
	Q:$E(FBPAYDT,1,5)<$E(FBABD,1,5)
	S FBTRDYS=0 K FBELSE
	S FBERR="" D GETRAT^FBNHEP2 Q:FBERR  D CHECK^FBNHEP2 Q:FBERR
	S FBIFN=FBHIFN
	D
	.I $E(FBABD,1,5)<$E(FBPAYDT,1,5)&($E(FBDD,1,5)>$E(FBPAYDT,1,5)) S FBTRDYS=FBDAYS D CALC Q
	.I $E(FBABD,1,5)<$E(FBPAYDT,1,5)&($E(FBDD,1,5)'>$E(FBPAYDT,1,5)) S FBTRDYS=$E(FBDD,6,7)-1,FBTRDYS=$S(FBTRDYS>0:FBTRDYS,1:0) S:FBTRDYS'>0 FBELSE=1 D CALC Q
	.I $E(FBABD,1,5)=$E(FBPAYDT,1,5)&($E(FBDD,1,5)>$E(FBPAYDT,1,5)) S FBTRDYS=(FBDAYS-$E(FBABD,6,7))+1 D CALC Q
	.I FBABD=FBDD S FBTRDYS=1 D CALC Q
	.I $E(FBABD,1,5)=$E(FBPAYDT,1,5)&($E(FBDD,1,5)'>$E(FBPAYDT,1,5)) S FBTRDYS=FBDD-FBABD,FBTRDYS=$S(FBTRDYS>0:FBTRDYS,1:0) S:FBTRDYS'>0 FBELSE=1 D CALC Q
	Q:$D(FBELSE)
	;ifcap calls for posting
	I 'FBNHCC,$D(^PRC(424,"E",+$P(FBZ,"^",3)_";"_+FBIFN_";"_$P(FBOBN,"-",2)_";"_FBMM)) Q
	S FBSEQ="" I 'FBNHCC S X=FBOBN,PRCS("TYPE")="FB" D EN1^PRCSUT31 Q:Y=""  S FBSEQ=Y
	S DFN=$P(FBZ,"^",3),FBNAME=$$NAME^FBCHREQ2(DFN),FBSSN=$$SSN^FBAAUTL(DFN),FBVEN=$P(FBZ,"^",2)
	S PRCS("TYPE")="FB" I 'FBNHCC D NOW^%DTC S FBPOSDT=%,X=FBOBN_"^"_FBPOSDT_"^"_FBDEFP_"^^"_FBSEQ_"^"_FBNAME_"  ("_FBSSN_")"_"^"_+DFN_";"_+FBIFN_";"_$P(FBOBN,"-",2)_";"_FBMM D EN2^PRCS58
	I 'FBNHCC G:+Y=0 ERR^FBNHPC
	S FBTOTAL=FBTOTAL+FBTRDYS,FBTOT=FBTOT+FBDEFP,FBCNT=FBCNT+1
	S ^TMP($J,"FBNHPC",FBNAME,FBCNT)=FBSSN_"^"_FBTRDYS_"^"_FBDEFP_"^"_$G(FBSEQ)_"^"_+FBVEN
	Q
	;
PRT	S FBNAME="" F  S FBNAME=$O(^TMP($J,"FBNHPC",FBNAME)) Q:FBNAME']""!($G(FBOUT))  F FBCNT=0:0 S FBCNT=$O(^TMP($J,"FBNHPC",FBNAME,FBCNT)) Q:'FBCNT!($G(FBOUT))  D
	.S Y(0)=$G(^TMP($J,"FBNHPC",FBNAME,FBCNT)),FBSSN=$P(Y(0),"^"),FBTRDYS=$P(Y(0),"^",2),FBDEFP=$P(Y(0),"^",3),FBSEQ=$P(Y(0),"^",4),FBVEN=$P(Y(0),"^",5)
	.I $Y+3>IOSL,$E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR S:'Y FBOUT=1 Q:FBOUT
	.I ($Y+3)>IOSL W @IOF D HED
	.W !,FBSEQ,?7,$E(FBNAME,1,20),?30,FBSSN,?44,$E($$VNAME^FBNHEXP(FBVEN),1,20),?66,FBTRDYS,?70,$J($FN(FBDEFP,",",2),10)
	Q
	;
HED	W !?11,"C O M M U N I T Y   N U R S I N G   H O M E   R E P O R T",!
	S I="",$P(I,"-",59)="-" W ?10,I K I W !
	I FBNHCC W ?5,"Estimated Funds for: ",$P("Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec","^",+FBMM)," ",FBYY,!!
	I 'FBNHCC W ?5,"Postings for Obligation Number: ",$P(FBOBN,"-",2),!!,"Ref #"
	W ?7,"Veteran",?30,"SSN",?44,"Vendor",?65,"Days",?74,"Total",!,Q,!
	Q
	;
CALC	S FBENDFLG=$S(FBDD'>FBENDDT:1,1:""),FBENDDT=$S(FBDD>FBENDDT:FBENDDT,1:FBDD),FBAABDT=FBABD D CALC^FBNHEP2
	S FBENDDT=FBPAYEDT K FB
	Q

FBNHPLT
FBNHPLT	;AISC/GRR-PRINT CNH PAYMENTS AND TOTALS FOR A MONTH ;12JUN90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASK	S %DT(0)=-DT,%DT="AEP",%DT("A")="Community Nursing Home Payment List for which Month/Year: " D ^%DT G END:X="^"!(X=""),ASK:Y<0
	S FBPAYDT=$E(+Y,1,5)_"00",VAR="FBPAYDT",VAL=FBPAYDT,PGM="START^FBNHPLT" D ZIS^FBAAUTL G:FBPOP END W !
START	K ^TMP($J) S Q="",$P(Q,"=",80)="=",(FBGTOT,FBVTOT)=0,FBENDDT=$E(FBPAYDT,1,5)_31 U IO W:$E(IOST,1,2)["C-" @IOF D HED
BEG	F FBJ=FBPAYDT:0 S FBJ=$O(^FBAAI("AD",FBJ)) Q:FBJ'>0!(FBJ>FBENDDT)  F IFN=0:0 S IFN=$O(^FBAAI("AD",FBJ,IFN)) Q:IFN'>0  I $D(^FBAAI(IFN,0)) S FBZ=^(0) D SETUP
	S FBSW=1 F FBVEN=0:0 S FBVEN=$O(^TMP($J,FBVEN)) Q:FBVEN'>0  D:'FBSW TOT S FBSW=0 D GETVEN F DFN=0:0 S DFN=$O(^TMP($J,FBVEN,DFN)) Q:DFN'>0  S IFN=$O(^TMP($J,FBVEN,DFN,0)) Q:IFN'>0  I $D(^FBAAI(IFN,0)) S FBZ=^(0) D MORE
	S FBGTOT=FBGTOT+FBVTOT D TOT W !!,"Grand Total Dollars: ",$J(FBGTOT,7,2)
END	K FBGTOT,FBVTOT,FBJ,DFN,FBVEN,FBZ,IFN,VAR,VAL,PGM,FBSW,FBAP,FBENDDT,FBNAME,FBPAYDT,FBVID,FBVNAME,Q,SSN,X,X1,Y
	D CLOSE^FBAAUTL Q
GETVEN	S FBGTOT=FBGTOT+FBVTOT,FBVTOT=0,FBVNAME=$S($D(^FBAAV(FBVEN,0)):$P(^(0),"^",1),1:""),FBVID=$S(FBVNAME'="":$P(^(0),"^",2),1:"")
PVHED	I $Y+3>IOSL W @IOF D HED
	W !!,FBVNAME,?50,FBVID
	Q
HED	W "Community Nursing Home Payment List & Totals for: ",$P("January^February^March^April^May^June^July^August^September^October^November^December","^",+$E(FBPAYDT,4,5))," ",(1700+$E(FBPAYDT,1,3)),!
	D NOW^%DTC S Y=% X ^DD("DD") W ?10,"Processed: ",Y,!
	W "Vendor Name",?50,"Vendor ID",!,?8,"Veteran Name",?39,"   SSN",?51,"Amount Paid",!,Q
	Q
MORE	S FBNAME=$$NAME^FBCHREQ2(DFN),SSN=$$SSN^FBAAUTL(DFN),FBAP=$P(FBZ,"^",9),FBVTOT=FBVTOT+FBAP
	I $Y+3>IOSL D PVHED
	W !,?8,FBNAME,?39,SSN,?51,$J(FBAP,7,2)
	Q
TOT	W !,?51,"-------",!,?35,"Vendor Total:",?51,$J(FBVTOT,7,2) Q
SETUP	I $P(FBZ,"^",14)="",$P(FBZ,"^",12)=7,'$D(^FBAAI(IFN,"FBREJ")) S ^TMP($J,$P(FBZ,"^",3),$P(FBZ,"^",4),IFN)=""
	Q

FBNHRAT
FBNHRAT	;AISC/CMR-POST NEW RATES FOR VETERAN ;4/14/93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBRATE=1 K ^TMP($J,"FB")
VENDOR	;select CNH vendor from the fee vendor file (161.2)
	S DIC="^FBAAV(",DIC(0)="AEQM",DIC("A")="Select CNH Vendor:",DIC("S")="I $P(^(0),U,9)=5" D ^DIC K DIC G Q:X=""!(X="^")!(Y<0)  S FBVIEN=+Y
	;
VETDISP	;get patients in the selected nursing home
	S I=0
	F  S I=$O(^FBAACNH("AD",I)) Q:'I  S J=0 F  S J=+$O(^FBAACNH("AD",I,J)) Q:'J  I $P($G(^FBAACNH(J,0)),U,9)=FBVIEN S FB(0)=$G(^(0)) D DRIV(I,J,.FB) K FBNFDT,FBNTDT
	I '$G(FBFND) W !!,"There are presently no patients that need rates updated for this vendor."
Q	K DIC,X,Y,FBVIEN,I,J,FB,FBTYP,FBNFDT,FBNTDT,FBAUTHN,FBAUTH,FBAFDT,FBATDT,FB7078,FBRT1,FBNFDT,FBNTDT,FBRTDT,FBIEN,FBRFDT,FBCFDT,FBI,FBCTDT,FBCNUM,FBRATE,FBFND,FBX,FBNRTDT,FBNRFDT,DUOUT,DTOUT,DIRUT,DR,DIE,FBCHFDT,FBCHTDT,FBRT,FBZ
	K FBRET
	Q
DRIV(I,J,FB,FBDDT)	;identify incomplete rate data for a given authorization
	;INPUT   I = DFN
	;        J = ien of active admission from movement file (162.3)
	;        FB = passing of 0 node of mvmnt(162.3)
	;        FBDDT (optional) = date of discharge
	;output  FBFND = if 1 means at least 1 pt. had a rate created
	;        FBUNR (only set if FBDDT passed) = array containing timeframes
	;             unable to establish rates for
	N FBVIEN,FBAUTHN,FBAUTH,FBAFDT,FBATDT,FB7078,FBNFDT,FBNTDT,FBIEN,FBRFDT,FBRTDT,FBRT,FBCHFDT,FBCHTDT
	S FBVIEN=+$P(FB(0),U,9),FBAUTHN=$P(^FBAACNH(J,0),"^",10),FBAUTH=$G(^FBAAA(I,1,FBAUTHN,0)),FBAFDT=+FBAUTH,FBATDT=$P(FBAUTH,"^",2),FB7078=+$P(FBAUTH,"^",9)
	I $G(FBDDT) S FBAFDT=$S($$DTC^FBUCUTL(DT,FBAFDT)>730:$$CDTC^FBUCUTL(DT,-730),1:FBAFDT) Q:FBAFDT>FBDDT
	;checks rate file, if no rates exist it will create one
	I '$D(^FBAA(161.23,"AC",FB7078)) S FBNFDT=FBAFDT,FBNTDT=$S($G(FBDDT):FBDDT,1:FBATDT) D VENDAT^FBNHRAT1 Q
	;set up array of existing rates
	K FBRT S FBIEN=0 F  S FBIEN=$O(^FBAA(161.23,"AC",FB7078,FBIEN)) Q:'$G(FBIEN)  S FB(1)=$G(^FBAA(161.23,FBIEN,0)),FBRFDT=+FB(1),FBRT(FBRFDT)=FB(1) K FB(1)
	;FBCHFDT and FBCHTDT are check dates (initially = to auth fr & to dates,  they are incremented based on existing rates throughout the check)
	S FBCHFDT=FBAFDT,FBCHTDT=$S($G(FBDDT):FBDDT,1:FBATDT),FBRFDT=0 D GETRAT,CKFRDT
	Q
GETRAT	;gets next rate from rate array
	S FBRFDT=+$O(FBRT(FBRFDT)) Q:'FBRFDT  S FBRTDT=$P(FBRT(FBRFDT),"^",2) Q
CKFRDT	;comparison of from dates
	Q:FBCHFDT>FBCHTDT
	I FBCHFDT=FBRFDT G CKTODT
	I FBCHFDT<FBRFDT S FBNFDT=FBCHFDT,FBNTDT=$S($$CDTC^FBUCUTL(FBRFDT,-1)>FBCHTDT:FBCHTDT,1:$$CDTC^FBUCUTL(FBRFDT,-1)) D VENDAT^FBNHRAT1 S FBCHFDT=$$CDTC^FBUCUTL(FBNTDT,1) K FBNFDT,FBNTDT G CKFRDT
	I FBCHFDT>FBRFDT Q:FBCHFDT>FBCHTDT  I 'FBRFDT S FBNFDT=FBCHFDT,FBNTDT=FBCHTDT D VENDAT^FBNHRAT1 K FBNFDT,FBNTDT Q
	I FBCHFDT>FBRFDT G CKTODT
	Q
CKTODT	;comparison of to dates
	Q:FBCHTDT=FBRTDT!(FBCHTDT<FBRTDT)
	I FBCHFDT'>FBRTDT S FBCHFDT=$$CDTC^FBUCUTL(FBRTDT,1)
	D GETRAT G CKFRDT

FBNHRAT1
FBNHRAT1	;AISC/CMR - ENTER RATES CONT. - 8/3/94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
VENDAT	;set up rate if contract exists
	N FBRATE,FBCFDT,FBCTDT,FBI,FBCNUM,FBNRFDT,FBNRTDT
	S FBCFDT=0
	I '$O(^FBAA(161.21,"AC",FBVIEN,0)) D:$G(FBDDT) CKSET(FBNFDT,FBNTDT) Q
VENDAT1	K FBRET
	S FBCFDT=$O(^FBAA(161.21,"AC",FBVIEN,FBCFDT))
	I FBCFDT']"" D:$G(FBDDT) CKSET(FBNFDT,FBNTDT) Q
	S FBI=$O(^FBAA(161.21,"AC",FBVIEN,FBCFDT,0)) I FBI]"" S FBCTDT=$P(^FBAA(161.21,FBI,0),"^",3),FBCNUM=$P(^FBAA(161.21,FBI,0),"^")
	I FBNFDT=FBCFDT!(FBNFDT>FBCFDT) D  G:$G(FBRET) VENDAT1 Q
	.I FBNFDT>FBCTDT S FBRET=1 Q
	.I FBNTDT=FBCTDT D SET(FBNFDT,FBNTDT,I) Q
	.I FBNTDT<FBCTDT D SET(FBNFDT,FBNTDT,I) Q
	.I FBNTDT>FBCTDT D SET(FBNFDT,FBCTDT,I) S FBNFDT=$$CDTC^FBUCUTL(FBCTDT,1),FBRET=1 Q
	I FBNFDT<FBCFDT D  G:$G(FBRET) VENDAT1 Q
	.I FBNTDT<FBCFDT D:$G(FBDDT) CKSET(FBNFDT,FBNTDT) Q
	.I FBNTDT'>FBCTDT D:$G(FBDDT) CKSET(FBNFDT,$$CDTC^FBUCUTL(FBCFDT,-1)) S FBNFDT=FBCFDT D SET(FBNFDT,FBNTDT,I) Q
	.I FBNTDT>FBCTDT D:$G(FBDDT) CKSET(FBNFDT,$$CDTC^FBUCUTL(FBCFDT,-1)) S FBNFDT=FBCFDT D SET(FBNFDT,FBCTDT,I) S FBNFDT=$$CDTC^FBUCUTL(FBCTDT,1),FBRET=1 Q
	Q
SET(FBFR,FBTO,I)	;set up rate array for pt
	;FBFR and FBTO are from and to dates to establish rates for
	;I=DFN for pt.
	;output FBFND=1 to indicate that a gap was found to create a rate for
	S FBFND=1
	W !!,*7,"Patient: ",$$NAME^FBCHREQ2(I),?40,"SSN: ",$$SSN^FBAAUTL(I)
	W !,?5,"Rate must be entered for the following period: ",$$DATX^FBAAUTL(FBFR)," - ",$$DATX^FBAAUTL(FBTO)
	S FBRATE=1 D DISPLAY^FBAAVD1 K FBX I '$G(FBRATE) D:$G(FBDDT) CKSET(FBFR,FBTO) Q
	K DD,DO S DIC="^FBAA(161.23,",DIC(0)="L",X=FBFR,DIC("DR")=".02////^S X=FBTO;.03////^S X=FB7078;.04////^S X=I;.05////^S X=FBRATE;.06////^S X=FBCNUM",DLAYGO=161.23 D FILE^DICN K DLAYGO,DIC,X
	Q
CKSET(FRDT,TODT)	;sets FBUNR array for timeframe unable to establish rate for.
	;FBUNR array is only set if variable FBDDT is passed to subroutine
	;and the attempt to create a rate (call to VENDAT) was unsuccessful.
	;FBUNR array, if defined, is returned to calling program.
	;FRDT=from date TODT=to date  of unsuccessful rate setup
	S FBUNR(FRDT,TODT)=""
	Q

FBNHRC
FBNHRC	;AISC/CMR-RATE CHANGE DURING AN AUTHORIZATION ;10APR93
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S DIC="^FBAAA(",DIC(0)="AEQMZ",DIC("A")="Select Fee Basis Patient: " D ^DIC K DIC G:$D(DTOUT)!($D(DUOUT))!(Y<0) END S DFN=+Y,FBNAME=Y(0,0)
	S FBPROG="I $P(^(0),""^"",3)=7" D GETAUTH^FBAAUTL1 G END:'$G(FB7078)
	S FBCNT=0 D SORT I FBCNT'>0 W !!,*7,"No rate information on file for this authorization." G END
ASK	W !! S DIR(0)="DA^"_FBSTART_":"_FBEND_":EX",DIR("A")="Enter effective date of rate change: ",DIR("?")="Date must fall within authorization dates" D ^DIR K DIR
	G END:$D(DIRUT)!('Y) S FBEDT=+Y
	;Get rate that will be affected by change
	S FBN=0 F  S FBN=$O(^FBAA(161.23,"AC",FB7078,FBN)) Q:'FBN  Q:(FBEDT'>$P($G(^FBAA(161.23,+FBN,0)),"^",2))&($P($G(^FBAA(161.23,+FBN,0)),"^")'>FBEDT)
	I FBN S FBRATE=1,FBCNUM=$P(^FBAA(161.23,FBN,0),"^",6),FBVIEN=FBVEN,FBREDT=$P(^(0),"^",2),FBRBDT=$P(^(0),"^") W !! D DISPLAY^FBAAVD1 G END:'$G(FBRATE) I FBRATE'=$P(^FBAA(161.23,FBN,0),"^",5) S (DIC,DIE)="^FBAA(161.23,",DA=FBN D
	.I FBRBDT=FBEDT S DR=".05////^S X=FBRATE" D ^DIE
	.I FBRBDT'=FBEDT S DR=".02////^S X="_$$CDTC^FBUCUTL(FBEDT,-1) D ^DIE K DIE,DA,DD,DO S DIC(0)="L",DLAYGO=161.23,X=FBEDT,DIC("DR")=".02////^S X=FBREDT;.03////^S X=FB7078;.04////^S X=DFN;.05////^S X=FBRATE;.06////^S X=FBCNUM" D FILE^DICN
	K DIE,DIC,DR,DA,DLAYGO
	D SORT
	W !! S DIR(0)="Y",DIR("A")="Do you want to change other rates associated with this Authorization",DIR("B")="No" D ^DIR K DIR G:Y ASK
END	K FBNAME,DFN,FB7078,FBAABDT,FBAAEDT,FBAAOUT,FBASSOC,FBAUT,FBPOV,FBPROG,FBPSA,FBPT,FBTT,FBTYPE,FBVEN,FTP,CNT,FBAR,FBCFD,FBCNT,FBCNUM,FBCTD,FBEDT,FBEND,FBN,FBN1,FBRATE,FBRBDT,FBREDT,FBSTART,FBVIEN,FBX,X,Y,Z,FBAR1
	Q
SORT	D HED
	S FBN=0 F  S FBN=$O(^FBAA(161.23,"AC",FB7078,FBN)) Q:'FBN  S FBN1=^FBAA(161.23,FBN,0),FBCNUM=$P(FBN1,"^",6),FBCFD=$P(FBN1,"^"),FBCTD=$P(FBN1,"^",2),FBRATE=$P(FBN1,"^",5) I FBCFD'>FBAAEDT S FBAR(FBCFD)=FBCTD_"^"_FBCNUM_"^"_FBRATE
	S (FBCFD,FBAAOUT)=0 F  S FBCFD=$O(FBAR(FBCFD)) Q:'FBCFD!(FBAAOUT)  S FBCNT=FBCNT+1,FBAR1=FBAR(FBCFD) D DISPLAY
	I FBCNT'>0 Q
	S FBEND=+FBAR1,FBSTART=$O(FBAR(0))
	Q
DISPLAY	;Write out rates affected by contract
	I $Y+5>IOSL S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	I $Y+5>IOSL D HED
	W !!?5,$$DATX^FBAAUTL(FBCFD),?25,$$DATX^FBAAUTL(+FBAR1),?40,"$ ",$J($FN($P(FBAR1,"^",3),",",2),8),?55,$P(FBAR1,"^",2)
	Q
HED	W @IOF,!,?20,"CURRENT RATE INFORMATION FOR ",$$NAME^FBCHREQ2(DFN)
	W !!!?5,"FROM DATE",?25,"TO DATE",?40,"RATE",?55,"CONTRACT #",! F I=1:1:79 W "_"
	Q

FBNHRCS
FBNHRCS	;ACAMPUS/dmk-RCS 10-0168 (18-3)
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;this routine will output data needed to complete the CNH codesheet
	;it is a quarterly report. user will select first, second, third or
	;fourth quarter and fiscal year.
	;
	D SITEP^FBAAUTL Q:$G(FBPOP)
	W !!?17,"COMMUNITY NURSING HOME REPORT 10-0168",!!
SELECT	;select quarter
	S DIR(0)="SM^1:First Quarter;2:Second Quarter;3:Third Quarter;4:Fourth Quarter"
	S DIR("?")="Select the reporting quarter"
	D ^DIR K DIR Q:$D(DIRUT)
	Q:'Y  S FBQTR=+Y
	;
	;select fiscal year for report
	S DIR(0)="D^::AE",DIR("A")="Fiscal Year: "
	S DIR("?",1)="Examples of Valid Dates:"
	S DIR("?",2)="   1994 or 94 or 1/94 or an exact date"
	S DIR("?")="   If you enter an exact date the Fiscal Year for that date will be used."
	D ^DIR K DIR Q:$D(DIRUT)!('Y)  S FBFY=+Y D
	.  ; set FBBEG  =  beginning date of selected quarter and fiscal year
	.  ; set FBEND  =  ending date of selected quarter and fiscal year
	.  ;
	. S FBBEG=$E(FBFY,1,3)-$S(FBQTR=1:1,1:0)_$P($P($T(DATES+FBQTR),";;",2),"^")
	. S FBEND=$E(FBFY,1,3)-$S(FBQTR=1:1,1:0)_$P($P($T(DATES+FBQTR),";;",2),"^",2)
	;
CODE	I $$VERSION^XPDUTL("GEC")>1.6 W !,"Do you want to generate code sheets for these Nursing Homes?" S DIR(0)="Y",DIR("B")="No" D ^DIR K DIR Q:$D(DTOUT)!($D(DUOUT))  S:Y FBGECS=1
	;
	W !!,"The CNH 10-0168 (RCS 18-3) will be compiled for the following date range:"
	W !?5,"FROM DATE: ",$$DATX^FBAAUTL(FBBEG),"    TO DATE: ",$$DATX^FBAAUTL(FBEND)
	;want to continue
	S DIR(0)="Y",DIR("A")="Want to continue",DIR("B")="Yes" D ^DIR K DIR
	G END:$D(DIRUT)!('Y)
	;
	S PGM="START^FBNHRCS",VAR="FBBEG^FBEND^FBGECS^FBSITE(1)" D ZIS^FBAAUTL G:FBPOP END
	;
START	D START^FBNHRCS1,^FBNHRCS3 G END:$G(FBOUT) I $G(FBGECS) D ^FBNHRCS4
	;
END	K DTOUT,DIRUT,DUOUT,I,J,JJ,K,FB,FBD,FBHIGH,FBLOW,FBI,FBV,FBPOP,FBY,FBSITE,FBQTR,FBBEG,FBEND,FBFY,^TMP($J),VNAM,CNT,FBAASN,FBSN,FBGECS
	D CLOSE^FBAAUTL Q
	;
DATES	;store date ranges for each quarter (format mmdd $T(DATES)+FBQTR)
	;;1001^1231
	;;0101^0331
	;;0401^0630
	;;0701^0930
	Q

FBNHRCS1
FBNHRCS1	;ACAMPUS/dmk-RCS 10-0168 CON'T
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
START	;called from FBNHRCS for compiling and printing report
	U IO
	D STATION^FBAAUTL I $G(FBPOP) W !,"Cannot determine proper station to build code sheets.",!,"Please check your Fee Basis Site Paramaters file (#161.4)" Q
	S (I,K)=0,J=""
	F  S I=$O(^FBAA(161.21,"ADR",I)) Q:'I  S J="" F  S J=$O(^FBAA(161.21,"ADR",I,J)) Q:'J!(J>-FBBEG)  S K=0 F  S K=$O(^FBAA(161.21,"ADR",I,J,K)) Q:'K  I $D(^FBAA(161.21,K,0)),$P(^(0),U,2)'>FBEND D  K FBCSN
	.S FBCN=$P(^FBAA(161.21,K,0),"^") D CONTR K FBCN Q:'$G(FBCSN)
	.Q:FBSN'=FBCSN
	.S ^TMP($J,"FBRCS",+$P(^FBAA(161.21,K,0),U,4),J,K)=""
EN	;start going through TMP to output report
	; FBV=ien of vendor   FBD= latest contract to date(-)
	; FBI=ien of latest contract within date range
	S FBV=0
	F  S FBV=$O(^TMP($J,"FBRCS",FBV)) Q:'FBV  S FBD=$O(^TMP($J,"FBRCS",FBV,"")),FBI=$O(^(+FBD,0)) D
	.  ; determine low and high rate
	.  ; FBLOW=low $ rate  FBHIGH=high $ rate
	.  ; if only one rate (fblow=fbhigh) report FBHIGH only
	. S (FBJ,CNT)=0 K FB
	. F  S FBJ=$O(^FBAA(161.22,"AC",FBI,FBJ)) Q:'FBJ  S FB(0)=$P($G(^FBAA(161.22,FBJ,0)),U,2) I FB(0),FB(0)<999.99 S CNT=CNT+1,FB(FB(0),CNT)=FB(0)
	.  N I,J,Z D
	..  S (I,J,FBLOW,FBHIGH)=0
	..  S FBLOW=$O(FB(0))
	..  F  S I=$O(FB(I)) Q:'I  S FBHIGH=I F  S J=$O(FB(I,J)) Q:'J
	.. S:FBLOW=FBHIGH FBLOW=0
	.. D  S ^TMP($J,"FBTOT",FBV)=Z
	... S VNAM=$E($$VNAME^FBNHEXP(FBV),1,23) I $L(VNAM)<23 S VNAM=$$LJ^XLFSTR(VNAM,23," ")
	... N V S V=$G(^FBAAV(+FBV,1)) S Z=FBSN_U_VNAM_U_$$CSC(FBV)_U_$P(V,U,8)_U_$P(V,U,4)_U_$$DOLLAR(FBHIGH)_U_$$DOLLAR(FBLOW)_U_$P(V,U,5)_U_$$NVET^FBNHRCS2(FBV,FBEND)_U_$E($P(V,U,6),4,5)_$E($P(V,U,6),2,3)
	;
	Q
	;
CONTR	;get numeric station number fro contract
	Q:FBCN']""!($E(FBCN,1)="-")
	I $E(FBCN,1,3)?3N S FBCSN=$E(FBCN,1,3) Q
	S FBCN=$E(FBCN,2,$L(FBCN)) G CONTR
	Q
CSC(X)	; This call will return city(15)_u_state code(2)_u_county(3)
	;X= ien from vendor file
	N Z S Z="               "
	I $S('$G(X):1,'$D(^FBAAV(X,0)):1,1:0) Q Z_U_$E(Z,1,2)_U_$E(Z,1,3)
	N C,S,V,Y S V=$G(^FBAAV(X,0))
	S Y=$E($P(V,U,4),1,15) I $L(Y)<15 S Y=$$LJ^XLFSTR(Y,15," ")
	S S=+$P(V,U,5),S=$P($G(^DIC(5,S,0)),U,3)
	S Y=Y_U_S_$E(Z,$L(S)+1,2)_U_$$COUNTY(+$P(V,U,5),+$P(V,U,13))
	Q Y
	;
COUNTY(X,Y)	;call returns the 3 digit county code
	;X= ien of state file
	;Y= ien of county in state multiple
	;
	I $S('X:1,'Y:1,'$D(^DIC(5,X,1,Y,0)):1,1:0) Q "   "
	Q $S($L($P($G(^DIC(5,X,1,Y,0)),U,3))=3:$P(^(0),U,3),1:"   ")
	;
DOLLAR(X)	;round off rate to closest dollar and right justify to 3
	;X= dollar amount
	;
	I 'X Q "000"
	S X2=0,X3=4
	D COMMA^%DTC
	Q $E($TR(X," ",0),1,3)

FBNHRCS2
FBNHRCS2	;AISC/CMR-CNH/CH CENSUS DATA ;4/28/93  11:02
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
NVET(X,FBDT)	;will return number of vets in cnh for a given date
	;call will exclude patients on ASIH
	;X=ien of vendor   FBDT=date wanted
	;
	I $S('$G(X):1,'$G(FBDT):1,1:0) Q "000"
	N FBCNT
	S FBCNT=0
	S FBK=0,FBJ=(FBDT-.1) F  S FBJ=$O(^FB7078("AD",7,FBJ)) Q:'FBJ  F  S FBK=$O(^FB7078("AD",7,FBJ,FBK)) Q:'FBK  D
	.S FBAFDT=$P(^FB7078(FBK,0),"^",4) I FBAFDT'>FBDT S FB7078=^(0) Q:$P(FB7078,U,9)="DC"!(+$P(FB7078,U,2)'=X)!($P($P(FB7078,U,2),";",2)'="FBAAV(")  D
	.. K FBOUT S FBCKDT=FBAFDT,DFN=+$P(FB7078,U,3) D ASIH Q:$G(FBOUT)  S FBCNT=FBCNT+1
	S (FBL,FBK)=0 F  S FBL=$O(^FB7078("AC","I",FBL)) Q:FBL'>0  F  S FBK=$O(^FB7078("AC","I",FBL,FBK)) Q:FBK'>0  D
	.S FBAFDT=$P(^FB7078(FBK,0),"^",4),FBJ=$P(^FB7078(FBK,0),"^",5) I FBAFDT'>FBDT,(FBJ'<FBDT),($P(^(0),"^",11)=7) S FB7078=^(0) Q:$P(FB7078,U,9)="DC"!(+$P(FB7078,U,2)'=X)!($P($P(FB7078,U,2),";",2)'="FBAAV(")  D
	.. K FBOUT S FBCKDT=FBAFDT,DFN=+$P(FB7078,U,3) D ASIH Q:$G(FBOUT)  S FBCNT=FBCNT+1
	;
	K DFN,FBJ,FBK,FBL,FBAFDT,FB7078,FBOUT,FBCKDT,FBOUT,FBACT,FBIEN,FBREC,FBTRAN,FBTRDT,FBTRTYP
	;
	Q $$RJ^XLFSTR(FBCNT,3,0)
	;
ASIH	;Checks to see if vet has been transferred ASIH on specified date.
	S FBACT=$O(^FBAACNH("AG",DFN,X,FBCKDT)) I 'FBACT!(FBACT>FBJ) S FBOUT=1 Q
	S FBIEN=$O(^FBAACNH("AG",DFN,X,FBACT,0)) I 'FBIEN S FBOUT=1 Q
	I $P(^FBAACNH(FBIEN,0),"^",3)'="A" S FBCKDT=FBACT G ASIH
	S FBTRAN=FBIEN F  S FBTRAN=$O(^FBAACNH("AC",FBIEN,FBTRAN)) Q:FBTRAN=""  Q:($P(^FBAACNH(FBTRAN,0),"^",3)="D")  D
	.S FBREC=$G(^FBAACNH(FBTRAN,0)),FBTRTYP=$P(FBREC,"^",7) Q:'FBTRTYP  S FBTRDT=+FBREC
	.I FBTRTYP<4,($P(FBTRDT,".")=FBDT) S FBOUT=1
	.I FBTRTYP<4 I FBTRDT'>FBDT S FBOUT=1
	.I FBTRTYP>3 I FBTRDT'>(FBDT+.99) K FBOUT
	Q

FBNHRCS3
FBNHRCS3	;ACAMPUS/dmk-RCS 10-0168 (18-3)
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	; print out report with data in ^TMP($J,"FBTOT",
	;
	Q:'$O(^TMP($J,"FBTOT",0))
	N I,J,FBOUT
	S I=0
	D HED
	F  S I=$O(^TMP($J,"FBTOT",I)) Q:'I!$G(FBOUT)  D  Q:$G(FBOUT)
	. F J=1:1:12 W !,$P($T(FIELD+J),";;",2),?55,$P(^(I),U,J)
	.I $E(IOST,1,2)="C-" S DIR(0)="E" D ^DIR K DIR S:'Y!($D(DIRUT)) FBOUT=1 Q:$G(FBOUT)  D HED:$O(^TMP($J,"FBTOT",+$G(I))) Q
	.W !!
	.I ($Y+23)>IOSL,$O(^TMP($J,"FBTOT",+$G(I))) W @IOF D HED
	Q
	;
FIELD	;fields to be printed
	;; [1] THREE DIGIT STATION NUMBER
	;; [2] NAME OF COMMUNITY NURSING HOME
	;; [3] NAME OF CITY WHERE NURSING HOME IS LOCATED
	;; [4] STATE CODE WHERE NURSING HOME IS LOCATED
	;; [5] COUNTY WHERE NURSING HOME IS LOCATED
	;; [6] NUMBER OF BEDS IN NURSING HOME (Skilled)
	;; [7] NURSING HOME INSPECTED OR ACCREDITED
	;; [8] PER DIEM RATE (High)
	;; [9] PER DIEM RATE (Low)
	;;[10] CERTIFIED FOR MEDICARE/MEDICAID
	;;[11] NUMBER OF VETERANS IN HOME
	;;[12] DATE OF LAST ASSESSMENT
	Q
	;
HED	I $E(IOST,1,2)="C-" W @IOF
	W !!,$$CJ^XLFSTR("COMMUNITY NURSING HOME 10-0168 (18-3) REPORT",80)
	W !?20,"FROM DATE: ",$$DATX^FBAAUTL(FBBEG),"    TO DATE: ",$$DATX^FBAAUTL(FBEND)
	W !?16,">>> NOTE: FIELDS 7, 10, 12 are current data <<<"
	W !,$$CJ^XLFSTR($$REPEAT^XLFSTR("=",46),80),!!
	Q

FBNHRCS4
FBNHRCS4	;ACAMPUS/dmk-RCS CON'T create code sheet ;8/1/94  09:26
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;create code sheets in the generic code sheet package after
	;asking user.         FBGECS=1 if code sheets to be created.
	;
	Q:'$G(FBGECS)
	I $E(IOST,1,2)'="C-" W @IOF
	;
	S I=0
	F  S I=$O(^TMP($J,"FBTOT",I)) Q:'I!$G(FBOUT)  D  Q:$G(FBOUT)
	.   ; set the following GCS variables
	.   ; GECSSYS="FEE BASIS - GECO" (from file 2101.1)
	.   ; GECS("SITENOASK")=3 byte station number from 161.4 default psa
	.   ; GECSAUTO=BATCH  that way code sheet are maked for batching
	.   ; GECS("TTF")=transaction type  from file 2101.2
	.S GECSSYS="FEE BASIS - GECO",GECSAUTO="BATCH"
	.S GECS("SITENOASK")=FBSN,GECS("TTF")="18-3"
	.N %DT S X=$P($G(^TMP($J,"FBTOT",I)),U,12) D ^%DT S $P(^TMP($J,"FBTOT",I),U,12)=Y
	.S GECS("STRING",0)="CNH^"_^TMP($J,"FBTOT",I)_"^$"
	.D  D ^GECSENTR W !
	.. I $Y+5>IOSL,$E(IOST,1,2)'="C-" W @IOF
	;
	K GECS,GECSSYS,GECSAUTO,I
	Q

FBNHRDEL
FBNHRDEL	;AISC/CMR - DELETION OF CNH RATE ; 6/14/93 9:20
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
CONTR	S DIC="^FBAA(161.21,",DIC(0)="AEMQ",DIC("A")="Select Contract: " D ^DIC K DIC Q:$D(DTOUT)!($D(DUOUT))!(Y=-1)
	S FBCIEN=+Y,FBCNUM=$P(Y,U,2)
	G END:'$D(^FBAA(161.21,FBCIEN,0)) S FBVIEN=$P(^(0),U,4),FBRATE=1
RATE	K FBX D DISPLAY^FBAAVD1 G END:'FBRATE
	S FBCTR=0 F FBI=1:1 S FBDRATE=$P(FBX,U,FBI) Q:'FBDRATE  I FBDRATE=FBRATE S FBCTR=FBCTR+1
	I FBCTR>1 G DEL
	S FBART=0
	F  S FBART=$O(^FBAA(161.23,"AE",FBCNUM,FBART)) Q:'FBART  D
	.I FBART=FBRATE S FBRCK=1 Q
	I $G(FBRCK) K FBRCK G NODEL
DEL	S FBI=0,FBI=$O(^FBAA(161.22,"AD",FBCIEN,FBRATE,FBI)) G END:'FBI S DIK="^FBAA(161.22,",DA=FBI D ^DIK K DIK
	W !!,"Rate Deleted."
	;
END	K FBCIEN,FBCNUM,Y,FBVIEN,FBRATE,FBCTR,FBI,FBDRATE,FBX,FBART,FBRCK,DUOUT,DTOUT,DA
	Q
NODEL	W !!,*7,"Rate is currently being used.  You CANNOT delete this rate!!",!
	G END

FBNHROS
FBNHROS	;AISC/GRR-PRINT NURSING HOME ROSTERS ;16MAY90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	W !!,"This option will print Nursing Home Rosters.",!
	S DIR(0)="Y",DIR("A")="Are you sure you want to continue",DIR("B")="No" D ^DIR K DIR G END:$D(DUOUT),H^XUS:$D(DTOUT),END:Y=0
	S (VAL,VAR)="",PGM="START^FBNHROS" D ZIS^FBAAUTL G:FBPOP END
START	U IO W:$E(IOST,1,2)["C-" @IOF K ^TMP($J)
	N FBA,FBAAOUT,FBAD,FBCH,FBDASH,FBDFN,FBHED,FBI,FBP,FBPNAM,FBSSN,FBTD,FBV,FBVIEN,FBVNAM ;new variables here
	S $P(FBDASH,"-",80)="",FBAAOUT=0
	F FBDFN=0:0 S FBDFN=$O(^FBAACNH("AD",FBDFN)) Q:FBDFN'>0  S FBI=+$O(^FBAACNH("AD",FBDFN,0)) S FBI(0)=$G(^FBAACNH(FBI,0)) I FBI(0)]"" D
	.S FBVIEN=$P(FBI(0),U,9),FBVNAM=$$PTR^FBUCUTL("^FBAAV(",FBVIEN),FBPNAM=$$PTR^FBUCUTL("^DPT(",FBDFN),^TMP($J,$P(FBVNAM,U)_";"_FBVIEN,$P(FBPNAM,U)_";"_FBDFN)=FBI
	D HEADER
	S FBV="" F  S FBV=$O(^TMP($J,FBV)) Q:FBV=""!(FBAAOUT)  S FBHED=1 S FBP="" F  S FBP=$O(^TMP($J,FBV,FBP)) Q:FBP=""!(FBAAOUT)  S FBVNAM=$P(FBV,";"),FBVIEN=$P(FBV,";",2),FBDFN=$P(FBP,";",2),FBI=+$G(^TMP($J,FBV,FBP)) D
	.S FBSSN=$$SSN^FBAAUTL(FBDFN),FBCH(0)=$G(^FBAACNH(FBI,0)),FBAD=$P(FBCH(0),U),FBAD=$E(FBAD,1,7),FBA=$P(FBCH(0),U,10),FBTD=$S(FBA="":"",1:$P($G(^FBAAA(FBDFN,1,+FBA,0)),U,2))
	.I $Y+4>IOSL&($E(IOST,1,2)["C-") S DIR(0)="E" D ^DIR K DIR I 'Y S FBAAOUT=1 Q
	.I $Y+4>IOSL W @IOF D HEADER,HED
	.D:FBHED HED
	.W !?4,$P(FBP,";"),?37,FBSSN,?53,$$DATX^FBAAUTL(FBAD),?66,$$DATX^FBAAUTL(FBTD)
END	W ! K DIR,DIRUT,DTOUT,DUOUT,I,PGM,VAL,VAR,Y,^TMP($J)
	D CLOSE^FBAAUTL Q
HED	S FBHED=0 W !!,FBVNAM,?50,$$VID^FBNHEXP(FBVIEN)
	Q
HEADER	W !?20,"Nursing Home Roster - ",$$PDATE^FBUCUTL2(DT),!?19,$E(FBDASH,1,41),!,"VENDOR NAME",?50,"VENDOR ID",!,?4,"VETERAN NAME",?37,"VETERAN ID",?53,"ADMIT DT",?65,"AUTH TO DATE",!
	W !,FBDASH Q

FBNTEG
FBNTEG	;ISC/XTSUMBLD KERNEL - Package checksum checker ;JAN 30, 1995@14:25:08
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;;7.2;JAN 30, 1995@14:25:08
	S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
CONT	F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
	G CONT^FBNTEG0
	K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
ONE	S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
	W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
	W ! G CONT
ROU	;;
FBAA79	;;15015750
FBAA79A	;;14173754
FBAAAUT	;;11121356
FBAAAV	;;8237458
FBAABDL	;;4402016
FBAABET	;;6666716
FBAABPG	;;11923505
FBAABS	;;1059560
FBAABT	;;10187515
FBAACCB	;;16700140
FBAACCB0	;;6967207
FBAACCB1	;;13238124
FBAACCB2	;;3914458
FBAACH	;;3924398
FBAACIE	;;10479082
FBAACLU	;;2653488
FBAACO	;;17520189
FBAACO0	;;8787859
FBAACO1	;;16364206
FBAACO2	;;9234183
FBAACO3	;;11803257
FBAACO4	;;3521393
FBAACO5	;;2421930
FBAACP	;;11041469
FBAACP1	;;5031333
FBAACR	;;13238141
FBAADCB	;;3135114
FBAADD	;;9907173
FBAADEM	;;3118155
FBAADEM1	;;8836879
FBAADOB	;;2276602
FBAADV	;;3617394
FBAAEAR	;;387421
FBAAELT	;;836722
FBAAEPI	;;6142437
FBAAESP	;;852277
FBAAETA	;;1886573
FBAALB	;;3523804
FBAALPI	;;3193402
FBAALU	;;3101269
FBAAMP	;;13573955
FBAAMP1	;;8078353
FBAAMPG1	;;4422941
FBAAMPRG	;;5065789
FBAAOB	;;12117504
FBAAODP	;;5681209
FBAAODP0	;;3892662
FBAAPAA	;;1034994
FBAAPAY	;;9796019
FBAAPCC	;;2074626
FBAAPDM	;;1139836
FBAAPET	;;11564008
FBAAPH	;;14983509
FBAAPHV	;;6264884
FBAAPI	;;1761458
FBAAPIE	;;14735959
FBAAPIE1	;;11677635
FBAAPII	;;1042268
FBAAPIN	;;14186344
FBAAPIN1	;;1319058
FBAAPIP	;;10037006
FBAAPIS	;;613307
FBAAPLU	;;12319806
FBAAPM	;;4904986
FBAAPOC	;;3681250
FBAAPP	;;17772954
FBAAPP0	;;6578102
FBAAPPH	;;11848720
FBAAPRC	;;10396263
FBAAPRGS	;;856003
FBAAPV	;;3616039
FBAARB	;;3914625
FBAARD	;;16165776
FBAARD0	;;6724396
FBAARD1	;;10948778
FBAARD2	;;12170226
FBAARD3	;;2843765
FBAARJP	;;15794620
FBAARMRA	;;3799769
FBAAROC	;;2542001
FBAARP	;;246821
FBAARR	;;17198810
FBAARR0	;;8315430
FBAARR1	;;15532156
FBAARR2	;;9461559
FBAARV	;;211649
FBAAS79	;;1846133
FBAASAP	;;919209
FBAASCB	;;11510367
FBAASCB0	;;10929598
FBAASL	;;8416600
FBAASL1	;;8501613
FBAASL1B	;;7938938
FBAASLP	;;16458950
FBAASOUT	;;7190423
FBAASTA	;;3157123
FBAATIC	;;2171621
FBAAUTL	;;13857256
FBAAUTL1	;;10946318
FBAAUTL2	;;10972683
FBAAUTL3	;;2438740
FBAAUTL4	;;2899934
FBAAUTL5	;;775264
FBAAV0	;;18979183
FBAAV01	;;6553775
FBAAV1	;;21263609
FBAAV2	;;9083463
FBAAV3	;;2027833
FBAAV4	;;7803193
FBAAV5	;;13627044
FBAAV6	;;13633513
FBAAVD	;;11915256
FBAAVD1	;;4740010
FBAAVD2	;;13913328
FBAAVLU	;;10935879
FBAAVP	;;16705504
FBAAVP0	;;2865347
FBAAVR	;;14472538
FBAAVR0	;;10933358
FBAAVR1	;;14670872
FBAAVR2	;;5937034
FBAAVS	;;8724685
FBAUTHP	;;2653322
FBCH78	;;19677146
FBCH780	;;3773342
FBCH78A	;;12095635
FBCHACT	;;9382205
FBCHACT0	;;9411687
FBCHACT1	;;2186657
FBCHC78	;;11229364
FBCHCD	;;16889244
FBCHCO	;;712427
FBCHCR	;;17403059
FBCHCR1	;;6788901
FBCHDEL	;;2002180
FBCHDI	;;6253097
FBCHDI2	;;3467889
FBCHDIN	;;2953481
FBCHDUC	;;4597629
FBCHEAP	;;10591525
FBCHEP	;;18996060
FBCHEP1	;;6891252
FBCHEUC	;;7559144
FBCHEUC1	;;8332891
FBCHEUC2	;;1905120
FBCHP78	;;20934808
FBCHPET	;;9908667
FBCHPH	;;8218576
FBCHPH0	;;5388144
FBCHPRC	;;6366752
FBCHPRC1	;;8882654
FBCHPSA	;;15194005
FBCHPSA0	;;11162264
FBCHPSA1	;;6682209
FBCHREQ	;;15052672
FBCHREQ1	;;9317783
FBCHREQ2	;;5612542
FBCHRJP	;;7037853
FBCHROC	;;2943853

FBNTEG0
FBNTEG0	;ISC/XTSUMBLD KERNEL - Package checksum checker ;JAN 30, 1995@14:25:08
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;;7.2;JAN 30, 1995@14:25:08
	S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
CONT	F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
	;
	K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
ONE	S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
	W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
	W ! G CONT
ROU	;;
FBCHRR	;;7282468
FBCHSCB	;;6573176
FBCHSL1	;;8984574
FBCHSLP	;;8509290
FBCHSTA	;;3828644
FBCHSTAT	;;5062352
FBCHVH	;;10895543
FBCHVP	;;14312605
FBCKDIS	;;17064040
FBCKDIS1	;;4825715
FBCNHCEN	;;12089173
FBDOC	;;208431
FBMRASV1	;;11363374
FBMRASV2	;;12114185
FBMRASVR	;;15871936
FBNHACT	;;7377096
FBNHAMI1	;;10257785
FBNHAMI2	;;6743548
FBNHAMIE	;;8906087
FBNHAMIS	;;18698941
FBNHDEC	;;3000257
FBNHDIEP	;;1822085
FBNHDLAD	;;5489319
FBNHDLDI	;;7535255
FBNHDLTR	;;3056815
FBNHEA	;;9042749
FBNHEAU1	;;4563644
FBNHEAU2	;;8102988
FBNHEAUT	;;17899847
FBNHED	;;8997353
FBNHEDA1	;;3108080
FBNHEDAD	;;1690767
FBNHEDAT	;;10167462
FBNHEDDI	;;4313528
FBNHEDPA	;;6175427
FBNHEDTR	;;5402733
FBNHEP	;;20057397
FBNHEP1	;;6219597
FBNHEP2	;;14099420
FBNHET	;;6903761
FBNHEXP	;;5281991
FBNHPAMS	;;14276588
FBNHPC	;;9944869
FBNHPC1	;;8251325
FBNHPLT	;;7785082
FBNHRAT	;;8512413
FBNHRAT1	;;4767279
FBNHRC	;;11532054
FBNHRCS	;;4973071
FBNHRCS1	;;6111456
FBNHRCS2	;;4585977
FBNHRCS3	;;2192097
FBNHRCS4	;;1521491
FBNHRDEL	;;2136211
FBNHROS	;;6787692
FBP35D	;;2550500
FBPAID	;;7993157
FBPAID1	;;2937603
FBPAID2	;;11705622
FBPAY	;;12670963
FBPAY2	;;10449356
FBPAY21	;;6882423
FBPAY3	;;14897836
FBPAY67	;;17774089
FBPAY671	;;13723194
FBPCR	;;12194673
FBPCR2	;;12312031
FBPCR3	;;10581098
FBPCR67	;;9893934
FBPCR671	;;8261947
FBPHON	;;14011993
FBPHON1	;;10086411
FBPHON2	;;9327779
FBPRE35	;;5136542
FBPRICE	;;13736306
FBPRICE1	;;4733284
FBPST35	;;8167497
FBPST35A	;;16775666
FBPST35B	;;7164566
FBPST35C	;;9143037
FBUCDD	;;3821845
FBUCDD1	;;7275596
FBUCDIS	;;10618926
FBUCDUP	;;3798696
FBUCED	;;10874060
FBUCED0	;;18866078
FBUCED1	;;4332811
FBUCEN	;;14613914
FBUCEN1	;;6621239
FBUCEVT	;;439790
FBUCEX	;;12923887
FBUCLET	;;14516629
FBUCLET0	;;9111656
FBUCLET1	;;11867847
FBUCLINK	;;11678403
FBUCLNK1	;;9379737
FBUCOUT	;;2256740
FBUCOUT1	;;8762575
FBUCPAY	;;15066764
FBUCPEND	;;7313035
FBUCSTAT	;;10504241
FBUCUPD	;;9689085
FBUCUPD1	;;6807028
FBUCUTL	;;3957346
FBUCUTL1	;;9828164
FBUCUTL2	;;10327684
FBUCUTL3	;;9669404
FBUCUTL4	;;3662827
FBUCUTL5	;;11780524
FBUCUTL6	;;7064155
FBUCUTL7	;;9716645
FBUCUTL8	;;3419884
FBUINS	;;4813918
FBVDISP	;;1398023

FBONI001
FBONI001	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",791,0)
	;;=FB LIST BATCH^LIST BATCH^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",791,15)
	;;=K FBPR
	;;^UTILITY(U,$J,"PRO",791,20)
	;;=S FBPR="BT" D ^FBPHON2
	;;^UTILITY(U,$J,"PRO",791,99)
	;;=56222,29861
	;;^UTILITY(U,$J,"PRO",792,0)
	;;=FB PHONE MENU^Fee Basis Phone Menu^^M^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",792,4)
	;;=26^4^N
	;;^UTILITY(U,$J,"PRO",792,10,0)
	;;=^101.01PA^10^10
	;;^UTILITY(U,$J,"PRO",792,10,1,0)
	;;=791^LB^12
	;;^UTILITY(U,$J,"PRO",792,10,1,"^")
	;;=FB LIST BATCH
	;;^UTILITY(U,$J,"PRO",792,10,2,0)
	;;=1151^ID^13
	;;^UTILITY(U,$J,"PRO",792,10,2,"^")
	;;=FB INVOICE DISPLAY
	;;^UTILITY(U,$J,"PRO",792,10,3,0)
	;;=1152^BS^11
	;;^UTILITY(U,$J,"PRO",792,10,3,"^")
	;;=FB BATCH STATUS
	;;^UTILITY(U,$J,"PRO",792,10,4,0)
	;;=1153^DV^32
	;;^UTILITY(U,$J,"PRO",792,10,4,"^")
	;;=FB DISPLAY VENDOR
	;;^UTILITY(U,$J,"PRO",792,10,5,0)
	;;=1154^DA^31
	;;^UTILITY(U,$J,"PRO",792,10,5,"^")
	;;=FB DISPLAY AUTHORIZATION
	;;^UTILITY(U,$J,"PRO",792,10,6,0)
	;;=1165^EV^21
	;;^UTILITY(U,$J,"PRO",792,10,6,"^")
	;;=FB EXPAND VIEW
	;;^UTILITY(U,$J,"PRO",792,10,7,0)
	;;=1166^CP^22
	;;^UTILITY(U,$J,"PRO",792,10,7,"^")
	;;=FB CHANGE VETERAN
	;;^UTILITY(U,$J,"PRO",792,10,8,0)
	;;=1167^CV^23
	;;^UTILITY(U,$J,"PRO",792,10,8,"^")
	;;=FB CHANGE VENDOR
	;;^UTILITY(U,$J,"PRO",792,10,9,0)
	;;=1171^DC^33
	;;^UTILITY(U,$J,"PRO",792,10,9,"^")
	;;=FB DISPLAY CHECK
	;;^UTILITY(U,$J,"PRO",792,10,10,0)
	;;=1176^LC^14
	;;^UTILITY(U,$J,"PRO",792,10,10,"^")
	;;=FB CPT DESCRIPTION
	;;^UTILITY(U,$J,"PRO",792,15)
	;;=
	;;^UTILITY(U,$J,"PRO",792,20)
	;;=
	;;^UTILITY(U,$J,"PRO",792,26)
	;;=D SHOW^VALM
	;;^UTILITY(U,$J,"PRO",792,28)
	;;=Select Action:
	;;^UTILITY(U,$J,"PRO",792,99)
	;;=56232,39503
	;;^UTILITY(U,$J,"PRO",1151,0)
	;;=FB INVOICE DISPLAY^INVOICE DISPLAY^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1151,4)
	;;=^^^ID
	;;^UTILITY(U,$J,"PRO",1151,15)
	;;=K FBPR
	;;^UTILITY(U,$J,"PRO",1151,20)
	;;=S FBPR="INV" D ^FBPHON2
	;;^UTILITY(U,$J,"PRO",1151,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1152,0)
	;;=FB BATCH STATUS^BATCH STATUS^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1152,15)
	;;=K FBPR
	;;^UTILITY(U,$J,"PRO",1152,20)
	;;=S FBPR="BS" D ^FBPHON2
	;;^UTILITY(U,$J,"PRO",1152,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1153,0)
	;;=FB DISPLAY VENDOR^DISPLAY VENDOR^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1153,20)
	;;=D DV^FBPHON2
	;;^UTILITY(U,$J,"PRO",1153,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1154,0)
	;;=FB DISPLAY AUTHORIZATION^DISPLAY AUTH/7078/583^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1154,15)
	;;=K FBPR
	;;^UTILITY(U,$J,"PRO",1154,20)
	;;=S FBPR="DA" D ^FBPHON2
	;;^UTILITY(U,$J,"PRO",1154,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1165,0)
	;;=FB EXPAND VIEW^EXPAND VIEW^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1165,15)
	;;=K FBPR
	;;^UTILITY(U,$J,"PRO",1165,20)
	;;=S FBPR="EV" D ^FBPHON2
	;;^UTILITY(U,$J,"PRO",1165,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1166,0)
	;;=FB CHANGE VETERAN^CHANGE PATIENT^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1166,20)
	;;=D CP^FBPHON2
	;;^UTILITY(U,$J,"PRO",1166,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1167,0)
	;;=FB CHANGE VENDOR^CHANGE VENDOR^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1167,20)
	;;=D CV^FBPHON2
	;;^UTILITY(U,$J,"PRO",1167,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1171,0)
	;;=FB DISPLAY CHECK^DISPLAY CHECK^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1171,15)
	;;=K FBPR
	;;^UTILITY(U,$J,"PRO",1171,20)
	;;=S FBPR="DC" D ^FBPHON2
	;;^UTILITY(U,$J,"PRO",1171,99)
	;;=56222,29862
	;;^UTILITY(U,$J,"PRO",1176,0)
	;;=FB CPT DESCRIPTION^LOOKUP CPT/MODIFIER^^A^^^^^^^^FEE BASIS
	;;^UTILITY(U,$J,"PRO",1176,15)
	;;=K FBPR
	;;^UTILITY(U,$J,"PRO",1176,20)
	;;=S FBPR="CD" D EN^FBPHON2
	;;^UTILITY(U,$J,"PRO",1176,99)
	;;=56222,29862

FBONIT
FBONIT	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	K DIF,DIK,DDF,DDT,DTO,D0,DLAYGO,DIC,DIR,DA,ORVROM,DFR,DTN,DIX,DZ
	S DIFQ=0,ORVROM=22 W !!,"This version of 'FBONIT' was created on 30-JAN-1995"
	W !?9,"(at ALBANY ISC VAX DEVELOPMENT, by OE/RR V.2.5)",!
	G Q:DIFQ D ^FBONIT1 G Q:'$D(DIFQ) S DIK(0)="B"
	D ^FBONIT2,^FBONIT3
	L  W !,*7,"OK, Protocol Installation is Complete.",!
	K %ZW,%,%H,D0,DA,DIF,DIFQ,DIG,DIH,DIK,DIU,DIV,DSEC,I,J,KEY,DIY,N,NM,NO,ORVROM,R,X,X0
	Q
	;
Q	W *7,!!,"NO UPDATING HAS OCCURRED!" Q
	;
IXF	;;FB

FBONIT1
FBONIT1	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	; LOADS
	;
	I $S('$D(DUZ)#2:1,'$D(DUZ(0))#2:1,1:0) W !,"DUZ and DUZ(0) must be defined to continue." K DIFQ Q
	K DIF,DIK,D,DDF,DDT,DTO,D0,DLAYGO,DIC,DIR,DA,DFR,DTN,DIX,DZ D DT^FBONIT2 S %=1,U="^",DSEC=1
	S NO=$P("I 0^I $D(@X)#2,X[U",U,%) I %<1 K DIFQ Q
	W !,"    PROTOCOL INSTALLATION"
	Q:'$D(DIFQ)  ;S %=0 W !!,"ARE YOU SURE YOU WANT TO CONTINUE" D YN^DICN I %-1 K DIFQ Q
	D DT^FBONIT2 K ^UTILITY(U,$J),^UTILITY("DIK",$J) W !,"...OK, this may take a while, hold on please..." F R=1001:1:1001 D @("^FBONI"_$E(R,2,4)) W "."

FBONIT2
FBONIT2	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	;
	K ^UTILITY("ORVROM",$J),DIC
	Q
DT	W !
	I '$D(DTIME) S DTIME=999
	K %DT D NOW^%DTC S DT=X
	K DIK,DIC,%I,DICS Q
	;

FBONIT3
FBONIT3	; ; 30-JAN-1995
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	;
	K ^UTILITY("ORVROM",$J) S DIC(0)="LX",ORNMCHK=1 I $D(^ORD(101,0))#2,^(0)?1"PROTOCOL".E S DIC="^ORD(101,",DLAYGO=101,N="PRO" D ADD,OP
	K ^UTILITY(U,$J),DIC,DLAYGO
	Q
DIEZ	I ^DD("VERSION")>17.4,'$D(DISYS),$D(^%ZOSF("OS"))#2 S DISYS=+$P(^("OS"),"^",2)
	E  S DISYS=^DD("OS")
	Q:'$D(^DD("OS",DISYS,"ZS"))
	S N=$O(^UTILITY("ORVROM",$J,DIR,0)) Q:N=""  S Y=+^(N) K ^(N)
	I $D(@("^"_DIR_"(Y,""ROU"")")) K ^("ROU") I $D(^("ROUOLD")) S X=^("ROUOLD"),DMAX=^DD("ROU") D:X]"" @("EN^DI"_$E(DIR,3)_"Z")
	G DIEZ
	;
OP	S NM=$O(^UTILITY("ORVROM",$J,N,NM)) I NM="" K ^UTILITY("ORVROM",$J) G Q
	S R=$O(^UTILITY("ORVROM",$J,N,NM,0)) G:R="" OP
	W !,"'"_NM_"' Protocol Filed" S DA=+^UTILITY("ORVROM",$J,N,NM,R)
	S %=$P(^ORD(101,DA,0),U,12) S:%]"" %=$O(^DIC(9.4,"B",%,0))
	S $P(^ORD(101,DA,0),U,12)=%,(ORDZ,ORDIX)=0
	S %=$S($D(^ORD(101,DA,5)):$P(^(5),"^"),1:"") I $L(%) S $P(^(5),"^")="",X=$P(%,";",2),%=$P(%,";") I $D(@("^"_X_"""B"","""_%_""")")) S %=$O(^(%,0)) S %=$S(%:%_";"_X,1:""),$P(^ORD(101,DA,5),"^")=%
	I $D(^ORD(101,DA,3,0)) S I=0 F  S I=$O(^ORD(101,DA,3,I)) Q:I<1  S KEY=^(I,0) K ^(0) I $D(^DIC(19.1,"B",KEY)) S KEY=$O(^(KEY,0)) I KEY S ^ORD(101,DA,3,I,0)=KEY
	I $D(^ORD(101,DA,3)) S I=0 F  S I=$O(^ORD(101,DA,3,I)) Q:I<1  S ORDZ=ORDZ+1,ORDIX=X
	I  S $P(^ORD(101,DA,3,0),"^",3,4)=ORDIX_"^"_ORDZ
	I $D(^UTILITY("ORVROM",$J,N,NM,R,10)) S X=0 F  S X=$O(^UTILITY("ORVROM",$J,N,NM,R,10,X)) Q:X<1  D A1
	S (ORDZ,ORDIX)=0 S X=0 F  S X=$O(^ORD(101,DA,10,X)) Q:X<1  S ORDZ=ORDZ+1,ORDIX=X
	S:$D(^ORD(101,DA,10,0)) ^(0)="^101.01PA^"_ORDIX_U_ORDZ D IX1^DIK
	I $D(^UTILITY("ORVROM",$J,N,NM,R,"MEN")) S IMEN=0 F  S IMEN=$O(^UTILITY("ORVROM",$J,N,NM,R,"MEN",IMEN)) Q:IMEN=""  S OMEN=^(IMEN),MEN=IMEN D MEN
	K MEN,IMEN,OMEN
	G OP
	;
ADD	S R=0 F  S R=$O(^UTILITY(U,$J,N,R)) Q:R=""  S X=$P(^(R,0),U),I=$P(^(0),U,4) D
	. I $L($T(DOT^ORVOM)) D DOT^ORVOM
	. I '$L($T(DOT^ORVOM)) W "."
	. I $O(^ORD(101,"B",X,0)) S Y=$O(^(0)),ORA=Y,Y=Y_U D A Q
	. D ^DIC I Y>0,'$D(DIFQ(N))!$P(Y,U,3) S ORA=Y,Y=Y_U D A
Q	K ORA,MEN,OMEN,ORNMCHK,ORDZ,ORDIX S (NM,R)=0 Q
A	S ^UTILITY("ORVROM",$J,N,X,R)=Y
	I $O(^UTILITY(U,$J,N,R,1,0))>0 K ^ORD(101,+Y,1)
	I $O(^UTILITY(U,$J,N,R,10,0))>0 S %X="^UTILITY(U,$J,N,R,10,",%Y="^UTILITY(""ORVROM"",$J,N,X,R,10," D %XY^%RCR K ^UTILITY(U,$J,N,R,10)
	I $D(^UTILITY(U,$J,N,R,"MEN")) S %X="^UTILITY(U,$J,N,R,""MEN"",",%Y="^UTILITY(""ORVROM"",$J,N,X,R,""MEN""," D %XY^%RCR K ^UTILITY(U,$J,N,R,"MEN")
	S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+ORA,",DA=+ORA,DIK=DIC D %XY^%RCR
	Q
A1	S ORA=DA N DA,DIC,ORI S Y="",ORI=0,DIC="^ORD(101,"_+ORA_",10,",DIC(0)="L",DA(1)=+ORA S:'$D(^ORD(101,DA(1),10,0)) ^(0)="^101.01PA^^"
	F  S ORI=$O(^UTILITY("ORVROM",$J,N,NM,R,10,ORI)) Q:ORI<1  S X0=^(ORI,0),X=$S($D(^(U)):^(U),1:"") I $L(X) D A2
	K DA,^UTILITY("ORVROM",$J,N,NM,R,10)
	Q
A2	N X1 S DLAYGO=101 D ^DIC Q:'Y
	I $P(Y,"^",3) W !?2,X_" added as item to "_$P(^ORD(101,DA(1),0),"^")_"."
	S X0=^UTILITY("ORVROM",$J,N,NM,R,10,ORI,0)
	S %=$P(X0,"^",4) I $L(%) S %=$O(^ORD(101,"B",%,0)) S:% $P(X0,"^",4)=%
	S $P(^ORD(101,DA(1),10,+Y,0),"^",2,99)=$P(X0,"^",2,99)
	S X1=0 F  S X1=$O(^UTILITY("ORVROM",$J,N,NM,R,10,ORI,X1)) Q:X1=""  I X1'["^" S X0=^UTILITY("ORVROM",$J,N,NM,R,10,ORI,X1),^ORD(101,DA(1),10,+Y,X1)=X0
	Q
MEN	S MEN=$S($D(^ORD(101,"B",MEN)):$O(^(MEN,0)),1:"") I 'MEN K ^UTILITY("ORVROM",$J,N,NM,R,"MEN") Q
	S X=NM,X0=OMEN,DIC="^ORD(101,"_MEN_",10,",DIC(0)="L",DA(1)=MEN S:'$D(^ORD(101,DA(1),10,0)) ^(0)="^101.01PA^^"
	S DIC("DR")="2///"_$P(X0,"^",2)_";3///"_$P(X0,"^",3)_";4///"_$P(X0,"^",4)_";5///"_$P(X0,"^",5)_";6///"_$P(X0,"^",6),DLAYGO=101 D ^DIC
	I $P(Y,"^",3) W !?2,X_" added as item to "_$P(^ORD(101,DA(1),0),"^")_"."
	Q

FBP35D
FBP35D	; List Template Exporter ; 08-SEP-1994
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	W !,"'FBPHONE MENU' List Template..."
	S DA=$O(^SD(409.61,"B","FBPHONE MENU",0)),DIK="^SD(409.61," D ^DIK:DA
	K DO,DD S DIC(0)="L",DIC="^SD(409.61,",X="FBPHONE MENU" D FILE^DICN S VALM=+Y
	I VALM>0 D
	.S ^SD(409.61,VALM,0)="FBPHONE MENU^1^^80^6^17^1^1^PAYMENT HISTORY^FB PHONE MENU^PAYMENT HISTORY^1^^1"
	.S ^SD(409.61,VALM,1)="^VALM HIDDEN ACTIONS"
	.S ^SD(409.61,VALM,"ARRAY")=" ^TMP(""FBPHON"",$J)"
	.S ^SD(409.61,VALM,"COL",0)="^409.621^7^7"
	.S ^SD(409.61,VALM,"COL",1,0)="DATES^6^19^SERVICE DATES^^0"
	.S ^SD(409.61,VALM,"COL",2,0)="SERVICE^26^13^SERVICE^^0"
	.S ^SD(409.61,VALM,"COL",3,0)="CLAIMED^42^10^AMT CL^^0"
	.S ^SD(409.61,VALM,"COL",4,0)="PAID^53^10^AMT PD^^0"
	.S ^SD(409.61,VALM,"COL",5,0)="CODE^62^4^CODE^^0"
	.S ^SD(409.61,VALM,"COL",6,0)="INVOICE^70^7^INV^^0"
	.S ^SD(409.61,VALM,"COL",7,0)="BATCH^75^5^BATCH^^0"
	.S ^SD(409.61,VALM,"COL","AIDENT",0,1)=""
	.S ^SD(409.61,VALM,"COL","AIDENT",0,2)=""
	.S ^SD(409.61,VALM,"COL","AIDENT",0,3)=""
	.S ^SD(409.61,VALM,"COL","AIDENT",0,4)=""
	.S ^SD(409.61,VALM,"COL","AIDENT",0,5)=""
	.S ^SD(409.61,VALM,"COL","AIDENT",0,6)=""
	.S ^SD(409.61,VALM,"COL","AIDENT",0,7)=""
	.S ^SD(409.61,VALM,"FNL")="D EXIT^FBPHON"
	.S ^SD(409.61,VALM,"HDR")="D HDR^FBPHON"
	.S ^SD(409.61,VALM,"HLP")="D HLP^FBPHON"
	.S ^SD(409.61,VALM,"INIT")="D START^FBPHON"
	.S DA=VALM,DIK="^SD(409.61," D IX1^DIK K DA,DIK
	.W "Filed."
	;
	K DIC,DIK,VALM,X,DA Q

FBPAID
FBPAID	;AISC - SERVER ROUTINE TO UPDATE PAYMENTS ;3/9/94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;incoming record from AAC will contain the following data
	;   - Fee Program  - from Fee Basis Program  (161.8)
	;   - Activity Code    (C - confirmed)
	;                      (B - backout)
	;                      (X - cancelled)
	;   - Internal Control Number   - IEN of payment record
	;   - Check Number
	;   - Check Date
	;   - Interest Amount
	;   - Cancellation Date
	;   - Reason Code  (File # 162.95)
	;   - Cancellation Code (R - C - X)
	;   - Disbursed Amount   (this amount minus interest amount = amt pd)
	;   variable 'FBPAID' is defined and passed to TRAP^FBMRASVR2
	;
	S U="^",FBPAID=1,FBMCNT=0
	S X="TRAP^FBMRASV2" S @^%ZOSF("TRAP")
	;K XMY S XMY("G.FEE")="" D ENT1^XMD
	K ^TMP("FBPAID",$J),^TMP("FBERR",$J)
	D STATION^FBAAUTL I $S($G(FB("ERROR")):1,'$G(FBAASN):1,1:0) Q
	K FB
	;start to read in message from central fee
	;edits are:
	;          1. invalid station number
	;          2. invalid record length
	;          3. unable to locate payment record
	;          4. disbursed amount '= amt paid+interest
	;          5. cancellations
	; XMRG=record received in mail message from Austin
	F I=1:1 X XMREC Q:XMER<0  I XMRG]"",$E(XMRG,1,3)=FBAASN D
	.S ^TMP("FBREC",$J,I)=XMRG
	.K FBERR
	.I $L(XMRG)'=77 S FBERR=1,^TMP("FBERR",$J,2,I)=""
	.D PARSE^FBPAID1 Q:$G(FBERR)  S FBMCNT=FBMCNT+1 D @FBPROG
	D ^FBPAID2:$D(^TMP("FBERR",$J))
	D BUL^FBPAID1
	G END
	;
3	;update outpatient payment record
	Q:'$D(^FBAAC(+FBIEN(3),1,+FBIEN(2),1,FBIEN(1),1,FBIEN,0))  S FBAMT=+$P(^(0),U,3) D
	.I FBDAMT-FBINAMT'=FBAMT,$G(FBACT)="C" S ^TMP("FBERR",$J,4,I)=""_U_FBPROG_U_+FBIEN(3)_U_+FBIEN(2)_U_+FBIEN(1)_U_+FBIEN
	N JJ F JJ=1:1:3 S DA(JJ)=+FBIEN(JJ)
	S DA=+FBIEN
	S DR=""
	I FBACT="C" S DR="12////^S X=$G(FBCKDT);35///^S X=FBCKNUM;40///^S X=FBDAMT;41///^S X=FBINAMT;36///@;37///@"
	I FBACT="B" S DR="12///@;35///@;36///@;37///@;40///@;41///@"
	I FBACT="X" S DR="12///@;40///@;41///@;36////^S X=FBXDT;37////^S X=$G(FBRCOD);38///^S X=FBXCOD" D
	.I FBXCOD'="R" S ^TMP("FBERR",$J,5,I)=""_U_FBPROG_U_+FBIEN(3)_U_+FBIEN(2)_U_+FBIEN(1)_U_+FBIEN
	.I FBXCOD="R" S DR=DR_";35///@"
	S DIE="^FBAAC("_DA(3)_",1,"_DA(2)_",1,"_DA(1)_",1,"
	D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAAC(DA(3),1,DA(2),1,DA(1),1,DA)
	D KILL
	Q
	;
5	;update pharmacy payment record
	Q:'$D(^FBAA(162.1,+FBIEN(1),"RX",+FBIEN,0))  S FBAMT=+$P(^(0),U,16) D
	. I FBDAMT-FBINAMT'=FBAMT,$G(FBACT)="C" S ^TMP("FBERR",$J,4,I)=""_U_FBPROG_U_+FBIEN(1)_U_+FBIEN
	S DA(1)=+FBIEN(1),DA=+FBIEN
	S DR=""
	I FBACT="C" S DR="28////^S X=FBCKDT;30///^S X=FBCKNUM;34///^S X=FBDAMT;35///^S X=FBINAMT;31///@;32///@"
	I FBACT="B" S DR="28///@;30///@;31///@;32///@;34///@;35///@"
	I FBACT="X" S DR="28///@;34///@;35///@;31////^S X=FBXDT;32////^S X=$G(FBRCOD);33///^S X=FBXCOD" D
	.I FBXCOD'="R" S ^TMP("FBERR",$J,5,I)=""_U_FBPROG_U_+FBIEN(1)_U_+FBIEN
	.I FBXCOD="R" S DR=DR_";30///@"
	S DIE="^FBAA(162.1,"_DA(1)_",""RX"","
	D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAA(162.1,DA(1),"RX",DA)
	D KILL
	Q
	;
9	;update inpatient payment record
	Q:'$D(^FBAAI(+FBIEN,0))  S FBAMT=+$P(^(0),U,9) D
	.I FBDAMT-FBINAMT'=FBAMT,$G(FBACT)="C" S ^TMP("FBERR",$J,4,I)=""_U_FBPROG_U_+FBIEN
	S DA=+FBIEN
	S DR=""
	I FBACT="C" S DR="45////^S X=FBCKDT;48///^S X=FBCKNUM;52///^S X=FBDAMT;53///^S X=FBINAMT;49///@;50///@"
	I FBACT="B" S DR="45///@;48///@;49///@;50///@;52///@;53///@"
	I FBACT="X" S DR="45///@;52///@;53///@;49////^S X=FBXDT;50////^S X=$G(FBRCOD);51///^S X=FBXCOD" D
	.I FBXCOD'="R" S ^TMP("FBERR",$J,5,I)=""_U_FBPROG_U_+FBIEN
	.I FBXCOD="R" S DR=DR_";48///@"
	S DIE="^FBAAI("
	D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAAI(DA)
	D KILL
	Q
	;
T	;update travel payment record
	Q:'$D(^FBAAC(+FBIEN(1),3,+FBIEN,0))  S FBAMT=+$P(^(0),U,3) D
	. I FBDAMT-FBINAMT'=FBAMT,$G(FBACT)="C" S ^TMP("FBERR",$J,4,I)=""_U_FBPROG_U_+FBIEN(1)_U_+FBIEN
	S DA(1)=+FBIEN(1),DA=+FBIEN
	S DR=""
	I FBACT="C" S DR="8////^S X=FBCKDT;9///^S X=FBCKNUM;13///^S X=FBDAMT;14///^S X=FBINAMT;10///@;11///@"
	I FBACT="B" S DR="8///@;9///@;10///@;11///@;13///@;14///@"
	I FBACT="X" S DR="8///@;13///@;14///@;10////^S X=FBXDT;11////^S X=$G(FBRCOD);12///^S X=FBXCOD" D
	.I FBXCOD'="R" S ^TMP("FBERR",$J,5,I)=""_U_FBPROG_U_+FBIEN(1)_U_+FBIEN
	.I FBXCOD="R" S DR=DR_";9///@"
	S DIE="^FBAAC("_+FBIEN(1)_",3,"
	D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAAC(DA(1),3,DA)
	D KILL
	Q
	;
END	;clean and exit
	K FB,FBPAID,FBSITE,FBAASN,FBSN,FBMCNT,I,XMER,XMREC,XMRG,XMY,^TMP("FBERR",$J),^TMP("FBPAID",$J),^TMP("FBREC",$J)
KILL	K FBLOCK,DIE,DA,DR,FBIEN,FBACT,FBCKNUM,FBRCOD,FBPROG,FBCKDT,FBXDT,FBXCOD,FBINAMT,FBDAMT,FBAMT,FBERR
	Q

FBPAID1
FBPAID1	;AISC - SERVER ROUTINE TO UPDATE PAYMENTS CON'T ;4/13/94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PARSE	;set-up variables for payment record called from FBPAID
	;  FBPROG = 3 for Outpatient (file 162)
	;         = T for Travel (file 162)
	;         = 5 for Pharmacy (file 162.1)
	;         = 9 for Inpatient (file 162.5)
	;         = $E(XMRG,7)      fee program and effected file
	;  FBACT  = $E(XMRG,8)      type of activity                
	;  FBIEN(x)=$E(XMRG,9,38)   IEN for payment record to update
	;  FBCKNUM= $E(XMRG,39,46)  check number
	;  FBCKDT = $E(XMRG,47,52)  check date
	;  FBINAMT= $E(XMRG,53,60)  interest amount
	;  FBXDT  = $E(XMRG,61,66)  cancel date
	;  FBRCOD = $E(XMRG,67)     reason code
	;  FBXCOD = $E(XMRG,68)     cancel code
	;  FBDAMT = $E(XMRG,69,76)  disbursed amount
	;  FBAMT  = Amount paid out of payment record
	Q:$G(FBERR)
	S FBPROG=$E(XMRG,7) I $S(FBPROG=3:0,FBPROG=5:0,FBPROG=9:0,FBPROG="T":0,1:1) S FBERR=1 Q
	S FBACT=$E(XMRG,8) I $S(FBACT="C":0,FBACT="B":0,FBACT="X":0,1:1) S FBERR=1 Q
	S FBIEN=$E(XMRG,9,38) D  Q:$G(FBERR)
	. I FBPROG=3 D  Q:$G(FBERR)
	..S FBIEN(3)=+$P(FBIEN,U),FBIEN(2)=+$P(FBIEN,U,2),FBIEN(1)=+$P(FBIEN,U,3),FBIEN=+$P(FBIEN,U,4)
	..I '$D(^FBAAC(FBIEN(3),1,FBIEN(2),1,FBIEN(1),1,FBIEN,0)) S FBERR=1,^TMP("FBERR",$J,3,I)=""
	. ;
	. I FBPROG=5 D  Q:$G(FBERR)
	..S FBIEN(1)=+$P(FBIEN,U),FBIEN=+$P(FBIEN,U,2)
	..I '$D(^FBAA(162.1,FBIEN(1),"RX",FBIEN,0)) S FBERR=1,^TMP("FBERR",$J,3,I)=""
	. ;
	. I FBPROG=9 D  Q:$G(FBERR)
	..S FBIEN=+FBIEN I '$D(^FBAAI(FBIEN,0)) S FBERR=1,^TMP("FBERR",$J,3,I)=""
	. ;
	. I FBPROG="T" D  Q:$G(FBERR)
	..S FBIEN(1)=+$P(FBIEN,U),FBIEN=+$P(FBIEN,U,2)
	..I '$D(^FBAAC(FBIEN(1),3,FBIEN,0)) S FBERR=1,^TMP("FBERR",$J,3,I)=""
	S FBCKNUM=$$EXTRL^FBMRASVR($E(XMRG,39,46),1),FBCKDT=$$DATE^FBPAID1($E(XMRG,47,52))
	S FBINAMT=$S(+$E(XMRG,53,60):+$E(XMRG,53,58)_"."_$E(XMRG,59,60),1:0)
	S FBINAMT=$S(FBINAMT=0:0,$P(FBINAMT,".",2)'>0:$P(FBINAMT,"."),1:+FBINAMT)
	S FBXDT=$$DATE^FBPAID1($E(XMRG,61,66))
	S FBRCOD=$E(XMRG,67),FBXCOD=$E(XMRG,68)
	S FBRCOD=$O(^FB(162.95,"C",FBRCOD,0))
	S FBDAMT=$S(+$E(XMRG,69,76):+$E(XMRG,69,74)_"."_$E(XMRG,75,76),1:0)
	S FBDAMT=$S(FBDAMT=0:0,$P(FBDAMT,".",2)'>0:$P(FBDAMT,"."),1:+FBDAMT)
	Q
	;
BUL	;create server bulletin message
	S ^TMP("FBPAID",$J,0)=FBMCNT
	Q
DATE(X)	;pass in 'X'=date in yymmdd format and return date in
	;fileman format.
	N Y I '$G(X) Q ""
	S %DT="",X=$E(X,3,7)_$E(X,1,2) D ^%DT K %DT
	Q $S(Y=-1:"",1:Y)

FBPAID2
FBPAID2	;AISC - SERVER ALERT MESSAGES
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S FBN=0,XQSTXT(FBN)=""
	;process those payments that have the amount paid changed in FMS
	I $D(^TMP("FBERR",$J,4)) D
	.S FBN=FBN+1,XQSTXT(FBN)="  The 'AMOUNT PAID' has been altered on the Fee Payment Voucher Document",FBN=FBN+1,XQSTXT(FBN)="  in FMS for the following payments:",FBN=FBN+1,XQSTXT(FBN)=""
	.S I=0 F  S I=$O(^TMP("FBERR",$J,4,I)) Q:'I  S FBI=$P(^(I),U,2,99) D @$P(FBI,U)
	I FBN'>3 K XQSTXT S FBN=0,XQSTXT(FBN)=""
	I FBN>3 S FBN=FBN+1,XQSTXT(FBN)=" >>> For detailed payment information use the appropriate payment output. <<<",FBN=FBN+1,XQSTXT(FBN)=""
	;process those payments that have been cancelled and require human int.
	S FBNH=FBN
	I $D(^TMP("FBERR",$J,5)) D
	.S FBN=FBN+1,XQSTXT(FBN)="  Payment has been cancelled for the following line items:",FBN=FBN+1,XQSTXT(FBN)=""
	.S I=0 F  S I=$O(^TMP("FBERR",$J,5,I)) Q:'I  S FBI=$P(^(I),U,2,99) D @$P(FBI,U)
	I FBN'=FBNH&(FBN-FBNH'>3) F I=FBNH:1:FBN K XQSTXT(I)
	I FBN-FBNH>3 S FBN=FBN+1,XQSTXT(FBN)=" >>> For detailed check information use the Check Display output. <<<",FBN=FBN+1,XQSTXT(FBN)=""
	D EXIT^FBMRASV2 K FBN,I,D,FBI,FBNH
	Q
3	;write outpatient medical payment (162)
	S D(3)=+$P(FBI,U,2),D(2)=+$P(FBI,U,3),D(1)=+$P(FBI,U,4),D=+$P(FBI,U,5)
	D OUTP(+FBI,.D)
	K D,FBI
	Q
	;
5	;write pharmacy payments
	S D(1)=+$P(FBI,U,2),D=+$P(FBI,U,3)
	D OUTP(+FBI,.D)
	K D,FBI
	Q
	;
9	;write inpatient payments
	S D=+$P(FBI,U,2)
	D OUTP(+FBI,.D)
	K D,FBI
	Q
T	;write travel payments
	S D(1)=+$P(FBI,U,2),D=+$P(FBI,U,3)
	D OUTP($P(FBI,U),.D)
	K D,FBI
	Q
	Q
OUTP(X,Y)	;X=fee program
	;y=ien array of payment record
	I X=3,$D(^FBAAC(D(3),1,D(2),1,D(1),1,D,0)) S D(0)=^(0),D(4)=$G(^(2)) I $P(D(4),U,3)]"" S FBN=FBN+1 D
	. S XQSTXT(FBN)="Check Number: "_$P(D(4),U,3)_$S($P(D(0),U,20)'="R":" to "_$E($$VEN^FBUCUTL(D(2)),1,30),1:"")_" for "_$E($$VET^FBUCUTL(D(3)),1,30)_" - "_$$SSN^FBAAUTL(D(3),1)
	. S FBN=FBN+1,XQSTXT(FBN)="         CPT: "_$P($G(^ICPT($P(D(0),U),0)),U)_"  Date of Service: "_$$DATX^FBAAUTL($P($G(^FBAAC(D(3),1,D(2),1,D(1),0)),U))
	. S XQSTXT(FBN)=XQSTXT(FBN)_"  Invoice Number: "_$P($G(D(0)),U,16)
	;
	I X=5,$D(^FBAA(162.1,D(1),"RX",D,0)) S D(0)=^(0),D(2)=^(2) I $P(D(2),U,10)]"" S FBN=FBN+1 D
	. S XQSTXT(FBN)="Check Number: "_$P(D(2),U,10)_$S($P(D(0),U,20)'="R":" to "_$E($$VEN^FBUCUTL(+$P(^FBAA(162.1,D(1),0),U,4)),1,30),1:"")_" for "_$E($$VET^FBUCUTL(+$P(D(0),U,5)),1,30)_" - "_$$SSN^FBAAUTL(+$P(D(0),U,5),1)
	. S FBN=FBN+1,XQSTXT(FBN)="         RX#: "_$P(D(0),U)_"  Date of Service: "_$$DATX^FBAAUTL($P(D(0),U,3))_"  Invoice Number: "_$P(^FBAA(162.1,+D(1),0),U)
	;
	I X=9,$D(^FBAAI(D,0)) S D(0)=^(0),D(2)=$G(^(2)) I $P(D(2),U,4)]"" S FBN=FBN+1 D
	. S XQSTXT(FBN)="Check Number: "_$P(D(2),U,4)_$S($P(D(0),U,13)'="R":" to "_$E($$VEN^FBUCUTL(+$P(D(0),U,3)),1,30),1:"")_" for "_$E($$VET^FBUCUTL(+$P(D(0),U,4)),1,30)_" - "_$$SSN^FBAAUTL(+$P(D(0),U,4),1)
	. S FBN=FBN+1,XQSTXT(FBN)="   From Date: "_$$DATX^FBAAUTL($P(D(0),U,6))_"   To Date: "_$$DATX^FBAAUTL($P(D(0),U,7))_"  Invoice Number: "_$P(D(0),U)
	;
	I X="T",$D(^FBAAC(D(1),3,D,0)) S D(0)=^(0) I $P(D(0),U,7)]"" S FBN=FBN+1 D
	. S XQSTXT(FBN)="Check Number: "_$P(D(0),U,7)_" to "_$E($$VET^FBUCUTL(+D(1)),1,30)_" - "_$$SSN^FBAAUTL(+D(1),1)_" for travel on"
	. S FBN=FBN+1,XQSTXT(FBN)="        Date: "_$$DATX^FBAAUTL($P(D(0),U))
	Q

FBPAY
FBPAY	;AISC/DMK,GRR,TET-PATIENT/VENDOR PAYMENT OUTPUT DRIVER ;6/14/93  09:29
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
GETVEN	;select vendor
	K FBX S FBSORT=0 ;FBSORT=1 for patient, = 0 for vendor
	S DIC="^FBAAV(",DIC(0)="AEQMZ",DIC("A")="Select Fee Vendor: " W !! D ^DIC K DIC("A") G EXIT:$D(DTOUT)!($D(DUOUT))!(X=""),GETVEN:Y<0
	S FBIEN=+Y,FBNAME=$S(Y(0,0)]"":Y(0,0),1:"UNKNOWN"),FBID=$S($P(Y(0),U,2)]"":$P(Y(0),U,2),1:"UNKNOWN") G DATE
GETVET	;select patient
	K FBX S FBSORT=1 ;FBSORT=1 for patient, =0 for vendor
	S DIC="^FBAAA("
	S DIC(0)="AEQMNZ",DIC("A")="Select Fee Patient: " W !! D ^DIC K DIC("A") G EXIT:$D(DTOUT)!($D(DUOUT))!(X=""),GETVET:Y<0
	S FBIEN=+Y,FBNAME=Y(0,0),FBID=$$SSN^FBAAUTL(FBIEN)
DATE	;select date range
	D DATE^FBAAUTL I FBPOP G GETVET:FBSORT,GETVEN
	S FBBDATE=BEGDATE,FBEDATE=ENDDATE
	S Z=9999999.9999,FBBEG=Z-FBEDATE,FBEND=Z-FBBDATE
PROG	;select one/many/all fee programs
	I '$G(FBCHK) S DIC="^FBAA(161.8,",DIC("S")="I $P(^(0),U,3)",VAUTSTR="FEE Program",VAUTNI=2,VAUTVB="FBPROG" D FIRST^VAUTOMA I 'FBPROG&('$O(FBPROG(0))) G GETVET:FBSORT,GETVEN
	I FBPROG S FBERR=0 D ARRAY G EXIT:FBERR
Q	K ^TMP($J,"FB"),^TMP($J,"FBTR"),DIC S FBX=FBSORT
	S VAR="FBNAME^FBIEN^FBID^FBBEG^FBEND^FBBDATE^FBEDATE^FBPROG^FBPROG(^FBSORT",VAL=VAR,PGM="DQ^FBPAY" D ZIS^FBAAUTL G:FBPOP EXIT
DQ	S $P(FBDASH,"=",80)="",$P(FBDASH1,"-",80)="",FBPG=0,FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBOUT=0,FBBEG=FBBEG-.9 U IO
SORT	;sort driver for payment output(s)
	S FBPI=0 F  S FBPI=$O(FBPROG(FBPI)) Q:'FBPI  S FBXPROG=FBPROG(FBPI) D
	.I FBPI=2 D EN^FBPAY2 ;outpatient payments
	.I FBPI=3 D EN^FBPAY3 ;pharmacy payments
	.I FBPI=6!(FBPI=7) S:FBPI=6&$D(FBPROG(7)) FBPIFLG=67 D EN^FBPAY67 S:$D(FBPIFLG) FBPI=7 K FBPIFLG ;civil hospital/cnh payments
PRINT	;print driver for payment output(s)
	S FBPI=$O(^TMP($J,"FB",0)) I FBPI']"" D WMSG G OUT
	S (FBOUT,FBPI)=0 F  S FBPI=$O(FBPROG(FBPI)) Q:'FBPI  S FBXPROG=FBPROG(FBPI) D  Q:FBOUT
	.I FBPI=2,$D(^TMP($J,"FB",FBPI)) D PRINT^FBPAY21 Q:$G(FBOUT)  D:$D(^TMP($J,"FB",FBPI_"O")) OTH Q
	.I FBPI=3 D:$D(^TMP($J,"FB",FBPI)) PRINT^FBPAY3 Q:$G(FBOUT)  D:$D(^TMP($J,"FB",FBPI_"O")) OTH Q
	.I FBPI=6!(FBPI=7) D:$D(^TMP($J,"FB",FBPI)) PRINT^FBPAY671 Q:$G(FBOUT)  D:$D(^TMP($J,"FB",FBPI_"O")) OTH Q
OUT	I FBOUT!$D(ZTQUEUED) G EXIT
	D KILL G GETVET:FBX,GETVEN
	Q
EXIT	;kill and quit
	K FBX
KILL	;kill all variables set in the FBPAY* routines, other than fbx
	D CLOSE^FBAAUTL K ^TMP($J,"FB"),^TMP($J,"FBTR")
	K A1,A2,A3,BEGDATE,B3,C,C3,D,D2,DFN,DIC,DIR,DTOUT,DUOUT,ENDDATE
	K FBAACPTC,FBAC,FBAP,FBBATCH,FBBDATE,FBBEG,FBBN,FBCNT,FBCP,FBCRT,FBDA1,FBDASH,FBDASH1,FBDATA,FBDOB,FBDRUG,FBDT,FBDT1,FBDOS,FBEDATE,FBEND,FBERR,FBFD,FBFD1,FBHEAD,FBMOD
	K FBI,FBID,FBIEN,FBIN,FBINVN,FBIX,FBLOC,FBM,FBNAME,FBOB,FBOPI,FBOUT,FBOV,FBP,FBPAT,FBPD,FBPDX,FBPG,FBPI,FBPID,FBPIFLG,FBPIN,FBPISV,FBPNAME,FBPROG,FBPT,FBPV,FBQTY,FBREIM,FBR,FBRX,FBTRCK
	K FBSC,FBSL,FBSORT,FBSTR,FBSUSP,FBTA,FBTRDT,FBTRX,FBTYPE,FBV,FBVCHAIN,FBVNAME,FBVI,FBVID,FBVP,FBXPROG,FBY,FBZ,I,J,K,L,M,PGM,T,V,VA,VAERR,VAL,VAR,VAUTNI,VAUTSTR,VAUTVB,X,Y,Z
	Q
ARRAY	;set array if all programs are selected
	S FBPI=0 F  S FBPI=$O(^FBAA(161.8,FBPI)) Q:'FBPI  S FBPIN=$G(^(FBPI,0)) I $P(FBPIN,U,3) S FBPROG(FBPI)=$P(FBPIN,U)
	I '$D(FBPROG) S FBERR=1
	Q
WMSG	;write message if no matches found
	S FBPG=FBPG+1 W:$G(FBCRT) @IOF W !
	W !?25,$S($G(FBSORT):"VETERAN",1:"VENDOR")," PAYMENT HISTORY",!?24,$E(FBDASH,1,24),?71,"Page: ",FBPG
	I FBSORT W !,"Patient: ",FBNAME,?41,"Patient ID:",FBID
	I 'FBSORT W !,"Vendor: ",FBNAME,?41,"Vendor ID:",FBID
	;W !?(IOM-12/2),"FEE PROGRAM:"
	W !?3,"('*' Reimb. to Patient   '+' Cancel. Activity   '#' Voided Payment)"
	W !!!,FBDASH
	W !!,"There are no payments on file for "_$S(FBSORT:"Veteran",1:"Vendor")_" ",FBNAME,!?3,"for specified date range: ",$$DATX^FBAAUTL(FBBDATE)," through ",$$DATX^FBAAUTL(FBEDATE)
	I 'FBPROG D
	.W !?3,"and selected Fee Program(s):"
	.S FBPI=0 F  S FBPI=$O(FBPROG(FBPI)) Q:'FBPI  W !?30,FBPROG(FBPI)
	I FBPROG W !?3,"and ALL Fee programs"
	W ".",*7,!!
	Q
OTH	;other fee basis programs
	I '$D(^TMP($J,"FB",FBPI_"O")) Q
	S FBZ=FBPI,FBPI=FBPI_"O",FBPROG(FBPI)="**OUTPATIENT** "_FBXPROG
	D PRINT^FBPAY21
	K FBPROG(FBPI) S FBPI=FBZ K FBZ
	Q

FBPAY2
FBPAY2	;AISC/DMK,GRR,TET - OUTPATIENT PAYMENT HISTORY SORT/PRINT ;4/28/93  11:08
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	;entry point
	I FBSORT S FBPNAME=FBNAME,FBPID=FBID,(DFN,J)=FBIEN D SORT
	I 'FBSORT S FBVNAME=$E(FBNAME,1,23),FBVID=FBID,FBVI=FBIEN,J=0 F  S J=$O(^FBAAC("AB",FBVI,J)) Q:J'>0  S DFN=J,FBPID=$$SSN^FBAAUTL(DFN),FBPNAME=$P($G(^DPT(DFN,0)),U) D SORT
KILL	;kill variables set in this routine
	K A1,A2,A3,B3,C3,D,D2,FBAACPTC,FBBN,FBCP,FBDOS,FBDT,FBDT1,FBIN,FBOB,FBP,FBPAT,FBPDX,FBSC,FBTA,FBTRDT,FBTRX,FBTYPE,FBVEN,FBVP,I,J,K,L,M,T,Y K:FBSORT FBVNAME,FBVID K:'FBSORT FBPNAME,FBPID,FBTRCK
	Q
SORT	S I=FBBEG F  S I=$O(^FBAAC(J,"AB",I)) Q:'I!(I>FBEND)  F K=0:0 S K=$O(^FBAAC(J,"AB",I,K)) Q:'K  I FBSORT!(('FBSORT)&(K=$G(FBVI))) F L=0:0 S L=$O(^FBAAC(J,"AB",I,K,L)) Q:'L  D SETTR F M=0:0 S M=$O(^FBAAC(J,1,K,1,L,1,M)) Q:'M  D SET,SETTMP
	Q
SET	;set variables & sort - also entry point from FBPAY67
	S Y=$G(^FBAAC(J,1,K,1,L,1,M,0)) I '+$P(Y,U,9)!($G(^FBAAC(J,1,K,1,L,1,M,"FBREJ"))]"") S FBOUT=1 Q
	D FBCKO^FBAACCB2(J,K,L,M)
	S FBMOD=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),U,7)
	S:FBSORT FBVNAME=$E($P($G(^FBAAV(K,0)),U),1,23),FBVID=$S(FBVNAME]"":$P(^(0),U,2),1:"")
	S FBP=+$P(Y,U,9),FBSC=$P(Y,U,27),FBPDX=+$P(Y,U,23)
	S FBSC=$S(FBSC="Y":"YES",FBSC="N":"NO",1:"-")
	S FBPDX=$S($D(^ICD9(FBPDX,0)):$E($P($G(^(0)),U,3),1,18)_" ("_$P($G(^(0)),U)_")",1:"")
	S T=$P(Y,U,5),D2=$P(Y,U,6),FBDOS=D2,D2=$$DATX^FBAAUTL(D2),FBCP=$P(Y,U,18),FBCP=$S(FBCP=1:"(C&P)",1:"")
	S FBAACPTC=$P($G(^ICPT(+Y,0)),U),FBOB=$P(Y,U,10)
	I T]"" S T=$P($G(^FBAA(161.27,+T,0)),U)
	S FBTYPE=$P(Y,U,20),FBVP=$P(Y,U,21),FBIN=$P(Y,U,16),FBBN=$P(Y,U,8),FBBN=$S(FBBN']"":"",$D(^FBAA(161.7,FBBN,0)):$P(^(0),U),1:""),FBBN=$S(FBBN="":"",1:$E("00000",$L(FBBN)+1,5)_FBBN)
	S FBVEN=FBVNAME_";"_FBVID,FBPAT=FBPNAME_";"_DFN
	;output format
	S A1=$J($P(Y,U,2),6,2),A2=$J($P(Y,U,3),6,2),FBIN=$J(FBIN,7)
	S FBDT1=$S(FBVP="VP":"#",1:"")_$S(FBTYPE="R":"*",1:" ")_FBDT
	Q
SETTMP	;sort data by fee program, vendor, patient, date
	I '$D(FBPROG(+$P(Y,U,9)))!($P(Y,U,9)'=FBPI)!($G(^FBAAC(J,1,K,1,L,1,M,"FBREJ"))]"") S FBOUT=1 G SETTMP1
	S ^TMP($J,"FB",FBP,FBVEN,FBPAT,I,L,M)=FBDT1_U_FBAACPTC_FBCP_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:"")_U_A1_U_A2_U_T_U_FBBN_U_FBIN_U_D2_U_FBSC_U_FBPDX_U_FBOB
	S ^TMP($J,"FB",FBP,FBVEN,FBPAT,I,L,M,"FBCK")="^"_FBCK_"^"_FBCKDT_"^"_FBCANDT_"^"_FBCANR_"^"_FBCAN_"^"_FBDIS_"^"_FBCKINT
SETTMP1	D PMTCLN^FBAACCB2
	Q
SETTR	S D=$S($D(^FBAAC(J,1,K,1,L,0)):$P(^(0),"^",1),1:""),A3=""
	I D]"",$D(^FBAAC(J,3,"AB",D)) S (FBTA,FBCTR)=0 F  S FBTA=$O(^FBAAC(J,3,"AB",D,FBTA)) Q:'FBTA  S A3=$P($G(^FBAAC(J,3,FBTA,0)),"^",3) I A3>0 D
	.D FBCKT^FBAACCB0(J,FBTA) S FBCTR=FBCTR+1,^TMP($J,"FBTR",FBPNAME,D,FBCTR)=$J(A3,6,2)_"^"_FBCK_"^"_FBCKDT_"^"_FBCANDT_"^"_FBCANR_"^"_FBCAN_"^"_FBDIS_"^"_FBCKINT
	K A3,B3,FBTA,FBCTR
	S FBDT=$$DATX^FBAAUTL(D)
	Q
EN1	;entry point to set variables, called by fbpay67, oth & anc
	N FBVEN,FBPAT,FBDT1
	D SETTR,SET
	Q
WMSG	;write message if no matches found
	W !!,"There are no outpatient payments on file for specified date range"
	W:'FBPROG !?3," and selected Fee programs"
	W ".",*7,!!
	Q

FBPAY21
FBPAY21	;AISC/CMR - OUTPATIENT PAYMENT HISTORY SORT/PRINT ;4/28/93  11:08
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PRINT	;write output
	S FBOUT=0 D:FBCRT&(FBPG) CR Q:FBOUT
	D HDR I FBSORT S FBPAT=FBPNAME I $D(^TMP($J,"FBTR")) S FBTRCK=1 D TRAV^FBPAY671
	S FBVI="" F  S FBVI=$O(^TMP($J,"FB",FBPI,FBVI)) Q:FBVI']""!(FBOUT)  D:FBSORT SH Q:FBOUT  S FBPT="" D  Q:FBOUT
	.F  S FBPT=$O(^TMP($J,"FB",FBPI,FBVI,FBPT)) Q:FBPT']""!(FBOUT)  D:'FBSORT SH,SH1 Q:FBOUT  S FBDT=0 F  S FBDT=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT)) Q:'FBDT!(FBOUT)  D
	..S L=0 F  S L=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L)) Q:'L!(FBOUT)  S M=0 F  S M=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L,M)) Q:'M!(FBOUT)  D
	...I ($Y+6)>IOSL D PAGE Q:FBOUT
	...S FBDATA=^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L,M)
	...S FBLOC=1_U_12_U_23_U_33_U_42_U_57_U_63_U_71
	...S FBCKIN=$G(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L,M,"FBCK")) D EFBCK(FBCKIN)
	...W !,$S($G(FBCAN)]"":"+",1:"") F I=1:1:8 W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
	...S A2=$$EXTRL^FBMRASVR($P(FBDATA,U,4))
	...W !?4,"Primary Dx: ",$P(FBDATA,U,10),?40,"S/C Condition? ",$P(FBDATA,U,9) W ?63,"Obl.#: ",$P(FBDATA,U,11)
	...D PMNT^FBAACCB2 K A2
	Q
HDR	;main header
	I FBPG>0!FBCRT W @IOF
	S FBPG=FBPG+1
	W !?25,$S($G(FBSORT):"VETERAN",1:"VENDOR")," PAYMENT HISTORY",!?24,$E(FBDASH,1,24),?71,"Page: ",FBPG,!
	W:FBSORT "Patient: ",FBPNAME,?41,"Patient ID: ",FBPID W:'FBSORT "Vendor: ",FBVNAME,?41,"Vendor ID: ",FBVID
	;W ?71,"Page: ",FBPG
	W !?(IOM-(13+$L(FBPROG(+FBPI)))/2),"FEE PROGRAM: ",FBPROG(+FBPI)
	W !,?3,"('*' Reimb. to Patient   '+' Cancel. Activity   '#' Voided Payment)"
	W !,?2,"Svc Date",?11,"CPT-MOD ",?23,"Amount",?33," Amount",?42,"Susp",?57,"Batch",?63,"Invoice",?71,"Voucher"
	W !,?23,"Claimed",?35,"Paid",?42,"Code",?58,"Num",?64,"Num",?72,"Date",!,FBDASH
	Q
SH	;subheader - vendor if fbsort; patient if 'fbsort, prints when name changed
	I ($Y+8)>IOSL D:FBCRT CR Q:FBOUT  D HDR
	I FBSORT W !!,"Vendor: ",$P(FBVI,";"),?41,"Vendor ID: ",$P(FBVI,";",2)
	I 'FBSORT W !!,"Patient: ",$P(FBPT,";"),?41,"Patient ID: ",$$SSN^FBAAUTL($P(FBPT,";",2))
	Q
SH1	S FBPAT=$P(FBPT,";") I $D(^TMP($J,"FBTR",FBPAT)) S FBTRCK=1 D TRAV^FBPAY671
	Q
CR	;read for display
	S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
PAGE	;new page
	I FBCRT D CR Q:FBOUT
	D HDR,SH
	Q
EFBCK(FBCKIN)	;extract check information from ^TMP
	I $G(FBCKIN)']"" S (FBCK,FBCKDT,FBCANDT,FBCANR,FBCAN,FBDIS,FBCKINT)="" Q
	S U="^",FBCK=$P(FBCKIN,U,2),FBCKDT=$P(FBCKIN,U,3),FBCANDT=$P(FBCKIN,U,4),FBCANR=$P(FBCKIN,U,5),FBCAN=$P(FBCKIN,U,6),FBDIS=$P(FBCKIN,U,7),FBCKINT=$P(FBCKIN,U,8)
	K FBCKIN
	Q
	;
EN	;entry from fbpay67 to set '*' if ancillary payment is
	;a reimbursement.  returns FBRP=to '*' or " "
	;'Y' passed in equal to zero node of 162.03 look at $P(Y,U,20)
	;
	S FBR=$P($G(Y),U,20),FBR=$S(FBR="R":"*",1:" ")
	Q

FBPAY3
FBPAY3	;AISC/GRR,TET-PHARMACY PAYMENT HISTORY, SORT/PRINT ;9/1/92  16:44
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	;entry point
	I FBSORT S FBPNAME=FBNAME,FBPID=FBID,(DFN,J)=FBIEN,FBDOB=$$DATX^FBAAUTL($P($G(^DPT(DFN,0)),U,3)) D SORT
	I 'FBSORT S FBVNAME=$E(FBNAME,1,23),FBVID=FBID,FBVI=FBIEN,FBVCHAIN=$P($G(^FBAAV(FBVI,0)),U,10),FBDA1=0 D
	.F  S FBDA1=$O(^FBAA(162.1,"AN",FBVI,FBDA1)) Q:'FBDA1  S J=0 F  S J=$O(^FBAA(162.1,FBDA1,"RX","C",J)) Q:'J  S DFN=J D VET,SORT
FBAAC	;check if anything in an xref, fbaac global (file 162)
	I '$D(^TMP($J,"FB",FBPI)),$D(^FBAAC("AN",FBPI)) D:'FBSORT AN^FBPAY67
KILL	;kill variables set in sort
	K A1,A2,FBAC,FBAP,FBBATCH,FBDA1,FBDRUG,FBFD,FBFD1,FBINVN,FBLOC,FBPAT,FBPD,FBPV,FBQTY,FBREIM,FBRX,FBSTR,FBSUSP,FBVEN,FBVI,I,J,K,L,N,V,Y
	K:FBSORT FBVNAME,FBVID,FBVCHAIN K:'FBSORT FBPNAME,FBPID,FBDOB
	D KILL^FBPAY2
	Q
SORT	;
	S I=FBBEG F  S I=$O(^FBAA(162.1,"AD",J,I)) Q:I'>0!(I>FBEND)  S K=0 F  S K=$O(^FBAA(162.1,"AD",J,I,K)) Q:K'>0  S L=0 F  S L=$O(^FBAA(162.1,"AD",J,I,K,L)) Q:L'>0  D SET
	Q
	;
SET	;
	S Y(0)=$G(^FBAA(162.1,+K,"RX",+L,0)) I Y(0)']""!($P(Y(0),U,9)=1) Q
	I $G(^FBAA(162.1,+K,"RX",+L,"FBREJ"))]"" Q  ;Eliminates Rejected Payments
	I 'FBSORT Q:FBVI'=$P($G(^FBAA(162.1,+K,0)),"^",4)
	S Y(2)=$G(^FBAA(162.1,+K,0))
	S Y(1)=$G(^FBAA(162.1,+K,"RX",+L,2))
	S FBINVN=$P(Y(2),U) D VEN:FBSORT,VET:'FBSORT
	S FBRX=$P(Y(0),U,1),FBDRUG=$P(Y(0),U,2),FBFD=$P(Y(0),U,3),FBAC=$P(Y(0),U,4),FBAP=$P(Y(0),U,16),FBSUSP=$P(Y(0),U,8),FBPD=$P(Y(0),U,19),FBBATCH=$P(Y(0),U,17),FBBATCH=$P($G(^FBAA(161.7,+FBBATCH,0)),U)
	I FBSUSP]"" S FBSUSP=$P($G(^FBAA(161.27,+FBSUSP,0)),U)
	S FBREIM=$S($P(Y(0),U,20)="R":"*",1:""),FBSTR=$P(Y(0),U,12),FBQTY=$P(Y(0),U,13),A1=$J(FBAC,6,2),A2=$J(FBAP,6,2),FBPV=""
	S FBPD=$$DATX^FBAAUTL(FBPD),FBFD=$$DATX^FBAAUTL(FBFD)
	S FBPV=$S($P(Y(1),U,3)="V":"#",1:""),FBFD1=$S(FBPV="":" ",1:FBPV)_$S(FBREIM="":" ",1:FBREIM)_FBFD,FBRX="Rx: "_FBRX
	S FBVEN=FBVNAME_";"_FBVID,FBPAT=FBPNAME_";"_DFN
	D FBCKP^FBAACCB1(K,L)
	S ^TMP($J,"FB",FBPI,FBVEN,FBPAT,I,L)=FBFD1_U_FBRX_U_FBDRUG_U_FBSTR_U_FBQTY_U_A1_U_A2_U_FBSUSP_U_FBINVN_U_FBBATCH_U_FBPD_U_FBDOB_U_FBVCHAIN
	S ^TMP($J,"FB",FBPI,FBVEN,FBPAT,I,L,"FBCK")="^"_FBCK_"^"_FBCKDT_"^"_FBCANDT_"^"_FBCANR_"^"_FBCAN_"^"_FBDIS_"^"_FBCKINT D PMTCLN^FBAACCB2
	S ^TMP($J,"FB",FBPI,FBVEN)=FBVCHAIN,^TMP($J,"FB",FBPI,FBVEN,FBPAT)=FBDOB
	I FBSORT S FBIN(5)=$P(Y(1),U,6) I FBIN(5)]"",$D(^TMP($J,"FB",FBPI,FBVEN,FBPAT,I,L)) D ANC^FBPAY67(I,L)
	I 'FBSORT D OTH^FBPAY67
	Q
VET	;set variables for veteran - 'FBSORT
	S FBPID=$$SSN^FBAAUTL(DFN),N=$G(^DPT(+DFN,0)),FBPNAME=$P(N,U),FBDOB=$$DATX^FBAAUTL($P(N,U,3))
	Q
VEN	;set variables for vendor - FBSORT
	S V=$G(^FBAAV(+$P(Y(2),U,4),0)),FBVNAME=$E($P(V,U),1,23),FBVID=$P(V,U,2),FBVCHAIN=$P(V,U,10)
	Q
PRINT	;write output
	S FBOUT=0 D:FBCRT&(FBPG) CR Q:FBOUT
	D HDR
	S FBVI="" F  S FBVI=$O(^TMP($J,"FB",FBPI,FBVI)) Q:FBVI']""!(FBOUT)  D:FBSORT SH Q:FBOUT  S FBPT="" D  Q:FBOUT
	.F  S FBPT=$O(^TMP($J,"FB",FBPI,FBVI,FBPT)) Q:FBPT']""!(FBOUT)  D:'FBSORT SH Q:FBOUT  S FBDT=0 F  S FBDT=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT)) Q:'FBDT!(FBOUT)  S L=0 F  S L=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L)) Q:'L!(FBOUT)  D  Q:FBOUT
	..I ($Y+8)>IOSL D PAGE Q:FBOUT
	..S FBDATA=^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L),FBCKIN=$G(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L,"FBCK")) D EFBCK^FBPAY21(FBCKIN)
	..S FBLOC="0^2^15^45^63^4^12^20^24^35^53"
	..W !,$P(FBDATA,U),! F I=2:1:$L(FBLOC,"^") W ?$P(FBLOC,U,I),$P(FBDATA,U,I) W:$P(FBLOC,U,I)=63 !
	..S A2=$$EXTRL^FBMRASVR($P(FBDATA,"^",7)) D PMNT^FBAACCB2 K A2
	..I +$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,L,"A",0)) D PANC^FBPAY671(L) Q:FBOUT  W !,FBDASH1
	..W !
EXIT	;kill and quit
	Q
HDR	;main header
	I FBPG>0!FBCRT W @IOF
	S FBPG=FBPG+1
	W !?25,$S($G(FBSORT):"VETERAN",1:"VENDOR")," PAYMENT HISTORY",!?24,$E(FBDASH,1,24),?71,"Page: ",FBPG,!
	W:FBSORT "Patient: ",FBPNAME,?41,"Patient ID: ",FBPID,?65,"DOB: ",FBDOB W:'FBSORT "Vendor: ",FBVNAME,?41,"Vendor ID: ",FBVID,?65,"Chain #: ",FBVCHAIN
	W !?(IOM-(13+$L(FBPROG(+FBPI)))/2),"FEE PROGRAM: ",FBPROG(+FBPI)
	;W ?71,"Page: ",FBPG
On	W !?3,"('*' Reimb. to Patient  '+' Cancel. Activity  '#' Voided Payment)"
	W !?4,"Fill Date",!,?15,"Drug Name",?44,"Strength",?60,"Quantity"
	W !?2,"Claimed",?12,"Paid",?19,"Code",?24,"Invoice #",?35,"Batch #",?50,"Date Certified",!,FBDASH
	Q
SH	;subheader - vendor if fbsort; patient if  'fbsort, prints when name changes
	I ($Y+10)>IOSL D:FBCRT CR Q:FBOUT  D HDR
	I FBSORT W !!,"Vendor:",$P(FBVI,";"),?41,"Vendor ID: ",$P(FBVI,";",2),?65,"Chain #: ",$P($G(^TMP($J,"FB",FBPI,FBVI)),U)
	I 'FBSORT W !!,"Patient: ",$P(FBPT,";"),?41,"Patient ID: ",$$SSN^FBAAUTL($P(FBPT,";",2)),?65,"DOB: ",$P($G(^TMP($J,"FB",FBPI,FBVI,FBPT)),U)
	Q
CR	;read for display
	S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
PAGE	;new page
	I FBCRT D CR Q:FBOUT
	D HDR,SH
	Q

FBPAY67
FBPAY67	;AISC/DMK,TET-CH/CNH PAYMENT HISTORY SORT;29AUG90 ;9/1/92  16:33
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	;entry to sort
	I FBSORT S DFN=FBIEN,FBPID=FBID,FBPNAME=FBNAME
	I 'FBSORT S FBVI=FBIEN,FBVID=FBID,FBVNAME=$E(FBNAME,1,23)
FBAAC	;check ^fbaac("an" (file 162)
	S FBOUT=0 I $D(^FBAAC("AN",FBPI)) D AN  I $G(FBPIFLG) S FBPI=7 D AN S FBPI=6
	S I=FBBEG,FBIX=$S(FBSORT:"AG",1:"AF")
SORT	;sort programs 6 & 7 (civil hos & cnh)
	F FBM=FBBEG-.1:0 S FBM=$O(^FBAAI(FBIX,FBIEN,FBM)) Q:FBM'>0!(FBM>FBEND)  F FBI=0:0 S FBI=$O(^FBAAI(FBIX,FBIEN,FBM,FBI)) Q:FBI'>0  I $G(^FBAAI(FBI,"FBREJ"))']"" D SET S FBPI=FBPISV
KILL	;kill variables set in routine and in FBPAY2, sort/set sections
	K A1,A2,A3,D,D2,FBAACPTC,FBBN,FBCNT,FBCP,FBDT,FBDT1,FBDX,FBDX1,FBI,FBIN,FBIX,FBM,FBOB,FBPDX,FBPISV,FBPROC,FBPROC1,FBSC,FBTA,FBVEN,FBVENID,FBVP,I,J,K,L,M,Y,FBDT2
	K:FBSORT FBVNAME,FBVID K:'FBSORT FBPNAME,FBPID
	D KILL^FBPAY2
	Q
SET	;set string, also called by fbchdi (fblistc or fbaanq set if called by fbchdi)
	S FBPISV=$G(FBPI),FBIN=$G(^FBAAI(FBI,0)) Q:FBIN']""  S FBPI=+$P(FBIN,U,12)
	I 'FBPROG,'$D(FBPROG(+$P(FBIN,U,12))) Q
	I '$D(FBPIFLG) Q:+$P(FBIN,U,12)'=FBPI
	I $D(FBPIFLG),'FBPROG Q:'$D(FBPROG(+$P(FBIN,U,12)))
	F J=1,2,3,6,7,8,9,11,13,14 S FBIN(J)=$P(FBIN,"^",J)
	S:FBSORT FBIN(5)=$P(FBIN,U,5) I 'FBSORT S FBIN(4)=$P(FBIN,U,4),DFN=FBIN(4) Q:DFN']""  S FBPID=$$SSN^FBAAUTL(DFN),FBPNAME=$P($G(^DPT(+DFN,0)),U)
	I FBSORT S FBVNAME=$G(^FBAAV(FBIN(3),0)) Q:FBVNAME']""  S FBVID=$P(FBVNAME,U,2),FBVNAME=$E($P(FBVNAME,U),1,23)
	S FBIN(2)=$$DATX^FBAAUTL(FBIN(2)),FBVEN=FBVNAME_";"_FBVID,FBPAT=FBPNAME_";"_DFN
	S FBIN(6)=$$DATX^FBAAUTL(FBIN(6)),FBIN(7)=$$DATX^FBAAUTL(FBIN(7))
	D FBCKI^FBAACCB1(FBI)
SETTMP	S ^TMP($J,"FB",+$P(FBIN,U,12),FBVEN,FBPAT,FBM,FBI)=FBIN(2)_U_$J(FBIN(8),8,2)_U_$J(FBIN(9),8,2)_U_FBIN(11)_U_$J(FBIN(1),8)_U_FBIN(6)_U_FBIN(7)_U_FBIN(13)_U_FBIN(14)
	S ^TMP($J,"FB",+$P(FBIN,U,12),FBVEN,FBPAT,FBM,FBI,"FBCK")="^"_FBCK_"^"_FBCKDT_"^"_FBCANDT_"^"_FBCANR_"^"_FBCAN_"^"_FBDIS_"^"_FBCKINT
	S FBDX=$G(^FBAAI(FBI,"DX")) I FBDX]"" S FBDX1="" F I=1:1:5 S:$P(FBDX,U,I) FBDX1=FBDX1_$P($G(^ICD9($P(FBDX,U,I),0)),U)_U
	I FBDX]"" S FBDX1=$P(FBDX1,U,1,($L(FBDX1,U)-1)),^TMP($J,"FB",$P(FBIN,U,12),FBVEN,FBPAT,FBM,FBI,"DX")=FBDX1
	S FBPROC=$G(^FBAAI(FBI,"PROC")) I FBPROC]"" S FBPROC1="" F I=1:1:5 S:$P(FBPROC,U,I) FBPROC1=FBPROC1_$P($G(^ICD0($P(FBPROC,U,I),0)),U)_U
	I FBPROC]"" S FBPROC1=$P(FBPROC1,U,1,($L(FBPROC1,U)-1)),^TMP($J,"FB",$P(FBIN,U,12),FBVEN,FBPAT,FBM,FBI,"PROC")=FBPROC1
	D ANC(FBM,FBI):FBSORT&($D(^TMP($J,"FB",FBPI,FBVEN,FBPAT,FBM,FBI)))
	Q
AN	;get data from an xref - called at tag fbaac in pay3 & pay67
	I FBSORT G AN1
	S FBVEN=FBVNAME_";"_FBVID,DFN=0 F  S DFN=$O(^FBAAC("AN",FBPI,DFN)) Q:'DFN  S FBPAT=$G(^DPT(DFN,0)),FBPNAME=$P(FBPAT,U),FBPID=$$SSN^FBAAUTL(DFN),FBPAT=FBPNAME_";"_DFN D OTH
	Q
AN1	S FBPAT=FBPNAME_";"_FBPID,FBVI=0 F  S FBVI=$O(^FBAAC("AN",FBPI,DFN,FBVI)) Q:'FBVI  S FBVNAME=$E($$VNAME^FBNHEXP(FBVI),1,23),FBVID=$$VID^FBNHEXP(FBVI),FBVEN=FBVNAME_";"_FBVID D OTH
	Q
OTH	;other fee programs - if 'fbsort (by vendor)
	Q:'$O(^FBAAC("AN",FBPI,DFN,FBVI,0))
	N J,K,L,M,Y,FBDT1 S J=DFN,K=FBVI
	S L=0 F  S L=$O(^FBAAC("AN",FBPI,J,K,L)) Q:'L  S FBDT1=$P($G(^FBAAC(J,1,K,1,L,0)),U) I FBDT1]""&(FBDT1'<FBBDATE&(FBDT1'>FBEDATE)) D  S:FBOUT FBOUT=0
	.S M=0 F  S M=$O(^FBAAC("AN",FBPI,J,K,L,M)) Q:'M  S Y=$G(^FBAAC(J,1,K,1,L,1,M,0)) I Y]"" D
	..S FBOUT=0 D EN1^FBPAY2 Q:FBOUT  D EN^FBPAY21
	..S ^TMP($J,"FB",FBPI_"O",FBVEN,FBPAT,(9999999.9999-FBDT1),L,M)=$G(FBR)_$$DATX^FBAAUTL(FBDT1)_U_FBAACPTC_FBCP_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:"")_U_A1_U_A2_U_T_U_FBBN_U_FBIN_U_D2_U_FBSC_U_FBPDX_U_FBOB
	..S ^TMP($J,"FB",FBPI_"O",FBVEN,FBPAT,(9999999.9999-FBDT1),L,M,"FBCK")="^"_FBCK_"^"_FBCKDT_"^"_FBCANDT_"^"_FBCANR_"^"_FBCAN_"^"_FBDIS_"^"_FBCKINT
	Q
ANC(FBM,FBI)	;ancillary payments - if fbsort (by patient)
	N J,K,L,M,Y,FBDT1,FBVID
	S J=FBIEN,FBCNT=0 I J,+FBIN(5),$D(^FBAAC("AM",FBIN(5),J)) D
	.F K=0:0 S K=$O(^FBAAC("AM",FBIN(5),J,K)) Q:'K  S L=0 F  S L=$O(^FBAAC("AM",FBIN(5),J,K,L)) Q:'L  D
	..N FBOUT
	..S FBDT1=$P($G(^FBAAC(J,1,K,1,L,0)),U) I FBDT1]"" S FBDT2=(9999999.9999-FBDT1),FBDT1=$$DATX^FBAAUTL(FBDT1)
	..S M=0 F  S M=$O(^FBAAC("AM",FBIN(5),J,K,L,M)) Q:'M  S Y=$G(^FBAAC(J,1,K,1,L,1,M,0)) I Y]"" D
	...D EN1^FBPAY2 Q:'$D(FBAACPTC)!($G(FBOUT))  S FBCNT=FBCNT+1 D EN^FBPAY21
	...S ^TMP($J,"FB",FBPI,FBVEN,FBPAT,"A",K,L,M)=$G(FBR)_FBDT1_U_FBAACPTC_FBCP_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:"")_U_A1_U_A2_U_T_U_FBBN_U_FBIN_U_D2_U_FBSC_U_FBPDX_U_FBOB_U_FBVNAME_U_FBVID
	...S ^TMP($J,"FB",FBPI,FBVEN,FBPAT,"A",K,L,M,"FBCK")="^"_FBCK_"^"_FBCKDT_"^"_FBCANDT_"^"_FBCANR_"^"_FBCAN_"^"_FBDIS_"^"_FBCKINT
	...I $D(^TMP($J,"FB",FBPI_"O",FBVNAME_";"_FBVID,$P(FBPAT,";")_";"_$$SSN^FBAAUTL($P(FBPAT,";",2)),FBDT2)) K ^TMP($J,"FB",FBPI_"O",FBVNAME_";"_FBVID,$P(FBPAT,";")_";"_$$SSN^FBAAUTL($P(FBPAT,";",2)),FBDT2)
	Q

FBPAY671
FBPAY671	;AISC/DMK,TET-CH/CNH PAYMENT HISTORY PRINT;29AUG90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PRINT	;print data from tmp global
	S FBOUT=0 D:FBCRT&(FBPG) CR Q:FBOUT
	S FBHEAD=$S(FBSORT:"VETERAN",1:"VENDOR")
EN1	N FBI ;entry point from fbchdi
	D HDR S FBVI="" F  S FBVI=$O(^TMP($J,"FB",FBPI,FBVI)) Q:FBVI']""!(FBOUT)  D:FBSORT SH Q:FBOUT  S FBPT="" F  S FBPT=$O(^TMP($J,"FB",FBPI,FBVI,FBPT)) Q:FBPT']""!(FBOUT)  D  Q:FBOUT  D CKANC Q:FBOUT
	.D:'FBSORT SH Q:FBOUT  S FBDT=0 F  S FBDT=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT)) Q:'FBDT!(FBOUT)  S FBI=0 F  S FBI=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,FBI)) Q:'FBI!(FBOUT)  D  Q:FBOUT
	..I ($Y+5)>IOSL D PAGE Q:FBOUT
	..S FBDATA=^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,FBI),A2=$$EXTRL^FBMRASVR($P(FBDATA,U,3))
	..S FBLOC=2_U_23_U_33_U_42_U_49_U_61_U_71
	..W ! W:$P(FBDATA,U,8)["R" "*" W:$P(FBDATA,U,9)]"" "#"
	..F I=1:1:7 W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
	..F FBY="DX","PROC" I $D(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,FBI,FBY)) S FBDATA=^(FBY),FBSL=$L(FBDATA,"^") W !?2,FBY,": " F I=1:1:FBSL W $P(FBDATA,U,I),"    "
	..I $D(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,FBI,"FBCK")) D EFBCK^FBPAY21(^TMP($J,"FB",FBPI,FBVI,FBPT,FBDT,FBI,"FBCK")) D PMNT^FBAACCB2 K A2
	Q
CKANC	I +$O(^TMP($J,"FB",FBPI,FBVI,FBPT,"A",0)) D PANC(FBI) Q:FBOUT  W !,FBDASH1
	Q
PANC(FBI)	;print anc data - FBI = unique number; called by fbpay3
	S (FBOV,FBK)=0,FBSL=8,FBLOC=1_U_12_U_23_U_33_U_43_U_56_U_62_U_71 D SHA Q:FBOUT
	F  S FBK=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,"A",FBK)) Q:'FBK!(FBOUT)  S FBL=0 F  S FBL=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,"A",FBK,FBL)) Q:'FBL!(FBOUT)  S FBM=0 F  S FBM=$O(^TMP($J,"FB",FBPI,FBVI,FBPT,"A",FBK,FBL,FBM)) Q:'FBM!(FBOUT)  D
	.S FBDATA=^(FBM),FBV=$P(FBDATA,U,12)_";"_$P(FBDATA,U,13) D WRT
	K FBK,FBL,FBM Q
WRT	;write ancillary info
	I ($Y+6)>IOSL D PAGE Q:FBOUT  D SHA Q:FBOUT  D SHA2 Q:FBOUT
	D:FBOV'=FBV SHA2
	S FBCKIN=$G(^TMP($J,"FB",FBPI,FBVI,FBPT,"A",FBK,FBL,FBM,"FBCK")) D EFBCK^FBPAY21(FBCKIN)
	W ! W:$G(FBCAN)]"" "+" F I=1:1:FBSL W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
	W !?4,"Primary Dx: ",$P(FBDATA,U,10),?40,"S/C Condition? ",$P(FBDATA,U,9),?66,"Obl.#: ",$P(FBDATA,U,11)
	N A2 S A2=$$EXTRL^FBMRASVR($P(FBDATA,U,4))
	D PMNT^FBAACCB2
	Q
HDR	;main header
	I FBPG>0!FBCRT W @IOF
	S FBPG=FBPG+1
	I $D(FBHEAD) W !?25,FBHEAD_" PAYMENT HISTORY",!,?24,$E(FBDASH,1,24),?71,"Page: ",FBPG,!?48,"Date Range: ",$$DATX^FBAAUTL(FBBDATE)," to ",$$DATX^FBAAUTL(FBEDATE)
	I '$D(FBHEAD) W !?30,"INVOICE DISPLAY",!?29,$E(FBDASH,1,17),!
	W ! W:FBSORT "Patient: ",FBPNAME,?41,"Patient ID: ",FBPID W:'FBSORT "Vendor: ",FBVNAME,?41,"Vendor ID: ",FBVID
	;W ?71,"Page: ",FBPG
	W !?(IOM-(13+$L(FBPROG(+FBPI)))/2),"FEE PROGRAM: ",FBPROG(+FBPI)
	W !?3,"('*' Reimb. to Patient  '+' Cancel. Activity  '#' Voided Payment)"
	W !?2,"Inv Date",?23,"Amount",?33," Amount",?42,"Susp",?49,"Invoice",?61,"From",?73,"To"
	W !?23,"Claimed",?35,"Paid",?42,"Code",?53,"Num",?61,"Date",?71,"Date",!,FBDASH
	Q
SH	;subheader - vendor if fbsort; patient if 'fbsort, prints when name changed
	I ($Y+7)>IOSL D:FBCRT CR Q:FBOUT  D HDR
	I FBSORT W !!,"Vendor: ",$P(FBVI,";"),?41,"Vendor ID: ",$P(FBVI,";",2)
	I 'FBSORT W !!,"Patient: ",$P(FBPT,";"),?41,"Patient ID: ",$$SSN^FBAAUTL($P(FBPT,";",2))
	Q
SHA	;ancillary subheader
	I ($Y+14)>IOSL D PAGE Q:FBOUT
	W !?20,">>> ANCILLARY SERVICE PAYMENTS <<<",!
SHA1	;subheader for ancillary data
	W !,?2,"Svc Date",?11,"CPT Code",?23,"Amount",?33," Amount",?42,"Susp",?57,"Batch",?63,"Invoice",?71,"Voucher"
	W !,?23,"Claimed",?35,"Paid",?42,"Code",?58,"Num",?64,"Num",?72,"Date",!,FBDASH1
	Q
SHA2	;subheader for vendor name
	I ($Y+5)>IOSL D:FBCRT CR Q:FBOUT  D HDR,SH,SHA
	I FBOV'=FBV S FBOV=FBV
	W !!,"Vendor: ",$P(FBV,";"),?41,"Vendor ID: ",$P(FBV,";",2)
	Q
CR	;read for display
	Q:'FBPG  S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
PAGE	;new page
	I FBCRT D CR Q:FBOUT
	D HDR,SH
	Q
WRTDX	I $P(FBDX,"^",K)]"" W ?4,"Dx: ",$S($D(^ICD9($P(FBDX,"^",K),0)):$P(^(0),"^"),1:""),"  " Q
	Q
WRTPC	I $P(FBPROC,"^",L)]"" W ?4,"Proc: ",$S($D(^ICD0($P(FBPROC,"^",L),0)):$P(^(0),"^"),1:""),"   " Q
	Q
WRTSC	;write service connected
	W !,"SERVICE CONNECTED? ",$S(+VAEL(3):"YES",1:"NO"),!
	Q
TRAV	;write out travel payments, (FBPAT,FBSORT) must be defined
	S FBTRDT=0
	F  S FBTRDT=$O(^TMP($J,"FBTR",FBPAT,FBTRDT)) Q:'FBTRDT  S FBTRX=0 F  S FBTRX=$O(^TMP($J,"FBTR",FBPAT,FBTRDT,FBTRX)) Q:'FBTRX  S FBCKIN=^(FBTRX),A2=$P(FBCKIN,"^") D TRCK Q:FBOUT  W:$G(FBTRCK) !,?5,"TRAVEL PAYMENTS: " D  K FBTRCK
	.W ?22,$$DATX^FBAAUTL(FBTRDT),?35,A2
	.S A2=$$EXTRL^FBMRASVR(A2) D EFBCK^FBPAY21(FBCKIN),PMNT^FBAACCB2
	.K A2 W ! Q
	Q
TRCK	I ($Y+5)>IOSL D:FBCRT CR Q:FBOUT  D HDR^FBPAY21
	Q

FBPCR
FBPCR	;AISC/DMK,GRR,TET-POTENTIAL COST RECOVERY OUTPUT DRIVER ;9/1/92  16:57
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DOC	;Refer to fbdoc, tag fbpcr, for documentation of fbpcr* routines
PSF	;select one/many/all primary service failities
	W !! S DIC="^DIC(4,",VAUTSTR="Primary Service Facility",VAUTNI=2,VAUTVB="FBPSV" D FIRST^VAUTOMA K DIC I Y=-1 G EXIT
ARRAY	;set fee program array for all programs
	S FBPI=0 F  S FBPI=$O(^FBAA(161.8,FBPI)) Q:'FBPI  S FBPIN=$G(^(FBPI,0)) I $P(FBPIN,U,3) S FBPROG(FBPI)=$P(FBPIN,U)
	I '$D(FBPROG) G EXIT
DATE	;select date range
	D DATE^FBAAUTL I FBPOP G PSF
	S FBBDATE=BEGDATE,FBEDATE=ENDDATE
	S Z=9999999.9999,FBBEG=Z-FBEDATE,FBEND=Z-FBBDATE
Q	K ^TMP($J,"FB"),DIC
	S VAR="FBNAME^FBIEN^FBID^FBBEG^FBEND^FBBDATE^FBEDATE^FBPSV^FBPSV(^FBPROG(",VAL=VAR,PGM="DQ^FBPCR",IOP="Q" D ZIS^FBAAUTL G:FBPOP EXIT
DQ	S $P(FBDASH,"=",80)="",$P(FBDASH1,"-",80)="",FBPG=0,FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBOUT=0,FBBEG=FBBEG-.9 U IO
SORT	;sort driver for payment output(s)
	S FBPI=0 F  S FBPI=$O(FBPROG(FBPI)) Q:'FBPI  S FBXPROG=FBPROG(FBPI) D
	.I FBPI=2 D EN^FBPCR2 ;outpatient payments
	.I FBPI=3 D EN^FBPCR3 ;pharmacy payments
	.I FBPI=6!(FBPI=7) S:FBPI=6&($D(FBPROG(7))) FBPI=67 D EN^FBPCR67 S:FBPI=67 FBPI=7 ;civil hospital/cnh payments
PRINT	;print driver for payment output(s)
	S FBPI=$O(^TMP($J,"FB",0)) I FBPI']"" D WMSG G OUT
	S FBSTA=0
	S FBPSF=0 F  S FBPSF=$O(^TMP($J,"FB",FBPSF)) Q:'FBPSF!FBOUT  D STA S FBPT="" F  S FBPT=$O(^TMP($J,"FB",FBPSF,FBPT)) Q:FBPT']""!FBOUT  S DFN=$P(FBPT,";",2) D VET S FBPI=0 F  S FBPI=$O(FBPROG(FBPI)) Q:'FBPI  S FBXPROG=FBPROG(FBPI) D  Q:FBOUT
	.I FBPSF_FBPT'=FBSTA D HDR Q:FBOUT
	.I FBPI=2,$D(^TMP($J,"FB",FBPSF,FBPT,FBPI)) D PRINT^FBPCR2 Q
	.I FBPI=3 D:$D(^TMP($J,"FB",FBPSF,FBPT,FBPI)) PRINT^FBPCR3 Q
	.I FBPI=6!(FBPI=7) D:$D(^TMP($J,"FB",FBPSF,FBPT,FBPI)) PRINT^FBPCR671 Q
OUT	I FBOUT!$D(ZTQUEUED) G EXIT
	D EXIT G PSF
	Q
EXIT	;kill and quit
KILL	;kill all variables set in the FBPCR* routines, other than fbx
	D CLOSE^FBAAUTL K ^TMP($J,"FB")
	K A1,A2,A3,BEGDATE,C,D,D2,DFN,DIC,DIR,DTOUT,DUOUT,ENDDATE,FBPDXC
	K FBAAA,FBAACPTC,FBAC,FBAP,FBBATCH,FBBDATE,FBBEG,FBBN,FBCATC,FBCNT,FBCP,FBCRT,FBDA1,FBDASH,FBDASH1,FBDATA,FBDOB,FBDRUG,FBDT,FBDT1,FBDOS,FBDX,FBDX1,FBEDATE,FBEND,FBERR,FBFD,FBFD1,FBHEAD
	K FBI,FBID,FBIEN,FBIN,FBINS,FBINVN,FBIX,FBJ,FBLOC,FBM,FBNAME,FBOB,FBOPI,FBOUT,FBOV,FBP,FBPAT,FBPD,FBPDX,FBPG,FBPI,FBPID,FBPIN,FBPNAME,FBPROC,FBPROC1,FBPROG,FBPSF,FBPSFNAM,FBPSFNUM,FBPSV,FBPT,FBPV,FBQTY,FBREIM,FBRX
	K FBSC,FBSL,FBSTA,FBSTR,FBSUSP,FBTA,FBTYPE,FBV,FBVCHAIN,FBVEN,FBVENID,FBVNAME,FBVI,FBVID,FBVP,FBXPROG,FBY,FBZ,I,IOP,J,K,L,M,N,PGM,T,V,VA,VAERR,VAL,VAR,VAUTNI,VAUTSTR,VAUTVB,X,Y,Z
	Q
WMSG	;write message if no matches found
	D HDR W !!?3,"There are no potential cost recoveries on file"
	W !?5,"for specified date range:  ",$$DATX^FBAAUTL(FBBDATE)," through ",$$DATX^FBAAUTL(FBEDATE)
	I 'FBPSV D
	.W ",",!?5,"and selected Primary Service Area(s):"
	.S FBPSF=0 F  S FBPSF=$O(FBPSV(FBPSF)) Q:'FBPSF  W !?31,$G(FBPSV(FBPSF))
	E  W !?5,"and ALL Primary Service Areas "
	W ".",*7,!!
	Q
CATC(DFN,FBDT)	;ck if patient is catc
	;INPUT:  DFN = IEN of Patient file
	;        FBDT= Date
	;OUTPUT:  1 if catc or pending adjudication and agree to pay deduc
	;         else 0
	S FBCATC=$$BIL^DGMTUB(DFN,FBDT)
	;I 'FBCATC S FBMT=$$LST^DGMTU(DFN,FBDT) I FBMT]"",$P(FBMT,U,4)="R" S FBCATC=1
	Q $S(FBCATC:1,1:0)
VET	;set vet name/ssn/dob info
	;INPUT:  DFN  = IEN of Patient file
	;        FBPI = IEN of fee program (optional)
	;OUTPUT:  FBPNAME = Patient's name
	;         FBPID   = Patient's pid
	;         FBDOB   = Patient's dob (if pharmacy fee program)
	N N
	S N=$G(^DPT(DFN,0)),FBPNAME=$P(N,U),FBPID=$$SSN^FBAAUTL(DFN),FBDOB=$$DATX^FBAAUTL($P(N,U,3))
	Q
STA	;set station name & number
	;INPUT = FBPSF - IEN to institution file
	;OUTPUT = FBPSFNAM = station name
	;         FBPSFNUM = station number
	S FBPSFNAM=$P($G(^DIC(4,FBPSF,0)),U),FBPSFNUM=$P($G(^DIC(4,FBPSF,99)),U)
	S:FBPSFNAM=+FBPSFNAM FBPSFNAM="UNKNOWN"
	Q
PAGE	;form feed when new station/patient
	S FBSTA=$G(FBPSF)_$G(FBPT)
	I FBCRT&(FBPG'=0) D CR Q:FBOUT
	I FBPG>0!FBCRT W @IOF
	S FBPG=FBPG+1
	Q
CR	;read for display
	S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
HDR	;general header for potential recoveries
	D PAGE Q:FBOUT
	W !?(IOM-30/2),"POTENTIAL COST RECOVERY REPORT"
	W !?(IOM-(11+$L($G(FBPSFNAM))+$L($G(FBPSFNUM)))/2),"Division: ",$G(FBPSFNUM)," ",$G(FBPSFNAM)
	W !?(IOM-19/2),$$DATX^FBAAUTL(FBBDATE)," - ",$$DATX^FBAAUTL(FBEDATE)
	W !?71,"Page: ",FBPG
	W !,"Patient: ",$G(FBPNAME),?41,"Patient ID: ",$G(FBPID),?66,"DOB: ",$G(FBDOB)
	W !!?3,"('*' Represents Reimbursement to Patient",?50,"'#' Represents Voided Payment)"
	W !,FBDASH
	W ! D:$D(DFN) INS^DGRPDB
	Q

FBPCR2
FBPCR2	;ALBISC/DMK,GRR,TET - OUTPATIENT POTENTIAL COST RECOVERY SORT/PRINT ;2/4/93  09:56
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	;entry point
	S (FBCATC,FBINS,FBPSF)=0
SORT	;sort by date finalized, patient, vendor, treatment ien, service ien
	S I=FBBDATE-.1 F  S I=$O(^FBAAC("AK",I)) Q:'I!(I>FBEDATE)  S J=0 F  S J=$O(^FBAAC("AK",I,J)) Q:'J  D
	.S DFN=J D VET^FBPCR
	.S K=0  F  S K=$O(^FBAAC("AK",I,J,K)) Q:'K  S L=0 F  S L=$O(^FBAAC("AK",I,J,K,L)) Q:'L  D SETTR S M=0 F  S M=$O(^FBAAC("AK",I,J,K,L,M)) Q:'M  D  S (FBCATC,FBINS,FBPSF)=0
	..D SET Q:'FBPSV&('$D(FBPSV(FBPSF)))  I FBCATC!FBINS D SETTMP
KILL	;kill variables set in this routine
	K A1,A2,A3,D,D2,DFN,FBAACPTC,FBBN,FBCATC,FBCP,FBDOB,FBDOS,FBDT,FBDT1,FBIN,FBINS,FBOB,FBP,FBPAT,FBPCR,FBPDX,FBPDXC,FBPID,FBPNAME,FBPSF,FBSC,FBTA,FBTYPE,FBVEN,FBVID,FBVNAME,FBVP,I,J,K,L,M,T,Y,FBMOD
	Q
SET	;set variables - also entry point from FBPCR67
	N FBPCR
	S Y=$G(^FBAAC(J,1,K,1,L,1,M,0)) Q:'+$P(Y,U,9)!($G(^FBAAC(J,1,K,1,L,1,M,"FBREJ"))]"")
	S FBVNAME=$E($P($G(^FBAAV(K,0)),U),1,23),FBVID=$S(FBVNAME]"":$P(^(0),U,2),1:"")
	S FBP=+$P(Y,U,9),FBSC=$P(Y,U,27),FBPDX=+$P(Y,U,23),FBPSF=+$P(Y,U,12)
	S FBSC=$S(FBSC="Y":"YES",FBSC="N":"NO",1:"-")
	S T=$P(Y,U,5),D2=$P(Y,U,6),FBDOS=D2,D2=$$DATX^FBAAUTL(D2),FBCP=$P(Y,U,18),FBCP=$S(FBCP=1:"(C&P)",1:"")
	Q:FBCP]""!('FBPSV&('$D(FBPSV(FBPSF))))  S FBPCR=+$G(^FBAAC(J,1,K,1,L,0)),FBCATC=$$CATC^FBPCR(DFN,FBPCR),FBINS=$S(FBSC["N":1,1:0) Q:'FBCATC&'FBINS
	S FBAACPTC=$P($G(^ICPT(+Y,0)),U),FBOB=$P(Y,U,10)
	I T]"" S T=$P($G(^FBAA(161.27,+T,0)),U)
	S FBTYPE=$P(Y,U,20),FBVP=$P(Y,U,21),FBIN=$P(Y,U,16),FBBN=$P(Y,U,8),FBBN=$S(FBBN']"":"",$D(^FBAA(161.7,FBBN,0)):$P(^(0),U),1:""),FBBN=$S(FBBN="":"",1:$E("00000",$L(FBBN)+1,5)_FBBN)
	S FBVEN=FBVNAME_";"_FBVID,FBPAT=FBPNAME_";"_DFN
	S FBMOD=$P($G(^FBAAC(J,1,K,1,L,1,M,2)),U,7)
	;output format
	S A1=$J($P(Y,U,2),6,2),A2=$J($P(Y,U,3),6,2),A3=$J(A3,6,2),FBIN=$J(FBIN,7)
	S FBDT1=$S(FBVP="VP":"#",1:"")_$S(FBTYPE="R":"*",1:" ")_FBDT
	Q
SETTMP	;sort data by primary service facility, patient, fee program, vendor, date
	I $P(Y,U,9)'=FBPI Q
	S ^TMP($J,"FB",FBPSF,FBPAT,FBP,FBVEN,I,L_M)=FBDT1_U_FBAACPTC_FBCP_$S($G(FBMOD)]"":"-"_$$MOD^FBAAUTL4(FBMOD),1:"")_U_A1_U_A2_U_T_U_FBBN_U_FBIN_U_D2_U_FBSC_U_FBPDX_U_FBOB_U_FBPI_U_FBCATC_U_FBINS
	Q
SETTR	S D=$S($D(^FBAAC(J,1,K,1,L,0)):$P(^(0),"^",1),1:""),A3=".00"
	I D]"",$D(^FBAAC(J,3,"AB",D)) S FBTA=$O(^FBAAC(J,3,"AB",D,0)),A3=$S($P(^FBAAC(J,3,FBTA,0),"^",3)]"":$P(^(0),"^",3),1:.0001)
	S FBDT=$$DATX^FBAAUTL(D)
	Q
EN1	;entry point to set variables, called by fbpcr67, anc
	N FBVEN,FBPAT,FBDT1
	D SETTR,SET
	Q
PRINT	;write output
	D HDR1 S FBVI="" F  S FBVI=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI)) Q:FBVI']""!(FBOUT)  D SH Q:FBOUT  D  Q:FBOUT
	.S FBDT=0 F  S FBDT=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT)) Q:'FBDT  S M=0 F  S M=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,M)) Q:'M  D  Q:FBOUT
	..I ($Y+4)>IOSL D PAGE Q:FBOUT
	..S FBDATA=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,M),FBCATC=$P(FBDATA,U,13),FBINS=$P(FBDATA,U,14)
	..S FBLOC=1_U_12_U_23_U_33_U_47_U_57_U_63_U_71
	..W ! F I=1:1:8 W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
	..S FBPDX=$P(FBDATA,U,10),FBPDXC=$P($G(^ICD9(FBPDX,0)),U),$P(FBDATA,U,10)=$E($P($G(^ICD9(FBPDX,0)),U,3),1,19),FBPDXC=$S(FBPDXC="":"",1:" ("_FBPDXC_")")
	..W !?3,"Primary Dx: ",$P(FBDATA,U,10),FBPDXC,?45,"S/C Condition? ",$P(FBDATA,U,9) W ?66,"Obl.#: ",$P(FBDATA,U,11)
	..I FBCATC!FBINS W !?5,">>> Cost recover from "_$S(FBCATC:"means testing",FBINS:"insurance",1:"") W:FBCATC&FBINS " and insurance" W "."
	..S A3=".00"
	Q
HDR	;main header
	D HDR^FBPCR Q:FBOUT
HDR1	W !!?(IOM-(13+$L(FBXPROG))/2),"FEE PROGRAM: ",FBXPROG
	W !!,?2,"Svc Date",?11,"CPT-MOD",?23,"Amount",?33," Amount",?42,"Susp",?49,"Travel",?57,"Batch",?63,"Invoice",?71,"Voucher"
	W !,?23,"Claimed",?35,"Paid",?42,"Code",?50,"Paid",?58,"Num",?64,"Num",?72,"Date",!,FBDASH
	Q
SH	;subheader - vendor, prints when name changed
	I ($Y+6)>IOSL D HDR Q:FBOUT
	W !!,"Vendor: ",$P(FBVI,";"),?41,"Vendor ID: ",$P(FBVI,";",2)
	Q
CR	;read for display
	S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
PAGE	;new page
	D HDR Q:FBOUT  D SH
	Q

FBPCR3
FBPCR3	;AISC/GRR,TET-PHARMACY POTENTIAL COST RECOVERY, SORT/PRINT ;2/4/93  09:59
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	;entry point
	S (FBCATC,FBINS,FBPSF)=0
SORT	;sort by date certified for payment, patient, invoice number ien, rx ien
	S I=FBBDATE-.1 F  S I=$O(^FBAA(162.1,"AA",I)) Q:'I!(I>FBEDATE)  S J=0 F  S J=$O(^FBAA(162.1,"AA",I,J)) Q:'J  D
	.S DFN=J D VET^FBPCR
	.S K=0 F  S K=$O(^FBAA(162.1,"AA",I,J,K)) Q:K'>0  S L=0 F  S L=$O(^FBAA(162.1,"AA",I,J,K,L)) Q:L'>0  D  S (FBCATC,FBINS,FBPSF)=0
	..D SET Q:'FBPSV&('$D(FBPSV(FBPSF)))  I FBCATC!FBINS D SETTMP
KILL	;kill variables set in sort
	K A1,A2,DFN,FBAAA,FBAC,FBAP,FBBATCH,FBCATC,FBDA1,FBDRUG,FBFD,FBFD1,FBIN,FBINS,FBINVN,FBLOC,FBPAT,FBPD,FBPSF,FBPV,FBQTY,FBREIM,FBRX,FBSC,FBSTR,FBSUSP,FBVEN,FBVI,I,J,K,L,N,V,Y
	K FBVNAME,FBVID,FBVCHAIN,FBPNAME,FBPID,FBDOB
	D KILL^FBPCR2
	Q
SET	;set variables
	S Y(0)=$G(^FBAA(162.1,+K,"RX",+L,0)) I Y(0)']""!($P(Y(0),U,9)=1) Q
	I $G(^FBAA(162.1,+K,"RX",+L,"FBREJ"))]"" Q
	S Y(2)=$G(^FBAA(162.1,+K,0))
	S Y(1)=$G(^FBAA(162.1,+K,"RX",+L,2))
	S FBPSF=+$P(Y(1),U,5),FBFD=$P(Y(0),U,3),FBAAA=$P(Y(0),U,5)
	Q:'FBPSV&('$D(FBPSV(FBPSF)))  S FBCATC=$$CATC^FBPCR(DFN,FBFD)
	;,FBINS=$S($O(^FBAAA("AIC",FBAAA,+$O(^FBAAA("AIC",FBAAA,-FBFD)),0))="Y":1,1:0)
	S FBINS=$$INSCK(FBFD,FBAAA,FBPI)
	Q:'FBCATC&'FBINS
	S FBINVN=$P(Y(2),U) D VEN
	S FBRX=$P(Y(0),U,1),FBDRUG=$P(Y(0),U,2),FBAC=$P(Y(0),U,4),FBAP=$P(Y(0),U,16),FBSUSP=$P(Y(0),U,8),FBPD=$P(Y(0),U,19),FBBATCH=$P(Y(0),U,17),FBBATCH=$P($G(^FBAA(161.7,+FBBATCH,0)),U)
	I FBSUSP]"" S FBSUSP=$P($G(^FBAA(161.27,+FBSUSP,0)),U)
	S FBREIM=$S($P(Y(0),U,20)="R":"*",1:""),FBSTR=$P(Y(0),U,12),FBQTY=$P(Y(0),U,13),A1=$J(FBAC,6,2),A2=$J(FBAP,6,2),FBPV=""
	S FBPD=$$DATX^FBAAUTL(FBPD),FBFD=$$DATX^FBAAUTL(FBFD)
	S FBPV=$S($P(Y(1),U,3)="V":"#",1:""),FBFD1=$S(FBPV="":" ",1:FBPV)_$S(FBREIM="":" ",1:FBREIM)_FBFD,FBRX="Rx: "_FBRX
	S FBVEN=FBVNAME_";"_FBVID,FBPAT=FBPNAME_";"_DFN
	Q
SETTMP	;sort data by primary service facility, patient, fee program, vendor, date
	S ^TMP($J,"FB",FBPSF,FBPAT,FBPI,FBVEN,I,K_L)=FBFD1_U_FBRX_U_FBDRUG_U_FBSTR_U_FBQTY_U_A1_U_A2_U_FBSUSP_U_FBINVN_U_FBBATCH_U_FBPD_U_FBDOB_U_FBVCHAIN_U_FBPI_U_FBCATC_U_FBINS
	S ^TMP($J,"FB",FBPSF,FBPAT,FBPI,FBVEN)=FBVCHAIN,^TMP($J,"FB",FBPSF,FBPAT)=FBDOB
	;S FBIN(5)=$P(Y(1),U,6) I FBIN(5)]"",$D(^TMP($J,"FB",FBPSF,FBPAT,FBPI,FBVEN,I,L)) D ANC^FBPCR67
	Q
VEN	;set variables for vendor
	S V=$G(^FBAAV(+$P(Y(2),U,4),0)),FBVNAME=$E($P(V,U),1,23),FBVID=$P(V,U,2),FBVCHAIN=$P(V,U,10)
	Q
PRINT	;write output
	I FBPG>1&(($Y+10)>IOSL) D HDR Q:FBOUT
	E  D HDR1
	S FBVI="" F  S FBVI=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI)) Q:FBVI']""!(FBOUT)  D SH Q:FBOUT  D  Q:FBOUT
	.S FBDT=0 F  S FBDT=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT)) Q:'FBDT  S L=0 F  S L=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,L)) Q:'L  D  Q:FBOUT
	..I ($Y+6)>IOSL D PAGE Q:FBOUT
	..S FBDATA=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,L),FBCATC=$P(FBDATA,U,15),FBINS=$P(FBDATA,U,16)
	..S FBLOC="0^2^15^45^63^4^12^20^24^35^53"
	..W !,$P(FBDATA,U),! F I=2:1:$L(FBLOC,"^") W ?$P(FBLOC,U,I),$P(FBDATA,U,I) W:$P(FBLOC,U,I)=63 !
	..I FBCATC!FBINS W !?5,">>> Cost recover from "_$S(FBCATC:"means testing",FBINS:"insurance",1:"") W:FBCATC&FBINS " and insurance" W "."
	..W !
EXIT	;kill and quit
	Q
HDR	;main header
	D HDR^FBPCR Q:FBOUT
HDR1	W !!?(IOM-(13+$L(FBXPROG))/2),"FEE PROGRAM: ",FBXPROG
	W !!?4,"Fill Date",!,?15,"Drug Name",?44,"Strength",?60,"Quantity"
	W !?2,"Claimed",?12,"Paid",?19,"Code",?24,"Invoice #",?35,"Batch #",?50,"Date Certified",!,FBDASH
	Q
SH	;subheader - vendor, prints when name changes
	I ($Y+4)>IOSL D HDR Q:FBOUT
	W !!,"Vendor:",$P(FBVI,";"),?41,"Vendor ID: ",$P(FBVI,";",2),?65,"Chain #: ",$P($G(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI)),U)
	Q
CR	;read for display
	S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
PAGE	;new page
	D HDR Q:FBOUT  D SH
	Q
INSCK(FBDT,FBDA1,FBPI)	;possible cost recovery fcn call
	;Passed variables:  fbdt=fill date or treatment from date
	;                   fbda1=ien if fee patient file, patient ien
	;                    fbpi=fee program
	;Output variables:   fbins=1 if possible recovery, 0 if no
	S FBINS=0,FBDT=FBDT+.1,FBDT=+$O(^FBAAA("AIC",FBDA1,-FBDT))
	I FBDT S FBINS=$O(^FBAAA("AIC",FBDA1,FBDT,0)) I FBINS="Y" D
	.N FBDA S FBDA=+$O(^FBAAA("AIC",FBDA1,FBDT,FBINS,0))
	.I $P($G(^FBAAA(FBDA1,1,FBDA,0)),U,3)'=FBPI S FBINS=0
	Q $S(FBINS="Y":1,1:0)

FBPCR67
FBPCR67	;AISC/DMK,TET-CH/CNH POTENTIAL COST RECOVERY SORT;29AUG90 ;2/4/93  10:03
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	;entry point for sort
	S (FBCATC,FBINS,FBPSF)=0
SORT	;sort by date finalized, ien
	S FBM=FBBDATE-.1 F  S FBM=$O(^FBAAI("AD",FBM)) Q:'FBM!(FBM>FBEDATE)  S FBI=0 F  S FBI=$O(^FBAAI("AD",FBM,FBI)) Q:FBI'>0  S FBIN=$G(^FBAAI(FBI,0)) I FBIN]""&($G(^FBAAI(FBI,"FBREJ"))']"") D  S (FBCATC,FBINS,FBPSF)=0
	.S (DFN,J)=+$P(FBIN,U,4) D VET^FBPCR
	.D SET Q:FBPI'[+$P(FBIN,U,12)!('FBPSV&('$D(FBPSV(FBPSF))))  I FBCATC!FBINS D SETTMP
KILL	;kill variables set in this routine and in FPAY2, sort/set sections
	K A1,A2,A3,D,D2,DFN,FBAACPTC,FBBN,FBCATC,FBCNT,FBCP,FBDOB,FBDT,FBDT1,FBDX,FBDX1,FBI,FBIN,FBINS,FBIX,FBJ,FBM,FBOB,FBPAT,FBPDX,FBPROC,FBPROC1,FBPSF,FBSC,FBTA,FBVEN,FBVENID,FBVP,I,J,K,L,M,Y
	K FBVNAME,FBVID,FBPNAME,FBPID
	D KILL^FBPCR2
	Q
SET	;set variables
	;I $G(FBPROG)]"",'FBPROG,'$D(FBPROG(+$P(FBIN,U,12))) Q
	F FBJ=1,2,3,4,6,7,8,9,11,13,14 S FBIN(FBJ)=$P(FBIN,"^",FBJ)
	Q:FBPI'[+$P(FBIN,U,12)  S FBPSF=+$P(FBIN,U,20)
	Q:'FBPSV&('$D(FBPSV(FBPSF)))  S FBCATC=$$CATC^FBPCR(DFN,(9999999.9999-FBM))
	;,FBINS=$S($O(^FBAAA("AIC",FBIN(4),+$O(^FBAAA("AIC",FBIN(4),-FBIN(6))),0))="Y":1,1:0)
	S FBINS=$$INSCK^FBPCR3(FBIN(6),FBIN(4),+$P(FBIN,U,12))
	Q:'FBCATC&'FBINS
	S FBIN(5)=$P(FBIN,U,5)
	S FBIEN=FBIN(3),FBVNAME=$G(^FBAAV(FBIN(3),0)) Q:FBVNAME']""  S FBVID=$P(FBVNAME,U,2),FBVNAME=$E($P(FBVNAME,U),1,23)
	S FBIN(2)=$$DATX^FBAAUTL(FBIN(2)),FBVEN=FBVNAME_";"_FBVID,FBPAT=FBPNAME_";"_DFN
	S FBIN(6)=$$DATX^FBAAUTL(FBIN(6)),FBIN(7)=$$DATX^FBAAUTL(FBIN(7))
	Q
SETTMP	;sort data by primary service facility, patient, fee program, vendor, date
	S ^TMP($J,"FB",FBPSF,FBPAT,+$P(FBIN,U,12),FBVEN,FBM,FBI)=FBIN(2)_U_$J(FBIN(8),8,2)_U_$J(FBIN(9),8,2)_U_FBIN(11)_U_$J(FBIN(1),8)_U_FBIN(6)_U_FBIN(7)_U_$P(FBIN,U,12)_U_FBCATC_U_FBINS_U_FBIN(13)_U_FBIN(14)
	S FBDX=$G(^FBAAI(FBI,"DX")) I FBDX]"" S FBDX1="" F I=1:1:5 S:$P(FBDX,U,I) FBDX1=FBDX1_$P($G(^ICD9($P(FBDX,U,I),0)),U)_U
	I FBDX]"" S FBDX1=$P(FBDX1,U,1,($L(FBDX1,U)-1)),^TMP($J,"FB",FBPSF,FBPAT,+$P(FBIN,U,12),FBVEN,FBM,FBI,"DX")=FBDX1
	S FBPROC=$G(^FBAAI(FBI,"PROC")) I FBPROC]"" S FBPROC1="" F I=1:1:5 S:$P(FBPROC,U,I) FBPROC1=FBPROC1_$P($G(^ICD0($P(FBPROC,U,I),0)),U)_U
	I FBPROC]"" S FBPROC1=$P(FBPROC1,U,1,($L(FBPROC1,U)-1)),^TMP($J,"FB",FBPSF,FBPAT,+$P(FBIN,U,12),FBVEN,FBM,FBI,"PROC")=FBPROC1
	D ANC:$D(^TMP($J,"FB",FBPSF,FBPAT,FBPI,FBVEN,FBM,FBI))
	Q
ANC	;ancillary payments
	N J,K,L,M,Y,FBDT1,FBVID I FBPI=67 N FBPI S FBPI=+$P(FBIN,U,12)
	S J=DFN,FBCNT=0 I J,+FBIN(5),$D(^FBAAC("AM",FBIN(5),J)) D
	.F K=0:0 S K=$O(^FBAAC("AM",FBIN(5),J,K)) Q:'K  S L=0 F  S L=$O(^FBAAC("AM",FBIN(5),J,K,L)) Q:'L  D
	..S FBDT1=$P($G(^FBAAC(J,1,K,1,L,0)),U) I FBDT1]"" S FBDT1=$$DATX^FBAAUTL(FBDT1)
	..S M=0 F  S M=$O(^FBAAC("AM",FBIN(5),J,K,L,M)) Q:'M  S Y=$G(^FBAAC(J,1,K,1,L,1,M,0)) I Y]"" D
	...D EN1^FBPCR2 Q:'$D(FBAACPTC)  S FBCNT=FBCNT+1
	...S ^TMP($J,"FB",FBPSF,FBPAT,FBPI,FBVEN,FBM,FBI,"A",FBCNT)=FBDT1_U_FBAACPTC_FBCP_U_A1_U_A2_U_FBBN_U_FBIN_U_D2_U_FBSC_U_FBPDX_U_FBOB_U_FBVNAME_U_FBVID_U_FBPI_U_FBCATC_U_FBINS
	Q

FBPCR671
FBPCR671	;AISC/DMK,TET-CH/CNH POTENTIAL COST RECOVERY PRINT;29AUG90
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PRINT	;print data from tmp global
	I FBPG>1&(($Y+12)>IOSL) D HDR Q:FBOUT
	E  D HDR1
	S FBVI="" F  S FBVI=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI)) Q:FBVI']""!(FBOUT)  D SH Q:FBOUT  D  Q:FBOUT
	.S FBDT=0 F  S FBDT=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT)) Q:'FBDT  S FBI=0 F  S FBI=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBI)) Q:'FBI  D  Q:FBOUT
	..I ($Y+5)>IOSL D PAGE Q:FBOUT
	..S FBDATA=^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBI),FBCATC=$P(FBDATA,U,9),FBINS=$P(FBDATA,U,10)
	..S FBLOC=2_U_23_U_33_U_42_U_49_U_61_U_71
	..W ! W:$P(FBDATA,U,11)["R" "*" W:$P(FBDATA,U,12)]"" "#"
	..F I=1:1:7 W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
	..F FBY="DX","PROC" I $D(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBI,FBY)) S FBDATA=^(FBY),FBSL=$L(FBDATA,"^") W !?2,FBY,": " F I=1:1:FBSL W $P(FBDATA,U,I),"    "
	..I FBCATC!FBINS W !?5,">>> Cost recover from "_$S(FBCATC:"means testing",FBINS:"insurance",1:"") W:FBCATC&FBINS " and insurance" W "."
	..I +$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBI,"A",0)) D  Q:FBOUT  W !,FBDASH1
	...S (FBOV,FBCNT)=0,FBSL=7,FBLOC=1_U_12_U_23_U_33_U_47_U_63_U_71 D SHA Q:FBOUT
	...F  S FBCNT=$O(^TMP($J,"FB",FBPSF,FBPT,FBPI,FBVI,FBDT,FBI,"A",FBCNT)) Q:'FBCNT  S FBDATA=^(FBCNT),FBV=$P(FBDATA,U,11)_";"_$P(FBDATA,U,12) D WRT Q:FBOUT
	Q
WRT	;write ancillary info
	N FBCATC,FBINS I ($Y+4)>IOSL D PAGE Q:FBOUT  D SHA,SHA2
	D:FBOV'=FBV SHA2
	S FBCATC=$P(FBDATA,U,14),FBINS=$P(FBDATA,U,15)
	W ! F I=1:1:FBSL W ?$P(FBLOC,U,I),$P(FBDATA,U,I)
	W !?5,"Primary Dx: ",$P(FBDATA,U,9),?40,"S/C Condition? ",$P(FBDATA,U,8),?66,"Obl.#: ",$P(FBDATA,U,10)
	I FBCATC!FBINS W !?5,">>> Cost recover from "_$S(FBCATC:"means testing",FBINS:"insurance",1:"") W:FBCATC&FBINS " and insurance" W "."
	Q
HDR	;main header
	D HDR^FBPCR Q:FBOUT
HDR1	W !!?(IOM-(13+$L(FBXPROG))/2),"FEE PROGRAM: ",FBXPROG
	W !!?2,"Inv Date",?23,"Amount",?33," Amount",?42,"Susp",?49,"Invoice",?61,"From",?73,"To"
	W !?23,"Claimed",?35,"Paid",?42,"Code",?53,"Num",?61,"Date",?71,"Date",!,FBDASH
	Q
SH	;subheader - vendor, prints when name changed
	I ($Y+7)>IOSL D HDR Q:FBOUT
	W !!,"Vendor: ",$P(FBVI,";"),?41,"Vendor ID: ",$P(FBVI,";",2)
	Q
SHA	;ancillary subheader
	I ($Y+16)>IOSL D PAGE Q:FBOUT
	W !?20,">>> ANCILLARY SERVICE PAYMENTS <<<",!
SHA1	;subheader for ancillary data
	W !,?2,"Svc Date",?11,"CPT Code",?23,"Amount",?33," Amount",?42,"Susp",?57,"Batch",?63,"Invoice",?71,"Voucher"
	W !,?23,"Claimed",?35,"Paid",?42,"Code",?58,"Num",?64,"Num",?72,"Date",!,FBDASH1
	Q
SHA2	;subheader for vendor name
	I ($Y+9)>IOSL D HDR Q:FBOUT  D SH,SHA
	I FBOV'=FBV S FBOV=FBV
	W !!,"Vendor: ",$P(FBV,";"),?41,"Vendor ID: ",$P(FBV,";",2)
	Q
CR	;read for display
	Q:'FBPG  S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
PAGE	;new page
	D HDR Q:FBOUT  D SH
	Q
WRTDX	I $P(FBDX,"^",K)]"" W ?4,"Dx: ",$S($D(^ICD9($P(FBDX,"^",K),0)):$P(^(0),"^"),1:""),"  " Q
	Q
WRTPC	I $P(FBPROC,"^",L)]"" W ?4,"Proc: ",$S($D(^ICD0($P(FBPROC,"^",L),0)):$P(^(0),"^"),1:""),"   " Q
	Q
WRTSC	;write service connected
	W !,"SERVICE CONNECTED? ",$S(+VAEL(3):"YES",1:"NO"),!
	Q

FBPHON
FBPHON	;AISC/CMR-LIST PAYMENTS - AUG 05, 1994
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	S DIR(0)="P^161.2:EMZ" D ^DIR K DIR Q:$D(DIRUT)  S FBV=+Y
	S DIR(0)="P^161:EMZ",DIR("A")="Payments for veteran" D ^DIR K DIR I $D(DIRUT) G FBPHON
	S DFN=+Y
	Q
START	S U="^"
	K ^TMP($J,"FBPHON"),^TMP("FBPHON",$J),^TMP("FBPHIDX",$J)
	I '$G(DFN)!('$G(FBV)) S VALMQUIT="" Q
	D GATHER^FBPHON1(DFN,FBV)
	I '$D(^TMP($J,"FBPHON")),'$G(FBCP) W !!,*7,"There are no payments to this vendor for this patient." S DIR(0)="E" D ^DIR S VALMQUIT=1 G END ;FBCP set only if changing pt
OUTPUT	;
	S (FBLINE,FBENTRY)=0,FBAADT="" F  S FBAADT=$O(^TMP($J,"FBPHON",FBAADT)) Q:'FBAADT  S FBI=0 F  S FBI=$O(^TMP($J,"FBPHON",FBAADT,FBI)) Q:'FBI  S FBX=^(FBI) D
	.S FBBDT=$P($P(FBX,U,2),"-"),FBEDT=$P($P(FBX,U,2),"-",2)
	.S FB1=$P(FBX,U,9) D FBCKI^FBAACCB1(FB1):$P(FBX,U)["C",FBCKP^FBAACCB1(+FB1,$P(FB1,",",2)):$P(FBX,U)="PHAR",FBCKO^FBAACCB2(+FB1,$P(FB1,",",2),$P(FB1,",",3),$P(FB1,",",4)):$P(FBX,U)="OPT"
	.S FBLINE=FBLINE+1,FBENTRY=FBENTRY+1,FBFL=$P(FBX,U,10),FBFL=FBFL_$S($G(FBCAN)]"":"+",1:"")
	.S FBTEXT=$S($L(FBENTRY)=1:" "_FBENTRY,1:FBENTRY)_FBFL,FBTEXT=$$SETSTR^VALM1($$DATE(FBBDT)_$S($G(FBEDT):" - "_$$DATE(FBEDT),1:""),FBTEXT,6,19)
	.S FBTEXT=$$SETSTR^VALM1($S($P(FBX,U)="OPT":"CPT: ",$P(FBX,U)="PHAR":"RX # ",1:""),FBTEXT,25,5),FBTEXT=$$SETSTR^VALM1($P(FBX,U,3),FBTEXT,30,8)
	.S FBTEXT=$$SETSTR^VALM1($J($FN($P(FBX,U,4),",",2),10),FBTEXT,40,10),FBTEXT=$$SETSTR^VALM1($J($FN($P(FBX,U,5),",",2),10),FBTEXT,51,10),FBTEXT=$$SETSTR^VALM1($G(^FBAA(161.27,+$P(FBX,U,6),0)),FBTEXT,62,1)
	.S FBTEXT=$$SETSTR^VALM1($J($P(FBX,U,7),7)_"  "_$S($G(^FBAA(161.7,+$P(FBX,U,8),0)):$J(+^(0),5),1:""),FBTEXT,66,15)
	.S ^TMP("FBPHON",$J,FBLINE,0)=FBTEXT K FBTEXT
	.D IDX S ^TMP("FBPHIDX",$J,FBENTRY)=FBX_"^"_$G(FBCK)
	.S A2=$P(FBX,U,5) D PMNT
	.K FBBDT,FBEDT,FB1,FBX,A2,^TMP($J,"FBPHON",FBAADT,FBI)
	S VALMCNT=FBLINE,VALMBG=1
END	;
	K FBAAOUT,FBX,FBBDT,FBEDT,FBI,FBAADT,FBFL,FBLINE,FBENTRY,^TMP($J,"FBPHON")
	Q
HDR	S VALMHDR(1)="VENDOR: "_$$VNAME^FBNHEXP(FBV),VALMHDR(1)=$$SETSTR^VALM1("Patient Name: "_$$NAME^FBCHREQ2(DFN),VALMHDR(1),40,40)
	S VALMHDR(2)="    ID: "_$$VID^FBNHEXP(FBV),VALMHDR(2)=$$SETSTR^VALM1("SSN: "_$$SSN^FBAAUTL(DFN),VALMHDR(2),49,31)
	S VALMHDR(3)="   '*' Reimb. to Patient    '+' Cancel. Activity    '#' Voided Payment"
	Q
DATE(J)	;external date format
	Q $S('$D(J):"",1:$E(J,4,5)_"/"_$E(J,6,7)_"/"_$E(J,2,3))
	;
PMNT	;sets ^TMP with payment information if it exists
	I $G(FBCK)]"" S FBLINE=FBLINE+1,^TMP("FBPHON",$J,FBLINE,0)="      >>>Check # "_FBCK I $G(FBCKDT) S ^(0)=^(0)_"  Date Paid:  "_$$DATX^FBAAUTL(FBCKDT)_$S(FBCKINT>0:"  Interest: "_$FN(FBCKINT,",",2),1:"")_"<<<" D IDX D
	.I FBDIS-FBCKINT'=+A2 S FBLINE=FBLINE+1,^TMP("FBPHON",$J,FBLINE,0)="      >>>Amount paid altered to $ "_$FN((FBDIS-FBCKINT),",",2)_" on the Fee Payment Voucher document.<<<" D IDX
	I $G(FBCANDT)>0 S FBLINE=FBLINE+1,^TMP("FBPHON",$J,FBLINE,0)="      >>>Check cancelled on: "_$$DATX^FBAAUTL(FBCANDT)_"   Reason:  "_$P($G(^FB(162.95,+FBCANR,0)),"^")_"<<<" D IDX D
	.S FBLINE=FBLINE+1,^TMP("FBPHON",$J,FBLINE,0)=$$SETSTR^VALM1($S(FBCAN="R":"Check WILL be replaced.",FBCAN="C":"Check WILL be re-issued.",FBCAN="X":"Check WILL NOT be replaced.",1:""),"",10,70) D IDX
	K FBCAN,FBCK,FBCKDT,FBCANDT,FBCANR,FBCKINT,FBDIS,FBCKIN
	Q
IDX	;sets IDX node
	S ^TMP("FBPHON",$J,"IDX",FBLINE,FBENTRY)=""
	Q
EXIT	;
	K ^TMP("FBPHON",$J),^TMP("FBPHIDX",$J),VALMY,^TMP("VALMIDX",$J)
	Q
HLP	;help text
	S X="?" D DISP^XQORM1 W !!
	Q

FBPHON1
FBPHON1	;AISC/CMR - LIST PAYMENTS CONT. - AUG 05, 1994
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
GATHER(DFN,FBV)	;gather vendor/veteran specific payment info
	;required input DFN = veteran ien
	;               FBV = vendor ien
	;output ^TMP($J,"FBPHON", containing pmnts for all programs
	N FBCNT,FBI,FBJ,FBK,FBSDI,FBAADT,FBAACPI,FBX,FBMOD
	Q:'$G(DFN)!('$G(FBV))
	S FBCNT=0
OPT	;gather opt payments
	S FBSDI=0 F  S FBSDI=$O(^FBAAC(DFN,1,FBV,1,FBSDI)) Q:'FBSDI  S FBAADT=+^(FBSDI,0),FBAACPI=0 F  S FBAACPI=$O(^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI)) Q:'FBAACPI  D
	.S FBMOD=$$CPTMOD^FBAAUTL4(DFN,FBV,FBSDI,FBAACPI,1),FBMOD=$$MOD^FBAAUTL4(FBMOD),FBX=^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI,0),FBFL=$S($P(FBX,U,20)="R":"*",1:""),FBFL=FBFL_$S($P(FBX,U,21)="VP":"#",1:""),FBCNT=FBCNT+1
	.S ^TMP($J,"FBPHON",-FBAADT,FBCNT)="OPT"_"^"_FBAADT_"^"_$$CPT^FBAAUTL4(+FBX)_$S($G(FBMOD):"-"_FBMOD,1:"")_"^"_$P(FBX,U,2)_"^"_$P(FBX,U,3)_"^"_$P(FBX,U,5)_"^"_$P(FBX,U,16)_"^"_$P(FBX,U,8)_"^"_DFN_","_FBV_","_FBSDI_","_FBAACPI_"^"_FBFL
	.K FBX,FBFL
	K FBSDI,FBAACPI,FBAADT
INP	;gather inpt payments
	S FBI=0 F  S FBI=$O(^FBAAI("AK",DFN,FBV,FBI)) Q:'FBI  I $D(^FBAAI(FBI,0)) S FBX=^FBAAI(FBI,0),FBCNT=FBCNT+1,FBFL=$S($P(FBX,U,13)="R":"*",1:""),FBFL=FBFL_$S($P(FBX,U,14)="VP":"#",1:"") D
	.S ^TMP($J,"FBPHON",-$P(FBX,U,6),FBCNT)=$S($P(FBX,U,12)=6:"CH",$P(FBX,U,12)=7:"CNH",1:"")_"^"_$P(FBX,U,6)_"-"_$P(FBX,U,7)_"^^"_$P(FBX,U,8)_"^"_$P(FBX,U,9)_"^"_$P(FBX,U,11)_"^"_+FBX_"^"_$P(FBX,U,17)_"^"_FBI_"^"_FBFL
	.K FBX,FBFL
	K FBI
PHARM	;gather pharm payments
	S FBAADT=0 F  S FBAADT=$O(^FBAA(162.1,"AD",DFN,FBAADT)) Q:'FBAADT  S FBI=0 F  S FBI=$O(^FBAA(162.1,"AD",DFN,FBAADT,FBI)) Q:'FBI  I $D(^FBAA(162.1,"AN",FBV,FBI)) D
	.S FBJ=0 F  S FBJ=$O(^FBAA(162.1,"AD",DFN,FBAADT,FBI,FBJ)) Q:'FBJ  I $D(^FBAA(162.1,FBI,"RX",FBJ,0)) S FBX=^(0),FBFL=$S($P(FBX,U,20)="R":"*",1:""),FBFL=FBFL_$S($P($G(^FBAA(162.1,FBI,"RX",FBJ,2)),U,3)="VP":"#",1:"") D
	..S FBCNT=FBCNT+1
	..S ^TMP($J,"FBPHON",-(9999999-FBAADT),FBCNT)="PHAR^"_(9999999-FBAADT)_"^"_$P(FBX,U)_"^"_$P(FBX,U,4)_"^"_$P(FBX,U,16)_"^"_$P(FBX,U,8)_"^"_+$G(^FBAA(162.1,FBI,0))_"^"_$P(FBX,U,17)_"^"_FBI_","_FBJ_"^"_FBFL
	.K FBX,FBFL
	K FBAADT,FBI,FBJ
	Q

FBPHON2
FBPHON2	;AISC/CMR - LIST PAYMENTS CONT. - 8/3/94
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	D FULL^VALM1
EN	N FBI,FBX,FBAAOUT,Q S Q="-",$P(Q,"-",80)="-",FBAAOUT=0,VALMBCK="R"
	D SEL^VALM2 G END:'$O(VALMY(0))
	S FBI=0 F  S FBI=$O(VALMY(FBI)) Q:'FBI  I $D(^TMP("FBPHIDX",$J,FBI)) S FBX=^(FBI) D @FBPR I '$G(FBAAOUT) S DIR(0)="E",DIR("A")="Press 'ENTER' to "_$S($O(VALMY(FBI)):"view next selection",1:"return to list") D ^DIR K DIR Q:'Y
	Q
END	S VALMBCK="R" Q
BT	;display batch for chosen line item
	W @IOF N B
	S B=$P(FBX,U,8) I B']"" D ERR Q
	I $D(^FBAA(161.7,B,0)) S FBTYPE=$P(^FBAA(161.7,B,0),U,3)
	D ENM^FBAACCB:FBTYPE="B3",ENP^FBAACCB:FBTYPE="B5",ENT^FBAACCB0:FBTYPE="B2",PRTC^FBAACCB1:FBTYPE="B9"
	Q
INV	;display invoice for chosen line item
	W @IOF N FBAAIN,FBAAOUT,FBINTOT,J,DA,FBI
	I $P(FBX,U,7)']"" D ERR Q
	I $P(FBX,U)="PHAR" S DA=$P(FBX,U,7) D START^FBAAPII Q
	I $P(FBX,U)="CH"!($P(FBX,U)="CNH") S FBI=$P(FBX,U,7) D START^FBCHDI2 Q
	I $P(FBX,U)="OPT" D  D Q^FBAAPIN
	.S FBAAIN=$P(FBX,U,7),(FBAAOUT,FBINTOT,J)=0 F  S J=$O(^FBAAC("C",FBAAIN,J)) Q:'J!(FBAAOUT)  D MMORE^FBAAPIN
	D Q^FBAAPIN
	Q
BS	;display batch status for chosen line item
	W @IOF N DA
	I $P(FBX,U,8)']"" D ERR Q
	S DA=$P(FBX,U,8) D START^FBAABS
	Q
DV	;display vendor demographics for chosen vendor
	N DA S VALMBCK="R"
	S DA=FBV D CLEAR^VALM1,EN1^FBAAVD
	I $D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ)) S DIR(0)="Y",DIR("A")="Want to Edit data",DIR("B")="NO" D ^DIR K DIR Q:$D(DIRUT)  D:Y EDITV^FBAAVD
	I '$D(^XUSEC("FBAA ESTABLISH VENDOR",DUZ)) S DIR(0)="E" D ^DIR K DIR
	D Q^FBAAVD Q
DA	;display patient auth for selected line item
	W @IOF N FB1,FBDA,FBTYP
	S FBDA=$P(FBX,U,9)
	I $P(FBX,U)="OPT" S FB1=$P(^FBAAC(DFN,1,FBV,1,$P(FBDA,",",3),1,$P(FBDA,",",4),0),U,13) D  Q
	.I FB1']"" S FBPROG=$P(^FBAAC(DFN,1,FBV,1,$P(FBDA,",",3),0),U,4),FBPROG=$S(FBPROG:"I FBI="_FBPROG,1:""),PI="" D ^FBAADEM K FBPROG,FBAUT,PI Q
	.I FB1["583" D UNAUTH Q
	.I FB1["7078" D INP Q
	I $P(FBX,U)="PHAR" S FB1=$P(^FBAA(162.1,+FBDA,"RX",$P(FBDA,",",2),2),U,6) D  Q
	.I FB1']"" S FBPROG=$P($G(^FBAA(162.1,+FBDA,"RX",$P(FBDA,",",2),2)),U,7),FBPROG=$S(FBPROG:"I FBI="_FBPROG,1:""),PI="" D ^FBAADEM K FBPROG,FBAUT,PI Q
	.I FB1["583" D UNAUTH Q
	.I FB1["7078" D INP Q
	I $P(FBX,U)["C" S FB1=$P(^FBAAI(+FBDA,0),U,5) I FB1["583" D UNAUTH Q
INP	N DA,FBDA,DIC,DR S (FBDA,DA)=+FB1,DIC="^FB7078(",DR="0;1" W @IOF D EN^DIQ
	I $$DISCH^FBCH780(FBDA)]"" W ?2,"DISCHARGE TYPE: ",$$DISCH^FBCH780(FBDA)
	Q
UNAUTH	N DA,DIC,DR S DA=+FB1,DIC="^FB583(",DR="0;1" W @IOF D EN^DIQ
	Q
EV	;expand view
	W @IOF N FBZ S FBZ=$P(FBX,U,9)
	I $P(FBX,U)="OPT" S DIC="^FBAAC("_DFN_",1,"_FBV_",1,"_$P(FBZ,",",3)_",1,",DA(3)=DFN,DA(2)=FBV,DA(1)=$P(FBZ,",",3),DA=$P(FBZ,",",4),DR=""
	I $P(FBX,U)="PHAR" S DIC="^FBAA(162.1,"_+FBZ_",""RX"",",DA(1)=+FBZ,DA=$P(FBZ,",",2),DR=""
	I $P(FBX,U)["C" S DIC="^FBAAI(",DA=FBZ,DR=""
	W @IOF D EN^DIQ
	K DIC,DA,DR
	Q
CP	;change patient
	D CLEAR^VALM1
	N FBCP S VALMBCK="R"
	S DIR(0)="P^161:EMZ",DIR("A")="Payments for veteran" D ^DIR K DIR I $D(DIRUT) Q
	S DFN=+Y,FBCP=1 D HDR^FBPHON,START^FBPHON
	Q
CV	;change vendor
	D CLEAR^VALM1
	N FBCP S VALMBCK="R"
	S DIR(0)="P^161.2:EMZ" D ^DIR K DIR Q:$D(DIRUT)
	S FBV=+Y,FBCP=1 D HDR^FBPHON,START^FBPHON
	Q
DC	;display check
	W @IOF S FBCN=$P(FBX,U,11) I FBCN']"" W !,*7,"No check found for this line item." Q
	D START^FBCKDIS
	Q
CD	;display CPT/MOD description
	N FBCPT
	Q:$P(FBX,U)'="OPT"!($P(FBX,U,3)']"")
	S FBCPT=$P(FBX,U,3) W !,"Line item #",FBI,!?5,"CPT: ",$P(FBCPT,"-"),?18,$P(^ICPT($O(^ICPT("B",$P(FBCPT,"-"),0)),0),U,2)
	I FBCPT["-" W !?5,"MOD: ",$P(FBCPT,"-",2),?18,$P(^DIC(81.3,$O(^DIC(81.3,"B",$P(FBCPT,"-",2),0)),0),U,2)
	S VALMBCK="" Q
ERR	;
	W !,"No ",$S(FBPR["B":"batch",1:"invoice")," number on file for this entry" Q

FBPRE35
FBPRE35	;AISC/DMK-PRE-INIT FOR FEE BASIS ;5/24/94  09:25
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;CHECK DUZ and DUZ(0)
	I $S('($D(DUZ)#2):1,'($D(DUZ(0))#2):1,'DUZ:1,1:0) W *7,!!,"***  DUZ and DUZ(0) must be defined as a valid user to initialize.  ***",!! K DIFQ Q
	I DUZ(0)'="@" W *7,!!,"You must have programmer access (DUZ(0)='@') before running FBINIT.",!! K DIFQ Q
	;
	;check for routine XPDUTL (part of kernel tool kit 7.2
	S X="XPDUTL" X ^%ZOSF("TEST") I '$T D  K DIFQ Q
	.W *7,!,"Routine XPDUTL, part of Kernel Tool Kit 7.2 was not found on",!,"your system.  This must be installed prior to installing this",!,"version of Fee Basis.",!
	;
	;check version of Fee Basis. If Fee is installed, must be version 3.0.
	S X=+$$VERSION^XPDUTL("FB") I X,X<3 D  Q
	.W *7,!,"You must have Fee Basis Version 3.0 installed prior to installing version 3.5",! K DIFQ
	I $D(^FBAA(161.81,6)) S X=$O(^FBAA(161.81,"B","CONTRACT HOSPITAL",0)) I X D
	.N DA,DIE,DIC,DR
	.S DA=X,DIE="^FBAA(161.81,",DR=".01///"_"NON-VA HOSPITAL" D ^DIE
	;
VER	;determine appropriate version number
	N FBI,FBV,FBVNEW,FBX,FBY
	S FBI=1 F  S FBV=$P($T(V+FBI),";;",2) Q:FBV="END"  S FBI=FBI+1,FBVNEW=$P(FBV,";",2),FBX=$P(FBV,";") D  Q:'$D(DIFQ)
	.S X=+$$VERSION^XPDUTL(FBX) D:X'>0 MESS1 K:X'>0 DIFQ I X>0,X<FBVNEW D MESS2 K DIFQ
	;
CLEANUP	;driver to cleanup package file entries.
	N I,X
	F I=1:1 S X=$P($T(OLDPKG+I),";;",2) Q:'$L(X)  D DELPKG(X)
	;
	;driver to queue data for transmission before install
	I $G(DIFQ),+$G(^DD(161,0,"VR"))=3,+$O(^FBAA(161.25,0)) D
	.D RTRAN^FBAAV0
	;
	Q
	;
MESS1	W !!,"Check your package file for the ",FBX," entry.  Unable to determine version."
	Q
	;
MESS2	W !!,"Your version of the ",FBX," must be at least ",FBVNEW," to install this version of FEE.",*7
	Q
	;
V	;;package namespace;version number
	;;DGYA;5.0
	;;DG;5.3
	;;XU;7.1
	;;XT;7.2
	;;IB;2.0
	;;END
	;
DELPKG(X)	;pass in x equal to the namespace you want deleted from
	;the package file (9.4). Called to clean-up prior version init
	;patches, namespace changes, etc.
	Q:'$L(X)
	N DIC,DIK,D,DA,Y
	S DIC="^DIC(9.4,",DIC(0)="",D="C" D IX^DIC Q:'+Y
	S DA=+Y,DIK=DIC
	D ^DIK
	Q
OLDPKG	;entries to be deleted from the package file.
	;;FBBA

FBPRICE
FBPRICE	;AISC/DMK-GENERIC PRICER INTERFACE ;25JUN92
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;build a transaction to send to the Austin Pricer system
	;this data will NOT be stored anywhere. It serves only
	;as a tool to determine reimbursement rates.
	S PAD="                              "
	S FB("ERROR")="" D STATION^FBAAUTL G END:FB("ERROR") K FB("ERROR")
	S FBSTAN=FBAASN_$E(PAD,$L(FBAASN)+1,6)
PAT	;ask patient name [this is not a look-up on file 2]
	W ! S DIR("A")="Want to select patient from DHCP Patient File",DIR(0)="Y",DIR("B")="Yes" D ^DIR K DIR Q:$D(DIRUT)  I Y D  G END:'$D(FBSSN),VEND
	.W ! S DIC="^DPT(",DIC(0)="AEQMZ" D ^DIC K DIC Q:X="^"!(X="")!(Y<0)
	.D PAT^FBAAUTL2 S FBLNAM=$E(FBFLNAM,1,12),FBSSN=$E(FBSSN,10)_$E(FBSSN,1,9)_" "
	;
	W ! S DIR("A")="Enter LAST NAME",DIR(0)="F^3:20^K:X'?.A X",DIR("?")="Enter last name of patient.  Answer must be 3 to 20 characters in length" D ^DIR K DIR Q:$D(DIRUT)  S FBLNAM=$E(Y,1,12)_$E(PAD,$L(Y)+1,12)
	;
	S DIR("A")="Enter FIRST INITIAL",DIR(0)="F^1:1^K:X'?1A X" D ^DIR K DIR Q:$D(DIRUT)  S FBFI=Y
	;
	S DIR("A")="Enter MIDDLE INITIAL",DIR(0)="FO^1:1^K:X'?1A X" D ^DIR K DIR Q:$D(DUOUT)!($D(DTOUT))  S FBMI=$S(Y]"":Y,1:" ")
	;
	S FBNAME=FBLNAM_FBFI_FBMI
SSN	;ASK SSN
	S DIR("A")="Patient ID Number",DIR("?")="Answer must contain 9 numbers.  Pseudo-SSN not allowed",DIR(0)="F^9:9^K:X'?9N X" D ^DIR K DIR Q:$D(DIRUT)  S FBSSN=" "_Y_" "
	;
DOB	S DIR(0)="2,.03",DIR("A")="Date of Birth" D ^DIR K DIR Q:$D(DIRUT)  S FBDOB=$E(Y,4,7)_($E(Y,1,3)+1700)
	;
SEX	;ask sex of patient
	S DIR("A")="Sex of Patient",DIR(0)="2,.02" D ^DIR K DIR G END:$D(DIRUT) S FBSEX=Y
VEND	;ask vendor
	S DIR("A")="Want to select a vendor from DHCP Fee Basis Vendor file",DIR(0)="Y",DIR("B")="Yes" D ^DIR K DIR Q:$D(DIRUT)  I Y D  G END:+$G(FBOUT),VEND:'$D(FBVID),CONT
	.W ! S DIC="^FBAAV(",DIC(0)="AEQMZ" D ^DIC K DIC S:X=""!(X="^") FBOUT=1 Q:Y<0  S FBSTABR=+$P(Y(0),"^",5),FBSTABR=$P($G(^DIC(5,FBSTABR,0)),"^",2),FBSTABR=$S('$L(FBSTABR):"  ",1:FBSTABR)
	.S FBVID=$P(Y(0),"^",17) I FBVID="" K FBVID W !!,*7,"Vendor must have a Medicare ID number to send to the pricer.",! Q
	W ! S DIR("A")="Select Vendor Name",DIR(0)="F^2:46" D ^DIR K DIR G END:$D(DIRUT) S FBVEN=Y
	S DIR("A")="Enter Medicare ID Number",DIR(0)="161.2,22" D ^DIR K DIR G END:$D(DIRUT) S FBVID=Y
	S DIR("A")="State of Vendor",DIR(0)="P^5:EQMZ" D ^DIR K DIR G END:$D(DIRUT) S FBSTABR=$S($L($P(Y(0),"^",2)):$P(Y(0),"^",2),1:"  ")
	;
CONT	;ask admission and treatment type information
	W ! S DIR("A")="Admission Date: ",DIR(0)="DA^::EX",DIR("?")="^D HELP^%DTC" D ^DIR K DIR G END:$D(DIRUT) S FBFDT=Y
	S DIR("A")="Discharge Date: ",DIR(0)="DA^"_FBFDT_"::EX",DIR("?")="^D HELP^%DTC" D ^DIR K DIR G END:$D(DIRUT) S FBTDT=Y
	S X1=FBTDT,X2=FBFDT D ^%DTC S FBLOS=$S(X<1:1,1:X),FBLOS=$E("000",$L(FBLOS)+1,3)_FBLOS
	F I="FBFDT","FBTDT" S @I=$E(@I,4,7)_($E(@I,1,3)+1700)
	;
	S DIR(0)="P^43.4:EQM",DIR("A")="Admitting Authority" D ^DIR K DIR G END:$D(DIRUT) S Z=+Y
	S FBAUTH=$$AUTH^FBAAV6(Z) K Z
	;
	S DIR("A")="Disposition Code",DIR(0)="P^162.6:QEMZ" D ^DIR K DIR G END:$D(DIRUT) S FBDISP=$E("00",$L($P(Y(0),"^",2))+1,2)_$P(Y(0),"^",2)
	;
	S DIR("A")="Is this a Patient Reimbursement",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT) S FBPAYT=$S(Y:"P",1:"V")
	;
	S DIR("A")="Payment by Medicare or Other Federal Agency",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR G END:$D(DIRUT) S FBMED=$S(Y:"Y",1:"N")
	;
	D ^FBPRICE1
	;
END	K FBSTAN,FBAUTH,FBBILL,FBCLAIM,FBDISP,FBDOB,FBDX,FBFDT,FBFI,FBFLNAM,FBLNAM,FBLOS,FBMED,FBMI,FBNAME,FBOBL,FBPAYT,FBPRC,FBSEX,FBSITE,FB,FBAASN,FBFEE,FBI,FBJ,FBLN,FBNVP,FBOKTX,FBSN,FBXMZ
	K FBSSN,FBSTR,FBSTABR,FBTDT,FBVID,PAD,POP,PRC,DUOUT,DTOUT,DIRUT,DIR,FBPART1,FBVEN,FBSDI,VAT,VATERR,VATNAME,Y,FBPOP,FBVAR,FBXMFEE,FBXMNVP,FBPOP
	Q

FBPRICE1
FBPRICE1	;AISC/DMK-GENERIC PRICER INTERFACE CON'T ;25JUN92
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
ICD	;ask Dx
	W ! F I=1:1:5 S FBDX(I)="       "
	S DIR(0)="PO^80:EQMZ"
	F I=1:1:5 D ^DIR Q:X=""!($D(DTOUT))!($D(DUOUT))  I Y>0 S FBDX(I)=$TR($P($G(^ICD9(+Y,0)),"^"),"."),FBDX(I)=FBDX(I)_$E(PAD,$L(FBDX(I))+1,7)
	I 'FBDX(1),$D(DTOUT)!($D(DUOUT)) G END^FBPRICE
	I 'FBDX(1) W !,*7,"Must enter at least a primary diagnosis.",! G ICD
	K DIR,I
PROC	;ask procedure codes
	W ! F I=1:1:3 S FBPRC(I)="       "
	S DIR(0)="PO^80.1:EQM"
	F I=1:1:3 D ^DIR Q:X=""!($D(DUOUT))!($D(DTOUT))  I Y>0 S FBPRC(I)=$TR($P($G(^ICD0(+Y,0)),"^"),"."),FBPRC(I)=FBPRC(I)_$E(PAD,$L(FBPRC(I))+1,7)
	I 'FBPRC(1),$D(DTOUT)!($D(DUOUT)) G END^FBPRICE
	K DIR,I
	;
	W ! S DIR(0)="162.5,6.6",DIR("A")="Billed Charges" D ^DIR K DIR G END^FBPRICE:$D(DIRUT) S FBBILL=$FN(Y,"",2),FBBILL=$TR(FBBILL,"."),FBBILL=$E("00000000",$L(FBBILL)+1,8)_FBBILL
	;
	S DIR(0)="162.5,6.6",DIR("A")="Amount Claimed" D ^DIR K DIR G END^FBPRICE:$D(DIRUT) S FBCLAIM=$FN(Y,"",2),FBCLAIM=$TR(FBCLAIM,"."),FBCLAIM=$E("00000000",$L(FBCLAIM)+1,8)_FBCLAIM
	;
	;S DIR("A")="Obligation Number",DIR(0)="F^6:6^D CKOB^FBAAUTL1" D ^DIR K DIR G END^FBPRICE:$D(DIRUT) S FBOBL=Y
	S FBOBL="000000"
	;
STRING	;set-up message text for pricer
	W ! D WAIT^DICD
	D ADDRESS^FBAAV01 Q:$G(VATERR)  K VAT
	S FBFLAG=1 D NEWMSG^FBAAV01
	S FBPART1=FBSSN_FBFDT_FBSTAN
	S FBSTR(1)=FBPART1_21_FBLNAM_FBFI_FBMI_FBSEX_FBDOB_FBLOS_FBDISP_FBBILL_FBCLAIM_FBAUTH_FBPAYT_FBOBL_"Y"
	S FBSTR(2)=FBPART1_22_FBVID_FBMED_$E(PAD,1,29)_FBTDT_FBSTABR_FBDX(1)
	S FBSTR(3)=FBPART1_23_FBDX(2)_FBDX(3)_FBDX(4)_FBDX(5)_FBPRC(1)_FBPRC(2)_FBPRC(3)_"    "
	F I=1:1:3 S FBSTR=FBSTR(I) D STORE^FBAAV01
	D XMIT^FBAAV01 K FBFLAG
	W !,"Case sent to pricer.",!
	Q

FBPST35
FBPST35	;AISC/DMK-UPDATE POV FILE ;4/6/93  14:10
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ENPOV	;go through POV file and inactivate any duplicates
	W !,"Starting Post Init FBPST35 " D NOW^%DTC W $$DATX^FBAAUTL(%)
	S (FBI,FBJ,FBHI)=0
	F  S FBI=$O(^FBAA(161.82,"C",FBI)) Q:'FBI  F  S FBJ=$O(^FBAA(161.82,"C",FBI,FBJ)) Q:'FBJ  D
	.I $G(FBHI)=FBI S DIE="^FBAA(161.82,",DR="4////^S X="_DT,DA=FBJ D ^DIE
	.S FBHI=FBI
	K FBI,FBJ,FBHI,DIE,DR
	;
	;set new entries into ^TMP
	F I=1:1 S II=$P($T(POV+I),";;",2) Q:II=""  D
	.S ^TMP($J,"FB",II)=$P($T(POV+I),";;",3)
	;
	;update file 161.82
	S (FBI,FBJ)=0
	F  S FBI=$O(^FBAA(161.82,"C",FBI)) Q:'FBI  F  S FBJ=$O(^FBAA(161.82,"C",FBI,FBJ)) Q:'FBJ  D:'$P($G(^FBAA(161.82,FBJ,"I")),"^")
	.I $P($G(^FBAA(161.82,FBJ,0)),"^")'=$P($G(^TMP($J,"FB",FBI)),"^") S $P(^FBAA(161.82,FBJ,0),"^")=$P(^TMP($J,"FB",FBI),"^")
	;
	N FBX S DIC="^FBAA(161.82,",DIC(0)="L",DLAYGO=161.82
	F FBI="02",37,38,77,78 I '$D(^FBAA(161.82,"C",FBI)) D
	.S FBX=$G(^TMP($J,"FB",FBI)),X=$P(FBX,U)
	.S DIC("DR")="3////"_FBI S:+$P(FBX,U,2) DIC("DR")=DIC("DR")_";2////^S X="_$P(FBX,U,2)
	.K DD,DO D FILE^DICN
	K DIC,DLAYGO
	;
	K ^FBAA(161.82,"B") S DIK="^FBAA(161.82,",DIK(1)=".01" D ENALL^DIK K DIK
	K ^FBAA(161.82,"AC") S DIK="^FBAA(161.82,",DIK(1)="3^AC" D ENALL^DIK K DIK
	K DIC,DIE,DR,I,II,FBI,FBJ,DIK,^TMP($J,"FB"),X,Y
	;
IX1	;clean up old x-ref no longer used
	K ^FBAAC("AD","R")
	K ^DD(162.03,18,1,1),^DD(162,0,"IX","AE",162.03,18)
	K ^DD(162.7,0,"IX","ADT",162.7,10),^DD(162.7,0,"IX","AST",162.7,24)
	K ^DD(161,0,"IX","C",161.01,1)
	K ^FBAAC("AF"),^DD(162.03,19,1,1),^DD(162,0,"IX","AF",162.03,19)
	;
LOCK	;remove the FBAASUPERVISOR lock from  option
	;
	N FBI,FBJ,DIC,DIE,DR,DA
	S FBJ=1
	F  S FBI=$P($T(OPT+FBJ),";;",2) Q:FBI="END"  S FBJ=FBJ+1 D
	. S DIC="^DIC(19,",X=FBI,DIC(0)="QZ" D ^DIC Q:Y<0  D:$P(Y(0),U,6)="FBAASUPERVISOR"
	..S DIE=DIC,DA=+Y,DR="3///@" D ^DIE
	;
	;populate new transmission header field stored in 161.4
	I $D(^FBAA(161.4,1,0)) S $P(^(1),U,10)="FEN",$P(^(1),U,9)=125
	W !,"Completed FBPST35   " D NOW^%DTC W $$DATX^FBAAUTL(%)
	D ^FBPST35A
	D ^FBPST35B
	D ^FBPST35C
	D VENDOR^FBPST35B
	D XREF^FBPST35B
	D ^FBONIT ;to create protocols for list manager phone inq menu
	D ^FBP35D ; to create list template for phone inq menu
	S X="FBINITY" X ^%ZOSF("TEST") I $T D @("^"_X)
	Q
	;
OPT	;options to update
	;;FBAA REJECT PRINT
	;;FBAA OBSOLETE ID CARDS
	;;FBAA ID CARDS CURRENT LIST
	;;FBCH PRICER RELEASE
	;;FBCNH POST COMMITMENTS
	;;END
	;
POV	;
	;;02;;UNAUTHORIZED CLAIM - OUTPATIENT
	;;10;;OPT - SC 50% OR MORE
	;;11;;OPT TO OBVIATE THE NEED FOR HOSP. ADMISSION
	;;12;;CHAMPVA SPONSOR
	;;13;;CHAMPVA BENEFICIARY
	;;15;;CLASS I DENTAL TREATMENT
	;;16;;CLASS II DENTAL TREATMENT
	;;17;;CLASS IIa DENTAL TREATMENT
	;;18;;CLASS IIb DENTAL TREATMENT
	;;19;;CLASS IIc DENTAL TREATMENT
	;;20;;CLASS IIr DENTAL TREATMENT
	;;21;;CLASS III DENTAL TREATMENT
	;;22;;CLASS IV DENTAL TREATMENT
	;;23;;CLASS V DENTAL TREATMENT
	;;24;;CLASS VI DENTAL TREATMENT
	;;30;;AUTHORIZED NON-VA HOSPITAL CARE FOR SC COND.
	;;31;;UNAUTHORIZED NON-VA HOSPITAL CARE, SC OR NSC COND
	;;32;;EMERG. NON-VA CARE (INPT/OPT) FOR VET. REC. INPT. CARE IN VAMC
	;;33;;EMERG. NON-VA CARE (INPT/OPT) VET. REC. CARE IN FED. HOSP. AT VA EXP.
	;;34;;NON-VA HOSP. CARE FOR WOMEN VETERANS (NO OTHER ELIGIBILITY)
	;;35;;NON-VA HOSP. CARE FOR NSC COND. (AK, VI AND HI ONLY)
	;;36;;NON-VA HOSP. CARE FOR VET. REC. INPT. CARE IN FED. HOSP. AT VA EXP.
	;;37;;HOSPICE CARE (INPT.) CONTRACT/SHARING AGREEMENT^6
	;;38;;HOSPICE CARE (INPT.) FEE BASIS AUTHORITY (CFR 17.50b)^6
	;;40;;COMMUNITY NURSING HOME FOR SC DISABILITY(IES)
	;;41;;COMMUNITY NURSING HOME FOR NSC DISABILITY(IES)
	;;42;;COMMUNITY NURSING HOME FOR ACTIVE DUTY PERSONNEL
	;;50;;CONTRACT READJUSTMENT COUNSELING AND RELATED MENTAL HEALTH SERVICES
	;;60;;CONTRACT HALFWAY HOUSE SUBSTANCE ABUSE REHABILITATION OR TREATMENT
	;;70;;HOME HEALTH NURSING SERVICES
	;;71;;HOME HEALTH SERVICES (NON-NURSE)
	;;72;;HISA - NSC
	;;73;;HISA - SC
	;;77;;HOSPICE CARE (OPT) - CONTRACT/SHARING AGREEMENT^2
	;;78;;HOSPICE CARE (OPT) - FEE BASIS AUTHORITY (CFR 17.50b)^2
	;;80;;OPT DIAGNOSTIC SVC. OBTAINED BY INDP. CLINIC TO OBVIATE HOSP. CARE
	;;81;;DIAGNOSTIC SVC. FOR VET IN MED. CENTER OPT PROGRAM[5~
	;;82;;FEE OXYGEN
	;;83;;OPT SERVICES FOR VA INPATIENTS
	;;84;;SUPPLEMENTAL DIAGNOSTIC SERVICES - TREATMENT/ALLERGY CLINICS
	;;85;;OPT SERVICES FOR VA OUTPATIENTS
	;;01;;COMPENSATION AND PENSION EXAM
	;;03;;APPLICATION FOR MED. BENEFITS (VAF 10-10)
	;;04;;VA INSURANCE EXAM
	;;05;;OPT SERVICES/TREATMENT FOR NSC DISABILITIES
	;;06;;OPT FOR VETS. IN RECEIPT OF AID & ATTENDANCE OR HOUSEBOUND BENEFITS
	;;07;;MISC. (ELIG. UNDER VOC. REHAB, OTHER FED. AGENCY OR ALLIED BENE.)
	;;08;;OPT WORLD WAR I AND MEXICAN BORDER PERIOD
	;;09;;OPT - SC LESS THAN 50%
	Q

FBPST35A
FBPST35A	;AISC/CMR-MERGE & DELETION OF DENIALS FILES ; JUN 15 1994
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	I '$D(^DD(163,0)),('$D(^DD(163.1,0))) W !!,"Post-Init FBPST35A has already been run." Q
	W !!,"Beginning FBPST35A....",!!?20,"CONVERSION OF DENIALS FILES"
	I '$D(^FBAA(163,0)) G DEL
	W !!,"Now I will move any Medical Denial information you wish to keep into the",!,"Fee Basis Payment File (#162).  I will then remove the Fee Basis Medical",!,"Denials file (#163) and the Fee Basis Pharmacy Denials file (#163.1)."
ASK	W !!,"Do you want to keep any Medical Denials that are presently stored in the" S DIR(0)="Y",DIR("A")="Fee Basis Medical Denials file (#163)",DIR("B")="No"
	S DIR("?")="Answering yes will move the denials to file #162, no will delete them" D ^DIR K DIR G:$D(DIRUT) ABRT I 'Y G DEL
	S FBDEN=1
	W !!,"You may elect to merge all of your Fee Basis Medical Denials.  If you",!,"choose not to retain all denials, you will be prompted to select a",!,"STARTING DATE to retain denials.  Denials from the starting date to the"
	W !,"present date will be merged into file #162.",!!
ASK1	S DIR(0)="Y",DIR("A")="Do you wish to retain all Medical Denials",DIR("B")="No" D ^DIR K DIR G ASK:$D(DIRUT),MOVE:Y
	S DIR(0)="D",DIR("A")="Select date to retain denials" D ^DIR K DIR G ASK1:$D(DIRUT)!(Y'>0) S FBARDT=+Y
MOVE	S U="^" I '$G(FBDEN) G DEL
	W !!?5,"Beginning merge"
	;get patient from denial file and set up or find in pmnt file
	S DFN=0 F  S DFN=$O(^FBAA(163,DFN)) Q:'DFN  D
	.;get vendor from denial file and set up or find in pmnt file
	.S FBV=0 F  S FBV=$O(^FBAA(163,DFN,1,FBV)) Q:'FBV  D
	..;get trt dt from denial file and set up or find in pmnt file
	..S FBDSDI=0 F  S FBDSDI=$O(^FBAA(163,DFN,1,FBV,1,FBDSDI)) Q:'FBDSDI  S FBDDT=+^FBAA(163,DFN,1,FBV,1,FBDSDI,0),FBAUTH=$P(+^(0),"^",4) D:($S($G(FBARDT):FBDDT'<FBARDT,1:1))
	...D PAT^FBAACO,FILEV^FBAACO5(DFN,FBV) Q:$G(FBAAOUT)  D GETSVDT^FBAACO5(DFN,FBV,FBAUTH,0,FBDDT) Q:$G(FBAAOUT)
	...;get and file svc provided multiples
	...S FBJ=0 F  S FBJ=$O(^FBAA(163,DFN,1,FBV,1,FBDSDI,1,FBJ)) Q:'FBJ  I $D(^FBAA(163,DFN,1,FBV,1,FBDSDI,1,FBJ,0)) S FBX=+^(0) D
	....W "." K DD,DO S DIC="^FBAAC(DFN,1,FBV,1,FBSDI,1,",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI,X=FBX,DIC(0)="L",DIC("P")="162.03A" D FILE^DICN K DIC,DA Q:'Y  S FBAACPI=+Y
	....S %X="^FBAA(163,DFN,1,FBV,1,FBDSDI,1,FBJ,",%Y="^FBAAC(DFN,1,FBV,1,FBSDI,1,FBAACPI," D %XY^%RCR
	....;re-index entry
	....S DIK="^FBAAC(DFN,1,FBV,1,FBSDI,1,",DA(3)=DFN,DA(2)=FBV,DA(1)=FBSDI,DA=FBAACPI D IX1^DIK K DIK,DA
	....;delete entry from 163
	....S DIK="^FBAA(163,DFN,1,FBV,1,FBDSDI,1,",DA(3)=DFN,DA(2)=FBV,DA(1)=FBDSDI,DA=FBJ D ^DIK K DIK,DA
DEL	;delete files 163 and 163.1
	I $D(^DD(163,0)) W !!?5,"Deleting the Fee Basis Medical Denials file (#163)..." S DIU="^FBAA(163,",DIU(0)="DT" D EN^DIU2
	I $D(^DD(163.1,0)) W !!?5,"Deleting the Fee Basis Pharmacy Denials file (#163.1)..." S DIU="^FBAA(163.1,",DIU(0)="DT" D EN^DIU2
	W !!?5,"Cleaning up DD nodes..."
	K ^DD(200,0,"PT",163.03,6),^DD(200,0,"PT",163.1,2),^DD(200,0,"PT",163.11,11),^DD(161.2,0,"PT",163.01,.01),^DD(161.2,0,"PT",163.1,3),^DD(161,0,"PT",163.11,4),^DD(161.27,0,"PT",163.03,4),^DD(161.27,0,"PT",163.11,7)
	K ^DD(50,0,"PT",163.11,9),^DD(161.7,0,"PT",163.03,7),^DD(161.7,0,"PT",163.03,21),^DD(161.7,0,"PT",163.04,1),^DD(161.7,0,"PT",163.04,6),^DD(161.7,0,"PT",163.1,10),^DD(161.7,0,"PT",163.11,13),^DD(161.7,0,"PT",163.11,19)
	K ^DD(2,0,"PT",163,.01),^DD(161.8,0,"PT",163.02,1.5),^DD(161.8,0,"PT",163.03,23),^DD(81,0,"PT",163.03,.01),^DD(161.82,0,"PT",163.03,16)
END	K DFN,FBV,FBSDI,FBDSDI,DA,DIU,DIC,FBARDT,FBDEN,DIK,FBAADT,FBAUTH
	W !!,"Completed FBPST35A   " D NOW^%DTC W $$DATX^FBAAUTL(%)
	Q
ABRT	;
	I $D(DUOUT) W !!,*7,"Required Response!!" G ASK
	I $D(DTOUT) W !!,*7,"Unable to complete the FBPST35A Post-Init routine.  To complete this",!,"process, run ^FBPST35A as soon as possible."
	Q

FBPST35B
FBPST35B	;ACAMPUS/DMK-CONVERT FILE 163.99
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;This post-init routine goes through file 163.99 and converts the .01
	;field from a pointer to the CPT file(#81) to the external value.
	;The .01 field is converted to free text with this install to allow
	;for the incorperation of CPT Modifiers to the Fee Schedule.
	;
	Q:+$G(^DD(163.99,0,"VR"))>3
	W !!,"Beginning FBPST35B ....",!!?18,"CONVERSION OF FEE BASIS FEE SCHEDULE FILE (#163.99)"
	N FBI,FBX,DA,DIE,DR,X
	S FBI=0
	F  S FBI=$O(^FBAA(163.99,FBI)) Q:'FBI  I $D(^(FBI,0)) D
	. S DA=FBI Q:'$D(^ICPT(FBI,0))  S FBX=$P(^(0),U)
	. S DIE="^FBAA(163.99,",DR=".01////^S X=FBX" D ^DIE
	;clean up old PT node in file 81
	K ^DD(81,0,"PT",163.99,.01)
	W !!,"Completed FBPST35B   " D NOW^%DTC W $$DATX^FBAAUTL(%)
	Q
VENDOR	;clean up invalid ID entries still in 161.25
	S FBI=0 F  S FBI=$O(^FBAA(161.25,FBI)) Q:'FBI  S FBL=+$P($G(^FBAA(161.25,FBI,0)),U,6) D
	.I FBL,(FBI'=FBL) Q
	.S FBJ=0 F  S FBJ=$O(^FBAA(161.25,"AF",FBI,FBJ)) Q:'FBJ  I (FBI'=FBJ) S FBOUT=1 Q
	.I $G(FBOUT) K FBOUT Q
	.S FBID=$P($G(^FBAAV(FBI,0)),U,2) I FBID']""!($A(FBID)=45)!($L(FBID)>11)!($L(FBID)<9)!(+FBID=0)!(FBID'?9N.2AN) D
	..S FB(FBI)=""
	..S DIK="^FBAA(161.25,",DA=FBI D ^DIK K DIK,DA
	..S DIE="^FBAAV(",DA=FBI,DR="9////^S X=""Y"";13///^S X=""T""" D ^DIE K DIE,DA,DR
	I '$D(FB) G END
	S PAD=" ",$P(PAD," ",40)="",FBCTR=2,FBTEXT(1,0)="The following vendors with invalid ID's have been placed in delete status:",FBTEXT(2,0)=" "
	S FBI=0 F  S FBI=$O(FB(FBI)) Q:'FBI  S FBCTR=FBCTR+1,FBTEXT((FBCTR),0)="   "_$E($$VNAME^FBNHEXP(FBI),1,30)_$E(PAD,$L($$VNAME^FBNHEXP(FBI))+1,40)_$$VID^FBNHEXP(FBI)
	S XMSUB="FEE BASIS VENDOR CORRECTIONS CLEANUP",XMDUZ=.5,XMY("G.FEE")="",XMTEXT="FBTEXT(" D ^XMD K FBTEXT,XMDUZ,XMSUB,XMY,XMTEXT,XMZ,PAD,FBCTR
END	K FBI,FBJ,FBL,FBID,FB,X,Y,DIC
	Q
XREF	;fix cross-references in 162 and 162.1 on date finalized & cert fields
	S ZTRTN="FIX^FBPST35B",ZTIO="",ZTDTH=$H D ^%ZTLOAD
	K ZTSK
	Q
FIX	;outpatient x-ref fix on field date finalized
	S FBV=0 F  S FBV=$O(^FBAAC("AP",FBV)) Q:'FBV  D
	.S FBI=0 F  S FBI=$O(^FBAAC("AP",FBV,FBI)) Q:'FBI  D
	..S DFN=0 F  S DFN=$O(^FBAAC("AP",FBV,FBI,DFN)) Q:'DFN  D
	...S FBSDT=0 F  S FBSDT=$O(^FBAAC("AP",FBV,FBI,DFN,FBSDT)) Q:'FBSDT  D
	....S FBCPT=0 F  S FBCPT=$O(^FBAAC("AP",FBV,FBI,DFN,FBSDT,FBCPT)) Q:'FBCPT  D
	.....I $P($G(^FBAAC(DFN,1,FBV,1,FBSDT,1,FBCPT,0)),"^",6)'=FBI D
	......K ^FBAAC("AK",FBI,DFN,FBV,FBSDT,FBCPT),^FBAAC("AP",FBV,FBI,DFN,FBSDT,FBCPT)
	......S FBPSA=$P($G(^FBAAC(DFN,1,FBV,1,FBSDT,1,FBCPT,0)),"^",12) I FBPSA K ^FBAAC("AQ",FBPSA,9999999-FBI,DFN,FBV,FBSDT,FBCPT)
FIXRX	;fix Pharmacy Invoice x-ref on field date certified for payment
	S FBI=0 F  S FBI=$O(^FBAA(162.1,"AA",FBI)) Q:'FBI  D
	.S DFN=0 F  S DFN=$O(^FBAA(162.1,"AA",FBI,DFN)) Q:'DFN  D
	..S FBIN=0 F  S FBIN=$O(^FBAA(162.1,"AA",FBI,DFN,FBIN)) Q:'FBIN  D
	...S FBRX=0 F  S FBRX=$O(^FBAA(162.1,"AA",FBI,DFN,FBIN,FBRX)) Q:'FBRX  D
	....S FBDT=$P($G(^FBAA(162.1,FBIN,"RX",FBRX,0)),"^",19) D  K FBDT
	.....Q:FBDT=FBI
	.....I FBDT,(FBDT'=FBI) S $P(^FBAA(162.1,FBIN,"RX",FBRX,0),"^",19)=FBI Q
	.....K ^FBAA(162.1,"AA",FBI,DFN,FBIN,FBRX)
	.....S FBPSA=$P($G(^FBAA(162.1,FBIN,"RX",FBRX,2)),"^",5) I FBPSA K ^FBAA(162.1,"AI",FBPSA,9999999-FBI,FBIN,FBRX)
	K FBI,DFN,FBV,FBSDT,FBCPT,FBPSA,FBIN,FBRX,FBDT S ZTREQ="@"
	Q

FBPST35C
FBPST35C	;AISC-CMR;ELIMINATION OF FIELDS;JUN 29, 1994
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;FBFILE = file # with obsolete fields in it
	;FBFLD = field # to be deleted
	;FBGOT = set to 1 if fields still require deleting (flag to determine
	;        if job has previously run to completion)
	F I=1:1:4 S FBFILE=$P($T(FILES+I),";;",2) Q:$G(FBGOT)  F J=3:1 S FBFLD=$P($T(FILES+I),";;",J) Q:'FBFLD!($G(FBGOT))  I $D(^DD(FBFILE,FBFLD,0)) S FBGOT=1
	I '$G(FBGOT) W "FBPST35C has previously run to completion!" G END
	W !!,"Beginning FBPST35C",!!?5,"REMOVAL OF FIELDS PREVIOUSLY STARRED FOR DELETION.",!!
	F I=1:1:13 W !,$P($T(TEXT+I),";;",2)
	W !! I '$D(DUZ) G START
ASK	S DIR(0)="Y",DIR("A")="Do you want me to task this job in the background for you",DIR("B")="Yes"
	S DIR("?")="Answerring 'YES' will run the job in the background and send you a bulletin",DIR("?",1)="when completed.  Answerring 'NO' will run the job now (no",DIR("?",2)="bulletin will be sent)."
	D ^DIR K DIR I $D(DIRUT) W !!,*7,"Required response!" G ASK
	I Y S ZTRTN="START^FBPST35C",ZTIO="",ZTDTH=$H D ^%ZTLOAD I $D(ZTSK) W !?5,"Routine FBPST35 to remove obsolete fields has been tasked." G END
START	;
DATA	;delete data from obsolete fields in FB pt. file (#161)
	I '$D(ZTQUEUED) W !!,"Deleting any data remaining in the obsolete fields."
	S DFN=0 F  S DFN=$O(^FBAAA(DFN)) Q:'DFN  K ^FBAAA(DFN,"ADEL") S FBV=0 F  S FBV=$O(^FBAAA(DFN,1,FBV)) Q:'FBV  K ^FBAAA(DFN,1,FBV,"CNH")
	;delete data from obsolete fields in FB vendor file (#161.2)
	S FBV=0 F  S FBV=$O(^FBAAV(FBV)) Q:'FBV  S DIE="^FBAAV(",DR="16////@;17////@;21////@",DA=FBV D ^DIE K DIE,DA,DR
	;delete data from obsolete fields in FB site parameter file (#161.4)
	S FBSP=0 F  S FBSP=$O(^FBAA(161.4,FBSP)) Q:'FBSP  S DIE="^FBAA(161.4,",DR="36////@;37////@",DA=FBSP D ^DIE K DIE,DA,DR
FIELDS	;remove obsolete fields
	F I=1:1:4 S FBFILE=$P($T(FILES+I),";;",2) F J=3:1 S FBFLD=$P($T(FILES+I),";;",J) Q:'FBFLD  I $D(^DD(FBFILE,FBFLD,0)) D
	.I '$D(ZTQUEUED) W !!,"Deleting field # ",FBFLD," from file # ",FBFILE,"."
	.S DIK="^DD("_FBFILE_",",DA=FBFLD,DA(1)=FBFILE D ^DIK K DIK,DA
	I '$D(ZTQUEUED) W !!!,"Completed FBPST35C" G END
	S FBTEXT(1,0)="Post initialization routine FBPST35C has run to completion.",XMSUB="FEE BASIS POST-INIT COMPLETE",XMDUZ=.5,XMY(DUZ)="",XMTEXT="FBTEXT("
	D ^XMD K FBTEXT,XMSUB,XMDUZ,XMY,XMTEXT
END	K FBFILE,FBFLD,I,J,FBGOT,FB
	Q
FILES	;;
	;;161.01;;4
	;;161;;102;;103;;104
	;;161.2;;16;;17;;21
	;;161.4;;36;;37
TEXT	;;
	;;I will now remove the following fields that have been starred for
	;;deletion:
	;;          File                     Field
	;;          ----                     -----
	;; 161     Fee Basis Patient         102  *AUSTIN DELETED
	;;                                   103  *DATE OF AUSTIN DELETE
	;;                                   104  *DATE TRANSMITTED TO AUSTIN
	;; 161.01  Fee Basis Patient           4  *CNH LEVEL OF CARE
	;; 161.2   Fee Basis Vendor           16  *NUMBER OF SKILLED BEDS
	;;                                    17  *NUMBER OF INTERMEDIATE BEDS
	;;                                    21  *LEVELS OF CARE PROVIDED
	;; 161.4   Fee Basis Site Parameters  36  *LAST UC UPDATED
	;;                                    37  *DATE UC CONVERSION COMPLETED

FBUCDD
FBUCDD	;ALBISC/TET - DD UTILITY ROUTINE ;5/27/93  19:28
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
INPUT(DA,X,Y,FBZZ)	;input transform of status field, file 162.7
	;INPUT:  X and Y - FM variables
	;        DA - internal entry number of 162.7, Unauthorized Claims
	;        FBZZ - set in input transform, identifies the field in 162.7
	;OUTPUT: 1 if x should be killed, otherwise 0.
	N FBZ S FBZ=$G(^FB583(DA,0))
23	;If FBZZ=23 - CLAIM SUBMITTED BY
	;ensure that if vendor or veteran entered, same as vendor or veteran field
	I FBZZ=23 Q $S(X["FBAAV"&(+X'=$P(FBZ,U,3)):1,X["DPT"&(+X'=$P(FBZ,U,4)):1,1:0)
24	;IF FBZZ=24 - STATUS
	;if y<0 k x
	;if dispositioned, status can only be dispositioned (and converse).
	;if not dispositioned, valid claim received, cannot select status
	; which indicates incomplete claim (and converse).
	I FBZZ=24 N O S O=$$ORDER^FBUCUTL(X) Q $S(Y<0:1,"^40^70^90^"[O&('$P(FBZ,U,11)):1,"^40^70^90^"'[O&($P(FBZ,U,11)):1,$P(FBZ,U,8)&(O'>20):1,'$P(FBZ,U,8)&(O>20):1,1:0)
10	;IF FBZZ=10 - DISPOSITION
	;dispositon to cancelled/withdrawn or abandoned if date valid claim received is null,
	; k x if disposition is other than approved(1) or approved to stabilization(4)
	;  and not ok to updated (payments were made and user doesn't hold key)
	;otherwise can select any disposition.
	I FBZZ=10 Q $S(Y<0:1,'(X=3!(X=5))&('$P(FBZ,U,8)):1,((X=2)!(X=3)!(X=5))&('$$UPOK^FBUCUTL(DA)):1,1:0)
7	;IF FBZZ=7 - DATE VALID CLAIM RECEIVED
	;claim is considered valid when all pending information is received.
	I FBZZ=7 Q $S(Y<1:1,$$PEND^FBUCUTL(DA):1,1:0)
4	;IF FBZZ=4 - TREATMENT TO DATE
	;if y<1 k x
	;if treatment to date is before treatment from date, k x
	I FBZZ=4 Q $S(Y<1:1,$P(FBZ,U,5)>X:1,1:0)
12	;IF FBZZ=12 - AUTHORIZED FROM DATE
	;if y<1 k x
	;if authorized from date is before treatment from date, k x
	;if authorized from date is after treatment to date, k x
	I FBZZ=12 Q $S(Y<1:1,$P(FBZ,U,5)>X:1,X>$P(FBZ,U,6):1,1:0)
13	;IF FBZZ=14 - AUTHORIZED TO DATE
	;if y<1 k x
	;if authorized to date is before authorized from date, k x
	;if authorized to date is after treatment to date, k x
	I FBZZ=13 Q $S(Y<1:1,$P(FBZ,U,13)>X:1,X>$P(FBZ,U,6):1,1:0)
	Q
DISCHTYP(DA)	;discharge type - computed field expression from field 29 of 162.7
	;INPUT:  DA = ien
	;OUTPUT: long value of discharge type for file 161.01,.06
	N FBZ,FBIEN
	I '+$G(DA) Q ""
	S FBZ=$$FBZ^FBUCUTL(DA),FBIEN=+$O(^FBAAA("AG",DA_";FB583(",+$P(FBZ,U,4),0)) I 'FBIEN Q ""
	S FBZ=$$PTR^FBUCUTL("^FBAAA("_+$P(FBZ,U,4)_",1,",FBIEN),FBIEN=$P(FBZ,U,15)
	Q $S('FBIEN:"",FBIEN=4:"DISCHARGE",FBIEN=3:"DEATH WITHOUT AUTOPSY",FBIEN=2:"DEATH WITH AUTOPSY",1:"TRANSFER TO VA")
	;
MSIX(X,DA,FLD,ACT,FBIX)	;cross-reference on either vendor/veteran/other,master claim,status order
	;INPUT:  X = value edited
	;        DA = internal entry number of record
	;        FLD = field edited
	;        ACT = action:  1 for set; 2 for kill
	;        FBIX = cross-ref to be set, either APMS, AVMS or AOMS
	;VAR:    FBZ = zero node and value of first subscript of cross-ref
	;        FBZ(1) = master claim designation
	;        FBZ(2) = status order
	;OUTPUT:  set or kill cross-reference, depending upon the action
	I $S('+$G(X):1,'+$G(DA):1,'+$G(FLD):1,'+$G(ACT):1,$G(FBIX)']"":1,1:0) Q
	I $S(FBIX="APMS":0,FBIX="AVMS":0,FBIX="AOMS":0,1:1) Q
	N FBZ S FBZ=$$FBZ^FBUCUTL(DA) I FBIX="AOMS",$P(FBZ,U,23)'["VA(200" Q
	S FBZ(1)=$S(FLD=20:X,1:+$P(FBZ,U,20)) Q:'FBZ(1)  S FBZ(1)=FBZ(1)_$S(DA=FBZ(1):"P",1:"S")
	S FBZ(2)=$$ORDER^FBUCUTL($S(FLD=24:X,1:+$P(FBZ,U,24))) Q:'FBZ(2)
	S FBZ=$S(FLD'=20&(FLD'=24):+X,FBIX="APMS":+$P(FBZ,U,4),FBIX="AVMS":+$P(FBZ,U,3),1:+$P(FBZ,U,23)) Q:'FBZ
	I ACT=1 S ^FB583(FBIX,FBZ,FBZ(1),FBZ(2),DA)="" Q
	I ACT=2 K ^FB583(FBIX,FBZ,FBZ(1),FBZ(2),DA)
	Q

FBUCDD1
FBUCDD1	;ALBISC/TET - DD UTILITY (cont'd.)
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DEL(DA)	;del node on .01 field of 162.7, unauthorized claim file
	;INPUT:  DA = ien of 162.7
	I 1 N FBORDER,FBZ S FBZ=$$FBZ^FBUCUTL(DA) S FBORDER=$$ORDER^FBUCUTL(+$P(FBZ,U,24)) W ! W:FBORDER'<40 "Disposition to Cancel/Withdrawn." W:FBORDER<40 "Use the Delete Unauthorized Claim option." W !
	Q
DEV(X)	;input transform on field 33, UNAUTHORIZED CLAIM PRINTER, file 161.4
	;check x, and if x is a device, with subtype beginning with p(rinter)
	;INPUT:  X - FM variable, input
	;OUTPUT: 1 to kill x (invalid entry), otherwise 0
	Q $S('$D(X):1,'$$DEVICE(X):1,1:0)
	;
SUBTYPE(X)	;extrinsic call for subtype check
	;INPUT:  X = internal entry of device
	;OUTPUT: 1 if subtype is a printer
	N Z1,Z2 S Z1=$S('$D(X):0,'+X:0,1:X),Z2=0 S Z2=+$G(^%ZIS(1,X,"SUBTYPE")),Z2=$P($G(^%ZIS(2,Z2,0)),U)
	Q $S(Z2']"":0,$E(Z2,1)="P":1,1:0)
	;
DEVICE(X)	;extrinsic call for device ien
	;INPUT:  X = name
	;OUTPUT: 1 if device with printer subtype
	N Z1 S Z1=0,Z1=+$O(^%ZIS(1,"B",X,0))
	Q $S('Z1:0,'$$SUBTYPE(Z1):0,1:1)
	;
XHELP	;executable help from field 33, UNAUTHORIZED CLAIM PRINTER, file 161.4
	;displays printer selection
	D HOME^%ZIS H 1 W @IOF,!,"Select a printer device name.",!,"NOTE:  This is not a pointer field, the exact name must be entered."
	W !!,?5,"Printer name:",?40,"Location:",!,?5,"-------------",?40,"---------"
	N FBX,FBXZ,FBX1 S FBX=0 F  S FBX=$O(^%ZIS(1,FBX)) Q:'FBX  I $$SUBTYPE(FBX) S FBXZ=$G(^%ZIS(1,FBX,0)),FBX1=$G(^(1)) D  G:$D(DTOUT)!($D(DUOUT)) XHELPQ
	.I ($Y+5)>IOSL S DIR(0)="E" D ^DIR K DIR Q:$D(DTOUT)!($D(DUOUT))  W @IOF,!!,?5,"Printer name:",?40,"Location:",!,?5,"-------------",?40,"---------"
	.W !?5,$P(FBXZ,U),?40,$P(FBX1,U)
XHELPQ	W ! K DIR,DTOUT,DUOUT Q
ID(Y)	;display identifiers
	N FBZ S FBZ=$$FBZ^FBUCUTL(+Y)  Q:Y']""  W ?15,$E($$VET^FBUCUTL(+$P(FBZ,U,4)),1,20),?38,$E($$VEN^FBUCUTL(+$P(FBZ,U,3)),1,20)
	W ?61,$E($$PROG^FBUCUTL(+$P(FBZ,U,2)),1,14),!,$E($P($$PTR^FBUCUTL("^FB(162.92,",+$P(FBZ,U,24)),U),1,16)
	W ?19,"TREATMENT FROM: ",$$DATX^FBAAUTL(+$P(FBZ,U,5)),?44,"TREATMENT TO: ",$$DATX^FBAAUTL(+$P(FBZ,U,6))
	W ! Q
	;
DELA(DA,M)	;delete authorization node
	;INPUT:  DA = ien of authorization (161.01)
	;        DA(1)= ien of patient (161)
	;        M=message (optional) 1 to print;0 to not print
	;VAR:  M, 2nd piece = message to print:  1 for payments, 2 for 7078/583
	;OUTPUT: 1 if ok to delete; 0 if should not delete
	;        message may write explaining why cannot delete
	I $S('$G(DA):1,'$G(DA(1)):1,1:0) G DELAQ
	S:'$G(M) M=0
	N FBI,FBV,FBVAR
	S FBVAR=$P($G(^FBAAA(DA(1),1,DA,0)),U,9),FBV=+$P($G(^FBAAA(DA(1),1,DA,0)),U,4),FBI=0
	F  S FBI=$O(^FBAAC(DA(1),1,FBV,1,FBI)) Q:'FBI!($P(M,U,2))  S FBI(0)=$G(^FBAAC(DA(1),1,FBV,1,FBI,0)) I $P(FBI(0),U,4)=DA S $P(M,U,2)=1
	I FBVAR]"",$$PAY^FBUCUTL($P(FBVAR,";"),$P(FBVAR,";",2)) S $P(M,U,2)=1
	I '$P(M,U,2),FBVAR]"" S $P(M,U,2)=2
	I +M,$P(M,U,2) W !! D  W !
	.W:$P(M,U,2)=1 "Cannot delete Authorization because payments already exist!"
	.W:$P(M,U,2)=2 "Cannot delete Authorization because a 7078/583 entry has already been established!"
DELAQ	Q $S('+$P($G(M),U,2):0,$P(M,U,2):1,1:0)

FBUCDIS
FBUCDIS	;AISC/TET-DISPLAY UNAUTHORIZED CLAIM(583)
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN	D HOME^%ZIS N FBCRT,FBOUT,FBPG,FBX S FBOUT=0,FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBPG=0
	W !! D IEN^FBUCUTL3 G:'FBIEN END ;select claim
	D DISP7^FBUCUTL5(FBIX,FBIEN,0) ;set array of claims
	D DISPX^FBUCUTL1(0) ;display claims
	S FBAR=$G(^TMP("FBAR",$J,"FBAR")) I 'FBAR G END ;W !!,"No data on file." G EN
	S FBOUT=0,DIR("??")="^D DISPX^FBUCUTL1(0)",DIR(0)="N^1:"_+FBAR_":0",DIR("A")="Select the claim which you would like to display" D ^DIR K DIR S:$D(DIRUT) FBOUT=1 G END:+$G(FBOUT),EN:'+Y
DIS	;display claim
	D PAGE
	S FBDA=+$G(^TMP("FBAR",$J,+Y)),DA=FBDA,DR="",DIQ(0)="C",DIC="^FB583(" D EN^DIQ K DIQ
	K FBAR,^TMP("FBAR",$J)
PEND	;display incomplete items if information pending
	I IOSL<($Y+10) D PAGE G:FBOUT END
	I $$PEND^FBUCUTL(FBDA) S FBX="< PENDING INFORMATION >" W !!?(IOM-$L(FBX)/2),FBX,!  D DISP8^FBUCUTL5(FBDA),DISPX^FBUCUTL1(0) K FBAR,^TMP("FBAR",$J)
	G:FBOUT END
PAY	;check if any payments
	I IOSL<($Y+5) D PAGE G:FBOUT END
	I $$PAY^FBUCUTL(FBDA,"FB583(") S FBX="< PAYMENTS ON FILE >" W !!?(IOM-$L(FBX)/2),FBX,!
LINK	;check for associates
	I IOSL<($Y+10) D PAGE G:FBOUT END
	S FBX="< ASSOCIATED CLAIMS >" I $$LINK^FBUCLNK1(FBDA,FBIX,1) W !!?(IOM-$L(FBX)/2),FBX,! D DISPX^FBUCUTL1(0) ;D ENTER^FBUCLNK1(FBDA,$$FBZ^FBUCUTL(FBDA),0)
END	;kill and quit
	;I 'FBOUT,IOSL<($Y+10) D PAGE ;option defined as display, menuman to handle
	K DA,DR,DFN,DIC,DIRUT,DTOUT,DUOUT,FB,FBAAOUT,FBDA,FBDX,FBI,FBIEN,FBIN,FBIX,FBLISTC,FBVEN,FBVID,J,K,Q,S,VA,VADM,X,Y,ZZ,FBPROC,L,VAERR,FBINODE,FBNODE,FBPRGNAM,FBPROG D KILL^FBPAY
	K FBARY,^TMP("FBARY",$J),^TMP("FBAR",$J) Q
PAGE	;write new page
	D:FBCRT&(FBPG>0) CR Q:FBOUT
HDR	W:FBCRT!(FBPG>0) @IOF S FBPG=FBPG+1
	;W !,FBHDR,!?70,"Page: ",FBPG,!,$S(FBIX="AVMS":"Veteran",1:"Vendor"),?34,"Fee Program",?53,"Status",?75,"Code",!,FBDASH
	Q
CR	;ask end of page prompt
	;OUTPUT: FBOUT is set if time out or up arrow out
	W ! S DIR(0)="E" D ^DIR S:$D(DTOUT)!($D(DUOUT)) FBOUT=1
	Q
	S FBDA=FBDA_";FB583(",FBLISTC=1,FBOUT=0,FBAAOUT="",Q="",$P(Q,"-",80)="-",FB("PD")=0
	F FBI=0:0 S FBI=$O(^FBAAI("E",FBDA,FBI)) Q:FBI'>0!(FBAAOUT)  S FBNODE=$G(^FBAAI(FBI,0)) I FBNODE]"" S FB("PD")=FB("PD")+$P(FBNODE,U,9) D VET^FBCHDI S FB("DFN")=DFN D EN^FBCHDI Q:$G(FBOUT)
	D END G EN
HED	W !?25,"ASSOCIATED INVOICES",!,?24,$E(Q,1,21),!
	Q
OPT	I $O(^FBAAC("AM",FBDA,0)) F II=0:0 S II=$O(^FBAAC("AM",FBDA,FB("DFN"),II)) Q:'II  F JJ=0:0 S JJ=$O(^FBAAC("AM",FBDA,FB("DFN"),II,JJ)) Q:'JJ  F KK=0:0 S KK=$O(^FBAAC("AM",FBDA,FB("DFN"),II,JJ,KK)) Q:'KK  D GETPD
	K II,JJ,KK Q
GETPD	I $D(^FBAAC(FB("DFN"),1,II,1,JJ,1,KK,0)) S FB("PD")=FB("PD")+$P(^(0),"^",3) Q
	;
RETURN	;return address display/edit
	N FBCT,FBCRT,FBDIS,FBED,FBI,FBOUT,FBPG,FBSADD,FBX D HOME^%ZIS S FBOUT=0,FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBPG=0 G:'FBCRT END
	;display return address
RETDIS	D STATADD^FBUCUTL2 ;get station address
	D PAGE
	S (FBCT,FBI)=0 F  S FBI=$O(FBSADD(FBI)) Q:'FBI  S FBX=FBSADD(FBI) W !?(IOM-$L(FBX)/2),FBX S FBCT=FBCT+1
	;edit return address
	W !!! S DIR("A")="Do you wish to edit",DIR("B")="No",DIR(0)="Y" D ^DIR K DIR G END:$D(DIRUT) S FBED=+Y,FBDIS=0
	G:'FBED END
	S DIE="^FBAA(161.4,",DA=1,DR="35.6;1;2;16;3;4;5" D LOCK^FBUCUTL(DIE,DA) I FBLOCK D ^DIE L -^FBAA(161.4,DA)
	K DA,DIE,DR,FBLOCK
	W !! S DIR("A")="Do you wish to display return address",DIR("B")="Yes",DIR(0)="Y" D ^DIR K DIR G END:$D(DIRUT) S FBDIS=+Y,FBED=0
	G END:'FBDIS G END:FBOUT K FBSADD G RETDIS

FBUCDUP
FBUCDUP	;ALBISC/TET - Duplicate check of claims ;4/28/93  11:14
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
BUILD	;build display array of potential duplicates
	;INPUT:  FBVET - ien of veteran
	;        FBVEN - ien of vendor
	;        FBTFROM - from treatment date of claim
	;        FBTTO - to treatment date of claim
	;OUTPUT: FBDISP( - array of claims within same date range
	N DTOUT,DUOUT
	G:'$D(^FB583("APF",FBVET)) END N FBFROM,FBDA,NODE S FBFROM=FBTFROM-.1 ;S FBFROM=$$CDTC^FBUCUTL(FBTFROM,-730),FBFROM=FBFROM-.1
	F  S FBFROM=$O(^FB583("APF",FBVET,FBFROM)) Q:'FBFROM!(FBFROM>FBTFROM)  D
	.S FBDA=0 F  S FBDA=$O(^FB583("APF",FBVET,FBFROM,FBDA)) Q:'FBDA  S NODE=$G(^FB583(FBDA,0)) I $P(NODE,U,6)=FBTTO,$P(NODE,U,3)=FBVEN S FBDISP(FBDA)=NODE
	.;S FBDA=0 F  S FBDA=$O(^FB583("APF",FBVET,FBFROM,FBDA)) Q:'FBDA  S:'$O(FBDISP(FBDA)) FBDISP(FBDA)=$G(^FB583(FBDA,0))
	;Q
LIST	;display array of potential duplicates
	;INPUT:  FBDISP( - array of claims within same date range of submitted
	;OUTPUT: formatted display of list; FBOUT for uparrow or timeout
	G:'$D(FBDISP) END N FBPG,FBCRT,FBTITLE,FBDASH,FBDA,FBZ,FBOUT
	S FBPG=0,FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBTITLE="POTENTIAL DUPLICATES",$P(FBDASH,"=",80)="",FBOUT=0
	D HDR S FBDA=0 F  S FBDA=$O(FBDISP(FBDA)) G:'FBDA END D
	.D:($Y+3)>IOSL PAGE Q:FBOUT  S FBZ=FBDISP(FBDA)
	.W !,FBDA,?10,$E($$VET^FBUCUTL($P(FBZ,U,4)),1,25),?40,$E($$VEN^FBUCUTL($P(FBZ,U,3)),1,25),?70,$E($$PROG^FBUCUTL($P(FBZ,U,2)),1,10)
	.W !?5,"TREATMENT FROM: ",$$DATX^FBAAUTL($P(FBZ,U,5)),?40,"TREATMENT TO: ",$$DATX^FBAAUTL($P(FBZ,U,6))
	;
END	Q
HDR	;header of list display
	I FBPG>0!FBCRT W @IOF
	S FBPG=FBPG+1
	W !?(IOM-$L(FBTITLE)/2),FBTITLE
	W !,"No.",?10,"VETERAN",?40,"VENDOR",?70,"PROGRAM",!
	Q
CR	;carriage return
	S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q
PAGE	;new page
	I FBCRT D CR I 'FBOUT D HDR
	Q

FBUCED
FBUCED	;ALBISC/TET - EDIT UNAUTHORIZED CLAIM FILES ;7/7/93  18:55
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EDT	;edit unauthorized claim with order less than 40 (not dispositioned
	;or order = 40 if action is reopen (called by REO tag)
	S:'$D(FBACT) FBACT="EDT" S FBO=$S(FBACT="EDT":"5^10^20^30^",1:"40^")
	D LOOKUP^FBUCUTL3(FBO) I 'FBOUT S FBDR="[FB UNAUTHORIZED EDIT]" D EDIT^FBUCED0(FBDR,FBACT,.FBOUT,FBARY)
	G END Q
REO	;reopen a dispositioned claim (order of 40)
	S FBACT="REO" G EDT
	Q
APL	;appeal a dispostioned claim (order of 40)
	S FBACT="APL",FBO="40^" D LOOKUP^FBUCUTL3(FBO) I 'FBOUT S FBDR="[FB UNAUTHORIZED APPEAL]" D EDIT^FBUCED0(FBDR,FBACT,.FBOUT,FBARY)
	G END Q
AED	;edit an appeal to an unauthorized claim
	S FBACT="AED",FBO="50^55^60^70^" D LOOKUP^FBUCUTL3(FBO) I 'FBOUT S FBDR="[FB UNAUTHORIZED APPEAL EDIT]" D EDIT^FBUCED0(FBDR,FBACT,.FBOUT,FBARY)
	G END Q
COVA	;enter/edit a COVA appeal
	S FBACT="COVA",FBO="70^80^90^" D LOOKUP^FBUCUTL3(FBO) I 'FBOUT S FBDR="[FB UNAUTHORIZED COVA APPEAL]" D EDIT^FBUCED0(FBDR,FBACT,.FBOUT,FBARY)
	G END Q
DIS	;disposition an appeal
	S FBACT="DIS",FBO=0 D LOOKUP^FBUCUTL3(FBO) I 'FBOUT S FBDR="[FB UNAUTHORIZED DISPOSITION]" D EDIT^FBUCED0(FBDR,FBACT,.FBOUT,FBARY)
	G END Q
REC	;receive information which was requested
	S FBACT="REC",FBO="5^10^50^55^" D LOOKUP^FBUCUTL3(FBO) I 'FBOUT,+$G(FBARY) H:+FBARY=1 1 D EDIT8
	G END
REQ	;request information
	S FBACT="REQ",FBO="5^10^20^30^50^55^" D LOOKUP^FBUCUTL3(FBO) I 'FBOUT,+$G(FBARY) D EDIT8
	G:$G(FBOUT) END D END W !! G REQ
LET	;to update date letter printed without printing letter
	N FBLETDT D DISPNP^FBUCUTL3 ;set array of letters which are waiting to be printed
	D DISPX^FBUCUTL1(1) ;display array for selection
	I 'FBOUT,+$G(FBARY) D LETDATE^FBUCUTL3 I 'FBOUT D
	.N FBDA,FBEXP,FBI,FBLET,FBNODE,FBPL,FBUCA D PARSE^FBUCUTL4(FBARY) S FBI=0,FBLET="@" S FBLETDT=$S('+FBLETDT:DT,1:FBLETDT)
	.F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBNODE=$G(^(FBI)),FBDA=+FBNODE,FBUCA=$G(^FB583(FBDA,0)),FBEXP=$$EXPIRE^FBUCUTL8(FBDA,FBLETDT,FBUCA,$$ORDER^FBUCUTL($P(FBUCA,U,24))) D EDITL(FBDA,FBEXP,FBLET,FBLETDT)
	G END
REQENT	;enter/edit requested information file, 162.93
	S DLAYGO=162.93,DIC(0)="AELMQZ",DIC="^FB(162.93," D ^DIC K DLAYGO I +Y>0 S DIE=DIC,DA=+Y,FBDA=DA,DR=".01:1" D LOCK^FBUCUTL(DIE,FBDA,0) I FBLOCK D ^DIE L -^FB(162.93,FBDA) K DIE,DE,DA,DQ,DR,FBDA,FBLOCK W ! G REQENT
END	;kill and quit
	K DA,DE,DIC,DIE,DQ,DR,DTOUT,DUOUT,FBACT,FBAR,FBARY,FBDR,FBIEN,FBIX,FBLOCK,FBO,FBOUT,FBUCPDX,X,Y
	K ^TMP("FBAR",$J),^TMP("FBARY",$J),^TMP("FBPARY",$J) Q
EDIT8	;edit file 162.8, call before/after & update
	N FBDA,FBI,FBNODE,FBP,FBPL,FBUCA,FBUCAA,FBUCP,FBUCPA,FBW D PARSE^FBUCUTL4(FBARY) S %X="^TMP(""FBARY"",$J,",%Y="^TMP(""FBPARY"",$J," D %XY^%RCR K %X,%Y
	S FBI=0 F  S FBI=$O(^TMP("FBPARY",$J,FBI)) Q:'FBI  S FBNODE=$G(^(FBI)),FBDA=+FBNODE,FBNODE=$P(FBNODE,";",2) D  G:FBOUT END
	.I +$G(FBPARY)>1 W !! F FBP=1:1:FBPL W ?($P(FBW,U,FBP)),$P(FBNODE,U,FBP)
	.D PRIOR^FBUCEVT(FBDA,FBACT)
	.N FBARY D REQ^FBUCPEND:FBACT="REQ",REC^FBUCPEND:FBACT="REC" Q:FBOUT  D FREQ^FBUCPEND:FBACT="REQ",FREC^FBUCPEND:FBACT="REC"
	.D AFTER^FBUCEVT(FBDA,FBACT),^FBUCUPD(FBUCP,FBUCPA,FBUCA,FBUCAA,FBDA,FBACT)
	Q
EDITL(FBDA,FBEXP,FBLET,FBLETDT)	;edit letter sent info,
	;may be called to just update expiration, or update print flag, date letter sent &/or expiration
	;INPUT:  FBDA = ien of unauthorized claim (# 162.7)
	;        FBEXP = expiration date (optional)
	;        FBLET = flag for letter printed (optional)
	;        FBLETDT = date letter sent (optional)
	;        FBLET = '@' to delete letter flag
	;        FBEXP = expiration date or 0
	;OUTPUT: nothing -  update all or some flds in 162.7:  19,19.5,26
	Q:'+$G(FBDA)  S FBEXP=+$G(FBEXP),FBLET=$G(FBLET),FBLETDT=+$G(FBLETDT) I 'FBEXP,FBLET']"",'FBLETDT Q
	N FBLOCK,DIE,DA,DR S DIE="^FB583(",DR="[FB UNAUTHORIZED LETTER UPDATE]",DA=FBDA
	D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FB583(FBDA) K FBLOCK
	Q

FBUCED0
FBUCED0	;ALBISC/TET - UPDATE UNAUTHORIZED GROUP ;3/17/94  09:24
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EDIT(FBDR,FBACT,FBOUT,FBARY)	;called from fbuced, edit to 162.7
	;INPUT:  FBDR = template to be edited
	;        FBACT = action on claim (DIS = disposition, REO = reopen, etc)
	;        FBOUT = exit flag, 1 to exit
	;        FBARY = count;positions of output array in tmp(fbary
	;OUTPUT: FBOUT = 1 if exited
	;        update unauthorized claim
	;get fbda from array
	Q:'+$G(FBARY)!($G(FBDR)']"")!($G(FBACT)']"")  S FBOUT=+$G(FBOUT)
	N FBDIRA,FBDA,FBI,FBNODE,FBPL,FBW D PARSE^FBUCUTL4(FBARY)
	S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBNODE=$G(^(FBI)),FBDA=+$P(FBNODE,";") D  Q:FBOUT
	.N DA,DIE,DR,FBALL,FBDISP,FBGROUP,FBUCA,FBUCAA,FBUCP,FBUCPA,FBUCPDX,FBY,Y
	.I +$G(FBARY)>1 D LINE^FBUCUTL4(FBNODE,FBI,FBPL,FBW)
	.D PRIOR^FBUCEVT(FBDA,FBACT) S:FBACT="EDT"!(FBACT="REO") FBUCPDX=$G(^FB583(FBDA,"DX"))
	.S DIE="^FB583(",DA=FBDA,DR=FBDR,FBDISP=0 D LOCK^FBUCUTL(DIE,DA,0) I FBLOCK D ^DIE I $D(DTOUT) S FBOUT=1,DR="[FB UNAUTHORIZED PREVIOUS]",DA=FBDA D AFTER^FBUCEVT(DA,FBACT),^DIE L -^FB583(FBDA) K FBLOCK
	.I 'FBOUT S FBY=$S($D(Y):1,1:0) D AFTER^FBUCEVT(FBDA,FBACT) L -^FB583(FBDA) K FBLOCK D CKAUTH^FBUCUTL6(FBUCP,.FBUCA,FBDA),^FBUCUPD(FBUCP,FBUCPA,FBUCA,FBUCAA,FBDA,FBACT) I FBACT="REO",'FBY&($$EDOK^FBUCUTL3(FBDA)) D
	..;keep authoriziation info in synch for claim being edited via reopen
	..N DA,DIE,DR,FBAIEN,FBAUTH,FBIEN,FBLOCK S FBAUTH=$$AUTH^FBUCUTL6(FBUCP,FBUCA)
	..Q:FBAUTH=1!(FBAUTH=0)  S FBAIEN=+$P(FBUCA,U,27) Q:'FBAIEN  S FBIEN=FBAIEN
	..S DA=+$P(FBUCP,U,4),DIE="^FBAAA(",DR="[FB UNAUTHORIZED EDIT]"
	..D LOCK^FBUCUTL(DIE,DA,0) I FBLOCK D ^DIE L -^FBAAA(+$P(FBUCP,U,4)) S:$D(DTOUT) FBOUT=1 K DTOUT
	.;keep veteran & treatment from/to (what constitutes a group) in synch for rest in group
	.S FBALL=0 D GROUP^FBUCUTL7(FBUCP,FBDA),DISPLAY^FBUCUTL7(FBDA,.FBGROUP)
	.I +$G(FBDISP),$P(FBUCP,U,4,6)'=$P(FBUCA,U,4,6) S FBDIRA="Shall other claims be updated to same veteran & treat. from/to dates" D READ^FBUCUTL7(FBDIRA,.FBOUT,.FBDISP) D  Q:FBOUT
	..I FBOUT S FBALL=0 ;if timeout during read, force an unlink
	..I 'FBALL D UNLINK^FBUCLNK1(.FBGROUP,FBDA,FBUCA) Q  ;unlink claim module
	..I FBALL D
	...N FBDR
	...S FBDR="S:'+$P(FBUCA,U,4) Y=""@1"";2////^S X=+$P(FBUCA,U,4);S Y=3;@1;2///@;S:'+$P(FBUCA,U,5) Y=""@2"";3////^S X=+$P(FBUCA,U,5);S Y=4;@2;3///@;S:'+$P(FBUCA,U,6) Y=""@3"";4////^S X=+$P(FBUCA,U,6);S Y=""@99"";@3;4///@;@99"
	...N FBI,FBLOCK S FBI=0 F  S FBI=$O(FBGROUP(FBI)) Q:'FBI  I FBI'=FBDA D DIE^FBUCUTL2("^FB583(",FBI,FBDR)
	.;if reopen or disposition, keep disposition and auth from/to dates in synch for same dispostion for rest in group, also keeps respective authorization in 161.01 in synch
	.I $S(FBUCA']"":1,FBACT'="REO"&(FBACT'="DIS")&(FBACT'="EDT"):1,FBACT="EDT"&(+$P(FBGROUP,U,5)):0,+$P(FBUCP,U,11)'=+$P(FBUCA,U,11)!($P(FBUCP,U,13,14)'=$P(FBUCA,U,13,14)):0,1:1) Q
	.S FBALL=0 D DISPLAY^FBUCUTL7(FBDA,.FBGROUP,"^"_+$P(FBUCP,U,24)_"^",+$P(FBUCP,U,11)) Q:'+FBDISP
	.I +$P(FBUCP,U,11)'=+$P(FBUCA,U,11) S FBDIRA="Shall all other claims be updated to the disposition" S:$P(FBUCP,U,13,14)'=$P(FBUCA,U,13,14) FBDIRA=FBDIRA_" & auth. from/to dates"
	.I $P(FBUCP,U,11)=$P(FBUCA,U,11) S FBDIRA="Shall all other claims be updated to the auth. from/to dates"
	.D READ^FBUCUTL7(FBDIRA,.FBOUT,.FBDISP) I 'FBALL!(FBOUT) Q
	.I +$P(FBUCA,U,11)'=+$P(FBUCP,U,11),('($P(FBUCA,U,11)=1!($P(FBUCA,U,11)=4))) S DIR(0)="Y",DIR("A")="Shall disapproval reason apply to all other claims" D ^DIR K DIR Q:$D(DIRUT)  S FBUCDISR=Y I Y D FBUCDISR(FBDA)
	.D  K FBUCDISR
	..N FBDR,FBI,FBODA,FBUCP,FBUCPA
	..S FBDR="S:'+$P(FBUCA,U,13) Y=""@1"";12////^S X=+$P(FBUCA,U,13);S Y=13;@1;12///@;S:'+$P(FBUCA,U,14) Y=""@2"";13////^S X=+$P(FBUCA,U,14);S Y=10;@2;13///@;S:'+$P(FBUCA,U,11) Y=""@3"";10////^S X=+$P(FBUCA,U,11);S Y=""@99"";@3;10///@;@99"
	..S FBODA=FBDA,FBI=0 F  S FBI=$O(FBDISP(FBI)) Q:'FBI  I FBI'=FBODA D PRIOR^FBUCEVT(FBI,FBACT) D DIE^FBUCUTL2("^FB583(",FBI,FBDR) N FBUCA,FBUCAA D AFTER^FBUCEVT(FBI,FBACT) S FBDA=FBI D ^FBUCUPD(FBUCP,FBUCPA,FBUCA,FBUCAA,FBI,FBACT,$G(FBUCDISR))
	Q
FBUCDISR(FBDA)	;set up fbucdisr with disap. reasons for primary claim
	;INPUT:  ien of unauthorized claim (usually primary)
	;OUTPUT: fbucdisr=1^   (1 indicates user wishes for all linked
	;                 claims to contain same disapproval reason as primary
	;                 pieces following will contain the pointer values
	;                 of the disap. reasons for the primary del by ^
	N I
	I $D(^FB583(FBDA,"D")) S I=0 F  S I=$O(^FB583(FBDA,"D",I)) Q:'I  S FBUCDISR=FBUCDISR_"^"_+^FB583(FBDA,"D",I,0)
	Q

FBUCED1
FBUCED1	;ALBISC/TET - EDIT UNAUTHORIZED CLAIM, cont'd
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DEL	;deletes unauthorized claim(s); if any pending info will delete also
	;only claims which have not been dispositioned can be deleted.
	N FBACT,FBO,DIRUT,DTOUT,DUOUT,Y S FBACT="DEL",FBO="5^10^30^" D LOOKUP^FBUCUTL3(FBO) G END^FBUCED:FBOUT!('+$G(FBARY))
	N FBALL,FBDA,FBI,FBNODE,FBOUT,FBPL,FBW,FBZ S (FBALL,FBOUT)=0 D PARSE^FBUCUTL4(FBARY)
	S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBNODE=$G(^(FBI)),FBDA=+$P(FBNODE,";"),FBZ=$$FBZ^FBUCUTL(FBDA) I FBZ]"" D  G:FBOUT DELQ
	.N FBDISP,FBGROUP D LINE^FBUCUTL4(FBNODE,FBI,FBPL,FBW)
	.N Y,DIRUT,DTOUT,DUOUT S DIR("A")="Are you sure you wish to delete",DIR("B")="Y",DIR(0)="Y" D ^DIR K DIR S:$D(DIRUT) FBOUT=1 Q:'Y
	.D GROUP^FBUCUTL7(FBZ,FBDA),DISPLAY^FBUCUTL7(FBDA,.FBGROUP,"^5^10^30^",+$P(FBZ,U,11))
	.I $$PRIME^FBUCUTL4(FBDA,FBZ) D PRIME^FBUCLNK1(.FBGROUP,FBDA,FBZ)
	.I +FBDISP D  Q:FBOUT
	..N DA,DIK,FBDIRA,FBI S FBDIRA="Shall all of these claims be deleted"
	..D READ^FBUCUTL7(FBDIRA,.FBOUT,.FBDISP) Q:FBOUT!('FBALL)
	..S FBI=0,DIK="^FB583(" F  S FBI=$O(FBGROUP(FBI)) Q:'FBI  I FBI'=FBDA S DA=FBI D ^DIK I $$PEND^FBUCUTL(FBDA) D PENDDEL(FBI)
	.W !,"Deleting claim" W $S('FBALL:"...",1:" and associated claims not dispositioned ...") S DA=FBDA,DIK="^FB583(" D ^DIK K DA,DIK
	.I $$PEND^FBUCUTL(FBDA) D PENDDEL(FBDA)
DELQ	D END^FBUCED Q
PENDDEL(FBDA)	;delete pending information on unauthorized claim
	;INPUT:  FBDA = internal entry number of unauthorized claim
	;OUTPUT: none - pending information is deleted from file 162.8
	Q:'$G(FBDA)  N FBPEND,DA,DIK S DIK="^FBAA(162.8,",FBPEND=0
	F  S FBPEND=$O(^FBAA(162.8,"AC",FBDA,0)) Q:'FBPEND  S DA=FBPEND D ^DIK K DA
	Q

FBUCEN
FBUCEN	;ALBISC/TET - ENTER UNAUTHORIZED CLAIM ;9/23/93  12:37
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;FBUC - unauthorized claims site parameter node
	;FBTRACK - 1 to track incomplete claims, 0 to track complete claims only
	;FBUCP - 0 to not automatically print letters, otherwise default device
	;FBOK - 0 if claim is incomplete, 1 if claim is complete.
	;FBACT - ENT for enter (fbact represents action type)
	;FBINENT = initial entry parameter: 1 if using, 0 if not
	S FBOUT=0,FBUC=$$FBUC^FBUCUTL2(1),FBTRACK=+$P(FBUC,U),FBOK=$S('FBTRACK:1,1:0),FBACT="ENT",FBINENT=+$P(FBUC,U,7)
GET	;get info on new claim entry
	K FBVEN,FBVET
VET	;get vet info
	K DIR W !! S DIR(0)="162.7,2O",DIR("A")="Select VETERAN" D ^DIR K DIR G END:$D(DIRUT),VET:+Y'>0 S FBVET=+Y
VEN	;get vendor info
	S DIR(0)="162.7,1O",DIR("A")="Select FEE VENDOR" D ^DIR K DIR G VET:$D(DUOUT)!($D(DTOUT)),VEN:+Y<0,VEN:+Y=0&('FBINENT) S FBVEN=+Y
PROG	S DIC="^FBAA(161.8,",DIC(0)="AEQMZ",DIC("S")="I +$P(^(0),U,3)" D ^DIC K DIC S:$D(DTOUT)!($D(DUOUT)) FBOUT=1 G END:FBOUT,GET:Y<0 S FBPR=+Y D  S:FBOUT FBOUT=0 G VET
	.N FBDA,FBMASTER,FBORDER,FBTFROM,FBTTO
	.D ASKDT Q:FBOUT  I FBTRACK,'FBINENT D  Q:FBOUT
	..S DIR(0)="Y",DIR("A")="Is the unauthorized claim complete for the FEE PROGRAM" D DIRQ,^DIR K DIR S:$D(DIRUT) FBOUT=1 S:'FBOUT FBOK=Y Q:FBOUT!(FBOK)
	..D REQ^FBUCPEND Q:FBOUT  S FBORDER=10 ;display/select pending information,set status order to incomplete if selected pending items
	.;check for duplicates
	.I 'FBINENT W !,"Checking for potential duplicates...",! H 1 D ^FBUCDUP
	.W !!,"Checking eligibility...",! H 1 S DFN=FBVET D ELIG^VADPT W:VAEL(4)'=1 !,"Patient is not a veteran.",*7 D ELIG^FBAADEM K VAEL,VAERR
	.W ! S DIR("A")="Are you sure you wish to enter a new unauthorized claim",DIR(0)="Y" D ^DIR K DIR S:'Y!($D(DIRUT)) FBOUT=1 Q:FBOUT
	.;file new claim
	.S DIC="^FB583(",DIC(0)="Z",X=DT K DD,DO D FILE^DICN S FBOUT=$S($P(Y,U,3):0,1:1) Q:FBOUT  S FBDA=+Y D PRIOR^FBUCEVT(FBDA,FBACT) D
	..S FBMASTER=FBDA,FBORDER=$S(+$G(FBORDER)=10:10,'FBINENT:30,1:5)
	..S DIE=DIC,DIE("NO^")="BACKOUTOK",DR="[FB UNAUTHORIZED ENTER]",DA=FBDA
	..D LOCK^FBUCUTL(DIE,DA,1) S:'FBLOCK FBOUT=1 Q:FBOUT  D ^DIE L -^FB583(FBDA) K DA,DIE,DQ,DR,FBLOCK I $D(Y)!($D(DTOUT)) S DIK=DIC,DA=FBDA D ^DIK K DIK W !,"... Deleting incomplete record.",*7 S FBOUT=1 Q
	..I FBORDER=10 D FREQ^FBUCPEND ;file requested info
	..K ^TMP("FBARY",$J),^TMP("FBAR",$J)
	.D AFTER^FBUCEVT(FBDA,FBACT)
	.K FBARY,FBLOCK Q:FBOUT  D ENTER^FBUCLNK1(FBDA,FBUCA,1) K FBARY,^TMP("FBARY",$J),^TMP("FBAR",$J)
	.I FBORDER'=10,+$G(FBVEN)>0,+$G(FBTTO)>0 D AFTER^FBUCEVT(FBDA,FBACT),EN^FBUCEN1(FBUCA,FBDA) ;if claim complete, check if group, any in group dispositioned
	.;do update
	.D AFTER^FBUCEVT(FBDA,FBACT),^FBUCUPD(FBUCP,FBUCPA,FBUCA,FBUCAA,FBDA,FBACT)
	;
END	;kill and quit
	K DA,DFN,DIC,DIE,DIR,DIRUT,DQ,DR,DTOUT,DUOUT,FBACT,FBARY,FBDA,FBDISP,FBINENT,FBLOCK,FBMASTER,FBOK,FBORDER,FBOUT,FBPEND,FBPI,FBPR,FBPROG
	K FBSTATUS,FBTFROM,FBTRACK,FBTTO,FBUC,FBUCA,FBUCP,FBUCAA,FBUCP,FBUCPA,FBVEN,FBVET,X,Y,^TMP("FBAR",$J),^TMP("FBARY",$J)
	Q
ASKDT	;ask treatment from/to dates
	S DIR(0)="162.7,3" S:FBPR=6 DIR("A")="ADMISSION DATE" D ^DIR K DIR S:'+Y DIRUT="^" S:$D(DIRUT) FBOUT=1 S:'FBOUT FBTFROM=Y
	I 'FBOUT S DIR(0)="162.7,4O" S:FBPR=6 DIR("A")="DISCHARGE DATE" S:FBPR'=6&(FBPR'=7) DIR("B")=$$DATX^FBAAUTL(FBTFROM) D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1 I 'FBOUT,'FBINENT G:+Y'>0!(FBTFROM>Y) ASKDT S FBTTO=Y
	I 'FBOUT S FBTTO=+Y
	Q
HELP	;help text for complete claim question - ??
	W !?10,"An unauthorized claim is considered complete (or valid)"
	W !?10,"if all the necessary information has been received."
	W !?10,"A claim can never be considered complete if it is missing"
	W !?10,"form 10-583 or form 10-583 is incomplete."
	W !?10,"Some examples of other items which are needed are:"
	W !?20,"Copies of actual bills",!?20,"Original paid receipt"
	W !?20,"Itemized invoice/UB82",!?20,"Medical records or signature for release"
	W !?20,"Diagnostic/Procedure code(s)",!
	Q
DIRQ	;set dir(?,#)
	S DIR("?")="Enter Y(es) if complete, N(o) if incomplete."
	S DIR("??")="^D HELP^FBUCEN"
	S DIR("?",1)="Enter Y(es) if all required information has been submitted,"
	S DIR("?",2)="      N(o)  if the claim is incomplete."
	S DIR("?",3)=""
	Q

FBUCEN1
FBUCEN1	;ALBISC/TET - UNAUTH CLAIM ENTER (CONT'D.)
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EN(FBZ,FBDA)	;entry point from fbucen: check if group, and any in group dispositioned
	; if any are, ask if claim being entered should be dispostioned
	; disposition new claim to what user selects
	;INPUT:  FBZ = zero node of unauth claim
	;        FBDA = ien of unauth claim
	N DA,DIE,DIRUT,DR,DTOUT,DUOUT,FBALL,FBC,FBD,FBDIRA,FBGCT,FBDISPO,FBGROUP,FBI,FBLOCK,FBOUT,Y ;fbc=flag to determine if u/c dispo'd (1=yes)
	I $S('+$G(FBDA):1,$G(FBZ)']"":1,1:0) Q
	S (FBOUT,FBALL)=0
	D GROUP^FBUCUTL7(FBZ,FBDA) S FBGCT=+$P(FBGROUP,U,5) Q:'FBGCT  D
	.;VARIABLE:  fbdispo(ien disposition)= u/c ien ^ disposition name
	.N FBD,FBI,FBO S FBI=0
	.F  S FBI=$O(FBGROUP(FBI)) Q:'FBI  S FBO=$G(FBGROUP(FBI)),FBD=+$P(FBO,U,4) I FBD S FBDISPO(FBD)=FBI_U_$P($$PTR^FBUCUTL("^FB(162.91,",FBD),U)
	S FBC=$S(+$P(FBZ,U,11):+$P(FBZ,U,11),1:0) I FBC,FBGCT=1 Q
	I FBC D  Q:'FBGCT
	.I '$$UPOK^FBUCUTL(FBDA) F FBD=2,3,5 I $D(FBDISPO(FBD)) K FBDISPO(FBD) S FBGCT=FBGCT-1
	.Q:'FBGCT
	.W:FBGCT>1 *7,!,"The disposition for the selected claim is ",$P($G(FBDISPO(FBC)),U,2) K FBDISPO(FBC) S FBGCT=FBGCT-1
	Q:'FBGCT
	W !!,"At least one other claim in this group has been dispositioned."
	W !!,"The existing disposition(s) in the group follow:",! D
	.N FBI S FBI=0 F  S FBI=$O(FBDISPO(FBI)) Q:'FBI  W !?10,$P($G(FBDISPO(FBI)),U,2)
	;if u/c not dipo'd, ask to disp/otherwise ask to change dispo
	;if group>1 & not dispo'd, don't change prompt/if group>1 & dispo'd add to another/if group=1 add to |dispo|
	S FBDIRA=$S('FBC:"Would you like this claim to be dispositioned",1:"Would you like to change the disposition"),FBDIRA=FBDIRA_$S(FBGCT>1&('FBC):"",FBGCT>1&(FBC):" to another",1:" to ")
	S:FBGCT=1 FBDIRA=FBDIRA_$P($$PTR^FBUCUTL("^FB(162.91,",+$O(FBDISPO(0))),U),FBD=+$O(FBDISPO(0))
	D READ^FBUCUTL7(FBDIRA,.FBOUT) Q:FBOUT!('+$G(FBALL))
GETDISP	I FBGCT>1 S DIC("S")="I $D(FBDISPO(+Y))",DIC="^FB(162.91,",DIC(0)="AEMQZ" D ^DIC K DIC Q:$D(DTOUT)!($D(DUOUT))  G:+Y'>0 GETDISP S FBD=+Y
	S FBI=0,FBI=+$O(FBDISPO(+$G(FBD),0)) I FBI D
	.N FBDR,FBZ1 S FBZ1=$G(^FB583(FBI,0)) Q:FBZ1']""!('+$P(FBZ1,U,13))  S FBDR="10////^S X=FBD;12///^S X=$P(FBZ1,U,13);13///^S X=$P(FBZ1,U,14);14"
	.D DIE^FBUCUTL2("^FB583(",FBDA,FBDR)
	S DA=FBDA,DIE="^FB583(",DR="10////^S X=FBD" D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FB583(DA)
	Q

FBUCEVT
FBUCEVT	;ALBISC/TET - UNAUTHORIZED CLAIMS EVENTS ;4/28/93  11:14
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
	;INPUT:  FBUCACT = unauthorized claim action
	;          ENT=enter, EDT=edit,DEL=delete
EN	;
PRIOR(DA,X)	;set FBAP prior to enter/edit/delete
	;INPUT:  DA = unauthorized claim IEN
	;        X  = action on claim
	;OUTPUT: FBUCP = unauthorized claim 0 node
	;        FBUCPA = unauthorized claim 'A' node
	I X="ENT" S (FBUCP,FBUCPA)=""
	I X'="ENT" S FBUCP=$G(^FB583(DA,0)),FBUCPA=$G(^("A"))
	Q
AFTER(DA,X)	;set FBAA after enter/edit/delete
	;INPUT:  DA = unauthorized claim IEN
	;        X  = action on claim
	;OUTPUT: FBUCA = unauthorized claim 0 node
	;        FBUCAA = unauthorized claim 'A' node
	I X="DEL" S (FBUCA,FBUCAA)=""
	I X'="DEL" S FBUCA=$G(^FB583(DA,0)),FBUCAA=$G(^("A"))
	Q

FBUCEX
FBUCEX	;ALBISC/TET - EXPIRATION UPDATE &/OR OUTPUT ;10/4/93  16:44
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ABAND	;background update to abandoned if expiration date is met
	;on claims with status order of 10 or 55
	N FBDT,FBACT S FBACT="EDT"
	S FBO=0 F  S FBO=$O(^FB583("AES",FBO)) Q:'FBO  I "^10^55^"[FBO  S FBDT=-(DT) F  S FBDT=$O(^FB583("AES",FBO,FBDT)) Q:FBDT']""  S FBDA=0 F  S FBDA=$O(^FB583("AES",FBO,FBDT,FBDA)) Q:'FBDA  S FBZ=$G(^FB583(FBDA,0)) I FBZ]"" D
	.N FBUCA,FBUCAA,FBUCP,FBUCPA
	.D PRIOR^FBUCEVT(FBDA,"EDT") S DIE="^FB583(",DA=FBDA,DR="26///^S X=""@"";10////^S X=5"
	.D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FB583(DA) K DIE,DR,DA
	.D AFTER^FBUCEVT(FBDA,"EDT"),^FBUCUPD(FBUCP,FBUCPA,FBUCA,FBUCAA,FBDA,"EDT")
	.S ^TMP("FBEX",$J,$$VET^FBUCUTL($P(FBZ,U,4))_";"_$P(FBZ,U,4),FBDA)=$E($$VEN^FBUCUTL($P(FBZ,U,3)),1,20)_U_$E($P($$PTR^FBUCUTL("^FB(162.92,",$$STATUS^FBUCUTL(FBO)),U),1,16)_U_$$DATX^FBAAUTL($P(FBZ,U,5))_U_$$DATX^FBAAUTL($P(FBZ,U,6))
	.K FBLOCK
	G:'$D(^TMP("FBEX")) END S FBHDR="Unauthorized Claims Dispositioned to 'ABANDONED'"
PRINT	;print claims which have been dispositioned to abandoned or fall within date range to expire
	U IO S FBPG=0,FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBOUT=0,$P(FBDASH,"=",80)="" D PAGE
	S FBVET="" F  S FBVET=$O(^TMP("FBEX",$J,FBVET)) Q:FBVET']""!(FBOUT)  S FBDA=0 F  S FBDA=$O(^TMP("FBEX",$J,FBVET,FBDA)) Q:'FBDA!(FBOUT)  S FBNODE=$G(^TMP("FBEX",$J,FBVET,FBDA)) D  Q:FBOUT
	.I IOSL<($Y+5) D PAGE Q:FBOUT
	.W !,$E($P(FBVET,";"),1,20),?24,$P(FBNODE,U),?48,$P(FBNODE,U,3),?60,$P(FBNODE,U,4),?72,$E($P(FBNODE,U,2),1,8)
END	;kill variables,tmp global and quit
	K FBCRT,FBDA,FBDASH,FBDT,FBFR,FBHDR,FBLOCK,FBNODE,FBO,FBOUT,FBPG,FBPOP,FBTO,FBVET,FBZ,BEGDATE,DIR,DIRUT,DTOUT,DUOUT,ENDDATE,PGM,POP,VAL,VAR,^TMP("FBEX",$J)
	D CLOSE^FBAAUTL
	Q
PAGE	;write new page
	D:FBCRT&(FBPG>0) CR Q:FBOUT
HDR	W:FBCRT!(FBPG>0) @IOF S FBPG=FBPG+1
	W !,FBHDR,!!,?48,"Treatment",?60,"Treatment",!,"Veteran",?24,"Vendor",?51,"FROM",?64,"TO",?72,"Status",!,FBDASH
	Q
CR	;ask end of page prompt
	;OUTPUT: FBOUT is set if time out or up arrow out
	W ! S DIR(0)="E" D ^DIR S:$D(DTOUT)!($D(DUOUT)) FBOUT=1
	Q
EXPIRE	;called from print option to display/print claims due to expire within date range
	;claim will print if expiration date falls within date range user selected,
	;status order is 10 <incomplete> or 55 <appeal/stmt of case issued>,
	;and has not been abandoned (ck needed?)
	W !?3,"Select the date range within which an unauthorized claim will expire." S %DT="AEX" D DATE^FBAAUTL K %DT G:FBPOP END
	S VAR="BEGDATE^ENDDATE",VAL=VAR,PGM="DQ^FBUCEX" D ZIS^FBAAUTL G:FBPOP END
DQ	S FBFR=BEGDATE,FBTO=ENDDATE ;scratch
	S FBHDR="Unauthorized Claims Due to Expire between "_$$DATX^FBAAUTL(FBFR)_" and "_$$DATX^FBAAUTL(FBTO)
	S FBO=0 F  S FBO=$O(^FB583("AES",FBO)) Q:'FBO  I "^10^55^"[FBO S FBDT=-(FBTO-.1) F  S FBDT=$O(^FB583("AES",FBO,FBDT)) Q:FBDT']""!(FBDT>-FBFR)  S FBDA=0 F  S FBDA=$O(^FB583("AES",FBO,FBDT,FBDA)) Q:'FBDA  S FBZ=$G(^FB583(FBDA,0)) I FBZ]"" D
	.S ^TMP("FBEX",$J,$$VET^FBUCUTL($P(FBZ,U,4))_";"_$P(FBZ,U,4),FBDA)=$E($$VEN^FBUCUTL($P(FBZ,U,3)),1,20)_U_$E($P($$PTR^FBUCUTL("^FB(162.92,",$$STATUS^FBUCUTL(FBO)),U),1,16)_U_$$DATX^FBAAUTL($P(FBZ,U,5))_U_$$DATX^FBAAUTL($P(FBZ,U,6))
	I '$D(^TMP("FBEX")) S FBPG=0,$P(FBDASH,"=",80)="",FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBOUT=0 D PAGE W !,"No claims will expire within selected date range." G END
	G PRINT
	Q

FBUCLET
FBUCLET	;ALBISC/TET - UNAUTHORIZED CLAIMS LETTER ;7/7/93  18:47
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
AUTO(FBDA,FBORDER,FBUCA,FBUC)	;auto print - called by update routine, tasked job
	;INPUT:  FBDA = ien of unauthorized claim, file 162.7
	;        FBORDER = (optional) order number of status
	;        FBUCA = current (after) zero node of unauthorized claim (162.7)
	;        FBUC = unauthorized claim node in parameter file
	;OUTPUT: none - task q'd to print letter and update fields upon completion
	N ZTIO,ZTRTN,ZTDESC,ZTDTH,ZTSAVE
	I $$PARAM(FBUC) S ZTIO=$P(FBUC,U,2) I ZTIO]"" D
	.S ZTRTN="AUTODQ^FBUCLET0",ZTDESC="AUTO PRINT UNAUTH CLAIM LETTER",ZTDTH=$H
	.S ZTSAVE("FBDA")="",ZTSAVE("FBORDER")="",ZTSAVE("FBUCA")="",ZTSAVE("FBUC")=""
	.D ^%ZTLOAD
	K IOP,ZTIO,ZTRTN,ZTDESC,ZTDTH,ZTSAVE,ZTSK Q
	;
PARAM(FBUC)	;check if letter should be printed
	;check if parameter is set to print automatically, if so,
	;check if printer is defined, if so ok to print
	;INPUT:  FBUC = UC node (unauthorized claim node) of parameter file
	;OUTPUT: 1 if ok to print letter, 0 if not ok
	Q $S($P(FBUC,U,3)'="A":0,$P(FBUC,U,2)']"":0,1:1)
	;
PRFLD(FBDA)	;check if print field is still set
	;INPUT:  FBDA = internal entry number of unauthorized claim (162.7)
	;OUTPUT: 1 for ok to print, 0 to not print
	Q $S('$D(^FB583("AL",1,FBDA)):0,1:1)
	;
REPRINT	;reprint
	N %ZIS,BEGDATE,ENDDATE,DIR,DIRUT,DTOUT,DUOUT,DISP,FBDT,FBI,FBJ,FBFR,FBNOUP,FBO,FBORDER,FBOUT,FBPL,FBPOP,FBRANGE,FBTO,FBUC,FBW,IOP,X,Y,ZTDESC,ZTIO,ZTRTN,ZTSAVE
	S FBOUT=0,FBUC=$$FBUC^FBUCUTL2(1)
	S DIR("A")="Do you wish to reprint letters for a date range",DIR(0)="Y",DIR("?")="Select Yes to reprint letters for a date range; No to reprint a specific letter."
	D ^DIR K DIR G END:$D(DIRUT),REPRINT:Y<0 S FBRANGE=Y I FBRANGE D DATE^FBAAUTL G:FBPOP END
	S FBFR=$S(FBRANGE:BEGDATE-.1,1:0),FBTO=$S(FBRANGE:ENDDATE,1:DT)
	I 'FBRANGE D LOOKUP^FBUCUTL3(0) G:FBOUT!('+$G(FBARY)) END I +$G(FBARY) S DISP=1 D PARSE^FBUCUTL4(FBARY),DISPY^FBUCUTL1 G:FBOUT!('+$G(FBARY(0))) END I $G(FBARY(0))]"" D STRING(FBARY(0))
	S DIR(0)="Y",DIR("A")="Should the expiration date be updated",DIR("B")="No",DIR("?")="Answer Yes to update the expiration date based upon today's printout, No to only reprint the letter but not change the date when the information is due."
	D ^DIR K DIR G END:$D(DIRUT),ASK:Y<0 S FBNOUP=$S('Y:1,1:0)
	D COPY G:FBOUT END S FBCOPIES=$S($P(FBUC,U,4):$P(FBUC,U,4),1:1)
	W ! S %ZIS("A")="Queue to print on: ",%ZIS("B")=$P(FBUC,U,2),%ZIS="NQ0",IOP="Q"_$S($P(FBUC,U,2):";"_$P(FBUC,U,2),1:"") D ^%ZIS G:POP END S $P(FBUC,U,2)=ION,ZTIO=ION,ZTDTH=$H
	S ZTRTN="REPRNTDQ^FBUCLET0",ZTDESC="REPRINT UNAUTH CLAIM LETTERS"
	S ZTSAVE("FBUC")="",ZTSAVE("FBFR")="",ZTSAVE("FBTO")="",ZTSAVE("FBNOUP")="",ZTSAVE("FBRANGE")="",ZTSAVE("FBARY(")="" I +$G(FBIEN) S ZTSAVE("FBIEN")="",ZTSAVE("FBIX")=""
	S:'$D(ZTDTH) ZTDTH=$H D ^%ZTLOAD
	K FBARY,^TMP("FBARY",$J),^TMP("FBARY",$J) G END
BATCH	;to batch print letters & update date letter printed, interactive
	N %ZIS,DIR,DIRUT,DTOUT,DUOUT,X,Y,FBOUT,FBUC,FBZ,IOP
	S FBOUT=0,FBUC=$$FBUC^FBUCUTL2(1)
ASK	D COPY G:FBOUT END
	W ! S %ZIS("A")="Queue to print on: ",%ZIS("B")=$P(FBUC,U,2),%ZIS="NQ0",IOP="Q"_$S($P(FBUC,U,2):";"_$P(FBUC,U,2),1:"") D ^%ZIS G:POP END S $P(FBUC,U,2)=ION,ZTIO=ION,ZTDTH=$H
	S FBCOPIES=$S($P(FBUC,U,4):$P(FBUC,U,4),1:1)
	;call taskman queue
	S ZTRTN="BATCHDQ^FBUCLET0",ZTDESC="BATCH UNAUTH CLAIM LETTERS",ZTSAVE("FBUC")=FBUC,ZTSAVE("FBCOPIES")="" S:'$D(ZTDTH) ZTDTH=$H  D ^%ZTLOAD
	;G END
END	D HOME^%ZIS K DA,DIE,DIRUT,DR,DTOUT,DUOUT,FBAR,FBARY,FBEXP,FBI,FBIEN,FBLET,FBLETDT,FBOUT,FBORDER,FBP,FBP,FBUC,FBCOPIES,FBDEVICE,POP,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTREQ,ZTSAVE,ZTSK Q
COPY	;
	S DIR(0)="161.4,35O",DIR("A")="Enter NUMBER OF COPIES for each letter",DIR("B")=$P(FBUC,U,4) D ^DIR K DIR S:$D(DIRUT) FBOUT=1 G:+Y<0 COPY S $P(FBUC,U,4)=$S(+Y=0:1,1:+Y)
	Q
STRING(FBY)	;set variable to string of IEN's which user selected
	;INPUT:  FBY = fbary(0) or what user selected
	;OUTPUT: FBARY = count of what was selected
	;        FBARY( = string array of selected IEN's of unauthorized claims,
	;                  delimited by ','
	N FBCT,FBDCT,FBIEN,I
	S FBDCT=($L(FBY,","))-1,FBARY=FBDCT,FBCT=0 D CT
	F I=1:1:FBDCT I '($P(FBY,",",I)#1) S FBIEN=+$G(^TMP("FBARY",$J,$P(FBY,",",I))) D:($L(FBARY(FBCT)+FBIEN+1))>245 STRIP,CT S FBARY(FBCT)=FBARY(FBCT)_","_+$G(^TMP("FBARY",$J,$P(FBY,",",I)))
	D:$E(FBARY(FBCT),1)="," STRIP
	Q
CT	;counter
	;INPUT:  FBCT = counter
	;OUTPUT: FBCT incremented by one
	S FBCT=FBCT+1,FBARY(FBCT)=""
	Q
STRIP	;strip comma
	;INPUT:  FBARY(FBCT array string
	;OUTPUT: same array string with leading comma stripped
	S FBARY(FBCT)=$P(FBARY(FBCT),",",2,($L(FBARY(FBCT),",")))
	Q

FBUCLET0
FBUCLET0	;ALBISC/TET - UNAUTHORIZED CLAIM LETTER DQ (continued) ;7/7/93  18:42
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
BATCHDQ	;tasked entry point from batch^fbuclet or option
	U IO S FBFF=0 S:'$D(FBUC) FBUC=$$FBUC^FBUCUTL2(1) S:'$D(FBCOPIES) FBCOPIES=$S($P(FBUC,U,4):$P(FBUC,U,4),1:1) D STANUM^FBUCUTL2 D:'$P($G(FBUC),U,8) STATADD^FBUCUTL2
	D DISPNP^FBUCUTL3 ;set array of letters which are waiting to be printed
	S FBAR=$G(^TMP("FBAR",$J,"FBAR")) I +FBAR D
	.N FBDA,FBEXP,FBI,FBORDER,FBP,FBPL,FBW S FBI=0 D PARSE^FBUCUTL4(FBAR)
	.F  S FBI=$O(^TMP("FBAR",$J,FBI)) Q:'FBI  S FBDA=+$P($G(^TMP("FBAR",$J,FBI)),";"),FBUCA=$G(^FB583(FBDA,0)),FBORDER=$$ORDER^FBUCUTL(+$P(FBUCA,U,24)) D PRINT^FBUCLET1
	K ^TMP("FBAR",$J) G END
REPRNTDQ	;tasked entry point from reprint^fbuclet
	;fbnoup=1 if no update of expiration date, = 0 to update
	U IO S FBFF=0 D STANUM^FBUCUTL2 D:'$P($G(FBUC),U,8) STATADD^FBUCUTL2 I 'FBNOUP K FBNOUP
	D ARRAY:FBRANGE,STRING:'FBRANGE
	N FBI S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBDA=+$P($G(^TMP("FBARY",$J,FBI)),";"),FBUCA=$G(^FB583(FBDA,0)),FBORDER=$$ORDER^FBUCUTL(+$P(FBUCA,U,24)) D PRINT^FBUCLET1
	K ^TMP("FBARY",$J) G END
AUTODQ	;tasked entry point from auto^fbuclet
	U IO S FBFF=0 S:'$D(FBUC) FBUC=$$FBUC^FBUCUTL2(1) D STANUM^FBUCUTL2 D:'$P(FBUC,U,8) STATADD^FBUCUTL2 D PRINT^FBUCLET1
	;G END
END	S ZTREQ="@" D ^%ZISC K ZTRTN,ZTSTOP,ZTIO,ZTDESC,FBADD,FBAR,FBARY,FBCOPIES,FBDA,FBFF,FBFR,FBNOUP,FBORDER,FBSADD,FBSTANUM,FBTO,FBUCA,FBUC,XRT0,XRTN
	Q
STRING	;process string of ien's if not date range/called by reprntdq
	;INPUT:  FBARY( array of ien of selected unauthorized claims
	;OUTPUT: TMP(FBARY,$J array
	N FBDCT,FBA S (FBDCT,FBA)=0 F  S FBA=$O(FBARY(FBA)) Q:'FBA  D
	.N FBCT,FBI,FBDA S FBCT=($L(FBARY(FBA),",")) F FBI=1:1:FBCT S FBDCT=FBDCT+1,FBDA=$P(FBARY(FBA),",",FBI),^TMP("FBARY",$J,FBDCT)=+FBDA
	Q
ARRAY	;set array in tmp for date range
	;called by reprntdq if date range selected
	;INPUT VARIABLES:  FBFR = from date;  FBTO = to date
	N FBARY,FBDCT,FBDT,FBI,FBO,FBORDER,FBZ
	S (FBDCT,FBORDER)=0,FBO="" F  S FBORDER=$O(^FB(162.92,"AO",FBORDER)) Q:'FBORDER  I $$LETTER^FBUCUTL2(FBORDER) S FBO=FBO_U_FBORDER
	I FBO]"" S FBO=FBO_U
	S FBDT=FBFR F  S FBDT=$O(^FB583("ALP",FBDT)) Q:'FBDT!(FBDT>FBTO)  S FBI=0 F  S FBI=$O(^FB583("ALP",FBDT,FBI)) Q:'FBI  S FBZ=$G(^FB583(FBI,0)) I FBZ]"",FBO["^"_$$ORDER^FBUCUTL($P(FBZ,U,24))_"^" D
	.N FBARY S FBDCT=FBDCT+1
	.S FBARY=FBI_";"_$E($$VET^FBUCUTL($P(FBZ,U,4)),1,12)_U_$E($$VEN^FBUCUTL($P(FBZ,U,3)),1,12)_U_$E($$PROG^FBUCUTL($P(FBZ,U,2)),1,14)_U_$$DATX^FBAAUTL($P(FBZ,U))_U_$E($$PTR^FBUCUTL("^FB(162.92,",+$P(FBZ,U,24)),1,16)
	.S ^TMP("FBARY",$J,FBDCT)=FBARY
	S FBARY=FBDCT I FBDCT S FBARY=FBARY_";"_"5^20^35^52^63^",^TMP("FBARY",$J,"FBARY")=FBARY
	Q

FBUCLET1
FBUCLET1	;ALBISC/TET - UNAUTHORIZED CLAIM LETTER (continued) ;7/7/93  18:54
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PRINT	;print letter, don't update if variable fbnoup exists
	;INPUT:  FBDA = ien of unauthorized claim, file 162.7
	;        FBORDER = (optional) order number of status
	;        FBUCA = current (after) zero node of unauthorized claim (162.7)
	;        FBUC = unauthorized claim node in parameter file
	;        FBNOUP = 1 if no update is to occur, optional, set in reprint
	;        FBFF = counter flag, suppresses formfeed if = 0
	;        FBCOPIES = # of copies to print, optional, not set from auto
	;        FBSTANUM = station number
	;        FBSADD( array = station address, if site parameter designates letterhead not used
	;VAR     FBADD( = address array to where letter is mailed
	;OUTPUT: none - print letter and update fields, if '$d(fbnoup), upon completion
	N FBADD,FBAUTH,FBC,FBEP,FBLETDT,FBLIEN,FBNAM,FBNAM1,FBPROG,FBRE,FBSUBMIT S FBLETDT=0 S:FBORDER']"" FBORDER=$$ORDER^FBUCUTL(FBDA) S ZTSTOP=$$S^%ZTLOAD
	D ADDRESS^FBUCUTL2(FBUCA)
	S FBSUBMIT=$P(FBUCA,U,23),FBPROG=$$PROG^FBUCUTL(+$P(FBUCA,U,2))
	S FBNAM=$S(FBSUBMIT["FBAAV("!(FBSUBMIT["VA(200,"):$$VET^FBUCUTL(+$P(FBUCA,U,4)),1:$$VEN^FBUCUTL(+$P(FBUCA,U,3))) I FBNAM["," S FBNAM=$P(FBNAM,",",2)_" "_$P(FBNAM,",")
	I FBSUBMIT["VA(200," S FBNAM1=$$VEN^FBUCUTL(+$P(FBUCA,U,3)) I FBNAM1["," S FBNAM1=$P(FBNAM1,",",2)_" "_$P(FBNAM1,",")
	S FBRE=$S(FBSUBMIT']""!(FBSUBMIT["DPT("):"VENDOR:",1:"VETERAN:")
	S FBEP=$$DATX^FBAAUTL(+$P(FBUCA,U,5)) S:$P(FBUCA,U,6)'=$P(FBUCA,U,5) FBEP=FBEP_"^"_$$DATX^FBAAUTL(+$P(FBUCA,U,6))
	S FBAUTH=$$DATX^FBAAUTL(+$P(FBUCA,U,13)) S:$P(FBUCA,U,14)'=$P(FBUCA,U,13) FBAUTH=FBAUTH_"^"_$$DATX^FBAAUTL(+$P(FBUCA,U,14))
	S FBLIEN=$$LETTER^FBUCUTL2(FBORDER)
	I '$D(FBCOPIES) S FBCOPIES=$S($P(FBUC,U,4):$P(FBUC,U,4),1:1)
	I FBLIEN F FBC=1:1:FBCOPIES D
	.N DIWF,DIWL,FBEXP,FBI
	.S FBFF=FBFF+1 W:FBFF&(FBFF>1) @IOF W ! W:$P(FBUC,U,8) !!!!! D:'$P(FBUC,U,8)  W !?4,$$PDATE^FBUCUTL2(DT),! W:'$P(FBUC,U,8) ?50,"In Reply Refer To: " W ?68,FBSTANUM,"/136"
	..N FBI,FBX,FBCT S (FBCT,FBI)=0 F  S FBI=$O(FBSADD(FBI)) Q:'FBI  S FBX=FBSADD(FBI) W !?(IOM-$L(FBX)/2),FBX S FBCT=FBCT+1
	..S FBCT=5-FBCT I FBCT>0 F FBI=1:1:FBCT W ! ;ensure length of header is consistant
	.W !?50,$$VET^FBUCUTL(+$P(FBUCA,U,4))
	.S (FBCT,FBI)=0 F  S FBI=$O(FBADD(FBI)) Q:'FBI  W !?4,FBADD(FBI) S FBCT=FBCT+1 I FBI=1 W ?50,$$SSN^FBAAUTL(+$P(FBUCA,U,4))
	.D HED
	.S DIWF="WC79I4",DIWL=1 D:$Y+10>IOSL PAGE D TXT^FBUCUTL2("^FBAA(161.3,",FBLIEN,1,DIWF,DIWL,1) W !
	.S DIWF="WC72I8",DIWL=1
	.I FBORDER>20 D:$Y+10>IOSL PAGE D TXT^FBUCUTL2("^FB(162.91,",+$P(FBUCA,U,11),1,DIWF,DIWL,1) D
	..I $P(FBUCA,U,11)=1!($P(FBUCA,U,11)=4) W !?8,"Authorized from: ",$$DATX^FBAAUTL($P(FBUCA,U,13)),"  Authorized to: ",$$DATX^FBAAUTL($P(FBUCA,U,14)),!?8,"Amount approved:  " W:$P(FBUCA,U,15) "$",$FN($P(FBUCA,U,15),",",2) W !
	..I +$P(FBUCA,U,11)'=1,+$O(^FB583(FBDA,"D",0)) D:$Y+10>IOSL PAGE W !?8,"Reason(s) for not approving "_$S($P(FBUCA,U,11)=4:"entire ",1:"")_"claim:" D
	...N DIWF,FBI,FBZ S DIWF="WC69I8",FBI=0 F  S FBI=$O(^FB583(FBDA,"D",FBI)) Q:'FBI  S FBZ=^(FBI,0) D:$Y+8>IOSL PAGE W ! D TXT^FBUCUTL2("^FB(162.94,",+FBZ,1,DIWF,DIWL,1)
	.I FBORDER'>20 S FBI=0 F  S FBI=$O(^FBAA(162.8,"AC",FBDA,FBI)) Q:'FBI  S FBZ=$G(^FBAA(162.8,FBI,0)) I '$P(FBZ,U,5) D:$Y+12>IOSL PAGE D
	..N FBX W ! S FBX=$P($G(^FB(162.93,+$P(FBZ,U,3),0)),U) I FBX="OTHER" S:$P(FBZ,U,4)]"" FBX=$P(FBZ,U,4) W ?8,FBX,! Q
	..D TXT^FBUCUTL2("^FB(162.93,",+$P(FBZ,U,3),1,DIWF,DIWL,1)
	.S DIWF="WC79I4",DIWL=1 D:($Y+4+$S(FBORDER>20:15,1:22))>IOSL PAGE W ! D TXT^FBUCUTL2("^FBAA(161.3,",FBLIEN,2,DIWF,DIWL,1)
	I '$D(FBNOUP) D
	.D:$D(XRTL) T0^%ZOSV ;start monitor
	.S FBEXP=$$EXPIRE^FBUCUTL8(FBDA,DT,FBUCA,FBORDER) D EDITL^FBUCED(FBDA,FBEXP,"@",DT)
	.S:$D(XRT0) XRTN=$T(+0) D:$D(XRT0) T1^%ZOSV ;stop monitor
	Q
PAGE	;new page
	W @IOF,!!!!!!!
HED	;header to print after address and on each new page
	W !!!!?8,"REGARDING:",?20,FBRE,?38,FBNAM I $D(FBNAM1) W !?20,"VENDOR:",?38,FBNAM1
	W !?20,"FEE PROGRAM:",?38,FBPROG
	W !?20,"EPISODE OF CARE:",?38,$P(FBEP,U) W:$P(FBEP,U,2)]"" " to ",$P(FBEP,U,2)
	W !!
	Q

FBUCLINK
FBUCLINK	;ALBISC/TET - LINK CLAIM TO A PRIMARY ;5/14/93  14:59
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EDIT	;associate claims to a primary ;call from FBUC ASSOCIATE option
	;INPUT:  none
	;VAR:    FBLINK = ien of master claim #
	;OUTPUT:  none; if fblink will update
	N FBACT S FBACT="LNK",FBO=0 D LOOKUP^FBUCUTL3(FBO) G:FBOUT END
	Q:'+$G(FBARY)  N FBDA,FBI,FBNODE,FBPL,FBW D PARSE^FBUCUTL4(FBARY)
	S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBNODE=$G(^(FBI)),FBDA=+FBNODE D  Q:FBOUT
	.N FBUCA,FBUCAA,FBUCP,FBUCPA,FBZ I +$G(FBARY)>1 D LINE^FBUCUTL4(FBNODE,FBI,FBPL,FBW)
	.D PRIOR^FBUCEVT(FBDA,FBACT)
	.I '$$LINK^FBUCUTL4(FBDA,FBUCP) W !,"This claim has other claims associated with it",!,"and, therefore, can not be associated to another." Q
	.D ASSOC Q:FBOUT  D UPD(FBDA,FBLINK)
	.S FBZ=$$FBZ^FBUCUTL(FBDA) D EN^FBUCEN1(FBZ,FBDA)
	.D AFTER^FBUCEVT(FBDA,FBACT),^FBUCUPD(FBUCP,FBUCPA,FBUCA,FBUCAA,FBDA,FBACT)
END	;kill and quit
	K DA,DIE,DIRUT,DR,DTOUT,DUOUT,FBAR,FBARY,FBDCT,FBI,FBLINK,FBO,FBOUT,FBP,FBPL,FBUCP,FBUCPA,FBW,FBX,FBZ,X,Y,^TMP("FBARY",$J) Q
ASSOC	;associate claim to a primary
	;INPUT:  FBDA = ien of unauthorized claim to be linked
	;        FBUCP = zero node of fbda
	;OUTPUT: FBLINK = ien of unauthorized claim to which is linked
	;        FBOUT = set if timed out or up-arrow entered
	S DIC="^FB583(",DIC(0)="AEMQZ",DIC("A")="Select the unauthorized claim to which this one should be associated: ",DIC("W")="D ID^FBUCUTL4"
	S DIC("S")="N FBZ S FBZ=$$FBZ^FBUCUTL(+Y) I $P(FBZ,U,4)=$P(FBUCP,U,4)&(+Y'=FBDA)&($$LINKTO^FBUCUTL4(+Y,FBZ,FBDA))&($P(FBZ,U,5)=$P(FBUCP,U,5))&($P(FBZ,U,6)=$P(FBUCP,U,6)) K FBZ"
	D ^DIC K DIC S:$D(DTOUT)!($D(DUOUT)) FBOUT=1 G:FBOUT!(Y'>0) ASSOCQ S FBLINK=+Y
ASSOCQ	S FBLINK=+$G(FBLINK) K FBZ,Y Q
DISASSOC	;disassociate a claim, interactive, called from option
	N FBARY,FBDA,FBI,FBNODE,FBOUT,FBP,FBPL,FBW ;new variables here
	W !,"This option will allow you to disassociate a claim.",!
	D LOOKUP^FBUCUTL3(0)
	G:'+$G(FBARY) DISASSQ
	S FBOUT=0 D PARSE^FBUCUTL4(FBARY)
	S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI!(FBOUT)  S FBNODE=$G(^(FBI)),FBDA=+$P(FBNODE,";") D  G:FBOUT DISASSQ
	.N FBALL,FBDIRA,FBDISP,FBGROUP,FBZ
	.D LINE^FBUCUTL4(FBNODE,FBI,FBPL,FBW)
	.S FBZ=$G(^FB583(FBDA,0))
	.S FBALL=0 D GROUP^FBUCUTL7(FBZ,FBDA)
	.I +$G(FBGROUP)=1 W !,"This claim is not associated with another claim." Q
	.D DISPLAY^FBUCUTL7(FBDA,.FBGROUP) S FBDIRA="Do you wish to disassociate claim from the above group" D READ^FBUCUTL7(FBDIRA,.FBOUT,.FBDISP) Q:FBOUT!('FBALL)
	.D UNLINK^FBUCLNK1(.FBGROUP,FBDA,FBZ)
DISASSQ	K FBARY,^TMP("FBARY",$J) Q
UPD(FBDA,FBLINK)	;update master claim field
	;INPUT:  FBDA = internal entry number of unauthorized claim for update
	;        FBLINK = internal entry number of primary claim
	;OUTPUT: update of MASTER CLAIM field
	N DA,DIE,DR,X,FBLOCK
	Q:'+$G(FBDA)!('+$G(FBLINK))  I +$G(FBLINK) S DA=FBDA,DIE="^FB583(",DR="20////^S X=FBLINK" D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FB583(FBDA)
	Q
ARSET(FBDA,FBZ)	;set display array
	;INPUT:  FBDA = ien of unauthorized claim record
	;        FBZ = zero node of unauthorized claim
	;OUTPUT: string of data for display
	N FBX I '+$G(FBDA)!($G(FBZ)']"") Q $G(FBX)
	S FBX=FBDA_";"_$S($$PRIME^FBUCUTL4(FBDA,FBZ):"*",1:"  ")_$E($$VET^FBUCUTL(+$P(FBZ,U,4)),1,12)_U_$E($$VEN^FBUCUTL(+$P(FBZ,U,3)),1,12)_U_$E($$PROG^FBUCUTL(+$P(FBZ,U,2)),1,12)_U_$$DATX^FBAAUTL(+$P(FBZ,U))
	S FBX=FBX_U_$E($$PTR^FBUCUTL("^FB(162.92,",+$P(FBZ,U,24)),1,16)
	S FBX=FBX_U_"TREATMENT FROM: "_$$DATX^FBAAUTL(+$P(FBZ,U,5))_U_"TREATMENT TO: "_$$DATX^FBAAUTL(+$P(FBZ,U,6))
	Q $G(FBX)
ASK	;ask if want to associate claim
	;INPUT:  FBLINK = flag that another entry for vet and episode exists
	;        FBAR & FBAR( = data for vet/episode of care to display
	;OUTPUT: FBLINK = 1 is which to associate; 0 to associate to itself
	W !!,"Other claims exist for the same veteran and episode of care." H 1 D DISPX^FBUCUTL1(0,1)
	W ! S DIR("A")="Do you wish to associate this new claim with one from the above listing",DIR("B")="YES",DIR(0)="Y" D ^DIR K DIR S:$D(DIRUT) FBOUT=1  S FBLINK=$S(Y=1:1,1:0)
	Q
SELECT(FBAR)	;select a claim from listing to link
	;INPUT:  FBAR = (not subscripted), for upper limit
	;OUTPUT: FBLINK = number of primary master claim or zero
	Q:'+$G(FBAR)  S DIR(0)="N^1:"_FBAR_":0",DIR("A")="Select the claim to which you wish to associate",DIR("??")="^D DISPX^FBUCUTL1(0,1)"
	D ^DIR K DIR S:$D(DIRUT) FBOUT=1 Q:+$G(FBOUT)  S FBLINK=+$G(^TMP("FBAR",$J,+Y))
	Q

FBUCLNK1
FBUCLNK1	;ALBISC/TET - LINK CLAIM DISPLAY
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
LINK(FBDA,FBIX,FBSET)	;determine if link claims exist
	;INPUT:  FBDA = ien of unauthoriezed claim
	;        FBIX = xref indicating how user is looking up (APMS,AVMS,AOMS)
	;        FBSET = (optional) 1 to set global array, 0 to not set
	;OUTPUT: 1 if claim is linked to others, 0 if not
	;        TMP("FBAR" global array (if 1 and flagged to set)
	I '+$G(FBDA) Q 0 S:$G(FBSET)']"" FBSET=0
	N FBCT,FBDCT,FBI,FBMC,FBZ S FBMC=+$P($$FBZ^FBUCUTL(FBDA),U,20) I 'FBMC Q 0
	S (FBDCT,FBCT,FBI)=0 F  S FBI=$O(^FB583("AMC",FBMC,FBI)) Q:'FBI!(FBCT&('FBSET))  I FBI'=FBDA S FBCT=FBCT+1 I FBSET S FBZ=$G(^FB583(FBI,0)) I FBZ]"" D
	.;set array
	.D DA^FBUCUTL5(FBI,"APMS",.FBDCT,+$P(FBZ,U,20),FBZ)
	I FBCT,FBSET D FBAR^FBUCUTL5(FBCT)
	Q $S(FBCT:1,1:0)
	;
ENTER(FBDA,FBUCA,DISP,FBIX)	;link claim on entry
	;called from fbucen - enter new unauth claim
	;INPUT:  FBDA = ien of unauthorized claim
	;        FBUCA = after node of unauthorized claim
	;        DISP = 0 to display only, 1 to update
	;        FBIX = cross-ref (optional)
	;VAR:     FBTFROM-treatment from date/FBTTO-treatment to date/FBVET-veteran
	;OUTPUT: link new claim to existing claim, if user so designates
	;        data stored in tmp(fbar/tmp(fbary global arrays
	N FBAR,FBARY,FBCNT,FBDCT,FBI,FBLINK,FBMC,FBOUT,FBTFROM,FBTTO,FBVET,FBX,FBZ S FBDCT=0
	S:$G(FBIX)']"" FBIX="APMS" S FBTFROM=$P(FBUCA,U,5),FBTTO=$P(FBUCA,U,6),FBVET=$P(FBUCA,U,4),FBMC=+$P(FBUCA,U,20),FBX=+$O(^FB583("APF",FBVET,FBTFROM,0))
	I FBX'=FBDA S FBLINK=1,FBI=0 F  S FBI=$O(^FB583("APF",FBVET,FBTFROM,FBI)) Q:'FBI  S FBZ=$$FBZ^FBUCUTL(FBI) I $P(FBZ,U,6)=FBTTO,$$LINKTO^FBUCUTL4(FBI,FBZ,FBDA),FBI'=FBDA D DA^FBUCUTL5(FBI,FBIX,.FBDCT,FBMC,FBZ)
	D FBAR^FBUCUTL5(FBDCT)
	I DISP,+$G(FBLINK),+$G(FBAR) D ASK^FBUCLINK Q:+$G(FBOUT)  I FBLINK D SELECT^FBUCLINK(+FBAR) Q:+$G(FBOUT)  D:FBLINK UPD^FBUCLINK(FBDA,FBLINK)
	I 'DISP,+$G(FBLINK),+$G(FBAR) S FBX="< ASSOCIATED CLAIMS >" W !!?(IOM-$L(FBX)/2),FBX,! D DISPX^FBUCUTL1(0)
	K ^TMP("FBAR",$J),^TMP("FBARY",$J) Q
	;
UNLINK(FBGROUP,FBDA,FBZ,FBRELINK)	;unlink claim from group/determine new primary claim
	;INPUT:  FBGROUP = # in group^# of programs^1 if auth^# of u/c w/same status^# of diff dispositions
	;        FBGROUP(ien of 162.7) = prog^auth ien^status ien^dispositon ien
	;        FBDA = ien of unauth claim working with
	;        FBZ = zero node of unauth claim (fbda)
	;        FBRELINK = <optional> flag to auto relink: 1 for auto-relink
	;OUTPUT: fbda claim is unlinked; if group and fbda primary, new primary
	;         if another claim exists with same vet and episode of care,
	;           the unlinked claim may be relinked to it.
	I $S('+$G(FBGROUP):1,'+$G(FBDA):1,$G(FBZ)']"":1,1:0) Q
	S FBRELINK=+$G(FBRELINK) N FBALL,FBD,FBDIRA,FBI,FBMATCH,FBO,FBOUT,FBPRIME,FBTFR,FBTTO,FBVET ;other variables
	S (FBALL,FBMATCH,FBOUT)=0
	S FBPRIME=$$PRIME^FBUCUTL4(FBDA,FBZ) D:FBPRIME PRIME(.FBGROUP,FBDA,FBZ) I 'FBPRIME D DIE^FBUCUTL2("^FB583(",FBDA,"20////^S X="_FBDA)
	S FBVET=$P(FBZ,U,4),FBTFR=$P(FBZ,U,5),FBTTO=$P(FBZ,U,6),FBD=FBTFR-.1
	F  S FBD=$O(^FB583("APF",FBVET,FBD)) Q:'FBD!(FBD>FBTFR)  S FBI=0 F  S FBI=$O(^FB583("APF",FBVET,FBD,FBI)) Q:'FBI!(FBMATCH)  I FBI'=FBDA S FBO=$G(^FB583(FBI,0)) I $P(FBO,U,6)=FBTTO,'$D(FBGROUP(FBI)) S FBMATCH=+$P(FBO,U,20)
	Q:'FBMATCH  ;nothing else to which this claim can be grouped
	I 'FBRELINK S FBDIRA="Do you want to automatically link this claim with another group" D READ^FBUCUTL7(FBDIRA,.FBOUT) Q:FBOUT!('FBALL)
	I FBALL D DIE^FBUCUTL2("^FB583(",FBDA,"20////^S X="_FBMATCH)
	Q
PRIME(FBGROUP,FBDA,FBZ)	;determine primary claim
	;INPUT:  FBGROUP = # in group^# of programs^1 if auth^# of u/c w/same status^# of diff dispositions
	;        FBGROUP(ien of 162.7) = prog^auth ien^status ien^dispositon ien
	;        FBDA = ien of unauth claim
	;        FBZ = zero node of unauth claim (fbda)
	;OUTPUT: if primary, find new primary for other claims in group and update
	N FBPRIME,FBI,FBO
	;determine new primary claim; reset rest in group to new primary
	S (FBI,FBPRIME)=0 F  S FBI=$O(FBGROUP(FBI)) Q:'FBI  I FBI'=FBDA S FBPRIME=FBI Q:FBPRIME
	I FBPRIME S FBI=0 F  S FBI=$O(FBGROUP(FBI)) Q:'FBI  I FBI'=FBDA S FBO=$G(^FB583(FBI,0)) D DIE^FBUCUTL2("^FB583(",FBI,"20////^S X="_FBPRIME)
	Q

FBUCOUT
FBUCOUT	;ALBISC/TET - OUTPUTS
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASK	;ask search/sort questions
	S DIR(0)="SM^1:PATIENT;2:VENDOR",DIR("A")="Sort by" D ^DIR K DIR G END:$D(DIRUT),ASK:'+Y!($G(Y(0))']"") S FLDS="[FBUC STATUS BY "_Y(0)_"]"
	D DISP92^FBUCUTL5,DISPX^FBUCUTL1(1) ;set array,display
	G END:FBOUT,ASK:'+FBARY S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBARY(+$G(^TMP("FBARY",$J,FBI)))=""
	S DIS(0)="I $D(FBARY(+$P($G(^(D0,0)),U,24)))",L=0,DIC="^FB583(",BY=FLDS,FR="?,@,@,,@,@,@",TO="?,,,,,,"
	S FBDT=DT,FBZLOW=FBDT,FBZHI=$$CDTC^FBUCUTL(FBDT,30)
	D EN1^DIP
	;set up variable fbexp
	;set up dip variables, call dip
END	;kill and quit
	K FBARY,FBDT,FBEXP,FBI,FBOUT,FBZLOW,FBZHI,BY,DIC,DIR,DIRUT,DIS,DTOUT,DUOUT,FLDS,FR,L,TO,Y,^TMP("FBAR",$J),^TMP("FBARY",$J)
	Q
CODE(X)	;dispostion code of disposition if status order is 40,70 or 90
	; 40=dispositioned,70=appeal dispositioned,90=bva appeal dispositioned
	I '+X Q ""
	Q $P($$PTR^FBUCUTL("^FB(162.91,",X),U,3)
	;

FBUCOUT1
FBUCOUT1	;ALBISC/TET - OUTPUTS cont'd
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ONE	;display/print all claims for one vendor/veteran/other party
	;sort by treatment from/to dates, group by master claim
	;sort by vendor if vet or other selected, otherwise veteran
	;'*' denotes secondary claim
	N FBI,FBIEN,FBIX,FBMC,FBOIEN,FBPTR,FBSORT,FBZ S (FBVEN,FBVET,FBOTH)=""
	D IEN^FBUCUTL3 G END:'FBIEN I FBIX="AOMS" S FBOIEN=FBIEN,FBOTH=$P($G(^VA(200,FBOIEN,0)),U),FBIEN=+$P($$FBZ^FBUCUTL(+$O(^FB583(FBIX,FBOIEN,0))),U,4)
	S:FBIX'="AVMS" FBVET=$P($G(^DPT(FBIEN,0)),U) S:FBIX="AVMS" FBVEN=$P($G(^FBAAV(FBIEN,0)),U)
Q	;que to print
	S:FBIX="AOMS" FBIEN=FBOIEN S VAR="FBIX^FBIEN^FBVEN^FBVET^FBOTH",VAL=VAR,PGM="SORT^FBUCOUT1" D ZIS^FBAAUTL G:FBPOP END
SORT	;sort all claims output
	U IO K ^TMP("FB",$J) N FBI,FBMC,FBZ
	S FBMC="" F  S FBMC=$O(^FB583(FBIX,FBIEN,FBMC)) Q:FBMC']""  S FBI=0 F  S FBI=$O(^FB583("AMC",+FBMC,FBI)) Q:'FBI  S FBZ=$G(^FB583(FBI,0)) I FBZ]"" D
	.N FBPTR,FBSORT,NODE S FBPTR=$S(FBIX="AVMS":$P(FBZ,U,4),1:$P(FBZ,U,3))
	.S FBSORT=$P($$PTR^FBUCUTL($S(FBIX="AVMS":"^DPT(",1:"^FBAAV("),FBPTR),U) I FBIX="AVMS" S FBSORT=$E(FBSORT,1,30)
	.S NODE=$E($P($$PROG^FBUCUTL(+$P(FBZ,U,2)),U),1,15)_U_$E($P($$PTR^FBUCUTL("^FB(162.92,",$P(FBZ,U,24)),U),1,20) I "^40^70^90^"[$$ORDER^FBUCUTL($P(FBZ,U,24)) S NODE=NODE_U_$$CODE^FBUCOUT($P(FBZ,U,11))
	.S ^TMP("FB",$J,+$P(FBZ,U,5)_";"_+$P(FBZ,U,6),+FBMC_$S(+FBMC=FBI:"P",1:"S")_";"_FBI,$S(+FBMC=FBI:"",1:" *")_FBSORT_";"_FBPTR)=NODE
	.S FBMC=+FBMC_"z"
PRINT	;print all claims output
	N DIRUT,DTOUT,DUTOUT,FBCRT,FBDASH,FBDT,FBHDR,FBMC,FBN,FBNODE,FBOMC,FBOUT,FBPG
	S FBHDR=$S(FBIX="AVMS":"VENDOR: "_FBVEN,FBIX="APMS":"VETERAN: "_FBVET,1:"OTHER PARTY: "_FBOTH),FBPG=0,FBCRT=$S($E(IOST,1,2)="C-":1,1:0),FBOUT=0,$P(FBDASH,"=",80)="" D PAGE
	S FBOMC=0,FBDT=""
	F  S FBDT=$O(^TMP("FB",$J,FBDT)) Q:FBDT']""!(FBOUT)  S FBMC="" F  S FBMC=$O(^TMP("FB",$J,FBDT,FBMC)) Q:FBMC']""  W:+FBOMC'=+FBMC !! S FBOMC=FBMC D  Q:FBOUT
	.S FBN="" F  S FBN=$O(^TMP("FB",$J,FBDT,FBMC,FBN)) Q:FBN']""  S FBNODE=$G(^TMP("FB",$J,FBDT,FBMC,FBN)) D  Q:FBOUT
	..I IOSL<($Y+5) D PAGE Q:FBOUT
	..W !,$P(FBN,";"),?34,$P(FBNODE,U),?53,$P(FBNODE,U,2),?75,$P(FBNODE,U,3)
	..W !?3,"Treatment From: ",$$DATX^FBAAUTL($P(FBDT,";")),?29,"Treatment To: ",$$DATX^FBAAUTL($P(FBDT,";",2))
	..I FBIX="AOMS" W ?54,"VETERAN: ",$E($$VET^FBUCUTL(+$P($$FBZ^FBUCUTL(+$P(FBMC,";",2)),U,4)),1,16)
END	;kill variables,tmp global and quit
	K FBIEN,FBIX,FBOTH,FBPOP,FBVEN,FBVET,PGM,POP,VAL,VAR,^TMP("FB",$J)
	D CLOSE^FBAAUTL
	Q
PAGE	;write new page
	D:FBCRT&(FBPG>0) CR Q:FBOUT
HDR	W:FBCRT!(FBPG>0) @IOF S FBPG=FBPG+1
	W !,FBHDR,!?70,"Page: ",FBPG,!,$S(FBIX="AVMS":"Veteran",1:"Vendor"),?34,"Fee Program",?53,"Status",?75,"Code",!,FBDASH
	Q
CR	;ask end of page prompt
	;OUTPUT: FBOUT is set if time out or up arrow out
	W ! S DIR(0)="E" D ^DIR K DIR S:$D(DTOUT)!($D(DUOUT)) FBOUT=1
	Q

FBUCPAY
FBUCPAY	;ALBISC/TET - PAYMENT DRIVER ;4/30/93  11:34
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
ASK	;ask to whom payment should be made, vendor and veteran (to narrow selection)
	S DIR(0)="SMO^1:PATIENT;2:VENDOR",DIR("A")="Select to whom payment should be made" D ^DIR K DIR G END:$D(DIRUT),ASK:'+Y!($G(Y(0))']"")
	S FBPAY=+Y ;1 for patient, 2 for vendor
GET	;get claim for payment, only approved dispositioned claims, non cnh program, ven and vet must match
	K FBVEN,FBVET
VET	;get vet info
	S DIR(0)="162.7,2O",DIR("A")="Select VETERAN" D ^DIR K DIR G END:$D(DIRUT),VET:+Y'>0 S FBVET=+Y
VEN	;get vendor info
	S DIR(0)="162.7,1O",DIR("A")="Select FEE VENDOR" D ^DIR K DIR G END:$D(DUOUT)!($D(DTOUT)),VEN:+Y'>0 S FBVEN=+Y
LOOKUP	;select claim
	S FBIX="APMS",FBIEN=FBVET,FBO="40^70^90^" D DISP7^FBUCUTL5(FBIX,FBIEN,FBO) ;lookup by patient, dispostioned claim only
	;delete entries from array which don't meet criteria:  program=7(cnh), vendor'=fbven, disposition not approved or approved to stabilization
	S (FBCNT,FBI)=0 F  S FBI=$O(^TMP("FBAR",$J,FBI)) Q:'FBI  S FBZ=$G(^FB583(+^(FBI),0)) D
	.I $S($P(FBZ,U,2)=7:1,$P(FBZ,U,3)'=FBVEN:1,$P(FBZ,U,11)'=1&($P(FBZ,U,11)'=4):1,1:0) D  K ^TMP("FBAR",$J,FBI) S $P(^("FBAR"),";")=+^TMP("FBAR",$J,"FBAR")-1 Q
	..Q:$P(^TMP("FBAR",$J,FBI),U,3,8)']""!('$G(^TMP("FBAR",$J,FBI+1)))!($P($G(^TMP("FBAR",$J,FBI+1)),U,3,8)]"")
	..S FBZ=$P(^(FBI+1),";")_";  "_$P($P(^(FBI),U),";",2)_"^"_$TR($P($P(^(FBI+1),U),";",2)," ","")_"^"_$P(^(FBI),U,3,8),^TMP("FBAR",$J,FBI+1)=FBZ,$P(^(FBI+1),U,7)="  "_$P(^(FBI+1),U,7) K FBZ
	.S FBCNT=FBCNT+1 I FBI'=FBCNT S ^TMP("FBAR",$J,FBCNT)=^TMP("FBAR",$J,FBI) K ^TMP("FBAR",$J,FBI)
	D DISPX^FBUCUTL1(1,1) ;display/make selection
	K ^TMP("FBAR",$J) G END:FBOUT!('+$G(FBARY)) ;nothing selected so go to end
LOOP	;loop thru selection and make payments
	N FBDA,FBI,FBNODE,FBP,FBPL,FBW,FBZ D PARSE^FBUCUTL4(FBARY)
	S (FBOUT,FBI)=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBNODE=$G(^(FBI)),FBDA=+$P(FBNODE,";"),FBZ=$G(^FB583(FBDA,0)) D  ;D:$D(FBMESS) WRITE G END:FBOUT,ASK
	.I +$G(FBARY)>1 D LINE^FBUCUTL4(FBNODE,FBI,FBPL,FBW)
	.N FBI,FTP,DUOUT,DTOUT S FBOUT=0 D PAY(FBVET,FBPAY,FBZ)
	D END G ASK
	;
PAY(FBVET,FBPAY,FBZ)	;determine payments
	I '($P(FBZ,U,11)=1!($P(FBZ,U,11)=4)) W *7 S FBMESS="Unauthorized claim must be Approved or Approved to Stabilization" D WRITE S FBMESS=" in order to make a payment." D WRITE S FBOUT=1 Q
	S (DFN,D0)=FBVET,FBPROG(1)=+$P(FBZ,U,2),FBSUBMIT=$P(FBZ,U,23),FBAAPTC=$S(FBPAY=2:"V",1:"R"),FBAIEN=+$P(FBZ,U,27) ;,FBAAPTC=$S(FBSUBMIT["DPT(":"R",FBSUBMIT["FBAAV(":"V",FBSUBMIT["VA(200,":"O",1:0)
	I FBPROG(1)=7 W *7,! S FBMESS="Fee program is community nursing home." D WRITE S FBMESS="Payments should not be authorized." D WRITE S FBOUT=1 Q
	I FBPROG(1)=6 S DIR(0)="YO",DIR("A")="Is this an ancillary payment",DIR("B")="No" D ^DIR K DIR S:$D(DIRUT) FBOUT=1 Q:$G(FBOUT)  S FBANC=+Y
	S FBPROG="I $P(^(0),""^"",9)[""FB583(""&($P(^(0),""^"",3)="_FBPROG(1)_")"
	S X=FBAIEN,CNT=X,CNT(CNT)=X D 2^FBAAUTL1 I $D(DUOUT)!(FTP']"") S FBOUT=1 Q
	I 'FBAIEN W *7 S FBMESS="No authorization associated with this 583!" D WRITE S FBOUT=1 Q
	;I FB583'=FBDA W *7 S FBMESS="Authorization does not pertain to the selected unauthorized claim." D WRITE S FBOUT=1 Q
	I FBTYPE'=FBPROG(1) W *7 S FBMESS="Authorization Fee program differs from Fee program in Unauthorized Claim." D WRITE S FBOUT=1 Q
	S FBV583=FB583_";FB583("
	D CR Q:FBOUT
	D HOME^%ZIS W @IOF,!?25,"< UNAUTHORIZED CLAIM >",!! S DIC="^FB583(",DA=FB583,DR="",DIQ(0)="C" D EN^DIQ W ! K DIC,DIQ,DR,DA,CNT,X
	D CR Q:FBOUT
	D  ;G 2:FBPROG(1)=2,3:FBPROG(1)=3,6:FBPROG(1)=6,7:FBPROG(1)=7
	.;payment for outpatinet
	.I FBPROG(1)=2 D EN583^FBAACO Q
	.;payments for pharmacy
	.I FBPROG(1)=3 D ^FBAAPIE Q
	.;payments for civil hospital
	.I FBPROG(1)=6 S FBI7078=FB583_";FB583(",$P(FBZ(0),"^",4)=$P(FBZ,U,5),FBRESUB="" D EN583^FBCHEP:'FBANC,EN583^FBCHCO:FBANC Q
	.;payments for community nursing home
	.I FBPROG(1)=7 W *7,! S FBMESS="Fee program is community nursing home." D WRITE S FBMESS="Payments should not be authorized." D WRITE
	Q
END	;kill variables and quit
	K FB,FBAABDT,FBAAEDT,FBAAOUT,FBAAPTC,FBAIEN,FBANC,FBASSOC,FBARY,FBCNT,FBDA,FBD1,FBFDC,FBI,FBIEN,FBIX,FBI7078,FBMST,FBO,FBOUT
	K FBRESUB,FBTTYPE,FBDMRA,FBMESS,FBPAY,FBPOV,FBPSA,FBPROG,FBPT,FBSUBMIT,FBTP,FBTT,FBTYPE,FBVEN,FBVET,FBV583,FBZ,FB583,FB7078,FTP
	K CNT,DFN,D0,DTOUT,DUOUT,DIC,DIR,DIRUT,DTOUT,DUOUT,TA,X,Y,^TMP("FBARY",$J)
	Q
WRITE	;write message
	W !?5,FBMESS
	Q
CR	;ask carriage return to continue
	S DIR(0)="E" D ^DIR K DIR I $D(DUOUT)!($D(DTOUT)) S FBOUT=1
	Q

FBUCPEND
FBUCPEND	;ALBISC/TET - UNAUTHORIZED CLAIM PENDING INFO ;7/1/93  15:40
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
REQ	;request pending information, called from fbucen & fbuced
	;INPUT:  FBDA = internal entry number of unauthorized claim
	;        displays from file 162.93, requested information
	;OUTPUT: FBARY = array of user selection, FBOUT = 1 if timed out, otherwise 0
	S:'$D(FBOUT) FBOUT=0
	I +$G(FBDA) D DISP8^FBUCUTL5(FBDA) Q:FBOUT  ;check if any info requested and not received
	I +$G(^TMP("FBAR",$J,"FBAR")) W @IOF,!,"The following information has been requested:",!! D  Q:FBOUT
	.D DISPX^FBUCUTL1(0) K ^TMP("FBAR",$J) ;F FBZ=1:1:$S((IOSL-$Y)'>0:1,1:(IOSL-($Y+15))) W !
	.W:($Y+4)>IOSL ! D CR^FBUCUTL1 Q:FBOUT  ;return to continue
	D DISP9^FBUCUTL5(162.93) ;set array for selection
	D DISPX^FBUCUTL1(2) Q:FBOUT  ;display/select choices, and display selection
	N FBI,FBZ,Y
	I +$G(FBARY) S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBZ=$G(^(FBI)) I FBZ[";OTHER" S DIR(0)="162.8,.04",DIR("A")="OTHER Reason" D ^DIR K DIR S:$D(DIRUT) FBOUT=1 S:'FBOUT ^TMP("FBARY",$J,FBI,"PEND")=Y
	K ^TMP("FBAR",$J) Q
FREQ	;file requests, called from fbucen & fbuced
	;INPUT:  FBDA = ien of 162.7, unauthorized claim
	;        FBARY = array of user selection
	;OUTPUT: none, updates file 162.8, unauthorized claim pending info
	N DA,DIC,FBCT,FBLOCK,FBOTHER,FBPEND,FBPI,FBZ,X,Y
	S DIC="^FBAA(162.8,",DIC(0)="MZ",FBPI=0
	F  S FBPI=$O(^TMP("FBARY",$J,FBPI)) Q:'FBPI  S FBZ=$G(^(FBPI)),FBPEND=+FBZ D
	.N FBDUP,FBZZ,FBI S (FBI,FBDUP)=0 F  S FBI=$O(^FBAA(162.8,"AUI",FBDA,FBPEND,FBI)) Q:'FBI!(FBDUP)  S FBZZ=$G(^FBAA(162.8,FBI,0)) I FBZZ]"",'$P(FBZZ,U,5) S FBDUP=1
	.I 'FBDUP,$G(^FB(162.93,FBPEND,0))]"" S X=DT K DD,DO D FILE^DICN I $P(Y,U,3) D  ;file info requested if not already requested or requested and received
	..S FBOTHER=$G(^TMP("FBARY",$J,FBPI,"PEND")),DIE=DIC,DR="[FB UNAUTHORIZED PENDING]",DA=+Y
	..D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAA(162.8,DA) K DA,DR,DQ,FBLOCK
	K FBARY,^TMP("FBARY",$J) Q
REC	;receive info selection, called from fbuced
	;INPUT:  FBDA = ien of unauthorized claim - displays what has been requested
	;OUTPUT:  FBARY = array of user selection, FBOUT = 1 if timed out, otherwise 0
	D DISP8^FBUCUTL5(FBDA) Q:FBOUT
	D DISPX^FBUCUTL1(2)
	K ^TMP("FBAR",$J) Q
FREC	;file data for received info, called from fbuced
	;INPUT:  FBDA = ien of 162.7, unauthorized claim
	;        FBARY = array of user selection
	;OUTPUT:  none, updates file 162.8, unauthorized claim pending info
	N FBARY,FBI,FBLOCK,FBX,FBZ,DA,DIE,DR S FBARY=$G(^TMP("FBARY",$J,"FBARY"))
	I +FBARY S DIE="^FBAA(162.8,",DR=".05///^S X=DT;.06////^S X=DUZ" S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBZ=$G(^TMP("FBARY",$J,FBI)) I FBZ]"" D
	.S FBX=$P($P(FBZ,";",2),U) I FBX="OTHER",$P(FBZ,U,3)]"" S FBX=$P(FBZ,U,3)
	.S DA=+FBZ I DA D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FBAA(162.8,DA) W !,"Receiving ",FBX K DA,FBLOCK
	K DIE,DA,DR,^TMP("FBARY",$J),FBARY Q

FBUCSTAT
FBUCSTAT	;AISC/DMK-UNAUTHORIZED CLAIM STATS ;5/27/93  22:21
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	N FBPOP,PGM,Q,VAL,VAR S Q="",$P(Q,"-",80)="-"
	W !!?14,"UNAUTHORIZED CLAIM DISPOSITION AND STATUS STATISTICS",!?14,$E(Q,1,52),!
	D DATE^FBAAUTL G END:FBPOP S FBBEG=BEGDATE,FBEND=ENDDATE
	S VAR="FBBEG^FBEND",VAL=FBBEG_"^"_FBEND,PGM="START^FBUCSTAT" D ZIS^FBAAUTL G END:FBPOP
START	;Entry point for tasked job
	U IO S Q="",$P(Q,"-",80)="-"
	S Y=FBBEG D PDF^FBAAUTL S FBSTART=Y,Y=FBEND D PDF^FBAAUTL S FBFINISH=Y D HED
	S FBD(99)=0 F I=1:1:5 S FBD(I)=0 F J=40,70,90 S FBD(I,J)=0
	F I=5,10,20,30,50,55,60,80 S FBD(99,I)=0
	S FBUC=$$FBUC^FBUCUTL2(1)
	S FBBEG=FBBEG-.1 F I=FBBEG:0 S I=$O(^FB583("B",I)) Q:I'>0!(I>FBEND)  F J=0:0 S J=$O(^FB583("B",I,J)) Q:J'>0  I $D(^FB583(J,0)) S FB(0)=^(0),FBS=$$ORDER^FBUCUTL(+$P(FB(0),"^",24)) I FBS D
	.S FBD=+$P(FB(0),"^",11) S PSA=+$P(FB(0),"^",7) S:'$D(FB(PSA)) FB(PSA)=0
	.I "^5^10^30^50^55^60^80^"[(U_FBS_U) S FBD(99,FBS)=FBD(99,FBS)+1,FBD(99)=FBD(99)+1
	.I "^40^70^90^"[(U_FBS_U) Q:'FBD  S FBD(FBD,FBS)=FBD(FBD,FBS)+1,FBD(FBD)=FBD(FBD)+1
	.;Q:'$$PAY^FBUCUTL(J,"FB583")
	.S FB("PD")=0 S FB("J")=J_";FB583(",ZZ=0 F  S ZZ=$O(^FBAAI("E",FB("J"),ZZ)) Q:ZZ'>0  S FB("PD")=FB("PD")+$P($G(^FBAAI(ZZ,0)),"^",9)
	.S ZZ=0 F  S ZZ=$O(^FBAA(162.1,"AO",FB("J"),ZZ)) Q:ZZ'>0  S FB("PD")=FB("PD")+$P($G(^FBAA(162.1,ZZ,0)),"^",7)
	.I $O(^FBAAC("AM",FB("J"),0)) F II=0:0 S II=$O(^FBAAC("AM",FB("J"),$P(FB(0),"^",4),II)) Q:'II  F JJ=0:0 S JJ=$O(^FBAAC("AM",FB("J"),$P(FB(0),"^",4),II,JJ)) Q:'JJ  F KK=0:0 S KK=$O(^FBAAC("AM",FB("J"),$P(FB(0),"^",4),II,JJ,KK)) Q:'KK  D
	..I $D(^FBAAC($P(FB(0),"^",4),1,II,1,JJ,1,KK,0)) S FB("PD")=FB("PD")+$P(^(0),"^",3)
	.S FB(PSA)=FB(PSA)+FB("PD") K FB("PD")
	.K ZZ,FB("J"),II,JJ,KK
	W !?50,"CATEGORY OF DISPOSITION",!?3,"TYPE OF",?31,"# OF",!?3,"DISPOSITION",?31,"CLAIMS",?45,"INITIAL",?57,"APPEAL",?69,"COVA APPEAL",!,Q,!
	S FBD=0,FB="0^0^0^0"
	F  S FBD=$O(^FB(162.91,FBD)) Q:FBD'>0  I $D(^FB(162.91,FBD,0)) W !,?3,$P(^(0),"^"),?32,$J(FBD(FBD),5) S $P(FB,"^")=$P(FB,"^")+FBD(FBD),FBS=0 D
	.F  S FBS=$O(FBD(FBD,FBS)) Q:FBS'>0  W ?$S(FBS=40:45,FBS=70:57,1:69),$J(FBD(FBD,FBS),5) S X=$S(FBS=40:2,FBS=70:3,1:4),$P(FB,"^",X)=$P(FB,"^",X)+FBD(FBD,FBS)
	W !,?32,"-----",?45,"-----",?57,"-----",?69,"-----",!?9,"TOTAL DISPOSITIONED",?32,$J($P(FB,"^"),5),?45,$J($P(FB,"^",2),5),?57,$J($P(FB,"^",3),5),?69,$J($P(FB,"^",4),5)
	W !?5,"TOTAL NOT DISPOSITIONED",?32,$J(FBD(99),5),!?32,"-----",!?16,"TOTAL CLAIMS",?32,$J(FB+FBD(99),5)
	I $P(IOST,"-")="C" W ! D HANG^FBAAUTL1 G END:$D(DIRUT) D HED
	W !!?3,"STATUS OF CLAIMS NOT DISPOSITIONED",!!?3,"STATUS",?40,"# OF CLAIMS",!
	S FBS=0 F  S FBS=$O(FBD(99,FBS)) Q:FBS'>0  D
	.I FBS=5,'$P(FBUC,U,7)&(FBD(99,FBS)=0) Q
	.W !?3,$P($G(^FB(162.92,$$STATUS^FBUCUTL(FBS),0)),"^"),?40,$J(FBD(99,FBS),5)
	I $P(IOST,"-")="C" W ! D HANG^FBAAUTL1 G END:$D(DIRUT) D HED
	W !!?3,"TOTAL DOLLARS APPROVED BY PSA:",!
	S FB=0 F PSA=0:0 S PSA=$O(FB(PSA)) Q:PSA'>0  W !?3,$P($G(^DIC(4,PSA,0)),"^") S X=FB(PSA),X2="2$",FB=FB+X D COMMA^%DTC W ?34,X
	S X=FB,X2="2$",Y="" D COMMA^%DTC W !?32,"-------------",!?34,X
END	K DIRUT,I,J,Q,X,X2,FB,PSA,FBBEG,FBEND,FBSTART,FBFINISH,FBD,FBUC,BEGDATE,ENDDATE,Y,FBS
	D CLOSE^FBAAUTL Q
HED	W:$P(IOST,"-")="C" @IOF W !?14,"UNAUTHORIZED CLAIM DISPOSITION AND STATUS STATISTICS",!?14,$E(Q,1,52)
DAT	W !?17,"Date Range Selected: ",FBSTART," to ",FBFINISH,!?17,$E(Q,1,41),! Q

FBUCUPD
FBUCUPD(FBUCP,FBUCPA,FBUCA,FBUCAA,FBDA,FBACT,FBUCDISR)	;ALBISC/TET - UPDATE AFTER EVENT ;7/7/93  18:53
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
UPDATE	;update if before and after values differ
	;INPUT:  FBUCP - zero node of 162.7, prior
	;        FBUCPA- 'A' (appeal)  node of 162.7, prior
	;        FBUCA - zero node of 162.7, after
	;        FBUCAA- 'A' (appeal) node of 162.7, after
	;        FBDA    - IEN of 162.7
	;        FBACT - action type
	;        FBUCDISR - (option) exists if disapp.
	;           1 = denial reasons for gr to be same as prim
	;           0 = ask denial reason for each claim in gr
	;VARIABLES:
	;        FBSTATUS - 0 if no change, or status ien to 162.92
	;        FBORDER  - order number of status in 162.92
	;        FBLET    - = 1 if status or disp. changed (letter should be printed)
	;        FBDISP   - flag if disp. changed to approved from other
	;                    than approved.  1 to delete disap. reasons
	;                                    0 no action
	;        FBDISPDT - date disp. changed, 0 if no change, "@" to delete
	;        FBEXP    - exp. date, 0 if no change, "@" to delete
	;                    or new date in internal format
	;        FBVALID  - valid date claim rec., 0 if no change, "@" to delete
	;                    or today's date in internal format
	;        FBORIG   - date of original disp. or "@" to delete
	;                    to approve.  1 is to set in file 161, 0 is to delete.
	I $S('+$G(FBDA):1,$G(FBACT)']"":1,$G(FBUCA)']"":1,1:0) G END
AUTH	;determine if auth. needs to be updated, based upon disp.
	;returns variable FBAUTH, may returne FBOUT
	D AUTH^FBUCUPD1(FBUCP,FBUCA,FBDA,FBACT)
	;
Q	;enter code to task remainder of update here
	;S ZTRTN="DQ^FBUCUPD",ZTDESC="UPDATE UNAUTH CLAIM",ZTDTH=$H,ZTIO="",ZTSAVE("FBUCP")="",ZTSAVE("FBUCPA")="",ZTSAVE("FBUCA")="",ZTSAVE("FBUCAA")="",ZTSAVE("FBDA")="" S:$D(FBAUTH) ZTSAVE("FBAUTH")=""
	;D ^%ZTLOAD G END
	;
DQ	;de-queue tasked job here
	D:$D(XRTL) T0^%ZOSV ;start monitor
	N FBD1,FBD2,FBDISP,FBDISPDT,FBEXP,FBLET,FBORDER,FBORIG,FBST,FBSTATUS,FBUC,FBVALID S (FBDISP,FBDISPDT,FBEXP,FBLET,FBORDER,FBORIG,FBSTATUS,FBVALID)=0,FBUC=$$FBUC^FBUCUTL2(1)
	;
STATUS	;determine status of claim
	;FBST=status of claim prior to update;updated to most current
	S FBST=$$ORDER^FBUCUTL(+$P(FBUCA,U,24)) I FBST<40 S FBST=$S($$PEND^FBUCUTL(FBDA):10,$P(FBUC,U,7)&(FBACT="ENT"):5,1:30)
	;
DISP	;dispostion change
	I $P(FBUCP,U,11)'=$P(FBUCA,U,11),$P(FBUCA,U,11) D
	.S FBST=$S($P(FBUCAA,U,6):90,$P(FBUCAA,U,4):70,1:40)
	.S FBDISPDT=DT,FBORIG=$S('$P(FBUCP,U,11)&(FBST=40):DT,1:0)
	I $P(FBUCP,U,11)'=$P(FBUCA,U,11),'$P(FBUCA,U,11) D
	.N FBO S FBO=$$ORDER^FBUCUTL(+$P(FBUCP,U,24))
	.I FBO=90 S FBST=$S($P(FBUCAA,U,5):80,1:70)
	.I FBO=70 S FBST=$S($P(FBUCAA,U,3):60,$P(FBUCAA,U,2):55,$P(FBUCAA,U):50,1:40)
	.I FBO=40 S FBST=$S($$PEND^FBUCUTL(FBDA):10,1:30)
	.S FBDISPDT="@",FBORIG=$S($$ORDER^FBUCUTL($P(FBUCP,U,24))=40:"@",1:0)
	I $P(FBUCP,U,11)'=$P(FBUCA,U,11) S FBLET=1 S FBD1=$P(FBUCP,U,11),FBD2=$P(FBUCA,U,11) I "^2^3^5^"[FBD1,"^1^4^"[FBD2 S FBDISP=1
	I $P(FBUCP,U,11)=$P(FBUCA,U,11),FBUCPA=FBUCAA S FBST=$S($P(FBUCA,U,11):40,1:FBST)
	;
APPEAL	;appeal change - check if disposition remains unchanged
	I FBUCAA]""!(FBUCPA'=FBUCAA) D
	.S FBST=$S('$P(FBUCAA,U):40,'$P(FBUCAA,U,2):50,'$P(FBUCAA,U,3):55,'$P(FBUCAA,U,4):60,'$P(FBUCAA,U,5):70,'$P(FBUCAA,U,6):80,$P(FBUCAA,U,6):90,$P(FBUCAA,U,5):80,$P(FBUCAA,U,4):70,$P(FBUCAA,U,3):60,$P(FBUCAA,U,2):55,$P(FBUCAA,U):50,1:FBST)
	;
	S FBORDER=FBST,FBSTATUS=$$STATUS^FBUCUTL(FBORDER) S:FBORIG]"" $P(FBUCA,U,22)=$S(FBORIG="@":"",FBORIG=0:"",1:FBORIG)
	I FBSTATUS,FBSTATUS'=$P(FBUCA,U,24)!(FBUCP']"")!((FBORDER=10)&("^ENT^REQ^"[FBACT)) D
	.S FBLET=$S(FBORDER=10:1,FBORDER=40&(FBACT="ENT"):1,FBORDER=$$ORDER^FBUCUTL(+$P(FBUCA,U,24)):0,1:1) I FBLET S FBLET=$S($$LETTER^FBUCUTL2(FBORDER):1,1:0)
	.S FBVALID=$S(FBORDER>20&('$P(FBUCA,U,8))&('$$PEND^FBUCUTL(FBDA)):DT,FBORDER<20&($P(FBUCA,U,8)):"@",1:0)
	S:'FBLET FBEXP=$$EXPIRE^FBUCUTL8(FBDA,$S(FBORDER>$$ORDER^FBUCUTL(+$P(FBUCA,U,24)):$S('$P(FBUCA,U,25):DT,1:+$P(FBUCA,U,25)),FBORDER=55:+$P(FBUCAA,U,2),1:DT),FBUCA,FBORDER)
	;
DIE	;die update
	I $S(FBSTATUS:1,FBVALID'=0:1,FBEXP'=0:1,FBLET:1,FBORIG'=0:1,FBDISPDT'=0:1,1:0) S DA=FBDA,DIE="^FB583(",DR="[FB UNAUTHORIZED UPDATE]" D
	.D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE D  L -^FB583(FBDA)
	..I FBUCP'=FBUCA!(FBUCPA'=FBUCAA) S DR="27////^S X=DUZ;28///^S X=DT" D ^DIE
	.K DIE,DA,DR,DQ,FBLOCK
	.D:FBDISP DELDAP^FBUCUTL3(FBDA)
	.I $G(FBUCDISR)=0!($P($G(FBUCDISR),U)=1) D DISAPR^FBUCUTL8
	S:$D(XRT0) XRTN=$T(+0) D:$D(XRT0) T1^%ZOSV ;stop monitor
	;
LETTER	;letter denoting change of status or disposition
	N FBLETDT I FBLET D AUTO^FBUCLET(FBDA,FBORDER,FBUCA,FBUC) ;print letter/update fields if letter prints
END	;kill variables and quit
	K FBAUTH,FBLOCK,FBUCAA,FBUCP,FBUCPA,XRT0,XRTN,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE Q

FBUCUPD1
FBUCUPD1	;ALBISC/TET - UPDATE AFTER EVENT (CONTINUED) ;4/21/93  20:41
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;called from fbucupd
AUTH(FBUCP,FBUCA,FBDA,FBACT)	;update authorization in authorization file
	;INPUT:  ;function call to determine action,
	;         0 to kill/1 to set/2 to change/null for no change
	;        FBUCP  - data prior to edit
	;        FBUCA  - data after edit
	;        FBDA   - ien of unauthorized claim, file 162.7
	;        FBACT - action type
	;OUTPUT:  -- update patient's authorization
	;        will add if entry not already there,
	;        delete or change if entry already there,
	;        otherwise will quit (based on variables FBAUTH and FBIEN)
	;        FBOUT = 1 if timed out, otherwise 0
	N FBAUTH S FBAUTH=$$AUTH^FBUCUTL6(FBUCP,FBUCA) G:FBAUTH']"" AUTHQ
	N FBAUTHF,FBDCHG,FBIEN,FBLOCK,FBV,FBVET,FBY,DA,DIC,DIE,DIK,DIR,DR,DTOUT,DUOUT,X,Y S FBDCHG=0 S:'$D(FBOUT) FBOUT=0
	S FBV=FBDA_";FB583(" S:'$D(FBVET) FBVET=+$P(FBUCA,U,4),FBIEN=+$O(^FBAAA("AG",FBV,FBVET,0))
	I FBAUTH'=1,FBIEN D  ;delete or edit & entry exists
	.I FBAUTH=0,'$$PAY^FBUCUTL(FBDA,"^FB583(") D
	..N FBAIEN W !,"Deleting authorization...",!
	..S DA(1)=FBVET,DA=FBIEN,DIK="^FBAAA("_DA(1)_",1," D ^DIK K DIK
	..S FBAIEN=+$P(FBUCA,U,27) I FBAIEN D UPDATE1("@",FBDA)
	.I FBAUTH=2 D UPDATE
	I FBAUTH=1,FBIEN,FBACT="REO" D UPDATE
	I FBAUTH=1,'FBIEN D  ;add & entry not already in file
	.;check if vet in file, if not add
	.S Y=0 N FBAIEN,FBVAR I '$D(^FBAAA(FBVET,0)) S Y=$$FILE^FBUCUTL("^FBAAA(",FBVET,1) Q:+Y'>0  S FBVET=+Y,^FBAAA(FBVET,1,0)="^161.01D^^"
	.I +Y'>0 S:'$D(^FBAAA(FBVET,1,0)) ^FBAAA(FBVET,1,0)="^161.01D^^"
	.I "^6^7^"[$P(FBUCA,U,2) D
	..S DIR(0)="161.01,.06",DIR("B")="DISCHARGE" D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	..I FBOUT&($P(FBUCA,U,2)=6) W !,*7,"Discharge type is missing!  Enter using the Re-open Unauthorized Claim option.",! H 3
	..S:'FBOUT FBDCHG=Y
	.S DIE="^FBAAA("_FBVET_",1,",FBAUTHF=+$P(FBUCA,U,13) I FBAUTHF S Y=$$FILE^FBUCUTL(DIE,FBAUTHF,0,FBVET) Q:+Y'>0  S (FBAIEN,FBIEN)=+Y,DA=FBVET,DR="[FB UNAUTHORIZED UPDATE]",DIE="^FBAAA("
	.I FBAUTHF D LOCK^FBUCUTL(DIE,FBVET,1) I FBLOCK D ^DIE L -^FBAAA(FBVET) K DA,DIE,DQ,DR,FBLOCK D UPDATE1(FBAIEN,FBDA) ;S:$D(DTOUT) FBOUT=1 I 'FBOUT D UPDATE1(FBAIEN,FBDA)
AUTHQ	K DA,DIC,DIE,DQ,DR,DTOUT,DUOUT,FBDCHG,X,Y Q
UPDATE	;update if there is a change - keeps 583 and authorization in sync
	N DA,DIE,DR,FBLOCK
	S DA=FBVET,DR="[FB UNAUTHORIZED UPDATE1]",DIE="^FBAAA("
	D LOCK^FBUCUTL(DIE,FBVET,1) I FBLOCK D ^DIE L -^FBAAA(FBVET)
	Q
UPDATE1(FBAIEN,FBIEN)	;update authorization field (# 30) for unauthorized claim
	;INPUT:  FBAIEN = internal entry number of authorization (could be '@' for deletion
	;        FBIEN  = internal entry number of u/c (may be fbda)
	;        FBALL  = flag to update all other claims (1=update all)
	;OUTPUT: update field 30 (AUTHORIZAITION) to value of fbaien
	N DA,DIE,DR,FBLOCK I $S(+$G(FBAIEN)'>0&(FBAIEN'="@"):1,'+$G(FBIEN):1,FBAIEN'?1N.N&(FBAIEN'="@"):1,1:0) Q
	S DA=FBIEN,DIE="^FB583(",DR="S:FBAIEN=""@"" Y=""@1"";30////^S X=FBAIEN;S Y=""@99"";@1;30///@;@99" D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -^FB583(FBIEN)
	Q

FBUCUTL
FBUCUTL	;ALBISC/TET - UNAUTHORIZED CLAIMS UTILITY ;4/9/93  09:25
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
CDTC(X1,X2)	;date comparison
	;INPUT:  X1 = date
	;        X2 = days to subtract or add
	;OUTPUT: date less/plus x days
	N X D C^%DTC K %H Q $G(X)
	;
DTC(X1,X2)	;days between two days
	;INPUT:  X1 = date one
	;        X2 = date two
	;OUTPUT: difference between two days
	N X,%Y D ^%DTC K %Y Q $G(X)
	;
VET(X)	;veteran name
	;INPUT:  internal entry number of veteran
	;OUTPUT: veteran name or unknown
	S X=$G(^DPT(+X,0)) Q $S($P(X,U)]"":$P(X,U),1:"UNKNOWN")
	;
VEN(X)	;vendor name
	;INPUT:  internal entry number of vendor
	;OUTPUT: vendor name or unknown
	S X=$G(^FBAAV(+X,0)) Q $S($P(X,U)]"":$P(X,U),1:"UNKNOWN")
	;
PROG(X)	;fee program name
	;INPUT:  internal entry number of fee program
	;OUTPUT: fee program name or unknown
	S X=$G(^FBAA(161.8,+X,0)) Q $S($P(X,U)]"":$P(X,U),1:"UNKNOWN")
	;
PTR(FBGL,FBIEN)	;get .01 value of pointer
	;INPUT:  FBGL = global root
	;        FBIEN = internal entry number (DA) of pointed to file
	;OUTPUT: zero node, or 'UNKNOWN'
	N FBVAL,NODE S NODE=FBGL_+FBIEN_",0)"
	S FBVAL=$G(@(NODE))
	Q $S(FBVAL]"":FBVAL,1:"UNKNOWN")
	;
LOCK(FBGL,FBDA,GO)	;lock entry before editing
	;INPUT:  FBGL = global root
	;        FBDA = interal entry number of file
	;        GO   = 1 to continue to try (enter/updates),
	;               0 to notify user and quit on failure (edits)
	;         (optional, if not set will be set to 0)
	;OUTPUT: FBLOCK = 1 if successful; 0 if failed
	;        incremental lock may be issued
	S FBLOCK=0,GO=$S('$D(GO):0,1:+GO) I $S('$D(FBGL):1,FBGL']"":1,'$D(FBDA):1,'+FBDA:1,1:0) Q
	S FBGL=FBGL_FBDA_")"
L	L +@FBGL:2 S FBLOCK=$T I 'FBLOCK G:GO L W:'GO&('$D(ZTQUEUED)) !,"Another user is editing this entry."
	Q
DAYS(X)	;number of days associated with a status
	;INPUT:  X=ien of status in file 162.92
	;OUTPUT: 0 or number of days
	Q +$P($G(^FB(162.92,X,0)),U,3)
	;
DISAP(DA1,X)	;disapproval reason for disapproved dispositions
	;INPUT:  DA1 = DA of top level of record (DA(1))
	;        X   = ien of disapproval reason, 162.94
	;OUTPUT: none - entry to disapproval multiple if not already there, disapproval reason is active and disposition reason is other than approved.
	N Y,DA,DIC
	S DIC(0)="Z",DIC="^FB583("_DA1_",""D"","
	I $P(^FB583(DA1,0),U,11)>1,$P(^FB(162.94,+X,0),U,2),'$D(^FB583(DA1,"D","B",+X)) S:'$D(^FB583(DA1,"D")) ^FB583(DA1,"D",0)="^162.715PA^^"  S DA(1)=DA1 K DD,DO D FILE^DICN
	Q
STATUS(X)	;get status internal entry number
	;INPUT:  X = order number of status in file 162.92
	;OUTPUT: ien of status in file 162.92 (status file)
	Q +$O(^FB(162.92,"AO",X,0))
	;
ORDER(X)	;get order number of status
	;INPUT:  X = ien of status in file 162.92, status file
	;OUTPUT: order number of status
	S X=$G(^FB(162.92,+X,0)) Q +$P(X,U,4)
	;
PAY(X,FBGL)	;determine if any payments have been made
	;INPUT:  X= ien in file
	;        FBGL= global root
	;OUTPUT: 0 if no payments, 1 if payments
	S:$E(FBGL,1)="^" FBGL=$P(FBGL,"^",2) S FBGL=X_";"_FBGL
	Q $S(+$O(^FBAA(162.1,"AO",FBGL,0)):1,+$O(^FBAAC("AM",FBGL,0)):1,+$O(^FBAAI("E",FBGL,0)):1,1:0)
	;
OVER(KEY)	;determine if ability to override
	;INPUT:  KEY=security key
	;OUTPUT: 0 if not holder of key, 1 if holder of key
	Q $S($D(^XUSEC(KEY,DUZ)):1,1:0)
	;
UPOK(X)	;ok to update
	;INPUT:  X= ien of 162.7
	;OUTPUT: 0 if NOT OK to update, 1 if OK to update
	Q $S('$$PAY(X,"^FB583("):1,$$OVER("FBAASUPERVISOR"):1,1:0)
	;
TIME(ED)	;determine if expiration date passed
	;INPUT:  ED= expiration date
	;OUTPUT: 0 if late, 1 if within timeframe
	Q $S('ED:1,DT>ED:0,1:1)
UNTIME(FBX)	;write untimely message - called from input templates
	;INPUT:  FBX = disapproval reason
	W !?5,"Claim has been dispositioned to DISAPPROVED" W:+FBX !?8,"with disapproval reason of '",$P($$PTR("^FB(162.94,",FBX),U),"'.",!,*7
	Q
	;
FBZ(X)	;get zero node on 162.7
	;INPUT:  X = ien of 162.7, unauthorized claim file
	;OUTPUT: zero node of 162.7
	I '+X Q 0
	S X=+X Q $G(^FB583(X,0))
	;
FILE(FBGL,X,FBDI,FBDA1)	;add entry to file or subfile
	;INPUT:  FBGL = global root
	;        X    = value for .01 field
	;        FBDI = 1 for dinum entry, 0 or null if not (optional)
	;        FBDA1 = DA(1) value (optional), if doesn't exist will not set
	;OUTPUT: entry is added to designated file
	;        Y is returned  ien^value of .01 field^1
	N DA,DIC,DINUM,Y I $S(X']"":1,'$D(FBDI):1,+FBDI&(X'=+X):1,'$D(FBDA):1,1:0) Q ""
	I $D(FBDA1) S DA(1)=FBDA1
ADD	S:+FBDI DINUM=X S DIC(0)="MZ",DIC=FBGL K DD,DO D FILE^DICN G:+Y'>0 ADD K DIC,DINUM
	Q $G(Y)
	;
PEND(FBDA)	;check if any info pending for claim
	;INPUT:  FBDA = ien of unauthorized claim in 162.7
	;OUTPUT: 1 if info pending, otherwise 0
	Q $S(+$O(^FBAA(162.8,"ACD",FBDA,0)):1,1:0)

FBUCUTL1
FBUCUTL1	;ALBISC/TET - UNAUTHORIZED CLAIMS UTILITY (CONT'D) ;5/19/93  15:35
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
SELECT(I,DIRA)	;select from displayed list
	;INPUT:  FBAR and FBAR array - choices from which to select
	;        DIRA - optional, DIR("A")/ FBOUT = 0
	;OUTPUT: FBARY and FBARY array - selection
	;         or FBOUT = 1 if no selection or time out or up arrow
	Q:'+$G(FBAR)  N FBDCT S DIR(0)="LO^1:"_I_"^K:X#1 X",DIR("A")=$S('$D(DIRA):"Enter selection",DIRA']"":"Enter selection",1:DIRA) W ! D ^DIR K DIR S:$D(DTOUT)!($D(DUOUT)) FBOUT=1 Q:FBOUT!('Y)  I +Y S FBARY(0)=Y D SET(FBARY(0)) ;K FBARY(0)
	Q
SET(FBY)	;set up tmp global
	;INPUT:  FBY = user selection from list call
	;OUTPUT: TMP(FBARY array = user selection array
	;        FBARY = counter;piece location node
	N FBDCT,I
	S FBDCT=($L(FBY,","))-1,FBARY=FBDCT,$P(FBARY,";",2)=$S($G(FBAR)]"":$P(FBAR,";",2),1:""),^TMP("FBARY",$J,"FBARY")=FBARY F I=1:1:FBDCT I '($P(FBY,",",I)#1) S ^TMP("FBARY",$J,$P(FBY,",",I))=$G(^TMP("FBAR",$J,$P(FBY,",",I)))
	Q
DISPX(DISP,SCR)	;display array for user selection
	;INPUT:  DISP=0 to display only; make no selection
	;            =1 to display prior to selection only
	;            =2 to display what was selected in addition to what to select
	;        SCR = flag if data was screened; used in message if nothing found <optional>
	;        TMP("FBAR",$J,"FBAR")=count;piece position
	;        TMP("FBAR"=display global array of what to select
	;OUTPUT:  FBOUT = 0 if ok, 1 if time out or quit or no selection
	K ^TMP("FBARY") S:'$D(FBOUT) FBOUT=0 G:FBOUT END S DISP=+$G(DISP),SCR=+$G(SCR) N I,P,FBA,FBAR,FBCT,FBNODE,FBPL,FBW S (FBCT,FBARY)=0 S:$G(DISP)']"" DISP=0
	S FBAR=$G(^TMP("FBAR",$J,"FBAR")) I '+FBAR W ! W:'SCR "No data on file." W:SCR "Nothing found which meets the criteria." W ! H 2 G END
	D PARSE^FBUCUTL4(FBAR) ;I +FBAR=1 S FBARY(0)=1 D SET(FBARY(0)) ;S ^TMP("FBARY",$J,1)=^TMP("FBAR",$J,1),^TMP("FBARY",$J,"FBARY")=FBAR,FBARY=$G(^TMP("FBARY",$J,"FBARY"))
	I +FBAR!(DISP=0) W:DISP>0 @IOF W:DISP>0 !?3,"Select from the following:",!! S FBA="Enter RETURN for more, or Select",I=0 F  S I=$O(^TMP("FBAR",$J,I)) Q:'I!(FBARY&(DISP>0))  D  G:FBOUT END
	.I ($Y+5)>IOSL D SELECT(FBCT,FBA):FBCT&(DISP),CR:FBCT&('DISP) Q:FBOUT!(+FBARY&(DISP>0))  W @IOF,!
	.S FBCT=FBCT+1,FBNODE=$G(^TMP("FBAR",$J,I)) D LINE^FBUCUTL4(FBNODE,FBCT,$L(FBNODE,"^"),FBW)
	Q:FBOUT  W:'DISP ! I DISP,'+FBARY S FBCT=$S(FBCT:FBCT,1:+FBAR) D SELECT(FBCT) Q:FBOUT
DISPY	;display user selection
	;INPUT:  FBARY( - user selection array
	;        FBARY  - count in array;position locations (delimitted by ^)
	;        FBP    - number or '^' piece delimiters
	;        FBW    - write positions, delimited by '^'
	;OUTPUT: FBOUT  - 1 if time out or up arrow, 0 if OK
	S:'$D(FBOUT) FBOUT=0 S FBARY=$G(^TMP("FBARY",$J,"FBARY")) I $S('+FBARY:1,DISP'=2:1,1:0) G END
	N FBNODE,I I '$G(FBPL)!('$G(FBW)) N FBPL,FBW D PARSE^FBUCUTL4(FBARY)
	W ! S I=0 F  S I=$O(^TMP("FBARY",$J,I)) Q:'I  S FBNODE=$G(^(I)) D LINE^FBUCUTL4(FBNODE,I,FBPL,FBW) ;W ! F P=1:1:FBP W ?($P(FBW,U,P)),$P($P(FBARY(I),";",2),U,P) W:P=5 !
	I +FBARY S DIR(0)="Y",DIR("A")="You have selected the above.  OK",DIR("B")="YES" D ^DIR K DIR S:$D(DTOUT)!($D(DUOUT)) FBOUT=1 I 'Y,'FBOUT D DISPX(DISP)
END	;kill variables and quit
	K DIRUT,DTOUT,DUOUT,FBAR,X,Y Q
CR	;end of page
	W ! S DIR(0)="E" D ^DIR K DIR S:$D(DTOUT)!($D(DUOUT)) FBOUT=1
	Q

FBUCUTL2
FBUCUTL2	;ALBISC/TET - UTILITY (CONTINUED) ;7/7/93  18:52
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	;
ADDRESS(FBUCA)	;set up address
	;INPUT:  FBUCA = current (or after) zero node
	;OUTPUT: FBADD( array, subscripted by sequential number; FBADD = count
	N DFN,FBCT,FBDA,FBGL,FBIEN,FBP,FBSTATE,FBSUB,FBZ,FBZ11
	S FBSUB=$P(FBUCA,U,23),FBCT=0 S:FBSUB']"" FBSUB=$P(FBUCA,U,4)_";DPT(" S FBDA=+$P(FBSUB,";"),FBGL="^"_$P(FBSUB,";",2),FBZ=$$PTR^FBUCUTL(FBGL,FBDA) ;,FBV=$S('FBSUB:0,FBSUB'=2:$G(^FBAAV(+$P(FBUCA,U,3),0)),1:0)
	S FBCT=FBCT+1,FBADD(1)=$P(FBZ,U) I FBADD(1)["," S FBADD(1)=$P(FBADD(1),",",2)_" "_$P(FBADD(1),",")
	I FBSUB["FBAAV" S FBSTATE=$P($G(^DIC(5,+$P(FBZ,U,5),0)),U,2) D
	.F FBP=3,14 S:$P(FBZ,U,FBP)]"" FBCT=FBCT+1,FBADD(FBCT)=$P(FBZ,U,FBP)
	.S FBCT=FBCT+1,FBADD(FBCT)=$S($P(FBZ,U,4)]"":$P(FBZ,U,4),1:"     ")_"  "_$S(FBSTATE]"":FBSTATE,1:"  ")_"  "_$P(FBZ,U,6)
	I FBSUB["DPT" S DFN=+$P(FBUCA,U,4) D ADD^VADPT I 'VAERR D  K VAPA,VAERR
	.F FBP=1,2,3 S:VAPA(FBP)]"" FBCT=FBCT+1,FBADD(FBCT)=VAPA(FBP)
	.S FBCT=FBCT+1,FBADD(FBCT)=$S(VAPA(4)]"":VAPA(4),1:"     ")_"  "_$S($P(VAPA(5),U,2)]"":$P(VAPA(5),U,2),1:"  ")_"  "_$S('+$G(VAPA(11)):VAPA(6),$P(VAPA(11),U,2)]"":$P(VAPA(11),U,2),1:VAPA(6))
	I FBSUB["VA(200" S FBZ11=$G(^VA(200,FBDA,.11)) I FBZ11]"" S FBSTATE=$P($G(^DIC(5,+$P(FBZ11,U,5),0)),U,2) D
	.F FBP=1,2,3 S:$P(FBZ11,U,FBP)]"" FBCT=FBCT+1,FBADD(FBCT)=$P(FBZ11,U,FBP)
	.S FBCT=FBCT+1,FBADD(FBCT)=$S($P(FBZ11,U,4)]"":$P(FBZ11,U,4),1:"     ")_"  "_$S(FBSTATE]"":FBSTATE,1:"  ")_"  "_$P(FBZ11,U,6)
	S FBADD=FBCT
	Q
STATADD	;station address, from fee basis site parameter file
	;INPUT:  nothing
	;OUTPUT: FBSADD( array of station name,address, and number
	;called when printing a letter, used if letterhead not used
	K ^UTILITY("DIQ1",$J) N DIC,DA,DIQ,DR,FBCT,FBP S DIC="^FBAA(161.4,",DA=1,DIQ="FBSADD(" D
	.S DR="1:2;16",DIQ(0)="EN" D EN^DIQ1
	.S DR="3:5;35.6",DIQ(0)="E" D EN^DIQ1
	.;S DR=27,DIQ(0)="IN" D EN^DIQ1
	I $G(FBSADD(161.4,1,16,"E"))]"" S FBSADD(161.4,1,2.5,"E")=FBSADD(161.4,1,16,"E") K FBSADD(161.4,1,16,"E") ;set street address lines together
	S FBSADD(161.4,1,.01,"E")=$G(FBSADD(161.4,1,35.6,"E")) K FBSADD(161.4,1,35.6,"E") ;re-set so name is first
	S (FBCT,FBP)=0 F  S FBP=$O(FBSADD(161.4,1,FBP)) Q:FBP'<3!('FBP)  S:$G(FBSADD(161.4,1,FBP,"E"))]"" FBCT=FBCT+1,FBSADD(FBCT)=FBSADD(161.4,1,FBP,"E") K FBSADD(161.4,1,FBP)
	S FBCT=FBCT+1,FBSADD(FBCT)=$S($G(FBSADD(161.4,1,3,"E"))]"":FBSADD(161.4,1,3,"E"),1:"     ")_"  "_$S($G(FBSADD(161.4,1,4,"E"))]"":FBSADD(161.4,1,4,"E"),1:"  ")_"  "_$G(FBSADD(161.4,1,5,"E")) F FBP=3:1:5 K FBSADD(161.4,1,FBP)
	K ^UTILITY("DIQ1",$J) Q
STANUM	;get station number
	;INPUT:  nothing
	;OUTPUT: FBSTANUM = station number of PSA, as set in FB site parameter
	K ^UTILITY("DIQ1",$J) N DA,DIC,DIQ,DR S DA=1,DIC="^FBAA(161.4,",DIQ="FBSTA(",DR=27,DIQ(0)="IN" D EN^DIQ1 K ^UTILITY("DIQ1",$J)
	S FBSTANUM=$G(FBSTA(161.4,1,27,"I")) I FBSTANUM]"" S FBSTANUM=$P($G(^DIC(4,FBSTANUM,99)),U)
	K FBSTA(161.4) Q
LETTER(FBORDER)	;get letter ien number
	;INPUT:  FBORDER = order number of status
	;OUTPUT:  ien of letter or 0
	N Y S Y=+$O(^FB(162.92,"AO",FBORDER,0)) Q +$P($G(^FB(162.92,Y,0)),"^",5)
	;
TXT(FBGL,FBIEN,FBN,DIWF,DIWL,FBLET)	;write txt
	;INPUT:  FBGL = global root
	;        FBIEN = internal entry number of file
	;        FBN = node where wp info resides
	;        DIWF = format
	;        DIWL = left offset
	;        FBLET = 1 if coming from letter (optional)
	N FBI,FBNODE,FBTXT,X S FBNODE=FBGL_FBIEN_","_FBN S FBLET=$S('$D(FBLET):0,1:+FBLET)
	I $D(@(FBNODE_")")) S FBI=0 F  S FBI=$O(@(FBNODE_","_FBI_")")) Q:'FBI  S FBTXT=^(FBI,0),X=FBTXT D
	.I $Y+7>IOSL W @IOF D:FBLET HED^FBUCLET1
	.D ^DIWP
	I $Y+7>IOSL W @IOF D:FBLET HED^FBUCLET1
	D:$D(FBTXT) ^DIWW
	K FBLET Q
PAGE	;write page
	W @IOF Q
PDATE(FBDT)	;output fcn of date, long form
	;INPUT: FBDT = date for output
	;OUTPUT: month day, year
	N FBPDT,Y S Y=FBDT D PDATE^FBAAUTL Q $G(FBPDT)
	;
FBUC(X)	;unauthorized claim parameters
	;INPUT:  X = ien of parameter
	;OUTPUT: "UC" node in parameter file
	Q $G(^FBAA(161.4,X,"UC"))
	;
DIE(DIE,DA,DR)	;update a field
	;INPUT:  DIE = global root
	;        DA = record to be updated
	;        DR = field to be updated
	;OUTPUT: update record in file
	I $S($G(DIE)']"":1,$G(DR)']"":1,'+$G(DA):1,1:0) Q
	N FBLOCK
	D LOCK^FBUCUTL(DIE,DA,1) I FBLOCK D ^DIE L -@(DIE_DA_")") K FBLOCK
	Q

FBUCUTL3
FBUCUTL3	;ALBISC/TET - UTILITY CONTINUATION ;3/16/94  14:02
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DELDAP(FBDA)	;delete disapproval reasons from disapproval multiple in 162.7
	;if current disposition is 1 (approved) and prior was >1
	;INPUT:  FBDA = ien of unauthorized claim, 162.7
	;OUTPUT: none - delete disapproval reasons, if any, from claim
	N Y ;if coming from input template
	I $D(^FB583(FBDA,"D")) N DA,DIK,FBX S DA(1)=FBDA,DIK="^FB583("_FBDA_",""D"",",FBX=0 F  S FBX=$O(^FB583(FBDA,"D","B",FBX)) Q:'FBX  D
	.S DA=0 F  S DA=$O(^FB583(FBDA,"D","B",FBX,DA)) Q:'DA  D ^DIK
	K DA,DIK,FBX Q
DISDAP(FBDA)	;display disapproval reasons and enter in file if any selected
	;INPUT:  FBDA = ien of unauthorized claim, 162.7
	;OUTPUT:  if selection, and not already entered, reason is entered
	;          in REASON FOR DISAPPROVAL (field 15, subfile 162.715).
	;        FBOUT returned from call to FBUCUTL1
	N FBAR,FBARY,FBI,FBX
	D DISP9^FBUCUTL5(162.94) ;set array for selection
	D DISPX^FBUCUTL1(2) Q:FBOUT  ;display/select choices & display selection
	I 'FBOUT,+$G(FBARY) S FBI=0 F  S FBI=$O(^TMP("FBARY",$J,FBI)) Q:'FBI  S FBX=$G(^(FBI)) I +FBX D DISAP^FBUCUTL(FBDA,+FBX) ;file entry
	K FBARY,FBI,FBX,^TMP("FBAR",$J),^TMP("FBARY",$J) Q
ADD	;add new person to file 200, new person file, if other party submits claim
	S FBY=$$ADD^XUSERNEW(".111:.116;9")
	I +FBY>0,'$P(FBY,U,3) W !,"No entry has been made to the New Person file.",!,"If a new entry is needed, enter the name within quotes.",!,*7
	K FBY Q
DISPNP	;display letters not printed
	;INPUT:  none
	;OUTPUT: FBAR = display count in array;piece positions for display
	;        FBAR( array => ien;vet^ven^fee program^date of claim^status
	K ^TMP("FBAR",$J),FBAR N FBI,FBDCT,Z S (FBI,FBDCT)=0 F  S FBI=$O(^FB583("AL",1,FBI)) Q:'FBI  S Z=$G(^FB583(FBI,0)) I Z]"" D
	.S FBDCT=FBDCT+1,FBAR=FBI_";"_$E($$VET^FBUCUTL($P(Z,U,4)),1,12)_U_$E($$VEN^FBUCUTL($P(Z,U,3)),1,12)_U_$E($$PROG^FBUCUTL($P(Z,U,2)),1,14)_U_$$DATX^FBAAUTL($P(Z,U))_U_$E($P($G(^FB(162.92,+$P(Z,U,24),0)),U),1,16)
	.S ^TMP("FBAR",$J,FBDCT)=FBAR
	S FBAR=FBDCT I FBDCT S FBAR=FBAR_";"_"5^20^35^52^63^"
	S ^TMP("FBAR",$J,"FBAR")=FBAR
	Q
LOOKUP(FBO,FBSAVE)	;lookup claim, based on veteran/vendor, and status
	;INPUT:  FBO = order string or 0 for all
	;        FBSAVE = 1 to save xref variable (optional)
	;OUTPUT:  FBARY = count;position^position, etc
	;         TMP(FBARY => array of user selection
	;        FBIX & FBIEN (returned only if fbsave)
	S FBOUT=0 D IEN I 'FBIEN S FBOUT=1 G LOOKUPQ
	D DISP7^FBUCUTL5(FBIX,FBIEN,FBO) ;screen on status/order
	D DISPX^FBUCUTL1(1,FBO) ;display list from which to select
LOOKUPQ	K:'+$G(FBSAVE) FBIEN,FBIX K ^TMP("FBAR",$J) Q
IEN	;get ien of vendor or veteran from 162.7
	;OUTPUT:  FBIEN = ien of either vendor, veteran or other claimant
	;                 or 0 if failed/time out/up arrow out
	;         FBIX  = lookup cross reference (APMS, AVMS or AOMS)
	N DIR,DIRUT,DTOUT,DUOUT,Y S DIR(0)="162.7,23O",DIR("A")="Select unauthorized claim",DIR("?")="You may select the claim by entering the vendor, veteran or other party."
	D ^DIR K DIR S FBIEN=$S($D(DIRUT):0,+Y'>0:0,1:+Y),FBIX=$S(Y["VA":"AOMS",Y["FB":"AVMS",1:"APMS")
	Q
LETDATE	;ask for date letter sent, don't allow future values
	;INPUT:  FBOUT (optional) - flag if time out or up-arror out
	;OUTPUT: FBOUT - 1 if time out or up-arrow out
	;        FBLETDT - date if no fbout flag, otherwise 0
	N DIR,DIRUT,DTOUT,DUOUT,Y S FBLETDT=0 S:'$D(FBOUT) FBOUT=0 S DIR(0)="162.7,19.5" D ^DIR K DIR S:$D(DTOUT)!($D(DUOUT)) FBOUT=1 I 'FBOUT S FBLETDT=Y
	Q
AUTHLKUP(FBUCP,FBDA)	;look up authorization - match on 583,vendor,program,auth from & to dates and veteran
	;INPUT:  FBUCP = prior zero node of 162.7, unauthorized claim
	;        FBDA  = ien of unauthorized claim
	;OUTPUT: FBIEN = 0 if no match, otherwise ien of authorization
	S FBIEN=0 I $S('+$G(FBDA):1,$G(FBUCP)']"":1,1:0) Q
	N FBDA1,FBI,FBZ S FBDA1=+$P(FBUCP,U,4),FBI=0
	F  S FBI=$O(^FBAAA("ATST",+$P(FBUCP,U,13),FBDA1,0)) Q:'FBI  S FBZ=$G(^FBAAA(FBDA1,1,FBI,0)) I $P(FBZ,U,2)=$P(FBUCP,U,14),$P(FBZ,U,3)=$P(FBUCP,U,2),$P(FBZ,U,4)=$P(FBUCP,U,3),+$P(FBZ,U,9)=FBDA S FBIEN=FBI Q
	Q
EDOK(X,FBW)	;ok to edit modify/reopen or disposition input templates
	;INPUT:  X= ien of 162.7
	;        FBW= 1 to write, 0 not to write (optional)
	;OUTPUT: 0 if NOT OK to edit; 1 if ok to edit
	N FBY S FBY=1 S:'$G(FBW) FBW=0
	I $$PAY^FBUCUTL(X,"^FB583(") D
	.W:FBW !,"Payments on file!",*7,!
	.I '$$OVER^FBUCUTL("FBAASUPERVISOR") W:FBW !,"You must hold the supervisor's key to edit any data other than Amount Approved.",! S FBY=0
	Q FBY
	;

FBUCUTL4
FBUCUTL4	;ALBISC/TET - UTILITY CONTINUATION ;5/14/93  15:06
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
PRIME(FBDA,FBUCP)	;determine if claim is a primary (points to itself)
	;INPUT:  FBDA = ien of unauthorized claim
	;        FBUCP = zero node of fbda
	;OUTPUT: 1 if yes, 0 if no
	Q $S('+$G(FBDA):0,$G(FBUCP)']"":0,FBDA=$P(FBUCP,U,20):1,1:0)
	;
SECOND(FBDA,FBUCP)	;determine if claim is a secondary (points to another)
	;INPUT:  FBDA = ien of unauthorized claim
	;        FBUCP = zero node of fbda
	;OUTPUT: 1 if yes, 0 if no
	Q $S('+$G(FBDA):0,$G(FBUCP)']"":0,FBDA'=$P(FBUCP,U,20):1,1:0)
	;
LINK(FBDA,FBUCP)	;is this a claim which can be linked to a primary?
	;claims which can be linked are only primaries with no secondaries OR only secondaries
	;INPUT:  FBDA = ien of unauthorized claim
	;        FBUCP = zero node of unauthorized claim
	;OUTPUT: 1 if yes, 0 if no
	I $S('+$G(FBDA):1,$G(FBUCP)']"":1,1:0) Q 0
	Q $S($$SECOND(FBDA,FBUCP):1,$$PRIME(FBDA,FBUCP)&('+$O(^FB583("AMS",+$P(FBUCP,U,20),0))):1,1:0)
	;
LINKTO(FBDA,FBUCP,FBLINK)	;is this a primary claim to which a secondary can be linked?
	;claim which is a primary and not claim selected to be linked
	;INPUT:  FBDA = ien of unauthorized claim
	;        FBUCP = zero node of unauthorized claim
	;        FBLINK = claim ien which is to be linked
	;OUTPUT: 1 if yes, 0 if no
	I $S('+$G(FBDA):1,$G(FBUCP)']"":1,'+$G(FBLINK):1,1:0) Q 0
	Q $S($$PRIME(FBDA,FBUCP)&(FBDA'=FBLINK):1,1:0)
	;
ID	;display identifiers
	N FBZ S FBZ=$$FBZ^FBUCUTL(+Y)  Q:Y']""  W ?15,$E($$VET^FBUCUTL(+$P(FBZ,U,4)),1,20),?38,$E($$VEN^FBUCUTL(+$P(FBZ,U,3)),1,20)
	W ?61,$E($$PROG^FBUCUTL(+$P(FBZ,U,2)),1,14),!,$E($P($$PTR^FBUCUTL("^FB(162.92,",+$P(FBZ,U,24)),U),1,16)
	W ?19,"TREATMENT FROM: ",$$DATX^FBAAUTL(+$P(FBZ,U,5)),?44,"TREATMENT TO: ",$$DATX^FBAAUTL(+$P(FBZ,U,6))
	W ! Q
PARSE(FBARY)	;set piece positions variable, and get # of pieces for printing
	;INPUT:  FBARY = (not subscripted) - piece positions
	;OUTPUT: FBW = piece positions
	;        FBPL = # of pieces
	S FBARY=$G(FBARY),FBW=$P(FBARY,";",2),FBPL=($L(FBW,"^"))-1
	Q
LINE(FBARY,FBI,FBPL,FBW)	;write line
	;INPUT:  FBPL = # of pieces
	;        FBW = piece positions
	;        FBARY = specific array entry
	;OUTPUT: write line of info
	N FBP,FBY S FBY=$P(FBARY,";",2) W:$L(FBARY,"^")>5 ! W !,$S($L(FBI)<2:" ",1:""),FBI F FBP=1:1:FBPL Q:$P(FBY,U,FBP)']""  D
	.I $P(FBY,U,FBP)="!" W ! I FBP>1 S FBW=$P(FBW,U,1,FBP-1)_U_"!"_U_$P(FBW,U,FBP,FBPL)
	.I $P(FBY,U,FBP)'="!" W ?($P(FBW,U,FBP)),$P(FBY,U,FBP)
	Q
FBO()	;set fbo string if 0 or not defined
	N FBI,Z S FBI=0 F  S FBI=$O(^FB(162.92,FBI)) Q:'FBI  S Z=$G(^FB(162.92,FBI,0)) I $P(Z,U,2),$P(Z,U,4) S FBO=$S(+$G(FBO):FBO_$P(Z,U,4)_U,1:$P(Z,U,4)_U)
	Q $G(FBO)
	;
PAD(L,V,C,O)	;set fixed length field
	;INPUT:  L=length of field/V=variable/C=character to append/O=order
	;          1 for beginning,2 for ending
	;OUTPUT: fixed length field
	N X S $P(X,C,L)="" I O=2 S V=V_($E(X,1,(L-$L(V))))
	I O=1 S V=($E(X,1,(L-$L(V))))_V
	Q $G(V)

FBUCUTL5
FBUCUTL5	;ALBISC/TET - UTILITY CONTINUATION (SET DISPLAY) ;6/9/93  09:52
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
DISP7(IX,IEN,FBO)	;set array for display from file 162.7
	;INPUT:  order no. of status (FBO), xref (IX) and either veteran or vendor ien (IEN)
	;        FBO is either 0 for all status' for a patient/vendor or
	;             in string format, delimited by "^" EG: ("10^50^")
	;VARIABLE PL is set to the piece length of order string,
	;             if fbo = 0 set to 2; if pl>1 status is displayed
	;        SON = status order number
	;        FBORDER = specific order from fbo string
	;        FBMC = master claim ien with Primary or Secondary designation
	;OUTPUT: FBAR( array => ien;name(vet or ven)^name(ven or vet)^fee program^date of claim^status (if status not passed - pl'>1)
	;        FBAR = display count in array;piece positions for display (only if count)
	D:$D(XRTL) T0^%ZOSV ;start monitor
	K ^TMP("FBAR",$J) N FBAR,FBDA,FBDCT,FBMC,FBOMC,FBORDER,FBSP,FBSET,P,PL,SON,Z S FBDCT=0,FBO=$S('+$G(FBO):$$FBO^FBUCUTL4(),1:FBO),PL=($L(FBO,"^")-1)
	S FBOMC=0,FBMC=""
	F  S FBMC=$O(^FB583(IX,IEN,FBMC)) Q:FBMC']""  S FBSET=$S(FBOMC'=+FBMC:1,1:0) F P=1:1:PL S SON=$P(FBO,U,P) Q:SON']""  S FBDA=0 F  S FBDA=$O(^FB583(IX,IEN,FBMC,SON,FBDA)) Q:'FBDA  D DA(FBDA,IX,.FBDCT,FBMC):FBSET,DA1:'FBSET S FBOMC=+FBMC
	D FBAR(FBDCT)
	S:$D(XRT0) XRTN=$T(+0) D:$D(XRT0) T1^%ZOSV ;stop monitor
	Q
DA(FBDA,IX,FBDCT,FBMC,Z)	;get ien in 162.7 and set array; also called from enter tag in fbuclink
	;INPUT:  FBDA = internal entry number of unauthorized claim
	;        IX = cross-reference, APMS is from fbuclink
	;        FBDCT = counter
	;        FBMC = master claim ien
	;        Z = (optional) zero node of unauthorized claim
	S:$G(Z)']"" Z=$G(^FB583(FBDA,0)) I Z]"" D
	.S FBAR=FBDA_";"_$S(IX'="AVMS":($E($$VET^FBUCUTL($P(Z,U,4)),1,12)_U_$E($$VEN^FBUCUTL($P(Z,U,3)),1,12)),1:($E($$VEN^FBUCUTL($P(Z,U,3)),1,12)_U_$E($$VET^FBUCUTL($P(Z,U,4)),1,12)))
	.S FBAR=FBAR_U_$E($$PROG^FBUCUTL($P(Z,U,2)),1,12)_U_$$DATX^FBAAUTL($P(Z,U))_U_$E($P($$PTR^FBUCUTL("^FB(162.92,",$P(Z,U,24)),U),1,16)_U_"!"_U_"TREATMENT FROM: "_$$DATX^FBAAUTL(+$P(Z,U,5))_U_"TREATMENT TO: "_$$DATX^FBAAUTL(+$P(Z,U,6))
	.I $P(Z,U,20)'=FBDA,+$G(FBMC) S FBAR=FBAR_U_"PRIMARY CLAIM: "_$$DATX^FBAAUTL(+$P($G(^FB583(+FBMC,0)),U))
	.S FBDCT=FBDCT+1,^TMP("FBAR",$J,FBDCT)=FBAR
	Q
DA1	;if same set, set node differently
	S Z=$G(^FB583(FBDA,0)) I Z]"" D
	.S:IX'="AVMS" FBAR=FBDA_";"_$S(FBMC["P":"",1:"  ")_$$PAD^FBUCUTL4(12,$E($$VEN^FBUCUTL($P(Z,U,3)),1,12)," ",2)
	.S:IX="AVMS" FBAR=FBDA_";"_$S(FBMC["P":"",1:"  ")_$$PAD^FBUCUTL4(12,$E($$VET^FBUCUTL($P(Z,U,4)),1,12)," ",2)
	.;S FBAR=FBDA_"; "_FBAR
	.S FBAR=FBAR_U_"  "_$$PAD^FBUCUTL4(12,$E($$PROG^FBUCUTL($P(Z,U,2)),1,12)," ",2)_"   "_$$DATX^FBAAUTL($P(Z,U))_"   "_$$PAD^FBUCUTL4(16,$E($P($G(^FB(162.92,$$STATUS^FBUCUTL(SON),0)),U),1,16)," ",2)
	.S FBAR=FBAR_"   <"_$$DATX^FBAAUTL(+$P($G(^FB583(+FBMC,0)),U))_">"
	.S FBDCT=FBDCT+1,^TMP("FBAR",$J,FBDCT)=FBAR
	Q
FBAR(FBDCT)	;set fbar node, also called from fbuclink
	;INPUT:  FBDCT = number of entries in global array
	;OUTPUT: FBAR = fbar node
	;        sets tmp("fbar",$j,"fbar")=# entries;piece positions
	N E S:$G(FBDCT)']"" FBDCT=0 S FBAR=FBDCT I FBDCT S E="5^20^35^52^63^6^33^57^",FBAR=FBAR_";"_E
	S ^TMP("FBAR",$J,"FBAR")=FBAR
	Q
DISP8(FBDA)	;set array for display from file 162.8
	;INPUT:  FBDA = ien of unauthorized claim (file 162.7)
	;OUTPUT: FBAR( array => ien of file 162.8;.01 from file 162.93^
	K ^TMP("FBAR",$J) N FBAR,FBDCT,FBDT,FBI,Z
	S (FBDT,FBDCT)=0 F  S FBDT=$O(^FBAA(162.8,"ACD",FBDA,FBDT)) Q:'FBDT  D
	.S FBI=0 F  S FBI=$O(^FBAA(162.8,"ACD",FBDA,FBDT,FBI)) Q:'FBI  S Z=$G(^FBAA(162.8,+FBI,0)) I Z]"",'$P(Z,U,5) S FBDCT=FBDCT+1,FBAR=FBI_";"_$P($G(^FB(162.93,+$P(Z,U,3),0)),U) D
	..I $P(Z,U,4)]"" S FBAR=FBAR_U_"!"_U_$P(Z,U,4)
	..S ^TMP("FBAR",$J,FBDCT)=FBAR
	S FBAR=FBDCT I FBDCT S FBAR=FBAR_";5^6^"
	S ^TMP("FBAR",$J,"FBAR")=FBAR
	Q
DISP9(FN,IG)	;set array for display from files 162.9*
	;INPUT:  FN = file number
	;        IG = ignore screen (optional)
	;OUTPUT: FBAR( array => ien;.01 from file^
	;        FBAR = display count in array;piece positions for display (only if count)
	K ^TMP("FBAR",$J) N FBAR,FBDA,FBDCT,Z S IG=+$G(IG)
	S (FBDA,FBDCT)=0 F  S FBDA=$O(^FB(FN,FBDA)) Q:'FBDA  S Z=$G(^(FBDA,0)) I Z]"",IG!('IG&($P(Z,U,2))) S FBDCT=FBDCT+1,FBAR=FBDA_";"_$P(Z,U),^TMP("FBAR",$J,FBDCT)=FBAR
	S FBAR=FBDCT I FBDCT S FBAR=FBAR_";"_5_U
	S ^TMP("FBAR",$J,"FBAR")=FBAR
	Q
DISP92	;display status, in order sequence
	;OUTPUT: data in tmp("fbar",$j)
	K ^TMP("FBAR",$J) N FBAR,FBDCT,FBI,FBO,Z S (FBDCT,FBO)=0
	F  S FBO=$O(^FB(162.92,"AO",FBO)) Q:'FBO  S FBI=0,FBI=+$O(^FB(162.92,"AO",FBO,0)) I FBI S Z=$G(^FB(162.92,FBI,0)) I Z]"" S FBDCT=FBDCT+1,FBAR=FBI_";"_$P(Z,U),^TMP("FBAR",$J,FBDCT)=FBAR
	S FBAR=FBDCT I FBDCT S FBAR=FBAR_";5^"
	S ^TMP("FBAR",$J,"FBAR")=FBAR
	Q

FBUCUTL6
FBUCUTL6	;ALBISC/TET - UTILITY (continued) ;10/28/93  15:56
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
AUTH(FBUCP,FBUCA)	;determine if authorization file needs updating, based on
	;change in disposition or other info impacting authorization
	;INPUT:  FBUCP = zero node of 162.7 prior to enter/edit
	;        FBUCA = zero node of 162.7 after enter/edit
	;OUTPUT:  0 for deletion/1 for addition/2 for change/NULL for no action
	;               (if function follows null update file)
	N FBAUTH I $P(FBUCA,U,11)=$P(FBUCP,U,11) D  G AUTHQ
	.;if disposition remained the same do further checking for app/app to stabilization claims
	.;if either auth from/to dates,program,vendor,patient type changed, update auth
	.;if dx change auth should also be updated (in 3.5 or 4)
	.I '($P(FBUCA,U,11)=1!($P(FBUCA,U,11)=4)) Q
	.S FBAUTH=$S($P(FBUCP,U,13,14)'=$P(FBUCA,U,13,14):2,$P(FBUCP,U,2,3)'=$P(FBUCA,U,2,3):2,$P(FBUCP,U,10)'=$P(FBUCA,U,10):2,1:"")
	.;include dx in future
	.Q
	N FBD1,FBD2
	S FBD1=$P(FBUCP,U,11),FBD2=$P(FBUCA,U,11)
	I FBD2=1!(FBD2=4) S FBAUTH=$S('FBD1:1,FBD1=1!(FBD1=4):2,1:1)
	I FBD2=2!(FBD2=3)!(FBD2=5)!('FBD2) S FBAUTH=$S(FBD1=1!(FBD1=4):0,1:"")
	;S FBAUTH=$S(FBAUTH=2&($P(FBUCA,U,13,14)=$P(FBUCP,U,13,14)):"",FBAUTH']""&($P(FBUCA,U,13,14)'=$P(FBUCP,U,13,14)):2,1:FBAUTH)
	I FBAUTH']""!(FBAUTH=2),FBD2=1!(FBD2=4) S FBAUTH=$S($P(FBUCP,U,2,3)'=$P(FBUCA,U,2,3):2,$P(FBUCP,U,10)'=$P(FBUCA,U,10):2,$P(FBUCP,U,13,14)'=$P(FBUCA,U,13,14):2,1:FBAUTH)
AUTHQ	K FBD1,FBD2 Q $G(FBAUTH)
CKAUTH(FBUCP,FBUCA,FBDA)	;check authorization dates if auth is approved or approved to stabilization
	;called after the AFTER event
	;check is necessary as these fields are required in order to set up authorization.
	;if not there, disposition is reverted back to previous and message sent.
	;INPUT:  FBUCP = prior node
	;        FBUCA = after node
	;        FBDA  = internal entry of u/c in 162.7
	;OUPUT:  message to user if disposition has been reverted back
	;VARIABLES: BACK = 1 if reverted to another dispo, otherwise '@'
	;           FBAFR & FBATO = auth from/to dates
	;           FBD1 & FBD2 = pre and post disposition
	;           FBAMT = amount approved
	N BACK,DR,FBAMT,FBD,FBD1,FBD2,FBFR,FBTO
	I $S($G(FBUCP)']"":1,$G(FBUCA)']"":1,'+$G(FBDA):1,1:0) G CKAUTHQ
	S FBD1=$P(FBUCP,U,11),FBD2=$P(FBUCA,U,11)
	;if disposition is not approved or approve to stab then quit,
	; if disp is approv or approv to stab and auth fr/to dates incomplete then quit
	I $S('(FBD2=1!(FBD2=4)):1,+$P(FBUCA,U,13)&(+$P(FBUCA,U,14)):1,1:0) G CKAUTHQ
	S BACK=$S(FBD1:1,1:0),FBD=$S(BACK:+$P(FBUCP,U,11),1:"@"),(FBFR,FBTO,FBAMT)=0
	I BACK,FBD1=1!(FBD1=4) S FBFR=$P(FBUCP,U,13),FBTO=$P(FBUCP,U,14),FBAMT=$P(FBUCP,U,15)
	E  S:$P(FBUCA,U,13) FBFR="@" S:$P(FBUCA,U,14) FBTO="@" S:$P(FBUCA,U,15) FBAMT="@"
	;reset fbuca
	I FBD'=0 S $P(FBUCA,U,11)=$S(FBD="@":"",1:FBD)
	I FBFR'=0 S $P(FBUCA,U,13)=$S(FBFR="@":"",1:FBFR)
	I FBTO'=0 S $P(FBUCA,U,14)=$S(FBTO="@":"",1:FBTO)
	I FBAMT'=0 S $P(FBUCA,U,15)=$S(FBAMT="@":"",1:FBAMT)
	;set to call die & call
	S DR="S:FBD=""@"" Y=""@1"";10////^S X=FBD;S Y=""@2"";@1;10///@;@2;S:FBFR=0 Y=""@3"";S:FBFR=""@"" Y=""@30"";12///^S X=FBFR;S Y=""@3"";@30;12///@;@3;S:FBTO=0 Y=""@4"";S:FBTO=""@"" Y=""@40"";13///^S X=FBTO S Y=""@4"";@40;13///@;@4"
	S DR(162.7,1)="S:FBAMT=0 Y=""@99"";S:FBAMT=""@"" Y=""@50"";14///^S X=FBAMT;S Y=""@99"";@50;14///@;@99"
	D DIE^FBUCUTL2("^FB583(",FBDA,.DR)
	;write message
	W !,*7,"Authorization From/To dates are missing.",!,"Disposition has not been updated.",!,"When entering in this disposition, please include these dates.",!
CKAUTHQ	Q

FBUCUTL7
FBUCUTL7	;ALBISC/TET - UTILITY FOR GROUPING/DISPLAYING LINKED CLAIMS ;9/18/93  17:12
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
GROUP(FBZ,FBDA)	;check if claim is in a group
	;INPUT:  FBZ = zero node of unauthorized claim
	;        FBDA = ien of unauthorized claim from file 162.7
	;OUTPUT: FBGROUP = string, delimited by '^', contains:
	;          count of group^count of different programs^1 or 0 if any authorizations^count of u/c's with same status as fbda^# of different dispositons
	;        FBGROUP( = array of entries in group, subsripted by u/c ien
	;                  fee program^authorization ien^status^disposition
	K FBGROUP S FBGROUP=0 I $S($G(FBZ)']"":1,'+$G(FBDA):1,1:0) G GROUPQ
	N FB0,FBAIEN,FBACT,FBCT,FBDCT,FBDISPO,FBI,FBMAST,FBPCT,FBPROG,FBSCT
	S FBMAST=+$P(FBZ,U,20),(FBAIEN,FBCT,FBACT,FBDCT,FBI,FBPCT,FBSCT)=0
	F  S FBI=$O(^FB583("AMC",FBMAST,FBI)) Q:'FBI  I FBI'=FBDA S FB0=$G(^FB583(FBI,0)) I FB0]"" D
	.S FBCT=FBCT+1,FBAIEN=+$P(FB0,U,27),FBGROUP(FBI)=+$P(FB0,U,2)_U_FBAIEN S:FBAIEN FBACT=1 I '$D(FBPROG(+$P(FB0,U,2))) S FBPROG(+$P(FB0,U,2))="",FBPCT=FBPCT+1
	.S FBDISPO=+$P(FB0,U,11) I FBDISPO,'$D(FBDISPO(FBDISPO)) S FBDISPO(FBDISPO)="",FBDCT=FBDCT+1
	.I $P(FBZ,U,24)=$P(FB0,U,24) S FBSCT=FBSCT+1
	.S FBGROUP(FBI)=FBGROUP(FBI)_U_+$P(FB0,U,24)_U_+$P(FB0,U,11)
	S FBAIEN=+$P(FBZ,U,27),FBDISPO=+$P(FBZ,U,11) S:'FBACT&(FBAIEN) FBACT=1 S FBCT=FBCT+1,FBGROUP(FBDA)=+$P(FBZ,U,2)_U_FBAIEN_U_+$P(FBZ,U,24)_U_FBDISPO I FBDISPO,'$D(FBDISPO(FBDISPO)) S FBDCT=FBDCT+1
	S FBGROUP=FBCT_U_FBPCT_U_FBACT_U_FBSCT_U_FBDCT
GROUPQ	Q
DISPLAY(FBDA,FBGROUP,FBS,FBD)	;display associated claims with same status
	;INPUT:  FBDA = ien of unauthorized claim
	;        FBGROUP = # in group^# progs^1 if auth else 0^# of u/c w/same status
	;        FBGROUP( = array subscripted by ien of 162.7=prog^aien^status^disposition
	;        FBS = status on unauthorized claim (fbda) <optional - if displayed claim should have save status as fbda>
	;        FBD = disposition of claim (not required if no status)
	;OUTPUT: FBDISP = count of u/c within group to be displayed (excludes fbda)^count of different dispositions.
	;        FBDISP( array of those u/c within group as fbda, but does not include fbda
	I '+$G(FBDA) Q
	K FBDISP N FBO,FBI S:$G(FBS)']"" FBS="" S FBD=+$G(FBD),FBDISP=0
	S FBI=0 F  S FBI=$O(FBGROUP(FBI)) Q:'FBI  I FBI'=FBDA D
	.I FBS]"",FBS[$P(FBGROUP(FBI),U,3),$P(FBGROUP(FBI),U,4)=FBD S FBDISP(FBI)=$P(FBGROUP(FBI),U,4),FBDISP=FBDISP+1
	.I FBS']"" S FBDISP(FBI)="",FBDISP=FBDISP+1 I '$D(FBD($P(FBGROUP(FBI),U,4))) S FBD($P(FBGROUP(FBI),U,4))="",$P(FBDISP,U,2)=+$P(FBDISP,U,2)+1
	.;Q:'$D(FBDISP(FBI))  S FB0=$G(^FB583(FBI,0)) I FB0]"" W !,FB0
	K FBS,FBD Q  ;W:$D(FBDISP(FBI)) ! K FBS Q
READ(DIRA,FBOUT,FBDISP)	;ask if one or all should be updated
	;INPUT:  DIRA = action prompt: disapprove,approve,change,delete
	;        FBOUT = exit flag:  1 to exit/0 not to exit
	;        FBDISP = display array; <optional>; if set will display before asking
	;OUTPUT: FBALL = flag to update one or all:  0 for one/1 for all
	I $D(FBDISP) Q:'+$G(FBDISP)  D SHOW(.FBDISP,.FBOUT) Q:FBOUT
	S DIR(0)="YO" S:$G(DIRA)]"" DIR("A")=DIRA
	D ^DIR K DIR S:$D(DIRUT)!(Y']"") FBOUT=1 S:'$G(FBOUT) FBALL=Y
	K DIRUT,DTOUT,DUOUT,DIROUT,Y Q
SHOW(FBDISP,FBOUT)	;write data in display array
	;INPUT:  FBDISP = # in array^# of different dispositions
	;        FBDISP( = display array
	;        FBOUT = exit flag:  1 to exit/0 not to exit
	;        display entries in array
	I $S('$D(FBDISP):1,'+$G(FBDISP):1,1:0) Q
	N FBI,FBZ ;new variables here
	I +$G(FBDISP)+$Y>(IOSL-2) D CR(.FBOUT) Q:FBOUT
	S FBI=0 F  S FBI=$O(FBDISP(FBI)) Q:'FBI  S FBZ=$G(^FB583(FBI,0)) D  Q:FBOUT  ;set data similar to utility:  vet/ven/date received/status/!/treatment from/treatment to/disposition
	.I $Y+4>IOSL D CR(.FBOUT) Q:FBOUT  ;check page legnth,q:fbout
	.W !,FBI,?5,$E($$VET^FBUCUTL($P(FBZ,U,4)),1,12),?20,$E($$VEN^FBUCUTL($P(FBZ,U,3)),1,12),?35,$E($$PROG^FBUCUTL($P(FBZ,U,2)),1,12),?52,$$DATX^FBAAUTL($P(FBZ,U)),?63,$E($P($$PTR^FBUCUTL("^FB(162.92,",$P(FBZ,U,24)),U),1,16)
	.W !?7,"TREATMENT FROM: ",$$DATX^FBAAUTL(+$P(FBZ,U,5)),?33,"TREATMENT TO: ",$$DATX^FBAAUTL(+$P(FBZ,U,6)) I +$P(FBZ,U,11) W !?9,"DISPOSITIONED: ",$E($P($$PTR^FBUCUTL("^FB(162.91,",+$P(FBZ,U,11)),U),1,22)
	Q
CR(FBOUT)	;read for display
	;INPUT/OUTPUT:  FBOUT = exit flag; 1 to exit
	;write return to continue, and page if continue or quit
	S DIR(0)="E" W ! D ^DIR K DIR S:$D(DUOUT)!($D(DTOUT)) FBOUT=1
	Q:FBOUT
PAGE	;new page
	W @IOF
	Q

FBUCUTL8
FBUCUTL8	;ALBISC/TET - UTILITY (continued)
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
EXPIRE(FBDA,FBDT,FBUCA,FBORDER)	;determine expiration date based upon status order
	;INPUT:  FBDA     - internal entry number of unauthorized claim, 162.7
	;        FBDT   - date used to which expiration days are added,
	;      value is either  date letter sent, or if no letter, today's date
	;      or date statement of the case issued, depending on status.
	;        FBUCA - current (or after) zero node of claim
	;        FBORDER - status order number
	;OUTPUT: expiration date, based on days associated with status.
	;        no expiration date if dispostion is approved or canceled/withdrawn
	N FBEXP I $S('FBDA:1,'$D(FBDT):1,'FBDT:1,'$D(FBUCA):1,'$D(FBORDER):1,'FBORDER:1,1:0) S FBEXP=0 G EXPIREQ
	N FBEXP,FBORIG,FBSTATUS,DAYS S FBEXP=+$P(FBUCA,U,26),FBORIG=+$P(FBUCA,U,22)
	S FBSTATUS=$$STATUS^FBUCUTL(FBORDER),DAYS=$$DAYS^FBUCUTL(FBSTATUS)
	I $P(FBUCA,U,11)=3 S FBEXP=$S($P(FBUCA,U,26):"@",1:0) G EXPIREQ
	I 'DAYS,+FBEXP S FBEXP="@"
	I DAYS,FBEXP'="@" S:FBORDER'=55 FBEXP=$$CDTC^FBUCUTL(FBDT,DAYS) I FBORDER=55 S DAYS=DAYS-$$DTC^FBUCUTL(FBDT,FBORIG) S FBEXP=$$CDTC^FBUCUTL(FBDT,$S(DAYS'>60:60,1:DAYS))
	;if order=55, get number of days between date statement of case issued
	;     or date letter sent and date of original disposition;
	;     expiration date is either remainder of year or 60 days,
	;     whichever is greater.
EXPIREQ	Q $G(FBEXP)
DISAPR	;check disapproval reason and file if all same, or ask if diff from pr.
	I FBUCDISR=0 W !?3,"No: ",FBDA,?15,"Treatment From: ",$$DATX^FBAAUTL($P(FBUCA,U,5)) W:$P(FBUCA,U,6) ?40,"Treatment To: ",$$DATX^FBAAUTL($P(FBUCA,U,6)) S DIE="^FB583(",DA=FBDA,DR=15 D ^DIE K DIE,DA,DR Q
	F I=2:1 S J=$P(FBUCDISR,U,I) Q:'J  D DISAP^FBUCUTL(FBDA,J)
	Q

FBUINS
FBUINS	;AISC/DMK-ADD INSURANCE INFORMATION ;07JULY92
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	Q:$E(IOST,1,2)'="C-"
	Q:'$G(DFN)
	N FBOUT
INS	S DIR("A")="Want to add NEW insurance data",DIR("B")="No",DIR("?")="Answer 'Yes' if you want to add a new insurance company for this patient."
	S DIR("?",1)="You are not allowed to edit current insurance information.",DIR("?",2)="However, you will be given the opportunity to send a bulletin to MCCR",DIR("?",3)="if insurance information is incorrect."
	S DIR(0)="Y" D ^DIR K DIR Q:$D(DIRUT)
	D:Y FEE^IBCNSP2
	S DIR("A")="Are there any discrepancies with insurance data on file",DIR("?")="A 'Yes' answer will send a bulletin to MCCR",DIR(0)="Y",DIR("B")="No" D ^DIR K DIR Q:$D(DIRUT)!('Y)  D
	.N VADM D DEM^VADPT S XMB(1)=VADM(1),XMB(2)=VA("PID")
	.S DIR("A")="Enter description of change",DIR(0)="F^3:70" D ^DIR K DIR Q:$D(DIRUT)  S XMB(3)=Y
	.S XMB="FB INSURANCE CHANGE",XMDUZ=$S($G(DUZ):DUZ,1:.5) D ^XMB
	K DIC,DIE,VA,XMB,XMDUZ,Y
	Q

FBVDISP
FBVDISP	;AISC/CMR-VENDOR DISPLAY IDENTIFIERS - APR 9, 1993
	;;3.5;FEE BASIS;;JAN 30, 1995
	;;Per VHA Directive 10-93-142, this routine should not be modified.
	N FBT,FBVC,FBZ S FBT(0)=$G(^FBAAV(Y,0)) Q:FBT(0)']""  F FBT=2,3,4,5,6,9,10,14 S FBT(FBT)=$P(FBT(0),U,FBT)
	S FBT(99)=$P($G(^FBAAV(Y,1)),U),FBT(98)=$P($G(^FBAAV(Y,"ADEL")),U)
	W:FBT(2)]"" ?40,FBT(2)
	W:FBT(10) "  CHAIN #: ",FBT(10)
	W:FBT(9)]"" "  ",$E($P($G(^FBAA(161.81,+FBT(9),0)),U),1,15)
	W:FBT(3)]"" !?10,FBT(3) D
	.S FBZ=$$CKVEN^FBAADV(+Y) I FBZ W:FBT(3)']"" ! W ?40,"(Awaiting Austin Approval)"
	.I FBT(98)="Y" W:FBT(3)']""!(FBZ) ! W ?40,"(Vendor in Delete Status)"
	W:FBT(14)]"" !?10,FBT(14)
	W:FBT(4)]"" !?10,FBT(4)
	W:FBT(5)]"" ", ",$P($G(^DIC(5,+FBT(5),0)),U,2)
	W:FBT(6)]"" "  ",FBT(6)
	W:FBT(99)]"" "    TEL. #:  ",FBT(99)
	W !?1


