Released YS*5.01*90 SEQ #75
Extracted from mail message
**KIDS**:YS*5.01*90^

**INSTALL NAME**
YS*5.01*90
"BLD",6093,0)
YS*5.01*90^MENTAL HEALTH^0^3060905^y
"BLD",6093,1,0)
^^371^371^3060905^
"BLD",6093,1,1,0)
Recent changes in the Clozapine protocol require changes to the Clozapine 
"BLD",6093,1,2,0)
Roll Up software.  Originally, all Clozapine prescriptions were limited 
"BLD",6093,1,3,0)
to 7 days.  Renewals and refills were not allowed.  In addition, the 
"BLD",6093,1,4,0)
Clozapine reporting software automatically discontinued any patient if 
"BLD",6093,1,5,0)
the patient's prescription was over 28 days old.  This was to prevent a 
"BLD",6093,1,6,0)
patient from being issued medication on an expired prescription.  The 
"BLD",6093,1,7,0)
revised Clozapine protocol allows for a monthly prescription as well as 
"BLD",6093,1,8,0)
weekly and bi-weekly.  The patient is now automatically discontinued if 
"BLD",6093,1,9,0)
the issue date for the most recent prescription is greater than 56 days 
"BLD",6093,1,10,0)
in the past.
"BLD",6093,1,11,0)
 
"BLD",6093,1,12,0)
The weekly roll-up creates a report that is sent to the local G.PSOCLOZ 
"BLD",6093,1,13,0)
mail group.  This report lists the patients reported to the national 
"BLD",6093,1,14,0)
database along with an indicator showing whether or not Lab and RX data 
"BLD",6093,1,15,0)
were transmitted.  This report has been updated to show the date of the 
"BLD",6093,1,16,0)
most recent WBC (White Blood Count) and Neutrophil Count along with the 
"BLD",6093,1,17,0)
date of the most recent Clozapine prescription.  Mental Health and 
"BLD",6093,1,18,0)
Pharmacy personnel responsible for prescribing and dispensing Clozapine 
"BLD",6093,1,19,0)
should be made aware of this mail group and given the opportunity to join.
"BLD",6093,1,20,0)
 
"BLD",6093,1,21,0)
NEW OPTION:
"BLD",6093,1,22,0)
==========
"BLD",6093,1,23,0)
The Link Multiple Tests to Clozapine [CLOZAPINE MULTI TEST LINK] option 
"BLD",6093,1,24,0)
must be assigned to the person or persons responsible for ensuring that 
"BLD",6093,1,25,0)
the appropriate data is in place to validate Clozapine testing data.  
"BLD",6093,1,26,0)
This is usually the Laboratory ADPAC.
"BLD",6093,1,27,0)
 
"BLD",6093,1,28,0)
This option will ask for the local laboratory name that equates to the 
"BLD",6093,1,29,0)
following seven common test names
"BLD",6093,1,30,0)
 
"BLD",6093,1,31,0)
White Blood Cell Count
"BLD",6093,1,32,0)
Absolute Neutrophil Count
"BLD",6093,1,33,0)
Neutrophil %
"BLD",6093,1,34,0)
Segs  (Percent)
"BLD",6093,1,35,0)
Bands (Percent)
"BLD",6093,1,36,0)
Segs  (Absolute Count)
"BLD",6093,1,37,0)
Bands (Absolute Count)
"BLD",6093,1,38,0)
 
"BLD",6093,1,39,0)
You will also be asked to fill in the reporting format for each test.  
"BLD",6093,1,40,0)
Most sites report WBC and Neutrophil results in K/unit format (K/cc or 
"BLD",6093,1,41,0)
K/cu mm or K/mm-3 or K/mL). For example, WBC equals 5.1.  However, some 
"BLD",6093,1,42,0)
report results as discrete units. For example, WBC equals 5100.  This 
"BLD",6093,1,43,0)
field will allow the site to specify how results are reported.  Entries 
"BLD",6093,1,44,0)
that report in a percentage (such as Neutrophil %, Segs %, and Bands %) 
"BLD",6093,1,45,0)
should use "Percentage".
"BLD",6093,1,46,0)
 
"BLD",6093,1,47,0)
You may input as many names from the local laboratory definition for each 
"BLD",6093,1,48,0)
of these tests as needed.  Remember that the laboratory may have designed 
"BLD",6093,1,49,0)
special names for specific test equipment, specific test locations, or 
"BLD",6093,1,50,0)
specific test conditions, such as manual counts.  
"BLD",6093,1,51,0)
 
"BLD",6093,1,52,0)
In fact, if your facility has Clozapine patients with blood samples drawn 
"BLD",6093,1,53,0)
and tested on a fee-basis at other CLIA (Clinical Laboratory Improvement 
"BLD",6093,1,54,0)
Amendments) approved labs, it is extremely important for your Laboratory 
"BLD",6093,1,55,0)
have tests to accept manual input of these tests.  
"BLD",6093,1,56,0)
 
"BLD",6093,1,57,0)
Therefore, you should involve laboratory managers or ADPAC (Automated 
"BLD",6093,1,58,0)
Data Processing Application Coordinator) in selection of these names - 
"BLD",6093,1,59,0)
both to define the test names currently in use and to create the 
"BLD",6093,1,60,0)
provision for manual entry of data.  Please be certain every possible 
"BLD",6093,1,61,0)
local laboratory name that represents these tests is entered that relates 
"BLD",6093,1,62,0)
to each of the seven test names above.  Pharmacy dispense will be 
"BLD",6093,1,63,0)
prevented unless the program can find the needed test results under one 
"BLD",6093,1,64,0)
of names you identify as an equivalent for each of the seven tests.
"BLD",6093,1,65,0)
 
"BLD",6093,1,66,0)
Security Key: The YSCL AUTHORIZED Security Key is new with this patch.  
"BLD",6093,1,67,0)
 This key must be assigned to each provider authorized to dispense 
"BLD",6093,1,68,0)
 Clozapine.
"BLD",6093,1,69,0)
 
"BLD",6093,1,70,0)
EXAMPLE: CLOZAPINE MULTI TEST LINK [Link Multiple Tests to Clozapine] 
"BLD",6093,1,71,0)
option
"BLD",6093,1,72,0)
 
"BLD",6093,1,73,0)
Select OPTION NAME: CLOZ
"BLD",6093,1,74,0)
     1   CLOZAPINE MULTI TEST LINK       Link Multiple Tests to Clozapine
"BLD",6093,1,75,0)
     2   CLOZAPINE DATA SERVER  YSCLSERVER     Clozapine Data Server
"BLD",6093,1,76,0)
     3   CLOZAPINE PHARMACY MANAGER  PSOL MANAGER     Clozapine Pharmacy 
"BLD",6093,1,77,0)
Manager
"BLD",6093,1,78,0)
     4   CLOZAPINE TEST LINK  YSCL TEST LINK     Clozapine Test Link
"BLD",6093,1,79,0)
CHOOSE 1-4: 1  CLOZAPINE MULTI TEST LINK     Link Multiple Tests to 
"BLD",6093,1,80,0)
Clozapine 
"BLD",6093,1,81,0)
Link Multiple Tests to Clozapine
"BLD",6093,1,82,0)
Currently linked Tests:
"BLD",6093,1,83,0)
NEUTROPHIL MATURITY, MEAN represents WHITE BLOOD COUNT
"BLD",6093,1,84,0)
SEGS represents BANDS %
"BLD",6093,1,85,0)
 
"BLD",6093,1,86,0)
Enter the name of the test for Clozapine: WBC       WBC
"BLD",6093,1,87,0)
Enter the type of the test for Clozapine: ?
"BLD",6093,1,88,0)
 
"BLD",6093,1,89,0)
Enter a code from the list.
"BLD",6093,1,90,0)
 
"BLD",6093,1,91,0)
     Select one of the following:
"BLD",6093,1,92,0)
 
"BLD",6093,1,93,0)
          W         WHITE BLOOD COUNT
"BLD",6093,1,94,0)
          A         ABSOLUTE NEUTROPHIL COUNT
"BLD",6093,1,95,0)
          N         NEUTROPHIL PERCENT
"BLD",6093,1,96,0)
          S         SEGS %
"BLD",6093,1,97,0)
          B         BANDS %
"BLD",6093,1,98,0)
          T         BANDS ABSOLUTE
"BLD",6093,1,99,0)
          C         SEGS ABSOLUTE
"BLD",6093,1,100,0)
 
"BLD",6093,1,101,0)
Enter the type of the test for Clozapine: WHITE BLOOD COUNT
"BLD",6093,1,102,0)
Enter the reporting method of the test for Clozapine: ?
"BLD",6093,1,103,0)
 
"BLD",6093,1,104,0)
Enter a code from the list.
"BLD",6093,1,105,0)
 
"BLD",6093,1,106,0)
     Select one of the following:
"BLD",6093,1,107,0)
 
"BLD",6093,1,108,0)
          0         uL
"BLD",6093,1,109,0)
          1         K/uL
"BLD",6093,1,110,0)
          2         Percent
"BLD",6093,1,111,0)
 
"BLD",6093,1,112,0)
Enter the reporting method of the test for Clozapine: 2  Percent
"BLD",6093,1,113,0)
 
"BLD",6093,1,114,0)
Enter the name of the test for Clozapine:
"BLD",6093,1,115,0)
 
"BLD",6093,1,116,0)
The FDA (Food and Drug Administration) uses White Blood Cell Count and 
"BLD",6093,1,117,0)
Absolute Neutrophil Count as the definitive tests to verify for Clozapine 
"BLD",6093,1,118,0)
use, however your lab may report your data under any of the names you 
"BLD",6093,1,119,0)
enter into these lists.  If the WBC and ANC are not directly available, 
"BLD",6093,1,120,0)
ANC will be calculated from the other data available and presented to 
"BLD",6093,1,121,0)
Pharmacy (and CPRS (Computerized Patient Record System) during a later 
"BLD",6093,1,122,0)
revision) at the time of dispense and used to evaluate the safety under 
"BLD",6093,1,123,0)
FDA limits.  Only the most recent WBC will be accepted, and the date and 
"BLD",6093,1,124,0)
time stamp of the Neutrophil count must match the date and time stamp of 
"BLD",6093,1,125,0)
the WBC.
"BLD",6093,1,126,0)
 
"BLD",6093,1,127,0)
 
"BLD",6093,1,128,0)
WHITE BLOOD CELL  (WBC)
"BLD",6093,1,129,0)
 
"BLD",6093,1,130,0)
For reference  "White Blood Cell Count" is a portion of the total blood 
"BLD",6093,1,131,0)
content and the sum total of two different kinds of cells - 
"BLD",6093,1,132,0)
 
"BLD",6093,1,133,0)
         AGRANULOCYTES - those cells which do not have granules
"BLD",6093,1,134,0)
         that absorb a stain.  These cells are subdivided
"BLD",6093,1,135,0)
         into Lymphocytes and Monocytes. 
"BLD",6093,1,136,0)
 
"BLD",6093,1,137,0)
         GRANULOCYTES  -- those cells which contain granules
"BLD",6093,1,138,0)
         that absorb a stain.  These cells are subdivided
"BLD",6093,1,139,0)
         into Neutrophils, Basophils, and Eosinophils.  
"BLD",6093,1,140,0)
 
"BLD",6093,1,141,0)
Both Agranulocytes and Granulocytes are part of the Total White Blood 
"BLD",6093,1,142,0)
Cell Count.  Therefore, the total WBC is the sum of five different types 
"BLD",6093,1,143,0)
of cells.  
"BLD",6093,1,144,0)
 
"BLD",6093,1,145,0)
WBC as well as its five components are usually expressed as the total 
"BLD",6093,1,146,0)
number of cells in a cubic centimeter of blood (cc) or cubic millimeter 
"BLD",6093,1,147,0)
(cu mm or mm-3)or milliliters (mL).  
"BLD",6093,1,148,0)
 
"BLD",6093,1,149,0)
WBC usually falls with a range between 4000 and 11,000 but fluctuates for 
"BLD",6093,1,150,0)
a number of medical reasons.  For brevity, WBC results may be divided by 
"BLD",6093,1,151,0)
1000 and presented as K/cc or K/cu mm or K/mm-3 or K/mL
"BLD",6093,1,152,0)
 
"BLD",6093,1,153,0)
 
"BLD",6093,1,154,0)
The five components are similarly expressed as number of the same type OR 
"BLD",6093,1,155,0)
as a percentage of the total WBC.  
"BLD",6093,1,156,0)
 
"BLD",6093,1,157,0)
The sum of counts of the five components of should equal the total WBC OR 
"BLD",6093,1,158,0)
the sum of the percentages of the five components should equal 100%
"BLD",6093,1,159,0)
 
"BLD",6093,1,160,0)
This test is sometimes also referred to as "Leukocyte Count" 
"BLD",6093,1,161,0)
 
"BLD",6093,1,162,0)
 
"BLD",6093,1,163,0)
Absolute Neutrophil Count (ANC)
"BLD",6093,1,164,0)
 
"BLD",6093,1,165,0)
The Absolute Neutrophil Count is the total number of Neutrophil cells in 
"BLD",6093,1,166,0)
the total WBC count.  The other GRANULOCYTE cells - Basophils and 
"BLD",6093,1,167,0)
Eosinophils (see White Blood Cell Count above) - are not included in this 
"BLD",6093,1,168,0)
number.  Therefore - a test titled GRANULOCYTES - may not produce the 
"BLD",6093,1,169,0)
desired result as it may include Basophils and Eosinophils.
"BLD",6093,1,170,0)
 
"BLD",6093,1,171,0)
Since the ANC is a portion of the WBC, it is only valid if it is 
"BLD",6093,1,172,0)
traceable to the WBC sample drawn at the same date and time.  
"BLD",6093,1,173,0)
 
"BLD",6093,1,174,0)
ANC is a count and not a percentage - expressed as WBC with the total 
"BLD",6093,1,175,0)
number of cells in a cubic centimeter of blood (cc) or cubic millimeter 
"BLD",6093,1,176,0)
(cu mm or mm-3)or milliliters (mL).  Again, this number may be divided by 
"BLD",6093,1,177,0)
a thousand for brevity.  
"BLD",6093,1,178,0)
 
"BLD",6093,1,179,0)
The Absolute Neutrophil Count generally ranges from 1600 to 7700 / but it 
"BLD",6093,1,180,0)
can ever exceed the WBC count.  
"BLD",6093,1,181,0)
 
"BLD",6093,1,182,0)
This test can also be knows as polymorphonuclear cells or PMN's. 
"BLD",6093,1,183,0)
 
"BLD",6093,1,184,0)
 
"BLD",6093,1,185,0)
Neutrophil Percent  (Neut%)
"BLD",6093,1,186,0)
 
"BLD",6093,1,187,0)
The Neutrophil Percent is the portion of the total WBC and that is 
"BLD",6093,1,188,0)
composed of Neutrophil cells, excluding all agranulocytes and other 
"BLD",6093,1,189,0)
granulocytes.  This number is usually between 40% and 70%, but fluctuates 
"BLD",6093,1,190,0)
for many medical reasons.  
"BLD",6093,1,191,0)
 
"BLD",6093,1,192,0)
Since it is reported as a portion of the total WBC, it is only valid if 
"BLD",6093,1,193,0)
it is traceable to the WBC sample drawn at the same date and time.  
"BLD",6093,1,194,0)
 
"BLD",6093,1,195,0)
Neut% is commonly obtained by automatic testing equipment to represent 
"BLD",6093,1,196,0)
the Neutrophil content in the blood.  
"BLD",6093,1,197,0)
 
"BLD",6093,1,198,0)
Neut% is a percentage and not a count - reported in the portion of the 
"BLD",6093,1,199,0)
WBC.  It can be converted into an Absolute Neutrophil Count in the 
"BLD",6093,1,200,0)
following formula (Neutrophil% / 100) X WBC count).  
"BLD",6093,1,201,0)
 
"BLD",6093,1,202,0)
The Neutrophil Percent generally ranges from 37% to 80% and should never 
"BLD",6093,1,203,0)
exceed 90% of the total WBC count unless special medical conditions are 
"BLD",6093,1,204,0)
present.  
"BLD",6093,1,205,0)
 
"BLD",6093,1,206,0)
 
"BLD",6093,1,207,0)
SEGS  & BANDS  
"BLD",6093,1,208,0)
 
"BLD",6093,1,209,0)
The WBC/Granulocyte/Neutrophil cell type can be further subdivided into 
"BLD",6093,1,210,0)
two types.  Mature neutrophils are called SEGS.  Immature neutrophils 
"BLD",6093,1,211,0)
called BANDS also circulate in the blood until they mature into SEGS.  
"BLD",6093,1,212,0)
The sum of SEGS and BANDS is equal to the ANC of a give WBC count.  
"BLD",6093,1,213,0)
 
"BLD",6093,1,214,0)
SEGS and BANDS may be reported as a count, expressed in cc, mm-3, cu mm, 
"BLD",6093,1,215,0)
or mL.  A preceding K indicates the number has been divided by 1000.  
"BLD",6093,1,216,0)
 
"BLD",6093,1,217,0)
When SEGS and BANDS are reported as a number, the sum total of SEGS and 
"BLD",6093,1,218,0)
BANDS equals the total Neutrophil Count (ANC)  NOTE that the program 
"BLD",6093,1,219,0)
needs an identifying test for both SEGS and BANDS.  Reporting SEGS 
"BLD",6093,1,220,0)
without a parallel result from BANDS will result in an error condition 
"BLD",6093,1,221,0)
that may prevent Pharmacy dispense.  
"BLD",6093,1,222,0)
 
"BLD",6093,1,223,0)
This number generally ranges between 1600 and 7700 / cu mm.  It should 
"BLD",6093,1,224,0)
never exceed 90% of the total WBC except under special circumstances. 
"BLD",6093,1,225,0)
 
"BLD",6093,1,226,0)
SEGS and BANDS may be reported as a PERCENTAGE of the total WBC.  
"BLD",6093,1,227,0)
Therefore the total number of neutrophils (ANC) in a give WBC is = total 
"BLD",6093,1,228,0)
WBC  X  (% Segs  + % Bands).  This calculation will be performed by the 
"BLD",6093,1,229,0)
Pharmacy patch to obtain and ANC when necessary
"BLD",6093,1,230,0)
 
"BLD",6093,1,231,0)
The sum total of SEGS% and BANDS% can never exceed 100.
"BLD",6093,1,232,0)
 
"BLD",6093,1,233,0)
DATA DICTIONARY:
"BLD",6093,1,234,0)
===============
"BLD",6093,1,235,0)
CLOZAPINE PATIENT LIST File (#603.01), OVERRIDE DATE field (#3) - This 
"BLD",6093,1,236,0)
field was added to allow the NCCC more control over the overrides 
"BLD",6093,1,237,0)
performed at the site.
"BLD",6093,1,238,0)
 
"BLD",6093,1,239,0)
CLOZAPINE PARAMETERS File (#603.03), LOCK DOWN field (#7) - This field 
"BLD",6093,1,240,0)
was added to allow the NCCC to prevent the dispensing of any Clozapine 
"BLD",6093,1,241,0)
prescription at a site.
"BLD",6093,1,242,0)
 
"BLD",6093,1,243,0)
 
"BLD",6093,1,244,0)
CLOZAPINE TESTS file (#603.04) - This file was added to allow the sites 
"BLD",6093,1,245,0)
to select multiple tests for the WBC and Neutrophil count.
"BLD",6093,1,246,0)
 
"BLD",6093,1,247,0)
Field         Field Name           Description
"BLD",6093,1,248,0)
603.04,.01    NAME            0;1 FREE TEXT (Required)
"BLD",6093,1,249,0)
603.04,1      TEST NAME       1;0 POINTER Multiple #603.41
"BLD",6093,1,250,0)
603.41,.01    TEST NAME       0;1 POINTER TO LABORATORY TEST FILE (#60)
"BLD",6093,1,251,0)
603.41,1      TEST TYPE            0;2 SET (Required)
"BLD",6093,1,252,0)
 
"BLD",6093,1,253,0)
                                'W' FOR WHITE BLOOD COUNT; 
"BLD",6093,1,254,0)
                                'A' FOR ABSOLUTE NEUTROPHIL COUNT; 
"BLD",6093,1,255,0)
                                'N' FOR NEUTROPHIL PERCENT; 
"BLD",6093,1,256,0)
                                'S' FOR SEGS %; 
"BLD",6093,1,257,0)
                                'B' FOR BANDS %; 
"BLD",6093,1,258,0)
                                'T' FOR BANDS ABSOLUTE; 
"BLD",6093,1,259,0)
                                'C' FOR SEGS ABSOLUTE; 
"BLD",6093,1,260,0)
603.41,2      REPORTING FORMAT     0;3 SET (Required)
"BLD",6093,1,261,0)
 
"BLD",6093,1,262,0)
                                '0' FOR Units; 
"BLD",6093,1,263,0)
                                '1' FOR K/units; 
"BLD",6093,1,264,0)
                                '2' FOR Percentage; 
"BLD",6093,1,265,0)
 
"BLD",6093,1,266,0)
INSTALLATION TIME FRAME:
"BLD",6093,1,267,0)
=======================
"BLD",6093,1,268,0)
VA DIRECTIVE 2001-023 REQUIRES INSTALLATION OF THIS PATCH WITHIN 30 DAYS 
"BLD",6093,1,269,0)
FROM THE TIME OF INITIAL RELEASE.
"BLD",6093,1,270,0)
 
"BLD",6093,1,271,0)
REQUESTING SITE:
"BLD",6093,1,272,0)
===============
"BLD",6093,1,273,0)
National Clozapine Coordinating Center
"BLD",6093,1,274,0)
 
"BLD",6093,1,275,0)
Test Site(s):
"BLD",6093,1,276,0)
============
"BLD",6093,1,277,0)
West LA
"BLD",6093,1,278,0)
Oklahoma
"BLD",6093,1,279,0)
Louisville
"BLD",6093,1,280,0)
 
"BLD",6093,1,281,0)
Reference NOIS:
"BLD",6093,1,282,0)
==============
"BLD",6093,1,283,0)
NA
"BLD",6093,1,284,0)
a
"BLD",6093,1,285,0)
ASSOCIATED E3Rs:
"BLD",6093,1,286,0)
===============
"BLD",6093,1,287,0)
NA
"BLD",6093,1,288,0)
 
"BLD",6093,1,289,0)
ASSOCIATED REMEDY TICKETS:
"BLD",6093,1,290,0)
=========================
"BLD",6093,1,291,0)
NA
"BLD",6093,1,292,0)
 
"BLD",6093,1,293,0)
  ROUTINE SUMMARY:
"BLD",6093,1,294,0)
  ================
"BLD",6093,1,295,0)
 
"BLD",6093,1,296,0)
  The following routines are included in this patch.  The second line
"BLD",6093,1,297,0)
  of each of these routines now looks like:
"BLD",6093,1,298,0)
  <tab>   ;;5.01;MENTAL HEALTH;**[patch list]**;Dec 30,1994
"BLD",6093,1,299,0)
 
"BLD",6093,1,300,0)
                              Checksum Values
"BLD",6093,1,301,0)
 
"BLD",6093,1,302,0)
  Routine Name      Before Patch         After Patch     Patch List
"BLD",6093,1,303,0)
  ------------      ------------         -----------     ----------
"BLD",6093,1,304,0)
 
"BLD",6093,1,305,0)
  YSCLSERV           25083145              25564583      18,22,26,47,
"BLD",6093,1,306,0)
                                                         61,69,74,90
"BLD",6093,1,307,0)
  YSCLSRV1           1605367               1606233       61,69,74,90
"BLD",6093,1,308,0)
  YSCLSRV2           16840829              24723007      69,90
"BLD",6093,1,309,0)
  YSCLSRV3           7345805               24872037      74,90
"BLD",6093,1,310,0)
  YSCLTEST           12047382              12378003      18,22,26,47,
"BLD",6093,1,311,0)
                                                         61,69,74,90
"BLD",6093,1,312,0)
  YSCLTST1           15450428              11839450      18,22,25,26,
"BLD",6093,1,313,0)
                                                         47,61,69,74,90
"BLD",6093,1,314,0)
  YSCLTST2           11178871              32098862      18,22,26,47
"BLD",6093,1,315,0)
                                                         61,69,74,90
"BLD",6093,1,316,0)
  YSCLTST3           15031797              25645207      18,22,25,26
"BLD",6093,1,317,0)
                                                         47,61,69,74,90
"BLD",6093,1,318,0)
 
"BLD",6093,1,319,0)
 
"BLD",6093,1,320,0)
List of preceding patches: 18,22,25,26,47,61,69,74
"BLD",6093,1,321,0)
Sites should use CHECK^XTSUMBLD to verify checksums.
"BLD",6093,1,322,0)
 
"BLD",6093,1,323,0)
         Installation Instructions:
"BLD",6093,1,324,0)
         ==========================
"BLD",6093,1,325,0)
 
"BLD",6093,1,326,0)
  NOTE: This KIDS install does not place any options out of service
"BLD",6093,1,327,0)
        during the install and no existing user options are affected.
"BLD",6093,1,328,0)
 
"BLD",6093,1,329,0)
        The site should answer "NO" to all three questions.
"BLD",6093,1,330,0)
            Note: You may not receive all three prompts at your site.
"BLD",6093,1,331,0)
 
"BLD",6093,1,332,0)
        "Want KIDS to Rebuild Menu Trees Upon Completion of
"BLD",6093,1,333,0)
         Install? YES// NO"
"BLD",6093,1,334,0)
 
"BLD",6093,1,335,0)
        "Want KIDS to INHIBIT LOGONs during the install? YES// NO"
"BLD",6093,1,336,0)
 
"BLD",6093,1,337,0)
        "Want to DISABLE Scheduled Options, Menu Options, and
"BLD",6093,1,338,0)
         Protocols?
"BLD",6093,1,339,0)
         YES// NO"
"BLD",6093,1,340,0)
 
"BLD",6093,1,341,0)
         1. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu.
"BLD",6093,1,342,0)
            This option will load the KIDS package in this message onto
"BLD",6093,1,343,0)
            your system.
"BLD",6093,1,344,0)
 
"BLD",6093,1,345,0)
         2. The patch has now been loaded into a Transport global on
"BLD",6093,1,346,0)
            your system. You now need to use KIDS to install the
"BLD",6093,1,347,0)
            Transport global.
"BLD",6093,1,348,0)
 
"BLD",6093,1,349,0)
            On the KIDS menu, under the 'Installation' menu, use the
"BLD",6093,1,350,0)
            following options:
"BLD",6093,1,351,0)
                Print Transport Global
"BLD",6093,1,352,0)
                Compare Transport Global to Current System
"BLD",6093,1,353,0)
                Verify Checksums in Transport Global
"BLD",6093,1,354,0)
                Backup a Transport Global
"BLD",6093,1,355,0)
 
"BLD",6093,1,356,0)
         3. Users may remain on the system, installation may be done at
"BLD",6093,1,357,0)
            any time except during the time scheduled for the Clozapine
"BLD",6093,1,358,0)
            roll-up.
"BLD",6093,1,359,0)
 
"BLD",6093,1,360,0)
         4. No options need to be placed out of service.
"BLD",6093,1,361,0)
 
"BLD",6093,1,362,0)
         5. Installation time is less than 2 minutes during off peak
"BLD",6093,1,363,0)
            hours and less than 5 minutes during peak hours.
"BLD",6093,1,364,0)
 
"BLD",6093,1,365,0)
         6. Installation of this patch requires no additional memory
"BLD",6093,1,366,0)
            space.
"BLD",6093,1,367,0)
 
"BLD",6093,1,368,0)
         7. From the 'Installation Menu' of the KIDS menu, run the
"BLD",6093,1,369,0)
            option:
"BLD",6093,1,370,0)
            'Install Package(s)' Select the package 'YS*5.01*90 and
"BLD",6093,1,371,0)
            proceed with the install.
"BLD",6093,4,0)
^9.64PA^603.04^3
"BLD",6093,4,603.01,0)
603.01
"BLD",6093,4,603.01,222)
y^n^f^^^^n
"BLD",6093,4,603.03,0)
603.03
"BLD",6093,4,603.03,222)
y^n^f^^^^n
"BLD",6093,4,603.04,0)
603.04
"BLD",6093,4,603.04,222)
y^n^f^^n^^y^a^n
"BLD",6093,4,"B",603.01,603.01)

"BLD",6093,4,"B",603.03,603.03)

"BLD",6093,4,"B",603.04,603.04)

"BLD",6093,6.3)
18
"BLD",6093,"KRN",0)
^9.67PA^8989.52^19
"BLD",6093,"KRN",.4,0)
.4
"BLD",6093,"KRN",.401,0)
.401
"BLD",6093,"KRN",.402,0)
.402
"BLD",6093,"KRN",.403,0)
.403
"BLD",6093,"KRN",.5,0)
.5
"BLD",6093,"KRN",.84,0)
.84
"BLD",6093,"KRN",3.6,0)
3.6
"BLD",6093,"KRN",3.8,0)
3.8
"BLD",6093,"KRN",9.2,0)
9.2
"BLD",6093,"KRN",9.8,0)
9.8
"BLD",6093,"KRN",9.8,"NM",0)
^9.68A^10^8
"BLD",6093,"KRN",9.8,"NM",1,0)
YSCLSERV^^0^B62056813
"BLD",6093,"KRN",9.8,"NM",4,0)
YSCLSRV3^^0^B46877449
"BLD",6093,"KRN",9.8,"NM",5,0)
YSCLTEST^^0^B20876343
"BLD",6093,"KRN",9.8,"NM",6,0)
YSCLTST1^^0^B19103633
"BLD",6093,"KRN",9.8,"NM",7,0)
YSCLSRV2^^0^B45550399
"BLD",6093,"KRN",9.8,"NM",8,0)
YSCLTST2^^0^B77542663
"BLD",6093,"KRN",9.8,"NM",9,0)
YSCLTST3^^0^B59491458
"BLD",6093,"KRN",9.8,"NM",10,0)
YSCLSRV1^^0^B2228786
"BLD",6093,"KRN",9.8,"NM","B","YSCLSERV",1)

"BLD",6093,"KRN",9.8,"NM","B","YSCLSRV1",10)

"BLD",6093,"KRN",9.8,"NM","B","YSCLSRV2",7)

"BLD",6093,"KRN",9.8,"NM","B","YSCLSRV3",4)

"BLD",6093,"KRN",9.8,"NM","B","YSCLTEST",5)

"BLD",6093,"KRN",9.8,"NM","B","YSCLTST1",6)

"BLD",6093,"KRN",9.8,"NM","B","YSCLTST2",8)

"BLD",6093,"KRN",9.8,"NM","B","YSCLTST3",9)

"BLD",6093,"KRN",19,0)
19
"BLD",6093,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",6093,"KRN",19,"NM",1,0)
CLOZAPINE MULTI TEST LINK^^0
"BLD",6093,"KRN",19,"NM","B","CLOZAPINE MULTI TEST LINK",1)

"BLD",6093,"KRN",19.1,0)
19.1
"BLD",6093,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",6093,"KRN",19.1,"NM",1,0)
YSCL AUTHORIZED^^0
"BLD",6093,"KRN",19.1,"NM","B","YSCL AUTHORIZED",1)

"BLD",6093,"KRN",101,0)
101
"BLD",6093,"KRN",101,"NM",0)
^9.68A^^
"BLD",6093,"KRN",409.61,0)
409.61
"BLD",6093,"KRN",771,0)
771
"BLD",6093,"KRN",870,0)
870
"BLD",6093,"KRN",8989.51,0)
8989.51
"BLD",6093,"KRN",8989.52,0)
8989.52
"BLD",6093,"KRN",8994,0)
8994
"BLD",6093,"KRN","B",.4,.4)

"BLD",6093,"KRN","B",.401,.401)

"BLD",6093,"KRN","B",.402,.402)

"BLD",6093,"KRN","B",.403,.403)

"BLD",6093,"KRN","B",.5,.5)

"BLD",6093,"KRN","B",.84,.84)

"BLD",6093,"KRN","B",3.6,3.6)

"BLD",6093,"KRN","B",3.8,3.8)

"BLD",6093,"KRN","B",9.2,9.2)

"BLD",6093,"KRN","B",9.8,9.8)

"BLD",6093,"KRN","B",19,19)

"BLD",6093,"KRN","B",19.1,19.1)

"BLD",6093,"KRN","B",101,101)

"BLD",6093,"KRN","B",409.61,409.61)

"BLD",6093,"KRN","B",771,771)

"BLD",6093,"KRN","B",870,870)

"BLD",6093,"KRN","B",8989.51,8989.51)

"BLD",6093,"KRN","B",8989.52,8989.52)

"BLD",6093,"KRN","B",8994,8994)

"BLD",6093,"QUES",0)
^9.62^^
"BLD",6093,"REQB",0)
^9.611^1^1
"BLD",6093,"REQB",1,0)
YS*5.01*74^1
"BLD",6093,"REQB","B","YS*5.01*74",1)

"DATA",603.04,1,0)
CLOZAPINE
"DATA",603.04,1,1,0)
^603.41P^^0
"FIA",603.01)
CLOZAPINE PATIENT LIST
"FIA",603.01,0)
^YSCL(603.01,
"FIA",603.01,0,0)
603.01
"FIA",603.01,0,1)
y^n^f^^^^n
"FIA",603.01,0,10)

"FIA",603.01,0,11)

"FIA",603.01,0,"RLRO")

"FIA",603.01,0,"VR")
5.01^YS
"FIA",603.01,603.01)
0
"FIA",603.03)
CLOZAPINE PARAMETERS
"FIA",603.03,0)
^YSCL(603.03,
"FIA",603.03,0,0)
603.03S
"FIA",603.03,0,1)
y^n^f^^^^n
"FIA",603.03,0,10)

"FIA",603.03,0,11)

"FIA",603.03,0,"RLRO")

"FIA",603.03,0,"VR")
5.01^YS
"FIA",603.03,603.03)
0
"FIA",603.04)
CLOZAPINE TESTS
"FIA",603.04,0)
^YSCL(603.04,
"FIA",603.04,0,0)
603.04
"FIA",603.04,0,1)
y^n^f^^n^^y^a^n
"FIA",603.04,0,10)

"FIA",603.04,0,11)

"FIA",603.04,0,"RLRO")

"FIA",603.04,0,"VR")
5.01^YS
"FIA",603.04,603.04)
0
"FIA",603.04,603.41)
0
"KRN",19,14338,-1)
0^1
"KRN",19,14338,0)
CLOZAPINE MULTI TEST LINK^Link Multiple Tests to Clozapine^^R^^^^^^^^
"KRN",19,14338,1,0)
^^7^7^3060313^
"KRN",19,14338,1,1,0)
This option allows the site to enter as many tests as necessary to 
"KRN",19,14338,1,2,0)
Clozapine.  A test representing the White Blood Count must be entered.  
"KRN",19,14338,1,3,0)
Additional tests must be entered to represent the Absolute Neutrophil 
"KRN",19,14338,1,4,0)
Count.  These may be the Absolute Neutorphil Count, a Neutrophil 
"KRN",19,14338,1,5,0)
Percentage, or BANDS and SEGS.  If BANDS and SEGS are entered, both tests 
"KRN",19,14338,1,6,0)
must be entered.  If only one of the two are entered, dispense 
"KRN",19,14338,1,7,0)
authorization will not occur.
"KRN",19,14338,25)
TLIST^YSCLTST3
"KRN",19,14338,"U")
LINK MULTIPLE TESTS TO CLOZAPI
"KRN",19.1,518,-1)
0^1
"KRN",19.1,518,0)
YSCL AUTHORIZED^Authorized Clozapine provider^^n
"KRN",19.1,518,1,0)
^19.11^1^1^3051130^
"KRN",19.1,518,1,1,0)
The presence of this key designates an authorized Clozapine provider.
"MBREQ")
0
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",19,-1)
1^1
"PKG",19,0)
MENTAL HEALTH^YS^Version 5.01 of Mental Health
"PKG",19,20,0)
^9.402P^^
"PKG",19,22,0)
^9.49I^1^1
"PKG",19,22,1,0)
5.01^2941230^2950331
"PKG",19,22,1,"PAH",1,0)
90^3060905^7
"PKG",19,22,1,"PAH",1,1,0)
^^371^371^3060905
"PKG",19,22,1,"PAH",1,1,1,0)
Recent changes in the Clozapine protocol require changes to the Clozapine 
"PKG",19,22,1,"PAH",1,1,2,0)
Roll Up software.  Originally, all Clozapine prescriptions were limited 
"PKG",19,22,1,"PAH",1,1,3,0)
to 7 days.  Renewals and refills were not allowed.  In addition, the 
"PKG",19,22,1,"PAH",1,1,4,0)
Clozapine reporting software automatically discontinued any patient if 
"PKG",19,22,1,"PAH",1,1,5,0)
the patient's prescription was over 28 days old.  This was to prevent a 
"PKG",19,22,1,"PAH",1,1,6,0)
patient from being issued medication on an expired prescription.  The 
"PKG",19,22,1,"PAH",1,1,7,0)
revised Clozapine protocol allows for a monthly prescription as well as 
"PKG",19,22,1,"PAH",1,1,8,0)
weekly and bi-weekly.  The patient is now automatically discontinued if 
"PKG",19,22,1,"PAH",1,1,9,0)
the issue date for the most recent prescription is greater than 56 days 
"PKG",19,22,1,"PAH",1,1,10,0)
in the past.
"PKG",19,22,1,"PAH",1,1,11,0)
 
"PKG",19,22,1,"PAH",1,1,12,0)
The weekly roll-up creates a report that is sent to the local G.PSOCLOZ 
"PKG",19,22,1,"PAH",1,1,13,0)
mail group.  This report lists the patients reported to the national 
"PKG",19,22,1,"PAH",1,1,14,0)
database along with an indicator showing whether or not Lab and RX data 
"PKG",19,22,1,"PAH",1,1,15,0)
were transmitted.  This report has been updated to show the date of the 
"PKG",19,22,1,"PAH",1,1,16,0)
most recent WBC (White Blood Count) and Neutrophil Count along with the 
"PKG",19,22,1,"PAH",1,1,17,0)
date of the most recent Clozapine prescription.  Mental Health and 
"PKG",19,22,1,"PAH",1,1,18,0)
Pharmacy personnel responsible for prescribing and dispensing Clozapine 
"PKG",19,22,1,"PAH",1,1,19,0)
should be made aware of this mail group and given the opportunity to join.
"PKG",19,22,1,"PAH",1,1,20,0)
 
"PKG",19,22,1,"PAH",1,1,21,0)
NEW OPTION:
"PKG",19,22,1,"PAH",1,1,22,0)
==========
"PKG",19,22,1,"PAH",1,1,23,0)
The Link Multiple Tests to Clozapine [CLOZAPINE MULTI TEST LINK] option 
"PKG",19,22,1,"PAH",1,1,24,0)
must be assigned to the person or persons responsible for ensuring that 
"PKG",19,22,1,"PAH",1,1,25,0)
the appropriate data is in place to validate Clozapine testing data.  
"PKG",19,22,1,"PAH",1,1,26,0)
This is usually the Laboratory ADPAC.
"PKG",19,22,1,"PAH",1,1,27,0)
 
"PKG",19,22,1,"PAH",1,1,28,0)
This option will ask for the local laboratory name that equates to the 
"PKG",19,22,1,"PAH",1,1,29,0)
following seven common test names
"PKG",19,22,1,"PAH",1,1,30,0)
 
"PKG",19,22,1,"PAH",1,1,31,0)
White Blood Cell Count
"PKG",19,22,1,"PAH",1,1,32,0)
Absolute Neutrophil Count
"PKG",19,22,1,"PAH",1,1,33,0)
Neutrophil %
"PKG",19,22,1,"PAH",1,1,34,0)
Segs  (Percent)
"PKG",19,22,1,"PAH",1,1,35,0)
Bands (Percent)
"PKG",19,22,1,"PAH",1,1,36,0)
Segs  (Absolute Count)
"PKG",19,22,1,"PAH",1,1,37,0)
Bands (Absolute Count)
"PKG",19,22,1,"PAH",1,1,38,0)
 
"PKG",19,22,1,"PAH",1,1,39,0)
You will also be asked to fill in the reporting format for each test.  
"PKG",19,22,1,"PAH",1,1,40,0)
Most sites report WBC and Neutrophil results in K/unit format (K/cc or 
"PKG",19,22,1,"PAH",1,1,41,0)
K/cu mm or K/mm-3 or K/mL). For example, WBC equals 5.1.  However, some 
"PKG",19,22,1,"PAH",1,1,42,0)
report results as discrete units. For example, WBC equals 5100.  This 
"PKG",19,22,1,"PAH",1,1,43,0)
field will allow the site to specify how results are reported.  Entries 
"PKG",19,22,1,"PAH",1,1,44,0)
that report in a percentage (such as Neutrophil %, Segs %, and Bands %) 
"PKG",19,22,1,"PAH",1,1,45,0)
should use "Percentage".
"PKG",19,22,1,"PAH",1,1,46,0)
 
"PKG",19,22,1,"PAH",1,1,47,0)
You may input as many names from the local laboratory definition for each 
"PKG",19,22,1,"PAH",1,1,48,0)
of these tests as needed.  Remember that the laboratory may have designed 
"PKG",19,22,1,"PAH",1,1,49,0)
special names for specific test equipment, specific test locations, or 
"PKG",19,22,1,"PAH",1,1,50,0)
specific test conditions, such as manual counts.  
"PKG",19,22,1,"PAH",1,1,51,0)
 
"PKG",19,22,1,"PAH",1,1,52,0)
In fact, if your facility has Clozapine patients with blood samples drawn 
"PKG",19,22,1,"PAH",1,1,53,0)
and tested on a fee-basis at other CLIA (Clinical Laboratory Improvement 
"PKG",19,22,1,"PAH",1,1,54,0)
Amendments) approved labs, it is extremely important for your Laboratory 
"PKG",19,22,1,"PAH",1,1,55,0)
have tests to accept manual input of these tests.  
"PKG",19,22,1,"PAH",1,1,56,0)
 
"PKG",19,22,1,"PAH",1,1,57,0)
Therefore, you should involve laboratory managers or ADPAC (Automated 
"PKG",19,22,1,"PAH",1,1,58,0)
Data Processing Application Coordinator) in selection of these names - 
"PKG",19,22,1,"PAH",1,1,59,0)
both to define the test names currently in use and to create the 
"PKG",19,22,1,"PAH",1,1,60,0)
provision for manual entry of data.  Please be certain every possible 
"PKG",19,22,1,"PAH",1,1,61,0)
local laboratory name that represents these tests is entered that relates 
"PKG",19,22,1,"PAH",1,1,62,0)
to each of the seven test names above.  Pharmacy dispense will be 
"PKG",19,22,1,"PAH",1,1,63,0)
prevented unless the program can find the needed test results under one 
"PKG",19,22,1,"PAH",1,1,64,0)
of names you identify as an equivalent for each of the seven tests.
"PKG",19,22,1,"PAH",1,1,65,0)
 
"PKG",19,22,1,"PAH",1,1,66,0)
Security Key: The YSCL AUTHORIZED Security Key is new with this patch.  
"PKG",19,22,1,"PAH",1,1,67,0)
 This key must be assigned to each provider authorized to dispense 
"PKG",19,22,1,"PAH",1,1,68,0)
 Clozapine.
"PKG",19,22,1,"PAH",1,1,69,0)
 
"PKG",19,22,1,"PAH",1,1,70,0)
EXAMPLE: CLOZAPINE MULTI TEST LINK [Link Multiple Tests to Clozapine] 
"PKG",19,22,1,"PAH",1,1,71,0)
option
"PKG",19,22,1,"PAH",1,1,72,0)
 
"PKG",19,22,1,"PAH",1,1,73,0)
Select OPTION NAME: CLOZ
"PKG",19,22,1,"PAH",1,1,74,0)
     1   CLOZAPINE MULTI TEST LINK       Link Multiple Tests to Clozapine
"PKG",19,22,1,"PAH",1,1,75,0)
     2   CLOZAPINE DATA SERVER  YSCLSERVER     Clozapine Data Server
"PKG",19,22,1,"PAH",1,1,76,0)
     3   CLOZAPINE PHARMACY MANAGER  PSOL MANAGER     Clozapine Pharmacy 
"PKG",19,22,1,"PAH",1,1,77,0)
Manager
"PKG",19,22,1,"PAH",1,1,78,0)
     4   CLOZAPINE TEST LINK  YSCL TEST LINK     Clozapine Test Link
"PKG",19,22,1,"PAH",1,1,79,0)
CHOOSE 1-4: 1  CLOZAPINE MULTI TEST LINK     Link Multiple Tests to 
"PKG",19,22,1,"PAH",1,1,80,0)
Clozapine 
"PKG",19,22,1,"PAH",1,1,81,0)
Link Multiple Tests to Clozapine
"PKG",19,22,1,"PAH",1,1,82,0)
Currently linked Tests:
"PKG",19,22,1,"PAH",1,1,83,0)
NEUTROPHIL MATURITY, MEAN represents WHITE BLOOD COUNT
"PKG",19,22,1,"PAH",1,1,84,0)
SEGS represents BANDS %
"PKG",19,22,1,"PAH",1,1,85,0)
 
"PKG",19,22,1,"PAH",1,1,86,0)
Enter the name of the test for Clozapine: WBC       WBC
"PKG",19,22,1,"PAH",1,1,87,0)
Enter the type of the test for Clozapine: ?
"PKG",19,22,1,"PAH",1,1,88,0)
 
"PKG",19,22,1,"PAH",1,1,89,0)
Enter a code from the list.
"PKG",19,22,1,"PAH",1,1,90,0)
 
"PKG",19,22,1,"PAH",1,1,91,0)
     Select one of the following:
"PKG",19,22,1,"PAH",1,1,92,0)
 
"PKG",19,22,1,"PAH",1,1,93,0)
          W         WHITE BLOOD COUNT
"PKG",19,22,1,"PAH",1,1,94,0)
          A         ABSOLUTE NEUTROPHIL COUNT
"PKG",19,22,1,"PAH",1,1,95,0)
          N         NEUTROPHIL PERCENT
"PKG",19,22,1,"PAH",1,1,96,0)
          S         SEGS %
"PKG",19,22,1,"PAH",1,1,97,0)
          B         BANDS %
"PKG",19,22,1,"PAH",1,1,98,0)
          T         BANDS ABSOLUTE
"PKG",19,22,1,"PAH",1,1,99,0)
          C         SEGS ABSOLUTE
"PKG",19,22,1,"PAH",1,1,100,0)
 
"PKG",19,22,1,"PAH",1,1,101,0)
Enter the type of the test for Clozapine: WHITE BLOOD COUNT
"PKG",19,22,1,"PAH",1,1,102,0)
Enter the reporting method of the test for Clozapine: ?
"PKG",19,22,1,"PAH",1,1,103,0)
 
"PKG",19,22,1,"PAH",1,1,104,0)
Enter a code from the list.
"PKG",19,22,1,"PAH",1,1,105,0)
 
"PKG",19,22,1,"PAH",1,1,106,0)
     Select one of the following:
"PKG",19,22,1,"PAH",1,1,107,0)
 
"PKG",19,22,1,"PAH",1,1,108,0)
          0         uL
"PKG",19,22,1,"PAH",1,1,109,0)
          1         K/uL
"PKG",19,22,1,"PAH",1,1,110,0)
          2         Percent
"PKG",19,22,1,"PAH",1,1,111,0)
 
"PKG",19,22,1,"PAH",1,1,112,0)
Enter the reporting method of the test for Clozapine: 2  Percent
"PKG",19,22,1,"PAH",1,1,113,0)
 
"PKG",19,22,1,"PAH",1,1,114,0)
Enter the name of the test for Clozapine:
"PKG",19,22,1,"PAH",1,1,115,0)
 
"PKG",19,22,1,"PAH",1,1,116,0)
The FDA (Food and Drug Administration) uses White Blood Cell Count and 
"PKG",19,22,1,"PAH",1,1,117,0)
Absolute Neutrophil Count as the definitive tests to verify for Clozapine 
"PKG",19,22,1,"PAH",1,1,118,0)
use, however your lab may report your data under any of the names you 
"PKG",19,22,1,"PAH",1,1,119,0)
enter into these lists.  If the WBC and ANC are not directly available, 
"PKG",19,22,1,"PAH",1,1,120,0)
ANC will be calculated from the other data available and presented to 
"PKG",19,22,1,"PAH",1,1,121,0)
Pharmacy (and CPRS (Computerized Patient Record System) during a later 
"PKG",19,22,1,"PAH",1,1,122,0)
revision) at the time of dispense and used to evaluate the safety under 
"PKG",19,22,1,"PAH",1,1,123,0)
FDA limits.  Only the most recent WBC will be accepted, and the date and 
"PKG",19,22,1,"PAH",1,1,124,0)
time stamp of the Neutrophil count must match the date and time stamp of 
"PKG",19,22,1,"PAH",1,1,125,0)
the WBC.
"PKG",19,22,1,"PAH",1,1,126,0)
 
"PKG",19,22,1,"PAH",1,1,127,0)
 
"PKG",19,22,1,"PAH",1,1,128,0)
WHITE BLOOD CELL  (WBC)
"PKG",19,22,1,"PAH",1,1,129,0)
 
"PKG",19,22,1,"PAH",1,1,130,0)
For reference  "White Blood Cell Count" is a portion of the total blood 
"PKG",19,22,1,"PAH",1,1,131,0)
content and the sum total of two different kinds of cells - 
"PKG",19,22,1,"PAH",1,1,132,0)
 
"PKG",19,22,1,"PAH",1,1,133,0)
         AGRANULOCYTES - those cells which do not have granules
"PKG",19,22,1,"PAH",1,1,134,0)
         that absorb a stain.  These cells are subdivided
"PKG",19,22,1,"PAH",1,1,135,0)
         into Lymphocytes and Monocytes. 
"PKG",19,22,1,"PAH",1,1,136,0)
 
"PKG",19,22,1,"PAH",1,1,137,0)
         GRANULOCYTES  -- those cells which contain granules
"PKG",19,22,1,"PAH",1,1,138,0)
         that absorb a stain.  These cells are subdivided
"PKG",19,22,1,"PAH",1,1,139,0)
         into Neutrophils, Basophils, and Eosinophils.  
"PKG",19,22,1,"PAH",1,1,140,0)
 
"PKG",19,22,1,"PAH",1,1,141,0)
Both Agranulocytes and Granulocytes are part of the Total White Blood 
"PKG",19,22,1,"PAH",1,1,142,0)
Cell Count.  Therefore, the total WBC is the sum of five different types 
"PKG",19,22,1,"PAH",1,1,143,0)
of cells.  
"PKG",19,22,1,"PAH",1,1,144,0)
 
"PKG",19,22,1,"PAH",1,1,145,0)
WBC as well as its five components are usually expressed as the total 
"PKG",19,22,1,"PAH",1,1,146,0)
number of cells in a cubic centimeter of blood (cc) or cubic millimeter 
"PKG",19,22,1,"PAH",1,1,147,0)
(cu mm or mm-3)or milliliters (mL).  
"PKG",19,22,1,"PAH",1,1,148,0)
 
"PKG",19,22,1,"PAH",1,1,149,0)
WBC usually falls with a range between 4000 and 11,000 but fluctuates for 
"PKG",19,22,1,"PAH",1,1,150,0)
a number of medical reasons.  For brevity, WBC results may be divided by 
"PKG",19,22,1,"PAH",1,1,151,0)
1000 and presented as K/cc or K/cu mm or K/mm-3 or K/mL
"PKG",19,22,1,"PAH",1,1,152,0)
 
"PKG",19,22,1,"PAH",1,1,153,0)
 
"PKG",19,22,1,"PAH",1,1,154,0)
The five components are similarly expressed as number of the same type OR 
"PKG",19,22,1,"PAH",1,1,155,0)
as a percentage of the total WBC.  
"PKG",19,22,1,"PAH",1,1,156,0)
 
"PKG",19,22,1,"PAH",1,1,157,0)
The sum of counts of the five components of should equal the total WBC OR 
"PKG",19,22,1,"PAH",1,1,158,0)
the sum of the percentages of the five components should equal 100%
"PKG",19,22,1,"PAH",1,1,159,0)
 
"PKG",19,22,1,"PAH",1,1,160,0)
This test is sometimes also referred to as "Leukocyte Count" 
"PKG",19,22,1,"PAH",1,1,161,0)
 
"PKG",19,22,1,"PAH",1,1,162,0)
 
"PKG",19,22,1,"PAH",1,1,163,0)
Absolute Neutrophil Count (ANC)
"PKG",19,22,1,"PAH",1,1,164,0)
 
"PKG",19,22,1,"PAH",1,1,165,0)
The Absolute Neutrophil Count is the total number of Neutrophil cells in 
"PKG",19,22,1,"PAH",1,1,166,0)
the total WBC count.  The other GRANULOCYTE cells - Basophils and 
"PKG",19,22,1,"PAH",1,1,167,0)
Eosinophils (see White Blood Cell Count above) - are not included in this 
"PKG",19,22,1,"PAH",1,1,168,0)
number.  Therefore - a test titled GRANULOCYTES - may not produce the 
"PKG",19,22,1,"PAH",1,1,169,0)
desired result as it may include Basophils and Eosinophils.
"PKG",19,22,1,"PAH",1,1,170,0)
 
"PKG",19,22,1,"PAH",1,1,171,0)
Since the ANC is a portion of the WBC, it is only valid if it is 
"PKG",19,22,1,"PAH",1,1,172,0)
traceable to the WBC sample drawn at the same date and time.  
"PKG",19,22,1,"PAH",1,1,173,0)
 
"PKG",19,22,1,"PAH",1,1,174,0)
ANC is a count and not a percentage - expressed as WBC with the total 
"PKG",19,22,1,"PAH",1,1,175,0)
number of cells in a cubic centimeter of blood (cc) or cubic millimeter 
"PKG",19,22,1,"PAH",1,1,176,0)
(cu mm or mm-3)or milliliters (mL).  Again, this number may be divided by 
"PKG",19,22,1,"PAH",1,1,177,0)
a thousand for brevity.  
"PKG",19,22,1,"PAH",1,1,178,0)
 
"PKG",19,22,1,"PAH",1,1,179,0)
The Absolute Neutrophil Count generally ranges from 1600 to 7700 / but it 
"PKG",19,22,1,"PAH",1,1,180,0)
can ever exceed the WBC count.  
"PKG",19,22,1,"PAH",1,1,181,0)
 
"PKG",19,22,1,"PAH",1,1,182,0)
This test can also be knows as polymorphonuclear cells or PMN's. 
"PKG",19,22,1,"PAH",1,1,183,0)
 
"PKG",19,22,1,"PAH",1,1,184,0)
 
"PKG",19,22,1,"PAH",1,1,185,0)
Neutrophil Percent  (Neut%)
"PKG",19,22,1,"PAH",1,1,186,0)
 
"PKG",19,22,1,"PAH",1,1,187,0)
The Neutrophil Percent is the portion of the total WBC and that is 
"PKG",19,22,1,"PAH",1,1,188,0)
composed of Neutrophil cells, excluding all agranulocytes and other 
"PKG",19,22,1,"PAH",1,1,189,0)
granulocytes.  This number is usually between 40% and 70%, but fluctuates 
"PKG",19,22,1,"PAH",1,1,190,0)
for many medical reasons.  
"PKG",19,22,1,"PAH",1,1,191,0)
 
"PKG",19,22,1,"PAH",1,1,192,0)
Since it is reported as a portion of the total WBC, it is only valid if 
"PKG",19,22,1,"PAH",1,1,193,0)
it is traceable to the WBC sample drawn at the same date and time.  
"PKG",19,22,1,"PAH",1,1,194,0)
 
"PKG",19,22,1,"PAH",1,1,195,0)
Neut% is commonly obtained by automatic testing equipment to represent 
"PKG",19,22,1,"PAH",1,1,196,0)
the Neutrophil content in the blood.  
"PKG",19,22,1,"PAH",1,1,197,0)
 
"PKG",19,22,1,"PAH",1,1,198,0)
Neut% is a percentage and not a count - reported in the portion of the 
"PKG",19,22,1,"PAH",1,1,199,0)
WBC.  It can be converted into an Absolute Neutrophil Count in the 
"PKG",19,22,1,"PAH",1,1,200,0)
following formula (Neutrophil% / 100) X WBC count).  
"PKG",19,22,1,"PAH",1,1,201,0)
 
"PKG",19,22,1,"PAH",1,1,202,0)
The Neutrophil Percent generally ranges from 37% to 80% and should never 
"PKG",19,22,1,"PAH",1,1,203,0)
exceed 90% of the total WBC count unless special medical conditions are 
"PKG",19,22,1,"PAH",1,1,204,0)
present.  
"PKG",19,22,1,"PAH",1,1,205,0)
 
"PKG",19,22,1,"PAH",1,1,206,0)
 
"PKG",19,22,1,"PAH",1,1,207,0)
SEGS  & BANDS  
"PKG",19,22,1,"PAH",1,1,208,0)
 
"PKG",19,22,1,"PAH",1,1,209,0)
The WBC/Granulocyte/Neutrophil cell type can be further subdivided into 
"PKG",19,22,1,"PAH",1,1,210,0)
two types.  Mature neutrophils are called SEGS.  Immature neutrophils 
"PKG",19,22,1,"PAH",1,1,211,0)
called BANDS also circulate in the blood until they mature into SEGS.  
"PKG",19,22,1,"PAH",1,1,212,0)
The sum of SEGS and BANDS is equal to the ANC of a give WBC count.  
"PKG",19,22,1,"PAH",1,1,213,0)
 
"PKG",19,22,1,"PAH",1,1,214,0)
SEGS and BANDS may be reported as a count, expressed in cc, mm-3, cu mm, 
"PKG",19,22,1,"PAH",1,1,215,0)
or mL.  A preceding K indicates the number has been divided by 1000.  
"PKG",19,22,1,"PAH",1,1,216,0)
 
"PKG",19,22,1,"PAH",1,1,217,0)
When SEGS and BANDS are reported as a number, the sum total of SEGS and 
"PKG",19,22,1,"PAH",1,1,218,0)
BANDS equals the total Neutrophil Count (ANC)  NOTE that the program 
"PKG",19,22,1,"PAH",1,1,219,0)
needs an identifying test for both SEGS and BANDS.  Reporting SEGS 
"PKG",19,22,1,"PAH",1,1,220,0)
without a parallel result from BANDS will result in an error condition 
"PKG",19,22,1,"PAH",1,1,221,0)
that may prevent Pharmacy dispense.  
"PKG",19,22,1,"PAH",1,1,222,0)
 
"PKG",19,22,1,"PAH",1,1,223,0)
This number generally ranges between 1600 and 7700 / cu mm.  It should 
"PKG",19,22,1,"PAH",1,1,224,0)
never exceed 90% of the total WBC except under special circumstances. 
"PKG",19,22,1,"PAH",1,1,225,0)
 
"PKG",19,22,1,"PAH",1,1,226,0)
SEGS and BANDS may be reported as a PERCENTAGE of the total WBC.  
"PKG",19,22,1,"PAH",1,1,227,0)
Therefore the total number of neutrophils (ANC) in a give WBC is = total 
"PKG",19,22,1,"PAH",1,1,228,0)
WBC  X  (% Segs  + % Bands).  This calculation will be performed by the 
"PKG",19,22,1,"PAH",1,1,229,0)
Pharmacy patch to obtain and ANC when necessary
"PKG",19,22,1,"PAH",1,1,230,0)
 
"PKG",19,22,1,"PAH",1,1,231,0)
The sum total of SEGS% and BANDS% can never exceed 100.
"PKG",19,22,1,"PAH",1,1,232,0)
 
"PKG",19,22,1,"PAH",1,1,233,0)
DATA DICTIONARY:
"PKG",19,22,1,"PAH",1,1,234,0)
===============
"PKG",19,22,1,"PAH",1,1,235,0)
CLOZAPINE PATIENT LIST File (#603.01), OVERRIDE DATE field (#3) - This 
"PKG",19,22,1,"PAH",1,1,236,0)
field was added to allow the NCCC more control over the overrides 
"PKG",19,22,1,"PAH",1,1,237,0)
performed at the site.
"PKG",19,22,1,"PAH",1,1,238,0)
 
"PKG",19,22,1,"PAH",1,1,239,0)
CLOZAPINE PARAMETERS File (#603.03), LOCK DOWN field (#7) - This field 
"PKG",19,22,1,"PAH",1,1,240,0)
was added to allow the NCCC to prevent the dispensing of any Clozapine 
"PKG",19,22,1,"PAH",1,1,241,0)
prescription at a site.
"PKG",19,22,1,"PAH",1,1,242,0)
 
"PKG",19,22,1,"PAH",1,1,243,0)
 
"PKG",19,22,1,"PAH",1,1,244,0)
CLOZAPINE TESTS file (#603.04) - This file was added to allow the sites 
"PKG",19,22,1,"PAH",1,1,245,0)
to select multiple tests for the WBC and Neutrophil count.
"PKG",19,22,1,"PAH",1,1,246,0)
 
"PKG",19,22,1,"PAH",1,1,247,0)
Field         Field Name           Description
"PKG",19,22,1,"PAH",1,1,248,0)
603.04,.01    NAME            0;1 FREE TEXT (Required)
"PKG",19,22,1,"PAH",1,1,249,0)
603.04,1      TEST NAME       1;0 POINTER Multiple #603.41
"PKG",19,22,1,"PAH",1,1,250,0)
603.41,.01    TEST NAME       0;1 POINTER TO LABORATORY TEST FILE (#60)
"PKG",19,22,1,"PAH",1,1,251,0)
603.41,1      TEST TYPE            0;2 SET (Required)
"PKG",19,22,1,"PAH",1,1,252,0)
 
"PKG",19,22,1,"PAH",1,1,253,0)
                                'W' FOR WHITE BLOOD COUNT; 
"PKG",19,22,1,"PAH",1,1,254,0)
                                'A' FOR ABSOLUTE NEUTROPHIL COUNT; 
"PKG",19,22,1,"PAH",1,1,255,0)
                                'N' FOR NEUTROPHIL PERCENT; 
"PKG",19,22,1,"PAH",1,1,256,0)
                                'S' FOR SEGS %; 
"PKG",19,22,1,"PAH",1,1,257,0)
                                'B' FOR BANDS %; 
"PKG",19,22,1,"PAH",1,1,258,0)
                                'T' FOR BANDS ABSOLUTE; 
"PKG",19,22,1,"PAH",1,1,259,0)
                                'C' FOR SEGS ABSOLUTE; 
"PKG",19,22,1,"PAH",1,1,260,0)
603.41,2      REPORTING FORMAT     0;3 SET (Required)
"PKG",19,22,1,"PAH",1,1,261,0)
 
"PKG",19,22,1,"PAH",1,1,262,0)
                                '0' FOR Units; 
"PKG",19,22,1,"PAH",1,1,263,0)
                                '1' FOR K/units; 
"PKG",19,22,1,"PAH",1,1,264,0)
                                '2' FOR Percentage; 
"PKG",19,22,1,"PAH",1,1,265,0)
 
"PKG",19,22,1,"PAH",1,1,266,0)
INSTALLATION TIME FRAME:
"PKG",19,22,1,"PAH",1,1,267,0)
=======================
"PKG",19,22,1,"PAH",1,1,268,0)
VA DIRECTIVE 2001-023 REQUIRES INSTALLATION OF THIS PATCH WITHIN 30 DAYS 
"PKG",19,22,1,"PAH",1,1,269,0)
FROM THE TIME OF INITIAL RELEASE.
"PKG",19,22,1,"PAH",1,1,270,0)
 
"PKG",19,22,1,"PAH",1,1,271,0)
REQUESTING SITE:
"PKG",19,22,1,"PAH",1,1,272,0)
===============
"PKG",19,22,1,"PAH",1,1,273,0)
National Clozapine Coordinating Center
"PKG",19,22,1,"PAH",1,1,274,0)
 
"PKG",19,22,1,"PAH",1,1,275,0)
Test Site(s):
"PKG",19,22,1,"PAH",1,1,276,0)
============
"PKG",19,22,1,"PAH",1,1,277,0)
West LA
"PKG",19,22,1,"PAH",1,1,278,0)
Oklahoma
"PKG",19,22,1,"PAH",1,1,279,0)
Louisville
"PKG",19,22,1,"PAH",1,1,280,0)
 
"PKG",19,22,1,"PAH",1,1,281,0)
Reference NOIS:
"PKG",19,22,1,"PAH",1,1,282,0)
==============
"PKG",19,22,1,"PAH",1,1,283,0)
NA
"PKG",19,22,1,"PAH",1,1,284,0)
a
"PKG",19,22,1,"PAH",1,1,285,0)
ASSOCIATED E3Rs:
"PKG",19,22,1,"PAH",1,1,286,0)
===============
"PKG",19,22,1,"PAH",1,1,287,0)
NA
"PKG",19,22,1,"PAH",1,1,288,0)
 
"PKG",19,22,1,"PAH",1,1,289,0)
ASSOCIATED REMEDY TICKETS:
"PKG",19,22,1,"PAH",1,1,290,0)
=========================
"PKG",19,22,1,"PAH",1,1,291,0)
NA
"PKG",19,22,1,"PAH",1,1,292,0)
 
"PKG",19,22,1,"PAH",1,1,293,0)
  ROUTINE SUMMARY:
"PKG",19,22,1,"PAH",1,1,294,0)
  ================
"PKG",19,22,1,"PAH",1,1,295,0)
 
"PKG",19,22,1,"PAH",1,1,296,0)
  The following routines are included in this patch.  The second line
"PKG",19,22,1,"PAH",1,1,297,0)
  of each of these routines now looks like:
"PKG",19,22,1,"PAH",1,1,298,0)
  <tab>   ;;5.01;MENTAL HEALTH;**[patch list]**;Dec 30,1994
"PKG",19,22,1,"PAH",1,1,299,0)
 
"PKG",19,22,1,"PAH",1,1,300,0)
                              Checksum Values
"PKG",19,22,1,"PAH",1,1,301,0)
 
"PKG",19,22,1,"PAH",1,1,302,0)
  Routine Name      Before Patch         After Patch     Patch List
"PKG",19,22,1,"PAH",1,1,303,0)
  ------------      ------------         -----------     ----------
"PKG",19,22,1,"PAH",1,1,304,0)
 
"PKG",19,22,1,"PAH",1,1,305,0)
  YSCLSERV           25083145              25564583      18,22,26,47,
"PKG",19,22,1,"PAH",1,1,306,0)
                                                         61,69,74,90
"PKG",19,22,1,"PAH",1,1,307,0)
  YSCLSRV1           1605367               1606233       61,69,74,90
"PKG",19,22,1,"PAH",1,1,308,0)
  YSCLSRV2           16840829              24723007      69,90
"PKG",19,22,1,"PAH",1,1,309,0)
  YSCLSRV3           7345805               24872037      74,90
"PKG",19,22,1,"PAH",1,1,310,0)
  YSCLTEST           12047382              12378003      18,22,26,47,
"PKG",19,22,1,"PAH",1,1,311,0)
                                                         61,69,74,90
"PKG",19,22,1,"PAH",1,1,312,0)
  YSCLTST1           15450428              11839450      18,22,25,26,
"PKG",19,22,1,"PAH",1,1,313,0)
                                                         47,61,69,74,90
"PKG",19,22,1,"PAH",1,1,314,0)
  YSCLTST2           11178871              32098862      18,22,26,47
"PKG",19,22,1,"PAH",1,1,315,0)
                                                         61,69,74,90
"PKG",19,22,1,"PAH",1,1,316,0)
  YSCLTST3           15031797              25645207      18,22,25,26
"PKG",19,22,1,"PAH",1,1,317,0)
                                                         47,61,69,74,90
"PKG",19,22,1,"PAH",1,1,318,0)
 
"PKG",19,22,1,"PAH",1,1,319,0)
 
"PKG",19,22,1,"PAH",1,1,320,0)
List of preceding patches: 18,22,25,26,47,61,69,74
"PKG",19,22,1,"PAH",1,1,321,0)
Sites should use CHECK^XTSUMBLD to verify checksums.
"PKG",19,22,1,"PAH",1,1,322,0)
 
"PKG",19,22,1,"PAH",1,1,323,0)
         Installation Instructions:
"PKG",19,22,1,"PAH",1,1,324,0)
         ==========================
"PKG",19,22,1,"PAH",1,1,325,0)
 
"PKG",19,22,1,"PAH",1,1,326,0)
  NOTE: This KIDS install does not place any options out of service
"PKG",19,22,1,"PAH",1,1,327,0)
        during the install and no existing user options are affected.
"PKG",19,22,1,"PAH",1,1,328,0)
 
"PKG",19,22,1,"PAH",1,1,329,0)
        The site should answer "NO" to all three questions.
"PKG",19,22,1,"PAH",1,1,330,0)
            Note: You may not receive all three prompts at your site.
"PKG",19,22,1,"PAH",1,1,331,0)
 
"PKG",19,22,1,"PAH",1,1,332,0)
        "Want KIDS to Rebuild Menu Trees Upon Completion of
"PKG",19,22,1,"PAH",1,1,333,0)
         Install? YES// NO"
"PKG",19,22,1,"PAH",1,1,334,0)
 
"PKG",19,22,1,"PAH",1,1,335,0)
        "Want KIDS to INHIBIT LOGONs during the install? YES// NO"
"PKG",19,22,1,"PAH",1,1,336,0)
 
"PKG",19,22,1,"PAH",1,1,337,0)
        "Want to DISABLE Scheduled Options, Menu Options, and
"PKG",19,22,1,"PAH",1,1,338,0)
         Protocols?
"PKG",19,22,1,"PAH",1,1,339,0)
         YES// NO"
"PKG",19,22,1,"PAH",1,1,340,0)
 
"PKG",19,22,1,"PAH",1,1,341,0)
         1. Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu.
"PKG",19,22,1,"PAH",1,1,342,0)
            This option will load the KIDS package in this message onto
"PKG",19,22,1,"PAH",1,1,343,0)
            your system.
"PKG",19,22,1,"PAH",1,1,344,0)
 
"PKG",19,22,1,"PAH",1,1,345,0)
         2. The patch has now been loaded into a Transport global on
"PKG",19,22,1,"PAH",1,1,346,0)
            your system. You now need to use KIDS to install the
"PKG",19,22,1,"PAH",1,1,347,0)
            Transport global.
"PKG",19,22,1,"PAH",1,1,348,0)
 
"PKG",19,22,1,"PAH",1,1,349,0)
            On the KIDS menu, under the 'Installation' menu, use the
"PKG",19,22,1,"PAH",1,1,350,0)
            following options:
"PKG",19,22,1,"PAH",1,1,351,0)
                Print Transport Global
"PKG",19,22,1,"PAH",1,1,352,0)
                Compare Transport Global to Current System
"PKG",19,22,1,"PAH",1,1,353,0)
                Verify Checksums in Transport Global
"PKG",19,22,1,"PAH",1,1,354,0)
                Backup a Transport Global
"PKG",19,22,1,"PAH",1,1,355,0)
 
"PKG",19,22,1,"PAH",1,1,356,0)
         3. Users may remain on the system, installation may be done at
"PKG",19,22,1,"PAH",1,1,357,0)
            any time except during the time scheduled for the Clozapine
"PKG",19,22,1,"PAH",1,1,358,0)
            roll-up.
"PKG",19,22,1,"PAH",1,1,359,0)
 
"PKG",19,22,1,"PAH",1,1,360,0)
         4. No options need to be placed out of service.
"PKG",19,22,1,"PAH",1,1,361,0)
 
"PKG",19,22,1,"PAH",1,1,362,0)
         5. Installation time is less than 2 minutes during off peak
"PKG",19,22,1,"PAH",1,1,363,0)
            hours and less than 5 minutes during peak hours.
"PKG",19,22,1,"PAH",1,1,364,0)
 
"PKG",19,22,1,"PAH",1,1,365,0)
         6. Installation of this patch requires no additional memory
"PKG",19,22,1,"PAH",1,1,366,0)
            space.
"PKG",19,22,1,"PAH",1,1,367,0)
 
"PKG",19,22,1,"PAH",1,1,368,0)
         7. From the 'Installation Menu' of the KIDS menu, run the
"PKG",19,22,1,"PAH",1,1,369,0)
            option:
"PKG",19,22,1,"PAH",1,1,370,0)
            'Install Package(s)' Select the package 'YS*5.01*90 and
"PKG",19,22,1,"PAH",1,1,371,0)
            proceed with the install.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","YSCLSERV")
0^1^B62056813^B57252811
"RTN","YSCLSERV",1,0)
YSCLSERV ;DALOI/RLM-Clozapine data server ;24 APR 1990
"RTN","YSCLSERV",2,0)
 ;;5.01;MENTAL HEALTH;**18,22,26,47,61,69,74,90**;Dec 30, 1994;Build 18
"RTN","YSCLSERV",3,0)
 ; Reference to ^%ZOSF supported by IA #10096
"RTN","YSCLSERV",4,0)
 ; Reference to ^DPT supported by IA #10035
"RTN","YSCLSERV",5,0)
 ; Reference to ^DD("DD" supported by IA #10017
"RTN","YSCLSERV",6,0)
 ; Reference to ^PS(55 supported by IA #787
"RTN","YSCLSERV",7,0)
 ; Reference to ^PSDRUG supported by IA #25
"RTN","YSCLSERV",8,0)
 ; Reference to ^PSRX supported by IA #780
"RTN","YSCLSERV",9,0)
 ; Reference to ^VA(200 supported by IA #10060
"RTN","YSCLSERV",10,0)
 ; Reference to $$SITE^VASITE supported by IA #10112
"RTN","YSCLSERV",11,0)
 ; Reference to $$FMTE^XLFDT() supported by IA #10103
"RTN","YSCLSERV",12,0)
 ; Reference to ^PSDRUG supported by IA #221
"RTN","YSCLSERV",13,0)
 ; Reference to ^XMD supported by IA #10070
"RTN","YSCLSERV",14,0)
START ;
"RTN","YSCLSERV",15,0)
 K ^TMP($J,"YSCLDATA")
"RTN","YSCLSERV",16,0)
 S YSDEBUG=$P(^YSCL(603.03,1,0),"^",3)
"RTN","YSCLSERV",17,0)
 S YSCLST=$P($$SITE^VASITE,"^",3)
"RTN","YSCLSERV",18,0)
 S YSCLSTN=$P($$SITE^VASITE,"^",2)
"RTN","YSCLSERV",19,0)
 ;Determine station number
"RTN","YSCLSERV",20,0)
 S X=XQSUB X ^%ZOSF("UPPERCASE") S YSCLSUB=Y
"RTN","YSCLSERV",21,0)
 S ^TMP($J,"YSCLDATA",1)=$S(YSDEBUG:"DEBUG ",1:"")_YSCLSUB_" triggered at "_YSCLST_" by "_XMFROM_" on "_XQDATE
"RTN","YSCLSERV",22,0)
 ;The first line of the message tells who requested the action and when
"RTN","YSCLSERV",23,0)
 D
"RTN","YSCLSERV",24,0)
  . S YSACTION=$S(YSCLSUB["REMOVE"!(YSCLSUB["DELETE"):"data deleted",YSCLSUB["REPORT":"report generated",YSCLSUB["REBUILD":"data verified",YSCLSUB["UPDATE":"data updated",YSCLSUB["DATESET":"date set",1:"CONT")
"RTN","YSCLSERV",25,0)
  . I YSACTION="CONT" S YSACTION=$S(YSCLSUB["DEMOG RESET":"Demographics Flag Reset",YSCLSUB["DEBUG":"Debug Mode set",YSCLSUB["AUTH":"Authorization",YSCLSUB["LOCK":"Lock",1:"Site Lock")
"RTN","YSCLSERV",26,0)
  . S ^TMP($J,"YSCLDATA",2)="No "_$S(YSDEBUG:"DEBUG ",1:"")_YSACTION_" at "_YSCLST
"RTN","YSCLSERV",27,0)
 ;The second line tells when the server is activated and no data can be
"RTN","YSCLSERV",28,0)
 ;gathered from the MailMan message.  This line gets replaced if the
"RTN","YSCLSERV",29,0)
 ;server finds something to do.
"RTN","YSCLSERV",30,0)
 S YSCLLNT=1 I YSCLSUB["REMOVE"!(YSCLSUB["DELETE") G DELETE
"RTN","YSCLSERV",31,0)
 ;If the subject contains the word REMOVE or DELETE delete those entries from the list.
"RTN","YSCLSERV",32,0)
 I YSCLSUB["REPORT" G REPORT
"RTN","YSCLSERV",33,0)
 ;If the subject contains "REPORT" send a report of the currently registered patients to the Clozapine group on Forum
"RTN","YSCLSERV",34,0)
 ;I YSCLSUB["REBUILD" G REBUILD
"RTN","YSCLSERV",35,0)
 I YSCLSUB["RESEND" G RESEND
"RTN","YSCLSERV",36,0)
 I YSCLSUB["UPDATE" G UPDATE
"RTN","YSCLSERV",37,0)
 I YSCLSUB["CHECKSUM" G CSUM^YSCLSRV1
"RTN","YSCLSERV",38,0)
 I YSCLSUB["DATESET" G DSET
"RTN","YSCLSERV",39,0)
 I YSCLSUB["DEBUG" G DEBUG
"RTN","YSCLSERV",40,0)
 I YSCLSUB["PATIENT" G ^YSCLSRV3
"RTN","YSCLSERV",41,0)
 I YSCLSUB["LOCKOUT" G LOCK^YSCLSRV3
"RTN","YSCLSERV",42,0)
 I YSCLSUB="DEMOG RESET" G DEMOG^YSCLSRV3
"RTN","YSCLSERV",43,0)
 I YSCLSUB["AUTHORIZE" G AUTH^YSCLSRV3
"RTN","YSCLSERV",44,0)
 I YSCLSUB="OVERRIDE" G OVRRID^YSCLSRV2
"RTN","YSCLSERV",45,0)
 F  X XMREC Q:XMER<0  S XMRG=$TR(XMRG,"- ","") D
"RTN","YSCLSERV",46,0)
  . ;Verify that + of site number matches local site number
"RTN","YSCLSERV",47,0)
  . I XMRG'?2U5N1","9N1","1U S YSCLER=" is in error and was not added at " D OUT Q
"RTN","YSCLSERV",48,0)
  . I $P(XMRG,",")'?2U5N S YSCLER=" is not a valid Clozapine number " D OUT Q
"RTN","YSCLSERV",49,0)
  . I $P(XMRG,",",2)'?9N S YSCLER=" An SSN must be 9 numbers " D OUT Q
"RTN","YSCLSERV",50,0)
  . I $P(XMRG,",",3)'="B",$P(XMRG,",",3)'="W",$P(XMRG,",",3)'="M" S YSCLER=" You must specify Weekly, Biweekly, or Monthly " D OUT Q
"RTN","YSCLSERV",51,0)
  . ;Validate the format of the data in the message and report the error.
"RTN","YSCLSERV",52,0)
  . S DIC="^DPT(",DIC(0)="X",D="SSN",X=$P(XMRG,",",2) I '$D(^DPT("SSN",X)) S YSCLER=" SSN does not exist at " D OUT Q
"RTN","YSCLSERV",53,0)
  . ;Do not add data for records where the SSN sent is not in the local database
"RTN","YSCLSERV",54,0)
  . I $D(^YSCL(603.01,"B",$P(XMRG,","))) S YSCLX=$O(^YSCL(603.01,"B",$P(XMRG,","),"")) S:YSCLX]"" YSCLX=$P(^YSCL(603.01,YSCLX,0),"^",2),YSCLER=" Clozapine # is in use by "_$P($G(^DPT(YSCLX,0)),"^")_" at " D OUT Q
"RTN","YSCLSERV",55,0)
  . D MIX^DIC1 S YSCLPT=+Y I Y=-1 S YSCLER=" could not be added at " D OUT Q
"RTN","YSCLSERV",56,0)
  . ;Add the data and report any errors to the Roll-Up group at Forum.
"RTN","YSCLSERV",57,0)
  . K DD S DIC="^YSCL(603.01,",X=$P(XMRG,","),DIC("DR")="1////"_YSCLPT_";2////"_$P(XMRG,",",3) K DO D FILE^DICN
"RTN","YSCLSERV",58,0)
  . S YSCLX=$O(^YSCL(603.01,"B",$P(XMRG,","),"")) S:YSCLX]"" YSCLX=$P(^YSCL(603.01,YSCLX,0),"^",2),YSCLER=" assigned to "_$P($G(^DPT(YSCLX,0)),"^")_" at " D OUT
"RTN","YSCLSERV",59,0)
EXIT ;If all went well, report that too.
"RTN","YSCLSERV",60,0)
 S YSDEBUG=$P(^YSCL(603.03,1,0),"^",3)
"RTN","YSCLSERV",61,0)
 S %H=$H D YMD^%DTC S XMDUN="NCCC LOGGER",XMDUZ=".5",XMSUB=$S(YSDEBUG:"DEBUG ",YSCLSUB["DEBUG":"DEBUG ",1:"")_YSCLST_" NCCC ENROLLER ("_X_%_")",XMTEXT="^TMP($J,""YSCLDATA"","
"RTN","YSCLSERV",62,0)
 K XMY S XMY("G.CLOZAPINE ROLL-UP@FORUM.VA.GOV")=""
"RTN","YSCLSERV",63,0)
 I YSDEBUG!(YSCLSUB["DEBUG") S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLSERV",64,0)
 D ^XMD
"RTN","YSCLSERV",65,0)
 ;Mail the errors and successes back to the Roll-Up group at Forum.
"RTN","YSCLSERV",66,0)
 K ^TMP($J,"YSCLDATA")
"RTN","YSCLSERV",67,0)
 K %,%DT,%H,D,DA,DD,DIC,DIE,DIK,RET,X,XMDUN,XMDUZ,XMER,XMFROM
"RTN","YSCLSERV",68,0)
 K XMREC,XMRG,XMSUB,XMTEXT,XMY,XMZ,XQDATE,XQSUB,Y,YSA,YSACTION
"RTN","YSCLSERV",69,0)
 K YSCL28,YSCLA,YSCLAA,YSCLB,YSCLC,YSCLDA,YSCLDA1,YSCLDATA,YSCLDEA1
"RTN","YSCLSERV",70,0)
 K YSCLDFN,YSCLDM,YSCLDOC,YSCLDOM,YSCLDR,YSCLDRA,YSCLDRB,YSCLDTA
"RTN","YSCLSERV",71,0)
 K YSCLDUZ,YSCLED,YSCLER,YSCLFDA,YSCLFRQ,YSCLLNT,YSCLNM,YSCLOVR
"RTN","YSCLSERV",72,0)
 K YSCLPT,YSCLSD1,YSCLSDT,YSCLSSN,YSCLST,YSCLSTN,YSCLSUB,YSCLTC
"RTN","YSCLSERV",73,0)
 K YSCLWB,YSCLX,YSCLYN,YSDEBUG,YSI,YSOFF,YSPR,ZTQUEUED,ZTSK
"RTN","YSCLSERV",74,0)
 Q
"RTN","YSCLSERV",75,0)
DELETE ;Allow the NCCC users to delete clozapine registration at the individual sites
"RTN","YSCLSERV",76,0)
 S YSCLLNT=1 F  X XMREC Q:XMER<0  S XMRG=$TR(XMRG,"- ","") D
"RTN","YSCLSERV",77,0)
  . I XMRG="**++**DELETEALL**++**" D DELALL Q
"RTN","YSCLSERV",78,0)
  . I '$D(^YSCL(603.01,"B",$P(XMRG,","))) S YSCLER=" "_$P(XMRG,",")_" is not registered at " D OUT Q
"RTN","YSCLSERV",79,0)
  . S YSCLDFN=$O(^DPT("SSN",$P(XMRG,",",2),"")) I YSCLDFN="" S YSCLER=" "_$P(XMRG,",")_" is not a valid SSN at " D OUT Q
"RTN","YSCLSERV",80,0)
  . I '$D(^YSCL(603.01,"C",YSCLDFN)) S YSCLER=" "_$P(XMRG,",",2)_" is not registered at " D OUT Q
"RTN","YSCLSERV",81,0)
  . S YSCLA=$O(^YSCL(603.01,"B",$P(XMRG,","),"")) I YSCLA="" S YSCLER=" "_$P(XMRG,",")_" is not a valid entry at " D OUT Q
"RTN","YSCLSERV",82,0)
  . K ^YSCL(603.01,YSCLA),^YSCL(603.01,"B",$P(XMRG,","),YSCLA),^YSCL(603.01,"C",YSCLDFN,YSCLA)
"RTN","YSCLSERV",83,0)
  . S YSCLER=" removed at " D OUT
"RTN","YSCLSERV",84,0)
  . ;I $D(^YSCL(603.01,"C",+Y)) K ^YSCL(603.01,YSCLA),^YSCL(603.01,"B",$P(XMRG,","),YSCLA),^YSCL(603.01,"C",YSCLDFN,YSCLA) S YSCLER=" removed at " D OUT Q  ;RLM 9-29-99 ADDED QUIT
"RTN","YSCLSERV",85,0)
 G EXIT
"RTN","YSCLSERV",86,0)
DELALL ;Delete all patients in file 603.01
"RTN","YSCLSERV",87,0)
 S YSCLA=0 F  S YSCLA=$O(^YSCL(603.01,YSCLA)) Q:YSCLA=""  D
"RTN","YSCLSERV",88,0)
  . I YSCLA S YSCLER=$P(^YSCL(603.01,YSCLA,0),"^",1)_", "_$P(^DPT($P(^YSCL(603.01,YSCLA,0),"^",2),0),"^",9)_", ("_$P(^YSCL(603.01,YSCLA,0),"^",3)_") gdeleted at " D OUT
"RTN","YSCLSERV",89,0)
  . K ^YSCL(603.01,YSCLA)
"RTN","YSCLSERV",90,0)
 Q
"RTN","YSCLSERV",91,0)
REPORT ;send report of current registrations to the Clozapine group on Forum
"RTN","YSCLSERV",92,0)
 D REPORT^YSCLSRV2 G EXIT
"RTN","YSCLSERV",93,0)
OUT S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)=XMRG_YSCLER_YSCLST Q
"RTN","YSCLSERV",94,0)
 ;Build the text for the return message here.
"RTN","YSCLSERV",95,0)
REBUILD ;
"RTN","YSCLSERV",96,0)
 D REBUILD^YSCLSRV2 G EXIT
"RTN","YSCLSERV",97,0)
UPDATE ;Update record with Monthly, Weekly or Bi-weekly status
"RTN","YSCLSERV",98,0)
 F  X XMREC Q:XMER<0  S XMRG=$TR(XMRG,"- ","") D
"RTN","YSCLSERV",99,0)
  . I XMRG'?2U5N1","9N1","1U S YSCLER=" is in error and was not added at " D OUT Q
"RTN","YSCLSERV",100,0)
  . I $P(XMRG,",")'?2U5N S YSCLER=" is not a valid Clozapine number format " D OUT Q
"RTN","YSCLSERV",101,0)
  . I $P(XMRG,",",2)'?9N S YSCLER=" An SSN must be 9 numbers " D OUT Q
"RTN","YSCLSERV",102,0)
  . I $P(XMRG,",",3)'="B",$P(XMRG,",",3)'="W",$P(XMRG,",",3)'="M" S YSCLER=" You must specify Monthly, Weekly or Biweekly " D OUT Q  ;RLM 06/15/05
"RTN","YSCLSERV",103,0)
  . S YSCLNM=$P(XMRG,","),YSCLSSN=$P(XMRG,",",2),YSCLWB=$P(XMRG,",",3)
"RTN","YSCLSERV",104,0)
  . I '$D(^YSCL(603.01,"B",YSCLNM)) S YSCLER=" does not exist at " D OUT Q
"RTN","YSCLSERV",105,0)
  . S YSCLDA=$O(^DPT("SSN",YSCLSSN,0))
"RTN","YSCLSERV",106,0)
  . I YSCLDA="" S YSCLER=" SSN does not exist at " D OUT Q
"RTN","YSCLSERV",107,0)
  . I $O(^YSCL(603.01,"B",YSCLNM,0))="" S YSCLER=" SSN not in Clozapine file " D OUT Q
"RTN","YSCLSERV",108,0)
  . I $O(^DPT("SSN",YSCLSSN,YSCLDA)) S YSCLER=" SSN has more than one owner " D OUT Q
"RTN","YSCLSERV",109,0)
  . I $O(^YSCL(603.01,"B",YSCLNM,0))'=$O(^YSCL(603.01,"C",YSCLDA,0)) S YSCLER=" SSN ("_YSCLSSN_","_$P(^DPT(YSCLDA,0),"^")_") has multiple Clozapine Numbers at " D OUT
"RTN","YSCLSERV",110,0)
  . I $O(^YSCL(603.01,"B",YSCLNM,0))=$O(^YSCL(603.01,"C",YSCLDA,0)) D
"RTN","YSCLSERV",111,0)
  . . S YSCLDA1=$O(^YSCL(603.01,"B",YSCLNM,0)) S $P(^YSCL(603.01,YSCLDA1,0),"^",3)=YSCLWB
"RTN","YSCLSERV",112,0)
  . . S YSCLER=" "_YSCLNM_" ("_$P(^DPT(YSCLDA,0),"^")_") updated to "_$S(YSCLWB="M":"Monthly",YSCLWB="W":"Weekly",YSCLWB="B":"Bi-weekly",1:"Unknown")_" at " D OUT ;06/15/05
"RTN","YSCLSERV",113,0)
 G EXIT
"RTN","YSCLSERV",114,0)
RESEND ;Trigger retransmission of Clozapine data
"RTN","YSCLSERV",115,0)
 X XMREC
"RTN","YSCLSERV",116,0)
 K %DT S X=XMRG,%DT="P" D ^%DT I Y=-1 S YSCLER=" is an invalid date, RESEND not triggered at " D OUT G EXIT
"RTN","YSCLSERV",117,0)
 S YSCLED=Y,(YSCLSDT,X)=Y D H^%DTC I %H#7'=5 S YSCLER=" is not a Tuesday, RESEND not triggered at " D OUT G EXIT
"RTN","YSCLSERV",118,0)
 D SERV^YSCLTST2
"RTN","YSCLSERV",119,0)
 S Y=YSCLSDT X ^DD("DD") S YSCLER=" - Resend triggered (local task #"_$G(ZTSK)_") by "_XMFROM_" for "_Y_" at " D OUT
"RTN","YSCLSERV",120,0)
 G EXIT
"RTN","YSCLSERV",121,0)
DSET ;Set the day of the week for the roll-up to run.
"RTN","YSCLSERV",122,0)
 X XMREC Q:XMER<0  S X=$TR(XMRG,"- ","")
"RTN","YSCLSERV",123,0)
 S YSOFF=$S(X="SUNDAY":0,X="MONDAY":1,X="TUESDAY":2,X="WEDNESDAY":3,X="THURSDAY":4,X="FRIDAY":5,X="SATURDAY":6,1:7)
"RTN","YSCLSERV",124,0)
 I YSOFF>6 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)=X_" isn't a valid day of the week." G EXIT
"RTN","YSCLSERV",125,0)
 S $P(^YSCL(603.03,1,0),"^",2)=X
"RTN","YSCLSERV",126,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Run day set to "_X
"RTN","YSCLSERV",127,0)
 G EXIT
"RTN","YSCLSERV",128,0)
 Q
"RTN","YSCLSERV",129,0)
DEBUG ;Turn debug mode on and off.
"RTN","YSCLSERV",130,0)
 I YSCLSUB["DEBUG ON" D
"RTN","YSCLSERV",131,0)
  . S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Debug Mode is "_$S(YSDEBUG:"already",1:"now")_" ON at "_YSCLSTN
"RTN","YSCLSERV",132,0)
  . S $P(^YSCL(603.03,1,0),"^",3)=1
"RTN","YSCLSERV",133,0)
 I YSCLSUB["DEBUG OFF" D
"RTN","YSCLSERV",134,0)
  . S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Debug Mode is "_$S('YSDEBUG:"already",1:"now")_" OFF at "_YSCLSTN
"RTN","YSCLSERV",135,0)
  . S $P(^YSCL(603.03,1,0),"^",3)=0
"RTN","YSCLSERV",136,0)
 G EXIT
"RTN","YSCLSERV",137,0)
ZEOR ;YSCLSERV
"RTN","YSCLSRV1")
0^10^B2228786^B2175459
"RTN","YSCLSRV1",1,0)
YSCLSRV1 ;DALOI/RLM-Clozapine data server ;24 APR 1990
"RTN","YSCLSRV1",2,0)
 ;;5.01;MENTAL HEALTH;**61,69,74,90**;Dec 30, 1994;Build 18
"RTN","YSCLSRV1",3,0)
 ; Reference to ^%ZOSF supported by IA #10096
"RTN","YSCLSRV1",4,0)
 ; Reference to ^XMD supported by IA #10070
"RTN","YSCLSRV1",5,0)
CSUM ;Calculate checksum for routines and transmit errors to Forum
"RTN","YSCLSRV1",6,0)
 S X=$T(+0) X ^%ZOSF("RSUM") S ^TMP("YSCL",$J,2,0)="YSCLSRV1 at "_YSCLST_" = "_Y
"RTN","YSCLSRV1",7,0)
 F YSI=1:1 S YSA=$T(ROU+YSI) Q:YSA["***"  S X=$P($P(YSA,","),";",3) D
"RTN","YSCLSRV1",8,0)
  . X ^%ZOSF("TEST") I '$T S ^TMP("YSCL",$J,YSI+3,0)=X_" is missing." Q
"RTN","YSCLSRV1",9,0)
  . X ^%ZOSF("RSUM") S ^TMP("YSCL",$J,YSI+3,0)=X_" should be "_$P(YSA,",",2)_" is "_Y
"RTN","YSCLSRV1",10,0)
 K XMY S XMY("G.CLOZAPINE ROLL-UP@FORUM.VA.GOV")=""
"RTN","YSCLSRV1",11,0)
 I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLSRV1",12,0)
 S XMSUB=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine Checksum data at "_YSCLST_" run on "_XQDATE
"RTN","YSCLSRV1",13,0)
 S XMTEXT="^TMP(""YSCL"",$J,",XMDUZ="CLOZAPINE MONITOR" D ^XMD
"RTN","YSCLSRV1",14,0)
 K %DT,YSA,YSCLST,YSI,X,XMDUZ,XMSUB,XMTEXT,Y
"RTN","YSCLSRV1",15,0)
 K ^TMP("YSCL",$J)
"RTN","YSCLSRV1",16,0)
 Q
"RTN","YSCLSRV1",17,0)
ROU ;
"RTN","YSCLSRV1",18,0)
 ;;YSCLSERV,25564583
"RTN","YSCLSRV1",19,0)
 ;;YSCLSRV2,24723007
"RTN","YSCLSRV1",20,0)
 ;;YSCLSRV3,24872037
"RTN","YSCLSRV1",21,0)
 ;;YSCLTEST,12378003
"RTN","YSCLSRV1",22,0)
 ;;YSCLTST1,11839450
"RTN","YSCLSRV1",23,0)
 ;;YSCLTST2,32098862
"RTN","YSCLSRV1",24,0)
 ;;YSCLTST3,25645207
"RTN","YSCLSRV1",25,0)
 ;;***
"RTN","YSCLSRV1",26,0)
ZEOR ;YSCLSRV1
"RTN","YSCLSRV2")
0^7^B45550399^B26824513
"RTN","YSCLSRV2",1,0)
YSCLSRV2 ;DALOI/RLM-Clozapine data server ;APR 24,1990@15:26
"RTN","YSCLSRV2",2,0)
 ;;5.01;MENTAL HEALTH;**69,90**;Dec 30, 1994;Build 18
"RTN","YSCLSRV2",3,0)
 ; Reference to ^%ZOSF supported by IA #10096
"RTN","YSCLSRV2",4,0)
 ; Reference to ^DPT supported by IA #10035
"RTN","YSCLSRV2",5,0)
 ; Reference to ^DD("DD" supported by IA #10017
"RTN","YSCLSRV2",6,0)
 ; Reference to ^PS(55 supported by IA #787
"RTN","YSCLSRV2",7,0)
 ; Reference to ^PSDRUG supported by IA #25
"RTN","YSCLSRV2",8,0)
 ; Reference to ^PSRX supported by IA #780
"RTN","YSCLSRV2",9,0)
 ; Reference to ^VA(200 supported by IA #10060
"RTN","YSCLSRV2",10,0)
 ; Reference to $$SITE^VASITE supported by IA #10112
"RTN","YSCLSRV2",11,0)
 ; Reference to $$FMTE^XLFDT() supported by IA #10103
"RTN","YSCLSRV2",12,0)
 ; Reference to ^PSDRUG supported by IA #221
"RTN","YSCLSRV2",13,0)
 ; Reference to ^LAB(60 supported by IA #333
"RTN","YSCLSRV2",14,0)
 ; 
"RTN","YSCLSRV2",15,0)
REPORT ;send report of current registrations to the Clozapine group on Forum
"RTN","YSCLSRV2",16,0)
 S XMRG="",YSCLA=0 F  S YSCLA=$O(^YSCL(603.01,YSCLA)) Q:'YSCLA  S YSCLDTA=$G(^YSCL(603.01,YSCLA,0)) D
"RTN","YSCLSRV2",17,0)
  . I YSCLDTA="" S YSCLER="Clozapine Patient List damaged at " D OUT Q
"RTN","YSCLSRV2",18,0)
  . S YSCLWB=$P(YSCLDTA,"^",3),YSCLWB=$S(YSCLWB="M":"Monthly",YSCLWB="W":"Weekly",YSCLWB="B":"Bi-weekly",1:"Unknown")
"RTN","YSCLSRV2",19,0)
  . S YSCLER=$P(YSCLDTA,"^")_" is assigned to "_$P($G(^DPT($P(YSCLDTA,"^",2),0)),"^")_" ("_$P($G(^DPT($P(YSCLDTA,"^",2),0)),"^",9)_") "_YSCLWB_" at " D OUT
"RTN","YSCLSRV2",20,0)
 I YSCLSUB["+" S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="====" S YSCLA=0 F  S YSCLA=$O(^PS(55,"ASAND",YSCLA)) Q:'YSCLA  S YSCLER="" D  D:YSCLER]"" OUT ;Transmit the most recent for each patient.
"RTN","YSCLSRV2",21,0)
  . S YSCLDFN=$P(^PS(55,YSCLA,0),"^") ;Find out who we're reporting on
"RTN","YSCLSRV2",22,0)
  . S YSCLNM=$P(^DPT(YSCLDFN,0),"^") ;Get the patients name
"RTN","YSCLSRV2",23,0)
  . S YSCLSD1=YSCLNM_"^"_^PS(55,YSCLA,"SAND") ;Add name to data
"RTN","YSCLSRV2",24,0)
  . S YSCLZZ=YSCLA,$P(YSCLSD1,"^",4)=$P($$CL^YSCLTST2(YSCLDFN),"^",2),YSCLA=YSCLZZ
"RTN","YSCLSRV2",25,0)
  . S YSCLDOC=$P(YSCLSD1,"^",6) I YSCLDOC K DIERR,YSCL200 D FIND^DIC(200,,".01","X","`"_YSCLDOC,,,,,"YSCL200","YERROR") S $P(YSCLSD1,"^",6)=$G(YSCL200("DILIST",1,1))
"RTN","YSCLSRV2",26,0)
  . ;S YSCLDOC=$P(YSCLSD1,"^",6) I YSCLDOC S $P(YSCLSD1,"^",6)=$P($G(^VA(200,YSCLDOC,0)),"^") ;OLD CODE
"RTN","YSCLSRV2",27,0)
  . S $P(YSCLSD1,"^",7)=$P(YSCLSD1,"^",7) ;Pad it to 7 ^-pieces
"RTN","YSCLSRV2",28,0)
  . S YSCLB=0 F  S YSCLB=$O(^PS(55,YSCLA,"P",YSCLB)) Q:'YSCLB  I $D(^PSRX(^PS(55,YSCLA,"P",YSCLB,0),"SAND")) D  ;D OUT ;This will transmit them all
"RTN","YSCLSRV2",29,0)
  . . S YSCLER=YSCLSD1_"^"_$G(^PSRX(^PS(55,YSCLA,"P",YSCLB,0),"SAND"))_"^"
"RTN","YSCLSRV2",30,0)
  . . S Y=$P(YSCLER,"^",7) I Y]"" X ^DD("DD") S $P(YSCLER,"^",7)=Y
"RTN","YSCLSRV2",31,0)
  . . S Y=$P(YSCLER,"^",10) I Y]"" X ^DD("DD") S $P(YSCLER,"^",10)=Y
"RTN","YSCLSRV2",32,0)
  . ;D OUT
"RTN","YSCLSRV2",33,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="  Linked Tests:"
"RTN","YSCLSRV2",34,0)
 S YSCLA=0 F  S YSCLA=$O(^YSCL(603.04,1,1,YSCLA)) Q:'YSCLA  D
"RTN","YSCLSRV2",35,0)
  . S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)=$P(^LAB(60,$P(^YSCL(603.04,1,1,YSCLA,0),"^",1),0),"^")
"RTN","YSCLSRV2",36,0)
  . S YSCLTYPE=$P(^YSCL(603.04,1,1,YSCLA,0),"^",2),YSCLRPT=$P(^YSCL(603.04,1,1,YSCLA,0),"^",3)
"RTN","YSCLSRV2",37,0)
  . S YSCLTA="  reports  "_$S(YSCLTYPE="W":"WHITE BLOOD COUNT",YSCLTYPE="A":"ABSOLUTE NEUTROPHIL COUNT",YSCLTYPE="N":"NEUTROPHIL PERCENT",YSCLTYPE="S":"SEGS %",YSCLTYPE="B":"BANDS %",YSCLTYPE="T":"BANDS A",YSCLTYPE="C":"SEGS A")
"RTN","YSCLSRV2",38,0)
  . S ^TMP($J,"YSCLDATA",YSCLLNT)=^TMP($J,"YSCLDATA",YSCLLNT)_YSCLTA_"  "_$S(YSCLRPT:"K/units",1:"units")
"RTN","YSCLSRV2",39,0)
 ;Old method
"RTN","YSCLSRV2",40,0)
 ;S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="  Linked Tests:"
"RTN","YSCLSRV2",41,0)
 ;S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="WBC = "_$$GET1^DIQ(603.02,1,.01)_", Neut% = "_$$GET1^DIQ(603.02,1,1)
"RTN","YSCLSRV2",42,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="  Monitored Drug - Monitor Routine - NDC - Lab Test"
"RTN","YSCLSRV2",43,0)
 S YSPR=0 F  S YSPR=$O(^PSDRUG(YSPR)) Q:'YSPR  I $P($G(^PSDRUG(YSPR,"CLOZ1")),"^")]"" D
"RTN","YSCLSRV2",44,0)
  . S YSCLTC=$P($G(^PSDRUG(YSPR,"CLOZ")),"^") I YSCLTC S YSCLTC=$$GET1^DIQ(60,YSCLTC,.01)
"RTN","YSCLSRV2",45,0)
  . S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)=$P($G(^PSDRUG(YSPR,0)),"^")_" - "_$P(^PSDRUG(YSPR,"CLOZ1"),"^")_" - "_$P($G(^PSDRUG(YSPR,2)),"^",4)_" - "_YSCLTC
"RTN","YSCLSRV2",46,0)
 S YSCLDR=0 F  S YSCLDR=$O(^PSDRUG(YSCLDR)) Q:'YSCLDR  I $D(^PSDRUG(YSCLDR,"CLOZ2")) D
"RTN","YSCLSRV2",47,0)
  . S YSCLDRA=0 F  S YSCLDRA=$O(^PSDRUG(YSCLDR,"CLOZ2",YSCLDRA)) Q:'YSCLDRA  D
"RTN","YSCLSRV2",48,0)
  . . S YSCLDRB=^PSDRUG(YSCLDR,"CLOZ2",YSCLDRA,0)
"RTN","YSCLSRV2",49,0)
  . . S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)=$P(^PSDRUG(YSCLDR,0),"^")_" uses "_$P(^LAB(60,$P(YSCLDRB,"^"),0),"^")_" to indicate "_$S($P(YSCLDRB,"^",4)=1:"White Blood Count",1:"Neutrophil Count")
"RTN","YSCLSRV2",50,0)
 ;D OPTION^%ZTLOAD("YSCL WEEKLY TRANSMISSION","LIST") D
"RTN","YSCLSRV2",51,0)
 ; . S ZTSK="" F  S ZTSK=$O(LIST(ZTSK)) Q:ZTSK=""  D
"RTN","YSCLSRV2",52,0)
 ; . . D STAT^%ZTLOAD S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Local Task # "_ZTSK_" is "_$S('ZTSK(0):" not ",1:"")_"defined with a status of "_ZTSK(2)
"RTN","YSCLSRV2",53,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="              Run day is: "_$P(^YSCL(603.03,1,0),"^",2)
"RTN","YSCLSRV2",54,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="           Debug Mode is: "_$S($P(^YSCL(603.03,1,0),"^",3):"On.",1:"Off.")
"RTN","YSCLSRV2",55,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Last Run Date (start) is: "_$$FMTE^XLFDT($P(^YSCL(603.03,1,0),"^",4))
"RTN","YSCLSRV2",56,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)=" Last Run Date (stop) is: "_$$FMTE^XLFDT($P(^YSCL(603.03,1,0),"^",5))
"RTN","YSCLSRV2",57,0)
 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Last Demographic date is: "_$$FMTE^XLFDT($P(^YSCL(603.03,1,0),"^",6))
"RTN","YSCLSRV2",58,0)
 Q
"RTN","YSCLSRV2",59,0)
OUT S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)=XMRG_YSCLER_YSCLST Q
"RTN","YSCLSRV2",60,0)
 ;Build the text for the return message here.
"RTN","YSCLSRV2",61,0)
REBUILD ;
"RTN","YSCLSRV2",62,0)
 S XMRG="",(YSCLA,YSCLLNT)=1 F  S YSCLA=$O(^PS(55,"ASAND1",YSCLA)) W:'$D(ZTQUEUED) "." Q:YSCLA=""  D
"RTN","YSCLSRV2",63,0)
  . S YSCLB=$O(^PS(55,"ASAND1",YSCLA,"")) I YSCLB="" S YSCLER=" record is in error (1) at " D OUT Q
"RTN","YSCLSRV2",64,0)
  . I '$D(^PS(55,YSCLB,0)) S YSCLER=" record is in error (2) at " D OUT Q
"RTN","YSCLSRV2",65,0)
  . S YSCLB=$P(^PS(55,YSCLB,0),"^") I YSCLB="" S YSCLER=" record is in error (3) at " D OUT Q
"RTN","YSCLSRV2",66,0)
  . I '$D(^PS(55,YSCLB,"SAND")) S YSCLER=" record is in error (4) at " D OUT Q
"RTN","YSCLSRV2",67,0)
  . S DIC="^DPT(",DIC(0)="X",D="SSN",(YSCLSSN,X)=$P(^DPT(YSCLB,0),"^",9)
"RTN","YSCLSRV2",68,0)
  . I $D(^YSCL(603.01,"B",YSCLA)) S YSCLX=$O(^YSCL(603.01,"B",YSCLA,"")) S:YSCLX]"" YSCLX=$P(^YSCL(603.01,YSCLX,0),"^",2),YSCLER=" Clozapine # "_YSCLA_" is in use by "_$P($G(^DPT(YSCLX,0)),"^")_" at " D OUT Q
"RTN","YSCLSRV2",69,0)
  . D MIX^DIC1 S YSCLPT=+Y I Y=-1 S YSCLER=" could not be added at " D OUT Q
"RTN","YSCLSRV2",70,0)
  . K DD S DIC="^YSCL(603.01,",X=YSCLA,DIC("DR")="1////"_YSCLPT K DO D FILE^DICN
"RTN","YSCLSRV2",71,0)
  . S YSCLX=$O(^YSCL(603.01,"B",YSCLA,"")) S:YSCLX]"" YSCLX=$P(^YSCL(603.01,YSCLX,0),"^",2),YSCLER=","_YSCLSSN_" assigned to "_$P($G(^DPT(YSCLX,0)),"^")_" at " D OUT
"RTN","YSCLSRV2",72,0)
 Q
"RTN","YSCLSRV2",73,0)
OVRRID ;Update record with Monthly, Weekly or Bi-weekly status
"RTN","YSCLSRV2",74,0)
 F  X XMREC Q:XMER<0  S XMRG=$TR(XMRG,"- ","") D
"RTN","YSCLSRV2",75,0)
  . I XMRG'?2U5N1","9N1",".E S YSCLER=" is in error and was not added at " D OUT Q
"RTN","YSCLSRV2",76,0)
  . I $P(XMRG,",")'?2U5N S YSCLER=" is not a valid Clozapine number format " D OUT Q
"RTN","YSCLSRV2",77,0)
  . I $P(XMRG,",",2)'?9N S YSCLER=" An SSN must be 9 numbers " D OUT Q
"RTN","YSCLSRV2",78,0)
  . K %DT S X=$P(XMRG,",",3),%DT="F" D ^%DT I Y=-1 S YSCLER=" is an invalid date, over-ride authorization not filed at " D OUT Q
"RTN","YSCLSRV2",79,0)
  . S YSCLOVR=Y
"RTN","YSCLSRV2",80,0)
  . S YSCLNM=$P(XMRG,","),YSCLSSN=$P(XMRG,",",2),YSCLWB=$P(XMRG,",",3)
"RTN","YSCLSRV2",81,0)
  . I '$D(^YSCL(603.01,"B",YSCLNM)) S YSCLER=" does not exist at " D OUT Q
"RTN","YSCLSRV2",82,0)
  . S YSCLDA=$O(^DPT("SSN",YSCLSSN,0))
"RTN","YSCLSRV2",83,0)
  . I YSCLDA="" S YSCLER=" SSN does not exist at " D OUT Q
"RTN","YSCLSRV2",84,0)
  . I $O(^YSCL(603.01,"B",YSCLNM,0))="" S YSCLER=" SSN not in Clozapine file " D OUT Q
"RTN","YSCLSRV2",85,0)
  . I $O(^DPT("SSN",YSCLSSN,YSCLDA)) S YSCLER=" SSN has more than one owner " D OUT Q
"RTN","YSCLSRV2",86,0)
  . I $O(^YSCL(603.01,"B",YSCLNM,0))'=$O(^YSCL(603.01,"C",YSCLDA,0)) S YSCLER=" SSN ("_YSCLSSN_","_$P(^DPT(YSCLDA,0),"^")_") has multiple Clozapine Numbers at " D OUT
"RTN","YSCLSRV2",87,0)
  . I $O(^YSCL(603.01,"B",YSCLNM,0))=$O(^YSCL(603.01,"C",YSCLDA,0)) D
"RTN","YSCLSRV2",88,0)
  . . S YSCLDA1=$O(^YSCL(603.01,"B",YSCLNM,0)) S $P(^YSCL(603.01,YSCLDA1,0),"^",4)=YSCLOVR
"RTN","YSCLSRV2",89,0)
  . . S Y=YSCLOVR D DD^%DT S YSCLER=" "_YSCLNM_" ("_$P(^DPT(YSCLDA,0),"^")_") authorized for over-ride on "_Y_" at " D OUT
"RTN","YSCLSRV2",90,0)
 G EXIT^YSCLSERV
"RTN","YSCLSRV2",91,0)
ZEOR ;YSCLSRV2
"RTN","YSCLSRV3")
0^4^B46877449^B8766560
"RTN","YSCLSRV3",1,0)
YSCLSRV3 ;DALOI/RLM-Clozapine data server ;24 APR 1990
"RTN","YSCLSRV3",2,0)
 ;;5.01;MENTAL HEALTH;**74,90**;Dec 30, 1994;Build 18
"RTN","YSCLSRV3",3,0)
 ; Reference to ^%ZOSF supported by IA #10096
"RTN","YSCLSRV3",4,0)
 ; Reference to ^DPT supported by IA #10035
"RTN","YSCLSRV3",5,0)
 ; Reference to ^PS(55 supported by IA #787
"RTN","YSCLSRV3",6,0)
 ; Reference to ^PSDRUG supported by IA #25
"RTN","YSCLSRV3",7,0)
 ; Reference to ^PSRX supported by IA #780
"RTN","YSCLSRV3",8,0)
 ; Reference to ^VA(200 supported by IA #10060
"RTN","YSCLSRV3",9,0)
 ; Reference to ^XUSEC supported by IA #10076
"RTN","YSCLSRV3",10,0)
 ;
"RTN","YSCLSRV3",11,0)
 S ^TMP($J,"YSCLDATA",1)="This routine will print a list of all active Clozapine prescriptions."
"RTN","YSCLSRV3",12,0)
 S ^TMP($J,"YSCLDATA",2)="An asterisk in the first column indicates that the prescription is over"
"RTN","YSCLSRV3",13,0)
 S ^TMP($J,"YSCLDATA",3)="28 days old.  The second column is the Patient Name.  The third is the"
"RTN","YSCLSRV3",14,0)
 S ^TMP($J,"YSCLDATA",4)="Issue Date.  The fourth column is the Prescription Number. The final"
"RTN","YSCLSRV3",15,0)
 S ^TMP($J,"YSCLDATA",5)="column is the CLOZAPINE STATUS indicator."
"RTN","YSCLSRV3",16,0)
 S X1=DT,X2=-28 D C^%DTC S YSCL28=X
"RTN","YSCLSRV3",17,0)
 S DFN=0,YSCLLN=6
"RTN","YSCLSRV3",18,0)
 F  K YSCLA S DFN=$O(^PS(55,"ASAND",DFN)),YSCLLD=0 Q:'DFN  I $D(^DPT(DFN,0)),$D(^PS(55,DFN,"SAND")) S YSCLSAND=^("SAND"),YSCL=^DPT(DFN,0),YSCLX=$E($P($P(YSCL,"^"),",",2))_$E(YSCL)_"^"_$P(YSCL,"^",9) D
"RTN","YSCLSRV3",19,0)
  . F YSCL=0:0 S YSCL=$O(^PS(55,DFN,"P",YSCL)) Q:'YSCL  I $D(^(YSCL,0)) S YSCL1=^(0) I $D(^PSRX(YSCL1,0)) D ACTIVE I 'YSACT S YSCLRX=^PSRX(YSCL1,0) I $P($G(^PSDRUG(+$P(YSCLRX,"^",6),"CLOZ1")),"^")="PSOCLO1",$D(^("CLOZ")) S YSCLLAB=^("CLOZ") D
"RTN","YSCLSRV3",20,0)
  . . ;W !,DFN," - ",YSCL1
"RTN","YSCLSRV3",21,0)
  . . S ^TMP($J,"YSCLDATA",YSCLLN)=$S(YSCL28>$P(YSCLRX,"^",13):"*",1:" ")_"^"_$P(^DPT($P(YSCLRX,"^",2),0),"^")_"^"_$$FMTE^XLFDT($P(YSCLRX,"^",13))_"^"_$P(YSCLRX,"^")_"^"_$P(YSCLSAND,"^",2)
"RTN","YSCLSRV3",22,0)
  . . S YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",23,0)
 G EXIT^YSCLSERV
"RTN","YSCLSRV3",24,0)
 Q
"RTN","YSCLSRV3",25,0)
ACTIVE ;
"RTN","YSCLSRV3",26,0)
 S YSACT=$$GET1^DIQ(52,YSCL1_",",100,"I","ERR")
"RTN","YSCLSRV3",27,0)
 Q
"RTN","YSCLSRV3",28,0)
DEMOG ;
"RTN","YSCLSRV3",29,0)
 S YSCLA=0 F  S YSCLA=$O(^YSCL(603.01,"C",YSCLA)) Q:'YSCLA  D
"RTN","YSCLSRV3",30,0)
  . I $D(^PS(55,YSCLA,"SAND")),$P(^PS(55,YSCLA,"SAND"),"^",4)=0 S YSCLC=$G(YSCLC)+1
"RTN","YSCLSRV3",31,0)
  . I $D(^PS(55,YSCLA,"SAND")),$P(^PS(55,YSCLA,"SAND"),"^",4) S $P(^PS(55,YSCLA,"SAND"),"^",4)=0,YSCLB=$G(YSCLB)+1
"RTN","YSCLSRV3",32,0)
 S ^TMP($J,"YSCLDATA",2)=+$G(YSCLB)_" record"_$S(+$G(YSCLB)=1:"",1:"s")_" reset at ("_YSCLST_") "_YSCLSTN
"RTN","YSCLSRV3",33,0)
 S ^TMP($J,"YSCLDATA",3)=+$G(YSCLC)_" record"_$S(+$G(YSCLC)=1:"",1:"s")_" not reset at ("_YSCLST_") "_YSCLSTN
"RTN","YSCLSRV3",34,0)
 G EXIT^YSCLSERV
"RTN","YSCLSRV3",35,0)
 Q
"RTN","YSCLSRV3",36,0)
LOCK ;Lock out ability to dispense Clozapine
"RTN","YSCLSRV3",37,0)
 X XMREC Q:XMER<0  S X=XMRG
"RTN","YSCLSRV3",38,0)
 I X="LOCK DOWN ON" S $P(^YSCL(603.03,1,1),"^",1)=1 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Clozapine dispensing prohibited at "_YSCLST
"RTN","YSCLSRV3",39,0)
 I X="LOCK DOWN OFF" S $P(^YSCL(603.03,1,1),"^",1)=0 S YSCLLNT=$G(YSCLLNT)+1,^TMP($J,"YSCLDATA",YSCLLNT)="Clozapine dispensing enabled at "_YSCLST
"RTN","YSCLSRV3",40,0)
 G EXIT^YSCLSERV
"RTN","YSCLSRV3",41,0)
 Q
"RTN","YSCLSRV3",42,0)
AUTH ;List authorized Clozapine providers
"RTN","YSCLSRV3",43,0)
 I YSCLSUB["LIST" D  G EXIT^YSCLSERV
"RTN","YSCLSRV3",44,0)
  . S ^TMP($J,"YSCLDATA",1)="The following providers are authorized to override Clozapine lockouts"
"RTN","YSCLSRV3",45,0)
  . S YSCLLN=2
"RTN","YSCLSRV3",46,0)
  . S YSCLA="" F  S YSCLA=$O(^XUSEC("PSOLOCKCLOZ",YSCLA)) Q:YSCLA=""  D
"RTN","YSCLSRV3",47,0)
  . . Q:'$D(^VA(200,YSCLA,0))
"RTN","YSCLSRV3",48,0)
  . . S ^TMP($J,"YSCLDATA",YSCLLN)=$P(^VA(200,YSCLA,0),"^",1)_"  "_$S($P(^VA(200,YSCLA,0),"^",7)=1:"Ina",1:"A")_"ctive",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",49,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",50,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",51,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",52,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="The following providers are authorized to access the Pharmacy Clozapine Manager Menu",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",53,0)
  . S YSCLA="" F  S YSCLA=$O(^XUSEC("PSZ CLOZAPINE",YSCLA)) Q:YSCLA=""  D
"RTN","YSCLSRV3",54,0)
  . . Q:'$D(^VA(200,YSCLA,0))
"RTN","YSCLSRV3",55,0)
  . . S ^TMP($J,"YSCLDATA",YSCLLN)=$P(^VA(200,YSCLA,0),"^",1)_"  "_$S($P(^VA(200,YSCLA,0),"^",7)=1:"Ina",1:"A")_"ctive",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",56,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",57,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",58,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",59,0)
  . S ^TMP($J,"YSCLDATA",YSCLLN)="The following providers are authorized to prescribe Clozapine",YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",60,0)
  . S YSCLA=0 F  S YSCLA=$O(^XUSEC("YSCL AUTHORIZED",YSCLA)) Q:'YSCLA  D  ;??? Use FileMan lookup on 200
"RTN","YSCLSRV3",61,0)
  . . S YSCLDEA=$$DEA^XUSER(1,YSCLA),YSCLYN=1,YSCLSSN=$P(^VA(200,YSCLA,1),"^",9)
"RTN","YSCLSRV3",62,0)
  . . S ^TMP($J,"YSCLDATA",YSCLLN)=$P($G(^VA(200,YSCLA,0)),"^",1)_" - "_YSCLSSN_" - "_$S(YSCLDEA="":"*NONE*",1:YSCLDEA)_" - "_$S(YSCLYN=1:"Yes",1:"NO"),YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",63,0)
 ;Holders of YSCL AUTHORIZED key
"RTN","YSCLSRV3",64,0)
 ;=============================================
"RTN","YSCLSRV3",65,0)
 ;
"RTN","YSCLSRV3",66,0)
 S YSCLLN=1,^TMP($J,"YSCLDATA",YSCLLN)="Clinician Authorization Results at "_YSCLST,YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",67,0)
 K ^TMP("DIERR",$J)
"RTN","YSCLSRV3",68,0)
 F  X XMREC Q:XMER<0  S X=XMRG X ^%ZOSF("UPPERCASE") S X=Y D
"RTN","YSCLSRV3",69,0)
  . S YSCLSSN=$P(X,"^",1),YSCLDEA=$P(X,"^",2),YSCLYN=$P(X,"^",3),YSCLDUZ="",YSCLDEA1="",YSCLIEN=""
"RTN","YSCLSRV3",70,0)
  . I YSCLLN=""!("YESNO"'[YSCLYN) S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician Authorization instructions invalid ("_YSCLYN_") at "_YSCLST,YSCLLN=YSCLLN+1
"RTN","YSCLSRV3",71,0)
  . S YSCLYN=$S(YSCLYN="YES":1,1:0)
"RTN","YSCLSRV3",72,0)
  . I '$D(^VA(200,"BS5",YSCLSSN)) S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician ("_YSCLSSN_") does not exist at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",73,0)
  . I $D(^VA(200,"BS5",YSCLSSN)) S YSCLAA="" F  S YSCLAA=$O(^VA(200,"BS5",YSCLSSN,YSCLAA)) Q:YSCLAA=""  I $$DEA^XUSER(1,YSCLAA)=YSCLDEA S YSCLDUZ=YSCLAA Q
"RTN","YSCLSRV3",74,0)
  . I YSCLDUZ="" S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician ("_YSCLSSN_") with DEA# "_YSCLDEA_" does not exist at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",75,0)
  . S YSCLDEA1=$$DEA^XUSER(1,YSCLDUZ)
"RTN","YSCLSRV3",76,0)
  . I YSCLDEA1="" S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician with DEA# "_YSCLDEA_" does not exist at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",77,0)
  . I YSCLDEA'=YSCLDEA1 W ^TMP($J,"YSCLDATA",YSCLLN)="Clinician SSN ("_YSCLSSN_") - DEA ("_YSCLDEA_") mismatch at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",78,0)
  . D OWNSKEY^XUSRB(.RET,"YSCL AUTHORIZED",YSCLDUZ)
"RTN","YSCLSRV3",79,0)
  . I RET(0),YSCLYN S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician ("_YSCLSSN_") already authorized at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",80,0)
  . I 'RET(0),'YSCLYN S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician ("_YSCLSSN_") not authorized at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",81,0)
  . I 'RET(0),YSCLYN S YSCLDUZ(0)=DUZ,DUZ(0)="@" D  S DUZ(0)=YSCLDUZ(0)
"RTN","YSCLSRV3",82,0)
  . . S YSCLFDA(200,"?1,",.01)="`"_YSCLDUZ
"RTN","YSCLSRV3",83,0)
  . . S YSCLFDA(200.051,"+2,?1,",.01)="YSCL AUTHORIZED" D UPDATE^DIE("E","YSCLFDA",,"YSCLERR")
"RTN","YSCLSRV3",84,0)
  . . I $D(YSCLERR) S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician SSN "_YSCLSSN_" authorization failed at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",85,0)
  . . I '$D(YSCLERR) S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician SSN "_YSCLSSN_" authorization set to "_$S(YSCLYN=1:"Yes",1:"No")_" at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",86,0)
  . I RET(0),'YSCLYN S YSCLDUZ(0)=DUZ,DUZ(0)="@" D  S DUZ(0)=YSCLDUZ(0)
"RTN","YSCLSRV3",87,0)
  . . S DA=$$FIND1^DIC(200.051,","_YSCLDUZ_",","A","YSCL AUTHORIZE")
"RTN","YSCLSRV3",88,0)
  . . I DA<1 S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician SSN "_YSCLSSN_" authorization removal failed at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",89,0)
  . . S DA(1)=YSCLDUZ,DIK="^VA(200,"_DA(1)_",51," D ^DIK
"RTN","YSCLSRV3",90,0)
  . . S ^TMP($J,"YSCLDATA",YSCLLN)="Clinician SSN "_YSCLSSN_" authorization removed at "_YSCLST,YSCLLN=YSCLLN+1 Q
"RTN","YSCLSRV3",91,0)
 G EXIT^YSCLSERV
"RTN","YSCLSRV3",92,0)
 Q
"RTN","YSCLSRV3",93,0)
ZEOR ;YSCLSRV3
"RTN","YSCLTEST")
0^5^B20876343^B20062931
"RTN","YSCLTEST",1,0)
YSCLTEST ;DALOI/LB/RLM-COLLECT RX AND LAB DATA FOR CLOZAPINE ;18 Feb 93
"RTN","YSCLTEST",2,0)
 ;;5.01;MENTAL HEALTH;**18,22,26,47,61,69,74,90**;Dec 30, 1994;Build 18
"RTN","YSCLTEST",3,0)
 ; Reference to ^DPT supported by IA #10035
"RTN","YSCLTEST",4,0)
 ; Reference to ^DIC(5 supported by IA #10056
"RTN","YSCLTEST",5,0)
 ; Reference to ^PS(55 supported by IA #787
"RTN","YSCLTEST",6,0)
 ; Reference to ^PSDRUG supported by IA #25
"RTN","YSCLTEST",7,0)
 ; Reference to ^PSRX supported by IA #780
"RTN","YSCLTEST",8,0)
 ; Reference to ^XMD supported by IA #10070
"RTN","YSCLTEST",9,0)
BKGRD ;Normal entry for weekly background job - dates from T-10 to T-3
"RTN","YSCLTEST",10,0)
 S X=DT D DW^%DTC Q:X'=$P(^YSCL(603.03,1,0),"^",2)  ;Make the day to run a parameter settable by the server.
"RTN","YSCLTEST",11,0)
 S YSOFF=$S(X="SUNDAY":0,X="MONDAY":1,X="TUESDAY":2,X="WEDNESDAY":3,X="THURSDAY":4,X="FRIDAY":5,X="SATURDAY":6,1:7) Q:YSOFF>6
"RTN","YSCLTEST",12,0)
 S X="T-"_YSOFF D ^%DT S YSCLED=Y,YSCLRET=""
"RTN","YSCLTEST",13,0)
 ;S YSCL=$H#7-2 S:YSCL<1 YSCL=YSCL+7 S X="T-"_(YSCL+7) D ^%DT S YSCLED=Y,YSCLRET="" K YSCL ;Make sure it's a Sunday ending date.
"RTN","YSCLTEST",14,0)
RUN ; entry from above for normal or below for requeue
"RTN","YSCLTEST",15,0)
 S YSDEBUG=$P(^YSCL(603.03,1,0),"^",3)
"RTN","YSCLTEST",16,0)
 ;I $G(^YSCL(603.02,1,0))'?1.N1"^"1.N G FLERR^YSCLTST3 ;Check for entry in file 603.02, report an error if either entry is missing.
"RTN","YSCLTEST",17,0)
 D DMG^YSCLTST3
"RTN","YSCLTEST",18,0)
 S YSCLSITE=$P($$SITE^VASITE,"^",2)
"RTN","YSCLTEST",19,0)
 K XMY
"RTN","YSCLTEST",20,0)
 S XMY("G.CLOZAPINE ROLL-UP@FORUM.VA.GOV")=""
"RTN","YSCLTEST",21,0)
 I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLTEST",22,0)
 S %DT="T",X="NOW" D ^%DT S YSCLNOW=$P(Y,".",2)
"RTN","YSCLTEST",23,0)
 S XMSUB=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine lab data started at "_YSCLSITE_" on "_DT_" at "_YSCLNOW,^TMP("YSCL",$J,1,0)=" ",^TMP("YSCL",$J,2,0)="+++ Clozapine data collection started at "_YSCLSITE_" on "_DT_" +++",^TMP("YSCL",$J,3,0)=" "
"RTN","YSCLTEST",24,0)
 S XMTEXT="^TMP(""YSCL"",$J,",XMDUZ="Clozapine MONITOR" D ^XMD
"RTN","YSCLTEST",25,0)
 S $P(^YSCL(603.03,1,0),"^",4)=$$NOW^XLFDT
"RTN","YSCLTEST",26,0)
 ;send MM message when routine started.
"RTN","YSCLTEST",27,0)
 S YSCLLN=0,YSCLLLN=3,X1=$P(YSCLED,"."),X2=-60 D C^%DTC S YSCLM28=X,X1=$P(YSCLED,"."),X2=-28 D C^%DTC S YSCLM7=X,YSCLED=YSCLED+.5 ;28 TO 60 and 14 to 28 6/15/05
"RTN","YSCLTEST",28,0)
 S X1=$P(YSCLED,"."),X2=-180 D C^%DTC S YSCLM180=X
"RTN","YSCLTEST",29,0)
 S X1=$P(YSCLED,"."),X2=-56 D C^%DTC S YSCLM56=X
"RTN","YSCLTEST",30,0)
 S YSCLIF=+$$SITE^VASITE_","
"RTN","YSCLTEST",31,0)
 D GETS^DIQ(4,YSCLIF,"1.01;1.02;1.03;.02;1.04","I","YSCLFF")
"RTN","YSCLTEST",32,0)
 S $P(YSCLDEMO,"^",1)=YSCLFF(4,YSCLIF,1.01,"I")
"RTN","YSCLTEST",33,0)
 S $P(YSCLDEMO,"^",2)=YSCLFF(4,YSCLIF,1.02,"I")
"RTN","YSCLTEST",34,0)
 S $P(YSCLDEMO,"^",3)=YSCLFF(4,YSCLIF,1.03,"I")
"RTN","YSCLTEST",35,0)
 S $P(YSCLDEMO,"^",4)=$P(^DIC(5,YSCLFF(4,YSCLIF,.02,"I"),0),"^",2)
"RTN","YSCLTEST",36,0)
 S $P(YSCLDEMO,"^",5)=YSCLFF(4,YSCLIF,1.04,"I")
"RTN","YSCLTEST",37,0)
 S $P(YSCLDEMO,"^",6)=""
"RTN","YSCLTEST",38,0)
 K J,YSCLF,YSCLFF,YSCLIF,X
"RTN","YSCLTEST",39,0)
 ;YSCLDEMO=street1^street2^city^state(2 letter)^ZIP^phone
"RTN","YSCLTEST",40,0)
 K ^TMP($J),^TMP("YSCL",$J) S (DFN,YSCLIEN)=0
"RTN","YSCLTEST",41,0)
 F  K YSCLA S YSCLIEN=$O(^YSCL(603.01,YSCLIEN)),YSCLLD=0 Q:'YSCLIEN  S DFN=$P($G(^YSCL(603.01,YSCLIEN,0)),"^",2) S $P(YSSTOP,",",1)=1 Q:$$S^%ZTLOAD  D:DFN
"RTN","YSCLTEST",42,0)
  . I $D(^DPT(DFN,0)),$D(^YSCL(603.01,YSCLIEN,0)) S YSCLSAND=$P($G(^YSCL(603.01,YSCLIEN,0)),"^",2),YSCL=^DPT(DFN,0),YSCLX=$E($P($P(YSCL,"^"),",",2))_$E(YSCL)_"^"_$P(YSCL,"^",9) D
"RTN","YSCLTEST",43,0)
  . . S YSCLLAB="" D GET I YSCLLAB]"" D CHECK^YSCLTST1 I YSCLT D LOAD^YSCLTST1
"RTN","YSCLTEST",44,0)
 G TRANSMIT^YSCLTST2
"RTN","YSCLTEST",45,0)
GET ;prescriptions
"RTN","YSCLTEST",46,0)
 Q:$$S^%ZTLOAD
"RTN","YSCLTEST",47,0)
 S YSCLPHY="",$P(YSCLX,"^",6)=$P(YSCLDEMO,"^",5),$P(YSCLX,"^",11)=$P($P($G(^YSCL(603.01,YSCLIEN,0)),"^"),"^"),$P(YSCLX,"^",16)=DT
"RTN","YSCLTEST",48,0)
 ;site zip(p6),registration number (p11), today (p16)
"RTN","YSCLTEST",49,0)
 F YSCL=0:0 S YSCL=$O(^PS(55,DFN,"P",YSCL)) Q:'YSCL  I $D(^(YSCL,0)) S YSCL1=^(0) I $D(^PSRX(YSCL1,0)) S YSCLRX=^(0) D ACTIVE I YSACT=0,$P($G(^PSDRUG(+$P(YSCLRX,"^",6),"CLOZ1")),"^")="PSOCLO1" D
"RTN","YSCLTEST",50,0)
  . S YSCLZ2=0 F  S YSCLZ2=$O(^PSDRUG(+$P(YSCLRX,"^",6),"CLOZ2",YSCLZ2)) Q:'YSCLZ2  I $P($G(^PSDRUG(+$P(YSCLRX,"^",6),"CLOZ2",YSCLZ2,0)),"^")]"",$P($G(^PSDRUG(+$P(YSCLRX,"^",6),"CLOZ2",YSCLZ2,0)),"^",4)=1 D  Q
"RTN","YSCLTEST",51,0)
  . . S YSCLLAB=^(0)
"RTN","YSCLTEST",52,0)
  . . S YSCLID=$P(YSCLRX,"^",13) S:YSCLID>YSCLLD YSCLLD=YSCLID I YSCLID'>DT,YSCLID'<YSCLM28 S YSCLA(-YSCLID,-YSCL1)="" ;Changed YSCLED to DT  RLM
"RTN","YSCLTEST",53,0)
 Q
"RTN","YSCLTEST",54,0)
ACTIVE ;Test for Active prescriptions
"RTN","YSCLTEST",55,0)
 S YSACT=$$GET1^DIQ(52,YSCL1_",",100,"I")
"RTN","YSCLTEST",56,0)
 Q
"RTN","YSCLTEST",57,0)
REXMIT ;Resend Clozapine data
"RTN","YSCLTEST",58,0)
 S X1=YSCLED,X2=-3 D C^%DTC S YSCLED=X,YSCLRET=1,ZTREQ="@" G RUN
"RTN","YSCLTEST",59,0)
 Q
"RTN","YSCLTEST",60,0)
ABORT ;
"RTN","YSCLTEST",61,0)
 K XMY
"RTN","YSCLTEST",62,0)
 S XMY("G.CLOZAPINE ROLL-UP@FORUM.VA.GOV")=""
"RTN","YSCLTEST",63,0)
 I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLTEST",64,0)
 S %DT="T",X="NOW" D ^%DT S YSCLNOW=$P(Y,".",2)
"RTN","YSCLTEST",65,0)
 S YSCLSITE=$P($$SITE^VASITE,"^",2)
"RTN","YSCLTEST",66,0)
 S XMSUB="Clozapine Roll-Up aborted ["_$G(YSSTOP)_"] at "_YSCLSITE_" on "_DT
"RTN","YSCLTEST",67,0)
 S YSTEXT(1,0)=" "
"RTN","YSCLTEST",68,0)
 S YSTEXT(2,0)=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine Roll-Up aborted ["_$G(YSSTOP)_"] at "_YSCLSITE_" on "_DT_" at "_YSCLNOW,^TMP("YSCL",$J,1,0)=" "
"RTN","YSCLTEST",69,0)
 S XMTEXT="YSTEXT(",XMDUZ="Clozapine MONITOR" D ^XMD
"RTN","YSCLTEST",70,0)
 S ZTSTOP=1 Q
"RTN","YSCLTEST",71,0)
ZEOR ;YSCLTEST
"RTN","YSCLTST1")
0^6^B19103633^B27542972
"RTN","YSCLTST1",1,0)
YSCLTST1 ;DALOI/LB/RLM-COLLECT RX AND LAB DATA FOR CLOZAPINE ;18 Feb 93
"RTN","YSCLTST1",2,0)
 ;;5.01;MENTAL HEALTH;**18,22,25,26,47,61,69,74,90**;Dec 30, 1994;Build 18
"RTN","YSCLTST1",3,0)
 ; Reference to ^DPT supported by IA #10035
"RTN","YSCLTST1",4,0)
 ; Reference to ^LR supported by IA #2657
"RTN","YSCLTST1",5,0)
 ; Reference to ^LAB supported by IA #333
"RTN","YSCLTST1",6,0)
 ; Reference to ^PS(52.52 supported by IA #782
"RTN","YSCLTST1",7,0)
 ; Reference to ^PS(55 supported by IA #787
"RTN","YSCLTST1",8,0)
 ; Reference to ^PS(59 supported by IA #783
"RTN","YSCLTST1",9,0)
 ; Reference to ^PSRX supported by IA #780
"RTN","YSCLTST1",10,0)
 ; Reference to ^VA(200 supported by IA #10060
"RTN","YSCLTST1",11,0)
CHECK ;for data to send
"RTN","YSCLTST1",12,0)
 S YSCLT=0,YSCLWBC=0
"RTN","YSCLTST1",13,0)
 S $P(YSSTOP,",",3)=3 Q:$$S^%ZTLOAD
"RTN","YSCLTST1",14,0)
 K PNM,SEX,DOB,AGE,SSN D DEM^VADPT I 'VAERR S PNM=VADM(1),SEX=$P(VADM(5),U),DOB=$P(VADM(3),U),AGE=VADM(4),SSN=$P(VADM(2),U)
"RTN","YSCLTST1",15,0)
 I YSCLLD=0,$P($G(^PS(55,DFN,"SAND")),"^",2)="P" Q  ;no transmit for pretreatment
"RTN","YSCLTST1",16,0)
 I YSCLLD,YSCLLD<YSCLM56 S $P(^PS(55,DFN,"SAND"),"^",2)="D" ;force discontinued
"RTN","YSCLTST1",17,0)
 I YSCLLD,YSCLLD<YSCLM180 Q  ;Don't report if over 6 months old.
"RTN","YSCLTST1",18,0)
 S YSCL=$O(YSCLA("")) I 'YSCL D LAB S YSCLT=1 Q  ;get latest WBC results even if no script.
"RTN","YSCLTST1",19,0)
 S YSCL1=-$O(YSCLA(YSCL,"")) I 'YSCL1 D LAB S YSCLT=1 Q  ;get latest WBC results even if no script.
"RTN","YSCLTST1",20,0)
 S YSCLT=1,YSCLRX=$G(^PSRX(YSCL1,0)),YSCLRX2=$G(^PSRX(YSCL1,2)) ;we've got something
"RTN","YSCLTST1",21,0)
 S YSCLGL=$S($D(^PS(59)):"^PS",1:"^DIC")
"RTN","YSCLTST1",22,0)
 ;YSCLGL is used to indirectly hold the global reference for file 59. This is necessary due to changes in the file location. The $select may be expanded to cover future moves. DBIA 273-B
"RTN","YSCLTST1",23,0)
 S YSCLD=+$P($G(^PSRX(YSCL1,2)),"^",9),YSCLD=$G(@YSCLGL@(59,YSCLD,"SAND")),$P(YSCLX,"^",10)=$P(YSCLD,"^"),$P(YSCLX,"^",12)=$P(YSCLD,"^",2)
"RTN","YSCLTST1",24,0)
 ;site DEA# (p10), site pointer (p12)
"RTN","YSCLTST1",25,0)
 I YSCLLD<YSCLM7 S YSCLWBC="",$P(^PS(55,DFN,"SAND"),"^",2)="H",$P(YSCLX,"^",5)="H" ;Place on hold status
"RTN","YSCLTST1",26,0)
 ;here if active
"RTN","YSCLTST1",27,0)
 I $P(YSCLX,"^",5)'="H" S $P(^PS(55,DFN,"SAND"),"^",2)="A",$P(YSCLX,"^",5)="A" ;force active
"RTN","YSCLTST1",28,0)
 S $P(YSCLX,"^",13)=1,$P(YSCLX,"^",9)=$P(YSCLRX,"^",13),YSCLD1=$G(^PSRX(YSCL1,"SAND")),$P(YSCLX,"^",8)=+YSCLD1
"RTN","YSCLTST1",29,0)
 ;status(p5),dosage(p8),rx count(p13),issue date(p9)
"RTN","YSCLTST1",30,0)
 S YSCLLO=$O(^PS(52.52,"A",YSCL1,0)) I YSCLLO S YSCLLO=^PS(52.52,YSCLLO,0),$P(YSCLX,"^",14)=$P(YSCLLO,"^",5),YSCLLO=+$P(YSCLLO,"^",4),$P(YSCLX,"^",15)=$P(^VA(200,YSCLLO,0),"^")
"RTN","YSCLTST1",31,0)
 ;lockout reason (p14), approving official (p15)
"RTN","YSCLTST1",32,0)
 S $P(YSSTOP,",",4)=4 Q:$$S^%ZTLOAD
"RTN","YSCLTST1",33,0)
 S YSCLPHY=$G(^VA(200,+$P(YSCLRX,"^",4),0)),$P(YSCLX,"^",7)=$P($G(^VA(200,+$P(YSCLRX,"^",4),"PS")),"^",2),YSCLPHY=$P(YSCLPHY,"^")
"RTN","YSCLTST1",34,0)
 S $P(YSCLX,"^",4)=1000*$P(YSCLD1,"^",2),$P(YSCLX,"^",3)=$P(YSCLD1,"^",3) I $P(YSCLD1,"^",2)]"",$P(YSCLD1,"^",3)'>YSCLED,$P(YSCLD1,"^",3)'<YSCLM7 S YSCLWBC=1
"RTN","YSCLTST1",35,0)
 ;wbc(p4),date(p3)
"RTN","YSCLTST1",36,0)
 S YSCL2=-$O(YSCLA(YSCL,-YSCL1)) I YSCL2,+$P($G(^PSRX(YSCL2,0)),"^",6)'=$P(YSCLRX,"^",6) S YSCL2=$G(^PSRX(YSCL2,"SAND")),$P(YSCLX,"^",13)=2 I $P(YSCL2,"^")'=$P(YSCLX,"^",8) S $P(YSCLX,"^",8)=$P(YSCLX,"^",8)+YSCL2
"RTN","YSCLTST1",37,0)
 ; add if prescription on same day for different drug and different dose
"RTN","YSCLTST1",38,0)
 S $P(YSCLX,"^",21)=$P(YSCLRX2,"^",7) ;Add NDC to string
"RTN","YSCLTST1",39,0)
LAB ;get most recent
"RTN","YSCLTST1",40,0)
 S $P(YSSTOP,",",5)=5 Q:$$S^%ZTLOAD
"RTN","YSCLTST1",41,0)
 S YSCLLDT="",J=9999998-YSCLED,K=9999998-YSCLM7 I $P(YSCLX,"^",9) S J=9999998-$P(YSCLX,"^",9)
"RTN","YSCLTST1",42,0)
 S YSCLR=$$CL^YSCLTST2(DFN) D  ;Set 3,4,17,19,20,22,23
"RTN","YSCLTST1",43,0)
  . S $P(YSCLX,"^",3)=$P(YSCLR,"^",6) ;WBC Date
"RTN","YSCLTST1",44,0)
  . S $P(YSCLX,"^",4)=$P(YSCLR,"^",2) ;WBC Results
"RTN","YSCLTST1",45,0)
  . ;S $P(YSCLX,"^",17)=$P(YSCLR,"^",6) ;WBC test count ???
"RTN","YSCLTST1",46,0)
  . S $P(YSCLX,"^",19)=$P(YSCLR,"^",6) ;ANC Date
"RTN","YSCLTST1",47,0)
  . S $P(YSCLX,"^",20)=$P(YSCLR,"^",4) ;ANC Results
"RTN","YSCLTST1",48,0)
  . S $P(YSCLX,"^",22)=$P(YSCLR,"^",3) ;WBC Name
"RTN","YSCLTST1",49,0)
  . S $P(YSCLX,"^",23)=$P(YSCLR,"^",5) ;ANC Name
"RTN","YSCLTST1",50,0)
 Q
"RTN","YSCLTST1",51,0)
LOAD ;
"RTN","YSCLTST1",52,0)
 S $P(YSSTOP,",",6)=6 Q:$$S^%ZTLOAD
"RTN","YSCLTST1",53,0)
 I YSCLWBC="",YSCLLD<YSCLM28 Q
"RTN","YSCLTST1",54,0)
 ; don't send for pretest or older that 28 days
"RTN","YSCLTST1",55,0)
 S YSCLNSTE=$P($G(^PS(59,+$P($G(^PSRX(YSCL1,2)),"^",9),0)),"^",6)
"RTN","YSCLTST1",56,0)
 S YSCLNST1=$P($$SITE^VASITE,"^",2),YSCLNSTE=$P($$SITE^VASITE,"^",3)
"RTN","YSCLTST1",57,0)
 S YSCLLN=YSCLLN+1,$P(YSCLX,"^",18)=YSCLRET,^TMP($J,YSCLLN,0)=YSCLX,YSCLLN=YSCLLN+1,^TMP($J,YSCLLN,0)=YSCLPHY_"^"_YSCLDEMO_"^"_YSCLNSTE_"^"_YSCLNST1
"RTN","YSCLTST1",58,0)
 ;site number and name
"RTN","YSCLTST1",59,0)
 ;S YSCLLLN=YSCLLLN+1,^TMP("YSCL",$J,YSCLLLN,0)=$P(^DPT(DFN,0),"^",9)_"   "_$P(^(0),"^")_"   "_$S($P(YSCLX,"^",13)="":"NO ",1:"  ")_"RX   "_$S(YSCLWBC="":"NO ",1:"   ")_"LAB" Q
"RTN","YSCLTST1",60,0)
 S YSCLLLN=YSCLLLN+1,^TMP("YSCL",$J,YSCLLLN,0)=$P(^DPT(DFN,0),"^",9)_"   "_$P(^(0),"^")_"  (R) "_$S($P(YSCLX,"^",13)="":"NO RX   ",1:$$FMTE^XLFDT($P(YSCLX,"^",9),"D"))_" (W) "
"RTN","YSCLTST1",61,0)
 S ^TMP("YSCL",$J,YSCLLLN,0)=^TMP("YSCL",$J,YSCLLLN,0)_$S($P(YSCLX,"^",3)="":"NO WBC   ",1:$$FMTE^XLFDT($P(YSCLX,"^",3),"D"))_" (N) "_$S($P(YSCLX,"^",20)="":"NO NEUT  ",1:$$FMTE^XLFDT($P(YSCLX,"^",19),"D")) Q
"RTN","YSCLTST1",62,0)
 ;9the piece for issue date, 16th piece for WBC date ;RLM 06/16/05
"RTN","YSCLTST1",63,0)
 Q
"RTN","YSCLTST1",64,0)
ZEOR ;YSCLTST1
"RTN","YSCLTST2")
0^8^B77542663^B19135665
"RTN","YSCLTST2",1,0)
YSCLTST2 ;DALOI/LB/RLM-TRANSMIT RX AND lAB DATA FOR CLOZAPINE ;19 Feb 93
"RTN","YSCLTST2",2,0)
 ;;5.01;MENTAL HEALTH;**18,22,26,47,61,69,74,90**;Dec 30, 1994;Build 18
"RTN","YSCLTST2",3,0)
 ; Reference to ^LAB(60 supported by IA #333
"RTN","YSCLTST2",4,0)
 ; Reference to ^PSDRUG supported by IA #25
"RTN","YSCLTST2",5,0)
 ; Reference to ^XMD supported by IA #10070
"RTN","YSCLTST2",6,0)
 ; 
"RTN","YSCLTST2",7,0)
TRANSMIT ; send remote and local, kill and quit
"RTN","YSCLTST2",8,0)
 K XMZ S %DT="T",X="NOW" D ^%DT S YSCLNOW=$P(Y,".",2),YSCLSITE=$P($$SITE^VASITE,"^",2)
"RTN","YSCLTST2",9,0)
 S $P(YSSTOP,",",7)=7 I $$S^%ZTLOAD D ABORT^YSCLTEST G END
"RTN","YSCLTST2",10,0)
 I YSCLLN D
"RTN","YSCLTST2",11,0)
  . K XMY
"RTN","YSCLTST2",12,0)
  . S XMY("S.RUCLRXLAB@FO-HINES.MED.VA.GOV")=""
"RTN","YSCLTST2",13,0)
  . I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")="",XMY("G.RUCLRXLAB@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLTST2",14,0)
  . S XMDUZ="Clozapine MONITOR",XMTEXT="^TMP($J,",XMSUB=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine lab data @ "_YSCLSITE_" on "_DT_" at "_YSCLNOW D ^XMD
"RTN","YSCLTST2",15,0)
 K XMY
"RTN","YSCLTST2",16,0)
 S XMY("G.CLOZAPINE ROLL-UP@FORUM.VA.GOV")=""
"RTN","YSCLTST2",17,0)
 I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLTST2",18,0)
 S XMY("G.PSOCLOZ")=""
"RTN","YSCLTST2",19,0)
 S XMSUB=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine lab data @ "_YSCLSITE_" on "_DT_" at "_YSCLNOW
"RTN","YSCLTST2",20,0)
 S ^TMP("YSCL",$J,2,0)=" ",^TMP("YSCL",$J,3,0)="In message # "_$S($D(XMZ):XMZ,1:"no data sent")
"RTN","YSCLTST2",21,0)
 K XMZ S XMDUZ="Clozapine MONITOR",^TMP("YSCL",$J,1,0)="Clozapine lab data was transmitted, "_(YSCLLLN-3)_" records were sent",XMTEXT="^TMP(""YSCL"",$J," D ^XMD
"RTN","YSCLTST2",22,0)
 S $P(^YSCL(603.03,1,0),"^",5)=$$NOW^XLFDT
"RTN","YSCLTST2",23,0)
END ;
"RTN","YSCLTST2",24,0)
 G END1^YSCLTST3
"RTN","YSCLTST2",25,0)
 Q
"RTN","YSCLTST2",26,0)
REXMIT ; retransmit lab and RX data
"RTN","YSCLTST2",27,0)
 ; must be a period ending on tuesday
"RTN","YSCLTST2",28,0)
 S DIR(0)="Y",DIR("A")="Are you sure you wish to retransmit lab data"
"RTN","YSCLTST2",29,0)
 D ^DIR K DIR I Y'=1 K Y Q
"RTN","YSCLTST2",30,0)
DATE S %DT="AEXP",%DT(0)=-DT,%DT("A")="Ending date for data collection (must be a tuesday )"
"RTN","YSCLTST2",31,0)
 D ^%DT K %DT G END:X="^",END:X="^" I Y=-1 G DATE
"RTN","YSCLTST2",32,0)
SERV S YSCLED=Y,X=Y D H^%DTC I %H#7'=5 W !,"MUST BE A TUESDAY" G DATE
"RTN","YSCLTST2",33,0)
 S ZTDESC="Server triggered retransmission"
"RTN","YSCLTST2",34,0)
 S ZTSAVE("YSCLED")="",ZTIO="",ZTRTN="REXMIT^YSCLTEST",ZTDTH=$H D ^%ZTLOAD G END
"RTN","YSCLTST2",35,0)
FLSET ;Set up file 603.02
"RTN","YSCLTST2",36,0)
 W @IOF,"This option specifies the blood tests associated with the Clozapine"
"RTN","YSCLTST2",37,0)
 W !,"reporting software.  Two tests must be defined.  The first is the White"
"RTN","YSCLTST2",38,0)
 W !,"Blood Count.  The second is the Granulocyte (or Neutrophil) percentage."
"RTN","YSCLTST2",39,0)
 K DIR W !! S DIR(0)="PA^64:EMZ",DIR("A",1)="Enter the test that will be used to record the White Blood Count for the",DIR("A")="Clozapine patients: " D ^DIR
"RTN","YSCLTST2",40,0)
 Q:Y=-1!($D(DUOUT))!($D(DTOUT))!($D(DIRUT))!($D(DIROUT))
"RTN","YSCLTST2",41,0)
 S YSCLWBC=+Y
"RTN","YSCLTST2",42,0)
 K DIR W !! S DIR(0)="PA^64:EMZ",DIR("A",1)="Enter the test that will be used to record the Neutrophil Count (percentage)",DIR("A")=" for the Clozapine patients: " D ^DIR
"RTN","YSCLTST2",43,0)
 Q:Y=-1!($D(DUOUT))!($D(DTOUT))!($D(DIRUT))!($D(DIROUT))
"RTN","YSCLTST2",44,0)
 S YSCLGRN=+Y
"RTN","YSCLTST2",45,0)
 I YSCLWBC,YSCLGRN S ^YSCL(603.02,1,0)=YSCLWBC_"^"_YSCLGRN,$P(^YSCL(603.02,0),"^",3,4)="1^1"
"RTN","YSCLTST2",46,0)
 ;Only one entry is allowed.  No cross reference is necessary. Update zeroeth node RLM 9-29-99
"RTN","YSCLTST2",47,0)
 K DIR,X,Y,YSCLWBC,YSCLGRN,ZTDESC
"RTN","YSCLTST2",48,0)
 Q
"RTN","YSCLTST2",49,0)
EN(DRG) ;
"RTN","YSCLTST2",50,0)
 K LAB I $P($G(^PSDRUG(DRG,"CLOZ1")),"^")'="PSOCLO1" S LAB("NOT")=0 Q
"RTN","YSCLTST2",51,0)
 I $P($G(^PSDRUG(DRG,"CLOZ1")),"^")="PSOCLO1" D
"RTN","YSCLTST2",52,0)
  . S (CNT,I)=0 F  S I=$O(^PSDRUG(DRG,"CLOZ2",I)) Q:'I  S CNT=$G(CNT)+1
"RTN","YSCLTST2",53,0)
  . I CNT'=2 S LAB("BAD TEST")=0 K CNT Q
"RTN","YSCLTST2",54,0)
  . K CNT F I=0:0 S I=$O(^PSDRUG(DRG,"CLOZ2",I)) Q:'I  D
"RTN","YSCLTST2",55,0)
  . . S LABT=$S($P(^PSDRUG(DRG,"CLOZ2",I,0),"^",4)=1:"WBC",1:"ANC"),LAB(LABT)=$P(^PSDRUG(DRG,"CLOZ2",I,0),"^")_"^"_$P(^(0),"^",3)_"^"_$P(^(0),"^",4)
"RTN","YSCLTST2",56,0)
 K LABT,I
"RTN","YSCLTST2",57,0)
 Q
"RTN","YSCLTST2",58,0)
CL1(DFN,DAYS) ;
"RTN","YSCLTST2",59,0)
 K ^TMP($J,"PSO"),RESULTS,YSCLYWBC,YSCLRANC,YSCLXWBC
"RTN","YSCLTST2",60,0)
 Q:'DFN
"RTN","YSCLTST2",61,0)
 S:'$G(DAYS) DAYS=90
"RTN","YSCLTST2",62,0)
 S YSCLFRQ=$O(^YSCL(603.01,"C",DFN,"")) I YSCLFRQ]""  S YSCLFRQ=$P(^YSCL(603.01,YSCLFRQ,0),"^",3)
"RTN","YSCLTST2",63,0)
 I $G(^YSCL(603.03,1,1))=1  Q "-1^0^0^0^0^0^"_YSCLFRQ
"RTN","YSCLTST2",64,0)
 S X1=DT,X2="-"_DAYS D C^%DTC S YSCLSD=X
"RTN","YSCLTST2",65,0)
 S YSCLA=0 F  S YSCLA=$O(^YSCL(603.04,1,1,YSCLA)) Q:'YSCLA  S YSCLTLS=^YSCL(603.04,1,1,YSCLA,0),YSCLTLS($P(YSCLTLS,"^",2),$P(YSCLTLS,"^",1))=$P(YSCLTLS,"^",3)
"RTN","YSCLTST2",66,0)
 S YSCLTL="" F  S YSCLTL=$O(^YSCL(603.04,1,1,"B",YSCLTL)) Q:'YSCLTL  D
"RTN","YSCLTST2",67,0)
  . D RR^LR7OR1(DFN,,YSCLSD,DT,,YSCLTL,"L")
"RTN","YSCLTST2",68,0)
  . S YSCLSB1="" F  S YSCLSB1=$O(^TMP("LRRR",$J,DFN,YSCLSB1)) Q:YSCLSB1=""  D
"RTN","YSCLTST2",69,0)
  . . S YSCLTDT="" F  S YSCLTDT=$O(^TMP("LRRR",$J,DFN,YSCLSB1,YSCLTDT)) Q:YSCLTDT=""  I $P(YSCLTDT,".",2)]"" D
"RTN","YSCLTST2",70,0)
  . . . S YSCLTA="" F  S YSCLTA=$O(^TMP("LRRR",$J,DFN,YSCLSB1,YSCLTDT,YSCLTA)) Q:YSCLTA=""  I YSCLTA D
"RTN","YSCLTST2",71,0)
  . . . . S RESULTS1=^TMP("LRRR",$J,DFN,YSCLSB1,YSCLTDT,YSCLTA)
"RTN","YSCLTST2",72,0)
  . . . . S RESULTS(YSCLTL,YSCLTDT)=$P(RESULTS1,"^",2)
"RTN","YSCLTST2",73,0)
 ;Find all entries for WBC and sort by inverse date.
"RTN","YSCLTST2",74,0)
 S YSCLA="" F  S YSCLA=$O(YSCLTLS("W",YSCLA)) Q:'YSCLA  S YSCLXWBC(YSCLA)="" D
"RTN","YSCLTST2",75,0)
  . S YSCLA1="" F  S YSCLA1=$O(RESULTS(YSCLA,YSCLA1)) Q:'YSCLA1  S YSCLYWBC(YSCLA1)=RESULTS(YSCLA,YSCLA1)*$S(YSCLTLS("W",YSCLA):1000,1:1)
"RTN","YSCLTST2",76,0)
 S YSCLRWBC=0 F  S YSCLRWBC=$O(YSCLYWBC(YSCLRWBC)) Q:YSCLRWBC=""  S YSCLRWBC(YSCLRWBC)=YSCLYWBC(YSCLRWBC) D
"RTN","YSCLTST2",77,0)
 . ;Match all ANC's and WBC's
"RTN","YSCLTST2",78,0)
 . S YSCLMTCH=0 F YSCLA="A","N","S","C" S YSCLTPT="" F  S YSCLTPT=$O(YSCLTLS(YSCLA,YSCLTPT)) Q:'YSCLTPT  D
"RTN","YSCLTST2",79,0)
 . . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="A",$D(YSCLRWBC(YSCLRWBC)) S ^TMP($J,"PSO",YSCLRWBC)=YSCLRWBC(YSCLRWBC)_"^"_(RESULTS(YSCLTPT,YSCLRWBC)*$S(YSCLTLS(YSCLA,YSCLTPT):1000,1:1)) Q
"RTN","YSCLTST2",80,0)
 . . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="N",$D(YSCLRWBC(YSCLRWBC)) S ^TMP($J,"PSO",YSCLRWBC)=YSCLRWBC(YSCLRWBC)_"^"_(YSCLRWBC(YSCLRWBC)*((RESULTS(YSCLTPT,YSCLRWBC)*.01))) Q
"RTN","YSCLTST2",81,0)
 . . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="S",$D(YSCLRWBC(YSCLRWBC)) D
"RTN","YSCLTST2",82,0)
 . . . S YSCLSGS="" F  S YSCLSGS=$O(YSCLTLS("B",YSCLSGS)) D  Q:'YSCLSGS
"RTN","YSCLTST2",83,0)
 . . . . S:'YSCLSGS YSCLSGS="Z" I '$D(RESULTS(YSCLSGS,YSCLRWBC)) S RESULTS(YSCLSGS,YSCLRWBC)=0
"RTN","YSCLTST2",84,0)
 . . . . S ^TMP($J,"PSO",YSCLRWBC)=YSCLRWBC(YSCLRWBC)_"^"_(YSCLRWBC(YSCLRWBC)*((RESULTS(YSCLTPT,YSCLRWBC)*.01)+(RESULTS(YSCLSGS,YSCLRWBC)*.01))) Q
"RTN","YSCLTST2",85,0)
 . . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="C" D
"RTN","YSCLTST2",86,0)
 . . . S YSCLSGS="" F  S YSCLSGS=$O(YSCLTLS("T",YSCLSGS)) D  Q:'YSCLSGS
"RTN","YSCLTST2",87,0)
 . . . . S:'YSCLSGS YSCLSGS="Z" I '$D(RESULTS(YSCLSGS,YSCLRWBC)) S RESULTS(YSCLSGS,YSCLRWBC)=0
"RTN","YSCLTST2",88,0)
 . . . . S ^TMP($J,"PSO",YSCLRWBC)=YSCLRWBC(YSCLRWBC)_"^"_((RESULTS(YSCLTPT,YSCLRWBC)*$S(YSCLTLS(YSCLA,YSCLTPT):1000,1:1))+(RESULTS(YSCLSGS,YSCLRWBC))) Q
"RTN","YSCLTST2",89,0)
 K FDA,YSCLSGS,Y15,YSCLRWBC,YSCLANC,YSCLYWBC,YSCLFRQ,ZIENS,RESULTS,RESULTS1,YSCLA,YSCLA1,YSCLMTCH,YSCLSB1,YSCLSD
"RTN","YSCLTST2",90,0)
 K YSCLTA,YSCLTDT,YSCLTL,YSCLTLS,YSCLTPT,YSCLXWBC,YSCLMULT
"RTN","YSCLTST2",91,0)
 Q
"RTN","YSCLTST2",92,0)
 ;
"RTN","YSCLTST2",93,0)
 ;
"RTN","YSCLTST2",94,0)
CL(DFN) ;
"RTN","YSCLTST2",95,0)
 K ^TMP("LRRR",$J) N RESULTS,YSCLYWBC,YSCLRANC,YSCLXWBC,YSCLRWBC,YSCLFRQ
"RTN","YSCLTST2",96,0)
 I 'DFN Q "-1^-1^-1^-1^-1^-1^-1"
"RTN","YSCLTST2",97,0)
 S YSCLFRQ=$O(^YSCL(603.01,"C",DFN,"")) I YSCLFRQ]""  S YSCLFRQ=$P(^YSCL(603.01,YSCLFRQ,0),"^",3)
"RTN","YSCLTST2",98,0)
 I $G(^YSCL(603.03,1,1))=1!(YSCLFRQ="")  Q "-1^0^0^0^0^0^"_YSCLFRQ
"RTN","YSCLTST2",99,0)
 S X1=DT,X2="-7" D C^%DTC S YSCLSD=X
"RTN","YSCLTST2",100,0)
 S YSCLA=0 F  S YSCLA=$O(^YSCL(603.04,1,1,YSCLA)) Q:'YSCLA  S YSCLTLS=^YSCL(603.04,1,1,YSCLA,0),YSCLTLS($P(YSCLTLS,"^",2),$P(YSCLTLS,"^",1))=$P(YSCLTLS,"^",3)
"RTN","YSCLTST2",101,0)
 S YSCLTL="" F  S YSCLTL=$O(^YSCL(603.04,1,1,"B",YSCLTL)) Q:'YSCLTL  D
"RTN","YSCLTST2",102,0)
  . D RR^LR7OR1(DFN,,YSCLSD,DT,,YSCLTL,"L")
"RTN","YSCLTST2",103,0)
  . S YSCLSB1="" F  S YSCLSB1=$O(^TMP("LRRR",$J,DFN,YSCLSB1)) Q:YSCLSB1=""  D
"RTN","YSCLTST2",104,0)
  . . S YSCLTDT="" F  S YSCLTDT=$O(^TMP("LRRR",$J,DFN,YSCLSB1,YSCLTDT)) Q:YSCLTDT=""  I $P(YSCLTDT,".",2)]"" D
"RTN","YSCLTST2",105,0)
  . . . S YSCLTA="" F  S YSCLTA=$O(^TMP("LRRR",$J,DFN,YSCLSB1,YSCLTDT,YSCLTA)) Q:YSCLTA=""  I YSCLTA D
"RTN","YSCLTST2",106,0)
  . . . . S RESULTS1=^TMP("LRRR",$J,DFN,YSCLSB1,YSCLTDT,YSCLTA)
"RTN","YSCLTST2",107,0)
  . . . . S RESULTS(YSCLTL,YSCLTDT)=$P(RESULTS1,"^",2)
"RTN","YSCLTST2",108,0)
 ;Find all entries for WBC and sort by inverse date.
"RTN","YSCLTST2",109,0)
 S YSCLA="" F  S YSCLA=$O(YSCLTLS("W",YSCLA)) Q:'YSCLA  S YSCLXWBC(YSCLA)="" D
"RTN","YSCLTST2",110,0)
  . S YSCLA1="" F  S YSCLA1=$O(RESULTS(YSCLA,YSCLA1)) Q:'YSCLA1  S YSCLYWBC(YSCLA1)=RESULTS(YSCLA,YSCLA1)_"^"_$P($G(^LAB(60,YSCLA,0)),"^")_"^"_YSCLTLS("W",YSCLA)
"RTN","YSCLTST2",111,0)
 S YSCLRWBC=$O(YSCLYWBC(0)) I 'YSCLRWBC D KILL Q "0^^^^^^"_YSCLFRQ
"RTN","YSCLTST2",112,0)
 S YSCLMULT=$P(YSCLYWBC(YSCLRWBC),"^",3),YSCLMULT=$S(YSCLMULT:1000,1:1)
"RTN","YSCLTST2",113,0)
 S YSCLRWBC(YSCLRWBC)=($P(YSCLYWBC(YSCLRWBC),"^")*YSCLMULT)_"^"_$P(YSCLYWBC(YSCLRWBC),"^",2)
"RTN","YSCLTST2",114,0)
 ;Scan for Neutrophil count on same day and time as most recent WBC
"RTN","YSCLTST2",115,0)
 S YSCLMTCH=0 F YSCLA="A","N","S","T" S YSCLTPT="" F  S YSCLTPT=$O(YSCLTLS(YSCLA,YSCLTPT)) Q:'YSCLTPT  D  Q:YSCLMTCH
"RTN","YSCLTST2",116,0)
  . S YSCLMULT=YSCLTLS(YSCLA,YSCLTPT),YSCLMULT=$S(YSCLMULT:1000,1:1)
"RTN","YSCLTST2",117,0)
  . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="A" S YSCLMTCH=1,YSCLRANC(YSCLRWBC)=RESULTS(YSCLTPT,YSCLRWBC)*YSCLMULT_"^"_$P(^LAB(60,YSCLTPT,0),"^") Q
"RTN","YSCLTST2",118,0)
  . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="N" S YSCLMTCH=1,YSCLRANC(YSCLRWBC)=YSCLRWBC(YSCLRWBC)*((RESULTS(YSCLTPT,YSCLRWBC))*.01)_"^"_$P(^LAB(60,YSCLTPT,0),"^") Q
"RTN","YSCLTST2",119,0)
  . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="S" D
"RTN","YSCLTST2",120,0)
  . . S YSCLSGS="" F  S YSCLSGS=$O(YSCLTLS("B",YSCLSGS)) D  Q:YSCLMTCH
"RTN","YSCLTST2",121,0)
  . . . S:'YSCLSGS YSCLSGS="Z" I '$D(RESULTS(YSCLSGS,YSCLRWBC)) S RESULTS(YSCLSGS,YSCLRWBC)=0
"RTN","YSCLTST2",122,0)
  . . . S YSCLMTCH=1,YSCLRANC(YSCLRWBC)=YSCLRWBC(YSCLRWBC)*((RESULTS(YSCLTPT,YSCLRWBC)*.01)+(RESULTS(YSCLSGS,YSCLRWBC)*.01))_"^"_$P(^LAB(60,YSCLTPT,0),"^")_"/"_$P($G(^LAB(60,YSCLSGS,0)),"^") Q
"RTN","YSCLTST2",123,0)
  . I $D(RESULTS(YSCLTPT,YSCLRWBC)),YSCLA="C" D
"RTN","YSCLTST2",124,0)
  . . S YSCLSGS="" F  S YSCLSGS=$O(YSCLTLS("T",YSCLSGS)) D  Q:YSCLMTCH
"RTN","YSCLTST2",125,0)
  . . . S:'YSCLSGS YSCLSGS="Z" I '$D(RESULTS(YSCLSGS,YSCLRWBC)) S RESULTS(YSCLSGS,YSCLRWBC)=0
"RTN","YSCLTST2",126,0)
  . . . S YSCLMTCH=1,YSCLRANC(YSCLRWBC)=((RESULTS(YSCLTPT,YSCLRWBC)*YSCLMULT)+(RESULTS(YSCLSGS,YSCLRWBC)*YSCLMULT))_"^"_$P(^LAB(60,YSCLTPT,0),"^")_"/"_$P($G(^LAB(60,YSCLSGS,0)),"^") Q
"RTN","YSCLTST2",127,0)
 D KILL
"RTN","YSCLTST2",128,0)
 I $G(YSCLRWBC(YSCLRWBC))<3000!($G(YSCLRANC(YSCLRWBC))<1500) Q "0^"_$G(YSCLRWBC(YSCLRWBC))_"^"_$S($G(YSCLRANC(YSCLRWBC))="":"^",1:$G(YSCLRANC(YSCLRWBC)))_"^"_(9999999-YSCLRWBC)_"^"_YSCLFRQ
"RTN","YSCLTST2",129,0)
 I $G(YSCLRWBC(YSCLRWBC))<3500!($G(YSCLRANC(YSCLRWBC))<2000) Q "2^"_$G(YSCLRWBC(YSCLRWBC))_"^"_$S($G(YSCLRANC(YSCLRWBC))="":"^",1:$G(YSCLRANC(YSCLRWBC)))_"^"_(9999999-YSCLRWBC)_"^"_YSCLFRQ
"RTN","YSCLTST2",130,0)
 Q "1^"_YSCLRWBC(YSCLRWBC)_"^"_YSCLRANC(YSCLRWBC)_"^"_(9999999-YSCLRWBC)_"^"_YSCLFRQ
"RTN","YSCLTST2",131,0)
 ;
"RTN","YSCLTST2",132,0)
KILL ;
"RTN","YSCLTST2",133,0)
 K FDA,YSCLSGS,Y15,RESULTS,RESULTS1,YSCLA,YSCLA1,YSCLMTCH,YSCLSB1,YSCLSD,YSCLTA,YSCLMULT
"RTN","YSCLTST2",134,0)
 K YSCLTDT,YSCLTL,YSCLTLS,YSCLTPT,YSCLXWBC
"RTN","YSCLTST2",135,0)
 ;
"RTN","YSCLTST2",136,0)
OVERRIDE(DFN) ;Check to see if the NCCC has authorized an over-ride for today on this patient.
"RTN","YSCLTST2",137,0)
 S YSCLOVR=$O(^YSCL(603.01,"C",DFN,""))
"RTN","YSCLTST2",138,0)
 Q:YSCLOVR="" 0
"RTN","YSCLTST2",139,0)
 S YSCLOVR=$P(^YSCL(603.01,YSCLOVR,0),"^",4)
"RTN","YSCLTST2",140,0)
 Q YSCLOVR=DT
"RTN","YSCLTST2",141,0)
 ;
"RTN","YSCLTST2",142,0)
ZEOR ;YSCLTST2
"RTN","YSCLTST3")
0^9^B59491458^B27477031
"RTN","YSCLTST3",1,0)
YSCLTST3 ;DALOI/LB/RLM-TRANSMISSION FOR CLOZAPINE REPORTING SYSTEM ;26 June 91
"RTN","YSCLTST3",2,0)
 ;;5.01;MENTAL HEALTH;**18,22,25,26,47,61,69,74,90**;Dec 30, 1994;Build 18
"RTN","YSCLTST3",3,0)
 ; Reference to ^DPT supported by IA #10035
"RTN","YSCLTST3",4,0)
 ; Reference to ^PS(55 supported by IA #787
"RTN","YSCLTST3",5,0)
 ; Reference to ^PS(59 supported by IA #783
"RTN","YSCLTST3",6,0)
 ; Reference to ^VA(200 supported by IA #10060
"RTN","YSCLTST3",7,0)
 ; Reference to ^LAB(60 supported by IA #333
"RTN","YSCLTST3",8,0)
 ; Reference to ^XMD supported by IA #10070
"RTN","YSCLTST3",9,0)
DEMOG ; Old entry point to send demographic data for patients from task. Obsolete
"RTN","YSCLTST3",10,0)
 Q
"RTN","YSCLTST3",11,0)
DMG ; Called by YSCLTEST
"RTN","YSCLTST3",12,0)
 S YSDEBUG=$P(^YSCL(603.03,1,0),"^",3)
"RTN","YSCLTST3",13,0)
 K ^TMP($J),^TMP("YSCL",$J),^TMP("YSCLL",$J) S YSCLLN=0,YSCLNO=20,DFN=0,YSCLIEN=0
"RTN","YSCLTST3",14,0)
 F  K YSCLA S YSCLIEN=$O(^YSCL(603.01,YSCLIEN)) Q:'YSCLIEN  S DFN=$P($G(^YSCL(603.01,YSCLIEN,0)),"^",2) S $P(YSSTOP,",",8)=8 Q:$$S^%ZTLOAD  D:DFN
"RTN","YSCLTST3",15,0)
  . I $D(^DPT(DFN,0)),$D(^YSCL(603.01,YSCLIEN,0)) S YSCLC=$P($G(^YSCL(603.01,YSCLIEN,0)),"^",1) D GET
"RTN","YSCLTST3",16,0)
 D TRANSMIT:YSCLLN G END
"RTN","YSCLTST3",17,0)
 ;
"RTN","YSCLTST3",18,0)
GET ;
"RTN","YSCLTST3",19,0)
 S $P(YSSTOP,",",9)=9 Q:$$S^%ZTLOAD
"RTN","YSCLTST3",20,0)
 Q:'$D(^PS(55,DFN,"SAND"))  ;Don't try to transmit if no pharmacy record
"RTN","YSCLTST3",21,0)
 Q:$P(^PS(55,DFN,"SAND"),"^",4)  ;Don't retransmit demographics.
"RTN","YSCLTST3",22,0)
 Q:$D(^TMP("YSCLL",$J,DFN))
"RTN","YSCLTST3",23,0)
 S ^TMP("YSCLL",$J,DFN)=1
"RTN","YSCLTST3",24,0)
 S YSCLP=+$P($G(^PS(55,DFN,"SAND")),"^",5),YSCLDEA=$P($G(^VA(200,YSCLP,"PS")),"^",2),YSCLP=$P($G(^VA(200,YSCLP,0)),"^")
"RTN","YSCLTST3",25,0)
 D DEM^VADPT,ADD^VADPT S YSCL=YSCLC_"^"_$E($P(VADM(1),",",2))_$E(VADM(1))_"^"_$P(VADM(3),"^")_"^"_$P(VADM(2),"^")_"^"_$P(VADM(5),"^")_"^"_VAPA(6)_"^"_DT
"RTN","YSCLTST3",26,0)
 D
"RTN","YSCLTST3",27,0)
  . S YSRACE="*"
"RTN","YSCLTST3",28,0)
  . S YSRC=0 F  S YSRC=$O(VADM(11,YSRC)) Q:'YSRC  S YSRACE=YSRACE_+VADM(11,YSRC)_"-"_+VADM(11,YSRC,1)_","
"RTN","YSCLTST3",29,0)
  . S YSRACE=YSRACE_"~"
"RTN","YSCLTST3",30,0)
  . S YSRC=0 F  S YSRC=$O(VADM(12,YSRC)) Q:'YSRC  S YSRACE=YSRACE_+VADM(12,YSRC)_"-"_+VADM(12,YSRC,1)_","
"RTN","YSCLTST3",31,0)
 S YSCL=YSCL_"^"_YSRACE_"^"_YSCLP_"^"_YSCLDEA
"RTN","YSCLTST3",32,0)
 S YSCLGL=$S($D(^PS(59)):"^PS",1:"^DIC")
"RTN","YSCLTST3",33,0)
 ;YSCLGL is used to indirectly hold the global reference for file 59. This is necessary due to changes in the file location. The $select may be expanded to cover future moves. DBIA 273-B
"RTN","YSCLTST3",34,0)
 F YSCLJ=0:0 S YSCLJ=$O(@YSCLGL@(59,YSCLJ)) Q:'YSCLJ  I $D(^(YSCLJ,"SAND")) S YSCLJ=$P(^(0),"^",5) Q
"RTN","YSCLTST3",35,0)
 S YSCL=YSCL_"^"_YSCLJ
"RTN","YSCLTST3",36,0)
 ;registration number^initials^dob^ssn^sex^zip^today^race^physician^dea^zip code (hosp)
"RTN","YSCLTST3",37,0)
 S YSCLLN=YSCLLN+1,^TMP($J,YSCLLN,0)=YSCL
"RTN","YSCLTST3",38,0)
 I VADM(5)=""!(VAPA(6)="")!('VADM(11))!('VADM(12)) D  ;RLM RACETEST
"RTN","YSCLTST3",39,0)
  . S ^TMP("YSCL",$J,YSCLNO,0)=$P(VADM(2),"^",1)_"   "_VADM(1)
"RTN","YSCLTST3",40,0)
  . S:VADM(5)="" ^TMP("YSCL",$J,YSCLNO,0)=^TMP("YSCL",$J,YSCLNO,0)_" (SEX)"
"RTN","YSCLTST3",41,0)
  . S:VAPA(6)="" ^TMP("YSCL",$J,YSCLNO,0)=^TMP("YSCL",$J,YSCLNO,0)_" (ZIP)"
"RTN","YSCLTST3",42,0)
  . S:'VADM(12) ^TMP("YSCL",$J,YSCLNO,0)=^TMP("YSCL",$J,YSCLNO,0)_" (RACE, NEW FORMAT)"
"RTN","YSCLTST3",43,0)
  . S:'VADM(11) ^TMP("YSCL",$J,YSCLNO,0)=^TMP("YSCL",$J,YSCLNO,0)_" (ETHNICITY)"
"RTN","YSCLTST3",44,0)
  . S YSCLNO=YSCLNO+1
"RTN","YSCLTST3",45,0)
  . S ^TMP("YSCLL",$J,DFN)=0 ; leave unmarked pending demographic data
"RTN","YSCLTST3",46,0)
  . I ('VADM(11))!('VADM(12)) D
"RTN","YSCLTST3",47,0)
  . . S ^TMP("YSCL",$J,YSCLNO,0)="NOTE: Race and Ethnicity may be entered if permission is obtained in the informed consent",YSCLNO=YSCLNO+1
"RTN","YSCLTST3",48,0)
  . . S ^TMP("YSCL",$J,YSCLNO,0)="document. See VHA Directive 99-035.",YSCLNO=YSCLNO+1
"RTN","YSCLTST3",49,0)
 ;
"RTN","YSCLTST3",50,0)
 Q
"RTN","YSCLTST3",51,0)
 ;
"RTN","YSCLTST3",52,0)
TRANSMIT ; remote and local messages
"RTN","YSCLTST3",53,0)
 S $P(YSSTOP,",",10)=10 Q:$$S^%ZTLOAD
"RTN","YSCLTST3",54,0)
 S XMY("S.RUCLDEM@FO-HINES.MED.VA.GOV")=""
"RTN","YSCLTST3",55,0)
 I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")="",XMY("G.RUCLDEM@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLTST3",56,0)
 S XMDUZ="CLOZAPINE MONITOR",XMTEXT="^TMP($J,",XMSUB=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine demographics" D ^XMD S $P(^YSCL(603.03,1,0),"^",6)=$$NOW^XLFDT
"RTN","YSCLTST3",57,0)
 K XMY S XMY("G.PSOCLOZ")=""
"RTN","YSCLTST3",58,0)
 I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLTST3",59,0)
 S XMSUB=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine demographics",^TMP("YSCL",$J,2,0)=" ",XMDUZ="CLOZAPINE MONITOR",^TMP("YSCL",$J,1,0)="Clozapine demographic data was transmitted, "_YSCLLN_" records were sent.",XMTEXT="^TMP(""YSCL"",$J,"
"RTN","YSCLTST3",60,0)
 I $O(^TMP("YSCL",$J,10)) S ^TMP("YSCL",$J,3,0)="For the following patients, one or more of the required data",^TMP("YSCL",$J,4,0)="elements (race, sex, ZIP code) were missing.",^TMP("YSCL",$J,5,0)=" "
"RTN","YSCLTST3",61,0)
 I  S ^TMP("YSCL",$J,6,0)="Please have this information entered.",^TMP("YSCL",$J,7,0)="The available data was transmitted.",^TMP("YSCL",$J,8,0)=" "
"RTN","YSCLTST3",62,0)
 D ^XMD
"RTN","YSCLTST3",63,0)
 ; set transmitted field in 55 from ^TMP("YSCLL",$J)
"RTN","YSCLTST3",64,0)
 F DFN=0:0 S DFN=$O(^TMP("YSCLL",$J,DFN)) Q:'DFN  I ^TMP("YSCLL",$J,DFN) S $P(^PS(55,DFN,"SAND"),"^",4)=1
"RTN","YSCLTST3",65,0)
 Q
"RTN","YSCLTST3",66,0)
 ;
"RTN","YSCLTST3",67,0)
FLERR ;
"RTN","YSCLTST3",68,0)
 K XMY
"RTN","YSCLTST3",69,0)
 S XMY("G.CLOZAPINE ROLL-UP@FORUM.VA.GOV")=""
"RTN","YSCLTST3",70,0)
 I YSDEBUG K XMY S XMY("G.CLOZAPINE DEBUG@FO-DALLAS.MED.VA.GOV")=""
"RTN","YSCLTST3",71,0)
 S %DT="T",X="NOW" D ^%DT S YSCLNOW=$P(Y,".",2)
"RTN","YSCLTST3",72,0)
 S YSCLSITE=$P($$SITE^VASITE,"^",2)
"RTN","YSCLTST3",73,0)
 S XMSUB=$S(YSDEBUG:"DEBUG ",1:"")_"Clozapine lab data error at "_YSCLSITE_" on "_DT_" at "_YSCLNOW,^TMP("YSCL",$J,1,0)=" "
"RTN","YSCLTST3",74,0)
 S ^TMP("YSCL",$J,2,0)="### Clozapine data error at "_YSCLSITE_" on "_DT_" +++"
"RTN","YSCLTST3",75,0)
 S ^TMP("YSCL",$J,3,0)=" Clozapine Lab Test file not properly defined."
"RTN","YSCLTST3",76,0)
 S ^TMP("YSCL",$J,4,0)=" Data cannot be transmitted!"
"RTN","YSCLTST3",77,0)
 S XMTEXT="^TMP(""YSCL"",$J,",XMDUZ="Clozapine MONITOR" D ^XMD
"RTN","YSCLTST3",78,0)
 G END^YSCLTST2
"RTN","YSCLTST3",79,0)
 Q
"RTN","YSCLTST3",80,0)
TLIST ;
"RTN","YSCLTST3",81,0)
 I '$D(^YSCL(603.04)) W !,"Patch YS*5.01*90 not properly installed.  Contact IRM" S DIR(0)="E" D ^DIR Q
"RTN","YSCLTST3",82,0)
 W !,"Currently linked Tests:" I '$O(^YSCL(603.04,1,1,0)) W !,"No tests linked",!
"RTN","YSCLTST3",83,0)
 S YSCLA=0
"RTN","YSCLTST3",84,0)
 F  S YSCLA=$O(^YSCL(603.04,1,1,YSCLA)) Q:'YSCLA  S YSCLB=^YSCL(603.04,1,1,YSCLA,0) D
"RTN","YSCLTST3",85,0)
  . W !,$P(^LAB(60,$P(YSCLB,"^"),0),"^")," represents " S YSCLB=$P(YSCLB,"^",2)
"RTN","YSCLTST3",86,0)
  . W $S(YSCLB="W":"WHITE BLOOD COUNT",YSCLB="A":"ABSOLUTE NEUTROPHIL COUNT",YSCLB="N":"NEUTROPHIL PERCENT",YSCLB="S":"SEGS %",YSCLB="B":"BANDS %",YSCLB="T":"BANDS ABSOLUTE",YSCLB="C":"SEGS ABSOLUTE",1:"Bad Record")
"RTN","YSCLTST3",87,0)
 F  K DIR S DIR(0)="PA^60:EMZ",DIR("A")="Enter the name of the test for Clozapine: " W ! D ^DIR Q:Y="^"!($D(DTOUT))!($D(DUOUT))  S YSCLTST=+Y D  Q:Y="^"!($D(DTOUT))!($D(DUOUT))
"RTN","YSCLTST3",88,0)
  . I $D(^YSCL(603.04,1,1,"B",YSCLTST)) G TEXIST
"RTN","YSCLTST3",89,0)
  . K DIR S DIR(0)="SA^W:WHITE BLOOD COUNT;A:ABSOLUTE NEUTROPHIL COUNT;N:NEUTROPHIL PERCENT;S:SEGS %;B:BANDS %;T:BANDS ABSOLUTE;C:SEGS ABSOLUTE"
"RTN","YSCLTST3",90,0)
  . S DIR("A")="Enter the type of the test for Clozapine: "  D ^DIR Q:Y["^"!($D(DTOUT))!($D(DUOUT))  S YSCLTS1=Y
"RTN","YSCLTST3",91,0)
  . K DIR S DIR(0)="SA^0:uL;1:K/uL;2:Percent"
"RTN","YSCLTST3",92,0)
  . S DIR("A")="Enter the reporting method of the test for Clozapine: "  D ^DIR Q:Y["^"!($D(DTOUT))!($D(DUOUT))  S YSCLTS2=Y
"RTN","YSCLTST3",93,0)
  . K YSCLERR
"RTN","YSCLTST3",94,0)
  . D VAL^DIE(603.41,"+1,1,",.01,"F","`"_YSCLTST,.YSCLRES,"FDA","YSCLERR")
"RTN","YSCLTST3",95,0)
  . I $D(YSCLERR) W !,"There was a problem with the data, please re-enter it" Q
"RTN","YSCLTST3",96,0)
  . D VAL^DIE(603.41,"+1,1,",1,"F",YSCLTS1,.YSCLRES,"FDA","YSCLERR")
"RTN","YSCLTST3",97,0)
  . I $D(YSCLERR) W !,"There was a problem with the data, please re-enter it" Q
"RTN","YSCLTST3",98,0)
  . D VAL^DIE(603.41,"+1,1,",2,"F",YSCLTS2,.YSCLRES,"FDA","YSCLERR")
"RTN","YSCLTST3",99,0)
  . I $D(YSCLERR) W !,"There was a problem with the data, please re-enter it" Q
"RTN","YSCLTST3",100,0)
  . D UPDATE^DIE(,"FDA",,"ERROR")
"RTN","YSCLTST3",101,0)
  . I $D(YSCLERR) W !,"There was a problem with the data, please re-enter it" Q
"RTN","YSCLTST3",102,0)
 Q
"RTN","YSCLTST3",103,0)
TEXIST ;
"RTN","YSCLTST3",104,0)
 W !,"This entry already exists.  Do you wish to delete it?" K DIR S DIR(0)="Y" D ^DIR Q:'Y!($D(DTOUT))!($D(DUOUT))
"RTN","YSCLTST3",105,0)
 S DA(1)=1,DA=$O(^YSCL(603.04,1,1,"B",YSCLTST,"")),DIE="^YSCL(603.04,1,1,",DR=".01////@" D ^DIE W !,"Deleted" S Y="" Q
"RTN","YSCLTST3",106,0)
 Q
"RTN","YSCLTST3",107,0)
END K %,C,D,DA,DFN,DISYS,DR,I,R,VADM,VAPA,VAERR,Y,YSCL,YSCL1,YSCL2,YSCLC,YSCLDEA,YSCLJ,YSCLLN,YSCLNAME,YSCLNO,YSCLP,^TMP($J),^TMP("YSCL",$J),^TMP("YSCLL",$J) Q
"RTN","YSCLTST3",108,0)
 Q
"RTN","YSCLTST3",109,0)
END1 ;
"RTN","YSCLTST3",110,0)
 K ^TMP($J),^TMP("YSCL",$J)
"RTN","YSCLTST3",111,0)
 K %,%DT,%H,%T,AGE,C,CNT,D,DA,DFN,DIE,DIK,DIR,DIROUT,DIRUT,DISYS,DOB,DR
"RTN","YSCLTST3",112,0)
 K DRG,DTOUT,DUOUT,I,IOF,J,K,LAB,LABT,PNM,POP,R,RESULTS1,SEX,SSN,VADM,VAERR,VAPA
"RTN","YSCLTST3",113,0)
 K X,X1,X2,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,Y,YSACT,YSCL,YSCL1,YSCL2,YSCL28,YSCLA,YSCLA1,YSCLAB
"RTN","YSCLTST3",114,0)
 K YSCLAB1,YSCLAB2,YSCLAB3,YSCLAB4,YSCLC,YSCLD,YSCLD0,YSCLD1,YSCLDAT1
"RTN","YSCLTST3",115,0)
 K YSCLDATA,YSCLDEA,YSCLDEMO,YSCLED,YSCLF,YSCLFF,YSCLFRQ,YSCLGL,YSCLGRN,YSCLI
"RTN","YSCLTST3",116,0)
 K YSCLID,YSCLIED,YSCLIEN,YSCLIF,YSCLJ,YSCLLAB,YSCLLD,YSCLLDFN,YSCLLDN
"RTN","YSCLTST3",117,0)
 K YSCLLDT,YSCLLK,YSCLLLN,YSCLLN,YSCLLO,YSCLM180,YSCLM28,YSCLM56,YSCLM7,YSCLMTCH,YSCLNAME
"RTN","YSCLTST3",118,0)
 K YSCLNO,YSCLNOW,YSCLNST1,YSCLNSTE,YSCLOVR,YSCLP,YSCLPHY,YSCLR,YSCLRES,YSCLRET,YSCLRWBC,YSCLRX
"RTN","YSCLTST3",119,0)
 K YSCLRX2,YSCLSAND,YSCLSB1,YSCLSD,YSCLSGS,YSCLSITE,YSCLSN,YSCLSP,YSCLT,YSCLTA,YSCLTDT,YSCLTEST
"RTN","YSCLTST3",120,0)
 K YSCLTL,YSCLTPT,YSCLTLS,YSCLTLS1,YSCLTS1,YSCLTST,YSCLTYPE,YSCLWBC,YSCLWBCC
"RTN","YSCLTST3",121,0)
 K YSCLWBCT,YSCLX,YSCLZ2,YSDEBUG,YSOFF,YSRACE,YSRC,YSSTOP,YSTEXT,ZTDESC
"RTN","YSCLTST3",122,0)
 K ZTDTH,ZTIO,ZTREQ,ZTRTN,ZTSAVE,ZTSTOP
"RTN","YSCLTST3",123,0)
 Q
"RTN","YSCLTST3",124,0)
ZEOR ;YSCLTST3
"VER")
8.0^22.0
"^DD",603.01,603.01,0)
FIELD^^3^4
"^DD",603.01,603.01,0,"DT")
3060307
"^DD",603.01,603.01,0,"IX","B",603.01,.01)

"^DD",603.01,603.01,0,"IX","C",603.01,1)

"^DD",603.01,603.01,0,"NM","CLOZAPINE PATIENT LIST")

"^DD",603.01,603.01,0,"VRPK")
YS
"^DD",603.01,603.01,.01,0)
CLOZAPINE REGISTRATION NUMBER^RF^^0;1^K:$L(X)>7!($L(X)<7) X
"^DD",603.01,603.01,.01,1,0)
^.1
"^DD",603.01,603.01,.01,1,1,0)
603.01^B
"^DD",603.01,603.01,.01,1,1,1)
S ^YSCL(603.01,"B",$E(X,1,30),DA)=""
"^DD",603.01,603.01,.01,1,1,2)
K ^YSCL(603.01,"B",$E(X,1,30),DA)
"^DD",603.01,603.01,.01,3)
Answer must be 7 characters in length.
"^DD",603.01,603.01,.01,21,0)
^^3^3^3060315^
"^DD",603.01,603.01,.01,21,1,0)
The Clozapine registration number is assigned by the manufacturer.  It is 
"^DD",603.01,603.01,.01,21,2,0)
maintained and authorized by the NCCC in Dallas. Refer all questions 
"^DD",603.01,603.01,.01,21,3,0)
regarding this number to the NCCC.
"^DD",603.01,603.01,.01,"DT")
3060315
"^DD",603.01,603.01,1,0)
CLOZAPINE PATIENT^RP2'^DPT(^0;2^Q
"^DD",603.01,603.01,1,1,0)
^.1
"^DD",603.01,603.01,1,1,1,0)
603.01^C
"^DD",603.01,603.01,1,1,1,1)
S ^YSCL(603.01,"C",$E(X,1,30),DA)=""
"^DD",603.01,603.01,1,1,1,2)
K ^YSCL(603.01,"C",$E(X,1,30),DA)
"^DD",603.01,603.01,1,1,1,"DT")
2940412
"^DD",603.01,603.01,1,21,0)
^^2^2^3060315^
"^DD",603.01,603.01,1,21,1,0)
This is a pointer to the Patient (#2) file.  The patient must be 
"^DD",603.01,603.01,1,21,2,0)
authorized by the NCCC in Dallas before treatment is started.
"^DD",603.01,603.01,1,"DT")
3060315
"^DD",603.01,603.01,2,0)
DISPENSE FREQUENCY^S^W:WEEKLY;B:BI-WEEKLY;M:MONTHLY;^0;3^Q
"^DD",603.01,603.01,2,3)
Enter "M" if patient is authorized for Monthly, "B" if patient is authorized for Bi-Weekly Clozapine prescription, "W" if prescriptions must be written weekly.
"^DD",603.01,603.01,2,21,0)
^.001^2^2^3050615^^^^
"^DD",603.01,603.01,2,21,1,0)
This field indicates whether a patient is authorized for a weekly or
"^DD",603.01,603.01,2,21,2,0)
biweekly Clozapine dosage.
"^DD",603.01,603.01,2,"DT")
3050615
"^DD",603.01,603.01,3,0)
OVERRIDE DATE^D^^0;4^S %DT="E" D ^%DT S X=Y K:X<1 X
"^DD",603.01,603.01,3,3)
Enter the date to allow an over-ride.
"^DD",603.01,603.01,3,21,0)
^^1^1^3060307^
"^DD",603.01,603.01,3,21,1,0)
This field contains the specific date when an override will be allowed for this patient.  This date should only be manipulated by the NCCC.
"^DD",603.01,603.01,3,"DT")
3060307
"^DD",603.03,603.03,0)
FIELD^^7^7
"^DD",603.03,603.03,0,"DDA")
N
"^DD",603.03,603.03,0,"DT")
3050620
"^DD",603.03,603.03,0,"IX","B",603.03,.01)

"^DD",603.03,603.03,0,"NM","CLOZAPINE PARAMETERS")

"^DD",603.03,603.03,0,"VRPK")
YS
"^DD",603.03,603.03,.01,0)
NAME^RSX^CLOZAPINE:CLOZAPINE;^0;1^I +$G(DA)'=1 K X W !,"Only one entry may exist."
"^DD",603.03,603.03,.01,1,0)
^.1
"^DD",603.03,603.03,.01,1,1,0)
603.03^B
"^DD",603.03,603.03,.01,1,1,1)
S ^YSCL(603.03,"B",$E(X,1,30),DA)=""
"^DD",603.03,603.03,.01,1,1,2)
K ^YSCL(603.03,"B",$E(X,1,30),DA)
"^DD",603.03,603.03,.01,3)
This field should always equal CLOZAPINE
"^DD",603.03,603.03,.01,21,0)
^.001^2^2^3001220^^^
"^DD",603.03,603.03,.01,21,1,0)
This file will hold the configuration parameters for the Clozapine
"^DD",603.03,603.03,.01,21,2,0)
reporting system.
"^DD",603.03,603.03,.01,"DT")
3001115
"^DD",603.03,603.03,2,0)
TRANSMISSION DAY^RS^SUNDAY:SUNDAY;MONDAY:MONDAY;TUESDAY:TUESDAY;WEDNESDAY:WEDNESDAY;THURSDAY:THURSDAY;FRIDAY:FRIDAY;SATURDAY:SATURDAY;^0;2^Q
"^DD",603.03,603.03,2,3)
Enter the day of the week when transmission should occur.
"^DD",603.03,603.03,2,21,0)
^^3^3^3010412^
"^DD",603.03,603.03,2,21,1,0)
This is the day of the week when the transmission should occur.  Normally
"^DD",603.03,603.03,2,21,2,0)
this is set to TUESDAY, but may be changed to accommodate special
"^DD",603.03,603.03,2,21,3,0)
circumstances.
"^DD",603.03,603.03,2,"DT")
3001115
"^DD",603.03,603.03,3,0)
DEBUG MODE^S^0:OFF;1:ON;^0;3^Q
"^DD",603.03,603.03,3,"DT")
3010412
"^DD",603.03,603.03,4,0)
TRANSMISSION START^D^^0;4^S %DT="EST" D ^%DT S X=Y K:X<1 X
"^DD",603.03,603.03,4,3)
Enter the date and time that the transmission started.
"^DD",603.03,603.03,4,21,0)
^.001^1^1^3001218^^
"^DD",603.03,603.03,4,21,1,0)
This is the start date and time of the most recent transmission.
"^DD",603.03,603.03,4,"DT")
3001115
"^DD",603.03,603.03,5,0)
TRANSMISSION END^D^^0;5^S %DT="EST" D ^%DT S X=Y K:X<1 X
"^DD",603.03,603.03,5,3)
Enter the date/time when the transmission completed.
"^DD",603.03,603.03,5,21,0)
^^1^1^3001218^
"^DD",603.03,603.03,5,21,1,0)
This is the date and time when the most recent transmission was completed.
"^DD",603.03,603.03,5,"DT")
3001115
"^DD",603.03,603.03,6,0)
LAST DEMOGRAPHICS TRANSMISSION^D^^0;6^S %DT="EST" D ^%DT S X=Y K:X<1 X
"^DD",603.03,603.03,6,3)
Enter the date and time of the last demographics transmission.
"^DD",603.03,603.03,6,21,0)
^^2^2^3001218^
"^DD",603.03,603.03,6,21,1,0)
This is the date and time when the most recent demographics transmission
"^DD",603.03,603.03,6,21,2,0)
was completed.
"^DD",603.03,603.03,6,"DT")
3001115
"^DD",603.03,603.03,7,0)
LOCK DOWN^RS^1:YES;0:NO;^1;1^Q
"^DD",603.03,603.03,7,3)
Used to determine if site is allowed to dispense.
"^DD",603.03,603.03,7,"DT")
3050620
"^DD",603.04,603.04,0)
FIELD^^1^2
"^DD",603.04,603.04,0,"DDA")
N
"^DD",603.04,603.04,0,"DT")
3060628
"^DD",603.04,603.04,0,"IX","B",603.04,.01)

"^DD",603.04,603.04,0,"NM","CLOZAPINE TESTS")

"^DD",603.04,603.04,.01,0)
NAME^RFXI^^0;1^K X W !,"ONLY ONE ENTRY IS ALLOWED"
"^DD",603.04,603.04,.01,1,0)
^.1
"^DD",603.04,603.04,.01,1,1,0)
603.04^B
"^DD",603.04,603.04,.01,1,1,1)
S ^YSCL(603.04,"B",$E(X,1,30),DA)=""
"^DD",603.04,603.04,.01,1,1,2)
K ^YSCL(603.04,"B",$E(X,1,30),DA)
"^DD",603.04,603.04,.01,3)
NAME MUST BE CLOZAPINE. ONLY ONE ENTRY IS ALLOWED.
"^DD",603.04,603.04,.01,21,0)
^^1^1^3060314^^
"^DD",603.04,603.04,.01,21,1,0)
This field should contain the word CLOZAPINE.
"^DD",603.04,603.04,.01,"DT")
3060314
"^DD",603.04,603.04,1,0)
TEST NAME^603.41P^^1;0
"^DD",603.04,603.04,1,21,0)
^^5^5^3060314^
"^DD",603.04,603.04,1,21,1,0)
This is the name of the test associated with Clozapine.  A White Blood 
"^DD",603.04,603.04,1,21,2,0)
Count and a method of determining the Neutorphil Count must be entered.  
"^DD",603.04,603.04,1,21,3,0)
You may enter as many of each as are appropriate.  The Neutorphil count 
"^DD",603.04,603.04,1,21,4,0)
may be and absolute count, a percentage, or the BANDS and SEGS.  If BANDS 
"^DD",603.04,603.04,1,21,5,0)
and SEGS are entered, a separate test must be entered for each.
"^DD",603.04,603.41,0)
TEST NAME SUB-FIELD^^2^3
"^DD",603.04,603.41,0,"DT")
3060628
"^DD",603.04,603.41,0,"IX","B",603.41,.01)

"^DD",603.04,603.41,0,"NM","TEST NAME")

"^DD",603.04,603.41,0,"UP")
603.04
"^DD",603.04,603.41,.01,0)
TEST NAME^MP60'^LAB(60,^0;1^Q
"^DD",603.04,603.41,.01,1,0)
^.1^^-1
"^DD",603.04,603.41,.01,1,1,0)
603.41^B
"^DD",603.04,603.41,.01,1,1,1)
S ^YSCL(603.04,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",603.04,603.41,.01,1,1,2)
K ^YSCL(603.04,DA(1),1,"B",$E(X,1,30),DA)
"^DD",603.04,603.41,.01,3)
Enter the name of the test associated with Clozapine,
"^DD",603.04,603.41,.01,21,0)
^^5^5^3060314^
"^DD",603.04,603.41,.01,21,1,0)
This is the name of the test associated with Clozapine.  A White Blood 
"^DD",603.04,603.41,.01,21,2,0)
Count and a method of determining the Neutorphil Count must be entered.  
"^DD",603.04,603.41,.01,21,3,0)
You may enter as many of each as are appropriate.  The Neutorphil count 
"^DD",603.04,603.41,.01,21,4,0)
may be and absolute count, a percentage, or the BANDS and SEGS.  If BANDS 
"^DD",603.04,603.41,.01,21,5,0)
and SEGS are entered, a separate test must be entered for each.
"^DD",603.04,603.41,.01,"DT")
3060314
"^DD",603.04,603.41,1,0)
TEST TYPE^RS^W:WHITE BLOOD COUNT;A:ABSOLUTE NEUTROPHIL COUNT;N:NEUTROPHIL PERCENT;S:SEGS %;B:BANDS %;T:BANDS ABSOLUTE;C:SEGS ABSOLUTE;^0;2^Q
"^DD",603.04,603.41,1,3)
Enter the type (WBC, ANC, SEGS, BANDS) associated with the TEST NAME field.
"^DD",603.04,603.41,1,21,0)
^^3^3^3060314^
"^DD",603.04,603.41,1,21,1,0)
This is the type of the test associated with Clozapine.  The choices are: 
"^DD",603.04,603.41,1,21,2,0)
WHITE BLOOD COUNT, ABSOLUTE NEUTROPHIL COUNT, NEUTROPHIL PERCENT, SEGS,
"^DD",603.04,603.41,1,21,3,0)
and BANDS.  The type must match the test entered in the TEST NAME field.
"^DD",603.04,603.41,1,"DT")
3060320
"^DD",603.04,603.41,2,0)
REPORTING FORMAT^RS^0:Units;1:K/units;2:Percentage;^0;3^Q
"^DD",603.04,603.41,2,21,0)
^^4^4^3060619^
"^DD",603.04,603.41,2,21,1,0)
Most sites report WBC and Neutorphil results in K/unit format (K/cc or 
"^DD",603.04,603.41,2,21,2,0)
K/cu mm or K/mm-3 or K/mL). For example, WBC equals 5.1.  However, some
"^DD",603.04,603.41,2,21,3,0)
report results as discrete units. For example, WBC equals 5100.  This
"^DD",603.04,603.41,2,21,4,0)
field will allow the site to specify how results are reported.
"^DD",603.04,603.41,2,"DT")
3060628
"^DIC",603.01,603.01,0)
CLOZAPINE PATIENT LIST^603.01
"^DIC",603.01,603.01,0,"GL")
^YSCL(603.01,
"^DIC",603.01,603.01,"%",0)
^1.005^^
"^DIC",603.01,603.01,"%D",0)
^^2^2^2981130^
"^DIC",603.01,603.01,"%D",1,0)
This is a list of patients authorized to receive Clozapine.  This list is
"^DIC",603.01,603.01,"%D",2,0)
maintained by the National Clozapine Coordinating Center (NCCC) in Dallas.
"^DIC",603.01,"B","CLOZAPINE PATIENT LIST",603.01)

"^DIC",603.03,603.03,0)
CLOZAPINE PARAMETERS^603.03
"^DIC",603.03,603.03,0,"GL")
^YSCL(603.03,
"^DIC",603.03,603.03,"%",0)
^1.005^^0
"^DIC",603.03,603.03,"%D",0)
^^11^11^3010412^
"^DIC",603.03,603.03,"%D",1,0)
This file contains various parameters for the Clozapine rollup.  No option
"^DIC",603.03,603.03,"%D",2,0)
is assigned for the sites to manipulate the data. This file is used and
"^DIC",603.03,603.03,"%D",3,0)
maintained by the National Clozapine Coordinating Center (NCCC) through
"^DIC",603.03,603.03,"%D",4,0)
the YSCLSERVER option.  The TRANSMISSION DAY field forces all of the sites
"^DIC",603.03,603.03,"%D",5,0)
to transmit on the same day, in the past we had to allow scattered
"^DIC",603.03,603.03,"%D",6,0)
reporting due to network limits.  We no longer have this problem.  All
"^DIC",603.03,603.03,"%D",7,0)
transmissions will occur on Tuesday unless the NCCC in Dallas wishes to
"^DIC",603.03,603.03,"%D",8,0)
change the day.  The DEBUG MODE field allows data to be transmitted to a
"^DIC",603.03,603.03,"%D",9,0)
test location without contaminating the database in Hines. The three date
"^DIC",603.03,603.03,"%D",10,0)
fields TRANSMISSION START, TRANSMISSION END and LAST DEMOGRAPHICS
"^DIC",603.03,603.03,"%D",11,0)
TRANSMISSION report back to the NCCC through the server.
"^DIC",603.03,"B","CLOZAPINE PARAMETERS",603.03)

"^DIC",603.04,603.04,0)
CLOZAPINE TESTS^603.04
"^DIC",603.04,603.04,0,"GL")
^YSCL(603.04,
"^DIC",603.04,603.04,"%",0)
^1.005^^
"^DIC",603.04,603.04,"%D",0)
^^2^2^3060905^
"^DIC",603.04,603.04,"%D",1,0)
This file must be populated with the tests used for the WBC and Neutrpohil
"^DIC",603.04,603.04,"%D",2,0)
counts associated with Clozapine.
"^DIC",603.04,"B","CLOZAPINE TESTS",603.04)

"BLD",6093,6)
^75
**END**
**END**
