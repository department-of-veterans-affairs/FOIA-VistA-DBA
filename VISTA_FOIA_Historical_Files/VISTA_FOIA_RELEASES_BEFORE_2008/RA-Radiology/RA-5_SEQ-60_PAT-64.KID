Released RA*5*64 SEQ #60
Extracted from mail message
**KIDS**:RA*5.0*64^

**INSTALL NAME**
RA*5.0*64
"BLD",5940,0)
RA*5.0*64^RADIOLOGY/NUCLEAR MEDICINE^0^3060627^y
"BLD",5940,1,0)
^^2^2^3060627^^^
"BLD",5940,1,1,0)
Please refer to the patch description in FORUM regarding the installation
"BLD",5940,1,2,0)
of RA*5.0*64.
"BLD",5940,4,0)
^9.64PA^79.2^1
"BLD",5940,4,79.2,0)
79.2
"BLD",5940,4,79.2,2,0)
^9.641^79.22^1
"BLD",5940,4,79.2,2,79.22,0)
WORK RVU (wRVU) SCALING FACTOR  (sub-file)
"BLD",5940,4,79.2,2,79.22,1,0)
^9.6411^^0
"BLD",5940,4,79.2,222)
y^n^p^^^^n^^n
"BLD",5940,4,79.2,224)

"BLD",5940,4,"APDD",79.2,79.22)

"BLD",5940,4,"B",79.2,79.2)

"BLD",5940,6.3)
5
"BLD",5940,"ABPKG")
n
"BLD",5940,"INI")
RA64PRE
"BLD",5940,"INIT")
RA64PST
"BLD",5940,"KRN",0)
^9.67PA^8989.52^19
"BLD",5940,"KRN",.4,0)
.4
"BLD",5940,"KRN",.401,0)
.401
"BLD",5940,"KRN",.402,0)
.402
"BLD",5940,"KRN",.403,0)
.403
"BLD",5940,"KRN",.5,0)
.5
"BLD",5940,"KRN",.84,0)
.84
"BLD",5940,"KRN",3.6,0)
3.6
"BLD",5940,"KRN",3.8,0)
3.8
"BLD",5940,"KRN",9.2,0)
9.2
"BLD",5940,"KRN",9.8,0)
9.8
"BLD",5940,"KRN",9.8,"NM",0)
^9.68A^8^7
"BLD",5940,"KRN",9.8,"NM",1,0)
RAWRVUP^^0^B28533070
"BLD",5940,"KRN",9.8,"NM",3,0)
RAWKLU^^0^B43942290
"BLD",5940,"KRN",9.8,"NM",4,0)
RAWKLU1^^0^B32092526
"BLD",5940,"KRN",9.8,"NM",5,0)
RAWKLU2^^0^B37550729
"BLD",5940,"KRN",9.8,"NM",6,0)
RAWKLU3^^0^B12473282
"BLD",5940,"KRN",9.8,"NM",7,0)
RA64PST^^0^B4334607
"BLD",5940,"KRN",9.8,"NM",8,0)
RA64PRE^^0^B6590378
"BLD",5940,"KRN",9.8,"NM","B","RA64PRE",8)

"BLD",5940,"KRN",9.8,"NM","B","RA64PST",7)

"BLD",5940,"KRN",9.8,"NM","B","RAWKLU",3)

"BLD",5940,"KRN",9.8,"NM","B","RAWKLU1",4)

"BLD",5940,"KRN",9.8,"NM","B","RAWKLU2",5)

"BLD",5940,"KRN",9.8,"NM","B","RAWKLU3",6)

"BLD",5940,"KRN",9.8,"NM","B","RAWRVUP",1)

"BLD",5940,"KRN",19,0)
19
"BLD",5940,"KRN",19,"NM",0)
^9.68A^10^9
"BLD",5940,"KRN",19,"NM",1,0)
RA SPECRPTS^^2
"BLD",5940,"KRN",19,"NM",3,0)
RA PROC CPTWRVU^^0
"BLD",5940,"KRN",19,"NM",4,0)
RA PROC CPTSWRVU^^0
"BLD",5940,"KRN",19,"NM",5,0)
RA WKLIPHY CPT ITYPE^^0
"BLD",5940,"KRN",19,"NM",6,0)
RA WKLIPHY SWRVU ITYPE^^0
"BLD",5940,"KRN",19,"NM",7,0)
RA WKLIPHY WRVU ITYPE^^0
"BLD",5940,"KRN",19,"NM",8,0)
RA WKLIPHY WRVU CPT^^0
"BLD",5940,"KRN",19,"NM",9,0)
RA WKLIPHY SWRVU CPT^^0
"BLD",5940,"KRN",19,"NM",10,0)
RA WKL^^2
"BLD",5940,"KRN",19,"NM","B","RA PROC CPTSWRVU",4)

"BLD",5940,"KRN",19,"NM","B","RA PROC CPTWRVU",3)

"BLD",5940,"KRN",19,"NM","B","RA SPECRPTS",1)

"BLD",5940,"KRN",19,"NM","B","RA WKL",10)

"BLD",5940,"KRN",19,"NM","B","RA WKLIPHY CPT ITYPE",5)

"BLD",5940,"KRN",19,"NM","B","RA WKLIPHY SWRVU CPT",9)

"BLD",5940,"KRN",19,"NM","B","RA WKLIPHY SWRVU ITYPE",6)

"BLD",5940,"KRN",19,"NM","B","RA WKLIPHY WRVU CPT",8)

"BLD",5940,"KRN",19,"NM","B","RA WKLIPHY WRVU ITYPE",7)

"BLD",5940,"KRN",19.1,0)
19.1
"BLD",5940,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5940,"KRN",101,0)
101
"BLD",5940,"KRN",409.61,0)
409.61
"BLD",5940,"KRN",771,0)
771
"BLD",5940,"KRN",870,0)
870
"BLD",5940,"KRN",8989.51,0)
8989.51
"BLD",5940,"KRN",8989.52,0)
8989.52
"BLD",5940,"KRN",8994,0)
8994
"BLD",5940,"KRN","B",.4,.4)

"BLD",5940,"KRN","B",.401,.401)

"BLD",5940,"KRN","B",.402,.402)

"BLD",5940,"KRN","B",.403,.403)

"BLD",5940,"KRN","B",.5,.5)

"BLD",5940,"KRN","B",.84,.84)

"BLD",5940,"KRN","B",3.6,3.6)

"BLD",5940,"KRN","B",3.8,3.8)

"BLD",5940,"KRN","B",9.2,9.2)

"BLD",5940,"KRN","B",9.8,9.8)

"BLD",5940,"KRN","B",19,19)

"BLD",5940,"KRN","B",19.1,19.1)

"BLD",5940,"KRN","B",101,101)

"BLD",5940,"KRN","B",409.61,409.61)

"BLD",5940,"KRN","B",771,771)

"BLD",5940,"KRN","B",870,870)

"BLD",5940,"KRN","B",8989.51,8989.51)

"BLD",5940,"KRN","B",8989.52,8989.52)

"BLD",5940,"KRN","B",8994,8994)

"BLD",5940,"QUES",0)
^9.62^^
"BLD",5940,"REQB",0)
^9.611^1^1
"BLD",5940,"REQB",1,0)
FB*3.5*93^2
"BLD",5940,"REQB","B","FB*3.5*93",1)

"FIA",79.2)
IMAGING TYPE
"FIA",79.2,0)
^RA(79.2,
"FIA",79.2,0,0)
79.2
"FIA",79.2,0,1)
y^n^p^^^^n^^n
"FIA",79.2,0,10)

"FIA",79.2,0,11)

"FIA",79.2,0,"RLRO")

"FIA",79.2,0,"VR")
5.0^RA
"FIA",79.2,79.2)
1
"FIA",79.2,79.2,200)

"FIA",79.2,79.22)
0
"INI")
RA64PRE
"INIT")
RA64PST
"KRN",19,1697,-1)
2^10
"KRN",19,1697,0)
RA WKL^Personnel Workload Reports^^M^^^^^^^^
"KRN",19,1697,10,0)
^19.01IP^14^11
"KRN",19,1697,10,10,0)
12454^
"KRN",19,1697,10,10,"^")
RA WKLIPHY CPT ITYPE
"KRN",19,1697,10,11,0)
12455
"KRN",19,1697,10,11,"^")
RA WKLIPHY SWRVU ITYPE
"KRN",19,1697,10,12,0)
12456
"KRN",19,1697,10,12,"^")
RA WKLIPHY WRVU ITYPE
"KRN",19,1697,10,13,0)
12475
"KRN",19,1697,10,13,"^")
RA WKLIPHY WRVU CPT
"KRN",19,1697,10,14,0)
12476
"KRN",19,1697,10,14,"^")
RA WKLIPHY SWRVU CPT
"KRN",19,1697,"U")
PERSONNEL WORKLOAD REPORTS
"KRN",19,1754,-1)
2^1
"KRN",19,1754,0)
RA SPECRPTS^Special Reports^^M^^^^^^^^18
"KRN",19,1754,10,0)
^19.01IP^11^11
"KRN",19,1754,10,10,0)
12453^^
"KRN",19,1754,10,10,"^")
RA PROC CPTWRVU
"KRN",19,1754,10,11,0)
12465^^
"KRN",19,1754,10,11,"^")
RA PROC CPTSWRVU
"KRN",19,1754,"U")
SPECIAL REPORTS
"KRN",19,12453,-1)
0^3
"KRN",19,12453,0)
RA PROC CPTWRVU^Procedure wRVU/CPT Report^^R^^^^^^^y^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,12453,1,0)
^^4^4^3051214^
"KRN",19,12453,1,1,0)
This option will print data from the RAD/NUC MED PROCEDURES (#71) file 
"KRN",19,12453,1,2,0)
for series and detailed procedures. The data elements displayed will be:
"KRN",19,12453,1,3,0)
procedure name, type of procedure, imaging type, CPT Code, and the
"KRN",19,12453,1,4,0)
un-scaled wRVU value.
"KRN",19,12453,25)
EN^RAWRVUP(0)
"KRN",19,12453,"U")
PROCEDURE WRVU/CPT REPORT
"KRN",19,12454,-1)
0^5
"KRN",19,12454,0)
RA WKLIPHY CPT ITYPE^Physician CPT Report by Imaging Type^^R^^^^^^^y^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,12454,1,0)
^19.06^3^3^3051228^^
"KRN",19,12454,1,1,0)
This option will display the total number of imaging type specific
"KRN",19,12454,1,2,0)
procedures (CPTs) performed by an interpreting staff physician 
"KRN",19,12454,1,3,0)
over a user defined date range.
"KRN",19,12454,25)
EN^RAWKLU("CPT","")
"KRN",19,12454,"U")
PHYSICIAN CPT REPORT BY IMAGIN
"KRN",19,12455,-1)
0^6
"KRN",19,12455,0)
RA WKLIPHY SWRVU ITYPE^Physician scaled wRVU Report by Imaging Type^^R^^^^^^^y^
"KRN",19,12455,1,0)
^19.06^16^16^3051209^^^
"KRN",19,12455,1,1,0)
This option will display the total number of scaled wRVU units attributed 
"KRN",19,12455,1,2,0)
to an interpreting staff physician within imaging type over a user defined
"KRN",19,12455,1,3,0)
date range.
"KRN",19,12455,1,4,0)
 
"KRN",19,12455,1,5,0)
wRVU is a measure of the time and effort associated with the performance
"KRN",19,12455,1,6,0)
of a given procedure. wRVU is a unit that is associated with an imaging
"KRN",19,12455,1,7,0)
type and is applied to all procedures performed by an interpreting staff 
"KRN",19,12455,1,8,0)
physician within that imaging type.
"KRN",19,12455,1,9,0)
 
"KRN",19,12455,1,10,0)
For certain imaging types, the RVU may over-estimate or under-estimate 
"KRN",19,12455,1,11,0)
efforts of interpreting images and reports. To correct this under or over 
"KRN",19,12455,1,12,0)
reporting of interpreting staff physician workload, the wRVU scaling 
"KRN",19,12455,1,13,0)
factor will be applied to the regular wRVU.
"KRN",19,12455,1,14,0)
 
"KRN",19,12455,1,15,0)
The report will show the scaled wRVU for interpreting staff physician 
"KRN",19,12455,1,16,0)
within imaging type, their sutotals and grand total.
"KRN",19,12455,25)
EN^RAWKLU("RVU",1)
"KRN",19,12455,"U")
PHYSICIAN SCALED WRVU REPORT B
"KRN",19,12456,-1)
0^7
"KRN",19,12456,0)
RA WKLIPHY WRVU ITYPE^Physician wRVU Report by Imaging Type^^R^^^^^^^y^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,12456,1,0)
^19.06^11^11^3051129^^
"KRN",19,12456,1,1,0)
This option will display the total number of wRVU units attributed 
"KRN",19,12456,1,2,0)
to an interpreting staff physician within imaging type over a user 
"KRN",19,12456,1,3,0)
defined date range.
"KRN",19,12456,1,4,0)
 
"KRN",19,12456,1,5,0)
wRVU is a measure of the time and effort associated with the performance
"KRN",19,12456,1,6,0)
of a given procedure. wRVU is a unit that is associated with an imaging 
"KRN",19,12456,1,7,0)
type and is applied to all procedures performed by an interpreting staff 
"KRN",19,12456,1,8,0)
physician within that imaging type.
"KRN",19,12456,1,9,0)
 
"KRN",19,12456,1,10,0)
This report will show the wRVU for interpreting staff physician within 
"KRN",19,12456,1,11,0)
imaging type, their subtotals and grand total.
"KRN",19,12456,25)
EN^RAWKLU("RVU",0)
"KRN",19,12456,"U")
PHYSICIAN WRVU REPORT BY IMAGI
"KRN",19,12465,-1)
0^4
"KRN",19,12465,0)
RA PROC CPTSWRVU^Procedure Scaled wRVU/CPT Report^^R^^^^^^^y^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,12465,1,0)
^^4^4^3051214^
"KRN",19,12465,1,1,0)
This option will print data from the RAD/NUC MED PROCEDURES (#71) file 
"KRN",19,12465,1,2,0)
for series and detailed procedures. The data elements displayed will be:
"KRN",19,12465,1,3,0)
procedure name, type of procedure, imaging type, CPT Code, and the
"KRN",19,12465,1,4,0)
scaled wRVU value.
"KRN",19,12465,25)
EN^RAWRVUP(1)
"KRN",19,12465,"U")
PROCEDURE SCALED WRVU/CPT REPO
"KRN",19,12475,-1)
0^8
"KRN",19,12475,0)
RA WKLIPHY WRVU CPT^Physician wRVU Report by CPT^^R^^^^^^^y^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,12475,1,0)
^^6^6^3051221^
"KRN",19,12475,1,1,0)
This option allows the user to select the physicians to be included and
"KRN",19,12475,1,2,0)
the timeframe the report is to include. For each physician, the procedure
"KRN",19,12475,1,3,0)
CPT and name is displayed, the number of instances of a procedure, and the
"KRN",19,12475,1,4,0)
total wRVU value for that procedure are totaled and displayed.
"KRN",19,12475,1,5,0)
 
"KRN",19,12475,1,6,0)
Overall exam and wRVU totals per physician are also displayed.
"KRN",19,12475,25)
EN^RAWKLU2(0)
"KRN",19,12475,"U")
PHYSICIAN WRVU REPORT BY CPT
"KRN",19,12476,-1)
0^9
"KRN",19,12476,0)
RA WKLIPHY SWRVU CPT^Physician scaled wRVU Report by CPT^^R^^^^^^^y^RADIOLOGY/NUCLEAR MEDICINE
"KRN",19,12476,1,0)
^^6^6^3051221^
"KRN",19,12476,1,1,0)
This option allows the user to select the physicians to be included and 
"KRN",19,12476,1,2,0)
the timeframe the report is to include. For each physician, the procedure 
"KRN",19,12476,1,3,0)
CPT and name is displayed, the number of instances of a procedure, and 
"KRN",19,12476,1,4,0)
the total scaled wRVU value for that procedure are totaled and displayed.
"KRN",19,12476,1,5,0)
 
"KRN",19,12476,1,6,0)
Overall exam and scaled wRVU totals per physician are also displayed.
"KRN",19,12476,25)
EN^RAWKLU2(1)
"KRN",19,12476,"U")
PHYSICIAN SCALED WRVU REPORT B
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",18,-1)
1^1
"PKG",18,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",18,20,0)
^9.402P^^
"PKG",18,22,0)
^9.49I^1^1
"PKG",18,22,1,0)
5.0^3051109^2980407^50
"PKG",18,22,1,"PAH",1,0)
64^3060627
"PKG",18,22,1,"PAH",1,1,0)
^^2^2^3060627
"PKG",18,22,1,"PAH",1,1,1,0)
Please refer to the patch description in FORUM regarding the installation
"PKG",18,22,1,"PAH",1,1,2,0)
of RA*5.0*64.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","RA64PRE")
0^8^B6590378^n/a
"RTN","RA64PRE",1,0)
RA64PRE ;Hines OI/GJC - Pre-init Driver, patch 64 ;01/05/06  06:32
"RTN","RA64PRE",2,0)
VERSION ;;5.0;Radiology/Nuclear Medicine;**64**;Mar 16, 1998;Build 5
"RTN","RA64PRE",3,0)
 ;
"RTN","RA64PRE",4,0)
EN ; entry point for the pre-install logic
"RTN","RA64PRE",5,0)
 N RACHK
"RTN","RA64PRE",6,0)
 S RACHK=$$NEWCP^XPDUTL("PRE1","EN1^RA64PRE")
"RTN","RA64PRE",7,0)
 ; Change the Menu Text (#1) field for the following options:
"RTN","RA64PRE",8,0)
 ;
"RTN","RA64PRE",9,0)
 ;IA: 10075 Read OPTION (#19) file NAME (#.01) w/FileMan
"RTN","RA64PRE",10,0)
 ;
"RTN","RA64PRE",11,0)
 ;Option Name
"RTN","RA64PRE",12,0)
 ;-----------
"RTN","RA64PRE",13,0)
 ;RA WKLIPHY CPT ITYPE
"RTN","RA64PRE",14,0)
 ; from: Physician CPT Report by I-Type
"RTN","RA64PRE",15,0)
 ;   to: Physician CPT Report by Imaging Type
"RTN","RA64PRE",16,0)
 ;RA WKLIPHY SWRVU ITYPE
"RTN","RA64PRE",17,0)
 ; from: Physician scaled wRVU Report by I-Type
"RTN","RA64PRE",18,0)
 ;   to: Physician scaled wRVU Report by Imaging Type
"RTN","RA64PRE",19,0)
 ;RA WKLIPHY WRVU ITYPE
"RTN","RA64PRE",20,0)
 ; from: Physician wRVU Report by I-Type
"RTN","RA64PRE",21,0)
 ;   to: Physician wRVU Report by Imaging Type
"RTN","RA64PRE",22,0)
 ;
"RTN","RA64PRE",23,0)
 ;
"RTN","RA64PRE",24,0)
EN1 ;Change the Menu Text for the options mentioned above.
"RTN","RA64PRE",25,0)
 ;If RA*5.0*64 has not been installed, exit the pre-install routine. The
"RTN","RA64PRE",26,0)
 ;exporting of the options with the install of RA*5.0*64 will lay in the
"RTN","RA64PRE",27,0)
 ;correct MENU TEXT definitions.
"RTN","RA64PRE",28,0)
 K RARVU D FIELD^DID(79.2,200,,"LABEL","RARVU")
"RTN","RA64PRE",29,0)
 Q:'$D(RARVU("LABEL"))#2
"RTN","RA64PRE",30,0)
 ;
"RTN","RA64PRE",31,0)
 K RAI,RAFDA,RAIEN,RAMSG,RARVU,RATXT,RAX
"RTN","RA64PRE",32,0)
 F RAI=1:1 S RAX=$T(MENUTXT+RAI) Q:$P(RAX,";",3)=""  D
"RTN","RA64PRE",33,0)
 .S RAIEN=+$$FIND1^DIC(19,,"Q",$P(RAX,";",3))
"RTN","RA64PRE",34,0)
 .I 'RAIEN D  Q
"RTN","RA64PRE",35,0)
 ..S RATXT(1)="'"_$P(RAX,";",3)_"' not found in the OPTION (#19) file."
"RTN","RA64PRE",36,0)
 ..S RATXT(2)=" " D BMES^XPDUTL(.RATXT) K RATXT
"RTN","RA64PRE",37,0)
 ..Q
"RTN","RA64PRE",38,0)
 .Q:$$GET1^DIQ(19,RAIEN,1)=$P(RAX,";",5)  ;MENU TEXT update in the past
"RTN","RA64PRE",39,0)
 .S RATXT(1)="Changing the MENU TEXT (#1) field of OPTION: "_$P(RAX,";",3)
"RTN","RA64PRE",40,0)
 .S RATXT(2)="From: "_$P(RAX,";",4)
"RTN","RA64PRE",41,0)
 .S RATXT(3)="  To: "_$P(RAX,";",5),RATXT(4)=" "
"RTN","RA64PRE",42,0)
 .D BMES^XPDUTL(.RATXT) K RATXT
"RTN","RA64PRE",43,0)
 .S RAFDA(19,RAIEN_",",1)=$P(RAX,";",5)
"RTN","RA64PRE",44,0)
 .D UPDATE^DIE("E","RAFDA","","RAMSG(1)") K RAFDA
"RTN","RA64PRE",45,0)
 .S RATXT(1)="The MENU TEXT update was "_$S($D(RAMSG(1,"DIERR"))#2:"un",1:"")_"successful."
"RTN","RA64PRE",46,0)
 .S RATXT(2)=" " D BMES^XPDUTL(.RATXT) K RAMSG,RATXT
"RTN","RA64PRE",47,0)
 .Q
"RTN","RA64PRE",48,0)
XIT ;clean up symbol table; exit
"RTN","RA64PRE",49,0)
 K RAI,RAFDA,RAIEN,RAMSG,RATXT,RAX
"RTN","RA64PRE",50,0)
 Q
"RTN","RA64PRE",51,0)
 ;
"RTN","RA64PRE",52,0)
MENUTXT ;option name; old menu type ; new menu type
"RTN","RA64PRE",53,0)
 ;;RA WKLIPHY CPT ITYPE;Physician CPT Report by I-Type;Physician CPT Report by Imaging Type
"RTN","RA64PRE",54,0)
 ;;RA WKLIPHY SWRVU ITYPE;Physician scaled wRVU Report by I-Type;Physician scaled wRVU Report by Imaging Type
"RTN","RA64PRE",55,0)
 ;;RA WKLIPHY WRVU ITYPE;Physician wRVU Report by I-Type;Physician wRVU Report by Imaging Type
"RTN","RA64PRE",56,0)
 ;;
"RTN","RA64PST")
0^7^B4334607^n/a
"RTN","RA64PST",1,0)
RA64PST ;Hines OI/GJC - Post-init Driver, patch 64 ;01/05/06  06:32
"RTN","RA64PST",2,0)
VERSION ;;5.0;Radiology/Nuclear Medicine;**64**;Mar 16, 1998;Build 5
"RTN","RA64PST",3,0)
 ;
"RTN","RA64PST",4,0)
EN ; entry point for the post-install logic
"RTN","RA64PST",5,0)
 N RACHK
"RTN","RA64PST",6,0)
 S RACHK=$$NEWCP^XPDUTL("POST1","EN1^RA64PST")
"RTN","RA64PST",7,0)
 ; Add the correct calendar year scaling factors to the correct
"RTN","RA64PST",8,0)
 ; imaging type records in the IMAGING TYPE (#79.2) file.
"RTN","RA64PST",9,0)
 Q
"RTN","RA64PST",10,0)
 ;
"RTN","RA64PST",11,0)
EN1 ; Add the scaling facors to the correct IMAGING TYPE file records.
"RTN","RA64PST",12,0)
 N RAI,RAX K RAMSG
"RTN","RA64PST",13,0)
 F RAI=1:1 S RAX=$T(FACTORS+RAI) Q:RAX=""  D
"RTN","RA64PST",14,0)
 .S RAIEN=+$O(^RA(79.2,"B",$P(RAX,";",3),0))
"RTN","RA64PST",15,0)
 .I 'RAIEN D  Q
"RTN","RA64PST",16,0)
 ..S RATXT(1)="'"_$P(RAX,";",3)_"' not found as an imaging type record,"
"RTN","RA64PST",17,0)
 ..S RATXT(2)="wRVU scaling factors not filed."
"RTN","RA64PST",18,0)
 ..D BMES^XPDUTL(.RATXT) K RATXT
"RTN","RA64PST",19,0)
 ..Q
"RTN","RA64PST",20,0)
 .I '$D(^RA(79.2,"C",$P(RAX,";",4),RAIEN))#2 D  Q
"RTN","RA64PST",21,0)
 ..S RATXT(1)="'"_$P(RAX,";",4)_"' not found as the abbreviation for imaging type record:"
"RTN","RA64PST",22,0)
 ..S RATXT(2)="'"_$P(RAX,";",3)_"'."
"RTN","RA64PST",23,0)
 ..S RATXT(3)="wRVU scaling factors not filed."
"RTN","RA64PST",24,0)
 ..D BMES^XPDUTL(.RATXT) K RATXT
"RTN","RA64PST",25,0)
 ..Q
"RTN","RA64PST",26,0)
 .Q:$D(^RA(79.2,RAIEN,"CY","B",$P(RAX,";",5)))\10  ;been there, done that
"RTN","RA64PST",27,0)
 .S RAFDA(79.22,"+812,"_RAIEN_",",.01)=$P(RAX,";",5)
"RTN","RA64PST",28,0)
 .S RAFDA(79.22,"+812,"_RAIEN_",",2)=$P(RAX,";",6)
"RTN","RA64PST",29,0)
 .S RATXT(1)="Filing scaling wRVU factors for: '"_$P(RAX,";",3)_"'"
"RTN","RA64PST",30,0)
 .D UPDATE^DIE("E","RAFDA","","RAMSG(1)") K RAFDA
"RTN","RA64PST",31,0)
 .S RATXT(2)="The filing of data was "_$S($D(RAMSG(1,"DIERR"))#2:"un",1:"")_"successful."
"RTN","RA64PST",32,0)
 .S RATXT(3)=" " D BMES^XPDUTL(.RATXT) K RAMSG,RATXT
"RTN","RA64PST",33,0)
 .Q
"RTN","RA64PST",34,0)
XIT ;clean up symbol table; exit
"RTN","RA64PST",35,0)
 K RAIEN
"RTN","RA64PST",36,0)
 Q
"RTN","RA64PST",37,0)
 ;
"RTN","RA64PST",38,0)
FACTORS ;I-type name;I-type abbreviation;calendar year;scaled wRVU value
"RTN","RA64PST",39,0)
 ;;ANGIO/NEURO/INTERVENTIONAL;ANI;2006;0.61
"RTN","RA64PST",40,0)
 ;;CT SCAN;CT;2006;0.70
"RTN","RA64PST",41,0)
 ;;GENERAL RADIOLOGY;RAD;2006;1.21
"RTN","RA64PST",42,0)
 ;;MAGNETIC RESONANCE IMAGING;MRI;2006;0.70
"RTN","RA64PST",43,0)
 ;;NUCLEAR MEDICINE;NM;2006;1.57
"RTN","RAWKLU")
0^3^B43942290^n/a
"RTN","RAWKLU",1,0)
RAWKLU ;HISC/GJC-physician workload statistics by wRVU or CPT ;10/26/05  14:57
"RTN","RAWKLU",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**64**;Mar 16, 1998;Build 5
"RTN","RAWKLU",3,0)
 ;
"RTN","RAWKLU",4,0)
 ;DBIA#:1995 ($$CPT^ICPTCOD) resolves the CPT code pointer to the CPT
"RTN","RAWKLU",5,0)
 ;      code value
"RTN","RAWKLU",6,0)
 ;DBIA#:1996 ($$MOD^ICPTMOD) resolves the CPT modifer pointer to the
"RTN","RAWKLU",7,0)
 ;      CPT modifier value
"RTN","RAWKLU",8,0)
 ;DBIA#:4799 ($$RVU^FBRVU) return wRVU value for CPT, CPT Mod, & exam
"RTN","RAWKLU",9,0)
 ;      date/time 
"RTN","RAWKLU",10,0)
 ;DBIA#:10060 EN1^RASELCT enacts 10060 which allows lookups on the NEW
"RTN","RAWKLU",11,0)
 ;            PERSON (#200) file
"RTN","RAWKLU",12,0)
 ;DBIA#:10063 ($$S^%ZTLOAD)
"RTN","RAWKLU",13,0)
 ;DBIA#:10103 ($$FMTE^XLFDT) & ($$NOW^XLFDT)
"RTN","RAWKLU",14,0)
 ;DBIA#:10104 ($$CJ^XLFSTR)
"RTN","RAWKLU",15,0)
 ;DBIA#:1519  ($$EN^XUTMDEVQ)
"RTN","RAWKLU",16,0)
 ;
"RTN","RAWKLU",17,0)
EN(RARPTYP,RASCLD) ;Identifies the option that the user wishes to execute.
"RTN","RAWKLU",18,0)
 ;input: RARPTYP="CPT" for the CPT workload report -or- "RVU" for
"RTN","RAWKLU",19,0)
 ;       wRVU workload report. Exit if the value is neither 'CPT'
"RTN","RAWKLU",20,0)
 ;       or 'RVU'.
"RTN","RAWKLU",21,0)
 ;       RASCLD=null for the CPT report, zero for non-scaled wRVU, & one
"RTN","RAWKLU",22,0)
 ;       for the scaled wRVU report.
"RTN","RAWKLU",23,0)
 ;
"RTN","RAWKLU",24,0)
 I RARPTYP'="CPT",(RARPTYP'="RVU") Q
"RTN","RAWKLU",25,0)
 I RARPTYP="CPT",(RASCLD'="") Q
"RTN","RAWKLU",26,0)
 K ^TMP($J,"RA STFPHYS"),^TMP("RA STFPHYS-IEN",$J)
"RTN","RAWKLU",27,0)
 I RARPTYP="RVU" W !!,"Please note that this report is best suited for display on a 132 column device."
"RTN","RAWKLU",28,0)
 ;
"RTN","RAWKLU",29,0)
PHYST ;allow the user to select one/many/all physicians
"RTN","RAWKLU",30,0)
 ;(w/ staff classification) ;DBIA#: 10060
"RTN","RAWKLU",31,0)
 S RADIC="^VA(200,",RADIC(0)="QEAMZ",RAUTIL="RA STFPHYS"
"RTN","RAWKLU",32,0)
 S RADIC("A")="Select Physician: ",RADIC("B")="All"
"RTN","RAWKLU",33,0)
 S RADIC("S")="I $D(^VA(200,""ARC"",""S"",+Y))\10"
"RTN","RAWKLU",34,0)
 W !! D EN1^RASELCT(.RADIC,RAUTIL) K %W,%Y1,DIC,RADIC,RAQUIT,RAUTIL,X,Y
"RTN","RAWKLU",35,0)
 ;did the user select physicians to compile data on? if not, quit
"RTN","RAWKLU",36,0)
 I $O(^TMP($J,"RA STFPHYS",""))="" D  Q
"RTN","RAWKLU",37,0)
 .W !!?3,$C(7),"Staff Physician data was not selected."
"RTN","RAWKLU",38,0)
 .Q
"RTN","RAWKLU",39,0)
 ;
"RTN","RAWKLU",40,0)
 ;build a new staff physician array (the other array is subscripted by
"RTN","RAWKLU",41,0)
 ;physician name then IEN) subscripting by staff physician IEN this
"RTN","RAWKLU",42,0)
 ;allows us to check the IEN of the staff physician selected by the
"RTN","RAWKLU",43,0)
 ;user against the IEN of the staff physician on the exam record
"RTN","RAWKLU",44,0)
 S X="" F  S X=$O(^TMP($J,"RA STFPHYS",X)) Q:X=""  D
"RTN","RAWKLU",45,0)
 .S Y=0
"RTN","RAWKLU",46,0)
 .F  S Y=$O(^TMP($J,"RA STFPHYS",X,Y)) Q:'Y  S ^TMP("RA STFPHYS-IEN",$J,Y)=""
"RTN","RAWKLU",47,0)
 .Q
"RTN","RAWKLU",48,0)
 ;
"RTN","RAWKLU",49,0)
 K ^TMP($J,"RA STFPHYS") S RADATE=$$FMTE^XLFDT($$NOW^XLFDT\1,1)
"RTN","RAWKLU",50,0)
 ;
"RTN","RAWKLU",51,0)
STRTDT ;Prompt the user for a starting date (VERIFIED DATE)
"RTN","RAWKLU",52,0)
 S RASTART=$$STRTDT^RAWKLU1(RADATE,2110101)
"RTN","RAWKLU",53,0)
 I RASTART=-1 D XIT Q
"RTN","RAWKLU",54,0)
 S RABGDTI=$P(RASTART,U),RABGDTX=$P(RASTART,U,2),RAMBGDT=RABGDTI-.0001
"RTN","RAWKLU",55,0)
 ;need inv. verified date to search ^RARPT("AA",
"RTN","RAWKLU",56,0)
 S RAMBGDT=9999999.9999-RAMBGDT
"RTN","RAWKLU",57,0)
 K RASTART
"RTN","RAWKLU",58,0)
 ;
"RTN","RAWKLU",59,0)
ENDDT ;Prompt the user for an ending date (VERIFIED DATE)
"RTN","RAWKLU",60,0)
 S RAEND=$$ENDDT^RAWKLU1(RABGDTI,RABGDTX)
"RTN","RAWKLU",61,0)
 I RAEND=-1 D XIT Q
"RTN","RAWKLU",62,0)
 S RAENDTI=$P(RAEND,U),RAENDTX=$P(RAEND,U,2),RAMENDT=RAENDTI+.9999
"RTN","RAWKLU",63,0)
 ;need inv. verified date to search ^RARPT("AA",
"RTN","RAWKLU",64,0)
 S RAMENDT=9999999.9999-RAMENDT
"RTN","RAWKLU",65,0)
 K RAEND
"RTN","RAWKLU",66,0)
 ;
"RTN","RAWKLU",67,0)
 F I="RARPTYP","^TMP(""RA STFPHYS-IEN"",$J,","RADATE","RAB*","RAM*","RAE*","RASCLD" S ZTSAVE(I)=""
"RTN","RAWKLU",68,0)
 S I="RA print "_$S(RARPTYP="CPT":"CPTs",1:"wRVUs")_" totals for physicians within imaging type"
"RTN","RAWKLU",69,0)
 D EN^XUTMDEVQ("START^RAWKLU",I,.ZTSAVE,,1)
"RTN","RAWKLU",70,0)
 I +$G(ZTSK)>0 W !!,"Task Number: "_ZTSK,!
"RTN","RAWKLU",71,0)
 K I,ZTSAVE,ZTSK
"RTN","RAWKLU",72,0)
 Q
"RTN","RAWKLU",73,0)
 ;
"RTN","RAWKLU",74,0)
START ;check exams based on criteria input by user; physician & exam D/T
"RTN","RAWKLU",75,0)
 ;eliminate the exam record is one of the following conditions is true:
"RTN","RAWKLU",76,0)
 ;1-the status of the exam is 'Cancelled'
"RTN","RAWKLU",77,0)
 ;2-the physician(s) selected are not the primary staff for the exam
"RTN","RAWKLU",78,0)
 ;
"RTN","RAWKLU",79,0)
 S:$D(ZTQUEUED)#2 ZTREQ="@"
"RTN","RAWKLU",80,0)
 K ^TMP($J,"RA BY STFPHYS"),^TMP($J,"RA BY I-TYPE")
"RTN","RAWKLU",81,0)
 S ^TMP($J,"RA BY I-TYPE")="0^0^0^0^0^0^0^0^0",CNT=0
"RTN","RAWKLU",82,0)
 ;define where the totals for imaging type will reside on the globals
"RTN","RAWKLU",83,0)
 F RAI="RAD","MRI","CT","US","NM","VAS","ANI","CARD","MAM" S CNT=CNT+1,RAIAB(RAI)=CNT
"RTN","RAWKLU",84,0)
 K RAI,CNT S RARPTVDT=RAMBGDT,(RACNT,RAXIT)=0
"RTN","RAWKLU",85,0)
 F  S RARPTVDT=$O(^RARPT("AA",RARPTVDT),-1) Q:'RARPTVDT!(RARPTVDT<RAMENDT)  D  Q:RAXIT
"RTN","RAWKLU",86,0)
 .S RARPTIEN=0
"RTN","RAWKLU",87,0)
 .F  S RARPTIEN=$O(^RARPT("AA",RARPTVDT,RARPTIEN)) Q:'RARPTIEN  D  Q:RAXIT
"RTN","RAWKLU",88,0)
 ..S RARPT=$G(^RARPT(RARPTIEN,0)),RADFN=+$P(RARPT,U,2),RADTE=+$P(RARPT,U,3)
"RTN","RAWKLU",89,0)
 ..S RADTI=9999999.9999-RADTE,RA7002=$G(^RADPT(RADFN,"DT",RADTI,0))
"RTN","RAWKLU",90,0)
 ..Q:$P(RA7002,U,2)=""  ;no imaging type defined
"RTN","RAWKLU",91,0)
 ..S RAITYP=$P($G(^RA(79.2,$P(RA7002,U,2),0)),U,3) ;abbreviation
"RTN","RAWKLU",92,0)
 ..Q:'($D(RAIAB(RAITYP))#2)
"RTN","RAWKLU",93,0)
 ..S RACNI=0
"RTN","RAWKLU",94,0)
 ..F  S RACNI=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI)) Q:'RACNI  D  Q:RAXIT
"RTN","RAWKLU",95,0)
 ...S RA7003=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0)) Q:RA7003=""  ;missing exam node
"RTN","RAWKLU",96,0)
 ...Q:$P(RA7003,U,17)'=RARPTIEN  ;exam references a different report!
"RTN","RAWKLU",97,0)
 ...S RACNT=RACNT+1
"RTN","RAWKLU",98,0)
 ...;
"RTN","RAWKLU",99,0)
 ...;did the user stop the task? Check every five hundred records...
"RTN","RAWKLU",100,0)
 ...S:RACNT#500=0 (RAXIT,ZTSTOP)=$$S^%ZTLOAD() Q:RAXIT
"RTN","RAWKLU",101,0)
 ...;
"RTN","RAWKLU",102,0)
 ...;1-begin exam status check
"RTN","RAWKLU",103,0)
 ...Q:$P($G(^RA(72,+$P(RA7003,U,3),0)),U,3)=0  ;cancelled...
"RTN","RAWKLU",104,0)
 ...;end exam status check
"RTN","RAWKLU",105,0)
 ...;
"RTN","RAWKLU",106,0)
 ...;2-begin physician check
"RTN","RAWKLU",107,0)
 ...Q:'$P(RA7003,U,15)  ;no physician, quit check
"RTN","RAWKLU",108,0)
 ...Q:'$D(^TMP("RA STFPHYS-IEN",$J,$P(RA7003,U,15)))#2
"RTN","RAWKLU",109,0)
 ...;end physician check
"RTN","RAWKLU",110,0)
 ...;
"RTN","RAWKLU",111,0)
 ...S RASTAFF=$$EXTERNAL^DILFD(70.03,15,,$P(RA7003,U,15))
"RTN","RAWKLU",112,0)
 ...I RARPTYP="CPT" D  Q
"RTN","RAWKLU",113,0)
 ....;Total the # of CPTs performed by a physician within an i-type;
"RTN","RAWKLU",114,0)
 ....;the # on CPTs performed within i-type; the # of procedures
"RTN","RAWKLU",115,0)
 ....;performed by physician. all exams are either detailed or series
"RTN","RAWKLU",116,0)
 ....;(CPT codes defined) types of procedures.
"RTN","RAWKLU",117,0)
 ....D ARY(1)
"RTN","RAWKLU",118,0)
 ....Q
"RTN","RAWKLU",119,0)
 ...D RVU
"RTN","RAWKLU",120,0)
 ...Q
"RTN","RAWKLU",121,0)
 ..Q
"RTN","RAWKLU",122,0)
 .Q
"RTN","RAWKLU",123,0)
 D EN^RAWKLU1 ;output the report
"RTN","RAWKLU",124,0)
 D XIT
"RTN","RAWKLU",125,0)
 Q
"RTN","RAWKLU",126,0)
 ;
"RTN","RAWKLU",127,0)
ARY(Y) ;increment the array by one in the case of CPT or by the wRVU
"RTN","RAWKLU",128,0)
 ;value
"RTN","RAWKLU",129,0)
 ;input: Y=either one when adding the number of CPTs performed by a
"RTN","RAWKLU",130,0)
 ;         physician, within an i-type or by physician within i-type
"RTN","RAWKLU",131,0)
 ;    -or- the WRVU value when totaling for the aforementioned criteria
"RTN","RAWKLU",132,0)
 ;
"RTN","RAWKLU",133,0)
 S $P(^TMP($J,"RA BY STFPHYS",RASTAFF),U,RAIAB(RAITYP))=+$P($G(^TMP($J,"RA BY STFPHYS",RASTAFF)),U,RAIAB(RAITYP))+Y
"RTN","RAWKLU",134,0)
 S $P(^TMP($J,"RA BY I-TYPE"),U,RAIAB(RAITYP))=$P(^TMP($J,"RA BY I-TYPE"),U,RAIAB(RAITYP))+Y
"RTN","RAWKLU",135,0)
 Q
"RTN","RAWKLU",136,0)
 ;
"RTN","RAWKLU",137,0)
RVU ;Total the # of wRVUs performed by a physician within an i-type; all
"RTN","RAWKLU",138,0)
 ;exams are either detailed or series types of procedures. By definition
"RTN","RAWKLU",139,0)
 ;these procedure types MUST have CPT code defined.
"RTN","RAWKLU",140,0)
 ;Pass the exam date, CPT, & CPT modifiers into the FEE BASIS function
"RTN","RAWKLU",141,0)
 ;to derive the wRVU
"RTN","RAWKLU",142,0)
 ;
"RTN","RAWKLU",143,0)
 ;get exam date/time
"RTN","RAWKLU",144,0)
 N RAXAMDT S RAXAMDT=$P(RA7002,U)
"RTN","RAWKLU",145,0)
 ;get the CPT code value
"RTN","RAWKLU",146,0)
 S RACPT=$P($G(^RAMIS(71,+$P(RA7003,U,2),0)),U,9) ;pointer to file #81
"RTN","RAWKLU",147,0)
 S RACPT=$P($$CPT^ICPTCOD(RACPT,RAXAMDT),U,2) ;CPT code is 2nd piece
"RTN","RAWKLU",148,0)
 ;get CPT code modifier string
"RTN","RAWKLU",149,0)
 S RACPTMOD="",RABILAT=0
"RTN","RAWKLU",150,0)
 I $O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",0))>0 S RAI=0 D
"RTN","RAWKLU",151,0)
 .F  S RAI=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",RAI)) Q:'RAI  D
"RTN","RAWKLU",152,0)
 ..S RACPTMOD(0)=+$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",RAI,0))
"RTN","RAWKLU",153,0)
 ..S RA813(0)=$$MOD^ICPTMOD(RACPTMOD(0),"I",RAXAMDT)
"RTN","RAWKLU",154,0)
 ..I 'RABILAT,$P(RA813(0),U,2)=50 S RABILAT=1 ;bilateral multiplier=2
"RTN","RAWKLU",155,0)
 ..S RACPTMOD=RACPTMOD_$P(RA813(0),U,2)_","
"RTN","RAWKLU",156,0)
 ..Q
"RTN","RAWKLU",157,0)
 .Q
"RTN","RAWKLU",158,0)
 ;get wRVU value from FEE BASIS; returns a string: status^value^message
"RTN","RAWKLU",159,0)
 ;where status'=1 means "in error". All exams prior to 1/1/1999 will
"RTN","RAWKLU",160,0)
 ;use 1999 wRVU values for their calculations.
"RTN","RAWKLU",161,0)
 S RAWRVU=$$RVU^FBRVU(RACPT,RACPTMOD,$S(RAXAMDT<2990101:2990101,1:RAXAMDT))
"RTN","RAWKLU",162,0)
 I $P(RAWRVU,U)=1 D
"RTN","RAWKLU",163,0)
 .;apply bilateral multiplier if appropriate
"RTN","RAWKLU",164,0)
 .S:RABILAT RAWRVU=$P(RAWRVU,U,2)*2
"RTN","RAWKLU",165,0)
 .;or not...
"RTN","RAWKLU",166,0)
 .S:'RABILAT RAWRVU=$P(RAWRVU,U,2)
"RTN","RAWKLU",167,0)
 .I RASCLD S RAWRVU=RAWRVU*$$SFCTR^RAWRVUP($P(RA7002,U,2),RAXAMDT)
"RTN","RAWKLU",168,0)
 .Q
"RTN","RAWKLU",169,0)
 ;
"RTN","RAWKLU",170,0)
 E  S RAWRVU=0 ;status some other value than 1; "in error"
"RTN","RAWKLU",171,0)
 S:RAWRVU>0 RAWRVU=$J(RAWRVU,1,2) ;do not round the value...
"RTN","RAWKLU",172,0)
 D ARY(RAWRVU)
"RTN","RAWKLU",173,0)
 K RA813,RABILAT,RACPT,RACPTMOD,RAI,RAWRVU
"RTN","RAWKLU",174,0)
 Q
"RTN","RAWKLU",175,0)
 ;
"RTN","RAWKLU",176,0)
XIT ;kill variables and exit
"RTN","RAWKLU",177,0)
 W:$G(ZTSTOP)=1 !,$$CJ^XLFSTR("USER STOPPED PROCESS THROUGH TASKMAN",IOM)
"RTN","RAWKLU",178,0)
 K DIRUT,DTOUT,DUOUT,RA7002,RA7003,RABGDTI,RABGDTX,RACNI,RADATE
"RTN","RAWKLU",179,0)
 K RADFN,RADTE,RADTI,RAENDTI,RAENDTX,RAIAB,RAITYP,RAMBGDT,RAMENDT
"RTN","RAWKLU",180,0)
 K RARPT,RARPTIEN,RARPTVDT,RASTAFF,RAXIT,X,Y,^TMP("RA STFPHYS-IEN",$J)
"RTN","RAWKLU",181,0)
 K ^TMP($J,"RA BY STFPHYS"),^TMP($J,"RA BY I-TYPE")
"RTN","RAWKLU",182,0)
 Q
"RTN","RAWKLU1")
0^4^B32092526^n/a
"RTN","RAWKLU1",1,0)
RAWKLU1 ;HISC/GJC-physician workload statistics by wRVU or CPT ;10/26/05  14:57
"RTN","RAWKLU1",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**64**;Mar 16, 1998;Build 5
"RTN","RAWKLU1",3,0)
 ;
"RTN","RAWKLU1",4,0)
 ;DBIA#:2541 ($$KSP^XUPARAM) returns the DEFAULT INSTITUTION (#217)
"RTN","RAWKLU1",5,0)
 ;      from the KERNEL SYSTEM PARAMETERS (#8989.3) file.
"RTN","RAWKLU1",6,0)
 ;DBIA#:2171 ($$NAME^XUAF4) resolves the DEFAULT INSTITUTION value into
"RTN","RAWKLU1",7,0)
 ;      the name of the facility
"RTN","RAWKLU1",8,0)
 ;DBIA#:10063 ($$S^%ZTLOAD)
"RTN","RAWKLU1",9,0)
 ;DBIA#:10103 ($$FMTE^XLFDT) & ($$NOW^XLFDT)
"RTN","RAWKLU1",10,0)
 ;
"RTN","RAWKLU1",11,0)
EN ;entry point; called from RAWKLU...
"RTN","RAWKLU1",12,0)
 S RAFAC=$$NAME^XUAF4(+$$KSP^XUPARAM("INST"))
"RTN","RAWKLU1",13,0)
 S:RAFAC="" RAFAC="***undefined facility name***"
"RTN","RAWKLU1",14,0)
 S $P(RALN,"-",IOM+1)="",(RACNT,RAPG)=0
"RTN","RAWKLU1",15,0)
 S RAHDR="IMAGING PHYSICIAN WORKLOAD SUMMARY BY "
"RTN","RAWKLU1",16,0)
 I RARPTYP="CPT" S RAHDR=RAHDR_"NUMBER OF CPT CODES"
"RTN","RAWKLU1",17,0)
 I RARPTYP="RVU" S RAHDR=RAHDR_$S(RASCLD=1:"SCALED ",1:"")_"PROFESSIONAL COMPONENT CMS RVU"
"RTN","RAWKLU1",18,0)
 S RARDATE=$$FMTE^XLFDT($$NOW^XLFDT,"1D")
"RTN","RAWKLU1",19,0)
 ;
"RTN","RAWKLU1",20,0)
 ;$O through physician names; print totals...
"RTN","RAWKLU1",21,0)
 I RARPTYP="RVU" S RATMP="("_$S(RASCLD'=1:"un-s",1:"S")_"caled wRVU)"
"RTN","RAWKLU1",22,0)
 S RAPCE=$S(RARPTYP="CPT":3,RARPTYP="RVU"&(IOM=132):5,1:7)
"RTN","RAWKLU1",23,0)
 S RATRUNC=$S(RARPTYP="CPT":20,RARPTYP="RVU"&(IOM=80):23,1:27)
"RTN","RAWKLU1",24,0)
 S RAWDTH=$S(RARPTYP="CPT":5,1:8),RADEC=$S(RARPTYP="RVU":2,1:0)
"RTN","RAWKLU1",25,0)
 D HDR S RAX=""
"RTN","RAWKLU1",26,0)
 F  S RAX=$O(^TMP($J,"RA BY STFPHYS",RAX)) Q:RAX=""  D  Q:RAXIT
"RTN","RAWKLU1",27,0)
 .S RACNT=RACNT+1,RAY=$G(^TMP($J,"RA BY STFPHYS",RAX)),RATOT=0
"RTN","RAWKLU1",28,0)
 .;did the user stop the task? Check every five hundred records...
"RTN","RAWKLU1",29,0)
 .S:RACNT#500=0 (RAXIT,ZTSTOP)=$$S^%ZTLOAD() Q:RAXIT
"RTN","RAWKLU1",30,0)
 .W !,$E(RAX,1,RATRUNC) ;physician name
"RTN","RAWKLU1",31,0)
 .D WRITE(RAPCE,0,RAY,RAWDTH,RADEC)
"RTN","RAWKLU1",32,0)
 .S RAFMAT=$P($T(CFMAT+10),";;",2,99)
"RTN","RAWKLU1",33,0)
 .;single physician total for all i-types - adj RAWDTH for totals
"RTN","RAWKLU1",34,0)
 .W ?$P(RAFMAT,U,RAPCE),$J(RATOT,$S(RAWDTH=8:10,1:6),RADEC)
"RTN","RAWKLU1",35,0)
 .I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU1",36,0)
 .Q
"RTN","RAWKLU1",37,0)
 ;print the imaging type and physician totals...
"RTN","RAWKLU1",38,0)
 I RAXIT D XIT Q
"RTN","RAWKLU1",39,0)
 I 'RACNT W !,$$CJ^XLFSTR("No data found for this report",IOM) D XIT Q
"RTN","RAWKLU1",40,0)
 I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU1",41,0)
 S RAY=$G(^TMP($J,"RA BY I-TYPE")),RATOT=0
"RTN","RAWKLU1",42,0)
 W !!,"Physician Total"
"RTN","RAWKLU1",43,0)
 D WRITE(RAPCE,0,RAY,RAWDTH,RADEC)
"RTN","RAWKLU1",44,0)
 S RAFMAT=$P($T(CFMAT+10),";;",2,99)
"RTN","RAWKLU1",45,0)
 ;total for all physicians for all i-types - adj RAWDTH for totals
"RTN","RAWKLU1",46,0)
 W ?$P(RAFMAT,U,RAPCE),$J(RATOT,$S(RAWDTH=8:10,1:6),RADEC) ;physician total for all i-types
"RTN","RAWKLU1",47,0)
 ;
"RTN","RAWKLU1",48,0)
 I RASCLD=1 S RASFACTR="" D
"RTN","RAWKLU1",49,0)
 .I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU1",50,0)
 .W !!,"For calendar year "_($E(DT,1,3)+1700)_" the following scaling factors apply:"
"RTN","RAWKLU1",51,0)
 .S I=0
"RTN","RAWKLU1",52,0)
 .F  S I=$O(^RA(79.2,I)) Q:'I  D:$O(^RA(79.2,I,"CY",0))>0  Q:RAXIT
"RTN","RAWKLU1",53,0)
 ..S I(0)=$G(^RA(79.2,I,0))
"RTN","RAWKLU1",54,0)
 ..I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU1",55,0)
 ..W !,$P(I(0),U),?34,$P(I(0),U,3),?49,$$SFCTR^RAWRVUP(I,DT)
"RTN","RAWKLU1",56,0)
 ..Q
"RTN","RAWKLU1",57,0)
 .Q
"RTN","RAWKLU1",58,0)
XIT ;exit and kill variables
"RTN","RAWKLU1",59,0)
 K I,RACNT,RADEC,RAFAC,RAFMAT,RAHDR,RAI,RALN,RAPCE,RAPG,RARDATE,RASFACTR,RATAB,RATMP,RATOT
"RTN","RAWKLU1",60,0)
 K RATRUNC,RAWDTH,RAX,RAY
"RTN","RAWKLU1",61,0)
 Q
"RTN","RAWKLU1",62,0)
 ;
"RTN","RAWKLU1",63,0)
HDR ; Header for our report
"RTN","RAWKLU1",64,0)
 W:RAPG!($E(IOST,1,2)="C-") @IOF
"RTN","RAWKLU1",65,0)
 S RAPG=RAPG+1
"RTN","RAWKLU1",66,0)
 W !?(IOM-$L(RAHDR)\2),RAHDR
"RTN","RAWKLU1",67,0)
 W !,"Run Date: ",RARDATE,?68,"Page: ",RAPG
"RTN","RAWKLU1",68,0)
 W !,"Facility: ",$E(RAFAC,1,40),?41,"Date Range: ",RABGDTX_" - "_RAENDTX
"RTN","RAWKLU1",69,0)
 ;header formatting logic for CPT & RVU reports
"RTN","RAWKLU1",70,0)
 W:RARPTYP="RVU" !,$$CJ^XLFSTR(RATMP,IOM)
"RTN","RAWKLU1",71,0)
 W:RARPTYP="CPT" ! ;CPT report
"RTN","RAWKLU1",72,0)
 N RAPCE S RAPCE=$S(RARPTYP="CPT":2,RARPTYP="RVU"&(IOM=132):4,1:6)
"RTN","RAWKLU1",73,0)
 I '$D(RASFACTR)#2 D
"RTN","RAWKLU1",74,0)
 .W !,"Physician" D WRITE(RAPCE,1)
"RTN","RAWKLU1",75,0)
 W:$D(RASFACTR)#2 !,"Imaging Type",?34,"Abbreviation",?49,"wRVU scaling factor"
"RTN","RAWKLU1",76,0)
 W !,RALN
"RTN","RAWKLU1",77,0)
 Q
"RTN","RAWKLU1",78,0)
 ;
"RTN","RAWKLU1",79,0)
STRTDT(RADATE,RAEARLY) ;Prompt the user for the starting date report verified
"RTN","RAWKLU1",80,0)
 ;RADATE-Today's date; DT-implicitly defined as today's date(internal format)
"RTN","RAWKLU1",81,0)
 ;RAEARLY-Earliest conceivable starting date
"RTN","RAWKLU1",82,0)
 W ! K DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y N RARSLT
"RTN","RAWKLU1",83,0)
 S DIR(0)="DA^"_RAEARLY_":"_"DT:PEX"
"RTN","RAWKLU1",84,0)
 S DIR("A",1)="Calculate physician workload over a date range; enter a start date"
"RTN","RAWKLU1",85,0)
 S DIR("A")="of: "
"RTN","RAWKLU1",86,0)
 S DIR("?",1)="Workload is assigned on the date the report is verified, not the date"
"RTN","RAWKLU1",87,0)
 S DIR("?",2)="the report is dictated.",DIR("?",3)=""
"RTN","RAWKLU1",88,0)
 S DIR("?",4)="This is the date from which our search will begin. The starting"
"RTN","RAWKLU1",89,0)
 S DIR("?",5)="date must not precede: "_$$FMTE^XLFDT(RAEARLY,"1D")_" and must not come after: "_RADATE_"."
"RTN","RAWKLU1",90,0)
 S DIR("?")="Dates associated with a time will not be accepted."
"RTN","RAWKLU1",91,0)
 S DIR("B")=RADATE D ^DIR
"RTN","RAWKLU1",92,0)
 S:$D(DIRUT) RARSLT=-1 S:'$D(DIRUT) RARSLT=Y_U_Y(0)
"RTN","RAWKLU1",93,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RAWKLU1",94,0)
 Q RARSLT
"RTN","RAWKLU1",95,0)
 ;
"RTN","RAWKLU1",96,0)
ENDDT(RABGDTI,RABGDTX) ;Prompt the user for the ending date report verified (no greater than a 
"RTN","RAWKLU1",97,0)
 ;year after the start date input by the user)
"RTN","RAWKLU1",98,0)
 ;DT-implicitly defined as today's date(internal format)
"RTN","RAWKLU1",99,0)
 ;RABGDTI-The search start date (selected by the user; internal format)
"RTN","RAWKLU1",100,0)
 ;RABGDTX-The search start date (selected by the user; external format)
"RTN","RAWKLU1",101,0)
 W ! K DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y N RAEND,RARSLT
"RTN","RAWKLU1",102,0)
 ;is today's date 365 days or more past the start date? If yes, calculate end date
"RTN","RAWKLU1",103,0)
 ;by adding a year to the start date selected by the user
"RTN","RAWKLU1",104,0)
 I $$FMDIFF^XLFDT(DT,RABGDTI,1)'<365 S RAEND=$$FMADD^XLFDT(RABGDTI,365,0,0,0)
"RTN","RAWKLU1",105,0)
 ;if not, default using DT (today's date) 
"RTN","RAWKLU1",106,0)
 S:'$D(RAEND)#2 RAEND=DT
"RTN","RAWKLU1",107,0)
 S DIR(0)="DA^"_RABGDTI_":"_RAEND_":PEX"
"RTN","RAWKLU1",108,0)
 S DIR("A")="Enter an end date of: "
"RTN","RAWKLU1",109,0)
 S DIR("?",1)="Workload is assigned on the date the report is verified, not the date"
"RTN","RAWKLU1",110,0)
 S DIR("?",2)="the report is dictated.",DIR("?",3)=""
"RTN","RAWKLU1",111,0)
 S DIR("?",4)="This is the date in which our search will end. The ending date"
"RTN","RAWKLU1",112,0)
 S DIR("?",5)="must not precede: "_RABGDTX_" and must not exceed: "_$$FMTE^XLFDT(RAEND,"1D")_"."
"RTN","RAWKLU1",113,0)
 S DIR("?")="Dates associated with a time will not be accepted."
"RTN","RAWKLU1",114,0)
 S DIR("B")=$$FMTE^XLFDT(RAEND,"1D") D ^DIR K DIR
"RTN","RAWKLU1",115,0)
 S:$D(DIRUT) RARSLT=-1 S:'$D(DIRUT) RARSLT=Y_U_Y(0)
"RTN","RAWKLU1",116,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RAWKLU1",117,0)
 Q RARSLT
"RTN","RAWKLU1",118,0)
 ;
"RTN","RAWKLU1",119,0)
WRITE(RAPCE,HDR,RAY,RAWDTH,RADEC) ;Write out the column headers and the data for our reports.
"RTN","RAWKLU1",120,0)
 ;input: RAPCE=the piece of data referenced from the format string defined in CFMAT (req'd)
"RTN","RAWKLU1",121,0)
 ;         HDR=1 if called from the HDR subroutine, else HDR is 0 (req'd)
"RTN","RAWKLU1",122,0)
 ;         RAY=data to be printed; not a label (optional)
"RTN","RAWKLU1",123,0)
 ;      RAWDTH=field width; right justified (optional)
"RTN","RAWKLU1",124,0)
 ;       RADEC=number of decimal places; either zero or two (optional)
"RTN","RAWKLU1",125,0)
 S RANGE=$S(HDR=1:10,1:9)
"RTN","RAWKLU1",126,0)
 F RAI=1:1:RANGE S RAFMAT=$P($T(CFMAT+RAI),";;",2,99) D
"RTN","RAWKLU1",127,0)
 .S RATAB=$P(RAFMAT,U,RAPCE) S:HDR=0 RATOT=RATOT+$P(RAY,U,RAI)
"RTN","RAWKLU1",128,0)
 .I $P(RAFMAT,U)="NUC",((RAPCE=6)!(RAPCE=7)) W ! ;RVU on 80
"RTN","RAWKLU1",129,0)
 .W ?RATAB,$S(HDR=1:$P(RAFMAT,U),1:$J(+$P(RAY,U,RAI),RAWDTH,RADEC))
"RTN","RAWKLU1",130,0)
 .Q
"RTN","RAWKLU1",131,0)
 K RANGE
"RTN","RAWKLU1",132,0)
 Q
"RTN","RAWKLU1",133,0)
 ;
"RTN","RAWKLU1",134,0)
CFMAT ;ImgTyp Abbr^colabbr-cpt80^col-data80^colabbr-rvu132^col-data132^colabbr-rvu80^col-data80
"RTN","RAWKLU1",135,0)
 ;;RAD^23^21^34^29^30^25
"RTN","RAWKLU1",136,0)
 ;;MRI^29^27^45^40^40^35
"RTN","RAWKLU1",137,0)
 ;;CT^36^33^56^50^51^45
"RTN","RAWKLU1",138,0)
 ;;US^42^39^66^60^61^55
"RTN","RAWKLU1",139,0)
 ;;NUC^47^45^75^70^14^9
"RTN","RAWKLU1",140,0)
 ;;VAS^53^51^85^80^25^20
"RTN","RAWKLU1",141,0)
 ;;ANI^59^57^95^91^36^31
"RTN","RAWKLU1",142,0)
 ;;CARD^64^63^104^100^46^42
"RTN","RAWKLU1",143,0)
 ;;MAM^70^67^115^110^58^53
"RTN","RAWKLU1",144,0)
 ;;Total^75^74^125^120^70^65
"RTN","RAWKLU1",145,0)
 ;;
"RTN","RAWKLU2")
0^5^B37550729^n/a
"RTN","RAWKLU2",1,0)
RAWKLU2 ;HISC/GJC-physician wRVU (scaled too) by procedure ;10/26/05  14:57
"RTN","RAWKLU2",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**64**;Mar 16, 1998;Build 5
"RTN","RAWKLU2",3,0)
 ;
"RTN","RAWKLU2",4,0)
 ;DBIA#:1995 ($$CPT^ICPTCOD) resolves the CPT code pointer to the CPT
"RTN","RAWKLU2",5,0)
 ;      code value
"RTN","RAWKLU2",6,0)
 ;DBIA#:1996 ($$MOD^ICPTMOD) resolves the CPT modifer pointer to the
"RTN","RAWKLU2",7,0)
 ;      CPT modifier value
"RTN","RAWKLU2",8,0)
 ;DBIA#:4799 ($$RVU^FBRVU) return wRVU value for CPT, CPT Mod, & exam
"RTN","RAWKLU2",9,0)
 ;      date/time 
"RTN","RAWKLU2",10,0)
 ;DBIA#:10060 EN1^RASELCT enacts 10060 which allows lookups on the NEW
"RTN","RAWKLU2",11,0)
 ;            PERSON (#200) file
"RTN","RAWKLU2",12,0)
 ;DBIA#:10063 ($$S^%ZTLOAD)
"RTN","RAWKLU2",13,0)
 ;DBIA#:10103 ($$FMTE^XLFDT) & ($$NOW^XLFDT)
"RTN","RAWKLU2",14,0)
 ;DBIA#:10104 ($$CJ^XLFSTR)
"RTN","RAWKLU2",15,0)
 ;DBIA#:1519  ($$EN^XUTMDEVQ)
"RTN","RAWKLU2",16,0)
 ;
"RTN","RAWKLU2",17,0)
EN(RASCLD) ;Identifies the option that the user wishes to execute.
"RTN","RAWKLU2",18,0)
 ;input: RASCLD=zero for non-scaled wRVU, & one for the scaled wRVU
"RTN","RAWKLU2",19,0)
 ;              report.
"RTN","RAWKLU2",20,0)
 ;
"RTN","RAWKLU2",21,0)
 K ^TMP($J,"RA STFPHYS"),^TMP("RA STFPHYS-IEN",$J)
"RTN","RAWKLU2",22,0)
 ;
"RTN","RAWKLU2",23,0)
PHYST ;allow the user to select one/many/all physicians
"RTN","RAWKLU2",24,0)
 ;(w/ staff classification) ;DBIA#: 10060
"RTN","RAWKLU2",25,0)
 S RADIC="^VA(200,",RADIC(0)="QEAMZ",RAUTIL="RA STFPHYS"
"RTN","RAWKLU2",26,0)
 S RADIC("A")="Select Physician: ",RADIC("B")="All"
"RTN","RAWKLU2",27,0)
 S RADIC("S")="I $D(^VA(200,""ARC"",""S"",+Y))\10"
"RTN","RAWKLU2",28,0)
 W !! D EN1^RASELCT(.RADIC,RAUTIL) K %W,%Y1,DIC,RADIC,RAUTIL,X,Y
"RTN","RAWKLU2",29,0)
 ;did the user select physicians to compile data on? if not, quit
"RTN","RAWKLU2",30,0)
 I $O(^TMP($J,"RA STFPHYS",""))="" D  Q
"RTN","RAWKLU2",31,0)
 .W !!?3,$C(7),"Staff Physician data was not selected."
"RTN","RAWKLU2",32,0)
 .Q
"RTN","RAWKLU2",33,0)
 ;
"RTN","RAWKLU2",34,0)
 ;build a new staff physician array (the other array is subscripted by
"RTN","RAWKLU2",35,0)
 ;physician name then IEN) subscripting by staff physician IEN this
"RTN","RAWKLU2",36,0)
 ;allows us to check the IEN of the staff physician selected by the
"RTN","RAWKLU2",37,0)
 ;user against the IEN of the staff physician on the exam record
"RTN","RAWKLU2",38,0)
 S X="" F  S X=$O(^TMP($J,"RA STFPHYS",X)) Q:X=""  D
"RTN","RAWKLU2",39,0)
 .S Y=0
"RTN","RAWKLU2",40,0)
 .F  S Y=$O(^TMP($J,"RA STFPHYS",X,Y)) Q:'Y  S ^TMP("RA STFPHYS-IEN",$J,Y)=""
"RTN","RAWKLU2",41,0)
 .Q
"RTN","RAWKLU2",42,0)
 ;
"RTN","RAWKLU2",43,0)
 K ^TMP($J,"RA STFPHYS") S RADATE=$$FMTE^XLFDT($$NOW^XLFDT\1,1)
"RTN","RAWKLU2",44,0)
 ;
"RTN","RAWKLU2",45,0)
STRTDT ;Prompt the user for the starting verified date
"RTN","RAWKLU2",46,0)
 S RASTART=$$STRTDT^RAWKLU1(RADATE,2110101)
"RTN","RAWKLU2",47,0)
 I RASTART=-1 D XIT Q
"RTN","RAWKLU2",48,0)
 S RABGDTI=$P(RASTART,U),RABGDTX=$P(RASTART,U,2),RAMBGDT=RABGDTI-.0001
"RTN","RAWKLU2",49,0)
 ;need inv. verified date to search ^RARPT("AA",
"RTN","RAWKLU2",50,0)
 S RAMBGDT=9999999.9999-RABGDTI
"RTN","RAWKLU2",51,0)
 K RASTART
"RTN","RAWKLU2",52,0)
 ;
"RTN","RAWKLU2",53,0)
ENDDT ;Prompt the user for the ending verified date
"RTN","RAWKLU2",54,0)
 S RAEND=$$ENDDT^RAWKLU1(RABGDTI,RABGDTX)
"RTN","RAWKLU2",55,0)
 I RAEND=-1 D XIT Q
"RTN","RAWKLU2",56,0)
 S RAENDTI=$P(RAEND,U),RAENDTX=$P(RAEND,U,2),RAMENDT=RAENDTI+.9999
"RTN","RAWKLU2",57,0)
 ;need inv. verified date to search ^RARPT("AA",
"RTN","RAWKLU2",58,0)
 S RAMENDT=9999999.9999-RAMENDT
"RTN","RAWKLU2",59,0)
 K RAEND
"RTN","RAWKLU2",60,0)
 ;
"RTN","RAWKLU2",61,0)
 F I="^TMP(""RA STFPHYS-IEN"",$J,","RADATE","RAB*","RAM*","RAE*","RASCLD" S ZTSAVE(I)=""
"RTN","RAWKLU2",62,0)
 S I="RA print procedures, wRVUs, and their totals for a physician"
"RTN","RAWKLU2",63,0)
 D EN^XUTMDEVQ("START^RAWKLU2",I,.ZTSAVE,,1)
"RTN","RAWKLU2",64,0)
 I +$G(ZTSK)>0 W !!,"Task Number: "_ZTSK,!
"RTN","RAWKLU2",65,0)
 K I,ZTSAVE,ZTSK
"RTN","RAWKLU2",66,0)
 Q
"RTN","RAWKLU2",67,0)
 ;
"RTN","RAWKLU2",68,0)
START ;check exams based on criteria input by user; physician & exam D/T
"RTN","RAWKLU2",69,0)
 ;eliminate the exam record is one of the following conditions is true:
"RTN","RAWKLU2",70,0)
 ;1-the status of the exam is 'Cancelled'
"RTN","RAWKLU2",71,0)
 ;2-the physician(s) selected are not the primary staff for the exam
"RTN","RAWKLU2",72,0)
 ;
"RTN","RAWKLU2",73,0)
 S:$D(ZTQUEUED)#2 ZTREQ="@"
"RTN","RAWKLU2",74,0)
 K ^TMP($J,"RA BY STFPHYS")
"RTN","RAWKLU2",75,0)
 S RARPTVDT=RAMBGDT,(RACNT,RAXIT)=0
"RTN","RAWKLU2",76,0)
 F  S RARPTVDT=$O(^RARPT("AA",RARPTVDT),-1) Q:'RARPTVDT!(RARPTVDT<RAMENDT)  D  Q:RAXIT
"RTN","RAWKLU2",77,0)
 .S RARPTIEN=0
"RTN","RAWKLU2",78,0)
 .F  S RARPTIEN=$O(^RARPT("AA",RARPTVDT,RARPTIEN)) Q:'RARPTIEN  D  Q:RAXIT
"RTN","RAWKLU2",79,0)
 ..S RARPT=$G(^RARPT(RARPTIEN,0)),RADFN=+$P(RARPT,U,2),RADTE=+$P(RARPT,U,3)
"RTN","RAWKLU2",80,0)
 ..S RADTI=9999999.9999-RADTE,RA7002=$G(^RADPT(RADFN,"DT",RADTI,0))
"RTN","RAWKLU2",81,0)
 ..S RAXAMDT=+$P(RA7002,U) Q:'RAXAMDT
"RTN","RAWKLU2",82,0)
 ..;must check every exam registered for this exam date/time; we might have a printset
"RTN","RAWKLU2",83,0)
 ..S RACNI=0 F  S RACNI=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI)) Q:'RACNI  D XAM
"RTN","RAWKLU2",84,0)
 ..Q
"RTN","RAWKLU2",85,0)
 .Q
"RTN","RAWKLU2",86,0)
 D EN^RAWKLU3 ;output the report
"RTN","RAWKLU2",87,0)
 D XIT
"RTN","RAWKLU2",88,0)
 Q
"RTN","RAWKLU2",89,0)
 ;
"RTN","RAWKLU2",90,0)
XAM ; get exam information; procedure name, exam status order #, int. staff phys...
"RTN","RAWKLU2",91,0)
 S RA7003=$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,0)) Q:'RA7003
"RTN","RAWKLU2",92,0)
 Q:$P(RA7003,U,17)'=RARPTIEN  ;exam references a different report!
"RTN","RAWKLU2",93,0)
 S RAPRCIEN=+$P(RA7003,U,2) Q:'RAPRCIEN
"RTN","RAWKLU2",94,0)
 S RAPRCIEN(0)=$P($G(^RAMIS(71,RAPRCIEN,0)),U) Q:RAPRCIEN(0)=""
"RTN","RAWKLU2",95,0)
 S RACNT=RACNT+1
"RTN","RAWKLU2",96,0)
 ;
"RTN","RAWKLU2",97,0)
 ;did the user stop the task? Check every five hundred records...
"RTN","RAWKLU2",98,0)
 S:RACNT#500=0 (RAXIT,ZTSTOP)=$$S^%ZTLOAD() Q:RAXIT
"RTN","RAWKLU2",99,0)
 ;
"RTN","RAWKLU2",100,0)
 ;1-begin exam status check
"RTN","RAWKLU2",101,0)
 Q:$P($G(^RA(72,+$P(RA7003,U,3),0)),U,3)=0  ;cancelled...
"RTN","RAWKLU2",102,0)
 ;end exam status check
"RTN","RAWKLU2",103,0)
 ;
"RTN","RAWKLU2",104,0)
 ;2-begin physician check
"RTN","RAWKLU2",105,0)
 Q:'$P(RA7003,U,15)  ;no physician, quit check
"RTN","RAWKLU2",106,0)
 Q:'$D(^TMP("RA STFPHYS-IEN",$J,$P(RA7003,U,15)))#2
"RTN","RAWKLU2",107,0)
 ;end physician check
"RTN","RAWKLU2",108,0)
 ;
"RTN","RAWKLU2",109,0)
 S RACPT=$P($G(^RAMIS(71,+$P(RA7003,U,2),0)),U,9) Q:'RACPT  ;ptr to file #81
"RTN","RAWKLU2",110,0)
 S RACPT=$P($$CPT^ICPTCOD(RACPT,RAXAMDT),U,2) ;CPT code is 2nd piece
"RTN","RAWKLU2",111,0)
 S RASTF=$$EXTERNAL^DILFD(70.03,15,,$P(RA7003,U,15))
"RTN","RAWKLU2",112,0)
 D SETARRY K RA7003,RACPT,RAPRCIEN,RASTF
"RTN","RAWKLU2",113,0)
 Q
"RTN","RAWKLU2",114,0)
 ;
"RTN","RAWKLU2",115,0)
SETARRY ;find the wRVU value (either un-scaled or scaled) for a particular CPT
"RTN","RAWKLU2",116,0)
 ;or CPT code/CPT modifier combination. The case identifiers, CPT code
"RTN","RAWKLU2",117,0)
 ;(RACPT), & exam date (RAXAMDT) are known.
"RTN","RAWKLU2",118,0)
 ;
"RTN","RAWKLU2",119,0)
 ;get CPT code modifier string
"RTN","RAWKLU2",120,0)
 S RACPTMOD="",RABILAT=0
"RTN","RAWKLU2",121,0)
 I $O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",0))>0 S RAI=0 D
"RTN","RAWKLU2",122,0)
 .F  S RAI=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",RAI)) Q:'RAI  D
"RTN","RAWKLU2",123,0)
 ..S RACPTMOD(0)=+$G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CMOD",RAI,0))
"RTN","RAWKLU2",124,0)
 ..S RA813(0)=$$MOD^ICPTMOD(RACPTMOD(0),"I",RAXAMDT)
"RTN","RAWKLU2",125,0)
 ..I 'RABILAT,$P(RA813(0),U,2)=50 S RABILAT=1 ;bilateral multiplier=2
"RTN","RAWKLU2",126,0)
 ..S RACPTMOD=RACPTMOD_$P(RA813(0),U,2)_","
"RTN","RAWKLU2",127,0)
 ..Q
"RTN","RAWKLU2",128,0)
 .Q
"RTN","RAWKLU2",129,0)
 ;get wRVU value from FEE BASIS; returns a string: status^value^message
"RTN","RAWKLU2",130,0)
 ;where status'=1 means "in error". All exams prior to 1/1/1999 will use
"RTN","RAWKLU2",131,0)
 ;1999 wRVU values for their calculations.
"RTN","RAWKLU2",132,0)
 S RAWRVU=$$RVU^FBRVU(RACPT,RACPTMOD,$S(RAXAMDT<2990101:2990101,1:RAXAMDT))
"RTN","RAWKLU2",133,0)
 I $P(RAWRVU,U)=1 D
"RTN","RAWKLU2",134,0)
 .;apply bilateral multiplier if appropriate
"RTN","RAWKLU2",135,0)
 .S:RABILAT RAWRVU=$P(RAWRVU,U,2)*2
"RTN","RAWKLU2",136,0)
 .;or not...
"RTN","RAWKLU2",137,0)
 .S:'RABILAT RAWRVU=$P(RAWRVU,U,2)
"RTN","RAWKLU2",138,0)
 .I RASCLD S RAWRVU=RAWRVU*$$SFCTR^RAWRVUP($P(RA7002,U,2),RAXAMDT)
"RTN","RAWKLU2",139,0)
 .Q
"RTN","RAWKLU2",140,0)
 ;
"RTN","RAWKLU2",141,0)
 E  S RAWRVU=0 ;status some other value than 1; "in error"
"RTN","RAWKLU2",142,0)
 S:RAWRVU>0 RAWRVU=$J(RAWRVU,1,2) ;do not round the value...
"RTN","RAWKLU2",143,0)
 ;
"RTN","RAWKLU2",144,0)
 ;^TMP($J,"RA BY STFPHYS",RASTF)=total # procedures^wRVU total(all proc)
"RTN","RAWKLU2",145,0)
 ;^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRCIEN(0))=^total # RACPT^
"RTN","RAWKLU2",146,0)
 ;                                                        total # RAWRVU
"RTN","RAWKLU2",147,0)
 ;
"RTN","RAWKLU2",148,0)
 S:'$D(^TMP($J,"RA BY STFPHYS",RASTF))#2 ^(RASTF)="0^0"
"RTN","RAWKLU2",149,0)
 S $P(^TMP($J,"RA BY STFPHYS",RASTF),U)=$P(^TMP($J,"RA BY STFPHYS",RASTF),U)+1
"RTN","RAWKLU2",150,0)
 S $P(^TMP($J,"RA BY STFPHYS",RASTF),U,2)=$P(^TMP($J,"RA BY STFPHYS",RASTF),U,2)+RAWRVU
"RTN","RAWKLU2",151,0)
 S:'$D(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRCIEN(0)))#2 ^(RAPRCIEN(0))="^0^0"
"RTN","RAWKLU2",152,0)
 S $P(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRCIEN(0)),U,2)=+$P($G(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRCIEN(0))),U,2)+1
"RTN","RAWKLU2",153,0)
 S $P(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRCIEN(0)),U,3)=RAWRVU*(+$P(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRCIEN(0)),U,2))
"RTN","RAWKLU2",154,0)
 ;
"RTN","RAWKLU2",155,0)
 K RA813,RABILAT,RACPTMOD,RAI,RAWRVU
"RTN","RAWKLU2",156,0)
 Q
"RTN","RAWKLU2",157,0)
 ;
"RTN","RAWKLU2",158,0)
XIT ;kill variables and exit
"RTN","RAWKLU2",159,0)
 W:$G(ZTSTOP)=1 !,$$CJ^XLFSTR("USER STOPPED PROCESS THROUGH TASKMAN",IOM)
"RTN","RAWKLU2",160,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT,RA7002,RABGDTI,RABGDTX,RACNI,RACNT,RADATE
"RTN","RAWKLU2",161,0)
 K RADFN,RADTE,RADTI,RAENDTI,RAENDTX,RAMBGDT,RAMENDT,RAQUIT,RARPT,RARPTIEN
"RTN","RAWKLU2",162,0)
 K RARPTVDT,RAXAMDT,RAXIT,X,Y
"RTN","RAWKLU2",163,0)
 K ^TMP("RA STFPHYS-IEN",$J),^TMP($J,"RA BY STFPHYS")
"RTN","RAWKLU2",164,0)
 Q
"RTN","RAWKLU2",165,0)
 ;
"RTN","RAWKLU3")
0^6^B12473282^n/a
"RTN","RAWKLU3",1,0)
RAWKLU3 ;HISC/GJC-physician wRVU (scaled too) by procedure ;10/26/05  14:57 [3/15/06 12:30pm]
"RTN","RAWKLU3",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**64**;Mar 16, 1998;Build 5
"RTN","RAWKLU3",3,0)
 ;
"RTN","RAWKLU3",4,0)
 ;DBIA#:2541 ($$KSP^XUPARAM) returns the DEFAULT INSTITUTION (#217)
"RTN","RAWKLU3",5,0)
 ;      from the KERNEL SYSTEM PARAMETERS (#8989.3) file.
"RTN","RAWKLU3",6,0)
 ;DBIA#:2171 ($$NAME^XUAF4) resolves the DEFAULT INSTITUTION value into
"RTN","RAWKLU3",7,0)
 ;      the name of the facility
"RTN","RAWKLU3",8,0)
 ;DBIA#:10063 ($$S^%ZTLOAD)
"RTN","RAWKLU3",9,0)
 ;DBIA#:10103 ($$FMTE^XLFDT) & ($$NOW^XLFDT)
"RTN","RAWKLU3",10,0)
 ;DBIA#:10104 ($$CJ^XLFSTR)
"RTN","RAWKLU3",11,0)
 ;
"RTN","RAWKLU3",12,0)
EN ;entry point; called from RAWKLU2...
"RTN","RAWKLU3",13,0)
 S RAFAC=$$NAME^XUAF4(+$$KSP^XUPARAM("INST"))
"RTN","RAWKLU3",14,0)
 S:RAFAC="" RAFAC="***undefined facility name***"
"RTN","RAWKLU3",15,0)
 S $P(RALN,"-",IOM+1)="",(RACNT,RAPG,RAXIT)=0
"RTN","RAWKLU3",16,0)
 S RAHDR="IMAGING PHYSICIAN "_$S(RASCLD=1:"SCALED",1:"UN-SCALED")_" wRVU SUMMARY BY CPT"
"RTN","RAWKLU3",17,0)
 S RARDATE=$$FMTE^XLFDT($$NOW^XLFDT,"1D")
"RTN","RAWKLU3",18,0)
 ;
"RTN","RAWKLU3",19,0)
 ;get the data from the global array and print it...
"RTN","RAWKLU3",20,0)
 D HDR S RASTF=""
"RTN","RAWKLU3",21,0)
 F  S RASTF=$O(^TMP($J,"RA BY STFPHYS",RASTF)) Q:RASTF=""  D  Q:RAXIT  D PHYTTL
"RTN","RAWKLU3",22,0)
 .S RADAT(0)=$G(^TMP($J,"RA BY STFPHYS",RASTF))
"RTN","RAWKLU3",23,0)
 .S RATTLXP=$P(RADAT(0),U),RATLRVUP=$P(RADAT(0),U,2)
"RTN","RAWKLU3",24,0)
 .W !,RASTF S RACPT=""
"RTN","RAWKLU3",25,0)
 .F  S RACPT=$O(^TMP($J,"RA BY STFPHYS",RASTF,RACPT)) Q:RACPT=""  D  Q:RAXIT
"RTN","RAWKLU3",26,0)
 ..S RAWRVU=""
"RTN","RAWKLU3",27,0)
 ..F  S RAWRVU=$O(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU)) Q:RAWRVU=""  D  Q:RAXIT
"RTN","RAWKLU3",28,0)
 ...S RAPRC=""
"RTN","RAWKLU3",29,0)
 ...F  S RAPRC=$O(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRC)) Q:RAPRC=""  D  Q:RAXIT
"RTN","RAWKLU3",30,0)
 ....S RADAT(1)=$G(^TMP($J,"RA BY STFPHYS",RASTF,RACPT,RAWRVU,RAPRC))
"RTN","RAWKLU3",31,0)
 ....S RATTLX=$P(RADAT(1),U,2) ;total # of exams
"RTN","RAWKLU3",32,0)
 ....S RATTLRVU=$P(RADAT(1),U,3) ;total wRVU for a multiple occurances of the same CPT
"RTN","RAWKLU3",33,0)
 ....S RACNT=RACNT+1 S:RACNT#500=0 (RAXIT,ZTSTOP)=$$S^%ZTLOAD() Q:RAXIT
"RTN","RAWKLU3",34,0)
 ....I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU3",35,0)
 ....W !?2,RACPT,?12,$E(RAPRC,1,35),?50,$J(RAWRVU,6,2),?58,$J(RATTLX,8,0),?70,$J(RATTLRVU,8,2)
"RTN","RAWKLU3",36,0)
 ....Q
"RTN","RAWKLU3",37,0)
 ...Q
"RTN","RAWKLU3",38,0)
 ..Q
"RTN","RAWKLU3",39,0)
 .Q
"RTN","RAWKLU3",40,0)
 ;
"RTN","RAWKLU3",41,0)
 I RAXIT D XIT Q
"RTN","RAWKLU3",42,0)
 I 'RACNT W !,$$CJ^XLFSTR("No data found for this report",IOM) D XIT Q 
"RTN","RAWKLU3",43,0)
 ;
"RTN","RAWKLU3",44,0)
DSPSFTR ;display CY i-type scaling factors if appropriate
"RTN","RAWKLU3",45,0)
 I RASCLD=1 S RASFACTR="" D
"RTN","RAWKLU3",46,0)
 .I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU3",47,0)
 .W !!,"For calendar year "_($E(DT,1,3)+1700)_" the following scaling factors apply:"
"RTN","RAWKLU3",48,0)
 .S I=0
"RTN","RAWKLU3",49,0)
 .F  S I=$O(^RA(79.2,I)) Q:'I  D:$O(^RA(79.2,I,"CY",0))>0  Q:RAXIT
"RTN","RAWKLU3",50,0)
 ..S I(0)=$G(^RA(79.2,I,0))
"RTN","RAWKLU3",51,0)
 ..I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU3",52,0)
 ..W !,$P(I(0),U),?34,$P(I(0),U,3),?49,$$SFCTR^RAWRVUP(I,DT)
"RTN","RAWKLU3",53,0)
 ..Q
"RTN","RAWKLU3",54,0)
 .Q 
"RTN","RAWKLU3",55,0)
XIT ;exit and kill variables
"RTN","RAWKLU3",56,0)
 K I,RACNT,RACPT,RADAT,RAFAC,RAHDR,RAI,RALN,RAPG,RAPRC,RARDATE,RASFACTR
"RTN","RAWKLU3",57,0)
 K RASTF,RATLRVUP,RATTLRVU,RATTLX,RATTLXP,RAWRVU
"RTN","RAWKLU3",58,0)
 Q
"RTN","RAWKLU3",59,0)
 ;
"RTN","RAWKLU3",60,0)
HDR ; Header for our report
"RTN","RAWKLU3",61,0)
 W:RAPG!($E(IOST,1,2)="C-") @IOF
"RTN","RAWKLU3",62,0)
 S RAPG=RAPG+1
"RTN","RAWKLU3",63,0)
 W !?(IOM-$L(RAHDR)\2),RAHDR
"RTN","RAWKLU3",64,0)
 W !,"Run Date: ",RARDATE,?68,"Page: ",RAPG
"RTN","RAWKLU3",65,0)
 W !,"Facility: ",RAFAC,?41,"Date Range: ",RABGDTX_" - "_RAENDTX
"RTN","RAWKLU3",66,0)
 ;header formatting logic for CPT scaled/un-scaled wRVU reports
"RTN","RAWKLU3",67,0)
 W:'$D(RASFACTR)#2 !!,"Staff Physician",?58,"Total #",?73,"Total",!?2,"CPT Code",?12,"Procedure",?51,$S(RASCLD=1:"SwRVU",1:" wRVU"),?58,"of exams",?73,$S(RASCLD=1:"SwRVU",1:" wRVU")
"RTN","RAWKLU3",68,0)
 W:$D(RASFACTR)#2 !,"Imaging Type",?34,"Abbreviation",?49,"wRVU scaling factor"
"RTN","RAWKLU3",69,0)
 W !,RALN
"RTN","RAWKLU3",70,0)
 Q
"RTN","RAWKLU3",71,0)
 ;
"RTN","RAWKLU3",72,0)
PHYTTL ;print the procedure & wRVU totals for the staff physician
"RTN","RAWKLU3",73,0)
 I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWKLU3",74,0)
 W !?59,"-------",?71,"-------",!?58,$J(RATTLXP,8,0),?70,$J(RATLRVUP,8,2)
"RTN","RAWKLU3",75,0)
 Q
"RTN","RAWKLU3",76,0)
 ;
"RTN","RAWRVUP")
0^1^B28533070^n/a
"RTN","RAWRVUP",1,0)
RAWRVUP ;HISC/GJC-Display procedures with their wRVU values  ;10/26/05  14:57
"RTN","RAWRVUP",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**64**;Mar 16, 1998;Build 5
"RTN","RAWRVUP",3,0)
 ;
"RTN","RAWRVUP",4,0)
 ;DBIA#:1995 ($$CPT^ICPTCOD) resolves the CPT code pointer to the CPT
"RTN","RAWRVUP",5,0)
 ;      code value
"RTN","RAWRVUP",6,0)
 ;DBIA#:1996 ($$MOD^ICPTMOD) resolves the CPT modifer pointer to the
"RTN","RAWRVUP",7,0)
 ;      CPT modifier value
"RTN","RAWRVUP",8,0)
 ;DBIA#:4799 ($$RVU^FBRVU) return wRVU value for CPT, CPT Mod, & exam
"RTN","RAWRVUP",9,0)
 ;      date/time
"RTN","RAWRVUP",10,0)
 ;DBIA#:10060 EN1^RASELCT enacts 10060 which allows lookups on the NEW
"RTN","RAWRVUP",11,0)
 ;            PERSON (#200) file
"RTN","RAWRVUP",12,0)
 ;DBIA#:10063 ($$S^%ZTLOAD)
"RTN","RAWRVUP",13,0)
 ;DBIA#:10103 ($$FMTE^XLFDT) & ($$NOW^XLFDT)
"RTN","RAWRVUP",14,0)
 ;DBIA#:10104 ($$CJ^XLFSTR)
"RTN","RAWRVUP",15,0)
 ;DBIA#:1519  ($$EN^XUTMDEVQ)
"RTN","RAWRVUP",16,0)
 ;
"RTN","RAWRVUP",17,0)
EN(RASCLD) ;entry point
"RTN","RAWRVUP",18,0)
 ;input: RASCLD=one if scaled, 0 if un-scaled
"RTN","RAWRVUP",19,0)
 K ^TMP($J,"RA PROCEDURES")
"RTN","RAWRVUP",20,0)
 ;
"RTN","RAWRVUP",21,0)
PROC ;allow the user to select one/many/all Rad/Nuc Med procedures
"RTN","RAWRVUP",22,0)
 S RADIC="^RAMIS(71,",RADIC(0)="QEAMZ",RAUTIL="RA PROCEDURES"
"RTN","RAWRVUP",23,0)
 S RADIC("A")="Select Procedures: ",RADIC("B")="All",RAXIT=0
"RTN","RAWRVUP",24,0)
 ;screen: based on user selection of procedure activity and that the
"RTN","RAWRVUP",25,0)
 ;procedure must have a CPT code (only detailed and series procedures)
"RTN","RAWRVUP",26,0)
 S RADIC("S")="I $P(^(0),U,9)" ;must have a CPT code (detailed/series)
"RTN","RAWRVUP",27,0)
 W !! D EN1^RASELCT(.RADIC,RAUTIL)
"RTN","RAWRVUP",28,0)
 S RAXIT=RAQUIT K %W,%Y1,DIC,RADIC,RAQUIT,RAUTIL,X,Y
"RTN","RAWRVUP",29,0)
 ;did the user select physicians to compile data on? if not, quit
"RTN","RAWRVUP",30,0)
 I $O(^TMP($J,"RA PROCEDURES",""))="" D  D XIT Q
"RTN","RAWRVUP",31,0)
 .W !!?3,$C(7),"Rad/Nuc Med Procedures were not selected."
"RTN","RAWRVUP",32,0)
 .Q
"RTN","RAWRVUP",33,0)
 ;
"RTN","RAWRVUP",34,0)
 F I="RASCLD","^TMP($J,""RA PROCEDURES""," S ZTSAVE(I)=""
"RTN","RAWRVUP",35,0)
 S I="RA print wRVUs for Rad/Nuc Med procedures"
"RTN","RAWRVUP",36,0)
 D EN^XUTMDEVQ("START^RAWRVUP",I,.ZTSAVE,,1)
"RTN","RAWRVUP",37,0)
 I +$G(ZTSK)>0 W !!,"Task Number: "_ZTSK,!
"RTN","RAWRVUP",38,0)
 K I,ZTSAVE,ZTSK
"RTN","RAWRVUP",39,0)
 Q
"RTN","RAWRVUP",40,0)
 ;
"RTN","RAWRVUP",41,0)
START ;
"RTN","RAWRVUP",42,0)
 S:$D(ZTQUEUED)#2 ZTREQ="@"
"RTN","RAWRVUP",43,0)
 S $P(RALN,"-",IOM+1)="",(RACNT,RAPG,RAXIT)=0
"RTN","RAWRVUP",44,0)
 S RARUNDT=$$FMTE^XLFDT(DT,"1P")
"RTN","RAWRVUP",45,0)
 S RAHDR="PROCEDURE CPT CODE AND"_$S(RASCLD=1:" SCALED",1:"")_" WORK RELATIVE VALUE UNITS (wRVU)"
"RTN","RAWRVUP",46,0)
 S RAX="" D HDR
"RTN","RAWRVUP",47,0)
 F  S RAX=$O(^TMP($J,"RA PROCEDURES",RAX)) Q:RAX=""  D  Q:RAXIT
"RTN","RAWRVUP",48,0)
 .S RAY=0
"RTN","RAWRVUP",49,0)
 .F  S RAY=$O(^TMP($J,"RA PROCEDURES",RAX,RAY)) Q:'RAY  D  Q:RAXIT
"RTN","RAWRVUP",50,0)
 ..S RACNT=RACNT+1 S:RACNT#500=0 (RAXIT,ZTSTOP)=$$S^%ZTLOAD() Q:RAXIT
"RTN","RAWRVUP",51,0)
 ..S RAMIS(0)=$G(^RAMIS(71,RAY,0))
"RTN","RAWRVUP",52,0)
 ..S RAPROC=$E($P(RAMIS(0),U),1,35) ;truncate to thirty-five chars 
"RTN","RAWRVUP",53,0)
 ..S RAPTYPE=$S($P(RAMIS(0),U,6)="D":"Detailed",1:"Series")
"RTN","RAWRVUP",54,0)
 ..S RAITYPE=$P($G(^RA(79.2,+$P(RAMIS(0),U,12),0)),U,3)
"RTN","RAWRVUP",55,0)
 ..S RACPT=$P(RAMIS(0),U,9),RACPT=$P($$CPT^ICPTCOD(RACPT,DT),U,2)
"RTN","RAWRVUP",56,0)
 ..;determine if there are default CPT modifiers for this procedure; if
"RTN","RAWRVUP",57,0)
 ..;so, does one indicate 'bilateral'? If bilateral multiply wRVU by two.
"RTN","RAWRVUP",58,0)
 ..S RACPTMOD="",RABILAT=0
"RTN","RAWRVUP",59,0)
 ..I $O(^RAMIS(71,RAY,"DCM",0))>0 S RAI=0 D
"RTN","RAWRVUP",60,0)
 ...F  S RAI=$O(^RAMIS(71,RAY,"DCM",RAI)) Q:'RAI  D
"RTN","RAWRVUP",61,0)
 ....S RACPTMOD(0)=+$G(^RAMIS(71,RAY,"DCM",RAI,0))
"RTN","RAWRVUP",62,0)
 ....S RA813(0)=$$MOD^ICPTMOD(RACPTMOD(0),"I",DT)
"RTN","RAWRVUP",63,0)
 ....I 'RABILAT,$P(RA813(0),U,2)=50 S RABILAT=1 ;bilateral multiplier=2
"RTN","RAWRVUP",64,0)
 ....S RACPTMOD=RACPTMOD_$P(RA813(0),U,2)_","
"RTN","RAWRVUP",65,0)
 ....Q
"RTN","RAWRVUP",66,0)
 ...Q
"RTN","RAWRVUP",67,0)
 ..;get wRVU value from FEE BASIS; returns a string: status^value^message
"RTN","RAWRVUP",68,0)
 ..;where status'=1 means "in error"
"RTN","RAWRVUP",69,0)
 ..S RAWRVU=$$RVU^FBRVU(RACPT,RACPTMOD,DT)
"RTN","RAWRVUP",70,0)
 ..I $P(RAWRVU,U)=1 D
"RTN","RAWRVUP",71,0)
 ...;apply bilateral multiplier if appropriate
"RTN","RAWRVUP",72,0)
 ...S:RABILAT RAWRVU=$P(RAWRVU,U,2)*2
"RTN","RAWRVUP",73,0)
 ...;or not...
"RTN","RAWRVUP",74,0)
 ...S:'RABILAT RAWRVU=$P(RAWRVU,U,2)
"RTN","RAWRVUP",75,0)
 ...Q
"RTN","RAWRVUP",76,0)
 ..E  S RAWRVU=0 ;status some other value than 1; "in error"
"RTN","RAWRVUP",77,0)
 ..;
"RTN","RAWRVUP",78,0)
 ..S:RAWRVU>0 RAWRVU=$J(RAWRVU,1,2)
"RTN","RAWRVUP",79,0)
 ..;
"RTN","RAWRVUP",80,0)
SCALED ..;when scaled find scaled wRVU value
"RTN","RAWRVUP",81,0)
 ..I RASCLD=1,(RAWRVU>0) D
"RTN","RAWRVUP",82,0)
 ...S RASFACTR=$$SFCTR(+$P(RAMIS(0),U,12)) ;pass i-type ptr
"RTN","RAWRVUP",83,0)
 ...S RASWRVU=$J((RAWRVU*RASFACTR),1,2)
"RTN","RAWRVUP",84,0)
 ...Q
"RTN","RAWRVUP",85,0)
 ..E  S RASWRVU=0 ;mult by zero
"RTN","RAWRVUP",86,0)
 ..;
"RTN","RAWRVUP",87,0)
 ..W !,RAPROC,?37,RAPTYPE,?48,RAITYPE,?58,RACPT,?68,$S(RASCLD=1:$J(RASWRVU,7,2),1:$J(RAWRVU,7,2))
"RTN","RAWRVUP",88,0)
 ..I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() D:'RAXIT HDR
"RTN","RAWRVUP",89,0)
 ..Q
"RTN","RAWRVUP",90,0)
 .Q
"RTN","RAWRVUP",91,0)
 I 'RAXIT,(RASCLD) S RASFACTR(0)="" D
"RTN","RAWRVUP",92,0)
 .I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWRVUP",93,0)
 .W !!,"For calendar year "_($E(DT,1,3)+1700)_" the following scaling factors apply:"
"RTN","RAWRVUP",94,0)
 .S I=0
"RTN","RAWRVUP",95,0)
 .F  S I=$O(^RA(79.2,I)) Q:'I  D:$O(^RA(79.2,I,"CY",0))>0  Q:RAXIT
"RTN","RAWRVUP",96,0)
 ..S I(0)=$G(^RA(79.2,I,0))
"RTN","RAWRVUP",97,0)
 ..I $Y>(IOSL-4) S RAXIT=$$EOS^RAUTL5() Q:RAXIT  D HDR
"RTN","RAWRVUP",98,0)
 ..W !,$P(I(0),U),?34,$P(I(0),U,3),?49,$$SFCTR(I)
"RTN","RAWRVUP",99,0)
 ..Q
"RTN","RAWRVUP",100,0)
 .S RAXIT=$$EOS^RAUTL5()
"RTN","RAWRVUP",101,0)
 .Q
"RTN","RAWRVUP",102,0)
 D XIT
"RTN","RAWRVUP",103,0)
 Q
"RTN","RAWRVUP",104,0)
 ;
"RTN","RAWRVUP",105,0)
HDR ; Header for our report
"RTN","RAWRVUP",106,0)
 W:RAPG!($E(IOST,1,2)="C-") @IOF
"RTN","RAWRVUP",107,0)
 S RAPG=RAPG+1 W !?(IOM-$L(RAHDR)\2),RAHDR
"RTN","RAWRVUP",108,0)
 W !,"Run Date: ",RARUNDT,?68,"Page: ",RAPG
"RTN","RAWRVUP",109,0)
 W:'$D(RASFACTR(0))#2 !!,"Procedure",?37,"Proc Type",?48,"Img Type",?58,"CPT Code",?68,$S(RASCLD=1:"  S",1:"   ")_"wRVU"
"RTN","RAWRVUP",110,0)
 W:$D(RASFACTR(0))#2 !!,"Imaging Type",?34,"Abbreviation",?51,"wRVU scaling factor"
"RTN","RAWRVUP",111,0)
 W !,RALN
"RTN","RAWRVUP",112,0)
 Q
"RTN","RAWRVUP",113,0)
 ;
"RTN","RAWRVUP",114,0)
XIT ;kill variables and exit
"RTN","RAWRVUP",115,0)
 I 'RAXIT W:'RACNT !,$$CJ^XLFSTR("No data found for this report",IOM)
"RTN","RAWRVUP",116,0)
 K DILN,DTOUT,DUOUT,I,POP,RA813,RABILAT,RACNT,RACPT,RACPTMOD,RAHDR,RAI
"RTN","RAWRVUP",117,0)
 K RAITYPE,RALN,RAMIS,RAPTYPE,RAPG,RAPROC,RARUNDT,RASCLD,RASFACTR
"RTN","RAWRVUP",118,0)
 K RASWRVU,RAWRVU,RAX,RAXIT,RAY,RAYEAR,X,Y
"RTN","RAWRVUP",119,0)
 K ^TMP($J,"RA PROCEDURES")
"RTN","RAWRVUP",120,0)
 Q
"RTN","RAWRVUP",121,0)
 ;
"RTN","RAWRVUP",122,0)
SFCTR(RAITYP,RAYEAR) ;return the calendar year specific scaling factor for a
"RTN","RAWRVUP",123,0)
 ;specific imaging type
"RTN","RAWRVUP",124,0)
 ;input: RAITYP=imaging type
"RTN","RAWRVUP",125,0)
 ;       RAYEAR=internal FM date/time format; resolves to current year
"RTN","RAWRVUP",126,0)
 ;return: calendar year specific scaling factor
"RTN","RAWRVUP",127,0)
 N RASF,RAYR S RAYEAR=$G(RAYEAR,DT) ;default to DT (current year)
"RTN","RAWRVUP",128,0)
 S (RAYEAR,RAYR)=$E(RAYEAR,1,3)+1700
"RTN","RAWRVUP",129,0)
 S RASF=+$O(^RA(79.2,RAITYP,"CY","B",RAYEAR,0))
"RTN","RAWRVUP",130,0)
 ;if RASF=0 for the current year, check for the most recent year
"RTN","RAWRVUP",131,0)
 I RASF=0 D
"RTN","RAWRVUP",132,0)
 .S RAYEAR=+$O(^RA(79.2,1,"CY","B",RAYEAR),-1)
"RTN","RAWRVUP",133,0)
 .S RASF=+$O(^RA(79.2,RAITYP,"CY","B",RAYEAR,0))
"RTN","RAWRVUP",134,0)
 .Q
"RTN","RAWRVUP",135,0)
 S RASF=+$P($G(^RA(79.2,RAITYP,"CY",RASF,0)),U,2)
"RTN","RAWRVUP",136,0)
 S:RASF=0 RASF=1 ;defaults to one
"RTN","RAWRVUP",137,0)
 Q $J(RASF,$L(RASF),2)_$S(RAYR:" ("_RAYR_")",1:"")
"RTN","RAWRVUP",138,0)
 ;
"UP",79.2,79.22,-1)
79.2^CY
"UP",79.2,79.22,0)
79.22
"VER")
8.0^22.0
"^DD",79.2,79.2,200,0)
WORK RVU (wRVU) SCALING FACTOR^79.22A^^CY;0
"^DD",79.2,79.2,200,21,0)
^.001^2^2^3051118^^^^
"^DD",79.2,79.2,200,21,1,0)
Identifies the 'Society of Chairmen in Academic Radiology Departments' 
"^DD",79.2,79.2,200,21,2,0)
(SCARD) scaling factor for a specific imaging type by calendar year. 
"^DD",79.2,79.22,0)
WORK RVU (wRVU) SCALING FACTOR SUB-FIELD^^2^2
"^DD",79.2,79.22,0,"DT")
3051118
"^DD",79.2,79.22,0,"IX","B",79.22,.01)

"^DD",79.2,79.22,0,"NM","WORK RVU (wRVU) SCALING FACTOR")

"^DD",79.2,79.22,0,"UP")
79.2
"^DD",79.2,79.22,.01,0)
CALENDAR YEAR^NJ4,0^^0;1^K:+X'=X!(X>2099)!(X<1980)!(X?.E1"."1N.N) X
"^DD",79.2,79.22,.01,1,0)
^.1
"^DD",79.2,79.22,.01,1,1,0)
79.22^B
"^DD",79.2,79.22,.01,1,1,1)
S ^RA(79.2,DA(1),"CY","B",$E(X,1,30),DA)=""
"^DD",79.2,79.22,.01,1,1,2)
K ^RA(79.2,DA(1),"CY","B",$E(X,1,30),DA)
"^DD",79.2,79.22,.01,3)
Enter a four digit calendar year between 1980 and 2099.
"^DD",79.2,79.22,.01,21,0)
^^3^3^3051118^
"^DD",79.2,79.22,.01,21,1,0)
This field identifies the calendar year to associate a specific 'Society
"^DD",79.2,79.22,.01,21,2,0)
of Chairmen in Academic Radiology Departments' (SCARD) scaling factor to 
"^DD",79.2,79.22,.01,21,3,0)
imaging type specific procedures with an associated wRVU value.
"^DD",79.2,79.22,.01,"DT")
3051118
"^DD",79.2,79.22,2,0)
SCALING FACTOR^NJ5,2^^0;2^K:+X'=X!(X>99.99)!(X<0)!(X?.E1"."3N.N) X
"^DD",79.2,79.22,2,3)
This is the scaling factor to be applied to a wRVU value for this imaging type.
"^DD",79.2,79.22,2,21,0)
^^2^2^3051118^
"^DD",79.2,79.22,2,21,1,0)
This field identifies the appropriate scaling factor applied to the wRVU
"^DD",79.2,79.22,2,21,2,0)
value for an imaging type specific rad/nuc med procedure.
"^DD",79.2,79.22,2,"DT")
3051118
"BLD",5940,6)
^60
**END**
**END**
