Released OOPS*1*11 SEQ #11
Extracted from mail message
**KIDS**:OOPS*1.0*11^

**INSTALL NAME**
OOPS*1.0*11
"BLD",3276,0)
OOPS*1.0*11^ASISTS^0^3010803^y
"BLD",3276,1,0)
^^2^2^3010613^^^
"BLD",3276,1,1,0)
This patch contains the enhancements required to implement the Needlestick
"BLD",3276,1,2,0)
Act (HR 5178) in ASISTS.
"BLD",3276,4,0)
^9.64PA^2261.7^6
"BLD",3276,4,2260,0)
2260
"BLD",3276,4,2260,2,0)
^9.641^2260.01^3
"BLD",3276,4,2260,2,2260,0)
ASISTS ACCIDENT REPORTING  (File-top level)
"BLD",3276,4,2260,2,2260,1,0)
^9.6411^59^29
"BLD",3276,4,2260,2,2260,1,5,0)
SSN
"BLD",3276,4,2260,2,2260,1,28,0)
DESCRIPTION OF INCIDENT
"BLD",3276,4,2260,2,2260,1,29,0)
CHARACTERIZATION OF INJURY
"BLD",3276,4,2260,2,2260,1,30.1,0)
ADDITIONAL BODY PART AFFECTED
"BLD",3276,4,2260,2,2260,1,32,0)
DUTY RETURNED TO
"BLD",3276,4,2260,2,2260,1,34,0)
PATIENT SOURCE
"BLD",3276,4,2260,2,2260,1,35,0)
CONTAMINATION
"BLD",3276,4,2260,2,2260,1,36,0)
PURPOSE OF SHARP OBJECT
"BLD",3276,4,2260,2,2260,1,37,0)
ACTIVITY AT TIME OF INJURY
"BLD",3276,4,2260,2,2260,1,38,0)
OBJECT CAUSING INJURY
"BLD",3276,4,2260,2,2260,1,41,0)
BODILY FLUID EXPOSURE SOURCE
"BLD",3276,4,2260,2,2260,1,42,0)
EQUIPMENT/DEVICE FAILURE
"BLD",3276,4,2260,2,2260,1,43,0)
SAFETY DESIGN DEVICE USED
"BLD",3276,4,2260,2,2260,1,51,0)
CASE STATUS
"BLD",3276,4,2260,2,2260,1,54,0)
NEEDS XMIT TO NDB
"BLD",3276,4,2260,2,2260,1,57,0)
DATE TRANSMITTED TO NDB
"BLD",3276,4,2260,2,2260,1,59,0)
TRANSMITTED TO NDB
"BLD",3276,4,2260,2,2260,1,82,0)
BRAND
"BLD",3276,4,2260,2,2260,1,83,0)
DEVICE SIZE
"BLD",3276,4,2260,2,2260,1,84,0)
SAFETY CHARACTERISTICS
"BLD",3276,4,2260,2,2260,1,85,0)
SAFETY DEVICE NOT USED
"BLD",3276,4,2260,2,2260,1,86,0)
SERVICE
"BLD",3276,4,2260,2,2260,1,87,0)
INJ PRIOR TO SAFE DEV ENGAGED
"BLD",3276,4,2260,2,2260,1,214,0)
DATE FIRST AWARE OF ILLNESS
"BLD",3276,4,2260,2,2260,1,215,0)
DATE FIRST REALIZED CAUSE
"BLD",3276,4,2260,2,2260,1,250,0)
FIRST DATE MEDICAL CARE
"BLD",3276,4,2260,2,2260,1,252,0)
DATE NOTICE RECEIVED
"BLD",3276,4,2260,2,2260,1,253,0)
DATE/TIME WORK STOPPED
"BLD",3276,4,2260,2,2260,1,255,0)
DATE OF LAST EXPOSURE
"BLD",3276,4,2260,2,2260.01,0)
PERSONAL PROTECTIVE EQUIPMENT  (sub-file)
"BLD",3276,4,2260,2,2260.01,1,0)
^9.6411^.01^1
"BLD",3276,4,2260,2,2260.01,1,.01,0)
PERSONAL PROTECTIVE EQUIPMENT
"BLD",3276,4,2260,2,2260.039,0)
AREA EXPOSED TO BODILY FLUID  (sub-file)
"BLD",3276,4,2260,2,2260.039,1,0)
^9.6411^.01^1
"BLD",3276,4,2260,2,2260.039,1,.01,0)
AREA EXPOSED TO BODILY FLUID
"BLD",3276,4,2260,222)
y^n^p^^^^n
"BLD",3276,4,2261.7,0)
2261.7
"BLD",3276,4,2261.7,222)
y^n^f^^n^^y^o^n
"BLD",3276,4,2261.9,0)
2261.9
"BLD",3276,4,2261.9,222)
y^n^f^^n^^y^o^n
"BLD",3276,4,2262,0)
2262
"BLD",3276,4,2262,2,0)
^9.641^2262.03^1
"BLD",3276,4,2262,2,2262.03,0)
STATION  (sub-file)
"BLD",3276,4,2262,2,2262.03,1,0)
^9.6411^.7^1
"BLD",3276,4,2262,2,2262.03,1,.7,0)
OWCP CHARGEBACK CODE
"BLD",3276,4,2262,222)
y^n^p^^^^n
"BLD",3276,4,2262.2,0)
2262.2
"BLD",3276,4,2262.2,222)
y^n^f^^n^^y^o^n
"BLD",3276,4,2262.3,0)
2262.3
"BLD",3276,4,2262.3,222)
y^n^f^^n^^y^o^n
"BLD",3276,4,"APDD",2260,2260)

"BLD",3276,4,"APDD",2260,2260,5)

"BLD",3276,4,"APDD",2260,2260,28)

"BLD",3276,4,"APDD",2260,2260,29)

"BLD",3276,4,"APDD",2260,2260,30.1)

"BLD",3276,4,"APDD",2260,2260,32)

"BLD",3276,4,"APDD",2260,2260,34)

"BLD",3276,4,"APDD",2260,2260,35)

"BLD",3276,4,"APDD",2260,2260,36)

"BLD",3276,4,"APDD",2260,2260,37)

"BLD",3276,4,"APDD",2260,2260,38)

"BLD",3276,4,"APDD",2260,2260,41)

"BLD",3276,4,"APDD",2260,2260,42)

"BLD",3276,4,"APDD",2260,2260,43)

"BLD",3276,4,"APDD",2260,2260,51)

"BLD",3276,4,"APDD",2260,2260,54)

"BLD",3276,4,"APDD",2260,2260,57)

"BLD",3276,4,"APDD",2260,2260,59)

"BLD",3276,4,"APDD",2260,2260,82)

"BLD",3276,4,"APDD",2260,2260,83)

"BLD",3276,4,"APDD",2260,2260,84)

"BLD",3276,4,"APDD",2260,2260,85)

"BLD",3276,4,"APDD",2260,2260,86)

"BLD",3276,4,"APDD",2260,2260,87)

"BLD",3276,4,"APDD",2260,2260,214)

"BLD",3276,4,"APDD",2260,2260,215)

"BLD",3276,4,"APDD",2260,2260,250)

"BLD",3276,4,"APDD",2260,2260,252)

"BLD",3276,4,"APDD",2260,2260,253)

"BLD",3276,4,"APDD",2260,2260,255)

"BLD",3276,4,"APDD",2260,2260.01)

"BLD",3276,4,"APDD",2260,2260.01,.01)

"BLD",3276,4,"APDD",2260,2260.039)

"BLD",3276,4,"APDD",2260,2260.039,.01)

"BLD",3276,4,"APDD",2262,2262.03)

"BLD",3276,4,"APDD",2262,2262.03,.7)

"BLD",3276,4,"B",2260,2260)

"BLD",3276,4,"B",2261.7,2261.7)

"BLD",3276,4,"B",2261.9,2261.9)

"BLD",3276,4,"B",2262,2262)

"BLD",3276,4,"B",2262.2,2262.2)

"BLD",3276,4,"B",2262.3,2262.3)

"BLD",3276,"ABPKG")
n
"BLD",3276,"INI")
PRE^OOPSXP11
"BLD",3276,"KRN",0)
^9.67PA^19^17
"BLD",3276,"KRN",.4,0)
.4
"BLD",3276,"KRN",.401,0)
.401
"BLD",3276,"KRN",.402,0)
.402
"BLD",3276,"KRN",.403,0)
.403
"BLD",3276,"KRN",.5,0)
.5
"BLD",3276,"KRN",.84,0)
.84
"BLD",3276,"KRN",3.6,0)
3.6
"BLD",3276,"KRN",3.8,0)
3.8
"BLD",3276,"KRN",9.2,0)
9.2
"BLD",3276,"KRN",9.8,0)
9.8
"BLD",3276,"KRN",9.8,"NM",0)
^9.68A^30^23
"BLD",3276,"KRN",9.8,"NM",1,0)
OOPSSUP3^^0^B13871412
"BLD",3276,"KRN",9.8,"NM",2,0)
OOPSUTL2^^0^B44647751
"BLD",3276,"KRN",9.8,"NM",3,0)
OOPSUTL4^^0^B58891510
"BLD",3276,"KRN",9.8,"NM",4,0)
OOPSNDB^^0^B42742953
"BLD",3276,"KRN",9.8,"NM",5,0)
OOPSPRT^^0^B41633859
"BLD",3276,"KRN",9.8,"NM",6,0)
OOPSXP11^^0^B2927070
"BLD",3276,"KRN",9.8,"NM",7,0)
OOPSSUP1^^0^B32720571
"BLD",3276,"KRN",9.8,"NM",8,0)
OOPSNDBX^^0^B23721312
"BLD",3276,"KRN",9.8,"NM",9,0)
OOPSLOG^^0^B51748310
"BLD",3276,"KRN",9.8,"NM",10,0)
OOPSPRT1^^0^B30703468
"BLD",3276,"KRN",9.8,"NM",14,0)
OOPSESP^^0^B570277
"BLD",3276,"KRN",9.8,"NM",15,0)
OOPSWCE^^0^B48491557
"BLD",3276,"KRN",9.8,"NM",16,0)
OOPSWCE1^^0^B53507295
"BLD",3276,"KRN",9.8,"NM",17,0)
OOPSWCE2^^0^B55983187
"BLD",3276,"KRN",9.8,"NM",18,0)
OOPSEUT^^0^B697652
"BLD",3276,"KRN",9.8,"NM",23,0)
OOPSCA1^^0^B48090917
"BLD",3276,"KRN",9.8,"NM",24,0)
OOPSPC11^^0^B17860899
"BLD",3276,"KRN",9.8,"NM",25,0)
OOPSCA^^0^B3517524
"BLD",3276,"KRN",9.8,"NM",26,0)
OOPSUTL1^^0^B39699852
"BLD",3276,"KRN",9.8,"NM",27,0)
OOPSDOL^^0^B73621265
"BLD",3276,"KRN",9.8,"NM",28,0)
OOPSDOL1^^0^B65553981
"BLD",3276,"KRN",9.8,"NM",29,0)
OOPSDOL2^^0^B47024972
"BLD",3276,"KRN",9.8,"NM",30,0)
OOPSDOLX^^0^B17527935
"BLD",3276,"KRN",9.8,"NM","B","OOPSCA",25)

"BLD",3276,"KRN",9.8,"NM","B","OOPSCA1",23)

"BLD",3276,"KRN",9.8,"NM","B","OOPSDOL",27)

"BLD",3276,"KRN",9.8,"NM","B","OOPSDOL1",28)

"BLD",3276,"KRN",9.8,"NM","B","OOPSDOL2",29)

"BLD",3276,"KRN",9.8,"NM","B","OOPSDOLX",30)

"BLD",3276,"KRN",9.8,"NM","B","OOPSESP",14)

"BLD",3276,"KRN",9.8,"NM","B","OOPSEUT",18)

"BLD",3276,"KRN",9.8,"NM","B","OOPSLOG",9)

"BLD",3276,"KRN",9.8,"NM","B","OOPSNDB",4)

"BLD",3276,"KRN",9.8,"NM","B","OOPSNDBX",8)

"BLD",3276,"KRN",9.8,"NM","B","OOPSPC11",24)

"BLD",3276,"KRN",9.8,"NM","B","OOPSPRT",5)

"BLD",3276,"KRN",9.8,"NM","B","OOPSPRT1",10)

"BLD",3276,"KRN",9.8,"NM","B","OOPSSUP1",7)

"BLD",3276,"KRN",9.8,"NM","B","OOPSSUP3",1)

"BLD",3276,"KRN",9.8,"NM","B","OOPSUTL1",26)

"BLD",3276,"KRN",9.8,"NM","B","OOPSUTL2",2)

"BLD",3276,"KRN",9.8,"NM","B","OOPSUTL4",3)

"BLD",3276,"KRN",9.8,"NM","B","OOPSWCE",15)

"BLD",3276,"KRN",9.8,"NM","B","OOPSWCE1",16)

"BLD",3276,"KRN",9.8,"NM","B","OOPSWCE2",17)

"BLD",3276,"KRN",9.8,"NM","B","OOPSXP11",6)

"BLD",3276,"KRN",19,0)
19
"BLD",3276,"KRN",19,"NM",0)
^9.68A^^
"BLD",3276,"KRN",19.1,0)
19.1
"BLD",3276,"KRN",101,0)
101
"BLD",3276,"KRN",409.61,0)
409.61
"BLD",3276,"KRN",771,0)
771
"BLD",3276,"KRN",870,0)
870
"BLD",3276,"KRN",8994,0)
8994
"BLD",3276,"KRN","B",.4,.4)

"BLD",3276,"KRN","B",.401,.401)

"BLD",3276,"KRN","B",.402,.402)

"BLD",3276,"KRN","B",.403,.403)

"BLD",3276,"KRN","B",.5,.5)

"BLD",3276,"KRN","B",.84,.84)

"BLD",3276,"KRN","B",3.6,3.6)

"BLD",3276,"KRN","B",3.8,3.8)

"BLD",3276,"KRN","B",9.2,9.2)

"BLD",3276,"KRN","B",9.8,9.8)

"BLD",3276,"KRN","B",19,19)

"BLD",3276,"KRN","B",19.1,19.1)

"BLD",3276,"KRN","B",101,101)

"BLD",3276,"KRN","B",409.61,409.61)

"BLD",3276,"KRN","B",771,771)

"BLD",3276,"KRN","B",870,870)

"BLD",3276,"KRN","B",8994,8994)

"BLD",3276,"QUES",0)
^9.62^^
"BLD",3276,"REQB",0)
^9.611^2^2
"BLD",3276,"REQB",1,0)
OOPS*1.0*10^2
"BLD",3276,"REQB",2,0)
OOPS*1.0*9^2
"BLD",3276,"REQB","B","OOPS*1.0*10",1)

"BLD",3276,"REQB","B","OOPS*1.0*9",2)

"DATA",2261.7,1,0)
Disposable syringe ^1^N
"DATA",2261.7,3,0)
Blood gas syringe (ABG)^3^N
"DATA",2261.7,4,0)
Syringe, other type^4^N
"DATA",2261.7,5,0)
Needle on I.V. line ^5^N
"DATA",2261.7,6,0)
Winged steel needle I.V. set ^6^N
"DATA",2261.7,7,0)
I.V. catheter (stylet)^7^S
"DATA",2261.7,8,0)
Vacuum tube holder/needle blood^8^N
"DATA",2261.7,9,0)
Spinal or epidural needle^9^N
"DATA",2261.7,10,0)
Unattached hypodermic needle^10^N
"DATA",2261.7,11,0)
Art. cath introducer needle^11^N
"DATA",2261.7,12,0)
Central line cath introducer^12^S
"DATA",2261.7,13,0)
Drum catheter needle^13^N
"DATA",2261.7,14,0)
Other vascular catheter needle (cardiac, etc.)^14^N
"DATA",2261.7,15,0)
Other non-vascular cath needle ^15^N
"DATA",2261.7,16,0)
Needle, not sure what kind^16^N
"DATA",2261.7,18,0)
Lancet (finger or heel sticks)^18^S
"DATA",2261.7,19,0)
Suture needle^19^N
"DATA",2261.7,21,0)
Razor^21^S
"DATA",2261.7,22,0)
Pipette (plastic)^22^S
"DATA",2261.7,23,0)
Scissors^23^S
"DATA",2261.7,24,0)
Electrocautery device^24^S
"DATA",2261.7,25,0)
Bone cutter^25^S
"DATA",2261.7,26,0)
Bone chip^26^S
"DATA",2261.7,27,0)
Towel clip^27^S
"DATA",2261.7,28,0)
Microtome blade^28^S
"DATA",2261.7,29,0)
Trocar^29^S
"DATA",2261.7,30,0)
Vacuum tube (plastic)^30^S
"DATA",2261.7,31,0)
Specimen/test tube (plastic)^31^S
"DATA",2261.7,32,0)
Fingernails/teeth^32^S
"DATA",2261.7,33,0)
Scalpel, disposable^33^S
"DATA",2261.7,34,0)
Scalpel, reusable ^20^S
"DATA",2261.7,35,0)
Retractors, skin/bone hooks^34^S
"DATA",2261.7,36,0)
Staples/steel sutures^35^S
"DATA",2261.7,37,0)
Wire (suture/fixation/guide)^36^S
"DATA",2261.7,38,0)
Pin (fixation/guide pin)^37^S
"DATA",2261.7,39,0)
Drill bit/burr^38^S
"DATA",2261.7,40,0)
Pickup/forcep/hemostat/clamp^39^S
"DATA",2261.7,41,0)
Medication ampule^40^S
"DATA",2261.7,42,0)
Medication vial - rubber stopper^41^S
"DATA",2261.7,43,0)
Med/I.V. bottle (large volume)^42^S
"DATA",2261.7,44,0)
Pipette (glass)^43^S
"DATA",2261.7,45,0)
Vacuum tube (glass)^44^S
"DATA",2261.7,46,0)
Specimen/test tube (glass)^45^S
"DATA",2261.7,47,0)
Capillary tube^46^S
"DATA",2261.7,48,0)
Glass slide^47^S
"DATA",2261.7,49,0)
Sharp item, not sure what kind^48^S
"DATA",2261.7,51,0)
Pre-filled cartridge syringe ^2^N
"DATA",2261.7,64,0)
Other needle^17^N
"DATA",2261.7,65,0)
Other sharp item^49^S
"DATA",2261.7,66,0)
Blunt Suture Needle^50^N
"DATA",2261.7,67,0)
Insulin Syringe^51^N
"DATA",2261.9,1,0)
Self-Sheathing^1
"DATA",2261.9,2,0)
Self-Blunting^2
"DATA",2261.9,3,0)
Retracting^3
"DATA",2261.9,4,0)
Sheathing^4
"DATA",2261.9,5,0)
Two Handed Requirements^5
"DATA",2262.2,1,0)
14^N
"DATA",2262.2,2,0)
16^N
"DATA",2262.2,3,0)
18^N
"DATA",2262.2,4,0)
20^NS
"DATA",2262.2,5,0)
21^N
"DATA",2262.2,6,0)
22^N
"DATA",2262.2,7,0)
23^N
"DATA",2262.2,8,0)
25^NS
"DATA",2262.2,9,0)
27^N
"DATA",2262.2,10,0)
28^N
"DATA",2262.2,11,0)
1^S
"DATA",2262.2,12,0)
2^S
"DATA",2262.2,13,0)
3^S
"DATA",2262.2,14,0)
4^S
"DATA",2262.2,15,0)
5^S
"DATA",2262.2,16,0)
10^S
"DATA",2262.2,17,0)
OTHER^NS
"DATA",2262.2,18,0)
26^N
"DATA",2262.2,19,0)
6^S
"DATA",2262.3,1,0)
ABBOTT BUTTERFLY NEEDLE
"DATA",2262.3,2,0)
BD (BECTON-DICKINSON)
"DATA",2262.3,3,0)
BUTTERFLY NEEDLES W/SAFE-T-LOK
"DATA",2262.3,4,0)
BD (BECTON-DICKINSON) PRONTO NEEDLE HOLDER W/SAFETY RELEASE 
"DATA",2262.3,5,0)
BD (BECTON-DICKINSON) PRECISION GLIDE
"DATA",2262.3,6,0)
BD (BECTON-DICKINSON) VACUTAINER NEEDLES 
"DATA",2262.3,7,0)
BD (BECTON-DICKINSON) VACUTAINER NEEDLES W/ECLIPSE 
"DATA",2262.3,8,0)
BD (BECTON-DICKINSON) W/ATTACHED NEEDLE 
"DATA",2262.3,9,0)
BD (BECTON-DICKINSON) W/LUER LOC TIP 
"DATA",2262.3,10,0)
BD (BECTON-DICKINSON) W/LUER LOC TIP (PRECISION GLIDE) 
"DATA",2262.3,11,0)
HENRY SCHEIN METAL ASPIRATING SYRINGES
"DATA",2262.3,12,0)
MONOJECT 400
"DATA",2262.3,13,0)
PRONTO NEEDLE HOLDER DEVICES
"DATA",2262.3,14,0)
SAFE-T-LOK BUTTERFLIES
"DATA",2262.3,15,0)
SAFE-T-PRO LANCET
"DATA",2262.3,16,0)
SURGICUT INCISION INSTRUMENT
"DATA",2262.3,17,0)
TERUMO
"DATA",2262.3,18,0)
TERUMO W/LUER LOC TIP
"DATA",2262.3,19,0)
TERUMO W/LUER TAPER TIP
"DATA",2262.3,20,0)
US MEDICAL SAFESNAP SYRINGES
"FIA",2260)
ASISTS ACCIDENT REPORTING
"FIA",2260,0)
^OOPS(2260,
"FIA",2260,0,0)
2260I
"FIA",2260,0,1)
y^n^p^^^^n
"FIA",2260,0,10)

"FIA",2260,0,11)

"FIA",2260,0,"RLRO")

"FIA",2260,0,"VR")
1.0^OOPS
"FIA",2260,2260)
1
"FIA",2260,2260,5)

"FIA",2260,2260,28)

"FIA",2260,2260,29)

"FIA",2260,2260,30.1)

"FIA",2260,2260,32)

"FIA",2260,2260,34)

"FIA",2260,2260,35)

"FIA",2260,2260,36)

"FIA",2260,2260,37)

"FIA",2260,2260,38)

"FIA",2260,2260,39)

"FIA",2260,2260,40)

"FIA",2260,2260,41)

"FIA",2260,2260,42)

"FIA",2260,2260,43)

"FIA",2260,2260,51)

"FIA",2260,2260,54)

"FIA",2260,2260,57)

"FIA",2260,2260,59)

"FIA",2260,2260,82)

"FIA",2260,2260,83)

"FIA",2260,2260,84)

"FIA",2260,2260,85)

"FIA",2260,2260,86)

"FIA",2260,2260,87)

"FIA",2260,2260,214)

"FIA",2260,2260,215)

"FIA",2260,2260,250)

"FIA",2260,2260,252)

"FIA",2260,2260,253)

"FIA",2260,2260,255)

"FIA",2260,2260.01)
1
"FIA",2260,2260.01,.01)

"FIA",2260,2260.028)
0
"FIA",2260,2260.039)
1
"FIA",2260,2260.039,.01)

"FIA",2261.7)
ASISTS DEVICE/EQUIPMENT
"FIA",2261.7,0)
^OOPS(2261.7,
"FIA",2261.7,0,0)
2261.7
"FIA",2261.7,0,1)
y^n^f^^n^^y^o^n
"FIA",2261.7,0,10)

"FIA",2261.7,0,11)

"FIA",2261.7,0,"RLRO")

"FIA",2261.7,0,"VR")
1.0^OOPS
"FIA",2261.7,2261.7)
0
"FIA",2261.9)
ASISTS SAFETY CHARACTERISTICS
"FIA",2261.9,0)
^OOPS(2261.9,
"FIA",2261.9,0,0)
2261.9
"FIA",2261.9,0,1)
y^n^f^^n^^y^o^n
"FIA",2261.9,0,10)

"FIA",2261.9,0,11)

"FIA",2261.9,0,"RLRO")

"FIA",2261.9,0,"VR")
1.0^OOPS
"FIA",2261.9,2261.9)
0
"FIA",2262)
ASISTS SITE PARAMETER
"FIA",2262,0)
^OOPS(2262,
"FIA",2262,0,0)
2262
"FIA",2262,0,1)
y^n^p^^^^n
"FIA",2262,0,10)

"FIA",2262,0,11)

"FIA",2262,0,"RLRO")

"FIA",2262,0,"VR")
1.0^OOPS
"FIA",2262,2262)
1
"FIA",2262,2262.03)
1
"FIA",2262,2262.03,.7)

"FIA",2262.2)
ASISTS DEVICE SIZE
"FIA",2262.2,0)
^OOPS(2262.2,
"FIA",2262.2,0,0)
2262.2
"FIA",2262.2,0,1)
y^n^f^^n^^y^o^n
"FIA",2262.2,0,10)

"FIA",2262.2,0,11)

"FIA",2262.2,0,"RLRO")

"FIA",2262.2,0,"VR")
1.0^OOPS
"FIA",2262.2,2262.2)
0
"FIA",2262.3)
ASISTS NEEDLESTICK BRANDS
"FIA",2262.3,0)
^OOPS(2262.3,
"FIA",2262.3,0,0)
2262.3
"FIA",2262.3,0,1)
y^n^f^^n^^y^o^n
"FIA",2262.3,0,10)

"FIA",2262.3,0,11)

"FIA",2262.3,0,"RLRO")

"FIA",2262.3,0,"VR")
1.0^OOPS
"FIA",2262.3,2262.3)
0
"INI")
PRE^OOPSXP11
"IX",2261.9,2261.9,"C",0)
2261.9^C^Case Insensitive Lookup^MU^^F^IR^I^2261.9^^^^^LS
"IX",2261.9,2261.9,"C",.1,0)
^^1^1^3010308^
"IX",2261.9,2261.9,"C",.1,1,0)
This index is to provide a case insensitive lookup.
"IX",2261.9,2261.9,"C",1)
S ^OOPS(2261.9,"C",X,DA)=""
"IX",2261.9,2261.9,"C",2)
K ^OOPS(2261.9,"C",X,DA)
"IX",2261.9,2261.9,"C",2.5)
K ^OOPS(2261.9,"C")
"IX",2261.9,2261.9,"C",11.1,0)
^.114IA^1^1
"IX",2261.9,2261.9,"C",11.1,1,0)
1^F^2261.9^.01^30^1^F^Safety Characteristics
"IX",2261.9,2261.9,"C",11.1,1,2)
S X=$$UP^XLFSTR($E(X,1,30))
"IX",2261.9,2261.9,"C",11.1,1,3)

"IX",2262.2,2262.2,"D",0)
2262.2^D^^MU^^F^IR^I^2262.2^^^^^LS
"IX",2262.2,2262.2,"D",1)
Q
"IX",2262.2,2262.2,"D",2)
Q
"IX",2262.2,2262.2,"D",11.1,0)
^.114IA^^
"MBREQ")
0
"PKG",472,-1)
1^1
"PKG",472,0)
ASISTS^OOPS^Automated Safety Incident Surveillance Tracking System
"PKG",472,20,0)
^9.402P^^
"PKG",472,22,0)
^9.49I^1^1
"PKG",472,22,1,0)
1.0^^2980819^66481
"PKG",472,22,1,"PAH",1,0)
11^3010803
"PKG",472,22,1,"PAH",1,1,0)
^^2^2^3010803
"PKG",472,22,1,"PAH",1,1,1,0)
This patch contains the enhancements required to implement the Needlestick
"PKG",472,22,1,"PAH",1,1,2,0)
Act (HR 5178) in ASISTS.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
23
"RTN","OOPSCA")
0^25^B3517524
"RTN","OOPSCA",1,0)
OOPSCA ;HINES CIOFO/GWB-CREATE ASISTS AMENDMENT ;3/5/98
"RTN","OOPSCA",2,0)
 ;;1.0;ASISTS;**8,11**;Jun 01, 1998
"RTN","OOPSCA",3,0)
SUP S DIC="^OOPS(2260,",DIC("S")="I ($P(^OOPS(2260,Y,0),U,8)=DUZ)!($P(^OOPS(2260,Y,0),U,9)=DUZ),$P(^OOPS(2260,Y,0),U,6)=0" G DIC
"RTN","OOPSCA",4,0)
SO S DIC="^OOPS(2260,",DIC("S")="I $P(^OOPS(2260,Y,0),U,6)=0"
"RTN","OOPSCA",5,0)
DIC S DIC(0)="AEMNZ",DIC("A")="Select case to be amended: "
"RTN","OOPSCA",6,0)
 D ^DIC Q:(Y<1)!($D(DTOUT))!($D(DUOUT))
"RTN","OOPSCA",7,0)
 S OLDIEN=$P(Y,U),NUM=$P(^OOPS(2260,OLDIEN,0),U,1),SUF=$E(NUM,11)
"RTN","OOPSCA",8,0)
 S $P(^OOPS(2260,OLDIEN,0),U,6)=3
"RTN","OOPSCA",9,0)
 S NUM=$E(NUM,1,10)_$S(SUF="":"A",1:$CHAR($ASCII(SUF)+1))
"RTN","OOPSCA",10,0)
 K DD,DO S DIC="^OOPS(2260,",DIC(0)="QLZ",X=NUM D FILE^DICN G:Y=-1 EXIT
"RTN","OOPSCA",11,0)
 S NEWIEN=+Y
"RTN","OOPSCA",12,0)
 MERGE ^OOPS(2260,NEWIEN)=^OOPS(2260,OLDIEN)
"RTN","OOPSCA",13,0)
 ; patch 11 - set global into variable to use, set field 57 to ""
"RTN","OOPSCA",14,0)
 ;            so case can be resent to NDB
"RTN","OOPSCA",15,0)
 S OOP=^OOPS(2260,NEWIEN,0)
"RTN","OOPSCA",16,0)
 S $P(OOP,U,1)=NUM,$P(OOP,U,6)=0,$P(OOP,U,11)="",$P(OOP,U,19)=""
"RTN","OOPSCA",17,0)
 S ^OOPS(2260,NEWIEN,0)=OOP
"RTN","OOPSCA",18,0)
 S $P(^OOPS(2260,NEWIEN,"CA"),U,6)=""
"RTN","OOPSCA",19,0)
 S DIK="^OOPS(2260,",DA=NEWIEN D IX^DIK
"RTN","OOPSCA",20,0)
 K ^OOPS(2260,NEWIEN,"2162ES")
"RTN","OOPSCA",21,0)
 K ^OOPS(2260,NEWIEN,"CA1ES")
"RTN","OOPSCA",22,0)
 K ^OOPS(2260,NEWIEN,"CA2ES")
"RTN","OOPSCA",23,0)
 ; Clean up DOL cross reference - PATCH 8
"RTN","OOPSCA",24,0)
 N IEN,X,WCPDUZ,WOK
"RTN","OOPSCA",25,0)
 S WCPDUZ=$P($G(^OOPS(2260,NEWIEN,"WCES")),U)
"RTN","OOPSCA",26,0)
 I $G(WCPDUZ) S WOK=1,X=WCPDUZ,IEN=OLDIEN D WK^OOPSUTL1
"RTN","OOPSCA",27,0)
 K ^OOPS(2260,NEWIEN,"WCES")
"RTN","OOPSCA",28,0)
 W !!,"Case number ",NUM," has been assigned to this amended incident."
"RTN","OOPSCA",29,0)
 W !,"Use option ""Edit Report of Incident"" to complete this case."
"RTN","OOPSCA",30,0)
EXIT K DIC,OLDIEN,NEWIEN,NUM,SUF,X,Y,DIK,OOP
"RTN","OOPSCA",31,0)
 Q
"RTN","OOPSCA1")
0^23^B48090917
"RTN","OOPSCA1",1,0)
OOPSCA1 ;WIOFO/CAH-CA1 DISPLAY ;12/02/99
"RTN","OOPSCA1",2,0)
 ;;1.0;ASISTS;**6,8,11**;Jun 01, 1998
"RTN","OOPSCA1",3,0)
CA1(IEN,CALL) ;
"RTN","OOPSCA1",4,0)
CA1PG1 N LIN S PG=0,EX="",LIN=$S(($E(IOST,1,2)="C-"):IOSL-2,1:IOSL-6)
"RTN","OOPSCA1",5,0)
 K DIQ,DA,DR
"RTN","OOPSCA1",6,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSCA1",7,0)
 S DR=".01;1;4:12;15:17;60:63;70;107;108;110:118;121:124;126:136;138:149;150:169;171:174;175:185",DA=IEN,DIQ="OOPS"
"RTN","OOPSCA1",8,0)
 D EN^DIQ1
"RTN","OOPSCA1",9,0)
 ; Get witness data
"RTN","OOPSCA1",10,0)
 K DR
"RTN","OOPSCA1",11,0)
 N WIT,LSR
"RTN","OOPSCA1",12,0)
 S LSR=$P($G(^OOPS(2260,IEN,"CA1W",0)),U,3)
"RTN","OOPSCA1",13,0)
 S WIT=$O(^OOPS(2260,IEN,"CA1W",0))
"RTN","OOPSCA1",14,0)
 I $G(WIT) D
"RTN","OOPSCA1",15,0)
 . S DR="125",DR(2260.0125)=".01:7",DA=IEN
"RTN","OOPSCA1",16,0)
 . F II=WIT:1:LSR  I $D(^OOPS(2260,IEN,"CA1W",II)) S DA(2260.0125)=II D EN^DIQ1
"RTN","OOPSCA1",17,0)
 D HDR
"RTN","OOPSCA1",18,0)
 W !,"NAME OF EMPLOYEE...............: ",OOPS(2260,IEN,1) D P Q:EX=U
"RTN","OOPSCA1",19,0)
 W !,"SSN............................: ",OOPS(2260,IEN,5) D P Q:EX=U
"RTN","OOPSCA1",20,0)
 W !,"DOB............................: ",OOPS(2260,IEN,6) D P Q:EX=U
"RTN","OOPSCA1",21,0)
 W !,"SEX............................: ",OOPS(2260,IEN,7) D P Q:EX=U
"RTN","OOPSCA1",22,0)
 W !,"HOME TELEPHONE.................: ",OOPS(2260,IEN,12) D P Q:EX=U
"RTN","OOPSCA1",23,0)
 W !,"GRADE/STEP.....................: ",OOPS(2260,IEN,16) W:OOPS(2260,IEN,16)'="" "/" W OOPS(2260,IEN,17) D P Q:EX=U
"RTN","OOPSCA1",24,0)
 W !,"PAY PLAN.......................: ",OOPS(2260,IEN,63) D P Q:EX=U
"RTN","OOPSCA1",25,0)
 W !,"EMPLOYEE'S ADDRESS.............: ",OOPS(2260,IEN,8) D P Q:EX=U
"RTN","OOPSCA1",26,0)
 W !,"CITY...........................: ",OOPS(2260,IEN,9) D P Q:EX=U
"RTN","OOPSCA1",27,0)
 W !,"STATE..........................: ",OOPS(2260,IEN,10) D P Q:EX=U
"RTN","OOPSCA1",28,0)
 W !,"ZIP............................: ",OOPS(2260,IEN,11) D P Q:EX=U
"RTN","OOPSCA1",29,0)
 W !,"DEPENDENTS.....................: ",OOPS(2260,IEN,107) D P Q:EX=U
"RTN","OOPSCA1",30,0)
 W !,"PLACE WHERE INJURY OCCURRED....: ",OOPS(2260,IEN,108) D P Q:EX=U
"RTN","OOPSCA1",31,0)
 W !,"STREET WHERE INJURY OCCURRED...: ",OOPS(2260,IEN,183) D P Q:EX=U
"RTN","OOPSCA1",32,0)
 W !,"CITY WHERE INJURY OCCURRED.....: ",OOPS(2260,IEN,184) D P Q:EX=U
"RTN","OOPSCA1",33,0)
 W !,"STATE WHERE INJURY OCCURRED....: ",OOPS(2260,IEN,185) D P Q:EX=U
"RTN","OOPSCA1",34,0)
 W !,"ZIP CODE WHERE INJURY OCCURRED.: ",OOPS(2260,IEN,181) D P Q:EX=U
"RTN","OOPSCA1",35,0)
 W !,"DATE/TIME OF OCCURRENCE........: ",OOPS(2260,IEN,4) D P Q:EX=U
"RTN","OOPSCA1",36,0)
 W !,"DATE OF THIS NOTICE............: ",OOPS(2260,IEN,110) D P Q:EX=U
"RTN","OOPSCA1",37,0)
 W !,"EMPLOYEE'S OCCUPATION..........: ",OOPS(2260,IEN,111) D P Q:EX=U
"RTN","OOPSCA1",38,0)
 W !,"CAUSE OF INJURY CODE...........: ",OOPS(2260,IEN,126) D P Q:EX=U
"RTN","OOPSCA1",39,0)
 W !,"CAUSE OF INJURY................: ",OOPS(2260,IEN,112) D P Q:EX=U
"RTN","OOPSCA1",40,0)
 W !,"NATURE OF INJURY...............: ",OOPS(2260,IEN,113) D P Q:EX=U
"RTN","OOPSCA1",41,0)
 W !,"REQUEST PAY OR LEAVE...........: ",OOPS(2260,IEN,114) D P Q:EX=U
"RTN","OOPSCA1",42,0)
 W !,"EMPLOYEE DATE OF SIGNATURE.....: ",OOPS(2260,IEN,121) D P Q:EX=U
"RTN","OOPSCA1",43,0)
 I $D(OOPS(2260.0125)) F II=WIT:1:LSR I $D(OOPS(2260.0125,II)) D  Q:EX=U
"RTN","OOPSCA1",44,0)
 .W !,"WITNESS INFORMATION:"
"RTN","OOPSCA1",45,0)
 .W !,"NAME OF WITNESS................: ",OOPS(2260.0125,II,.01) D P Q:EX=U
"RTN","OOPSCA1",46,0)
 .W !,"WITNESS ADDRESS................: ",OOPS(2260.0125,II,1) D P Q:EX=U
"RTN","OOPSCA1",47,0)
 .W !,"WITNESS CITY...................: ",OOPS(2260.0125,II,2) D P Q:EX=U
"RTN","OOPSCA1",48,0)
 .W !,"WITNESS STATE..................: ",OOPS(2260.0125,II,3) D P Q:EX=U
"RTN","OOPSCA1",49,0)
 .W !,"WITNESS ZIP CODE...............: ",OOPS(2260.0125,II,4) D P Q:EX=U
"RTN","OOPSCA1",50,0)
 .W !,"DATE OF WITNESS SIGNATURE......: ",OOPS(2260.0125,II,5) D P Q:EX=U
"RTN","OOPSCA1",51,0)
 .W !,"STATEMENT OF WITNESS...........: ",OOPS(2260.0125,II,6) D P Q:EX=U
"RTN","OOPSCA1",52,0)
 I CALL="E" D  G KILL
"RTN","OOPSCA1",53,0)
 .I $E(IOST,1,2)="C-" W ! K DIR S DIR(0)="E" D ^DIR W @IOF
"RTN","OOPSCA1",54,0)
CA1PG2 ;
"RTN","OOPSCA1",55,0)
 ; Changed from field 122 to 15
"RTN","OOPSCA1",56,0)
 W !,"OCCUPATION CODE................: ",OOPS(2260,IEN,15) D P Q:EX=U
"RTN","OOPSCA1",57,0)
 W !,"NOI CODE.......................: ",OOPS(2260,IEN,62) D P Q:EX=U
"RTN","OOPSCA1",58,0)
 W !,"TYPE CODE......................: ",OOPS(2260,IEN,123) D P Q:EX=U
"RTN","OOPSCA1",59,0)
 W !,"SOURCE CODE....................: ",OOPS(2260,IEN,124) D P Q:EX=U
"RTN","OOPSCA1",60,0)
 W !,"OWCP CHARGEBACK CODE...........: ",OOPS(2260,IEN,70) D P Q:EX=U
"RTN","OOPSCA1",61,0)
 D:$D(OOPS(2260,IEN,130))  Q:EX=U
"RTN","OOPSCA1",62,0)
 .W !,"AGENCY NAME....................: ",OOPS(2260,IEN,130) D P Q:EX=U
"RTN","OOPSCA1",63,0)
 .W !,"AGENCY ADDRESS.................: ",OOPS(2260,IEN,131) D P Q:EX=U
"RTN","OOPSCA1",64,0)
 .W !,"AGENCY CITY....................: ",OOPS(2260,IEN,132) D P Q:EX=U
"RTN","OOPSCA1",65,0)
 .W !,"AGENCY STATE...................: ",OOPS(2260,IEN,133) D P Q:EX=U
"RTN","OOPSCA1",66,0)
 .W !,"AGENCY ZIP CODE................: ",OOPS(2260,IEN,134) D P Q:EX=U
"RTN","OOPSCA1",67,0)
 D:$D(OOPS(2260,IEN,176))  Q:EX=U
"RTN","OOPSCA1",68,0)
 .W !,"EMPLOYEE'S DUTY STATION........: ",OOPS(2260,IEN,176) D P Q:EX=U
"RTN","OOPSCA1",69,0)
 .W !,"DUTY STATION ADDRESS...........: ",OOPS(2260,IEN,177) D P Q:EX=U
"RTN","OOPSCA1",70,0)
 .W !,"DUTY STATION CITY..............: ",OOPS(2260,IEN,178) D P Q:EX=U
"RTN","OOPSCA1",71,0)
 .W !,"DUTY STATION STATE.............: ",OOPS(2260,IEN,179) D P Q:EX=U
"RTN","OOPSCA1",72,0)
 .W !,"DUTY STATION ZIP CODE..........: ",OOPS(2260,IEN,180) D P Q:EX=U
"RTN","OOPSCA1",73,0)
 W !,"EMPLOYEE RETIREMENT COVERAGE...: ",OOPS(2260,IEN,60) D P Q:EX=U
"RTN","OOPSCA1",74,0)
 I $D(OOPS(2260,IEN,61)) D  Q:EX=U
"RTN","OOPSCA1",75,0)
 . W !,"EMP RETIREMENT COVERAGE DESC...: ",OOPS(2260,IEN,61) D P Q:EX=U
"RTN","OOPSCA1",76,0)
 W !,"REGULAR HRS FROM TIME..........: ",OOPS(2260,IEN,138) D P Q:EX=U
"RTN","OOPSCA1",77,0)
 W !,"REGULAR HRS TO TIME............: ",OOPS(2260,IEN,139) D P Q:EX=U
"RTN","OOPSCA1",78,0)
 W !,"REGULAR WORK SCHEDULE..........: ",OOPS(2260,IEN,140) D P Q:EX=U
"RTN","OOPSCA1",79,0)
 W !,"DATE OF INJURY.................: ",OOPS(2260,IEN,4) D P Q:EX=U
"RTN","OOPSCA1",80,0)
 W !,"DATE NOTICE RECEIVED...........: ",OOPS(2260,IEN,175) D P Q:EX=U
"RTN","OOPSCA1",81,0)
 W !,"DATE/TIME STOPPED WORK.........: ",OOPS(2260,IEN,142) D P Q:EX=U
"RTN","OOPSCA1",82,0)
 W !,"DATE PAY STOPPED...............: ",OOPS(2260,IEN,143) D P Q:EX=U
"RTN","OOPSCA1",83,0)
 W !,"DATE 45 DAY PERIOD BEGAN.......: ",OOPS(2260,IEN,144) D P Q:EX=U
"RTN","OOPSCA1",84,0)
 W !,"DATE/TIME RETURNED TO WORK.....: ",OOPS(2260,IEN,145) D P Q:EX=U
"RTN","OOPSCA1",85,0)
 W !,"INJURED PERFORMING DUTY........: ",OOPS(2260,IEN,146) D P Q:EX=U
"RTN","OOPSCA1",86,0)
 W !,"NOT INJURED PERFORMING JOB.....: ",OOPS(2260,IEN,147) D P Q:EX=U
"RTN","OOPSCA1",87,0)
 W !,"INJURY CAUSED BY EMPLOYEE......: ",OOPS(2260,IEN,148) D P Q:EX=U
"RTN","OOPSCA1",88,0)
 W !,"CAUSED BY EMPLOYEE EXPLAIN.....: ",OOPS(2260,IEN,149) D P Q:EX=U
"RTN","OOPSCA1",89,0)
 W !,"INJURY CAUSED BY 3RD PARTY.....: ",OOPS(2260,IEN,150) D P Q:EX=U
"RTN","OOPSCA1",90,0)
 D:$D(OOPS(2260,IEN,151))  Q:EX=U
"RTN","OOPSCA1",91,0)
 .W !,"3RD PARTY NAME.................: ",OOPS(2260,IEN,151) D P Q:EX=U
"RTN","OOPSCA1",92,0)
 .W !,"3RD PARTY ADDRESS..............: ",OOPS(2260,IEN,152) D P Q:EX=U
"RTN","OOPSCA1",93,0)
 .W !,"3RD PARTY CITY.................: ",OOPS(2260,IEN,153) D P Q:EX=U
"RTN","OOPSCA1",94,0)
 .W !,"3RD PARTY STATE................: ",OOPS(2260,IEN,154) D P Q:EX=U
"RTN","OOPSCA1",95,0)
 .W !,"3RD PARTY ZIP CODE.............: ",OOPS(2260,IEN,155) D P Q:EX=U
"RTN","OOPSCA1",96,0)
 D:$D(OOPS(2260,IEN,156))  Q:EX=U
"RTN","OOPSCA1",97,0)
 .W !,"PROVIDING PHYSICAN NAME........: ",OOPS(2260,IEN,156) D P Q:EX=U
"RTN","OOPSCA1",98,0)
 .W !,"PROVIDING PHYSICIAN ADDRESS....: ",OOPS(2260,IEN,157) D P Q:EX=U
"RTN","OOPSCA1",99,0)
 .W !,"PROVIDING PHYSICIAN CITY.......: ",OOPS(2260,IEN,158) D P Q:EX=U
"RTN","OOPSCA1",100,0)
 .W !,"PROVIDING PHYSICIAN STATE......: ",OOPS(2260,IEN,159) D P Q:EX=U
"RTN","OOPSCA1",101,0)
 .W !,"PROVIDING PHYSICIAN ZIP CODE...: ",OOPS(2260,IEN,160) D P Q:EX=U
"RTN","OOPSCA1",102,0)
 .W !,"PROVIDING PHYSICIAN TITLE......: ",OOPS(2260,IEN,182) D P Q:EX=U
"RTN","OOPSCA1",103,0)
 W !,"FIRST DATE OF MEDICAL CARE.....: ",OOPS(2260,IEN,161) D P Q:EX=U
"RTN","OOPSCA1",104,0)
 W !,"DISABLED FOR WORK..............: ",OOPS(2260,IEN,162) D P Q:EX=U
"RTN","OOPSCA1",105,0)
 W !,"SUPERVISOR AGREE/DISAGREE......: ",OOPS(2260,IEN,163) D P Q:EX=U
"RTN","OOPSCA1",106,0)
 W !,"SUPERVISOR NOT AGREE EXPLAIN...: "
"RTN","OOPSCA1",107,0)
 S OPFLD=164 D WP K OPFLD Q:EX=U
"RTN","OOPSCA1",108,0)
 W !,"REASON FOR CONTROVERTS COP.....: "
"RTN","OOPSCA1",109,0)
 S OPFLD=165 D WP K OPFLD Q:EX=U
"RTN","OOPSCA1",110,0)
 W !,"PAY RATE WHEN WORK STOPPED.....: ",OOPS(2260,IEN,166),"/",OOPS(2260,IEN,167) D P Q:EX=U
"RTN","OOPSCA1",111,0)
 W !,"SUPERVISOR EXCEPTION...........: ",OOPS(2260,IEN,168) D P Q:EX=U
"RTN","OOPSCA1",112,0)
 D:$D(OOPS(2260,IEN,169))  Q:EX=U
"RTN","OOPSCA1",113,0)
 .W !,"NAME OF SUPERVISOR.............: ",OOPS(2260,IEN,169) D P Q:EX=U
"RTN","OOPSCA1",114,0)
 .W !,"SUPERVISOR'S DATE OF SIGNATURE.: ",OOPS(2260,IEN,171) D P Q:EX=U
"RTN","OOPSCA1",115,0)
 .W !,"SUPERVISOR'S TITLE.............: ",OOPS(2260,IEN,172) D P Q:EX=U
"RTN","OOPSCA1",116,0)
 .W !,"SUPERVISOR'S OFFICE PHONE......: ",OOPS(2260,IEN,173) D P Q:EX=U
"RTN","OOPSCA1",117,0)
 W !,"FILING INSTRUCTIONS............: ",OOPS(2260,IEN,174) D P Q:EX=U
"RTN","OOPSCA1",118,0)
 I $E(IOST,1,2)="C-" W ! K DIR S DIR(0)="E" D ^DIR W @IOF
"RTN","OOPSCA1",119,0)
KILL ;Kill Variables and Exit
"RTN","OOPSCA1",120,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","OOPSCA1",121,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT,IEN,DASHES,OOPS,DA,DO,EX
"RTN","OOPSCA1",122,0)
 K DO,DIQ,DISYS,DIW,DIWI,DIWT,DIWTC,DIWX,DN,DR,I,Z,POP
"RTN","OOPSCA1",123,0)
 Q
"RTN","OOPSCA1",124,0)
P ;PRINT
"RTN","OOPSCA1",125,0)
 I ($Y'<(LIN-3)) D  Q:EX=U
"RTN","OOPSCA1",126,0)
 .I $E(IOST,1,2)="C-" W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSCA1",127,0)
 .D HDR Q
"RTN","OOPSCA1",128,0)
 Q
"RTN","OOPSCA1",129,0)
WP ;Process Word Processing Fields
"RTN","OOPSCA1",130,0)
 N DIWL,DIWR,DIWF,OPGLB,OPI,OPNODE,OPT,OPC
"RTN","OOPSCA1",131,0)
 K ^UTILITY($J,"W")
"RTN","OOPSCA1",132,0)
 S DIWL=1,DIWR="",DIWF="|C76"
"RTN","OOPSCA1",133,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSCA1",134,0)
 S OPGLB="^OOPS(2260,IEN,OPNODE,OPI)"
"RTN","OOPSCA1",135,0)
 S OPI=0 F  S OPI=$O(@OPGLB) Q:'OPI  S X=$G(^(OPI,0)) D:X]"" ^DIWP
"RTN","OOPSCA1",136,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSCA1",137,0)
 I OPT S OPI=0 F OPC=1:1 S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI!(EX=U)  D
"RTN","OOPSCA1",138,0)
 .W !?1,^UTILITY($J,"W",1,OPI,0) D P Q:EX=U
"RTN","OOPSCA1",139,0)
 K ^UTILITY($J,"W"),X
"RTN","OOPSCA1",140,0)
 Q
"RTN","OOPSCA1",141,0)
HDR ;HEADER
"RTN","OOPSCA1",142,0)
 W @IOF S PG=PG+1 K DASHES S $P(DASHES,"-",80)="-"
"RTN","OOPSCA1",143,0)
 W !,"Case # ",OOPS(2260,IEN,.01),?73,"Page ",PG
"RTN","OOPSCA1",144,0)
 W !,DASHES
"RTN","OOPSCA1",145,0)
 Q
"RTN","OOPSDOL")
0^27^B73621265
"RTN","OOPSDOL",1,0)
OOPSDOL ;WIOFO/CAH-ASISTS TRANSMISSION OF CA1/CA2 TO DOL ;3/15/00
"RTN","OOPSDOL",2,0)
 ;;1.0;ASISTS;**8,11**;Jun 01, 1998
"RTN","OOPSDOL",3,0)
 ;
"RTN","OOPSDOL",4,0)
 N ARR,FIELD,FL,MSG,VAL,XMZ
"RTN","OOPSDOL",5,0)
 S MAN=1
"RTN","OOPSDOL",6,0)
 ;Check for security keys
"RTN","OOPSDOL",7,0)
 I '$D(^XUSEC("OOPS DOL XMIT DATA",DUZ)) D  G EXIT
"RTN","OOPSDOL",8,0)
 .S DIR(0)="FO" W !
"RTN","OOPSDOL",9,0)
 .S DIR("A")="You do not have the required Security Key."
"RTN","OOPSDOL",10,0)
 .S DIR("A")=DIR("A")_" Press Enter to continue"
"RTN","OOPSDOL",11,0)
 .D ^DIR K DIR
"RTN","OOPSDOL",12,0)
 ;Assure the Queue (Q-AST) has been defined
"RTN","OOPSDOL",13,0)
 S VAL="Q-AST.MED.VA.GOV",FIELD=.01,FL="X"
"RTN","OOPSDOL",14,0)
 D FIND^DIC(4.2,"",FIELD,FL,VAL,"","","","","ARR")
"RTN","OOPSDOL",15,0)
 I '$D(ARR("DILIST",1)) D  G EXIT
"RTN","OOPSDOL",16,0)
 .S DIR(0)="FO" W !
"RTN","OOPSDOL",17,0)
 .S DIR("A")="Domain not found in the DOMAIN File,"
"RTN","OOPSDOL",18,0)
 .S DIR("A")=DIR("A")_" No Transmission.  Press Enter to continue"
"RTN","OOPSDOL",19,0)
 .D ^DIR K DIR
"RTN","OOPSDOL",20,0)
 S DIR(0)="D"
"RTN","OOPSDOL",21,0)
 S DIR("A")="Re-transmit cases for what date "
"RTN","OOPSDOL",22,0)
 S DIR("?",1)="Enter the date of original transmission for cases "
"RTN","OOPSDOL",23,0)
 S DIR("?")="that need to be resent"
"RTN","OOPSDOL",24,0)
 D ^DIR K DIR G:$D(DIRUT) EXIT I Y S RDATE=Y
"RTN","OOPSDOL",25,0)
 S DIR(0)="Y",DIR("B")="Y",DIR("A")="Do you want to Queue Transmission"
"RTN","OOPSDOL",26,0)
 S DIR("?",1)="Enter 'Y' if you want the CA1/CA2 data placed in mail"
"RTN","OOPSDOL",27,0)
 S DIR("?")="message as part of a tasked job."
"RTN","OOPSDOL",28,0)
 D ^DIR K DIR G:$D(DIRUT) EXIT I Y D  G EXIT
"RTN","OOPSDOL",29,0)
 .S ZTRTN="EN^OOPSDOL",ZTIO=""
"RTN","OOPSDOL",30,0)
 .S ZTDESC="TRANSMIT DOL CA1/CA2 DATA"
"RTN","OOPSDOL",31,0)
 .D ^%ZTLOAD
"RTN","OOPSDOL",32,0)
 S DIR(0)="Y"
"RTN","OOPSDOL",33,0)
 S DIR("A")="Transmission NOT queued, OK to continue"
"RTN","OOPSDOL",34,0)
 D ^DIR K DIR I 'Y G EXIT
"RTN","OOPSDOL",35,0)
 S MSG("DIHELP",1)="Processing" W !
"RTN","OOPSDOL",36,0)
 D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSDOL",37,0)
EN ;Routine Entry
"RTN","OOPSDOL",38,0)
 S WOK=1
"RTN","OOPSDOL",39,0)
 N CNT,ERR,ERROR,FAIL,OPMG,OPQ
"RTN","OOPSDOL",40,0)
 K VMSG,INV                     ; used for data validation of records
"RTN","OOPSDOL",41,0)
 S CTR=1                        ; counter for Mail message array
"RTN","OOPSDOL",42,0)
 S (START,END,FAIL)=""
"RTN","OOPSDOL",43,0)
 ; Assure the Queue (Q-AST) has been defined
"RTN","OOPSDOL",44,0)
 S VAL="Q-AST.MED.VA.GOV",FIELD=.01,FL="X"
"RTN","OOPSDOL",45,0)
 D FIND^DIC(4.2,"",FIELD,FL,VAL,"","","","","ARR")
"RTN","OOPSDOL",46,0)
 I '$D(ARR("DILIST",1)) D  G EXIT
"RTN","OOPSDOL",47,0)
 . S ERROR(1)="The Queue Q-AST.MED.VA.GOV has not been created.  Please contact your IRM "
"RTN","OOPSDOL",48,0)
 . S ERROR(2)="Dept. to have Patch XM*999*136 installed; once installed complete manual "
"RTN","OOPSDOL",49,0)
 . S ERROR(3)="transmission of DOL Data."
"RTN","OOPSDOL",50,0)
 . D ERROR2
"RTN","OOPSDOL",51,0)
 ; Make sure Mail Group Exists
"RTN","OOPSDOL",52,0)
 S OPMG=$$FIND1^DIC(3.8,"","X","OOPS WC MESSAGE")
"RTN","OOPSDOL",53,0)
 I 'OPMG D  G EXIT
"RTN","OOPSDOL",54,0)
 . S ERROR(1)="The Mail Group OOPS WC MESSAGE is missing."
"RTN","OOPSDOL",55,0)
 . S ERROR(2)="Add the Group so that ASISTS data can be transmitted "
"RTN","OOPSDOL",56,0)
 . S ERROR(3)="to the AAC.  Then contact Worker Compensation office "
"RTN","OOPSDOL",57,0)
 . S ERROR(4)="to complete manual Transmission of DOL Data."
"RTN","OOPSDOL",58,0)
 . D ERROR
"RTN","OOPSDOL",59,0)
 ; Get list of members
"RTN","OOPSDOL",60,0)
 D LIST^DIC(3.81,","_OPMG_",","","",1,"","","","","","OPQ")
"RTN","OOPSDOL",61,0)
 I '$P(OPQ("DILIST",0),U) D  G EXIT
"RTN","OOPSDOL",62,0)
 . S ERROR(1)="There are no members of the OOPS WC MESSAGE "
"RTN","OOPSDOL",63,0)
 . S ERROR(1)=ERROR(1)_"Mail Group."
"RTN","OOPSDOL",64,0)
 . S ERROR(2)="Enter at least one member to the group.  This person "
"RTN","OOPSDOL",65,0)
 . S ERROR(3)="will receive messages concerning the transmission of "
"RTN","OOPSDOL",66,0)
 . S ERROR(4)="ASISTS DOL data to and from the AAC. After adding member"
"RTN","OOPSDOL",67,0)
 . S ERROR(5)="contact Worker Compensation office to complete manual transmission of DOL data."
"RTN","OOPSDOL",68,0)
 . D ERROR
"RTN","OOPSDOL",69,0)
GETREC ; Loop thru ^OOP(2260 "AW" or "AWC" XRef to get records to transmit
"RTN","OOPSDOL",70,0)
 ; AW=Schedule Transmission
"RTN","OOPSDOL",71,0)
 ; AWC=Manual Transmission
"RTN","OOPSDOL",72,0)
 N OOPDA,SMSG,STA,XMDUZ,XMTEXT,XMSUB,XMY,MDATA,VALID
"RTN","OOPSDOL",73,0)
 N Y,%,%H,%I
"RTN","OOPSDOL",74,0)
 K ^TMP($J,"C"),^TMP($J,"D")
"RTN","OOPSDOL",75,0)
 S (CNT,OOPDA)=0
"RTN","OOPSDOL",76,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD")
"RTN","OOPSDOL",77,0)
 S MTIME=$P(Y,"@",2),DATE=$$DC^OOPSUTL3(%)
"RTN","OOPSDOL",78,0)
 I $D(MAN) S INDEX="^OOPS(2260,""AWC"",OPI)",INDEX2="^OOPS(2260,""AWC"",OPI,OOPDA)"
"RTN","OOPSDOL",79,0)
 E  S INDEX="^OOPS(2260,""AW"",OPI)",INDEX2="^OOPS(2260,""AW"",OPI,OOPDA)"
"RTN","OOPSDOL",80,0)
 S OPI=0 F  S OPI=$O(@INDEX) Q:'OPI  D
"RTN","OOPSDOL",81,0)
 .S OOPDA=0 F  S OOPDA=$O(@INDEX2) Q:'OOPDA  D
"RTN","OOPSDOL",82,0)
 .. I $D(MAN),OPI'=RDATE Q
"RTN","OOPSDOL",83,0)
 .. I '$$VERIFY^OOPSUTL6(OOPDA) Q            ; verify data not chged 
"RTN","OOPSDOL",84,0)
 .. S VALID=$$VAL^OOPSUTL5(OOPDA)
"RTN","OOPSDOL",85,0)
 .. ; Get Station #, use w/Mail Grp by Station for messages, if there
"RTN","OOPSDOL",86,0)
 .. S STA=$$GET1^DIQ(4,$P(^OOPS(2260,OOPDA,"2162A"),U,9),99,"E")
"RTN","OOPSDOL",87,0)
 .. ; Valid Case
"RTN","OOPSDOL",88,0)
 .. I $G(VALID)'="" S CNT=CNT+1,^TMP($J,"C",OOPDA)="",SMSG(STA,OOPDA)="" Q
"RTN","OOPSDOL",89,0)
 .. ; Invalid Case
"RTN","OOPSDOL",90,0)
 .. S T="" F  S T=$O(NULL(T)) Q:'T  S ^TMP($J,"D",STA,OOPDA,T)=$G(NULL(T))
"RTN","OOPSDOL",91,0)
 S ^TMP($J,"C")=CNT
"RTN","OOPSDOL",92,0)
NOCASES ; No Cases to Send - Send Mail Message with only DOL segment
"RTN","OOPSDOL",93,0)
 I $D(MAN),CNT=0 D  G EXIT
"RTN","OOPSDOL",94,0)
 .S DIR(0)="FO"
"RTN","OOPSDOL",95,0)
 .S DIR("A")="No cases to transmit for requested date"
"RTN","OOPSDOL",96,0)
 .D ^DIR K DIR
"RTN","OOPSDOL",97,0)
 I CNT=0 D  G EXIT
"RTN","OOPSDOL",98,0)
 . S XMDUZ="ASISTS Report on Daily Transmission to the AAC"
"RTN","OOPSDOL",99,0)
 . S GRP="OOPS WC MESSAGE"
"RTN","OOPSDOL",100,0)
 . S XMY("G."_GRP)=""
"RTN","OOPSDOL",101,0)
 . ; If no one in mail group (this should not occur), send to user
"RTN","OOPSDOL",102,0)
 . I $D(XMY)<9 S XMY(DUZ)=""
"RTN","OOPSDOL",103,0)
 . S XMSUB="ASISTS no claims to process"
"RTN","OOPSDOL",104,0)
 . S XMTEXT="MSG("
"RTN","OOPSDOL",105,0)
 . S MSG(1)="There were no claims ready for transmission"
"RTN","OOPSDOL",106,0)
 . S MSG(2)="to the Austin Automation Center when the."
"RTN","OOPSDOL",107,0)
 . S MSG(3)="scheduled task last ran."
"RTN","OOPSDOL",108,0)
 . D ^XMD
"RTN","OOPSDOL",109,0)
 . K MSG
"RTN","OOPSDOL",110,0)
 . Q
"RTN","OOPSDOL",111,0)
PROCESS ;
"RTN","OOPSDOL",112,0)
 D CREATE G:FAIL EXIT
"RTN","OOPSDOL",113,0)
 ; START - First case number in MM, End - Last Case # in MM
"RTN","OOPSDOL",114,0)
 S OOPDA="",START="",END="",OPAST=""
"RTN","OOPSDOL",115,0)
 F  S OPAST=OOPDA,OOPDA=$O(^TMP($J,"C",OOPDA)) Q:OOPDA=""  D
"RTN","OOPSDOL",116,0)
 . D ^OOPSDOLX
"RTN","OOPSDOL",117,0)
 . ; if first send, Set DATE TRANSMITTED TO WCMIS in ^OOPS(2260
"RTN","OOPSDOL",118,0)
 . I $$GET1^DIQ(2260,OOPDA,66)="" D
"RTN","OOPSDOL",119,0)
 .. K DR S DIE="^OOPS(2260,",(IEN,DA)=OOPDA,DR="66///TODAY"
"RTN","OOPSDOL",120,0)
 .. D ^DIE K DR,DA,DIE
"RTN","OOPSDOL",121,0)
 . I $$GET1^DIQ(2260,OOPDA,199,"I")="Y" D WCP^OOPSMBUL(OOPDA,"E")
"RTN","OOPSDOL",122,0)
 ; If any records left to send and no FAILure
"RTN","OOPSDOL",123,0)
 I ($G(XMZ)'<1)&('FAIL) D
"RTN","OOPSDOL",124,0)
 . I END="" S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSDOL",125,0)
 . D SEND
"RTN","OOPSDOL",126,0)
EXIT ; Quit the program
"RTN","OOPSDOL",127,0)
 D BADREC              ; Send Mail if any Bad Records
"RTN","OOPSDOL",128,0)
 D SENTMSG             ; Send message to OOPS WCP with sent claims
"RTN","OOPSDOL",129,0)
 I $G(FAIL) D
"RTN","OOPSDOL",130,0)
 .S ERROR(1)="Mail Message was not created.  Contact Worker Compensation office "
"RTN","OOPSDOL",131,0)
 .S ERROR(2)="to complete the transmission of ASISTS DOL data."
"RTN","OOPSDOL",132,0)
 .D ERROR2
"RTN","OOPSDOL",133,0)
 K CTR,DATE,ERR,ERROR,GRP,INV,OPL,MSIZE,MTIME,XMSUB,XMTEXT,XMY,MSG,MAN
"RTN","OOPSDOL",134,0)
 K ^TMP($J),%DT,CATY,D,DO,DATA,DI,DIC,DISYS,DIW,DIWI,DAS,DIWT,DN,DQ
"RTN","OOPSDOL",135,0)
 K END,FL174,FLD,HOUR,I,INDEX,INDEX2,MAX,MIN,OOPSAR,OPAST,OPI,OSHA
"RTN","OOPSDOL",136,0)
 K OSHASC,P,RPOL,START,T,WOK,X,XMDUN,XMY,XMZ,Y,Z,RDATE,IEN,OPHM,CONV
"RTN","OOPSDOL",137,0)
 K COPDT,DIWTC,DIWX,OTIME,REL,SIEN
"RTN","OOPSDOL",138,0)
 Q
"RTN","OOPSDOL",139,0)
CREATE ; Create Mailman Message
"RTN","OOPSDOL",140,0)
 N OPDATA,SN
"RTN","OOPSDOL",141,0)
 S MSIZE=0
"RTN","OOPSDOL",142,0)
 I $G(XMZ)'<1 D SEND
"RTN","OOPSDOL",143,0)
 S OPL=0
"RTN","OOPSDOL",144,0)
 S XMSUB="ASISTS DOL DATA"
"RTN","OOPSDOL",145,0)
 S XMDUZ=DUZ
"RTN","OOPSDOL",146,0)
 D XMZ^XMA2 I XMZ<1 S FAIL=1 Q
"RTN","OOPSDOL",147,0)
 S SN=$P($G(^XMB(1,1,"XUS")),U,17)
"RTN","OOPSDOL",148,0)
 S SN=$E("0000000",$L(SN)+1,7)_SN
"RTN","OOPSDOL",149,0)
 S OPDATA="0DOL^ASISTS^"_SN_U_DATE
"RTN","OOPSDOL",150,0)
 S OPDATA=OPDATA_U_U_"001"_U_"|"
"RTN","OOPSDOL",151,0)
 S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=OPDATA
"RTN","OOPSDOL",152,0)
 Q
"RTN","OOPSDOL",153,0)
SEND ; Send Mailman Message
"RTN","OOPSDOL",154,0)
 N NUMCASE
"RTN","OOPSDOL",155,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_OPL_U_OPL_U_DT
"RTN","OOPSDOL",156,0)
 ; Set # of Cases in this Mail Message
"RTN","OOPSDOL",157,0)
 S NUMCASE=$S(START'="":START_"-"_END,1:0)
"RTN","OOPSDOL",158,0)
 S $P(^XMB(3.9,XMZ,2,1,0),U,5)=NUMCASE
"RTN","OOPSDOL",159,0)
 ; Indicate last line of message
"RTN","OOPSDOL",160,0)
 S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)="NNNN"_$C(13)_$C(10)
"RTN","OOPSDOL",161,0)
 S XMY(DUZ)=""                        ; also send here, in case of error.
"RTN","OOPSDOL",162,0)
 S XMY("XXX@Q-AST.MED.VA.GOV")=""
"RTN","OOPSDOL",163,0)
 S XMCHAN=1 D ENT1^XMD K XMCHAN
"RTN","OOPSDOL",164,0)
 K XMZ
"RTN","OOPSDOL",165,0)
 Q
"RTN","OOPSDOL",166,0)
BADREC ; If any records with missing data, send mail message
"RTN","OOPSDOL",167,0)
 S OOPDA=0,OPI=0,STA=""
"RTN","OOPSDOL",168,0)
 F  S STA=$O(^TMP($J,"D",STA)) Q:STA=""  K MSG S CTR=1 D
"RTN","OOPSDOL",169,0)
 . F  S OOPDA=$O(^TMP($J,"D",STA,OOPDA)) Q:OOPDA=""  D
"RTN","OOPSDOL",170,0)
 .. S MSG(CTR)="Case: "_$$GET1^DIQ(2260,OOPDA,.01)_" has missing required data or word processing fields that are",CTR=CTR+1
"RTN","OOPSDOL",171,0)
 .. S MSG(CTR)="larger than DOL requirements.  Please edit the case(s); and once completed,",CTR=CTR+1
"RTN","OOPSDOL",172,0)
 .. S MSG(CTR)="the cases will be transmitted with the next scheduled transmission. ",CTR=CTR+1
"RTN","OOPSDOL",173,0)
 .. F  S OPI=$O(^TMP($J,"D",STA,OOPDA,OPI)) Q:OPI=""  D
"RTN","OOPSDOL",174,0)
 ... S MSG(CTR)=" >"_$G(^TMP($J,"D",STA,OOPDA,OPI)),CTR=CTR+1
"RTN","OOPSDOL",175,0)
 .. S MSG(CTR)=$C(10),CTR=CTR+1
"RTN","OOPSDOL",176,0)
 . I $D(MSG) D
"RTN","OOPSDOL",177,0)
 .. S XMSUB="ASISTS Record(s) not transmitted for Station "_STA
"RTN","OOPSDOL",178,0)
 .. S GRP="OOPS WCP"
"RTN","OOPSDOL",179,0)
 .. I $$FIND1^DIC(3.8,"","AMX",GRP_" - "_STA) S GRP=GRP_" - "_STA
"RTN","OOPSDOL",180,0)
 .. S XMY("G."_GRP)=""
"RTN","OOPSDOL",181,0)
 .. S XMTEXT="MSG("
"RTN","OOPSDOL",182,0)
 .. D ^XMD
"RTN","OOPSDOL",183,0)
 Q
"RTN","OOPSDOL",184,0)
SENTMSG ; Send message to OOPS WCP mail group with claims sent to AAC
"RTN","OOPSDOL",185,0)
 N CNT,MSG,STA,STR,OOPDA
"RTN","OOPSDOL",186,0)
 S (STA,OOPDA)=""
"RTN","OOPSDOL",187,0)
 F  S STA=$O(SMSG(STA)) Q:STA=""  K MSG S CNT=1 D
"RTN","OOPSDOL",188,0)
 . S MSG(CNT)="The following claims have been transmitted to the AAC:"
"RTN","OOPSDOL",189,0)
 . S CNT=CNT+1
"RTN","OOPSDOL",190,0)
 . F  S OOPDA=$O(SMSG(STA,OOPDA)) Q:OOPDA=""  D
"RTN","OOPSDOL",191,0)
 .. S STR=^OOPS(2260,OOPDA,0)
"RTN","OOPSDOL",192,0)
 .. S MSG(CNT)="> "_$P(STR,U)_"     "_$P(STR,U,2),CNT=CNT+1
"RTN","OOPSDOL",193,0)
 . S XMSUB="ASISTS Record(s) transmitted to AAC for Station "_STA
"RTN","OOPSDOL",194,0)
 . S GRP="OOPS WCP"
"RTN","OOPSDOL",195,0)
 . I $$FIND1^DIC(3.8,"","AMX",GRP_" - "_STA) S GRP=GRP_" - "_STA
"RTN","OOPSDOL",196,0)
 . S XMY("G."_GRP)=""
"RTN","OOPSDOL",197,0)
 . S XMTEXT="MSG("
"RTN","OOPSDOL",198,0)
 . D ^XMD
"RTN","OOPSDOL",199,0)
 Q
"RTN","OOPSDOL",200,0)
ERROR ; Create appropriate Error message and Send message
"RTN","OOPSDOL",201,0)
 S XMDUZ="ASISTS Package"
"RTN","OOPSDOL",202,0)
 ; If no one in mail group (this should not occur), send to user
"RTN","OOPSDOL",203,0)
 I $D(XMY)<9 S XMY(DUZ)=""
"RTN","OOPSDOL",204,0)
 S XMSUB="ASISTS DOL Error Notification Message"
"RTN","OOPSDOL",205,0)
 S XMTEXT="ERROR("
"RTN","OOPSDOL",206,0)
 D ^XMD
"RTN","OOPSDOL",207,0)
 I '$D(ZTQUEUED) D
"RTN","OOPSDOL",208,0)
 . S MSG("DIHELP",1)="An Error Occurred during Processing, check"
"RTN","OOPSDOL",209,0)
 . S MSG("DIHELP",2)="Mailman Message for details."
"RTN","OOPSDOL",210,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSDOL",211,0)
 K ERROR
"RTN","OOPSDOL",212,0)
 Q
"RTN","OOPSDOL",213,0)
ERROR2 ; Create appropriate Error message and Send message
"RTN","OOPSDOL",214,0)
 S XMDUZ="ASISTS Package"
"RTN","OOPSDOL",215,0)
 S GRP="OOPS WC MESSAGE"
"RTN","OOPSDOL",216,0)
 D GRP^OOPSMBUL
"RTN","OOPSDOL",217,0)
 ; If no one in mail group (this should not occur), send to user
"RTN","OOPSDOL",218,0)
 I $D(XMY)<9 S XMY(DUZ)=""
"RTN","OOPSDOL",219,0)
 S XMSUB="ASISTS DOL Error Notification Message"
"RTN","OOPSDOL",220,0)
 S XMTEXT="ERROR("
"RTN","OOPSDOL",221,0)
 D ^XMD
"RTN","OOPSDOL",222,0)
 I '$D(ZTQUEUED) D
"RTN","OOPSDOL",223,0)
 . S MSG("DIHELP",1)="An Error Occurred during Processing, check"
"RTN","OOPSDOL",224,0)
 . S MSG("DIHELP",2)="Mailman Message for details."
"RTN","OOPSDOL",225,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSDOL",226,0)
 K ERROR
"RTN","OOPSDOL",227,0)
 Q
"RTN","OOPSDOL1")
0^28^B65553981
"RTN","OOPSDOL1",1,0)
OOPSDOL1 ;WIOFO/CAH-CA1 EXTRACT FOR DOL ;3/15/00
"RTN","OOPSDOL1",2,0)
 ;;1.0;ASISTS;**8,10,11**;Jun 01, 1998
"RTN","OOPSDOL1",3,0)
EN ; Entry
"RTN","OOPSDOL1",4,0)
 ;
"RTN","OOPSDOL1",5,0)
 N OCC,NAME,FN,KK,D62,D123,D124,D126,WITN
"RTN","OOPSDOL1",6,0)
 S OOPSAR("CA")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA")))
"RTN","OOPSDOL1",7,0)
 S OOPSAR(0)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,0)))
"RTN","OOPSDOL1",8,0)
 S OOPSAR("CA1A")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1A")))
"RTN","OOPSDOL1",9,0)
 S OOPSAR("CA1B")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1B")))
"RTN","OOPSDOL1",10,0)
 S OOPSAR("CA1C")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1C")))
"RTN","OOPSDOL1",11,0)
 S OOPSAR("CA1D")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1D")))
"RTN","OOPSDOL1",12,0)
 S OOPSAR("CA1ES")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1ES")))
"RTN","OOPSDOL1",13,0)
 S OOPSAR("CA1F")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1F")))
"RTN","OOPSDOL1",14,0)
 S OOPSAR("CA1G")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1G")))
"RTN","OOPSDOL1",15,0)
 S OOPSAR("CA1H")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1H")))
"RTN","OOPSDOL1",16,0)
 S OOPSAR("CA1I")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1I")))
"RTN","OOPSDOL1",17,0)
 S OOPSAR("CA1J")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1J",0)))
"RTN","OOPSDOL1",18,0)
 S OOPSAR("CA1K")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1K",0)))
"RTN","OOPSDOL1",19,0)
 S OOPSAR("CA1L")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1L")))
"RTN","OOPSDOL1",20,0)
 S OOPSAR("CA1M")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1M")))
"RTN","OOPSDOL1",21,0)
 S OOPSAR("CA1N")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1N")))
"RTN","OOPSDOL1",22,0)
 ; get witness data once
"RTN","OOPSDOL1",23,0)
 S WITN=$O(^OOPS(2260,OOPDA,"CA1W",0))
"RTN","OOPSDOL1",24,0)
 I $G(WITN)'="" D
"RTN","OOPSDOL1",25,0)
 . S OOPSAR("CA1W",0)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1W",WITN,0)))
"RTN","OOPSDOL1",26,0)
 . S OOPSAR("CA1W",1)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA1W",WITN,1)))
"RTN","OOPSDOL1",27,0)
OP3 ; Seg OP02
"RTN","OOPSDOL1",28,0)
 K OPX
"RTN","OOPSDOL1",29,0)
 N OFF
"RTN","OOPSDOL1",30,0)
 S OFF=$$GET1^DIQ(2260,OOPDA,"73:1")           ; pad to 2 numeric
"RTN","OOPSDOL1",31,0)
 S OPX="OP02^"_$E("00",$L(OFF)+1,2)_OFF
"RTN","OOPSDOL1",32,0)
 S OPX=OPX_U_$P(OOPSAR("CA1M"),U,1)_U_$P(OOPSAR("CA1M"),U,2)
"RTN","OOPSDOL1",33,0)
 S OPX=OPX_U_$P(OOPSAR("CA1M"),U,3)_U_$$GET1^DIQ(2260,OOPDA,"179:1")
"RTN","OOPSDOL1",34,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA1M"),U,5),1,5)_U_$P(OOPSAR("CA1F"),U,1)
"RTN","OOPSDOL1",35,0)
 S OPX=OPX_U_$P(OOPSAR("CA1F"),U,2)_U_$P(OOPSAR("CA1F"),U,3)
"RTN","OOPSDOL1",36,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"133:1")_U_$E($P(OOPSAR("CA1F"),U,5),1,5)
"RTN","OOPSDOL1",37,0)
 S OPX=OPX_U_U_U_"^|"
"RTN","OOPSDOL1",38,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",39,0)
OP4 ; Seg OP03
"RTN","OOPSDOL1",40,0)
 K OPX
"RTN","OOPSDOL1",41,0)
 S OPX="OP03^"_$$GET1^DIQ(2260,OOPDA,60,"E")
"RTN","OOPSDOL1",42,0)
 S OPX=OPX_U_$P(OOPSAR("CA"),U,5)
"RTN","OOPSDOL1",43,0)
 S D62=$$GET1^DIQ(2260,OOPDA,"62:1")
"RTN","OOPSDOL1",44,0)
 S D123=$$GET1^DIQ(2260,OOPDA,"123:1")
"RTN","OOPSDOL1",45,0)
 S D124=$$GET1^DIQ(2260,OOPDA,"124:1")
"RTN","OOPSDOL1",46,0)
 S D126=$$GET1^DIQ(2260,OOPDA,"126:1")
"RTN","OOPSDOL1",47,0)
 S OPX=OPX_U_$E("000",$L(D123)+1,3)_D123
"RTN","OOPSDOL1",48,0)
 S OPX=OPX_U_$E("0000",$L(D124)+1,4)_D124
"RTN","OOPSDOL1",49,0)
 S OPX=OPX_U_$E("00",$L(D62)+1,2)_D62
"RTN","OOPSDOL1",50,0)
 S OPX=OPX_U_$E("00",$L(D126)+1,2)_D126
"RTN","OOPSDOL1",51,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1L"),U,7))
"RTN","OOPSDOL1",52,0)
 S NAME=$$GET1^DIQ(2260,OOPDA,"169:.01"),FN=$P(NAME,",",2)
"RTN","OOPSDOL1",53,0)
 S OPX=OPX_U_$E($P(NAME,","),1,20)
"RTN","OOPSDOL1",54,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL1",55,0)
 S OPX=OPX_U_$E($P(FN," "),1,10)_U_$E($P(FN," ",2),1,10)
"RTN","OOPSDOL1",56,0)
 S OPX=OPX_U_$P(OOPSAR("CA1L"),U,4)_U_$$MKNUM^OOPSUTL2($P(OOPSAR("CA1L"),U,5))
"RTN","OOPSDOL1",57,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1ES"),U,6))
"RTN","OOPSDOL1",58,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1I"),U,6))
"RTN","OOPSDOL1",59,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR(0),U,5),"."))_"^|"
"RTN","OOPSDOL1",60,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",61,0)
OP5 ; Seg OP04
"RTN","OOPSDOL1",62,0)
 K OPX
"RTN","OOPSDOL1",63,0)
 N GRADE,STEP
"RTN","OOPSDOL1",64,0)
 S GRADE=$P(OOPSAR("2162A"),U,12),STEP=$P(OOPSAR("2162A"),U,13)
"RTN","OOPSDOL1",65,0)
 S OPX="OP04^"_$$DC^OOPSUTL3($P(OOPSAR("CA1ES"),U,3))
"RTN","OOPSDOL1",66,0)
 I $P(OOPSAR("CA1F"),U,13) D
"RTN","OOPSDOL1",67,0)
 .S Y=$P(OOPSAR("CA1F"),U,13) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL1",68,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA1F"),U,13),"."))_Y
"RTN","OOPSDOL1",69,0)
 I '$P(OOPSAR("CA1F"),U,13) S OPX=OPX_U
"RTN","OOPSDOL1",70,0)
 I $P(OOPSAR("CA1G"),U,3) D
"RTN","OOPSDOL1",71,0)
 .S Y=$P(OOPSAR("CA1G"),U,3) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL1",72,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA1G"),U,3),"."))_Y
"RTN","OOPSDOL1",73,0)
 I '$P(OOPSAR("CA1G"),U,3) S OPX=OPX_U
"RTN","OOPSDOL1",74,0)
 I $P(OOPSAR("CA1G"),U,2) D
"RTN","OOPSDOL1",75,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1G"),U,2))
"RTN","OOPSDOL1",76,0)
 I '$P(OOPSAR("CA1G"),U,2) S OPX=OPX_U
"RTN","OOPSDOL1",77,0)
 S RPOL=$P(OOPSAR("CA1A"),U,13)  ;Request Pay or Leave
"RTN","OOPSDOL1",78,0)
 S VAL=$S(RPOL="COP":"RS",RPOL="L":"ZZ",1:"NU")
"RTN","OOPSDOL1",79,0)
 S OPX=OPX_U_VAL_U_$P(OOPSAR("CA1I"),U,7)
"RTN","OOPSDOL1",80,0)
 S OPX=OPX_U_$E($P(OOPSAR(0),U,13),1,2)
"RTN","OOPSDOL1",81,0)
 S OPX=OPX_U_$E("00",$L(GRADE)+1,2)_GRADE
"RTN","OOPSDOL1",82,0)
 I STEP="N" S OPX=OPX_U_" N"
"RTN","OOPSDOL1",83,0)
 I STEP'["N" S OPX=OPX_U_$E("00",$L(STEP)+1,2)_STEP
"RTN","OOPSDOL1",84,0)
 I $P(OOPSAR("CA1A"),U,8)=1!($P(OOPSAR("CA1A"),U,8)=4)!($P(OOPSAR("CA1A"),U,8)=5)!($P(OOPSAR("CA1A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",85,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL1",86,0)
 I $P(OOPSAR("CA1A"),U,8)=2!($P(OOPSAR("CA1A"),U,8)=4)!($P(OOPSAR("CA1A"),U,8)=6)!($P(OOPSAR("CA1A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",87,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL1",88,0)
 I $P(OOPSAR("CA1A"),U,8)=3!($P(OOPSAR("CA1A"),U,8)=5)!($P(OOPSAR("CA1A"),U,8)=6)!($P(OOPSAR("CA1A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",89,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL1",90,0)
 S OPX=OPX_U_"Y^Y^Y^Y"
"RTN","OOPSDOL1",91,0)
 ; Obtain info about existence of witness - next line - no witness
"RTN","OOPSDOL1",92,0)
 I $G(WITN) D
"RTN","OOPSDOL1",93,0)
 . S NM=$P($G(OOPSAR("CA1W",0)),U)
"RTN","OOPSDOL1",94,0)
 . S:$G(NM)'="" OPX=OPX_U_"Y" S:$G(NM)="" OPX=OPX_U_"N"
"RTN","OOPSDOL1",95,0)
 . S WS=$P($G(OOPSAR("CA1W",0)),U,6)
"RTN","OOPSDOL1",96,0)
 . S:$G(WS) OPX=OPX_U_"Y" S:'$G(WS) OPX=OPX_U
"RTN","OOPSDOL1",97,0)
 . K NM,WS
"RTN","OOPSDOL1",98,0)
 I '$G(WITN) S OPX=OPX_"^N^N"
"RTN","OOPSDOL1",99,0)
 S OPX=OPX_U_"ASISTS^C2^Y^"
"RTN","OOPSDOL1",100,0)
 S OPX=OPX_$$DC^OOPSUTL3($P(OOPSAR("CA1A"),U,11))
"RTN","OOPSDOL1",101,0)
 S OPX=OPX_U_$P(OOPSAR("CA1A"),U,9) ;Place where injury occurred
"RTN","OOPSDOL1",102,0)
 ; Added new fields required by the AAC
"RTN","OOPSDOL1",103,0)
 S OPX=OPX_U_$P(OOPSAR("CA1N"),U)                   ; injury Street
"RTN","OOPSDOL1",104,0)
 S OPX=OPX_U_$P(OOPSAR("CA1N"),U,2)                 ; injury City
"RTN","OOPSDOL1",105,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"185:1")         ; injury St
"RTN","OOPSDOL1",106,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA1A"),U,14),1,5)_"^|"   ; injury zip
"RTN","OOPSDOL1",107,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",108,0)
OP6 ; Seg OP05
"RTN","OOPSDOL1",109,0)
 K OPX
"RTN","OOPSDOL1",110,0)
 S OPX="OP05^"_$P(OOPSAR("CA1G"),U,8)_U_$P(OOPSAR("CA1H"),U)
"RTN","OOPSDOL1",111,0)
 S OPX=OPX_U_$P(OOPSAR("CA1H"),U,2)_U_$P(OOPSAR("CA1H"),U,3)
"RTN","OOPSDOL1",112,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"154:1")_U_$E($P(OOPSAR("CA1H"),U,5),1,5)
"RTN","OOPSDOL1",113,0)
 I $P(OOPSAR("CA1I"),U)'="" S OPX=OPX_U_1
"RTN","OOPSDOL1",114,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL1",115,0)
 S NAME=$P(OOPSAR("CA1I"),U),FN=$P(NAME,",",2)
"RTN","OOPSDOL1",116,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL1",117,0)
 S OPX=OPX_U_$E($P(NAME,","),1,20)
"RTN","OOPSDOL1",118,0)
 S OPX=OPX_U_$E($P(FN," "),1,10)_U_$E($P(FN," ",2),1,10)
"RTN","OOPSDOL1",119,0)
 I $P(OOPSAR("CA1I"),U)'="" S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"182:1")
"RTN","OOPSDOL1",120,0)
 I $P(OOPSAR("CA1I"),U)="" S OPX=OPX_U
"RTN","OOPSDOL1",121,0)
 S OPX=OPX_U_$P(OOPSAR("CA1I"),U,2)_U_$P(OOPSAR("CA1I"),U,3)
"RTN","OOPSDOL1",122,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"159:1")_U_$E($P(OOPSAR("CA1I"),U,5),1,5)
"RTN","OOPSDOL1",123,0)
 S OPX=OPX_U_$P(OOPSAR("CA1L"),U)_U_$P(OOPSAR("CA1L"),U,2)_"^|"
"RTN","OOPSDOL1",124,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",125,0)
OP7 ; Seg OP06
"RTN","OOPSDOL1",126,0)
 S DATA=$$CONV^OOPSUTL5($P(OOPSAR("CA1F"),U,11))
"RTN","OOPSDOL1",127,0)
 K OPX
"RTN","OOPSDOL1",128,0)
 S OPX="OP06"
"RTN","OOPSDOL1",129,0)
 F X=1:1:7 D
"RTN","OOPSDOL1",130,0)
 .I DATA[X D
"RTN","OOPSDOL1",131,0)
 ..S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",132,0)
 ..S OPX=OPX_U_$$HM^OOPSUTL3($P(OOPSAR("CA1F"),U,9))
"RTN","OOPSDOL1",133,0)
 ..S OPX=OPX_U_$$HM^OOPSUTL3($P(OOPSAR("CA1F"),U,10))
"RTN","OOPSDOL1",134,0)
 .I DATA'[X S OPX=OPX_"^N^^"
"RTN","OOPSDOL1",135,0)
 ; Generate Occ Code for DOL transfer
"RTN","OOPSDOL1",136,0)
 S OCC=$$GET1^DIQ(2260,OOPDA,15)      ; Occupation code from PAID
"RTN","OOPSDOL1",137,0)
 S OCC=$S(OCC<2200:"G"_OCC,(OCC>2499&(OCC<9001)):"W"_OCC,(OCC=9999):"Z"_OCC,1:"")
"RTN","OOPSDOL1",138,0)
 S OPX=OPX_U_OCC_U_$P(OOPSAR("CA1A"),U,12)_"^|"
"RTN","OOPSDOL1",139,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",140,0)
 K DATA
"RTN","OOPSDOL1",141,0)
OP8 ; Seg OP07
"RTN","OOPSDOL1",142,0)
 K OPX
"RTN","OOPSDOL1",143,0)
 I $L($P(OOPSAR("CA1B"),U))<133 D
"RTN","OOPSDOL1",144,0)
 .S OPX="OP07^1^1^"_$P(OOPSAR("CA1B"),U)_"^|"
"RTN","OOPSDOL1",145,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",146,0)
 I $L($P(OOPSAR("CA1B"),U))>132 D
"RTN","OOPSDOL1",147,0)
 .S OPX="OP07^1^2^"_$E($P(OOPSAR("CA1B"),U),1,132)_"^|"
"RTN","OOPSDOL1",148,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",149,0)
 .K OPX
"RTN","OOPSDOL1",150,0)
 .S OPX="OP07^2^2^"_$E($P(OOPSAR("CA1B"),U),133,200)_"^|"
"RTN","OOPSDOL1",151,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",152,0)
OP9 ; Seg OP08
"RTN","OOPSDOL1",153,0)
 K OPX
"RTN","OOPSDOL1",154,0)
 S OPX="OP08^"_$S($P(OOPSAR("CA1G"),U,4)="N":"NW",1:"")
"RTN","OOPSDOL1",155,0)
 S OPX=OPX_U_$S($P(OOPSAR("CA1G"),U,6)="Y":"WM",1:"")
"RTN","OOPSDOL1",156,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1G"),U))
"RTN","OOPSDOL1",157,0)
 I $G(OOPSAR("CA1K"))'="",($P(OOPSAR("CA1K"),U,4)'=0) S OPX=OPX_U_"E5"
"RTN","OOPSDOL1",158,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL1",159,0)
 S OPX=OPX_U
"RTN","OOPSDOL1",160,0)
 I $P(OOPSAR("CA1I"),U,8)="N" S OPX=OPX_U_"CN"
"RTN","OOPSDOL1",161,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL1",162,0)
 I $P(OOPSAR("CA1L"),U,3)'="" S OPX=OPX_U_97
"RTN","OOPSDOL1",163,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL1",164,0)
 I $G(OOPSAR("CA1W",0))'="" D
"RTN","OOPSDOL1",165,0)
 . S OPX=OPX_U_"Y"
"RTN","OOPSDOL1",166,0)
 . S NAME=$P(OOPSAR("CA1W",0),U),FN=$P(NAME,",",2)
"RTN","OOPSDOL1",167,0)
 . F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL1",168,0)
 . S OPX=OPX_U_$E($P(NAME,","),1,20)
"RTN","OOPSDOL1",169,0)
 . S OPX=OPX_U_$E($P(FN," "),1,10)_U
"RTN","OOPSDOL1",170,0)
 . S OPX=OPX_U_$P(OOPSAR("CA1W",0),U,2)
"RTN","OOPSDOL1",171,0)
 . S OPX=OPX_U_$P(OOPSAR("CA1W",0),U,3)
"RTN","OOPSDOL1",172,0)
 . S OPX=OPX_U_$$GET1^DIQ(5,$P(OOPSAR("CA1W",0),U,4),1)  ; State Code
"RTN","OOPSDOL1",173,0)
 . S OPX=OPX_U_$E($P(OOPSAR("CA1W",0),U,5),1,5)
"RTN","OOPSDOL1",174,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA1W",0),U,6))
"RTN","OOPSDOL1",175,0)
 I $G(OOPSAR("CA1W",0))="" S OPX=OPX_U_"^^^^^^^^"
"RTN","OOPSDOL1",176,0)
 S FL174=$P(OOPSAR("CA1L"),U,6)  ;FILING INSTRUCTION
"RTN","OOPSDOL1",177,0)
 S CATY=$S(FL174=1:"2^0",FL174=2:"2^1",FL174=3:"1^",FL174=4:"6^",1:"")
"RTN","OOPSDOL1",178,0)
 S OPX=OPX_U_CATY_"^|"
"RTN","OOPSDOL1",179,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL1",180,0)
OP10 ; Seg OP09
"RTN","OOPSDOL1",181,0)
 I $P(OOPSAR("CA1G"),U,4)="N" D
"RTN","OOPSDOL1",182,0)
 .K OPX
"RTN","OOPSDOL1",183,0)
 .S OPX="OP09^1^1^"_$P(OOPSAR("CA1G"),U,5)_"^|"
"RTN","OOPSDOL1",184,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",185,0)
OP11 ; Seg OP10
"RTN","OOPSDOL1",186,0)
 I $P(OOPSAR("CA1G"),U,7)'="" D
"RTN","OOPSDOL1",187,0)
 .K OPX
"RTN","OOPSDOL1",188,0)
 .S OPX="OP10^1^1^"_$P(OOPSAR("CA1G"),U,7)_"^|"
"RTN","OOPSDOL1",189,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",190,0)
OP12 ; Seg OP11 - Reason for Convert (Word Processing)
"RTN","OOPSDOL1",191,0)
 I $G(OOPSAR("CA1K"))'="" D
"RTN","OOPSDOL1",192,0)
 .S OPFLD=165,SEG="OP11"
"RTN","OOPSDOL1",193,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL1",194,0)
OP13 ; Seg OP12 - Supervisor not agree explain (Word Processing)
"RTN","OOPSDOL1",195,0)
 I $G(OOPSAR("CA1J"))'="" D
"RTN","OOPSDOL1",196,0)
 .S OPFLD=164,SEG="OP12"
"RTN","OOPSDOL1",197,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL1",198,0)
OP14 ; Seg OP13 - Nature of Injury
"RTN","OOPSDOL1",199,0)
 I $P(OOPSAR("CA1C"),U)'="" D
"RTN","OOPSDOL1",200,0)
 .K OPX
"RTN","OOPSDOL1",201,0)
 .S OPX="OP13^1^1^"_$P(OOPSAR("CA1C"),U)_"^|"
"RTN","OOPSDOL1",202,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",203,0)
OP15 ; Seg OP14 - Supervisor Exception
"RTN","OOPSDOL1",204,0)
 I $P(OOPSAR("CA1L"),U,3)'="" D
"RTN","OOPSDOL1",205,0)
 .K OPX
"RTN","OOPSDOL1",206,0)
 .S OPX="OP14^1^1"
"RTN","OOPSDOL1",207,0)
 .S OPX=OPX_U_$P(OOPSAR("CA1L"),U,3)_"^|"
"RTN","OOPSDOL1",208,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL1",209,0)
OP21 ; Seg OP20
"RTN","OOPSDOL1",210,0)
 K OPX
"RTN","OOPSDOL1",211,0)
 I $P(OOPSAR("2162B"),U,4)'="" D
"RTN","OOPSDOL1",212,0)
 .S OPX="OP20^"_"P"_U_$$GET1^DIQ(2260,OOPDA,"30:1")_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL1",213,0)
 .Q
"RTN","OOPSDOL1",214,0)
 ; Only send the Primary Body part at this time - per AAC 6/30/2000
"RTN","OOPSDOL1",215,0)
 ; I $P(OOPSAR("2162B"),U,8)'="" D
"RTN","OOPSDOL1",216,0)
 ; . N OPX
"RTN","OOPSDOL1",217,0)
 ; . S OPX="OP20^"_"S"_U_$$GET1^DIQ(2260,OOPDA,"30.1:1")_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL1",218,0)
 ; . Q
"RTN","OOPSDOL1",219,0)
OP22 ; Seg OP21 Defined for future use
"RTN","OOPSDOL1",220,0)
OP23 ; Seg OP22 Defined for future use
"RTN","OOPSDOL1",221,0)
OP24 ; Seg OP23 - Statement of Witness (Not yet used)
"RTN","OOPSDOL1",222,0)
 I $G(OOPSAR("CA1W",1))'="" D
"RTN","OOPSDOL1",223,0)
 . I $L(OOPSAR("CA1W",1))<133 D
"RTN","OOPSDOL1",224,0)
 .. K OPX
"RTN","OOPSDOL1",225,0)
 .. S OPX="OP23^1^1^"_OOPSAR("CA1W",1)_"^|"
"RTN","OOPSDOL1",226,0)
 .. D STORE^OOPSDOLX
"RTN","OOPSDOL1",227,0)
 . I $L(OOPSAR("CA1W",1))>132 D
"RTN","OOPSDOL1",228,0)
 .. K OPX
"RTN","OOPSDOL1",229,0)
 .. S OPX="OP23^1^2^"_$E(OOPSAR("CA1W",1),1,132)_"^|"
"RTN","OOPSDOL1",230,0)
 .. D STORE^OOPSDOLX
"RTN","OOPSDOL1",231,0)
 .. K OPX
"RTN","OOPSDOL1",232,0)
 .. S OPX="OP23^2^2^"_$E(DATA,133,264)_"^|"
"RTN","OOPSDOL1",233,0)
 .. D STORE^OOPSDOLX
"RTN","OOPSDOL1",234,0)
 ;
"RTN","OOPSDOL1",235,0)
EXIT ; End of routine
"RTN","OOPSDOL1",236,0)
 K WITN
"RTN","OOPSDOL1",237,0)
 Q
"RTN","OOPSDOL2")
0^29^B47024972
"RTN","OOPSDOL2",1,0)
OOPSDOL2 ;WIOFO/CAH-CA2 EXTRACT FOR DOL ;3/15/00
"RTN","OOPSDOL2",2,0)
 ;;1.0;ASISTS;**8,10,11**;Jun 01, 1998
"RTN","OOPSDOL2",3,0)
EN ; Entry
"RTN","OOPSDOL2",4,0)
 N OCC,NAME,FN,KK,D62,D126,D226,D227
"RTN","OOPSDOL2",5,0)
 S OOPSAR("CA")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA")))
"RTN","OOPSDOL2",6,0)
 S OOPSAR("CA2A")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2A")))
"RTN","OOPSDOL2",7,0)
 S OOPSAR("CA2B")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2B")))
"RTN","OOPSDOL2",8,0)
 S OOPSAR("CA2C")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2C",0)))
"RTN","OOPSDOL2",9,0)
 S OOPSAR("CA2D")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2D",0)))
"RTN","OOPSDOL2",10,0)
 S OOPSAR("CA2E")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2E",0)))
"RTN","OOPSDOL2",11,0)
 S OOPSAR("CA2ES")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2ES")))
"RTN","OOPSDOL2",12,0)
 S OOPSAR("CA2F")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2F",0)))
"RTN","OOPSDOL2",13,0)
 S OOPSAR("CA2G")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2G",0)))
"RTN","OOPSDOL2",14,0)
 S OOPSAR("CA2H")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2H")))
"RTN","OOPSDOL2",15,0)
 S OOPSAR("CA2I")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2I")))
"RTN","OOPSDOL2",16,0)
 S OOPSAR("CA2J")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2J")))
"RTN","OOPSDOL2",17,0)
 S OOPSAR("CA2K")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2K",0)))
"RTN","OOPSDOL2",18,0)
 S OOPSAR("CA2L")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"CA2L")))
"RTN","OOPSDOL2",19,0)
OP3 ; Seg OP02
"RTN","OOPSDOL2",20,0)
 K OPX
"RTN","OOPSDOL2",21,0)
 N OFF
"RTN","OOPSDOL2",22,0)
 S OFF=$$GET1^DIQ(2260,OOPDA,"73:1")
"RTN","OOPSDOL2",23,0)
 S OPX="OP02^"_$E("00",$L(OFF)+1,2)_OFF
"RTN","OOPSDOL2",24,0)
 S OPX=OPX_U_$P(OOPSAR("CA2I"),U,1)_U_$P(OOPSAR("CA2I"),U,2)
"RTN","OOPSDOL2",25,0)
 S OPX=OPX_U_$P(OOPSAR("CA2I"),U,3)_U_$$GET1^DIQ(2260,OOPDA,"240:1")
"RTN","OOPSDOL2",26,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA2I"),U,5),1,5)_U_$P(OOPSAR("CA2H"),U,1)
"RTN","OOPSDOL2",27,0)
 S OPX=OPX_U_$P(OOPSAR("CA2H"),U,2)_U_$P(OOPSAR("CA2H"),U,3)
"RTN","OOPSDOL2",28,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"233:1")_U_$E($P(OOPSAR("CA2H"),U,5),1,5)
"RTN","OOPSDOL2",29,0)
 S OPX=OPX_U_U_U_"^|"
"RTN","OOPSDOL2",30,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",31,0)
OP4 ; Seg OP03
"RTN","OOPSDOL2",32,0)
 K OPX
"RTN","OOPSDOL2",33,0)
 S OPX="OP03^"_$$GET1^DIQ(2260,OOPDA,60,"E")
"RTN","OOPSDOL2",34,0)
 S OPX=OPX_U_$P(OOPSAR("CA"),U,5)
"RTN","OOPSDOL2",35,0)
 S D62=$$GET1^DIQ(2260,OOPDA,"62:1")
"RTN","OOPSDOL2",36,0)
 S D126=$$GET1^DIQ(2260,OOPDA,"126:1")
"RTN","OOPSDOL2",37,0)
 S D226=$$GET1^DIQ(2260,OOPDA,"226:1")
"RTN","OOPSDOL2",38,0)
 S D227=$$GET1^DIQ(2260,OOPDA,"227:1")
"RTN","OOPSDOL2",39,0)
 S OPX=OPX_U_$E("000",$L(D226)+1,3)_D226
"RTN","OOPSDOL2",40,0)
 S OPX=OPX_U_$E("0000",$L(D227)+1,4)_D227
"RTN","OOPSDOL2",41,0)
 S OPX=OPX_U_$E("00",$L(D62)+1,2)_D62
"RTN","OOPSDOL2",42,0)
 S OPX=OPX_U_$E("00",$L(D126)+1,2)_D126
"RTN","OOPSDOL2",43,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2J"),U,8))
"RTN","OOPSDOL2",44,0)
 S NAME=$$GET1^DIQ(2260,OOPDA,"265:.01"),FN=$P(NAME,",",2)
"RTN","OOPSDOL2",45,0)
 S OPX=OPX_U_$E($P(NAME,","),1,20)
"RTN","OOPSDOL2",46,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL2",47,0)
 S OPX=OPX_U_$E($P(FN," "),1,10)_U_$E($P(FN," ",2),1,10)
"RTN","OOPSDOL2",48,0)
 S OPX=OPX_U_$P(OOPSAR("CA2H"),U,8)_U_$$MKNUM^OOPSUTL2($P(OOPSAR("CA2H"),U,9))
"RTN","OOPSDOL2",49,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2ES"),U,6))
"RTN","OOPSDOL2",50,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2J"),U,6))_U_"^|"
"RTN","OOPSDOL2",51,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",52,0)
OP5 ; Seg OP04
"RTN","OOPSDOL2",53,0)
 K OPX
"RTN","OOPSDOL2",54,0)
 N GRADE,STEP
"RTN","OOPSDOL2",55,0)
 S GRADE=$P(OOPSAR("2162A"),U,12),STEP=$P(OOPSAR("2162A"),U,13)
"RTN","OOPSDOL2",56,0)
 S OPX="OP04^"_$$DC^OOPSUTL3($P(OOPSAR("CA2ES"),U,3))
"RTN","OOPSDOL2",57,0)
 I $P(OOPSAR("CA2J"),U,9) D
"RTN","OOPSDOL2",58,0)
 .S Y=$P(OOPSAR("CA2J"),U,9) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL2",59,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA2J"),U,9),"."))_Y
"RTN","OOPSDOL2",60,0)
 I '$P(OOPSAR("CA2J"),U,9) S OPX=OPX_U
"RTN","OOPSDOL2",61,0)
 I $P(OOPSAR("CA2J"),U,12) D
"RTN","OOPSDOL2",62,0)
 .S Y=$P(OOPSAR("CA2J"),U,12) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL2",63,0)
 .S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA2J"),U,12),"."))_Y
"RTN","OOPSDOL2",64,0)
 I '$P(OOPSAR("CA2J"),U,12) S OPX=OPX_U
"RTN","OOPSDOL2",65,0)
 S OPX=OPX_"^^^"_$P(OOPSAR("CA2J"),U,7)
"RTN","OOPSDOL2",66,0)
 S OPX=OPX_U_$E($P(OOPSAR(0),U,13),1,2)
"RTN","OOPSDOL2",67,0)
 S OPX=OPX_U_$E("00",$L(GRADE)+1,2)_GRADE
"RTN","OOPSDOL2",68,0)
 I STEP="N" S OPX=OPX_U_" N"
"RTN","OOPSDOL2",69,0)
 I STEP'["N" S OPX=OPX_U_$E("00",$L(STEP)+1,2)_STEP
"RTN","OOPSDOL2",70,0)
 I $P(OOPSAR("CA2A"),U,8)=1!($P(OOPSAR("CA2A"),U,8)=4)!($P(OOPSAR("CA2A"),U,8)=5)!($P(OOPSAR("CA2A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",71,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",72,0)
 I $P(OOPSAR("CA2A"),U,8)=2!($P(OOPSAR("CA2A"),U,8)=4)!($P(OOPSAR("CA2A"),U,8)=6)!($P(OOPSAR("CA2A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",73,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",74,0)
 I $P(OOPSAR("CA2A"),U,8)=3!($P(OOPSAR("CA2A"),U,8)=5)!($P(OOPSAR("CA2A"),U,8)=6)!($P(OOPSAR("CA2A"),U,8)=7) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",75,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",76,0)
 S OPX=OPX_U_"Y^Y^Y^Y"
"RTN","OOPSDOL2",77,0)
 S OPX=OPX_U_"^^ASISTS^C2^Y"
"RTN","OOPSDOL2",78,0)
 S OPX=OPX_U                         ;Date of this Notice
"RTN","OOPSDOL2",79,0)
 S OPX=OPX_U_$P(OOPSAR("CA2B"),U)    ;Illness Occurred Location
"RTN","OOPSDOL2",80,0)
 S OPX=OPX_U_$P(OOPSAR("CA2B"),U,2)  ;Illness Occurred Address
"RTN","OOPSDOL2",81,0)
 S OPX=OPX_U_$P(OOPSAR("CA2B"),U,3)  ;Illness Occurred City
"RTN","OOPSDOL2",82,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"212:1") ;Illness Occurred State
"RTN","OOPSDOL2",83,0)
 S OPX=OPX_U_$E($P(OOPSAR("CA2B"),U,5),1,5)_"^|"
"RTN","OOPSDOL2",84,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",85,0)
OP6 ; Seg OP05
"RTN","OOPSDOL2",86,0)
 K OPX
"RTN","OOPSDOL2",87,0)
 S OPX="OP05^"_$P(OOPSAR("CA2L"),U)_U_$P(OOPSAR("CA2L"),U,2)
"RTN","OOPSDOL2",88,0)
 S OPX=OPX_U_$P(OOPSAR("CA2L"),U,3)_U_$P(OOPSAR("CA2L"),U,4)
"RTN","OOPSDOL2",89,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"262:1")_U_$E($P(OOPSAR("CA2L"),U,6),1,5)
"RTN","OOPSDOL2",90,0)
 I $P(OOPSAR("CA2J"),U)'="" S OPX=OPX_U_1
"RTN","OOPSDOL2",91,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL2",92,0)
 S NAME=$P(OOPSAR("CA2J"),U),FN=$P(NAME,",",2)
"RTN","OOPSDOL2",93,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOL2",94,0)
 S OPX=OPX_U_$E($P(NAME,","),1,20)_U_$E($P(FN," "),1,10)_U_$E($P(FN," ",2),1,10)
"RTN","OOPSDOL2",95,0)
 I $P(OOPSAR("CA2J"),U)'="" S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"270:1")
"RTN","OOPSDOL2",96,0)
 I $P(OOPSAR("CA2J"),U,2)'="" D
"RTN","OOPSDOL2",97,0)
 .S OPX=OPX_U_$P(OOPSAR("CA2J"),U,2)_U_$P(OOPSAR("CA2J"),U,3)
"RTN","OOPSDOL2",98,0)
 .S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"248:1")_U_$E($P(OOPSAR("CA2J"),U,5),1,5)
"RTN","OOPSDOL2",99,0)
 I $P(OOPSAR("CA2J"),U,2)="" S OPX=OPX_"^^^^"
"RTN","OOPSDOL2",100,0)
 S OPX=OPX_U_"^^|"
"RTN","OOPSDOL2",101,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",102,0)
OP7 ; Seg OP06
"RTN","OOPSDOL2",103,0)
 S DATA=$$CONV^OOPSUTL5($P(OOPSAR("CA2I"),U,8))
"RTN","OOPSDOL2",104,0)
 K OPX
"RTN","OOPSDOL2",105,0)
 S OPX="OP06"
"RTN","OOPSDOL2",106,0)
 F X=1:1:7 D          ;Loop for seven days of the week
"RTN","OOPSDOL2",107,0)
 .I DATA[X D
"RTN","OOPSDOL2",108,0)
 ..S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",109,0)
 ..S OPX=OPX_U_$$HM^OOPSUTL3($P(OOPSAR("CA2I"),U,6))_U_$$HM^OOPSUTL3($P(OOPSAR("CA2I"),U,7))
"RTN","OOPSDOL2",110,0)
 .I DATA'[X S OPX=OPX_"^N^^"
"RTN","OOPSDOL2",111,0)
 ; Generate Occ Code for DOL transfer
"RTN","OOPSDOL2",112,0)
 S OCC=$$GET1^DIQ(2260,OOPDA,15)      ; Occupation code from PAID
"RTN","OOPSDOL2",113,0)
 S OCC=$S(OCC<2200:"G"_OCC,(OCC>2499&(OCC<9001)):"W"_OCC,(OCC=9999):"Z"_OCC,1:"")
"RTN","OOPSDOL2",114,0)
 S OPX=OPX_U_OCC_U_$P(OOPSAR("CA2A"),U,9)_"^|"
"RTN","OOPSDOL2",115,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",116,0)
OP8 ; Seg OP07 RELATIONSHIP OF ILLNESS TO EMP (Word Processing)
"RTN","OOPSDOL2",117,0)
 I $G(OOPSAR("CA2C"))'="",($P(OOPSAR("CA2C"),U,4)'=0) D
"RTN","OOPSDOL2",118,0)
 . S OPFLD=216,SEG="OP07"
"RTN","OOPSDOL2",119,0)
 . D WP^OOPSDOLX
"RTN","OOPSDOL2",120,0)
OP9 ; Seg OP08
"RTN","OOPSDOL2",121,0)
 K OPX
"RTN","OOPSDOL2",122,0)
 S OPX="OP08^^^^^^^"
"RTN","OOPSDOL2",123,0)
 I $P(OOPSAR("CA2L"),U,7)'="" S OPX=OPX_97_U
"RTN","OOPSDOL2",124,0)
 E  S OPX=OPX_U
"RTN","OOPSDOL2",125,0)
 ; patch 11 - moved Witness indicator to correct piece
"RTN","OOPSDOL2",126,0)
 S OPX=OPX_"N^^^^^^^^^^^|"
"RTN","OOPSDOL2",127,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",128,0)
OP14 ; Seg OP13 Nature of Disease/Illness (Word Processing)
"RTN","OOPSDOL2",129,0)
 I $G(OOPSAR("CA2D"))'="",($P(OOPSAR("CA2D"),U,4)'=0) D
"RTN","OOPSDOL2",130,0)
 .S OPFLD=217,SEG="OP13"
"RTN","OOPSDOL2",131,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",132,0)
OP15 ;Seg OP14 Supervisor Exception
"RTN","OOPSDOL2",133,0)
 S S97=$P(OOPSAR("CA2L"),U,7)     ; patch 11, don't send if only a space
"RTN","OOPSDOL2",134,0)
 I (S97'=""),(S97'=" ") D
"RTN","OOPSDOL2",135,0)
 .K OPX
"RTN","OOPSDOL2",136,0)
 .S OPX="OP14^1^1^"_S97_"^|"   ;Supervisor Exception
"RTN","OOPSDOL2",137,0)
 .D STORE^OOPSDOLX
"RTN","OOPSDOL2",138,0)
 K S97
"RTN","OOPSDOL2",139,0)
OP16 ; Seg OP15
"RTN","OOPSDOL2",140,0)
 K OPX
"RTN","OOPSDOL2",141,0)
 S OPX="OP15^"_$$DC^OOPSUTL3($P(OOPSAR("CA2J"),U,11))
"RTN","OOPSDOL2",142,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2B"),U,6))
"RTN","OOPSDOL2",143,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P(OOPSAR("CA2B"),U,7))
"RTN","OOPSDOL2",144,0)
 S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR("CA2J"),U,10),"."))
"RTN","OOPSDOL2",145,0)
 S Y=$P(OOPSAR("CA2J"),U,10) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOL2",146,0)
 S OPX=OPX_Y
"RTN","OOPSDOL2",147,0)
 I $G(OOPSAR("CA2C"))'="",($P(OOPSAR("CA2C"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",148,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",149,0)
 I $G(OOPSAR("CA2K"))'="",($P(OOPSAR("CA2K"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",150,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",151,0)
 I $G(OOPSAR("CA2E"))'="",($P(OOPSAR("CA2E"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",152,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",153,0)
 I $G(OOPSAR("CA2G"))'="",($P(OOPSAR("CA2G"),U,4)'=0) S OPX=OPX_U_"Y"
"RTN","OOPSDOL2",154,0)
 E  S OPX=OPX_U_"N"
"RTN","OOPSDOL2",155,0)
 I $G(OOPSAR("CA2F"))'="",($P(OOPSAR("CA2F"),U,4)'=0) S OPX=OPX_U_"Y^|"
"RTN","OOPSDOL2",156,0)
 E  S OPX=OPX_U_"N^|"
"RTN","OOPSDOL2",157,0)
 D STORE^OOPSDOLX
"RTN","OOPSDOL2",158,0)
OP17 ; Seg OP16 Work Duty Changed (Word Processing)
"RTN","OOPSDOL2",159,0)
 I $G(OOPSAR("CA2K"))'="",($P(OOPSAR("CA2K"),U,4)'=0) D
"RTN","OOPSDOL2",160,0)
 .S OPFLD=257,SEG="OP16"
"RTN","OOPSDOL2",161,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",162,0)
OP18 ; Seg OP17 Claim not Filed (Word Processing)
"RTN","OOPSDOL2",163,0)
 I $G(OOPSAR("CA2E"))'="",($P(OOPSAR("CA2E"),U,4)'=0) D
"RTN","OOPSDOL2",164,0)
 .S OPFLD=218,SEG="OP17"
"RTN","OOPSDOL2",165,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",166,0)
OP19 ; Seg OP18 Medical Report Delay (Word Processing)
"RTN","OOPSDOL2",167,0)
 I $G(OOPSAR("CA2G"))'="",($P(OOPSAR("CA2G"),U,4)'=0) D
"RTN","OOPSDOL2",168,0)
 .S OPFLD=220,SEG="OP18"
"RTN","OOPSDOL2",169,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",170,0)
OP20 ; Seg OP19 Employee Statement Delayed (Word Processing)
"RTN","OOPSDOL2",171,0)
 I $G(OOPSAR("CA2F"))'="",($P(OOPSAR("CA2F"),U,4)'=0) D
"RTN","OOPSDOL2",172,0)
 .S OPFLD=219,SEG="OP19"
"RTN","OOPSDOL2",173,0)
 .D WP^OOPSDOLX
"RTN","OOPSDOL2",174,0)
OP21 ; Seg OP20
"RTN","OOPSDOL2",175,0)
 K OPX
"RTN","OOPSDOL2",176,0)
 I $P(OOPSAR("2162B"),U,4)'="" D
"RTN","OOPSDOL2",177,0)
 .S OPX="OP20^"_"P"_U_$$GET1^DIQ(2260,OOPDA,"30:1")_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL2",178,0)
 .Q
"RTN","OOPSDOL2",179,0)
 ; Only send Primary Body part at this time - per AAC 6/30/2000
"RTN","OOPSDOL2",180,0)
 ; I $P(OOPSAR("2162B"),U,8)'="" D
"RTN","OOPSDOL2",181,0)
 ; . N OPX
"RTN","OOPSDOL2",182,0)
 ; . S OPX="OP20^"_"S"_U_$$GET1^DIQ(2260,OOPDA,"30.1:1")_"^|" D STORE^OOPSDOLX
"RTN","OOPSDOL2",183,0)
 ; . Q
"RTN","OOPSDOL2",184,0)
OP22 ; Seg OP21 Define for future use
"RTN","OOPSDOL2",185,0)
OP23 ; Seg OP22 Define for future use
"RTN","OOPSDOL2",186,0)
EXIT ; exit the routine
"RTN","OOPSDOL2",187,0)
 K IEN,DATA,MAX
"RTN","OOPSDOL2",188,0)
 Q
"RTN","OOPSDOLX")
0^30^B17527935
"RTN","OOPSDOLX",1,0)
OOPSDOLX ;WIOFO/CAH-Extract data for DOL XMIT ;3/15/00
"RTN","OOPSDOLX",2,0)
 ;;1.0;ASISTS;**8,10,11**;Jun 01, 1998
"RTN","OOPSDOLX",3,0)
 ;
"RTN","OOPSDOLX",4,0)
 ;Retrieves data from ^OOPS(2260, for CA1/CA2
"RTN","OOPSDOLX",5,0)
 ;Variables used
"RTN","OOPSDOLX",6,0)
 ;  OOPDA-----IEN of Case
"RTN","OOPSDOLX",7,0)
 ;  OOPSAR----Array holding data
"RTN","OOPSDOLX",8,0)
 ;  OPL-------Last line number written in message text
"RTN","OOPSDOLX",9,0)
 ;  XMZ-------Message Number
"RTN","OOPSDOLX",10,0)
 ; Entry
"RTN","OOPSDOLX",11,0)
 N ARR,KK,FN,FORM,MESS,NAME,OPC,OPSAR,OPT,OPX,SEG,OOPSAR,FYM,MON
"RTN","OOPSDOLX",12,0)
 S RSIZE=0,ARR=0
"RTN","OOPSDOLX",13,0)
 S OOPSAR(0)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,0)))
"RTN","OOPSDOLX",14,0)
 S OOPSAR("2162A")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162A")))
"RTN","OOPSDOLX",15,0)
 S OOPSAR("2162B")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162B")))
"RTN","OOPSDOLX",16,0)
 S OOPSAR("2162D")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162D")))
"RTN","OOPSDOLX",17,0)
 S OOPSAR("2162ES")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162ES")))
"RTN","OOPSDOLX",18,0)
OP02 ; Seg OP01
"RTN","OOPSDOLX",19,0)
 K OPX,DTINJ
"RTN","OOPSDOLX",20,0)
 S OPX="OP01^"_$TR($P(OOPSAR(0),U),"-")_U_$P(OOPSAR(0),U,2)
"RTN","OOPSDOLX",21,0)
 S OPX=OPX_U_$P(OOPSAR(0),U,7)_U_$TR($P(OOPSAR("2162A"),U),"-")
"RTN","OOPSDOLX",22,0)
 ; patch 11 - send field 109 if CA1, field 214 if CA2
"RTN","OOPSDOLX",23,0)
 ;            left old code, commented below
"RTN","OOPSDOLX",24,0)
 S FORM=$$GET1^DIQ(2260,OOPDA,52,"I")
"RTN","OOPSDOLX",25,0)
 I FORM=1 D
"RTN","OOPSDOLX",26,0)
 . S DTINJ=$$GET1^DIQ(2260,OOPDA,109,"I")
"RTN","OOPSDOLX",27,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(DTINJ,"."))
"RTN","OOPSDOLX",28,0)
 . S Y=DTINJ D DD^%DT S Y=$P($TR(Y,":",""),"@",2),OPX=OPX_U_Y
"RTN","OOPSDOLX",29,0)
 I FORM=2 D
"RTN","OOPSDOLX",30,0)
 . S DTINJ=$$GET1^DIQ(2260,OOPDA,214,"I")
"RTN","OOPSDOLX",31,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(DTINJ,"."))_U
"RTN","OOPSDOLX",32,0)
 K DTINJ
"RTN","OOPSDOLX",33,0)
 ;
"RTN","OOPSDOLX",34,0)
 ; S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR(0),U,5),"."))
"RTN","OOPSDOLX",35,0)
 ; I $$GET1^DIQ(2260,OOPDA,52,"I")=1 D
"RTN","OOPSDOLX",36,0)
 ; .S Y=$P(OOPSAR(0),U,5) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOLX",37,0)
 ; .S OPX=OPX_U_Y
"RTN","OOPSDOLX",38,0)
 ; I $$GET1^DIQ(2260,OOPDA,52,"I")=2 S OPX=OPX_U
"RTN","OOPSDOLX",39,0)
 S MON=$E($P(OOPSAR(0),U,5),4,5)
"RTN","OOPSDOLX",40,0)
 S FYM=$S(MON=10:1,MON=11:2,MON=12:3,MON="01":4,MON="02":5,MON="03":6,MON="04":7,MON="05":8,MON="06":9,MON="07":10,MON="08":11,MON="09":12,1:0)
"RTN","OOPSDOLX",41,0)
 S OPX=OPX_U_$E($P(OOPSAR(0),U),1,4)_U_$E("00",$L(FYM)+1,2)_FYM
"RTN","OOPSDOLX",42,0)
 S NAME=$P(OOPSAR(0),U,2),FN=$P(NAME,",",2)
"RTN","OOPSDOLX",43,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOLX",44,0)
 S OPX=OPX_U_$P(NAME,",")_U_$P(FN," ")_U_$E($P(FN," ",2))
"RTN","OOPSDOLX",45,0)
 S OPX=OPX_"^^"_$P(OOPSAR("2162A"),U,4)_U_$P(OOPSAR("2162A"),U,5)_U_$$GET1^DIQ(2260,OOPDA,"10:1")_U_$E($P(OOPSAR("2162A"),U,7),1,5)
"RTN","OOPSDOLX",46,0)
 S OPX=OPX_U_$TR($P(OOPSAR("2162A"),U,8),"(,)-^*/# ")
"RTN","OOPSDOLX",47,0)
 S OPX=OPX_U_$E($$GET1^DIQ(2260,OOPDA,7,"E"))_U_$$DC^OOPSUTL3($P(OOPSAR("2162A"),U,2))
"RTN","OOPSDOLX",48,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"70:.01")
"RTN","OOPSDOLX",49,0)
 S OPX=OPX_"^^"_$P(OOPSAR("2162A"),U,10)_"^|"
"RTN","OOPSDOLX",50,0)
 D STORE
"RTN","OOPSDOLX",51,0)
 I $P(OOPSAR(0),U,7)=1 D ^OOPSDOL1
"RTN","OOPSDOLX",52,0)
 I $P(OOPSAR(0),U,7)=2 D ^OOPSDOL2
"RTN","OOPSDOLX",53,0)
EXIT ; Loads the message and Quits the routine
"RTN","OOPSDOLX",54,0)
 I RSIZE+MSIZE>30000 D
"RTN","OOPSDOLX",55,0)
 .S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSDOLX",56,0)
 .D SEND^OOPSDOL,CREATE^OOPSDOL
"RTN","OOPSDOLX",57,0)
 .S (START,END)=""
"RTN","OOPSDOLX",58,0)
 F I=1:1:ARR I $G(MESS(I))'="" D
"RTN","OOPSDOLX",59,0)
 .S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=MESS(I)
"RTN","OOPSDOLX",60,0)
 .I START="" S START=$P($P(OOPSAR(0),U),"-",2)
"RTN","OOPSDOLX",61,0)
 S MSIZE=MSIZE+RSIZE
"RTN","OOPSDOLX",62,0)
 K ARR,MESS,OPDT,RSIZE
"RTN","OOPSDOLX",63,0)
 Q
"RTN","OOPSDOLX",64,0)
STORE ;
"RTN","OOPSDOLX",65,0)
 S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSDOLX",66,0)
 S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSDOLX",67,0)
 Q
"RTN","OOPSDOLX",68,0)
WP ; Word Processing Fields
"RTN","OOPSDOLX",69,0)
 K OPX
"RTN","OOPSDOLX",70,0)
 N DIWL,DIWR,DIWF,OPGLB,OPNODE,X,OPI
"RTN","OOPSDOLX",71,0)
 ; Patch 11 - added error checking on max # of segments
"RTN","OOPSDOLX",72,0)
 N NUM,WPAR
"RTN","OOPSDOLX",73,0)
 S NUM=0
"RTN","OOPSDOLX",74,0)
 S OPI=0
"RTN","OOPSDOLX",75,0)
 K ^UTILITY($J,"W")
"RTN","OOPSDOLX",76,0)
 S DIWL=1,DIWR="",DIWF="|C132"
"RTN","OOPSDOLX",77,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSDOLX",78,0)
 S OPI=0 F  S OPI=$O(^OOPS(2260,OOPDA,OPNODE,OPI)) Q:'OPI  S X=$G(^OOPS(2260,OOPDA,OPNODE,OPI,0)) D
"RTN","OOPSDOLX",79,0)
 . I $TR(X," ","")="" Q
"RTN","OOPSDOLX",80,0)
 . I X]"" D ^DIWP
"RTN","OOPSDOLX",81,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSDOLX",82,0)
 ; Need to set up an array to see if max segments exceeded
"RTN","OOPSDOLX",83,0)
 I OPT S OPI=0 F OPC=1:1:OPT S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI  D
"RTN","OOPSDOLX",84,0)
 . S NUM=NUM+1
"RTN","OOPSDOLX",85,0)
 . S WPAR(NUM)=SEG_U_OPC_U_OPT_U_$$UP^OOPSUTL4($E(^UTILITY($J,"W",1,OPI,0),1,132))_"^|"
"RTN","OOPSDOLX",86,0)
 ; Fileman puts spaces at end of last node - need to strip off.
"RTN","OOPSDOLX",87,0)
 S STRP=$P(WPAR(NUM),U,4)
"RTN","OOPSDOLX",88,0)
 F K=$L(STRP):-1:1 Q:$E(STRP,K)'=" "  S STRP=$E(STRP,1,(K-1))
"RTN","OOPSDOLX",89,0)
 S $P(WPAR(NUM),U,4)=STRP
"RTN","OOPSDOLX",90,0)
 K STRP
"RTN","OOPSDOLX",91,0)
 I NUM>4 D  ; if max segments exceeded fix here
"RTN","OOPSDOLX",92,0)
 . N BEG,END,STR,TMP
"RTN","OOPSDOLX",93,0)
 . F I=1:1:NUM S STR(I)=$P(WPAR(I),U,4)
"RTN","OOPSDOLX",94,0)
 . F I=1:1:(NUM-1) S TMP=132-$L(STR(I)) I TMP D
"RTN","OOPSDOLX",95,0)
 .. S END=$E(STR(I),$L(STR(I))),BEG=$E(STR(I+1))
"RTN","OOPSDOLX",96,0)
 .. ; put a blank in if needed
"RTN","OOPSDOLX",97,0)
 .. I $A(END)'=32,$A(BEG)'=32 S STR(I)=STR(I)_" ",TMP=TMP-1
"RTN","OOPSDOLX",98,0)
 .. S STR(I)=STR(I)_$E(STR(I+1),1,TMP)
"RTN","OOPSDOLX",99,0)
 .. S STR(I+1)=$E(STR(I+1),(TMP+1),$L(STR(I+1)))
"RTN","OOPSDOLX",100,0)
 .. I $L(STR(I)) S $P(WPAR(I),U,4)=STR(I)
"RTN","OOPSDOLX",101,0)
 .. I '$L(STR(I)) K WPAR(I)
"RTN","OOPSDOLX",102,0)
 . I '$L(STR(NUM)) K WPAR(NUM)
"RTN","OOPSDOLX",103,0)
 ; load temporary array into MESS array to load into Mailman message
"RTN","OOPSDOLX",104,0)
 S NSEG=$O(WPAR(""),-1)
"RTN","OOPSDOLX",105,0)
 S NUM=0 F  S NUM=$O(WPAR(NUM)) Q:NUM=""  D
"RTN","OOPSDOLX",106,0)
 . S OPX=WPAR(NUM),$P(OPX,U,3)=NSEG
"RTN","OOPSDOLX",107,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSDOLX",108,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSDOLX",109,0)
 K ^UTILITY($J,"W"),X,OPFLD,NSEG
"RTN","OOPSDOLX",110,0)
 Q
"RTN","OOPSESP")
0^14^B570277
"RTN","OOPSESP",1,0)
OOPSESP ;WIOFO/CAH-EDIT SITE PARAMETER ;2/16/00
"RTN","OOPSESP",2,0)
 ;;1.0;ASISTS;**7,8,11**;Jun 01, 1998
"RTN","OOPSESP",3,0)
 W @IOF
"RTN","OOPSESP",4,0)
EDIT K DR S DR(1,2262,10)=".01 SITE NAME..............."
"RTN","OOPSESP",5,0)
 K DO,DD S DIC="^OOPS(2262,",DIC(0)="AEMQ" D ^DIC G:Y=-1 EXIT
"RTN","OOPSESP",6,0)
 ; patch 11 - added .7 below - new field
"RTN","OOPSESP",7,0)
 S DR(2,2262.03)=".7;1;2;3;4;5;6"
"RTN","OOPSESP",8,0)
 S DIE="^OOPS(2262,",IEN2262=+Y,DA=IEN2262,DR=""
"RTN","OOPSESP",9,0)
 ; patch 11 - removed field 1 from input screen - not used.
"RTN","OOPSESP",10,0)
 ; S DR(1,2262,20)="1 OWCP AGENCY CODE........"
"RTN","OOPSESP",11,0)
 S DR(1,2262,30)="2 OWCP DISTRICT OFFICE...."
"RTN","OOPSESP",12,0)
 S DR(1,2262,40)="3"    ;MULTIPLE FIELD
"RTN","OOPSESP",13,0)
 D ^DIE
"RTN","OOPSESP",14,0)
EXIT K DA,DIC,DIE,DR
"RTN","OOPSESP",15,0)
 Q
"RTN","OOPSEUT")
0^18^B697652
"RTN","OOPSEUT",1,0)
OOPSEUT ;WIOFO/CVW-EDIT UNION INFO;  03/12/01
"RTN","OOPSEUT",2,0)
 ;;1.0;ASISTS;**10,11**;Jun 01, 1998
"RTN","OOPSEUT",3,0)
EN1(CALLER) ;Entry for Edit Union Information
"RTN","OOPSEUT",4,0)
 I CALLER'="W" G EXIT
"RTN","OOPSEUT",5,0)
 N DIC,Y
"RTN","OOPSEUT",6,0)
ENTLOOP ;
"RTN","OOPSEUT",7,0)
 N DLAYGO
"RTN","OOPSEUT",8,0)
 S DLAYGO=2263.7,DIC="^OOPS(2263.7,",DIC(0)="AELMQZ" D ^DIC G:Y=-1 EXIT
"RTN","OOPSEUT",9,0)
 S IEN=+Y
"RTN","OOPSEUT",10,0)
 G:'IEN EXIT
"RTN","OOPSEUT",11,0)
EDIT ;EDIT STUB 
"RTN","OOPSEUT",12,0)
 S DA=IEN,DR="",DIE=2263.7
"RTN","OOPSEUT",13,0)
 S DR(1,2263.7,1)=".01  UNION NAME................."
"RTN","OOPSEUT",14,0)
 S DR(1,2263.7,5)="1  UNION ACRONYM.............."
"RTN","OOPSEUT",15,0)
 S DR(1,2263.7,10)="2  UNION REPRESENTATIVE......."
"RTN","OOPSEUT",16,0)
 D ^DIE
"RTN","OOPSEUT",17,0)
 G ENTLOOP
"RTN","OOPSEUT",18,0)
EXIT ;EXIT AND CLEAN
"RTN","OOPSEUT",19,0)
 K DA,DR,DIE,IEN
"RTN","OOPSEUT",20,0)
 Q
"RTN","OOPSLOG")
0^9^B51748310
"RTN","OOPSLOG",1,0)
OOPSLOG ;HINES CIOFO/GB-Log of Federal Occupational Injuries and Illnesses;8/15/96
"RTN","OOPSLOG",2,0)
 ;;1.0;ASISTS;**1,2,5,9,11**;Jun 01, 1998
"RTN","OOPSLOG",3,0)
 N CN,CL,DA,DASHES,DATE,EX,FCILL,FCINJ,FCINJILL,FYR,FY,HDR,HDR1,HDR2
"RTN","OOPSLOG",4,0)
 N HDRFLG,ILL,INC,INJ,INJILL,LIN,LP1,LTILL,LTINJ,LTINJILL,LYR,OUT,PG,STA
"RTN","OOPSLOG",5,0)
 N RANGE
"RTN","OOPSLOG",6,0)
SDED N DIR,DIRUT,DUOUT,X,Y,SD,ED,SDT,EDT
"RTN","OOPSLOG",7,0)
 S DIR(0)="D^2981001:DT:EX"
"RTN","OOPSLOG",8,0)
 S DIR("A")="Starting Date for the Report"
"RTN","OOPSLOG",9,0)
 S DIR("?")="Select a Starting Date from the range displayed."
"RTN","OOPSLOG",10,0)
 D ^DIR
"RTN","OOPSLOG",11,0)
 G:$D(DIRUT) EXIT
"RTN","OOPSLOG",12,0)
 S SD=Y,SDT=Y(0)
"RTN","OOPSLOG",13,0)
 K DIR,DIRUT,DUOUT,X,Y S DIR(0)="D^2981001:DT:EX"
"RTN","OOPSLOG",14,0)
 S DIR("A")="Ending Date for the Report"
"RTN","OOPSLOG",15,0)
 S DIR("?")="Select a Ending Date from the range displayed"
"RTN","OOPSLOG",16,0)
 D ^DIR
"RTN","OOPSLOG",17,0)
 G:$D(DIRUT) EXIT
"RTN","OOPSLOG",18,0)
 S ED=Y,EDT=Y(0)
"RTN","OOPSLOG",19,0)
 I $$FMDIFF^XLFDT(ED,SD,1)'>0 W !?5,"The Ending Date cannot be before or on the Starting Date, please re-enter this data." G SDED
"RTN","OOPSLOG",20,0)
 S RANGE="for Period "_SDT_" - "_EDT
"RTN","OOPSLOG",21,0)
 I $D(EV) S INC=0,HDR1="Employees and volunteers only" G PREDEV
"RTN","OOPSLOG",22,0)
 K DIR S DIR(0)="SA^E/V:Employees and volunteers only;A:All cases",DIR("A")="Cases to be included: " D ^DIR K DIR
"RTN","OOPSLOG",23,0)
 G:$D(DIRUT) EXIT
"RTN","OOPSLOG",24,0)
 S EV=Y
"RTN","OOPSLOG",25,0)
 K DIR S DIR(0)="Y",DIR("A")="Include names of persons involved",DIR("B")="Yes" D ^DIR K DIR
"RTN","OOPSLOG",26,0)
 G:$D(DIRUT) EXIT
"RTN","OOPSLOG",27,0)
 S INC=Y
"RTN","OOPSLOG",28,0)
 ; Patch 5 -Get Station Number
"RTN","OOPSLOG",29,0)
PREDEV S OUT=""
"RTN","OOPSLOG",30,0)
 D STATION(.STA,.OUT)
"RTN","OOPSLOG",31,0)
 G:$D(DIRUT)!(OUT) EXIT
"RTN","OOPSLOG",32,0)
DEV K IOP,%ZIS S %ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP EXIT
"RTN","OOPSLOG",33,0)
 I $D(IO("Q")) D TASK G EXIT
"RTN","OOPSLOG",34,0)
 U IO D PRT D ^%ZISC K %ZIS,IOP G EXIT
"RTN","OOPSLOG",35,0)
PRT S PG=0
"RTN","OOPSLOG",36,0)
 S (INJ,ILL,FCINJ,FCILL,LTINJ,LTILL)=0
"RTN","OOPSLOG",37,0)
 S EX="",LIN=$S(IOST?1"C".E:IOSL-4,1:IOSL-5)  ; was 5 and 6
"RTN","OOPSLOG",38,0)
 K DASHES S $P(DASHES,"-",80)="-"
"RTN","OOPSLOG",39,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD") S DATE=Y
"RTN","OOPSLOG",40,0)
 S HDR=$S($G(NS):"Log of Needlestick Incidents ",1:"Log of Federal Occupational Injuries and Illnesses ")
"RTN","OOPSLOG",41,0)
 S HDR1=$S(EV="E/V":"Employees and volunteers only",1:"All cases")
"RTN","OOPSLOG",42,0)
 ; Patch 5 - change for Station Number looping
"RTN","OOPSLOG",43,0)
 S LP1=""
"RTN","OOPSLOG",44,0)
 I STA="A" D  G EXIT
"RTN","OOPSLOG",45,0)
 . F  S LP1=$O(^OOPS(2260,"D",LP1)) Q:LP1=""!(EX=U)  S HDRFLG=0 D
"RTN","OOPSLOG",46,0)
 .. S DA=0 F  S DA=$O(^OOPS(2260,"D",LP1,DA)) D:DA="" LOGSUM Q:DA=""!(EX=U)  D DATA
"RTN","OOPSLOG",47,0)
 I STA'="A" D  G EXIT
"RTN","OOPSLOG",48,0)
 . S LP1=STA,HDRFLG=0
"RTN","OOPSLOG",49,0)
 . S DA=0 F  S DA=$O(^OOPS(2260,"D",LP1,DA)) D:DA="" LOGSUM Q:DA=""!(EX=U)  D DATA
"RTN","OOPSLOG",50,0)
EXIT ; Clean up and exit
"RTN","OOPSLOG",51,0)
 K POP,X,Y,%,NS,EV
"RTN","OOPSLOG",52,0)
 Q
"RTN","OOPSLOG",53,0)
DATA ;
"RTN","OOPSLOG",54,0)
 N CASE,OOPS,YR,DIC,DIQ,DR,CD
"RTN","OOPSLOG",55,0)
 S CASE=$$GET1^DIQ(2260,DA,.01)
"RTN","OOPSLOG",56,0)
 S YR=$E(CASE,1,4)
"RTN","OOPSLOG",57,0)
 S CD=($P(^OOPS(2260,DA,0),"^",5))\1
"RTN","OOPSLOG",58,0)
 I ($$FMDIFF^XLFDT(CD,SD,1)<0)!($$FMDIFF^XLFDT(CD,ED,1)>0) Q 
"RTN","OOPSLOG",59,0)
 K OOPS
"RTN","OOPSLOG",60,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSLOG",61,0)
 S DR=".01;2;3;4;1;15;14;29;30;33;37;51;52;82;83;84;85;86"
"RTN","OOPSLOG",62,0)
 S DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSLOG",63,0)
 I $G(NS),OOPS(2260,DA,3,"I")<11 Q
"RTN","OOPSLOG",64,0)
 I EV="E/V","1,2,6,"'[OOPS(2260,DA,2,"I")_"," Q
"RTN","OOPSLOG",65,0)
 Q:OOPS(2260,DA,51,"E")="Deleted"
"RTN","OOPSLOG",66,0)
 Q:OOPS(2260,DA,51,"E")="Replaced by amendment"
"RTN","OOPSLOG",67,0)
 ; Patch 9 fix summary logic
"RTN","OOPSLOG",68,0)
 I OOPS(2260,DA,52,"E")="Injury" S INJ=INJ+1 D
"RTN","OOPSLOG",69,0)
 . S:OOPS(2260,DA,29,"E")="Death" FCINJ=FCINJ+1
"RTN","OOPSLOG",70,0)
 . S:OOPS(2260,DA,33,"E")="Yes" LTINJ=LTINJ+1
"RTN","OOPSLOG",71,0)
 I OOPS(2260,DA,52,"E")="Illness/disease" S ILL=ILL+1 D
"RTN","OOPSLOG",72,0)
 . S:OOPS(2260,DA,29,"E")="Death" FCILL=FCILL+1
"RTN","OOPSLOG",73,0)
 . S:OOPS(2260,DA,33,"E")="Yes" LTILL=LTILL+1
"RTN","OOPSLOG",74,0)
 S:INC=0 OOPS(2260,DA,1,"E")="",OOPS(2260,DA,15,"E")="",OOPS(2260,DA,14,"E")=""
"RTN","OOPSLOG",75,0)
 I 'HDRFLG D HDR S HDRFLG=1
"RTN","OOPSLOG",76,0)
 W !,CASE,?12,$P(OOPS(2260,DA,4,"E"),"@",1),?26,OOPS(2260,DA,1,"E")
"RTN","OOPSLOG",77,0)
 W ?58,OOPS(2260,DA,15,"E"),?64,$E(OOPS(2260,DA,14,"E"),1,4)
"RTN","OOPSLOG",78,0)
 W ?70,OOPS(2260,DA,33,"E") D P Q:EX=U 
"RTN","OOPSLOG",79,0)
 W !,$E(OOPS(2260,DA,52,"E"),1,7),?12,$E(OOPS(2260,DA,51,"E"),1,12)
"RTN","OOPSLOG",80,0)
 W ?26,OOPS(2260,DA,3,"E") D P Q:EX=U
"RTN","OOPSLOG",81,0)
 I OOPS(2260,DA,86,"I")'="" W ?58,$E($$GET1^DIQ(49,OOPS(2260,DA,86,"I"),.01),1,22) D P Q:EX=U
"RTN","OOPSLOG",82,0)
 W !,$E(OOPS(2260,DA,29,"E"),1,35),?58,$E(OOPS(2260,DA,30,"E"),1,21) D P Q:EX=U
"RTN","OOPSLOG",83,0)
 ; patch 11 - if NS then print new prompts
"RTN","OOPSLOG",84,0)
 I $G(NS) D  Q:EX=U
"RTN","OOPSLOG",85,0)
 . W ! I $G(OOPS(2260,DA,37,"I"))'="" W $$GET1^DIQ(2261.6,OOPS(2260,DA,37,"I"),.01) D P Q:EX=U
"RTN","OOPSLOG",86,0)
 . ; patch 11 v3 08/03/01
"RTN","OOPSLOG",87,0)
 . W !,$$GET1^DIQ(2260,DA,"38:.01") D P Q:EX=U
"RTN","OOPSLOG",88,0)
 . W !,$$GET1^DIQ(2260,DA,"82:.01") D P Q:EX=U
"RTN","OOPSLOG",89,0)
 . W !,$$GET1^DIQ(2260,DA,108) D P Q:EX=U
"RTN","OOPSLOG",90,0)
 . S OPFLD=28 D WP K OPFLD
"RTN","OOPSLOG",91,0)
 W !,DASHES
"RTN","OOPSLOG",92,0)
 Q
"RTN","OOPSLOG",93,0)
LOGSUM ;Log Summary
"RTN","OOPSLOG",94,0)
 Q:EX=U
"RTN","OOPSLOG",95,0)
 ; Patch 9 - if nothing to summarize, don't print
"RTN","OOPSLOG",96,0)
 I 'INJ&('ILL)&('FCINJ)&('FCILL)&('LTINJ)&('LTILL) Q
"RTN","OOPSLOG",97,0)
 I IOST?1"C".E,$Y>14 D  Q:EX=U
"RTN","OOPSLOG",98,0)
 .W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSLOG",99,0)
 .W @IOF S PG=PG+1
"RTN","OOPSLOG",100,0)
 .W !,HDR,?72,"Page",$S($L(PG)=2:" ",1:"  "),PG
"RTN","OOPSLOG",101,0)
 .W !?(40-($L(RANGE)/2)),RANGE
"RTN","OOPSLOG",102,0)
 .W !,DASHES
"RTN","OOPSLOG",103,0)
 W !,"Log Summary" D P Q:EX=U
"RTN","OOPSLOG",104,0)
 W !,DASHES D P Q:EX=U
"RTN","OOPSLOG",105,0)
 W !,"Injuries.: ",$J(INJ,3),?16,"Fatal Injuries....: ",$J(FCINJ,3)
"RTN","OOPSLOG",106,0)
 W ?41,"Lost Time Injuries....: ",$J(LTINJ,3) D P Q:EX=U
"RTN","OOPSLOG",107,0)
 W !,"Illnesses: ",$J(ILL,3),?16,"Fatal Illnesses...: ",$J(FCILL,3)
"RTN","OOPSLOG",108,0)
 W ?41,"Lost Time Illnesses...: ",$J(LTILL,3) D P Q:EX=U
"RTN","OOPSLOG",109,0)
 W !,"--------------",?16,"-----------------------",?41,"---------------------------" D P Q:EX=U
"RTN","OOPSLOG",110,0)
 S INJILL=INJ+ILL,FCINJILL=FCINJ+FCILL,LTINJILL=LTINJ+LTILL
"RTN","OOPSLOG",111,0)
 W !,"Total....: ",$J(INJILL,3),?16,"Total.............: ",$J(FCINJILL,3)
"RTN","OOPSLOG",112,0)
 W ?41,"Total.................: ",$J(LTINJILL,3)
"RTN","OOPSLOG",113,0)
 W !,DASHES
"RTN","OOPSLOG",114,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSLOG",115,0)
 S (INJ,FCINJ,LTINJ,ILL,FCILL,LTILL,INJILL,FCINJILL,LTINJILL)=0
"RTN","OOPSLOG",116,0)
 Q
"RTN","OOPSLOG",117,0)
P ;Display Data
"RTN","OOPSLOG",118,0)
 I $Y'<LIN D  Q:EX=U
"RTN","OOPSLOG",119,0)
 .I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSLOG",120,0)
 .D HDR
"RTN","OOPSLOG",121,0)
 Q
"RTN","OOPSLOG",122,0)
TASK ;Queue a task
"RTN","OOPSLOG",123,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE
"RTN","OOPSLOG",124,0)
 S ZTRTN="PRT^OOPSLOG",ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","OOPSLOG",125,0)
 S ZTDESC="Log of Federal Occupational Injuries and Illnesses"
"RTN","OOPSLOG",126,0)
 S ZTSAVE("FY")="",ZTSAVE("INC")="",ZTSAVE("NS")="",ZTSAVE("EV")=""
"RTN","OOPSLOG",127,0)
 ; Patch 5 - added STA
"RTN","OOPSLOG",128,0)
 S ZTSAVE("STA")=""
"RTN","OOPSLOG",129,0)
 ; Patch 11 - Added date Ranges
"RTN","OOPSLOG",130,0)
 S ZTSAVE("SD")="",ZTSAVE("SDT")="",ZTSAVE("ED")="",ZTSAVE("EDT")=""
"RTN","OOPSLOG",131,0)
 ; patch 11 v3 8/2/01 add new variables
"RTN","OOPSLOG",132,0)
 S ZTSAVE("RANGE")="",ZTSAVE("HDR")="",ZTSAVE("HDR1")=""
"RTN","OOPSLOG",133,0)
 S ZTSAVE("HDR2")=""
"RTN","OOPSLOG",134,0)
 D ^%ZTLOAD D ^%ZISC U IO W !,"Request Queued",!
"RTN","OOPSLOG",135,0)
 K ZTSK Q
"RTN","OOPSLOG",136,0)
HDR ;Header
"RTN","OOPSLOG",137,0)
 S HDR2="Station Name: "_$$GET1^DIQ(4,LP1,.01,"E")
"RTN","OOPSLOG",138,0)
 W @IOF S PG=PG+1
"RTN","OOPSLOG",139,0)
 W !?(40-($L(HDR)/2)),HDR,?72,"Page",$S($L(PG)=2:" ",1:"  "),PG
"RTN","OOPSLOG",140,0)
 W !?(40-($L(RANGE)/2)),RANGE
"RTN","OOPSLOG",141,0)
 W !?(40-($L(HDR1)/2)),HDR1,!?(40-($L(HDR2)/2)),HDR2,!
"RTN","OOPSLOG",142,0)
 W:INC=1 !,"Case #",?12,"Date",?26,"Name",?58,"Occ",?64,"CC",?69,"Lost Time"
"RTN","OOPSLOG",143,0)
 W:INC=0 !,"Case #",?12,"Date",?69,"Lost Time"
"RTN","OOPSLOG",144,0)
 W !,"Inj/Ill",?12,"Status",?26,"Type of Incident",?58,"Service"
"RTN","OOPSLOG",145,0)
 W !,"Char. of Injury",?58,"Body Part Affected"
"RTN","OOPSLOG",146,0)
 I $G(NS) D
"RTN","OOPSLOG",147,0)
 . W !,"Activity at time of Injury"
"RTN","OOPSLOG",148,0)
 . ; Patch 11 v3 08/02/01
"RTN","OOPSLOG",149,0)
 . W !,"Object Causing Injury"
"RTN","OOPSLOG",150,0)
 . W !,"Model and Brand of Object Causing Injury"
"RTN","OOPSLOG",151,0)
 . W !,"Location of Injury"
"RTN","OOPSLOG",152,0)
 . ; W !,"Description of Injury"
"RTN","OOPSLOG",153,0)
 W !,DASHES
"RTN","OOPSLOG",154,0)
 Q
"RTN","OOPSLOG",155,0)
STATION(STA,OUT) ; Get 'ALL' or one station
"RTN","OOPSLOG",156,0)
 S STA=""
"RTN","OOPSLOG",157,0)
 N DIC,DIR,DIRUT,Y
"RTN","OOPSLOG",158,0)
 S DIR(0)="Y",DIR("A")="Run report for 'ALL' Stations",DIR("B")="Yes"
"RTN","OOPSLOG",159,0)
 S DIR("?")="Enter 'Y'es to run for all Stations or 'N'o to run "
"RTN","OOPSLOG",160,0)
 S DIR("?")=DIR("?")_"for just one Station."
"RTN","OOPSLOG",161,0)
 D ^DIR I Y S STA="A" Q
"RTN","OOPSLOG",162,0)
 I $D(DIRUT)!($D(DUOUT)) S OUT=1 Q
"RTN","OOPSLOG",163,0)
S1 ; if get here user <CR>
"RTN","OOPSLOG",164,0)
 S DIC("A")="Select STATION NUMBER: "
"RTN","OOPSLOG",165,0)
 S DIC="^DIC(4,",DIC(0)="AEMQZ"
"RTN","OOPSLOG",166,0)
 D ^DIC
"RTN","OOPSLOG",167,0)
 I $D(DUOUT) S OUT=1 Q
"RTN","OOPSLOG",168,0)
 I Y=-1 W !?5,"No Station selected, report will not run" S OUT=1 Q
"RTN","OOPSLOG",169,0)
 S STA=+Y
"RTN","OOPSLOG",170,0)
 I '$D(^OOPS(2260,"D",STA)) W !?5,"No data for that Station Number, Please select again." G S1
"RTN","OOPSLOG",171,0)
 Q
"RTN","OOPSLOG",172,0)
WP ;Process Word Processing Fields
"RTN","OOPSLOG",173,0)
 N DIWL,DIWR,DIWF,OPGLB,OPI,OPNODE,OPT,OPC
"RTN","OOPSLOG",174,0)
 K ^UTILITY($J,"W")
"RTN","OOPSLOG",175,0)
 S DIWL=1,DIWR="",DIWF="|C76"
"RTN","OOPSLOG",176,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSLOG",177,0)
 S OPI=0 F  S OPI=$O(^OOPS(2260,DA,OPNODE,OPI)) Q:'OPI  S X=$G(^OOPS(2260,DA,OPNODE,OPI,0)) D:X]"" ^DIWP
"RTN","OOPSLOG",178,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSLOG",179,0)
 I OPT D
"RTN","OOPSLOG",180,0)
 . W !,"Description of Injury:"
"RTN","OOPSLOG",181,0)
 . S OPI=0 F OPC=1:1 S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI!(EX=U)  D
"RTN","OOPSLOG",182,0)
 .. W !?2,^UTILITY($J,"W",1,OPI,0) D P Q:EX=U
"RTN","OOPSLOG",183,0)
 K ^UTILITY($J,"W"),X
"RTN","OOPSLOG",184,0)
 Q
"RTN","OOPSNDB")
0^4^B42742953
"RTN","OOPSNDB",1,0)
OOPSNDB ; WISC/LLH - NATIONAL DATABASE; 10/12/99
"RTN","OOPSNDB",2,0)
 ;;1.0;ASISTS;**5,11**;Jun 01, 1998
"RTN","OOPSNDB",3,0)
 ;
"RTN","OOPSNDB",4,0)
 N ARR,FIELD,FL,MAN,MSG,VAL,RDATE,OOPDA
"RTN","OOPSNDB",5,0)
 S MAN=1
"RTN","OOPSNDB",6,0)
 I '$D(^XUSEC("OOPS XMIT 2162 DATA",DUZ)) D  G EXIT
"RTN","OOPSNDB",7,0)
 . S DIR(0)="FO" W !
"RTN","OOPSNDB",8,0)
 . S DIR("A")="You do NOT have the required Security Key."
"RTN","OOPSNDB",9,0)
 . S DIR("A")=DIR("A")_"  Press Enter to continue"
"RTN","OOPSNDB",10,0)
 . D ^DIR K DIR
"RTN","OOPSNDB",11,0)
 ; Assure the Queue (Q-ASI) has been defined
"RTN","OOPSNDB",12,0)
 S VAL="Q-ASI.MED.VA.GOV",FIELD=.01,FL="X"
"RTN","OOPSNDB",13,0)
 D FIND^DIC(4.2,"",FIELD,FL,VAL,"","","","","ARR")
"RTN","OOPSNDB",14,0)
 I '$D(ARR("DILIST",1)) D  G EXIT
"RTN","OOPSNDB",15,0)
 . S DIR(0)="FO" W !
"RTN","OOPSNDB",16,0)
 . S DIR("A")="Domain not found in the DOMAIN File,"
"RTN","OOPSNDB",17,0)
 . S DIR("A")=DIR("A")_" No Transmission. Press Enter to continue"
"RTN","OOPSNDB",18,0)
 . D ^DIR K DIR
"RTN","OOPSNDB",19,0)
 S DIR(0)="D"
"RTN","OOPSNDB",20,0)
 S DIR("A")="Re-transmit cases for what date "
"RTN","OOPSNDB",21,0)
 S DIR("?",1)="Enter the date of original transmission for cases "
"RTN","OOPSNDB",22,0)
 S DIR("?")="that need to be resent"
"RTN","OOPSNDB",23,0)
 D ^DIR K DIR G:$D(DIRUT) EXIT I Y S RDATE=Y
"RTN","OOPSNDB",24,0)
 S DIR(0)="Y",DIR("B")="Y",DIR("A")="Do you want to Queue Transmission"
"RTN","OOPSNDB",25,0)
 S DIR("?",1)="Enter 'Y' if you want the 2162 data placed in mail"
"RTN","OOPSNDB",26,0)
 S DIR("?")="messages as part of a tasked job."
"RTN","OOPSNDB",27,0)
 D ^DIR K DIR G:$D(DIRUT) EXIT I Y D  G EXIT
"RTN","OOPSNDB",28,0)
 . S ZTRTN="EN^OOPSNDB",ZTIO=""
"RTN","OOPSNDB",29,0)
 . S ZTDESC="TRAMSIT NATIONAL DATABASE 2162 DATA"
"RTN","OOPSNDB",30,0)
 . D ^%ZTLOAD
"RTN","OOPSNDB",31,0)
 S DIR(0)="Y"
"RTN","OOPSNDB",32,0)
 S DIR("A")="Transmission NOT queued, OK to continue"
"RTN","OOPSNDB",33,0)
 D ^DIR K DIR I 'Y G EXIT
"RTN","OOPSNDB",34,0)
 S MSG("DIHELP",1)="Processing" W !
"RTN","OOPSNDB",35,0)
 D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSNDB",36,0)
EN ; Routine Entry
"RTN","OOPSNDB",37,0)
 N CNT,ERR,ERROR,FAIL,OPMG,OPQ
"RTN","OOPSNDB",38,0)
 K VMSG,INV                     ; used for data validation of records
"RTN","OOPSNDB",39,0)
 S CTR=1                        ; counter for Mail message array
"RTN","OOPSNDB",40,0)
 S (START,END,FAIL)=""
"RTN","OOPSNDB",41,0)
 ; Assure the Queue (Q-ASI) has been defined
"RTN","OOPSNDB",42,0)
 S VAL="Q-ASI.MED.VA.GOV",FIELD=.01,FL="X"
"RTN","OOPSNDB",43,0)
 D FIND^DIC(4.2,"",FIELD,FL,VAL,"","","","","ARR")
"RTN","OOPSNDB",44,0)
 I '$D(ARR("DILIST",1)) D  G EXIT
"RTN","OOPSNDB",45,0)
 . S ERROR(1)="The Queue Q-ASI.MED.VA.GOV has not been created."
"RTN","OOPSNDB",46,0)
 . S ERROR(2)="Install Patch XM*999*130, complete manual "
"RTN","OOPSNDB",47,0)
 . S ERROR(3)="Transmission of NDB Data."
"RTN","OOPSNDB",48,0)
 . D ERROR
"RTN","OOPSNDB",49,0)
 ; Make sure Mail Group Exists
"RTN","OOPSNDB",50,0)
 S OPMG=$$FIND1^DIC(3.8,"","X","OOPS NDB MESSAGES")
"RTN","OOPSNDB",51,0)
 I 'OPMG D  G EXIT
"RTN","OOPSNDB",52,0)
 . S ERROR(1)="The Mail Group OOPS NDB MESSAGES is missing."
"RTN","OOPSNDB",53,0)
 . S ERROR(2)="Add the Group so that ASISTS data can be transmitted "
"RTN","OOPSNDB",54,0)
 . S ERROR(3)="to the AAC.  Then contact IRM to complete manual "
"RTN","OOPSNDB",55,0)
 . S ERROR(4)="Transmission of NDB Data."
"RTN","OOPSNDB",56,0)
 . D ERROR
"RTN","OOPSNDB",57,0)
 ; Get list of members
"RTN","OOPSNDB",58,0)
 D LIST^DIC(3.81,","_OPMG_",","","",1,"","","","","","OPQ")
"RTN","OOPSNDB",59,0)
 I '$P(OPQ("DILIST",0),U) D  G EXIT
"RTN","OOPSNDB",60,0)
 . S ERROR(1)="There are no members of the OOPS NDB MESSAGES "
"RTN","OOPSNDB",61,0)
 . S ERROR(1)=ERROR(1)_"Mail Group."
"RTN","OOPSNDB",62,0)
 . S ERROR(2)="Enter at least one member to the group.  This person "
"RTN","OOPSNDB",63,0)
 . S ERROR(3)="will receive messages concerning the transmission of "
"RTN","OOPSNDB",64,0)
 . S ERROR(4)="ASISTS NDB data to and from the AAC. After adding member"
"RTN","OOPSNDB",65,0)
 . S ERROR(5)="contact IRM to complete manual transmission of NDB data."
"RTN","OOPSNDB",66,0)
 . D ERROR
"RTN","OOPSNDB",67,0)
GETREC ; Loop thru ^OOP(2260 "AN" OR "ANC" Xref to get records to transmit
"RTN","OOPSNDB",68,0)
 ; The logic for this data retrevial was changed for patch 11 to use
"RTN","OOPSNDB",69,0)
 ; the Xrefs vs looping through the entire 2260 file.
"RTN","OOPSNDB",70,0)
 N OOPIEN,PRSCNT,PRSDA,XMDUZ,XMTEXT,XMSUB,XMY,INDEX,INDEX2
"RTN","OOPSNDB",71,0)
 N Y,%,%H,%I
"RTN","OOPSNDB",72,0)
 K ^TMP($J,"C"),^TMP($J,"D")
"RTN","OOPSNDB",73,0)
 S (CNT,PRSCNT,OOPDA)=0
"RTN","OOPSNDB",74,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD")
"RTN","OOPSNDB",75,0)
 S MTIME=$P(Y,"@",2),DATE=$$DC^OOPSNDBX(%)
"RTN","OOPSNDB",76,0)
 S OOPIEN=""
"RTN","OOPSNDB",77,0)
 I '$G(MAN) S INDEX="^OOPS(2260,""AN"",OPI)",INDEX2="^OOPS(2260,""AN"",OPI,OOPIEN)"
"RTN","OOPSNDB",78,0)
 E  S INDEX="^OOPS(2260,""ANC"",OPI)",INDEX2="^OOPS(2260,""ANC"",OPI,OOPIEN)"
"RTN","OOPSNDB",79,0)
 S OPI=0 F  S OPI=$O(@INDEX) Q:'OPI  D
"RTN","OOPSNDB",80,0)
 .S OOPIEN=0 F  S OOPIEN=$O(@INDEX2) Q:'OOPIEN  D
"RTN","OOPSNDB",81,0)
 .. I $G(MAN),OPI'=RDATE Q
"RTN","OOPSNDB",82,0)
 .. S VALID=""
"RTN","OOPSNDB",83,0)
 .. F CHK=5:1:7 I '$$GET1^DIQ(2260,OOPIEN,CHK,"I") S:CHK=5 $P(VALID,U)=5 S:CHK=6 $P(VALID,U,2)=6 S:CHK=7 $P(VALID,U,3)=7
"RTN","OOPSNDB",84,0)
 .. I $G(VALID)'="" S ^TMP($J,"D",OOPIEN)=VALID Q
"RTN","OOPSNDB",85,0)
 .. S ^TMP($J,"C",OOPIEN)=""
"RTN","OOPSNDB",86,0)
 .. S CNT=CNT+1
"RTN","OOPSNDB",87,0)
 S ^TMP($J,"C")=CNT
"RTN","OOPSNDB",88,0)
 ; Count # of Non-Separated PAID Employees
"RTN","OOPSNDB",89,0)
 S PRSDA=0 D
"RTN","OOPSNDB",90,0)
 . F  S PRSDA=$O(^PRSPC(PRSDA)) Q:PRSDA'>0  D
"RTN","OOPSNDB",91,0)
 .. I $$GET1^DIQ(450,PRSDA,80,"I")'="Y" S PRSCNT=PRSCNT+1
"RTN","OOPSNDB",92,0)
NOCASES ; No Cases to Send - Send Mail Message with only NDB segment
"RTN","OOPSNDB",93,0)
 I CNT=0 D  G EXIT
"RTN","OOPSNDB",94,0)
 . D CREATE Q:FAIL
"RTN","OOPSNDB",95,0)
 . D SEND
"RTN","OOPSNDB",96,0)
PROCESS ;
"RTN","OOPSNDB",97,0)
 D CREATE G:FAIL EXIT
"RTN","OOPSNDB",98,0)
 ; START - First case number in MM, End - Last Case # in MM
"RTN","OOPSNDB",99,0)
 S OOPDA="",START="",END="",OPAST=""
"RTN","OOPSNDB",100,0)
 F  S OPAST=OOPDA,OOPDA=$O(^TMP($J,"C",OOPDA)) Q:OOPDA=""  D
"RTN","OOPSNDB",101,0)
 . D ^OOPSNDBX
"RTN","OOPSNDB",102,0)
 . ; Set DATE TRANSMITTED TO NDB in ^OOPS(2260 records 
"RTN","OOPSNDB",103,0)
 . I $$GET1^DIQ(2260,OOPDA,57)="" D
"RTN","OOPSNDB",104,0)
 .. K DR S DIE="^OOPS(2260,",(IEN,DA)=OOPDA,DR="57///TODAY" D ^DIE K DR,DA,DIE
"RTN","OOPSNDB",105,0)
 ; If any records left to send and no FAILure
"RTN","OOPSNDB",106,0)
 I ($G(XMZ)'<1)&('FAIL) D
"RTN","OOPSNDB",107,0)
 . I END="" S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSNDB",108,0)
 . D SEND
"RTN","OOPSNDB",109,0)
 ;
"RTN","OOPSNDB",110,0)
EXIT ; Quits the program
"RTN","OOPSNDB",111,0)
 D BADREC                      ; Send Mail if any Bad Records
"RTN","OOPSNDB",112,0)
 I $G(FAIL) D
"RTN","OOPSNDB",113,0)
 . S ERROR(1)="Mail Message was not created.  Contact IRM to comlete "
"RTN","OOPSNDB",114,0)
 . S ERROR(2)="the manual transmission of ASISTS NDB data."
"RTN","OOPSNDB",115,0)
 . D ERROR
"RTN","OOPSNDB",116,0)
 K CTR,DATE,ERR,ERROR,GRP,INV,OPL,MSIZE,MTIME,XMSUB,XMTEXT,XMY,MSG
"RTN","OOPSNDB",117,0)
 K ^TMP($J)
"RTN","OOPSNDB",118,0)
 Q
"RTN","OOPSNDB",119,0)
CREATE ; Create MailMan Message
"RTN","OOPSNDB",120,0)
 N OPDATA,SN
"RTN","OOPSNDB",121,0)
 S MSIZE=0
"RTN","OOPSNDB",122,0)
 I $G(XMZ)'<1 D SEND
"RTN","OOPSNDB",123,0)
 S OPL=0
"RTN","OOPSNDB",124,0)
 S XMSUB="ASISTS NATIONAL DATABASE"
"RTN","OOPSNDB",125,0)
 S XMDUZ=DUZ
"RTN","OOPSNDB",126,0)
 D XMZ^XMA2 I XMZ<1 S FAIL=1 Q
"RTN","OOPSNDB",127,0)
 S SN=$P($G(^XMB(1,1,"XUS")),U,17)
"RTN","OOPSNDB",128,0)
 S SN=$E("0000000",$L(SN)+1,7)_SN
"RTN","OOPSNDB",129,0)
 S OPDATA="NDB^OOPS^"_SN_U_DATE_U_MTIME_U_^TMP($J,"C")
"RTN","OOPSNDB",130,0)
 S OPDATA=OPDATA_U_U_PRSCNT_U_"002"_U_"|"     ; chg 001 to 002 as ver 2
"RTN","OOPSNDB",131,0)
 S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=OPDATA
"RTN","OOPSNDB",132,0)
 Q
"RTN","OOPSNDB",133,0)
SEND ; Send MailMan Message
"RTN","OOPSNDB",134,0)
 N NUMCASE
"RTN","OOPSNDB",135,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_OPL_U_OPL_U_DT
"RTN","OOPSNDB",136,0)
 ; Set # of Cases in this Mail Message
"RTN","OOPSNDB",137,0)
 S NUMCASE=$S(START'="":START_"-"_END,1:0)
"RTN","OOPSNDB",138,0)
 S $P(^XMB(3.9,XMZ,2,1,0),U,7)=NUMCASE
"RTN","OOPSNDB",139,0)
 ; Indicate last line of message
"RTN","OOPSNDB",140,0)
 S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)="$"
"RTN","OOPSNDB",141,0)
 S XMY(DUZ)=""                        ; also send here, in case of error.
"RTN","OOPSNDB",142,0)
 S XMY("XXX@Q-ASI.MED.VA.GOV")=""
"RTN","OOPSNDB",143,0)
 S XMCHAN=1 D ENT1^XMD K XMCHAN
"RTN","OOPSNDB",144,0)
 K XMZ
"RTN","OOPSNDB",145,0)
 Q
"RTN","OOPSNDB",146,0)
BADREC ; If any records with missing data, send mail message
"RTN","OOPSNDB",147,0)
 K MSG
"RTN","OOPSNDB",148,0)
 S CTR=1,OOPDA=0
"RTN","OOPSNDB",149,0)
 F  S OOPDA=$O(^TMP($J,"D",OOPDA)) Q:OOPDA=""  D
"RTN","OOPSNDB",150,0)
 . S VALID=^TMP($J,"D",OOPDA)
"RTN","OOPSNDB",151,0)
 . S MSG(CTR)="Case: "_$$GET1^DIQ(2260,OOPDA,.01)_" has missing data "
"RTN","OOPSNDB",152,0)
 . S MSG(CTR)=MSG(CTR)_"that must be entered prior",CTR=CTR+1
"RTN","OOPSNDB",153,0)
 . S MSG(CTR)="to transmitting to AAC. ",CTR=CTR+1
"RTN","OOPSNDB",154,0)
 . I $P(VALID,U) S MSG(CTR)="  Missing SSN",CTR=CTR+1
"RTN","OOPSNDB",155,0)
 . I $P(VALID,U,2) S MSG(CTR)="  Missing DOB",CTR=CTR+1
"RTN","OOPSNDB",156,0)
 . I $P(VALID,U,3) S MSG(CTR)="  Missing SEX",CTR=CTR+1
"RTN","OOPSNDB",157,0)
 I $D(MSG) D 
"RTN","OOPSNDB",158,0)
 . S XMSUB="ASISTS Records Missing Necessary Data Elements"
"RTN","OOPSNDB",159,0)
 . S XMY("G.OOPS NDB MESSAGES@"_^XMB("NETNAME"))=""
"RTN","OOPSNDB",160,0)
 . S XMTEXT="MSG("
"RTN","OOPSNDB",161,0)
 . D ^XMD
"RTN","OOPSNDB",162,0)
 Q
"RTN","OOPSNDB",163,0)
ERROR ; Create appropriate Error message and Send message
"RTN","OOPSNDB",164,0)
 S XMDUZ="ASISTS Package"
"RTN","OOPSNDB",165,0)
 S GRP="OOPS SAFETY"
"RTN","OOPSNDB",166,0)
 D GRP^OOPSMBUL
"RTN","OOPSNDB",167,0)
 ; If no one in mail group (this should not occur), send to user
"RTN","OOPSNDB",168,0)
 I $D(XMY)<9 S XMY(DUZ)=""
"RTN","OOPSNDB",169,0)
 S XMSUB="ASISTS NDB Error Notification Message"
"RTN","OOPSNDB",170,0)
 S XMTEXT="ERROR("
"RTN","OOPSNDB",171,0)
 D ^XMD
"RTN","OOPSNDB",172,0)
 I '$D(ZTQUEUED) D
"RTN","OOPSNDB",173,0)
 . S MSG("DIHELP",1)="An Error Occurred during Processing, check"
"RTN","OOPSNDB",174,0)
 . S MSG("DIHELP",2)="Mailman Message for details."
"RTN","OOPSNDB",175,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSNDB",176,0)
 K ERROR
"RTN","OOPSNDB",177,0)
 Q
"RTN","OOPSNDBX")
0^8^B23721312
"RTN","OOPSNDBX",1,0)
OOPSNDBX ;;WCIOFO/LLH - Extract data to MailMan message
"RTN","OOPSNDBX",2,0)
 ;;1.0;ASISTS;**5,11**;Jun 01, 1998
"RTN","OOPSNDBX",3,0)
 ;
"RTN","OOPSNDBX",4,0)
 ; Retrieves data from ^OOPS(2260, for 2162
"RTN","OOPSNDBX",5,0)
 ; Variables used
"RTN","OOPSNDBX",6,0)
 ;  OOPDA        IEN of Case
"RTN","OOPSNDBX",7,0)
 ;  OOPSAR       Array holding data
"RTN","OOPSNDBX",8,0)
 ;  OPL          Last Line number written in message text
"RTN","OOPSNDBX",9,0)
 ;  XMZ          Message Number
"RTN","OOPSNDBX",10,0)
EN ; Entry
"RTN","OOPSNDBX",11,0)
 N ARR,MESS,OPC,OPDATA,OPFLD,OPI,OPJ,OPSAR,OPT,OPX,SEG,TL,NCHAR
"RTN","OOPSNDBX",12,0)
 S RSIZE=0,ARR=0
"RTN","OOPSNDBX",13,0)
 S OPSAR(0)=$G(^OOPS(2260,OOPDA,0))
"RTN","OOPSNDBX",14,0)
 S OPSAR("2162A")=$G(^OOPS(2260,OOPDA,"2162A"))
"RTN","OOPSNDBX",15,0)
 S OPSAR("2162B")=$G(^OOPS(2260,OOPDA,"2162B"))
"RTN","OOPSNDBX",16,0)
 S OPSAR("2162D")=$G(^OOPS(2260,OOPDA,"2162D"))
"RTN","OOPSNDBX",17,0)
 S OPSAR("2162S")=$G(^OOPS(2260,OOPDA,"2162S"))
"RTN","OOPSNDBX",18,0)
OP1 ; Seg OP1
"RTN","OOPSNDBX",19,0)
 N TIME
"RTN","OOPSNDBX",20,0)
 S TIME=$P($P(OPSAR(0),U,5),".",2)
"RTN","OOPSNDBX",21,0)
 S OPX="OP1^"_$P(OPSAR(0),U)_U_$P(OPSAR(0),U,2)_U_$P(OPSAR(0),U,3)
"RTN","OOPSNDBX",22,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"3:1")
"RTN","OOPSNDBX",23,0)
 S OPX=OPX_U_$$DC($P($P(OPSAR(0),U,5),"."))
"RTN","OOPSNDBX",24,0)
 S OPX=OPX_U_TIME_$E("0000",$L(TIME)+1,4)
"RTN","OOPSNDBX",25,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U)_U_$$DC($P(OPSAR("2162A"),U,2))
"RTN","OOPSNDBX",26,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,3)_U_$P(OPSAR("2162A"),U,9)
"RTN","OOPSNDBX",27,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,10)_U_$P(OPSAR("2162A"),U,11)
"RTN","OOPSNDBX",28,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,12)_U_$P(OPSAR("2162A"),U,13)
"RTN","OOPSNDBX",29,0)
 S OPX=OPX_U_$P(OPSAR("2162A"),U,14)
"RTN","OOPSNDBX",30,0)
 S OPX=OPX_U_$P(OPSAR("2162B"),U)_U_$$GET1^DIQ(2260,OOPDA,"27:1")
"RTN","OOPSNDBX",31,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"29:1")
"RTN","OOPSNDBX",32,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"30:1")
"RTN","OOPSNDBX",33,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"30.1:1")_U_$P(OPSAR("2162B"),U,5)
"RTN","OOPSNDBX",34,0)
 S OPX=OPX_U_$P(OPSAR("2162B"),U,6)_U_$P(OPSAR("2162B"),U,7)
"RTN","OOPSNDBX",35,0)
 S OPX=OPX_U_$P(OPSAR("2162D"),U)_U_$P(OPSAR("2162D"),U,2)
"RTN","OOPSNDBX",36,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"36:1")
"RTN","OOPSNDBX",37,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"37:1")
"RTN","OOPSNDBX",38,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"38:1")
"RTN","OOPSNDBX",39,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"41:1")
"RTN","OOPSNDBX",40,0)
 S OPX=OPX_U_$P(OPSAR("2162D"),U,8)
"RTN","OOPSNDBX",41,0)
 S OPX=OPX_U_$P(OPSAR(0),U,7)_"^|"
"RTN","OOPSNDBX",42,0)
 S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",43,0)
 S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",44,0)
 ;
"RTN","OOPSNDBX",45,0)
OP2 ; Seg OP2 - Description of Incident (Word Processing)
"RTN","OOPSNDBX",46,0)
 S OPFLD=28,SEG="OP2"
"RTN","OOPSNDBX",47,0)
 D WP
"RTN","OOPSNDBX",48,0)
OP3 ; Seg OP3 - Equipment Device Failure
"RTN","OOPSNDBX",49,0)
 K OPX
"RTN","OOPSNDBX",50,0)
 I $P($G(OPSAR("2162D")),U,7)'="" D
"RTN","OOPSNDBX",51,0)
 . S OPX="OP3"_U_$P(OPSAR("2162D"),U,7)_"^|"
"RTN","OOPSNDBX",52,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",53,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",54,0)
OP4 ; Seg OP4 - Corrective Action - Word Processing
"RTN","OOPSNDBX",55,0)
 S OPFLD=47,SEG="OP4"
"RTN","OOPSNDBX",56,0)
 D WP
"RTN","OOPSNDBX",57,0)
OP5 ; Seg OP5 - Safety Officer Comments - Word Processing
"RTN","OOPSNDBX",58,0)
 S OPFLD=55,SEG="OP5"
"RTN","OOPSNDBX",59,0)
 D WP
"RTN","OOPSNDBX",60,0)
OP6 ; Seg OP6 - Area Exposed to Bodily Fluid - Multiple
"RTN","OOPSNDBX",61,0)
 K OPX
"RTN","OOPSNDBX",62,0)
 S OPDATA=""
"RTN","OOPSNDBX",63,0)
 S TL=0 F OPI=0:1 S TL=$O(^OOPS(2260,OOPDA,"2162E",TL)) Q:'TL
"RTN","OOPSNDBX",64,0)
 I OPI S TL=0 F OPJ=1:1 S TL=$O(^OOPS(2260,OOPDA,"2162E",TL)) Q:'TL  D
"RTN","OOPSNDBX",65,0)
 . S OPDATA=$G(^OOPS(2260,OOPDA,"2162E",TL,0)) Q:(OPDATA="")
"RTN","OOPSNDBX",66,0)
 . I OPJ=1 S OPX="OP6"_U_OPDATA
"RTN","OOPSNDBX",67,0)
 . I OPJ>1 S OPX=OPX_","_OPDATA
"RTN","OOPSNDBX",68,0)
 I $D(OPX) S OPX=OPX_"^|" D
"RTN","OOPSNDBX",69,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",70,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",71,0)
OP7 ; Seg OP7 - Personal Protective Equipment - Multiple
"RTN","OOPSNDBX",72,0)
 K OPX
"RTN","OOPSNDBX",73,0)
 S OPDATA=""
"RTN","OOPSNDBX",74,0)
 S TL=0 F OPI=0:1 S TL=$O(^OOPS(2260,OOPDA,"2162F",TL)) Q:'TL
"RTN","OOPSNDBX",75,0)
 I OPI S TL=0 F OPJ=1:1 S TL=$O(^OOPS(2260,OOPDA,"2162F",TL)) Q:'TL  D
"RTN","OOPSNDBX",76,0)
 . S OPDATA=$G(^OOPS(2260,OOPDA,"2162F",TL,0)) Q:(OPDATA="")
"RTN","OOPSNDBX",77,0)
 . I OPJ=1 S OPX="OP7"_U_OPDATA
"RTN","OOPSNDBX",78,0)
 . I OPJ>1 S OPX=OPX_","_OPDATA
"RTN","OOPSNDBX",79,0)
 I $D(OPX) S OPX=OPX_"^|" D
"RTN","OOPSNDBX",80,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",81,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",82,0)
OP8 ; Seg OP8 - new needlestick fields
"RTN","OOPSNDBX",83,0)
 K OPX
"RTN","OOPSNDBX",84,0)
 S OPDATA=""
"RTN","OOPSNDBX",85,0)
 S OPX="OP8"_U_$$GET1^DIQ(2260,OOPDA,"82:.01")_U_$$GET1^DIQ(2260,OOPDA,"83:.01")
"RTN","OOPSNDBX",86,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,"84:.01")
"RTN","OOPSNDBX",87,0)
 S OPX=OPX_U_$P(OPSAR("2162B"),U,13)_U_"|"
"RTN","OOPSNDBX",88,0)
 S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",89,0)
 S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",90,0)
OP9 ; Seg OP9 - Word processing field for field 85
"RTN","OOPSNDBX",91,0)
 N NSEG
"RTN","OOPSNDBX",92,0)
 K OPX
"RTN","OOPSNDBX",93,0)
 S NCHAR=$L(OPSAR("2162S"))
"RTN","OOPSNDBX",94,0)
 S NSEG=$S((NCHAR>210):4,(NCHAR>140&(NCHAR<211)):3,(NCHAR>70&(NCHAR<141)):2,1:0)
"RTN","OOPSNDBX",95,0)
 I NCHAR D
"RTN","OOPSNDBX",96,0)
 . S OPX="OP9^1^"_NSEG_"^"_$E(OPSAR("2162S"),1,70)
"RTN","OOPSNDBX",97,0)
 . S ARR=ARR+1,MESS(ARR)=OPX,RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",98,0)
 I NCHAR>70 D
"RTN","OOPSNDBX",99,0)
 . S OPX="OP9^2^"_NSEG_"^"_$E(OPSAR("2162S"),71,140)
"RTN","OOPSNDBX",100,0)
 . S ARR=ARR+1,MESS(ARR)=OPX,RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",101,0)
 I NCHAR>140 D
"RTN","OOPSNDBX",102,0)
 . S OPX="OP9^3^"_NSEG_"^"_$E(OPSAR("2162S"),141,210)
"RTN","OOPSNDBX",103,0)
 . S ARR=ARR+1,MESS(ARR)=OPX,RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",104,0)
 I NCHAR>210 D
"RTN","OOPSNDBX",105,0)
 . S OPX="OP9^4^"_NSEG_"^"_$E(OPSAR("2162S"),211,250)
"RTN","OOPSNDBX",106,0)
 . S ARR=ARR+1,MESS(ARR)=OPX,RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",107,0)
 ;
"RTN","OOPSNDBX",108,0)
EXIT ; Loads the message and Quits the routine
"RTN","OOPSNDBX",109,0)
 I RSIZE+MSIZE>31500 D
"RTN","OOPSNDBX",110,0)
 . S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSNDBX",111,0)
 . D SEND^OOPSNDB,CREATE^OOPSNDB
"RTN","OOPSNDBX",112,0)
 . S (START,END)=""
"RTN","OOPSNDBX",113,0)
 F I=1:1:ARR I $G(MESS(I))'="" D
"RTN","OOPSNDBX",114,0)
 . S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=MESS(I)
"RTN","OOPSNDBX",115,0)
 . I START="" S START=$P($P(OPSAR(0),U),"-",2)
"RTN","OOPSNDBX",116,0)
 S MSIZE=MSIZE+RSIZE
"RTN","OOPSNDBX",117,0)
 K ARR,MESS,OPDT,RSIZE
"RTN","OOPSNDBX",118,0)
 Q
"RTN","OOPSNDBX",119,0)
WP ; Word Processing Fields
"RTN","OOPSNDBX",120,0)
 N DIWL,DIWR,DIWF,OPGLB,OPNODE,X
"RTN","OOPSNDBX",121,0)
 S OPI=0
"RTN","OOPSNDBX",122,0)
 K ^UTILITY($J,"W")
"RTN","OOPSNDBX",123,0)
 S DIWL=1,DIWR="",DIWF="|C70"
"RTN","OOPSNDBX",124,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSNDBX",125,0)
 S OPI=0 F  S OPI=$O(^OOPS(2260,OOPDA,OPNODE,OPI)) Q:'OPI  S X=$G(^OOPS(2260,OOPDA,OPNODE,OPI,0)) D:X]"" ^DIWP
"RTN","OOPSNDBX",126,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSNDBX",127,0)
 I OPT S OPI=0 F OPC=1:1 S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI  D
"RTN","OOPSNDBX",128,0)
 . S OPX=SEG_U_OPC_U_OPT_U_$E(^UTILITY($J,"W",1,OPI,0),1,220)_"^|"
"RTN","OOPSNDBX",129,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSNDBX",130,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSNDBX",131,0)
 K ^UTILITY($J,"W"),X
"RTN","OOPSNDBX",132,0)
 Q
"RTN","OOPSNDBX",133,0)
DC(OPDT) ; Convert Date to YYYYMMDD
"RTN","OOPSNDBX",134,0)
 S:OPDT]"" OPDT=OPDT+17000000\1
"RTN","OOPSNDBX",135,0)
 Q OPDT
"RTN","OOPSPC11")
0^24^B17860899
"RTN","OOPSPC11",1,0)
OOPSPC11 ;HIRMFO/YH-EMPLOYEE'S DATA, CA1 FORM ;6/12/98
"RTN","OOPSPC11",2,0)
 ;;1.0;ASISTS;**1,6,8,11**;Jun 01, 1998
"RTN","OOPSPC11",3,0)
 ;EMPLOYEE DATA
"RTN","OOPSPC11",4,0)
 ;EMPLOYEE'S DATA
"RTN","OOPSPC11",5,0)
 S OOPSDATA=$P($G(^OOPS(2260,IEN,0)),"^",2)
"RTN","OOPSPC11",6,0)
 W !,"PU1.3,25.4,LB"_OOPSDATA_"#;" ;NAME
"RTN","OOPSPC11",7,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"2162A"))
"RTN","OOPSPC11",8,0)
 S OOPSP=$P(OOPSDATA,"^") I OOPSP'["-" S OOPSP=$E(OOPSP,1,3)_"-"_$E(OOPSP,4,5)_"-"_$E(OOPSP,6,13)
"RTN","OOPSPC11",9,0)
 W !,"PU16.8,25.3;LB"_OOPSP_"#;" ;SSN
"RTN","OOPSPC11",10,0)
 S OOPSP=$P(OOPSDATA,"^",2) I OOPSP'="" D WDATE^OOPSPUT1(OOPSP,"3.4,24.6","4.3,24.6","5.2,24.6") ;DATE OF BIRTH
"RTN","OOPSPC11",11,0)
 S OOPSP=$P(OOPSDATA,"^",3) W !,$S(OOPSP=1:"PU7.2,24.5;LBX#;",OOPSP=2:"PU8.6,24.5;LBX#;",1:"") ;SEX
"RTN","OOPSPC11",12,0)
 N PHN
"RTN","OOPSPC11",13,0)
 S PHN=$TR($P(OOPSDATA,"^",8),"/-*#","")
"RTN","OOPSPC11",14,0)
 W !,"PU10.8,24.6;LB"_$E(PHN,1,3)_"-"_$E(PHN,4,6)_"-",$E(PHN,7,10)_"#;"
"RTN","OOPSPC11",15,0)
 S OOPSP=$P(OOPSDATA,"^",12) I OOPSP'="" W !,"PU18.4,24.6;LB"_+OOPSP_"#;PU19.8,24.6;LB"_$P(OOPSDATA,"^",13)_"#;" ;GRADE AND STEP
"RTN","OOPSPC11",16,0)
 I $P(OOPSDATA,"^",4)'="" W !,"PU1.3,23.6;LB"_$P(OOPSDATA,"^",4)_"#;"
"RTN","OOPSPC11",17,0)
 I $P(OOPSDATA,"^",5)'="" W !,"PU1.3,22.6;LB"_$P(OOPSDATA,"^",5)_"#;"
"RTN","OOPSPC11",18,0)
 I $D(^DIC(5,+$P(OOPSDATA,"^",6),0)) W !,"LB, "_$P(^DIC(5,+$P(OOPSDATA,"^",6),0),"^")_"   "_$P(OOPSDATA,"^",7)_"#;" ;ADDRESS
"RTN","OOPSPC11",19,0)
 S OOPSP=+$P($G(^OOPS(2260,IEN,"CA1A")),"^",8) ;DEPENDENTS
"RTN","OOPSPC11",20,0)
 I OOPSP>0,OOPSP<7 D
"RTN","OOPSPC11",21,0)
 . W !,$S(OOPSP=1:"PU16.9,23.6;LBX#;",OOPSP=2:"PU16.9,23.2;LBX#;",OOPSP=3:"PU16.9,22.8;LBX#;",OOPSP=4:"PU16.9,23.6;LBX#;PU16.9,23.2;LBX#;",OOPSP=5:"PU16.9,23.6;LBX#;PU16.9,22.8;LBX#;",OOPSP=6:"PU16.9,23.2;LBX#;PU16.9,22.8;LBX#;",1:"")
"RTN","OOPSPC11",22,0)
 I OOPSP=7 W !,"PU16.9,23.6;LBX#;PU16.9,23.2;LBX#;PU16.9,22.8;LBX#;"
"RTN","OOPSPC11",23,0)
 W !,"PU1.3,21;LB"_$P($G(^OOPS(2260,IEN,"CA1A")),"^",9)_"#;" ;WHERE INJURY OCCURRED
"RTN","OOPSPC11",24,0)
 ; Patch 11 - this should print field 109, not 4
"RTN","OOPSPC11",25,0)
 ; S OOPSP=$P($G(^OOPS(2260,IEN,0)),"^",5) I OOPSP'="" D
"RTN","OOPSPC11",26,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA1A"))
"RTN","OOPSPC11",27,0)
 S OOPSP=$P(OOPSDATA,"^",10) I OOPSP'="" D
"RTN","OOPSPC11",28,0)
 . D WDATE^OOPSPUT1($P(OOPSP,"."),"1.4,19.8","2.3,19.8","3.2,19.8")
"RTN","OOPSPC11",29,0)
 . D WTIME^OOPSPUT1($P(OOPSP,".",2)_"0000","6.5,20.1","6.5,19.7","4.8,20","5.8,20") ;D/T INJURY OCCURED
"RTN","OOPSPC11",30,0)
 ; S OOPSDATA=$G(^OOPS(2260,IEN,"CA1A"))  ; moved above patch 11
"RTN","OOPSPC11",31,0)
 S OOPSP=$P(OOPSDATA,"^",11) I OOPSP'="" D WDATE^OOPSPUT1(OOPSP,"8.3,19.8","9.2,19.8","10,19.8") ;DATE OF NOTICE
"RTN","OOPSPC11",32,0)
 W !,"PU11.6,20;LB"_$P(OOPSDATA,"^",12)_"#;" ;OCCUPATION
"RTN","OOPSPC11",33,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA1B"))
"RTN","OOPSPC11",34,0)
 S OOPSP=$P(OOPSDATA,"^") I OOPSP'="" W !,"PU1.3,18.8;LB"_$E(OOPSP,1,86)_"#;","PU1.3,18.2;LB"_$E(OOPSP,87,150)_"#;","PU1.3,17.8;LB"_$E(OOPSP,151,200)_"#;" ;CAUSE OF INJURY
"RTN","OOPSPC11",35,0)
 ; patch 8 - added block 14
"RTN","OOPSPC11",36,0)
 S OOPSNOI=$$GET1^DIQ(2260,IEN,"62:1")
"RTN","OOPSPC11",37,0)
 S OCC=$$GET1^DIQ(2260,IEN,15,"E")
"RTN","OOPSPC11",38,0)
 S OCC=$S(OCC<2200:"G"_OCC,(OCC>2499&(OCC<9001)):"W"_OCC,(OCC=9999):"Z"_OCC,1:"")
"RTN","OOPSPC11",39,0)
 S OOPSTYP=$$GET1^DIQ(2260,IEN,"123:1")
"RTN","OOPSPC11",40,0)
 S OOPSSOR=$$GET1^DIQ(2260,IEN,"124:1")
"RTN","OOPSPC11",41,0)
 W "PU17.4,17.8;LB"_OCC_"#;"     ; OCCUPATION CODE
"RTN","OOPSPC11",42,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA1C")) W !,"PU1.3,16.8;LB"_$E(OOPSDATA,1,60)_"#;"  ; 1st line NATURE OF INJURY
"RTN","OOPSPC11",43,0)
 W "PU16.8,16.8;LB"_OOPSTYP_"#;"_"PU18.9,16.8;LB"_OOPSSOR_"#;" ;TYP/SORCE
"RTN","OOPSPC11",44,0)
 W "PU1.3,15.8;LB"_$E(OOPSDATA,61,100)_"#;" ;NATURE OF INJURY
"RTN","OOPSPC11",45,0)
 W "PU16.8,15.8;LB"_OOPSNOI_"#;"  ; NOI CODE
"RTN","OOPSPC11",46,0)
 S OOPSP=$P($G(^OOPS(2260,IEN,"CA1A")),"^",13) W !,$S(OOPSP["COP":"PU1.5,13.5;LBX#;",OOPSP["L":"PU1.5,12.4;LBX#;",1:"")
"RTN","OOPSPC11",47,0)
 K OOPSNOI,OCC,OOPSTYP,OOPSSOR
"RTN","OOPSPC11",48,0)
 ;
"RTN","OOPSPC11",49,0)
 ; Patch 8 - added Employee signature, date signed to CA1
"RTN","OOPSPC11",50,0)
 N X,X1,X2,STR,VER
"RTN","OOPSPC11",51,0)
 S STR=$G(^OOPS(2260,IEN,"CA")),VER=$P(STR,"^",9),X=$P(STR,"^",7)
"RTN","OOPSPC11",52,0)
 I $G(VER)=1&($G(X)'="") D
"RTN","OOPSPC11",53,0)
 . S X1=$$GET1^DIQ(2260,IEN,119,"I"),X2=$$CA1SUM^OOPSUTL6()
"RTN","OOPSPC11",54,0)
 . D DE^XUSHSHP
"RTN","OOPSPC11",55,0)
 . W !,"PU9.6,10.7;LB/ES/ "_X_"#;"
"RTN","OOPSPC11",56,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA1ES"))
"RTN","OOPSPC11",57,0)
 I $P(OOPSDATA,"^",2)'="",+$P(OOPSDATA,"^",3)>0 W !,"PU17.6,10.7;LB"_$$FMTE^XLFDT($P(OOPSDATA,"^",3),1)_"#;" ;DATE SIGNED
"RTN","OOPSPC11",58,0)
 ;
"RTN","OOPSPC11",59,0)
 ; Patch 8 - Witness information - only send the first witness entered
"RTN","OOPSPC11",60,0)
 N WITN
"RTN","OOPSPC11",61,0)
 S WITN=$O(^OOPS(2260,IEN,"CA1W",0))
"RTN","OOPSPC11",62,0)
 I '$G(WITN) K I,J Q
"RTN","OOPSPC11",63,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA1W",WITN,1))
"RTN","OOPSPC11",64,0)
 W !,"PU1.5,7.0;LB"_OOPSDATA_"#;"
"RTN","OOPSPC11",65,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA1W",WITN,0))
"RTN","OOPSPC11",66,0)
 W !,"PU1.5,3.9;LB"_$P(OOPSDATA,U)_"#;"_"PU17.9,3.9;LB"_$$FMTE^XLFDT($P(OOPSDATA,U,6),1)_"#;"
"RTN","OOPSPC11",67,0)
 W !,"PU1.5,3.2;LB"_$P(OOPSDATA,U,2)_"#;"   ; Witness address
"RTN","OOPSPC11",68,0)
 W !,"PU8.2,3.2;LB"_$P(OOPSDATA,U,3)_"#;"   ; Witness City
"RTN","OOPSPC11",69,0)
 W !,"PU13.4,3.2;LB"_$E($P($G(^DIC(5,+$P(OOPSDATA,U,4),0)),U),1,20)_"#;"
"RTN","OOPSPC11",70,0)
 W !,"PU17.9,3.2;LB"_$E($P(OOPSDATA,U,5),1,5)_"#;"
"RTN","OOPSPC11",71,0)
 S OOPSDATA=$G(^OOPS(2260,IEN,"CA1D"))
"RTN","OOPSPC11",72,0)
 W !,"PU1,3.9;LB"_$P(OOPSDATA,"^")_"#;"
"RTN","OOPSPC11",73,0)
 K I,J Q
"RTN","OOPSPRT")
0^5^B41633859
"RTN","OOPSPRT",1,0)
OOPSPRT ;HIRMFO/GWB - Print Report of Accident ;3/5/98
"RTN","OOPSPRT",2,0)
 ;;1.0;ASISTS;**2,3,5,11**;Jun 01, 1998
"RTN","OOPSPRT",3,0)
SUP S DIC="^OOPS(2260,"
"RTN","OOPSPRT",4,0)
 S DIC("S")="I $$GET1^DIQ(2260,Y,53,""I"")=DUZ!($$GET1^DIQ(2260,Y,53.1,""I"")=DUZ)"
"RTN","OOPSPRT",5,0)
 G DIC
"RTN","OOPSPRT",6,0)
SO S DIC="^OOPS(2260,"
"RTN","OOPSPRT",7,0)
DIC S DIC(0)="AEMNZ",DIC("A")="Select case: "
"RTN","OOPSPRT",8,0)
 D ^DIC Q:(Y<1)!($D(DTOUT))!($D(DUOUT))
"RTN","OOPSPRT",9,0)
 S IEN=+Y
"RTN","OOPSPRT",10,0)
 K IOP,%ZIS S %ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KILL
"RTN","OOPSPRT",11,0)
 I $D(IO("Q")) S OOPSLST="IEN^UNION" D TASK G KILL
"RTN","OOPSPRT",12,0)
 U IO D PRT D ^%ZISC K %ZIS,IOP G KILL
"RTN","OOPSPRT",13,0)
PRT N LIN,SUP,AETBF,CAT,PPE,INCID
"RTN","OOPSPRT",14,0)
 S PG=0,EX="",LIN=$S(($E(IOST,1,2)="C-"):IOSL-2,1:IOSL-6),IE=IEN
"RTN","OOPSPRT",15,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD") S DATE=$P(Y,":",1,2)
"RTN","OOPSPRT",16,0)
 K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01:99",DA=IEN,DIQ="OOPS" D EN^DIQ1
"RTN","OOPSPRT",17,0)
 I $D(^OOPS(2260,IEN,"2162E")) S EIEN=0 F  S EIEN=$O(^OOPS(2260,IEN,"2162E",EIEN)) Q:EIEN=""  K DIQ S DIC="^OOPS(2260,",DR=39,DA=IEN,DIQ="OOPS",DR(2260.039)=.01,DA(2260.039)=EIEN D EN^DIQ1
"RTN","OOPSPRT",18,0)
 I $D(^OOPS(2260,IEN,"2162F")) S FIEN=0 F  S FIEN=$O(^OOPS(2260,IEN,"2162F",FIEN)) Q:FIEN=""  K DIQ S DIC="^OOPS(2260,",DR=40,DA=IEN,DIQ="OOPS",DR(2260.01)=.01,DA(2260.01)=FIEN D EN^DIQ1
"RTN","OOPSPRT",19,0)
 S CN=OOPS(2260,IEN,.01)
"RTN","OOPSPRT",20,0)
 S TOI=OOPS(2260,IEN,3)
"RTN","OOPSPRT",21,0)
 ; Patch 5 - have changed this logic, matches other routines
"RTN","OOPSPRT",22,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSPRT",23,0)
 S SUP=$S((CAT=1!(CAT>6)):"SUPERVISOR...................:",CAT=2:"VOLUNTARY SVC SUPERVISOR.....:",CAT=3:"CONTRACT ADMINISTRATOR.......:",1:"SAFETY OFFICER...............:")
"RTN","OOPSPRT",24,0)
 D HDR
"RTN","OOPSPRT",25,0)
 W !,"CASE NUMBER..................: ",OOPS(2260,IEN,.01) D P Q:EX=U
"RTN","OOPSPRT",26,0)
 W !,"PERSONNEL STATUS.............: ",OOPS(2260,IEN,2) D P Q:EX=U
"RTN","OOPSPRT",27,0)
 W !,"SERVICE......................: ",OOPS(2260,IEN,86) D P Q:EX=U
"RTN","OOPSPRT",28,0)
 W !,"TYPE OF INCIDENT.............: ",OOPS(2260,IEN,3) D P Q:EX=U
"RTN","OOPSPRT",29,0)
 W !,"CASE STATUS..................: ",OOPS(2260,IEN,51) D P Q:EX=U
"RTN","OOPSPRT",30,0)
 W !,"INJURY/ILLNESS...............: ",OOPS(2260,IEN,52) D P Q:EX=U
"RTN","OOPSPRT",31,0)
 ; Patch 5 - added the block structure
"RTN","OOPSPRT",32,0)
 I $G(UNION)'="Y" D  Q:EX=U
"RTN","OOPSPRT",33,0)
 . W !,"PERSON INVOLVED..............: ",OOPS(2260,IEN,1) D P Q:EX=U
"RTN","OOPSPRT",34,0)
 . W !,"SSN..........................: ",OOPS(2260,IEN,5) D P Q:EX=U
"RTN","OOPSPRT",35,0)
 . W !,"DATE OF BIRTH................: ",OOPS(2260,IEN,6) D P Q:EX=U
"RTN","OOPSPRT",36,0)
 . W !,"SEX..........................: ",OOPS(2260,IEN,7) D P Q:EX=U
"RTN","OOPSPRT",37,0)
 . W !,"HOME ADDRESS.................: ",OOPS(2260,IEN,8) D P Q:EX=U
"RTN","OOPSPRT",38,0)
 . I (OOPS(2260,IEN,9)'="")!(OOPS(2260,IEN,10)'="")!(OOPS(2260,IEN,11)'="") W !,"                               ",OOPS(2260,IEN,9),", ",OOPS(2260,IEN,10)," ",OOPS(2260,IEN,11) D P Q:EX=U
"RTN","OOPSPRT",39,0)
 . W !,"HOME PHONE NUMBER............: ",OOPS(2260,IEN,12) D P Q:EX=U
"RTN","OOPSPRT",40,0)
 . ; Patch 5 - print station #
"RTN","OOPSPRT",41,0)
 . W !,"STATION NUMBER...............: ",OOPS(2260,IEN,13) D P Q:EX=U
"RTN","OOPSPRT",42,0)
 . W !,"COST CENTER/ORG..............: ",OOPS(2260,IEN,14) D P Q:EX=U
"RTN","OOPSPRT",43,0)
 . W !,"OCCUPATION...................: ",OOPS(2260,IEN,15) D P Q:EX=U
"RTN","OOPSPRT",44,0)
 . W !,"GRADE/STEP...................: ",OOPS(2260,IEN,16) W:OOPS(2260,IEN,16)'="" "/" W OOPS(2260,IEN,17) D P Q:EX=U
"RTN","OOPSPRT",45,0)
 . W !,"EDUCATION....................: ",OOPS(2260,IEN,18) D P Q:EX=U
"RTN","OOPSPRT",46,0)
 . W !,SUP," ",OOPS(2260,IEN,53) D P Q:EX=U
"RTN","OOPSPRT",47,0)
 . W !,"SECONDARY SUPERVISOR.........: ",OOPS(2260,IEN,53.1) D P Q:EX=U
"RTN","OOPSPRT",48,0)
 ; Patch 5 - new logic for Station Number display
"RTN","OOPSPRT",49,0)
 I $G(UNION)="Y" D  Q:EX=U
"RTN","OOPSPRT",50,0)
 . W !,"STATION NUMBER...............: ",OOPS(2260,IEN,13) D P Q:EX=U
"RTN","OOPSPRT",51,0)
 W !,"DATE/TIME OF OCCURRENCE......: ",OOPS(2260,IEN,4) D P Q:EX=U
"RTN","OOPSPRT",52,0)
 W !,"GENERAL SETTING OF INCIDENT..: ",OOPS(2260,IEN,26) D P Q:EX=U
"RTN","OOPSPRT",53,0)
 W !,"LOCATION OF INCIDENT.........: ",OOPS(2260,IEN,27) D P Q:EX=U
"RTN","OOPSPRT",54,0)
 W !,"CHARACTERIZATION OF INJURY...: ",OOPS(2260,IEN,29) D P Q:EX=U
"RTN","OOPSPRT",55,0)
 ; Patch 5 - added write
"RTN","OOPSPRT",56,0)
 W !,"MEDICAL EMERGENCY............: ",OOPS(2260,IEN,29.5) D P Q:EX=U
"RTN","OOPSPRT",57,0)
 W !,"BODY PART MOST AFFECTED......: ",OOPS(2260,IEN,30) D P Q:EX=U
"RTN","OOPSPRT",58,0)
 W !,"ADDITIONAL BODY PART AFFECTED: ",OOPS(2260,IEN,30.1) D P Q:EX=U
"RTN","OOPSPRT",59,0)
 W !,"SIDE OF BODY AFFECTED........: ",OOPS(2260,IEN,31) D P Q:EX=U
"RTN","OOPSPRT",60,0)
 W !,"DUTY RETURNED TO.............: ",OOPS(2260,IEN,32) D P Q:EX=U
"RTN","OOPSPRT",61,0)
 W !,"LOST TIME....................: ",OOPS(2260,IEN,33) D P Q:EX=U
"RTN","OOPSPRT",62,0)
 W !,"DESCRIPTION OF INCIDENT......:"
"RTN","OOPSPRT",63,0)
 S DOI=0 F  S DOI=$O(OOPS(2260,IEN,28,DOI)) Q:DOI=""  W !," ",OOPS(2260,IEN,28,DOI) D P Q:EX=U
"RTN","OOPSPRT",64,0)
 ; Patch 11 - set INCID and use rather than global hit
"RTN","OOPSPRT",65,0)
 S INCID=$P(^OOPS(2260,IEN,0),U,4)
"RTN","OOPSPRT",66,0)
 I INCID>10 D  Q:EX=U
"RTN","OOPSPRT",67,0)
 .W !,"PATIENT SOURCE...............: ",OOPS(2260,IEN,34) D P Q:EX=U
"RTN","OOPSPRT",68,0)
 I (INCID=11)!(INCID=12)!(INCID=14) D
"RTN","OOPSPRT",69,0)
 .W !,"CONTAMINATION................: ",OOPS(2260,IEN,35) D P Q:EX=U
"RTN","OOPSPRT",70,0)
 .W !,"PURPOSE OF SHARP OBJECT......: ",OOPS(2260,IEN,36) D P Q:EX=U
"RTN","OOPSPRT",71,0)
 .W !,"ACTIVITY AT TIME OF INJURY...: ",OOPS(2260,IEN,37) D P Q:EX=U
"RTN","OOPSPRT",72,0)
 .W !,"OBJECT CAUSING INJURY........: ",OOPS(2260,IEN,38) D P Q:EX=U
"RTN","OOPSPRT",73,0)
 .I OOPS(2260,IEN,83)'="" D
"RTN","OOPSPRT",74,0)
 ..W !,"DEVICE SIZE..................: ",OOPS(2260,IEN,83) D P Q:EX=U
"RTN","OOPSPRT",75,0)
 .W !,"BRAND........................: ",OOPS(2260,IEN,82) D P Q:EX=U
"RTN","OOPSPRT",76,0)
 I INCID=13 D  Q:EX=U
"RTN","OOPSPRT",77,0)
 .W !,"AREA EXPOSED TO BODILY FLUID.: "
"RTN","OOPSPRT",78,0)
 .K IND S AETBF=0 F  S AETBF=$O(OOPS(2260.039,AETBF)) Q:AETBF=""  W ?31,OOPS(2260.039,AETBF,.01),! S IND="" D P Q:EX=U
"RTN","OOPSPRT",79,0)
 .W:'$D(IND) ! W "PERSONAL PROTECTIVE EQUIPMENT: " K IND
"RTN","OOPSPRT",80,0)
 .K IND S PPE=0 F  S PPE=$O(OOPS(2260.01,PPE)) Q:PPE=""  W ?31,OOPS(2260.01,PPE,.01),! S IND="" D P Q:EX=U
"RTN","OOPSPRT",81,0)
 .W:'$D(IND) ! W "BODILY FLUID EXPOSURE SOURCE.: ",OOPS(2260,IEN,41) K IND D P Q:EX=U
"RTN","OOPSPRT",82,0)
 I INCID>10 D  Q:EX=U
"RTN","OOPSPRT",83,0)
 .; Patch 5 - added If
"RTN","OOPSPRT",84,0)
 .I OOPS(2260,IEN,42.5)="Yes" D  Q:EX=U
"RTN","OOPSPRT",85,0)
 ..W !,"EQUIPMENT/DEVICE FAILURE.....: ",OOPS(2260,IEN,42) D P Q:EX=U
"RTN","OOPSPRT",86,0)
 .W !,"SAFETY DESIGN DEVICE USED....: ",OOPS(2260,IEN,43) D P Q:EX=U
"RTN","OOPSPRT",87,0)
 .I (OOPS(2260,IEN,43)="Yes") D
"RTN","OOPSPRT",88,0)
 .. W !,"DID INJURY OCCUR BEFORE"
"RTN","OOPSPRT",89,0)
 .. W !," SAFETY DEVICE WAS ENGAGED...: ",OOPS(2260,IEN,87) D P Q:EX=U
"RTN","OOPSPRT",90,0)
 .. W !,"SAFETY CHARACTERISTICS.......: ",OOPS(2260,IEN,84) D P Q:EX=U
"RTN","OOPSPRT",91,0)
 .W:(OOPS(2260,IEN,43)="No") !,"EXPLAIN WHY SAFE DEV NOT USED: ",OOPS(2260,IEN,85) D P Q:EX=U
"RTN","OOPSPRT",92,0)
 W !,"CORRECTIVE ACTION............: "
"RTN","OOPSPRT",93,0)
 S OPFLD=47 D WP K OPFLD
"RTN","OOPSPRT",94,0)
 W !,"SAFETY OFF. COMMENTS.........: "
"RTN","OOPSPRT",95,0)
 S OPFLD=55 D WP K OPFLD
"RTN","OOPSPRT",96,0)
 W !,"PERSON ENTERING STUB RECORD..: ",OOPS(2260,IEN,56) D P Q:EX=U
"RTN","OOPSPRT",97,0)
 I $G(UNION)'="Y" W !,"/ES/SUPERVISOR...............: ",OOPS(2260,IEN,44) D P Q:EX=U
"RTN","OOPSPRT",98,0)
 W !,"SUPERVISOR SIGNATURE DATE....: ",OOPS(2260,IEN,46) D P Q:EX=U
"RTN","OOPSPRT",99,0)
 W !,"/ES/SAFETY OFFICER...........: ",OOPS(2260,IEN,48) D P Q:EX=U
"RTN","OOPSPRT",100,0)
 W !,"SAFETY OFFICER SIGNATURE DATE: ",OOPS(2260,IEN,50) D P Q:EX=U
"RTN","OOPSPRT",101,0)
 I $E(IOST,1,2)="C-" W ! K DIR S DIR(0)="E" D ^DIR W @IOF
"RTN","OOPSPRT",102,0)
KILL ;Kill Variables and Exit
"RTN","OOPSPRT",103,0)
 K %,DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","OOPSPRT",104,0)
 K CA,CACNT,CN,D0,DA,DASHES,DATE,DIC,DIQ,DIQ2,DOI,DR,EIEN,EX,FIEN,I,IE
"RTN","OOPSPRT",105,0)
 K IEN,OOPS,PG,TOI,SUP,UNION
"RTN","OOPSPRT",106,0)
 Q
"RTN","OOPSPRT",107,0)
P ;Print
"RTN","OOPSPRT",108,0)
 I ($Y'<(LIN-3)) D  Q:EX=U
"RTN","OOPSPRT",109,0)
 .I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSPRT",110,0)
 .D HDR Q
"RTN","OOPSPRT",111,0)
 Q
"RTN","OOPSPRT",112,0)
TASK ;Queue a task
"RTN","OOPSPRT",113,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE
"RTN","OOPSPRT",114,0)
 S ZTRTN="PRT^OOPSPRT",ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","OOPSPRT",115,0)
 S ZTDESC="ASISTS REPORT OF ACCIDENT"
"RTN","OOPSPRT",116,0)
 F V2=1:1 S V1=$P(OOPSLST,"^",V2) Q:V1=""  S ZTSAVE(V1)=""
"RTN","OOPSPRT",117,0)
 D ^%ZTLOAD D ^%ZISC U IO W !,"Request Queued",!
"RTN","OOPSPRT",118,0)
 K V1,V2,OOPSLST,ZTSK Q
"RTN","OOPSPRT",119,0)
WP ; Process Word Processing Fields (#47, #55)
"RTN","OOPSPRT",120,0)
 N DIWL,DIWR,DIWF,OPGLB,OPI,OPNODE,OPT,OPC
"RTN","OOPSPRT",121,0)
 K ^UTILITY($J,"W")
"RTN","OOPSPRT",122,0)
 S DIWL=1,DIWR="",DIWF="|C76"
"RTN","OOPSPRT",123,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSPRT",124,0)
 S OPI=0 F  S OPI=$O(^OOPS(2260,IEN,OPNODE,OPI)) Q:'OPI  S X=$G(^OOPS(2260,IEN,OPNODE,OPI,0)) D:X]"" ^DIWP
"RTN","OOPSPRT",125,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSPRT",126,0)
 I OPT S OPI=0 F OPC=1:1 S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI!(EX=U)  D
"RTN","OOPSPRT",127,0)
 . W !?1,^UTILITY($J,"W",1,OPI,0) D P Q:EX=U
"RTN","OOPSPRT",128,0)
 K ^UTILITY($J,"W"),X
"RTN","OOPSPRT",129,0)
 Q
"RTN","OOPSPRT",130,0)
HDR ;Header
"RTN","OOPSPRT",131,0)
 W @IOF S PG=PG+1 K DASHES S $P(DASHES,"-",80)="-"
"RTN","OOPSPRT",132,0)
 W !,"Report of Accident ",CN,?73,"Page ",PG
"RTN","OOPSPRT",133,0)
 ;W ?62,ONDATE,!,DASHES
"RTN","OOPSPRT",134,0)
 W !,DASHES
"RTN","OOPSPRT",135,0)
 Q
"RTN","OOPSPRT",136,0)
UNION ; Union Entry point
"RTN","OOPSPRT",137,0)
 S UNION="Y"
"RTN","OOPSPRT",138,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSPRT",139,0)
 S DIC("S")="I $$UNION^OOPSUTL4(Y)"
"RTN","OOPSPRT",140,0)
 G DIC
"RTN","OOPSPRT1")
0^10^B30703468
"RTN","OOPSPRT1",1,0)
OOPSPRT1 ;HINES/WAA - Utilities Routines - 3/24/98
"RTN","OOPSPRT1",2,0)
 ;;1.0;ASISTS;**2,3,5,9,11**;Jun 01, 1998
"RTN","OOPSPRT1",3,0)
 ;;
"RTN","OOPSPRT1",4,0)
 ; This routine is to display all the report that a person has
"RTN","OOPSPRT1",5,0)
 ; access to.
"RTN","OOPSPRT1",6,0)
EN1(CALLER) ;
"RTN","OOPSPRT1",7,0)
 ; Input:
"RTN","OOPSPRT1",8,0)
 ;    Caller O = Safety Officer
"RTN","OOPSPRT1",9,0)
 ;           U = Union
"RTN","OOPSPRT1",10,0)
 ;           S = Supervisor
"RTN","OOPSPRT1",11,0)
 ;           E = Employee
"RTN","OOPSPRT1",12,0)
 ; 
"RTN","OOPSPRT1",13,0)
 N YEAR,OUT,PAGE,STA,OUTPUT,SSN
"RTN","OOPSPRT1",14,0)
 ; Patch 5 - added logic to print all stations or 1
"RTN","OOPSPRT1",15,0)
 S OUT=0,PAGE=1,OUTPUT=0
"RTN","OOPSPRT1",16,0)
 S YEAR=""
"RTN","OOPSPRT1",17,0)
 I CALLER="E" D
"RTN","OOPSPRT1",18,0)
 .S SSN=$P(^VA(200,DUZ,1),U,9)
"RTN","OOPSPRT1",19,0)
 .Q:$D(^OOPS(2260,"SSN",SSN))<1
"RTN","OOPSPRT1",20,0)
 .Q
"RTN","OOPSPRT1",21,0)
 D RANGE(.YEAR,.OUT)
"RTN","OOPSPRT1",22,0)
 I 'OUT D STATION(.STA,.OUT)
"RTN","OOPSPRT1",23,0)
 D:'OUT DEVICE
"RTN","OOPSPRT1",24,0)
 I 'OUT D:'$D(IO("Q")) PRINT
"RTN","OOPSPRT1",25,0)
EXIT ;
"RTN","OOPSPRT1",26,0)
 D ^%ZISC
"RTN","OOPSPRT1",27,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","OOPSPRT1",28,0)
 K IO("Q")
"RTN","OOPSPRT1",29,0)
 Q
"RTN","OOPSPRT1",30,0)
RANGE(YEAR,OUT) ; This Subroutine will allow the user to select a range.
"RTN","OOPSPRT1",31,0)
 ; Output
"RTN","OOPSPRT1",32,0)
 ;   YEAR = The year that the user what to print
"RTN","OOPSPRT1",33,0)
 ;        = "" all years
"RTN","OOPSPRT1",34,0)
 ;
"RTN","OOPSPRT1",35,0)
 N DIR,DIRUT,Y
"RTN","OOPSPRT1",36,0)
R1 S DIR(0)="NAO^0:9999:0"
"RTN","OOPSPRT1",37,0)
 S DIR("A")="Select the Fiscal Year or RETURN for ALL: "
"RTN","OOPSPRT1",38,0)
 S DIR("??")="Enter the Fiscal Year that you want to print for or RETURN for data in file"
"RTN","OOPSPRT1",39,0)
 D ^DIR
"RTN","OOPSPRT1",40,0)
 I $D(DTOUT)!($D(DUOUT)) S OUT=1 Q
"RTN","OOPSPRT1",41,0)
 I Y'="",$L(Y)'=4 W !,"You must enter a 4 digit year." G R1
"RTN","OOPSPRT1",42,0)
 S YEAR=Y
"RTN","OOPSPRT1",43,0)
 I YEAR'="",'$O(^OOPS(2260,"B",(YEAR_"00000"))) W !,"No date for that Fiscal Year please select again." G R1
"RTN","OOPSPRT1",44,0)
 Q
"RTN","OOPSPRT1",45,0)
STATION(STA,OUT) ;
"RTN","OOPSPRT1",46,0)
 S STA=""
"RTN","OOPSPRT1",47,0)
 N DIC,DIR,DIRUT,Y
"RTN","OOPSPRT1",48,0)
 S DIR(0)="Y",DIR("A")="Run report for 'ALL' Stations",DIR("B")="Yes"
"RTN","OOPSPRT1",49,0)
 S DIR("?")="Enter 'Y'es to run for all Stations or 'N'o to run "
"RTN","OOPSPRT1",50,0)
 S DIR("?")=DIR("?")_"for just one Station."
"RTN","OOPSPRT1",51,0)
 D ^DIR I Y S STA="A" Q
"RTN","OOPSPRT1",52,0)
 I $D(DIRUT)!($D(DUOUT)) S OUT=1 Q
"RTN","OOPSPRT1",53,0)
S1 ; if get here user <CR>
"RTN","OOPSPRT1",54,0)
 S DIC("A")="Select STATION NUMBER: "
"RTN","OOPSPRT1",55,0)
 S DIC="^DIC(4,",DIC(0)="AEMQZ"
"RTN","OOPSPRT1",56,0)
 D ^DIC K DIC
"RTN","OOPSPRT1",57,0)
 I Y=-1 W !?5,"No Station selected, report will not run" S OUT=1 Q
"RTN","OOPSPRT1",58,0)
 S STA=+Y
"RTN","OOPSPRT1",59,0)
 I '$D(^OOPS(2260,"D",STA)) W !?5,"No data for that Station Number, Please select again." G S1
"RTN","OOPSPRT1",60,0)
 Q
"RTN","OOPSPRT1",61,0)
DEVICE ; This is the device selection routine.
"RTN","OOPSPRT1",62,0)
 ;
"RTN","OOPSPRT1",63,0)
 S %ZIS="QM" D ^%ZIS I POP S OUT=1 Q
"RTN","OOPSPRT1",64,0)
 I $D(IO("Q")) D  Q
"RTN","OOPSPRT1",65,0)
 .S ZTRTN="PRINT^OOPSPRT1",ZTDESC="Print Accident Report Sign-off list"
"RTN","OOPSPRT1",66,0)
 .S ZTSAVE("YEAR")="",ZTSAVE("STA")=""   ; Patch 5 - added STA
"RTN","OOPSPRT1",67,0)
 .S ZTSAVE("OUT")=""
"RTN","OOPSPRT1",68,0)
 .S ZTSAVE("CALLER")=""
"RTN","OOPSPRT1",69,0)
 .S ZTSAVE("SSN")=""
"RTN","OOPSPRT1",70,0)
 .S ZTSAVE("PAGE")=""
"RTN","OOPSPRT1",71,0)
 .S ZTSAVE("OUTPUT")=""
"RTN","OOPSPRT1",72,0)
 .D ^%ZTLOAD D HOME^%ZIS Q
"RTN","OOPSPRT1",73,0)
 .Q
"RTN","OOPSPRT1",74,0)
 Q
"RTN","OOPSPRT1",75,0)
PRINT ; This is the main print portion of the routine
"RTN","OOPSPRT1",76,0)
 N CNT,LOOP
"RTN","OOPSPRT1",77,0)
 S CNT=0
"RTN","OOPSPRT1",78,0)
 S LOOP=$S(STA="A":"",1:STA)
"RTN","OOPSPRT1",79,0)
 U IO
"RTN","OOPSPRT1",80,0)
 I STA'="A" D ONE Q
"RTN","OOPSPRT1",81,0)
MAIN ; Main Loop
"RTN","OOPSPRT1",82,0)
 F  S LOOP=$O(^OOPS(2260,"D",LOOP)) Q:LOOP=""!OUT  S HEAD=1 D:$D(^OOPS(2260,"D",LOOP)) HEAD Q:OUT  D
"RTN","OOPSPRT1",83,0)
 . S IEN=0 F  S IEN=$O(^OOPS(2260,"D",LOOP,IEN)) Q:IEN<1!OUT  D DATA
"RTN","OOPSPRT1",84,0)
 Q
"RTN","OOPSPRT1",85,0)
ONE ; Only 1 Station Selected
"RTN","OOPSPRT1",86,0)
 I $D(^OOPS(2260,"D",LOOP)) D HEAD
"RTN","OOPSPRT1",87,0)
 S IEN=0 F  S IEN=$O(^OOPS(2260,"D",LOOP,IEN)) Q:IEN<1!OUT  D DATA
"RTN","OOPSPRT1",88,0)
 Q
"RTN","OOPSPRT1",89,0)
DATA ; Loop to get & print data
"RTN","OOPSPRT1",90,0)
 N CASE,NAME,SSN1,DATE,INC,CAT,YR
"RTN","OOPSPRT1",91,0)
 S CASE=$$GET1^DIQ(2260,IEN,.01)
"RTN","OOPSPRT1",92,0)
 S YR=$E(CASE,1,4)
"RTN","OOPSPRT1",93,0)
 I YEAR,YEAR'=YR Q
"RTN","OOPSPRT1",94,0)
 ; Only get OPEN cases - field 51 - 0 = OPEN
"RTN","OOPSPRT1",95,0)
 I $$GET1^DIQ(2260,IEN,51,"I") Q
"RTN","OOPSPRT1",96,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSPRT1",97,0)
 S NAME=$E($$GET1^DIQ(2260,IEN,1,"E"),1,30)
"RTN","OOPSPRT1",98,0)
 S SSN1=$$GET1^DIQ(2260,IEN,5,"E")
"RTN","OOPSPRT1",99,0)
 S DATE=$$GET1^DIQ(2260,IEN,4,"E")
"RTN","OOPSPRT1",100,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSPRT1",101,0)
 S CNT=CNT+1
"RTN","OOPSPRT1",102,0)
 I CALLER="E" Q:SSN'=SSN1
"RTN","OOPSPRT1",103,0)
 I CALLER="S" I ($$GET1^DIQ(2260,IEN,53,"I")'=DUZ),($$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ) Q
"RTN","OOPSPRT1",104,0)
 S OUTPUT=1
"RTN","OOPSPRT1",105,0)
 D HEAD Q:OUT
"RTN","OOPSPRT1",106,0)
 W !!,CASE
"RTN","OOPSPRT1",107,0)
 W:CALLER'="U" ?12,NAME,?42,SSN1
"RTN","OOPSPRT1",108,0)
 W ?57,DATE
"RTN","OOPSPRT1",109,0)
 W !,?35,"   CA1   ",?50,"   CA2   ",?65,"  2162   "
"RTN","OOPSPRT1",110,0)
 W !,?35,"---------",?50,"---------",?65,"---------"
"RTN","OOPSPRT1",111,0)
 D          ; Employee Data
"RTN","OOPSPRT1",112,0)
 . N SIGN
"RTN","OOPSPRT1",113,0)
 . S SIGN=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSPRT1",114,0)
 . W !,?20,"EMPLOYEE:"
"RTN","OOPSPRT1",115,0)
 . I INC=1 W ?35
"RTN","OOPSPRT1",116,0)
 . I INC=2 W ?50
"RTN","OOPSPRT1",117,0)
 . ; Also, not a Non-PAID Employee either
"RTN","OOPSPRT1",118,0)
 . ; Patch 5 - logic changed for new Personnel Categories
"RTN","OOPSPRT1",119,0)
 . I '$$ISEMP^OOPSUTL4(IEN) W "N/A(",$E($$GET1^DIQ(2260,IEN,2,"E"),1,7),")" Q
"RTN","OOPSPRT1",120,0)
 . W $S($P(SIGN,U,INC):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",121,0)
 . Q
"RTN","OOPSPRT1",122,0)
 Q:CALLER="E"
"RTN","OOPSPRT1",123,0)
 D           ; Supervisor Data
"RTN","OOPSPRT1",124,0)
 . N SIGN
"RTN","OOPSPRT1",125,0)
 . S SIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSPRT1",126,0)
 . W !,?20,"SUPERVISOR:"
"RTN","OOPSPRT1",127,0)
 . I INC=1 W ?35
"RTN","OOPSPRT1",128,0)
 . I INC=2 W ?50
"RTN","OOPSPRT1",129,0)
 .;Also not a Non-Paid Employee either
"RTN","OOPSPRT1",130,0)
 .; Patch 5 - See above
"RTN","OOPSPRT1",131,0)
 . I '$$ISEMP^OOPSUTL4(IEN) W "N/A(",$E($$GET1^DIQ(2260,IEN,2,"E"),1,7),")"
"RTN","OOPSPRT1",132,0)
 . E  W $S($P(SIGN,U,INC):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",133,0)
 . W ?65,$S($P(SIGN,U,3):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",134,0)
 . Q
"RTN","OOPSPRT1",135,0)
 Q:CALLER="S"
"RTN","OOPSPRT1",136,0)
 D           ; Safety Officer Data
"RTN","OOPSPRT1",137,0)
 . N SIGN
"RTN","OOPSPRT1",138,0)
 . S SIGN=$$EDSTA^OOPSUTL1(IEN,"O")
"RTN","OOPSPRT1",139,0)
 . W !,?20,"SAFETY OFFICER:"
"RTN","OOPSPRT1",140,0)
 . W ?65,$S($P(SIGN,U):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",141,0)
 . Q
"RTN","OOPSPRT1",142,0)
 Q
"RTN","OOPSPRT1",143,0)
HEAD ; This is the head portion of the routine
"RTN","OOPSPRT1",144,0)
 I PAGE=1 D
"RTN","OOPSPRT1",145,0)
 .W:$E(IOST,1,2)="C-" @IOF
"RTN","OOPSPRT1",146,0)
 .Q
"RTN","OOPSPRT1",147,0)
 I PAGE'=1 Q:($Y<(IOSL-6)&('HEAD))
"RTN","OOPSPRT1",148,0)
 I $E(IOST,1,2)="C-" D  Q:OUT
"RTN","OOPSPRT1",149,0)
 .I PAGE=1 W @IOF Q
"RTN","OOPSPRT1",150,0)
 .I PAGE'=1 D  Q:OUT
"RTN","OOPSPRT1",151,0)
 ..N DIR S DIR(0)="E" D ^DIR I 'Y S OUT=1
"RTN","OOPSPRT1",152,0)
 ..K Y
"RTN","OOPSPRT1",153,0)
 ..Q
"RTN","OOPSPRT1",154,0)
 .Q
"RTN","OOPSPRT1",155,0)
 Q:OUT
"RTN","OOPSPRT1",156,0)
 I PAGE'=1 W @IOF
"RTN","OOPSPRT1",157,0)
 N LINER,TAB,LINE2,TAB2
"RTN","OOPSPRT1",158,0)
 W !,$$FMTE^XLFDT($$NOW^XLFDT,1),?70,"PAGE: ",PAGE,!
"RTN","OOPSPRT1",159,0)
 S LINER="Accident Report Status"_$S(YEAR="":"",1:" for the fiscal Year "_YEAR)
"RTN","OOPSPRT1",160,0)
 S TAB=(40-($L(LINER)/2))
"RTN","OOPSPRT1",161,0)
 S LINE2="Station Number: "_$$GET1^DIQ(4,LOOP,.01,"E")
"RTN","OOPSPRT1",162,0)
 S TAB2=(40-($L(LINE2)/2))
"RTN","OOPSPRT1",163,0)
 W ?TAB,LINER,!,?TAB2,LINE2
"RTN","OOPSPRT1",164,0)
 W !,"Case No."
"RTN","OOPSPRT1",165,0)
 W:CALLER'="U" ?12,"Name",?46,"SSN"
"RTN","OOPSPRT1",166,0)
 W ?57,"DATE OF INCIDENT"
"RTN","OOPSPRT1",167,0)
 W !,"============================================================================="
"RTN","OOPSPRT1",168,0)
 S PAGE=PAGE+1,HEAD=""
"RTN","OOPSPRT1",169,0)
 Q
"RTN","OOPSSUP1")
0^7^B32720571
"RTN","OOPSSUP1",1,0)
OOPSSUP1 ;HINES/WAA-S/E Supervisor Edit routine ;04/17/1998
"RTN","OOPSSUP1",2,0)
 ;;1.0;ASISTS;**1,3,5,8,11**;Jun 01, 1998
"RTN","OOPSSUP1",3,0)
 ;;
"RTN","OOPSSUP1",4,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSSUP1",5,0)
 S CALLER=$G(CALLER,"S") ; check CALLER
"RTN","OOPSSUP1",6,0)
 N SSN,IEN,EDIT,OUT,FORM,SUP,SER
"RTN","OOPSSUP1",7,0)
 S EDIT=""
"RTN","OOPSSUP1",8,0)
 S (OUT,IEN)=0
"RTN","OOPSSUP1",9,0)
 Q:DUZ<1
"RTN","OOPSSUP1",10,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSSUP1",11,0)
 D INCIDENT(CALLER) Q:IEN<1  ; Select a Employee
"RTN","OOPSSUP1",12,0)
 D ^OOPSDIS ; Display header information
"RTN","OOPSSUP1",13,0)
 D SELECT  ; Select the form to be processed.
"RTN","OOPSSUP1",14,0)
 Q:EDIT=""
"RTN","OOPSSUP1",15,0)
 D FORMS ; Process the forms that ther user selected
"RTN","OOPSSUP1",16,0)
 L -^OOPS(2260,IEN)
"RTN","OOPSSUP1",17,0)
 Q
"RTN","OOPSSUP1",18,0)
SELECT ; Select a form
"RTN","OOPSSUP1",19,0)
 ; Injury (2162,CA1)
"RTN","OOPSSUP1",20,0)
 ; Illness (2162,CA2)
"RTN","OOPSSUP1",21,0)
 ; VA form 2162
"RTN","OOPSSUP1",22,0)
 ; Get the type of incident
"RTN","OOPSSUP1",23,0)
 ; If the supporting global doesn't exist force the 
"RTN","OOPSSUP1",24,0)
 ; Supervisor to fill both the 2162 and supporting form.
"RTN","OOPSSUP1",25,0)
 N SIGN,INC,SAFE,CAT
"RTN","OOPSSUP1",26,0)
 S EDIT=""
"RTN","OOPSSUP1",27,0)
 S SIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSSUP1",28,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",29,0)
 S SAFE=+$$EDSTA^OOPSUTL1(IEN,"O")
"RTN","OOPSSUP1",30,0)
 ; Allow Non-PAID employee - CAT=6
"RTN","OOPSSUP1",31,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP1",32,0)
 ; Patch 5 - change logic for other Personnel Types
"RTN","OOPSSUP1",33,0)
 I '$$ISEMP^OOPSUTL4(IEN),'SAFE S EDIT="2162" Q  ;Person not EMP/NONPAID
"RTN","OOPSSUP1",34,0)
 I SAFE S EDIT=$P("CA1^CA2",U,INC) Q
"RTN","OOPSSUP1",35,0)
 ;  ^...The safety officer has sign and ca1 or ca2 can be edited
"RTN","OOPSSUP1",36,0)
 S INCTYP=$P("CA1^CA2",U,INC)
"RTN","OOPSSUP1",37,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC) S EDIT="2162" Q
"RTN","OOPSSUP1",38,0)
 I '$$CHECK^OOPSUTL3(IEN,INCTYP) S EDIT="2162^"_INCTYP Q
"RTN","OOPSSUP1",39,0)
 ;     No data has been entered for the ca1/2
"RTN","OOPSSUP1",40,0)
 ; ^^^ Force the Super to edit both and once.
"RTN","OOPSSUP1",41,0)
 S EDIT=""
"RTN","OOPSSUP1",42,0)
 I '$P(SIGN,U,3)
"RTN","OOPSSUP1",43,0)
 N DIR,Y
"RTN","OOPSSUP1",44,0)
 N PROMPT1,PROMPT2,SEL1,SEL2
"RTN","OOPSSUP1",45,0)
 S PROMPT1="1) VA FORM 2162 "
"RTN","OOPSSUP1",46,0)
 S PROMPT2="              2) "_$S(INC=1:"Injury (CA1",INC=2:"Illness (CA2",1:"")_")"
"RTN","OOPSSUP1",47,0)
 W !," Select form: ",PROMPT1
"RTN","OOPSSUP1",48,0)
 W !,PROMPT2
"RTN","OOPSSUP1",49,0)
 S DIR(0)="SAO^1:2162;2:"_$S(INC=1:"CA1",INC=2:"CA2",1:"")
"RTN","OOPSSUP1",50,0)
 S DIR("A")=" Select form: "
"RTN","OOPSSUP1",51,0)
 S DIR("?")=" Select the form to be edited."
"RTN","OOPSSUP1",52,0)
 D ^DIR
"RTN","OOPSSUP1",53,0)
 I '$D(Y(0)) S EDIT="" Q
"RTN","OOPSSUP1",54,0)
 S EDIT=Y(0)
"RTN","OOPSSUP1",55,0)
 K MAX,MAX1
"RTN","OOPSSUP1",56,0)
 Q
"RTN","OOPSSUP1",57,0)
INCIDENT(CALLER) ; Select a case
"RTN","OOPSSUP1",58,0)
 N DIC,X
"RTN","OOPSSUP1",59,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSSUP1",60,0)
 I CALLER="S" S DIC("S")="I $$SUP^OOPSSUP1(Y)"
"RTN","OOPSSUP1",61,0)
 I CALLER="O" S DIC("S")="I $$SAFETY^OOPSSUP1(Y)"
"RTN","OOPSSUP1",62,0)
 S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSSUP1",63,0)
 D ^DIC
"RTN","OOPSSUP1",64,0)
 Q:Y<1
"RTN","OOPSSUP1",65,0)
 Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSSUP1",66,0)
 S IEN=$P(Y,U)
"RTN","OOPSSUP1",67,0)
 Q
"RTN","OOPSSUP1",68,0)
SUP(IEN) ; Supervisor Screen
"RTN","OOPSSUP1",69,0)
 N VIEW,ISEMP
"RTN","OOPSSUP1",70,0)
 S VIEW=1
"RTN","OOPSSUP1",71,0)
 I $$GET1^DIQ(2260,IEN,51,"I") S VIEW=0 ; Case is not open
"RTN","OOPSSUP1",72,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ S VIEW=0 ; Not the Super or Alternate Super
"RTN","OOPSSUP1",73,0)
 ; Patch 5 - new $$ for determining if employee
"RTN","OOPSSUP1",74,0)
 S ISEMP=$$ISEMP^OOPSUTL4(IEN)
"RTN","OOPSSUP1",75,0)
 I 'ISEMP D  ; person is not an employee
"RTN","OOPSSUP1",76,0)
 .I +$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0 Q  ; Safety has signed
"RTN","OOPSSUP1",77,0)
 .Q
"RTN","OOPSSUP1",78,0)
 I ISEMP D  ; filters emps who have sign, sup who sign & safety who sign
"RTN","OOPSSUP1",79,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",80,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),+$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSSUP1",81,0)
 .Q
"RTN","OOPSSUP1",82,0)
 Q VIEW
"RTN","OOPSSUP1",83,0)
SAFETY(IEN) ; Safety officer screen
"RTN","OOPSSUP1",84,0)
 N VIEW,INC,ISEMP
"RTN","OOPSSUP1",85,0)
 S VIEW=1
"RTN","OOPSSUP1",86,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",87,0)
 I $$GET1^DIQ(2260,IEN,51,"I") S VIEW=0 ; Case is not open
"RTN","OOPSSUP1",88,0)
 S ISEMP=$$ISEMP^OOPSUTL4(IEN)
"RTN","OOPSSUP1",89,0)
 I 'ISEMP D       ; person is not an employee
"RTN","OOPSSUP1",90,0)
 .I +$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0 Q  ; Safety has signed
"RTN","OOPSSUP1",91,0)
 .Q
"RTN","OOPSSUP1",92,0)
 I ISEMP  D  ; This will filter emps who have sign, sup who sign and safety who sign
"RTN","OOPSSUP1",93,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),+$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSSUP1",94,0)
 .Q
"RTN","OOPSSUP1",95,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ D
"RTN","OOPSSUP1",96,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,3) S VIEW=0
"RTN","OOPSSUP1",97,0)
 .Q
"RTN","OOPSSUP1",98,0)
 Q VIEW
"RTN","OOPSSUP1",99,0)
FORMS ; Process Form
"RTN","OOPSSUP1",100,0)
 N I
"RTN","OOPSSUP1",101,0)
 ;Patch 7 - new variables used
"RTN","OOPSSUP1",102,0)
 N AIEN,AGN,ADD,CITY,STATE,ZIP,PNAME,PADD,PCITY,PSTATE,PZIP,STAT,SIEN
"RTN","OOPSSUP1",103,0)
 N FLD,PAY,RET,SAL
"RTN","OOPSSUP1",104,0)
 ; Get default fields from PAID
"RTN","OOPSSUP1",105,0)
 S FLD=28,SAL=""
"RTN","OOPSSUP1",106,0)
 S SAL=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSSUP1",107,0)
 S FLD=26,RET=""
"RTN","OOPSSUP1",108,0)
 S RET=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSSUP1",109,0)
 S RET=$S(RET="FULL CSRS":"CSRS",RET="FERS":"FERS",1:"OTHER")
"RTN","OOPSSUP1",110,0)
 S FLD=19,PAY=""
"RTN","OOPSSUP1",111,0)
 S PAY=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSSUP1",112,0)
 S PAY=$S(PAY="PER ANNUM":"ANNUAL",PAY="PER HOUR":"HOURLY","PER DIEM":"DAILY","BIWEEKLY":"BI-WEEKLY",1:"")
"RTN","OOPSSUP1",113,0)
 F I=1:1 S FORM=$P(EDIT,U,I) Q:FORM=""  D  Q:OUT
"RTN","OOPSSUP1",114,0)
 .N DR,DIE,SIGN,EDIT,I
"RTN","OOPSSUP1",115,0)
 .I ($$GET1^DIQ(2260,IEN,53,"I")=DUZ!($$GET1^DIQ(2260,IEN,53.1,"I")=DUZ)) D CLRES^OOPSUTL1(IEN,"S",FORM)
"RTN","OOPSSUP1",116,0)
 .I FORM="2162" D ASIST^OOPSSUP3 Q:OUT
"RTN","OOPSSUP1",117,0)
 .I FORM="CA1" D CA1^OOPSSUPB Q:OUT
"RTN","OOPSSUP1",118,0)
 .I FORM="CA2" D CA2^OOPSSUP2 Q:OUT
"RTN","OOPSSUP1",119,0)
 .S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSSUP1",120,0)
 .L +^OOPS(2260,IEN):2
"RTN","OOPSSUP1",121,0)
 .E  W !!?5,"Another user is editing this entry. Try later." S OUT=1 Q
"RTN","OOPSSUP1",122,0)
 .D ^DIE
"RTN","OOPSSUP1",123,0)
 .I ($D(Y)'=0)!($G(DIRUT)=1)  S OUT=1 Q  ; Quit if user exits
"RTN","OOPSSUP1",124,0)
 .I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ Q
"RTN","OOPSSUP1",125,0)
 .D SIGNS(FORM) ; Sign/validate Document
"RTN","OOPSSUP1",126,0)
 .Q:'$P(SIGN,U)   ; Quit if user doesn't sign
"RTN","OOPSSUP1",127,0)
 .D FILE ; User Signs and files
"RTN","OOPSSUP1",128,0)
 .Q
"RTN","OOPSSUP1",129,0)
 Q
"RTN","OOPSSUP1",130,0)
SIGNS(FORM) ; Sign/validate Document
"RTN","OOPSSUP1",131,0)
 N EMP,INC,VALID
"RTN","OOPSSUP1",132,0)
 S VALID=0,SIGN=""
"RTN","OOPSSUP1",133,0)
 S EMP=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSSUP1",134,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",135,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,"S",.VALID)
"RTN","OOPSSUP1",136,0)
 I FORM'="2162",'$P(EMP,U,INC) D  Q  ;Employee has not signed yet
"RTN","OOPSSUP1",137,0)
 .W !,?10,"The employee has not signed the ",FORM,"." Q
"RTN","OOPSSUP1",138,0)
 .Q
"RTN","OOPSSUP1",139,0)
 I 'VALID Q
"RTN","OOPSSUP1",140,0)
 S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSSUP1",141,0)
 Q
"RTN","OOPSSUP1",142,0)
FILE ;File the ES and send a bull
"RTN","OOPSSUP1",143,0)
 I FORM="2162" S $P(^OOPS(2260,IEN,"2162ES"),U,1,3)=SIGN D SAFETY^OOPSMBUL(IEN)
"RTN","OOPSSUP1",144,0)
 I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,4,6)=SIGN D SUPS^OOPSMBUL(IEN),UNION^OOPSMBUL(IEN)
"RTN","OOPSSUP1",145,0)
 I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,4,6)=SIGN D SUPS^OOPSMBUL(IEN),UNION^OOPSMBUL(IEN)
"RTN","OOPSSUP1",146,0)
 Q
"RTN","OOPSSUP3")
0^1^B13871412
"RTN","OOPSSUP3",1,0)
OOPSSUP3 ;HINES/WAA - S/E Supervisor Edit routine 2162 [ 04/15/1998  1:25 PM ]
"RTN","OOPSSUP3",2,0)
 ;;1.0;ASISTS;**3,5,11**;Jun 01, 1998
"RTN","OOPSSUP3",3,0)
 ;;
"RTN","OOPSSUP3",4,0)
ASIST ;  2162 FORM
"RTN","OOPSSUP3",5,0)
 N INCID,SUP,CAT,OBJ,IEN200
"RTN","OOPSSUP3",6,0)
 S INCID=$$GET1^DIQ(2260,IEN,3,"I")
"RTN","OOPSSUP3",7,0)
 S:INCID'="" INCID=$$GET1^DIQ(2261.2,INCID,.01,"E") ; Getting the type of incident
"RTN","OOPSSUP3",8,0)
 S INCID=U_INCID_U
"RTN","OOPSSUP3",9,0)
 ; Allow edit of supervisor, secondary supervisor
"RTN","OOPSSUP3",10,0)
 ; Also, include logic for Non-PAID employee
"RTN","OOPSSUP3",11,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP3",12,0)
 ; Patch 5 - added logic for employee CAT >6
"RTN","OOPSSUP3",13,0)
 S SUP=$S((CAT=1!(CAT>6)):" SUPERVISOR...............",CAT=2:" VOLUNTARY SVC SUPERVISOR.",CAT=3:" CONTRACT ADMINISTRATOR...",1:" SAFETY OFFICER...........")
"RTN","OOPSSUP3",14,0)
 ; Patch 11 - get service, renumber DR array, add new prompts
"RTN","OOPSSUP3",15,0)
 S IEN200=$$GET1^DIQ(2260,IEN,5,"I"),SER=""
"RTN","OOPSSUP3",16,0)
 I $G(IEN200)'="" S IEN200=$O(^VA(200,"SSN",IEN200,""))
"RTN","OOPSSUP3",17,0)
 I $G(IEN200)'="" S SER=$$GET1^DIQ(200,IEN200,29,"I")
"RTN","OOPSSUP3",18,0)
 S DR=""
"RTN","OOPSSUP3",19,0)
 S DR(1,2260,1)="86////^S X=SER"
"RTN","OOPSSUP3",20,0)
 S DR(1,2260,2)="53"_SUP
"RTN","OOPSSUP3",21,0)
 S DR(1,2260,5)="53.1 SECONDARY SUPERVISOR....."
"RTN","OOPSSUP3",22,0)
 S DR(1,2260,10)="26 GENERAL SETTING OF INCIDENT........;S X=X;"
"RTN","OOPSSUP3",23,0)
 S DR(1,2260,15)="27 LOCATION OF INJURY.................;S X=X;D CARE2^OOPSUTL2(IEN);"
"RTN","OOPSSUP3",24,0)
 S DR(1,2260,20)="28 DESCRIPTION OF INCIDENT............"
"RTN","OOPSSUP3",25,0)
 ; Patch 5 - added line below
"RTN","OOPSSUP3",26,0)
 S DR(1,2260,25)="29.5 HOW IS INCIDENT RELATED TO MEDICAL EMERGENCY"
"RTN","OOPSSUP3",27,0)
 S DR(1,2260,30)="29 CHARACTERIZATION OF INJURY........."
"RTN","OOPSSUP3",28,0)
 S DR(1,2260,35)="30 BODY PART MOST AFFECTED............"
"RTN","OOPSSUP3",29,0)
 S DR(1,2260,40)="30.1 ADDITIONAL BODY PART AFFECTED......"
"RTN","OOPSSUP3",30,0)
 S DR(1,2260,45)="31 SIDE OF BODY AFFECTED..............;S X=X;"
"RTN","OOPSSUP3",31,0)
SHARPS ; SHARPS DATA
"RTN","OOPSSUP3",32,0)
 ; Patch 5 - added Suture Needlestick
"RTN","OOPSSUP3",33,0)
 I "^Sharps Exposure^Hollow Bore Needlestick^Suture Needlestick^"'[INCID G FLUID
"RTN","OOPSSUP3",34,0)
 S DR(1,2260,50)="34 PATIENT SOURCE....................."
"RTN","OOPSSUP3",35,0)
 S DR(1,2260,55)="35 CONTAMINATION......................"
"RTN","OOPSSUP3",36,0)
 S DR(1,2260,60)="36 PURPOSE OF SHARP OBJECT..........."
"RTN","OOPSSUP3",37,0)
 S DR(1,2260,65)="37 ACTIVITY AT TIME OF INJURY........"
"RTN","OOPSSUP3",38,0)
 S DR(1,2260,70)="38 OBJECT CAUSING INJURY.............;S X=X;"
"RTN","OOPSSUP3",39,0)
 S DR(1,2260,80)="S OBJ=$$GET1^DIQ(2260,IEN,""38:2"",""I"")"
"RTN","OOPSSUP3",40,0)
 S DR(1,2260,85)="I OBJ'=""N"" S Y=""@1"""
"RTN","OOPSSUP3",41,0)
 S DR(1,2260,90)="83 DEVICE SIZE......................."
"RTN","OOPSSUP3",42,0)
 S DR(1,2260,95)="S Y=""@2"""
"RTN","OOPSSUP3",43,0)
 S DR(1,2260,100)="@1"
"RTN","OOPSSUP3",44,0)
 S DR(1,2260,105)="83////@"               ; delete if OBJ'="N" or "S"
"RTN","OOPSSUP3",45,0)
 S DR(1,2260,110)="@2"
"RTN","OOPSSUP3",46,0)
 S DR(1,2260,115)="82 BRAND............................."
"RTN","OOPSSUP3",47,0)
 G ALL
"RTN","OOPSSUP3",48,0)
FLUID ; Body Fluid Exposer
"RTN","OOPSSUP3",49,0)
 I "^Exposure to Body Fluids/Splash^"'[INCID G EVERY
"RTN","OOPSSUP3",50,0)
 S DR(1,2260,115)="34 PATIENT SOURCE....................."
"RTN","OOPSSUP3",51,0)
 S DR(1,2260,120)="39"                  ; Multiple, DD prompt used - P5
"RTN","OOPSSUP3",52,0)
 S DR(1,2260,125)="40"                  ; Multiple, DD prompt used - P5
"RTN","OOPSSUP3",53,0)
 S DR(1,2260,130)="41 BODILY FLUID EXPOSURE SOURCE......."
"RTN","OOPSSUP3",54,0)
ALL ; ALL TYPE OF EXPOSURES
"RTN","OOPSSUP3",55,0)
 ; Patch 5 - Changed logic
"RTN","OOPSSUP3",56,0)
 S FAIL=$$GET1^DIQ(2260,IEN,42.5,"E") I FAIL="" S FAIL="No"
"RTN","OOPSSUP3",57,0)
 S DR(1,2260,135)="42.5 WAS THERE AN EQUIPMENT/DEVICE/PRODUCT FAILURE//^S X=FAIL;I X=""N"" S Y=""@3"""
"RTN","OOPSSUP3",58,0)
 S DR(1,2260,140)="42 DESCRIBE EQUIPMENT/DEVICE/PRODUCT FAILURE.."
"RTN","OOPSSUP3",59,0)
 S DR(1,2260,145)="S Y=43"
"RTN","OOPSSUP3",60,0)
 S DR(1,2260,150)="@3"
"RTN","OOPSSUP3",61,0)
 S DR(1,2260,155)="42////@"
"RTN","OOPSSUP3",62,0)
 S DR(1,2260,160)="43 SAFETY DESIGN DEVICE USED....;S X=X;"
"RTN","OOPSSUP3",63,0)
 ; started adding for patch 11
"RTN","OOPSSUP3",64,0)
 S DR(1,2260,165)="S Y=$S(X=""Y"":""@4"",X=""N"":""@5"",1:""@6"")"
"RTN","OOPSSUP3",65,0)
 S DR(1,2260,170)="@4"
"RTN","OOPSSUP3",66,0)
 S DR(1,2260,172)="85////@"
"RTN","OOPSSUP3",67,0)
 S DR(1,2260,175)="87 DID THE INJURY OCCUR BEFORE THE SAFETY DEVICE WAS ENGAGED.."
"RTN","OOPSSUP3",68,0)
 S DR(1,2260,180)="84 SAFETY CHARACTERISTICS......."
"RTN","OOPSSUP3",69,0)
 S DR(1,2260,185)="S Y=""@6"""
"RTN","OOPSSUP3",70,0)
 S DR(1,2260,190)="@5"
"RTN","OOPSSUP3",71,0)
 S DR(1,2260,195)="84////@"
"RTN","OOPSSUP3",72,0)
 S DR(1,2260,197)="87////@"
"RTN","OOPSSUP3",73,0)
 S DR(1,2260,200)="85 EXPLAIN WHY A SAFETY DEVICE WAS NOT USED..."
"RTN","OOPSSUP3",74,0)
 S DR(1,2260,205)="@6"
"RTN","OOPSSUP3",75,0)
EVERY ; All Employees
"RTN","OOPSSUP3",76,0)
 ; Include CAT=6 Non-PAID employee as employee
"RTN","OOPSSUP3",77,0)
 I $$ISEMP^OOPSUTL4(IEN) D
"RTN","OOPSSUP3",78,0)
 .S DR(1,2260,210)="32 DUTY RETURNED TO..................."
"RTN","OOPSSUP3",79,0)
 .S DR(1,2260,215)="33 LOST TIME..........................;S X=X;"
"RTN","OOPSSUP3",80,0)
 .Q
"RTN","OOPSSUP3",81,0)
 S DR(1,2260,220)="47 CORRECTIVE ACTION............"
"RTN","OOPSSUP3",82,0)
 Q
"RTN","OOPSUTL1")
0^26^B39699852
"RTN","OOPSUTL1",1,0)
OOPSUTL1 ;HINES/WAA-Utilities Routines ;3/24/98
"RTN","OOPSUTL1",2,0)
 ;;1.0;ASISTS;**8,11**;Jun 01, 1998
"RTN","OOPSUTL1",3,0)
 ;;
"RTN","OOPSUTL1",4,0)
EMP(IEN,SSN,OPEN) ; DIC filter for Employee enter edit
"RTN","OOPSUTL1",5,0)
 ;This is a screening routine that will filter
"RTN","OOPSUTL1",6,0)
 ;  out thos entries that the user cannot see.
"RTN","OOPSUTL1",7,0)
 ; Input:
"RTN","OOPSUTL1",8,0)
 ;  IEN  is the internal entry number for the entry in 2260.
"RTN","OOPSUTL1",9,0)
 ;  SSN is the Employee Number in file 200
"RTN","OOPSUTL1",10,0)
 ;=========================================
"RTN","OOPSUTL1",11,0)
 ;  VIEW is an indicator telling if the user can enter/edit
"RTN","OOPSUTL1",12,0)
 ;       this entry
"RTN","OOPSUTL1",13,0)
 ;
"RTN","OOPSUTL1",14,0)
 N VIEW
"RTN","OOPSUTL1",15,0)
 S VIEW=0
"RTN","OOPSUTL1",16,0)
 S OPEN=$G(OPEN,0)
"RTN","OOPSUTL1",17,0)
 I $$OPEN(IEN,OPEN) D  ;Record
"RTN","OOPSUTL1",18,0)
 .I $$GET1^DIQ(2260,IEN,5,"I")=SSN D  ; Is this record for this employee
"RTN","OOPSUTL1",19,0)
 ..N SIG,INC
"RTN","OOPSUTL1",20,0)
 ..S SIG=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSUTL1",21,0)
 ..S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSUTL1",22,0)
 ..I '$P(SIG,U,INC) S VIEW=1 ; Super has not signed
"RTN","OOPSUTL1",23,0)
 ..I $$GET1^DIQ(2260,IEN,67)'="" S VIEW=0  ; Patch 8, no edit if to DOL
"RTN","OOPSUTL1",24,0)
 .Q
"RTN","OOPSUTL1",25,0)
 Q VIEW
"RTN","OOPSUTL1",26,0)
WS ; The following 4 subroutines are added with Patch 8 - DOL project
"RTN","OOPSUTL1",27,0)
 ; Sets the "W" xref. A routine call is used to prevent the inadvertant
"RTN","OOPSUTL1",28,0)
 ; re-indexing of xref.  Xref is used for determining which records
"RTN","OOPSUTL1",29,0)
 ; should be included in transmission of claims to DOL.  When the record
"RTN","OOPSUTL1",30,0)
 ; is placed in a Mailman message (WC xref set) this xref is killed.
"RTN","OOPSUTL1",31,0)
 ; Variables
"RTN","OOPSUTL1",32,0)
 ;           WOK = set in OOPSWCE, used to prevent inadvertant
"RTN","OOPSUTL1",33,0)
 ;                 re-indexing of ^OOPS(2260,"AW",X,IEN)
"RTN","OOPSUTL1",34,0)
 ;           IEN = uses IEN for DA of file 2260
"RTN","OOPSUTL1",35,0)
 ;           X   = field 67 (DUZ)
"RTN","OOPSUTL1",36,0)
 I '$D(WOK) Q
"RTN","OOPSUTL1",37,0)
 I '$D(IEN) D  Q
"RTN","OOPSUTL1",38,0)
 . S MSG("DIHELP",1)="Required Cross Reference (""AW"") was not set up, call your IRM."
"RTN","OOPSUTL1",39,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSUTL1",40,0)
 S ^OOPS(2260,"AW",X,IEN)=""
"RTN","OOPSUTL1",41,0)
 Q
"RTN","OOPSUTL1",42,0)
WK ; Kills the "AW" xref.  See above as reason for manually setting
"RTN","OOPSUTL1",43,0)
 ;           WOK = set in OOPSWCE, used to prevent inadvertant reindex
"RTN","OOPSUTL1",44,0)
 ;           IEN = uses IEN for DA of file 2260
"RTN","OOPSUTL1",45,0)
 ;           X   = field 67, file 2260 = DUZ
"RTN","OOPSUTL1",46,0)
 I '$D(WOK) Q
"RTN","OOPSUTL1",47,0)
 I '$D(IEN) D  Q
"RTN","OOPSUTL1",48,0)
 . S MSG("DIHELP",1)="Required Cross Reference (""AW"") was not properly destroyed, call your IRM."
"RTN","OOPSUTL1",49,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSUTL1",50,0)
 K ^OOPS(2260,"AW",X,IEN)
"RTN","OOPSUTL1",51,0)
 Q
"RTN","OOPSUTL1",52,0)
WCS ; Sets the "AWC" xref. A routine call is used to prevent inadvertant
"RTN","OOPSUTL1",53,0)
 ; re-indexing of the xref.  Xref is used for determining which records
"RTN","OOPSUTL1",54,0)
 ; were included in Mailman messages that transmited claims to DOL
"RTN","OOPSUTL1",55,0)
 ; Variables
"RTN","OOPSUTL1",56,0)
 ;           WOK = set in OOPSWCE, used to prevent inadvertant
"RTN","OOPSUTL1",57,0)
 ;                 re-indexing of ^OOPS(2260,"AW",DUZ,IEN)
"RTN","OOPSUTL1",58,0)
 ;           IEN = record ID file 2260
"RTN","OOPSUTL1",59,0)
 ;           X   = field 66 - Date Transmited to DOL
"RTN","OOPSUTL1",60,0)
 N WCDUZ
"RTN","OOPSUTL1",61,0)
 I '$D(WOK) Q
"RTN","OOPSUTL1",62,0)
 I '$D(IEN) D  Q
"RTN","OOPSUTL1",63,0)
 . S MSG("DIHELP",1)="Required Cross Reference (""AWC"") was not set up, call your IRM."
"RTN","OOPSUTL1",64,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSUTL1",65,0)
 S ^OOPS(2260,"AWC",X,IEN)=""
"RTN","OOPSUTL1",66,0)
 S WCDUZ=$P($G(^OOPS(2260,IEN,"WCES")),U)
"RTN","OOPSUTL1",67,0)
 K ^OOPS(2260,"AW",WCDUZ,IEN)
"RTN","OOPSUTL1",68,0)
 Q
"RTN","OOPSUTL1",69,0)
WCK ; Kills the "AWC" xref.  See above as reason for manually setting
"RTN","OOPSUTL1",70,0)
 ;           WOK = set in OOPSWCE, used to prevent inadvertant reindex
"RTN","OOPSUTL1",71,0)
 ;           IEN = uses IEN for DA of file 2260
"RTN","OOPSUTL1",72,0)
 ;           X   = field 66 - Date Transmited to DOL
"RTN","OOPSUTL1",73,0)
 I '$D(WOK) Q
"RTN","OOPSUTL1",74,0)
 I '$D(IEN) D  Q
"RTN","OOPSUTL1",75,0)
 . S MSG("DIHELP",1)="Required Cross Reference (""AWC"") was not properly destroyed, call your IRM."
"RTN","OOPSUTL1",76,0)
 . D MSG^DIALOG("WH","","","","MSG")
"RTN","OOPSUTL1",77,0)
 K ^OOPS(2260,"AWC",X,IEN)
"RTN","OOPSUTL1",78,0)
 Q
"RTN","OOPSUTL1",79,0)
OPEN(IEN,OPEN) ; Determin if record is open
"RTN","OOPSUTL1",80,0)
 N VIEW
"RTN","OOPSUTL1",81,0)
 S OPEN=$G(OPEN,0)
"RTN","OOPSUTL1",82,0)
 S VIEW=0
"RTN","OOPSUTL1",83,0)
 I $G(^OOPS(2260,IEN,0))="" Q VIEW
"RTN","OOPSUTL1",84,0)
 I 'OPEN,'$P(^OOPS(2260,IEN,0),U,6) S VIEW=1
"RTN","OOPSUTL1",85,0)
 I OPEN,$P(^OOPS(2260,IEN,0),U,6)'=2 S VIEW=1
"RTN","OOPSUTL1",86,0)
 Q VIEW
"RTN","OOPSUTL1",87,0)
EDSTA(IEN,CALLER) ; Gives the status of form to allows the user to
"RTN","OOPSUTL1",88,0)
 ;Inputs:
"RTN","OOPSUTL1",89,0)
 ; IEN is the internal entry number for the entry in 2260.
"RTN","OOPSUTL1",90,0)
 ; CALLER is the type of user who is calling the routine.
"RTN","OOPSUTL1",91,0)
 ;   "E" = EMPLOYEE
"RTN","OOPSUTL1",92,0)
 ;   "S" = SUPERVISOR
"RTN","OOPSUTL1",93,0)
 ;   "O" = SAFETY
"RTN","OOPSUTL1",94,0)
 ;   "V" = VOLUNTEER
"RTN","OOPSUTL1",95,0)
 ;
"RTN","OOPSUTL1",96,0)
 ;   ======================================
"RTN","OOPSUTL1",97,0)
 ;Outputs
"RTN","OOPSUTL1",98,0)
 ;   If the Caller is Employee:
"RTN","OOPSUTL1",99,0)
 ;   SELECT=1^1 Both FORMS have been signed
"RTN","OOPSUTL1",100,0)
 ;          0^0 Neither form has been signed
"RTN","OOPSUTL1",101,0)
 ;          1^0 CA1 has been signed
"RTN","OOPSUTL1",102,0)
 ;          0^1 CA2 has been signed
"RTN","OOPSUTL1",103,0)
 ;   If caller is Supervisor:
"RTN","OOPSUTL1",104,0)
 ;   SELECT=1^1^1 all FORMS have been signed
"RTN","OOPSUTL1",105,0)
 ;          0^0^0 no form has been signed
"RTN","OOPSUTL1",106,0)
 ;          1^0^0 CA1 has been signed
"RTN","OOPSUTL1",107,0)
 ;          0^1^0 CA2 has been signed
"RTN","OOPSUTL1",108,0)
 ;          0^0^1 2162 has been signed
"RTN","OOPSUTL1",109,0)
 ;   If caller is Safety Officer
"RTN","OOPSUTL1",110,0)
 ;   SELECT=1 File has been signed
"RTN","OOPSUTL1",111,0)
 ;          0 File has not been signed
"RTN","OOPSUTL1",112,0)
 ;   If caller is Volunteer Supervisor
"RTN","OOPSUTL1",113,0)
 ;   SELECT=1 File has been signed
"RTN","OOPSUTL1",114,0)
 ;          0 File has not been signed
"RTN","OOPSUTL1",115,0)
 N SELECT,CA1,CA2,ACCD
"RTN","OOPSUTL1",116,0)
 S SELECT=""
"RTN","OOPSUTL1",117,0)
 I CALLER="S" D
"RTN","OOPSUTL1",118,0)
 .N LINE
"RTN","OOPSUTL1",119,0)
 .S LINE=""
"RTN","OOPSUTL1",120,0)
 .F I=170,266,45 D
"RTN","OOPSUTL1",121,0)
 ..S LINE=LINE_$S($$GET1^DIQ(2260,IEN,I,"I")'="":1,1:0)_U
"RTN","OOPSUTL1",122,0)
 ..Q
"RTN","OOPSUTL1",123,0)
 .S SELECT=$P(LINE,U,1,3)
"RTN","OOPSUTL1",124,0)
 .Q
"RTN","OOPSUTL1",125,0)
 I CALLER="E" S SELECT=$S($$GET1^DIQ(2260,IEN,120,"I")'="":1,1:0)_U_$S($$GET1^DIQ(2260,IEN,222,"I")'="":1,1:0)
"RTN","OOPSUTL1",126,0)
 I CALLER="O" S SELECT=$S($$GET1^DIQ(2260,IEN,49,"I")'="":1,1:0)_U
"RTN","OOPSUTL1",127,0)
 Q SELECT
"RTN","OOPSUTL1",128,0)
 ;
"RTN","OOPSUTL1",129,0)
EDSEL(IEN,CALLER) ; Allow you to select the form part to edit
"RTN","OOPSUTL1",130,0)
 ;
"RTN","OOPSUTL1",131,0)
 ;
"RTN","OOPSUTL1",132,0)
 ; IEN is the internal entry number for the entry in 2260.
"RTN","OOPSUTL1",133,0)
 ; CALLER is the type of user who is calling the routine.
"RTN","OOPSUTL1",134,0)
 ;   "E" = EMPLOYEE
"RTN","OOPSUTL1",135,0)
 ;   "S" = SUPERVISOR
"RTN","OOPSUTL1",136,0)
 ;   "O" = SAFETY OFFICER
"RTN","OOPSUTL1",137,0)
 ; 
"RTN","OOPSUTL1",138,0)
 ;
"RTN","OOPSUTL1",139,0)
 N SELECT,EEFORM,CNT,Y,SEC
"RTN","OOPSUTL1",140,0)
 S CNT=0
"RTN","OOPSUTL1",141,0)
 S SELECT="",SEC="0^0",FORM=""
"RTN","OOPSUTL1",142,0)
 S EEFORM=$$EDSTA(IEN,CALLER)
"RTN","OOPSUTL1",143,0)
 I CALLER="E" S SEC=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSUTL1",144,0)
 W @IOF,!!,?10,"Select Forms: "
"RTN","OOPSUTL1",145,0)
 I CALLER="S" S CNT=CNT+1 W !,?20,CNT,") Form 2162" S FORM=FORM_"2162^"
"RTN","OOPSUTL1",146,0)
 I '$P(SEC,U,1) S CNT=CNT+1 W !,?20,CNT,") ",$S($P(EEFORM,U)=1:"Edit",1:"Enter")," form CA1 (Injury)" S FORM=FORM_"CA1^"
"RTN","OOPSUTL1",147,0)
 I '$P(SEC,U,2) S CNT=CNT+1 W !,?20,CNT,") ",$S($P(EEFORM,U,2)=1:"Edit",1:"Enter")," form CA2 (Illness)" S FORM=FORM_"CA2^"
"RTN","OOPSUTL1",148,0)
 I CNT=1 S Y="1,"
"RTN","OOPSUTL1",149,0)
 E  D
"RTN","OOPSUTL1",150,0)
 .W !!!
"RTN","OOPSUTL1",151,0)
 .N DIR
"RTN","OOPSUTL1",152,0)
 .S DIR("A")=" Select Forms"
"RTN","OOPSUTL1",153,0)
 .S DIR(0)="L^1:"_CNT
"RTN","OOPSUTL1",154,0)
 .D ^DIR
"RTN","OOPSUTL1",155,0)
 I +Y F I=1:1 Q:$P(Y,",",I)<1  S SELECT=SELECT_$P(FORM,U,$P(Y,",",I))_"^"
"RTN","OOPSUTL1",156,0)
 Q SELECT
"RTN","OOPSUTL1",157,0)
CLRES(IEN,CALLER,FORM) ; Clean out electronic SIG
"RTN","OOPSUTL1",158,0)
 ;Input
"RTN","OOPSUTL1",159,0)
 ;   IEN = Internal Entry Number from file 2260
"RTN","OOPSUTL1",160,0)
 ;   CALLER is the type of user who is calling the routine.
"RTN","OOPSUTL1",161,0)
 ;     "E" = EMPLOYEE
"RTN","OOPSUTL1",162,0)
 ;     "S" = SUPERVISOR
"RTN","OOPSUTL1",163,0)
 ;     "O" = SAFETY OFFICER
"RTN","OOPSUTL1",164,0)
 ;     "W" = WORKER'S COMP OFFICIAL
"RTN","OOPSUTL1",165,0)
 ;   FORM Is the form to clear out ES
"RTN","OOPSUTL1",166,0)
 ;     Safty Officer = 2162
"RTN","OOPSUTL1",167,0)
 ;     Supervisor = CA1,CA2 and 2162
"RTN","OOPSUTL1",168,0)
 ;     Employee = CA1 and CA2
"RTN","OOPSUTL1",169,0)
 ;     Workers Comp = CA1 and CA2
"RTN","OOPSUTL1",170,0)
 ;
"RTN","OOPSUTL1",171,0)
 ;   DOL = 1 if call from ^OOPSUTL6 to suppress printing cleared msg. 
"RTN","OOPSUTL1",172,0)
 ;
"RTN","OOPSUTL1",173,0)
 N SIG,NODE,FIELD,FLG,CALL
"RTN","OOPSUTL1",174,0)
 Q:FORM=""
"RTN","OOPSUTL1",175,0)
 S FLG=""
"RTN","OOPSUTL1",176,0)
 I CALLER="W" S SIG="WCES;1,3"
"RTN","OOPSUTL1",177,0)
 I CALLER="O" S SIG=$S(FORM="2162":"2162ES;4,6",1:"")
"RTN","OOPSUTL1",178,0)
 S:CALLER="S" SIG=$S(FORM="CA1":"CA1ES;4,6",FORM="CA2":"CA2ES;4,6",FORM="2162":"2162ES;1,3",1:"")
"RTN","OOPSUTL1",179,0)
 S:CALLER="E" SIG=$S(FORM="CA1":"CA1ES;1,3",FORM="CA2":"CA2ES;1,3",1:"")
"RTN","OOPSUTL1",180,0)
 Q:SIG=""
"RTN","OOPSUTL1",181,0)
 S NODE=$P(SIG,";") Q:NODE=""
"RTN","OOPSUTL1",182,0)
 S FIELD=$P(SIG,";",2)
"RTN","OOPSUTL1",183,0)
 S CALL=$S(CALLER="W":2,CALLER="O":1,CALLER="S":1,CALLER="E":2,1:"")
"RTN","OOPSUTL1",184,0)
 I 'CALL Q
"RTN","OOPSUTL1",185,0)
 I '$D(^OOPS(2260,IEN,NODE)) Q
"RTN","OOPSUTL1",186,0)
 I CALL=1,$P(^OOPS(2260,IEN,NODE),U,5)'="" S FLG=1
"RTN","OOPSUTL1",187,0)
 I CALL=2,$P(^OOPS(2260,IEN,NODE),U,2)'="" S FLG=1
"RTN","OOPSUTL1",188,0)
 F I=$P(FIELD,","):1:$P(FIELD,",",2) S $P(^OOPS(2260,IEN,NODE),U,I)=""
"RTN","OOPSUTL1",189,0)
 I FLG&('$G(DOL)) D
"RTN","OOPSUTL1",190,0)
 . W !!,"Your ES has been cleared.  You will need to resign.",!
"RTN","OOPSUTL1",191,0)
 . ;PATCH 11 CLEAR DATE SENT TO NDB IF SAFETY SIGNATURE REMOVED
"RTN","OOPSUTL1",192,0)
 . I CALLER="O" S $P(^OOPS(2260,IEN,0),U,11)=""
"RTN","OOPSUTL1",193,0)
 ; Security on ES - late in patch 8
"RTN","OOPSUTL1",194,0)
 I CALLER="E"&('$G(DOL)) D
"RTN","OOPSUTL1",195,0)
 . N RECORD
"RTN","OOPSUTL1",196,0)
 . S RECORD=^OOPS(2260,IEN,"CA")
"RTN","OOPSUTL1",197,0)
 . S $P(RECORD,U,7)="",$P(RECORD,U,9)="",^OOPS(2260,IEN,"CA")=RECORD
"RTN","OOPSUTL1",198,0)
 Q
"RTN","OOPSUTL1",199,0)
PAID(IEN,FLD) ; Get the data value from the PAID file (#450), if employee
"RTN","OOPSUTL1",200,0)
 ;   Input - IEN     internal entry number of case in file 2260
"RTN","OOPSUTL1",201,0)
 ;         - FLD     the PAID field number to retrieve
"RTN","OOPSUTL1",202,0)
 ;         - NAME    Name of Person Involved, used to get PAID IEN
"RTN","OOPSUTL1",203,0)
 ;         - VAL     Data value from the PAID #450, field #FLD
"RTN","OOPSUTL1",204,0)
 ;  Output - DESC    Descripton from Paid, if there
"RTN","OOPSUTL1",205,0)
 ;
"RTN","OOPSUTL1",206,0)
 N DA,DR,NAME,VAL,OOPS,DESC,SUB454,X,Y
"RTN","OOPSUTL1",207,0)
 S DESC=""
"RTN","OOPSUTL1",208,0)
 S NAME=$$GET1^DIQ(2260,IEN,1)
"RTN","OOPSUTL1",209,0)
 N DIC S DIC="^PRSPC(",DIC(0)="Z",X=NAME D ^DIC
"RTN","OOPSUTL1",210,0)
 I Y>0 D
"RTN","OOPSUTL1",211,0)
 . N DIC
"RTN","OOPSUTL1",212,0)
 . K DIQ S DIC="^PRSPC(",DR=FLD,DA=+Y,DIQ="OOPS",DIQ(0)="IE"
"RTN","OOPSUTL1",213,0)
 . D EN^DIQ1 K DIQ
"RTN","OOPSUTL1",214,0)
 . S Y="",VAL=OOPS(450,DA,FLD,"I"),Y=VAL
"RTN","OOPSUTL1",215,0)
 . I FLD=28 S DESC=Y
"RTN","OOPSUTL1",216,0)
 . I FLD=16 D OST^PRSDUTIL S DESC=Y
"RTN","OOPSUTL1",217,0)
 . S SUB454=$S(FLD=19:"PB",FLD=20:"PP",FLD=26:"RET",1:"")
"RTN","OOPSUTL1",218,0)
 . I $G(SUB454)'="" D OT^PRSDUTIL S DESC=Y
"RTN","OOPSUTL1",219,0)
 K DIQ
"RTN","OOPSUTL1",220,0)
 Q DESC
"RTN","OOPSUTL1",221,0)
PAYP(PAY) ; Map PAID Pay Plan to higher category for DOL project
"RTN","OOPSUTL1",222,0)
 ;
"RTN","OOPSUTL1",223,0)
 ;   Input   - PLAN    This is the PAID Pay Plan Description
"RTN","OOPSUTL1",224,0)
 ;                     from file 454, not the PAID Code
"RTN","OOPSUTL1",225,0)
 ;  Output   - PPLAN   Pay Plan that PAID Code maps to
"RTN","OOPSUTL1",226,0)
 ;
"RTN","OOPSUTL1",227,0)
 N PPLAN
"RTN","OOPSUTL1",228,0)
 S PPLAN=$S($E(PAY)="G":"GS",$E(PAY)="W":"WG",$E(PAY)="N":"WG",$E(PAY)="V":PAY,PAY="AD":PAY,$E(PAY)="E":PAY,$E(PAY)="S":PAY,1:"OT")
"RTN","OOPSUTL1",229,0)
 Q PPLAN
"RTN","OOPSUTL2")
0^2^B44647751
"RTN","OOPSUTL2",1,0)
OOPSUTL2 ;HINES/WAA-Utilities Routines ;3/24/98
"RTN","OOPSUTL2",2,0)
 ;;1.0;ASISTS;**7,8,11**;Jun 01, 1998
"RTN","OOPSUTL2",3,0)
 ;;
"RTN","OOPSUTL2",4,0)
CARE2(IEN) ; Update location field
"RTN","OOPSUTL2",5,0)
 N LOC,GEN
"RTN","OOPSUTL2",6,0)
 S GEN=$$GET1^DIQ(2260,IEN,27,"I")
"RTN","OOPSUTL2",7,0)
 S LOC=$$GET1^DIQ(2261.4,GEN,2,"I")
"RTN","OOPSUTL2",8,0)
 S $P(^OOPS(2260,IEN,"2162B"),U,1)=LOC
"RTN","OOPSUTL2",9,0)
 Q
"RTN","OOPSUTL2",10,0)
VCHAR ; Write error message if invalid character
"RTN","OOPSUTL2",11,0)
 W !,"Invalid character entered (~,`,@,#,$,%,*,_,|,\,},{,[,],>, or <)",!,"please edit.",!
"RTN","OOPSUTL2",12,0)
 Q
"RTN","OOPSUTL2",13,0)
DEVSZ(IEN,DEV) ; This screens responses to the DEVICE SIZE table based on whether
"RTN","OOPSUTL2",14,0)
 ; the OBJECT CAUSING INJURY field contains the word Needle or Syringe 
"RTN","OOPSUTL2",15,0)
 ;
"RTN","OOPSUTL2",16,0)
 ;  Input:  IEN - Internal Record Number of claim
"RTN","OOPSUTL2",17,0)
 ;          DEV - Internal Record Number in ^OOPS(2262.2)
"RTN","OOPSUTL2",18,0)
 ; Output: VIEW - if 1, can select, if 0, not available
"RTN","OOPSUTL2",19,0)
 ;
"RTN","OOPSUTL2",20,0)
 N OBJECT,VIEW
"RTN","OOPSUTL2",21,0)
 S VIEW=0
"RTN","OOPSUTL2",22,0)
 S OBJECT=$$UP^OOPSUTL4($$GET1^DIQ(2260,IEN,38))
"RTN","OOPSUTL2",23,0)
 S TYPE=$$GET1^DIQ(2262.2,DEV,1,"I")
"RTN","OOPSUTL2",24,0)
 I (OBJECT["NEEDLE")&(TYPE="N"!(TYPE="NS")) S VIEW=1
"RTN","OOPSUTL2",25,0)
 I (OBJECT["SYRINGE")&(TYPE="S"!(TYPE="NS")) S VIEW=1
"RTN","OOPSUTL2",26,0)
 Q VIEW
"RTN","OOPSUTL2",27,0)
EQUIP() ; This will ask if the product failed
"RTN","OOPSUTL2",28,0)
 N ANS,DIR,Y
"RTN","OOPSUTL2",29,0)
 S ANS=0
"RTN","OOPSUTL2",30,0)
 S DIR(0)="YO^"
"RTN","OOPSUTL2",31,0)
 S ANS=0,DIR("B")=$S($P($G(^OOPS(2260,IEN,"2162D")),U,7)'="":"YES",1:"NO")
"RTN","OOPSUTL2",32,0)
 S DIR("A")="WAS THERE AN EQUIPMENT/DEVICE/PRODUCT FAILURE"
"RTN","OOPSUTL2",33,0)
 S DIR("?")="Enter Yes or No to indicate that it was a failure of an device."
"RTN","OOPSUTL2",34,0)
 D ^DIR
"RTN","OOPSUTL2",35,0)
 I Y=1 S ANS=1
"RTN","OOPSUTL2",36,0)
 I ANS'=1,$P($G(^OOPS(2260,IEN,"2162D")),U,7)'="" S $P(^("2162D"),U,7)=""
"RTN","OOPSUTL2",37,0)
 Q ANS
"RTN","OOPSUTL2",38,0)
DISP ; disp text for prompt
"RTN","OOPSUTL2",39,0)
 W !,"Was the exposed part:"
"RTN","OOPSUTL2",40,0)
 W !,"      Skin,"
"RTN","OOPSUTL2",41,0)
 W !,"      Eyes(Conjunctiva),"
"RTN","OOPSUTL2",42,0)
 W !,"      Nose(mucosa),"
"RTN","OOPSUTL2",43,0)
 W !,"      Mouth(mucosa)"
"RTN","OOPSUTL2",44,0)
 W !,"      Other"
"RTN","OOPSUTL2",45,0)
 W !
"RTN","OOPSUTL2",46,0)
 Q
"RTN","OOPSUTL2",47,0)
CARE(IEN,GEN) ; Select Patient Care Area
"RTN","OOPSUTL2",48,0)
 N AREA,TYPE,VIEW
"RTN","OOPSUTL2",49,0)
 S VIEW=0
"RTN","OOPSUTL2",50,0)
 S AREA=$$GET1^DIQ(2260,IEN,26,"I")
"RTN","OOPSUTL2",51,0)
 I AREA="" S AREA="U"
"RTN","OOPSUTL2",52,0)
 I AREA="U" S VIEW=1
"RTN","OOPSUTL2",53,0)
 E  D
"RTN","OOPSUTL2",54,0)
 .S TYPE=$$GET1^DIQ(2261.4,GEN,2,"I")
"RTN","OOPSUTL2",55,0)
 .I AREA=TYPE S VIEW=1
"RTN","OOPSUTL2",56,0)
 .Q
"RTN","OOPSUTL2",57,0)
 Q VIEW
"RTN","OOPSUTL2",58,0)
 ;
"RTN","OOPSUTL2",59,0)
 N AREA,OTHER
"RTN","OOPSUTL2",60,0)
 N SELECT,DIR,Y,DEFAULT,INC
"RTN","OOPSUTL2",61,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSUTL2",62,0)
 S SELECT=""
"RTN","OOPSUTL2",63,0)
 ;W !
"RTN","OOPSUTL2",64,0)
 ;W !,"  Select the Area Type:",!
"RTN","OOPSUTL2",65,0)
 ;W !,"                  1) Patient"
"RTN","OOPSUTL2",66,0)
 ;W !,"                  2) Non-patient"
"RTN","OOPSUTL2",67,0)
 ;W !,"                  3) Unknown",!
"RTN","OOPSUTL2",68,0)
 S DIR(0)="SAO^1:Patient;2:Non-patient;3:Unknown"
"RTN","OOPSUTL2",69,0)
 S DIR("A")="GENERAL SETTING OF "_$S(INC=1:"INJURY",INC=2:"ILLNESS",1:"")_": "
"RTN","OOPSUTL2",70,0)
 S DIR("?")="Select the area type to be used."
"RTN","OOPSUTL2",71,0)
 S SELECT=$$GET1^DIQ(2260,IEN,27,"I")
"RTN","OOPSUTL2",72,0)
 S SELECT=$S(SELECT'="":$$GET1^DIQ(2261.4,SELECT,2,"I"),1:"")
"RTN","OOPSUTL2",73,0)
 S:SELECT'="" SELECT=$S(SELECT="P":"Patient",SELECT="N":"Non-patient",1:"")
"RTN","OOPSUTL2",74,0)
 S:SELECT'="" DIR("B")=SELECT
"RTN","OOPSUTL2",75,0)
 D ^DIR
"RTN","OOPSUTL2",76,0)
 I $D(DTOUT)!($D(DUOUT)) S Y(0)="",AREA=-1
"RTN","OOPSUTL2",77,0)
 S (OTHER,AREA)=$S(Y(0)="Patient":"P",Y(0)="Non-patient":"N",Y(0)="Unknown":"",1:"-1")
"RTN","OOPSUTL2",78,0)
 I AREA'=-1 D
"RTN","OOPSUTL2",79,0)
 .I AREA'="",$E(AREA,1)=$E(SELECT,1) S DEFAULT=$$GET1^DIQ(2261.4,$$GET1^DIQ(2260,IEN,27,"I"),.01,"E")
"RTN","OOPSUTL2",80,0)
 .D
"RTN","OOPSUTL2",81,0)
 ..N DIC,X
"RTN","OOPSUTL2",82,0)
 ..S DIC="^OOPS(2261.4,"
"RTN","OOPSUTL2",83,0)
 ..I AREA'="" S DIC("S")="I $$GET1^DIQ(2261.4,Y,2,""I"")=AREA"
"RTN","OOPSUTL2",84,0)
 ..I $D(DEFAULT) S DIC("B")=DEFAULT
"RTN","OOPSUTL2",85,0)
 ..S DIC("A")=$S(AREA="P":"PATIENT ",AREA="N":"NON-PATIENT ",1:" ")_"CARE AREA: ",DIC(0)="AQEMNZ"
"RTN","OOPSUTL2",86,0)
 ..D ^DIC
"RTN","OOPSUTL2",87,0)
 ..I $D(DTOUT)!($D(DUOUT)) S AREA=-1 Q
"RTN","OOPSUTL2",88,0)
 ..I Y<1 S AREA=-1 Q
"RTN","OOPSUTL2",89,0)
 ..S AREA=$P(Y,U)
"RTN","OOPSUTL2",90,0)
 ..Q
"RTN","OOPSUTL2",91,0)
 .Q
"RTN","OOPSUTL2",92,0)
 I AREA>0 S AREA=AREA_U_OTHER
"RTN","OOPSUTL2",93,0)
 Q AREA
"RTN","OOPSUTL2",94,0)
SAFETY(IEN,OPEN) ; Safety Officer Screen
"RTN","OOPSUTL2",95,0)
 N VIEW
"RTN","OOPSUTL2",96,0)
 S VIEW=0,OPEN=$G(OPEN,0)
"RTN","OOPSUTL2",97,0)
 ;I FORM=
"RTN","OOPSUTL2",98,0)
 I OPEN,'$P(^OOPS(2260,IEN,0),U,6) S VIEW=1
"RTN","OOPSUTL2",99,0)
 I 'OPEN,$P(^OOPS(2260,IEN,0),U,6)'=2,$P($$EDSTA^OOPSUTL1(IEN,"S"),U,3) S VIEW=1
"RTN","OOPSUTL2",100,0)
 Q VIEW
"RTN","OOPSUTL2",101,0)
SUPSCR(SUP,IEN,OPEN) ; Supervisor screen
"RTN","OOPSUTL2",102,0)
 ; Input
"RTN","OOPSUTL2",103,0)
 ;   SUP the DUZ of the Supervisor
"RTN","OOPSUTL2",104,0)
 ;   IEN the IEN of the ENTRY in file 2260
"RTN","OOPSUTL2",105,0)
 ;
"RTN","OOPSUTL2",106,0)
 ; Output
"RTN","OOPSUTL2",107,0)
 ;   VIEW 1 Sup can see
"RTN","OOPSUTL2",108,0)
 ;        0 Sup can't see
"RTN","OOPSUTL2",109,0)
 N VIEW
"RTN","OOPSUTL2",110,0)
 S VIEW=0,OPEN=$G(OPEN,0)
"RTN","OOPSUTL2",111,0)
 I $$OPEN^OOPSUTL1(IEN,OPEN) D  ;Form can be selected
"RTN","OOPSUTL2",112,0)
 .N INJ
"RTN","OOPSUTL2",113,0)
 .S INJ=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSUTL2",114,0)
 .I ($$GET1^DIQ(2260,IEN,53,"I")'=DUZ)&($$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ) Q  ; Not the Primary or secondary super
"RTN","OOPSUTL2",115,0)
 .I $$EDSTA^OOPSUTL1(IEN,"O") Q
"RTN","OOPSUTL2",116,0)
 .;     ^^^ 2162 has been signed by the Safety Officer
"RTN","OOPSUTL2",117,0)
 .
"RTN","OOPSUTL2",118,0)
 .I ($P($$EDSTA^OOPSUTL1(IEN,"S"),U,INJ)),($P($$EDSTA^OOPSUTL1(IEN,"S"),U,3)) Q  ; Form can not be selected because both
"RTN","OOPSUTL2",119,0)
 . ;the 2162 and the CA1/2 have been signed
"RTN","OOPSUTL2",120,0)
 .S VIEW=1
"RTN","OOPSUTL2",121,0)
 .Q
"RTN","OOPSUTL2",122,0)
 Q VIEW
"RTN","OOPSUTL2",123,0)
AGNINFO ;Patch 7 - default Agency info if available
"RTN","OOPSUTL2",124,0)
 S AIEN=$P(^OOPS(2260,IEN,"2162A"),"^",9)
"RTN","OOPSUTL2",125,0)
 S AGN=$$GET1^DIQ(4,AIEN,.01,"E")
"RTN","OOPSUTL2",126,0)
 S ADD=$$GET1^DIQ(4,AIEN,1.01,"E")
"RTN","OOPSUTL2",127,0)
 S CITY=$$GET1^DIQ(4,AIEN,1.03,"E")
"RTN","OOPSUTL2",128,0)
 S STATE=$$GET1^DIQ(4,AIEN,.02,"E")
"RTN","OOPSUTL2",129,0)
 S ZIP=$$GET1^DIQ(4,AIEN,1.04,"E")
"RTN","OOPSUTL2",130,0)
 Q
"RTN","OOPSUTL2",131,0)
PHINFO  ;Patch 7 - default physician data, if available
"RTN","OOPSUTL2",132,0)
 S STAT=0
"RTN","OOPSUTL2",133,0)
 S AIEN=$P(^OOPS(2260,IEN,"2162A"),"^",9)
"RTN","OOPSUTL2",134,0)
 ; get physician data for correct STATION
"RTN","OOPSUTL2",135,0)
 F  S STAT=$O(^OOPS(2262,1,1,STAT)) Q:STAT'>0  I ($P(^OOPS(2262,1,1,STAT,0),"^")=AIEN) Q  ;found match, quit
"RTN","OOPSUTL2",136,0)
 I STAT D
"RTN","OOPSUTL2",137,0)
 .S SIEN=STAT_",1,"
"RTN","OOPSUTL2",138,0)
 .S PNAME=$$GET1^DIQ(2262.03,SIEN,1)
"RTN","OOPSUTL2",139,0)
 .S PADD=$$GET1^DIQ(2262.03,SIEN,2)
"RTN","OOPSUTL2",140,0)
 .S PCITY=$$GET1^DIQ(2262.03,SIEN,3)
"RTN","OOPSUTL2",141,0)
 .S PSTATE=$$GET1^DIQ(2262.03,SIEN,4)
"RTN","OOPSUTL2",142,0)
 .S PZIP=$$GET1^DIQ(2262.03,SIEN,5)
"RTN","OOPSUTL2",143,0)
 .S PTITLE=$$GET1^DIQ(2262.03,SIEN,"6:1")
"RTN","OOPSUTL2",144,0)
 Q
"RTN","OOPSUTL2",145,0)
RWS ;Regular Work Schedule
"RTN","OOPSUTL2",146,0)
 N Y S DIR(0)="LA^1:7"
"RTN","OOPSUTL2",147,0)
 S DIR("?",1)="     Enter the employee's work schedule at the time of the incident."
"RTN","OOPSUTL2",148,0)
 S DIR("?",2)="     The numbers 1-7 correspond to the days of the week."
"RTN","OOPSUTL2",149,0)
 S DIR("?",3)="       1 = Sunday"
"RTN","OOPSUTL2",150,0)
 S DIR("?",4)="       2 = Monday"
"RTN","OOPSUTL2",151,0)
 S DIR("?",5)="       3 = Tuesday"
"RTN","OOPSUTL2",152,0)
 S DIR("?",6)="       4 = Wednesday"
"RTN","OOPSUTL2",153,0)
 S DIR("?",7)="       5 = Thursday"
"RTN","OOPSUTL2",154,0)
 S DIR("?",8)="       6 = Friday"
"RTN","OOPSUTL2",155,0)
 S DIR("?",9)="       7 = Saturday"
"RTN","OOPSUTL2",156,0)
 S DIR("?",10)="     Enter the day numbers as a range or list separated by commas."
"RTN","OOPSUTL2",157,0)
 S DIR("?",11)=""
"RTN","OOPSUTL2",158,0)
 S DIR("?",12)="     Examples: For Mon-Fri     enter 2-6 (or 2,3,4,5,6)"
"RTN","OOPSUTL2",159,0)
 S DIR("?",13)="               For Wed-Sat     enter 4-7 (or 4,5,6,7)"
"RTN","OOPSUTL2",160,0)
 S DIR("?")="               For Mon,Wed,Fri enter 2,4,6"
"RTN","OOPSUTL2",161,0)
 D ^DIR
"RTN","OOPSUTL2",162,0)
 I $P(X,"-",2)>7 W !,"     Range exceeds 1-7 limit." G RWS
"RTN","OOPSUTL2",163,0)
 Q:$D(DIRUT)
"RTN","OOPSUTL2",164,0)
 S:ITEM=21 $P(^OOPS(2260,D0,"CA1F"),U,11)=Y
"RTN","OOPSUTL2",165,0)
 S:ITEM=22 $P(^OOPS(2260,D0,"CA2I"),U,8)=Y
"RTN","OOPSUTL2",166,0)
 Q
"RTN","OOPSUTL2",167,0)
EXCEPT ; Exception statement
"RTN","OOPSUTL2",168,0)
 W !," ",ITEM,". A supervisor who knowingly certifies to any false statement,"
"RTN","OOPSUTL2",169,0)
 W !,"     misrepresentation, concealment of fact, etc., in respect of"
"RTN","OOPSUTL2",170,0)
 W !,"     this claim may also be subject to appropriate felony criminal"
"RTN","OOPSUTL2",171,0)
 W !,"     prosecution."
"RTN","OOPSUTL2",172,0)
 W !
"RTN","OOPSUTL2",173,0)
 W !,"     I certify that the information given above and that furnished"
"RTN","OOPSUTL2",174,0)
 W !,"     by the employee is true to the best of my knowledge with the"
"RTN","OOPSUTL2",175,0)
 W !,"     following exception."
"RTN","OOPSUTL2",176,0)
 W !
"RTN","OOPSUTL2",177,0)
 Q
"RTN","OOPSUTL2",178,0)
MKNUM(INSTR) ; Strip/Convert num numerics from a string - Patch 11
"RTN","OOPSUTL2",179,0)
 ;   Input  - INSTR  - Character String that should be a number
"RTN","OOPSUTL2",180,0)
 ;  Output  - NUMOUT - String stripped of all non-numeric characters.
"RTN","OOPSUTL2",181,0)
 N K,NUMOUT
"RTN","OOPSUTL2",182,0)
 S NUMOUT=""
"RTN","OOPSUTL2",183,0)
 F K=1:1:$L(INSTR) I ($A(INSTR,K)>47)&($A(INSTR,K)<58) S NUMOUT=NUMOUT_$E(INSTR,K)
"RTN","OOPSUTL2",184,0)
 Q NUMOUT
"RTN","OOPSUTL4")
0^3^B58891510
"RTN","OOPSUTL4",1,0)
OOPSUTL4 ;HINES/WAA-Utilities Routines ;3/24/98
"RTN","OOPSUTL4",2,0)
 ;;1.0;ASISTS;**3,5,8,10,11**;Jun 01, 1998
"RTN","OOPSUTL4",3,0)
 ;;
"RTN","OOPSUTL4",4,0)
DTVAL(DATE,FLD1,FLD2) ;
"RTN","OOPSUTL4",5,0)
 ; this subroutine called from ^DD so date error checking on fields
"RTN","OOPSUTL4",6,0)
 ; 143, 144, 145 (if CA1) and 254, 255 (if CA2).  returns a valid date 
"RTN","OOPSUTL4",7,0)
 ; (one passed in) if a date in FLD2 and is > than date passed in (DATE).
"RTN","OOPSUTL4",8,0)
 ;  Inputs:   DATE - date entered in prompt
"RTN","OOPSUTL4",9,0)
 ;            FLD1 - field of prompt date entered in
"RTN","OOPSUTL4",10,0)
 ;            FLD2 - field of date to be checked against
"RTN","OOPSUTL4",11,0)
 ; Outputs:   VAL  - contains valid date passed in if true & "" if false
"RTN","OOPSUTL4",12,0)
 N DATE2,VAL
"RTN","OOPSUTL4",13,0)
 S VAL=DATE,DATE2=""
"RTN","OOPSUTL4",14,0)
 I '$G(IEN) S IEN=$G(DA)
"RTN","OOPSUTL4",15,0)
 I IEN S DATE2=$$GET1^DIQ(2260,IEN,FLD2,"I")
"RTN","OOPSUTL4",16,0)
 I %DT'["R" S DATE2=DATE2\1
"RTN","OOPSUTL4",17,0)
 I DATE2>DATE!'$G(DATE2) S VAL=""
"RTN","OOPSUTL4",18,0)
 I 'VAL D
"RTN","OOPSUTL4",19,0)
 . I '$G(DATE2) W !!?5,$$GET1^DID(2260,FLD2,"","LABEL")_" cannot be blank if date entered in "_$$GET1^DID(2260,FLD1,"","LABEL"),! Q
"RTN","OOPSUTL4",20,0)
 . W !!?5,$$GET1^DID(2260,FLD1,"","LABEL")_" must be on or after the "_$$GET1^DID(2260,FLD2,"","LABEL"),!
"RTN","OOPSUTL4",21,0)
 Q VAL
"RTN","OOPSUTL4",22,0)
UNION(IEN) ;
"RTN","OOPSUTL4",23,0)
 ; Input: IEN   = Internal Entry Number of entry in file 2260
"RTN","OOPSUTL4",24,0)
 ; Output VALID = 1 Valid to be seen by Union
"RTN","OOPSUTL4",25,0)
 ;              = 0 Not Valid to be seen by Union
"RTN","OOPSUTL4",26,0)
 N VALID
"RTN","OOPSUTL4",27,0)
 S VALID=0
"RTN","OOPSUTL4",28,0)
 I $$EDSTA^OOPSUTL1(IEN,"O"),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,3) S VALID=1
"RTN","OOPSUTL4",29,0)
 Q VALID
"RTN","OOPSUTL4",30,0)
VALIDATE(IEN,FORM,CALLER,VALID) ;
"RTN","OOPSUTL4",31,0)
 ; Input: IEN    = Internal Entry Number of entry in file 2260
"RTN","OOPSUTL4",32,0)
 ;        FORM   = 2162,CA1, or CA2
"RTN","OOPSUTL4",33,0)
 ;        CALLER = "E" employee
"RTN","OOPSUTL4",34,0)
 ;               = "S" supervisor
"RTN","OOPSUTL4",35,0)
 ;               = "O" safety officer
"RTN","OOPSUTL4",36,0)
 ;               = "W" worker's comp personnel
"RTN","OOPSUTL4",37,0)
 ;        WCEMP  = from menu if 1 - need to execute emp validation
"RTN","OOPSUTL4",38,0)
 ;        VALID  = RESERVED FOR OUTPUT DATA
"RTN","OOPSUTL4",39,0)
 ; Output:VALID  = 1 ALL REQUIRED DATA FOR FORM IS COMPLETE
"RTN","OOPSUTL4",40,0)
 ;               = 0 DATA IS MISSING
"RTN","OOPSUTL4",41,0)
 N LIST,FLD,CNT,CHK
"RTN","OOPSUTL4",42,0)
 S (FLD,LIST)=""
"RTN","OOPSUTL4",43,0)
 S VALID=1,CHK=0
"RTN","OOPSUTL4",44,0)
 S WCEMP=$G(WCEMP,0)
"RTN","OOPSUTL4",45,0)
 W !,"Validating data on form ",FORM,"."
"RTN","OOPSUTL4",46,0)
 I CALLER="E"!$G(WCEMP) D EMP
"RTN","OOPSUTL4",47,0)
 I CALLER="S" D SUP
"RTN","OOPSUTL4",48,0)
 I CALLER="O" D SOF
"RTN","OOPSUTL4",49,0)
 I CALLER="W" D WCP
"RTN","OOPSUTL4",50,0)
 F CNT=1:1 S FLD=$P(LIST,",",CNT) Q:FLD=""  D
"RTN","OOPSUTL4",51,0)
 .N LOC,NODE,PCE,BADFLD,TEXT,WP
"RTN","OOPSUTL4",52,0)
 .S BADFLD=1,WP=0
"RTN","OOPSUTL4",53,0)
 .S LOC=$$GET1^DID(2260,FLD,"","GLOBAL SUBSCRIPT LOCATION")
"RTN","OOPSUTL4",54,0)
 .S NODE=$P(LOC,";")
"RTN","OOPSUTL4",55,0)
 .S PCE=$P(LOC,";",2)
"RTN","OOPSUTL4",56,0)
 .I PCE=0 D  ;Work processing field
"RTN","OOPSUTL4",57,0)
 ..I '$D(^OOPS(2260,IEN,NODE,1,0)) S (BADFLD,VALID)=0
"RTN","OOPSUTL4",58,0)
 ..S WP=1
"RTN","OOPSUTL4",59,0)
 ..Q
"RTN","OOPSUTL4",60,0)
 .I PCE'=0  I $P($G(^OOPS(2260,IEN,NODE)),U,PCE)="" S (BADFLD,VALID)=0
"RTN","OOPSUTL4",61,0)
 .I 'BADFLD D  ; Display error messaged about fields not filled.
"RTN","OOPSUTL4",62,0)
 ..I 'CHK W !!,"The following fields must be completed before the "_FORM_" can be signed.",! S CHK=1
"RTN","OOPSUTL4",63,0)
 ..I WP D  ;Is this a wp field and where to get title
"RTN","OOPSUTL4",64,0)
 ...N NODE
"RTN","OOPSUTL4",65,0)
 ...S NODE=2260_".0"_FLD
"RTN","OOPSUTL4",66,0)
 ...; patch 11 - fix bug on fld 40, node '= 2260.040, it's 2260.01
"RTN","OOPSUTL4",67,0)
 ...I FLD=40 S NODE="2260.01"
"RTN","OOPSUTL4",68,0)
 ...S TEXT=$$GET1^DID(NODE,".01","","TITLE")
"RTN","OOPSUTL4",69,0)
 ...Q
"RTN","OOPSUTL4",70,0)
 ..I 'WP S TEXT=$$GET1^DID(2260,FLD,"","TITLE")
"RTN","OOPSUTL4",71,0)
 ..W !,TEXT
"RTN","OOPSUTL4",72,0)
 ..Q
"RTN","OOPSUTL4",73,0)
 .Q
"RTN","OOPSUTL4",74,0)
 I FORM="CA1"&(CALLER="E"!$G(WCEMP)) D   ; fld 110 check on Emp CA1 only
"RTN","OOPSUTL4",75,0)
 . I $$GET1^DIQ(2260,IEN,110,"I")<($$GET1^DIQ(2260,IEN,4,"I")\1) S VALID=0 D
"RTN","OOPSUTL4",76,0)
 .. W !?5,$$GET1^DID(2260,110,"","LABEL")_" must be on or after the "_$$GET1^DID(2260,4,"","LABEL")
"RTN","OOPSUTL4",77,0)
DTCHK ; Date error checking that may be missed w/input transform
"RTN","OOPSUTL4",78,0)
 ; patch 11 - Additional error checking has been added for CA2 field 214
"RTN","OOPSUTL4",79,0)
 I FORM=2162!(CALLER="O")!$G(WCEMP) Q
"RTN","OOPSUTL4",80,0)
 K CNT,FLD,LIST
"RTN","OOPSUTL4",81,0)
 N DATE,DATE1,DATE2,TITLE,EMPDOB
"RTN","OOPSUTL4",82,0)
 ; patch 11 - need to make sure 215 not before 214 on employee part
"RTN","OOPSUTL4",83,0)
 I CALLER="E",FORM="CA2" D  Q
"RTN","OOPSUTL4",84,0)
 . S DATE1=$$GET1^DIQ(2260,IEN,215,"I")
"RTN","OOPSUTL4",85,0)
 . S DATE2=$$GET1^DIQ(2260,IEN,214,"I")
"RTN","OOPSUTL4",86,0)
 . S EMPDOB=$$GET1^DIQ(2260,IEN,6,"I")
"RTN","OOPSUTL4",87,0)
 . I $$FMDIFF^XLFDT(DATE2,EMPDOB,2)<0 S VALID=0 D
"RTN","OOPSUTL4",88,0)
 .. W !?5,$$GET1^DID(2260,214,"","LABEL")_" must be on or after the "_$$GET1^DID(2260,6,"","LABEL")
"RTN","OOPSUTL4",89,0)
 . I $$FMDIFF^XLFDT(DATE1,DATE2,2)<0 S VALID=0 D
"RTN","OOPSUTL4",90,0)
 .. W !?5,$$GET1^DID(2260,215,"","LABEL")_" must be on or after the "_$$GET1^DID(2260,214,"","LABEL")
"RTN","OOPSUTL4",91,0)
 ; End of checks from Employee CA2
"RTN","OOPSUTL4",92,0)
 I FORM="CA1" D
"RTN","OOPSUTL4",93,0)
 . S LIST="142,161,175"
"RTN","OOPSUTL4",94,0)
 . S (DATE,DATE1)=$$GET1^DIQ(2260,IEN,4,"I")
"RTN","OOPSUTL4",95,0)
 . S TITLE=$$GET1^DID(2260,4,"","LABEL")
"RTN","OOPSUTL4",96,0)
 I FORM="CA2" D
"RTN","OOPSUTL4",97,0)
 . S LIST="215,250,252,253,255"
"RTN","OOPSUTL4",98,0)
 . S (DATE,DATE1)=$$GET1^DIQ(2260,IEN,214,"I")
"RTN","OOPSUTL4",99,0)
 . S TITLE=$$GET1^DID(2260,214,"","LABEL")
"RTN","OOPSUTL4",100,0)
 F CNT=1:1 S FLD=$P(LIST,",",CNT) Q:FLD=""  D
"RTN","OOPSUTL4",101,0)
 . S DATE2=$$GET1^DIQ(2260,IEN,FLD,"I") I FLD'=142 S DATE2=DATE2\1,DATE1=DATE\1
"RTN","OOPSUTL4",102,0)
 . I $G(DATE2),DATE2<DATE1 D  S VALID=0
"RTN","OOPSUTL4",103,0)
 .. W !?5,$$GET1^DID(2260,FLD,"","LABEL")_" must be on or after the "_TITLE
"RTN","OOPSUTL4",104,0)
 ; Need specific check on DATE/TIME STOPPED WORK
"RTN","OOPSUTL4",105,0)
 I FORM="CA1" D
"RTN","OOPSUTL4",106,0)
 . S LIST="143,144,145",DATE=$$GET1^DIQ(2260,IEN,142,"I")
"RTN","OOPSUTL4",107,0)
 . S TITLE=$$GET1^DID(2260,142,"","LABEL")
"RTN","OOPSUTL4",108,0)
 I FORM="CA2" D
"RTN","OOPSUTL4",109,0)
 . S LIST="254,256",DATE=$$GET1^DIQ(2260,IEN,253,"I")
"RTN","OOPSUTL4",110,0)
 . S TITLE=$$GET1^DID(2260,253,"","LABEL")
"RTN","OOPSUTL4",111,0)
 F CNT=1:1 S FLD=$P(LIST,",",CNT) Q:FLD=""  D
"RTN","OOPSUTL4",112,0)
 . S DATE2=$$GET1^DIQ(2260,IEN,FLD,"I"),DATE1=DATE D
"RTN","OOPSUTL4",113,0)
 .. I FLD=143!(FLD=144) S DATE1=DATE\1,DATE2=DATE2\1
"RTN","OOPSUTL4",114,0)
 .. I (DATE1>DATE2),$G(DATE2) D  S VALID=0
"RTN","OOPSUTL4",115,0)
 ... W !?5,$$GET1^DID(2260,FLD,"","LABEL")_" must be on or after the "_TITLE
"RTN","OOPSUTL4",116,0)
 .. I '$G(DATE1),$G(DATE2) D  S VALID=0
"RTN","OOPSUTL4",117,0)
 ... W !?5,TITLE_" cannot be blank if date in "_$$GET1^DID(2260,FLD,"","LABEL")
"RTN","OOPSUTL4",118,0)
 Q
"RTN","OOPSUTL4",119,0)
EMP ; Address fields are now all pulled from the 2162A node
"RTN","OOPSUTL4",120,0)
 ; added fields 126 & 181,183-185 to lists below - patch 8
"RTN","OOPSUTL4",121,0)
 I FORM="CA1" S LIST="8,9,10,11,12,108,109,110,111,112,113,114,126,181,183,184,185"
"RTN","OOPSUTL4",122,0)
 I FORM="CA2" S LIST="8,9,10,11,12,126,208,209,214,215,216,217"
"RTN","OOPSUTL4",123,0)
 Q
"RTN","OOPSUTL4",124,0)
SUP ;
"RTN","OOPSUTL4",125,0)
 I FORM="2162" D F2162
"RTN","OOPSUTL4",126,0)
 I FORM="CA1" D
"RTN","OOPSUTL4",127,0)
 . S LIST="4,60,130,131,132,133,134,138,139,140,146,148,150,156,157,"
"RTN","OOPSUTL4",128,0)
 . S LIST=LIST_"158,159,160,162,163,172,173,174,175,176,177,178,179,"
"RTN","OOPSUTL4",129,0)
 . S LIST=LIST_"180,182"
"RTN","OOPSUTL4",130,0)
 . I $$GET1^DIQ(2260,IEN,150,"I")="Y" S LIST=LIST_",151,152,153,154,155"
"RTN","OOPSUTL4",131,0)
 I FORM="CA2" D
"RTN","OOPSUTL4",132,0)
 . S LIST="230,231,232,233,234,237,238,239,240,241,"
"RTN","OOPSUTL4",133,0)
 . S LIST=LIST_"242,243,244,251,252,255,258,60,268,269"
"RTN","OOPSUTL4",134,0)
 Q
"RTN","OOPSUTL4",135,0)
SOF ;
"RTN","OOPSUTL4",136,0)
 I FORM="2162" S LIST="55,47"
"RTN","OOPSUTL4",137,0)
 Q
"RTN","OOPSUTL4",138,0)
WCP ; Get required fields for Workers Comp
"RTN","OOPSUTL4",139,0)
 I FORM="CA1" D
"RTN","OOPSUTL4",140,0)
 . S LIST="5,6,7,15,62,70,73,123,124,130,131,132,133,134,176,179,180,60,"
"RTN","OOPSUTL4",141,0)
 . S LIST=LIST_"138,139,140,4,175,146,148,162,163,172,173,174,"
"RTN","OOPSUTL4",142,0)
 . S LIST=LIST_"150,156,157,158,159,160,182"
"RTN","OOPSUTL4",143,0)
 . ; flds 166 & 167 only required if personnel status = 1
"RTN","OOPSUTL4",144,0)
 . I $$GET1^DIQ(2260,IEN,2,"I")=1 S LIST=LIST_",166,167"
"RTN","OOPSUTL4",145,0)
 . I $$GET1^DIQ(2260,IEN,150,"I")="Y" S LIST=LIST_",151,152,153,154,155"
"RTN","OOPSUTL4",146,0)
 I FORM="CA2" D
"RTN","OOPSUTL4",147,0)
 . S LIST="5,6,7,15,62,70,73,226,227,230,231,232,233,234,237,238,239,"
"RTN","OOPSUTL4",148,0)
 . S LIST=LIST_"240,241,242,243,244,251,252,255,258,60,268,269"
"RTN","OOPSUTL4",149,0)
 Q
"RTN","OOPSUTL4",150,0)
F2162 ; Set required fields for form 2162 - doesn't matter which menu
"RTN","OOPSUTL4",151,0)
 ; coming from, Supervisor, Safety, WC (for EDIT REPORT OF INCIDENT)
"RTN","OOPSUTL4",152,0)
 N TYP,SAF
"RTN","OOPSUTL4",153,0)
 I FORM'="2162" Q
"RTN","OOPSUTL4",154,0)
 S LIST="26,27,28,29,30,31" I $$ISEMP^OOPSUTL4(IEN) S LIST=LIST_",33"
"RTN","OOPSUTL4",155,0)
 S TYP=$$GET1^DIQ(2260,IEN,"3:.01","E")
"RTN","OOPSUTL4",156,0)
 I "^Sharps Exposure^Hollow Bore Needlestick^Suture Needlestick^"[TYP D
"RTN","OOPSUTL4",157,0)
 . S LIST=LIST_",34,35,36,37,38,82"
"RTN","OOPSUTL4",158,0)
 I $$GET1^DIQ(2260,IEN,"38:2","I")="N" S LIST=LIST_",83"
"RTN","OOPSUTL4",159,0)
 I "^Exposure to Body Fluids/Splash^"[TYP D
"RTN","OOPSUTL4",160,0)
 . S LIST=LIST_",34,39,40,41"
"RTN","OOPSUTL4",161,0)
 I $$GET1^DIQ(2260,IEN,42.5,"I")="Y" S LIST=LIST_",42"
"RTN","OOPSUTL4",162,0)
 S SAF=$$GET1^DIQ(2260,IEN,43,"I")
"RTN","OOPSUTL4",163,0)
 S LIST=$S(SAF="Y":LIST_",84",SAF="N":LIST_",85",1:LIST)
"RTN","OOPSUTL4",164,0)
 S LIST=LIST_",47"
"RTN","OOPSUTL4",165,0)
 Q
"RTN","OOPSUTL4",166,0)
UP(IN) ; Translate all lower to upper
"RTN","OOPSUTL4",167,0)
 N OUT
"RTN","OOPSUTL4",168,0)
 S OUT=$TR(IN,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","OOPSUTL4",169,0)
 Q OUT
"RTN","OOPSUTL4",170,0)
VCHAR(IN) ; Check to make sure no invalid characters have been used
"RTN","OOPSUTL4",171,0)
 ;   input  - IN, data entered by user
"RTN","OOPSUTL4",172,0)
 ;  output  - VALID, if invalid characters used, = 0
"RTN","OOPSUTL4",173,0)
 N VALID
"RTN","OOPSUTL4",174,0)
 S VALID=1
"RTN","OOPSUTL4",175,0)
 I IN'=$TR(IN,"~`@#$%*_|\}{[]><","") S VALID=0
"RTN","OOPSUTL4",176,0)
 Q VALID
"RTN","OOPSUTL4",177,0)
RWSOT ;Regular Work Schedule output transform
"RTN","OOPSUTL4",178,0)
 N I,HOLD
"RTN","OOPSUTL4",179,0)
 S HOLD=""
"RTN","OOPSUTL4",180,0)
 F I=1:1:($L(Y)/2) S HOLD=HOLD_$P("Sun,Mon,Tue,Wed,Thu,Fri,Sat",",",$P(Y,",",I))_","
"RTN","OOPSUTL4",181,0)
 S Y=$E(HOLD,1,($L(HOLD)-1))
"RTN","OOPSUTL4",182,0)
 Q 
"RTN","OOPSUTL4",183,0)
RWSIN(X) ;
"RTN","OOPSUTL4",184,0)
 ; X=Sun,Mon,Tue
"RTN","OOPSUTL4",185,0)
 N IN,I,Y,DAY,DOW
"RTN","OOPSUTL4",186,0)
 S X=X_",",DAY=""
"RTN","OOPSUTL4",187,0)
 S IN="1Sun,2Mon,3Tue,4Wed,5Thu,6Fri,7Sat"
"RTN","OOPSUTL4",188,0)
 F I=1:1 S DOW=$P(X,",",I) Q:DOW=""  D
"RTN","OOPSUTL4",189,0)
 .S DAY=DAY_$E(IN,($F(IN,DOW)-4))_","
"RTN","OOPSUTL4",190,0)
 .Q
"RTN","OOPSUTL4",191,0)
 Q DAY
"RTN","OOPSUTL4",192,0)
ISEMP(IEN) ; Determine if PERSONNEL STATUS = employee
"RTN","OOPSUTL4",193,0)
 ;  Input -  IEN     = internal Entry Number of case in File 2260
"RTN","OOPSUTL4",194,0)
 ;           CAT     = Personnel Status of Case in File 2260
"RTN","OOPSUTL4",195,0)
 ;           TST     = valid Personnel status categories for employee
"RTN","OOPSUTL4",196,0)
 ;  Output - EMP     = 1 Personnel status indicates employee
"RTN","OOPSUTL4",197,0)
 ;                     0 Personnel status indicates non-employee
"RTN","OOPSUTL4",198,0)
 NEW CAT,TST,EMP
"RTN","OOPSUTL4",199,0)
 S EMP=0
"RTN","OOPSUTL4",200,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSUTL4",201,0)
 S TST=",1,2,6,7,8,9,10,"
"RTN","OOPSUTL4",202,0)
 I TST[(","_CAT_",") S EMP=1
"RTN","OOPSUTL4",203,0)
 Q EMP
"RTN","OOPSUTL4",204,0)
FUT(DATE) ; Check for dates prior to Date of Inj/Ill
"RTN","OOPSUTL4",205,0)
 N DAT,VIEW,FORM
"RTN","OOPSUTL4",206,0)
 S VIEW=1
"RTN","OOPSUTL4",207,0)
 S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSUTL4",208,0)
 S DAT=$$GET1^DIQ(2260,IEN,4,"I")
"RTN","OOPSUTL4",209,0)
 I (DATE<$P(DAT,".")),FORM=1 D
"RTN","OOPSUTL4",210,0)
 . W !!?6,"This date cannot be prior to DATE/TIME INJURY OCCURRED entered on 2162.",! S VIEW=0
"RTN","OOPSUTL4",211,0)
 Q VIEW
"RTN","OOPSUTL4",212,0)
WP(OPFLD) ; Patch 8 - determine number of characters in WP fields that are
"RTN","OOPSUTL4",213,0)
 ;         limited to 532 characters & if invalid characters are present
"RTN","OOPSUTL4",214,0)
 ;  Input    IEN - Internal Record ID of Case
"RTN","OOPSUTL4",215,0)
 ;         OPFLD - Field number of WP field to be calculated
"RTN","OOPSUTL4",216,0)
 ; Output    OPT - Total number of characters in all lines of WP field
"RTN","OOPSUTL4",217,0)
 ;                 concatenated to VALID. ex: 165^1 or 180^0
"RTN","OOPSUTL4",218,0)
 ;         VALID - indicates whether invalid characters were detected
"RTN","OOPSUTL4",219,0)
 ;
"RTN","OOPSUTL4",220,0)
 N DATA,DIWL,DIWR,DIWF,OPGLB,OPI,OPNODE,OPT,OPC,VALID
"RTN","OOPSUTL4",221,0)
 S VALID=1
"RTN","OOPSUTL4",222,0)
 K ^UTILITY($J,"W")
"RTN","OOPSUTL4",223,0)
 S DIWL=1,DIWR="",DIWF="|C264",OPT=0
"RTN","OOPSUTL4",224,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSUTL4",225,0)
 S OPI=0 F  S OPI=$O(^OOPS(2260,IEN,OPNODE,OPI)) Q:'OPI  S X=$G(^OOPS(2260,IEN,OPNODE,OPI,0)) D:X]"" ^DIWP
"RTN","OOPSUTL4",226,0)
 I $G(^UTILITY($J,"W",1))+0 D
"RTN","OOPSUTL4",227,0)
 . S OPI=0 F OPC=1:1 S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI  D
"RTN","OOPSUTL4",228,0)
 .. S DATA=^UTILITY($J,"W",1,OPI,0)
"RTN","OOPSUTL4",229,0)
 .. I DATA'=$TR(DATA,"~`@#$%^*_|\}{[]><","") S VALID=0
"RTN","OOPSUTL4",230,0)
 .. S OPT=OPT+$L(DATA)
"RTN","OOPSUTL4",231,0)
 K ^UTILITY($J,"W"),X
"RTN","OOPSUTL4",232,0)
 Q OPT_U_VALID
"RTN","OOPSWCE")
0^15^B48491557
"RTN","OOPSWCE",1,0)
OOPSWCE ;WIOFO/LLH-Workers Comp Edit routine ;3/23/00
"RTN","OOPSWCE",2,0)
 ;;1.0;ASISTS;**8,11**;Jun 01, 1998
"RTN","OOPSWCE",3,0)
 ;;
"RTN","OOPSWCE",4,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSWCE",5,0)
 N CA,CASIGN,DIC,DONE,FORM,IEN,OOPS,OUT,SIGN,SSN,SUP,X,WOK
"RTN","OOPSWCE",6,0)
 S (DONE,OUT,IEN)=0
"RTN","OOPSWCE",7,0)
 S WOK=1                            ; to set cross reference
"RTN","OOPSWCE",8,0)
 Q:DUZ<1
"RTN","OOPSWCE",9,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSWCE",10,0)
 ;  Select a Case
"RTN","OOPSWCE",11,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSWCE",12,0)
 S DIC("S")="I $$WC^OOPSWCE(Y)"
"RTN","OOPSWCE",13,0)
 S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSWCE",14,0)
 D ^DIC
"RTN","OOPSWCE",15,0)
 Q:Y<1
"RTN","OOPSWCE",16,0)
 Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSWCE",17,0)
 S IEN=$P(Y,U)
"RTN","OOPSWCE",18,0)
 D ^OOPSDIS                                      ; Display header info
"RTN","OOPSWCE",19,0)
 S (FORM,CA)=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSWCE",20,0)
 S FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSWCE",21,0)
 S CASIGN=$P($$EDSTA^OOPSUTL1(IEN,"S"),U,CA)     ; Super signed CA form
"RTN","OOPSWCE",22,0)
 D FORMS ; Process correct form
"RTN","OOPSWCE",23,0)
 I OUT=2 G EXIT
"RTN","OOPSWCE",24,0)
 ; If controled fields have been edited, clear Sup fields, get re-signed
"RTN","OOPSWCE",25,0)
 I $D(OOPS) S DONE=$$CHGES(DONE) I DONE D CLRFLDS,SUPFLDS D:'OUT SUPSIGN
"RTN","OOPSWCE",26,0)
 I OUT G EXIT
"RTN","OOPSWCE",27,0)
 ; Need to have WC enter Supervisor fields
"RTN","OOPSWCE",28,0)
 I 'CASIGN D SUPFLDS D:'OUT SUPSIGN
"RTN","OOPSWCE",29,0)
EXIT ; Validate and allow user to sign if all required fields complete
"RTN","OOPSWCE",30,0)
 N DIR,Y
"RTN","OOPSWCE",31,0)
 I OUT=1 D
"RTN","OOPSWCE",32,0)
 . S DIR("A")="You '^'d out, Do you want to Sign"
"RTN","OOPSWCE",33,0)
 . S DIR(0)="SBM^Y:Yes;N:No"
"RTN","OOPSWCE",34,0)
 . D ^DIR
"RTN","OOPSWCE",35,0)
 . I Y="Y" S OUT=0
"RTN","OOPSWCE",36,0)
 I 'OUT D SIGNS(FORM)                 ; Sign/validate Document
"RTN","OOPSWCE",37,0)
 L -^OOPS(2260,IEN)
"RTN","OOPSWCE",38,0)
 Q
"RTN","OOPSWCE",39,0)
 ;
"RTN","OOPSWCE",40,0)
FORMS ; Process Form
"RTN","OOPSWCE",41,0)
 N DA,DIE,DR,FLD,I,MAX,MAX1,RET,SAL,PAY
"RTN","OOPSWCE",42,0)
 N AIEN,AGN,ADD,CITY,STATE,ZIP
"RTN","OOPSWCE",43,0)
 N PNAME,PADD,PCITY,PSTATE,PZIP,PTITLE,STAT,SIEN
"RTN","OOPSWCE",44,0)
 ; Patch 11 - Default Chargeback code, next 6 lines
"RTN","OOPSWCE",45,0)
 N OWCP,STA
"RTN","OOPSWCE",46,0)
 S OWCP=""
"RTN","OOPSWCE",47,0)
 S STA=$$GET1^DIQ(2260,IEN,13,"I")
"RTN","OOPSWCE",48,0)
 I STA S OWCP=$$FIND1^DIC(2262.03,",1,","Q",STA)
"RTN","OOPSWCE",49,0)
 I OWCP S OWCP=OWCP_",1," S OWCP=$$GET1^DIQ(2262.03,OWCP,.7)
"RTN","OOPSWCE",50,0)
 I 'OWCP S OWCP=""
"RTN","OOPSWCE",51,0)
 S MAX1=528                          ; Max length on some WP fields
"RTN","OOPSWCE",52,0)
 ; Get Default retirement from PAID - FLD = paid value
"RTN","OOPSWCE",53,0)
 S FLD=28,SAL=""
"RTN","OOPSWCE",54,0)
 S SAL=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSWCE",55,0)
 S FLD=26,RET=""
"RTN","OOPSWCE",56,0)
 S RET=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSWCE",57,0)
 S RET=$S(RET="FULL CSRS":"CSRS",RET="FERS":"FERS",1:"OTHER")
"RTN","OOPSWCE",58,0)
 S FLD=19,PAY=""
"RTN","OOPSWCE",59,0)
 S PAY=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSWCE",60,0)
 S PAY=$S(PAY="PER ANNUM":"ANNUAL",PAY="PER HOUR":"HOURLY","PER DIEM":"DAILY","BIWEEKLY":"BI-WEEKLY",1:"")
"RTN","OOPSWCE",61,0)
 ; If WCP has signed, clear signature - added 5/19/00
"RTN","OOPSWCE",62,0)
 I $$GET1^DIQ(2260,IEN,67)'="" D CLRES^OOPSUTL1(IEN,"W",FORM)
"RTN","OOPSWCE",63,0)
 ; If Super has not signed, prompt WC to continue or not
"RTN","OOPSWCE",64,0)
 I 'CASIGN D WCSIGN Q:OUT
"RTN","OOPSWCE",65,0)
 ; If Super has signed and person editing form is not Supervisor who
"RTN","OOPSWCE",66,0)
 ; signed, then check for edits on certain fields.  ONLY FOR CA1
"RTN","OOPSWCE",67,0)
 I FORM="CA1",CASIGN,($$GET1^DIQ(2260,IEN,169,"I")'=DUZ) D WCEDIT
"RTN","OOPSWCE",68,0)
 L +^OOPS(2260,IEN):2
"RTN","OOPSWCE",69,0)
 E  W !!?5,"Another user is editing this entry. Try later." S OUT=2 Q
"RTN","OOPSWCE",70,0)
 I FORM="CA1" D CA1^OOPSWCE1 Q:OUT
"RTN","OOPSWCE",71,0)
 I FORM="CA2" D CA2^OOPSWCE2 Q:OUT
"RTN","OOPSWCE",72,0)
 S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSWCE",73,0)
 D ^DIE
"RTN","OOPSWCE",74,0)
 I ($D(Y)'=0)!($G(DIRUT)=1)  S OUT=1
"RTN","OOPSWCE",75,0)
 Q
"RTN","OOPSWCE",76,0)
WC(IEN) ; Selection Screen
"RTN","OOPSWCE",77,0)
 ;    Input  - IEN   Internal entry number of case
"RTN","OOPSWCE",78,0)
 ;   Output  - VIEW  If 0 case not accessible, if 1 case selectable
"RTN","OOPSWCE",79,0)
 ;
"RTN","OOPSWCE",80,0)
 N VIEW,FORM
"RTN","OOPSWCE",81,0)
 S VIEW=1
"RTN","OOPSWCE",82,0)
 S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSWCE",83,0)
 I '$P($$EDSTA^OOPSUTL1(IEN,"E"),U,FORM) S VIEW=0   ;Employee not signed
"RTN","OOPSWCE",84,0)
 I $$GET1^DIQ(2260,IEN,66)'="" S VIEW=0             ;Case sent to DOL
"RTN","OOPSWCE",85,0)
 I $$GET1^DIQ(2260,IEN,51,"I")'=0 S VIEW=0          ;Case is not open
"RTN","OOPSWCE",86,0)
 I '$$ISEMP^OOPSUTL4(IEN) S VIEW=0                  ;not employee
"RTN","OOPSWCE",87,0)
 Q VIEW
"RTN","OOPSWCE",88,0)
WCEDIT ; check for edits by WC
"RTN","OOPSWCE",89,0)
 ; Get data from fields 146, 147, 148, 149, 163, 164, 165.
"RTN","OOPSWCE",90,0)
 N DA,DIC,DIQ,DR,%X,%Y
"RTN","OOPSWCE",91,0)
 K OOPS
"RTN","OOPSWCE",92,0)
 S DIC=2260,DR="146;147;148;149;163",DA=IEN,DIQ="OOPS",DIQ(0)="I"
"RTN","OOPSWCE",93,0)
 D EN^DIQ1
"RTN","OOPSWCE",94,0)
 S %X="^OOPS(2260,IEN,""CA1J"",",%Y="OOPS(2260,IEN,""CA1J""," D %XY^%RCR
"RTN","OOPSWCE",95,0)
 S %X="^OOPS(2260,IEN,""CA1K"",",%Y="OOPS(2260,IEN,""CA1K""," D %XY^%RCR
"RTN","OOPSWCE",96,0)
 Q
"RTN","OOPSWCE",97,0)
WCSIGN ; Prompt user to continue as Supervisor if Super has not signed form
"RTN","OOPSWCE",98,0)
 N DIR,Y
"RTN","OOPSWCE",99,0)
 S DIR("A")="Are you signing for the Supervisor"
"RTN","OOPSWCE",100,0)
 S DIR("A",1)="The Supervisor has not signed the "_FORM_".  To continue"
"RTN","OOPSWCE",101,0)
 S DIR("A",2)="editing, you will need to sign as Supervisor."
"RTN","OOPSWCE",102,0)
 S DIR(0)="SBM^Y:Yes;N:No"
"RTN","OOPSWCE",103,0)
 D ^DIR
"RTN","OOPSWCE",104,0)
 I Y'="Y" S OUT=1
"RTN","OOPSWCE",105,0)
 Q
"RTN","OOPSWCE",106,0)
SUPSIGN ; Sign/validate Document
"RTN","OOPSWCE",107,0)
 N DIR,ES,SUPSIGN,VALID,Y
"RTN","OOPSWCE",108,0)
 S VALID=0
"RTN","OOPSWCE",109,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,"S",.VALID)
"RTN","OOPSWCE",110,0)
 I 'VALID S OUT=2 Q                     ; not valid, sup not signed
"RTN","OOPSWCE",111,0)
 S DIR("A")="Sign as Supervisor"
"RTN","OOPSWCE",112,0)
 S DIR(0)="SBM^Y:Yes;N:No"
"RTN","OOPSWCE",113,0)
 D ^DIR
"RTN","OOPSWCE",114,0)
 I Y'="Y" S OUT=2      ; sup 'signed, WC cant sign
"RTN","OOPSWCE",115,0)
 I Y="Y" D
"RTN","OOPSWCE",116,0)
 . S SUPSIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSWCE",117,0)
 . S ES=$S(FORM="CA1":"CA1ES",FORM="CA2":"CA2ES",1:0)
"RTN","OOPSWCE",118,0)
 . I $G(ES)'="" S $P(^OOPS(2260,IEN,ES),U,4,6)=SUPSIGN
"RTN","OOPSWCE",119,0)
 Q
"RTN","OOPSWCE",120,0)
SIGNS(FORM) ;
"RTN","OOPSWCE",121,0)
 N DA,DIE,DR,VALID
"RTN","OOPSWCE",122,0)
 S VALID=0,SIGN=""
"RTN","OOPSWCE",123,0)
 I '$P($$EDSTA^OOPSUTL1(IEN,"S"),U,CA) D  Q        ; Super hasn't signed
"RTN","OOPSWCE",124,0)
 . W !!,"Supervisor has not signed "_FORM
"RTN","OOPSWCE",125,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,"W",.VALID)
"RTN","OOPSWCE",126,0)
 I 'VALID Q
"RTN","OOPSWCE",127,0)
 N DIR,Y
"RTN","OOPSWCE",128,0)
 W !
"RTN","OOPSWCE",129,0)
 S DIR("A")="OK to transmit to DOL"
"RTN","OOPSWCE",130,0)
 S DIR(0)="SBM^Y:Yes;N:No"
"RTN","OOPSWCE",131,0)
 D ^DIR
"RTN","OOPSWCE",132,0)
 I Y="Y" S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSWCE",133,0)
 ; if signed, file and send bulletin
"RTN","OOPSWCE",134,0)
 I $P(SIGN,U) D
"RTN","OOPSWCE",135,0)
 . S DR="",DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSWCE",136,0)
 . S DR(1,2260,1)="67////^S X=$P(SIGN,U)"
"RTN","OOPSWCE",137,0)
 . S DR(1,2260,5)="68////^S X=$P(SIGN,U,2)"
"RTN","OOPSWCE",138,0)
 . S DR(1,2260,10)="69////^S X=$P(SIGN,U,3)"
"RTN","OOPSWCE",139,0)
 I $P(SIGN,U) D ^DIE,WCP^OOPSMBUL(IEN,"S")
"RTN","OOPSWCE",140,0)
 Q
"RTN","OOPSWCE",141,0)
CLRFLDS ; Clear Supervisor Signature fields
"RTN","OOPSWCE",142,0)
 N DR,DA,DIE
"RTN","OOPSWCE",143,0)
 ; Clear Supervisor Signature
"RTN","OOPSWCE",144,0)
 W !!,"Worker's Comp edit of special fields occurred, Supervisor"
"RTN","OOPSWCE",145,0)
 W !,"signature fields cleared, you will need to sign as Supervisor."
"RTN","OOPSWCE",146,0)
 D CLRES^OOPSUTL1(IEN,"S",FORM)
"RTN","OOPSWCE",147,0)
 ; If get in this subroutine, need to set flag that Super needs to
"RTN","OOPSWCE",148,0)
 ; be notified of edits even if user ^'s out
"RTN","OOPSWCE",149,0)
 S DR="",DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSWCE",150,0)
 S DR(1,2260,35)="199////Y"
"RTN","OOPSWCE",151,0)
 D ^DIE
"RTN","OOPSWCE",152,0)
 Q
"RTN","OOPSWCE",153,0)
SUPFLDS ; Get Supervisor signature related data for CA1 only
"RTN","OOPSWCE",154,0)
 I OUT Q
"RTN","OOPSWCE",155,0)
 N DR,DA,DIE,SUP
"RTN","OOPSWCE",156,0)
 S DR="",DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSWCE",157,0)
 ; Clear Super Title and Phone # and set DR array
"RTN","OOPSWCE",158,0)
 I FORM="CA1" D
"RTN","OOPSWCE",159,0)
 . S SUP=$$GET1^DIQ(200,DUZ,.01)
"RTN","OOPSWCE",160,0)
 . S $P(^OOPS(2260,IEN,"CA1L"),U,4,5)="^"
"RTN","OOPSWCE",161,0)
 . S DR(1,2260,1)="W !!,""       Worker's Compensation Signing for Supervisor"",!"
"RTN","OOPSWCE",162,0)
 . S DR(1,2260,5)="W !,""      Signature of Supervisor and Filing Instructions"""
"RTN","OOPSWCE",163,0)
 . S DR(1,2260,10)="W !,""      -----------------------------------------------"""
"RTN","OOPSWCE",164,0)
 . S DR(1,2260,15)="S ITEM=38 D EXCEPT^OOPSUTL2;168    EXCEPTION"
"RTN","OOPSWCE",165,0)
 . S DR(1,2260,16)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=168"
"RTN","OOPSWCE",166,0)
 . S DR(1,2260,20)="W !,""     NAME OF SUPERVISOR.: ""_SUP"
"RTN","OOPSWCE",167,0)
 . S DR(1,2260,25)="172     SUPERVISOR'S TITLE.;I X="""" S Y=172"
"RTN","OOPSWCE",168,0)
 . S DR(1,2260,26)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=172"
"RTN","OOPSWCE",169,0)
 . S DR(1,2260,30)="173     OFFICE PHONE.......;I X="""" S Y=173"
"RTN","OOPSWCE",170,0)
 . ; Patch 8 - added error checking on phone per DOL requirement
"RTN","OOPSWCE",171,0)
 . S DR(1,2260,35)="I $TR(X,""/-*#"","""")'?10N W !?3,""Phone number must include area code and 7 digits only.  Example 703-123-8789"" S Y=173"
"RTN","OOPSWCE",172,0)
 D ^DIE
"RTN","OOPSWCE",173,0)
 I ($D(Y)'=0)!($G(DIRUT)=1)  S OUT=2
"RTN","OOPSWCE",174,0)
 Q
"RTN","OOPSWCE",175,0)
CHGES(DONE) ; Verify changes have been made to controlled fields
"RTN","OOPSWCE",176,0)
 ; Can quit as soon as any change is discovered
"RTN","OOPSWCE",177,0)
 ;    Input -   none
"RTN","OOPSWCE",178,0)
 ;   Output -   DONE   if 1, at least 1 field edited, else no edits (0)
"RTN","OOPSWCE",179,0)
 ;
"RTN","OOPSWCE",180,0)
 N I,LINE,LP
"RTN","OOPSWCE",181,0)
 F I=146:1:149,163 D  Q:DONE
"RTN","OOPSWCE",182,0)
 . I $$GET1^DIQ(2260,IEN,I,"I")'=OOPS(2260,IEN,I,"I") S DONE=1 Q
"RTN","OOPSWCE",183,0)
 I 'DONE F I="CA1J","CA1K" I $D(OOPS(2260,IEN,I)) D  Q:DONE
"RTN","OOPSWCE",184,0)
 . S LINE=$P(^OOPS(2260,IEN,I,0),U,4)
"RTN","OOPSWCE",185,0)
 . I LINE'=$P(OOPS(2260,IEN,I,0),U,4) S DONE=1 Q
"RTN","OOPSWCE",186,0)
 . F LP=1:1:LINE D  Q:DONE
"RTN","OOPSWCE",187,0)
 .. I ^OOPS(2260,IEN,I,LP,0)'=OOPS(2260,IEN,I,LP,0) S DONE=1 Q
"RTN","OOPSWCE",188,0)
 Q DONE
"RTN","OOPSWCE1")
0^16^B53507295
"RTN","OOPSWCE1",1,0)
OOPSWCE1 ;WIOFO/LLH-Worker's Comp Edit CA1 ;3/23/2000
"RTN","OOPSWCE1",2,0)
 ;;1.0;ASISTS;**8,11**;Jun 01, 1998
"RTN","OOPSWCE1",3,0)
 ;;
"RTN","OOPSWCE1",4,0)
CA1 ; CA1 FORM
"RTN","OOPSWCE1",5,0)
 N CONT,ITEM,DTINJ,DT110,VWIT
"RTN","OOPSWCE1",6,0)
 S (AIEN,AGN,ADD,CITY,STATE,ZIP)=""
"RTN","OOPSWCE1",7,0)
 S (PNAME,PADD,PCITY,PSTATE,PZIP,PTITLE,STAT,SIEN)=""
"RTN","OOPSWCE1",8,0)
 S WCPDO=""
"RTN","OOPSWCE1",9,0)
 W !!," Federal Employee's Notice of Traumatic Injury and Claim"
"RTN","OOPSWCE1",10,0)
 W !," for Continuation of Pay/Compensation (Form CA-1)"
"RTN","OOPSWCE1",11,0)
 W !!,"     Witness"
"RTN","OOPSWCE1",12,0)
 W !,"     -------"
"RTN","OOPSWCE1",13,0)
 S DR=""
"RTN","OOPSWCE1",14,0)
 ; Patch 8 - DOL project.  Added collection of multiple witnesses
"RTN","OOPSWCE1",15,0)
 ; note: if Witness Statement entry ever allowed, max length = 528
"RTN","OOPSWCE1",16,0)
 S DR(2,2260.0125)=".01:5"
"RTN","OOPSWCE1",17,0)
 S DR(2,2260.0125,6)="6////SIGNED WITNESS STATEMENT TO FOLLOW."
"RTN","OOPSWCE1",18,0)
 S DR(1,2260,1)="125"         ; call to witness multiple
"RTN","OOPSWCE1",19,0)
 S DR(1,2260,2)="S VWIT=$$WIT^OOPSUTL3"
"RTN","OOPSWCE1",20,0)
 S DR(1,2260,3)="I +VWIT=0!($P(VWIT,U,2)=0) S Y=125"
"RTN","OOPSWCE1",21,0)
 S DR(1,2260,5)="W !!,""     Worker's Comp Edit of Supervisor's Report"""
"RTN","OOPSWCE1",22,0)
 S DR(1,2260,6)="W !,""       -------------------------------------"""
"RTN","OOPSWCE1",23,0)
 ; Patch 8 - added OWCP District Office
"RTN","OOPSWCE1",24,0)
 S WCPDO=$$GET1^DIQ(2262,"1,","2:.01","E")
"RTN","OOPSWCE1",25,0)
 S DR(1,2260,8)="73      OWCP DISTRICT OFFICE......//^S X=WCPDO"
"RTN","OOPSWCE1",26,0)
 ; Patch 11 - default chargeback code from site parameter file
"RTN","OOPSWCE1",27,0)
 S DR(1,2260,9)="70      OWCP CHARGEBACK CODE......//^S X=OWCP"
"RTN","OOPSWCE1",28,0)
 S DR(1,2260,10)="62      OWCP NOI CODE............."
"RTN","OOPSWCE1",29,0)
 ; Patch 8 - if CA1 NOI code must begin with T
"RTN","OOPSWCE1",30,0)
 S DR(1,2260,12)="I X,($E($$GET1^DIQ(2263.3,X,1))'=""T"") W !?3,""NOI Code must begin with a T for a CA1."" S Y=62"
"RTN","OOPSWCE1",31,0)
 ; Remove will generate Occ Code from PAID file
"RTN","OOPSWCE1",32,0)
 ; S DR(1,2260,13)="122 14a. OCCUPATION CODE..........."
"RTN","OOPSWCE1",33,0)
 S DR(1,2260,15)="123 14b. TYPE CODE................."
"RTN","OOPSWCE1",34,0)
 S DR(1,2260,20)="124 14c. SOURCE CODE..............."
"RTN","OOPSWCE1",35,0)
 D AGNINFO^OOPSUTL2
"RTN","OOPSWCE1",36,0)
 S DR(1,2260,25)="130 17.  AGENCY NAME...............//^S X=AGN;I X="""" S Y=""@5"""
"RTN","OOPSWCE1",37,0)
 S DR(1,2260,26)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=130"
"RTN","OOPSWCE1",38,0)
 S DR(1,2260,30)="131      STREET ADDRESS............//^S X=ADD"
"RTN","OOPSWCE1",39,0)
 S DR(1,2260,31)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=131"
"RTN","OOPSWCE1",40,0)
 S DR(1,2260,35)="132      CITY......................//^S X=CITY"
"RTN","OOPSWCE1",41,0)
 S DR(1,2260,36)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=132"
"RTN","OOPSWCE1",42,0)
 S DR(1,2260,40)="133      STATE.....................//^S X=STATE"
"RTN","OOPSWCE1",43,0)
 S DR(1,2260,45)="134      ZIP CODE..................//^S X=ZIP"
"RTN","OOPSWCE1",44,0)
 S DR(1,2260,50)="S Y=176"
"RTN","OOPSWCE1",45,0)
 S DR(1,2260,60)="@5"
"RTN","OOPSWCE1",46,0)
 S DR(1,2260,65)="131////@"
"RTN","OOPSWCE1",47,0)
 S DR(1,2260,70)="132////@"
"RTN","OOPSWCE1",48,0)
 S DR(1,2260,75)="133////@"
"RTN","OOPSWCE1",49,0)
 S DR(1,2260,80)="134////@"
"RTN","OOPSWCE1",50,0)
 S DR(1,2260,85)="176 18.  EMPLOYEE'S DUTY STATION..."
"RTN","OOPSWCE1",51,0)
 S DR(1,2260,86)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=176"
"RTN","OOPSWCE1",52,0)
 S DR(1,2260,90)="177      STREET ADDRESS............"
"RTN","OOPSWCE1",53,0)
 S DR(1,2260,91)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=177"
"RTN","OOPSWCE1",54,0)
 S DR(1,2260,95)="178      CITY......................"
"RTN","OOPSWCE1",55,0)
 S DR(1,2260,96)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=178"
"RTN","OOPSWCE1",56,0)
 S DR(1,2260,100)="179      STATE....................."
"RTN","OOPSWCE1",57,0)
 S DR(1,2260,105)="180      ZIP CODE.................."
"RTN","OOPSWCE1",58,0)
 S DR(1,2260,110)="60 19.  EMPLOYEE'S RETIREMENT.....//^S X=RET;I X<3 S Y=""@6"""
"RTN","OOPSWCE1",59,0)
 S DR(1,2260,115)="61      OTHER RETIREMENT.........."
"RTN","OOPSWCE1",60,0)
 S DR(1,2260,116)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=61"
"RTN","OOPSWCE1",61,0)
 S DR(1,2260,117)="S Y=""@7"""
"RTN","OOPSWCE1",62,0)
 S DR(1,2260,120)="@6"
"RTN","OOPSWCE1",63,0)
 S DR(1,2260,121)="61////@"
"RTN","OOPSWCE1",64,0)
 S DR(1,2260,122)="@7"
"RTN","OOPSWCE1",65,0)
 S DR(1,2260,125)="W !,"" 20.  REGULAR WORK HOURS:"""
"RTN","OOPSWCE1",66,0)
 S DR(1,2260,130)="138      FROM......................"
"RTN","OOPSWCE1",67,0)
 S DR(1,2260,135)="139      TO........................"
"RTN","OOPSWCE1",68,0)
 S DR(1,2260,140)="S ITEM=21 W !,"" 21.  REGULAR WORK SCHEDULE.....: ""_$$GET1^DIQ(2260,D0,140,""E"")"
"RTN","OOPSWCE1",69,0)
 S DR(1,2260,145)="K DIR S DIR(""A"")=""                                 "",DIR(""B"")=$$GET1^DIQ(2260,D0,140,""I"") D RWS^OOPSUTL2 S:$D(DIRUT) Y=""@2"""
"RTN","OOPSWCE1",70,0)
 ;
"RTN","OOPSWCE1",71,0)
 ; Default from 2162, require time entry but allow edit
"RTN","OOPSWCE1",72,0)
 S DTINJ=$$GET1^DIQ(2260,IEN,4,"E")
"RTN","OOPSWCE1",73,0)
 S DR(1,2260,150)="4 22.  DATE/TIME INJURY OCCURRED.......//^S X=DTINJ"
"RTN","OOPSWCE1",74,0)
 S DR(1,2260,155)="I $P(X,""."",2)="""" W !,""Time is REQUIRED in this response."" S Y=4"
"RTN","OOPSWCE1",75,0)
 ; Patch 8 - default from Date of This Notice
"RTN","OOPSWCE1",76,0)
 S DR(1,2260,159)="S DT110=$$GET1^DIQ(2260,IEN,110,""E"")"
"RTN","OOPSWCE1",77,0)
 S DR(1,2260,160)="175 23.  DATE OF NOTICE RECEIVED...//^S X=DT110"
"RTN","OOPSWCE1",78,0)
 S DR(1,2260,165)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=175"
"RTN","OOPSWCE1",79,0)
 S DR(1,2260,170)="142 24.  DATE/TIME STOPPED WORK...."
"RTN","OOPSWCE1",80,0)
 S DR(1,2260,175)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=142"
"RTN","OOPSWCE1",81,0)
 S DR(1,2260,180)="143 25.  DATE PAY STOPPED.........."
"RTN","OOPSWCE1",82,0)
 S DR(1,2260,185)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=143"
"RTN","OOPSWCE1",83,0)
 S DR(1,2260,190)="144 26.  DATE 45 DAY PERIOD BEGAN.."
"RTN","OOPSWCE1",84,0)
 S DR(1,2260,195)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=144"
"RTN","OOPSWCE1",85,0)
 S DR(1,2260,200)="145 27.  DATE/TIME RETURNED TO WORK"
"RTN","OOPSWCE1",86,0)
 S DR(1,2260,205)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=145"
"RTN","OOPSWCE1",87,0)
 S DR(1,2260,210)="146 28.  WAS EMPLOYEE INJURED IN PERFORMANCE OF DUTY;I X=""Y"" S Y=148;"
"RTN","OOPSWCE1",88,0)
 S DR(1,2260,215)="147      EXPLANATION"
"RTN","OOPSWCE1",89,0)
 S DR(1,2260,216)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=147"
"RTN","OOPSWCE1",90,0)
 S DR(1,2260,220)="148 29.  WAS INJURY CAUSED BY EMPLOYEE'S WILLFUL MISCONDUCT, INTOXICATION, OR            INTENT TO INJURE SELF OR ANOTHER;I X=""N"" S Y=150;"
"RTN","OOPSWCE1",91,0)
 S DR(1,2260,225)="149      EXPLANATION"
"RTN","OOPSWCE1",92,0)
 S DR(1,2260,226)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=149"
"RTN","OOPSWCE1",93,0)
 S DR(1,2260,230)="150 30.  WAS INJURY CAUSED BY 3RD PARTY;I X=""N"" S Y=""@1"""
"RTN","OOPSWCE1",94,0)
 S DR(1,2260,235)="W !,"" 31.  NAME AND ADDRESS OF THIRD PARTY:"""
"RTN","OOPSWCE1",95,0)
 S DR(1,2260,240)="151      NAME OF THIRD PARTY.......;I X="""" S Y=""@1"""
"RTN","OOPSWCE1",96,0)
 S DR(1,2260,241)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=151"
"RTN","OOPSWCE1",97,0)
 S DR(1,2260,245)="152      STREET ADDRESS............"
"RTN","OOPSWCE1",98,0)
 S DR(1,2260,246)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=152"
"RTN","OOPSWCE1",99,0)
 S DR(1,2260,250)="153      CITY......................"
"RTN","OOPSWCE1",100,0)
 S DR(1,2260,251)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=153"
"RTN","OOPSWCE1",101,0)
 S DR(1,2260,255)="154      STATE....................."
"RTN","OOPSWCE1",102,0)
 S DR(1,2260,256)="155      ZIP CODE.................."
"RTN","OOPSWCE1",103,0)
 S DR(1,2260,257)="S Y=""@8"""
"RTN","OOPSWCE1",104,0)
 S DR(1,2260,258)="@1"
"RTN","OOPSWCE1",105,0)
 S DR(1,2260,259)="151////@"
"RTN","OOPSWCE1",106,0)
 S DR(1,2260,260)="152////@"
"RTN","OOPSWCE1",107,0)
 S DR(1,2260,261)="153////@"
"RTN","OOPSWCE1",108,0)
 S DR(1,2260,262)="154////@"
"RTN","OOPSWCE1",109,0)
 S DR(1,2260,263)="155////@"
"RTN","OOPSWCE1",110,0)
 S DR(1,2260,266)="@8"
"RTN","OOPSWCE1",111,0)
 S DR(1,2260,270)="W !,"" 32.  NAME AND ADDRESS OF PHYSICIAN FIRST PROVIDING MEDICAL CARE:"""
"RTN","OOPSWCE1",112,0)
 D PHINFO^OOPSUTL2
"RTN","OOPSWCE1",113,0)
 S DR(1,2260,275)="156      NAME OF PHYSICIAN.........//^S X=PNAME;I X="""" S Y=""@4"""
"RTN","OOPSWCE1",114,0)
 S DR(1,2260,276)="I X'="""",'$$NMCHK^OOPSUTL3(X) D NMERR^OOPSUTL3 K X S Y=156"
"RTN","OOPSWCE1",115,0)
 S DR(1,2260,280)="157      STREET ADDRESS............//^S X=PADD"
"RTN","OOPSWCE1",116,0)
 S DR(1,2260,281)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=157"
"RTN","OOPSWCE1",117,0)
 S DR(1,2260,285)="158      CITY......................//^S X=PCITY"
"RTN","OOPSWCE1",118,0)
 S DR(1,2260,286)="I X'="""",'$$VCHAR^OOPSUTL4(X) D VCHAR^OOPSUTL2 S Y=158"
"RTN","OOPSWCE1",119,0)
 S DR(1,2260,290)="159      STATE.....................//^S X=PSTATE"
"RTN","OOPSWCE1",120,0)
 S DR(1,2260,295)="160      ZIP CODE..................//^S X=PZIP"
"RTN","OOPSWCE1",121,0)
 S DR(1,2260,296)="182      TITLE.....................//^S X=PTITLE"
"RTN","OOPSWCE1",122,0)
 S DR(1,2260,300)="S Y=161"
"RTN","OOPSWCE1",123,0)
 S DR(1,2260,305)="@4"
"RTN","OOPSWCE1",124,0)
 S DR(1,2260,310)="157////@"
"RTN","OOPSWCE1",125,0)
 S DR(1,2260,315)="158////@"
"RTN","OOPSWCE1",126,0)
 S DR(1,2260,320)="159////@"
"RTN","OOPSWCE1",127,0)
 S DR(1,2260,325)="160////@"
"RTN","OOPSWCE1",128,0)
 S DR(1,2260,326)="182////@"
"RTN","OOPSWCE1",129,0)
 S DR(1,2260,330)="161 33.  1ST DATE MEDICAL CARE RECEIVED"
"RTN","OOPSWCE1",130,0)
 S DR(1,2260,335)="I X'="""",'$$FUT^OOPSUTL4(X) S Y=161"
"RTN","OOPSWCE1",131,0)
 S DR(1,2260,340)="162 34.  DO MEDICAL REPORTS SHOW EMPLOYEE IS DISABLED FOR WORK"
"RTN","OOPSWCE1",132,0)
 S DR(1,2260,345)="163 35.  DOES YOUR KNOWLEDGE OF THE FACTS AGREE WITH STATEMENTS OF THE EMPLOYEE;I X=""Y"" S Y=165.1"
"RTN","OOPSWCE1",133,0)
 S DR(1,2260,350)="164      EXPLANATION~"
"RTN","OOPSWCE1",134,0)
 S DR(1,2260,351)="S MAX=$$WP^OOPSUTL4(164)"
"RTN","OOPSWCE1",135,0)
 S DR(1,2260,352)="I '$P(MAX,U,2) D VCHAR^OOPSUTL2 S Y=164"
"RTN","OOPSWCE1",136,0)
 S DR(1,2260,353)="I +MAX>MAX1 W !!,""Max length for field is "",MAX1,"" characters, you have entered "",+MAX,"".  Please Edit."",! S Y=164"
"RTN","OOPSWCE1",137,0)
 S DR(1,2260,355)="W !"
"RTN","OOPSWCE1",138,0)
 ; Patch 8 - added by TAG
"RTN","OOPSWCE1",139,0)
 S DR(1,2260,356)="165.1 36a.  DOES THE AGENCY CONTROVERT THIS CLAIM;S CONT=X"
"RTN","OOPSWCE1",140,0)
 S DR(1,2260,357)="165.2 36b.  DOES THE AGENCY DISPUTE THIS CLAIM..."
"RTN","OOPSWCE1",141,0)
 S DR(1,2260,358)="I X'=""Y""&(CONT'=""Y"") S Y=""@9"""
"RTN","OOPSWCE1",142,0)
 S DR(1,2260,360)="165 36.  IF THE EMPLOYING AGENCY CONTROVERTS CONTINUATION OF PAY, STATE THE REASON       IN DETAIL~"
"RTN","OOPSWCE1",143,0)
 S DR(1,2260,361)="S MAX=$$WP^OOPSUTL4(165)"
"RTN","OOPSWCE1",144,0)
 S DR(1,2260,362)="I '$P(MAX,U,2) D VCHAR^OOPSUTL2 S Y=165"
"RTN","OOPSWCE1",145,0)
 S DR(1,2260,363)="I +MAX>MAX1 W !!,""Max length for field is "",MAX1,"" characters, you have entered "",+MAX,"".  Please Edit."",! S Y=165"
"RTN","OOPSWCE1",146,0)
 S DR(1,2260,364)="@9"
"RTN","OOPSWCE1",147,0)
 S DR(1,2260,365)="W !!,"" 37.  PAY RATE WHEN EMPLOYEE STOPPED WORK:"""
"RTN","OOPSWCE1",148,0)
 S DR(1,2260,370)="166      $.........................//^S X=SAL"
"RTN","OOPSWCE1",149,0)
 S DR(1,2260,375)="167      PER.......................//^S X=PAY"
"RTN","OOPSWCE1",150,0)
 S DR(1,2260,380)="174 39.  FILING INSTRUCTIONS"
"RTN","OOPSWCE1",151,0)
 S DR(1,2260,385)="@2"
"RTN","OOPSWCE1",152,0)
EXIT ;
"RTN","OOPSWCE1",153,0)
 K I,ITEM
"RTN","OOPSWCE1",154,0)
 Q
"RTN","OOPSWCE2")
0^17^B55983187
"RTN","OOPSWCE2",1,0)
OOPSWCE2 ;WIOFO/LLH-Worker's Comp CA2 Edit routine ;03/23/00
"RTN","OOPSWCE2",2,0)
 ;;1.0;ASISTS;**8,11**;Jun 01, 1998
"RTN","OOPSWCE2",3,0)
 ;;
"RTN","OOPSWCE2",4,0)
CA2 ; CA2 FORM
"RTN","OOPSWCE2",5,0)
 N ITEM
"RTN","OOPSWCE2",6,0)
 S (AIEN,AGN,ADD,CITY,STATE,ZIP)=""
"RTN","OOPSWCE2",7,0)
 S (PNAME,PADD,PCITY,PSTATE,PZIP,PTITLE,STAT,SIEN)=""
"RTN","OOPSWCE2",8,0)
 S WCPDO=""
"RTN","OOPSWCE2",9,0)
 W !!," Notice of Occupational Disease and Claim for Compensation (Form CA-2)"
"RTN","OOPSWCE2",10,0)
 W !!,"    Worker's Comp Edit of the Supervisor's Report"
"RTN","OOPSWCE2",11,0)
 W !,"       ----------------------------------------",!
"RTN","OOPSWCE2",12,0)
 D AGNINFO^OOPSUTL2
"RTN","OOPSWCE2",13,0)
 S DR=""
"RTN","OOPSWCE2",14,0)
 ; Patch 8 - added OWCP District Office
"RTN","OOPSWCE2",15,0)
 S WCPDO=$$GET1^DIQ(2262,"1,","2:.01","E")
"RTN","OOPSWCE2",16,0)
 S DR(1,2260,1)="73      OWCP DISTRICT OFFICE......//^S X=WCPDO"
"RTN","OOPSWCE2",17,0)
 ; Patch 11 - default chargeback code from site parameter file
"RTN","OOPSWCE2",18,0)
 S DR(1,2260,2)="70      OWCP CHARGEBACK CODE......//^S X=OWCP"
"RTN","OOPSWCE2",19,0)
 S DR(1,2260,3)="62      OWCP NOI CODE............."
"RTN","OOPSWCE2",20,0)
 ; Patch 8 - NOI code cannot begin with a T if CA2
"RTN","OOPSWCE2",21,0)
 S DR(1,2260,8)="I X,($E($$GET1^DIQ(2263.3,X,1))=""T"") W !?3,""NOI Code cannot begin with a T for a CA2."" S Y=62"
"RTN","OOPSWCE2",22,0)
 ; Removed, will generate from PAID file
"RTN","OOPSWCE2",23,0)
 ; S DR(1,2260,7)="224 9a.  OCCUPATION CODE..............."
"RTN","OOPSWCE2",24,0)
 S DR(1,2260,9)="226 14b. TYPE CODE....................."
"RTN","OOPSWCE2",25,0)
 S DR(1,2260,10)="227 14c. SOURCE CODE..................."
"RTN","OOPSWCE2",26,0)
 S DR(1,2260,15)="230 19.  AGENCY NAME...................//^S X=AGN;I X="""" S Y=""@5"""
"RTN","OOPSWCE2",27,0)
 S DR(1,2260,16)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=230"
"RTN","OOPSWCE2",28,0)
 S DR(1,2260,20)="231      STREET ADDRESS................//^S X=ADD"
"RTN","OOPSWCE2",29,0)
 S DR(1,2260,21)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=231"
"RTN","OOPSWCE2",30,0)
 S DR(1,2260,25)="232      CITY..........................//^S X=CITY"
"RTN","OOPSWCE2",31,0)
 S DR(1,2260,26)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=232"
"RTN","OOPSWCE2",32,0)
 S DR(1,2260,30)="233      STATE.........................//^S X=STATE"
"RTN","OOPSWCE2",33,0)
 S DR(1,2260,35)="234      AGENCY ZIP CODE...............//^S X=ZIP"
"RTN","OOPSWCE2",34,0)
 S DR(1,2260,40)="S Y=237"
"RTN","OOPSWCE2",35,0)
 S DR(1,2260,45)="@5"
"RTN","OOPSWCE2",36,0)
 S DR(1,2260,50)="231////@"
"RTN","OOPSWCE2",37,0)
 S DR(1,2260,55)="232////@"
"RTN","OOPSWCE2",38,0)
 S DR(1,2260,60)="233////@"
"RTN","OOPSWCE2",39,0)
 S DR(1,2260,65)="234////@"
"RTN","OOPSWCE2",40,0)
 S DR(1,2260,70)="237 20.  EMPLOYEE'S DUTY STATION......."
"RTN","OOPSWCE2",41,0)
 S DR(1,2260,72)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=237"
"RTN","OOPSWCE2",42,0)
 S DR(1,2260,75)="238      STREET ADDRESS................"
"RTN","OOPSWCE2",43,0)
 S DR(1,2260,76)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=238"
"RTN","OOPSWCE2",44,0)
 S DR(1,2260,80)="239      CITY.........................."
"RTN","OOPSWCE2",45,0)
 S DR(1,2260,82)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=239"
"RTN","OOPSWCE2",46,0)
 S DR(1,2260,85)="240      STATE........................."
"RTN","OOPSWCE2",47,0)
 S DR(1,2260,90)="241      ZIP CODE......................"
"RTN","OOPSWCE2",48,0)
 S DR(1,2260,95)="W !,"" 21.  REGULAR WORK HOURS:"""
"RTN","OOPSWCE2",49,0)
 S DR(1,2260,100)="242      FROM.........................."
"RTN","OOPSWCE2",50,0)
 S DR(1,2260,105)="243      TO............................"
"RTN","OOPSWCE2",51,0)
 S DR(1,2260,110)="S ITEM=22 W !,"" 22.  REGULAR WORK SCHEDULE.........: ""_$$GET1^DIQ(2260,D0,244,""E"")"
"RTN","OOPSWCE2",52,0)
 S DR(1,2260,115)="K DIR S DIR(""A"")=""                                     "",DIR(""B"")=$$GET1^DIQ(2260,D0,244,""I"") D RWS^OOPSUTL2 S:$D(DIRUT) Y=""@2"""
"RTN","OOPSWCE2",53,0)
 S DR(1,2260,120)="W !,"" 23.  NAME AND ADDRESS OF PHYSICIAN FIRST PROVIDING MEDICAL CARE"""
"RTN","OOPSWCE2",54,0)
 ;Patch 7 - default physician info - if physician deleted, del oth flds
"RTN","OOPSWCE2",55,0)
 D PHINFO^OOPSUTL2
"RTN","OOPSWCE2",56,0)
 S DR(1,2260,125)="245      NAME OF PHYSICIAN.............//^S X=PNAME;I X="""" S Y=""@4"""
"RTN","OOPSWCE2",57,0)
 S DR(1,2260,126)="I X'="""",'$$NMCHK^OOPSUTL3(X) D NMERR^OOPSUTL3 K X S Y=245"
"RTN","OOPSWCE2",58,0)
 S DR(1,2260,130)="246      STREET ADDRESS................//^S X=PADD"
"RTN","OOPSWCE2",59,0)
 S DR(1,2260,131)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=246"
"RTN","OOPSWCE2",60,0)
 S DR(1,2260,135)="247      CITY..........................//^S X=PCITY"
"RTN","OOPSWCE2",61,0)
 S DR(1,2260,136)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=247"
"RTN","OOPSWCE2",62,0)
 S DR(1,2260,140)="248      STATE.........................//^S X=STATE"
"RTN","OOPSWCE2",63,0)
 S DR(1,2260,145)="249      ZIP CODE......................//^S X=PZIP"
"RTN","OOPSWCE2",64,0)
 S DR(1,2260,150)="270      PHYSICIAN TITLE...............//^S X=PTITLE"
"RTN","OOPSWCE2",65,0)
 S DR(1,2260,155)="S Y=250"
"RTN","OOPSWCE2",66,0)
 S DR(1,2260,160)="@4"
"RTN","OOPSWCE2",67,0)
 S DR(1,2260,165)="246////@"
"RTN","OOPSWCE2",68,0)
 S DR(1,2260,170)="247////@"
"RTN","OOPSWCE2",69,0)
 S DR(1,2260,175)="248////@"
"RTN","OOPSWCE2",70,0)
 S DR(1,2260,180)="249////@"
"RTN","OOPSWCE2",71,0)
 S DR(1,2260,181)="270////@"
"RTN","OOPSWCE2",72,0)
 S DR(1,2260,185)="250 24.  1ST DATE MEDICAL CARE RECEIVED"
"RTN","OOPSWCE2",73,0)
 S DR(1,2260,190)="I X'="""",'$$FUT^OOPSUTL4(X) S Y=250"
"RTN","OOPSWCE2",74,0)
 S DR(1,2260,195)="251 25.  DO MEDICAL REPORTS SHOW EMPLOYEE IS DISABLED FOR WORK"
"RTN","OOPSWCE2",75,0)
 S DR(1,2260,200)="252 26.  DATE EMPLOYEE FIRST REPORTED CONDITION TO SUPERVISOR."
"RTN","OOPSWCE2",76,0)
 S DR(1,2260,205)="I X'="""",'$$FUT^OOPSUTL4(X) S Y=252"
"RTN","OOPSWCE2",77,0)
 S DR(1,2260,210)="253 27.  DATE/TIME EMPLOYEE STOPPED WORK.."
"RTN","OOPSWCE2",78,0)
 S DR(1,2260,215)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=253"
"RTN","OOPSWCE2",79,0)
 S DR(1,2260,220)="254 28.  DATE/TIME EMPLOYEE'S PAY STOPPED."
"RTN","OOPSWCE2",80,0)
 S DR(1,2260,225)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=254"
"RTN","OOPSWCE2",81,0)
 S DR(1,2260,230)="255 29.  DATE EMPLOYEE WAS LAST EXPOSED TO CONDITIONS ALLEGED TO HAVE CAUSED             DISEASE OR ILLNESS..............."
"RTN","OOPSWCE2",82,0)
 S DR(1,2260,235)="256 30.  DATE/TIME RETURNED TO WORK......."
"RTN","OOPSWCE2",83,0)
 S DR(1,2260,240)="I X'="""",'$$FUT^OOPSUTL4($P(X,""."")) S Y=256"
"RTN","OOPSWCE2",84,0)
 S DR(1,2260,245)="@3"
"RTN","OOPSWCE2",85,0)
 S DR(1,2260,250)="W !,"" 31.  IF EMPLOYEE HAS RETURNED TO WORK AND WORK ASSIGNMENT HAS CHANGED, DESCRIBE      NEW DUTIES"""
"RTN","OOPSWCE2",86,0)
 S DR(1,2260,255)="257      DESCRIPTION~"
"RTN","OOPSWCE2",87,0)
 S DR(1,2260,260)="W !"
"RTN","OOPSWCE2",88,0)
 S DR(1,2260,261)="S MAX=$$WP^OOPSUTL4(257)"
"RTN","OOPSWCE2",89,0)
 S DR(1,2260,262)="I '$P(MAX,U,2) W !,""Invalid character entered, (~,`,@ ,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=257"
"RTN","OOPSWCE2",90,0)
 S DR(1,2260,263)="I +MAX>MAX1 W !!,""Max length for field is "",MAX1,"" characters, you have entered "",+MAX,"".  Please Edit."",! S Y=257"
"RTN","OOPSWCE2",91,0)
 S DR(1,2260,265)="60 32.  EMPLOYEE'S RETIREMENT.........//^S X=RET;I X<3 S Y=""@6"""
"RTN","OOPSWCE2",92,0)
 S DR(1,2260,266)="61      OTHER RETIREMENT.............."
"RTN","OOPSWCE2",93,0)
 S DR(1,2260,267)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=61"
"RTN","OOPSWCE2",94,0)
 S DR(1,2260,268)="S Y=""@7"""
"RTN","OOPSWCE2",95,0)
 S DR(1,2260,269)="@6"
"RTN","OOPSWCE2",96,0)
 S DR(1,2260,270)="61////@"
"RTN","OOPSWCE2",97,0)
 S DR(1,2260,275)="@7"
"RTN","OOPSWCE2",98,0)
 S DR(1,2260,280)="258 33.  WAS INJURY CAUSED BY 3RD PARTY;I X=""N"" S Y=""@1"""
"RTN","OOPSWCE2",99,0)
 S DR(1,2260,285)="259 34.  NAME OF THIRD PARTY..........."
"RTN","OOPSWCE2",100,0)
 S DR(1,2260,286)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=259"
"RTN","OOPSWCE2",101,0)
 S DR(1,2260,290)="260      STREET ADDRESS................"
"RTN","OOPSWCE2",102,0)
 S DR(1,2260,291)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=260"
"RTN","OOPSWCE2",103,0)
 S DR(1,2260,295)="261      CITY.........................."
"RTN","OOPSWCE2",104,0)
 S DR(1,2260,296)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=261"
"RTN","OOPSWCE2",105,0)
 S DR(1,2260,300)="262      STATE........................."
"RTN","OOPSWCE2",106,0)
 S DR(1,2260,301)="263      ZIP CODE......................"
"RTN","OOPSWCE2",107,0)
 S DR(1,2260,302)="S Y=""@8"""
"RTN","OOPSWCE2",108,0)
 S DR(1,2260,303)="@1"
"RTN","OOPSWCE2",109,0)
 S DR(1,2260,304)="259////@"
"RTN","OOPSWCE2",110,0)
 S DR(1,2260,305)="260////@"
"RTN","OOPSWCE2",111,0)
 S DR(1,2260,306)="261////@"
"RTN","OOPSWCE2",112,0)
 S DR(1,2260,307)="262////@"
"RTN","OOPSWCE2",113,0)
 S DR(1,2260,308)="263////@"
"RTN","OOPSWCE2",114,0)
 S DR(1,2260,309)="@8"
"RTN","OOPSWCE2",115,0)
 ; Super has Signed, will not need re-signing - go to @2
"RTN","OOPSWCE2",116,0)
 S DR(1,2260,315)="I CASIGN S Y=""@2"""
"RTN","OOPSWCE2",117,0)
 S DR(1,2260,320)="S SUP=$$GET1^DIQ(200,DUZ,.01)"
"RTN","OOPSWCE2",118,0)
 S DR(1,2260,325)="W !!,""      Workers Comp signing for Supervisor"""
"RTN","OOPSWCE2",119,0)
 S DR(1,2260,330)="W !,""           Signature of Supervisor"""
"RTN","OOPSWCE2",120,0)
 S DR(1,2260,335)="W !,""       -----------------------------------"""
"RTN","OOPSWCE2",121,0)
 S DR(1,2260,340)="S ITEM=35 D EXCEPT^OOPSUTL2;264      EXCEPTION"
"RTN","OOPSWCE2",122,0)
 S DR(1,2260,341)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=264"
"RTN","OOPSWCE2",123,0)
 S DR(1,2260,345)="W !,""      NAME OF SUPERVISOR: ""_SUP"
"RTN","OOPSWCE2",124,0)
 S DR(1,2260,350)="268      SUPERVISOR'S TITLE"
"RTN","OOPSWCE2",125,0)
 S DR(1,2260,351)="I X'="""",'$$VCHAR^OOPSUTL4(X) W !,""Invalid character entered, (~,`,@,#,$,%,^,*,_,|,\,},{,[,],>, or <),"",!,""please edit."",! S Y=268"
"RTN","OOPSWCE2",126,0)
 S DR(1,2260,355)="269      OFFICE PHONE......"
"RTN","OOPSWCE2",127,0)
 ; Patch 8 - Phone must be 10 Numeric after stripping -
"RTN","OOPSWCE2",128,0)
 S DR(1,2260,356)="I $TR(X,""/-*#"","""")'?10N W !?3,""Phone number must include area code and 7 digits only.  Example 703-123-8789"" S Y=269"
"RTN","OOPSWCE2",129,0)
 S DR(1,2260,360)="@2"
"RTN","OOPSWCE2",130,0)
 Q
"RTN","OOPSXP11")
0^6^B2927070
"RTN","OOPSXP11",1,0)
OOPSXP11 ;WIOFO/LLH-INIT ROUTINE FOR PATCH 11 ;3/5/2001 
"RTN","OOPSXP11",2,0)
 ;;1.0;ASISTS;**11**;Jun 01, 1998
"RTN","OOPSXP11",3,0)
 ;
"RTN","OOPSXP11",4,0)
PRE ;
"RTN","OOPSXP11",5,0)
 N MSG,SAF,PMSG
"RTN","OOPSXP11",6,0)
 S MSG(1)=" "
"RTN","OOPSXP11",7,0)
 S MSG(2)="The SAFETY DEVICE USED Field (#43) in the ASISTS ACCIDENT REPORTING "
"RTN","OOPSXP11",8,0)
 S MSG(3)="File (#2260) has been changed. Unknown has been removed as a "
"RTN","OOPSXP11",9,0)
 S MSG(4)="valid code for this field. All records with Unknown will be "
"RTN","OOPSXP11",10,0)
 S MSG(5)="changed to 'N'o."
"RTN","OOPSXP11",11,0)
 ;
"RTN","OOPSXP11",12,0)
 I $$PATCH^XPDUTL("OOPS*1.0*11") D  Q
"RTN","OOPSXP11",13,0)
 . D BMES^XPDUTL("  Skipping pre install since patch was previously installed.")
"RTN","OOPSXP11",14,0)
 D BMES^XPDUTL("Data Conversion in Progress...") H 1
"RTN","OOPSXP11",15,0)
 D MES^XPDUTL(.MSG) H 2
"RTN","OOPSXP11",16,0)
 ;
"RTN","OOPSXP11",17,0)
LOOP ; Loop thru 2260 and change as described above.
"RTN","OOPSXP11",18,0)
 N IEN,DR,DA,DIE,SAF
"RTN","OOPSXP11",19,0)
 S IEN=0,DIE="^OOPS(2260,"
"RTN","OOPSXP11",20,0)
 F  S IEN=$O(^OOPS(2260,IEN)) Q:IEN'>0  D
"RTN","OOPSXP11",21,0)
 . S SAF=$P($G(^OOPS(2260,IEN,"2162D")),U,8)
"RTN","OOPSXP11",22,0)
 . I $G(SAF)="U" S $P(^OOPS(2260,IEN,"2162D"),U,8)="N" D
"RTN","OOPSXP11",23,0)
 .. D MES^XPDUTL("Safety Device changed from Unknown to No for this case "_$$GET1^DIQ(2260,IEN,.01,"E"))
"RTN","OOPSXP11",24,0)
 ; also need to change the type for Suture Needlestick in ^OOPS(2261.7
"RTN","OOPSXP11",25,0)
 K DA,DIE,DR
"RTN","OOPSXP11",26,0)
 S DIE="^OOPS(2261.7,"
"RTN","OOPSXP11",27,0)
 S DA=7,DR="2///^S X=""S""" D ^DIE
"RTN","OOPSXP11",28,0)
 S DA=12,DR="2///^S X=""S""" D ^DIE
"RTN","OOPSXP11",29,0)
 S DA=19,DR="2///^S X=""N""" D ^DIE
"RTN","OOPSXP11",30,0)
 Q
"UP",2260,2260.01,-1)
2260^2162F
"UP",2260,2260.01,0)
2260.01
"UP",2260,2260.028,-1)
2260^2162C
"UP",2260,2260.028,0)
2260.028
"UP",2260,2260.039,-1)
2260^2162E
"UP",2260,2260.039,0)
2260.039
"UP",2262,2262.03,-1)
2262^1
"UP",2262,2262.03,0)
2262.03
"VER")
8.0^22
"^DD",2260,2260,5,0)
SSN^FXO^^2162A;1^S X=$TR(X,"-","") K:$L(X)>9!($L(X)<9)!'(X?9N)!'(X) X
"^DD",2260,2260,5,.1)
      SSN
"^DD",2260,2260,5,1,0)
^.1
"^DD",2260,2260,5,1,1,0)
2260^SSN
"^DD",2260,2260,5,1,1,1)
S ^OOPS(2260,"SSN",$E(X,1,30),DA)=""
"^DD",2260,2260,5,1,1,2)
K ^OOPS(2260,"SSN",$E(X,1,30),DA)
"^DD",2260,2260,5,1,1,"DT")
2980407
"^DD",2260,2260,5,2)
S Y(0)=Y S Y=$E(Y,1,3)_"-"_$E(Y,4,5)_"-"_$E(Y,6,9)
"^DD",2260,2260,5,2.1)
S Y=$E(Y,1,3)_"-"_$E(Y,4,5)_"-"_$E(Y,6,9)
"^DD",2260,2260,5,3)
Answer must be 9 characters in length.
"^DD",2260,2260,5,21,0)
^.001^2^2^3000403^^
"^DD",2260,2260,5,21,1,0)
This is the Social Security Number of the person involved in this
"^DD",2260,2260,5,21,2,0)
incident.
"^DD",2260,2260,5,"DT")
3010625
"^DD",2260,2260,28,0)
DESCRIPTION OF INCIDENT^2260.028^^2162C;0
"^DD",2260,2260,28,21,0)
^.001^3^3^3010702^^^^
"^DD",2260,2260,28,21,1,0)
This information fully narrates the accident or incident.  It explains
"^DD",2260,2260,28,21,2,0)
what led up to the accident, how the accident happened, equipment
"^DD",2260,2260,28,21,3,0)
failures, material defects, etc.
"^DD",2260,2260,29,0)
CHARACTERIZATION OF INJURY^P2261'^OOPS(2261,^2162B;3^Q
"^DD",2260,2260,29,.1)
CHARACTERIZATION OF INJURY 
"^DD",2260,2260,29,3)
Enter the best description of the injury.
"^DD",2260,2260,29,21,0)
^^1^1^2980409^
"^DD",2260,2260,29,21,1,0)
This is the general description of the injury.
"^DD",2260,2260,29,"DT")
3010306
"^DD",2260,2260,30.1,0)
ADDITIONAL BODY PART AFFECTED^*P2261.1'X^OOPS(2261.1,^2162B;8^S DIC("S")="I "",0,3,5,6,7,8,9,10,11,12,13,14,15,16,17,21,22,27,31,""'[("",""_$P(^(0),U,2)_"","")" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",2260,2260,30.1,.1)
ADD. BODY PART AFFECTED
"^DD",2260,2260,30.1,3)
Enter an additional body part that was affected by the injury.
"^DD",2260,2260,30.1,12)
THIS CODE IS NO LONGER A VALID SELECTION, PLEASE ENTER A VALID CODE.
"^DD",2260,2260,30.1,12.1)
S DIC("S")="I "",0,3,5,6,7,8,9,10,11,12,13,14,15,16,17,21,22,27,31,""'[("",""_$P(^(0),U,2)_"","")"
"^DD",2260,2260,30.1,21,0)
^.001^3^3^3000308^^^^
"^DD",2260,2260,30.1,21,1,0)

"^DD",2260,2260,30.1,21,2,0)
Enter an additional body part that was affected by the injury.
"^DD",2260,2260,30.1,21,3,0)

"^DD",2260,2260,30.1,"DT")
3000321
"^DD",2260,2260,32,0)
DUTY RETURNED TO^S^F:Full duty;L:Light duty;^2162B;6^Q
"^DD",2260,2260,32,.1)
DUTY RETURNED TO 
"^DD",2260,2260,32,3)
Did the employee return to light or full duty?
"^DD",2260,2260,32,21,0)
^^1^1^2980409^
"^DD",2260,2260,32,21,1,0)
The employee returned to either light or full duty.
"^DD",2260,2260,32,"DT")
3010306
"^DD",2260,2260,34,0)
PATIENT SOURCE^S^I:Identifiable;U:Unidentifiable;N:NA;^2162D;1^Q
"^DD",2260,2260,34,.1)
PATIENT SOURCE 
"^DD",2260,2260,34,3)
Was the source patient identifiable?
"^DD",2260,2260,34,21,0)
^^2^2^2980409^
"^DD",2260,2260,34,21,1,0)
This defines whether or not the source patient of the body fluid exposure
"^DD",2260,2260,34,21,2,0)
(including needlestick and sharps) is identifiable.
"^DD",2260,2260,34,"DT")
3010306
"^DD",2260,2260,35,0)
CONTAMINATION^S^Y:Yes;N:No;U:Unknown;^2162D;2^Q
"^DD",2260,2260,35,.1)
CONTAMINATION 
"^DD",2260,2260,35,3)
Was the needle or sharp contaminated?
"^DD",2260,2260,35,21,0)
^^1^1^2980413^
"^DD",2260,2260,35,21,1,0)
This states whether or not the needle or sharp was contaminated.
"^DD",2260,2260,35,"DT")
3010306
"^DD",2260,2260,36,0)
PURPOSE OF SHARP OBJECT^P2261.5'^OOPS(2261.5,^2162D;3^Q
"^DD",2260,2260,36,.1)
PURPOSE OF SHARP OBJ.
"^DD",2260,2260,36,3)
Enter the original purpose for the sharp item.
"^DD",2260,2260,36,21,0)
^^1^1^2980617^^
"^DD",2260,2260,36,21,1,0)
The sharp item was originally used for this purpose.
"^DD",2260,2260,36,"DT")
3010306
"^DD",2260,2260,37,0)
ACTIVITY AT TIME OF INJURY^P2261.6'^OOPS(2261.6,^2162D;4^Q
"^DD",2260,2260,37,.1)
ACTIVITY AT TIME OF INJURY 
"^DD",2260,2260,37,3)
What was happening when the injury occurred?
"^DD",2260,2260,37,21,0)
^^1^1^2980413^
"^DD",2260,2260,37,21,1,0)
This is the activity when the injury occurred.
"^DD",2260,2260,37,"DT")
3010306
"^DD",2260,2260,38,0)
OBJECT CAUSING INJURY^*P2261.7'X^OOPS(2261.7,^2162D;5^S DIC("S")="I $P(^(0),U,2)'=16" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",2260,2260,38,.1)
OBJECT CAUSING INJURY 
"^DD",2260,2260,38,3)
Enter the device or item that caused the injury.
"^DD",2260,2260,38,12)
This selection is no longer valid, Please select another device.
"^DD",2260,2260,38,12.1)
S DIC("S")="I $P(^(0),U,2)'=16"
"^DD",2260,2260,38,21,0)
^.001^1^1^3010305^^^^
"^DD",2260,2260,38,21,1,0)
This is the device or item that caused the injury.
"^DD",2260,2260,38,"DT")
3010306
"^DD",2260,2260,39,0)
AREA EXPOSED TO BODILY FLUID^2260.039SA^^2162E;0
"^DD",2260,2260,39,21,0)
^.001^1^1^3010702^^^^
"^DD",2260,2260,39,21,1,0)
This is a description of the exposed body parts. 
"^DD",2260,2260,40,0)
PERSONAL PROTECTIVE EQUIPMENT^2260.01PA^^2162F;0
"^DD",2260,2260,40,21,0)
^.001^2^2^3010702^^^^
"^DD",2260,2260,40,21,1,0)
This is a description of the protective items worn at the time of the
"^DD",2260,2260,40,21,2,0)
exposure.
"^DD",2260,2260,41,0)
BODILY FLUID EXPOSURE SOURCE^P2261.8'^OOPS(2261.8,^2162D;6^Q
"^DD",2260,2260,41,.1)
BODILY FLUID EXPOSURE SOURCE 
"^DD",2260,2260,41,3)
How was the employee exposed?
"^DD",2260,2260,41,21,0)
^^1^1^2980429^^
"^DD",2260,2260,41,21,1,0)
This explains how the exposure happened.
"^DD",2260,2260,41,"DT")
3010306
"^DD",2260,2260,42,0)
EQUIPMENT/DEVICE FAILURE^F^^2162D;7^K:$L(X)>80!($L(X)<3) X
"^DD",2260,2260,42,.1)
EQUIP/DEVICE FAILURE
"^DD",2260,2260,42,3)
Answer must be 3-80 characters in length.
"^DD",2260,2260,42,21,0)
^^2^2^2991118^^
"^DD",2260,2260,42,21,1,0)
If there was an equipment, device or product failure, this is the type of
"^DD",2260,2260,42,21,2,0)
equipment and manufacturer name.
"^DD",2260,2260,42,"DT")
3010306
"^DD",2260,2260,43,0)
SAFETY DESIGN DEVICE USED^SX^Y:Yes;N:No;^2162D;8^Q
"^DD",2260,2260,43,.1)
SAFETY DESIGN DEVICE USED 
"^DD",2260,2260,43,3)
Was a safety design device used?
"^DD",2260,2260,43,21,0)
^.001^1^1^3010305^^
"^DD",2260,2260,43,21,1,0)
This states whether or not a safety device was used.
"^DD",2260,2260,43,"DT")
3010306
"^DD",2260,2260,51,0)
CASE STATUS^S^0:Open;1:Closed;2:Deleted;3:Replaced by amendment;^0;6^Q
"^DD",2260,2260,51,1,0)
^.1
"^DD",2260,2260,51,1,1,0)
^^TRIGGER^2260^54
"^DD",2260,2260,51,1,1,1)
X ^DD(2260,51,1,1,1.3) I X S X=DIV S Y(1)=$S($D(^OOPS(2260,D0,0)):^(0),1:"") S X=$P(Y(1),U,18),X=X S DIU=X K Y S X=DIV S X=DT S DIH=$G(^OOPS(2260,DIV(0),0)),DIV=X S $P(^(0),U,18)=DIV,DIH=2260,DIG=54 D ^DICR
"^DD",2260,2260,51,1,1,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(2260,51,1,1,69.2) S X=X="Closed",Y(2)=X S X=$P(Y(3),U,5)'="",Y=X,X=Y(2),X=X&Y,Y(4)=X S X=$P(Y(5),U,11)="",Y=X,X=Y(4),X=X&Y
"^DD",2260,2260,51,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^OOPS(2260,D0,0)):^(0),1:"") S X=$P(Y(1),U,18),X=X S DIU=X K Y S X="" S DIH=$G(^OOPS(2260,DIV(0),0)),DIV=X S $P(^(0),U,18)=DIV,DIH=2260,DIG=54 D ^DICR
"^DD",2260,2260,51,1,1,69.2)
S Y(1)=$C(59)_$P($G(^DD(2260,51,0)),U,3),Y(5)=$S($D(^OOPS(2260,D0,0)):^(0),1:""),Y(3)=$S($D(^("2162ES")):^("2162ES"),1:"") S X=$P($P(Y(1),$C(59)_Y(0)_":",2),$C(59),1)
"^DD",2260,2260,51,1,1,"%D",0)
^.101^5^5^3010620^^^
"^DD",2260,2260,51,1,1,"%D",1,0)
This trigger sets Today's date into NEEDS XMIT TO NDB field (#54) when the 
"^DD",2260,2260,51,1,1,"%D",2,0)
CASE STATUS (#51) is Closed, the Safety Officer has signed the 2162 
"^DD",2260,2260,51,1,1,"%D",3,0)
(SAFETY OFF. ELECT. SIGNATURE #49), and the DATE TRANSMITTED (#57) is blank.
"^DD",2260,2260,51,1,1,"%D",4,0)
By setting a value in the NEEDS XMIT TO NDB field, the cross reference ("AN")
"^DD",2260,2260,51,1,1,"%D",5,0)
used for transmitting 2162 cases to the NDB is set.
"^DD",2260,2260,51,1,1,"CREATE CONDITION")
(CASE STATUS="Closed")&(SAFETY OFF. ELECT. SIGNATURE'="")&(DATE TRANSMITTED TO NDB="")
"^DD",2260,2260,51,1,1,"CREATE VALUE")
TODAY
"^DD",2260,2260,51,1,1,"DELETE VALUE")
@
"^DD",2260,2260,51,1,1,"DT")
3010620
"^DD",2260,2260,51,1,1,"FIELD")
NEEDS XMIT TO NDB
"^DD",2260,2260,51,3)
Enter the status of this case.
"^DD",2260,2260,51,21,0)
^.001^1^1^3010712^^^^
"^DD",2260,2260,51,21,1,0)
This is the status of the case.
"^DD",2260,2260,51,"DT")
3010620
"^DD",2260,2260,54,0)
NEEDS XMIT TO NDB^DI^^0;18^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2260,2260,54,1,0)
^.1^^-1
"^DD",2260,2260,54,1,1,0)
2260^AN^MUMPS
"^DD",2260,2260,54,1,1,1)
S ^OOPS(2260,"AN",$E(X,1,30),DA)=""
"^DD",2260,2260,54,1,1,2)
K ^OOPS(2260,"AN",$E(X,1,30),DA)
"^DD",2260,2260,54,1,1,"%D",0)
^.101^2^2^3010620^^^^
"^DD",2260,2260,54,1,1,"%D",1,0)
This Xref will contain the date that the case was closed with
"^DD",2260,2260,54,1,1,"%D",2,0)
the safety officer's signature.
"^DD",2260,2260,54,1,1,"DT")
3010613
"^DD",2260,2260,54,3)
Enter date to transmit case to NDB.
"^DD",2260,2260,54,5,1,0)
2260^51^1
"^DD",2260,2260,54,5,2,0)
2260^59^1
"^DD",2260,2260,54,21,0)
^^2^2^3010613^
"^DD",2260,2260,54,21,1,0)
This is the date that the case was determined to be valid for transmission to
"^DD",2260,2260,54,21,2,0)
NDB.
"^DD",2260,2260,54,"DT")
3010620
"^DD",2260,2260,57,0)
DATE TRANSMITTED TO NDB^DI^^0;11^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",2260,2260,57,1,0)
^.1
"^DD",2260,2260,57,1,1,0)
2260^ANC^MUMPS
"^DD",2260,2260,57,1,1,1)
S ^OOPS(2260,"ANC",$E(X,1,30),DA)=""
"^DD",2260,2260,57,1,1,2)
K ^OOPS(2260,"ANC",$E(X,1,30),DA)
"^DD",2260,2260,57,1,1,"%D",0)
^.101^1^1^3010615^^^
"^DD",2260,2260,57,1,1,"%D",1,0)
This index will contain the date the case was transmitted to NDB. 
"^DD",2260,2260,57,1,1,"DT")
3010613
"^DD",2260,2260,57,1,2,0)
^^TRIGGER^2260^59
"^DD",2260,2260,57,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^OOPS(2260,D0,0)):^(0),1:"") S X=$P(Y(1),U,19),X=X S DIU=X K Y S X=DIV S X="Y" S DIH=$G(^OOPS(2260,DIV(0),0)),DIV=X S $P(^(0),U,19)=DIV,DIH=2260,DIG=59 D ^DICR
"^DD",2260,2260,57,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^OOPS(2260,D0,0)):^(0),1:"") S X=$P(Y(1),U,19),X=X S DIU=X K Y S X="" S DIH=$G(^OOPS(2260,DIV(0),0)),DIV=X S $P(^(0),U,19)=DIV,DIH=2260,DIG=59 D ^DICR
"^DD",2260,2260,57,1,2,"%D",0)
^^6^6^3010620^
"^DD",2260,2260,57,1,2,"%D",1,0)
This trigger sets the TRANSMITTED TO NDB field (#59) to 'Y'es when the DATE
"^DD",2260,2260,57,1,2,"%D",2,0)
TRANSMITTED TO NDB field (#57) is entered or a blank if the DATE TRANSMITTED
"^DD",2260,2260,57,1,2,"%D",3,0)
TO NDB is deleted.  By setting a value in the TRANSMITTED TO NDB field (#59)
"^DD",2260,2260,57,1,2,"%D",4,0)
the trigger in the TRANSMITTED TO NDB field (#59) is executed which either sets
"^DD",2260,2260,57,1,2,"%D",5,0)
or deletes the entry in the NEEDS XMIT TO NDB field (#54) which updates the
"^DD",2260,2260,57,1,2,"%D",6,0)
"AN" cross reference.
"^DD",2260,2260,57,1,2,"CREATE VALUE")
"Y"
"^DD",2260,2260,57,1,2,"DELETE VALUE")
@
"^DD",2260,2260,57,1,2,"DT")
3010620
"^DD",2260,2260,57,1,2,"FIELD")
TRANSMITTED TO NDB
"^DD",2260,2260,57,9)
^
"^DD",2260,2260,57,21,0)
^^4^4^2991129^^
"^DD",2260,2260,57,21,1,0)
 
"^DD",2260,2260,57,21,2,0)
The value in this field will be the last time the closed case 2162 data 
"^DD",2260,2260,57,21,3,0)
was transmitted to the NDB. If the case is closed, transmitted, then 
"^DD",2260,2260,57,21,4,0)
re-opened, this field is 'blanked' so that retransmission will be triggered.
"^DD",2260,2260,57,"DT")
3010620
"^DD",2260,2260,59,0)
TRANSMITTED TO NDB^SI^Y:YES;N:NO;^0;19^Q
"^DD",2260,2260,59,1,0)
^.1
"^DD",2260,2260,59,1,1,0)
^^TRIGGER^2260^54
"^DD",2260,2260,59,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^OOPS(2260,D0,0)):^(0),1:"") S X=$P(Y(1),U,18),X=X S DIU=X K Y S X="" S DIH=$G(^OOPS(2260,DIV(0),0)),DIV=X S $P(^(0),U,18)=DIV,DIH=2260,DIG=54 D ^DICR
"^DD",2260,2260,59,1,1,2)
Q
"^DD",2260,2260,59,1,1,"%D",0)
^.101^4^4^3010620^^
"^DD",2260,2260,59,1,1,"%D",1,0)
This field is set to 'Y'es when the DATE TRANSMITTED TO NDB field (#57) is 
"^DD",2260,2260,59,1,1,"%D",2,0)
entered and a blank when the DATE TRANSMITTED TO NDB field (#57) is deleted.
"^DD",2260,2260,59,1,1,"%D",3,0)
When setting this field to 'Y', the value in the NEEDS XMIT TO NDB field (#54) 
"^DD",2260,2260,59,1,1,"%D",4,0)
is blanked and the entry in it's cross reference ("AN") is updated (removed).  
"^DD",2260,2260,59,1,1,"CREATE VALUE")
@
"^DD",2260,2260,59,1,1,"DELETE VALUE")
NO EFFECT
"^DD",2260,2260,59,1,1,"FIELD")
NEEDS XMIT TO NDB
"^DD",2260,2260,59,3)
Enter "Y" if 2162 has been transmitted to NDB, "N" if it hasn't.
"^DD",2260,2260,59,5,1,0)
2260^57^2
"^DD",2260,2260,59,9)
^
"^DD",2260,2260,59,"DT")
3010712
"^DD",2260,2260,82,0)
BRAND^P2262.3^OOPS(2262.3,^2162B;10^Q
"^DD",2260,2260,82,.1)
BRAND 
"^DD",2260,2260,82,3)
Select the Brand of the Device used during the Incident
"^DD",2260,2260,82,21,0)
^.001^2^2^3010712^^^^
"^DD",2260,2260,82,21,1,0)
This is the manufacturer of the device that was being used at the time
"^DD",2260,2260,82,21,2,0)
the incident occurred.
"^DD",2260,2260,82,"DT")
3010607
"^DD",2260,2260,83,0)
DEVICE SIZE^*P2262.2'X^OOPS(2262.2,^2162B;11^S DIC("S")="I $$DEVSZ^OOPSUTL2(DA,Y)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",2260,2260,83,.1)
   DEVICE SIZE
"^DD",2260,2260,83,3)
Enter the DEVICE SIZE of the object that caused the injury.
"^DD",2260,2260,83,12)
Only valid selections are shown.
"^DD",2260,2260,83,12.1)
S DIC("S")="I $$DEVSZ^OOPSUTL2(DA,Y)"
"^DD",2260,2260,83,21,0)
^.001^1^1^3010306^^^^
"^DD",2260,2260,83,21,1,0)
Enter the DEVICE SIZE of the object that caused the injury.
"^DD",2260,2260,83,"DT")
3010306
"^DD",2260,2260,84,0)
SAFETY CHARACTERISTICS^P2261.9'^OOPS(2261.9,^2162B;12^Q
"^DD",2260,2260,84,.1)
SAFETY DEV CHARACTERISTICS
"^DD",2260,2260,84,3)
Enter the SAFETY CHARACTERISTICS for the device.
"^DD",2260,2260,84,21,0)
^.001^1^1^3010305^^^
"^DD",2260,2260,84,21,1,0)
Enter the appropriate ENGINEERED SAFETY CHARACTERISTICS.
"^DD",2260,2260,84,"DT")
3010305
"^DD",2260,2260,85,0)
SAFETY DEVICE NOT USED^F^^2162S;1^K:$L(X)>250!($L(X)<3) X
"^DD",2260,2260,85,.1)
   EXPLAIN WHY SAFETY DEVICE NOT USED
"^DD",2260,2260,85,3)
Answer must be 3-250 characters in length.  Enter the reason the Safety Device was not used.
"^DD",2260,2260,85,21,0)
^.001^1^1^3010305^^
"^DD",2260,2260,85,21,1,0)
Enter the reason that a safety device was not used during this incident.
"^DD",2260,2260,85,"DT")
3010306
"^DD",2260,2260,86,0)
SERVICE^P49'^DIC(49,^0;17^Q
"^DD",2260,2260,86,.1)
   SERVICE
"^DD",2260,2260,86,3)
Enter the individual's Service area.
"^DD",2260,2260,86,21,0)
^^1^1^3010305^
"^DD",2260,2260,86,21,1,0)
This is the individual's service area at the time of the incident.
"^DD",2260,2260,86,"DT")
3010306
"^DD",2260,2260,87,0)
INJ PRIOR TO SAFE DEV ENGAGED^S^Y:Yes;N:No;^2162B;13^Q
"^DD",2260,2260,87,3)
Enter "Yes" if the injury occurred before the safety device engaged, otherwise enter a "No".
"^DD",2260,2260,87,21,0)
^.001^2^2^3010530^^
"^DD",2260,2260,87,21,1,0)
This field will indicate whether the safety device on the object that caused 
"^DD",2260,2260,87,21,2,0)
the injury engaged before the injury occurred.
"^DD",2260,2260,87,"DT")
3010712
"^DD",2260,2260,214,0)
DATE FIRST AWARE OF ILLNESS^DX^^CA2B;6^S %DT="ETX",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X I $G(X),$$FMDIFF^XLFDT(X,$$GET1^DIQ(2260,DA,6,"I"),2)<0 D EN^DDIOL("DATE OF BIRTH cannot be after DATE FIRST AWARE OF ILLNESS","","!!?5") K X
"^DD",2260,2260,214,.1)
11. DATE YOU FIRST BECAME AWARE OF DISEASE OR ILLNESS
"^DD",2260,2260,214,3)
Enter the date you first became aware of the disease/illness.
"^DD",2260,2260,214,21,0)
^^2^2^2980410^
"^DD",2260,2260,214,21,1,0)
This is the date you (the employee) were first aware of the disease or
"^DD",2260,2260,214,21,2,0)
illness.
"^DD",2260,2260,214,"DT")
3010705
"^DD",2260,2260,215,0)
DATE FIRST REALIZED CAUSE^DX^^CA2B;7^S %DT="EX",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X I $G(X),$P($G(^OOPS(2260,DA,"CA2B")),U,6)\1>X D EN^DDIOL("DATE FIRST REALIZED CAUSE cannot be prior to DATE FIRST AWARE OF ILLNESS","","!!?5") K X
"^DD",2260,2260,215,.1)
12. DATE YOU FIRST REALIZED THE DISEASE OR ILLNESS WAS CAUSED
"^DD",2260,2260,215,3)
Enter the date you first realized the illness was caused by your work.
"^DD",2260,2260,215,21,0)
^.001^2^2^3000331^^^
"^DD",2260,2260,215,21,1,0)
This is the date you (the employee) first realized the disease or illness
"^DD",2260,2260,215,21,2,0)
was caused by your employment.
"^DD",2260,2260,215,"DT")
3010625
"^DD",2260,2260,250,0)
FIRST DATE MEDICAL CARE^DX^^CA2J;6^S %DT="EX",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X I $G(X),$P($G(^OOPS(2260,DA,"CA2B")),U,6)\1>X D EN^DDIOL("FIRST DATE MEDICAL CARE cannot be prior to DATE FIRST AWARE OF ILLNESS","","!!?5") K X
"^DD",2260,2260,250,.1)
24 1ST DATE MEDICAL CARE RECEIVED
"^DD",2260,2260,250,3)
Enter the date the employee first received medical care.
"^DD",2260,2260,250,21,0)
^^2^2^2980413^
"^DD",2260,2260,250,21,1,0)
This is the date the employee first received medical care for the
"^DD",2260,2260,250,21,2,0)
condition.
"^DD",2260,2260,250,"DT")
3010625
"^DD",2260,2260,252,0)
DATE NOTICE RECEIVED^DX^^CA2J;8^S %DT="EX",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X I $G(X),$P($G(^OOPS(2260,DA,"CA2B")),U,6)\1>X D EN^DDIOL("DATE NOTICE RECEIVED cannot be prior to DATE FIRST AWARE OF ILLNESS","","!!?5") K X
"^DD",2260,2260,252,.1)
26. DATE EMPLOYEE FIRST REPORTED CONDITION TO SUPERVISOR
"^DD",2260,2260,252,3)
Enter the date you were first notified by the employee of the condition.
"^DD",2260,2260,252,21,0)
^.001^2^2^3000403^^
"^DD",2260,2260,252,21,1,0)
This is the date the employee first reported the condition to the
"^DD",2260,2260,252,21,2,0)
supervisor.
"^DD",2260,2260,252,"DT")
3010625
"^DD",2260,2260,253,0)
DATE/TIME WORK STOPPED^DX^^CA2J;9^S %DT="ETR",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X I $G(X),$P($G(^OOPS(2260,DA,"CA2B")),U,6)>X D EN^DDIOL("DATE/TIME WORK STOPPED cannot be prior to DATE FIRST AWARE OF ILLNESS","","!!?5") K X
"^DD",2260,2260,253,3)
Enter the date and time the employee stopped work.
"^DD",2260,2260,253,21,0)
^^1^1^2980430^^
"^DD",2260,2260,253,21,1,0)
This is the date and time the employee stopped work due to the condition.
"^DD",2260,2260,253,"DT")
3010625
"^DD",2260,2260,255,0)
DATE OF LAST EXPOSURE^DX^^CA2J;11^S %DT="EX",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X I $G(X),$P($G(^OOPS(2260,DA,"CA2B")),U,5)\1>X D EN^DDIOL("DATE OF LAST EXPOSURE cannot be prior to DATE FIRST AWARE OF ILLNESS","","!!?5") K X
"^DD",2260,2260,255,.1)
29. DATE OF LAST EXPOSURE
"^DD",2260,2260,255,3)
Enter the date the employee was last exposed to conditions.
"^DD",2260,2260,255,21,0)
^.001^2^2^3000403^^
"^DD",2260,2260,255,21,1,0)
This is the date the employee was last exposed to conditions alleged to
"^DD",2260,2260,255,21,2,0)
have caused the disease or illness.
"^DD",2260,2260,255,"DT")
3010625
"^DD",2260,2260.01,0)
PERSONAL PROTECTIVE EQUIPMENT SUB-FIELD^^.01^1
"^DD",2260,2260.01,0,"NM","PERSONAL PROTECTIVE EQUIPMENT")

"^DD",2260,2260.01,.01,0)
PERSONAL PROTECTIVE EQUIPMENT^MP2261.3'^OOPS(2261.3,^0;1^Q
"^DD",2260,2260.01,.01,.1)
PERSONAL PROTECTIVE EQUIPMENT 
"^DD",2260,2260.01,.01,1,0)
^.1
"^DD",2260,2260.01,.01,1,1,0)
2260.01^B
"^DD",2260,2260.01,.01,1,1,1)
S ^OOPS(2260,DA(1),"2162F","B",$E(X,1,30),DA)=""
"^DD",2260,2260.01,.01,1,1,2)
K ^OOPS(2260,DA(1),"2162F","B",$E(X,1,30),DA)
"^DD",2260,2260.01,.01,3)
Enter the protective items worn at the time of the exposure.
"^DD",2260,2260.01,.01,21,0)
^.001^1^1^3010702^^^^
"^DD",2260,2260.01,.01,21,1,0)
This is a list of the protective items worn at the time of the exposure.
"^DD",2260,2260.01,.01,"DT")
3010306
"^DD",2260,2260.028,0)
DESCRIPTION OF INCIDENT SUB-FIELD^^.01^1
"^DD",2260,2260.028,0,"DT")
2980408
"^DD",2260,2260.028,0,"NM","DESCRIPTION OF INCIDENT")

"^DD",2260,2260.028,0,"UP")
2260
"^DD",2260,2260.028,.01,0)
DESCRIPTION OF INCIDENT^W^^0;1^Q
"^DD",2260,2260.028,.01,.1)
DESCRIPTION OF INCIDENT 
"^DD",2260,2260.028,.01,3)
Provide information to fully narrate the incident.
"^DD",2260,2260.028,.01,"DT")
2980504
"^DD",2260,2260.039,0)
AREA EXPOSED TO BODILY FLUID SUB-FIELD^^.01^1
"^DD",2260,2260.039,0,"NM","AREA EXPOSED TO BODILY FLUID")

"^DD",2260,2260.039,.01,0)
AREA EXPOSED TO BODILY FLUID^MS^S:Skin;E:Eyes (conjunctiva);N:Nose (mucosa);M:Mouth (mucosa);O:Other;B:Both Eyes and Mouth;^0;1^Q
"^DD",2260,2260.039,.01,.1)
AREA EXPOSED TO BODILY FLUID 
"^DD",2260,2260.039,.01,1,0)
^.1
"^DD",2260,2260.039,.01,1,1,0)
2260.039^B
"^DD",2260,2260.039,.01,1,1,1)
S ^OOPS(2260,DA(1),"2162E","B",$E(X,1,30),DA)=""
"^DD",2260,2260.039,.01,1,1,2)
K ^OOPS(2260,DA(1),"2162E","B",$E(X,1,30),DA)
"^DD",2260,2260.039,.01,3)
Enter the exposed body part(s).
"^DD",2260,2260.039,.01,21,0)
^^1^1^2991129^^^^
"^DD",2260,2260.039,.01,21,1,0)
This is a description of the exposed body parts.
"^DD",2260,2260.039,.01,"DT")
3010306
"^DD",2261.7,2261.7,0)
FIELD^^2^3
"^DD",2261.7,2261.7,0,"DDA")
N
"^DD",2261.7,2261.7,0,"DT")
2980408
"^DD",2261.7,2261.7,0,"IX","B",2261.7,.01)

"^DD",2261.7,2261.7,0,"IX","C",2261.7,1)

"^DD",2261.7,2261.7,0,"IX","D",2261.7,.01)

"^DD",2261.7,2261.7,0,"NM","ASISTS DEVICE/EQUIPMENT")

"^DD",2261.7,2261.7,0,"PT",2260,38)

"^DD",2261.7,2261.7,0,"VRPK")
ASISTS
"^DD",2261.7,2261.7,.01,0)
NAME^RF^^0;1^K:$L(X)>90!($L(X)<3)!'(X'?1P.E) X
"^DD",2261.7,2261.7,.01,1,0)
^.1
"^DD",2261.7,2261.7,.01,1,1,0)
2261.7^B
"^DD",2261.7,2261.7,.01,1,1,1)
S ^OOPS(2261.7,"B",$E(X,1,30),DA)=""
"^DD",2261.7,2261.7,.01,1,1,2)
K ^OOPS(2261.7,"B",$E(X,1,30),DA)
"^DD",2261.7,2261.7,.01,1,2,0)
2261.7^D^MUMPS
"^DD",2261.7,2261.7,.01,1,2,1)
S ^OOPS(2261.7,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)=""
"^DD",2261.7,2261.7,.01,1,2,2)
K ^OOPS(2261.7,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)
"^DD",2261.7,2261.7,.01,1,2,"%D",0)
^^2^2^2980505^^
"^DD",2261.7,2261.7,.01,1,2,"%D",1,0)
This cross-reference allows selection of entries by upper-case
"^DD",2261.7,2261.7,.01,1,2,"%D",2,0)
values.
"^DD",2261.7,2261.7,.01,1,2,"DT")
2980505
"^DD",2261.7,2261.7,.01,3)
Answer must be 3-90 characters in length.
"^DD",2261.7,2261.7,.01,21,0)
^^2^2^2980317^^
"^DD",2261.7,2261.7,.01,21,1,0)
Enter a Device/Equipment that will identify
"^DD",2261.7,2261.7,.01,21,2,0)
a sharps exposure item.
"^DD",2261.7,2261.7,.01,"DT")
2980505
"^DD",2261.7,2261.7,1,0)
CODE^NJ3,0^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2261.7,2261.7,1,1,0)
^.1
"^DD",2261.7,2261.7,1,1,1,0)
2261.7^C
"^DD",2261.7,2261.7,1,1,1,1)
S ^OOPS(2261.7,"C",$E(X,1,30),DA)=""
"^DD",2261.7,2261.7,1,1,1,2)
K ^OOPS(2261.7,"C",$E(X,1,30),DA)
"^DD",2261.7,2261.7,1,1,1,"DT")
2980311
"^DD",2261.7,2261.7,1,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",2261.7,2261.7,1,21,0)
^^2^2^2980310^^
"^DD",2261.7,2261.7,1,21,1,0)
Enter a code that will identify a sharps exposure
"^DD",2261.7,2261.7,1,21,2,0)
item.
"^DD",2261.7,2261.7,1,"DT")
2980311
"^DD",2261.7,2261.7,2,0)
TYPE^S^S:Sharp;N:Needlestick;^0;3^Q
"^DD",2261.7,2261.7,2,"DT")
2980408
"^DD",2261.9,2261.9,0)
FIELD^^1^2
"^DD",2261.9,2261.9,0,"DDA")
N
"^DD",2261.9,2261.9,0,"DT")
3010302
"^DD",2261.9,2261.9,0,"IX","B",2261.9,.01)

"^DD",2261.9,2261.9,0,"NM","ASISTS SAFETY CHARACTERISTICS")

"^DD",2261.9,2261.9,0,"PT",2260,84)

"^DD",2261.9,2261.9,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",2261.9,2261.9,.01,.1)
CHARACTERISTIC NAME
"^DD",2261.9,2261.9,.01,1,0)
^.1^^-1
"^DD",2261.9,2261.9,.01,1,1,0)
2261.9^B
"^DD",2261.9,2261.9,.01,1,1,1)
S ^OOPS(2261.9,"B",$E(X,1,30),DA)=""
"^DD",2261.9,2261.9,.01,1,1,2)
K ^OOPS(2261.9,"B",$E(X,1,30),DA)
"^DD",2261.9,2261.9,.01,3)
Answer must be 3-30 characters in length.
"^DD",2261.9,2261.9,.01,21,0)
^.001^2^2^3010307^^
"^DD",2261.9,2261.9,.01,21,1,0)
This file contains valid responses to the Engineered Safety Characteristics
"^DD",2261.9,2261.9,.01,21,2,0)
field.
"^DD",2261.9,2261.9,.01,"DT")
3010311
"^DD",2261.9,2261.9,1,0)
CODE^RNJ2,0^^0;2^K:+X'=X!(X>10)!(X<1)!(X?.E1"."1N.N) X
"^DD",2261.9,2261.9,1,3)
Type a Number between 1 and 10, 0 Decimal Digits
"^DD",2261.9,2261.9,1,"DT")
3010302
"^DD",2262,2262.03,.7,0)
OWCP CHARGEBACK CODE^P2263.6'^OOPS(2263.6,^0;8^Q
"^DD",2262,2262.03,.7,3)
Enter the OWCP CHARGEBACK CODE to be used as the default in the Workers' Comp menu.
"^DD",2262,2262.03,.7,21,0)
^.001^3^3^3010516^^^
"^DD",2262,2262.03,.7,21,1,0)
This field will be used as the default value, if entered, for populating
"^DD",2262,2262.03,.7,21,2,0)
the OWCP CHARGEBACK CODE entered on the CA1/CA2 from the Workers'
"^DD",2262,2262.03,.7,21,3,0)
Compensation Menu.
"^DD",2262,2262.03,.7,"DT")
3010516
"^DD",2262.2,2262.2,0)
FIELD^^1^2
"^DD",2262.2,2262.2,0,"DDA")
N
"^DD",2262.2,2262.2,0,"DT")
3010529
"^DD",2262.2,2262.2,0,"IX","B",2262.2,.01)

"^DD",2262.2,2262.2,0,"IX","C",2262.2,1)

"^DD",2262.2,2262.2,0,"NM","ASISTS DEVICE SIZE")

"^DD",2262.2,2262.2,0,"PT",2260,83)

"^DD",2262.2,2262.2,.01,0)
NAME^RF^^0;1^K:$L(X)>5!($L(X)<1) X
"^DD",2262.2,2262.2,.01,1,0)
^.1
"^DD",2262.2,2262.2,.01,1,1,0)
2262.2^B
"^DD",2262.2,2262.2,.01,1,1,1)
S ^OOPS(2262.2,"B",$E(X,1,30),DA)=""
"^DD",2262.2,2262.2,.01,1,1,2)
K ^OOPS(2262.2,"B",$E(X,1,30),DA)
"^DD",2262.2,2262.2,.01,3)
Answer must be 1-5 characters in length.
"^DD",2262.2,2262.2,.01,"DT")
3010529
"^DD",2262.2,2262.2,1,0)
TYPE^RS^N:Needle;S:Syringe;NS:Needle or Syringe;^0;2^Q
"^DD",2262.2,2262.2,1,1,0)
^.1
"^DD",2262.2,2262.2,1,1,1,0)
2262.2^C
"^DD",2262.2,2262.2,1,1,1,1)
S ^OOPS(2262.2,"C",$E(X,1,30),DA)=""
"^DD",2262.2,2262.2,1,1,1,2)
K ^OOPS(2262.2,"C",$E(X,1,30),DA)
"^DD",2262.2,2262.2,1,1,1,"DT")
3010302
"^DD",2262.2,2262.2,1,3)

"^DD",2262.2,2262.2,1,21,0)
^.001^2^2^3010529^^^^
"^DD",2262.2,2262.2,1,21,1,0)
This file contains valid device size selections for OBJECTS CAUSING INJURY
"^DD",2262.2,2262.2,1,21,2,0)
field (#38) whose description contains either the word Needle or Syringe.
"^DD",2262.2,2262.2,1,"DT")
3010306
"^DD",2262.3,2262.3,0)
FIELD^^.01^1
"^DD",2262.3,2262.3,0,"DDA")
N
"^DD",2262.3,2262.3,0,"DT")
3010608
"^DD",2262.3,2262.3,0,"IX","B",2262.3,.01)

"^DD",2262.3,2262.3,0,"NM","ASISTS NEEDLESTICK BRANDS")

"^DD",2262.3,2262.3,0,"PT",2260,82)

"^DD",2262.3,2262.3,.01,0)
BRAND NAME^RF^^0;1^K:$L(X)>65!($L(X)<3)!'(X'?1P.E) X
"^DD",2262.3,2262.3,.01,.1)
  BRAND NAME
"^DD",2262.3,2262.3,.01,1,0)
^.1
"^DD",2262.3,2262.3,.01,1,1,0)
2262.3^B
"^DD",2262.3,2262.3,.01,1,1,1)
S ^OOPS(2262.3,"B",$E(X,1,65),DA)=""
"^DD",2262.3,2262.3,.01,1,1,2)
K ^OOPS(2262.3,"B",$E(X,1,65),DA)
"^DD",2262.3,2262.3,.01,3)
Answer must be 3-65 characters in length.
"^DD",2262.3,2262.3,.01,21,0)
^^2^2^3010607^
"^DD",2262.3,2262.3,.01,21,1,0)
This is the brand name of the device involved in a needlestick or sharps
"^DD",2262.3,2262.3,.01,21,2,0)
incident.
"^DD",2262.3,2262.3,.01,"DT")
3010608
"^DIC",2261.7,2261.7,0)
ASISTS DEVICE/EQUIPMENT^2261.7
"^DIC",2261.7,2261.7,0,"GL")
^OOPS(2261.7,
"^DIC",2261.7,2261.7,"%D",0)
^^3^3^2980414^^
"^DIC",2261.7,2261.7,"%D",1,0)
This file contains a list of terms used in describing the device or item
"^DIC",2261.7,2261.7,"%D",2,0)
that caused the injury.  File data is exported with the package and should
"^DIC",2261.7,2261.7,"%D",3,0)
not be edited by the site.
"^DIC",2261.7,"B","ASISTS DEVICE/EQUIPMENT",2261.7)

"^DIC",2261.9,2261.9,0)
ASISTS SAFETY CHARACTERISTICS^2261.9
"^DIC",2261.9,2261.9,0,"GL")
^OOPS(2261.9,
"^DIC",2261.9,2261.9,"%",0)
^1.005^^
"^DIC",2261.9,2261.9,"%D",0)
^^2^2^3010308^
"^DIC",2261.9,2261.9,"%D",1,0)
This file contains valid responses for describing the safety characteristics
"^DIC",2261.9,2261.9,"%D",2,0)
of the device that was being used when the incident occurred.
"^DIC",2261.9,"B","ASISTS SAFETY CHARACTERISTICS",2261.9)

"^DIC",2262.2,2262.2,0)
ASISTS DEVICE SIZE^2262.2
"^DIC",2262.2,2262.2,0,"GL")
^OOPS(2262.2,
"^DIC",2262.2,2262.2,"%",0)
^1.005^^
"^DIC",2262.2,2262.2,"%D",0)
^^3^3^3010531^^
"^DIC",2262.2,2262.2,"%D",1,0)
This file contains valid device sizes for the needle or syringe, if the object
"^DIC",2262.2,2262.2,"%D",2,0)
causing injury were either one.  Needle size would be the gauge and syringe
"^DIC",2262.2,2262.2,"%D",3,0)
size would be cc. 
"^DIC",2262.2,"B","ASISTS DEVICE SIZE",2262.2)

"^DIC",2262.3,2262.3,0)
ASISTS NEEDLESTICK BRANDS^2262.3
"^DIC",2262.3,2262.3,0,"GL")
^OOPS(2262.3,
"^DIC",2262.3,2262.3,"%",0)
^1.005^^
"^DIC",2262.3,2262.3,"%D",0)
^^2^2^3010614^^
"^DIC",2262.3,2262.3,"%D",1,0)
This file contains the brand names of devices that are used in incidents
"^DIC",2262.3,2262.3,"%D",2,0)
involving needlesticks and sharps.
"^DIC",2262.3,"B","ASISTS NEEDLESTICK BRANDS",2262.3)

**END**
**END**
