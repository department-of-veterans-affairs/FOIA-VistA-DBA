Released FH*5*39 SEQ #38
Extracted from mail message
**KIDS**:FH*5.0*39^

**INSTALL NAME**
FH*5.0*39
"BLD",4422,0)
FH*5.0*39^DIETETICS^0^3030821^y
"BLD",4422,4,0)
^9.64PA^115.7^3
"BLD",4422,4,115.7,0)
115.7
"BLD",4422,4,115.7,222)
y^y^f^^^^n
"BLD",4422,4,117,0)
117
"BLD",4422,4,117,222)
y^y^f^^^^n
"BLD",4422,4,117.1,0)
117.1
"BLD",4422,4,117.1,222)
y^y^f^^^^n
"BLD",4422,4,"B",115.7,115.7)

"BLD",4422,4,"B",117,117)

"BLD",4422,4,"B",117.1,117.1)

"BLD",4422,"INI")

"BLD",4422,"INID")
^y^
"BLD",4422,"INIT")
FHPST39
"BLD",4422,"KRN",0)
^9.67PA^8989.52^19
"BLD",4422,"KRN",.4,0)
.4
"BLD",4422,"KRN",.401,0)
.401
"BLD",4422,"KRN",.402,0)
.402
"BLD",4422,"KRN",.402,"NM",0)
^9.68A^3^3
"BLD",4422,"KRN",.402,"NM",1,0)
FHADM2    FILE #117^117^0
"BLD",4422,"KRN",.402,"NM",2,0)
FHADM4    FILE #117.1^117.1^0
"BLD",4422,"KRN",.402,"NM",3,0)
FHASE    FILE #115.7^115.7^0
"BLD",4422,"KRN",.402,"NM","B","FHADM2    FILE #117",1)

"BLD",4422,"KRN",.402,"NM","B","FHADM4    FILE #117.1",2)

"BLD",4422,"KRN",.402,"NM","B","FHASE    FILE #115.7",3)

"BLD",4422,"KRN",.403,0)
.403
"BLD",4422,"KRN",.5,0)
.5
"BLD",4422,"KRN",.84,0)
.84
"BLD",4422,"KRN",3.6,0)
3.6
"BLD",4422,"KRN",3.8,0)
3.8
"BLD",4422,"KRN",9.2,0)
9.2
"BLD",4422,"KRN",9.8,0)
9.8
"BLD",4422,"KRN",9.8,"NM",0)
^9.68A^25^24
"BLD",4422,"KRN",9.8,"NM",1,0)
FHASE^^0^B20952042
"BLD",4422,"KRN",9.8,"NM",2,0)
FHASE1^^0^B10830397
"BLD",4422,"KRN",9.8,"NM",3,0)
FHASE1A^^0^B40851280
"BLD",4422,"KRN",9.8,"NM",4,0)
FHADM2^^0^B5204159
"BLD",4422,"KRN",9.8,"NM",5,0)
FHADM3^^0^B23076420
"BLD",4422,"KRN",9.8,"NM",6,0)
FHADM4^^0^B36276481
"BLD",4422,"KRN",9.8,"NM",7,0)
FHADM21^^0^B34881093
"BLD",4422,"KRN",9.8,"NM",8,0)
FHNO21^^0^B14700916
"BLD",4422,"KRN",9.8,"NM",9,0)
FHSP11^^0^B6033875
"BLD",4422,"KRN",9.8,"NM",10,0)
FHLABEL^^0^B9674043
"BLD",4422,"KRN",9.8,"NM",11,0)
FHORX1^^0^B8839307
"BLD",4422,"KRN",9.8,"NM",12,0)
FHORD13^^0^B13513201
"BLD",4422,"KRN",9.8,"NM",13,0)
FHORE2^^0^B6627501
"BLD",4422,"KRN",9.8,"NM",14,0)
FHORE21^^0^B16948920
"BLD",4422,"KRN",9.8,"NM",15,0)
FHNO2^^0^B22192123
"BLD",4422,"KRN",9.8,"NM",16,0)
FHSP1^^0^B24580040
"BLD",4422,"KRN",9.8,"NM",17,0)
FHORT5^^0^B7649904
"BLD",4422,"KRN",9.8,"NM",18,0)
FHORT5D^^0^B12076368
"BLD",4422,"KRN",9.8,"NM",19,0)
FHNO41^^0^B15592275
"BLD",4422,"KRN",9.8,"NM",21,0)
FHMNADM^^0^B28708263
"BLD",4422,"KRN",9.8,"NM",22,0)
FHMNBRPT^^0^B17340200
"BLD",4422,"KRN",9.8,"NM",23,0)
FHMNREP^^0^B19385762
"BLD",4422,"KRN",9.8,"NM",24,0)
FHMNPRT^^0^B34893344
"BLD",4422,"KRN",9.8,"NM",25,0)
FHPST39^^0^B5363220
"BLD",4422,"KRN",9.8,"NM","B","FHADM2",4)

"BLD",4422,"KRN",9.8,"NM","B","FHADM21",7)

"BLD",4422,"KRN",9.8,"NM","B","FHADM3",5)

"BLD",4422,"KRN",9.8,"NM","B","FHADM4",6)

"BLD",4422,"KRN",9.8,"NM","B","FHASE",1)

"BLD",4422,"KRN",9.8,"NM","B","FHASE1",2)

"BLD",4422,"KRN",9.8,"NM","B","FHASE1A",3)

"BLD",4422,"KRN",9.8,"NM","B","FHLABEL",10)

"BLD",4422,"KRN",9.8,"NM","B","FHMNADM",21)

"BLD",4422,"KRN",9.8,"NM","B","FHMNBRPT",22)

"BLD",4422,"KRN",9.8,"NM","B","FHMNPRT",24)

"BLD",4422,"KRN",9.8,"NM","B","FHMNREP",23)

"BLD",4422,"KRN",9.8,"NM","B","FHNO2",15)

"BLD",4422,"KRN",9.8,"NM","B","FHNO21",8)

"BLD",4422,"KRN",9.8,"NM","B","FHNO41",19)

"BLD",4422,"KRN",9.8,"NM","B","FHORD13",12)

"BLD",4422,"KRN",9.8,"NM","B","FHORE2",13)

"BLD",4422,"KRN",9.8,"NM","B","FHORE21",14)

"BLD",4422,"KRN",9.8,"NM","B","FHORT5",17)

"BLD",4422,"KRN",9.8,"NM","B","FHORT5D",18)

"BLD",4422,"KRN",9.8,"NM","B","FHORX1",11)

"BLD",4422,"KRN",9.8,"NM","B","FHPST39",25)

"BLD",4422,"KRN",9.8,"NM","B","FHSP1",16)

"BLD",4422,"KRN",9.8,"NM","B","FHSP11",9)

"BLD",4422,"KRN",19,0)
19
"BLD",4422,"KRN",19.1,0)
19.1
"BLD",4422,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4422,"KRN",101,0)
101
"BLD",4422,"KRN",409.61,0)
409.61
"BLD",4422,"KRN",771,0)
771
"BLD",4422,"KRN",870,0)
870
"BLD",4422,"KRN",8989.51,0)
8989.51
"BLD",4422,"KRN",8989.52,0)
8989.52
"BLD",4422,"KRN",8994,0)
8994
"BLD",4422,"KRN","B",.4,.4)

"BLD",4422,"KRN","B",.401,.401)

"BLD",4422,"KRN","B",.402,.402)

"BLD",4422,"KRN","B",.403,.403)

"BLD",4422,"KRN","B",.5,.5)

"BLD",4422,"KRN","B",.84,.84)

"BLD",4422,"KRN","B",3.6,3.6)

"BLD",4422,"KRN","B",3.8,3.8)

"BLD",4422,"KRN","B",9.2,9.2)

"BLD",4422,"KRN","B",9.8,9.8)

"BLD",4422,"KRN","B",19,19)

"BLD",4422,"KRN","B",19.1,19.1)

"BLD",4422,"KRN","B",101,101)

"BLD",4422,"KRN","B",409.61,409.61)

"BLD",4422,"KRN","B",771,771)

"BLD",4422,"KRN","B",870,870)

"BLD",4422,"KRN","B",8989.51,8989.51)

"BLD",4422,"KRN","B",8989.52,8989.52)

"BLD",4422,"KRN","B",8994,8994)

"BLD",4422,"QUES",0)
^9.62^^
"BLD",4422,"REQB",0)
^9.611^1^1
"BLD",4422,"REQB",1,0)
FH*5.0*38^1
"BLD",4422,"REQB","B","FH*5.0*38",1)

"FIA",115.7)
DIETETIC ENCOUNTERS
"FIA",115.7,0)
^FHEN(
"FIA",115.7,0,0)
115.7
"FIA",115.7,0,1)
y^y^f^^^^n
"FIA",115.7,0,10)

"FIA",115.7,0,11)

"FIA",115.7,0,"RLRO")

"FIA",115.7,0,"VR")
5.0^FH
"FIA",115.7,115.7)
0
"FIA",115.7,115.701)
0
"FIA",117)
MEALS SERVED
"FIA",117,0)
^FH(117,
"FIA",117,0,0)
117D
"FIA",117,0,1)
y^y^f^^^^n
"FIA",117,0,10)

"FIA",117,0,11)

"FIA",117,0,"RLRO")

"FIA",117,0,"VR")
5.0^FH
"FIA",117,117)
0
"FIA",117,117.06)
0
"FIA",117.1)
STAFFING DATA
"FIA",117.1,0)
^FH(117.1,
"FIA",117.1,0,0)
117.1D
"FIA",117.1,0,1)
y^y^f^^^^n
"FIA",117.1,0,10)

"FIA",117.1,0,11)

"FIA",117.1,0,"RLRO")

"FIA",117.1,0,"VR")
5.0^FH
"FIA",117.1,117.1)
0
"FIA",117.1,117.11)
0
"INIT")
FHPST39
"KRN",.402,297,-1)
0^1
"KRN",.402,297,0)
FHADM2^3030714.0954^^117^^^3030806
"KRN",.402,297,"%D",0)
^.4021^2^2^3030425^^^^
"KRN",.402,297,"%D",1,0)
This template is used to enter served meals data which is used
"KRN",.402,297,"%D",2,0)
to complete the worksheet for AMIS segment 224.
"KRN",.402,297,"DR",1,117)
6;
"KRN",.402,297,"DR",2,117.06)
.01;S FHCOMM=X;D C1^FHADM2;S DIE("NO^")="" S:'$D(FHN("D")) Y="@1";21//^S X=FHN("D",0);22//^S X=FHN("D",1);@1;S:'$D(FHN("N")) Y="@2";23//^S X=FHN("N",0);24//^S X=FHN("N",1);@2;S:'$D(FHN("H")) Y="@3";25//^S X=FHN("H",0);
"KRN",.402,297,"DR",2,117.06,1)
26//^S X=FHN("H",1);@3;K DIE("NO^");1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;
"KRN",.402,629,-1)
0^3
"KRN",.402,629,0)
FHASE^3030731.1512^^115.7^^^3030801
"KRN",.402,629,"%D",0)
^.4021^2^2^3030602^^^^
"KRN",.402,629,"%D",1,0)
This template is used to enter data relating to a dietetic
"KRN",.402,629,"%D",2,0)
encounter.
"KRN",.402,629,"DR",1,115.7)
2//^S X=$P(^VA(200,DUZ,0),"^",1);11;3//^S X="",DIC("S")="I Y>2";K DIC("S") S FHX1=$S($D(^FH(115.6,+X,0)):^(0),1:"") I $P(FHX1,"^",5)'="Y" S Y="@1";4;@1;S FHX2=$P(FHX1,"^",3) I '$P(FHX1,"^",4) S Y=6;5;I X="F" S FHX2=$P(FHX1,"^",4);
"KRN",.402,629,"DR",1,115.7,1)
6//^S X=FHX2;S FHX2=$P(FHX1,"^",6) I FHX2'="B" S Y="@3";7;S FHX2=X,Y="@4";@3;7///^S X=FHX2;@4;10;S FHX3="" I $P(FHX1,"^",7)'="Y" S Y=8 S:FHX2="I" FHX3=1;@5;20;D CNT^FHASE I $P(FHX4,"^",10)'="",FHX3 S $P(^FHEN(ASE,0),U,10)="";
"KRN",.402,629,"DR",1,115.7,2)
I FHX2="I",FHX3<1 W *7,!?5,"Must select a patient." S Y="@5";@8;8//^S X=FHX3;I X<FHX3 W *7,!?5,"Group Size cannot be less than total person count (default)" S $P(^FHEN(ASE,0),U,10)="",Y="@8";I $P(FHX4,"^",13)'="" S Y="@9";
"KRN",.402,629,"DR",1,115.7,3)
101////^S X=DUZ;@9;I $P(FHX4,"^",14)'="" S Y="@10";102///^S X="NOW";@10;S:'FHN Y=0;103///^S X="NOW";104////^S X=DUZ;
"KRN",.402,629,"DR",2,115.701)
.01;S DFN=X,DGT=DTE D ^DGPMSTAT S X9=$G(^DIC(42,+DG1,44));1////^S X=X9;I $P(FHX1,"^",8)'="Y" S Y="@6";2;@6;I $P(FHX1,"^",9)'="Y" S Y="@7";3;@7;I FHX2="I" S DI(1)=+DI(1),Y=0;
"KRN",.402,630,-1)
0^2
"KRN",.402,630,0)
FHADM4^3030714.0955^^117.1^^^3030714
"KRN",.402,630,"%D",0)
^.4021^2^2^3030423^^^^
"KRN",.402,630,"%D",1,0)
This template is used to input daily data into the Staffing
"KRN",.402,630,"%D",2,0)
Guidelines file (117.1).
"KRN",.402,630,"DR",1,117.1)
20;
"KRN",.402,630,"DR",2,117.11)
2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",29,-1)
1^1
"PKG",29,0)
DIETETICS^FH^Dietetics System
"PKG",29,20,0)
^9.402P^^
"PKG",29,22,0)
^9.49I^1^1
"PKG",29,22,1,0)
5.0^2951011^2951130
"PKG",29,22,1,"PAH",1,0)
39^3030821
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
24
"RTN","FHADM2")
0^4^B5204159
"RTN","FHADM2",1,0)
FHADM2 ; HISC/REL/NCA/AAC - Enter/Edit Served Meals ;5/4/93  09:53
"RTN","FHADM2",2,0)
 ;;5.0;Dietetics;**39**;Oct 11, 1995
"RTN","FHADM2",3,0)
EN1 ; Enter/Edit Served Meals
"RTN","FHADM2",4,0)
 D NOW^%DTC S DT=%\1 K %,%H,%I
"RTN","FHADM2",5,0)
 S (ZZOUT,COMM)=0,ZOUT=$P($G(^FH(119.6,0)),"^",4)
"RTN","FHADM2",6,0)
 ;
"RTN","FHADM2",7,0)
E1 S %DT="AEPX",%DT("A")="SERVED MEALS Date: " W ! D ^%DT G KIL^FHADM21:"^"[X!$D(DTOUT),E1:Y<1
"RTN","FHADM2",8,0)
 ;
"RTN","FHADM2",9,0)
 S DA=+Y I DA'<DT W *7,!!,"** Input must be for a date before today in order to collect ADT data!",! G E1
"RTN","FHADM2",10,0)
 ;
"RTN","FHADM2",11,0)
 ;Enter Communications Office 
"RTN","FHADM2",12,0)
 K DIC,DIE S DIE="^FH(117," I '$D(^FH(117,DA,0)) S ^FH(117,DA,0)=DA,^FH(117,"B",DA,DA)="",X0=^FH(117,0),$P(^FH(117,0),"^",3,4)=DA_"^"_($P(X0,"^",4)+1)
"RTN","FHADM2",13,0)
 S DA=+Y I $G(^FH(117,DA,"I"))="Y" W !," ** INACTIVE COMM OFFICE **" Q
"RTN","FHADM2",14,0)
 S ^FH(117,DA,0)=DA
"RTN","FHADM2",15,0)
 S DR="[FHADM2]" D ^DIE
"RTN","FHADM2",16,0)
 Q
"RTN","FHADM2",17,0)
 ;
"RTN","FHADM2",18,0)
C1 ;
"RTN","FHADM2",19,0)
 K FHN W !!,"Calculating Census Values ...",!
"RTN","FHADM2",20,0)
 F W1=0:0 S W1=$O(^DG(41.9,W1)) Q:W1'>0  D C2
"RTN","FHADM2",21,0)
 Q
"RTN","FHADM2",22,0)
C2 ;
"RTN","FHADM2",23,0)
 I '$D(^DG(41.9,W1,"C",DA(1))) Q
"RTN","FHADM2",24,0)
 S X0=^DG(41.9,W1,"C",DA(1),0),X1=$G(^(1)) I $D(^DIC(42,W1,0)) S FHWARD=$O(^FH(119.6,"AW",W1,"")) Q:FHWARD=""
"RTN","FHADM2",25,0)
 S FHCOM19=$P($G(^FH(119.6,FHWARD,0)),"^",8) Q:FHCOMM'=FHCOM19
"RTN","FHADM2",26,0)
 S TYP=$P(^DIC(42,W1,0),"^",3),TYP=$S(TYP="D":"D",TYP="NH":"N",1:"H")
"RTN","FHADM2",27,0)
 I '$D(FHN(TYP)) S FHN(TYP,0)=0,FHN(TYP,1)=0
"RTN","FHADM2",28,0)
 S Y0=$P(X0,"^",2),Y1=$P(X1,"^",5)
"RTN","FHADM2",29,0)
 S:Y0 FHN(TYP,0)=FHN(TYP,0)+Y0 S:Y1 FHN(TYP,1)=FHN(TYP,1)+Y1 Q
"RTN","FHADM2",30,0)
 Q
"RTN","FHADM2",31,0)
DT ; Get From/To Dates
"RTN","FHADM2",32,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHADM2",33,0)
 I SDT'<DT W *7,"  [Must Start before Today!] " G D1
"RTN","FHADM2",34,0)
D2 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHADM2",35,0)
 I EDT'<DT W *7,"  [Must End before Today!] " G D2
"RTN","FHADM2",36,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHADM2",37,0)
 Q
"RTN","FHADM21")
0^7^B34881093
"RTN","FHADM21",1,0)
FHADM21 ; HISC/REL/NCA/AAC - Served Meals Report ;1/23/98  16:07
"RTN","FHADM21",2,0)
 ;;5.0;Dietetics;**13,39**;Oct 11, 1995
"RTN","FHADM21",3,0)
 ;
"RTN","FHADM21",4,0)
 ;This program is being modified for Multidivisional Reports
"RTN","FHADM21",5,0)
 ;Project ID 4QNFR03 - 2003
"RTN","FHADM21",6,0)
 ;
"RTN","FHADM21",7,0)
EN2 ; Print Meals Report
"RTN","FHADM21",8,0)
 ;
"RTN","FHADM21",9,0)
 D NOW^%DTC S DT=%\1 D DT^FHADM2 G:"^"[X KIL
"RTN","FHADM21",10,0)
 ;
"RTN","FHADM21",11,0)
 ;Declare variables,determine total # of comm offices - alc 02-26-03
"RTN","FHADM21",12,0)
 ;
"RTN","FHADM21",13,0)
 S CONAME="",CO="",ZCO="",L=0,CONUM="",CONUMZ="",COUNT=0,COX="",COXX="",Y00=""
"RTN","FHADM21",14,0)
 ;S ZZOUT=$G(^FH(119.73,0)),ZOUT=$P(ZZOUT,"^",4)
"RTN","FHADM21",15,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHADM21",16,0)
 F K=1:1:21 S S(K)="",SS(K)="",NN(K)=0
"RTN","FHADM21",17,0)
 ;
"RTN","FHADM21",18,0)
 R !,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y") I ZCO="Y" G PRINT
"RTN","FHADM21",19,0)
 ;
"RTN","FHADM21",20,0)
EN3 ;Enter/Edit data - alc 02-26-03
"RTN","FHADM21",21,0)
 ;
"RTN","FHADM21",22,0)
 S DIC=119.73,DIC(0)="AEQ"
"RTN","FHADM21",23,0)
 D ^DIC I (Y=-1)&(CO="") G KIL Q
"RTN","FHADM21",24,0)
 I (Y=-1) G PRINT Q
"RTN","FHADM21",25,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME G EN3
"RTN","FHADM21",26,0)
 I Y=-1 K DIC Q     ;quit if lookup fails
"RTN","FHADM21",27,0)
 ;
"RTN","FHADM21",28,0)
PRINT W !!,"The report requires a 132 column printer.",!
"RTN","FHADM21",29,0)
 S NAMENO=$L(CONAME,"^"),CONUMX=$L(CO,"^")
"RTN","FHADM21",30,0)
 I ZCO="Y" S CONUMZ=$G(^FH(119.73,0)),CONUMZ=$P(CONUMZ,"^",4)
"RTN","FHADM21",31,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHADM21",32,0)
 I $D(IO("Q")) S FHPGM="Q1^FHADM21",FHLST="EDT^SDT^ZCO^CONUMX^CO^CONAM^CONAME^COUNT^CONUMZ^ZOUT^S(^SS(" D EN2^FH G KIL
"RTN","FHADM21",33,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHADM21",34,0)
 ;
"RTN","FHADM21",35,0)
Q1 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHADM21",36,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHADM21",37,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0
"RTN","FHADM21",38,0)
 ;
"RTN","FHADM21",39,0)
Q2 ;Drivers for individual Comm Off report - alc 02-26-03
"RTN","FHADM21",40,0)
 ;
"RTN","FHADM21",41,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 QUIT  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) G:$D(^FH(119.73,COXX,"I")) Q2 G:'$D(^FH(119.73,COXX,0)) Q2
"RTN","FHADM21",42,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT QUIT  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") G:$D(^FH(119.73,COUNT,"I")) Q2 G:'$D(^FH(119.73,COUNT,0)) Q2
"RTN","FHADM21",43,0)
 ;W @IOF
"RTN","FHADM21",44,0)
 D HDR
"RTN","FHADM21",45,0)
 D Q3
"RTN","FHADM21",46,0)
 I CONUMX>0  G Q2
"RTN","FHADM21",47,0)
 Q
"RTN","FHADM21",48,0)
 ;
"RTN","FHADM21",49,0)
QUIT ;Drivers for report final totals/average - alc 02-26-03
"RTN","FHADM21",50,0)
 ;
"RTN","FHADM21",51,0)
 ;W @IOF
"RTN","FHADM21",52,0)
 S NAME="Total All Communications Offices "
"RTN","FHADM21",53,0)
 D HDR
"RTN","FHADM21",54,0)
 ;
"RTN","FHADM21",55,0)
 F K=1:1:18 S NN(K)=$J($S(NDX:SS(K)/NDX,1:0),0,0),NN(K)=$J($S(NN(K)<1:"",1:NN(K)),5)_" ",SS(K)=$S(SS(K)<1:$J("",6),SS(K)<100000:$J(SS(K),5)_" ",1:$J(SS(K),6))
"RTN","FHADM21",56,0)
 F K=19:1:21 S NN(K)=$J($S(NDX:SS(K)/NDX,1:0),0,0),NN(K)=$J($S(NN(K)<1:"",1:NN(K)),5)_" ",SS(K)=$S(SS(K)<1:$J("",6),SS(K)<100000:$J(SS(K),5)_" ",1:$J(SS(K),6))
"RTN","FHADM21",57,0)
 ;BREAK
"RTN","FHADM21",58,0)
 D FTOTALS
"RTN","FHADM21",59,0)
 Q
"RTN","FHADM21",60,0)
 ;
"RTN","FHADM21",61,0)
Q3 ;Looping thru dates/comm off load data buckets - alc 02-26-03
"RTN","FHADM21",62,0)
 ;
"RTN","FHADM21",63,0)
 S D1=SDT,(ND,TD,NDX,TDX)=0 F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC Q:(X>EDT)  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHADM21",64,0)
 ;
"RTN","FHADM21",65,0)
 F K=1:1:18 S N(K)=$J($S(ND:S(K)/ND,1:0),0,0),N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" ",S(K)=$S(S(K)<1:$J("",6),S(K)<100000:$J(S(K),5)_" ",1:$J(S(K),6))
"RTN","FHADM21",66,0)
 ;
"RTN","FHADM21",67,0)
 F K=19:1:21 S N(K)=$J($S(TD:S(K)/TD,1:0),0,0),N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" ",S(K)=$S(S(K)<1:$J("",6),S(K)<100000:$J(S(K),5)_" ",1:$J(S(K),6))
"RTN","FHADM21",68,0)
 ;
"RTN","FHADM21",69,0)
 ;Print daily totals - alc 02-26-03
"RTN","FHADM21",70,0)
 ;
"RTN","FHADM21",71,0)
 D LN W !?4,"Total",?15,"|",S(1),S(2),S(3),"|",S(4),S(5),S(6),"|",S(7),S(8),S(9),"|",S(10),"|",S(11),S(13),S(16),"|",S(17),"|",S(18),"|",S(19),S(20),S(21),!
"RTN","FHADM21",72,0)
 ;
"RTN","FHADM21",73,0)
 W:ND ?4,"Avg. ",?15,"|",N(1),N(2),N(3),"|",N(4),N(5),N(6),"|",N(7),N(8),N(9),"|",N(10),"|",N(11),N(13),N(16),"|",N(17),"|",N(18),"|",N(19),N(20),N(21),!
"RTN","FHADM21",74,0)
 ;
"RTN","FHADM21",75,0)
 Q
"RTN","FHADM21",76,0)
 ;
"RTN","FHADM21",77,0)
FTOTALS ;PRINT FINAL TOTALS - alc 02-26-03
"RTN","FHADM21",78,0)
 ;
"RTN","FHADM21",79,0)
 D LN W !?4,"ALL Total",?15,"|",SS(1),SS(2),SS(3),"|",SS(4),SS(5),SS(6),"|",SS(7),SS(8),SS(9),"|",SS(10),"|",SS(11),SS(13),SS(16),"|",SS(17),"|",SS(18),"|",SS(19),SS(20),SS(21),!
"RTN","FHADM21",80,0)
 ;
"RTN","FHADM21",81,0)
 W:ND ?4,"Avg. ",?15,"|",NN(1),NN(2),NN(3),"|",NN(4),NN(5),NN(6),"|",NN(7),NN(8),NN(9),"|",NN(10),"|",NN(11),NN(13),NN(16),"|",NN(17),"|",NN(18),"|",NN(19),NN(20),NN(21),!
"RTN","FHADM21",82,0)
 ;
"RTN","FHADM21",83,0)
 Q
"RTN","FHADM21",84,0)
 ;
"RTN","FHADM21",85,0)
HDR ;Print report headings - alc 02-26-03
"RTN","FHADM21",86,0)
 ;
"RTN","FHADM21",87,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !,HDT,?44,"S E R V E D   M E A L S   W O R K S H E E T",?123,"Page ",PG
"RTN","FHADM21",88,0)
 ;
"RTN","FHADM21",89,0)
 ;S NAMENO=NAMENO-1,NAME=$P(CONAME,"^",NAMENO) 
"RTN","FHADM21",90,0)
 W !!,?1,NAME
"RTN","FHADM21",91,0)
 ;
"RTN","FHADM21",92,0)
 W ?(131-$L(DTE)\2),DTE
"RTN","FHADM21",93,0)
 W !!,?15,"|",?32,"MEALS SERVED ON INPATIENT BASIS",?79,"|",?82,"MEALS SERVED TO OTHERS",?105,"| TOTAL| SERVED TRAYS DATA"
"RTN","FHADM21",94,0)
 W !,?15,"|",?19,"DOMICILIARY",?34,"| NURSING HOME CU",?53,"|",?59,"HOSPITAL",?72,"| TOTAL|",?98,"| TOTAL| MEALS|"
"RTN","FHADM21",95,0)
 W !,?15,"|  Inp.  Abs.  Meal|  Inp.  Abs.  Meal|  Inp.  Abs.  Meal|      | Outp.  Paid Grat.|      |      |  Cafe   NPO Trays"
"RTN","FHADM21",96,0)
 W !,?15,"|   A     B     C  |   D     E     F  |   G     H     I  |   J  |   K     M    Q   |      |   R  |   T      U    V"
"RTN","FHADM21",97,0)
LN W ! F K=1:1:131 W "-"
"RTN","FHADM21",98,0)
 Q
"RTN","FHADM21",99,0)
 ;
"RTN","FHADM21",100,0)
N1 ;Get data from approp date/comm office globals - alc 02-26-03
"RTN","FHADM21",101,0)
 ;
"RTN","FHADM21",102,0)
 I ZCO="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=($P(Y0,"^",2,99)),Y00=$G(^FH(117,D1,2,CONUM,1)),Y11=($P(Y00,"^",1,99))  Q:COUNT=Y2 
"RTN","FHADM21",103,0)
 ;
"RTN","FHADM21",104,0)
N2 I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=($P(Y0,"^",2,99)),Y00=$G(^FH(117,D1,2,CONUM,1)),Y11=($P(Y00,"^",1,99))  Q:COXX=Y2
"RTN","FHADM21",105,0)
 ;
"RTN","FHADM21",106,0)
 K N S K=0 F L=1,2,4,5,7,8 S K=K+1,N(L)=$P(Y11,"^",K)
"RTN","FHADM21",107,0)
 S K=10 F L=1:3:16 S K=K+1,N(K)=$P(Y1,"^",L)+$P(Y1,"^",L+1)+$P(Y1,"^",L+2)
"RTN","FHADM21",108,0)
 ;
"RTN","FHADM21",109,0)
 ;Calcs - alc 02-26-03
"RTN","FHADM21",110,0)
 ;
"RTN","FHADM21",111,0)
 S N(19)=$P(Y1,"^",19),N(20)=$P(Y1,"^",20)
"RTN","FHADM21",112,0)
 S N(3)=N(1)-N(2)*3,N(6)=N(4)-N(5)*3,N(9)=N(7)-N(8)*3,N(10)=N(3)+N(6)+N(9)
"RTN","FHADM21",113,0)
 ;
"RTN","FHADM21",114,0)
 ;
"RTN","FHADM21",115,0)
 S N(16)=N(14)+N(15)+N(16),N(13)=N(12)+N(13),N(17)=N(11)+N(13)+N(16),N(18)=N(10)+N(17),N(19)=N(19)+N(17),N(21)=N(18)-N(19)-N(20) S:N(18) (ND,NDX)=ND+1 S:N(20) (TD,TDX)=TD+1
"RTN","FHADM21",116,0)
 ;
"RTN","FHADM21",117,0)
 ;Summarizing detail report data into totals - alc 02-26-03
"RTN","FHADM21",118,0)
 ;
"RTN","FHADM21",119,0)
 F K=1:1:21 S S(K)=S(K)+N(K),SS(K)=SS(K)+N(K)
"RTN","FHADM21",120,0)
 ;
"RTN","FHADM21",121,0)
 F K=1:1:21 S N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" "
"RTN","FHADM21",122,0)
 ;
"RTN","FHADM21",123,0)
 ;Prints detail line by date - alc 02-26-03
"RTN","FHADM21",124,0)
 ;
"RTN","FHADM21",125,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHADM21",126,0)
 W !,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",DTP
"RTN","FHADM21",127,0)
 W ?15,"|",N(1),N(2),N(3),"|",N(4),N(5),N(6),"|",N(7),N(8),N(9),"|",N(10),"|",N(11),N(13),N(16),"|",N(17),"|",N(18),"|",N(19),N(20),N(21)  Q
"RTN","FHADM21",128,0)
KIL ; Kill all used Variables
"RTN","FHADM21",129,0)
 G KILL^XUSCLEAN
"RTN","FHADM3")
0^5^B23076420
"RTN","FHADM3",1,0)
FHADM3 ; HISC/REL/AAC - Additional Meals Report ;1/23/98  16:07
"RTN","FHADM3",2,0)
 ;;5.0;Dietetics;**13,39**;Oct 11, 1995
"RTN","FHADM3",3,0)
EN1 ; Print Meal Report
"RTN","FHADM3",4,0)
 D DT G:"^"[X KIL
"RTN","FHADM3",5,0)
 ;
"RTN","FHADM3",6,0)
 ;Get Communication Offices data
"RTN","FHADM3",7,0)
 F K=1:1:22 S SS(K)=0,S(K)=0
"RTN","FHADM3",8,0)
 S CONUM="",ZCO="",COXX="",CO="",CONAME="",CONAM="",COUNT=0
"RTN","FHADM3",9,0)
 ;S ZZOUT=$G(^FH(119.73,0)),ZOUT=$P(ZZOUT,"^",4)
"RTN","FHADM3",10,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHADM3",11,0)
 ;
"RTN","FHADM3",12,0)
 R !,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y") I ZCO'="Y" D N2 G KIL Q
"RTN","FHADM3",13,0)
 ;
"RTN","FHADM3",14,0)
PRINT W !!,"The report requires a 132 column printer.",!
"RTN","FHADM3",15,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHADM3",16,0)
 I $D(IO("Q")) S FHPGM="Q1^FHADM3",FHLST="CONAME^CO^CONUMX^EDT^SDT^ZCO^COUNT^ZOUT^S(^SS(" D EN2^FH G KIL
"RTN","FHADM3",17,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHADM3",18,0)
 ;
"RTN","FHADM3",19,0)
Q1 ; Process Printing the Meal Report
"RTN","FHADM3",20,0)
 ;
"RTN","FHADM3",21,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHADM3",22,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHADM3",23,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0
"RTN","FHADM3",24,0)
 ;
"RTN","FHADM3",25,0)
Q2 ;
"RTN","FHADM3",26,0)
 ;Get Specific Communication Offices
"RTN","FHADM3",27,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 QUIT  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) G:$D(^FH(119.73,COXX,"I")) Q2 G:'$D(^FH(119.73,COXX,0)) Q2
"RTN","FHADM3",28,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT QUIT  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") G:$D(^FH(119.73,COUNT,"I")) Q2 G:'$D(^FH(119.73,COUNT,0)) Q2
"RTN","FHADM3",29,0)
 ;W @IOF
"RTN","FHADM3",30,0)
 D HDR
"RTN","FHADM3",31,0)
 D Q3
"RTN","FHADM3",32,0)
 I ZCO'="Y" I CONUMX>0  G Q2
"RTN","FHADM3",33,0)
 I ZCO="Y" G Q2
"RTN","FHADM3",34,0)
 Q
"RTN","FHADM3",35,0)
 ;
"RTN","FHADM3",36,0)
QUIT ;
"RTN","FHADM3",37,0)
 ;W @IOF
"RTN","FHADM3",38,0)
 S NAME="Total All Communications Offices "
"RTN","FHADM3",39,0)
 D HDR
"RTN","FHADM3",40,0)
 D FTOTALS
"RTN","FHADM3",41,0)
 D LN,LN
"RTN","FHADM3",42,0)
 Q
"RTN","FHADM3",43,0)
 ;
"RTN","FHADM3",44,0)
Q3 F L1=19:1:22 S N(L1)=0
"RTN","FHADM3",45,0)
 S D1=SDT F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC  Q:X>EDT  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHADM3",46,0)
 ;
"RTN","FHADM3",47,0)
TOTALS ;
"RTN","FHADM3",48,0)
 ;Print Totals
"RTN","FHADM3",49,0)
 F K=1:1:22 S Z=$S(K<19:5,1:6),S(K)=$S(S(K)<1:$J("",Z),S(K)<10000:$J(S(K),Z-1)_" ",1:$J(S(K),Z))
"RTN","FHADM3",50,0)
 ;
"RTN","FHADM3",51,0)
 D LN W !,"  Total",?10,"|",S(1),S(2),S(3),S(4),S(5),S(6),S(19)," |",S(7),S(8),S(9),S(10),S(11),S(12),S(20)," |",S(13),S(14),S(15),S(16),S(17),S(18),S(21)," |",S(22),!
"RTN","FHADM3",52,0)
 Q
"RTN","FHADM3",53,0)
 ;
"RTN","FHADM3",54,0)
FTOTALS ; Final Totals
"RTN","FHADM3",55,0)
 ;
"RTN","FHADM3",56,0)
 F K=1:1:22 S Z=$S(K<19:5,1:6),SS(K)=$S(SS(K)<1:$J("",Z),SS(K)<10000:$J(SS(K),Z-1)_" ",1:$J(SS(K),Z))
"RTN","FHADM3",57,0)
 ;
"RTN","FHADM3",58,0)
 W !,"ALL Total",?10,"|",SS(1),SS(2),SS(3),SS(4),SS(5),SS(6),SS(19)," |",SS(7),SS(8),SS(9),SS(10),SS(11),SS(12),SS(20)," |",SS(13),SS(14),SS(15),SS(16),SS(17),SS(18),SS(21)," |",SS(22),!
"RTN","FHADM3",59,0)
 Q
"RTN","FHADM3",60,0)
 ;
"RTN","FHADM3",61,0)
HDR ;Print page headers
"RTN","FHADM3",62,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !,HDT,?50,"A D D I T I O N A L   M E A L S",?125,"Page ",PG
"RTN","FHADM3",63,0)
 W !!,?1,NAME
"RTN","FHADM3",64,0)
 W !!?(131-$L(DTE)\2),DTE
"RTN","FHADM3",65,0)
 W !!,?10,"|",?21,"B R E A K F A S T",?48,"|",?64,"N O O N",?86,"|",?99,"E V E N I N G",?124,"| TOTAL"
"RTN","FHADM3",66,0)
 W !,?10,"| Opt. Emp. Paid OOD  Vol. Grt. Total | Opt. Emp. Paid OOD  Vol. Grt. Total | Opt. Emp. Paid OOD  Vol. Grt. Total |"
"RTN","FHADM3",67,0)
LN W !,"-----------------------------------------------------------------------------------------------------------------------------------"
"RTN","FHADM3",68,0)
 Q
"RTN","FHADM3",69,0)
 ;
"RTN","FHADM3",70,0)
N1 ;Get specific records based on Communications Offices,Start/End Dates, etc
"RTN","FHADM3",71,0)
 I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=$P(Y0,"^",2,99)  Q:COXX=Y2
"RTN","FHADM3",72,0)
 ;
"RTN","FHADM3",73,0)
 I ZCO="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=$P(Y0,"^",2,99)  Q:COUNT=Y2
"RTN","FHADM3",74,0)
 ;
"RTN","FHADM3",75,0)
 S K=0 F L1=1:1:6 F L2=1:1:3 S K=K+1,N=L2-1*6+L1,Z=$P(Y1,"^",K),N(N)=Z,N(18+L2)=N(18+L2)+Z
"RTN","FHADM3",76,0)
 S N(22)=N(19)+N(20)+N(21)
"RTN","FHADM3",77,0)
 ;
"RTN","FHADM3",78,0)
 F K=1:1:22 S S(K)=S(K)+N(K),SS(K)=SS(K)+N(K),N(K)=$J($S(N(K)<1:"",1:N(K)),$S(K<19:4,1:5))_" "
"RTN","FHADM3",79,0)
 ;
"RTN","FHADM3",80,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHADM3",81,0)
 W !,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",$E(DTP,1,6)
"RTN","FHADM3",82,0)
 W "|",N(1),N(2),N(3),N(4),N(5),N(6),N(19)," |",N(7),N(8),N(9),N(10),N(11),N(12),N(20)," |",N(13),N(14),N(15),N(16),N(17),N(18),N(21)," |",N(22) Q
"RTN","FHADM3",83,0)
 ;
"RTN","FHADM3",84,0)
N2 ;Get Communciation Offices
"RTN","FHADM3",85,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHADM3",86,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHADM3",87,0)
 I Y=-1 G PRINT Q
"RTN","FHADM3",88,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2 Q
"RTN","FHADM3",89,0)
 I Y=-1 K DIC Q
"RTN","FHADM3",90,0)
 ;
"RTN","FHADM3",91,0)
DT ; Get From/To Dates
"RTN","FHADM3",92,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHADM3",93,0)
 I SDT'<DT W *7,"  [Must Start before Today!] " G D1
"RTN","FHADM3",94,0)
 ;
"RTN","FHADM3",95,0)
D2 ;
"RTN","FHADM3",96,0)
 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHADM3",97,0)
 I EDT'<DT W *7,"  [Must End before Today!] " G D2
"RTN","FHADM3",98,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHADM3",99,0)
 Q
"RTN","FHADM3",100,0)
 ;
"RTN","FHADM3",101,0)
KIL G KILL^XUSCLEAN Q
"RTN","FHADM3",102,0)
EXIT Q
"RTN","FHADM4")
0^6^B36276481
"RTN","FHADM4",1,0)
FHADM4 ; HISC/REL/NCA/AAC - Staffing Data Report ;1/23/98  16:08
"RTN","FHADM4",2,0)
 ;;5.0;Dietetics;**13,39**;Oct 11, 1995
"RTN","FHADM4",3,0)
EN1 ; Enter/Edit Staffing Data
"RTN","FHADM4",4,0)
 D NOW^%DTC S DT=%\1
"RTN","FHADM4",5,0)
 ;
"RTN","FHADM4",6,0)
 ;
"RTN","FHADM4",7,0)
E1 S %DT="AEPX",%DT("A")="STAFFING DATA Date: " W ! D ^%DT G KIL:"^"[X!$D(DTOUT),E1:Y<1
"RTN","FHADM4",8,0)
 S DA=+Y I DA>DT W *7,!!,"** Date must not be in the future!",! G E1
"RTN","FHADM4",9,0)
 K DIC,DIE S DIE="^FH(117.1," I '$D(^FH(117.1,DA,0)) S ^FH(117.1,DA,0)=DA,^FH(117.1,"B",DA,DA)="",X0=^FH(117.1,0),$P(^FH(117.1,0),"^",3,4)=DA_"^"_($P(X0,"^",4)+1)
"RTN","FHADM4",10,0)
 S X1=DA,X2=-1 D C^%DTC S DM1=X,FHX1=$P($G(^FH(117.1,DM1,0)),"^",2,6)
"RTN","FHADM4",11,0)
 S DR="[FHADM4]" D ^DIE G EN1
"RTN","FHADM4",12,0)
 ;
"RTN","FHADM4",13,0)
EN2 ; Print Staffing Data Report
"RTN","FHADM4",14,0)
 D DT^FHADM2 G:"^"[X KIL
"RTN","FHADM4",15,0)
 ;
"RTN","FHADM4",16,0)
 S (CONUM,ZCO,COXX,CO,CONAME,CONAM)="",(COUNT,SSND,SSTOT,SSTO1,SMAN)=0
"RTN","FHADM4",17,0)
 F K=1:1:23 S SS(K)=0
"RTN","FHADM4",18,0)
 ;S ZZOUT=$G(^FH(119.73,0)),(CONUMX,ZOUT)=$P(ZZOUT,"^",4)
"RTN","FHADM4",19,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHADM4",20,0)
 R !,"Print report all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y") I ZCO'="Y"  D N2 Q
"RTN","FHADM4",21,0)
 ;
"RTN","FHADM4",22,0)
PRINT W !!,"The report requires a 132 column printer.",!
"RTN","FHADM4",23,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHADM4",24,0)
 I $D(IO("Q")) S FHPGM="Q1^FHADM4",FHLST="EDT^SDT^ZCO^CONUMX^COUNT^ZOUT^SSND^SSTOT^CO^CONAME^SMAN^SSTO1^SS(" D EN2^FH G KIL
"RTN","FHADM4",25,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHADM4",26,0)
 ;
"RTN","FHADM4",27,0)
Q1 ; Process Printing Staffing Report
"RTN","FHADM4",28,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHADM4",29,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHADM4",30,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0
"RTN","FHADM4",31,0)
 K S,AV F K=1:1:23 S S(K)=0
"RTN","FHADM4",32,0)
 S SIZ="61 51 51 51 51 50 30 30 30 30 30 30 30 30 30 30 30 30 30 51 50 50 50"
"RTN","FHADM4",33,0)
 ;
"RTN","FHADM4",34,0)
Q3 ;
"RTN","FHADM4",35,0)
 ;Get Communication Office data drivers
"RTN","FHADM4",36,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 QUIT  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) G:$D(^FH(119.73,COXX,"I")) Q3 G:'$D(^FH(119.73,COXX,0)) Q3
"RTN","FHADM4",37,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT QUIT  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") G:$D(^FH(119.73,COUNT,"I")) Q3 G:'$D(^FH(119.73,COUNT,0)) Q3
"RTN","FHADM4",38,0)
 ;W @IOF
"RTN","FHADM4",39,0)
 D HDR
"RTN","FHADM4",40,0)
 D Q4
"RTN","FHADM4",41,0)
 I ZCO'="Y" I CONUM>0 G Q3
"RTN","FHADM4",42,0)
 I ZCO="Y" G Q3
"RTN","FHADM4",43,0)
 Q
"RTN","FHADM4",44,0)
 ;
"RTN","FHADM4",45,0)
QUIT ;
"RTN","FHADM4",46,0)
 ;End of routine drivers
"RTN","FHADM4",47,0)
 ;W @IOF
"RTN","FHADM4",48,0)
 S NAME="Total all Communications Offices "
"RTN","FHADM4",49,0)
 D HDR
"RTN","FHADM4",50,0)
 D FTOTALS
"RTN","FHADM4",51,0)
 D LN
"RTN","FHADM4",52,0)
 D LN
"RTN","FHADM4",53,0)
 Q
"RTN","FHADM4",54,0)
Q4 ;
"RTN","FHADM4",55,0)
 ;Get detail information for Communciation Office, Start/End dates, etc.
"RTN","FHADM4",56,0)
 F K=1:1:23 S S(K)=0
"RTN","FHADM4",57,0)
 S D1=SDT,(ND,FHTOT,TO1,TOT,SFHTOT,MAN)=0 F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC Q:X>EDT  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHADM4",58,0)
 D LN G:ND>62 Q2
"RTN","FHADM4",59,0)
 W !?7,"Total",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K),SS(K)=SS(K)+S(K) W $J(S(K),$E(X,1)+1,$E(X,2))
"RTN","FHADM4",60,0)
 ;
"RTN","FHADM4",61,0)
Q2 ;Print Averages
"RTN","FHADM4",62,0)
 I ND W !?7,"Avg.",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(S(K)/ND,$E(X,1)+1,$E(X,2))
"RTN","FHADM4",63,0)
 I S(22) W !?7,"% Paid",?68 F K=8,9,10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(S(K)/S(22)*100,$E(X,1)+1,0)
"RTN","FHADM4",64,0)
 I TOT W !!?7,"Adjustment for Unscheduled and Intermittent",!!?7,"UNS/INT Total " S TOT=TOT/8 W $J(TOT,5,1)," FTEE",!?7,"Adjusted Measured FTEE " S TOT=TOT+TO1 W $J(TOT,6,1) ;I ND W !?7,"Avg Measured FTEE       ",$J(TOT/ND,5,1)
"RTN","FHADM4",65,0)
 I FHTOT S MAN=S(22)*60 W !!?7,"Man Minutes/Meal:    ",$J(MAN/FHTOT,0,0) S SFHTOT=SFHTOT+FHTOT,SMAN=SMAN+MAN
"RTN","FHADM4",66,0)
 W ! Q
"RTN","FHADM4",67,0)
 ;
"RTN","FHADM4",68,0)
FTOTALS ;Print Final Totals
"RTN","FHADM4",69,0)
 ;
"RTN","FHADM4",70,0)
 W !?6,"All Total",?13 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(SS(K),$E(X,1)+1,$E(X,2))
"RTN","FHADM4",71,0)
 ;
"RTN","FHADM4",72,0)
 ;I ND W !?6,"All Avg.",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(SS(K)/SSND,$E(X,1)+1,$E(X,2))
"RTN","FHADM4",73,0)
 I SS(22) W !?6,"All % Paid",?68 F K=8,9,10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(SS(K)/SS(22)*100,$E(X,1)+1,0)
"RTN","FHADM4",74,0)
 I SSTOT W !!?6,"All Adjustment for Unscheduled and Intermittent",!!?6,"All UNS/INT Total " S SSTOT=SSTOT/8 W $J(TOT,5,1)," FTEE",!?6,"All Adjusted Measured FTEE "
"RTN","FHADM4",75,0)
 S SSTOT=SSTOT+SSTO1 W $J(SSTOT,6,1) ;I ND W !?6,"All Avg Measured FTEE       ",$J(SSTOT/ND,5,1)
"RTN","FHADM4",76,0)
 I SFHTOT S SMAN=SS(22)*60 W !!?6,"Man Minutes/Meal:    ",$J(SMAN/SFHTOT,0,0)
"RTN","FHADM4",77,0)
 W ! Q
"RTN","FHADM4",78,0)
 ;
"RTN","FHADM4",79,0)
HDR ;Print page headers
"RTN","FHADM4",80,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !?4,HDT,?44,"S T A F F I N G   D A T A   W O R K S H E E T",?122,"Page ",PG
"RTN","FHADM4",81,0)
 W !!,?1,NAME
"RTN","FHADM4",82,0)
 W !!?(132-$L(DTE)\2),DTE
"RTN","FHADM4",83,0)
 W !!?15,"| DAILY| CLIN|ADMIN| SUPP| SUPV| MEAS| POT | OFF |WOP| OT|UNS|INT| PAID|COP| AL| SL|OTH|LND|CMP|TRN|VOL|BOR|TOTAL"
"RTN","FHADM4",84,0)
 W !?15,"|  FTEE| FTEE| FTEE| FTEE| FTEE| FTEE| HRS | HRS |HRS|HRS|HRS|HRS| HRS |HRS|HRS|HRS|HRS|HRS|HRS|HRS|HRS|HRS| HRS"
"RTN","FHADM4",85,0)
LN W !?4,"----------------------------------------------------------------------------------------------------------------------------" Q
"RTN","FHADM4",86,0)
 ;
"RTN","FHADM4",87,0)
N1 ;Get specific records
"RTN","FHADM4",88,0)
 I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y3=$G(^FH(117.1,D1,1,CONUM,0)),Y5=$P(Y3,"^"),Y4=$P(Y3,"^",2,99)  Q:COXX=Y5
"RTN","FHADM4",89,0)
 I ZCO="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y3=$G(^FH(117.1,D1,1,CONUM,0)),Y5=$P(Y3,"^"),Y4=$P(Y3,"^",2,99)  Q:COUNT=Y5
"RTN","FHADM4",90,0)
 ;
"RTN","FHADM4",91,0)
 S ND=ND+1,SSND=SSND+1
"RTN","FHADM4",92,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHADM4",93,0)
 K N F L=1:1:20 S N(L)=$P(Y4,"^",L)
"RTN","FHADM4",94,0)
 S N(20)=N(1)-N(2)-N(3)-N(4)-N(5),N(21)=N(20)*8
"RTN","FHADM4",95,0)
 S N(22)=N(21)-N(6)-N(7)+N(8)+N(9)+N(10),N(23)=N(22)-N(11)-N(12)-N(13)-N(14)-N(15)+N(16)+N(17)+N(18)+N(19),TOT=TOT+N(9)+N(10),TO1=TO1+N(20),SSTOT=SSTOT+TOT,SSTO1=SSTO1+TO1
"RTN","FHADM4",96,0)
 W !?4,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",$E(DTP,1,6)," "
"RTN","FHADM4",97,0)
 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S S(K)=S(K)+N(K),X=$P(SIZ," ",K),N(K)=$S('N(K):$J("",$E(X,1)),1:$J(N(K),$E(X,1),$E(X,2))) W "|",N(K)
"RTN","FHADM4",98,0)
 D M1
"RTN","FHADM4",99,0)
 Q
"RTN","FHADM4",100,0)
 ;
"RTN","FHADM4",101,0)
M1 ; Get total Meals
"RTN","FHADM4",102,0)
 ; S Y1=$G(^FH(117,D1,0)) Q:Y1=""  I '$D(^FH(117,D1,1)) Q  S Y2=$G(^FH(117,D1,1)) Q
"RTN","FHADM4",103,0)
 ;
"RTN","FHADM4",104,0)
 ;I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y1=$G(^FH(117,D1,2,CONUM,1)) S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^",2,99) Q:COXX=CONUM 
"RTN","FHADM4",105,0)
 ;BREAK  I ZCO="Y" F CONUM=1:1 Q:CONUM>ZOUT  S Y1=$G(^FH(117,D1,2,CONUM,1)) Q:Y1=""  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y6=$P(Y0,U,1),Y2=$P(Y0,U,2,99) Q:COUNT=CONUM
"RTN","FHADM4",106,0)
 ;
"RTN","FHADM4",107,0)
 ;S Y1=$G(^FH(117,D1,0)) Q:Y1=""  S Y2=$G(^FH(117,D1,1))
"RTN","FHADM4",108,0)
 Q:$G(^FH(117,D1,2,0))=""  S Y1=$G(^FH(117,D1,2,CONUM,1)),Y2=$G(^FH(117,D1,2,CONUM,0))
"RTN","FHADM4",109,0)
 K M S K=0 F L=1,2,4,5,7,8 S K=K+1,M(L)=$P(Y1,"^",K)
"RTN","FHADM4",110,0)
 S K=10 F L=2:3:17 S K=K+1,M(K)=$P(Y2,"^",L)+$P(Y2,"^",L+1)+$P(Y2,"^",L+2)
"RTN","FHADM4",111,0)
 S M(3)=M(1)-M(2)*3,M(6)=M(4)-M(5)*3,M(9)=M(7)-M(8)*3
"RTN","FHADM4",112,0)
 S M(10)=M(3)+M(6)+M(9)
"RTN","FHADM4",113,0)
 S M(16)=M(14)+M(15)+M(16),M(13)=M(12)+M(13),M(17)=M(11)+M(13)+M(16),M(18)=M(10)+M(17)
"RTN","FHADM4",114,0)
 S FHTOT=FHTOT+M(18) Q
"RTN","FHADM4",115,0)
 ;
"RTN","FHADM4",116,0)
N2 ;Get Communications Offices
"RTN","FHADM4",117,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHADM4",118,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHADM4",119,0)
 I Y=-1 G PRINT Q
"RTN","FHADM4",120,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME,CONUMX=$L(CO,"^") G N2
"RTN","FHADM4",121,0)
 I Y=-1 K DIC Q
"RTN","FHADM4",122,0)
 Q
"RTN","FHADM4",123,0)
 ;
"RTN","FHADM4",124,0)
KIL G KILL^XUSCLEAN
"RTN","FHASE")
0^1^B20952042
"RTN","FHASE",1,0)
FHASE ; HISC/REL/NCA - Dietetic Encounters ;7/22/96  13:17
"RTN","FHASE",2,0)
 ;;5.0;Dietetics;**5,7,39**;Jun 07, 1995
"RTN","FHASE",3,0)
EN1 ; Enter/Edit Encounter Types
"RTN","FHASE",4,0)
 S (DIC,DIE)="^FH(115.6,",DIC(0)="AEQLM",DIC("DR")=".01",DLAYGO=115.6 W ! D ^DIC K DIC,DLAYGO G KIL:"^"[X!$D(DTOUT),EN1:Y<1
"RTN","FHASE",5,0)
 S DA=+Y,DR=$S(DA=1:2,DA=2:"2;3",1:".01;1:4;10;5:6;I X'=""Y"" S Y=99;7;8;99") S:$D(^XUSEC("FHMGR",DUZ)) DIDEL=115.6 D ^DIE,KIL G EN1
"RTN","FHASE",6,0)
 ;
"RTN","FHASE",7,0)
EN2 ; List Encounter Types
"RTN","FHASE",8,0)
 W ! S L=0,DIC="^FH(115.6,",FLDS=".01,2,3,4,10,5,6,7,8,99",BY=".01"
"RTN","FHASE",9,0)
 S (FR,TO)="",DHD="ENCOUNTER TYPES" D EN1^DIP,RSET Q
"RTN","FHASE",10,0)
 ;
"RTN","FHASE",11,0)
EN3 ; Enter Dietetic Encounter
"RTN","FHASE",12,0)
 W ! K DIR S DIR(0)="YAO",DIR("A")="Enter a NEW Encounter (Y/N)? " D ^DIR G:$D(DIROUT)!($D(DIRUT)) KIL K DIR,DIROUT,DIRUT
"RTN","FHASE",13,0)
 I 'Y S FHN=1 G EN4
"RTN","FHASE",14,0)
 ;
"RTN","FHASE",15,0)
EN30 ; Enter/Edit a Encounter
"RTN","FHASE",16,0)
 D EN31 G:Y<1 KIL G EN3
"RTN","FHASE",17,0)
 ;
"RTN","FHASE",18,0)
EN31 ; Enter a Encounter
"RTN","FHASE",19,0)
 S FHN=0 K %DT S %DT="AETPX",%DT("A")="DATE/TIME OF ENCOUNTER: ",%DT("B")="TODAY",%DT(0)="-NOW" W ! D ^%DT K %DT S:$D(DTOUT) Y=0 Q:Y<1  S DTE=Y
"RTN","FHASE",20,0)
 K DIC,DD,DO S DIC="^FHEN(",DIC(0)="L",DIC("DR")="1////^S X=DTE",DLAYGO=115.7
"RTN","FHASE",21,0)
A L +^FHEN(0) S DA=$P(^FHEN(0),"^",3)+1 I $D(^FHEN(DA)) S $P(^FHEN(0),"^",3)=DA L -^FHEN(0) G A
"RTN","FHASE",22,0)
 S (X,DINUM)=DA D FILE^DICN L -^FHEN(0) S ASE=+Y,FHX4="" K DIC,DLAYGO,DINUM
"RTN","FHASE",23,0)
 D EDIT Q
"RTN","FHASE",24,0)
 ;
"RTN","FHASE",25,0)
EN4 ; Process Edit Encounter
"RTN","FHASE",26,0)
 ;
"RTN","FHASE",27,0)
 W ! K ^TMP($J,"ECTR"),%DT S %DT="AEPX",%DT("A")="Enter Date of Encounter you want to edit: " D ^%DT K %DT S:$D(DTOUT) Y=0 G:Y<1 KIL S X1=Y,(TIM,X1)=X1-.0001,(EDT,X2)=Y\1+.3,CTR=0
"RTN","FHASE",28,0)
A0 W !! K DIR S DIR(0)="SO^C:CLINICIAN;P:PATIENT",DIR("A")="CHOOSE CLINICIAN or PATIENT" D ^DIR K DIR G:$D(DIROUT)!($D(DIRUT)) KIL I Y?1"P" D PAT G:'DFN KIL D PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHASE",29,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S NAM=+Y D CLIN,PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHASE",30,0)
PR W ! S K1="" F CTR=0:0 S CTR=$O(^TMP($J,"ECTR",CTR)) Q:CTR<1  S X=$G(^(CTR,0)),K1=CTR W !,CTR,"  " S Y=$P(X,"^",2) X ^DD("DD") W Y,"  ",$P(X,"^",3) K Y
"RTN","FHASE",31,0)
 I 'K1 W !?5,"No encounter on file on this date" S Y=0 Q
"RTN","FHASE",32,0)
 W !!,"Select number you want: " R X:DTIME I '$T!("^"[X) S Y=0 Q
"RTN","FHASE",33,0)
 I X'?1.N!(X<1)!(X>K1) W *7,!!,"Select only a number no greater than ",K1," or press ""^"" or a return to exit." G PR
"RTN","FHASE",34,0)
 S ASE=$P($G(^TMP($J,"ECTR",+X,0)),"^",1),FHX4=$G(^FHEN(ASE,0))
"RTN","FHASE",35,0)
 S FHCLK=$P($G(^TMP($J,"ECTR",+X,0)),"^",4) W !
"RTN","FHASE",36,0)
 ;
"RTN","FHASE",37,0)
EDIT N FHX1 S DA=ASE K DIC,DIE S DIE="^FHEN(",DR="[FHASE]" D ^DIE K DIC,DIE,DR
"RTN","FHASE",38,0)
 S DA=ASE,X=^FHEN(DA,0)
"RTN","FHASE",39,0)
 I '$P(X,"^",3)!('$P(X,"^",4)) S DIK="^FHEN(" D ^DIK W *7,!,"<encounter deleted>" K DIK,DA
"RTN","FHASE",40,0)
 S Y=1 Q
"RTN","FHASE",41,0)
 ;
"RTN","FHASE",42,0)
PAT ; Get Patient
"RTN","FHASE",43,0)
 S ALL=1 D ^FHDPA Q:'DFN
"RTN","FHASE",44,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"Patient has expired." G PAT
"RTN","FHASE",45,0)
 I '$D(^FHEN("AP",DFN)) W !!,"No Encounter on file for this patient." G PAT
"RTN","FHASE",46,0)
 F DTE=TIM:0 S DTE=$O(^FHEN("AP",DFN,DTE)) Q:DTE<1!(DTE>EDT)  F ASE=0:0 S ASE=$O(^FHEN("AP",DFN,DTE,ASE)) Q:ASE<1  S Y=$P($G(^FHEN(ASE,0)),"^",4) I Y>2 D
"RTN","FHASE",47,0)
 .S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_DTE_"^"_$P($G(^FH(115.6,+Y,0)),"^",1)_"^"_$P($G(^FHEN(ASE,0)),"^",13) Q
"RTN","FHASE",48,0)
 Q
"RTN","FHASE",49,0)
CLIN ; Get Clinician
"RTN","FHASE",50,0)
 S X1=$O(^FHEN("AT",X1)) Q:X1<1!(X1>X2)
"RTN","FHASE",51,0)
 S ASE=0
"RTN","FHASE",52,0)
 ;
"RTN","FHASE",53,0)
R1 S ASE=$O(^FHEN("AT",X1,ASE)) G:ASE="" CLIN
"RTN","FHASE",54,0)
 S Y=$G(^FHEN(ASE,0)),E1=$P(Y,"^",3) I $P(Y,"^",4)>2,E1,E1=NAM S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_$P(Y,"^",2)_"^"_$P($G(^FH(115.6,+$P(Y,"^",4),0)),"^",1)_"^"_$P(Y,"^",13),DTE=$P(Y,"^",2)
"RTN","FHASE",55,0)
 G R1
"RTN","FHASE",56,0)
 ;
"RTN","FHASE",57,0)
ASK R !!,"Is this correct? Y// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHASE",58,0)
 S:YN="" YN="Y" S X=YN D TR^FH S YN=X
"RTN","FHASE",59,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G ASK
"RTN","FHASE",60,0)
 Q:YN?1"Y".E
"RTN","FHASE",61,0)
 I FHCLK'=DUZ W !!,"You can ONLY DELETE an encounter that is entered by you.",! G EDIT
"RTN","FHASE",62,0)
 ;
"RTN","FHASE",63,0)
E5 R !,"Want to delete encounter? N// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHASE",64,0)
 S:YN="" YN="N" S X=YN D TR^FH S YN=X
"RTN","FHASE",65,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G E5
"RTN","FHASE",66,0)
 Q:YN?1"N".E
"RTN","FHASE",67,0)
 S DIK="^FHEN(",DA=ASE D ^DIK W *7,!,"<encounter deleted>" K DA,DIK S Y=1 Q
"RTN","FHASE",68,0)
 ;
"RTN","FHASE",69,0)
CNT S FHX3=FHX3+$P($G(^FHEN(ASE,"P",0)),"^",4)
"RTN","FHASE",70,0)
 S ST="" F LP=0:0 S LP=$O(^FHEN(ASE,"P",LP)) Q:LP<1  S ST=$G(^(LP,0)) I $P(ST,"^",3)'<1 S FHX3=FHX3+$P(ST,"^",3)
"RTN","FHASE",71,0)
 Q
"RTN","FHASE",72,0)
 ;
"RTN","FHASE",73,0)
RSET K %ZIS S IOP="" D ^%ZIS
"RTN","FHASE",74,0)
 ;
"RTN","FHASE",75,0)
KIL K ^TMP($J,"ECTR") G KILL^XUSCLEAN
"RTN","FHASE",76,0)
 ;
"RTN","FHASE1")
0^2^B10830397
"RTN","FHASE1",1,0)
FHASE1 ; HISC/REL/NCA/AAC - Encounter Statistics ;3/6/95  11:57
"RTN","FHASE1",2,0)
 ;;5.0;Dietetics;**39**;Oct 11, 1995
"RTN","FHASE1",3,0)
 ;
"RTN","FHASE1",4,0)
 ;Encounter Statistic
"RTN","FHASE1",5,0)
 ;
"RTN","FHASE1",6,0)
 S HEADER="S T A T I S T I C S"
"RTN","FHASE1",7,0)
 S (Y,CO)=""
"RTN","FHASE1",8,0)
 D COM
"RTN","FHASE1",9,0)
 I (Y=-1)&(CO="") Q
"RTN","FHASE1",10,0)
 D DT G:U[X KIL
"RTN","FHASE1",11,0)
 D A0
"RTN","FHASE1",12,0)
 Q
"RTN","FHASE1",13,0)
 ;
"RTN","FHASE1",14,0)
IND ;List Encounters
"RTN","FHASE1",15,0)
 ;
"RTN","FHASE1",16,0)
 S HEADER="V I S I T S "
"RTN","FHASE1",17,0)
 S (Y,CO)=""
"RTN","FHASE1",18,0)
 D COM
"RTN","FHASE1",19,0)
 I (Y=-1)&(CO="") Q
"RTN","FHASE1",20,0)
 D DT G:U[X KIL S FHX1=DUZ,FHX2=0
"RTN","FHASE1",21,0)
 D F1
"RTN","FHASE1",22,0)
 Q
"RTN","FHASE1",23,0)
 ;
"RTN","FHASE1",24,0)
COM ; List Encounters for a clinician
"RTN","FHASE1",25,0)
 S (ZCO,CO,COXX,CONAME,CONAM)=""
"RTN","FHASE1",26,0)
 R !!,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHASE1",27,0)
 I ZCO'="Y" D N2 Q
"RTN","FHASE1",28,0)
 Q 
"RTN","FHASE1",29,0)
 ;
"RTN","FHASE1",30,0)
A0 R !!,"Statistics for ALL Clinicians? Y// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G A0
"RTN","FHASE1",31,0)
 I X?1"Y".E G F0
"RTN","FHASE1",32,0)
 ;
"RTN","FHASE1",33,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S FHX1=+Y,FHX2=1 G F1
"RTN","FHASE1",34,0)
 ;
"RTN","FHASE1",35,0)
F0 R !!,"Break-down by Clinician? Y// ",X:DTIME G:'$T!(X=U) KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G F0
"RTN","FHASE1",36,0)
 S FHX1=X?1"Y".E-1,FHX2=0
"RTN","FHASE1",37,0)
 ;
"RTN","FHASE1",38,0)
F1 I FHX1'<0 R !!,"List Individual Patient Encounters? N// ",X:DTIME G:'$T!(X=U) KIL S:X="" X="N" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G F1
"RTN","FHASE1",39,0)
 S:FHX1'<0 FHX2=X?1"Y".E
"RTN","FHASE1",40,0)
 ;
"RTN","FHASE1",41,0)
F2 W !!,"The report requires a 132 column printer.",!
"RTN","FHASE1",42,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHASE1",43,0)
 I $D(IO("Q")) S FHPGM="Q1^FHASE1A",FHLST="HEADER^EDT^SDT^FHX1^FHX2^ZCO^NAME^CONUMX^CO^CONAME" D EN2^FH Q 
"RTN","FHASE1",44,0)
 U IO D Q1^FHASE1A D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHASE1",45,0)
 ;
"RTN","FHASE1",46,0)
KIL ;
"RTN","FHASE1",47,0)
 K ^TMP($J) G KILL^XUSCLEAN Q
"RTN","FHASE1",48,0)
 Q
"RTN","FHASE1",49,0)
 ;
"RTN","FHASE1",50,0)
DT ; Get From/To Dates
"RTN","FHASE1",51,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHASE1",52,0)
 I SDT>DT W *7,"  [Cannot Start after Today!] " G D1
"RTN","FHASE1",53,0)
 ;
"RTN","FHASE1",54,0)
D2 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHASE1",55,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHASE1",56,0)
 I EDT>DT W *7,"  [Must Not enter date greater than Today!] " G D1
"RTN","FHASE1",57,0)
 Q
"RTN","FHASE1",58,0)
N2 ;Get Communications Office
"RTN","FHASE1",59,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHASE1",60,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHASE1",61,0)
 I Y=-1 Q
"RTN","FHASE1",62,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHASE1",63,0)
 I Y=-1 K DIC Q
"RTN","FHASE1",64,0)
 Q
"RTN","FHASE1",65,0)
QUIT ;
"RTN","FHASE1",66,0)
 Q
"RTN","FHASE1A")
0^3^B40851280
"RTN","FHASE1A",1,0)
FHASE1A ; HISC/REL/NCA/AAC - Encounter Statistics (cont.) ;9/6/94  13:13 
"RTN","FHASE1A",2,0)
 ;;5.0;Dietetics;**39**;Oct 11, 1995
"RTN","FHASE1A",3,0)
Q1 ; Calculate the Encounters
"RTN","FHASE1A",4,0)
 K ^TMP($J)
"RTN","FHASE1A",5,0)
 S YX1=SDT\1-.0001,YX2=EDT\1+.3
"RTN","FHASE1A",6,0)
 S TIT=";"_$P(^DD(115.6,10,0),"^",3)
"RTN","FHASE1A",7,0)
 S D1XX="FHASE1A"
"RTN","FHASE1A",8,0)
 S XX1=YX1
"RTN","FHASE1A",9,0)
 S (XXX,XX2,XX3,X3,XY,YY1)="",(COUNT,LL,L,D1F,D1CNTX,NUMBER)=0
"RTN","FHASE1A",10,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHASE1A",11,0)
 F K=1:1:11 S II(K)=0,JJ(K)=0
"RTN","FHASE1A",12,0)
 ;
"RTN","FHASE1A",13,0)
Q2 ;Get Communications Offices
"RTN","FHASE1A",14,0)
 S (SS1,DD1,DD2,DD3,DD4,E1,COXX1,D1X,DIF,D1CNTX)=0,(NX,WW1)=""
"RTN","FHASE1A",15,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX<1 ALLTOT S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX)
"RTN","FHASE1A",16,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT ALLTOT S REC=$G(^FH(119.73,COUNT,0)),NAME=$P(REC,"^",1)
"RTN","FHASE1A",17,0)
 ;
"RTN","FHASE1A",18,0)
R2 ;Find Patient records within parameters
"RTN","FHASE1A",19,0)
 I ZCO'="Y" G:$D(^FH(119.73,COXX,"I")) Q2 G:'$D(^FH(119.73,COXX,0)) Q2
"RTN","FHASE1A",20,0)
 I ZCO="Y" G:$D(^FH(119.73,COUNT,"I")) Q2 G:'$D(^FH(119.73,COUNT,0)) Q2
"RTN","FHASE1A",21,0)
 ;
"RTN","FHASE1A",22,0)
 S YX1=SDT\1-.0001,YX2=EDT\1+.3,XX1=YX1
"RTN","FHASE1A",23,0)
 ;
"RTN","FHASE1A",24,0)
R1 F  S XX1=$O(^FHEN("AT",XX1)) G:XX1'>0 P1 G:XX1>YX2 P1  D 
"RTN","FHASE1A",25,0)
R11 .S XXX=XX1 F E1=0:0 S E1=$O(^FHEN("AT",XXX,E1)) Q:E1'>0  D 
"RTN","FHASE1A",26,0)
 ..I XX1>YX2 Q
"RTN","FHASE1A",27,0)
 ..S XX2=$G(^FHEN(E1,0))
"RTN","FHASE1A",28,0)
 ..I ZCO'="Y" S XY=$P(XX2,"^",6) Q:COXX'=XY
"RTN","FHASE1A",29,0)
 ..I ZCO="Y" S XY=$P(XX2,"^",6) Q:COUNT'=XY
"RTN","FHASE1A",30,0)
 ..S Y=$G(^FHEN(E1,0))
"RTN","FHASE1A",31,0)
 ..S D1=$P(Y,"^",3) S D2=$P(Y,"^",4),D4=$P(Y,"^",6) Q:'D2  Q:'D4
"RTN","FHASE1A",32,0)
 ..I FHX1>0,D1'=FHX1 Q
"RTN","FHASE1A",33,0)
 ..I $D(^FH(119.73,D4,"I")) Q
"RTN","FHASE1A",34,0)
 ..S D6=$P(Y,"^",7),D3=$P(Y,"^",8),D9=$P(Y,"^",9),D5=$P(Y,"^",11) D C0
"RTN","FHASE1A",35,0)
 ..S D2=$P($G(^FH(115.6,D2,0)),"^",1,2) Q:"^"[D2
"RTN","FHASE1A",36,0)
 ..S Z1=$P(D2,"^",2),D2=$P(D2,"^",1)
"RTN","FHASE1A",37,0)
 ..S D8=$F(TIT,";"_Z1_":") Q:D8<0
"RTN","FHASE1A",38,0)
 ..S:D6="F" D2=D2_"~F"
"RTN","FHASE1A",39,0)
 ..S S1=$G(^TMP($J,0,D8,D2,D4)) D UPD S ^TMP($J,0,D8,D2,D4)=S1
"RTN","FHASE1A",40,0)
 ..S S1=$G(^TMP($J,D1,D8,D2,D4)) D UPD S ^TMP($J,D1,D8,D2,D4)=S1 S DD1=D1,DD8=D8,DD2=D2,DD4=D4 Q:'FHX2
"RTN","FHASE1A",41,0)
 ..S (DTP,W1)=$P(Y,"^",2)\1 D DTP^FH I '$D(^TMP($J,D1,D8,D2,D4,W1)) S ^TMP($J,D1,D8,D2,D4,W1)=DTP,^(W1,0)=0 S D2=DD2,D3=DD3,D4=DD4 I '$D(^FHEN(E1,"P")) Q
"RTN","FHASE1A",42,0)
 ..F DFN=0:0 S DFN=$O(^FHEN(E1,"P",DFN)) Q:DFN<1  D R3
"RTN","FHASE1A",43,0)
 ..Q
"RTN","FHASE1A",44,0)
 .Q
"RTN","FHASE1A",45,0)
 Q
"RTN","FHASE1A",46,0)
 G R11
"RTN","FHASE1A",47,0)
 ;
"RTN","FHASE1A",48,0)
R3 ;
"RTN","FHASE1A",49,0)
 S L=^TMP($J,D1,D8,D2,D4,W1,0)+1,^(0)=L S WW1=W1
"RTN","FHASE1A",50,0)
 S ^TMP($J,D1,D8,D2,D4,W1,L)=DFN Q
"RTN","FHASE1A",51,0)
 ;
"RTN","FHASE1A",52,0)
R4 ;
"RTN","FHASE1A",53,0)
 S DFN="^"_D5 D R3 G R2
"RTN","FHASE1A",54,0)
 ;
"RTN","FHASE1A",55,0)
C0 ;
"RTN","FHASE1A",56,0)
 S C(8)=$P(Y,"^",10),(C(1),C(2),C(3),C(4),C(5),C(6),C(7))=0
"RTN","FHASE1A",57,0)
 F DFN=0:0 S DFN=$O(^FHEN(E1,"P",DFN)) Q:DFN<1  S X=^(DFN,0) D C1
"RTN","FHASE1A",58,0)
 S C(7)=C(8)-C(1)-C(2)-C(4)-C(5) S:C(7)<1 C(7)=0
"RTN","FHASE1A",59,0)
 I D9'="I" S TM=C(1)+C(4)+C(7) I TM S TM=D3/TM,C(3)=TM*C(1),C(6)=TM*C(4),C(3)=$J(C(3),0,1),C(6)=$J(C(6),0,1) Q
"RTN","FHASE1A",60,0)
 Q
"RTN","FHASE1A",61,0)
 ;
"RTN","FHASE1A",62,0)
C1 ;
"RTN","FHASE1A",63,0)
 S Z=$P(X,"^",2) G:Z<1 C2 S Z=$P($G(^SC(+Z,0)),"^",3) G:Z'="W" C2
"RTN","FHASE1A",64,0)
 S C(1)=C(1)+1,C(2)=C(2)+$P(X,"^",3) S:D9="I" C(3)=C(3)+D3 Q
"RTN","FHASE1A",65,0)
 ;
"RTN","FHASE1A",66,0)
C2 ;
"RTN","FHASE1A",67,0)
 S C(4)=C(4)+1,C(5)=C(5)+$P(X,"^",3) S:D9="I" C(6)=C(6)+D3 Q
"RTN","FHASE1A",68,0)
 ;
"RTN","FHASE1A",69,0)
UPD ;Update S1 record
"RTN","FHASE1A",70,0)
 S $P(S1,"^",1)=$P(S1,"^",1)+1,$P(S1,"^",2)=$P(S1,"^",2)+D3
"RTN","FHASE1A",71,0)
 F K=1:1:8 I C(K) S $P(S1,"^",K+2)=$P(S1,"^",K+2)+C(K)
"RTN","FHASE1A",72,0)
 Q
"RTN","FHASE1A",73,0)
 ;
"RTN","FHASE1A",74,0)
P1 ;load data by paramters/totals for each Communication Office
"RTN","FHASE1A",75,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP,PG=0 D HEAD ;I FHX1>0 S NAM="" D D0
"RTN","FHASE1A",76,0)
 S (NX,D8)="",CT=0 F K=1:1:11 S (I(K),J(K))=0
"RTN","FHASE1A",77,0)
 F KK=0:0 S D8=$O(^TMP($J,0,D8)) Q:D8=""  S CT=CT+1 D:CT'=1 STOT W ! D PR S NX="" F K=0:0 S NX=$O(^TMP($J,0,D8,NX)) Q:NX=""  S X1=$P(NX,"~",1)_$S($P(NX,"~",2)="F":"  (F)",1:"") Q:X1=""  S S1=^TMP($J,0,D8,NX,D4) D PP
"RTN","FHASE1A",78,0)
 D STOT W ! S X=" T O T A L" D PX D TOT W ! F K=1:1:11 S (I(K),J(K))=0 I FHX1<0 G Q2 D HEAD I FHX2<0 D Q2
"RTN","FHASE1A",79,0)
 ;
"RTN","FHASE1A",80,0)
 ;
"RTN","FHASE1A",81,0)
P2 ;load data for each clinician
"RTN","FHASE1A",82,0)
 D:$Y>55 HEAD S (D8,NAM)="",CT=0
"RTN","FHASE1A",83,0)
 S D8=0
"RTN","FHASE1A",84,0)
 F D1=0:0 S D1=$O(^TMP($J,D1)) G:D1="" P2A S CT=CT+1 D:CT'=1 STOT W ! F D8=0:0 S D8=$O(^TMP($J,D1,D8)) Q:D8'>0  D PR,D0 S D2="" F L1=0:0 S D2=$O(^TMP($J,D1,D8,D2)) Q:D2=""  S S1=$G(^TMP($J,D1,D8,D2,D4)) Q:S1=""   D SETX1,PP I FHX2 D P3
"RTN","FHASE1A",85,0)
 D STOT G P2
"RTN","FHASE1A",86,0)
P2A D STOT W ! S X=" TOTAL ENCOUNTERS" D TOT W @IOF D DEL S X1=SDT G Q2
"RTN","FHASE1A",87,0)
 ;
"RTN","FHASE1A",88,0)
SETX1 ;
"RTN","FHASE1A",89,0)
 S X1=$P(D2,"~",1)_$S($P(D2,"~",2)="F":"  (F)",1:"")
"RTN","FHASE1A",90,0)
 Q
"RTN","FHASE1A",91,0)
D0 ;Get Clinician Name
"RTN","FHASE1A",92,0)
 I FHX1>0 S D1=FHX1
"RTN","FHASE1A",93,0)
 S NAM=$P(^VA(200,D1,0),"^",1),NAM=$E(NAM,1,30) W !,NAM Q
"RTN","FHASE1A",94,0)
 ;
"RTN","FHASE1A",95,0)
P3 ;
"RTN","FHASE1A",96,0)
 S DTP=""
"RTN","FHASE1A",97,0)
 ;
"RTN","FHASE1A",98,0)
P4 ;
"RTN","FHASE1A",99,0)
 S DTP=$O(^TMP($J,D1,D8,D2,D4,DTP)) Q:DTP=""  S S1=^(DTP),W1=0
"RTN","FHASE1A",100,0)
 ;
"RTN","FHASE1A",101,0)
P5 ;
"RTN","FHASE1A",102,0)
 S W1=$O(^TMP($J,D1,D8,D2,D4,DTP,W1)) G:W1="" P4 S DFN=^(W1) G:DFN<1 P6
"RTN","FHASE1A",103,0)
 S Y=$G(^DPT(DFN,0)) G:Y="" P5 D PID^FHDPA
"RTN","FHASE1A",104,0)
 W !?7,S1,?17,BID,?26,$P(Y,"^",1) G P5
"RTN","FHASE1A",105,0)
 ;
"RTN","FHASE1A",106,0)
P6 ;
"RTN","FHASE1A",107,0)
 W !?7,S1,?17,$P(DFN,"^",2) G P5
"RTN","FHASE1A",108,0)
 ;
"RTN","FHASE1A",109,0)
PP ;Print totals for Communications Offices
"RTN","FHASE1A",110,0)
 D:$Y>58 HEAD W !?5,X1,?47,$J($P(S1,"^",1),6,0) S I(1)=I(1)+$P(S1,"^",1),J(1)=J(1)+$P(S1,"^",1)  ;)
"RTN","FHASE1A",111,0)
 F K=1:1:6 S Z=$P(S1,"^",K+2),I(K+2)=I(K+2)+Z,J(K+2)=J(K+2)+Z W $S(K=3!(K=6):$S(Z:$J(Z,8,1),1:$J("",8)),1:$J($S(Z:Z,1:""),6))
"RTN","FHASE1A",112,0)
 S Z=$P(S1,"^",9),I(9)=I(9)+$S(Z'<1:Z,1:0),J(9)=J(9)+$S(Z'<1:Z,1:0) W ?97,$J($S(Z'<1:Z,1:""),6)
"RTN","FHASE1A",113,0)
 ;
"RTN","FHASE1A",114,0)
 I Z S Z=$P(S1,"^",2)-$P(S1,"^",5)-$P(S1,"^",8),I(10)=I(10)+$S(Z'<1:Z,1:0),J(10)=J(10)+$S(Z'<1:Z,1:0)
"RTN","FHASE1A",115,0)
 ;
"RTN","FHASE1A",116,0)
 W $S(Z'<1:$J(Z,8,1),1:$J("",8))
"RTN","FHASE1A",117,0)
 S Z=$P(S1,"^",10),I(11)=I(11)+Z,J(11)=J(11)+Z W ?113,$J($S(Z'<1:Z,1:""),6)
"RTN","FHASE1A",118,0)
 I $P(S1,"^",2) W $J($P(S1,"^",2),8,1) S I(2)=I(2)+$P(S1,"^",2),J(2)=J(2)+$P(S1,"^",2)
"RTN","FHASE1A",119,0)
 ;
"RTN","FHASE1A",120,0)
 Q
"RTN","FHASE1A",121,0)
 ;
"RTN","FHASE1A",122,0)
PX ;Accumulate amount for final total
"RTN","FHASE1A",123,0)
 S II(1)=II(1)+I(1)  ;,II(3)=II(3)+I(3),II(6)=II(6)+I(6)
"RTN","FHASE1A",124,0)
 F K=1:1:6 S II(K+2)=II(K+2)+I(K+2) ;,II(K+2)=II(K+2)+I(K+2)
"RTN","FHASE1A",125,0)
 S II(9)=II(9)+I(9),II(10)=II(10)+I(10),II(11)=II(11)+I(11)
"RTN","FHASE1A",126,0)
 Q
"RTN","FHASE1A",127,0)
 ;
"RTN","FHASE1A",128,0)
PR ;
"RTN","FHASE1A",129,0)
 S X=$P($E(TIT,D8,999),";",1)
"RTN","FHASE1A",130,0)
 D:$Y>55 HEAD W !?3,X Q
"RTN","FHASE1A",131,0)
 Q
"RTN","FHASE1A",132,0)
 ;
"RTN","FHASE1A",133,0)
STOT ;Print sub-totals for Communications Office and Clinician
"RTN","FHASE1A",134,0)
 W !?5,"Subtotal",?47,$J(J(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(J(K+2):$J(J(K+2),8,1),1:$J("",8)),1:$J($S(J(K+2):J(K+2),1:""),6))
"RTN","FHASE1A",135,0)
 W ?97,$S(J(9):$J(J(9),6),1:$J("",6)),$S(J(10):$J(J(10),8,1),1:$J("",8))
"RTN","FHASE1A",136,0)
 W ?113,$S(J(11):$J(J(11),6),1:$J("",6)),$S(J(2):$J(J(2),8,1),1:$J("",8)) W !
"RTN","FHASE1A",137,0)
 F K=1:1:11 S J(K)=0
"RTN","FHASE1A",138,0)
 Q
"RTN","FHASE1A",139,0)
 ;
"RTN","FHASE1A",140,0)
TOT ;
"RTN","FHASE1A",141,0)
 ;Totals by Communications Offices
"RTN","FHASE1A",142,0)
 W !?3,NAME,X,?47,$J(I(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(I(K+2):$J(I(K+2),8,1),1:$J("",8)),1:$J($S(I(K+2):I(K+2),1:""),6))
"RTN","FHASE1A",143,0)
 W ?97,$S(I(9):$J(I(9),6),1:$J("",6)),$S(I(10):$J(I(10),8,1),1:$J("",8))
"RTN","FHASE1A",144,0)
 W ?113,$S(I(11):$J(I(11),6),1:$J("",6)),$S(I(2):$J(I(2),8,1),1:$J("",8))
"RTN","FHASE1A",145,0)
 F K=1:1:11 S I(K)=0
"RTN","FHASE1A",146,0)
 Q
"RTN","FHASE1A",147,0)
 ;
"RTN","FHASE1A",148,0)
ALLTOT ; 
"RTN","FHASE1A",149,0)
 ;Final Totals - all Communication Offices
"RTN","FHASE1A",150,0)
 S XS="ALL COMMUNICATIONS OFFICES " W !!,XS,?47,$J(II(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(II(K+2):$J(II(K+2),8,1),1:$J("",8)),1:$J($S(II(K+2):II(K+2),1:""),6))
"RTN","FHASE1A",151,0)
 W ?97,$S(II(9):$J(I(9),6),1:$J("",6)),$S(II(10):$J(II(10),8,1),1:$J("",8))
"RTN","FHASE1A",152,0)
 W ?113,$S(II(11):$J(II(11),6),1:$J("",6)) W $S(II(5):$J(II(5),8,1),1:$J("",6))
"RTN","FHASE1A",153,0)
 D DEL Q
"RTN","FHASE1A",154,0)
 ;
"RTN","FHASE1A",155,0)
HEAD ;Print page headers
"RTN","FHASE1A",156,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !?30,"D I E T E T I C   E N C O U N T E R  ",?69,HEADER,?120,"Page ",PG
"RTN","FHASE1A",157,0)
 W !?2,NAME,?(114-$L(DTE)\2),DTE,!?47,"Number      Inpatients         Outpatients            Others           Total"
"RTN","FHASE1A",158,0)
 W !?56,"Pat   Col   Units   Pat   Col   Units",?98,"Persn   Units   Persn   Units",! Q
"RTN","FHASE1A",159,0)
 ;
"RTN","FHASE1A",160,0)
DEL ;DELETE RECORDS FROM ^TMP
"RTN","FHASE1A",161,0)
 K ^TMP($J)
"RTN","FHASE1A",162,0)
 W !!
"RTN","FHASE1A",163,0)
 Q
"RTN","FHASE1A",164,0)
Q ;
"RTN","FHASE1A",165,0)
QUIT ;
"RTN","FHASE1A",166,0)
 Q
"RTN","FHLABEL")
0^10^B9674043
"RTN","FHLABEL",1,0)
FHLABEL ; HISC/RTK - Laser label sheet build and display;9/27/02  9:25
"RTN","FHLABEL",2,0)
 ;;5.0;Dietetics;**38,39**;Mar 25, 1996
"RTN","FHLABEL",3,0)
LAB ;
"RTN","FHLABEL",4,0)
 S FHCOL=$S(LAB=3:3,1:2)
"RTN","FHLABEL",5,0)
 I LABSTART>1 F FHLABST=1:1:(LABSTART-1)*FHCOL D  S LABSTART=1
"RTN","FHLABEL",6,0)
 .I LAB=3 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6)="" D LL3^FHLABEL
"RTN","FHLABEL",7,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6,PCL7,PCL8)="" D LL4^FHLABEL
"RTN","FHLABEL",8,0)
 .Q
"RTN","FHLABEL",9,0)
 S FHTAB=$S(LAB=3:24,1:37)
"RTN","FHLABEL",10,0)
 S BIDX1=BID_$E("          ",1,12-$L(BID))_X1,BXLN=$L(BIDX1)
"RTN","FHLABEL",11,0)
 S N1=$E(N1,1,FHTAB-$L(W1)),DTP=$E(DTP,1,9)
"RTN","FHLABEL",12,0)
 S FLG=0,(LS,LS2)="" I LAB>2 F D=1:1:5 D  Q:FLG=1
"RTN","FHLABEL",13,0)
 .S P=$P(Y,", ",D) I P="" S FLG=1 Q
"RTN","FHLABEL",14,0)
 .S TL=$L(LS)+$L(P)+1,NUM=$S(LAB=3:26,1:38)
"RTN","FHLABEL",15,0)
 .I TL<NUM S LS=LS_P_","
"RTN","FHLABEL",16,0)
 .I TL>(NUM-1) S LS2=LS2_P_","
"RTN","FHLABEL",17,0)
 S LNA=N1_$J(W1,FHTAB+1-$L(N1)),LNB=BIDX1_$J(R1,FHTAB+1-$L(BIDX1))
"RTN","FHLABEL",18,0)
 S LNC=$S(LS2="":$E(LS,1,$L(LS)-1),1:LS)
"RTN","FHLABEL",19,0)
 S LND=$E(LS2,1,$L(LS2)-1)
"RTN","FHLABEL",20,0)
 I LAB=3 S PCL1="",PCL2=LNA,PCL3=LNB,PCL4=LNC,PCL5=$E(LND,1,25),PCL6=DTP D LL3 Q
"RTN","FHLABEL",21,0)
 I LAB=4 S (PCL1,PCL2,PCL8)="",PCL3=LNA,PCL4=LNB,PCL5=LNC,PCL6=$E(LND,1,38),PCL7=DTP D LL4 Q
"RTN","FHLABEL",22,0)
 Q
"RTN","FHLABEL",23,0)
LL3 ;LASER LABEL PRINT - AVERY 5160
"RTN","FHLABEL",24,0)
 S COUNT=COUNT+1 I COUNT>1,COUNT#3=1 S LINE=LINE+6
"RTN","FHLABEL",25,0)
 S ^TMP($J,"DL3",LINE)=$G(^TMP($J,"DL3",LINE))_PCL1_U
"RTN","FHLABEL",26,0)
 S ^TMP($J,"DL3",LINE+1)=$G(^TMP($J,"DL3",LINE+1))_PCL2_U
"RTN","FHLABEL",27,0)
 S ^TMP($J,"DL3",LINE+2)=$G(^TMP($J,"DL3",LINE+2))_PCL3_U
"RTN","FHLABEL",28,0)
 S ^TMP($J,"DL3",LINE+3)=$G(^TMP($J,"DL3",LINE+3))_PCL4_U
"RTN","FHLABEL",29,0)
 S ^TMP($J,"DL3",LINE+4)=$G(^TMP($J,"DL3",LINE+4))_PCL5_U
"RTN","FHLABEL",30,0)
 S ^TMP($J,"DL3",LINE+5)=$G(^TMP($J,"DL3",LINE+5))_PCL6_U
"RTN","FHLABEL",31,0)
 Q
"RTN","FHLABEL",32,0)
LL4 ;LASER LABEL PRINT - AVERY 5162
"RTN","FHLABEL",33,0)
 S COUNT=COUNT+1 I COUNT>1,COUNT#2=1 S LINE=LINE+8
"RTN","FHLABEL",34,0)
 S ^TMP($J,"DL4",LINE)=$G(^TMP($J,"DL4",LINE))_PCL1_U
"RTN","FHLABEL",35,0)
 S ^TMP($J,"DL4",LINE+1)=$G(^TMP($J,"DL4",LINE+1))_PCL2_U
"RTN","FHLABEL",36,0)
 S ^TMP($J,"DL4",LINE+2)=$G(^TMP($J,"DL4",LINE+2))_PCL3_U
"RTN","FHLABEL",37,0)
 S ^TMP($J,"DL4",LINE+3)=$G(^TMP($J,"DL4",LINE+3))_PCL4_U
"RTN","FHLABEL",38,0)
 S ^TMP($J,"DL4",LINE+4)=$G(^TMP($J,"DL4",LINE+4))_PCL5_U
"RTN","FHLABEL",39,0)
 S ^TMP($J,"DL4",LINE+5)=$G(^TMP($J,"DL4",LINE+5))_PCL6_U
"RTN","FHLABEL",40,0)
 S ^TMP($J,"DL4",LINE+6)=$G(^TMP($J,"DL4",LINE+6))_PCL7_U
"RTN","FHLABEL",41,0)
 S ^TMP($J,"DL4",LINE+7)=$G(^TMP($J,"DL4",LINE+7))_PCL8_U
"RTN","FHLABEL",42,0)
 Q
"RTN","FHLABEL",43,0)
DPLL ;
"RTN","FHLABEL",44,0)
 I LAB=3 D DPLL3 Q
"RTN","FHLABEL",45,0)
 I LAB=4 D DPLL4 Q
"RTN","FHLABEL",46,0)
 Q
"RTN","FHLABEL",47,0)
DPLL3 ;
"RTN","FHLABEL",48,0)
 S COUNT=0 W !! F FHLL=1:6 Q:'$D(^TMP($J,"DL3",FHLL))  D
"RTN","FHLABEL",49,0)
 .S COUNT=COUNT+1
"RTN","FHLABEL",50,0)
 .I COUNT=11 W @IOF,!! S COUNT=1
"RTN","FHLABEL",51,0)
 .S LINE1=^TMP($J,"DL3",FHLL),LINE2=^TMP($J,"DL3",FHLL+1)
"RTN","FHLABEL",52,0)
 .S LINE3=^TMP($J,"DL3",FHLL+2),LINE4=^TMP($J,"DL3",FHLL+3)
"RTN","FHLABEL",53,0)
 .S LINE5=^TMP($J,"DL3",FHLL+4),LINE6=^TMP($J,"DL3",FHLL+5)
"RTN","FHLABEL",54,0)
 .F L=LINE1,LINE2,LINE3,LINE4,LINE5,LINE6 D
"RTN","FHLABEL",55,0)
 ..W !,$P(L,U,1),?27,$P(L,U,2),?55,$P(L,U,3)
"RTN","FHLABEL",56,0)
 Q
"RTN","FHLABEL",57,0)
DPLL4 ;
"RTN","FHLABEL",58,0)
 S COUNT=0 W !!!! F FHLL=1:8 Q:'$D(^TMP($J,"DL4",FHLL))  D
"RTN","FHLABEL",59,0)
 .S COUNT=COUNT+1
"RTN","FHLABEL",60,0)
 .I COUNT=8 W @IOF,!!!! S COUNT=1
"RTN","FHLABEL",61,0)
 .S LINE1=^TMP($J,"DL4",FHLL),LINE2=^TMP($J,"DL4",FHLL+1)
"RTN","FHLABEL",62,0)
 .S LINE3=^TMP($J,"DL4",FHLL+2),LINE4=^TMP($J,"DL4",FHLL+3)
"RTN","FHLABEL",63,0)
 .S LINE5=^TMP($J,"DL4",FHLL+4),LINE6=^TMP($J,"DL4",FHLL+5)
"RTN","FHLABEL",64,0)
 .S LINE7=^TMP($J,"DL4",FHLL+6),LINE8=^TMP($J,"DL4",FHLL+7)
"RTN","FHLABEL",65,0)
 .F L=LINE1,LINE2,LINE3,LINE4,LINE5,LINE6,LINE7,LINE8 D
"RTN","FHLABEL",66,0)
 ..W !,$P(L,U,1),?42,$P(L,U,2)
"RTN","FHLABEL",67,0)
 Q
"RTN","FHMNADM")
0^21^B28708263
"RTN","FHMNADM",1,0)
FHMNADM ;Hines OIFO/JT,RTK - Dietetics Adm/Disc Monitor Report ;06/12/02  10:34
"RTN","FHMNADM",2,0)
 ;;5.0;Dietetics;**37,39**;Oct 11, 1995
"RTN","FHMNADM",3,0)
 ;
"RTN","FHMNADM",4,0)
COM ;Get Communication Offices
"RTN","FHMNADM",5,0)
 ;
"RTN","FHMNADM",6,0)
 S (XX,ZCO,CO,COXX,CNAME,CONAME,CONAM,WARD,FHCOMM)="",(ALLMON,ALLMV)=0
"RTN","FHMNADM",7,0)
 ;S ZZOUT=$G(^FH(119.73,0)),(CONUMX,ZOUT)=$P(ZZOUT,"^",4)
"RTN","FHMNADM",8,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMNADM",9,0)
 R !!,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHMNADM",10,0)
 I ZCO'="Y" D N2 I (Y=-1)&(CO="") Q
"RTN","FHMNADM",11,0)
 ;
"RTN","FHMNADM",12,0)
DATE ;sets date
"RTN","FHMNADM",13,0)
 ;
"RTN","FHMNADM",14,0)
 K %DT(0) S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMNADM",15,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT Q:Y<0
"RTN","FHMNADM",16,0)
 S FHEDT=Y
"RTN","FHMNADM",17,0)
 S DIR(0)="SA^A:Admissions;D:Discharges"
"RTN","FHMNADM",18,0)
 S DIR("A")="Select type of movement for this report: " D ^DIR
"RTN","FHMNADM",19,0)
 Q:Y["^"!(Y="")  S TYP=Y
"RTN","FHMNADM",20,0)
 D DEV Q
"RTN","FHMNADM",21,0)
 ;
"RTN","FHMNADM",22,0)
EN ;get admission/monitor information
"RTN","FHMNADM",23,0)
 Q:XX="*"
"RTN","FHMNADM",24,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 THEND  S COXX=$P(CO,"^",CONUMX),CNAME=$P(CONAME,"^",CONUMX)
"RTN","FHMNADM",25,0)
 I ZCO="Y" S COXX=COXX+1 G:COXX>ZOUT THEND  S CNAME=$G(^FH(119.73,COXX,0)),CNAME=$P(CNAME,"^")
"RTN","FHMNADM",26,0)
 I $D(^FH(119.73,COXX,"I"))!'$D(^FH(119.73,COXX,0)) G EN
"RTN","FHMNADM",27,0)
 ;
"RTN","FHMNADM",28,0)
 I TYP'="A" G EN1 Q
"RTN","FHMNADM",29,0)
 S PG=0,EX="",Y=DT X ^DD("DD") S FHNDT=Y D HDR
"RTN","FHMNADM",30,0)
 S MVTOT=0,MONTOT=0
"RTN","FHMNADM",31,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)!(EX=U)  D 
"RTN","FHMNADM",32,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J!(EX=U)  S REC=$G(^DGPM(J,0)) S WARD=$P(REC,"^",6) Q:WARD=""  D COFF2 Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))  Q:FHCOMM'=COXX  D
"RTN","FHMNADM",33,0)
 ..S ADM=J,ADMD=I D WRT
"RTN","FHMNADM",34,0)
 .Q
"RTN","FHMNADM",35,0)
 Q:XX="*"
"RTN","FHMNADM",36,0)
 D END
"RTN","FHMNADM",37,0)
 D EN
"RTN","FHMNADM",38,0)
 Q
"RTN","FHMNADM",39,0)
 ;
"RTN","FHMNADM",40,0)
COFF ;get communication offices
"RTN","FHMNADM",41,0)
 Q:'$D(^DIC(42,"B",WARD))
"RTN","FHMNADM",42,0)
 S WARDIEN=$O(^DIC(42,"B",WARD,""))
"RTN","FHMNADM",43,0)
 Q:'$D(^FH(119.6,"AW",WARDIEN))
"RTN","FHMNADM",44,0)
 S FHWARD=$O(^FH(119.6,"AW",WARDIEN,""))
"RTN","FHMNADM",45,0)
 S FHCOMM=$P($G(^FH(119.6,FHWARD,0)),"^",8)
"RTN","FHMNADM",46,0)
 Q
"RTN","FHMNADM",47,0)
 ;
"RTN","FHMNADM",48,0)
COFF2 ;
"RTN","FHMNADM",49,0)
 Q:'$D(^FH(119.6,"AW",WARD))
"RTN","FHMNADM",50,0)
 S FHWARD=$O(^FH(119.6,"AW",WARD,""))
"RTN","FHMNADM",51,0)
 S FHCOMM=$P($G(^FH(119.6,FHWARD,0)),"^",8)
"RTN","FHMNADM",52,0)
 Q
"RTN","FHMNADM",53,0)
 ;
"RTN","FHMNADM",54,0)
WRT ;write info
"RTN","FHMNADM",55,0)
 ; 
"RTN","FHMNADM",56,0)
 S DFN=$P(^DGPM(J,0),U,3) I $Y>(IOSL-4) D PG I EX=U S XX="*" Q
"RTN","FHMNADM",57,0)
 S Y=$P(ADMD,".") X ^DD("DD") W !,Y,?13,$E($P($G(^DPT(DFN,0)),U,1),U,23)
"RTN","FHMNADM",58,0)
 W ?39,$E($P($G(^DPT(DFN,0)),U,9),6,9) S MVTOT=MVTOT+1
"RTN","FHMNADM",59,0)
 I $D(^FHPT(DFN,"A",ADM,"MO","B")) W ?48,"Yes" S MONTOT=MONTOT+1
"RTN","FHMNADM",60,0)
 S Y=$P($P($G(^FHPT(DFN,"A",ADM,0)),U,14),".",1) I Y X ^DD("DD") W ?56,Y
"RTN","FHMNADM",61,0)
 I $Y>(IOSL-4) D PG I EX=U S XX="*" Q
"RTN","FHMNADM",62,0)
 Q
"RTN","FHMNADM",63,0)
 ;
"RTN","FHMNADM",64,0)
EN1 ;discharges
"RTN","FHMNADM",65,0)
 S PG=0,EX="",Y=DT X ^DD("DD") S FHNDT=Y D HDR I EX=U S XX="*" Q
"RTN","FHMNADM",66,0)
 S MVTOT=0,MONTOT=0
"RTN","FHMNADM",67,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT3",I)) Q:'I!(I>FHEDT)!(EX=U)  D
"RTN","FHMNADM",68,0)
 .S J=0 F  S J=$O(^DGPM("ATT3",I,J)) Q:'J!(EX=U)  S D0=J D WARD^DGPMUTL S WARD=X Q:WARD=""  D COFF Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))  Q:FHCOMM'=COXX  D
"RTN","FHMNADM",69,0)
 ..S ADM=$P(^DGPM(J,0),U,14)
"RTN","FHMNADM",70,0)
 ..S ADMD=$P(^DGPM(ADM,0),U,1) D WRT
"RTN","FHMNADM",71,0)
 .Q
"RTN","FHMNADM",72,0)
 D END
"RTN","FHMNADM",73,0)
 D EN Q
"RTN","FHMNADM",74,0)
 ;
"RTN","FHMNADM",75,0)
END ;end/kill/quit
"RTN","FHMNADM",76,0)
 ;
"RTN","FHMNADM",77,0)
 I EX=U Q
"RTN","FHMNADM",78,0)
 W !!,"TOTAL "_$S(TYP="A":"ADMISSIONS",TYP="D":"DISCHARGES")_": ",?22,MVTOT S ALLMV=ALLMV+MVTOT
"RTN","FHMNADM",79,0)
 W !,"TOTAL WITH MONITORS:",?22,MONTOT S ALLMON=ALLMON+MONTOT
"RTN","FHMNADM",80,0)
 S FHPER=0 I MONTOT>0,MVTOT>0 S FHPER=(MONTOT/MVTOT)*100
"RTN","FHMNADM",81,0)
 I $L($P(FHPER,".",2))>2 S FHPER=$P(FHPER,".",1)_"."_$E($P(FHPER,".",2),1,2)
"RTN","FHMNADM",82,0)
 W !,"Percentage of "
"RTN","FHMNADM",83,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")
"RTN","FHMNADM",84,0)
 W " with Monitors: ",FHPER,"%"
"RTN","FHMNADM",85,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMNADM",86,0)
 Q
"RTN","FHMNADM",87,0)
 ;
"RTN","FHMNADM",88,0)
THEND ;end/kill/quit
"RTN","FHMNADM",89,0)
 ;
"RTN","FHMNADM",90,0)
 I EX=U Q
"RTN","FHMNADM",91,0)
 S CNAME="ALL "
"RTN","FHMNADM",92,0)
 D HDR
"RTN","FHMNADM",93,0)
 W !!,"ALL TOTAL "_$S(TYP="A":"ADMISSIONS",TYP="D":"DISCHARGES")_": ",?22,ALLMV
"RTN","FHMNADM",94,0)
 W !,"TOTAL WITH MONITORS:",?22,ALLMON
"RTN","FHMNADM",95,0)
 S ALLFHPER=0 I ALLMON>0,ALLMV>0 S ALLFHPER=(ALLMON/ALLMV)*100
"RTN","FHMNADM",96,0)
 I $L($P(ALLFHPER,".",2))>2 S ALLFHPER=$P(ALLFHPER,".",1)_"."_$E($P(ALLFHPER,".",2),1,2)
"RTN","FHMNADM",97,0)
 W !,"Percentage of "
"RTN","FHMNADM",98,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")
"RTN","FHMNADM",99,0)
 W " with Monitors: ",ALLFHPER,"%"
"RTN","FHMNADM",100,0)
 Q
"RTN","FHMNADM",101,0)
 ;
"RTN","FHMNADM",102,0)
 ;
"RTN","FHMNADM",103,0)
DEV ;get device and set up queue
"RTN","FHMNADM",104,0)
 S TAG=$S(TYP="A":"EN",TYP="D":"EN")
"RTN","FHMNADM",105,0)
 K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMNADM",106,0)
 I '$D(IO("Q")) U IO D @TAG,^%ZISC Q
"RTN","FHMNADM",107,0)
 S ZTRTN=TAG_"^FHMNADM",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")=""
"RTN","FHMNADM",108,0)
 S ZTSAVE("ZCO")="",ZTSAVE("COXX")="",ZTSAVE("CONUMX")="",ZTSAVE("ZOUT")="",ZTSAVE("XX")=""
"RTN","FHMNADM",109,0)
 S ZTSAVE("CNAME")="",ZTSAVE("FHCOMM")="",ZTSAVE("CO")="",ZTSAVE("CONAME")=""
"RTN","FHMNADM",110,0)
 S ZTSAVE("ALLMV")="",ZTSAVE("ALLMON")="",ZTSAVE("ALLFHPER")=""
"RTN","FHMNADM",111,0)
 S ZTSAVE("TYP")="",ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMNADM",112,0)
 W !,"Task #",ZTSK
"RTN","FHMNADM",113,0)
 D ^%ZISC K %ZIS,IOP Q
"RTN","FHMNADM",114,0)
 Q
"RTN","FHMNADM",115,0)
 ;
"RTN","FHMNADM",116,0)
KL ;
"RTN","FHMNADM",117,0)
 K I,J,DFN,SSN,MVTOT,MONTOT,FHPER,X,Y,PG,FHNDT,ADM,CO,CONAME,CONAM,WARD,FHCOMM,ALLMON,ALLMV
"RTN","FHMNADM",118,0)
 K TAG,DIR,%DT,ADDT Q
"RTN","FHMNADM",119,0)
 Q
"RTN","FHMNADM",120,0)
 ;
"RTN","FHMNADM",121,0)
N2 ;Find Communications Office
"RTN","FHMNADM",122,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMNADM",123,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHMNADM",124,0)
 I Y=-1 Q
"RTN","FHMNADM",125,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHMNADM",126,0)
 I Y=-1 K DIC Q
"RTN","FHMNADM",127,0)
 Q
"RTN","FHMNADM",128,0)
 ;
"RTN","FHMNADM",129,0)
PG ;
"RTN","FHMNADM",130,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMNADM",131,0)
 D HDR Q
"RTN","FHMNADM",132,0)
HDR ;Header
"RTN","FHMNADM",133,0)
 ;
"RTN","FHMNADM",134,0)
 W:$Y @IOF
"RTN","FHMNADM",135,0)
 W !,"DIETETIC MONITOR REPORT (Monitoring "
"RTN","FHMNADM",136,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")_")"
"RTN","FHMNADM",137,0)
 W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!
"RTN","FHMNADM",138,0)
 W !,?5,"Communication Offices: ",CNAME,!!
"RTN","FHMNADM",139,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Monitor?",?56,"Discharge"
"RTN","FHMNADM",140,0)
 W ! F Z=1:1:79 W "="
"RTN","FHMNADM",141,0)
 Q
"RTN","FHMNBRPT")
0^22^B17340200
"RTN","FHMNBRPT",1,0)
FHMNBRPT ;Hines OIFO/JT,RTK - Dietetics Monitor Brief ;07/26/01  11:49
"RTN","FHMNBRPT",2,0)
 ;;5.0;Dietetics;**36,39**;Oct 11, 1995
"RTN","FHMNBRPT",3,0)
 ;
"RTN","FHMNBRPT",4,0)
COM ;get Communication Offices
"RTN","FHMNBRPT",5,0)
 S (ZCO,CO,CONAME,CONAM,WARD,FHCOMM,ZZOUT,ZOUT,CONUMX)="",(COXX,ALLMON,ALLADM,ALLFHPER)=0
"RTN","FHMNBRPT",6,0)
 ;S ZZOUT=$G(^FH(119.73,0)),CONUMX=$P(ZZOUT,"^",4),ZOUT=CONUMX
"RTN","FHMNBRPT",7,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMNBRPT",8,0)
 R !!,"Print report for all Communication Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHMNBRPT",9,0)
 I ZCO'="Y" D N2 I (Y=-1)&(CO="") Q
"RTN","FHMNBRPT",10,0)
 ;
"RTN","FHMNBRPT",11,0)
DATE ;sets date
"RTN","FHMNBRPT",12,0)
 W ! S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMNBRPT",13,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT K %DT(0)
"RTN","FHMNBRPT",14,0)
 S PG=0,EX=""
"RTN","FHMNBRPT",15,0)
 I Y<0 D END Q
"RTN","FHMNBRPT",16,0)
 S FHEDT=Y
"RTN","FHMNBRPT",17,0)
 D DEV Q
"RTN","FHMNBRPT",18,0)
 ;D END
"RTN","FHMNBRPT",19,0)
 ;
"RTN","FHMNBRPT",20,0)
EN ;get admission/monitor information
"RTN","FHMNBRPT",21,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 THEND  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX)
"RTN","FHMNBRPT",22,0)
 I ZCO="Y" S COXX=COXX+1 G:COXX>ZOUT THEND  S NAME=$G(^FH(119.73,COXX,0)),NAME=$P(NAME,"^")
"RTN","FHMNBRPT",23,0)
 I $D(^FH(119.73,COXX,"I"))!'$D(^FH(119.73,COXX,0)) G EN
"RTN","FHMNBRPT",24,0)
 ;
"RTN","FHMNBRPT",25,0)
 D NOW^%DTC S Y=X D DD^%DT S FHNDT=Y D PG
"RTN","FHMNBRPT",26,0)
 S ADMTOT=0,MONTOT=0
"RTN","FHMNBRPT",27,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)  D
"RTN","FHMNBRPT",28,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J!(EX=U)  S REC=$G(^DGPM(J,0)) S WARD=$P(REC,"^",6) Q:WARD=""  D COFF Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))  Q:FHCOMM'=COXX  D
"RTN","FHMNBRPT",29,0)
 ..S DFN=$P(^DGPM(J,0),U,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNBRPT",30,0)
 ..S Y=$P(I,".") X ^DD("DD") W !,Y,?13,$E($P($G(^DPT(DFN,0)),U,1),1,23)
"RTN","FHMNBRPT",31,0)
 ..W ?39,$E($P($G(^DPT(DFN,0)),U,9),6,9) S ADMTOT=ADMTOT+1
"RTN","FHMNBRPT",32,0)
 ..I $D(^FHPT(DFN,"A",J,"MO","B")) W ?48,"Yes" S MONTOT=MONTOT+1
"RTN","FHMNBRPT",33,0)
 ..S Y=$P($P($G(^FHPT(DFN,"A",J,0)),U,14),".",1) I Y X ^DD("DD") W ?56,Y
"RTN","FHMNBRPT",34,0)
 ..Q
"RTN","FHMNBRPT",35,0)
 .Q
"RTN","FHMNBRPT",36,0)
 I EX=U D THEND Q
"RTN","FHMNBRPT",37,0)
 W !!,"TOTAL ADMISSIONS: ",?22,ADMTOT S ALLADM=ALLADM+ADMTOT I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNBRPT",38,0)
 W !,"TOTAL WITH MONITORS:",?22,MONTOT S ALLMON=ALLMON+MONTOT I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNBRPT",39,0)
 W !,"Percentage of Admissions with Monitors: "
"RTN","FHMNBRPT",40,0)
 I ADMTOT=0!(MONTOT=0) W "0.0%" D EN Q
"RTN","FHMNBRPT",41,0)
 S FHPER=(MONTOT/ADMTOT)*100
"RTN","FHMNBRPT",42,0)
 I $L($P(FHPER,".",2))>2 S FHPER=$P(FHPER,".",1)_"."_$E($P(FHPER,".",2),1,2)
"RTN","FHMNBRPT",43,0)
 W FHPER,"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNBRPT",44,0)
 G EN
"RTN","FHMNBRPT",45,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMNBRPT",46,0)
 Q
"RTN","FHMNBRPT",47,0)
 ;
"RTN","FHMNBRPT",48,0)
COFF ;get Communications Offices
"RTN","FHMNBRPT",49,0)
 Q:'$D(^FH(119.6,"AW",WARD))
"RTN","FHMNBRPT",50,0)
 S FHWARD=$O(^FH(119.6,"AW",WARD,""))
"RTN","FHMNBRPT",51,0)
 S FHCOMM=$P($G(^FH(119.6,FHWARD,0)),"^",8)
"RTN","FHMNBRPT",52,0)
 Q
"RTN","FHMNBRPT",53,0)
 ;
"RTN","FHMNBRPT",54,0)
DEV ;get device and set up queue
"RTN","FHMNBRPT",55,0)
 W ! K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMNBRPT",56,0)
 I '$D(IO("Q")) U IO D EN,^%ZISC,END Q
"RTN","FHMNBRPT",57,0)
 S ZTRTN="EN^FHMNBRPT",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")=""
"RTN","FHMNBRPT",58,0)
 S ZTSAVE=("FHNDT")="",ZTSAVE=("FHPER")="",ZTSAVE("ZCO")=""
"RTN","FHMNBRPT",59,0)
 S ZTSAVE("CO")="",ZTSAVE("ALLMON")="",ZTSAVE("PG")="",ZTSAVE("EX")=""
"RTN","FHMNBRPT",60,0)
 S ZTSAVE("ZOUT")="",ZTSAVE("ALLADM")="",ZTSAVE("ALLFHPER")=""
"RTN","FHMNBRPT",61,0)
 S ZTSAVE("COXX")="",ZTSAVE("CONUMX")="",ZTSAVE("FHCOMM")=""
"RTN","FHMNBRPT",62,0)
 S ZTSAVE("CONAME")=""
"RTN","FHMNBRPT",63,0)
 S ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMNBRPT",64,0)
 D ^%ZISC K %ZIS,IOP
"RTN","FHMNBRPT",65,0)
 ;D END Q
"RTN","FHMNBRPT",66,0)
 ;
"RTN","FHMNBRPT",67,0)
END ;kill and quit
"RTN","FHMNBRPT",68,0)
 K I,J,DFN,SSN,ADMTOT,MONTOT,FHPER,FHSDT,FHEDT,FHNDT,X,Y,PG
"RTN","FHMNBRPT",69,0)
 Q
"RTN","FHMNBRPT",70,0)
 ;
"RTN","FHMNBRPT",71,0)
THEND ;
"RTN","FHMNBRPT",72,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMNBRPT",73,0)
 S NAME="ALL COMMUNICATION OFFICES " D HDR
"RTN","FHMNBRPT",74,0)
 W !!,"ALL TOTAL ADMISSIONS: ",?22,ALLADM
"RTN","FHMNBRPT",75,0)
 W !,"TOTAL WITH MONITORS:",?22,ALLMON
"RTN","FHMNBRPT",76,0)
 W !,"Percentage of Admissions with Monitors: "
"RTN","FHMNBRPT",77,0)
 I ALLADM=0!(ALLMON=0) W "0.0%" D END Q
"RTN","FHMNBRPT",78,0)
 S ALLFHPER=(ALLMON/ALLADM)*100
"RTN","FHMNBRPT",79,0)
 I $L($P(ALLFHPER,".",2))>2 S ALLFHPER=$P(ALLFHPER,".",1)_"."_$E($P(ALLFHPER,".",2),1,2)
"RTN","FHMNBRPT",80,0)
 W ALLFHPER,"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNBRPT",81,0)
 G END Q
"RTN","FHMNBRPT",82,0)
 ;
"RTN","FHMNBRPT",83,0)
N2 ;find Communications Office
"RTN","FHMNBRPT",84,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMNBRPT",85,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHMNBRPT",86,0)
 I Y=-1 Q
"RTN","FHMNBRPT",87,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHMNBRPT",88,0)
 I Y=-1 K DIC Q
"RTN","FHMNBRPT",89,0)
 Q
"RTN","FHMNBRPT",90,0)
 ;
"RTN","FHMNBRPT",91,0)
PG ;
"RTN","FHMNBRPT",92,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMNBRPT",93,0)
 D HDR Q
"RTN","FHMNBRPT",94,0)
HDR ;Header
"RTN","FHMNBRPT",95,0)
 W:$Y @IOF W !,NAME,?30,"MONITOR BRIEF REPORT" W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!!
"RTN","FHMNBRPT",96,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Monitor?",?56,"Discharge"
"RTN","FHMNBRPT",97,0)
 W ! F Z=1:1:79 W "="
"RTN","FHMNBRPT",98,0)
 Q
"RTN","FHMNPRT")
0^24^B34893344
"RTN","FHMNPRT",1,0)
FHMNPRT ;Hines OIFO/RTK - Dietetics Monitor Report Print ;10/23/01  10:29
"RTN","FHMNPRT",2,0)
 ;;5.0;Dietetics;**34,35,36,39**;Oct 11, 1995
"RTN","FHMNPRT",3,0)
 ;
"RTN","FHMNPRT",4,0)
 S (COUNT,COMM,CTCOMM,MON,ALLMON,ALLMON1,M1,M2,M3,M4,M5)=0
"RTN","FHMNPRT",5,0)
 S PG=0,(EX,XX)="" D NOW^%DTC S Y=X D DD^%DT S FHNDT=Y
"RTN","FHMNPRT",6,0)
 K FHMNTT
"RTN","FHMNPRT",7,0)
 ;
"RTN","FHMNPRT",8,0)
PRINT ;
"RTN","FHMNPRT",9,0)
 S (MM1,MM2,MM3,MM4,MM5)=0
"RTN","FHMNPRT",10,0)
 D MNAME
"RTN","FHMNPRT",11,0)
 Q:XX="*"
"RTN","FHMNPRT",12,0)
 I FHNXIEN'="ALL" I '$D(^TMP($J,"FHDATA",COMM,FHNXIEN)) D MESSAGE Q
"RTN","FHMNPRT",13,0)
 I FHNXIEN'="ALL" S ZZ=FHNXIEN D DISP,D1END Q
"RTN","FHMNPRT",14,0)
 I FHNXIEN="ALL" S ZZ="" F  S ZZ=$O(^TMP($J,"FHDATA",COMM,ZZ)) Q:ZZ=""!(EX=U)  D
"RTN","FHMNPRT",15,0)
 .D PG
"RTN","FHMNPRT",16,0)
 .D DISP
"RTN","FHMNPRT",17,0)
 .S ALLMON=ALLMON+MON
"RTN","FHMNPRT",18,0)
 .S ALLMON1=ALLMON1+MON
"RTN","FHMNPRT",19,0)
 .S M1=M1+MON1,M2=M2+MON2,M3=M3+MON3,M4=M4+MON4,M5=M5+MON5
"RTN","FHMNPRT",20,0)
 .S MM1=MM1+MON1,MM2=MM2+MON2,MM3=MM3+MON3,MM4=MM4+MON4,MM5=MM5+MON5
"RTN","FHMNPRT",21,0)
 .Q
"RTN","FHMNPRT",22,0)
 I FHNXIEN'="ALL"!(EX=U) G END Q
"RTN","FHMNPRT",23,0)
 I ALLMON=0 W !!?5,"NO PATIENTS WITH MONITORS IN GIVEN DATE RANGE" D END Q
"RTN","FHMNPRT",24,0)
 ;
"RTN","FHMNPRT",25,0)
 W !!,"** TOTAL COMMUNICATIONS OFFICE - Admissions.....: ",NAME I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",26,0)
 ;
"RTN","FHMNPRT",27,0)
 W !!?16,"Totals for ALL ",$S(FHSORT="C":"Clinicians.......: ",1:"Wards............: "),$J(ALLMON1,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",28,0)
 ;I ZCO'="Y",ALLMON1=0 G PRINT
"RTN","FHMNPRT",29,0)
 I ALLMON>0 W !?16,"Monitor: Albumin < 3.2..........: ",$J(MM1,3),"   ",$J(((MM1/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",30,0)
 I ALLMON>0 W !?16,"Monitor: BMI < 21...............: ",$J(MM2,3),"   ",$J(((MM2/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",31,0)
 I ALLMON>0 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(MM3,3),"   ",$J(((MM3/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",32,0)
 I ALLMON>0 W !?16,"Monitor: On Hyperals............: ",$J(MM4,3),"   ",$J(((MM4/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",33,0)
 I ALLMON>0 W !?16,"Monitor: On Tubefeeding.........: ",$J(MM5,3),"   ",$J(((MM5/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",34,0)
 ;
"RTN","FHMNPRT",35,0)
 ;
"RTN","FHMNPRT",36,0)
 S (MM1,MM2,MM3,MM4,MM5,ALLMON1)=0
"RTN","FHMNPRT",37,0)
 G PRINT Q
"RTN","FHMNPRT",38,0)
 Q
"RTN","FHMNPRT",39,0)
 ;
"RTN","FHMNPRT",40,0)
THEND ;
"RTN","FHMNPRT",41,0)
 S NAME="ALL COMMUNICATION OFFICES " D PG I EX=U Q
"RTN","FHMNPRT",42,0)
 W !!,"*** TOTAL PATIENTS WITH MONITORS ALL COMMUNICATION OFFICES....: ",CTCOMM
"RTN","FHMNPRT",43,0)
 ;
"RTN","FHMNPRT",44,0)
 W !!?16,"Totals for ALL ",$S(FHSORT="C":"Clinicians.......: ",1:"Wards............: "),$J(ALLMON,3)
"RTN","FHMNPRT",45,0)
 I ALLMON>0 W !?16,"Monitor: Albumin < 3.2..........: ",$J(M1,3),"   ",$J(((M1/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",46,0)
 I ALLMON>0 W !?16,"Monitor: BMI < 21...............: ",$J(M2,3),"   ",$J(((M2/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",47,0)
 I ALLMON>0 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(M3,3),"   ",$J(((M3/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",48,0)
 I ALLMON>0 W !?16,"Monitor: On Hyperals............: ",$J(M4,3),"   ",$J(((M4/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",49,0)
 I ALLMON>0 W !?16,"Monitor: On Tubefeeding.........: ",$J(M5,3),"   ",$J(((M5/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",50,0)
 ;
"RTN","FHMNPRT",51,0)
 ;W !!!,"TOTAL ADMISSIONS....:",?23,FHTADM
"RTN","FHMNPRT",52,0)
 ;W !,"TOTAL MONITORS......:",?23,ALLMON
"RTN","FHMNPRT",53,0)
 ;I FHTADM>0 W !,"PERCENTAGE..........:",?23,$J(((ALLMON/FHTADM)*100),1,2),"%"
"RTN","FHMNPRT",54,0)
 D LINE
"RTN","FHMNPRT",55,0)
 S XX="*"
"RTN","FHMNPRT",56,0)
 Q
"RTN","FHMNPRT",57,0)
 ;I $Y>(IOSL-4)
"RTN","FHMNPRT",58,0)
 ;
"RTN","FHMNPRT",59,0)
D1END W ! K DIR Q:EX'=U  S DIR(0)="E" D ^DIR  ;I IOST?1"C".E,EX'=U 
"RTN","FHMNPRT",60,0)
 D END Q
"RTN","FHMNPRT",61,0)
 Q
"RTN","FHMNPRT",62,0)
DISP ;
"RTN","FHMNPRT",63,0)
 S (TOT,MON,MON1,MON2,MON3,MON4,MON5)=0
"RTN","FHMNPRT",64,0)
 F YY=0:0 S YY=$O(^TMP($J,"FHDATA",COMM,ZZ,YY)) Q:YY'>0  D
"RTN","FHMNPRT",65,0)
DISP2 .F HH=0:0 S HH=$O(^TMP($J,"FHDATA",COMM,ZZ,YY,HH)) Q:HH'>0!(EX=U)  D
"RTN","FHMNPRT",66,0)
 ..I $Y>(IOSL-4) I EX=U Q  W ! D HDR
"RTN","FHMNPRT",67,0)
 ..S CTCOMM=CTCOMM+1
"RTN","FHMNPRT",68,0)
 ..S DFN=$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,5)
"RTN","FHMNPRT",69,0)
 ..S Y=YY X ^DD("DD") W !,Y
"RTN","FHMNPRT",70,0)
 ..W ?13,$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,2)
"RTN","FHMNPRT",71,0)
 ..W ?39,$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,3)
"RTN","FHMNPRT",72,0)
 ..W ?47,$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,6)
"RTN","FHMNPRT",73,0)
 ..I $P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,7)="Yes"  D
"RTN","FHMNPRT",74,0)
 ...F NUM=0:0 S NUM=$O(FHMON(DFN,HH,NUM)) Q:NUM'>0!(EX=U)  D
"RTN","FHMNPRT",75,0)
 ....I NUM'=1 W !
"RTN","FHMNPRT",76,0)
 ....S MON=MON+1,MONTYP=$P($P(FHMON(DFN,HH,NUM),U,1),": ",2)
"RTN","FHMNPRT",77,0)
 ....S PC=$S(MONTYP["Albumin":1,MONTYP["BMI":2,MONTYP["NPO+Clr":3,MONTYP["Hyper":4,1:5)
"RTN","FHMNPRT",78,0)
 ....I $G(FHMNTT(COMM,ZZ))="" S FHMNTT(COMM,ZZ)=""
"RTN","FHMNPRT",79,0)
 ....S $P(FHMNTT(COMM,ZZ),U,PC)=$P(FHMNTT(COMM,ZZ),U,PC)+1
"RTN","FHMNPRT",80,0)
 ....W ?56,MONTYP I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",81,0)
 ....Q
"RTN","FHMNPRT",82,0)
 ...Q
"RTN","FHMNPRT",83,0)
 ..S TOT=TOT+1
"RTN","FHMNPRT",84,0)
 ..Q
"RTN","FHMNPRT",85,0)
 .Q
"RTN","FHMNPRT",86,0)
 I MON=0!(EX=U) Q
"RTN","FHMNPRT",87,0)
 I FHSORT="C" W !!,"*  CLINICIAN: ",ZZ
"RTN","FHMNPRT",88,0)
 I FHSORT="W" W !!,"*  WARD: ",ZZ
"RTN","FHMNPRT",89,0)
 W !?16,"Total Number of Monitors........: ",$J(MON,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",90,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,1) I PCE>0 W !?16,"Monitor: Albumin < 3.2..........: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON1=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",91,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,2) I PCE>0 W !?16,"Monitor: BMI < 21...............: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON2=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",92,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,3) I PCE>0 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON3=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",93,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,4) I PCE>0 W !?16,"Monitor: On Hyperals............: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON4=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",94,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,5) I PCE>0 W !?16,"Monitor: On Tubefeeding.........: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON5=PCE
"RTN","FHMNPRT",95,0)
 W !
"RTN","FHMNPRT",96,0)
 Q
"RTN","FHMNPRT",97,0)
 ;
"RTN","FHMNPRT",98,0)
MESSAGE ;
"RTN","FHMNPRT",99,0)
 W !!?5,"NO PATIENTS WITH MONITORS IN GIVEN DATE RANGE"
"RTN","FHMNPRT",100,0)
 W !?10,"FOR THIS ",$S(FHSORT="C":"CLINICIAN",1:"WARD"),": ",FHNXIEN
"RTN","FHMNPRT",101,0)
 Q
"RTN","FHMNPRT",102,0)
END K FHMNTT,HH,M1,M2,M3,M4,M5,MON,MON1,MON2,MON3,MON4,MON5,MONTYP
"RTN","FHMNPRT",103,0)
 K NUM,PC,PCE,PG,PER,TOT,YY
"RTN","FHMNPRT",104,0)
 QUIT
"RTN","FHMNPRT",105,0)
 Q
"RTN","FHMNPRT",106,0)
 ;
"RTN","FHMNPRT",107,0)
PG ;
"RTN","FHMNPRT",108,0)
 I IOST?1"C".E  W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMNPRT",109,0)
 D HDR Q
"RTN","FHMNPRT",110,0)
 Q
"RTN","FHMNPRT",111,0)
HDR ;Header
"RTN","FHMNPRT",112,0)
 W:$Y @IOF W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!
"RTN","FHMNPRT",113,0)
 W !,?25,"Nutrition Monitor Statistic Report"
"RTN","FHMNPRT",114,0)
 W !,NAME,!
"RTN","FHMNPRT",115,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Status",?56,"Monitor(s)"
"RTN","FHMNPRT",116,0)
LINE W ! F Z=1:1:79 W "="
"RTN","FHMNPRT",117,0)
 Q
"RTN","FHMNPRT",118,0)
MNAME ;
"RTN","FHMNPRT",119,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX<1 THEND  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) S COMM=COXX Q
"RTN","FHMNPRT",120,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT THEND  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") S COMM=COUNT
"RTN","FHMNPRT",121,0)
 I $D(^FH(119.73,COUNT,"I"))!'$D(^FH(119.73,COUNT,0)) G MNAME
"RTN","FHMNPRT",122,0)
 Q
"RTN","FHMNPRT",123,0)
QUIT ;
"RTN","FHMNPRT",124,0)
 W !
"RTN","FHMNPRT",125,0)
 Q
"RTN","FHMNREP")
0^23^B19385762
"RTN","FHMNREP",1,0)
FHMNREP ;Hines OIFO/RTK - Dietetics Monitor Report ;10/18/01  11:49
"RTN","FHMNREP",2,0)
 ;;5.0;Dietetics;**33,34,35,39**;Oct 11, 1995
"RTN","FHMNREP",3,0)
 ;
"RTN","FHMNREP",4,0)
COM ;Get Communication Offices
"RTN","FHMNREP",5,0)
 S (ZCO,CO,COXX,CONAME,CONAM,WARD,FHCOMM)="",(ZCOMM,CONUMX,ALLCOMM)=0
"RTN","FHMNREP",6,0)
 ;S ZZOUT=$G(^FH(119.73,0)),ZOUT=$P(ZZOUT,"^",4)
"RTN","FHMNREP",7,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMNREP",8,0)
 R !!,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHMNREP",9,0)
 Q:ZCO="^"
"RTN","FHMNREP",10,0)
 I ZCO'="Y" D N2 I (Y=-1)&(CO="") Q
"RTN","FHMNREP",11,0)
 ;
"RTN","FHMNREP",12,0)
DATE ;sets date
"RTN","FHMNREP",13,0)
 S (FHTADM,FHTMON)=0
"RTN","FHMNREP",14,0)
 W ! S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMNREP",15,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT K %DT(0)
"RTN","FHMNREP",16,0)
 S FHEDT=Y I Y<0 D END Q
"RTN","FHMNREP",17,0)
 D SORTCR S FHSORT=Y I Y="^" D END Q
"RTN","FHMNREP",18,0)
 I FHSORT="C" D FHCL Q:'$D(FHCLIEN)  S FHNXIEN=CLNAM
"RTN","FHMNREP",19,0)
 I FHSORT="W" D FHWA Q:'$D(FHWRIEN)  S FHNXIEN=WRDNAM
"RTN","FHMNREP",20,0)
 D DEV,END Q
"RTN","FHMNREP",21,0)
 ;
"RTN","FHMNREP",22,0)
FHCL ;
"RTN","FHMNREP",23,0)
 K DIR S DIR(0)="Y",DIR("A")="Select ALL Clinicians",DIR("B")="Y" D ^DIR
"RTN","FHMNREP",24,0)
 I Y=1 S (FHCLIEN,CLNAM)="ALL"
"RTN","FHMNREP",25,0)
 I Y=0 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " D ^DIC S FHCLIEN=$P(Y,U,1),CLNAM=$P($G(^VA(200,FHCLIEN,0)),U,1)
"RTN","FHMNREP",26,0)
 I (Y=-1)!($D(DUOUT))!($D(DTOUT)) D END Q
"RTN","FHMNREP",27,0)
 Q
"RTN","FHMNREP",28,0)
FHWA ;
"RTN","FHMNREP",29,0)
 K DIR S DIR(0)="Y",DIR("A")="Select ALL Wards",DIR("B")="Y" D ^DIR
"RTN","FHMNREP",30,0)
 I Y=1 S (FHWRIEN,WRDNAM)="ALL"
"RTN","FHMNREP",31,0)
 I Y=0 K DIC S DIC="^FH(119.6,",DIC(0)="AEQM" D ^DIC S FHWRIEN=$P(Y,U,1),WRDNAM=$P($G(^FH(119.6,FHWRIEN,0)),U,1)
"RTN","FHMNREP",32,0)
 I (Y=-1)!($D(DUOUT))!($D(DTOUT)) D END Q
"RTN","FHMNREP",33,0)
 Q
"RTN","FHMNREP",34,0)
EN ;
"RTN","FHMNREP",35,0)
 ;^TMP($J,"FHDATA") SUBSCRIPTS (CLINIC OR WARD NAME,DGPM DATE,DGPM ENTRY)
"RTN","FHMNREP",36,0)
 ;^TMP($J,"FHDATA") PIECES="PatName^SSN^Monitors?^DischargeDt^DFN^Status"
"RTN","FHMNREP",37,0)
 ;
"RTN","FHMNREP",38,0)
 K ^TMP($J,"FHDATA"),FHMON
"RTN","FHMNREP",39,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)  D
"RTN","FHMNREP",40,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J  D
"RTN","FHMNREP",41,0)
 ..S ZCOMM=ZCOMM+1
"RTN","FHMNREP",42,0)
 ..S DFN=$P($G(^DGPM(J,0)),U,3) I '$D(^FHPT(DFN,"A",J,"MO","B")) Q
"RTN","FHMNREP",43,0)
 ..S II=$P(I,".")
"RTN","FHMNREP",44,0)
 ..S FHWARD=$P($G(^DGPM(J,0)),U,6)
"RTN","FHMNREP",45,0)
 ..Q:'$D(^FH(119.6,"AW",FHWARD))
"RTN","FHMNREP",46,0)
 ..S WRD=$O(^FH(119.6,"AW",FHWARD,""))
"RTN","FHMNREP",47,0)
 ..S FHCOMM=$P($G(^FH(119.6,WRD,0)),"^",8),CLN=$P($G(^FH(119.6,WRD,0)),"^",2)
"RTN","FHMNREP",48,0)
 ..Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))
"RTN","FHMNREP",49,0)
 ..S FHTADM=FHTADM+1
"RTN","FHMNREP",50,0)
 ..S ALLCOMM=ALLCOMM+1
"RTN","FHMNREP",51,0)
 ..;S CLN=$P($G(^DGPM(J,0)),U,19),WRD=$P($G(^DGPM(J,0)),U,6)
"RTN","FHMNREP",52,0)
 ..S INDX=$S(FHSORT="C":CLN,1:WRD) I INDX="" Q
"RTN","FHMNREP",53,0)
 ..S INDX=$S(FHSORT="C":$P($G(^VA(200,CLN,0)),U,1),1:$P($G(^FH(119.6,WRD,0)),U,1))
"RTN","FHMNREP",54,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,1)=FHCOMM
"RTN","FHMNREP",55,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,2)=$E($P($G(^DPT(DFN,0)),U,1),1,23)
"RTN","FHMNREP",56,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,5)=DFN
"RTN","FHMNREP",57,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,3)=$E($P($G(^DPT(DFN,0)),U,9),6,9)
"RTN","FHMNREP",58,0)
 ..I $D(^FHPT(DFN,"A",J,"MO","B")) S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,7)="Yes",FHTMON=FHTMON+1,MCNT=0  D
"RTN","FHMNREP",59,0)
 ...F FHMN=0:0 S FHMN=$O(^FHPT(DFN,"A",J,"MO",FHMN)) Q:FHMN'>0  S MCNT=MCNT+1,FHMON(DFN,J,MCNT)=$P($G(^FHPT(DFN,"A",J,"MO",FHMN,0)),"^",1)
"RTN","FHMNREP",60,0)
 ..S Y=$P($P($G(^FHPT(DFN,"A",J,0)),U,14),".",1) I Y X ^DD("DD") S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,4)=Y
"RTN","FHMNREP",61,0)
 ..I $D(^FHPT(DFN,"S",0)) S NS=$O(^FHPT(DFN,"S",0)),STAT=$P($G(^FHPT(DFN,"S",NS,0)),U,2) S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,6)=$P($G(^FH(115.4,STAT,0)),U,1)
"RTN","FHMNREP",62,0)
 ..Q
"RTN","FHMNREP",63,0)
 .Q
"RTN","FHMNREP",64,0)
 D ^FHMNPRT
"RTN","FHMNREP",65,0)
 Q
"RTN","FHMNREP",66,0)
 ;
"RTN","FHMNREP",67,0)
THEND ;Q
"RTN","FHMNREP",68,0)
 ;
"RTN","FHMNREP",69,0)
DEV ;get device and set up queue
"RTN","FHMNREP",70,0)
 W ! K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMNREP",71,0)
 I '$D(IO("Q")) U IO D EN,^%ZISC,END Q
"RTN","FHMNREP",72,0)
 S ZTRTN="EN^FHMNREP",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")="",ZTSAVE("ZCOMM")=""
"RTN","FHMNREP",73,0)
 S ZTSAVE("FHNDT")="",ZTSAVE("FHPER")="",ZTSAVE("FHSORT")=""
"RTN","FHMNREP",74,0)
 S ZTSAVE("FHNXIEN")="",ZTSAVE("FHTADM")="",ZTSAVE("FHTMON")=""
"RTN","FHMNREP",75,0)
 S ZTSAVE("ALLCOMM")="",ZTSAVE("ZCO")="",ZTSAVE("COXX")="",ZTSAVE("ZOUT")=""
"RTN","FHMNREP",76,0)
 S ZTSAVE("CONUMX")="",ZTSAVE("CO")="",ZTSAVE("CONAME")=""
"RTN","FHMNREP",77,0)
 S ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMNREP",78,0)
 D ^%ZISC K %ZIS,IOP
"RTN","FHMNREP",79,0)
 D END Q
"RTN","FHMNREP",80,0)
 ;
"RTN","FHMNREP",81,0)
N2 ;Find Communication Office
"RTN","FHMNREP",82,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMNREP",83,0)
 D ^DIC I Y=-1&(CO="") Q
"RTN","FHMNREP",84,0)
 I Y=-1 Q
"RTN","FHMNREP",85,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHMNREP",86,0)
 I Y=-1 K DIC Q
"RTN","FHMNREP",87,0)
 Q
"RTN","FHMNREP",88,0)
 ;
"RTN","FHMNREP",89,0)
SORTCR ;
"RTN","FHMNREP",90,0)
 K DIR S DIR(0)="SB^C:CLINICIAN;W:WARD",DIR("A")="Sort by Clinician/Ward"
"RTN","FHMNREP",91,0)
 D ^DIR
"RTN","FHMNREP",92,0)
 Q
"RTN","FHMNREP",93,0)
END ;kill and quit
"RTN","FHMNREP",94,0)
 K CLN,CLNAM,DFN,I,II,INDX,J,SSN,MCNT
"RTN","FHMNREP",95,0)
 K FHCLIEN,FHEDT,FHMN,FHNDT,FHNXIEN,FHTADM,FHTMON
"RTN","FHMNREP",96,0)
 K FHPER,FHSDT,FHSORT,FHWRIEN,WRD,WRDNAM,X,Y,Z
"RTN","FHMNREP",97,0)
 Q
"RTN","FHNO2")
0^15^B22192123
"RTN","FHNO2",1,0)
FHNO2 ; HISC/REL/NCA - Supplemental Feeding Labels ;8/26/94  12:01 
"RTN","FHNO2",2,0)
 ;;5.0;Dietetics;**38,39**;Oct 11, 1995
"RTN","FHNO2",3,0)
D0 R !!,"Select by S=SUPPLEMENTAL FEEDING SITE or W=WARD: ",XX:DTIME G:'$T!("^"[XX) KIL I "sw"[XX S X=XX D TR^FH S XX=X
"RTN","FHNO2",4,0)
 I XX'?1U!("SW"'[XX) W *7," Enter S or W" G D0
"RTN","FHNO2",5,0)
 I XX="S" S D1=$O(^FH(119.74,0)) I D1'<1,$O(^FH(119.74,D1))<1 G D3
"RTN","FHNO2",6,0)
 I XX="W" S WRD=$O(^FH(119.6,0)) I WRD'<1,$O(^FH(119.6,WRD))<1 G D3
"RTN","FHNO2",7,0)
 I XX="S" G D2
"RTN","FHNO2",8,0)
D1 R !!,"Select WARD: ",X:DTIME G:'$T!("^"[X) KIL
"RTN","FHNO2",9,0)
 K DIC S DIC="^FH(119.6,",DIC(0)="EMQ" D ^DIC G:Y<1 D1 S W1=+Y
"RTN","FHNO2",10,0)
 S D1=$P($G(^FH(119.6,W1,0)),"^",9) G D3
"RTN","FHNO2",11,0)
D2 R !!,"Select SUPPLEMENTAL FEEDING SITE: ",X:DTIME G:'$T!("^"[X) KIL
"RTN","FHNO2",12,0)
 K DIC S DIC="^FH(119.74,",DIC(0)="EMQ" D ^DIC G:Y<1 D2 S D1=+Y,W1=0
"RTN","FHNO2",13,0)
D3 R !!,"Select Supplemental Feeding Time (10,2,8,ALL): ",TIM:DTIME G KIL:'$T!(U[TIM) I TIM="all" S X=TIM D TR^FH S TIM=X
"RTN","FHNO2",14,0)
 I TIM'=2,TIM'=8,TIM'=10,TIM'="ALL" W *7," Enter a time, 10,2,8, or ALL" G D3
"RTN","FHNO2",15,0)
 W ! K DIR,LABSTART S DIR(0)="NA^1:10",DIR("A")="If using laser label sheets, what row do you want to begin printing at? ",DIR("B")=1 D ^DIR
"RTN","FHNO2",16,0)
 Q:$D(DIRUT)  S LABSTART=Y
"RTN","FHNO2",17,0)
D4 R !!,"Do you want Ingredient list only? N// ",D3:DTIME G:'$T!(D3="^") KIL S:D3="" D3="N" S X=D3 D TR^FH S D3=X I $P("YES",D3,1)'="",$P("NO",D3,1)'="" W *7,"  Answer YES or NO" G D4
"RTN","FHNO2",18,0)
 S D3=$E(D3,1),D3=D3="Y" G:'D3 D6
"RTN","FHNO2",19,0)
D5 R !!,"Consolidated List only? Y// ",X:DTIME G:'$T!(X="^") KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,"  Answer YES or NO" G D5
"RTN","FHNO2",20,0)
 S X=$E(X,1) S:X="Y" D3=D3+1
"RTN","FHNO2",21,0)
D6 I 'D3,'D1,XX="W" W !!,"No Supplemental Feeding Site associated with this ward." G KIL
"RTN","FHNO2",22,0)
 W:'D3 !!,"Place Labels in Printer"
"RTN","FHNO2",23,0)
PR K IOP S %ZIS="MQ",%ZIS("A")="Select "_$S('D3:"LABEL",1:"LIST")_" Printer: " W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHNO2",24,0)
 I $D(IO("Q")) S FHPGM="Q1^FHNO2",FHLST="XX^TIM^W1^D1^D3^LABSTART" D EN2^FH G KIL
"RTN","FHNO2",25,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHNO2",26,0)
Q1 ; Process Printing Supplemental Feeding Labels
"RTN","FHNO2",27,0)
 D NOW^%DTC S NOW=%,DT=%\1 G:D3=2 SUM
"RTN","FHNO2",28,0)
 I 'D3 Q:'D1  S FHPAR=$G(^FH(119.74,D1,0)),LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1
"RTN","FHNO2",29,0)
 S COUNT=0,LINE=1 I TIM="ALL" S TIM=10 D Q2 S TIM=2 D Q2 S TIM=8
"RTN","FHNO2",30,0)
 D Q2
"RTN","FHNO2",31,0)
 I $G(LAB)>2 D DPLL^FHLABEL,KIL Q
"RTN","FHNO2",32,0)
 I 'D3 F L=1:1:18 W !
"RTN","FHNO2",33,0)
KIL K ^TMP($J) G KILL^XUSCLEAN
"RTN","FHNO2",34,0)
Q2 K ^TMP($J,"L"),^TMP($J,"I"),^TMP($J,"SF"),C S P1=$S(TIM=10:5,TIM=2:13,1:21),T0=$P(DT,".",1)_"."_$S(TIM=10:1,TIM=2:14,1:2),P3=7,N1=0
"RTN","FHNO2",35,0)
 I XX="W" S P0=$P($G(^FH(119.6,W1,0)),"^",4),P0=$S(P0<1:99,P0<10:"0"_P0,1:P0) D F0
"RTN","FHNO2",36,0)
 I XX="S" F W1=0:0 S W1=$O(^FH(119.6,W1)) Q:W1<1  S X=^(W1,0),D2=$P(X,"^",9) I D1=D2 S P0=$P(X,"^",4),P0=$S(P0<1:99,P0<10:"0"_P0,1:P0) D F0
"RTN","FHNO2",37,0)
 G ^FHNO21:'D3,PRT
"RTN","FHNO2",38,0)
F0 S WRDN=$P(^FH(119.6,W1,0),"^",1),DFN=0
"RTN","FHNO2",39,0)
F1 S DFN=$O(^FHPT("AW",W1,DFN)) Q:DFN=""  S ADM=^(DFN) G:ADM<1 F1
"RTN","FHNO2",40,0)
 G:'$D(^FHPT(DFN,"A",ADM,0)) F1 S X1=^(0),NO=$P(X1,"^",7) G:'NO F1
"RTN","FHNO2",41,0)
 I 'D3 S IS=$P(X1,"^",10) I IS S IS=$P($G(^FH(119.4,IS,0)),"^",3) S:IS'="N" IS=""
"RTN","FHNO2",42,0)
 D CHK G:'NO F1
"RTN","FHNO2",43,0)
 S Y=$G(^FHPT(DFN,"A",ADM,"SF",NO,0))
"RTN","FHNO2",44,0)
 S Y=$P(Y,"^",P1,P1+7) G:Y?."^" F1 D:D3 CALC
"RTN","FHNO2",45,0)
 I 'D3 D
"RTN","FHNO2",46,0)
 .S $P(Y,"^",9)=IS
"RTN","FHNO2",47,0)
 .S LNOD=$S(XX="S":D2_"~"_$P($G(^FH(119.74,D2,0)),"^",1),1:P0_"~"_WRDN)
"RTN","FHNO2",48,0)
 .S RI=$G(^DPT(DFN,.108)) S RE=$S(RI:$O(^FH(119.6,"AR",+RI,W1,0)),1:"")
"RTN","FHNO2",49,0)
 .S R0=$S(RE:$P($G(^FH(119.6,W1,"R",+RE,0)),"^",2),1:"")
"RTN","FHNO2",50,0)
 .S R0=$S(R0<1:99,R0<10:"0"_R0,1:R0)
"RTN","FHNO2",51,0)
 .S RM=$G(^DPT(DFN,.101)),PNOD=P0_"~"_R0_RM_"~"_DFN,WRD=P0_$E(WRDN,1,27-$L(RM))_"/"_RM
"RTN","FHNO2",52,0)
 .S ^TMP($J,"L",LNOD,PNOD)=Y_"^"_WRD Q
"RTN","FHNO2",53,0)
 G F1
"RTN","FHNO2",54,0)
CHK S FHORD=$P(X1,"^",2),X1=$P(X1,"^",3) G:FHORD<1 C1
"RTN","FHNO2",55,0)
 I X1>1,X1'>T0 G C2
"RTN","FHNO2",56,0)
C0 I '$D(^FHPT(DFN,"A",ADM,"DI",FHORD,0)) G C2
"RTN","FHNO2",57,0)
 S X1=$P(^FHPT(DFN,"A",ADM,"DI",FHORD,0),"^",7) I X1'="",X1'="X" S NO=""
"RTN","FHNO2",58,0)
C1 K FHORD,A1,K,X1 Q
"RTN","FHNO2",59,0)
C2 S A1=0 F K=0:0 S K=$O(^FHPT(DFN,"A",ADM,"AC",K)) Q:K<1!(K>T0)  S A1=K
"RTN","FHNO2",60,0)
 G:'A1 C1 S FHORD=$P(^FHPT(DFN,"A",ADM,"AC",A1,0),"^",2) G:FHORD'<1 C0 K ^FHPT(DFN,"A",ADM,"AC",A1) G C2
"RTN","FHNO2",61,0)
SUM K C,^TMP($J,"SF") S P0=$S(TIM=2:13,TIM=8:21,1:5),P3=$S(TIM="ALL":23,1:7),N1=0
"RTN","FHNO2",62,0)
 I XX="W" S X=$G(^FH(119.6,W1,0)) D S0
"RTN","FHNO2",63,0)
 I XX="S" F W1=0:0 S W1=$O(^FH(119.6,W1)) Q:W1<1  S X=^(W1,0),D2=$P(X,"^",9) I D1=D2 D S0
"RTN","FHNO2",64,0)
 G PRT
"RTN","FHNO2",65,0)
S0 S WRDN=$P(^FH(119.6,W1,0),"^",1),DFN=0
"RTN","FHNO2",66,0)
S1 S DFN=$O(^FHPT("AW",W1,DFN)) Q:DFN=""  S ADM=^(DFN) G:ADM<1 S1
"RTN","FHNO2",67,0)
 G:'$D(^FHPT(DFN,"A",ADM,0)) S1 S X1=^(0),NO=$P(X1,"^",7) G:'NO S1
"RTN","FHNO2",68,0)
 S Y=$P(^FHPT(DFN,"A",ADM,"SF",NO,0),"^",P0,P0+P3) G:Y?."^" S1 D CALC
"RTN","FHNO2",69,0)
 G S1
"RTN","FHNO2",70,0)
PRT S DTP=DT D DTP^FH S DTE=DTP_" "_$S(TIM="ALL":"ALL",TIM=10:TIM_" AM",1:TIM_" PM")
"RTN","FHNO2",71,0)
 S Y=$S(XX="S":$P($G(^FH(119.74,D1,0)),"^",1),1:WRDN)
"RTN","FHNO2",72,0)
 W @IOF W:D3=2 !?5,"**** CONSOLIDATED ****" W !?3,"**** INGREDIENTS LIST ****",! W:D3=1 ! W ?(33-$L(Y)\2),Y,!?9,DTE,!!
"RTN","FHNO2",73,0)
 F L=0:0 S L=$O(^FH(118,L)) Q:L<1  S:$D(C(L)) ^TMP($J,"SF",$P($G(^FH(118,L,0)),"^",1),L)=""
"RTN","FHNO2",74,0)
 S A1="" F  S A1=$O(^TMP($J,"SF",A1)) Q:A1=""  F L=0:0 S L=$O(^TMP($J,"SF",A1,L)) Q:L<1  W !,$E(A1,1,26),?28,$J(C(L),5,0)
"RTN","FHNO2",75,0)
 W !!?4,"**** PATIENTS = ",N1," ****",! Q
"RTN","FHNO2",76,0)
CALC S N1=N1+1
"RTN","FHNO2",77,0)
 F L=1:2:P3 S Z=$P(Y,"^",L) I Z'="" S Q=$P(Y,"^",L+1) S:'Q Q=1 S:'$D(C(Z)) C(Z)=0 S C(Z)=C(Z)+Q
"RTN","FHNO2",78,0)
 Q
"RTN","FHNO21")
0^8^B14700916
"RTN","FHNO21",1,0)
FHNO21 ; HISC/REL/NCA - Print Feeding Labels ;8/26/94  12:01 
"RTN","FHNO21",2,0)
 ;;5.0;Dietetics;**38,39**;Oct 11, 1995
"RTN","FHNO21",3,0)
 S DTP=DT\1 D DTP^FH S DTE=DTP_" "_TIM_$S(TIM=10:"AM",1:"PM")
"RTN","FHNO21",4,0)
 S S1=$S(LAB=1:6,1:9),S2=LAB=2*5+33
"RTN","FHNO21",5,0)
 K N F L=0:0 S L=$O(^FH(118,L)) Q:L<1  S Y=^(L,0),N1=$P(Y,"^",1),^TMP($J,"I",$E(N1,1,26)_","_L)=L I '$D(^FH(118,L,"I")) S N(L)=$P(Y,"^",1,2)
"RTN","FHNO21",6,0)
 S LNOD="" F  S LNOD=$O(^TMP($J,"L",LNOD)) Q:LNOD=""  D P2
"RTN","FHNO21",7,0)
 Q
"RTN","FHNO21",8,0)
P2 S PNOD="",N1=0 K C F  S PNOD=$O(^TMP($J,"L",LNOD,PNOD)) Q:PNOD=""  S Y2=^(PNOD) D P3
"RTN","FHNO21",9,0)
 I LAB<3 D P5 Q
"RTN","FHNO21",10,0)
 Q
"RTN","FHNO21",11,0)
P3 S N1=N1+1
"RTN","FHNO21",12,0)
 S DFN=$P(PNOD,"~",3),WRD=$P(Y2,"^",10)
"RTN","FHNO21",13,0)
 S NAM=$P(^DPT(DFN,0),"^",1),IS=$P(Y2,"^",9) D PID^FHDPA
"RTN","FHNO21",14,0)
 I LAB>2 D LL Q
"RTN","FHNO21",15,0)
 I $P(FHPAR,"^",4)="Y" G P4
"RTN","FHNO21",16,0)
 W !,$E(NAM,1,S2-$L(WRD)),?(S2+2-$L(WRD)),$E(WRD,3,99),!?$S(LAB=1:3,1:0),BID W:IS'="" ?(S2-22),"*NURSE" W ?(S2-15),DTE S LN=2 I LAB=2 W !! S LN=4
"RTN","FHNO21",17,0)
 F L=1:2:7 S Z=$P(Y2,"^",L) I Z'="" D
"RTN","FHNO21",18,0)
 .S Q=$P(Y2,"^",L+1) S:'Q Q=1
"RTN","FHNO21",19,0)
 .W !,$J(Q,2)," "
"RTN","FHNO21",20,0)
 .W $S($D(N(Z)):$P(N(Z),"^",1),$D(^FH(118,+Z,0)):$P(^(0),"^",1),1:"")
"RTN","FHNO21",21,0)
 .S LN=LN+1 S:'$D(C(Z)) C(Z)=0 S C(Z)=C(Z)+Q
"RTN","FHNO21",22,0)
 .Q
"RTN","FHNO21",23,0)
 I LN<S1 F L=LN+1:1:S1 W !
"RTN","FHNO21",24,0)
 Q
"RTN","FHNO21",25,0)
P4 F L=1:2:7 S Z=$P(Y2,"^",L) I Z'="",$S($D(N(Z)):$P(N(Z),"^",2),$D(^FH(118,+Z,0)):$P(^(0),"^",2),1:"")'="N" D
"RTN","FHNO21",26,0)
 .S Q=$P(Y2,"^",L+1) S:'Q Q=1
"RTN","FHNO21",27,0)
 .W !,$E(NAM,1,S2-$L(WRD)),?(S2+2-$L(WRD)),$E(WRD,3,99),!,BID
"RTN","FHNO21",28,0)
 .W:IS'="" ?11,"*NURSE"
"RTN","FHNO21",29,0)
 .W ?(S2-15),DTE,!!,$J(Q,2)," "
"RTN","FHNO21",30,0)
 .W $S($D(N(Z)):$P(N(Z),"^",1),$D(^FH(118,+Z,0)):$P(^(0),"^",1),1:""),!!
"RTN","FHNO21",31,0)
 .W:LAB=2 !!!
"RTN","FHNO21",32,0)
 .S:'$D(C(Z)) C(Z)=0 S C(Z)=C(Z)+Q
"RTN","FHNO21",33,0)
 .Q
"RTN","FHNO21",34,0)
 Q
"RTN","FHNO21",35,0)
P5 S Y=$S(XX="S":$P($G(^FH(119.74,D1,0)),"^",1),1:$P($G(^FH(119.6,W1,0)),"^",1))
"RTN","FHNO21",36,0)
 W !?3,"**** INGREDIENTS LIST ****",!!?(33-$L(Y)\2),Y,!?9,DTE,!! S LN=6
"RTN","FHNO21",37,0)
 S A1="" F K=0:0 S A1=$O(^TMP($J,"I",A1)) Q:A1=""  S L=^(A1) I $D(C(L)),C(L) W !,$S($D(N(L)):$P(N(L),"^",1),$D(^FH(118,+L,0)):$P(^(0),"^",1),1:""),?28,$J(C(L),5,0) S LN=LN+1
"RTN","FHNO21",38,0)
P6 W !!?4,"**** PATIENTS = ",N1," ****",! S LN=LN+3
"RTN","FHNO21",39,0)
 S LN=LN#S1 I LN F L=LN+1:1:S1 W !
"RTN","FHNO21",40,0)
 Q
"RTN","FHNO21",41,0)
LL ;
"RTN","FHNO21",42,0)
 S FHCOL=$S(LAB=3:3,1:2)
"RTN","FHNO21",43,0)
 I LABSTART>1 F FHLABST=1:1:(LABSTART-1)*FHCOL D  S LABSTART=1
"RTN","FHNO21",44,0)
 .I LAB=3 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6)="" D LL3^FHLABEL
"RTN","FHNO21",45,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6,PCL7,PCL8)="" D LL4^FHLABEL
"RTN","FHNO21",46,0)
 .Q
"RTN","FHNO21",47,0)
 S FHTAB=$S(LAB=3:24,1:37)
"RTN","FHNO21",48,0)
 S WRD1=$E(WRD,3,99)
"RTN","FHNO21",49,0)
 S NAM=$E(NAM,1,FHTAB-$L(WRD1)),BIDIS=BID I IS="N" S BIDIS=BID_" *NURSE"
"RTN","FHNO21",50,0)
 S LNA=NAM_$J(WRD1,FHTAB+1-$L(NAM)),LNB=BIDIS_$J(DTE,FHTAB+1-$L(BIDIS))
"RTN","FHNO21",51,0)
 I $P(FHPAR,"^",4)="Y" D LL2 Q
"RTN","FHNO21",52,0)
 S NUM=0 F XSF=1:2:7 I $P(Y2,U,XSF)'="" S NUM=NUM+1
"RTN","FHNO21",53,0)
 S INDX=0 F XSF=1:2:7 D
"RTN","FHNO21",54,0)
 .S SFPTR=$P(Y2,U,XSF) I SFPTR="" Q
"RTN","FHNO21",55,0)
 .S QTY=$P(Y2,U,XSF+1),SFNM=$P($G(^FH(118,SFPTR,0)),U,1)
"RTN","FHNO21",56,0)
 .S INDX=INDX+1,ZF(INDX)=$J(QTY,2)_" "_SFNM
"RTN","FHNO21",57,0)
 .Q
"RTN","FHNO21",58,0)
 I LAB=3 D
"RTN","FHNO21",59,0)
 .I NUM=1 S (PCL1,PCL2,PCL6)="",PCL3=LNA,PCL4=LNB,PCL5=ZF(1)
"RTN","FHNO21",60,0)
 .I NUM=2 S (PCL1,PCL6)="",PCL2=LNA,PCL3=LNB,PCL4=ZF(1),PCL5=ZF(2)
"RTN","FHNO21",61,0)
 .I NUM=3 S PCL1="",PCL2=LNA,PCL3=LNB,PCL4=ZF(1),PCL5=ZF(2),PCL6=ZF(3)
"RTN","FHNO21",62,0)
 .I NUM=4 S PCL1=LNA,PCL2=LNB,PCL3=ZF(1),PCL4=ZF(2),PCL5=ZF(3),PCL6=ZF(4)
"RTN","FHNO21",63,0)
 .D LL3^FHLABEL
"RTN","FHNO21",64,0)
 I LAB=4 D
"RTN","FHNO21",65,0)
 .I NUM=1 S (PCL1,PCL2,PCL3,PCL7,PCL8)="",PCL4=LNA,PCL5=LNB,PCL6=ZF(1)
"RTN","FHNO21",66,0)
 .I NUM=2 S (PCL1,PCL2,PCL7,PCL8)="",PCL3=LNA,PCL4=LNB,PCL5=ZF(1),PCL6=ZF(2)
"RTN","FHNO21",67,0)
 .I NUM=3 S (PCL1,PCL2,PCL8)="",PCL3=LNA,PCL4=LNB,PCL5=ZF(1),PCL6=ZF(2),PCL7=ZF(3)
"RTN","FHNO21",68,0)
 .I NUM=4 S (PCL1,PCL8)="",PCL2=LNA,PCL3=LNB,PCL4=ZF(1),PCL5=ZF(2),PCL6=ZF(3),PCL7=ZF(4)
"RTN","FHNO21",69,0)
 .D LL4^FHLABEL
"RTN","FHNO21",70,0)
 Q
"RTN","FHNO21",71,0)
LL2 ;
"RTN","FHNO21",72,0)
 F XSF=1:2:7 D
"RTN","FHNO21",73,0)
 .S SFPTR=$P(Y2,U,XSF) I SFPTR="" Q
"RTN","FHNO21",74,0)
 .S QTY=$P(Y2,U,XSF+1),SFNM=$P($G(^FH(118,SFPTR,0)),U,1)
"RTN","FHNO21",75,0)
 .S LNC=$J(QTY,2)_" "_SFNM
"RTN","FHNO21",76,0)
 .I LAB=3 S (PCL1,PCL4,PCL6)="",PCL2=LNA,PCL3=LNB,PCL5=LNC D LL3^FHLABEL
"RTN","FHNO21",77,0)
 .I LAB=4 S (PCL1,PCL2,PCL5,PCL7,PCL8)="",PCL3=LNA,PCL4=LNB,PCL6=LNC D LL4^FHLABEL
"RTN","FHNO21",78,0)
 Q
"RTN","FHNO41")
0^19^B15592275
"RTN","FHNO41",1,0)
FHNO41 ; HISC/REL - List Bulk Nourishments ;7/14/93  10:13
"RTN","FHNO41",2,0)
 ;;5.0;Dietetics;**38,39**;Oct 11, 1995
"RTN","FHNO41",3,0)
 S D1=$O(^FH(119.74,0)) I D1'<1,$O(^FH(119.74,D1))<1 G N3
"RTN","FHNO41",4,0)
N2 R !!,"Select SUPPLEMENTAL FEEDING SITE (or ALL): ",X:DTIME G:'$T!("^"[X) KIL I X="ALL" S D1=0 G N3
"RTN","FHNO41",5,0)
 K DIC S DIC="^FH(119.74,",DIC(0)="EMQ" D ^DIC G:Y<1 N2 S D1=+Y
"RTN","FHNO41",6,0)
N3 R !!,"Do you want Labels? N// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="N" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,"  Enter YES or NO" G N3
"RTN","FHNO41",7,0)
 S X=$E(X,1),LAB=X="Y"
"RTN","FHNO41",8,0)
 S FHLBFLG=1 I LAB D  I FHLBFLG=0 Q
"RTN","FHNO41",9,0)
 .W ! K DIR,LABSTART S DIR(0)="NA^1:10",DIR("A")="If using laser label sheets, what row do you want to begin printing at? ",DIR("B")=1 D ^DIR
"RTN","FHNO41",10,0)
 .I $D(DIRUT) S FHLBFLG=0 Q
"RTN","FHNO41",11,0)
 .S LABSTART=Y Q
"RTN","FHNO41",12,0)
 W ! K IOP,%ZIS S %ZIS("A")="Select "_$S(LAB:"LABEL",1:"LIST")_" Printer: ",%ZIS="MQ" D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHNO41",13,0)
 I $D(IO("Q")) S FHPGM="Q1^FHNO41",FHLST="D1^LAB^LABSTART" D EN2^FH G KIL
"RTN","FHNO41",14,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHNO41",15,0)
Q1 ; Process Printing Bulk Nourishments
"RTN","FHNO41",16,0)
 K ^TMP($J) D NOW^%DTC S DTP=% D DTP^FH
"RTN","FHNO41",17,0)
 I LAB S LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1
"RTN","FHNO41",18,0)
 F K=0:0 S K=$O(^FH(119.6,K)) Q:K<1  S X=^(K,0),D2=$P(X,"^",9) I 'D1!(D1=D2),$O(^FH(119.6,K,"BN",0))>0 S P0=$P(X,"^",4) S:P0<1 P0=99 S ^TMP($J,P0,K)=""
"RTN","FHNO41",19,0)
 G:LAB L0
"RTN","FHNO41",20,0)
 S D3=$S('D1:"ALL SITES",1:$P(^FH(119.74,D1,0),"^",1)),PG=0 D HDR
"RTN","FHNO41",21,0)
 K D S C1=0 F P0=0:0 S P0=$O(^TMP($J,P0)) Q:P0<1  F K=0:0 S K=$O(^TMP($J,P0,K)) Q:K<1  D Q4
"RTN","FHNO41",22,0)
 D:$Y>(IOSL-8) HDR W !!?(45-$L(D3)\2),"***** ",D3," TOTAL *****"
"RTN","FHNO41",23,0)
 W !!,"   Qty  Item",?33,"Cost   Vehicle   Other   Total",!
"RTN","FHNO41",24,0)
 S (C(0),C(1))=0 F K=0:0 S K=$O(D(K)) Q:K<1  D:$Y>(IOSL-8) HDR S Y=^FH(118,K,0) D C3 S CT=$P(Y,"^",4)="Y",C(CT)=D(K)*C3+C(CT) W !,$J(D(K),6),"  ",$P(Y,"^",1),?31,$J(C3,6,2) W ?($S(CT:40,1:49)),$J(D(K)*C3,6,2),?57,$J(D(K)*C3,6,2)
"RTN","FHNO41",25,0)
 W !!?8,"Total",?39,$J(C(1),7,2),?48,$J(C(0),7,2),?56,$J(C(0)+C(1),7,2)
"RTN","FHNO41",26,0)
Q3 W ! Q
"RTN","FHNO41",27,0)
Q4 D:$Y>(IOSL-8) HDR W !!,"--- ",$P(^FH(119.6,K,0),"^",1)," ---",! S C1=C1+1
"RTN","FHNO41",28,0)
 F L=0:0 S L=$O(^FH(119.6,K,"BN",L)) Q:L<1  S X=^(L,0),X1=$P(X,"^",1),X2=$P(X,"^",2) I X1,$D(^FH(118,X1,0)) D:$Y>(IOSL-8) HDR W !,$J(X2,6),"  ",$P(^(0),"^",1) S:'$D(D(X1)) D(X1)=0 S D(X1)=D(X1)+X2
"RTN","FHNO41",29,0)
 Q
"RTN","FHNO41",30,0)
HDR ; Print Header
"RTN","FHNO41",31,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1
"RTN","FHNO41",32,0)
 S X="BULK NOURISHMENTS FOR: "_D3 W !?(80-$L(X)\2),X,?73,"Page ",PG,!!?32,DTP,! Q
"RTN","FHNO41",33,0)
L0 S S2=LAB=2*5+32,S1=$S(LAB=2:9,1:6),COUNT=0,LINE=1
"RTN","FHNO41",34,0)
 K D S C1=0
"RTN","FHNO41",35,0)
 F P0=0:0 S P0=$O(^TMP($J,P0)) Q:P0<1  F K=0:0 S K=$O(^TMP($J,P0,K)) Q:K<1  S WRD=$P(^FH(119.6,K,0),"^",1) F L=0:0 S L=$O(^FH(119.6,K,"BN",L)) Q:L<1  D L3
"RTN","FHNO41",36,0)
 I LAB>2 D DPLL^FHLABEL Q
"RTN","FHNO41",37,0)
 Q:'C1  S LN=6,X="BULK NOURISHMENTS PICK LIST" W !!?(S2-$L(X)\2),X
"RTN","FHNO41",38,0)
 S D3=$S('D1:"ALL SITES",1:$P(^FH(119.74,D1,0),"^",1)) W !!?(S2-$L(D3)\2),D3,!!
"RTN","FHNO41",39,0)
 F K=0:0 S K=$O(D(K)) Q:K<1  W !,$J(D(K),4),"  ",$P(^FH(118,K,0),"^",1) S LN=LN+1
"RTN","FHNO41",40,0)
 S LN=LN#S1 I LN F K=LN+1:1:S1 W !
"RTN","FHNO41",41,0)
 Q
"RTN","FHNO41",42,0)
L3 S X=^FH(119.6,K,"BN",L,0),X1=$P(X,"^",1),X2=$P(X,"^",2) Q:'X1!('$D(^FH(118,X1,0)))
"RTN","FHNO41",43,0)
 S:'$D(D(X1)) D(X1)=0 S D(X1)=D(X1)+X2,C1=C1+1
"RTN","FHNO41",44,0)
 S X1=^FH(118,X1,0),CHK=$P(X1,"^",2) Q:CHK="N"  S X1=$P(X1,"^",1)
"RTN","FHNO41",45,0)
 I LAB>2 D LL Q
"RTN","FHNO41",46,0)
 F C1=1:1:X2 W !!?(S2-$L(X1)\2),X1,!!,WRD,?(S2-$L(DTP)),DTP,!! W:LAB=2 !!!
"RTN","FHNO41",47,0)
 Q
"RTN","FHNO41",48,0)
C3 S C3=$P($G(^FH(114,+$P(Y,"^",7),0)),"^",13) Q
"RTN","FHNO41",49,0)
KIL K ^TMP($J) G KILL^XUSCLEAN
"RTN","FHNO41",50,0)
 Q
"RTN","FHNO41",51,0)
LL ;
"RTN","FHNO41",52,0)
 S FHCOL=$S(LAB=3:3,1:2)
"RTN","FHNO41",53,0)
 I LABSTART>1 F FHLABST=1:1:(LABSTART-1)*FHCOL D  S LABSTART=1
"RTN","FHNO41",54,0)
 .I LAB=3 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6)="" D LL3^FHLABEL
"RTN","FHNO41",55,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6,PCL7,PCL8)="" D LL4^FHLABEL
"RTN","FHNO41",56,0)
 .Q
"RTN","FHNO41",57,0)
 F C1=1:1:X2 D
"RTN","FHNO41",58,0)
 .S FHTAB=$S(LAB=3:24,1:37),SPC=$J(" ",70)
"RTN","FHNO41",59,0)
 .S LNA=$E(SPC,1,FHTAB-$L(X1)/2)_X1,LNB=WRD_$J(DTP,FHTAB+1-$L(WRD))
"RTN","FHNO41",60,0)
 .I LAB=3 S (PCL1,PCL2,PCL4,PCL6)="",PCL3=LNA,PCL5=LNB
"RTN","FHNO41",61,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL5,PCL7,PCL8)="",PCL4=LNA,PCL6=LNB
"RTN","FHNO41",62,0)
 .D:LAB=3 LL3^FHLABEL D:LAB=4 LL4^FHLABEL
"RTN","FHNO41",63,0)
 Q
"RTN","FHORD13")
0^12^B13513201
"RTN","FHORD13",1,0)
FHORD13 ; HISC/REL/NCA - Reprint Diet Label ;2/26/96  11:57
"RTN","FHORD13",2,0)
 ;;5.0;Dietetics;**2,38,39**;Mar 25, 1996
"RTN","FHORD13",3,0)
 W @IOF,!!?21,"R E P R I N T   D I E T   L A B E L S"
"RTN","FHORD13",4,0)
F0 R !!,"Reprint by COMMUNICATION OFFICE, PATIENT, or WARD? PATIENT// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="P" D TR^FH I $P("COMMUNICATION OFFICE",X,1)'="",$P("PATIENT",X,1)'="",$P("WARD",X,1)'="" W *7,!!,"  Answer with C, W, or P" G F0
"RTN","FHORD13",5,0)
 S FHPR=$E(X,1),ALL=0,(FHX1,FHX2)="" G P0:FHPR?1"P",D2:FHPR?1"C"
"RTN","FHORD13",6,0)
W0 K DIC S DIC("A")="Select WARD: ",DIC="^FH(119.6,",DIC(0)="AEQM" W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),W0:Y<1 S FHX1=-Y G P1
"RTN","FHORD13",7,0)
D2 K DIC S DIC("A")="Select COMMUNICATION OFFICE: ",DIC="^FH(119.73,",DIC(0)="AEMQ" W ! D ^DIC G KIL:"^"[X!$D(DTOUT),D2:Y<1 S FHX1=-Y G P1
"RTN","FHORD13",8,0)
P0 D ^FHDPA I DFN S FHX1=$G(FHX1)_DFN_"^",FHX2=$G(FHX2)_ADM_"^" I $L(FHX1)<231,$L(FHX2)<231 G P0
"RTN","FHORD13",9,0)
 G:FHX1="" KIL
"RTN","FHORD13",10,0)
P1 ;
"RTN","FHORD13",11,0)
 W ! K DIR,LABSTART S DIR(0)="NA^1:10",DIR("A")="If using laser label sheets, what row do you want to begin printing at? ",DIR("B")=1 D ^DIR
"RTN","FHORD13",12,0)
 Q:$D(DIRUT)  S LABSTART=Y
"RTN","FHORD13",13,0)
 W ! K IOP,%ZIS S %ZIS("A")="Select LABEL Printer: ",%ZIS="MQ" D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHORD13",14,0)
 I $D(IO("Q")) S FHPGM="Q1^FHORD13",FHLST="FHX1^FHX2^FHPR^LABSTART" D EN2^FH G KIL
"RTN","FHORD13",15,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHORD13",16,0)
Q1 ; Reprint the Diet Labels
"RTN","FHORD13",17,0)
 S LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1 S S2=LAB=2*5+36 D NOW^%DTC S NOW=%
"RTN","FHORD13",18,0)
 S COUNT=0,LINE=1
"RTN","FHORD13",19,0)
 S DTP=NOW D DTP^FH,^FHDEV G:FHX1>0 Q2
"RTN","FHORD13",20,0)
 S WRD=-FHX1 K ^TMP($J)
"RTN","FHORD13",21,0)
 F K1=0:0 S K1=$O(^FH(119.6,K1)) Q:K1<1  S X=^(K1,0) D F1
"RTN","FHORD13",22,0)
 S RM="" F  S RM=$O(^TMP($J,"DL",RM)) Q:RM=""  F DFN=0:0 S DFN=$O(^TMP($J,"DL",RM,DFN)) Q:DFN<1  S ADM=^(DFN) D:ADM LST
"RTN","FHORD13",23,0)
 I LAB>2 D DPLL^FHLABEL K ^TMP($J) Q
"RTN","FHORD13",24,0)
 K ^TMP($J) G Q3
"RTN","FHORD13",25,0)
F1 I FHPR="C" S KK=$P(X,"^",8) I WRD,KK'=WRD Q
"RTN","FHORD13",26,0)
 I FHPR="W" S KK=$P(X,"^",1) I WRD,K1'=WRD Q
"RTN","FHORD13",27,0)
 S P0=$P(X,"^",4),P0=$S(P0<1:99,P0<10:"0"_P0,1:P0)
"RTN","FHORD13",28,0)
 F DFN=0:0 S DFN=$O(^FHPT("AW",K1,DFN)) Q:DFN<1  D
"RTN","FHORD13",29,0)
 .S ADM=^(DFN),RM=$G(^DPT(DFN,.101))
"RTN","FHORD13",30,0)
 .S:RM="" RM="***"
"RTN","FHORD13",31,0)
 .S RI=$G(^DPT(DFN,.108)) S RE=$S(RI:$O(^FH(119.6,"AR",+RI,K1,0)),1:"")
"RTN","FHORD13",32,0)
 .S R0=$S(RE:$P($G(^FH(119.6,K1,"R",+RE,0)),"^",2),1:"")
"RTN","FHORD13",33,0)
 .S R0=$S(R0<1:99,R0<10:"0"_R0,1:R0)
"RTN","FHORD13",34,0)
 .S ^TMP($J,"DL",P0_"~"_R0_"~"_RM,DFN)=ADM Q
"RTN","FHORD13",35,0)
 Q
"RTN","FHORD13",36,0)
Q2 F K7=1:1 S DFN=$P(FHX1,"^",K7) Q:DFN<1  S ADM=$P(FHX2,"^",K7) D LST
"RTN","FHORD13",37,0)
 I LAB>2 D DPLL^FHLABEL K ^TMP($J) Q
"RTN","FHORD13",38,0)
Q3 I LAB<3 F K7=1:1:18 W !
"RTN","FHORD13",39,0)
 Q
"RTN","FHORD13",40,0)
LST Q:'$D(^FHPT(DFN,"A",ADM,0))  S X0=^(0)
"RTN","FHORD13",41,0)
 S FHORD=$P(X0,"^",2),X1=$P(X0,"^",5) Q:FHORD<1
"RTN","FHORD13",42,0)
 S W1=$P(X0,"^",8),W1=$P($G(^FH(119.6,+W1,0)),"^",1),R1=$G(^DPT(DFN,.101))
"RTN","FHORD13",43,0)
 Q:'$D(^DPT(DFN,0))  S Y0=^(0) D PID^FHDPA
"RTN","FHORD13",44,0)
 S W1=$E(W1,1,15),N1=$E($P(Y0,"^",1),1,22)
"RTN","FHORD13",45,0)
 S X=$G(^FHPT(DFN,"A",ADM,"DI",FHORD,0))
"RTN","FHORD13",46,0)
 S (Y,X1)="" G:X="" L1 S FHOR=$P(X,"^",2,6),FHLD=$P(X,"^",7)
"RTN","FHORD13",47,0)
 I FHLD'="" S FHDU=";"_$P(^DD(115.02,6,0),"^",3),%=$F(FHDU,";"_FHLD_":") G:%<1 L1 S Y=$P($E(FHDU,%,999),";",1) G L1
"RTN","FHORD13",48,0)
 F A1=1:1:5 S D3=$P(FHOR,"^",A1) I D3 S:Y'="" Y=Y_", " S Y=Y_$P(^FH(111,D3,0),"^",7)
"RTN","FHORD13",49,0)
 S IS=$P(X0,"^",10),X1=$P(X,"^",8) I IS S IS=^FH(119.4,IS,0),X1=X1_"-"_$P(IS,"^",2)_$P(IS,"^",3)
"RTN","FHORD13",50,0)
L1 I LAB>2 D LL Q
"RTN","FHORD13",51,0)
 W !,$E(N1,1,S2-5-$L(W1)),?(S2-3-$L(W1)),W1,!,BID W @FHIO("EON") W ?(S2-3\2),X1 W @FHIO("EOF") W ?(S2-3-$L(R1)),R1 W @FHIO("EON") I $L(Y)<S2 W:LAB=2 ! W !!,Y,!!
"RTN","FHORD13",52,0)
 E  S L=$S($L($P(Y,",",1,3))<S2:3,1:2) W !!,$P(Y,",",1,L) W:LAB=2 ! W !,$E($P(Y,",",L+1,5),2,99),!
"RTN","FHORD13",53,0)
 W @FHIO("EOF") W:LAB=2 ?(S2-20),DTP,!! Q
"RTN","FHORD13",54,0)
KIL K ^TMP($J) G KILL^XUSCLEAN
"RTN","FHORD13",55,0)
 Q
"RTN","FHORD13",56,0)
LL D LAB^FHLABEL Q
"RTN","FHORE2")
0^13^B6627501
"RTN","FHORE2",1,0)
FHORE2 ; HISC/REL/NCA - List Early/Late Trays ;3/15/95  08:59
"RTN","FHORE2",2,0)
 ;;5.0;Dietetics;**39**;Oct 11, 1995
"RTN","FHORE2",3,0)
 S FHP=$O(^FH(119.73,0)) I FHP'<1,$O(^FH(119.73,FHP))<1 G N1
"RTN","FHORE2",4,0)
R0 R !!,"Select COMMUNICATION OFFICE (or ALL): ",X:DTIME G:'$T!("^"[X) KIL D:X="all" TR^FH I X="ALL" S FHP=0 G N1
"RTN","FHORE2",5,0)
 K DIC S DIC="^FH(119.73,",DIC(0)="EMQ" D ^DIC G:Y<1 R0 S FHP=+Y
"RTN","FHORE2",6,0)
N1 W ! S %DT="AEX",%DT("A")="Select Date: " D ^%DT K %DT G KIL:X[U!$D(DTOUT),N1:Y<1 S DTE=+Y\1
"RTN","FHORE2",7,0)
N2 R !!,"Select Meal (B,N,E or ALL): ",MEAL:DTIME G:'$T!("^"[MEAL) KIL S X=MEAL D TR^FH S MEAL=X
"RTN","FHORE2",8,0)
 S:$P("ALL",MEAL,1)="" MEAL="A" I "BNEA"'[MEAL!(MEAL'?1U) W *7,!,"Select B for Breakfast, N for Noon, E for Evening or ALL for all meals" G N2
"RTN","FHORE2",9,0)
N3 R !!,"Do you want Labels? N// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="N" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,"  Enter YES or NO" G N3
"RTN","FHORE2",10,0)
 S LAB=X?1"Y".E
"RTN","FHORE2",11,0)
 S FHLBFLG=1 I LAB D  I FHLBFLG=0 Q
"RTN","FHORE2",12,0)
 .W ! K DIR,LABSTART S DIR(0)="NA^1:10",DIR("A")="If using laser label sheets, what row do you want to begin printing at? ",DIR("B")=1 D ^DIR
"RTN","FHORE2",13,0)
 .I $D(DIRUT) S FHLBFLG=0 Q
"RTN","FHORE2",14,0)
 .S LABSTART=Y Q
"RTN","FHORE2",15,0)
 I 'LAB W !!,"The list requires a 132 column printer.",!
"RTN","FHORE2",16,0)
 W ! K IOP,%ZIS S %ZIS("A")="Select "_$S(LAB:"LABEL",1:"LIST")_" Printer: ",%ZIS="MQ" D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHORE2",17,0)
 I $D(IO("Q")) S FHPGM="^FHORE21",FHLST="FHP^LAB^DTE^MEAL^LABSTART" D EN2^FH G KIL
"RTN","FHORE2",18,0)
 U IO D ^FHORE21 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHORE2",19,0)
KIL K %,%H,%I,%DT,A1,ADM,ANS,BAG,D1,D3,DFN,DIC,DP,DTP,DTE,FHDU,FHLD,FHOR,FHP,H1,IS,K,K1,K2,KK,L,L1,LAB,LABSTART,M1,M2,MEAL,N,N1,N2,O1,OLW,FHORD,P0,P1,P2,PG,POP,RM,S1,TIM,W1,WARD,X,X2,Y K ^TMP($J) Q
"RTN","FHORE21")
0^14^B16948920
"RTN","FHORE21",1,0)
FHORE21 ; HISC/REL/NCA - List Early/Late Trays (cont) ;11/9/94  13:33 
"RTN","FHORE21",2,0)
 ;;5.0;Dietetics;**38,39**;Oct 11, 1995
"RTN","FHORE21",3,0)
 S D1=DTE,COUNT=0,LINE=1 K ^TMP($J) S ANS=""
"RTN","FHORE21",4,0)
F2 S D1=$O(^FHPT("ADLT",D1)) G:D1<1!(D1\1'=DTE) P0 S DFN=0
"RTN","FHORE21",5,0)
F3 S DFN=$O(^FHPT("ADLT",D1,DFN)) G:DFN<1 F2 S ADM=0
"RTN","FHORE21",6,0)
F4 S ADM=$O(^FHPT("ADLT",D1,DFN,ADM)) G:ADM<1 F3
"RTN","FHORE21",7,0)
 I $S($D(^DGPM(ADM,0)):$P(^(0),"^",17),1:1) G F7
"RTN","FHORE21",8,0)
 S Y(0)=$G(^FHPT(DFN,"A",ADM,"EL",D1,0)) G:Y(0)="" F7
"RTN","FHORE21",9,0)
 S X=$G(^FHPT(DFN,"A",ADM,0)),OLW=$P(X,"^",11),IS=$P(X,"^",10)
"RTN","FHORE21",10,0)
 S W1=$P(X,"^",8),X2=$G(^FH(119.6,+W1,0)),WARD=$P(X2,"^",1)
"RTN","FHORE21",11,0)
 G:WARD="" F4 S P0=$P(X2,"^",8) I FHP,P0'=FHP G F4
"RTN","FHORE21",12,0)
 S M1=$P(Y(0),"^",2) I MEAL'="A",M1'=MEAL G F4
"RTN","FHORE21",13,0)
 D CUR G:FHLD'="" F4 S O1=Y
"RTN","FHORE21",14,0)
 S ^TMP($J,"EL",D1_"-"_$P(Y(0),"^",6),DFN_"-"_ADM)=WARD_"^"_P0_"^"_OLW_"^"_IS_"^"_O1_"^"_$P(Y(0),"^",2,4) G F4
"RTN","FHORE21",15,0)
P0 D NOW^%DTC S DTP=% D DTP^FH S H1=DTP,DTP=DTE\1 D DTP^FH S L1=DTP
"RTN","FHORE21",16,0)
 I LAB S LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1
"RTN","FHORE21",17,0)
 S S1=LAB=2*5+36
"RTN","FHORE21",18,0)
P1 S M2="Z",PG=0 D:'LAB HDR
"RTN","FHORE21",19,0)
 S N1="" F  S N1=$O(^TMP($J,"EL",N1)) Q:N1=""!(ANS="^")  S N2="" F  S N2=$O(^TMP($J,"EL",N1,N2)) Q:N2=""  S Y=^(N2) D P2 Q:ANS="^"
"RTN","FHORE21",20,0)
 I LAB>2 D DPLL^FHLABEL K ^TMP($J) Q
"RTN","FHORE21",21,0)
 I LAB<3 F K=1:1:$S('LAB:1,1:18) W !
"RTN","FHORE21",22,0)
 Q
"RTN","FHORE21",23,0)
P2 S DFN=+N2,WARD=$P(Y,"^",1),P0=$P(Y,"^",2),OLW=$P(Y,"^",3),IS=$P(Y,"^",4),O1=$P(Y,"^",5),M1=$P(Y,"^",6),TIM=$P(Y,"^",7),BAG=$P(Y,"^",8)
"RTN","FHORE21",24,0)
 I IS S IS=^FH(119.4,IS,0),IS=$P(IS,"^",2)_$P(IS,"^",3)
"RTN","FHORE21",25,0)
 S Y=^DPT(DFN,0),P1=$P(Y,"^",1) D PID^FHDPA
"RTN","FHORE21",26,0)
 S RM=$G(^DPT(DFN,.101)) I LAB>2 D LL Q
"RTN","FHORE21",27,0)
 G:LAB P3
"RTN","FHORE21",28,0)
 I $Y>(IOSL-10) D HDR Q:ANS="^"  W !!?59,$S(M1="B":"Break",M1="N":"Noon",1:"Even"),?65,$J(TIM,6),! S M2=M1_TIM
"RTN","FHORE21",29,0)
 S X=M1_TIM I X'=M2 W !!?59,$S(M1="B":"Break",M1="N":"Noon",1:"Even"),?65,$J(TIM,6),! S M2=X
"RTN","FHORE21",30,0)
 W !,$S(WARD'="":$E(WARD,1,10),1:"")_$S(RM'="":"/"_$E(RM,1,10),1:""),?24,$E(P1,1,22),?50,BID,?61,$S(IS'="":IS,1:""),?67,$S(BAG="Y":"YES",1:""),?73,O1
"RTN","FHORE21",31,0)
 Q
"RTN","FHORE21",32,0)
P3 S P1=$E(P1,1,22),WARD=$E(WARD,1,15),RM=$E(RM,1,10)
"RTN","FHORE21",33,0)
 W !,$S(M1="B":"Breakfast",M1="N":"  Noon ",1:" Evening"),?10,TIM,?(S1-12),L1 W:LAB=2 !
"RTN","FHORE21",34,0)
 W !,$E(P1,1,S1-5-$L(WARD)),?(S1-3-$L(WARD)),WARD
"RTN","FHORE21",35,0)
 W !,BID W:IS'="" ?(S1-3\2),IS W ?(S1-3-$L(RM)),RM W:LAB=2 !
"RTN","FHORE21",36,0)
 I $L(O1)<S1 W !,O1,!!
"RTN","FHORE21",37,0)
 E  S L=$S($L($P(O1,",",1,3))<S1:3,1:2) W !,$P(O1,",",1,L),!,$E($P(O1,",",L+1,5),2,99),!
"RTN","FHORE21",38,0)
 W:LAB=2 ! Q
"RTN","FHORE21",39,0)
F7 K ^FHPT("ADLT",D1,DFN,ADM) G F4
"RTN","FHORE21",40,0)
CUR S A1=0,(Y,FHLD,FHOR)="" F KK=0:0 S KK=$O(^FHPT(DFN,"A",ADM,"AC",KK)) Q:KK<1!(KK>D1)  S A1=KK
"RTN","FHORE21",41,0)
 Q:'A1  S FHORD=$P(^FHPT(DFN,"A",ADM,"AC",A1,0),"^",2),X=^FHPT(DFN,"A",ADM,"DI",FHORD,0),FHOR=$P(X,"^",2,6),FHLD=$P(X,"^",7)
"RTN","FHORE21",42,0)
 I FHLD'="" S FHDU=";"_$P(^DD(115.02,6,0),"^",3),%=$F(FHDU,";"_FHLD_":") Q:%<1  S Y=$P($E(FHDU,%,999),";",1) Q
"RTN","FHORE21",43,0)
 S Y="" F A1=1:1:5 S D3=$P(FHOR,"^",A1) I D3 S:Y'="" Y=Y_", " S Y=Y_$P(^FH(111,D3,0),"^",7)
"RTN","FHORE21",44,0)
 Q
"RTN","FHORE21",45,0)
DP K N S Y=$G(^FH(119.73,+P0,1))
"RTN","FHORE21",46,0)
 F KK=1,2,3,7,8,9,13,14,15 S X=$P(Y,"^",KK) I X'="" S N($S(KK<7:"B",KK<13:"N",1:"E"),X)=""
"RTN","FHORE21",47,0)
 Q
"RTN","FHORE21",48,0)
HDR ; Print Header
"RTN","FHORE21",49,0)
 I PG,IOST?1"C-".E R !!,"Press RETURN to continue or ""^"" to exit. ",ANS:DTIME S:'$T!(ANS["^") ANS="^" Q:ANS="^"  I "^"'[ANS W !,"Enter Return or ""^""." G HDR
"RTN","FHORE21",50,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1
"RTN","FHORE21",51,0)
 W !?50,"E A R L Y / L A T E   T R A Y S",?110,H1
"RTN","FHORE21",52,0)
 W !,$S('FHP:"Consolidated",1:$P(^FH(119.73,FHP,0),"^",1)),?61,L1,?121,"Page ",PG
"RTN","FHORE21",53,0)
 W !!,"Ward/Room",?24,"Patient",?50,"ID#",?61,"Iso   Bag   Current-Diet",! Q
"RTN","FHORE21",54,0)
LL ;
"RTN","FHORE21",55,0)
 S FHCOL=$S(LAB=3:3,1:2)
"RTN","FHORE21",56,0)
 I LABSTART>1 F FHLABST=1:1:(LABSTART-1)*FHCOL D  S LABSTART=1
"RTN","FHORE21",57,0)
 .I LAB=3 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6)="" D LL3^FHLABEL
"RTN","FHORE21",58,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6,PCL7,PCL8)="" D LL4^FHLABEL
"RTN","FHORE21",59,0)
 .Q
"RTN","FHORE21",60,0)
 S SL1=$S(LAB=3:25,1:38)
"RTN","FHORE21",61,0)
 S MEALTM=$S(M1="B":"Breakfast",M1="N":"Noon",1:"Evening")_"  "_TIM
"RTN","FHORE21",62,0)
 S BIDIS=BID_$E("        ",1,12-$L(BID))_IS
"RTN","FHORE21",63,0)
 S WARD=$E(WARD,1,15),WLN=$L(WARD),RM=$E(RM,1,10)
"RTN","FHORE21",64,0)
 I LAB=3 D
"RTN","FHORE21",65,0)
 .S P1=$E(P1,1,24-WLN)
"RTN","FHORE21",66,0)
 .S (PCL1,PCL6)="",PCL2=MEALTM_$J(L1,25-$L(MEALTM))
"RTN","FHORE21",67,0)
 .S PCL3=P1_$J(WARD,25-$L(P1)),PCL4=BIDIS_$J(RM,25-$L(BIDIS))
"RTN","FHORE21",68,0)
 .S PCL5=$E(O1,1,29) D LL3^FHLABEL
"RTN","FHORE21",69,0)
 I LAB=4 D
"RTN","FHORE21",70,0)
 .S P1=$E(P1,1,37-WLN)
"RTN","FHORE21",71,0)
 .S (PCL1,PCL2,PCL7,PCL8)="",PCL3=MEALTM_$J(L1,38-$L(MEALTM))
"RTN","FHORE21",72,0)
 .S PCL4=P1_$J(WARD,38-$L(P1)),PCL5=BIDIS_$J(RM,38-$L(BIDIS))
"RTN","FHORE21",73,0)
 .S PCL6=$E(O1,1,42) D LL4^FHLABEL
"RTN","FHORE21",74,0)
 Q
"RTN","FHORT5")
0^17^B7649904
"RTN","FHORT5",1,0)
FHORT5 ; HISC/REL/NCA - Tubefeeding Reports ;3/16/95  14:27
"RTN","FHORT5",2,0)
 ;;5.0;Dietetics;**39**;Oct 11, 1995
"RTN","FHORT5",3,0)
ALL ; Print All Reports
"RTN","FHORT5",4,0)
 S FHOPT=1 G A0
"RTN","FHORT5",5,0)
PREP ; Print Preparation Report Only
"RTN","FHORT5",6,0)
 S FHOPT=2 G A0
"RTN","FHORT5",7,0)
COST ; Print Tubefeed Cost Report
"RTN","FHORT5",8,0)
 S FHOPT=3 G A0
"RTN","FHORT5",9,0)
LAB ; Print Tubefeed Labels
"RTN","FHORT5",10,0)
 S FHOPT=4 G A0
"RTN","FHORT5",11,0)
PULL ; Product Pick List
"RTN","FHORT5",12,0)
 S FHOPT=5 G A0
"RTN","FHORT5",13,0)
A0 R !!,"Select C=COMMUNICATION OFFICE or W=WARD: ",FHXX:DTIME G:'$T!("^"[FHXX) KIL I "cw"[FHXX S X=FHXX D TR^FH S FHXX=X
"RTN","FHORT5",14,0)
 I FHXX'?1U!("CW"'[FHXX) W *7,"Enter C or W" G A0
"RTN","FHORT5",15,0)
 I FHXX="C" G A2
"RTN","FHORT5",16,0)
A1 R !!,"Select WARD (or ALL): ",X:DTIME G:'$T!("^"[X) KIL D:X="all" TR^FH I X="ALL" S FHP=0,FHXX="W",WRD=0
"RTN","FHORT5",17,0)
 E  K DIC S DIC="^FH(119.6,",DIC(0)="EQM" D ^DIC G:Y<1 A1 S FHP=+Y,WRD=$P(Y,"^",2)
"RTN","FHORT5",18,0)
 G A3
"RTN","FHORT5",19,0)
A2 S FHP=$O(^FH(119.73,0)) I FHP'<1,$O(^FH(119.73,FHP))<1 G A3
"RTN","FHORT5",20,0)
 R !!,"Select COMMUNICATION OFFICE (or ALL): ",X:DTIME G:'$T!("^"[X) KIL D:X="all" TR^FH I X="ALL" S FHP=0,FHXX="C",WRD=0
"RTN","FHORT5",21,0)
 I X'="ALL" K DIC S DIC="^FH(119.73,",DIC(0)="EMQ" D ^DIC G:Y<1 A2 S FHP=+Y
"RTN","FHORT5",22,0)
A3 S (SUM,MUL)=0 G A5:FHOPT=4,A6:FHP
"RTN","FHORT5",23,0)
A4 R !!,"Consolidated Report Only? Y// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,"  Answer YES or NO" G A4
"RTN","FHORT5",24,0)
 S SUM=X?1"Y".E G A6
"RTN","FHORT5",25,0)
A5 W ! K DIR,LABSTART S DIR(0)="NA^1:10",DIR("A")="If using laser label sheets, what row do you want to begin printing at? ",DIR("B")=1 D ^DIR
"RTN","FHORT5",26,0)
 Q:$D(DIRUT)  S LABSTART=Y
"RTN","FHORT5",27,0)
 R !!,"Do you want multiple labels? N// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="N" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,"  Enter YES or NO" G A5
"RTN","FHORT5",28,0)
 S MUL=X?1"Y".E
"RTN","FHORT5",29,0)
A6 I FHOPT'>2 W !!,"The report requires a 132 column printer.",!
"RTN","FHORT5",30,0)
 W ! K IOP,%ZIS S %ZIS("A")="Select "_$S(FHOPT=4:"LABEL",1:"LIST")_" Printer: ",%ZIS="MQ" D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHORT5",31,0)
 I $D(IO("Q")) S FHPGM="Q1^FHORT5A",FHLST="FHXX^FHOPT^FHP^WRD^SUM^MUL^LABSTART" D EN2^FH G KIL
"RTN","FHORT5",32,0)
 U IO D Q1^FHORT5A D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHORT5",33,0)
KIL K ^TMP($J) G KILL^XUSCLEAN
"RTN","FHORT5D")
0^18^B12076368
"RTN","FHORT5D",1,0)
FHORT5D ; HISC/REL/NCA - Tubefeeding Reports (cont) ;5/4/93  10:52 
"RTN","FHORT5D",2,0)
 ;;5.0;Dietetics;**38,39**;Oct 11, 1995
"RTN","FHORT5D",3,0)
CST ; Print Cost Report for Tubefeeding
"RTN","FHORT5D",4,0)
 S NAM="" F  S NAM=$O(^FH(118.2,"B",NAM)) Q:NAM=""  F LL=0:0 S LL=$O(^FH(118.2,"B",NAM,LL)) Q:LL<1  S ^TMP($J,"P",NAM_"~"_LL)=LL W !,"1) ",NAM,"  ",LL
"RTN","FHORT5D",5,0)
 I SUM S CNOD="0" D C2 Q
"RTN","FHORT5D",6,0)
 S CNOD="0" F  S CNOD=$O(^TMP($J,"C",CNOD)) Q:CNOD=""  D C2
"RTN","FHORT5D",7,0)
 Q
"RTN","FHORT5D",8,0)
C2 S D2=0,NAM="" D HD4 S X0=$G(^TMP($J,"C",CNOD,0))
"RTN","FHORT5D",9,0)
 F  S NAM=$O(^TMP($J,"P",NAM)) Q:NAM=""  S LL=^(NAM) I $D(^TMP($J,"C",CNOD,LL)) S X1=$G(^(LL,0)),TU=$P(X1,"^",1),TP=$P(X1,"^",2) D
"RTN","FHORT5D",10,0)
 .I $Y>(IOSL-8) D HD4
"RTN","FHORT5D",11,0)
 .S Y0=^FH(118.2,LL,0),TU=TU+.95\1,PR=$P($G(^FH(114,+$P(Y0,"^",7),0)),"^",13),D2=TU*PR+D2 W !,"2) ",Y0,"  ",TU,"  ",PR,"  ",D2,!
"RTN","FHORT5D",12,0)
 .W !,$P(Y0,"^",1),?31,$J($S(TP:TP,1:0),5),?41,$P(Y0,"^",2),?53,$J(TU,5),?62,$J(PR,7,2),?72,$J(TU*PR,7,2) Q
"RTN","FHORT5D",13,0)
 W !!,"Total: ",?71,$J(D2,8,2),!!!,"No. of Patients on TF: ",?33,$J($P(X0,"^",1),6)
"RTN","FHORT5D",14,0)
 W !,"No. of Patients on TF and Tray: ",?33,$J($P(X0,"^",2),6),!,"No. of Patients on TF and SF: ",?33,$J($P(X0,"^",3),6)
"RTN","FHORT5D",15,0)
 W !,"No. of Patients on ALL Three: ",?33,$J($P(X0,"^",4),6),!,"Cost/Patient: ",?33 S X=$P(X0,"^",1) W $J($S(X:D2/X,1:""),6,2),! Q
"RTN","FHORT5D",16,0)
LAB ; Print Labels
"RTN","FHORT5D",17,0)
 S LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1 S S1=$S(LAB=1:6,1:9),S2=LAB=2*5+33
"RTN","FHORT5D",18,0)
 S COUNT=0,LINE=1
"RTN","FHORT5D",19,0)
 S TNOD="" F  S TNOD=$O(^TMP($J,"T",TNOD)) Q:TNOD=""  D L1
"RTN","FHORT5D",20,0)
 I LAB>2 D DPLL^FHLABEL Q
"RTN","FHORT5D",21,0)
 W !!!!!!!!!!!!!!!!!! Q
"RTN","FHORT5D",22,0)
L1 S PNOD="" F  S PNOD=$O(^TMP($J,"T",TNOD,PNOD)) Q:PNOD=""  S X0=^(PNOD,0) D L2
"RTN","FHORT5D",23,0)
 Q
"RTN","FHORT5D",24,0)
L2 S NAM=$P(X0,"^",1),WARD=$P(X0,"^",3),RM=$P(X0,"^",4),X3=3
"RTN","FHORT5D",25,0)
 F TF2=0:0 S TF2=$O(^TMP($J,"T",TNOD,PNOD,TF2)) Q:'TF2  S X1=^(TF2,0),X3=X3+3 D L3
"RTN","FHORT5D",26,0)
 Q
"RTN","FHORT5D",27,0)
L3 S Y0=$P(X1,"^",1),STR=$P(X1,"^",7),Y1="" I STR<4 S Y1=$S(STR=1:"1/4",STR=2:"1/2",1:"3/4")_" Str, "
"RTN","FHORT5D",28,0)
 S Y1=Y1_$P(X1,"^",8),Y0=Y0_", "_$S('MUL:$P(X1,"^",6),1:1)_" "_$P(X1,"^",2) I 'MUL,$P(X1,"^",6)>1 S Y0=Y0_"S"
"RTN","FHORT5D",29,0)
 I LAB>2 D LL Q
"RTN","FHORT5D",30,0)
 I 'MUL D LHDR W !,Y0,!,Y1,! W:LAB=2 !!! Q
"RTN","FHORT5D",31,0)
 F X2=1:1:+$P(X1,"^",6) D LHDR W !,Y0,!,Y1,! W:LAB=2 !!!
"RTN","FHORT5D",32,0)
 Q
"RTN","FHORT5D",33,0)
LHDR ; Label Header
"RTN","FHORT5D",34,0)
 W !,NAM,?(S2-$L(WARD)),WARD,!,$P(X0,"^",2),?8,$E(DTP,1,9),?(S2-$L(RM)),RM,! Q
"RTN","FHORT5D",35,0)
HD4 ; Cost Report Header
"RTN","FHORT5D",36,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1
"RTN","FHORT5D",37,0)
 W !,$E(DTP,1,9),?17,"T U B E F E E D I N G   C O S T   R E P O R T",?73,"Page ",PG
"RTN","FHORT5D",38,0)
 S Y=$S(SUM:"CONSOLIDATED",1:$P(CNOD,"~",2)) W !!?(80-$L(Y)\2),Y
"RTN","FHORT5D",39,0)
 W !!,"Product",?30,"# Patient",?41,"Unit",?53,"# Units",?62,"Cost/Unit",?74,"Total",! Q
"RTN","FHORT5D",40,0)
 Q
"RTN","FHORT5D",41,0)
LL ;
"RTN","FHORT5D",42,0)
 S FHCOL=$S(LAB=3:3,1:2)
"RTN","FHORT5D",43,0)
 I LABSTART>1 F FHLABST=1:1:(LABSTART-1)*FHCOL D  S LABSTART=1
"RTN","FHORT5D",44,0)
 .I LAB=3 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6)="" D LL3^FHLABEL
"RTN","FHORT5D",45,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6,PCL7,PCL8)="" D LL4^FHLABEL
"RTN","FHORT5D",46,0)
 .Q
"RTN","FHORT5D",47,0)
 S FHTAB=$S(LAB=3:24,1:37)
"RTN","FHORT5D",48,0)
 S NAM=$E(NAM,1,FHTAB-$L(WARD)),X02P=$P(X0,U,2),DTP=$E(DTP,1,9)
"RTN","FHORT5D",49,0)
 S X0DTP=X02P_$E("        ",1,7-$L(X02P))_DTP
"RTN","FHORT5D",50,0)
 S LNA=NAM_$J(WARD,FHTAB+1-$L(NAM))
"RTN","FHORT5D",51,0)
 S LNB=X0DTP_$J($E(RM,1,8),FHTAB+1-$L(X0DTP))
"RTN","FHORT5D",52,0)
 I 'MUL D LLB Q
"RTN","FHORT5D",53,0)
 I MUL F X2=1:1:+$P(X1,"^",6) D LLB
"RTN","FHORT5D",54,0)
 Q
"RTN","FHORT5D",55,0)
LLB ;
"RTN","FHORT5D",56,0)
 S FHST=$S(LAB=3:25,1:38)
"RTN","FHORT5D",57,0)
 S FHN=FHST F CN=FHST:-1:FHST-5 S Y0X=$E(Y0,CN) I Y0X="," S FHN=CN Q
"RTN","FHORT5D",58,0)
 I LAB=3 S PCL1="",PCL2=LNA,PCL3=LNB,PCL4=$E(Y0,1,FHN),PCL5=$E(Y0,FHN+1,99),PCL6=Y1
"RTN","FHORT5D",59,0)
 I LAB=4 S (PCL1,PCL2,PCL8)="",PCL3=LNA,PCL4=LNB,PCL5=$E(Y0,1,FHN),PCL6=$E(Y0,FHN+1,99),PCL7=Y1
"RTN","FHORT5D",60,0)
 D:LAB=3 LL3^FHLABEL D:LAB=4 LL4^FHLABEL
"RTN","FHORT5D",61,0)
 Q
"RTN","FHORX1")
0^11^B8839307
"RTN","FHORX1",1,0)
FHORX1 ; HISC/REL - Diet Activity Report ;9/10/98  15:31
"RTN","FHORX1",2,0)
 ;;5.0;Dietetics;**19,21,39**;Oct 11, 1995
"RTN","FHORX1",3,0)
 D NOW^%DTC S NOW=%,FHP=$O(^FH(119.73,0)) I FHP'<1,$O(^FH(119.73,FHP))<1 G R1
"RTN","FHORX1",4,0)
R0 R !!,"Select COMMUNICATION OFFICE: ",X:DTIME G:'$T!("^"[X) KIL
"RTN","FHORX1",5,0)
 K DIC S DIC="^FH(119.73,",DIC(0)="EMQ" D ^DIC G:Y<1 R0 S FHP=+Y
"RTN","FHORX1",6,0)
R1 R !!,"Do you want labels? N// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="N" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,"  Enter YES or NO" G R1
"RTN","FHORX1",7,0)
 S LAB=X?1"Y".E,TIM=$P($G(^FH(119.73,FHP,0)),"^",$S(LAB:3,1:2)) I 'TIM S TIM=NOW
"RTN","FHORX1",8,0)
 S FHLBFLG=1 I LAB D  I FHLBFLG=0 Q
"RTN","FHORX1",9,0)
 .W ! K DIR,LABSTART S DIR(0)="NA^1:10",DIR("A")="If using laser label sheets, what row do you want to begin printing at? ",DIR("B")=1 D ^DIR
"RTN","FHORX1",10,0)
 .I $D(DIRUT) S FHLBFLG=0 Q
"RTN","FHORX1",11,0)
 .S LABSTART=Y Q
"RTN","FHORX1",12,0)
 S DTP=TIM D DTP^FH
"RTN","FHORX1",13,0)
R3 W !!,"Changes since Date/Time: ",DTP," // " R X:DTIME G:'$T!(X["^") KIL I X'="" S %DT="EXTS" D ^%DT K %DT G:Y<1 R3 S TIM=Y
"RTN","FHORX1",14,0)
 W ! K IOP,%ZIS S %ZIS("A")="Select "_$S(LAB:"LABEL",1:"LIST")_" Printer: ",%ZIS="MQ" D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHORX1",15,0)
 I $D(IO("Q")) S FHPGM="Q1^FHORX1",FHLST="TIM^LAB^FHP^LABSTART" D EN2^FH G KIL
"RTN","FHORX1",16,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHORX1",17,0)
Q1 ; Print the Diet Activity Report
"RTN","FHORX1",18,0)
 K ^TMP($J) D NOW^%DTC S NOW=%,DTP=TIM,TIM=TIM-.000001 D DTP^FH S H1=DTP_" - " S DTP=NOW D DTP^FH S H1=H1_DTP D ^FHDEV
"RTN","FHORX1",19,0)
 F W1=0:0 S W1=$O(^FH(119.6,W1)) Q:W1<1  D WRD
"RTN","FHORX1",20,0)
 I LAB S LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1
"RTN","FHORX1",21,0)
 F LLL=TIM:0 S LLL=$O(^FH(119.8,"AD",LLL)) Q:LLL<1  F DA=0:0 S DA=$O(^FH(119.8,"AD",LLL,DA)) Q:DA<1  D Q3
"RTN","FHORX1",22,0)
 G ^FHORX1A:'LAB,^FHORX1B
"RTN","FHORX1",23,0)
WRD S P0=$G(^FH(119.6,W1,0)),WRDN=$P(P0,"^",1),D2=$P(P0,"^",8),P0=$P(P0,"^",4),P0=$S(P0<1:99,P0<10:"0"_P0,1:P0)
"RTN","FHORX1",24,0)
 I D2=FHP S ^TMP($J,"W",W1)=P0_"~"_WRDN
"RTN","FHORX1",25,0)
 Q
"RTN","FHORX1",26,0)
Q3 S Z=$G(^FH(119.8,DA,0)) Q:Z=""  S TM1=($P(Z,"^",2)\1),DFN=$P(Z,"^",3),ADM=$P(Z,"^",4) Q:'$D(^FHPT(DFN,"A",ADM,0))
"RTN","FHORX1",27,0)
 S WARD=$G(^DPT(DFN,.1)) G:WARD="" Q5 ; Not an inpatient
"RTN","FHORX1",28,0)
 I $G(^DPT("CN",WARD,DFN))'=ADM Q  ; Not current admission
"RTN","FHORX1",29,0)
 S X0=^FHPT(DFN,"A",ADM,0),W1=+$P(X0,"^",8) I '$D(^TMP($J,"W",W1)) Q  ; Not in this Comm Office
"RTN","FHORX1",30,0)
 S R1=$G(^DPT(DFN,.101))
"RTN","FHORX1",31,0)
 S RI=$G(^DPT(DFN,.108)) S RE=$S(RI:$O(^FH(119.6,"AR",+RI,W1,0)),1:"")
"RTN","FHORX1",32,0)
 S R0=$S(RE:$P($G(^FH(119.6,W1,"R",+RE,0)),"^",2),1:"")
"RTN","FHORX1",33,0)
 S R0=$S(R0<1:99,R0<10:"0"_R0,1:R0)
"RTN","FHORX1",34,0)
 S ^TMP($J,"P",^TMP($J,"W",W1)_"~"_R0_"~"_R1_"~"_DFN,DA)=$P(Z,"^",4,9) Q
"RTN","FHORX1",35,0)
Q5 ; process discharges
"RTN","FHORX1",36,0)
 S W1=+$P(Z,"^",8) Q:'W1  Q:'$D(^TMP($J,"W",W1))
"RTN","FHORX1",37,0)
 S ^TMP($J,"P",^TMP($J,"W",W1)_"~~***~"_DFN,DA)=$P(Z,"^",4,9)
"RTN","FHORX1",38,0)
 Q
"RTN","FHORX1",39,0)
KIL K ^TMP($J) G KILL^XUSCLEAN
"RTN","FHPST39")
0^25^B5363220
"RTN","FHPST39",1,0)
FHPST39 ;Hines OIFO/RTK MULTIDIVISIONAL PATCH 39 POST-INIT  ;6/26/03  7:15
"RTN","FHPST39",2,0)
 ;;5.0;Dietetics;**39**;Oct 11, 1995
"RTN","FHPST39",3,0)
 ;
"RTN","FHPST39",4,0)
 D NEWCO
"RTN","FHPST39",5,0)
 D CONV
"RTN","FHPST39",6,0)
 D CVFH117
"RTN","FHPST39",7,0)
 D CV1157
"RTN","FHPST39",8,0)
 Q
"RTN","FHPST39",9,0)
NEWCO ; Create entry in Communication Office (#119.73) file
"RTN","FHPST39",10,0)
 I $O(^FH(119.73,"B","CONVERTED HISTORICAL DATA","")) Q
"RTN","FHPST39",11,0)
 K DIC,DO S DIC="^FH(119.73,",DIC(0)="L",X="CONVERTED HISTORICAL DATA"
"RTN","FHPST39",12,0)
 D FILE^DICN I Y=-1 Q
"RTN","FHPST39",13,0)
 Q
"RTN","FHPST39",14,0)
 ;
"RTN","FHPST39",15,0)
CONV ; Convert data in Meals Served (#117) file to new C.O.
"RTN","FHPST39",16,0)
 ; Create new multiple with new communication offics
"RTN","FHPST39",17,0)
 ; Convert old 0-Node PCS 2,3,4,5,6,7 to new data 1-Node PCS 1,2,3,4,5,6
"RTN","FHPST39",18,0)
 ; Convert old 1-Node PCS 1-20 to new data 0-Node PCS 2-21
"RTN","FHPST39",19,0)
 W !,"CONVERTING MEALS SERVED FILE..."
"RTN","FHPST39",20,0)
 F FHIEN=0:0 S FHIEN=$O(^FH(117,FHIEN)) Q:FHIEN'>0  D
"RTN","FHPST39",21,0)
 .I $D(^FH(117,FHIEN,2)) Q
"RTN","FHPST39",22,0)
 .I '$D(^FH(117,FHIEN,1)) Q
"RTN","FHPST39",23,0)
 .S FHCONV=$O(^FH(119.73,"B","CONVERTED HISTORICAL DATA",""))
"RTN","FHPST39",24,0)
 .K DIC,DO S DA(1)=FHIEN,DIC="^FH(117,"_DA(1)_",2,"
"RTN","FHPST39",25,0)
 .S DIC(0)="L",DIC("P")=$P(^DD(117,6,0),U,2),X=FHCONV
"RTN","FHPST39",26,0)
 .D FILE^DICN I Y=-1 Q
"RTN","FHPST39",27,0)
 .S FHZN27=$P($G(^FH(117,FHIEN,0)),U,2,7)
"RTN","FHPST39",28,0)
 .S ^FH(117,FHIEN,2,1,1)=FHZN27
"RTN","FHPST39",29,0)
 .S FHON120=$P($G(^FH(117,FHIEN,1)),U,1,20)
"RTN","FHPST39",30,0)
 .S ^FH(117,FHIEN,2,1,0)=$P($G(^FH(117,FHIEN,2,1,0)),U,1)_"^"_FHON120
"RTN","FHPST39",31,0)
 .Q
"RTN","FHPST39",32,0)
 Q
"RTN","FHPST39",33,0)
 ;
"RTN","FHPST39",34,0)
CVFH117 ;Convert Staffing (FH117.1) File to accomodate Communication Office entries
"RTN","FHPST39",35,0)
 ;Convert new multiple with communication office
"RTN","FHPST39",36,0)
 ;Create sub-entires for node 1 based on Communication Office codes.
"RTN","FHPST39",37,0)
 ;Add Communications Office entry to pc20, node 1
"RTN","FHPST39",38,0)
 W !,"CONVERTING STAFFING DATA FILE..."
"RTN","FHPST39",39,0)
 F FHIEN=0:0 S FHIEN=$O(^FH(117.1,FHIEN)) Q:FHIEN'>0  D
"RTN","FHPST39",40,0)
 .I '$D(^FH(117.1,FHIEN,0)) Q
"RTN","FHPST39",41,0)
 .I $D(^FH(117.1,FHIEN,1)) Q
"RTN","FHPST39",42,0)
 .S FHCONV=$O(^FH(119.73,"B","CONVERTED HISTORICAL DATA",""))
"RTN","FHPST39",43,0)
 .K DIC,DO S DA(1)=FHIEN,DIC="^FH(117.1,"_DA(1)_",1,"
"RTN","FHPST39",44,0)
 .S DIC(0)="L",DIC("P")=$P(^DD(117.1,20,0),U,2),X=FHCONV
"RTN","FHPST39",45,0)
 .D FILE^DICN I Y=-1 Q
"RTN","FHPST39",46,0)
 .S FHZN221=$P($G(^FH(117.1,FHIEN,0)),U,2,20)
"RTN","FHPST39",47,0)
 .S ^FH(117.1,FHIEN,1,1,0)=$P($G(^FH(117.1,FHIEN,1,1,0)),U,1)_"^"_FHZN221
"RTN","FHPST39",48,0)
 .Q
"RTN","FHPST39",49,0)
 Q
"RTN","FHPST39",50,0)
 ;
"RTN","FHPST39",51,0)
CV1157 ;CONVERT FILE FH115.7
"RTN","FHPST39",52,0)
 ;Add Communication Office to zero node, piece 6
"RTN","FHPST39",53,0)
 ;No Communication Office entry prior to multidivisional report modifications.
"RTN","FHPST39",54,0)
 ;
"RTN","FHPST39",55,0)
 W !,"CONVERTING DIETETIC ENCOUNTERS FILE..."
"RTN","FHPST39",56,0)
 S FHCONV=$O(^FH(119.73,"B","CONVERTED HISTORICAL DATA",""))
"RTN","FHPST39",57,0)
 F NUM=0:0 S NUM=$O(^FHEN(NUM)) Q:NUM'>0  D
"RTN","FHPST39",58,0)
 .I '$D(^FHEN(NUM,0)) Q
"RTN","FHPST39",59,0)
 .I $P($G(^FHEN(NUM,0)),"^",6)="" S ^FHEN("CO",FHCONV,NUM)="" S $P(^FHEN(NUM,0),"^",6)=FHCONV
"RTN","FHPST39",60,0)
 .Q
"RTN","FHPST39",61,0)
 W !,"CONVERSION COMPLETED."
"RTN","FHPST39",62,0)
 Q
"RTN","FHSP1")
0^16^B24580040
"RTN","FHSP1",1,0)
FHSP1 ; HISC/NCA - Consolidated Standing Orders List ;7/28/94  12:59 
"RTN","FHSP1",2,0)
 ;;5.0;Dietetics;**38,39**;Oct 11, 1995
"RTN","FHSP1",3,0)
E1 ; Set Consolidated List flag
"RTN","FHSP1",4,0)
 S FHOPT=1 G E3
"RTN","FHSP1",5,0)
E2 ; Set Label flag
"RTN","FHSP1",6,0)
 S FHOPT=2
"RTN","FHSP1",7,0)
E3 S FHP=$O(^FH(119.72,0)) I FHP'<1,$O(^FH(119.72,FHP))<1 G D2
"RTN","FHSP1",8,0)
D0 R !!,"Select SERVICE POINT (or ALL): ",X:DTIME G:'$T!("^"[X) KIL D:X="all" TR^FH I X="ALL" S FHP=0
"RTN","FHSP1",9,0)
 E  K DIC S DIC="^FH(119.72,",DIC(0)="EMQ" D ^DIC G:Y<1 D0 S FHP=+Y
"RTN","FHSP1",10,0)
D2 R !!,"Select Meal (B,N,E,or ALL): ",MEAL:DTIME G:'$T!(U[MEAL) KIL S X=MEAL D TR^FH S MEAL=X S:$P("ALL",MEAL,1)="" MEAL="A"
"RTN","FHSP1",11,0)
 I "BNEA"'[MEAL!(MEAL'?1U) W *7,!,"Enter B for Breakfast, N for Noon, E for Evening or ALL for all meals" G D2
"RTN","FHSP1",12,0)
 S D3="" G:FHOPT=2 D5
"RTN","FHSP1",13,0)
D3 R !!,"Consolidated List Only? Y//",X:DTIME G:'$T!(X="^") KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,"  Answer YES or NO" G D3
"RTN","FHSP1",14,0)
 S X=$E(X,1),D3=1 S:X="Y" D3=D3+1
"RTN","FHSP1",15,0)
D5 W ! K DIR,LABSTART S DIR(0)="NA^1:10",DIR("A")="If using laser label sheets, what row do you want to begin printing at? ",DIR("B")=1 D ^DIR
"RTN","FHSP1",16,0)
 Q:$D(DIRUT)  S LABSTART=Y
"RTN","FHSP1",17,0)
 W:'D3 !!,"Place Labels in Printer"
"RTN","FHSP1",18,0)
PR K IOP S %ZIS="MQ",%ZIS("A")="Select "_$S('D3:"LABEL",1:"LIST")_" Printer: " W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHSP1",19,0)
 I $D(IO("Q")) S FHPGM="Q1^FHSP1",FHLST="D3^FHOPT^FHP^MEAL^LABSTART" D EN2^FH G KIL
"RTN","FHSP1",20,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHSP1",21,0)
Q1 ; Print Standing Orders List or Labels
"RTN","FHSP1",22,0)
 K ^TMP($J),C,D,N S (CHK,N1,PG)=0 D NOW^%DTC S NOW=%,DT=%\1
"RTN","FHSP1",23,0)
 S COUNT=0,LINE=1,DTP=NOW D DTP^FH S DTR=DTP
"RTN","FHSP1",24,0)
 I FHOPT=2 S LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1
"RTN","FHSP1",25,0)
 I MEAL="A" S MEAL="B" D Q2 S MEAL="N" D Q2 S MEAL="E"
"RTN","FHSP1",26,0)
 D Q2
"RTN","FHSP1",27,0)
 I $G(LAB)>2 D DPLL^FHLABEL Q
"RTN","FHSP1",28,0)
 F L=1:1:$S('D3:18,1:1) W !
"RTN","FHSP1",29,0)
 Q
"RTN","FHSP1",30,0)
Q2 S T0=NOW\1_$S(MEAL="B":".07",MEAL="N":".11",1:".17"),TT=0
"RTN","FHSP1",31,0)
 F W1=0:0 S W1=$O(^FH(119.6,W1)) Q:W1<1  D DP I DP'="" D P0 F DFN=0:0 S DFN=$O(^FHPT("AW",W1,DFN)) Q:DFN<1  S ADM=^(DFN) D ADD
"RTN","FHSP1",32,0)
 G:FHOPT=2 ^FHSP11
"RTN","FHSP1",33,0)
 S DTP=DT D DTP^FH S DTE=DTP_" "_$S(MEAL="B":"Break",MEAL="N":"Noon",1:"Even")
"RTN","FHSP1",34,0)
 G:D3=2 CON
"RTN","FHSP1",35,0)
 K S F K=0:0 S K=$O(D(K)) Q:K=""  S X=$G(^FH(119.72,K,0)),N2=$P(X,"^",1),N3=$P(X,"^",4) S:N3="" N3=$E(N2,1,6) S S(N3,K)=$E(N3,1,6)
"RTN","FHSP1",36,0)
 S A1="" F  S A1=$O(S(A1)) Q:A1=""  F K=0:0 S K=$O(S(A1,K)) Q:K=""  S N2=$G(S(A1,K)) D LST
"RTN","FHSP1",37,0)
 K C,D,N Q
"RTN","FHSP1",38,0)
ADD Q:ADM<1
"RTN","FHSP1",39,0)
 D CHK I K2 F K2=0:0 S K2=$O(^FHPT("ASP",DFN,ADM,K2)) Q:K2<1  S Y=^FHPT(DFN,"A",ADM,"SP",K2,0) D A1
"RTN","FHSP1",40,0)
 Q
"RTN","FHSP1",41,0)
A1 S Y=$P(Y,"^",2,3)_"^"_$P(Y,"^",8) Q:Y?."^"  I FHOPT=2 S Y=Y_"^"_IS,RM=$G(^DPT(DFN,.101)),WRD=P0_$E(WRDN,1,27-$L(RM))_"/"_RM,^TMP($J,"SOL",SP,WRD,DFN,K2)=Y Q
"RTN","FHSP1",42,0)
 S FHORD=$P(Y,"^",1),M1=$P(Y,"^",2)
"RTN","FHSP1",43,0)
 I FHORD,M1[MEAL S:'$D(N(FHORD,SP)) N(FHORD,SP)=0 S Q=$P(Y,"^",3),N(FHORD,SP)=N(FHORD,SP)+$S(Q:Q,1:1) S:'$D(C(MEAL,SP)) C(MEAL,SP)=0 I TT'=DFN S C(MEAL,SP)=C(MEAL,SP)+1,TT=DFN
"RTN","FHSP1",44,0)
 Q
"RTN","FHSP1",45,0)
CHK S K2=0,X1=$G(^FHPT(DFN,"A",ADM,0)),FHORD=$P(X1,"^",2),IS=$P(X1,"^",10),X1=$P(X1,"^",3) G:FHORD<1 C1
"RTN","FHSP1",46,0)
 I IS S IS=$P($G(^FH(119.4,IS,0)),"^",3) S:IS'="N" IS=""
"RTN","FHSP1",47,0)
 I X1>1,X1'>T0 G C2
"RTN","FHSP1",48,0)
C0 I '$D(^FHPT(DFN,"A",ADM,"DI",FHORD,0)) G C2
"RTN","FHSP1",49,0)
 S X1=$P(^FHPT(DFN,"A",ADM,"DI",FHORD,0),"^",8) I X1="" G C1
"RTN","FHSP1",50,0)
 S:X1="D" X1="T" Q:'$D(S(X1))  S:DP[X1 K2=1 S:K2 SP=S(X1)
"RTN","FHSP1",51,0)
C1 K FHORD,A1,K,X1 Q
"RTN","FHSP1",52,0)
C2 S A1=0 F K=0:0 S K=$O(^FHPT(DFN,"A",ADM,"AC",K)) Q:K<1!(K>T0)  S A1=K
"RTN","FHSP1",53,0)
 G:'A1 C1 S FHORD=$P(^FHPT(DFN,"A",ADM,"AC",A1,0),"^",2) G:FHORD'<1 C0 K ^FHPT(DFN,"A",ADM,"AC",A1) G C2
"RTN","FHSP1",54,0)
DP K S S DP=""
"RTN","FHSP1",55,0)
 F L=5,6 S X=$P($G(^FH(119.6,W1,0)),"^",L) I X=FHP!('FHP) S:X S($E("TC",L-4))=X,D(X)="",DP=DP_$E("TC",L-4)
"RTN","FHSP1",56,0)
 Q
"RTN","FHSP1",57,0)
P0 S X=^FH(119.6,W1,0),P0=$P(X,"^",4),P0=$S(P0<1:99,P0<10:"0"_P0,1:P0),WRDN=$P(X,"^",1) Q
"RTN","FHSP1",58,0)
LST D HDR1 S NX="" F  S NX=$O(^FH(118.3,"B",NX)) Q:NX=""  F KK=0:0 S KK=$O(^FH(118.3,"B",NX,KK)) Q:KK<1  S Z=$G(N(KK,K)) D:$Y>(IOSL-6) HDR1 I Z W !?(80-30\2),$J(Z,6)," ",$P(^FH(118.3,KK,0),"^",1)
"RTN","FHSP1",59,0)
 S N1=N1+$G(C(MEAL,K))
"RTN","FHSP1",60,0)
 D PP S N1=0 Q
"RTN","FHSP1",61,0)
CON K S S L1=36
"RTN","FHSP1",62,0)
 F K=0:0 S K=$O(D(K)) Q:K=""  S X=^FH(119.72,K,0),N2=$P(X,"^",1),N3=$P(X,"^",4) S:N3="" N3=$E(N2,1,6) S S(N3,K)=$J(N3,8),L1=L1+8
"RTN","FHSP1",63,0)
 S:L1<80 L1=80 D HDR
"RTN","FHSP1",64,0)
 S NX="" F  S NX=$O(^FH(118.3,"B",NX)) Q:NX=""  F KK=0:0 S KK=$O(^FH(118.3,"B",NX,KK)) Q:KK<1  I $D(N(KK)) D SOR
"RTN","FHSP1",65,0)
 W !!,"# OF PATIENTS",?31
"RTN","FHSP1",66,0)
 S X="" F  S X=$O(S(X)) Q:X=""  F K=0:0 S K=$O(S(X,K)) Q:K=""  S Z=$G(C(MEAL,K)) W $S(Z:$J(Z,6),1:$J("",6)),"  " S N1=N1+Z
"RTN","FHSP1",67,0)
 W $S(N1:$J(N1,6),1:$J("",6))
"RTN","FHSP1",68,0)
 S N1=0 K C,D,N Q
"RTN","FHSP1",69,0)
SOR D:$Y>(IOSL-6) HDR
"RTN","FHSP1",70,0)
 W !,$P($G(^FH(118.3,KK,0)),"^",1),?31
"RTN","FHSP1",71,0)
 S Z1=0,X="" F  S X=$O(S(X)) Q:X=""  F K=0:0 S K=$O(S(X,K)) Q:K=""  S Z=$G(N(KK,K)) W $S(Z:$J(Z,6),1:$J("",6)),"  " S Z1=Z1+Z
"RTN","FHSP1",72,0)
 W $S(Z1:$J(Z1,6),1:$J("",6))
"RTN","FHSP1",73,0)
 Q
"RTN","FHSP1",74,0)
PP W !!?(80-21\2),"**** PATIENTS = ",N1," ****",! Q
"RTN","FHSP1",75,0)
HDR ; Header for Consolidated List
"RTN","FHSP1",76,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1
"RTN","FHSP1",77,0)
 W !,DTR,?(L1-11),"Page ",PG,!!?(L1-55\2),"C O N S O L I D A T E D   S T A N D I N G   O R D E R S",!!?(L1-$L(DTE)\2),DTE,!!?29
"RTN","FHSP1",78,0)
 S X="" F  S X=$O(S(X)) Q:X=""  F K=0:0 S K=$O(S(X,K)) Q:K=""  W S(X,K)
"RTN","FHSP1",79,0)
 W "   TOTAL",! Q
"RTN","FHSP1",80,0)
HDR1 ; Header for Standing Order List
"RTN","FHSP1",81,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !,DTR,?69,"Page ",PG,!!?20,"S T A N D I N G   O R D E R S   L I S T"
"RTN","FHSP1",82,0)
 W !?(80-$L(N2)\2),N2,!?(80-$L(DTE)\2),DTE,! Q
"RTN","FHSP1",83,0)
KIL K ^TMP($J) G KILL^XUSCLEAN
"RTN","FHSP11")
0^9^B6033875
"RTN","FHSP11",1,0)
FHSP11 ; HISC/NCA,RTK - Print Standing Orders Labels ;2/26/96  09:59
"RTN","FHSP11",2,0)
 ;;5.0;Dietetics;**2,38,39**;Mar 25, 1996
"RTN","FHSP11",3,0)
 K ^TMP($J,"NAME") F NX=0:0 S NX=$O(^FH(118.3,NX)) Q:NX<1  S Y=^(NX,0),N1=$P(Y,"^",1) I '$D(^FH(118.3,NX,"I")) S ^TMP($J,"NAME",NX)=$P(Y,"^",1)
"RTN","FHSP11",4,0)
 D P1
"RTN","FHSP11",5,0)
 Q
"RTN","FHSP11",6,0)
P1 S DTP=DT D DTP^FH S DTE=DTP_" "_$S(MEAL="B":"BREAK",MEAL="N":"NOON",1:"EVEN"),S1=$S(LAB=1:6,1:9),S2=LAB=2*5+33
"RTN","FHSP11",7,0)
 F SP=0:0 S SP=$O(^TMP($J,"SOL",SP)) Q:SP<1  D P2
"RTN","FHSP11",8,0)
 Q
"RTN","FHSP11",9,0)
P2 S WRD="" F  S WRD=$O(^TMP($J,"SOL",SP,WRD)) Q:WRD=""  D P3
"RTN","FHSP11",10,0)
 Q
"RTN","FHSP11",11,0)
P3 F DFN=0:0 S DFN=$O(^TMP($J,"SOL",SP,WRD,DFN)) Q:DFN<1  D PID^FHDPA,P4
"RTN","FHSP11",12,0)
 Q
"RTN","FHSP11",13,0)
P4 F FHL=0:0 S FHL=$O(^TMP($J,"SOL",SP,WRD,DFN,FHL)) Q:FHL<1  D P5
"RTN","FHSP11",14,0)
 Q
"RTN","FHSP11",15,0)
P5 S Y=^(FHL)
"RTN","FHSP11",16,0)
 S IS=$P(Y,"^",4),FHORD=$P(Y,"^",1) Q:'FHORD  S M1=$P(Y,"^",2) Q:M1'[MEAL  S Q=$P(Y,"^",3) S:'Q Q=1
"RTN","FHSP11",17,0)
 Q:$P($G(^FH(118.3,+FHORD,0)),"^",2)'="Y"  S NAM=$P(^DPT(DFN,0),"^",1)
"RTN","FHSP11",18,0)
 I LAB>2 D LL Q
"RTN","FHSP11",19,0)
 W !,$E(NAM,1,S2-$L(WRD)),?(S2+2-$L(WRD)),$E(WRD,3,99),!?$S(LAB=1:3,1:0),BID W:IS'="" ?(S2-22),"*NURSE" W ?(S2-15),DTE S LN=2 I LAB=2 W !! S LN=4
"RTN","FHSP11",20,0)
 W !,$J(Q,2)," ",$S($D(^TMP($J,"NAME",FHORD)):$P(^TMP($J,"NAME",FHORD),"^",1),$D(^FH(118.3,+FHORD,0)):$P(^(0),"^",1),1:"") S LN=LN+1
"RTN","FHSP11",21,0)
 I LN<S1 F L=LN+1:1:S1 W !
"RTN","FHSP11",22,0)
 Q
"RTN","FHSP11",23,0)
LL ;
"RTN","FHSP11",24,0)
 S FHCOL=$S(LAB=3:3,1:2)
"RTN","FHSP11",25,0)
 I LABSTART>1 F FHLABST=1:1:(LABSTART-1)*FHCOL D  S LABSTART=1
"RTN","FHSP11",26,0)
 .I LAB=3 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6)="" D LL3^FHLABEL
"RTN","FHSP11",27,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6,PCL7,PCL8)="" D LL4^FHLABEL
"RTN","FHSP11",28,0)
 .Q
"RTN","FHSP11",29,0)
 S FHTAB=$S(LAB=3:24,1:37)
"RTN","FHSP11",30,0)
 S WRD1=$E(WRD,3,99)
"RTN","FHSP11",31,0)
 S NAM=$E(NAM,1,FHTAB-$L(WRD1)),BIDIS=BID I IS="N" S BIDIS=BID_" *NURSE"
"RTN","FHSP11",32,0)
 S LNA=NAM_$J(WRD1,FHTAB+1-$L(NAM)),LNB=BIDIS_$J(DTE,FHTAB+1-$L(BIDIS))
"RTN","FHSP11",33,0)
 S LNC=$J(Q,2)_" "_$P($G(^FH(118.3,+FHORD,0)),U,1)
"RTN","FHSP11",34,0)
 I LAB=3 S (PCL1,PCL4,PCL6)="",PCL2=LNA,PCL3=LNB,PCL5=LNC
"RTN","FHSP11",35,0)
 I LAB=4 S (PCL1,PCL2,PCL5,PCL7,PCL8)="",PCL3=LNA,PCL4=LNB,PCL6=LNC
"RTN","FHSP11",36,0)
 D:LAB=3 LL3^FHLABEL D:LAB=4 LL4^FHLABEL
"RTN","FHSP11",37,0)
 Q
"SEC","^DIC",115.7,115.7,0,"DD")
#
"SEC","^DIC",115.7,115.7,0,"DEL")
#f
"SEC","^DIC",115.7,115.7,0,"LAYGO")
#f
"SEC","^DIC",115.7,115.7,0,"RD")
#F
"SEC","^DIC",115.7,115.7,0,"WR")
#f
"SEC","^DIC",117,117,0,"AUDIT")

"SEC","^DIC",117,117,0,"DD")
#
"SEC","^DIC",117,117,0,"DEL")
#F
"SEC","^DIC",117,117,0,"LAYGO")
#F
"SEC","^DIC",117,117,0,"RD")
#F
"SEC","^DIC",117,117,0,"WR")
#F
"SEC","^DIC",117.1,117.1,0,"AUDIT")
@
"SEC","^DIC",117.1,117.1,0,"DD")
#
"SEC","^DIC",117.1,117.1,0,"DEL")
#F
"SEC","^DIC",117.1,117.1,0,"LAYGO")
#F
"SEC","^DIC",117.1,117.1,0,"RD")
#F
"SEC","^DIC",117.1,117.1,0,"WR")
#F
"VER")
8.0^22
"^DD",115.7,115.7,0)
FIELD^^11^16
"^DD",115.7,115.7,0,"DDA")
N
"^DD",115.7,115.7,0,"DT")
3030602
"^DD",115.7,115.7,0,"IX","AP",115.701,.01)

"^DD",115.7,115.7,0,"IX","AT",115.7,1)

"^DD",115.7,115.7,0,"IX","B",115.7,.01)

"^DD",115.7,115.7,0,"IX","CO",115.7,11)

"^DD",115.7,115.7,0,"NM","DIETETIC ENCOUNTERS")

"^DD",115.7,115.7,0,"VRPK")
FH
"^DD",115.7,115.7,.01,0)
NUMBER^RNJ9,0X^^0;1^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X I $D(X) S DINUM=X
"^DD",115.7,115.7,.01,1,0)
^.1
"^DD",115.7,115.7,.01,1,1,0)
115.7^B
"^DD",115.7,115.7,.01,1,1,1)
S ^FHEN("B",$E(X,1,30),DA)=""
"^DD",115.7,115.7,.01,1,1,2)
K ^FHEN("B",$E(X,1,30),DA)
"^DD",115.7,115.7,.01,1,1,"%D",0)
^^1^1^2931221^^
"^DD",115.7,115.7,.01,1,1,"%D",1,0)
This is the normal B cross-reference of the NUMBER field.
"^DD",115.7,115.7,.01,3)
Type a Number between 1 and 999999999, 0 Decimal Digits
"^DD",115.7,115.7,.01,21,0)
^^2^2^2891121^
"^DD",115.7,115.7,.01,21,1,0)
This field contains a sequential number assigned to the encounter
"^DD",115.7,115.7,.01,21,2,0)
and has no meaning.
"^DD",115.7,115.7,.01,"DT")
2890719
"^DD",115.7,115.7,1,0)
DATE/TIME OF ENCOUNTER^RD^^0;2^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
"^DD",115.7,115.7,1,1,0)
^.1
"^DD",115.7,115.7,1,1,1,0)
115.7^AT
"^DD",115.7,115.7,1,1,1,1)
S ^FHEN("AT",$E(X,1,30),DA)=""
"^DD",115.7,115.7,1,1,1,2)
K ^FHEN("AT",$E(X,1,30),DA)
"^DD",115.7,115.7,1,3)

"^DD",115.7,115.7,1,21,0)
^.001^2^2^3030602^^^
"^DD",115.7,115.7,1,21,1,0)
This field contains the date and time at which the dietetic encounter
"^DD",115.7,115.7,1,21,2,0)
took place.
"^DD",115.7,115.7,1,"DT")
2911016
"^DD",115.7,115.7,2,0)
CLINICIAN^RP200'^VA(200,^0;3^Q
"^DD",115.7,115.7,2,21,0)
^^2^2^2891120^
"^DD",115.7,115.7,2,21,1,0)
This field contains a pointer to the clinician who provided the
"^DD",115.7,115.7,2,21,2,0)
service during the encounter.
"^DD",115.7,115.7,2,"DT")
2890719
"^DD",115.7,115.7,3,0)
ENCOUNTER TYPE^RP115.6'^FH(115.6,^0;4^Q
"^DD",115.7,115.7,3,21,0)
^^2^2^2920716^^
"^DD",115.7,115.7,3,21,1,0)
This field contains a pointer to the Encounter Type file (115.6)
"^DD",115.7,115.7,3,21,2,0)
indicating the type of encounter.
"^DD",115.7,115.7,3,"DT")
2920716
"^DD",115.7,115.7,4,0)
EVENT LOCATION^P44'^SC(^0;5^Q
"^DD",115.7,115.7,4,21,0)
^^2^2^2891120^
"^DD",115.7,115.7,4,21,1,0)
This optional field contains a pointer to the Hospital Location
"^DD",115.7,115.7,4,21,2,0)
file (44) indicating where the encounter took place.
"^DD",115.7,115.7,4,"DT")
2891107
"^DD",115.7,115.7,5,0)
INITIAL/FOLLOWUP^S^I:INITIAL;F:FOLLOWUP;^0;7^Q
"^DD",115.7,115.7,5,21,0)
^^2^2^2920421^^
"^DD",115.7,115.7,5,21,1,0)
This field indicates whether the encounter was an initial one
"^DD",115.7,115.7,5,21,2,0)
of this type or a follow-up.
"^DD",115.7,115.7,5,"DT")
2890719
"^DD",115.7,115.7,6,0)
TIME UNITS^NJ3,0^^0;8^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",115.7,115.7,6,3)
Type a Number between 1 and 999, 0 Decimal Digits
"^DD",115.7,115.7,6,21,0)
^^2^2^2891120^
"^DD",115.7,115.7,6,21,1,0)
This field contains the number of time units earned by this
"^DD",115.7,115.7,6,21,2,0)
encounter.
"^DD",115.7,115.7,6,"DT")
2890719
"^DD",115.7,115.7,7,0)
GROUP/INDIVIDUAL^S^G:GROUP;I:INDIVIDUAL;^0;9^Q
"^DD",115.7,115.7,7,21,0)
^^2^2^2891120^
"^DD",115.7,115.7,7,21,1,0)
This field indicates whether the encounter was a group one or
"^DD",115.7,115.7,7,21,2,0)
an encounter with a single individual.
"^DD",115.7,115.7,7,"DT")
2890719
"^DD",115.7,115.7,8,0)
GROUP SIZE^NJ4,0^^0;10^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",115.7,115.7,8,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",115.7,115.7,8,21,0)
^^2^2^2891120^
"^DD",115.7,115.7,8,21,1,0)
This field contains the total number of persons involved,
"^DD",115.7,115.7,8,21,2,0)
including any collaterals.
"^DD",115.7,115.7,8,"DT")
2890719
"^DD",115.7,115.7,10,0)
EVENT COMMENT^F^^0;11^K:$L(X)>60!($L(X)<3) X
"^DD",115.7,115.7,10,3)
Answer must be 3-60 characters in length.
"^DD",115.7,115.7,10,21,0)
^^1^1^2891120^
"^DD",115.7,115.7,10,21,1,0)
This field may contain a short comment concerning the event.
"^DD",115.7,115.7,10,"DT")
2891107
"^DD",115.7,115.7,11,0)
COMMUNICATIONS OFFICE^RP119.73'^FH(119.73,^0;6^Q
"^DD",115.7,115.7,11,1,0)
^.1
"^DD",115.7,115.7,11,1,1,0)
115.7^CO
"^DD",115.7,115.7,11,1,1,1)
S ^FHEN("CO",$E(X,1,30),DA)=""
"^DD",115.7,115.7,11,1,1,2)
K ^FHEN("CO",$E(X,1,30),DA)
"^DD",115.7,115.7,11,1,1,"%D",0)
^^1^1^3030318^
"^DD",115.7,115.7,11,1,1,"%D",1,0)
Used to print encounters within Communications Offices
"^DD",115.7,115.7,11,1,1,"DT")
3030318
"^DD",115.7,115.7,11,3)
Communications Office is a required entry
"^DD",115.7,115.7,11,"DT")
3030602
"^DD",115.7,115.7,20,0)
PATIENT^115.701PA^^P;0
"^DD",115.7,115.7,20,21,0)
^^2^2^2910813^^
"^DD",115.7,115.7,20,21,1,0)
This field is a multiple containing data relating to patients
"^DD",115.7,115.7,20,21,2,0)
involved in the encounter.
"^DD",115.7,115.7,101,0)
ENTERING CLERK^RP200'^VA(200,^0;13^Q
"^DD",115.7,115.7,101,21,0)
^^2^2^2891121^
"^DD",115.7,115.7,101,21,1,0)
This field is a pointer indicating the person making the
"^DD",115.7,115.7,101,21,2,0)
encounter entry.
"^DD",115.7,115.7,101,"DT")
2891108
"^DD",115.7,115.7,102,0)
DATE/TIME ENTERED^RD^^0;14^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
"^DD",115.7,115.7,102,21,0)
^^2^2^2891121^
"^DD",115.7,115.7,102,21,1,0)
This field contains the date/time the encounter was actually
"^DD",115.7,115.7,102,21,2,0)
entered.
"^DD",115.7,115.7,102,"DT")
2891108
"^DD",115.7,115.7,103,0)
LAST REVIEW DATE/TIME^D^^0;15^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",115.7,115.7,103,21,0)
^^1^1^2960716^^
"^DD",115.7,115.7,103,21,1,0)
This is the date/time that the encounter was last reviewed.
"^DD",115.7,115.7,103,"DT")
2960716
"^DD",115.7,115.7,104,0)
REVIEW CLERK^P200'^VA(200,^0;16^Q
"^DD",115.7,115.7,104,21,0)
^^1^1^2960716^
"^DD",115.7,115.7,104,21,1,0)
This is a pointer to File 200 of the person entering the review.
"^DD",115.7,115.7,104,"DT")
2960716
"^DD",115.7,115.701,0)
PATIENT SUB-FIELD^^3^4
"^DD",115.7,115.701,0,"IX","B",115.701,.01)

"^DD",115.7,115.701,0,"NM","PATIENT")

"^DD",115.7,115.701,0,"UP")
115.7
"^DD",115.7,115.701,.01,0)
PATIENT^MP2'X^DPT(^0;1^I $D(X) S DINUM=X
"^DD",115.7,115.701,.01,1,0)
^.1
"^DD",115.7,115.701,.01,1,1,0)
115.701^B
"^DD",115.7,115.701,.01,1,1,1)
S ^FHEN(DA(1),"P","B",$E(X,1,30),DA)=""
"^DD",115.7,115.701,.01,1,1,2)
K ^FHEN(DA(1),"P","B",$E(X,1,30),DA)
"^DD",115.7,115.701,.01,1,1,"%D",0)
^^1^1^2911118^
"^DD",115.7,115.701,.01,1,1,"%D",1,0)
This is the normal B cross-reference of the PATIENT field.
"^DD",115.7,115.701,.01,1,2,0)
115.7^AP^MUMPS
"^DD",115.7,115.701,.01,1,2,1)
S X1=$P(^FHEN(DA(1),0),"^",2) S:X1 ^FHEN("AP",X,X1,DA(1))=""
"^DD",115.7,115.701,.01,1,2,2)
S X1=$P(^FHEN(DA(1),0),"^",2) K:X1 ^FHEN("AP",X,X1,DA(1))
"^DD",115.7,115.701,.01,1,2,"%D",0)
2^^2^2^2940824^
"^DD",115.7,115.701,.01,1,2,"%D",1,0)
This cross-reference creates an 'AP' node of a patient by date/time
"^DD",115.7,115.701,.01,1,2,"%D",2,0)
cross-reference.
"^DD",115.7,115.701,.01,21,0)
^^2^2^2910813^^
"^DD",115.7,115.701,.01,21,1,0)
This field contains a pointer to the Patient file (2) and indicates
"^DD",115.7,115.701,.01,21,2,0)
a patient involved in the encounter.
"^DD",115.7,115.701,.01,"DT")
2891113
"^DD",115.7,115.701,1,0)
LOCATION^P44'^SC(^0;2^Q
"^DD",115.7,115.701,1,21,0)
^^3^3^2891121^
"^DD",115.7,115.701,1,21,1,0)
This field contains a pointer to the Hospital Location
"^DD",115.7,115.701,1,21,2,0)
(file 44) for the patient. It is the patient location rather
"^DD",115.7,115.701,1,21,3,0)
than the event location.
"^DD",115.7,115.701,1,"DT")
2890719
"^DD",115.7,115.701,2,0)
# COLLATERALS^NJ1,0^^0;3^K:+X'=X!(X>9)!(X<0)!(X?.E1"."1N.N) X
"^DD",115.7,115.701,2,3)
Type a Number between 0 and 9, 0 Decimal Digits
"^DD",115.7,115.701,2,21,0)
^^2^2^2891121^
"^DD",115.7,115.701,2,21,1,0)
This field contains the number of collaterals seen with the
"^DD",115.7,115.701,2,21,2,0)
patient.
"^DD",115.7,115.701,2,"DT")
2891107
"^DD",115.7,115.701,3,0)
PATIENT COMMENT^F^^0;4^K:$L(X)>60!($L(X)<3) X
"^DD",115.7,115.701,3,3)
Answer must be 3-60 characters in length.
"^DD",115.7,115.701,3,21,0)
^^2^2^2891121^
"^DD",115.7,115.701,3,21,1,0)
This field may be used for a patient-specific comment
"^DD",115.7,115.701,3,21,2,0)
concerning the encounter.
"^DD",115.7,115.701,3,"DT")
2891107
"^DD",117,117,0)
FIELD^^8^35
"^DD",117,117,0,"DDA")
N
"^DD",117,117,0,"DT")
3030424
"^DD",117,117,0,"IX","B",117,.01)

"^DD",117,117,0,"NM","MEALS SERVED")

"^DD",117,117,.01,0)
CENSUS DATE^RDX^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",117,117,.01,1,0)
^.1
"^DD",117,117,.01,1,1,0)
117^B
"^DD",117,117,.01,1,1,1)
S ^FH(117,"B",$E(X,1,30),DA)=""
"^DD",117,117,.01,1,1,2)
K ^FH(117,"B",$E(X,1,30),DA)
"^DD",117,117,.01,1,1,"%D",0)
^^1^1^2911118^
"^DD",117,117,.01,1,1,"%D",1,0)
This is the normal B cross-reference of the CENSUS DATE field.
"^DD",117,117,.01,3)

"^DD",117,117,.01,21,0)
^.001^2^2^3030225^^
"^DD",117,117,.01,21,1,0)
This is the date for which various dietetic census and performance
"^DD",117,117,.01,21,2,0)
standards data are entered.
"^DD",117,117,.01,"DT")
3030128
"^DD",117,117,1,0)
DOM MEMBERS^NJ4,0^^0;2^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,1,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,1,21,0)
^.001^2^2^3030424^^^
"^DD",117,117,1,21,1,0)
This field contains the number of Domiciliary members shown by MAS
"^DD",117,117,1,21,2,0)
as being admitted patients on the census date.
"^DD",117,117,2,0)
DOM ABSENCES^NJ4,0^^0;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,2,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,2,21,0)
^.001^2^2^3030424^^
"^DD",117,117,2,21,1,0)
This field contains the number of Domiciliary members on
"^DD",117,117,2,21,2,0)
authorized or unauthorized absence on the census date.
"^DD",117,117,4,0)
NHCU PATIENTS^NJ4,0^^0;4^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,4,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,4,21,0)
^^2^2^2880716^
"^DD",117,117,4,21,1,0)
This field contains the number of Nursing Home Care Unit patients
"^DD",117,117,4,21,2,0)
being shown by MAS as admitted patients on the census date.
"^DD",117,117,5,0)
NHCU ABSENCES^NJ4,0^^0;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,5,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,5,21,0)
^^2^2^2880716^
"^DD",117,117,5,21,1,0)
This field contains the number of Nursing Home Care Unit patients
"^DD",117,117,5,21,2,0)
on authorized or unauthorized absence on the census date.
"^DD",117,117,6,0)
COMM OFFICE^117.06P^^2;0
"^DD",117,117,7,0)
HOSP INPATIENTS^NJ4,0^^0;6^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,7,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,7,21,0)
^^2^2^2880716^
"^DD",117,117,7,21,1,0)
This field contains the number of Hospital inpatients being shown
"^DD",117,117,7,21,2,0)
by MAS as admitted patients on the census date.
"^DD",117,117,8,0)
HOSP ABSENCES^NJ4,0^^0;7^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,8,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,8,21,0)
^^2^2^2910625^^
"^DD",117,117,8,21,1,0)
This field contains the number of Hospital inpatients on
"^DD",117,117,8,21,2,0)
authorized or unauthorized absence on the census date.
"^DD",117,117,30,0)
OUTPATIENT BREAKFAST^NJ4,0^^1;1^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,30,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,30,21,0)
^^2^2^2880716^
"^DD",117,117,30,21,1,0)
This field contains the number of breakfast meals served to
"^DD",117,117,30,21,2,0)
outpatients on the census date.
"^DD",117,117,31,0)
OUTPATIENT NOON^NJ4,0^^1;2^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,31,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,31,21,0)
^^2^2^2880716^
"^DD",117,117,31,21,1,0)
This field contains the number of noon meals served to
"^DD",117,117,31,21,2,0)
outpatients on the census date.
"^DD",117,117,32,0)
OUTPATIENT EVENING^NJ4,0^^1;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,32,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,32,21,0)
^^2^2^2880716^
"^DD",117,117,32,21,1,0)
This field contains the number of evening meals served to
"^DD",117,117,32,21,2,0)
outpatients on the census date.
"^DD",117,117,33,0)
CONTRACT BREAK^NJ4,0^^1;4^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,33,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,33,21,0)
^^2^2^2880716^
"^DD",117,117,33,21,1,0)
This field contains the number of breakfast meals served
"^DD",117,117,33,21,2,0)
under contract on the census date.
"^DD",117,117,34,0)
CONTRACT NOON^NJ4,0^^1;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,34,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,34,21,0)
^^2^2^2880716^
"^DD",117,117,34,21,1,0)
This field contains the number of noon meals served
"^DD",117,117,34,21,2,0)
under contract on the census date.
"^DD",117,117,35,0)
CONTRACT EVENING^NJ4,0^^1;6^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,35,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,35,21,0)
^^2^2^2880716^
"^DD",117,117,35,21,1,0)
This field contains the number of evening meals served
"^DD",117,117,35,21,2,0)
under contract on the census date.
"^DD",117,117,36,0)
OTHER PAID BREAK^NJ4,0^^1;7^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,36,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,36,21,0)
^^2^2^2880716^^
"^DD",117,117,36,21,1,0)
This field contains the number of breakfast meals served
"^DD",117,117,36,21,2,0)
to other paid individuals on the census date.
"^DD",117,117,37,0)
OTHER PAID NOON^NJ4,0^^1;8^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,37,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,37,21,0)
^^2^2^2880716^
"^DD",117,117,37,21,1,0)
This field contains the number of noon meals served
"^DD",117,117,37,21,2,0)
to other paid individuals on the census date.
"^DD",117,117,38,0)
OTHER PAID EVENING^NJ4,0^^1;9^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,38,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,38,21,0)
^^2^2^2880716^
"^DD",117,117,38,21,1,0)
This field contains the number of evening meals served
"^DD",117,117,38,21,2,0)
to other paid individuals on the census date.
"^DD",117,117,39,0)
OOD BREAK^NJ4,0^^1;10^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,39,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,39,21,0)
^^2^2^2880716^
"^DD",117,117,39,21,1,0)
This field contains the number of breakfast meals served
"^DD",117,117,39,21,2,0)
to OOD personnel on the census date.
"^DD",117,117,40,0)
OOD NOON^NJ4,0^^1;11^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,40,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,40,21,0)
^^2^2^2880716^
"^DD",117,117,40,21,1,0)
This field contains the number of noon meals served
"^DD",117,117,40,21,2,0)
to OOD personnel on the census date.
"^DD",117,117,41,0)
OOD EVENING^NJ4,0^^1;12^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,41,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,41,21,0)
^^2^2^2880716^
"^DD",117,117,41,21,1,0)
This field contains the number of evening meals served
"^DD",117,117,41,21,2,0)
to OOD personnel on the census date.
"^DD",117,117,42,0)
VOLUNTEER BREAK^NJ4,0^^1;13^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,42,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,42,21,0)
^^2^2^2880716^
"^DD",117,117,42,21,1,0)
This field contains the number of breakfast meals served to
"^DD",117,117,42,21,2,0)
volunteers on the census date.
"^DD",117,117,43,0)
VOLUNTEER NOON^NJ4,0^^1;14^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,43,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,43,21,0)
^^2^2^2910612^^
"^DD",117,117,43,21,1,0)
This field contains the number of noon meals served to
"^DD",117,117,43,21,2,0)
volunteers on the census date.
"^DD",117,117,44,0)
VOLUNTEER EVENING^NJ4,0^^1;15^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,44,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,44,21,0)
^^2^2^2880716^
"^DD",117,117,44,21,1,0)
This field contains the number of evening meals served to
"^DD",117,117,44,21,2,0)
volunteers on the census date.
"^DD",117,117,45,0)
GRAT OTHER BREAK^NJ4,0^^1;16^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,45,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,45,21,0)
^^2^2^2880716^
"^DD",117,117,45,21,1,0)
This field contains the number of breakfast meals served
"^DD",117,117,45,21,2,0)
gratuitously to others on the census date.
"^DD",117,117,46,0)
GRAT OTHER NOON^NJ4,0^^1;17^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,46,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,46,21,0)
^^2^2^2880716^
"^DD",117,117,46,21,1,0)
This field contains the number of noon meals served
"^DD",117,117,46,21,2,0)
gratuitously to others on the census date.
"^DD",117,117,47,0)
GRAT OTHER EVENING^NJ4,0^^1;18^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,47,3)
TYPE A WHOLE NUMBER BETWEEN 0 AND 9999
"^DD",117,117,47,21,0)
^^2^2^2880716^
"^DD",117,117,47,21,1,0)
This field contains the number of evening meals served
"^DD",117,117,47,21,2,0)
gratuitously to others on the census date.
"^DD",117,117,50,0)
CAFETERIA MEALS^NJ4,0^^1;19^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,50,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117,50,21,0)
^^2^2^2900325^
"^DD",117,117,50,21,1,0)
This field contains the number of cafeteria meals served
"^DD",117,117,50,21,2,0)
on the census date.
"^DD",117,117,50,"DT")
2900325
"^DD",117,117,51,0)
NPO MEALS^NJ4,0^^1;20^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,51,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117,51,21,0)
^^2^2^2910625^^
"^DD",117,117,51,21,1,0)
This field contains the number of NPO meals for the
"^DD",117,117,51,21,2,0)
census date.
"^DD",117,117,51,"DT")
2900325
"^DD",117,117,52,0)
# PATIENTS STATUS I^NJ4,0^^1;21^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,52,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117,52,21,0)
^^2^2^2911204^
"^DD",117,117,52,21,1,0)
This field represents the number of patients for which the Nutrition
"^DD",117,117,52,21,2,0)
Status was I on the given date.
"^DD",117,117,52,"DT")
2910610
"^DD",117,117,53,0)
# PATIENTS STATUS II^NJ4,0^^1;22^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,53,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117,53,21,0)
^^2^2^2911204^
"^DD",117,117,53,21,1,0)
This field represents the number of patients for which the Nutrition
"^DD",117,117,53,21,2,0)
Status was II on the given date.
"^DD",117,117,54,0)
# PATIENTS STATUS III^NJ4,0^^1;23^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,54,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117,54,21,0)
^^2^2^2911204^^
"^DD",117,117,54,21,1,0)
This field represents the number of patients for which the Nutrition
"^DD",117,117,54,21,2,0)
Status was III on the given date.
"^DD",117,117,55,0)
# PATIENTS STATUS IV^NJ4,0^^1;24^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,55,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117,55,21,0)
^^2^2^2911204^
"^DD",117,117,55,21,1,0)
This field represents the number of patients for which the Nutrition
"^DD",117,117,55,21,2,0)
Status was IV on the given date.
"^DD",117,117,56,0)
# PATIENTS STATUS UNC^NJ4,0^^1;25^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,56,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117,56,21,0)
^^2^2^2911204^
"^DD",117,117,56,21,1,0)
This field represents the number of patients for which the Nutrition
"^DD",117,117,56,21,2,0)
Status was not available, or invalid, on the given date.
"^DD",117,117,57,0)
# DAILY MODIFIED DIETS^NJ9,0^^1;26^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,57,3)
Type a Number between 0 and 999999999, 0 Decimal Digits
"^DD",117,117,57,21,0)
^^2^2^2930908^^^^
"^DD",117,117,57,21,1,0)
This is the number of modified (non-regular) diets served. It
"^DD",117,117,57,21,2,0)
also includes NPOs and Passes.
"^DD",117,117,57,"DT")
2920304
"^DD",117,117,58,0)
# OF TOTAL DIETS^NJ10,0^^1;27^K:+X'=X!(X>9999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117,58,3)
Type a Number between 0 and 9999999999, 0 Decimal Digits
"^DD",117,117,58,21,0)
^^1^1^2930908^^
"^DD",117,117,58,21,1,0)
This field contains the number of total Diets.
"^DD",117,117,58,"DT")
2920618
"^DD",117,117.06,0)
COMM OFFICE SUB-FIELD^^8^27
"^DD",117,117.06,0,"DT")
3030424
"^DD",117,117.06,0,"IX","B",117.06,.01)

"^DD",117,117.06,0,"NM","COMM OFFICE")

"^DD",117,117.06,0,"UP")
117
"^DD",117,117.06,.01,0)
COMM OFFICE^P119.73'^FH(119.73,^0;1^Q
"^DD",117,117.06,.01,1,0)
^.1
"^DD",117,117.06,.01,1,1,0)
117.06^B
"^DD",117,117.06,.01,1,1,1)
S ^FH(117,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",117,117.06,.01,1,1,2)
K ^FH(117,DA(1),2,"B",$E(X,1,30),DA)
"^DD",117,117.06,.01,3)
Enter Communication Office code
"^DD",117,117.06,.01,"DT")
3030423
"^DD",117,117.06,1,0)
OUTPATIENT BREAKFAST^NJ4,0^^0;2^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1.N) X
"^DD",117,117.06,1,3)
Type a number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,1,"DT")
3030131
"^DD",117,117.06,2,0)
OUTPATIENT NOON^NJ4,0^^0;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1.N) X
"^DD",117,117.06,2,3)
Type a number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,2,"DT")
3030131
"^DD",117,117.06,3,0)
OUTPATIENT EVENING^NJ4,0^^0;4^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1.N) X
"^DD",117,117.06,3,3)
Type a number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,3,"DT")
3030131
"^DD",117,117.06,4,0)
CONTRACT BREAK^NJ4,0^^0;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1.N) X
"^DD",117,117.06,4,3)
Type a number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,4,"DT")
3030131
"^DD",117,117.06,5,0)
CONTRACT NOON^NJ4,0^^0;6^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,5,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,5,"DT")
3030424
"^DD",117,117.06,6,0)
CONTRACT EVE^NJ4,0^^0;7^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,6,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,6,"DT")
3030424
"^DD",117,117.06,7,0)
OTHER PAID BREAK^NJ4,0^^0;8^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,7,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,7,"DT")
3030424
"^DD",117,117.06,8,0)
OTHER PAID NOON^NJ4,0^^0;9^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,8,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,8,"DT")
3030424
"^DD",117,117.06,9,0)
OTHER PAID EVENING^NJ4,0^^0;10^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,9,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,9,"DT")
3030131
"^DD",117,117.06,10,0)
OOD BREAK^NJ4,0^^0;11^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,10,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,10,"DT")
3030131
"^DD",117,117.06,11,0)
OOD NOON^NJ4,0^^0;12^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,11,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,11,"DT")
3030131
"^DD",117,117.06,12,0)
OOD EVENING^NJ4,0^^0;13^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,12,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,12,"DT")
3030131
"^DD",117,117.06,13,0)
VOLUNTEER BREAK^NJ4,0^^0;14^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,13,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,13,"DT")
3030131
"^DD",117,117.06,14,0)
VOLUNTEER NOON^NJ4,0^^0;15^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,14,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,14,"DT")
3030131
"^DD",117,117.06,15,0)
VOLUNTEER EVENING^NJ4,0^^0;16^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,15,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,15,"DT")
3030131
"^DD",117,117.06,16,0)
GRAT OTHER BREAK^NJ4,0^^0;17^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,16,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,16,"DT")
3030131
"^DD",117,117.06,17,0)
GRAT OTHER NOON^NJ4,0^^0;18^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,17,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,17,"DT")
3030131
"^DD",117,117.06,18,0)
GRAT OTHER EVENING^NJ4,0^^0;19^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,18,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,18,"DT")
3030131
"^DD",117,117.06,19,0)
CAFETERIA MEALS^NJ4,0^^0;20^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,19,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,19,"DT")
3030131
"^DD",117,117.06,20,0)
NPO MEALS^NJ4,0^^0;21^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,20,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,20,"DT")
3030131
"^DD",117,117.06,21,0)
DOM MEMBERS^NJ4,0^^1;1^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,21,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,21,"DT")
3030224
"^DD",117,117.06,22,0)
DOM ABSENCES^NJ4,0^^1;2^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,22,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,22,"DT")
3030225
"^DD",117,117.06,23,0)
NHCU PATIENTS^NJ4,0^^1;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,23,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,23,"DT")
3030225
"^DD",117,117.06,24,0)
NHCU ABSENCES^NJ4,0^^1;4^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,24,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,24,"DT")
3030225
"^DD",117,117.06,25,0)
HOSP INPATIENTS^NJ4,0^^1;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,25,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,25,"DT")
3030303
"^DD",117,117.06,26,0)
HOSP ABSENCES^NJ4,0^^1;6^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,26,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,26,"DT")
3030225
"^DD",117.1,117.1,0)
FIELD^^20^21
"^DD",117.1,117.1,0,"DDA")
N
"^DD",117.1,117.1,0,"DT")
3030423
"^DD",117.1,117.1,0,"IX","B",117.1,.01)

"^DD",117.1,117.1,0,"NM","STAFFING DATA")

"^DD",117.1,117.1,.01,0)
DATE^RDX^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X) S DINUM=X
"^DD",117.1,117.1,.01,1,0)
^.1
"^DD",117.1,117.1,.01,1,1,0)
117.1^B
"^DD",117.1,117.1,.01,1,1,1)
S ^FH(117.1,"B",$E(X,1,30),DA)=""
"^DD",117.1,117.1,.01,1,1,2)
K ^FH(117.1,"B",$E(X,1,30),DA)
"^DD",117.1,117.1,.01,1,1,"%D",0)
^^1^1^2911118^
"^DD",117.1,117.1,.01,1,1,"%D",1,0)
This is the normal B cross-reference of the DATE field.
"^DD",117.1,117.1,.01,3)

"^DD",117.1,117.1,.01,21,0)
^^1^1^2910514^^
"^DD",117.1,117.1,.01,21,1,0)
This is the date for which staffing data is entered.
"^DD",117.1,117.1,1,0)
DAILY FTEE^NJ7,3^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4N.N) X
"^DD",117.1,117.1,1,3)
Type a Number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.1,1,21,0)
^^2^2^2920129^^^^
"^DD",117.1,117.1,1,21,1,0)
This field contains the count of all personnel assigned to the
"^DD",117.1,117.1,1,21,2,0)
Dietetic Service and includes full-time and part-time employees.
"^DD",117.1,117.1,1,"DT")
2891120
"^DD",117.1,117.1,2,0)
CLINICAL FTEE^NJ7,3^^0;3^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4.N) X
"^DD",117.1,117.1,2,3)
Type a number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.1,2,21,0)
^^3^3^2950104^^^^
"^DD",117.1,117.1,2,21,1,0)
This field contains the FTEE of the clinical dietitians
"^DD",117.1,117.1,2,21,2,0)
and clinical technicians who work with the clinical
"^DD",117.1,117.1,2,21,3,0)
dietitians in patient care activities.
"^DD",117.1,117.1,2,"DT")
3030306
"^DD",117.1,117.1,3,0)
ADMINISTRATIVE FTEE^NJ7,3^^0;4^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4N.N) X
"^DD",117.1,117.1,3,3)
Type a Number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.1,3,21,0)
5^^4^4^2950104^^
"^DD",117.1,117.1,3,21,1,0)
This field contains the FTEE of the Chief and Assistant Chief
"^DD",117.1,117.1,3,21,2,0)
of the Dietetic Service, Chief of the Administrative section,
"^DD",117.1,117.1,3,21,3,0)
Chief Clinical Section, administrative dietitians, internship,
"^DD",117.1,117.1,3,21,4,0)
education and staff development dietitians, and any QA dietitians.
"^DD",117.1,117.1,3,21,5,0)
QA dietitians.
"^DD",117.1,117.1,3,"DT")
2891120
"^DD",117.1,117.1,4,0)
SUPPORT STAFF FTEE^NJ7,3^^0;5^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4N.N) X
"^DD",117.1,117.1,4,3)
Type a Number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.1,4,21,0)
^^3^3^2950222^^^^
"^DD",117.1,117.1,4,21,1,0)
This field contains the FTEE of all secretaries, clerk-typists,
"^DD",117.1,117.1,4,21,2,0)
cost accountants, and administrative technicians; it does not
"^DD",117.1,117.1,4,21,3,0)
include diet communications personnel.
"^DD",117.1,117.1,4,"DT")
2891120
"^DD",117.1,117.1,5,0)
CFWS FTEE^NJ7,3^^0;6^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4N.N) X
"^DD",117.1,117.1,5,3)
Type a Number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.1,5,21,0)
^^2^2^2930204^^^
"^DD",117.1,117.1,5,21,1,0)
This field contains the FTEE of Supervisory Cooks and Supervisory
"^DD",117.1,117.1,5,21,2,0)
Food Service workers.
"^DD",117.1,117.1,5,"DT")
2891120
"^DD",117.1,117.1,6,0)
DAYS OFF HOURS^NJ7,2^^0;7^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,6,3)
Type a Number between 0 and 9999, 2 Decimal Digits
"^DD",117.1,117.1,6,21,0)
^^2^2^2891121^^^
"^DD",117.1,117.1,6,21,1,0)
This field contains the count of hours not worked by measured
"^DD",117.1,117.1,6,21,2,0)
personnel.
"^DD",117.1,117.1,6,"DT")
2891121
"^DD",117.1,117.1,7,0)
LWOP & AWOL HOURS^NJ6,2^^0;8^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,7,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,7,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,7,21,1,0)
This field contains the number of LWOP and AWOL hours for
"^DD",117.1,117.1,7,21,2,0)
measured personnel.
"^DD",117.1,117.1,8,0)
OVERTIME HOURS^NJ6,2^^0;9^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,8,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,8,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,8,21,1,0)
This field contains the number of overtime hours worked by
"^DD",117.1,117.1,8,21,2,0)
measured personnel.
"^DD",117.1,117.1,9,0)
UNSCHEDULED HOURS^NJ6,2^^0;10^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,9,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,9,21,0)
^^2^2^2921124^^^
"^DD",117.1,117.1,9,21,1,0)
This field contains the number of unscheduled hours worked by
"^DD",117.1,117.1,9,21,2,0)
measured personnel.
"^DD",117.1,117.1,10,0)
INTERMITTENT HOURS^NJ6,2^^0;11^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,10,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,10,21,0)
^^2^2^2921124^^
"^DD",117.1,117.1,10,21,1,0)
This field contains the number of intermittent hours worked by
"^DD",117.1,117.1,10,21,2,0)
measured personnel.
"^DD",117.1,117.1,11,0)
COP HOURS^NJ6,2^^0;12^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,11,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,11,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,11,21,1,0)
This field contains the number of Continuation-of-Pay hours by
"^DD",117.1,117.1,11,21,2,0)
measured personnel.
"^DD",117.1,117.1,12,0)
ANNUAL LEAVE HOURS^NJ6,2^^0;13^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,12,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,12,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,12,21,1,0)
This field contains the number of hours of annual leave taken
"^DD",117.1,117.1,12,21,2,0)
by measured personnel.
"^DD",117.1,117.1,13,0)
SICK LEAVE HOURS^NJ6,2^^0;14^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,13,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,13,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,13,21,1,0)
This field contains the number of hours of sick leave taken by
"^DD",117.1,117.1,13,21,2,0)
measured personnel.
"^DD",117.1,117.1,14,0)
OTHER LEAVE HOURS^NJ6,2^^0;15^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,14,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,14,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,14,21,1,0)
This field contains the number of hours of other types of leave
"^DD",117.1,117.1,14,21,2,0)
taken by measured personnel.
"^DD",117.1,117.1,15,0)
LOANED/UNION HOURS^NJ6,2^^0;16^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,15,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,15,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,15,21,1,0)
This field contains the number of hours worked in other services,
"^DD",117.1,117.1,15,21,2,0)
or on union affairs, by measured personnel.
"^DD",117.1,117.1,16,0)
COMP. HOURS^NJ6,2^^0;17^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,16,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,16,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,16,21,1,0)
This field contains the number of compensatory hours worked by
"^DD",117.1,117.1,16,21,2,0)
measured personnel.
"^DD",117.1,117.1,17,0)
TRAINEE HOURS^NJ6,2^^0;18^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,17,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,17,21,0)
^^1^1^2891120^
"^DD",117.1,117.1,17,21,1,0)
This field contains the number of hours worked by trainees.
"^DD",117.1,117.1,18,0)
VOLUNTEER HOURS^NJ6,2^^0;19^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,18,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,18,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,18,21,1,0)
This field contains the number of hours worked by uncompensated
"^DD",117.1,117.1,18,21,2,0)
volunteers.
"^DD",117.1,117.1,19,0)
BORROWED HOURS^NJ6,2^^0;20^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3N.N) X
"^DD",117.1,117.1,19,3)
Type a Number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.1,19,21,0)
^^2^2^2891120^
"^DD",117.1,117.1,19,21,1,0)
This field contains the number of hours worked by employees borrowed
"^DD",117.1,117.1,19,21,2,0)
from other Services.
"^DD",117.1,117.1,20,0)
COMM OFFICE^117.11P^^1;0
"^DD",117.1,117.11,0)
COMM OFFICE SUB-FIELD^^20^20
"^DD",117.1,117.11,0,"DT")
3030423
"^DD",117.1,117.11,0,"IX","B",117.11,.01)

"^DD",117.1,117.11,0,"NM","COMM OFFICE")

"^DD",117.1,117.11,0,"UP")
117.1
"^DD",117.1,117.11,.01,0)
COMM OFFICE^P119.73'^FH(119.73,^0;1^Q
"^DD",117.1,117.11,.01,1,0)
^.1
"^DD",117.1,117.11,.01,1,1,0)
117.11^B
"^DD",117.1,117.11,.01,1,1,1)
S ^FH(117.1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",117.1,117.11,.01,1,1,2)
K ^FH(117.1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",117.1,117.11,.01,3)
This entry is required, enter Communications Office code  
"^DD",117.1,117.11,.01,"DT")
3030423
"^DD",117.1,117.11,2,0)
DAILY FTEE^NJ7,3^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4.N) X
"^DD",117.1,117.11,2,3)
Type a number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.11,2,"DT")
3030307
"^DD",117.1,117.11,3,0)
CLINICAL FTEE^NJ7,3^^0;3^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4.N) X
"^DD",117.1,117.11,3,3)
Type a number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.11,3,"DT")
3030307
"^DD",117.1,117.11,4,0)
ADMINISTRATIVE FTEE^NJ7,3^^0;4^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4.N) X
"^DD",117.1,117.11,4,3)
Type a number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.11,4,"DT")
3030307
"^DD",117.1,117.11,5,0)
SUPPORT STAFF FTEE^NJ7,3^^0;5^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4.N) X
"^DD",117.1,117.11,5,3)
Type a number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.11,5,"DT")
3030307
"^DD",117.1,117.11,6,0)
CFWS FTEE^NJ7,3^^0;6^K:+X'=X!(X>999)!(X<0)!(X?.E1"."4.N) X
"^DD",117.1,117.11,6,3)
Type a number between 0 and 999, 3 Decimal Digits
"^DD",117.1,117.11,6,"DT")
3030307
"^DD",117.1,117.11,7,0)
DAYS OFF HOURS^NJ7,2^^0;7^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,7,3)
Type a number between 0 and 9999, 2 Decimal Digits
"^DD",117.1,117.11,7,"DT")
3030307
"^DD",117.1,117.11,8,0)
LWOP & AWOL HOURS^NJ6,2^^0;8^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,8,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,8,"DT")
3030307
"^DD",117.1,117.11,9,0)
OVERTIME HOURS^NJ6,2^^0;9^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,9,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,9,"DT")
3030307
"^DD",117.1,117.11,10,0)
UNSCHEDULED HOURS^NJ6,2^^0;10^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,10,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,10,"DT")
3030307
"^DD",117.1,117.11,11,0)
INTERMITTENT HOURS^NJ6,2^^0;11^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,11,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,11,"DT")
3030307
"^DD",117.1,117.11,12,0)
COP HOURS^NJ6,2^^0;12^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,12,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,12,"DT")
3030307
"^DD",117.1,117.11,13,0)
ANNUAL LEAVE HOURS^NJ6,2^^0;13^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,13,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,13,"DT")
3030307
"^DD",117.1,117.11,14,0)
SICK LEAVE HOURS^NJ6,2^^0;14^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,14,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,14,"DT")
3030307
"^DD",117.1,117.11,15,0)
OTHER LEAVE HOURS^NJ6,2^^0;15^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,15,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,15,"DT")
3030307
"^DD",117.1,117.11,16,0)
LOANED/UNION HOURS^NJ6,2^^0;16^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,16,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,16,"DT")
3030307
"^DD",117.1,117.11,17,0)
COMP. HOURS^NJ6,2^^0;17^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,17,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,17,"DT")
3030307
"^DD",117.1,117.11,18,0)
TRAINEE HOURS^NJ6,2^^0;18^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,18,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,18,"DT")
3030307
"^DD",117.1,117.11,19,0)
VOLUNTEER HOURS^NJ6,2^^0;19^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,19,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,19,"DT")
3030307
"^DD",117.1,117.11,20,0)
BORROWED HOURS^NJ6,2^^0;20^K:+X'=X!(X>999)!(X<0)!(X?.E1"."3.N) X
"^DD",117.1,117.11,20,3)
Type a number between 0 and 999, 2 Decimal Digits
"^DD",117.1,117.11,20,"DT")
3030307
"^DIC",115.7,115.7,0)
DIETETIC ENCOUNTERS^115.7
"^DIC",115.7,115.7,0,"GL")
^FHEN(
"^DIC",115.7,115.7,"%",0)
^1.005^^
"^DIC",115.7,115.7,"%D",0)
^^4^4^2920623^^^
"^DIC",115.7,115.7,"%D",1,0)
This file contains the various dietetic encounters entered
"^DIC",115.7,115.7,"%D",2,0)
by dietetics personnel. It includes patient-related events,
"^DIC",115.7,115.7,"%D",3,0)
such as diet instructions, as well as non-patient-related
"^DIC",115.7,115.7,"%D",4,0)
events such as talks to the community.
"^DIC",115.7,"B","DIETETIC ENCOUNTERS",115.7)

"^DIC",117,117,0)
MEALS SERVED^117D
"^DIC",117,117,0,"GL")
^FH(117,
"^DIC",117,117,"%",0)
^1.005^^
"^DIC",117,117,"%D",0)
^^3^3^3030121^
"^DIC",117,117,"%D",1,0)
This file contains the statistical data necessary to prepare the
"^DIC",117,117,"%D",2,0)
Served Meals Report and the Staffing Data Report. Data
"^DIC",117,117,"%D",3,0)
is saved for each date.
"^DIC",117,"B","MEALS SERVED",117)

"^DIC",117.1,117.1,0)
STAFFING DATA^117.1D
"^DIC",117.1,117.1,0,"GL")
^FH(117.1,
"^DIC",117.1,117.1,"%",0)
^1.005^^
"^DIC",117.1,117.1,"%D",0)
^^2^2^3030306^
"^DIC",117.1,117.1,"%D",1,0)
This file contains the statistical data necessary to prepare the
"^DIC",117.1,117.1,"%D",2,0)
Staffing Data report. Data is saved for each date.
"^DIC",117.1,"B","STAFFING DATA",117.1)

**END**
**END**
