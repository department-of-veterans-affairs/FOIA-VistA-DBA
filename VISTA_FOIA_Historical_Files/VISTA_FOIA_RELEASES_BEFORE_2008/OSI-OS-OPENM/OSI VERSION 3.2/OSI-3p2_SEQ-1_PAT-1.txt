
=============================================================================
Run Date: APR 26, 2001                     Designation: OSI*3.2*1
Package : OSI - OS-OPENM                       Priority: Mandatory
Version : 3.2         SEQ #1                   Status: Released
=============================================================================


Subject: Cache 3.2 (Golden Build) Updates

Category: 
  - Other

Description: 
============

 **THIS PATCH IS FOR AVANTI (Windows NT/Intersystems Cache) SITES
   RUNNING CACHE GOLDEN BUILD VERSION 3.2 (Build 031 + Compaq4) ONLY**
  
 This patch requires that users be off the system and Taskman shutdown. 
 Cache will need to be restarted after this patch has been applied.
  
 This patch contains instructions for downloading an updated Cache system 
 routine - STU1 and Viewpoint file - VP.MAP.  The hostfile name containing
 these two files is OSI_32_1.ZIP and has been placed in the Hines Anonymous
 directory under the \AVANTI folder.  This file should be retrieved using
 Binary format.  The IP address for the Hines Anonymous directory is
 152.129.1.110.  
  
 This patch also contains recommended Logfile settings for the NT Event 
 Viewer and Cache system parameter settings to allow viewing/editing of VA
 '%' globals.
  
 Routine Description:
  
 After installation of this patch, the second line of the routines will
 look like the following:
  
                        Checksums       
         Routine     Before      After      Patch List
         -------     ------      -----      ----------
         STU1         n/a         n/a      (OS routine)
  
 Brief description of changes:
  
 STU1 Routine:
  
 Cache system startup routines include code to clean up Cache scratch
 globals when Cache is started.  The method previously being used was 
 to delete and recreate the global.  This process conflicted with the 
 Cache system parameter 'Journal new globals'-
 \Configuration Manager\Advanced\Miscellaneous - which should be set to 
 'YES'.  The updated STU1 routine will now only delete first level
 subscripts within the scratch globals.
  
 VP.MAP:
  
 Troubleshooting Viewpoint problems at sites sometimes revealed that 
 the Viewpoint file VP.MAP had a file attribute of READ-ONLY checked.
 This would cause the Cache process VPSERVE to fail while attempting to 
 update the file.  An updated VP.MAP file is being re-distributed with 
 the READ-ONLY attribute unchecked.
  
 NT Event Viewer:
  
 In order to maintain consistency it is recommended that the NT
 Event Viewer be reviewed on each Alpha/NT system and the Event Log
 Settings be updated.
  
 Show System Globals:
  
 Allow viewing/editing of VA '%' globals, within the VAH namespace,
 using the Cache Explorer utility.
  
 Global Journal Flag:
   
 Disable journaling on Taskman and scratch globals.
  
 Installation:
  
 Step 1: Download the OSI_32_1.ZIP file
 --------------------------------------
  
 Use ftp to retrieve the OSI_32_1.ZIP file from the Hines ftp server.
 This file contains the STU1 routine and VP.MAP file.  Make sure to 
 download the file using Binary format, and save it to the T:\TEMP folder.  
  
 This file can be retrieved by logging on anonymous at the Hines ftp
 server at 152.129.1.110\avanti\.
  
 To ftp the file from a command prompt window:
 ---------------------------------------------
  
  Example (your input is in brackets [] )
  
 C:\>[ftp 152.129.1.110]
 Connected to 152.129.1.110.
 220 ISC4A1 FTP Server (Version 4.2) Ready.
 User (152.129.1.110:(none)): [anonymous]
 331 Guest login OK, send ident as password.
 Password:  [enter your email address]
 230 Guest login OK, access restrictions apply.
 ftp> [cd avanti]
 250-CWD command successful.
 250 New default directory is VA1$:[ANONYMOUS.AVANTI]
 ftp> [lcd t:\anonymous]   <---local change directory
 Local directory now T:\Anonymous
 ftp> [bin]
 200 TYPE set to I.
 ftp> [get osi_32_1.zip]
 200 PORT command successful.
 150 Opening data connection for VA1$:[ANONYMOUS.AVANTI]OSI_32_1.ZIP
 (152.131.2.12,2415)
 226 Transfer complete.
 19506 bytes received in 0.02Seconds (975.30Kbytes/sec)
 ftp> [bye]
 221 Goodbye.
  
 To unzip the file from a command prompt window:
 -----------------------------------------------
  
  Example (your input is in brackets [] )
  
 Unzip the OSI_32_1.ZIP file using PKUNZIP.  The PKUNZIP utility can be 
 downloaded from http://vaww.va.gov/compaqpchs/down.html.
  
 T:\TEMP\>[pkunzip osi_32_1.zip]
  
 PKUNZIP (R)    FAST!    Extract Utility    Version 2.04g  02-01-93
 Copr. 1989-1993 PKWARE Inc. All Rights Reserved. Shareware Version
 PKUNZIP Reg. U.S. Pat. and Tm. Off.
  
 | 80486 CPU detected.|
 | XMS version 2.00 detected.|
 | DPMI version 0.90 detected.|
  
 Searching ZIP: OSI_32_1.ZIP
   Inflating: Stu1.rtn
   Inflating: VP.MAP
  
 T:\TEMP>
  
 Step 2: Shutdown Taskman and Inhibit User Logons
 ---------------------------------------
  
 Stop Taskman by running the option 'Stop Task Manager' [XUTM STOP].
 Next inhibit user logons by setting the 'INHIBIT LOGONS?' field (#1),
 in the VOLUME SET file (#14.5), for the ROU volume set to YES.
  
 Step 3: Install the STU1 Routine and VP.MAP File
 ------------------------------------------------
  
 VP.MAP File
 -----------
  
 Copy the VP.MAP file to the Primary, Secondary and Test Systems and place 
 the file in the C:\VP\VPS folder.  Answer YES to overwriting the file.
  
 STU1 Routine
 ------------
  
 In the %SYS namespace, use the ^%RI utility to restore the STU1 routine
 in the STU1.RTN file.  Example (your input is in  brackets [ ] ):
  
 %SYS>[D ^%RI]
  
 Input routines from Sequential
 Device: [T:\TEMP\STU1.RTN]   Parameters: "RS"=>[cr]
  
 File written by Cache for Windows NT using %RO on Mar 21 2001  11:01 AM
 with extension INT and with description:
 Export of 1 routines from namespace %SYS
  
 ( All Select Enter List Quit )
  
 Routine Input Option: [A]ll Routines
  
 If a selected routine has the same name as one already on file,
 shall it replace the one on file? No => [Y]es
 Recompile? Yes => [Y]es
 Display Syntax Errors? Yes => [Y]es
  
 ^ indicates routines which will replace those now on file.
 @ indicates routines which have been [re]compiled.
 - indicates routines which have not been filed.
  
  
 STU1.INT^@      
  
 1 routine saved.
  
 Step 4: NT Event Viewer
 -----------------------
  
 Update NT Event Viewer - Event Log Settings:
  
 The following steps need to be performed on the Primary, Secondary, and
 Test systems.
  
  1) Access the NT Event Viewer:
  
      Start\Programs\Administrative Tools\Event Viewer
  
  2) Change the 'Event Log Settings' for the System, Security and 
     Application log files.  This is accomplished by selecting the 'Log' 
     menu and clicking on one of the Log file names.
  
  3) Next, select from the 'Log' menu the option 'Log Settings'.
  
  4) Change the current value for the 'Maximum Log Size' parameter to 
     1600 KB.
  
  5) Click on the 'Overwrite Events Older than' parameter and set it 10 Days
     and click okay.
  
  6) Update the remaining Log files starting with step 2 in this section.
  
 Step 5: Show System Globals
 ---------------------------
  
 Allow viewing/editing of VA '%' globals, within the VAH namespace, using
 the Cache Explorer GUI utility.
  
 In order to view and edit VA '%' globals within the VAH namespace, the 
 'Show System Globals' parameter needs to be checked.  This parameter 
 is located in:
  
   Cache Explorer\Options\Globals\Display section - Show System Globals.  
  
 NOTE: The Cache Explorer Settings windows can also be accessed by starting 
       Cache Explorer and pressing F2.
  
 Step 6: Disable Journaling on Taskman/Scratch Globals
 -----------------------------------------------------
  
 In the VAH namespace, review the Journal Flag parameter for each of the 
 globals listed below to ensure that it is set to NO.  This parameter
 can be reviewed/edited by using the Cache Explorer and Control Panel
 utilities.
  
 Start the Cache Explorer, expand the Namespace folder and select the VAH
 namespace.  In the Contents of 'Globals' window note the 'Data Location'
 for each of the following globals i.e. TMP - y:\zaa.
  
   %ZTSCH
   %ZTSK
   CacheTemp
   TMP
   UTILITY
   XTMP
  
 Start the Cache Control Panel and expand the Local Databases folder. 
 Starting with first global, locate the dataset folder that was identified 
 from the Cache Explorer and expand the folder.  If the Journal Flag is set 
 to Yes, right click on the global name and select Properties.  Next, 
 UNCHECK the 'Journal global' box and click OKAY.  Review each global 
 listed.
  
 Step 7: Restart Cache
 ---------------------
  
 Shutdown and restart Cache.
  
 Step 8: Enable User Logons
 --------------------------
 Allow user logons by resetting the 'INHIBIT LOGONS?' field (#1), in the
 VOLUME SET file (#14.5), for the ROU volume set to NO.

Routine Information:
====================

=============================================================================
User Information:                               
Entered By  : BOGGESS,MIKE                   Date Entered : APR 10, 2001
Completed By: WANG,MARK                     Date Completed: APR 26, 2001
Released By : PALMER,MICHAEL                Date Released : APR 26, 2001
=============================================================================


Packman Mail Message:
=====================

No routines included
