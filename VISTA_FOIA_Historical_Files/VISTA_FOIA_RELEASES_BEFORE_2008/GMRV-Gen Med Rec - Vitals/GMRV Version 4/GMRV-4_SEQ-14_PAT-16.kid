Released GMRV*4*16 SEQ #14
Extracted from mail message
**KIDS**:GMRV*4.0*16^

**INSTALL NAME**
GMRV*4.0*16
"BLD",4588,0)
GMRV*4.0*16^GEN. MED. REC. - VITALS^0^3040422^y
"BLD",4588,1,0)
^^2^2^3040305^^^
"BLD",4588,1,1,0)
Please read the GMRV*4*16 patch description on FORUM for an explanation of
"BLD",4588,1,2,0)
what this patch does.
"BLD",4588,4,0)
^9.64PA^^
"BLD",4588,"ABNS",0)
^9.66A^^
"BLD",4588,"ABPKG")
^n
"BLD",4588,"INIT")
GMRVFIX
"BLD",4588,"KRN",0)
^9.67PA^8989.52^19
"BLD",4588,"KRN",.4,0)
.4
"BLD",4588,"KRN",.401,0)
.401
"BLD",4588,"KRN",.402,0)
.402
"BLD",4588,"KRN",.403,0)
.403
"BLD",4588,"KRN",.5,0)
.5
"BLD",4588,"KRN",.84,0)
.84
"BLD",4588,"KRN",3.6,0)
3.6
"BLD",4588,"KRN",3.8,0)
3.8
"BLD",4588,"KRN",9.2,0)
9.2
"BLD",4588,"KRN",9.8,0)
9.8
"BLD",4588,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",4588,"KRN",9.8,"NM",1,0)
GMRVFIX^^0^B29833645
"BLD",4588,"KRN",9.8,"NM",2,0)
GMRVPCE3^^0^B11493112
"BLD",4588,"KRN",9.8,"NM","B","GMRVFIX",1)

"BLD",4588,"KRN",9.8,"NM","B","GMRVPCE3",2)

"BLD",4588,"KRN",19,0)
19
"BLD",4588,"KRN",19.1,0)
19.1
"BLD",4588,"KRN",101,0)
101
"BLD",4588,"KRN",409.61,0)
409.61
"BLD",4588,"KRN",771,0)
771
"BLD",4588,"KRN",870,0)
870
"BLD",4588,"KRN",8989.51,0)
8989.51
"BLD",4588,"KRN",8989.52,0)
8989.52
"BLD",4588,"KRN",8994,0)
8994
"BLD",4588,"KRN","B",.4,.4)

"BLD",4588,"KRN","B",.401,.401)

"BLD",4588,"KRN","B",.402,.402)

"BLD",4588,"KRN","B",.403,.403)

"BLD",4588,"KRN","B",.5,.5)

"BLD",4588,"KRN","B",.84,.84)

"BLD",4588,"KRN","B",3.6,3.6)

"BLD",4588,"KRN","B",3.8,3.8)

"BLD",4588,"KRN","B",9.2,9.2)

"BLD",4588,"KRN","B",9.8,9.8)

"BLD",4588,"KRN","B",19,19)

"BLD",4588,"KRN","B",19.1,19.1)

"BLD",4588,"KRN","B",101,101)

"BLD",4588,"KRN","B",409.61,409.61)

"BLD",4588,"KRN","B",771,771)

"BLD",4588,"KRN","B",870,870)

"BLD",4588,"KRN","B",8989.51,8989.51)

"BLD",4588,"KRN","B",8989.52,8989.52)

"BLD",4588,"KRN","B",8994,8994)

"BLD",4588,"QUES",0)
^9.62^^0
"BLD",4588,"REQB",0)
^9.611^1^1
"BLD",4588,"REQB",1,0)
GMRV*4.0*13^2
"BLD",4588,"REQB","B","GMRV*4.0*13",1)

"INIT")
GMRVFIX
"MBREQ")
0
"PKG",44,-1)
1^1
"PKG",44,0)
GEN. MED. REC. - VITALS^GMRV^Vitals/Measurements Module of General Medical Record.
"PKG",44,20,0)
^9.402P^^
"PKG",44,22,0)
^9.49I^1^1
"PKG",44,22,1,0)
4.0^2970425^2970702^64
"PKG",44,22,1,"PAH",1,0)
16^3040422^547
"PKG",44,22,1,"PAH",1,1,0)
^^2^2^3040422
"PKG",44,22,1,"PAH",1,1,1,0)
Please read the GMRV*4*16 patch description on FORUM for an explanation of
"PKG",44,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","GMRVFIX")
0^1^B29833645
"RTN","GMRVFIX",1,0)
GMRVFIX ;HIOFO/FT-CONVERT C TEMPERATURES TO F, THEN REPLACE ;3/12/04  09:50
"RTN","GMRVFIX",2,0)
 ;;4.0;Vitals/Measurements;**16**;Apr 25, 1997
"RTN","GMRVFIX",3,0)
 ;
"RTN","GMRVFIX",4,0)
 ; This routine uses the following IAs:
"RTN","GMRVFIX",5,0)
 ; #2320  - ^%ZISH calls           (supported)
"RTN","GMRVFIX",6,0)
 ; #10063 - ^%ZTLOAD calls         (supported)
"RTN","GMRVFIX",7,0)
 ; #10070 - ^XMD calls             (supported)
"RTN","GMRVFIX",8,0)
 ; #10103 - ^XLFDT calls           (supported)
"RTN","GMRVFIX",9,0)
 ; #10104 - ^XLFSTR calls          (supported)
"RTN","GMRVFIX",10,0)
 ;
"RTN","GMRVFIX",11,0)
EN ; Main entry point
"RTN","GMRVFIX",12,0)
 D QUEUE
"RTN","GMRVFIX",13,0)
 Q
"RTN","GMRVFIX",14,0)
QUEUE ; Queue the clean-up
"RTN","GMRVFIX",15,0)
 N ZTDESC,ZTDTH,ZTRTN,ZTIO,ZTSAVE,ZTSK
"RTN","GMRVFIX",16,0)
 S ZTRTN="START^GMRVFIX",ZTIO=""
"RTN","GMRVFIX",17,0)
 S ZTDTH=$$NOW^XLFDT(),ZTDESC="GMRV*4*16 DATA REPAIR"
"RTN","GMRVFIX",18,0)
 D ^%ZTLOAD
"RTN","GMRVFIX",19,0)
 I ZTSK>0 D
"RTN","GMRVFIX",20,0)
 .D EN^DDIOL("Task "_ZTSK_" has started. I'll send you a MailMan message when I finish.","","!?5")
"RTN","GMRVFIX",21,0)
 .Q
"RTN","GMRVFIX",22,0)
 I ZTSK'>0 D
"RTN","GMRVFIX",23,0)
 .S GMRVMSG="I couldn't start the task to repair the data."
"RTN","GMRVFIX",24,0)
 .D EN^DDIOL(GMRVMSG,"","!?5")
"RTN","GMRVFIX",25,0)
 .D ERRMAIL(GMRVMSG)
"RTN","GMRVFIX",26,0)
 .Q 
"RTN","GMRVFIX",27,0)
 Q
"RTN","GMRVFIX",28,0)
START ; Start looping through the database
"RTN","GMRVFIX",29,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","GMRVFIX",30,0)
 N GMRVCNT,GMRVFILE,GMRVFIXD,GMRVIEN,GMRVLINE,GMRVLOOP,GMRVMSG,GMRVNEW,GMRVNODE,GMRVPATH,GMRVOLD,GMRVOUT,GMRVSTOP,GMRVTEMP,GMRVTMP,GMRVTOTL
"RTN","GMRVFIX",31,0)
 N POP
"RTN","GMRVFIX",32,0)
 ; get TEMPERATURE ien
"RTN","GMRVFIX",33,0)
 S GMRVTEMP=$O(^GMRD(120.51,"C","T",0))
"RTN","GMRVFIX",34,0)
 I GMRVTEMP'>0 D  Q
"RTN","GMRVFIX",35,0)
 .S GMRVMSG="Can't find TEMPERATURE in the VITAL types file (120.5). Please log a NOIS."
"RTN","GMRVFIX",36,0)
 .D ERRMAIL(GMRVMSG)
"RTN","GMRVFIX",37,0)
 .Q
"RTN","GMRVFIX",38,0)
 ;
"RTN","GMRVFIX",39,0)
 S GMRVTMP(1)="The following TEMPERATURE readings in the GMRV VITAL MEASUREMENT (#120.5)"
"RTN","GMRVFIX",40,0)
 S GMRVTMP(2)="file were modified. The old value was a number less than 45. It was assumed"
"RTN","GMRVFIX",41,0)
 S GMRVTMP(3)="that the reading was done in Celsius units but not converted to Fahrenheit"
"RTN","GMRVFIX",42,0)
 S GMRVTMP(4)="before being stored in the database. These entries have now been converted"
"RTN","GMRVFIX",43,0)
 S GMRVTMP(5)="to Fahrenheit and saved. IEN indicates the record number in FILE 120.5."
"RTN","GMRVFIX",44,0)
 S GMRVTMP(6)="OLD indicates the previous value and NEW indicates the new value."
"RTN","GMRVFIX",45,0)
 S GMRVTMP(7)=" "
"RTN","GMRVFIX",46,0)
 ; set host file name and directory path
"RTN","GMRVFIX",47,0)
 S GMRVFILE="GMRV_4_16.DAT"
"RTN","GMRVFIX",48,0)
 S GMRVPATH=$$PWD^%ZISH ;current directory
"RTN","GMRVFIX",49,0)
 ; Open up device to print to
"RTN","GMRVFIX",50,0)
 D OPEN^%ZISH("VITAL",GMRVPATH,GMRVFILE,"A") ;'A' for append
"RTN","GMRVFIX",51,0)
 I POP D  Q  ;send email if device cannot be opened
"RTN","GMRVFIX",52,0)
 .S GMRVMSG="Could not open file "_GMRVFILE_" in path "_GMRVPATH_"."
"RTN","GMRVFIX",53,0)
 .D ERRMAIL(GMRVMSG)
"RTN","GMRVFIX",54,0)
 .Q
"RTN","GMRVFIX",55,0)
 U IO
"RTN","GMRVFIX",56,0)
 ; from this point on, the Write commands are writing to the host file.
"RTN","GMRVFIX",57,0)
 F GMRVLOOP=1:1:7 W !,GMRVTMP(GMRVLOOP)
"RTN","GMRVFIX",58,0)
 S (GMRVFIXD,GMRVIEN,GMRVOUT,GMRVSTOP,GMRVTOTL)=0,GMRVCNT=7
"RTN","GMRVFIX",59,0)
 F  S GMRVIEN=$O(^GMR(120.5,"T",GMRVTEMP,GMRVIEN)) Q:'GMRVIEN!(GMRVOUT=1)  D
"RTN","GMRVFIX",60,0)
 .S GMRVSTOP=GMRVSTOP+1,GMRVTOTL=GMRVTOTL+1
"RTN","GMRVFIX",61,0)
 .I GMRVSTOP=1000 D  Q:GMRVOUT=1  ;check if the user stopped the task
"RTN","GMRVFIX",62,0)
 ..S GMRVSTOP=0
"RTN","GMRVFIX",63,0)
 ..I $$S^%ZTLOAD  D
"RTN","GMRVFIX",64,0)
 ...S GMRVOUT=1
"RTN","GMRVFIX",65,0)
 ...S GMRVMSG="Job stopped by user while checking entry # "_GMRVIEN
"RTN","GMRVFIX",66,0)
 ...W !,GMRVMSG
"RTN","GMRVFIX",67,0)
 ...D ERRMAIL(GMRVMSG)
"RTN","GMRVFIX",68,0)
 ...Q
"RTN","GMRVFIX",69,0)
 ..Q
"RTN","GMRVFIX",70,0)
 .Q:$P($G(^GMR(120.5,GMRVIEN,2)),U,1)=1  ;entered-in-error
"RTN","GMRVFIX",71,0)
 .S GMRVNODE=$G(^GMR(120.5,GMRVIEN,0))
"RTN","GMRVFIX",72,0)
 .Q:GMRVNODE=""
"RTN","GMRVFIX",73,0)
 .Q:$P(GMRVNODE,U,3)'=GMRVTEMP  ;not a temperature
"RTN","GMRVFIX",74,0)
 .Q:+$P(GMRVNODE,U,8)'>0  ;not a numeric reading
"RTN","GMRVFIX",75,0)
 .I +$P(GMRVNODE,U,8)>45!(+$P(GMRVNODE,U,8)=45) Q  ;not celsius value
"RTN","GMRVFIX",76,0)
 .S GMRVOLD=$P(GMRVNODE,U,8)
"RTN","GMRVFIX",77,0)
 .S GMRVNEW=(+$P(GMRVNODE,U,8)*1.8)+32
"RTN","GMRVFIX",78,0)
 .S GMRVNEW=$$ROUND(GMRVNEW) ;round to 2 decimal places
"RTN","GMRVFIX",79,0)
 .S $P(^GMR(120.5,GMRVIEN,0),U,8)=GMRVNEW
"RTN","GMRVFIX",80,0)
 .S GMRVFIXD=GMRVFIXD+1
"RTN","GMRVFIX",81,0)
 .S GMRVLINE="IEN="_GMRVIEN_"    "_"OLD="_GMRVOLD_" / "_"NEW="_GMRVNEW
"RTN","GMRVFIX",82,0)
 .W !,GMRVLINE
"RTN","GMRVFIX",83,0)
 .Q
"RTN","GMRVFIX",84,0)
 I GMRVFIXD'>0 D
"RTN","GMRVFIX",85,0)
 .S GMRVCNT=GMRVCNT+1
"RTN","GMRVFIX",86,0)
 .S GMRVTMP(GMRVCNT)="No entries needed to be changed."
"RTN","GMRVFIX",87,0)
 .W !,GMRVTMP(GMRVCNT)
"RTN","GMRVFIX",88,0)
 .Q
"RTN","GMRVFIX",89,0)
 S GMRVCNT=GMRVCNT+1
"RTN","GMRVFIX",90,0)
 S GMRVTMP(GMRVCNT)=" "
"RTN","GMRVFIX",91,0)
 W !,GMRVTMP(GMRVCNT)
"RTN","GMRVFIX",92,0)
 S GMRVCNT=GMRVCNT+1
"RTN","GMRVFIX",93,0)
 S GMRVTMP(GMRVCNT)="Total number of entries checked: "_GMRVTOTL
"RTN","GMRVFIX",94,0)
 W !,GMRVTMP(GMRVCNT)
"RTN","GMRVFIX",95,0)
 S GMRVCNT=GMRVCNT+1
"RTN","GMRVFIX",96,0)
 S GMRVTMP(GMRVCNT)="Number of entries fixed: "_GMRVFIXD
"RTN","GMRVFIX",97,0)
 W !,GMRVTMP(GMRVCNT)
"RTN","GMRVFIX",98,0)
 S GMRVCNT=GMRVCNT+1
"RTN","GMRVFIX",99,0)
 S GMRVTMP(GMRVCNT)=GMRVFILE_" in path "_GMRVPATH_" contains a listing of entries changed."
"RTN","GMRVFIX",100,0)
 W !,GMRVTMP(GMRVCNT)
"RTN","GMRVFIX",101,0)
 D CLOSE^%ZISH("VITAL")
"RTN","GMRVFIX",102,0)
 K GMRVTMP
"RTN","GMRVFIX",103,0)
 S GMRVTMP(1)="The GMRV*4*16 data repair is finished."
"RTN","GMRVFIX",104,0)
 S GMRVTMP(2)=" "
"RTN","GMRVFIX",105,0)
 S GMRVTMP(3)="Total number of entries checked: "_GMRVTOTL
"RTN","GMRVFIX",106,0)
 S GMRVTMP(4)="        Number of entries fixed: "_GMRVFIXD
"RTN","GMRVFIX",107,0)
 S GMRVTMP(5)=" "
"RTN","GMRVFIX",108,0)
 S GMRVTMP(6)="The "_GMRVFILE_" file in the "_GMRVPATH_" directory"
"RTN","GMRVFIX",109,0)
 S GMRVTMP(7)="contains a listing of entries changed."
"RTN","GMRVFIX",110,0)
 D EMAIL(.GMRVTMP)
"RTN","GMRVFIX",111,0)
 K GMRVFILE,GMRVPATH
"RTN","GMRVFIX",112,0)
 Q
"RTN","GMRVFIX",113,0)
EMAIL(GMRVTMP) ; send Mailman message when job is done
"RTN","GMRVFIX",114,0)
 ; Input
"RTN","GMRVFIX",115,0)
 ;  GMRVTMP is message text
"RTN","GMRVFIX",116,0)
 N DIFROM,XMDUZ,XMSUB,XMTEXT,XMY
"RTN","GMRVFIX",117,0)
 S XMSUB="GMRV*4*16 DATA REPAIR"
"RTN","GMRVFIX",118,0)
 S XMY(DUZ)="",XMDUZ=.5
"RTN","GMRVFIX",119,0)
 S XMTEXT="GMRVTMP("
"RTN","GMRVFIX",120,0)
 D ^XMD
"RTN","GMRVFIX",121,0)
 Q
"RTN","GMRVFIX",122,0)
ERRMAIL(GMRVMSG) ; Send email with error message
"RTN","GMRVFIX",123,0)
 ; Input
"RTN","GMRVFIX",124,0)
 ;   GMRVMSG is error message text
"RTN","GMRVFIX",125,0)
 N DIFROM,GMRVTEXT,XMDUZ,XMSUB,XMTEXT,XMY
"RTN","GMRVFIX",126,0)
 S XMSUB="Error with GMRV*4*16 Post-Installation"
"RTN","GMRVFIX",127,0)
 S XMY(DUZ)="",XMDUZ=.5
"RTN","GMRVFIX",128,0)
 S GMRVTEXT(1)="The following error occurred:"
"RTN","GMRVFIX",129,0)
 S GMRVTEXT(2)=GMRVMSG
"RTN","GMRVFIX",130,0)
 S GMRVTEXT(3)=" "
"RTN","GMRVFIX",131,0)
 S GMRVTEXT(4)="When the error is fixed, please D EN^GMRVFIX to complete the"
"RTN","GMRVFIX",132,0)
 S GMRVTEXT(5)="database repair."
"RTN","GMRVFIX",133,0)
 S XMTEXT="GMRVTEXT("
"RTN","GMRVFIX",134,0)
 D ^XMD
"RTN","GMRVFIX",135,0)
 Q
"RTN","GMRVFIX",136,0)
ROUND(X) ; Round off a number
"RTN","GMRVFIX",137,0)
 N Y
"RTN","GMRVFIX",138,0)
 S X=+$G(X)
"RTN","GMRVFIX",139,0)
 S Y=$J(X,6,2)
"RTN","GMRVFIX",140,0)
 S Y=$$STRIP^XLFSTR(Y," ")
"RTN","GMRVFIX",141,0)
 S Y=+Y
"RTN","GMRVFIX",142,0)
 Q Y
"RTN","GMRVFIX",143,0)
 ;
"RTN","GMRVPCE3")
0^2^B11493112
"RTN","GMRVPCE3",1,0)
GMRVPCE3 ;HIRMFO/RM,FT-V/M Data Validation for AICS ;3/11/04  16:17
"RTN","GMRVPCE3",2,0)
 ;;4.0;Vitals/Measurements;**8,13,16**;Apr 25, 1997
"RTN","GMRVPCE3",3,0)
 ;
"RTN","GMRVPCE3",4,0)
 ; This routine uses the following IAs:
"RTN","GMRVPCE3",5,0)
 ; #10104 - ^XLFSTR calls          (supported)
"RTN","GMRVPCE3",6,0)
 ;
"RTN","GMRVPCE3",7,0)
VALID(TYPE,X) ; This function returns 1 if rate (X) is valid for
"RTN","GMRVPCE3",8,0)
 ; measurement type (TYPE).
"RTN","GMRVPCE3",9,0)
 N FXN S FXN=0
"RTN","GMRVPCE3",10,0)
 I TYPE="VU" S TYPE="VC"
"RTN","GMRVPCE3",11,0)
 D @TYPE I $D(X) S FXN=1
"RTN","GMRVPCE3",12,0)
 Q FXN
"RTN","GMRVPCE3",13,0)
AG ; INPUT TRANSFORM FOR ABDOMINAL GIRTH
"RTN","GMRVPCE3",14,0)
 N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2,10)) I UNIT="" K X Q
"RTN","GMRVPCE3",15,0)
 S X=+X
"RTN","GMRVPCE3",16,0)
 I $E(UNIT)="C"&("CM"[UNIT) S X=$$CMTOIN(+X,0),UNIT="IN"
"RTN","GMRVPCE3",17,0)
 I $E(UNIT)="I"&("IN"[UNIT) K:+X'=X!(X>150)!(X<0)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",18,0)
 E  K X
"RTN","GMRVPCE3",19,0)
 Q
"RTN","GMRVPCE3",20,0)
AUD ; INPUT TRANSFORM FOR AUDIOMETRY.
"RTN","GMRVPCE3",21,0)
 N I,R,L
"RTN","GMRVPCE3",22,0)
 K:X'?.N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/".N1"/" X
"RTN","GMRVPCE3",23,0)
 I $D(X) F I=1:1:8 S R=$P(X,"/",I) I R]"" K:+R'=R!(R>110)!(R<0) X
"RTN","GMRVPCE3",24,0)
 I $D(X) F I=9:1:16 S L=$P(X,"/",I) I L]"" K:+L'=L!(L>110)!(L<0) X
"RTN","GMRVPCE3",25,0)
 Q
"RTN","GMRVPCE3",26,0)
BP ; INPUT TRANSFORM FOR BLOOD PRESSURE
"RTN","GMRVPCE3",27,0)
 K:X'?2.3N1"/"2.3N1"/"2.3N&(X'?2.3N1"/"2.3N) X I $D(X) K:$P(X,"/",1)>300!($P(X,"/",2)>300)!(+$P(X,"/",3)>300) X
"RTN","GMRVPCE3",28,0)
 I $D(X),$P(X,"/")'>$P(X,"/",$L(X,"/")) K X
"RTN","GMRVPCE3",29,0)
 Q
"RTN","GMRVPCE3",30,0)
FH ; INPUT TRANSFORM FOR FUNDAL HEIGHT
"RTN","GMRVPCE3",31,0)
 N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2,10)) I UNIT="" K X Q
"RTN","GMRVPCE3",32,0)
 S X=+X
"RTN","GMRVPCE3",33,0)
 I $E(UNIT)="C"&("CM"[UNIT) S X=$$CMTOIN(+X,0),UNIT="IN"
"RTN","GMRVPCE3",34,0)
 I $E(UNIT)="I"&("IN"[UNIT) K:+X'=X!(X>50)!(X<10)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",35,0)
 E  K X
"RTN","GMRVPCE3",36,0)
 Q
"RTN","GMRVPCE3",37,0)
FT ; INPUT TRANSFORM FOR FETAL HEART TONES
"RTN","GMRVPCE3",38,0)
 K:+X'=X!(X>250)!(X<50)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",39,0)
 Q
"RTN","GMRVPCE3",40,0)
HC ; INPUT TRANSFORM FOR HEAD CIRCUMFERENCE
"RTN","GMRVPCE3",41,0)
 N UNIT S UNIT=$$UP^XLFSTR($P(X,+X,2,10)) I UNIT="" K X Q
"RTN","GMRVPCE3",42,0)
 I $E(UNIT)="C"&("CM"[UNIT) D  Q
"RTN","GMRVPCE3",43,0)
 .  K:+X>76!(+X<26)!(+X?.E1"."3N.N) X
"RTN","GMRVPCE3",44,0)
 .  I $D(X) S X=$J(.3937*(+X),0,2)
"RTN","GMRVPCE3",45,0)
 .  Q
"RTN","GMRVPCE3",46,0)
 I $E(UNIT)="I" D  Q
"RTN","GMRVPCE3",47,0)
 .  K:+X>30!(+X<10)!(+X?.E1"."4N.N) X
"RTN","GMRVPCE3",48,0)
 .  I $D(X),+X?.E1"."1N.N D
"RTN","GMRVPCE3",49,0)
 .  .  N F S F=$P(+X,".",2)
"RTN","GMRVPCE3",50,0)
 .  .  K:"^125^25^375^5^625^75^875^"'[("^"_F_"^") X
"RTN","GMRVPCE3",51,0)
 .  .  Q
"RTN","GMRVPCE3",52,0)
 .  I $D(X) S X=+X
"RTN","GMRVPCE3",53,0)
 .  Q
"RTN","GMRVPCE3",54,0)
 K X
"RTN","GMRVPCE3",55,0)
 Q
"RTN","GMRVPCE3",56,0)
HE ; INPUT TRANSFORM FOR HEARING
"RTN","GMRVPCE3",57,0)
 K:"^N^A^"'[("^"_$$UP^XLFSTR(X)_"^") X
"RTN","GMRVPCE3",58,0)
 Q
"RTN","GMRVPCE3",59,0)
HT ; INPUT TRANSFORM FOR HEIGHT
"RTN","GMRVPCE3",60,0)
 D EN3^GMRVUT0 K:X=0!(X>100)!(X<1) X
"RTN","GMRVPCE3",61,0)
 Q
"RTN","GMRVPCE3",62,0)
PU ; INPUT TRANSFORM FOR PULSE
"RTN","GMRVPCE3",63,0)
 K:+X'=X!(X>300)!(X<0)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",64,0)
 Q
"RTN","GMRVPCE3",65,0)
RS ; INPUT TRANSFORM FOR RESPIRATION
"RTN","GMRVPCE3",66,0)
 K:+X'=X!(X>100)!(X<0)!(X?.E1"."1N.N) X
"RTN","GMRVPCE3",67,0)
 Q
"RTN","GMRVPCE3",68,0)
TON ; INPUT TRANSFORM FOR TONOMETRY
"RTN","GMRVPCE3",69,0)
 N R,L
"RTN","GMRVPCE3",70,0)
 K:X'?.N1"/"1N.N&(X'?1N.N1"/".N) X
"RTN","GMRVPCE3",71,0)
 I $D(X) S R=$P(X,"/") I R]"" K:R'=+R!(R>80)!(R<0) X
"RTN","GMRVPCE3",72,0)
 I $D(X) S L=$P(X,"/",2) I L]"" K:L'=+L!(L>80)!(L<0) X
"RTN","GMRVPCE3",73,0)
 Q
"RTN","GMRVPCE3",74,0)
TMP ; INPUT TRANSFORM FOR TEMPERATURE
"RTN","GMRVPCE3",75,0)
 K:+X'=X!(X>120)!(X<0)!(X?.E1"."3N.N) X I $D(X) S:X<45 X=$J(+X*(9/5)+32,0,1)
"RTN","GMRVPCE3",76,0)
 Q
"RTN","GMRVPCE3",77,0)
VC ; INPUT TRANSFORM FOR VISION CORRECTED (AND VISION UNCORRECTED)
"RTN","GMRVPCE3",78,0)
 N R,L
"RTN","GMRVPCE3",79,0)
 K:X'=+X&(X'?.N1"/"1N.N) X
"RTN","GMRVPCE3",80,0)
 I $D(X) S R=$P(X,"/") I R]"" K:R'=+R!(R>999)!(R<10) X
"RTN","GMRVPCE3",81,0)
 I $D(X) S L=$P(X,"/",2) I L]"" K:L'=+L!(L>999)!(L<10) X
"RTN","GMRVPCE3",82,0)
 Q
"RTN","GMRVPCE3",83,0)
WT ; INPUT TRANSFORM FOR WEIGHT
"RTN","GMRVPCE3",84,0)
 I $L(X)>10 K X Q
"RTN","GMRVPCE3",85,0)
 S GMR=$E($P(X,+X,2)) S X=$S(GMR="":0,"Kk"[GMR:+$J(2.2*(+X),0,2),"Ll"[GMR:+X,1:0) K:X>1500!(X=0)!(X<0) X K GMR
"RTN","GMRVPCE3",86,0)
 Q
"RTN","GMRVPCE3",87,0)
PN ; INPUT TRANSFORM FOR PAIN
"RTN","GMRVPCE3",88,0)
 K:"^0^1^2^3^4^5^6^7^8^9^10^99^"'[(U_X_U) X
"RTN","GMRVPCE3",89,0)
 Q
"RTN","GMRVPCE3",90,0)
UNITRATE(TYPE,RATE,UNIT) ; This function will add the unit of
"RTN","GMRVPCE3",91,0)
 ; measurement to the rate so the input transforms will work properly.
"RTN","GMRVPCE3",92,0)
 ;   Input variables:  TYPE = Measurement type
"RTN","GMRVPCE3",93,0)
 ;                     RATE = Actual measurement (passed in by ref.)
"RTN","GMRVPCE3",94,0)
 ;                     UNIT = Unit of measurement
"RTN","GMRVPCE3",95,0)
 ;   Function value: Transormed rate with units on the end.
"RTN","GMRVPCE3",96,0)
 N FXN S FXN=RATE,UNIT=$G(UNIT)
"RTN","GMRVPCE3",97,0)
 I TYPE="AG"!(TYPE="FH")!(TYPE="HC")!(TYPE="HT") D
"RTN","GMRVPCE3",98,0)
 .  I "^CM^IN^"'[("^"_UNIT_"^") S FXN=""
"RTN","GMRVPCE3",99,0)
 .  E  S FXN=RATE_$E(UNIT)
"RTN","GMRVPCE3",100,0)
 .  Q
"RTN","GMRVPCE3",101,0)
 I TYPE="TMP" D
"RTN","GMRVPCE3",102,0)
 .  I "^C^F^"'[("^"_UNIT_"^") S FXN=""
"RTN","GMRVPCE3",103,0)
 .  I UNIT="F",RATE<45 S FXN=""
"RTN","GMRVPCE3",104,0)
 .  I UNIT="C" S FXN=+$J(+RATE*(9/5)+32,0,1)
"RTN","GMRVPCE3",105,0)
 .  Q
"RTN","GMRVPCE3",106,0)
 I TYPE="WT" D
"RTN","GMRVPCE3",107,0)
 .  I "^LB^KG^"'[("^"_UNIT_"^") S FXN=""
"RTN","GMRVPCE3",108,0)
 .  E  S FXN=RATE_$E(UNIT)
"RTN","GMRVPCE3",109,0)
 .  Q
"RTN","GMRVPCE3",110,0)
 Q FXN
"RTN","GMRVPCE3",111,0)
CMTOIN(X,PREC) ; Convert CM to IN, given CM value (X) this function will
"RTN","GMRVPCE3",112,0)
 ; return IN value.  Optional input value of PREC for precision,
"RTN","GMRVPCE3",113,0)
 ; if not set, 2 decimals will be returned.
"RTN","GMRVPCE3",114,0)
 Q +$J(.3937*(+X),0,+$G(PREC,2))
"VER")
8.0^22.0
**END**
**END**
