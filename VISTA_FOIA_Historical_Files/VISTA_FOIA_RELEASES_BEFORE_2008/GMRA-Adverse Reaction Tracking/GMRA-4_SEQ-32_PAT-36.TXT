$TXT Created by NABER,DAVID A at DEVCUR.FO-SLC.MED.VA.GOV  (KIDS) on Thursday, 02/01/07 at 13:50
=============================================================================
Run Date: MAR 20, 2007                     Designation: GMRA*4*36
Package : GMRA - ADVERSE REACTION TRACKING    Priority: Mandatory
Version : 4        SEQ #32                      Status: Released
                  Compliance Date: APR 20, 2007
=============================================================================

Associated patches: (v)GMRA*4*23   <<= must be installed BEFORE `GMRA*4*36'
                    (v)GMRA*4*25   <<= must be installed BEFORE `GMRA*4*36'

Subject: Remove ability to delete allergy records

Category: 
  - Routine
  - Data Dictionary
  - Other

Description:
============

 Due to potential updates to the HDR it is highly recommended that this 
 patch be installed during off-hours. Users may remain on the system but 
 an off-hours installation is highly encouraged.
  
 Clear Quest/Remedy/PSIs
 -----------------------
 CQ 6683 - ID BAND marked question asked multiple times.  This question is 
 now asked only one time per allergy entered.
  
 CQ 8690 - ALLERGY TYPE (3.1) field in PATIENT ALLERGIES (120.8) file is
 not updated when the associated entry in the GMR ALLERGIES (120.82) file
 is changed.  Code has been modified so that when the ALLERGY TYPE (1)
 field in the GMR ALLERGIES (120.82) file is updated so is the same field
 in the PATIENT ALLERGIES (120.8) file. In addition, the post-install 
 routine GMRAY36 will make sure all GMR ALLERGIES (120.82) file entries are
 in synch.
  
 CQ 12731 - An allergy assessment message is sent to the HDR when a user 
 enters an up-arrow or blank return when prompted with the "does this 
 patient have any allergies" prompt in the roll and scroll environment.  
 The system currently creates an entry in the ADVERSE REACTION ASSESSMENT 
 file (120.86) before the user enters their response to the question.  If 
 the user enters an up-arrow or hits return then the entry is deleted, 
 which causes the HL7 message to be sent to the HDR.  The entry will now 
 only be created after the user answers the question.
  
 Files Updated
 -------------
 120.82 - GMR ALLERGIES, updated to have a new cross-reference so changes
 to the ALLERGY TYPE (1) field propagate through all allergy entries.  
 Also, the DRUG INGREDIENTS (4) multiple is modified so only primary
 ingredients can be chosen.
  
 Test Sites
 ----------
 Palo Alto
 Biloxi
 Minneapolis
 Fargo
 Tomah
  
 Previously, if a user edited an existing allergy in VISTA that had the
 ORIGINATOR SIGN OFF (15) field in the PATIENT ALLERGIES (120.8) file set
 to no, the user would be given the option to delete the entry.
  
 With the Health Data Repository (HDR) now in place for allergies, 
 deletions of data that are already part of the HDR cannot be allowed.  As 
 a result, any existing allergy that hasn't been "signed off" will be
 marked entered in error if the user chooses to "delete" the entry.
  
 In a previously released patch, a post-installation routine identified 
 allergy entries that should have been auto-verified but weren't due to a 
 logic issue.  Those entries were then auto-verified as they should have 
 been.  When those entries were auto-verified the ORIGINATOR SIGN OFF (15) 
 field in the PATIENT ALLERGIES (120.8) file should have been set to yes.  
 A post-install routine, GMRAY36, has been added to this patch to identify
 and fix any auto-verified allergies that have the ORIGINATOR SIGN OFF (15)
 field set to no.
  
 The post-install will also review existing allergy entries to make sure 
 that the ALLERGY TYPE (3.1) field in the PATIENT ALLERGIES (120.8) file is
 consistent with its corresponding entry in the GMR ALLERGIES (120.82) 
 file. Prior to this patch, any changes to the ALLERGY TYPE (1) field in
 GMR ALLERGIES (120.82) file made by the standardization team would not
 have updated existing patient allergies.  The ALLERGY TYPE (1) field in
 the GMR ALLERGIES (120.82) file has also been updated to include a new
 style cross-reference that will now update existing patient allergies
 should the value change. The new style cross-reference will be added
 during the post-install.
  
 The post-install will also make sure that the name of the reactant that is
 stored in the PATIENT ALLERGIES (120.8) file matches the name of the
 reactant from the GMR ALLERGIES (120.82) file.  Prior to standardization
 it was possible for a site to change the name of a locally entered allergy
 without that change updating existing allergies.  The post install will
 check existing allergies associated with the GMR ALLERGIES (120.82) file
 and make sure the reactant field matches the name of the allergy.
  
 The post-install will also identify any patient allergies that are 
 associated with an entry from the GMR ALLERGIES (120.82) file that is 
 inactive and convert it to a free text entry.
  
 Finally, the post-install will check for patient allergies that are 
 associated with the DRUG (50) file. While the DRUG (50) file may no longer
 be selected from, there are pre-standardization entries that may be
 pointing to locally created entries in the DRUG (50) file that did not
 have ingredient and/or drug class information.  In cases where the entry
 doesn't have appropriate drug information the allergy will be converted to
 a free text entry.  
  
 A mail message will be sent to the installer indicating the total number 
 of entries that were converted to free text. When patch GMRA*4*29, 
 currently in testing, is installed most of the entries that were 
 converted to free text will be automatically updated to a standardized 
 term.  As a result, you do not need to take any action on the newly 
 created free text entries at this time.
  
 This patch updates the GMR ALLERGIES (120.82) file so that the DRUG
 INGREDIENTS (4) multiple will only allow primary ingredients to be
 selected. The DRUG INGREDIENTS (2) multiple in the PATIENT ALLERGIES 
 (120.8) file has had this restriction for quite some time.  This update
 will get them in synch.  As the GMR ALLERGIES (120.82) file is
 standardized, this change has effectively been in place since
 standardization but this will assure compliance.
  
 This patch also fixes the problem where a user may have been asked the 
 "have the ID BANDS been marked" question more than once when entering or 
 verifying allergies in the roll and scroll environment.
  
 During internal testing, it was noted that in the roll and scroll package,
 when the user is asked "does the patient have any known allergies or
 adverse reactions" an entry is created in the ADVERSE REACTION ASSESSMENT
 (120.86) file before the question is asked.  If the user hits return or
 enters an ^ the entry is then deleted from the file.  This causes
 unnecessary traffic to the HDR.  The entry is now created after the
 question is answered by the user.
  
 INSTALLATION
 ============
  
 NOTE:
  
 ************************************************************************
 A mail message will be sent to the installer indicating the total number 
 of entries that were converted to free text. When patch GMRA*4*29, 
 currently in testing, is installed most of the entries that were 
 converted to free text will be automatically updated to a standardized 
 term.  As a result, you do not need to take any action on the newly 
 created free text entries at this time.
 ************************************************************************
  
 This patch may be installed with users on the system although it is 
 highly recommended that it be installed during non-peak hours to minimize 
 potential disruption to users entering allergy information during the 
 installation process.  This patch should take less than 2 minutes to 
 install.
  
 1.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
  
 2.  From the Kernel Installation and Distribution System Menu, select
     the Installation menu.
  
 3.  From this menu, you may elect to use the following options
     (when prompted for INSTALL NAME, enter GMRA*4.0*36):
         a.  Backup a Transport Global
         b.  Compare Transport Global to Current System
         c.  Verify Checksums in Transport Global
  
 4.  Use the Install Package(s) option and select the package GMRA*4.0*36.
  
 5.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? YES//',
     you may respond NO.
  
 6.  When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
     Protocols? YES//', respond NO.
  
 7.  If prompted 'Delay Install (Minutes):  (0-60): 0//; respond '0'.
  
 ROUTINE SUMMARY:
 ================
 The following is a list of the routine(s) included in this patch.  The
 second line of each of these routine(s) will look like:
  
     <tab>;;4.0;Adverse Reaction Tracking;**[patch list]**;Mar 29, 1996
  
                            CHECK^XTSUMBLD results 
 Routine name         Before Patch          After Patch         Patch List
 ============         ============          ===========         ==========
 GMRADEL              2952383               4238070                 36
 GMRAGUI1             17409478              17480835             21,25,36
 GMRAMCB              6502842               6919400                21,36
 GMRANKA              6768620               6543144               2,21,36
 GMRAPEM0             14463993              14058325           2,5,17,21,36
 GMRAPEM3             2212104               2418313                 36
 GMRASIG1             8238942               8507536             2,17,21,36
 GMRASIGN             14487255              14910364             17,19,36
 GMRAUTL2             24232551              25261796               23,36
 GMRAY36                N/A                 10907615                36
 GMRAY36A               N/A                 1203129                 36

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: GMRADEL
    Before:  B8878805  After: B12620688  **36**
Routine Name: GMRAGUI1
    Before: B56901114  After: B56993804  **21,25,36**
Routine Name: GMRAMCB
    Before: B10298543  After: B10933598  **21,36**
Routine Name: GMRANKA
    Before: B15425405  After: B12980471  **2,21,36**
Routine Name: GMRAPEM0
    Before: B44377298  After: B43826251  **2,5,17,21,36**
Routine Name: GMRAPEM3
    Before:  B2842314  After:  B3076909  **36**
Routine Name: GMRASIG1
    Before: B15349456  After: B16149250  **2,17,21,36**
Routine Name: GMRASIGN
    Before: B37583197  After: B40714673  **17,19,36**
Routine Name: GMRAUTL2
    Before: B71296835  After: B79798893  **23,36**
Routine Name: GMRAY36
    Before:       n/a  After: B23667730  **36**
Routine Name: GMRAY36A
    Before:       n/a  After:  B1688077  **36**

=============================================================================
User Information:
Entered By  : NABER,DAVID A                 Date Entered  : MAR 20, 2006
Completed By: SCHLEHUBER,PAM                Date Completed: MAR 14, 2007
Released By : HEMBREE,SUSAN                 Date Released : MAR 20, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
