Released PRCA*4.5*245 SEQ #224
Extracted from mail message
**KIDS**:PRCA*4.5*245^

**INSTALL NAME**
PRCA*4.5*245
"BLD",6896,0)
PRCA*4.5*245^ACCOUNTS RECEIVABLE^0^3070214^y
"BLD",6896,1,0)
^^5^5^3070214^
"BLD",6896,1,1,0)
This patch is being released in conjunction with the Pharmacy 
"BLD",6896,1,2,0)
Reengineering Encapsulation effort. While no new functionality for the 
"BLD",6896,1,3,0)
Integrated Billing package is released with this patch, all direct global 
"BLD",6896,1,4,0)
references to the Outpatient Pharmacy files have been replaced by this 
"BLD",6896,1,5,0)
effort.
"BLD",6896,4,0)
^9.64PA^^
"BLD",6896,6.3)
7
"BLD",6896,"KRN",0)
^9.67PA^8989.52^19
"BLD",6896,"KRN",.4,0)
.4
"BLD",6896,"KRN",.401,0)
.401
"BLD",6896,"KRN",.402,0)
.402
"BLD",6896,"KRN",.403,0)
.403
"BLD",6896,"KRN",.5,0)
.5
"BLD",6896,"KRN",.84,0)
.84
"BLD",6896,"KRN",3.6,0)
3.6
"BLD",6896,"KRN",3.8,0)
3.8
"BLD",6896,"KRN",9.2,0)
9.2
"BLD",6896,"KRN",9.8,0)
9.8
"BLD",6896,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6896,"KRN",9.8,"NM",1,0)
RCXVDC5^^0^B23162984
"BLD",6896,"KRN",9.8,"NM","B","RCXVDC5",1)

"BLD",6896,"KRN",19,0)
19
"BLD",6896,"KRN",19.1,0)
19.1
"BLD",6896,"KRN",101,0)
101
"BLD",6896,"KRN",409.61,0)
409.61
"BLD",6896,"KRN",771,0)
771
"BLD",6896,"KRN",870,0)
870
"BLD",6896,"KRN",8989.51,0)
8989.51
"BLD",6896,"KRN",8989.52,0)
8989.52
"BLD",6896,"KRN",8994,0)
8994
"BLD",6896,"KRN","B",.4,.4)

"BLD",6896,"KRN","B",.401,.401)

"BLD",6896,"KRN","B",.402,.402)

"BLD",6896,"KRN","B",.403,.403)

"BLD",6896,"KRN","B",.5,.5)

"BLD",6896,"KRN","B",.84,.84)

"BLD",6896,"KRN","B",3.6,3.6)

"BLD",6896,"KRN","B",3.8,3.8)

"BLD",6896,"KRN","B",9.2,9.2)

"BLD",6896,"KRN","B",9.8,9.8)

"BLD",6896,"KRN","B",19,19)

"BLD",6896,"KRN","B",19.1,19.1)

"BLD",6896,"KRN","B",101,101)

"BLD",6896,"KRN","B",409.61,409.61)

"BLD",6896,"KRN","B",771,771)

"BLD",6896,"KRN","B",870,870)

"BLD",6896,"KRN","B",8989.51,8989.51)

"BLD",6896,"KRN","B",8989.52,8989.52)

"BLD",6896,"KRN","B",8994,8994)

"BLD",6896,"QUES",0)
^9.62^^
"BLD",6896,"REQB",0)
^9.611^2^2
"BLD",6896,"REQB",1,0)
PRCA*4.5*248^1
"BLD",6896,"REQB",2,0)
PSO*7.0*245^1
"BLD",6896,"REQB","B","PRCA*4.5*248",1)

"BLD",6896,"REQB","B","PSO*7.0*245",2)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
245^3070214
"PKG",142,22,1,"PAH",1,1,0)
^^5^5^3070214
"PKG",142,22,1,"PAH",1,1,1,0)
This patch is being released in conjunction with the Pharmacy 
"PKG",142,22,1,"PAH",1,1,2,0)
Reengineering Encapsulation effort. While no new functionality for the 
"PKG",142,22,1,"PAH",1,1,3,0)
Integrated Billing package is released with this patch, all direct global 
"PKG",142,22,1,"PAH",1,1,4,0)
references to the Outpatient Pharmacy files have been replaced by this 
"PKG",142,22,1,"PAH",1,1,5,0)
effort.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RCXVDC5")
0^1^B23162984^B19627552
"RTN","RCXVDC5",1,0)
RCXVDC5 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC5",2,0)
 ;;4.5;Accounts Receivable;**201,227,228,240,243,248,245**;Mar 20, 1995;Build 7
"RTN","RCXVDC5",3,0)
 ;
"RTN","RCXVDC5",4,0)
 ; Integrated Billing Action File (# 350) 
"RTN","RCXVDC5",5,0)
 Q
"RTN","RCXVDC5",6,0)
D350 ; 
"RTN","RCXVDC5",7,0)
 NEW RCXVD,RCXVDA,RCXVDB,RCXVD0A,RCXVDT,RCXVP1,RCXVP2,RCXVPC,RCT
"RTN","RCXVDC5",8,0)
 NEW RCIBVD,RCIBAD,RCIBDD,RCIBSL,RCIBBG,RCIBPE,RCXVNPI
"RTN","RCXVDC5",9,0)
 S RCXVD0A="",RCT=0
"RTN","RCXVDC5",10,0)
 F  S RCXVD0A=$O(^IB("ABIL",RCXVBLNA,RCXVD0A)) Q:RCXVD0A=""  D
"RTN","RCXVDC5",11,0)
 . S RCXVD=$G(^IB(RCXVD0A,0))
"RTN","RCXVDC5",12,0)
 . I $G(DFN)="" S DFN=$P(RCXVD,U,2)
"RTN","RCXVDC5",13,0)
 . ;
"RTN","RCXVDC5",14,0)
 . S RCXVDA=RCXVBLNA_RCXVU_$P(RCXVD,U,1)
"RTN","RCXVDC5",15,0)
 . S RCXVDA=RCXVDA_RCXVU_$$GET1^DIQ(350,RCXVD0A_",",.05,"E")
"RTN","RCXVDC5",16,0)
 . S RCXVP1=$P(RCXVD,U,3),RCXVP2=""
"RTN","RCXVDC5",17,0)
 . I RCXVP1'="" S RCXVP2=$P($G(^IBE(350.1,RCXVP1,0)),U,1)
"RTN","RCXVDC5",18,0)
 . S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; ACTION TYPE (P)
"RTN","RCXVDC5",19,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,6) ; UNITS
"RTN","RCXVDC5",20,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,7) ; TOTAL CHARGE
"RTN","RCXVDC5",21,0)
 . S RCXVDT=$P(RCXVD,U,14)
"RTN","RCXVDC5",22,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT BILLD FROM
"RTN","RCXVDC5",23,0)
 . S RCXVDT=$P(RCXVD,U,15)
"RTN","RCXVDC5",24,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT BILLD TO
"RTN","RCXVDC5",25,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,11) ; AR BILL #
"RTN","RCXVDC5",26,0)
 . S RCXVDT=$P($P($G(^IB(RCXVD0A,1)),U,2),".",1)
"RTN","RCXVDC5",27,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT ENTRY ADDED
"RTN","RCXVDC5",28,0)
 . S RCXVDA=RCXVDA_RCXVU_$P($G(^DPT(DFN,0)),U,9) ; SSN
"RTN","RCXVDC5",29,0)
 . S RCXVDT=$P(RCXVD,U,17)
"RTN","RCXVDC5",30,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; EVENT DT
"RTN","RCXVDC5",31,0)
 . S RCXVDT=$$PRESC($P(RCXVD,U,4))
"RTN","RCXVDC5",32,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ;FILL/REFILL DATE
"RTN","RCXVDC5",33,0)
 . S (RCIBVD,RCIBAD,RCIBDD)="" D
"RTN","RCXVDC5",34,0)
       ..S RCIBSL=$P(RCXVD,U,4) Q:+RCIBSL=52
"RTN","RCXVDC5",35,0)
       ..S RCIBBG=$P($G(^IBE(350.1,+$P(RCXVD,"^",3),0)),"^",11)
"RTN","RCXVDC5",36,0)
       ..I RCIBBG=4 S RCXVDT=$P(RCXVD,U,14),RCIBVD=$E($$HLDATE^HLFNC(RCXVDT),1,8) Q
"RTN","RCXVDC5",37,0)
       ..S RCIBPE=$G(^IB(+$P(RCXVD,"^",16),0))
"RTN","RCXVDC5",38,0)
       ..I +RCIBSL'=405,+RCIBSL'=45 S RCIBSL=$P(RCIBPE,"^",4)
"RTN","RCXVDC5",39,0)
       ..I +RCIBSL=405!(+RCIBSL=45) D INP
"RTN","RCXVDC5",40,0)
       ..Q
"RTN","RCXVDC5",41,0)
 . ;add outpatient visit date, inp. admission date, inp. discharge date
"RTN","RCXVDC5",42,0)
 . S RCXVDA=RCXVDA_RCXVU_RCIBVD_RCXVU_RCIBAD_RCXVU_RCIBDD
"RTN","RCXVDC5",43,0)
 . S RCXVNPI="",RCXVDA=RCXVDA_RCXVU_$$SITE(RCXVD0A,1)_RCXVU_RCXVNPI ;DIVISION WHERE CARE RENDERED^DIVISION NPI
"RTN","RCXVDC5",44,0)
 . S RCT=RCT+1
"RTN","RCXVDC5",45,0)
 . S ^TMP($J,RCXVBLN,"5-350A",RCT)=RCXVDA
"RTN","RCXVDC5",46,0)
 Q
"RTN","RCXVDC5",47,0)
 ;
"RTN","RCXVDC5",48,0)
PRESC(RCPC4) ;Calculates prescription fill/refill date
"RTN","RCXVDC5",49,0)
 ; Input is resulting from field (4th piece of 0 node) in 350
"RTN","RCXVDC5",50,0)
 ; Output is fill/refill date in fileman format
"RTN","RCXVDC5",51,0)
 N RCRXN,RCRF,RCPRDT,PSOFILE,DIC,DR,DA,DIQ,RCX
"RTN","RCXVDC5",52,0)
 S RCPRDT=""
"RTN","RCXVDC5",53,0)
 I $P(RCPC4,":")'=52 Q RCPRDT
"RTN","RCXVDC5",54,0)
 S RCRXN=+$P(RCPC4,":",2),RCRF=$P(RCPC4,":",3)
"RTN","RCXVDC5",55,0)
 ;Set variables for DIQ^PSODI call
"RTN","RCXVDC5",56,0)
 S PSOFILE=52
"RTN","RCXVDC5",57,0)
 S DIC=52
"RTN","RCXVDC5",58,0)
 S DIQ="RCX"
"RTN","RCXVDC5",59,0)
 S DIQ(0)="I"
"RTN","RCXVDC5",60,0)
 I RCRF>0 D
"RTN","RCXVDC5",61,0)
 .S DR=52
"RTN","RCXVDC5",62,0)
 .S DR(52.1)="17"
"RTN","RCXVDC5",63,0)
 .S DA=RCRXN
"RTN","RCXVDC5",64,0)
 .S DA(52.1)=RCRF
"RTN","RCXVDC5",65,0)
 .D DIQ^PSODI(PSOFILE,DIC,.DR,.DA,.DIQ)
"RTN","RCXVDC5",66,0)
 .S RCPRDT=$G(RCX(52.1,DA(52.1),17,"I"))
"RTN","RCXVDC5",67,0)
 E  D
"RTN","RCXVDC5",68,0)
 .S DR=31
"RTN","RCXVDC5",69,0)
 .S DA=+RCRXN
"RTN","RCXVDC5",70,0)
 .D DIQ^PSODI(PSOFILE,DIC,DR,DA,.DIQ)
"RTN","RCXVDC5",71,0)
 .S RCPRDT=$G(RCX(52,DA,31,"I"))
"RTN","RCXVDC5",72,0)
 S RCPRDT=$P(RCPRDT,".")
"RTN","RCXVDC5",73,0)
 ;Return refill date without time
"RTN","RCXVDC5",74,0)
 Q RCPRDT
"RTN","RCXVDC5",75,0)
INP ; get inpatient admission and discharge date
"RTN","RCXVDC5",76,0)
 N PM,PM0,X,X1,X2
"RTN","RCXVDC5",77,0)
 I +RCIBSL=405 D
"RTN","RCXVDC5",78,0)
    .S PM=+$P(RCIBSL,":",2),PM0=$G(^DGPM(PM,0))
"RTN","RCXVDC5",79,0)
    .S RCIBAD=$S(PM0:+PM0\1,1:$P(RCIBPE,"^",17))
"RTN","RCXVDC5",80,0)
    .S RCIBAD=$E($$HLDATE^HLFNC(RCIBAD),1,8)
"RTN","RCXVDC5",81,0)
    .S RCIBDD=$S(PM0:$S($D(^DGPM(+$P(PM0,"^",17),0)):+^(0)\1,1:""),1:"")
"RTN","RCXVDC5",82,0)
    .S RCIBDD=$E($$HLDATE^HLFNC(RCIBDD),1,8)
"RTN","RCXVDC5",83,0)
 I +RCIBSL=45 D
"RTN","RCXVDC5",84,0)
    .S PM=+$P(RCIBSL,":",2),PM0=$G(^DGPT(PM,0))
"RTN","RCXVDC5",85,0)
    .S RCIBAD=$S(PM0:+$P(PM0,"^",2)\1,1:$P(RCIBPE,"^",17))
"RTN","RCXVDC5",86,0)
    .S RCIBAD=$E($$HLDATE^HLFNC(RCIBAD),1,8)
"RTN","RCXVDC5",87,0)
    .S RCIBDD=$S($G(^DGPT(PM,70)):+^(70)\1,1:"")
"RTN","RCXVDC5",88,0)
    .S RCIBDD=$E($$HLDATE^HLFNC(RCIBDD),1,8)
"RTN","RCXVDC5",89,0)
 Q
"RTN","RCXVDC5",90,0)
SITE(IIEN,FLG) ;  Find the Care Site for Co-Pays
"RTN","RCXVDC5",91,0)
 ;  Input Parameters
"RTN","RCXVDC5",92,0)
 ;    IIEN = Internal Entry Number for IB ACTION #350
"RTN","RCXVDC5",93,0)
 ;    FLG = 1=Division Name,2=Facility Number
"RTN","RCXVDC5",94,0)
 ;
"RTN","RCXVDC5",95,0)
 NEW VDIV,VFAC,VWIEN,VWFIL,VVIS,VLOC,VWARD,VLVAL,VWHER
"RTN","RCXVDC5",96,0)
 S VWHER=$P(^IB(IIEN,0),U,4)
"RTN","RCXVDC5",97,0)
 ;
"RTN","RCXVDC5",98,0)
 I VWHER="" Q ""
"RTN","RCXVDC5",99,0)
 ;
"RTN","RCXVDC5",100,0)
 S VWFIL=$P(VWHER,":",1),VWIEN=$P(VWHER,":",2)
"RTN","RCXVDC5",101,0)
 I VWIEN[";" S VWIEN=$P(VWIEN,";",1)
"RTN","RCXVDC5",102,0)
 ;
"RTN","RCXVDC5",103,0)
 S VLVAL=""
"RTN","RCXVDC5",104,0)
MV I VWFIL=405 D
"RTN","RCXVDC5",105,0)
 . I VWIEN="" Q
"RTN","RCXVDC5",106,0)
 . S VWARD=$P($G(^DGPM(VWIEN,0)),U,6)
"RTN","RCXVDC5",107,0)
 . I VWARD="" Q
"RTN","RCXVDC5",108,0)
 . S VLOC=$P($G(^DIC(42,VWARD,44)),U,1)
"RTN","RCXVDC5",109,0)
 . I VLOC="" Q
"RTN","RCXVDC5",110,0)
 . S VDIV=$P($G(^SC(VLOC,0)),U,15)
"RTN","RCXVDC5",111,0)
 . I VDIV="" Q
"RTN","RCXVDC5",112,0)
 . D VLU
"RTN","RCXVDC5",113,0)
 ;
"RTN","RCXVDC5",114,0)
OP I VWFIL=409.68 D
"RTN","RCXVDC5",115,0)
 . S VLOC=$P($G(^SCE(VWIEN,0)),U,4)
"RTN","RCXVDC5",116,0)
 . I VLOC="" D
"RTN","RCXVDC5",117,0)
 .. S VVIS=$P($G(^SCE(VWIEN,0)),U,5)
"RTN","RCXVDC5",118,0)
 .. I VVIS="" Q
"RTN","RCXVDC5",119,0)
 .. S VLOC=$P($G(^AUPNVSIT(VVIS,0)),U,22)
"RTN","RCXVDC5",120,0)
 . I VLOC="" Q
"RTN","RCXVDC5",121,0)
 . S VDIV=$P($G(^SC(VLOC,0)),U,15)
"RTN","RCXVDC5",122,0)
 . I VDIV="" Q
"RTN","RCXVDC5",123,0)
 . D VLU
"RTN","RCXVDC5",124,0)
 ;
"RTN","RCXVDC5",125,0)
RX I VWFIL=52 D
"RTN","RCXVDC5",126,0)
 .N PSOFILE,DIC,DR,DA,DIQ,RCX
"RTN","RCXVDC5",127,0)
 .S PSOFILE=52
"RTN","RCXVDC5",128,0)
 .S DIC=52
"RTN","RCXVDC5",129,0)
 .S DA=VWIEN
"RTN","RCXVDC5",130,0)
 .S DR=5
"RTN","RCXVDC5",131,0)
 .S DIQ="RCX"
"RTN","RCXVDC5",132,0)
 .S DIQ(0)="I"
"RTN","RCXVDC5",133,0)
 .D DIQ^PSODI(PSOFILE,DIC,DR,DA,.DIQ)
"RTN","RCXVDC5",134,0)
 .S VLOC=$G(RCX(PSOFILE,DA,DR,"I"))
"RTN","RCXVDC5",135,0)
 .I VLOC="" Q
"RTN","RCXVDC5",136,0)
 .S VDIV=$P($G(^SC(VLOC,0)),U,15)
"RTN","RCXVDC5",137,0)
 .I VDIV="" Q
"RTN","RCXVDC5",138,0)
 .D VLU
"RTN","RCXVDC5",139,0)
 ;
"RTN","RCXVDC5",140,0)
LC I VWFIL=44 D
"RTN","RCXVDC5",141,0)
 . S VDIV=$P($G(^SC(VWIEN,0)),U,15)
"RTN","RCXVDC5",142,0)
 . I VDIV="" Q
"RTN","RCXVDC5",143,0)
 . D VLU
"RTN","RCXVDC5",144,0)
 ;
"RTN","RCXVDC5",145,0)
IB I VWFIL=350 D
"RTN","RCXVDC5",146,0)
 . S VFAC=$P($G(^IB(VWIEN,0)),U,13)
"RTN","RCXVDC5",147,0)
 . I VFAC="" Q
"RTN","RCXVDC5",148,0)
 . S VDIV=$O(^DG(40.8,"C",VFAC,""))
"RTN","RCXVDC5",149,0)
 . I VDIV="" Q
"RTN","RCXVDC5",150,0)
 . D VLU
"RTN","RCXVDC5",151,0)
 ;
"RTN","RCXVDC5",152,0)
 Q VLVAL
"RTN","RCXVDC5",153,0)
 ;
"RTN","RCXVDC5",154,0)
VLU I FLG=1 S VLVAL=$P(^DG(40.8,VDIV,0),U,1)
"RTN","RCXVDC5",155,0)
 I FLG=2 S VLVAL=$P(^DG(40.8,VDIV,0),U,2)
"RTN","RCXVDC5",156,0)
 I $G(VLVAL)'=""&($G(VDIV)'="") S RCXVNPI=$G(^DIC(4,$P(^DG(40.8,VDIV,0),U,7),"NPI"))
"RTN","RCXVDC5",157,0)
 Q
"VER")
8.0^22.0
"BLD",6896,6)
^224
**END**
**END**
