Released ICD*18*17 SEQ #17
Extracted from mail message
**KIDS**:ICD*18.0*17^

**INSTALL NAME**
ICD*18.0*17
"BLD",6108,0)
ICD*18.0*17^DRG GROUPER^0^3050627^y
"BLD",6108,1,0)
^^16^16^3050622^
"BLD",6108,1,1,0)
  This patch 1) adds data to the Identifier field (#2) of three 
"BLD",6108,1,2,0)
ICD OPERATION/PROCEDURE file (#80.1) records, 2) adds a DRG 
"BLD",6108,1,3,0)
calculation for bone marrow transplants, 3) corrects the
"BLD",6108,1,4,0)
DRG code associated with diagnosis 309.81 to be DRG 427,
"BLD",6108,1,5,0)
4) corrects the DRG codes associated with procedure code 51.23,
"BLD",6108,1,6,0)
5) removes the entry under DRG Grouper Effective Date for
"BLD",6108,1,7,0)
October 1,2004 for operation code 80.51, 6) removes the "F"
"BLD",6108,1,8,0)
from the Identifier field (#2) of ICD OPERATION/PROCEDURE
"BLD",6108,1,9,0)
FILE (#80.1) for code 81.61, 7) associates the correct DRG 
"BLD",6108,1,10,0)
when using operation/procedure code 96.72, 8) associates the
"BLD",6108,1,11,0)
correct DRG when using diagnosis 402.91 or 428.32 with card 
"BLD",6108,1,12,0)
cath procedures, 9) associates the correct DRG when using 
"BLD",6108,1,13,0)
operation/procedure 01.59, and reviews DRG 1,2,3,528 and 543
"BLD",6108,1,14,0)
for proper assignment, 10) corrects the MDC field (#5)
"BLD",6108,1,15,0)
for diagnosis 250.70, 11) Adds missing data to diagnosis 428.0 
"BLD",6108,1,16,0)
(Congestive Heart Failure Unspecified)
"BLD",6108,4,0)
^9.64PA^^
"BLD",6108,6)
11^
"BLD",6108,"INI")
ICD1817P
"BLD",6108,"INID")
n^^n
"BLD",6108,"INIT")

"BLD",6108,"KRN",0)
^9.67PA^8989.52^19
"BLD",6108,"KRN",.4,0)
.4
"BLD",6108,"KRN",.401,0)
.401
"BLD",6108,"KRN",.402,0)
.402
"BLD",6108,"KRN",.403,0)
.403
"BLD",6108,"KRN",.5,0)
.5
"BLD",6108,"KRN",.84,0)
.84
"BLD",6108,"KRN",3.6,0)
3.6
"BLD",6108,"KRN",3.8,0)
3.8
"BLD",6108,"KRN",9.2,0)
9.2
"BLD",6108,"KRN",9.8,0)
9.8
"BLD",6108,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",6108,"KRN",9.8,"NM",1,0)
ICDDRG0^^0^B31829517
"BLD",6108,"KRN",9.8,"NM",2,0)
ICDGTDRG^^0^B50975145
"BLD",6108,"KRN",9.8,"NM",3,0)
ICDREF^^0^B1396078
"BLD",6108,"KRN",9.8,"NM",4,0)
ICDDRG1^^0^B2858628
"BLD",6108,"KRN",9.8,"NM",5,0)
ICDTLB1A^^0^B17763950
"BLD",6108,"KRN",9.8,"NM",6,0)
ICDTLB6A^^0^B36834501
"BLD",6108,"KRN",9.8,"NM","B","ICDDRG0",1)

"BLD",6108,"KRN",9.8,"NM","B","ICDDRG1",4)

"BLD",6108,"KRN",9.8,"NM","B","ICDGTDRG",2)

"BLD",6108,"KRN",9.8,"NM","B","ICDREF",3)

"BLD",6108,"KRN",9.8,"NM","B","ICDTLB1A",5)

"BLD",6108,"KRN",9.8,"NM","B","ICDTLB6A",6)

"BLD",6108,"KRN",19,0)
19
"BLD",6108,"KRN",19.1,0)
19.1
"BLD",6108,"KRN",101,0)
101
"BLD",6108,"KRN",409.61,0)
409.61
"BLD",6108,"KRN",771,0)
771
"BLD",6108,"KRN",870,0)
870
"BLD",6108,"KRN",8989.51,0)
8989.51
"BLD",6108,"KRN",8989.52,0)
8989.52
"BLD",6108,"KRN",8994,0)
8994
"BLD",6108,"KRN","B",.4,.4)

"BLD",6108,"KRN","B",.401,.401)

"BLD",6108,"KRN","B",.402,.402)

"BLD",6108,"KRN","B",.403,.403)

"BLD",6108,"KRN","B",.5,.5)

"BLD",6108,"KRN","B",.84,.84)

"BLD",6108,"KRN","B",3.6,3.6)

"BLD",6108,"KRN","B",3.8,3.8)

"BLD",6108,"KRN","B",9.2,9.2)

"BLD",6108,"KRN","B",9.8,9.8)

"BLD",6108,"KRN","B",19,19)

"BLD",6108,"KRN","B",19.1,19.1)

"BLD",6108,"KRN","B",101,101)

"BLD",6108,"KRN","B",409.61,409.61)

"BLD",6108,"KRN","B",771,771)

"BLD",6108,"KRN","B",870,870)

"BLD",6108,"KRN","B",8989.51,8989.51)

"BLD",6108,"KRN","B",8989.52,8989.52)

"BLD",6108,"KRN","B",8994,8994)

"BLD",6108,"PRE")
ICD1817E
"BLD",6108,"QUES",0)
^9.62^^
"BLD",6108,"REQB",0)
^9.611^1^1
"BLD",6108,"REQB",1,0)
ICD*18.0*14^1
"BLD",6108,"REQB","B","ICD*18.0*14",1)

"INI")
ICD1817P
"MBREQ")
0
"PKG",151,-1)
1^1
"PKG",151,0)
DRG GROUPER^ICD^DRG GROUPER
"PKG",151,20,0)
^9.402P^^
"PKG",151,22,0)
^9.49I^1^1
"PKG",151,22,1,0)
18.0^3001024^3010118^66481
"PKG",151,22,1,"PAH",1,0)
17^3050627^100850
"PKG",151,22,1,"PAH",1,1,0)
^^16^16^3050627
"PKG",151,22,1,"PAH",1,1,1,0)
  This patch 1) adds data to the Identifier field (#2) of three 
"PKG",151,22,1,"PAH",1,1,2,0)
ICD OPERATION/PROCEDURE file (#80.1) records, 2) adds a DRG 
"PKG",151,22,1,"PAH",1,1,3,0)
calculation for bone marrow transplants, 3) corrects the
"PKG",151,22,1,"PAH",1,1,4,0)
DRG code associated with diagnosis 309.81 to be DRG 427,
"PKG",151,22,1,"PAH",1,1,5,0)
4) corrects the DRG codes associated with procedure code 51.23,
"PKG",151,22,1,"PAH",1,1,6,0)
5) removes the entry under DRG Grouper Effective Date for
"PKG",151,22,1,"PAH",1,1,7,0)
October 1,2004 for operation code 80.51, 6) removes the "F"
"PKG",151,22,1,"PAH",1,1,8,0)
from the Identifier field (#2) of ICD OPERATION/PROCEDURE
"PKG",151,22,1,"PAH",1,1,9,0)
FILE (#80.1) for code 81.61, 7) associates the correct DRG 
"PKG",151,22,1,"PAH",1,1,10,0)
when using operation/procedure code 96.72, 8) associates the
"PKG",151,22,1,"PAH",1,1,11,0)
correct DRG when using diagnosis 402.91 or 428.32 with card 
"PKG",151,22,1,"PAH",1,1,12,0)
cath procedures, 9) associates the correct DRG when using 
"PKG",151,22,1,"PAH",1,1,13,0)
operation/procedure 01.59, and reviews DRG 1,2,3,528 and 543
"PKG",151,22,1,"PAH",1,1,14,0)
for proper assignment, 10) corrects the MDC field (#5)
"PKG",151,22,1,"PAH",1,1,15,0)
for diagnosis 250.70, 11) Adds missing data to diagnosis 428.0 
"PKG",151,22,1,"PAH",1,1,16,0)
(Congestive Heart Failure Unspecified)
"PRE")
ICD1817E
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","ICD1817E")
0^^B732229
"RTN","ICD1817E",1,0)
ICD1817E ; BAY/JAT - ENVIRONMENT CHECK; 9/17/01 3:32pm ; 6/8/05 1:32pm
"RTN","ICD1817E",2,0)
 ;;18.0;DRG Grouper;**17**;Oct 13,2000
"RTN","ICD1817E",3,0)
 ;;
"RTN","ICD1817E",4,0)
EN ;
"RTN","ICD1817E",5,0)
 S XPDABORT=""
"RTN","ICD1817E",6,0)
 D PROGCHK(.XPDABORT)
"RTN","ICD1817E",7,0)
 I XPDABORT="" K XPDABORT
"RTN","ICD1817E",8,0)
 ;
"RTN","ICD1817E",9,0)
 Q
"RTN","ICD1817E",10,0)
 ;
"RTN","ICD1817E",11,0)
PROGCHK(XPDABORT) ;
"RTN","ICD1817E",12,0)
 I '$G(DUZ)!($G(DUZ(0))'="@")!('$G(DT))!($G(U)'="^") DO
"RTN","ICD1817E",13,0)
 .D BMES^XPDUTL("*****")
"RTN","ICD1817E",14,0)
 .D MES^XPDUTL("Your programming variables are not set up properly.")
"RTN","ICD1817E",15,0)
 .D MES^XPDUTL("Installation aborted.")
"RTN","ICD1817E",16,0)
 .D MES^XPDUTL("*****")
"RTN","ICD1817E",17,0)
 .S XPDABORT=2
"RTN","ICD1817E",18,0)
 .Q
"RTN","ICD1817E",19,0)
 Q
"RTN","ICD1817E",20,0)
 ;
"RTN","ICD1817P")
0^^B23818877
"RTN","ICD1817P",1,0)
ICD1817P ;;ALB/EG/JAT - CORRECT PROC CODES ; 6/27/05 1:03pm
"RTN","ICD1817P",2,0)
 ;;18.0;DRG Grouper;**17**;Oct 13,2000
"RTN","ICD1817P",3,0)
 ;
"RTN","ICD1817P",4,0)
 D CHGPROC
"RTN","ICD1817P",5,0)
 D CHGDIAG
"RTN","ICD1817P",6,0)
 Q
"RTN","ICD1817P",7,0)
 ;
"RTN","ICD1817P",8,0)
CHGPROC ;
"RTN","ICD1817P",9,0)
 D BMES^XPDUTL(">>>Modifying records in file 80.1")
"RTN","ICD1817P",10,0)
 ; modify Identifier field (#2) in file 80.1
"RTN","ICD1817P",11,0)
 N LINE,X,ICDPROC,ENTRY,DA,DIE,DR,IDENT,DIC
"RTN","ICD1817P",12,0)
 S LINE=1
"RTN","ICD1817P",13,0)
 F  S X=$T(REVP+LINE) S ICDPROC=$P(X,";;",2) Q:ICDPROC="EXIT"  D
"RTN","ICD1817P",14,0)
 .S ENTRY=+$O(^ICD0("BA",$P(ICDPROC,U)_" ",0)) I ENTRY D
"RTN","ICD1817P",15,0)
 ..S DA=ENTRY,DIE="^ICD0("
"RTN","ICD1817P",16,0)
 ..S IDENT=$P(ICDPROC,U,2)
"RTN","ICD1817P",17,0)
 ..S DR="2///^S X=IDENT"
"RTN","ICD1817P",18,0)
 ..D ^DIE
"RTN","ICD1817P",19,0)
 ..S LINE=LINE+1
"RTN","ICD1817P",20,0)
 ; kill 80.171 sub-file record and descendants for proc 80.51
"RTN","ICD1817P",21,0)
 N DA,DIK
"RTN","ICD1817P",22,0)
 S DA(1)=3867
"RTN","ICD1817P",23,0)
 S DA=2
"RTN","ICD1817P",24,0)
 S DIK="^ICD0("_DA(1)_",""2"","
"RTN","ICD1817P",25,0)
 D ^DIK
"RTN","ICD1817P",26,0)
 ; add Oct 1,2004 record to 80.171, MDC 1 to 80.1711, and 543
"RTN","ICD1817P",27,0)
 ; to 80.17111 for proc 01.14 ONLY 
"RTN","ICD1817P",28,0)
 S ENTRY=2963
"RTN","ICD1817P",29,0)
 ; check if already created in case patch being re-installed
"RTN","ICD1817P",30,0)
 I $D(^ICD0(ENTRY,2,2)) G SKIP
"RTN","ICD1817P",31,0)
 S DA(1)=ENTRY
"RTN","ICD1817P",32,0)
 S DIC="^ICD0("_DA(1)_",2,"
"RTN","ICD1817P",33,0)
 S DIC(0)="L"
"RTN","ICD1817P",34,0)
 S X=3041001 K DO D FILE^DICN K DIC,DA
"RTN","ICD1817P",35,0)
 S DA(2)=ENTRY
"RTN","ICD1817P",36,0)
 S DA(1)=2
"RTN","ICD1817P",37,0)
 S DIC="^ICD0("_DA(2)_",2,"_DA(1)_",1,"
"RTN","ICD1817P",38,0)
 S DIC(0)="L"
"RTN","ICD1817P",39,0)
 S X=1 K DO D FILE^DICN K DIC,DA
"RTN","ICD1817P",40,0)
 S DA(3)=ENTRY
"RTN","ICD1817P",41,0)
 S DA(2)=2
"RTN","ICD1817P",42,0)
 S DA(1)=1
"RTN","ICD1817P",43,0)
 S DIC="^ICD0("_DA(3)_",2,"_DA(2)_",1,"_DA(1)_",1,"
"RTN","ICD1817P",44,0)
 S DIC(0)="L"
"RTN","ICD1817P",45,0)
 S X=543 K DO D FILE^DICN K DIC,DA
"RTN","ICD1817P",46,0)
 ; add 80.17111 sub-file records to 80.1711 and 80.171 
"RTN","ICD1817P",47,0)
SKIP ;
"RTN","ICD1817P",48,0)
 S LINE=1
"RTN","ICD1817P",49,0)
 N Z
"RTN","ICD1817P",50,0)
 F  S Z=$T(REVPRO+LINE) S ICDPROC=$P(Z,";;",2) Q:ICDPROC="EXIT"  D
"RTN","ICD1817P",51,0)
 .S ENTRY=+$O(^ICD0("BA",$P(ICDPROC,U)_" ",0)) I ENTRY D
"RTN","ICD1817P",52,0)
 ..S DA(3)=ENTRY,DA(2)=2,DA(1)=1
"RTN","ICD1817P",53,0)
 ..S DIC="^ICD0("_DA(3)_",2,"_DA(2)_",1,"_DA(1)_",1,"
"RTN","ICD1817P",54,0)
 ..S DIC(0)="L"
"RTN","ICD1817P",55,0)
 ..; check if already created in case patch being re-installed
"RTN","ICD1817P",56,0)
 ..I $D(^ICD0(ENTRY,2,2,1,1,1,2,0)) S LINE=LINE+1 Q
"RTN","ICD1817P",57,0)
 ..; add DRG 1,2 and 3 
"RTN","ICD1817P",58,0)
 ..S X=1
"RTN","ICD1817P",59,0)
 ..K DO
"RTN","ICD1817P",60,0)
 ..D FILE^DICN
"RTN","ICD1817P",61,0)
 ..S X=2
"RTN","ICD1817P",62,0)
 ..D FILE^DICN
"RTN","ICD1817P",63,0)
 ..S X=3
"RTN","ICD1817P",64,0)
 ..D FILE^DICN
"RTN","ICD1817P",65,0)
 ..S LINE=LINE+1
"RTN","ICD1817P",66,0)
 Q
"RTN","ICD1817P",67,0)
 ;
"RTN","ICD1817P",68,0)
REVP ;
"RTN","ICD1817P",69,0)
 ;;36.12^Ob6
"RTN","ICD1817P",70,0)
 ;;36.13^Ob6
"RTN","ICD1817P",71,0)
 ;;36.14^Ob6
"RTN","ICD1817P",72,0)
 ;;51.23^TT
"RTN","ICD1817P",73,0)
 ;;81.61^O
"RTN","ICD1817P",74,0)
 ;;01.14^OQ
"RTN","ICD1817P",75,0)
 ;;02.13^OQK
"RTN","ICD1817P",76,0)
 ;;38.01^OQK
"RTN","ICD1817P",77,0)
 ;;38.11^OQK
"RTN","ICD1817P",78,0)
 ;;38.31^OQK
"RTN","ICD1817P",79,0)
 ;;38.41^OQK
"RTN","ICD1817P",80,0)
 ;;38.51^OQK
"RTN","ICD1817P",81,0)
 ;;38.61^OQK
"RTN","ICD1817P",82,0)
 ;;38.81^OQK
"RTN","ICD1817P",83,0)
 ;;39.28^OQK
"RTN","ICD1817P",84,0)
 ;;39.51^OQK
"RTN","ICD1817P",85,0)
 ;;39.52^OQK
"RTN","ICD1817P",86,0)
 ;;39.53^OQK
"RTN","ICD1817P",87,0)
 ;;39.72^OQK
"RTN","ICD1817P",88,0)
 ;;39.79^OQK
"RTN","ICD1817P",89,0)
 ;;EXIT
"RTN","ICD1817P",90,0)
 Q
"RTN","ICD1817P",91,0)
REVPRO ;
"RTN","ICD1817P",92,0)
 ;;01.59^
"RTN","ICD1817P",93,0)
 ;;01.12^
"RTN","ICD1817P",94,0)
 ;;01.14^
"RTN","ICD1817P",95,0)
 ;;01.15^
"RTN","ICD1817P",96,0)
 ;;01.18^
"RTN","ICD1817P",97,0)
 ;;01.19^
"RTN","ICD1817P",98,0)
 ;;01.21^
"RTN","ICD1817P",99,0)
 ;;01.22^
"RTN","ICD1817P",100,0)
 ;;01.23^
"RTN","ICD1817P",101,0)
 ;;01.24^
"RTN","ICD1817P",102,0)
 ;;01.25^
"RTN","ICD1817P",103,0)
 ;;01.31^
"RTN","ICD1817P",104,0)
 ;;01.32^
"RTN","ICD1817P",105,0)
 ;;01.39^
"RTN","ICD1817P",106,0)
 ;;01.41^
"RTN","ICD1817P",107,0)
 ;;01.42^
"RTN","ICD1817P",108,0)
 ;;01.51^
"RTN","ICD1817P",109,0)
 ;;01.52^
"RTN","ICD1817P",110,0)
 ;;01.53^
"RTN","ICD1817P",111,0)
 ;;01.6^
"RTN","ICD1817P",112,0)
 ;;02.01^
"RTN","ICD1817P",113,0)
 ;;02.02^
"RTN","ICD1817P",114,0)
 ;;02.03^
"RTN","ICD1817P",115,0)
 ;;02.04^
"RTN","ICD1817P",116,0)
 ;;02.05^
"RTN","ICD1817P",117,0)
 ;;02.06^
"RTN","ICD1817P",118,0)
 ;;02.07^
"RTN","ICD1817P",119,0)
 ;;02.11^
"RTN","ICD1817P",120,0)
 ;;02.12^
"RTN","ICD1817P",121,0)
 ;;02.13^
"RTN","ICD1817P",122,0)
 ;;02.14^
"RTN","ICD1817P",123,0)
 ;;02.2^
"RTN","ICD1817P",124,0)
 ;;02.91^
"RTN","ICD1817P",125,0)
 ;;02.92^
"RTN","ICD1817P",126,0)
 ;;02.93^
"RTN","ICD1817P",127,0)
 ;;02.94^
"RTN","ICD1817P",128,0)
 ;;02.99^
"RTN","ICD1817P",129,0)
 ;;04.01^
"RTN","ICD1817P",130,0)
 ;;04.41^
"RTN","ICD1817P",131,0)
 ;;07.13^
"RTN","ICD1817P",132,0)
 ;;07.14^
"RTN","ICD1817P",133,0)
 ;;07.15^
"RTN","ICD1817P",134,0)
 ;;07.17^
"RTN","ICD1817P",135,0)
 ;;07.51^
"RTN","ICD1817P",136,0)
 ;;07.52^
"RTN","ICD1817P",137,0)
 ;;07.53^
"RTN","ICD1817P",138,0)
 ;;07.54^
"RTN","ICD1817P",139,0)
 ;;07.59^
"RTN","ICD1817P",140,0)
 ;;07.61^
"RTN","ICD1817P",141,0)
 ;;07.62^
"RTN","ICD1817P",142,0)
 ;;07.63^
"RTN","ICD1817P",143,0)
 ;;07.64^
"RTN","ICD1817P",144,0)
 ;;07.65^
"RTN","ICD1817P",145,0)
 ;;07.68^
"RTN","ICD1817P",146,0)
 ;;07.69^
"RTN","ICD1817P",147,0)
 ;;07.71^
"RTN","ICD1817P",148,0)
 ;;07.72^
"RTN","ICD1817P",149,0)
 ;;07.79^
"RTN","ICD1817P",150,0)
 ;;29.92^
"RTN","ICD1817P",151,0)
 ;;38.01^
"RTN","ICD1817P",152,0)
 ;;38.11^
"RTN","ICD1817P",153,0)
 ;;38.31^
"RTN","ICD1817P",154,0)
 ;;38.41^
"RTN","ICD1817P",155,0)
 ;;38.51^
"RTN","ICD1817P",156,0)
 ;;38.61^
"RTN","ICD1817P",157,0)
 ;;38.81^
"RTN","ICD1817P",158,0)
 ;;39.28^
"RTN","ICD1817P",159,0)
 ;;39.51^
"RTN","ICD1817P",160,0)
 ;;39.52^
"RTN","ICD1817P",161,0)
 ;;39.53^
"RTN","ICD1817P",162,0)
 ;;39.72^
"RTN","ICD1817P",163,0)
 ;;39.79^
"RTN","ICD1817P",164,0)
 ;;EXIT
"RTN","ICD1817P",165,0)
 Q
"RTN","ICD1817P",166,0)
 ;
"RTN","ICD1817P",167,0)
CHGDIAG ;
"RTN","ICD1817P",168,0)
 D BMES^XPDUTL(">>>Modifying records in file 80")
"RTN","ICD1817P",169,0)
 ; modify Identifier field (#2) in file 80
"RTN","ICD1817P",170,0)
 N LINE,X,ICDDIAG,ENTRY,DA,DIE,DR,IDENT
"RTN","ICD1817P",171,0)
 S LINE=1
"RTN","ICD1817P",172,0)
 F  S X=$T(REVD+LINE) S ICDDIAG=$P(X,";;",2) Q:ICDDIAG="EXIT"  D
"RTN","ICD1817P",173,0)
 .S ENTRY=+$O(^ICD9("BA",$P(ICDDIAG,U)_" ",0)) I ENTRY D
"RTN","ICD1817P",174,0)
 ..S DA=ENTRY,DIE="^ICD9("
"RTN","ICD1817P",175,0)
 ..S IDENT=$P(ICDDIAG,U,2)
"RTN","ICD1817P",176,0)
 ..S DR="2///^S X=IDENT"
"RTN","ICD1817P",177,0)
 ..D ^DIE
"RTN","ICD1817P",178,0)
 ..S LINE=LINE+1
"RTN","ICD1817P",179,0)
 ; change MDC
"RTN","ICD1817P",180,0)
 S DA=8725,DIE="^ICD9(",IDENT=5
"RTN","ICD1817P",181,0)
 S DR="5///^S X=IDENT"
"RTN","ICD1817P",182,0)
 D ^DIE
"RTN","ICD1817P",183,0)
 ; add 80.071, 80.711 and 80.072 records for diag 428.0
"RTN","ICD1817P",184,0)
 I $D(^ICD9(9061,3)) G DELETE
"RTN","ICD1817P",185,0)
 N FDA
"RTN","ICD1817P",186,0)
 S FDA(428,80,"?1,",.01)="`9061"
"RTN","ICD1817P",187,0)
 S FDA(428,80.071,"+2,?1,",.01)=3031001
"RTN","ICD1817P",188,0)
 S FDA(428,80.072,"+3,?1,",.01)=3031001
"RTN","ICD1817P",189,0)
 S FDA(428,80.072,"+3,?1,",1)=5
"RTN","ICD1817P",190,0)
 D UPDATE^DIE("","FDA(428)") K FDA(428)
"RTN","ICD1817P",191,0)
 S FDA(428,80,"?1,",.01)="`9061"
"RTN","ICD1817P",192,0)
 S FDA(428,80.071,"?2,?1,",.01)=3031001
"RTN","ICD1817P",193,0)
 S FDA(428,80.711,"+3,?2,?1,",.01)=115
"RTN","ICD1817P",194,0)
 S FDA(428,80.711,"+4,?2,?1,",.01)=121
"RTN","ICD1817P",195,0)
 S FDA(428,80.711,"+5,?2,?1,",.01)=124
"RTN","ICD1817P",196,0)
 S FDA(428,80.711,"+6,?2,?1,",.01)=127
"RTN","ICD1817P",197,0)
 D UPDATE^DIE("","FDA(428)")
"RTN","ICD1817P",198,0)
 ; kill 80.071 and 80.072 subfile records for diag 309.81
"RTN","ICD1817P",199,0)
DELETE ;
"RTN","ICD1817P",200,0)
 N DA,DIK
"RTN","ICD1817P",201,0)
 S DA(1)=1399
"RTN","ICD1817P",202,0)
 S DA=2
"RTN","ICD1817P",203,0)
 S DIK="^ICD9("_DA(1)_",""3"","
"RTN","ICD1817P",204,0)
 D ^DIK
"RTN","ICD1817P",205,0)
 S DIK="^ICD9("_DA(1)_",""4"","
"RTN","ICD1817P",206,0)
 D ^DIK
"RTN","ICD1817P",207,0)
 ;kill 80.071 and 80.072 subfile records for diag 250.70
"RTN","ICD1817P",208,0)
 S DA(1)=8725
"RTN","ICD1817P",209,0)
 S DA=2
"RTN","ICD1817P",210,0)
 S DIK="^ICD9("_DA(1)_",""3"","
"RTN","ICD1817P",211,0)
 D ^DIK
"RTN","ICD1817P",212,0)
 S DIK="^ICD9("_DA(1)_",""4"","
"RTN","ICD1817P",213,0)
 D ^DIK
"RTN","ICD1817P",214,0)
 Q
"RTN","ICD1817P",215,0)
 ;
"RTN","ICD1817P",216,0)
REVD ;
"RTN","ICD1817P",217,0)
 ;;402.91^ZX
"RTN","ICD1817P",218,0)
 ;;428.32^ZX
"RTN","ICD1817P",219,0)
 ;;430.^CQK
"RTN","ICD1817P",220,0)
 ;;431.^CQK
"RTN","ICD1817P",221,0)
 ;;432.9^CQK
"RTN","ICD1817P",222,0)
 ;;EXIT
"RTN","ICDDRG0")
0^1^B31829517
"RTN","ICDDRG0",1,0)
ICDDRG0 ;ALB/GRR/EG/ADL - DRG GROUPER PROCESSING BEGINS ; 5/16/05 9:05pm
"RTN","ICDDRG0",2,0)
 ;;18.0;DRG Grouper;**1,2,7,10,14,17**;Oct 20, 2000
"RTN","ICDDRG0",3,0)
 ;GROUPING PROCESS BEGINS
"RTN","ICDDRG0",4,0)
 ;
"RTN","ICDDRG0",5,0)
GROUP ;
"RTN","ICDDRG0",6,0)
 I $D(ICDSEX(1))&($D(ICDSEX(2))) S ICDRTC=4,ICDDRG=470 G KILL^ICDDRG
"RTN","ICDDRG0",7,0)
 I ICDMDC'=14,ICDMDC'=17,ICDMDC'=18,ICDMDC'=19,ICDMDC'=20,ICDMDC'=23,ICDMDC'=15 D:ICDOPCT<2  I "468^476^477"[ICDRG G END
"RTN","ICDDRG0",8,0)
 . ;I ICDPD["M",ICDOR'["a" S ICDPDRG(344)="",ICDOPCT=0
"RTN","ICDDRG0",9,0)
 . I $D(ICDF) Q
"RTN","ICDDRG0",10,0)
 . I ICDPD["M",ICDOR'["y" S ICDOPCT=0 Q
"RTN","ICDDRG0",11,0)
 .I ICDORNI["O",ICDNOR=ICDONR,ICDNOR>0,'$D(ICDPDRG(377)),ICDORNI'["p" S ICDRG=$S($D(ICDORNI("O")):468,ICDORNI["y":476,ICDORNI["z":477,1:468) Q
"RTN","ICDDRG0",12,0)
 .I ICDOPNR S ICDRG=$S(ICDORNI["y":476,1:468),ICDOPNR=0 Q
"RTN","ICDDRG0",13,0)
 ;
"RTN","ICDDRG0",14,0)
 ;if number of non-extensive ORs eqs # OR, 477
"RTN","ICDDRG0",15,0)
 ;
"RTN","ICDDRG0",16,0)
 I ICDMDC'=14,ICDMDC'=17,ICDMDC'=18,ICDMDC'=19,ICDMDC'=20,ICDMDC'=23,ICDMDC'=15,ICDORNI'["y"&(ICDORNI'="")&(ICDORNI["z") D  I ICDRG=477 G END
"RTN","ICDDRG0",17,0)
 . I $D(ICDF) Q
"RTN","ICDDRG0",18,0)
 . NEW K S K=$$ORNI(ICDORNI) I K=ICDOPCT S ICDRG=477 Q
"RTN","ICDDRG0",19,0)
 ;
"RTN","ICDDRG0",20,0)
 ;if number of non-extensive ORs+prostatics eqs # OR, 476
"RTN","ICDDRG0",21,0)
 ;
"RTN","ICDDRG0",22,0)
 I ICDMDC'=14,ICDMDC'=17,ICDMDC'=18,ICDMDC'=19,ICDMDC'=20,ICDMDC'=23,ICDMDC'=15,ICDORNI["y"&(ICDORNI'="") D  I ICDRG=476 G END
"RTN","ICDDRG0",23,0)
 .N K S K=$$ORNI(ICDORNI) I K=ICDOPCT&(ICDNOR=ICDONR) S ICDRG=476 Q
"RTN","ICDDRG0",24,0)
 I ICDMDC'=14,ICDMDC'=17,ICDMDC'=18,ICDMDC'=19,ICDMDC'=20,ICDMDC'=23,ICDMDC'=15,ICDNOR=ICDONR&(ICDOPCT>0) S ICDRG=468 G END
"RTN","ICDDRG0",25,0)
 I ICDMDC=5,ICDOR'["O" S ICDRTC=$S(ICDEXP="":5,1:"") S:ICDRTC'="" ICDRG=470 D:ICDRTC="" MI G END
"RTN","ICDDRG0",26,0)
 I ICDMDC=18,ICDOR["O"!(ICDORNI["O") S ICDRG=415 G END
"RTN","ICDDRG0",27,0)
 I ICDMDC=19,ICDOCNT>0,ICDOR["O" S (ICDRG,HICDRG)=424 D CKDRG
"RTN","ICDDRG0",28,0)
 I ICDMDC=23,ICDOR["O"!(ICDORNI["O") S ICDRG=461 G END
"RTN","ICDDRG0",29,0)
 I ICDMDC=14 D ^ICDDRG14 I ICDRG]"" G END
"RTN","ICDDRG0",30,0)
 I ICDMDC=20 S ICDRTC=$S(ICDDMS="":7,1:"") I ICDDMS'=0 S ICDRG=$S(ICDDMS="":470,1:433) G END
"RTN","ICDDRG0",31,0)
 I ICDMDC=22 S ICDRTC=$S(ICDTRS="":6,1:"") S:ICDRTC'="" ICDRG=470 D:ICDRTC="" CKBURN G END
"RTN","ICDDRG0",32,0)
 I ICDMDC=15 S ICDRTC=$S(ICDEXP="":5,ICDTRS="":6,1:"") I ICDTRS'=0 S ICDRG=$S(ICDRTC'="":470,1:385) G END
"RTN","ICDDRG0",33,0)
NEONATE I 'ICDNOR!('$D(ICDODRG)) S ICDRG=$O(ICDPDRG(0)) X "I ICDMDC=15,$D(ICDSDRG),$O(ICDSDRG(0))<ICDRG S ICDRG=$S($D(ICDPDRG(391)):391,$D(ICDPDRG(387)):387,1:$O(ICDSDRG(0)))" D  D DODRG G GETMOR:ICDRG="",END
"RTN","ICDDRG0",34,0)
 . N X,X1,X2,%
"RTN","ICDDRG0",35,0)
 . S X1=$S($G(DGADM):$G(DGADM),1:DT),X2=$G(DOB) I X1,X2 D ^%DTC I X<29 D NBCOMP Q
"RTN","ICDDRG0",36,0)
 . I ICDRG<385!(ICDRG>391) Q
"RTN","ICDDRG0",37,0)
 .; I "^11917^11918^11921^"[("^"_ICDDX(1)_"^") S ICDRG=395 Q
"RTN","ICDDRG0",38,0)
 . I $O(ICDRG(391)) S ICDRG=$O(ICDRG(391)) Q
"RTN","ICDDRG0",39,0)
 . I 'ICDRG S ICDRG=470,ICDRTC=8
"RTN","ICDDRG0",40,0)
 I AGE="",ICDMDC=3 S ICDRTC=3,ICDRG=470 G END
"RTN","ICDDRG0",41,0)
 D ^ICDDRG1:ICDMDC=1,^ICDDRG2:ICDMDC=2,^ICDDRG3:ICDMDC=3,^ICDDRG5:ICDMDC=5,^ICDDRG6:ICDMDC=6,^ICDDRG7:ICDMDC=7,^ICDDRG8:ICDMDC=8,^ICDDRG9:ICDMDC=9,^ICDDRG10:ICDMDC=10,^ICDDRG12:ICDMDC=12,^ICDDRG13:ICDMDC=13,^ICDDRG17:ICDMDC=17
"RTN","ICDDRG0",42,0)
CONT G:ICDMDC=15 GETMOR S (ICDRG,HICDRG)=$O(ICDODRG(0)) G:ICDRG'>0 ENTER
"RTN","ICDDRG0",43,0)
 D DODRG
"RTN","ICDDRG0",44,0)
 G:ICDRG'>0 LOOK8:ICDMDC=8,AGAIN G END
"RTN","ICDDRG0",45,0)
ENTER I 'ICDNOR,ICDORNR'=0,ICDMDC'=20,ICDMDC'=15 S ICDRG=468 G END
"RTN","ICDDRG0",46,0)
GETMOR S (ICDRG,HICDRG)=$O(ICDPDRG(0)) S:ICDRG'>0 (ICDRG,HICDRG)=469 ;I ICDMDC=15,'$D(ICDODRG),$D(ICDSDRG),$O(ICDSDRG(0))<ICDRG S (ICDRG,HICDRG)=$O(ICDSDRG(0))
"RTN","ICDDRG0",47,0)
CKDRG D DODRG
"RTN","ICDDRG0",48,0)
 I ICDRG="" K ICDPDRG(HICDRG) G GETMOR
"RTN","ICDDRG0",49,0)
DODRG ;Go to DRG file and retrieve table entry to use if defined
"RTN","ICDDRG0",50,0)
 N DRGFY,ICDREF S (DRGFY,ICDREF)=""
"RTN","ICDDRG0",51,0)
 I ICDRG S DRGFY=$O(^ICD(ICDRG,2,"B",+$G(ICDDATE)_.01),-1)
"RTN","ICDDRG0",52,0)
 I 'DRGFY S DRGFY=3041001 ;default to current fiscal year
"RTN","ICDDRG0",53,0)
 S ICDREF=$O(^ICD(+ICDRG,2,"B",+DRGFY,ICDREF))
"RTN","ICDDRG0",54,0)
 I ICDREF'="" D
"RTN","ICDDRG0",55,0)
 . S ICDREF=$P($G(^ICD(+ICDRG,2,ICDREF,0)),U,3)
"RTN","ICDDRG0",56,0)
 . S ICDREF="DRG"_ICDRG_"^"_ICDREF D @ICDREF K ICDREF
"RTN","ICDDRG0",57,0)
 I ICDOR["4" D DRG232^ICDTLB3
"RTN","ICDDRG0",58,0)
 Q
"RTN","ICDDRG0",59,0)
ORNI(X) ;
"RTN","ICDDRG0",60,0)
 N I,K
"RTN","ICDDRG0",61,0)
 S K=0 F I=1:1:$L(ICDORNI) I $E(ICDORNI,I,I)="z"!($E(ICDORNI,I,I)="y") S K=K+1
"RTN","ICDDRG0",62,0)
 Q K
"RTN","ICDDRG0",63,0)
END ;
"RTN","ICDDRG0",64,0)
 D:ICDP24'=""!($D(ICDS24)) CKMST^ICDDRGX S ICDDRG=ICDRG
"RTN","ICDDRG0",65,0)
 D:$G(ICDP25)=1!(($G(ICDP25)>1)&($D(ICDS25(1)))) CKHIV^ICDDRGX S ICDDRG=ICDRG
"RTN","ICDDRG0",66,0)
 ; this will effectively make DRG 103 into a pre-MDC (ICD*18*1)
"RTN","ICDDRG0",67,0)
 I $D(ICDOP(" 33.6"))!$D(ICDOP(" 37.5"))!(ICDDATE>3030930.9&($D(ICDOP(" 37.51"))!$D(ICDOP(" 37.66")))) S ICDRG=103,ICDNMDC(1)=""
"RTN","ICDDRG0",68,0)
 ; this will create DRGs 512/513 as pre-MDC
"RTN","ICDDRG0",69,0)
 I $D(ICDOP(" 52.80"))!$D(ICDOP(" 52.82")) S ICDRG=513,ICDNMDC(1)=""
"RTN","ICDDRG0",70,0)
 I ICDRG=513 I $D(ICDOP(" 55.69")) S ICDRG=512
"RTN","ICDDRG0",71,0)
 ; this will create DRG 481 as pre-MDC - loops thru 41.00 thru .09
"RTN","ICDDRG0",72,0)
 N X S X=0 F  S X=$O(ICDOP(X)) Q:X=""  I X["41.0" S ICDRG=481,ICDNMDC(1)=""
"RTN","ICDDRG0",73,0)
 I $D(ICDNMDC(1)) I ICDNMDC(1)="" D CKNMDC^ICDDRGX S ICDDRG=ICDRG K ICDNMDC
"RTN","ICDDRG0",74,0)
 I ICDRG=468 D CHKMDC4^ICDDRGX D DODRG S ICDDRG=ICDRG
"RTN","ICDDRG0",75,0)
 S:ICDRTC="" ICDRTC=0
"RTN","ICDDRG0",76,0)
 S ICDTMP=$$DRG^ICDGTDRG(ICDDRG,ICDDATE) I '$P(ICDTMP,U,14) S ICDDRG=470
"RTN","ICDDRG0",77,0)
 G KILL^ICDDRG
"RTN","ICDDRG0",78,0)
MI I ICDPD["A" D EN1^ICDDRG5 I ICDCC3 S ICDRG=$O(ICDODRG(0)) D DODRG Q
"RTN","ICDDRG0",79,0)
 I ICDPD["AI"!(ICDSD["AI") D  Q
"RTN","ICDDRG0",80,0)
 . I $D(ICDOP(" 36.07")) I $D(ICDOP(" 37.26"))!($D(ICDOP(" 37.27"))) S ICDRG=526 Q
"RTN","ICDDRG0",81,0)
 . S ICDRG=$S($S($D(ICDEXP):ICDEXP,1:0):123,ICDPD["V"!(ICDSD["V"):121,1:122)
"RTN","ICDDRG0",82,0)
 I $D(ICDOP(" 37.26"))&($D(ICDOP(" 39.61"))) S ICDRG=108 Q
"RTN","ICDDRG0",83,0)
 ;I $D(ICDOP(" 37.26")) S ICDRG=112 Q
"RTN","ICDDRG0",84,0)
 I $D(ICDOP(" 36.07")) I $D(ICDOP(" 37.26"))!($D(ICDOP(" 37.27"))) S ICDRG=527 Q
"RTN","ICDDRG0",85,0)
 I $D(ICDOP(" 36.06")) I $D(ICDOP(" 37.26"))!$D(ICDOP(" 37.27")) S ICDRG=517 Q
"RTN","ICDDRG0",86,0)
 I $D(ICDOP(" 37.26"))!$D(ICDOP(" 37.27")) S ICDRG=518 Q 
"RTN","ICDDRG0",87,0)
 I ICDOR["H" S ICDRG=$S(ICDPD["X"!(ICDSD["X"):124,1:125) Q
"RTN","ICDDRG0",88,0)
 K ICDPDRG(124)
"RTN","ICDDRG0",89,0)
 I ICDOR["p" S ICDRG=$O(ICDODRG(0)) D DODRG Q
"RTN","ICDDRG0",90,0)
 I ICDOR["F" S ICDRG=$O(ICDODRG(0)) D DODRG Q
"RTN","ICDDRG0",91,0)
 E  K ICDPDRG(121) S ICDRG=$O(ICDPDRG(0)) D DODRG Q
"RTN","ICDDRG0",92,0)
 ;
"RTN","ICDDRG0",93,0)
CKBURN ; MDC22 - Burns (extensive, full thickness, or non-extensive)
"RTN","ICDDRG0",94,0)
 D
"RTN","ICDDRG0",95,0)
 . I ICDPD["*"!(ICDSD["*") S ICDRG=$S(ICDOR["k":504,1:505) Q
"RTN","ICDDRG0",96,0)
 . I ICDPD["b"!(ICDSD["b") D FTBURN Q
"RTN","ICDDRG0",97,0)
 . S ICDRG=$S(ICDCC!(ICDPD["T")!(ICDSD["T"):510,1:511)
"RTN","ICDDRG0",98,0)
 Q
"RTN","ICDDRG0",99,0)
 ;
"RTN","ICDDRG0",100,0)
AGAIN G:'$D(ICDODRG) ENTER
"RTN","ICDDRG0",101,0)
 K ICDODRG(HICDRG) I $O(ICDODRG(HICDRG))'>0 K ICDODRG G GROUP
"RTN","ICDDRG0",102,0)
 S ICDRG=$O(ICDODRG(HICDRG)) G GROUP
"RTN","ICDDRG0",103,0)
 ;
"RTN","ICDDRG0",104,0)
 ;
"RTN","ICDDRG0",105,0)
LOOK8 G:'$D(ICDJ) GETMOR
"RTN","ICDDRG0",106,0)
 S ICDJ=$O(ICDJ(0)) G:ICDJ'>0 GETMOR
"RTN","ICDDRG0",107,0)
 K ICDJ(ICDJ),ICDODRG D END^ICDDRG8 G GETMOR:'$D(ICDODRG),CONT
"RTN","ICDDRG0",108,0)
 Q
"RTN","ICDDRG0",109,0)
 ;
"RTN","ICDDRG0",110,0)
NBCOMP ; check for complication related to NB
"RTN","ICDDRG0",111,0)
 I ICDSD'["J"!'$D(ICDSDRG) Q
"RTN","ICDDRG0",112,0)
 N ICDSDXCK
"RTN","ICDDRG0",113,0)
 S ICDSDXCK=$O(ICDSDRG(0))
"RTN","ICDDRG0",114,0)
 I ICDSDXCK<ICDRG,ICDSDXCK>384,ICDSDXCK<392 D
"RTN","ICDDRG0",115,0)
 . S ICDRG=$S($D(ICDPDRG(391)):391,$D(ICDPDRG(387)):387,1:$O(ICDSDRG(0)))
"RTN","ICDDRG0",116,0)
 Q
"RTN","ICDDRG0",117,0)
 ;
"RTN","ICDDRG0",118,0)
FTBURN ; full thickness burn check
"RTN","ICDDRG0",119,0)
 I ICDSD["j"!(ICDOR["k") D
"RTN","ICDDRG0",120,0)
 . I ICDCC!(ICDPD["T")!(ICDSD["T") S ICDRG=506
"RTN","ICDDRG0",121,0)
 . E  S ICDRG=507
"RTN","ICDDRG0",122,0)
 E  D
"RTN","ICDDRG0",123,0)
 . I ICDCC!(ICDPD["T")!(ICDSD["T") S ICDRG=508
"RTN","ICDDRG0",124,0)
 . E  S ICDRG=509
"RTN","ICDDRG0",125,0)
 Q
"RTN","ICDDRG1")
0^4^B2858628
"RTN","ICDDRG1",1,0)
ICDDRG1 ;ALB/MRY - FIX SURGERY HIERARCHY ; 6/15/05 7:07pm
"RTN","ICDDRG1",2,0)
 ;;18.0;DRG Grouper;**10,17**;Oct 20, 2000
"RTN","ICDDRG1",3,0)
 Q:$O(ICDODRG(0))'>0  K ICDJ F ICDJ=0:0 S ICDJ=$O(ICDODRG(ICDJ)) Q:ICDJ'>0  D F
"RTN","ICDDRG1",4,0)
END S ICDJ=$O(ICDJ(0)) Q:ICDJ'>0  S ICDJ=ICDJ(ICDJ) K ICDODRG S ICDODRG(ICDJ)="" K ICDJ Q
"RTN","ICDDRG1",5,0)
F I ICDJ=3 S ICDJ(1)=ICDJ Q
"RTN","ICDDRG1",6,0)
 I ICDJ=528 S ICDJ(2)=ICDJ Q
"RTN","ICDDRG1",7,0)
 I ICDJ=543 S ICDJ(3)=ICDJ Q
"RTN","ICDDRG1",8,0)
 I ICDJ=1 S ICDJ(4)=ICDJ Q
"RTN","ICDDRG1",9,0)
 I ICDJ=529 S ICDJ(5)=ICDJ Q
"RTN","ICDDRG1",10,0)
 I ICDJ=531 S ICDJ(6)=ICDJ Q
"RTN","ICDDRG1",11,0)
 I ICDJ=533 S ICDJ(7)=ICDJ Q
"RTN","ICDDRG1",12,0)
 I ICDJ=6 S ICDJ(8)=ICDJ Q
"RTN","ICDDRG1",13,0)
 I ICDJ=7 S ICDJ(9)=ICDJ Q
"RTN","ICDDRG1",14,0)
 I ICDJ=8 S ICDJ(10)=ICDJ Q
"RTN","ICDDRG1",15,0)
 I ICDJ=9 S ICDJ(11)=ICDJ Q
"RTN","ICDDRG1",16,0)
 I ICDJ=10 S ICDJ(12)=ICDJ Q
"RTN","ICDDRG1",17,0)
 I ICDJ=11 S ICDJ(13)=ICDJ Q
"RTN","ICDDRG1",18,0)
 I ICDJ=12 S ICDJ(14)=ICDJ Q
"RTN","ICDDRG1",19,0)
 I ICDJ=13 S ICDJ(15)=ICDJ Q
"RTN","ICDDRG1",20,0)
 I ICDJ=14 S ICDJ(16)=ICDJ Q
"RTN","ICDDRG1",21,0)
 I ICDJ=15 S ICDJ(17)=ICDJ Q
"RTN","ICDDRG1",22,0)
 I ICDJ=524 S ICDJ(18)=ICDJ Q
"RTN","ICDDRG1",23,0)
 I ICDJ=16 S ICDJ(19)=ICDJ Q
"RTN","ICDDRG1",24,0)
 I ICDJ=17 S ICDJ(20)=ICDJ Q
"RTN","ICDDRG1",25,0)
 I ICDJ=18 S ICDJ(21)=ICDJ Q
"RTN","ICDDRG1",26,0)
 I ICDJ=19 S ICDJ(22)=ICDJ Q
"RTN","ICDDRG1",27,0)
 I ICDJ=20 S ICDJ(23)=ICDJ Q
"RTN","ICDDRG1",28,0)
 I ICDJ=21 S ICDJ(24)=ICDJ Q
"RTN","ICDDRG1",29,0)
 I ICDJ=22 S ICDJ(25)=ICDJ Q
"RTN","ICDDRG1",30,0)
 I ICDJ=23 S ICDJ(26)=ICDJ Q
"RTN","ICDDRG1",31,0)
 I ICDJ=24 S ICDJ(27)=ICDJ Q
"RTN","ICDDRG1",32,0)
 I ICDJ=25 S ICDJ(28)=ICDJ Q
"RTN","ICDDRG1",33,0)
 I ICDJ=26 S ICDJ(29)=ICDJ Q
"RTN","ICDDRG1",34,0)
 I ICDJ=27 S ICDJ(30)=ICDJ Q
"RTN","ICDDRG1",35,0)
 I ICDJ=28 S ICDJ(31)=ICDJ Q
"RTN","ICDDRG1",36,0)
 I ICDJ=29 S ICDJ(32)=ICDJ Q
"RTN","ICDDRG1",37,0)
 I ICDJ=30 S ICDJ(33)=ICDJ Q
"RTN","ICDDRG1",38,0)
 I ICDJ=31 S ICDJ(34)=ICDJ Q
"RTN","ICDDRG1",39,0)
 I ICDJ=32 S ICDJ(35)=ICDJ Q
"RTN","ICDDRG1",40,0)
 I ICDJ=33 S ICDJ(36)=ICDJ Q
"RTN","ICDDRG1",41,0)
 I ICDJ=34 S ICDJ(37)=ICDJ Q
"RTN","ICDDRG1",42,0)
 I ICDJ=35 S ICDJ(38)=ICDJ Q
"RTN","ICDDRG1",43,0)
 Q
"RTN","ICDGTDRG")
0^2^B50975145
"RTN","ICDGTDRG",1,0)
ICDGTDRG  ;ALB/ADL/KER - COLLECTION OF DRG APIS ; 04/18/2004
"RTN","ICDGTDRG",2,0)
 ;;18.0;DRG Grouper;**7,12,14,17**;Oct 20, 2000
"RTN","ICDGTDRG",3,0)
 ;   Collection of API's for accessing new "DRG" level
"RTN","ICDGTDRG",4,0)
 ;   of files #80, #80.1, and #80.2.  These new levels
"RTN","ICDGTDRG",5,0)
 ;   were added for the Code Set Versioning Project
"RTN","ICDGTDRG",6,0)
 ;
"RTN","ICDGTDRG",7,0)
GETDRG(CODE,DGNDT,FILE)      ; Get DRG or DRG string associated with a Code
"RTN","ICDGTDRG",8,0)
 ;  Input:
"RTN","ICDGTDRG",9,0)
 ;     CODE  - IEN number
"RTN","ICDGTDRG",10,0)
 ;     DRGDT - Effective date of the Code
"RTN","ICDGTDRG",11,0)
 ;     FILE  - File to check : 9 - ICD9 (file #80)
"RTN","ICDGTDRG",12,0)
 ;                                   0 - ICD0 (file 80.1)
"RTN","ICDGTDRG",13,0)
 ;  Output:
"RTN","ICDGTDRG",14,0)
 ;     DRGS - DRG or string of DRG's (delimited
"RTN","ICDGTDRG",15,0)
 ;            by "^") or -1 if not defined
"RTN","ICDGTDRG",16,0)
 ;
"RTN","ICDGTDRG",17,0)
 ;            Effective date or error message; 
"RTN","ICDGTDRG",18,0)
 ;            status flag (1=Active;0=Inactive)
"RTN","ICDGTDRG",19,0)
 ;            Delimited by ";" because DRG's can be
"RTN","ICDGTDRG",20,0)
 ;            multiple and are already delimited by "^"
"RTN","ICDGTDRG",21,0)
 ;
"RTN","ICDGTDRG",22,0)
 N DRG0,D1,DCS,DCSINF,DRGS,DCSV,DAMDC,DRGFY,DRG,DRGS,DADRGFY,MDC
"RTN","ICDGTDRG",23,0)
 S (DRG0,DRGFY,DRGS,DRG,MDC,DAMDC,DADRGFY,DRG0)=""
"RTN","ICDGTDRG",24,0)
 I $G(CODE)="" S DRGS="-1;NO CODE SELECTED;0" G GETDRGQ
"RTN","ICDGTDRG",25,0)
 I $G(FILE)="" S DRGS="-1;NO FILE INPUT;0" G GETDRGQ
"RTN","ICDGTDRG",26,0)
 I $G(DGNDT)="" S DGNDT=DT
"RTN","ICDGTDRG",27,0)
 I FILE'=9,FILE'=0 S DRGS="-1;INVALID FILE INPUT;0" G GETDRGQ
"RTN","ICDGTDRG",28,0)
 S DGNDT=DGNDT+.001
"RTN","ICDGTDRG",29,0)
 ;  ICD Operations/Procedures
"RTN","ICDGTDRG",30,0)
 I FILE=0 D
"RTN","ICDGTDRG",31,0)
 . I CODE<1!'$D(^ICD0(CODE)) S DRGS="-1;NO SUCH ENTRY;0" Q
"RTN","ICDGTDRG",32,0)
 . S DRGFY=$O(^ICD0(CODE,2,"B",+DGNDT),-1),DADRGFY=$O(^ICD0(CODE,2,"B",+$G(DRGFY),DADRGFY)),DAMDC=$O(^ICD0(CODE,2,+DADRGFY,1,"B",ICDMDC,DAMDC))
"RTN","ICDGTDRG",33,0)
 . ;If no entry check previous FY
"RTN","ICDGTDRG",34,0)
 . I DAMDC'>0 D GETPVMDC^ICDREF
"RTN","ICDGTDRG",35,0)
 . F  S DRG=$O(^ICD0(CODE,2,+DADRGFY,1,+DAMDC,1,"B",DRG)) Q:DRG=""  S DRG0=DRG0_DRG_U
"RTN","ICDGTDRG",36,0)
 . I DRG0="" S DRGS="-1;NO DRG LEVEL;0"
"RTN","ICDGTDRG",37,0)
 . S DRGS=DRG0_";"_DRGFY
"RTN","ICDGTDRG",38,0)
 ;  ICD Diagnosis
"RTN","ICDGTDRG",39,0)
 I FILE=9 D
"RTN","ICDGTDRG",40,0)
 . I CODE<1!'$D(^ICD9(CODE)) S DRGS="-1;NO SUCH ENTRY;0" Q
"RTN","ICDGTDRG",41,0)
 . S DRGFY=$O(^ICD9(CODE,3,"B",+DGNDT+.01),-1),DADRGFY=$O(^ICD9(CODE,3,"B",+$G(DRGFY),DADRGFY))
"RTN","ICDGTDRG",42,0)
 . F  S DRG=$O(^ICD9(CODE,3,+DADRGFY,1,"B",DRG)) Q:DRG=""  S DRG0=DRG0_DRG_U
"RTN","ICDGTDRG",43,0)
 . I DRG0="" S DRGS="-1;NO DRG LEVEL;0"
"RTN","ICDGTDRG",44,0)
 . S DRGS=DRG0_";"_DRGFY
"RTN","ICDGTDRG",45,0)
 ;
"RTN","ICDGTDRG",46,0)
GETDRGQ Q DRGS  ; Exit API GETDRG
"RTN","ICDGTDRG",47,0)
 ;
"RTN","ICDGTDRG",48,0)
DRG(CODE,EDT)   ; Returns a string of information from the DRG file (#80.2)
"RTN","ICDGTDRG",49,0)
 ; Input:   CODE   DRG code, internal or external format (Required)
"RTN","ICDGTDRG",50,0)
 ;          CDT    Date to check status for, FileMan format (default = TODAY)
"RTN","ICDGTDRG",51,0)
 ;                   If CDT < 10/1/1978, use 10/1/1978
"RTN","ICDGTDRG",52,0)
 ;                   If CDT > DT, validate with In/Activation Dates
"RTN","ICDGTDRG",53,0)
 ;                   If CDT is year only, use first of the year
"RTN","ICDGTDRG",54,0)
 ;                   If CDT is year and month, use first of the month
"RTN","ICDGTDRG",55,0)
 ; 
"RTN","ICDGTDRG",56,0)
 ; Output:  Returns an 22 piece string delimited by the up-arrow (^), where the
"RTN","ICDGTDRG",57,0)
 ;          pieces are:
"RTN","ICDGTDRG",58,0)
 ;            1  DRG name (field #.01)
"RTN","ICDGTDRG",59,0)
 ;            2  Weight (field #2)
"RTN","ICDGTDRG",60,0)
 ;            3  Low Trim (days) (field #3)
"RTN","ICDGTDRG",61,0)
 ;            4  High Trim (days) (field #4)
"RTN","ICDGTDRG",62,0)
 ;            5  MDC (field #5)
"RTN","ICDGTDRG",63,0)
 ;            6  Surgery Flag (field #.06)
"RTN","ICDGTDRG",64,0)
 ;            7  <null>
"RTN","ICDGTDRG",65,0)
 ;            8  Avg Length of Stay (days) (field 10)
"RTN","ICDGTDRG",66,0)
 ;            9  Local Low Trim Days (field #11)
"RTN","ICDGTDRG",67,0)
 ;           10  Local High Trim Days (field #12)
"RTN","ICDGTDRG",68,0)
 ;           11  <null>
"RTN","ICDGTDRG",69,0)
 ;           12  Local Breakeven (field #13)
"RTN","ICDGTDRG",70,0)
 ;           13  Activation Date (.01 field of the 66 multiple)
"RTN","ICDGTDRG",71,0)
 ;           14  Status (.03 field of the 66 multiple)
"RTN","ICDGTDRG",72,0)
 ;           15  Inactivation Date (.01 field of the 66 multiple)
"RTN","ICDGTDRG",73,0)
 ;           16  Effective date (.01 field of the 66 multiple)
"RTN","ICDGTDRG",74,0)
 ;           17  Internal Entry Number (IEN)
"RTN","ICDGTDRG",75,0)
 ;           18  Effective date of CSV (.01 field of the 66 multiple)
"RTN","ICDGTDRG",76,0)
 ;           19  Reference (field #900)
"RTN","ICDGTDRG",77,0)
 ;           20  Weight (Non Affil) (field #7)
"RTN","ICDGTDRG",78,0)
 ;           21  Weight (Int Affil) (field #7.5)
"RTN","ICDGTDRG",79,0)
 ;           22  Message
"RTN","ICDGTDRG",80,0)
 ; 
"RTN","ICDGTDRG",81,0)
 ;            or 
"RTN","ICDGTDRG",82,0)
 ; 
"RTN","ICDGTDRG",83,0)
 ;           -1^Error Description
"RTN","ICDGTDRG",84,0)
 ; 
"RTN","ICDGTDRG",85,0)
 N D0,DCS,DFY,DFYINF,DCSINF,DMC1,D1,FYDT,FYMD,ICDFY
"RTN","ICDGTDRG",86,0)
 I $G(CODE)="" S STR="-1^NO CODE SELECTED",$P(STR,"^",14)=0 G DRGQ
"RTN","ICDGTDRG",87,0)
 I $G(EDT)="" S EDT=DT  ; No date, use today
"RTN","ICDGTDRG",88,0)
 S EDT=$$DTBR^ICDAPIU(EDT,2)  ; Verify that date is not earlier that the earliest allowed date per the bus. rule
"RTN","ICDGTDRG",89,0)
 S EDT=EDT+.001
"RTN","ICDGTDRG",90,0)
 S CODE=$G(CODE),CODE=$S(CODE:+CODE,1:$$CODEN(CODE)) ; GET ien
"RTN","ICDGTDRG",91,0)
 I CODE<1!'$D(^ICD(CODE)) S STR="-1^NO SUCH ENTRY",$P(STR,"^",14)=0 G DRGQ
"RTN","ICDGTDRG",92,0)
 S D0=^ICD(CODE,0)
"RTN","ICDGTDRG",93,0)
 S FYDT=$$DGY2K^DGPTOD0($$FY^DGPTOD0(EDT))+.001 ; get the correct FY in YYY0000 format for the effective date
"RTN","ICDGTDRG",94,0)
 S DFY=$O(^ICD(CODE,"FY",FYDT),-1) S:DFY>0 DFYINF=^(DFY,0) I DFY'>0 D  ;date stored in YYY0000 w/YYY = Fiscal Year
"RTN","ICDGTDRG",95,0)
 . S DFYINF=U_$P(D0,U,2,4)_U_U_$P(D0,U,9)_U_$P(D0,U,12)_U_$P(D0,U,7)_U_$P(D0,U,8)_U_$P(D0,U,11)
"RTN","ICDGTDRG",96,0)
 S DCS=$O(^ICD(CODE,66,"B",EDT),-1),D1=$S(DCS'="":$O(^ICD(CODE,66,"B",DCS,0)),1:0) S DCSINF=$S(D1>0:^ICD(CODE,66,D1,0),1:"")
"RTN","ICDGTDRG",97,0)
 I DCSINF="" S DCSINF=U_U_"0"_U_U_$P(D0,U,5,6)  ;if CSV level does not exist, default to info at .01 level with status = inactive
"RTN","ICDGTDRG",98,0)
 ;Resolve reference table using "B" cross reference and fiscal year
"RTN","ICDGTDRG",99,0)
 ;If ICDFY is not resolved set it to current fiscal year
"RTN","ICDGTDRG",100,0)
 S ICDFY=$O(^ICD(CODE,2,"B",EDT+.01),-1),DMC1=""
"RTN","ICDGTDRG",101,0)
 S DMC1=$O(^ICD(CODE,2,"B",+$G(ICDFY),DMC1)),DMC1=$P($G(^ICD(CODE,2,+DMC1,0)),U,3)
"RTN","ICDGTDRG",102,0)
 S STR=$P(D0,U)_U_$P(DFYINF,U,2,4)_U_$P(DCSINF,U,5,6)_U_U_$P(DFYINF,U,9)_U_$P(DFYINF,U,6,7)
"RTN","ICDGTDRG",103,0)
 S STR=STR_U_U_$P(D0,U,12)_U_$P(D0,U,13)_U_$P(DCSINF,U,3)_U_$P(D0,U,15)_U_$P(DCSINF,U)_U_CODE_U_DCS_U_$P(DMC1,U)_U_$P(DFYINF,U,8)_U_$P(DFYINF,U,10)
"RTN","ICDGTDRG",104,0)
 ;
"RTN","ICDGTDRG",105,0)
DRGQ Q STR
"RTN","ICDGTDRG",106,0)
 ;
"RTN","ICDGTDRG",107,0)
CODEI(CODE)     ; Returns the IEN of an ICD code
"RTN","ICDGTDRG",108,0)
 Q +$O(^ICD9("BA",+CODE,0))
"RTN","ICDGTDRG",109,0)
 ;
"RTN","ICDGTDRG",110,0)
GETDATE(PATNUM) ; Find the correct "EFFECTIVE DATE" for locating the DRG/ICD/CPT codes
"RTN","ICDGTDRG",111,0)
 ;
"RTN","ICDGTDRG",112,0)
 ;  Input:    PATNUM - PTF Record Number
"RTN","ICDGTDRG",113,0)
 ;  Output:   "effective date" to use
"RTN","ICDGTDRG",114,0)
 ;
"RTN","ICDGTDRG",115,0)
 N EFFD,PTR
"RTN","ICDGTDRG",116,0)
 ;  Census Date
"RTN","ICDGTDRG",117,0)
 S PTR=$P($G(^DGPT(PATNUM,0)),U,13) I PTR'="" S EFFD=$P($G(^DG(45.86,PTR,0)),U,1) G:EFFD'="" GDOUT
"RTN","ICDGTDRG",118,0)
 ;  Discharge Date
"RTN","ICDGTDRG",119,0)
 S EFFD=$P($G(^DGPT(PATNUM,70)),U,1) G:EFFD'="" GDOUT
"RTN","ICDGTDRG",120,0)
 ;  Surgery Date
"RTN","ICDGTDRG",121,0)
 S EFFD=$P($G(^DGPT(PATNUM,"S",1,0)),U,1) G:EFFD'="" GDOUT
"RTN","ICDGTDRG",122,0)
 ;  Movement Date
"RTN","ICDGTDRG",123,0)
 S EFFD=$P($G(^DGPT(PATNUM,"M",1,0)),U,10)
"RTN","ICDGTDRG",124,0)
 ;  Default TODAY
"RTN","ICDGTDRG",125,0)
 I EFFD="" S EFFD=DT
"RTN","ICDGTDRG",126,0)
GDOUT Q EFFD
"RTN","ICDGTDRG",127,0)
 ;
"RTN","ICDGTDRG",128,0)
ISVALID(CODE,EDATE,FILE) ; Is an ICD/CPT code Valid
"RTN","ICDGTDRG",129,0)
 ; This is a function call to be used in DIC("S") FileMan
"RTN","ICDGTDRG",130,0)
 ; calls to check the validation of a ICD/CPT code
"RTN","ICDGTDRG",131,0)
 ; Input:
"RTN","ICDGTDRG",132,0)
 ;    CODE   - ICD/CPT code (ien)
"RTN","ICDGTDRG",133,0)
 ;    EDATE  - Effective date to be used
"RTN","ICDGTDRG",134,0)
 ;    FILE   - File to use: 0 - ICD0; 9 - ICD9
"RTN","ICDGTDRG",135,0)
 ;
"RTN","ICDGTDRG",136,0)
 ; Output:
"RTN","ICDGTDRG",137,0)
 ;    OUT    - 1 if valid; 0 if not
"RTN","ICDGTDRG",138,0)
 ;
"RTN","ICDGTDRG",139,0)
 N OUT,TEMP
"RTN","ICDGTDRG",140,0)
 S OUT=0
"RTN","ICDGTDRG",141,0)
 I FILE=0 S TEMP=$$ICDOP^ICDCODE(CODE,EDATE) I TEMP>0,$P(TEMP,U,10) S OUT=1
"RTN","ICDGTDRG",142,0)
 I FILE=9 S TEMP=$$ICDDX^ICDCODE(CODE,EDATE) I TEMP>0,$P(TEMP,U,10) S OUT=1
"RTN","ICDGTDRG",143,0)
 Q OUT
"RTN","ICDGTDRG",144,0)
 ;
"RTN","ICDGTDRG",145,0)
DRGD(CODE,OUTARR,DFN,CDT) ; returns CPT description in array
"RTN","ICDGTDRG",146,0)
 ; Input:   CODE   ICD Code, Internal or External Format (required)
"RTN","ICDGTDRG",147,0)
 ;          ARY    Output Array Name for description 
"RTN","ICDGTDRG",148,0)
 ;                   e.g. "ABC" or "ABC("TEST")" 
"RTN","ICDGTDRG",149,0)
 ;                   Default = ^TMP("DRGD",$J)
"RTN","ICDGTDRG",150,0)
 ;          DFN    Not in use but included in anticipation of future need
"RTN","ICDGTDRG",151,0)
 ;          CDT    Date to screen against (default = TODAY)
"RTN","ICDGTDRG",152,0)
 ;                   If CDT < 10/1/1978, use 10/1/1978
"RTN","ICDGTDRG",153,0)
 ;                   If CDT > DT, use DT
"RTN","ICDGTDRG",154,0)
 ;                   If CDT is year only, use first of the year
"RTN","ICDGTDRG",155,0)
 ;                   If CDT is year and month only, use first of the month
"RTN","ICDGTDRG",156,0)
 ; 
"RTN","ICDGTDRG",157,0)
 ; Output:  #      Number of lines in description output array
"RTN","ICDGTDRG",158,0)
 ;          @ARY(1:n) - Versioned Description (lines 1-n) (from the 68 multiple)
"RTN","ICDGTDRG",159,0)
 ;          @ARY(n+1) - Blank
"RTN","ICDGTDRG",160,0)
 ;          @ARY(n+1) - A message stating: CODE TEXT MAY BE INACCURATE
"RTN","ICDGTDRG",161,0)
 ; 
"RTN","ICDGTDRG",162,0)
 ;           or
"RTN","ICDGTDRG",163,0)
 ; 
"RTN","ICDGTDRG",164,0)
 ;          -1^Error Description
"RTN","ICDGTDRG",165,0)
 ; 
"RTN","ICDGTDRG",166,0)
 ; ** NOTE - USER MUST INITIALIZE ^TMP("DRGD",$J), IF USED **
"RTN","ICDGTDRG",167,0)
 ;
"RTN","ICDGTDRG",168,0)
 N ARR,END,I,N,CTV,IEN
"RTN","ICDGTDRG",169,0)
 I $G(CODE)="" S N="-1^NO CODE SELECTED" G DRGDQ
"RTN","ICDGTDRG",170,0)
 I $G(OUTARR)="" S OUTARR="^TMP(""DRGD"",$J,"
"RTN","ICDGTDRG",171,0)
 I OUTARR'["(" S OUTARR=OUTARR_"("
"RTN","ICDGTDRG",172,0)
 I OUTARR[")" S OUTARR=$P(OUTARR,")")
"RTN","ICDGTDRG",173,0)
 S END=$E(OUTARR,$L(OUTARR)) I END'="("&(END'=",") S OUTARR=OUTARR_","
"RTN","ICDGTDRG",174,0)
 K:OUTARR="^TMP(""DRGD"",$J," ^TMP("DRGD",$J)
"RTN","ICDGTDRG",175,0)
 S CODE=$G(CODE),IEN=$S(CODE:+CODE,1:$$CODEN(CODE)),I=0,N=0
"RTN","ICDGTDRG",176,0)
 I +IEN<1!('$D(^ICD(IEN))) S N="-1^NO SUCH CODE" G DRGDQ
"RTN","ICDGTDRG",177,0)
 S CDT=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR^ICDAPIU(CDT,2))
"RTN","ICDGTDRG",178,0)
 D VLTDR(+IEN,CDT,.CTV) S (N,I)=0 F  S I=$O(CTV(I)) Q:+I=0  D
"RTN","ICDGTDRG",179,0)
 . S N=N+1,ARR=OUTARR_N_")",@ARR=$$TRIM($G(CTV(I)))
"RTN","ICDGTDRG",180,0)
 I +N>0 S N=N+1,ARR=OUTARR_N_")",@ARR=" ",N=N+1,ARR=OUTARR_N_")",@ARR=$$MSG^ICDAPIU(CDT,2)
"RTN","ICDGTDRG",181,0)
 I +N'>0 S N="-1^VERSIONED DESCRIPTION NOT FOUND FOR "_CODE
"RTN","ICDGTDRG",182,0)
DRGDQ Q N
"RTN","ICDGTDRG",183,0)
 ;
"RTN","ICDGTDRG",184,0)
VLTDR(IEN,VDATE,ARY) ; Versioned Description - Long Text
"RTN","ICDGTDRG",185,0)
 ; Input:
"RTN","ICDGTDRG",186,0)
 ;    IEN    - Internal Entry Number file 80.2
"RTN","ICDGTDRG",187,0)
 ;    VDATE  - Effective/Versioning date to be used
"RTN","ICDGTDRG",188,0)
 ;    .ARY   - Array for output, passed by reference
"RTN","ICDGTDRG",189,0)
 ;
"RTN","ICDGTDRG",190,0)
 ; Output:
"RTN","ICDGTDRG",191,0)
 ;    ARY()  - Local array containing versioned description
"RTN","ICDGTDRG",192,0)
 ;
"RTN","ICDGTDRG",193,0)
 N ICD0,ICDC,ICDI,ICDSTD,ICDSTI,ICDVDT,ICDTXT,ICDD,ICDT,ICDE
"RTN","ICDGTDRG",194,0)
 S ICDI=+($G(IEN)) Q:+ICDI'>0  Q:'$D(^ICD(+ICDI))
"RTN","ICDGTDRG",195,0)
 S ICDVDT=$G(VDATE) S:'$L(ICDVDT)!(+ICDVDT'>0) ICDVDT=$$DT^XLFDT Q:$P(ICDVDT,".",1)'?7N
"RTN","ICDGTDRG",196,0)
 S ICD0=$G(^ICD(+ICDI,0)),ICDC=$P(ICD0,"^",1) Q:'$L(ICDC)
"RTN","ICDGTDRG",197,0)
 S ICDSTD=$O(^ICD("ADS",(ICDC_" "),(ICDVDT+.000001)),-1)
"RTN","ICDGTDRG",198,0)
 I +ICDSTD>0 D  Q:+($O(ARY(0)))>0
"RTN","ICDGTDRG",199,0)
 . S ICDSTI=$O(^ICD("ADS",(ICDC_" "),ICDSTD,+ICDI," "),-1)
"RTN","ICDGTDRG",200,0)
 . S (ICDD,ICDT)=0 F  S ICDD=$O(^ICD(+ICDI,68,ICDSTI,1,ICDD)) Q:+ICDD=0  D
"RTN","ICDGTDRG",201,0)
 . . S ICDT=ICDT+1,ARY(ICDT)=$G(^ICD(+ICDI,68,+ICDSTI,1,+ICDD,0)),ARY(0)=ICDT
"RTN","ICDGTDRG",202,0)
 S ICDSTD=$O(^ICD(+ICDI,68,"B"," "),-1) I +ICDSTD>0 D  Q:+($O(ARY(0)))>0
"RTN","ICDGTDRG",203,0)
 . S ICDSTI=$O(^ICD(+ICDI,68,"B",ICDSTD,0))
"RTN","ICDGTDRG",204,0)
 . S (ICDD,ICDT)=0 F  S ICDD=$O(^ICD(+ICDI,68,ICDSTI,1,ICDD)) Q:+ICDD=0  D
"RTN","ICDGTDRG",205,0)
 . . S ICDT=ICDT+1,ARY(ICDT)=$G(^ICD(+ICDI,68,+ICDSTI,1,+ICDD,0)),ARY(0)=ICDT
"RTN","ICDGTDRG",206,0)
 K ARY S (ICDD,ICDT)=0 F  S ICDD=$O(^ICD(ICDI,1,ICDD)) Q:+ICDD=0  D
"RTN","ICDGTDRG",207,0)
 . S ICDT=ICDT+1,ARY(ICDT)=$G(^ICD(ICDI,1,ICDD,0)),ARY(0)=ICDT
"RTN","ICDGTDRG",208,0)
 Q
"RTN","ICDGTDRG",209,0)
TRIM(X) ; Trim Spaces
"RTN","ICDGTDRG",210,0)
 S X=$G(X) Q:X="" X F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","ICDGTDRG",211,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","ICDGTDRG",212,0)
 F  Q:X'["  "  S X=$P(X,"  ",1)_" "_$P(X,"  ",2,229)
"RTN","ICDGTDRG",213,0)
 Q X
"RTN","ICDGTDRG",214,0)
CODEN(CODE) ; Return the IEN of DRG
"RTN","ICDGTDRG",215,0)
 ;   Input:  DRG code
"RTN","ICDGTDRG",216,0)
 ;  Output:  IEN of code
"RTN","ICDGTDRG",217,0)
 ;
"RTN","ICDGTDRG",218,0)
 Q:$G(CODE)="" -1  N COD S COD=+$O(^ICD("B",CODE,0)) Q $S(COD>0:COD,1:-1)
"RTN","ICDREF")
0^3^B1396078
"RTN","ICDREF",1,0)
ICDREF ;ALB/EG - GROUPER UTILITY FUNCTIONS ; 5/20/05 8:35pm
"RTN","ICDREF",2,0)
 ;;18.0;DRG Grouper;** 14,17 **;Oct 20, 2000
"RTN","ICDREF",3,0)
RTABLE(ICDRG,ICDDATE) ; Return Reference Table
"RTN","ICDREF",4,0)
 ;  Input:      ICDRG - DRG entry
"RTN","ICDREF",5,0)
 ;              ICDDATE - Date to use for resolving correct entry
"RTN","ICDREF",6,0)
 ;
"RTN","ICDREF",7,0)
 ;  Output:     Table reference associted with entry from DRG
"RTN","ICDREF",8,0)
 ;              file
"RTN","ICDREF",9,0)
 N ICDFY,ICDREF
"RTN","ICDREF",10,0)
 S (ICDFY,ICDREF)=""
"RTN","ICDREF",11,0)
 S ICDFY=$O(^ICD(ICDRG,2,"B",+ICDDATE+.01),-1)
"RTN","ICDREF",12,0)
 S ICDREF=$O(^ICD(ICDRG,2,"B",+ICDFY,ICDREF))
"RTN","ICDREF",13,0)
 S ICDREF=$P($G(^ICD(ICDRG,2,+ICDREF,0)),U,3)
"RTN","ICDREF",14,0)
 Q ICDREF
"RTN","ICDREF",15,0)
VMDC(CODE) ;Get versioned MDC for Diagnosis Code
"RTN","ICDREF",16,0)
 S (MDC,DRGFY)="",DRGFY=$O(^ICD9(CODE,4,"B",+$G(ICDDATE)),-1),MDC=$O(^ICD9(CODE,4,"B",+DRGFY,MDC))
"RTN","ICDREF",17,0)
 Q $P($G(^ICD9(CODE,4,+MDC,0)),U,2)
"RTN","ICDREF",18,0)
 ;
"RTN","ICDREF",19,0)
GETPVMDC ;Get versioned MDC for Op/Pro ICD code from previous years
"RTN","ICDREF",20,0)
 S (DAMDC,DADRGFY)=""
"RTN","ICDREF",21,0)
 F  S DRGFY=$O(^ICD0(CODE,2,"B",DRGFY),-1) Q:'DRGFY!(DAMDC>0)  D
"RTN","ICDREF",22,0)
 .S DADRGFY=$O(^ICD0(CODE,2,"B",+$G(DRGFY),DADRGFY))
"RTN","ICDREF",23,0)
 .S DAMDC=$O(^ICD0(CODE,2,+DADRGFY,1,"B",ICDMDC,DAMDC))
"RTN","ICDREF",24,0)
 Q
"RTN","ICDTLB1A")
0^5^B17763950
"RTN","ICDTLB1A",1,0)
ICDTLB1A ;ALB/EG - GROUPER UTILITY FUNCTIONS FY 2005; 8/19/04 3:19pm ; 6/15/05 6:35pm
"RTN","ICDTLB1A",2,0)
 ;;18.0;DRG Grouper;**14,17**;Oct 20, 2000
"RTN","ICDTLB1A",3,0)
DRG1 D DRG528 D:ICDRG'=528 DRG543^ICDTLB6A D:ICDRG'=543 DRG529
"RTN","ICDTLB1A",4,0)
 S ICDRG=$S(AGE<18:3,ICDRG=528:528,ICDRG=543:543,ICDRG=529:529,ICDRG=530:530,ICDCC:1,1:2) I AGE="" S ICDRTC=3,ICDRG=470
"RTN","ICDTLB1A",5,0)
 Q
"RTN","ICDTLB1A",6,0)
DRG2 D DRG1
"RTN","ICDTLB1A",7,0)
 Q
"RTN","ICDTLB1A",8,0)
DRG3 D DRG1
"RTN","ICDTLB1A",9,0)
 Q
"RTN","ICDTLB1A",10,0)
DRG7 S ICDRG=$S(ICDCC:7,1:8) Q
"RTN","ICDTLB1A",11,0)
DRG8 S ICDRG=$S(ICDCC:7,1:8) Q
"RTN","ICDTLB1A",12,0)
DRG10 S ICDRG=$S(ICDCC:10,1:11) Q
"RTN","ICDTLB1A",13,0)
DRG11 S ICDRG=$S(ICDCC:10,1:11) Q
"RTN","ICDTLB1A",14,0)
DRG16 S ICDRG=$S(ICDCC:16,1:17) Q
"RTN","ICDTLB1A",15,0)
DRG17 S ICDRG=$S(ICDCC:16,1:17) Q
"RTN","ICDTLB1A",16,0)
DRG18 S ICDRG=$S(ICDCC:18,1:19) Q
"RTN","ICDTLB1A",17,0)
DRG19 S ICDRG=$S(ICDCC:18,1:19) Q
"RTN","ICDTLB1A",18,0)
DRG24 S ICDRG=$S(AGE<18:26,ICDCC:24,1:25) I AGE="" S ICDRTC=3,ICDRG=470
"RTN","ICDTLB1A",19,0)
 Q
"RTN","ICDTLB1A",20,0)
DRG25 S ICDRG=$S(AGE<18:26,ICDCC:24,1:25) I AGE="" S ICDRTC=3,ICDRG=470
"RTN","ICDTLB1A",21,0)
 Q
"RTN","ICDTLB1A",22,0)
DRG26 S ICDRG=$S(AGE<18:26,ICDCC:24,1:25) I AGE="" S ICDRTC=3,ICDRG=470
"RTN","ICDTLB1A",23,0)
 Q
"RTN","ICDTLB1A",24,0)
DRG27 S ICDRG=$S(ICDPD[1!(ICDSD[1):27,AGE="":470,AGE<18:30,ICDCC:28,1:29),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB1A",25,0)
DRG28 D DRG27 Q
"RTN","ICDTLB1A",26,0)
DRG29 D DRG27 Q
"RTN","ICDTLB1A",27,0)
DRG30 D DRG27 Q
"RTN","ICDTLB1A",28,0)
DRG31 S ICDRG=$S(AGE<18:33,ICDCC:31,1:32) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",29,0)
 Q
"RTN","ICDTLB1A",30,0)
DRG32 S ICDRG=$S(AGE<18:33,ICDCC:31,1:32) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",31,0)
 Q
"RTN","ICDTLB1A",32,0)
DRG33 S ICDRG=$S(AGE<18:33,ICDCC:31,1:32) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",33,0)
 Q
"RTN","ICDTLB1A",34,0)
DRG34 S ICDRG=$S(ICDCC:34,1:35) Q
"RTN","ICDTLB1A",35,0)
DRG35 S ICDRG=$S(ICDCC:34,1:35) Q
"RTN","ICDTLB1A",36,0)
DRG39 D VER^ICDDRG2 Q
"RTN","ICDTLB1A",37,0)
DRG40 S ICDRG=$S(AGE>17:40,1:41) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",38,0)
 Q
"RTN","ICDTLB1A",39,0)
DRG41 S ICDRG=$S(AGE>17:40,1:41) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",40,0)
 Q
"RTN","ICDTLB1A",41,0)
DRG46 S ICDRG=$S(AGE<18:48,ICDCC:46,1:47) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",42,0)
 Q
"RTN","ICDTLB1A",43,0)
DRG47 S ICDRG=$S(AGE<18:48,ICDCC:46,1:47) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",44,0)
 Q
"RTN","ICDTLB1A",45,0)
DRG48 S ICDRG=$S(AGE<18:48,ICDCC:46,1:47) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",46,0)
 Q
"RTN","ICDTLB1A",47,0)
DRG53 S ICDRG=$S(AGE>17:53,1:54) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",48,0)
 Q
"RTN","ICDTLB1A",49,0)
DRG54 S ICDRG=$S(AGE>17:53,1:54) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",50,0)
 Q
"RTN","ICDTLB1A",51,0)
DRG57 S ICDRG=$S((ICDOPCT>0)&($P(ICDY(0),U,1)="28.3"):$S(AGE>17:59,1:60),ICDOPCT>0:$S(AGE>17:57,1:58),AGE>17:59,1:60) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",52,0)
 Q
"RTN","ICDTLB1A",53,0)
DRG58 S ICDRG=$S(ICDOPCT>1:$S(AGE>17:57,1:58),AGE>17:59,1:60) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",54,0)
 Q
"RTN","ICDTLB1A",55,0)
DRG59 D EN1^ICDDRG3 I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",56,0)
 Q
"RTN","ICDTLB1A",57,0)
DRG60 D EN1^ICDDRG3 I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",58,0)
 Q
"RTN","ICDTLB1A",59,0)
DRG61 S ICDRG=$S(AGE>17:61,1:62) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",60,0)
 Q
"RTN","ICDTLB1A",61,0)
DRG62 S ICDRG=$S(AGE>17:61,1:62) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",62,0)
 Q
"RTN","ICDTLB1A",63,0)
DRG68 S ICDRG=$S(AGE<18:70,ICDCC:68,1:69) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",64,0)
 Q
"RTN","ICDTLB1A",65,0)
DRG69 S ICDRG=$S(AGE<18:70,ICDCC:68,1:69) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",66,0)
 Q
"RTN","ICDTLB1A",67,0)
DRG70 S ICDRG=$S(AGE<18:70,ICDCC:68,1:69) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",68,0)
 Q
"RTN","ICDTLB1A",69,0)
DRG73 S ICDRG=$S(AGE>17:73,1:74) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",70,0)
 Q
"RTN","ICDTLB1A",71,0)
DRG74 S ICDRG=$S(AGE>17:73,1:74) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",72,0)
 Q
"RTN","ICDTLB1A",73,0)
DRG75 S ICDRG=$S($D(ICDODRG(474)):474,1:ICDRG) Q
"RTN","ICDTLB1A",74,0)
DRG76 S ICDRG=$S($D(ICDODRG(474)):474,ICDCC:76,1:77) Q
"RTN","ICDTLB1A",75,0)
DRG77 S ICDRG=$S($D(ICDODRG(474)):474,ICDCC:76,1:77) Q
"RTN","ICDTLB1A",76,0)
DRG78 S ICDRG=$S(ICDPD["X"&(ICDOR["H"):124,ICDSD["X"&(ICDOR["H"):124,1:78) Q
"RTN","ICDTLB1A",77,0)
DRG79 S ICDRG=$S(AGE<18:81,ICDCC:79,1:80) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",78,0)
 Q
"RTN","ICDTLB1A",79,0)
DRG80 S ICDRG=$S(AGE<18:81,ICDCC:79,1:80) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",80,0)
 Q
"RTN","ICDTLB1A",81,0)
DRG81 S ICDRG=$S(AGE<18:81,ICDCC:79,1:80) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",82,0)
 Q
"RTN","ICDTLB1A",83,0)
DRG83 S ICDRG=$S(ICDCC:83,1:84) Q
"RTN","ICDTLB1A",84,0)
DRG84 S ICDRG=$S(ICDCC:83,1:84) Q
"RTN","ICDTLB1A",85,0)
DRG85 S ICDRG=$S(ICDCC:85,1:86) Q
"RTN","ICDTLB1A",86,0)
DRG86 S ICDRG=$S(ICDCC:85,1:86) Q
"RTN","ICDTLB1A",87,0)
DRG89 S ICDRG=$S(AGE<18:91,ICDCC:89,1:90) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",88,0)
 Q
"RTN","ICDTLB1A",89,0)
DRG90 S ICDRG=$S(AGE<18:91,ICDCC:89,1:90) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",90,0)
 Q
"RTN","ICDTLB1A",91,0)
DRG91 S ICDRG=$S(AGE<18:91,ICDCC:89,1:90) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB1A",92,0)
 Q
"RTN","ICDTLB1A",93,0)
DRG92 S ICDRG=$S(ICDCC!($D(ICDSDRG(92))):92,1:93) Q
"RTN","ICDTLB1A",94,0)
DRG93 S ICDRG=$S(ICDCC:92,1:93) Q
"RTN","ICDTLB1A",95,0)
DRG94 S ICDRG=$S(ICDCC:94,1:95) Q
"RTN","ICDTLB1A",96,0)
DRG528 S ICDRG=$S((ICDPD["K")&(ICDOR["K"):528,1:ICDRG) Q
"RTN","ICDTLB1A",97,0)
DRG529 S ICDRG=$S((ICDOR["S")&(ICDCC):529,(ICDOR["S")&('ICDCC):530,1:ICDRG) Q
"RTN","ICDTLB1A",98,0)
DRG530 D DRG529 Q
"RTN","ICDTLB6A")
0^6^B36834501
"RTN","ICDTLB6A",1,0)
ICDTLB6A ;ALB/EG/MRY - GROUPER UTILITY FUNCTIONS FY 2005; 9/29/03 2:47pm ; 6/16/05 1:31pm
"RTN","ICDTLB6A",2,0)
 ;;18.0;DRG Grouper;**14,17**;Oct 20, 2000
"RTN","ICDTLB6A",3,0)
DRG403 S ICDRG=$S(ICDPD["l":$S(AGE="":470,AGE<18:405,1:473),ICDOR["O"!(ICDORNI["O"):$S(ICDCC:401,1:402),ICDCC:403,1:404),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",4,0)
DRG404 S ICDRG=$S(ICDPD["l":$S(AGE="":470,AGE<18:405,1:473),ICDOR["O"!(ICDORNI["O"):$S(ICDCC:401,1:402),ICDCC:403,1:404),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",5,0)
DRG405 D DRG404 Q
"RTN","ICDTLB6A",6,0)
DRG406 ;
"RTN","ICDTLB6A",7,0)
 I ICDORNI["K" D
"RTN","ICDTLB6A",8,0)
 .S ICDRG=$S((ICDPD["L")&(ICDCC):539,ICDPD["L":540,ICDCC:406,1:407)
"RTN","ICDTLB6A",9,0)
 I ICDORNI'["K" D DRG408
"RTN","ICDTLB6A",10,0)
 Q
"RTN","ICDTLB6A",11,0)
DRG407 D DRG406 Q
"RTN","ICDTLB6A",12,0)
DRG408 I $D(ICDDX(1))&(ICDOPCT=0) D  Q:ICDRG=409
"RTN","ICDTLB6A",13,0)
 .I ICDDX(1)=$O(^ICD9("AB","V58.0 ",0)) S ICDRG=409 Q
"RTN","ICDTLB6A",14,0)
 .I ICDDX(1)=$O(^ICD9("AB","V67.1 ",0)) S ICDRG=409 Q
"RTN","ICDTLB6A",15,0)
 .Q
"RTN","ICDTLB6A",16,0)
 I $D(ICDDX(1))&(ICDOPCT=0) D  Q:"410^492"[ICDRG
"RTN","ICDTLB6A",17,0)
 .I ICDDX(1)=$O(^ICD9("AB","V58.1 ",0)) S ICDRG=$S(ICDSD["2":492,1:410) Q
"RTN","ICDTLB6A",18,0)
 .I ICDDX(1)=$O(^ICD9("AB","V67.2 ",0)) S ICDRG=$S(ICDSD["2":492,1:410) Q
"RTN","ICDTLB6A",19,0)
 I ICDOPCT>0 S ICDRG=$S(ICDPD'["L":408,ICDCC:401,1:402) Q
"RTN","ICDTLB6A",20,0)
 I ICDOPCT=0 D DRG412
"RTN","ICDTLB6A",21,0)
 Q
"RTN","ICDTLB6A",22,0)
DRG411 S ICDRG=$S(ICDOR["O"!(ICDORNI["O"):408,ICDOR["N":412,1:411) Q
"RTN","ICDTLB6A",23,0)
DRG412 ;S ICDRG=$S(ICDOR["O"!(ICDORNI["O"):408,ICDOR["N"&($D(ICDPDRG(412))):412,$D(ICDPDRG(411)):411,ICDCC:413,1:414)
"RTN","ICDTLB6A",24,0)
 I ICDOPCT>0 D DRG408 Q
"RTN","ICDTLB6A",25,0)
 D DRG412^ICDTLB61
"RTN","ICDTLB6A",26,0)
 Q
"RTN","ICDTLB6A",27,0)
DRG413 S ICDRG=$S(ICDCC:413,1:414) Q
"RTN","ICDTLB6A",28,0)
DRG414 S ICDRG=$S(ICDCC:413,1:414) Q
"RTN","ICDTLB6A",29,0)
DRG416 S ICDRG=$S(ICDOR["O":415,AGE="":470,AGE>17:416,1:417),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",30,0)
DRG417 S ICDRG=$S(ICDOR["O":415,AGE="":470,AGE>17:416,1:417),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",31,0)
DRG418 S ICDRG=$S(ICDOR["O":415,1:418) Q
"RTN","ICDTLB6A",32,0)
DRG419 S ICDRG=$S(ICDOR["O":415,AGE="":470,AGE<18:422,ICDCC:419,1:420),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",33,0)
DRG420 S ICDRG=$S(ICDOR["O":415,AGE="":470,AGE<18:422,ICDCC:419,1:420),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",34,0)
DRG421 S ICDRG=$S(ICDOR["O":415,AGE="":470,AGE>17:421,1:422),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",35,0)
DRG422 S ICDRG=$S(ICDOR["O":415,AGE="":470,AGE>17:421,1:422),ICDRTC=$S(ICDRG=470:3,1:ICDRTC) Q
"RTN","ICDTLB6A",36,0)
DRG423 S ICDRG=$S(ICDOR["O":415,1:423) Q
"RTN","ICDTLB6A",37,0)
DRG424 S ICDRG=$S(ICDOR["O":424,1:425) Q
"RTN","ICDTLB6A",38,0)
DRG425 S ICDRG=$S(ICDOR["O":424,1:425) Q
"RTN","ICDTLB6A",39,0)
DRG426 S ICDRG=$S(ICDOR["O":424,1:426) Q
"RTN","ICDTLB6A",40,0)
DRG427 S ICDRG=$S(ICDOR["O":424,1:427) Q
"RTN","ICDTLB6A",41,0)
DRG428 S ICDRG=$S(ICDOR["O":424,1:428) Q
"RTN","ICDTLB6A",42,0)
DRG429 S ICDRG=$S(ICDOR["O":424,1:429) Q
"RTN","ICDTLB6A",43,0)
DRG430 S ICDRG=$S(ICDOR["O":424,1:430) Q
"RTN","ICDTLB6A",44,0)
DRG431 S ICDRG=$S(ICDOR["O":424,1:431) Q
"RTN","ICDTLB6A",45,0)
DRG432 S ICDRG=$S(ICDOR["O":424,1:432) Q
"RTN","ICDTLB6A",46,0)
DRG434 S ICDRG=$S(ICDPD["t"!(ICDSD["t"):$S(ICDOR["D":437,ICDOR["R":436,ICDCC:434,1:435),ICDCC:434,1:435) Q
"RTN","ICDTLB6A",47,0)
DRG435 S ICDRG=$S(ICDPD["t"!(ICDSD["t"):$S(ICDOR["D":437,ICDOR["R":436,ICDCC:434,1:435),ICDCC:434,1:435) Q
"RTN","ICDTLB6A",48,0)
DRG436 S ICDRG=$S(ICDPD["t"!(ICDSD["t"):$S(ICDOR["D":437,ICDOR["R":436,ICDCC:434,1:435),ICDCC:434,1:435) Q
"RTN","ICDTLB6A",49,0)
DRG437 S ICDRG=$S(ICDPD["t"!(ICDSD["t"):$S(ICDOR["D":437,ICDOR["R":436,ICDCC:434,1:435),ICDCC:434,1:435) Q
"RTN","ICDTLB6A",50,0)
DRG439 S ICDRG=$S($D(ICDODRG(440)):440,1:439) Q
"RTN","ICDTLB6A",51,0)
DRG442 S ICDRG=$S(ICDCC:442,1:443) Q
"RTN","ICDTLB6A",52,0)
DRG443 D EN1^ICDDRG5 S ICDRG=$S(ICDCC3:$S(ICDCC:442,1:443),1:"") Q
"RTN","ICDTLB6A",53,0)
DRG444 S ICDRG=$S(AGE<18:446,ICDCC:444,1:445) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",54,0)
 Q
"RTN","ICDTLB6A",55,0)
DRG445 S ICDRG=$S(AGE<18:446,ICDCC:444,1:445) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",56,0)
 Q
"RTN","ICDTLB6A",57,0)
DRG446 S ICDRG=$S(AGE<18:446,ICDCC:444,1:445) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",58,0)
 Q
"RTN","ICDTLB6A",59,0)
DRG447 S ICDRG=$S(AGE>17:447,1:448) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",60,0)
 Q
"RTN","ICDTLB6A",61,0)
DRG448 S ICDRG=$S(AGE>17:447,1:448) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",62,0)
 Q
"RTN","ICDTLB6A",63,0)
DRG449 S ICDRG=$S(AGE<18:451,ICDCC:449,1:450) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",64,0)
 Q
"RTN","ICDTLB6A",65,0)
DRG450 S ICDRG=$S(AGE<18:451,ICDCC:449,1:450) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",66,0)
 Q
"RTN","ICDTLB6A",67,0)
DRG451 S ICDRG=$S(AGE<18:451,ICDCC:449,1:450) I AGE="" S ICDRG=470,ICDRTC=3
"RTN","ICDTLB6A",68,0)
 Q
"RTN","ICDTLB6A",69,0)
DRG452 S ICDRG=$S(ICDCC:452,1:453) Q
"RTN","ICDTLB6A",70,0)
DRG453 S ICDRG=$S(ICDCC:452,1:453) Q
"RTN","ICDTLB6A",71,0)
DRG454 S ICDRG=$S(ICDCC:454,1:455) Q
"RTN","ICDTLB6A",72,0)
DRG455 S ICDRG=$S(ICDCC:454,1:455) Q
"RTN","ICDTLB6A",73,0)
DRG462 S ICDRG=$S(ICDOR["O":461,1:462) Q
"RTN","ICDTLB6A",74,0)
DRG463 S ICDRG=$S(ICDOR["O":461,ICDCC:463,1:464) Q
"RTN","ICDTLB6A",75,0)
DRG464 S ICDRG=$S(ICDOR["O":461,ICDCC:463,1:464) Q
"RTN","ICDTLB6A",76,0)
DRG465 S ICDRG=$S(ICDOR["O":461,ICDSD["m":465,1:466) Q
"RTN","ICDTLB6A",77,0)
DRG466 S ICDRG=$S(ICDOR["O":461,ICDSD["m":465,1:466) Q
"RTN","ICDTLB6A",78,0)
DRG467 S ICDRG=$S(ICDOR["O":461,1:467) Q
"RTN","ICDTLB6A",79,0)
DRG471 S ICDRG=$S($F($P(ICDOR,"M",2,99),"M"):471,1:"") Q
"RTN","ICDTLB6A",80,0)
DRG475 S ICDRG=$S(ICDOR["V":475,1:$S($D(ICDPDRG):$O(ICDPDRG(0)),1:468)) I ICDRG<468 D DODRG^ICDDRG0
"RTN","ICDTLB6A",81,0)
 Q
"RTN","ICDTLB6A",82,0)
DRG478 S ICDRG=$S(ICDOR["O"&ICDCC:478,1:479) Q
"RTN","ICDTLB6A",83,0)
DRG479 S ICDRG=$S(ICDOR["O"&ICDCC:478,1:479) Q
"RTN","ICDTLB6A",84,0)
DRG493 ;I (ICDI-1)=1,'ICDCC S ICDCC=$S($D(^ICD9("ACC",ICDDX(1),ICDDX(1))):1,1:0)
"RTN","ICDTLB6A",85,0)
 S ICDRG=$S(ICDCC:493,1:494) Q
"RTN","ICDTLB6A",86,0)
DRG494 ;I (ICD-1),'ICDCC S ICDCC=$S($D(^ICD9("ACC",ICDDX(1),ICDDX(1))):1,1:0)
"RTN","ICDTLB6A",87,0)
 S ICDRG=$S(ICDCC:493,1:494) Q
"RTN","ICDTLB6A",88,0)
DRG495 Q
"RTN","ICDTLB6A",89,0)
DRG496 S ICDRG=$S(ICDOR["F":496,ICDCC:497,1:498) Q
"RTN","ICDTLB6A",90,0)
DRG497 S ICDRG=$S(ICDOR["F":496,ICDCC:497,1:498) Q
"RTN","ICDTLB6A",91,0)
DRG498 S ICDRG=$S(ICDOR["F":496,ICDCC:497,1:498) Q
"RTN","ICDTLB6A",92,0)
DRG499 S ICDRG=$S(ICDCC:499,1:500) Q
"RTN","ICDTLB6A",93,0)
DRG500 S ICDRG=$S(ICDCC:499,1:500) Q
"RTN","ICDTLB6A",94,0)
DRG501 D
"RTN","ICDTLB6A",95,0)
 . I (ICDPD["k") D
"RTN","ICDTLB6A",96,0)
 .. I ICDCC S ICDRG=501
"RTN","ICDTLB6A",97,0)
 .. I 'ICDCC S ICDRG=502
"RTN","ICDTLB6A",98,0)
 . E  S ICDRG=503
"RTN","ICDTLB6A",99,0)
 Q
"RTN","ICDTLB6A",100,0)
DRG502 D DRG501 Q
"RTN","ICDTLB6A",101,0)
DRG503 D DRG501 Q
"RTN","ICDTLB6A",102,0)
DRG514 ; Replaced with DRG535
"RTN","ICDTLB6A",103,0)
 N ICDE1,ICDE2
"RTN","ICDTLB6A",104,0)
 S ICDE1=$S($D(ICDOP(" 37.95"))&($D(ICDOP(" 37.96"))):1,1:0)
"RTN","ICDTLB6A",105,0)
 S ICDE2=$S($D(ICDOP(" 37.97"))&($D(ICDOP(" 37.98"))):1,1:0)
"RTN","ICDTLB6A",106,0)
 S ICDRG=470
"RTN","ICDTLB6A",107,0)
 I $D(ICDOP(" 37.94")) I ICDE1+ICDE2=0 S ICDRG=515
"RTN","ICDTLB6A",108,0)
 I '$D(ICDOP(" 37.94")) I ICDE1!ICDE2 S ICDRG=515
"RTN","ICDTLB6A",109,0)
 ; "HN" in ICDOR represents OR proc 37.21-.23, 37.26, 88.52-.58
"RTN","ICDTLB6A",110,0)
 I ICDRG=515 I ICDOR["HN" S ICDRG=514
"RTN","ICDTLB6A",111,0)
 Q
"RTN","ICDTLB6A",112,0)
DRG515 D DRG535 Q
"RTN","ICDTLB6A",113,0)
DRG516 I ICDOR["1" S ICDRG=518
"RTN","ICDTLB6A",114,0)
 I (ICDOR["1") I $D(ICDOP(" 36.06"))!($D(ICDOP(" 92.27"))) S ICDRG=517
"RTN","ICDTLB6A",115,0)
 I (ICDOR["1")&(ICDPD["AIC") S ICDRG=516
"RTN","ICDTLB6A",116,0)
 I (ICDOR["1")&(ICDPD["AIC")&$D(ICDOP(" 36.07")) S ICDRG=526
"RTN","ICDTLB6A",117,0)
 I (ICDOR["1")&(ICDPD'["AIC")&$D(ICDOP(" 36.07")) S ICDRG=527 ; ICD*18*5
"RTN","ICDTLB6A",118,0)
 Q
"RTN","ICDTLB6A",119,0)
DRG517 D DRG516 Q
"RTN","ICDTLB6A",120,0)
DRG518 D DRG516 Q
"RTN","ICDTLB6A",121,0)
DRG519 S ICDRG=$S(ICDOR["F":496,ICDCC:519,1:520) Q
"RTN","ICDTLB6A",122,0)
DRG520 D DRG519 Q
"RTN","ICDTLB6A",123,0)
DRG521 S ICDRG=$S(ICDCC:521,ICDOR["D"!(ICDOR["R"):522,1:523) Q
"RTN","ICDTLB6A",124,0)
DRG522 D DRG521 Q
"RTN","ICDTLB6A",125,0)
DRG523 D DRG521 Q
"RTN","ICDTLB6A",126,0)
DRG526 D DRG516 Q
"RTN","ICDTLB6A",127,0)
DRG527 D DRG516 Q
"RTN","ICDTLB6A",128,0)
DRG531 S ICDRG=$S(ICDCC:531,1:532) Q
"RTN","ICDTLB6A",129,0)
DRG532 D DRG531 Q
"RTN","ICDTLB6A",130,0)
DRG533 S ICDRG=$S(ICDCC:533,1:534) Q
"RTN","ICDTLB6A",131,0)
DRG534 D DRG533 Q
"RTN","ICDTLB6A",132,0)
DRG535 N ICDE1,ICDE2,ICDE3
"RTN","ICDTLB6A",133,0)
 S ICDE1=$S($D(ICDOP(" 37.95"))&(($D(ICDOP(" 37.96")))!($D(ICDOP(" 00.54")))):1,1:0)
"RTN","ICDTLB6A",134,0)
 S ICDE2=$S($D(ICDOP(" 37.97"))&(($D(ICDOP(" 37.98")))!($D(ICDOP(" 00.54")))):1,1:0)
"RTN","ICDTLB6A",135,0)
 S ICDE3=$S($D(ICDOP(" 00.52"))&($D(ICDOP(" 00.54"))):1,1:0)
"RTN","ICDTLB6A",136,0)
 ;S ICDE4=$S($D(ICDOP(" 00.54"))&($D(ICDOP(" 37.95"))):1,1:0)
"RTN","ICDTLB6A",137,0)
 S ICDRG=470
"RTN","ICDTLB6A",138,0)
 I $D(ICDOP(" 37.94"))!$D(ICDOP(" 00.51")) I ICDE1+ICDE2+ICDE3=0 S ICDRG=515
"RTN","ICDTLB6A",139,0)
 I '$D(ICDOP(" 37.94"))&('$D(ICDOP(" 00.51"))) I ICDE1!ICDE2!ICDE3 S ICDRG=515
"RTN","ICDTLB6A",140,0)
 ; "HN" in ICDOR represents OR proc 37.21-.23, 37.26, 88.52-.58
"RTN","ICDTLB6A",141,0)
 I ICDRG=515 I ICDOR["HN" S ICDRG=$S(ICDPD["A":535,1:536)
"RTN","ICDTLB6A",142,0)
 I ICDRG=470 D DRG115^ICDTLB2A
"RTN","ICDTLB6A",143,0)
 Q
"RTN","ICDTLB6A",144,0)
DRG536 D DRG535 Q
"RTN","ICDTLB6A",145,0)
DRG537 S ICDRG=$S(ICDCC:537,1:538) Q
"RTN","ICDTLB6A",146,0)
DRG538 D DRG537 Q
"RTN","ICDTLB6A",147,0)
DRG539 I ICDPD["L"&(ICDMAJ'[3) D DRG401^ICDTLB5A Q:"401^402^403^404^405^470^473"[ICDRG
"RTN","ICDTLB6A",148,0)
 S ICDRG=$S((ICDPD["L")&(ICDCC):539,ICDPD["L":540,ICDCC:406,1:407) Q
"RTN","ICDTLB6A",149,0)
DRG540 D DRG539 Q
"RTN","ICDTLB6A",150,0)
DRG543 S ICDRG=$S((ICDPD["Q")&(ICDOR["Q"):543,ICDOR["Q"&$D(ICDOP(" 00.10")):543,1:ICDRG)
"VER")
8.0^22.0
"BLD",6108,6)
^SEQ #17
**END**
**END**
