Released TIU*1*154 SEQ #138
Extracted from mail message
**KIDS**:TIU*1.0*154^

**INSTALL NAME**
TIU*1.0*154
"BLD",4062,0)
TIU*1.0*154^TEXT INTEGRATION UTILITIES^0^3021210^y
"BLD",4062,1,0)
^^2^2^3021210^^^^
"BLD",4062,1,1,0)
The description of this build is found in the National Patch Module under
"BLD",4062,1,2,0)
patch TIU*1*154.
"BLD",4062,4,0)
^9.64PA^^0
"BLD",4062,"KRN",0)
^9.67PA^8989.52^19
"BLD",4062,"KRN",.4,0)
.4
"BLD",4062,"KRN",.401,0)
.401
"BLD",4062,"KRN",.402,0)
.402
"BLD",4062,"KRN",.403,0)
.403
"BLD",4062,"KRN",.5,0)
.5
"BLD",4062,"KRN",.84,0)
.84
"BLD",4062,"KRN",3.6,0)
3.6
"BLD",4062,"KRN",3.8,0)
3.8
"BLD",4062,"KRN",9.2,0)
9.2
"BLD",4062,"KRN",9.8,0)
9.8
"BLD",4062,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4062,"KRN",9.8,"NM",1,0)
TIURB2^^0^B34032261
"BLD",4062,"KRN",9.8,"NM","B","TIURB2",1)

"BLD",4062,"KRN",19,0)
19
"BLD",4062,"KRN",19.1,0)
19.1
"BLD",4062,"KRN",101,0)
101
"BLD",4062,"KRN",409.61,0)
409.61
"BLD",4062,"KRN",771,0)
771
"BLD",4062,"KRN",870,0)
870
"BLD",4062,"KRN",8989.51,0)
8989.51
"BLD",4062,"KRN",8989.52,0)
8989.52
"BLD",4062,"KRN",8994,0)
8994
"BLD",4062,"KRN","B",.4,.4)

"BLD",4062,"KRN","B",.401,.401)

"BLD",4062,"KRN","B",.402,.402)

"BLD",4062,"KRN","B",.403,.403)

"BLD",4062,"KRN","B",.5,.5)

"BLD",4062,"KRN","B",.84,.84)

"BLD",4062,"KRN","B",3.6,3.6)

"BLD",4062,"KRN","B",3.8,3.8)

"BLD",4062,"KRN","B",9.2,9.2)

"BLD",4062,"KRN","B",9.8,9.8)

"BLD",4062,"KRN","B",19,19)

"BLD",4062,"KRN","B",19.1,19.1)

"BLD",4062,"KRN","B",101,101)

"BLD",4062,"KRN","B",409.61,409.61)

"BLD",4062,"KRN","B",771,771)

"BLD",4062,"KRN","B",870,870)

"BLD",4062,"KRN","B",8989.51,8989.51)

"BLD",4062,"KRN","B",8989.52,8989.52)

"BLD",4062,"KRN","B",8994,8994)

"BLD",4062,"QUES",0)
^9.62^^
"BLD",4062,"REQB",0)
^9.611^2^2
"BLD",4062,"REQB",1,0)
TEXT INTEGRATION UTILITIES 1.0^2
"BLD",4062,"REQB",2,0)
TIU*1.0*109^2
"BLD",4062,"REQB","B","TEXT INTEGRATION UTILITIES 1.0",1)

"BLD",4062,"REQB","B","TIU*1.0*109",2)

"MBREQ")
0
"PKG",193,-1)
1^1
"PKG",193,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",193,20,0)
^9.402P^^
"PKG",193,22,0)
^9.49I^1^1
"PKG",193,22,1,0)
1.0^3010321^3010321^11
"PKG",193,22,1,"PAH",1,0)
154^3021210
"PKG",193,22,1,"PAH",1,1,0)
^^2^2^3021210
"PKG",193,22,1,"PAH",1,1,1,0)
The description of this build is found in the National Patch Module under
"PKG",193,22,1,"PAH",1,1,2,0)
patch TIU*1*154.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","TIURB2")
0^1^B34032261
"RTN","TIURB2",1,0)
TIURB2 ; SLC/JER,AJB - More Review Screen Actions ;18-JAN-2002 12:27:10
"RTN","TIURB2",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**100,109,154**;Jun 20, 1997
"RTN","TIURB2",3,0)
 ; 2/3: Update TEXTEDIT from TIUEDIT to TIUEDI4
"RTN","TIURB2",4,0)
 ; 9/28 Moved DELETE, DEL, DELTEXT, DIK to new rtn TIURB2
"RTN","TIURB2",5,0)
 ; 8/2/02 DELTEXT logic to bypass user-response if called by GUI TIU*1*154
"RTN","TIURB2",6,0)
 ;        GODEL+12, changed direct access of DPT global to FM
"RTN","TIURB2",7,0)
 ;
"RTN","TIURB2",8,0)
DELETE ; Delete action
"RTN","TIURB2",9,0)
 N TIUI,TIUY,TIUCHNG,Y,DIROUT,DTOUT,DUOUT
"RTN","TIURB2",10,0)
 N TIULNO,TIUJ,PRNTDA,LSTDA
"RTN","TIURB2",11,0)
 I '$D(VALMY) D EN^VALM2(XQORNOD(0))
"RTN","TIURB2",12,0)
 S TIUI=0
"RTN","TIURB2",13,0)
 F  S TIUI=$O(VALMY(TIUI)) Q:+TIUI'>0  D  Q:$D(DIROUT)
"RTN","TIURB2",14,0)
 . N TIUDATA,DA,RSTRCTD
"RTN","TIURB2",15,0)
 . S TIUDATA=$G(^TMP("TIURIDX",$J,TIUI))
"RTN","TIURB2",16,0)
 . S DA=+$P(TIUDATA,U,2)
"RTN","TIURB2",17,0)
 . W !!,"Processing Item #",TIUI
"RTN","TIURB2",18,0)
 . L +^TIU(8925,+DA):1
"RTN","TIURB2",19,0)
 . E  D  Q
"RTN","TIURB2",20,0)
 . . W !?5,$C(7),"Another user is editing this entry."
"RTN","TIURB2",21,0)
 . . I $$READ^TIUU("EA","Press RETURN to continue...") W ""
"RTN","TIURB2",22,0)
 . . D PICK^TIULM(TIUI)
"RTN","TIURB2",23,0)
 . S RSTRCTD=$$DOCRES^TIULRR(DA)
"RTN","TIURB2",24,0)
 . I RSTRCTD D  Q
"RTN","TIURB2",25,0)
 . . W !!,$C(7),"Ok, no harm done...",! ; Echo denial message
"RTN","TIURB2",26,0)
 . . I $$READ^TIUU("EA","RETURN to continue...") ; pause
"RTN","TIURB2",27,0)
 . D DEL(DA)
"RTN","TIURB2",28,0)
 . L -^TIU(8925,+DA)
"RTN","TIURB2",29,0)
 ; -- Update or Rebuild list, restore video:
"RTN","TIURB2",30,0)
 S TIUCHNG("RBLD")=1
"RTN","TIURB2",31,0)
 D UPRBLD^TIURL(.TIUCHNG,.VALMY) K VALMY
"RTN","TIURB2",32,0)
 S VALMBCK="R"
"RTN","TIURB2",33,0)
 Q
"RTN","TIURB2",34,0)
DEL(DA) ; We don't hand out pencils, without erasers
"RTN","TIURB2",35,0)
GODEL ; -- Called from DEL^TIURB
"RTN","TIURB2",36,0)
 N CANDEL,TIUDA,TIUD0,TIUI,TIUDFLT,TIUPT,TIUVDT,TIUTYP,PROMPT,TIUAUDIT
"RTN","TIURB2",37,0)
 N TIUMSG,TIURSN,TIUVTYP,TIUABORT,ADDMPRNT,IDPRNT,TIUAUTH,TIUD12,STATUS
"RTN","TIURB2",38,0)
 L +^TIU(8925,+DA):1
"RTN","TIURB2",39,0)
 E  D  Q
"RTN","TIURB2",40,0)
 . W !?5,$C(7),"Another user is editing this entry."
"RTN","TIURB2",41,0)
 . I $$READ^TIUU("EA","Press RETURN to continue...") W ""
"RTN","TIURB2",42,0)
 I +$$HASIMG(DA) D IMGNOTE Q
"RTN","TIURB2",43,0)
 S TIUD0=$G(^TIU(8925,+DA,0)),TIUD12=$G(^(12))
"RTN","TIURB2",44,0)
 S TIUTYP=$$UP^XLFSTR($$PNAME^TIULC1(+TIUD0)),TIUAUTH=$P(TIUD12,U,2)
"RTN","TIURB2",45,0)
 S STATUS=$P(TIUD0,U,5),ADDMPRNT=+$P(TIUD0,U,6)
"RTN","TIURB2",46,0)
 S IDPRNT=+$P($G(^TMP("TIUR",$J,"IDDATA",DA)),U,3)
"RTN","TIURB2",47,0)
 S TIUPT=$$NAME^TIULS($P($G(^DPT(+$P(TIUD0,U,2),0)),U),"FIRST LAST")
"RTN","TIURB2",48,0)
 S TIUVDT=+$P(TIUD0,U,7)
"RTN","TIURB2",49,0)
 S TIUVDT=$$DATE^TIULS(TIUVDT,"MM/DD/YY"_$S($L(TIUVDT,".")=2:" HR:MIN",1:""))
"RTN","TIURB2",50,0)
 S TIUVTYP=$S(+$$ISDS^TIULX(+TIUD0):" Admission",1:" Visit")
"RTN","TIURB2",51,0)
 S TIUMSG="DELETING "_TIUTYP_" For "_TIUPT_"'s "_TIUVDT_TIUVTYP_"."
"RTN","TIURB2",52,0)
 S CANDEL=$$CANDO^TIULP(DA,"DELETE RECORD")
"RTN","TIURB2",53,0)
 I 'CANDEL W !!,$C(7),$C(7),$C(7),$P(CANDEL,U,2),! H 2 G DELX
"RTN","TIURB2",54,0)
 I $$HASIDKID^TIUGBR(DA) W !!,"This interdisciplinary parent cannot be deleted; it's entries must first",!,"be detached.",! H 3 G DELX
"RTN","TIURB2",55,0)
 I $O(^TIU(8925,"DAD",+DA,0))>0,$$HASADDEN^TIULC1(DA) D
"RTN","TIURB2",56,0)
 . W !!,"This "_TIUTYP_" has ADDENDA."
"RTN","TIURB2",57,0)
 W !,$C(7) F TIUI=1:1:$L(TIUMSG,"|") W !,$P(TIUMSG,"|",TIUI)
"RTN","TIURB2",58,0)
 W ! S PROMPT="Are you SURE you want to DELETE"
"RTN","TIURB2",59,0)
 I '$$READ^TIUU("YO",PROMPT,"NO") W !,"Nothing DELETED.",! H 2 S TIUCHNG=0 G DELX
"RTN","TIURB2",60,0)
 S PROMPT="DELETE the TEXT ONLY, leaving audit trail information"
"RTN","TIURB2",61,0)
 S TIUDA=DA
"RTN","TIURB2",62,0)
 I STATUS'>5,$S(DUZ=TIUAUTH:1,+$$ISA^USRLM(DUZ,"MEDICAL INFORMATION SECTION")'>0:1,1:0) S TIUAUDIT=0 I 1
"RTN","TIURB2",63,0)
 E  D  G:$D(TIUABORT) DELX
"RTN","TIURB2",64,0)
 . I +$P($G(^TIU(8925,+TIUDA,0)),U,5)'<6 S TIUAUDIT=1
"RTN","TIURB2",65,0)
 . E  D
"RTN","TIURB2",66,0)
 . . S TIUAUDIT=+$$READ^TIUU("YO",PROMPT,"NO")
"RTN","TIURB2",67,0)
 . . I $D(DTOUT)!($D(DUOUT)) D
"RTN","TIURB2",68,0)
 . . . W !,"Nothing DELETED.",!
"RTN","TIURB2",69,0)
 . . . S TIUCHNG=0,TIUABORT=1
"RTN","TIURB2",70,0)
 . . . I $$READ^TIUU("EA","Press RETURN to continue...") ; pause
"RTN","TIURB2",71,0)
 K ^TIU(8925,"ASAVE",DUZ,TIUDA) ; Remove SAVE-flag
"RTN","TIURB2",72,0)
 I +TIUAUDIT'>0 D  G DELX
"RTN","TIURB2",73,0)
 . W !,"DELETING Entire "_TIUTYP_" record.",!
"RTN","TIURB2",74,0)
 . D DELIRT^TIUDIRT(TIUDA),DIK(TIUDA) H 2
"RTN","TIURB2",75,0)
 . S TIUCHNG=2,TIUCHNG("DELETE")=1
"RTN","TIURB2",76,0)
 . D ALERTDEL^TIUALRT(TIUDA),DELSGNR^TIURB1(TIUDA)
"RTN","TIURB2",77,0)
 S PROMPT="Reason for DELETION (Privacy Act or Administrative): "
"RTN","TIURB2",78,0)
 S TIURSN=$P($$READ^TIUU("SA^P:privacy act;A:administrative",PROMPT,"PRIVACY ACT"),U)
"RTN","TIURB2",79,0)
 I '$L(TIURSN) D  G DELX
"RTN","TIURB2",80,0)
 . W !,"Nothing DELETED.",!
"RTN","TIURB2",81,0)
 . S TIUCHNG=0,TIUABORT=1
"RTN","TIURB2",82,0)
 . I $$READ^TIUU("EA","Press RETURN to continue...") ; pause
"RTN","TIURB2",83,0)
 D ALERTDEL^TIUALRT(TIUDA),DELSGNR^TIURB1(TIUDA)
"RTN","TIURB2",84,0)
 D DELTEXT(TIUDA,TIURSN),AUDEL^TIURB1(TIUDA,TIURSN) S TIUCHNG=1
"RTN","TIURB2",85,0)
DELX L -^TIU(8925,+DA)
"RTN","TIURB2",86,0)
 Q
"RTN","TIURB2",87,0)
DELTEXT(DA,TIURSN) ; After signature, only retraction possible
"RTN","TIURB2",88,0)
 N DR,DIE D FULL^VALM1
"RTN","TIURB2",89,0)
 W !!?5,$C(7),"***********************************************************************"
"RTN","TIURB2",90,0)
 W !?5,"*  This document will now be RETRACTED. As such, it has been removed  *"
"RTN","TIURB2",91,0)
 W !?5,"*    from public view, and from typical Releases of Information,      *"
"RTN","TIURB2",92,0)
 W !?5,"*          but will remain indefinitely discoverable to HIMS.         *"
"RTN","TIURB2",93,0)
 W !?5,"***********************************************************************",!
"RTN","TIURB2",94,0)
 S DIE=8925
"RTN","TIURB2",95,0)
 S DR="1610////^S X=+DUZ;1611////^S X=+$$NOW^XLFDT;1612////^S X=TIURSN"
"RTN","TIURB2",96,0)
 D ^DIE
"RTN","TIURB2",97,0)
 S DA=$$RETRACT^TIURD2(DA,"",14)
"RTN","TIURB2",98,0)
 ; *** 8/2/02 changes below *** ; TIU*1*154
"RTN","TIURB2",99,0)
 I '$$BROKER^XWBLIB D
"RTN","TIURB2",100,0)
 . I $$READ^TIUU("EA","Press RETURN to continue...")
"RTN","TIURB2",101,0)
 ; I $$READ^TIUU("EA","Press RETURN to continue...") ; pause ; original code
"RTN","TIURB2",102,0)
 Q
"RTN","TIURB2",103,0)
DIK(DA) ; Call ^DIK to delete the record
"RTN","TIURB2",104,0)
 N DIK,TIUTYP,TIUTYPE,TIUDA,TIUVSIT,TIUVKILL,TIUDELX S TIUDA=0
"RTN","TIURB2",105,0)
 F  S TIUDA=+$O(^TIU(8925,"DAD",+DA,TIUDA)) Q:+TIUDA'>0  D DIK(TIUDA)
"RTN","TIURB2",106,0)
 S TIUTYPE=+$G(^TIU(8925,+DA,0))
"RTN","TIURB2",107,0)
 S TIUTYP=$P($G(^TIU(8925.1,TIUTYPE,0)),U)
"RTN","TIURB2",108,0)
 S TIUVSIT=+$P($G(^TIU(8925,DA,0)),U,3),TIUDA=DA
"RTN","TIURB2",109,0)
 S TIUDELX=$$DELETE^TIULC1(TIUTYPE)
"RTN","TIURB2",110,0)
 I TIUDELX]"" X TIUDELX
"RTN","TIURB2",111,0)
 S DIK="^TIU(8925,"
"RTN","TIURB2",112,0)
 D ^DIK ; W:'$D(ZTQUEUED) "."
"RTN","TIURB2",113,0)
 D DELAUDIT^TIUEDI1(DA)
"RTN","TIURB2",114,0)
 D DELPROB^TIURB1(DA)
"RTN","TIURB2",115,0)
 D DELSGNR^TIURB1(DA)
"RTN","TIURB2",116,0)
 D DELIMG(DA)
"RTN","TIURB2",117,0)
 D ALERTDEL^TIUALRT(DA)
"RTN","TIURB2",118,0)
 ; **52** Disable call to $$DELVFILE^PXAPI 'til further notice
"RTN","TIURB2",119,0)
 ; I +TIUVSIT,$D(^AUPNVSIT(+TIUVSIT)) S TIUVKILL=$$DELVFILE^PXAPI("ALL",TIUVSIT,"","TEXT INTEGRATION UTILITIES")
"RTN","TIURB2",120,0)
 Q
"RTN","TIURB2",121,0)
HASIMG(TIUDA) ; Evaluate whether images are linked
"RTN","TIURB2",122,0)
 Q +$O(^TIU(8925.91,"B",TIUDA,0))
"RTN","TIURB2",123,0)
IMGNOTE ; Present Notice of Linked Images
"RTN","TIURB2",124,0)
 D FULL^VALM1
"RTN","TIURB2",125,0)
 W !!?5,$C(7),"***********************************************************************"
"RTN","TIURB2",126,0)
 W !?5,"* This document has linked images. You must ""delete"" the Images using *"
"RTN","TIURB2",127,0)
 W !?5,"*        the Imaging Package before proceeding with this action.      *"
"RTN","TIURB2",128,0)
 W !?5,"*      The images will be hidden from public view, but will remain    *"
"RTN","TIURB2",129,0)
 W !?5,"*                   indefinitely discoverable to HIMS.                *"
"RTN","TIURB2",130,0)
 W !?5,"***********************************************************************",!
"RTN","TIURB2",131,0)
 I $$READ^TIUU("EA","Press RETURN to continue...") ; pause
"RTN","TIURB2",132,0)
 Q
"RTN","TIURB2",133,0)
DELIMG(TIUDA) ; Remove linked images, when document deleted
"RTN","TIURB2",134,0)
 N DA,DIK S DIK="^TIU(8925.91,",DA=0
"RTN","TIURB2",135,0)
 F  S DA=$O(^TIU(8925.91,"B",TIUDA,DA)) Q:+DA'>0  D ^DIK
"RTN","TIURB2",136,0)
 Q
"VER")
8.0^22.0
**END**
**END**
