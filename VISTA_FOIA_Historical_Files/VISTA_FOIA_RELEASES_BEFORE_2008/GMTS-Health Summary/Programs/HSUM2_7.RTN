Saved by %RS from [DVA,DEV] on 20-OCT-1995 15:21:24.90
GMTS* routines for Health Summary version 2.7.
GMTS
GMTS	;SLC/DLT - Health Summary Main Routine ;11/16/92  15:46 ;
	;;2.7;Health Summary;;Oct 20, 1995
	; ACC/IHS/TPA 05/13/87
MAIN	; Controls branching
	; GMTSPXGO & GMRANGE are set in 2 calling options, They aren't meant
	; to be used together.
	I +$G(GMTSPXGO)'>0,$L($T(PATIENT^ORU1)),($$VERSION^XPDUTL("OR")>2.19) D MAIN^GMTSDVR Q
	N DIROUT,DUOUT,ZTRTN,GMTSPX1,GMTSPX2,GMNAME,GMPSAP
	S GMTSTYP=0 K DIC,DIROUT,DUOUT
	S DIC("B")=$P($G(^GMT(142,+$G(^DISV(+$G(DUZ),"^GMT(142,")),0)),U)
	F  Q:$D(DIROUT)!$D(DUOUT)  D SELTYP Q:GMTSTYP'>0!$D(DIROUT)!$D(DUOUT)  D
	. N GMPAT,DFN,GMTSMULT
	. F  Q:$D(DIROUT)  D  Q:$D(DIROUT)!$D(DUOUT)!(+$D(GMPAT)'>0)
	. . K GMPAT,GMTSMULT
	. . F  Q:$D(DIROUT)  K DFN D SELPT Q:DFN'>0!$D(DIROUT)!$D(DUOUT)  D  Q:$D(DUOUT)!$D(DIROUT)
	. . . S (GMTSPX1,GMTSPX2)=""
	. . . I +$G(GMTSPXGO)>0 D MENU^GMTSPXU2(DFN,.GMTSPX2,.GMTSPX1) I $G(GMTSPX1)']""!($G(GMTSPX2)']"") D  Q
	. . . . W:'$D(DUOUT)&('$D(DIROUT)) !,GMNAME," not included in display.",!
	. . . Q:$D(DUOUT)!$D(DIROUT)
	. . . S GMPAT(GMNAME_(9999999-GMTSPX1),+DFN)=+DFN_U_$G(GMTSPX1)_U_$G(GMTSPX2)
	. . Q:$D(DIROUT)!$D(DUOUT)!(+$D(GMPAT)'>0)
	. . I +$G(GMRANGE)>0 D GETRANGE^GMTSU(.GMTSPX1,.GMTSPX2) Q:$G(GMTSPX1)=""!($G(GMTSPX2)="")
	. . Q:$D(DUOUT)!$D(DIROUT)
	. . D RESUB^GMTSDVR(.GMPAT)
	. . S GMPSAP=$$RXAP^GMTSPD2 Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)
	. . S ZTRTN="PQ^GMTS"
	. . D HSOUT^GMTSDVR,END W !
	K GMTSTYP,GMTSTITL,GMTSEG,GMTSEGI,GMTSEGC,GMX,DFN,X,Y,I
	Q
SELTYP	; Select a Health Summary Type for printing
	Q:GMTSTYP=-1  S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEQM",DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION"""
	D ^DIC K DIC S GMTSTYP=+Y,GMTSTITL=$S($D(^GMT(142,+Y,"T")):^("T"),1:"") S:GMTSTITL="" GMTSTITL=$P(Y,"^",2)
	I GMTSTYP>0,$S($D(^GMT(142,GMTSTYP,1,0))=0:1,$O(^(0))'>0:1,1:0) W !,"This Summary Type includes no components...Please choose another." G SELTYP
SELTYP1	; Loop through HS Type and call LOADSEG to get each component record
	K GMTSEG,GMTSEGI S (GMI,S1)=0 F  S S1=$O(^GMT(142,GMTSTYP,1,S1)) Q:'S1  S GMX=^(S1,0) D LOADSEG
	S GMTSEGC=GMI K S1,S2,GMI
	Q
LOADSEG	; Load ENABLED COMPONENTS into GMTSEG array
	S GMTS0=^GMT(142.1,$P(GMX,"^",2),0)
	S GMI=GMI+1,GMTSEG(GMI)=GMX,GMTSEGI($P(GMX,U,2))=GMI D SELFILE
	Q
SELPT	; Select a patient for printing of Health Summary
	N DIC
	S DIC=2,DIC("A")="Select Patient: ",DIC(0)="AEQMZ"
	S:+$G(GMTSMULT) DIC("A")="Select Another Patient: "
	D ^DIC
	S DFN=+Y,GMNAME=$G(Y(0,0))
	S:X="^" GMTSTYP=-1
	S:+Y GMTSMULT=1
	Q
SELFILE	; Loop through SELECTION ITEM multiple and load GMTSEG( with ITEMS
	S S2=0 F  S S2=$O(^GMT(142,GMTSTYP,1,S1,1,S2)) Q:'S2  S ENTRY=^(S2,0),GMTSEG(GMI,+$P(@(U_$P(ENTRY,";",2)_"0)"),U,2),S2)=$P(ENTRY,";") I S2=1 S GMTSEG(GMI,+$P(@(U_$P(ENTRY,";",2)_"0)"),U,2),0)=U_$P(ENTRY,";",2)
	Q
PQ	; Queued subroutine for HS by patient
	N DFN,GMTS,GMTS1,GMTS2,GMTSAGE,GMTSDOB,GMTSDTM,GMTSLO,GMTSLPG,GMTSPNM
	N GMTSRB,GMTSSN,GMTSTOF,GMTSWARD,GMTJ,I,IX0,J,M4,P17,SEX
	N TRFAC,VAERR,VAIN
	S GMTJ=0 F  S GMTJ=$O(GMPAT(GMTJ)) Q:GMTJ'>0!$D(DIROUT)  D
	. S DFN=+$G(GMPAT(GMTJ))
	. I +$G(GMTSPXGO)>0 S GMTSPX1=$P($G(GMPAT(GMTJ)),U,2) D
	. . S GMTSPX2=$P($G(GMPAT(GMTJ)),U,3)
	. . I +GMTSPX1'>0!+GMTSPX2'>0 K GMTSPX1,GMTSPX2
	. N GMDUOUT
	. D EN^GMTS1
	. Q:$D(DIROUT)!+$G(GMDUOUT)
	. D ACTPROF^GMTSDVR(DFN)
	Q
HSOUT	; Output Summary, with DEVICE handling
	K ZTSK
	I $D(^XUSEC("GMTS VIEW ONLY",DUZ)) D EN^GMTS1 Q
	K IOP S %ZIS="PQ" D ^%ZIS Q:POP
	G:$D(IO("Q")) QUE
NOQUE	; Print non-queued output to selected device
	D EN^GMTS1
	D ^%ZISC
	Q
QUE	; Call TaskMan to Queue output
	K IO("Q"),ZTSAVE F %="DFN","GMTS*","ENTRY" S ZTSAVE(%)=""
	S ZTRTN="EN^GMTS1",ZTDESC="HEALTH SUMMARY",ZTIO=ION
	D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!")
	K ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE D ^%ZISC
	S IOP="HOME" D ^%ZIS
	Q
END	; Clean up environmental variables and EXIT Health Summary
	K %T,DIC,GMTS,GMTSLO,GMTSPNM,GMTSRB,GMTSWARD,GMTSDOB,DIC,X,Y,VA,VAIN,VAINDT,VADM,VAEL,VAPA,VAERR,GMTSSN,GMTS0,GMTS1,GMTS2
	K GMTSAGE,GMTSTIM,GMTSEGN,GMTSEGH,GMTSEGL,GMTSHDR,GMTSNPG,GMTSPG,GMTSQIT,GMTSX,ENTRY,Z1,GMTSDTM,GMTSLOCK,GMTSLPG,SEX,POP,C,GMTSTOF
	Q
ENCWA	;Entry point printing components
	;GMTSPRM can be set to any component abbreviations except ones that 
	;require selection items. Needs to be valid component abbreviation 
	;from the "C" x-ref of File 142.1.
	;
	;call with DFN,GMTSPRM="CD,CN,CW,ADR",GMTSTITL="TITLE"
	;          GMTSPX1=Optional internal FM date for range ending date
	;          GMTSPX2=Optional internal FM date for range beginning date
	;  NOTE: Optional date range variables are both required if a date range
	;        is desired.
	N GMI,GMJ,GMTSEG,GMTSEGI,GMTSEGC
	S GMTS1="9999999",GMTS2="6666666",GMI=0,GMTSPNF=1
	I '$D(GMTSPRM) W !,"The parameter GMTSPRM is undefined.",! Q
	I '$D(GMTSTITL) W !,"The parameter GMTSTITL is undefined.",! Q
	I '+$G(DFN) W !,"The parameter DFN is undefined.",! Q
	F GMJ=1:1:$L(GMTSPRM,",") S ABB=$P(GMTSPRM,",",GMJ) D LOAD Q:GMJ=-1
	S GMTSEGC=GMI K ABB,IFN
	D EN^GMTS1
	D END K GMTSEG,GMTSEGI,GMTSEGC,GMTSTITL,GMTSPRM,GMTSPNF
	Q
LOAD	; Load GMTSEG() using GMTSPRM abbreviations
	S IFN=$O(^GMT(142.1,"C",ABB,"")) Q:IFN=""
	S GMI=GMI+1,GMTSEG(GMI)=GMI_"^"_IFN,GMTSEGI(IFN)=GMI
	Q

GMTS1
GMTS1	;SLC/DLT,JER - Health Summary Driver ;11/16/92  08:37 ;
	;;2.7;Health Summary;;Oct 20, 1995
EN	; ***** ENTRY TO GENERATE A SUMMARY
	; ***** REQUIRES DFN,GMTSTITL,GMTSEG(),GMTSEGI(),GMTSEGC,DUZ(2)
	; ***** $I & IO MUST BE VALID, CALLER MUST CLOSE OUTPUT DEVICE
	;
START	;
	N GMSUPRES,GMTSICF,GMTSPXD1,GMTSPXD2,GMTSBEG,GMTSEND
	S GMSUPRES=$P($G(^GMT(142,+$G(GMTSTYP),0)),U,5)
	U IO S GMTSLO=$S(IOSL'>64:3,1:(IOSL-64)+3),GMTSLPG=0
	D DEM^GMTSU
	W:$E(IOST)="C" @IOF D OUTPUT
	K GMTSCVD,GMTSCKP,GMTSNPG,GMTSPG,GMTSQIT,GMTSHDR,GMTSHD2,GMTSBRK,GMTSLCMP,GMTSDTC
	K GMTSEGN,GMTSE,GMTSEGR,GMTSEQ,GMTSEGH,GMTSEGL,GMTSDLM,GMTSDLS,GMTSNDM,GMTSN,GMTSQ
	Q
	;
OUTPUT	; Loop through GMTSEG()
	D NOW^%DTC S X=% D REGDTM^GMTSU S GMTSDTM=X
	I +$G(GMTSPX1)&+$G(GMTSPX2) D  ;Allows date range for data
	. S GMTS2=9999999-$P(GMTSPX2,"."),GMTS1=9999999-($P(GMTSPX1,".")_".99")
	. ;For GMTS1 want to get everything till Midnight
	. S X=GMTSPX1 D REGDT^GMTSU S GMTSPXD1=X
	. S X=GMTSPX2 D REGDT^GMTSU S GMTSPXD2=X
	D HEADER^GMTSUP
	K GMTSQIT S GMTSEGN=""
	F  S GMTSEGN=$O(GMTSEG(GMTSEGN)) Q:GMTSEGN=""  K GMTSQIT S GMTSEQ=$P(GMTSEG(GMTSEGN),U,1),GMTSE=$P(GMTSEG(GMTSEGN),U,2) D SEGMNT D:GMTSEGN=GMTSEGC LASTPG I $D(GMTSQIT),(GMTSQIT="") Q
	S GMTSHDR=$E(GMTSHDR,1,3)_" END "_$E(GMTSHDR,9,79)
	W:$E(IOST)'="C" !,GMTSHDR,!
	H:$E(IOST)="C" 1 W:'+$G(GMPSAP) @IOF
	I $D(GMTSQIT) D EXIT
	Q
	;
LASTPG	;ALLOWS USER TO BRANCH TO AN EARLIER COMPONENT ON THE LAST PAGE
	Q:$E(IOST)'="C"!$D(GMTSQIT)
	F I=$Y:1:(IOSL-GMTSLO) W !
	I $D(GMTSQIT),(GMTSQIT>0) K GMTSQIT
	S GMTSLPG=1 D CKP^GMTSUP
	Q
	;
EXIT	K ZTSK
	Q
	;
SEGMNT	; OUTPUT A COMPONENT TYPE
	N GMTSLOCK,GMTSDBL,GMOOTXT,GMPXICDF,GMPXHLOC,GMPXNARR,GMTSWRIT,GMSEL
	I $D(GMTSQIT),(GMTSQIT]"") K GMTSQIT
	S X=^GMT(142.1,GMTSE,0),GMTSEGH=$S($P(X,U,4)]"":$P(X,U,4)_" - ",1:"")_$S($P(GMTSEG(GMTSEGN),U,5)]"":$P(GMTSEG(GMTSEGN),U,5),$P(X,U,9)]"":$P(X,U,9),1:" "_$P(X,U,1)),GMTSEGR=$P(X,"^",2) Q:GMTSEGR=""
	S GMTSLOCK=$P(X,U,7)
	S GMTSDBL=$P(X,U,6),GMOOTXT=$P(X,U,8)
	S GMPXHLOC=$P(GMTSEG(GMTSEGN),U,6),GMPXNARR=$P(GMTSEG(GMTSEGN),U,8)
	S GMPXICDF=$P(GMTSEG(GMTSEGN),U,7)
	S GMTSNDM=$P(GMTSEG(GMTSEGN),U,3),GMTSDLM=$P(GMTSEG(GMTSEGN),U,4) S:GMTSNDM="" GMTSNDM=-1
	S:+$G(GMTSPX1)&+$G(GMTSPX2) GMTSDLM="" ;Allows date range for data
	S GMTSDLS=""
	I GMTSDLM?1N.N!(GMTSDLM?1N.N1"D") S GMTSDLS=+GMTSDLM_" day"
	S:GMTSDLM?1N.N1"W" GMTSDLS=+GMTSDLM_" week",GMTSDLM=+GMTSDLM*7
	S:GMTSDLM?1N.N1"M" GMTSDLS=+GMTSDLM_" month",GMTSDLM=+GMTSDLM*30
	S:GMTSDLM?1N.N1"Y" GMTSDLS=+GMTSDLM_" year",GMTSDLM=+GMTSDLM*365
	S GMTSDLM=+GMTSDLM
	S:+GMTSDLS>1 GMTSDLS=GMTSDLS_"s"
	S GMTSEGL="" I GMTSNDM>0!(GMTSDLM>0) S GMTSEGL=" (max "_$S(GMTSNDM>0:GMTSNDM_$S(GMTSNDM=1:" occurrence",1:" occurrences")_$S(GMTSDLM>0:" or ",1:""),1:"")_$S(GMTSDLM>0:GMTSDLS,1:"")_")"
	K GMTSDLS,GMTSN
	D NOW^%DTC S GMTSDTC=%,DT=$P(%,".") K %,%H,%I
	I +$G(GMTSPX1)'>0!(+$G(GMTSPX2)'>0) D  ;Use date range unless variables empty
	. I GMTSDLM'>0 S (GMTS2,GMTSDLM)=9999999,GMTS1=6666666 ;GMTS1=MOST RECENT INVERTED DATE,GMTS2=TO DATE IN PAST IN INVERTED FORMAT
	. E  S X1=GMTSDTC,X2=-GMTSDLM D C^%DTC S GMTSDLM=9999999-X,GMTS2=GMTSDLM,GMTS1=9999999-(GMTSDTC+.0001) K X1,X2
	;Set GMTSBEG to be GMTS2 uninverted
	S GMTSBEG=$S(GMTS2=9999999:1,1:9999999-GMTS2)
	;Set GMTSEND to be GMTS1 uninverted
	S GMTSEND=$S(GMTS1=6666666:9999999,$P(GMTS1,".",2)="01":$P(9999999-GMTS1,".")_".235959",1:9999999-GMTS1)
	S GMTSWRIT=1 ;Variable is used to print component heading on 1st write
	I GMTSDBL]"",("PT"[GMTSDBL) D  Q
	. D:GMTSDBL="T" TDISBLD^GMTS2
	. D:GMTSDBL="P"&$D(GMTSPRM) PDISBLD^GMTS2
	I GMTSLOCK]"",('$D(^XUSEC(GMTSLOCK,DUZ))) D NOMATCH^GMTS2 Q
	S GMSEL=$P($G(^GMT(142.1,GMTSE,1,1,0)),U)
	I GMSEL]"",$O(GMTSEG(GMTSEGN,GMSEL,0))'>0 D NOSELECT^GMTS2 Q
	S GMTSNPG=0
	D @($P(GMTSEGR,";",1)_U_$P(GMTSEGR,";",2))
	D NODATA^GMTS2
	K GMTSDLM
	Q

GMTS2
GMTS2	;SLC/SBW - Health Summary Driver Cont. ;8-FEB-94
	;;2.7;Health Summary;;Oct 20, 1995
TDISBLD	; Handles temporarily disabled components
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Temporarily disabled",!
	I GMOOTXT]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W GMOOTXT,!
	Q
PDISBLD	; Handles permanently disabled components
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Permanently disabled",!
	I GMOOTXT]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W GMOOTXT,!
	Q
NOMATCH	; Handles case where user doesn't hold component lock
	W "This component is locked with security key "_GMTSLOCK_".",!
	Q
NOSELECT	; Handles cases where components that require selection items
	;         have no selection items defined.
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W "No selection items chosen for this component.",!
	Q
NODATA	; This will display "No Data Available", No Segments
	N SELNAME
	I $D(GMTSQIT),(GMTSQIT="") Q
	Q:GMTSWRIT=0
	I $E(IOST,1)'="C" Q:$G(GMSUPRES)="Y"
	I GMSEL]"" D GETSEL,DISPSEL Q
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "No data available",!
	Q
GETSEL	;If no data and comp. contains selection items, get selection items
	N GMX,GMI,GMDA,GMFROOT,GMROOT,GMNODE
	S GMFROOT=$G(GMTSEG(GMTSEGN,GMSEL,0))
	Q:GMFROOT=""
	S (GMX,GMI)=0
	F  S GMI=$O(GMTSEG(GMTSEGN,GMSEL,GMI)) Q:GMI'>0  D
	. S GMDA=$G(GMTSEG(GMTSEGN,GMSEL,GMI))
	. S GMROOT=GMFROOT_GMDA_",0)"
	. S GMNODE=$G(@GMROOT)
	. I GMDA]"",GMROOT]"" S GMX=GMX+1,SELNAME(GMX)=$P(GMNODE,U)
	Q
DISPSEL	;Display selection items
	N GMI,GMX
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "No data available for "
	S (GMI,GMX)=0
	F  S GMI=$O(SELNAME(GMI)) Q:GMI'>0  D
	. S GMX=GMX+1
	. W:GMX>1 "; "
	. W:(77)'>($X+$L(SELNAME(GMI))) !
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W SELNAME(GMI)
	W !
	Q

GMTSADH
GMTSADH	;SLC/JER,MAM - Ad Hoc Summary Driver ;9/28/92  11:53
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N C,DFN,GMTSEG,GMTSEGI,GMTSEGC,GMTSQIT,GMTSTYP,GMTSTITL,GMW,X,Y
	N DIC,DIPGM,I,POP,%,DIROUT,DUOUT,DTOUT,ZTRTN
	N GMTSQIT,FROM,GMI,I1,ISVALID,LRDFN,PTR,SEX,TO,VAOA,VASD,VASV
	I $L($T(PATIENT^ORU1)),($$VERSION^XPDUTL("OR")>2.19) D MAIN^GMTSADHC Q
	S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" D ^DIC K DIC S GMTSTYP=+Y,GMTSTITL="AD HOC"
	F  K GMTSEG,GMTSEGI,GMTSEGC D BUILD D  Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT) 
	. N GMPAT,DFN,GMTSMULT
	. F  D  Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)!(+$D(GMPAT)'>0)
	. . Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)
	. . K GMPAT,GMTSMULT
	. . F  Q:$D(DIROUT)  K DFN W ! D SELPT^GMTS Q:DFN'>0  S GMPAT(GMNAME,+DFN)=+DFN
	. . Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)!(+$D(GMPAT)'>0)
	. . D RESUB^GMTSDVR(.GMPAT)
	. . S ZTRTN="PQ^GMTS"
	. . N DUOUT
	. . D HSOUT^GMTSDVR,END^GMTS W !
	Q
BUILD	; Conducts Dialogue to build ad hoc summary
	N GMI,GMJ,GMW,X,XQORM,Y
	Q:$D(GMTSQIT)!($D(DIROUT))
	W @IOF
	S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")",XQORM("M")=6
	S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="AD",XQORM("A")="Select NEW set of COMPONENT(S): ",XQORM("??")="D HELP^GMTSADH" D ^XQORM I Y'>0 S DIROUT=1 Q
	I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G BUILD
	S GMTSEGC=Y
	S (X,GMI,GMJ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  D LOAD
	D GETLIM^GMTSADH1
	Q
LOAD	; Load enabled components into GMTSEG
	N SREC,STRN
	S STRN=+Y(GMI),SREC=^GMT(142,GMTSTYP,1,STRN,0)
LOAD1	; Load an individual component into GMTSEG( and GMTSEGI(
	S GMJ=GMJ+1,GMTSEG(GMJ)=SREC,GMTSEGI($P(SREC,U,2))=GMJ D LOADSEL
	Q
LOADSEL	; Loads GMTSEG(J,FN,IFN), when Selection items are present
	N S2,SJ,SEL
	S S2=0,SJ=GMJ
	F  S S2=$O(^GMT(142,GMTSTYP,1,STRN,1,S2)) Q:'S2  S SEL=^(S2,0),GMTSEG(GMJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),S2)=$P(SEL,";") I S2=1 S GMTSEG(SJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),0)=U_$P(SEL,";",2)
	Q
HELP	; 
	N GMJ,GMTSTXT,HLP
	S HLP=$S(X="??":"HTX2",X="?":"HTX1",1:"") I $L(HLP) W ! F GMJ=1:1 S GMTSTXT=$T(@HLP+GMJ) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
	I X="???" W !! D HELP2^GMTSUP1
	D REDISP
	Q
REDISP	; Ask Whether or not to redisplay menu
	N I,DIR,X,Y
	S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
	W @IOF
	D DISP^XQORM1 W !
	Q
HTX1	;;Help Text for "?" and "??"
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;Enter: ??  to see HELP for MULTIPLE SELECTION
	;;       ??? to see HELP for "^^"-jump
	;;
	;;ZZZZ
HTX2	; HELP for ??
	;;
	;;The Health Summary components you select at this prompt create
	;;an ADHOC Health Summary.
	;;
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;ALL items may be selected by typing "ALL".
	;;
	;;EXCEPTIONS may be entered by preceding them with a minus.
	;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
	;;
	;;NOTE: Menu items are ordered alphabetically by the Component NAME.
	;;      However, the displayed text is the Header Name which generally 
	;;      is different from the Component Name. Component may be picked
	;;      by their abbreviation, Header Name or Component Name.
	;;
	;;ZZZZ

GMTSADH1
GMTSADH1	;SLC/JER,MAM - Ad Hoc Summary Driver ;3/24/92  10:41
	;;2.7;Health Summary;;Oct 20, 1995
GETLIM	; Drives acquisition of new time and occurrence limits, sel items,
	; hospital loc display, ICD text display and Provider Narr display
	N LISTFLG,GMCHANGE,GMW,QUIT
	S GMCHANGE=0 D LIST
	F  S LISTFLG=0 D ASKCMPS Q:$D(QUIT)!$D(DIROUT)
	Q
LIST	; Lists defaults for ad hoc summary
	S LISTFLG=1,GMCHANGE=0
	W @IOF,!,"                      Default Limits and Selection Items",!!
	W "     Component              Occ    Time   Hosp  ICD    Prov  Selection",!
	W "                            Limit  Limit  Loc   Text   Narr  Item(s)",!
	N FLG,DTOUT S FLG=0
LIST1	; Called by GMTSUP to list components at help prompt
	; GMTSUP sets FLG=1 for AD HOC HST, FLG=2 for other HST
	N GMI,DIR,DUOUT,GMW
	S DIR(0)="E"
	S GMI=0 F  S GMI=$O(GMTSEG(GMI)) Q:GMI'>0  D SCRNLNTH Q:$D(DUOUT)!($D(DTOUT))  D LISTLIM D:($D(GMTSEG(GMI))=11)&('FLG) LISTSEL Q:$D(DUOUT)!($D(DTOUT))
	Q
SCRNLNTH	; Checks screen length
	I $Y>(IOSL-4) W ! D ^DIR S:$D(DTOUT) DIROUT="" Q:$D(DUOUT)!($D(DTOUT))  W @IOF
	Q
LISTLIM	; Lists abbr, name, and, if not called by GMTSUP, limits for 
	; particular component. Includes Hosp Loc, ICD Text, & Provider Narr.
	N CREC S CREC=^GMT(142.1,$P(GMTSEG(GMI),U,2),0) W ! I FLG=2 D STAR
	W $P(CREC,U,4),?5,$S($L($P(GMTSEG(GMI),U,5)):$P(GMTSEG(GMI),U,5),$L($P(CREC,U,9)):$P(CREC,U,9),1:$E($P(CREC,U),1,24))
	W:'FLG ?28,$P(GMTSEG(GMI),U,3),?35,$P(GMTSEG(GMI),U,4),?42,$P(GMTSEG(GMI),U,6),?48,$E($P(GMTSEG(GMI),U,7),1,5),?55,$P(GMTSEG(GMI),U,8)
	Q
STAR	; Writes * to indicate added component when called by GMTSUP
	; for HST other than AD HOC
	I $D(^GMT(142,TYP,1,"C",$P(GMTSEG(GMI),U,2))) W " "
	E  W "*"
	Q
LISTSEL	; Lists default selection items for particular component
	N GMW,GMJ,GML
	S +GMJ=$O(GMTSEG(GMI,0)),GML=0
	F GMW=1:1 S GML=$O(GMTSEG(GMI,GMJ,GML)) Q:GML=""  D SCRNLNTH Q:$D(DUOUT)!($D(DTOUT))  W:GMW'=1 ! W ?61,$E($P(@(GMTSEG(GMI,GMJ,0)_GMTSEG(GMI,GMJ,GML)_",0)"),U),1,18)
	Q
ASKCMPS	; Asks for components for new limits/sel items, or new components
	N GMI,GMW,GMX,ASKCPQIT,DIC,X,XQORM,Y
	W:LISTFLG !!,"To change limits, selection items, hospital location display, ICD text display, or provider narrative display, enter components, one at a time or more than one, separated by commas.  You may select new components if you wish."
	S XQORM=GMTSTYP_";GMT(142,",XQORM("??")="D HELP^GMTSADH3",XQORM(0)="A",XQORM("A")="Select COMPONENT(S) to EDIT or other COMPONENT(S) to ADD: " D ^XQORM
	S:$D(DTOUT)!(X="^^") (DIROUT,QUIT)=1 I $D(DIROUT) Q
	I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G ASKCMPS
	I $S(X="^":1,X=""&(GMCHANGE=0):1,1:0) S QUIT="" Q
	I X="",GMCHANGE D ASKLIST Q
	I X["^" W "  ??" Q
	S GMCHANGE=1
	S GMI=0 F  S GMI=$O(Y(GMI)) Q:GMI=""  S GMX=^GMT(142,+GMTSTYP,1,+Y(GMI),0) W !!,$P(Y(GMI),U,3) D CMPCOND Q:$D(DUOUT)!($D(DIROUT))
	S:'$D(DIROUT) LISTFLG=1
	Q
CMPCOND	; Deals with particular component for new limits/sel items, or new comp
	N OLD,SBS,CREC,SREC,STRN,CPCDQIT
	S OLD=0 I $D(GMTSEGI($P(GMX,U,2))) S SBS=GMTSEGI($P(GMX,U,2)),OLD=1
	S CREC=^GMT(142.1,$P(GMX,U,2),0)
	I OLD=0 S GMTSEGC=GMTSEGC+1,SREC=GMX,STRN=+GMX D LOAD1^GMTSADH S SBS=GMJ
	D CMPLIM^GMTSADH2
	Q
ASKLIST	; Asks whether to relist Component Limits and Sel Items
	N DIR,X,Y
	S DIR(0)="YA",DIR("A")="Would you like to see Component Limits and Selection Items again?  (Y/N): ",DIR("B")="NO" W ! D ^DIR
	I Y'>0,(GMCHANGE=1) S QUIT=1 Q
	S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
	I $D(DIRUT),'$D(DUOUT) W "  ??"
	I $D(DIRUT)!(Y=0) Q
	D LIST
	Q

GMTSADH2
GMTSADH2	;SLC/JER,MAM - Ad Hoc Summary Driver ;2/6/92  13:39
	;;2.7;Health Summary;;Oct 20, 1995
CMPLIM	; Gets limits and sel items for particular component, if applicable
	N GMTSFUNC
	I $P(CREC,U,5)="Y" D GETOCC^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
	I $P(CREC,U,3)="Y" D GETIME^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
	I $P(CREC,U,10)="Y" D GETHOSP^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
	I $P(CREC,U,11)="Y" D GETICD^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
	I $P(CREC,U,12)="Y" D GETPROV^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
	D GETNAME^GMTSADH4 I $D(DIROUT)!$D(DUOUT) Q
	N SEL I $D(^GMT(142.1,$P(GMTSEG(SBS),U,2),1,1,0)) S SEL=$P(^(0),U,1) I SEL D SELECT
	Q
SELECT	; Gets Selection Items, where applicable
	N GMTSF,GMTSJ,GETSLQIT,GMI,DIC,X,Y,TEMP,SELCNT
	S GMTSJ=$O(GMTSEG(SBS,0)),GMTSF=1
	I GMTSJ W !,"Default selection items are   " D SHOWDEF
	S SELCNT=$P(^GMT(142.1,$P(GMTSEG(SBS),U,2),1,1,0),U,2)
	W ! W:GMTSJ "Push Return at the first prompt to select default items.",!
	W "Select new "_$P($G(^DIC(SEL,0)),U)_" items one at a time in the sequence",!,"you want them displayed. "
	W "You may select " I SELCNT="" W "any number of items.",!
	E  W "up to ",SELCNT," items.",!
	F GMI=1:1 D GETSEL Q:$D(DIROUT)!(Y=-1)!$S(+SELCNT:(GMI'<+SELCNT),1:0)
	I +SELCNT,(GMI'<+SELCNT) W !?2,$C(7),"MAXIMUM # OF ITEMS SELECTED.",!
	Q
GETSEL	;updates GMTSEG array with selections
	;Using read so that can do special processing when entering a "?".
	W !,"Select "_$P($G(^DIC(SEL,0)),U)_" Selection Item: "
	R X:DTIME
	I X="^^" S Y=0,DIROUT=1 Q
	I X="^" S Y=-1,(GETSLQIT,ASKCPQIT)="" Q
	I X["?" W:$O(GMTSEG(SBS,0)) !!,"Current Selection items are   " D SHOWDEF
	S DIC(0)="EMQ",DIC=^DIC(SEL,0,"GL")
	I SEL=60 S DIC("S")="I $P(^(0),U,4)=""CH"",""BO""[$P(^(0),U,3)"
	I SEL=9999999.64 S DIC("S")="I $P(^(0),U,10)=""C"",+$P(^(0),U,11)'=1"
	I SEL=811.9 S DIC("S")="I +$P(^(0),U,6)'=1"
	D ^DIC
	I $D(DTOUT) S DIROUT=1
	I $D(DIROUT) Q
	I $D(DUOUT) S (GETSLQIT,ASKCPQIT)="" Q
	I X["?" S Y="",GMI=GMI-1 Q
	I X]"",Y=-1 S Y=0,GMI=GMI-1 Q  ;Continue selecting items when incorrect item entered
	Q:Y=-1
	I GMTSF&(X'="") K GMTSEG(SBS,SEL) S GMTSF=0,GMTSEG(SBS,SEL,0)=DIC
	I DIC="^LAB(60,",'$L($P(^LAB(60,+Y,0),U,5)) D RESOLVE(+Y,.GMTSEG,.GMI) Q
	S GMTSEG(SBS,SEL,GMI)=+Y
	Q
SHOWDEF	; Writes out loaded (default) selection items
	N GMTSN,GMTSWHL
	I $G(GMTSJ)']"" S GMTSJ=$O(GMTSEG(SBS,0)) I GMTSJ']"" W !!,"No SELECTION ITEMS chosen.",! Q
	S GMTSN=0 F GMTSWHL=1:1 S GMTSN=$O(GMTSEG(SBS,+GMTSJ,GMTSN)) Q:GMTSN=""  W:GMTSWHL>1 ! W ?30,$P(@(GMTSEG(SBS,GMTSJ,0)_GMTSEG(SBS,GMTSJ,GMTSN)_",0)"),U)
	Q
RESOLVE(GMREF,GMTSEG,GMI)	; Call ORUS to resolve compound items
	N SELCT,GMJ,GMHEAD,X,Y K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW")
	S GMI=GMI-1 ;This subroutine will increment GMI if any item are picked
	;            Need to decrement by one so it works right
	I +$G(SELCNT) S SELCT=SELCNT-GMI ;Don't exceed allowed # of selection
	; items. Needed if other items were selected before starting this call.
	S GMHEAD="-- "_$P($G(^LAB(60,+GMREF,.1)),U)_" --"
	S ^XUTL("OR",$J,"GMTS",0)="LAB TEST^1^^0" D COMPILE(+GMREF)
	I $P(^XUTL("OR",$J,"GMTS",0),U,4)'>0 D  Q
	. K ^XUTL("OR",$J,"GMTS"),GMTSEG(SBS,SEL,0)
	. W $C(7),"  INVALID TEST...Please choose another." ;S GMI=GMI-1
	S ORUS="^XUTL(""OR"","_$J_",""GMTS"",",ORUS(0)="40MN"_$S(+$G(SELCT):U_$S($P(^XUTL("OR",$J,"GMTS",0),U,4)'<SELCT:SELCT,1:$P(^XUTL("OR",$J,"GMTS",0),U,4)),1:""),ORUS("T")="D HEADER^GMTSADH2"
	S ORUS("A")="Select"_$S(+$P(ORUS(0),U,2):" 1 - "_+$P(ORUS(0),U,2),1:"")_" LAB TEST(s): "
	S ORUS("B")=$S(+$P(ORUS(0),U,2):"1-"_+$P(ORUS(0),U,2),1:"ALL")
	D EN^ORUS K ^XUTL("OR",$J,"GMTS"),^("ORU"),^("ORV"),^("ORW")
	Q:+Y'>0
	S GMJ=0
	F  S GMJ=$O(Y(GMJ)) Q:GMJ'>0  D  ;Q:+SELCNT&(GMI'<+SELCNT)
	. S GMI=GMI+1
	. S GMTSEG(SBS,SEL,GMI)=+Y(GMJ)
	Q
COMPILE(GMTEST)	; Compile menu for ORUS call
	N GMC,GMI,GMJ,GMROOT
	S GMI=0 F  S GMI=$O(^LAB(60,GMTEST,2,GMI)) Q:GMI'>0  D
	. S GMJ=+$G(^LAB(60,GMTEST,2,+GMI,0))
	. S GMROOT=$G(^LAB(60,+GMJ,0))
	. I $L($P(GMROOT,U,5)),("BO"[$P(GMROOT,U,3)) D
	. . S GMC=+$P($G(^XUTL("OR",$J,"GMTS",0)),U,4)+1
	. . S ^XUTL("OR",$J,"GMTS",GMJ,0)=$P(GMROOT,U),$P(^XUTL("OR",$J,"GMTS",0),U,4)=GMC
	. E  D COMPILE(+$G(^LAB(60,GMTEST,2,GMI,0)))
	Q
HEADER	; Write Header
	W !!?15,"Select the tests which you wish to include, in the",!?19,"sequence in which you wish them to appear."
	W !!?((80-$L(GMHEAD))\2),GMHEAD,!
	Q

GMTSADH3
GMTSADH3	;SLC/JER,MAM - Ad Hoc Summary Driver - Help ;7/2/91  15:08
	;;2.7;Health Summary;;Oct 20, 1995
HELP	; Offers help at Select Additional or Existing COMPONENT(S): prompt
	N GMJ,GMTSTXT,HLP
	S HLP=$S(X="??":"HTX2",X="?":"HTX1",1:"") I $L(HLP) W ! F GMJ=1:1 S GMTSTXT=$T(@HLP+GMJ) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
	I X="???" W !! D HELP2^GMTSUP1
	D REDISP
	Q
REDISP	; Ask Whether or not to redisplay menu
	N I,DIR,X,Y
	S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
	W @IOF
	D DISP^XQORM1 W !
	Q
HTX1	;;Help Text for "?"
	;;NOTE: At this point, any selections made are added to the list of
	;;      previous selections.  Any exceptions (-THIS, -THAT) DO NOT REMOVE
	;;      components from previous selections.  Exceptions only apply to the
	;;      selections you are about to make.
	;;
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;Enter: ??  to see HELP for MULTIPLE SELECTION
	;;       ??? to see HELP for "^^"-jump
	;;
	;;ZZZZ
HTX2	;;Help Text for "??"
	;;NOTE: At this point, any selections made are added to the list of
	;;      previous selections.  Any exceptions (-THIS, -THAT) DO NOT REMOVE
	;;      components from previous selections.  Exceptions only apply to the
	;;      selections you are about to make.
	;;
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;ALL items may be selected by typing "ALL".
	;;
	;;EXCEPTIONS may be entered by preceding them with a minus.
	;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
	;;
	;;NOTE: Menu items are ordered alphabetically by the Component NAME.
	;;      However, the displayed text is the Header Name which generally 
	;;      is different from the Component Name. Component may be picked
	;;      by their abbreviation, Header Name or Component Name.
	;;
	;;ZZZZ

GMTSADH4
GMTSADH4	;SLC/SBW - Continuation of Ad Hoc Summary Driver ;2/9/94  09:33
	;;2.7;Health Summary;;Oct 20, 1995
GETOCC	; Gets Occurrence Limit, where applicable
	N DIR,X,Y
	S DIR(0)="142.01,2O",DIR("A")="OCCURRENCE LIMIT",DIR("B")=$P(GMTSEG(SBS),U,3) D ^DIR
	S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
	I $D(DUOUT) Q
	I X["^" W "  ??" G GETOCC
	S $P(GMTSEG(SBS),U,3)=Y
	Q
GETIME	; Gets Time Limit, where applicable
	N DIR,X,Y
	S DIR(0)="142.01,3O",DIR("A")="TIME LIMIT",DIR("B")=$P(GMTSEG(SBS),U,4) D ^DIR
	S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
	I $D(DUOUT) Q
	I X["^" W "  ??" G GETIME
	S $P(GMTSEG(SBS),U,4)=Y
	Q
GETNAME	; Gets Header Name for Component
	N DIR,X,Y
	S DIR(0)="142.01,5O" S:$L($P(GMTSEG(SBS),U,5)) DIR("B")=$P(GMTSEG(SBS),U,5) D ^DIR
	S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
	I $D(DUOUT) Q
	I X["^" W "  ??" G GETIME
	S $P(GMTSEG(SBS),U,5)=Y
	Q
GETHOSP	; Gets Hospital Location displayed, where applicable
	N DIR,X,Y
	S DIR(0)="142.01,6O",DIR("A")="Hospital Location displayed",DIR("B")=$P(GMTSEG(SBS),U,6) D ^DIR
	S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
	I $D(DUOUT) Q
	I X["^" W "  ??" G GETHOSP
	S $P(GMTSEG(SBS),U,6)=Y
	Q
GETICD	; Gets ICD Text displayed, where applicable
	N DIR,X,Y
	S DIR(0)="142.01,7O",DIR("A")="ICD Text displayed",DIR("B")=$P(GMTSEG(SBS),U,7) D ^DIR
	S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
	I $D(DUOUT) Q
	I X["^" W "  ??" G GETICD
	S $P(GMTSEG(SBS),U,7)=Y
	Q
GETPROV	; Gets Provider Narrative displayed, where applicable
	N DIR,X,Y
	S DIR(0)="142.01,8O",DIR("A")="Provider Narrative displayed",DIR("B")=$P(GMTSEG(SBS),U,8) D ^DIR
	S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
	I $D(DUOUT) Q
	I X["^" W "  ??" G GETPROV
	S $P(GMTSEG(SBS),U,8)=Y
	Q

GMTSADHC
GMTSADHC	;SLC/JER - Ad Hoc Summary Driver ;12/6/91  11:05
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N I,XQORSPEW
	K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP")
	S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" D ^DIC K DIC S GMTSTYP=+Y,GMTSTITL="AD HOC"
	F  D  Q:$D(DUOUT)!$D(DIROUT)!'$D(GMTSEG)
	. K GMTSEG,GMTSEGI,GMTSEGC
	. D BUILD
	. Q:$D(DUOUT)!$D(DIROUT)!'$D(GMTSEG)
	. N GMPAT,GMP
	. F  Q:$D(DIROUT)  D  Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)
	. . K GMP,GMPAT
	. . F  Q:$D(DIROUT)  K ^XUTL("OR",$J,"ORLP"),GMP D PATIENT^ORU1(.GMP),PATCOPY^GMTSDVR(.GMP,.GMPAT) Q:$S($D(DUOUT):1,$D(DIROUT):1,'+$G(GMP):1,1:0)  D
	. . . W !!,"Another patient(s) can be selected."
	. . Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)
	. . D RESUB^GMTSDVR(.GMPAT)
	. . S ZTRTN="PQ^GMTSADHC"
	. . W !
	. . D HSOUT^GMTSDVR
	K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP")
	Q
PQ	; Queued subroutine to print Ad Hoc HS for each patient
	N GMTS,GMTS1,GMTS2,GMTSAGE,GMTSDOB,GMTSDTM,GMTSLO,GMTSLPG
	N GMTSPNM,GMTSRB,GMTSSN,GMTSTOF,GMTSWARD,VADM,VAERR,VAIN,VAROOT
	S GMPAT=0 F  S GMPAT=$O(GMPAT(GMPAT)) Q:GMPAT'>0  D  Q:$D(GMTSQIT)!$D(DIROUT)
	. S DFN=+$G(GMPAT(GMPAT)) D EN^GMTS1
	Q
BUILD	; Conducts Dialogue to build ad hoc summary
	N GMI,GMJ,X,XQORM,Y
	Q:$D(GMTSQIT)!($D(DIROUT))
	W @IOF
	S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")",XQORM("M")=6
	S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="AD",XQORM("A")="Select NEW set of COMPONENT(S): ",XQORM("??")="D HELP^GMTSADH" D ^XQORM I Y'>0 S GMTSQIT="" Q
	I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G BUILD
	S GMTSEGC=Y
	S (X,GMI,GMJ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  D LOAD
	D GETLIM^GMTSADH1
	Q
LOAD	; Load enabled components into GMTSEG
	N SREC,STRN
	S STRN=+Y(GMI),SREC=^GMT(142,GMTSTYP,1,STRN,0)
LOAD1	S GMJ=GMJ+1,GMTSEG(GMJ)=SREC,GMTSEGI($P(SREC,U,2))=GMJ D LOADSEL
	Q
LOADSEL	; Loads GMTSEG(J,FN,IFN), when Selection items are present
	N S2,SJ,SEL
	S S2=0,SJ=GMJ
	F  S S2=$O(^GMT(142,GMTSTYP,1,STRN,1,S2)) Q:'S2  S SEL=^(S2,0),GMTSEG(GMJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),S2)=$P(SEL,";") I S2=1 S GMTSEG(SJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),0)=U_$P(SEL,";",2)
	Q
HELP	; 
	N GMJ,GMTSTXT,HLP
	S HLP=$S(X="??":"HTX2",X="?":"HTX1",1:"") I $L(HLP) W ! F GMJ=1:1 S GMTSTXT=$T(@HLP+GMJ) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
	I X="???" W !! D HELP2^GMTSUP1
	D REDISP
	Q
REDISP	; Ask Whether or not to redisplay menu
	N I,DIR,X,Y
	S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
	W @IOF
	D DISP^XQORM1 W !
	Q
HTX1	;;Help Text for "?" and "??"
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;Enter: ??  to see HELP for MULTIPLE SELECTION
	;;       ??? to see HELP for "^^"-jump
	;;
	;;ZZZZ
HTX2	; HELP for ??
	;;
	;;The Health Summary components you select at this prompt create
	;;an ADHOC Health Summary.
	;;
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;ALL items may be selected by typing "ALL".
	;;
	;;EXCEPTIONS may be entered by preceding them with a minus.
	;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
	;;
	;;NOTE: Menu items are ordered alphabetically by the Component NAME.
	;;      However, the displayed text is the Header Name which generally 
	;;      is different from the Component Name. Component may be picked
	;;      by their abbreviation, Header Name or Component Name.
	;;
	;;ZZZZ

GMTSADOR
GMTSADOR	;SLC/JER - Ad Hoc Summary Driver ;7/2/91  15:13
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	;External call to allow user to define components and defaults through
	;the AD Hoc menu interface and print health summaries for a programmer-
	;specified patient and device. Called with:
	;  DFN=Patient internal file record number (optional)
	;      For OE/RR interface sets DFN to Patient DFN in the ORVP variable.
	;      If not defined a patient will be prompted for.
	;
	N C,GMTSEG,GMTSEGI,GMTSEGC,GMTSQIT,GMTSTYP,GMTSTITL,GMW,X,Y
	N DIC,DIPGM,I,POP,%,GMTSMULT
	S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" D ^DIC K DIC S GMTSTYP=+Y,GMTSTITL="AD HOC"
	I $G(DFN)'>0 S DFN=$S($D(ORVP):$P(ORVP,";"),1:"") D:+DFN'>0 SELPT^GMTS
	Q:+DFN'>0
	F  K GMTSEG,GMTSEGI,GMTSEGC D BUILD Q:$D(GMTSQIT)!($D(DIROUT))  D HSOUT^GMTS,END^GMTS S:$D(DTOUT) GMTSQIT="" Q:$D(GMTSQIT)!($D(DIROUT))
	D END
	Q
BUILD	; Conducts Dialogue to build ad hoc summary
	N GMI,GMJ,GMW,X,XQORM,Y
	Q:$D(GMTSQIT)!($D(DIROUT))
	W @IOF
	S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""Y"")"
	S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="DA",XQORM("A")="Select COMPONENT(S): ",XQORM("??")="D HELP^GMTSADH" D ^XQORM I Y'>0 S GMTSQIT="" Q
	I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G BUILD
	S GMTSEGC=Y
	S (X,GMI,GMJ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  D LOAD
	D GETLIM^GMTSADH1
	Q
LOAD	; Load enabled components into GMTSEG
	N SREC,STRN
	S STRN=+Y(GMI),SREC=^GMT(142,GMTSTYP,1,STRN,0)
LOAD1	S GMJ=GMJ+1,GMTSEG(GMJ)=SREC,GMTSEGI($P(SREC,U,2))=GMJ D LOADSEL
	Q
LOADSEL	; Loads GMTSEG(J,FN,IFN), when Selection items are present
	N S2,SJ,SEL
	S S2=0,SJ=GMJ
	F  S S2=$O(^GMT(142,GMTSTYP,1,STRN,1,S2)) Q:'S2  S SEL=^(S2,0),GMTSEG(GMJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),S2)=$P(SEL,";") I S2=1 S GMTSEG(SJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),0)=U_$P(SEL,";",2)
	Q
END	; Cleans up any residual locals
	K GMTSQIT,FROM,GMI,I1,ISVALID,LRDFN,PTR,SEX,TO,VAOA,VASD,VASV,X
	Q
HELP	; 
	N GMJ,GMTSTXT,HLP
	S HLP=$S(X="??":"HTX2",X="?":"HTX1",1:"") I $L(HLP) W ! F GMJ=1:1 S GMTSTXT=$T(@HLP+GMJ) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
	I X="???" W !! D HELP2^GMTSUP1
	D REDISP
	Q
REDISP	; Ask Whether or not to redisplay menu
	N I,DIR,X,Y
	S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
	W @IOF
	D DISP^XQORM1 W !
	Q
HTX1	;;Help Text for "?"
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;Enter: ??  to see HELP for MULTIPLE SELECTION
	;;       ??? to see HELP for "^^"-jump
	;;
	;;ZZZZ
HTX2	; HELP for ??
	;;
	;;The Health Summary components you select at this prompt create
	;;an ADHOC Health Summary.
	;;
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;ALL items may be selected by typing "ALL".
	;;
	;;EXCEPTIONS may be entered by preceding them with a minus.
	;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
	;;
	;;ZZZZ

GMTSALG
GMTSALG	;SLC/DLT - Allergies Component  ;10/6/94
	;;2.7;Health Summary;;Oct 20, 1995
	;
ALLRG	; * ALLERGIES *
	N X,GMTSAV,GMTSAFN,GMRAL,GMTSAL,GMTSALNM,GMTSCNT,GMTSEACT,GMTSLN,GMTSMECH,GMTSPRT,GMTSTY,CC,C,KK,ALLRG,TITLE,JJ
	K GMTSA S (SEQ,ALLRG)=0,TITLE="ALLERGY/ADVERSE REACTION (AR)"
	S X="GMRADPT" X ^%ZOSF("TEST")
	I $T D  Q:$D(GMTSQIT)  G Q
	.D NEWALLRG
	.I ALLRG D TITLE,ALLRGP
	I $D(^DPT(DFN,"PA",0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,"Allergy/Disorder: " D PA,ALLRGP
	K GMTSA S SEQ=0 I $D(^DPT(DFN,"PG",0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Generic Drug: " D PG,ALLRGP
Q	I 'ALLRG D
	.I $D(GMTSPNF)&('ALLRG) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Unknown, please evaluate",!
	K ALL,CC,CCC,CD,DIWF,DIWL,DIWR,GMTSALF,GMTSALNM,GMTSNODE,GMTSPRT,I,II,JJ,KK,L,M,MX,N,Z,X,SEQ,GMTSA,ALLRG,TITLE,GMRA,GMRAL,GMTSEACT,GMTSMECH,GMTSTY,GMTSPFN,GMTSAL,GMTSCNT,GMTSLN,ODT
	Q
PG	S I=0 F Z=0:0 S I=$O(^DPT(DFN,"PG",I)) Q:'I  I $D(^(I,0)) S ALLRG=1,SEQ=SEQ+1,GMTSA(SEQ)=+^(0) S:$D(^PSDRUG(+GMTSA(SEQ),0)) GMTSA(SEQ)=$P(^(0),"^")
	Q
ALLRGP	;The printing is done here
	;F II="D","DF","DFO","DO","O","F","FO"  I $O(GMTSAL(II,""))]"" D
	S II=""
	F  S II=$O(GMTSAL(II)) Q:II']""  I $O(GMTSAL(II,""))]"" D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W !?2,$S(II="D":"Drug:",II="DF":"Drug/Food:",II="DFO":"Drug/Food/Other:",II="DO":"Drug/Other:",II="F":"Food:",II="FO":"Food/Other:",II="O":"Other:",1:II_":")
	. S JJ="" F  S JJ=$O(GMTSAL(II,JJ)) Q:JJ=""  D
	.. N WKK S KK=""  F  S KK=$O(GMTSAL(II,JJ,KK)) Q:KK=""  D
	... S L=0 F  S L=$O(GMTSAL(II,JJ,KK,L)) Q:'L  D CKP^GMTSUP Q:$D(GMTSQIT)  D AUTOV W !?5,JJ_": " S:$L(KK)>30 WKK=KK,WKK=$$WRAP^GMTSORC(WKK,30) W ?24,$S($L(KK)>30:$P(WKK,"|"),1:KK) D
	.... I GMTSAV=1 W " (AV"
	.... E  W $S($P(GMTSAL(II,JJ,KK,L),U,5)=1:" (V",$P(GMTSAL(II,JJ,KK,L),U,5)=0:" (NV",1:"") D 
	.... W $S($P($G(^GMR(120.8,GMTSALNM,0)),U,6)="h":"/Historical)",$P($G(^(0)),U,6)="o":"/Observed)",1:")")
	.... I $L($P($G(WKK),"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,$P(WKK,"|",2)
	.... S (M,MX,ALL)=0 F  S M=$O(GMTSAL(II,JJ,KK,L,"S",M)) Q:M=""  D  Q:$D(GMTSQIT)
	..... I ALL=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W !?27
	..... S MX=MX+1
	..... W:MX>1 ", "
	..... S N=$P(GMTSAL(II,JJ,KK,L,"S",M),";")
	..... S ALL=1 I (74)'>($X+$L(N)) D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?27,N Q
	..... S ALL=1 W N
	.... D SIGBLK($P(GMTSAFN,U,5))
	.... D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,"Date/Time:  " S ODT=$P(GMTSAFN,U,4) S X=ODT D REGDTM^GMTSU W X,!
	....S CC="" F  S CC=$O(^GMR(120.8,GMTSALNM,26,"B",CC)) Q:CC=""  D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,"Comments at: " S X=CC D REGDTM^GMTSU S CD=X S CCC=0 F  S CCC=$O(^GMR(120.8,GMTSALNM,26,"B",CC,CCC)) Q:'CCC  D TEXT
	Q
PA	S I=0 F Z=0:0 S I=$O(^DPT(DFN,"PA",I)) Q:I'>0  I $D(^(I,0)) S ALLRG=1,SEQ=SEQ+1,GMTSA(SEQ)=+^(0) S:$D(^DIC(57,GMTSA(SEQ),0)) GMTSA(SEQ)=$P(^(0),"^")
	Q
NEWALLRG	; Call to Allergy Package for info
	S GMRA="0^0^111" D EN1^GMRADPT I GMRAL="" S ALLRG=0 Q
	I $D(GMRAL)>9 D
	. S I=0 F GMTSCNT=1:1 S I=$O(GMRAL(I)) Q:'I  D
	.. S GMTSTY=$P(GMRAL(I),U,7) Q:GMTSTY']""
	.. S GMTSEACT=$P(GMRAL(I),U,2) Q:GMTSEACT']""
	.. S GMTSMECH=$P($P(GMRAL(I),U,8),";")
	.. S:GMTSMECH']"" GMTSMECH="UNKNOWN"
	..; S GMTSMECH=$S($P(GMRAL(I),U,8)?1U.U1";".N:$P($P(GMRAL(I),U,8),";"),1:"ALLERGY")
	.. S GMTSAL(GMTSTY,GMTSMECH,GMTSEACT,GMTSCNT)=I_"^"_GMRAL(I)
	.. S JJ=0 F  S JJ=$O(GMRAL(I,"S",JJ)) Q:'JJ  S GMTSAL(GMTSTY,GMTSMECH,GMTSEACT,GMTSCNT,"S",JJ)=GMRAL(I,"S",JJ)
	.. S ALLRG=1
	Q
AUTOV	;autoverify
	S GMTSAV=0,GMTSALNM=$P(GMTSAL(II,JJ,KK,L),U),GMTSAFN=$G(^GMR(120.8,GMTSALNM,0))
	I $P(GMTSAFN,U,18)="",$P(GMTSAFN,U,16)=1 S GMTSAV=1
	Q
TITLE	;print title
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I $D(GMTSPNF) W ?21,TITLE,!
	E  W ?21,"Title: ",TITLE,!
	Q
TEXT	;Setup for print of allergy comments
	W ?31,CD D CKP^GMTSUP Q:$D(GMTSQIT)
	K ^UTILITY($J,"W") S GMTSLN=0 F  S GMTSLN=$O(^GMR(120.8,GMTSALNM,26,CCC,2,GMTSLN)) Q:'GMTSLN  S GMTSPRT=^GMR(120.8,GMTSALNM,26,CCC,2,GMTSLN,0) D FORMAT
	I $D(^UTILITY($J,"W")) F GMTSLN=1:1:^UTILITY($J,"W",DIWL) D LINE Q:$D(GMTSQIT)
	K ^UTILITY($J,"W")
	Q:'GMTSLN
	W ! Q
FORMAT	;Formats each line
	S DIWL=3,DIWR=80,DIWF="C58",X=GMTSPRT D ^DIWP
	Q
LINE	;Writes formatted lines of text
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?24,^UTILITY($J,"W",DIWL,GMTSLN,0)
	Q
SIGBLK(GMTSALF)	;signature block
	I +GMTSALF'>0 Q
	N GMTSNODE S GMTSNODE=$G(^VA(200,+GMTSALF,20))
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !!?24,"Originator: ",$S($P(GMTSNODE,U,2)'="":$P(GMTSNODE,U,2),1:$P($G(^VA(200,+GMTSALF,0)),U))
	D CKP^GMTSUP Q:$D(GMTSQIT)  I $P(GMTSNODE,U,3)'="" W !?24,"Title:      ",$P(GMTSNODE,U,3)
	Q

GMTSALGB
GMTSALGB	;SLC/DLT - Brief Adverse Reaction/Allergy Component ;24-AUG-95
	;;2.7;Health Summary;;Oct 20, 1995
	;
ALLRG	; **************** ALLERGIES *****************
	N X
	K GMTSA S (SEQ,ALLRG)=0
	S X="GMRADPT" X ^%ZOSF("TEST")
	I $T D  Q:$D(GMTSQIT)  G Q
	.D NEWALLRG
	.I ALLRG D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,"Allergy/Reaction: " D ALLRGP
	I $D(^DPT(DFN,"PA",0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,"Allergy/Disorder: " D PA,ALLRGP
	K GMTSA S SEQ=0 I $D(^DPT(DFN,"PG",0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Generic Drug: " D PG,ALLRGP
Q	;Exit
	K I,Z,X,SEQ,GMTSA,ALLRG
	Q
PG	S I=0 F Z=0:0 S I=$O(^DPT(DFN,"PG",I)) Q:'I  I $D(^(I,0)) S ALLRG=1,SEQ=SEQ+1,GMTSA(SEQ)=+^(0) S:$D(^PSDRUG(+GMTSA(SEQ),0)) GMTSA(SEQ)=$P(^(0),"^")
	Q
ALLRGP	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21 S X=0 F I=0:0 S I=$O(GMTSA(I)) Q:I=""  S X=X+1 W:X>1 ", " W:(77)'>($X+$L(GMTSA(I))) ! D CKP^GMTSUP Q:$D(GMTSQIT)  W GMTSA(I)
	Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)  W ! Q
PA	S I=0 F Z=0:0 S I=$O(^DPT(DFN,"PA",I)) Q:I'>0  I $D(^(I,0)) S ALLRG=1,SEQ=SEQ+1,GMTSA(SEQ)=+^(0) S:$D(^DIC(57,GMTSA(SEQ),0)) GMTSA(SEQ)=$P(^(0),"^")
	Q
NEWALLRG	; Subroutine to execute when ALLERGIES Package is present
	N GMI,GMJ,GMRAL
	D EN1^GMRADPT I GMRAL="" S ALLRG=0 Q
	S ALLRG=1,GMI=0 F  S GMI=$O(GMRAL(GMI)) Q:GMI'>0  D
	.S GMTSA(GMI)=$P(GMRAL(GMI),U,2)
	.S GMJ=0 F  S GMJ=$O(GMTSA(GMJ)) Q:GMJ'>0  I GMI'=GMJ,(GMTSA(GMI)=$G(GMTSA(GMJ))) K GMTSA(GMI) Q
	Q

GMTSAMIE
GMTSAMIE	;SLC/SBW - C&P Component driver ;25/AUG/94
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Control branching
	N GMDATE,GMEXAM,GMCNT,GMTSREC,DIWL,DIWR,DIWF,NODE,LINE
	S DIWL=1,DIWR=80,DIWF="W"
	K ^TMP("DVBC",$J)
	D HSCP^DVBCHS0(DFN,GMTS2,GMTS1,2)
	I '$D(^TMP("DVBC",$J)) Q
	S (GMDATE,GMCNT)=0
	F  S GMDATE=$O(^TMP("DVBC",$J,GMDATE)) Q:+GMDATE'>0!(GMCNT'<GMTSNDM)  D
	. S GMEXAM=""
	. F  S GMEXAM=$O(^TMP("DVBC",$J,GMDATE,GMEXAM)) Q:GMEXAM']""!(GMCNT'<GMTSNDM)  D WRT
	K ^TMP("DVBC",$J)
	Q
WRT	; Writes exam data
	S GMCNT=GMCNT+1
	N EXAM,PRI,PHY,EXAMDATE,X
	S NODE=$G(^TMP("DVBC",$J,GMDATE,GMEXAM,0))
	S X=$P(NODE,U,2) D REGDT^GMTSU S EXAMDATE=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W EXAMDATE,?15,$P(NODE,U,3),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,"Priority of Exam: ",$E($P(NODE,U,5),1,20),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?1,"Examining provider: ",$P(NODE,U,4),!
	S NODE=$G(^TMP("DVBC",$J,GMDATE,GMEXAM,2))
	S X=$P(NODE,U,3) D REGDT^GMTSU
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ?8,"Approved By: ",$P(NODE,U,2)," on ",X,!
	K ^UTILITY($J,"W")
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Examination results: ",!
	S LINE=0
	F  S LINE=$O(^TMP("DVBC",$J,GMDATE,GMEXAM,"RES",LINE)) Q:'LINE  S X=^(LINE) D CKP^GMTSUP Q:$D(GMTSQIT)  D ^DIWP
	D CKP^GMTSUP Q:$D(GMTSQIT)  D ^DIWW
	I +$O(^TMP("DVBC",$J,GMDATE,GMEXAM))!+$O(^TMP("DVBC",$J,GMDATE)) D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q

GMTSCI
GMTSCI	;SLC/MKB - Health Summary Component Inquiry ;1/24/91  11:05
	;;2.7;Health Summary;;Oct 20, 1995
	S U="^",DIC="^GMT(142.1,",DIC(0)="AEMQ",DIC("A")="Select Health Summary Component Name: " D ^DIC K DIC("A") G:Y=-1 END S (FR,TO)=$P(Y,U,2),GMTSY=+Y
	S BY=".01",DHD="[GMTS COMP INQ HEADER]",FLDS="[GMTS COMP INQ]",L=0 D EN1^DIP K GMTSY
END	Q

GMTSCM
GMTSCM	;SLC/JER - Create/modify Health Summary Components ;5/15/92  11:11DR
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching
	N %,C,D,D0,GMCMP,GMTSQIT,X,Y,DIRUT
	I +$G(DUZ(2))'>0 W !,"DUZ(2) must be set to your division.",! Q
	F  D  Q:$D(GMTSQIT)
	. N DA,DIC,DIE,DR,GMCMP,X,Y,GMDA,DLAYGO,DIDEL
	. S:+$P($G(^GMT(142.1,0)),U,3)'>(DUZ(2)_"000") $P(^GMT(142.1,0),U,3)=DUZ(2)_"000"
	. S DIC=142.1,DIC(0)="AEMQLZ",DIC("A")="Select COMPONENT: "
	. S DIC("S")="I $S(DUZ(2)=5000:1,(+$G(Y)'<(DUZ(2)_""000"")&(+$G(Y)'>(DUZ(2)_""999""))):1,1:0)"
	. S DLAYGO=142.1
	. D ^DIC I +Y'>0 S GMTSQIT="" Q
	. S GMDA=+Y
	. I +$P(Y,U,3) S GMCMP(0)=$P(Y,U,2) D COPY(.GMCMP)
	. S DIDEL=142.1
	. I $D(GMCMP)=11 S GMCMP=+GMDA D  Q
	. . I $D(GMCMP(3.5))>9 D
	. . . N %X,%Y
	. . . S %X="GMCMP(3.5,",%Y="^GMT(142.1,"_+GMDA_",3.5," D %XY^%RCR
	. . S DIE="^GMT(142.1,",DA=+GMDA
	. . S DR=".01;1///^S X=$P(GMCMP(0),U,2);2///"_$P(GMCMP(0),U,3)_";4///"_$P(GMCMP(0),U,5)_";6///"_$P(GMCMP(0),U,7)_";10///"_$P(GMCMP(0),U,10)_";11///"_$P(GMCMP(0),U,11)_";12///"_$P(GMCMP(0),U,12)
	. . S DR=DR_";3;3.5;I X=""^""!(X=""^^"") S DIRUT=1,Y=""@1"";1;2;4;10;11;12;6;9;@1"
	. . D ^DIE I $D(Y)>9!($D(DIRUT))!'$D(DA) S GMTSQIT="" Q
	. . I $D(GMCMP("SEL")) D
	. . . S DIE="^GMT(142.1,"_+DA_",1,",DA(1)=DA,DA=1,DR=".01///"_$P(GMCMP("SEL"),U)_";1///"_$P(GMCMP("SEL"),U,2) S:'$D(@(DIE_"0)")) ^(0)="^142.17P^^" D ^DIE  I $D(Y)>9 S GMTSQIT="" Q
	. . S DIE="^GMT(142.1,",(GMCMP,DA)=+GMDA,DR=7
	. . D ^DIE I $D(Y)>9!($D(DIRUT)) S GMTSQIT="" Q
	. . I $D(DA) D  Q
	. . . W ! I $$ADHOC D ENADHOC^GMTSRM W !!,">>> Returning to Create/Modify Health Summary Component Option.",!
	. S DIE="^GMT(142.1,",(GMCMP,DA)=+GMDA,DR=".01;1;3;3.5;I X=""^""!(X=""^^"") S DIRUT=1,Y=""@1"";2;4;10;11;12;6;9;7;@1"
	. D ^DIE I $D(Y)>9!($D(DIRUT)) S GMTSQIT="" Q
	. I $D(DA) D  Q
	. . W ! I $$ADHOC,'$D(DIRUT) D ENADHOC^GMTSRM W !!,">>> Returning to Create/Modify Health Summary Component Option.",!
	. . I $D(DIRUT) S GMTSQIT="" Q
	. D CLEANUP^GMTSDD
	Q
COPY(GMCMP)	; Duplicate existing Health Summary Component
	N %,DIC,DIR,GMI,I,X,XQORM,XQORSPEW,Y
	S DIR(0)="Y",DIR("A")="Do you wish to duplicate an existing COMPONENT"
	S DIR("B")="YES" D ^DIR Q:+Y'>0
	S DIC=142,DIC(0)="XF",X="GMTS HS ADHOC OPTION" D ^DIC Q:+Y'>0
	S XQORM=+Y_";GMT(142,",XQORM(0)="1AD",XQORM("A")="Enter COMPONENT to Duplicate: "
	W ! D ^XQORM Q:+Y'>0
	S GMCMP=+$P($G(^GMT(142,+XQORM,1,+Y(1),0)),U,2)
	S GMCMP(0)=GMCMP(0)_U_$P($G(^GMT(142.1,+GMCMP,0)),U,2,12)
	I $O(^GMT(142.1,+GMCMP,3.5,0)) D
	. S GMCMP(3.5,0)=$G(^GMT(142.1,+GMCMP,3.5,0))
	. S GMI=0 F  S GMI=$O(^GMT(142.1,+GMCMP,3.5,GMI)) Q:+GMI'>0  D
	. . S GMCMP(3.5,GMI,0)=$G(^(GMI,0))
	I $O(^GMT(142.1,+GMCMP,1,0)) S GMCMP("SEL")=$G(^GMT(142.1,+GMCMP,1,$O(^(0)),0))
	Q
ADHOC()	; Ask user whether or not to ADD new component to AD HOC
	N %,DIR,X,Y
	S DIR(0)="Y",DIR("A")="ADD new Component to the AD HOC Health Summary"
	S DIR("B")="NO" D ^DIR
	Q Y

GMTSCW
GMTSCW	;SLC/DJP - Crisis Note/Clinical Warning/Advance Directive Component ;10/6/94  17:11 ;
	;;2.7;Health Summary;;Oct 20, 1995
LKUP	;Searches through the "AJ2" x-ref of the Progress Note File (^GMR(121))
LOOP1	S (FLAG,GMTSD,GMTSFN,GMTSCTR)=0 F  S GMTSD=$O(^GMR(121,"AJ2",DFN,GMTSTP,GMTSD)) Q:GMTSD=""  D LOOP2 Q:$D(GMTSQIT)
	Q
LOOP2	I (GMTSD<GMTS1)!(GMTSD>GMTS2) Q
	F  S GMTSFN=$O(^GMR(121,"AJ2",DFN,GMTSTP,GMTSD,GMTSFN)) Q:(GMTSFN="")!($D(GMTSQIT))  S GMTSCTR=GMTSCTR+1 D  Q:$D(GMTSQIT)
	.D PRT Q:$D(GMTSQIT)  S GMTSDT=""
	.D ESLN:'$D(S1) Q:$D(GMTSQIT)
	.D COSIGN:('$D(S1))&($P($G(GMTSPN5),"^",2)) Q:$D(GMTSQIT)
	.D CORRECT:$D(^GMR(121,GMTSFN,70))
	K S1 S FLAG=0 Q
END	K GMTSPN0,GMTSPN5,GMTSPRT,GMTSD,GMTSFN,GMTSPRT,GMTSTP,GMTSCTR,GMTSHCTR,GMTSDT,S1,GMTSLN,GMTSPT,DIWF,DIWL,DIWR,X,GMTSPN1,FLAG,TITLE,TYPE
	Q
PRT	;Prints body of note.
	I GMTSNPG=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	S GMTSPN0=$G(^GMR(121,GMTSFN,0)),GMTSPN1=$G(^GMR(121,GMTSFN,1)),GMTSPN5=$G(^GMR(121,GMTSFN,5))
	S X=$P(^GMR(121,GMTSFN,0),"^",3) D REGDTM^GMTSU S GMTSDT=X
	D CKP^GMTSUP Q:$D(GMTSQIT)
	S GMTSPT=10
FLINE	;FIRST LINE DATE/TITLE
	W GMTSDT I FLAG=0 S TITLE=$P(^GMR(121,GMTSFN,1),"^"),TYPE=$P(^GMR(121.2,+TITLE,0),"^",2),TYPE=$P(^GMR(121.1,+TYPE,0),"^",1),TITLE=$P(^GMR(121.2,TITLE,0),"^") D TITLE
	W:$D(^GMR(121,GMTSFN,70))&(GMTSPT=10) "* amended *",!
TEXT	;Setup for print of progress note text (GMTSFN=Internal File Number; GMTSPT=Type of Text; GMTSLN=Internal Line Number)
	D CKP^GMTSUP Q:$D(GMTSQIT)
	K ^UTILITY($J,"W") S GMTSLN=0 F  S GMTSLN=$O(^GMR(121,GMTSFN,GMTSPT,GMTSLN)) Q:'GMTSLN  S GMTSPRT=^GMR(121,GMTSFN,GMTSPT,GMTSLN,0) D FORMAT
	I $D(^UTILITY($J,"W")) F GMTSLN=1:1:^UTILITY($J,"W",3) D LINE Q:$D(GMTSQIT)
	K ^UTILITY($J,"W")
	Q
FORMAT	; Formats each line for justified column width output
	S DIWL=3,DIWR=80,DIWF="N",X=GMTSPRT D ^DIWP
	Q
LINE	; Writes formatted lines of text
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ^UTILITY($J,"W",DIWL,GMTSLN,0),!
	Q
TITLE	;print title
	I $D(GMTSPNF) W ?21,TITLE,!
	E  W ?21,"Title: ",TITLE,!
	Q
ESLN	D CKP^GMTSUP Q:$D(GMTSQIT)
	I $P(GMTSPN0,U,5)'=$P(GMTSPN1,U,2) D CKP^GMTSUP Q:$D(GMTSQIT)
	I $P(GMTSPN1,U,3) W !?20,"Signed by:" D
	.W:'$P(GMTSPN1,U,5) ?31,"/es/"
	.D SIGBLK($P(GMTSPN1,U,3))
	I +$G(GMTSPN5),'$P(GMTSPN5,U,2) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?36,"** REQUIRES COSIGNATURE **",! Q
	I $S('$P(GMTSPN1,U,3):1,$P(GMTSPN1,U,2)'=$P(GMTSPN1,U,3):1,1:0) D
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W !?23,"AUTHOR:" D SIGBLK($P(GMTSPN1,U,2))
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I $P(GMTSPN1,U,5) D
	.I $P(GMTSPN0,U,5)'=$P(GMTSPN1,U,2) D CKP^GMTSUP Q:$D(GMTSQIT)
	.W !,"    Marked signed on chart by:"
	.D SIGBLK($P(GMTSPN1,U,5))
	Q
CORRECT	;Appends correction to clinical alert
	S COR=0,HFN=GMTSFN
	F  S COR=$O(^GMR(121,GMTSFN,70,COR)) Q:COR=""!(COR?.1A)  S GMTSFN=$P(^GMR(121,GMTSFN,70,COR,0),"^",1) D  Q:$D(GMTSQIT)
	.S GMTSPN0=$G(^GMR(121,GMTSFN,0)),GMTSPN1=$G(^GMR(121,GMTSFN,1)),GMTSPN5=$G(^GMR(121,GMTSFN,5))
	.D CORPT Q:$D(GMTSQIT)  S GMTSPT=10 D TEXT Q:$D(GMTSQIT)
	.D ESLN Q:$D(GMTSQIT)  D:$P($G(^GMR(121,GMTSFN,5)),"^",2) COSIGN Q:$D(GMTSQIT)
	.S GMTSFN=HFN
	K COR,HFN,CDT
	Q
CORPT	S X=$P(^GMR(121,GMTSFN,0),"^",3) D REGDTM^GMTSU S CDT=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W CDT,?21,"Addendum:",!
	S FLAG=1
	Q
CN	;Crisis Note Printout for Health Summary
	S GMTSTP="C" D LKUP I $D(GMTSQIT) D END Q
	D END
	Q
CW	;Clinical Warning Note Printout for Health Summary
	S GMTSTP="W" D LKUP I $D(GMTSQIT) D END Q
	D END
	Q
CD	;Advance Directive Note Printout for Health Summary
	S GMTSTP="D" D LKUP I $D(GMTSQIT) D END Q
	D END
	Q
COSIGN	;Prints cosignature info
	Q:GMTSPN5=""
	I $D(^GMR(121,GMTSFN,8)) S GMTSPT=8 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?1,"Cosigner Comments: " D TEXT Q:$D(GMTSQIT)
	I $P(GMTSPN5,U,2) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?18,"Cosigned by: " D
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W:'$P(GMTSPN5,U,4) ?29,"/es/"
	D CKP^GMTSUP Q:$D(GMTSQIT)  D SIGBLK($P(GMTSPN5,U,2))
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I $P(GMTSPN5,U,4) D CKP^GMTSUP Q:$D(GMTSQIT)   D
	.W !!,"  Marked cosigned on chart by:"
	.D SIGBLK($P(GMTSPN5,U,4))
	Q
SIGBLK(GMTSDUZ)	;signature block print
	I +GMTSDUZ'>0 Q
	N GMTSNODE S GMTSNODE=$G(^VA(200,+GMTSDUZ,20))
	W ?36,$S($P(GMTSNODE,U,2)'="":$P(GMTSNODE,U,2),1:$P($G(^VA(200,+GMTSDUZ,0)),U))
	I $P(GMTSNODE,U,3)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W !?36,$P(GMTSNODE,U,3),!
	Q

GMTSDA
GMTSDA	;SLC/DLT - Appointments Component ;8/18/94  11:37
	;;2.7;Health Summary;;Oct 20, 1995
PAST	;Gets Patient's Past Appointments for the past date range
	N GMDT,GMIDT
	S X=1
	S VASD("F")=GMTSBEG,VASD("T")=$S(GMTS1=6666666:DT,1:9999999-GMTS1)
	S:GMTSNDM=-1 GMTSNDM=9999
	S VASD("W")=123456789 D SDA^VADPT
	;SET UP IDATES() ARRAY, INVERTED DATE ARRAY, = EXTERNAL APPOINTMENT DATA
	S (YCNT,Y)=0 F  S Y=$O(^UTILITY("VASD",$J,Y)) Q:'Y  S YCNT=YCNT+1,ADATE=$P(^(Y,"I"),U,1),^UTILITY("GMTSVASD",$J,9999999-ADATE)=ADATE_U_$P(^UTILITY("VASD",$J,Y,"E"),U,2,99)
	S GMDT=VASD("F")
	F  S GMDT=$O(^SDV("C",DFN,GMDT)) Q:GMDT'>0!(GMDT>VASD("T"))  D
	. S GMI=0 F  S GMI=$O(^SDV(GMDT,"CS",GMI)) Q:GMI'>0  D
	.. S GMIDT=9999999-GMDT
	.. I '$D(^UTILITY("GMTSVASD",$J,GMIDT)) D
	... S ^UTILITY("GMTSVASD",$J,GMIDT)=GMDT_U_$S(+$P(^SDV(GMDT,"CS",GMI,0),U,3):$P($G(^SC(+$P(^(0),U,3),0)),U),1:$P($G(^DIC(40.7,+^(0),0)),U))_U_"UNSCHEDULED"_U_$S($P(^SDV(GMDT,"CS",GMI,0),U,5):$P($G(^SD(409.1,+$P(^(0),U,5),0)),U),1:"UNKNOWN")
	... S $P(^UTILITY("GMTSVASD",$J,GMIDT),U,5)=$P($G(^DIC(40.7,$P(^SDV(GMDT,"CS",GMI,0),U),0)),U)
	.. E  D
	... S ^UTILITY("GMTSVASD",$J,GMIDT,GMI)=GMDT_U_$S(+$P(^SDV(GMDT,"CS",GMI,0),U,3):$P($G(^SC(+$P(^(0),U,3),0)),U),1:$P($G(^DIC(40.7,+^(0),0)),U))_U_"UNSCHEDULED"_U_$S($P(^SDV(GMDT,"CS",GMI,0),U,5):$P($G(^SD(409.1,+$P(^(0),U,5),0)),U),1:"UNKNOWN")
	... S $P(^UTILITY("GMTSVASD",$J,GMIDT,GMI),U,5)=$P($G(^DIC(40.7,$P(^SDV(GMDT,"CS",GMI,0),U),0)),U)
	I '$D(^UTILITY("GMTSVASD",$J)) D END Q
	S IDATE="",YCNT=0
	F  S IDATE=$O(^UTILITY("GMTSVASD",$J,IDATE)) Q:+IDATE'>0!(YCNT=GMTSNDM)  D
	. S ADATE=+^(IDATE),ADATE(0)=^(IDATE) D PRINT S YCNT=YCNT+1
	. S GMI=0 F  S GMI=$O(^UTILITY("GMTSVASD",$J,IDATE,GMI)) Q:+GMI'>0  D
	.. S ADATE=+$G(^UTILITY("GMTSVASD",$J,IDATE,GMI)),ADATE(0)=$G(^(GMI))
	.. D PRNTSC
END	K %I,IDATE,IDATES,ADATE,VASD,X,Y,YCNT,Z
	K ^UTILITY("VASD",$J),^UTILITY("GMTSVASD",$J) Q
FUTURE	;Gets Patient's Future Appointments 
	D SDA^VADPT
	S (YCNT,Y)=0 F  S Y=$O(^UTILITY("VASD",$J,Y)) Q:'Y  S YCNT=YCNT+1,ADATE=$P(^(Y,"I"),U,1),ADATE(0)=^UTILITY("VASD",$J,Y,"E") D PRINT Q:YCNT=GMTSNDM
	D END Q
PRINT	D CKP^GMTSUP Q:$D(GMTSQIT)
	S X=ADATE D REGDTM^GMTSU,CKP^GMTSUP
	W X,?16,$E($P(ADATE(0),"^",2),1,25),?58,$E($P(ADATE(0),"^",3),1,21)
	W ! Q
PRNTSC	;PRINT THE ANCILLIARY CLINIC STOP CODES
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?16,"Clinic Stop: ",?31,$E($P(ADATE(0),"^",5),1,25),?58,$E($P(ADATE(0),"^",3),1,21),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?16,"Assoc. Clinic: ",?31,$E($P(ADATE(0),"^",2),1,25),?58,$E($P(ADATE(0),"^",3),1,21)
	W !
	Q

GMTSDCB
GMTSDCB	;SLC/TRS - Brief Discharge Routine ;6/2/90  14:42 ;
	;;2.7;Health Summary;;Oct 20, 1995
ENDC	;BRIEF DISCHARGE STUFF NO CAPTIONS
	S N="",ADM=GMTS1,GMC=0,LF=0
	I $D(GMTSNDM),(GMTSNDM>0) S CNTR=GMTSNDM
	E  S CNTR=100
	S T1=GMTSEND,T2=GMTSBEG
	F  S ADM=$O(^DPT(DFN,"DA","AA",ADM)) Q:'ADM!(ADM>GMTS2)  F  S N=$O(^DPT(DFN,"DA","AA",ADM,N)) Q:'N  D PROC I CNTR=0 Q
	D KILLADM Q
PROC	S AD0=^DPT(DFN,"DA",N,0),PTF=$P(AD0,U,12)
	S CNTR=CNTR-1 I CNTR=0 Q
	I $S('PTF:1,1:'$D(^DGPT(PTF,70))) S GMC=-1 Q
	S:$D(^DGPT(PTF,70)) ICD=^DGPT(PTF,70)
	I $P(ICD,"^",1)="" S GMC=-1 Q
	S DATE=$P((ICD),"^",1) I (DATE'<T1)!(DATE'>T2) Q:GMC  S GMC=-1 Q
	S GMC=2 S X=DATE D REGDT^GMTSU S XD=X
	I $P(ICD,U,10)'="" D
	. N DIC,DIQ,DR,DA,REC
	. S DIC=80,DA=$P(ICD,U,10),DIQ="REC(",DIQ(0)="IE",DR=".01;3"
	. D EN^DIQ1
	. Q:'$D(REC)
	. S DXL=REC(80,DA,3,"E")
	I $P((ICD),"^",2)'="" S BS=$P((ICD),"^",2),BS=$S($D(^DIC(42.4,BS,0)):^DIC(42.4,BS,0),1:"") S BDS=$S($P((BS),"^",2)'="":$P(BS,U,2),$P(BS,U,1)'="":$P(BS,U,1),1:"UNKNOWN")
	I $P(ICD,"^",3)'="" S DIC="^DGPT(",DR=72,DA=PTF,DIQ="ARRAY",DIQ(0)="E" D EN^DIQ1 S SDS=ARRAY(45,DA,72,"E")
	S DP=$S($P((ICD),"^",6)'="":$P(ICD,U,6),1:""),DP=$S(DP'="":^DIC(45.6,DP,0),1:"")
	S OT=$P(ICD,"^",4),OP=$S(OT=3:"NO",OT="":"UNKNOWN",1:"YES")
	;I LF'=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,XD,?21,SDS,!
	I $D(DXL) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?15,"DXLS: ",DXL,!
	;D CKP^GMTSUP Q:$D(GMTSQIT)  W ?10,"Bedsection: ",BDS,!
	;D CKP^GMTSUP Q:$D(GMTSQIT)  W "   Disposition Place: ",$S(DP'="":$P(DP,U,1),1:"UNKNOWN"),!
	;D CKP^GMTSUP Q:$D(GMTSQIT)  W "Outpatient Treatment: ",OP,!
	;S LF=1 Q
	K DXL,BS,BDS,ICD,DATE
	Q
KILLADM	;Kills Admission variables
	K END,TDT,HH,MM,TN,LF,DATE,AT,ITR,TRT,TI,TO,N,CNTR,BDS,SDS,GMC,ARRAY,DXL,TOM,TR,T1,T2,DATE,I,A,AD0,ADM,BS,D,DA,DP,DR,ICD,OP,OT,PTF,X,XD,DIQ,DIC
	Q

GMTSDD
GMTSDD	;SLC/KCM - Health Summary DD calls ;11/16/92  13:48
	;;2.7;Health Summary;;Oct 20, 1995
SET	;From: x-ref in 142,99  Entry: DA  Exit: DA
	;NOTE:  Lock ^XUTL("XQORM",XQORM) and ^GMT(142,DA) before calling
	N I,J,X,X0,X1,COL,CCOL,IEN,ORD,ROW,TOT,GMNAME
	I $D(^XUTL("XQORM",DA_";GMT(142,",0)),$D(^GMT(142,DA,99)),($P(^GMT(142,DA,99),"^",1)=$P(^XUTL("XQORM",DA_";GMT(142,",0),"^",1)) Q
	K ^TMP("XQORM",$J) D KILL S TOT=0
	S IEN=0 F  S IEN=$O(^GMT(142,DA,1,IEN)) Q:IEN'>0  I $D(^GMT(142,DA,1,IEN,0)) S X=^(0) I $D(^GMT(142.1,+$P(X,"^",2),0)),($P(^(0),"^",6)'="P"),($P(^(0),U,6)'="T") S TOT=TOT+1,GMNAME=$P($G(^(0)),U) D ORD
	S COL=$S(TOT\2>20:3,1:2),X=TOT\COL S:TOT#COL X=X+1 S ROW=X,CCOL=.1,^XUTL("XQORM",DA_";GMT(142,","COL")=COL
	S ORD="" F  S ORD=$O(^TMP("XQORM",$J,ORD)) Q:ORD=""  D
	. S IEN=0 F  S IEN=$O(^TMP("XQORM",$J,ORD,IEN)) Q:+IEN'>0  S CCOL=$S((CCOL\1)'<ROW:1+($P(CCOL,".",2)/10)+.1,1:CCOL+1) D BILD
	S X=$H,(^XUTL("XQORM",DA_";GMT(142,",0),^GMT(142,DA,99))=X
	K ^TMP("XQORM",$J) Q
ORD	S ^TMP("XQORM",$J,GMNAME,IEN)="" ;Use summary order for now
	Q
BILD	S X0=^GMT(142,DA,1,IEN,0) Q:'$P(X0,"^",2)
	S X1=^GMT(142.1,$P(X0,"^",2),0),X=$S($L($P(X0,U,5)):$P(X0,U,5),$L($P(X1,"^",9)):$P(X1,"^",9),1:$E($P(X1,"^",1),1,19))
	F %=1:1:$L(X) I ",=;-"[$E(X,%) S X=$E(X,1,%-1)_" "_$E(X,%+1,999)
	S ^XUTL("XQORM",DA_";GMT(142,",CCOL,0)=IEN_"^"_$P(X0,"^",1)_"^"_X_"^"_$P(X1,"^",4)
	I $L(X) D UP S ^XUTL("XQORM",DA_";GMT(142,","B",X,CCOL)=""
	S X=$P(X1,"^") I $L(X) D UP S ^XUTL("XQORM",DA_";GMT(142,","B",X,CCOL)=1
	S X=$P(X1,"^",4) I $L(X) D UP S ^XUTL("XQORM",DA_";GMT(142,","B",X,CCOL)=1
	Q
UP	F %=1:1:$L(X) I $E(X,%)?1L S X=$E(X,1,%-1)_$C($A(X,%)-32)_$E(X,%+1,99)
	Q
KILL	;From: x-ref in 142,99  Entry: none  Exit: none
	K ^XUTL("XQORM",DA_";GMT(142,")
	Q
REDO	;From: 142.1,.01 142.1,3  Entry: DA  Exit: DA
	;Update timestamp for structure so menu recompiled
	N I,X S X=$H S I=0 F  S I=$O(^GMT(142,"AE",DA,I)) Q:I'>0  I $D(^GMT(142,I,99)) S $P(^(99),"^",1)=X
	Q
REDOX	;From: 142.01,.01 142.01,1  Entry: DA(1) Exit: DA(1)
	I $D(^GMT(142,DA(1),0)) S ^(99)=$H
	Q
CLEANUP	; Delete broken pointers from 142.01 to 142.1 on COMPONENT deletion
	N %,%Y,D0,DI,DIC,DIJ,DIKS,DISYS,DR,DIE,GMDA,GMI,GMJ,X,Y
	S GMDA=+GMCMP,GMI=0 F  S GMI=$O(^GMT(142,"AE",GMDA,GMI)) Q:+GMI'>0  D
	. W !,"Deleting pointers from the "_$P(^GMT(142,+GMI,0),U)_" Health Summary Type"
	. S GMJ=0 F  S GMJ=$O(^GMT(142,"AE",GMDA,GMI,GMJ)) Q:+GMJ'>0  D
	. . S DIE="^GMT(142,"_GMI_",1,",DR=".01///@",DA=GMJ,DA(1)=GMI D ^DIE W "."
	Q
CHKNAME	; Called by input transform on ^DD(142.1,.01,0)
	I $D(^GMT(142.1,"B",X)),($G(Y)=-1) D
	. W "   Duplicate NAMES not allowed." K X
	Q
CHKRTN	; Called by input transform on ^DD(142.1,1,0)
	I @("$L($T("_$P(X,";")_U_$P(X,";",2)_"))'>0") D
	. W "   Nonexistent ENTRY POINT" K X
	Q
CHKNUM	; Called by input transform of ^DD(142.1,.001,0)
	I $S('$D(DUZ(2)):0,$G(DUZ(2))'=5000:1,1:0) D
	. I $S(X<(DUZ(2)_"000"):1,X>(DUZ(2)_"999"):1,1:0) W "  # Out of Range" K X
	Q

GMTSDEM
GMTSDEM	;SLC/DLT - Demographic Component  ;3/22/94  09:23
	;;2.7;Health Summary;;Oct 20, 1995
	;
DEMOG	; Prints Demographic data from VADPT calls
	D 6^VADPT,SVC^VADPT,OAD^VADPT,OPD^VADPT
	D PRT,END Q
PRT	;Print Demographic logic
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,"Address: "_$S($L(VAPA(1)):VAPA(1),1:"Not available"),?53," Phone:",?61,VAPA(8),!
	I VAPA(2)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAPA(2),!
	I VAPA(3)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAPA(3),!
	I VAPA(4)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAPA(4),", " W:VAPA(5)'="" $P(VAPA(5),"^",2),"  " W:VAPA(6)'="" VAPA(6) W:VAPA(7)'="" ?52," County:",?61,$P(VAPA(7),"^",2) W !
	I VADM(10)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ! D CKP^GMTSUP Q:$D(GMTSQIT)  W ?5,"Marital Status: ",?21,$P(VADM(10),"^",2)
	I VADM(4)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?56,"Age: ",$P(VADM(4),"^",1),!
	I VADM(9)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?11,"Religion: ",$P(VADM(9),"^",2)
	I VADM(5)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?56,"Sex: ",$P(VADM(5),"^",2),!
	I VAPD(6)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Occupation: ",$P(VAPD(6),"^",1),!
	I $P(VAEL(2),"^",1) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?2,"Period of Service: ",?21,$P(VAEL(2),"^",2),!
	I VASV(6) S GMI=6 D BOS
	I VASV(7) S GMI=7 D BOS
	I VASV(8) S GMI=8 D BOS
	D MORE
	Q
BOS	;FORMAT BRANCH OF SERVICE
	S X=$P(VASV(GMI,4),U,1) D REGDT^GMTSU S FROM=X
	S X=$P(VASV(GMI,5),U,1) D REGDT^GMTSU S TO=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMI=6 ?2,"Branch of Service: " W ?21,$P(VASV(GMI,1),U,2)," ",FROM," TO ",TO,!
	Q
MORE	;SERVICE CONNECTED DISABILITIES
	I $P(VAEL(2),U) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?13,"Combat: ",$S(VASV(5):"Y",1:"N"),?56,"POW: ",$S(VASV(4):"Y",1:"N"),!
ELIG	I $P(VAEL(1),"^",1) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?8,"Eligibility: ",?21,$P(VAEL(1),"^",2) W:VAEL(8)'="" ?52," Status: ",$P(VAEL(8),"^",2) W !
	I $O(VAEL(1,0)) S I=0 F Z=0:0 S I=$O(VAEL(1,I)) Q:I=""  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,$P(VAEL(1,I),"^",2),!
SC	I VAEL(3) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?14,"S/C %: ",?21,$P(VAEL(3),"^",2),!
	I VAEL(9)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Means Test: ",$P(VAEL(9),"^",2),!
	;I $D(^DPT(DFN,.372)) S IX=0 F I=0:0 S IX=$O(^(DFN,.372)) Q:IX=""  D SCDP
	Q:VAOA(9)=""
	I VAOA(9)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?16,"NOK: ",VAOA(9) W:VAOA(10)'="" ?51,"Relation: ",VAOA(10) W !
	I VAOA(1)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W:VAOA(1)]"" ?21,VAOA(1) W:VAOA(8)'="" ?54,"Phone: ",VAOA(8) W !
	I VAOA(2)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAOA(2),!
	I VAOA(3)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAOA(3),!
	I VAOA(4)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAOA(4) W:VAOA(5) ", ",$P(VAOA(5),U,2) W:VAOA(6) "  ",VAOA(6) W !
	Q
END	K I,VA,VADM,VAERR,VAOA,VASV,VAPA,VAPD,VAEL,SCD,SCDS,SCDP,FROM,GMI,TO,IX,X,Z Q
IEN	;INELIGBLE FOR CARE DATA
	S X=$P(VAEL(5,1),U,1) D REGDT^GMTSU
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?5,"Ineligible date: ",X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,"Ineligible TWX source: ",$P(VAEL(5,2),U,2),"  ",VAEL(5,3),", ",$P(VAEL(5,4),U,2),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:VAEL(5,5) VAEL(5,5) W:VAEL(5,6) " Reason: ",VAEL(5,6),!
	Q
SCDP	;Service Connected Diagnosis Print
	S SCD=^DPT(DFN,.372,IX,0)
	S SCDS=$S($P(SCD,"^",1):$P(^DIC(31,$P(SCD,"^",1),0),"^",1),1:"") S SCDP=$P(SCD,"^",2)_"% "_$S($P(SCD,"^",3):"SC",1:"")
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,"S/C Disabilities: ",SCDS,?61,SCDP,!
	Q

GMTSDEMB
GMTSDEMB	;SLC/DLT - Brief Demographic Component  ;1/31/91
	;;2.7;Health Summary;;Oct 20, 1995
	;
DEMOG	; Prints Brief Demographic data from VADPT calls
	D ELIG^VADPT,ADD^VADPT,DEM^VADPT
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,"Address: "_$S($L(VAPA(1)):VAPA(1),1:"Not available"),?53," Phone:",?61,VAPA(8),!
	I VAPA(2)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAPA(2),!
	I VAPA(3)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAPA(3),!
	I VAPA(4)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,VAPA(4),", ",$P(VAPA(5),"^",2),"  ",VAPA(6),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?8,"Eligibility: ",?21,$P(VAEL(1),"^",2)
	I VADM(4)'="" D CKP^GMTSUP Q:$D(GMTSIT)  W ?56,"Age: ",$P(VADM(4),"^",1),!
	I VAEL(9)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Means Test: ",$P(VAEL(9),"^",2)
	I VADM(5)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?56,"Sex: ",$P(VADM(5),"^",2),!
	;I $O(VAEL(1,0)) S I=0 F Z=0:0 S I=$O(VAEL(1,I)) Q:I=""  W ?21,$P(VAEL(1,I),"^",2),!
	K I,IX,VA,VAEL,VAPA Q

GMTSDGA
GMTSDGA	;SLC/ARS,MKB - Admissions for Health Summary ;8/27/91  10:40 ;
	;;2.7;Health Summary;;Oct 20, 1995
ENAD	;Gets Admission Information 
	S TT=1,FLGDX=0,FLGDC=0
	D PATINFO Q
ENDC	;DISCHARGE INFORMATION
	S TT=3,FLGDC=1,FLGDX=0
	D PATINFO Q
ENDX	;PTF DISCHARGE DIAGNOSIS
	S TT=3,FLGDX=1,FLGDC=0
	D PATINFO Q
ENTS	;TREATING SPECIALITY INFORMATION
	S TT=6,FLGDX=0,FLGDC=0
	D PATINFO Q
ENTR	;TRANSFERS
	S TT=2,FLGDX=0,FLGDC=0
	D PATINFO Q
PATINFO	S VA200=1 K DIQ
	I $D(GMTSNDM),GMTSNDM>0 S CNTR=GMTSNDM
	E  S CNTR=100
	S GMC=-1,GMN="",ADM=GMTS1,FLAG=0
	I TT=1 D FADM^GMTSDGA2
	F  S ADM=$O(^DGPM("ATID"_TT,DFN,ADM)) Q:('ADM!(ADM>GMTS2)!($D(GMTSQIT)))  D GET Q:$D(GMTSQIT)!(CNTR<0)
	D KILLADM
	Q
GET	; Call IN5^VADPT to get admission data
	N VAHOW
	S ADA=$O(^DGPM("ATID"_TT,DFN,ADM,0)) Q:'ADA
	S CNTR=CNTR-1 I CNTR<0 Q
	S VAIP("E")=ADA D IN5^VADPT
	S (X,ADATE)=+VAIP(3) D REGDT^GMTSU S ADT=X
	K DGPMIFN S:TT=1 DGPMIFN=ADA S:TT'=1 DGPMIFN=VAIP(13)
	S GMC=2
	D CONTGET
	S LIN=$S(TT=2:"TROUT^GMTSDGA1",FLGDX:"DXOUT^GMTSDGA1",FLGDC:"DCOUT^GMTSDGA1",TT=6:"TSOUT^GMTSDGA2",TT=1:"ADOUT^GMTSDGA1") D @LIN
	K ICD(ADM)
	Q
CONTGET	;ICD and LOS info only needed for certain MAS components
	Q:TT=2  Q:TT=6
	N DIC,DR,DA,DIQ
	I DGPMIFN D ^DGPMLOS S LOS=+X
	S PTF=$S($D(VAIP(12)):VAIP(12),1:"")
	I '$D(^ICD9) Q
	I PTF="" Q
	I '$D(^DGPT(PTF,70)) Q
	S ICD=^DGPT(PTF,70),DIC=80,DR=".01;3"
	I $P(ICD,U,11)'="" S DA=$P(ICD,U,11),DIQ="ICD(ADM,1," D EN^DIQ1
	I $P(ICD,U,10)'="" S DA=$P(ICD,U,10),DIQ="ICD(ADM,2," D EN^DIQ1
	F GMTSI=16:1:24 I $P(ICD,U,GMTSI)'="" S DA=$P(ICD,U,GMTSI),DIQ="ICD(ADM,(GMTSI-13)," D EN^DIQ1
	Q
KILLADM	;Kills Admission variables
	D KVAR^VADPT
	K ADA,ADATE,ADT,BD,BDSC,DA,DIC,DDT,DP,DSPL,GMJ,GMJ1,OP,OPTR,FLAG,FLGDX,FLGDC,X,DR,GMI,GMTO,GMTNO,GMTSI,GMX,ADM,CNTR,GMC,GMZ,GMN,ICD,PTF,PTF70,PTFLG,LOS,II,DGPMIFN,IN,LIN,TI,TT,TS,SPEC
	Q

GMTSDGA1
GMTSDGA1	;SLC/ARS,MKB - Admissions for Health Summary cont. ;12/2/91  13:25 ;
	;;2.7;Health Summary;;Oct 20, 1995
TROUT	;TRANSFERS OUTPUT
	S X=ADATE D MTIM^GMTSU S TI=X,ADT=ADT_" "_TI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ADT,?21,$P(VAIP(4),U,2),$S($P(VAIP(4),U,2)'["TO":" TO ",1:" "),$P(VAIP(5),U,2),!
	S TRFAC=$P(^DGPM(ADA,0),U,5) I $L(TRFAC) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?24,TRFAC,! K TRFAC
	Q
DCOUT	;DISCHARGES OUTPUT
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I VAIP(17)="" S GMC=-1 Q
	I VAIP(17,1)'="" S X=+VAIP(17,1) D REGDT^GMTSU W "   Date of Discharge: ",X,!
	I (+$P($G(ICD),U,10)>0),($G(ICD(ADM,2,80,+$P(ICD,U,10),3))]"") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?16,"DXLS: ",ICD(ADM,2,80,+$P(ICD,U,10),3),!
	S PTFLG=$S(PTF="":0,'$D(^DGPT(+PTF,70)):0,1:1),PTF70=$S(PTFLG:^DGPT(+PTF,70),1:"")
	I PTFLG,+($P(PTF70,U,2))>0 S BD=+($P(PTF70,U,2)),BDSC=$S($D(^DIC(42.4,+BD,0)):$P(^(0),U),1:"UNKNOWN")
	E  S BDSC="UNKNOWN"
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?10,"Bedsection: ",BDSC,!
	I $G(VAIP(17,3))'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W "    Disposition Type: ",$P(VAIP(17,3),U,2),!
	I PTFLG,$P(PTF70,U,6)'="" S DP=$P(PTF70,U,6),DSPL=$S($D(^DIC(45.6,+DP,0)):$P(^(0),U),1:"UNKNOWN")
	E  S DSPL="UNKNOWN"
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "   Disposition Place: ",DSPL,!
	I PTFLG,$P(PTF70,U,4)'="" S OP=$P(PTF70,U,4),OPTR=$S(OP=1:"YES",OP=3:"NO",1:"UNKNOWN")
	E  S OPTR="UNKNOWN"
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Outpatient Treatment: ",OPTR,!
	I 'GMTSNPG D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
DXOUT	;PTF DISCHARGE DIAGNOSIS OUTPUT
	I FLAG>1,'GMTSNPG D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	D CKP^GMTSUP Q:$D(GMTSQIT)
	S FLAG=2
	S X=+$G(VAIP(13,1)) D REGDT^GMTSU S DDT=X
	W DDT," - ",ADT,?57,"LOS: ",LOS,!
	S NODIAG=1,GMI=0
	F  S GMI=$O(ICD(ADM,GMI)) Q:'GMI  D CKP^GMTSUP Q:$D(GMTSQIT)  S GMX="" F  S GMX=$O(ICD(ADM,GMI,80,GMX)) Q:'GMX  D NXT
	I NODIAG D CKP^GMTSUP Q:$D(GMTSQIT)  W "No discharge diagnosis available for this admission.",! K NODIAG
	Q
ADOUT	;ADMISSIONS OUTPUT
	I FLAG>1,'GMTSNPG D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	D CKP^GMTSUP Q:$D(GMTSQIT)
	S FLAG=2
	I $G(VAIP(17,1))="" S DDT="Present"
	E  S X=$P(VAIP(17,1),U,1) D REGDT^GMTSU S DDT=X
	W ADT," - ",DDT I VAIP(17,1)="" W ?21,GMTSWARD," ",GMTSRB
	W ?56,"LOS: ",LOS,!
	S TS=$P($G(^DIC(45.7,+$P($G(VAIP(14,6)),U),0)),U,2) S SPEC=$P($G(^DIC(42.4,+TS,0)),U)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "  Last Tr Specialty: ",$E(SPEC,1,25),?50,"Last Prov: ",$E($P($G(VAIP(14,5)),U,2),1,15),!
	I $G(VAIP(17,1))="" D CKP^GMTSUP Q:$D(GMTSQIT)  W "Admitting Diagnosis: ",$G(VAIP(13,7)),!
	I PTF'="",$D(^DGPT(+PTF,70)) D CKP^GMTSUP Q:$D(GMTSQIT)  W "         Bedsection: ",$S(+($P(^DGPT(PTF,70),U,2))>0:$P($G(^DIC(42.4,+$P(^DGPT(PTF,70),U,2),0)),U),1:""),!
	Q:'$D(ICD)  S GMI=0 F  S GMI=$O(ICD(ADM,GMI)) Q:'GMI  D CKP^GMTSUP Q:$D(GMTSQIT)  S GMX="" F  S GMX=$O(ICD(ADM,GMI,80,GMX)) Q:'GMX  D NXT
	;I 'GMTSNPG D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
NXT	S (GMTO,GMTNO)="" S GMTO=$G(ICD(ADM,GMI,80,GMX,3)),GMTNO=$G(ICD(ADM,GMI,80,GMX,.01))
	W:GMI=1 "Principal Diagnosis: " W:GMI=2 ?15,"DXLS: "
	W:GMI=3 ?13,"ICD DX: " W ?21,GMTO,?62,GMTNO,!
	S NODIAG=0
	Q

GMTSDGA2
GMTSDGA2	;SLC/ARS,MKB - Treating Specialty for Health Summary ;3/19/91
	;;2.7;Health Summary;;Oct 20, 1995
TSOUT	;TREATING SPECIALITY OUTPUT
	S X=+VAIP(13,1) D REGDT^GMTSU S DDT=X
	S X=ADATE D MTIM^GMTSU S ADT=ADT_" "_X
	S TS=$P($G(^DIC(45.7,+VAIP(8),0)),U,2) S SPEC=$S($D(^DIC(42.4,+TS,0)):$P(^(0),U),1:"UNKNOWN")
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ADT,?21,$E(SPEC,1,25),?48,"(",DDT,")",?61,$E($P(VAIP(7),U,2),1,15),!
	K ^UTILITY($J,"W") I $D(^DGPM(ADA,"DX")) F GMJ=1:1:$P(^DGPM(ADA,"DX",0),"^",4) S X=^DGPM(ADA,"DX",GMJ,0),DIWL=27,DIWR=71,DIWF="C46R" D ^DIWP
	I $D(^UTILITY($J,"W")) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,"Diag: " S GMJ=$O(^UTILITY($J,"W",0)) Q:'GMJ  S GMJ1=0 F GMZ=0:0 S GMJ1=$O(^UTILITY($J,"W",GMJ,GMJ1)) Q:'GMJ1  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?27,^UTILITY($J,"W",GMJ,GMJ1,0),!
	K DIWL,DIWF,DIWR,^UTILITY($J,"W")
	Q
FADM	;Future Scheduled admission output
	N GMDT,NODE,X
	K ^TMP("GMFADM",$J)
	D GETFADM
	Q:'$D(^TMP("GMFADM",$J))
	S GMC=1
	S GMDT=0
	F  S GMDT=$O(^TMP("GMFADM",$J,GMDT)) Q:GMDT'>0  D
	. I FLAG>1,'GMTSNPG D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. S FLAG=2
	. S NODE=$G(^TMP("GMFADM",$J,GMDT))
	. S X=$P(NODE,U) D REGDT^GMTSU
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W X," (Future)",?21,$E($P(NODE,U,5),1,24)
	. I $P(NODE,U,6)>0 W ?47,"Expected LOS: ",$P(NODE,U,6),!
	. D CKP^GMTSUP Q:$D(GMTSQIT)  D
	. . I $P(NODE,U,2)]"" W "Admitting Diagnosis: ",$P(NODE,U,2)
	. . W ?51,"Provider: ",$E($P(NODE,U,3),1,15),!
	K ^TMP("GMFADM",$J)
	Q
GETFADM	;Get future scheduled admission data
	N DA,DIQ,DIC,DR
	Q:'$D(^DGS(41.1,"B",DFN))
	K ^TMP("GMFADM",$J)
	S DA=0,DIC=41.1,DR="2;3;4;5;6;8;9;10;13;17"
	F  S DA=$O(^DGS(41.1,"B",DFN,DA)) Q:DA'>0  D
	. N GMFADM,DIQ,RESDT,ADDX,PROV,SUR,LOC,LOS
	. S DIQ="GMFADM",DIQ(0)="IE"
	. D EN^DIQ1
	. ;Quit if reservation day is past, admission cancel or patient admitted
	. Q:GMFADM(41.1,DA,13,"I")]""!(GMFADM(41.1,DA,17,"I")]"")!(GMFADM(41.1,DA,2,"I")<DT)
	. S RESDT=GMFADM(41.1,DA,2,"I"),ADDX=GMFADM(41.1,DA,4,"I")
	. S PROV=GMFADM(41.1,DA,5,"E"),SUR=GMFADM(41.1,DA,6,"E")
	. ; LOC will contain either ward or treating specialty
	. S LOC=$S(GMFADM(41.1,DA,10,"I")="W":GMFADM(41.1,DA,8,"E"),GMFADM(41.1,DA,10,"I")="T":GMFADM(41.1,DA,9,"E"),1:"")
	. S LOS=GMFADM(41.1,DA,3,"I")
	. S ^TMP("GMFADM",$J,9999999-RESDT)=RESDT_U_ADDX_U_PROV_U_SUR_U_LOC_U_LOS
	Q

GMTSDGC1
GMTSDGC1	;SLC/SBW - Subroutines for Extended ADT History Comp. ;27/Aug/94
	;;2.7;Health Summary;;Oct 20, 1995
OTHER(DFN,PTF,CODE,GMVAIP,MDA)	; Additional data to include
	N LOS,ICD,DGPMIFN,GMI,GMX,NODIAG,GMTO,GMTNO,BD,BDSC
	N DP,DSPL,OP,OPTR
	I CODE=1 D  Q  ;Other data for Admission entries
	. Q:$G(GMVAIP("DN",1))'=""
	. D GETDATA
	. I $G(GMVAIP("MF"))]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?10,"Adm. Diag.: ",GMVAIP("MF")
	. W ?64,"LOS: ",LOS,!
	. Q:'$D(ICD)
	. S GMI=0
	. F  S GMI=$O(ICD(GMI)) Q:'GMI  D CKP^GMTSUP Q:$D(GMTSQIT)  S GMX="" F  S GMX=$O(ICD(GMI,80,GMX)) Q:'GMX  D NXTICD
	I CODE=2 D  Q  ;Other data for Transfer entries
	. N TRFAC
	. S TRFAC=$P(^DGPM(MDA,0),U,5)
	. I $P($G(GMVAIP("WL")),U,2)]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?18,$S($P(VAIP("MT"),U,2)'["TO":"To ",1:""),$P(VAIP("WL"),U,2),$S($L(TRFAC):"  at "_TRFAC,1:""),!
	I CODE=3 D  Q  ;Other data for Discharge entries
	. ; Discharge data
	. D GETDATA
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W ?10,"Bedsection: ",BDSC,?64,"LOS: ",LOS,!
	. S NODIAG=1,GMI=0
	. F  S GMI=$O(ICD(GMI)) Q:GMI'>0  S GMX=0 F  S GMX=$O(ICD(GMI,80,GMX)) Q:GMX'>0  D NXTICD
	. I NODIAG D CKP^GMTSUP Q:$D(GMTSQIT)  D
	. . W ?5,"Principal Diag.: No discharge diagnosis available.",!
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W "   Disposition Place: ",DSPL,!
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W "   Outpat. Treatment: ",OPTR,!
	. I 'GMTSNPG D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	I CODE=6 D  Q  ;Other data for Treating Specialty entries
	. N DIWL,DIWF,DIWR,GMJ,GMJ1
	. K ^UTILITY($J,"W")
	. S DIWL=22,DIWR=78,DIWF="C56"
	. I $D(^DGPM(MDA,"DX")) D
	. . F GMJ=1:1:$P(^DGPM(MDA,"DX",0),"^",4) S X=^DGPM(MDA,"DX",GMJ,0) D ^DIWP
	. I $D(^UTILITY($J,"W")) D
	. . S GMJ=$O(^UTILITY($J,"W",0)) Q:'GMJ
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,"TS Diag.: "
	. . S GMJ1=0
	. . F  S GMJ1=$O(^UTILITY($J,"W",GMJ,GMJ1)) Q:'GMJ1  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?22,^UTILITY($J,"W",GMJ,GMJ1,0),!
	. K ^UTILITY($J,"W")
	Q
GETDATA	; Gets LOS, ICD and bedsection data
	N DIC,DR,DA,DIQ,GMTSI,X,PTFA
	S DGPMIFN=$G(GMVAIP("AN"))
	I DGPMIFN D ^DGPMLOS S LOS=+X
	I '$D(^ICD9) Q
	I '$D(^DGPT(PTF,70)) Q
	S DIC=45,DA=+PTF,DR="71;73;75;",DIQ="PTFA("
	D EN^DIQ1
	S BDSC=$S(PTFA(45,+DA,71)]"":PTFA(45,+DA,71),1:"UNKNOWN")
	S DSPL=$S(PTFA(45,+DA,73)]"":PTFA(45,+DA,73),1:"UNKNOWN")
	S OPTR=$S(PTFA(45,+DA,75)]"":PTFA(45,+DA,75),1:"UNKNOWN")
	S ICD=^DGPT(PTF,70),DIC=80,DR=".01;3"
	I $P(ICD,U,11)'="" S DA=$P(ICD,U,11),DIQ="ICD(1," D EN^DIQ1
	I $P(ICD,U,10)'="" S DA=$P(ICD,U,10),DIQ="ICD(2," D EN^DIQ1
	F GMTSI=16:1:24 I $P(ICD,U,GMTSI)'="" S DA=$P(ICD,U,GMTSI),DIQ="ICD((GMTSI-13)," D EN^DIQ1
	Q
NXTICD	; Print the next ICD
	S (GMTO,GMTNO)="" S GMTO=$G(ICD(GMI,80,GMX,3)),GMTNO=$G(ICD(GMI,80,GMX,.01))
	W:GMI=1 ?5,"Principal Diag.: "
	W:GMI=2 ?16,"DXLS: "
	W:GMI=3 ?14,"ICD DX: "
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?22,GMTO,?62,GMTNO,!
	S NODIAG=0
	Q

GMTSDGC2
GMTSDGC2	;SLC/SBW - Subroutines for Extended ADT History Comp. ;27/Aug/94
	;;2.7;Health Summary;;Oct 20, 1995
ICDP(DFN,PTF)	;Module For History of PTF Procedures
	Q:'$D(^DGPT(PTF,"P"))
	N II,PRX,X,IX,GMP,GTA,O,O1,LN1
	S II=0
	F  S II=$O(^DGPT(PTF,"P",II)) Q:'II  S PRX=^DGPT(PTF,"P",II,0),X=$P(PRX,U,1),IX=9999999-X D REGDT^GMTSU D
	. S GMP(IX)="Procedure "_X F GTA=5:1:9 D
	. . N DIQ,DA,DIQ,ICDP
	. . Q:$P(PRX,U,GTA)=""
	. . S DIC=80.1,DR="4;.01",DA=$P(PRX,U,GTA),DIQ="ICDP(" D EN^DIQ1
	. . I $D(ICDP(80.1,DA)) S GMP(IX,GTA)=$E(ICDP(80.1,DA,4),1,45)_U_ICDP(80.1,DA,.01)
	I $D(GMP) S O=0 F  S O=$O(GMP(O)) Q:O=""  D
	. S O1=0,LN1=1
	. F  S O1=$O(GMP(O,O1)) Q:O1=""  D CKP^GMTSUP Q:$D(GMTSQIT)  S:GMTSNPG LN1=1 W:LN1 ?2,GMP(O) W ?22,$P(GMP(O,O1),U),?69,$P(GMP(O,O1),U,2),! S LN1=0
	Q
ICDS(DFN,PTF)	; Module for history of PTF surgery episodes
	Q:'$D(^DGPT(PTF,"S"))
	N II,SURG,X,IX,GMS,GMA,O,O1,LN1
	S II=0
	F  S II=$O(^DGPT(PTF,"S",II)) Q:'II  S SURG=^DGPT(PTF,"S",II,0),X=$P(SURG,U,1),IX=9999999-X D REGDT^GMTSU D
	. ;Load Surgery entries into GMS array in inverted sequence
	. S GMS(IX)="  Surgery "_X F GMA=8:1:12 D
	. . ;Surgery Line
	. . N DIQ,DA,DIQ,ICDS
	. . Q:$P(SURG,U,GMA)=""
	. . S DIC=80.1,DR="4;.01",DA=$P(SURG,U,GMA),DIQ="ICDS(" D EN^DIQ1
	. . I $D(ICDS(80.1,DA)) S GMS(IX,GMA)=$E(ICDS(80.1,DA,4),1,45)_U_ICDS(80.1,DA,.01)
	I $D(GMS) S O=0 F  S O=$O(GMS(O)) Q:O=""  D
	. S O1=0,LN1=1
	. F  S O1=$O(GMS(O,O1)) Q:O1=""  D CKP^GMTSUP Q:$D(GMTSQIT)  S:GMTSNPG LN1=1 W:LN1 ?2,GMS(O) W ?22,$P(GMS(O,O1),U),?69,$P(GMS(O,O1),U,2),! S LN1=0
	Q

GMTSDGCH
GMTSDGCH	;SLC/SBW - Patient Extended ADT History Component ;27/Aug/94
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Loop through admissions starting from most recent
	N FLAG,IN,IM,ADA,ADM,MDA,MDM,X,DOC,CNTR,CODE,TYPE,TT,SPEC
	N ITS,TS,TSDM,TSDA,VAHOW,VA200,GMC,GMMDA
	K VAIP
	I $D(GMTSNDM),GMTSNDM>0 S CNTR=GMTSNDM
	E  S CNTR=100
	S VA200=1,VAHOW=1,FLAG=-1,ADM=GMTS1,GMC=0
	D DISAB,FADM
	F  S ADM=$O(^DGPM("ATID1",DFN,ADM)) Q:('ADM)!(ADM>GMTS2)!(CNTR=0)!('DFN)  S GMC=0 D MVTS I GMC>0 D ICDP^GMTSDGC2(DFN,PTF),ICDS^GMTSDGC2(DFN,PTF)
	D KVAR^VADPT
	K ^UTILITY($J)
	Q
MVTS	; Loop through mvts chronologically, per admission
	S ADA=0,ADA=$O(^DGPM("ATID1",DFN,ADM,ADA)) Q:'ADA
	N VAIP,PREVDR,PREVSP
	K ^UTILITY($J)
	S (VAIP("E"),GMMDA)=ADA D IN5^VADPT
	I $D(VAIP) D CKP^GMTSUP Q:$D(GMTSQIT)  W:FLAG>0 ! D PRNT
	D SETUTL
	S MDM=""
	F  S MDM=$O(^UTILITY($J,"GMTSMVTS",MDM)) Q:'MDM  D GET
	S CNTR=CNTR-1
	K ^UTILITY($J)
	Q
GET	; D IN5^VADPT for each mvt, print info
	I ^UTILITY($J,"GMTSMVTS",MDM)=ADA Q
	K VAIP
	S (VAIP("E"),GMMDA)=^UTILITY($J,"GMTSMVTS",MDM) D IN5^VADPT
	I $D(VAIP) D PRNT
	Q
PRNT	; output line of data
	S X=+$P(VAIP("MD"),U) D REGDT^GMTSU
	D CKP^GMTSUP Q:$D(GMTSQIT)
	S DOC=$E($P($G(VAIP("DR")),U,2),1,10),TYPE=$P($G(VAIP("MT")),U,2)
	S CODE=+$P($G(VAIP("TT")),U),SPEC=$P(VAIP(("TS")),U,2)
	S PTF=+$G(VAIP("PT"))
	S TT=$S(CODE=0:"NON",CODE=1:"ADM",CODE=2:"TR ",CODE=3:"DC ",CODE=4:"CIL",CODE=5:"COL",CODE=6:"TS ",1:"   ")
	I 'GMTSNPG,$D(PREVDR),PREVDR=$P(VAIP("DR"),U) S DOC="  "" "
	I 'GMTSNPG,$D(PREVSP),PREVSP=$P(VAIP("TS"),U) S SPEC="    "" "
	S GMC=1
	W X,?11,TT,"  ",$E(TYPE,1,35),?55,$E(SPEC,1,12),?69,DOC,!
	D OTHER^GMTSDGC1(DFN,PTF,CODE,.VAIP,$G(GMMDA))
	S FLAG=2,PREVDR=$P(VAIP("DR"),U),PREVSP=$P(VAIP("TS"),U)
	Q
SETUTL	;
	S (TSDM,MDM)=0
	F  S TSDM=$O(^DGPM("ATS",DFN,ADA,TSDM)) Q:'TSDM  D NEXT1
	F  S MDM=$O(^DGPM("APCA",DFN,ADA,MDM)) Q:'MDM  D NEXT2
	Q
NEXT1	;
	S TS="",TS=$O(^DGPM("ATS",DFN,ADA,TSDM,TS)) Q:'TS
	S TSDA=0,TSDA=$O(^DGPM("ATS",DFN,ADA,TSDM,TS,TSDA)) Q:'TSDA
	S ^UTILITY($J,"GMTSMVTS",9999999-TSDM)=TSDA
	Q
NEXT2	;
	S MDA=0,MDA=$O(^DGPM("APCA",DFN,ADA,MDM,MDA)) Q:'MDA
	I MDA'=ADA S ^UTILITY($J,"GMTSMVTS",MDM)=MDA
	Q
DISAB	; Initializes Variables and Controls Looping for disability display
	N GMW,GMTSI,VA,VADM,VAEL,VAERR,VAPA
	D ELIG^VADPT I +$G(VAEL("EL")) D
	. S FLAG=2
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W "Eligibility: ",$E($P(VAEL("EL"),U,2),1,40)
	. W:VAEL("ES")]"" ?55,$P(VAEL("ES"),U,2)
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W:+VAEL("SC") !,"Total S/C %: ",$P(VAEL("SC"),U,2)
	. I '$D(^DPT(DFN,.372)) D  Q
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"   No rated disabilities"
	. S GMTSI=0
	. F  S GMTSI=$O(^DPT(DFN,.372,GMTSI)) Q:GMTSI'>0  D
	. . ; Resolves pointers and prints disability record
	. . N DA,DIQ,DR,DIC,GMTSDIS
	. . S DIC="^DPT("_DFN_",.372,",DA=GMTSI,DR=".01;2;3",DIQ="GMTSDIS",DIQ(0)="E"
	. . D EN^DIQ1
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W !?3,GMTSDIS(2.04,DA,.01,"E"),?51,$J(GMTSDIS(2.04,DA,2,"E"),3),"%",?60,$S(GMTSDIS(2.04,DA,3,"E")="YES":"S/C",1:"NSC")
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
FADM	; Retrieve future scheduled admissions and display this data
	N GMDT,NODE,X
	K ^TMP("GMFADM",$J)
	D GETFADM^GMTSDGA2
	Q:'$D(^TMP("GMFADM",$J))
	S GMDT=0
	F  S GMDT=$O(^TMP("GMFADM",$J,GMDT)) Q:GMDT'>0  D
	. S NODE=$G(^TMP("GMFADM",$J,GMDT))
	. S X=$P(NODE,U) D REGDT^GMTSU
	. I FLAG>0 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	. E  S FLAG=2
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W X,?16,"Scheduled Admission",?55,$E($P(NODE,U,5),1,12),?69,$E($P(NODE,U,3),1,10),!
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. I $P(NODE,U,2)]"" W ?10,"Adm. Diag.: ",$P(NODE,U,2)
	. I $P(NODE,U,6)>0 W ?55,"Expected LOS: ",$P(NODE,U,6),!
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. I $P(NODE,U,4)]"" W ?13,"Surgery: ",$P(NODE,U,4),!
	K ^TMP("GMFADM",$J)
	Q

GMTSDGD
GMTSDGD	;SLC/JER - Rated Disabilities Component ;2/5/91  11:42
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Initializes Variables and Controls Looping
	N GMW,GMTSI,VA,VADM,VAEL,VAERR,VAPA
	D 6^VADPT I +VAEL(1) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Eligibility: ",$E($P(VAEL(1),U,2),1,40) W:VAEL(8)]"" ?55,$P(VAEL(8),U,2) W ! D CKP^GMTSUP Q:$D(GMTSQIT)  W:+VAEL(3) "Total S/C %: ",$P(VAEL(3),U,2),! W !
	I '$D(^DPT(DFN,.372)) Q
	S GMTSI=0 F  S GMTSI=$O(^DPT(DFN,.372,GMTSI)) Q:GMTSI'>0  D WRT
	Q
WRT	; Resolves pointers and prints disability record
	N DA,DIQ,DR,DIC,GMTSDIS
	S DIC="^DPT("_DFN_",.372,",DA=GMTSI,DR=".01;2;3",DIQ="GMTSDIS",DIQ(0)="E"
	D EN^DIQ1
	D CKP^GMTSUP Q:$D(GMTSQIT)  W GMTSDIS(2.04,DA,.01,"E"),?55,$J(GMTSDIS(2.04,DA,2,"E"),3),"%",?75,$S(GMTSDIS(2.04,DA,3,"E")="YES":"S/C",1:"NSC"),!
	Q

GMTSDGH
GMTSDGH	;SLC/MKB - Patient History Component by admissions ;8/27/91  11:50
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Loop through admissions starting from most recent
	N VAHOW
	K VAIP
	I $D(GMTSNDM),GMTSNDM>0 S CNTR=GMTSNDM
	E  S CNTR=100
	S VA200=1,VAHOW=1,FLAG=-1,ADM=GMTS1
	F  S ADM=$O(^DGPM("ATID1",DFN,ADM)) Q:('ADM)!(ADM>GMTS2)!(CNTR=0)!('DFN)  D MVTS
	D KILVAR
	Q
MVTS	; Loop through mvts chronologically, per admission
	S ADA=0,ADA=$O(^DGPM("ATID1",DFN,ADM,ADA)) Q:'ADA
	K VAIP,PREVDR,PREVSP,^UTILITY($J)
	S VAIP("E")=ADA D IN5^VADPT
	I $D(VAIP) D CKP^GMTSUP Q:$D(GMTSQIT)  W:FLAG>0 ! D PRNT
	D SETUTL
	S MDM="" F  S MDM=$O(^UTILITY($J,"GMTSMVTS",MDM)) Q:'MDM  D GET
	S CNTR=CNTR-1
	Q
GET	; D IN5^VADPT for each mvt, print info
	I ^UTILITY($J,"GMTSMVTS",MDM)=ADA Q
	K VAIP S VAIP("E")=^UTILITY($J,"GMTSMVTS",MDM) D IN5^VADPT
	I $D(VAIP) D PRNT
	Q
PRNT	; output line of data
	S X=+$P(VAIP("MD"),U) D REGDT^GMTSU
	D CKP^GMTSUP Q:$D(GMTSQIT)
	S DOC=$E($P(VAIP("DR"),U,2),1,10),TYPE=$P(VAIP("MT"),U,2),CODE=+$P(VAIP("TT"),U),SPEC=$E($P(VAIP("TS"),U,2),1,12)
	S TT=$S(CODE=0:"NON",CODE=1:"ADM",CODE=2:"TR ",CODE=3:"DC ",CODE=4:"CIL",CODE=5:"COL",CODE=6:"TS ",1:"   ")
	I 'GMTSNPG,$D(PREVDR),PREVDR=$P(VAIP("DR"),U) S DOC="  "" "
	I 'GMTSNPG,$D(PREVSP),PREVSP=$P(VAIP("TS"),U) S SPEC="    "" "
	W X,?11,TT,"  ",$E(TYPE,1,35),?55,SPEC,?69,DOC,!
	S FLAG=2,PREVDR=$P(VAIP("DR"),U),PREVSP=$P(VAIP("TS"),U)
	Q
SETUTL	;
	S (TSDM,MDM)=0
	F  S TSDM=$O(^DGPM("ATS",DFN,ADA,TSDM)) Q:'TSDM  D NEXT1
	F  S MDM=$O(^DGPM("APCA",DFN,ADA,MDM)) Q:'MDM  D NEXT2
	Q
NEXT1	;
	S TS="",TS=$O(^DGPM("ATS",DFN,ADA,TSDM,TS)) Q:'TS
	S TSDA=0,TSDA=$O(^DGPM("ATS",DFN,ADA,TSDM,TS,TSDA)) Q:'TSDA
	S ^UTILITY($J,"GMTSMVTS",9999999-TSDM)=TSDA
	Q
NEXT2	;
	S MDA=0,MDA=$O(^DGPM("APCA",DFN,ADA,MDM,MDA)) Q:'MDA
	I MDA'=ADA S ^UTILITY($J,"GMTSMVTS",MDM)=MDA
	Q
KILVAR	; Clean-up, exit
	D KVAR^VADPT
	K FLAG,IN,IM,ADA,ADM,MDA,MDM,X,DOC,CNTR,CODE,TYPE,TT,PREVSP,PREVDR,SPEC
	K ITS,TS,TSDM,TSDA,^UTILITY($J)
	Q

GMTSDGP
GMTSDGP	;SLC/TRS - MAS PTF Surgeries/Procedures Components ;10/10/91  11:43 ;
	;;2.7;Health Summary;;Oct 20, 1995
ENS	;Module For History of PTF Surgery Episodes
	I $D(GMTSNDM),GMTSNDM>0 S CNTR=GMTSNDM
	E  S CNTR=100
	S T1=GMTSEND,T2=GMTSBEG,GMCZ=0
	S PTF=0
	F  S PTF=$O(^DGPT("B",DFN,PTF)) Q:PTF=""  D ICDS
	I $D(GMS) S O=0 F I=1:1 S O=$O(GMS(O)) Q:O=""  Q:'CNTR  S CNTR=CNTR-1 S O1=0,LN1=1 F I=1:1 S O1=$O(GMS(O,O1)) Q:O1=""  D CKP^GMTSUP Q:$D(GMTSQIT)  S:GMTSNPG LN1=1 W:LN1 GMS(O) W ?21,$P(GMS(O,O1),U),?68,$P(GMS(O,O1),U,2),! S LN1=0
	D KILLADM Q
ICDS	Q:'$D(^DGPT(PTF,"S"))
	S II=0 F ZI=1:1 S II=$O(^DGPT(PTF,"S",II)) Q:'II  S SURG=^DGPT(PTF,"S",II,0),X=$P(SURG,U,1),IX=9999999-X I X>T2&(X<T1) D REGDT^GMTSU D ICDS1
	Q
ICDS1	;Load Surgery entries into GMS array in inverted sequence
	S GMCZ=2
	S GMS(IX)="  Surgery  "_X F GMA=8:1:12 D SGY
	Q
SGY	;Surgery Line
	K DIQ
	Q:$P(SURG,U,GMA)=""
	S DIC=80.1,DR="4;.01",DA=$P(SURG,U,GMA),DIQ="ICDS(" D EN^DIQ1
	I $D(ICDS(80.1,DA)) S GMS(IX,GMA)=$E(ICDS(80.1,DA,4),1,45)_U_ICDS(80.1,DA,.01)
	Q
ENP	;Module For History of PTF Procedures
	I $D(GMTSNDM),GMTSNDM>0 S CNTR=GMTSNDM
	E  S CNTR=100
	S T1=GMTSEND,T2=GMTSBEG,GMCZ=0
	S PTF=0
	F  S PTF=$O(^DGPT("B",DFN,PTF)) Q:PTF=""  D ICDP
	I $D(GMP) S O=0 F I=1:1 S O=$O(GMP(O)) Q:O=""  Q:'CNTR  S CNTR=CNTR-1 S O1=0,LN1=1 F I=1:1 S O1=$O(GMP(O,O1)) Q:O1=""  D CKP^GMTSUP Q:$D(GMTSQIT)  S:GMTSNPG LN1=1 W:LN1 GMP(O) W ?21,$P(GMP(O,O1),U),?68,$P(GMP(O,O1),U,2),! S LN1=0
	D KILLADM Q
	Q
ICDP	Q:'$D(^DGPT(PTF,"P"))
	S II=0 F ZI=1:1 S II=$O(^DGPT(PTF,"P",II)) Q:'II  S PRX=^DGPT(PTF,"P",II,0),X=$P(PRX,U,1),IX=9999999-X I X>T2&(X<T1) D REGDT^GMTSU D ICDP1
	Q
ICDP1	;Load Procedure entries into GMP array in inverted sequence
	S GMCZ=2
	S GMP(IX)="Procedure  "_X F GTA=5:1:9 D PXGY
	Q
PXGY	;Procedure Line
	K DIQ
	Q:$P(PRX,U,GTA)=""
	S DIC=80.1,DR="4;.01",DA=$P(PRX,U,GTA),DIQ="ICDP(" D EN^DIQ1
	I $D(ICDP(80.1,DA)) S GMP(IX,GTA)=$E(ICDP(80.1,DA,4),1,45)_U_ICDP(80.1,DA,.01)
	Q
KILLADM	;Kills Admission variables
	K CNTR,GMCZ,LN1,IX,X,ZA,N,ICD,ICD0,PTF,GMC,O,O1,GMS,T1,T2,SURG,SURGY,PRX,PRXY,DATE,D1,I,IMT,GMA,GTA,II,ZI,GMP
	K ICDP,ICDS
	Q

GMTSDS
GMTSDS	;SLC/JER - Discharge Summary Component driver ;5/14/93  14:25
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Control branching
	N GMTSI,GMTSJ,GMTSCNT,GMTSREC
	K ^TMP("GMRD",$J)
	I '$D(^GMR(128,"APT",DFN)) Q
	D MAIN^GMRDXTRT(DFN,GMTS1,GMTS2,GMTSNDM,1)
	I '$D(^TMP("GMRD",$J)) Q
	S GMTSI=0
	F  S GMTSI=$O(^TMP("GMRD",$J,GMTSI)) Q:+GMTSI'>0  D
	. S GMTSJ=0 F  S GMTSJ=$O(^TMP("GMRD",$J,GMTSI,GMTSJ)) Q:+GMTSJ'>0  D
	. . S GMTSREC=$G(^TMP("GMRD",$J,GMTSI,GMTSJ)) D WRTREC(GMTSREC)
	. . D WRTTEXT
	Q
WRTREC(RECORD)	; Writes record header
	N ADMIT,DISCHG,AUTHOR,ATTNDNG,TSPEC,STATUS
	S GMTSCNT=+$G(GMTSCNT)+1
	S ADMIT=$P(RECORD,U),DISCHG=$P(RECORD,U,2),AUTHOR=$P(RECORD,U,3)
	S:+DISCHG'>0 DISCHG="Present"
	S ATTNDNG=$P(RECORD,U,4),TSPEC=$P(RECORD,U,5),STATUS=$P(RECORD,U,6)
	I GMTSCNT>1 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ADMIT,?10,"-",?12,DISCHG,?52,"Status: ",STATUS,!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,"Last Tr Specialty: ",TSPEC,?49,"Dict'd By: ",AUTHOR,!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?47,"Approved By: ",ATTNDNG,!
	Q
WRTTEXT	; Write Discharge Summary text
	N GMTSK S GMTSK=0
	F  S GMTSK=$O(^TMP("GMRD",$J,GMTSI,GMTSJ,"TEXT",GMTSK)) Q:+GMTSK'>0  D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W $G(^TMP("GMRD",$J,GMTSI,GMTSJ,"TEXT",GMTSK,0)),!
	Q

GMTSDSB
GMTSDSB	;SLC/JER - Brief Discharge Summary Component driver ;5/14/93  14:25
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Control branching
	N GMTSI,GMTSJ,GMTSREC
	K ^TMP("GMRD",$J)
	I '$D(^GMR(128,"APT",DFN)) Q
	D MAIN^GMRDXTRT(DFN,GMTS1,GMTS2,GMTSNDM,0)
	I '$D(^TMP("GMRD",$J)) Q
	D WRTHDR
	S GMTSI=0
	F  S GMTSI=$O(^TMP("GMRD",$J,GMTSI)) Q:+GMTSI'>0  D
	. S GMTSJ=0 F  S GMTSJ=$O(^TMP("GMRD",$J,GMTSI,GMTSJ)) Q:+GMTSJ'>0  D
	. . S GMTSREC=$G(^TMP("GMRD",$J,GMTSI,GMTSJ)) D WRTREC(GMTSREC)
	Q
WRTHDR	; Writes Header for new pages
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Admitted",?11,"Disch'd",?21,"Dictated By",?36,"Approved By",?51,"Cosigned",?61,"Status",!!
	Q
WRTREC(RECORD)	; Writes record header
	N ADMIT,DISCHG,AUTHOR,ATTNDNG,COSIG,TSPEC,STATUS
	S ADMIT=$P(RECORD,U),DISCHG=$P(RECORD,U,2),AUTHOR=$E($P(RECORD,U,3),1,13)
	S:+DISCHG'>0 DISCHG="Present"
	S ATTNDNG=$E($P(RECORD,U,4),1,13)
	S TSPEC=$P(RECORD,U,5),STATUS=$P(RECORD,U,6)
	S COSIG=$P(RECORD,U,7)
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR W ADMIT,?11,DISCHG,?21,AUTHOR,?36,ATTNDNG,?51,COSIG,?61,STATUS,!
	Q

GMTSDVR
GMTSDVR	;SLC/JER - Health Summary Driver ;6/7/93  12:09 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Control branching
	N C,I,GMTYP,VADM,VAROOT,ZTRTN,GMPSAP
	K DIROUT,DUOUT
	K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP")
	F  D  Q:$D(DUOUT)!$D(DIROUT)!($D(GMTYP)'>9)
	. D SELTYP Q:$D(DUOUT)!$D(DIROUT)!($D(GMTYP)'>9)
	. N GMPAT,GMP
	. F  Q:$D(DIROUT)  D  Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)
	. . K GMP,GMPAT
	. . F  Q:$D(DIROUT)  K ^XUTL("OR",$J,"ORLP"),GMP D PATIENT^ORU1(.GMP),PATCOPY(.GMP,.GMPAT) Q:$S($D(DUOUT):1,$D(DIROUT):1,'+$G(GMP):1,1:0)  D
	. . . W !!,"Another patient(s) can be selected."
	. . Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)
	. . N GMTSPX1,GMTSPX2
	. . I +$G(GMRANGE)>0 D GETRANGE^GMTSU(.GMTSPX2,.GMTSPX1) Q:$G(GMTSPX1)=""!($G(GMTSPX2)="")
	. . Q:$D(DUOUT)!$D(DIROUT)
	. . D RESUB(.GMPAT)
	. . S GMPSAP=$$RXAP^GMTSPD2 Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)
	. . S ZTRTN="PQ^GMTSDVR"
	. . D HSOUT
	K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP")
	Q
PATCOPY(GMP,GMPAT)	;Copies patients retrieved from ^ORU1 in GMP array
	;                to GMPAT array
	N IFN,GMDFN
	S IFN=0
	; GMPAT(NAME,GMDFN) - want array in alphabetic order by patient
	F  S IFN=$O(GMP(IFN)) Q:IFN'>0  D
	. S GMDFN=+$G(GMP(IFN))
	. ; Getting name from ^DPT because name returned from ^ORUS sometimes
	. ; has trailing spaces which could allow duplicate recs for a patient
	. S GMPAT($P($G(^DPT(GMDFN,0)),U),+GMDFN)=+GMDFN
	Q
RESUB(GMP)	;Subscripts in GMP array are convert to one numeric subscript.
	;        Done inorder to have GMP array in alphabetic order by patient.
	N NAME,GMDFN,CNT
	S CNT=0,NAME=""
	F  S NAME=$O(GMP(NAME)) Q:NAME']""  D
	. S GMDFN=0
	. F  S GMDFN=$O(GMP(NAME,GMDFN)) Q:GMDFN'>0  D
	. . S CNT=CNT+1
	. . S GMP(CNT)=GMP(NAME,GMDFN)
	. . K GMP(NAME,GMDFN)
	Q
ENXQ	; External call for tasked HS print
	; Input: GMTSTYP=Record # of HS type in file 142
	;            DFN=Record # of patient in file 2
	;        GMTSPX1=Optional internal FM date for range ending date
	;        GMTSPX2=Optional internal FM date for range beginning date
	;  NOTE: Optional date range variables are both required if a date range
	;        is desired.
	; To call from TaskMan:
	;        S ZTRTN="ENXQ^GMTSDVR",ZTSAVE("GMTSTYP")="",ZTSAVE("DFN")=""
	;        D ^%ZTLOAD
	D ENX(DFN,GMTSTYP,$G(GMTSPX2),$G(GMTSPX1))
	Q
ENX(DFN,GMTSTYP,GMTSPX2,GMTSPX1)	; External call to print a Health Summary
	; call with: GMTSTYP=HEALTH SUMMARY TYPE file record number
	;                DFN=PATIENT file record number
	;
	;            GMTSPX1=Optional internal FM date for range ending date
	;            GMTSPX2=Optional internal FM date for range beginning date
	;  NOTE: Optional date range variables are both required if a date range
	;        is desired.
	N DI,DX,DY,GMQUIT,GMTYP,GMPAT,VADM,VAIN,VAROOT
	F  Q:($D(^GMT(142,+GMTSTYP,1))>9)&$D(^DPT(DFN))!+$G(GMQUIT)  D
	. I $D(^GMT(142,+GMTSTYP,1))'>9 D
	. . I $D(ZTQUEUED) S GMQUIT=1 Q
	. . W !?3,"Invalid HEALTH SUMMARY TYPE." D SELTYP S GMTSTYP=+$G(GMTYP(1))
	. I '$D(^DPT(DFN)) D
	. . I $D(ZTQUEUED) S GMQUIT=1 Q
	. . W !?3,"Invalid PATIENT ID." D PATIENT^ORU1(.GMPAT) S DFN=+$G(GMPAT(1))
	Q:+$G(GMQUIT)
	S:$D(GMTYP)'>9 GMTYP(0)=1,GMTYP(1)=+$G(GMTSTYP)_U_$P($G(^GMT(142,+GMTSTYP,0)),U)
	S:$D(GMPAT)'>9 GMPAT=1,GMPAT(0)=1,GMPAT(1)=DFN_U_$P($G(^DPT(DFN,0)),U)
	D PQ
	Q
SELTYP	; Select Health Summary Type(s)
	N DIC,X,Y
	S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEMQZ"
	S DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION"""
	I $D(GMTYP)<10 S DIC("B")=$S($D(^DISV(DUZ,"^GMT(142,"))=10:$G(^DISV(DUZ,"^GMT(142,",$O(^("^GMT(142,",0)))),1:$P($G(^GMT(142,+$G(^DISV(DUZ,"^GMT(142,")),0)),U))
	K GMTYP D ^DIC Q:+Y'>0
	I $S($D(^GMT(142,+Y,1,0))=0:1,$O(^(0))'>0:1,1:0) W !,"The Summary Type "_$P(Y,U,2)_" includes no components...Please choose another",! Q
	S GMTYP(0)=1,GMTYP(1)=Y_U_$P(Y,U,2)_U_$P(Y,U,2)_U_$P(Y,U,2)
	Q
PQ	; Queued subroutine for HS by patient
	N DFN,GMTI,GMTS,GMTS1,GMTS2,GMTSAGE,GMTSDOB,GMTSDTM,GMTSLO,GMTSLPG,GMTSPNM
	N GMTSRB,GMTSSN,GMTSTOF,GMTSTYP,GMTSTITL,GMTSWARD,GMTJ,I,IX0,J,M4,P17,SEX
	N TRFAC,VAERR,VAIN
	S GMTI=0 F  S GMTI=$O(GMTYP(GMTI)) Q:GMTI'>0!$D(DIROUT)  D
	.N GMTSEG,GMTSEGC,GMTSEGI
	.S GMTSTYP=+$G(GMTYP(GMTI)),GMTSTITL=$G(^GMT(142,+GMTSTYP,"T"))
	.S:'$L(GMTSTITL) GMTSTITL=$P(GMTYP(GMTI),U,2)
	.D LOADSEG
	.S GMTJ=0 F  S GMTJ=$O(GMPAT(GMTJ)) Q:GMTJ'>0!$D(DIROUT)  D
	. . S DFN=+$G(GMPAT(GMTJ))
	. . N GMDUOUT
	. . D EN^GMTS1
	. . Q:$D(DIROUT)!+$G(GMDUOUT)
	. . D ACTPROF^GMTSDVR(DFN)
	Q
LOADSEG	;LOAD ENABLED COMPONENTS INTO GMTSEG ARRAY
	N GMTI,GMTJ,GMX
	S (GMTI,GMTJ)=0 F  S GMTJ=$O(^GMT(142,GMTSTYP,1,GMTJ)) Q:GMTJ'>0  S GMX=^(GMTJ,0) D
	.S GMTI=GMTI+1,GMTSEG(GMTI)=GMX,GMTSEGI($P(GMX,U,2))=GMTI D SELFILE
	S GMTSEGC=GMTI
	Q
SELFILE	; Get Selection item information for GMTSEG(
	N GMTK,ITEM
	S GMTK=0
	F  S GMTK=$O(^GMT(142,GMTSTYP,1,GMTJ,1,GMTK)) Q:GMTK'>0  S ITEM=^(GMTK,0),GMTSEG(GMTI,+$P(@(U_$P(ITEM,";",2)_"0)"),U,2),GMTK)=$P(ITEM,";") I GMTK=1 S GMTSEG(GMTI,+$P(@(U_$P(ITEM,";",2)_"0)"),U,2),0)=U_$P(ITEM,";",2)
	Q
HSOUT	; Output summary, with device control
	; Call with: ZTRTN
	I $D(^XUSEC("GMTS VIEW ONLY",DUZ)) D @ZTRTN Q
	N %ZIS,IOP
	S %ZIS="PQ" D ^%ZIS Q:POP
	G:$D(IO("Q")) QUE
NOQUE	D @ZTRTN
	D ^%ZISC
	Q
QUE	; Queue output
	N %,ZTDESC,ZTDTH,ZTIO,ZTSAVE,ZTSK
	Q:'$D(ZTRTN)  K IO("Q"),ZTSAVE F %="DFN","GM*","ENTRY","O*" S ZTSAVE(%)=""
	S ZTDESC="HEALTH SUMMARY",ZTIO=ION
	D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!")
	K ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE D ^%ZISC
	S IOP="HOME" D ^%ZIS
	Q
ACTPROF(DFN)	; Check & print Action Profile for patient if +$G(GMPSAP)
	I +$G(GMPSAP) D
	. S (PSTYPE,PSONOPG)=1
	. S $P(PSOPAR,U)=$S($P($G(^GMT(142.99,1,0)),U,5)="Y":1,1:0)
	. S PSOINST=$S(+$G(PSOINST):PSOINST,1:+$P($G(^DIC(4,+$P($G(^XMB(1,1,"XUS")),U,17),99)),U))
	. D DFN^PSOSD1,PAGE^GMTSPL

GMTSENV
GMTSENV	;SLC/JER - Environment check routine for HS ;11/16/92  15:28
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching
	I $S('+$G(DUZ):1,$G(DUZ(0))'="@":1,'$D(U):1,1:0) D
	. W !,$C(7),$C(7),$C(7),"Environment is not appropriately initialized...",!
	. W "Please D ^XUP and be sure that DUZ(0)=""@"" before continuing.",!
	. K DIFQ
	Q

GMTSFH
GMTSFH	;SLC/JER,MKB - Dietetics Component ;2/12/91  13:32
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching and execution
	N GMI
	I '$D(^FHPT(DFN)) Q
	I '$D(GMTSNDM) S GMTSNDM=999
	I $D(GMTSNDM),GMTSNDM<0 S GMTSNDM=999
	D ^FHWHEA I '$D(^UTILITY($J)) Q
	F GMI="DI","NS","SF","TF","EN" D @GMI
	K ^UTILITY($J),STR,COL,TX,STRT,STP,CNTR
	Q
DI	; Diet Orders
	S CNTR=GMTSNDM
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "DIETS:",!
	I '$D(^UTILITY($J,"DI")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "No diet orders available.",! Q
	N GMW,GMIDT
	S GMIDT=GMTS1 F  S GMIDT=$O(^UTILITY($J,"DI",GMIDT)) Q:(GMIDT'>0)!(GMIDT>GMTS2)  D DIWRT
	Q
DIWRT	; Writes Diet Orders
	S CNTR=CNTR-1 I CNTR<0 Q
	N GMZ S GMZ=^UTILITY($J,"DI",GMIDT,0)
	S X=+$P(GMZ,U) D REGDT^GMTSU S STRT=X
	I $P(GMZ,U,2)="" S STP="Present"
	E  S X=+$P(GMZ,U,2) D REGDT^GMTSU S STP=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W STRT_" - "_STP,?21
	S STR=$S($P(GMZ,U,3)'="":$P(GMZ,U,3),1:"No diet orders on file.")
	I $L(STR)<40 W STR
	E  S COL=27 D WRAP
	W:$P(GMZ,U,5)'="" ?61,"("_$P(GMZ,U,5)_")" W !
	I $P(GMZ,U,4)'="" D DICOM
	Q
DICOM	; Writes comments for DI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "           Comments: "
	I $L($P(GMZ,U,4))<55 W $P(GMZ,U,4),!
	E  S STR=$P(GMZ,U,4),COL=45 D WRAP W !
	Q
NS	; Nutritional status
	I '$D(^UTILITY($J,"NS")) Q
	S CNTR=GMTSNDM
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"NUTRITIONAL STATUS:",!
	N GMW,GMIDT
	S GMIDT=GMTS1 F  S GMIDT=$O(^UTILITY($J,"NS",GMIDT)) Q:(GMIDT'>0)!(GMIDT>GMTS2)  D NSWRT
	Q
NSWRT	; Writes Nutritional Status
	S CNTR=CNTR-1 I CNTR<0 Q
	N GMZ S GMZ=^UTILITY($J,"NS",GMIDT,0)
	S X=+$P(GMZ,U) D REGDTM^GMTSU S STRT=X
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W STRT,?21,$S($P(GMZ,U,2)'="":$P(GMZ,U,2),1:"No status on file."),!
	Q
SF	; Supplemental feeding
	I '$D(^UTILITY($J,"SF")) Q
	S CNTR=GMTSNDM
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"SUPPLEMENTAL FEEDINGS:",!
	N GMW,GMIDT
	S GMIDT=GMTS1 F  S GMIDT=$O(^UTILITY($J,"SF",GMIDT)) Q:(GMIDT'>0)!(GMIDT>GMTS2)  D SFWRT
	Q
SFWRT	; Writes Supplemental Feedings
	S CNTR=CNTR-1 I CNTR<0 Q
	N GMZ S GMZ=^UTILITY($J,"SF",GMIDT,0)
	S X=+$P(GMZ,U) D REGDT^GMTSU S STRT=X
	I $P(GMZ,U,2)="" S STP="Present"
	E  S X=+$P(GMZ,U,2) D REGDT^GMTSU S STP=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W STRT_" - "_STP,!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?14,"10 Am  " S STR=$S($P(GMZ,U,3)'="":$P(GMZ,U,3),1:"No order")
	I $L(STR)<55 W STR,!
	E  S COL=45 D WRAP W !
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?14," 2 Pm  " S STR=$S($P(GMZ,U,4)'="":$P(GMZ,U,4),1:"No order")
	I $L(STR)<55 W STR,!
	E  S COL=45 D WRAP W !
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?14," 8 Pm  " S STR=$S($P(GMZ,U,5)'="":$P(GMZ,U,5),1:"No order")
	I $L(STR)<55 W STR,!
	E  S COL=45 D WRAP W !
	Q
TF	; Tubefeeding
	I '$D(^UTILITY($J,"TF")) Q
	S CNTR=GMTSNDM
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"TUBE FEEDINGS:",!
	N GMW,GMIDT
	S GMIDT=GMTS1 F  S GMIDT=$O(^UTILITY($J,"TF",GMIDT)) Q:(GMIDT'>0)!(GMIDT>GMTS2)  D TFWRT
	Q
TFWRT	; Writes tubefeeding
	S CNTR=CNTR-1 I CNTR<0 Q
	N GMZ S GMZ=^UTILITY($J,"TF",GMIDT,0)
	S X=+$P(GMZ,U) D REGDT^GMTSU S STRT=X
	I $P(GMZ,U,2)="" S STP="Present"
	E  S X=+$P(GMZ,U,2) D REGDT^GMTSU S STP=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W STRT_" - "_STP,!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,"Product: ",$P(GMZ,U,3),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?11,"Strength: ",$P(GMZ,U,4),?51,"Quantity: ",$P(GMZ,U,5),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Daily CC's: ",$P(GMZ,U,6),?47,"Daily KCal's: ",$P(GMZ,U,7),!
	I $P(GMZ,U,8)'="" D TFCOM
	Q
TFCOM	; Writes comments for TF
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?11,"Comments: "
	I $L($P(GMZ,U,8))<55 W $P(GMZ,U,8),!
	E  S STR=$P(GMZ,U,8),COL=45 D WRAP W !
	Q
WRAP	; Controls wrap-around feature for comments, etc.
	S TX=$F(STR," ",COL) W $E(STR,1,TX-1),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,$E(STR,TX,$L(STR))
	Q
EN	; Dietetic Encounters
	S CNTR=GMTSNDM
	Q:'$D(^UTILITY($J,"EN"))
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"DIETETIC ENCOUNTERS:",!
	N GMW,GMIDT
	S GMIDT=GMTS1
	F  S GMIDT=$O(^UTILITY($J,"EN",GMIDT)) Q:(GMIDT'>0)!(GMIDT>GMTS2)  D
	. S CNTR=CNTR-1 I CNTR<0 Q
	. N GMZ
	. S GMZ=^UTILITY($J,"EN",GMIDT,0)
	. S X=+$P(GMZ,U) D REGDT^GMTSU S STRT=X
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W STRT,?9,$P(GMZ,U,2),!
	. I $P(GMZ,U,3)]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?6,$P(GMZ,U,3),!
	. I $P(GMZ,U,4)]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?6,$P(GMZ,U,4),!
	Q

GMTSI001
GMTSI001	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(142,0,"GL")
	;;=^GMT(142,
	;;^DIC("B","HEALTH SUMMARY TYPE",142)
	;;=
	;;^DIC(142,"%D",0)
	;;=^^11^11^2951005^^^^
	;;^DIC(142,"%D",1,0)
	;;=This file contains the structure of a Health Summary.  Components from the
	;;^DIC(142,"%D",2,0)
	;;=Health Summary Components file (142.1) may be selected and restricted by
	;;^DIC(142,"%D",3,0)
	;;=number of occurrences or time limits. The original creator of a type of 
	;;^DIC(142,"%D",4,0)
	;;=Health Summary is the owner of that type.  Health Summaries that are
	;;^DIC(142,"%D",5,0)
	;;="owned" may not be modified or deleted by anyone else, except the Clinical
	;;^DIC(142,"%D",6,0)
	;;=Coordinator.  "Owned" Health Summaries may be used by other users to
	;;^DIC(142,"%D",7,0)
	;;=print patient information.  
	;;^DIC(142,"%D",8,0)
	;;=  
	;;^DIC(142,"%D",9,0)
	;;=The GMTSMGR security key is included on generic Health Summaries sent out 
	;;^DIC(142,"%D",10,0)
	;;=with the Health Summary Package.  These types of Health Summaries should 
	;;^DIC(142,"%D",11,0)
	;;=not be deleted.
	;;^DD(142,0)
	;;=FIELD^^99^9
	;;^DD(142,0,"DDA")
	;;=N
	;;^DD(142,0,"DT")
	;;=2950119
	;;^DD(142,0,"IX","AE",142.01,1)
	;;=
	;;^DD(142,0,"IX","AM",142,99)
	;;=
	;;^DD(142,0,"IX","B",142,.01)
	;;=
	;;^DD(142,0,"IX","C",142,.06)
	;;=
	;;^DD(142,0,"IX","D",142.2,.01)
	;;=
	;;^DD(142,0,"IX","E",142,.02)
	;;=
	;;^DD(142,0,"NM","HEALTH SUMMARY TYPE")
	;;=
	;;^DD(142,0,"PT",43,43)
	;;=
	;;^DD(142,0,"PT",357.6,.11)
	;;=
	;;^DD(142,0,"PT",358.6,.11)
	;;=
	;;^DD(142,.01,0)
	;;=NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
	;;^DD(142,.01,1,0)
	;;=^.1
	;;^DD(142,.01,1,1,0)
	;;=142^B
	;;^DD(142,.01,1,1,1)
	;;=S ^GMT(142,"B",$E(X,1,30),DA)=""
	;;^DD(142,.01,1,1,2)
	;;=K ^GMT(142,"B",$E(X,1,30),DA)
	;;^DD(142,.01,1,1,"%D",0)
	;;=^^2^2^2950731^^
	;;^DD(142,.01,1,1,"%D",1,0)
	;;=This REGULAR "B" cross-reference is used for Health Summary Type look-up
	;;^DD(142,.01,1,1,"%D",2,0)
	;;=by name.
	;;^DD(142,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(142,.01,21,0)
	;;=^^7^7^2950728^^^^
	;;^DD(142,.01,21,1,0)
	;;=Enter the NAME of the Health Summary Type.  This name will appear
	;;^DD(142,.01,21,2,0)
	;;=in the health summary header.  The word "CONFIDENTIAL" will appear
	;;^DD(142,.01,21,3,0)
	;;=in front of this name and the word "SUMMARY" will appear at the end
	;;^DD(142,.01,21,4,0)
	;;=to complete the header.  For example:
	;;^DD(142,.01,21,5,0)
	;;= 
	;;^DD(142,.01,21,6,0)
	;;=    Name entered: ICU
	;;^DD(142,.01,21,7,0)
	;;=Generated header: CONFIDENTIAL ICU SUMMARY
	;;^DD(142,.01,"DEL",1,0)
	;;=I $P(^GMT(142,DA,0),U,4)="Y" W $C(7),!,"CANNOT DELETE THIS HEALTH SUMMARY TYPE!!  IT IS USED BY THE AD HOC OPTION"
	;;^DD(142,.01,"DT")
	;;=2901016
	;;^DD(142,.02,0)
	;;=TITLE^F^^T;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
	;;^DD(142,.02,1,0)
	;;=^.1
	;;^DD(142,.02,1,1,0)
	;;=142^E
	;;^DD(142,.02,1,1,1)
	;;=S ^GMT(142,"E",$E(X,1,30),DA)=""
	;;^DD(142,.02,1,1,2)
	;;=K ^GMT(142,"E",$E(X,1,30),DA)
	;;^DD(142,.02,1,1,"%D",0)
	;;=^^2^2^2920227^
	;;^DD(142,.02,1,1,"%D",1,0)
	;;=This whole-file, regular FileMan cross-reference is used for look-ups
	;;^DD(142,.02,1,1,"%D",2,0)
	;;=of Health Summary Types by TITLE.
	;;^DD(142,.02,3)
	;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
	;;^DD(142,.02,21,0)
	;;=5^^7^7^2920928^^^^
	;;^DD(142,.02,21,1,0)
	;;=Enter the TITLE only if you wish to replace NAME with title in the health
	;;^DD(142,.02,21,2,0)
	;;=summary header.  For Example:
	;;^DD(142,.02,21,3,0)
	;;= 
	;;^DD(142,.02,21,4,0)
	;;=    Name entered: ICU
	;;^DD(142,.02,21,5,0)
	;;=   Title entered: INTENSIVE CARE UNIT

GMTSI002
GMTSI002	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142,.02,21,6,0)
	;;=Generated header: CONFIDENTIAL INTENSIVE CARE UNIT SUMMARY
	;;^DD(142,.02,21,7,0)
	;;= 
	;;^DD(142,.02,"DT")
	;;=2900413
	;;^DD(142,.05,0)
	;;=LOCK^FX^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<1) X I $D(X) Q:$D(^DIC(19.1,"B",X))  W !,$C(7),"Lock name must match exactly with a key in the SECURITY KEY file." K X
	;;^DD(142,.05,3)
	;;=Enter the name of the security key required to modify this summary type
	;;^DD(142,.05,21,0)
	;;=^^9^9^2950731^^^^
	;;^DD(142,.05,21,1,0)
	;;=When a Health Summary Type contains a Lock, edit access is normally
	;;^DD(142,.05,21,2,0)
	;;=restricted to persons who hold a security key in the SECURITY KEY
	;;^DD(142,.05,21,3,0)
	;;=file which is the same as the Lock value. If a Health Summary Type
	;;^DD(142,.05,21,4,0)
	;;=contains a Lock, users who hold that security key are NOT restricted
	;;^DD(142,.05,21,5,0)
	;;=by Ownership. A holder of the GMTSMGR security key is NOT restricted
	;;^DD(142,.05,21,6,0)
	;;=by Locks or Ownership.
	;;^DD(142,.05,21,7,0)
	;;= 
	;;^DD(142,.05,21,8,0)
	;;=NOTE: Generic Health Summary Types issued with the Health Summary
	;;^DD(142,.05,21,9,0)
	;;=package contain the Lock GMTSMGR.
	;;^DD(142,.05,"DT")
	;;=2950731
	;;^DD(142,.06,0)
	;;=OWNER^P200'^VA(200,^0;3^Q
	;;^DD(142,.06,1,0)
	;;=^.1
	;;^DD(142,.06,1,1,0)
	;;=142^C
	;;^DD(142,.06,1,1,1)
	;;=S ^GMT(142,"C",$E(X,1,30),DA)=""
	;;^DD(142,.06,1,1,2)
	;;=K ^GMT(142,"C",$E(X,1,30),DA)
	;;^DD(142,.06,1,1,"%D",0)
	;;=^^2^2^2920227^
	;;^DD(142,.06,1,1,"%D",1,0)
	;;=This whole-file, regular FileMan cross-reference is used by the Health
	;;^DD(142,.06,1,1,"%D",2,0)
	;;=Summary Type selection to look-up summary types by OWNER.
	;;^DD(142,.06,21,0)
	;;=15^^14^14^2950728^^
	;;^DD(142,.06,21,1,0)
	;;=Edit access to each health summary type is normally restricted to
	;;^DD(142,.06,21,2,0)
	;;=its Owner.
	;;^DD(142,.06,21,3,0)
	;;= 
	;;^DD(142,.06,21,4,0)
	;;=Exception 1: Holders of the GMTSMGR security key are NOT restricted
	;;^DD(142,.06,21,5,0)
	;;=             by Ownership.
	;;^DD(142,.06,21,6,0)
	;;= 
	;;^DD(142,.06,21,7,0)
	;;=Exception 2: If a health summary type contains a lock, users who hold
	;;^DD(142,.06,21,8,0)
	;;=             that lock key are NOT restricted by Ownership.
	;;^DD(142,.06,21,9,0)
	;;= 
	;;^DD(142,.06,21,10,0)
	;;=NOTE: When a new health summary type is created, the creator's entry
	;;^DD(142,.06,21,11,0)
	;;=number in the new Person File is AUTOMATICALLY entered as Owner unless
	;;^DD(142,.06,21,12,0)
	;;=the creator holds the GMTSMGR security key.  A creator who holds the
	;;^DD(142,.06,21,13,0)
	;;=GMTSMGR key may enter an Owner (IFN from new Person file) of his/her
	;;^DD(142,.06,21,14,0)
	;;=choice.
	;;^DD(142,.06,"DT")
	;;=2900523
	;;^DD(142,.07,0)
	;;=RESTRICT DELETION^SI^Y:YES;^0;4^Q
	;;^DD(142,.07,21,0)
	;;=^^3^3^2920914^
	;;^DD(142,.07,21,1,0)
	;;=This field is referred to by the Create/Modify and Delete Health Summary
	;;^DD(142,.07,21,2,0)
	;;=Type options for the screening of certain summary types (esp., GMTS HS
	;;^DD(142,.07,21,3,0)
	;;=ADHOC OPTION) from deletion.
	;;^DD(142,.07,"DT")
	;;=2901227
	;;^DD(142,.08,0)
	;;=SUPPRESS COMP WITHOUT DATA^S^Y:yes;N:no;^0;5^Q
	;;^DD(142,.08,.1)
	;;=SUPPRESS PRINT OF COMPONENTS WITHOUT DATA
	;;^DD(142,.08,21,0)
	;;=^^6^6^2950731^^
	;;^DD(142,.08,21,1,0)
	;;=This field allows health summary types to be set up to suppress printing
	;;^DD(142,.08,21,2,0)
	;;=of components that contain no data when health summaries are printed from
	;;^DD(142,.08,21,3,0)
	;;=a device. When health summary types are displayed on the screen,

GMTSI003
GMTSI003	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142,.08,21,4,0)
	;;=components that contain no data will still be displayed with a "No data
	;;^DD(142,.08,21,5,0)
	;;=available" message. This is done to eliminate any confusion that may occur
	;;^DD(142,.08,21,6,0)
	;;=when jumping between components.
	;;^DD(142,.08,"DT")
	;;=2950815
	;;^DD(142,1,0)
	;;=STRUCTURE^142.01IA^^1;0
	;;^DD(142,1,21,0)
	;;=^^4^4^2950829^^^^
	;;^DD(142,1,21,1,0)
	;;=This multiple contains the components to be included in any given health
	;;^DD(142,1,21,2,0)
	;;=summary type, along with the time and occurrence limits, selection items
	;;^DD(142,1,21,3,0)
	;;=to be used, hospital location displayed, ICD text displayed, and provider
	;;^DD(142,1,21,4,0)
	;;=narrative displayed.
	;;^DD(142,20,0)
	;;=LOCATION(S) USING THE SUMMARY^142.2P^^20;0
	;;^DD(142,20,21,0)
	;;=^^3^3^2950731^^^^
	;;^DD(142,20,21,1,0)
	;;=Allows the entry of the hospital location (ward or clinic) which has
	;;^DD(142,20,21,2,0)
	;;=requested automatic nightly queueing of one or more health summary
	;;^DD(142,20,21,3,0)
	;;=types to a specified device.
	;;^DD(142,99,0)
	;;=TIMESTAMP^F^^99;1^K:$L(X)>15!($L(X)<1) X
	;;^DD(142,99,1,0)
	;;=^.1
	;;^DD(142,99,1,1,0)
	;;=142^AM^MUMPS
	;;^DD(142,99,1,1,1)
	;;=D SET^GMTSDD
	;;^DD(142,99,1,1,2)
	;;=D KILL^GMTSDD
	;;^DD(142,99,1,1,"%D",0)
	;;=^^5^5^2950731^
	;;^DD(142,99,1,1,"%D",1,0)
	;;=This MUMPS type cross-reference is used to maintain the navigational menus
	;;^DD(142,99,1,1,"%D",2,0)
	;;=when changes occur in the structure of a given Health Summary Type. The
	;;^DD(142,99,1,1,"%D",3,0)
	;;=executed code will rebuild navigational menus when the TIMESTAMP field is
	;;^DD(142,99,1,1,"%D",4,0)
	;;=modified. The ^XUTL("XQORM", global is used by the Unwinder utility to
	;;^DD(142,99,1,1,"%D",5,0)
	;;=generate the ad hoc and navigational menus.
	;;^DD(142,99,3)
	;;=Answer must be 1-15 characters in length.
	;;^DD(142,99,9)
	;;=^
	;;^DD(142,99,21,0)
	;;=^^6^6^2950731^
	;;^DD(142,99,21,1,0)
	;;=This is the $H formatted time associated with the most recent modification
	;;^DD(142,99,21,2,0)
	;;=to this health summary type. It is compared with the timestamp in the
	;;^DD(142,99,21,3,0)
	;;=^XUTL( multiple associated with this summary type, when ^XQORM is called
	;;^DD(142,99,21,4,0)
	;;=to generate help menus for interactive navigation. If a difference exists,
	;;^DD(142,99,21,5,0)
	;;=then the menus are "recompiled." This field is NOT to be edited
	;;^DD(142,99,21,6,0)
	;;=interactively under any circumstances!
	;;^DD(142,99,"DT")
	;;=2900111
	;;^DD(142.01,0)
	;;=STRUCTURE SUB-FIELD^^8^9
	;;^DD(142.01,0,"DT")
	;;=2950119
	;;^DD(142.01,0,"ID",1)
	;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^GMT(142.1,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(142.1,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
	;;^DD(142.01,0,"IX","AM",142.01,.01)
	;;=
	;;^DD(142.01,0,"IX","AM1",142.01,1)
	;;=
	;;^DD(142.01,0,"IX","AM5",142.01,5)
	;;=
	;;^DD(142.01,0,"IX","B",142.01,.01)
	;;=
	;;^DD(142.01,0,"IX","C",142.01,1)
	;;=
	;;^DD(142.01,0,"NM","STRUCTURE")
	;;=
	;;^DD(142.01,0,"UP")
	;;=142
	;;^DD(142.01,.01,0)
	;;=SUMMARY ORDER^MRNJ8,3XO^^0;1^K:+X'=X!(X>9999.999)!(X<.001)!(X'?1.4N.E) X S:$D(X) DINUM=X
	;;^DD(142.01,.01,1,0)
	;;=^.1
	;;^DD(142.01,.01,1,1,0)
	;;=142.01^B
	;;^DD(142.01,.01,1,1,1)
	;;=S ^GMT(142,DA(1),1,"B",$E(X,1,30),DA)=""
	;;^DD(142.01,.01,1,1,2)
	;;=K ^GMT(142,DA(1),1,"B",$E(X,1,30),DA)
	;;^DD(142.01,.01,1,1,"%D",0)
	;;=^^3^3^2920302^^
	;;^DD(142.01,.01,1,1,"%D",1,0)
	;;=This REGULAR "B" cross-reference is created by FileMan and because the

GMTSI004
GMTSI004	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.01,.01,1,1,"%D",2,0)
	;;=multiple is DINUM'ed by SUMMARY ORDER, it serves little useful function
	;;^DD(142.01,.01,1,1,"%D",3,0)
	;;=in either look-up or sorting.
	;;^DD(142.01,.01,1,2,0)
	;;=142.01^AM^MUMPS
	;;^DD(142.01,.01,1,2,1)
	;;=D REDOX^GMTSDD
	;;^DD(142.01,.01,1,2,2)
	;;=D REDOX^GMTSDD
	;;^DD(142.01,.01,1,2,"%D",0)
	;;=^^4^4^2950731^^^^
	;;^DD(142.01,.01,1,2,"%D",1,0)
	;;=This MUMPS-type cross-reference is used to rebuild the ad hoc and
	;;^DD(142.01,.01,1,2,"%D",2,0)
	;;=navigational menus when the sequence of components within any Health
	;;^DD(142.01,.01,1,2,"%D",3,0)
	;;=Summary Type is changed. The ^XUTL("XQORM", global is used by the Unwinder
	;;^DD(142.01,.01,1,2,"%D",4,0)
	;;=utility to generate the ad hoc and navigational menus.
	;;^DD(142.01,.01,2)
	;;=S Y(0)=Y S Y=Y
	;;^DD(142.01,.01,2.1)
	;;=S Y=Y
	;;^DD(142.01,.01,3)
	;;=Type a Number between .001 and 9999.999
	;;^DD(142.01,.01,21,0)
	;;=^^4^4^2950821^^^^
	;;^DD(142.01,.01,21,1,0)
	;;=This is the sequence in which each successive component is to appear
	;;^DD(142.01,.01,21,2,0)
	;;=within the health summary.  By default, it will be an integer number,
	;;^DD(142.01,.01,21,3,0)
	;;=beginning with five, and incremented by five, so as to allow insertion
	;;^DD(142.01,.01,21,4,0)
	;;=of new components as necessary.
	;;^DD(142.01,.01,"DT")
	;;=2900418
	;;^DD(142.01,1,0)
	;;=COMPONENT NAME^RP142.1'^GMT(142.1,^0;2^Q
	;;^DD(142.01,1,1,0)
	;;=^.1
	;;^DD(142.01,1,1,1,0)
	;;=142.01^C
	;;^DD(142.01,1,1,1,1)
	;;=S ^GMT(142,DA(1),1,"C",$E(X,1,30),DA)=""
	;;^DD(142.01,1,1,1,2)
	;;=K ^GMT(142,DA(1),1,"C",$E(X,1,30),DA)
	;;^DD(142.01,1,1,1,"%D",0)
	;;=^^4^4^2920714^^^
	;;^DD(142.01,1,1,1,"%D",1,0)
	;;=This REGULAR FileMan type cross-reference is used both in look-ups of
	;;^DD(142.01,1,1,1,"%D",2,0)
	;;=components and to determine whether the selected component already
	;;^DD(142.01,1,1,1,"%D",3,0)
	;;=exists in the current Health Summary Type during the Create/Modify
	;;^DD(142.01,1,1,1,"%D",4,0)
	;;=process.
	;;^DD(142.01,1,1,2,0)
	;;=142.01^AM1^MUMPS
	;;^DD(142.01,1,1,2,1)
	;;=D REDOX^GMTSDD
	;;^DD(142.01,1,1,2,2)
	;;=D REDOX^GMTSDD
	;;^DD(142.01,1,1,2,"%D",0)
	;;=^^4^4^2950731^
	;;^DD(142.01,1,1,2,"%D",1,0)
	;;=This MUMPS type cross-reference is used to recompile the navigational and
	;;^DD(142.01,1,1,2,"%D",2,0)
	;;=ad hoc menus when components are added to/deleted from a given Health
	;;^DD(142.01,1,1,2,"%D",3,0)
	;;=Summary Type. The ^XUTL("XQORM", global is used by the Unwinder utility to
	;;^DD(142.01,1,1,2,"%D",4,0)
	;;=generate the ad hoc and navigational menus.
	;;^DD(142.01,1,1,3,0)
	;;=142^AE
	;;^DD(142.01,1,1,3,1)
	;;=S ^GMT(142,"AE",$E(X,1,30),DA(1),DA)=""
	;;^DD(142.01,1,1,3,2)
	;;=K ^GMT(142,"AE",$E(X,1,30),DA(1),DA)
	;;^DD(142.01,1,1,3,"%D",0)
	;;=^^4^4^2920302^^
	;;^DD(142.01,1,1,3,"%D",1,0)
	;;=This cross-reference is used by the routine ^GMTSDD to build the navigational
	;;^DD(142.01,1,1,3,"%D",2,0)
	;;=menu for each Health Summary Type, and by ^GMTSLOAD when saving the current
	;;^DD(142.01,1,1,3,"%D",3,0)
	;;=default parameters, prior to deleting and rebuilding the Ad Hoc Health
	;;^DD(142.01,1,1,3,"%D",4,0)
	;;=Summary Type.
	;;^DD(142.01,1,3)
	;;=Enter the name of the segment (e.g., DEMOGRAPHICS)
	;;^DD(142.01,1,21,0)
	;;=^^3^3^2950829^^^
	;;^DD(142.01,1,21,1,0)
	;;=This is the name of the next health summary component to be included in
	;;^DD(142.01,1,21,2,0)
	;;=the report (e.g., SURGERY REPORTS, or CHEMISTRY & HEMATOLOGY).  Valid
	;;^DD(142.01,1,21,3,0)
	;;=abbreviations (e.g., SR or CH) or partial names may also be entered.

GMTSI005
GMTSI005	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.01,1,"DT")
	;;=2900329
	;;^DD(142.01,2,0)
	;;=OCCURRENCE LIMIT^NJ5,0^^0;3^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(142.01,2,3)
	;;=Enter occurrence limit of information to display.  Omit if no limit.  Occurrence limit displays are based on most recent information first. 
	;;^DD(142.01,2,21,0)
	;;=^^6^6^2940418^^
	;;^DD(142.01,2,21,1,0)
	;;=This is an integer number describing the number of occurrences (e.g., lab
	;;^DD(142.01,2,21,2,0)
	;;=orders, surgeries, radiology procedures, etc.) to be reported by the
	;;^DD(142.01,2,21,3,0)
	;;=component.  For example, if 5 is entered the component will only present
	;;^DD(142.01,2,21,4,0)
	;;=the five most recent occurrences.  If no limit is entered, the component
	;;^DD(142.01,2,21,5,0)
	;;=will report as many occurrences as may be found within the specified
	;;^DD(142.01,2,21,6,0)
	;;=time interval.
	;;^DD(142.01,3,0)
	;;=TIME LIMIT^FX^^0;4^S X=$$UP^XLFSTR(X) K:$L(X)>5!($L(X)<1)!'((X?1N.N1U)!(X?1N.N1"D")!(X?1N.N1"W")!(X?1N.N1"M")!(X?1N.N1"Y")) X
	;;^DD(142.01,3,3)
	;;=Enter time limit to display (e.g., 20D, 8W, 3M, 5Y).  Omit if no limit. Time limit displays are based on most recent information first.
	;;^DD(142.01,3,21,0)
	;;=^^8^8^2940914^
	;;^DD(142.01,3,21,1,0)
	;;=This is a code describing how far back the component should search for a
	;;^DD(142.01,3,21,2,0)
	;;=given patient's data.  It will be a number, followed by the letter D for
	;;^DD(142.01,3,21,3,0)
	;;=days, W for weeks, M for months or Y for years (e.g., 30D would denote the
	;;^DD(142.01,3,21,4,0)
	;;=past 30 days' patient data should be included in the component).  If no
	;;^DD(142.01,3,21,5,0)
	;;=limit is indicated, the component assumes an indefinite time interval.
	;;^DD(142.01,3,21,6,0)
	;;=Exceptions are the Outpatient, Unit Dose and Intravenous Pharmacy
	;;^DD(142.01,3,21,7,0)
	;;=components, which will show active orders only when no time limit is
	;;^DD(142.01,3,21,8,0)
	;;=entered.
	;;^DD(142.01,3,"DT")
	;;=2950823
	;;^DD(142.01,4,0)
	;;=SELECTION ITEM^142.14AV^^1;0
	;;^DD(142.01,4,21,0)
	;;=^^7^7^2950829^^
	;;^DD(142.01,4,21,1,0)
	;;=If the component allows selection of specific items, they will be selected
	;;^DD(142.01,4,21,2,0)
	;;=here.  Component examples are Lab Tests Selected, Lab Cumulative's
	;;^DD(142.01,4,21,3,0)
	;;=Selected, Radiology Impressions Selected, and Vital Signs Selected.
	;;^DD(142.01,4,21,4,0)
	;;= 
	;;^DD(142.01,4,21,5,0)
	;;=You will be asked to enter selection items such as Lab Tests, Radiology
	;;^DD(142.01,4,21,6,0)
	;;=Procedures, Vital Sign Types, Measurement Panel, Clinical
	;;^DD(142.01,4,21,7,0)
	;;=Reminder/Maintenance, Health Factor, depending on the component.
	;;^DD(142.01,4,22)
	;;=
	;;^DD(142.01,5,0)
	;;=HEADER NAME^F^^0;5^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<2) X
	;;^DD(142.01,5,1,0)
	;;=^.1
	;;^DD(142.01,5,1,1,0)
	;;=142.01^AM5^MUMPS
	;;^DD(142.01,5,1,1,1)
	;;=D REDOX^GMTSDD
	;;^DD(142.01,5,1,1,2)
	;;=D REDOX^GMTSDD
	;;^DD(142.01,5,1,1,"%D",0)
	;;=^^3^3^2950731^
	;;^DD(142.01,5,1,1,"%D",1,0)
	;;=This MUMPS type cross reference will recompile the AD HOC menu when an
	;;^DD(142.01,5,1,1,"%D",2,0)
	;;=entry is modified. The ^XUTL("XQORM", global is used by the Unwinder
	;;^DD(142.01,5,1,1,"%D",3,0)
	;;=utility to generate the ad hoc menu.
	;;^DD(142.01,5,1,1,"DT")
	;;=2911212
	;;^DD(142.01,5,3)
	;;=Answer must be 2-20 characters in length.
	;;^DD(142.01,5,21,0)
	;;=^^4^4^2911127^^^^
	;;^DD(142.01,5,21,1,0)
	;;=This is the name that will appear in both menus and headers within this

GMTSI006
GMTSI006	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.01,5,21,2,0)
	;;=Health Summary type.  (e.g., if you are setting up the LAB SELECTED
	;;^DD(142.01,5,21,3,0)
	;;=CUMULATIVE component, and would like it to include the tests from a Chem 7,
	;;^DD(142.01,5,21,4,0)
	;;=you might enter Chem 7).
	;;^DD(142.01,5,"DT")
	;;=2911212
	;;^DD(142.01,6,0)
	;;=HOSPITAL LOCATION DISPLAYED^S^Y:yes;N:no;^0;6^Q
	;;^DD(142.01,6,3)
	;;=Enter Yes if Hospital Location abbreviation should appear in this component.
	;;^DD(142.01,6,21,0)
	;;=^^4^4^2950728^^^
	;;^DD(142.01,6,21,1,0)
	;;=This field controls whether or not the hospital location abbreviation will
	;;^DD(142.01,6,21,2,0)
	;;=be displayed in any components where hospital location applies (e.g., PCE
	;;^DD(142.01,6,21,3,0)
	;;=Outpatient Encounters, PCE Outpatient Diagnosis). The text displayed is
	;;^DD(142.01,6,21,4,0)
	;;=obtained from the Hospital Location file.
	;;^DD(142.01,6,"DT")
	;;=2940418
	;;^DD(142.01,7,0)
	;;=ICD TEXT DISPLAYED^S^L:long text;S:short text;C:code only;T:text only;N:none;^0;7^Q
	;;^DD(142.01,7,3)
	;;=Indicate whether the long form, short form, code only, text only, or no form of ICD diagnosis text should appear in applicable components.
	;;^DD(142.01,7,21,0)
	;;=^^7^7^2950728^
	;;^DD(142.01,7,21,1,0)
	;;=This field controls hows ICD text is displayed in components where ICD
	;;^DD(142.01,7,21,2,0)
	;;=Text applies (e.g., PCE Outpatient Encounters, PCE Outpatient Diagnosis
	;;^DD(142.01,7,21,3,0)
	;;=and Problem List All). The applicable component display/print can be
	;;^DD(142.01,7,21,4,0)
	;;=customized to include ICD Text in the following format: code and long
	;;^DD(142.01,7,21,5,0)
	;;=description, code and short description, code only, long description only
	;;^DD(142.01,7,21,6,0)
	;;=or nothing. This control is independent of whether provider narrative is
	;;^DD(142.01,7,21,7,0)
	;;=displayed -- either or both may be specified.
	;;^DD(142.01,7,"DT")
	;;=2950119
	;;^DD(142.01,8,0)
	;;=PROVIDER NARRATIVE DISPLAYED^S^Y:yes;N:no;^0;8^Q
	;;^DD(142.01,8,3)
	;;=Enter 'N' to eliminate the provider narrative from component display.
	;;^DD(142.01,8,21,0)
	;;=^^6^6^2950728^
	;;^DD(142.01,8,21,1,0)
	;;=This field controls whether provider narrative is displayed or not. It
	;;^DD(142.01,8,21,2,0)
	;;=applies to components where provider narrative is applicable (e.g., PCE
	;;^DD(142.01,8,21,3,0)
	;;=Outpatient Encounters, PCE Outpatient Diagnosis, Problem List All). This
	;;^DD(142.01,8,21,4,0)
	;;=control is independent of whether or not ICD text is displayed -- either
	;;^DD(142.01,8,21,5,0)
	;;=or both may be specified. If not specified, provider narrative will be
	;;^DD(142.01,8,21,6,0)
	;;=displayed by default.
	;;^DD(142.01,8,"DT")
	;;=2940419
	;;^DD(142.14,0)
	;;=SELECTION ITEM SUB-FIELD^^.01^1
	;;^DD(142.14,0,"DT")
	;;=2920928
	;;^DD(142.14,0,"IX","B",142.14,.01)
	;;=
	;;^DD(142.14,0,"NM","SELECTION ITEM")
	;;=
	;;^DD(142.14,0,"UP")
	;;=142.01
	;;^DD(142.14,.01,0)
	;;=SELECTION ITEM^MV^^0;1^Q
	;;^DD(142.14,.01,1,0)
	;;=^.1
	;;^DD(142.14,.01,1,1,0)
	;;=142.14^B
	;;^DD(142.14,.01,1,1,1)
	;;=S ^GMT(142,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
	;;^DD(142.14,.01,1,1,2)
	;;=K ^GMT(142,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
	;;^DD(142.14,.01,1,1,3)
	;;=Required Index for Variable Pointer
	;;^DD(142.14,.01,1,1,"%D",0)
	;;=^^2^2^2920302^
	;;^DD(142.14,.01,1,1,"%D",1,0)
	;;=This REGULAR FileMan type cross-reference is used in look-ups of selection
	;;^DD(142.14,.01,1,1,"%D",2,0)
	;;=items during the Create/Modify and parameter collection dialogues.
	;;^DD(142.14,.01,3)
	;;=Selection items can only be selected when appropriate for the component.

GMTSI007
GMTSI007	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.14,.01,21,0)
	;;=^^7^7^2950829^^^^
	;;^DD(142.14,.01,21,1,0)
	;;=When a given component allows the selection of specific items, (e.g., lab
	;;^DD(142.14,.01,21,2,0)
	;;=tests, radiology procedures, vital measurements, measurement panels,
	;;^DD(142.14,.01,21,3,0)
	;;=clinical reminders/maintenance items, health factors, etc.), you may
	;;^DD(142.14,.01,21,4,0)
	;;=select the item by simply entering its name (e.g., POTASSIUM, or PULSE, as
	;;^DD(142.14,.01,21,5,0)
	;;=appropriate). If a limit has been specified for the number of items to be
	;;^DD(142.14,.01,21,6,0)
	;;=selected, then the build health summary option will restrict you to that
	;;^DD(142.14,.01,21,7,0)
	;;=number.
	;;^DD(142.14,.01,"DT")
	;;=2920928
	;;^DD(142.14,.01,"V",0)
	;;=^.12P^7^6
	;;^DD(142.14,.01,"V",1,0)
	;;=60^LABORATORY TEST^1^L^y^n
	;;^DD(142.14,.01,"V",1,1)
	;;=S DIC("S")="I ($P(^(0),U,4)=""CH""),(""BO""[$P(^(0),U,3))"
	;;^DD(142.14,.01,"V",1,2)
	;;=Only Chemistry & Hematology tests may be selected.
	;;^DD(142.14,.01,"V",2,0)
	;;=120.51^VITAL TYPE^2^V^n^n
	;;^DD(142.14,.01,"V",3,0)
	;;=71^RADIOLOGY TEST^3^R^n^n
	;;^DD(142.14,.01,"V",5,0)
	;;=9001017^MEASUREMENT PANEL^4^M^^n
	;;^DD(142.14,.01,"V",6,0)
	;;=811.9^CLINICAL REMINDER/MAINTENANCE^5^C^y^n
	;;^DD(142.14,.01,"V",6,1)
	;;=S DIC("S")="I +$P(^(0),U,6)'=1"
	;;^DD(142.14,.01,"V",6,2)
	;;=Allow selection of items that aren't inactive.
	;;^DD(142.14,.01,"V",7,0)
	;;=9999999.64^HEALTH FACTOR^6^F^y^n
	;;^DD(142.14,.01,"V",7,1)
	;;=S DIC("S")="I $P(^(0),U,10)=""C"",+$P(^(0),U,11)'=1"
	;;^DD(142.14,.01,"V",7,2)
	;;=Forces selection of health factor categories rather than individual health factors and forces selection of health factor categories that aren't inactive.
	;;^DD(142.2,0)
	;;=LOCATION(S) USING THE SUMMARY SUB-FIELD^^.04^4
	;;^DD(142.2,0,"DT")
	;;=2920210
	;;^DD(142.2,0,"IX","B",142.2,.01)
	;;=
	;;^DD(142.2,0,"NM","LOCATION(S) USING THE SUMMARY")
	;;=
	;;^DD(142.2,0,"UP")
	;;=142
	;;^DD(142.2,.01,0)
	;;=LOCATION(S) USING THE SUMMARY^MP44'^SC(^0;1^Q
	;;^DD(142.2,.01,1,0)
	;;=^.1
	;;^DD(142.2,.01,1,1,0)
	;;=142.2^B
	;;^DD(142.2,.01,1,1,1)
	;;=S ^GMT(142,DA(1),20,"B",$E(X,1,30),DA)=""
	;;^DD(142.2,.01,1,1,2)
	;;=K ^GMT(142,DA(1),20,"B",$E(X,1,30),DA)
	;;^DD(142.2,.01,1,1,"%D",0)
	;;=^^2^2^2920302^
	;;^DD(142.2,.01,1,1,"%D",1,0)
	;;=This REGULAR FileMan type cross-reference is used for look-ups of locations
	;;^DD(142.2,.01,1,1,"%D",2,0)
	;;=for which Health Summaries are scheduled.
	;;^DD(142.2,.01,1,2,0)
	;;=142^D
	;;^DD(142.2,.01,1,2,1)
	;;=S ^GMT(142,"D",$E(X,1,30),DA(1),DA)=""
	;;^DD(142.2,.01,1,2,2)
	;;=K ^GMT(142,"D",$E(X,1,30),DA(1),DA)
	;;^DD(142.2,.01,1,2,"%D",0)
	;;=^^2^2^2920302^^^^
	;;^DD(142.2,.01,1,2,"%D",1,0)
	;;=This whole-file, REGULAR FileMan cross-reference is used for look-ups
	;;^DD(142.2,.01,1,2,"%D",2,0)
	;;=of the Health Summary types which are queued for each location.
	;;^DD(142.2,.01,21,0)
	;;=^^3^3^2920214^^
	;;^DD(142.2,.01,21,1,0)
	;;=Enter the name of the hospital location (ward or clinic) which is to have
	;;^DD(142.2,.01,21,2,0)
	;;=this health summary type generated on a nightly basis to the device
	;;^DD(142.2,.01,21,3,0)
	;;=specified below.
	;;^DD(142.2,.01,"DT")
	;;=2900904
	;;^DD(142.2,.02,0)
	;;=DEVICE FOR NIGHTLY PRINT^P3.5'^%ZIS(1,^0;2^Q
	;;^DD(142.2,.02,3)
	;;=Specify the printer nearest LOCATION.
	;;^DD(142.2,.02,21,0)
	;;=^^3^3^2950731^^
	;;^DD(142.2,.02,21,1,0)
	;;=Enter the name of the device on which the summaries for this location
	;;^DD(142.2,.02,21,2,0)
	;;=are to be queued to run each night. Preferably the printer nearest to

GMTSI008
GMTSI008	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.2,.02,21,3,0)
	;;=the specified location.
	;;^DD(142.2,.02,"DT")
	;;=2900904
	;;^DD(142.2,.03,0)
	;;=PRINT ACTION PROFILE^S^Y:yes;N:no;^0;3^Q
	;;^DD(142.2,.03,3)
	;;=Enter 'Y'es to queue the OUTPATIENT Action Profile with Health Summary
	;;^DD(142.2,.03,21,0)
	;;=^^3^3^2920210^
	;;^DD(142.2,.03,21,1,0)
	;;=This flag will cause the scheduled option GMTS TASK STARTUP to queue the
	;;^DD(142.2,.03,21,2,0)
	;;=OUTPATIENT PHARMACY Action Profile "in tandem" with the Health Summary
	;;^DD(142.2,.03,21,3,0)
	;;=for any location where the Health Summary may be queued to print.
	;;^DD(142.2,.03,"DT")
	;;=2920210
	;;^DD(142.2,.04,0)
	;;=PRINT DAYS AHEAD^NJ2,0^^0;4^K:+X'=X!(X>10)!(X<0)!(X?.E1"."1N.N) X
	;;^DD(142.2,.04,3)
	;;=0 means available early morning on day of clinic, 1 means available early morning one day before clinic,etc
	;;^DD(142.2,.04,21,0)
	;;=^^5^5^2901017^
	;;^DD(142.2,.04,21,1,0)
	;;=Determines the number of days prior to scheduled appointments you wish
	;;^DD(142.2,.04,21,2,0)
	;;=to have health summaries printed for a given clinic.  That is, if you
	;;^DD(142.2,.04,21,3,0)
	;;=wish to have summaries printed on the night before the patients are
	;;^DD(142.2,.04,21,4,0)
	;;=scheduled for clinic, enter 0.  If you wish them to be printed two days
	;;^DD(142.2,.04,21,5,0)
	;;=in advance of scheduled visits enter 2, etc.
	;;^DD(142.2,.04,"DT")
	;;=2900904

GMTSI009
GMTSI009	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142)
	;;=^GMT(142,
	;;^UTILITY(U,$J,142,0)
	;;=HEALTH SUMMARY TYPE^142^23^5
	;;^UTILITY(U,$J,142,1,0)
	;;=^1^0^^5
	;;^UTILITY(U,$J,142,12,0)
	;;=GMTS HS ADHOC OPTION^GMTSMGR^^Y^
	;;^UTILITY(U,$J,142,12,1,0)
	;;=^142.01IA^^0
	;;^UTILITY(U,$J,142,12,99)
	;;=56539,24551
	;;^UTILITY(U,$J,142,12,"T")
	;;=Ad Hoc Health Summary Type
	;;^UTILITY(U,$J,142,19,0)
	;;=SAMPLE 1^GMTSMGR^
	;;^UTILITY(U,$J,142,19,1,0)
	;;=^142.01IA^40^6
	;;^UTILITY(U,$J,142,19,1,5,0)
	;;=5^2
	;;^UTILITY(U,$J,142,19,1,10,0)
	;;=10^31^10^1Y
	;;^UTILITY(U,$J,142,19,1,15,0)
	;;=15^37^10^1Y
	;;^UTILITY(U,$J,142,19,1,20,0)
	;;=20^27^10^1Y
	;;^UTILITY(U,$J,142,19,1,30,0)
	;;=30^34^10^1Y
	;;^UTILITY(U,$J,142,19,1,35,0)
	;;=35^43^10^1Y
	;;^UTILITY(U,$J,142,19,1,40,0)
	;;=40^8^10^1Y^Discharges
	;;^UTILITY(U,$J,142,19,20,0)
	;;=^142.2P^^0
	;;^UTILITY(U,$J,142,19,99)
	;;=56504,31073
	;;^UTILITY(U,$J,142,20,0)
	;;=SAMPLE 2^GMTSMGR^
	;;^UTILITY(U,$J,142,20,1,0)
	;;=^142.01IA^125^24
	;;^UTILITY(U,$J,142,20,1,5,0)
	;;=5^6
	;;^UTILITY(U,$J,142,20,1,10,0)
	;;=10^1
	;;^UTILITY(U,$J,142,20,1,15,0)
	;;=15^5^^^Crisis Notes
	;;^UTILITY(U,$J,142,20,1,20,0)
	;;=20^4
	;;^UTILITY(U,$J,142,20,1,25,0)
	;;=25^32^10
	;;^UTILITY(U,$J,142,20,1,30,0)
	;;=30^3^10^1Y
	;;^UTILITY(U,$J,142,20,1,35,0)
	;;=35^43^10^1Y
	;;^UTILITY(U,$J,142,20,1,40,0)
	;;=40^33^10^1Y
	;;^UTILITY(U,$J,142,20,1,45,0)
	;;=45^38^10^1Y
	;;^UTILITY(U,$J,142,20,1,50,0)
	;;=50^48^10^1Y
	;;^UTILITY(U,$J,142,20,1,55,0)
	;;=55^46^10^1Y
	;;^UTILITY(U,$J,142,20,1,60,0)
	;;=60^45^10^1Y
	;;^UTILITY(U,$J,142,20,1,65,0)
	;;=65^36^10^1Y
	;;^UTILITY(U,$J,142,20,1,70,0)
	;;=70^29^^1Y^Unit Dose Pharmacy
	;;^UTILITY(U,$J,142,20,1,75,0)
	;;=75^30^^1Y
	;;^UTILITY(U,$J,142,20,1,80,0)
	;;=80^35^10^1Y
	;;^UTILITY(U,$J,142,20,1,85,0)
	;;=85^12^10^1Y^ICD Surgeries
	;;^UTILITY(U,$J,142,20,1,90,0)
	;;=90^50^10^1Y^ICD Procedures
	;;^UTILITY(U,$J,142,20,1,95,0)
	;;=95^51^10^1Y
	;;^UTILITY(U,$J,142,20,1,100,0)
	;;=100^23^10^1Y^Surgery Reports
	;;^UTILITY(U,$J,142,20,1,105,0)
	;;=105^15^10^1Y^Progress Notes
	;;^UTILITY(U,$J,142,20,1,110,0)
	;;=110^10^10^1Y
	;;^UTILITY(U,$J,142,20,1,115,0)
	;;=115^17^10^1Y
	;;^UTILITY(U,$J,142,20,1,120,0)
	;;=120^16^10^1Y^Transfers
	;;^UTILITY(U,$J,142,20,1,125,0)
	;;=125^8^10^1Y^Discharges
	;;^UTILITY(U,$J,142,20,99)
	;;=56525,24488
	;;^UTILITY(U,$J,142,21,0)
	;;=SAMPLE 3^GMTSMGR^
	;;^UTILITY(U,$J,142,21,1,0)
	;;=^142.01IA^30^6
	;;^UTILITY(U,$J,142,21,1,5,0)
	;;=5^6
	;;^UTILITY(U,$J,142,21,1,10,0)
	;;=10^14
	;;^UTILITY(U,$J,142,21,1,15,0)
	;;=15^31^10^1Y
	;;^UTILITY(U,$J,142,21,1,20,0)
	;;=20^33^10^1Y
	;;^UTILITY(U,$J,142,21,1,25,0)
	;;=25^28^^1Y^Outpatient Pharmacy
	;;^UTILITY(U,$J,142,21,1,30,0)
	;;=30^9
	;;^UTILITY(U,$J,142,21,99)
	;;=56474,66781
	;;^UTILITY(U,$J,142,23,0)
	;;=SAMPLE 4^GMTSMGR^
	;;^UTILITY(U,$J,142,23,1,0)
	;;=^142.01IA^55^10
	;;^UTILITY(U,$J,142,23,1,5,0)
	;;=5^202^^^Clinical Reminders
	;;^UTILITY(U,$J,142,23,1,5,1,0)
	;;=^142.14AV^^0
	;;^UTILITY(U,$J,142,23,1,10,0)
	;;=10^232^^^Clinical Maintenance
	;;^UTILITY(U,$J,142,23,1,10,1,0)
	;;=^142.14AV^^0
	;;^UTILITY(U,$J,142,23,1,15,0)
	;;=15^213^^1Y^Education Latest
	;;^UTILITY(U,$J,142,23,1,20,0)
	;;=20^230^^1Y^Exams Latest
	;;^UTILITY(U,$J,142,23,1,25,0)
	;;=25^204^1^1Y^Health Factors
	;;^UTILITY(U,$J,142,23,1,30,0)
	;;=30^207^^^Immunizations
	;;^UTILITY(U,$J,142,23,1,35,0)
	;;=35^206^10^1Y^Non-Tabular Measurem
	;;^UTILITY(U,$J,142,23,1,45,0)
	;;=45^205^10^1Y^Outpatient Encounter^Y^S^Y
	;;^UTILITY(U,$J,142,23,1,50,0)
	;;=50^208^^^Skin Tests
	;;^UTILITY(U,$J,142,23,1,55,0)
	;;=55^231^10^1Y^Treatments Provided
	;;^UTILITY(U,$J,142,23,99)
	;;=56532,37993

GMTSI00A
GMTSI00A	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q

GMTSI00B
GMTSI00B	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(142.1,0,"GL")
	;;=^GMT(142.1,
	;;^DIC("B","HEALTH SUMMARY COMPONENT",142.1)
	;;=
	;;^DIC(142.1,"%D",0)
	;;=^^5^5^2950901^^^^
	;;^DIC(142.1,"%D",1,0)
	;;=This file contains all components which may be used to create a Health
	;;^DIC(142.1,"%D",2,0)
	;;=Summary. These entries are typically defined by a programmer. Components
	;;^DIC(142.1,"%D",3,0)
	;;=which represent packages which are not in use may be disabled, so they
	;;^DIC(142.1,"%D",4,0)
	;;=will not be selected by users to build new types of Health Summary
	;;^DIC(142.1,"%D",5,0)
	;;=reports.
	;;^DD(142.1,0)
	;;=FIELD^^12^15
	;;^DD(142.1,0,"DDA")
	;;=N
	;;^DD(142.1,0,"DT")
	;;=2940418
	;;^DD(142.1,0,"IX","AM",142.1,5)
	;;=
	;;^DD(142.1,0,"IX","AM1",142.1,.01)
	;;=
	;;^DD(142.1,0,"IX","AM2",142.1,3)
	;;=
	;;^DD(142.1,0,"IX","AM9",142.1,9)
	;;=
	;;^DD(142.1,0,"IX","B",142.1,.01)
	;;=
	;;^DD(142.1,0,"IX","C",142.1,3)
	;;=
	;;^DD(142.1,0,"IX","D",142.1,9)
	;;=
	;;^DD(142.1,0,"NM","HEALTH SUMMARY COMPONENT")
	;;=
	;;^DD(142.1,0,"PT",142.01,1)
	;;=
	;;^DD(142.1,.001,0)
	;;=NUMBER^NJ10,0X^^ ^K:+X'=X!(X>9999999999)!(X<0)!(X?.E1"."1N.N) X I $D(X) D CHKNUM^GMTSDD
	;;^DD(142.1,.001,3)
	;;=Enter your station number, followed by 001 to 999.
	;;^DD(142.1,.001,21,0)
	;;=^^4^4^2920914^^^^
	;;^DD(142.1,.001,21,1,0)
	;;=This is the internal record number of the component record.  If you are
	;;^DD(142.1,.001,21,2,0)
	;;=creating a new component, then this should be a sequential number,
	;;^DD(142.1,.001,21,3,0)
	;;=preceded by your station number (e.g., station number 660 should number
	;;^DD(142.1,.001,21,4,0)
	;;=custom-built components from 660001-660999, etc.).
	;;^DD(142.1,.001,"DT")
	;;=2920914
	;;^DD(142.1,.01,0)
	;;=NAME^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X D:$D(X) CHKNAME^GMTSDD
	;;^DD(142.1,.01,1,0)
	;;=^.1
	;;^DD(142.1,.01,1,1,0)
	;;=142.1^B
	;;^DD(142.1,.01,1,1,1)
	;;=S ^GMT(142.1,"B",$E(X,1,30),DA)=""
	;;^DD(142.1,.01,1,1,2)
	;;=K ^GMT(142.1,"B",$E(X,1,30),DA)
	;;^DD(142.1,.01,1,1,"%D",0)
	;;=^^2^2^2920302^
	;;^DD(142.1,.01,1,1,"%D",1,0)
	;;=This whole-file, REGULAR FileMan cross-reference is used for look-ups of
	;;^DD(142.1,.01,1,1,"%D",2,0)
	;;=components by NAME.
	;;^DD(142.1,.01,1,2,0)
	;;=142.1^AM1^MUMPS
	;;^DD(142.1,.01,1,2,1)
	;;=D REDO^GMTSDD
	;;^DD(142.1,.01,1,2,2)
	;;=D REDO^GMTSDD
	;;^DD(142.1,.01,1,2,"%D",0)
	;;=^^4^4^2950731^
	;;^DD(142.1,.01,1,2,"%D",1,0)
	;;=This MUMPS type cross-reference is used to rebuild the ad hoc and
	;;^DD(142.1,.01,1,2,"%D",2,0)
	;;=navigational menus when the NAME of a given component is modified. The
	;;^DD(142.1,.01,1,2,"%D",3,0)
	;;=^XUTL("XQORM", global is used by the Unwinder utility to generate the ad
	;;^DD(142.1,.01,1,2,"%D",4,0)
	;;=hoc and navigational menus.
	;;^DD(142.1,.01,3)
	;;=Answer must be 3-30 characters in length.
	;;^DD(142.1,.01,21,0)
	;;=^^3^3^2920109^^^^
	;;^DD(142.1,.01,21,1,0)
	;;=This is the name of the health summary component, which both uniquely
	;;^DD(142.1,.01,21,2,0)
	;;=identifies the component's record for look-ups, sorts, etc. and is also
	;;^DD(142.1,.01,21,3,0)
	;;=displayed in the component header, when the health summary is run.
	;;^DD(142.1,.01,"DEL",1,0)
	;;=I $S(+$G(DUZ(2))'>0:1,DUZ(2)=5000:0,(DA'<(DUZ(2)_"001")&(DA'>(DUZ(2)_"999"))):0,1:1) W !,$S(+$G(DUZ(2)):"ONLY Components Created at your site can be deleted",1:"DUZ(2) MUST equal your STATION NUMBER")
	;;^DD(142.1,.01,"DEL",2,0)
	;;=I '$D(GMCMP) W $C(7),!!,"You may only delete COMPONENTS using the GMTS IRM COMP ENTER/EDIT OPTION.",!
	;;^DD(142.1,.01,"DT")
	;;=2911212

GMTSI00C
GMTSI00C	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.1,1,0)
	;;=PRINT ROUTINE^RFX^^0;2^K:$L(X)>17!($L(X)<3)!'(X?1U1.7UN1";"1U1.7UN) X I $D(X) D CHKRTN^GMTSDD
	;;^DD(142.1,1,3)
	;;=Component Print Routine in form LINETAG;ROUTINENAME (e.g., MAIN;GMTSLRC)
	;;^DD(142.1,1,21,0)
	;;=3^^3^3^2920928^
	;;^DD(142.1,1,21,1,0)
	;;=This is the entry point and routine to be called when the component is
	;;^DD(142.1,1,21,2,0)
	;;=run for a given health summary type.  Enter the line label, followed by
	;;^DD(142.1,1,21,3,0)
	;;=a semi-colon, followed by the routine name (e.g., MAIN;GMTSLRC).
	;;^DD(142.1,1,"DT")
	;;=2920109
	;;^DD(142.1,2,0)
	;;=TIME LIMITS APPLICABLE^S^Y:yes;^0;3^Q
	;;^DD(142.1,2,3)
	;;=Enter YES if time limits apply to this component.
	;;^DD(142.1,2,21,0)
	;;=^^3^3^2950728^^^^
	;;^DD(142.1,2,21,1,0)
	;;=This field is set up by the programmer to indicate whether the routine to
	;;^DD(142.1,2,21,2,0)
	;;=print this component will allow a time range to be applied to the data
	;;^DD(142.1,2,21,3,0)
	;;=to be displayed in the Health Summary.
	;;^DD(142.1,2,"DT")
	;;=2920109
	;;^DD(142.1,3,0)
	;;=ABBREVIATION^F^^0;4^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>4!($L(X)<2)!'(X?2.4UN) X
	;;^DD(142.1,3,1,0)
	;;=^.1
	;;^DD(142.1,3,1,1,0)
	;;=142.1^C
	;;^DD(142.1,3,1,1,1)
	;;=S ^GMT(142.1,"C",$E(X,1,30),DA)=""
	;;^DD(142.1,3,1,1,2)
	;;=K ^GMT(142.1,"C",$E(X,1,30),DA)
	;;^DD(142.1,3,1,1,"%D",0)
	;;=^^2^2^2920302^
	;;^DD(142.1,3,1,1,"%D",1,0)
	;;=This whole-file, REGULAR FileMan cross-reference is used in look-ups of
	;;^DD(142.1,3,1,1,"%D",2,0)
	;;=components by ABBREVIATION.
	;;^DD(142.1,3,1,2,0)
	;;=142.1^AM2^MUMPS
	;;^DD(142.1,3,1,2,1)
	;;=D REDO^GMTSDD
	;;^DD(142.1,3,1,2,2)
	;;=D REDO^GMTSDD
	;;^DD(142.1,3,1,2,"%D",0)
	;;=^^4^4^2950731^^
	;;^DD(142.1,3,1,2,"%D",1,0)
	;;=This MUMPS type cross-reference is used to rebuild the ad hoc and
	;;^DD(142.1,3,1,2,"%D",2,0)
	;;=navigational menus when the ABBREVIATION of a given component is modified.
	;;^DD(142.1,3,1,2,"%D",3,0)
	;;=The ^XUTL("XQORM", global is used by the Unwinder utility to generate the
	;;^DD(142.1,3,1,2,"%D",4,0)
	;;=ad hoc and navigational menus.
	;;^DD(142.1,3,3)
	;;=Answer must be 2-4 characters in length.
	;;^DD(142.1,3,21,0)
	;;=^^4^4^2950731^^^^
	;;^DD(142.1,3,21,1,0)
	;;=This 2-4 character abbreviation should uniquely identify the component,
	;;^DD(142.1,3,21,2,0)
	;;=since it is used both for lookup in the build health summary and ad hoc
	;;^DD(142.1,3,21,3,0)
	;;=health summary options, and for navigation between components when the
	;;^DD(142.1,3,21,4,0)
	;;=health summary is run interactively.
	;;^DD(142.1,3,"DT")
	;;=2920110
	;;^DD(142.1,3.5,0)
	;;=DESCRIPTION^142.35^^3.5;0
	;;^DD(142.1,4,0)
	;;=MAXIMUM OCCURRENCES APPLICABLE^S^Y:yes;^0;5^Q
	;;^DD(142.1,4,3)
	;;=Enter YES if maximum occurrence limits apply to this component.
	;;^DD(142.1,4,21,0)
	;;=^^3^3^2950728^^^^
	;;^DD(142.1,4,21,1,0)
	;;=This field is used by the programmer to indicate whether the routine which
	;;^DD(142.1,4,21,2,0)
	;;=prints this component is set up to handle maximum occurrence limits
	;;^DD(142.1,4,21,3,0)
	;;=on the Health Summary.
	;;^DD(142.1,4,"DT")
	;;=2920109
	;;^DD(142.1,5,0)
	;;=DISABLE FLAG^S^T:temporary;P:permanent;^0;6^Q
	;;^DD(142.1,5,1,0)
	;;=^.1
	;;^DD(142.1,5,1,1,0)
	;;=142.1^AM^MUMPS
	;;^DD(142.1,5,1,1,1)
	;;=D REDO^GMTSDD
	;;^DD(142.1,5,1,1,2)
	;;=D REDO^GMTSDD
	;;^DD(142.1,5,1,1,"%D",0)
	;;=^^4^4^2950731^
	;;^DD(142.1,5,1,1,"%D",1,0)
	;;=This MUMPS type cross-reference is used to rebuild the ad hoc and
	;;^DD(142.1,5,1,1,"%D",2,0)
	;;=navigational menus when a given component is DISABLED. The ^XUTL("XQORM",

GMTSI00D
GMTSI00D	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.1,5,1,1,"%D",3,0)
	;;=global is used by the Unwinder utility to generate the ad hoc and
	;;^DD(142.1,5,1,1,"%D",4,0)
	;;=navigational menus.
	;;^DD(142.1,5,21,0)
	;;=^^10^10^2951017^^^^
	;;^DD(142.1,5,21,1,0)
	;;=IRM Staff or Clin Coordinator:  Use this field to disable (inactivate)
	;;^DD(142.1,5,21,2,0)
	;;=a health summary component (e.g., Lab Orders).  Setting this DISABLE
	;;^DD(142.1,5,21,3,0)
	;;=FLAG field to P(ermanent) causes a component to be non-selectable for use,
	;;^DD(142.1,5,21,4,0)
	;;=and prevents the component from being printed in any Health Summary
	;;^DD(142.1,5,21,5,0)
	;;=in which it is included.  Setting DISABLE FLAG to T(emporary) causes
	;;^DD(142.1,5,21,6,0)
	;;=a component to be non-selectable for use, but its OUT OF ORDER MESSAGE
	;;^DD(142.1,5,21,7,0)
	;;=will appear in any Health Summary in which it is included.
	;;^DD(142.1,5,21,8,0)
	;;= 
	;;^DD(142.1,5,21,9,0)
	;;=Use the at-sign (@) at the DISABLE FLAG: permanent (or temporary)// prompt,
	;;^DD(142.1,5,21,10,0)
	;;=to enable the component for use.
	;;^DD(142.1,5,"DT")
	;;=2911122
	;;^DD(142.1,6,0)
	;;=LOCK^FX^^0;7^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<1) X I $D(X) Q:$D(^DIC(19.1,"B",X))  K X W !,$C(7),"Lock name must match exactly with a key in the SECURITY KEY file."
	;;^DD(142.1,6,3)
	;;=Enter the name of the security key required to have access to this component.
	;;^DD(142.1,6,21,0)
	;;=^^2^2^2901017^^^^
	;;^DD(142.1,6,21,1,0)
	;;=To be used for components such as psychology test results
	;;^DD(142.1,6,21,2,0)
	;;=Restricts viewing access under Print Health Summary Menu
	;;^DD(142.1,6,"DT")
	;;=2950816
	;;^DD(142.1,7,0)
	;;=SELECTION FILE^142.17P^^1;0
	;;^DD(142.1,7,21,0)
	;;=^^10^10^2940714^^
	;;^DD(142.1,7,21,1,0)
	;;=Enter the name or number of the file from which selection items (e.g., lab
	;;^DD(142.1,7,21,2,0)
	;;=tests (file 60), radiology procedures (file 71), vital signs (file
	;;^DD(142.1,7,21,3,0)
	;;=120.51), Health Summary Meas Panel (file 142.7)) may be chosen for this
	;;^DD(142.1,7,21,4,0)
	;;=component.
	;;^DD(142.1,7,21,5,0)
	;;= 
	;;^DD(142.1,7,21,6,0)
	;;=The file you identify here must have its "Application Group"
	;;^DD(142.1,7,21,7,0)
	;;=multiple include "GMTS" BEFORE it can be selected as a selection file.
	;;^DD(142.1,7,21,8,0)
	;;= 
	;;^DD(142.1,7,21,9,0)
	;;=Components which require selection of items should have its component
	;;^DD(142.1,7,21,10,0)
	;;=name include the word "SELECTED".
	;;^DD(142.1,8,0)
	;;=OUT OF ORDER MESSAGE^F^^0;8^K:$L(X)>78!($L(X)<3) X
	;;^DD(142.1,8,3)
	;;=Answer must be 3-78 characters in length.
	;;^DD(142.1,8,21,0)
	;;=^^3^3^2910117^
	;;^DD(142.1,8,21,1,0)
	;;=This field is used when a health summary component is temporarily disabled.
	;;^DD(142.1,8,21,2,0)
	;;=If it is filled in, the message here will be displayed whenever the user
	;;^DD(142.1,8,21,3,0)
	;;=attempts to select the component
	;;^DD(142.1,8,"DT")
	;;=2910117
	;;^DD(142.1,9,0)
	;;=DEFAULT HEADER NAME^F^^0;9^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<2) X
	;;^DD(142.1,9,1,0)
	;;=^.1
	;;^DD(142.1,9,1,1,0)
	;;=142.1^AM9^MUMPS
	;;^DD(142.1,9,1,1,1)
	;;=D REDO^GMTSDD
	;;^DD(142.1,9,1,1,2)
	;;=D REDO^GMTSDD
	;;^DD(142.1,9,1,1,"%D",0)
	;;=^^4^4^2950731^
	;;^DD(142.1,9,1,1,"%D",1,0)
	;;=This MUMPS type cross-reference is used to recompile the ad hoc and
	;;^DD(142.1,9,1,1,"%D",2,0)
	;;=navigational menus when the DEFAULT HEADER NAME of a given component is
	;;^DD(142.1,9,1,1,"%D",3,0)
	;;=modified. The ^XUTL("XQORM", global is used by the Unwinder utility to

GMTSI00E
GMTSI00E	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.1,9,1,1,"%D",4,0)
	;;=generate the ad hoc and navigational menus.
	;;^DD(142.1,9,1,1,"DT")
	;;=2911122
	;;^DD(142.1,9,1,2,0)
	;;=142.1^D^MUMPS
	;;^DD(142.1,9,1,2,1)
	;;=S ^GMT(142.1,"D",$$UP^XLFSTR(X),DA)=""
	;;^DD(142.1,9,1,2,2)
	;;=K ^GMT(142.1,"D",$$UP^XLFSTR(X),DA)
	;;^DD(142.1,9,1,2,"%D",0)
	;;=^^2^2^2951016^
	;;^DD(142.1,9,1,2,"%D",1,0)
	;;=This MUMPS type cross-reference is used in look-ups of components
	;;^DD(142.1,9,1,2,"%D",2,0)
	;;=by DEFAULT HEADER NAME.
	;;^DD(142.1,9,1,2,"DT")
	;;=2951016
	;;^DD(142.1,9,3)
	;;=Answer must be 2-20 characters in length.
	;;^DD(142.1,9,21,0)
	;;=^^5^5^2920928^^^^
	;;^DD(142.1,9,21,1,0)
	;;=The DEFAULT HEADER NAME will appear in menus and component headers in
	;;^DD(142.1,9,21,2,0)
	;;=preference to the COMPONENT NAME, but NOT in preference to the local
	;;^DD(142.1,9,21,3,0)
	;;=HEADER NAME, if it is defined for that component within a given Health 
	;;^DD(142.1,9,21,4,0)
	;;=Summary Type.  If defined the local HEADER NAME will have precedence
	;;^DD(142.1,9,21,5,0)
	;;=within a given Health Summary Type.
	;;^DD(142.1,9,"DT")
	;;=2951016
	;;^DD(142.1,10,0)
	;;=HOSPITAL LOCATION APPLICABLE^S^Y:yes;^0;10^Q
	;;^DD(142.1,10,3)
	;;=Enter YES if Hospital Location abbreviation display applies to this component.
	;;^DD(142.1,10,21,0)
	;;=^^3^3^2950731^
	;;^DD(142.1,10,21,1,0)
	;;=This field is used by the programmer to indicate whether the routine which
	;;^DD(142.1,10,21,2,0)
	;;=prints this component is set up to handle the display of the hospital
	;;^DD(142.1,10,21,3,0)
	;;=location abbreviation on the Health Summary.
	;;^DD(142.1,10,"DT")
	;;=2940418
	;;^DD(142.1,11,0)
	;;=ICD TEXT APPLICABLE^S^Y:yes;^0;11^Q
	;;^DD(142.1,11,3)
	;;=Enter YES if ICD Text display applies to this component.
	;;^DD(142.1,11,21,0)
	;;=^^3^3^2950731^
	;;^DD(142.1,11,21,1,0)
	;;=This field is used by the programmer to indicate whether the routine which
	;;^DD(142.1,11,21,2,0)
	;;=prints this component is set up to handle the display of standardized ICD
	;;^DD(142.1,11,21,3,0)
	;;=text on the Health Summary.
	;;^DD(142.1,11,"DT")
	;;=2940418
	;;^DD(142.1,12,0)
	;;=PROVIDER NARRATIVE APPLICABLE^S^Y:yes;^0;12^Q
	;;^DD(142.1,12,3)
	;;=Enter YES if Provider Narrative display applies to this component.
	;;^DD(142.1,12,21,0)
	;;=^^3^3^2950731^
	;;^DD(142.1,12,21,1,0)
	;;=This field is used by the programmer to indicate whether the routine which
	;;^DD(142.1,12,21,2,0)
	;;=prints this component is set up to handle the display of the provider
	;;^DD(142.1,12,21,3,0)
	;;=narrative on the Health Summary.
	;;^DD(142.1,12,"DT")
	;;=2940418
	;;^DD(142.17,0)
	;;=SELECTION FILE SUB-FIELD^^1^2
	;;^DD(142.17,0,"DT")
	;;=2910103
	;;^DD(142.17,0,"IX","B",142.17,.01)
	;;=
	;;^DD(142.17,0,"NM","SELECTION FILE")
	;;=
	;;^DD(142.17,0,"UP")
	;;=142.1
	;;^DD(142.17,.01,0)
	;;=SELECTION FILE^M*P1'^DIC(^0;1^S DIC("S")="I $D(^DIC(""AC"",""GMTS"",+Y))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(142.17,.01,1,0)
	;;=^.1
	;;^DD(142.17,.01,1,1,0)
	;;=142.17^B
	;;^DD(142.17,.01,1,1,1)
	;;=S ^GMT(142.1,DA(1),1,"B",$E(X,1,30),DA)=""
	;;^DD(142.17,.01,1,1,2)
	;;=K ^GMT(142.1,DA(1),1,"B",$E(X,1,30),DA)
	;;^DD(142.17,.01,1,1,"%D",0)
	;;=^^2^2^2920302^
	;;^DD(142.17,.01,1,1,"%D",1,0)
	;;=This REGULAR FileMan type cross-reference is used during look-ups of
	;;^DD(142.17,.01,1,1,"%D",2,0)
	;;=selection items in the Create/Modify and parameter edit dialogues.
	;;^DD(142.17,.01,12)
	;;=Only files that belong to the "GMTS" application group are allowed.
	;;^DD(142.17,.01,12.1)
	;;=S DIC("S")="I $D(^DIC(""AC"",""GMTS"",+Y))"

GMTSI00F
GMTSI00F	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.17,.01,21,0)
	;;=^^3^3^2940714^^^^
	;;^DD(142.17,.01,21,1,0)
	;;=Enter the names or numbers of the files from which selection items
	;;^DD(142.17,.01,21,2,0)
	;;=(e.g., lab tests (file 60), radiology procedures (file 71), or vital 
	;;^DD(142.17,.01,21,3,0)
	;;=signs (file 120.51)) may be chosen for this component.
	;;^DD(142.17,.01,"DT")
	;;=2910103
	;;^DD(142.17,1,0)
	;;=SELECTION COUNT LIMIT^NJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
	;;^DD(142.17,1,3)
	;;=Type a Number between 1 and 99, 0 Decimal Digits
	;;^DD(142.17,1,21,0)
	;;=^^4^4^2901017^
	;;^DD(142.17,1,21,1,0)
	;;=Enter the MAXIMUM number of selection items which may be selected for
	;;^DD(142.17,1,21,2,0)
	;;=any single appearance of this component in a given health summary type.
	;;^DD(142.17,1,21,3,0)
	;;=That is, a value of 7 will allow the user to select as many as seven
	;;^DD(142.17,1,21,4,0)
	;;=items, etc.
	;;^DD(142.17,1,"DT")
	;;=2900521
	;;^DD(142.35,0)
	;;=DESCRIPTION SUB-FIELD^^.01^1
	;;^DD(142.35,0,"DT")
	;;=2910103
	;;^DD(142.35,0,"NM","DESCRIPTION")
	;;=
	;;^DD(142.35,0,"UP")
	;;=142.1
	;;^DD(142.35,.01,0)
	;;=DESCRIPTION^W^^0;1^Q
	;;^DD(142.35,.01,"DT")
	;;=2910103

GMTSI00G
GMTSI00G	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1)
	;;=^GMT(142.1,
	;;^UTILITY(U,$J,142.1,0)
	;;=HEALTH SUMMARY COMPONENT^142.1I^5000000^78
	;;^UTILITY(U,$J,142.1,1,0)
	;;=ADVERSE REACTIONS/ALLERGIES^ALLRG;GMTSALG^^ADR^^^^^Adv React/Allerg
	;;^UTILITY(U,$J,142.1,1,3.5,0)
	;;=^^6^6^2950823^^
	;;^UTILITY(U,$J,142.1,1,3.5,1,0)
	;;=This component provides patient allergy/adverse reaction information from
	;;^UTILITY(U,$J,142.1,1,3.5,2,0)
	;;=the Allergy Tracking System. It provides a list of all known food, drug
	;;^UTILITY(U,$J,142.1,1,3.5,3,0)
	;;=and environmental allergies or adverse reactions (e.g., hay fever). Data
	;;^UTILITY(U,$J,142.1,1,3.5,4,0)
	;;=element included are type of reaction, mechanism of reaction, causative
	;;^UTILITY(U,$J,142.1,1,3.5,5,0)
	;;=agent, verification status, signs/symptoms for the reaction, the
	;;^UTILITY(U,$J,142.1,1,3.5,6,0)
	;;=originator, and comments.
	;;^UTILITY(U,$J,142.1,2,0)
	;;=MAS DEMOGRAPHICS BRIEF^DEMOG;GMTSDEMB^^BDEM^^^^^Brief Demographics
	;;^UTILITY(U,$J,142.1,2,3.5,0)
	;;=^^4^4^2941220^
	;;^UTILITY(U,$J,142.1,2,3.5,1,0)
	;;=This component contains information from the MAS package.  It provides
	;;^UTILITY(U,$J,142.1,2,3.5,2,0)
	;;=brief patient demographic information including:  address, phone number,
	;;^UTILITY(U,$J,142.1,2,3.5,3,0)
	;;=age, sex, mean test, and eligibility code (e.g., service connected
	;;^UTILITY(U,$J,142.1,2,3.5,4,0)
	;;=50-100%).
	;;^UTILITY(U,$J,142.1,3,0)
	;;=LAB CHEMISTRY & HEMATOLOGY^MAIN;GMTSLRC^Y^CH^Y^^^^Chem & Hematology
	;;^UTILITY(U,$J,142.1,3,3.5,0)
	;;=^^8^8^2950824^^^^
	;;^UTILITY(U,$J,142.1,3,3.5,1,0)
	;;=This component contains information extracted from the Lab package.
	;;^UTILITY(U,$J,142.1,3,3.5,2,0)
	;;=Time and maximum occurrence limits apply to this component. Data
	;;^UTILITY(U,$J,142.1,3,3.5,3,0)
	;;=presented include:  collection date/time, specimen, test name, results
	;;^UTILITY(U,$J,142.1,3,3.5,4,0)
	;;=(w/ref flag:  High/Low/Critical), units, and Reference range.
	;;^UTILITY(U,$J,142.1,3,3.5,5,0)
	;;=Comments will also be conditionally displayed, depending on the value
	;;^UTILITY(U,$J,142.1,3,3.5,6,0)
	;;=of the DISPLAY COMMENTS ON LABS Health Summary Site Parameter.  Results
	;;^UTILITY(U,$J,142.1,3,3.5,7,0)
	;;=which include comments will be indicated with the symbol !!, in the
	;;^UTILITY(U,$J,142.1,3,3.5,8,0)
	;;=event that the parameter is set to 0 or NO.
	;;^UTILITY(U,$J,142.1,4,0)
	;;=CLINICAL WARNINGS^CW;GMTSCW^^CW^^^^^Clinical Warnings
	;;^UTILITY(U,$J,142.1,4,3.5,0)
	;;=^^11^11^2941103^^^^
	;;^UTILITY(U,$J,142.1,4,3.5,1,0)
	;;=This component contains clinical warning notes entered using the Generic
	;;^UTILITY(U,$J,142.1,4,3.5,2,0)
	;;=Progress Note package.  No time or maximum occurrence limits apply to this
	;;^UTILITY(U,$J,142.1,4,3.5,3,0)
	;;=component.
	;;^UTILITY(U,$J,142.1,4,3.5,4,0)
	;;=  
	;;^UTILITY(U,$J,142.1,4,3.5,5,0)
	;;=Clinical Warnings are a type of progress note which includes clinical
	;;^UTILITY(U,$J,142.1,4,3.5,6,0)
	;;=information which clinicians need to be alerted to.
	;;^UTILITY(U,$J,142.1,4,3.5,7,0)
	;;=   
	;;^UTILITY(U,$J,142.1,4,3.5,8,0)
	;;=If this component is printed out on a CRT, information will include title,
	;;^UTILITY(U,$J,142.1,4,3.5,9,0)
	;;=text of note, electronic signature block, and date posted.  If the printout
	;;^UTILITY(U,$J,142.1,4,3.5,10,0)
	;;=is to another device type, information will include electronic signature
	;;^UTILITY(U,$J,142.1,4,3.5,11,0)
	;;=block and date posted to ensure security of information.
	;;^UTILITY(U,$J,142.1,5,0)
	;;=CRISIS NOTES^CN;GMTSCW^^CN^^^^^Crisis Notes

GMTSI00H
GMTSI00H	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,5,3.5,0)
	;;=^^11^11^2950829^
	;;^UTILITY(U,$J,142.1,5,3.5,1,0)
	;;=This component contains crisis notes entered using the Generic Progress
	;;^UTILITY(U,$J,142.1,5,3.5,2,0)
	;;=Note package. No time or maximum occurrence limits apply to this
	;;^UTILITY(U,$J,142.1,5,3.5,3,0)
	;;=component.
	;;^UTILITY(U,$J,142.1,5,3.5,4,0)
	;;= 
	;;^UTILITY(U,$J,142.1,5,3.5,5,0)
	;;=Crisis Notes are a type of progress note which contains important
	;;^UTILITY(U,$J,142.1,5,3.5,6,0)
	;;=information for anyone who deals with a patient.
	;;^UTILITY(U,$J,142.1,5,3.5,7,0)
	;;= 
	;;^UTILITY(U,$J,142.1,5,3.5,8,0)
	;;=If this component is printed out on a CRT, information will include title,
	;;^UTILITY(U,$J,142.1,5,3.5,9,0)
	;;=text of note, electronic signature block, and date posted. If the printout
	;;^UTILITY(U,$J,142.1,5,3.5,10,0)
	;;=is to another device type, information will include electronic signature
	;;^UTILITY(U,$J,142.1,5,3.5,11,0)
	;;=block and date posted to insure security of information.
	;;^UTILITY(U,$J,142.1,6,0)
	;;=MAS DEMOGRAPHICS^DEMOG;GMTSDEM^^DEM^^^^^Demographics
	;;^UTILITY(U,$J,142.1,6,3.5,0)
	;;=^^6^6^2941220^
	;;^UTILITY(U,$J,142.1,6,3.5,1,0)
	;;=This component contains the following patient demographic data (if
	;;^UTILITY(U,$J,142.1,6,3.5,2,0)
	;;=available) from the MAS package: address, phone, county, marital
	;;^UTILITY(U,$J,142.1,6,3.5,3,0)
	;;=status, religion, age, sex, occupation, period of service, POW status
	;;^UTILITY(U,$J,142.1,6,3.5,4,0)
	;;=(e.g., Y or N), branch of service, combat status (e.g., Y or N),
	;;^UTILITY(U,$J,142.1,6,3.5,5,0)
	;;=eligibility code, current (verified) eligibility status, service connected
	;;^UTILITY(U,$J,142.1,6,3.5,6,0)
	;;=%, mean test, next of kin (NOK), NOK phone number and address.
	;;^UTILITY(U,$J,142.1,7,0)
	;;=DIETETICS^MAIN;GMTSFH^Y^DI^Y^^^^Dietetics
	;;^UTILITY(U,$J,142.1,7,3.5,0)
	;;=^^9^9^2910206^^^^
	;;^UTILITY(U,$J,142.1,7,3.5,1,0)
	;;=This component contains information from the Dietetics package.  Time
	;;^UTILITY(U,$J,142.1,7,3.5,2,0)
	;;=and occurrence limits apply to this component.  Data presented include:
	;;^UTILITY(U,$J,142.1,7,3.5,3,0)
	;;=diet orders, start/stop dates, type of service (tray, e.g.); nutritional
	;;^UTILITY(U,$J,142.1,7,3.5,4,0)
	;;=status, date assessed; supplemental feedings, start/stop dates; tube
	;;^UTILITY(U,$J,142.1,7,3.5,5,0)
	;;=feedings, start/stop dates, strength of product, quantity ordered, and daily
	;;^UTILITY(U,$J,142.1,7,3.5,6,0)
	;;=dosages.
	;;^UTILITY(U,$J,142.1,7,3.5,7,0)
	;;=  
	;;^UTILITY(U,$J,142.1,7,3.5,8,0)
	;;=Note:  When a time limit is selected, the data presented reflects orders
	;;^UTILITY(U,$J,142.1,7,3.5,9,0)
	;;=initiated within the time period.
	;;^UTILITY(U,$J,142.1,8,0)
	;;=MAS DISCHARGES^ENDC;GMTSDGA^Y^DC^Y^^^^Discharges
	;;^UTILITY(U,$J,142.1,8,3.5,0)
	;;=^^6^6^2920928^^^^
	;;^UTILITY(U,$J,142.1,8,3.5,1,0)
	;;=This component contains information extracted from the MAS package. 
	;;^UTILITY(U,$J,142.1,8,3.5,2,0)
	;;=Time and occurrence limits apply to this component.  Data presented
	;;^UTILITY(U,$J,142.1,8,3.5,3,0)
	;;=include:  date of discharge, DXLS, bedsection, disposition type,
	;;^UTILITY(U,$J,142.1,8,3.5,4,0)
	;;=disposition place, and outpatient treatment flag.
	;;^UTILITY(U,$J,142.1,8,3.5,5,0)
	;;= 
	;;^UTILITY(U,$J,142.1,8,3.5,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.
	;;^UTILITY(U,$J,142.1,9,0)
	;;=MAS CLINIC VISITS FUTURE^FUTURE;GMTSDA^^CVF^^^^^Fut Clinic Visits

GMTSI00I
GMTSI00I	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,9,3.5,0)
	;;=^^3^3^2910116^^
	;;^UTILITY(U,$J,142.1,9,3.5,1,0)
	;;=This component provides a listing from the MAS scheduling module that
	;;^UTILITY(U,$J,142.1,9,3.5,2,0)
	;;=contains future clinic visit dates, the clinic visited, and the 
	;;^UTILITY(U,$J,142.1,9,3.5,3,0)
	;;=appointment type.
	;;^UTILITY(U,$J,142.1,10,0)
	;;=MAS ADMISSIONS/DISCHARGES^ENAD;GMTSDGA^Y^ADC^Y^^^^Admission/Discharge
	;;^UTILITY(U,$J,142.1,10,3.5,0)
	;;=^^6^6^2910203^^^^
	;;^UTILITY(U,$J,142.1,10,3.5,1,0)
	;;=This component contains information from the MAS package.  Time and
	;;^UTILITY(U,$J,142.1,10,3.5,2,0)
	;;=occurrence limits apply to this component.  Data presented include:
	;;^UTILITY(U,$J,142.1,10,3.5,3,0)
	;;=date range of admission, ward, length of stay (LOS), last treating 
	;;^UTILITY(U,$J,142.1,10,3.5,4,0)
	;;=specialty, last provider, admitting diagnosis text, bedsection, principal
	;;^UTILITY(U,$J,142.1,10,3.5,5,0)
	;;=diagnosis, diagnosis for longest length of stay (DXLS), and secondary
	;;^UTILITY(U,$J,142.1,10,3.5,6,0)
	;;=ICD diagnoses.
	;;^UTILITY(U,$J,142.1,11,0)
	;;=MAS DISCHARGE DIAGNOSIS^ENDX;GMTSDGA^Y^DD^Y^^^^Discharge Diagnosis
	;;^UTILITY(U,$J,142.1,11,3.5,0)
	;;=^^9^9^2950905^
	;;^UTILITY(U,$J,142.1,11,3.5,1,0)
	;;=This component contains information extracted from the MAS package. Time
	;;^UTILITY(U,$J,142.1,11,3.5,2,0)
	;;=and occurrence limits apply to this component.  Data presented include:
	;;^UTILITY(U,$J,142.1,11,3.5,3,0)
	;;=Date range of admission through discharge, length of stay (LOS), Principal
	;;^UTILITY(U,$J,142.1,11,3.5,4,0)
	;;=diagnosis, diagnosis for longest length of stay (DXLS), and secondary ICD
	;;^UTILITY(U,$J,142.1,11,3.5,5,0)
	;;=discharge diagnoses.
	;;^UTILITY(U,$J,142.1,11,3.5,6,0)
	;;=  
	;;^UTILITY(U,$J,142.1,11,3.5,7,0)
	;;=Note: This component provides discharge diagnoses coded in the MAS PTF
	;;^UTILITY(U,$J,142.1,11,3.5,8,0)
	;;=file. The occurrence limits are determined by the occurrence of
	;;^UTILITY(U,$J,142.1,11,3.5,9,0)
	;;=admissions.
	;;^UTILITY(U,$J,142.1,12,0)
	;;=MAS SURGERIES ICD CODES^ENS;GMTSDGP^Y^OPC^Y^^^^ICD Surgeries
	;;^UTILITY(U,$J,142.1,12,3.5,0)
	;;=^^6^6^2910203^^^^
	;;^UTILITY(U,$J,142.1,12,3.5,1,0)
	;;=This component contains MAS coded surgeries, by admission, extracted from
	;;^UTILITY(U,$J,142.1,12,3.5,2,0)
	;;=the MAS package.  Time and occurrence limits apply to this component.
	;;^UTILITY(U,$J,142.1,12,3.5,3,0)
	;;=Data presented include:  surgery date, procedure name, and ICD-9CM procedure
	;;^UTILITY(U,$J,142.1,12,3.5,4,0)
	;;=codes.
	;;^UTILITY(U,$J,142.1,12,3.5,5,0)
	;;=  
	;;^UTILITY(U,$J,142.1,12,3.5,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.
	;;^UTILITY(U,$J,142.1,14,0)
	;;=MAS CLINIC VISITS PAST^PAST;GMTSDA^Y^CVP^Y^^^^Past Clinic Visits
	;;^UTILITY(U,$J,142.1,14,3.5,0)
	;;=^^4^4^2920226^^^^
	;;^UTILITY(U,$J,142.1,14,3.5,1,0)
	;;=This component contains information from the MAS scheduling module.
	;;^UTILITY(U,$J,142.1,14,3.5,2,0)
	;;=Time and occurrence limits apply to this component.  Data presented
	;;^UTILITY(U,$J,142.1,14,3.5,3,0)
	;;=include:  past clinic visits, dates, and a visit status (e.g., NO SHOW,
	;;^UTILITY(U,$J,142.1,14,3.5,4,0)
	;;=INPATIENT VISIT).  Note: Cancellations and Unscheduled Visits are shown.
	;;^UTILITY(U,$J,142.1,15,0)
	;;=PROGRESS NOTES^PN;GMTSPN^Y^PN^Y^^^^Progress Notes
	;;^UTILITY(U,$J,142.1,15,3.5,0)
	;;=12^^10^10^2950307^^^^
	;;^UTILITY(U,$J,142.1,15,3.5,1,0)
	;;=This component contains progress notes from the Generic Progress Notes

GMTSI00J
GMTSI00J	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,15,3.5,2,0)
	;;=Package AND progress notes from the Mental Health Package.  Time and
	;;^UTILITY(U,$J,142.1,15,3.5,3,0)
	;;=maximum occurrence limits apply to this component.  Data presented include:
	;;^UTILITY(U,$J,142.1,15,3.5,4,0)
	;;=Progress note date/time written, title, text of note, electronic signature
	;;^UTILITY(U,$J,142.1,15,3.5,5,0)
	;;=block (including possible cosignature and cosigner comments), and the note's
	;;^UTILITY(U,$J,142.1,15,3.5,6,0)
	;;=correction text and correction date/time.
	;;^UTILITY(U,$J,142.1,15,3.5,7,0)
	;;=  
	;;^UTILITY(U,$J,142.1,15,3.5,8,0)
	;;=Only those notes which have been signed with an electronic signature
	;;^UTILITY(U,$J,142.1,15,3.5,9,0)
	;;=or (for generic progress notes) electronically marked signed on chart
	;;^UTILITY(U,$J,142.1,15,3.5,10,0)
	;;=will be reported.
	;;^UTILITY(U,$J,142.1,16,0)
	;;=MAS TRANSFERS^ENTR;GMTSDGA^Y^TR^Y^^^^Transfers
	;;^UTILITY(U,$J,142.1,16,3.5,0)
	;;=^^5^5^2910203^^^
	;;^UTILITY(U,$J,142.1,16,3.5,1,0)
	;;=This component contains information extracted from the MAS package.
	;;^UTILITY(U,$J,142.1,16,3.5,2,0)
	;;=Time and occurrence limits apply to this component.  Data presented
	;;^UTILITY(U,$J,142.1,16,3.5,3,0)
	;;=include:  transfer date, type, destination, and provider (when available).
	;;^UTILITY(U,$J,142.1,16,3.5,4,0)
	;;=  
	;;^UTILITY(U,$J,142.1,16,3.5,5,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.
	;;^UTILITY(U,$J,142.1,17,0)
	;;=MAS TREATING SPECIALTY^ENTS;GMTSDGA^Y^TS^Y^^^^Treating Specialty
	;;^UTILITY(U,$J,142.1,17,3.5,0)
	;;=^^6^6^2910203^^^
	;;^UTILITY(U,$J,142.1,17,3.5,1,0)
	;;=This component contains information extracted from the MAS package.
	;;^UTILITY(U,$J,142.1,17,3.5,2,0)
	;;=Time and occurrence limits apply to this component.  Data presented
	;;^UTILITY(U,$J,142.1,17,3.5,3,0)
	;;=include:  treating specialty change date/time, new treating specialty,
	;;^UTILITY(U,$J,142.1,17,3.5,4,0)
	;;=(admission date), and provider.
	;;^UTILITY(U,$J,142.1,17,3.5,5,0)
	;;= 
	;;^UTILITY(U,$J,142.1,17,3.5,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.
	;;^UTILITY(U,$J,142.1,18,0)
	;;=LAB CUMULATIVE SELECTED 1^MAIN;GMTSLRS7^Y^SCL1^Y^^^^Lab Cum Selected 1
	;;^UTILITY(U,$J,142.1,18,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,18,1,1,0)
	;;=60^7
	;;^UTILITY(U,$J,142.1,18,3.5,0)
	;;=^^11^11^2950824^^
	;;^UTILITY(U,$J,142.1,18,3.5,1,0)
	;;=This component contains information extracted from the Lab package. Not
	;;^UTILITY(U,$J,142.1,18,3.5,2,0)
	;;=only do time and maximum occurrence limits apply to this component, but
	;;^UTILITY(U,$J,142.1,18,3.5,3,0)
	;;=the user is allowed to select as many as seven atomic Lab tests. Data
	;;^UTILITY(U,$J,142.1,18,3.5,4,0)
	;;=presented include: collection date/time, specimen, test names with results
	;;^UTILITY(U,$J,142.1,18,3.5,5,0)
	;;=and reference flags in columnar (horizontal) format. Comments will also be
	;;^UTILITY(U,$J,142.1,18,3.5,6,0)
	;;=conditionally displayed, depending on the value of the DISPLAY COMMENTS ON
	;;^UTILITY(U,$J,142.1,18,3.5,7,0)
	;;=LABS Health Summary Site Parameter. When comments are displayed, a lower
	;;^UTILITY(U,$J,142.1,18,3.5,8,0)
	;;=case letter will be displayed to the left of the date for entries with
	;;^UTILITY(U,$J,142.1,18,3.5,9,0)
	;;=comments. Comments will be displayed after all the results are displayed
	;;^UTILITY(U,$J,142.1,18,3.5,10,0)
	;;=with comments being linked by the lower case letter. Up to 26 comments can

GMTSI00K
GMTSI00K	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,18,3.5,11,0)
	;;=be included.
	;;^UTILITY(U,$J,142.1,19,0)
	;;=LAB CUMULATIVE SELECTED 2^MAIN;GMTSLRS7^Y^SCL2^Y^^^^Lab Cum Selected 2
	;;^UTILITY(U,$J,142.1,19,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,19,1,1,0)
	;;=60^7
	;;^UTILITY(U,$J,142.1,19,3.5,0)
	;;=^^11^11^2950824^
	;;^UTILITY(U,$J,142.1,19,3.5,1,0)
	;;=This component contains information extracted from the Lab package. Not
	;;^UTILITY(U,$J,142.1,19,3.5,2,0)
	;;=only do time and maximum occurrence limits apply to this component, but
	;;^UTILITY(U,$J,142.1,19,3.5,3,0)
	;;=the user is allowed to select as many as seven atomic Lab tests. Data
	;;^UTILITY(U,$J,142.1,19,3.5,4,0)
	;;=presented include: collection date/time, specimen, test names with results
	;;^UTILITY(U,$J,142.1,19,3.5,5,0)
	;;=and reference flags in columnar (horizontal) format. Comments will also be
	;;^UTILITY(U,$J,142.1,19,3.5,6,0)
	;;=conditionally displayed, depending on the value of the DISPLAY COMMENTS ON
	;;^UTILITY(U,$J,142.1,19,3.5,7,0)
	;;=LABS Health Summary Site Parameter. When comments are displayed, a lower
	;;^UTILITY(U,$J,142.1,19,3.5,8,0)
	;;=case letter will be displayed to the left of the date for entries with
	;;^UTILITY(U,$J,142.1,19,3.5,9,0)
	;;=comments. Comments will be displayed after all the results are displayed
	;;^UTILITY(U,$J,142.1,19,3.5,10,0)
	;;=with comments being linked by the lower case letter. Up to 26 comments can
	;;^UTILITY(U,$J,142.1,19,3.5,11,0)
	;;=be included.
	;;^UTILITY(U,$J,142.1,20,0)
	;;=LAB CUMULATIVE SELECTED 3^MAIN;GMTSLRS7^Y^SCL3^Y^^^^Lab Cum Selected 3
	;;^UTILITY(U,$J,142.1,20,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,20,1,1,0)
	;;=60^7
	;;^UTILITY(U,$J,142.1,20,3.5,0)
	;;=^^11^11^2950824^^
	;;^UTILITY(U,$J,142.1,20,3.5,1,0)
	;;=This component contains information extracted from the Lab package. Not
	;;^UTILITY(U,$J,142.1,20,3.5,2,0)
	;;=only do time and maximum occurrence limits apply to this component, but
	;;^UTILITY(U,$J,142.1,20,3.5,3,0)
	;;=the user is allowed to select as many as seven atomic Lab tests. Data
	;;^UTILITY(U,$J,142.1,20,3.5,4,0)
	;;=presented include: collection date/time, specimen, test names with results
	;;^UTILITY(U,$J,142.1,20,3.5,5,0)
	;;=and reference flags in columnar (horizontal) format. Comments will also be
	;;^UTILITY(U,$J,142.1,20,3.5,6,0)
	;;=conditionally displayed, depending on the value of the DISPLAY COMMENTS ON
	;;^UTILITY(U,$J,142.1,20,3.5,7,0)
	;;=LABS Health Summary Site Parameter. When comments are displayed, a lower
	;;^UTILITY(U,$J,142.1,20,3.5,8,0)
	;;=case letter will be displayed to the left of the date for entries with
	;;^UTILITY(U,$J,142.1,20,3.5,9,0)
	;;=comments. Comments will be displayed after all the results are displayed
	;;^UTILITY(U,$J,142.1,20,3.5,10,0)
	;;=with comments being linked by the lower case letter. Up to 26 comments can
	;;^UTILITY(U,$J,142.1,20,3.5,11,0)
	;;=be included.
	;;^UTILITY(U,$J,142.1,21,0)
	;;=LAB CUMULATIVE SELECTED 4^MAIN;GMTSLRS7^Y^SCL4^Y^^^^Lab Cum Selected 4
	;;^UTILITY(U,$J,142.1,21,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,21,1,1,0)
	;;=60^7
	;;^UTILITY(U,$J,142.1,21,3.5,0)
	;;=^^11^11^2950824^
	;;^UTILITY(U,$J,142.1,21,3.5,1,0)
	;;=This component contains information extracted from the Lab package. Not
	;;^UTILITY(U,$J,142.1,21,3.5,2,0)
	;;=only do time and maximum occurrence limits apply to this component, but
	;;^UTILITY(U,$J,142.1,21,3.5,3,0)
	;;=the user is allowed to select as many as seven atomic Lab tests. Data
	;;^UTILITY(U,$J,142.1,21,3.5,4,0)
	;;=presented include: collection date/time, specimen, test names with results

GMTSI00L
GMTSI00L	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,21,3.5,5,0)
	;;=and reference flags in columnar (horizontal) format. Comments will also be
	;;^UTILITY(U,$J,142.1,21,3.5,6,0)
	;;=conditionally displayed, depending on the value of the DISPLAY COMMENTS ON
	;;^UTILITY(U,$J,142.1,21,3.5,7,0)
	;;=LABS Health Summary Site Parameter. When comments are displayed, a lower
	;;^UTILITY(U,$J,142.1,21,3.5,8,0)
	;;=case letter will be displayed to the left of the date for entries with
	;;^UTILITY(U,$J,142.1,21,3.5,9,0)
	;;=comments. Comments will be displayed after all the results are displayed
	;;^UTILITY(U,$J,142.1,21,3.5,10,0)
	;;=with comments being linked by the lower case letter. Up to 26 comments can
	;;^UTILITY(U,$J,142.1,21,3.5,11,0)
	;;=be included.
	;;^UTILITY(U,$J,142.1,23,0)
	;;=SURGERY REPORTS^ENSR;GMTSRO^Y^SR^Y^^^^Surgery Reports
	;;^UTILITY(U,$J,142.1,23,3.5,0)
	;;=^^7^7^2940427^^^^
	;;^UTILITY(U,$J,142.1,23,3.5,1,0)
	;;=This component contains information from the Surgery package.  Time and
	;;^UTILITY(U,$J,142.1,23,3.5,2,0)
	;;=maximum occurrence limits apply.  Data presented include:  surgery date,
	;;^UTILITY(U,$J,142.1,23,3.5,3,0)
	;;=surgeon, surgery report status, pre-operative diagnosis, post-operative
	;;^UTILITY(U,$J,142.1,23,3.5,4,0)
	;;=diagnosis, surgeon's dictation, current procedural terminology operation
	;;^UTILITY(U,$J,142.1,23,3.5,5,0)
	;;=code and text.
	;;^UTILITY(U,$J,142.1,23,3.5,6,0)
	;;= 
	;;^UTILITY(U,$J,142.1,23,3.5,7,0)
	;;=Only surgery reports which have been verified are reported.
	;;^UTILITY(U,$J,142.1,24,0)
	;;=MAS DISABILITIES^MAIN;GMTSDGD^^DS^^^^^Disabilities
	;;^UTILITY(U,$J,142.1,24,3.5,0)
	;;=^^4^4^2910203^^
	;;^UTILITY(U,$J,142.1,24,3.5,1,0)
	;;=This component provides information from the MAS package about a patient's
	;;^UTILITY(U,$J,142.1,24,3.5,2,0)
	;;=eligibility code and eligibility status (Verified), and rated disabilities,
	;;^UTILITY(U,$J,142.1,24,3.5,3,0)
	;;=including the disability percentage and whether the disability is service
	;;^UTILITY(U,$J,142.1,24,3.5,4,0)
	;;=connected or non-service connected.
	;;^UTILITY(U,$J,142.1,25,0)
	;;=ADVANCE DIRECTIVE^CD;GMTSCW^^CD^^^^^Advance Directive
	;;^UTILITY(U,$J,142.1,25,3.5,0)
	;;=^^10^10^2950905^
	;;^UTILITY(U,$J,142.1,25,3.5,1,0)
	;;=This component contains advance directive notes entered using the Generic
	;;^UTILITY(U,$J,142.1,25,3.5,2,0)
	;;=Progress Note package. Time and maximum occurrent limits apply to this
	;;^UTILITY(U,$J,142.1,25,3.5,3,0)
	;;=component.
	;;^UTILITY(U,$J,142.1,25,3.5,4,0)
	;;= 
	;;^UTILITY(U,$J,142.1,25,3.5,5,0)
	;;=Advance Directives are a type a progress note which includes clinical
	;;^UTILITY(U,$J,142.1,25,3.5,6,0)
	;;=information that clinicians need to be alerted to.
	;;^UTILITY(U,$J,142.1,25,3.5,7,0)
	;;= 
	;;^UTILITY(U,$J,142.1,25,3.5,8,0)
	;;=If this component is printed to either a CRT or another device type,
	;;^UTILITY(U,$J,142.1,25,3.5,9,0)
	;;=information will include title, text of note, electronic signature block,
	;;^UTILITY(U,$J,142.1,25,3.5,10,0)
	;;=and date/time posted.
	;;^UTILITY(U,$J,142.1,26,0)
	;;=PROGRESS NOTES BRIEF^MAIN;GMTSPNB^Y^BPN^Y^^^^Brief Progress Notes
	;;^UTILITY(U,$J,142.1,26,3.5,0)
	;;=^^8^8^2940427^^^^
	;;^UTILITY(U,$J,142.1,26,3.5,1,0)
	;;=This component contains information from the Mental Health and Generic
	;;^UTILITY(U,$J,142.1,26,3.5,2,0)
	;;=Progress Notes packages. Time and maximum occurrence limits apply.  Data
	;;^UTILITY(U,$J,142.1,26,3.5,3,0)
	;;=presented include:  Progress note date/time, title, author and last

GMTSI00M
GMTSI00M	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,26,3.5,4,0)
	;;=correction date/time.
	;;^UTILITY(U,$J,142.1,26,3.5,5,0)
	;;=  
	;;^UTILITY(U,$J,142.1,26,3.5,6,0)
	;;=Only those notes which have been signed with an electronic signature 
	;;^UTILITY(U,$J,142.1,26,3.5,7,0)
	;;=or (for generic progress notes) electronically marked signed on chart
	;;^UTILITY(U,$J,142.1,26,3.5,8,0)
	;;=will be listed.
	;;^UTILITY(U,$J,142.1,27,0)
	;;=SURGERY REPORTS BRIEF^ENSR;GMTSROB^Y^BSR^Y^^^^Brief Surgery Rpts
	;;^UTILITY(U,$J,142.1,27,3.5,0)
	;;=^^3^3^2940427^^^^
	;;^UTILITY(U,$J,142.1,27,3.5,1,0)
	;;=This component contains surgery report statuses extracted from the Surgery
	;;^UTILITY(U,$J,142.1,27,3.5,2,0)
	;;=package.  Time and maximum occurrence limits apply.  Data presented include:
	;;^UTILITY(U,$J,142.1,27,3.5,3,0)
	;;=surgery date, surgical procedure, and report status (e.g., COMPLETE).
	;;^UTILITY(U,$J,142.1,28,0)
	;;=PHARMACY OUTPATIENT^MAIN;GMTSPSO^Y^RXOP^^^^^Outpatient Pharmacy
	;;^UTILITY(U,$J,142.1,28,3.5,0)
	;;=^^10^10^2940705^
	;;^UTILITY(U,$J,142.1,28,3.5,1,0)
	;;=This component contains information from the Outpatient Pharmacy package.
	;;^UTILITY(U,$J,142.1,28,3.5,2,0)
	;;=Only time limits apply.  Data presented include:  drug, prescription number,
	;;^UTILITY(U,$J,142.1,28,3.5,3,0)
	;;=status expiration/cancellation date (when appropriate), quantity, issue
	;;^UTILITY(U,$J,142.1,28,3.5,4,0)
	;;=date, last fill date, refills remaining, provider, and cost/fill (when
	;;^UTILITY(U,$J,142.1,28,3.5,5,0)
	;;=available).
	;;^UTILITY(U,$J,142.1,28,3.5,6,0)
	;;= 
	;;^UTILITY(U,$J,142.1,28,3.5,7,0)
	;;=Note: If no time limit is defined, only active outpatient orders are
	;;^UTILITY(U,$J,142.1,28,3.5,8,0)
	;;=reported. If a time limit is defined, all outpatient pharmacy orders which
	;;^UTILITY(U,$J,142.1,28,3.5,9,0)
	;;=have an expiration or cancel date within the time limit range are
	;;^UTILITY(U,$J,142.1,28,3.5,10,0)
	;;=reported.
	;;^UTILITY(U,$J,142.1,29,0)
	;;=PHARMACY UNIT DOSE^MAIN;GMTSPSG^Y^RXUD^^^^^Unit Dose Pharmacy
	;;^UTILITY(U,$J,142.1,29,3.5,0)
	;;=^^8^8^2950216^^^^
	;;^UTILITY(U,$J,142.1,29,3.5,1,0)
	;;=This component contains Unit Dose information extracted from the Pharmacy
	;;^UTILITY(U,$J,142.1,29,3.5,2,0)
	;;=package.  Only time limits apply.  Data presented include:  Drug, dose,
	;;^UTILITY(U,$J,142.1,29,3.5,3,0)
	;;=pharmacy status, start date, stop date, and sig (which includes schedule
	;;^UTILITY(U,$J,142.1,29,3.5,4,0)
	;;=instructions and route).
	;;^UTILITY(U,$J,142.1,29,3.5,5,0)
	;;=  
	;;^UTILITY(U,$J,142.1,29,3.5,6,0)
	;;=NOTE: If no time limit is defined, all active orders are reported.  
	;;^UTILITY(U,$J,142.1,29,3.5,7,0)
	;;=If a time limit is defined, all unit dose orders which have an expiration or
	;;^UTILITY(U,$J,142.1,29,3.5,8,0)
	;;=cancel date within the time limit range are reported.
	;;^UTILITY(U,$J,142.1,30,0)
	;;=PHARMACY INTRAVENOUS^MAIN;GMTSPSI^Y^RXIV^^^^^IV Pharmacy
	;;^UTILITY(U,$J,142.1,30,3.5,0)
	;;=^^7^7^2940705^^^^
	;;^UTILITY(U,$J,142.1,30,3.5,1,0)
	;;=This component contains IV orders extracted from the Pharmacy package.
	;;^UTILITY(U,$J,142.1,30,3.5,2,0)
	;;=Only time limits apply.  Data presented include:  start date, stop date,
	;;^UTILITY(U,$J,142.1,30,3.5,3,0)
	;;=drug (additives), dose, status, solutions and infusion rates.
	;;^UTILITY(U,$J,142.1,30,3.5,4,0)
	;;= 
	;;^UTILITY(U,$J,142.1,30,3.5,5,0)
	;;=Note: If no time limit is defined, only active IV orders are reported.
	;;^UTILITY(U,$J,142.1,30,3.5,6,0)
	;;=If a time limit is defined, all IV orders which have an expiration or

GMTSI00N
GMTSI00N	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,30,3.5,7,0)
	;;=cancel date within the time limit range are reported.
	;;^UTILITY(U,$J,142.1,31,0)
	;;=LAB ORDERS BRIEF^MAIN;GMTSLROB^Y^BLO^Y^^^^Brief Lab Orders
	;;^UTILITY(U,$J,142.1,31,3.5,0)
	;;=^^4^4^2921117^^^
	;;^UTILITY(U,$J,142.1,31,3.5,1,0)
	;;=This component contains information extracted from the Lab package.
	;;^UTILITY(U,$J,142.1,31,3.5,2,0)
	;;=Time and maximum occurrence limits apply.Data presented include:
	;;^UTILITY(U,$J,142.1,31,3.5,3,0)
	;;=collection date/time, lab test name, specimen, urgency, and order
	;;^UTILITY(U,$J,142.1,31,3.5,4,0)
	;;=status (e.g., ORDERED, COLLECTED, PROCESSING, COMPLETE).
	;;^UTILITY(U,$J,142.1,32,0)
	;;=LAB ORDERS^MAIN;GMTSLROS^Y^LO^Y^^^^Lab Orders
	;;^UTILITY(U,$J,142.1,32,3.5,0)
	;;=^^4^4^2910114^^
	;;^UTILITY(U,$J,142.1,32,3.5,1,0)
	;;=This component contains information extracted from the Lab package.
	;;^UTILITY(U,$J,142.1,32,3.5,2,0)
	;;=Time and maximum occurrence limits apply. Data presented include:
	;;^UTILITY(U,$J,142.1,32,3.5,3,0)
	;;=collection date (either actual or expected), lab test, provider,
	;;^UTILITY(U,$J,142.1,32,3.5,4,0)
	;;=accession, date/time ordered, specimen, and date/time results available.
	;;^UTILITY(U,$J,142.1,33,0)
	;;=LAB TESTS SELECTED^MAIN;GMTSLRS^Y^SLT^Y^^^^Lab Tests Selected
	;;^UTILITY(U,$J,142.1,33,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,33,1,1,0)
	;;=60
	;;^UTILITY(U,$J,142.1,33,3.5,0)
	;;=^^11^11^2950824^
	;;^UTILITY(U,$J,142.1,33,3.5,1,0)
	;;=This component contains information extracted from the Lab package. Not
	;;^UTILITY(U,$J,142.1,33,3.5,2,0)
	;;=only do time and maximum occurrence limits apply to this component, but
	;;^UTILITY(U,$J,142.1,33,3.5,3,0)
	;;=the user is allowed to select any number of atomic Lab tests. Data
	;;^UTILITY(U,$J,142.1,33,3.5,4,0)
	;;=includes: collection date/time, specimen, test name, result, units and
	;;^UTILITY(U,$J,142.1,33,3.5,5,0)
	;;=reference range. Comments will also be conditionally displayed, depending
	;;^UTILITY(U,$J,142.1,33,3.5,6,0)
	;;=on the value of the DISPLAY COMMENTS ON LABS Health Summary Site
	;;^UTILITY(U,$J,142.1,33,3.5,7,0)
	;;=Parameter. Results which include comments will be indicated with the
	;;^UTILITY(U,$J,142.1,33,3.5,8,0)
	;;=symbol !!, in the event that the parameter is set to 0 or NO. 
	;;^UTILITY(U,$J,142.1,33,3.5,9,0)
	;;= 
	;;^UTILITY(U,$J,142.1,33,3.5,10,0)
	;;=Note: This component corresponds to the vertical format for the Lab
	;;^UTILITY(U,$J,142.1,33,3.5,11,0)
	;;=package's cumulative reports.
	;;^UTILITY(U,$J,142.1,34,0)
	;;=RADIOLOGY STATUS^ENRAD;GMTSRAD^Y^RS^Y^^^^Radiology Status
	;;^UTILITY(U,$J,142.1,34,3.5,0)
	;;=^^3^3^2950905^
	;;^UTILITY(U,$J,142.1,34,3.5,1,0)
	;;=This component contains procedure statuses from the Radiology package.
	;;^UTILITY(U,$J,142.1,34,3.5,2,0)
	;;=Time and maximum occurrence limits apply. Data presented include: request
	;;^UTILITY(U,$J,142.1,34,3.5,3,0)
	;;=date/time, status, procedure, scheduled date/time, and provider name.
	;;^UTILITY(U,$J,142.1,35,0)
	;;=RADIOLOGY PROFILE^ENSRA;GMTSRAS^Y^RP^Y^^^^Radiology Profile
	;;^UTILITY(U,$J,142.1,35,3.5,0)
	;;=^^7^7^2940427^^^^
	;;^UTILITY(U,$J,142.1,35,3.5,1,0)
	;;=This component contains information from the Radiology package.  Time
	;;^UTILITY(U,$J,142.1,35,3.5,2,0)
	;;=and maximum occurrence limits apply.  Data presented include:  study date,
	;;^UTILITY(U,$J,142.1,35,3.5,3,0)
	;;=procedure(s) with status(es), report status, staff radiologist, resident
	;;^UTILITY(U,$J,142.1,35,3.5,4,0)
	;;=radiologist, and the narrative fields modifier, history, report, and

GMTSI00O
GMTSI00O	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,35,3.5,5,0)
	;;=impression.
	;;^UTILITY(U,$J,142.1,35,3.5,6,0)
	;;= 
	;;^UTILITY(U,$J,142.1,35,3.5,7,0)
	;;=Only radiology profiles which have been verified are reported.
	;;^UTILITY(U,$J,142.1,36,0)
	;;=LAB BLOOD TRANSFUSIONS^MAIN;GMTSLRT^Y^BT^Y^^^^Blood Transfusions
	;;^UTILITY(U,$J,142.1,36,3.5,0)
	;;=^^6^6^2920218^^^
	;;^UTILITY(U,$J,142.1,36,3.5,1,0)
	;;=This component contains information from the Blood Bank module of the
	;;^UTILITY(U,$J,142.1,36,3.5,2,0)
	;;=Lab Package.  Time and occurrence limits apply to this component.  Data
	;;^UTILITY(U,$J,142.1,36,3.5,3,0)
	;;=presented include:  transfusion date and abbreviated blood products
	;;^UTILITY(U,$J,142.1,36,3.5,4,0)
	;;=(with total number of units transfused for each, e.g., RBC (2)).
	;;^UTILITY(U,$J,142.1,36,3.5,5,0)
	;;=A key of the abbreviations is presented at the bottom of the display
	;;^UTILITY(U,$J,142.1,36,3.5,6,0)
	;;=to help identify any unfamiliar blood products.
	;;^UTILITY(U,$J,142.1,37,0)
	;;=LAB MICROBIOLOGY BRIEF^MAIN;GMTSLRMB^Y^BMIC^Y^^^^Brief Microbiology
	;;^UTILITY(U,$J,142.1,37,3.5,0)
	;;=^^5^5^2950616^
	;;^UTILITY(U,$J,142.1,37,3.5,1,0)
	;;=This component contains information extracted from the Lab package. Time
	;;^UTILITY(U,$J,142.1,37,3.5,2,0)
	;;=and maximum occurrence limits apply to this component in addition to
	;;^UTILITY(U,$J,142.1,37,3.5,3,0)
	;;=collection date/time, test names, specimen, report status, Culture and
	;;^UTILITY(U,$J,142.1,37,3.5,4,0)
	;;=Susceptibility, Smear/Prep, Acid Fast Stain, Antibiotic Serum Level, and
	;;^UTILITY(U,$J,142.1,37,3.5,5,0)
	;;=test results.
	;;^UTILITY(U,$J,142.1,38,0)
	;;=LAB MICROBIOLOGY^MAIN;GMTSLRM^Y^MIC^Y^^^^Microbiology
	;;^UTILITY(U,$J,142.1,38,3.5,0)
	;;=^^8^8^2950705^^
	;;^UTILITY(U,$J,142.1,38,3.5,1,0)
	;;=This component contains information extracted from the Microbiology module
	;;^UTILITY(U,$J,142.1,38,3.5,2,0)
	;;=of the Lab Package.  Time and maximum occurrence limits apply. Data
	;;^UTILITY(U,$J,142.1,38,3.5,3,0)
	;;=include:  collection date/time, collection sample, site/specimen,
	;;^UTILITY(U,$J,142.1,38,3.5,4,0)
	;;=specimen comment, tests, urine screen, sputum screen, sterility control,
	;;^UTILITY(U,$J,142.1,38,3.5,5,0)
	;;=sterility results, comments for reports, smear/prep, acid fast stain
	;;^UTILITY(U,$J,142.1,38,3.5,6,0)
	;;=Parasite Report, organism(s), Mycology Report, Bacteriology Report,
	;;^UTILITY(U,$J,142.1,38,3.5,7,0)
	;;=Mycobacteriology Report, Gram Stain Result, Culture and Susceptibility,
	;;^UTILITY(U,$J,142.1,38,3.5,8,0)
	;;=Antibiotic Serum Level, and remarks.
	;;^UTILITY(U,$J,142.1,43,0)
	;;=LAB CUMULATIVE SELECTED^MAIN;GMTSLRSC^Y^SCLU^Y^^^^Lab Cum Selected
	;;^UTILITY(U,$J,142.1,43,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,43,1,1,0)
	;;=60
	;;^UTILITY(U,$J,142.1,43,3.5,0)
	;;=^^11^11^2950824^
	;;^UTILITY(U,$J,142.1,43,3.5,1,0)
	;;=This component contains information extracted from the Lab package. Not
	;;^UTILITY(U,$J,142.1,43,3.5,2,0)
	;;=only do time and maximum occurrence limits apply to this component, but
	;;^UTILITY(U,$J,142.1,43,3.5,3,0)
	;;=the user is allowed to select any number of atomic Lab tests. Data
	;;^UTILITY(U,$J,142.1,43,3.5,4,0)
	;;=presented include:  collection date/time, specimen, test names with
	;;^UTILITY(U,$J,142.1,43,3.5,5,0)
	;;=results and reference flags in columnar (horizontal) format. Comments will
	;;^UTILITY(U,$J,142.1,43,3.5,6,0)
	;;=also be conditionally displayed, depending on the value of the DISPLAY
	;;^UTILITY(U,$J,142.1,43,3.5,7,0)
	;;=COMMENTS ON LABS Health Summary Site Parameter. When comments are

GMTSI00P
GMTSI00P	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,43,3.5,8,0)
	;;=displayed, a lower case letter will be displayed to the left of the date
	;;^UTILITY(U,$J,142.1,43,3.5,9,0)
	;;=for entries with comments. Comments will be displayed after all the
	;;^UTILITY(U,$J,142.1,43,3.5,10,0)
	;;=results are displayed with comments being linked by the lower case letter.
	;;^UTILITY(U,$J,142.1,43,3.5,11,0)
	;;=Up to 26 comments can be included.
	;;^UTILITY(U,$J,142.1,45,0)
	;;=LAB BLOOD AVAILABILITY^MAIN;GMTSLRB^Y^BA^Y^^^^Blood Availability
	;;^UTILITY(U,$J,142.1,45,3.5,0)
	;;=^^8^8^2950905^
	;;^UTILITY(U,$J,142.1,45,3.5,1,0)
	;;=This component contains information from the Blood Bank module of the Lab
	;;^UTILITY(U,$J,142.1,45,3.5,2,0)
	;;=Package. Time and occurrence limits apply to this component. Data
	;;^UTILITY(U,$J,142.1,45,3.5,3,0)
	;;=presented include: patient blood type (whether or not units have been
	;;^UTILITY(U,$J,142.1,45,3.5,4,0)
	;;=assigned), unit expiration date, unit ID#, blood product(s), cross-match
	;;^UTILITY(U,$J,142.1,45,3.5,5,0)
	;;=results, last known location, and a flag for autologous units. 
	;;^UTILITY(U,$J,142.1,45,3.5,6,0)
	;;= 
	;;^UTILITY(U,$J,142.1,45,3.5,7,0)
	;;=Note:  An asterisked date (e.g., * 10/10/90) indicates that the unit is
	;;^UTILITY(U,$J,142.1,45,3.5,8,0)
	;;=due to expire within the next 48 hours.
	;;^UTILITY(U,$J,142.1,46,0)
	;;=LAB SURGICAL PATHOLOGY^MAIN;GMTSLRA^Y^SP^Y^^^^Surgical Pathology
	;;^UTILITY(U,$J,142.1,46,3.5,0)
	;;=^^6^6^2950616^
	;;^UTILITY(U,$J,142.1,46,3.5,1,0)
	;;=This component contains information extracted from the Surgical Pathology
	;;^UTILITY(U,$J,142.1,46,3.5,2,0)
	;;=module of the Lab package. Time and maximum occurrence limits apply. Data
	;;^UTILITY(U,$J,142.1,46,3.5,3,0)
	;;=presented include:  collection date/time, accession number, specimen,
	;;^UTILITY(U,$J,142.1,46,3.5,4,0)
	;;=gross description, microscopic description, brief clinical history,
	;;^UTILITY(U,$J,142.1,46,3.5,5,0)
	;;=supplementary report description, frozen section and surgical path
	;;^UTILITY(U,$J,142.1,46,3.5,6,0)
	;;=diagnosis.
	;;^UTILITY(U,$J,142.1,47,0)
	;;=VITAL SIGNS^ENVS;GMTSVS^Y^VS^Y^^^^Vital Signs
	;;^UTILITY(U,$J,142.1,47,3.5,0)
	;;=^^4^4^2910203^^^
	;;^UTILITY(U,$J,142.1,47,3.5,1,0)
	;;=This component contains vital measurements extracted from the Vital Signs
	;;^UTILITY(U,$J,142.1,47,3.5,2,0)
	;;=module of the Nursing package.  Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,142.1,47,3.5,3,0)
	;;=Data presented include:  measurement date/time, blood pressure (as SBP/DBP),
	;;^UTILITY(U,$J,142.1,47,3.5,4,0)
	;;=pulse, temperature, height, weight, and respiratory rate.
	;;^UTILITY(U,$J,142.1,48,0)
	;;=LAB CYTOPATHOLOGY^MAIN;GMTSLRCP^Y^CY^Y^^^^Cytopathology
	;;^UTILITY(U,$J,142.1,48,3.5,0)
	;;=^^5^5^2950705^^
	;;^UTILITY(U,$J,142.1,48,3.5,1,0)
	;;=This component contains information extracted from the Cytopathology
	;;^UTILITY(U,$J,142.1,48,3.5,2,0)
	;;=module of the Lab package. Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,142.1,48,3.5,3,0)
	;;=Data presented include:  collection date/time, accession number,
	;;^UTILITY(U,$J,142.1,48,3.5,4,0)
	;;=specimen, gross description, microscopic exam, brief clinical history,
	;;^UTILITY(U,$J,142.1,48,3.5,5,0)
	;;=and Cytopathology Diagnosis.
	;;^UTILITY(U,$J,142.1,49,0)
	;;=VITAL SIGNS SELECTED^ENVS;GMTSVSS^Y^SVS^Y^^^^Vital Signs Selected
	;;^UTILITY(U,$J,142.1,49,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,49,1,1,0)
	;;=120.51
	;;^UTILITY(U,$J,142.1,49,3.5,0)
	;;=^^7^7^2910203^^^^

GMTSI00Q
GMTSI00Q	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,49,3.5,1,0)
	;;=This component contains selected vital measurements extracted from the Vital
	;;^UTILITY(U,$J,142.1,49,3.5,2,0)
	;;=Signs module of the Nursing package.  Time and maximum occurrence limits
	;;^UTILITY(U,$J,142.1,49,3.5,3,0)
	;;=apply, and the user is allowed to select any of the vital measurement types
	;;^UTILITY(U,$J,142.1,49,3.5,4,0)
	;;=defined in the Vital Type file (e.g., pulse, blood pressure, temperature,
	;;^UTILITY(U,$J,142.1,49,3.5,5,0)
	;;=height, weight, and respiration rate).  Data presented include:
	;;^UTILITY(U,$J,142.1,49,3.5,6,0)
	;;=measurement date/time, measurement type and measurement value.
	;;^UTILITY(U,$J,142.1,49,3.5,7,0)
	;;=Note: Formatted display is horizontal.
	;;^UTILITY(U,$J,142.1,50,0)
	;;=MAS PROCEDURES ICD CODES^ENP;GMTSDGP^Y^PRC^Y^^^^ICD Procedures
	;;^UTILITY(U,$J,142.1,50,3.5,0)
	;;=^^6^6^2910203^^^^
	;;^UTILITY(U,$J,142.1,50,3.5,1,0)
	;;=This component contains MAS coded procedures, by admission, extracted from
	;;^UTILITY(U,$J,142.1,50,3.5,2,0)
	;;=the MAS package.  Time and occurrence limits apply to this component.  Data
	;;^UTILITY(U,$J,142.1,50,3.5,3,0)
	;;=presented include:  procedure date, procedure name, and ICD-9CM procedure
	;;^UTILITY(U,$J,142.1,50,3.5,4,0)
	;;=codes.
	;;^UTILITY(U,$J,142.1,50,3.5,5,0)
	;;=  
	;;^UTILITY(U,$J,142.1,50,3.5,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.
	;;^UTILITY(U,$J,142.1,51,0)
	;;=MEDICINE SUMMARY^BEG;GMTSMCPS^Y^MEDS^Y^^^^Med (1 line) Summary
	;;^UTILITY(U,$J,142.1,51,3.5,0)
	;;=^^5^5^2950418^^
	;;^UTILITY(U,$J,142.1,51,3.5,1,0)
	;;=This component provides a one line summary view of Medicine procedures
	;;^UTILITY(U,$J,142.1,51,3.5,2,0)
	;;=which is extracted from the Medicine package. Time and maximum occurrence
	;;^UTILITY(U,$J,142.1,51,3.5,3,0)
	;;=limits apply.  Data presented include: procedure date/time, medical
	;;^UTILITY(U,$J,142.1,51,3.5,4,0)
	;;=procedure name, and result (e.g., normal, abnormal, borderline).  Note:
	;;^UTILITY(U,$J,142.1,51,3.5,5,0)
	;;=This component is a summary of procedure statuses.
	;;^UTILITY(U,$J,142.1,52,0)
	;;=RADIOLOGY IMPRESSION^ENSRA;GMTSRAI^Y^RI^Y^^^^Radiology Impression
	;;^UTILITY(U,$J,142.1,52,3.5,0)
	;;=^^5^5^2940427^^^^
	;;^UTILITY(U,$J,142.1,52,3.5,1,0)
	;;=This component contains impressions from the Radiology package.  Time and
	;;^UTILITY(U,$J,142.1,52,3.5,2,0)
	;;=maximum occurrence limits apply.  Data presented include:  study date,
	;;^UTILITY(U,$J,142.1,52,3.5,3,0)
	;;=procedure(s), status, and radiologist's impression (narrative).
	;;^UTILITY(U,$J,142.1,52,3.5,4,0)
	;;= 
	;;^UTILITY(U,$J,142.1,52,3.5,5,0)
	;;=Only radiology impressions which have been verified are reported.
	;;^UTILITY(U,$J,142.1,54,0)
	;;=ORDERS CURRENT^MAIN;GMTSORC^Y^ORC^^^^^Current Orders
	;;^UTILITY(U,$J,142.1,54,3.5,0)
	;;=^^11^11^2950823^^^^
	;;^UTILITY(U,$J,142.1,54,3.5,1,0)
	;;=This component contains current orders from the OE/RR package.  Since the  
	;;^UTILITY(U,$J,142.1,54,3.5,2,0)
	;;=OE/RR package integrates all orders for the ancillary services, the orders
	;;^UTILITY(U,$J,142.1,54,3.5,3,0)
	;;=will be reported in most recent orders first sequence without concern 
	;;^UTILITY(U,$J,142.1,54,3.5,4,0)
	;;=for the ancillary package the order originated from/for. Current orders
	;;^UTILITY(U,$J,142.1,54,3.5,5,0)
	;;=are defined as those orders with an OE/RR order status other than
	;;^UTILITY(U,$J,142.1,54,3.5,6,0)
	;;=discontinued or expired.
	;;^UTILITY(U,$J,142.1,54,3.5,7,0)
	;;=  

GMTSI00R
GMTSI00R	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,54,3.5,8,0)
	;;=The component information includes item ordered, OE/RR order status, 
	;;^UTILITY(U,$J,142.1,54,3.5,9,0)
	;;=start date, and stop date. OE/RR order status abbreviations include
	;;^UTILITY(U,$J,142.1,54,3.5,10,0)
	;;="blank"=Active, "c"=Complete, "dc"=Discontinued, "e"= expired, "?"=Flagged,
	;;^UTILITY(U,$J,142.1,54,3.5,11,0)
	;;="h"=Hold, "i"=incomplete, "p"=pending, "s"=scheduled.
	;;^UTILITY(U,$J,142.1,55,0)
	;;=MAS ADT HISTORY^MAIN;GMTSDGH^Y^ADT^Y^^^^ADT History
	;;^UTILITY(U,$J,142.1,55,3.5,0)
	;;=^^6^6^2910203^^^^
	;;^UTILITY(U,$J,142.1,55,3.5,1,0)
	;;=This component contains information extracted from the MAS package.
	;;^UTILITY(U,$J,142.1,55,3.5,2,0)
	;;=It can only be used with MAS Version 5 and up.
	;;^UTILITY(U,$J,142.1,55,3.5,3,0)
	;;=  
	;;^UTILITY(U,$J,142.1,55,3.5,4,0)
	;;=Time and maximum occurrence limits apply.  Data presented include:
	;;^UTILITY(U,$J,142.1,55,3.5,5,0)
	;;=movement date, movement type (ADM=Admission, TR=Transfer, TS= Treating
	;;^UTILITY(U,$J,142.1,55,3.5,6,0)
	;;=Specialty, DC=Discharge), movement description, specialty, and provider.
	;;^UTILITY(U,$J,142.1,56,0)
	;;=RADIOLOGY IMPRESSION SELECTED^MAIN;GMTSRASP^Y^SRI^Y^^^^Sel Rad Impression
	;;^UTILITY(U,$J,142.1,56,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,56,1,1,0)
	;;=71
	;;^UTILITY(U,$J,142.1,56,3.5,0)
	;;=^^6^6^2940427^^^^
	;;^UTILITY(U,$J,142.1,56,3.5,1,0)
	;;=This component contains impressions from the Radiology package.  Time
	;;^UTILITY(U,$J,142.1,56,3.5,2,0)
	;;=and occurrence limits apply.  Data presented include:  study date,
	;;^UTILITY(U,$J,142.1,56,3.5,3,0)
	;;=procedure(s), status and radiologist's impression (narrative) for the
	;;^UTILITY(U,$J,142.1,56,3.5,4,0)
	;;=procedures selected by the user (e.g., CHEST 2 VIEWS - PA & LAT).
	;;^UTILITY(U,$J,142.1,56,3.5,5,0)
	;;= 
	;;^UTILITY(U,$J,142.1,56,3.5,6,0)
	;;=Only radiology impressions which have been verified are reported.
	;;^UTILITY(U,$J,142.1,57,0)
	;;=DISCHARGE SUMMARY^MAIN;GMTSDS^Y^DCS^Y^^^^Discharge Summary
	;;^UTILITY(U,$J,142.1,57,3.5,0)
	;;=^^2^2^2950823^^^^
	;;^UTILITY(U,$J,142.1,57,3.5,1,0)
	;;=This component prints all discharge summaries (including report text) for
	;;^UTILITY(U,$J,142.1,57,3.5,2,0)
	;;=user-specified time and occurrence limits.
	;;^UTILITY(U,$J,142.1,58,0)
	;;=DISCHARGE SUMMARY BRIEF^MAIN;GMTSDSB^Y^BDS^Y^^^^Brief Disch Summary
	;;^UTILITY(U,$J,142.1,58,3.5,0)
	;;=^^3^3^2931112^
	;;^UTILITY(U,$J,142.1,58,3.5,1,0)
	;;=This component prints the admission, discharge and cosignature dates, as
	;;^UTILITY(U,$J,142.1,58,3.5,2,0)
	;;=the dictating and approving provider names, and signature status of
	;;^UTILITY(U,$J,142.1,58,3.5,3,0)
	;;=all discharge summaries for user-specified time and occurrence limits.
	;;^UTILITY(U,$J,142.1,59,0)
	;;=PROBLEM LIST ACTIVE^ACTIVE;GMTSPLST^^PLA^^^^^Active Problems^^Y^Y
	;;^UTILITY(U,$J,142.1,59,3.5,0)
	;;=^^5^5^2950905^
	;;^UTILITY(U,$J,142.1,59,3.5,1,0)
	;;=This component lists all known active problems for a patient. Information
	;;^UTILITY(U,$J,142.1,59,3.5,2,0)
	;;=displayed: ICD data (based on ICD Text Display parameter), provider
	;;^UTILITY(U,$J,142.1,59,3.5,3,0)
	;;=narrative (unless Provider Narrative Display parameter is set to NO), date
	;;^UTILITY(U,$J,142.1,59,3.5,4,0)
	;;=of onset, date last modified, the responsible provider, and all active
	;;^UTILITY(U,$J,142.1,59,3.5,5,0)
	;;=comments.
	;;^UTILITY(U,$J,142.1,60,0)
	;;=PROBLEM LIST INACTIVE^INACT;GMTSPLST^^PLI^^^^^Inactive Problems^^Y^Y

GMTSI00S
GMTSI00S	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,60,3.5,0)
	;;=^^5^5^2950905^
	;;^UTILITY(U,$J,142.1,60,3.5,1,0)
	;;=This component lists all known inactive problems for a patient.
	;;^UTILITY(U,$J,142.1,60,3.5,2,0)
	;;=Information displayed: ICD data (based on ICD Text Display parameter),
	;;^UTILITY(U,$J,142.1,60,3.5,3,0)
	;;=provider narrative (unless Provider Narrative Display parameter is set to
	;;^UTILITY(U,$J,142.1,60,3.5,4,0)
	;;=NO), date problem resolved, date last modified, the responsible provider,
	;;^UTILITY(U,$J,142.1,60,3.5,5,0)
	;;=and all active comments for the problem.
	;;^UTILITY(U,$J,142.1,61,0)
	;;=PROBLEM LIST ALL^ALL;GMTSPLST^^PLL^^^^^All Problems^^Y^Y
	;;^UTILITY(U,$J,142.1,61,3.5,0)
	;;=^^6^6^2950905^
	;;^UTILITY(U,$J,142.1,61,3.5,1,0)
	;;=This component lists all known problems, both active and inactive, for a
	;;^UTILITY(U,$J,142.1,61,3.5,2,0)
	;;=patient. Information displayed: ICD data (based on ICD Text Display
	;;^UTILITY(U,$J,142.1,61,3.5,3,0)
	;;=parameter), provider narrative (unless Provider Narrative Display
	;;^UTILITY(U,$J,142.1,61,3.5,4,0)
	;;=parameter is set to NO), date of onset (if problem is active), date
	;;^UTILITY(U,$J,142.1,61,3.5,5,0)
	;;=problem resolved (if inactive), date last modified, the responsible
	;;^UTILITY(U,$J,142.1,61,3.5,6,0)
	;;=provider, and all active comments for the problems.
	;;^UTILITY(U,$J,142.1,62,0)
	;;=SOCIAL WORK^MAIN;GMTSSOWK^^SW^^^^^Social Work
	;;^UTILITY(U,$J,142.1,62,3.5,0)
	;;=^^3^3^2940706^
	;;^UTILITY(U,$J,142.1,62,3.5,1,0)
	;;=This component provides information from the Social Work package about a
	;;^UTILITY(U,$J,142.1,62,3.5,2,0)
	;;=patient's Social/Family Relationship, Current Substance Abuse Problems,
	;;^UTILITY(U,$J,142.1,62,3.5,3,0)
	;;=and Psycho-Social Assessment.
	;;^UTILITY(U,$J,142.1,64,0)
	;;=MAS ADT HISTORY EXPANDED^MAIN;GMTSDGCH^Y^EADT^Y^^^^ADT History Expanded
	;;^UTILITY(U,$J,142.1,64,3.5,0)
	;;=^^14^14^2950905^
	;;^UTILITY(U,$J,142.1,64,3.5,1,0)
	;;=This component contains information extracted from the MAS package. It is
	;;^UTILITY(U,$J,142.1,64,3.5,2,0)
	;;=a consolidated view of all the MAS components. It can only be used with
	;;^UTILITY(U,$J,142.1,64,3.5,3,0)
	;;=MAS Version 5 and up.
	;;^UTILITY(U,$J,142.1,64,3.5,4,0)
	;;= 
	;;^UTILITY(U,$J,142.1,64,3.5,5,0)
	;;=Time and maximum occurrence limits apply. Data presented include patient
	;;^UTILITY(U,$J,142.1,64,3.5,6,0)
	;;=eligibility and rated disabilities. Movement data then follows with
	;;^UTILITY(U,$J,142.1,64,3.5,7,0)
	;;=movement date, movement type (ADM=Admission, TR=Transfer, TS= Treating
	;;^UTILITY(U,$J,142.1,64,3.5,8,0)
	;;=Specialty, DC=Discharge), movement description, specialty, and provider.
	;;^UTILITY(U,$J,142.1,64,3.5,9,0)
	;;=Admissions include the admission diagnosis if the patient hasn't been
	;;^UTILITY(U,$J,142.1,64,3.5,10,0)
	;;=discharged. Transfers included ward location and transfer facility.
	;;^UTILITY(U,$J,142.1,64,3.5,11,0)
	;;=Treating specialties includes Specialty Tranfers Diagnosis. Dicharges
	;;^UTILITY(U,$J,142.1,64,3.5,12,0)
	;;=include the data in the Discharge Diagnosis and Discharges components.
	;;^UTILITY(U,$J,142.1,64,3.5,13,0)
	;;=Following the data for each admission ICD Procedures, and ICD Surgeries
	;;^UTILITY(U,$J,142.1,64,3.5,14,0)
	;;=will be include if present.
	;;^UTILITY(U,$J,142.1,65,0)
	;;=COMPENSATION AND PENSION EXAMS^MAIN;GMTSAMIE^Y^CP^Y^^^^Comp. & Pen. Exams
	;;^UTILITY(U,$J,142.1,65,3.5,0)
	;;=^^2^2^2950223^^^^
	;;^UTILITY(U,$J,142.1,65,3.5,1,0)
	;;=This component prints all compensation and pension exams for a given

GMTSI00T
GMTSI00T	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,65,3.5,2,0)
	;;=patient by user-specified time and occurrence limits.
	;;^UTILITY(U,$J,142.1,66,0)
	;;=MEDICINE ABNORMAL BRIEF^ABN;GMTSMCPS^Y^MEDA^Y^^^^Med Abnormal
	;;^UTILITY(U,$J,142.1,66,3.5,0)
	;;=4^^4^4^2950418^^^^
	;;^UTILITY(U,$J,142.1,66,3.5,1,0)
	;;=This component contains information extracted from the Medicine
	;;^UTILITY(U,$J,142.1,66,3.5,2,0)
	;;=package.  Data presented include:  procedure date/time, medical
	;;^UTILITY(U,$J,142.1,66,3.5,3,0)
	;;=procedure name, and result (e.g., normal, abnormal, borderline).  
	;;^UTILITY(U,$J,142.1,66,3.5,4,0)
	;;=Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,142.1,67,0)
	;;=MEDICINE BRIEF REPORT^BRIEF;GMTSMCPS^Y^MEDB^Y^^^^Med Brief Report
	;;^UTILITY(U,$J,142.1,67,3.5,0)
	;;=^^3^3^2950418^^^
	;;^UTILITY(U,$J,142.1,67,3.5,1,0)
	;;=This is the brief procedure view defined by the Medicine View file.
	;;^UTILITY(U,$J,142.1,67,3.5,2,0)
	;;=This output can be managed by the local IRM staff.
	;;^UTILITY(U,$J,142.1,67,3.5,3,0)
	;;=Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,142.1,68,0)
	;;=MEDICINE FULL CAPTIONED^CAP;GMTSMCPS^Y^MEDC^Y^^^^Med Full Captioned
	;;^UTILITY(U,$J,142.1,68,3.5,0)
	;;=^^4^4^2950418^^^^
	;;^UTILITY(U,$J,142.1,68,3.5,1,0)
	;;=This prints the full set of results which are present in
	;;^UTILITY(U,$J,142.1,68,3.5,2,0)
	;;=each procedure.  No labels will be included which have no
	;;^UTILITY(U,$J,142.1,68,3.5,3,0)
	;;=values associated with them.
	;;^UTILITY(U,$J,142.1,68,3.5,4,0)
	;;=Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,142.1,69,0)
	;;=MEDICINE FULL REPORT^FULL;GMTSMCPS^Y^MEDF^Y^^^^Med Full Report
	;;^UTILITY(U,$J,142.1,69,3.5,0)
	;;=^^4^4^2950418^^^
	;;^UTILITY(U,$J,142.1,69,3.5,1,0)
	;;=This component provides a full report of procedures as defined by the
	;;^UTILITY(U,$J,142.1,69,3.5,2,0)
	;;=Medicine View file.  This report includes labels which have no value
	;;^UTILITY(U,$J,142.1,69,3.5,3,0)
	;;=associated with them.
	;;^UTILITY(U,$J,142.1,69,3.5,4,0)
	;;=Time and maximum occurence limits apply.
	;;^UTILITY(U,$J,142.1,71,0)
	;;=MENTAL HEALTH PHYSICAL EXAM^MAIN;GMTSMHPE^Y^MHPE^Y^^^^MH Physical Exam
	;;^UTILITY(U,$J,142.1,71,3.5,0)
	;;=^^4^4^2950823^
	;;^UTILITY(U,$J,142.1,71,3.5,1,0)
	;;=The Mental Health Physical Exam component contains the results of the
	;;^UTILITY(U,$J,142.1,71,3.5,2,0)
	;;=physical examination concerning patient's overall condition associated
	;;^UTILITY(U,$J,142.1,71,3.5,3,0)
	;;=with the systems identified. This data is being extracted from the Medical
	;;^UTILITY(U,$J,142.1,71,3.5,4,0)
	;;=Record (# 90) file.
	;;^UTILITY(U,$J,142.1,72,0)
	;;=LAB ELECTRON MICROSCOPY^MAIN;GMTSLREM^Y^EM^Y^^^^Electron Microscopy
	;;^UTILITY(U,$J,142.1,72,3.5,0)
	;;=^^5^5^2950616^
	;;^UTILITY(U,$J,142.1,72,3.5,1,0)
	;;=This component contains information extracted from the Electron Microscopy
	;;^UTILITY(U,$J,142.1,72,3.5,2,0)
	;;=module of the Lab package. Time and maximum occurrence limits apply. Data
	;;^UTILITY(U,$J,142.1,72,3.5,3,0)
	;;=presented include:  collection date/time, accession number, specimen,
	;;^UTILITY(U,$J,142.1,72,3.5,4,0)
	;;=gross description, microscopic exam, supplementary report description,
	;;^UTILITY(U,$J,142.1,72,3.5,5,0)
	;;=brief clinical history, and EM Diagnosis.
	;;^UTILITY(U,$J,142.1,73,0)
	;;=ADVERSE REACTIONS/ALLERG BRIEF^ALLRG;GMTSALGB^^BADR^^^^^Brief Adv React/All
	;;^UTILITY(U,$J,142.1,73,3.5,0)
	;;=^^4^4^2950905^^
	;;^UTILITY(U,$J,142.1,73,3.5,1,0)
	;;=This component provides patient allergy/adverse reaction information from

GMTSI00U
GMTSI00U	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,73,3.5,2,0)
	;;=the Allergy Tracking System. It provides a brief patient list of all known
	;;^UTILITY(U,$J,142.1,73,3.5,3,0)
	;;=food, drug and environmental allergies or adverse reactions (e.g., hay
	;;^UTILITY(U,$J,142.1,73,3.5,4,0)
	;;=fever).
	;;^UTILITY(U,$J,142.1,201,0)
	;;=PCE LOCATION OF HOME^HOMELOC;GMTSPXHP^^LH^^^^^Location of Home
	;;^UTILITY(U,$J,142.1,201,3.5,0)
	;;=^^1^1^2941104^
	;;^UTILITY(U,$J,142.1,201,3.5,1,0)
	;;=This component lists directions to a particular patient's home.
	;;^UTILITY(U,$J,142.1,202,0)
	;;=PCE CLINICAL REMINDERS^MAIN;GMTSPXHR^^CR^^^^^Clinical Reminders
	;;^UTILITY(U,$J,142.1,202,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,202,1,1,0)
	;;=811.9
	;;^UTILITY(U,$J,142.1,202,3.5,0)
	;;=^^7^7^2950821^^^
	;;^UTILITY(U,$J,142.1,202,3.5,1,0)
	;;=This component lists the clinical reminders and their due dates. If an
	;;^UTILITY(U,$J,142.1,202,3.5,2,0)
	;;=item is currently due, "DUE NOW" is listed instead of a date. Clinical
	;;^UTILITY(U,$J,142.1,202,3.5,3,0)
	;;=Reminders may included Measurements (BP, HT, WT), Exams (Breast, Pelvic,
	;;^UTILITY(U,$J,142.1,202,3.5,4,0)
	;;=Etc.), Laboratory Tests (Cholesterol, PAP Test, etc.), Skin Tests (PPD),
	;;^UTILITY(U,$J,142.1,202,3.5,5,0)
	;;=Immunizations (Influenza, Tetanus Toxoid, etc.), Patient Education topics
	;;^UTILITY(U,$J,142.1,202,3.5,6,0)
	;;=(Breast, Diet, etc.), and in certain cases diagnosis (status post lung CA)
	;;^UTILITY(U,$J,142.1,202,3.5,7,0)
	;;=and procedures (hysterectomy, flexisigomoidoscopy, etc.).
	;;^UTILITY(U,$J,142.1,203,0)
	;;=PCE HEALTH FACTORS SELECTED^HFSEL;GMTSPXFP^Y^SHF^Y^^^^Health Factor Select
	;;^UTILITY(U,$J,142.1,203,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,203,1,1,0)
	;;=9999999.64
	;;^UTILITY(U,$J,142.1,203,3.5,0)
	;;=^^7^7^2950828^
	;;^UTILITY(U,$J,142.1,203,3.5,1,0)
	;;=This component allows a user to select specific health factors by category
	;;^UTILITY(U,$J,142.1,203,3.5,2,0)
	;;=and then lists the health factors, which apply to a particular patient for
	;;^UTILITY(U,$J,142.1,203,3.5,3,0)
	;;=user-specified time and occurrence limits.
	;;^UTILITY(U,$J,142.1,203,3.5,4,0)
	;;= 
	;;^UTILITY(U,$J,142.1,203,3.5,5,0)
	;;=Set the occurrence limit to 1 to list the latest unique health factors
	;;^UTILITY(U,$J,142.1,203,3.5,6,0)
	;;=for each selected category. (E.g. If there were 12 "Non-Smoker" health
	;;^UTILITY(U,$J,142.1,203,3.5,7,0)
	;;=factor entries, only the latest "Non-Smoker" entry would display.
	;;^UTILITY(U,$J,142.1,204,0)
	;;=PCE HEALTH FACTORS ALL^HFACT;GMTSPXFP^Y^HF^Y^^^^Health Factors
	;;^UTILITY(U,$J,142.1,204,3.5,0)
	;;=^^9^9^2950828^^^
	;;^UTILITY(U,$J,142.1,204,3.5,1,0)
	;;=This component lists all the health factors associated with a particular
	;;^UTILITY(U,$J,142.1,204,3.5,2,0)
	;;=patient for user-specified time and occurrence limits. The list will
	;;^UTILITY(U,$J,142.1,204,3.5,3,0)
	;;=display health factors by category and include a level of severity for
	;;^UTILITY(U,$J,142.1,204,3.5,4,0)
	;;=each health factor including Minimal(M), Moderate(MO), and
	;;^UTILITY(U,$J,142.1,204,3.5,5,0)
	;;=Heavy/Severe(H).
	;;^UTILITY(U,$J,142.1,204,3.5,6,0)
	;;= 
	;;^UTILITY(U,$J,142.1,204,3.5,7,0)
	;;=Set the occurrence limit to 1 to list the latest unique health factors
	;;^UTILITY(U,$J,142.1,204,3.5,8,0)
	;;=within each category.  (E.g. If there were 12 "Non-Smoker" health factor
	;;^UTILITY(U,$J,142.1,204,3.5,9,0)
	;;=entries, only the latest "Non-Smoker" entry would display.)
	;;^UTILITY(U,$J,142.1,205,0)
	;;=PCE OUTPATIENT ENCOUNTERS^OUTPT;GMTSPXOP^Y^OE^Y^^^^Outpatient Encounter^Y^Y^Y

GMTSI00V
GMTSI00V	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,205,3.5,0)
	;;=^^5^5^2941115^^^^
	;;^UTILITY(U,$J,142.1,205,3.5,1,0)
	;;=This component lists outpatient diagnosis (ICD-9) and procedure (CPT) for a
	;;^UTILITY(U,$J,142.1,205,3.5,2,0)
	;;=particular patient. The user can specify item and occurrence limits,
	;;^UTILITY(U,$J,142.1,205,3.5,3,0)
	;;=whether hospital location should be displayed or not, the format of ICD-9
	;;^UTILITY(U,$J,142.1,205,3.5,4,0)
	;;=data (e.g. code only, long text, short text or no ICD-9 data), and whether
	;;^UTILITY(U,$J,142.1,205,3.5,5,0)
	;;=the provider narrative should be displayed or not.
	;;^UTILITY(U,$J,142.1,206,0)
	;;=PCE MEASUREMENTS NON-TABULAR^MEAS;GMTSPXM^Y^NTM^Y^^^^Non-Tabular Measurem
	;;^UTILITY(U,$J,142.1,206,3.5,0)
	;;=^^3^3^2941104^^^
	;;^UTILITY(U,$J,142.1,206,3.5,1,0)
	;;=This component lists measurements (e.g. blood pressure, height, weight, 
	;;^UTILITY(U,$J,142.1,206,3.5,2,0)
	;;=respirations, etc.) in a non-tabular format for a particular patient for a 
	;;^UTILITY(U,$J,142.1,206,3.5,3,0)
	;;=user-specified time and occurrence limits.
	;;^UTILITY(U,$J,142.1,207,0)
	;;=PCE IMMUNIZATIONS^IMMUN;GMTSPXIM^^IM^^^^^Immunizations
	;;^UTILITY(U,$J,142.1,207,3.5,0)
	;;=^^3^3^2950905^
	;;^UTILITY(U,$J,142.1,207,3.5,1,0)
	;;=This component lists the immunizations (e.g., Rubella, Smallpox,
	;;^UTILITY(U,$J,142.1,207,3.5,2,0)
	;;=etc.) and information about each immunization administered to a
	;;^UTILITY(U,$J,142.1,207,3.5,3,0)
	;;=particular patient.
	;;^UTILITY(U,$J,142.1,208,0)
	;;=PCE SKIN TESTS^SKIN;GMTSPXSK^^ST^^^^^Skin Tests
	;;^UTILITY(U,$J,142.1,208,3.5,0)
	;;=^^3^3^2950404^^^
	;;^UTILITY(U,$J,142.1,208,3.5,1,0)
	;;=This component lists the skin tests and the results (e.g. positive,
	;;^UTILITY(U,$J,142.1,208,3.5,2,0)
	;;=negative, doubtful, or no take) for a particular patient. Some examples of
	;;^UTILITY(U,$J,142.1,208,3.5,3,0)
	;;=skin tests are cocci, mon-vac, PPD, schick, tine, etc.
	;;^UTILITY(U,$J,142.1,209,0)
	;;=PCE MEASUREMENTS SELECTED^MEASP;GMTSPXMP^Y^MEAS^Y^^^^Measurement Selected
	;;^UTILITY(U,$J,142.1,209,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,209,1,1,0)
	;;=9001017
	;;^UTILITY(U,$J,142.1,209,3.5,0)
	;;=^^5^5^2950803^^^
	;;^UTILITY(U,$J,142.1,209,3.5,1,0)
	;;=This component lists selected measurements segments in a tabular format
	;;^UTILITY(U,$J,142.1,209,3.5,2,0)
	;;=for a particular patient for user-specified time and occurrence limits.
	;;^UTILITY(U,$J,142.1,209,3.5,3,0)
	;;=Specialized measurement segments can be set up in the Patient Care
	;;^UTILITY(U,$J,142.1,209,3.5,4,0)
	;;=Encounter package at each site by the IRM staff to allow different
	;;^UTILITY(U,$J,142.1,209,3.5,5,0)
	;;=measurement views.
	;;^UTILITY(U,$J,142.1,212,0)
	;;=PCE EDUCATION^PTED;GMTSPXEP^Y^ED^Y^^^^Education
	;;^UTILITY(U,$J,142.1,212,3.5,0)
	;;=^^6^6^2950905^
	;;^UTILITY(U,$J,142.1,212,3.5,1,0)
	;;=This component lists the patient education topics and a brief assessment
	;;^UTILITY(U,$J,142.1,212,3.5,2,0)
	;;=of the patient's understanding of the topic for a particular patient for
	;;^UTILITY(U,$J,142.1,212,3.5,3,0)
	;;=user-specified time and occurrence limits. Some examples of topics are
	;;^UTILITY(U,$J,142.1,212,3.5,4,0)
	;;=complications, diet, disease process, exercise, follow-up care, general
	;;^UTILITY(U,$J,142.1,212,3.5,5,0)
	;;=information, lifestyle adaptations, medications, nutrition, smoking,
	;;^UTILITY(U,$J,142.1,212,3.5,6,0)
	;;=etc.
	;;^UTILITY(U,$J,142.1,213,0)
	;;=PCE EDUCATION LATEST^MRPTED;GMTSPXEP^Y^EDL^^^^^Education Latest

GMTSI00W
GMTSI00W	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQR(142.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,142.1,213,3.5,0)
	;;=^^6^6^2941104^
	;;^UTILITY(U,$J,142.1,213,3.5,1,0)
	;;=This component lists the latest patient education for each topic and a
	;;^UTILITY(U,$J,142.1,213,3.5,2,0)
	;;=brief assessment of the patient's understanding of the topic for a
	;;^UTILITY(U,$J,142.1,213,3.5,3,0)
	;;=particular patient for a user-specified time limit. Some examples of
	;;^UTILITY(U,$J,142.1,213,3.5,4,0)
	;;=topics are complications, diet, disease process, exercise, follow-up care,
	;;^UTILITY(U,$J,142.1,213,3.5,5,0)
	;;=general information, lifestyle adaptations, medications, nutrition,
	;;^UTILITY(U,$J,142.1,213,3.5,6,0)
	;;=smoking, etc.
	;;^UTILITY(U,$J,142.1,220,0)
	;;=PCE OUTPATIENT DIAGNOSIS^PURPOSE;GMTSPXOP^Y^OD^Y^^^^Outpatient Diagnosis^Y^Y^Y
	;;^UTILITY(U,$J,142.1,220,3.5,0)
	;;=^^5^5^2941104^^^
	;;^UTILITY(U,$J,142.1,220,3.5,1,0)
	;;=This component lists outpatient diagnosis (ICD-9) for a particular patient.
	;;^UTILITY(U,$J,142.1,220,3.5,2,0)
	;;=The user can specify time and occurrence limits, whether hospital location
	;;^UTILITY(U,$J,142.1,220,3.5,3,0)
	;;=should be displayed or not, the format of ICD-9 data (e.g. code only, long
	;;^UTILITY(U,$J,142.1,220,3.5,4,0)
	;;=text, short text or no ICD-9 data), and whether the provider narrative
	;;^UTILITY(U,$J,142.1,220,3.5,5,0)
	;;=should be displayed or not.
	;;^UTILITY(U,$J,142.1,230,0)
	;;=PCE EXAMS LATEST^MRE;GMTSPXXP^Y^EXAM^^^^^Exams Latest
	;;^UTILITY(U,$J,142.1,230,3.5,0)
	;;=^^3^3^2941104^
	;;^UTILITY(U,$J,142.1,230,3.5,1,0)
	;;=This component lists the latest examination information and results for a
	;;^UTILITY(U,$J,142.1,230,3.5,2,0)
	;;=particular patient for a user-specified time limit. Some examples of exam
	;;^UTILITY(U,$J,142.1,230,3.5,3,0)
	;;=types are eye exams, ear exams, neurological exams, pelvis exams, etc.
	;;^UTILITY(U,$J,142.1,231,0)
	;;=PCE TREATMENTS PROVIDED^TRTMT;GMTSPXTP^Y^TP^Y^^^^Treatments Provided
	;;^UTILITY(U,$J,142.1,231,3.5,0)
	;;=^^5^5^2950411^^
	;;^UTILITY(U,$J,142.1,231,3.5,1,0)
	;;=This component lists treatments provided that are not covered in the
	;;^UTILITY(U,$J,142.1,231,3.5,2,0)
	;;=IDC-9-CM procedures for a particular patient for user specified time and
	;;^UTILITY(U,$J,142.1,231,3.5,3,0)
	;;=occurrence limits. Some example of treatment types include nursing
	;;^UTILITY(U,$J,142.1,231,3.5,4,0)
	;;=activities such as ear irrigation, dental care instructions, or preventive
	;;^UTILITY(U,$J,142.1,231,3.5,5,0)
	;;=health care counseling.
	;;^UTILITY(U,$J,142.1,232,0)
	;;=PCE CLINICAL MAINTENANCE^MAINHM;GMTSPXHR^^CM^^^^^Clinical Maintenance
	;;^UTILITY(U,$J,142.1,232,1,0)
	;;=^142.17P^1^1
	;;^UTILITY(U,$J,142.1,232,1,1,0)
	;;=811.9
	;;^UTILITY(U,$J,142.1,232,3.5,0)
	;;=^^5^5^2950821^^
	;;^UTILITY(U,$J,142.1,232,3.5,1,0)
	;;=This component shows what the outcome was of information on file that is
	;;^UTILITY(U,$J,142.1,232,3.5,2,0)
	;;=related to the Clinical Reminders. The PCE REMINDER/MAINTENANCE ITEM FILE
	;;^UTILITY(U,$J,142.1,232,3.5,3,0)
	;;=is used to determine which reminders should be printed in this component
	;;^UTILITY(U,$J,142.1,232,3.5,4,0)
	;;=with the results of the search of information in PCE, Problem List or
	;;^UTILITY(U,$J,142.1,232,3.5,5,0)
	;;=other DHCP files.

GMTSI00X
GMTSI00X	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142.99)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(142.99,0,"GL")
	;;=^GMT(142.99,
	;;^DIC("B","HEALTH SUMMARY PARAMETERS",142.99)
	;;=
	;;^DIC(142.99,"%D",0)
	;;=^^2^2^2950804^^^^
	;;^DIC(142.99,"%D",1,0)
	;;=This file contains any site parameters which may apply to the Health
	;;^DIC(142.99,"%D",2,0)
	;;=Summary package.
	;;^DD(142.99,0)
	;;=FIELD^^.05^5
	;;^DD(142.99,0,"DDA")
	;;=N
	;;^DD(142.99,0,"DT")
	;;=2951006
	;;^DD(142.99,0,"IX","B",142.99,.01)
	;;=
	;;^DD(142.99,0,"NM","HEALTH SUMMARY PARAMETERS")
	;;=
	;;^DD(142.99,.01,0)
	;;=NAME^RFX^^0;1^I $L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E)!(X'="HOSPITAL") K X W "   NAME must be HOSPITAL."
	;;^DD(142.99,.01,1,0)
	;;=^.1
	;;^DD(142.99,.01,1,1,0)
	;;=142.99^B
	;;^DD(142.99,.01,1,1,1)
	;;=S ^GMT(142.99,"B",$E(X,1,30),DA)=""
	;;^DD(142.99,.01,1,1,2)
	;;=K ^GMT(142.99,"B",$E(X,1,30),DA)
	;;^DD(142.99,.01,3)
	;;=NAME MUST BE HOSPITAL
	;;^DD(142.99,.01,21,0)
	;;=^^3^3^2920914^
	;;^DD(142.99,.01,21,1,0)
	;;=This is the name of the entry in the Health Summary parameters file.
	;;^DD(142.99,.01,21,2,0)
	;;=The input transform will restrict entry to one record only, which must
	;;^DD(142.99,.01,21,3,0)
	;;=be named "HOSPITAL."
	;;^DD(142.99,.01,"DT")
	;;=2920427
	;;^DD(142.99,.02,0)
	;;=PROMPT FOR ACTION PROFILE^S^Y:yes;N:no;^0;2^Q
	;;^DD(142.99,.02,3)
	;;=Enter YES if you'd like users to be prompted to print Action Profiles
	;;^DD(142.99,.02,21,0)
	;;=^^3^3^2951006^^^
	;;^DD(142.99,.02,21,1,0)
	;;=If this parameter is set to Y or YES, the user will be prompted to include
	;;^DD(142.99,.02,21,2,0)
	;;=the Outpatient Pharmacy Action Profile when printing Health Summaries by
	;;^DD(142.99,.02,21,3,0)
	;;=location (both interactive and batch mode) and by patient.
	;;^DD(142.99,.02,"DT")
	;;=2951006
	;;^DD(142.99,.03,0)
	;;=INCLUDE COMMENTS FOR LABS^S^Y:yes;N:no;^0;3^Q
	;;^DD(142.99,.03,3)
	;;=Enter YES if comments should appear in Chemistry and Hematology, Lab Tests Selected, and Lab Cumulative Selected components
	;;^DD(142.99,.03,21,0)
	;;=^^13^13^2951006^
	;;^DD(142.99,.03,21,1,0)
	;;=If this parameter is set to Y or YES, the Chemistry & Hematology, the Lab
	;;^DD(142.99,.03,21,2,0)
	;;=Tests Selected and the Lab Cumulative Selected components will present
	;;^DD(142.99,.03,21,3,0)
	;;=comments for results. For the Chemistry & Hematology and the Lab Tests
	;;^DD(142.99,.03,21,4,0)
	;;=Selected components the comments will be displayed immediately following
	;;^DD(142.99,.03,21,5,0)
	;;=the results. For the Lab Cumulative Selected components a lower case
	;;^DD(142.99,.03,21,6,0)
	;;=letter will be displayed to the left of the date for entries with
	;;^DD(142.99,.03,21,7,0)
	;;=comments. Comments will be displayed after all the results are displayed
	;;^DD(142.99,.03,21,8,0)
	;;=with the comments being linked by the lower case letter. Up to 26 comments
	;;^DD(142.99,.03,21,9,0)
	;;=can be included. 
	;;^DD(142.99,.03,21,10,0)
	;;= 
	;;^DD(142.99,.03,21,11,0)
	;;=If blank, N or NO, the Chemistry & Hematology and the Lab Tests Selected
	;;^DD(142.99,.03,21,12,0)
	;;=components will present the symbol "!!" next to tests which include
	;;^DD(142.99,.03,21,13,0)
	;;=comments, and a footnote referring the user to the Lab Interim Report.
	;;^DD(142.99,.03,"DT")
	;;=2951006
	;;^DD(142.99,.04,0)
	;;=SPOOL DEVICE^*P3.5'^%ZIS(1,^0;4^S DIC("S")="I $P($G(^(""TYPE"")),U)=""SPL""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
	;;^DD(142.99,.04,3)
	;;=Enter a SPOOL DEVICE NAME for Health Summary-PDX interface.
	;;^DD(142.99,.04,12)
	;;=Only allow device type of SPOOL to be chosen.
	;;^DD(142.99,.04,12.1)
	;;=S DIC("S")="I $P($G(^(""TYPE"")),U)=""SPL"""

GMTSI00Y
GMTSI00Y	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'DIFQ(142.99)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DD(142.99,.04,21,0)
	;;=^^2^2^2950815^
	;;^DD(142.99,.04,21,1,0)
	;;=This is the SPOOL DEVICE to which Health Summary output can be directed
	;;^DD(142.99,.04,21,2,0)
	;;=during a PDX request for one or more Health Summary Components.
	;;^DD(142.99,.04,"DT")
	;;=2950815
	;;^DD(142.99,.05,0)
	;;=INCLUDE BAR CODES ON ACT PROF^S^Y:yes;N:no;^0;5^Q
	;;^DD(142.99,.05,.1)
	;;=INCLUDE BAR CODES ON ACTION PROFILES
	;;^DD(142.99,.05,3)
	;;=Enter YES to include bar codes when Action Profiles are printed by Health Summary.
	;;^DD(142.99,.05,21,0)
	;;=^^2^2^2951006^
	;;^DD(142.99,.05,21,1,0)
	;;=If this parameter is set to YES or YES, Bar Codes will be included when
	;;^DD(142.99,.05,21,2,0)
	;;=Outpatient Pharmacy Action Profiles are printed from Health Summary.
	;;^DD(142.99,.05,"DT")
	;;=2951006

GMTSI00Z
GMTSI00Z	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	I DSEC F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^DIC(142,0,"AUDIT")
	;;=@
	;;^DIC(142,0,"DD")
	;;=@
	;;^DIC(142.1,0,"AUDIT")
	;;=@
	;;^DIC(142.1,0,"DD")
	;;=@
	;;^DIC(142.1,0,"DEL")
	;;=@
	;;^DIC(142.1,0,"LAYGO")
	;;=@
	;;^DIC(142.1,0,"WR")
	;;=@
	;;^DIC(142.99,0,"AUDIT")
	;;=@
	;;^DIC(142.99,0,"DD")
	;;=@
	;;^DIC(142.99,0,"DEL")
	;;=@
	;;^DIC(142.99,0,"LAYGO")
	;;=@
	;;^DIC(142.99,0,"RD")
	;;=@
	;;^DIC(142.99,0,"WR")
	;;=@

GMTSI010
GMTSI010	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIBT",739,0)
	;;=GMTS TASK LOCATIONS SORT^2901012.1012^^142^^^2951019^
	;;^UTILITY(U,$J,"DIBT",739,2,0)
	;;=^.4014^1^1
	;;^UTILITY(U,$J,"DIBT",739,2,1,0)
	;;=142.2^^LOCATION(S) USING THE SUMMARY^".01^;S1^^^^^4
	;;^UTILITY(U,$J,"DIBT",739,2,1,1,0)
	;;=^.40141^1^1
	;;^UTILITY(U,$J,"DIBT",739,2,1,1,1,0)
	;;=142^20
	;;^UTILITY(U,$J,"DIBT",739,2,1,1,"B",142,1)
	;;=
	;;^UTILITY(U,$J,"DIBT",739,2,1,"CM")
	;;=S Y(1)=$S($D(^GMT(142,D0,20,D1,0)):^(0),1:"") S X=$S('$D(^SC(+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) I D1>0 S DISX(1)=X
	;;^UTILITY(U,$J,"DIBT",739,2,1,"GET")
	;;=S Y(1)=$S($D(^GMT(142,D0,20,D1,0)):^(0),1:"") S X=$S('$D(^SC(+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) I D1>0 S DISX(1)=X
	;;^UTILITY(U,$J,"DIBT",739,2,1,"IX")
	;;=^GMT(142,"D",^GMT(142,^2
	;;^UTILITY(U,$J,"DIBT",739,2,1,"PTRIX")
	;;=^SC("B",
	;;^UTILITY(U,$J,"DIBT",739,2,1,"QCON")
	;;=I DISX(1)'=""
	;;^UTILITY(U,$J,"DIBT",739,2,1,"SER")
	;;=0^0
	;;^UTILITY(U,$J,"DIBT",739,2,1,"TXT")
	;;=LOCATION(S) USING THE SUMMARY not null
	;;^UTILITY(U,$J,"DIBT",739,2,"B",142.2,1)
	;;=
	;;^UTILITY(U,$J,"DIE",1050,0)
	;;=GMTS EDIT HLTH SUM TYPE^2950815.1725^^142^1212^^2951019
	;;^UTILITY(U,$J,"DIE",1050,"DIAB",5,0,142,0)
	;;=.08;T
	;;^UTILITY(U,$J,"DIE",1050,"DR",1,142)
	;;=I '$D(GMTSNEW) S GMTSNEW=0;I GMTSNEW,'GMTSMGR S Y="@1";.01;.02;.08T~;I 'GMTSMGR S Y=0;.05;.06;S Y=0;@1;.06////^S X=DUZ;S Y=.01;
	;;^UTILITY(U,$J,"DIE",1051,0)
	;;=GMTS DELETE HLTH SUM TYPE^2951004.0749^^142^0^^2951016
	;;^UTILITY(U,$J,"DIE",1051,"DR",1,142)
	;;=S GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,1:0);I 'GMTSMGR S %=$P(^GMT(142,DA,0),U,2) I %]"",$D(^XUSEC(%,DUZ))[0 W !,$C(7),"The "_$P(^GMT(142,DA,0),U)_" summary type is currently locked to prevent deletion.",! S Y=0;
	;;^UTILITY(U,$J,"DIE",1051,"DR",1,142,1)
	;;=S %=+$P(^GMT(142,DA,0),U,3) I 'GMTSMGR,%'=DUZ W !,$C(7),"You may only delete summary types for which you are the owner.",! S Y=0;
	;;^UTILITY(U,$J,"DIE",1051,"DR",1,142,2)
	;;=I $P(^GMT(142,DA,0),U)="GMTS HS ADHOC OPTION" W !,$C(7),"GMTS HS ADHOC OPTION Summary may NOT be deleted.",! S Y=0;W !,"Are you sure you want to delete the "_$P(^GMT(142,DA,0),U)_" Health Summary Type";S %=2;D YN^DICN;
	;;^UTILITY(U,$J,"DIE",1051,"DR",1,142,3)
	;;=I %'=1 W !,"Nothing Deleted!" S Y=0;W !,"Health Summary Type "_$P(^GMT(142,DA,0),U)_" Deleted!";.01///@;
	;;^UTILITY(U,$J,"DIPT",1215,0)
	;;=GMTS COMP LIST^2940422.0732^^142.1^^^2951013^
	;;^UTILITY(U,$J,"DIPT",1215,"F",1)
	;;=
	;;^UTILITY(U,$J,"DIPT",1215,"F",2)
	;;=S DIP(1)=$S($D(^GMT(142.1,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1),X=$S($L($P(DIP(1),U,9)):$P(DIP(1),U,9),1:$P(DIP(1),U)) W X K DIP;"Component Name";Z;"GMTS COMPONENT NAME(NAME)"~
	;;^UTILITY(U,$J,"DIPT",1215,"F",3)
	;;=3;"Abbr.";C24~4;"Occur. Limits?";C31~2;"Time Limits?";C40~10;"Hosp. Loc.?";C49~11;"ICD Text?";C56~12;"Prov. Narr.?";C63~5;"Disabled?";C71~
	;;^UTILITY(U,$J,"DIPT",1215,"H")
	;;=HEALTH SUMMARY COMPONENT LIST
	;;^UTILITY(U,$J,"DIPT",1216,0)
	;;=GMTS TYPE LIST^2910520.0921^^142^^^2950907^
	;;^UTILITY(U,$J,"DIPT",1216,"F",1)
	;;=.01;"Health Summary Type";L25;C1~.06;"Owner";C33;L20~.05;"Lock";C58;L20~
	;;^UTILITY(U,$J,"DIPT",1216,"F",2)
	;;=I $D(^GMT(142,D0,"T")),(^GMT(142,D0,"T")["GMTS") W "**  "_^GMT(142,D0,"T")_"  **";C3;X;Z;"I $D(^GMT(142,D0,"T")),(^GMT(142,D0,"T")["GMTS") W "**  "_^GMT(142,D0,"T")_"  **""~
	;;^UTILITY(U,$J,"DIPT",1216,"H")
	;;=HEALTH SUMMARY TYPE LIST
	;;^UTILITY(U,$J,"DIPT",1217,0)
	;;=GMTS TYPE INQ HEADER^2950815.1746^^142^1212^^2951019
	;;^UTILITY(U,$J,"DIPT",1217,"F",1)
	;;="HEALTH SUMMARY TYPE INQUIRY";C24~"         Type Name:";C1;S1~.01~"             Title:";C1~.02~"             Owner:";C1~.06~"";C44~

GMTSI011
GMTSI011	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIPT",1217,"F",2)
	;;=W:$P($G(^GMT(142,D0,0)),"^",2)'="" "LOCK: ";Z;"W:$P($G(^GMT(142,D0,0)),"^",2)'="" "LOCK: ""~.05;C53;L25~
	;;^UTILITY(U,$J,"DIPT",1217,"F",3)
	;;="SUPPRESS PRINT OF COMPONENTS WITHOUT DATA:";C1~.08~"                                     Max        Hosp  ICD    Prov";C1;S1~
	;;^UTILITY(U,$J,"DIPT",1217,"F",4)
	;;="Abb.  Order   Component Name         Occ  Time  Loc   Text   Narr  Selection";C1~
	;;^UTILITY(U,$J,"DIPT",1217,"F",5)
	;;="------------------------------------------------------------------------------";C1~
	;;^UTILITY(U,$J,"DIPT",1217,"H")
	;;=@
	;;^UTILITY(U,$J,"DIPT",1217,"SUB")
	;;=1
	;;^UTILITY(U,$J,"DIPT",1218,0)
	;;=GMTS TYPE INQ^2940426.1154^^142^^^2951019^
	;;^UTILITY(U,$J,"DIPT",1218,"DXS",1,9.2)
	;;=S I(1,0)=$S($D(D1):D1,1:""),I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^GMT(142,D0,1,D1,0)):^(0),1:""),D0=$P(DIP(1),U,2) S:'$D(^GMT(142.1,+D0,0)) D0=-1
	;;^UTILITY(U,$J,"DIPT",1218,"DXS",2,9)
	;;=W $S($L($P(X,U,5)):$P(X,U,5),$P(^GMT(142.1,$P(X,U,2),0),U,9)]"":$P(^(0),U,9),1:$P(^GMT(142.1,$P(X,U,2),0),U))
	;;^UTILITY(U,$J,"DIPT",1218,"F",1)
	;;=1,X DXS(1,9.2) S DIP(101)=$S($D(^GMT(142.1,D0,0)):^(0),1:"") S X=$P(DIP(101),U,4) S D0=I(0,0) S D1=I(1,0) W X K DIP;C1;L4;Z;"COMPONENT:ABBREV"~
	;;^UTILITY(U,$J,"DIPT",1218,"F",2)
	;;=1,.01;C7;L4~1,"";C10~1,I $P(X,U,2),$P(^GMT(142.1,$P(X,U,2),0),U,6)'="" W "*";Z;"I $P(X,U,2),$P(^GMT(142.1,$P(X,U,2),0),U,6)'="" W "*""~1,"";C13~
	;;^UTILITY(U,$J,"DIPT",1218,"F",3)
	;;=1,X DXS(2,9);Z;"W $S($L($P(X,U,5)):$P(X,U,5),$P(^GMT(142.1,$P(X,U,2),0),U,9)]"":$P(^(0),U,9),1:$P(^GMT(142.1,$P(X,U,2),0),U))"~1,2;C38;L5~1,3;C43;L3~
	;;^UTILITY(U,$J,"DIPT",1218,"F",4)
	;;=1,6;C49;L3~1,7;C55;L5~1,8;C62;L3~1,4,.01;C68;L11~
	;;^UTILITY(U,$J,"DIPT",1218,"H")
	;;=[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]
	;;^UTILITY(U,$J,"DIPT",1219,0)
	;;=GMTS TYPE INQ FOOTER^2901011.1808^^142^^^2951019^
	;;^UTILITY(U,$J,"DIPT",1219,"F",2)
	;;="               * = Disabled Components";C1~
	;;^UTILITY(U,$J,"DIPT",1219,"H")
	;;=@
	;;^UTILITY(U,$J,"DIPT",1219,"SUB")
	;;=1
	;;^UTILITY(U,$J,"DIPT",1220,0)
	;;=GMTS TASK LOCATIONS LIST^2920211.0945^^142^^^2951019^
	;;^UTILITY(U,$J,"DIPT",1220,"F",1)
	;;=20,.01;L25;"Location"~20,.02;L10;C27;"Device"~
	;;^UTILITY(U,$J,"DIPT",1220,"F",2)
	;;=20,I $P(X,U,2),'$D(^%ZIS(1,$P(X,U,2),0)) W " (Invalid)";X;Z;"I $P(X,U,2),'$D(^%ZIS(1,$P(X,U,2),0)) W " (Invalid)""~20,.04;L5;C39;"Print Days Ahead"~
	;;^UTILITY(U,$J,"DIPT",1220,"F",3)
	;;=20,.03;L5;C46;"Print Action Profile"~.01;L20;C55;"Health Summary Type"~
	;;^UTILITY(U,$J,"DIPT",1220,"H")
	;;=Batch Health Summary Locations List
	;;^UTILITY(U,$J,"DIPT",1221,0)
	;;=GMTS COMP DESC LIST^2911125.1546^^142.1^^^2950906^
	;;^UTILITY(U,$J,"DIPT",1221,"F",1)
	;;=
	;;^UTILITY(U,$J,"DIPT",1221,"F",2)
	;;=S DIP(1)=$S($D(^GMT(142.1,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1) S X=$S($L($P(DIP(1),U,9)):$P(DIP(1),U,9),1:$P(DIP(1),U)) W X K DIP;"Component Name";C1;Z;"GMTS COMPONENT NAME(NAME)"~
	;;^UTILITY(U,$J,"DIPT",1221,"F",3)
	;;=3;"Abbrev.";C35~3.5,.01;"Description";C4~"   ";C1;X~
	;;^UTILITY(U,$J,"DIPT",1221,"H")
	;;=HEALTH SUMMARY COMPONENT DESCRIPTION LIST
	;;^UTILITY(U,$J,"DIPT",1222,0)
	;;=GMTS COMP INQ^2940426.0728^^142.1^^^2951018^
	;;^UTILITY(U,$J,"DIPT",1222,"F",1)
	;;="Component Name:";C19~.01;C36;X~"Display Name:";C21~9;C36;X~"Abbreviation:";C21~3;C36;X~
	;;^UTILITY(U,$J,"DIPT",1222,"F",2)
	;;=I $D(GMTSY) W:$D(^GMT(142.1,GMTSY,1,0)) !,?18,"Selection File:";Z;"I $D(GMTSY) W:$D(^GMT(142.1,GMTSY,1,0)) !,?18,"Selection File:""~7,.01;C36;X~

GMTSI012
GMTSI012	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"DIPT",1222,"F",3)
	;;=7,I $D(GMTSY) W:$D(^GMT(142.1,GMTSY,1,0)) !,?10,"Max Selections Allowed:";Z;"I $D(GMTSY) W:$D(^GMT(142.1,GMTSY,1,0)) !,?10,"Max Selections Allowed:""~
	;;^UTILITY(U,$J,"DIPT",1222,"F",4)
	;;=7,1;C36;X~"Time Limits Apply:";C16~I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",3)'="Y" "NO";Z;"I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",3)'="Y" "NO""~2;X~
	;;^UTILITY(U,$J,"DIPT",1222,"F",5)
	;;="Max Occurrences Apply:";C12~I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",5)'="Y" "NO";Z;"I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",5)'="Y" "NO""~4;X~
	;;^UTILITY(U,$J,"DIPT",1222,"F",6)
	;;="Hospital Location Display Apply:";C2~
	;;^UTILITY(U,$J,"DIPT",1222,"F",7)
	;;=I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",10)'="Y" "NO";Z;"I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",10)'="Y" "NO""~10;X~"ICD Text Display Apply:";C11~
	;;^UTILITY(U,$J,"DIPT",1222,"F",8)
	;;=I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",11)'="Y" "NO";Z;"I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",11)'="Y" "NO""~11;X~
	;;^UTILITY(U,$J,"DIPT",1222,"F",9)
	;;="Provider Narrative Display Apply:";C1~
	;;^UTILITY(U,$J,"DIPT",1222,"F",10)
	;;=I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",12)'="Y" "NO";Z;"I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",12)'="Y" "NO""~12;X~"Component Disabled:";C15~
	;;^UTILITY(U,$J,"DIPT",1222,"F",11)
	;;=I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",6)']"""" "NO";Z;"I $D(GMTSY) W:$P(^GMT(142.1,GMTSY,0),"^",6)']"""" "NO""~5;X~"Description:";S2;C10~"   ";C10~
	;;^UTILITY(U,$J,"DIPT",1222,"F",12)
	;;=3.5,.01;C10;L55;X~
	;;^UTILITY(U,$J,"DIPT",1222,"H")
	;;=@
	;;^UTILITY(U,$J,"DIPT",1222,"SUB")
	;;=1
	;;^UTILITY(U,$J,"DIPT",1223,0)
	;;=GMTS COMP INQ HEADER^2910107.1539^^142.1^^^2951018^
	;;^UTILITY(U,$J,"DIPT",1223,"F",2)
	;;="HEALTH SUMMARY COMPONENT INQUIRY";C20~"   ";C10;S2~
	;;^UTILITY(U,$J,"DIPT",1223,"H")
	;;=@
	;;^UTILITY(U,$J,"DIPT",1223,"SUB")
	;;=1
	;;^UTILITY(U,$J,"FUN",2861286,0)
	;;=GMTS COMPONENT NAME
	;;^UTILITY(U,$J,"FUN",2861286,1)
	;;=S X=$S($L($P(DIP(1),U,9)):$P(DIP(1),U,9),1:$P(DIP(1),U))
	;;^UTILITY(U,$J,"FUN",2861286,2)
	;;=X
	;;^UTILITY(U,$J,"FUN",2861286,3)
	;;=1
	;;^UTILITY(U,$J,"FUN",2861286,9)
	;;=Writes HEADER NAME or DEFAULT HEADER NAME or COMPONENT NAME
	;;^UTILITY(U,$J,"KEY",94,0)
	;;=GMTSMGR
	;;^UTILITY(U,$J,"KEY",94,1,0)
	;;=3^^7^7^2920714^^^^
	;;^UTILITY(U,$J,"KEY",94,1,1,0)
	;;=Grants access to options which should be exercised only by the local
	;;^UTILITY(U,$J,"KEY",94,1,2,0)
	;;=manager of the Health Summary system.  The holder of this security key
	;;^UTILITY(U,$J,"KEY",94,1,3,0)
	;;=may edit or delete any Health Summary Type regardless of owner.  When
	;;^UTILITY(U,$J,"KEY",94,1,4,0)
	;;=creating or editing a Health Summary Type, the holder of this key is
	;;^UTILITY(U,$J,"KEY",94,1,5,0)
	;;=prompted for owner and lock fields.  He may then enter a new owner
	;;^UTILITY(U,$J,"KEY",94,1,6,0)
	;;=or lock or change existing owner or lock.  Persons who do not hold
	;;^UTILITY(U,$J,"KEY",94,1,7,0)
	;;=GMTSMGR key are not prompted for these fields.
	;;^UTILITY(U,$J,"KEY",222,0)
	;;=GMTS VIEW ONLY
	;;^UTILITY(U,$J,"KEY",222,1,0)
	;;=^^2^2^2920206^
	;;^UTILITY(U,$J,"KEY",222,1,1,0)
	;;=This key disables device selection for its holders when any of the print
	;;^UTILITY(U,$J,"KEY",222,1,2,0)
	;;=Health Summary options are invoked.
	;;^UTILITY(U,$J,"OPT",3499,0)
	;;=GMTS COORDINATOR^Health Summary Coordinator's Menu^^M^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",3499,1,0)
	;;=^^5^5^2950816^
	;;^UTILITY(U,$J,"OPT",3499,1,1,0)
	;;=This option is used by individuals who have the capability to build their 

GMTSI013
GMTSI013	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",3499,1,2,0)
	;;=own Health Summary Types. It has all of the capabilities of the 'Health
	;;^UTILITY(U,$J,"OPT",3499,1,3,0)
	;;=Summary Users Menu' with the addition of the 'Build Health Summary Type
	;;^UTILITY(U,$J,"OPT",3499,1,4,0)
	;;=Menu' and the option to set parameters for nightly batch printing of
	;;^UTILITY(U,$J,"OPT",3499,1,5,0)
	;;=Health Summaries by Location.
	;;^UTILITY(U,$J,"OPT",3499,10,0)
	;;=^19.01PI^4^4
	;;^UTILITY(U,$J,"OPT",3499,10,1,0)
	;;=4465^1^1
	;;^UTILITY(U,$J,"OPT",3499,10,1,"^")
	;;=GMTS HS MENU
	;;^UTILITY(U,$J,"OPT",3499,10,2,0)
	;;=4471^3^3
	;;^UTILITY(U,$J,"OPT",3499,10,2,"^")
	;;=GMTS HS BY LOC PARAMETERS
	;;^UTILITY(U,$J,"OPT",3499,10,3,0)
	;;=3504^2^2
	;;^UTILITY(U,$J,"OPT",3499,10,3,"^")
	;;=GMTS BUILD MENU
	;;^UTILITY(U,$J,"OPT",3499,10,4,0)
	;;=4687^4^4
	;;^UTILITY(U,$J,"OPT",3499,10,4,"^")
	;;=GMTS TASK LOCATIONS LIST
	;;^UTILITY(U,$J,"OPT",3499,15)
	;;=
	;;^UTILITY(U,$J,"OPT",3499,20)
	;;=
	;;^UTILITY(U,$J,"OPT",3499,52)
	;;=
	;;^UTILITY(U,$J,"OPT",3499,99)
	;;=56434,65451
	;;^UTILITY(U,$J,"OPT",3499,99.1)
	;;=54440,44166
	;;^UTILITY(U,$J,"OPT",3499,"U")
	;;=HEALTH SUMMARY COORDINATOR'S M
	;;^UTILITY(U,$J,"OPT",3504,0)
	;;=GMTS BUILD MENU^Build Health Summary Type Menu^^M^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",3504,1,0)
	;;=^^2^2^2950816^^
	;;^UTILITY(U,$J,"OPT",3504,1,1,0)
	;;=This menu contains options to create or delete Health Summary Types, along
	;;^UTILITY(U,$J,"OPT",3504,1,2,0)
	;;=with options which may help in that process.
	;;^UTILITY(U,$J,"OPT",3504,10,0)
	;;=^19.01PI^6^4
	;;^UTILITY(U,$J,"OPT",3504,10,1,0)
	;;=4469^1^1
	;;^UTILITY(U,$J,"OPT",3504,10,1,"^")
	;;=GMTS TYPE ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",3504,10,2,0)
	;;=4468^2^2
	;;^UTILITY(U,$J,"OPT",3504,10,2,"^")
	;;=GMTS TYPE DELETE
	;;^UTILITY(U,$J,"OPT",3504,10,5,0)
	;;=5554^3^3
	;;^UTILITY(U,$J,"OPT",3504,10,5,"^")
	;;=GMTS INFO ONLY MENU
	;;^UTILITY(U,$J,"OPT",3504,10,6,0)
	;;=4465^4^4
	;;^UTILITY(U,$J,"OPT",3504,10,6,"^")
	;;=GMTS HS MENU
	;;^UTILITY(U,$J,"OPT",3504,99)
	;;=56462,45611
	;;^UTILITY(U,$J,"OPT",3504,99.1)
	;;=54396,55999
	;;^UTILITY(U,$J,"OPT",3504,"U")
	;;=BUILD HEALTH SUMMARY TYPE MENU
	;;^UTILITY(U,$J,"OPT",4020,0)
	;;=GMTS USER^Health Summary Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",4020,1,0)
	;;=^^8^8^2950816^
	;;^UTILITY(U,$J,"OPT",4020,1,1,0)
	;;=This menu allows the user to print Health Summaries by Patient or Hospital
	;;^UTILITY(U,$J,"OPT",4020,1,2,0)
	;;=Location with a pre-defined Health Summary Type, or print Health Summaries
	;;^UTILITY(U,$J,"OPT",4020,1,3,0)
	;;=for patients, based on ad hoc Health Summary definitions.  The user may
	;;^UTILITY(U,$J,"OPT",4020,1,4,0)
	;;=also use the Information Menu to list and inquire about Health Summary
	;;^UTILITY(U,$J,"OPT",4020,1,5,0)
	;;=Types and Health Summary Components.
	;;^UTILITY(U,$J,"OPT",4020,1,6,0)
	;;=   
	;;^UTILITY(U,$J,"OPT",4020,1,7,0)
	;;=This menu does not contain the options which allow the user to create or
	;;^UTILITY(U,$J,"OPT",4020,1,8,0)
	;;=delete his/her own Health Summary Types.
	;;^UTILITY(U,$J,"OPT",4020,10,0)
	;;=^19.01PI^6^6
	;;^UTILITY(U,$J,"OPT",4020,10,1,0)
	;;=4464^1^1
	;;^UTILITY(U,$J,"OPT",4020,10,1,"^")
	;;=GMTS HS BY PATIENT
	;;^UTILITY(U,$J,"OPT",4020,10,2,0)
	;;=4474^2^2
	;;^UTILITY(U,$J,"OPT",4020,10,2,"^")
	;;=GMTS HS ADHOC
	;;^UTILITY(U,$J,"OPT",4020,10,3,0)
	;;=4473^5^5
	;;^UTILITY(U,$J,"OPT",4020,10,3,"^")
	;;=GMTS HS BY LOC
	;;^UTILITY(U,$J,"OPT",4020,10,4,0)
	;;=5554^6^6
	;;^UTILITY(U,$J,"OPT",4020,10,4,"^")
	;;=GMTS INFO ONLY MENU
	;;^UTILITY(U,$J,"OPT",4020,10,5,0)
	;;=8829^3^3

GMTSI014
GMTSI014	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4020,10,5,"^")
	;;=GMTS HS BY PATIENT & DATE RANG
	;;^UTILITY(U,$J,"OPT",4020,10,6,0)
	;;=8522^4^4
	;;^UTILITY(U,$J,"OPT",4020,10,6,"^")
	;;=GMTS HS BY PATIENT & VISIT
	;;^UTILITY(U,$J,"OPT",4020,25)
	;;=
	;;^UTILITY(U,$J,"OPT",4020,99)
	;;=56474,68172
	;;^UTILITY(U,$J,"OPT",4020,99.1)
	;;=54676,32126
	;;^UTILITY(U,$J,"OPT",4020,"U")
	;;=HEALTH SUMMARY MENU
	;;^UTILITY(U,$J,"OPT",4464,0)
	;;=GMTS HS BY PATIENT^Patient Health Summary^^R^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4464,1,0)
	;;=^^2^2^2950816^^^^
	;;^UTILITY(U,$J,"OPT",4464,1,1,0)
	;;=Generates a Health Summary of a specified pre-defined Health Summary Type
	;;^UTILITY(U,$J,"OPT",4464,1,2,0)
	;;=for a specified patient.
	;;^UTILITY(U,$J,"OPT",4464,2)
	;;=y
	;;^UTILITY(U,$J,"OPT",4464,20)
	;;=
	;;^UTILITY(U,$J,"OPT",4464,25)
	;;=GMTS
	;;^UTILITY(U,$J,"OPT",4464,72)
	;;=W @IOF
	;;^UTILITY(U,$J,"OPT",4464,99)
	;;=54858,49206
	;;^UTILITY(U,$J,"OPT",4464,"U")
	;;=PATIENT HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4465,0)
	;;=GMTS HS MENU^Print Health Summary Menu^^M^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4465,1,0)
	;;=^^5^5^2950816^
	;;^UTILITY(U,$J,"OPT",4465,1,1,0)
	;;=This menu includes all of the various print options available for Health
	;;^UTILITY(U,$J,"OPT",4465,1,2,0)
	;;=Summaries, allowing the user to generate Health Summaries by Patient, by
	;;^UTILITY(U,$J,"OPT",4465,1,3,0)
	;;=Patient and a date range, by patient and a outpatient visit or an
	;;^UTILITY(U,$J,"OPT",4465,1,4,0)
	;;=admission, by Location, for patients at all clinics, and on an Ad Hoc
	;;^UTILITY(U,$J,"OPT",4465,1,5,0)
	;;=basis.
	;;^UTILITY(U,$J,"OPT",4465,10,0)
	;;=^19.01PI^6^6
	;;^UTILITY(U,$J,"OPT",4465,10,1,0)
	;;=4464^1^1
	;;^UTILITY(U,$J,"OPT",4465,10,1,"^")
	;;=GMTS HS BY PATIENT
	;;^UTILITY(U,$J,"OPT",4465,10,2,0)
	;;=4473^5^5
	;;^UTILITY(U,$J,"OPT",4465,10,2,"^")
	;;=GMTS HS BY LOC
	;;^UTILITY(U,$J,"OPT",4465,10,3,0)
	;;=4474^2^2
	;;^UTILITY(U,$J,"OPT",4465,10,3,"^")
	;;=GMTS HS ADHOC
	;;^UTILITY(U,$J,"OPT",4465,10,4,0)
	;;=8773^6^6
	;;^UTILITY(U,$J,"OPT",4465,10,4,"^")
	;;=GMTS HS FOR ALL CLINICS
	;;^UTILITY(U,$J,"OPT",4465,10,5,0)
	;;=8829^3^3
	;;^UTILITY(U,$J,"OPT",4465,10,5,"^")
	;;=GMTS HS BY PATIENT & DATE RANG
	;;^UTILITY(U,$J,"OPT",4465,10,6,0)
	;;=8522^4^4
	;;^UTILITY(U,$J,"OPT",4465,10,6,"^")
	;;=GMTS HS BY PATIENT & VISIT
	;;^UTILITY(U,$J,"OPT",4465,25)
	;;=
	;;^UTILITY(U,$J,"OPT",4465,99)
	;;=56474,68172
	;;^UTILITY(U,$J,"OPT",4465,"U")
	;;=PRINT HEALTH SUMMARY MENU
	;;^UTILITY(U,$J,"OPT",4466,0)
	;;=GMTS TYPE INQ^Inquire about a Health Summary Type^^R^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",4466,1,0)
	;;=^^3^3^2950816^
	;;^UTILITY(U,$J,"OPT",4466,1,1,0)
	;;=This allows the user to display the current definition of a Health Summary
	;;^UTILITY(U,$J,"OPT",4466,1,2,0)
	;;=Type.  The display includes the sequence of components, and occurrence and
	;;^UTILITY(U,$J,"OPT",4466,1,3,0)
	;;=time limits and selection items when they apply to a component.
	;;^UTILITY(U,$J,"OPT",4466,25)
	;;=GMTSRI
	;;^UTILITY(U,$J,"OPT",4466,30)
	;;=
	;;^UTILITY(U,$J,"OPT",4466,31)
	;;=
	;;^UTILITY(U,$J,"OPT",4466,60)
	;;=
	;;^UTILITY(U,$J,"OPT",4466,64)
	;;=
	;;^UTILITY(U,$J,"OPT",4466,80)
	;;=
	;;^UTILITY(U,$J,"OPT",4466,"U")
	;;=INQUIRE ABOUT A HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4467,0)
	;;=GMTS COMP LIST^List Health Summary Components^^P^^^^^^^y^^^1
	;;^UTILITY(U,$J,"OPT",4467,1,0)
	;;=^^2^2^2950816^^^^
	;;^UTILITY(U,$J,"OPT",4467,1,1,0)
	;;=Lists all components which may be used to define Health Summary Types,
	;;^UTILITY(U,$J,"OPT",4467,1,2,0)
	;;=along with several component characteristics.

GMTSI015
GMTSI015	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4467,20)
	;;=K DA,DIC,DIE,DR
	;;^UTILITY(U,$J,"OPT",4467,60)
	;;=GMT(142.1,
	;;^UTILITY(U,$J,"OPT",4467,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",4467,63)
	;;=[GMTS COMP LIST]
	;;^UTILITY(U,$J,"OPT",4467,64)
	;;=@NAME
	;;^UTILITY(U,$J,"OPT",4467,65)
	;;=A
	;;^UTILITY(U,$J,"OPT",4467,66)
	;;=zzz
	;;^UTILITY(U,$J,"OPT",4467,73)
	;;=
	;;^UTILITY(U,$J,"OPT",4467,"U")
	;;=LIST HEALTH SUMMARY COMPONENTS
	;;^UTILITY(U,$J,"OPT",4468,0)
	;;=GMTS TYPE DELETE^Delete Health Summary Type^^E^^^^^^^^^^1^1
	;;^UTILITY(U,$J,"OPT",4468,1,0)
	;;=^^4^4^2950816^
	;;^UTILITY(U,$J,"OPT",4468,1,1,0)
	;;=This option allows the owner of a Health Summary Type to delete it. In
	;;^UTILITY(U,$J,"OPT",4468,1,2,0)
	;;=addition anyone who holds the GMTSMGR key may use this option. Also, if a
	;;^UTILITY(U,$J,"OPT",4468,1,3,0)
	;;=Health Summary Type has a lock, anyone who holds a key with that lock
	;;^UTILITY(U,$J,"OPT",4468,1,4,0)
	;;=value may delete that Health Summary Type.
	;;^UTILITY(U,$J,"OPT",4468,15)
	;;=K %,GMTSMGR
	;;^UTILITY(U,$J,"OPT",4468,20)
	;;=K DA,DIC,DIE,DIK,DR
	;;^UTILITY(U,$J,"OPT",4468,30)
	;;=GMT(142,
	;;^UTILITY(U,$J,"OPT",4468,31)
	;;=AEMQ
	;;^UTILITY(U,$J,"OPT",4468,32)
	;;=Select Health Summary Type:
	;;^UTILITY(U,$J,"OPT",4468,34)
	;;=I X'="GMTS HS ADHOC OPTION"
	;;^UTILITY(U,$J,"OPT",4468,50)
	;;=GMT(142,
	;;^UTILITY(U,$J,"OPT",4468,51)
	;;=[GMTS DELETE HLTH SUM TYPE]
	;;^UTILITY(U,$J,"OPT",4468,"U")
	;;=DELETE HEALTH SUMMARY TYPE
	;;^UTILITY(U,$J,"OPT",4469,0)
	;;=GMTS TYPE ENTER/EDIT^Create/Modify Health Summary Type^^R^^^^^^^^^^1
	;;^UTILITY(U,$J,"OPT",4469,1,0)
	;;=^^9^9^2950816^
	;;^UTILITY(U,$J,"OPT",4469,1,1,0)
	;;=This option allows the user to create or modify a Health Summary Type. New
	;;^UTILITY(U,$J,"OPT",4469,1,2,0)
	;;=types created under this option will automatically define the creator as
	;;^UTILITY(U,$J,"OPT",4469,1,3,0)
	;;=the owner unless creator holds the GMTSMGR security key in which case
	;;^UTILITY(U,$J,"OPT",4469,1,4,0)
	;;=GMTSMGR-holder may designate owner of his choice. Normally Health Summary
	;;^UTILITY(U,$J,"OPT",4469,1,5,0)
	;;=Types may be modified only by their owner. Exceptions are: someone who
	;;^UTILITY(U,$J,"OPT",4469,1,6,0)
	;;=holds the GMTSMGR key may modify any Health Summary Type. If a Health
	;;^UTILITY(U,$J,"OPT",4469,1,7,0)
	;;=Summary Type has a lock, someone who holds a security key with that lock
	;;^UTILITY(U,$J,"OPT",4469,1,8,0)
	;;=value may modify that Health Summary Type. Use the 'Delete Health Summary
	;;^UTILITY(U,$J,"OPT",4469,1,9,0)
	;;=Type' option to delete the Health Summary Type.
	;;^UTILITY(U,$J,"OPT",4469,15)
	;;=
	;;^UTILITY(U,$J,"OPT",4469,20)
	;;=K DA,DIC,DIE,DR
	;;^UTILITY(U,$J,"OPT",4469,25)
	;;=GMTSRM
	;;^UTILITY(U,$J,"OPT",4469,30)
	;;=
	;;^UTILITY(U,$J,"OPT",4469,31)
	;;=
	;;^UTILITY(U,$J,"OPT",4469,50)
	;;=
	;;^UTILITY(U,$J,"OPT",4469,51)
	;;=
	;;^UTILITY(U,$J,"OPT",4469,"U")
	;;=CREATE/MODIFY HEALTH SUMMARY T
	;;^UTILITY(U,$J,"OPT",4470,0)
	;;=GMTS TYPE LIST^List Health Summary Types^^P^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",4470,1,0)
	;;=^^2^2^2950816^
	;;^UTILITY(U,$J,"OPT",4470,1,1,0)
	;;=This option displays a list of all Health Summary Types currently defined,
	;;^UTILITY(U,$J,"OPT",4470,1,2,0)
	;;=with owner and lock information related to each summary type.
	;;^UTILITY(U,$J,"OPT",4470,15)
	;;=
	;;^UTILITY(U,$J,"OPT",4470,20)
	;;=
	;;^UTILITY(U,$J,"OPT",4470,60)
	;;=GMT(142,
	;;^UTILITY(U,$J,"OPT",4470,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",4470,63)
	;;=[GMTS TYPE LIST]
	;;^UTILITY(U,$J,"OPT",4470,64)
	;;=.01
	;;^UTILITY(U,$J,"OPT",4470,65)
	;;=A

GMTSI016
GMTSI016	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4470,66)
	;;=zzz
	;;^UTILITY(U,$J,"OPT",4470,73)
	;;=
	;;^UTILITY(U,$J,"OPT",4470,"U")
	;;=LIST HEALTH SUMMARY TYPES
	;;^UTILITY(U,$J,"OPT",4471,0)
	;;=GMTS HS BY LOC PARAMETERS^Set-up Batch Print Locations^^R^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4471,1,0)
	;;=^^15^15^2950816^
	;;^UTILITY(U,$J,"OPT",4471,1,1,0)
	;;=Allows the user to set-up Health Summary Types to be batch printed nightly
	;;^UTILITY(U,$J,"OPT",4471,1,2,0)
	;;=for all patients at a specified hospital location.
	;;^UTILITY(U,$J,"OPT",4471,1,3,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4471,1,4,0)
	;;=Location may be a ward or a clinic. If location is a clinic, the user is
	;;^UTILITY(U,$J,"OPT",4471,1,5,0)
	;;=asked to specify 'Print Days Ahead.' Health Summaries will then be printed
	;;^UTILITY(U,$J,"OPT",4471,1,6,0)
	;;=for all patients with appointments that many days in the future.
	;;^UTILITY(U,$J,"OPT",4471,1,7,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4471,1,8,0)
	;;=To generate summaries, this option requires that option GMTS TASK STARTUP
	;;^UTILITY(U,$J,"OPT",4471,1,9,0)
	;;=be queued to run nightly.  Summaries should then be printed during the
	;;^UTILITY(U,$J,"OPT",4471,1,10,0)
	;;=night and be ready for distribution by early morning. Thus, 0 Print Days
	;;^UTILITY(U,$J,"OPT",4471,1,11,0)
	;;=Ahead means summaries should be ready to distribute by early morning of
	;;^UTILITY(U,$J,"OPT",4471,1,12,0)
	;;=day of clinic appointment.
	;;^UTILITY(U,$J,"OPT",4471,1,13,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4471,1,14,0)
	;;=For ease in separating printouts queued to the same device, a location
	;;^UTILITY(U,$J,"OPT",4471,1,15,0)
	;;=banner appears in front of each locations Health Summaries.
	;;^UTILITY(U,$J,"OPT",4471,25)
	;;=GMTSPP
	;;^UTILITY(U,$J,"OPT",4471,99)
	;;=55689,37491
	;;^UTILITY(U,$J,"OPT",4471,"U")
	;;=SET-UP BATCH PRINT LOCATIONS
	;;^UTILITY(U,$J,"OPT",4472,0)
	;;=GMTS TASK STARTUP^Startup Task for nightly batch printing^^R^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4472,1,0)
	;;=^^24^24^2950816^^
	;;^UTILITY(U,$J,"OPT",4472,1,1,0)
	;;=This option should be queued to run nightly by the site manager.  Each
	;;^UTILITY(U,$J,"OPT",4472,1,2,0)
	;;=time it runs, it uses parameters set under GMTS HS BY LOC PARAMETERS
	;;^UTILITY(U,$J,"OPT",4472,1,3,0)
	;;=option and queues a task to run now for each set of parameters meeting a
	;;^UTILITY(U,$J,"OPT",4472,1,4,0)
	;;=certain criterion.
	;;^UTILITY(U,$J,"OPT",4472,1,5,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4472,1,6,0)
	;;=When this task runs, it generates Health Summaries of the specified Health
	;;^UTILITY(U,$J,"OPT",4472,1,7,0)
	;;=Summary Type for each patient at the specified location and prints them on
	;;^UTILITY(U,$J,"OPT",4472,1,8,0)
	;;=the specified device.  For ease in separating printout queued to the same
	;;^UTILITY(U,$J,"OPT",4472,1,9,0)
	;;=device, a location banner page appears in front of each set of Health
	;;^UTILITY(U,$J,"OPT",4472,1,10,0)
	;;=Summaries. 
	;;^UTILITY(U,$J,"OPT",4472,1,11,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4472,1,12,0)
	;;=A set of parameters consists of Hospital Location, Health Summary Type,
	;;^UTILITY(U,$J,"OPT",4472,1,13,0)
	;;=Device for Nightly Print, and if Location is a clinic, Print Days Ahead.
	;;^UTILITY(U,$J,"OPT",4472,1,14,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4472,1,15,0)
	;;=Criterion for queueing task: if location is a clinic, option will queue a
	;;^UTILITY(U,$J,"OPT",4472,1,16,0)
	;;=task for that set of parameters ONLY if clinic meets on Desired
	;;^UTILITY(U,$J,"OPT",4472,1,17,0)
	;;=Appointment Day.  Summaries are printed during the night and should be

GMTSI017
GMTSI017	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",4472,1,18,0)
	;;=ready to distribute by early morning. Thus, Desired Appointment Day= (Day
	;;^UTILITY(U,$J,"OPT",4472,1,19,0)
	;;=Summaries are ready to distribute)+(Print Days Ahead).  If clinic meets on
	;;^UTILITY(U,$J,"OPT",4472,1,20,0)
	;;=Desired Appointment Day, task is queued and Summaries are printed for each
	;;^UTILITY(U,$J,"OPT",4472,1,21,0)
	;;=patient with an appointment on that day.
	;;^UTILITY(U,$J,"OPT",4472,1,22,0)
	;;= 
	;;^UTILITY(U,$J,"OPT",4472,1,23,0)
	;;=To see a list of sets of parameters which may spawn tasks, site manager
	;;^UTILITY(U,$J,"OPT",4472,1,24,0)
	;;=should run option GMTS TASK LOCATIONS LIST.
	;;^UTILITY(U,$J,"OPT",4472,25)
	;;=MAIN^GMTSPNJ
	;;^UTILITY(U,$J,"OPT",4472,99)
	;;=55691,49119
	;;^UTILITY(U,$J,"OPT",4472,200.9)
	;;=y
	;;^UTILITY(U,$J,"OPT",4472,"U")
	;;=STARTUP TASK FOR NIGHTLY BATCH
	;;^UTILITY(U,$J,"OPT",4473,0)
	;;=GMTS HS BY LOC^Hospital Location Health Summary^^R^^^^^^n^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4473,1,0)
	;;=^^4^4^2950816^
	;;^UTILITY(U,$J,"OPT",4473,1,1,0)
	;;=Allows user to print health summaries interactively for all patients on a
	;;^UTILITY(U,$J,"OPT",4473,1,2,0)
	;;=specified ward(s), for all patients with appointments at a specified
	;;^UTILITY(U,$J,"OPT",4473,1,3,0)
	;;=outpatient clinic(s), or for all patients scheduled for a specified
	;;^UTILITY(U,$J,"OPT",4473,1,4,0)
	;;=operating room(s) on a selected day or range of days.
	;;^UTILITY(U,$J,"OPT",4473,2)
	;;=y
	;;^UTILITY(U,$J,"OPT",4473,25)
	;;=MAIN^GMTSPD
	;;^UTILITY(U,$J,"OPT",4473,99)
	;;=55425,54053
	;;^UTILITY(U,$J,"OPT",4473,"U")
	;;=HOSPITAL LOCATION HEALTH SUMMA
	;;^UTILITY(U,$J,"OPT",4474,0)
	;;=GMTS HS ADHOC^Ad Hoc Health Summary^^R^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4474,1,0)
	;;=^^5^5^2950816^
	;;^UTILITY(U,$J,"OPT",4474,1,1,0)
	;;=Generates an 'Ad Hoc' Health Summary for specified patients. Instead of
	;;^UTILITY(U,$J,"OPT",4474,1,2,0)
	;;=selecting a pre-defined Health Summary Type, the user defines his own ad
	;;^UTILITY(U,$J,"OPT",4474,1,3,0)
	;;=hoc Health Summary structure for temporary use while using this option.
	;;^UTILITY(U,$J,"OPT",4474,1,4,0)
	;;=The user selects Health Summary components, time and occurrence limits
	;;^UTILITY(U,$J,"OPT",4474,1,5,0)
	;;=when applicable, and selection items when applicable.
	;;^UTILITY(U,$J,"OPT",4474,25)
	;;=GMTSADH
	;;^UTILITY(U,$J,"OPT",4474,99)
	;;=55626,36491
	;;^UTILITY(U,$J,"OPT",4474,"U")
	;;=AD HOC HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",4687,0)
	;;=GMTS TASK LOCATIONS LIST^List Batch Health Summary Locations^^P^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",4687,1,0)
	;;=^^3^3^2950816^
	;;^UTILITY(U,$J,"OPT",4687,1,1,0)
	;;=This option displays a list of all locations which will be checked to see
	;;^UTILITY(U,$J,"OPT",4687,1,2,0)
	;;=if health summaries should be printed in the nightly run of GMTS TASK
	;;^UTILITY(U,$J,"OPT",4687,1,3,0)
	;;=STARTUP.
	;;^UTILITY(U,$J,"OPT",4687,60)
	;;=GMT(142,
	;;^UTILITY(U,$J,"OPT",4687,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",4687,63)
	;;=[GMTS TASK LOCATIONS LIST]
	;;^UTILITY(U,$J,"OPT",4687,64)
	;;=[GMTS TASK LOCATIONS SORT]
	;;^UTILITY(U,$J,"OPT",4687,65)
	;;=A
	;;^UTILITY(U,$J,"OPT",4687,66)
	;;=zzz
	;;^UTILITY(U,$J,"OPT",4687,73)
	;;=
	;;^UTILITY(U,$J,"OPT",4687,"U")
	;;=LIST BATCH HEALTH SUMMARY LOCA
	;;^UTILITY(U,$J,"OPT",5551,0)
	;;=GMTS ENHANCED USER^Health Summary Enhanced Menu^^M^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",5551,1,0)
	;;=^^5^5^2950816^
	;;^UTILITY(U,$J,"OPT",5551,1,1,0)
	;;=This option allows the user to print Health Summaries based on pre-

GMTSI018
GMTSI018	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",5551,1,2,0)
	;;=defined Health Summary Types as well as Ad Hoc Summaries.  The user may
	;;^UTILITY(U,$J,"OPT",5551,1,3,0)
	;;=also list existing Health Summary Types and Health Summary Components and
	;;^UTILITY(U,$J,"OPT",5551,1,4,0)
	;;=may inquire about the structure of a Health Summary Type. This option also
	;;^UTILITY(U,$J,"OPT",5551,1,5,0)
	;;=allows the user to create or delete his own Health Summary Types.
	;;^UTILITY(U,$J,"OPT",5551,10,0)
	;;=^19.01PI^18^8
	;;^UTILITY(U,$J,"OPT",5551,10,1,0)
	;;=4464^1^1
	;;^UTILITY(U,$J,"OPT",5551,10,1,"^")
	;;=GMTS HS BY PATIENT
	;;^UTILITY(U,$J,"OPT",5551,10,2,0)
	;;=4474^2^2
	;;^UTILITY(U,$J,"OPT",5551,10,2,"^")
	;;=GMTS HS ADHOC
	;;^UTILITY(U,$J,"OPT",5551,10,3,0)
	;;=4473^5^5
	;;^UTILITY(U,$J,"OPT",5551,10,3,"^")
	;;=GMTS HS BY LOC
	;;^UTILITY(U,$J,"OPT",5551,10,4,0)
	;;=5554^6^6
	;;^UTILITY(U,$J,"OPT",5551,10,4,"^")
	;;=GMTS INFO ONLY MENU
	;;^UTILITY(U,$J,"OPT",5551,10,15,0)
	;;=4469^7^7
	;;^UTILITY(U,$J,"OPT",5551,10,15,"^")
	;;=GMTS TYPE ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",5551,10,16,0)
	;;=4468^8^8
	;;^UTILITY(U,$J,"OPT",5551,10,16,"^")
	;;=GMTS TYPE DELETE
	;;^UTILITY(U,$J,"OPT",5551,10,17,0)
	;;=8829^3^3
	;;^UTILITY(U,$J,"OPT",5551,10,17,"^")
	;;=GMTS HS BY PATIENT & DATE RANG
	;;^UTILITY(U,$J,"OPT",5551,10,18,0)
	;;=8522^4^4
	;;^UTILITY(U,$J,"OPT",5551,10,18,"^")
	;;=GMTS HS BY PATIENT & VISIT
	;;^UTILITY(U,$J,"OPT",5551,99)
	;;=56474,68172
	;;^UTILITY(U,$J,"OPT",5551,99.1)
	;;=55425,46594
	;;^UTILITY(U,$J,"OPT",5551,"U")
	;;=HEALTH SUMMARY ENHANCED MENU
	;;^UTILITY(U,$J,"OPT",5552,0)
	;;=GMTS COMP DESC LIST^List Health Summary Component Descriptions^^P^^^^^^^y^^^1
	;;^UTILITY(U,$J,"OPT",5552,1,0)
	;;=^^2^2^2950816^^^
	;;^UTILITY(U,$J,"OPT",5552,1,1,0)
	;;=Lists all components which may be used to define Health Summary Types,
	;;^UTILITY(U,$J,"OPT",5552,1,2,0)
	;;=along with the abbreviation and a brief description of each.
	;;^UTILITY(U,$J,"OPT",5552,20)
	;;=K DA,DIC,DIE,DR
	;;^UTILITY(U,$J,"OPT",5552,60)
	;;=GMT(142.1,
	;;^UTILITY(U,$J,"OPT",5552,62)
	;;=0
	;;^UTILITY(U,$J,"OPT",5552,63)
	;;=[GMTS COMP DESC LIST]
	;;^UTILITY(U,$J,"OPT",5552,64)
	;;=@NAME
	;;^UTILITY(U,$J,"OPT",5552,65)
	;;=A
	;;^UTILITY(U,$J,"OPT",5552,66)
	;;=zzz
	;;^UTILITY(U,$J,"OPT",5552,"U")
	;;=LIST HEALTH SUMMARY COMPONENT 
	;;^UTILITY(U,$J,"OPT",5553,0)
	;;=GMTS COMP INQ^Inquire about a Health Summary Component^^R^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",5553,1,0)
	;;=^^2^2^2950816^^
	;;^UTILITY(U,$J,"OPT",5553,1,1,0)
	;;=This allows the user to display the characteristics of a Health Summary
	;;^UTILITY(U,$J,"OPT",5553,1,2,0)
	;;=Component.
	;;^UTILITY(U,$J,"OPT",5553,25)
	;;=GMTSCI
	;;^UTILITY(U,$J,"OPT",5553,"U")
	;;=INQUIRE ABOUT A HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",5554,0)
	;;=GMTS INFO ONLY MENU^Information Menu^^M^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",5554,1,0)
	;;=^^3^3^2950816^
	;;^UTILITY(U,$J,"OPT",5554,1,1,0)
	;;=This menu contains options which provide information only about Health
	;;^UTILITY(U,$J,"OPT",5554,1,2,0)
	;;=Summary Types, Components, Measurement Panels, and Reminder/Maintenance
	;;^UTILITY(U,$J,"OPT",5554,1,3,0)
	;;=Items.
	;;^UTILITY(U,$J,"OPT",5554,10,0)
	;;=^19.01PI^4^5
	;;^UTILITY(U,$J,"OPT",5554,10,1,0)
	;;=4466^1^1
	;;^UTILITY(U,$J,"OPT",5554,10,1,"^")
	;;=GMTS TYPE INQ
	;;^UTILITY(U,$J,"OPT",5554,10,2,0)
	;;=4470^2^2
	;;^UTILITY(U,$J,"OPT",5554,10,2,"^")
	;;=GMTS TYPE LIST
	;;^UTILITY(U,$J,"OPT",5554,10,3,0)
	;;=5553^3^3
	;;^UTILITY(U,$J,"OPT",5554,10,3,"^")
	;;=GMTS COMP INQ
	;;^UTILITY(U,$J,"OPT",5554,10,4,0)
	;;=4467^4^4

GMTSI019
GMTSI019	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",5554,10,4,"^")
	;;=GMTS COMP LIST
	;;^UTILITY(U,$J,"OPT",5554,10,5,0)
	;;=5552^5^5
	;;^UTILITY(U,$J,"OPT",5554,10,5,"^")
	;;=GMTS COMP DESC LIST
	;;^UTILITY(U,$J,"OPT",5554,99)
	;;=56462,46241
	;;^UTILITY(U,$J,"OPT",5554,"U")
	;;=INFORMATION MENU
	;;^UTILITY(U,$J,"OPT",6656,0)
	;;=GMTS MANAGER^Health Summary Overall Menu^^M^^^^^^^^
	;;^UTILITY(U,$J,"OPT",6656,1,0)
	;;=^^2^2^2950202^^^^
	;;^UTILITY(U,$J,"OPT",6656,1,1,0)
	;;=This manager menu includes the four primary menus, (Coordinators menu, 
	;;^UTILITY(U,$J,"OPT",6656,1,2,0)
	;;=Enhanced menu, User menu and Maintenance Menu.
	;;^UTILITY(U,$J,"OPT",6656,10,0)
	;;=^19.01PI^4^4
	;;^UTILITY(U,$J,"OPT",6656,10,1,0)
	;;=3499^1^1
	;;^UTILITY(U,$J,"OPT",6656,10,1,"^")
	;;=GMTS COORDINATOR
	;;^UTILITY(U,$J,"OPT",6656,10,2,0)
	;;=5551^2^2
	;;^UTILITY(U,$J,"OPT",6656,10,2,"^")
	;;=GMTS ENHANCED USER
	;;^UTILITY(U,$J,"OPT",6656,10,3,0)
	;;=4020^3^3
	;;^UTILITY(U,$J,"OPT",6656,10,3,"^")
	;;=GMTS USER
	;;^UTILITY(U,$J,"OPT",6656,10,4,0)
	;;=6659^4
	;;^UTILITY(U,$J,"OPT",6656,10,4,"^")
	;;=GMTS IRM/ADPAC MAINT MENU
	;;^UTILITY(U,$J,"OPT",6656,99)
	;;=56434,65454
	;;^UTILITY(U,$J,"OPT",6656,"U")
	;;=HEALTH SUMMARY OVERALL MENU
	;;^UTILITY(U,$J,"OPT",6657,0)
	;;=GMTS IRM/ADPAC ADHOC LOAD^Rebuild Ad Hoc Health Summary Type^^R^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",6657,1,0)
	;;=^^3^3^2950816^^^^
	;;^UTILITY(U,$J,"OPT",6657,1,1,0)
	;;=Reloads the Ad Hoc Health Summary Type to include ALL Components,
	;;^UTILITY(U,$J,"OPT",6657,1,2,0)
	;;=including any defined by the site, and optionally all temporarily
	;;^UTILITY(U,$J,"OPT",6657,1,3,0)
	;;=DISABLED components, sequenced alphabetically by name.
	;;^UTILITY(U,$J,"OPT",6657,25)
	;;=GMTSLOAD
	;;^UTILITY(U,$J,"OPT",6657,"U")
	;;=REBUILD AD HOC HEALTH SUMMARY 
	;;^UTILITY(U,$J,"OPT",6658,0)
	;;=GMTS IRM/ADPAC TYPE RESEQUENCE^Resequence a Health Summary Type^^R^^^^^^^y^
	;;^UTILITY(U,$J,"OPT",6658,1,0)
	;;=^^3^3^2950816^^^^
	;;^UTILITY(U,$J,"OPT",6658,1,1,0)
	;;=Resequence the components of a given Health Summary Type from 5, in
	;;^UTILITY(U,$J,"OPT",6658,1,2,0)
	;;=increments of 5 (i.e., 5, 10, 15, 20,...,5n where n is the total
	;;^UTILITY(U,$J,"OPT",6658,1,3,0)
	;;=number of components).
	;;^UTILITY(U,$J,"OPT",6658,25)
	;;=GMTSRN
	;;^UTILITY(U,$J,"OPT",6658,"U")
	;;=RESEQUENCE A HEALTH SUMMARY TY
	;;^UTILITY(U,$J,"OPT",6659,0)
	;;=GMTS IRM/ADPAC MAINT MENU^Health Summary Maintenance Menu^^M^^^^^^^y^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",6659,1,0)
	;;=^^2^2^2950816^
	;;^UTILITY(U,$J,"OPT",6659,1,1,0)
	;;=This option will provide the IRM staff with a set of tools for Health
	;;^UTILITY(U,$J,"OPT",6659,1,2,0)
	;;=Summary implementation and maintenance
	;;^UTILITY(U,$J,"OPT",6659,10,0)
	;;=^19.01PI^6^7
	;;^UTILITY(U,$J,"OPT",6659,10,1,0)
	;;=6660^1^1
	;;^UTILITY(U,$J,"OPT",6659,10,1,"^")
	;;=GMTS IRM/ADPAC ENABLE/DISABLE
	;;^UTILITY(U,$J,"OPT",6659,10,2,0)
	;;=6662^2^2
	;;^UTILITY(U,$J,"OPT",6659,10,2,"^")
	;;=GMTS IRM/ADPAC COMP EDIT
	;;^UTILITY(U,$J,"OPT",6659,10,3,0)
	;;=6661^3^3
	;;^UTILITY(U,$J,"OPT",6659,10,3,"^")
	;;=GMTS IRM/ADPAC ADHOC EDIT
	;;^UTILITY(U,$J,"OPT",6659,10,4,0)
	;;=6657^4^4
	;;^UTILITY(U,$J,"OPT",6659,10,4,"^")
	;;=GMTS IRM/ADPAC ADHOC LOAD
	;;^UTILITY(U,$J,"OPT",6659,10,5,0)
	;;=6658^5^5
	;;^UTILITY(U,$J,"OPT",6659,10,5,"^")
	;;=GMTS IRM/ADPAC TYPE RESEQUENCE
	;;^UTILITY(U,$J,"OPT",6659,10,6,0)
	;;=4469^6^6
	;;^UTILITY(U,$J,"OPT",6659,10,6,"^")
	;;=GMTS TYPE ENTER/EDIT
	;;^UTILITY(U,$J,"OPT",6659,10,7,0)
	;;=6887^7^7
	;;^UTILITY(U,$J,"OPT",6659,10,7,"^")
	;;=GMTS IRM/ADPAC PARAMETER EDIT

GMTSI01A
GMTSI01A	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",6659,99)
	;;=56462,46197
	;;^UTILITY(U,$J,"OPT",6659,99.1)
	;;=55425,46594
	;;^UTILITY(U,$J,"OPT",6659,"U")
	;;=HEALTH SUMMARY MAINTENANCE MEN
	;;^UTILITY(U,$J,"OPT",6660,0)
	;;=GMTS IRM/ADPAC ENABLE/DISABLE^Disable/Enable Health Summary Component^^E^^^^^^^y^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",6660,1,0)
	;;=^^3^3^2950816^^^^
	;;^UTILITY(U,$J,"OPT",6660,1,1,0)
	;;=Selectively enable or disable Health Summary Components.  Out of
	;;^UTILITY(U,$J,"OPT",6660,1,2,0)
	;;=order messages may be entered and the disable action may now be
	;;^UTILITY(U,$J,"OPT",6660,1,3,0)
	;;=identified as being either temporary or permanent.
	;;^UTILITY(U,$J,"OPT",6660,30)
	;;=GMT(142.1,
	;;^UTILITY(U,$J,"OPT",6660,31)
	;;=AEMQ
	;;^UTILITY(U,$J,"OPT",6660,32)
	;;=Select COMPONENT:
	;;^UTILITY(U,$J,"OPT",6660,50)
	;;=GMT(142.1,
	;;^UTILITY(U,$J,"OPT",6660,51)
	;;=5;8
	;;^UTILITY(U,$J,"OPT",6660,"U")
	;;=DISABLE/ENABLE HEALTH SUMMARY 
	;;^UTILITY(U,$J,"OPT",6661,0)
	;;=GMTS IRM/ADPAC ADHOC EDIT^Edit Ad Hoc Health Summary Type^^A^^^^^^^y^HEALTH SUMMARY^^1
	;;^UTILITY(U,$J,"OPT",6661,1,0)
	;;=^^4^4^2950816^
	;;^UTILITY(U,$J,"OPT",6661,1,1,0)
	;;=Enter/edit the default parameters (Time and Occurrence limits, Hospital
	;;^UTILITY(U,$J,"OPT",6661,1,2,0)
	;;=Location displayed, ICD Text displayed, Provider Narrative displayed,
	;;^UTILITY(U,$J,"OPT",6661,1,3,0)
	;;=Selection Items and Header names) for components of the Ad Hoc Health
	;;^UTILITY(U,$J,"OPT",6661,1,4,0)
	;;=Summary Type. Components can also be deleted from this option.
	;;^UTILITY(U,$J,"OPT",6661,20)
	;;=D ENADHOC^GMTSRM
	;;^UTILITY(U,$J,"OPT",6661,"U")
	;;=EDIT AD HOC HEALTH SUMMARY TYP
	;;^UTILITY(U,$J,"OPT",6662,0)
	;;=GMTS IRM/ADPAC COMP EDIT^Create/Modify Health Summary Components^^A^^^^^^^y^HEALTH SUMMARY^^1
	;;^UTILITY(U,$J,"OPT",6662,1,0)
	;;=^^3^3^2950816^^^^
	;;^UTILITY(U,$J,"OPT",6662,1,1,0)
	;;=Create/modify new Health Summary components, either by duplication
	;;^UTILITY(U,$J,"OPT",6662,1,2,0)
	;;=and renaming of existing components, or by entering all appropriate
	;;^UTILITY(U,$J,"OPT",6662,1,3,0)
	;;=fields for a component programmed on-site.
	;;^UTILITY(U,$J,"OPT",6662,20)
	;;=D MAIN^GMTSCM
	;;^UTILITY(U,$J,"OPT",6662,99)
	;;=55663,34986
	;;^UTILITY(U,$J,"OPT",6662,"U")
	;;=CREATE/MODIFY HEALTH SUMMARY C
	;;^UTILITY(U,$J,"OPT",6887,0)
	;;=GMTS IRM/ADPAC PARAMETER EDIT^Edit Health Summary Site Parameters^^E^^^^^^^^
	;;^UTILITY(U,$J,"OPT",6887,1,0)
	;;=^^3^3^2950824^^
	;;^UTILITY(U,$J,"OPT",6887,1,1,0)
	;;=This option allows IRM staff or Health  Summary ADPAC to edit the Health
	;;^UTILITY(U,$J,"OPT",6887,1,2,0)
	;;=Summary Parameters, to modify the behavior of Health Summary for your
	;;^UTILITY(U,$J,"OPT",6887,1,3,0)
	;;=site.
	;;^UTILITY(U,$J,"OPT",6887,15)
	;;=
	;;^UTILITY(U,$J,"OPT",6887,20)
	;;=
	;;^UTILITY(U,$J,"OPT",6887,30)
	;;=GMT(142.99,
	;;^UTILITY(U,$J,"OPT",6887,31)
	;;=AEMQL
	;;^UTILITY(U,$J,"OPT",6887,32)
	;;=Select HEALTH SUMMARY PARAMETERS:
	;;^UTILITY(U,$J,"OPT",6887,33)
	;;=
	;;^UTILITY(U,$J,"OPT",6887,50)
	;;=GMT(142.99,
	;;^UTILITY(U,$J,"OPT",6887,51)
	;;=.02;S:X=0 Y=.03;.05T;.03;.04
	;;^UTILITY(U,$J,"OPT",6887,99)
	;;=55649,45175
	;;^UTILITY(U,$J,"OPT",6887,"U")
	;;=EDIT HEALTH SUMMARY SITE PARAM
	;;^UTILITY(U,$J,"OPT",8522,0)
	;;=GMTS HS BY PATIENT & VISIT^Visit Patient Health Summary^^R^^^^^^^^HEALTH SUMMARY^^1^1
	;;^UTILITY(U,$J,"OPT",8522,1,0)
	;;=^^8^8^2951019^^
	;;^UTILITY(U,$J,"OPT",8522,1,1,0)
	;;=Generates Health Summaries of a specified pre-defined Health Summary Type
	;;^UTILITY(U,$J,"OPT",8522,1,2,0)
	;;=for multiple patients. After a patient is selected, the user can pick an

GMTSI01B
GMTSI01B	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"OPT",8522,1,3,0)
	;;=outpatient visit (based on the VISIT File) or an inpatient hospital
	;;^UTILITY(U,$J,"OPT",8522,1,4,0)
	;;=admission (based on the Patient Movement file). If the Patient Care
	;;^UTILITY(U,$J,"OPT",8522,1,5,0)
	;;=Encounter (PCE) package isn't installed then the user can only choose an
	;;^UTILITY(U,$J,"OPT",8522,1,6,0)
	;;=inpatient visit. Data for summaries is based on a date range from the
	;;^UTILITY(U,$J,"OPT",8522,1,7,0)
	;;=outpatient visit or inpatient admission. This Date Range overrides Time
	;;^UTILITY(U,$J,"OPT",8522,1,8,0)
	;;=Limits for components which allows this option.
	;;^UTILITY(U,$J,"OPT",8522,15)
	;;=K GMTSPXGO
	;;^UTILITY(U,$J,"OPT",8522,20)
	;;=S GMTSPXGO=1
	;;^UTILITY(U,$J,"OPT",8522,25)
	;;=GMTS
	;;^UTILITY(U,$J,"OPT",8522,"U")
	;;=VISIT PATIENT HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",8773,0)
	;;=GMTS HS FOR ALL CLINICS^Batch Print of All Clinics by Visit Date^^R^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"OPT",8773,1,0)
	;;=^^8^8^2950816^
	;;^UTILITY(U,$J,"OPT",8773,1,1,0)
	;;=Allows user to interactively designate the batch print of all health
	;;^UTILITY(U,$J,"OPT",8773,1,2,0)
	;;=summaries for patients with appointments at all outpatient clinics on a
	;;^UTILITY(U,$J,"OPT",8773,1,3,0)
	;;=selected day. Summaries will be printed at the print device designated for
	;;^UTILITY(U,$J,"OPT",8773,1,4,0)
	;;=that clinic in the Location Parameters. This option is an alternate method
	;;^UTILITY(U,$J,"OPT",8773,1,5,0)
	;;=to designate when summaries should be printed for all clinics. The nightly
	;;^UTILITY(U,$J,"OPT",8773,1,6,0)
	;;=batch job that prints summaries for wards, clinics and operating rooms
	;;^UTILITY(U,$J,"OPT",8773,1,7,0)
	;;=probably should be disable if the user wants to uses this option on a
	;;^UTILITY(U,$J,"OPT",8773,1,8,0)
	;;=daily basis.
	;;^UTILITY(U,$J,"OPT",8773,25)
	;;=MAIN^GMTSPCD
	;;^UTILITY(U,$J,"OPT",8773,"U")
	;;=BATCH PRINT OF ALL CLINICS BY 
	;;^UTILITY(U,$J,"OPT",8829,0)
	;;=GMTS HS BY PATIENT & DATE RANG^Range of Dates Patient Health Summary^^R^^^^^^^^HEALTH SUMMARY^^1^1
	;;^UTILITY(U,$J,"OPT",8829,1,0)
	;;=^^5^5^2950816^^^^
	;;^UTILITY(U,$J,"OPT",8829,1,1,0)
	;;=Generates Health Summaries of a specified pre-defined Health
	;;^UTILITY(U,$J,"OPT",8829,1,2,0)
	;;=Summary Type for multiple patients. After patients are selected.
	;;^UTILITY(U,$J,"OPT",8829,1,3,0)
	;;=the user can pick a date range. Data for summaries is based on
	;;^UTILITY(U,$J,"OPT",8829,1,4,0)
	;;=the date range. This date range overrides Time Limits for
	;;^UTILITY(U,$J,"OPT",8829,1,5,0)
	;;=components which allow this option.
	;;^UTILITY(U,$J,"OPT",8829,15)
	;;=K GMRANGE
	;;^UTILITY(U,$J,"OPT",8829,20)
	;;=S GMRANGE=1
	;;^UTILITY(U,$J,"OPT",8829,25)
	;;=GMTS
	;;^UTILITY(U,$J,"OPT",8829,"U")
	;;=RANGE OF DATES PATIENT HEALTH 
	;;^UTILITY(U,$J,"OR",159,0)
	;;=159^GMTS^0^^
	;;^UTILITY(U,$J,"OR",159,1,0)
	;;=^100.9951PA^1^1
	;;^UTILITY(U,$J,"OR",159,1,1,0)
	;;=GMTS HS ADHOC
	;;^UTILITY(U,$J,"OR",159,1,1,1,0)
	;;=^100.99511PA^3^3
	;;^UTILITY(U,$J,"OR",159,1,1,1,1,0)
	;;=OR OE/RR MENU CLINICIAN
	;;^UTILITY(U,$J,"OR",159,1,1,1,2,0)
	;;=OR OE/RR MENU NURSE
	;;^UTILITY(U,$J,"OR",159,1,1,1,3,0)
	;;=OR OE/RR MENU WARD CLERK
	;;^UTILITY(U,$J,"PKG",159,0)
	;;=HEALTH SUMMARY^GMTS^Integrated Health Summary Tools
	;;^UTILITY(U,$J,"PKG",159,1,0)
	;;=^^3^3^2950830^^^^
	;;^UTILITY(U,$J,"PKG",159,1,1,0)
	;;=Tools to build and display health summaries.  The health summary pulls
	;;^UTILITY(U,$J,"PKG",159,1,2,0)
	;;=information from ancillary packages and presents it in an integrated

GMTSI01C
GMTSI01C	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PKG",159,1,3,0)
	;;=fashion.
	;;^UTILITY(U,$J,"PKG",159,2,0)
	;;=^9.42A^^0
	;;^UTILITY(U,$J,"PKG",159,3,0)
	;;=^9.43^2^3
	;;^UTILITY(U,$J,"PKG",159,3,1,0)
	;;=GMT(142,
	;;^UTILITY(U,$J,"PKG",159,3,1,4,0)
	;;=^^2^2^2940427^^
	;;^UTILITY(U,$J,"PKG",159,3,1,4,1,0)
	;;=This global contains the definition of which components should be displayed
	;;^UTILITY(U,$J,"PKG",159,3,1,4,2,0)
	;;=for a particular Health Summary Type.
	;;^UTILITY(U,$J,"PKG",159,3,2,0)
	;;=GMT(142.1,
	;;^UTILITY(U,$J,"PKG",159,3,2,4,0)
	;;=^^3^3^2950830^^^^
	;;^UTILITY(U,$J,"PKG",159,3,2,4,1,0)
	;;=This global contains the names of all components available for use in the
	;;^UTILITY(U,$J,"PKG",159,3,2,4,2,0)
	;;="GMT(142," global.  This global is defined by the programmer to identify
	;;^UTILITY(U,$J,"PKG",159,3,2,4,3,0)
	;;=what special selection capabilities are available for each component.
	;;^UTILITY(U,$J,"PKG",159,3,3,0)
	;;=GMT(142.99,
	;;^UTILITY(U,$J,"PKG",159,3,3,4,0)
	;;=^^2^2^2940427^^^^
	;;^UTILITY(U,$J,"PKG",159,3,3,4,1,0)
	;;=This global contains any site parameters which may apply to the Health
	;;^UTILITY(U,$J,"PKG",159,3,3,4,2,0)
	;;=Summary package.
	;;^UTILITY(U,$J,"PKG",159,3,"B","GMT(142,",1)
	;;=
	;;^UTILITY(U,$J,"PKG",159,3,"B","GMT(142.1,",2)
	;;=
	;;^UTILITY(U,$J,"PKG",159,3,"B","GMT(142.99,",3)
	;;=
	;;^UTILITY(U,$J,"PKG",159,4,0)
	;;=^9.44PA^5^3
	;;^UTILITY(U,$J,"PKG",159,4,2,0)
	;;=142.1
	;;^UTILITY(U,$J,"PKG",159,4,2,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",159,4,3,0)
	;;=142
	;;^UTILITY(U,$J,"PKG",159,4,3,222)
	;;=y^y^^n^^^y^o^n
	;;^UTILITY(U,$J,"PKG",159,4,5,0)
	;;=142.99
	;;^UTILITY(U,$J,"PKG",159,4,5,222)
	;;=y^y^^n^^^n^^n
	;;^UTILITY(U,$J,"PKG",159,4,"B",142,3)
	;;=
	;;^UTILITY(U,$J,"PKG",159,4,"B",142.1,2)
	;;=
	;;^UTILITY(U,$J,"PKG",159,4,"B",142.99,5)
	;;=
	;;^UTILITY(U,$J,"PKG",159,5)
	;;=SLC
	;;^UTILITY(U,$J,"PKG",159,7)
	;;=^^I
	;;^UTILITY(U,$J,"PKG",159,8,0)
	;;=^9.404ID^^0
	;;^UTILITY(U,$J,"PKG",159,9)
	;;=^
	;;^UTILITY(U,$J,"PKG",159,11)
	;;=142^142.99
	;;^UTILITY(U,$J,"PKG",159,22,0)
	;;=^9.49I^7^1
	;;^UTILITY(U,$J,"PKG",159,22,7,0)
	;;=2.7^2951020
	;;^UTILITY(U,$J,"PKG",159,22,"B",2.7,7)
	;;=
	;;^UTILITY(U,$J,"PKG",159,15000,0)
	;;=^9.40015^0^1
	;;^UTILITY(U,$J,"PKG",159,15000,0,0)
	;;=0
	;;^UTILITY(U,$J,"PKG",159,15000,"B",0,0)
	;;=
	;;^UTILITY(U,$J,"PKG",159,"DEV")
	;;=SALT LAKE CITY
	;;^UTILITY(U,$J,"PKG",159,"DIBT",0)
	;;=^9.48^1^1
	;;^UTILITY(U,$J,"PKG",159,"DIBT",1,0)
	;;=GMTS TASK LOCATIONS SORT^142
	;;^UTILITY(U,$J,"PKG",159,"DIE",0)
	;;=^9.47^1^2
	;;^UTILITY(U,$J,"PKG",159,"DIE",1,0)
	;;=GMTS DELETE HLTH SUM TYPE^142
	;;^UTILITY(U,$J,"PKG",159,"DIE",2,0)
	;;=GMTS EDIT HLTH SUM TYPE^142
	;;^UTILITY(U,$J,"PKG",159,"DIPT",0)
	;;=^9.46^9^9
	;;^UTILITY(U,$J,"PKG",159,"DIPT",1,0)
	;;=GMTS TYPE LIST^142
	;;^UTILITY(U,$J,"PKG",159,"DIPT",2,0)
	;;=GMTS TYPE INQ^142
	;;^UTILITY(U,$J,"PKG",159,"DIPT",3,0)
	;;=GMTS COMP LIST^142.1
	;;^UTILITY(U,$J,"PKG",159,"DIPT",4,0)
	;;=GMTS TYPE INQ HEADER^142
	;;^UTILITY(U,$J,"PKG",159,"DIPT",5,0)
	;;=GMTS TASK LOCATIONS LIST^142
	;;^UTILITY(U,$J,"PKG",159,"DIPT",6,0)
	;;=GMTS TYPE INQ FOOTER^142
	;;^UTILITY(U,$J,"PKG",159,"DIPT",7,0)
	;;=GMTS COMP DESC LIST^142.1
	;;^UTILITY(U,$J,"PKG",159,"DIPT",8,0)
	;;=GMTS COMP INQ^142.1
	;;^UTILITY(U,$J,"PKG",159,"DIPT",9,0)
	;;=GMTS COMP INQ HEADER^142.1
	;;^UTILITY(U,$J,"PKG",159,"INI")
	;;=GMTSPREI^
	;;^UTILITY(U,$J,"PKG",159,"INIT")
	;;=GMTSPOST^
	;;^UTILITY(U,$J,"PKG",159,"PRE")
	;;=GMTSENV^
	;;^UTILITY(U,$J,"PKG",159,"ST",0)
	;;=^9.444D^^0
	;;^UTILITY(U,$J,"SBF",142,142)
	;;=
	;;^UTILITY(U,$J,"SBF",142,142.01)
	;;=

GMTSI01D
GMTSI01D	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"SBF",142,142.14)
	;;=
	;;^UTILITY(U,$J,"SBF",142,142.2)
	;;=
	;;^UTILITY(U,$J,"SBF",142.1,142.1)
	;;=
	;;^UTILITY(U,$J,"SBF",142.1,142.17)
	;;=
	;;^UTILITY(U,$J,"SBF",142.1,142.35)
	;;=
	;;^UTILITY(U,$J,"SBF",142.99,142.99)
	;;=

GMTSINI1
GMTSINI1	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	; LOADS AND INDEXES DD'S
	;
	K DIF,DIK,D,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DFR,DTN,DIX,DZ D DT^DICRW S %=1,U="^",DSEC=1
	S NO=$P("I 0^I $D(@X)#2,X[U",U,%) I %<1 K DIFQ Q
ASK	I %=1,$D(DIFQ(0)) W !,"SHALL I WRITE OVER FILE SECURITY CODES" S %=2 D YN^DICN S DSEC=%=1 I %<1 K DIFQ Q
	F X="DIB","DIE","DIP","FUN","KEY","OPT" D W Q:'$D(DIFQ)
	Q:'$D(DIFQ)  S %=2 W !!,"ARE YOU SURE EVERYTHING'S OK" D YN^DICN I %-1 K DIFQ Q
	D ^GMTSPREI D NOW^%DTC S DIFROM("INI")=%
	I $D(DIFKEP) F DIDIU=0:0 S DIDIU=$O(DIFKEP(DIDIU)) Q:DIDIU'>0  S DIU=DIDIU,DIU(0)=DIFKEP(DIDIU) D EN^DIU2
	D DT^DICRW K ^UTILITY(U,$J),^UTILITY("DIK",$J) D WAIT^DICD
	S DN="^GMTSI" F R=1:1:49 D @(DN_$$B36(R)) W "."
	F  S D=$O(^UTILITY(U,$J,"SBF","")) Q:D'>0  K:'DIFQ(D) ^(D) S D=$O(^(D,"")) I D>0  K ^(D) D IX
DATA	W "." S (D,DDF(1),DDT(0))=$O(^UTILITY(U,$J,0)) Q:D'>0
	I DIFQR(D) S DTO=0,DMRG=1,DTO(0)=^(D),Z=^(D)_"0)",D0=^(D,0),@Z=D0,DFR(1)="^UTILITY(U,$J,DDF(1),D0,",DKP=DIFQR(D)'=2 F D0=0:0 S D0=$O(^UTILITY(U,$J,DDF(1),D0)) S:D0="" D0=-1 Q:'$D(^(D0,0))  S Z=^(0) D I^DITR
	K ^UTILITY(U,$J,DDF(1)),DDF,DDT,DTO,DFR,DFN,DTN G DATA
	;
W	S Y=$P($T(@X),";",2) W !,"NOTE: This package also contains "_Y_"S",! Q:'$D(DIFQ(0))
	S %=1 W ?6,"SHALL I WRITE OVER EXISTING "_Y_"S OF THE SAME NAME" D YN^DICN I '% W !?6,"Answer YES to replace the current "_Y_"S with the incoming ones." G W
	S:%=2 DIFQ(X)=0 K:%<0 DIFQ
	Q
	;
OPT	;OPTION
RTN	;ROUTINE DOCUMENTATION NOTE
FUN	;FUNCTION
BUL	;BULLETIN
KEY	;SECURITY KEY
HEL	;HELP FRAME
DIP	;PRINT TEMPLATE
DIE	;INPUT TEMPLATE
DIB	;SORT TEMPLATE
DIS	;FORM
	;
SBF	;FILE AND SUB FILE NUMBERS
IX	W "." S DIK="A" F %=0:0 S DIK=$O(^DD(D,DIK)) Q:DIK=""  K ^(DIK)
	S DA(1)=D,DIK="^DD("_D_"," D IXALL^DIK
	I $D(^DIC(D,"%",0)) S DIK="^DIC(D,""%""," G IXALL^DIK
	Q
B36(X)	Q $$N(X\(36*36)#36+1)_$$N(X\36#36+1)_$$N(X#36+1)
N(%)	Q $E("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",%)

GMTSINI2
GMTSINI2	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	;
	;
	K ^UTILITY("DIFROM",$J),DIC S DIDUZ=0 S:$D(DUZ)#2 DIDUZ=DUZ S DUZ=.5
	I $D(^DIC(9.2,0))#2,^(0)?1"HEL".E S (DIC,DLAYGO)=9.2,N="HEL",DIC(0)="LX" G ADD
	Q
	;
ADD	F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R'>0  S X=$P(^(R,0),U,1) W "." K DA D ^DIC I Y>0,'$D(DIFQ(N))!$P(Y,U,3) S ^UTILITY("DIFROM",$J,N,X)=+Y K ^DIC(9.2,+Y,1),^(2),^(3),^(10) S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y D %XY^%RCR
	S DIK=DIC
HELP	S R=$O(^UTILITY("DIFROM",$J,N,R)) Q:R=""  W !,"'"_R_"' Help Frame filed." S DA=^(R)
	F X=0:0 S X=$O(^DIC(9.2,DA,2,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$P(I,U,2) S:Y]"" Y=$O(^DIC(9.2,"B",Y,0)) S ^(0)=$P(^DIC(9.2,DA,2,X,0),U,1)_U_$S(Y>0:Y,1:"")_U_$P(^(0),U,3,99)
	S I=0 F X=0:0 S X=$O(^DIC(9.2,DA,10,X)) Q:'X  I $D(^(X,0)) S Y=$P(^(0),U),Y=$S(Y]"":$O(^MAG("B",Y,0)),1:0) S:Y $P(^DIC(9.2,DA,10,X,0),U)=Y,I=I+1,%=X I 'Y K ^DIC(9.2,DA,10,X,0)
	I I S $P(^DIC(9.2,DA,10,0),U,3,4)=%_U_I
IX	D IX1^DIK G HELP
	;
U	I $D(DIRUT) S DIFQ=1
	W ! Q
REP	S DIR(0)="Y",DIR("A")="Shall I change the NAME of the file to "_DIF
	S DIR("??")="^D REP^DIFROMH1",DIR("B")="NO" D ^DIR G U:$D(DIRUT)
	I Y S DIE=1,DIFQ=0,DA=N,DR=".01////"_DIF D ^DIE Q
	S DIR("A")="Shall I replace your file with mine"
	S DIR("??")="^D AG^DIFROMH1" D ^DIR G U:$D(DIRUT)!'Y
	S DIU(0)="E",DIR("A")="Do you want to keep the Data"
	S DIR("??")="^D CHG^DIFROMH1" D ^DIR G U:$D(DIRUT)
	S:'Y DIU(0)=DIU(0)_"D"
	S DIR("A")="Do you want to keep the Templates"
	S DIR("??")="^D TEMP^DIFROMH1" D ^DIR G U:$D(DIRUT) S:'Y DIU(0)=DIU(0)_"T"
	S DIFQ(N)=1,DIFKEP(N)=DIU(0) W !?15," (",DIF,") " Q

GMTSINI3
GMTSINI3	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	;
	;
	K ^UTILITY("DIFROM",$J) S DIC(0)="LX",(DIC,DLAYGO)=3.6,N="BUL" D ADD:$D(^XMB(3.6,0))
	S X=0 F R=0:0 S X=$O(^UTILITY("DIFROM",$J,N,X)) Q:X=""  W !,"'",X,"' BULLETIN FILED -- Remember to add mail groups for new bulletins."
	I $D(^DIC(9.4,0))#2,^(0)?1"PACK".E S N="PKG",(DIC,DLAYGO)=9.4 D ADD
	G NP:'$D(DA) S %=+$O(^DIC(9.4,DA,22,"B",DIFROM,0)) I $D(^DIC(9.4,DA,22,%,0)) S $P(^(0),U,3)=DT
	I $D(^DIC(9.4,DA,0))#2 S %=$P(^(0),U,4) I %]"" S %=$O(^DIC(9.2,"B",%,0)) S:%]"" $P(^DIC(9.4,DA,0),U,4)=%
OR	I $D(^ORD(100.99))&$O(^UTILITY(U,$J,"OR","")) D EN^GMTSINI4
NP	K DIC,^UTILITY("DIFROM",$J) S DIC(0)="LX" I $D(^DIC(19,0))#2,^(0)?1"OPTION".E S (DIC,DLAYGO)=19,N="OPT" D ADD,OP
	I $D(^DIC(19.1,0))#2,($P(^(0),U)?1"SECUR".E)!($P(^(0),U)="KEY") S (DIC,DLAYGO)=19.1,N="KEY" D ADD K ^UTILITY("DIFROM",$J)
	I $D(^DIC(9.8,0))#2,^(0)?1"ROUTINE^".E S (DIC,DLAYGO)=9.8,N="RTN" D ADD
	S DIC=.5,DLAYGO=0,N="FUN" D ADD
	S DIC("S")="I $P(^(0),U,4)=DIFL" F N="DIPT","DIBT","DIE" S DIC=U_N_"(" D ADD
	K DIC("S") S N="DIST(.404,",DIC=U_N,DLAYGO=.404 D ADD
	S DIC("S")="I $P(^(0),U,8)=DIFL",N="DIST(.403,",DIC=U_N,DLAYGO=.403 D ADD
	K ^UTILITY(U,$J),DIC,DLAYGO F DIFR="DIE","DIPT" D DIEZ
	K ^UTILITY("DIFROM",$J) Q
DIEZ	I ^DD("VERSION")>17.4,'$D(DISYS) D OS^DII
	E  S DISYS=^DD("OS")
	Q:'$D(^DD("OS",DISYS,"ZS"))
	S DIFR1=""
DZ1	S DIFR1=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1)) Q:DIFR1=""
	F DIFR2=0:0 S DIFR2=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1,DIFR2)) Q:'DIFR2  S Y=DIFR2 I $D(@(U_DIFR_"(Y,""ROU"")")) K ^("ROU") I $D(^("ROUOLD")) S X=^("ROUOLD"),DMAX=^DD("ROU") D:X]"" @("EN^DI"_$E(DIFR,3)_"Z")
	G DZ1
	;
OP	S R=$O(^UTILITY("DIFROM",$J,N,R)) I R="" K ^UTILITY("DIFROM",$J) G Q
	W !,"'"_R_"' Option Filed" S DA=+^UTILITY("DIFROM",$J,N,R) G:$P(^(R),U,2,3)="XUCORE^"!($P(^(R),U,2,3)="XUCOMMAND^") OP
	I $D(^DIC(19,DA,220)) S %=$P(^(220),U) S:%]"" %=$O(^XMB(3.6,"B",%,0)) S $P(^DIC(19,DA,220),U)=%,%=$P(^(220),U,3) S:%]"" %=$O(^XMB(3.8,"B",%,0)) S $P(^DIC(19,DA,220),U,3)=%
	S %=$P(^DIC(19,DA,0),U,12) S:%]"" %=$O(^DIC(9.4,"B",%,0))
	S $P(^DIC(19,DA,0),U,12)=%,%=$P(^(0),U,7),(DZ,DIX)=0
	D:$D(^DIC(19,DA,10,"B")) KAD(DA) S:%]"" %=$O(^DIC(9.2,"B",%,0)) S $P(^DIC(19,DA,0),U,7)=%,%=$P(^(0),U,4),%="MOQXL"[% K ^(10,"B"),^("C")
	F X=0:0 S X=$O(^DIC(19,DA,10,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$S($D(^(U)):^(U),1:"") K ^DIC(19,DA,10,X) I Y]"",% S D=$O(^DIC(19,"B",Y,0)) I D S ^DIC(19,DA,10,X,0)=D_U_$P(I,U,2,9),DZ=DZ+1,DIX=X
	S:% ^DIC(19,DA,10,0)="^19.01PI^"_DIX_U_DZ D IX1^DIK G OP
	;
ADD	F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R=""  S X=$P(^(R,0),U),DIFL=$S(N="DIST(.403,":$P(^(0),U,8),N="DIST(.404,":$P(^(0),U,2),1:$P(^(0),U,4)) W "." K DA D ^DIC I Y>0,'$D(DIFQ($E(N,1,3)))!$P(Y,U,3) S Y=Y_U D A
Q	Q
A	I N="BUL" K % S %(0)=$G(@(DIC_"+Y,2,0)")) F %=0:0 S %=$O(@(DIC_"+Y,2,%)")) Q:'%  S %(%)=$G(^(%,0))
	K:N'="KEY"&(N'="OPT") @(DIC_"+Y)") S ^UTILITY("DIFROM",$J,N,X)=Y S:$E(N,1,2)="DI" ^(X,+Y)="" S:N="PKG" DIFROM(0)=+Y Q:$P(Y,U,2,3)="XUCORE^"!($P(Y,U,2,3)="XUCOMMAND^")
	I N="BUL",%(0)]"" S @(DIC_"+Y,2,0)")=%(0) F %=0:0 S %=$O(%(%)) Q:'%  S @(DIC_"+Y,2,%,0)")=%(%)
	I $E(N,1,2)="DI",('DIFL)!('$D(^DD(+DIFL))) D
	.W !,"**WARNING--"_$S(N="DIE":"INPUT",N="DIPT":"PRINT",N="DIBT":"SORT",1:"FORM or BLOCK")_$S(N'["DIST":" template ",1:" ")_$P(Y,U,2)_" has been installed,",!,"but associated file "_DIFL_" is not on your system!"
	.Q
	I N="OPT" S:$P(^DIC(19,+Y,0),U,6)]"" DIOPT=$P(^(0),U,6) I $O(^UTILITY(U,$J,N,R,1,0)) K ^DIC(19,+Y,1)
	I N="DIST(.403," D BLK
	S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y,DIK=DIC D %XY^%RCR
	D IX1^DIK:N'="OPT" I N="OPT",$D(DIOPT) S:$P(^DIC(19,DA,0),U,6)="" $P(^(0),U,6)=DIOPT K DIOPT
	I N="DIST(.403," D
	.N DIFRVAL S DIFRVAL=$$VAL^DIFROMSS(.403,DA)
	.I DIFRVAL W !,"Compiling form: ",$P(^DIST(.403,DA,0),U) D EN^DDSZ(DA) Q
	.W !,"ERROR: Form: ",$P(^DIST(.403,DA,0),U)," cannot be compiled"
	.Q
	Q
BLK	F J=0:0 S J=$O(^UTILITY(U,$J,N,R,40,J)) Q:'J  I $D(^(J,0)) S %=$P(^(0),U,2) S:%]"" %=$O(^DIST(.404,"B",%,0)) S:% $P(^UTILITY(U,$J,N,R,40,J,0),U,2)=% D B1
	K A0,A1,A2,J,L Q
B1	F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,40,L)) Q:'L  S A0=$G(^(L,0)),%=$P(A0,U) I %]"" S %=$O(^DIST(.404,"B",%,0)) I % S $P(A0,U)=%,^UTILITY(U,$J,N,R,40,J,"BLK",%,0)=A0 D
	.N X S X=0
	.F  S X=$O(^UTILITY(U,$J,N,R,40,J,40,L,X)) Q:X=""  S ^UTILITY(U,$J,N,R,40,J,"BLK",%,X)=^(X)
	.Q
	S A0=$G(^UTILITY(U,$J,N,R,40,J,40,0)) Q:A0=""  K ^UTILITY(U,$J,N,R,40,J,40) S (A1,A2)=0
	F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,"BLK",L)) Q:'L  S ^UTILITY(U,$J,N,R,40,J,40,L,0)=^(L,0),A1=L,A2=A2+1 D
	.N X S X=0
	.F  S X=$O(^UTILITY(U,$J,N,R,40,J,"BLK",L,X)) Q:X=""  S ^UTILITY(U,$J,N,R,40,J,40,L,X)=^(X)
	.Q
	S $P(A0,U,3,4)=A1_U_A2,^UTILITY(U,$J,N,R,40,J,40,0)=A0 K ^UTILITY(U,$J,N,R,40,J,"BLK")
	Q
KAD(D0)	N D1,X
	S X=0 F  S X=$O(^DIC(19,D0,10,"B",X)) Q:X'>0  S D1=0 F  S D1=$O(^DIC(19,D0,10,"B",X,D1)) Q:D1'>0  K ^DIC(19,"AD",X,D0,D1)
	Q

GMTSINI4
GMTSINI4	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	;
	;
EN	S DA(1)=1,DIK="^ORD(100.99,1,5," I $D(^ORD(100.99,1,5,DA)) D ^DIK
	S %X="^UTILITY(U,$J,""OR"","_$O(^UTILITY(U,$J,"OR",""))_",",%Y=DIK_DA_","
	S:'$D(^ORD(100.99,1,5,0)) ^(0)="^100.995P^^" S $P(^(0),U,3,4)=DA_U_($P(^(0),U,4)+1)
	D %XY^%RCR S $P(^ORD(100.99,1,5,DA,0),U)=DA,%=$P(^(0),U,4)
	I %]"" S %=$O(^ORD(100.98,"B",%,0)) I %>0 S $P(^ORD(100.99,1,5,DA,0),U,4)=%
	D OR
	S DA(1)=1 D IX1^DIK
	Q
OR	S (N,I)=0,X=""
	F  S N=$O(^ORD(100.99,1,5,DA,1,N)) Q:'N  S X=$P(^(N,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,0)=% S X=N,I=I+1,(R,J)=0,Y="" D OR1
	S:I $P(^ORD(100.99,1,5,DA,1,0),U,3,4)=X_U_I S (N,I)=0,X=""
	F  S N=$O(^ORD(100.99,1,5,DA,5,N)) Q:'N  S X=$P(^(N,0),U,3) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% $P(^ORD(100.99,1,5,DA,5,N,0),U,3)=% S X=N,I=I+1
	S:I $P(^ORD(100.99,1,5,DA,5,0),U,3,4)=X_U_I K N,R,X,Y,I,J
	Q
OR1	N X F  S R=$O(^ORD(100.99,1,5,DA,1,N,1,R)) Q:'R  S X=$P(^(R,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,1,R,0)=% S Y=R,J=J+1
	S:J $P(^ORD(100.99,1,5,DA,1,N,1,0),U,3,4)=Y_U_J
	Q
ADDP	N I,J,N,R,DA,DLAYGO S %=""
	S DIC="^ORD(101,",DIC(0)="LX",DLAYGO=101 D FILE^DICN K DIC Q:Y=-1  S %=+Y Q

GMTSINI5
GMTSINI5	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	K ^UTILITY("DIF",$J) S DIFRDIFI=1 F I=1:1:6 S ^UTILITY("DIF",$J,DIFRDIFI)=$T(IXF+I),DIFRDIFI=DIFRDIFI+1
	Q
IXF	;;HEALTH SUMMARY^GMTS
	;;142;HEALTH SUMMARY TYPE;^GMT(142,;0;y;y;;n;;;y;o;n
	;;
	;;142.1I;HEALTH SUMMARY COMPONENT;^GMT(142.1,;0;y;y;;n;;;y;o;n
	;;
	;;142.99;HEALTH SUMMARY PARAMETERS;^GMT(142.99,;0;y;y;;n;;;n;;n
	;;

GMTSINIS
GMTSINIS	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
PAC(PKG,VER)	; called from package init (DIFROM7 created this routine)
	; PKG = $T(IXF) of the INIT routine.
	; VER is an array that is contained in DIFROM from the INIT routine
	;
	N %,%I,%H,DATE,DIFROM,NOW,PACKAGE,RUN,SERVER,SITE,START,X,XMDUZ,XMSUB,XMTEXT,XMY,Y K ^TMP("GMTSINIS",$J)
	;
	; Site tracking updates only occur if run in a VA production primary domain
	; account.
	I $G(^XMB("NETNAME"))'[".VA.GOV" Q
	Q:'$D(^%ZOSF("UCI"))  Q:'$D(^%ZOSF("PROD"))
	X ^%ZOSF("UCI") I Y'=^%ZOSF("PROD") Q
	;
	S SERVER="S.A5CSTS@FORUM.VA.GOV"
	S PACKAGE=$P($P(PKG,";",3),U)
	S SITE=$G(^XMB("NETNAME"))
	S START=$P($G(^DIC(9.4,VER(0),"PRE")),U,2) I '$L(START) S START="Unknown"
	D  ; check if ok to use kernel functions
	.S X="XLFDT" X ^%ZOSF("TEST") I $T D  Q
	..S NOW=$$HTFM^XLFDT($H)
	..S RUN="Unknown" I START S RUN=$$FMDIFF^XLFDT(NOW,START,3)
	..S START=$$FMTE^XLFDT(START)
	..S DATE=NOW\1
	..S NOW=$$FMTE^XLFDT(NOW)
	.D NOW^%DTC S NOW=%,DATE=X
	.S RUN="" ; don't bother to compute
	.S Y=START D DD^%DT S START=Y
	.S Y=NOW D DD^%DT S NOW=Y
	;
	; Message for server
	S ^TMP("GMTSINIS",$J,1,0)="PACKAGE INSTALL"
	S ^TMP("GMTSINIS",$J,2,0)="SITE: "_SITE
	S ^TMP("GMTSINIS",$J,3,0)="PACKAGE: "_PACKAGE
	S ^TMP("GMTSINIS",$J,4,0)="VERSION: "_VER
	S ^TMP("GMTSINIS",$J,5,0)="Start time: "_START
	S ^TMP("GMTSINIS",$J,6,0)="Completion time: "_NOW
	S ^TMP("GMTSINIS",$J,7,0)="Run time: "_RUN
	S ^TMP("GMTSINIS",$J,8,0)="DATE: "_DATE
	;
	; Data is sent to server on FORUM - S.A5CSTS
	S XMY(SERVER)="",XMDUZ=.5,XMTEXT="^TMP(""GMTSINIS"",$J,",XMSUB=PACKAGE_" VERSION "_VER_" INSTALLATION"
	D ^XMD
	K ^TMP("GMTSINIS",$J)
	Q

GMTSINIT
GMTSINIT	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	;
	K DIF,DIFQ,DIFQR,DIFQN,DIK,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DIFROM,DFR,DTN,DIX,DZ,DIRUT,DTOUT,DUOUT
	S DIOVRD=1,U="^",DIFQ=0,DIFROM="2.7" W !,"This version (#2.7) of 'GMTSINIT' was created on 19-OCT-1995"
	W !?9,"(at ISCSLC, by VA FileMan V.21.0)",!
	I $D(^DD("VERSION")),^("VERSION")'<21 G GO
	;W !,"FIRST, I'LL FRESHEN UP YOUR VA FILEMAN...." D N^DINIT
	I ^DD("VERSION")<21 W !,"but I need version 21 of the VA FileMan!" G Q
GO	;
	W !,"I HAVE TO RUN AN ENVIRONMENT CHECK ROUTINE." D PKG,^GMTSENV Q:'$D(DIFQ)  D NOW^%DTC S DIFROM("PRE")=%
EN	; ENTER HERE TO BYPASS THE PRE-INIT PROGRAM
	S DIFQ=0 K DIRUT,DTOUT,DUOUT
	F DIFRIR=1:1:1 S DIFRRTN="^GMTSINI"_$E("5",DIFRIR) D @DIFRRTN
	W:1 !,"I AM GOING TO SET UP THE FOLLOWING FILES:" F I=1:2:6 S DIF(I)=^UTILITY("DIF",$J,I) D 1 G Q:DIFQ!$D(DIRUT) K DIF(I)
	S DIFROM="2.7" D PKG:'$D(DIFROM(0)),^GMTSINI1 G Q:'$D(DIFQ) S DIK(0)="AB"
	F DIF=1:2:6 S %=^UTILITY("DIF",$J,DIF),DIK=$P(%,";",5),N=$P(%,";",3),D=$P(%,";",4)_U_N D D K DIFQ(N)
	K DIFQR D ^GMTSINI2,^GMTSINI3
	L  S DUZ=DIDUZ W:1 !,"NO"_$P("TE THAT FILE",U,DSEC)_" SECURITY-CODE PROTECTION HAS BEEN MADE"
	D ^GMTSPOST,NOW^%DTC S DIFROM("INIT")=%
	I DIFROM F DIF=1:2:6 S %=^UTILITY("DIF",$J,DIF),N=+$P(%,";",3) I N,$P(%,";",8)="y" S ^DD(N,0,"VR")=DIFROM
	I DIFROM(0)>0 F %="PRE","INI","INIT" S:$D(DIFROM(%)) $P(^DIC(9.4,DIFROM(0),%),U,2)=DIFROM(%)
	I $G(DIFQN) S $P(^(0),U,3,4)=$P(DIFQN,U,2)_U_($P(^DIC(0),U,4)+DIFQN) K DIFQN
	I DIFROM,$D(^%ZTSK) S X="GMTSINIS" X ^%ZOSF("TEST") D:$T PAC^GMTSINIS($T(IXF),.DIFROM)
	S:DIFROM(0)>0 ^DIC(9.4,DIFROM(0),"VERSION")=DIFROM G Q^DIFROM0
D	S:$D(^DIC(+N,0))[0 ^(0)=D S X=$D(@(DIK_"0)")),^(0)=D_U_$S(X#2:$P(^(0),U,3,9),1:U)
	S DIFQR=DIFQR(+N) I ^DD("VERSION")>17.5,$D(^DD(+N,0,"DIK"))#2 S X=^("DIK"),Y=+N,DMAX=^DD("ROU") D EN^DIKZ
	I DIFQR D IXALL^DIK:$O(@(DIK_"0)")) W "."
	Q
R	G REP^GMTSINI2
	;
1	S N=+$P(DIF(I),";",3),DIF=$P(DIF(I),";",4),S=$P(DIF(I),";",5)
	W !!?3,N,?13,DIF,$P("  (Partial Definition)",U,$P(DIF(I),";",6)),$P("  (including data)",U,$P(DIF(I),";",13)="y") S Z=$S($D(^DIC(N,0))#2:^(0),1:"")
	I Z="" S DIFQ(N)=1,DIFQN=$G(DIFQN)+1_U_N G S
	I $L($P(Z,DIF)) W $C(7),!,"*BUT YOU ALREADY HAVE '",$P(Z,U),"' AS FILE #",N,"!" D R Q:DIFQ  G S:$D(DIFKEP(N)),1
	S DIFQ(N)=$P(DIF(I),";",7)'="n"
	I $L(Z) W $C(7),!,"Note:  You already have the '",$P(Z,U),"' File." S DIFQ(0)=1
	S %=$E(^UTILITY("DIF",$J,I+1),4,245) I %]"" X % S DIFQ(N)=$T W:'$T !,"Screen on this Data Dictionary did not pass--DD will not be installed!" G S
	I $L(Z),$P(DIF(I),";",10)="y" S DIR("A")="Shall I write over the existing Data Definition",DIR("??")="^D DD^DIFROMH1",DIR("B")="YES",DIR(0)="Y" D ^DIR S DIFQ(N)=Y
S	S DIFQR(N)=0 Q:$P(DIF(I),";",13)'="y"!$D(DIRUT)
	I $P(DIF(I),";",15)="y",$O(@(S_"0)"))>0 S DIF=$P(DIF(I),";",14)="o",DIR("A")="Want my data "_$P("merged with^to overwrite",U,DIF+1)_" yours",DIR("??")="^D DTA^DIFROMH1",DIR(0)="Y" D ^DIR S DIFQR(N)=$S('Y:Y,1:Y+DIF) Q
	S %=$P(DIF(I),";",14)="o" W !,$C(7),"I will ",$P("MERGE^OVERWRITE",U,%+1)," your data with mine." S DIFQR(N)=%+1
	Q
Q	W $C(7),!!,"NO UPDATING HAS OCCURRED!" G Q^DIFROM0
	;
PKG	S X=$P($T(IXF),";",3),DIC="^DIC(9.4,",DIC(0)="",DIC("S")="I $P(^(0),U,2)="""_$P(X,U,2)_"""",X=$P(X,U) D ^DIC S DIFROM(0)=+Y K DIC
	Q
	;
IXF	;;HEALTH SUMMARY^GMTS;0

GMTSLOAD
GMTSLOAD	;SLC/JER - Loads Ad Hoc Summary Type ;11/22/91  12:55
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching and execution
	N DIC,DIR,GMI,GMW,GMTJ,GMTNM,GMTSEG,GMTSFUNC,GMTSI,GMTSIFN,GMTSWHL,INCLUDE,S2,X,Y
	W !!,"This option rebuilds the Ad Hoc Health Summary to include ALL components",!
	W "alphabetized by name.  If you wish, you may exclude DISABLED components.",!
	S DIR(0)="Y",DIR("A")="Do you wish to continue",DIR("B")="NO",DIR("?")="Answer ""Y"" or ""N"", ""NO"" to exit this option." D ^DIR Q:Y=0  W !
	I $S($D(DIRUT):1,$D(DIROUT):1,1:0) Q
	S DIR("?")="Answer ""Y"" or ""N"", ""YES"" to include DISABLED components."
	S DIR("A")="Should DISABLED components be included",DIR("B")="YES" D ^DIR
	I $S($D(DIRUT):1,$D(DIROUT):1,1:0) Q
	S INCLUDE=Y
ENPOST	; Entry point from Post-init
	; call with INCLUDE=0 to exclude DISABLED components
	; call with INCLUDE=1 to include DISABLED components
	N NEWREC,GMTSTYP,DLAYGO
	S DLAYGO=142
	S DIC=142,DIC(0)="LXF",X="GMTS HS ADHOC OPTION" D ^DIC K DIC
	I +Y'>0 D NOFILE Q
	S (GMTSIFN,GMTSTYP)=+Y,NEWREC=+$P(Y,U,3)
	S:'$D(^GMT(142,GMTSIFN,1,0)) ^(0)="^142.01IA^0^0"
	S GMTNM="" F GMI=1:1 S GMTNM=$O(^GMT(142.1,"B",GMTNM)) Q:GMTNM']""  S GMTJ=$O(^(GMTNM,0)) Q:GMTJ'>0  D LOAD
	S GMTSI=0 I 'NEWREC F  S GMTSI=$O(^GMT(142,GMTSIFN,1,GMTSI)) Q:GMTSI'>0  D PURGE^GMTSRN
	W !!,"Rebuilding Ad Hoc Summary"
	D RNMBR^GMTSRN W !,"Done."
	Q
NOFILE	; Handles case where GMTS HS ADHOC OPTION Summary Type is missing
	W !!,"** GMTS AD HOC OPTION Summary Type is missing **",!
	Q
LOAD	; Loads GMTSEG(GMI)=SEQUENCE^COMPONENT^OCCURRENCE LIMIT^TIME LIMIT^
	;   NULL^HOSP LOC DISPLAYED^ICD TEXT DISPLAYED^PROVIDER NARR DISPLAYED
	N OCC,TIME,GMSEQ,HOSPLOC,ICDTEXT,PROVNARR
	Q:'$D(^GMT(142.1,GMTJ,0))
	S GMSEQ=$O(^GMT(142,"AE",GMTJ,GMTSTYP,0))
	I GMSEQ>0 D
	. S OCC=$S($P(^GMT(142.1,GMTJ,0),U,5)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,3),1:"")
	. S TIME=$S($P(^GMT(142.1,GMTJ,0),U,3)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,4),1:"")
	. S HOSPLOC=$S($P(^GMT(142.1,GMTJ,0),U,10)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,6),1:"")
	. S ICDTEXT=$S($P(^GMT(142.1,GMTJ,0),U,11)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,7),1:"")
	. S PROVNARR=$S($P(^GMT(142.1,GMTJ,0),U,12)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,8),1:"")
	E  D
	. S OCC=$S($P(^GMT(142.1,GMTJ,0),U,5)="Y":10,1:"")
	. S TIME=$S($P(^GMT(142.1,GMTJ,0),U,3)="Y":"1Y",1:"")
	. S HOSPLOC=$S($P(^GMT(142.1,GMTJ,0),U,10)="Y":"Y",1:"")
	. S ICDTEXT=$S($P(^GMT(142.1,GMTJ,0),U,11)="Y":"L",1:"")
	. S PROVNARR=$S($P(^GMT(142.1,GMTJ,0),U,12)="Y":"Y",1:"")
	D SETSEG
	Q
SETSEG	; Set GMTSEG(GMI)
	N OFF
	S OFF=$S($P(^GMT(142.1,GMTJ,0),U,6)="P":1,$P(^(0),U,6)="T":1,1:0)
	I (INCLUDE=0),(OFF=1) Q
	S GMTSEG(GMI)=(5*GMI)_U_GMTJ_U_OCC_U_TIME_U_U_HOSPLOC_U_ICDTEXT_U_PROVNARR
	I GMSEQ>0 D SETSEL
	Q
SETSEL	; Sets up selection items in GMTSEG(GMI,GMSEL)=Selection item
	N GMSEL,GMITEM,GMW,S2
	S GMSEL=0 F  S GMSEL=$O(^GMT(142,GMTSTYP,1,+GMSEQ,1,GMSEL)) Q:GMSEL'>0  S GMITEM=^(GMSEL,0) S GMTSEG(GMI,GMSEL)=GMITEM
	Q

GMTSLRA
GMTSLRA	;SLC/JER - Surgical Pathology Component Driver ;3/29/95  11:51
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMI,MAX,LRDFN,IX,X,IX0
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR")
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	D ^GMTSLRAE
	I '$D(^TMP("LRA",$J)) Q
	S IX=0
	F GMI=1:1:MAX S IX=$O(^TMP("LRA",$J,IX)) Q:IX'>0  D:GMI>1 CKP^GMTSUP Q:$D(GMTSQIT)  W:GMI>1&('GMTSNPG) ! D
	.S IX0=""
	.F  S IX0=$O(^TMP("LRA",$J,IX,IX0)) Q:IX0=""!(IX0?1A)  S X=^TMP("LRA",$J,IX,IX0) D WRT
	. I $D(^TMP("LRA",$J,IX,1.2)) D SUPPR
	K ^TMP("LRA",$J)
	Q
WRT	; Writes Surgical Pathology Record
	N IX1,GMJ
	I IX0=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?8,"Collected:",?19,$P(X,U),?31,"Acc:",?36,$P(X,U,2),! Q
	I IX0=.1 D WRTSPC Q
	I $S(IX0=.2:1,IX0=1:1,IX0=1.1:1,IX0=1.3:1,IX0=1.4:1,1:0) D TEXT Q
	I IX0=2 S IX1=0 F  S IX1=$O(^TMP("LRA",$J,IX,IX0,IX1)) Q:IX1'>0  S X=^(IX1) D WRTTM,WRTP
	Q
WRTSPC	; Writes Specimen field entries
	N GMS
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Specimen:"
	S GMS=0
	F  S GMS=$O(^TMP("LRA",$J,IX,.1,GMS)) Q:GMS'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?19,^TMP("LRA",$J,IX,.1,GMS),!
	Q
TEXT	; Handles GROSS DESCRIPTION & MICROSCOPIC EXAM/DX Print
	N LN,GMTSLN,GMTSLNI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?(17-$L(X)),X_":",!
	S LN=0
	F  S LN=$O(^TMP("LRA",$J,IX,IX0,LN)) Q:LN'>0  S GMTSLN=^(LN) D
	.I $L(GMTSLN)>78 S GMTSLN=$$WRAP^GMTSORC(GMTSLN,78)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMTSLN,"|"),! D
	..F GMTSLNI=2:1:$L(GMTSLN,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSLN,"|",GMTSLNI)]"" $P(GMTSLN,"|",GMTSLNI),!
	Q
SUPPR	; Writes Supplementary Report
	N GMTSR,SRDATE,X
	S IX1=0
	F  S IX1=$O(^TMP("LRA",$J,IX,1.2,IX1)) Q:IX1'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  S SRDATE=^TMP("LRA",$J,IX,1.2,IX1,0) S X=SRDATE D REGDTM^GMTSU W "Supplementary Rpt: ",X,! D
	.S GMTSR=0
	.F  S GMTSR=$O(^TMP("LRA",$J,IX,1.2,IX1,GMTSR)) Q:GMTSR'>0  S GMTSRL=^(GMTSR) D
	..I $L(GMTSRL)>78 S GMTSRL=$$WRAP^GMTSORC(GMTSRL,78)
	..W $P(GMTSRL,"|"),! D
	...F GMTSRLI=2:1:$L(GMTSRL,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSRL,"|",GMTSRLI)]"" $P(GMTSRL,"|",GMTSRLI),!
	Q
WRTTM	; Writes Topography and Morphology
	N GMT,GMD,GME
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Topography:",?19,$P(X,U),!
	I $O(^TMP("LRA",$J,IX,IX0,IX1,1,0)) D CKP^GMTSUP Q:$D(GMTSQIT)
	S GMD=0
	F  S GMD=$O(^TMP("LRA",$J,IX,IX0,IX1,1,GMD)) Q:GMD'>0  W:GMD=1 ?9,"Disease:" W ?21,^TMP("LRA",$J,IX,IX0,IX1,1,GMD),! Q
	I $O(^TMP("LRA",$J,IX,IX0,IX1,2,0)) D CKP^GMTSUP Q:$D(GMTSQIT)
	S GMT=0
	F  S GMT=$O(^TMP("LRA",$J,IX,IX0,IX1,2,GMT)) Q:GMT'>0  D
	.I GMT'=4 D CKP^GMTSUP Q:$D(GMTSQIT)
	.I  W ?7,"Morphology:",?21,^TMP("LRA",$J,IX,IX0,IX1,2,GMT),! D  Q
	..S GME=0
	..F  S GME=$O(^TMP("LRA",$J,IX,IX0,IX1,2,GMT,1,GME)) Q:GME'>0  D
	...D CKP^GMTSUP Q:$D(GMTSQIT)  W:GME=1 ?9,"Etiology:" W ?23,^TMP("LRA",$J,IX,IX0,IX1,2,GMT,1,GME),! Q
	Q
WRTP	; Writes Procedure field
	N GMQ,GMK
	I $O(^TMP("LRA",$J,IX,IX0,IX1,4,0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Procedures:"
	S GMT=0
	F  S GMT=$O(^TMP("LRA",$J,IX,IX0,IX1,4,GMT)) Q:GMT'>0  D
	.S GMQ=$P(^TMP("LRA",$J,IX,IX0,IX1,4,GMT),U)
	.I $L(GMQ)>56 S GMQ=$$WRAP^GMTSORC(GMQ,56)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,$P(GMQ,"|"),! D
	..F GMK=2:1:$L(GMQ,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMQ,"|",GMK)]"" ?23,$P(GMQ,"|",GMK),!
	Q

GMTSLRAE
GMTSLRAE	;SLC/JER - Surgical Pathology Extract ;3/29/95  11:52
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	N IX0,IX
	K ^TMP("LRA",$J)
	S IX=GMTS1 F IX0=1:0:MAX S IX=$O(^LR(LRDFN,"SP",IX)) Q:IX'>0!(IX>GMTS2)  D APSET
	K AP
	Q
APSET	;Sets ^TMP("LRA",$J
	N ACC,CDT,DA,DIC,DIQ,DR,GMW,SN,X,YR
	S CDT=$P(^LR(LRDFN,"SP",IX,0),U),YR=$E(CDT,2,3),ACC=$P(^(0),U,6)
	I $S(+$P(^LR(LRDFN,"SP",IX,0),U)'>0:1,+$P(^(0),U,11)'>0:1,1:0) Q
	I $D(ACC),$D(YR) S ACC="SP "_YR_" "_ACC,IX0=IX0+1
	S X=CDT D REGDTM^GMTSU S CDT=X K X
	S ^TMP("LRA",$J,IX,0)=CDT_U_ACC
	I $D(^LR(LRDFN,"SP",IX,.1)) S ^TMP("LRA",$J,IX,.1)="Site/Specimen"
	S SN=0 F  S SN=$O(^LR(LRDFN,"SP",IX,.1,SN)) Q:SN'>0  S ^TMP("LRA",$J,IX,.1,SN)=$P(^LR(LRDFN,"SP",IX,.1,SN,0),U)
	I $D(^LR(LRDFN,"SP",IX,.2,0)),($P(^(0),U,3)]"") D CLHX
	I $D(^LR(LRDFN,"SP",IX,1,0)),($P(^(0),U,3)]"") D GROSS
	I $D(^LR(LRDFN,"SP",IX,1.1,0)),($P(^(0),U,3)]"") D MIC
	I $D(^LR(LRDFN,"SP",IX,1.2,0)),($P(^(0),U,3)]"") D SUPPR
	I $D(^LR(LRDFN,"SP",IX,1.3,0)),($P(^(0),U,3)]"") D FROZ
	I $D(^LR(LRDFN,"SP",IX,1.4,0)),($P(^(0),U,3)]"") D SPDX
	;S DIC=63,DIQ="AP",DIQ(0)="E",DR(63.08)=10,DR(63.12)=".01;1.5;3;4"
	;S DR(63.16)=".01;1",DR(63.82)=.01,DR(63.17)=.01
	;S DA(63.12)=0,DA(63.08)=IX F  S DA(63.12)=$O(^LR(LRDFN,"SP",IX,2,DA(63.12))) Q:DA(63.12)=""  D M,P,D
	Q
M	;Morphology data
	N AP
	S DR=8,DA=LRDFN D EN^DIQ1 I $D(AP(63.12)) S ^TMP("LRA",$J,IX,2)="Topography Data",^(2,DA(63.12))=$S($D(AP(63.12,DA(63.12),.01,"E")):AP(63.12,DA(63.12),.01,"E"),1:"")
	S DA(63.16)=0 F  S DA(63.16)=$O(^LR(LRDFN,"SP",IX,2,DA(63.12),2,DA(63.16))) Q:DA(63.16)=""  D EN^DIQ1 I $D(AP(63.16)) D MSET
	K DA(63.16)
	Q
MSET	S ^TMP("LRA",$J,IX,2,DA(63.12),2,DA(63.16))=$S($D(AP(63.16,DA(63.16),.01,"E")):AP(63.16,DA(63.16),.01,"E"),1:"") D
	.S DA(63.17)=0 F  S DA(63.17)=$O(^LR(LRDFN,"SP",IX,2,DA(63.12),2,DA(63.16),1,DA(63.17))) Q:DA(63.17)=""  D EN^DIQ1 I $D(AP(63.17)) D
	..S ^TMP("LRA",$J,IX,2,DA(63.12),2,DA(63.16),1,DA(63.17))=$S($D(AP(63.17,DA(63.17),.01,"E")):AP(63.17,DA(63.17),.01,"E"),1:"")
	K DA(63.17)
	Q
D	;Disease data
	S DA(63.15)=0 F  S DA(63.15)=$O(^LR(LRDFN,"SP",IX,2,DA(63.12),1,DA(63.15))) Q:DA(63.15)=""  D EN^DIQ1 I $D(AP(63.15)) D
	.S ^TMP("LRA",$J,IX,2,DA(63.12),1,DA(63.15))=$S($D(AP(63.15,DA(63.15),.01,"E")):AP(63.15,DA(63.15),.01,"E"),1:"")
	K DA(63.15)
	Q
P	;Procedure data
	N AP
	S DA(63.82)=0
	S DA(63.82)=0 F  S DR=8,DA=LRDFN,DA(63.82)=$O(^LR(LRDFN,"SP",IX,2,DA(63.12),4,DA(63.82))) Q:DA(63.82)=""  D EN^DIQ1 I $D(AP(63.82)) D PSET
	K DA(63.82)
	Q
PSET	S ^TMP("LRA",$J,IX,4)="Procedure Field"
	S ^TMP("LRA",$J,IX,2,DA(63.12),4,DA(63.82))=$S($D(AP(63.82,DA(63.82),.01,"E")):AP(63.82,DA(63.82),.01,"E"),1:"")
	Q
CLHX	;Brief Clinical History text
	N LN
	S ^TMP("LRA",$J,IX,.2)="Brief Clinical Hx"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"SP",IX,.2,LN)) Q:LN'>0  S X=^LR(LRDFN,"SP",IX,.2,LN,0) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LRA",$J,IX,.2,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
GROSS	;Gross Description text
	N LN
	S ^TMP("LRA",$J,IX,1)="Gross Description"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"SP",IX,1,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"SP",IX,1,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LRA",$J,IX,1,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
MIC	;Microscopic Exam/Diagnosis text
	N LN
	S ^TMP("LRA",$J,IX,1.1)="Microscopic Exam"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"SP",IX,1.1,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"SP",IX,1.1,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LRA",$J,IX,1.1,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
SUPPR	;Supplementary Report date/text
	S ^TMP("LRA",$J,IX,1.2)="Supplementary Report"
	S SP1=0 F  S SP1=$O(^LR(LRDFN,"SP",IX,1.2,SP1)) Q:SP1'>0  D
	. Q:+$P($G(^LR(LRDFN,"SP",IX,1.2,SP1,0)),U,2)'>0
	. S ^TMP("LRA",$J,IX,1.2,SP1,0)=$P($G(^LR(LRDFN,"SP",IX,1.2,SP1,0)),U)
	. K ^UTILITY($J,"W")
	. S SR=0
	. F  S SR=$O(^LR(LRDFN,"SP",IX,1.2,SP1,1,SR)) Q:SR'>0  D
	. . S X=$P($G(^LR(LRDFN,"SP",IX,1.2,SP1,1,SR,0)),U) D FORMAT
	. I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LRA",$J,IX,1.2,SP1,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
FROZ	;Frozen Section text
	N LN
	S ^TMP("LRA",$J,IX,1.3)="Frozen Section"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"SP",IX,1.3,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"SP",IX,1.3,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LRA",$J,IX,1.3,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
SPDX	;Surgical Pathology DX text
	N LN
	S ^TMP("LRA",$J,IX,1.4)="Surgical Path Dx"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"SP",IX,1.4,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"SP",IX,1.4,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LRA",$J,IX,1.4,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
FORMAT	;Calls ^DIWP to format text
	S DIWF="N",DIWL=3,DIWR=78 D ^DIWP
	Q

GMTSLRB
GMTSLRB	;SLC/JER - Blood Availability Component ;11/2/94  15:43
	;;2.7;Health Summary;;Oct 20, 1995
	;SLC/KKA - Added a module to display Blood Type (WRTBTYP) ;3/31/94
MAIN	N GMI,MAX,LRDFN,IX,X
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR") I '$D(^LR(LRDFN)) Q
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	D ^GMTSLRBE
	I '$D(^TMP("LRB",$J)) Q
	D WRTBTYP
	S IX=0 F  S IX=$O(^TMP("LRB",$J,IX)) Q:IX=""  S X=^TMP("LRB",$J,IX) D WRT
	K ^TMP("LRB",$J)
	Q
WRTBTYP	; Writes Blood Type
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?1,"Patient Blood Type:",?22,$P(^TMP("LRB",$J,0),U,1),?25,$P(^TMP("LRB",$J,0),U,2),!!
	Q
WRT	; Writes Blood Availability Record
	D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(X,U),?2,$P(X,U,2),?11,$P(X,U,3),?22,$P(X,U,4),?62,$J($P(X,U,6),2),?65,$P(X,U,7),?69,$P(X,U,8),!
	I $P(X,U,9)'="",($P(X,U,9)'="COMPATIBLE") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?22,$P(X,U,9),!
	I $P(X,U,9)="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?22,"NO CROSSMATCH RESULT AVAILABLE",!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?6,"Unit Location:",?22,$S($L($P(X,U,10)):$P(X,U,10),1:"Blood Bank"),!
	I $L($P(X,U,8)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?6,"Donation Type:",?22,$P(X,U,8),!
	Q

GMTSLRBE
GMTSLRBE	;SLC/JER - Blood Availability Extract ;11/2/94  15:45
	;;2.7;Health Summary;;Oct 20, 1995
	;SLC/KKA - Displays Blood Type in BA (Blood Availability)
XTRCT	N I1,UN,CNT
	S CNT=0
	K ^TMP("LRB",$J)
	I $L($P(^LR(LRDFN,0),U,5,6)) S ^TMP("LRB",$J,0)=$P(^(0),U,5)_U_$P(^(0),U,6)
	S UN="" F  S UN=$O(^LRD(65,"AP",LRDFN,UN)) Q:UN=""!(CNT'<MAX)  D BASET
	Q
BASET	; Sets ^TMP("LRB",$J, with data elements
	N ADT,DA,DIC,DIQ,DON,DR,EFLG,EDT,UID,DTYP,COMP,ABO,RH,VOL,XDT,XMR,XMATCH
	N IDT,GMI,ULOC
	S (ADT,EFLG,EDT,UID,DTYP,COMP,ABO,RH,VOL,XMR,ULOC)=""
	S UID=$P(^LRD(65,UN,0),U),EDT=$P(^(0),U,6),ABO=$P(^(0),U,7),RH=$P(^(0),U,8),VOL=$P(^(0),U,11),COMP=$P(^LAB(66,$P(^LRD(65,UN,0),U,4),0),U)
	S ADT=$P(^LRD(65,UN,2,LRDFN,0),U,2)
	S XDT=0,XDT=$O(^LRD(65,UN,2,LRDFN,1,XDT)) I XDT'="" S DIC=65,DIQ="XMATCH",DIQ(0)="E",DA=UN,DA(65.01)=LRDFN,DA(65.02)=XDT,DR=2,DR(65.01)=1,DR(65.02)=.04 D EN^DIQ1 I $D(XMATCH) S XMR=XMATCH(65.02,XDT,.04,"E") K DA,DIC,DIQ,DR
	I $D(^LRD(65,UN,8)) S DIC=65,DIQ="DON",DIQ(0)="E",DR=8.3,DA=UN D EN^DIQ1 S:$D(DON) DTYP=DON(65,UN,8.3,"E")
	S GMI=$O(^LRD(65,UN,3,0)) I +GMI>0 D
	. S ULOC=$P($G(^LRD(65,UN,3,GMI,0)),U,4)
	; If unit will expire w/in 48 hrs, flag with "*"; w/in 24 hrs, flag with "**"
	I EDT>DT S EFLG=$S(EDT-DT<2:"*",EDT-DT<1:"**",1:"")
	S IDT=9999999-ADT
	I $S(IDT<GMTS1:1,IDT>GMTS2:1,EDT<DT:1,1:0) Q
	S X=EDT D REGDT^GMTSU S EDT=X K X
	F  Q:'$D(^TMP("LRB",$J,IDT))  S IDT=IDT+.0001
	S ^TMP("LRB",$J,IDT)=EFLG_U_EDT_U_UID_U_COMP_U_VOL_U_ABO_U_RH_U_DTYP_U_XMR_U_ULOC
	S CNT=CNT+1
	Q

GMTSLRC
GMTSLRC	;SLC/JER - Chemistry & Hematology Component Driver ;4/27/92  11:48
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMCFLAG,GMCMNT,IX0,IX,LRDFN,MAX,CNT,PTR,RWIDTH
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR") I '$D(^LR(LRDFN)) Q
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	S RWIDTH=8 ;Optional variable used in ^GMTSLRCE
	D ^GMTSLRCE
	I '$D(^TMP("LRC",$J)) Q
	D WRTHDR S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0)
	S IX=GMTS1 F IX0=1:1:MAX S IX=$O(^TMP("LRC",$J,IX)) Q:IX=""!(IX>GMTS2)  S (PTR,CNT)=0 F  S PTR=$O(^TMP("LRC",$J,IX,PTR)) Q:PTR=""  S CNT=CNT+1 D WRT
	I +$G(GMCFLAG) D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W "!!  Indicates COMMENTS AVAILABLE...Refer to Interim Lab Report.",!
	K ^TMP("LRC",$J)
	Q
WRTHDR	; Prints columnar header
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?16,"Specimen",?27,"Test Name",?48,"Result",?58,"Units",?68,"Ref Range",!!
	S GMTSNPG=1
	Q
WRT	; Writes Chemistry & Hematology Component
	N GMI,GMX
	I PTR="C",'+$G(GMCMNT) Q  ; if comments disabled, don't print
	I PTR="C",($D(^TMP("LRC",$J,IX,"C"))>9),+$G(GMCMNT) D  Q
	. S GMI=0 F  S GMI=$O(^TMP("LRC",$J,IX,"C",GMI)) Q:GMI'>0  D
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W "Comment: ",^TMP("LRC",$J,IX,"C",GMI),!
	S GMX=^TMP("LRC",$J,IX,PTR)
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR W:CNT=1!(GMTSNPG) $P(GMX,U),?16,$E($P(GMX,U,2),1,10) W:CNT>1&'(GMTSNPG) ?3,"""",?11,"""",?19,""""
	I $D(^TMP("LRC",$J,IX,"C"))>9,'+$G(GMCMNT) W ?24,"!! " S GMCFLAG=1
	W ?27,$P(GMX,U,3),?46,$P(GMX,U,4)," ",$P(GMX,U,5),?58,$P(GMX,U,6),?68,$J($P(GMX,U,7),4),?73,"-",?74,$J($P(GMX,U,8),4),!
	Q

GMTSLRCE
GMTSLRCE	;SLC/JER - Chemistry Extract Routine ;11/2/94  15:48
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	; Call with LRDFN, GMTS1, GMTS2, MAX (#occurrences) & SEX (M or F)
	N IDT,CNT,AGE
	I '$D(GMTSAGE) D DEM^GMTSU
	S AGE=GMTSAGE
	K ^TMP("LRC",$J)
	S IDT=GMTS1,CNT=0 F  S IDT=$O(^LR(LRDFN,"CH",IDT)) Q:IDT=""!(IDT>GMTS2)  D:CNT'>MAX CHSET
	Q
CHSET	; Sets Chemistry locals for printing
	N CDT,SITE,SPEC,PTR,ISVALID,GMI,ACC,LOC,COM,RDT,SNOMED
	S ISVALID=$P(^LR(LRDFN,"CH",IDT,0),U,3) Q:ISVALID=""
	S SNOMED=""
	S CDT=+^LR(LRDFN,"CH",IDT,0),SITE=$P(^(0),U,5),SPEC=$P(^LAB(61,SITE,0),U),SNOMED=$P(^(0),U,2),CNT=CNT+1
	I $D(EXPAND) S SPEC=SNOMED_";"_SPEC,RDT=$P(^LR(LRDFN,"CH",IDT,0),U,3),ACC=$P(^(0),U,6),ACC=$P(ACC," ",2,3)_" "_$P(ACC," "),LOC=$P(^(0),U,11) S X=RDT D FMHL7DTM^GMTSU S RDT=X K X
	S X=CDT D REGDTM^GMTSU:'$D(EXPAND),FMHL7DTM^GMTSU:$D(EXPAND) S CDT=X K X
	S PTR=1 F  S PTR=$O(^LR(LRDFN,"CH",IDT,PTR)) Q:PTR=""  D NXTST
	I $D(^LR(LRDFN,"CH",IDT,1,0)),($D(^TMP("LRC",$J,IDT))) D
	. S COM=0 F GMI=1:1 S COM=$O(^LR(LRDFN,"CH",IDT,1,COM)) Q:+COM'>0  S ^TMP("LRC",$J,IDT,"C",GMI)=^LR(LRDFN,"CH",IDT,1,COM,0)
	Q
NXTST	; Visit next node in ^(PTR) subtree
	N RESULT,FLAG,TEST,GMPC,GMSQN,TNM,DESCR,THER,UNIT,HI,LO,CIS
	S RESULT=$P(^LR(LRDFN,"CH",IDT,PTR),U),FLAG=$P(^(PTR),U,2),CIS=""
	I $D(EXPAND),(FLAG["*") S FLAG=$S(FLAG="L*":"LL",FLAG="H*":"HH",1:FLAG)
	S TEST=$O(^LAB(60,"C","CH;"_PTR_";1",0)) Q:TEST'>0
	S TNM=$S($L($P(^LAB(60,TEST,0),U))<19:$P(^(0),U),1:$P(^(.1),U))
	; If Test Type field is neither "Output" or "Both" then quit
	I $S("BO"'[$P(^LAB(60,TEST,0),U,3):1,1:0) Q
	S GMSQN=$S($P($G(^LAB(60,TEST,.1)),U,6):$P($G(^(.1)),U,6),1:PTR/1000000)
	I $D(^LAB(60,TEST,10)) S CIS=^(10)
	I $D(EXPAND),'$L(CIS) Q
	I $D(EXPAND) S TNM=CIS_";"_TNM
	; Execute Print Code from file 60 to evaluate RESULT
	S RESULT=$$RESULT(TEST,RESULT,$G(RWIDTH))
	S DESCR=$S($D(^LAB(60,TEST,1,SITE,0)):^(0),1:""),THER=$S($L($P(DESCR,U,11,12))>1:1,1:0)
	S UNIT=$P(DESCR,U,7),LO=$S(THER:$P(DESCR,U,11),1:$P(DESCR,U,2)),HI=$S(THER:$P(DESCR,U,12),1:$P(DESCR,U,3))
	S @("LO="_$S($L(LO):LO,1:"""""")),@("HI="_$S($L(HI):HI,1:""""""))
	I $D(EXPAND),'$L(FLAG),(+$G(HI)'<+$G(RESULT)),(+$G(LO)'>+$G(RESULT)) S FLAG="N"
	F  Q:'$D(^TMP("LRC",$J,IDT,GMSQN))  Q:TEST=+^(GMSQN)  S GMSQN=GMSQN+1
	Q:$D(^TMP("LRC",$J,IDT,GMSQN))
	S ^TMP("LRC",$J,IDT,GMSQN)=CDT_U_SPEC_U_TNM_U_RESULT_U_FLAG_U_UNIT_U_LO_U_HI
	I $D(EXPAND) D XPND
	Q
XPND	; Appends additional data if required
	S ^TMP("LRC",$J,IDT,GMSQN)=^TMP("LRC",$J,IDT,GMSQN)_U_ACC_U_RDT_U_LOC
	Q
RESULT(TEST,RESULT,LRCW)	;Convert result to external format
	;TEST=Test ptr to file 60
	;RESULT=Test result
	;LRCW=Optional width of variable. Default is 0
	N X,X1
	I +$G(LRCW)'>0 S LRCW=0
	S X1=$P($G(^LAB(60,TEST,.1)),"^",3),X1=$S($L(X1):X1,1:"$J(X,LRCW)"),X=RESULT,@("X="_X1)
	Q X

GMTSLRCP
GMTSLRCP	;SLC/JER - Cytopathology Component Driver ;3/29/95  11:52
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMI,IX0,MAX,LRDFN,IX
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR") I '$D(^LR(LRDFN)) Q
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	D ^GMTSLRPE
	I '$D(^TMP("LRCY",$J)) Q
	S IX=""
	F GMI=1:1:MAX S IX=$O(^TMP("LRCY",$J,IX)) Q:IX=""  D:GMI>1 CKP^GMTSUP Q:$D(GMTSQIT)  W:GMI>1&'GMTSNPG ! S IX0="" F  S IX0=$O(^TMP("LRCY",$J,IX,IX0)) Q:IX0=""  D TRVRS
	K ^TMP("LRCY",$J)
	Q
TRVRS	; Traverses/Interprets ^TMP("LRCY",$J,
	N GMS,SPEC
	I IX0=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?8,"Collected:",?19,$P(^TMP("LRCY",$J,IX,IX0),U),?31,"Acc:",?36,$P(^TMP("LRCY",$J,IX,IX0),U,2),! Q
	I IX0=1 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Specimen:" S GMS=0 F  S GMS=$O(^TMP("LRCY",$J,IX,IX0,GMS)) Q:GMS'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?19,^TMP("LRCY",$J,IX,IX0,GMS),!
	I IX0=1,($P(^TMP("LRCY",$J,IX,IX0),U,2)'>0) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?18,"** REPORT NOT YET RELEASED **",!
	Q:IX0=1  D @$E(IX0,1,2)
	Q
AH	; Writes clinical history
	N GMTSH,GMTSHL,GMTSHLI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Brief Clinical Hx:",!
	S GMTSH=0
	F  S GMTSH=$O(^TMP("LRCY",$J,IX,IX0,GMTSH)) Q:+GMTSH'>0  S GMTSHL=^(GMTSH) D
	.I $L(GMTSHL)>78 S GMTSHL=$$WRAP^GMTSORC(GMTSHL,78)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMTSHL,"|"),! D
	..F GMTSHLI=2:1:$L(GMTSHL,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSHL,"|",GMTSHLI)]"" $P(GMTSHL,"|",GMTSHLI),!
	Q
G	; Writes Gross Description
	N GMTSG,GMTSGL,GMTSGLI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Gross Description:",!
	S GMTSG=0
	F  S GMTSG=$O(^TMP("LRCY",$J,IX,IX0,GMTSG)) Q:GMTSG'>0  S GMTSGL=^(GMTSG) D
	.I $L(GMTSGL)>78 S GMTSGL=$$WRAP^GMTSORC(GMTSGL,78)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMTSGL,"|"),! D
	..F GMTSGLI=2:1:$L(GMTSGL,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSGL,"|",GMTSGLI)]"" $P(GMTSGL,"|",GMTSGLI),!
	Q
MI	; Writes Microscopic exam/diagnosis field
	N GMTSM,GMTSML,GMTSMLI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Microscopic exam:",!
	S GMTSM=0
	F  S GMTSM=$O(^TMP("LRCY",$J,IX,IX0,GMTSM)) Q:GMTSM'>0  S GMTSML=^(GMTSM) D
	.I $L(GMTSML)>78 S GMTSML=$$WRAP^GMTSORC(GMTSML,78)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMTSML,"|"),! D
	..F GMTSMLI=2:1:$L(GMTSML,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSML,"|",GMTSMLI)]"" $P(GMTSML,"|",GMTSMLI),!
	Q
SR	; Writes Supplementary Reports
	N GMTSLINE,GMTSL,GMTSR,SRDATE,X
	S IX1=0
	F  S IX1=$O(^TMP("LRCY",$J,IX,IX0,IX1)) Q:IX1'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  S SRDATE=^TMP("LRCY",$J,IX,IX0,IX1,0) S X=SRDATE D REGDTM^GMTSU W !,"Supplementary Rpt: ",X,! D
	.S GMTSR=0
	.F  S GMTSR=$O(^TMP("LRCY",$J,IX,IX0,IX1,GMTSR)) Q:GMTSR'>0  D
	 ..S GMTSLINE=^TMP("LRCY",$J,IX,IX0,IX1,GMTSR) I $L(GMTSLINE)>78 S GMTSLINE=$$WRAP^GMTSORC(GMTSLINE,78)
	..D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMTSLINE,"|"),! D
	...F GMTSL=2:1:$L(GMTSLINE,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSLINE,"|",GMTSL)]"" $P(GMTSLINE,"|",GMTSL),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
ND	;Writes Diagnosis field
	N GMTSD,GMTSDL,GMTSDLI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !," Cytopathology Dx:",!
	S GMTSD=0
	F  S GMTSD=$O(^TMP("LRCY",$J,IX,IX0,GMTSD)) Q:GMTSD'>0  S GMTSDL=^(GMTSD) D
	.I $L(GMTSDL)>78 S GMTSDL=$$WRAP^GMTSORC(GMTSDL,78)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMTSDL,"|"),! D
	..F GMTSDLI=2:1:$L(GMTSDL,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSDL,"|",GMTSDLI)]"" $P(GMTSDL,"|",GMTSDLI),!
	Q
OT	; Traverses/Interprets Organ/Tissue Subarray
	N OT
	S OT=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Topography:",?19,^TMP("LRCY",$J,IX,IX0,OT),!
	F  S OT=$O(^TMP("LRCY",$J,IX,IX0,OT)) Q:OT=""  D @$E(OT,1)
	Q
D	; Writes Disease Field
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:OT="D1"!(GMTSNPG) ?9,"Diseases:" W ?21,^TMP("LRCY",$J,IX,IX0,OT),!
	Q
M	; Writes Morphology Field
	N GME
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Morphology:",?21,$P(^TMP("LRCY",$J,IX,IX0,OT),U),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  S GME="" F  S GME=$O(^TMP("LRCY",$J,IX,IX0,OT,GME)) Q:GME=""  W:GME[1!(GMTSNPG) ?9,"Etiology:" W ?23,^TMP("LRCY",$J,IX,IX0,OT,GME),!
	Q
P	; Writes Procedure Field
	N GMTSJ,GMK
	S GMTSJ=$P(^TMP("LRCY",$J,IX,IX0,OT),U) D CKP^GMTSUP Q:$D(GMTSQIT)  I $L(GMTSJ)>56 S GMTSJ=$$WRAP^GMTSORC(GMTSJ,56)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:((OT="P1")!(GMTSNPG)) ?7,"Procedures:" W ?21,$P(GMTSJ,"|"),! D
	.F GMK=2:1:$L(GMTSJ,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSJ,"|",GMK)]"" ?23,$P(GMTSJ,"|",GMK),!
	K ^UTILITY($J,"W")
	Q
XI	; Writes ICD diagnoses
	N GMTSDX
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "  ICD-9 Diagnoses:"
	S GMTSDX=0
	F  S GMTSDX=$O(^TMP("LRCY",$J,IX,IX0,GMTSDX)) Q:GMTSDX=""  D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMTSNPG ?2,"ICD-9 Diagnoses:" W ?19,$P(^TMP("LRCY",$J,IX,IX0,GMTSDX),U),?28,$P(^TMP("LRCY",$J,IX,IX0,GMTSDX),U,2),!
	Q

GMTSLREE
GMTSLREE	;SLC/JER - Electron Microscopy Extract ;6/12/95  15:46
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	N IX0,IX
	K ^TMP("LREM",$J)
	S IX=GMTS1 F IX0=1:0:MAX S IX=$O(^LR(LRDFN,"EM",IX)) Q:IX'>0!(IX>GMTS2)  D APSET
	K AP
	Q
APSET	;Sets ^TMP("LREM",$J
	N ACC,CDT,DA,DIC,DIQ,DR,GMW,SN,X,YR
	S CDT=$P(^LR(LRDFN,"EM",IX,0),U),YR=$E(CDT,2,3),ACC=$P(^(0),U,6)
	I $S(+$P(^LR(LRDFN,"EM",IX,0),U)'>0:1,+$P(^(0),U,11)'>0:1,1:0) Q
	I $D(ACC),$D(YR) S ACC="SP "_YR_" "_ACC,IX0=IX0+1
	S X=CDT D REGDTM^GMTSU S CDT=X K X
	S ^TMP("LREM",$J,IX,0)=CDT_U_ACC
	I $D(^LR(LRDFN,"EM",IX,.1)) S ^TMP("LREM",$J,IX,.1)="Site/Specimen"
	S SN=0 F  S SN=$O(^LR(LRDFN,"EM",IX,.1,SN)) Q:SN'>0  S ^TMP("LREM",$J,IX,.1,SN)=$P(^LR(LRDFN,"EM",IX,.1,SN,0),U)
	I $D(^LR(LRDFN,"EM",IX,.2,0)),($P(^(0),U,3)]"") D CLHX
	I $D(^LR(LRDFN,"EM",IX,1,0)),($P(^(0),U,3)]"") D GROSS
	I $D(^LR(LRDFN,"EM",IX,1.1,0)),($P(^(0),U,3)]"") D MIC
	I $D(^LR(LRDFN,"EM",IX,1.2,0)),($P(^(0),U,3)]"") D SUPPR
	I $D(^LR(LRDFN,"EM",IX,1.4,0)),($P(^(0),U,3)]"") D SPDX
	Q
CLHX	;Brief Clinical History text
	N LN
	S ^TMP("LREM",$J,IX,.2)="Brief Clinical Hx"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"EM",IX,.2,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"EM",IX,.2,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LREM",$J,IX,.2,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
GROSS	;Gross Description text
	N LN
	S ^TMP("LREM",$J,IX,1)="Gross Description"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"EM",IX,1,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"EM",IX,1,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LREM",$J,IX,1,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
MIC	;Microscopic Exam/Diagnosis text
	N LN
	S ^TMP("LREM",$J,IX,1.1)="Microscopic Exam"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"EM",IX,1.1,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"EM",IX,1.1,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LREM",$J,IX,1.1,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
SUPPR	;Supplementary Report date/text
	S ^TMP("LREM",$J,IX,1.2)="Supplementary Report"
	S SP1=0
	F  S SP1=$O(^LR(LRDFN,"EM",IX,1.2,SP1)) Q:SP1'>0  D
	. Q:+$P($G(^LR(LRDFN,"EM",IX,1.2,SP1,0)),U,2)'>0
	. S ^TMP("LREM",$J,IX,1.2,SP1,0)=$P($G(^LR(LRDFN,"EM",IX,1.2,SP1,0)),U)
	. K ^UTILITY($J,"W")
	. S SR=0
	. F  S SR=$O(^LR(LRDFN,"EM",IX,1.2,SP1,1,SR)) Q:SR'>0  D
	. . S X=$P($G(^LR(LRDFN,"EM",IX,1.2,SP1,1,SR,0)),U) D FORMAT
	. I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LREM",$J,IX,1.2,SP1,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
SPDX	;Electron Microscopy DX text
	N LN
	S ^TMP("LREM",$J,IX,1.4)="Surgical Path Dx"
	K ^UTILITY($J,"W") S LN=0 F  S LN=$O(^LR(LRDFN,"EM",IX,1.4,LN)) Q:LN'>0  S X=$P(^LR(LRDFN,"EM",IX,1.4,LN,0),U) D FORMAT
	I $D(^UTILITY($J,"W")) F LN=1:1:^UTILITY($J,"W",3) S ^TMP("LREM",$J,IX,1.4,LN)=^UTILITY($J,"W",DIWL,LN,0)
	K ^UTILITY($J,"W")
	Q
FORMAT	;Calls ^DIWP to format text
	S DIWF="N",DIWL=3,DIWR=78 D ^DIWP
	Q

GMTSLREM
GMTSLREM	;SLC/JER - Electron Microscopy Component Driver ;3/29/95  11:51
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMI,MAX,LRDFN,IX,X,IX0
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR")
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	D ^GMTSLREE
	I '$D(^TMP("LREM",$J)) Q
	S IX=0
	F GMI=1:1:MAX S IX=$O(^TMP("LREM",$J,IX)) Q:IX'>0  D:GMI>1 CKP^GMTSUP Q:$D(GMTSQIT)  W:GMI>1&('GMTSNPG) ! D
	.S IX0=""
	.F  S IX0=$O(^TMP("LREM",$J,IX,IX0)) Q:IX0=""!(IX0?1A)  S X=^TMP("LREM",$J,IX,IX0) D WRT
	. I $D(^TMP("LREM",$J,IX,1.2)) D SUPPR
	K ^TMP("LREM",$J)
	Q
WRT	; Writes Electron Microscopy Record
	N IX1,GMJ
	I IX0=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?8,"Collected:",?19,$P(X,U),?31,"Acc:",?36,$P(X,U,2),! Q
	I IX0=.1 D WRTSPC Q
	I $S(IX0=.2:1,IX0=1:1,IX0=1.1:1,IX0=1.3:1,IX0=1.4:1,1:0) D TEXT Q
	I IX0=2 S IX1=0 F  S IX1=$O(^TMP("LREM",$J,IX,IX0,IX1)) Q:IX1'>0  S X=^(IX1) D WRTP
	Q
WRTSPC	; Writes Specimen field entries
	N GMS
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Specimen:"
	S GMS=0
	F  S GMS=$O(^TMP("LREM",$J,IX,.1,GMS)) Q:GMS'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?19,^TMP("LREM",$J,IX,.1,GMS),!
	Q
TEXT	; Handles GROSS DESCRIPTION & MICROSCOPIC EXAM/DX Print
	N LN,GMTSLN,GMTSLNI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?(17-$L(X)),X_":",!
	S LN=0
	F  S LN=$O(^TMP("LREM",$J,IX,IX0,LN)) Q:LN'>0  S GMTSLN=^(LN) D
	.I $L(GMTSLN)>78 S GMTSLN=$$WRAP^GMTSORC(GMTSLN,78)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMTSLN,"|"),! D
	..F GMTSLNI=2:1:$L(GMTSLN,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSLN,"|",GMTSLNI)]"" $P(GMTSLN,"|",GMTSLNI),!
	Q
SUPPR	; Writes Supplementary Report
	N GMTSR,SRDATE,X
	S IX1=0
	F  S IX1=$O(^TMP("LREM",$J,IX,1.2,IX1)) Q:IX1'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  S SRDATE=^TMP("LREM",$J,IX,1.2,IX1,0) S X=SRDATE D REGDTM^GMTSU W "Supplementary Rpt: ",X,! D
	.S GMTSR=0
	.F  S GMTSR=$O(^TMP("LREM",$J,IX,1.2,IX1,GMTSR)) Q:GMTSR'>0  S GMTSRL=^(GMTSR) D
	..I $L(GMTSRL)>78 S GMTSRL=$$WRAP^GMTSORC(GMTSRL,78)
	..W $P(GMTSRL,"|"),! D
	...F GMTSRLI=2:1:$L(GMTSRL,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSRL,"|",GMTSRLI)]"" $P(GMTSRL,"|",GMTSRLI),!
	Q
WRTP	; Writes Procedure field
	N GMQ,GMK
	I $O(^TMP("LREM",$J,IX,IX0,IX1,4,0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Procedures:"
	S GMT=0
	F  S GMT=$O(^TMP("LREM",$J,IX,IX0,IX1,4,GMT)) Q:GMT'>0  D
	.S GMQ=$P(^TMP("LREM",$J,IX,IX0,IX1,4,GMT),U)
	.I $L(GMQ)>56 S GMQ=$$WRAP^GMTSORC(GMQ,56)
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,$P(GMQ,"|"),! D
	..F GMK=2:1:$L(GMQ,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMQ,"|",GMK)]"" ?23,$P(GMQ,"|",GMK),!
	Q

GMTSLRM
GMTSLRM	;SLC/JER - Microbiology Component Driver ;11/4/94  15:40
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N IX0,IX,LRDFN,MAX,D1,D2,D3
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR")
	I $S('$D(^LR(LRDFN,"MI",0)):1,'$O(^LR(LRDFN,"MI",GMTS1)):1,$O(^(GMTS1))>GMTS2:1,1:0) Q
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	S IX=GMTS1 F IX0=1:1:MAX S IX=$O(^LR(LRDFN,"MI",IX)) Q:IX=""!(IX>GMTS2)!$D(GMTSQIT)  D:IX0>1 CKP^GMTSUP Q:$D(GMTSQIT)  W:IX0>1 ! D ^GMTSLRME,INTRP:$D(^TMP("LRM",$J)) K ^TMP("LRM",$J)
	Q
INTRP	; Interprets ^TMP("LRM",$J, and calls WRT to print component
	N GMZ,GMK
	S (GMZ,GMK)=""
	F  S GMZ=$O(^TMP("LRM",$J,GMZ)) Q:GMZ=""  D RDNODE  Q:$D(GMTSQIT)
	Q
RDNODE	; Reads current node of ^TMP("LRM",$J
	N GMABX,COM
	S GMABX=0
	I GMZ=0 D  Q
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W ?10,"Collected:",?21,$P(^TMP("LRM",$J,GMZ),U),?43,"Acc:",?48,$P(^TMP("LRM",$J,GMZ),U,2),!
	. I $P(^TMP("LRM",$J,GMZ),U,6)'=$P(^(GMZ),U,3) D
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?2,"Collection Sample:",?21,$P(^TMP("LRM",$J,GMZ),U,6),!
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W ?6,"Site/Specimen:",?21,$TR($P(^TMP("LRM",$J,GMZ),U,3),"|"," "),!
	. S COM=$P(^TMP("LRM",$J,GMZ),U,7)
	. I COM]"" D
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . W "Comment on Specimen:"
	. . I $L(COM)>58 S COM=$$WRAP^GMTSORC(COM,58)
	. . W ?21,$P(COM,"|"),!
	. . I $L($P(COM,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?22,$P(COM,"|",2),!
	. D WRTTEST^GMTSLRM1
	S GMK=""
	F  S GMK=$O(^TMP("LRM",$J,GMZ,GMK)) Q:GMK=""  D WRTNODE Q:$D(GMTSQIT)
	Q
WRTNODE	; Writes current node of ^TMP("LRM",$J
	N GML,SMEAR,QTY,ORG,GMN,RSMEAR
	I GMZ="BSTER" D  Q  ; Writes sterility control data
	. I GMK=0 D  Q
	. . Q:$P(^TMP("LRM",$J,"BSTER",GMK),U)']""
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. .  W ?2,"Sterility Control:",?21,$P(^TMP("LRM",$J,"BSTER",GMK),U),! Q
	. D CKP^GMTSUP I $D(GMTSQIT)
	. W ?13,"Number:",?21,GMK,?34,"Sterility Results: ",$P(^TMP("LRM",$J,GMZ,GMK),U),!
	I GMK=0 S GMN=$G(^TMP("LRM",$J,GMZ,GMK)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?4,$S(GMZ="BACT":"    Bact ",GMZ="TB":"Mycobact ",GMZ="MYCO":"Mycology ",GMZ="PARA":"Parasite ",GMZ="VIRO":"Virology ",1:"         ")_"Report:",?21,$P(GMN,U),! D  Q
	. I GMZ="BACT" D  Q:$D(GMTSQIT)
	. . I $P(GMN,U,3)]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?7,"Urine Screen: ",$P(GMN,U,3),!
	. . I $P(GMN,U,2)]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?6,"Sputum Screen: ",$P(GMN,U,2),!
	. I GMZ="TB" D  Q:$D(GMTSQIT)
	. . I $P(GMN,U,2)]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?4,"Acid Fast Stain: ",$E($P(GMN,U,2),1,20) D
	. . . S QTY=$P(GMN,U,3)
	. . . I $L(QTY)>35 S QTY=$$WRAP^GMTSORC(QTY,35)
	. . . W ?44,$P(QTY,"|"),!
	. . . I $L($P(QTY,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?44,$P(QTY,"|",2),!
	I GMZ="GRAM" D WRTGRM^GMTSLRM1 Q
	I GMK="SMEAR" D  Q
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W ?9,"Smear/Prep:"
	. S SMEAR=0
	. F  S SMEAR=$O(^TMP("LRM",$J,GMZ,GMK,SMEAR)) Q:SMEAR'>0  D  I +$O(^TMP("LRM",$J,GMK,SMEAR)) D CKP^GMTSUP Q:$D(GMTSQIT)
	. . S RSMEAR=^TMP("LRM",$J,GMZ,GMK,SMEAR)
	. . I $L(RSMEAR)>58 S RSMEAR=$$WRAP^GMTSORC(RSMEAR,58)
	. . W ?21,$P(RSMEAR,"|"),!
	. . I $L($P(RSMEAR,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?22,$P(RSMEAR,"|",2),!
	I GMK="R" D REMARKS^GMTSLRM1 Q
	I GMZ'="CABXL" D  Q:$D(GMTSQIT)
	. S ORG=$P(^TMP("LRM",$J,GMZ,GMK),U),QTY=$P(^(GMK),U,2)
	. I $L(ORG)>58 S ORG=$$WRAP^GMTSORC(ORG,58)
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W ?11,"Organism:"
	. W ?21,$P(ORG,"|",1),!
	. I $L($P(ORG,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?23,$P(ORG,"|",2),!
	. I QTY]"" W ?11,"Quantity:" D
	. . I $L(QTY)>58 S QTY=$$WRAP^GMTSORC(QTY,58)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,$P(QTY,"|"),!
	. . I $L($P(QTY,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?23,$P(QTY,"|",2),!
	. D COMMENT^GMTSLRM1 Q:$D(GMTSQIT)
	. I GMZ="TB" D TBSUSC^GMTSLRM1
	I GMZ="CABXL" D
	. I GMK=1!(GMABX=1) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?8,"Ser Abx Lev:"
	. W ?21,$E($P(^TMP("LRM",$J,GMZ,GMK),U),1,20),?45,$$DRAW($P(^TMP("LRM",$J,GMZ,GMK),U,2)),?55,$P(^TMP("LRM",$J,GMZ,GMK),U,3)," ug/ml",! D CKP^GMTSUP Q:$D(GMTSQIT)
	I GMZ="BACT",$D(^TMP("LRM",$J,GMZ,GMK,"SUSC")) D ANTIBX^GMTSLRM1 Q
	I GMZ="PARA",$D(^TMP("LRM",$J,GMZ,GMK))=11 D
	. S GML=0
	. F  S GML=$O(^TMP("LRM",$J,GMZ,GMK,GML)) Q:GML'>0  D  Q:$D(GMTSQIT)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . W ?23,$P(^TMP("LRM",$J,GMZ,GMK,GML),U)
	. . S QTY=$P(^TMP("LRM",$J,GMZ,GMK,GML),U,2)
	. . I $L(QTY)>34 S QTY=$$WRAP^GMTSORC(QTY,34)
	. . W ?45,$P(QTY,"|"),!
	. . I $L($P(QTY,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?45,$P(QTY,"|",2),!
	. . D PARACOMM^GMTSLRM1
	Q
DRAW(CODE)	; Peak/Trough/Random Abx level
	Q $S(CODE="P":"PEAK",CODE="T":"TROUGH",1:"RANDOM")

GMTSLRM1
GMTSLRM1	;SLC/SBW - Microbiology Component Continue ;22/May/95
	;;2.7;Health Summary;;Oct 20, 1995
REMARKS	; Write remarks
	N RPT,NUM,FIRST
	S NUM="",FIRST=1
	F  S NUM=$O(^TMP("LRM",$J,GMZ,GMK,NUM)) Q:+NUM'>0  D  Q:$D(GMTSQIT)
	. S RPT=^TMP("LRM",$J,GMZ,GMK,NUM)
	. I $L(RPT)>58 S RPT=$$WRAP^GMTSORC(RPT,58)
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. I FIRST W ?12,"Remarks:" S FIRST=0
	. W ?21,$P(RPT,"|"),!
	. I $L($P(RPT,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?23,$P(RPT,"|",2),!
	Q
COMMENT	; Write comment
	Q:+$D(^TMP("LRM",$J,GMZ,GMK,"COM"))'>0
	N REC,COM
	S REC=0
	F  S REC=$O(^TMP("LRM",$J,GMZ,GMK,"COM",REC)) Q:REC'>0  D
	. S COM=^TMP("LRM",$J,GMZ,GMK,"COM",REC)
	. I $L(COM)>55 S COM=$$WRAP^GMTSORC(COM,55)
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W ?25,$P(COM,"|"),!
	. I $L($P(COM,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?27,$P(COM,"|",2),!
	Q
PARACOMM	; Write comment for parasite
	Q:+$D(^TMP("LRM",$J,GMZ,GMK,GML,"COM"))'>0
	N REC,COM
	S REC=0
	F  S REC=$O(^TMP("LRM",$J,GMZ,GMK,GML,"COM",REC)) Q:REC'>0  D
	. S COM=^TMP("LRM",$J,GMZ,GMK,GML,"COM",REC)
	. I $L(COM)>53 S COM=$$WRAP^GMTSORC(COM,53)
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W ?27,$P(COM,"|"),!
	. I $L($P(COM,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?29,$P(COM,"|",2),!
	Q
WRTGRM	; Writes Gram Stain Results
	N GMGRAM
	S GMGRAM=^TMP("LRM",$J,GMZ,GMK)
	S:$L(GMGRAM)>58 GMGRAM=$$WRAP^GMTSORC(GMGRAM,58)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMK=1 ?15,"Gram:" W ?21,$P(GMGRAM,"|"),!
	I $L($P(GMGRAM,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?23,$P(GMGRAM,"|",2),!
	Q
ANTIBX	; Writes Antibiotic susceptability data
	N GML,GMCNT,ANAM,ANLEN,ANEXT,GMSUB
	S GMABX=1
	F GMSUB="S","I","R" D  Q:$D(GMTSQIT)
	. Q:+$D(^TMP("LRM",$J,GMZ,GMK,"SUSC",GMSUB))'>0
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W:GMSUB="S" ?5,"Susceptible to: "
	. W:GMSUB="I" ?7,"Intermediate: "
	. W:GMSUB="R" ?7,"Resistant to: "
	. S ANLEN=21,GML=""
	. F  S GML=$O(^TMP("LRM",$J,GMZ,GMK,"SUSC",GMSUB,GML)) Q:GML=""  S ANAM=$P($P(^(GML),U),";",2),ANEXT=$O(^(GML)) D  Q:$D(GMTSQIT)
	. . I $L(ANAM)+ANLEN>79 D CKP^GMTSUP Q:$D(GMTSQIT)  W:'GMTSNPG ! W ?21 S ANLEN=21
	. . W ANAM,$S(ANEXT]"":", ",1:"") S ANLEN=ANLEN+$L(ANAM)+2
	. W !
	Q
WRTTEST	; Writes Lab Test for Accession
	N GML,GMCNT,TNAM,TLEN,TNEXT
	Q:'$D(^TMP("LRM",$J,GMZ,"TEST"))
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?4,"Test(s) ordered: "
	S TLEN=21,GML=""
	F  S GML=$O(^TMP("LRM",$J,GMZ,"TEST",GML)) Q:GML=""  S TNAM=$P($G(^(GML)),U),TNEXT=$O(^(GML)) D  Q:$D(GMTSQIT)
	. I $L(TNAM)+TLEN>79 D CKP^GMTSUP Q:$D(GMTSQIT)  W:'GMTSNPG ! W ?21 S TLEN=21
	. W TNAM,$S(TNEXT]"":", ",1:"") S TLEN=TLEN+$L(TNAM)+2
	W !
	Q
WRTSTER	; Writes sterility control data
	N STER,GML
	S STER=$G(^TMP("LRM",$J,"BSTER",0))
	Q:STER']""
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ?2,"Sterility Control:",?21,STER,!
	S GML=0
	F  S GML=$O(^TMP("LRM",$J,GMZ,GML)) Q:GML'>0  D  Q:$D(GMTSQIT)
	. D CKP^GMTSUP I $D(GMTSQIT)
	. W ?13,"Number:",?21,GML,?44,"Results: ",$P(^TMP("LRM",$J,GMZ,GML),U),!
	Q
TBSUSC	;Display TB Susceptiblities
	Q:+$D(^TMP("LRM",$J,GMZ,GMK,"SUSC"))'>0
	N GMTB,QTY
	S GMTB=0
	F  S GMTB=$O(^TMP("LRM",$J,GMZ,GMK,"SUSC",GMTB)) Q:GMTB'>0  D  Q:$D(GMTSQIT)
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W ?21,$P(^TMP("LRM",$J,GMZ,GMK,"SUSC",GMTB),U)
	. S QTY=$P(^TMP("LRM",$J,GMZ,GMK,"SUSC",GMTB),U,2)
	. I $L(QTY)>36 S QTY=$$WRAP^GMTSORC(QTY,36)
	. W ?44,$P(QTY,"|"),!
	. I $L($P(QTY,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?44,$P(QTY,"|",2),!
	Q

GMTSLRMB
GMTSLRMB	;SLC/JER - Microbiology Component Driver ;5-24-95
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N IX0,IX,LRDFN,MAX,D1,D2,D3
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR")
	I $S('$D(^LR(LRDFN,"MI",0)):1,'$O(^LR(LRDFN,"MI",GMTS1)):1,$O(^LR(LRDFN,"MI",GMTS1))>GMTS2:1,1:0) Q
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	S IX=GMTS1 F IX0=1:1:MAX S IX=$O(^LR(LRDFN,"MI",IX)) Q:IX=""!(IX>GMTS2)  D:IX0>1 CKP^GMTSUP Q:$D(GMTSQIT)  W:IX0>1&'GMTSNPG ! D ^GMTSLRME,INTRP:$D(^TMP("LRM",$J)) K ^TMP("LRM",$J)
	Q
INTRP	; Interprets ^TMP("LRM",$J, and calls WRT to print component
	N GMTSJ,GMK,GMW,SMEAR,GMABX
	S (GMTSJ,GMK)=""
	F  S GMTSJ=$O(^TMP("LRM",$J,GMTSJ)) Q:GMTSJ=""!$D(GMTSQIT)  D RDNODE
	Q
RDNODE	; Reads current node of GMTSLRMI
	Q:GMTSJ="BSTER"
	I GMTSJ=0 D  Q
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W $P($P(^TMP("LRM",$J,GMTSJ),U)," "),?10,$P(^TMP("LRM",$J,GMTSJ),U,3),!
	. D WRTTEST
	S GMK=""
	F  S GMK=$O(^TMP("LRM",$J,GMTSJ,GMK)) Q:GMK=""!$D(GMTSQIT)  D WRTNODE
	I GMTSJ="TB" D  Q:$D(GMTSQIT)
	. I $P(^TMP("LRM",$J,GMTSJ,0),U,2)]"" D
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . W "AFB Sme:",?10,$E($P(^TMP("LRM",$J,GMTSJ,0),U,2),1,20),!
	. . I $P(^TMP("LRM",$J,GMTSJ,0),U,3)]"" D
	. . . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . . W ?10,$P(^TMP("LRM",$J,GMTSJ,0),U,3),!
	I $D(^TMP("LRM",$J,GMTSJ,"SMEAR")) D
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W ?2,"Smear:"
	. S SMEAR=0
	. F  S SMEAR=$O(^TMP("LRM",$J,GMTSJ,"SMEAR",SMEAR)) Q:SMEAR'>0  W ?10,^(SMEAR),! I +$O(^TMP("LRM",$J,"SMEAR",SMEAR)) D CKP^GMTSUP Q:$D(GMTSQIT)
	Q
WRTNODE	; Writes current node of GMTSLRMI
	N GML
	I GMK=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?1,"Report:",?10,$P(^TMP("LRM",$J,GMTSJ,GMK),U),! Q
	I GMTSJ="GRAM" D WRTGRM Q
	Q:GMK="SMEAR"
	I GMK="R" D REMARKS Q
	I GMTSJ'="CABXL" D  Q:$D(GMTSQIT)
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W "Organsm:",?10,$P(^TMP("LRM",$J,GMTSJ,GMK),U),!
	. I $P(^TMP("LRM",$J,GMTSJ,GMK),U,2)]"" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?4,"QTY:",?10,$P(^TMP("LRM",$J,GMTSJ,GMK),U,2),!
	I GMTSJ="CABXL" D
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W:GMK=1 "Ser Abx:"
	. W ?10,$E($P(^TMP("LRM",$J,GMTSJ,GMK),U),1,18),?30,$$DRAW^GMTSLRM($P(^TMP("LRM",$J,GMTSJ,GMK),U,2)),?38,$P(^(GMK),U,3)," ug/ml",!
	I GMTSJ="BACT",$D(^TMP("LRM",$J,GMTSJ,GMK,"SUSC")) D ANTIBX Q
	I GMTSJ="PARA",$D(^TMP("LRM",$J,GMTSJ,GMK))=11 D
	. S GML=""
	. F  S GML=$O(^TMP("LRM",$J,GMTSJ,GMK,GML)) Q:GML'>0  D  Q:$D(GMTSQIT)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . W ?12,$P(^TMP("LRM",$J,GMTSJ,GMK,GML),U)
	. . S QTY=$P(^TMP("LRM",$J,GMTSJ,GMK,GML),U,2)
	. . I $L(QTY)>46 S QTY=$$WRAP^GMTSORC(QTY,46)
	. . W ?33,$P(QTY,"|"),!
	. . I $L($P(QTY,"|",2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?33,$P(QTY,"|",2),!
	Q
REMARKS	; Write remarks
	N NUM,FIRST
	S NUM="",FIRST=1
	F  S NUM=$O(^TMP("LRM",$J,GMTSJ,GMK,NUM)) Q:+NUM'>0  D  Q:$D(GMTSQIT)
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W:$X>0 !
	. I FIRST W "Remarks:" S FIRST=0
	. W ?10,^TMP("LRM",$J,GMTSJ,GMK,NUM),!
	Q
WRTGRM	; Writes Gram Stain Results
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:$X>0 ! W:GMK=1 ?3,"Gram:" W ?10,$E(^TMP("LRM",$J,GMTSJ,GMK),1,69),!
	Q
ANTIBX	; Writes Antibiotic susceptability data
	N GML,GMCNT,ANAM,ANLEN,ANEXT,GMSUB
	S GMABX=1
	F GMSUB="S","I","R" D  Q:$D(GMTSQIT)
	. Q:+$D(^TMP("LRM",$J,GMTSJ,GMK,"SUSC",GMSUB))'>0
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. W:GMSUB="S" "Susc to:  "
	. W:GMSUB="I" "Interme:  "
	. W:GMSUB="R" "Resista:  "
	. S ANLEN=10,GML=""
	. F  S GML=$O(^TMP("LRM",$J,GMTSJ,GMK,"SUSC",GMSUB,GML)) Q:GML=""  S ANAM=$P($P(^(GML),U),";",2),ANEXT=$O(^(GML)) D  Q:$D(GMTSQIT)
	. . I $L(ANAM)+ANLEN>79 D CKP^GMTSUP Q:$D(GMTSQIT)  W:'GMTSNPG ! W ?10 S ANLEN=10
	. . W ANAM,$S(ANEXT]"":", ",1:"") S ANLEN=ANLEN+$L(ANAM)+2
	. W !
	Q
WRTTEST	; Writes Lab Test for Accession
	N GML,GMCNT,TNAM,TLEN,TNEXT
	Q:'$D(^TMP("LRM",$J,GMTSJ,"TEST"))
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Test(s):  "
	S TLEN=10,GML=""
	F  S GML=$O(^TMP("LRM",$J,GMTSJ,"TEST",GML)) Q:GML=""  S TNAM=$P($G(^(GML)),U),TNEXT=$O(^(GML)) D  Q:$D(GMTSQIT)
	. I $L(TNAM)+TLEN>79 D CKP^GMTSUP Q:$D(GMTSQIT)  W:'GMTSNPG ! W ?10 S TLEN=10
	. W TNAM,$S(TNEXT]"":", ",1:"") S TLEN=TLEN+$L(TNAM)+2
	W !
	Q

GMTSLRME
GMTSLRME	;SLC/JER - Microbiology Extract Routine ;11/18/93  08:36
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	N ACC,CDT,SS,CS,X,DIC,DIQ,DA,DR,MICRO,LOC,RDT,MICCOM
	K ^TMP("LRM",$J)
	S X=$P(^LR(LRDFN,"MI",IX,0),U),RDT=$P(^(0),U,3),ACC=$P(^(0),U,6),LOC=$P(^(0),U,8) D REGDTM^GMTSU S CDT=X K X
	D LABTEST($P(^LR(LRDFN,"MI",IX,0),U),ACC)
	; External format of site/specimen, collection sample, and comment
	S DIC=63,DIQ="MICRO",DIQ(0)="E",DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)=".05;.055;.99"
	D EN^DIQ1
	S SS=MICRO(63.05,IX,.05,"E")
	S CS=MICRO(63.05,IX,.055,"E"),MICCOM=MICRO(63.05,IX,.99,"E")
	S ^TMP("LRM",$J,0)=CDT_U_ACC_U_SS I $D(EXPAND) S ^TMP("LRM",$J,0)=^TMP("LRM",$J,0)_U_RDT_U_LOC
	S $P(^TMP("LRM",$J,0),U,6)=CS_U_MICCOM
	D ABXLEV,BACT,GRAM,STER,PARA^GMTSLRMX,MYCO^GMTSLRMX,TB^GMTSLRMX,VIRO^GMTSLRMX
	Q
BACT	; Get Bacteriology Work-up
	N DA,DIC,DIQ,DR,STATUS,ISO,ORG,RMK,COM,SMEAR
	I $D(^LR(LRDFN,"MI",IX,1)) D
	. S DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)="11.5;11.51;11.57;11.58",DIQ="STATUS"
	. S DIQ(0)="E" D EN^DIQ1
	. ;Include Status, sputum screen, and urine screen
	. S ^TMP("LRM",$J,"BACT",0)=$E($P(STATUS(63.05,IX,11.5,"E")," ",1),1,6)_U_STATUS(63.05,IX,11.58,"E")_U_STATUS(63.05,IX,11.57,"E")
	. ; Include sterility control
	. S ^TMP("LRM",$J,"BSTER",0)=STATUS(63.05,IX,11.51,"E")
	S ISO=0
	F  S ISO=$O(^LR(LRDFN,"MI",IX,3,ISO)) Q:+ISO'>0  D
	. D ORGNSM S ^TMP("LRM",$J,"BACT",ISO)=$S($D(EXPAND):ISO_";"_ORG,1:ORG) I $O(^LR(LRDFN,"MI",IX,3,ISO,1)) D ANTIBX
	. ;comment
	. S COM=0
	. F  S COM=$O(^LR(LRDFN,"MI",IX,3,ISO,1,COM)) Q:COM'>0  S ^TMP("LRM",$J,"BACT",ISO,"COM",COM)=^(COM,0)
	; Bacteriology smear/prep
	S SMEAR=0
	F  S SMEAR=$O(^LR(LRDFN,"MI",IX,25,SMEAR)) Q:SMEAR'>0  S ^TMP("LRM",$J,"BACT","SMEAR",SMEAR)=^(SMEAR,0)
	; remark
	S RMK=0
	F  S RMK=$O(^LR(LRDFN,"MI",IX,4,RMK)) Q:RMK=""  S ^TMP("LRM",$J,"BACT","R",RMK)=^(RMK,0)
	Q
ORGNSM	N QTY
	S ORG=+^LR(LRDFN,"MI",IX,3,ISO,0),QTY=$P(^(0),U,2),ORG=$P(^LAB(61.2,ORG,0),U)
	S ORG=ORG_U_QTY
	Q
ANTIBX	; Get Antibitiotic susceptibility results on demand
	N ABX
	S ABX=1
	F  S ABX=$O(^LR(LRDFN,"MI",IX,3,ISO,ABX)) Q:ABX=""!(ABX'<3)  D ABXSET
	Q
ABXSET	; Set Antibiotic Susceptability data, when appropriate
	; Separate out by Susceptable, Intermediate, and Resistant
	N ABXN,GMABXN,GMABX
	S ABXN=ABX_";"_$P($G(^LAB(62.06,+$O(^LAB(62.06,"AD",ABX,"")),0)),U)
	I $P(ABXN,";",2)']"" S $P(ABXN,";",2)="UNKNOWN"
	I ("A"[$P(^LR(LRDFN,"MI",IX,3,ISO,ABX),U,3)) D
	. S GMABX=$G(^LR(LRDFN,"MI",IX,3,ISO,ABX))
	. I $P(GMABX,U,1,2)["S" S ^TMP("LRM",$J,"BACT",ISO,"SUSC","S",$P($P(ABXN,U),";",2))=ABXN_U_GMABX
	. I $P(GMABX,U,1,2)["I" S ^TMP("LRM",$J,"BACT",ISO,"SUSC","I",$P($P(ABXN,U),";",2))=ABXN_U_GMABX
	. I $P(GMABX,U,1,2)["R" S ^TMP("LRM",$J,"BACT",ISO,"SUSC","R",$P($P(ABXN,U),";",2))=ABXN_U_GMABX
	Q
ABXLEV	; Get Serum antibiotic level
	N GMI
	Q:'$D(^LR(LRDFN,"MI",IX,14))
	S GMI=0
	F  S GMI=$O(^LR(LRDFN,"MI",IX,14,GMI)) Q:GMI'>0  S ^TMP("LRM",$J,"CABXL",GMI)=$G(^(GMI,0))
	Q
STER	; Get sterility results if they exist
	N RESULT,STER
	S STER=0
	F  S STER=$O(^LR(LRDFN,"MI",IX,31,STER)) Q:STER'>0  D
	. S DIQ(0)="E",DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)=11.52
	. S DR(63.292)=.01,DIQ="RESULT"
	. S DA(63.292)=STER
	. D EN^DIQ1
	. S ^TMP("LRM",$J,"BSTER",STER)=RESULT(63.292,STER,.01,"E")
	Q
GRAM	; Get Gram Stain Results
	N ISO
	Q:'$D(^LR(LRDFN,"MI",IX,2))
	S ISO=0
	F  S ISO=$O(^LR(LRDFN,"MI",IX,2,ISO)) Q:ISO=""  S ^TMP("LRM",$J,"GRAM",ISO)=^(ISO,0)
	Q
LABTEST(SDT,LRACC)	;Get lab test names and results
	N X,Y,LRAA,LRAN,LRAD,LRBRR,LRTSTS,LRTS
	S LRAD=+$E(SDT)_$P(LRACC," ",2)_"0000",X=$P(LRACC," "),DIC=68,DIC(0)="M"
	Q:'$L(X)  D ^DIC S LRAA=+Y,LRAN=+$P(LRACC," ",3)
	S LRBRR=0
	F  S LRBRR=+$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR)) Q:LRBRR'>0  D
	. S LRTS=+^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR,0),LRTS(1)=$P(^(0),U,5)
	. Q:"BO"'[$P($G(^LAB(60,LRTS,0)),U,3)
	. S LRTSTS=$S($D(^LAB(60,LRTS,0)):$P(^(0),U),1:"deleted test")
	. ;Lab test name and results in print order
	. S ^TMP("LRM",$J,0,"TEST",$S($D(^LAB(60,LRTS,.1)):$P(^(.1),U,6),1:"")_","_U_LRBRR)=LRTSTS_U_LRTS(1)
	Q

GMTSLRMX
GMTSLRMX	;SLC/JER - Extended Microbiology Extract ;1/3/92  09:17
	;;2.7;Health Summary;;Oct 20, 1995
PARA	; Get Parasitology Work-up
	N DA,DIC,DIQ,DR,STATUS,PN,SN,RMK,SMEAR,COM
	I $D(^LR(LRDFN,"MI",IX,5)) D
	. S DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)=15,DIQ="STATUS"
	. S DIQ(0)="E" D EN^DIQ1
	. S ^TMP("LRM",$J,"PARA",0)=$E($P(STATUS(63.05,IX,15,"E")," ",1),1,6)
	S PN=0
	F  S PN=$O(^LR(LRDFN,"MI",IX,6,PN)) Q:+PN'>0  D
	. S SN=0
	. D IDPARA
	. F  S SN=$O(^LR(LRDFN,"MI",IX,6,PN,1,SN)) Q:+SN'>0  D IDPARA
	; Parasitology smear/prep
	S SMEAR=0
	F  S SMEAR=$O(^LR(LRDFN,"MI",IX,24,SMEAR)) Q:SMEAR'>0  S ^TMP("LRM",$J,"PARA","SMEAR",SMEAR)=^(SMEAR,0)
	; remark
	S RMK=0
	F  S RMK=$O(^LR(LRDFN,"MI",IX,7,RMK)) Q:+RMK'>0  S ^TMP("LRM",$J,"PARA","R",RMK)=^(RMK,0)
	Q
IDPARA	;Get parasite stage, quantity, and comment
	N DA,DIC,DIQ,DR,PARA,STAGE
	I 'SN S PARA=+^LR(LRDFN,"MI",IX,6,PN,0),PARA=$S($D(EXPAND):PN_";"_$P(^LAB(61.2,PARA,0),U),1:$P(^LAB(61.2,PARA,0),U)),^TMP("LRM",$J,"PARA",PN)=PARA Q
	S DA=LRDFN,DA(63.05)=IX,DA(63.34)=PN,DA(63.35)=SN,DIC=63,DIQ="STAGE",DIQ(0)="E",DR=5,DR(63.05)=16,DR(63.34)=1,DR(63.35)=".01;1" D EN^DIQ1
	S ^TMP("LRM",$J,"PARA",PN,SN)=STAGE(63.35,SN,.01,"E")_U_STAGE(63.35,SN,1,"E")
	;comment
	S COM=0
	F  S COM=$O(^LR(LRDFN,"MI",IX,6,PN,1,SN,1,COM)) Q:COM'>0  S ^TMP("LRM",$J,"PARA",PN,SN,"COM",COM)=^(COM,0)
	Q
MYCO	; Get Mycology Work-up
	N DA,DIC,DIQ,DR,DA,STATUS,GMW,ISO,FUN,RMK,COM,SMEAR
	I $D(^LR(LRDFN,"MI",IX,8)) D
	. S DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)=19,DIQ="STATUS"
	. S DIQ(0)="E" D EN^DIQ1
	. S ^TMP("LRM",$J,"MYCO",0)=$E($P(STATUS(63.05,IX,19,"E")," ",1),1,6)
	S ISO=0
	F  S ISO=$O(^LR(LRDFN,"MI",IX,9,ISO)) Q:+ISO'>0  D
	. D FNGS S ^TMP("LRM",$J,"MYCO",ISO)=$S($D(EXPAND):ISO_";"_FUN,1:FUN)
	. ;comment
	. S COM=0
	. F  S COM=$O(^LR(LRDFN,"MI",IX,9,ISO,1,COM)) Q:COM'>0  S ^TMP("LRM",$J,"MYCO",ISO,"COM",COM)=^(COM,0)
	; Mycology smear/prep
	S SMEAR=0
	F  S SMEAR=$O(^LR(LRDFN,"MI",IX,15,SMEAR)) Q:SMEAR'>0  S ^TMP("LRM",$J,"MYCO","SMEAR",SMEAR)=^(SMEAR,0)
	; remark
	S RMK=0
	F  S RMK=$O(^LR(LRDFN,"MI",IX,10,RMK)) Q:+RMK'>0  S ^TMP("LRM",$J,"MYCO","R",RMK)=^(RMK,0)
	Q
FNGS	N QTY
	S FUN=+^LR(LRDFN,"MI",IX,9,ISO,0),QTY=$P(^(0),U,2),FUN=$P(^LAB(61.2,FUN,0),U)
	S FUN=FUN_U_QTY
	Q
TB	; Gets Mycobacteriology Work-up
	N DA,DIC,DIQ,DR,STATUS,GMW,ISO,MB,RMK,X,Y,COM,MY,GMTB,GMTBA
	I $D(^LR(LRDFN,"MI",IX,11)) D
	. S DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)="23;24;25",DIQ="STATUS"
	. S DIQ(0)="E" D EN^DIQ1
	. ;Status, Acid Fast Stain, Quantity
	. S ^TMP("LRM",$J,"TB",0)=$E($P(STATUS(63.05,IX,23,"E")," ",1),1,6)_U_STATUS(63.05,IX,24,"E")_U_STATUS(63.05,IX,25,"E")
	S ISO=0
	F  S ISO=$O(^LR(LRDFN,"MI",IX,12,ISO)) Q:+ISO'>0  D
	. D MYCB S ^TMP("LRM",$J,"TB",ISO)=$S($D(EXPAND):ISO_";"_MB,1:MB)
	. ;comment
	. S COM=0
	. F  S COM=$O(^LR(LRDFN,"MI",IX,12,ISO,1,COM)) Q:COM'>0  S ^TMP("LRM",$J,"TB",ISO,"COM",COM)=^(COM,0)
	. ;Susceptiblities
	. S GMTB=2
	. F  S GMTB=$O(^LR(LRDFN,"MI",IX,12,ISO,GMTB)) Q:GMTB'["2."!(GMTB="")  D
	. . S GMTBA=+$O(^DD(63.39,"GL",GMTB,1,0))
	. . S GMTBA=$$GET1^DID(63.39,GMTBA,"","LABEL")
	. . S ^TMP("LRM",$J,"TB",ISO,"SUSC",GMTB)=GMTBA_U_$P(^LR(LRDFN,"MI",IX,12,ISO,GMTB),U)
	; remark
	S RMK=0
	F  S RMK=$O(^LR(LRDFN,"MI",IX,13,RMK)) Q:RMK=""  S ^TMP("LRM",$J,"TB","R",RMK)=^(RMK,0)
	Q
MYCB	N QTY
	S MB=+^LR(LRDFN,"MI",IX,12,ISO,0),QTY=$P(^(0),U,2),MB=$P(^LAB(61.2,MB,0),U)
	S MB=MB_U_QTY
	Q
VIRO	; Gets Virology Work-up
	N BUG,DA,DIC,DIQ,DR,GMW,ISO,RMK,STATUS
	I $D(^LR(LRDFN,"MI",IX,16)) D
	. S DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)=34,DIQ="STATUS"
	. S DIQ(0)="E" D EN^DIQ1
	. S ^TMP("LRM",$J,"VIRO",0)=$E($P(STATUS(63.05,IX,34,"E")," ",1),1,6)
	S ISO=0
	F  S ISO=$O(^LR(LRDFN,"MI",IX,17,ISO)) Q:+ISO'>0  D
	. D PHAGE S ^TMP("LRM",$J,"VIRO",ISO)=$S($D(EXPAND):ISO_";"_BUG,1:BUG)
	S RMK=0
	F  S RMK=$O(^LR(LRDFN,"MI",IX,18,RMK)) Q:RMK=""  S ^TMP("LRM",$J,"VIRO","R",RMK)=^(RMK,0)
	Q
PHAGE	S BUG=+^LR(LRDFN,"MI",IX,17,ISO,0),BUG=$P(^LAB(61.2,BUG,0),U)
	Q

GMTSLROB
GMTSLROB	;SLC/JER - Brief Lab Order Status Summary Component ;10/10/91  11:49 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Driver
	N GMW,GMX,ICD,MAX,OC,SN
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	D ^GMTSLROE
	I '$D(^TMP("LRO",$J)) Q
	D WRTHDR
	S (ICD,OC)=0 F  S ICD=$O(^TMP("LRO",$J,ICD)) Q:'ICD!(OC'<MAX)  S SN=0 F  S SN=$O(^TMP("LRO",$J,ICD,SN)) Q:'SN!(OC'<MAX)  D MORE
	K ^TMP("LRO",$J)
	Q
MORE	S GMX=^TMP("LRO",$J,ICD,SN),OC=OC+1 I ICD>GMTS1,(ICD'>GMTS2) D WRT
	Q
WRTHDR	; Prints Header
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?16,"Test Name"
	W ?37,"Specimen",?51,"Urgency",?68,"Status",!!
	Q
WRT	; Writes Component
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR W $P(GMX,U),?16,$P($P(GMX,U,2),";",2),?37,$E($P($P(GMX,U,3),";",2),1,10),?51,$P(GMX,U,4),?68,$P(GMX,U,5),!
	Q

GMTSLROE
GMTSLROE	;SLC/JER - Lab Orders Extract Routine ;11/7/94  10:11
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	; Gets lab orders and loads them into GMTSLRO local array
	N LRDFN,GMI,CD,ID,SN,TN K ^TMP("LROI",$J)
	K ^TMP("LRO",$J)
	Q:'$D(^DPT(DFN,"LR"))  S LRDFN=+^DPT(DFN,"LR") Q:'$D(^LR(LRDFN))
	S CD=GMTSBEG
	F  S CD=$O(^LRO(69,"D",LRDFN,CD)) Q:CD'>0!(CD>GMTSEND)  S SN=0 F  S SN=$O(^LRO(69,"D",LRDFN,CD,SN)) Q:SN'>0  S TN=0 F  S TN=$O(^LRO(69,CD,1,SN,2,TN)) Q:TN'>0  S ^TMP("LROI",$J,9999999-CD,SN,TN)=""
	S (GMI,ID)=0 F  S ID=$O(^TMP("LROI",$J,ID)) Q:ID'>0!(GMI=MAX)  S CD=9999999-ID,SN=0 F  S SN=$O(^TMP("LROI",$J,ID,SN)) Q:SN'>0!(GMI=MAX)  S TN=0 F  S TN=$O(^TMP("LROI",$J,ID,SN,TN)) Q:TN'>0!(GMI=MAX)  D SET
	K ^TMP("LROI",$J)
	Q
SET	; Sets ^TMP("LRO",$J, w/appropriate data
	N SPST,CST,OS,CDT,SPST,FST,RDT,SITE,SPEC,TST,IDT,COLL,ODT,MD,CS,URG,ACC
	N RL,TEST
	I $D(^LRO(69,CD,1,SN,0)) S SPST=^(0) D ORDER
	I $D(^LRO(69,CD,1,SN,1)) S CST=^(1) D COLLECT I 1
	E  S OS="ORDERED",X=$P(^LRO(69,CD,1,SN,0),U,8),IDT=9999999-X D REGDTM^GMTSU S CDT=X K X
	I $D(^LRO(69,CD,1,SN,3)) S FST=^(3) D RESULT I 1
	E  S RDT="UNKNOWN"
	S SITE=+$G(^LRO(69,CD,1,SN,4,+$O(^LRO(69,CD,1,SN,4,0)),0)),SPEC=$S(SITE>0:SITE_";"_$P(^LAB(61,SITE,0),U),1:";UNKNOWN")
	I $D(^LRO(69,CD,1,SN,2,TN,0)) S TST=^(0) D TEST
	I $D(BADTEST) K BADTEST Q
	I $D(IDT),$D(SN),$D(TN) S ^TMP("LRO",$J,IDT,SN_TN)=CDT_U_TEST_U_SPEC_U_URG_U_OS_U_MD_U_ODT_U_ACC_U_RDT_U_COLL_U_CD,GMI=GMI+1
	Q
ORDER	N NML,IFN,FNF,FILE,NM,NSPACE,PKG,X
	S COLL=$S($L($P(SPST,U,4)):$P(SPST,U,4),1:"UNKNOWN")
	S:"LW"[COLL COLL=$S(COLL="L":"LAB",1:"WARD")
	S X=$P(SPST,U,5) D REGDTM^GMTSU S ODT=X
	S NML=10,(MD,IFN)=$P(SPST,U,6),FNF=0,NSPACE="LR",PKG=$$VERSION^XPDUTL(NSPACE),FILE=$S($G(PKG)<5.2:6,1:200) D NAME^GMTSU S MD=MD_";"_NM
	S RL=$P(SPST,U,7)
	Q
COLLECT	N X S X=$P(CST,U),IDT=9999999-X D REGDTM^GMTSU S CDT=X
	S CS=$P(CST,U,4),OS="COLLECTED"
	Q
RESULT	N X S X=$P(FST,U,2) D REGDTM^GMTSU S RDT=X
	Q
TEST	N TPTR,UPTR,ACCD,ACCA,ACCN
	S TPTR=+TST,UPTR=$P(TST,U,2),ACCD=$P(TST,U,3)
	I $D(TPTR),(TPTR'>0) S BADTEST=1 Q
	S ACCA=$P(TST,U,4),ACCN=$P(TST,U,5)
	S TEST=TPTR_";"_$S($L($P(^LAB(60,TPTR,0),U))<21:$P(^(0),U),1:$P(^(.1),U))
	S URG=$S($D(^LAB(62.05,+UPTR,0)):$P(^(0),U),1:"")
	I $S('$D(ACCD):1,'$L(ACCA):1,'$L(ACCD):1,1:0) S ACC="NONE" Q
	S ACC=$S($D(^LRO(68,+ACCA,1,+ACCD,1,+ACCN,.2)):^(.2),1:"NONE")
	I $D(^LRO(68,+ACCA,1,+ACCD,1,+ACCN,4,TPTR,0)) S X=$P(^(0),U,5) S OS=$S('$L(X):"PROCESSING",1:"COMPLETED")
	Q

GMTSLROS
GMTSLROS	;SLC/JER - Lab Order Status Summary Component ;10/10/91  11:51 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Driver
	N GMW,GMX,ICD,MAX,OC,SN
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	D ^GMTSLROE
	I '$D(^TMP("LRO",$J)) Q
	S (ICD,OC)=0 F  S ICD=$O(^TMP("LRO",$J,ICD)) Q:'ICD!(OC'<MAX)  S SN=0 F  S SN=$O(^TMP("LRO",$J,ICD,SN)) Q:'SN!(OC'<MAX)  D MORE
	K ^TMP("LRO",$J)
	Q
MORE	S GMX=^TMP("LRO",$J,ICD,SN),OC=OC+1 I ICD>GMTS1,(ICD'>GMTS2) D CKP^GMTSUP Q:$D(GMTSQIT)  W:OC>1&'(GMTSNPG) ! D WRT
	Q
WRT	; Writes Component
	N GMI,TSET,TEST
	S TSET="",$P(GMX,U,3)=$E($P(GMX,U,3),1,10)
	F GMI=1:1:3 S $P(TEST,"-",GMI)=$S(GMI=3:$P(GMX,U,GMI+1),1:$P($P(GMX,U,GMI+1),";",2))
	F  Q:$L(TEST)<23  S TSET=$P(TEST,"-",$L(TEST,"-"))_" "_TSET,TEST=$P(TEST,"-",1,$L(TEST,"-")-1)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(GMX,U),?16,$E(TEST,1,35),?39,"Prov: ",$P($P(GMX,U,6),";",2),?58,"Ord'd: ",$P(GMX,U,7),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  G:GMTSNPG WRT W ?16,TSET,?40,"Acc: ",$P(GMX,U,8),?58,"Avail: ",$P(GMX,U,9),!
	Q

GMTSLRPE
GMTSLRPE	;SLC/JER - Cytopathology Extract Routine ;3/29/95  11:52
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	N IX0,IX
	K ^TMP("LRCY",$J)
	S IX=GMTS1 F IX0=1:0:MAX S IX=$O(^LR(LRDFN,"CY",IX)) Q:IX'>0!(IX>GMTS2)  D CYSET
	Q
CYSET	; Sets ^TMP("LRCY",$J, with appropriate data elements
	N ACC,CDT,D1,D2,D3,DA,DIC,DIQ,DR,DX,ICD,OT,SR,RELEASE,SITE,SN,X,YR
	S CDT=$P(^LR(LRDFN,"CY",IX,0),U),YR=$E(CDT,2,3),ACC=$P(^(0),U,6),RELEASE=$P(^(0),U,11)
	I $D(ACC),$D(YR) S ACC="CY "_YR_" "_ACC,IX0=IX0+1
	S X=CDT D REGDT^GMTSU S CDT=X K X
	S ^TMP("LRCY",$J,IX,0)=CDT_U_ACC
	I $D(^LR(LRDFN,"CY",IX,.1)) S ^TMP("LRCY",$J,IX,1)="Site/Specimen"_U_RELEASE
	Q:'RELEASE
	S SN=0 F  S SN=$O(^LR(LRDFN,"CY",IX,.1,SN)) Q:SN'>0  S ^TMP("LRCY",$J,IX,1,SN)=$P(^LR(LRDFN,"CY",IX,.1,SN,0),U)
	S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,.2,OT)) Q:+OT'>0  S ^TMP("LRCY",$J,IX,"AH",OT)=$G(^LR(LRDFN,"CY",IX,.2,OT,0))
	S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1,OT)) Q:OT'>0  S ^TMP("LRCY",$J,IX,"G",OT)=^LR(LRDFN,"CY",IX,1,OT,0)
	S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1.1,OT)) Q:OT'>0  S ^TMP("LRCY",$J,IX,"MI",OT)=^LR(LRDFN,"CY",IX,1.1,OT,0)
	S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1.2,OT)) Q:OT'>0  D
	. Q:+$P($G(^LR(LRDFN,"CY",IX,1.2,OT,0)),U,2)'>0
	. S ^TMP("LRCY",$J,IX,"SR",OT,0)=$P($G(^LR(LRDFN,"CY",IX,1.2,OT,0)),U)
	. S SR=0 F  S SR=$O(^LR(LRDFN,"CY",IX,1.2,OT,1,SR)) Q:SR'>0  D
	. . S ^TMP("LRCY",$J,IX,"SR",OT,SR)=$P($G(^LR(LRDFN,"CY",IX,1.2,OT,1,SR,0)),U)
	S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1.4,OT)) Q:+OT'>0  S ^TMP("LRCY",$J,IX,"NDX",OT)=$P($G(^LR(LRDFN,"CY",IX,1.4,OT,0)),U)
	;S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,2,OT)) Q:OT=""  S ^TMP("LRCY",$J,IX,"OT"_OT,0)=$P(^LAB(61,+^LR(LRDFN,"CY",IX,2,OT,0),0),U) D D,M,P
	;S DX=0 F  S DX=$O(^LR(LRDFN,"CY",IX,3,DX)) Q:DX=""  S ICD=+^LR(LRDFN,"CY",IX,3,DX,0) D
	;. N DIC,DIQ,DR,DA,REC
	;. S DIC=80,DA=ICD,DIQ="REC(",DIQ(0)="IE",DR=".01;3"
	;. D EN^DIQ1
	;. Q:'$D(REC)
	;. S ^TMP("LRCY",$J,IX,"XI",DX)=REC(80,DA,.01,"E")_U_REC(80,DA,3,"E")
	Q
D	; Get Disease Field data
	N GMD,DIS
	S GMD=0 F  S GMD=$O(^LR(LRDFN,"CY",IX,2,OT,1,GMD)) Q:GMD=""  S ^TMP("LRCY",$J,IX,"OT"_OT,"D"_GMD)=$P(^LAB(61.4,+^LR(LRDFN,"CY",IX,2,OT,1,GMD,0),0),U)
	Q
M	; Get Morphology Field data
	N GMM,MORPH
	S GMM=0 F  S GMM=$O(^LR(LRDFN,"CY",IX,2,OT,2,GMM)) Q:GMM=""  S ^TMP("LRCY",$J,IX,"OT"_OT,"M"_GMM)=$P(^LAB(61.1,+^LR(LRDFN,"CY",IX,2,OT,2,GMM,0),0),U) D E
	Q
E	; Get Etiology Field data
	N GME,ETIOL
	S GME=0 F  S GME=$O(^LR(LRDFN,"CY",IX,2,OT,2,GMM,1,GME)) Q:GME'>0  S ^TMP("LRCY",$J,IX,"OT"_OT,"M"_GMM,"E"_GME)=$P(^LAB(61.2,+^LR(LRDFN,"CY",IX,2,OT,2,GMM,1,GME,0),0),U)
	Q
P	; Get Procedure Field data
	N GMP,PROC
	S GMP=0 F  S GMP=$O(^LR(LRDFN,"CY",IX,2,OT,4,GMP)) Q:GMP=""  S ^TMP("LRCY",$J,IX,"OT"_OT,"P"_GMP)=$P(^LAB(61.5,+^LR(LRDFN,"CY",IX,2,OT,4,GMP,0),0),U)
	Q

GMTSLRS
GMTSLRS	;SLC/JER - Sel Lab Component w/Selection Items ;6/4/92  11:22
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMTSI,GMW,GMX,LRDFN,MAX,IT,IX,PTEST,TEST,BEGIN,END,CNT,RWIDTH
	N GMLINE,GMCMNT,GMCFLAG
	S RWIDTH=8 ;Optional variable used in ^GMTSLRSE
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR")
	S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0)
	I '$D(^LR(LRDFN)) Q
	I '$O(GMTSEG(GMTSEGN,60,0)) Q
	S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,60,GMTSI)) Q:GMTSI'>0  S (PTEST,TEST)=GMTSEG(GMTSEGN,60,GMTSI) D @$S($L($P(^LAB(60,TEST,0),U,5)):"^GMTSLRSE",1:"PANEL")
	I '$D(^TMP("LRS",$J)) Q
	D WRTHDR
	S IT=0
	F  S IT=$O(^TMP("LRS",$J,IT)) Q:+IT'>0  S IX="" F  S IX=$O(^TMP("LRS",$J,IT,IX)) Q:'IX!(IX>GMTS2)  S GMX=^TMP("LRS",$J,IT,IX) D WRT
	I +$G(GMCFLAG) D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W "!!  Indicates COMMENTS AVAILABLE...Refer to Interim Lab Report.",!
	K ^TMP("LRS",$J)
	Q
PANEL	; Visits "PANEL" multiple to get pointers to atomic tests
	N TEST,GMW,INDX
	S INDX=0 F  S INDX=$O(^LAB(60,PTEST,2,INDX)) Q:'INDX  S TEST=^(INDX,0) S:'$L($P(^LAB(60,TEST,0),U,5)) PTEST=TEST D @$S($L($P(^LAB(60,TEST,0),U,5)):"^GMTSLRSE",1:"PANEL")
	Q
WRTHDR	; Prints columnar header
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?16,"Specimen",?27,"Test Name",?48,"Result",?58,"Units",?68,"Ref Range",!!
	Q
WRT	; Writes the Lab Record
	D CKP^GMTSUP Q:$D(GMTSQIT)  D
	. D:GMTSNPG WRTHDR
	. W $P(GMX,U),?16,$P($P(GMX,U,2),";",2)
	. I $D(^TMP("LRS",$J,"C",IX))>9,'+$G(GMCMNT) W ?24,"!! " S GMCFLAG=1
	. W ?27,$P($P(GMX,U,3),";",2),?46,$P(GMX,U,4)," ",$P(GMX,U,5),?58,$P(GMX,U,6),?68,$J($P(GMX,U,7),4),?73,"-",?74,$J($P(GMX,U,8),4),!
	I +$G(GMCMNT),$D(^TMP("LRS",$J,"C",IX))>9 D  Q
	. S GMLINE=0
	. F  S GMLINE=$O(^TMP("LRS",$J,"C",IX,GMLINE)) Q:GMLINE'>0  D
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . W "Comment: ",^TMP("LRS",$J,"C",IX,GMLINE),!
	Q

GMTSLRS7
GMTSLRS7	;SLC/JER - Sel Cum Lab Component w/Selection Items ;7/22/92  08:36
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMTSI,GMW,HDR,LRDFN,MAX,TEST,RWIDTH,GMCMNT,COMMNBR,GMCOM,TAB
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR")
	I '$D(^LR(LRDFN)) Q
	I '$O(GMTSEG(GMTSEGN,60,0)) Q
	S RWIDTH=4 ;Width of result which is used by lab print code
	S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,60,GMTSI)) Q:GMTSI'>0  S TEST=GMTSEG(GMTSEGN,60,GMTSI) D ^GMTSLRSE
	I '$D(^TMP("LRS",$J)) Q
	S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0),COMMNBR=0
	D DISPLAY
	I GMCMNT,'$D(GMTSQIT) D WRTCOMM
	K ^TMP("LRS",$J),^TMP("LRSR",$J)
	Q
DISPLAY	; Displays up to 7 tests across page
	N HDR,TST,GMI,GMX,GMW,IT,IX
	D INVRT
	S IT=""
	F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:'IT  S IX="" F  S IX=$O(^(IT,IX)) Q:IX'>0  S TST=+$P(^(IX),U,3),HDR(GMI)=$S(TST'="":$E($P(^LAB(60,TST,.1),U),1,7),1:"") K ^TMP("LRS",$J,IT)
	D WRTHDR
	S IX=""
	F GMW=1:1:MAX S IX=$O(^TMP("LRSR",$J,IX)) Q:+IX'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR S IT="" F GMI=0:1:6 S IT=$O(^TMP("LRSR",$J,IX,IT)) Q:IT=""  D WRT I '$O(^TMP("LRSR",$J,IX,IT)) W !
	I (+$G(GMW)=+$G(MAX)),(+IX>0),$O(^TMP("LRSR",$J,IX)) D CKP^GMTSUP Q:$D(GMTSQIT)  W $C(7),!?10,"** Additional Results available outside occurrence limit **",!
	Q
INVRT	; Inverts ^TMP("LRS",$J,IT,IX)=CDT^SPEC^TNM^RESULT^FLAG^UNIT^LO^HI to
	;         ^TMP("LRSR",$J,IX,IT)=GMI,CDT,SPEC,RESULT,FLAG
	N GMI,GMW,IT,IX
	S IT=""
	F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:IT'>0  S IX="" F  S IX=$O(^TMP("LRS",$J,IT,IX)) Q:IX=""  S ^TMP("LRSR",$J,IX,IT)=GMI_U_$P(^TMP("LRS",$J,IT,IX),U,1,2)_U_$P(^TMP("LRS",$J,IT,IX),U,4,5)
	Q
WRTHDR	; Writes Column Header
	N GMI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?16,$S(+$G(GMCMNT):" ",1:""),"Spec"
	F GMI=0:1:6 D CKP^GMTSUP Q:'$D(HDR(GMI))!($D(GMTSQIT))  W ?((8*GMI+24)+(7-$L(HDR(GMI))\2)),HDR(GMI)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !!
	Q
WRT	; Writes the Lab Record
	S GMX=^TMP("LRSR",$J,IX,IT),TAB=$P(GMX,U)
	I GMI=0!(GMTSNPG) D
	. ;Index up to 26 date with comments when flag turned on
	. I +$G(GMCMNT),$D(^TMP("LRS",$J,"C",IX))>0,$D(GMCOM("DT",IX))'>0,COMMNBR<26 D
	. . S GMLTR=$C(97+COMMNBR) S COMMNBR=COMMNBR+1
	. . S GMCOM("DT",IX)=GMLTR,GMCOM("LTR",GMLTR)=IX
	. I +$G(GMCMNT) W $E($G(GMCOM("DT",IX)),1),?2,$P(GMX,U,2),?17,$E($P($P(GMX,U,3),";",2),1,6) Q
	. W $P(GMX,U,2),?16,$E($P($P(GMX,U,3),";",2),1,7)
	W ?(8*TAB+24),$P(GMX,U,4)," ",$P(GMX,U,5)
	Q
WRTCOMM	; Writes the lab Comments
	N GMLTR,GMLINE
	Q:$D(GMCOM)'>0
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "COMMENTS:",!
	S GMLTR=""
	F  S GMLTR=$O(GMCOM("LTR",GMLTR)) Q:GMLTR']""  D  Q:$D(GMTSQIT)
	. S IX=$G(GMCOM("LTR",GMLTR)),GMLINE=0
	. F  S GMLINE=$O(^TMP("LRS",$J,"C",+IX,GMLINE)) Q:GMLINE'>0  D  Q:$D(GMTSQIT)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W "COMMENTS:",!
	. . W:GMLINE=1!GMTSNPG GMLTR_"."
	. . W ?3,$G(^TMP("LRS",$J,"C",+IX,GMLINE)),!
	Q

GMTSLRSC
GMTSLRSC	;SLC/JER - Sel Cum Lab Component w/Selection Items ;8-AUG-95
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMTSI,LRDFN,MAX,TEST,RWIDTH,GMCMNT,COMMNBR,GMCOM,TAB
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	I '$D(^DPT(DFN,"LR")) Q
	S LRDFN=+^DPT(DFN,"LR")
	I '$D(^LR(LRDFN)) Q
	I '$O(GMTSEG(GMTSEGN,60,0)) Q
	S RWIDTH=4 ;Width of result which is used by lab print code
	S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,60,GMTSI)) Q:GMTSI'>0  S TEST=GMTSEG(GMTSEGN,60,GMTSI) D ^GMTSLRSE
	I '$D(^TMP("LRS",$J)) Q
	S GMCMNT=$S($P($G(^GMT(142.99,1,0)),U,3)="Y":1,1:0),COMMNBR=0
	F  D DISPLAY Q:$O(^TMP("LRS",$J,0))'>0
	I GMCMNT,'$D(GMTSQIT) D WRTCOMM
	K ^TMP("LRS",$J),^TMP("LRSR",$J)
	Q
DISPLAY	; Displays up to 7 tests across page
	N GMI,GMW,GMX,HDR,TST,IT,IX
	D INVRT
	S IT=""
	F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:'IT  S IX="" F  S IX=$O(^(IT,IX)) Q:IX'>0  S TST=+$P(^(IX),U,3),HDR(GMI)=$S(TST'="":$E($P(^LAB(60,TST,.1),U),1,7),1:"") K ^TMP("LRS",$J,IT)
	D WRTHDR
	S IX=""
	F GMW=1:1:MAX S IX=$O(^TMP("LRSR",$J,IX)) Q:+IX'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR S IT="" F GMI=0:1 S IT=$O(^TMP("LRSR",$J,IX,IT)) Q:IT=""  D WRT I '$O(^TMP("LRSR",$J,IX,IT)) W !
	I (+$G(GMW)=+$G(MAX)),(+IX>0),$O(^TMP("LRSR",$J,IX)) D CKP^GMTSUP Q:$D(GMTSQIT)  W $C(7),!?10,"** Additional Results available outside occurrence limit **",!
	K ^TMP("LRSR",$J) W:$D(^TMP("LRS",$J)) !
	Q
INVRT	; Inverts ^TMP("LRS",$J,IT,IX)=CDT^SPEC^TNM^RESULT^FLAG^UNIT^LO^HI to
	;         ^TMP("LRSR",$J,IX,IT)=GMI,CDT,SPEC,RESULT,FLAG
	N GMI,IT,IX
	S IT=""
	F GMI=0:1:6 S IT=$O(^TMP("LRS",$J,IT)) Q:IT'>0  S IX="" F  S IX=$O(^TMP("LRS",$J,IT,IX)) Q:IX=""  S ^TMP("LRSR",$J,IX,IT)=GMI_U_$P(^TMP("LRS",$J,IT,IX),U,1,2)_U_$P(^TMP("LRS",$J,IT,IX),U,4,5)
	Q
WRTHDR	; Writes Column Header
	N GMI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Collection DT",?16,$S(+$G(GMCMNT):" ",1:""),"Spec"
	F GMI=0:1:6 D CKP^GMTSUP Q:'$D(HDR(GMI))!($D(GMTSQIT))  W ?((8*GMI+24)+(7-$L(HDR(GMI))\2)),HDR(GMI)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !!
	Q
WRT	; Writes the Lab Record
	S GMX=^TMP("LRSR",$J,IX,IT),TAB=$P(GMX,U)
	I GMI=0!(GMTSNPG) D
	. ;Index up to 26 date with comments when flag turned on
	. I +$G(GMCMNT),$D(^TMP("LRS",$J,"C",IX))>0,$D(GMCOM("DT",IX))'>0,COMMNBR<26 D
	. . S GMLTR=$C(97+COMMNBR) S COMMNBR=COMMNBR+1
	. . S GMCOM("DT",IX)=GMLTR,GMCOM("LTR",GMLTR)=IX
	. I +$G(GMCMNT) W $E($G(GMCOM("DT",IX)),1),?2,$P(GMX,U,2),?17,$E($P($P(GMX,U,3),";",2),1,6) Q
	. W $P(GMX,U,2),?16,$E($P($P(GMX,U,3),";",2),1,7)
	W ?(8*TAB+24),$P(GMX,U,4)," ",$P(GMX,U,5)
	Q
WRTCOMM	; Writes the lab Comments
	N GMLTR,GMLINE
	Q:$D(GMCOM)'>0
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "COMMENTS:",!
	S GMLTR=""
	F  S GMLTR=$O(GMCOM("LTR",GMLTR)) Q:GMLTR']""  D  Q:$D(GMTSQIT)
	. S IX=$G(GMCOM("LTR",GMLTR)),GMLINE=0
	. F  S GMLINE=$O(^TMP("LRS",$J,"C",+IX,GMLINE)) Q:GMLINE'>0  D  Q:$D(GMTSQIT)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG W "COMMENTS:",!
	. . W:GMLINE=1!GMTSNPG GMLTR_"."
	. . W ?3,$G(^TMP("LRS",$J,"C",+IX,GMLINE)),!
	Q

GMTSLRSE
GMTSLRSE	;SLC/JER - Selected Lab Test Extract Routine ;5/15/91  08:40
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	; Call with: LRDFN, GMTS1, GMTS2, MAX (Occ. Limit), SEX ("M" or "F"),
	; TEST (IFN to ^LAB(60)) and RWIDTH (optional)
	; "Returns":
	; ^TMP("LRS",$J,GMTSI,IDRWDT)=DRWDT^SPEC^TEST^RESULT^FLAG^UNIT^LO^HI
	; where: GMTSI=Order (1 to MAX) and IDRWDT=9999999-Draw Date/time,
	; DRWDT=Draw Date/Time (internal), SPEC=Specimen (int;ext),
	; TEST=Test (int;ext), RESULT=Numeric Result,
	; FLAG=Reference flag (H,*H,L,*L), UNIT=Unit of measure (ext),
	; LO=Reference/Therapeutic Lower bound, HI=Ref/Ther Upper Bound
	N CNT,AGE,COM,GMI,X
	K ^TMP("LRS",$J,GMTSI)
	I $S("BO"'[$P(^LAB(60,TEST,0),U,3):1,1:0) Q
	I '$D(GMTSAGE) D DEM^GMTSU
	S AGE=GMTSAGE
	S CNT=0 D CHEM:$P(^LAB(60,TEST,0),U,4)="CH"
	Q
CHEM	; Gets all Chemistry tests w/in time/occurrence constraints
	N PTR,IDRWDT
	S PTR=+$P($P(^LAB(60,+TEST,0),U,5),";",2)
	S IDRWDT=GMTS1
	F  S IDRWDT=$O(^LR(LRDFN,"CH",IDRWDT)) Q:'IDRWDT!(IDRWDT>GMTS2)!(CNT'<MAX)  I $P(^(IDRWDT,0),U,3),($D(^(PTR))) S CNT=CNT+1 D:CNT'>MAX CHSET
	Q
CHSET	; Sets Chemistry locals for printing
	N RESULT,FLAG,DRWDT,SITE,SPEC,TNM,DESCR,THER,UNIT,HI,LO,GMIDT
	S RESULT=$P(^LR(LRDFN,"CH",IDRWDT,PTR),U),FLAG=$P(^(PTR),U,2),DRWDT=9999999-IDRWDT
	S RESULT=$$RESULT^GMTSLRCE(TEST,RESULT,$G(RWIDTH))
	S X=DRWDT D REGDTM^GMTSU S DRWDT=X K X
	S SITE=$P(^LR(LRDFN,"CH",IDRWDT,0),U,5),SPEC=SITE_";"_$P(^LAB(61,SITE,0),U)
	S TNM=TEST_";"_$S($L($P(^LAB(60,TEST,0),U))<21:$P(^(0),U),1:$P(^(.1),U))
	S DESCR=$S($D(^LAB(60,TEST,1,SITE,0)):^(0),1:""),THER=$S($L($P(DESCR,U,11,12))>1:1,1:0)
	S UNIT=$P(DESCR,U,7),LO=$S(THER:$P(DESCR,U,11),1:$P(DESCR,U,2)),HI=$S(THER:$P(DESCR,U,12),1:$P(DESCR,U,3))
	S @("LO="_$S($L(LO):LO,1:"""""")),@("HI="_$S($L(HI):HI,1:""""""))
	I $D(^TMP("LRS",$J,GMTSI,IDRWDT)) S GMIDT=IDRWDT+.0001
	S GMIDT=IDRWDT
	S ^TMP("LRS",$J,GMTSI,GMIDT)=DRWDT_U_$E(SPEC,1,10)_U_TNM_U_RESULT_U_FLAG_U_UNIT_U_LO_U_HI
	I $D(^LR(LRDFN,"CH",IDRWDT,1,0)) D
	. S COM=0
	. F GMI=1:1 S COM=$O(^LR(LRDFN,"CH",IDRWDT,1,COM)) Q:+COM'>0  S ^TMP("LRS",$J,"C",GMIDT,GMI)=^LR(LRDFN,"CH",IDRWDT,1,COM,0)
	Q

GMTSLRT
GMTSLRT	;SLC/JER - Blood Bank Transfusion Component Driver ;2/18/92  09:11
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMA,GMI,GMR,IX,MAX,A,R,TD,BPN
	D ^GMTSLRTE ; Get Transfusion Records
	I '$D(^TMP("LRT",$J)) Q
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=999
	S IX=GMTS1 F GMI=1:1:MAX S IX=$O(^TMP("LRT",$J,IX)) Q:IX=""!(IX>GMTS2)  S GMR=^TMP("LRT",$J,IX) D PRSREC,WRT
	I $O(^TMP("LRT",$J,"A"))'="" D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W " Blood Product Key: "
	S GMI="A" F  S GMI=$O(^TMP("LRT",$J,GMI)) Q:GMI=""  D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,GMI," = ",$G(^TMP("LRT",$J,GMI)),!
	K ^TMP("LRT",$J)
	Q
PRSREC	; Parses Record for presentation
	N GMI,X
	S X=$P(GMR,U) D REGDT^GMTSU S TD=X
	S GMA(1)=$P(GMR,U,2),BPN=$L(GMA(1),";")
	I $P(GMA(1),";",BPN)="" S BPN=BPN-1
	F GMI=2:1:BPN S GMA(GMI)="("_$P($P(GMA(1),";",GMI),"\")_") "_$P($P(GMA(1),";",GMI),"\",2)
	S GMA(1)="("_$P($P(GMA(1),";",1),"\")_") "_$P($P(GMA(1),";",1),"\",2)
	Q
WRT	; Writes the Transfusion Record for each day
	N GML,GMI1,GMI2,GMM,GMJ
	S GMM=$S(BPN#4:1,1:0)
	S GML=BPN\4+GMM ; # of lines record will require
	D CKP^GMTSUP Q:$D(GMTSQIT)  W TD
	F GMI1=1:1:GML F GMI2=1:1:($S((GMI1=GML)&(BPN#4):BPN#4,1:4)) S GMJ=((GMI1-1)*4)+GMI2 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?(((GMI2-1)*15)+10),GMA(GMJ) I $S(GMI2#4=0:1,GMI2=BPN:1,GMI2+(4*(GMI1-1))=BPN:1,1:0) W !
	Q

GMTSLRTE
GMTSLRTE	;SLC/JER - Transfusion Record Extract Routine ;4/19/93  17:00
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	; Gets Transfusion Records and loads them into GMTSLRT local array
	N LRDFN,IDT,CNTR,TR,PN,PRODUCT
	S:'$D(GMTS1) GMTS1=6666666 S:'$D(GMTS2) GMTS2=9999999
	K ^TMP("LRT",$J)
	Q:'$D(^DPT(DFN,"LR"))  S LRDFN=+^DPT(DFN,"LR"),IDT=GMTS1-1
	I '$D(^LR(LRDFN)) Q
	S IDT=GMTS1-1 F  S IDT=$O(^LR(LRDFN,1.6,IDT)) Q:+IDT'>0!(IDT>GMTS2)  D
	. S TR=$G(^LR(LRDFN,1.6,IDT,0)) D SET
	S IDT=0 F  S IDT=$O(CNTR(IDT)) Q:+IDT'>0  D
	. S ^TMP("LRT",$J,IDT)=9999999-IDT_U
	. S PN=0 F  S PN=$O(CNTR(IDT,PN)) Q:PN'>0  D
	. . S PRODUCT=$G(^LAB(66,+PN,0)),^TMP("LRT",$J,$P(PRODUCT,U,2))=$P(PRODUCT,U)
	. . S ^TMP("LRT",$J,IDT)=^TMP("LRT",$J,IDT)_CNTR(IDT,PN)_"\"_$P(PRODUCT,U,2)_";"
	Q
SET	; Sets GMTSLRT w/appropriate data
	N COMP,UNITS,TDT,ITDT S TDT=9999999-IDT,ITDT=9999999-$P(TDT,".")
	S UNITS=+$P(TR,U,7) S:UNITS'>0 UNITS=1
	S CNTR(ITDT,+$P(TR,U,2))=+$G(CNTR(ITDT,+$P(TR,U,2)))+UNITS
	Q

GMTSLTR
GMTSLTR	;SLC/RWF,JER - Print Big Letters ;11/16/92  08:01 ;
	;;2.7;Health Summary;;Oct 20, 1995
	Q:'$L($G(GMTSLTR))  I '$D(^UTILITY("GMTSLTR",$J,"A")) D ^GMTSLTR2
B1	; Setup for banner print
	N GMTSDIV,GMTSLEN,GMTSXXX,GMTSBLNK,X
	S GMTSLEN=$L(GMTSLTR),GMTSDIV=60\GMTSLEN,$P(GMTSXXX,"X",(GMTSDIV\5+1))=""
	S $P(GMTSBLNK," ",(GMTSDIV\5+1))=""
	S GMTSLTY=$E(GMTSLTR,1,$S(GMTSLEN'>2:GMTSLEN,1:(IOM\GMTSDIV-1))),GMTSLTX=""
	F GMTSLT1=1:1:$L(GMTSLTY) D
	. I $A(GMTSLTY,GMTSLT1)>32,$D(^UTILITY("GMTSLTR",$J,$E(GMTSLTY,GMTSLT1))) D
	. . S GMTSLTX=GMTSLTX_$E(GMTSLTY,GMTSLT1)
	W:$L($P($G(GMTSSC),U,2)) "HEALTH SUMMARY REPORT FOR PATIENTS AT: ",$P(GMTSSC,U,2)
	I $L($P($G(GMTSSC),U,4)) S X=$P(GMTSSC,U,4) D REGDTM^GMTSU W !?34,"FOR: ",X
	I $L($P($G(GMTSSC),U,5)) S X=$P(GMTSSC,U,5) D REGDTM^GMTSU W " TO ",X
	W ! I $D(GMTSTIT) W ?(IOM-$L(GMTSTIT)\2),GMTSTIT,!!
	I $D(GMTSPNM) W ?10,"Patient: ",GMTSPNM,!
	I $D(GMTSWDN) W "Hospital Location: ",GMTSWDN,!
	I $D(DUZ) W ?33,"User: ",$P($G(^VA(200,DUZ,0)),U),!
	W ! F GMTSLT=1:1:6 D B2
	W @IOF
	K GMTSLT1,GMTSLT2,GMTSLT3,GMTSLTX,GMTSLTY,GMTSLT,^UTILITY("GMTSLTR",$J)
	Q
B2	W !
	F GMTSLT1=9:-1:1 W ! F GMTSLT3=1:1:$L(GMTSLTX) S X=^UTILITY("GMTSLTR",$J,$E(GMTSLTX,GMTSLT3)) W "   " F GMTSLT2=1:1:5 W $S($E(X,(GMTSLT2-1*9+GMTSLT1)):GMTSXXX,1:GMTSBLNK)
	Q

GMTSLTR2
GMTSLTR2	;SLC/DCM - Setup letters ;9/14/92  14:44 ;
	;;2.7;Health Summary;;Oct 20, 1995
	N GMTSZ,GMTSX
	F GMTSZ=1:1 S GMTSX=$P($T(ZZ+GMTSZ),";;",2) Q:GMTSX=""  S ^UTILITY("GMTSLTR",$J,$E(GMTSX,1))=$P(GMTSX,"=",2)
	Q
ZZ	;;
	;;0=00099999000909000900900900900900090900099999
	;;1=000000000009000090009999999009
	;;2=00990009000909000900900900900900900900900099
	;;3=00090009000900000900900900900900900900099099
	;;4=00009900000009090000009009000999999900009
	;;5=000900999009000909009000909009000909000999009
	;;6=000999900009009090009009009009009009000990009
	;;7=000000009009990009000009009000000909000000099
	;;8=00099099000900900900900900900900900900099099
	;;9=00900099000900900900900900900090900900009999
	;; =
	;;!=000000000000000000009099999
	;;"=000000000000000011000000000000000011
	;;#=000010100001111111000010100001111111000010100
	;;$=   2  2     2 2 2   2222222   2 2 2     2  2
	;;'=000000000000000000000000999
	;;(=000099900000900090009000009
	;;)=0000000000000000000090000090009000900000999
	;;+=000001000000001000000111110000001000000001
	;;,=0000000009000000000999
	;;-=000001000000001000000001000000001000000001
	;;.=0000000000000000000099
	;;/=000100000000010000000001000000000100000000010
	;;:=0000000000000000000000909
	;;;=0000000009000000000999009
	;;=000010100000010100000010100000010100000010100
	;;?=00000009000000000900909900900000090900000009
	;;A=0099999000000900900000900090000900900099999
	;;B=00999999900900900900900900900900900900099099
	;;C=00099999000900000900900000900900000900090009
	;;D=00999999900900000900900000900900000900099999
	;;E=009999999009009009009009009009009009009000009
	;;F=009999999000009009000009009000009009000000009
	;;G=000999990009000009009000009009090009009990009
	;;H=009999999000009000000009000000009000009999999
	;;I=000000000009000009009999999009000009
	;;J=000900000009000000009000000009000000000999999
	;;K=009999999000009000000090900000900090009000009
	;;L=009999999009000000009000000009000000009
	;;M=009999999000000090000009900000000090009999999
	;;N=009999999000000900000009000000090000009999999
	;;O=00099999000900000900900000900900000900099999
	;;P=00999999900000900900000900900000900900000099
	;;Q=00099999000900000900909000900090000900909999
	;;R=00999999900000900900009900900090900900900099
	;;S=00090099000900900900900900900900900900099009
	;;T=000000009000000009009999999000000009000000009
	;;U=000999999009000000009000000009000000000999999
	;;V=000099999000900000009000000000900000000099999
	;;W=009999999000900000000099000000900000009999999
	;;X=009900099000090900000009000000090900009900099
	;;Y=000000099000000900009999000000000900000000099
	;;Z=009900009009090009009009009009000909009000099

GMTSMCMA
GMTSMCMA	;WISC/DCB - Medicine 2.2 interface routine ;4/AUG/95
	;;2.7;Health Summary;;Oct 20, 1995
HSUM(PATID,BDATE,EDATE,OCC,WH,ATYPE)	;HEALTH SUMMARY API
	N ARRAY,MESSAGE,MSH,ST,ORD,MSTR,LOOP,MSTR,SAP,SNF,RAP,RNF,MST,PCI,VID
	N REC,LOC,QID,XDEST,WSF,MWDDC,WDC,QRL,BUILDER,LOOP,MESS1,MESS2,TMP
	N XMDUZ
	S ARRAY="TMP(""HS"",$J)"
	S XMTEXT="TMP(""HS"",$J,"
	S MSTR="|^~\&",HLECH=$E(MSTR,2,4)
	F LOOP=1:1:5 S ST(LOOP)=$E(MSTR,LOOP,LOOP)
	S MESSAGE="TMP",SAP="HEALTH SUMMARY",RAP="MEDICINE",VID=2.1
	S REC=+$O(^DIC(4,"D",DUZ(2),"")),LOC=$P($G(^DIC(4,REC,0)),U,1)
	S (RNF,SNF)=LOC,RAP="Medicine",SAP="Health Summary",MST="HS",PCI="P"
	S @ARRAY@(1,0)=$$MSH(MSTR,SAP,SNF,RAP,RNF,MST,PCI,VID)
	S ATYPE=$S(ATYPE="F":"RD",ATYPE="C":"RD",1:"PG")
	S QRL=$$CONVERT("D",BDATE)_ST(2)_$$CONVERT("D",EDATE)
	S QFC="R",QLR=ATYPE_ST(2)_OCC,WSF=PATID,WDDC=WH
	S @ARRAY@(2,0)=$$QRD(WSF,WDDC,QFC,QLR,QRL)
	S XMSUB="Health Summary Request",XMDUN="HEALTH SUMMARY"
	S XMY("G.MC MESSAGING SERVER")=""
	S XMDUZ=".5" ;Needs to be set so dots aren't displayed
	D ^XMD
	S MESS1=XMZ
	D KILL^XM
	S ARRY=$$HL7^MCORMN(MESS1) Q:+ARRY=0
	K ^TMP("MCAR",$J)
	D SLIT(ARRY)
	D REMOVE(MESS1,ARRY)
	Q
SLIT(ARRY)	;
	N LOOP,COUNT,BASE,MCOUNT,BUILDER
	S BUILDER="^XMB(3.9,"_ARRY_",2)"
	S LOOP=0,(MCOUNT,COUNT)=0,BASE="^TMP(""MCAR"",$J)"
	F  S LOOP=$O(@BUILDER@(LOOP)) Q:LOOP=""  D SLITTER
	Q
SLITTER	;THIS WILL SLIT THE MESSAGE IN A USEABLE FORM
	N VALUE,ROY,SUB,ROUT,LINE
	S VALUE=@BUILDER@(LOOP,0),ROY=$E(VALUE,1,3),SUB=1
	S ROUT=$S(ROY="MSH":"SMSH",ROY="PID":"SPID",ROY="OBR":"SOBR",ROY="OBX":"SOBX",ROY="MSH":"SMSH",1:"OTHER")
	S LINE="D "_ROUT_"("""_VALUE_""")"
	X LINE
	Q
SMSH(VALUE)	;SLIT THE MASSAGE HEADER
	N PROC,LOOP
	S MSTR=$E(VALUE,4,8)
	F LOOP=1:1:5 S ST(LOOP)=$E(MSTR,LOOP,LOOP)
	S MCOUNT=MCOUNT+1,COUNT=1
	S PROC=$P($P(VALUE,ST(1),3),U,1)
	S @BASE@(MCOUNT,COUNT,1)="PROCEDURE"_U_U_PROC
	D SETREF(MCOUNT,COUNT,"PROCEDURE")
	Q
SPID(VALUE)	;SLIT THE PID 
	Q
SOBR(VALUE)	;SLIT THE OBR
	N TEMP,XDATE
	S TEMP=$$CONVERTA("D",$P(VALUE,ST(1),8))
	S XDATE=TEMP,COUNT=COUNT+1
	S @BASE@(MCOUNT,COUNT,1)="DATE/TIME"_U_U_TEMP
	D SETREF(MCOUNT,COUNT,"DATE/TIME")
	S TEMP=$$CONVERTA("P200",$P(VALUE,ST(1),33))
	I TEMP'="" S COUNT=COUNT+1,@BASE@(MCOUNT,COUNT,1)="PRINCIPAL RESUILT INTERPRETER"_U_U_TEMP D SETREF(MCOUNT,COUNT,"PRINCIPAL RESULT INTERPRETER") S COUNT=COUNT+1
	S TEMP=$$CONVERTA("P200",$P(VALUE,ST(1),34))
	I TEMP'="" S COUNT=COUNT+1,@BASE@(MCOUNT,COUNT,1)="ASSISTANT RESUILT INTERPRETER"_U_U_TEMP  D SETREF(MCOUNT,COUNT,"ASSISTANT RESULT") S COUNT=COUNT+1
	S TEMP=$$CONVERTA("P200",$P(VALUE,ST(1),35))
	I TEMP'="" S COUNT=COUNT+1,@BASE@(MCOUNT,COUNT,1)="TECHNICIAN"_U_U_TEMP  D SETREF(MCOUNT,COUNT,"TECHNICIAN") S COUNT=COUNT+1
	Q
SOBX(VALUE)	;SLIT THE OBX
	N XDES,TEMP,FLDTYPE,UNITS
	S COUNT=COUNT+1
	S SUB=1,TEMP=$P(VALUE,ST(1),4),XDES=$P(TEMP,ST(2),2)
	S TEMP=$P(TEMP,ST(2),1),FLDTYPE=$P(TEMP,ST(3),3)
	S:FLDTYPE=+FLDTYPE XDES=XDES_";W"
	S VAL=$$CONVERTA(FLDTYPE,$P(VALUE,ST(1),6))
	S UNITS=$P(TEMP,ST(1),7)
	S @BASE@(MCOUNT,COUNT,1)=XDES_U_UNITS_U_VAL
	D SETREF(MCOUNT,COUNT,XDES)
	;S COUNT=COUNT+1
	Q
OTHER(VALUE)	;Set the next sub node if the lines cont.
	N TEMP,UNITS
	S TEMP=$P(VALUE,ST(1),1),UNITS=$P(VALUE,ST(1),2),SUB=SUB+1
	S @BASE@(MCOUNT,COUNT,SUB)=U_U_TEMP
	S:UNITS'="" $P(@BASE@(MCOUNT,COUNT,1),U,2)=UNITS
	Q
MSH(MSTR,SAP,SNF,RAP,RNF,MST,PCI,VID)	;MSH Messaging Line
	N MSH,Y,%,%I
	S MSH="MSH"_MSTR,$P(MSH,ST(1),3)=SAP,$P(MSH,ST(1),4)=SNF
	D NOW^%DTC S $P(MSH,ST(1),8)=$$CONVERT("D",%)
	S $P(MSH,ST(1),5)=RAP,$P(MSH,ST(1),6)=RNF,$P(MSH,ST(1),9)=MST
	S $P(MSH,ST(1),10)=PCI,$P(MSH,ST(1),11)=VID
	Q MSH
QRD(WSF,WDDC,QFC,QLR,QRL)	;QRD Messaging Line
	N QRD,Y,%,%I
	S QRD="QRD"
	D NOW^%DTC S $P(ORD,ST(1),2)=$$CONVERT("D",%)
	S $P(QRD,ST(1),3)=QFC,$P(QRD,ST(1),4)="I"
	S $P(QRD,ST(1),6)=$J,$P(QRD,ST(1),8)=QLR
	S $P(QRD,ST(1),9)=WSF,$P(QRD,ST(1),11)=WDDC,$P(QRD,ST(1),12)=QRL
	Q QRD
CONVERT(FILETYPE,RST)	;Convert FileMan to HL7
	N TEMP
	S TEMP=RST
	S:FILETYPE="D" TEMP=$$HLDATE^HLFNC(RST,"TS")
	S:FILETYPE="P" TEMP=$$HLNAME^HLFNC(RST)
	Q TEMP
CONVERTA(FILETYPE,RST)	;Convert HL7 to FileMan
	N TEMP,Y
	S TEMP=RST
	I FILETYPE["D" S Y=$$FMDATE^HLFNC(RST) X ^DD("DD") S TEMP=Y
	S:(FILETYPE["P200")!(FILETYPE["P690") TEMP=$$FMNAME^HLFNC(RST)
	Q TEMP
REMOVE(MESS1,MESS2)	;Remove messages from the server basket
	N LOOP
	F LOOP=MESS1,MESS2 S XMSER="S.MCHL7SERVER" S XMZ=LOOP D:LOOP'=0 REMSBMSG^XMA1C
	D KILL^XM
	Q
SETREF(MCOUNT,COUNT,XDES)	;
	S:XDES'="" @BASE@(MCOUNT,"B",XDES,COUNT)=""
	Q

GMTSMCPZ
GMTSMCPZ	;SLC/SBW - Medicine 2.0 HS Component ;7/Mar/95
	;;2.7;Health Summary;;Oct 20, 1995
GMTSMCPS	;WISC/RMP - Medicine 2.0 Health Summary Component ;5/10/91  08:24
	;;2.7;Health Summary;;Oct 20, 1995
	K WH,%DT,X,Y Q
BEG	;SEARCH FOR SELECTED PATIENT IN CARDIOLOGY FILE
	D KVAR^VADPT
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=50
LOC	;LOCATE PROCEDURES FROM "AC" X-REF
	I '$D(^MCAR(690,"AC",DFN)) G EXIT
	K ^TMP("MCAR",$J) S S4=GMTS1-.0001 F M=1:1:MAX S S4=$O(^MCAR(690,"AC",DFN,S4)) Q:S4=""!(S4>GMTS2)  D LOCFIL
	G PR0
LOCFIL	G LOCFIL1:$D(S5) S S5="" F K=1:1 S S5=$O(^MCAR(690,"AC",DFN,S4,S5)) Q:S5=""  D LOCFIL1
	K S5 Q
LOCFIL1	; Set S5 to the PROCEDURE LOCATION (^MCAR(697.2,Y,0))
	S S6="" F L=1:1 S S6=$O(^MCAR(690,"AC",DFN,S4,S5,S6)) Q:S6=""  D CONT
	Q
CONT	I S5[699 S (LL,LL1)=$P(^MCAR(699,S6,0),U,12),LL=$P(^MCAR(697.2,LL,0),U) G CONT1:'$D(PE) Q:PE'=LL  G CONT1
	I S5[694 S (LL,LL1)=$P(^MCAR(694,S6,0),U,3),LL=$P(^MCAR(697.2,LL,0),U) G CONT1:'$D(PE) Q:PE'=LL  G CONT1
	S (LL,LL1)=$O(^MCAR(697.2,"C",S5,0)),LL=$P(^MCAR(697.2,LL,0),U,1)
CONT1	S MCARSUM="",MCARFILE=U_S5_","_S6_",.2)" S:$D(@MCARFILE) MCARSUM=$P(@MCARFILE,U,1)
	K MCARFILE S S1=S4,S2=LL
	S ^TMP("MCAR",$J,S1,S2)=MCARSUM_U_S6_U_$P(^MCAR(697.2,LL1,0),U,5,7) K MCARSUM Q
PR0	I '$D(^TMP("MCAR",$J)) G EXIT
	S I="",L=0
PR1	S I=$O(^TMP("MCAR",$J,I)) G PR1:I="OT" I I="" G EXIT
	S J=""
PR2	S J=$O(^TMP("MCAR",$J,I,J)) G PR1:J="" S MCARDT=I,MCARPROC=J,PR=^(J)
	S DA=$P(PR,U,2),K=$P(PR,U)
	S K=$S(K="N"!(K="L"):"NORMAL",K="A":"ABNORMAL",K="B":"BORDERLINE",K="T":"TECHNICALLY UNSATISFACTORY",K="ND":"NON-DIAGNOSTIC",1:"")
	S Y=9999999.9999-MCARDT X ^DD("DD") D DFIX,CKP^GMTSUP Q:$D(GMTSQIT)  W Y,?21,MCARPROC,?61,K,!
	S ^TMP("MCAR",$J,"OT",L)=MCARPROC_U_DA_U_$P(PR,U,3,5)
	G PR2
DFIX	;
	S %DT="T",X=Y D ^%DT S X=Y D REGDTM^GMTSU S Y=X Q
EXIT	;
	K PR,OT,DA,MCARPPS,I,J,R,L,S1,S2,S4,S5,S6,LL,LL1,MAX,VA
	K ^TMP("MCAR",$J),K,N,MCARDT,MCARNM,MCARPROC,M Q

GMTSMCZZ
GMTSMCZZ	;SLC/SBW - Medicine 2.2 HS Component ;18/APRIL/95
	;;2.7;Health Summary;;Oct 20, 1995
GMTSMCPS	;WISC/DCB - Medicine 2.2 Health Summary Component ;5/10/94
	;;2.7;Health Summary;;Oct 20, 1995
BEG	;One Line summary only
	D START(0,"B") Q
BRIEF	;Brief Summary 
	D START(1,"B") Q
ABN	;Print Brief summary for only abnomaral or Null
	D START(2,"B") Q 
FULL	;Full Sunnary
	D START(1,"F") Q
CAP	;Capture
	D START(1,"C") Q
ADBF	;Print Full Summary for only abnotmal or null
	D START(2,"F") Q
START(BRIEF,MCTYPE)	;Get the record and display the record
	N TV,VV,SP
	K ^TMP("MCAR",$J)
	S RMAR=$S($D(IOM):IOM,1:IOM)
	S TV=(.25*RMAR+.5)\1
	S VV=(.70*RMAR+.5)\1
	S SP=(RMAR-(TV+VV))-1
	D KVAR^VADPT
	I '$D(^MCAR(690,"AC",DFN)) D EXIT Q
	D SEARCH
	I '$D(^TMP("MCAR",$J)) D EXIT Q
	F MCL=1:1 Q:$D(GMTSQIT)  Q:'$D(^TMP("MCAR",$J,MCL))  D GETREC(MCL,RMAR,TV,VV,SP)
	D EXIT
	Q
SEARCH	;SEARCH FOR SELECTED PATIENT
	I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	E  S MAX=50
	D HSUM^GMTSMCMA(DFN,GMTSEND,GMTSBEG,MAX,"",MCTYPE)
	Q
GETREC(MCL,RMAR,TV,VV,SP)	;Return record
	N MCDATE,MCPROC,MCSUM,MCPSUM,LOOP,LINE,BLINE
	S (LOOP,BLINE)="",$P(BLINE,"-",80)="-"
	S MCDATE=$$RETURN("DATE/TIME",MCL)
	S MCPROC=$$RETURN("PROCEDURE",MCL)
	S MCSUM=$$RETURN("SUMMARY",MCL)
	S MCPSUM=$$RETURN("PROCEDURE SUMMARY",MCL)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,MCDATE,?(TV+SP),MCPROC
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,BLINE
	D:MCSUM'="" PRINT(MCSUM,VV,"Summary:",TV,SP)
	D:MCPSUM'="" PRINT(MCPSUM,VV,"Procedure Summary:",TV,SP)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q:+$G(BRIEF)=0
	I BRIEF=2,("N"[$E(MCSUM,1)),(MCSUM'="") Q
	F  S LOOP=+$O(^TMP("MCAR",$J,MCL,LOOP)) Q:LOOP=0!$D(GMTSQIT)  D REPORT(LOOP,MCL,RMAR,BLINE,TV,VV,SP)
	Q
	I MLEN>RMAR D CKP^GMTSUP Q:$D(GMTSQIT)  W !
REPORT(LOOP,MCL,RMAR,BLINE,TV,VV,SP)	;Report on procedure
	N LINE,TEMP,HOLD,TITLE,VALUE,UNITS,MLEN,RANGE
	N TARRAY,VARRY,LARRAY,TMAX,VMAX,MAX,LOOP2
	S LINE=^TMP("MCAR",$J,MCL,LOOP,1)
	S TEMP=$P(LINE,U,1),TITLE=$P(TEMP,";",1)_":"
	S VALUE=$P(LINE,U,3,255),UNITS=$P(LINE,U,2)
	Q:(VALUE="")&(MCTYPE'="C")
	I $P(TEMP,";",2)="W" D WORD(MCL,LOOP,TITLE,RMAR,TV,VV,SP) Q
	S VALUE=VALUE_$S(UNITS="":"",1:" "_UNITS)
	D PRINT(VALUE,VV,TITLE,TV,SP)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
WARP(VALUE,LENGTH,TEMP,MAX)	;WARP A FIELD
	N DIWL,DIWR,DIWF,X,LOOP3,TEMP1 S LOOP3=""
	K ^UTILITY($J,"W")
	S DIWL=0,DIWR=LENGTH,X=VALUE D ^DIWP
	F MAX=1:1 S LOOP3=+$O(^UTILITY($J,"W",DIWL,LOOP3)) Q:LOOP3=0  D
	.S TEMP1=^UTILITY($J,"W",DIWL,LOOP3,0)
	.S:$E(TEMP1,$L(TEMP1))=" " TEMP1=$E(TEMP1,1,$L(TEMP1)-1)
	.S TEMP(LOOP3)=TEMP1
	S MAX=MAX-1
	Q
WORD(MCL,LOOP,TITLE,RMAR,TV,VV,SP)	;Display word processing
	N SLOOP,X,DIWR,DIWL,DIWF,TARRAY,TMAX,LOOP3,SPAC
	D WARP(TITLE,TV,.TARRAY,.TMAX) K ^UTILITY($J,"W") S DIWR=VV,DIWL=0
	F SLOOP=0:0 S SLOOP=+$O(^TMP("MCAR",$J,MCL,LOOP,SLOOP)) Q:SLOOP=0  D
	.S X=$P(^TMP("MCAR",$J,MCL,LOOP,SLOOP),U,3) D ^DIWP
	S SLOOP=0
	F LOOP3=1:1 S SLOOP=+$O(^UTILITY($J,"W",DIWL,SLOOP)) Q:(SLOOP=0)!($D(GMTSQIT))  D
	.D CKP^GMTSUP Q:$D(GMTSQIT)
	.W !,$J($G(TARRAY(LOOP3)),TV),?(TV+SP),^UTILITY($J,"W",DIWL,SLOOP,0)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
CONVERT(TITLE)	;Convert a word to upper/lower case  TEMP = Temp
	N UPPER,LOWER,TEMP,LOOP,HOLD,HOLD2
	S UPPER="ABCDEFGHIJKLMNOPQRSTUVWXYZ",LOWER="abcdefghijklmnopqrstuvwxyz"
	F LOOP=1:1:255 S HOLD=$P(TITLE," ",LOOP) Q:HOLD=""  D
	.S:$D(TEMP) TEMP=TEMP_" "
	.S HOLD2=$E(HOLD,2,$L(HOLD))
	.S TEMP=$G(TEMP)_$E(HOLD,1)_$TR(HOLD2,UPPER,LOWER)
	Q TEMP
PRINT(VALUE,VV,TITLE,TV,SP)	;Print a field and its value
	N VMAX,TMAX,TARRAY,VARRAY,SPAC,LOOP2
	S TITLE=$$CONVERT(TITLE)
	D WARP(VALUE,VV,.VARRAY,.VMAX)
	D WARP(TITLE,TV,.TARRAY,.TMAX)
	S MAX=$S(VMAX<TMAX:TMAX,VMAX>TMAX:VMAX,1:TMAX)
	S SPAC=TMAX-VMAX S:SPAC<0 SPAC=0
	F LOOP2=1:1:TMAX D CKP^GMTSUP Q:$D(GMTSQIT)  D
	.W !,$J($G(TARRAY(LOOP2)),TV),?(TV+SP),$G(VARRAY(LOOP2-SPAC))
	Q:$D(GMTSQIT)
	Q
RETURN(TYPE,LINE)	;Return key elements
	N MCHOLD,HOLD
	S MCHOLD=+$O(^TMP("MCAR",$J,LINE,"B",TYPE,""))
	S HOLD=$P($G(^TMP("MCAR",$J,LINE,MCHOLD,1)),U,3)
	K ^TMP("MCAR",$J,LINE,"B",TYPE,LINE)
	K ^TMP("MCAR",$J,LINE,MCHOLD,1)
	Q HOLD
EXIT	;
	K PR,OT,DA,MCARPPS,MCI,MCJ,R,MCL,S1,S2,S4,S5,S6,LL,LL1,MAX,VA
	K ^TMP("MCAR",$J),K,N,MCARDT,MCARNM,MCARPROC,M,RMAR
	Q

GMTSMHPE
GMTSMHPE	;SLC/JER - Mental Health Physical Exam Component ;21/MAR/95
	;;2.7;Health Summary;;Oct 20, 1995
	;
MAIN	; Main control
	N GMCKC,GMDATA,GMDATE,GMEND,GMFLD,GMI,GMIL,GMTIMES,GMX
	Q:'$G(DFN)
	Q:'$D(^MR(+DFN,"PE"))
	I $G(GMTS1)'?7N S GMTS1=6666666 ;Inverse Begin Date
	I $G(GMTS2)'?7N S GMTS2=9999999 ;Inverse End Date
	S:GMTSNDM=-1 GMTSNDM=9999
	S GMTIMES=0
PHYEXAM	;Check for existence of PHYSICAL EXAM data
	;GMDATE,DFN -- req  (GMDATE must be in inverse (file storage) format)
	S GMEND=GMTS2
	S GMDATE=GMTS1-.1 ;Set beg date
	F  S GMDATE=$O(^MR(+DFN,"PE",GMDATE)) Q:GMDATE']""!(GMDATE>GMEND)  D  Q:$D(GMTSQIT)!(GMTSNDM'>GMTIMES)
	. N DIC,DIQ,DA,DR
	. K ^UTILITY("DIQ1",$J)
	. S DIC="^MR(",DA=+DFN,DR=100,DIQ(0)="EN"
	. S DR(90.01)=".01:34",DA(90.01)=+GMDATE,DR(90.02)=.01,DA(90.02)=0
	. S DR(90.03)=.01,DA(90.03)=0
	. D EN^DIQ1
	. Q:'$D(^UTILITY("DIQ1",$J))
	. S GMTIMES=GMTIMES+1
	. D VSINFO(+DFN,+GMDATE) Q:$D(GMTSQIT)
	. D OMITABN
	. D SHOWOMIT Q:$D(GMTSQIT)
	. D SHOWABN Q:$D(GMTSQIT)
	. W !
	K ^UTILITY("DIQ1",$J)
	Q
	;
VSINFO(DFN,GMDATE)	; Show vital signs
	N GMI,GMTXT
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W "VITAL SIGNS DATE: ",$S($G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.01,"E"))]"":^("E"),1:"Unknown")
	W ?40,"Examiner: ",$S($G(^UTILITY("DIQ1",$J,90.01,+GMDATE,29,"E"))]"":^("E"),1:"Unknown")
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W !,"Temp: ",$S($G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.04,"E")):^("E")_"F",$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,34,"E")):^("E")_"C",1:"")
	W ?14,"Pulse: ",$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.05,"E"))
	W ?28,"Resp: ",$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.07,"E"))
	W ?42,"BP: ",$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.06,"E"))
	W ?56,"Ht: ",$S($G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.02,"E")):^("E")_"in",$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,32,"E")):^("E")_"cm",1:"")
	W ?70,"Wt: ",$S($G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.03,"E")):^("E")_"lb",$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,33,"E")):^("E")_"kg",1:""),!!
	I +$O(^MR(+DFN,"PE",+GMDATE,19,0)) D  Q:$D(GMTSQIT)  W !
	. W "Comments:",!
	. S GMI=0
	. F  S GMI=$O(^MR(+DFN,"PE",+GMDATE,19,GMI)) Q:GMI'>0  D  Q:$D(GMTSQIT)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . W ?4,$G(^MR(+DFN,"PE",+GMDATE,19,GMI,0)),!
	I +$O(^MR(+DFN,"PE",+GMDATE,20,0)) D  Q:$D(GMTSQIT)  W !
	. W "Initial Impression:",!
	. S GMI=0
	. F  S GMI=$O(^MR(+DFN,"PE",+GMDATE,20,GMI)) Q:GMI'>0  D  Q:$D(GMTSQIT)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . W ?4,$G(^MR(+DFN,"PE",+GMDATE,20,GMI,0)),!
	S GMTXT=$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,.9,"E")) Q:GMTXT']""
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "General Appearance: "
	I $L(GMTXT)>59 S GMTXT=$$WRAP^GMTSORC(GMTXT,60)
	F GMI=1:1:$L(GMTXT,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTXT,"|",GMI)]"" ?20,$P(GMTXT,"|",GMI),!
	W !
	Q
OMITABN	;Store PHYSICAL EXAM 'Omits' and 'Abnormals" in GMDATA(array)
	N GMFLD,GMX
	K GMDATA
	F GMFLD=2:1:19 D
	. S GMX=$E($G(^UTILITY("DIQ1",$J,90.01,+GMDATE,+GMFLD,"E")))
	. Q:GMX'?1U
	. I GMX="O" S GMDATA("OM",+GMFLD)=$$SYSTEM(+GMFLD)
	. I GMX="A" S GMDATA("AB",+GMFLD)=$$SYSTEM(+GMFLD)_"^"_$G(^UTILITY("DIQ1",$J,90.01,+GMDATE,+GMFLD_.9,"E"))
	Q
	;
SHOWOMIT	;
	N GMYST,GMPHY
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Omissions: "
	I '$D(GMDATA("OM")) W " None",!! Q
	S GMYST=0
	F  S GMYST=$O(GMDATA("OM",GMYST)) Q:GMYST'>0  D  Q:$D(GMTSQIT)
	. S GMPHY=GMDATA("OM",GMYST)
	. I (($L(GMPHY)+$X)>(IOM-2)) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?11
	. W GMPHY
	. W:+$O(GMDATA("OM",GMYST)) ", "
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !!
	Q
	;
SHOWABN	;
	;GMDATA( -- req
	N GMI,GMTXT,GMYST,GMPHY
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Abnormal Findings: "
	I '$D(GMDATA("AB")) W " None",!! Q
	W !
	S GMYST=0
	F  S GMYST=$O(GMDATA("AB",GMYST)) Q:GMYST'>0  D  Q:$D(GMTSQIT)
	. S GMPHY=$P(GMDATA("AB",GMYST),"^",1) Q:GMPHY']""
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMTSNPG " Abnormal Findings (cont'd):",! W ?(17-$L(GMPHY)),GMPHY,":"
	. S GMTXT=$P(GMDATA("AB",GMYST),"^",2) Q:GMTXT']""
	. I $L(GMTXT)>60 S GMTXT=$$WRAP^GMTSORC(GMTXT,60)
	. F GMI=1:1:$L(GMTXT,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTXT,"|",GMI)]"" ?19,$P(GMTXT,"|",GMI),!
	W !
	Q
	;
SYSTEM(GMHSYST)	;
	;MEDICAL RECORD file, PHY subfile, fields 2-19
	S GMHSYST=$P("^Head^Eyes^Ears^Nose^Mouth^Neck^Chest&Breasts^Lungs^Heart^Abdomen^Genitalia^Pelvic^Rectum^Back^Extremities^Neurological^Skin^Lymph",U,GMHSYST)
	Q GMHSYST

GMTSNTE0
GMTSNTE0	;ISC/XTSUMBLD KERNEL - Package checksum checker ;OCT 20, 1995@15:13:16
	;;2.7;Health Summary;;Oct 20, 1995
	;;7.2;OCT 20, 1995@15:13:16
	S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
CONT	F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
	;
	K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
ONE	S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
	W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
	W ! G CONT
ROU	;;
GMTSPDXZ	;;4192536
GMTSPL	;;6102762
GMTSPLST	;;4003268
GMTSPLSZ	;;3503422
GMTSPN	;;9532427
GMTSPN1	;;7382807
GMTSPN2	;;6481703
GMTSPNB	;;2073409
GMTSPNE	;;3130541
GMTSPNJ	;;4118293
GMTSPNS	;;3368984
GMTSPOS1	;;7203788
GMTSPOS2	;;5930086
GMTSPOST	;;14759909
GMTSPP	;;10637870
GMTSPREI	;;2805782
GMTSPSG	;;2167928
GMTSPSI	;;4674521
GMTSPSO	;;4783059
GMTSPSZO	;;5518919
GMTSPXEP	;;2755760
GMTSPXFP	;;1756378
GMTSPXHP	;;506691
GMTSPXHR	;;4148787
GMTSPXIM	;;1706374
GMTSPXM	;;1127679
GMTSPXMP	;;3249792
GMTSPXOP	;;6456010
GMTSPXSK	;;1702860
GMTSPXTP	;;2970412
GMTSPXU1	;;3092718
GMTSPXU2	;;5512565
GMTSPXXP	;;1689771
GMTSRAD	;;3215705
GMTSRAE	;;6627828
GMTSRAI	;;2397390
GMTSRAS	;;5549827
GMTSRASP	;;2974091
GMTSRI	;;883054
GMTSRM	;;8928900
GMTSRM1	;;8604086
GMTSRM1A	;;2432893
GMTSRM2	;;1249750
GMTSRM3	;;5851502
GMTSRM4	;;2033224
GMTSRM5	;;7232509
GMTSRN	;;4546519
GMTSRO	;;11940993
GMTSROB	;;2464741
GMTSSOWK	;;252357
GMTSSOWZ	;;8112766
GMTSU	;;4614432
GMTSUP	;;8491844
GMTSUP1	;;12410735
GMTSVS	;;3389199
GMTSVSS	;;3877801

GMTSNTEG
GMTSNTEG	;ISC/XTSUMBLD KERNEL - Package checksum checker ;OCT 20, 1995@15:13:16
	;;2.7;Health Summary;;Oct 20, 1995
	;;7.2;OCT 20, 1995@15:13:16
	S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
CONT	F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
	G CONT^GMTSNTE0
	K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
ONE	S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
	W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
	W ! G CONT
ROU	;;
GMTS	;;9747615
GMTS1	;;9107723
GMTS2	;;1686893
GMTSADH	;;7009924
GMTSADH1	;;9118153
GMTSADH2	;;8921291
GMTSADH3	;;4175388
GMTSADH4	;;2108172
GMTSADHC	;;7616551
GMTSADOR	;;5770178
GMTSALG	;;13299334
GMTSALGB	;;3649701
GMTSAMIE	;;2215141
GMTSCI	;;980795
GMTSCM	;;6771561
GMTSCW	;;8466205
GMTSDA	;;7935436
GMTSDCB	;;3376310
GMTSDD	;;5832737
GMTSDEM	;;8355003
GMTSDEMB	;;1645478
GMTSDGA	;;3278741
GMTSDGA1	;;7480178
GMTSDGA2	;;5406373
GMTSDGC1	;;5335387
GMTSDGC2	;;3280399
GMTSDGCH	;;6109698
GMTSDGD	;;2236947
GMTSDGH	;;2898086
GMTSDGP	;;5958742
GMTSDS	;;2014917
GMTSDSB	;;1887589
GMTSDVR	;;9357098
GMTSENV	;;527430
GMTSFH	;;6355772
GMTSI001	;;6797667
GMTSI002	;;8625906
GMTSI003	;;7915035
GMTSI004	;;7496079
GMTSI005	;;9611811
GMTSI006	;;9190966
GMTSI007	;;7703599
GMTSI008	;;4005876
GMTSI009	;;3932193
GMTSI00A	;;827350
GMTSI00B	;;8455149
GMTSI00C	;;7584757
GMTSI00D	;;8910779
GMTSI00E	;;7448609
GMTSI00F	;;2867454
GMTSI00G	;;8852473
GMTSI00H	;;8717091
GMTSI00I	;;8773516
GMTSI00J	;;9224995
GMTSI00K	;;9276724
GMTSI00L	;;8906270
GMTSI00M	;;8948291
GMTSI00N	;;8903831
GMTSI00O	;;9109697
GMTSI00P	;;8788001
GMTSI00Q	;;9144600
GMTSI00R	;;8661231
GMTSI00S	;;9040355
GMTSI00T	;;8440721
GMTSI00U	;;8849266
GMTSI00V	;;8597654
GMTSI00W	;;8347201
GMTSI00X	;;8589121
GMTSI00Y	;;2513711
GMTSI00Z	;;951613
GMTSI010	;;12236555
GMTSI011	;;10099099
GMTSI012	;;10044917
GMTSI013	;;6048930
GMTSI014	;;6222248
GMTSI015	;;6848123
GMTSI016	;;8673195
GMTSI017	;;7578064
GMTSI018	;;6048832
GMTSI019	;;5845546
GMTSI01A	;;7616684
GMTSI01B	;;7997413
GMTSI01C	;;4992646
GMTSI01D	;;899861
GMTSINI1	;;4982983
GMTSINI2	;;5232640
GMTSINI3	;;16807836
GMTSINI4	;;3357812
GMTSINI5	;;773825
GMTSINIS	;;2215261
GMTSINIT	;;10511864
GMTSLOAD	;;5796287
GMTSLRA	;;6876199
GMTSLRAE	;;11147933
GMTSLRB	;;2250319
GMTSLRBE	;;3672773
GMTSLRC	;;3788772
GMTSLRCE	;;5397241
GMTSLRCP	;;12992921
GMTSLREE	;;6175432
GMTSLREM	;;5357355
GMTSLRM	;;10576209
GMTSLRM1	;;5092747
GMTSLRMB	;;8141523
GMTSLRME	;;7612887
GMTSLRMX	;;7993355
GMTSLROB	;;1646167
GMTSLROE	;;6516628
GMTSLROS	;;2358998
GMTSLRPE	;;6517490
GMTSLRS	;;4721162
GMTSLRS7	;;7478778
GMTSLRSC	;;7505823
GMTSLRSE	;;3321038
GMTSLRT	;;2843052
GMTSLRTE	;;1320704
GMTSLTR	;;2903951
GMTSLTR2	;;3282162
GMTSMCMA	;;7527516
GMTSMCPZ	;;3705188
GMTSMCZZ	;;5276229
GMTSMHPE	;;8497501
GMTSO001	;;8057336
GMTSO002	;;6065150
GMTSO003	;;7512952
GMTSO004	;;7684644
GMTSO005	;;7812945
GMTSO006	;;7948804
GMTSO007	;;7635764
GMTSO008	;;7443333
GMTSO009	;;7739191
GMTSO010	;;7582026
GMTSO011	;;8030504
GMTSO012	;;8409618
GMTSO013	;;7775470
GMTSO014	;;7954689
GMTSO015	;;7423432
GMTSO016	;;7911113
GMTSO017	;;7145833
GMTSO018	;;7647663
GMTSO019	;;7562703
GMTSO020	;;7805175
GMTSO021	;;7281432
GMTSO022	;;7825234
GMTSO023	;;7784074
GMTSO024	;;725714
GMTSONI1	;;1703362
GMTSONI2	;;82866
GMTSONI3	;;10576628
GMTSONIT	;;935085
GMTSORC	;;4886475
GMTSPCD	;;3405698
GMTSPD	;;5306590
GMTSPD2	;;1434592
GMTSPDX	;;6721830

GMTSO001
GMTSO001	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1382,0)
	;;=GMTS COMP DESC LIST^List Health Summary Component Descriptions^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1382,1,0)
	;;=^^2^2^2910301^
	;;^UTILITY(U,$J,"PRO",1382,1,1,0)
	;;=Lists all components which may be used to define Health Summary Types, along
	;;^UTILITY(U,$J,"PRO",1382,1,2,0)
	;;=with the abbreviation and a brief description of each.  
	;;^UTILITY(U,$J,"PRO",1382,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1382,2,1,0)
	;;=HS COMP DESC LIST
	;;^UTILITY(U,$J,"PRO",1382,2,"B","HS COMP DESC LIST",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1382,3,0)
	;;=^101.03PA^0^0
	;;^UTILITY(U,$J,"PRO",1382,20)
	;;=W ! S DIC="^GMT(142.1,",L=0,FLDS="[GMTS COMP DESC LIST]",BY=.01,FR="A",TO="zzzz" D EN1^DIP S DIR(0)="E" D ^DIR
	;;^UTILITY(U,$J,"PRO",1382,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1383,0)
	;;=GMTS HS BY PATIENT^Patient Health Summary^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1383,1,0)
	;;=^^2^2^2910301^
	;;^UTILITY(U,$J,"PRO",1383,1,1,0)
	;;=Generates a Health Summary of a specified pre-defined Health Summary Type for
	;;^UTILITY(U,$J,"PRO",1383,1,2,0)
	;;=a specified patient.  
	;;^UTILITY(U,$J,"PRO",1383,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1383,2,1,0)
	;;=HS PRINT BY PATIENT
	;;^UTILITY(U,$J,"PRO",1383,2,"B","HS PRINT BY PATIENT",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1383,3,0)
	;;=^101.03PA^0^0
	;;^UTILITY(U,$J,"PRO",1383,15)
	;;=
	;;^UTILITY(U,$J,"PRO",1383,20)
	;;=W ! S DIC("B")=$P($G(^GMT(142,+$G(^DISV(+$G(DUZ),"^GMT(142,")),0)),U),GMTSTYP=0 S:'$D(DFN) DFN=$S($D(ORVP):$P(ORVP,";"),1:"") D SELPT^GMTS:+DFN'>0,SELTYP^GMTS Q:GMTSTYP'>0  D HSOUT^GMTS
	;;^UTILITY(U,$J,"PRO",1383,26)
	;;=
	;;^UTILITY(U,$J,"PRO",1383,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",1384,0)
	;;=GMTS HS ADHOC^Health Summary Ad Hoc^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1384,1,0)
	;;=^^5^5^2930825^^^
	;;^UTILITY(U,$J,"PRO",1384,1,1,0)
	;;=Generates an 'Ad Hoc' Health Summary for specified patients.  Instead of 
	;;^UTILITY(U,$J,"PRO",1384,1,2,0)
	;;=selecting a pre-defined Health Summary Type, the user defines his own ad hoc
	;;^UTILITY(U,$J,"PRO",1384,1,3,0)
	;;=Health Summary structure for temporary use while using this option.  The user
	;;^UTILITY(U,$J,"PRO",1384,1,4,0)
	;;=selects Health Summary components, time and occurrence limits when
	;;^UTILITY(U,$J,"PRO",1384,1,5,0)
	;;=applicable, and selection items when applicable.  
	;;^UTILITY(U,$J,"PRO",1384,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1384,2,1,0)
	;;=HS AD HOC
	;;^UTILITY(U,$J,"PRO",1384,2,"B","HS AD HOC",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1384,3,0)
	;;=^101.03PA^88^1
	;;^UTILITY(U,$J,"PRO",1384,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1384,20)
	;;=W ! D MAIN^GMTSADOR
	;;^UTILITY(U,$J,"PRO",1384,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",1384,"MEN","OR OE/RR MENU CLINICIAN")
	;;=1384^HS
	;;^UTILITY(U,$J,"PRO",1384,"MEN","OR OE/RR MENU NURSE")
	;;=1384
	;;^UTILITY(U,$J,"PRO",1384,"MEN","OR OE/RR MENU WARD CLERK")
	;;=1384
	;;^UTILITY(U,$J,"PRO",1385,0)
	;;=GMTS HS BY LOC^Hospital Location Health Summary^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1385,1,0)
	;;=^^3^3^2910301^
	;;^UTILITY(U,$J,"PRO",1385,1,1,0)
	;;=Allows user to print health summaries interactively for all patients on a
	;;^UTILITY(U,$J,"PRO",1385,1,2,0)
	;;=specified ward or for all patients with appointments at a specified 
	;;^UTILITY(U,$J,"PRO",1385,1,3,0)
	;;=outpatient clinic on a selected day.  
	;;^UTILITY(U,$J,"PRO",1385,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1385,2,2,0)
	;;=HS PRINT BY LOCATION
	;;^UTILITY(U,$J,"PRO",1385,2,"B","HS PRINT BY LOCATION",2)
	;;=

GMTSO002
GMTSO002	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1385,3,0)
	;;=^101.03PA^0^0
	;;^UTILITY(U,$J,"PRO",1385,20)
	;;=D MAIN^GMTSPD
	;;^UTILITY(U,$J,"PRO",1385,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",1386,0)
	;;=GMTS USER^Health Summary User Menu^^M^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1386,1,0)
	;;=^^8^8^2910301^
	;;^UTILITY(U,$J,"PRO",1386,1,1,0)
	;;=This menu allows the user to print Health Summaries by Patient or Hospital 
	;;^UTILITY(U,$J,"PRO",1386,1,2,0)
	;;=Location with a pre-defined Health Summary Type, or print Health Summaries 
	;;^UTILITY(U,$J,"PRO",1386,1,3,0)
	;;=for patients, based on ad hoc Health Summary definitions.  The user may also
	;;^UTILITY(U,$J,"PRO",1386,1,4,0)
	;;=use the Information Menu to list and inquire about Health Summary Types and
	;;^UTILITY(U,$J,"PRO",1386,1,5,0)
	;;=Health Summary Components.  
	;;^UTILITY(U,$J,"PRO",1386,1,6,0)
	;;=   
	;;^UTILITY(U,$J,"PRO",1386,1,7,0)
	;;=This menu does not contain the options which allow the user to create or 
	;;^UTILITY(U,$J,"PRO",1386,1,8,0)
	;;=delete his/her own Health Summary Types.  
	;;^UTILITY(U,$J,"PRO",1386,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1386,2,2,0)
	;;=HS USER MENU
	;;^UTILITY(U,$J,"PRO",1386,2,"B","HS USER MENU",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1386,3,0)
	;;=^101.03PA^56434,65466^1
	;;^UTILITY(U,$J,"PRO",1386,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1386,4)
	;;=^^Y
	;;^UTILITY(U,$J,"PRO",1386,10,0)
	;;=^101.01PA^4^4
	;;^UTILITY(U,$J,"PRO",1386,10,1,0)
	;;=1384^2^2
	;;^UTILITY(U,$J,"PRO",1386,10,1,"^")
	;;=GMTS HS ADHOC
	;;^UTILITY(U,$J,"PRO",1386,10,2,0)
	;;=1385^3^3
	;;^UTILITY(U,$J,"PRO",1386,10,2,"^")
	;;=GMTS HS BY LOC
	;;^UTILITY(U,$J,"PRO",1386,10,3,0)
	;;=1383^1^1
	;;^UTILITY(U,$J,"PRO",1386,10,3,"^")
	;;=GMTS HS BY PATIENT
	;;^UTILITY(U,$J,"PRO",1386,10,4,0)
	;;=1387^4^4
	;;^UTILITY(U,$J,"PRO",1386,10,4,"^")
	;;=GMTS INFO ONLY MENU
	;;^UTILITY(U,$J,"PRO",1386,26)
	;;=S ORUIEN=XQORNOD D OE^ORUHDR K ORUIEN
	;;^UTILITY(U,$J,"PRO",1386,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1387,0)
	;;=GMTS INFO ONLY MENU^Health Summary Information Menu^^M^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1387,1,0)
	;;=^^2^2^2910301^
	;;^UTILITY(U,$J,"PRO",1387,1,1,0)
	;;=This menu contains options which provide information only about Health
	;;^UTILITY(U,$J,"PRO",1387,1,2,0)
	;;=Summary Types and Health Summary Components.  
	;;^UTILITY(U,$J,"PRO",1387,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1387,2,2,0)
	;;=HS INFO MENU
	;;^UTILITY(U,$J,"PRO",1387,2,"B","HS INFO MENU",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1387,3,0)
	;;=^101.03PA^88^1
	;;^UTILITY(U,$J,"PRO",1387,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1387,4)
	;;=^^Y
	;;^UTILITY(U,$J,"PRO",1387,10,0)
	;;=^101.01PA^5^5
	;;^UTILITY(U,$J,"PRO",1387,10,1,0)
	;;=1382^5^5
	;;^UTILITY(U,$J,"PRO",1387,10,1,"^")
	;;=GMTS COMP DESC LIST
	;;^UTILITY(U,$J,"PRO",1387,10,2,0)
	;;=1388^3^3
	;;^UTILITY(U,$J,"PRO",1387,10,2,"^")
	;;=GMTS COMP INQ
	;;^UTILITY(U,$J,"PRO",1387,10,3,0)
	;;=1429^4^4
	;;^UTILITY(U,$J,"PRO",1387,10,3,"^")
	;;=GMTS COMP LIST
	;;^UTILITY(U,$J,"PRO",1387,10,4,0)
	;;=1389^1^1
	;;^UTILITY(U,$J,"PRO",1387,10,4,"^")
	;;=GMTS TYPE INQUIRE
	;;^UTILITY(U,$J,"PRO",1387,10,5,0)
	;;=1430^2^2
	;;^UTILITY(U,$J,"PRO",1387,10,5,"^")
	;;=GMTS TYPE LIST
	;;^UTILITY(U,$J,"PRO",1387,26)
	;;=S ORUIEN=XQORNOD D OE^ORUHDR K ORUIEN
	;;^UTILITY(U,$J,"PRO",1387,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1388,0)
	;;=GMTS COMP INQ^Inquire about a Health Summary Component^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1388,1,0)
	;;=^^2^2^2910301^
	;;^UTILITY(U,$J,"PRO",1388,1,1,0)
	;;=This allows the user to display the characteristics of a Health Summary 

GMTSO003
GMTSO003	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1388,1,2,0)
	;;=Component.  
	;;^UTILITY(U,$J,"PRO",1388,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1388,2,2,0)
	;;=HS COMPONENT INQUIRE
	;;^UTILITY(U,$J,"PRO",1388,2,"B","HS COMPONENT INQUIRE",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1388,3,0)
	;;=^101.03PA^0^0
	;;^UTILITY(U,$J,"PRO",1388,20)
	;;=W ! D ^GMTSCI S DIR(0)="E" D ^DIR
	;;^UTILITY(U,$J,"PRO",1388,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1389,0)
	;;=GMTS TYPE INQUIRE^Inquire about a Health Summary Type^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1389,20)
	;;=W ! D ^GMTSRI W ! S DIR(0)="E" D ^DIR
	;;^UTILITY(U,$J,"PRO",1389,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1390,0)
	;;=GMTS BLO^Health Summary Brief Lab Orders^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1390,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1390,1,1,0)
	;;=This component contains information extracted from the Lab package.  Time and
	;;^UTILITY(U,$J,"PRO",1390,1,2,0)
	;;=maximum occurrence limits apply.Data presented include: collection date/time,
	;;^UTILITY(U,$J,"PRO",1390,1,3,0)
	;;=lab test name, specimen, urgency, and order status (e.g., ORDERED, COLLECTED,
	;;^UTILITY(U,$J,"PRO",1390,1,4,0)
	;;=PROCESSING, COMPLETE).  
	;;^UTILITY(U,$J,"PRO",1390,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1390,2,1,0)
	;;=HS LAB ORDERS BRIEF
	;;^UTILITY(U,$J,"PRO",1390,2,"B","HS LAB ORDERS BRIEF",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1390,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1390,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1390,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BLO",GMTSTITL="BRIEF LAB ORDERS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1390,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1391,0)
	;;=GMTS ADR^Health Summary Adverse Reactions/Allergies^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1391,1,0)
	;;=^^3^3^2950513^^
	;;^UTILITY(U,$J,"PRO",1391,1,1,0)
	;;=This component contains information from MAS, Pharmacy, and Dietetics 
	;;^UTILITY(U,$J,"PRO",1391,1,2,0)
	;;=packages.  It provides a list of all known food, drug and environmental 
	;;^UTILITY(U,$J,"PRO",1391,1,3,0)
	;;=allergies or adverse reactions (e.g., hay fever).  
	;;^UTILITY(U,$J,"PRO",1391,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1391,2,2,0)
	;;=HS ADVERSE REACTIONS/ALLERGIES
	;;^UTILITY(U,$J,"PRO",1391,2,3,0)
	;;=ADR
	;;^UTILITY(U,$J,"PRO",1391,2,"B","ADR",3)
	;;=
	;;^UTILITY(U,$J,"PRO",1391,2,"B","HS ADVERSE REACTIONS/ALLERGIES",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1391,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1391,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1391,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="ADR",GMTSTITL="ADVERSE REACTIONS/ALLERGIES" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1391,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1392,0)
	;;=GMTS CW^Health Summary Clinical Warnings^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1392,1,0)
	;;=^^11^11^2910301^^
	;;^UTILITY(U,$J,"PRO",1392,1,1,0)
	;;=This component contains clinical warning notes entered using the Generic 
	;;^UTILITY(U,$J,"PRO",1392,1,2,0)
	;;=Progress Note package.  No time or maximum occurrence limits apply to this 
	;;^UTILITY(U,$J,"PRO",1392,1,3,0)
	;;=component.  
	;;^UTILITY(U,$J,"PRO",1392,1,4,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1392,1,5,0)
	;;=Clinical Warnings are a type of progress note which includes clinical 
	;;^UTILITY(U,$J,"PRO",1392,1,6,0)
	;;=information which clinicians need to be alerted to.  
	;;^UTILITY(U,$J,"PRO",1392,1,7,0)
	;;=   
	;;^UTILITY(U,$J,"PRO",1392,1,8,0)
	;;=If this component is printed out on a CRT, information will include title, 
	;;^UTILITY(U,$J,"PRO",1392,1,9,0)
	;;=text of note, electronic signature block, and date posted.  If the printout 

GMTSO004
GMTSO004	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1392,1,10,0)
	;;=is to another device type, information will include electronic signature 
	;;^UTILITY(U,$J,"PRO",1392,1,11,0)
	;;=block and date posted to ensure security of information.  
	;;^UTILITY(U,$J,"PRO",1392,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1392,2,1,0)
	;;=HS CLINICAL WARNINGS
	;;^UTILITY(U,$J,"PRO",1392,2,2,0)
	;;=CW
	;;^UTILITY(U,$J,"PRO",1392,2,"B","CW",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1392,2,"B","HS CLINICAL WARNINGS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1392,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1392,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1392,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CW",GMTSTITL="CLINICAL WARNINGS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1392,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1393,0)
	;;=GMTS CN^Health Summary Crisis Notes^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1393,1,0)
	;;=^^10^10^2910301^
	;;^UTILITY(U,$J,"PRO",1393,1,1,0)
	;;=This component contains crisis notes entered using the Generic Progress Note
	;;^UTILITY(U,$J,"PRO",1393,1,2,0)
	;;=package.  No time or maximum occurrence limits apply to this component.  
	;;^UTILITY(U,$J,"PRO",1393,1,3,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1393,1,4,0)
	;;=Crisis Notes are a type of progress note which contains important information
	;;^UTILITY(U,$J,"PRO",1393,1,5,0)
	;;=for anyone who deals with a patient.  
	;;^UTILITY(U,$J,"PRO",1393,1,6,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1393,1,7,0)
	;;=If this component is printed out on a CRT, information will include title, 
	;;^UTILITY(U,$J,"PRO",1393,1,8,0)
	;;=text of note, electronic signature block, and date posted.  If the printout 
	;;^UTILITY(U,$J,"PRO",1393,1,9,0)
	;;=is to another device type, information will include electronic signature 
	;;^UTILITY(U,$J,"PRO",1393,1,10,0)
	;;=block and date posted to ensure security of information.  
	;;^UTILITY(U,$J,"PRO",1393,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1393,2,1,0)
	;;=HS CRISIS NOTES
	;;^UTILITY(U,$J,"PRO",1393,2,2,0)
	;;=CN
	;;^UTILITY(U,$J,"PRO",1393,2,"B","CN",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1393,2,"B","HS CRISIS NOTES",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1393,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1393,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1393,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CN",GMTSTITL="CRISIS NOTES" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1393,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1394,0)
	;;=GMTS DIET^Health Summary Dietetics^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1394,1,0)
	;;=^^8^8^2910301^
	;;^UTILITY(U,$J,"PRO",1394,1,1,0)
	;;=This component contains information from the Dietetics package.  Time and
	;;^UTILITY(U,$J,"PRO",1394,1,2,0)
	;;=occurrence limits apply to this component.  Data presented include: diet
	;;^UTILITY(U,$J,"PRO",1394,1,3,0)
	;;=orders, start/stop dates, type of service (tray, e.g.); nutritional status,
	;;^UTILITY(U,$J,"PRO",1394,1,4,0)
	;;=date assessed; supplemental feedings, start/stop dates; tube feedings,
	;;^UTILITY(U,$J,"PRO",1394,1,5,0)
	;;=start/stop dates, strength of product, quantity ordered, and daily dosages.  
	;;^UTILITY(U,$J,"PRO",1394,1,6,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1394,1,7,0)
	;;=Note:  When a time limit is selected, the data presented reflects orders 
	;;^UTILITY(U,$J,"PRO",1394,1,8,0)
	;;=initiated within the time period.  
	;;^UTILITY(U,$J,"PRO",1394,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1394,2,1,0)
	;;=HS DIETETICS
	;;^UTILITY(U,$J,"PRO",1394,2,2,0)
	;;=DI
	;;^UTILITY(U,$J,"PRO",1394,2,"B","DI",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1394,2,"B","HS DIETETICS",1)
	;;=

GMTSO005
GMTSO005	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1394,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1394,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1394,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="DI",GMTSTITL="DIETETICS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1394,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",1396,0)
	;;=GMTS BT^Health Summary Blood Transfusions^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1396,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1396,1,1,0)
	;;=This component contains information from the Blood Bank module of the Lab
	;;^UTILITY(U,$J,"PRO",1396,1,2,0)
	;;=Package.  Time and occurrence limits apply to this component.  Data presented
	;;^UTILITY(U,$J,"PRO",1396,1,3,0)
	;;=include:  transfusion date and abbreviated blood products (with total number
	;;^UTILITY(U,$J,"PRO",1396,1,4,0)
	;;=of units transfused for each, e.g., RBC (2)).  
	;;^UTILITY(U,$J,"PRO",1396,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1396,2,2,0)
	;;=HS LAB BLOOD TRANSFUSIONS
	;;^UTILITY(U,$J,"PRO",1396,2,3,0)
	;;=BT
	;;^UTILITY(U,$J,"PRO",1396,2,"B","BT",3)
	;;=
	;;^UTILITY(U,$J,"PRO",1396,2,"B","HS LAB BLOOD TRANSFUSIONS",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1396,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1396,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1396,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BT",GMTSTITL="BLOOD TRANSFUSIONS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1396,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1397,0)
	;;=GMTS CH^Health Summary Chemistry & Hematology^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1397,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1397,1,1,0)
	;;=This component contains information extracted from the Lab package.  Time and
	;;^UTILITY(U,$J,"PRO",1397,1,2,0)
	;;=maximum occurrence limits apply to this component. Data presented include: 
	;;^UTILITY(U,$J,"PRO",1397,1,3,0)
	;;=collection date/time, specimen, test name, results (w/ref flag: 
	;;^UTILITY(U,$J,"PRO",1397,1,4,0)
	;;=High/Low/Critical), units, and Reference range.  
	;;^UTILITY(U,$J,"PRO",1397,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1397,2,2,0)
	;;=HS LAB CHEMISTRY & HEMATOLOGY
	;;^UTILITY(U,$J,"PRO",1397,2,3,0)
	;;=CH
	;;^UTILITY(U,$J,"PRO",1397,2,"B","CH",3)
	;;=
	;;^UTILITY(U,$J,"PRO",1397,2,"B","HS LAB CHEMISTRY & HEMATOLOGY",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1397,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1397,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1397,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CH",GMTSTITL="CHEMISTRY & HEMATOLOGY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1397,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1398,0)
	;;=GMTS CY^Health Summary Cytopathology^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1398,1,0)
	;;=^^5^5^2910301^
	;;^UTILITY(U,$J,"PRO",1398,1,1,0)
	;;=This component contains information extracted from the Cytopathology module
	;;^UTILITY(U,$J,"PRO",1398,1,2,0)
	;;=of the Lab package. Time and maximum occurrence limits apply.  Data presented
	;;^UTILITY(U,$J,"PRO",1398,1,3,0)
	;;=include:  collection date/time, accession number, specimen, gross description
	;;^UTILITY(U,$J,"PRO",1398,1,4,0)
	;;=and microscopic exam (both word processing fields), ICD diagnoses, and SNOMED
	;;^UTILITY(U,$J,"PRO",1398,1,5,0)
	;;=fields: topography, disease, morphology, etiology, and procedures.  
	;;^UTILITY(U,$J,"PRO",1398,2,0)
	;;=^101.02A^3^1
	;;^UTILITY(U,$J,"PRO",1398,2,3,0)
	;;=HS LAB CYTOPATHOLOGY
	;;^UTILITY(U,$J,"PRO",1398,2,"B","HS LAB CYTOPATHOLOGY",3)
	;;=
	;;^UTILITY(U,$J,"PRO",1398,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1398,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1398,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CY",GMTSTITL="CYTOPATHOLOGY" D ENCWA^GMTS

GMTSO006
GMTSO006	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1398,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1399,0)
	;;=GMTS MIC^Health Summary Microbiology^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1399,1,0)
	;;=^^5^5^2910301^
	;;^UTILITY(U,$J,"PRO",1399,1,1,0)
	;;=This component contains information extracted from the Microbiology module of
	;;^UTILITY(U,$J,"PRO",1399,1,2,0)
	;;=the Lab Package.  Time and maximum occurrence limits apply. Data include: 
	;;^UTILITY(U,$J,"PRO",1399,1,3,0)
	;;=collection date/time, site/specimen, Parasite Report, organism(s), Mycology
	;;^UTILITY(U,$J,"PRO",1399,1,4,0)
	;;=Report, Bacteriology Report, Mycobacteriology Report, Gram Stain Result, and
	;;^UTILITY(U,$J,"PRO",1399,1,5,0)
	;;=remarks.  
	;;^UTILITY(U,$J,"PRO",1399,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1399,2,2,0)
	;;=HS LAB MICROBIOLOGY
	;;^UTILITY(U,$J,"PRO",1399,2,"B","HS LAB MICROBIOLOGY",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1399,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1399,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1399,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="MIC",GMTSTITL="MICROBIOLOGY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1399,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1400,0)
	;;=GMTS BMIC^Health Summary Brief Microbiology^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1400,1,0)
	;;=^^3^3^2910301^
	;;^UTILITY(U,$J,"PRO",1400,1,1,0)
	;;=This component contains information extracted from the Lab package.  Time and
	;;^UTILITY(U,$J,"PRO",1400,1,2,0)
	;;=maximum occurrence limits apply to this component in addition to collection
	;;^UTILITY(U,$J,"PRO",1400,1,3,0)
	;;=date/time, test name, specimen, report status, and test results.  
	;;^UTILITY(U,$J,"PRO",1400,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1400,2,2,0)
	;;=HS LAB MICROBIOLOGY BRIEF
	;;^UTILITY(U,$J,"PRO",1400,2,"B","HS LAB MICROBIOLOGY BRIEF",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1400,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1400,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1400,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BMIC",GMTSTITL="BRIEF MICROBIOLOGY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1400,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1401,0)
	;;=GMTS LO^Health Summary Lab Orders^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1401,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1401,1,1,0)
	;;=This component contains information extracted from the Lab package.  Time and
	;;^UTILITY(U,$J,"PRO",1401,1,2,0)
	;;=maximum occurrence limits apply. Data presented include: collection date
	;;^UTILITY(U,$J,"PRO",1401,1,3,0)
	;;=(either actual or expected), lab test, provider, accession, date/time
	;;^UTILITY(U,$J,"PRO",1401,1,4,0)
	;;=ordered, specimen, and date/time results available.  
	;;^UTILITY(U,$J,"PRO",1401,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1401,2,1,0)
	;;=HS LAB ORDERS
	;;^UTILITY(U,$J,"PRO",1401,2,"B","HS LAB ORDERS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1401,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1401,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1401,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="LO",GMTSTITL="LAB ORDERS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1401,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",1402,0)
	;;=GMTS SP^Health Summary Surgical Pathology^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1402,1,0)
	;;=^^6^6^2910301^
	;;^UTILITY(U,$J,"PRO",1402,1,1,0)
	;;=This component contains information extracted from the Surical Pathology 
	;;^UTILITY(U,$J,"PRO",1402,1,2,0)
	;;=module of the Lab package. Time and maximum occurrence limits apply.  Data
	;;^UTILITY(U,$J,"PRO",1402,1,3,0)
	;;=presented include:  collection date/time, accession number, specimen, gross

GMTSO007
GMTSO007	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1402,1,4,0)
	;;=description and microscopic exam (both word processing fields), ICD
	;;^UTILITY(U,$J,"PRO",1402,1,5,0)
	;;=diagnoses, and SNOMED fields: topography, disease, morphology, etiology, and
	;;^UTILITY(U,$J,"PRO",1402,1,6,0)
	;;=procedures.  
	;;^UTILITY(U,$J,"PRO",1402,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1402,2,2,0)
	;;=HS LAB SURGICAL PATHOLOGY
	;;^UTILITY(U,$J,"PRO",1402,2,"B","HS LAB SURGICAL PATHOLOGY",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1402,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1402,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1402,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="SP",GMTSTITL="SURGICAL PATHOLOGY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1402,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1403,0)
	;;=GMTS ADC^Health Summary Admissions/Discharges^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1403,1,0)
	;;=^^5^5^2910301^
	;;^UTILITY(U,$J,"PRO",1403,1,1,0)
	;;=This component contains information from the MAS package.  Time and 
	;;^UTILITY(U,$J,"PRO",1403,1,2,0)
	;;=occurrence limits apply to this component.  Data presented include: date
	;;^UTILITY(U,$J,"PRO",1403,1,3,0)
	;;=range of admission, ward, length of stay (LOS), last treating specialty, last
	;;^UTILITY(U,$J,"PRO",1403,1,4,0)
	;;=provider, admitting diagnosis text, bedsection, principal diagnosis,
	;;^UTILITY(U,$J,"PRO",1403,1,5,0)
	;;=diagnosis for longest length of stay (DXLS), and seconary ICD diagnoses.  
	;;^UTILITY(U,$J,"PRO",1403,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1403,2,2,0)
	;;=HS MAS ADMISSIONS/DISCHARGES
	;;^UTILITY(U,$J,"PRO",1403,2,"B","HS MAS ADMISSIONS/DISCHARGES",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1403,3,0)
	;;=^101.03P^GMTS EM^1
	;;^UTILITY(U,$J,"PRO",1403,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1403,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="ADC",GMTSTITL="ADMISSIONS/DISCHARGES" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1403,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1404,0)
	;;=GMTS ADT^Health Summary ADT History^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1404,1,0)
	;;=^^6^6^2910301^
	;;^UTILITY(U,$J,"PRO",1404,1,1,0)
	;;=This component contains information extracted from the MAS package.  It can
	;;^UTILITY(U,$J,"PRO",1404,1,2,0)
	;;=only be used with MAS Version 5 and up.  
	;;^UTILITY(U,$J,"PRO",1404,1,3,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1404,1,4,0)
	;;=Time and maximum occurrence limits apply.  Data presented include: movement
	;;^UTILITY(U,$J,"PRO",1404,1,5,0)
	;;=date, movement type (ADM=Admission, TR=Transfer, TS= Treating Specialty,
	;;^UTILITY(U,$J,"PRO",1404,1,6,0)
	;;=DC=Discharge), movement description, specialty, and provider.  
	;;^UTILITY(U,$J,"PRO",1404,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1404,2,2,0)
	;;=HS MAS ADT HISTORY
	;;^UTILITY(U,$J,"PRO",1404,2,"B","HS MAS ADT HISTORY",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1404,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1404,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1404,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="ADT",GMTSTITL="ADT HISTORY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1404,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1405,0)
	;;=GMTS CVF^Health Summary Clinic Visits Future^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1405,1,0)
	;;=^^3^3^2910301^
	;;^UTILITY(U,$J,"PRO",1405,1,1,0)
	;;=This component provides a listing from the MAS scheduling module that 
	;;^UTILITY(U,$J,"PRO",1405,1,2,0)
	;;=contains future clinic visit dates, the clinic visited, and the appointment
	;;^UTILITY(U,$J,"PRO",1405,1,3,0)
	;;=type.  
	;;^UTILITY(U,$J,"PRO",1405,2,0)
	;;=^101.02A^2^1

GMTSO008
GMTSO008	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1405,2,2,0)
	;;=HS MAS CLINIC VISITS FUTURE
	;;^UTILITY(U,$J,"PRO",1405,2,"B","HS MAS CLINIC VISITS FUTURE",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1405,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1405,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1405,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CVF",GMTSTITL="CLINIC VISITS FUTURE" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1405,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1406,0)
	;;=GMTS CVP^Health Summary Clinic Visits Past^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1406,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1406,1,1,0)
	;;=This component contains information from the MAS scheduling module.  Time and
	;;^UTILITY(U,$J,"PRO",1406,1,2,0)
	;;=occurrence limits apply to this component.  Data presented include:  past
	;;^UTILITY(U,$J,"PRO",1406,1,3,0)
	;;=clinic visits, dates, and a visit status (e.g., NO SHOW, INPATIENT VISIT). 
	;;^UTILITY(U,$J,"PRO",1406,1,4,0)
	;;=Note: Cancellations are not shown.  
	;;^UTILITY(U,$J,"PRO",1406,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1406,2,2,0)
	;;=HS MAS CLINIC VISITS PAST
	;;^UTILITY(U,$J,"PRO",1406,2,"B","HS MAS CLINIC VISITS PAST",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1406,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1406,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1406,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CVP",GMTSTITL="CLINIC VISITS PAST" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1406,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1407,0)
	;;=GMTS DEM^Health Summary Demographics^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1407,1,0)
	;;=^^6^6^2910301^
	;;^UTILITY(U,$J,"PRO",1407,1,1,0)
	;;=This component contains the following patient demographic data (if available)
	;;^UTILITY(U,$J,"PRO",1407,1,2,0)
	;;=from the MAS package: address, phone, county, marital status, religion,
	;;^UTILITY(U,$J,"PRO",1407,1,3,0)
	;;=period of service, POW status (e.g., Y or N), branch of service, combat
	;;^UTILITY(U,$J,"PRO",1407,1,4,0)
	;;=status (e.g., Y or N), eligibility code, current (verified) eligibility
	;;^UTILITY(U,$J,"PRO",1407,1,5,0)
	;;=status, service connected %, eligible for care (e.g., Y or N), next of kin
	;;^UTILITY(U,$J,"PRO",1407,1,6,0)
	;;=(NOK), NOK phone number and address.  
	;;^UTILITY(U,$J,"PRO",1407,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1407,2,2,0)
	;;=HS MAS DEMOGRAPHICS
	;;^UTILITY(U,$J,"PRO",1407,2,"B","HS MAS DEMOGRAPHICS",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1407,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1407,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1407,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="DEM",GMTSTITL="DEMOGRAPHICS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1407,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1408,0)
	;;=GMTS BDEM^Health Summary Brief Demographics^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1408,1,0)
	;;=^^3^3^2910301^
	;;^UTILITY(U,$J,"PRO",1408,1,1,0)
	;;=This component contains information from the MAS package.  It provides brief
	;;^UTILITY(U,$J,"PRO",1408,1,2,0)
	;;=patient demographic information including:  address, phone number, and
	;;^UTILITY(U,$J,"PRO",1408,1,3,0)
	;;=eligibility code (e.g., service connected 50-100%).  
	;;^UTILITY(U,$J,"PRO",1408,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1408,2,2,0)
	;;=HS MAS DEMOGRAPHICS BRIEF
	;;^UTILITY(U,$J,"PRO",1408,2,"B","HS MAS DEMOGRAPHICS BRIEF",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1408,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1408,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1408,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BDEM",GMTSTITL="BRIEF DEMOGRAPHICS" D ENCWA^GMTS

GMTSO009
GMTSO009	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1408,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1409,0)
	;;=GMTS DS^Health Summary Disabilities^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1409,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1409,1,1,0)
	;;=This component provides information from the MAS package about a patient's 
	;;^UTILITY(U,$J,"PRO",1409,1,2,0)
	;;=eligibility code and eligibility status (Verified), and rated disabilities, 
	;;^UTILITY(U,$J,"PRO",1409,1,3,0)
	;;=including the disability percentage and whether the disability is service 
	;;^UTILITY(U,$J,"PRO",1409,1,4,0)
	;;=connected or non-service connected.  
	;;^UTILITY(U,$J,"PRO",1409,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1409,2,2,0)
	;;=HS MAS DISABILITIES
	;;^UTILITY(U,$J,"PRO",1409,2,"B","HS MAS DISABILITIES",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1409,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1409,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1409,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="DS",GMTSTITL="DISABILITIES" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1409,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",1410,0)
	;;=GMTS DD^Health Summary Discharge Diagnosis^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1410,1,0)
	;;=^^8^8^2910301^
	;;^UTILITY(U,$J,"PRO",1410,1,1,0)
	;;=This component contains information extracted from the MAS package.  Time and
	;;^UTILITY(U,$J,"PRO",1410,1,2,0)
	;;=occurrence limits apply to this component.  Data presented include: Date
	;;^UTILITY(U,$J,"PRO",1410,1,3,0)
	;;=range of admission through discharge, length of stay (LOS), Principal 
	;;^UTILITY(U,$J,"PRO",1410,1,4,0)
	;;=diagnosis, diagnosis for longest length of stay (DXLS), and secondary ICD
	;;^UTILITY(U,$J,"PRO",1410,1,5,0)
	;;=discharge diagnoses.  
	;;^UTILITY(U,$J,"PRO",1410,1,6,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1410,1,7,0)
	;;=Note: This component provides discharge diagnoses coded in the MAS PTF file.  
	;;^UTILITY(U,$J,"PRO",1410,1,8,0)
	;;=The occurrence limits are determined by the occurrence of admissions.  
	;;^UTILITY(U,$J,"PRO",1410,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1410,2,2,0)
	;;=HS MAS DISCHARGE DIAGNOSIS
	;;^UTILITY(U,$J,"PRO",1410,2,"B","HS MAS DISCHARGE DIAGNOSIS",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1410,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1410,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1410,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="DD",GMTSTITL="DISCHARGE DIAGNOSIS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1410,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1411,0)
	;;=GMTS DC^Health Summary Discharges^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1411,1,0)
	;;=^^6^6^2910301^
	;;^UTILITY(U,$J,"PRO",1411,1,1,0)
	;;=This component contains information extracted from the MAS package. Time and
	;;^UTILITY(U,$J,"PRO",1411,1,2,0)
	;;=occurrence limits apply to this component.  Data presented include:  date of
	;;^UTILITY(U,$J,"PRO",1411,1,3,0)
	;;=discharge, DXLS, bedsection, disposition type, disposition disposition place,
	;;^UTILITY(U,$J,"PRO",1411,1,4,0)
	;;=and outpatient treatment flag.  
	;;^UTILITY(U,$J,"PRO",1411,1,5,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",1411,1,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.  
	;;^UTILITY(U,$J,"PRO",1411,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1411,2,2,0)
	;;=HS MAS DISCHARGES
	;;^UTILITY(U,$J,"PRO",1411,2,"B","HS MAS DISCHARGES",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1411,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1411,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1411,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="DC",GMTSTITL="DISCHARGES" D ENCWA^GMTS

GMTSO010
GMTSO010	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1411,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1412,0)
	;;=GMTS PRC^Health Summary Procedures (ICD codes)^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1412,1,0)
	;;=^^6^6^2910301^
	;;^UTILITY(U,$J,"PRO",1412,1,1,0)
	;;=This component contains MAS coded procedures, by admission, extracted from 
	;;^UTILITY(U,$J,"PRO",1412,1,2,0)
	;;=the MAS package.  Time and occurrence limits apply to this component.  Data 
	;;^UTILITY(U,$J,"PRO",1412,1,3,0)
	;;=presented include:  procedure date, procedure name, and ICD-9CM procedure 
	;;^UTILITY(U,$J,"PRO",1412,1,4,0)
	;;=codes.  
	;;^UTILITY(U,$J,"PRO",1412,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1412,1,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.  
	;;^UTILITY(U,$J,"PRO",1412,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1412,2,2,0)
	;;=HS MAS PROCEDURES ICD CODES
	;;^UTILITY(U,$J,"PRO",1412,2,"B","HS MAS PROCEDURES ICD CODES",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1412,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1412,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1412,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="PRC",GMTSTITL="PROCEDURES" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1412,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1413,0)
	;;=GMTS OPC^Health Summary Surgeries (ICD codes)^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1413,1,0)
	;;=^^6^6^2910301^
	;;^UTILITY(U,$J,"PRO",1413,1,1,0)
	;;=This component contains MAS coded surgeries, by admission, extracted from the
	;;^UTILITY(U,$J,"PRO",1413,1,2,0)
	;;=MAS package.  Time and occurrence limits apply to this component.  Data
	;;^UTILITY(U,$J,"PRO",1413,1,3,0)
	;;=presented include:  surgery date, procedure name, and ICD-9CM procedure 
	;;^UTILITY(U,$J,"PRO",1413,1,4,0)
	;;=codes.  
	;;^UTILITY(U,$J,"PRO",1413,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1413,1,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.  
	;;^UTILITY(U,$J,"PRO",1413,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1413,2,2,0)
	;;=HS MAS SURGERIES ICD CODES
	;;^UTILITY(U,$J,"PRO",1413,2,"B","HS MAS SURGERIES ICD CODES",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1413,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1413,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1413,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="OPC",GMTSTITL="MAS SURGERY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1413,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1414,0)
	;;=GMTS TR^Health Summary Transfers^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1414,1,0)
	;;=^^5^5^2910301^
	;;^UTILITY(U,$J,"PRO",1414,1,1,0)
	;;=This component contains information extracted from the MAS package.  Time and
	;;^UTILITY(U,$J,"PRO",1414,1,2,0)
	;;=occurrence limits apply to this component.  Data presented include:  transfer
	;;^UTILITY(U,$J,"PRO",1414,1,3,0)
	;;=date, type, destination, and provider (when available).  
	;;^UTILITY(U,$J,"PRO",1414,1,4,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1414,1,5,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.  
	;;^UTILITY(U,$J,"PRO",1414,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1414,2,2,0)
	;;=HS MAS TRANSFERS
	;;^UTILITY(U,$J,"PRO",1414,2,"B","HS MAS TRANSFERS",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1414,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1414,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1414,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="TR",GMTSTITL="TRANSFERS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1414,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1415,0)
	;;=GMTS TS^Health Summary Treating Speciality^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1415,1,0)
	;;=^^6^6^2910301^

GMTSO011
GMTSO011	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1415,1,1,0)
	;;=This component contains information extracted from the MAS package.  Time and
	;;^UTILITY(U,$J,"PRO",1415,1,2,0)
	;;=occurrence limits apply to this component.  Data presented include:  treating
	;;^UTILITY(U,$J,"PRO",1415,1,3,0)
	;;=specialty change date/time, new treating specialty, (admission date), and
	;;^UTILITY(U,$J,"PRO",1415,1,4,0)
	;;=provider.  
	;;^UTILITY(U,$J,"PRO",1415,1,5,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",1415,1,6,0)
	;;=Note: The occurrence limits are determined by the occurrence of admissions.  
	;;^UTILITY(U,$J,"PRO",1415,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1415,2,2,0)
	;;=HS MAS TREATING SPECIALTY
	;;^UTILITY(U,$J,"PRO",1415,2,"B","HS MAS TREATING SPECIALTY",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1415,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1415,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1415,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="TS",GMTSTITL="TREATING SPECIALITY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1415,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1416,0)
	;;=GMTS MED^Health Summary Medicine^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1416,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1416,1,1,0)
	;;=This component contains information extracted from the Medicine package.  
	;;^UTILITY(U,$J,"PRO",1416,1,2,0)
	;;=Time and maximum occurrence limits apply.  Data presented include: procedure
	;;^UTILITY(U,$J,"PRO",1416,1,3,0)
	;;=date/time, medical procedure name, and result (e.g., normal, abnormal,
	;;^UTILITY(U,$J,"PRO",1416,1,4,0)
	;;=borderline).  Note: This component is a summary of procedure statuses.  
	;;^UTILITY(U,$J,"PRO",1416,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1416,2,1,0)
	;;=HS MEDICINE
	;;^UTILITY(U,$J,"PRO",1416,2,"B","HS MEDICINE",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1416,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1416,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1416,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="MEDS",GMTSTITL="MEDICINE SUMMARY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1416,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",1417,0)
	;;=GMTS ORC^Health Summary Orders Current^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1417,1,0)
	;;=^^11^11^2910301^
	;;^UTILITY(U,$J,"PRO",1417,1,1,0)
	;;=This component contains current orders from the OE/RR package.  Since the  
	;;^UTILITY(U,$J,"PRO",1417,1,2,0)
	;;=OE/RR package integrates all orders for the ancillary services, the orders 
	;;^UTILITY(U,$J,"PRO",1417,1,3,0)
	;;=will be reported in most recent orders first sequence without concern for the
	;;^UTILITY(U,$J,"PRO",1417,1,4,0)
	;;=ancillary package the order originated from/for. Current orders are defined
	;;^UTILITY(U,$J,"PRO",1417,1,5,0)
	;;=as those orders with an OE/RR order status other than discontinued or
	;;^UTILITY(U,$J,"PRO",1417,1,6,0)
	;;=expired.  
	;;^UTILITY(U,$J,"PRO",1417,1,7,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1417,1,8,0)
	;;=The component information includes item ordered, OE/RR order status, start
	;;^UTILITY(U,$J,"PRO",1417,1,9,0)
	;;=date, and stop date. OE/RR order status abbreviations include "blank"=Active,
	;;^UTILITY(U,$J,"PRO",1417,1,10,0)
	;;="c"=Complete, "dc"=Discontinued, "e"= expired, "?"=Flagged, "h"=Hold,
	;;^UTILITY(U,$J,"PRO",1417,1,11,0)
	;;="i"=incomplete, "p"=pending, "s"=scheduled.  
	;;^UTILITY(U,$J,"PRO",1417,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1417,2,1,0)
	;;=HS ORDERS CURRENT
	;;^UTILITY(U,$J,"PRO",1417,2,"B","HS ORDERS CURRENT",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1417,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1417,3,1,0)
	;;=ORWARD

GMTSO012
GMTSO012	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1417,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="ORC",GMTSTITL="ORDERS CURRENT" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1417,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1418,0)
	;;=GMTS RXIV^Health Summary Intravenous Pharmacy^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1418,1,0)
	;;=^^7^7^2910301^
	;;^UTILITY(U,$J,"PRO",1418,1,1,0)
	;;=This component contains IV orders extracted from the Pharmacy package.  Only
	;;^UTILITY(U,$J,"PRO",1418,1,2,0)
	;;=time limits apply.  Data presented include:  start date, stop date, drug
	;;^UTILITY(U,$J,"PRO",1418,1,3,0)
	;;=(additives), dose, status, solutions and infusion rates.  
	;;^UTILITY(U,$J,"PRO",1418,1,4,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",1418,1,5,0)
	;;=Note: If no time limit is defined, only active IV orders are reported.  If a
	;;^UTILITY(U,$J,"PRO",1418,1,6,0)
	;;=time limit is defined, all IV orders which have an expiration or cancel date
	;;^UTILITY(U,$J,"PRO",1418,1,7,0)
	;;=within the time limit range are reported.  
	;;^UTILITY(U,$J,"PRO",1418,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1418,2,2,0)
	;;=HS PHARMACY INTRAVENOUS
	;;^UTILITY(U,$J,"PRO",1418,2,"B","HS PHARMACY INTRAVENOUS",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1418,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1418,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1418,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="RXIV",GMTSTITL="INTRAVENOUS PHARMACY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1418,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1419,0)
	;;=GMTS RXOP^Health Summary Outpatient Pharmacy^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1419,1,0)
	;;=^^9^9^2910301^
	;;^UTILITY(U,$J,"PRO",1419,1,1,0)
	;;=This component contains information from the Outpatient Pharmacy package.  
	;;^UTILITY(U,$J,"PRO",1419,1,2,0)
	;;=Only time limits apply.  Data presented include:  drug, prescription number, 
	;;^UTILITY(U,$J,"PRO",1419,1,3,0)
	;;=status expiration/cancellation date (when appropriate), quantity, issue date,
	;;^UTILITY(U,$J,"PRO",1419,1,4,0)
	;;=last fill date, refills remaining, provider, and cost/fill (when available).  
	;;^UTILITY(U,$J,"PRO",1419,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1419,1,6,0)
	;;=Note: This component is formatted similar to the Short Medication Profile.  
	;;^UTILITY(U,$J,"PRO",1419,1,7,0)
	;;=If no time limit is defined, all orders are reported.  When a time limit is
	;;^UTILITY(U,$J,"PRO",1419,1,8,0)
	;;=defined, all outpatient pharmacy orders which have an expiration or cancel
	;;^UTILITY(U,$J,"PRO",1419,1,9,0)
	;;=date within the time limit range are reported.  
	;;^UTILITY(U,$J,"PRO",1419,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1419,2,2,0)
	;;=HS PHARMACY OUTPATIENT
	;;^UTILITY(U,$J,"PRO",1419,2,"B","HS PHARMACY OUTPATIENT",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1419,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1419,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1419,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="RXOP",GMTSTITL="OUTPATIENT PHARMACY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1419,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1420,0)
	;;=GMTS RXUD^Health Summary Unit Dose Pharmacy^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1420,1,0)
	;;=^^8^8^2910301^
	;;^UTILITY(U,$J,"PRO",1420,1,1,0)
	;;=This component contains Unit Dose information extracted from the Pharmacy 
	;;^UTILITY(U,$J,"PRO",1420,1,2,0)
	;;=package.  Only time limits apply.  Data presented include:  Drug, dose, 
	;;^UTILITY(U,$J,"PRO",1420,1,3,0)
	;;=pharmacy status, start date, stop date, and sig (which includes schedule 
	;;^UTILITY(U,$J,"PRO",1420,1,4,0)
	;;=instructions and route).  

GMTSO013
GMTSO013	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1420,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1420,1,6,0)
	;;=NOTE: If no time limit is defined, all active orders are reported.  If a time
	;;^UTILITY(U,$J,"PRO",1420,1,7,0)
	;;=limit is defined, all unit dose orders which have an expiration or cancel
	;;^UTILITY(U,$J,"PRO",1420,1,8,0)
	;;=date within the time limit range are reported.  
	;;^UTILITY(U,$J,"PRO",1420,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1420,2,2,0)
	;;=HS PHARMACY UNIT DOSE
	;;^UTILITY(U,$J,"PRO",1420,2,"B","HS PHARMACY UNIT DOSE",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1420,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1420,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1420,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="RXUD",GMTSTITL="UNIT DOSE PHARMACY" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1420,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1421,0)
	;;=GMTS PN^Health Summary Progress Notes^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1421,1,0)
	;;=^^8^8^2910301^
	;;^UTILITY(U,$J,"PRO",1421,1,1,0)
	;;=This component contains progress notes from the Generic Progress Notes 
	;;^UTILITY(U,$J,"PRO",1421,1,2,0)
	;;=Package AND progress notes from the Mental Health Package.  Time and maximum
	;;^UTILITY(U,$J,"PRO",1421,1,3,0)
	;;=occurrence limits apply to this component.  Data presented include: Progress
	;;^UTILITY(U,$J,"PRO",1421,1,4,0)
	;;=note date/time, title, text of note, electronic signature block, and the
	;;^UTILITY(U,$J,"PRO",1421,1,5,0)
	;;=note's correction text and correction date/time.  
	;;^UTILITY(U,$J,"PRO",1421,1,6,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1421,1,7,0)
	;;=Only those notes which have been signed with an electronic signature will be
	;;^UTILITY(U,$J,"PRO",1421,1,8,0)
	;;=reported.  
	;;^UTILITY(U,$J,"PRO",1421,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1421,2,1,0)
	;;=HS PROGRESS NOTES
	;;^UTILITY(U,$J,"PRO",1421,2,"B","HS PROGRESS NOTES",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1421,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1421,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1421,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="PN",GMTSTITL="PROGRESS NOTES" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1421,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1422,0)
	;;=GMTS BPN^Health Summary Brief Progress Notes^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1422,1,0)
	;;=^^7^7^2910301^
	;;^UTILITY(U,$J,"PRO",1422,1,1,0)
	;;=This component contains information from the Mental Health and Generic 
	;;^UTILITY(U,$J,"PRO",1422,1,2,0)
	;;=Progress Notes packages. Time and maximum occurrence limits apply.  Data 
	;;^UTILITY(U,$J,"PRO",1422,1,3,0)
	;;=presented include:  Progress note date/time, title, author and last 
	;;^UTILITY(U,$J,"PRO",1422,1,4,0)
	;;=correction date/time.  
	;;^UTILITY(U,$J,"PRO",1422,1,5,0)
	;;=  
	;;^UTILITY(U,$J,"PRO",1422,1,6,0)
	;;=Only those notes which have been signed with an electronic signature will be
	;;^UTILITY(U,$J,"PRO",1422,1,7,0)
	;;=listed.  
	;;^UTILITY(U,$J,"PRO",1422,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1422,2,1,0)
	;;=HS PROGRESS NOTES BRIEF
	;;^UTILITY(U,$J,"PRO",1422,2,"B","HS PROGRESS NOTES BRIEF",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1422,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1422,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1422,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BPN",GMTSTITL="BRIEF PROGRESS NOTES" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1422,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1423,0)
	;;=GMTS RI^Health Summary Radiology Impression^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1423,1,0)
	;;=^^5^5^2910301^
	;;^UTILITY(U,$J,"PRO",1423,1,1,0)
	;;=This component contains impressions from the Radiology package.  Time and 

GMTSO014
GMTSO014	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1423,1,2,0)
	;;=maximum occurrence limits apply.  Data presented include:  study date, 
	;;^UTILITY(U,$J,"PRO",1423,1,3,0)
	;;=procedure(s), status, and radiologist's impression (narrative).  
	;;^UTILITY(U,$J,"PRO",1423,1,4,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",1423,1,5,0)
	;;=Only radiology impressions which have been verified are reported.  
	;;^UTILITY(U,$J,"PRO",1423,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1423,2,1,0)
	;;=HS RADIOLOGY IMPRESSION
	;;^UTILITY(U,$J,"PRO",1423,2,"B","HS RADIOLOGY IMPRESSION",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1423,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1423,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1423,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="RI",GMTSTITL="RADIOLOGY IMPRESSION" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1423,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1424,0)
	;;=GMTS RP^Health Summary Radiology Profile^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1424,1,0)
	;;=^^7^7^2910301^
	;;^UTILITY(U,$J,"PRO",1424,1,1,0)
	;;=This component contains information from the Radiology package.  Time and
	;;^UTILITY(U,$J,"PRO",1424,1,2,0)
	;;=maximum occurrence limits apply.  Data presented include:  study date, 
	;;^UTILITY(U,$J,"PRO",1424,1,3,0)
	;;=procedure(s) with status(es), report status, staff radiologist, resident 
	;;^UTILITY(U,$J,"PRO",1424,1,4,0)
	;;=radiologist, and the narrative fields modifier, history, report, and 
	;;^UTILITY(U,$J,"PRO",1424,1,5,0)
	;;=impression.  
	;;^UTILITY(U,$J,"PRO",1424,1,6,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",1424,1,7,0)
	;;=Only radiology profiles which have been verified are reported.  
	;;^UTILITY(U,$J,"PRO",1424,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1424,2,1,0)
	;;=HS RADIOLOGY PROFILE
	;;^UTILITY(U,$J,"PRO",1424,2,"B","HS RADIOLOGY PROFILE",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1424,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1424,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1424,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="RP",GMTSTITL="RADIOLOGY PROFILE" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1424,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1425,0)
	;;=GMTS RS^Health Summary Radiology Status^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1425,1,0)
	;;=^^3^3^2910301^
	;;^UTILITY(U,$J,"PRO",1425,1,1,0)
	;;=This component contains procedure statuses from the Radiology package.  Time 
	;;^UTILITY(U,$J,"PRO",1425,1,2,0)
	;;=and maximum occurrence limits apply. Data presented include:  request date/ 
	;;^UTILITY(U,$J,"PRO",1425,1,3,0)
	;;=time, status, procedure, scheduled date/time, and provider name.  
	;;^UTILITY(U,$J,"PRO",1425,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1425,2,1,0)
	;;=HS RADIOLOGY STATUS
	;;^UTILITY(U,$J,"PRO",1425,2,"B","HS RADIOLOGY STATUS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1425,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1425,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1425,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="RS",GMTSTITL="RADIOLOGY STATUS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1425,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1426,0)
	;;=GMTS SR^Health Summary Surgery Reports^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1426,1,0)
	;;=^^7^7^2910301^
	;;^UTILITY(U,$J,"PRO",1426,1,1,0)
	;;=This component contains information from the Surgery package.  Time and 
	;;^UTILITY(U,$J,"PRO",1426,1,2,0)
	;;=maximum occurrence limits apply.  Data presented include:  surgery date, 
	;;^UTILITY(U,$J,"PRO",1426,1,3,0)
	;;=surgeon, surgery report status, pre-operative diagnosis, post-operative 
	;;^UTILITY(U,$J,"PRO",1426,1,4,0)
	;;=diagnosis, surgeon's dictation, current procedural terminology operation code

GMTSO015
GMTSO015	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",1426,1,5,0)
	;;=and text.  
	;;^UTILITY(U,$J,"PRO",1426,1,6,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",1426,1,7,0)
	;;=Only surgery reports which have been verified are reported.  
	;;^UTILITY(U,$J,"PRO",1426,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1426,2,1,0)
	;;=HS SURGERY REPORTS
	;;^UTILITY(U,$J,"PRO",1426,2,"B","HS SURGERY REPORTS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1426,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1426,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1426,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="SR",GMTSTITL="SURGERY REPORTS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1426,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1427,0)
	;;=GMTS BSR^Health Summary Brief Surgery Reports^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1427,1,0)
	;;=^^3^3^2910301^
	;;^UTILITY(U,$J,"PRO",1427,1,1,0)
	;;=This component contains surgery report statuses extracted from the Surgery 
	;;^UTILITY(U,$J,"PRO",1427,1,2,0)
	;;=package.  Time and maximum occurrence limits apply.  Data presented include: 
	;;^UTILITY(U,$J,"PRO",1427,1,3,0)
	;;=surgery date, surgical procedure, and report status (e.g., COMPLETE).  
	;;^UTILITY(U,$J,"PRO",1427,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1427,2,1,0)
	;;=HS SURGERY REPORTS BRIEF
	;;^UTILITY(U,$J,"PRO",1427,2,"B","HS SURGERY REPORTS BRIEF",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1427,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1427,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1427,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BSR",GMTSTITL="BRIEF SURGERY REPORTS"
	;;^UTILITY(U,$J,"PRO",1427,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1428,0)
	;;=GMTS VS^Health Summary Vitals^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1428,1,0)
	;;=^^4^4^2910301^
	;;^UTILITY(U,$J,"PRO",1428,1,1,0)
	;;=This component contains vital measurements extracted from the Vital Signs 
	;;^UTILITY(U,$J,"PRO",1428,1,2,0)
	;;=module of the Nursing package.  Time and maximum occurrence limits apply.  
	;;^UTILITY(U,$J,"PRO",1428,1,3,0)
	;;=Data presented include:  measurement date/time, blood pressure (as SBP/DBP), 
	;;^UTILITY(U,$J,"PRO",1428,1,4,0)
	;;=pulse, temperature, height, weight, and respiratory rate.  
	;;^UTILITY(U,$J,"PRO",1428,2,0)
	;;=^101.02A^2^1
	;;^UTILITY(U,$J,"PRO",1428,2,2,0)
	;;=HS VITAL SIGNS
	;;^UTILITY(U,$J,"PRO",1428,2,"B","HS VITAL SIGNS",2)
	;;=
	;;^UTILITY(U,$J,"PRO",1428,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",1428,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",1428,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="VS",GMTSTITL="VITAL SIGNS" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",1428,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",1429,0)
	;;=GMTS COMP LIST^List Health Summary Components^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1429,1,0)
	;;=^^2^2^2910301^
	;;^UTILITY(U,$J,"PRO",1429,1,1,0)
	;;=Lists all components which may be used to define Health Summary Types, along
	;;^UTILITY(U,$J,"PRO",1429,1,2,0)
	;;=with several component characteristics.
	;;^UTILITY(U,$J,"PRO",1429,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",1429,2,1,0)
	;;=HS COMP LIST
	;;^UTILITY(U,$J,"PRO",1429,2,"B","HS COMP LIST",1)
	;;=
	;;^UTILITY(U,$J,"PRO",1429,20)
	;;=W ! S DIC="^GMT(142.1,",L=0,FLDS="[GMTS COMP LIST]",BY=.01,FR="A",TO="zzzz" D EN1^DIP S DIR(0)="E" D ^DIR
	;;^UTILITY(U,$J,"PRO",1429,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",1430,0)
	;;=GMTS TYPE LIST^List Health Summary Types^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",1430,20)
	;;=W ! S DIC="^GMT(142,",L=0,FLDS="[GMTS TYPE LIST]",BY=.01,FR="A",TO="zzzz" D EN1^DIP W ! S DIR(0)="E" D ^DIR
	;;^UTILITY(U,$J,"PRO",1430,99)
	;;=56434,65466

GMTSO016
GMTSO016	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3712,0)
	;;=GMTS CP^Health Summary Comp. & Pen. Exams^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3712,1,0)
	;;=^^2^2^2950706^^^^
	;;^UTILITY(U,$J,"PRO",3712,1,1,0)
	;;=This component prints all compensation and pension exams for a given
	;;^UTILITY(U,$J,"PRO",3712,1,2,0)
	;;=patient by user-specified time and occurrence limits.
	;;^UTILITY(U,$J,"PRO",3712,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3712,2,1,0)
	;;=HS COMPENSATION AND PENSION EXAMS
	;;^UTILITY(U,$J,"PRO",3712,2,"B","HS COMPENSATION AND PENSION EX",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3712,3,0)
	;;=^101.03P^HS COMP LIST^1
	;;^UTILITY(U,$J,"PRO",3712,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3712,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CP",GMTSTITL="Comp. & Pen. Exams" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3712,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",3713,0)
	;;=GMTS DCS^Health Summary Discharge Summary^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3713,1,0)
	;;=^^2^2^2950706^
	;;^UTILITY(U,$J,"PRO",3713,1,1,0)
	;;=This component prints all discharge summaries (including report text) for
	;;^UTILITY(U,$J,"PRO",3713,1,2,0)
	;;=user-specified time and occurrence limits.
	;;^UTILITY(U,$J,"PRO",3713,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3713,2,1,0)
	;;=HS DISCHARGE SUMMARY
	;;^UTILITY(U,$J,"PRO",3713,2,"B","HS DISCHARGE SUMMARY",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3713,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3713,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3713,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="DCS",GMTSTITL="Discharge Summary" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3713,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",3714,0)
	;;=GMTS BDS^Health Summary Brief Disch Summary^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3714,1,0)
	;;=^^3^3^2950706^
	;;^UTILITY(U,$J,"PRO",3714,1,1,0)
	;;=This component prints the admission, discharge and cosignature dates, as
	;;^UTILITY(U,$J,"PRO",3714,1,2,0)
	;;=the dictating and approving provider names, and signature status of
	;;^UTILITY(U,$J,"PRO",3714,1,3,0)
	;;=all discharge summaries for user-specified time and occurrence limits.
	;;^UTILITY(U,$J,"PRO",3714,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3714,2,1,0)
	;;=HS DISCHARGE SUMMARY BRIEF
	;;^UTILITY(U,$J,"PRO",3714,2,"B","HS DISCHARGE SUMMARY BRIEF",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3714,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3714,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3714,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BDS",GMTSTITL="Brief Disch Summary" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3714,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",3715,0)
	;;=GMTS EADT^Health Summary ADT History Expanded^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3715,1,0)
	;;=^^14^14^2950706^^^^
	;;^UTILITY(U,$J,"PRO",3715,1,1,0)
	;;=This component contains information extracted from the MAS package. It is
	;;^UTILITY(U,$J,"PRO",3715,1,2,0)
	;;=a consolidated view of all the MAS components. It can only be used with
	;;^UTILITY(U,$J,"PRO",3715,1,3,0)
	;;=MAS Version 5 and up.
	;;^UTILITY(U,$J,"PRO",3715,1,4,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",3715,1,5,0)
	;;=Time and maximum occurrence limits apply.  Data presented include patient
	;;^UTILITY(U,$J,"PRO",3715,1,6,0)
	;;=eligibility and rated disabilities. Movement data then follows with
	;;^UTILITY(U,$J,"PRO",3715,1,7,0)
	;;=movement date, movement type (ADM=Admission, TR=Transfer, TS= Treating
	;;^UTILITY(U,$J,"PRO",3715,1,8,0)
	;;=Specialty, DC=Discharge), movement description, specialty, and provider.
	;;^UTILITY(U,$J,"PRO",3715,1,9,0)
	;;=Admissions include the admission diagnosis if the patient hasn't been

GMTSO017
GMTSO017	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3715,1,10,0)
	;;=discharged. Transfers included ward location and transfer facility.
	;;^UTILITY(U,$J,"PRO",3715,1,11,0)
	;;=Treating specialties includes Specialty Tranfers Diagnosis. Dicharges
	;;^UTILITY(U,$J,"PRO",3715,1,12,0)
	;;=include the data in the Discharge Diagnosis and Discharges components.
	;;^UTILITY(U,$J,"PRO",3715,1,13,0)
	;;=Following the data for each admission ICD Procedures, and ICD Surgeries
	;;^UTILITY(U,$J,"PRO",3715,1,14,0)
	;;=will be include if present.
	;;^UTILITY(U,$J,"PRO",3715,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3715,2,1,0)
	;;=HS MAS ADT HISTORY EXPANDED
	;;^UTILITY(U,$J,"PRO",3715,2,"B","HS MAS ADT HISTORY EXPANDED",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3715,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3715,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3715,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="EADT",GMTSTITL="ADT History Expanded" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3715,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",3716,0)
	;;=GMTS MEDA^Health Summary Med Abnormal^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3716,1,0)
	;;=4^^4^4^2950706^^^^
	;;^UTILITY(U,$J,"PRO",3716,1,1,0)
	;;=This component contains information extracted from the Medicine
	;;^UTILITY(U,$J,"PRO",3716,1,2,0)
	;;=package.  Data presented include:  procedure date/time, medical
	;;^UTILITY(U,$J,"PRO",3716,1,3,0)
	;;=procedure name, and result (e.g., normal, abnormal, borderline).  
	;;^UTILITY(U,$J,"PRO",3716,1,4,0)
	;;=Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,"PRO",3716,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3716,2,1,0)
	;;=HS MEDICINE ABNORMAL BRIEF
	;;^UTILITY(U,$J,"PRO",3716,2,"B","HS MEDICINE ABNORMAL BRIEF",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3716,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3716,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3716,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="MEDA",GMTSTITL="Med Abnormal" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3716,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",3717,0)
	;;=GMTS MEDB^Health Summary Med Brief Report^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3717,1,0)
	;;=^^3^3^2950706^^^
	;;^UTILITY(U,$J,"PRO",3717,1,1,0)
	;;=This is the brief procedure view defined by the Medicine View file.
	;;^UTILITY(U,$J,"PRO",3717,1,2,0)
	;;=This output can be managed by the local IRM staff.
	;;^UTILITY(U,$J,"PRO",3717,1,3,0)
	;;=Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,"PRO",3717,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3717,2,1,0)
	;;=HS MEDICINE BRIEF REPORT
	;;^UTILITY(U,$J,"PRO",3717,2,"B","HS MEDICINE BRIEF REPORT",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3717,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3717,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3717,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="MEDB",GMTSTITL="Med Brief Report" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3717,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",3718,0)
	;;=GMTS MEDC^Health Summary Med Full Captioned^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3718,1,0)
	;;=^^4^4^2950706^^^^
	;;^UTILITY(U,$J,"PRO",3718,1,1,0)
	;;=This prints the full set of results which are present in
	;;^UTILITY(U,$J,"PRO",3718,1,2,0)
	;;=each procedure.  No labels will be included which have no
	;;^UTILITY(U,$J,"PRO",3718,1,3,0)
	;;=values associated with them.
	;;^UTILITY(U,$J,"PRO",3718,1,4,0)
	;;=Time and maximum occurrence limits apply.
	;;^UTILITY(U,$J,"PRO",3718,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3718,2,1,0)
	;;=HS MEDICINE FULL CAPTIONED
	;;^UTILITY(U,$J,"PRO",3718,2,"B","HS MEDICINE FULL CAPTIONED",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3718,3,0)
	;;=^101.03P^88^1

GMTSO018
GMTSO018	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3718,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3718,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="MEDC",GMTSTITL="Med Full Captioned" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3718,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",3719,0)
	;;=GMTS MEDF^Health Summary Med Full Report^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3719,1,0)
	;;=^^4^4^2950706^^^
	;;^UTILITY(U,$J,"PRO",3719,1,1,0)
	;;=This component provides a full report of procedures as defined by the
	;;^UTILITY(U,$J,"PRO",3719,1,2,0)
	;;=Medicine View file.  This report includes labels which have no value
	;;^UTILITY(U,$J,"PRO",3719,1,3,0)
	;;=associated with them.
	;;^UTILITY(U,$J,"PRO",3719,1,4,0)
	;;=Time and maximum occurence limits apply.
	;;^UTILITY(U,$J,"PRO",3719,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3719,2,1,0)
	;;=HS MEDICINE FULL REPORT
	;;^UTILITY(U,$J,"PRO",3719,2,"B","HS MEDICINE FULL REPORT",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3719,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3719,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3719,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="MEDF",GMTSTITL="Med Full Report" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3719,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",3720,0)
	;;=GMTS PLL^Health Summary All Problems^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3720,1,0)
	;;=^^2^2^2950706^
	;;^UTILITY(U,$J,"PRO",3720,1,1,0)
	;;=This component lists all known problems, both active and inactive,
	;;^UTILITY(U,$J,"PRO",3720,1,2,0)
	;;=for a patient.
	;;^UTILITY(U,$J,"PRO",3720,1,3,0)
	;;=based upon ICD Text Display parameter, provider narrative unless Provider
	;;^UTILITY(U,$J,"PRO",3720,1,4,0)
	;;=Narrative Display parameter set to NO, date of onset if problem is active,
	;;^UTILITY(U,$J,"PRO",3720,1,5,0)
	;;=date problem resolved if inactive, date last modified, the responsible
	;;^UTILITY(U,$J,"PRO",3720,1,6,0)
	;;=provider, and all active comments for the problem.
	;;^UTILITY(U,$J,"PRO",3720,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3720,2,1,0)
	;;=HS PROBLEM LIST ALL
	;;^UTILITY(U,$J,"PRO",3720,2,"B","HS PROBLEM LIST ALL",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3720,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3720,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3720,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="PLL",GMTSTITL="All Problems" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3720,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",3721,0)
	;;=GMTS PLA^Health Summary Active Problems^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3721,1,0)
	;;=^^1^1^2950706^
	;;^UTILITY(U,$J,"PRO",3721,1,1,0)
	;;=This component lists all known active problems for a patient.
	;;^UTILITY(U,$J,"PRO",3721,1,2,0)
	;;=display ICD data based up ICD Text Display parameter, provider narrative
	;;^UTILITY(U,$J,"PRO",3721,1,3,0)
	;;=unless Provider Narrative Display parameter set to NO, date of onset if
	;;^UTILITY(U,$J,"PRO",3721,1,4,0)
	;;=problem is active, date problem resolved if inactive, date last modified,
	;;^UTILITY(U,$J,"PRO",3721,1,5,0)
	;;=the responsible provider, and all active comments for the problem.
	;;^UTILITY(U,$J,"PRO",3721,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3721,2,1,0)
	;;=HS PROBLEM LIST ACTIVE
	;;^UTILITY(U,$J,"PRO",3721,2,"B","HS PROBLEM LIST ACTIVE",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3721,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3721,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3721,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="PLA",GMTSTITL="Active Problems" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3721,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",3722,0)
	;;=GMTS PLI^Health Summary Inactive Problems^^A^^^^^^^^HEALTH SUMMARY

GMTSO019
GMTSO019	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3722,1,0)
	;;=^^1^1^2950706^
	;;^UTILITY(U,$J,"PRO",3722,1,1,0)
	;;=This component lists all known inactive problems for a patient.
	;;^UTILITY(U,$J,"PRO",3722,1,2,0)
	;;=display ICD data based upon ICD Text Display parameter, provider narrative
	;;^UTILITY(U,$J,"PRO",3722,1,3,0)
	;;=unless Provider Narrative Display parameter set to NO, date of onset if
	;;^UTILITY(U,$J,"PRO",3722,1,4,0)
	;;=problem is active, date problem resolved if inactive, date last modified,
	;;^UTILITY(U,$J,"PRO",3722,1,5,0)
	;;=the responsible provider, and all active comments for the problem.
	;;^UTILITY(U,$J,"PRO",3722,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3722,2,1,0)
	;;=HS PROBLEM LIST INACTIVE
	;;^UTILITY(U,$J,"PRO",3722,2,"B","HS PROBLEM LIST INACTIVE",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3722,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3722,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3722,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="PLI",GMTSTITL="Inactive Problems" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3722,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",3723,0)
	;;=GMTS MHPE^Health Summary MH Physical Exam^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3723,1,0)
	;;=^^4^4^2950706^^^^
	;;^UTILITY(U,$J,"PRO",3723,1,1,0)
	;;=The Mental Health Physical Exam component contains the results of the
	;;^UTILITY(U,$J,"PRO",3723,1,2,0)
	;;=physical examintation concerning patient's overall condition 
	;;^UTILITY(U,$J,"PRO",3723,1,3,0)
	;;=associated with the systems identified. This data is being extracted
	;;^UTILITY(U,$J,"PRO",3723,1,4,0)
	;;=from the Medical Record (# 90) file.
	;;^UTILITY(U,$J,"PRO",3723,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3723,2,1,0)
	;;=HS MENTAL HEALTH PHYSICAL EXAM
	;;^UTILITY(U,$J,"PRO",3723,2,"B","HS MENTAL HEALTH PHYSICAL EXAM",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3723,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3723,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3723,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="MHPE",GMTSTITL="MH Physical Exam" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3723,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",3724,0)
	;;=GMTS SW^Health Summary Social Work^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3724,1,0)
	;;=^^3^3^2950706^
	;;^UTILITY(U,$J,"PRO",3724,1,1,0)
	;;=This component provides information from the Social Work package about a
	;;^UTILITY(U,$J,"PRO",3724,1,2,0)
	;;=patient's Social/Family Relationship, Current Substance Abuse Problems,
	;;^UTILITY(U,$J,"PRO",3724,1,3,0)
	;;=and Psycho-Social Assessment.
	;;^UTILITY(U,$J,"PRO",3724,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3724,2,1,0)
	;;=HS SOCIAL WORK
	;;^UTILITY(U,$J,"PRO",3724,2,"B","HS SOCIAL WORK",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3724,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3724,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3724,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="SW",GMTSTITL="Social Work" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3724,99)
	;;=56434,65466
	;;^UTILITY(U,$J,"PRO",3725,0)
	;;=GMTS CD^Health Summary Advance Directive^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3725,1,0)
	;;=^^10^10^2950706^^^^
	;;^UTILITY(U,$J,"PRO",3725,1,1,0)
	;;=This component contains advance directive
	;;^UTILITY(U,$J,"PRO",3725,1,2,0)
	;;=notes entered using the Generic Progress Note package.
	;;^UTILITY(U,$J,"PRO",3725,1,3,0)
	;;=Time and maximum occurrent limits apply to this component.
	;;^UTILITY(U,$J,"PRO",3725,1,4,0)
	;;=
	;;^UTILITY(U,$J,"PRO",3725,1,5,0)
	;;=Advance Directives are a type a progress note which includes
	;;^UTILITY(U,$J,"PRO",3725,1,6,0)
	;;=clinical information that clinicians need to be alerted to.

GMTSO020
GMTSO020	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3725,1,7,0)
	;;=
	;;^UTILITY(U,$J,"PRO",3725,1,8,0)
	;;=If this component is printed to either a CRT or another device type,
	;;^UTILITY(U,$J,"PRO",3725,1,9,0)
	;;=information will include title, text of note,
	;;^UTILITY(U,$J,"PRO",3725,1,10,0)
	;;=electronic signature block, and date/time posted.
	;;^UTILITY(U,$J,"PRO",3725,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3725,2,1,0)
	;;=HS ADVANCE DIRECTIVE
	;;^UTILITY(U,$J,"PRO",3725,2,"B","HS ADVANCE DIRECTIVE",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3725,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3725,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3725,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="CD",GMTSTITL="Advance Directive" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3725,99)
	;;=56434,65464
	;;^UTILITY(U,$J,"PRO",3726,0)
	;;=GMTS EM^Health Summary Electron Microscopy^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3726,1,0)
	;;=^^5^5^2950706^
	;;^UTILITY(U,$J,"PRO",3726,1,1,0)
	;;=This component contains information extracted from the Electron Microscopy
	;;^UTILITY(U,$J,"PRO",3726,1,2,0)
	;;=module of the Lab package. Time and maximum occurrence limits apply. Data
	;;^UTILITY(U,$J,"PRO",3726,1,3,0)
	;;=presented include:  collection date/time, accession number, specimen,
	;;^UTILITY(U,$J,"PRO",3726,1,4,0)
	;;=gross description, microscopic exam, supplementary report description,
	;;^UTILITY(U,$J,"PRO",3726,1,5,0)
	;;=brief clinical history, and EM Diagnosis.
	;;^UTILITY(U,$J,"PRO",3726,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3726,2,1,0)
	;;=HS LAB ELECTRON MICROSCOPY
	;;^UTILITY(U,$J,"PRO",3726,2,"B","HS LAB ELECTRON MICROSCOPY",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3726,3,0)
	;;=^101.03P^88^1
	;;^UTILITY(U,$J,"PRO",3726,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3726,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="EM",GMTSTITL="Electron Microscopy" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3726,99)
	;;=56434,65465
	;;^UTILITY(U,$J,"PRO",3737,0)
	;;=GMTS HF^Health Summary Health Factors^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3737,1,0)
	;;=^^9^9^2950829^^^
	;;^UTILITY(U,$J,"PRO",3737,1,1,0)
	;;=This component lists all the health factors associated with a particular
	;;^UTILITY(U,$J,"PRO",3737,1,2,0)
	;;=patient for user-specified time and occurrence limits. The list will
	;;^UTILITY(U,$J,"PRO",3737,1,3,0)
	;;=display health factors by category and include a level of severity for
	;;^UTILITY(U,$J,"PRO",3737,1,4,0)
	;;=each health factor including Minimal(M), Moderate(MO), and
	;;^UTILITY(U,$J,"PRO",3737,1,5,0)
	;;=Heavy/Severe(H).
	;;^UTILITY(U,$J,"PRO",3737,1,6,0)
	;;= 
	;;^UTILITY(U,$J,"PRO",3737,1,7,0)
	;;=Set the occurrence limit to 1 to list the latest unique health factors
	;;^UTILITY(U,$J,"PRO",3737,1,8,0)
	;;=within each category.  (E.g. If there were 12 "Non-Smoker" health factor
	;;^UTILITY(U,$J,"PRO",3737,1,9,0)
	;;=entries, only the latest "Non-Smoker" entry would display.)
	;;^UTILITY(U,$J,"PRO",3737,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3737,2,1,0)
	;;=HS PCE HEALTH FACTORS ALL
	;;^UTILITY(U,$J,"PRO",3737,2,"B","HS PCE HEALTH FACTORS ALL",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3737,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3737,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3737,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="HF",GMTSTITL="Health Factors" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3737,99)
	;;=56488,22285
	;;^UTILITY(U,$J,"PRO",3738,0)
	;;=GMTS OE^Health Summary Outpatient Encounter^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3738,1,0)
	;;=^^5^5^2950829^^^^
	;;^UTILITY(U,$J,"PRO",3738,1,1,0)
	;;=This component lists outpatient diagnosis (ICD-9) and procedure (CPT) for a

GMTSO021
GMTSO021	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3738,1,2,0)
	;;=particular patient. The user can specify item and occurrence limits,
	;;^UTILITY(U,$J,"PRO",3738,1,3,0)
	;;=whether hospital location should be displayed or not, the format of ICD-9
	;;^UTILITY(U,$J,"PRO",3738,1,4,0)
	;;=data (e.g. code only, long text, short text or no ICD-9 data), and whether
	;;^UTILITY(U,$J,"PRO",3738,1,5,0)
	;;=the provider narrative should be displayed or not.
	;;^UTILITY(U,$J,"PRO",3738,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3738,2,1,0)
	;;=HS PCE OUTPATIENT ENCOUNTERS
	;;^UTILITY(U,$J,"PRO",3738,2,"B","HS PCE OUTPATIENT ENCOUNTERS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3738,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3738,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3738,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="OE",GMTSTITL="Outpatient Encounter" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3738,99)
	;;=56488,22286
	;;^UTILITY(U,$J,"PRO",3739,0)
	;;=GMTS NTM^Health Summary Non-Tabular Measurem^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3739,1,0)
	;;=^^3^3^2950829^^^
	;;^UTILITY(U,$J,"PRO",3739,1,1,0)
	;;=This component lists measurements (e.g. blood pressure, height, weight, 
	;;^UTILITY(U,$J,"PRO",3739,1,2,0)
	;;=respirations, etc.) in a non-tabular format for a particular patient for a 
	;;^UTILITY(U,$J,"PRO",3739,1,3,0)
	;;=user-specified time and occurrence limits.
	;;^UTILITY(U,$J,"PRO",3739,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3739,2,1,0)
	;;=HS PCE MEASUREMENTS NON-TABULAR
	;;^UTILITY(U,$J,"PRO",3739,2,"B","HS PCE MEASUREMENTS NON-TABULA",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3739,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3739,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3739,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="NTM",GMTSTITL="Non-Tabular Measurem" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3739,99)
	;;=56488,22287
	;;^UTILITY(U,$J,"PRO",3740,0)
	;;=GMTS IM^Health Summary Immunizations^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3740,1,0)
	;;=^^3^3^2950829^^^^
	;;^UTILITY(U,$J,"PRO",3740,1,1,0)
	;;=This component lists the immunizations (e.g., Rubella, Samllpox,
	;;^UTILITY(U,$J,"PRO",3740,1,2,0)
	;;=etc.) and information about each immunization adminstered to a
	;;^UTILITY(U,$J,"PRO",3740,1,3,0)
	;;=particular patient.
	;;^UTILITY(U,$J,"PRO",3740,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3740,2,1,0)
	;;=HS PCE IMMUNIZATIONS
	;;^UTILITY(U,$J,"PRO",3740,2,"B","HS PCE IMMUNIZATIONS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3740,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3740,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3740,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="IM",GMTSTITL="Immunizations" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3740,99)
	;;=56488,22287
	;;^UTILITY(U,$J,"PRO",3741,0)
	;;=GMTS ST^Health Summary Skin Tests^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3741,1,0)
	;;=^^3^3^2950829^^^
	;;^UTILITY(U,$J,"PRO",3741,1,1,0)
	;;=This component lists the skin tests and the results (e.g. positive,
	;;^UTILITY(U,$J,"PRO",3741,1,2,0)
	;;=negative, doubtful, or no take) for a particular patient. Some examples of
	;;^UTILITY(U,$J,"PRO",3741,1,3,0)
	;;=skin tests are cocci, mon-vac, PPD, schick, tine, etc.
	;;^UTILITY(U,$J,"PRO",3741,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3741,2,1,0)
	;;=HS PCE SKIN TESTS
	;;^UTILITY(U,$J,"PRO",3741,2,"B","HS PCE SKIN TESTS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3741,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3741,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3741,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="ST",GMTSTITL="Skin Tests" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3741,99)
	;;=56488,22288

GMTSO022
GMTSO022	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3742,0)
	;;=GMTS LH^Health Summary Location of Home^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3742,1,0)
	;;=^^1^1^2950829^
	;;^UTILITY(U,$J,"PRO",3742,1,1,0)
	;;=This component lists directions to a particular patient's home.
	;;^UTILITY(U,$J,"PRO",3742,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3742,2,1,0)
	;;=HS PCE LOCATION OF HOME
	;;^UTILITY(U,$J,"PRO",3742,2,"B","HS PCE LOCATION OF HOME",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3742,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3742,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3742,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="LH",GMTSTITL="Location of Home" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3742,99)
	;;=56488,22288
	;;^UTILITY(U,$J,"PRO",3743,0)
	;;=GMTS EDL^Health Summary Education Latest^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3743,1,0)
	;;=^^6^6^2950829^
	;;^UTILITY(U,$J,"PRO",3743,1,1,0)
	;;=This component lists the latest patient education for each topic and a
	;;^UTILITY(U,$J,"PRO",3743,1,2,0)
	;;=brief assessment of the patient's understanding of the topic for a
	;;^UTILITY(U,$J,"PRO",3743,1,3,0)
	;;=particular patient for a user-specified time limit. Some examples of
	;;^UTILITY(U,$J,"PRO",3743,1,4,0)
	;;=topics are complications, diet, disease process, exercise, follow-up care,
	;;^UTILITY(U,$J,"PRO",3743,1,5,0)
	;;=general information, lifestyle adaptations, medications, nutrition,
	;;^UTILITY(U,$J,"PRO",3743,1,6,0)
	;;=smoking, etc.
	;;^UTILITY(U,$J,"PRO",3743,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3743,2,1,0)
	;;=HS PCE EDUCATION LATEST
	;;^UTILITY(U,$J,"PRO",3743,2,"B","HS PCE EDUCATION LATEST",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3743,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3743,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3743,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="EDL",GMTSTITL="Education Latest" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3743,99)
	;;=56488,22288
	;;^UTILITY(U,$J,"PRO",3744,0)
	;;=GMTS OD^Health Summary Outpatient Diagnosis^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3744,1,0)
	;;=^^5^5^2950829^^^
	;;^UTILITY(U,$J,"PRO",3744,1,1,0)
	;;=This component lists outpatient diagnosis (ICD-9) for a particular patient.
	;;^UTILITY(U,$J,"PRO",3744,1,2,0)
	;;=The user can specify time and occurrence limits, whether hospital location
	;;^UTILITY(U,$J,"PRO",3744,1,3,0)
	;;=should be displayed or not, the format of ICD-9 data (e.g. code only, long
	;;^UTILITY(U,$J,"PRO",3744,1,4,0)
	;;=text, short text or no ICD-9 data), and whether the provider narrative
	;;^UTILITY(U,$J,"PRO",3744,1,5,0)
	;;=should be displayed or not.
	;;^UTILITY(U,$J,"PRO",3744,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3744,2,1,0)
	;;=HS PCE OUTPATIENT DIAGNOSIS
	;;^UTILITY(U,$J,"PRO",3744,2,"B","HS PCE OUTPATIENT DIAGNOSIS",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3744,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3744,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3744,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="OD",GMTSTITL="Outpatient Diagnosis" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3744,99)
	;;=56488,22289
	;;^UTILITY(U,$J,"PRO",3745,0)
	;;=GMTS EXAM^Health Summary Exams Latest^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3745,1,0)
	;;=^^3^3^2950829^
	;;^UTILITY(U,$J,"PRO",3745,1,1,0)
	;;=This component lists the latest examination information and results for a
	;;^UTILITY(U,$J,"PRO",3745,1,2,0)
	;;=particular patient for a user-specified time limit. Some examples of exam
	;;^UTILITY(U,$J,"PRO",3745,1,3,0)
	;;=types are eye exams, ear exams, neurological exams, pelvis exams, etc.
	;;^UTILITY(U,$J,"PRO",3745,2,0)
	;;=^101.02A^1^1

GMTSO023
GMTSO023	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3745,2,1,0)
	;;=HS PCE EXAMS LATEST
	;;^UTILITY(U,$J,"PRO",3745,2,"B","HS PCE EXAMS LATEST",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3745,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3745,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3745,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="EXAM",GMTSTITL="Exams Latest" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3745,99)
	;;=56488,22289
	;;^UTILITY(U,$J,"PRO",3746,0)
	;;=GMTS TP^Health Summary Treatments Provided^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3746,1,0)
	;;=^^5^5^2950829^^
	;;^UTILITY(U,$J,"PRO",3746,1,1,0)
	;;=This component lists treatments provided that are not covered in the
	;;^UTILITY(U,$J,"PRO",3746,1,2,0)
	;;=IDC-9-CM procedures for a particular patient for user specified time and
	;;^UTILITY(U,$J,"PRO",3746,1,3,0)
	;;=occurrence limits. Some example of treatment types include nursing
	;;^UTILITY(U,$J,"PRO",3746,1,4,0)
	;;=activities such as ear irrigation, dental care instructions, or preventive
	;;^UTILITY(U,$J,"PRO",3746,1,5,0)
	;;=health care counseling.
	;;^UTILITY(U,$J,"PRO",3746,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3746,2,1,0)
	;;=HS PCE TREATMENTS PROVIDED
	;;^UTILITY(U,$J,"PRO",3746,2,"B","HS PCE TREATMENTS PROVIDED",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3746,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3746,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3746,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="TP",GMTSTITL="Treatments Provided" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3746,99)
	;;=56488,22290
	;;^UTILITY(U,$J,"PRO",3747,0)
	;;=GMTS BADR^Health Summary Brief Adv React/All^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3747,1,0)
	;;=^^3^3^2950829^^
	;;^UTILITY(U,$J,"PRO",3747,1,1,0)
	;;=This component provides patient allergy/adverse reaction information from
	;;^UTILITY(U,$J,"PRO",3747,1,2,0)
	;;=the Allergy Tracking System. It provides a list of all known food, drug
	;;^UTILITY(U,$J,"PRO",3747,1,3,0)
	;;=and environmental allergies or adverse reactions (e.g., hay fever).
	;;^UTILITY(U,$J,"PRO",3747,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3747,2,1,0)
	;;=HS ADVERSE REACTIONS/ALLERG BRIEF
	;;^UTILITY(U,$J,"PRO",3747,2,"B","HS ADVERSE REACTIONS/ALLERG BR",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3747,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3747,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3747,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="BADR",GMTSTITL="Brief Adv React/All" D ENCWA^GMTS
	;;^UTILITY(U,$J,"PRO",3747,99)
	;;=56488,22384
	;;^UTILITY(U,$J,"PRO",3748,0)
	;;=GMTS ED^Health Summary Education^^A^^^^^^^^HEALTH SUMMARY
	;;^UTILITY(U,$J,"PRO",3748,1,0)
	;;=^^6^6^2950829^^^
	;;^UTILITY(U,$J,"PRO",3748,1,1,0)
	;;=This component lists the patient education topics and a brief assessment
	;;^UTILITY(U,$J,"PRO",3748,1,2,0)
	;;=of the patient's understanding of the topic for a particular patient for
	;;^UTILITY(U,$J,"PRO",3748,1,3,0)
	;;=user-specified time and occurrence limits. Some examples of topics are
	;;^UTILITY(U,$J,"PRO",3748,1,4,0)
	;;=complications, diet, disease process, exercise, follow-up care, general
	;;^UTILITY(U,$J,"PRO",3748,1,5,0)
	;;=information, etc. lifestyle adaptations, medications, nutrition, smoking,
	;;^UTILITY(U,$J,"PRO",3748,1,6,0)
	;;=etc.
	;;^UTILITY(U,$J,"PRO",3748,2,0)
	;;=^101.02A^1^1
	;;^UTILITY(U,$J,"PRO",3748,2,1,0)
	;;=HS PCE EDUCATION
	;;^UTILITY(U,$J,"PRO",3748,2,"B","HS PCE EDUCATION",1)
	;;=
	;;^UTILITY(U,$J,"PRO",3748,3,0)
	;;=^101.03P^1^1
	;;^UTILITY(U,$J,"PRO",3748,3,1,0)
	;;=ORWARD
	;;^UTILITY(U,$J,"PRO",3748,20)
	;;=S:'$D(DFN)&$D(ORVP) DFN=+ORVP S GMTSPRM="ED",GMTSTITL="Education" D ENCWA^GMTS

GMTSO024
GMTSO024	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q	Q
	;;^UTILITY(U,$J,"PRO",3748,99)
	;;=56488,22585

GMTSONI1
GMTSONI1	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	; LOADS
	;
	I $S('$D(DUZ)#2:1,'$D(DUZ(0))#2:1,1:0) W !,"DUZ and DUZ(0) must be defined to continue." K DIFQ Q
	K DIF,DIK,D,DDF,DDT,DTO,D0,DLAYGO,DIC,DIR,DA,DFR,DTN,DIX,DZ D DT^GMTSONI2 S %=1,U="^",DSEC=1
	S NO=$P("I 0^I $D(@X)#2,X[U",U,%) I %<1 K DIFQ Q
	W !,"    PROTOCOL INSTALLATION"
	Q:'$D(DIFQ)  ;S %=0 W !!,"ARE YOU SURE YOU WANT TO CONTINUE" D YN^DICN I %-1 K DIFQ Q
	D DT^GMTSONI2 K ^UTILITY(U,$J),^UTILITY("DIK",$J) W !,"...OK, this may take a while, hold on please..." F R=1001:1:1024 D @("^GMTSO"_$E(R,2,4)) W "."

GMTSONI2
GMTSONI2	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	;
	;
	K ^UTILITY("ORVROM",$J),DIC
	Q
DT	W !
	I '$D(DTIME) S DTIME=999
	K %DT D NOW^%DTC S DT=X
	K DIK,DIC,%I,DICS Q
	;

GMTSONI3
GMTSONI3	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	;
	;
	K ^UTILITY("ORVROM",$J) S DIC(0)="LX",ORNMCHK=1 I $D(^ORD(101,0))#2,^(0)?1"PROTOCOL".E S DIC="^ORD(101,",DLAYGO=101,N="PRO" D ADD,OP
	K ^UTILITY(U,$J),DIC,DLAYGO
	Q
DIEZ	I ^DD("VERSION")>17.4,'$D(DISYS),$D(^%ZOSF("OS"))#2 S DISYS=+$P(^("OS"),"^",2)
	E  S DISYS=^DD("OS")
	Q:'$D(^DD("OS",DISYS,"ZS"))
	S N=$O(^UTILITY("ORVROM",$J,DIR,0)) Q:N=""  S Y=+^(N) K ^(N)
	I $D(@("^"_DIR_"(Y,""ROU"")")) K ^("ROU") I $D(^("ROUOLD")) S X=^("ROUOLD"),DMAX=^DD("ROU") D:X]"" @("EN^DI"_$E(DIR,3)_"Z")
	G DIEZ
	;
OP	S NM=$O(^UTILITY("ORVROM",$J,N,NM)) I NM="" K ^UTILITY("ORVROM",$J) G Q
	S R=$O(^UTILITY("ORVROM",$J,N,NM,0)) G:R="" OP
	W !,"'"_NM_"' Protocol Filed" S DA=+^UTILITY("ORVROM",$J,N,NM,R)
	S %=$P(^ORD(101,DA,0),U,12) S:%]"" %=$O(^DIC(9.4,"B",%,0))
	S $P(^ORD(101,DA,0),U,12)=%,(ORDZ,ORDIX)=0
	S %=$S($D(^ORD(101,DA,5)):$P(^(5),"^"),1:"") I $L(%) S $P(^(5),"^")="",X=$P(%,";",2),%=$P(%,";") I $D(@("^"_X_"""B"","""_%_""")")) S %=$O(^(%,0)) S %=$S(%:%_";"_X,1:""),$P(^ORD(101,DA,5),"^")=%
	I $D(^ORD(101,DA,3,0)) S I=0 F  S I=$O(^ORD(101,DA,3,I)) Q:I<1  S KEY=^(I,0) K ^(0) I $D(^DIC(19.1,"B",KEY)) S KEY=$O(^(KEY,0)) I KEY S ^ORD(101,DA,3,I,0)=KEY
	I $D(^ORD(101,DA,3)) S I=0 F  S I=$O(^ORD(101,DA,3,I)) Q:I<1  S ORDZ=ORDZ+1,ORDIX=X
	I  S $P(^ORD(101,DA,3,0),"^",3,4)=ORDIX_"^"_ORDZ
	I $D(^UTILITY("ORVROM",$J,N,NM,R,10)) S X=0 F  S X=$O(^UTILITY("ORVROM",$J,N,NM,R,10,X)) Q:X<1  D A1
	S (ORDZ,ORDIX)=0 S X=0 F  S X=$O(^ORD(101,DA,10,X)) Q:X<1  S ORDZ=ORDZ+1,ORDIX=X
	S:$D(^ORD(101,DA,10,0)) ^(0)="^101.01PA^"_ORDIX_U_ORDZ D IX1^DIK
	I $D(^UTILITY("ORVROM",$J,N,NM,R,"MEN")) S IMEN=0 F  S IMEN=$O(^UTILITY("ORVROM",$J,N,NM,R,"MEN",IMEN)) Q:IMEN=""  S OMEN=^(IMEN),MEN=IMEN D MEN
	K MEN,IMEN,OMEN
	G OP
	;
ADD	S R=0 F  S R=$O(^UTILITY(U,$J,N,R)) Q:R=""  S X=$P(^(R,0),U),I=$P(^(0),U,4) D
	. I $L($T(DOT^ORVOM)) D DOT^ORVOM
	. I '$L($T(DOT^ORVOM)) W "."
	. I $O(^ORD(101,"B",X,0)) S Y=$O(^(0)),ORA=Y,Y=Y_U D A Q
	. D ^DIC I Y>0,'$D(DIFQ(N))!$P(Y,U,3) S ORA=Y,Y=Y_U D A
Q	K ORA,MEN,OMEN,ORNMCHK,ORDZ,ORDIX S (NM,R)=0 Q
A	S ^UTILITY("ORVROM",$J,N,X,R)=Y
	I $O(^UTILITY(U,$J,N,R,1,0))>0 K ^ORD(101,+Y,1)
	I $O(^UTILITY(U,$J,N,R,10,0))>0 S %X="^UTILITY(U,$J,N,R,10,",%Y="^UTILITY(""ORVROM"",$J,N,X,R,10," D %XY^%RCR K ^UTILITY(U,$J,N,R,10)
	I $D(^UTILITY(U,$J,N,R,"MEN")) S %X="^UTILITY(U,$J,N,R,""MEN"",",%Y="^UTILITY(""ORVROM"",$J,N,X,R,""MEN""," D %XY^%RCR K ^UTILITY(U,$J,N,R,"MEN")
	S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+ORA,",DA=+ORA,DIK=DIC D %XY^%RCR
	Q
A1	S ORA=DA N DA,DIC,ORI S Y="",ORI=0,DIC="^ORD(101,"_+ORA_",10,",DIC(0)="L",DA(1)=+ORA S:'$D(^ORD(101,DA(1),10,0)) ^(0)="^101.01PA^^"
	F  S ORI=$O(^UTILITY("ORVROM",$J,N,NM,R,10,ORI)) Q:ORI<1  S X0=^(ORI,0),X=$S($D(^(U)):^(U),1:"") I $L(X) D A2
	K DA,^UTILITY("ORVROM",$J,N,NM,R,10)
	Q
A2	N X1 S DLAYGO=101 D ^DIC Q:'Y
	I $P(Y,"^",3) W !?2,X_" added as item to "_$P(^ORD(101,DA(1),0),"^")_"."
	S X0=^UTILITY("ORVROM",$J,N,NM,R,10,ORI,0)
	S %=$P(X0,"^",4) I $L(%) S %=$O(^ORD(101,"B",%,0)) S:% $P(X0,"^",4)=%
	S $P(^ORD(101,DA(1),10,+Y,0),"^",2,99)=$P(X0,"^",2,99)
	S X1=0 F  S X1=$O(^UTILITY("ORVROM",$J,N,NM,R,10,ORI,X1)) Q:X1=""  I X1'["^" S X0=^UTILITY("ORVROM",$J,N,NM,R,10,ORI,X1),^ORD(101,DA(1),10,+Y,X1)=X0
	Q
MEN	S MEN=$S($D(^ORD(101,"B",MEN)):$O(^(MEN,0)),1:"") I 'MEN K ^UTILITY("ORVROM",$J,N,NM,R,"MEN") Q
	S X=NM,X0=OMEN,DIC="^ORD(101,"_MEN_",10,",DIC(0)="L",DA(1)=MEN S:'$D(^ORD(101,DA(1),10,0)) ^(0)="^101.01PA^^"
	S DIC("DR")="2///"_$P(X0,"^",2)_";3///"_$P(X0,"^",3)_";4///"_$P(X0,"^",4)_";5///"_$P(X0,"^",5)_";6///"_$P(X0,"^",6),DLAYGO=101 D ^DIC
	I $P(Y,"^",3) W !?2,X_" added as item to "_$P(^ORD(101,DA(1),0),"^")_"."
	Q

GMTSONIT
GMTSONIT	; ; 19-OCT-1995
	;;2.7;Health Summary;;Oct 20, 1995
	;
	K DIF,DIK,DDF,DDT,DTO,D0,DLAYGO,DIC,DIR,DA,ORVROM,DFR,DTN,DIX,DZ
	S DIFQ=0,ORVROM=22 W !!,"This version of 'GMTSONIT' was created on 19-OCT-1995"
	W !?9,"(at ISCSLC, by OE/RR V.2.5)",!
	G Q:DIFQ D ^GMTSONI1 G Q:'$D(DIFQ) S DIK(0)="B"
	D ^GMTSONI2,^GMTSONI3
	L  W !,*7,"OK, Protocol Installation is Complete.",!
	K %ZW,%,%H,D0,DA,DIF,DIFQ,DIG,DIH,DIK,DIU,DIV,DSEC,I,J,KEY,DIY,N,NM,NO,ORVROM,R,X,X0
	Q
	;
Q	W *7,!!,"NO UPDATING HAS OCCURRED!" Q
	;
IXF	;;GMTS

GMTSORC
GMTSORC	;SLC/JER - Current Orders Component ;3/29/93  13:14
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; controls branching and execution
	N GMI,GMIDT,ORAGE,ORDOB,ORLIST,ORPNM,ORSEX,ORSSN,ORVP,ORL,ORPV,ORTS,ORDUZ,ORNP,OROLD,ORIDT,X K ^TMP("OR",$J,"OUT")
	S X="ORF4" X ^%ZOSF("TEST") I '$T Q
	S ORUVP=$S($D(ORVP):ORVP,$D(DFN):DFN_";DPT(",1:0),ORUPRES=2,ORDR=1,ORUSTART=GMTSBEG,ORUEND=GMTSEND
	I '$D(^OR(100,"AO",ORUVP)) Q
	D ^ORF4
	I '$D(^TMP("OR",$J)) Q
	D HEAD
	S GMIDT=GMTS1
	F  S GMIDT=$O(^TMP("OR",$J,"OUT",GMIDT)) Q:GMIDT'>0!(GMIDT>GMTS2)  D
	. S GMI=0 F  S GMI=$O(^TMP("OR",$J,"OUT",GMIDT,GMI)) Q:GMI'>0  D WRT
	K ^TMP("OR",$J,"OUT")
	Q
HEAD	; Prints header
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Item Ordered",?48,"Start DT",?64,"Stop DT",!!
	Q
WRT	; Writes order record
	N FDT,STDT,STAT,TEXT,GMTI,X
	S TEXT=^TMP("OR",$J,"OUT",GMIDT,GMI,"ORTX"),STAT=$TR($E($P(^("ORSTS"),U,2),1),"DCHFPAESIN","dchfpaesin") S:STAT="d" STAT="dc"
	S TEXT=$$FORMAT(TEXT)
	S X=^TMP("OR",$J,"OUT",GMIDT,GMI,"ORSTOP") D:X]"" REGDTM^GMTSU S FDT=X
	S X=^TMP("OR",$J,"OUT",GMIDT,GMI,"ORSTRT") D:X]"" REGDTM^GMTSU S STDT=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W $P(TEXT,"|"),?45,STAT,?48,STDT,?64,FDT,!
	F GMTI=2:1:$L(TEXT,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  G:GMTSNPG WRT W:$P(TEXT,"|",GMTI)]"" ?2,$P(TEXT,"|",GMTI),!
	Q
FORMAT(TEXT)	; Formats text field
	N GMTI,GMX
	F GMTI=1:1:$L(TEXT,"|") S $P(TEXT,"|",GMTI)=$$STRIP($P(TEXT,"|",GMTI))
	S GMX="" F GMTI=1:1:$L(TEXT,"|") S:$P(TEXT,"|",GMTI)]"" GMX=GMX_$S(GMTI=1:"",1:" - ")_$P(TEXT,"|",GMTI)
	S TEXT=GMX
	I $L(TEXT)>43 S TEXT=$$WRAP(TEXT,43)
	Q TEXT
STRIP(TEXT)	; Strips white space from text
	N GMTI,GMX
	S GMX="" F GMTI=1:1:$L(TEXT," ") S:$A($P(TEXT," ",GMTI))>0 GMX=GMX_$S(GMTI=1:"",1:" ")_$P(TEXT," ",GMTI)
	S TEXT=GMX
	Q TEXT
WRAP(TEXT,LENGTH)	; Breaks text string into substrings of length LENGTH
	N GMTI,GMTJ,LINE,GMX,GMX1,GMX2,GMY
	I $G(TEXT)']"" Q ""
	F GMTI=1:1 D  Q:GMTI=$L(TEXT," ")
	. S GMX=$P(TEXT," ",GMTI)
	. I $L(GMX)>LENGTH D
	. . S GMX1=$E(GMX,1,LENGTH),GMX2=$E(GMX,LENGTH+1,$L(GMX))
	. . S $P(TEXT," ",GMTI)=GMX1_" "_GMX2
	S LINE=1,GMX(1)=$P(TEXT," ")
	F GMTI=2:1 D  Q:GMTI'<$L(TEXT," ")
	. S:$L($G(GMX(LINE))_" "_$P(TEXT," ",GMTI))>LENGTH LINE=LINE+1,GMY=1
	. S GMX(LINE)=$G(GMX(LINE))_$S(+$G(GMY):"",1:" ")_$P(TEXT," ",GMTI),GMY=0
	S GMTJ=0,TEXT="" F GMTI=1:1 S GMTJ=$O(GMX(GMTJ)) Q:+GMTJ'>0  S TEXT=TEXT_$S(GMTI=1:"",1:"|")_GMX(GMTJ)
	Q TEXT

GMTSPCD
GMTSPCD	;SLC/DLT - Job to Queue HS Batch Print Clinic HS by Selected Date ;11/15/94  08:14
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching
	W !!,"This option will queue Health Summaries for a specified Visit Date"
	W !,"for all Outpatient Clinics with Appointments on that Visit Date."
	W !
	W !
	N GMTSCDT
	S GMTSCDT=$$SELDATE Q:GMTSCDT'>0
	W ! N DIR S DIR(0)="D^::%DT",DIR("A")="Date and Time to Queue this Job to run",DIR("B")="NOW" D ^DIR Q:($D(DTOUT)!($D(DUOUT))!($D(DIROUT)))
	S ZTDTH=Y,ZTIO="",ZTSAVE("GMTSCDT")=""
	S ZTRTN="CLINICQ^GMTSPCD",ZTDESC="Create Task HS Jobs for Clinics by Visit Date"
	D ^%ZTLOAD
	Q
CLINICQ	;Loop thru clinics for appointments on the date stored in GMTSCDT 
	N GMTSTYP,GMTSCLN,GMTSCL,LTYPE,GMW,X
	S GMTSCLN=0
	; Using "B" xref so clinics printed out in numeric/alphabetic order
	F  S GMTSCLN=$O(^SC("B",GMTSCLN))  Q:GMTSCLN=""  D
	. S GMTSCL=$O(^SC("B",GMTSCLN,0))
	. Q:$P($G(^SC(GMTSCL,0)),U,3)'="C"
	. S GMTSDATE=+$O(^SC(GMTSCL,"S",GMTSCDT))  Q:'GMTSDATE  Q:GMTSDATE'[GMTSCDT
	. S GMTSTYP=0 S GMTSTYP=$O(^GMT(142,"D",GMTSCL,GMTSTYP)) Q:+GMTSTYP'>0  D QUEUE
	Q
QUEUE	; Queues HS batch print for particular HS Type and Location.
	N DIC,GMPSAP,GMTSLOC,GMTSSC,GMTSIO,GMTSDYS,GMV,QUEQIT,X,Y
	S QUEQIT=0
	S GMTSCLI=$O(^GMT(142,GMTSTYP,20,"B",GMTSCL,0))
	S GMTSLOC=$G(^GMT(142,GMTSTYP,20,GMTSCLI,0))
	S X=+GMTSLOC,DIC=44,DIC(0)="NXZ" D ^DIC
	I $S(+Y'>0:1,"WCOR"'[$P($G(Y(0)),U,3):1,1:0) Q
	S GMTSSC(1)=Y_U_$P(Y(0),U,3),$P(GMTSSC(1),U,4)=GMTSCDT
	S GMPSAP=$S($P(GMTSLOC,U,3)="Y":1,1:0)
	S ZTIO=$$GETIO($P(GMTSLOC,U,2)) Q:'$L(ZTIO)
	S ZTDTH=$H,ZTRTN="MAIN^GMTSPL",ZTDESC="Clinic Health Summaries by Visit Date"
	F GMV="GMTSTYP","GMPSAP" S ZTSAVE(GMV)=""
	S ZTSAVE("GMTSSC(")=""
	D ^%ZTLOAD
	Q
GETIO(X)	; Get device for queueing
	N %,%Y,C,DIC,Y
	S DIC=3.5,DIC(0)="NXZ" D ^DIC S Y=$S(+Y'>0:"",1:$P(Y(0),U))
	Q Y
SELDATE()	; Allows entry of Visit/Surgery date or date range
	; for Print-by-Clinic
	N %,%H,%I,DIR,DEFDT,X,Y
	D NOW^%DTC S (X,DT)=$P(%,".") D REGDT^GMTSU S DEFDT=X
	S DIR(0)="D^::EX",DIR("B")=DEFDT
	S DIR("A")="Please enter the Visit date"
	D ^DIR
	I Y="^^" S DIROUT=1
	Q Y

GMTSPD
GMTSPD	;SLC/JER,SBW - Driver for Interactive Print-by-Location ;10/1/92  07:21
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching
	N GMPSAP,GMTSCDT,GMTSTYP,GMLOC,GMTSSC
	S GMTSTYP=0 K DIROUT
	F  D  Q:+GMTSTYP'>0!$D(DIROUT)
	. S GMTSTYP=+$$SELTYP Q:+GMTSTYP'>0!$D(DIROUT)
	. F  D  Q:+$G(GMTSSC)'>0!$D(DIROUT)!$D(DUOUT)
	. . K GMTSSC
	. . D SELLOC(.GMTSSC) Q:+$G(GMTSSC)'>0!$D(DIROUT)!$D(DUOUT)
	. . D CHKLOC(.GMTSSC) Q:$O(GMTSSC(0))'>0!$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
	. . S GMPSAP=$$RXAP^GMTSPD2 Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)
	. . N DIROUT
	. . D HSOUT^GMTSPD2 W !
	Q
SELTYP()	; Select Health Summary type
	N DIC,X,Y
	I $D(^DISV(DUZ,"^GMT(142,")),+$G(GMTSTYP)=0 S DIC("B")=$P($G(^GMT(142,+$G(^DISV(DUZ,"^GMT(142,")),0)),U)
	S DIC=142,DIC("A")="Select Health Summary Type: "
	S DIC(0)="AEQM",DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION"""
	D ^DIC I +Y'>0,X="^^" S DIROUT=1
	I +Y>0,$S($D(^GMT(142,+Y,1,0))=0:1,$O(^(0))'>0:1,1:0) D
	. W !,"This Summary Type includes no components...Please choose another."
	Q Y
SELLOC(GMX)	; Select multiple Hospital Location
	N DIC,LOC,Y,X
	S DIC=44,DIC(0)="AEMQZ",DIC("A")="Select Hospital Location: "
	S DIC("S")="I ""WCOR""[$P(^(0),U,3)"
	F  D  Q:+$G(GMX(+$G(Y)))'>0!$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
	. D ^DIC
	. I +Y'>0 S:X="^^" DIROUT=1 Q
	. S GMX(+Y)=$P(Y,U,1,2)_U_$P(Y(0),U,3)
	. S $P(GMX,U)=+Y
	. I "COR"[$P(Y(0),U,3) S $P(GMX,U,3)="COR"
	. S DIC("A")="Select Next Hospital Location: "
	Q
CHKLOC(LOC)	;Get date range for Clinics and Operating Rooms.
	; Checks that there are patients at the locations.
	I $P(LOC,U,3)="COR" D  Q:$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
	. S $P(LOC,U,4)=$$SELDATE
	W !
	S GMLOC=0
	F  S GMLOC=$O(LOC(GMLOC)) Q:+GMLOC'>0  D
	. I "COR"[$P(LOC(+GMLOC),U,3) S $P(LOC(+GMLOC),U,4)=$P(LOC,U,4,5)
	. I $$CKPAT(LOC(+GMLOC))'>0 D
	. . W !,"No patients found at ",$$LOCTXT^GMTSPD2($P(LOC(+GMLOC),U,3))," ",$P(LOC(+GMLOC),U,2)
	. . N GMB,GME
	. . I $P(LOC(+GMLOC),U,4)>0 D
	. . . S X=$P(LOC(+GMLOC),U,4) D REGDT^GMTSU S GMB=X
	. . I $P(LOC(+GMLOC),U,5)>0 D
	. . . S X=$P(LOC(+GMLOC),U,5) D REGDT^GMTSU S GME=X
	. . W $S($G(GME)]"":" on "_GMB_" to "_GME,$G(GMB)]"":" on "_GMB,1:"")
	. . W "."
	. . K LOC(+GMLOC)
	W !
	Q
SELDATE()	; Allows entry of Visit/Surgery date or date range
	; for Print-by-Clinic
	; LTYPE=Location type (e.g., OR or Clinic)
	N %,%H,%I,DIR,DEFDT,X,Y,GMBEG,GMEND
	S (GMBEG,GMEND)=0
	D NOW^%DTC S (X,DT)=$P(%,".") D REGDT^GMTSU S DEFDT=X
	S DIR(0)="D^::EX",DIR("B")=DEFDT
	S DIR("A")="Please enter the beginning Visit or Surgery date"
	D ^DIR
	I Y="^^" S DIROUT=1
	S GMBEG=Y
	I +GMBEG>0 D
	. S X=$P(GMBEG,".") D REGDT^GMTSU S DEFDT=X
	. S DIR(0)="DO^::EX",DIR("B")=DEFDT
	. S DIR("A")="Please enter the ending Visit or Surgery date"
	. D ^DIR
	. I Y="^^" S DIROUT=1
	. S GMEND=Y
	Q $S(+GMEND>0&(GMEND>GMBEG):GMBEG_U_GMEND,+GMEND>0&(GMEND<GMBEG):GMEND_U_GMBEG,+GMEND>0&(GMEND=GMBEG):GMBEG,1:0)
CKPAT(LOC)	; Checks for patients at selected location
	;   LOC=Ptr. to file 44^LOCATION NAME^LOCATION TYPE^BEG DATE^END DATE
	N %,%H,%T,LTYPE,X1,X2,X,Y,GMY,GMBEG
	S LTYPE=$P(LOC,U,3)
	I LTYPE="W" D
	. S LOC=$P($G(^DIC(42,+$G(^SC(+LOC,42)),0)),U)
	. S GMY=$S($G(LOC)']"":0,$O(^DPT("CN",LOC,0)):1,1:0)
	I $L(LOC,U)=4!($L(LOC,U)=5) D
	. S GMY=0
	. I +$P(LOC,U,5) S X1=$P(LOC,U,5),X2=1 D C^%DTC
	. I +$P(LOC,U,5)'>0 S X1=$P(LOC,U,4),X2=1 D C^%DTC
	. I LTYPE="C",+$O(^SC(+LOC,"S",$P(LOC,U,4))),(+$O(^($P(LOC,U,4)))'>X) S GMY=1
	. I LTYPE="OR" D
	. . N OLOC S GMY=0,OLOC=+$O(^SRS("B",+LOC,0))
	. . I +OLOC,+$P(LOC,U,5)'>0,$O(^SRF("AOR",+OLOC,+$P(LOC,U,4),0)) S GMY=1
	. . I +OLOC,+$P(LOC,U,5) D
	. . . S GMBEG=$P(LOC,U,4)
	. . . F  D  Q:GMBEG>$P(LOC,U,5)!(GMY>0)
	. . . . I $O(^SRF("AOR",+OLOC,+GMBEG,0)) S GMY=1
	. . . . E  S X1=GMBEG,X2=1 D C^%DTC S GMBEG=X
	Q $G(GMY)

GMTSPD2
GMTSPD2	;SLC/JER,SBW - Cont. driver for Interactive Print-by-Loc ;10/13/94
	;;2.7;Health Summary;;Oct 20, 1995
RXAP()	; Ask about inclusion of OP Rx Action Profile
	N %,DIR,X,Y
	I $P($G(^GMT(142.99,1,0)),U,2)'="Y" S Y=0 G RXAPX
	S DIR(0)="YO",DIR("A")="Include Outpatient Pharmacy Action Profile (Y/N)"
	S DIR("B")="NO" D ^DIR
RXAPX	Q Y
HSOUT	; Device Handling/Output control
	N IOP,%ZIS
	I $D(^XUSEC("GMTS VIEW ONLY",DUZ)) D NOQUE Q
	S %ZIS="Q",%ZIS("B")="HOME" D ^%ZIS Q:POP
	D @$S(+$G(GMPSAP)&(IO'=IO(0)):"QUE",$D(IO("Q")):"QUE",1:"NOQUE")
	Q
QUE	; Set ZT parameters and tasks ^GMTSPL
	N ZTSAVE,ZTDESC,ZTDTH,ZTIO,ZTRTN,% K IO("Q")
	F %="U","GMTSTYP","GMTSCDT","GMTSSC(","GMPSAP" S ZTSAVE(%)=""
	S ZTRTN="^GMTSPL",ZTDESC="HEALTH SUMMARY (BY LOCATION)",ZTIO=ION
	D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!")
	D ^%ZISC
	Q
NOQUE	; Calls ^GMTSPL in interactive mode ;1/5/90  14:33
	I IO'=IO(0) U IO
	D ^GMTSPL
	D ^%ZISC
	Q
LOCTXT(LOC)	;Change hospital location code to text name
	Q $S(LOC="W":"Ward",LOC="OR":"Operating Room",LOC="C":"Clinic",1:"Hospital Location")

GMTSPDX
GMTSPDX	;SLC/JER,SBW - PDX Health Summary Driver ;10/18/94  16:06
	;;2.7;Health Summary;;Oct 20, 1995
GET(TRAN,DFN,SEGPTR,ROOT,GMTSLCNT,GMTSDLM,GMTSNDM)	; Get HS for PDX
	; Data retrieved from HS is return in ROOT parameter reference passing.
	; Function returns 2 piece variable delimited with "^".
	; Piece 1 = tot line cnt of data extract to ROOT.
	; Piece 2 = contains entry line cnt (GMTSLCNT) + Piece 1
	; Note: Currently Data begins with GMTSLCNT + 1 and
	;       Piece 2 is last node # of ROOT
	;     : If TRAN is passed
	;         The patient pointer of the transaction will be used
	;         Encryption will be based on the transaction
	;       If DFN is passed
	;         Encryption will be based on the site parameter
	;     : Pointer to transaction takes precedence over DFN ... if
	;         TRAN>0 the DFN will be based on the transaction
	;
	;DETERMINE TRUE DFN
	S TRAN=+$G(TRAN)
	S DFN=+$G(DFN)
	Q:(('TRAN)&('DFN)) "-1^Did not pass pointer to transaction or patient"
	I (TRAN) Q:('$D(^VAT(394.61,TRAN))) "-1^Did not pass valid pointer to VAQ - TRANSACTION file"
	I (TRAN) S DFN=+$P($G(^VAT(394.61,TRAN,0)),"^",3) Q:('DFN) "-1^Transaction did not contain pointer to PATIENT file"
	Q:('$D(^DPT(DFN))) "-1^Did not pass valid pointer to PATIENT file"
	;
	; Scope FM local variables that don't get cleaned up by %ZIS
	; SPOOLER call
	N C,D0,DA,DI,DIE,DIC,DQ,DR,GMTS,GMTS1,GMTS2,GMTSAGE,GMTSDOB,GMTSDTM
	N GMTSDUZ,GMTSLO,GMTSLPG,GMTSPNM,GMTSRB,GMTSSN,GMTSSPL,GMTSWARD,GMTSY
	N SEX,SPLDOC,VADM,VAERR,VAIN,X,Y,ZISIOST
	N %,%X,%XX,%Y,%YY,%Z4,%ZDA,%ZS,%ZY,POP,Y,C
	S GMTSDUZ=$G(DUZ),DUZ=.5
	S Y=$P($G(^GMT(142.99,1,0)),U,4)
	S C=$P(^DD(142.99,.04,0),U,2)
	D Y^DIQ
	S GMTSSPL=Y
	I GMTSSPL']"" S GMTSY="-1^No Spool Device allocated" G GETX
	;CONVERT SEGPTR TO ENTRY IN HEALTH SUMMARY COMPONENT FILE
	S X=+$P($G(^VAT(394.71,SEGPTR,0)),"^",4)
	I ('X) S GMTSY="-1^Unable to convert PDX data segment to Health Summary component" G GETX
	S SEGPTR=X
	;DETERMINE IF COMPONENT HAS BEEN DISABLED
	S X=$G(^GMT(142.1,SEGPTR,0))
	I (($P(X,"^",6)="T")!($P(X,"^",6)="P")) D  G GETX
	.;DISABLED
	.S GMTSY=$P(X,"^",8)
	.I (GMTSY'="") S GMTSY="-1^"_GMTSY Q
	.S GMTSY="-1^Component has been disabled  "
	.S GMTSY=GMTSY_$S($P(X,"^",6)="T":"(temporary)",1:"(permanent)")
	;OPEN SPOOL DEVICE
	S IOP=GMTSSPL_";HSPDX"_DFN D ^%ZIS
	I POP S GMTSY="-1^Spool open failed" G GETX
	D ONECOMP(DFN,SEGPTR,$G(GMTSDLM),$G(GMTSNDM)) ; Write component
	S SPLDOC=$G(IO("SPOOL")) D ^%ZISC
	I +SPLDOC D
	. N SPLSTAT,SPLPTR,GMTSDOC
	. ; Wait until spool document is "ready" (ONLY CHECK EVERY 5 SECONDS)
	. F  S SPLSTAT=$P($G(^XMB(3.51,SPLDOC,0)),U,3) Q:SPLSTAT="r"  H 5
	. S GMTSDOC=$G(^XMB(3.51,SPLDOC,0)),SPLPTR=$P(GMTSDOC,U,10)
	. I '+SPLPTR!('+$P(GMTSDOC,U,9)) S GMTSY="-1^No data available" Q
	. S GMTSY=$$XFER(SPLPTR,ROOT,GMTSDOC,+$G(GMTSLCNT))
	. D DSDOC^ZISPL(SPLDOC),DSD^ZISPL(SPLPTR)
	.;CHECK TO SEE IF ENCRYPTION IS ON
	.S:(TRAN) X=$$TRANENC^VAQUTL3(TRAN,0)
	.S:('TRAN) X=$$NCRYPTON^VAQUTL2(0)
	.S:(X) X=$$ENCDSP^VAQHSH(TRAN,ROOT,X,(GMTSLCNT+1),+GMTSY)
	E  S GMTSY="-1^Spool document not created"
GETX	S DUZ=+$G(GMTSDUZ)
	Q $G(GMTSY)
ONECOMP(DFN,SEGPTR,GMTSDLM,GMTSNDM)	; Print a single HS component to IO
	N GMTSEG,GMTSEGI,GMTSEGC,GMTSTITL
	S GMTSTITL="PDX TRANSMISSION"
	S GMTSEG(1)=1_U_SEGPTR_U_$G(GMTSNDM)_U_$G(GMTSDLM)_U_U_"N"_U_"L"_U_"Y"
	S (GMTSEGI(SEGPTR),GMTSEGC)=1
	D EN^GMTS1
	Q
XFER(SPLDAT,ROOT,GMTSDOC,GMTSLCNT)	; Transfer text from SPOOL DOC to ROOT
	N GMTSI,GMTSL,GMTSREC,GMTSPRT,GMTSX S (GMTSI,GMTSL)=0,GMTSPRT=1
	F  S GMTSI=$O(^XMBS(3.519,SPLDAT,2,GMTSI)) Q:+GMTSI'>0  D  Q:$E(GMTSREC,1,7)="*** END"
	. S GMTSREC=$G(^XMBS(3.519,SPLDAT,2,GMTSI,0))
	. ;Don't transfer data until a line with 3 hyphens or ** DECEASED **
	. ;is found nor after "*** END" is found
	. I (GMTSL=0&($E(GMTSREC,1,3)="---")!(GMTSREC["** DECEASED **"))!((GMTSL>0)&($E(GMTSREC,1,7)'="*** END")) D
	. . I GMTSREC["|TOP|" S GMTSPRT=0
	. . S:GMTSPRT GMTSL=GMTSL+1,GMTSLCNT=GMTSLCNT+1,@ROOT@("DISPLAY",GMTSLCNT,0)=GMTSREC
	. . I GMTSREC["(continued)" S GMTSPRT=1
	I +GMTSL,$P(GMTSDOC,U,11) D  ;incomplete report indicator
	. S GMTSL=GMTSL+1,@ROOT@("DISPLAY",GMTSL,0)="*** Data is incomplete ***"
	I '+GMTSL S GMTSL="-1^Text transfer from Spool Document failed"
	Q $G(GMTSL)_U_$G(GMTSLCNT)

GMTSPDXZ
GMTSPDXZ	;SLC/NCG - Create Data Segment from H.S. Component ;26-OCT-94 ;1/4/95  09:22
	;;2.7;Health Summary;;Oct 20, 1995
VAQUTL50	;ALB/JRP - CREATE DATA SEGMENT FROM H.S. COMPONENT ;26-OCT-94
	;;1.5;PATIENT DATA EXCHANGE;**11**;NOV 17, 1993
ADDSEG(HSPTR,MAXTIME,MAXOCCUR)	;ADD NEW DATA SEGMENT USING H.S. COMPONENT
	;INPUT  : HSPTR - Pointer to HEALTH SUMMARY COMPONENT file (#142.1)
	;         MAXTIME - Max time limit allowed for auto processing
	;         MAXOCCUR - Max occurrence limit allowed for auto processing
	;OUTPUT : X - Pointer to VAQ - DATA SEGMENT file (#394.71) that
	;             was created
	;        -1^ErrorText - Entry not created
	;NOTES  : If time and/or occurrence limits do not apply to the
	;         component, MAXTIME and/or MAXOCCUR are not required.
	;       : If time and/or occurrence limits apply to the component,
	;         default values will be taken from the VAQ - PARAMETER
	;         file (#394.81).  If parameter file does not contain these
	;         values, a default of 1 year and 10 occurrences will be used.
	;       : If a maximum limit is not valid, the default limit will
	;         be used.
	;
	;CHECK INPUT
	S HSPTR=+$G(HSPTR)
	Q:('HSPTR) "-1^Did not pass pointer to HEALTH SUMMARY COMPONENT file"
	Q:('$D(^GMT(142.1,HSPTR,0))) "-1^Did not pass valid pointer to HEALTH SUMMARY COMPONENT file"
	S MAXTIME=$G(MAXTIME)
	S MAXOCCUR=$G(MAXOCCUR)
	;DECLARE VARIABLES
	N NAME,ABB,TIME,OCCUR,TMP,DEFTIME,DEFOCCUR
	N X,Y,DIC,DINUM,DA,DIE,DR
	;GET COMPONENT NAME & ABBREVIATION
	S TMP=$G(^GMT(142.1,HSPTR,0))
	S NAME=$P(TMP,"^",1)
	Q:(NAME="") "-1^Entry in HEALTH SUMMARY COMPONENT file did not contain a name"
	S ABB=$P(TMP,"^",4)
	Q:(ABB="") "-1^Entry in HEALTH SUMMARY COMPONENT file did not contain an abbreviation"
	;CONVERT NAME SO ONLY FIRST CHARACTER OF EVERY WORD IS IN UPPERCASE
	S NAME=$$FIRSTUP(NAME)
	;SEE IF NAME OR ABBREVIATION ALREADY EXIST IN DATA SEGMENT FILE
	Q:($D(^VAT(394.71,"B",NAME))) "-1^"_NAME_" already exists in VAQ - DATA SEGMENT file"
	Q:($D(^VAT(394.71,"CAPS",NAME))) "-1^"_NAME_" already exists in VAQ - DATA SEGMENT file"
	Q:($D(^VAT(394.71,"C",ABB))) "-1^Abbreviation of "_ABB_" already used in VAQ - DATA SEGMENT file"
	;GET DEFAULT TIME AND OCCURRENCE LIMITS
	S X=+$O(^VAT(394.81,0))
	S TMP=$G(^VAT(394.81,X,"LIMITS"))
	S DEFTIME=$P(TMP,"^",1)
	S:(DEFTIME="") DEFTIME="1Y"
	S DEFOCCUR=$P(TMP,"^",2)
	S:(DEFOCCUR="") DEFOCCUR=10
	;DETERMINE IF TIME AND/OR OCCURRENCE LIMITS APPLY
	S TMP=$$LIMITS^VAQDBIH3(HSPTR)
	S TIME=+TMP
	S OCCUR=+$P(TMP,"^",2)
	;SET MAX LIMITS
	I (TIME) S:($$VALOCC^VAQDBIH2(MAXTIME,0)<0) MAXTIME=DEFTIME
	I ('TIME) S MAXTIME=""
	I (OCCUR) S:($$VALOCC^VAQDBIH2(MAXOCCUR,1)<0) MAXOCCUR=DEFOCCUR
	I ('OCCUR) S MAXOCCUR=""
	;SET UP CALL TO FILEMAN & CREATE STUB
	K DD,DO
	S DIC="^VAT(394.71,"
	S DIC(0)="L"
	S X=NAME
	D FILE^DICN
	S DA=+Y
	Q:(DA<0) "-1^Unable to create entry in VAQ - DATA SEGMENT file"
	;SET UP CALL TO FILEMAN & FINISH ENTRY
	S DIE="^VAT(394.71,"
	S DR=".02///^S X=ABB"
	S DR(1,394.71,.03)=".03///YES"
	S DR(1,394.71,.04)=".04////"_HSPTR
	S DR(1,394.71,.05)=".05///^S X=MAXTIME"
	S DR(1,394.71,.06)=".06///^S X=MAXOCCUR"
	S DR(1,394.71,10)="10///$$GET^GMTSPDX(TRAN,DFN,SEGPTR,ROOT,(OFFSET-1),TIMLIM,OCCLIM)"
	S DR(1,394.71,20)="20///@"
	D ^DIE
	Q 0
LOWER(STRING)	;CONVERT UPPERCASE TO LOWERCASE
	;INPUT  : STRING - Text string to convert
	;OUTPUT : string - Same text string in all lowercase
	;
	Q $TR($G(STRING),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
FIRSTUP(TEXT)	;FIRST CHARACTER EVERY WORD UPPER
	;INPUT  : TEXT - Text string to convert
	;OUTPUT : Text - Same text string with beginning of every word
	;                in uppercase and all other characters in lowercase
	;
	;CHECK INPUT
	Q:($G(TEXT)="") ""
	;DECLARE VARIABLES
	N OUTTEXT,SPOT,UPCHAR,X,Y,LEN
	;CONVERT TO LOWERCASE
	S OUTTEXT=$$LOWER(TEXT)
	;CAPITALIZE FIRST WORD
	S X=$E(OUTTEXT,1)
	X ^%ZOSF("UPPERCASE")
	S OUTTEXT=Y_$E(OUTTEXT,2,$L(OUTTEXT))
	;CAPITALIZE REST OF WORDS
	S SPOT=1
	S LEN=$L(OUTTEXT)
	F  S SPOT=$F(OUTTEXT," ",SPOT) Q:('SPOT)  D
	.S X=$E(OUTTEXT,SPOT)
	.X ^%ZOSF("UPPERCASE")
	.S OUTTEXT=$E(OUTTEXT,1,(SPOT-1))_Y_$E(OUTTEXT,(SPOT+1),LEN)
	Q OUTTEXT

GMTSPL
GMTSPL	;SLC/JER - Print/Queue HS for Patient Lists ;11/14/94  17:18
	;;2.7;Health Summary;;Oct 20, 1995
	; Call with:  GMTSTYP=Ptr to file 142, and
	; GMTSSC=Ptr to file 44^Hosp Loc Name^Hosp Loc Type^
	;     Optional begin Visit/Surgery Date^Optional end Visit/Surgery Date
	; GMTSSC()=GMTSSC - An array for multiple locations (GMTSPD)
	; [GMPSAP]=Optional flag set to 1 if OP Rx Action Profile is to print
MAIN	; Controls for processing multiple locations
	N MULTLOC
	I +$O(GMTSSC(0))'>0 D MAINCTRL
	I +$O(GMTSSC(0)) D
	. S MULTLOC=0
	. F  S MULTLOC=$O(GMTSSC(MULTLOC)) Q:+MULTLOC'>0!$D(DIROUT)  D
	. . S GMTSSC=GMTSSC(+MULTLOC)
	. . D MAINCTRL
	Q
MAINCTRL	; Controls Branching
	N DFN,GMTDFN,GMLTYPE,GMTSLTR,GMPNM,PSOPAR,PSONOPG,PSOINST,PSTYPE
	K ^TMP("GMTSPL",$J)
	U IO
	S GMLTYPE=$P(GMTSSC,U,3)
	I GMLTYPE="C" D CLINIC(GMTSSC)
	I GMLTYPE="W" D WARD(GMTSSC)
	I GMLTYPE="OR" D OR(GMTSSC)
	I $L($P(GMTSSC,U,2)),($E(IOST,1)'="C") S GMTSLTR=$E($P(GMTSSC,U,2),1,10) D ^GMTSLTR
	I $O(^TMP("GMTSPL",$J,0))="" D NOPAT($P(GMTSSC,U,2)) Q
	S GMPNM="" F  S GMPNM=$O(^TMP("GMTSPL",$J,GMPNM)) Q:(GMPNM="")!($D(DIROUT))  D
	. S GMTDFN=0 F  S GMTDFN=$O(^TMP("GMTSPL",$J,GMPNM,GMTDFN)) Q:(GMTDFN'>0)!($D(DIROUT))  D
	. . N GMDUOUT
	. . S DFN=GMTDFN D DRIVER Q:$D(DIROUT)!+$G(GMDUOUT)
	. . I +$G(GMPSAP) D
	. . . S (PSTYPE,PSONOPG)=1
	. . . S $P(PSOPAR,U)=$S($P($G(^GMT(142.99,1,0)),U,5)="Y":1,1:0)
	. . . S PSOINST=$S(+$G(PSOINST):PSOINST,1:+$P($G(^DIC(4,+$P($G(^XMB(1,1,"XUS")),U,17),99)),U))
	. . . D DFN^PSOSD1,PAGE
	K ^TMP("GMTSPL",$J)
	Q
PAGE	; Pause at BOP for interactive users
	N DIR,X,Y
	Q:$E(IOST)'="C"
	I IOSL>($Y+5) F  W ! Q:IOSL<($Y+6)
	S DIR(0)="FO^1:1",DIR("A")="Press RETURN to continue or '^' to exit"
	S DIR("?")="Enter '^' to quit present report or '^^' to quit to menu"
	D ^DIR
	Q
NOPAT(LOC)	; Handles selection of unpopulated Hospital location
	N %,%H,%I,%T,%Y,GMTS,GMTSDTM,GMTSHDR,GMTSPG,GMTSTITL,GMTSDTM,GMTSLFG,X,Y
	D NOW^%DTC S X=% D REGDTM^GMTSU S GMTSDTM=X
	S DIC=142,DIC(0)="NXF",X=+GMTSTYP D ^DIC K DIC
	S GMTSTITL=$S($D(^GMT(142,+Y,"T")):^("T"),1:$P(Y,U,2)),GMTSLFG=1
	W @IOF D HEADER^GMTSUP W !!,"No Patients found at ",LOC," location.",!
	Q
CLINIC(LOC)	; Gets list of next-day appointments for selected clinic
	N %,%H,%I,%T,%Y,DFN,GMI,GMJ,X,X1,X2,VDT,Y,GMPNM,GMDT
	S VDT=+$P(LOC,U,4)
	I 'VDT D NOW^%DTC S VDT=X
	S X1=$S(+$P(LOC,U,5)>0:$P(LOC,U,5),1:VDT),X2=1 D C^%DTC
	S GMI=VDT F  S GMI=$O(^SC(+LOC,"S",GMI)) Q:+GMI'>0!(GMI>X)  D
	. S GMJ=0 F  S GMJ=$O(^SC(+LOC,"S",GMI,1,GMJ)) Q:+GMJ'>0  D
	. . I '$L($P($G(^SC(+LOC,"S",GMI,1,GMJ,0)),U,9)) D
	. . . S DFN=+$G(^SC(+LOC,"S",GMI,1,GMJ,0)) Q:DFN'>0
	. . . S GMPNM=$P($G(^DPT(+DFN,0)),U)
	. . . N X
	. . . S X=+GMI D REGDT^GMTSU S GMDT=X
	. . . S ^TMP("GMTSPL",$J,GMPNM,+DFN)=$S($D(^TMP("GMTSPL",$J,GMPNM,+DFN)):^(+DFN)_", "_GMDT,1:GMDT)
	Q
WARD(LOC)	; Gets list of patients for a specified ward
	N DFN,GMLOC,X,Y,GMDT
	S GMLOC=$P($G(^DIC(42,+$G(^SC(+LOC,42)),0)),U)
	I $S('$L(GMLOC):1,'$O(^DPT("CN",GMLOC,0)):1,1:0) Q
	S DFN=0 F  S DFN=$O(^DPT("CN",GMLOC,DFN)) Q:+DFN'>0  D
	. N X
	. S X=+$G(DT) D REGDT^GMTSU S GMDT=X
	. S ^TMP("GMTSPL",$J,$P($G(^DPT(+DFN,0)),U),+DFN)=GMDT
	Q
OR(LOC)	; Gets list of patients scheduled for surgery on specified date
	N DFN,GMI,GMJ,GMPNM,GMDT,%,%H,%I,%T,%Y,X,X1,X2,Y
	S GMI=+$O(^SRS("B",+LOC,0)) I +GMI'>0 G ORX
	S GMBEG=$P(LOC,U,4)-.0001,GMEND=$S(+$P(LOC,U,5)>0:$P(LOC,U,5),1:$P(LOC,U,4))
	F  S GMBEG=$O(^SRF("AOR",+GMI,+GMBEG)) Q:+GMBEG'>0!(+GMBEG>+GMEND)  D
	. S GMJ=0 F  S GMJ=$O(^SRF("AOR",+GMI,+GMBEG,GMJ)) Q:+GMJ'>0  D
	. . S DFN=+$G(^SRF(+GMJ,0)) Q:DFN'>0
	. . S GMPNM=$P($G(^DPT(+DFN,0)),U)
	. . N X
	. . S X=+GMBEG D REGDT^GMTSU S GMDT=X
	. . S ^TMP("GMTSPL",$J,GMPNM,+DFN)=$S($D(^TMP("GMTSPL",$J,GMPNM,+DFN)):^(+DFN)_", "_GMDT,1:GMDT)
ORX	Q
DRIVER	; Sets variables necessary for GMTS1 and calls ^%ZTLOAD
	N %T,C,D0,GMTS,GMTS0,GMTS1,GMTS2,GMTSDOB,GMTSDTM,GMTSLO,GMTSLOCK,GMTSLPG
	N GMTSEG,GMTSEGC,GMTSEGI,GMTSPNM,GMTSRB,GMTSSN,GMTSTITL,GMTSWARD,GMTSX
	N GMTSAGE,GMTSTOF,GMW,I,SEX,VA,VADM,VAIN,VAINDT,VAROOT,X,Y
	S GMTSCDT(0)=^TMP("GMTSPL",$J,GMPNM,+DFN)
	S DIC=142,DIC(0)="NXF",X=GMTSTYP D ^DIC K DIC
	S GMTSTITL=$S($G(^GMT(142,+Y,"T"))]"":^("T"),1:$P(Y,U,2))
	D:$D(GMTSEG)'>9 SELTYP1^GMTS D EN^GMTS1
	Q

GMTSPLST
GMTSPLST	;SLC/DJP - Problem List HS Component Driver ;5/27/93
	;;2.7;Health Summary;;Oct 20, 1995
ACTIVE	;Get active problems
	N STATUS
	S STATUS="A"
	D MAIN
	Q
INACT	;Get inactive problems
	N STATUS
	S STATUS="I"
	D MAIN
	Q
ALL	;Get active and inactive problems
	N STATUS
	S STATUS="ALL"
	D MAIN
	Q
MAIN	;Driver
	D GETLIST^GMPLHS(DFN,STATUS)
	Q:'$D(^TMP("GMPLHS",$J))
	D SUBHDR
	D WRT
	K ^TMP("GMPLHS",$J)
	Q
	;
WRT	; Writes Problem List Component,X
	N GMREC,GMTSICL,GMTAB,DIWL
	S GMTSICL=30 ;# of blank columns for problem
	S DIWL=0 ;used in TXTFMT call & to print returned data
	S GMTAB=0 ;Used to offset data from TXTFMT call after 1st line
	S GMREC=0
	F  S GMREC=$O(^TMP("GMPLHS",$J,GMREC)) Q:GMREC'>0  D  Q:$D(GMTSQIT)
	. N GMNODE,DIAG,LASTMDT,STAT,ONSETDT,PROV,SERV,RESDT,NARR,GMICD
	. N ADDINFO,GMTSX,X
	. S GMNODE=$G(^TMP("GMPLHS",$J,GMREC,0))
	. Q:GMNODE']""
	. S DIAG=$P(GMNODE,U),LASTMDT=$P(GMNODE,U,2),STAT=$P(GMNODE,U,5)
	. S X=LASTMDT D REGDT^GMTSU S LASTMDT=X
	. S ONSETDT=$P(GMNODE,U,6),PROV=$P(GMNODE,U,7)
	. S RESDT=$P(GMNODE,U,10),GMICD=""
	. I STAT="A",+ONSETDT S X=ONSETDT D REGDT^GMTSU S ADDINFO="Onset "_X
	. I STAT="I",+RESDT S X=RESDT D REGDT^GMTSU S ADDINFO="Resolved "_X
	. S:$G(GMPXNARR)'="N" NARR=$G(^TMP("GMPLHS",$J,GMREC,"N"))
	. I $G(GMPXICDF)]"",$G(GMPXICDF)'="N",DIAG]"" D GETICDDX^GMTSPXU1(.DIAG,$G(GMPXICDF)) S GMICD=DIAG
	. I $G(NARR)]"" S NARR=NARR_$S($G(ADDINFO)]"":", "_ADDINFO,1:"")
	. E  S NARR=$G(ADDINFO)
	. D TXTFMT^GMTSPXU1(GMICD,$G(NARR),GMTSICL,GMTAB,DIWL)
	. I '$D(^UTILITY($J,"W")) Q
	. S GMTSX=0,LINE1=1
	. F  S GMTSX=$O(^UTILITY($J,"W",DIWL,GMTSX)) Q:GMTSX'>0!$D(GMTSQIT)  D
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG D SUBHDR2
	. . I LINE1 W:STATUS="ALL" STAT W ?3,$G(^UTILITY($J,"W",DIWL,GMTSX,0)),?55,LASTMDT,?65,$E(PROV,1,15),!
	. . E  W ?3,$G(^UTILITY($J,"W",DIWL,GMTSX,0)),!
	. . S LINE1=0
	. D DSPCOMM
	. W !
	Q
DSPCOMM	;Comments are displayed if there are any
	N LOC,GMR,NODE,DATE,X
	S LOC=""
	F  S LOC=$O(^TMP("GMPLHS",$J,GMREC,"C",LOC)) Q:LOC']""  D  Q:$D(GMTSQIT)
	. S GMR=0
	. F  S GMR=$O(^TMP("GMPLHS",$J,GMREC,"C",LOC,GMR)) Q:GMR'>0  D  Q:$D(GMTSQIT)
	. . S NODE=$G(^TMP("GMPLHS",$J,GMREC,"C",LOC,GMR,0))
	. . Q:NODE']""
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG D SUBHDR2
	. . W ?5,$P(NODE,U),?68,!
	Q
SUBHDR	; Subheader for Problem List Component
	N NUM,TOT,NODE
	S NODE=$G(^TMP("GMPLHS",$J,STATUS,0))
	S NUM=$P(NODE,U),TOT=$P(NODE,U,2)
	D CKP^GMTSUP Q:$D(GMTSQIT)
	S:TOT>NUM NUM=NUM_" of "_TOT
	W ?50,NUM_$S(STATUS="A":" Active",STATUS="I":" Inactive",1:"")_" Problems",!
SUBHDR2	;Will be written on new pages
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W:STATUS="ALL" "ST"
	W ?3,"PROBLEM",?55,"LAST MOD",?65,"PROVIDER",!
	Q

GMTSPLSZ
GMTSPLSZ	;SLC/SBW - Updated Problem List 2.0 extract routine. in HS namespace ;18/Apr/95
	;;2.7;Health Summary;;Oct 20, 1995
GMPLHS	;SLC/MKB,DJP,SBW - Extract for Prob List-Health Summary 2.7 ;15/APR/95
	;;2.0;Problem List;;Aug 25, 1994
GETLIST(GMPDFN,STATUS)	; Define list 
	N GMPLIST,GMPLVIEW,GMPARAM,GMPTOTAL
	K ^TMP("GMPLHS",$J)
	Q:+GMPDFN'>0
	S GMPARAM("QUIET")=1,GMPARAM("REV")=$P($G(^GMPL(125.99,1,0)),U,5)="R"
	S GMPLVIEW("ACT")=STATUS,GMPLVIEW("PROV")=0,GMPLVIEW("VIEW")=""
	D GETPLIST^GMPLMGR1(.GMPLIST,.GMPTOTAL,.GMPLVIEW)
BUILD	; Build list for selected patient
	; Returns ^TMP("GMPLHS",$J,STATUS,0) = GMPCNT ^ GMPTOTAL
	N IFN,GMPCNT,NUM
	S (NUM,GMPCNT)=0
	F  S NUM=$O(GMPLIST(NUM)) Q:NUM'>0  D
	. S IFN=+GMPLIST(NUM) Q:IFN'>0
	. D GETPROB(IFN)
	I $G(GMPCNT)'>0 K ^TMP("GMPLHS",$J) Q
	S ^TMP("GMPLHS",$J,STATUS,0)=GMPCNT_U_GMPTOTAL ; # entries extracted ^ # entries that exist
	Q
GETPROB(IFN)	; Get problem data and set it to ^TMP array
	; Returns ^TMP("GMPLHS",$J,CNT,0)
	; Returns ^TMP("GMPLHS",$J,CNT,IFN,"N")
	N DIC,DIQ,DR,DA,REC,DIAG,LASTMDT,NARR,SITE,ENTDT,STAT,ONSETDT,RPROV
	N SERV,SERVABB,RESDT,CLIN,RECDT
	S DIC=9000011,DA=IFN,DIQ="REC(",DIQ(0)="IE"
	S DR=".01;.03;.05;.06;.08;.12;.13;1.05;1.06;1.07;1.08;1.09"
	D EN^DIQ1
	S DIAG=REC(9000011,DA,.01,"I")
	S LASTMDT=REC(9000011,DA,.03,"I")
	S NARR=REC(9000011,DA,.05,"E")
	S SITE=REC(9000011,DA,.06,"E")
	S ENTDT=REC(9000011,DA,.08,"I")
	S STAT=REC(9000011,DA,.12,"I")
	S ONSETDT=REC(9000011,DA,.13,"I")
	S RPROV=REC(9000011,DA,1.05,"E")
	S SERV=REC(9000011,DA,1.06,"E")
	S SERVABB=$$SERV(REC(9000011,DA,1.06,"I"),SERV)
	S RESDT=REC(9000011,DA,1.07,"I")
	S CLIN=REC(9000011,DA,1.08,"E")
	S RECDT=REC(9000011,DA,1.09,"I")
	S GMPCNT=GMPCNT+1 ; # of problems included in the extract
	S ^TMP("GMPLHS",$J,GMPCNT,0)=DIAG_U_LASTMDT_U_SITE_U_ENTDT_U_STAT_U_ONSETDT_U_RPROV_U_SERV_U_SERVABB_U_RESDT_U_CLIN_U_RECDT
	S ^TMP("GMPLHS",$J,GMPCNT,"N")=NARR
	D GETCOMM(IFN,GMPCNT)
	Q
GETCOMM(IFN,CNT)	;Get active comments for a note
	; Returns ^TMP("GMPLHS",$J,CNT,"C",LOCATION,NOTE NMBR,0))
	N IFN2,IFN3,LOC,NODE
	S LOC=0
	Q:$D(^AUPNPROB(IFN,11))'>0
	S IFN2=0
	F  S IFN2=$O(^AUPNPROB(IFN,11,IFN2)) Q:IFN2'>0  D
	. Q:$D(^AUPNPROB(IFN,11,IFN2,11))'>0
	. S LOC=+$G(^AUPNPROB(IFN,11,IFN2,0))
	. S IFN3=0
	. F  S IFN3=$O(^AUPNPROB(IFN,11,IFN2,11,IFN3)) Q:IFN3'>0  D
	. . S NODE=$G(^AUPNPROB(IFN,11,IFN2,11,IFN3,0))
	. . Q:$P(NODE,U,4)']""
	. . S ^TMP("GMPLHS",$J,CNT,"C",LOC,$P(NODE,U),0)=$P(NODE,U,3)_U_$P(NODE,U,5)_U_$P($G(^VA(200,+$P(NODE,U,6),0)),U)
	Q
SERV(X,SERV)	; Return service name abbreviation
	N ABBREV
	S ABBREV=$P($G(^DIC(49,+X,0)),U,2)
	I ABBREV="" S ABBREV=$E($G(SERV),1,5)
	Q ABBREV

GMTSPN
GMTSPN	;SLC/DJP - Progress Note Component ;10/6/94  17:11 ;
	;;2.7;Health Summary;;Oct 20, 1995
LKUP	;Searches thru "AC" x-ref of ^GMR(121
	S (GMTSIDT,GMTSFN,GMTSCTR)=0 I GMTS1'=6666666 S GMTSIDT=GMTS1
LOOP1	;Sorts thru "AC" x-ref of ^GMR(121
	F GMROOT="^GMR(121)","^YSP(606)" Q:$D(GMTSQIT)  F  S GMTSIDT=$O(@GMROOT@("AC",DFN,GMTSIDT)) Q:GMTSIDT=""  S GMTYPE=$S(GMROOT="^YSP(606)":"^YSP(606.5)",1:"^GMR(121.1)") D LOOP2 Q:$D(GMTSQIT)
	Q
LOOP2	;Tests date range, occurance counter, finds ien, checks for corrections.
	I (GMTSIDT<GMTS1)!(GMTSIDT>GMTS2) Q
	F  S GMTSFN=$O(@GMROOT@("AC",DFN,GMTSIDT,GMTSFN)) Q:GMTSFN=""  D VAR Q:$D(QT)  I '$D(QT1) D  Q:$D(GMTSQIT)
	.D PRT Q:$D(GMTSQIT)  D ESLN^GMTSPNS Q:$D(GMTSQIT)
	.I GMROOT["Y" D:$G(@GMROOT@(GMTSFN,5)) COSIGN^GMTSPNS Q:$D(GMTSQIT)
	.I GMROOT["G" D:$P($G(@GMROOT@(GMTSFN,5)),"^",2) COSIGN^GMTSPNS Q:$D(GMTSQIT)
	.D:$D(@GMROOT@(GMTSFN,70)) CORRECT Q:$D(GMTSQIT)
	Q
END	K DIWF,DIWL,DIWR,GMROOT,G2,GMTSIDT,GMTSFN,GMTSPRT,GMTSCTR,GMTSPT,GMTSPRT,PRINT,GMTSLN,QT,QT1,STL,TYPE,TITLE,G,I1,I2,P1,P2,P3,X
	K GMTSNDT,GMTSIG,GMTSPN0,GMTSTLE,GMTSCO,GMTSPN5,GMTSPN1,GMTSIGN,FLAG1,GMTYPE
	Q
VAR	S GMTSCTR=GMTSCTR+1 I $D(GMTSNDM),(GMTSNDM>0) I GMTSCTR>GMTSNDM S QT=1 Q
	S X=$P(@GMROOT@(GMTSFN,0),U,3) D REGDTM^GMTSU S GMTSNDT=X
VAR1	;Set up variables
	S GMTSIGN=$P(^VA(200,$P(@GMROOT@(GMTSFN,1),"^",2),20),"^",2)
	S GMTSTLE=$P(^VA(200,$P(@GMROOT@(GMTSFN,1),"^",2),20),"^",3)
	S GMTSPN0=$G(^GMR(121,GMTSFN,0)),GMTSPN1=$G(^GMR(121,GMTSFN,1)),GMTSPN5=$G(^GMR(121,GMTSFN,5))
	S:(GMROOT["Y") TYPE=$P(@GMTYPE@($P(@GMROOT@(GMTSFN,1),"^",1),0),"^",1)
	S:(GMROOT["G") TITLE=$P(^GMR(121,GMTSFN,1),"^"),TYPE=$P(^GMR(121.2,+TITLE,0),"^",2),TYPE=$P(^GMR(121.1,+TYPE,0),"^",1)
	K QT1 S PRINT=$S(TYPE="SOAP - GENERAL NOTE":"SBODY^GMTSPN2",TYPE="ADMISSION ASSESSMENT":"ABODY^GMTSPN2",TYPE="FINAL DISCHARGE NOTE":"DBODY^GMTSPN2",1:"GBODY") I TYPE="CRISIS"!(TYPE="CLINICAL WARNING") S QT1=1,GMTSCTR=GMTSCTR-1 Q
	I (GMROOT["Y") S G2=$S($D(@GMROOT@(GMTSFN,1)):$P(^(1),"^",5),1:"") I G2'="" S TYPE=G2 K G2
	I GMROOT["G" S TYPE=$P(^GMR(121.2,TITLE,0),"^")
	Q
PRT	Q:$D(QT)  I GMTSNPG=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	D CKP^GMTSUP Q:$D(GMTSQIT)  W GMTSNDT,?21,"Title: "_$E(TYPE,1,45) I $D(^GMR(121,GMTSFN,70)) W !," * Amended *",! S FLAG1=1
	I FLAG1=0 W ! D @PRINT Q
	D @PRINT S FLAG1=0
	Q
TEXT	;Printing text (GMTSFN=IEN, GMTSPT=Type of Text; GMTSLN=Int. Line NO)
	D CKP^GMTSUP Q:$D(GMTSQIT)
	K ^UTILITY($J,"W") S GMTSLN=0 F  S GMTSLN=$O(@GMROOT@(GMTSFN,GMTSPT,GMTSLN)) Q:'GMTSLN  S GMTSPRT=@GMROOT@(GMTSFN,GMTSPT,GMTSLN,0) D FORMAT
	I $D(^UTILITY($J,"W")) F GMTSLN=1:1:^UTILITY($J,"W",3) D LINE Q:$D(GMTSQIT)
	K ^UTILITY($J,"W")
	Q
FORMAT	; Formats each line for justified column width
	S DIWL=3,DIWR=80,DIWF="N",X=GMTSPRT D ^DIWP
	Q
LINE	; Writes formatted lines of text
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ^UTILITY($J,"W",DIWL,GMTSLN,0),!
	Q
GBODY	;General Note Print
	Q:$D(GMTSQIT)  S GMTSPT=10 D TEXT
	Q
CORRECT	;Appends corrections to note
	Q:$D(GMTSQIT)  S COR=0,HFN=GMTSFN
	F  S COR=$O(@GMROOT@(GMTSFN,70,COR)) Q:'COR  S GMTSFN=$P(@GMROOT@(GMTSFN,70,COR,0),"^",1) D VAR1 Q:$D(QT)  D   Q:$D(GMTSQIT)  S GMTSFN=HFN
	.D CORPT Q:$D(GMTSQIT)  D @PRINT Q:$D(GMTSQIT)  D ESLN^GMTSPNS Q:$D(GMTSQIT)
	.I GMROOT["Y" D:$G(@GMROOT@(GMTSFN,5)) COSIGN^GMTSPNS
	.I GMROOT["G" D:$P($G(@GMROOT@(GMTSFN,5)),"^",2) COSIGN^GMTSPNS
	S GMTSFN=HFN K COR,HFN,CDT Q
CORPT	S X=$P(@GMROOT@(GMTSFN,0),"^",3) D REGDTM^GMTSU S CDT=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,CDT,?21,"Addendum:",! Q
PN	;Entry point
	S FLAG1=0
	D LKUP I $D(GMTSQIT) D END Q
	D END Q

GMTSPN1
GMTSPN1	;SLC/DJP - Progress Note Component - Print Variables ;9/28/92  13:55
	;;2.7;Health Summary;;Oct 20, 1995
CHECK	;Checks for data within a global node and sets print variable
DXLS	; Loads diagnoses into G( array (esp., DXLS)
	S G1=$S($D(@GMROOT@(GMTSFN,30)):$P(^(30),"^",1),1:""),G("DXLS")=$S(G1'="":"DXLS:",1:"")
	I G("DXLS")'="" D
	.N P1,P2,P3,P4
	.S G("DX")=""
	.S P1=$P(G1,";",2) ;    Global reference
	.S P2=$P(G1,";",1) ;    IEN
	.S P3="^"_P1_P2_","_0_")" ;^(0) reference
	.S P4="^"_P1_P2_",""D"")" ;^("D") reference
	.I P1["ICD9" D  Q
	..S G("DX")=$P(@P3,U,3)_"  ("_$P(@P3,U)_")"
	.I P1["YSD" D  Q
	..S P4=$G(@P4) Q:P4']""
	..S G("DX")=P4
	..S P3=$P($G(@P3),U)
	..S:P3]"" G("DX")=G("DX")_"  ("_P3_")"
	.I P1["DIC" D
	..S G("DX")=$P(@P3,U)_"  ("_$P(@P3,U,2)_")"
	K G1
	S G1=$S($D(@GMROOT@(GMTSFN,30)):$P(^(30),"^",2),1:""),G("DBS")=$S(G1'="":"Discharge Bedsection:",1:"") I G1'="" S G("BS")=$P(^DIC(42,G1,0),"^",1) K G1
	S G1=$S($D(@GMROOT@(GMTSFN,32)):$P(^(32,0),"^",3),1:""),G("DIAG")=$S(G1'="":"Other DX:",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,33)):$P(^(33,0),"^",5),1:""),G("OP")=$S(G1'="":"Operations/Procedures: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,34)):$P(^(34,0),"^",5),1:""),G("INST")=$S(G1'="":"Instructions Given Patient: ",1:"") K G1
	Q
ADMIN	; Loads G( array with Admission/Assessment information
	S G1=$S($D(@GMROOT@(GMTSFN,40)):$P(^(40,0),"^",5),1:""),G("EMOT")=$S(G1'="":"Emotional State: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,41)):$P(^(41,0),"^",5),1:""),G("BEHAV")=$S(G1'="":"Behavioral Assessment: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,42)):$P(^(42,0),"^",5),1:""),G("SS")=$S(G1'="":"Social Status: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,43)):$P(^(43,0),"^",5),1:""),G("REHAB")=$S(G1'="":"Rehabilitation Potential: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,44)):$P(^(44,0),"^",5),1:""),G("EMPL")=$S(G1'="":"Employment Potential: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,45)):$P(^(45,0),"^",5),1:""),G("DANG")=$S(G1'="":"Degree of Danger--Self/Others: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,46)):$P(^(46,0),"^",5),1:""),G("PHY")=$S(G1'="":"Ab Physical Findings: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,47)):$P(^(47,0),"^",5),1:""),G("IMPR")=$S(G1'="":"Initial Impresssions/Prov Dx: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,48)):$P(^(48,0),"^",5),1:""),G("STAT")=$S(G1'="":"Treatment Planned: ",1:"") K G1
	Q
SOAP	; Loads G( array with SOAP note elements
	S G1=$S($D(@GMROOT@(GMTSFN,20)):$P(^(20,0),"^",5),1:""),G("SUB")=$S(G1'="":"Subjective: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,21)):$P(^(21,0),"^",5),1:""),G("OBJ")=$S(G1'="":"Objective: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,22)):$P(^(22,0),"^",5),1:""),G("ASS")=$S(G1'="":"Assessment: ",1:"") K G1
	S G1=$S($D(@GMROOT@(GMTSFN,23)):$P(^(23,0),"^",5),1:""),G("PLAN")=$S(G1'="":"Plans: ",1:"") K G1
	Q

GMTSPN2
GMTSPN2	;SLC/DJP - Progress Note Component - Print Variables ;10/7/94  09:12
	;;2.7;Health Summary;;Oct 20, 1995
SBODY	;SOAP Note Print
	Q:$D(GMTSQIT)  W:FLAG1 ! D SOAP^GMTSPN1 I G("SUB")'="" S GMTSPT=20 D CKP^GMTSUP Q:$D(GMTSQIT)  W G("SUB"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("OBJ")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=21 W G("OBJ"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("ASS")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=22 W G("ASS"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("PLAN")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=23 W G("PLAN"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	Q
DBODY	;Final Discharge Note Print
	Q:$D(GMTSQIT)  W:FLAG1 ! D DXLS^GMTSPN1 I G("DXLS")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W G("DXLS")_" "_G("DX"),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  I G("DBS")'="" W G("DBS")_" "_G("BS"),!
	I G("DIAG")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W !,G("DIAG") D  Q:$D(GMTSQIT)
	.S GMTSLN=0
	.F  S GMTSLN=$O(@GMROOT@(GMTSFN,32,GMTSLN)) Q:'GMTSLN  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?11,@GMROOT@(GMTSFN,32,GMTSLN,0),!
	I G("OP")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=33 W !,G("OP"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("INST")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=34 W !,G("INST"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	Q
ABODY	;Admission Assessment Note Print
	Q:$D(GMTSQIT)  W:FLAG1 ! D ADMIN^GMTSPN1 I G("EMOT")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=40 W G("EMOT"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("BEHAV")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=41 W !,G("BEHAV"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("SS")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=42 W !,G("SS"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("REHAB")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=43 W !,G("REHAB"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("EMPL")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=44 W !,G("EMPL"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("DANG")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=45 W G("DANG"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("PHY")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=46 W !,G("PHY"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("IMPR")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=47 W !,G("IMPR"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	I G("STAT")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  S GMTSPT=48 W !,G("STAT"),! D TEXT^GMTSPN Q:$D(GMTSQIT)
	Q

GMTSPNB
GMTSPNB	;SLC/JER - Brief Progress Notes Component ;2/13/91  15:03
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching and execution
	N GMTSIDT,GMW,GMTSCTR,QT K ^TMP("PNB",$J)
	F GMROOT="^GMR(121)","^YSP(606)" D ^GMTSPNE
	I '$D(^TMP("PNB",$J)) Q
	D HEADER
	S (GMTSCTR,GMTSIDT,QT)=0 F  S GMTSIDT=$O(^TMP("PNB",$J,GMTSIDT)) Q:GMTSIDT'>0!(QT)  S R=^(GMTSIDT) D WRT
	K ^TMP("PNB",$J)
	Q
HEADER	; Prints header
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Prog Note DT",?16,"Title",?48,"Author",?64,"Last Corr DT",!!
	Q
WRT	; Writes the component data
	N X,DATE,TITLE,AUTHOR,CORR
	S X=+R D REGDTM^GMTSU S DATE=X,TITLE=$P(R,U,2),AUTHOR=$P($P(R,U,3),";",2),CORR=$S($L($P(R,U,4)):$P(R,U,4),1:"")
	I $L(CORR) S X=CORR D REGDTM^GMTSU S CORR=X
	I $L(TITLE)>30 D FORMAT S TITLE=^UTILITY($J,"W",1,1,0)
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEADER W DATE,?16,TITLE,?48,AUTHOR,?64,CORR,!
	I $D(^UTILITY($J,"W",1,2,0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?16,^UTILITY($J,"W",1,2,0),!
	S GMTSCTR=GMTSCTR+1 I $D(GMTSNDM),(GMTSNDM>0),(GMTSCTR=GMTSNDM) S QT=1
	Q
FORMAT	; Calls ^DIWP to format Title
	N DIWF,DIWL,DIWR,X
	S DIWF="C30R",DIWL=1,DIWR=30,X=TITLE D ^DIWP
	Q

GMTSPNE
GMTSPNE	;SLC/JER - Progress Notes Component ;2/24/92  13:14
	;;2.7;Health Summary;;Oct 20, 1995
XTRCT	N GMW,GMCNT,GMTSIDT,QUIT
	I '$D(@GMROOT@("AC",DFN)) Q
	S GMTSIDT=$S(GMTS1'=6666666:GMTS1,1:0),GMTYPE=$S(GMROOT="^YSP(606)":"^YSP(606.5)",1:"^GMR(121.1)"),(QUIT,GMCNT)=0
	F  S GMTSIDT=$O(@GMROOT@("AC",DFN,GMTSIDT)) Q:GMTSIDT'>0!(QUIT)  D LOOP
	Q
LOOP	; Loops through cross-reference to get record numbers of notes
	N GMTSFN
	I $S(GMTSIDT<GMTS1:1,GMTSIDT>GMTS2:1,1:0) Q
	S GMTSFN=0 F  S GMTSFN=$O(@GMROOT@("AC",DFN,GMTSIDT,GMTSFN)) Q:GMTSFN'>0!(QUIT)  D GETNOTE
	Q
GETNOTE	; Gets Date/time, title, type and author for each note
	N SIGNED,DATE,TYPE,TITLE,NM,PR,AUTHOR,CORR
	S DATE=$P(@GMROOT@(GMTSFN,0),U,3)
	I $D(@GMROOT@(GMTSFN,70,0)) D GETCORR
	S SIGNED=$S($P(@GMROOT@(GMTSFN,1),U,4):1,1:0) Q:'SIGNED
	S DIC=$P(GMROOT,")")_$S(GMROOT["Y":".5",1:".2")_",",DIC(0)="NX",X=+@GMROOT@(GMTSFN,1) D ^DIC K DIC
	Q:+Y'>0  S TYPE=$P(Y,U,2) I GMROOT["G" S TITLE=TYPE,TYPE=$P(^GMR(121.1,$P(^GMR(121.2,+Y,0),"^",2),0),"^")
	I $S(TYPE["CRISIS":1,TYPE["WARNING":1,1:0) Q
	I (GMROOT["Y") S TITLE=$S($P(@GMROOT@(GMTSFN,1),U,5)]"":$P(@GMROOT@(GMTSFN,1),U,5),1:TYPE)
	S (PR,IFN)=+$P(@GMROOT@(GMTSFN,1),U,2),FILE=200,NML=12,FNF=0 D NAME^GMTSU S AUTHOR=PR_";"_NM K NM
	F IDATE=(9999999-DATE):.0001 Q:'$D(^TMP("PNB",$J,IDATE))
	S:'QUIT ^TMP("PNB",$J,IDATE)=DATE_U_$E(TITLE,1,30)_U_AUTHOR,GMCNT=GMCNT+1
	I $D(CORR) S ^TMP("PNB",$J,IDATE)=^(IDATE)_U_CORR
	I $D(GMTSNDM),(GMTSNDM>0),(GMCNT=GMTSNDM) S QUIT=1
	Q
GETCORR	; Traverses Corrections multiple to get last correction date
	N CN,LCN,GMW
	S CN=0 F  S CN=$O(@GMROOT@(GMTSFN,70,CN)) Q:CN'>0  S LCN=CN
	S LCN=@GMROOT@(GMTSFN,70,LCN,0)
	S CORR=$P(@GMROOT@(LCN,0),U,3)
	Q

GMTSPNJ
GMTSPNJ	;SLC/JER - Nightly Job to Queue HS Batch Print-by-Loc ;9/28/92  13:59
	;;2.7;Health Summary;;Oct 20, 1995
	; Sets GMTSSC=location pointer,if clinic sets GMTSCDT=desired appt day
	; Summaries are considered ready Today if GMTSPNJ run time is today
	; between 24:00 and 12:00, ready Tomorrow if run time is today between
	; 12:00 and 24:00.
	; 6-23-95: Modified so that for Clinics and OR it will print out the
	;          work days in advance. Thus, if it is to print one day in
	;          advance Mondays clinics would print out on Friday. Takes
	;          into consideration Holidays based on entries in Holiday file.
MAIN	; Controls branching
	N GMTSTYP,GMTSCL,GMW,X
	S GMTSTYP=0 F  S GMTSTYP=$O(^GMT(142,GMTSTYP)) Q:+GMTSTYP'>0  D
	. S GMTSCL=0 F  S GMTSCL=$O(^GMT(142,GMTSTYP,20,GMTSCL)) Q:+GMTSCL'>0  D QUEUE
	Q
QUEUE	; Queues HS batch print for particular HS Type and Location.
	N DIC,GMPSAP,GMTSLOC,GMTSSC,GMTSIO,GMTSDYS,GMV,QUEQIT,X,Y,DAY,NEWDAY
	N GMTSQ,BEGDT,ENDDT,PDATE
	S QUEQIT=0
	S GMTSLOC=$G(^GMT(142,GMTSTYP,20,GMTSCL,0))
	S X=+GMTSLOC,DIC=44,DIC(0)="NXZ" D ^DIC
	I $S(+Y'>0:1,"WCOR"'[$P($G(Y(0)),U,3):1,1:0) Q
	S GMTSSC=Y_U_$P(Y(0),U,3)
	I "COR"[$P(GMTSSC,U,3) D  Q
	. S DAY=+$P(GMTSLOC,U,4)
	. I DAY'>0 S $P(GMTSSC,U,4)=$$GETDATE(DAY) D QCONT Q  ;Don't print in advance
	. S BEGDT=$$GETDATE(0),ENDDT=$$GETDATE(DAY)
	. Q:$$NONWDAY(BEGDT)
	. S NEWDAY=$$WKEND(DAY,BEGDT,ENDDT)
	. S PDATE=$$GETDATE(+NEWDAY) ;Get last date to be printed
	. F  D  Q:+$G(GMTSQ)
	. . S $P(GMTSSC,U,4)=PDATE ;Set variable before doing QCONT
	. . D QCONT
	. . S NEWDAY=NEWDAY-1 ; Decrement to get previous day
	. . I DAY>NEWDAY S GMTSQ=1 Q  ;Quit For Loop when non-workdays data has been printed
	. . S PDATE=$$GETDATE(+NEWDAY) ;Get date
	. . I +$$NONWDAY(PDATE)'>0 S GMTSQ=1 Q  ;Quit For Loop if there's a work
	. .; day between Holiday and Weekend. Don't print weekend data twice.
	Q
QCONT	;Used so following can be done for multiple dates for Clinics and ORs.
	I $$CKPAT^GMTSPD(GMTSSC)'>0 Q
	S GMPSAP=$S($P(GMTSLOC,U,3)="Y":1,1:0)
	S ZTIO=$$GETIO($P(GMTSLOC,U,2)) Q:'$L(ZTIO)
	S ZTDTH=$H,ZTRTN="MAIN^GMTSPL",ZTDESC="Health Summary"
	F GMV="GMTSTYP","GMTSSC","GMPSAP" S ZTSAVE(GMV)=""
	D ^%ZTLOAD
	Q
GETDATE(DAYS)	; Gets desired Visit/Surgery date
	; Receives: DAYS=Print Days ahead
	; Returns: FileMan Date/time
	N %,%H,%I,%T,GMTSDT,GMTSPM,X1,X2,X
	D NOW^%DTC S GMTSDT=$P(%,"."),GMTSPM=$S(+$E($P(%,".",2),1,2)>12:1,1:0)
	S X1=GMTSDT,X2=DAYS+GMTSPM D C^%DTC
	Q X
NONWDAY(GMTSDT)	; Determines if non work day (i.e. Sat., Sun., or Holiday) 
	; Returns 1 if print day is weekend or holiday
	N DAYNAME
	S DAYNAME=$$DOW^XLFDT(GMTSDT)
	Q $S(DAYNAME="Saturday":1,DAYNAME="Sunday":1,$$HOLIDAY(GMTSDT):1,1:0)
WKEND(DAY,BEGDT,ENDDT)	;updates days in advance for weekend and holiday dates
	N GMI,X1,X2,X,%H,DAYNAME
	F GMI=1:1 S X1=BEGDT,X2=GMI D C^%DTC Q:X>ENDDT  D
	. S DAYNAME=$$DOW^XLFDT(X)
	. I DAYNAME="Saturday"!(DAYNAME="Sunday")!($$HOLIDAY(X)) S DAY=DAY+1,ENDDT=$$GETDATE(DAY)
	.; If one of days is Saturday, Sunday, or holiday, up days by one and
	.; recalculate ending date
	Q DAY
HOLIDAY(GMDT)	;Determines if a date is a Holiday.
	; Requires that the Holiday (#40.5) file is updated to determine if
	; a date is a holiday.
	N GMDATE
	D FIND^DIC(40.5,"",.01,"QX",GMDT,1,"","","","GMDATE")
	Q +$G(GMDATE("DILIST",0))
GETIO(X)	; Get device for queueing
	N %,%Y,C,DIC,Y
	S DIC=3.5,DIC(0)="NXZ" D ^DIC S Y=$S(+Y'>0:"",1:$P(Y(0),U))
	Q Y

GMTSPNS
GMTSPNS	;SLC/DJP - Progress Note Component ;10/6/94  17:11 ;
	;;2.7;Health Summary;;Oct 20, 1995
ESLN	D CKP^GMTSUP Q:$D(GMTSQIT)
	I GMROOT["Y" W !,?28,"/es/",?36,GMTSIGN,!,?36,GMTSTLE,! S GMTSNPG=0 Q
	I $P(GMTSPN0,U,5)'=$P(GMTSPN1,U,2) D CKP^GMTSUP Q:$D(GMTSQIT)
	I $P(GMTSPN1,U,3) W !?20,"Signed by:" D
	.W:'$P(GMTSPN1,U,5) ?31,"/es/"
	.D SIGBLK($P(GMTSPN1,U,3))
	I +$G(GMTSPN5),'$P(GMTSPN5,U,2) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?36,"** REQUIRES COSIGNATURE **",! Q
	I $S('$P(GMTSPN1,U,3):1,$P(GMTSPN1,U,2)'=$P(GMTSPN1,U,3):1,1:0) D
	.D CKP^GMTSUP Q:$D(GMTSQIT)  W !?23,"AUTHOR:" D SIGBLK($P(GMTSPN1,U,2))
	D CKP^GMTSUP Q:$D(GMTSQIT)  I $P(GMTSPN1,U,5) D
	.I $P(GMTSPN0,U,5)'=$P(GMTSPN1,U,2) D CKP^GMTSUP
	.W !,"    Marked signed on chart by:"
	.D SIGBLK($P(GMTSPN1,U,5))
	Q
COSIGN	;Prints cosignature information
	S GMTSPN5=@GMROOT@(GMTSFN,5) Q:GMTSPN5=""
	I $D(@GMROOT@(GMTSFN,8,0)) D CKP^GMTSUP W !,?1,"Cosigner Comments:" S GMTSPT=8 D TEXT^GMTSPN Q:$D(GMTSQIT)
	S GMTSIGN=$P(GMTSPN5,"^",$S(GMROOT["Y":1,1:2)) Q:GMTSIGN'>0
	S GMTSIG=$P($G(^VA(200,+GMTSIGN,20)),"^",2) Q:GMTSIGN=""
	S GMTSTLE=$P($G(^VA(200,+GMTSIGN,20)),"^",3)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !,?15,"Cosigned by: " D
	.I GMROOT["Y" W ?36,GMTSIG,!?36,GMTSTLE,! S GMTSNPG=0 Q
	.W:'$P(GMTSPN5,U,4) ?29,"/es/"
	.D SIGBLK($P(GMTSPN5,U,2))
	I $P(GMTSPN5,U,4) D CKP^GMTSUP Q:$D(GMTSQIT)  D
	.S GMTSCO=$P(GMTSPN5,U,4) D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Marked cosigned on chart by:"
	.S GMTSIGN=$P($G(^VA(200,+GMTSCO,20)),"^",2) Q:GMTSCO=""
	.S GMTSTLE=$P($G(^VA(200,+GMTSCO,20)),"^",3)
	.W ?36,GMTSIGN,!,?36,GMTSTLE,!
	K GMTSPN5,GMTSIGN,GMTSIG,GMTSTLE,GMTSCO
	Q
SIGBLK(GMTSDUZ)	;signature block print
	I +GMTSDUZ'>0 Q
	N GMTSNODE S GMTSNODE=$G(^VA(200,+GMTSDUZ,20))
	W ?36,$S($P(GMTSNODE,U,2)'="":$P(GMTSNODE,U,2),1:$P($G(^VA(200,+GMTSDUZ,0)),U)),!
	I $P(GMTSNODE,U,3)'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W ?36,$P(GMTSNODE,U,3),!
	Q

GMTSPOS1
GMTSPOS1	;SLC/SBW - Smart routine installer and Comp. Disabler ;22/MAR/95
	;;2.7;Health Summary;;Oct 20, 1995
PSO	; Controls Outpatient Pharmacy install
	N GMPSOVER
	;If Health Summary is absent, then quit
	I '$L($T(^PSOHCSUM)) Q
	S GMPSOVER=$$VERSION^XPDUTL("PSO")
	D PSOINST(GMPSOVER)
	Q
PSOINST(VERSION)	; Install routine corresponding to HS version in
	;                 target account
	; If the patch is already installed, then quit w/o overwriting
	N DIE,DIF,GMMSG,X,XCN,XCNP
	I VERSION'<6.0 Q
	W !,"** Installing GMTSPSO routine for Outpatient Pharmacy component. **"
	W !,"   Outpatient Pharmacy version ",VERSION," is installed in this account.",!
	S X="GMTSPSZO",XCNP=0,DIF="^UTILITY(""GMTSPSZO""," X ^%ZOSF("LOAD") W !,"Renaming GMTSPSZO as GMTSPSO."
	S X="GMTSPSO",XCN=2,DIE="^UTILITY(""GMTSPSZO""," X ^%ZOSF("SAVE") K ^UTILITY("GMTSPSZO") W "  Done.",!
	Q
	;******************************************************
SOWK	; Controls Social Work install
	N X,GMMSG
	; Checks conditions for auto-disable of Social Work component
	I $$VERSION^XPDUTL("SOWK")<3 D
	. S GMMSG="Social Work Service version 3.0 not yet installed"
	. S X="SOCIAL WORK" D DISABLE^GMTSPOST
	I $$VERSION^XPDUTL("SOWK")>2.99 D
	. ;If Social Work extract routine for Health Summary is present, quit
	. I $L($T(^SOWKHSUM)) Q
	. W !,"** Installing SOWKHSUM routine for Social Work Component. **"
	. D SOWKINST
	Q
SOWKINST	; Install SOWKHSUM routine
	N DIE,DIF,GMMSG,X,XCN,XCNP
	S X="GMTSSOWZ",XCNP=0,DIF="^UTILITY(""GMTSSOWZ""," X ^%ZOSF("LOAD") W !,"Renaming GMTSSOWZ as SOWKHSUM."
	S X="SOWKHSUM",XCN=2,DIE="^UTILITY(""GMTSSOWZ""," X ^%ZOSF("SAVE") K ^UTILITY("GMTSSOWZ") W "  Done.",!
	Q
	;******************************************************
MED	; Controls Medicine 2.0 install and disable 2.2 components
	N X,GMMSG
	;Checks conditions for auto-disable of Medicine 2.2 components
	I $$VERSION^XPDUTL("MC")<2.2 D
	. S GMMSG="Medicine 2.2 Package not yet installed or available"
	. F X="MEDICINE ABNORMAL BRIEF","MEDICINE BRIEF REPORT","MEDICINE FULL CAPTIONED","MEDICINE FULL REPORT" D DISABLE^GMTSPOST
	. ;If Medicine 2.2 not installed, restore 2.0 medicine routines
	. W !,"** Installing GMTSMCPS routine for Medicine 2.0 component. **"
	. D MED2INST
	I $$VERSION^XPDUTL("MC")>2.19 D M22INST
	Q
MED2INST	; Install GMTSMCPS routine for med 2.0
	N DIE,DIF,GMMSG,X,XCN,XCNP
	S X="GMTSMCPZ",XCNP=0,DIF="^UTILITY(""GMTSMCPZ""," X ^%ZOSF("LOAD") W !,"Renaming GMTSMCPZ as GMTSMCPS."
	S X="GMTSMCPS",XCN=2,DIE="^UTILITY(""GMTSMCPZ""," X ^%ZOSF("SAVE") K ^UTILITY("GMTSMCPZ") W "  Done.",!
	Q
M22INST	; Install GMTSMCPS routine for med 2.2
	W !,"** Installing GMTSMCPS routine for Medicine 2.2 components. **"
	N DIE,DIF,GMMSG,X,XCN,XCNP
	S X="GMTSMCZZ",XCNP=0,DIF="^UTILITY(""GMTSMCZZ""," X ^%ZOSF("LOAD") W !,"Renaming GMTSMCZZ as GMTSMCPS."
	S X="GMTSMCPS",XCN=2,DIE="^UTILITY(""GMTSMCZZ""," X ^%ZOSF("SAVE") K ^UTILITY("GMTSMCZZ") W "  Done.",!
	Q
	;******************************************************
PL	; Controls Problem List 2.0 install
	; Checks conditions for auto-disable of Problem List components
	N X,GMMSG
	I $$VERSION^XPDUTL("GMPL")<2 D
	. S GMMSG="Problem List 2.0 Package not yet installed or available"
	. F X="PROBLEM LIST ACTIVE","PROBLEM LIST INACTIVE","PROBLEM LIST ALL" D DISABLE^GMTSPOST
	I $$VERSION^XPDUTL("GMPL")>1.99 D
	. W !,"** Installing GMPLHS routine for Problem List components. **"
	. D PLINST
	Q
PLINST	; Install GMPLHS routine
	N DIE,DIF,GMMSG,X,XCN,XCNP
	W !,"Renaming GMTSPLSZ as GMPLHS."
	S X="GMTSPLSZ",XCNP=0,DIF="^UTILITY(""GMTSPLSZ""," X ^%ZOSF("LOAD") W "."
	S X="GMPLHS",XCN=2,DIE="^UTILITY(""GMTSPLSZ""," X ^%ZOSF("SAVE") K ^UTILITY("GMTSPLSZ") W "  Done."
	Q

GMTSPOS2
GMTSPOS2	;SLC/SBW - Set PDX up to use new HS components ;11/May/95
	;;2.7;Health Summary;;Oct 20, 1995
EN	;ENTRY POINT 
	N DIE,DIF,NSPACE,PDXVER,X,XCN,XCNP
	I +$$VERSION^XPDUTL("VAQ")<1.5 Q
	W !!,"** Installing PDX Data Segments for Health Summary Components **"
	S X="VAQUTL50" X ^%ZOSF("TEST") I $T G DOIT
	W !!,"** VAQUTL50 routine not installed, will do so for you."
	S X="GMTSPDXZ",XCNP=0,DIF="^UTILITY(""GMTSPDXZ""," X ^%ZOSF("LOAD") W !,"   Renaming GMTSPDXZ as VAQUTL50."
	S X="VAQUTL50",XCN=2,DIE="^UTILITY(""GMTSPDXZ""," X ^%ZOSF("SAVE") K ^UTILITY("GMTSPDXA")
	;
	;DECLARE VARIABLES
DOIT	N ERR,POINT,COMP,DASHES,DOTS,PDXCOMP
	F COMP="PCE HEALTH FACTORS ALL","PCE OUTPATIENT ENCOUNTERS","PCE MEASUREMENTS NON-TABULAR","PCE IMMUNIZATIONS","PCE SKIN TESTS" D INSTALL
	F COMP="PCE EDUCATION","PCE EDUCATION LATEST","PCE OUTPATIENT DIAGNOSIS","PCE EXAMS LATEST","PCE TREATMENTS PROVIDED" D INSTALL
	F COMP="COMPENSATION AND PENSION EXAMS","DISCHARGE SUMMARY","DISCHARGE SUMMARY BRIEF","MAS ADT HISTORY EXPANDED","MEDICINE ABNORMAL BRIEF","MEDICINE BRIEF REPORT","MEDICINE FULL CAPTIONED","MEDICINE FULL REPORT" D INSTALL
	F COMP="PROBLEM LIST ALL","PROBLEM LIST ACTIVE","PROBLEM LIST INACTIVE","MENTAL HEALTH PHYSICAL EXAM","SOCIAL WORK","LAB ELECTRON MICROSCOPY","ADVERSE REACTIONS/ALLERG BRIEF" D INSTALL
	W !,"Done installing PDX Data Segments....",!
	Q
INSTALL	;Install components
	;CONVERT TO PDX SEGMENT NAME
	S PDXCOMP=$$FIRSTUP^VAQUTL50(COMP)
	;GET POINTER TO COMPONENT
	S POINT=+$O(^GMT(142.1,"B",COMP,0))
	I ('POINT) D  Q
	.W !!,$C(7),COMP," not found in HEALTH SUMMARY COMPONENT file."
	.W !,PDXCOMP," not added to VAQ - DATA SEGMENT file.",$C(7)
	;CREATE DATA SEGMENT USING DEFAULT TIME & OCCURRENCE LIMITS
	S ERR=$$ADDSEG^VAQUTL50(POINT)
	I (ERR<0) W !,?5,$P(ERR,"^",2),$C(7) Q
	W !?3,PDXCOMP," added to VAQ - DATA SEGMENT file (#394.71)."
	W !
	Q

GMTSPOST
GMTSPOST	;SLC/JER - Post-init for Health Summary ;11/18/92  11:23
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching and execution
	N GMI,INCLUDE,GMTSEG,GMTSI,GMTSIFN,GMTJ,GMTSNM
	W !!,"Starting post-init action now...."
	D SPOOL,PARAM
	D INPHAR,DIET,OERR,VITALS,LAB,RAD,MHPE,PRGNOTE,SURG,DCS,CP,PL^GMTSPOS1,PCE,MED^GMTSPOS1,PSO^GMTSPOS1,OUTPHAR,SOWK^GMTSPOS1
	D EN^GMTSPOS2
	K ^GMT(142,12,1,"C") ;Get rid of "C" xref in case there are duplicate entries
	W !!,"'C' cross-reference on the GMTS AD HOC OPTION type in file 142 deleted."
	W !,"It will be rebuilt"
	S INCLUDE=0 D ENPOST^GMTSLOAD
	D ^GMTSONIT
	W !!,"Post-init successfully completed."
	D FINITO
	K GMTSIST
	Q
SPOOL	; Convert spool name to pointer value
	N DIC,DIE,DA,X
	S X=$P($G(^GMT(142.99,1,0)),U,4)
	Q:+X!(X']"")  ;Quit is Spool Device is null or a numeric value
	S DIC=3.5,DIC(0)="X"
	D ^DIC
	W !!,"Converting "_X_" to a pointer value for Spool Device in Site Parameter file."
	I +Y'>0 D  Q
	. W !,"** Can't converted "_X_" to a pointer value. **"
	. W !,"Enter a Valid Spool Device using 'Edit Health Summary Site Parameters' option."
	S $P(^GMT(142.99,1,0),U,4)=+Y
	W !,X," converted successfully."
	Q
PARAM	; Convert YES/NO codes from 1/0 to Y/N
	N GMNUM,X
	F GMNUM=2,3,5 D
	. S X=$P($G(^GMT(142.99,1,0)),U,GMNUM)
	. Q:X']""!(X="Y")!(X="N")  ;Quit there is not entry or it is "Y" or "N"
	. I X=0 S $P(^GMT(142.99,1,0),U,GMNUM)=""
	. I X=1 S $P(^GMT(142.99,1,0),U,GMNUM)="Y"
	Q
INPHAR	; Checks conditions auto-disable of Inpatient Pharmacy components
	N GMMSG,X
	S X="PSJEEU0"
	X ^%ZOSF("TEST")
	Q:$T
	F X="PHARMACY INTRAVENOUS","PHARMACY UNIT DOSE" S GMMSG="Inpatient Medications not yet available" D DISABLE
	Q
OUTPHAR	; Checks conditions auto-disable of Outpatient Pharmacy components
	N GMMSG,X
	S X="PSOHCSUM"
	X ^%ZOSF("TEST")
	Q:$T
	F X="PHARMACY OUTPATIENT" S GMMSG="Outpatient Pharmacy not yet available" D DISABLE
	Q
DIET	; Checks conditions auto-disable of Dietetics
	N GMMSG,X
	S X="FHWHEA"
	X ^%ZOSF("TEST")
	Q:$T
	F X="DIETETICS" S GMMSG="Dietetics not yet available" D DISABLE
	Q
OERR	; Checks conditions auto-disable of OERR Orders
	N GMMSG,X
	S X="ORF4"
	X ^%ZOSF("TEST")
	Q:$T
	F X="ORDERS CURRENT" S GMMSG="OE/RR Orders not yet available" D DISABLE
	Q
VITALS	; Checks conditions auto-disable of Vitals
	N GMMSG,X
	S X="GMRVUT0"
	X ^%ZOSF("TEST")
	Q:$T
	F X="VITAL SIGNS","VITAL SIGNS SELECTED" S GMMSG="Vital Signs not yet available" D DISABLE
	Q
PRGNOTE	; Checks conditions auto-disable of Progress Note components
	N GMMSG,X
	I ($D(^YSP(606))<10),($D(^GMR(121))<10) F X="PROGRESS NOTES","PROGRESS NOTES BRIEF" S GMMSG="Progress Notes not yet available" D DISABLE
	I $D(^GMR(121))<10 F X="ADVANCE DIRECTIVE","CLINICAL WARNINGS","CRISIS NOTES" S GMMSG=X_" not yet available" D DISABLE
	Q
SURG	; Checks conditions for auto-disable of Surgery component
	N X,GMMSG
	I $D(^SRF)<10 F X="SURGERY REPORTS","SURGERY REPORTS BRIEF" S GMMSG="Surgery Package not yet installed" D DISABLE
	Q
DCS	; Checks conditions for auto-disable of Discharge Summary components
	N X,GMMSG
	I $D(^GMR(128))<10 D
	. S GMMSG="Discharge Summary Package not yet installed or available"
	. F X="DISCHARGE SUMMARY","DISCHARGE SUMMARY BRIEF"  D DISABLE
	Q
CP	; Checks conditions for auto-disable of Compensation and Pension component
	N X,GMMSG
	; Checks conditions for auto-disable of Comp & Pen component
	I +$$VERSION^XPDUTL("DVBA")<2.7 D
	. S GMMSG="Requires AMIE version 2.7"
	. S X="COMPENSATION AND PENSION EXAMS" D DISABLE^GMTSPOST
	Q
LAB	; Checks condition for auto-disable of Lab components
	N GMMSG,X
	I $$VERSION^XPDUTL("LR")<5.1 D
	. S GMMSG="Requires Lab version 5.1 or later"
	. F X="LAB BLOOD AVAILABILITY","LAB BLOOD TRANSFUSIONS","LAB CHEMISTRY & HEMATOLOGY","LAB CUMULATIVE SELECTED","LAB CUMULATIVE SELECTED 1" D DISABLE^GMTSPOST
	. F X="LAB CUMULATIVE SELECTED 2","LAB CUMULATIVE SELECTED 3","LAB CUMULATIVE SELECTED 4","LAB CYTOPATHOLOGY","LAB ELECTRON MICROSCOPY","LAB MICROBIOLOGY" D DISABLE^GMTSPOST
	. F X="LAB MICROBIOLOGY BRIEF","LAB ORDERS","LAB ORDERS BRIEF","LAB SURGICAL PATHOLOGY","LAB TESTS SELECTED" D DISABLE^GMTSPOST
	Q
RAD	; Checks condition for auto-disable of Radiology
	N GMMSG,X
	I $$VERSION^XPDUTL("RA")<3 D
	. S GMMSG="Requires Radiology version 3 or later"
	. F X="RADIOLOGY IMPRESSION","RADIOLOGY IMPRESSION SELECTED","RADIOLOGY PROFILE","RADIOLOGY STATUS" D DISABLE^GMTSPOST
	Q
MHPE	; Checks condition for auto-disable of Mental Health
	N GMMSG,X
	I $$VERSION^XPDUTL("YS")<5 D
	. S GMMSG="Requires Mental Health version 5 or later"
	. F X="MENTAL HEALTH PHYSICAL EXAM" D DISABLE^GMTSPOST
	Q
PCE	; Checks for existence of PCE package...Disables components if absents
	N GMMSG,X
	I $$VERSION^XPDUTL("PX")'>0 D  ;Disable PCE components if PCE not installed nor available 
	. S GMMSG="Patient Care Encounter Package not yet installed"
	. F X="PCE LOCATION OF HOME","PCE CLINICAL REMINDERS","PCE HEALTH FACTORS SELECTED","PCE HEALTH FACTORS ALL","PCE OUTPATIENT ENCOUNTERS","PCE MEASUREMENTS NON-TABULAR","PCE IMMUNIZATIONS","PCE SKIN TESTS" D DISABLE^GMTSPOST
	. F X="PCE MEASUREMENTS SELECTED","PCE EDUCATION","PCE EDUCATION LATEST","PCE OUTPATIENT DIAGNOSIS","PCE EXAMS LATEST","PCE TREATMENTS PROVIDED" D DISABLE^GMTSPOST
	. F X="PCE CLINICAL MAINTENANCE" D DISABLE^GMTSPOST
	Q
DISABLE	; Disable components if auto-disable conditions are met
	N DA,DIC,DIE,DR,Y
	S DIC="^GMT(142.1,",DIC(0)="X" D ^DIC
	I +Y>0 D
	. W !,X," Health Summary Component disabled"
	. S DA=+Y,DR="5///"_"P"_";8///"_GMMSG,DIE=DIC D ^DIE
	Q
FINITO	; Finish initialization, inform user
	N GMTSIFT,GMTSITD,X
	S GMTSIFT=$$NOW^GMTSPREI,GMTSITD=$$DIFF(GMTSIFT,+$G(GMTSIST))
	W !!,"HEALTH SUMMARY VERSION 2.7 INITIALIZATION COMPLETE!"
	Q:'$L($T(FMDIFF^XLFDT))
	S X=$G(GMTSIST) D REGDTM^GMTSU
	W !!?9,"Initialization began at: ",X
	S X=GMTSIFT D REGDTM^GMTSU
	W !!?5,"Initialization completed at: ",X
	W !!?7,"TOTAL Initialization Time: ",GMTSITD
	Q
DIFF(END,BEGIN)	; Converts time difference to external format
	N DIFF,HR,MIN,SEC,Y
	S DIFF=$$FMDIFF^XLFDT(END,BEGIN,2),HR=DIFF\3600
	S MIN=DIFF\60,SEC=DIFF#60
	S HR=$E("00",0,2-$L(HR))_HR,MIN=$E("00",0,2-$L(MIN))_MIN,SEC=$E("00",0,2-$L(SEC))_SEC
	S Y=HR_":"_MIN_":"_SEC
	Q Y

GMTSPP
GMTSPP	;SLC/MAM - Define Health Summary Print-by-Location Parameters ;4/1/92  08:59
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	;
	K DIC,DIE,DIR
	S DIC=19,DIC(0)="F",X="GMTS TASK STARTUP" D ^DIC S OPTIFN=+Y K DIC,X,Y
	S ALRT=1 I $D(^DIC(19,OPTIFN,200)) I $P(^(200),U)'="" S ALRT=0,Y=$P(^(200),U) D QUEOK
	I ALRT D ALERT
	K OPTIFN,ALRT
	F  D GETDATA Q:$D(PPQIT)!$D(DTOUT)
	K CLINIC,DIROUT,DIRUT,DTOUT,DUOUT,GMTSIFN,GMTSLOC,J1,J2,NEWTYP,PPQIT,X,B,C,D0,DI,DIJ,DISYS,DP,DQ,P
	Q
QUEOK	; Informs user of print time if summaries have been queued to print
	D DD^%DT S QTIM=$P(Y,"@",2) K Y
	W !!,"For your information:",!,"Health Summary Batches are queued to print nightly at ",QTIM," and should be ",!,"available for distribution by early morning",!
	K QTIM
	Q
ALERT	; Warns user that summaries have not been queued to print
	W !!,"                                ***Alert***",!!
	W "Health Summary batches have not been queued to print.  Please ask your site",!,"manager to queue option GMTS TASK STARTUP to run nightly.  Parameters may be",!,"set now but will not produce Health Summaries until option is queued."
	Q
GETDATA	; Selects Loc/Type pair; Edits, deletes or sets new parameters for pair
	S DIC=44,DIC(0)="AEMQZ",DIC("A")="Select Hospital Location: ",DIC("S")="I ""WCOR""[$P(^(0),U,3)" W ! D ^DIC K DIC
	I Y=-1 K X,Y S PPQIT=1 Q
	S GMTSLOC=+Y,GMTSLNM=$P(Y,U,2),CLINIC=$S("COR"[$P(Y(0),U,3):1,1:0) K X,Y
	I $O(^GMT(142,"D",GMTSLOC,0)) D DISPLAY
	K GMTSLNM
	S DIC=142,DIC(0)="AEQ",DIC("A")="Select Health Summary Type: " D ^DIC K DIC
	I X="" K X,Y Q
	I Y=-1 K X,Y S PPQIT=1 Q
	S GMTSIFN=+Y,NEWTYP=1,TYP1=0
	F  S TYP1=$O(^GMT(142,"D",GMTSLOC,TYP1)) Q:TYP1=""  I GMTSIFN=TYP1 S NEWTYP=0 Q
	S GMTSUM=$P(Y,U,2),GMTSNEW=0,EXISTS=1,GMTSQIT=0 K X,Y D LIST^GMTSRM
	K GMTSNEW,EXISTS,GMTSQIT,GMTSUM,TYP1
	Q:$D(DUOUT)  I $D(DIRUT) S PPQIT=1 Q
	I NEWTYP=1 D NEW Q
	S DIR(0)="Y",DIR("A")="Do you wish to delete this Health Summary Type from the nightly print",DIR("B")="NO"
	W ! D ^DIR K DIR
	Q:$D(DUOUT)  I $D(DIRUT) S PPQIT=1 Q
	S DIE="^GMT(142,"_GMTSIFN_",20,",DIE("NO^")="OUTOK",DA(1)=GMTSIFN
	S DA=$O(^GMT(142,"D",GMTSLOC,GMTSIFN,0)),DEL=0
	I Y=1 S DR=".01///@",DEL=1
	K X,Y
	E  S:CLINIC DR=".02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=""@1"";.03;@1;.04//0" S:'CLINIC DR=".02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=0;.03" W !
	D ^DIE
	I DEL W !!,"**Print for Health Summary Type deleted**"
	K DIE,DA,DR,X,Y,DEL
	Q
DISPLAY	; Displays Health Summary Types already associated with Location
	W !!,"At present the following Health Summary Types are printed for ",GMTSLNM,":"
	W !?70,"Action",!?2,"Type",?32,"Device" W:CLINIC ?54,"Days Ahead" W ?70,"Profile",!
	S DEVFLG=0
	S TYP=0 F J1=1:1 S TYP=$O(^GMT(142,"D",GMTSLOC,TYP)) Q:TYP=""  D WRITE
	I DEVFLG W !!,"*This Type will not print since Device is invalid or has not been entered"
	W !!,"You may edit a Health Summary Type from the list or enter a new Type",!
	K TYP,DEVFLG
	Q
WRITE	; Writes Health Summary Type with parameters
	S TYPNM=$P(^GMT(142,TYP,0),U),LOCIFN=$O(^GMT(142,"D",GMTSLOC,TYP,0))
	S DATA=^GMT(142,TYP,20,LOCIFN,0),DEV=$P(DATA,U,2)
	S X="`"_DEV,DIC=3.5,DIC(0)="" D ^DIC
	I +Y'>0 S DEVFLG=1
	S DEVNM=$S(+Y>0:$P(Y,U,2),DEV="":"None",1:DEV_" (Invalid)")
	W !,$S(+Y'>0:"*",1:" "),TYPNM,?32,$E(DEVNM,1,21),?59,$P(DATA,U,4),?72,$S($P(DATA,U,3)="Y":"Yes",1:"No") K DIC,X,Y
	;I CLINIC S DAYS=$P(DATA,U,4) S:DAYS="" DAYS=0 W ?59,DAYS
	K DATA,DAYS,DEV,DEVNM,LOCIFN,TYPNM
	Q
NEW	; Sets parameters for new Health Summary Type
	S (NI,LI)=0 I $D(^GMT(142,GMTSIFN,20,0)) F  S NI=$O(^GMT(142,GMTSIFN,20,NI)) Q:NI'>0  S LI=NI
	S:'$D(^GMT(142,GMTSIFN,20,0)) ^(0)="^142.2P^^"
	S DIE="^GMT(142,"_GMTSIFN_",20,",DA(1)=GMTSIFN,DA=LI+1,DIE("NO^")="OUTOK"
	I CLINIC S DR=".01////"_GMTSLOC_";.02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=""@1"";.03;@1;.04//0"
	E  S DR=".01////"_GMTSLOC_";.02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=0;.03"
	W ! D ^DIE K DIE,DA,DR,X,Y,NI,LI,J3
	Q

GMTSPREI
GMTSPREI	;SLC/SBW - GMTS* Preinit ;4/18/95
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching
	N GMI
	W !!,"First I need to run a pre-init...."
	W !,"Starting pre-init now...."
	S GMTSIST=$$NOW
	D APPGRP,RENMED
	D DELFLD ;Entry point to delete obsolete fields in file #142
	W !,"Pre-init successfully completed!"
	Q
APPGRP	; Add "GMTS" Application Group to file 60, 71, 120.51, 9999999.64,
	; 9001017, and 811.9. Done only if not there already.
	N GMI
	F GMI=60,71,120.51,9999999.64,9001017,811.9 I '$D(^DIC(GMI,"%","B","GMTS")) K DD,DO S DIC="^DIC("_GMI_",""%"",",DIC(0)="L",DA(1)=GMI,X="GMTS" D FILE^DICN K DIC,DA W:+Y>0 !!,"Adding ""GMTS"" Application Group to ^DIC("_GMI_",",!
	Q
RENMED	; Rename medicine summary comp. abbreviation
	N GMDA,DA,DIE,DR
	Q:+$D(^GMT(142.1))'>0
	F X="MEDICINE SUMMARY" D
	. S DIC=142.1,DIC(0)="X" D ^DIC I +Y'>0  Q
	. S DIE=142.1,DR="3///MEDS",DA=+Y D ^DIE
	. W !!,"** Renaming Medicine Summary Abbreviation from MED to MEDS **"
	Q
DELFLD	; Deletes obsolete fields in Health Summary Type (#142) file
	N DIK,DA,GMX,DIU
	Q:+$D(^GMT(142))'>0
	F GMX=2,3,4,5,6 D
	. S DA=GMX,DIK="^DD(142,"
	. D ^DIK W !,"Deleting field # ",GMX," in the Health Summary Type (#142) file."
	F DIU=142.02,142.05,142.06 S DIU(0)="S" D EN^DIU2
	Q
NOW()	; Extrinsic special variable to return current date/time
	N %,%H,%I,X
	D NOW^%DTC
	Q +$G(%)

GMTSPSG
GMTSPSG	; SLC/JER - UD Rx Summary Component ;7/15/92  08:06 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMI,IX,ON,PS,PSIVREA,PSJEDT,PSJNKF,PSJPFWD,GMR,TN,UDS
	S PSJEDT=$S(GMTS2'=9999999:(9999999-GMTS2),1:""),PSJNKF=1
	K ^UTILITY("PSG",$J) I '$L($T(ENHS^PSJEEU0)) D NOPSJ Q
	D ENHS^PSJEEU0
	I '$D(^UTILITY("PSG",$J)) Q
	S IX=-9999999,GMI=0
	F  S IX=$O(^UTILITY("PSG",$J,IX)) Q:'IX  S GMR=^(IX) D WRT  Q:$D(GMTSQIT)
	W !
	K ^UTILITY("PSG",$J),^UTILITY("PSIV",$J)
	Q
NOPSJ	; Handles case where routine ^PSJEEU0 not installed
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Inpatient Pharmacy version 3.2 or greater is required.",!
	Q
WRT	; Writes the Unit Dose Component
	N SD,FD,DRG,DOSE,GMV,RT,STAT,SIG
	S SD=$P(GMR,U),FD=$P(GMR,U,2),DRG=$P($P(GMR,U,3),";",2),STAT=$P($P(GMR,U,5),";")
	; Don't display data when start date is after Date Range To Date and 
	; stop date is before Date Range End Date. (Need end date because of
	; FOR LOOP on $O(^PS(53.1,"AC",DFN,Y)) in PSJEEU0
	I +$G(GMRANGE),(SD>(9999999-GMTS1))!(FD<(9999999-GMTS2)) Q
	F GMV="SD","FD" S X=@GMV D REGDT^GMTSU S @GMV=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMI>0&('GMTSNPG) !
	I GMTSNPG!(GMI'>0) D HEAD
	S GMI=1
	S DOSE=$P(GMR,U,6),RT=$P($P(GMR,U,7),";",3),SIG=$P(GMR,U,8)
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W $E(DRG,1,36),?38,DOSE,?50,STAT,?58,SD,?68,FD,!
	D CKP^GMTSUP Q:$D(GMTSQIT)  G:GMTSNPG WRT W ?2,SIG," ",RT
	Q
HEAD	; Prints Header
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W "Drug",?38,"Dose",?50,"Status",?58,"Start",?68,"Stop",! W:$Y'>(IOSL-GMTSLO) !
	Q

GMTSPSI
GMTSPSI	;SLC/JER - IV Rx Summary Component ;7/15/92  08:14 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N GMI,GMTSIDT,MAX,ON,PS,PSIVREA,PSJEDT,PSJNKF,PSJPFWD,TN
	S PSJEDT=$S(GMTS2'=9999999:(9999999-GMTS2),1:""),PSJNKF=1
	K ^UTILITY("PSIV",$J) I '$L($T(ENHS^PSJEEU0)) D NOPSJ Q
	D ENHS^PSJEEU0
	I '$D(^UTILITY("PSIV",$J)) Q
	S GMI=0
	S GMTSIDT=-9999999 F  S GMTSIDT=$O(^UTILITY("PSIV",$J,GMTSIDT)) Q:'GMTSIDT  D WRT  Q:$D(GMTSQIT)
	K ^UTILITY("PSIV",$J),^UTILITY("PSG",$J)
	Q
NOPSJ	; Handles case where ^PSJEEU0 not present
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Inpatient Pharmacy version 3.2 or greater is required.",!
	Q
WRT	; Prints IV Pharmacy order
	N GMV,GMW,GMTSAD,GMTSDRUG,SOL,SD,SLN,FD,STAT,IR,SCH
	S SD=$P(^UTILITY("PSIV",$J,GMTSIDT,0),U),FD=$P(^(0),U,2),STAT=$P($P(^(0),U,4),";"),IR=$P(^(0),U,5),SCH=$P(^(0),U,6)
	; Don't display data when start date is after To Date for Date Range
	Q:+$G(GMRANGE)&(SD>(9999999-GMTS1))
	F GMV="SD","FD" S X=@GMV D REGDT^GMTSU S @GMV=X K X
	I GMI'>0 D HEAD
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMI>0&('GMTSNPG) !
	S GMI=1
	I $D(^UTILITY("PSIV",$J,GMTSIDT,"A",1)) D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W $E($P($P(^UTILITY("PSIV",$J,GMTSIDT,"A",1),";",2),U),1,36),?38,$P(^(1),U,2),?50,STAT,?58,SD,?68,FD,!
	S GMTSAD=1
	F  S GMTSAD=$O(^UTILITY("PSIV",$J,GMTSIDT,"A",GMTSAD)) Q:GMTSAD'>0  S GMTSDRUG=^(GMTSAD) D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W $E($P($P(GMTSDRUG,";",2),U),1,36),?38,$P(GMTSDRUG,U,2),!
LSTSOL	;Write solutions
	S SOL=0
	F  S SOL=$O(^UTILITY("PSIV",$J,GMTSIDT,"S",SOL)) Q:SOL'>0  S SLN=^(SOL) D CKP^GMTSUP Q:$D(GMTSQIT)  D
	. D:GMTSNPG HEAD
	. W ?3,$S(SOL=1!GMTSNPG:"In: ",1:"    ")
	. W $P($P(SLN,";",2),U)," ",$P(SLN,U,2)," ",IR," ",SCH,!
	Q
HEAD	; Prints Header
	I 'GMTSNPG D CKP^GMTSUP Q:$D(GMTSQIT)
	W "Drug",?38,"Dose",?50,"Status",?58,"Start",?68,"Stop",! W:$Y'>(IOSL-GMTSLO) !
	Q

GMTSPSO
GMTSPSO	; SLC/JER - OP Rx Summary Component ;12/2/91  13:45 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N ECD,GMR,IX,PSOBEGIN,GMX
	S PSOBEGIN=$S(GMTS2'=9999999:(9999999-GMTS2),1:"")
	I PSOBEGIN="" S PSOACT=1 K PSOBEGIN
	K ^TMP("PSOO",$J) I '$D(^PS(55,DFN,"P")),'$D(^("ARC")) Q
	I '$O(^PS(55,DFN,"P",0)),$D(^PS(55,DFN,"ARC")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Patient Has Archived OP Prescriptions",!
	D ^PSOHCSUM I '$D(^TMP("PSOO",$J)) Q
	S GMTSLO=GMTSLO+3
	S (GMX,IX)=0
	F  S IX=$O(^TMP("PSOO",$J,IX)) Q:IX'>0  S GMR=$G(^(IX,0)) D WRT
	S GMTSLO=GMTSLO-3
	K ^TMP("PSOO",$J)
	Q
WRT	; Writes OP Pharmacy Segment Record
	N ID,LFD,X,MI,NL,CF,GMD,GMV,GMI
	S ID=$P(GMR,U),LFD=$P(GMR,U,2),ECD=$P(GMR,U,11),CF=$P(GMR,U,10)
	; Don't display data when issue date is after inverse To Date for Date Range
	Q:+$G(GMRANGE)&(ID>(9999999-GMTS1))
	F GMV="ID","LFD","ECD" S X=@GMV D REGDT^GMTSU S @GMV=X K X
	S MI=$G(^TMP("PSOO",$J,IX,1)),NL=0 I $L(MI)>73 D PARSE
	S GMD=$P($P(GMR,U,4),";",2)
	D CKP^GMTSUP Q:$D(GMTSQIT)
	D:GMTSNPG!(GMX'>0) HEAD
	W $E($P($P(GMR,U,3),";",2),1,25),?27,$P(GMR,U,6),?39,$P($P(GMR,U,5),";"),?45,$P(GMR,U,7),?57,ID,?67,LFD,?76,"("_$P(GMR,U,8)_")",!
	; The quantity field has been expanded to 12 digits.
	S GMX=1 ;Used to control 1st print of header
	I 'NL D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?2,MI,!
	F GMI=1:1:NL D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?2,MI(GMI),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?4,"Provider: ",$E(GMD,1,24) W:CF ?39,"Cost/Fill: $",$J(CF,6,2)
	I "EC"[$P($P(GMR,U,5),";"),ECD]"" W ?59,"Exp/Can Dt: "_ECD
	W !
	Q
PARSE	; Parses Medication Instructions
	N GMI,NW,WPL
	S NL=$S(($L(MI)/73)>($L(MI)\73):($L(MI)\73)+1,1:$L(MI)\73)
	S NW=$L(MI," "),WPL=$S((NW/NL)>(NW\NL):(NW\NL)+1,1:NW\NL)
	F GMI=1:1:NL S MI(GMI)=$P(MI," ",(GMI-1)*WPL+1,GMI*WPL)
	Q
HEAD	; Prints Header
	;Only write the next line when there is data to show
	I GMX'>0,$D(^DPT(DFN,.1)),^(.1)]"",$D(^PS(59,+$O(^PS(59,0)),1)),$P(^(1),"^",8) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Outpatient prescriptions are cancelled 72 hours after admission",!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?67,"Last",!
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W "Drug",?27,"Rx #",?38,"Stat",?45,"Qty",?58,"Issued",?67,"Filled",?76,"Rem",! W:$Y'>(IOSL-GMTSLO) !
	;W "Drug",?27,"Rx #",?38,"St (Exp/Can)",?51,"Qty",?58,"Issued",?67,"Filled",?76,"Rem",! W:$Y'>(IOSL-GMTSLO) !
	Q

GMTSPSZO
GMTSPSZO	;SLC/JER - OP Rx 5.6 Summary Component ;12/2/91  13:45 ;
	;;2.7;Health Summary;;Oct 20, 1995
GMTSPSO	;SLC/JER - OP Rx Summary Component ;12/2/91  13:45 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	N ECD,GMR,GMW,IX,PSOBEGIN
	S PSOBEGIN=$S(GMTS2'=9999999:(9999999-GMTS2),1:"")
	I PSOBEGIN="" S PSOACT=1
	K ^UTILITY("PSOO",$J) I '$D(^PS(55,DFN,"P")),'$D(^("ARC")) Q
	I '$O(^PS(55,DFN,"P",0)),$D(^PS(55,DFN,"ARC")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Patient Has Archived OP Prescriptions",!
	D ^PSOHCSUM I '$D(^UTILITY("PSOO",$J)) Q
	I $D(^DPT(DFN,.1)),^(.1)]"",$D(^DIC(59,+$O(^DIC(59,0)),1)),$P(^(1),"^",8) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Outpatient prescriptions are cancelled 72 hours after admission",!
	S GMTSLO=GMTSLO+3
	D HEAD
	S IX=0 F  S IX=$O(^UTILITY("PSOO",$J,IX)) Q:IX'>0  S GMR=$G(^(IX,0)) D WRT
	S GMTSLO=GMTSLO-3
	K ^UTILITY("PSOO",$J)
	Q
HEAD	; Prints Header
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?67,"Last",!
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W "Drug",?27,"Rx #",?38,"St (Exp/Can)",?51,"Qty",?58,"Issued",?67,"Filled",?76,"Rem",! W:$Y'>(IOSL-GMTSLO) !
	Q
WRT	; Writes OP Pharmacy Segment Record
	N ID,LFD,X,MI,NL,CF,GMD,GMV,GMI
	S ID=$P(GMR,U),LFD=$P(GMR,U,2),ECD=$P(GMR,U,11),CF=$P(GMR,U,10)
	F GMV="ID","LFD","ECD" S X=@GMV D REGDT^GMTSU S @GMV=X K X
	S MI=$G(^UTILITY("PSOO",$J,IX,1)),NL=0 I $L(MI)>73 D PARSE
	S GMD=$P($P(GMR,U,4),";",2)
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W $E($P($P(GMR,U,3),";",2),1,25),?27,$P(GMR,U,6),?38,$P($P(GMR,U,5),";"),?40,$S("EC"[$P($P(GMR,U,5),";"):"("_ECD_")",1:""),?51,$P(GMR,U,7),?57,ID,?67,LFD,?76,"("_$P(GMR,U,8)_")",!
	I 'NL D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?2,MI,!
	F GMI=1:1:NL D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?2,MI(GMI),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?4,"Provider: ",$E(GMD,1,26) W:CF ?41,"Cost/Fill: $",$J(CF,6,2) W !
	Q
PARSE	; Parses Medication Instructions
	N GMI,NW,WPL
	S NL=$S(($L(MI)/73)>($L(MI)\73):($L(MI)\73)+1,1:$L(MI)\73)
	S NW=$L(MI," "),WPL=$S((NW/NL)>(NW\NL):(NW\NL)+1,1:NW\NL)
	F GMI=1:1:NL S MI(GMI)=$P(MI," ",(GMI-1)*WPL+1,GMI*WPL)
	Q

GMTSPXEP
GMTSPXEP	;SLC/SBW - PCE Patient Education components ;11/17/95
	;;2.7;Health Summary;;Oct 20, 1995
	;
PTED	; Patient education
	N GMTSOVT
	K ^TMP("PXPE",$J)
	S GMTSOVT="ADTCHX" ;NOTE: CONTROLS TYPES OF VISITS DATA DISPLAYED FOR.
	; Need to monitor GMTSOVT values. May need to reassess in the future.
	D EDUC^PXRHS08(DFN,GMTSEND,GMTSBEG,GMTSNDM,GMTSOVT)
	D:+$D(^TMP("PXPE",$J)) EDMAIN
	Q
MRPTED	; Most recent patient education
	N GMTSOVT,LATEST
	K ^TMP("PXPE",$J)
	S LATEST="R" ;Returns most recent Pat. Ed. Topic Types for time period.
	S GMTSOVT="ADTCHX" ;NOTE: CONTROLS TYPES OF VISITS DATA DISPLAYED FOR.
	; Need to monitor GMTSOVT values. May need to reassess in the future.
	D EDUC^PXRHS08(DFN,GMTSEND,GMTSBEG,LATEST,GMTSOVT)
	D:+$D(^TMP("PXPE",$J)) EDMAIN
	Q
EDMAIN	;
	N GMDT,GMED,GMIFN,GMN0,GMN1,X,GMTSDAT,ED,LEVEL,GMSITE,PSITE,PDT,LTXT
	S GMDT=0
	F  S GMDT=$O(^TMP("PXPE",$J,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
	. S GMED=""
	. F  S GMED=$O(^TMP("PXPE",$J,GMDT,GMED)) Q:GMED']""  D  Q:$D(GMTSQIT)
	. . S GMIFN=0
	. . F  S GMIFN=$O(^TMP("PXPE",$J,GMDT,GMED,GMIFN)) Q:GMIFN'>0  D  Q:$D(GMTSQIT)
	. . . S GMN0=$G(^TMP("PXPE",$J,GMDT,GMED,GMIFN,0))
	. . . Q:GMN0']""
	. . . S GMN1=$G(^TMP("PXPE",$J,GMDT,GMED,GMIFN,1))
	. . . S GMSITE=$S($P(GMN1,U,3)]"":$E($P(GMN1,U,3),1,10),$P(GMN1,U,4)]"":$E($P(GMN1,U,4),1,10),1:"No Site")
	. . . S X=$P(GMN0,U,2) D REGDT^GMTSU S GMTSDAT=X
	. . . S ED=$P(GMN0,U),LEVEL=$P(GMN0,U,3)
	. . . I LEVEL]"" S LTXT=" - "_LEVEL
	. . . I LEVEL="POOR"!(LEVEL="FAIR")!(LEVEL="GOOD") S LTXT=LTXT_" UNDERSTANDING"
	. . . D CKP^GMTSUP Q:$D(GMTSQIT)
	. . . I GMTSDAT'=$G(PDT)!GMTSNPG W GMTSDAT S PDT=GMTSDAT,PSITE=""
	. . . I GMSITE'=$G(PSITE) W ?10,GMSITE S PSITE=GMSITE
	. . . W ?23,ED,$G(LTXT),!
	K ^TMP("PXPE",$J)
	Q

GMTSPXFP
GMTSPXFP	;SLC/SBW - PCE Health Factors Component ;14-APR-95
	;;2.7;Health Summary;;Oct 20, 1995
	;
HFSEL	; Health Factors Selected
	N HFSEG,GMTSFC
	Q:$O(GMTSEG(GMTSEGN,9999999.64,0))'>0
	S GMTSFC=0
	F  S GMTSFC=$O(GMTSEG(GMTSEGN,9999999.64,GMTSFC)) Q:'GMTSFC  D
	. S HFSEG(GMTSEG(GMTSEGN,9999999.64,GMTSFC))=""
	K ^TMP("PXF",$J)
	D HF^PXRHS07(DFN,GMTSEND,GMTSBEG,GMTSNDM,.HFSEG)
	D:+$D(^TMP("PXF",$J)) HFMAIN
	Q
HFACT	; Control Health Factor retrieval and display
	K ^TMP("PXF",$J)
	D HF^PXRHS07(DFN,GMTSEND,GMTSBEG,GMTSNDM)
	D:+$D(^TMP("PXF",$J)) HFMAIN
	Q
HFMAIN	;
	N GMHFC,GMHF,GMDT,GMIFN,GMN0,X,GMTSDAT,HF,LEVEL,PHFC
	S GMHFC=""
	F  S GMHFC=$O(^TMP("PXF",$J,GMHFC)) Q:GMHFC=""  D  Q:$D(GMTSQIT)
	. S GMHF=""
	. F  S GMHF=$O(^TMP("PXF",$J,GMHFC,GMHF)) Q:GMHF=""  D  Q:$D(GMTSQIT)
	. . S GMDT=0
	. . F  S GMDT=$O(^TMP("PXF",$J,GMHFC,GMHF,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
	. . . S GMIFN=0
	. . . F  S GMIFN=$O(^TMP("PXF",$J,GMHFC,GMHF,GMDT,GMIFN)) Q:GMIFN'>0  D HFDSP Q:$D(GMTSQIT)
	K ^TMP("PXF",$J)
	Q
HFDSP	; Display Health Factor data
	S GMN0=$G(^TMP("PXF",$J,GMHFC,GMHF,GMDT,GMIFN,0))
	Q:GMN0']""
	S X=$P(GMN0,U,2) D REGDT^GMTSU S GMTSDAT=X
	S HF=$P(GMN0,U),LEVEL=$P(GMN0,U,4)
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I GMHFC'=$G(PHFC)!GMTSNPG D
	. I $G(PHFC)="",'GMTSNPG W ! D CKP^GMTSUP Q:$D(GMTSQIT)
	. W GMHFC,!
	. S PHFC=GMHFC
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ?2,HF
	W:LEVEL]"" " (",LEVEL,")"
	W ?50,GMTSDAT,!
	Q

GMTSPXHP
GMTSPXHP	;SLC/SBW - PCE Location of Home component ;1-dec-94
	;;2.7;Health Summary;;Oct 20, 1995
	;
HOMELOC	; ******************** LOCATION OF HOME ********************
	; <SETUP>
	N GMTSI,DIWL,DIWR,DIWF,X
	K ^UTILITY($J,"W"),^TMP("PXLOC",$J)
	D LOC^PXRHS13(DFN)
	Q:'$D(^TMP("PXLOC",$J))
	S DIWL=1,DIWR=80,DIWF="W",GMTSI=0
	F  S GMTSI=$O(^TMP("PXLOC",$J,GMTSI)) Q:'GMTSI  S X=^(GMTSI) D CKP^GMTSUP Q:$D(GMTSQIT)  D ^DIWP
	D CKP^GMTSUP Q:$D(GMTSQIT)  D ^DIWW
	K ^TMP("PXLOC",$J)
	Q

GMTSPXHR
GMTSPXHR	;SLC/SBW - PCE Clinical Reminders/Maintenance Components ;8/4/95
	;;2.7;Health Summary;;Oct 20, 1995
	; Main driver
MAINHM	;Entry Point for Clinical Reminder/Health Maintenance items
	N GMFLAG
	S GMFLAG=1
	;
MAIN	;Entry Point for Clinical Reminders
	Q:+$G(GMTSAGE)'>0!($G(SEX)="")!($G(DFN)'>0)
	Q:$O(GMTSEG(GMTSEGN,811.9,0))'>0
	N GMCR,GMFIRST,CRSEG,GMDISP
	S GMCR=0,GMFIRST=1
	F  S GMCR=$O(GMTSEG(GMTSEGN,811.9,GMCR)) Q:'GMCR  D  Q:$D(GMTSQIT)
	. S CRSEG=GMTSEG(GMTSEGN,811.9,GMCR)
	. K ^TMP("PXRHM",$J)
	. D MAIN^PXRHM(DFN,GMTSAGE,SEX,CRSEG,+$G(GMFLAG))
	. D:+$D(^TMP("PXRHM",$J)) GETCR
	I +$G(GMDISP)'>0 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Selected Clinical Reminders not due.",!
	K ^TMP("PXRHM",$J)
	Q
GETCR	;Get reminders that were returned
	N ITEM,GMDT,GMN0,X,GMTSDAT,GMTSDUE,GMREM
	S ITEM=0
	F  S ITEM=$O(^TMP("PXRHM",$J,ITEM)) Q:ITEM'>0  D  Q:$D(GMTSQIT)
	. S GMREM=""
	. F  S GMREM=$O(^TMP("PXRHM",$J,ITEM,GMREM)) Q:GMREM=""  D CRDISP Q:$D(GMTSQIT)
	Q
CRDISP	; Display reminder data
	S GMN0=$G(^TMP("PXRHM",$J,ITEM,GMREM))
	Q:GMN0']""
	I $P(GMN0,U,2) S X=$P(GMN0,U,2) D REGDT^GMTSU S GMTSDUE=X
	S GMTSDUE=$S($G(GMTSDUE)]"":GMTSDUE,1:$P(GMN0,U))
	I $P(GMN0,U,3) S X=$P(GMN0,U,3) D REGDT^GMTSU S GMTSDAT=X
	S GMDISP=1
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I GMTSNPG D HDR,CKP^GMTSUP Q:$D(GMTSQIT)
	W GMREM,?36,$G(GMTSDUE),?45,$G(GMTSDAT),!
	Q:+$G(GMFLAG)'>0
	; Display activity data on reminder
	S GMDT=0
	F  S GMDT=$O(^TMP("PXRHM",$J,ITEM,GMREM,GMDT)) Q:+GMDT'>0  D  Q:$D(GMTSQIT)
	. S GMN0=$G(^TMP("PXRHM",$J,ITEM,GMREM,GMDT))
	. Q:GMN0']""
	. I $P(GMN0,U,2) S X=$P(GMN0,U,2) D REGDT^GMTSU S GMTSDAT=X
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. I GMTSNPG D HDR
	. W ?5,$P(GMN0,U)," on record - ",$G(GMTSDAT),", ",$P(GMN0,U,3),!
	; Display maintenance criteria for reminder
	S GMDT=0
	F  S GMDT=$O(^TMP("PXRHM",$J,ITEM,GMREM,"TXT",GMDT)) Q:+GMDT'>0  D  Q:$D(GMTSQIT)
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. I GMTSNPG D HDR
	. W ?5,$G(^TMP("PXRHM",$J,ITEM,GMREM,"TXT",GMDT)),!
	Q
HDR	;Header
	I +$G(GMFLAG),GMFIRST D FIRST Q:$D(GMTSQIT)  S GMFIRST=0
	W ?36,"--NEXT--",?45,"--LAST--",!
	Q
	;
FIRST	;Display Disclaimer
	; page headers
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ?1,"The following disease screening, immunization and patient education",!
	W ?1,"recommendations are offered as guidelines to assist in your practice.",!
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ?1,"These are only recommendations, not practice standards. The appropriate",!
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ?1,"utilization of these for your individual patient must be based on",!
	D CKP^GMTSUP Q:$D(GMTSQIT)
	W ?1,"clinical judgement and the patient's current status.",!!
	Q

GMTSPXIM
GMTSPXIM	;SLC/SBW - PCE Immunization component ;4-April-95
	;;2.7;Health Summary;;Oct 20, 1995
	;
IMMUN	; Main Entry Point
	K ^TMP("PXI",$J)
	D IMMUN^PXRHS03(DFN)
	Q:'$D(^TMP("PXI",$J))
	N GMIMM,GMDT,GMIFN,GMW,GMSITE,GMN0,GMN1,GMSIR,GMSIC,X,GMTSDAT,GML
	S GMIMM=""
	F  S GMIMM=$O(^TMP("PXI",$J,GMIMM)) Q:GMIMM=""  D  Q:$D(GMTSQIT)
	. S (GMDT,GMW)=0
	. F  S GMDT=$O(^TMP("PXI",$J,GMIMM,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
	. . S GMIFN=0
	. . F  S GMIFN=$O(^TMP("PXI",$J,GMIMM,GMDT,GMIFN)) Q:GMIFN'>0  D IMMDSP Q:$D(GMTSQIT)
	K ^TMP("PXI",$J)
	Q
IMMDSP	; Display Immunization data
	S GMN0=$G(^TMP("PXI",$J,GMIMM,GMDT,GMIFN,0))
	Q:GMN0']""
	S GMN1=$G(^TMP("PXI",$J,GMIMM,GMDT,GMIFN,1))
	S GMSITE=$S($P(GMN1,U,3)]"":$E($P(GMN1,U,3),1,10),$P(GMN1,U,4)]"":$E($P(GMN1,U,4),1,10),1:"No Site")
	S X=$P(GMN0,U,3) D REGDT^GMTSU S GMTSDAT=X
	S GMSIR=$P(GMN0,U,6)
	S GMSIC=$S(+$P(GMN0,U,7):"DO NOT REPEAT",1:"")
	I GMSIC]"",GMSIR]"" S GMSIR=GMSIR_"; "
	S GMSIR=GMSIR_GMSIC
	D CKP^GMTSUP Q:$D(GMTSQIT)  I GMW'>0!GMTSNPG W $P(GMN0,U,2) S GML=$L($P(GMN0,U,2))+1
	W ?GML,$P(GMN0,U,4),?15,GMTSDAT,?24,GMSITE,?38,GMSIR,!
	S GMW=1
	Q

GMTSPXM
GMTSPXM	;SLC/SBW - PCE Non Tabular Measurement comp ;21/April/95
	;;2.7;Health Summary;;Oct 20, 1995
	;
MEAS	; Measurements provided within a date range
	K ^TMP("PXM",$J)
	D MEAS^PXRHS09(DFN,GMTSEND,GMTSBEG,GMTSNDM)
	Q:'$D(^TMP("PXM",$J))
	N GMTYP,GMDT,GMIFN,GMN0,X,MTYPE,VALUE,PMTYPE
	S GMTYP=""
	F  S GMTYP=$O(^TMP("PXM",$J,GMTYP)) Q:GMTYP']""  D  Q:$D(GMTSQIT)
	. N GMTSDAT,PDT
	. S GMDT=0
	. F  S GMDT=$O(^TMP("PXM",$J,GMTYP,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
	. . S GMIFN=0
	. . F  S GMIFN=$O(^TMP("PXM",$J,GMTYP,GMDT,GMIFN)) Q:GMIFN'>0  D MEASDSP Q:$D(GMTSQIT)
	K ^TMP("PXM",$J)
	Q
MEASDSP	; Display Measurement data
	S GMN0=$G(^TMP("PXM",$J,GMTYP,GMDT,GMIFN,0))
	Q:GMN0']""
	S X=$P(GMN0,U,2)
	D REGDT^GMTSU S GMTSDAT=X
	S MTYPE=$P(GMN0,U),VALUE=$P(GMN0,U,4)
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I GMTSNPG!(MTYPE'=$G(PMTYPE)) W MTYPE S PMTYPE=MTYPE
	I GMTSDAT'=$G(PDT)!GMTSNPG W ?5,GMTSDAT S PDT=GMTSDAT
	W ?15,VALUE,!
	Q

GMTSPXMP
GMTSPXMP	;SLC/SBW - PCE Selected Measurement Component ;21/Apr/95
	;;2.7;Health Summary;;Oct 20, 1995
	;
MEASP	; Get and Display Measurement data for Selected Measurement Panels
	Q:+$O(GMTSEG(GMTSEGN,9001017,0))'>0
	N GMM,GMW1,MPNAME,PORDER
	S GMM=0,GMW1=0
	F  S GMM=$O(GMTSEG(GMTSEGN,9001017,GMM)) Q:'GMM  D
	. N MPANEL,FORMAT,MNOTE
	. S MPANEL=GMTSEG(GMTSEGN,9001017,GMM)
	. K ^TMP("PXM",$J),^TMP("PXF",$J)
	. D MEAS^PXRHS20(DFN,GMTSDOB,SEX,GMTSEND,GMTSBEG,GMTSNDM,MPANEL)
	. Q:+$D(^TMP("PXM",$J))'>0!(+$D(^TMP("PXM",$J))'>0)
	. S MPNAME=$O(^TMP("PXF",$J,""))
	. Q:MPNAME']""
	. S PORDER=0
	. F  S PORDER=$O(^TMP("PXF",$J,MPNAME,PORDER)) Q:PORDER'>0  D
	. . N GMNODE,MNAME,MLABEL,FWIDTH,X
	. . S GMNODE=^TMP("PXF",$J,MPNAME,PORDER)
	. . S MNAME=$P(GMNODE,U)
	. . S FWIDTH=$P(GMNODE,U,2)
	. . S MLABEL=$P(GMNODE,U,3)
	. . S X=$P(GMNODE,U,4) S:X]"" MNOTE(X)=""
	. . S:FWIDTH'>0 FWIDTH=10
	. . S FORMAT(PORDER,0)=$P(GMNODE,U)
	. . S FORMAT(PORDER,1)=$S(MLABEL]"":MLABEL,1:MNAME)
	. . S FORMAT(PORDER,2)=FWIDTH
	. D MEASDSP
	K ^TMP("PXM",$J),^TMP("PXF",$J)
	Q
MEASDSP	; Display Measurement Data in columns
	N GMTSIDT,GMW,GMCOL,ORDER,LABEL,WIDTH,NAME,GMTSDAT,IFN
	N VALUE,TVALUE
	S GMW=1,GMTSIDT=0
	F  S GMTSIDT=$O(^TMP("PXM",$J,GMTSIDT)) Q:GMTSIDT'>0  D  Q:$D(GMTSQIT)
	. S X=9999999-GMTSIDT D REGDT^GMTSU S GMTSDAT=X
	. D CKP^GMTSUP Q:$D(GMTSQIT)
	. I GMTSNPG!GMW D PHDR D CKP^GMTSUP Q:$D(GMTSQIT)  I GMTSNPG D PHDR
	. D PLINE
	. S GMW=0
	I $O(MNOTE(0))]"" D
	. ;D CKP^GMTSUP Q:$D(GMTSQIT)  W:'GMTSNPG !
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W "Notes:",!
	. S X=""
	. F  S X=$O(MNOTE(X)) Q:X=""  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,X,!
	Q
PLINE	;
	W GMTSDAT
	S GMCOL=10,ORDER=0
	F  S ORDER=$O(FORMAT(ORDER)) Q:ORDER'>0  D
	. S VALUE=""
	. S WIDTH=FORMAT(ORDER,2)
	. S NAME=FORMAT(ORDER,0)
	. ;Only get one entry for an ordered item.
	. S IFN=+$O(^TMP("PXM",$J,GMTSIDT,ORDER,""))
	. S TVALUE=$G(^TMP("PXM",$J,GMTSIDT,ORDER,IFN))
	. I TVALUE]""  S VALUE=$P(TVALUE,U),X=$P(TVALUE,U,2) S:X]"" MNOTE(X)=""
	. S:VALUE]"" VALUE=$S($P(WIDTH,".",2)="":$J(VALUE,$P(WIDTH,".",1)),1:$J(VALUE,$P(WIDTH,".",1),$P(WIDTH,".",2)))
	. W ?GMCOL,VALUE S GMCOL=GMCOL+WIDTH+2
	W !
	Q
PHDR	;Write Measurement Panel Header
	I GMW1,'GMTSNPG W ! D CKP^GMTSUP Q:$D(GMTSQIT)
	I MPNAME]"" W MPNAME," Measurement Panel",!
	S GMCOL=10,ORDER=0
	F  S ORDER=$O(FORMAT(ORDER)) Q:ORDER'>0  D
	. S LABEL=FORMAT(ORDER,1),WIDTH=FORMAT(ORDER,2)
	. W ?(GMCOL+1+(WIDTH-$L(LABEL)\2)),LABEL
	. S GMCOL=GMCOL+WIDTH+2
	W !
	S GMW1=1
	Q

GMTSPXOP
GMTSPXOP	;SLC/SBW - PCE Outpatient Encounter component ;3/26/95
	;;2.7;Health Summary;;Oct 20, 1995
	;
PURPOSE	; Entry point to show outpatient encounters with ICD9 data
	; and providers
	N DTYPE
	S DTYPE="DP"
	D MAIN
	Q
OUTPT	; Entry point to show outpatient encounters with ICD9 data,
	; CPT data, and providers
	N DTYPE
	S DTYPE="CDP"
	D MAIN
	Q
MAIN	;
	N GMTSIVD,GMTSDAT,GMTSDTU,GMTSOVT,GMTSLOC,DIWL,GMTAB,GMTSN,GMCKP,GMTSX
	N GMTSITE,GMTSICL,GMTSLOC,GMTSELIG,X,GMTSVDF
	S GMTSICL=14 ;# of blank left columns for support data of a visit
	S DIWL=0 ;used in TXTFMT call & to print returned data
	S GMTAB=2 ;Used to offset data from TXTFMT call after 1st line
	S GMTSOVT="ACTSOR" ; NOTE: THIS CONTROLS TYPES OF VISITS DISPLAYED
	; Need to monitor GMTSOVT values, may include a B
	D VISIT^PXRHS01(DFN,GMTSEND,GMTSBEG,GMTSNDM,GMTSOVT,DTYPE,1)
	Q:'$D(^TMP("PXHSV",$J))
	S GMTSIVD=0
	F  S GMTSIVD=$O(^TMP("PXHSV",$J,GMTSIVD)) Q:GMTSIVD']""  D  Q:$D(GMTSQIT)
	. S GMTSVDF=0
	. F  S GMTSVDF=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF)) Q:GMTSVDF'>0  D  Q:$D(GMTSQIT)
	. . S GMTSN=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,0))
	. . S X=$P(GMTSN,U,1) D REGDT^GMTSU S GMTSDAT=X
	. . S GMTSDTU=0
	. . S GMTSLOC=""
	. . S GMTSITE=$S($P(GMTSN,U,3)]"":$E($P(GMTSN,U,3),1,10),$P(GMTSN,U,8)]"":$E($P(GMTSN,U,8),1,10),1:"No Site")
	. . I $G(GMPXHLOC)="Y" S GMTSLOC=$E($P(GMTSN,U,6),1,30)
	. . I '$L(GMTSLOC) S GMTSLOC=$P(GMTSN,U,9)
	. . S GMTSELIG=$E($P(GMTSN,U,12),1,17)
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS
	. . D DSPPROV Q:$D(GMTSQIT)
	. . D DSPPOV Q:$D(GMTSQIT)
	. . D DSPCPT
	. . W !
	K ^TMP("PXHSV",$J)
	Q
	;
DSPPOV	; Display Purpose of visit
	Q:$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",""))=""
	Q:$G(GMPXICDF)="N"&($G(GMPXNARR)="N")
	N GMTSN,GMTSMOD,GMTSICD,GMTSNARR,GMTSPDN
	D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS W ?3,"Diagnosis:"
	S GMCKP=0,GMTSPDN=""
	F  S GMTSPDN=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",GMTSPDN)) Q:GMTSPDN'>0  D  Q:$D(GMTSQIT)
	. S GMTSN=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",GMTSPDN))
	. S GMTSMOD=$P(GMTSN,U,2)
	. S GMTSICD=$P(GMTSN,U) D GETICDDX^GMTSPXU1(.GMTSICD,$G(GMPXICDF),GMTSMOD)
	. S GMTSNARR=""
	. S:$G(GMPXNARR)'="N" GMTSNARR=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",GMTSPDN,"N"))
	. I $P(GMTSICD,"-",2,10)=$G(GMTSNARR) S GMTSNARR=""
	. D TXTFMT^GMTSPXU1(GMTSICD,$G(GMTSNARR),GMTSICL,GMTAB,DIWL)
	. I '$D(^UTILITY($J,"W")) Q
	. S GMTSX=0
	. F  S GMTSX=$O(^UTILITY($J,"W",DIWL,GMTSX)) Q:GMTSX'>0!$D(GMTSQIT)  D
	. . I GMCKP>0 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS
	. . S GMCKP=1
	. . W ?GMTSICL+$S(GMTSX>1:GMTAB,1:0),$G(^UTILITY($J,"W",DIWL,GMTSX,0)),!
	Q
DSPCPT	; Display Procedures performed during the visit
	Q:$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",""))=""
	N GMTSNARR,GMTSPDN,GMTSN,GMTSICD,GMTSNARR,GMTSCPT
	D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS W ?3,"Procedure:"
	S GMCKP=0,GMTSPDN=""
	F  S GMTSPDN=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",GMTSPDN)) Q:GMTSPDN'>0  D  Q:$D(GMTSQIT)
	. S GMTSN=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",GMTSPDN))
	. S GMTSNARR=$P(GMTSN,U,2)
	. S GMTSCPT=$$GETCPT^GMTSPXU1($P(GMTSN,U))
	. I $P(GMTSCPT,"-",2,10)=GMTSNARR S GMTSNARR=""
	. D TXTFMT^GMTSPXU1(GMTSCPT,GMTSNARR,GMTSICL,GMTAB,DIWL)
	. I '$D(^UTILITY($J,"W")) Q
	. S GMTSX=0
	. F  S GMTSX=$O(^UTILITY($J,"W",DIWL,GMTSX)) Q:GMTSX'>0  D  Q:$D(GMTSQIT)
	. . I GMCKP>0 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS
	. . S GMCKP=1
	. . W ?GMTSICL+$S(GMTSX>1:GMTAB,1:0),$G(^UTILITY($J,"W",DIWL,GMTSX,0)),!
	Q
DSPPROV	; Display Providers for visit
	Q:$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"P",""))=""
	N GMCNT,GMPROV
	D ORDERPRO^GMTSPXU1(.GMPROV,20)
	D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS W ?3," Provider:"
	S GMCNT=0
	F  S GMCNT=$O(GMPROV(GMCNT)) Q:GMCNT'>0  D  Q:GMCNT'>0!$D(GMTSQIT)
	. I GMCNT>1 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS
	. W ?GMTSICL,GMPROV(GMCNT)
	. S GMCNT=$O(GMPROV(GMCNT)) Q:GMCNT'>0
	. W ?37,GMPROV(GMCNT)
	. S GMCNT=$O(GMPROV(GMCNT)) Q:GMCNT'>0
	. W ?60,GMPROV(GMCNT)
	. W:$O(GMPROV(GMCNT)) !
	W !
	Q
DSPVIS	; Display outpatient visit data
	Q:GMTSNPG'>0&(GMTSDTU>0)
	I GMTSNPG!(+GMTSDTU'>0) D
	. W GMTSDAT,?14,GMTSITE,?29,GMTSLOC,?61,GMTSELIG,!
	. S GMTSDTU=1
	Q

GMTSPXSK
GMTSPXSK	;SLC/SBW - PCE Skin Test component ;4-April-95
	;;2.7;Health Summary;;Oct 20, 1995
	;
SKIN	; Main entry point
	K ^TMP("PXS",$J)
	D SKIN^PXRHS04(DFN)
	Q:'$D(^TMP("PXS",$J))
	N GMSK,GMDT,GMIFN,GMW,GMSITE,GMSKIN,GMN0,GMN1,GMRDG,X,GMTSDAT,GMRES
	S GMSK=""
	F  S GMSK=$O(^TMP("PXS",$J,GMSK)) Q:GMSK=""  D  Q:$D(GMTSQIT)
	. S (GMDT,GMW)=0
	. F  S GMDT=$O(^TMP("PXS",$J,GMSK,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
	. . S GMIFN=0
	. . F  S GMIFN=$O(^TMP("PXS",$J,GMSK,GMDT,GMIFN)) Q:GMIFN'>0  D SKINDSP Q:$D(GMTSQIT)
	K ^TMP("PXS",$J)
	Q
SKINDSP	; Display Skin Test data
	S GMN0=$G(^TMP("PXS",$J,GMSK,GMDT,GMIFN,0))
	Q:GMN0']""
	S GMN1=$G(^TMP("PXS",$J,GMSK,GMDT,GMIFN,1))
	S GMSITE=$S($P(GMN1,U,3)]"":$E($P(GMN1,U,3),1,10),$P(GMN1,U,4)]"":$E($P(GMN1,U,4),1,10),1:"No Site")
	S X=$P(GMN0,U,2) D REGDT^GMTSU S GMTSDAT=X
	S GMSKIN=$P(GMN0,U)
	S GMRDG=$P(GMN0,U,5)
	I GMRDG]"" S GMRDG=$J(GMRDG,2)_" mm"
	S GMRES=$P(GMN0,U,4)
	I GMRDG']"",GMRES']"" S GMRES="UNREPORTED"
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMW'>0!GMTSNPG GMSKIN W ?12,GMTSDAT,?22,GMRDG,?29,GMRES,?41,GMSITE,!
	S GMW=1
	Q

GMTSPXTP
GMTSPXTP	;SLC/SBW - PCE Treatment Component ;7-APRIL-95
	;;2.7;Health Summary;;Oct 20, 1995
	; Treatments provided
TRTMT	; Treatments provided within a date range and service category
	N SERCAT
	; Only visits with the following service category are displayed.
	; This may need to be revised in the future.
	S SERCAT="ADTC"
	K ^TMP("PXT",$J)
	D TREAT^PXRHS06(DFN,GMTSEND,GMTSBEG,GMTSNDM,SERCAT)
	Q:'$D(^TMP("PXT",$J))
	N GMDT,GMIFN,GMSITE,GMN0,GMN1,X,GMTSDAT,TREAT,NUM,PDT
	N GMTXT,GMTSICL,DIWL,GMTAB,GMTSX,GMCKP,PNARR,GMPSITE,GMTR
	S GMTSICL=22 ;# of blank left columns for support data of a visit
	S DIWL=0 ;used in TXTFMT call & to print returned data
	S GMTAB=2 ;Used to offset data from TXTFMT call after 1st line
	S GMDT=0
	F  S GMDT=$O(^TMP("PXT",$J,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
	. S GMTR=""
	. F  S GMTR=$O(^TMP("PXT",$J,GMDT,GMTR)) Q:GMTR']""  D  Q:$D(GMTSQIT)
	. . S GMIFN=0
	. . F  S GMIFN=$O(^TMP("PXT",$J,GMDT,GMTR,GMIFN)) Q:GMIFN'>0  D TREATDSP Q:$D(GMTSQIT)
	K ^TMP("PXT",$J)
	Q
TREATDSP	; Display treatment data
	S GMN0=$G(^TMP("PXT",$J,GMDT,GMTR,GMIFN,0))
	Q:GMN0']""
	S GMN1=$G(^TMP("PXT",$J,GMDT,GMTR,GMIFN,1))
	S GMSITE=$S($P(GMN1,U,3)]"":$E($P(GMN1,U,3),1,10),$P(GMN1,U,4)]"":$E($P(GMN1,U,4),1,10),1:"No Site")
	S X=$P(GMN0,U,2)
	D REGDT^GMTSU S GMTSDAT=X
	S TREAT=$P(GMN0,U),NUM=$P(GMN0,U,3)
	S PNARR=$G(^TMP("PXT",$J,GMDT,GMTR,GMIFN,"P"))
	S GMTXT=TREAT_$S(NUM]"":" ("_NUM_")",1:"")_$S(PNARR]"":"; "_PNARR,1:"")
	D CKP^GMTSUP Q:$D(GMTSQIT)
	I GMTSDAT'=$G(PDT)!GMTSNPG W GMTSDAT S PDT=GMTSDAT,PSITE=""
	I GMSITE'=$G(PSITE) W ?10,GMSITE S PSITE=GMSITE
	D TXTFMT^GMTSPXU1(GMTXT,"",GMTSICL,GMTAB,DIWL)
	I '$D(^UTILITY($J,"W")) Q
	S (GMTSX,GMCKP)=0
	F  S GMTSX=$O(^UTILITY($J,"W",DIWL,GMTSX)) Q:GMTSX'>0!$D(GMTSQIT)  D
	. I GMCKP>0 D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMTSNPG GMTSDAT,?10,GMSITE
	. S GMCKP=1
	. W ?GMTSICL+$S(GMTSX>1:GMTAB,1:0),$G(^UTILITY($J,"W",DIWL,GMTSX,0)),!
	Q

GMTSPXU1
GMTSPXU1	;SLC/SBW - PCE Utilites sub-routines ;11/15/94
	;;2.7;Health Summary;;Oct 20, 1995
	;
GETICDDX(GMTSICD,GMTSICF,GMMOD)	;Entry point to get ICD9 data
	N DIC,DIQ,DR,DA,REC,CODE,NAME,DESC
	S DIC=80,DA=GMTSICD,DIQ="REC(",DIQ(0)="IE",DR=".01;3;10"
	D EN^DIQ1
	Q:'$D(REC)
	S CODE=REC(80,DA,.01,"I")
	S NAME=REC(80,DA,3,"E")
	S DESC=REC(80,DA,10,"E")
	S:GMTSICF="L"!(GMTSICF="") GMTSICD=CODE_"-"_DESC
	S:GMTSICF="S" GMTSICD=CODE_"-"_NAME
	S:GMTSICF="C" GMTSICD=CODE
	S:GMTSICF="T" GMTSICD=DESC
	I $G(GMMOD)]"" S GMMOD=$P(GMMOD,","),GMTSICD=GMMOD_" "_GMTSICD
	S:GMTSICF="N" GMTSICD=""
	Q
	;
GETICDOP	;Entry point to get ICD0 data
	N DIC,DIQ,DR,DA,REC,CODE,NAME,DESC
	S DIC=80.1,DA=GMTSICD,DIQ="REC(",DIQ(0)="IE",DR=".01;4;10"
	D EN^DIQ1
	Q:'$D(REC)
	S CODE=REC(80.1,DA,.01,"I")
	S NAME=REC(80.1,DA,4,"E")
	S DESC=REC(80.1,DA,10,"E")
	S:GMTSICF="L"!(GMTSICF="") GMTSICD=CODE_"-"_DESC
	S:GMTSICF="S" GMTSICD=CODE_"-"_NAME
	S:GMTSICF="C" GMTSICD=CODE
	S:GMTSICF="T" GMTSICD=DESC
	S:GMTSICF="N" GMTSICD=""
	Q
	;
GETCPT(GMTSCPT)	;Entry point to get CPT data
	N DIC,DIQ,DR,DA,REC
	S DIC=81,DA=GMTSCPT,DIQ="REC(",DIQ(0)="IE",DR=".01;2"
	D EN^DIQ1
	Q:'$D(REC)
	Q REC(81,DA,.01,"I")_"-"_REC(81,DA,2,"E")
	;
TXTFMT(GMTSICD,GMTSNARR,GMICL,GMTAB,DIWL)	;Formates GMTSICD & GMTSNARR together
	I GMTSICD="",GMTSNARR="" Q
	N DIWR,DIWF,X
	S DIWR=80-(GMICL+GMTAB)
	K ^UTILITY($J,"W")
	I $G(GMTSICD)]"" S X=GMTSICD S:$G(GMTSNARR)]"" X=X_"; " D ^DIWP
	I $G(GMTSNARR)]"" S X=GMTSNARR D ^DIWP
	Q
	;
ORDERPRO(GMPROV,GMLEN)	;Re-order and format providers for visit
	N GMCNT,GMTSP,GMNODE,GMP
	S GMCNT=0
	F GMP="P","S","Z" S GMTSP="" F  S GMTSP=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"P",GMP,GMTSP)) Q:GMTSP'>0  D
	. S GMNODE=^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"P",GMP,GMTSP)
	. Q:GMNODE']""
	. S GMCNT=GMCNT+1
	. S GMPROV(GMCNT)=$E($P(GMNODE,U),1,GMLEN-4)_$S(GMP="P"!(GMP="S"):" ("_GMP_")",1:"")
	Q
	;
	; THE FOLLOWING CODE SEGMENTS ARE CALLED FROM "ROUTINE"-TYPE
	;  MENU OPTIONS TO DISPLAY ITEMS IN A FILE
	;
LM	;ENTRY POINT - FOR GMTS MEASUREMENT PANEL
	S GMTSLST="^GMT(142.7," G DSPLST
	;
DSPLST	; COMMON CODE FOR HLTH SUM MNX LISTS
	K DIR
	I '$D(@(GMTSLST_"""B"")")) W !,"NO ",$P(@(GMTSLST_"0)"),U),"S DEFINED.",! Q
	W @IOF,!!,"Existing ",$P(@(GMTSLST_"0)"),U),"S:",! S GMTSCNT=""
CONT	F  S GMTSCNT=$O(@(GMTSLST_"""B"",GMTSCNT)")) Q:GMTSCNT=""  W !,?5,GMTSCNT I (IOSL-3)<$Y S DIR(0)="E" D ^DIR W @IOF G:1'[Y QUIT
	K DIR S DIR(0)="E" D ^DIR W !
QUIT	K DIR,X,Y,GMTSLST,GMTSCNT
	Q

GMTSPXU2
GMTSPXU2	;SLC/KKA,SBW - PCE Drivers for visits ;13-MAY-94
	;;2.7;Health Summary;;Oct 20, 1995
MENU(DFN,GMTSPX2,GMTSPX1)	; HS Selection Menu
	; Allows user to choose Outpatient Visits based on V files or 
	; Inpatient visits based on patient movement file.
	N DIR,SEL,DTOUT,DIRUT
	S (GMTSPX2,GMTSPX1)=""
	; If PCE not installed just allow for inpatient range selection
	I $$VERSION^XPDUTL("PX")'>0 D INPAT^GMTSPXU2(DFN,.GMTSPX1,.GMTSPX2) Q
	S DIR(0)="SO^1:Outpatient Visit Date;2:Admission Date"
	S DIR("?")="Select 1 or 2 or ^ to exit"
	D ^DIR
	Q:$D(DIRUT)!(+$G(Y)'>0)
	S SEL=+Y
	D:SEL=1 OUTPAT^GMTSPXU2(DFN,.GMTSPX2,.GMTSPX1)
	D:SEL=2 INPAT^GMTSPXU2(DFN,.GMTSPX2,.GMTSPX1)
	Q
OUTPAT(DFN,DATEFROM,DATETO)	; Selection by Outpatient Visit date
	N INPDATE,DIRUT,DTOUT
	D OUTLOOK(DFN,.INPDATE)
	Q:INPDATE']""
	I INPDATE]"" S (DATEFROM,DATETO)=$P(INPDATE,".")
	Q
INPAT(DFN,DATEFROM,DATETO)	; Selection by Inpatient Visit date
	N DIRUT,DTOUT
	D INLOOK(DFN,.DATEFROM,.DATETO)
	I DATEFROM']""!(DATETO']"") S (DATEFROM,DATETO)=""
	Q
INLOOK(DFN,GMTSADM,GMTSDC)	; Displays patient's Admission Dates
	N DIR,Y,X,ADT,RECNR,CTR,HIT,DCDT,ADMDT,SELNR
	S (GMTSADM,GMTSDC)=""
	I '$D(^DGPM("ATID1",DFN)) W !!,"No admissions on file for this patient" Q
	K ^TMP("GMTSPX",$J)
	S (CTR,HIT,ADT,SELNR)=0
	F  S ADT=$O(^DGPM("ATID1",DFN,ADT)) Q:+ADT'>0  D  Q:$D(DIRUT)!+$G(Y)
	. S RECNR=0
	. F  S RECNR=$O(^DGPM("ATID1",DFN,ADT,RECNR)) Q:RECNR'>0  D  Q:$D(DIRUT)!+$G(Y)
	. . S ADMDT=$P(^DGPM(RECNR,0),U)
	. . S DCDT=$P($G(^DGPM(+$P(^DGPM(RECNR,0),U,17),0)),U)
	. . D:'HIT INHDR S HIT=1,SELNR=SELNR+1,CTR=CTR+1
	. . W !,?7,SELNR,?15,$$FMTE^XLFDT(ADMDT,"2P")
	. . W:DCDT]"" ?45,$$FMTE^XLFDT(DCDT,"2P")
	. . S ^TMP("GMTSPX",$J,SELNR)=ADMDT_U_DCDT
	. . I CTR>9 D  Q:$D(DTOUT)!$D(DUOUT)!(+$G(Y)>0)
	. . . S DIR("A")="Enter a number between 1 and "_SELNR_", press return to continue or '^' to exit: "
	. . . S DIR(0)="NOA^1:"_SELNR D ^DIR S CTR=0 W !
	Q:$D(DUOUT)!$D(DTOUT)!$D(DIROUT)
	I SELNR>0,(CTR>0),(CTR'>9)&(+$G(Y)'>0) D
	. S DIR("A")="Enter a number between 1 and "_SELNR_": "
	. S DIR(0)="NOA^1:"_SELNR D ^DIR W !
	Q:$D(DUOUT)!$D(DTOUT)!$D(DIROUT)!(+$G(Y)'>0)
	S GMTSADM=$P($P($G(^TMP("GMTSPX",$J,+Y)),U),".")
	S GMTSDC=$P($P($G(^TMP("GMTSPX",$J,+Y)),U,2),".")
	I GMTSADM]"",GMTSDC="" S GMTSDC=DT ;Use today's data if patient isn't discharged
	K ^TMP("GMTSPX",$J)
	Q
INHDR	; Based on the VISIT file
	W !!,?15,"ADMISSION DATE/TIME",?45,"DISCHARGE DATE/TIME",!
	Q
OUTLOOK(DFN,OUT)	; Display outpatient visits
	; This option displays outpatient visits from the Visit (#9000010) file
	; to the screen. Outpatient visits = visits with a service category of
	; Ambulatory, Observation, Day Surgery, or Nursing Home
	; A number, the visit date, and the hospital location
	; or credit stop will be display on the screen. The order of the
	; display will be from most recent visits to oldest visits. The
	; user can pick the visit they want and the visit date is passed back
	; to the calling routine by parameter passing by reference.  
	;
	N DIR,Y,X,VISITDT,CTR,SELNR,RECNR,CLINIC,HIT,VISIT,HLOC
	S OUT=""
	K ^TMP("HS",$J),^TMP("PXV",$J)
	S (CTR,HIT,SELNR,VISITDT,RECNR)=0
	S VISITDT="",RECNR=""
	F  D VISIT^PXRHS14(DFN,.VISITDT,.RECNR,1,"ASOR") Q:VISITDT'>0  D  Q:$D(DUOUT)!$D(DTOUT)!(+$G(Y)>0)
	. S NODE=$G(^TMP("PXV",$J,VISITDT,RECNR))
	. K ^TMP("PXV",$J)
	. Q:NODE']""
	. S VISIT=$P(NODE,U)
	. S CLINIC=$P(NODE,U,4)
	. S HLOC=$P(NODE,U,6)
	. D:'HIT OUTHDR S HIT=1 S SELNR=SELNR+1,CTR=CTR+1
	. W !,?7,SELNR,?15,$$FMTE^XLFDT(VISIT,"2P"),?45,$S(HLOC]"":HLOC,1:CLINIC)
	. S ^TMP("HS",$J,SELNR)=RECNR_U_VISIT_U_CLINIC_U_HLOC
	. I CTR>9 D  Q:$D(DTOUT)!$D(DUOUT)!(+$G(Y)>0)
	. . S DIR("A")="Enter a number between 1 and "_SELNR_", press return to continue or '^' to exit: "
	. . S DIR(0)="NOA^1:"_SELNR D ^DIR S CTR=0 W !
	I SELNR>0&(CTR>0)&(CTR'>9) D
	. S DIR("A")="Enter a number between 1 and "_SELNR_": "
	. S DIR(0)="NOA^1:"_SELNR D ^DIR W !
	I SELNR'>0 W !!,"No Outpatient visits for this patient" Q
	S OUT=$P($G(^TMP("HS",$J,+$G(Y))),U,2)
	K ^TMP("HS",$J),^TMP("PXV",$J)
	Q
OUTHDR	; Header for screen Display
	W !!,?15,"VISIT DATE/TIME",?45,"HOSPITAL LOCATION/CLINIC",!
	Q

GMTSPXXP
GMTSPXXP	;SLC/SBW - PCE Examination routine ;12-JUL-94
	;;2.7;Health Summary;;Oct 20, 1995
MRE	; MOST RECENT EXAMINATION OF EACH TYPE WITHIN DATE RANGE
	K ^TMP("PXE",$J)
	N MAX
	S MAX=1 ;This routine could be expanded to included occurrence
	;        limits by setting max to GMTSNDM and enabling occurrence
	;        limit for the component. Component name would have to 
	;        change also.
	D EXAM^PXRHS05(DFN,GMTSEND,GMTSBEG,MAX)
	Q:'$D(^TMP("PXE",$J))
	N GMEXAM,GMDT,GMIFN,GMW,GMSITE,GMN0,GMN1,X,GMTSDAT,EXAM,RESULT
	S GMEXAM=""
	F  S GMEXAM=$O(^TMP("PXE",$J,GMEXAM)) Q:GMEXAM=""  D  Q:$D(GMTSQIT)
	. S (GMDT,GMW)=0
	. F  S GMDT=$O(^TMP("PXE",$J,GMEXAM,GMDT)) Q:GMDT'>0  D  Q:$D(GMTSQIT)
	. . S GMIFN=0
	. . F  S GMIFN=$O(^TMP("PXE",$J,GMEXAM,GMDT,GMIFN)) Q:GMIFN'>0  D EXAMDSP Q:$D(GMTSQIT)
	K ^TMP("PXE",$J)
	Q
EXAMDSP	; Display Exam data
	S GMN0=$G(^TMP("PXE",$J,GMEXAM,GMDT,GMIFN,0))
	Q:GMN0']""
	S GMN1=$G(^TMP("PXE",$J,GMEXAM,GMDT,GMIFN,1))
	S GMSITE=$S($P(GMN1,U,3)]"":$E($P(GMN1,U,3),1,10),$P(GMN1,U,4)]"":$E($P(GMN1,U,4),1,10),1:"No Site")
	S X=$P(GMN0,U,2) D REGDT^GMTSU S GMTSDAT=X
	S EXAM=$P(GMN0,U),RESULT=$P(GMN0,U,4)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMW'>0!GMTSNPG EXAM
	W ?32,GMTSDAT,?42,RESULT,?52,GMSITE,!
	S GMW=1
	Q

GMTSRAD
GMTSRAD	;SLC/ARS,JER - Radiology Request Status Component ;2/9/94  17:00
	;;2.7;Health Summary;;Oct 20, 1995
ENRAD	; Entry Point for HS only
	N MAX K ^TMP("GMTSRAD",$J)
	S MAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
	I '$D(^RAO(75.1,"AS",DFN)) Q
	D GET
	I '$D(^TMP("GMTSRAD",$J)) Q
	D LOOP
	K ^TMP("GMTSRAD",$J)
	Q
GET	; Extract radiology orders
	N DA,DIC,DIQ,DR,GMI,GMOUT,GMP,GMRDT,GMSTAT,GMPRC,GMSDT,GMDOC S GMI=0
	F  S GMI=$O(^RAO(75.1,"AS",DFN,GMI)) Q:+GMI'>0!+$G(GMOUT)  D
	. S DA=0 F  S DA=$O(^RAO(75.1,"AS",DFN,GMI,DA)) Q:+DA'>0!+$G(GMOUT)  D
	. . N GMORD
	. . S DIC="^RAO(75.1,",DIQ="GMORD(",DIQ(0)="IE",DR="2;5;14;16;23"
	. . D EN^DIQ1
	. . S GMRDT=$G(GMORD(75.1,DA,16,"I")),GMSTAT=$G(GMORD(75.1,DA,5,"E"))
	. . I $S(GMRDT>GMTSEND:1,GMRDT<GMTSBEG:1,1:0) Q
	. . S GMPRC=$G(GMORD(75.1,DA,2,"E")),GMP=$G(GMORD(75.1,DA,2,"I"))
	. . S GMSDT=$G(GMORD(75.1,DA,23,"I")),GMDOC=$E($G(GMORD(75.1,DA,14,"E")),1,14)
	. . I $L(GMPRC)>24 S GMPRC=$$WRAP^GMTSORC(GMPRC,24)
	. . S GMSTAT=$E($$LOW^XLFSTR(GMSTAT))
	. . S ^TMP("GMTSRAD",$J,9999999-GMRDT,+GMP)=GMRDT_U_GMSTAT_U_GMPRC_U_GMSDT_U_GMDOC
	Q
HDR	; Write column header
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Request DT",?13,"Status",?21,"Procedure",?47,"Scheduled DT",?65,"Provider",!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
LOOP	; Loops through ^TMP("GMTSRAD",$J,
	N GMCNT,GMI,GMRDT,GMREC S (GMCNT,GMRDT)=0
	D HDR
	F  S GMRDT=$O(^TMP("GMTSRAD",$J,GMRDT)) Q:+GMRDT'>0!(GMCNT=MAX)  D
	. S GMI=0
	. F  S GMI=$O(^TMP("GMTSRAD",$J,GMRDT,GMI)) Q:+GMI'>0!(GMCNT=MAX)  D
	. . S GMREC=$G(^TMP("GMTSRAD",$J,GMRDT,GMI)),GMCNT=GMCNT+1 D WRT
	Q
WRT	; Write record
	N GMI,GMRDT,GMSTAT,GMPRC,GMSDT,GMDOC,X
	S X=+GMREC D REGDT^GMTSU S GMRDT=X,GMSTAT=$P(GMREC,U,2)
	S GMPRC=$P(GMREC,U,3)
	S X=$P(GMREC,U,4) D REGDTM^GMTSU S GMSDT=X,GMDOC=$P(GMREC,U,5)
	D CKP^GMTSUP Q:$D(GMTSQIT)  D
	. I GMTSNPG D HDR
	. W GMRDT,?15,GMSTAT,?21,$P(GMPRC,"|"),?47,GMSDT,?65,GMDOC,!
	F GMI=2:1:$L(GMPRC,"|") D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HDR W ?22,$P(GMPRC,"|",GMI),!
	Q

GMTSRAE
GMTSRAE	;SLC/JER - Selected Radiology Extract ;11/16/94  08:53
	;;2.7;Health Summary;;Oct 20, 1995
MAINSEL(MODE,TEST)	; Controls branching and execution for components with
	; selection items
	N GMIDT,GMCNT,GMPN
	K ^TMP("RAE",$J)
	S GMCNT=0,GMIDT=GMTS1+.9999,GMTS2=GMTS2+.9999
	F  S GMIDT=$O(^RADPT(DFN,"DT","AP",TEST,GMIDT)) Q:GMIDT'>0!(GMIDT>GMTS2)!(GMCNT=MAX)  D
	. S GMPN=0 F  S GMPN=$O(^RADPT(DFN,"DT","AP",TEST,GMIDT,GMPN)) Q:GMPN'>0!(GMCNT=MAX)  D
	. . S GMCNT=GMCNT+1 D GET
	Q
MAIN(MODE)	; Controls branching and execution
	N GMIDT,GMCNT,GMPN
	K ^TMP("RAE",$J)
	S GMCNT=0,GMIDT=GMTS1+.9999,GMTS2=GMTS2+.9999
	F  S GMIDT=$O(^RADPT(DFN,"DT",GMIDT)) Q:GMIDT'>0!(GMIDT>GMTS2)!(GMCNT=MAX)  D
	. S GMPN=0 F  S GMPN=$O(^RADPT(DFN,"DT",GMIDT,"P",GMPN)) Q:GMPN'>0!(GMCNT=MAX)  D
	. . S GMCNT=GMCNT+1 D GET
	Q
GET	; Gets data associated with study and sets ^TMP("RAE",$J,
	N DA,DIC,DIQ,DR,GMCPT,GMED,GMRP,GMRPI,GMST,GMPTR,GMRSTAT,GMIRSTAT
	N GMI,GMRAD,GMRRAD,GMSRAD
	S GMED=+^RADPT(DFN,"DT",GMIDT,0)
	S DIC="^RADPT("_DFN_",""DT"","_GMIDT_",""P"",",DA=GMPN,DIQ="GMRAD("
	S DIQ(0)="IE",DR="2;3;12;15;17;175" D EN^DIQ1
	S GMRP=$G(GMRAD(70.03,GMPN,2,"E")),GMRPI=$G(GMRAD(70.03,GMPN,2,"I")),GMST=$G(GMRAD(70.03,GMPN,3,"E"))
	S GMRRAD=$E($G(GMRAD(70.03,GMPN,12,"E")),1,18)
	S GMSRAD=$E($G(GMRAD(70.03,GMPN,15,"E")),1,18)
	S GMPTR=$G(GMRAD(70.03,GMPN,17,"I"))
	S DIC=DIC_DA_",""M"",",DA=0 F  S DA=$O(@(DIC_DA_")")) Q:+DA'>0  D
	. S DR=".01" D EN^DIQ1
	I +GMPTR>0 S DIC="^RARPT(",DA=GMPTR,DIQ="GMRAD(",DIQ(0)="IE",DR="5" D EN^DIQ1
	S GMRSTAT=$G(GMRAD(74,+GMPTR,5,"E"))
	S GMIRSTAT=$G(GMRAD(74,+GMPTR,5,"I"))
	S GMCPT=$P($G(^RAMIS(71,+GMRPI,0)),U,9)
	S ^TMP("RAE",$J,GMIDT,GMPN,0)=GMED_U_GMRP_U_GMST_U_GMRSTAT_U_GMRRAD_U_GMSRAD_U_GMCPT
	I GMIRSTAT'="V",($E(IOST)="P") Q  ; Only verified reports can be printed
	I $S(GMIRSTAT="V":0,GMIRSTAT="R":0,1:1) Q  ; Only verified and Released/Unverified can be seen on the terminal
	S GMI=0 F  S GMI=$O(GMRAD(70.1,GMI)) Q:+GMI'>0  D
	. S ^TMP("RAE",$J,GMIDT,GMPN,"M",GMI)=$G(GMRAD(70.1,GMI,.01,"E"))
	I $D(^RARPT(+GMPTR,"I",0)) D GETIMP
	I $G(MODE)=2,$D(^RARPT(+GMPTR,"H",0)) D GETHIS
	I $G(MODE)=2,$D(^RARPT(+GMPTR,"R",0)) D GETREP
	Q
GETIMP	; Gets Radiologist's Impression
	N GMLN,X
	K ^UTILITY($J,"W") S GMLN=0 F  S GMLN=$O(^RARPT(GMPTR,"I",GMLN)) Q:GMLN'>0  S X=^RARPT(GMPTR,"I",GMLN,0) D FORMAT
	I $D(^UTILITY($J,"W")) F GMLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMIDT,GMPN,"I",GMLN)=^UTILITY($J,"W",3,GMLN,0)
	K ^UTILITY($J,"W")
	Q
GETHIS	; Gets Clinical History
	N GMLN,X
	K ^UTILITY($J,"W") S GMLN=0 F  S GMLN=$O(^RARPT(GMPTR,"H",GMLN)) Q:GMLN'>0  S X=^RARPT(GMPTR,"H",GMLN,0) D FORMAT
	I $D(^UTILITY($J,"W")) F GMLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMIDT,GMPN,"H",GMLN)=^UTILITY($J,"W",3,GMLN,0)
	K ^UTILITY($J,"W")
	Q
GETREP	; Gets Radiologist's Report
	N GMLN,X
	K ^UTILITY($J,"W") S GMLN=0 F  S GMLN=$O(^RARPT(GMPTR,"R",GMLN)) Q:GMLN'>0  S X=^RARPT(GMPTR,"R",GMLN,0) D FORMAT
	I $D(^UTILITY($J,"W")) F GMLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMIDT,GMPN,"R",GMLN)=^UTILITY($J,"W",3,GMLN,0)
	K ^UTILITY($J,"W")
	Q
FORMAT	; Calls ^DIWP to format each line of text
	N DIWF,DIWL,DIWR,I,J,Y,Z
	S DIWF="C"_$S(MODE=1:73,1:58)_"R",DIWL=3,DIWR=$S(MODE=1:76,1:61)
	D ^DIWP
	Q

GMTSRAI
GMTSRAI	;SLC/JER - Radiology Impression Component ;9/8/94  14:16
	;;2.7;Health Summary;;Oct 20, 1995
ENSRA	; Controls branching
	N GMDATA,GMTSI,GMW,MAX,TEST
	S MAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
	I '$D(^RADPT(DFN,0)) Q
	D MAIN^GMTSRAE(1)
	I '$D(^TMP("RAE",$J)) Q
	D LOOP
	K ^TMP("RAE",$J)
	Q
LOOP	; Loops through ^TMP("RAE",$J,
	N GMW,GMIDT,GMPN,GMLN
	S GMIDT=0 F  S GMIDT=$O(^TMP("RAE",$J,GMIDT)) Q:GMIDT'>0  S GMPN=0 F  S GMPN=$O(^TMP("RAE",$J,GMIDT,GMPN)) Q:GMPN'>0  D WRT
	Q
WRT	; Writes component data
	N X,GMEDT,GMPROC,GMTSCPT,GMRSTAT,GMTXT
	S GMDATA=1
	S X=+^TMP("RAE",$J,GMIDT,GMPN,0) D REGDT^GMTSU S GMEDT=X
	S GMPROC=$P(^TMP("RAE",$J,GMIDT,GMPN,0),U,2),GMRSTAT=$P(^(0),U,4),GMTSCPT=$P(^(0),U,7)
	I $L(GMPROC)>35 S GMPROC=$$WRAP^GMTSORC(GMPROC,35)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W GMEDT,?10,$P(GMPROC,"|"),?50,"CPT ",GMTSCPT,?61,$E(GMRSTAT,1,19),!
	F GMI=2:1:$L(GMPROC,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMPROC,"|",GMI)]"" ?23,$P(GMPROC,"|",GMI),!
	S GMTXT=0 F  S GMTXT=$O(^TMP("RAE",$J,GMIDT,GMPN,"I",GMTXT)) Q:GMTXT'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,^TMP("RAE",$J,GMIDT,GMPN,"I",GMTXT),!
	Q

GMTSRAS
GMTSRAS	;SLC/JER - Radiology Profile Component ;10/21/94  14:11
	;;2.7;Health Summary;;Oct 20, 1995
ENSRA	; Controls branching
	N GMDATA,GMTSI,GMW,MAX,TEST
	S MAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
	I '$D(^RADPT(DFN,0)) Q
	D MAIN^GMTSRAE(2)
	I '$D(^TMP("RAE",$J)) Q
	D LOOP
	K ^TMP("RAE",$J)
	Q
LOOP	; Loops through ^TMP("RAE",$J,
	N GMW,GMIDT,GMPN,GMLN
	S GMIDT=0 F  S GMIDT=$O(^TMP("RAE",$J,GMIDT)) Q:GMIDT'>0  D
	. S GMPN=0 F  S GMPN=$O(^TMP("RAE",$J,GMIDT,GMPN)) Q:GMPN'>0  D
	. . D WRT
	. . I +$O(^TMP("RAE",$J,GMIDT)) D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	Q
WRT	; Writes component data
	N X,GMEDT,GMI,GMPROC,GMRCPT,GMSTAT,GMTXT,GMRSTAT,GMRRAD,GMSRAD
	S GMDATA=1
	S X=+^TMP("RAE",$J,GMIDT,GMPN,0) D REGDT^GMTSU S GMEDT=X
	S GMPROC=$P(^TMP("RAE",$J,GMIDT,GMPN,0),U,2),GMSTAT=$P(^(0),U,3)
	S GMRCPT=$P(^TMP("RAE",$J,GMIDT,GMPN,0),U,7)
	S GMRSTAT=$P(^TMP("RAE",$J,GMIDT,GMPN,0),U,4),GMRRAD=$P(^(0),U,5)
	S GMSRAD=$P(^TMP("RAE",$J,GMIDT,GMPN,0),U,6)
	I $L(GMPROC)>35 S GMPROC=$$WRAP^GMTSORC(GMPROC,35)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W GMEDT,?12,$P(GMPROC,"|"),?53,"Status: ",GMSTAT,!
	F GMI=2:1:$L(GMPROC,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMPROC,"|",GMI)]"" ?14,$P(GMPROC,"|",GMI),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,"CPT Code: ",GMRCPT,?49,"Rpt Status: ",$E(GMRSTAT,1,19),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?42,"Staff Radiologist: ",GMSRAD,!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?43,"Res. Radiologist: ",GMRRAD,!
	I $D(^TMP("RAE",$J,GMIDT,GMPN,"M")) D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W ?2,"Modifier: "
	. S GMI=0 F  S GMI=$O(^TMP("RAE",$J,GMIDT,GMPN,"M",GMI)) Q:+GMI'>0  D
	. . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,^TMP("RAE",$J,GMIDT,GMPN,"M",GMI),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  I $D(^TMP("RAE",$J,GMIDT,GMPN,"H")) W ?3,"History: " D
	. S GMTXT=0 F  S GMTXT=$O(^TMP("RAE",$J,GMIDT,GMPN,"H",GMTXT)) Q:GMTXT'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,^TMP("RAE",$J,GMIDT,GMPN,"H",GMTXT),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  I $D(^TMP("RAE",$J,GMIDT,GMPN,"R")) W ?4,"Report: " D
	. S GMTXT=0 F  S GMTXT=$O(^TMP("RAE",$J,GMIDT,GMPN,"R",GMTXT)) Q:GMTXT'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,^TMP("RAE",$J,GMIDT,GMPN,"R",GMTXT),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  I $D(^TMP("RAE",$J,GMIDT,GMPN,"I")) W "Impression: " D
	. S GMTXT=0 F  S GMTXT=$O(^TMP("RAE",$J,GMIDT,GMPN,"I",GMTXT)) Q:GMTXT'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,^TMP("RAE",$J,GMIDT,GMPN,"I",GMTXT),!
	Q

GMTSRASP
GMTSRASP	;SLC/JER - Selected Radiology Component ;1/13/94  17:45
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Controls branching
	N GMTSI,GMW,MAX,TEST
	S MAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
	I '$D(^RADPT(DFN,0)) Q
	I '$O(GMTSEG(GMTSEGN,71,0)) Q
	S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,71,GMTSI)) Q:GMTSI'>0  S TEST=GMTSEG(GMTSEGN,71,GMTSI) D MAINSEL^GMTSRAE(1,TEST),LOOP:$D(^TMP("RAE",$J))
	K ^TMP("RAE",$J)
	Q
LOOP	; Loops through ^TMP("RAE",$J,
	N GMW,GMIDT,GMPN,GMLN
	S GMIDT=0 F  S GMIDT=$O(^TMP("RAE",$J,GMIDT)) Q:GMIDT'>0  S GMPN=0 F  S GMPN=$O(^(GMIDT,GMPN)) Q:GMPN'>0  D WRT
	Q
WRT	; Writes component data
	N X,GMEDT,GMPROC,GMTSCPT,GMRSTAT,GMTXT
	S GMDATA=1
	S X=+^TMP("RAE",$J,GMIDT,GMPN,0) D REGDT^GMTSU S GMEDT=X
	S GMPROC=$P(^TMP("RAE",$J,GMIDT,GMPN,0),U,2),GMRSTAT=$P(^(0),U,4),GMTSCPT=$P(^(0),U,7)
	I $L(GMPROC)>35 S GMPROC=$$WRAP^GMTSORC(GMPROC,35)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W GMEDT,?10,"CPT ",GMTSCPT,?21,$P(GMPROC,"|"),?61,$E(GMRSTAT,1,19),!
	F GMI=2:1:$L(GMPROC,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMPROC,"|",GMI)]"" ?23,$P(GMPROC,"|",GMI),!
	S GMTXT=0 F  S GMTXT=$O(^TMP("RAE",$J,GMIDT,GMPN,"I",GMTXT)) Q:GMTXT'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?3,^TMP("RAE",$J,GMIDT,GMPN,"I",GMTXT),!
	Q

GMTSRI
GMTSRI	;SLC/DLT - Health Summary Type Inquiry ;2/7/91  15:08 ;1/23/90  11:15 ;
	;;2.7;Health Summary;;Oct 20, 1995
	S U="^",DIC="^GMT(142,",DIC(0)="AEMQF",DIC("A")="Select Health Summary Type: " D ^DIC K DIC("A") G:Y=-1 END S (FR,TO)=$P(Y,"^",2)
	S BY=".01",DHD="[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]",FLDS="[GMTS TYPE INQ]",L=0 D EN1^DIP
END	Q

GMTSRM
GMTSRM	;SLC/DLT - Create/Modify Health Summary Type ;9/29/92  13:40 ;
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	;Main loop to modify multiple health summary types
	N %,DTOUT,DUOUT,DIRUT,EXISTS,GMTSFUNC,GMTSQIT,P
	S GMTSQIT=0 F  S EXISTS=0 D SELTYP Q:GMTSQIT
	Q
SELTYP	; Select Health Summary Type to Edit
	N CHANGE,DA,DIC,DIE,DLAYGO,DR,DUOUT,EXISTS,GMTSUM,GMTSNEW,GMTSMGR
	N GMTSEG,GMTSIFN,SELCNT,X,Y
	W ! S U="^",DIC="^GMT(142,",DIC(0)="AEIMQL"
	S DIC("A")="Select Health Summary Type: "
	S DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION""",DLAYGO=142
	D ^DIC K DIC S:+Y'>0 GMTSQIT=1 Q:+Y'>0  S (GMTSIFN,DA)=+Y
	S GMTSUM=$P(Y,U,2),GMTSNEW=+$P(Y,U,3),GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,1:0)
	I 'GMTSMGR,($P(^GMT(142,+DA,0),U,2)]"") D  Q:'GMTSMGR
	. S GMTSMGR=$D(^XUSEC($P(^(0),U,2),DUZ))
	. W:'GMTSMGR !,$C(7),"This summary report is currently locked to prevent alteration.",!
	I 'GMTSMGR,'GMTSNEW,($P(^GMT(142,+DA,0),U,3)'=DUZ) W !,$C(7),"Alteration of this summary report is restricted to its owner.",!,"See the Clinical Coordinator if you need additional help." Q
	S DIE="^GMT(142,",(GMTSIFN,DA)=+Y,DR="[GMTS EDIT HLTH SUM TYPE]" D ^DIE
	I '$D(^GMT(142,+GMTSIFN,0))!$D(Y)!$D(DUOUT)!$D(DIROUT)!$D(DTOUT) S GMTSQIT=1 Q
	I 'GMTSNEW,($O(^GMT(142,+GMTSIFN,1,0))) S EXISTS=1 D LIST,EXISTS Q
	D SELCMP^GMTSRM5 Q:GMTSQIT  D LIST:EXISTS,EXISTS
	Q
ENADHOC	; Entry point for AD HOC edit
	N %,C,CHANGE,DA,DIC,DIE,DR,DUOUT,EXISTS,I,GMTSIFN,GMTSN,GMTSNCNT,GMTSNEW
	N GMTSIFN,GMTSUM,P,SELCNT
	N GMTSQIT,GMTSFUNC,X,Y
	W !!,">>> EDITING the GMTS HS ADHOC OPTION Health Summary Type"
	S (GMTSNEW,GMTSQIT)=0
	S DIC=142,DIC(0)="XZF",X="GMTS HS ADHOC OPTION" D ^DIC I +Y'>0 D ^GMTSLOAD Q:$D(DIRUT)!$D(DIROUT)  G ENADHOC
	S GMTSIFN=+Y,GMTSUM=$P(Y,U,2),EXISTS=1
	S DIE="^GMT(142,",DA=GMTSIFN,DR=".08T" D ^DIE
	Q:$D(Y)
	D LIST,EXISTS
	Q
EXISTS	;Edit an existing health summary type
	N CNT,NXTCMP
	Q:$D(DUOUT)
	S NXTCMP=0 ;NXTCMP tracks whether any component changes may have been made.
	S NXTCMP(0)=0 F CNT=$$GETCNT(GMTSIFN):0 D NXTCMP^GMTSRM1,LIST:GMTSQIT Q:GMTSQIT!($D(DUOUT))  K GMTSQIT,GMTSNEW,TWEENER,SOACTION
	I NXTCMP>0 W !,"Please hold on while I resequence the summary order" D COPY^GMTSRN,RNMBR^GMTSRN:CHANGE
	Q
LIST	; Lists existing summary parameters
	N B,DIC,DIR,IOP,Y,FR,TO,BY,DHD,FLDS,L
	I GMTSQIT'=2 Q:($D(DUOUT)!(GMTSQIT=1))  ;List after return from NXTCMP^GMTSRM1
	I GMTSQIT=2,(NXTCMP=0) S GMTSQIT=0 Q
	I 'GMTSNEW W ! S DIC=142,DIR(0)="Y",DIR("A")="Do you wish to review the Summary Type structure before continuing",DIR("B")="NO" D ^DIR K DIR I 'Y S:GMTSQIT=2 DUOUT="" S:GMTSQIT=2 GMTSQIT="D" S:$D(DUOUT) GMTSQIT=1 Q
	I $D(GMTSQIT),GMTSQIT=2 S GMTSQIT=0 ;Allow for reiterative updates of Components.
	S IOP="HOME",DIC=142,(FR,TO)=GMTSUM,BY=".01",DHD="[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]",FLDS="[GMTS TYPE INQ]",L=0 D EN1^DIP
	Q
GETCNT(GMTSIFN)	; Determine default summary order for new component
	N LI,LCNT
	S LI=0,LCNT=5 F  S LI=$O(^GMT(142,+GMTSIFN,1,LI)) Q:+LI'>0  S LCNT=$P(LI,".")+5
	Q LCNT

GMTSRM1
GMTSRM1	;SLC/JER,DLT - Create/Modify Health Summary (cont'd) ;10/1/92  10:52
	;;2.7;Health Summary;;Oct 20, 1995
NXTCMP	;Edit, add, or delete components from existing Health Summary structure
	N CMP,D0,DI,DIC,DIR,OLDSO,SEL,X,Y K DIRUT
	K DUOUT S GMTSQIT=0,GMTSNEW=0
	S DIC="^GMT(142.1,",DIC(0)="AEMQ",D="B",DIC("W")="W ?40,"" "",$P(^(0),U,4)",DIC("A")="Select COMPONENT: ",DIC("S")="I $P(^(0),U,6)'=""P""" S:$D(GMCMP) DIC("B")=$P(^GMT(142.1,+GMCMP,0),U)
	D ^DIC K DIC S:('$D(DTOUT)&('$D(DUOUT))&(Y=-1)) GMTSQIT=2 S:'$T!(Y=-1&(X'="^LOOP")) DUOUT=1
	I $D(DUOUT),(X="^LOOP") K DUOUT D LOOP K DUOUT Q
	I $D(DUOUT) Q
	D CHKCMP Q:$D(DUOUT)!(GMTSQIT)!(GMTSQIT="D")
	S DIR(0)="142.01,.01",DIR("B")=+$G(CNT) D ^DIR K DIR K:$D(DUOUT) DUOUT D:'$D(DIRUT) CHKSO^GMTSRM1A Q:$D(DIRUT)!(GMTSQIT)
	D ASKCMP I $D(GMCMP) S DUOUT=""
	Q
LOOP	; Loop through STRUCTURE multiple and call ASKCMP for each
	N GMI,GMJ
	S GMI=0 F  S GMI=$O(^GMT(142,GMTSIFN,1,GMI))  Q:GMI'>0!$D(DUOUT)!+GMTSQIT!(GMTSQIT="D")  D
	. N CMP,DIR,X,Y
	. S CMP=$P(^GMT(142,GMTSIFN,1,GMI,0),U,2),CMP("NM")=$P($G(^GMT(142.1,+CMP,0)),U),CMP(1)=+CMP
	. S CMP(0)=$G(^GMT(142,+GMTSIFN,1,+GMI,0))
	. S CMP(.01)=GMI
	. S GMJ=0 F  S GMJ=$O(^GMT(142,+GMTSIFN,1,+GMI,1,GMJ)) Q:+GMJ'>0  D
	. . S CMP(142.14,GMJ)=$G(^GMT(142,GMTSIFN,1,GMI,1,GMJ,0))
	. W !!?3,CMP("NM")
	. S (NXTCMP,NXTCMP(0))=NXTCMP+1 D ASKCMP I $D(Y),'$D(DTOUT) D
	. . S DIR(0)="Y",DIR("A")="WANT TO STOP LOOPING",DIR("B")="YES"
	. . D ^DIR K DIR W ! I +Y S GMTSQIT="D" W !!?4,"LOOP ENDED!",!!
	Q
ASKCMP	; Ask parameters for each component
	N IEN,MAXOCC,TIME,OLDLIM,OLDOCC,OLDHEAD,OLDSO,SELCNT,GMTSNCNT
	N HOSP,ICD,PROV,OLDHOSP,OLDICD,OLDPROV
	S MAXOCC=$S($P(^GMT(142.1,CMP(1),0),U,5)="Y":1,1:0)
	S TIME=$S($P(^GMT(142.1,CMP(1),0),U,3)="Y":1,1:0)
	S HOSP=$S($P(^GMT(142.1,CMP(1),0),U,10)="Y":1,1:0)
	S ICD=$S($P(^GMT(142.1,CMP(1),0),U,11)="Y":1,1:0)
	S PROV=$S($P(^GMT(142.1,CMP(1),0),U,12)="Y":1,1:0)
	S OLDOCC=$P(CMP(0),U,3),OLDLIM=$P(CMP(0),U,4)
	S OLDHOSP=$P(CMP(0),U,6),OLDICD=$P(CMP(0),U,7),OLDPROV=$P(CMP(0),U,8)
	S OLDHEAD=$S($L($P(CMP(0),U,5)):$P(CMP(0),U,5),$L($P(^GMT(142.1,+CMP(1),0),U,9)):$P(^(0),U,9),1:"")
	S SEL=$O(^GMT(142.1,CMP(1),1,0))
	I SEL D
	. S SEL(0)=^GMT(142.1,CMP(1),1,SEL,0),SEL=$P(SEL(0),U),SELCNT=$P(SEL(0),U,2)
	. I SEL S DIC("V")="I +Y(0)=SEL",IEN=0,DIC(0)="AEMQ" F  S IEN=$O(CMP(142.14,IEN)) Q:'IEN  D LOADSEL^GMTSRM1A
	I EXISTS=0 S EXISTS=1
	I '$D(^GMT(142,GMTSIFN,1,0)) S ^(0)="^142.01IA^0^0",GMTSNEW=1
	I GMTSNEW D
	. S DR=".01///^S X=CMP(.01);1///^S X=CMP(1);2///^S X=OLDOCC;3///^S X=OLDLIM;6///^S X=OLDHOSP;7///^S X=OLDICD;8///^S X=OLDPROV;"
	E  S DR="1///^S X=CMP(1);"
	S DR=DR_"I MAXOCC=0 S Y=""@1"";2//"_OLDOCC_";@1;I TIME=0 S Y=""@2"";3//"_OLDLIM_";@2;I HOSP=0 S Y=""@3"";6//"_OLDPROV_";@3"
	S DIE="^GMT(142,"_GMTSIFN_",1,",DA(1)=GMTSIFN,DA=CMP(.01) D ^DIE
	Q:$D(Y)
	S DR(2,142.14)=".01;D EXIT^GMTSRM3 I +SELCNT,(GMTSNCNT'<SELCNT) S DTOUT="""""
	S DR="I ICD=0 S Y=""@1"";7//"_OLDICD_";@1;I PROV=0 S Y=""@2"";8//"_OLDPROV_";@2;5//"_$G(OLDHEAD)_";I 'SEL S Y=0;D EN^GMTSRM3;4"
	D ^DIE
	K DIC("V")
	Q
CHKCMP	; Checks selected component for duplication - Gets parameters
	N DIR,SEL,SO,SOACTION
	K OLDSO
	S SOACTION="",CMP=+Y,CMP("NM")=$P(Y,U,2),(NXTCMP(0),NXTCMP)=NXTCMP+1
	I '$D(^GMT(142,GMTSIFN,1,"C",+CMP)) D  Q
	. S CMP(1)=+CMP,CNT=$$GETCNT^GMTSRM(GMTSIFN)
	. I +CMP>300,$O(^GMT(142.1,+CMP(1),1,0)),'$D(CMP(142.14)) D GETSEL^GMTSRM1A(.CMP)
	S SO=$O(^GMT(142,GMTSIFN,1,"C",+CMP,0))
	W !,$P(Y,U,2)," is already a component of this summary."
	S DIR(0)="SO^E:Edit component parameters;D:Delete component from summary;"
	S DIR("A")="Select Action"
	D ^DIR K DIR
	I $D(DUOUT) S NXTCMP=NXTCMP-1 Q
	I $D(DIRUT)&('$D(DTOUT)) S GMTSQIT=$S('$D(GMCMP):"D",1:1) W ! Q
	I $D(DIRUT) S GMTSQIT=1 Q
	S OLDSO=SO I Y="D" S SOACTION="D" D DELCMP^GMTSRM4 W ! S GMTSQIT="D" Q
	S SOACTION="E",CMP(1)=+CMP,CNT=SO K Y
	S CMP(0)=^GMT(142,GMTSIFN,1,SO,0)
	S SEL=0 F  S SEL=$O(^GMT(142,GMTSIFN,1,SO,1,SEL)) Q:+SEL'>0  S CMP(142.14,SEL)=^(SEL,0)
	I +CMP>100,$O(^GMT(142.1,+CMP(1),1,0)),'$D(CMP(142.14)) D
	. D GETSEL^GMTSRM1A(.CMP)
	Q

GMTSRM1A
GMTSRM1A	;SLC/JER,DLT,SBW - Create/Modify Health Summary (cont'd) ;27/APR/94
	;;2.7;Health Summary;;Oct 20, 1995
CHKSO	; Checks for existence of summary order (SO).  Allows for
	; overwrite or insertion prior to existing "structure" records
	N SO,SOACTION,DIR
	S SO=+Y,CMP(0)=$G(CMP(0))
	I $D(OLDSO),OLDSO=SO S CMP(.01)=SO Q
	I $D(OLDSO),OLDSO'=SO S SOACTION="E" D DELCMP^GMTSRM4
	I '$D(^GMT(142,GMTSIFN,1,SO,0)) S CMP(.01)=+SO,GMTSNEW=1 Q
	W !,$P(^GMT(142.1,$P(^GMT(142,GMTSIFN,1,SO,0),U,2),0),U)," Already exists at SUMMARY ORDER ",SO
	S DIR(0)="SO^O:Overwrite;I:Insert Before;A:Append After",DIR("A")="Select Action" D ^DIR K DIR I $D(DIRUT) S GMTSQIT=1 Q
	I Y="O" S SOACTION="O",OLDSO=SO D DELCMP^GMTSRM4 S GMTSNEW=1,CMP(.01)=SO Q
	I Y="I" D INSRT^GMTSRM4 Q
	I Y="A" D APPND^GMTSRM4
	Q
LOADSEL	; Load selection item multiple
	N DA,DC,DIC,DIE,DIEL,DK,DL,DM,DP,DR
	S:'$D(^GMT(142,GMTSIFN,1,CMP(.01),1,0)) ^(0)="^142.14V^^"
	S (DIC,DIE)="^GMT(142,"_GMTSIFN_",1,"_CMP(.01)_",1,",DA(2)=GMTSIFN,DA(1)=CMP(.01),DA=IEN S DR=".01////"_"^S X=CMP(142.14,IEN)" D ^DIE
	Q
GETSEL(CMP)	; Get default selection items from ad hoc for local components
	N GMI,GMJ,GMK
	S GMI=$O(^GMT(142,"B","GMTS HS ADHOC OPTION",0)) Q:+GMI'>0
	S GMJ=$O(^GMT(142,+GMI,1,"C",+CMP,0)) Q:+GMJ'>0
	S GMK=0 F  S GMK=$O(^GMT(142,+GMI,1,+GMJ,1,GMK)) Q:+GMK'>0  D
	. S CMP(142.14,GMK)=$G(^GMT(142,+GMI,1,+GMJ,1,+GMK,0))
	Q

GMTSRM2
GMTSRM2	;SLC/DLT - Create/Modify Health Summary Type- Help Processing ;1/17/91  16:09 ;
	;;2.7;Health Summary;;Oct 20, 1995
HELP	; 
	N GMI,GMTSTXT,HLP
	S HLP=$S(X="??":"HTX1",1:"HTX1") W ! F GMI=1:1 S GMTSTXT=$T(@HLP+GMI) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
	D REDISP
	Q
REDISP	; Ask Whether or not to redisplay menu
	N I,DIR,X,Y
	S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
	W @IOF
	D DISP^XQORM1 W !
	Q
HTX1	;;Help Text for "?" and "??"
	;;
	;;Select ONE or MORE items from the menu, separated by commas.
	;;
	;;ALL items may be selected by typing "ALL".
	;;
	;;EXCEPTIONS may be entered by preceding them with a minus.
	;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
	;;
	;;ZZZZ

GMTSRM3
GMTSRM3	;SLC/DLT - Create/Modify Health Summary - Edit selection items ;9/29/92
	;;2.7;Health Summary;;Oct 20, 1995
EN	;Entry logic for selection items
	N GMTSN
	W !!,$S($O(^GMT(142,DA(1),1,DA,1,0)):"Current selection items are:  ",1:"No selection items chosen.")
	S GMTSN=0 F  S GMTSN=$O(^GMT(142,DA(1),1,DA,1,GMTSN)) Q:+GMTSN'>0  S GMTSN(0)=^(GMTSN,0) D SHOWSEL
	W !!,"Select new items one at a time in the sequence you want them displayed."
	W !,"You may select " I SELCNT="" W "any number of items.",!
	E  W "up to ",SELCNT," items.",!
	Q
SHOWSEL	; Writes out current selection items
	W ?30,$P(@("^"_$P(GMTSN(0),";",2)_+GMTSN(0)_",0)"),U),!
	Q
EXIT	;Exit logic for selection items
	N GMTSN,SELREF,GMREF
	I +X,(X["LAB(60,") D
	.S SELREF=U_$P(X,";",2)_+X_",",GMREF=X
	.I '$L($P($G(@(SELREF_"0)")),U,5)) D RESOLVE(GMREF)
	I $S('$D(DA(1)):1,'$D(DA(2)):1,1:0) Q
	S (GMTSNCNT,GMTSN)=0 F  S GMTSN=$O(^GMT(142,DA(2),1,DA(1),1,GMTSN)) Q:'GMTSN  S GMTSNCNT=GMTSNCNT+1
	S $P(^GMT(142,DA(2),1,DA(1),1,0),U,4)=GMTSNCNT
	I SELCNT,(GMTSNCNT'<SELCNT) W !?2,$C(7),"MAXIMUM # OF ITEMS SELECTED.",!
	Q
RESOLVE(GMREF)	; Call ORUS to resolve compound items
	N C,IEN,GMI,GMHEAD,P,X,Y K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW")
	S GMHEAD="-- "_$P($G(^LAB(60,+GMREF,.1)),U)_" --"
	S ^XUTL("OR",$J,"GMTS",0)="LAB TEST^1^^0" D COMPILE(+GMREF)
	S ORUS="^XUTL(""OR"","_$J_",""GMTS"",",ORUS("T")="D HEADER^GMTSRM3"
	I +$G(SELCNT) D
	. S ORUS(0)="40MN^"_SELCNT
	. S ORUS("A")="Select 1 - "_SELCNT_" LAB TEST(s): ",ORUS("B")="1-"_SELCNT
	E  S ORUS(0)="40MN",ORUS("A")="Select LAB TEST(s): ",ORUS("B")="ALL"
	D EN^ORUS K ^XUTL("OR",$J,"GMTS"),^("ORU"),^("ORV"),^("ORW")
	I $S('$D(CMP(142.14,DA)):1,$G(CMP(142.14,DA))=GMREF:1,1:0) D
	. I $D(CMP(142.14,+$O(CMP(142.14,DA)))) D
	. . S GMI=DA F  S GMI=$O(CMP(142.14,GMI)) Q:+GMI'>0!(GMI'<(DA+Y))  S CMP(142.14,GMI+Y)=CMP(142.14,GMI)
	. S GMI=0 F  S GMI=$O(Y(GMI)) Q:GMI'>0  D
	. . I '$D(^GMT(142,+$G(DA(2)),1,+$G(DA(1)),1,"B",+$G(Y(GMI))_";LAB(60,")) D
	. . . S CMP(142.14,((GMI-1)+DA))=+$G(Y(GMI))_";LAB(60,"
	S IEN=0 F  S IEN=$O(CMP(142.14,IEN)) Q:IEN'>0  D
	. I $D(^GMT(142,+$G(DA(2)),1,+$G(DA(1)),1,"B",CMP(142.14,IEN))) W $C(7),!,"  Duplicate test omitted." K CMP(142.14,IEN) Q
	. D LOADSEL^GMTSRM1A
	I $P($G(^LAB(60,+$G(^GMT(142,+DA(2),1,+DA(1),1,+DA,0)),0)),U,5)']"" D
	. N REC,SUBREC,SUBSUB S REC=DA(2),SUBREC=DA(1),SUBSUB=DA
	. D DELCOSMO(REC,SUBREC,SUBSUB)
	Q
COMPILE(GMTEST)	; Compile menu for ORUS call
	N GMC,GMI,GMJ,GMROOT
	S GMI=0 F  S GMI=$O(^LAB(60,GMTEST,2,GMI)) Q:GMI'>0  D
	.S GMJ=+$G(^LAB(60,GMTEST,2,+GMI,0))
	.S GMROOT=$G(^LAB(60,+GMJ,0))
	.I $L($P(GMROOT,U,5)) D
	..S GMC=+$P($G(^XUTL("OR",$J,"GMTS",0)),U,4)+1
	..S ^XUTL("OR",$J,"GMTS",GMJ,0)=$P(GMROOT,U),$P(^XUTL("OR",$J,"GMTS",0),U,4)=GMC
	.E  D COMPILE(+$G(^LAB(60,GMTEST,2,GMI,0)))
	Q
HEADER	; Write Header
	W !!?15,"Select the tests which you wish to include, in the",!?19,"sequence in which you wish them to appear."
	W !!?((80-$L(GMHEAD))\2),GMHEAD,!
	Q
DELCOSMO(X1,X2,X3)	; Delete cosmic lab tests from selection items
	N TEST S TEST=$G(^GMT(142,X1,1,X2,1,X3,0))
	K ^GMT(142,X1,1,X2,1,"B",TEST),^GMT(142,X1,1,X2,1,X3,0)
	Q

GMTSRM4
GMTSRM4	;SLC/JER,DLT - Create/Modify Health Summary - Insert, Append Delete Components ;10/1/92  11:04
	;;2.7;Health Summary;;Oct 20, 1995
INSRT	; Sets summary order to insert prior to existing node
	N LO,NO
	S (NO,LO)=0 F  S NO=$O(^GMT(142,GMTSIFN,1,NO)) Q:NO=SO  S LO=NO
	S CMP(.01)=+$J(((SO-LO)/2+LO),0,3),CMP(0)="^"_$P($G(CMP(0)),U,2,5),GMTSNEW=1
	;I '$D(^GMT(142,GMTSIFN,1,$P(CMP(.01),".",1),0)) S CMP(.01)=$P(CMP(.01),".",1)
	I '$D(^GMT(142,GMTSIFN,1,CMP(.01),0)) S CMP(.01)=CMP(.01)
	W !,"Inserted as SUMMARY ORDER: ",CMP(.01)_" "_CMP("NM")
	Q
APPND	; Sets summary order to insert after existing node
	N NO
	S NO=$O(^GMT(142,GMTSIFN,1,SO)) S CMP(.01)=$S(NO>0:+$J(((NO-SO)/2+SO),0,3),1:SO+5),GMTSNEW=1
	;I '$D(^GMT(142,GMTSIFN,1,$P(CMP(.01),".",1),0)) S CMP(.01)=$P(CMP(.01),".",1)
	I '$D(^GMT(142,GMTSIFN,1,CMP(.01),0)) S CMP(.01)=CMP(.01)
	S CMP(0)="^"_$P($G(CMP(0)),U,2,5)
	W !,"Appended as SUMMARY ORDER: ",CMP(.01)_" "_CMP("NM")
	Q
DELCMP	; Deletes component from summary
	N DA,DIK
	S DIK="^GMT(142,"_GMTSIFN_",1,",DA=OLDSO,DA(1)=GMTSIFN
	S OLDSO("NM")=$S($D(^GMT(142,GMTSIFN,1,OLDSO,0)):$P(^GMT(142.1,$P(^GMT(142,GMTSIFN,1,OLDSO,0),U,2),0),U,1),1:"")
	D ^DIK
	I SOACTION="D"!(SOACTION="O") W !,$S(SOACTION="O":"Overwriting",1:"Deleting")_" Summary Order "_OLDSO_" "_OLDSO("NM")
	S CNT=$$GETCNT^GMTSRM(GMTSIFN)
	Q

GMTSRM5
GMTSRM5	;SLC/DLT - Create/Modify - Copy from existing type ;9/29/92  13:48 ;
	;;2.7;Health Summary;;Oct 20, 1995
SELCMP	;Select components from existing health summary type
	N DIC,DIR,GMI,GMTSEG,GMTSEGI,GMTSTITL,GMTSTYP,I,SEQ,X,XQORM,Y
	W ! S DIR(0)="Y",DIR("A")="Do you wish to copy COMPONENTS from an existing Health Summary Type",DIR("B")="YES" D ^DIR S:+Y'>0 EXISTS=0 S:$D(DTOUT)!($D(DIROUT)) GMTSQIT=1 K DIR Q:+Y'>0
	W ! S GMTSQIT=0,DIC=142,DIC(0)="AEFQMZ",DIC("A")="Select Health Summary Type to copy from: " D ^DIC K DIC S:Y=-1 GMTSQIT=1 Q:GMTSQIT  S GMTSTYP=+Y,GMTSTITL=$P(Y,U,2)
	W @IOF,"The Following Components are Available:",!
	S XQORM("S")="I $P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""Y"""
	S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="DA",XQORM("A")="Select COMPONENTS(S): ",XQORM("??")="D HELP^GMTSRM2" D ^XQORM I Y'>0 S GMTSQIT=1 K XQORM,Y Q
	S (X,GMI,SEQ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  S X=^GMT(142,GMTSTYP,1,+Y(GMI),0) I $P(X,U,2) S SEQ=SEQ+1,GMTSEG(SEQ)=X,GMTSEGI($P(X,U,2))=SEQ D SETUPSEL
	;Load global from GMTSEG() array.
	S:'$D(^GMT(142,GMTSIFN,1,0)) ^(0)="^142.01IA^0^0"
	W !!,"Loading components into the Health Summary Type with defaults"
	S EXISTS=1
	S SEQ=0 F  S SEQ=$O(GMTSEG(SEQ)) Q:'SEQ  D LOADCMP
	Q
LOADCMP	; Call DIE to stuff STRUCTURE multiple for each component
	N ISEQ,DA,DIE,DR,CNT,SDA,S2
	S (ISEQ,DA)=SEQ*5,DIE="^GMT(142,"_GMTSIFN_",1,",DA(1)=GMTSIFN
	S DR=".01///"_DA_";1///"_$P(GMTSEG(SEQ),U,2)_";2///"_$P(GMTSEG(SEQ),U,3)_";3///"_$P(GMTSEG(SEQ),U,4)_";5///"_$P(GMTSEG(SEQ),U,5)_";6///"_$P(GMTSEG(SEQ),U,6)_";7///"_$P(GMTSEG(SEQ),U,7)_";8///"_$P(GMTSEG(SEQ),U,8) D ^DIE
	S (CNT,S2)=0 F  S S2=$O(GMTSEG(SEQ,S2)) Q:'S2  D LOADSEL
	I CNT>0 S:'$D(^GMT(142,GMTSIFN,1,ISEQ,1,0)) ^(0)="^142.14V^"_SDA_"^"_CNT
	Q
LOADSEL	; Loads selection item multiple
	N DIE,DA,DR
	S:'$D(^GMT(142,GMTSIFN,1,ISEQ,1,0)) ^(0)="^142.14V^^"
	S DIE="^GMT(142,"_GMTSIFN_",1,"_ISEQ_",1,",DA(2)=GMTSIFN,DA(1)=ISEQ,DA=S2,DR=".01////"_"^S X=GMTSEG(SEQ,S2)" D ^DIE S SDA=DA,CNT=CNT+1
	Q
SETUPSEL	;Setup default selection items into new summary type
	N S2,SEL
	S S2=0 F  S S2=$O(^GMT(142,GMTSTYP,1,+Y(GMI),1,S2)) Q:'S2  S SEL=^(S2,0) S GMTSEG(SEQ,S2)=SEL
	Q

GMTSRN
GMTSRN	;SLC/JER - Renumber Selected Health Summary Type ;9/28/92  09:49
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Initializes variables and controls branching
	N CHANGE,GMTSIFN,GMTSUM,GMTSEG,GMTSI,GMTSJ,GMTSQIT
	F  D SELECT Q:$D(GMTSQIT)  D COPY,RNMBR:CHANGE W !
	Q
SELECT	; Calls Reader to select Health Summary Type
	N DIR,GMTSKEY,GMTSMGR,GMTSOWN,X,Y
	W ! S DIR(0)="PO^142:AEMQZ" D ^DIR K DIR I $D(DIRUT) S GMTSQIT="" Q
	S GMTSIFN=+Y,GMTSUM=$P(Y,U,2)
	S GMTSKEY=$S($P(^GMT(142,GMTSIFN,0),U,2)]"":$P(^(0),U,2),1:" ZZZ"),GMTSOWN=$S($P(^(0),U,3)>0:$P(^(0),U,3),1:DUZ)
	S GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,$D(^XUSEC(GMTSKEY,DUZ)):1,GMTSOWN=DUZ:1,1:0)
	I GMTSMGR Q
	I '$D(^XUSEC(GMTSKEY,DUZ)) W !,$C(7),"This summary is currently locked to prevent alteration.",! S GMTSQIT="" Q
	I GMTSOWN'=DUZ W !,$C(7),"Alteration of this summary is restricted to its owner.",!,"See the Clinical Coordinator if you need additional help." S GMTSQIT=""
	Q
COPY	; copies Structure multiple into GMTSEG(SEQ,
	N GMTSI,SEQ
	K GMTSEG
	;W !!,"Checking sequence of "_GMTSUM_" Health Summary "
	S (CHANGE,GMTSI)=0 I '$D(^GMT(142,GMTSIFN,1,5)) S CHANGE=1
	F  S GMTSI=$O(^GMT(142,GMTSIFN,1,GMTSI)) Q:GMTSI'>0  W "." I GMTSI#5'=0 S CHANGE=1
	I 'CHANGE Q  ;W !,GMTSUM_" is already sequenced appropriately." Q
	S (SEQ,GMTSI)=0 F  S GMTSI=$O(^GMT(142,GMTSIFN,1,GMTSI)) Q:GMTSI'>0  I $P(^(GMTSI,0),U,2) S SEQ=SEQ+1,GMTSEG(SEQ)=^(0) D GETSEL,PURGE W "."
	Q
GETSEL	; Gets Selection Items from multiple
	N SN
	S SN=0 F  S SN=$O(^GMT(142,GMTSIFN,1,GMTSI,1,SN)) Q:SN'>0  S GMTSEG(SEQ,SN)=^(SN,0)
	Q
PURGE	; Deletes old node from ^GMT(142,GMTSIFN,1,GMTSI, using ^DIK
	N DA,DIK
	S DA(1)=GMTSIFN,DA=GMTSI,DIK="^GMT(142,"_GMTSIFN_",1," D ^DIK
	Q
RNMBR	; Traverses GMTSEG(SEQ) - Resets ^GMT(142,GMTSIFN,1, as appropriate
	N DA,DR,DIE,ISEQ,SEQ
	;W !,"Resequencing "_GMTSUM_" Health Summary Type "
	S SEQ=0 F  S SEQ=$O(GMTSEG(SEQ)) Q:SEQ'>0  K DA S DIE="^GMT(142,"_GMTSIFN_",1,",DA(1)=GMTSIFN D LOADCMP^GMTSRM5 W "."
	Q

GMTSRO
GMTSRO	;SLC/ARS,JER - Surgery Reports ;2/22/94  15:08
	;;2.7;Health Summary;;Oct 20, 1995
ENSR	; Entry point for component
	N MAX,GMCOUNT,GMIDT,GMW,GMN,SURG
	I '$D(^SRF("B",DFN)) Q
	S MAX=999 I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	S (GMCOUNT,GMN)=0 F  S GMN=$O(^SRF("B",DFN,GMN)) Q:GMN'>0!(GMCOUNT'<MAX)  D SORT
	I '$D(SURG) Q
	S GMIDT=0 F  S GMIDT=$O(SURG(GMIDT)) Q:GMIDT'>0  S GMN=SURG(GMIDT) D WRT
	Q
SORT	; Sort surgeries by inverted date
	N GMDT
	S GMDT=$P(^SRF(GMN,0),U,9) I GMDT>GMTSBEG&(GMDT<GMTSEND) D
	. F  Q:'$D(SURG(9999999-GMDT))  S GMDT=GMDT+.0001
	. S SURG(9999999-GMDT)=GMN,GMCOUNT=GMCOUNT+1
	Q
WRT	; Write surgical case record
	N DIC,DR,DA,X,GMI,GMW,GMDT,OPPRC,POSDX,PREDX,SPEC,STATUS,SURGEON,VER
	N DCTDTM,TRSDTM
	S X=$P(^SRF(GMN,0),U,9) D REGDT^GMTSU S GMDT=X
	D STATUS^GMTSROB S:'$D(STATUS) STATUS="UNKNOWN"
	S X=$P(^SRF(GMN,0),U,4) I X>0 S Y=X,C=$P(^DD(130,.04,0),U,2) D Y^DIQ S SPEC=Y K Y
	I $L($G(SPEC))>25 S SPEC=$$WRAP^GMTSORC(SPEC,25)
	I $D(^SRF(GMN,.1)) S X=$P(^SRF(GMN,.1),U,4) I X>0 S Y=X,C=$P(^DD(130,.14,0),U,2) D Y^DIQ S SURGEON=Y K Y
	S VER=$S($G(^SRF(GMN,"VER"))'="Y":"(Unverified)",1:"")
	S PREDX(0)=$S($G(^SRF(GMN,33))]"":$P(^(33),U),1:"") S GMI=0 F  S GMI=$O(^SRF(GMN,14,GMI)) Q:GMI'>0  S PREDX(GMI)=$P(^SRF(GMN,14,GMI,0),U)
	S POSDX(0)=$S($G(^SRF(GMN,34))]"":$P(^(34),U),1:"") S GMI=0 F  S GMI=$O(^SRF(GMN,15,GMI)) Q:GMI'>0  S POSDX(GMI)=$P(^SRF(GMN,15,GMI,0),U)
	S OPPRC(0)=$P($G(^SRF(GMN,"OP")),U,1,2) S GMI=0 F  S GMI=$O(^SRF(GMN,13,GMI)) Q:GMI'>0  S OPPRC(GMI)=$P($G(^SRF(GMN,13,GMI,0)),U)_U_$G(^SRF(GMN,13,GMI,2))
	S X=$P($G(^SRF(GMN,31)),U,6) I X>0 D REGDTM^GMTSU S DCTDTM=X
	S X=$P($G(^SRF(GMN,31)),U,7) I X>0 D REGDTM^GMTSU S TRSDTM=X
	S DIWL=0,DIWF="N"
	K ^UTILITY($J,"W")
	I $D(^SRF(GMN,12)) F GMI=1:1:$P(^SRF(GMN,12,0),U,4) S X=^SRF(GMN,12,GMI,0) D ^DIWP
	D CKP^GMTSUP Q:$D(GMTSQIT)  W GMDT,?21,$P($G(SPEC),"|"),?47,"Surgeon:",?56,$G(SURGEON),!
	F GMI=2:1:$L($G(SPEC),"|") D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W ?23,$P($G(SPEC),"|",GMI),!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?13,"Status:",?21,STATUS,!
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?5,"Pre-op Diag(s):"
	S GMI="" F  S GMI=$O(PREDX(GMI)) Q:GMI=""  S PREDX=$S($L(PREDX(GMI))'>58:PREDX(GMI),1:$$WRAP^GMTSORC(PREDX(GMI),58)) F GMJ=1:1:$L(PREDX,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(PREDX,"|",GMJ) W:GMJ=1&(PREDX?1.A.E) " ",VER W !
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?4,"Post-op Diag(s):"
	S GMI="" F  S GMI=$O(POSDX(GMI)) Q:GMI=""  S POSDX=$S($L(POSDX(GMI))'>58:POSDX(GMI),1:$$WRAP^GMTSORC(POSDX(GMI),58)) F GMJ=1:1:$L(POSDX,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(POSDX,"|",GMJ) W:GMJ=1&(POSDX?1.A.E) " ",VER W !
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?2,"Operative Proc(s):"
	S GMI="" F  S GMI=$O(OPPRC(GMI)) Q:GMI=""  S OPPRC=$S($L($P(OPPRC(GMI),U))'>58:OPPRC(GMI),1:$$WRAP^GMTSORC($P(OPPRC(GMI),U),58)_U_$P(OPPRC(GMI),U,2)) F GMJ=1:1:$L($P(OPPRC,U),"|") D WRTPRC Q:$D(GMTSQIT)
	I $O(^SRF(GMN,9,0)) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?11,"Lab Work: YES",!
	I $D(DCTDTM) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?5,"Dictation Time:",?21,DCTDTM,!
	I $D(TRSDTM) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?1,"Transcription Time:",?21,TRSDTM,!
	I $D(^UTILITY($J,"W")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Surgeon's Dictation:",! F GMI=1:1:^UTILITY($J,"W",DIWL) D CKP^GMTSUP Q:$D(GMTSQIT)  W ^UTILITY($J,"W",DIWL,GMI,0),!
	K ^UTILITY($J,"W")
	Q
WRTPRC	; Writes operative procedures
	D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P($P(OPPRC,U),"|",GMJ) W:GMJ=1&($P(OPPRC,U,2)]"") " - ",$P(OPPRC,U,2) W !
	Q

GMTSROB
GMTSROB	;SLC/ARS,JER - Surgery Reports Brief ;1/24/92  13:22
	;;2.7;Health Summary;;Oct 20, 1995
ENSR	; Entry point for component
	N MAX,GMCOUNT,GMIDT,GMW,GMN,SURG
	I '$D(^SRF("B",DFN)) Q
	S MAX=999 I $D(GMTSNDM),(GMTSNDM>0) S MAX=GMTSNDM
	S (GMCOUNT,GMN)=0 F  S GMN=$O(^SRF("B",DFN,GMN)) Q:GMN'>0!(GMCOUNT'<MAX)  D SORT
	I '$D(SURG) Q
	S GMIDT=0 F  S GMIDT=$O(SURG(GMIDT)) Q:GMIDT'>0  S GMN=SURG(GMIDT) D WRT
	Q
SORT	; Sort surgeries by inverted date
	N GMDT
	S GMDT=$P(^SRF(GMN,0),U,9) I GMDT>GMTSBEG&(GMDT<GMTSEND) D
	. F  Q:'$D(SURG(9999999-GMDT))  S GMDT=GMDT+.0001
	. S SURG(9999999-GMDT)=GMN,GMCOUNT=GMCOUNT+1
	Q
WRT	; Write surgical case record
	N X,GMI,GMW,GMDT,STATUS K ^UTILITY($J,"W")
	S X=$P(^SRF(GMN,0),U,9) D REGDT^GMTSU S GMDT=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  W GMDT
	D STATUS S:'$D(STATUS) STATUS="UNKNOWN"
	S X=$P(^SRF(GMN,"OP"),"^") D FORMAT
	D CKP^GMTSUP Q:$D(GMTSQIT)  W:$D(^UTILITY($J,"W",1,1,0)) ?21,^(0) W ?61,STATUS,!
	S GMI=1 F  S GMI=$O(^UTILITY($J,"W",1,GMI)) Q:GMI'>0  D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,^UTILITY($J,"W",1,GMI,0),!
	K ^UTILITY($J,"W")
	Q
STATUS	; case status
	I $D(^SRF(GMN,30)) S STATUS=$S(+$P($G(^SRF(GMN,.2)),U,10):"(ABORTED)",1:"CANCELLED") Q
	I +$P($G(^SRF(GMN,.2)),U,3) S STATUS="(COMPLETED)" Q
	I +$P($G(^SRF(GMN,.2)),U,2),'(+$P(^(.2),U,3)) S STATUS="INCOMPLETE" Q
	I +$P($G(^SRF(GMN,31)),U,4) S STATUS="SCHEDULED" Q
	I +$G(^SRF(GMN,"REQ")),'(+$P($G(^SRF(GMN,.2)),U,2)) S STATUS="REQUESTED"
	Q
FORMAT	; format surgery name
	N DIWF,DIWL,DIWR
	S DIWF="C35R",DIWL=1,DIWR=36 D ^DIWP
	Q

GMTSSOWK
GMTSSOWK	;SLC/SBW - Social Work Component driver ;6/OCT/94
	;;2.7;Health Summary;;Oct 20, 1995
MAIN	; Control branching
	N GMTSI
	K ^TMP("SOWK",$J)
	; DFN is used that currently exists is used by ^SOWKHSUM
	D ^SOWKHSUM
	I '$D(^TMP("SOWK",$J)) Q
	S GMTSI=0
	F  S GMTSI=$O(^TMP("SOWK",$J,GMTSI)) Q:+GMTSI'>0  D
	. D CKP^GMTSUP Q:$D(GMTSQIT)  W $G(^TMP("SOWK",$J,GMTSI)),!
	K ^TMP("SOWK",$J)
	Q

GMTSSOWZ
GMTSSOWZ	;SLC/SBW - Social Work extract comp. in HS namespace ;21/OCT/94
	;;2.7;Health Summary;;Oct 20, 1995
SOWKHSUM	; B'ham ISC/DMA - health summary ; 19 Jul 94 / 8:30 AM
	;;3.0; Social Work ;;27 Apr 93
	;;
	;Called with DFN - assumed to be valid
	;returns parts V. VII. and VIII. of the assessment
	;in ^TMP("SOWK",$J,line number)
	;
	N LINE,SP15,MS,SP,J,C,Y,X,SO,SP10,SZ,D,DIWL,DIWF
	K ^TMP("SOWK",$J) Q:'$D(^SOWK(655.2,DFN,0))  S LINE=6,$P(SP15," ",15)="",SP10=$E(SP15,1,10)
	S MS=$P($G(^DIC(11,+$P(^DPT(DFN,0),"^",5),0)),"^")
	S ^TMP("SOWK",$J,1)="Source of Referral: "_$P(^SOWK(655.2,DFN,0),"^",21)
	S ^TMP("SOWK",$J,2)="Source of Information: "_$S($D(^SOWK(655.2,DFN,18)):$P(^(18),"^"),1:"UNSPECIFIED")
	S ^TMP("SOWK",$J,3)="Social/Family Relationship:",^(4)="     1.  Marital status: "_MS,^(5)="     2.  Spouse:"
	S SP=$G(^SOWK(655.2,DFN,6))
	F J=1:1:4 I $P(SP,"^",J)]"" S ^TMP("SOWK",$J,LINE)=SP15_$P(SP,"^",J),LINE=LINE+1
	I $P(SP,"^",5)]"" S SZ=$P(^DIC(5,+$P(SP,"^",5),0),"^")_"     "_$P(SP,"^",6),^(LINE-1)=^TMP("SOWK",$J,LINE-1)_",    "_SZ
	S ^TMP("SOWK",$J,LINE)="     3.  Children:",LINE=LINE+1
	F J=0:0 S J=$O(^SOWK(655.2,DFN,7,J)) Q:'J  S X=^(J,0),D=$P(X,"^",2),^TMP("SOWK",$J,LINE)=$$LJ^XLFSTR(SP15_$P(X,"^"),50," ")_"Age: "_($E(DT,1,3)-$E(D,1,3)-($E(D,4,7)>$E(DT,4,7))),LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="     4.  Describe Social Support System:",LINE=LINE+1
	K ^UTILITY($J,"W") S DIWL=0,DIWF="C60" F J=0:0 S J=$O(^SOWK(655.2,DFN,13,J)) Q:'J  S X=^(J,0) D ^DIWP
	F J=0:0 S J=$O(^UTILITY($J,"W",0,J)) Q:'J  S X=^(J,0),^TMP("SOWK",$J,LINE)=SP10_X,LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="     5.  Present Use of Community Resources:",LINE=LINE+1
	K ^UTILITY($J,"W") F J=0:0 S J=$O(^SOWK(655.2,DFN,14,J)) Q:'J  S X=^(J,0) D ^DIWP
	F J=0:0 S J=$O(^UTILITY($J,"W",0,J)) Q:'J  S X=^(J,0),^TMP("SOWK",$J,LINE)=SP10_X,LINE=LINE+1
	S Y=$P(^SOWK(655.2,DFN,0),"^",15),C=$P(^DD(655.2,15,0),"^",2) D Y^DIQ S:Y="" Y="UNSPECIFIED"
	S ^TMP("SOWK",$J,LINE)="     6.  Current Living Arrangements:    "_Y,LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="     7.  Social/Family Assessment:",LINE=LINE+1
	K ^UTILITY($J,"W") F J=0:0 S J=$O(^SOWK(655.2,DFN,16,J)) Q:'J  S X=^(J,0) D ^DIWP
	F J=0:0 S J=$O(^UTILITY($J,"W",0,J)) Q:'J  S X=^(J,0),^TMP("SOWK",$J,LINE)=SP10_X,LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="",LINE=LINE+1
	S SO=$P(^SOWK(655.2,DFN,0),"^",25),SO=$S(SO=1:"YES",SO=2:"NO",1:"UNKNOWN"),^TMP("SOWK",$J,LINE)="Current Substance Problems: "_SO,LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="",LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="      Comments on Substance Abuse :",LINE=LINE+1
	K ^UTILITY($J,"W") F J=0:0 S J=$O(^SOWK(655.2,DFN,8,J)) Q:'J  S X=^(J,0) D ^DIWP
	F J=0:0 S J=$O(^UTILITY($J,"W",0,J)) Q:'J  S X=^(J,0),^TMP("SOWK",$J,LINE)=SP10_X,LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="",LINE=LINE+1
	S ^TMP("SOWK",$J,LINE)="Psycho-Social Assessment:",LINE=LINE+1
	K ^UTILITY($J,"W") F J=0:0 S J=$O(^SOWK(655.2,DFN,19,J)) Q:'J  S X=^(J,0) D ^DIWP
	F J=0:0 S J=$O(^UTILITY($J,"W",0,J)) Q:'J  S X=^(J,0),^TMP("SOWK",$J,LINE)=SP10_X,LINE=LINE+1

GMTSU
GMTSU	;SLC/JER,DLT - Health Summary Utilities ;9/28/92  14:24 ;
	;;2.7;Health Summary;;Oct 20, 1995
MTIM	;CONVERT TIME from X=2890313.1304 INTO X=13:04
	S X=$P(X,".",2) Q:'$L(X)
	S X=$S(X:$E(X,1,2)_$E("00",0,2-$L($E(X,1,2)))_":"_$E(X,3,4)_$E("00",0,2-$L($E(X,3,4))),1:"")
	Q
REGDT	; Receives X in internal date.time, and returns X in MM/DD/YY format
	S X=$S(X:$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3),1:"")
	Q
REGDTM	;Receives X in internal date.time, and returns X in MM/DD/YY TT:TT
	N T
	S T=$P(X,".",2),X=$S(X:$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3),1:"")_" "_$S(T:$E(T,1,2)_$E("00",0,2-$L($E(T,1,2)))_":"_$E(T,3,4)_$E("00",0,2-$L($E(T,3,4))),1:"")
	Q
SIDT	; Receives X as internal date/time and returns X in DD MMM YY
	N MON,MM
	S X=$P(X,".") I 'X S X="" Q
	S MON="JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC"
	S MM=$E(X,4,5),MM=$S(MM:$P(MON,U,MM),1:"")
	S X=$E(X,6,7)_" "_MM_" "_$E(X,2,3)
	Q
FMHL7DTM	; Recieves X as internal date/time and returns X in CCYYMMDDHHMM
	N T
	S T=$P(X,".",2)
	S T=$S(T:$E(T,1,2)_$E("00",0,2-$L($E(T,1,2)))_$E(T,3,4)_$E("00",0,2-$L($E(T,3,4))),1:"0000")
	S X=($E($P(X,"."),1,3)+1700)_$E($P(X,"."),4,7)_T
	Q
HL7FMDTM	; Recieves X as CCYYMMDDHHMM and returns X as internal date/time
	N DATE,TIME
	S DATE=$E(X,1,8),TIME=$E(X,9,12)
	S DATE=DATE-17000000,X=DATE_"."_TIME
	Q
DEM	; Gets Demographic Data from VADPT
	; Receives: DFN
	; Returns: GMTSPNM,GMTSSN,GMTSDOB,SEX,GMTSWARD,GMTSRB,GMTSAGE
	K VAHOW D OERR^VADPT S GMTSPNM=VADM(1),GMTSSN=$S($D(VA("PID")):VA("PID"),1:$P(VADM(2),"^",2)),GMTSAGE=$S(+VADM(4)>0:+VADM(4),1:99),SEX=$P(VADM(5),"^"),GMTSWARD=$P(VAIN(4),"^",2),GMTSRB=VAIN(5),X=$P(VADM(3),"^") D REGDT S GMTSDOB=X
	K VA
	Q
NAME	; Format names ;6/30/89  11:20 ;
	; Recieves: FILE (3 for User, 16 for Person, 6 for Provider)
	;           IFN (Internal file # for above file),
	;           NML (Desired length for name to be returned)
	;           FNF (Flag to specify first name format: 0 for FI, 1 for FN)
	; Returns: Lastname,First(name/initial) to specified length as NM
	;
	N DIC,RAWNM,LN,FN,FA,NI,CH,X,Y
	S DIC=FILE,DIC(0)="NXZ",X=IFN D ^DIC S RAWNM=$S($D(Y(0,0)):Y(0,0),1:"UNKNOWN")
	S LN=$P(RAWNM,","),FN=$P(RAWNM,",",2)
	S FA=0 I $L(FN) F NI=1:1 S CH=$E(FN,NI) Q:CH?1A  S FA=NI
	I FA S FN=$E(FN,FA+1,$L(FN))
	I 'FNF S FN=$E(FN,1)
	S NM=$S($L(FN):LN_","_FN,1:LN),NM=$E(NM,1,NML)
	K FILE,IFN,NML,FNF
	Q
GETRANGE(FROMDATE,TODATE)	; Selection by Date Range (from and to dates)
	;      VARIABLES LIST (OUTPUT)
	; FROMDATE = FROM DATE
	; TODATE = TO DATE
	N DIR,X,Y,DTOUT,DIRUT
	S DIR(0)="DO^:DT",DIR("A")="Enter Beginning Date (MM/DD/YY)"
	W !
	D ^DIR
	I $D(DIROUT)!$D(DUOUT)!$D(DTOUT)!$D(DIRUT) W ! Q
	S FROMDATE=Y
	I +FROMDATE>0 D
	. N DIR,X,Y
	. S DIR(0)="DO^::EX",DIR("A")="Enter Ending Date (MM/DD/YY)"
	. S DIR("B")="TODAY"
	. D ^DIR
	. I $D(DIROUT)!$D(DUOUT)!$D(DTOUT)!$D(DIRUT) K FROMDATE Q
	. I Y'>0 K FROMDATE Q
	. S TODATE=Y
	. Q:TODATE>FROMDATE!(TODATE=FROMDATE) 
	. ; If 2nd date older than 1st date entered (Dates entered in reverse order)
	. N FRDT
	. S FRDT=FROMDATE
	. S FROMDATE=TODATE
	. S TODATE=FRDT
	W !
	Q

GMTSUP
GMTSUP	;SLC/DLT,JER - Utilities for Paging Health Summary ;9/28/92  14:13 ;
	;;2.7;Health Summary;;Oct 20, 1995
	;
CKP	; Check page position, pause and prompt
	Q:$D(GMTSQIT)
	S GMTSNPG=0
	I $G(GMTSWRIT)=1 D
	. D BREAK
	. S GMTSWRIT=0
	Q:$Y'>(IOSL-GMTSLO)
	I $E(IOST,1)="C" S:'$D(GMTSTOF) GMTSTOF=1 D CKP1
	I '$D(GMTSQIT) W @IOF D HEADER,BREAK S GMTSNPG=1,GMTSTOF=GMTSEGN
	I $D(GMTSQIT),(GMTSQIT]""),($D(GMTSTYP)) W @IOF D HEADER S GMTSTOF=GMTSEGN
	Q
CKP1	;Help Display of Optional Components for Navigation
	N DA,I,J,K,L,X,XQORM,Y,GMTSY,TYP
	I $S('$D(GMTSTYP):1,$D(GMTOPT):1,1:0) N DIR S DIR(0)="E" D ^DIR K DIR S:$D(DUOUT)!(GMTSLPG) GMTSQIT="" Q
	S TYP=GMTSTYP
	S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" D ^DIC S GMTSTYP=+Y K DIC,X,Y
	S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="1AF\+",XQORM("A")="Press <RET> to continue, ^ to exit, or select component: "
	S XQORM("??")="D HELP^GMTSUP1" I GMTSLPG W "* END * "
	S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")"
	D ^XQORM W ! D @$S(Y=1:"BRNCH",1:"EVAL")
	I $D(GMTSY),(GMTSY=0) K GMTSY G CKP1
	S GMTSTYP=TYP
	Q
BREAK	; Writes the component header
	S:'$D(GMTSLCMP) GMTSLCMP=0
	S GMTS="",GMTSNPG=1,$P(GMTS,"-",79-$L(GMTSEGH_GMTSEGL)/2)="",GMTS=GMTS_" "_GMTSEGH_GMTSEGL_" "_GMTS I $Y'>(IOSL-GMTSLO) W !,GMTS,! W:$Y'>(IOSL-GMTSLO) ?34,$S(GMTSEGN=GMTSLCMP:"(continued)",1:""),! S GMTSLCMP=GMTSEGN
	Q
HEADER	; Print Running Header
	N GMTSVDT,DATA
	; GMTSCDT(0) may contain multiple dates that could cause a line to
	; wrap inappropriately. If this creates a problem, a change will be
	; required to accommodate it.
	S DATA=""
	I +$G(GMTSPXD1)&+$G(GMTSPXD2) D
	. S DATA="Printed for data "
	. I GMTSPXD1=GMTSPXD2 S DATA=DATA_"on "_GMTSPXD1 Q
	. S DATA=DATA_"from "_GMTSPXD2_" to "_GMTSPXD1
	I $D(GMTSCDT(0)) S GMTSVDT=GMTSCDT(0) S:GMTSDTM'["Printed:" GMTSDTM="Printed: "_GMTSDTM
	W !,$S($L($P($G(GMTSSC),U,2)):"Location: "_$P(GMTSSC,U,2)_" ",1:""),$S($D(GMTSVDT):GMTSVDT,1:""),DATA,?(79-$L(GMTSDTM)),GMTSDTM
	S:'$D(GMTSPG) GMTSPG=0 S GMTSPG=GMTSPG+1,GMTSHDR=" CONFIDENTIAL "_GMTSTITL_" SUMMARY "_$S($E(IOST,1)="C":"",1:"  pg. "_GMTSPG) S GMTS="",$P(GMTS,"*",(77-$L(GMTSHDR))\2)="*" S GMTSHDR=GMTS_" "_GMTSHDR_" "_GMTS
	W !,GMTSHDR,"*"
	I '$D(GMTSLFG) W !,GMTSPNM_"    "_GMTSSN_"   " W ?39-($L(GMTSWARD_" "_GMTSRB)\2),GMTSWARD_" "_GMTSRB,?79-$L(" DOB: "_GMTSDOB)," DOB: "_GMTSDOB,!
	W:+$G(VADM(6)) ?33,"** DECEASED **"
	Q
BRNCH	;Checks for appropriate abbreviation to branch to a different component
	N GMTINX,LIM,CREC,SBS
	I Y,("+-"[X) S:X="-" GMTSEGN=GMTSTOF-1 S (GMTSY,GMTSQIT)=1,GMTSLPG=0 Q
	I X="^^" S DIROUT=1,GMTSQIT="" Q
	I Y,(X?1"^^".E) D  Q
	.N GMTSAV
	.S GMTSAV=X D RJUMP^GMTSUP1
	.I GMTSAV'["?" S (GMTSQIT,GMTSY)=1,GMTSEGN=GMTSTOF-1,GMTSLPG=0
	.E  S GMTSY=0
	S GMTINX=$S($D(^GMT(142,GMTSTYP,1,+Y(1),0)):$P(^(0),U,2),1:"")
	I 'GMTINX S GMTSY=0 Q
	I '$D(GMTSEGI(GMTINX)) N GMI,GMJ,GMTSDFLT S GMI=1,GMJ=GMTSEGC,GMTSDFLT=1 D LOAD^GMTSADH S GMTSEGC=GMTSEGC+1
	I '$D(GMTSEGI(GMTINX)) S GMTINX="",GMTSY=0 Q
	S LIM=$P(Y(1),U,4) I LIM'["=" G NOLIM
	S CREC=^GMT(142.1,GMTINX,0),SBS=GMTSEGI(GMTINX) D CMPLIM^GMTSADH2
	I $D(DIROUT) S GMTSQIT="" Q
NOLIM	S GMTSEGN=GMTSEGI(GMTINX)-1,(GMTSY,GMTSQIT)=1,GMTSLPG=0
	Q
	;
EVAL	; Evaluate input to determine quit or continue
	Q:'$D(X)
	S:$D(DTOUT) DIROUT=1 I $S(X="^^":1,GMTSLPG:1,$D(DIROUT):1,X="^":1,1:0) S GMTSQIT=""
	I +$G(GMPSAP),(X="^") S GMDUOUT=1
	Q

GMTSUP1
GMTSUP1	;SLC/DLT,JER - Utilities for Paging Health Summary ;3/31/92  10:11 ;
	;;2.7;Health Summary;;Oct 20, 1995
RJUMP	; Set-up and call to XQOR for "^^"-jump
	N GMDFN,GMTS,GMTSLO,GMTSPNM,GMTSRB,GMTSWARD,GMTSDOB,GMTSLPG,GMTSDTM,ORVP,XQOR
	N GMTSSN,GMTS0,GMTS1,GMTS2,GMTSTIM,GMTSEGN,GMTSEGH,GMTSEGL,GMTSHDR,XQORM
	N GMTSNPG,GMTSPG,GMTSQIT,GMTSX,GMTSLOC,GMTSTOF,GMTSQ,GMTSTYP,GMTSTITL,GMTSEG
	N GMTSEGC,LRDFN,TYP
	I $S('$L($T(EN^OR2)):1,$$VERSION^XPDUTL("OR")<2.2:1,1:0) W !,"OE/RR version 2 must be installed.",! H 1 G RETURN
	I $S('$D(DFN):1,DFN'>0:1,1:0) S GMTSX=X D SELPT^GMTS G:DFN'>0 RETURN S X=GMTSX
	S X=$P(X,U,3),ORVP=DFN_";DPT(",GMDFN=DFN
	D EN^OR2
RETURN	S:$D(GMDFN) DFN=GMDFN W:$G(GMTSAV)'["?" !,">>>  Returning to Health Summary",! H 1
	Q
HELP	; Offers help to confused individuals
	N GMQUIT
	W @IOF
	I X="?",GMTSTYP=TYP W "These components have been selected for Ad Hoc.",! S FLG=1 D LIST K FLG Q:$D(DTOUT)  D HELP1 W ! Q
	I X="?",GMTSTYP'=TYP W "These components are part of ",GMTSTITL," Health Summary Type",!,"or have been temporarily added.  Added components are indicated by *.",! S FLG=2 D LIST K FLG Q:$D(DTOUT)  D HELP1 W ! Q
	I X="??" W "These components may be temporarily added (use ""=C"" to change limits)." D DISP^XQORM1 W !!
	I X="???" D HELP2
	Q
HELP1	; Writes part of help prompt
	D SCRNLNTH Q:$D(GMQUIT)  W !!
	D SCRNLNTH Q:$D(GMQUIT)  W "To leave display order and jump to a different component, select any component",!
	D SCRNLNTH Q:$D(GMQUIT)  W "from the  above list,  or select  any additional  component to  be temporarily",!
	D SCRNLNTH Q:$D(GMQUIT)  W "added  to the display.   Add ""=C"" to  component to change  limits or selection",!
	D SCRNLNTH Q:$D(GMQUIT)  W "items.  EXAMPLE: LO=C",!!
	D SCRNLNTH Q:$D(GMQUIT)  W "Enter: ??    to see additional components.",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?7,"???   to see HELP for ""^^""-jump.",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?7,"<RET> to continue display.",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?7,"+     to proceed to next component.",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?7,"-     to return to preceeding component.",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?7,"^     to quit present patient's summary.",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?7,"^^    to quit and return to menu.",!!
	Q
HELP2	; Help for "^^"-jump
	D SCRNLNTH Q:$D(GMQUIT)  W ?22,"Navigation OUTSIDE of Health Summary",!!
	D SCRNLNTH Q:$D(GMQUIT)  W "You may also enter ""^^"" followed by the name, partial name or synonym for",!
	D SCRNLNTH Q:$D(GMQUIT)  W "any of a  variety of options  OUTSIDE of Health Summary  to which you can",!
	D SCRNLNTH Q:$D(GMQUIT)  W "jump.  Partial matches will allow you to select from a subset of options.",!!
	D SCRNLNTH Q:$D(GMQUIT)  W "For example:  ^^?    will list ALL available options.",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?14,"^^PN   will show you all of the PROGRESS NOTES options, or",!
	D SCRNLNTH Q:$D(GMQUIT)  W ?14,"^^OR   will show you all of the ORDER ENTRY options.",!!
	D SCRNLNTH Q:$D(GMQUIT)  W "You may also  order a wide variety of LABORATORY tests using this syntax.",!
	D SCRNLNTH Q:$D(GMQUIT)  W "e.g., ^^CHEM 7 will allow you to ADD an order for that test.",!!
	Q
LIST	; List components
	N GMI,DUOUT
	S GMI=0 F  S GMI=$O(GMTSEG(GMI)) Q:GMI'>0  D SCRNLNTH Q:$D(DUOUT)!($D(DTOUT))  D LIST1 Q:$D(DUOUT)!($D(DTOUT))
	Q
SCRNLNTH	; Checks screen length
	N DIR
	Q:$Y'>(IOSL-4)
	S DIR(0)="E"
	D ^DIR I $S($D(DUOUT):1,$D(DTOUT):1,1:0) S GMQUIT=""
	W:'$D(GMQUIT) @IOF
	Q
LIST1	; Lists component information
	N CREC S CREC=^GMT(142.1,$P(GMTSEG(GMI),U,2),0)
	W:GMI#2 ! W ?$S(GMI#2:0,1:40) D:FLG=2 STAR W $P(CREC,U,4),?$S(GMI#2:8,1:48),$E($S($L($P(GMTSEG(GMI),U,5)):$P(GMTSEG(GMI),U,5),$L($P(CREC,U,9)):$P(CREC,U,9),1:$P(CREC,U)),1,24)
	Q
STAR	; Writes * to indicate added component when called by GMTSUP
	; for HST other than AD HOC
	W $S($D(^GMT(142,TYP,1,"C",$P(GMTSEG(GMI),U,2))):" ",1:"*")
	Q

GMTSVS
GMTSVS	;SLC/TRS - Vital Signs Component ;8/20/91  14:09 ;
	;;2.7;Health Summary;;Oct 20, 1995
ENVS	;SET UP FOR EXTRACTION ROUTINE
	I $D(GMTSNDM),GMTSNDM>0 S CNTR=GMTSNDM
	E  S CNTR=100
	K ^UTILITY($J,"GMRVD"),ARRAY
	S T1=GMTSEND,T2=GMTSBEG,END=0
	S TN=0,LF=0,GMRVSTR="T"_";"_"P"_";"_"R"_";"_"BP"_";"_"HT"_";"_"WT",GMRVSTR(0)=T2_"^"_T1_"^"_CNTR_"^"_1
	D EN1^GMRVUT0
	I '$D(^UTILITY($J,"GMRVD")) D KILLVS Q
	D OUT,KILLVS Q
OUT	;OUT-PUT
	N GMW
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Measurement DT",?20,"TEMP",?30,"PULSE",?40,"RESP",?50,"BP",?60,"HT",?70,"WT",!!
	S GMT="" F  S GMT=$O(^UTILITY($J,"GMRVD",GMT)) Q:GMT<0!(GMT="")!(END=1)  D OUT1,OUT4
	Q
OUT1	S GMTSVT="" F  S GMTSVT=$O(^UTILITY($J,"GMRVD",GMT,GMTSVT)) Q:GMTSVT=""  S IEN=$O(^UTILITY($J,"GMRVD",GMT,GMTSVT,0)) D OUT3
	Q
OUT3	S GMTSVS=^UTILITY($J,"GMRVD",GMT,GMTSVT,IEN)
	S X=$P(GMTSVS,U,1) D REGDT^GMTSU S TDT=X
	S X=$P(GMTSVS,U,1) D MTIM^GMTSU S TI=X
	S TDT=TDT_" "_TI
	S $P(ARRAY,U,1)=TDT
	S GMTAB=$S(GMTSVT="T":2,GMTSVT="P":3,GMTSVT="R":4,GMTSVT="BP":5,GMTSVT="HT":6,GMTSVT="WT":7,1:0) S $P(ARRAY,U,GMTAB)=$P(GMTSVS,U,8)
	Q
OUT4	D CKP^GMTSUP Q:$D(GMTSQIT)  W $P(ARRAY,U,1),?20,$P(ARRAY,U,2),?30,$P(ARRAY,U,3),?40,$P(ARRAY,U,4),?50,$P(ARRAY,U,5),?60,$P(ARRAY,U,6),?70,$P(ARRAY,U,7),!
	S CNTR=CNTR-1 I CNTR=0 S END=1
	K ARRAY
	Q
KILLVS	;Kills variables
	K CNTR,T1,T2,TDT,TI,END,TN,IEN,LF,GMTSVS,GMTSVT,GMT,ARRAY,GMTAB,X
	K ^UTILITY($J,"GMRVD")
	Q

GMTSVSS
GMTSVSS	;SLC/TRS - Selected Vital Signs Component ;4/22/92  15:37
	;;2.7;Health Summary;;Oct 20, 1995
ENVS	;SET UP FOR EXTRACTION ROUTINE
	N HDR,GMTSF,MAX,GMTSDA,GMTSI,GMTSDT,GMW
	K ^UTILITY($J,"GMRVD")
	I $D(GMTSNDM),GMTSNDM>0 S MAX=GMTSNDM
	E  S MAX=100
	S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,120.51,GMTSI)) Q:GMTSI'>0  S GMTSDA=GMTSEG(GMTSEGN,120.51,GMTSI) D BLDSTR
	I '$D(GMRVSTR) Q
	S GMRVSTR(0)=GMTSBEG_U_GMTSEND_U_MAX_U_1
	D BLDHDR,EN1^GMRVUT0
	I '$D(^UTILITY($J,"GMRVD")) Q
	D WRTHDR
	S GMTSDT="" F GMTSF=1:1:MAX S GMTSDT=$O(^UTILITY($J,"GMRVD",GMTSDT)) Q:GMTSDT'>0  D WRT Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)  W !
	K ^UTILITY($J,"GMRVD")
	Q
BLDSTR	; Builds GMRVSTR string for extract call
	N DA,DIC,DIQ,DR,VIT
	S DIQ="VIT(",DIQ(0)="E",DIC=120.51,DR="1",DA=GMTSDA
	D EN^DIQ1 S VIT=VIT(120.51,DA,1,"E")
	S GMRVSTR=$S($D(GMRVSTR):GMRVSTR_";"_VIT,1:VIT)
	Q
BLDHDR	; Builds the HDR array
	N ABB,GMTSI
	F GMTSI=1:1:$L(GMRVSTR,";") S (HDR(GMTSI-1),ABB)=$P(GMRVSTR,";",GMTSI),HDR(GMTSI-1)=HDR(GMTSI-1)_U_$S(ABB="BP":"BP",ABB="HT":"HT",ABB="P":"PULSE",ABB="R":"RESP",ABB="T":"TEMP",ABB="WT":"WT")
	Q
WRTHDR	; Writes Header
	N GMI
	D CKP^GMTSUP Q:$D(GMTSQIT)  W "Measurement DT"
	F GMI=0:1:5 D CKP^GMTSUP Q:'$D(HDR(GMI))!($D(GMTSQIT))  W ?(9*GMI+24),$P(HDR(GMI),U,2)
	D CKP^GMTSUP Q:$D(GMTSQIT)  W !!
	Q
WRT	; Writes vitals record for one observation time
	N GMTSI,GMTDT,GMTSVI,GMTSVT,IEN,X
	S GMTSVI="",X=9999999-GMTSDT D REGDTM^GMTSU S GMTDT=X
	D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG WRTHDR W GMTDT
	F GMTSI=0:1 S GMTSVI=$O(HDR(GMTSVI)) Q:GMTSVI=""!($D(GMTSQIT))  D
	. S GMTSVT=$P(HDR(GMTSVI),U),IEN=$O(^UTILITY($J,"GMRVD",GMTSDT,GMTSVT,0))
	. I +IEN D CKP^GMTSUP Q:$D(GMTSQIT)  W ?(9*(GMTSI)+24),$P(^UTILITY($J,"GMRVD",GMTSDT,GMTSVT,+IEN),U,8)
	Q


