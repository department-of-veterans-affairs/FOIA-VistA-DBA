Released RMPR*3*122 SEQ #112
Extracted from mail message
**KIDS**:RMPR*3.0*122^

**INSTALL NAME**
RMPR*3.0*122
"BLD",5785,0)
RMPR*3.0*122^PROSTHETICS^0^3070619^y
"BLD",5785,4,0)
^9.64PA^^
"BLD",5785,6.3)
2
"BLD",5785,"ABPKG")
n
"BLD",5785,"KRN",0)
^9.67PA^8989.52^19
"BLD",5785,"KRN",.4,0)
.4
"BLD",5785,"KRN",.401,0)
.401
"BLD",5785,"KRN",.402,0)
.402
"BLD",5785,"KRN",.403,0)
.403
"BLD",5785,"KRN",.5,0)
.5
"BLD",5785,"KRN",.84,0)
.84
"BLD",5785,"KRN",3.6,0)
3.6
"BLD",5785,"KRN",3.8,0)
3.8
"BLD",5785,"KRN",9.2,0)
9.2
"BLD",5785,"KRN",9.8,0)
9.8
"BLD",5785,"KRN",9.8,"NM",0)
^9.68A^4^2
"BLD",5785,"KRN",9.8,"NM",3,0)
RMPR29CA^^0^B68273293
"BLD",5785,"KRN",9.8,"NM",4,0)
RMPR29WO^^0^B19191231
"BLD",5785,"KRN",9.8,"NM","B","RMPR29CA",3)

"BLD",5785,"KRN",9.8,"NM","B","RMPR29WO",4)

"BLD",5785,"KRN",19,0)
19
"BLD",5785,"KRN",19.1,0)
19.1
"BLD",5785,"KRN",101,0)
101
"BLD",5785,"KRN",409.61,0)
409.61
"BLD",5785,"KRN",771,0)
771
"BLD",5785,"KRN",870,0)
870
"BLD",5785,"KRN",8989.51,0)
8989.51
"BLD",5785,"KRN",8989.52,0)
8989.52
"BLD",5785,"KRN",8994,0)
8994
"BLD",5785,"KRN","B",.4,.4)

"BLD",5785,"KRN","B",.401,.401)

"BLD",5785,"KRN","B",.402,.402)

"BLD",5785,"KRN","B",.403,.403)

"BLD",5785,"KRN","B",.5,.5)

"BLD",5785,"KRN","B",.84,.84)

"BLD",5785,"KRN","B",3.6,3.6)

"BLD",5785,"KRN","B",3.8,3.8)

"BLD",5785,"KRN","B",9.2,9.2)

"BLD",5785,"KRN","B",9.8,9.8)

"BLD",5785,"KRN","B",19,19)

"BLD",5785,"KRN","B",19.1,19.1)

"BLD",5785,"KRN","B",101,101)

"BLD",5785,"KRN","B",409.61,409.61)

"BLD",5785,"KRN","B",771,771)

"BLD",5785,"KRN","B",870,870)

"BLD",5785,"KRN","B",8989.51,8989.51)

"BLD",5785,"KRN","B",8989.52,8989.52)

"BLD",5785,"KRN","B",8994,8994)

"BLD",5785,"QUES",0)
^9.62^^
"BLD",5785,"REQB",0)
^9.611^1^1
"BLD",5785,"REQB",1,0)
RMPR*3.0*75^1
"BLD",5785,"REQB","B","RMPR*3.0*75",1)

"MBREQ")
0
"PKG",150,-1)
1^1
"PKG",150,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",150,20,0)
^9.402P^^0
"PKG",150,22,0)
^9.49I^1^1
"PKG",150,22,1,0)
3.0^2960209^2960620
"PKG",150,22,1,"PAH",1,0)
122^3070619
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","RMPR29CA")
0^3^B68273293^B67346263
"RTN","RMPR29CA",1,0)
RMPR29CA ;OI-HINES/HNC,SPS -WORK ORDER SUSPENSE RPC;12/27/2004
"RTN","RMPR29CA",2,0)
 ;;3.0;PROSTHETICS;**75,122**;Feb 09, 1996;Build 2
"RTN","RMPR29CA",3,0)
A1(RMIE68,RMPRDUZ,RMSUSTAT,RMPR6641,RMPRTXT) ;roll and scroll entry point
"RTN","RMPR29CA",4,0)
 G A2
"RTN","RMPR29CA",5,0)
EN(RESULTS,RMIE68,RMPRDUZ,RMSUSTAT,RMPR6641,RMPRTXT) ;RPC entry point
"RTN","RMPR29CA",6,0)
A2 ;
"RTN","RMPR29CA",7,0)
 S RESULTS(0)=""
"RTN","RMPR29CA",8,0)
 K ^TMP($J)
"RTN","RMPR29CA",9,0)
 ;
"RTN","RMPR29CA",10,0)
CONT ;RMSUSTAT is status 1=complete or 0=initial note or 2=pending (incomplete)
"RTN","RMPR29CA",11,0)
 ;3=cancel or 4=cancel and clone 
"RTN","RMPR29CA",12,0)
 S RMIE=0
"RTN","RMPR29CA",13,0)
 F  S RMIE=$O(^RMPR(664.1,RMPR6641,2,RMIE)) Q:RMIE'>0  D
"RTN","RMPR29CA",14,0)
 .S RMIE60=$P(^RMPR(664.1,RMPR6641,2,RMIE,0),U,5)
"RTN","RMPR29CA",15,0)
 .S ^TMP($J,RMIE60)=""
"RTN","RMPR29CA",16,0)
 .D FD,UPD
"RTN","RMPR29CA",17,0)
 I RMSUSTAT=1 D CNOTE
"RTN","RMPR29CA",18,0)
 I RMSUSTAT=0 D INOTE,FD
"RTN","RMPR29CA",19,0)
 I RMSUSTAT=2 D ONOTE,FD
"RTN","RMPR29CA",20,0)
 I RMSUSTAT=3 D CANOTE^RMPR29CB
"RTN","RMPR29CA",21,0)
 I RMSUSTAT=4 D CANOTE^RMPR29CB
"RTN","RMPR29CA",22,0)
 ;set status
"RTN","RMPR29CA",23,0)
 Q
"RTN","RMPR29CA",24,0)
CNOTE ;(#12) COMPLETION NOTE
"RTN","RMPR29CA",25,0)
 ;set file 668
"RTN","RMPR29CA",26,0)
 ;^RMPR(668,D0,4,0)=^668.012^^
"RTN","RMPR29CA",27,0)
 ;if status is close, or 1
"RTN","RMPR29CA",28,0)
 ;RMPRTXT ;load into field #12
"RTN","RMPR29CA",29,0)
 ;^RMPR(668,D0,4,D1,0)
"RTN","RMPR29CA",30,0)
 ;
"RTN","RMPR29CA",31,0)
 ;Update file 664.1 on Close out
"RTN","RMPR29CA",32,0)
 I +$P(^RMPR(664.1,RMPR6641,0),U,16)'>0 S $P(^(0),U,16)=DUZ,$P(^(7),U,1)=DT,$P(^(7),U,3)=DUZ
"RTN","RMPR29CA",33,0)
 S DIE="^RMPR(664.1,",DA=RMPR6641
"RTN","RMPR29CA",34,0)
 S DR="16////^S X=""C"";22////^S X=DUZ;23///^S X=DT" D ^DIE
"RTN","RMPR29CA",35,0)
 K DR,DA,DIE
"RTN","RMPR29CA",36,0)
 S RMIE=0
"RTN","RMPR29CA",37,0)
 F  S RMIE=$O(^RMPR(664.1,RMPR6641,2,RMIE)) Q:RMIE'>0  D
"RTN","RMPR29CA",38,0)
 .S DIE="^RMPR(664.2,",DA=$P($G(^RMPR(664.1,RMPR6641,2,RMIE,0)),U,6)
"RTN","RMPR29CA",39,0)
 .Q:DA'>0
"RTN","RMPR29CA",40,0)
 .S DR="8////^S X=DT;9////^S X=DUZ" D ^DIE
"RTN","RMPR29CA",41,0)
 .K DA,DR,DIE
"RTN","RMPR29CA",42,0)
 .S DIE="^RMPR(660,",DA=$P($G(^RMPR(664.1,RMPR6641,2,RMIE,0)),U,5)
"RTN","RMPR29CA",43,0)
 .Q:DA'>0
"RTN","RMPR29CA",44,0)
 .S DR="8.4////^S X=DT;10////^S X=DT;50////^S X=DT" D ^DIE
"RTN","RMPR29CA",45,0)
 .K DA,DR,DIE
"RTN","RMPR29CA",46,0)
 S DA=RMIE68
"RTN","RMPR29CA",47,0)
 D NOW^%DTC S RMPREODT=%,GMRCAD=%
"RTN","RMPR29CA",48,0)
 S DIE="^RMPR(668,"
"RTN","RMPR29CA",49,0)
 S DR="5////^S X=RMPREODT;6////^S X=DUZ;14///^S X=""C""" D ^DIE
"RTN","RMPR29CA",50,0)
 N RMPRC
"RTN","RMPR29CA",51,0)
 S L="",LN=0
"RTN","RMPR29CA",52,0)
 F  S L=$O(RMPRTXT(L)) Q:L=""  D
"RTN","RMPR29CA",53,0)
 . I 'LN D  Q:RMPRC=""  ;strip leading space from 1st line, ignore blank line
"RTN","RMPR29CA",54,0)
 .. S RMPRC=$E($TR(RMPRTXT(L)," ","")) ;1st non space char
"RTN","RMPR29CA",55,0)
 .. S:RMPRC'="" RMPRTXT(L)=$E(RMPRTXT(L),$F(RMPRTXT(L),RMPRC)-1,$L(RMPRTXT(L))) ;extract from 1st non space char to end of line
"RTN","RMPR29CA",56,0)
 .. Q
"RTN","RMPR29CA",57,0)
 . S LN=LN+1,^RMPR(668,RMIE68,4,LN,0)=RMPRTXT(L)
"RTN","RMPR29CA",58,0)
 . Q
"RTN","RMPR29CA",59,0)
 S $P(^RMPR(668,RMIE68,4,0),"^",3)=LN
"RTN","RMPR29CA",60,0)
 K L,LN
"RTN","RMPR29CA",61,0)
 ;S DA=RMIE68,DIK="^RMPR(668," D IX1^DIK
"RTN","RMPR29CA",62,0)
 I '$P(^RMPR(668,DA,0),U,9) D
"RTN","RMPR29CA",63,0)
 .S DIE="^RMPR(668,"
"RTN","RMPR29CA",64,0)
 .S DR="7///^S X=""See Completion Note for Initial Action Taken."""
"RTN","RMPR29CA",65,0)
 .D ^DIE
"RTN","RMPR29CA",66,0)
 .S DR="10////^S X=RMPREODT;16////^S X=DUZ" D ^DIE
"RTN","RMPR29CA",67,0)
 K RMPREODT
"RTN","RMPR29CA",68,0)
 S GMRCO=$P(^RMPR(668,RMIE68,0),U,15)
"RTN","RMPR29CA",69,0)
 I GMRCO="" S RESULTS(0)="0^Completed Manual Suspense Action.  Suspense status has been updated to CLOSED." Q
"RTN","RMPR29CA",70,0)
 S RMPRCOM=0
"RTN","RMPR29CA",71,0)
 F  S RMPRCOM=$O(^RMPR(668,RMIE68,4,RMPRCOM)) Q:RMPRCOM=""  D
"RTN","RMPR29CA",72,0)
 .S GMRCOM(RMPRCOM)=^RMPR(668,RMIE68,4,RMPRCOM,0)
"RTN","RMPR29CA",73,0)
 I $G(GMRCOM)="" S GMRCOM="Not Noted"
"RTN","RMPR29CA",74,0)
 S GMRCSF="U"
"RTN","RMPR29CA",75,0)
 S GMRCA=10
"RTN","RMPR29CA",76,0)
 S GMRCALF="N"
"RTN","RMPR29CA",77,0)
 S GMRCATO=""
"RTN","RMPR29CA",78,0)
 S (GMRCORNP,GMRCDUZ)=DUZ
"RTN","RMPR29CA",79,0)
 S BDC=$$SFILE^GMRCGUIB(.GMRCO,.GMRCA,.GMRCSF,.GMRCORNP,.GMRCDUZ,.GMRCOM,.GMRCALF,.GMRCATO,.GMRCAD)
"RTN","RMPR29CA",80,0)
 I +BDC=1 S RESULTS(0)=1_"^"_$P(BDC,U,2)
"RTN","RMPR29CA",81,0)
 K GMRCO,GMRCA,GMRCSF,GMRCORNP,GMRCDUZ,GMRCOM,GMRCALF,GMRCATO,GMRCAD
"RTN","RMPR29CA",82,0)
 I RESULTS(0)="" S RESULTS(0)="0^Completed Suspense Action, and Posted note to CPRS Consult.  Suspense status has been updated to CLOSED."
"RTN","RMPR29CA",83,0)
 Q
"RTN","RMPR29CA",84,0)
ONOTE ;Other note
"RTN","RMPR29CA",85,0)
 ;set file 668
"RTN","RMPR29CA",86,0)
 ;^RMPR(668,D0,4,0)=^668.012^^
"RTN","RMPR29CA",87,0)
 ;if status is pending, and already initial action note or 0
"RTN","RMPR29CA",88,0)
 ;^RMPR(668,D0,1,D1,0)= (#.01) ACTION DATE [1D] 
"RTN","RMPR29CA",89,0)
 ;RMPRTXT ;load into field #11, #1
"RTN","RMPR29CA",90,0)
 ;^RMPR(668,D0,1,D1,1,0)=^668.111^^  
"RTN","RMPR29CA",91,0)
 ;
"RTN","RMPR29CA",92,0)
 S RMPRDA1=RMIE68,DA(1)=RMIE68,DA=RMIE68
"RTN","RMPR29CA",93,0)
 D NOW^%DTC S X=%,GMRCWHN=%
"RTN","RMPR29CA",94,0)
 S DIC="^RMPR(668,"_RMIE68_",1,"
"RTN","RMPR29CA",95,0)
 S DIC(0)="CQL"
"RTN","RMPR29CA",96,0)
 S DIC("P")="668.011DA"
"RTN","RMPR29CA",97,0)
 S DLAYGO=668
"RTN","RMPR29CA",98,0)
 D ^DIC
"RTN","RMPR29CA",99,0)
 I Y=-1 S RESULTS(0)="1^Error Modifying Record!" Q
"RTN","RMPR29CA",100,0)
 ;S DIE=DIC K DIC
"RTN","RMPR29CA",101,0)
 S (DA,RMPRDA2)=+Y
"RTN","RMPR29CA",102,0)
 ;S DR="1" D ^DIE
"RTN","RMPR29CA",103,0)
 K DIE,DR,Y
"RTN","RMPR29CA",104,0)
 ;S ^RMPR(668,RMIE68,1,0)="^668.011DA^1^1"
"RTN","RMPR29CA",105,0)
 N RMPRC
"RTN","RMPR29CA",106,0)
 S L="",LN=0
"RTN","RMPR29CA",107,0)
 F  S L=$O(RMPRTXT(L)) Q:L=""  D
"RTN","RMPR29CA",108,0)
 . I 'LN D  Q:RMPRC=""  ;strip leading space from 1st line, ignore blank  line
"RTN","RMPR29CA",109,0)
 .. S RMPRC=$E($TR(RMPRTXT(L)," ","")) ;1st non space char
"RTN","RMPR29CA",110,0)
 .. S:RMPRC'="" RMPRTXT(L)=$E(RMPRTXT(L),$F(RMPRTXT(L),RMPRC)-1,$L(RMPRTXT(L))) ;extract from 1st non space char to end of line
"RTN","RMPR29CA",111,0)
 .. Q
"RTN","RMPR29CA",112,0)
 . S LN=LN+1,^RMPR(668,RMIE68,1,RMPRDA2,1,LN,0)=RMPRTXT(L)
"RTN","RMPR29CA",113,0)
 . Q
"RTN","RMPR29CA",114,0)
 S $P(^RMPR(668,RMIE68,1,RMPRDA2,1,0),"^",3)=LN
"RTN","RMPR29CA",115,0)
 K L,LN
"RTN","RMPR29CA",116,0)
 S GMRCO=$P(^RMPR(668,RMIE68,0),U,15)
"RTN","RMPR29CA",117,0)
 I GMRCO="" S RESULTS(0)="0^Completed Manual Suspense Action.  Suspense status has not changed." Q
"RTN","RMPR29CA",118,0)
 S RMPRCOM=0
"RTN","RMPR29CA",119,0)
 F  S RMPRCOM=$O(^RMPR(668,RMIE68,1,RMPRDA2,1,RMPRCOM)) Q:RMPRCOM=""  D
"RTN","RMPR29CA",120,0)
 .S GMRCOM(RMPRCOM)=^RMPR(668,RMIE68,1,RMPRDA2,1,RMPRCOM,0)
"RTN","RMPR29CA",121,0)
 D CMT^GMRCGUIB(.GMRCO,.GMRCOM,"",GMRCWHN,DUZ)
"RTN","RMPR29CA",122,0)
 K DA,RMPRDA1,RMPRDA2,RMPRCOM,GMRCOM,GMRCO,GMRCWHN
"RTN","RMPR29CA",123,0)
 S RESULTS(0)="0^Completed Suspense Action, and Posted note to CPRS Consult.  Suspense status has not changed."
"RTN","RMPR29CA",124,0)
 Q
"RTN","RMPR29CA",125,0)
INOTE ;initial action note
"RTN","RMPR29CA",126,0)
 ;set file 668
"RTN","RMPR29CA",127,0)
 ;^RMPR(668,D0,3,0)=^668.07^^
"RTN","RMPR29CA",128,0)
 ;if status is pending, or 0
"RTN","RMPR29CA",129,0)
 ;RMPRTXT ;load into field #7
"RTN","RMPR29CA",130,0)
 ;^RMPR(668,D0,3,0)=^668.07^^
"RTN","RMPR29CA",131,0)
 ;
"RTN","RMPR29CA",132,0)
 I $D(^RMPR(668,RMIE68,3,1,0)) S RESULTS(0)="1^Initial Action Note Already Posted!" Q
"RTN","RMPR29CA",133,0)
 D NOW^%DTC S RMPREODT=%
"RTN","RMPR29CA",134,0)
 N RMPRC
"RTN","RMPR29CA",135,0)
 S ^RMPR(668,RMIE68,3,0)="^^^"_DT_"^"
"RTN","RMPR29CA",136,0)
 S L="",LN=0
"RTN","RMPR29CA",137,0)
 F  S L=$O(RMPRTXT(L)) Q:L=""  D
"RTN","RMPR29CA",138,0)
 . I 'LN D  Q:RMPRC=""  ;strip leading space from 1st line, ignore blank  line
"RTN","RMPR29CA",139,0)
 .. S RMPRC=$E($TR(RMPRTXT(L)," ","")) ;1st non space char
"RTN","RMPR29CA",140,0)
 .. S:RMPRC'="" RMPRTXT(L)=$E(RMPRTXT(L),$F(RMPRTXT(L),RMPRC)-1,$L(RMPRTXT(L))) ;extract from 1st non space char to end of line
"RTN","RMPR29CA",141,0)
 .. Q
"RTN","RMPR29CA",142,0)
 . S LN=LN+1,^RMPR(668,RMIE68,3,LN,0)=RMPRTXT(L)
"RTN","RMPR29CA",143,0)
 . Q
"RTN","RMPR29CA",144,0)
 S $P(^RMPR(668,RMIE68,3,0),"^",3)=LN
"RTN","RMPR29CA",145,0)
 K L,LN
"RTN","RMPR29CA",146,0)
 S DIE="^RMPR(668,"
"RTN","RMPR29CA",147,0)
 S DA=RMIE68
"RTN","RMPR29CA",148,0)
 S DR="10////^S X=RMPREODT;16////^S X=DUZ;14///^S X=""P"""
"RTN","RMPR29CA",149,0)
 D ^DIE
"RTN","RMPR29CA",150,0)
 S GMRCO=$P(^RMPR(668,RMIE68,0),U,15)
"RTN","RMPR29CA",151,0)
 I GMRCO="" S RESULTS(0)="0^Completed Manual Suspense Action.  Suspense status has been updated to PENDING" Q
"RTN","RMPR29CA",152,0)
 S RMPRCMT=0
"RTN","RMPR29CA",153,0)
 F  S RMPRCMT=$O(^RMPR(668,RMIE68,3,RMPRCMT)) Q:RMPRCMT=""  D
"RTN","RMPR29CA",154,0)
 .S GMRCMT(RMPRCMT)=^RMPR(668,RMIE68,3,RMPRCMT,0)
"RTN","RMPR29CA",155,0)
 D CMT^GMRCGUIB(GMRCO,.GMRCMT,DUZ,RMPREODT,DUZ)
"RTN","RMPR29CA",156,0)
 K RMPREODT,GMRCO,RMGMRCO,GMRCMT,RMPRCMT
"RTN","RMPR29CA",157,0)
 S RESULTS(0)="0^Completed Suspense Action, and Posted note to CPRS Consult.  Suspense status has changed to PENDING."
"RTN","RMPR29CA",158,0)
 Q
"RTN","RMPR29CA",159,0)
 ;
"RTN","RMPR29CA",160,0)
FD ;file date
"RTN","RMPR29CA",161,0)
 N DIE,DIC,I,J,Y,RMDFN,RMI,RMDATE,RM680,RM6810,RMERROR,RM60L,RC
"RTN","RMPR29CA",162,0)
 N RMERR,RMCHK,DLAYGO,X,DR,RM668,RM60DAT,RMSTATUS
"RTN","RMPR29CA",163,0)
 N RM68CNT,RM60CNT,RMREQU,RMSI,RMSAMIS,RM68IEN,RM60IEN,RMSUS60,RMSUS68,RMD
"RTN","RMPR29CA",164,0)
 N RM68DATA,RM60TYP,RM68D,RM68TRAN,RMPRPRC,RM60IT,RMENTSUS,RMQUIT
"RTN","RMPR29CA",165,0)
 ;
"RTN","RMPR29CA",166,0)
 S RMERR=0
"RTN","RMPR29CA",167,0)
 S:RMSUSTAT="" RMSUSTAT=0
"RTN","RMPR29CA",168,0)
 L +^RMPR(660,RMIE60):2
"RTN","RMPR29CA",169,0)
 I $T=0 S RESULTS(0)="1^Someone else is Editing this entry!" G EXIT
"RTN","RMPR29CA",170,0)
 S RM680=$G(^RMPR(668,RMIE68,0))
"RTN","RMPR29CA",171,0)
 S RM688=$G(^RMPR(668,RMIE68,8))
"RTN","RMPR29CA",172,0)
 S RM6810=$G(^RMPR(668,RMIE68,10))
"RTN","RMPR29CA",173,0)
 S RMAMIS=$P($G(^RMPR(660,RMIE60,"AMS")),U,1)
"RTN","RMPR29CA",174,0)
 ;code here for 668 fields
"RTN","RMPR29CA",175,0)
 S RMDATE=$P(RM680,U,1)
"RTN","RMPR29CA",176,0)
 S RMCODT=$P(RM680,U,5)
"RTN","RMPR29CA",177,0)
 S RMINDT=$P(RM680,U,9)
"RTN","RMPR29CA",178,0)
 S RMPRCO=$P(RM680,U,15)
"RTN","RMPR29CA",179,0)
 S RMDWRT=$P(RM680,U,16)
"RTN","RMPR29CA",180,0)
 S RMSTAT=$P(RM680,U,7)
"RTN","RMPR29CA",181,0)
 S RMTRES=$P(RM680,U,8)
"RTN","RMPR29CA",182,0)
 S RMTYRE=$S(RMTRES=1:"ROUTINE",RMTRES=2:"EYEGLASS",RMTRES=3:"CONTACT LENS",RMTRES=4:"OXYGEN",RMTRES=5:"MANUAL",RMTRES=11:"LAB",1:"")
"RTN","RMPR29CA",183,0)
 S RMREQU=$P(RM680,U,11)
"RTN","RMPR29CA",184,0)
 S RMSERV=""
"RTN","RMPR29CA",185,0)
 I $G(RMREQU) D GETS^DIQ(200,RMREQU,"29","E","RMAA") S RMSERV=RMAA(200,RMREQU_",",29,"E")
"RTN","RMPR29CA",186,0)
 S RMPRDI=$E($P(RM688,U,2),1,16)
"RTN","RMPR29CA",187,0)
 S RMICD9=$P(RM688,U,3)
"RTN","RMPR29CA",188,0)
 ;
"RTN","RMPR29CA",189,0)
 S RMDAT(660,RMIE60_",",8.1)=RMDATE
"RTN","RMPR29CA",190,0)
 S RMDAT(660,RMIE60_",",8.2)=RMDWRT
"RTN","RMPR29CA",191,0)
 S RMDAT(660,RMIE60_",",8.3)=RMINDT
"RTN","RMPR29CA",192,0)
 S RMDAT(660,RMIE60_",",8.4)=RMCODT
"RTN","RMPR29CA",193,0)
 S RMDAT(660,RMIE60_",",8.5)=RMTYRE
"RTN","RMPR29CA",194,0)
 S RMDAT(660,RMIE60_",",8.6)=RMREQU
"RTN","RMPR29CA",195,0)
 S RMDAT(660,RMIE60_",",8.61)=RMSERV
"RTN","RMPR29CA",196,0)
 S RMDAT(660,RMIE60_",",8.7)=RMPRDI
"RTN","RMPR29CA",197,0)
 S RMDAT(660,RMIE60_",",8.8)=RMICD9
"RTN","RMPR29CA",198,0)
 S RMDAT(660,RMIE60_",",8.9)=RMPRCO
"RTN","RMPR29CA",199,0)
 S RMDAT(660,RMIE60_",",8.11)=RMSTAT
"RTN","RMPR29CA",200,0)
 I RMSUSTAT=2 S RMDAT(660,RMIE60_",",8.14)=0
"RTN","RMPR29CA",201,0)
 I RMSUSTAT'=2 S RMDAT(660,RMIE60_",",8.14)=RMSUSTAT
"RTN","RMPR29CA",202,0)
 D FILE^DIE("","RMDAT","RMERROR")
"RTN","RMPR29CA",203,0)
 L -^RMPR(660,RMIE60)
"RTN","RMPR29CA",204,0)
 I $D(RMERROR) S RMERR=1 D ERR
"RTN","RMPR29CA",205,0)
 ;
"RTN","RMPR29CA",206,0)
 Q
"RTN","RMPR29CA",207,0)
UPD ;update file 668 with 2319 records
"RTN","RMPR29CA",208,0)
 K DD,D0
"RTN","RMPR29CA",209,0)
 S DA(1)=RMIE68
"RTN","RMPR29CA",210,0)
 S DIC="^RMPR(668,"_DA(1)_","_"10,"
"RTN","RMPR29CA",211,0)
 S DIC(0)="L",DLAYGO=668,X=RMIE60
"RTN","RMPR29CA",212,0)
 D FILE^DICN
"RTN","RMPR29CA",213,0)
 S DA(1)=RMIE68
"RTN","RMPR29CA",214,0)
 S DIC="^RMPR(668,"_DA(1)_","_"11,"
"RTN","RMPR29CA",215,0)
 S X=RMAMIS
"RTN","RMPR29CA",216,0)
 D FILE^DICN
"RTN","RMPR29CA",217,0)
 K DIC,X,DLAYGO,D0
"RTN","RMPR29CA",218,0)
 Q
"RTN","RMPR29CA",219,0)
A3 G A4
"RTN","RMPR29CA",220,0)
EN1(RESULTS,DA) ;Broker entry to kill WO
"RTN","RMPR29CA",221,0)
 ;DA is passed
"RTN","RMPR29CA",222,0)
 S DIK="^RMPR(664.1," D ^DIK
"RTN","RMPR29CA",223,0)
 K DIK
"RTN","RMPR29CA",224,0)
A4 ;
"RTN","RMPR29CA",225,0)
 Q
"RTN","RMPR29CA",226,0)
ERR ;exit on error
"RTN","RMPR29CA",227,0)
EXIT ;
"RTN","RMPR29CA",228,0)
 K RMTYRE,RMTRES,RMSUSTAT,RMSTAT,RMSERV,RMEQU,RMPRTST,RMPRDUZ,RMPRDI,RMPRCO,RMPR6641,RMIE68
"RTN","RMPR29CA",229,0)
 K RMIE60,RMIE,RMICD9,RMDWRT,RMDAT,RMCODT,RMAMIS,RMAA,RM688,RMPRTXT
"RTN","RMPR29CA",230,0)
 K BDC,BAD,%,RMINDT,RMPREQU
"RTN","RMPR29WO")
0^4^B19191231^B18989581
"RTN","RMPR29WO",1,0)
RMPR29WO ;HOIFO/SPS -  WORK ORDER GRID OWL PROGRAM ;11/8/05  07:12
"RTN","RMPR29WO",2,0)
 ;;3.0;PROSTHETICS;**75,122**;Feb 09, 1996;Build 2
"RTN","RMPR29WO",3,0)
 ;
"RTN","RMPR29WO",4,0)
 ;SORT - STATUS OF 664.1, if CA change to X to check.
"RTN","RMPR29WO",5,0)
 ;
"RTN","RMPR29WO",6,0)
A1(SORT) ;entry point for testing
"RTN","RMPR29WO",7,0)
 D A2
"RTN","RMPR29WO",8,0)
 Q
"RTN","RMPR29WO",9,0)
EN(RESULT,SORT) ; -- Broker callback to get list to display
"RTN","RMPR29WO",10,0)
A2 N STRING,CLREND,COLUMN,ON,OFF
"RTN","RMPR29WO",11,0)
 S DATE=2010101
"RTN","RMPR29WO",12,0)
 S SITE="ALL",START=00,STOP=99
"RTN","RMPR29WO",13,0)
 K ^TMP($J)
"RTN","RMPR29WO",14,0)
 N RMPRA,CDATE,X
"RTN","RMPR29WO",15,0)
 K ADATE,PDAY,RMPRCD
"RTN","RMPR29WO",16,0)
 S (CNT,VALMCNT)=0,(RMPR6641,RRX)=""
"RTN","RMPR29WO",17,0)
 F  S RMPR6641=$O(^RMPR(664.1,RMPR6641)) Q:RMPR6641=""  D
"RTN","RMPR29WO",18,0)
 .I '$D(^RMPR(664.1,RMPR6641,0)) Q
"RTN","RMPR29WO",19,0)
 .I $P(^RMPR(664.1,RMPR6641,0),U,13)="" Q
"RTN","RMPR29WO",20,0)
 .S WO66410=^RMPR(664.1,RMPR6641,0)
"RTN","RMPR29WO",21,0)
 .S RMSTS=$P(WO66410,U,17)
"RTN","RMPR29WO",22,0)
 .I RMSTS="CA" S RMSTS="X"
"RTN","RMPR29WO",23,0)
 .I RMSTS="PC" Q
"RTN","RMPR29WO",24,0)
 .I SORT'[RMSTS Q
"RTN","RMPR29WO",25,0)
 .I RMSTS="X" S RMSTS="CA"
"RTN","RMPR29WO",26,0)
 .S RMSTS=$$EXTERNAL^DILFD(664.1,16,"",RMSTS)
"RTN","RMPR29WO",27,0)
 .S RMRDTI=$P(WO66410,U,9)
"RTN","RMPR29WO",28,0)
 .S RMPRA=$P(WO66410,U,8) Q:RMPRA'>0  D
"RTN","RMPR29WO",29,0)
 ..S STN=$P(^RMPR(668,RMPRA,0),U,7)
"RTN","RMPR29WO",30,0)
 ..S STNX=$$STATN^RMPRUTIL(STN)
"RTN","RMPR29WO",31,0)
 ..;ssn range filter
"RTN","RMPR29WO",32,0)
 ..S DFN=$P(^RMPR(668,RMPRA,0),U,2)
"RTN","RMPR29WO",33,0)
 ..D DEM^VADPT
"RTN","RMPR29WO",34,0)
 ..S SSNEN=$E($P(VADM(2),"^",2),10,11)
"RTN","RMPR29WO",35,0)
 ..I SSNEN>STOP Q
"RTN","RMPR29WO",36,0)
 ..I SSNEN<START Q
"RTN","RMPR29WO",37,0)
 ..K SSNEN,VADM
"RTN","RMPR29WO",38,0)
 ..D REC
"RTN","RMPR29WO",39,0)
 S I=""
"RTN","RMPR29WO",40,0)
 F  S I=$O(^TMP($J,I)) Q:I'>0  D
"RTN","RMPR29WO",41,0)
 .Q:'$D(^TMP($J,I))
"RTN","RMPR29WO",42,0)
 .S ^TMP($J,"RMPRWO",CNT)=^TMP($J,I)
"RTN","RMPR29WO",43,0)
 .S CNT=CNT-1
"RTN","RMPR29WO",44,0)
 G EXIT
"RTN","RMPR29WO",45,0)
 Q
"RTN","RMPR29WO",46,0)
REC ;records to grid
"RTN","RMPR29WO",47,0)
 ;stop date, init action date
"RTN","RMPR29WO",48,0)
 ;check ien, patch 77
"RTN","RMPR29WO",49,0)
 ;
"RTN","RMPR29WO",50,0)
 N DIC,DIQ,DR,STOPDT
"RTN","RMPR29WO",51,0)
 S STOPDT=$P($G(^RMPR(668,RMPRA,0)),U,9),STOPDT=$$DAT2^RMPRUTL1(STOPDT)
"RTN","RMPR29WO",52,0)
 I $D(RMRDTI) S RMRDTE=$$DAT2^RMPRUTL1(RMRDTI)
"RTN","RMPR29WO",53,0)
 S CDATE=$P(^RMPR(668,RMPRA,0),U,1),CDATE=$$DAT2^RMPRUTL1(CDATE)
"RTN","RMPR29WO",54,0)
 S WDATE=$P(^RMPR(664.1,RMPR6641,0),U,1),WDATE=$$DAT2^RMPRUTL1(WDATE)
"RTN","RMPR29WO",55,0)
 S RMWDTI=$P(^RMPR(664.1,RMPR6641,0),U,1)
"RTN","RMPR29WO",56,0)
 S DFN=$P(^RMPR(668,RMPRA,0),U,2) Q:DFN=""
"RTN","RMPR29WO",57,0)
 N VA,VADM
"RTN","RMPR29WO",58,0)
 D DEM^VADPT
"RTN","RMPR29WO",59,0)
 S WHO=VADM(1)
"RTN","RMPR29WO",60,0)
 S SSN=VADM(2)
"RTN","RMPR29WO",61,0)
 D KVAR^VADPT
"RTN","RMPR29WO",62,0)
 ;type
"RTN","RMPR29WO",63,0)
 S TYPE=$$TYPE^RMPREOU(RMPRA,8)
"RTN","RMPR29WO",64,0)
 Q:TYPE'["LAB"
"RTN","RMPR29WO",65,0)
 S CNT=CNT+1
"RTN","RMPR29WO",66,0)
 ;display description if manual
"RTN","RMPR29WO",67,0)
 S DES=$$DES^RMPREOU(RMPRA,22)
"RTN","RMPR29WO",68,0)
 S DES=$TR(DES,"^","*")
"RTN","RMPR29WO",69,0)
 S DES=$TR(DES,"""","'")
"RTN","RMPR29WO",70,0)
 ;init action date
"RTN","RMPR29WO",71,0)
 S ADATE="",PDAY="",WRKDAY=""
"RTN","RMPR29WO",72,0)
 S ADATE=$P(^RMPR(668,RMPRA,0),U,9)
"RTN","RMPR29WO",73,0)
 ;PPD=1 for previous pending
"RTN","RMPR29WO",74,0)
 I ADATE'="" S CDAY=$$PDAY^RMPREOU(RMPRA)
"RTN","RMPR29WO",75,0)
 ;
"RTN","RMPR29WO",76,0)
 S LINKED=$P($G(^RMPR(668,RMPRA,10,0)),U,4)
"RTN","RMPR29WO",77,0)
 I LINKED="" S LINKED=0
"RTN","RMPR29WO",78,0)
 ;
"RTN","RMPR29WO",79,0)
 ; Note for list the Variable SSN is in the format NNNNNNNNN^NNN-NN-NNNN
"RTN","RMPR29WO",80,0)
 ; Thus making up 2 pieces of the data string below.
"RTN","RMPR29WO",81,0)
 S ^TMP($J,RMPR6641)=CDATE_U_DFN_U_WHO_U_SSN_U_TYPE_U_DES
"RTN","RMPR29WO",82,0)
 S ^TMP($J,RMPR6641)=^TMP($J,RMPR6641)_U_RMSTS_U_RMPRA_U_RMPR6641
"RTN","RMPR29WO",83,0)
 ;Get Work Order Data and add to array
"RTN","RMPR29WO",84,0)
 S RMPRPHCI=$P($G(^RMPR(664.1,RMPR6641,2,1,0)),U,1),RMPRPHCE=$$EXTERNAL^DILFD(661.1,1,"",RMPRPHCI)
"RTN","RMPR29WO",85,0)
 S RMPRWN=$P(WO66410,U,13)
"RTN","RMPR29WO",86,0)
 S RMPRROFF=$$EXTERNAL^DILFD(664.1,13,"",$P(WO66410,U,5))
"RTN","RMPR29WO",87,0)
 S RMPRTECH=$$EXTERNAL^DILFD(664.1,13,"",$P(WO66410,U,16))
"RTN","RMPR29WO",88,0)
 S RMPRSOPI=$P(WO66410,U,11),RMPRSOPE=$$EXTERNAL^DILFD(664.1,2,"",RMPRSOPI)
"RTN","RMPR29WO",89,0)
 S RMNPPDSI=$P(WO66410,U,3),RMNPPDSE=$$EXTERNAL^DILFD(664.1,.03,"",RMNPPDSI),RMNPPDSN=$$STATN^RMPRUTIL(RMNPPDSI)
"RTN","RMPR29WO",90,0)
 S RMPRSITE=$O(^RMPR(669.9,"C",RMNPPDSI,0))
"RTN","RMPR29WO",91,0)
 S RMREQSTI=$P(WO66410,U,4),RMREQSTE=$$EXTERNAL^DILFD(664.1,.04,"",RMREQSTI),RMREQSTN=$$STATN^RMPRUTIL(RMREQSTI)
"RTN","RMPR29WO",92,0)
 S RMRECSTI=$P(WO66410,U,15),RMRECSTE=$$EXTERNAL^DILFD(664.1,.11,"",RMRECSTI),RMRECSTN=$$STATN^RMPRUTIL(RMRECSTI)
"RTN","RMPR29WO",93,0)
 S ^TMP($J,RMPR6641)=^TMP($J,RMPR6641)_U_RMPRPHCE_U_RMPRWN_U_RMPRROFF_U_RMPRTECH_U_RMPRSOPE_U_RMNPPDSN_U_RMNPPDSE_U_RMREQSTN_U_RMREQSTE_U_RMRECSTN_U_RMRECSTE_U_RMPRSITE_U_WDATE_U_RMRDTE
"RTN","RMPR29WO",94,0)
 K CDATE,WHO,SSN,TYPE,DES,PDAY,STATUS,ADATE,RMRDTE
"RTN","RMPR29WO",95,0)
 ;PUT RESULTS IN GLOBAL!!
"RTN","RMPR29WO",96,0)
 Q
"RTN","RMPR29WO",97,0)
 K CDAY,CNT,DATE,DFN,I,LINKED,RMNPPDSE,RMNPPDSI,RMNPPDSN,RMPR6641
"RTN","RMPR29WO",98,0)
 K RMPRPHCE,RMPRPHCI,RMPRROFF,RMPRSITE,RMPRSOPE,RMPRSOPI,RMPRTECH
"RTN","RMPR29WO",99,0)
 K RMPRWN,RMPRDTI,RMRECSTE,RMRECSTI,RMRECSTN,RMREQSTE,RMREQSTI
"RTN","RMPR29WO",100,0)
 K RMREQSTN,RMSTS,RMWDTI,RRX,SITE,START,STN,STNX,STOP,VALMCNT,WDATE,WO66410,WRKDAY
"RTN","RMPR29WO",101,0)
EXIT ;common exit point
"RTN","RMPR29WO",102,0)
 S RESULT=$NA(^TMP($J,"RMPRWO"))
"RTN","RMPR29WO",103,0)
 Q
"VER")
8.0^22.0
"BLD",5785,6)
^112
**END**
**END**
