Released LR*5.2*362 SEQ #284
Extracted from mail message
**KIDS**:LR*5.2*362^

**INSTALL NAME**
LR*5.2*362
"BLD",6877,0)
LR*5.2*362^LAB SERVICE^0^3070425^y
"BLD",6877,1,0)
^^1^1^3060615^
"BLD",6877,1,1,0)
This patch addresses a number of minor issues in the Lab Package.
"BLD",6877,4,0)
^9.64PA^^0
"BLD",6877,6)
6^
"BLD",6877,6.3)
11
"BLD",6877,"ABPKG")
n
"BLD",6877,"KRN",0)
^9.67PA^8989.52^19
"BLD",6877,"KRN",.4,0)
.4
"BLD",6877,"KRN",.401,0)
.401
"BLD",6877,"KRN",.402,0)
.402
"BLD",6877,"KRN",.403,0)
.403
"BLD",6877,"KRN",.5,0)
.5
"BLD",6877,"KRN",.84,0)
.84
"BLD",6877,"KRN",3.6,0)
3.6
"BLD",6877,"KRN",3.8,0)
3.8
"BLD",6877,"KRN",9.2,0)
9.2
"BLD",6877,"KRN",9.8,0)
9.8
"BLD",6877,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",6877,"KRN",9.8,"NM",1,0)
LRWRKLST^^0^B41281168
"BLD",6877,"KRN",9.8,"NM",2,0)
LRUPS^^0^B8420333
"BLD",6877,"KRN",9.8,"NM",3,0)
LRAPPF1^^0^B17910180
"BLD",6877,"KRN",9.8,"NM",4,0)
LREXECU^^0^B6083878
"BLD",6877,"KRN",9.8,"NM",5,0)
LRORDST^^0^B30766466
"BLD",6877,"KRN",9.8,"NM",6,0)
LRCAPFDS^^0^B18264991
"BLD",6877,"KRN",9.8,"NM",7,0)
LRAPSM^^0^B14074767
"BLD",6877,"KRN",9.8,"NM","B","LRAPPF1",3)

"BLD",6877,"KRN",9.8,"NM","B","LRAPSM",7)

"BLD",6877,"KRN",9.8,"NM","B","LRCAPFDS",6)

"BLD",6877,"KRN",9.8,"NM","B","LREXECU",4)

"BLD",6877,"KRN",9.8,"NM","B","LRORDST",5)

"BLD",6877,"KRN",9.8,"NM","B","LRUPS",2)

"BLD",6877,"KRN",9.8,"NM","B","LRWRKLST",1)

"BLD",6877,"KRN",19,0)
19
"BLD",6877,"KRN",19.1,0)
19.1
"BLD",6877,"KRN",101,0)
101
"BLD",6877,"KRN",409.61,0)
409.61
"BLD",6877,"KRN",771,0)
771
"BLD",6877,"KRN",870,0)
870
"BLD",6877,"KRN",8989.51,0)
8989.51
"BLD",6877,"KRN",8989.52,0)
8989.52
"BLD",6877,"KRN",8994,0)
8994
"BLD",6877,"KRN","B",.4,.4)

"BLD",6877,"KRN","B",.401,.401)

"BLD",6877,"KRN","B",.402,.402)

"BLD",6877,"KRN","B",.403,.403)

"BLD",6877,"KRN","B",.5,.5)

"BLD",6877,"KRN","B",.84,.84)

"BLD",6877,"KRN","B",3.6,3.6)

"BLD",6877,"KRN","B",3.8,3.8)

"BLD",6877,"KRN","B",9.2,9.2)

"BLD",6877,"KRN","B",9.8,9.8)

"BLD",6877,"KRN","B",19,19)

"BLD",6877,"KRN","B",19.1,19.1)

"BLD",6877,"KRN","B",101,101)

"BLD",6877,"KRN","B",409.61,409.61)

"BLD",6877,"KRN","B",771,771)

"BLD",6877,"KRN","B",870,870)

"BLD",6877,"KRN","B",8989.51,8989.51)

"BLD",6877,"KRN","B",8989.52,8989.52)

"BLD",6877,"KRN","B",8994,8994)

"BLD",6877,"QUES",0)
^9.62^^
"BLD",6877,"REQB",0)
^9.611^9^6
"BLD",6877,"REQB",2,0)
LR*5.2*268^2
"BLD",6877,"REQB",4,0)
LR*5.2*322^2
"BLD",6877,"REQB",5,0)
LR*5.2*200^2
"BLD",6877,"REQB",7,0)
LR*5.2*274^2
"BLD",6877,"REQB",8,0)
LR*5.2*355^2
"BLD",6877,"REQB",9,0)
LR*5.2*359^2
"BLD",6877,"REQB","B","LR*5.2*200",5)

"BLD",6877,"REQB","B","LR*5.2*268",2)

"BLD",6877,"REQB","B","LR*5.2*274",7)

"BLD",6877,"REQB","B","LR*5.2*322",4)

"BLD",6877,"REQB","B","LR*5.2*355",8)

"BLD",6877,"REQB","B","LR*5.2*359",9)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)
 
"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
362^3070425^33274
"PKG",26,22,1,"PAH",1,1,0)
^^1^1^3070425
"PKG",26,22,1,"PAH",1,1,1,0)
This patch addresses a number of minor issues in the Lab Package.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","LRAPPF1")
0^3^B17910180^B17831632
"RTN","LRAPPF1",1,0)
LRAPPF1 ;AVAMC/REG/WTY - ANAT PATH FILE PRINT BY PT ;10/16/01
"RTN","LRAPPF1",2,0)
 ;;5.2;LAB SERVICE;**72,173,201,259,362**;Sep 27, 1994;Build 11
"RTN","LRAPPF1",3,0)
 ;
"RTN","LRAPPF1",4,0)
 ;Reference to ^DIC supported by IA #916
"RTN","LRAPPF1",5,0)
 ;
"RTN","LRAPPF1",6,0)
 S F=0 F  S F=$O(^TMP($J,F)) Q:'F!(LR("Q"))  D
"RTN","LRAPPF1",7,0)
 .S F(1)=$P(^DIC(F,0),"^"),F(2)=^DIC(F,0,"GL")
"RTN","LRAPPF1",8,0)
 .K LR("F") D H S LR("F")=1 D W
"RTN","LRAPPF1",9,0)
 Q:LR("Q")
"RTN","LRAPPF1",10,0)
 D ^LRAPPF2
"RTN","LRAPPF1",11,0)
 Q
"RTN","LRAPPF1",12,0)
W S W=0 F LRB=0:0 S W=$O(^TMP($J,F,W)) Q:W=""!(LR("Q"))  D LR
"RTN","LRAPPF1",13,0)
 Q
"RTN","LRAPPF1",14,0)
LR F LRDFN=0:0 S LRDFN=$O(^TMP($J,F,W,LRDFN)) Q:'LRDFN!(LR("Q"))  D NM
"RTN","LRAPPF1",15,0)
 Q
"RTN","LRAPPF1",16,0)
NM S X=^LR(LRDFN,0),LRDPF=$P(X,U,2),N=$P(X,"^",3),N=@(F(2)_N_",0)")
"RTN","LRAPPF1",17,0)
 S LRP=$P(N,"^"),SSN=$P(N,"^",9),Y=$P(N,"^",3)
"RTN","LRAPPF1",18,0)
 D D^LRU,SSN^LRU S DOB=$S(Y'[1700:Y,1:"")
"RTN","LRAPPF1",19,0)
 D:$Y>(IOSL-4) H Q:LR("Q")
"RTN","LRAPPF1",20,0)
 W !!,LRP,?31,SSN W:$L(DOB) ?51,"BORN: ",DOB
"RTN","LRAPPF1",21,0)
 S LRI=0 F  S LRI=$O(^TMP($J,F,W,LRDFN,LRI)) Q:'LRI!(LR("Q"))  D
"RTN","LRAPPF1",22,0)
 .D @($S("CYEMSP"[LRSS:"EN",1:"AUT"))
"RTN","LRAPPF1",23,0)
 Q
"RTN","LRAPPF1",24,0)
AUT D:$Y>(IOSL-12) H1 Q:LR("Q")
"RTN","LRAPPF1",25,0)
 S X=^LR(LRDFN,"AU"),N=$P(X,"^",6),Y=+X D D^LRU S LRH(3)=Y,DA=LRDFN
"RTN","LRAPPF1",26,0)
 D D^LRAUAW S Y=LR(63,12) D D^LRU S E=Y,H(2)=$E(H(1),1,3)
"RTN","LRAPPF1",27,0)
 W !,"AUTOPSY #: ",N," AUTOPSY DATE: ",LRH(3),?51,"DIED: ",E
"RTN","LRAPPF1",28,0)
 D EN^LRAPT2
"RTN","LRAPPF1",29,0)
 S X=0 F  S X=$O(^LR(LRDFN,"AY",X)) Q:'X!(LR("Q"))  D
"RTN","LRAPPF1",30,0)
 .S Y=+^LR(LRDFN,"AY",X,0),Y=$S($D(^LAB(61,Y,0)):$P(^(0),"^"),1:Y)
"RTN","LRAPPF1",31,0)
 .W !,Y D AM
"RTN","LRAPPF1",32,0)
 Q
"RTN","LRAPPF1",33,0)
AM S M=0 F  S M=$O(^LR(LRDFN,"AY",X,2,M)) Q:'M!(LR("Q"))  D
"RTN","LRAPPF1",34,0)
 .S Y=+^LR(LRDFN,"AY",X,2,M,0)
"RTN","LRAPPF1",35,0)
 .S Y=$S($D(^LAB(61.1,Y,0)):$P(^(0),"^"),1:Y)
"RTN","LRAPPF1",36,0)
 .W !?5,Y
"RTN","LRAPPF1",37,0)
 Q
"RTN","LRAPPF1",38,0)
 ;
"RTN","LRAPPF1",39,0)
EN ;from LRAPT1,LRAPQACN
"RTN","LRAPPF1",40,0)
 S LRSF515=+$G(LRSF515)  ;Indicates that this is generating an SF515
"RTN","LRAPPF1",41,0)
 S X=$G(^LR(LRDFN,S,LRI,0)) Q:X=""  S LR("PATH")=$P(X,U,2),N=$P(X,U,6)
"RTN","LRAPPF1",42,0)
 S N(11)=$P(X,U,11),X=$P(X,U,10),X=$P(X,"."),LRH(3)=$$Y2K^LRX(X)
"RTN","LRAPPF1",43,0)
 S H(2)=$E(X,1,3)
"RTN","LRAPPF1",44,0)
 I LR("PATH")]"" D
"RTN","LRAPPF1",45,0)
 .S LR("PATH")=$$EXTERNAL^DILFD(LRSF,.02,"",LR("PATH"),LR("PATH"))
"RTN","LRAPPF1",46,0)
 S:N="" N="?" S:'H(2) H(2)="?"
"RTN","LRAPPF1",47,0)
 I LRSF515 D:$Y>(IOSL-13) F^LRAPF,^LRAPF
"RTN","LRAPPF1",48,0)
 I 'LRSF515 D:$Y>(IOSL-4) H1
"RTN","LRAPPF1",49,0)
 Q:LR("Q")
"RTN","LRAPPF1",50,0)
 W !?2,"Organ/tissue:",?17,"Date rec'd: ",LRH(3),?43,"Acc #:",N
"RTN","LRAPPF1",51,0)
 W ?64,$E(LR("PATH"),1,12)
"RTN","LRAPPF1",52,0)
 I 'N(11) W !?5,"Report not verified." Q
"RTN","LRAPPF1",53,0)
 ;SNOMED codes
"RTN","LRAPPF1",54,0)
 I '+$G(LR("SPSM")) D  Q:LR("Q")
"RTN","LRAPPF1",55,0)
 .S O=0 F  S O=$O(^LR(LRDFN,S,LRI,2,O)) Q:'O!(LR("Q"))  D
"RTN","LRAPPF1",56,0)
 ..D:$Y>(IOSL-4) H2
"RTN","LRAPPF1",57,0)
 ..Q:LR("Q")
"RTN","LRAPPF1",58,0)
 ..S X=^LR(LRDFN,S,LRI,2,O,0),W(3)=$P(X,"^",3)
"RTN","LRAPPF1",59,0)
 ..S O(6)=$P(^LAB(61,+X,0),"^")
"RTN","LRAPPF1",60,0)
 ..W !?5,O(6) W:W(3) " ",W(3)," gm" D L
"RTN","LRAPPF1",61,0)
 ;Comments
"RTN","LRAPPF1",62,0)
 I $D(LRQ(3)) D
"RTN","LRAPPF1",63,0)
 .S B=0 F  S B=$O(^LR(LRDFN,S,LRI,99,B)) Q:'B!(LR("Q"))  D
"RTN","LRAPPF1",64,0)
 ..W !?5,$E(^LR(LRDFN,S,LRI,99,B,0),1,74)
"RTN","LRAPPF1",65,0)
 ..I LRSF515 D:$Y>(IOSL-13) F^LRAPF,^LRAPF
"RTN","LRAPPF1",66,0)
 Q
"RTN","LRAPPF1",67,0)
L S B=0 F  S B=$O(^LR(LRDFN,S,LRI,2,O,3,B)) Q:'B!(LR("Q"))  D
"RTN","LRAPPF1",68,0)
 .S B(1)=+^LR(LRDFN,S,LRI,2,O,3,B,0)
"RTN","LRAPPF1",69,0)
 .D:$Y>(IOSL-4) H3 Q:LR("Q")
"RTN","LRAPPF1",70,0)
 .W !?10,$P(^LAB(61.3,B(1),0),"^")
"RTN","LRAPPF1",71,0)
 S B=0 F  S B=$O(^LR(LRDFN,S,LRI,2,O,4,B)) Q:'B!(LR("Q"))  D
"RTN","LRAPPF1",72,0)
 .S X=^LR(LRDFN,S,LRI,2,O,4,B,0),B(1)=+X,B(2)=$P(X,"^",2)
"RTN","LRAPPF1",73,0)
 .D:$Y>(IOSL-4) H3 Q:LR("Q")
"RTN","LRAPPF1",74,0)
 .W !?10,$P(^LAB(61.5,B(1),0),"^")
"RTN","LRAPPF1",75,0)
 .W:B(2)]"" " (",$S(B(2)=0:"Negative",B(2)=1:"Positive",1:"?"),")"
"RTN","LRAPPF1",76,0)
 S B=0 F  S B=$O(^LR(LRDFN,S,LRI,2,O,1,B)) Q:'B!(LR("Q"))  D
"RTN","LRAPPF1",77,0)
 .S B(1)=+^LR(LRDFN,S,LRI,2,O,1,B,0)
"RTN","LRAPPF1",78,0)
 .D:$Y>(IOSL-4) H3 Q:LR("Q")
"RTN","LRAPPF1",79,0)
 .W !?10,$P(^LAB(61.4,B(1),0),"^")
"RTN","LRAPPF1",80,0)
 S M=0 F  S M=$O(^LR(LRDFN,S,LRI,2,O,2,M)) Q:'M!(LR("Q"))  D
"RTN","LRAPPF1",81,0)
 .S M(1)=+^LR(LRDFN,S,LRI,2,O,2,M,0)
"RTN","LRAPPF1",82,0)
 .D:$Y>(IOSL-4) H3 Q:LR("Q")
"RTN","LRAPPF1",83,0)
 .W !?10,$P(^LAB(61.1,M(1),0),"^") D E
"RTN","LRAPPF1",84,0)
 S E=0 F  S E=$O(^LR(LRDFN,S,LRI,2,O,5,E)) Q:'E!(LR("Q"))  D
"RTN","LRAPPF1",85,0)
 .S E(1)=^LR(LRDFN,S,LRI,2,O,5,E,0) D A
"RTN","LRAPPF1",86,0)
 Q
"RTN","LRAPPF1",87,0)
A S Y=$P(E(1),"^",2),E(3)=$P(E(1),"^",3),E(4)=$P(E(1),"^")_":"
"RTN","LRAPPF1",88,0)
 S E(4)=$P($P(LR(S),E(4),2),";") D D^LRU S E(2)=Y D D^LRU
"RTN","LRAPPF1",89,0)
 D:$Y>(IOSL-12) H3 Q:LR("Q")
"RTN","LRAPPF1",90,0)
 W !?5,E(4)," ",E(3)," Date: ",E(2)
"RTN","LRAPPF1",91,0)
 Q
"RTN","LRAPPF1",92,0)
 ;
"RTN","LRAPPF1",93,0)
E S E=0 F  S E=$O(^LR(LRDFN,S,LRI,2,O,2,M,1,E)) Q:'E!(LR("Q"))  D
"RTN","LRAPPF1",94,0)
 .W !?12,$P(^LAB(61.2,+^LR(LRDFN,S,LRI,2,O,2,M,1,E,0),0),"^")
"RTN","LRAPPF1",95,0)
 Q
"RTN","LRAPPF1",96,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRAPPF1",97,0)
 Q:$A(IOST)'=80  I $D(LRQ(2)) D H^LRSPT Q
"RTN","LRAPPF1",98,0)
 I $D(LRQ(9)) D H^LRAPT1 Q
"RTN","LRAPPF1",99,0)
 D F^LRU W !,LRO(68)," "
"RTN","LRAPPF1",100,0)
 W:F(2)'="^DPT(" !,"Demographic data in ",F(1)," file."
"RTN","LRAPPF1",101,0)
 W !,"Entries listed by PATIENT (From: ",LRSTR," to: ",LRLST,")"
"RTN","LRAPPF1",102,0)
 W !,"Name",?31,"Identifier"
"RTN","LRAPPF1",103,0)
 W !,LR("%")
"RTN","LRAPPF1",104,0)
 Q
"RTN","LRAPPF1",105,0)
H1 Q:$A(IOST)'=80
"RTN","LRAPPF1",106,0)
 D H W:'$D(LRQ(9)) !,LRP,?30,SSN,?42,DOB
"RTN","LRAPPF1",107,0)
 Q
"RTN","LRAPPF1",108,0)
H2 Q:$A(IOST)'=80  D H1
"RTN","LRAPPF1",109,0)
 W !?5,"Organ/tissue:",?25,"Date received: ",LRH(3),?51,"Acc #:",N
"RTN","LRAPPF1",110,0)
 Q
"RTN","LRAPPF1",111,0)
H3 Q:$A(IOST)'=80  D H2
"RTN","LRAPPF1",112,0)
 W !?5,O(6) W:W(3) " ",W(3)," gm"
"RTN","LRAPPF1",113,0)
 Q
"RTN","LRAPSM")
0^7^B14074767^B14446711
"RTN","LRAPSM",1,0)
LRAPSM ;AVAMC/REG - SNOMED SEARCH ;8/14/95  09:49
"RTN","LRAPSM",2,0)
 ;;5.2;LAB SERVICE;**72,253,355,362**;Sep 27, 1994;Build 11
"RTN","LRAPSM",3,0)
 S IOP="HOME" D ^%ZIS W @IOF,!?20,LRO(68)," search by ",S(7)," code"
"RTN","LRAPSM",4,0)
 S (LR,LR(1),LR(2),LR(3))=0
"RTN","LRAPSM",5,0)
TP K A("B") W !!,"TOPOGRAPHY (Organ/Tissue)",!?5,"Select 1 or more characters of the code",!?5 R "For all sites type 'ALL' : ",X:DTIME Q:X=""!(X[U)  I X["ALL" S S(2)="ALL"
"RTN","LRAPSM",6,0)
 E  D CK^LRAUSM G:$D(A("B")) TP S S(2)=X,S(1)=$L(X)
"RTN","LRAPSM",7,0)
 K LRN,LRM S (LRO,LRN)="" W !!,S(7) I LRSN=61.5 D POS Q:'$D(LRO)
"RTN","LRAPSM",8,0)
 W !?5,"For all choices type 'ALL'" F B=1:1 D ASK Q:X[U!(X="")!(LRN="ALL")
"RTN","LRAPSM",9,0)
 Q:B<2&(LRN="")  S:LRN=""&(B=2) LRN=$O(LRN(0)) W ! D B^LRU Q:Y<0  S LRSDT=LRSDT-.01,LRLDT=LRLDT+.99
"RTN","LRAPSM",10,0)
 S ZTRTN="QUE^LRAPSM" D BEG^LRUTL Q:POP!($D(ZTSK))
"RTN","LRAPSM",11,0)
QUE U IO K ^TMP($J) D L^LRU,S^LRU,XR^LRU
"RTN","LRAPSM",12,0)
 S ^TMP($J,0)=S(2)_U_LRN_U_LRO(68)_U_S(7)
"RTN","LRAPSM",13,0)
 F X=0:0 S LRSDT=$O(^LR(LRXR,LRSDT)) Q:'LRSDT!(LRSDT>LRLDT)  D LRDFN
"RTN","LRAPSM",14,0)
END D ^LRAPSM1,END^LRUTL,V^LRU Q
"RTN","LRAPSM",15,0)
Y I $E(X,1,Y(1))=Y(2) S I=1 Q
"RTN","LRAPSM",16,0)
Y1 S I=1 F I(1)=1:1:Y(1) S I(2)=$E(Y(2),I(1)) I I(2)'="*",I(2)'=$E(X,I(1)) S I=0 Q
"RTN","LRAPSM",17,0)
 Q
"RTN","LRAPSM",18,0)
LRDFN S LRDFN=0 F  S LRDFN=$O(^LR(LRXR,LRSDT,LRDFN)) Q:'LRDFN  S LR(2)=LR(2)+1 D I
"RTN","LRAPSM",19,0)
 Q
"RTN","LRAPSM",20,0)
I F LRI=0:0 S LRI=$O(^LR(LRXR,LRSDT,LRDFN,LRI)) Q:'LRI  D T
"RTN","LRAPSM",21,0)
 Q
"RTN","LRAPSM",22,0)
T Q:$P($P($G(^LR(LRDFN,LRSS,LRI,0)),U,6)," ")'=LRABV
"RTN","LRAPSM",23,0)
 S LR(4)=^LR(LRDFN,LRSS,LRI,0),LR(12)=$P(LR(4),"^",10)
"RTN","LRAPSM",24,0)
 S H(2)=$E(LR(12),1,3),LRAC=$P(LR(4),"^",6),LRAN=+$P(LRAC," ",3)
"RTN","LRAPSM",25,0)
 S LR(3)=LR(3)+1
"RTN","LRAPSM",26,0)
 S T=0 F LR(9)=0:1 S T=$O(^LR(LRDFN,LRSS,LRI,2,T)) Q:'T  S LR(7)=+^(T,0) D TG
"RTN","LRAPSM",27,0)
 S LR=LR+LR(9) Q  ;Number of organ/tissues
"RTN","LRAPSM",28,0)
TG Q:'$D(^LAB(61,LR(7),0))  S LR(11)=^(0),LR(5)=$P(LR(11),"^"),LR(11)=$P(LR(11),"^",2) I S(2)'="ALL",$E(LR(11),1,S(1))'=S(2) Q:S(2)'["*"  S Y(1)=S(1),X=LR(11),Y(2)=S(2) D Y1 Q:'I
"RTN","LRAPSM",29,0)
 S LR(1)=LR(1)+1 D M Q  ;Total of the organ/tissue searched for
"RTN","LRAPSM",30,0)
M F M=0:0 S M=$O(^LR(LRDFN,LRSS,LRI,2,T,V,M)) Q:'M  S X=^(M,0),LR(8)=+X,LRM=$P(X,"^",2) D @($S(LRSN'=61.2:"MX",1:"E"))
"RTN","LRAPSM",31,0)
 Q
"RTN","LRAPSM",32,0)
E F E=0:0 S E=$O(^LR(LRDFN,LRSS,LRI,2,T,V,M,1,E)) Q:'E  S LR(8)=+^(E,0) D MX
"RTN","LRAPSM",33,0)
 Q
"RTN","LRAPSM",34,0)
MX Q:'$D(^LAB(LRSN,LR(8),0))  S W=^(0) I $D(LRO),LRO]"",LRO'=LRM Q
"RTN","LRAPSM",35,0)
 I LRN="ALL" S:'$D(^TMP($J,H(2),LRAN,LR(7),0)) ^(0)=LR(5) S ^($S($P(W,"^",2)'="":$P(W,"^",2),1:"99999999"))=$P(W,"^")_"^"_LRM G PRT
"RTN","LRAPSM",36,0)
 S X=$P(W,"^",2),Y=0 F Z=1:1 S Y=$O(LRN(Y)) Q:Y=""  S Y(1)=LRM(Y),Y(2)=LRN(Y) D Y I I S:'$D(^TMP($J,H(2),LRAN,LR(7),0)) ^(0)=LR(5) S ^(X)=$P(W,"^")_"^"_LRM
"RTN","LRAPSM",37,0)
 Q:'$D(^TMP($J,H(2),LRAN))
"RTN","LRAPSM",38,0)
PRT S X=^LR(LRDFN,0),(LRDPF,LR(14))=$P(X,"^",2),LRPF=^DIC(LR(14),0,"GL"),DFN=$P(X,"^",3) Q:'$D(@(LRPF_DFN_",0)"))
"RTN","LRAPSM",39,0)
 S X=@(LRPF_DFN_",0)"),LRP=$P(X,"^"),SSN=$P(X,"^",9),SEX=$P(X,"^",2),DOB=$P(X,"^",3),X1=$P(LR(4),"^"),X2=DOB D ^%DTC,SSN^LRU S AGE=X\365.25
"RTN","LRAPSM",40,0)
 S:AGE>130 AGE="?"
"RTN","LRAPSM",41,0)
 S ^TMP($J,H(2),LRAN)=LRAC_"^"_AGE_"^"_SEX_"^"_LRP_"^"_SSN(1)_"^"_+$E(LR(12),4,5)_"/"_$E(LR(12),6,7)_"^"_LR(14)
"RTN","LRAPSM",42,0)
 S ^TMP($J,"B",LRP,H(2),LRAN)=""
"RTN","LRAPSM",43,0)
 Q
"RTN","LRAPSM",44,0)
ASK K A("B") W !,"Choice #",$J(B,2),": Select 1 or more characters of the code: " R X:DTIME Q:X=""!(X[U)  I X["ALL" S LRN="ALL" Q
"RTN","LRAPSM",45,0)
 D CK^LRAUSM G:$D(A("B")) ASK S LRN(X)=X,LRM(X)=$L(X) Q
"RTN","LRAPSM",46,0)
POS ;also from LRAPSEM
"RTN","LRAPSM",47,0)
 W !,"Select only procedures with results " S %=2 D YN^LRU I %<1 K LRO Q
"RTN","LRAPSM",48,0)
 I %=2 S LRO="" Q
"RTN","LRAPSM",49,0)
C W !,"Enter 1 for positive results or 0 for negative results: " R X:DTIME Q:X=""!(X[U)  I X'=1,X'=0 W $C(7)," Enter '1' or '0'" G C
"RTN","LRAPSM",50,0)
 S LRO=X Q
"RTN","LRCAPFDS")
0^6^B18264991^B18005315
"RTN","LRCAPFDS",1,0)
LRCAPFDS ;DALOI/FHS - EDIT ACTIVATED WKLD CODES BY WKLD LAB SECTION ;5/1/99
"RTN","LRCAPFDS",2,0)
 ;;5.2;LAB SERVICE;**105,119,127,163,274,362**;Sep 27, 1994;Build 11
"RTN","LRCAPFDS",3,0)
EN ;
"RTN","LRCAPFDS",4,0)
 K ^TMP("LRLAM",DUZ_$J),DIR W !
"RTN","LRCAPFDS",5,0)
 S DIR("?")="Select any individual WKLD CODE then edit all fields"
"RTN","LRCAPFDS",6,0)
 S DIR("A")="Do you want to edit specific WKLD CODES/ALL fields? "
"RTN","LRCAPFDS",7,0)
 S DIR(0)="Y",DIR("B")="N" D ^DIR G:$D(DIRUT) END
"RTN","LRCAPFDS",8,0)
 I Y=1 D  G END
"RTN","LRCAPFDS",9,0)
 . F  W ! K DIC S DIC=64,DIC(0)="AQEZNM" D ^DIC Q:Y<1  D
"RTN","LRCAPFDS",10,0)
 . . N DA,DIE,DR
"RTN","LRCAPFDS",11,0)
 . . S DA=+Y,DR="[LR WKLD EDIT ALL]",DIE="^LAM(" D ^DIE
"RTN","LRCAPFDS",12,0)
 I '$O(^LAM("AC",1,0)) W !?5,"You have no Activated WKLD CODES ",! G END
"RTN","LRCAPFDS",13,0)
 W !?5,"This option will allow you to Edit or Print WKLD CODES"
"RTN","LRCAPFDS",14,0)
 K DIR,LRSECT S DIR("A")="Do you want to select a specific WKLD CODE LAB SECTION"
"RTN","LRCAPFDS",15,0)
 S DIR(0)="Y",DIR("B")="Y" D ^DIR G:$D(DIRUT) END
"RTN","LRCAPFDS",16,0)
 I Y K DIC,DIR S DIC=64.21,DIC(0)="AEQZNM" D ^DIC G:Y<1 END S LRSECT=+Y
"RTN","LRCAPFDS",17,0)
 K DIR,DIC S DIR(0)="S^E:EDIT;P:PRINT",DIR("A")="Would you like to"
"RTN","LRCAPFDS",18,0)
 D ^DIR G END:$D(DIRUT) G:Y="P" PRINT
"RTN","LRCAPFDS",19,0)
EDIT ;
"RTN","LRCAPFDS",20,0)
 W !,"EDITING",! K DIR
"RTN","LRCAPFDS",21,0)
 S DIR(0)="S,O^1:ALL;.02:DESCRIPT;4:BILLABLE PROCEDURE;7:COST;8:PRICE;9:SORTING GROUP;13:WKLD CODE LAB SECTION;14:DSS Feeder;18:CODE;19:SYNONYM;20:SPECIMEN;21:LOCAL ACC AREA;26:ES DISPLAY ORDER"
"RTN","LRCAPFDS",22,0)
 S DIR("A")="Select a field you want to edit ",LRDR=""
"RTN","LRCAPFDS",23,0)
ASK D ^DIR G:X=U END I Y=1 S LRDR="[LR WKLD EDIT ALL]" D LRSET G ALL
"RTN","LRCAPFDS",24,0)
 I Y S LRDR=LRDR_Y_";" S DIR("A")="Select Another Field " G ASK
"RTN","LRCAPFDS",25,0)
 I '$L(LRDR) W !?5,"Nothing Selected ",! G END
"RTN","LRCAPFDS",26,0)
 S LRDR=$E(LRDR,1,($L(LRDR)-1))
"RTN","LRCAPFDS",27,0)
 D LRSET
"RTN","LRCAPFDS",28,0)
ALL I '$D(^TMP("LRLAM",DUZ_$J)) W !!,$$CJ^XLFSTR(" Database scan was negative.",80),!,$$CJ^XLFSTR(" No WKLD CODES assigned to WKLD CODE LAB SECTION you selected.",80),$C(7),! G END
"RTN","LRCAPFDS",29,0)
 K DIR S DIR(0)="F^1:60",DIR("A")="Start with what WKLD CODE name",DIR("A",2)="Use mixed case Characters e.g Chloride "
"RTN","LRCAPFDS",30,0)
 S DIR("A",1)=""
"RTN","LRCAPFDS",31,0)
 D ^DIR G:$D(DIRUT) END
"RTN","LRCAPFDS",32,0)
 S LRWKLD=X W !,"STARTING LOOP ",!
"RTN","LRCAPFDS",33,0)
LOOP ;
"RTN","LRCAPFDS",34,0)
 S LRWKLD=$O(^TMP("LRLAM",DUZ_$J,$E(LRWKLD,1,$L(LRWKLD)-1))),LRNN=DUZ_$J
"RTN","LRCAPFDS",35,0)
 I LRWKLD="" W !!?5,"Nothing matches your criteria",! G END
"RTN","LRCAPFDS",36,0)
 S LRNODE="^TMP(""LRLAM"","_DUZ_$J_","""_LRWKLD_""",0)",LREND=0 W @IOF
"RTN","LRCAPFDS",37,0)
 F  S LRNODE=$Q(@LRNODE) Q:$QS(LRNODE,2)'=LRNN!($G(LREND))  S DA=+$QS(LRNODE,4) I DA D
"RTN","LRCAPFDS",38,0)
 . D DIQ S:$G(DIRUT) LREND=1 Q:LREND=1  S S=0,DR=LRDR,DIE=64 D ^DIE S:$D(Y)!(X="^") LREND=1
"RTN","LRCAPFDS",39,0)
 G END
"RTN","LRCAPFDS",40,0)
 Q
"RTN","LRCAPFDS",41,0)
PRINT ;
"RTN","LRCAPFDS",42,0)
 K DIR S DIR(0)="Y",DIR("B")="Y",DIR("A")="Would you like only CPT linked WKLD CODES" D ^DIR G:$D(DIRUT) END
"RTN","LRCAPFDS",43,0)
 S LRCPT=Y
"RTN","LRCAPFDS",44,0)
 W !,"PRINT",! K %ZIS S %ZIS="QN" D ^%ZIS G:POP END
"RTN","LRCAPFDS",45,0)
 I IO'=IO(0) D  D ^%ZISC G END
"RTN","LRCAPFDS",46,0)
 . S:$G(LRSECT) ZTSAVE("LRSECT")="" S ZTRTN="DQ^LRCAPFDS",ZTSAVE("LRCPT")="",ZTIO=ION
"RTN","LRCAPFDS",47,0)
 . K ZTSK D ^%ZTLOAD W:$G(ZTSK) !?5,"Report Queued to "_ION I '$G(ZTSK) W !!?10,"**** Report Not Queued ****",!
"RTN","LRCAPFDS",48,0)
DQ ;
"RTN","LRCAPFDS",49,0)
 S:$D(ZTQUEUED) ZTREQ="@" D LRSET
"RTN","LRCAPFDS",50,0)
 I '$D(^TMP("LRLAM",DUZ_$J)) W !!?10," Database scan was negative.",!," No WKLD CODES assigned to WKLD CODE LAB SECTION you selected.",! G END
"RTN","LRCAPFDS",51,0)
 S S=5,LRNODE="^TMP(""LRLAM"","_DUZ_$J_",0)",DIC="^LAM(",DR="0:99",LREND=0
"RTN","LRCAPFDS",52,0)
 K DIR S LRNN=DUZ_$J D HEAD
"RTN","LRCAPFDS",53,0)
 F  S LRNODE=$Q(@LRNODE) Q:$QS(LRNODE,2)'=LRNN!($G(LREND))  S DA=+$QS(LRNODE,4) I DA D
"RTN","LRCAPFDS",54,0)
 . D EN^LRDIQ S:$D(DIRUT) LREND=1 S S=S+2 S:$E(IOST,1,2)'="C-" S=0
"RTN","LRCAPFDS",55,0)
 Q
"RTN","LRCAPFDS",56,0)
END ;
"RTN","LRCAPFDS",57,0)
 W ! W:$E(IOST,1,2)="P-" @IOF D ^%ZISC
"RTN","LRCAPFDS",58,0)
 K DA,DIC,DIE,DIR,DR,DTOUT,DUOUT,DIRUT
"RTN","LRCAPFDS",59,0)
 K LRDAT,LREND,LRN,LRNN,LRNODE,LRSECT,LRTIT,LRWKLD,S
"RTN","LRCAPFDS",60,0)
 K X,Y,LRDR,ZTSK,%ZIS,DIRUT,LRCPT
"RTN","LRCAPFDS",61,0)
 Q
"RTN","LRCAPFDS",62,0)
HEAD ;
"RTN","LRCAPFDS",63,0)
 W !!,$$CJ^XLFSTR("Activated WKLD Codes",IOM),!
"RTN","LRCAPFDS",64,0)
 S LRTIT=" WKLD LAB SECTION [ "_$S($D(^LAB(64.21,+$G(LRSECT),0)):$P(^(0),U),1:"** ALL **")_" ]"
"RTN","LRCAPFDS",65,0)
 S LRDAT=$$HTE^XLFDT($H),S=6
"RTN","LRCAPFDS",66,0)
 W $$CJ^XLFSTR(LRTIT,IOM),!,$$CJ^XLFSTR(LRDAT,IOM),!
"RTN","LRCAPFDS",67,0)
 Q
"RTN","LRCAPFDS",68,0)
DIQ ;
"RTN","LRCAPFDS",69,0)
 Q:'$G(DA)  W ! S DIC="^LAM(",DR=0 D EN^LRDIQ
"RTN","LRCAPFDS",70,0)
 Q
"RTN","LRCAPFDS",71,0)
LRSET ;
"RTN","LRCAPFDS",72,0)
 S LRN=0 F  S LRN=$O(^LAM(LRN)) Q:LRN<1  I $D(^LAM(LRN,0))#2 S LRNODE=^(0) D
"RTN","LRCAPFDS",73,0)
 . I $G(LRSECT),$P(LRNODE,U,15)'=LRSECT Q
"RTN","LRCAPFDS",74,0)
 . I $G(LRCPT),'$O(^LAM(LRN,4,0)) Q
"RTN","LRCAPFDS",75,0)
 . S ^TMP("LRLAM",DUZ_$J,$P(LRNODE,U),LRN)=$P(LRNODE,U,2)
"RTN","LRCAPFDS",76,0)
 Q
"RTN","LREXECU")
0^4^B6083878^B4005910
"RTN","LREXECU",1,0)
LREXECU ;SLC/RWF - EXECUTE CODE UTILITY ;8/11/97
"RTN","LREXECU",2,0)
 ;;5.2;LAB SERVICE;**121,200,362**;Sep 27, 1994;Build 11
"RTN","LREXECU",3,0)
TDM ;DRUG MONITORING
"RTN","LREXECU",4,0)
 N DIR,DTOUT,DUOUT,DIRUT
"RTN","LREXECU",5,0)
 ;Set the DIR array for sample to be drawn question
"RTN","LREXECU",6,0)
 S DIR(0)="SO^P:Peak;T:Trough;M:Mid;U:Unknown"
"RTN","LREXECU",7,0)
 S DIR("A")="Please select"
"RTN","LREXECU",8,0)
 S DIR("L",1)="Will (is) the sample to be drawn at"
"RTN","LREXECU",9,0)
 S DIR("L")=" Peak, Trough, Mid, or Unknown"
"RTN","LREXECU",10,0)
 S DIR("T")=60
"RTN","LREXECU",11,0)
 S DIR("?",1)="Enter a 'P', 'T', 'M', 'U', or hit the Enter Key."
"RTN","LREXECU",12,0)
 S DIR("?",2)="Hitting the Enter key will default to Unknown "
"RTN","LREXECU",13,0)
 S DIR("?")="Entering ""^"" or a timeout will cancel the order."
"RTN","LREXECU",14,0)
 D ^DIR K DIR  ;Prompt for user selection
"RTN","LREXECU",15,0)
 ;Process user selection
"RTN","LREXECU",16,0)
 I $D(DUOUT)!($D(DTOUT)) W !!!,$C(7),"ORDER CANCELED" S LRKIL=1 Q
"RTN","LREXECU",17,0)
 I Y="" S Y(0)="Unknown" W !!!,$C(7),"Defaulted to Unknown"
"RTN","LREXECU",18,0)
 E  W !!!,$C(7),Y(0)_" has been selected."
"RTN","LREXECU",19,0)
 S LRCCOM="~Dose is expected to be at "_Y(0)_" level."
"RTN","LREXECU",20,0)
 I $$VER^LR7OU1>2.5 D TCOM^LRORD2(+LRTEST(LRTSTN),LRCCOM)
"RTN","LREXECU",21,0)
 I $$VER^LR7OU1<3 D RCS^LRXO9 I '$D(ORACTION) D TCOM^LRORD2(+LRTEST(LRTSTN),LRCCOM) ;OE/RR 2.5
"RTN","LREXECU",22,0)
 ;Set DIR array for additional comment question
"RTN","LREXECU",23,0)
 S DIR(0)="FO^1:250"
"RTN","LREXECU",24,0)
 S DIR("A")="ADDITIONAL COMMENT"
"RTN","LREXECU",25,0)
 S DIR("T")=60
"RTN","LREXECU",26,0)
 S DIR("?")="This is a free text field, up to 250 characters in length."
"RTN","LREXECU",27,0)
 D ^DIR K DIR
"RTN","LREXECU",28,0)
 I $D(DUOUT)!($D(DTOUT)) S Y=""
"RTN","LREXECU",29,0)
 S LRCCOM=Y
"RTN","LREXECU",30,0)
 Q
"RTN","LREXECU",31,0)
DOSE ;DOSE/DRAW TIMES
"RTN","LREXECU",32,0)
EN ;
"RTN","LREXECU",33,0)
 S %DT("A")="Enter the last dose time: ",%DT="AT" D ^%DT S LRDOSE=Y
"RTN","LREXECU",34,0)
 I Y<1 W !,"Time unknown" S %=2 D YN^DICN S:%=1 LRDOSE="UNKNOWN" G:%'=1 EN
"RTN","LREXECU",35,0)
 I Y>1,Y'["." W !,"You must enter a time, e.g.  T@6AM" G EN
"RTN","LREXECU",36,0)
 I LRDOSE["." S Y=LRDOSE D DD^LRX S LRDOSE=Y
"RTN","LREXECU",37,0)
DRAW W ! S %DT("A")="Enter draw time: ",%DT="AT" D ^%DT S LRDRAW=Y
"RTN","LREXECU",38,0)
 I Y<1 W !,"Time unknown" S %=2 D YN^DICN S:%=1 LRDRAW="UNKNOWN" G:%'=1 DRAW
"RTN","LREXECU",39,0)
 I Y>1,Y'["." W !,"You must enter a time, e.g.  T@6AM" G DRAW
"RTN","LREXECU",40,0)
 I LRDRAW["." S Y=LRDRAW D DD^LRX S LRDRAW=Y
"RTN","LREXECU",41,0)
 S LRCCOM="~Last dose: "_LRDOSE_"   draw time: "_LRDRAW W !,LRCCOM
"RTN","LREXECU",42,0)
 W !,"OK" S %=1 D YN^DICN G EN:%'=1
"RTN","LREXECU",43,0)
 K LRDOSE,LRDRAW,%DT Q
"RTN","LRORDST")
0^5^B30766466^B30181718
"RTN","LRORDST",1,0)
LRORDST ;SLC/CJS/WTY - SET THE ORDER AND ACCESSION ;5/16/05
"RTN","LRORDST",2,0)
 ;;5.2;LAB SERVICE;**100,107,121,153,202,290,291,359,362**;Sep 27, 1994;Build 11
"RTN","LRORDST",3,0)
 ;Called to create orders and accessions from local LROT array
"RTN","LRORDST",4,0)
 D DT
"RTN","LRORDST",5,0)
 K ZTSK
"RTN","LRORDST",6,0)
 I $P(LRPARAM,U,4),'$D(LRNOLABL),'$D(LRTJ),LRORDR="" D ^LRLABLIO
"RTN","LRORDST",7,0)
 F LRSAMP=-1:0 S LRSAMP=$O(LROT(LRSAMP)) Q:LRSAMP=""  F LRSPEC=-1:0 S LRSPEC=$O(LROT(LRSAMP,LRSPEC)) Q:LRSPEC=""  D ZX
"RTN","LRORDST",8,0)
 ;
"RTN","LRORDST",9,0)
 I $D(LRLABLIO),$D(LRLBL) D
"RTN","LRORDST",10,0)
 . S ZTRTN="ENT^LRLABLD",ZTDESC="LAB LABELS",ZTDTH=$H
"RTN","LRORDST",11,0)
 . S ZTIO=LRLABLIO,ZTSAVE("LRLBL(")=""
"RTN","LRORDST",12,0)
 . D ^%ZTLOAD K LRLBL
"RTN","LRORDST",13,0)
 ;
"RTN","LRORDST",14,0)
 I $D(LRSLIP) F I1=0:0 S I1=$O(LROT(I1)) Q:I1<1  F I2=-1:0 S I2=$O(LROT(I1,I2)) Q:I2=""  S LRSN=LROT(I1,I2,"SN") D WCP
"RTN","LRORDST",15,0)
 K LRLBL,ZTSK
"RTN","LRORDST",16,0)
 ;Clean-up CIDC variables
"RTN","LRORDST",17,0)
 K LRBEX,LRBEY,LRBEAR,LRBERF
"RTN","LRORDST",18,0)
 Q
"RTN","LRORDST",19,0)
 ;
"RTN","LRORDST",20,0)
 ;
"RTN","LRORDST",21,0)
ZX K:$G(LRORDR)'="P" LRCOM,LRTCOM
"RTN","LRORDST",22,0)
 N I,COMB,LRCPRS
"RTN","LRORDST",23,0)
 I $D(LRGCOM) S LRCCOM=LRGCOM D RCS^LRORD2
"RTN","LRORDST",24,0)
 S LRSXN=0,I=0
"RTN","LRORDST",25,0)
 F  S I=$O(LROT(LRSAMP,LRSPEC,I)) Q:I<1  S LRSXN=LRSXN+1
"RTN","LRORDST",26,0)
 L +^LRO(69,LRODT,1)
"RTN","LRORDST",27,0)
 S LRSN=1+$P($G(^LRO(69,LRODT,1,0)),U,3)
"RTN","LRORDST",28,0)
 S LRSUM=1+$P($G(^LRO(69,LRODT,1,0)),U,4)
"RTN","LRORDST",29,0)
ZSN N I
"RTN","LRORDST",30,0)
 F  Q:'$D(^LRO(69,LRODT,1,LRSN,0))  S LRSN=LRSN+1
"RTN","LRORDST",31,0)
 S ^LRO(69,LRODT,1,LRSN,0)=LRDFN_"^"_DUZ_"^"_(+LRSAMP)_"^"_$S($L($G(LRLWC)):LRLWC,$L(LRORDR):LRORDR,1:"SP")_"^"_LRNT_"^"_LRPRAC_"^"_LRLLOC_"^"_LRODT_$S(+LRORDTIM:"."_LRORDTIM,1:"")_"^"_LROLLOC_"^^"_$G(LRORIFN)
"RTN","LRORDST",32,0)
 S ^LRO(69,LRODT,1,LRSN,2,0)="^69.03PA^"_LRSXN_U_LRSXN
"RTN","LRORDST",33,0)
 S ^LRO(69,LRODT,1,0)="^69.01PA^"_LRSN_U_LRSUM
"RTN","LRORDST",34,0)
 L -^LRO(69,LRODT,1)
"RTN","LRORDST",35,0)
 S ^LRO(69,LRODT,1,"AA",LRDFN,LRSN)=""
"RTN","LRORDST",36,0)
 S ^LRO(69,LRODT,1,"AC",LRLLOC,LRSN)=""
"RTN","LRORDST",37,0)
 S LROT(LRSAMP,LRSPEC,"SN")=LRSN
"RTN","LRORDST",38,0)
 S ^LRO(69,"D",LRDFN,LRODT,LRSN)=""
"RTN","LRORDST",39,0)
 S COMB=$P($G(^LRO(69,LRODT,1,LRSN,1)),"^",7)
"RTN","LRORDST",40,0)
 I $S($G(LRORDR)="":1,$G(LRORDR)="P":1,1:0) D
"RTN","LRORDST",41,0)
 . S $P(^LRO(69,LRODT,1,LRSN,1),"^")=$P(LRCDT,"^")
"RTN","LRORDST",42,0)
 . S $P(^LRO(69,LRODT,1,LRSN,1),"^",2)=$P(LRCDT,"^",2)
"RTN","LRORDST",43,0)
 . S $P(^LRO(69,LRODT,1,LRSN,1),"^",4)="C"
"RTN","LRORDST",44,0)
 . S $P(^LRO(69,LRODT,1,LRSN,1),"^",8)=DUZ(2)
"RTN","LRORDST",45,0)
 . ;S ^LRO(69,LRODT,1,LRSN,1)=LRCDT_"^^C^^^"_COMB_"^"_DUZ(2)
"RTN","LRORDST",46,0)
 . I $G(LRORDR)'="P" S ^LRO(69,"AA",+$G(LRORD),LRODT_"|"_LRSN)=""
"RTN","LRORDST",47,0)
 . ; PIECE 4 INDICATED COLLECTED (NOTE: LRCDT HAS 2 PIECES)
"RTN","LRORDST",48,0)
 I LRSPEC'="" S ^LRO(69,LRODT,1,LRSN,4,0)="^69.02PA^1^1",^(1,0)=LRSPEC
"RTN","LRORDST",49,0)
 S ^LRO(69,LRODT,1,LRSN,.1)=LRORD,^LRO(69,"C",+LRORD,LRODT,LRSN)="",LRJ=0
"RTN","LRORDST",50,0)
 F LRTN=1:1 S LRJ=$O(LROT(LRSAMP,LRSPEC,LRJ)) Q:LRJ<1  D ZSN1
"RTN","LRORDST",51,0)
 I $D(LRCOM(LRSAMP,LRSPEC)),LRCOM(LRSAMP,LRSPEC) D
"RTN","LRORDST",52,0)
 . N I
"RTN","LRORDST",53,0)
 . S X=LRCOM(LRSAMP,LRSPEC)
"RTN","LRORDST",54,0)
 . S ^LRO(69,LRODT,1,LRSN,6,0)="^69.04W^"_X_U_X
"RTN","LRORDST",55,0)
 . F I=1:1:X S ^LRO(69,LRODT,1,LRSN,6,I,0)=LRCOM(LRSAMP,LRSPEC,I)
"RTN","LRORDST",56,0)
 D NEW^LR7OB1(LRODT,LRSN,"SN",$G(LRNATURE),.LRCPRS)
"RTN","LRORDST",57,0)
 I LRORDR="LC"!(LRORDR="I") D
"RTN","LRORDST",58,0)
 . S ION=$P($G(^LAB(69.9,1,3.5,+DUZ(2),0)),U,2)
"RTN","LRORDST",59,0)
 . S:ION="" ION=$P($G(^LAB(69.9,1,3)),U,4)
"RTN","LRORDST",60,0)
 . I ION'="",(LRORDR="LC"!(LRORDR="I")) D ^LROW2P
"RTN","LRORDST",61,0)
 I LRORDR="I" S ION=$P($G(^LAB(69.9,1,7,DUZ(2),0)),U,3) I ION'="" D ^LROW2P
"RTN","LRORDST",62,0)
 I $S(LRORDR="":1,LRORDR="P":1,1:0) D ^LRWLST
"RTN","LRORDST",63,0)
 Q
"RTN","LRORDST",64,0)
 ;
"RTN","LRORDST",65,0)
ZSN1 ;
"RTN","LRORDST",66,0)
 N LRORIFN
"RTN","LRORDST",67,0)
 S LRTSTS=LROT(LRSAMP,LRSPEC,LRJ),LRCPRS(LRTSTS)=""
"RTN","LRORDST",68,0)
 S ^LRO(69,LRODT,1,LRSN,2,LRTN,0)=LRTSTS_"^"_$S($D(LROT(LRSAMP,LRSPEC,LRJ,1)):LROT(LRSAMP,LRSPEC,LRJ,1),1:LROUTINE)
"RTN","LRORDST",69,0)
 D:+LRDPF=2&($G(LRSS)'="BB")&('$$CHKINP^LRBEBA4(LRDFN,LRODT))  ;CIDC
"RTN","LRORDST",70,0)
 .D SACC^LRBEBA2(LRODT,LRSN,LRTN,LRSAMP,LRSPEC,LRTSTS,.LRBEX)
"RTN","LRORDST",71,0)
 I $G(LRORIFN) S $P(^LRO(69,LRODT,1,LRSN,2,LRTN,0),"^",7)=LRORIFN ;OE/RR 2.5
"RTN","LRORDST",72,0)
 S $P(^LRO(69,LRODT,1,LRSN,2,LRTN,0),"^",9,10)="IP^L"
"RTN","LRORDST",73,0)
 S ^LRO(69,LRODT,1,LRSN,2,"B",LRTSTS,LRTN)=""
"RTN","LRORDST",74,0)
 S ^LRO(69,"AT",LRDFN,LRTSTS,LRSPEC,LRODT)="",^(-LRODT)=""
"RTN","LRORDST",75,0)
 D RCOM:$D(LROT(LRSAMP,LRSPEC,LRJ,2))
"RTN","LRORDST",76,0)
 D:$O(LRTCOM(LRTSTS,0)) TCOM^LROW2A(LRTSTS)
"RTN","LRORDST",77,0)
 Q
"RTN","LRORDST",78,0)
 ;
"RTN","LRORDST",79,0)
 ;
"RTN","LRORDST",80,0)
RCOM ; Required comment
"RTN","LRORDST",81,0)
 N LRTSTN,LRTEST
"RTN","LRORDST",82,0)
 S LRTSTN=1,LRTEST(LRTSTN)=LRTSTS
"RTN","LRORDST",83,0)
 S LRCCOM="~For Test: "_$P(^LAB(60,LRTSTS,0),U)_"   "_$P(^LAB(62,LRSAMP,0),U) S:$P(^(0),U)'=$P(^LAB(61,LRSPEC,0),U) LRCCOM=LRCCOM_"   "_$P(^LAB(61,LRSPEC,0),U) I $S('$D(DUZ("AG")):1,"ARMYAFN"'[DUZ("AG"):1,1:0) W !,LRCCOM
"RTN","LRORDST",84,0)
 S LREXP=LROT(LRSAMP,LRSPEC,LRJ,2)
"RTN","LRORDST",85,0)
 D RCS^LRORD2,RCOM^LRORD2
"RTN","LRORDST",86,0)
 I $G(LRKIL) S DA(1)=LRODT,DA=LRSN,DIK="^LRO(69,"_DA(1)_",1," D ^DIK Q
"RTN","LRORDST",87,0)
 I LRCCOM="",$D(LRCOM(LRSAMP,LRSPEC)) S X=+LRCOM(LRSAMP,LRSPEC) I $D(LRCOM(LRSAMP,LRSPEC,X)),LRCOM(LRSAMP,LRSPEC,X)["~For Test:" K LRCOM(LRSAMP,LRSPEC,X) S LRCOM(LRSAMP,LRSPEC)=X-1
"RTN","LRORDST",88,0)
 Q
"RTN","LRORDST",89,0)
 ;
"RTN","LRORDST",90,0)
 ;
"RTN","LRORDST",91,0)
OLD ; to allow unchanged routines to still work, from LROE1, LRPHSET1
"RTN","LRORDST",92,0)
 N LRNT
"RTN","LRORDST",93,0)
 D DT,NOW^%DTC
"RTN","LRORDST",94,0)
 S LRNT=%
"RTN","LRORDST",95,0)
 I $P(LRPARAM,U,4),'$D(LRNOLABL),'$D(LRTJ) D ^LRLABLIO
"RTN","LRORDST",96,0)
 D ^LRWLST
"RTN","LRORDST",97,0)
 Q
"RTN","LRORDST",98,0)
 ;
"RTN","LRORDST",99,0)
 ;
"RTN","LRORDST",100,0)
WCP Q:$D(LRNCWL)
"RTN","LRORDST",101,0)
 S:$D(LRORDER) ION=LRORDER
"RTN","LRORDST",102,0)
 I '$D(LRORDER) K %ZIS S IOP="HOME",%ZIS="NQ" D ^%ZIS G:POP WCP1 S X=ION,DIC(0)="EQ",DIC=3.5 D ^DIC G:Y<1 WCP1 G:'$D(^%ZIS(1,+Y,99)) WCP1 G:'$L($P(^(99),U)) WCP1 S IOP=$P(^%ZIS(1,$P(^(99),U),0),U),%ZIS="NQ" D ^%ZIS G:POP WCP1 K %ZIS,IOP
"RTN","LRORDST",103,0)
WCP2 S LRORDER=ION
"RTN","LRORDST",104,0)
 I IO(0)=IO R !!,"Press RETURN to continue...",X:DTIME S IOP=LRORDER,%ZIS="" D ^%ZIS D ENT2^LROW2P Q
"RTN","LRORDST",105,0)
 I IO'=IO(0) D ^LROW2P Q
"RTN","LRORDST",106,0)
 Q
"RTN","LRORDST",107,0)
 ;
"RTN","LRORDST",108,0)
 ;
"RTN","LRORDST",109,0)
DT S DT=$$DT^XLFDT()
"RTN","LRORDST",110,0)
 Q
"RTN","LRORDST",111,0)
 ;
"RTN","LRORDST",112,0)
 ;
"RTN","LRORDST",113,0)
WCP1 S %ZIS="NQ",%ZIS("A")="ORDER COPY DEVICE:"
"RTN","LRORDST",114,0)
 D ^%ZIS
"RTN","LRORDST",115,0)
 Q:POP
"RTN","LRORDST",116,0)
 G WCP2
"RTN","LRORDST",117,0)
 ;
"RTN","LRORDST",118,0)
 ;
"RTN","LRORDST",119,0)
OR ;OE/RR 2.5
"RTN","LRORDST",120,0)
 Q  ;Following logic not required - 2.5 is obsolete version
"RTN","LRORDST",121,0)
 N LRORDR
"RTN","LRORDST",122,0)
 Q:$G(LRORDRR)="R"
"RTN","LRORDST",123,0)
 S LRY=$S($D(LROT(LRSAMP,LRSPEC,LRJ,1)):LROT(LRSAMP,LRSPEC,LRJ,1),1:LROUTINE),LRI=1,LRTEST(LRI)=LRTSTS_"^"_LRY,LRORDR=$S($L($G(LRLWC)):LRLWC,1:"")
"RTN","LRORDST",124,0)
 D SET^LROR
"RTN","LRORDST",125,0)
 Q
"RTN","LRUPS")
0^2^B8420333^B8370560
"RTN","LRUPS",1,0)
LRUPS ;AVAMC/REG/WTY - PATIENT SPEC LOOK-UP ;3/20/01
"RTN","LRUPS",2,0)
 ;;5.2;LAB SERVICE;**72,248,259,322,362**;Sep 27, 1994;Build 11
"RTN","LRUPS",3,0)
 ;Removed space between "No  data" at tag EN
"RTN","LRUPS",4,0)
 ;
"RTN","LRUPS",5,0)
GETP W ! K LRAN,DIC S X="",DFN=-1,DIC(0)="EQM",(LRX,LRDPF)="" D DPA^LRDPA
"RTN","LRUPS",6,0)
 I DFN=-1 S LRAN=-1 Q
"RTN","LRUPS",7,0)
I N LRAY
"RTN","LRUPS",8,0)
 I '$D(LRPFLG) N LRPFLG S LRPFLG=0
"RTN","LRUPS",9,0)
 I LRSS="AU" G AU
"RTN","LRUPS",10,0)
EN I '$D(^LR(LRDFN,LRSS))!($P($G(^LR(LRDFN,LRSS,0)),U,3)<1) W $C(7),!!,"No data for ",PNM G GETP
"RTN","LRUPS",11,0)
 S (LRI,LRLIDT,E)=0 S:'$D(LRABV) LRABV=0
"RTN","LRUPS",12,0)
 I "CYEMSP"'[LRSS W !!,"Count #",?10,"Accession #",?29,"Date",?45,"Site/specimen"
"RTN","LRUPS",13,0)
 E  W !!,"Specimen(s)",?30,"Count #",?40,"Accession #",?55,"Date Obtained"
"RTN","LRUPS",14,0)
 S C=0
"RTN","LRUPS",15,0)
 F  S LRI=$O(^LR(LRDFN,LRSS,LRI)) Q:'LRI!(E)  D
"RTN","LRUPS",16,0)
 .S X=$G(^LR(LRDFN,LRSS,LRI,0)) Q:X=""  S LRAC=$P(X,U,6)
"RTN","LRUPS",17,0)
 .I $P(LRAC," ")=LRABV!(LRABV=0) D WT:C#5=0 Q:E  D
"RTN","LRUPS",18,0)
 ..S LRAY=$P(LRAC," ",2)
"RTN","LRUPS",19,0)
 ..I LRPFLG,LRAY'=$E(LRAD,2,3) Q
"RTN","LRUPS",20,0)
 ..S C=C+1,LRAN=+$P(LRAC," ",3)
"RTN","LRUPS",21,0)
 ..S LRAN(C)=LRI_U_LRAN,LRLIDT=LRI
"RTN","LRUPS",22,0)
 ..S Y=$P(X,U),LRST=$P(X,U,5) D D^LRU,@($S("CYEMSP"[LRSS:"SP",1:"CY"))
"RTN","LRUPS",23,0)
 I 'C W !!,"No specimens entered for "_LRH(0) G GETP
"RTN","LRUPS",24,0)
 I C=1 S LRI=+LRAN(1),Y(0)=^LR(LRDFN,LRSS,LRI,0),LRTK=+Y(0) G L
"RTN","LRUPS",25,0)
ACC W !?11,"Choose Count #(1-",C,"): " R X:DTIME I X=""!(X[U) S LRAN=-1 Q
"RTN","LRUPS",26,0)
 I X'?1N.N W $C(7),!!,"Enter numbers only",!! G ACC
"RTN","LRUPS",27,0)
OK I '$D(LRAN(X)) W "  Doesn't exist for ",PNM G ACC
"RTN","LRUPS",28,0)
GOT S LRI=+LRAN(X),Y(0)=^LR(LRDFN,LRSS,LRI,0),LRTK=+Y(0)
"RTN","LRUPS",29,0)
L S LRAC=$P(Y(0),U,6),LRAN=+$P(LRAC," ",3),Y=$P(Y(0),U) D D^LRU W !!," Accession #: ",LRAC W:Y'[1700 " Date Obtained: ",Y,! S LRWW=$S(Y'[1700:Y,1:"")
"RTN","LRUPS",30,0)
 Q
"RTN","LRUPS",31,0)
WT I C>0 W !,"More accessions " S %=2 D YN^LRU S E=$S(%=1:0,1:1) Q
"RTN","LRUPS",32,0)
 Q
"RTN","LRUPS",33,0)
SP W !?30,"(",$J(C,2),")",?40,LRAC,?55,Y I '$P(X,"^",11) W " not verified"
"RTN","LRUPS",34,0)
 S LRST=0 F A=0:1 S LRST=$O(^LR(LRDFN,LRSS,LRI,.1,LRST)) Q:'LRST  W:$D(^(LRST,0)) !,$P(^(0),"^")
"RTN","LRUPS",35,0)
 Q
"RTN","LRUPS",36,0)
CY W !?2,"(",$J(C,2),")",?10,LRAC,?25,Y W:LRST ?45,$S($D(^LAB(61,LRST,0)):$E($P(^(0),U),1,34),1:"") Q
"RTN","LRUPS",37,0)
AU S LRND=$G(^LR(LRDFN,"AU"))
"RTN","LRUPS",38,0)
 I '$L(LRND) W $C(7),!!,"No autopsy entry for ",LRP,!! S LRAN="?" Q
"RTN","LRUPS",39,0)
 S LRAC=$P(LRND,U,6)
"RTN","LRUPS",40,0)
 I $P(LRAC," ")'=LRABV W $C(7),!!,"No autopsy accession" S LRAN="?" Q
"RTN","LRUPS",41,0)
 S LRAY=$P(LRAC," ",2)
"RTN","LRUPS",42,0)
 I LRPFLG,LRAY'=$E(LRAD,2,3) D  Q
"RTN","LRUPS",43,0)
 .W $C(7),!!,"No autopsy accession for "_LRH(0) S LRAN="?"
"RTN","LRUPS",44,0)
 S LRAN=+$P(LRAC," ",3)
"RTN","LRUPS",45,0)
 I 'LRAN S LRAN=-1 W $C(7),!!,"No autopsy # for ",LRP Q
"RTN","LRUPS",46,0)
 S Y=+LRND D D^LRU W !,"Autopsy performed: ",Y,"  Acc # ",LRAC
"RTN","LRUPS",47,0)
 Q
"RTN","LRUPS",48,0)
EN1 ;from LRAPMOD, LRSPRPT, LRSPT
"RTN","LRUPS",49,0)
 W ! K DIC,LRAN S DIC(0)="EQM",(LRX,LRDPF)="" D DPA^LRDPA I DFN=-1 S LRAN=-1 Q
"RTN","LRUPS",50,0)
 G I
"RTN","LRWRKLST")
0^1^B41281168^B41200786
"RTN","LRWRKLST",1,0)
LRWRKLST ;DALOI/CJS/DRH-LONG ACCESSION LIST ;2/19/91  11:46
"RTN","LRWRKLST",2,0)
 ;;5.2;LAB SERVICE;**1,17,38,153,185,221,268,362**;Sep 27, 1994;Build 11
"RTN","LRWRKLST",3,0)
 ;
"RTN","LRWRKLST",4,0)
 N LRDICS
"RTN","LRWRKLST",5,0)
 ;
"RTN","LRWRKLST",6,0)
 ; Save and restore DIC("S") if micro long form accession option (LRMIACC1).
"RTN","LRWRKLST",7,0)
 I $D(DIC("S")) S LRDICS=DIC("S")
"RTN","LRWRKLST",8,0)
 D LREND
"RTN","LRWRKLST",9,0)
 I $D(LRDICS) S DIC("S")=LRDICS
"RTN","LRWRKLST",10,0)
 ;
"RTN","LRWRKLST",11,0)
 S LRDT=$$FMTE^XLFDT($$NOW^XLFDT,"5MZ")
"RTN","LRWRKLST",12,0)
 ;
"RTN","LRWRKLST",13,0)
 S LREND=0
"RTN","LRWRKLST",14,0)
 S DIC="^LRO(68,",DIC(0)="AEMOQ"
"RTN","LRWRKLST",15,0)
 D ^DIC S LRAA=+Y,LRNAME=$P(Y,U,2)
"RTN","LRWRKLST",16,0)
 I LRAA<1 D LREND Q
"RTN","LRWRKLST",17,0)
 ;
"RTN","LRWRKLST",18,0)
 ; Ask if list by date rather than accession number
"RTN","LRWRKLST",19,0)
 I $P(^LRO(68,LRAA,0),U,3)="Y" D STAR^LRWU3 S LRLAST=$G(LAST)
"RTN","LRWRKLST",20,0)
 I LREND D LREND Q
"RTN","LRWRKLST",21,0)
 ; List by acccession number
"RTN","LRWRKLST",22,0)
 I '$D(LRSTAR) D PHD
"RTN","LRWRKLST",23,0)
 I LREND D LREND Q
"RTN","LRWRKLST",24,0)
 ;
"RTN","LRWRKLST",25,0)
W ;from LRVER, LRVR
"RTN","LRWRKLST",26,0)
 ;
"RTN","LRWRKLST",27,0)
 N DIR,DTOUT,DIRUT,DIROUT
"RTN","LRWRKLST",28,0)
 I '$D(^LRO(68,LRAA,1,LRAD,1,0)),'$D(LRSTAR) D LREND Q
"RTN","LRWRKLST",29,0)
 ;
"RTN","LRWRKLST",30,0)
 S (LRUNC,LRTSE)=0
"RTN","LRWRKLST",31,0)
 S:'$D(LRNAME) LRNAME=$P(^LRO(68,LRAA,0),U,1)
"RTN","LRWRKLST",32,0)
 ;
"RTN","LRWRKLST",33,0)
 S DIR(0)="YO",DIR("A")="Do you want a specific test",DIR("B")="NO"
"RTN","LRWRKLST",34,0)
 D ^DIR
"RTN","LRWRKLST",35,0)
 I $D(DIRUT) D LREND Q
"RTN","LRWRKLST",36,0)
 I Y=1 D
"RTN","LRWRKLST",37,0)
 . N DIC,X,Y
"RTN","LRWRKLST",38,0)
 . S DIC="^LAB(60,",DIC(0)="AEZOQ"
"RTN","LRWRKLST",39,0)
 . D ^DIC
"RTN","LRWRKLST",40,0)
 . I Y>0 S LRTSE=+Y
"RTN","LRWRKLST",41,0)
 ;
"RTN","LRWRKLST",42,0)
 K DIR
"RTN","LRWRKLST",43,0)
 S DIR(0)="YO",DIR("A")="Do you want only incomplete entries",DIR("B")="YES"
"RTN","LRWRKLST",44,0)
 D ^DIR
"RTN","LRWRKLST",45,0)
 I $D(DIRUT) D LREND Q
"RTN","LRWRKLST",46,0)
 S LRUNC=Y
"RTN","LRWRKLST",47,0)
 ;
"RTN","LRWRKLST",48,0)
 S %ZIS="Q" D ^%ZIS
"RTN","LRWRKLST",49,0)
 I POP D ^%ZISC,LREND Q
"RTN","LRWRKLST",50,0)
 ;
"RTN","LRWRKLST",51,0)
 ; Queue report via Taskman
"RTN","LRWRKLST",52,0)
 I $D(IO("Q")) D  Q
"RTN","LRWRKLST",53,0)
 . N ZTDESC,ZTSK,ZTRTN,ZTIO,ZTSAVE,%T
"RTN","LRWRKLST",54,0)
 . S ZTRTN="ENT^LRWRKLST",ZTDESC="Long form accession list",ZTSAVE("LR*")=""
"RTN","LRWRKLST",55,0)
 . D ^%ZTLOAD,^%ZISC
"RTN","LRWRKLST",56,0)
 . W !,"Task ",$S($G(ZTSK):ZTSK,1:"NOT")," Queued"
"RTN","LRWRKLST",57,0)
 . D LREND K IO("Q")
"RTN","LRWRKLST",58,0)
 ;
"RTN","LRWRKLST",59,0)
ENT ;
"RTN","LRWRKLST",60,0)
 ;
"RTN","LRWRKLST",61,0)
 N LRTST
"RTN","LRWRKLST",62,0)
 ;
"RTN","LRWRKLST",63,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","LRWRKLST",64,0)
 S (LREND,LRSTOP)=0
"RTN","LRWRKLST",65,0)
 ;
"RTN","LRWRKLST",66,0)
 ;
"RTN","LRWRKLST",67,0)
 U IO
"RTN","LRWRKLST",68,0)
 D HED,URG^LRX
"RTN","LRWRKLST",69,0)
 ;
"RTN","LRWRKLST",70,0)
 ; Process by accession date
"RTN","LRWRKLST",71,0)
 I '$D(LRSTAR) D
"RTN","LRWRKLST",72,0)
 . S LRAN=LRFAN-1
"RTN","LRWRKLST",73,0)
 . F  S LRAN=$O(^LRO(68,LRAA,1,LRAD,1,LRAN)) Q:'LRAN!(LRAN>LRLAN)  D  Q:LRSTOP
"RTN","LRWRKLST",74,0)
 . . S LREND=0 D TD
"RTN","LRWRKLST",75,0)
 . . I LREND Q
"RTN","LRWRKLST",76,0)
 . . D LST,TESTS
"RTN","LRWRKLST",77,0)
 ;
"RTN","LRWRKLST",78,0)
 ; Process by date received in lab - yearly accession area
"RTN","LRWRKLST",79,0)
 I $D(LRSTAR) D
"RTN","LRWRKLST",80,0)
 . F  S LRAD=$O(^LRO(68,LRAA,1,LRAD)) Q:LRAD<1!(LRAD>LRWDTL)  D AC  Q:LRSTOP
"RTN","LRWRKLST",81,0)
 ;
"RTN","LRWRKLST",82,0)
 D ^%ZISC,LREND
"RTN","LRWRKLST",83,0)
 Q
"RTN","LRWRKLST",84,0)
 ;
"RTN","LRWRKLST",85,0)
 ;
"RTN","LRWRKLST",86,0)
TD ; Check tests on accession to determine if meets criteria to display.
"RTN","LRWRKLST",87,0)
 ; If incomplete only (LRUNC=1) and complete date then skip
"RTN","LRWRKLST",88,0)
 ; If not specific test selected (LRTSE=file #60 ien) then skip
"RTN","LRWRKLST",89,0)
 ; Otherwise set LRTST array with file #60 ien.
"RTN","LRWRKLST",90,0)
 ;
"RTN","LRWRKLST",91,0)
 K LRTST
"RTN","LRWRKLST",92,0)
 ;
"RTN","LRWRKLST",93,0)
 I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN,0)) S LREND=1 Q
"RTN","LRWRKLST",94,0)
 S LRSN=+$P(^LRO(68,LRAA,1,LRAD,1,LRAN,0),U,5),LRDAT=+$P(^(0),U,4)
"RTN","LRWRKLST",95,0)
 S LRI=0
"RTN","LRWRKLST",96,0)
 F  S LRI=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRI)) Q:LRI<.5  D
"RTN","LRWRKLST",97,0)
 . I LRTSE,LRTSE'=+^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRI,0) Q
"RTN","LRWRKLST",98,0)
 . I LRUNC,$P(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRI,0),"^",5) Q
"RTN","LRWRKLST",99,0)
 . S LRTST(LRI)=""
"RTN","LRWRKLST",100,0)
 ;
"RTN","LRWRKLST",101,0)
 I '$D(LRTST) S LREND=1
"RTN","LRWRKLST",102,0)
 Q
"RTN","LRWRKLST",103,0)
 ;
"RTN","LRWRKLST",104,0)
 ;
"RTN","LRWRKLST",105,0)
TESTS ;
"RTN","LRWRKLST",106,0)
 N S1,S2
"RTN","LRWRKLST",107,0)
 ;
"RTN","LRWRKLST",108,0)
 D CHKPAGE^LRWRKLS1
"RTN","LRWRKLST",109,0)
 Q:LRSTOP!LREND
"RTN","LRWRKLST",110,0)
 ;
"RTN","LRWRKLST",111,0)
 Q:'$D(^LRO(68,LRAA,1,LRAD,1,LRAN,4,0))
"RTN","LRWRKLST",112,0)
 ;
"RTN","LRWRKLST",113,0)
 S LRSPEC=+$G(^LRO(68,LRAA,1,LRAD,1,LRAN,5,1,0)),LRSAMP=$S(LRSPEC:$P(^(0),U,2),1:"")
"RTN","LRWRKLST",114,0)
 S S1=$P($G(^LAB(61,+LRSPEC,0)),U,1)
"RTN","LRWRKLST",115,0)
 S S2=$P($G(^LAB(62,+LRSAMP,0)),U,1)
"RTN","LRWRKLST",116,0)
 ;
"RTN","LRWRKLST",117,0)
 W !,"  SAMPLE: ",S1_$S(S1'=S2:"  "_S2,1:"")
"RTN","LRWRKLST",118,0)
 S LN=LN+1
"RTN","LRWRKLST",119,0)
 ;
"RTN","LRWRKLST",120,0)
 S LRLO69=$G(^LRO(69,LRDAT,1,LRSN,0))
"RTN","LRWRKLST",121,0)
 I $L(LRLO69),$D(^LRO(69,LRDAT,1,LRSN,1)),$L($P(^(1),U,6)) W !,$P(^(1),U,6) S LN=LN+1
"RTN","LRWRKLST",122,0)
 ;
"RTN","LRWRKLST",123,0)
 K LRNAC
"RTN","LRWRKLST",124,0)
 S LRI=0
"RTN","LRWRKLST",125,0)
 F  S LRI=$O(LRTST(LRI)) Q:'LRI  D TS2
"RTN","LRWRKLST",126,0)
 ;
"RTN","LRWRKLST",127,0)
 I '$D(LRNAC),$L($P($G(^LRO(68,LRAA,1,LRAD,1,LRAN,3)),U,4)) D
"RTN","LRWRKLST",128,0)
 . W !,"ALL COMPLETED",!!
"RTN","LRWRKLST",129,0)
 . S LN=LN+3
"RTN","LRWRKLST",130,0)
 Q
"RTN","LRWRKLST",131,0)
 ;
"RTN","LRWRKLST",132,0)
 ;
"RTN","LRWRKLST",133,0)
TS2 ;
"RTN","LRWRKLST",134,0)
 ;
"RTN","LRWRKLST",135,0)
 D CHKPAGE^LRWRKLS1
"RTN","LRWRKLST",136,0)
 Q:LRSTOP!LREND
"RTN","LRWRKLST",137,0)
 ;
"RTN","LRWRKLST",138,0)
 S LRXXX=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRI,0)),LRURG=+$P(LRXXX,U,2)
"RTN","LRWRKLST",139,0)
 W !,"  TEST: ",$P($G(^LAB(60,+LRXXX,0),"deleted test"),"^")
"RTN","LRWRKLST",140,0)
 S LN=LN+1
"RTN","LRWRKLST",141,0)
 ;
"RTN","LRWRKLST",142,0)
 W ?40,$S($D(LRURG(LRURG)):LRURG(LRURG),1:"")
"RTN","LRWRKLST",143,0)
 W:$L($P(LRXXX,U,3)) ?55," LIST: ",$P($G(^LRO(68.2,+$P(LRXXX,U,3),0)),U,1)," ",$P($P(LRXXX,U,3),";",2,3)
"RTN","LRWRKLST",144,0)
 ;
"RTN","LRWRKLST",145,0)
 I $D(^LRO(69,LRDAT,1,LRSN,2,"B",LRI)) D
"RTN","LRWRKLST",146,0)
 . N I,X
"RTN","LRWRKLST",147,0)
 . S X=$O(^LRO(69,LRDAT,1,LRSN,2,"B",LRI,0))
"RTN","LRWRKLST",148,0)
 . I X,$O(^LRO(69,LRDAT,1,LRSN,2,X,1,0)) D
"RTN","LRWRKLST",149,0)
 . . S I=0
"RTN","LRWRKLST",150,0)
 . . F  S I=$O(^LRO(69,LRDAT,1,LRSN,2,X,1,I)) Q:I<1  W !?3,": "_^(I,0)
"RTN","LRWRKLST",151,0)
 ;
"RTN","LRWRKLST",152,0)
 D REF
"RTN","LRWRKLST",153,0)
 ;
"RTN","LRWRKLST",154,0)
 I $P(LRXXX,U,5) W !,"  COMPLETED: ",$$FMTE^XLFDT($P(LRXXX,U,5),"5MZ") S LN=LN+1
"RTN","LRWRKLST",155,0)
 E  S LRNAC=""
"RTN","LRWRKLST",156,0)
 Q
"RTN","LRWRKLST",157,0)
 ;
"RTN","LRWRKLST",158,0)
 ;
"RTN","LRWRKLST",159,0)
REF ; if referred test, display status and manifest
"RTN","LRWRKLST",160,0)
 ;
"RTN","LRWRKLST",161,0)
 N LREVNT,LRUID,LRMAN
"RTN","LRWRKLST",162,0)
 ;
"RTN","LRWRKLST",163,0)
 S LRUID=$P($G(^LRO(68,LRAA,1,LRAD,1,LRAN,.3)),"^")  Q:LRUID=""
"RTN","LRWRKLST",164,0)
 S LRMAN=$P(LRXXX,"^",10)
"RTN","LRWRKLST",165,0)
 I LRMAN S LRMAN=$P($G(^LAHM(62.8,LRMAN,0)),"^")
"RTN","LRWRKLST",166,0)
 S LREVNT=$$STATUS^LREVENT(LRUID,+LRXXX,LRMAN)
"RTN","LRWRKLST",167,0)
 I LREVNT'="" D
"RTN","LRWRKLST",168,0)
 . W !,?5,"REFERRAL STATUS: "_$P(LREVNT,"^")_" ("_$P(LREVNT,"^",2)_")"
"RTN","LRWRKLST",169,0)
 . W !,?8,"SHIPPING MANIFEST: "_$P(LREVNT,"^",3)
"RTN","LRWRKLST",170,0)
 . S LN=LN+2
"RTN","LRWRKLST",171,0)
 Q
"RTN","LRWRKLST",172,0)
 ;
"RTN","LRWRKLST",173,0)
 ;
"RTN","LRWRKLST",174,0)
PHD ;
"RTN","LRWRKLST",175,0)
 Q:LREND
"RTN","LRWRKLST",176,0)
 S LREND=0,U="^"
"RTN","LRWRKLST",177,0)
 D ADATE^LRWU Q:LREND
"RTN","LRWRKLST",178,0)
 D LRAN^LRWU3
"RTN","LRWRKLST",179,0)
 Q
"RTN","LRWRKLST",180,0)
 ;
"RTN","LRWRKLST",181,0)
LST ;
"RTN","LRWRKLST",182,0)
 D HED:($E(IOST)="P"&($Y+11>IOSL)),LST1^LRWRKLS1
"RTN","LRWRKLST",183,0)
 Q
"RTN","LRWRKLST",184,0)
 ;
"RTN","LRWRKLST",185,0)
HED ;
"RTN","LRWRKLST",186,0)
 W @IOF,!,"LONG FORM",?30,"NOT FOR WARD USE",!
"RTN","LRWRKLST",187,0)
 W "Accession Area: ",LRNAME,?40,LRDT,!!
"RTN","LRWRKLST",188,0)
 S LN=4
"RTN","LRWRKLST",189,0)
 Q
"RTN","LRWRKLST",190,0)
 ;
"RTN","LRWRKLST",191,0)
AC ;
"RTN","LRWRKLST",192,0)
 I LRSTOP!LREND Q
"RTN","LRWRKLST",193,0)
 ;
"RTN","LRWRKLST",194,0)
 S LRTK=LRSTAR-.00001
"RTN","LRWRKLST",195,0)
 F  S LRTK=$O(^LRO(68,LRAA,1,LRAD,1,"E",LRTK)) Q:LRTK<1!(LRTK\1>LRLAST)  D  Q:LRSTOP
"RTN","LRWRKLST",196,0)
 . S LRAN=0
"RTN","LRWRKLST",197,0)
 . F  S LRAN=$O(^LRO(68,LRAA,1,LRAD,1,"E",LRTK,LRAN)) Q:LRAN<1!(LRSTOP)  D
"RTN","LRWRKLST",198,0)
 . . I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN,0)) Q
"RTN","LRWRKLST",199,0)
 . . S LREND=0 D TD
"RTN","LRWRKLST",200,0)
 . . I LREND Q
"RTN","LRWRKLST",201,0)
 . . D LST,TESTS
"RTN","LRWRKLST",202,0)
 Q
"RTN","LRWRKLST",203,0)
 ;
"RTN","LRWRKLST",204,0)
 ;
"RTN","LRWRKLST",205,0)
LREND ;
"RTN","LRWRKLST",206,0)
 D KVAR^VADPT
"RTN","LRWRKLST",207,0)
 K %,%DT,%ZIS
"RTN","LRWRKLST",208,0)
 K LN,LRA,AGE,DFN,DIC,DIR,DIRUT,DOB,DTOUT,DUOUT,K,LAST
"RTN","LRWRKLST",209,0)
 K LRACC,LRDLA,LRDLC,LRDX,LRI,LRLO69,LRSAMP,LRSPEC
"RTN","LRWRKLST",210,0)
 K LRURG,LRWRD,LRACO,DIC,LRUNC,LRDAT,LRAA,LRAD
"RTN","LRWRKLST",211,0)
 K LRNAC,LRAN,LRCE,LRDPF,LRSN,LRDTO,LRLAST,LRPRAC,LRSTAR,LRXXX
"RTN","LRWRKLST",212,0)
 K LRB,LRLAN,LRDT,LREND,LRFAN,LRIX,LRNAME,LRTSE,LRTST
"RTN","LRWRKLST",213,0)
 K LRDFN,LREDT,LRLLOC,LRSDT,LRTK,LRWDTL,POP,LRSTOP
"RTN","LRWRKLST",214,0)
 K PNM,SEX,SSN,X,X1,X2,Y,Z,ZTSK
"RTN","LRWRKLST",215,0)
 Q
"RTN","LRWRKLST",216,0)
 ;
"RTN","LRWRKLST",217,0)
EN ;
"RTN","LRWRKLST",218,0)
SINGLE ;
"RTN","LRWRKLST",219,0)
 ;
"RTN","LRWRKLST",220,0)
 N LRACC,LREND,LRSTOP,LRTSE,LRUNC,LRURG
"RTN","LRWRKLST",221,0)
 ;
"RTN","LRWRKLST",222,0)
 D URG^LRX
"RTN","LRWRKLST",223,0)
 ;
"RTN","LRWRKLST",224,0)
 F  D  Q:LREND!LRSTOP
"RTN","LRWRKLST",225,0)
 . S (LREND,LRUNC,LRSTOP,LRTSE)=0
"RTN","LRWRKLST",226,0)
 . S LRACC="" D ^LRWU4
"RTN","LRWRKLST",227,0)
 . I LRAN<1 S LREND=1 Q
"RTN","LRWRKLST",228,0)
 . I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN,0)) W !,"Doesn't exist." Q
"RTN","LRWRKLST",229,0)
 . D TD,LST1^LRWRKLS1,TESTS
"RTN","LRWRKLST",230,0)
 . W !
"RTN","LRWRKLST",231,0)
 ;
"RTN","LRWRKLST",232,0)
 D LREND
"RTN","LRWRKLST",233,0)
 Q
"VER")
8.0^22.0
"BLD",6877,6)
^284
**END**
**END**
