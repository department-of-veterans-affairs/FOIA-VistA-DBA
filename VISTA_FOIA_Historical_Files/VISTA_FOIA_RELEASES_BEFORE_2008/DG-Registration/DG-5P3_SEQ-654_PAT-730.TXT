$TXT Created by THEROUX,JOHN at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Tuesday, 11/14/06 at 16:09
=============================================================================
Run Date: JAN 31, 2007                     Designation: DG*5.3*730
Package : DG - REGISTRATION                   Priority: Mandatory
Version : 5.3       SEQ #654                    Status: Released
                  Compliance Date: MAR 03, 2007
=============================================================================

Associated patches: (v)DG*5.3*545  <<= must be installed BEFORE `DG*5.3*730'
                    (v)DG*5.3*554  <<= must be installed BEFORE `DG*5.3*730'
                    (v)DG*5.3*581  <<= must be installed BEFORE `DG*5.3*730'
                    (v)DG*5.3*658  <<= must be installed BEFORE `DG*5.3*730'
                    (v)DG*5.3*695  <<= must be installed BEFORE `DG*5.3*730'
                    (v)DG*5.3*703  <<= must be installed BEFORE `DG*5.3*730'

Subject: UPDATING PATIENT ADDRESS

Category: 
  - Routine

Description:
============

   This patch resolves problems related to the patient's address, the 
 emergency contact work phone, the principal investigator report, 
 and the patient name change bulletin.
  
 ASSOCIATED REMEDY TICKETS:
 ==========================
 1) HD160617  Corrupted data in patient files
 2) HD157373  Problem with replicating e-Contact information out for
              patients
    duplicate:
    HD172659  Mas Issue
 3) HD159036  Principal Investigator Report Hang
 4) HD146476  Patient Name Change bulletin being sent to wrong users
 5) HD144327  duplicate choice for city in appt mgmt
    duplicate:
    HD152639  City wrong when updating address
  
 ASSOCIATED NSR's:
 =================
 N/A
  
 ASSOCIATED TEST SITES:
 ======================
 Upstate,NY
 Lexington,KY
 Phoenix,AZ
  
 REMEDY OVERVIEW:
 ================
  
 1) HD160617  Corrupted data in patient files
  
 Problem:
 ========
 Users are unable to edit the patient's address if the Internal Entry 
 Number (IEN) of the patient file record is not a whole number, for 
 example, if it contains decimals. 
  
 Solution:
 =========
 Routines DGREGAED and DGADDUTL were modified not to check that 
 the IEN is a whole number.
  
 2) HD157373  Problem with replicating e-Contact information out for 
              patients
 Problem:
 ========
 With the release of DG*5.3*703, the Patient Inquiry [DG PATIENT INQUIRY]
 option began displaying Emergency Contact information.  Depending on 
 how the work phone data was entered, the display can erroneously show
 UNSPECIFIED instead of showing the work phone number that was entered.
  
 Solution:
 =========
 Routine DGRPD1 was modified to display the work phone correctly.  
  
 3) HD159036  Principal Investigator Report Hang
  
 Problem:
 ========
 In the Patient Record Flag functionality, when using the Assignments 
 by Principal Investigator Report [DGPF PRINCIPAL INVEST REPORT] option,
 and entering a "?" at the "Select Principal Investigator:" prompt,
 the system hangs for a minute or two, depending on how many entries 
 exist in the NEW PERSON FILE (#200), before giving a list to
 choose from, if any.
  
 Solution:
 =========
 Instead of doing the lookup on the New Person file, the lookup
 will be done on the "C" cross-reference of the PRF LOCAL FLAG FILE
 (#26.11).
 Routine DGPFRPI was modified. 
  
 4) HD146476  Patient Name Change bulletin being sent to wrong users
  
 Problem:
 ========
 Sporadically, the Patient Name Change bulletin will include some 
 additional users besides the members of the group.
  
 Solution:
 =========
 Routine DGBUL was modified to clear the XMY array before starting
 to build the message.
  
 5) HD144327  duplicate choice for city in appt mgmt
  
 Problem:
 ========
 When updating patient permanent addresses, identical duplicate choices
 of the city are being displayed after the "select" prompt if the city 
 has an abbreviation. This forces users to choose between identical 
 names instead of being able to accept the default. 
  
 Solution:
 =========
 Routine DGREGAZL was modified to correct the display selection to
 show only one name, thus enabling users to accept the default.
  
 INSTALLATION INSTRUCTIONS:
 ===========================
 This patch may be run with users on the system.
 Installation will take less than 5 minutes.
  
 1.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu to unload
     the KIDS distribution included with this message.
     NOTE:  If the required patches are not installed, the transport global
            will be removed.  If the transport global is removed you will
            need to repeat this step.
  
 2.  From the Kernel Installation and Distribution System Menu, select
     the Installation menu.
  
 3.  From this menu, you may elect to use the following options
     (when prompted for INSTALL NAME, enter DG*5.3*730):
     a.  Compare Transport Global to Current System  - this option will
         allow you to view all changes that will be made when the patch
         is installed.  It compares all components of the patch (routines,
         DDs, templates, etc.).
     b.  Verify Checksums in Transport Global - this option will
         allow you to ensure the integrity of the routines that are in
         the transport global.
     c.  Print Transport Global - this option will allow you to view the
         components of the KIDS build.
     d.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
  
 4.  Use the Install Package(s) option and select the package DG*5.3*730.
  
 5.  When prompted ' Want KIDS to INHIBIT LOGONs during the install?
     YES//', respond NO.
  
 6.  When prompted,' Want to DISABLE Scheduled Options, Menu Options, and 
     Protocols? NO//', respond Yes.
     When prompted,'Enter options you wish to mark as 'Out Of Order':',
     enter:
             Load/Edit Patient Data [DG LOAD PATIENT DATA]
  
     When prompted,'Enter protocols you wish to mark as 'Out Of Order':', 
     press enter.
  
 ROUTINE SUMMARY:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
  
      <tab>;;5.3;Registration;**[patch list]**;Aug 13, 1993
  
  OLD:                            CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGADDUTL               7368398              7349430         658,695,730
  DGBUL                  4088534              4095712       31,244,545,730
  DGPFRPI                5189261              4970575           554,730
  DGREGAED               5009652              5000168       522,560,658,730
  DGREGAZL               7172466              8019739       522,560,581,730
  DGRPD1                 2413551              2534352           703,730
  
  NEW:            CHECK1^XTSUMBLD results
  Routine name    Before Patch    After Patch     Patch List
  ============    ============    ===========     ==========
  DGADDUTL        43598540        43351815        658,695,730
  DGBUL           6158333         6329339         31,244,545,730
  DGPFRPI         19041361        18765680        554,730
  DGREGAED        17895648        17873671        522,560,658,730
  DGREGAZL        37170348        39798425        522,560,581,730
  DGRPD1          5093592         5267286         703,730

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DGADDUTL
    Before: B43598540  After: B43351815  **658,695,730**
 Description of Changes:
  DGADDUTL.INT.1                |"PATVEE"|DGADDUTL.INT.1  
  **************************************************************************
  *****
  DGADDUTL.INT.1
   +2         ;;5.3;Registration;**658,695,730**;Aug 13, 1993
  ...................
  |"PATVEE"|DGADDUTL.INT.1
   +2         ;;5.3;Registration;**658,695**;Aug 13, 1993
  ---------------------------------------
  DGADDUTL.INT.1
   +84        ;I ($G(DFN)'?.N) Q
  ...................
  |"PATVEE"|DGADDUTL.INT.1
   +84        I ($G(DFN)'?.N) Q
  ---------------------------------------
  DGADDUTL.INT.1
   +153       ;I ($G(DFN)'?.N) Q
  ...................
  |"PATVEE"|DGADDUTL.INT.1
   +153       I ($G(DFN)'?.N) Q
  **************************************************************************
  *****

Routine Name: DGBUL
    Before:  B6158333  After:  B6329339  **31,244,545,730**
 Description of Changes:
  DGBUL.INT.1                   |"PATVEE"|DGBUL.INT.1  
  **************************************************************************
  *****
  DGBUL.INT.1
   +2         ;;5.3;Registration;**31,244,545,730**;Aug 13, 1993
  ...................
  |"PATVEE"|DGBUL.INT.1
   +2         ;;5.3;Registration;**31,244,545**;Aug 13, 1993
  ---------------------------------------
  DGBUL.INT.1
   +15        ;next line from DG*730
   +16        K:$D(XMY) XMY
  ...................
  |"PATVEE"|DGBUL.INT.1

Routine Name: DGPFRPI
    Before: B19041361  After: B18765680  **554,730**
 Description of Changes:
  DGPFRPI.INT.1                 |"PATVEE"|DGPFRPI.INT.1  
  **************************************************************************
  *****
  DGPFRPI.INT.1
   +2         ;;5.3;Registration;**554,730**;Aug 13, 1993
  ...................
  |"PATVEE"|DGPFRPI.INT.1
   +2         ;;5.3;Registration;**554**;Aug 13, 1993
   
            
  ---------------------------------------
  DGPFRPI.INT.1
   +65        .S (DGQ,DGABORT)=0
   +66        .N DIC,D,X,Y,I
   +67        .S DIC="^DGPF(26.11,"
   +68        .S DIC(0)="AEQZ"
   +69        .S D="C"
   +70        .S DIC("A")="Select Principal Investigator's name: "
   +71        .D IX^DIC
   +72        .I Y<0 S DGABORT=1 Q
   +73        .S I=0
   +74        .F  S I=$O(^DGPF(26.11,+Y,2,"B",I)) Q:'I  I 
  $P(^VA(200,I,0),U)[X Q
   +75        .I '$G(I) S DGABORT=1 Q
   +76        .S DGSORT("DGPRINC")=I_U_$$EXTERNAL^DILFD(26.112,.01,"F",I)
   +77        .S DGQ=1
  ...................
  |"PATVEE"|DGPFRPI.INT.1
   +65        . S (DGQ,DGABORT)=0
   +66        . S DGDIRA="Select Principal Investigator",DGDIRB=""
   +67        . S DGDIRH="Enter the Principal Investigator name"
   +68        . S DGDIRO="P^200:EMZ"
   
            
   +69        . S DGDIRS="I $D(^DGPF(26.11,""C"",+Y))"
   +70        . F  D  Q:(DGQ!DGABORT)
   +71        . . S 
  DGASK=$$ANSWER^DGPFUT(DGDIRA,DGDIRB,DGDIRO,DGDIRH,DGDIRS)
   +72        . . I DGASK<1 S DGABORT=1 Q
   +73        . . S 
  DGSORT("DGPRINC")=DGASK_U_$$EXTERNAL^DILFD(26.112,.01,"F",DGA
  SK)
   +74        . . S DGQ=1
  **************************************************************************
  *****

Routine Name: DGREGAED
    Before: B17895648  After: B17873671  **522,560,658,730**
 Description of Changes:
  DGREGAED.INT.1                |"PATVEE"|DGREGAED.INT.1  
  **************************************************************************
  *****
  DGREGAED.INT.1
   +2         ;;5.3;Registration;**522,560,658,730**;Aug 13, 1993
  ...................
  |"PATVEE"|DGREGAED.INT.1
   +2         ;;5.3;Registration;**522,560,658**;Aug 13, 1993
  ---------------------------------------
  DGREGAED.INT.1
   +5         ;  DFN (required) - Internal Entry # of Patient File (#2)
  ...................
  |"PATVEE"|DGREGAED.INT.1
   +5         ;  DFN (required) - Interal Entry # of Patient File (#2)
   
            
  ---------------------------------------
  DGREGAED.INT.1
   +8         ;    FLG(2) - if 1, display before & after address for user 
  confirm
  ation
  ...................
  |"PATVEE"|DGREGAED.INT.1
   +8         ;    FLG(2) - if 1, dispaly before & after address for user 
  confirm
  ation
  ---------------------------------------
  DGREGAED.INT.1
   +13        ;I ($G(DFN)'?.N) Q
  ...................
  |"PATVEE"|DGREGAED.INT.1
   +13        I ($G(DFN)'?.N) Q
  ---------------------------------------
  DGREGAED.INT.1
   +52  COMPARE(DGINPUT,DFN) ;Display before & after address fields
  ...................
  |"PATVEE"|DGREGAED.INT.1
   +52  COMPARE(DGINPUT,DFN) ;Display before & after address fileds.
  **************************************************************************
  *****

Routine Name: DGREGAZL
    Before: B37170348  After: B39798425  **522,560,581,730**
 Description of Changes:
  DGREGAZL.INT.1                |"PATVEE"|DGREGAZL.INT.1  
  **************************************************************************
  *****
  DGREGAZL.INT.1
   +1   DGREGAZL ;ALB/DW - ZIP LINKING UTILITY ; 5/27/04 10:54am
   +2         ;;5.3;Registration;**522,560,581,730**;Aug 13, 1993
  ...................
  |"PATVEE"|DGREGAZL.INT.1
   +1   DGREGAZL ;ALB/DW - ZIP LINKING UTILITY ; 3/3/04 1:43pm
   +2         ;;5.3;Registration;**522,560,581**;Aug 13, 1993
  ---------------------------------------
  DGREGAZL.INT.1
   +45         ;DG*730
   +46        I $G(DGDATA(1,"CITY ABBREVIATION"))'="",$G(DGDATA(1,"CITY 
  ABBREVIAT
  ION"))=$G(DGDATA(2,"CITY")) S DGDATA=1 K DGDATA(2)
  ...................
  |"PATVEE"|DGREGAZL.INT.1
  ---------------------------------------
  DGREGAZL.INT.1
   +63        ;DG*730
   +64        I $G(DGDATA(1,"CITY ABBREVIATION"))'="",$G(DGDATA(1,"CITY 
  ABBREVIAT
  ION"))=$G(DGDATA(2,"CITY")) S DGDATA=1 K DGDATA(2)
   
            
  ...................
  |"PATVEE"|DGREGAZL.INT.1
  **************************************************************************
  *****

Routine Name: DGRPD1
    Before:  B5093592  After:  B5267286  **703,730**
 Description of Changes:
  DGRPD1.INT.1                  |"PATVEE"|DGRPD1.INT.1  
  **************************************************************************
  *****
  DGRPD1.INT.1
   +2         ;;5.3;Registration;**703,730**;Aug 13, 1993
  ...................
  |"PATVEE"|DGRPD1.INT.1
   +2         ;;5.3;Registration;**703**;Aug 13, 1993
  ---------------------------------------
  DGRPD1.INT.1
   +40        . W !?2,"Work Phone: 
  ",$S($P(^DPT(DFN,.33),U,11)]"":$P(^DPT(DFN,.33
  ),U,11),1:"UNSPECIFIED")
   +41        . I DGEC2(9)]"" W ?38,"Work Phone: 
  ",$S($P(^DPT(DFN,.331),U,11)]"":
  $P(^DPT(DFN,.331),U,11),1:"UNSPECIFIED")
  ...................
  |"PATVEE"|DGRPD1.INT.1
   +40        . W !?2,"Work Phone: 
  ",$S($P(^DPT(DFN,.33),U,11):$P(^(.33),U,11),1:
  "UNSPECIFIED")
   +41        . I DGEC2(9)]"" W ?38,"Work Phone: 
  ",$S($P(^DPT(DFN,.331),U,11):$P(
  ^(.331),U,11),1:"UNSPECIFIED")
  **************************************************************************
  *****


=============================================================================
User Information:
Entered By  : THEROUX,JOHN                  Date Entered  : OCT 04, 2006
Completed By: BOWEN,MARY JANE               Date Completed: JAN 31, 2007
Released By : FRANCE,KATHI                  Date Released : JAN 31, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
