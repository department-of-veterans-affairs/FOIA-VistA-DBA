$TXT Created by BAUMANN,SCOTT A at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Tuesday, 05/17/05 at 09:12
=============================================================================
Run Date: AUG 10, 2005                     Designation: FB*3.5*91
Package : FB - FEE BASIS                      Priority: Mandatory
Version : 3.5        SEQ #80                    Status: Released
                  Compliance Date: SEP 10, 2005
=============================================================================

Associated patches: (v)FB*3.5*80   <<= must be installed BEFORE `FB*3.5*91'

Subject: FEE BASIS PHARMACY ENCAPSULATION AND FIXES

Category: 
  - Enhancement (Mandatory)
  - Routine
  - Data Dictionary
  - Other

Description:
============

 This patch modifies the Complete Pharmacy Invoice [FBAA COMPLETE PHARMACY
 INVOICE] option in support of the Pharmacy Encapsulation project.  It also
 corrects some faults with the Review Fee Prescription [FBAA PHARMACY
 REVIEW] option.
 
 1. FIX REVIEW FEE PRESCRIPTION OPTION
  
    Two pre-existing faults with the Review Fee Prescription [FBAA PHARMACY
    REVIEW] option were discovered during development of this patch.
  
    a. The answer to the question 'Was a Generic Drug issued to the 
       patient?' is stored in the SUBSTITUTE GENERIC DRUG (#8.5) field
       of the FEE BASIS PHARMACY INVOICE (#162.1) file using an invalid
       format for the set of codes field.  This fault prevents the 
       Complete Pharmacy Invoice [FBAA COMPLETE PHARMACY INVOICE] option
       from ever displaying the information that the pharmacist entered
       about generic drugs.
  
       This patch expands the definition of the field to include a code for
       the NO response in addition to the existing code for the YES
       response.  This patch also modifies the Review Fee Prescription
       option, so a valid internal code value will be stored in the field.
       When the patch is installed, a post-install routine will examine all
       existing data and correct the invalid data by changing "Yes" to "Y"
       and "No" to "N", so the stored values match the set of codes.
  
    b. If a user responds "YES" to the "Want to edit prior to release?"
       question, the software allows the user to revise the information
       previously entered for the prescription.  However, in some cases the
       new answers are not retained by the software.  Some examples of this
       behavior are listed below:
  
       o If "Is Prescription for an Authorized Condition?" is initially 
         answered No and then edited prior to release to be Yes, the
         software does not display the new answer when the information is
         presented for review.
  
       o If "Is Prescription for an Authorized Condition?" is initially 
         answered Yes and then edited prior to release to be No, the
         software does not remove the generic equivalent drug.
  
       o If a prescription is disapproved for payment (either authorized 
         condition = No or emergency medication = No) and then edited prior
         to release to be approved (both Yes), the adjustments and
         remittance remarks are not removed.  Additionally, the new answers
         to three other prompts (authorized condition, emergency
         medication, generic drug issued) are not retained.
  
       This patch fixes the Review Fee Prescription [FBAA PHARMACY REVIEW]
       option, so all changes are appropriately handled when the previous
       answers are edited.
  
  
 2. ENHANCE COMPLETE PHARMACY INVOICE OPTION
  
    The Complete Pharmacy Invoice [FBAA COMPLETE PHARMACY INVOICE] option
    calls a routine that contains a direct global read of the PSDRUG 
    global.  This patch replaces this direct global read with a VA FileMan 
    call in support of the Pharmacy Encapsulation project.
  
    Additionally, this option will now display the answers to the "Was a 
    Generic Drug issued to patient" and "Enter VA Generic Drug equivalent" 
    questions that are asked during the pharmacy review.  This information
    will appear on a line before the optional pharmacy remarks.  For
    example:
  
  Drug Name                          RX #   Strength    Qty   Amt Claimed
  =======================================================================
  TEST DRUG                         60456789 10MG       10       15
  
     Generic Drug Issued: NO  Generic Drug Name: DRUG NAME 10MG TAB
  
      Pharmacy Remarks: TEST
  MEDICAID DISPENSING FEE: 2.60//
  
  
 This patch addresses the following New Service Request (NSR):
 -------------------------------------------------------------
 There is no NSR associated with this patch.
  
  
 This patch addresses the following NOIS/Remedy Ticket(s):
 ---------------------------------------------------------
 There are no NOIS/Remedy tickets associated with this patch.
  
  
 COMPONENTS SENT WITH PATCH
 --------------------------
  
 The following is a list of the routines included in this patch.  
 The second line of each of these routines now looks like: 
   
      ;;3.5;FEE BASIS;**[patch list]**;JAN 30, 1995 
   
                 CHECK^XTSUMBLD results
  
   Routine     Before Patch   After Patch   Patch List 
   -------     ------------   -----------   ----------
   FBAACIE     11039954       10402233       38,61,91
   FBAAPP      18001937       12586416       61,80,91
   FBAAPP0     3413335        3344844        61,91
   FBXIP91     new            1573405        91
   
 Total number of routines - 4
  
   
 The following is a list of files included in this patch:
  
                                      UP    SEND  DATA                
                                      DATE  SEC.  COMES  SITE   RSLV  
 FILE #  NAME                         DD    CODE  W/FILE DATA   PTS 
 --------------------------------------------------------------------
 162.1   FEE BASIS PHARMACY INVOICE   YES   YES   NO
  
  
 The following is a list of fields included in this patch:
  
 Field Name (Number)             File Name (Number)
 -------------------             ------------------
 SUBSTITUTE GENERIC DRUG (#8.5)  FEE BASIS PHARMACY INVOICE (#162.1)
  
  
 Test Sites:
 -----------
 Bay Pines VAMC
 Tampa VAMC
 Syracuse (Upstate New York HCS)
  
  
 Pre/Post Installation Overview
 ------------------------------
 The installer can optionally delete the FBXIP91 post install routine.
  
  
        ================INSTALLATION INSTRUCTIONS =================
  
 If installed during the normal workday, it is recommended that the 
 following selection(s) in the OPTION (#19) file, and all of their 
 descendants be disabled to prevent possible conflicts while running the 
 KIDS Install. Other VISTA users will not be affected.
  
     Review Fee Prescription [FBAA PHARMACY REVIEW]  
     Complete Pharmacy Invoice [FBAA COMPLETE PHARMACY INVOICE]
     List Invoices Pending MAS Completion [FBAA PENDING MAS COMPLETION]
  
 Install Time - less than 10 minutes
  
  
 1.  LOAD TRANSPORT GLOBAL 
     ---------------------
     Choose the PackMan message containing this patch and invoke the 
     INSTALL/CHECK MESSAGE PackMan option.  
              
 2.  START UP KIDS 
     -------------
     Start up the Kernel Installation and Distribution System Menu 
     [XPD MAIN]: 
    
          Edits and Distribution ...  
          Utilities ...  
          Installation ...  
    
 Select Kernel Installation & Distribution System Option: INStallation 
                                                          ---
          Load a Distribution 
          Print Transport Global 
          Compare Transport Global to Current System 
          Verify Checksums in Transport Global 
          Install Package(s) 
          Restart Install of Package(s) 
          Unload a Distribution 
          Backup a Transport Global 
    
 Select Installation Option: 
    
 3.  Select Installation Option: 
     ---------------------------
     NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
            NAME, enter FB*3.5*91):
       
     a.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
     b.  Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when this patch
         is installed.  It compares all components of this patch
         (routines, DD's, templates, etc.).
     c.  Verify Checksums in Transport Global - This option will allow
         you to ensure the integrity of the routines that are in the
         transport global.
      
 4.  Select Installation Option: Install Package(s) 
                                 ------------------
     **This is the step to start the installation of this KIDS patch: 
    
     a.  Choose the Install Package(s) option to start the patch
         install.
     b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? 
         YES//' answer NO
     c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
         Options, and Protocols? YES//' answer YES
     d.  When prompted 'Enter options you wish to mark as 'Out Of
         Order':'  Enter the following options:
   
         Review Fee Prescription [FBAA PHARMACY REVIEW]  
         Complete Pharmacy Invoice [FBAA COMPLETE PHARMACY INVOICE]
         List Invoices Pending MAS Completion [FBAA PENDING MAS COMPLETION]
  
     e.  When prompted 'Enter protocols you wish to mark as 'Out Of
         Order':' press <return>.
  
  
 ************** POST-INSTALLATION INSTRUCTIONS **************
  
 5.  DELETE INSTALL ROUTINE FROM SYSTEM
     -----------------------------------
     (Optional) Delete the FBXIP91 post install routine.
  
 ***********************************************************
 

Routine Information:
====================

Routine Name:
  - FBAACIE

 Replaced the direct global read of PSDRUG with a FileMan call.  Modified 
 the code that displays the generic drug information during completion of 
 a pharmacy invoice.

Routine Checksum:

Routine Name:
  - FBAAPP

 Modified how user responses are retained and how variables are initialized
 to fix problems with the edit after review functionality.

Routine Checksum:

Routine Name:
  - FBAAPP0

 Modified to save an appropriate internal value to the SUBSTITUE GENERIC
 DRUG field.

Routine Checksum:

Routine Name:
  - FBXIP91

 Post install routine to correct invalid data in field #8.5 of subfile
 #162.11.
 

Routine Checksum:

=============================================================================
User Information:
Entered By  : BAUMANN,SCOTT A               Date Entered  : APR 11, 2005
Completed By: KUREK,STANLEY M               Date Completed: AUG 04, 2005
Released By : BOTTINI,STEVE                 Date Released : AUG 10, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
