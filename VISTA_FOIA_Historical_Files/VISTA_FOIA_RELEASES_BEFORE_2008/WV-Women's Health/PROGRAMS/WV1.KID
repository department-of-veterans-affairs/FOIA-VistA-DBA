KIDS Distribution saved on Sep 29, 1998@15:13:24
WOMEN'S HEALTH V1.0
**KIDS**:WOMEN'S HEALTH 1.0^

**INSTALL NAME**
WOMEN'S HEALTH 1.0
"BLD",1246,0)
WOMEN'S HEALTH 1.0^WOMEN'S HEALTH^0^2980925^y
"BLD",1246,1,0)
^^2^2^2980923^
"BLD",1246,1,1,0)
This KIDS Build contains all the components needed to install the Women's
"BLD",1246,1,2,0)
Health v1.0 software package.
"BLD",1246,4,0)
^9.64PA^790.72^21
"BLD",1246,4,790,0)
790
"BLD",1246,4,790,222)
y^y^f^^^^n
"BLD",1246,4,790.01,0)
790.01
"BLD",1246,4,790.01,222)
y^y^f^^^^n
"BLD",1246,4,790.02,0)
790.02
"BLD",1246,4,790.02,222)
y^y^f^^^^n
"BLD",1246,4,790.03,0)
790.03
"BLD",1246,4,790.03,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.04,0)
790.04
"BLD",1246,4,790.04,222)
y^y^f^^^^n
"BLD",1246,4,790.05,0)
790.05
"BLD",1246,4,790.05,222)
y^y^f^^^^n
"BLD",1246,4,790.07,0)
790.07
"BLD",1246,4,790.07,222)
y^y^f^^n^^y^a^n
"BLD",1246,4,790.1,0)
790.1
"BLD",1246,4,790.1,222)
y^y^f^^^^n
"BLD",1246,4,790.2,0)
790.2
"BLD",1246,4,790.2,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.3,0)
790.3
"BLD",1246,4,790.3,222)
y^y^f^^^^n
"BLD",1246,4,790.31,0)
790.31
"BLD",1246,4,790.31,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.32,0)
790.32
"BLD",1246,4,790.32,222)
y^y^f^^^^n
"BLD",1246,4,790.4,0)
790.4
"BLD",1246,4,790.4,222)
y^y^f^^^^n
"BLD",1246,4,790.403,0)
790.403
"BLD",1246,4,790.403,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.404,0)
790.404
"BLD",1246,4,790.404,222)
y^y^f^^n^^y^a^n
"BLD",1246,4,790.405,0)
790.405
"BLD",1246,4,790.405,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.5,0)
790.5
"BLD",1246,4,790.5,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.51,0)
790.51
"BLD",1246,4,790.51,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.6,0)
790.6
"BLD",1246,4,790.6,222)
y^y^f^^n^^y^m^n
"BLD",1246,4,790.71,0)
790.71
"BLD",1246,4,790.71,222)
y^y^f^^^^n
"BLD",1246,4,790.72,0)
790.72
"BLD",1246,4,790.72,222)
y^y^f^^^^n
"BLD",1246,4,"B",790,790)

"BLD",1246,4,"B",790.01,790.01)

"BLD",1246,4,"B",790.02,790.02)

"BLD",1246,4,"B",790.03,790.03)

"BLD",1246,4,"B",790.04,790.04)

"BLD",1246,4,"B",790.05,790.05)

"BLD",1246,4,"B",790.07,790.07)

"BLD",1246,4,"B",790.1,790.1)

"BLD",1246,4,"B",790.2,790.2)

"BLD",1246,4,"B",790.3,790.3)

"BLD",1246,4,"B",790.31,790.31)

"BLD",1246,4,"B",790.32,790.32)

"BLD",1246,4,"B",790.4,790.4)

"BLD",1246,4,"B",790.403,790.403)

"BLD",1246,4,"B",790.404,790.404)

"BLD",1246,4,"B",790.405,790.405)

"BLD",1246,4,"B",790.5,790.5)

"BLD",1246,4,"B",790.51,790.51)

"BLD",1246,4,"B",790.6,790.6)

"BLD",1246,4,"B",790.71,790.71)

"BLD",1246,4,"B",790.72,790.72)

"BLD",1246,"ABNS",0)
^9.66A^1^1
"BLD",1246,"ABNS",1,0)
WV
"BLD",1246,"ABNS",1,1,0)
^9.661A^^
"BLD",1246,"ABNS","B","WV",1)

"BLD",1246,"ABPKG")
n^n^
"BLD",1246,"INI")
WVPRE
"BLD",1246,"INIT")
WVPOST
"BLD",1246,"KRN",0)
^9.67PA^19^18
"BLD",1246,"KRN",.4,0)
.4
"BLD",1246,"KRN",.4,"NM",0)
^9.68A^4^4
"BLD",1246,"KRN",.4,"NM",1,0)
WV PRINT DIAG CODE TRANSLATION    FILE #790.32^790.32^0
"BLD",1246,"KRN",.4,"NM",2,0)
WV PRINT NOTIF PURPOSE&LETTER    FILE #790.404^790.404^0
"BLD",1246,"KRN",.4,"NM",3,0)
WV PRINT PROC TYPE & ATTRIBS    FILE #790.2^790.2^0
"BLD",1246,"KRN",.4,"NM",4,0)
WV PRINT RES/DIAG SYNONYMS    FILE #790.31^790.31^0
"BLD",1246,"KRN",.4,"NM","B","WV PRINT DIAG CODE TRANSLATION    FILE #790.32",1)

"BLD",1246,"KRN",.4,"NM","B","WV PRINT NOTIF PURPOSE&LETTER    FILE #790.404",2)

"BLD",1246,"KRN",.4,"NM","B","WV PRINT PROC TYPE & ATTRIBS    FILE #790.2",3)

"BLD",1246,"KRN",.4,"NM","B","WV PRINT RES/DIAG SYNONYMS    FILE #790.31",4)

"BLD",1246,"KRN",.401,0)
.401
"BLD",1246,"KRN",.402,0)
.402
"BLD",1246,"KRN",.403,0)
.403
"BLD",1246,"KRN",.403,"NM",0)
^9.68A^13^9
"BLD",1246,"KRN",.403,"NM",1,0)
WV NOTIF-FORM-1    FILE #790.4^790.4^0
"BLD",1246,"KRN",.403,"NM",2,0)
WV NOTIF-FORM-2    FILE #790.4^790.4^0
"BLD",1246,"KRN",.403,"NM",3,0)
WV NOTIFPURPOSE-FORM-1    FILE #790.404^790.404^0
"BLD",1246,"KRN",.403,"NM",4,0)
WV PATIENT-FORM-1    FILE #790^790^0
"BLD",1246,"KRN",.403,"NM",5,0)
WV PROC-FORM-1    FILE #790.1^790.1^0
"BLD",1246,"KRN",.403,"NM",6,0)
WV PROC-FORM-2-COLP    FILE #790.1^790.1^0
"BLD",1246,"KRN",.403,"NM",11,0)
WV REFUSED PROCEDURE-ENTRY    FILE #790.3^790.3^0
"BLD",1246,"KRN",.403,"NM",12,0)
WV SITE PARAMS-FORM-1    FILE #790.02^790.02^0
"BLD",1246,"KRN",.403,"NM",13,0)
WV PROC-FORM-LAB    FILE #790.1^790.1^0
"BLD",1246,"KRN",.403,"NM","B","WV NOTIF-FORM-1    FILE #790.4",1)

"BLD",1246,"KRN",.403,"NM","B","WV NOTIF-FORM-2    FILE #790.4",2)

"BLD",1246,"KRN",.403,"NM","B","WV NOTIFPURPOSE-FORM-1    FILE #790.404",3)

"BLD",1246,"KRN",.403,"NM","B","WV PATIENT-FORM-1    FILE #790",4)

"BLD",1246,"KRN",.403,"NM","B","WV PROC-FORM-1    FILE #790.1",5)

"BLD",1246,"KRN",.403,"NM","B","WV PROC-FORM-2-COLP    FILE #790.1",6)

"BLD",1246,"KRN",.403,"NM","B","WV PROC-FORM-LAB    FILE #790.1",13)

"BLD",1246,"KRN",.403,"NM","B","WV REFUSED PROCEDURE-ENTRY    FILE #790.3",11)

"BLD",1246,"KRN",.403,"NM","B","WV SITE PARAMS-FORM-1    FILE #790.02",12)

"BLD",1246,"KRN",.5,0)
.5
"BLD",1246,"KRN",.5,"NM",0)
^9.68A^^0
"BLD",1246,"KRN",.84,0)
.84
"BLD",1246,"KRN",3.6,0)
3.6
"BLD",1246,"KRN",3.8,0)
3.8
"BLD",1246,"KRN",9.2,0)
9.2
"BLD",1246,"KRN",9.8,0)
9.8
"BLD",1246,"KRN",9.8,"NM",0)
^9.68A^70^67
"BLD",1246,"KRN",9.8,"NM",1,0)
WVBRDUP^^0^B5978368
"BLD",1246,"KRN",9.8,"NM",2,0)
WVBRNED^^0^B23443187
"BLD",1246,"KRN",9.8,"NM",3,0)
WVBRNED1^^0^B8550078
"BLD",1246,"KRN",9.8,"NM",4,0)
WVBRNEDH^^0^B6034170
"BLD",1246,"KRN",9.8,"NM",5,0)
WVBRNOT^^0^B13589756
"BLD",1246,"KRN",9.8,"NM",6,0)
WVBRNOT1^^0^B9549421
"BLD",1246,"KRN",9.8,"NM",7,0)
WVBRNOT2^^0^B32034061
"BLD",1246,"KRN",9.8,"NM",8,0)
WVBRPCD^^0^B19175638
"BLD",1246,"KRN",9.8,"NM",9,0)
WVBRPCD1^^0^B8655034
"BLD",1246,"KRN",9.8,"NM",10,0)
WVBRPCD2^^0^B18857754
"BLD",1246,"KRN",9.8,"NM",11,0)
WVBRPCD3^^0^B10799734
"BLD",1246,"KRN",9.8,"NM",12,0)
WVCMGR^^0^B11962075
"BLD",1246,"KRN",9.8,"NM",13,0)
WVDIAG^^0^B26508465
"BLD",1246,"KRN",9.8,"NM",14,0)
WVDIAGS^^0^B4731594
"BLD",1246,"KRN",9.8,"NM",15,0)
WVEXPTRA^^0^B33235957
"BLD",1246,"KRN",9.8,"NM",16,0)
WVFACE^^0^B3405696
"BLD",1246,"KRN",9.8,"NM",17,0)
WVFMAN^^0^B7209884
"BLD",1246,"KRN",9.8,"NM",18,0)
WVGETALL^^0^B49945085
"BLD",1246,"KRN",9.8,"NM",19,0)
WVLETDQ^^0^B4180335
"BLD",1246,"KRN",9.8,"NM",20,0)
WVLETPR^^0^B31979205
"BLD",1246,"KRN",9.8,"NM",21,0)
WVLOGO^^0^B4306931
"BLD",1246,"KRN",9.8,"NM",23,0)
WVMGRP^^0^B8254083
"BLD",1246,"KRN",9.8,"NM",24,0)
WVNOTIF^^0^B20488699
"BLD",1246,"KRN",9.8,"NM",25,0)
WVNOTIF1^^0^B5386446
"BLD",1246,"KRN",9.8,"NM",26,0)
WVPATE^^0^B6955411
"BLD",1246,"KRN",9.8,"NM",27,0)
WVPATP^^0^B18965275
"BLD",1246,"KRN",9.8,"NM",28,0)
WVPOST^^0^B10391856
"BLD",1246,"KRN",9.8,"NM",30,0)
WVPRE^^0^B19221992
"BLD",1246,"KRN",9.8,"NM",31,0)
WVPROC^^0^B38804391
"BLD",1246,"KRN",9.8,"NM",32,0)
WVPROC1^^0^B5871495
"BLD",1246,"KRN",9.8,"NM",33,0)
WVPROF^^0^B9861932
"BLD",1246,"KRN",9.8,"NM",34,0)
WVPROF1^^0^B5653002
"BLD",1246,"KRN",9.8,"NM",35,0)
WVPROF2^^0^B21646080
"BLD",1246,"KRN",9.8,"NM",36,0)
WVPROF3^^0^B20962361
"BLD",1246,"KRN",9.8,"NM",37,0)
WVPRPCD^^0^B21766511
"BLD",1246,"KRN",9.8,"NM",38,0)
WVPURP^^0^B14528456
"BLD",1246,"KRN",9.8,"NM",39,0)
WVRAD^^0^B2023390
"BLD",1246,"KRN",9.8,"NM",40,0)
WVRADWP^^0^B23566212
"BLD",1246,"KRN",9.8,"NM",41,0)
WVRALINK^^0^B41871307
"BLD",1246,"KRN",9.8,"NM",42,0)
WVREFUSE^^0^B10329454
"BLD",1246,"KRN",9.8,"NM",43,0)
WVRPPCD^^0^B23484200
"BLD",1246,"KRN",9.8,"NM",44,0)
WVRPPCD1^^0^B29664296
"BLD",1246,"KRN",9.8,"NM",45,0)
WVRPPCD2^^0^B59065887
"BLD",1246,"KRN",9.8,"NM",46,0)
WVRPSCR^^0^B16852245
"BLD",1246,"KRN",9.8,"NM",47,0)
WVRPSCR1^^0^B37305325
"BLD",1246,"KRN",9.8,"NM",48,0)
WVRPSCR2^^0^B6523050
"BLD",1246,"KRN",9.8,"NM",49,0)
WVRPSNP^^0^B38798701
"BLD",1246,"KRN",9.8,"NM",50,0)
WVRPSNP1^^0^B20919517
"BLD",1246,"KRN",9.8,"NM",51,0)
WVRPSNPR^^0^B3253058
"BLD",1246,"KRN",9.8,"NM",52,0)
WVSELECT^^0^B7638089
"BLD",1246,"KRN",9.8,"NM",53,0)
WVSITE^^0^B2489970
"BLD",1246,"KRN",9.8,"NM",54,0)
WVUTL1^^0^B37895415
"BLD",1246,"KRN",9.8,"NM",55,0)
WVUTL1A^^0^B31120754
"BLD",1246,"KRN",9.8,"NM",56,0)
WVUTL2^^0^B7741474
"BLD",1246,"KRN",9.8,"NM",57,0)
WVUTL3^^0^B28285559
"BLD",1246,"KRN",9.8,"NM",58,0)
WVUTL4^^0^B11446375
"BLD",1246,"KRN",9.8,"NM",59,0)
WVUTL5^^0^B14051844
"BLD",1246,"KRN",9.8,"NM",60,0)
WVUTL6^^0^B10580576
"BLD",1246,"KRN",9.8,"NM",61,0)
WVUTL7^^0^B39329429
"BLD",1246,"KRN",9.8,"NM",62,0)
WVUTL8^^0^B22896992
"BLD",1246,"KRN",9.8,"NM",63,0)
WVYNOTP^^0^B8467510
"BLD",1246,"KRN",9.8,"NM",64,0)
WVRPST^^0^B14952893
"BLD",1246,"KRN",9.8,"NM",66,0)
WVENV^^0^B2315422
"BLD",1246,"KRN",9.8,"NM",67,0)
WVLAB^^0^B2043349
"BLD",1246,"KRN",9.8,"NM",68,0)
WVLABLG^^0^B26356818
"BLD",1246,"KRN",9.8,"NM",69,0)
WVLABLG1^^0^B8011731
"BLD",1246,"KRN",9.8,"NM",70,0)
WVLABLG2^^0^B4033277
"BLD",1246,"KRN",9.8,"NM","B","WVBRDUP",1)

"BLD",1246,"KRN",9.8,"NM","B","WVBRNED",2)

"BLD",1246,"KRN",9.8,"NM","B","WVBRNED1",3)

"BLD",1246,"KRN",9.8,"NM","B","WVBRNEDH",4)

"BLD",1246,"KRN",9.8,"NM","B","WVBRNOT",5)

"BLD",1246,"KRN",9.8,"NM","B","WVBRNOT1",6)

"BLD",1246,"KRN",9.8,"NM","B","WVBRNOT2",7)

"BLD",1246,"KRN",9.8,"NM","B","WVBRPCD",8)

"BLD",1246,"KRN",9.8,"NM","B","WVBRPCD1",9)

"BLD",1246,"KRN",9.8,"NM","B","WVBRPCD2",10)

"BLD",1246,"KRN",9.8,"NM","B","WVBRPCD3",11)

"BLD",1246,"KRN",9.8,"NM","B","WVCMGR",12)

"BLD",1246,"KRN",9.8,"NM","B","WVDIAG",13)

"BLD",1246,"KRN",9.8,"NM","B","WVDIAGS",14)

"BLD",1246,"KRN",9.8,"NM","B","WVENV",66)

"BLD",1246,"KRN",9.8,"NM","B","WVEXPTRA",15)

"BLD",1246,"KRN",9.8,"NM","B","WVFACE",16)

"BLD",1246,"KRN",9.8,"NM","B","WVFMAN",17)

"BLD",1246,"KRN",9.8,"NM","B","WVGETALL",18)

"BLD",1246,"KRN",9.8,"NM","B","WVLAB",67)

"BLD",1246,"KRN",9.8,"NM","B","WVLABLG",68)

"BLD",1246,"KRN",9.8,"NM","B","WVLABLG1",69)

"BLD",1246,"KRN",9.8,"NM","B","WVLABLG2",70)

"BLD",1246,"KRN",9.8,"NM","B","WVLETDQ",19)

"BLD",1246,"KRN",9.8,"NM","B","WVLETPR",20)

"BLD",1246,"KRN",9.8,"NM","B","WVLOGO",21)

"BLD",1246,"KRN",9.8,"NM","B","WVMGRP",23)

"BLD",1246,"KRN",9.8,"NM","B","WVNOTIF",24)

"BLD",1246,"KRN",9.8,"NM","B","WVNOTIF1",25)

"BLD",1246,"KRN",9.8,"NM","B","WVPATE",26)

"BLD",1246,"KRN",9.8,"NM","B","WVPATP",27)

"BLD",1246,"KRN",9.8,"NM","B","WVPOST",28)

"BLD",1246,"KRN",9.8,"NM","B","WVPRE",30)

"BLD",1246,"KRN",9.8,"NM","B","WVPROC",31)

"BLD",1246,"KRN",9.8,"NM","B","WVPROC1",32)

"BLD",1246,"KRN",9.8,"NM","B","WVPROF",33)

"BLD",1246,"KRN",9.8,"NM","B","WVPROF1",34)

"BLD",1246,"KRN",9.8,"NM","B","WVPROF2",35)

"BLD",1246,"KRN",9.8,"NM","B","WVPROF3",36)

"BLD",1246,"KRN",9.8,"NM","B","WVPRPCD",37)

"BLD",1246,"KRN",9.8,"NM","B","WVPURP",38)

"BLD",1246,"KRN",9.8,"NM","B","WVRAD",39)

"BLD",1246,"KRN",9.8,"NM","B","WVRADWP",40)

"BLD",1246,"KRN",9.8,"NM","B","WVRALINK",41)

"BLD",1246,"KRN",9.8,"NM","B","WVREFUSE",42)

"BLD",1246,"KRN",9.8,"NM","B","WVRPPCD",43)

"BLD",1246,"KRN",9.8,"NM","B","WVRPPCD1",44)

"BLD",1246,"KRN",9.8,"NM","B","WVRPPCD2",45)

"BLD",1246,"KRN",9.8,"NM","B","WVRPSCR",46)

"BLD",1246,"KRN",9.8,"NM","B","WVRPSCR1",47)

"BLD",1246,"KRN",9.8,"NM","B","WVRPSCR2",48)

"BLD",1246,"KRN",9.8,"NM","B","WVRPSNP",49)

"BLD",1246,"KRN",9.8,"NM","B","WVRPSNP1",50)

"BLD",1246,"KRN",9.8,"NM","B","WVRPSNPR",51)

"BLD",1246,"KRN",9.8,"NM","B","WVRPST",64)

"BLD",1246,"KRN",9.8,"NM","B","WVSELECT",52)

"BLD",1246,"KRN",9.8,"NM","B","WVSITE",53)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL1",54)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL1A",55)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL2",56)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL3",57)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL4",58)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL5",59)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL6",60)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL7",61)

"BLD",1246,"KRN",9.8,"NM","B","WVUTL8",62)

"BLD",1246,"KRN",9.8,"NM","B","WVYNOTP",63)

"BLD",1246,"KRN",19,0)
19
"BLD",1246,"KRN",19,"NM",0)
^9.68A^54^52
"BLD",1246,"KRN",19,"NM",1,0)
WV ADD A NEW NOTIFICATION^^0
"BLD",1246,"KRN",19,"NM",2,0)
WV ADD A NEW PROCEDURE^^0
"BLD",1246,"KRN",19,"NM",3,0)
WV ADD AN HISTORICAL PROCEDURE^^0
"BLD",1246,"KRN",19,"NM",4,0)
WV ADD/EDIT CASE MANAGERS^^0
"BLD",1246,"KRN",19,"NM",5,0)
WV ADD/EDIT NOT PURPOSE&LETTER^^0
"BLD",1246,"KRN",19,"NM",6,0)
WV ADD/EDIT NOTIF OUTCOME^^0
"BLD",1246,"KRN",19,"NM",7,0)
WV ADD/EDIT REFERRAL SOURCE^^0
"BLD",1246,"KRN",19,"NM",8,0)
WV AUTOLOAD PATIENTS^^0
"BLD",1246,"KRN",19,"NM",9,0)
WV BROWSE NEEDS PAST DUE^^0
"BLD",1246,"KRN",19,"NM",10,0)
WV BROWSE NOTIFICATIONS^^0
"BLD",1246,"KRN",19,"NM",11,0)
WV BROWSE PROCEDURES^^0
"BLD",1246,"KRN",19,"NM",12,0)
WV BROWSE PROCEDURES DUPLICATE^^0
"BLD",1246,"KRN",19,"NM",13,0)
WV EDIT DIAG TRANSLATION^^0
"BLD",1246,"KRN",19,"NM",14,0)
WV EDIT NOTIF TYPE SYNONYM^^0
"BLD",1246,"KRN",19,"NM",15,0)
WV EDIT NOTIFICATION^^0
"BLD",1246,"KRN",19,"NM",16,0)
WV EDIT PAP REGIMEN LOG^^0
"BLD",1246,"KRN",19,"NM",17,0)
WV EDIT PATIENT CASE DATA^^0
"BLD",1246,"KRN",19,"NM",18,0)
WV EDIT PREGNANCY LOG^^0
"BLD",1246,"KRN",19,"NM",19,0)
WV EDIT PROCEDURE^^0
"BLD",1246,"KRN",19,"NM",20,0)
WV EDIT RES/DIAG SYNONYMS^^0
"BLD",1246,"KRN",19,"NM",21,0)
WV EDIT SITE PARAMETERS^^0
"BLD",1246,"KRN",19,"NM",22,0)
WV MENU-FILE MAINTENANCE^^0
"BLD",1246,"KRN",19,"NM",23,0)
WV MENU-MANAGEMENT REPORTS^^0
"BLD",1246,"KRN",19,"NM",24,0)
WV MENU-MANAGER'S FUNCTIONS^^0
"BLD",1246,"KRN",19,"NM",25,0)
WV MENU-MGR PATIENT MGT^^0
"BLD",1246,"KRN",19,"NM",26,0)
WV MENU-PATIENT MANAGEMENT^^0
"BLD",1246,"KRN",19,"NM",27,0)
WV PATIENT DEMOGRAPHIC INFO^^0
"BLD",1246,"KRN",19,"NM",28,0)
WV PATIENT PROFILE^^0
"BLD",1246,"KRN",19,"NM",30,0)
WV PATIENT PROFILE W/ERRORS^^0
"BLD",1246,"KRN",19,"NM",31,0)
WV PRINT A PROCEDURE^^0
"BLD",1246,"KRN",19,"NM",32,0)
WV PRINT COMPLIANCE RATES^^0
"BLD",1246,"KRN",19,"NM",33,0)
WV PRINT DIAG TRANSLATION^^0
"BLD",1246,"KRN",19,"NM",34,0)
WV PRINT INDIVIDUAL LETTERS^^0
"BLD",1246,"KRN",19,"NM",35,0)
WV PRINT NOTIF PURPOSE&LETTER^^0
"BLD",1246,"KRN",19,"NM",36,0)
WV PRINT PROCEDURE STATS^^0
"BLD",1246,"KRN",19,"NM",37,0)
WV PRINT QUEUED LETTERS^^0
"BLD",1246,"KRN",19,"NM",38,0)
WV PRINT RES/DIAG FILE^^0
"BLD",1246,"KRN",19,"NM",39,0)
WV PRINT RES/DIAG SYNONYMS^^0
"BLD",1246,"KRN",19,"NM",40,0)
WV PRINT SNAPSHOT^^0
"BLD",1246,"KRN",19,"NM",41,0)
WV PRINT/RETRIEVE SNAPSHOT^^0
"BLD",1246,"KRN",19,"NM",42,0)
WV REFUSED PROC-ADD^^0
"BLD",1246,"KRN",19,"NM",43,0)
WV REFUSED PROC-EDIT^^0
"BLD",1246,"KRN",19,"NM",44,0)
WV TRANSFER CASE MANAGER^^0
"BLD",1246,"KRN",19,"NM",45,0)
WVMENU^^0
"BLD",1246,"KRN",19,"NM",46,0)
WV SEXUAL TRAUMA SUMMARY^^0
"BLD",1246,"KRN",19,"NM",47,0)
WV IMPORT RAD/NM EXAMS^^0
"BLD",1246,"KRN",19,"NM",48,0)
WV MENU-LAB DATA ENTRY^^0
"BLD",1246,"KRN",19,"NM",49,0)
WV LAB ADD A NEW PROCEDURE^^0
"BLD",1246,"KRN",19,"NM",50,0)
WV LAB EDIT ACCESSION^^0
"BLD",1246,"KRN",19,"NM",52,0)
WV LAB PRINT LOG^^0
"BLD",1246,"KRN",19,"NM",53,0)
WV LINE FOR MENUS^^0
"BLD",1246,"KRN",19,"NM",54,0)
WV LAB EDIT PROCEDURE RESULT^^0
"BLD",1246,"KRN",19,"NM","B","WV ADD A NEW NOTIFICATION",1)

"BLD",1246,"KRN",19,"NM","B","WV ADD A NEW PROCEDURE",2)

"BLD",1246,"KRN",19,"NM","B","WV ADD AN HISTORICAL PROCEDURE",3)

"BLD",1246,"KRN",19,"NM","B","WV ADD/EDIT CASE MANAGERS",4)

"BLD",1246,"KRN",19,"NM","B","WV ADD/EDIT NOT PURPOSE&LETTER",5)

"BLD",1246,"KRN",19,"NM","B","WV ADD/EDIT NOTIF OUTCOME",6)

"BLD",1246,"KRN",19,"NM","B","WV ADD/EDIT REFERRAL SOURCE",7)

"BLD",1246,"KRN",19,"NM","B","WV AUTOLOAD PATIENTS",8)

"BLD",1246,"KRN",19,"NM","B","WV BROWSE NEEDS PAST DUE",9)

"BLD",1246,"KRN",19,"NM","B","WV BROWSE NOTIFICATIONS",10)

"BLD",1246,"KRN",19,"NM","B","WV BROWSE PROCEDURES",11)

"BLD",1246,"KRN",19,"NM","B","WV BROWSE PROCEDURES DUPLICATE",12)

"BLD",1246,"KRN",19,"NM","B","WV EDIT DIAG TRANSLATION",13)

"BLD",1246,"KRN",19,"NM","B","WV EDIT NOTIF TYPE SYNONYM",14)

"BLD",1246,"KRN",19,"NM","B","WV EDIT NOTIFICATION",15)

"BLD",1246,"KRN",19,"NM","B","WV EDIT PAP REGIMEN LOG",16)

"BLD",1246,"KRN",19,"NM","B","WV EDIT PATIENT CASE DATA",17)

"BLD",1246,"KRN",19,"NM","B","WV EDIT PREGNANCY LOG",18)

"BLD",1246,"KRN",19,"NM","B","WV EDIT PROCEDURE",19)

"BLD",1246,"KRN",19,"NM","B","WV EDIT RES/DIAG SYNONYMS",20)

"BLD",1246,"KRN",19,"NM","B","WV EDIT SITE PARAMETERS",21)

"BLD",1246,"KRN",19,"NM","B","WV IMPORT RAD/NM EXAMS",47)

"BLD",1246,"KRN",19,"NM","B","WV LAB ADD A NEW PROCEDURE",49)

"BLD",1246,"KRN",19,"NM","B","WV LAB EDIT ACCESSION",50)

"BLD",1246,"KRN",19,"NM","B","WV LAB EDIT PROCEDURE RESULT",54)

"BLD",1246,"KRN",19,"NM","B","WV LAB PRINT LOG",52)

"BLD",1246,"KRN",19,"NM","B","WV LINE FOR MENUS",53)

"BLD",1246,"KRN",19,"NM","B","WV MENU-FILE MAINTENANCE",22)

"BLD",1246,"KRN",19,"NM","B","WV MENU-LAB DATA ENTRY",48)

"BLD",1246,"KRN",19,"NM","B","WV MENU-MANAGEMENT REPORTS",23)

"BLD",1246,"KRN",19,"NM","B","WV MENU-MANAGER'S FUNCTIONS",24)

"BLD",1246,"KRN",19,"NM","B","WV MENU-MGR PATIENT MGT",25)

"BLD",1246,"KRN",19,"NM","B","WV MENU-PATIENT MANAGEMENT",26)

"BLD",1246,"KRN",19,"NM","B","WV PATIENT DEMOGRAPHIC INFO",27)

"BLD",1246,"KRN",19,"NM","B","WV PATIENT PROFILE",28)

"BLD",1246,"KRN",19,"NM","B","WV PATIENT PROFILE W/ERRORS",30)

"BLD",1246,"KRN",19,"NM","B","WV PRINT A PROCEDURE",31)

"BLD",1246,"KRN",19,"NM","B","WV PRINT COMPLIANCE RATES",32)

"BLD",1246,"KRN",19,"NM","B","WV PRINT DIAG TRANSLATION",33)

"BLD",1246,"KRN",19,"NM","B","WV PRINT INDIVIDUAL LETTERS",34)

"BLD",1246,"KRN",19,"NM","B","WV PRINT NOTIF PURPOSE&LETTER",35)

"BLD",1246,"KRN",19,"NM","B","WV PRINT PROCEDURE STATS",36)

"BLD",1246,"KRN",19,"NM","B","WV PRINT QUEUED LETTERS",37)

"BLD",1246,"KRN",19,"NM","B","WV PRINT RES/DIAG FILE",38)

"BLD",1246,"KRN",19,"NM","B","WV PRINT RES/DIAG SYNONYMS",39)

"BLD",1246,"KRN",19,"NM","B","WV PRINT SNAPSHOT",40)

"BLD",1246,"KRN",19,"NM","B","WV PRINT/RETRIEVE SNAPSHOT",41)

"BLD",1246,"KRN",19,"NM","B","WV REFUSED PROC-ADD",42)

"BLD",1246,"KRN",19,"NM","B","WV REFUSED PROC-EDIT",43)

"BLD",1246,"KRN",19,"NM","B","WV SEXUAL TRAUMA SUMMARY",46)

"BLD",1246,"KRN",19,"NM","B","WV TRANSFER CASE MANAGER",44)

"BLD",1246,"KRN",19,"NM","B","WVMENU",45)

"BLD",1246,"KRN",19.1,0)
19.1
"BLD",1246,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",1246,"KRN",101,0)
101
"BLD",1246,"KRN",409.61,0)
409.61
"BLD",1246,"KRN",771,0)
771
"BLD",1246,"KRN",869.2,0)
869.2
"BLD",1246,"KRN",870,0)
870
"BLD",1246,"KRN",8994,0)
8994
"BLD",1246,"KRN","B",.4,.4)

"BLD",1246,"KRN","B",.401,.401)

"BLD",1246,"KRN","B",.402,.402)

"BLD",1246,"KRN","B",.403,.403)

"BLD",1246,"KRN","B",.5,.5)

"BLD",1246,"KRN","B",.84,.84)

"BLD",1246,"KRN","B",3.6,3.6)

"BLD",1246,"KRN","B",3.8,3.8)

"BLD",1246,"KRN","B",9.2,9.2)

"BLD",1246,"KRN","B",9.8,9.8)

"BLD",1246,"KRN","B",19,19)

"BLD",1246,"KRN","B",19.1,19.1)

"BLD",1246,"KRN","B",101,101)

"BLD",1246,"KRN","B",409.61,409.61)

"BLD",1246,"KRN","B",771,771)

"BLD",1246,"KRN","B",869.2,869.2)

"BLD",1246,"KRN","B",870,870)

"BLD",1246,"KRN","B",8994,8994)

"BLD",1246,"PRE")
WVENV
"BLD",1246,"QUES",0)
^9.62^^
"BLD",1246,"REQB",0)
^9.611^^
"DATA",790.03,1,0)
Pqy (annually)^6
"DATA",790.03,2,0)
Pq6mx2, Pqy^5
"DATA",790.03,3,0)
Pq4mx3, Pq6mx2, Pqy^4
"DATA",790.03,4,0)
P/Cq3m to 32wkga, P6wkpp, C8-12wkpp^1
"DATA",790.03,5,0)
P6wkpp, C8-12wkpp^2
"DATA",790.03,6,0)
P6wkpp, result, then guidelines^3
"DATA",790.03,7,0)
Other^7
"DATA",790.03,8,0)
Undetermined^8
"DATA",790.03,9,0)
Repeat PAP 3-6m^9
"DATA",790.03,10,0)
Cq6mx3^10
"DATA",790.03,11,0)
To be determined after Colp^11
"DATA",790.03,12,0)
Repeat PAP 6-12wk
"DATA",790.03,13,0)
Treat, then repeat PAP 6-12wk
"DATA",790.03,14,0)
Pq4-6mx2
"DATA",790.03,15,0)
P(midcycle) in 3m
"DATA",790.03,16,0)
Pq6mx4
"DATA",790.07,1,0)
Self^1
"DATA",790.07,2,0)
Provider^1
"DATA",790.07,3,0)
Other^1
"DATA",790.07,4,0)
Unknown^1
"DATA",790.07,5,0)
Health Fair^1
"DATA",790.2,1,0)
PAP SMEAR^PAP^0^PS^^^^^^^^^^^^^^
"DATA",790.2,2,0)
COLPOSCOPY W/BIOPSY^COBX^1^CO^^^^^^^0^^^^^^^^^VAGINAL BIOPSY^VULVAR BIOPSY
"DATA",790.2,3,0)
HYSTERECTOMY^HYST^0^HY^^^^^^^^^^^^^^
"DATA",790.2,4,0)
CRYOTHERAPY^CRYO^0^CY^^^^^^^^^^^^^^
"DATA",790.2,7,0)
ECTOCERVICAL BIOPSY^ECBX^0^EB^^^^^^^^^^^^^^
"DATA",790.2,8,0)
ENDOMETRIAL BIOPSY^EMBX^0^EM^^^^^^^^^^^^^^
"DATA",790.2,17,0)
LEEP^LEEP^1^LP^^^^^^^1^^^^^^^
"DATA",790.2,18,0)
ENDOCERVICAL CURRETTAGE^ECC^0^EC^^^^^^^^^^^^^^
"DATA",790.2,19,0)
CONE BIOPSY^CONE^1^CN^^^^^^^1^^^^^^^
"DATA",790.2,20,0)
PREGNANCY TEST^HCG^0^PT^^^^^^^0^^^^^^^
"DATA",790.2,21,0)
STD EVALUATION^STD^0^ST^^^^^^^^^^^^^^
"DATA",790.2,22,0)
LASER ABLATION^LASA^0^LA^^^^^^^^^^^^^^
"DATA",790.2,23,0)
LASER CONE^LASC^1^LC^^^^^^^1^^^^^^^
"DATA",790.2,24,0)
GYN ONC CONSULT^GYNC^0^GY^^^^^^^^^^^^^^
"DATA",790.2,25,0)
MAMMOGRAM DX BILAT^MAMB^0^MB^^^^76091^^^0^^^^^^^^^DIAGNOSTIC BILATERAL MAM^DX BILATERAL MAM
"DATA",790.2,26,0)
MAMMOGRAM DX UNILAT^MAMU^0^MU^^^^76090^^^0^^^^^^^^^DIAGNOSTIC UNILATERAL MAM^DX UNILATERAL MAM
"DATA",790.2,27,0)
CLINICAL BREAST EXAM^CBE^0^CB^^^^^^^0^^^^^^^
"DATA",790.2,28,0)
MAMMOGRAM SCREENING^MAMS^0^MS^^^^76092^^^0^^^^^^^^^SCREENING MAMMOGRAM
"DATA",790.2,29,0)
GENERAL SURGERY CONSULT^GSCON^0^GS^^^^^^^0^^^^^^^
"DATA",790.2,30,0)
NEEDLE BIOPSY^NDBX^0^NB^^^^^^^0^^^^^^^
"DATA",790.2,31,0)
OPEN BIOPSY^OPBX^0^OB^^^^^^^0^^^^^^^
"DATA",790.2,32,0)
LUMPECTOMY^LMPY^0^LM^^^^^^^0^^^^^^^
"DATA",790.2,33,0)
MASTECTOMY^MAST^0^MT^^^^^^^0^^^^^^^
"DATA",790.2,34,0)
FINE NEEDLE ASPIRATION^FNDL^0^FN^^^^^^^0^^^^^^^
"DATA",790.2,35,0)
STEREOTACTIC BIOPSY^STBX^0^SB^^^^^^^0^^^^^^^
"DATA",790.2,37,0)
COLPOSCOPY IMPRESSION (NO BX)^CIMP^1^CI^^^^^1475^^0^^^^^^^^^VAGINOSCOPY
"DATA",790.2,38,0)
BREAST ULTRASOUND^BRUL^0^BU^^^^76645^^^0^^^^^^^
"DATA",790.31,1,0)
Invasive CA: Cervical^1^1^2^19^17^23^7^18^3^8^^^^^^^^^0^1^^^^^^^
"DATA",790.31,3,0)
HGSIL: CIS/CINIII/CINII^2^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,5,0)
LGSIL: CINI/HPV^3^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,7,0)
Insufficient Tissue^1^^2^17^7^23^19^18^3^8^30^34^35^31^32^33^^^0^2^^^^^^^
"DATA",790.31,8,0)
Error/disregard^95^^^^^^^^^^^^^^^^^^1^2^^1^^^^^
"DATA",790.31,9,0)
Negative^90^20^21^25^26^28^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,10,0)
Positive^6^20^21^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,11,0)
WNL/Normal^90^27^2^19^7^18^8^3^23^17^1^21^^^^^^^0^0^^^^^^^^^NORMAL
"DATA",790.31,12,0)
Unsatisfactory for Dx^2^2^1^19^7^18^3^23^17^25^26^28^^^^^^^0^2^^^^^^^
"DATA",790.31,13,0)
ASCUS^1^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,15,0)
Benign Changes^6^2^19^17^23^7^18^3^8^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,16,0)
HPV/condyloma^3^2^19^17^23^7^^18^3^^^^^^^^^^0^1^1^^^^^^^^Condyloma
"DATA",790.31,17,0)
CIN I/mild dysplasia^3^2^19^17^7^23^18^3^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,18,0)
CIN II/moderate dysplasia^2^2^19^17^23^7^18^3^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,19,0)
CIN III/severe dysplasia^2^2^19^17^7^23^18^3^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,20,0)
Done^92^4^22^^^^^^^^^^^^^^^^0^2^^^^^^^
"DATA",790.31,22,0)
AGCUS, malignant^1^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,24,0)
AGCUS, premalignant^1^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,30,0)
Inflammation/Cervicitis^5^2^19^17^23^7^18^3^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,32,0)
Not Done^99^21^7^^^^^^^^^^^^^^^^0^2^^^^^^^
"DATA",790.31,33,0)
AGCUS^1^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,37,0)
Abnormal Appearing Cervix^2^1^^^^^^^^^^^^^^^^^0^1^0^1^^^^^
"DATA",790.31,39,0)
Other Malignant Neoplasms^1^1^^^^^19^3^23^17^^^^^^^^^0^1^^^^^^^
"DATA",790.31,40,0)
ASCUS, premalignant^1^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,41,0)
ASCUS, malignant^1^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,42,0)
Squamous Cell Carcinoma^1^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,43,0)
Benign Cell Chgs: Other^5^1^^^^^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,44,0)
Benign Cell Chgs: react/atrphy^5^1^^^^^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,45,0)
Benign Endometrial Cells^4^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,46,0)
Benign Cell Chgs: react/inflam^5^1^^^^^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,47,0)
Benign Cell Chgs: Infection^5^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,48,0)
Benign Cell Chgs: react/radiat^5^1^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,49,0)
Benign Cell Chgs: react/IUD^5^1^^^^^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,50,0)
Benign Cell Chgs: react/other^5^1^^^^^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,51,0)
Invasive CA: Other (non-cerv)^1^2^19^7^18^3^23^17^8^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,52,0)
Endometritis^5^8^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,53,0)
Adenomatous Hyperplas w/Atypia^2^8^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,54,0)
Adenomatous Hyperplas w/o Atyp^3^8^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,55,0)
Carcinoma, Non-invasive^1^8^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,56,0)
Benign Finding, Negative^5^25^26^28^^^^^^^^^^^^^^^0^0^^0^^^^^
"DATA",790.31,57,0)
Prbly Benign, Short Int F/U^4^25^26^28^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,58,0)
Suspicious Abnorm, Consider Bx^1^25^26^28^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,59,0)
Highly Sug of Malig, Tk Action^1^25^26^28^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,60,0)
See Patient Chart/Record^10^24^^^^^^^^^^^^^^^^^0^2^^0^^^^^
"DATA",790.31,61,0)
Assessment Is Incomplete^2^25^26^28^^^^^^^^^^^^^^^0^2^^^^^^^
"DATA",790.31,62,0)
Not Indicated^50^25^26^28^^^^^^^^^^^^^^^0^2^^^^^^^
"DATA",790.31,63,0)
Indicated, But Not Performed^5^25^26^28^^^^^^^^^^^^^^^0^2^^^^^^^
"DATA",790.31,64,0)
Benign Findings^6^27^29^30^34^35^31^32^33^^^^^^^^^^0^0^0^0^^^^^
"DATA",790.31,65,0)
Discrete Mass^1^27^^^^^^^^^^^^^^^^^0^1^0^0^^^^^
"DATA",790.31,66,0)
Retraction/Dimpling^1^27^^^^^^^^^^^^^^^^^0^1^0^0^^^^^
"DATA",790.31,67,0)
Bloody Nipple Discharge^1^27^^^^^^^^^^^^^^^^^0^1^0^0^^^^^
"DATA",790.31,68,0)
Nipple/Areolar Scaliness^1^27^^^^^^^^^^^^^^^^^0^1^0^0^^^^^
"DATA",790.31,69,0)
CBE Refused^90^^^^^^^^^^^^^^^^^^0^2^0^0^^^^^
"DATA",790.31,70,0)
HIV^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,71,0)
Chlamydia^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,72,0)
Gonorrhea^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,73,0)
Syphilis^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,74,0)
Trichomoniasis^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,75,0)
Herpes^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,76,0)
2 or more STD's^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,77,0)
3 or more STD's^5^21^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,78,0)
Not Available^90^29^27^2^19^7^18^8^3^23^17^1^21^37^^^^^0^2^0^0^^^^^
"DATA",790.31,79,0)
VIN I^3^2^^^^^^^^^^^^^^^^^0^1^0^^^^^^
"DATA",790.31,80,0)
VIN II^2^2^^^^^^^^^^^^^^^^^0^1^0^^^^^^
"DATA",790.31,81,0)
VIN III^2^2^^^^^^^^^^^^^^^^^0^1^0^^^^^^
"DATA",790.31,82,0)
VAIN I^3^2^^^^^^^^^^^^^^^^^0^1^0^^^^^^
"DATA",790.31,83,0)
VAIN II^2^2^^^^^^^^^^^^^^^^^0^1^0^^^^^^
"DATA",790.31,84,0)
VAIN III^2^2^^^^^^^^^^^^^^^^^0^1^0^^^^^^
"DATA",790.31,85,0)
Pregnant(no bx),Imp:Inflam^6^37^^^^^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,86,0)
Pregnant(no bx),Imp:WNL^90^37^^^^^^^^^^^^^^^^^0^0^^^^^^^
"DATA",790.31,87,0)
Pregnant(no bx),Imp:HPV^3^37^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,88,0)
Pregnant(no bx),Imp:CIN I^3^37^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,89,0)
Pregnant(no bx),Imp:CIN II^2^37^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,90,0)
Pregnant(no bx),Imp:CIN III^2^37^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,91,0)
Pregnant(no bx),Imp:Invasive^1^37^^^^^^^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,92,0)
Atypia^5^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^0^^^^^
"DATA",790.31,93,0)
Carcinoma-in-situ^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,94,0)
Carcinoma-in-situ, NED^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,95,0)
Carcinoma-in-situ, recurrent^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,96,0)
Inflammation^5^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,97,0)
Invasive Ca^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^^^ 
"DATA",790.31,98,0)
Invasive Ca, responding Rx^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,99,0)
Invasive Ca, stable^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,100,0)
Invasive Ca, progressive^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,101,0)
Invasive Ca, NED^1^29^30^34^35^31^32^33^^^^^^^^^^^0^1^^^^^^^
"DATA",790.31,102,0)
Impression: CIN I^3^37^^^^^^^^^^^^^^^^^^1^0^0^^^^^^^CIN I
"DATA",790.31,103,0)
Impression: CIN II^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^CIN II
"DATA",790.31,104,0)
Impression: CIN III^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^CIN III
"DATA",790.31,105,0)
Impression: HPV^3^37^^^^^^^^^^^^^^^^^0^1^1^0^^^^^^^HPV
"DATA",790.31,106,0)
Impression: WNL/Normal^90^37^^^^^^^^^^^^^^^^^0^0^0^^^^^^^^WNL^NORMAL
"DATA",790.31,107,0)
Impression: Inflammation^5^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^Inflam
"DATA",790.31,108,0)
Impression: Invasive CA^1^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^Invasiv
"DATA",790.31,109,0)
Impression: VAIN I^3^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VAIN I
"DATA",790.31,110,0)
Impression: VAIN II^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VAIN II
"DATA",790.31,111,0)
Impression: VAIN III^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VAIN III
"DATA",790.31,112,0)
Impression: VIN I^3^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VIN I
"DATA",790.31,113,0)
Impression: VIN II^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VIN II
"DATA",790.31,114,0)
Impression: VIN III^2^37^^^^^^^^^^^^^^^^^0^1^0^0^^^^^^^VIN III
"DATA",790.31,115,0)
No Discrete Mass^90^38^^^^^^^^^^^^^^^^^0^0^0^0^^^^^
"DATA",790.31,116,0)
Cystic Mass^5^38^^^^^^^^^^^^^^^^^0^1^^0^^^^^
"DATA",790.31,117,0)
Cystic Mass, Complicated^1^38^^^^^^^^^^^^^^^^^0^1^^0^^^^^
"DATA",790.31,118,0)
Solid Mass, Smooth Margins^1^38^^^^^^^^^^^^^^^^^0^1^^0^^^^^
"DATA",790.31,119,0)
Solid Mass, Irregular Margins^1^38^^^^^^^^^^^^^^^^^0^1^^0^^^^^
"DATA",790.31,120,0)
Abnormal/other^1^27^^^^^^^^^^^^^^^^^^1^^^^^^^
"DATA",790.403,1,0)
LETTER, FIRST^1^
"DATA",790.403,2,0)
LETTER, SECOND (CERTIFIED)^1^
"DATA",790.403,3,0)
LETTER, THIRD (CERTIFIED)^1^
"DATA",790.403,4,0)
PHONE CALL, 1ST^0^
"DATA",790.403,5,0)
PHONE CALL, 2ND^0
"DATA",790.403,6,0)
PHONE CALL, 3RD^0
"DATA",790.403,7,0)
MESSAGE VIA PHONE MACHINE^0
"DATA",790.403,8,0)
MESSAGE VIA PERSON^0
"DATA",790.403,9,0)
CONTACT PHN^0
"DATA",790.403,10,0)
CONTACT CHA^0
"DATA",790.403,11,0)
LETTER, SECOND^1^
"DATA",790.403,12,0)
PROVIDER CONSULT^0
"DATA",790.403,13,0)
CONVERSATION WITH PATIENT^0
"DATA",790.404,1,0)
PAP result normal, next PAP 1 year.^3^PN1
"DATA",790.404,1,1,0)
^^43^43^2980623^^
"DATA",790.404,1,1,1,0)
|NOWRAP|
"DATA",790.404,1,1,2,0)
 
"DATA",790.404,1,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,1,1,4,0)
 
"DATA",790.404,1,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,1,1,6,0)
 
"DATA",790.404,1,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,1,1,8,0)
 
"DATA",790.404,1,1,9,0)
 
"DATA",790.404,1,1,10,0)
     |TODAY|
"DATA",790.404,1,1,11,0)
 
"DATA",790.404,1,1,12,0)
 
"DATA",790.404,1,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,1,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,1,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,1,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,1,1,17,0)
 
"DATA",790.404,1,1,18,0)
 
"DATA",790.404,1,1,19,0)
 
"DATA",790.404,1,1,20,0)
 
"DATA",790.404,1,1,21,0)
- -                                                                    - -
"DATA",790.404,1,1,22,0)
 
"DATA",790.404,1,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,1,1,24,0)
 
"DATA",790.404,1,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,1,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,1,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,1,1,28,0)
 
"DATA",790.404,1,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,1,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,1,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,1,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,1,1,33,0)
 
"DATA",790.404,1,1,34,0)
     Sincerely,
"DATA",790.404,1,1,35,0)
 
"DATA",790.404,1,1,36,0)
 
"DATA",790.404,1,1,37,0)
 
"DATA",790.404,1,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,1,1,39,0)
     Women's Health Program
"DATA",790.404,1,1,40,0)
     phone: 777-7777
"DATA",790.404,1,1,41,0)
 
"DATA",790.404,1,1,42,0)
 
"DATA",790.404,1,1,43,0)
     printed: |NOW|
"DATA",790.404,2,0)
PAP result abnormal, schedule colposcopy.^1
"DATA",790.404,2,1,0)
^^43^43^2980623^^
"DATA",790.404,2,1,1,0)
|NOWRAP|
"DATA",790.404,2,1,2,0)
 
"DATA",790.404,2,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,2,1,4,0)
 
"DATA",790.404,2,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,2,1,6,0)
 
"DATA",790.404,2,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,2,1,8,0)
 
"DATA",790.404,2,1,9,0)
 
"DATA",790.404,2,1,10,0)
     |TODAY|
"DATA",790.404,2,1,11,0)
 
"DATA",790.404,2,1,12,0)
 
"DATA",790.404,2,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,2,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,2,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,2,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,2,1,17,0)
 
"DATA",790.404,2,1,18,0)
 
"DATA",790.404,2,1,19,0)
 
"DATA",790.404,2,1,20,0)
 
"DATA",790.404,2,1,21,0)
- -                                                                    - -
"DATA",790.404,2,1,22,0)
 
"DATA",790.404,2,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,2,1,24,0)
 
"DATA",790.404,2,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,2,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,2,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,2,1,28,0)
 
"DATA",790.404,2,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,2,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,2,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,2,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,2,1,33,0)
 
"DATA",790.404,2,1,34,0)
     Sincerely,
"DATA",790.404,2,1,35,0)
 
"DATA",790.404,2,1,36,0)
 
"DATA",790.404,2,1,37,0)
 
"DATA",790.404,2,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,2,1,39,0)
     Women's Health Program
"DATA",790.404,2,1,40,0)
     phone: 777-7777
"DATA",790.404,2,1,41,0)
 
"DATA",790.404,2,1,42,0)
 
"DATA",790.404,2,1,43,0)
     printed: |NOW|
"DATA",790.404,3,0)
PAP result abnormal, next PAP 3 months and colp.^3
"DATA",790.404,3,1,0)
^^43^43^2980623^^
"DATA",790.404,3,1,1,0)
|NOWRAP|
"DATA",790.404,3,1,2,0)
 
"DATA",790.404,3,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,3,1,4,0)
 
"DATA",790.404,3,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,3,1,6,0)
 
"DATA",790.404,3,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,3,1,8,0)
 
"DATA",790.404,3,1,9,0)
 
"DATA",790.404,3,1,10,0)
     |TODAY|
"DATA",790.404,3,1,11,0)
 
"DATA",790.404,3,1,12,0)
 
"DATA",790.404,3,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,3,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,3,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,3,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,3,1,17,0)
 
"DATA",790.404,3,1,18,0)
 
"DATA",790.404,3,1,19,0)
 
"DATA",790.404,3,1,20,0)
 
"DATA",790.404,3,1,21,0)
- -                                                                    - -
"DATA",790.404,3,1,22,0)
 
"DATA",790.404,3,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,3,1,24,0)
 
"DATA",790.404,3,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,3,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,3,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,3,1,28,0)
 
"DATA",790.404,3,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,3,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,3,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,3,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,3,1,33,0)
 
"DATA",790.404,3,1,34,0)
     Sincerely,
"DATA",790.404,3,1,35,0)
 
"DATA",790.404,3,1,36,0)
 
"DATA",790.404,3,1,37,0)
 
"DATA",790.404,3,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,3,1,39,0)
     Women's Health Program
"DATA",790.404,3,1,40,0)
     phone: 777-7777
"DATA",790.404,3,1,41,0)
 
"DATA",790.404,3,1,42,0)
 
"DATA",790.404,3,1,43,0)
     printed: |NOW|
"DATA",790.404,4,0)
PAP result normal, next PAP 6 months.^3
"DATA",790.404,4,1,0)
^^43^43^2980623^^
"DATA",790.404,4,1,1,0)
|NOWRAP|
"DATA",790.404,4,1,2,0)
 
"DATA",790.404,4,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,4,1,4,0)
 
"DATA",790.404,4,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,4,1,6,0)
 
"DATA",790.404,4,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,4,1,8,0)
 
"DATA",790.404,4,1,9,0)
 
"DATA",790.404,4,1,10,0)
     |TODAY|
"DATA",790.404,4,1,11,0)
 
"DATA",790.404,4,1,12,0)
 
"DATA",790.404,4,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,4,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,4,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,4,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,4,1,17,0)
 
"DATA",790.404,4,1,18,0)
 
"DATA",790.404,4,1,19,0)
 
"DATA",790.404,4,1,20,0)
 
"DATA",790.404,4,1,21,0)
- -                                                                    - -
"DATA",790.404,4,1,22,0)
 
"DATA",790.404,4,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,4,1,24,0)
 
"DATA",790.404,4,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,4,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,4,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,4,1,28,0)
 
"DATA",790.404,4,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,4,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,4,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,4,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,4,1,33,0)
 
"DATA",790.404,4,1,34,0)
     Sincerely,
"DATA",790.404,4,1,35,0)
 
"DATA",790.404,4,1,36,0)
 
"DATA",790.404,4,1,37,0)
 
"DATA",790.404,4,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,4,1,39,0)
     Women's Health Program
"DATA",790.404,4,1,40,0)
     phone: 777-7777
"DATA",790.404,4,1,41,0)
 
"DATA",790.404,4,1,42,0)
 
"DATA",790.404,4,1,43,0)
     printed: |NOW|
"DATA",790.404,5,0)
PAP result normal, next PAP 4 months.^3
"DATA",790.404,5,1,0)
^^43^43^2980623^^
"DATA",790.404,5,1,1,0)
|NOWRAP|
"DATA",790.404,5,1,2,0)
 
"DATA",790.404,5,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,5,1,4,0)
 
"DATA",790.404,5,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,5,1,6,0)
 
"DATA",790.404,5,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,5,1,8,0)
 
"DATA",790.404,5,1,9,0)
 
"DATA",790.404,5,1,10,0)
     |TODAY|
"DATA",790.404,5,1,11,0)
 
"DATA",790.404,5,1,12,0)
 
"DATA",790.404,5,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,5,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,5,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,5,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,5,1,17,0)
 
"DATA",790.404,5,1,18,0)
 
"DATA",790.404,5,1,19,0)
 
"DATA",790.404,5,1,20,0)
 
"DATA",790.404,5,1,21,0)
- -                                                                    - -
"DATA",790.404,5,1,22,0)
 
"DATA",790.404,5,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,5,1,24,0)
 
"DATA",790.404,5,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,5,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,5,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,5,1,28,0)
 
"DATA",790.404,5,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,5,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,5,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,5,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,5,1,33,0)
 
"DATA",790.404,5,1,34,0)
     Sincerely,
"DATA",790.404,5,1,35,0)
 
"DATA",790.404,5,1,36,0)
 
"DATA",790.404,5,1,37,0)
 
"DATA",790.404,5,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,5,1,39,0)
     Women's Health Program
"DATA",790.404,5,1,40,0)
     phone: 777-7777
"DATA",790.404,5,1,41,0)
 
"DATA",790.404,5,1,42,0)
 
"DATA",790.404,5,1,43,0)
     printed: |NOW|
"DATA",790.404,6,0)
PAP result abnl, rep PAP 3-6 mos.^3^^1^CX^0
"DATA",790.404,6,1,0)
^^43^43^2980623^^
"DATA",790.404,6,1,1,0)
|NOWRAP|
"DATA",790.404,6,1,2,0)
 
"DATA",790.404,6,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,6,1,4,0)
 
"DATA",790.404,6,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,6,1,6,0)
 
"DATA",790.404,6,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,6,1,8,0)
 
"DATA",790.404,6,1,9,0)
 
"DATA",790.404,6,1,10,0)
     |TODAY|
"DATA",790.404,6,1,11,0)
 
"DATA",790.404,6,1,12,0)
 
"DATA",790.404,6,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,6,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,6,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,6,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,6,1,17,0)
 
"DATA",790.404,6,1,18,0)
 
"DATA",790.404,6,1,19,0)
 
"DATA",790.404,6,1,20,0)
 
"DATA",790.404,6,1,21,0)
- -                                                                    - -
"DATA",790.404,6,1,22,0)
 
"DATA",790.404,6,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,6,1,24,0)
 
"DATA",790.404,6,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,6,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,6,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,6,1,28,0)
 
"DATA",790.404,6,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,6,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,6,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,6,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,6,1,33,0)
 
"DATA",790.404,6,1,34,0)
     Sincerely,
"DATA",790.404,6,1,35,0)
 
"DATA",790.404,6,1,36,0)
 
"DATA",790.404,6,1,37,0)
 
"DATA",790.404,6,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,6,1,39,0)
     Women's Health Program
"DATA",790.404,6,1,40,0)
     phone: 777-7777
"DATA",790.404,6,1,41,0)
 
"DATA",790.404,6,1,42,0)
 
"DATA",790.404,6,1,43,0)
     printed: |NOW|
"DATA",790.404,7,0)
DNKA PAP^1^DP1^1
"DATA",790.404,7,1,0)
^^43^43^2980623^^
"DATA",790.404,7,1,1,0)
|NOWRAP|
"DATA",790.404,7,1,2,0)
 
"DATA",790.404,7,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,7,1,4,0)
 
"DATA",790.404,7,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,7,1,6,0)
 
"DATA",790.404,7,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,7,1,8,0)
 
"DATA",790.404,7,1,9,0)
 
"DATA",790.404,7,1,10,0)
     |TODAY|
"DATA",790.404,7,1,11,0)
 
"DATA",790.404,7,1,12,0)
 
"DATA",790.404,7,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,7,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,7,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,7,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,7,1,17,0)
 
"DATA",790.404,7,1,18,0)
 
"DATA",790.404,7,1,19,0)
 
"DATA",790.404,7,1,20,0)
 
"DATA",790.404,7,1,21,0)
- -                                                                    - -
"DATA",790.404,7,1,22,0)
 
"DATA",790.404,7,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,7,1,24,0)
 
"DATA",790.404,7,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,7,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,7,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,7,1,28,0)
 
"DATA",790.404,7,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,7,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,7,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,7,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,7,1,33,0)
 
"DATA",790.404,7,1,34,0)
     Sincerely,
"DATA",790.404,7,1,35,0)
 
"DATA",790.404,7,1,36,0)
 
"DATA",790.404,7,1,37,0)
 
"DATA",790.404,7,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,7,1,39,0)
     Women's Health Program
"DATA",790.404,7,1,40,0)
     phone: 777-7777
"DATA",790.404,7,1,41,0)
 
"DATA",790.404,7,1,42,0)
 
"DATA",790.404,7,1,43,0)
     printed: |NOW|
"DATA",790.404,8,0)
DNKA PAP^2^DP2^1
"DATA",790.404,8,1,0)
^^43^43^2980623^^
"DATA",790.404,8,1,1,0)
|NOWRAP|
"DATA",790.404,8,1,2,0)
 
"DATA",790.404,8,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,8,1,4,0)
 
"DATA",790.404,8,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,8,1,6,0)
 
"DATA",790.404,8,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,8,1,8,0)
 
"DATA",790.404,8,1,9,0)
 
"DATA",790.404,8,1,10,0)
     |TODAY|
"DATA",790.404,8,1,11,0)
 
"DATA",790.404,8,1,12,0)
 
"DATA",790.404,8,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,8,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,8,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,8,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,8,1,17,0)
 
"DATA",790.404,8,1,18,0)
 
"DATA",790.404,8,1,19,0)
 
"DATA",790.404,8,1,20,0)
 
"DATA",790.404,8,1,21,0)
- -                                                                    - -
"DATA",790.404,8,1,22,0)
 
"DATA",790.404,8,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,8,1,24,0)
 
"DATA",790.404,8,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,8,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,8,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,8,1,28,0)
 
"DATA",790.404,8,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,8,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,8,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,8,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,8,1,33,0)
 
"DATA",790.404,8,1,34,0)
     Sincerely,
"DATA",790.404,8,1,35,0)
 
"DATA",790.404,8,1,36,0)
 
"DATA",790.404,8,1,37,0)
 
"DATA",790.404,8,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,8,1,39,0)
     Women's Health Program
"DATA",790.404,8,1,40,0)
     phone: 777-7777
"DATA",790.404,8,1,41,0)
 
"DATA",790.404,8,1,42,0)
 
"DATA",790.404,8,1,43,0)
     printed: |NOW|
"DATA",790.404,9,0)
DNKA PAP^3^^1
"DATA",790.404,9,1,0)
^^43^43^2980623^^
"DATA",790.404,9,1,1,0)
|NOWRAP|
"DATA",790.404,9,1,2,0)
 
"DATA",790.404,9,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,9,1,4,0)
 
"DATA",790.404,9,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,9,1,6,0)
 
"DATA",790.404,9,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,9,1,8,0)
 
"DATA",790.404,9,1,9,0)
 
"DATA",790.404,9,1,10,0)
     |TODAY|
"DATA",790.404,9,1,11,0)
 
"DATA",790.404,9,1,12,0)
 
"DATA",790.404,9,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,9,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,9,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,9,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,9,1,17,0)
 
"DATA",790.404,9,1,18,0)
 
"DATA",790.404,9,1,19,0)
 
"DATA",790.404,9,1,20,0)
 
"DATA",790.404,9,1,21,0)
- -                                                                    - -
"DATA",790.404,9,1,22,0)
 
"DATA",790.404,9,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,9,1,24,0)
 
"DATA",790.404,9,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,9,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,9,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,9,1,28,0)
 
"DATA",790.404,9,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,9,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,9,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,9,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,9,1,33,0)
 
"DATA",790.404,9,1,34,0)
     Sincerely,
"DATA",790.404,9,1,35,0)
 
"DATA",790.404,9,1,36,0)
 
"DATA",790.404,9,1,37,0)
 
"DATA",790.404,9,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,9,1,39,0)
     Women's Health Program
"DATA",790.404,9,1,40,0)
     phone: 777-7777
"DATA",790.404,9,1,41,0)
 
"DATA",790.404,9,1,42,0)
 
"DATA",790.404,9,1,43,0)
     printed: |NOW|
"DATA",790.404,10,0)
DNKA Colposcopy^1^D3^1
"DATA",790.404,10,1,0)
^^43^43^2980623^^
"DATA",790.404,10,1,1,0)
|NOWRAP|
"DATA",790.404,10,1,2,0)
 
"DATA",790.404,10,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,10,1,4,0)
 
"DATA",790.404,10,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,10,1,6,0)
 
"DATA",790.404,10,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,10,1,8,0)
 
"DATA",790.404,10,1,9,0)
 
"DATA",790.404,10,1,10,0)
     |TODAY|
"DATA",790.404,10,1,11,0)
 
"DATA",790.404,10,1,12,0)
 
"DATA",790.404,10,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,10,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,10,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,10,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,10,1,17,0)
 
"DATA",790.404,10,1,18,0)
 
"DATA",790.404,10,1,19,0)
 
"DATA",790.404,10,1,20,0)
 
"DATA",790.404,10,1,21,0)
- -                                                                    - -
"DATA",790.404,10,1,22,0)
 
"DATA",790.404,10,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,10,1,24,0)
 
"DATA",790.404,10,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,10,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,10,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,10,1,28,0)
 
"DATA",790.404,10,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,10,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,10,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,10,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,10,1,33,0)
 
"DATA",790.404,10,1,34,0)
     Sincerely,
"DATA",790.404,10,1,35,0)
 
"DATA",790.404,10,1,36,0)
 
"DATA",790.404,10,1,37,0)
 
"DATA",790.404,10,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,10,1,39,0)
     Women's Health Program
"DATA",790.404,10,1,40,0)
     phone: 777-7777
"DATA",790.404,10,1,41,0)
 
"DATA",790.404,10,1,42,0)
 
"DATA",790.404,10,1,43,0)
     printed: |NOW|
"DATA",790.404,11,0)
DNKA Colposcopy Follow-up^1^D4^1^CX^0
"DATA",790.404,11,1,0)
^^43^43^2980623^^
"DATA",790.404,11,1,1,0)
|NOWRAP|
"DATA",790.404,11,1,2,0)
 
"DATA",790.404,11,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,11,1,4,0)
 
"DATA",790.404,11,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,11,1,6,0)
 
"DATA",790.404,11,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,11,1,8,0)
 
"DATA",790.404,11,1,9,0)
 
"DATA",790.404,11,1,10,0)
     |TODAY|
"DATA",790.404,11,1,11,0)
 
"DATA",790.404,11,1,12,0)
 
"DATA",790.404,11,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,11,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,11,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,11,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,11,1,17,0)
 
"DATA",790.404,11,1,18,0)
 
"DATA",790.404,11,1,19,0)
 
"DATA",790.404,11,1,20,0)
 
"DATA",790.404,11,1,21,0)
- -                                                                    - -
"DATA",790.404,11,1,22,0)
 
"DATA",790.404,11,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,11,1,24,0)
 
"DATA",790.404,11,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,11,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,11,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,11,1,28,0)
 
"DATA",790.404,11,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,11,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,11,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,11,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,11,1,33,0)
 
"DATA",790.404,11,1,34,0)
     Sincerely,
"DATA",790.404,11,1,35,0)
 
"DATA",790.404,11,1,36,0)
 
"DATA",790.404,11,1,37,0)
 
"DATA",790.404,11,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,11,1,39,0)
     Women's Health Program
"DATA",790.404,11,1,40,0)
     phone: 777-7777
"DATA",790.404,11,1,41,0)
 
"DATA",790.404,11,1,42,0)
 
"DATA",790.404,11,1,43,0)
     printed: |NOW|
"DATA",790.404,12,0)
PREGNANCY Test POSITIVE^2
"DATA",790.404,12,1,0)
^^43^43^2980623^^
"DATA",790.404,12,1,1,0)
|NOWRAP|
"DATA",790.404,12,1,2,0)
 
"DATA",790.404,12,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,12,1,4,0)
 
"DATA",790.404,12,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,12,1,6,0)
 
"DATA",790.404,12,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,12,1,8,0)
 
"DATA",790.404,12,1,9,0)
 
"DATA",790.404,12,1,10,0)
     |TODAY|
"DATA",790.404,12,1,11,0)
 
"DATA",790.404,12,1,12,0)
 
"DATA",790.404,12,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,12,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,12,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,12,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,12,1,17,0)
 
"DATA",790.404,12,1,18,0)
 
"DATA",790.404,12,1,19,0)
 
"DATA",790.404,12,1,20,0)
 
"DATA",790.404,12,1,21,0)
- -                                                                    - -
"DATA",790.404,12,1,22,0)
 
"DATA",790.404,12,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,12,1,24,0)
 
"DATA",790.404,12,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,12,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,12,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,12,1,28,0)
 
"DATA",790.404,12,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,12,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,12,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,12,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,12,1,33,0)
 
"DATA",790.404,12,1,34,0)
     Sincerely,
"DATA",790.404,12,1,35,0)
 
"DATA",790.404,12,1,36,0)
 
"DATA",790.404,12,1,37,0)
 
"DATA",790.404,12,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,12,1,39,0)
     Women's Health Program
"DATA",790.404,12,1,40,0)
     phone: 777-7777
"DATA",790.404,12,1,41,0)
 
"DATA",790.404,12,1,42,0)
 
"DATA",790.404,12,1,43,0)
     printed: |NOW|
"DATA",790.404,13,0)
PREGNANCY Test NEGATIVE^2
"DATA",790.404,13,1,0)
^^43^43^2980623^^
"DATA",790.404,13,1,1,0)
|NOWRAP|
"DATA",790.404,13,1,2,0)
 
"DATA",790.404,13,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,13,1,4,0)
 
"DATA",790.404,13,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,13,1,6,0)
 
"DATA",790.404,13,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,13,1,8,0)
 
"DATA",790.404,13,1,9,0)
 
"DATA",790.404,13,1,10,0)
     |TODAY|
"DATA",790.404,13,1,11,0)
 
"DATA",790.404,13,1,12,0)
 
"DATA",790.404,13,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,13,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,13,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,13,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,13,1,17,0)
 
"DATA",790.404,13,1,18,0)
 
"DATA",790.404,13,1,19,0)
 
"DATA",790.404,13,1,20,0)
 
"DATA",790.404,13,1,21,0)
- -                                                                    - -
"DATA",790.404,13,1,22,0)
 
"DATA",790.404,13,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,13,1,24,0)
 
"DATA",790.404,13,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,13,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,13,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,13,1,28,0)
 
"DATA",790.404,13,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,13,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,13,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,13,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,13,1,33,0)
 
"DATA",790.404,13,1,34,0)
     Sincerely,
"DATA",790.404,13,1,35,0)
 
"DATA",790.404,13,1,36,0)
 
"DATA",790.404,13,1,37,0)
 
"DATA",790.404,13,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,13,1,39,0)
     Women's Health Program
"DATA",790.404,13,1,40,0)
     phone: 777-7777
"DATA",790.404,13,1,41,0)
 
"DATA",790.404,13,1,42,0)
 
"DATA",790.404,13,1,43,0)
     printed: |NOW|
"DATA",790.404,14,0)
PAP, annual due.^3^PA^1^CX^0
"DATA",790.404,14,1,0)
^^43^43^2980623^^
"DATA",790.404,14,1,1,0)
|NOWRAP|
"DATA",790.404,14,1,2,0)
 
"DATA",790.404,14,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,14,1,4,0)
 
"DATA",790.404,14,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,14,1,6,0)
 
"DATA",790.404,14,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,14,1,8,0)
 
"DATA",790.404,14,1,9,0)
 
"DATA",790.404,14,1,10,0)
     |TODAY|
"DATA",790.404,14,1,11,0)
 
"DATA",790.404,14,1,12,0)
 
"DATA",790.404,14,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,14,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,14,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,14,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,14,1,17,0)
 
"DATA",790.404,14,1,18,0)
 
"DATA",790.404,14,1,19,0)
 
"DATA",790.404,14,1,20,0)
 
"DATA",790.404,14,1,21,0)
- -                                                                    - -
"DATA",790.404,14,1,22,0)
 
"DATA",790.404,14,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,14,1,24,0)
 
"DATA",790.404,14,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,14,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,14,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,14,1,28,0)
 
"DATA",790.404,14,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,14,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,14,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,14,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,14,1,33,0)
 
"DATA",790.404,14,1,34,0)
     Sincerely,
"DATA",790.404,14,1,35,0)
 
"DATA",790.404,14,1,36,0)
 
"DATA",790.404,14,1,37,0)
 
"DATA",790.404,14,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,14,1,39,0)
     Women's Health Program
"DATA",790.404,14,1,40,0)
     phone: 777-7777
"DATA",790.404,14,1,41,0)
 
"DATA",790.404,14,1,42,0)
 
"DATA",790.404,14,1,43,0)
     printed: |NOW|
"DATA",790.404,15,0)
PAP result abnormal, PAP 6 weeks P.P.^2
"DATA",790.404,15,1,0)
^^43^43^2980623^^
"DATA",790.404,15,1,1,0)
|NOWRAP|
"DATA",790.404,15,1,2,0)
 
"DATA",790.404,15,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,15,1,4,0)
 
"DATA",790.404,15,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,15,1,6,0)
 
"DATA",790.404,15,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,15,1,8,0)
 
"DATA",790.404,15,1,9,0)
 
"DATA",790.404,15,1,10,0)
     |TODAY|
"DATA",790.404,15,1,11,0)
 
"DATA",790.404,15,1,12,0)
 
"DATA",790.404,15,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,15,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,15,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,15,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,15,1,17,0)
 
"DATA",790.404,15,1,18,0)
 
"DATA",790.404,15,1,19,0)
 
"DATA",790.404,15,1,20,0)
 
"DATA",790.404,15,1,21,0)
- -                                                                    - -
"DATA",790.404,15,1,22,0)
 
"DATA",790.404,15,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,15,1,24,0)
 
"DATA",790.404,15,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,15,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,15,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,15,1,28,0)
 
"DATA",790.404,15,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,15,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,15,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,15,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,15,1,33,0)
 
"DATA",790.404,15,1,34,0)
     Sincerely,
"DATA",790.404,15,1,35,0)
 
"DATA",790.404,15,1,36,0)
 
"DATA",790.404,15,1,37,0)
 
"DATA",790.404,15,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,15,1,39,0)
     Women's Health Program
"DATA",790.404,15,1,40,0)
     phone: 777-7777
"DATA",790.404,15,1,41,0)
 
"DATA",790.404,15,1,42,0)
 
"DATA",790.404,15,1,43,0)
     printed: |NOW|
"DATA",790.404,16,0)
PAP abnormal, need colp 8-12 weeks PP.^2
"DATA",790.404,16,1,0)
^^43^43^2980623^^
"DATA",790.404,16,1,1,0)
|NOWRAP|
"DATA",790.404,16,1,2,0)
 
"DATA",790.404,16,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,16,1,4,0)
 
"DATA",790.404,16,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,16,1,6,0)
 
"DATA",790.404,16,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,16,1,8,0)
 
"DATA",790.404,16,1,9,0)
 
"DATA",790.404,16,1,10,0)
     |TODAY|
"DATA",790.404,16,1,11,0)
 
"DATA",790.404,16,1,12,0)
 
"DATA",790.404,16,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,16,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,16,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,16,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,16,1,17,0)
 
"DATA",790.404,16,1,18,0)
 
"DATA",790.404,16,1,19,0)
 
"DATA",790.404,16,1,20,0)
 
"DATA",790.404,16,1,21,0)
- -                                                                    - -
"DATA",790.404,16,1,22,0)
 
"DATA",790.404,16,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,16,1,24,0)
 
"DATA",790.404,16,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,16,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,16,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,16,1,28,0)
 
"DATA",790.404,16,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,16,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,16,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,16,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,16,1,33,0)
 
"DATA",790.404,16,1,34,0)
     Sincerely,
"DATA",790.404,16,1,35,0)
 
"DATA",790.404,16,1,36,0)
 
"DATA",790.404,16,1,37,0)
 
"DATA",790.404,16,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,16,1,39,0)
     Women's Health Program
"DATA",790.404,16,1,40,0)
     phone: 777-7777
"DATA",790.404,16,1,41,0)
 
"DATA",790.404,16,1,42,0)
 
"DATA",790.404,16,1,43,0)
     printed: |NOW|
"DATA",790.404,17,0)
PAP, follow-up due.^2
"DATA",790.404,17,1,0)
^^43^43^2980623^^
"DATA",790.404,17,1,1,0)
|NOWRAP|
"DATA",790.404,17,1,2,0)
 
"DATA",790.404,17,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,17,1,4,0)
 
"DATA",790.404,17,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,17,1,6,0)
 
"DATA",790.404,17,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,17,1,8,0)
 
"DATA",790.404,17,1,9,0)
 
"DATA",790.404,17,1,10,0)
     |TODAY|
"DATA",790.404,17,1,11,0)
 
"DATA",790.404,17,1,12,0)
 
"DATA",790.404,17,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,17,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,17,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,17,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,17,1,17,0)
 
"DATA",790.404,17,1,18,0)
 
"DATA",790.404,17,1,19,0)
 
"DATA",790.404,17,1,20,0)
 
"DATA",790.404,17,1,21,0)
- -                                                                    - -
"DATA",790.404,17,1,22,0)
 
"DATA",790.404,17,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,17,1,24,0)
 
"DATA",790.404,17,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,17,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,17,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,17,1,28,0)
 
"DATA",790.404,17,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,17,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,17,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,17,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,17,1,33,0)
 
"DATA",790.404,17,1,34,0)
     Sincerely,
"DATA",790.404,17,1,35,0)
 
"DATA",790.404,17,1,36,0)
 
"DATA",790.404,17,1,37,0)
 
"DATA",790.404,17,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,17,1,39,0)
     Women's Health Program
"DATA",790.404,17,1,40,0)
     phone: 777-7777
"DATA",790.404,17,1,41,0)
 
"DATA",790.404,17,1,42,0)
 
"DATA",790.404,17,1,43,0)
     printed: |NOW|
"DATA",790.404,18,0)
COLP follow-up, next PAP 6 months.^3^C6^1
"DATA",790.404,18,1,0)
^^43^43^2980623^^
"DATA",790.404,18,1,1,0)
|NOWRAP|
"DATA",790.404,18,1,2,0)
 
"DATA",790.404,18,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,18,1,4,0)
 
"DATA",790.404,18,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,18,1,6,0)
 
"DATA",790.404,18,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,18,1,8,0)
 
"DATA",790.404,18,1,9,0)
 
"DATA",790.404,18,1,10,0)
     |TODAY|
"DATA",790.404,18,1,11,0)
 
"DATA",790.404,18,1,12,0)
 
"DATA",790.404,18,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,18,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,18,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,18,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,18,1,17,0)
 
"DATA",790.404,18,1,18,0)
 
"DATA",790.404,18,1,19,0)
 
"DATA",790.404,18,1,20,0)
 
"DATA",790.404,18,1,21,0)
- -                                                                    - -
"DATA",790.404,18,1,22,0)
 
"DATA",790.404,18,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,18,1,24,0)
 
"DATA",790.404,18,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,18,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,18,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,18,1,28,0)
 
"DATA",790.404,18,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,18,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,18,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,18,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,18,1,33,0)
 
"DATA",790.404,18,1,34,0)
     Sincerely,
"DATA",790.404,18,1,35,0)
 
"DATA",790.404,18,1,36,0)
 
"DATA",790.404,18,1,37,0)
 
"DATA",790.404,18,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,18,1,39,0)
     Women's Health Program
"DATA",790.404,18,1,40,0)
     phone: 777-7777
"DATA",790.404,18,1,41,0)
 
"DATA",790.404,18,1,42,0)
 
"DATA",790.404,18,1,43,0)
     printed: |NOW|
"DATA",790.404,19,0)
COLP follow-up, PAP next month.^2^^1
"DATA",790.404,19,1,0)
^^43^43^2980623^^
"DATA",790.404,19,1,1,0)
|NOWRAP|
"DATA",790.404,19,1,2,0)
 
"DATA",790.404,19,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,19,1,4,0)
 
"DATA",790.404,19,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,19,1,6,0)
 
"DATA",790.404,19,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,19,1,8,0)
 
"DATA",790.404,19,1,9,0)
 
"DATA",790.404,19,1,10,0)
     |TODAY|
"DATA",790.404,19,1,11,0)
 
"DATA",790.404,19,1,12,0)
 
"DATA",790.404,19,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,19,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,19,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,19,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,19,1,17,0)
 
"DATA",790.404,19,1,18,0)
 
"DATA",790.404,19,1,19,0)
 
"DATA",790.404,19,1,20,0)
 
"DATA",790.404,19,1,21,0)
- -                                                                    - -
"DATA",790.404,19,1,22,0)
 
"DATA",790.404,19,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,19,1,24,0)
 
"DATA",790.404,19,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,19,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,19,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,19,1,28,0)
 
"DATA",790.404,19,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,19,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,19,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,19,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,19,1,33,0)
 
"DATA",790.404,19,1,34,0)
     Sincerely,
"DATA",790.404,19,1,35,0)
 
"DATA",790.404,19,1,36,0)
 
"DATA",790.404,19,1,37,0)
 
"DATA",790.404,19,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,19,1,39,0)
     Women's Health Program
"DATA",790.404,19,1,40,0)
     phone: 777-7777
"DATA",790.404,19,1,41,0)
 
"DATA",790.404,19,1,42,0)
 
"DATA",790.404,19,1,43,0)
     printed: |NOW|
"DATA",790.404,20,0)
MAM result normal, next MAM 1 year.^3^^1^BR^0
"DATA",790.404,20,1,0)
^^43^43^2980623^^
"DATA",790.404,20,1,1,0)
|NOWRAP|
"DATA",790.404,20,1,2,0)
 
"DATA",790.404,20,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,20,1,4,0)
 
"DATA",790.404,20,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,20,1,6,0)
 
"DATA",790.404,20,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,20,1,8,0)
 
"DATA",790.404,20,1,9,0)
 
"DATA",790.404,20,1,10,0)
     |TODAY|
"DATA",790.404,20,1,11,0)
 
"DATA",790.404,20,1,12,0)
 
"DATA",790.404,20,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,20,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,20,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,20,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,20,1,17,0)
 
"DATA",790.404,20,1,18,0)
 
"DATA",790.404,20,1,19,0)
 
"DATA",790.404,20,1,20,0)
 
"DATA",790.404,20,1,21,0)
- -                                                                    - -
"DATA",790.404,20,1,22,0)
 
"DATA",790.404,20,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,20,1,24,0)
 
"DATA",790.404,20,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,20,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,20,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,20,1,28,0)
 
"DATA",790.404,20,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,20,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,20,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,20,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,20,1,33,0)
 
"DATA",790.404,20,1,34,0)
     Sincerely,
"DATA",790.404,20,1,35,0)
 
"DATA",790.404,20,1,36,0)
 
"DATA",790.404,20,1,37,0)
 
"DATA",790.404,20,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,20,1,39,0)
     Women's Health Program
"DATA",790.404,20,1,40,0)
     phone: 777-7777
"DATA",790.404,20,1,41,0)
 
"DATA",790.404,20,1,42,0)
 
"DATA",790.404,20,1,43,0)
     printed: |NOW|
"DATA",790.404,22,0)
COLP Abnormal, need further TX^1^^1^CX^1
"DATA",790.404,22,1,0)
^^43^43^2980623^^
"DATA",790.404,22,1,1,0)
|NOWRAP|
"DATA",790.404,22,1,2,0)
 
"DATA",790.404,22,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.404,22,1,4,0)
 
"DATA",790.404,22,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.404,22,1,6,0)
 
"DATA",790.404,22,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.404,22,1,8,0)
 
"DATA",790.404,22,1,9,0)
 
"DATA",790.404,22,1,10,0)
     |TODAY|
"DATA",790.404,22,1,11,0)
 
"DATA",790.404,22,1,12,0)
 
"DATA",790.404,22,1,13,0)
                                                        SSN: |SSN#|
"DATA",790.404,22,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.404,22,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.404,22,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.404,22,1,17,0)
 
"DATA",790.404,22,1,18,0)
 
"DATA",790.404,22,1,19,0)
 
"DATA",790.404,22,1,20,0)
 
"DATA",790.404,22,1,21,0)
- -                                                                    - -
"DATA",790.404,22,1,22,0)
 
"DATA",790.404,22,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.404,22,1,24,0)
 
"DATA",790.404,22,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.404,22,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.404,22,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.404,22,1,28,0)
 
"DATA",790.404,22,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.404,22,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.404,22,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.404,22,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.404,22,1,33,0)
 
"DATA",790.404,22,1,34,0)
     Sincerely,
"DATA",790.404,22,1,35,0)
 
"DATA",790.404,22,1,36,0)
 
"DATA",790.404,22,1,37,0)
 
"DATA",790.404,22,1,38,0)
     Wendy Wellness, LPN
"DATA",790.404,22,1,39,0)
     Women's Health Program
"DATA",790.404,22,1,40,0)
     phone: 777-7777
"DATA",790.404,22,1,41,0)
 
"DATA",790.404,22,1,42,0)
 
"DATA",790.404,22,1,43,0)
     printed: |NOW|
"DATA",790.405,1,0)
Declined Tx^1
"DATA",790.405,2,0)
No response^1
"DATA",790.405,3,0)
Unable to contact Patient^1
"DATA",790.405,4,0)
Scheduled appt for PAP^1
"DATA",790.405,5,0)
Scheduled appt for Repeat PAP^1
"DATA",790.405,6,0)
Scheduled appt for Colposcopy^1
"DATA",790.405,7,0)
Tx elsewhere^1
"DATA",790.405,8,0)
Patient left Service Area^1
"DATA",790.405,9,0)
No known address^1
"DATA",790.405,10,0)
Chart Flagged^1
"DATA",790.405,11,0)
PHN referral^1
"DATA",790.405,12,0)
Response not tracked^1
"DATA",790.405,13,0)
Provider consult^1
"DATA",790.405,14,0)
PAP Normal letter sent^1
"DATA",790.405,15,0)
MAM Normal letter sent^1
"DATA",790.405,16,0)
Letter Sent^1
"DATA",790.405,17,0)
CBE Refused^1
"DATA",790.405,18,0)
Letter Canceled^1
"DATA",790.405,99,0)
Patient Deceased^1
"DATA",790.5,1,0)
Repeat PAP
"DATA",790.5,2,0)
Colposcopy
"DATA",790.5,3,0)
Follow-up PAP
"DATA",790.5,4,0)
Routine PAP
"DATA",790.5,5,0)
Undetermined
"DATA",790.5,6,0)
Chart Review
"DATA",790.5,7,0)
Post Colposcopy
"DATA",790.5,8,0)
Post Partum Colp Reg
"DATA",790.5,9,0)
Prenatal Colp Reg
"DATA",790.5,10,0)
Treat Infection
"DATA",790.5,11,0)
Cryo/Leep/Cone
"DATA",790.5,12,0)
Other Facility
"DATA",790.51,1,0)
Mammogram, Screening^^
"DATA",790.51,2,0)
Mammogram, Repeat^^
"DATA",790.51,3,0)
Mammogram, Followup^^
"DATA",790.51,4,0)
Needle Biopsy^^
"DATA",790.51,5,0)
Open Biopsy^^
"DATA",790.51,6,0)
Ultrasound^^
"DATA",790.51,7,0)
Needle Loc w/Open Bx^^
"DATA",790.51,8,0)
Undetermined^^
"DATA",790.51,9,0)
Not Indicated^^
"DATA",790.51,10,0)
Cyst Aspiration^^
"DATA",790.51,11,0)
Mammogram, Dx^^
"DATA",790.51,12,0)
Clinical Breast Exam^^
"DATA",790.51,13,0)
CBE and MAM^^
"DATA",790.51,14,0)
Chart Review^^
"DATA",790.51,15,0)
Other Facility^^
"DATA",790.6,1,0)
GENERIC SAMPLE LETTER
"DATA",790.6,1,1,0)
^^43^43^2980805^
"DATA",790.6,1,1,1,0)
|NOWRAP|
"DATA",790.6,1,1,2,0)
 
"DATA",790.6,1,1,3,0)
|CENTER("Women's Health Clinic")|
"DATA",790.6,1,1,4,0)
 
"DATA",790.6,1,1,5,0)
|CENTER(" 7 Your Street")|
"DATA",790.6,1,1,6,0)
 
"DATA",790.6,1,1,7,0)
|CENTER("Your City, ST  77777")|
"DATA",790.6,1,1,8,0)
 
"DATA",790.6,1,1,9,0)
 
"DATA",790.6,1,1,10,0)
     |TODAY|
"DATA",790.6,1,1,11,0)
 
"DATA",790.6,1,1,12,0)
 
"DATA",790.6,1,1,13,0)
                                                        |SSN#|
"DATA",790.6,1,1,14,0)
     |$P(NAME,",",2)| |$P(NAME,",")|                  
"DATA",790.6,1,1,15,0)
     |MAILING ADDRESS-STREET|
"DATA",790.6,1,1,16,0)
     |MAILING ADDRESS-CITY|, |MAILING ADDRESS-STATE|  |MAILING ADDRESS-ZIP|
"DATA",790.6,1,1,17,0)
 
"DATA",790.6,1,1,18,0)
 
"DATA",790.6,1,1,19,0)
 
"DATA",790.6,1,1,20,0)
 
"DATA",790.6,1,1,21,0)
- -                                                                    - -
"DATA",790.6,1,1,22,0)
 
"DATA",790.6,1,1,23,0)
     Dear Ms. |$P(NAME,",",1)|,
"DATA",790.6,1,1,24,0)
 
"DATA",790.6,1,1,25,0)
     The results of your recent Pap smear are something, something.
"DATA",790.6,1,1,26,0)
     This is the body of the letter and should be edited to say what
"DATA",790.6,1,1,27,0)
     you want for this Purpose of Notification.
"DATA",790.6,1,1,28,0)
 
"DATA",790.6,1,1,29,0)
     It may go on to say: Your next something will be due one year from
"DATA",790.6,1,1,30,0)
     now.  At that time we will mail you a reminder letter, or you may
"DATA",790.6,1,1,31,0)
     schedule the appointment yourself by calling our Family Medicine
"DATA",790.6,1,1,32,0)
     Clinic at 777-7777 or our Women's Clinic at 777-7777.
"DATA",790.6,1,1,33,0)
 
"DATA",790.6,1,1,34,0)
     Sincerely,
"DATA",790.6,1,1,35,0)
 
"DATA",790.6,1,1,36,0)
 
"DATA",790.6,1,1,37,0)
 
"DATA",790.6,1,1,38,0)
     Wendy Wellness, LPN
"DATA",790.6,1,1,39,0)
     Women's Health Program
"DATA",790.6,1,1,40,0)
     phone: 777-7777
"DATA",790.6,1,1,41,0)
 
"DATA",790.6,1,1,42,0)
 
"DATA",790.6,1,1,43,0)
     printed: |NOW|
"FIA",790)
WV PATIENT
"FIA",790,0)
^WV(790,
"FIA",790,0,0)
790IP
"FIA",790,0,1)
y^y^f^^^^n
"FIA",790,0,10)

"FIA",790,0,11)

"FIA",790,0,"RLRO")

"FIA",790,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790,790)
0
"FIA",790,790.06)
0
"FIA",790.01)
WV CASE MANAGER
"FIA",790.01,0)
^WV(790.01,
"FIA",790.01,0,0)
790.01sP
"FIA",790.01,0,1)
y^y^f^^^^n
"FIA",790.01,0,10)

"FIA",790.01,0,11)

"FIA",790.01,0,"RLRO")

"FIA",790.01,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.01,790.01)
0
"FIA",790.02)
WV SITE PARAMETER
"FIA",790.02,0)
^WV(790.02,
"FIA",790.02,0,0)
790.02P
"FIA",790.02,0,1)
y^y^f^^^^n
"FIA",790.02,0,10)

"FIA",790.02,0,11)

"FIA",790.02,0,"RLRO")

"FIA",790.02,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.02,790.02)
0
"FIA",790.03)
WV PAP REGIMEN
"FIA",790.03,0)
^WV(790.03,
"FIA",790.03,0,0)
790.03I
"FIA",790.03,0,1)
y^y^f^^n^^y^m^n
"FIA",790.03,0,10)

"FIA",790.03,0,11)

"FIA",790.03,0,"RLRO")

"FIA",790.03,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.03,790.03)
0
"FIA",790.04)
WV PAP REGIMEN LOG
"FIA",790.04,0)
^WV(790.04,
"FIA",790.04,0,0)
790.04ID
"FIA",790.04,0,1)
y^y^f^^^^n
"FIA",790.04,0,10)

"FIA",790.04,0,11)

"FIA",790.04,0,"RLRO")

"FIA",790.04,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.04,790.04)
0
"FIA",790.05)
WV PREGNANCY LOG
"FIA",790.05,0)
^WV(790.05,
"FIA",790.05,0,0)
790.05DI
"FIA",790.05,0,1)
y^y^f^^^^n
"FIA",790.05,0,10)

"FIA",790.05,0,11)

"FIA",790.05,0,"RLRO")

"FIA",790.05,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.05,790.05)
0
"FIA",790.07)
WV REFERRAL SOURCE
"FIA",790.07,0)
^WV(790.07,
"FIA",790.07,0,0)
790.07s
"FIA",790.07,0,1)
y^y^f^^n^^y^a^n
"FIA",790.07,0,10)

"FIA",790.07,0,11)

"FIA",790.07,0,"RLRO")

"FIA",790.07,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.07,790.07)
0
"FIA",790.1)
WV PROCEDURE
"FIA",790.1,0)
^WV(790.1,
"FIA",790.1,0,0)
790.1I
"FIA",790.1,0,1)
y^y^f^^^^n
"FIA",790.1,0,10)

"FIA",790.1,0,11)

"FIA",790.1,0,"RLRO")

"FIA",790.1,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.1,790.1)
0
"FIA",790.1,790.11)
0
"FIA",790.1,790.19)
0
"FIA",790.2)
WV PROCEDURE TYPE
"FIA",790.2,0)
^WV(790.2,
"FIA",790.2,0,0)
790.2I
"FIA",790.2,0,1)
y^y^f^^n^^y^m^n
"FIA",790.2,0,10)

"FIA",790.2,0,11)

"FIA",790.2,0,"RLRO")

"FIA",790.2,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.2,790.2)
0
"FIA",790.3)
WV REFUSALS
"FIA",790.3,0)
^WV(790.3,
"FIA",790.3,0,0)
790.3DI
"FIA",790.3,0,1)
y^y^f^^^^n
"FIA",790.3,0,10)

"FIA",790.3,0,11)

"FIA",790.3,0,"RLRO")

"FIA",790.3,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.3,790.3)
0
"FIA",790.31)
WV RESULTS/DIAGNOSIS
"FIA",790.31,0)
^WV(790.31,
"FIA",790.31,0,0)
790.31I
"FIA",790.31,0,1)
y^y^f^^n^^y^m^n
"FIA",790.31,0,10)

"FIA",790.31,0,11)

"FIA",790.31,0,"RLRO")

"FIA",790.31,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.31,790.31)
0
"FIA",790.32)
WV DIAGNOSTIC CODE TRANSLATION
"FIA",790.32,0)
^WV(790.32,
"FIA",790.32,0,0)
790.32P
"FIA",790.32,0,1)
y^y^f^^^^n
"FIA",790.32,0,10)

"FIA",790.32,0,11)

"FIA",790.32,0,"RLRO")

"FIA",790.32,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.32,790.32)
0
"FIA",790.4)
WV NOTIFICATION
"FIA",790.4,0)
^WV(790.4,
"FIA",790.4,0,0)
790.4IP
"FIA",790.4,0,1)
y^y^f^^^^n
"FIA",790.4,0,10)

"FIA",790.4,0,11)

"FIA",790.4,0,"RLRO")

"FIA",790.4,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.4,790.4)
0
"FIA",790.403)
WV NOTIFICATION TYPE
"FIA",790.403,0)
^WV(790.403,
"FIA",790.403,0,0)
790.403I
"FIA",790.403,0,1)
y^y^f^^n^^y^m^n
"FIA",790.403,0,10)

"FIA",790.403,0,11)

"FIA",790.403,0,"RLRO")

"FIA",790.403,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.403,790.403)
0
"FIA",790.404)
WV NOTIFICATION PURPOSE
"FIA",790.404,0)
^WV(790.404,
"FIA",790.404,0,0)
790.404I
"FIA",790.404,0,1)
y^y^f^^n^^y^a^n
"FIA",790.404,0,10)

"FIA",790.404,0,11)

"FIA",790.404,0,"RLRO")

"FIA",790.404,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.404,790.404)
0
"FIA",790.404,790.414)
0
"FIA",790.405)
WV NOTIFICATION OUTCOME
"FIA",790.405,0)
^WV(790.405,
"FIA",790.405,0,0)
790.405
"FIA",790.405,0,1)
y^y^f^^n^^y^m^n
"FIA",790.405,0,10)

"FIA",790.405,0,11)

"FIA",790.405,0,"RLRO")

"FIA",790.405,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.405,790.405)
0
"FIA",790.5)
WV CERVICAL TX NEED
"FIA",790.5,0)
^WV(790.5,
"FIA",790.5,0,0)
790.5
"FIA",790.5,0,1)
y^y^f^^n^^y^m^n
"FIA",790.5,0,10)

"FIA",790.5,0,11)

"FIA",790.5,0,"RLRO")

"FIA",790.5,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.5,790.5)
0
"FIA",790.51)
WV BREAST TX NEED
"FIA",790.51,0)
^WV(790.51,
"FIA",790.51,0,0)
790.51
"FIA",790.51,0,1)
y^y^f^^n^^y^m^n
"FIA",790.51,0,10)

"FIA",790.51,0,11)

"FIA",790.51,0,"RLRO")

"FIA",790.51,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.51,790.51)
0
"FIA",790.6)
WV LETTER
"FIA",790.6,0)
^WV(790.6,
"FIA",790.6,0,0)
790.6
"FIA",790.6,0,1)
y^y^f^^n^^y^m^n
"FIA",790.6,0,10)

"FIA",790.6,0,11)

"FIA",790.6,0,"RLRO")

"FIA",790.6,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.6,790.6)
0
"FIA",790.6,790.61)
0
"FIA",790.71)
WV SNAPSHOT REPORTS
"FIA",790.71,0)
^WV(790.71,
"FIA",790.71,0,0)
790.71ID
"FIA",790.71,0,1)
y^y^f^^^^n
"FIA",790.71,0,10)

"FIA",790.71,0,11)

"FIA",790.71,0,"RLRO")

"FIA",790.71,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.71,790.71)
0
"FIA",790.72)
WV AGE RANGE DEFAULT
"FIA",790.72,0)
^WV(790.72,
"FIA",790.72,0,0)
790.72P
"FIA",790.72,0,1)
y^y^f^^^^n
"FIA",790.72,0,10)

"FIA",790.72,0,11)

"FIA",790.72,0,"RLRO")

"FIA",790.72,0,"VR")
1.0^WOMEN'S HEALTH
"FIA",790.72,790.72)
0
"INI")
WVPRE
"INIT")
WVPOST
"KRN",.4,1709,-1)
0^3
"KRN",.4,1709,0)
WV PRINT PROC TYPE & ATTRIBS^2951116.1755^@^790.2^^@^2960127
"KRN",.4,1709,"F",2)
.01~.12~.14;L12;C43~
"KRN",.4,1709,"H")
WV PROCEDURE TYPE LIST
"KRN",.4,1710,-1)
0^4
"KRN",.4,1710,0)
WV PRINT RES/DIAG SYNONYMS^2960302.1052^@^790.31^^@^2980928
"KRN",.4,1710,"F",2)
.3~"--";""~.31~"--";""~.01~
"KRN",.4,1710,"H")
WV RESULTS/DIAGNOSIS LIST
"KRN",.4,1711,-1)
0^1
"KRN",.4,1711,0)
WV PRINT DIAG CODE TRANSLATION^2950526.1748^@^790.32^^@^2980928
"KRN",.4,1711,"F",2)
"WOMEN'S HEALTH: ";X~.01;X~"RADIOLOGY: ";C6;X~.02;X~" ";S1~
"KRN",.4,1711,"H")
WV DIAGNOSTIC CODE TRANSLATION LIST
"KRN",.4,1712,-1)
0^2
"KRN",.4,1712,0)
WV PRINT NOTIF PURPOSE&LETTER^2950319.0025^^790.404^^^2980917^
"KRN",.4,1712,"DXS",1,1)
URGENT
"KRN",.4,1712,"DXS",1,2)
ASAP
"KRN",.4,1712,"DXS",1,3)
ROUTINE
"KRN",.4,1712,"DXS",2,0)
NO
"KRN",.4,1712,"DXS",2,1)
YES
"KRN",.4,1712,"DXS",3,"BR")
BREAST TX
"KRN",.4,1712,"DXS",3,"CX")
CERVICAL TX
"KRN",.4,1712,"DXS",4,0)
REMINDER
"KRN",.4,1712,"DXS",4,1)
RESULT
"KRN",.4,1712,"F",1)
S:$D(WVPAGE) WVPAGE=WVPAGE+1;Z;"S:$D(WVPAGE) WVPAGE=WVPAGE+1"~"NOTIFICATION PURPOSE & LETTER LIST";C1~
"KRN",.4,1712,"F",2)
S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~
"KRN",.4,1712,"F",3)
W:$D(WVPAGE) "PAGE "_WVPAGE;C70;X;Z;"W:$D(WVPAGE) "PAGE "_WVPAGE"~
"KRN",.4,1712,"F",4)
S X="-",DIP(1)=X S X=80,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",80)"~"PURPOSE: ";S;C2;X~.01~
"KRN",.4,1712,"F",5)
"SYNONYM: ";C55;X~.03~"PRIORITY: ";C1;X~.02~"ACTIVE: ";C56;X~.04~"BR or CX: ";C1;X~.05~.06;C1;X~" LETTER:"~"";S~1.01,.01~
"KRN",.4,1712,"F",6)
D:$E(IOST)="C" DIRZ^WVUTL3;Z;"D:$E(IOST)="C" DIRZ^WVUTL3"~W @IOF;Z;"W @IOF"~
"KRN",.4,1712,"H")
@@
"KRN",.4,1712,"IOM")
80
"KRN",.4,1712,"LAST")

"KRN",.403,69,-1)
0^5
"KRN",.403,69,0)
WV PROC-FORM-1^^^^2940620^^^790.1^0^0^1
"KRN",.403,69,11)

"KRN",.403,69,12)

"KRN",.403,69,40,0)
^.4031I^1^1
"KRN",.403,69,40,1,0)
1^^1,1^^^0
"KRN",.403,69,40,1,1)
PAGE 1
"KRN",.403,69,40,1,11)

"KRN",.403,69,40,1,12)

"KRN",.403,69,40,1,40,0)
^.4032PI^315^2
"KRN",.403,69,40,1,40,250,0)
WV PROC-EDITBLK-1^3^8,1^e
"KRN",.403,69,40,1,40,315,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,70,-1)
0^1
"KRN",.403,70,0)
WV NOTIF-FORM-1^^^^2940713^^^790.4^0^0^1
"KRN",.403,70,11)

"KRN",.403,70,12)

"KRN",.403,70,40,0)
^.4031I^1^1
"KRN",.403,70,40,1,0)
1^^1,1^^^0
"KRN",.403,70,40,1,1)
PAGE 1
"KRN",.403,70,40,1,40,0)
^.4032PI^252^2
"KRN",.403,70,40,1,40,252,0)
WV NOTIF-HEADER-1^2^1,1^d
"KRN",.403,70,40,1,40,253,0)
WV NOTIF-EDITBLK-1^1^8,1^e
"KRN",.403,71,-1)
0^4
"KRN",.403,71,0)
WV PATIENT-FORM-1^^^^2940917^^^790^0^0^1
"KRN",.403,71,40,0)
^.4031I^1^1
"KRN",.403,71,40,1,0)
1^^1,1^^^0
"KRN",.403,71,40,1,1)
PAGE 1
"KRN",.403,71,40,1,40,0)
^.4032PI^326^2
"KRN",.403,71,40,1,40,255,0)
WV PATIENT-EDITBLK-1^1^8,1^e
"KRN",.403,71,40,1,40,326,0)
WV PATIENT-HEADER-2^2^1,1^d
"KRN",.403,72,-1)
0^2
"KRN",.403,72,0)
WV NOTIF-FORM-2^^^^2941003^^^790.4^0^0^1
"KRN",.403,72,11)

"KRN",.403,72,40,0)
^.4031I^1^1
"KRN",.403,72,40,1,0)
1^WV NOTIF-HEADER-1^1,1^^^0
"KRN",.403,72,40,1,1)
PAGE 1
"KRN",.403,72,40,1,40,0)
^.4032PI^257^1
"KRN",.403,72,40,1,40,257,0)
WV NOTIF-EDITBLK-2^1^8,1^e
"KRN",.403,73,-1)
0^6
"KRN",.403,73,0)
WV PROC-FORM-2-COLP^^^^2940620^^^790.1^0^0^1
"KRN",.403,73,40,0)
^.4031I^2^2
"KRN",.403,73,40,1,0)
1^^1,1^2^2^0
"KRN",.403,73,40,1,1)
PAGE 1
"KRN",.403,73,40,1,40,0)
^.4032PI^315^2
"KRN",.403,73,40,1,40,250,0)
WV PROC-EDITBLK-1^1^8,1^e
"KRN",.403,73,40,1,40,315,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,73,40,2,0)
2^^1,1^1^1^0
"KRN",.403,73,40,2,1)
PAGE 2
"KRN",.403,73,40,2,40,0)
^.4032PI^315^2
"KRN",.403,73,40,2,40,256,0)
WV PROC-EDITBLK-2-COLP^1^9,1^e
"KRN",.403,73,40,2,40,315,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,75,-1)
0^3
"KRN",.403,75,0)
WV NOTIFPURPOSE-FORM-1^^^^2950316^^^790.404^0^0^1
"KRN",.403,75,40,0)
^.4031I^1^1
"KRN",.403,75,40,1,0)
1^^1,1^^^0
"KRN",.403,75,40,1,1)
PAGE 1
"KRN",.403,75,40,1,40,0)
^.4032PI^259^1
"KRN",.403,75,40,1,40,259,0)
WV NOTIFPURPOSE-EDITBLK-1^1^1,1^e
"KRN",.403,76,-1)
0^12
"KRN",.403,76,0)
WV SITE PARAMS-FORM-1^^^^2950317^^^790.02^0^0^1
"KRN",.403,76,40,0)
^.4031I^5^5
"KRN",.403,76,40,1,0)
1^^1,1^2^5^0
"KRN",.403,76,40,1,1)
PAGE 1
"KRN",.403,76,40,1,40,0)
^.4032PI^260^1
"KRN",.403,76,40,1,40,260,0)
WV SITE PARAMS-EDITBLK-1^1^1,1^e
"KRN",.403,76,40,2,0)
2^^1,1^3^1^0
"KRN",.403,76,40,2,1)
PAGE 2
"KRN",.403,76,40,2,40,0)
^.4032PI^261^1
"KRN",.403,76,40,2,40,261,0)
WV SITE PARAMS-EDITBLK-2^1^1,1^e
"KRN",.403,76,40,3,0)
3^^1,1^4^2
"KRN",.403,76,40,3,1)
Page 3
"KRN",.403,76,40,3,40,0)
^.4032IP^312^1
"KRN",.403,76,40,3,40,312,0)
WV SITE PATAMS-EDITBLK-3^1^1,1^e
"KRN",.403,76,40,4,0)
4^^1,1^5^3
"KRN",.403,76,40,4,1)
Page 4
"KRN",.403,76,40,4,40,0)
^.4032IP^313^1
"KRN",.403,76,40,4,40,313,0)
WV SITE PARAMS-EDITBLK-4^1^1,1^e
"KRN",.403,76,40,5,0)
5^^1,1^^4
"KRN",.403,76,40,5,1)
Page 5
"KRN",.403,76,40,5,40,0)
^.4032IP^314^1
"KRN",.403,76,40,5,40,314,0)
WV SITE PARAMS-EDITBLK-5^1^1,1^e
"KRN",.403,85,-1)
0^11
"KRN",.403,85,0)
WV REFUSED PROCEDURE-ENTRY^@^@^^2980617.0721^^^790.3^0^0^1
"KRN",.403,85,40,0)
^.4031I^1^1
"KRN",.403,85,40,1,0)
1^^1,1
"KRN",.403,85,40,1,1)
Page 1
"KRN",.403,85,40,1,40,0)
^.4032IP^^0
"KRN",.403,85,40,1,40,318,0)
WV REFUSAL-DISPLAY-1^1^1,1^d
"KRN",.403,85,40,1,40,319,0)
WV REFUSAL-EDIT-1^2^9,1^e
"KRN",.403,87,-1)
0^13
"KRN",.403,87,0)
WV PROC-FORM-LAB^^^^2940620^^^790.1^0^0^1
"KRN",.403,87,40,0)
^.4031I^1^1
"KRN",.403,87,40,1,0)
1^^1,1^^^0
"KRN",.403,87,40,1,1)
PAGE 1
"KRN",.403,87,40,1,40,0)
^.4032PI^327^2
"KRN",.403,87,40,1,40,324,0)
WV PROC-EDITBLK-LAB^1^8,1^e
"KRN",.403,87,40,1,40,327,0)
WV PROC-HEADER-1^2^1,1^d
"KRN",.404,250,0)
WV PROC-EDITBLK-1^790.1
"KRN",.404,250,11)
D:$$COLP^WVUTL4(DA) HLP^DDSUTL(" * Move to PAGE 2 to edit clinical and pathology findings. ")
"KRN",.404,250,12)

"KRN",.404,250,15,0)
^^1^1^2980605^
"KRN",.404,250,15,1,0)
WV PROCEDURE-EDIT-BLOCK-1
"KRN",.404,250,40,0)
^.4044I^18^15
"KRN",.404,250,40,1,0)
1^Date of Procedure^3
"KRN",.404,250,40,1,1)
.12
"KRN",.404,250,40,1,2)
2,25^18^2,6
"KRN",.404,250,40,1,3)
T
"KRN",.404,250,40,1,4)
1
"KRN",.404,250,40,1,13)
N WVX S WVX=$$PDELQ1^WVUTL4(DA,X,DUZ(2)) D PUT^DDSVAL(DIE,DA,.13,WVX)
"KRN",.404,250,40,3,0)
2^Clinician/Provider^3
"KRN",.404,250,40,3,1)
.07
"KRN",.404,250,40,3,2)
3,25^25^3,5
"KRN",.404,250,40,3,4)
0
"KRN",.404,250,40,4,0)
3^Ward/Clinic/Location^3
"KRN",.404,250,40,4,1)
.11
"KRN",.404,250,40,4,2)
4,25^30^4,3
"KRN",.404,250,40,4,4)
0
"KRN",.404,250,40,4,13)
D PUT^DDSVAL(790.1,.DA,.1,$$INSTIT^WVUTL6)
"KRN",.404,250,40,5,0)
4^Health Care Facility^3
"KRN",.404,250,40,5,1)
.1
"KRN",.404,250,40,5,2)
5,25^30^5,3
"KRN",.404,250,40,5,4)
1^^^
"KRN",.404,250,40,6,0)
9^Results/Diagnosis^3
"KRN",.404,250,40,6,1)
.05
"KRN",.404,250,40,6,2)
8,25^30^8,6
"KRN",.404,250,40,6,10)
S DDSBR=$S(X:12,1:13)
"KRN",.404,250,40,6,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,250,40,6,12)
K WVPN I X,$P(^WV(790.31,X,0),U,22) D PUT^DDSVAL(DIE,DA,.08,1)
"KRN",.404,250,40,7,0)
10^Results Text (WP)^3
"KRN",.404,250,40,7,1)
1.01
"KRN",.404,250,40,7,2)
5,77^1^5,58
"KRN",.404,250,40,7,4)
^^^0
"KRN",.404,250,40,7,10)
S DDSBR=5
"KRN",.404,250,40,9,0)
6^Complete by (Date)^3
"KRN",.404,250,40,9,1)
.13
"KRN",.404,250,40,9,2)
7,25^12^7,5
"KRN",.404,250,40,9,3)
!M
"KRN",.404,250,40,9,3.1)
S Y=$$PDELQ^WVUTL4(DA,DUZ(2))
"KRN",.404,250,40,9,10)
S DDSBR=9
"KRN",.404,250,40,10,0)
14^Status^3
"KRN",.404,250,40,10,1)
.14
"KRN",.404,250,40,10,2)
9,65^6^9,57
"KRN",.404,250,40,10,3)
o
"KRN",.404,250,40,11,0)
15^!M^1^
"KRN",.404,250,40,11,.1)
I $$COLP^WVUTL4(DA) S Y="(PAGE 1 OF 2)"
"KRN",.404,250,40,11,2)
^^10,60
"KRN",.404,250,40,12,0)
12^Sec Results/Diagnosis^3^
"KRN",.404,250,40,12,1)
.06
"KRN",.404,250,40,12,2)
9,25^30^9,2
"KRN",.404,250,40,12,10)
S:$$PNOCX^WVUTL6($P(^WV(790.1,DA,0),U,4)) DDSBR=13
"KRN",.404,250,40,12,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,250,40,12,12)
K WVPN I X,$P(^WV(790.31,X,0),U,22) D PUT^DDSVAL(DIE,DA,.08,1)
"KRN",.404,250,40,13,0)
13^HPV^3
"KRN",.404,250,40,13,1)
.08
"KRN",.404,250,40,13,2)
8,65^3^8,60
"KRN",.404,250,40,14,0)
11^!M^1^
"KRN",.404,250,40,14,.1)
S:$O(^WV(790.1,DA,1,0)) Y="+"
"KRN",.404,250,40,14,2)
^^5,77
"KRN",.404,250,40,15,0)
5^Comments^3
"KRN",.404,250,40,15,1)
3.01
"KRN",.404,250,40,15,2)
6,25^53^6,15
"KRN",.404,250,40,17,0)
7^!M^1
"KRN",.404,250,40,17,.1)
S:$O(^WV(790.1,DA,9,0)) Y="+"
"KRN",.404,250,40,17,2)
^^4,77
"KRN",.404,250,40,18,0)
8^Rad/NM Rpt (WP)^3
"KRN",.404,250,40,18,1)
9
"KRN",.404,250,40,18,2)
4,78^1^4,60
"KRN",.404,250,40,18,4)
^^^1
"KRN",.404,250,40,18,10)
S DDSBR=4
"KRN",.404,252,0)
WV NOTIF-HEADER-1^790.4^
"KRN",.404,252,40,0)
^.4044I^20^19
"KRN",.404,252,40,1,0)
1^* * *  EDIT A NOTIFICATION  * * *^1^
"KRN",.404,252,40,1,2)
^^1,23^
"KRN",.404,252,40,2,0)
2^!M^1^
"KRN",.404,252,40,2,.1)
S Y=IOINORM_"Patient Name: "_IOINHI_$$NAME^WVUTL1(WVDFN)_" ("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,252,40,2,2)
^^2,1
"KRN",.404,252,40,3,0)
3^!M^1^
"KRN",.404,252,40,3,.1)
S Y=IOINORM_$$PNLAB^WVUTL5()_IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,252,40,3,2)
^^2,55
"KRN",.404,252,40,4,0)
10^--------------------------------------------------------------------------------^1^
"KRN",.404,252,40,4,2)
^^8,1^1
"KRN",.404,252,40,5,0)
5^!M^1^
"KRN",.404,252,40,5,.1)
S Y=IOINORM_"Patient Phone: "_IOINHI_$$HPHONE^WVUTL1(WVDFN)
"KRN",.404,252,40,5,2)
^^3,48
"KRN",.404,252,40,6,0)
4^!M^1^
"KRN",.404,252,40,6,.1)
S Y=IOINORM_"Case Manager: "_IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,252,40,6,2)
^^3,1
"KRN",.404,252,40,7,0)
6^!M^1^
"KRN",.404,252,40,7,.1)
S Y=IOINORM_"Cx Tx Need  : "_IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,252,40,7,2)
^^4,1
"KRN",.404,252,40,8,0)
7^!M^1^
"KRN",.404,252,40,8,.1)
S Y=IOINORM_"PAP Regimen : "_IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,252,40,8,2)
^^6,1
"KRN",.404,252,40,9,0)
11^!M^1^
"KRN",.404,252,40,9,.1)
S Y=IOINHI_$$EDC^WVUTL1(WVDFN)_IOINORM
"KRN",.404,252,40,9,2)
^^8,51
"KRN",.404,252,40,10,0)
8^!M^1^
"KRN",.404,252,40,10,.1)
S Y=IOINORM_"Br Tx Need  : "_IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,252,40,10,2)
^^5,1
"KRN",.404,252,40,11,0)
9^!M^1^
"KRN",.404,252,40,11,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")_IOINORM
"KRN",.404,252,40,11,2)
^^7,63
"KRN",.404,252,40,12,0)
12^Cx Tx Fac:^1
"KRN",.404,252,40,12,2)
^^4,52
"KRN",.404,252,40,13,0)
13^Br Tx Fac:^1
"KRN",.404,252,40,13,2)
^^5,52
"KRN",.404,252,40,14,0)
14^!M^1
"KRN",.404,252,40,14,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"C")_IOINORM
"KRN",.404,252,40,14,2)
^^4,63
"KRN",.404,252,40,15,0)
15^!M^1
"KRN",.404,252,40,15,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"B")_IOINORM
"KRN",.404,252,40,15,2)
^^5,63
"KRN",.404,252,40,17,0)
17^Sexual Trauma:^1
"KRN",.404,252,40,17,2)
^^7,1
"KRN",.404,252,40,18,0)
18^!M^1
"KRN",.404,252,40,18,.1)
S Y=IOINHI_$$MST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,252,40,18,2)
^^7,16
"KRN",.404,252,40,19,0)
19^Veteran:^1
"KRN",.404,252,40,19,2)
^^6,54
"KRN",.404,252,40,20,0)
20^!M^1
"KRN",.404,252,40,20,.1)
S Y=IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,252,40,20,2)
^^6,63
"KRN",.404,253,0)
WV NOTIF-EDITBLK-1^790.4
"KRN",.404,253,11)

"KRN",.404,253,12)

"KRN",.404,253,40,0)
^.4044I^13^13
"KRN",.404,253,40,1,0)
3^Date Notification Opened^3
"KRN",.404,253,40,1,1)
.02
"KRN",.404,253,40,1,2)
4,29^12^4,3
"KRN",.404,253,40,1,3)
T
"KRN",.404,253,40,2,0)
1^Accession#^3
"KRN",.404,253,40,2,1)
.06
"KRN",.404,253,40,2,2)
2,15^12^2,3
"KRN",.404,253,40,2,11)
S DIC("S")="I $P(^WV(790.1,Y,0),U,2)=WVDFN"
"KRN",.404,253,40,2,12)
I X]"" W IOINORM,"  Procedure: ",$$PROC^WVUTL1A,IOELEOL
"KRN",.404,253,40,3,0)
6^Type of Notification^3
"KRN",.404,253,40,3,1)
.03
"KRN",.404,253,40,3,2)
7,29^26^7,7
"KRN",.404,253,40,3,10)
S:'X DDSBR=7 I X S:'$P(^WV(790.403,X,0),U,2) DDSBR=7
"KRN",.404,253,40,3,13)
D PRTDATE^WVUTL6
"KRN",.404,253,40,4,0)
4^Purpose of Notification^3
"KRN",.404,253,40,4,1)
.04
"KRN",.404,253,40,4,2)
5,29^50^5,4
"KRN",.404,253,40,4,4)
1
"KRN",.404,253,40,4,13)
S Y=X W !?18,"PRIORITY: ",$$PRIOR1^WVUTL1A,"               " D PRTDATE^WVUTL6
"KRN",.404,253,40,5,0)
8^Outcome^3
"KRN",.404,253,40,5,1)
.05
"KRN",.404,253,40,5,2)
9,29^30^9,20^0
"KRN",.404,253,40,5,12)
S X=$S(X:"c",1:"o") D PUT^DDSVAL(790.4,DA,.14,X)
"KRN",.404,253,40,6,0)
9^Status^3
"KRN",.404,253,40,6,1)
.14
"KRN",.404,253,40,6,2)
10,29^6^10,21^0
"KRN",.404,253,40,7,0)
5^!M^1^
"KRN",.404,253,40,7,.1)
S Y="Priority: "_IOINHI_$$PRIOR^WVUTL1A_IOINORM
"KRN",.404,253,40,7,2)
^^6,19
"KRN",.404,253,40,8,0)
2^!M^1^
"KRN",.404,253,40,8,.1)
S Y=IOINORM_"  Procedure: "_IOINHI_$$NTPROC^WVUTL1A_IOINORM
"KRN",.404,253,40,8,2)
^^2,27
"KRN",.404,253,40,9,0)
10^Patient Ed^3
"KRN",.404,253,40,9,1)
.09
"KRN",.404,253,40,9,2)
10,69^7^10,57^0
"KRN",.404,253,40,10,0)
7^Complete by (Date)^3
"KRN",.404,253,40,10,1)
.13
"KRN",.404,253,40,10,2)
8,29^12^8,9
"KRN",.404,253,40,10,3)
!M
"KRN",.404,253,40,10,3.1)
S Y=$$NDELQ^WVUTL4
"KRN",.404,253,40,11,0)
6.5^Print Date^3
"KRN",.404,253,40,11,1)
.11
"KRN",.404,253,40,11,2)
7,69^11^7,57^0
"KRN",.404,253,40,11,3)
!M
"KRN",.404,253,40,11,3.1)
D PRTDATE^WVUTL6 S Y=$$GET^DDSVAL(DIE,DA,.11)
"KRN",.404,253,40,11,13)
S:'X X=$$GET^DDSVAL(DIE,DA,.02) S X=$$NDELQ1^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"KRN",.404,253,40,12,0)
7.5^Printed^3
"KRN",.404,253,40,12,1)
.1
"KRN",.404,253,40,12,2)
8,69^12^8,60
"KRN",.404,253,40,12,4)
^^^1
"KRN",.404,253,40,12,11)
W IOINHI
"KRN",.404,253,40,12,12)
W IOINORM
"KRN",.404,253,40,13,0)
3.5^Facility^3
"KRN",.404,253,40,13,1)
.07
"KRN",.404,253,40,13,2)
4,56^23^4,46
"KRN",.404,253,40,13,4)
1
"KRN",.404,255,0)
WV PATIENT-EDITBLK-1^790
"KRN",.404,255,40,0)
^.4044I^22^20
"KRN",.404,255,40,1,0)
1^Case Manager^3
"KRN",.404,255,40,1,1)
.1
"KRN",.404,255,40,1,2)
2,21^28^2,7
"KRN",.404,255,40,1,3)
!M
"KRN",.404,255,40,1,3.1)
S:$D(DUZ(2)) Y=IOINHI_"`"_$P(^WV(790.02,DUZ(2),0),U,2)_IOINORM
"KRN",.404,255,40,2,0)
4^Cervical Tx Need^3
"KRN",.404,255,40,2,1)
.11
"KRN",.404,255,40,2,2)
3,65^16^3,47
"KRN",.404,255,40,3,0)
5^Cervical Tx Due Date^3
"KRN",.404,255,40,3,1)
.12
"KRN",.404,255,40,3,2)
4,65^11^4,43
"KRN",.404,255,40,4,0)
7^Currently Pregnant^3
"KRN",.404,255,40,4,1)
.13
"KRN",.404,255,40,4,2)
9,25^3^9,5
"KRN",.404,255,40,4,10)
S:'X DDSBR=9
"KRN",.404,255,40,4,12)
D:'X PUT^DDSVAL(DIE,DA,.14,"")
"KRN",.404,255,40,5,0)
8^EDC^3
"KRN",.404,255,40,5,1)
.14
"KRN",.404,255,40,5,2)
9,37^12^9,32
"KRN",.404,255,40,6,0)
9^DES Daughter^3
"KRN",.404,255,40,6,1)
.15
"KRN",.404,255,40,6,2)
9,69^7^9,55
"KRN",.404,255,40,7,0)
2^Breast Tx Need^3
"KRN",.404,255,40,7,1)
.18
"KRN",.404,255,40,7,2)
3,21^20^3,5
"KRN",.404,255,40,8,0)
5.5^PAP Regimen Start Date^3
"KRN",.404,255,40,8,1)
.17
"KRN",.404,255,40,8,2)
7,25^11^7,1
"KRN",.404,255,40,9,0)
6^Notes (WP)^3
"KRN",.404,255,40,9,1)
1.01
"KRN",.404,255,40,9,2)
8,69^1^8,57
"KRN",.404,255,40,9,4)
^^^0
"KRN",.404,255,40,9,10)
S DDSBR=7
"KRN",.404,255,40,10,0)
3^Breast Tx Due Date^3
"KRN",.404,255,40,10,1)
.19
"KRN",.404,255,40,10,2)
4,21^11^4,1
"KRN",.404,255,40,11,0)
5.3^PAP Regimen^3
"KRN",.404,255,40,11,1)
.16
"KRN",.404,255,40,11,2)
6,25^25^6,12
"KRN",.404,255,40,12,0)
10^Date of 1st Encounter^3
"KRN",.404,255,40,12,1)
.21
"KRN",.404,255,40,12,2)
10,25^11^10,2
"KRN",.404,255,40,12,3)
!M
"KRN",.404,255,40,12,3.1)
S Y="T"
"KRN",.404,255,40,13,0)
6.1^!M^1^
"KRN",.404,255,40,13,.1)
S:$O(^WV(790,DA,1,0)) Y="+"
"KRN",.404,255,40,13,2)
^^8,69
"KRN",.404,255,40,14,0)
11^Referral Source^3
"KRN",.404,255,40,14,1)
.22
"KRN",.404,255,40,14,2)
10,69^8^10,52
"KRN",.404,255,40,15,0)
6.5^Family Hx of Breast CA^3
"KRN",.404,255,40,15,1)
.23
"KRN",.404,255,40,15,2)
8,25^23^8,1
"KRN",.404,255,40,16,0)
1.2^Inactive Date^3
"KRN",.404,255,40,16,1)
.24
"KRN",.404,255,40,16,2)
2,65^11^2,50
"KRN",.404,255,40,16,10)
S:X DDSBR=99
"KRN",.404,255,40,17,0)
99^ ^1
"KRN",.404,255,40,17,2)
^^10,78
"KRN",.404,255,40,18,0)
3.5^Breast Tx Facility^3
"KRN",.404,255,40,18,1)
.25
"KRN",.404,255,40,18,2)
5,21^20^5,1
"KRN",.404,255,40,19,0)
5.2^Cervical Tx Facility^3
"KRN",.404,255,40,19,1)
.26
"KRN",.404,255,40,19,2)
5,65^15^5,43
"KRN",.404,255,40,22,0)
5.7^Sexual Trauma^3
"KRN",.404,255,40,22,1)
.27
"KRN",.404,255,40,22,2)
7,69^12^7,54
"KRN",.404,255,40,22,3)
!M
"KRN",.404,255,40,22,3.1)
S Y=$G(WVMST)
"KRN",.404,255,40,22,10)
S DDSBR=6.5
"KRN",.404,256,0)
WV PROC-EDITBLK-2-COLP^790.1
"KRN",.404,256,11)

"KRN",.404,256,40,0)
^.4044I^16^16
"KRN",.404,256,40,1,0)
1^* Clinical Findings *^1^
"KRN",.404,256,40,1,2)
^^1,29
"KRN",.404,256,40,2,0)
2^T-Zone Seen Entirely^3
"KRN",.404,256,40,2,1)
.21
"KRN",.404,256,40,2,2)
2,25^3^2,3^0
"KRN",.404,256,40,3,0)
3^Lesion Outside Canal^3
"KRN",.404,256,40,3,1)
.22
"KRN",.404,256,40,3,2)
3,25^3^3,3^0
"KRN",.404,256,40,4,0)
4^Satisfactory Exam^3
"KRN",.404,256,40,4,1)
.2
"KRN",.404,256,40,4,2)
4,25^3^4,6^0
"KRN",.404,256,40,5,0)
5^Multifocal^3
"KRN",.404,256,40,5,1)
.23
"KRN",.404,256,40,5,2)
2,67^3^2,55^0
"KRN",.404,256,40,6,0)
6^Number of Quadrants^3
"KRN",.404,256,40,6,1)
.24
"KRN",.404,256,40,6,2)
3,67^3^3,46
"KRN",.404,256,40,7,0)
7^* Tissue Pathology *^1^
"KRN",.404,256,40,7,2)
^^6,29^
"KRN",.404,256,40,8,0)
8^ECC Dysplasia^3
"KRN",.404,256,40,8,1)
.25
"KRN",.404,256,40,8,2)
7,25^20^7,10^0
"KRN",.404,256,40,8,12)
S:'$$MARGIN^WVUTL4(DA) DDSBR=9
"KRN",.404,256,40,9,0)
9^Ectocervical Biopsy^3
"KRN",.404,256,40,9,1)
.26
"KRN",.404,256,40,9,2)
8,25^30^8,4^0
"KRN",.404,256,40,9,11)
S WVPN=$O(^WV(790.2,"B","ECTOCERVICAL BIOPSY",0))
"KRN",.404,256,40,9,12)
K WVPN
"KRN",.404,256,40,10,0)
12^!M^1^
"KRN",.404,256,40,10,.1)
S Y="(PAGE 2 OF 2)"
"KRN",.404,256,40,10,2)
^^9,58^
"KRN",.404,256,40,11,0)
11^STD Evaluation^3
"KRN",.404,256,40,11,1)
.28
"KRN",.404,256,40,11,2)
9,25^30^9,9^0
"KRN",.404,256,40,11,11)
S WVPN=$O(^WV(790.2,"B","STD EVALUATION",0))
"KRN",.404,256,40,11,12)
K WVPN
"KRN",.404,256,40,12,0)
8.5^Margins Clear^3
"KRN",.404,256,40,12,1)
.27
"KRN",.404,256,40,12,2)
7,73^3^7,58^0
"KRN",.404,256,40,13,0)
6.5^IMPRESSION^3
"KRN",.404,256,40,13,1)
.29
"KRN",.404,256,40,13,2)
5,25^30^5,13^0
"KRN",.404,256,40,13,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,256,40,13,12)
K WVPN
"KRN",.404,256,40,14,0)
.5^Screening PAP^3
"KRN",.404,256,40,14,1)
.3
"KRN",.404,256,40,14,2)
1,16^10^1,1
"KRN",.404,256,40,15,0)
10^Stage^3
"KRN",.404,256,40,15,1)
.31
"KRN",.404,256,40,15,2)
8,65^10^8,58^0
"KRN",.404,256,40,16,0)
6.4^Quadrant Locations^3
"KRN",.404,256,40,16,1)
.245
"KRN",.404,256,40,16,2)
4,67^11^4,47
"KRN",.404,257,0)
WV NOTIF-EDITBLK-2^790.4
"KRN",.404,257,11)
D HLP^DDSUTL("*** NOTE: Most fields cannot be edited because the letter has been printed. ***")
"KRN",.404,257,40,0)
^.4044I^13^13
"KRN",.404,257,40,1,0)
3^Date of Notification^3
"KRN",.404,257,40,1,1)
.02
"KRN",.404,257,40,1,2)
4,25^12^4,3^0
"KRN",.404,257,40,1,3)
T
"KRN",.404,257,40,1,4)
^^^1
"KRN",.404,257,40,2,0)
1^Accession#^3
"KRN",.404,257,40,2,1)
.06
"KRN",.404,257,40,2,2)
2,15^12^2,3
"KRN",.404,257,40,2,4)
^^^1
"KRN",.404,257,40,2,11)
S DIC("S")="I $P(^WV(790.1,Y,0),U,2)=WVDFN"
"KRN",.404,257,40,2,12)
I X]"" W ?46,IOINORM,"PROCEDURE: ",$$NTPROC^WVUTL1A,IOELEOL
"KRN",.404,257,40,3,0)
6^Type of Notification^3
"KRN",.404,257,40,3,1)
.03
"KRN",.404,257,40,3,2)
7,29^26^7,7^0
"KRN",.404,257,40,3,4)
^^^1
"KRN",.404,257,40,3,10)
I X S:'$P(^WV(790.403,X,0),U,2) DDSBR=7
"KRN",.404,257,40,3,13)
D PRTDATE^WVUTL2
"KRN",.404,257,40,4,0)
4^Purpose of Notification^3
"KRN",.404,257,40,4,1)
.04
"KRN",.404,257,40,4,2)
5,29^50^5,4
"KRN",.404,257,40,4,4)
^^^1
"KRN",.404,257,40,4,13)
S Y=X W !?18,"PRIORITY: ",$$PRIOR1^WVUTL1A,"     " S X=$$NDELQ1^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"KRN",.404,257,40,5,0)
8^Outcome^3
"KRN",.404,257,40,5,1)
.05
"KRN",.404,257,40,5,2)
9,29^30^9,20^0
"KRN",.404,257,40,5,12)
S X=$S(X:"c",1:"o") D PUT^DDSVAL(790.4,DA,.14,X)
"KRN",.404,257,40,6,0)
9^Status^3
"KRN",.404,257,40,6,1)
.14
"KRN",.404,257,40,6,2)
10,29^6^10,21^0
"KRN",.404,257,40,7,0)
5^!M^1^
"KRN",.404,257,40,7,.1)
S Y="Priority: "_IOINHI_$$PRIOR^WVUTL1A_IOINORM
"KRN",.404,257,40,7,2)
^^6,19
"KRN",.404,257,40,8,0)
2^!M^1^
"KRN",.404,257,40,8,.1)
S Y=IOINORM_"Procedure: "_IOINHI_$$NTPROC^WVUTL1A_IOINORM
"KRN",.404,257,40,8,2)
^^2,38
"KRN",.404,257,40,9,0)
10^Patient Ed^3
"KRN",.404,257,40,9,1)
.09
"KRN",.404,257,40,9,2)
10,69^7^10,57
"KRN",.404,257,40,10,0)
7^Complete by (Date)^3
"KRN",.404,257,40,10,1)
.13
"KRN",.404,257,40,10,2)
8,29^12^8,9^0
"KRN",.404,257,40,10,4)
^^^1
"KRN",.404,257,40,11,0)
6.5^Print Date^3
"KRN",.404,257,40,11,1)
.11
"KRN",.404,257,40,11,2)
7,69^11^7,57^0
"KRN",.404,257,40,11,4)
^^^1
"KRN",.404,257,40,12,0)
7.5^Printed^3
"KRN",.404,257,40,12,1)
.1
"KRN",.404,257,40,12,2)
8,69^12^8,60
"KRN",.404,257,40,12,4)
^^^1
"KRN",.404,257,40,12,11)
W IOINHI
"KRN",.404,257,40,12,12)
W IOINORM
"KRN",.404,257,40,13,0)
3.5^Facility^3
"KRN",.404,257,40,13,1)
.07
"KRN",.404,257,40,13,2)
4,56^23^4,46
"KRN",.404,257,40,13,4)
^^^1
"KRN",.404,259,0)
WV NOTIFPURPOSE-EDITBLK-1^790.404
"KRN",.404,259,40,0)
^.4044I^9^9
"KRN",.404,259,40,1,0)
1^* * *  EDIT NOTIFICATION PURPOSE & LETTER  * * *^1^
"KRN",.404,259,40,1,2)
^^3,16^
"KRN",.404,259,40,2,0)
2^Purpose of Notification^3
"KRN",.404,259,40,2,1)
.01
"KRN",.404,259,40,2,2)
6,30^48^6,5^0
"KRN",.404,259,40,2,4)
^^^1
"KRN",.404,259,40,3,0)
4^Synonym^3
"KRN",.404,259,40,3,1)
.03
"KRN",.404,259,40,3,2)
10,30^6^10,21^0
"KRN",.404,259,40,4,0)
5^Priority^3
"KRN",.404,259,40,4,1)
.02
"KRN",.404,259,40,4,2)
12,30^10^12,20^0
"KRN",.404,259,40,4,10)
S DDSBR=7
"KRN",.404,259,40,5,0)
6^FORM LETTER (WP)^3
"KRN",.404,259,40,5,1)
1.01
"KRN",.404,259,40,5,2)
12,68^1^12,50^0
"KRN",.404,259,40,6,0)
3^Active^3
"KRN",.404,259,40,6,1)
.04
"KRN",.404,259,40,6,2)
8,30^3^8,22^0
"KRN",.404,259,40,6,3)
YES
"KRN",.404,259,40,6,10)
S:'X DDSBR=8
"KRN",.404,259,40,7,0)
1.5^________________________________________________________________________________^1^
"KRN",.404,259,40,7,2)
^^4,1^
"KRN",.404,259,40,8,0)
7^Result or Reminder Letter^3
"KRN",.404,259,40,8,1)
.06
"KRN",.404,259,40,8,2)
14,30^9^14,3^0
"KRN",.404,259,40,9,0)
8^Associate with BR or CX Tx^3
"KRN",.404,259,40,9,1)
.05
"KRN",.404,259,40,9,2)
15,30^9^15,2^0
"KRN",.404,260,0)
WV SITE PARAMS-EDITBLK-1^790.02
"KRN",.404,260,40,0)
^.4044I^12^10
"KRN",.404,260,40,1,0)
1^!M^1^
"KRN",.404,260,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,260,40,1,2)
^^3,12^
"KRN",.404,260,40,2,0)
2^________________________________________________________________________________^1^
"KRN",.404,260,40,2,2)
^^4,1^
"KRN",.404,260,40,4,0)
4^Default Case Manager^3
"KRN",.404,260,40,4,1)
.02
"KRN",.404,260,40,4,2)
6,33^30^6,11^0
"KRN",.404,260,40,5,0)
5^Ask Case Manager^3
"KRN",.404,260,40,5,1)
.05
"KRN",.404,260,40,5,2)
7,33^3^7,15^0
"KRN",.404,260,40,6,0)
6^Autoqueue Normal PAP Letters^3
"KRN",.404,260,40,6,1)
.03
"KRN",.404,260,40,6,2)
9,33^3^9,3^0
"KRN",.404,260,40,7,0)
7^PAP Result Normal Letter^3
"KRN",.404,260,40,7,1)
.04
"KRN",.404,260,40,7,2)
10,33^47^10,7^0
"KRN",.404,260,40,8,0)
8^Autoqueue Normal MAM Letters^3
"KRN",.404,260,40,8,1)
.07
"KRN",.404,260,40,8,2)
11,33^3^11,3^0
"KRN",.404,260,40,9,0)
9^MAM Result Normal Letter^3
"KRN",.404,260,40,9,1)
.08
"KRN",.404,260,40,9,2)
12,33^47^12,7^0
"KRN",.404,260,40,10,0)
10^Default #days to print letter^3
"KRN",.404,260,40,10,1)
.06
"KRN",.404,260,40,10,2)
14,33^3^14,2^0
"KRN",.404,260,40,12,0)
12^!M^1^
"KRN",.404,260,40,12,.1)
S Y="(PAGE 1 OF 5)"
"KRN",.404,260,40,12,2)
^^17,58
"KRN",.404,261,0)
WV SITE PARAMS-EDITBLK-2^790.02
"KRN",.404,261,40,0)
^.4044I^17^6
"KRN",.404,261,40,1,0)
1^!M^1^
"KRN",.404,261,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,261,40,1,2)
^^3,12^
"KRN",.404,261,40,2,0)
2^________________________________________________________________________________^1^
"KRN",.404,261,40,2,2)
^^4,1
"KRN",.404,261,40,10,0)
6.1^Import Mammograms from Radiology^3
"KRN",.404,261,40,10,1)
.1
"KRN",.404,261,40,10,2)
6,51^3^6,17
"KRN",.404,261,40,10,10)
S:'X DDSBR=12
"KRN",.404,261,40,11,0)
11^!M^1^
"KRN",.404,261,40,11,.1)
S Y="(PAGE 2 OF 5)"
"KRN",.404,261,40,11,2)
^^17,58
"KRN",.404,261,40,14,0)
6.2^Status Given to Imported Mammograms^3
"KRN",.404,261,40,14,1)
.23
"KRN",.404,261,40,14,2)
7,54^6^7,17
"KRN",.404,261,40,14,3)
OPEN
"KRN",.404,261,40,17,0)
6^RADIOLOGY:^1
"KRN",.404,261,40,17,2)
^^6,5
"KRN",.404,312,0)
WV SITE PATAMS-EDITBLK-3^790.02
"KRN",.404,312,40,0)
^.4044I^36^36
"KRN",.404,312,40,1,0)
1^!M^1
"KRN",.404,312,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,312,40,1,2)
^^3,12
"KRN",.404,312,40,2,0)
2^________________________________________________________________________________^1
"KRN",.404,312,40,2,2)
^^4,1
"KRN",.404,312,40,3,0)
3^Procedure Type^1
"KRN",.404,312,40,3,2)
^^6,5
"KRN",.404,312,40,4,0)
3.1^Active^1
"KRN",.404,312,40,4,2)
^^6,31
"KRN",.404,312,40,5,0)
3.3^DAYS DELINQUENT^1
"KRN",.404,312,40,5,2)
^^6,43
"KRN",.404,312,40,6,0)
4^--------------------^1
"KRN",.404,312,40,6,2)
^^7,5
"KRN",.404,312,40,7,0)
4.1^------^1
"KRN",.404,312,40,7,2)
^^7,31
"KRN",.404,312,40,8,0)
5^---------------^1
"KRN",.404,312,40,8,2)
^^7,43
"KRN",.404,312,40,9,0)
4.5^Breast Ultrasound^1
"KRN",.404,312,40,9,2)
^^8,5
"KRN",.404,312,40,10,0)
6^Clinical Breast Exam^1
"KRN",.404,312,40,10,2)
^^9,5
"KRN",.404,312,40,11,0)
7^Colposcopy Impr (No Bx)^1
"KRN",.404,312,40,11,2)
^^10,5
"KRN",.404,312,40,12,0)
8^Colposcopy w/Biopsy^1
"KRN",.404,312,40,12,2)
^^11,5
"KRN",.404,312,40,13,0)
8.1^Cone Biopsy^1
"KRN",.404,312,40,13,2)
^^12,5
"KRN",.404,312,40,14,0)
9^Cryotherapy^1
"KRN",.404,312,40,14,2)
^^13,5
"KRN",.404,312,40,15,0)
10^Ectocervical Biopsy^1
"KRN",.404,312,40,15,2)
^^14,5
"KRN",.404,312,40,16,0)
11^Endocervical Currettage^1
"KRN",.404,312,40,16,2)
^^15,5
"KRN",.404,312,40,17,0)
12^Endometrial Biopsy^1
"KRN",.404,312,40,17,2)
^^16,5
"KRN",.404,312,40,18,0)
4.6^^3
"KRN",.404,312,40,18,1)
38.01
"KRN",.404,312,40,18,2)
8,32^3
"KRN",.404,312,40,19,0)
6.1^^3
"KRN",.404,312,40,19,1)
27.01
"KRN",.404,312,40,19,2)
9,32^3
"KRN",.404,312,40,20,0)
6.6^^3
"KRN",.404,312,40,20,1)
37.01
"KRN",.404,312,40,20,2)
10,32^3
"KRN",.404,312,40,21,0)
7.1^^3
"KRN",.404,312,40,21,1)
2.01
"KRN",.404,312,40,21,2)
11,32^3
"KRN",.404,312,40,22,0)
8.2^^3
"KRN",.404,312,40,22,1)
19.01
"KRN",.404,312,40,22,2)
12,32^3
"KRN",.404,312,40,23,0)
9.1^^3
"KRN",.404,312,40,23,1)
4.01
"KRN",.404,312,40,23,2)
13,32^3
"KRN",.404,312,40,24,0)
10.1^^3
"KRN",.404,312,40,24,1)
17.01
"KRN",.404,312,40,24,2)
14,32^3
"KRN",.404,312,40,25,0)
11.1^^3
"KRN",.404,312,40,25,1)
18.01
"KRN",.404,312,40,25,2)
15,32^3
"KRN",.404,312,40,26,0)
12.1^^3
"KRN",.404,312,40,26,1)
8.01
"KRN",.404,312,40,26,2)
16,32^3
"KRN",.404,312,40,27,0)
4.8^^3
"KRN",.404,312,40,27,1)
38.03
"KRN",.404,312,40,27,2)
8,48^4
"KRN",.404,312,40,28,0)
6.3^^3
"KRN",.404,312,40,28,1)
27.03
"KRN",.404,312,40,28,2)
9,48^4
"KRN",.404,312,40,29,0)
6.8^^3
"KRN",.404,312,40,29,1)
37.03
"KRN",.404,312,40,29,2)
10,48^4
"KRN",.404,312,40,30,0)
7.3^^3
"KRN",.404,312,40,30,1)
2.03
"KRN",.404,312,40,30,2)
11,48^4
"KRN",.404,312,40,31,0)
8.3^^3
"KRN",.404,312,40,31,1)
19.03
"KRN",.404,312,40,31,2)
12,48^4
"KRN",.404,312,40,32,0)
9.3^^3
"KRN",.404,312,40,32,1)
4.03
"KRN",.404,312,40,32,2)
13,48^4
"KRN",.404,312,40,33,0)
10.3^^3
"KRN",.404,312,40,33,1)
7.03
"KRN",.404,312,40,33,2)
14,48^4
"KRN",.404,312,40,34,0)
11.3^^3
"KRN",.404,312,40,34,1)
18.03
"KRN",.404,312,40,34,2)
15,48^4
"KRN",.404,312,40,35,0)
12.3^^3
"KRN",.404,312,40,35,1)
8.03
"KRN",.404,312,40,35,2)
16,48^4
"KRN",.404,312,40,36,0)
20^!M^1
"KRN",.404,312,40,36,.1)
S Y="(PAGE 3 OF 5)"
"KRN",.404,312,40,36,2)
^^17,57
"KRN",.404,313,0)
WV SITE PARAMS-EDITBLK-4^790.02
"KRN",.404,313,40,0)
^.4044I^36^36
"KRN",.404,313,40,1,0)
1^!M^1
"KRN",.404,313,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,313,40,1,2)
^^3,12
"KRN",.404,313,40,2,0)
2^________________________________________________________________________________^1
"KRN",.404,313,40,2,2)
^^4,1
"KRN",.404,313,40,3,0)
3^Procedure Type^1
"KRN",.404,313,40,3,2)
^^6,5
"KRN",.404,313,40,4,0)
3.1^Active^1
"KRN",.404,313,40,4,2)
^^6,31
"KRN",.404,313,40,5,0)
3.2^DAYS DELINQUENT^1
"KRN",.404,313,40,5,2)
^^6,43
"KRN",.404,313,40,6,0)
4^--------------------^1
"KRN",.404,313,40,6,2)
^^7,5
"KRN",.404,313,40,7,0)
4.1^------^1
"KRN",.404,313,40,7,2)
^^7,31
"KRN",.404,313,40,8,0)
4.2^---------------^1
"KRN",.404,313,40,8,2)
^^7,43
"KRN",.404,313,40,9,0)
4.5^Fine Needle Aspiration^1
"KRN",.404,313,40,9,2)
^^8,5
"KRN",.404,313,40,10,0)
4.6^^3
"KRN",.404,313,40,10,1)
34.01
"KRN",.404,313,40,10,2)
8,32^3
"KRN",.404,313,40,11,0)
4.8^^3
"KRN",.404,313,40,11,1)
34.03
"KRN",.404,313,40,11,2)
8,48^4
"KRN",.404,313,40,12,0)
5^General Surgery Consult^1
"KRN",.404,313,40,12,2)
^^9,5
"KRN",.404,313,40,13,0)
5.1^^3
"KRN",.404,313,40,13,1)
29.01
"KRN",.404,313,40,13,2)
9,32^3
"KRN",.404,313,40,14,0)
5.3^^3
"KRN",.404,313,40,14,1)
29.03
"KRN",.404,313,40,14,2)
9,48^4
"KRN",.404,313,40,15,0)
6^Gyn Onc Consult^1
"KRN",.404,313,40,15,2)
^^10,5
"KRN",.404,313,40,16,0)
6.1^^3
"KRN",.404,313,40,16,1)
24.01
"KRN",.404,313,40,16,2)
10,32^3
"KRN",.404,313,40,17,0)
6.3^^3
"KRN",.404,313,40,17,1)
24.03
"KRN",.404,313,40,17,2)
10,48^4
"KRN",.404,313,40,18,0)
7^Hysterectomy^1
"KRN",.404,313,40,18,2)
^^11,5
"KRN",.404,313,40,19,0)
7.1^^3
"KRN",.404,313,40,19,1)
3.01
"KRN",.404,313,40,19,2)
11,32^3
"KRN",.404,313,40,20,0)
7.3^^3
"KRN",.404,313,40,20,1)
3.03
"KRN",.404,313,40,20,2)
11,48^4
"KRN",.404,313,40,21,0)
8^Laser Abilation^1
"KRN",.404,313,40,21,2)
^^12,5
"KRN",.404,313,40,22,0)
8.1^^3
"KRN",.404,313,40,22,1)
22.01
"KRN",.404,313,40,22,2)
12,32^3
"KRN",.404,313,40,23,0)
8.3^^3
"KRN",.404,313,40,23,1)
22.03
"KRN",.404,313,40,23,2)
12,48^4
"KRN",.404,313,40,24,0)
9^Laser Cone^1
"KRN",.404,313,40,24,2)
^^13,5
"KRN",.404,313,40,25,0)
9.1^^3
"KRN",.404,313,40,25,1)
23.01
"KRN",.404,313,40,25,2)
13,32^3
"KRN",.404,313,40,26,0)
9.3^^3
"KRN",.404,313,40,26,1)
23.03
"KRN",.404,313,40,26,2)
13,48^4
"KRN",.404,313,40,27,0)
10^LEEP^1
"KRN",.404,313,40,27,2)
^^14,5
"KRN",.404,313,40,28,0)
10.1^^3
"KRN",.404,313,40,28,1)
17.01
"KRN",.404,313,40,28,2)
14,32^3
"KRN",.404,313,40,29,0)
10.3^^3
"KRN",.404,313,40,29,1)
17.03
"KRN",.404,313,40,29,2)
14,48^4
"KRN",.404,313,40,30,0)
11^Lumpectomy^1
"KRN",.404,313,40,30,2)
^^15,5
"KRN",.404,313,40,31,0)
11.1^^3
"KRN",.404,313,40,31,1)
32.01
"KRN",.404,313,40,31,2)
15,32^3
"KRN",.404,313,40,32,0)
11.3^^3
"KRN",.404,313,40,32,1)
32.03
"KRN",.404,313,40,32,2)
15,48^4
"KRN",.404,313,40,33,0)
12^Mammogram Dx Bilat^1
"KRN",.404,313,40,33,2)
^^16,5
"KRN",.404,313,40,34,0)
12.1^^3
"KRN",.404,313,40,34,1)
25.01
"KRN",.404,313,40,34,2)
16,32^3
"KRN",.404,313,40,35,0)
12.3^^3
"KRN",.404,313,40,35,1)
25.03
"KRN",.404,313,40,35,2)
16,48^4
"KRN",.404,313,40,36,0)
20^!M^1
"KRN",.404,313,40,36,.1)
S Y="(PAGE 4 OF 5)"
"KRN",.404,313,40,36,2)
^^17,58
"KRN",.404,314,0)
WV SITE PARAMS-EDITBLK-5^790.02
"KRN",.404,314,40,0)
^.4044I^36^36
"KRN",.404,314,40,1,0)
1^!M^1
"KRN",.404,314,40,1,.1)
S Y="* * *  EDIT SITE PARAMETERS FOR "_IOINHI_$P(^DIC(4,DA,0),U)_IOINORM_"  * * *"
"KRN",.404,314,40,1,2)
^^3,12
"KRN",.404,314,40,2,0)
2^________________________________________________________________________________^1
"KRN",.404,314,40,2,2)
^^4,1
"KRN",.404,314,40,3,0)
3^Procedure Type^1
"KRN",.404,314,40,3,2)
^^6,5
"KRN",.404,314,40,4,0)
3.1^Active^1
"KRN",.404,314,40,4,2)
^^6,31
"KRN",.404,314,40,5,0)
3.3^DAYS DELINQUENT^1
"KRN",.404,314,40,5,2)
^^6,43
"KRN",.404,314,40,6,0)
4^--------------------^1
"KRN",.404,314,40,6,2)
^^7,5
"KRN",.404,314,40,7,0)
4.1^------^1
"KRN",.404,314,40,7,2)
^^7,31
"KRN",.404,314,40,8,0)
4.3^---------------^1
"KRN",.404,314,40,8,2)
^^7,43
"KRN",.404,314,40,9,0)
5^Mamogram Dx Unilat^1
"KRN",.404,314,40,9,2)
^^8,5
"KRN",.404,314,40,10,0)
5.1^^3
"KRN",.404,314,40,10,1)
26.01
"KRN",.404,314,40,10,2)
8,32^3
"KRN",.404,314,40,11,0)
5.3^^3
"KRN",.404,314,40,11,1)
26.03
"KRN",.404,314,40,11,2)
8,48^4
"KRN",.404,314,40,12,0)
6^Mammogram Screening^1
"KRN",.404,314,40,12,2)
^^9,5
"KRN",.404,314,40,13,0)
6.1^^3
"KRN",.404,314,40,13,1)
28.01
"KRN",.404,314,40,13,2)
9,32^3
"KRN",.404,314,40,14,0)
6.2^^3
"KRN",.404,314,40,14,1)
28.03
"KRN",.404,314,40,14,2)
9,48^4
"KRN",.404,314,40,14,3)

"KRN",.404,314,40,15,0)
7^Mastectomy^1
"KRN",.404,314,40,15,2)
^^10,5
"KRN",.404,314,40,16,0)
7.1^^3
"KRN",.404,314,40,16,1)
33.01
"KRN",.404,314,40,16,2)
10,32^3
"KRN",.404,314,40,17,0)
7.3^^3
"KRN",.404,314,40,17,1)
33.03
"KRN",.404,314,40,17,2)
10,48^4
"KRN",.404,314,40,18,0)
8^Needle Biopsy^1
"KRN",.404,314,40,18,2)
^^11,5
"KRN",.404,314,40,19,0)
8.1^^3
"KRN",.404,314,40,19,1)
30.01
"KRN",.404,314,40,19,2)
11,32^3
"KRN",.404,314,40,20,0)
8.3^^3
"KRN",.404,314,40,20,1)
30.03
"KRN",.404,314,40,20,2)
11,48^4
"KRN",.404,314,40,21,0)
9^Open Biopsy^1
"KRN",.404,314,40,21,2)
^^12,5
"KRN",.404,314,40,22,0)
9.1^^3
"KRN",.404,314,40,22,1)
31.01
"KRN",.404,314,40,22,2)
12,32^3
"KRN",.404,314,40,23,0)
9.3^^3
"KRN",.404,314,40,23,1)
31.03
"KRN",.404,314,40,23,2)
12,48^4
"KRN",.404,314,40,24,0)
10^PAP Smear^1
"KRN",.404,314,40,24,2)
^^13,5
"KRN",.404,314,40,25,0)
10.1^^3
"KRN",.404,314,40,25,1)
1.01
"KRN",.404,314,40,25,2)
13,32^3
"KRN",.404,314,40,26,0)
10.3^^3
"KRN",.404,314,40,26,1)
1.03
"KRN",.404,314,40,26,2)
13,48^4
"KRN",.404,314,40,27,0)
11^Pregnancy Test^1
"KRN",.404,314,40,27,2)
^^14,5
"KRN",.404,314,40,28,0)
11.1^^3
"KRN",.404,314,40,28,1)
20.01
"KRN",.404,314,40,28,2)
14,32^3
"KRN",.404,314,40,29,0)
11.3^^3
"KRN",.404,314,40,29,1)
20.03
"KRN",.404,314,40,29,2)
14,48^4
"KRN",.404,314,40,30,0)
12^STD Evaluation^1
"KRN",.404,314,40,30,2)
^^15,5
"KRN",.404,314,40,31,0)
12.1^^3
"KRN",.404,314,40,31,1)
21.01
"KRN",.404,314,40,31,2)
15,32^3
"KRN",.404,314,40,32,0)
12.3^^3
"KRN",.404,314,40,32,1)
21.03
"KRN",.404,314,40,32,2)
15,48^4
"KRN",.404,314,40,33,0)
13^Stereotactic Biopsy^1
"KRN",.404,314,40,33,2)
^^16,5
"KRN",.404,314,40,34,0)
13.1^^3
"KRN",.404,314,40,34,1)
35.01
"KRN",.404,314,40,34,2)
16,32^3
"KRN",.404,314,40,35,0)
13.3^^3
"KRN",.404,314,40,35,1)
35.03
"KRN",.404,314,40,35,2)
16,48^4
"KRN",.404,314,40,36,0)
20^!M^1
"KRN",.404,314,40,36,.1)
S Y="(PAGE 5 OF 5)"
"KRN",.404,314,40,36,2)
^^17,57
"KRN",.404,315,0)
WV PROC-DISPLAY-1^790.1^
"KRN",.404,315,40,0)
^.4044I^33^30
"KRN",.404,315,40,1,0)
1^* * *  EDIT A PROCEDURE  * * *^1
"KRN",.404,315,40,1,2)
^^1,19
"KRN",.404,315,40,2,0)
2^Patient Name:^1
"KRN",.404,315,40,2,2)
^^2,1
"KRN",.404,315,40,3,0)
3^Case Manager:^1
"KRN",.404,315,40,3,2)
^^3,1
"KRN",.404,315,40,5,0)
5^!M^1
"KRN",.404,315,40,5,.1)
S Y="PAP Regimen :"
"KRN",.404,315,40,5,2)
^^4,1
"KRN",.404,315,40,6,0)
6^Br Tx Need  :^1
"KRN",.404,315,40,6,2)
^^6,1
"KRN",.404,315,40,7,0)
2.5^SSN:^1
"KRN",.404,315,40,7,2)
^^2,56
"KRN",.404,315,40,8,0)
3.5^Procedure:^1
"KRN",.404,315,40,8,2)
^^3,50
"KRN",.404,315,40,9,0)
4.5^Cx Facility:^1
"KRN",.404,315,40,9,2)
^^5,48
"KRN",.404,315,40,10,0)
6.5^Br Facility:^1
"KRN",.404,315,40,10,2)
^^6,48
"KRN",.404,315,40,11,0)
5.5^Acc#:^1
"KRN",.404,315,40,11,2)
^^4,55
"KRN",.404,315,40,12,0)
2.2^!M^1
"KRN",.404,315,40,12,.1)
S Y=IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,315,40,12,2)
^^2,15
"KRN",.404,315,40,13,0)
3.2^!M^1
"KRN",.404,315,40,13,.1)
S Y=IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,13,2)
^^3,15
"KRN",.404,315,40,14,0)
4.2^!M^1
"KRN",.404,315,40,14,.1)
S Y=IOINHI_$E($$PROC1^WVUTL1A,1,19)_IOINORM
"KRN",.404,315,40,14,2)
^^3,61
"KRN",.404,315,40,16,0)
5.3^Cx Tx Need  :^1
"KRN",.404,315,40,16,2)
^^5,1
"KRN",.404,315,40,17,0)
5.4^!M^1
"KRN",.404,315,40,17,.1)
S Y=IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,315,40,17,2)
^^5,15
"KRN",.404,315,40,18,0)
4.3^!M^1
"KRN",.404,315,40,18,.1)
S Y=IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,315,40,18,2)
^^4,15
"KRN",.404,315,40,19,0)
6.2^ ^1
"KRN",.404,315,40,19,2)
^^4,11
"KRN",.404,315,40,20,0)
2.8^!M^1
"KRN",.404,315,40,20,.1)
S Y=IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,20,2)
^^2,61
"KRN",.404,315,40,21,0)
4.8^!M^1
"KRN",.404,315,40,21,.1)
S Y=IOINHI_$$ACC^WVUTL1(DA)_IOINORM
"KRN",.404,315,40,21,2)
^^4,61
"KRN",.404,315,40,23,0)
6.4^!M^1
"KRN",.404,315,40,23,.1)
S Y=IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,315,40,23,2)
^^6,15
"KRN",.404,315,40,24,0)
20^--------------------------------------------------------------------------------^1
"KRN",.404,315,40,24,2)
^^8,1
"KRN",.404,315,40,25,0)
19^!M^1
"KRN",.404,315,40,25,.1)
S Y=IOINHI_$$EDC^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,25,2)
^^8,48
"KRN",.404,315,40,26,0)
17^!M^1
"KRN",.404,315,40,26,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")
"KRN",.404,315,40,26,2)
^^7,31
"KRN",.404,315,40,27,0)
21^!M^1
"KRN",.404,315,40,27,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"C")_IOINORM
"KRN",.404,315,40,27,2)
^^5,61
"KRN",.404,315,40,28,0)
22^!M^1
"KRN",.404,315,40,28,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"B")_IOINORM
"KRN",.404,315,40,28,2)
^^6,61
"KRN",.404,315,40,29,0)
23^Sexual Trauma:^1
"KRN",.404,315,40,29,2)
^^7,1
"KRN",.404,315,40,30,0)
24^!M^1
"KRN",.404,315,40,30,.1)
S Y=IOINHI_$$MST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,315,40,30,2)
^^7,16
"KRN",.404,315,40,32,0)
25^Veteran:^1
"KRN",.404,315,40,32,2)
^^7,52
"KRN",.404,315,40,33,0)
26^!M^1
"KRN",.404,315,40,33,.1)
S Y=IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,315,40,33,2)
^^7,61
"KRN",.404,318,0)
WV REFUSAL-DISPLAY-1^790.1^
"KRN",.404,318,40,0)
^.4044I^32^24
"KRN",.404,318,40,1,0)
1^* * *  ADD/EDIT A REFUSAL  * * *^1
"KRN",.404,318,40,1,2)
^^1,22
"KRN",.404,318,40,2,0)
2^Patient Name:^1
"KRN",.404,318,40,2,2)
^^3,1
"KRN",.404,318,40,3,0)
3^Case Manager:^1
"KRN",.404,318,40,3,2)
^^4,1
"KRN",.404,318,40,5,0)
5^!M^1
"KRN",.404,318,40,5,.1)
S Y="PAP Regimen:"
"KRN",.404,318,40,5,2)
^^4,48
"KRN",.404,318,40,6,0)
6^Br Tx Need  :^1
"KRN",.404,318,40,6,2)
^^6,1
"KRN",.404,318,40,7,0)
2.5^SSN:^1
"KRN",.404,318,40,7,2)
^^3,56
"KRN",.404,318,40,9,0)
4.5^Cx Tx Fac:^1
"KRN",.404,318,40,9,2)
^^5,50
"KRN",.404,318,40,10,0)
6.5^Br Tx Fac:^1
"KRN",.404,318,40,10,2)
^^6,50
"KRN",.404,318,40,12,0)
2.2^!M^1
"KRN",.404,318,40,12,.1)
S Y=IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,318,40,12,2)
^^3,15
"KRN",.404,318,40,13,0)
3.2^!M^1
"KRN",.404,318,40,13,.1)
S Y=IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,318,40,13,2)
^^4,15
"KRN",.404,318,40,16,0)
5.3^Cx Tx Need  :^1
"KRN",.404,318,40,16,2)
^^5,1
"KRN",.404,318,40,17,0)
5.4^!M^1
"KRN",.404,318,40,17,.1)
S Y=IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,318,40,17,2)
^^5,15
"KRN",.404,318,40,18,0)
4.3^!M^1
"KRN",.404,318,40,18,.1)
S Y=IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,318,40,18,2)
^^4,61
"KRN",.404,318,40,20,0)
2.8^!M^1
"KRN",.404,318,40,20,.1)
S Y=IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,318,40,20,2)
^^3,61
"KRN",.404,318,40,23,0)
6.4^!M^1
"KRN",.404,318,40,23,.1)
S Y=IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,318,40,23,2)
^^6,15
"KRN",.404,318,40,24,0)
20^--------------------------------------------------------------------------------^1
"KRN",.404,318,40,24,2)
^^9,1
"KRN",.404,318,40,25,0)
19^!M^1
"KRN",.404,318,40,25,.1)
S Y=$$EDC^WVUTL1(WVDFN)
"KRN",.404,318,40,25,2)
^^8,61
"KRN",.404,318,40,26,0)
17^!M^1
"KRN",.404,318,40,26,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")
"KRN",.404,318,40,26,2)
^^7,61
"KRN",.404,318,40,27,0)
21^!M^1
"KRN",.404,318,40,27,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"C")_IOINORM
"KRN",.404,318,40,27,2)
^^5,61
"KRN",.404,318,40,28,0)
22^!M^1
"KRN",.404,318,40,28,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"B")_IOINORM
"KRN",.404,318,40,28,2)
^^6,61
"KRN",.404,318,40,29,0)
23^Sexual Trauma:^1
"KRN",.404,318,40,29,2)
^^7,1
"KRN",.404,318,40,30,0)
24^!M^1
"KRN",.404,318,40,30,.1)
S Y=IOINHI_$$MST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,318,40,30,2)
^^7,16
"KRN",.404,318,40,31,0)
25^Veteran:^1
"KRN",.404,318,40,31,2)
^^8,7
"KRN",.404,318,40,32,0)
26^!M^1
"KRN",.404,318,40,32,.1)
S Y=IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,318,40,32,2)
^^8,16
"KRN",.404,319,0)
WV REFUSAL-EDIT-1^790.3
"KRN",.404,319,40,0)
^.4044I^5^4
"KRN",.404,319,40,1,0)
1^Date Refused^3
"KRN",.404,319,40,1,1)
.01
"KRN",.404,319,40,1,2)
2,15^11^2,1
"KRN",.404,319,40,1,11)
W IOINHI
"KRN",.404,319,40,1,12)
W IOINORM
"KRN",.404,319,40,2,0)
4^Reason^3
"KRN",.404,319,40,2,1)
3
"KRN",.404,319,40,2,2)
6,15^17^6,7
"KRN",.404,319,40,3,0)
5^Comments^3
"KRN",.404,319,40,3,1)
4
"KRN",.404,319,40,3,2)
8,15^63^8,5
"KRN",.404,319,40,5,0)
3^Procedure^3
"KRN",.404,319,40,5,1)
2
"KRN",.404,319,40,5,2)
4,15^30^4,4
"KRN",.404,324,0)
WV PROC-EDITBLK-LAB^790.1
"KRN",.404,324,11)

"KRN",.404,324,15,0)
1^^1^1^2960118^^^^
"KRN",.404,324,15,1,0)
WV PROCEDURE-EDIT-BLOCK-1
"KRN",.404,324,40,0)
^.4044I^5^4
"KRN",.404,324,40,1,0)
1^Date of Procedure^3
"KRN",.404,324,40,1,1)
.12
"KRN",.404,324,40,1,2)
3,25^18^3,6
"KRN",.404,324,40,1,3)
T
"KRN",.404,324,40,1,4)
1
"KRN",.404,324,40,1,13)
N WVX S WVX=$$PDELQ1^WVUTL4(DA,X,DUZ(2)) D PUT^DDSVAL(DIE,DA,.13,WVX)
"KRN",.404,324,40,3,0)
3^Clinician/Provider^3
"KRN",.404,324,40,3,1)
.07
"KRN",.404,324,40,3,2)
4,25^25^4,5
"KRN",.404,324,40,3,4)
0
"KRN",.404,324,40,4,0)
4^Ward/Clinic/Location^3
"KRN",.404,324,40,4,1)
.11
"KRN",.404,324,40,4,2)
5,25^30^5,3
"KRN",.404,324,40,4,4)
0
"KRN",.404,324,40,4,12)
D PUT^DDSVAL(790.1,.DA,.1,$$INSTIT^WVUTL6)
"KRN",.404,324,40,5,0)
5^Health Care Facility^3
"KRN",.404,324,40,5,1)
.1
"KRN",.404,324,40,5,2)
6,25^30^6,3
"KRN",.404,324,40,5,4)
1
"KRN",.404,326,0)
WV PATIENT-HEADER-2^790^
"KRN",.404,326,40,0)
^.4044I^9^9
"KRN",.404,326,40,1,0)
1^* * *  EDIT PATIENT CASE DATA  * * *^1
"KRN",.404,326,40,1,2)
^^1,22
"KRN",.404,326,40,2,0)
2^!M^1
"KRN",.404,326,40,2,.1)
S Y=IOINORM_"Patient Name: "_IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,326,40,2,2)
^^3,1
"KRN",.404,326,40,3,0)
3^!M^1
"KRN",.404,326,40,3,.1)
S Y=IOINORM_$$PNLAB^WVUTL5()_IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,326,40,3,2)
^^3,52
"KRN",.404,326,40,4,0)
4^!M^1
"KRN",.404,326,40,4,.1)
S Y=IOINORM_"Street: "_IOINHI_$$STREET^WVUTL1(WVDFN)_IOINORM
"KRN",.404,326,40,4,2)
^^4,7
"KRN",.404,326,40,5,0)
5^!M^1
"KRN",.404,326,40,5,.1)
S Y=IOINORM_"Patient Phone: "_IOINHI_$$HPHONE^WVUTL1(WVDFN)
"KRN",.404,326,40,5,2)
^^4,45
"KRN",.404,326,40,6,0)
6^!M^1
"KRN",.404,326,40,6,.1)
S Y=IOINORM_"Cty/St/Zip: "_IOINHI_$$CTYSTZ^WVUTL1(WVDFN)_IOINORM
"KRN",.404,326,40,6,2)
^^5,3
"KRN",.404,326,40,7,0)
7^!M^1
"KRN",.404,326,40,7,.1)
S Y=IOINORM_"Pr Provider: "_IOINHI_$E($$PROVI^WVUTL1A(WVDFN),1,20)
"KRN",.404,326,40,7,2)
^^5,47
"KRN",.404,326,40,8,0)
8^!M^1
"KRN",.404,326,40,8,.1)
S Y=IOINORM_"Veteran: "_IOINHI_$$VET^WVUTL1A(WVDFN)
"KRN",.404,326,40,8,2)
^^6,6
"KRN",.404,326,40,9,0)
9^________________________________________________________________________________^1
"KRN",.404,326,40,9,2)
^^7,1
"KRN",.404,327,0)
WV PROC-HEADER-1^790.1^
"KRN",.404,327,40,0)
^.4044I^13^13
"KRN",.404,327,40,1,0)
1^* * *  EDIT A PROCEDURE  * * *^1
"KRN",.404,327,40,1,2)
^^1,24
"KRN",.404,327,40,2,0)
2^!M^1
"KRN",.404,327,40,2,.1)
S Y=IOINORM_"Patient Name: "_IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,327,40,2,2)
^^3,1
"KRN",.404,327,40,3,0)
3^!M^1
"KRN",.404,327,40,3,.1)
S Y=IOINORM_$$PNLAB^WVUTL5()_IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,327,40,3,2)
^^3,53
"KRN",.404,327,40,4,0)
4^!M^1
"KRN",.404,327,40,4,.1)
S Y=IOINORM_"Case Manager: "_IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,327,40,4,2)
^^4,1
"KRN",.404,327,40,5,0)
5^!M^1
"KRN",.404,327,40,5,.1)
S Y=IOINORM_"Procedure: "_IOINHI_$E($$PROC1^WVUTL1A,1,19)_IOINORM
"KRN",.404,327,40,5,2)
^^4,50
"KRN",.404,327,40,6,0)
6^!M^1
"KRN",.404,327,40,6,.1)
S Y=IOINORM_"Cx Tx Need  : "_IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,327,40,6,2)
^^5,1
"KRN",.404,327,40,7,0)
7^!M^1
"KRN",.404,327,40,7,.1)
S Y=IOINORM_"Acc#: "_IOINHI_$$ACC^WVUTL1(DA)_IOINORM
"KRN",.404,327,40,7,2)
^^5,55
"KRN",.404,327,40,8,0)
8^!M^1
"KRN",.404,327,40,8,.1)
S Y=IOINORM_"PAP Regimen : "_IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,327,40,8,2)
^^6,1
"KRN",.404,327,40,9,0)
10^!M^1
"KRN",.404,327,40,9,.1)
S Y=IOINORM_"Br Tx Need  : "_IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,327,40,9,2)
^^7,1
"KRN",.404,327,40,10,0)
11^!M^1
"KRN",.404,327,40,10,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")_IOINORM
"KRN",.404,327,40,10,2)
^^7,61
"KRN",.404,327,40,11,0)
12^!M^1
"KRN",.404,327,40,11,.1)
S Y=IOINORM_"Veteran     : "_IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,327,40,11,2)
^^8,1
"KRN",.404,327,40,12,0)
13^!M^1
"KRN",.404,327,40,12,.1)
S Y=IOINHI_$$EDC^WVUTL1(WVDFN)_IOINORM
"KRN",.404,327,40,12,2)
^^8,51
"KRN",.404,327,40,13,0)
14^--------------------------------------------------------------------------------^1
"KRN",.404,327,40,13,2)
^^9,1
"KRN",19,10271,-1)
0^45
"KRN",19,10271,0)
WVMENU^Women's Health Menu^^M^^^^^^^^WOMEN'S HEALTH^^1^1^^1
"KRN",19,10271,1,0)
^^2^2^2980828^^
"KRN",19,10271,1,1,0)
The Women's Health main menu.  This contains menus for Patient Management,
"KRN",19,10271,1,2,0)
Management Reports, and Manager's Functions.
"KRN",19,10271,10,0)
^19.01PI^4^4
"KRN",19,10271,10,1,0)
10282^PM^1
"KRN",19,10271,10,1,"^")
WV MENU-PATIENT MANAGEMENT
"KRN",19,10271,10,3,0)
10284^MF^3
"KRN",19,10271,10,3,"^")
WV MENU-MANAGER'S FUNCTIONS
"KRN",19,10271,10,4,0)
10285^MR^2
"KRN",19,10271,10,4,"^")
WV MENU-MANAGEMENT REPORTS
"KRN",19,10271,15)
D KILLALL^WVUTL8
"KRN",19,10271,20)
D CHECK^WVLOGO
"KRN",19,10271,26)
D ^WVLOGO
"KRN",19,10271,99)
57583,47434
"KRN",19,10271,"U")
WOMEN'S HEALTH MENU
"KRN",19,10272,-1)
0^2
"KRN",19,10272,0)
WV ADD A NEW PROCEDURE^Add a NEW Procedure^^R^^^^^^^^WOMEN'S HEALTH^^1^
"KRN",19,10272,1,0)
^^1^1^2980730^^
"KRN",19,10272,1,1,0)
This option allows you to add Procedures for patients.
"KRN",19,10272,15)

"KRN",19,10272,20)
W @IOF
"KRN",19,10272,25)
WVPROC
"KRN",19,10272,99)
56445,52444
"KRN",19,10272,"U")
ADD A NEW PROCEDURE
"KRN",19,10273,-1)
0^19
"KRN",19,10273,0)
WV EDIT PROCEDURE^Edit a Procedure^^R^^^^^^^^WOMEN'S HEALTH^^1^
"KRN",19,10273,1,0)
^^1^1^2980923^
"KRN",19,10273,1,1,0)
This option allows you to edit procedures for patients.
"KRN",19,10273,15)

"KRN",19,10273,20)
W @IOF
"KRN",19,10273,25)
EDIT^WVPROC
"KRN",19,10273,"U")
EDIT A PROCEDURE
"KRN",19,10274,-1)
0^1
"KRN",19,10274,0)
WV ADD A NEW NOTIFICATION^Add a New Notification^^R^^^^^^^^WOMEN'S HEALTH^^^
"KRN",19,10274,1,0)
^^1^1^2980610^
"KRN",19,10274,1,1,0)
This option allows you to add new notifications for patients.  A notification is a communication between the clinic staff and the patient.
"KRN",19,10274,15)

"KRN",19,10274,25)
WVNOTIF
"KRN",19,10274,"U")
ADD A NEW NOTIFICATION
"KRN",19,10275,-1)
0^15
"KRN",19,10275,0)
WV EDIT NOTIFICATION^Edit a Notification^^R^^^^^^^^WOMEN'S HEALTH^^^
"KRN",19,10275,1,0)
^^1^1^2980610^
"KRN",19,10275,1,1,0)
This option allows you to edit a notification that already exist.
"KRN",19,10275,15)

"KRN",19,10275,25)
EDIT^WVNOTIF
"KRN",19,10275,"U")
EDIT A NOTIFICATION
"KRN",19,10276,-1)
0^10
"KRN",19,10276,0)
WV BROWSE NOTIFICATIONS^Browse Notifications^^R^^^^^^^^WOMEN'S HEALTH^^^
"KRN",19,10276,1,0)
^^1^1^2980610^
"KRN",19,10276,1,1,0)
This option allows you to search for and browse through Notifications.
"KRN",19,10276,15)

"KRN",19,10276,25)
WVBRNOT
"KRN",19,10276,"U")
BROWSE NOTIFICATIONS
"KRN",19,10277,-1)
0^11
"KRN",19,10277,0)
WV BROWSE PROCEDURES^Browse Procedures^^R^^^^^^^^WOMEN'S HEALTH^^^
"KRN",19,10277,1,0)
^^1^1^2980610^
"KRN",19,10277,1,1,0)
This option allows you to search for and browse through procedures.
"KRN",19,10277,15)

"KRN",19,10277,25)
WVBRPCD
"KRN",19,10277,"U")
BROWSE PROCEDURES
"KRN",19,10278,-1)
0^28
"KRN",19,10278,0)
WV PATIENT PROFILE^Patient Profile^^R^^^^^^^^WOMEN'S HEALTH^^^
"KRN",19,10278,1,0)
^^2^2^2980813^
"KRN",19,10278,1,1,0)
This option allows you to look at all of the Procedures and Notifications
"KRN",19,10278,1,2,0)
associated with an individual patient.
"KRN",19,10278,15)

"KRN",19,10278,25)
WVPROF
"KRN",19,10278,99)
56621,43681
"KRN",19,10278,"U")
PATIENT PROFILE
"KRN",19,10279,-1)
0^5
"KRN",19,10279,0)
WV ADD/EDIT NOT PURPOSE&LETTER^Add/Edit a Notification Purpose & Letter^^R^^^^^^^^WOMEN'S HEALTH^^^1
"KRN",19,10279,1,0)
^^2^2^2980610^
"KRN",19,10279,1,1,0)
This option allows the program manager to add or edit Purposes of 
"KRN",19,10279,1,2,0)
Notification.
"KRN",19,10279,15)
W @IOF
"KRN",19,10279,25)
EDITPUR^WVPURP
"KRN",19,10279,"U")
ADD/EDIT A NOTIFICATION PURPOS
"KRN",19,10280,-1)
0^35
"KRN",19,10280,0)
WV PRINT NOTIF PURPOSE&LETTER^Print Notification Purpose & Letter File^^R^^^^^^^^WOMEN'S HEALTH^^^1
"KRN",19,10280,1,0)
^^2^2^2980610^
"KRN",19,10280,1,1,0)
This option prints out all of the Purposes of Notifications and their field
"KRN",19,10280,1,2,0)
values along with the form letter.
"KRN",19,10280,15)
W @IOF
"KRN",19,10280,25)
PRINTPUR^WVPURP
"KRN",19,10280,"U")
PRINT NOTIFICATION PURPOSE & L
"KRN",19,10281,-1)
0^22
"KRN",19,10281,0)
WV MENU-FILE MAINTENANCE^File Maintenance Menu^^M^^^^^^^^WOMEN'S HEALTH^^1^^^
"KRN",19,10281,1,0)
^^2^2^2980914^^^^
"KRN",19,10281,1,1,0)
All of the software setup options for the Women's Health package are
"KRN",19,10281,1,2,0)
located under this menu.
"KRN",19,10281,10,0)
^19.01PI^21^19
"KRN",19,10281,10,1,0)
10279^AEP^1
"KRN",19,10281,10,1,"^")
WV ADD/EDIT NOT PURPOSE&LETTER
"KRN",19,10281,10,2,0)
10280^PPL^2
"KRN",19,10281,10,2,"^")
WV PRINT NOTIF PURPOSE&LETTER
"KRN",19,10281,10,3,0)
10289^ESP^4
"KRN",19,10281,10,3,"^")
WV EDIT SITE PARAMETERS
"KRN",19,10281,10,5,0)
10290^PRD^7
"KRN",19,10281,10,5,"^")
WV PRINT RES/DIAG FILE
"KRN",19,10281,10,8,0)
10315^ESN^2.5
"KRN",19,10281,10,8,"^")
WV EDIT NOTIF TYPE SYNONYM
"KRN",19,10281,10,9,0)
10316^OUT^2.7
"KRN",19,10281,10,9,"^")
WV ADD/EDIT NOTIF OUTCOME
"KRN",19,10281,10,11,0)
10288^CM^4.5
"KRN",19,10281,10,11,"^")
WV ADD/EDIT CASE MANAGERS
"KRN",19,10281,10,12,0)
10318^PDX^11
"KRN",19,10281,10,12,"^")
WV PRINT DIAG TRANSLATION
"KRN",19,10281,10,13,0)
10319^EDX^10
"KRN",19,10281,10,13,"^")
WV EDIT DIAG TRANSLATION
"KRN",19,10281,10,14,0)
10326^ESR^8
"KRN",19,10281,10,14,"^")
WV EDIT RES/DIAG SYNONYMS
"KRN",19,10281,10,15,0)
10327^PSR^9
"KRN",19,10281,10,15,"^")
WV PRINT RES/DIAG SYNONYMS
"KRN",19,10281,10,16,0)
10338^TR^4.6
"KRN",19,10281,10,16,"^")
WV TRANSFER CASE MANAGER
"KRN",19,10281,10,17,0)
10339^RS
"KRN",19,10281,10,17,"^")
WV ADD/EDIT REFERRAL SOURCE
"KRN",19,10281,10,18,0)
10512^^3
"KRN",19,10281,10,18,"^")
WV LINE FOR MENUS
"KRN",19,10281,10,19,0)
10512^^5
"KRN",19,10281,10,19,"^")
WV LINE FOR MENUS
"KRN",19,10281,10,20,0)
10324^AUTO^4.7
"KRN",19,10281,10,20,"^")
WV AUTOLOAD PATIENTS
"KRN",19,10281,10,21,0)
10430^RAD^4.8
"KRN",19,10281,10,21,"^")
WV IMPORT RAD/NM EXAMS
"KRN",19,10281,15)

"KRN",19,10281,20)
D MENUT^WVUTL5("FILE MAINTENANCE MENU")
"KRN",19,10281,26)

"KRN",19,10281,99)
57600,33634
"KRN",19,10281,"U")
FILE MAINTENANCE MENU
"KRN",19,10282,-1)
0^26
"KRN",19,10282,0)
WV MENU-PATIENT MANAGEMENT^Patient Management^^M^^^^^^^^WOMEN'S HEALTH^^1^
"KRN",19,10282,1,0)
^^2^2^2980903^
"KRN",19,10282,1,1,0)
The patient management menu is the main working menu and is organized into
"KRN",19,10282,1,2,0)
groups of options for patients, procedures, and notifications.
"KRN",19,10282,10,0)
^19.01PI^21^19
"KRN",19,10282,10,1,0)
10276^BN^10
"KRN",19,10282,10,1,"^")
WV BROWSE NOTIFICATIONS
"KRN",19,10282,10,2,0)
10277^BP^6
"KRN",19,10282,10,2,"^")
WV BROWSE PROCEDURES
"KRN",19,10282,10,3,0)
10275^EN^9
"KRN",19,10282,10,3,"^")
WV EDIT NOTIFICATION
"KRN",19,10282,10,4,0)
10278^PP^2
"KRN",19,10282,10,4,"^")
WV PATIENT PROFILE
"KRN",19,10282,10,5,0)
10273^EP^5
"KRN",19,10282,10,5,"^")
WV EDIT PROCEDURE
"KRN",19,10282,10,6,0)
10274^AN^8
"KRN",19,10282,10,6,"^")
WV ADD A NEW NOTIFICATION
"KRN",19,10282,10,7,0)
10272^AP^4
"KRN",19,10282,10,7,"^")
WV ADD A NEW PROCEDURE
"KRN",19,10282,10,8,0)
10286^PC^1
"KRN",19,10282,10,8,"^")
WV EDIT PATIENT CASE DATA
"KRN",19,10282,10,11,0)
10291^PL^11
"KRN",19,10282,10,11,"^")
WV PRINT INDIVIDUAL LETTERS
"KRN",19,10282,10,12,0)
10302^PR^6.5
"KRN",19,10282,10,12,"^")
WV PRINT A PROCEDURE
"KRN",19,10282,10,14,0)
10283^PQ^12
"KRN",19,10282,10,14,"^")
WV PRINT QUEUED LETTERS
"KRN",19,10282,10,15,0)
10310^BD^2.5
"KRN",19,10282,10,15,"^")
WV BROWSE NEEDS PAST DUE
"KRN",19,10282,10,16,0)
10304^HIS^6.8
"KRN",19,10282,10,16,"^")
WV ADD AN HISTORICAL PROCEDURE
"KRN",19,10282,10,17,0)
10317^FS^2.3
"KRN",19,10282,10,17,"^")
WV PATIENT DEMOGRAPHIC INFO
"KRN",19,10282,10,18,0)
10381^RA^7
"KRN",19,10282,10,18,"^")
WV REFUSED PROC-ADD
"KRN",19,10282,10,19,0)
10418^RE^7.2
"KRN",19,10282,10,19,"^")
WV REFUSED PROC-EDIT
"KRN",19,10282,10,20,0)
10512^^3
"KRN",19,10282,10,20,"^")
WV LINE FOR MENUS
"KRN",19,10282,10,21,0)
10512^^7.5
"KRN",19,10282,10,21,"^")
WV LINE FOR MENUS
"KRN",19,10282,15)

"KRN",19,10282,20)
D MENUT^WVUTL5("PATIENT MANAGEMENT MENU")
"KRN",19,10282,99)
57588,39518
"KRN",19,10282,"U")
PATIENT MANAGEMENT
"KRN",19,10283,-1)
0^37
"KRN",19,10283,0)
WV PRINT QUEUED LETTERS^Print Queued Letters^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10283,1,0)
^^1^1^2980610^
"KRN",19,10283,1,1,0)
This option allows you to print all letters that have been queued to print on the current date.
"KRN",19,10283,25)
WVLETDQ
"KRN",19,10283,"U")
PRINT QUEUED LETTERS
"KRN",19,10284,-1)
0^24
"KRN",19,10284,0)
WV MENU-MANAGER'S FUNCTIONS^Manager's Functions^^M^^^^^^^^WOMEN'S HEALTH^^1^
"KRN",19,10284,1,0)
^^3^3^2980914^^^
"KRN",19,10284,1,1,0)
This menu contains options that provide the program manager with a set of
"KRN",19,10284,1,2,0)
utilities for configuring the software to the specific needs of the site at
"KRN",19,10284,1,3,0)
which the software is being used.
"KRN",19,10284,10,0)
^19.01PI^5^6
"KRN",19,10284,10,1,0)
10283^PQ^2
"KRN",19,10284,10,1,"^")
WV PRINT QUEUED LETTERS
"KRN",19,10284,10,3,0)
10281^FM^1
"KRN",19,10284,10,3,"^")
WV MENU-FILE MAINTENANCE
"KRN",19,10284,10,4,0)
10293^MPM^3
"KRN",19,10284,10,4,"^")
WV MENU-MGR PATIENT MGT
"KRN",19,10284,10,5,0)
10502^LDE^4
"KRN",19,10284,10,5,"^")
WV MENU-LAB DATA ENTRY
"KRN",19,10284,15)

"KRN",19,10284,20)
D MENUT^WVUTL5("MANAGER'S FUNCTIONS")
"KRN",19,10284,99)
57574,39671
"KRN",19,10284,"U")
MANAGER'S FUNCTIONS
"KRN",19,10285,-1)
0^23
"KRN",19,10285,0)
WV MENU-MANAGEMENT REPORTS^Management Reports^^M^^^^^^^^WOMEN'S HEALTH^^1^
"KRN",19,10285,1,0)
^^2^2^2980709^^^
"KRN",19,10285,1,1,0)
This menu contains options that provide program management reports and a
"KRN",19,10285,1,2,0)
limited set of epidemiological reports.
"KRN",19,10285,10,0)
^19.01PI^6^6
"KRN",19,10285,10,1,0)
10308^PS^1
"KRN",19,10285,10,1,"^")
WV PRINT PROCEDURE STATS
"KRN",19,10285,10,2,0)
10310^BP^5
"KRN",19,10285,10,2,"^")
WV BROWSE NEEDS PAST DUE
"KRN",19,10285,10,3,0)
10311^SN^2
"KRN",19,10285,10,3,"^")
WV PRINT SNAPSHOT
"KRN",19,10285,10,4,0)
10312^RS^3
"KRN",19,10285,10,4,"^")
WV PRINT/RETRIEVE SNAPSHOT
"KRN",19,10285,10,5,0)
10337^CR^4
"KRN",19,10285,10,5,"^")
WV PRINT COMPLIANCE RATES
"KRN",19,10285,10,6,0)
10421^ST
"KRN",19,10285,10,6,"^")
WV SEXUAL TRAUMA SUMMARY
"KRN",19,10285,15)

"KRN",19,10285,20)
D MENUT^WVUTL5("MANAGEMENT REPORTS")
"KRN",19,10285,99)
57533,32058
"KRN",19,10285,"U")
MANAGEMENT REPORTS
"KRN",19,10286,-1)
0^17
"KRN",19,10286,0)
WV EDIT PATIENT CASE DATA^Edit/Print Patient Case Data^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10286,1,0)
^^3^3^2980903^
"KRN",19,10286,1,1,0)
This option allows you to add a new patient and her case data to the WH
"KRN",19,10286,1,2,0)
register.  It also allows you to edit case data of patients already in the
"KRN",19,10286,1,3,0)
register.
"KRN",19,10286,25)
WVPATE
"KRN",19,10286,"U")
EDIT/PRINT PATIENT CASE DATA
"KRN",19,10288,-1)
0^4
"KRN",19,10288,0)
WV ADD/EDIT CASE MANAGERS^Add/Edit Case Managers^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10288,1,0)
^^3^3^2980923^
"KRN",19,10288,1,1,0)
This option allows for Case Managers to be selected from the New Person
"KRN",19,10288,1,2,0)
(#200) file. If a case manager is inactivated through this option they
"KRN",19,10288,1,3,0)
will no longer be able to be assigned to WH patients.
"KRN",19,10288,25)
WVCMGR
"KRN",19,10288,"U")
ADD/EDIT CASE MANAGERS
"KRN",19,10289,-1)
0^21
"KRN",19,10289,0)
WV EDIT SITE PARAMETERS^Edit Site Parameters^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10289,1,0)
^^1^1^2980610^
"KRN",19,10289,1,1,0)
This option allows the program manager to edit several parameters specific to the clinic of hospital where the software is being used.
"KRN",19,10289,25)
WVSITE
"KRN",19,10289,"U")
EDIT SITE PARAMETERS
"KRN",19,10290,-1)
0^38
"KRN",19,10290,0)
WV PRINT RES/DIAG FILE^Print Results/Diagnosis File^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10290,1,0)
^^3^3^2980903^
"KRN",19,10290,1,1,0)
For each procedure type in WH only certain Results/Diagnoses may be
"KRN",19,10290,1,2,0)
selected.  This option list all procedure types and their corresponding
"KRN",19,10290,1,3,0)
Results/Diagnoses.
"KRN",19,10290,25)
WVDIAG
"KRN",19,10290,"U")
PRINT RESULTS/DIAGNOSIS FILE
"KRN",19,10291,-1)
0^34
"KRN",19,10291,0)
WV PRINT INDIVIDUAL LETTERS^Print Individual Letters^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10291,1,0)
^^2^2^2980610^
"KRN",19,10291,1,1,0)
This option allows you to print individual notification letters for selected
"KRN",19,10291,1,2,0)
patients.
"KRN",19,10291,25)
WVLETPR
"KRN",19,10291,"U")
PRINT INDIVIDUAL LETTERS
"KRN",19,10292,-1)
0^30
"KRN",19,10292,0)
WV PATIENT PROFILE W/ERRORS^Patient Profile Including Errors^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10292,1,0)
^^4^4^2980610^
"KRN",19,10292,1,1,0)
Displays the Patient Profile exactly as described under the Patient Profile
"KRN",19,10292,1,2,0)
option, however it also includes those procedures given a Results/Diagnosis
"KRN",19,10292,1,3,0)
of Error/Disregard.  This is the only option that displays procedures 
"KRN",19,10292,1,4,0)
entered in error.
"KRN",19,10292,25)
ERRORS^WVPROF
"KRN",19,10292,"U")
PATIENT PROFILE INCLUDING ERRO
"KRN",19,10293,-1)
0^25
"KRN",19,10293,0)
WV MENU-MGR PATIENT MGT^Manager's Patient Management^^M^^^^^^^^WOMEN'S HEALTH^^1
"KRN",19,10293,1,0)
^^2^2^2980914^^^^
"KRN",19,10293,1,1,0)
This menu allows the Program Manager to view and edit certain types of 
"KRN",19,10293,1,2,0)
patient and procedure data in greater detail.
"KRN",19,10293,10,0)
^19.01PI^10^8
"KRN",19,10293,10,1,0)
10292^PPE^1
"KRN",19,10293,10,1,"^")
WV PATIENT PROFILE W/ERRORS
"KRN",19,10293,10,3,0)
10296^PRL^8
"KRN",19,10293,10,3,"^")
WV EDIT PREGNANCY LOG
"KRN",19,10293,10,4,0)
10295^PAL^7
"KRN",19,10293,10,4,"^")
WV EDIT PAP REGIMEN LOG
"KRN",19,10293,10,5,0)
10304^HIS^4
"KRN",19,10293,10,5,"^")
WV ADD AN HISTORICAL PROCEDURE
"KRN",19,10293,10,6,0)
10286^PC^2
"KRN",19,10293,10,6,"^")
WV EDIT PATIENT CASE DATA
"KRN",19,10293,10,10,0)
10333^DUP^5
"KRN",19,10293,10,10,"^")
WV BROWSE PROCEDURES DUPLICATE
"KRN",19,10293,20)
D MENUT^WVUTL5("MANAGER'S PATIENT MANAGEMENT")
"KRN",19,10293,99)
57600,33887
"KRN",19,10293,"U")
MANAGER'S PATIENT MANAGEMENT
"KRN",19,10295,-1)
0^16
"KRN",19,10295,0)
WV EDIT PAP REGIMEN LOG^Edit PAP Regimen Log^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10295,1,0)
^^4^4^2980610^
"KRN",19,10295,1,1,0)
Any changes made to a patient's PAP Regimen on the "Edit Patient Case Data"
"KRN",19,10295,1,2,0)
screen are logged automatically and are displayed on the Patient Profile.
"KRN",19,10295,1,3,0)
If a log entry is in error, it can be edited by the program manager using
"KRN",19,10295,1,4,0)
this option.
"KRN",19,10295,25)
PLOG^WVMGRP
"KRN",19,10295,99)
56522,34340
"KRN",19,10295,"U")
EDIT PAP REGIMEN LOG
"KRN",19,10296,-1)
0^18
"KRN",19,10296,0)
WV EDIT PREGNANCY LOG^Edit Pregnancy Log^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10296,1,0)
^^3^3^2980610^
"KRN",19,10296,1,1,0)
Any changes made to a patient's Pregnancy status on the "Edit Patient Case
"KRN",19,10296,1,2,0)
Data" screen are logged automatically and are displayed on the Patient 
"KRN",19,10296,1,3,0)
Profile.  If a log entry is in error, it can be edited by the program manager using this option.
"KRN",19,10296,25)
EDC^WVMGRP
"KRN",19,10296,"U")
EDIT PREGNANCY LOG
"KRN",19,10302,-1)
0^31
"KRN",19,10302,0)
WV PRINT A PROCEDURE^Print a Procedure^^R^^^^^^^^WOMEN'S HEALTH^^
"KRN",19,10302,1,0)
^^2^2^2980610^
"KRN",19,10302,1,1,0)
This option allows you to print information pertaining to a patient's 
"KRN",19,10302,1,2,0)
procedure.
"KRN",19,10302,20)

"KRN",19,10302,25)
JUSTPRT^WVPRPCD
"KRN",19,10302,99)
56394,58148
"KRN",19,10302,"U")
PRINT A PROCEDURE
"KRN",19,10304,-1)
0^3
"KRN",19,10304,0)
WV ADD AN HISTORICAL PROCEDURE^Add an HISTORICAL Procedure^^R^^^^^^^^WOMEN'S HEALTH^^^^
"KRN",19,10304,1,0)
^^2^2^2980615^
"KRN",19,10304,1,1,0)
This option allows you to add procedures done in years past, in order to 
"KRN",19,10304,1,2,0)
make the Patient Profile more complete.
"KRN",19,10304,3)

"KRN",19,10304,25)
HISTORIC^WVPROC
"KRN",19,10304,"U")
ADD AN HISTORICAL PROCEDURE
"KRN",19,10308,-1)
0^36
"KRN",19,10308,0)
WV PRINT PROCEDURE STATS^Procedure Statistics Report^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10308,1,0)
^^4^4^2980610^
"KRN",19,10308,1,1,0)
This option provides a report for each Procedure Type, the number of 
"KRN",19,10308,1,2,0)
procedures which have had results of Normal, Abnormal, and No Result.
"KRN",19,10308,1,3,0)
It also provides the number of patients who have had Procedures with these
"KRN",19,10308,1,4,0)
results, and their veteran status.
"KRN",19,10308,25)
WVRPPCD
"KRN",19,10308,"U")
PROCEDURE STATISTICS REPORT
"KRN",19,10310,-1)
0^9
"KRN",19,10310,0)
WV BROWSE NEEDS PAST DUE^Browse Patients With Needs Past Due^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10310,1,0)
^^2^2^2980610^
"KRN",19,10310,1,1,0)
This option allows you to search and browse through patients whose treatment
"KRN",19,10310,1,2,0)
needs are past due.
"KRN",19,10310,25)
WVBRNED
"KRN",19,10310,"U")
BROWSE PATIENTS WITH NEEDS PAS
"KRN",19,10311,-1)
0^40
"KRN",19,10311,0)
WV PRINT SNAPSHOT^Snapshot of the Program Today^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10311,1,0)
^^2^2^2980923^
"KRN",19,10311,1,1,0)
This option provides a year-to-date (fiscal or calendar) report that gives
"KRN",19,10311,1,2,0)
program statistics at a glance.
"KRN",19,10311,25)
WVRPSNP
"KRN",19,10311,"U")
SNAPSHOT OF THE PROGRAM TODAY
"KRN",19,10312,-1)
0^41
"KRN",19,10312,0)
WV PRINT/RETRIEVE SNAPSHOT^Retrieve/Print Earlier Snapshots^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10312,1,0)
^^1^1^2980610^
"KRN",19,10312,1,1,0)
This option allows you to display or print previous snapshot reports. 
"KRN",19,10312,25)
WVRPSNPR
"KRN",19,10312,"U")
RETRIEVE/PRINT EARLIER SNAPSHO
"KRN",19,10315,-1)
0^14
"KRN",19,10315,0)
WV EDIT NOTIF TYPE SYNONYM^Edit Synonyms for Notification Types^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10315,1,0)
^^3^3^2980610^
"KRN",19,10315,1,1,0)
Notification types are letters, phone calls, messages, conversations, etc.
"KRN",19,10315,1,2,0)
It is possible to assign synonyms to each type using this option.  This 
"KRN",19,10315,1,3,0)
provides a user defined quick method of selecting the desired type.
"KRN",19,10315,25)
TYPE^WVPURP
"KRN",19,10315,"U")
EDIT SYNONYMS FOR NOTIFICATION
"KRN",19,10316,-1)
0^6
"KRN",19,10316,0)
WV ADD/EDIT NOTIF OUTCOME^Add/Edit Notification Outcomes^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10316,1,0)
^^3^3^2980923^^
"KRN",19,10316,1,1,0)
Each notification, be it a letter, phone call, or other, may be given an 
"KRN",19,10316,1,2,0)
"Outcome".  Some outcomes are preloaded with the software, others may be
"KRN",19,10316,1,3,0)
added through this option.
"KRN",19,10316,25)
OUTCOME^WVPURP
"KRN",19,10316,"U")
ADD/EDIT NOTIFICATION OUTCOMES
"KRN",19,10317,-1)
0^27
"KRN",19,10317,0)
WV PATIENT DEMOGRAPHIC INFO^Print Patient Demographic Info (Face Sheet)^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10317,1,0)
^^3^3^2980610^
"KRN",19,10317,1,1,0)
This option allows you to display or print patient demographic information.
"KRN",19,10317,1,2,0)
It will provide the patient's address, phone numbers, spouse, emergency
"KRN",19,10317,1,3,0)
contacts, and billing information.
"KRN",19,10317,25)
WVFACE
"KRN",19,10317,"U")
PRINT PATIENT DEMOGRAPHIC INFO
"KRN",19,10318,-1)
0^33
"KRN",19,10318,0)
WV PRINT DIAG TRANSLATION^Print Diagnostic Code Translation File^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10318,1,0)
^^2^2^2980923^
"KRN",19,10318,1,1,0)
This option lists all of the Women's Health Mammogram Diagnoses followed
"KRN",19,10318,1,2,0)
by the corresponding Radiology Diagnostic Codes.
"KRN",19,10318,25)
PRINT^WVRAD
"KRN",19,10318,"U")
PRINT DIAGNOSTIC CODE TRANSLAT
"KRN",19,10319,-1)
0^13
"KRN",19,10319,0)
WV EDIT DIAG TRANSLATION^Edit Diagnostic Code Translation File^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10319,1,0)
^^3^3^2980903^
"KRN",19,10319,1,1,0)
When mammograms are imported from the Radiology/NM package, the Diagnoses
"KRN",19,10319,1,2,0)
they are given in the Radiology/NM package must be matched with the 
"KRN",19,10319,1,3,0)
corresponding diagnoses in the WH package.
"KRN",19,10319,25)
WVRAD
"KRN",19,10319,"U")
EDIT DIAGNOSTIC CODE TRANSLATI
"KRN",19,10324,-1)
0^8
"KRN",19,10324,0)
WV AUTOLOAD PATIENTS^Automatically Load Patients^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10324,1,0)
^^5^5^2980923^^
"KRN",19,10324,1,1,0)
This option allows you to automatically load patients from the main Patient
"KRN",19,10324,1,2,0)
database into the Women's Health database.
"KRN",19,10324,1,3,0)
 
"KRN",19,10324,1,4,0)
You will be able to select the age cutoff, and define the time period to be
"KRN",19,10324,1,5,0)
considered in determining active patients (only active patients are added).
"KRN",19,10324,25)
WVGETALL
"KRN",19,10324,"U")
AUTOMATICALLY LOAD PATIENTS
"KRN",19,10326,-1)
0^20
"KRN",19,10326,0)
WV EDIT RES/DIAG SYNONYMS^Edit Synonyms for Results/Diagnoses^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10326,1,0)
^^1^1^2980610^
"KRN",19,10326,1,1,0)
This option allows you to enter/edit a synonym for any Result/Diagnoses.
"KRN",19,10326,25)
EDITSYN^WVDIAGS
"KRN",19,10326,"U")
EDIT SYNONYMS FOR RESULTS/DIAG
"KRN",19,10327,-1)
0^39
"KRN",19,10327,0)
WV PRINT RES/DIAG SYNONYMS^Print Synonyms for Results/Diagnoses^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10327,1,0)
^^1^1^2980610^
"KRN",19,10327,1,1,0)
This option lists in tabular form all of the synonyms and their corresponding Results/Diagnoses.
"KRN",19,10327,25)
PRINTSYN^WVDIAGS
"KRN",19,10327,"U")
PRINT SYNONYMS FOR RESULTS/DIA
"KRN",19,10333,-1)
0^12
"KRN",19,10333,0)
WV BROWSE PROCEDURES DUPLICATE^Browse Procedures for Possible Duplicates^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10333,1,0)
^^2^2^2980610^
"KRN",19,10333,1,1,0)
This utility checks for possible duplicate procedures, in other words, two
"KRN",19,10333,1,2,0)
or more instances of the same procedure for a given patient on the same date.
"KRN",19,10333,25)
WVBRDUP
"KRN",19,10333,"U")
BROWSE PROCEDURES FOR POSSIBLE
"KRN",19,10337,-1)
0^32
"KRN",19,10337,0)
WV PRINT COMPLIANCE RATES^Compliance Rates for PAPs and MAMs^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10337,1,0)
^^3^3^2980630^^
"KRN",19,10337,1,1,0)
This report is designed to serve as an indicator of screening rates for 
"KRN",19,10337,1,2,0)
PAPs and MAMs, in other words, it indicates the percentage of women who
"KRN",19,10337,1,3,0)
are returning to the program on a regular basis for screenings.
"KRN",19,10337,25)
WVRPSCR
"KRN",19,10337,"U")
COMPLIANCE RATES FOR PAPS AND 
"KRN",19,10338,-1)
0^44
"KRN",19,10338,0)
WV TRANSFER CASE MANAGER^Transfer a Case Manager's Patients^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10338,1,0)
^^3^3^2980610^
"KRN",19,10338,1,1,0)
The purpose of this option is to aid in the transfer of all of one Case 
"KRN",19,10338,1,2,0)
Manager's patients to another Case Manager when there is a turnover
"KRN",19,10338,1,3,0)
in staff.
"KRN",19,10338,25)
TRANS^WVCMGR
"KRN",19,10338,"U")
TRANSFER A CASE MANAGER'S PATI
"KRN",19,10339,-1)
0^7
"KRN",19,10339,0)
WV ADD/EDIT REFERRAL SOURCE^Add/Edit to Referral Source File^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10339,1,0)
^^2^2^2980520^
"KRN",19,10339,1,1,0)
This option allows the user to add Sources of Referral to the WV Referral
"KRN",19,10339,1,2,0)
Source file(#790.07).
"KRN",19,10339,25)
REF^WVSITE
"KRN",19,10339,"U")
ADD/EDIT TO REFERRAL SOURCE FI
"KRN",19,10381,-1)
0^42
"KRN",19,10381,0)
WV REFUSED PROC-ADD^Add a Refusal of Treatment^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10381,1,0)
^^2^2^2980813^
"KRN",19,10381,1,1,0)
If the patient declines to be treated at this treatment site for any
"KRN",19,10381,1,2,0)
reason enter the specifics of this refusal in this option.
"KRN",19,10381,25)
UNIV^WVREFUSE
"KRN",19,10381,"U")
ADD A REFUSAL OF TREATMENT
"KRN",19,10418,-1)
0^43
"KRN",19,10418,0)
WV REFUSED PROC-EDIT^Edit a Refusal of Treatment^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10418,1,0)
^^1^1^2980813^^
"KRN",19,10418,1,1,0)
This option allows editing of an existing Patient's Refusal for Treatment.
"KRN",19,10418,25)
EDREF^WVREFUSE
"KRN",19,10418,"U")
EDIT A REFUSAL OF TREATMENT
"KRN",19,10421,-1)
0^46
"KRN",19,10421,0)
WV SEXUAL TRAUMA SUMMARY^Sexual Trauma Summary Report^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10421,1,0)
^^5^5^2980903^
"KRN",19,10421,1,1,0)
This option provides the user with a short report of the number and 
"KRN",19,10421,1,2,0)
percentages of WH patients who have experienced Sexual Traumas.
"KRN",19,10421,1,3,0)
 
"KRN",19,10421,1,4,0)
Patients who are deceased or have a date entered into the DATE INACTIVE
"KRN",19,10421,1,5,0)
(#.24) field of the WV PATIENT (#790) file are not counted in this report.
"KRN",19,10421,25)
WVRPST
"KRN",19,10421,"U")
SEXUAL TRAUMA SUMMARY REPORT
"KRN",19,10430,-1)
0^47
"KRN",19,10430,0)
WV IMPORT RAD/NM EXAMS^Import Radiology/NM Exams^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10430,1,0)
^^7^7^2980903^
"KRN",19,10430,1,1,0)
This option searches the Radiology/Nuclear Medicine database for all WH
"KRN",19,10430,1,2,0)
patients who had a mammogram or breast ultrasound exam (CPT codes are
"KRN",19,10430,1,3,0)
76090, 76091, 76092 and 76645) during the date range you select. These
"KRN",19,10430,1,4,0)
procedures and patients will be added to the WH database if not already
"KRN",19,10430,1,5,0)
there.
"KRN",19,10430,1,6,0)
 
"KRN",19,10430,1,7,0)
Exams over three years old will not be imported into the WH database.
"KRN",19,10430,25)
WVEXPTRA
"KRN",19,10430,"U")
IMPORT RADIOLOGY/NM EXAMS
"KRN",19,10498,-1)
0^49
"KRN",19,10498,0)
WV LAB ADD A NEW PROCEDURE^Add(Accession) a NEW Procedure^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10498,1,0)
^^2^2^2980923^
"KRN",19,10498,1,1,0)
This option is used by Laboratory personnel to add procedures to the
"KRN",19,10498,1,2,0)
Women's Health database.
"KRN",19,10498,25)
WVLAB
"KRN",19,10498,"U")
ADD(ACCESSION) A NEW PROCEDURE
"KRN",19,10499,-1)
0^50
"KRN",19,10499,0)
WV LAB EDIT ACCESSION^Edit Accessioned Procedure^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10499,1,0)
^^2^2^2980828^
"KRN",19,10499,1,1,0)
This option is used by Laboratory personnel to edit procedures in the
"KRN",19,10499,1,2,0)
Women's Health database.
"KRN",19,10499,25)
EDIT^WVLAB
"KRN",19,10499,"U")
EDIT ACCESSIONED PROCEDURE
"KRN",19,10501,-1)
0^52
"KRN",19,10501,0)
WV LAB PRINT LOG^Display/Print Daily Log^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10501,1,0)
^^8^8^2980820^
"KRN",19,10501,1,1,0)
This option displays a list or a total count of procedures recorded in the
"KRN",19,10501,1,2,0)
WV Procedure file (#790.1). 
"KRN",19,10501,1,3,0)
 
"KRN",19,10501,1,4,0)
The report output is based on criteria selected by the user including date
"KRN",19,10501,1,5,0)
range, type of procedure, facility, and procedures with no
"KRN",19,10501,1,6,0)
result/diagnosis or procedures with and without a result/diagnosis. The
"KRN",19,10501,1,7,0)
user may sort the list of procedures by accession number or patient name,
"KRN",19,10501,1,8,0)
or display a totals count only.
"KRN",19,10501,25)
WVLABLG
"KRN",19,10501,"U")
DISPLAY/PRINT DAILY LOG
"KRN",19,10502,-1)
0^48
"KRN",19,10502,0)
WV MENU-LAB DATA ENTRY^Lab Data Entry Menu^^M^^^^^^^^WOMEN'S HEALTH^^1
"KRN",19,10502,1,0)
^^2^2^2980901^^
"KRN",19,10502,1,1,0)
This menu is used by Laboratory personnel to add, edit and view procedures
"KRN",19,10502,1,2,0)
in the Women's Health database.
"KRN",19,10502,10,0)
^19.01IP^6^5
"KRN",19,10502,10,1,0)
10498^AP^1
"KRN",19,10502,10,1,"^")
WV LAB ADD A NEW PROCEDURE
"KRN",19,10502,10,2,0)
10302^PR^4
"KRN",19,10502,10,2,"^")
WV PRINT A PROCEDURE
"KRN",19,10502,10,3,0)
10501^LOG^5
"KRN",19,10502,10,3,"^")
WV LAB PRINT LOG
"KRN",19,10502,10,5,0)
10499^EA^2
"KRN",19,10502,10,5,"^")
WV LAB EDIT ACCESSION
"KRN",19,10502,10,6,0)
10511^EP^3
"KRN",19,10502,10,6,"^")
WV LAB EDIT PROCEDURE RESULT
"KRN",19,10502,20)
D MENUT^WVUTL5("LAB DATA ENTRY")
"KRN",19,10502,99)
57587,59323
"KRN",19,10502,"U")
LAB DATA ENTRY MENU
"KRN",19,10511,-1)
0^54
"KRN",19,10511,0)
WV LAB EDIT PROCEDURE RESULT^Edit a Procedure Result^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10511,1,0)
^^2^2^2980901^
"KRN",19,10511,1,1,0)
This option is used by Laboratory personnel to edit a result entered for a
"KRN",19,10511,1,2,0)
procedure in the Women's Health database.
"KRN",19,10511,25)
LABEDIT^WVPROC
"KRN",19,10511,"U")
EDIT A PROCEDURE RESULT
"KRN",19,10512,-1)
0^53
"KRN",19,10512,0)
WV LINE FOR MENUS^--------------------------^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10512,1,0)
^^2^2^2980902^^
"KRN",19,10512,1,1,0)
This option merely displays a line of dashes and is used for visual
"KRN",19,10512,1,2,0)
reasons to separate groups of options on a menu.
"KRN",19,10512,25)
LINE^WVUTL1A
"KRN",19,10512,"U")
--------------------------
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",364,-1)
1^1
"PKG",364,0)
WOMEN'S HEALTH^WV^Tracks health issues specific to female patients.
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
1.0^2980925^2980508^547
"PKG",364,22,1,1,0)
^^2^2^2980929
"PKG",364,22,1,1,1,0)
This KIDS Build contains all the components needed to install the Women's
"PKG",364,22,1,1,2,0)
Health v1.0 software package.
"PKG",364,22,1,"PAH",0)
^9.4901^4^4
"PKG",364,22,1,"PAH",1,0)
99^2980526
"PKG",364,22,1,"PAH",2,0)
101^2980526
"PKG",364,22,1,"PAH",3,0)
100^2980526
"PKG",364,22,1,"PAH",4,0)
102^2980624
"PKG",364,22,1,"PAH",4,1,0)
^^1^1^2980624
"PKG",364,22,1,"PAH",4,1,1,0)
COPY OF FILE 790.93 (WV CDC CBE CATEGORIES BEFORE IT WAS DELETED.
"PKG",364,22,1,"PAH","B",99,1)

"PKG",364,22,1,"PAH","B",100,3)

"PKG",364,22,1,"PAH","B",101,2)

"PKG",364,22,1,"PAH","B",102,4)

"PKG",364,"VERSION")
1.0
"PRE")
WVENV
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
67
"RTN","WVBRDUP")
0^1^B5978368
"RTN","WVBRDUP",1,0)
WVBRDUP ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE DUPLICATE PROCEDURES;
"RTN","WVBRDUP",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRDUP",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRDUP",4,0)
 ;;  CALLED BY OPTION: "WV BROWSE PROCEDURES DUPLICATE" TO IDENTIFY,
"RTN","WVBRDUP",5,0)
 ;;  LIST AND BROWSE POSSIBLE DUPLICATE PROCEDURES.
"RTN","WVBRDUP",6,0)
 ;
"RTN","WVBRDUP",7,0)
 ;---> USE ^WVBRPCD ROUTINES FOR DISPLAY (NODES 1 & 2 IN ^TMP GLOBAL).
"RTN","WVBRDUP",8,0)
 ;
"RTN","WVBRDUP",9,0)
 D SETVARS
"RTN","WVBRDUP",10,0)
 D TITLE^WVUTL5("BROWSE PROCEDURES FOR POSSIBLE DUPLICATES")
"RTN","WVBRDUP",11,0)
 D DEVICE G:WVPOP EXIT
"RTN","WVBRDUP",12,0)
 D SORT
"RTN","WVBRDUP",13,0)
 D COPYGBL^WVBRPCD
"RTN","WVBRDUP",14,0)
 D DISPLAY^WVBRPCD1(WVTITLE,WVHEADER,WVCODE)
"RTN","WVBRDUP",15,0)
 ;
"RTN","WVBRDUP",16,0)
EXIT ;EP
"RTN","WVBRDUP",17,0)
 D KILLALL^WVUTL8
"RTN","WVBRDUP",18,0)
 Q
"RTN","WVBRDUP",19,0)
 ;
"RTN","WVBRDUP",20,0)
SETVARS ;EP
"RTN","WVBRDUP",21,0)
 ;---> SET REQUIRED VARIABLES.
"RTN","WVBRDUP",22,0)
 D SETVARS^WVUTL5 S WVPOP=0
"RTN","WVBRDUP",23,0)
 S WVTITLE="* * *  DUPLICATE PROCEDURES LISTED BY PATIENT  * * *"
"RTN","WVBRDUP",24,0)
 ;---> SET CODE EXCECUTED BY DIR PROMPT.
"RTN","WVBRDUP",25,0)
 S WVCODE="D EDIT^WVBRPCD1,SORT^WVBRDUP,COPYGBL^WVBRPCD"
"RTN","WVBRDUP",26,0)
 ;---> SET LINE LABEL IN ^WVUTL7 TO CALL AS HEADER.
"RTN","WVBRDUP",27,0)
 S WVHEADER="HEADER6"
"RTN","WVBRDUP",28,0)
 Q
"RTN","WVBRDUP",29,0)
 ;
"RTN","WVBRDUP",30,0)
SORT ;EP
"RTN","WVBRDUP",31,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVBRDUP",32,0)
 K ^TMP("WV",$J) N WVDFN,WVIEN,WVPCD,WVPCDS,N,M,P,Y
"RTN","WVBRDUP",33,0)
 S WVDFN=0
"RTN","WVBRDUP",34,0)
 F  S WVDFN=$O(^WV(790.1,"C",WVDFN)) Q:'WVDFN  D
"RTN","WVBRDUP",35,0)
 .;
"RTN","WVBRDUP",36,0)
 .;---> GATHER ALL PROCEDURES FOR THIS PATIENT INTO WVPCDS ARRAY.
"RTN","WVBRDUP",37,0)
 .S WVIEN=0 K WVPCDS
"RTN","WVBRDUP",38,0)
 .F  S WVIEN=$O(^WV(790.1,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVBRDUP",39,0)
 ..;---> SET Y=THE ZERO NODE FOR THIS PROCEDURE.
"RTN","WVBRDUP",40,0)
 ..S Y=^WV(790.1,WVIEN,0)
"RTN","WVBRDUP",41,0)
 ..;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVBRDUP",42,0)
 ..Q:$P(Y,U,5)=8
"RTN","WVBRDUP",43,0)
 ..;---> GET DATE.
"RTN","WVBRDUP",44,0)
 ..S WVPCD=$P(Y,U,4),WVDATE=$P($P(Y,U,12),".")
"RTN","WVBRDUP",45,0)
 ..S WVPCDS(WVDFN,WVDATE,WVPCD,WVIEN)=""
"RTN","WVBRDUP",46,0)
 .;
"RTN","WVBRDUP",47,0)
 .;---> NOW CHECK WVPCDS ARRAY FOR DUPLICATES.
"RTN","WVBRDUP",48,0)
 .S N=0
"RTN","WVBRDUP",49,0)
 .F  S N=$O(WVPCDS(WVDFN,N)) Q:'N  D
"RTN","WVBRDUP",50,0)
 ..S M=0
"RTN","WVBRDUP",51,0)
 ..F  S M=$O(WVPCDS(WVDFN,N,M)) Q:'M  D
"RTN","WVBRDUP",52,0)
 ...S P=0
"RTN","WVBRDUP",53,0)
 ...F I=0:1 S P=$O(WVPCDS(WVDFN,N,M,P)) Q:'P
"RTN","WVBRDUP",54,0)
 ...Q:I'>1
"RTN","WVBRDUP",55,0)
 ...S P=0
"RTN","WVBRDUP",56,0)
 ...F  S P=$O(WVPCDS(WVDFN,N,M,P)) Q:'P  D
"RTN","WVBRDUP",57,0)
 ....S Y=^WV(790.1,P,0) D STORE^WVBRPCD(2,P,Y)
"RTN","WVBRDUP",58,0)
 Q
"RTN","WVBRDUP",59,0)
 ;
"RTN","WVBRDUP",60,0)
DEQUEUE ;EP
"RTN","WVBRDUP",61,0)
 ;---> FOR TASKMAN QUEUE OF PRINTOUT.
"RTN","WVBRDUP",62,0)
 D SETVARS,SORT,COPYGBL^WVBRPCD
"RTN","WVBRDUP",63,0)
 D DISPLAY^WVBRPCD1(WVTITLE,WVHEADER,WVCODE)
"RTN","WVBRDUP",64,0)
 D EXIT
"RTN","WVBRDUP",65,0)
 Q
"RTN","WVBRDUP",66,0)
 ;
"RTN","WVBRDUP",67,0)
DEVICE ;EP
"RTN","WVBRDUP",68,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVBRDUP",69,0)
 S ZTRTN="DEQUEUE^WVBRDUP"
"RTN","WVBRDUP",70,0)
 F WVSV="HEADER" D
"RTN","WVBRDUP",71,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVBRDUP",72,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVBRDUP",73,0)
 Q
"RTN","WVBRNED")
0^2^B23443187
"RTN","WVBRNED",1,0)
WVBRNED ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE TX NEEDS PAST DUE; ;7/27/98  13:46
"RTN","WVBRNED",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRNED",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRNED",4,0)
 ;;  CALLED BY OPTION: "WV BROWSE NEEDS PAST DUE" TO BROWSE AND
"RTN","WVBRNED",5,0)
 ;;  EDIT PATIENTS WITH TREATMENT NEEDS PAST DUE.
"RTN","WVBRNED",6,0)
 ;
"RTN","WVBRNED",7,0)
 ;---> USE NODES 1 & 2 IN ^TMP GLOBAL.
"RTN","WVBRNED",8,0)
 ;
"RTN","WVBRNED",9,0)
BEGIN ;EP
"RTN","WVBRNED",10,0)
 D SETVARS^WVUTL5 K WVRES
"RTN","WVBRNED",11,0)
 D TITLE^WVUTL5("BREAST & CERVICAL TX NEEDS PAST DUE REPORT")
"RTN","WVBRNED",12,0)
 D UNDETER G:WVPOP EXIT
"RTN","WVBRNED",13,0)
 D ASKDATE G:WVPOP EXIT
"RTN","WVBRNED",14,0)
 D CMGR    G:WVPOP EXIT
"RTN","WVBRNED",15,0)
 D ORDER   G:WVPOP EXIT
"RTN","WVBRNED",16,0)
 D DEVICE  G:WVPOP EXIT
"RTN","WVBRNED",17,0)
 D SORT
"RTN","WVBRNED",18,0)
 D COPYGBL
"RTN","WVBRNED",19,0)
 D ^WVBRNED1
"RTN","WVBRNED",20,0)
 ;
"RTN","WVBRNED",21,0)
EXIT ;EP
"RTN","WVBRNED",22,0)
 D KILLALL^WVUTL8
"RTN","WVBRNED",23,0)
 Q
"RTN","WVBRNED",24,0)
 ;
"RTN","WVBRNED",25,0)
 ;
"RTN","WVBRNED",26,0)
UNDETER ;EP
"RTN","WVBRNED",27,0)
 ;---> ASK TO INCLUDE CASES WITH UNDETERMINED OR UNDATED NEEDS.
"RTN","WVBRNED",28,0)
 ;---> WVA=1 SAYS INCLUDE PATIENTS WITH UNDETERMINED NEEDS.
"RTN","WVBRNED",29,0)
 N DIR,DIRUT,Y
"RTN","WVBRNED",30,0)
 W !!?3,"Include patients whose Breast or Cervical Tx Needs are "
"RTN","WVBRNED",31,0)
 W "undetermined?"
"RTN","WVBRNED",32,0)
 N DIR S DIR("A")="   Enter Yes or No: "
"RTN","WVBRNED",33,0)
 S WVA=0,DIR(0)="YA",DIR("B")="YES" D HELP1^WVBRNEDH
"RTN","WVBRNED",34,0)
 D ^DIR W !
"RTN","WVBRNED",35,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVBRNED",36,0)
 I Y S WVA=1 Q
"RTN","WVBRNED",37,0)
 Q
"RTN","WVBRNED",38,0)
 ;
"RTN","WVBRNED",39,0)
 ;
"RTN","WVBRNED",40,0)
ASKDATE ;EP
"RTN","WVBRNED",41,0)
 ;---> ASK FOR DATE BY WHICH NEEDS WILL BE DELINQUENT.
"RTN","WVBRNED",42,0)
 N DIR,DIRUT,Y
"RTN","WVBRNED",43,0)
 W !!?3,"Select the date to be checked for patient Tx Needs past due:"
"RTN","WVBRNED",44,0)
 S DIR(0)="D^::EX",DIR("A")="   Select a date"
"RTN","WVBRNED",45,0)
 S DIR("B")="TODAY" D HELP4^WVBRNEDH
"RTN","WVBRNED",46,0)
 D ^DIR
"RTN","WVBRNED",47,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVBRNED",48,0)
 S WVDDATE=Y
"RTN","WVBRNED",49,0)
 Q
"RTN","WVBRNED",50,0)
 ;
"RTN","WVBRNED",51,0)
 ;
"RTN","WVBRNED",52,0)
CMGR ;EP
"RTN","WVBRNED",53,0)
 ;---> SELECT CASES FOR ONE CASE MANAGER OR ALL.
"RTN","WVBRNED",54,0)
 ;---> DO NOT PROMPT FOR CASE MANAGER IF SITE PARAMETERS SAY NOT TO.
"RTN","WVBRNED",55,0)
 I '$D(^WV(790.02,DUZ(2),0)) S WVE=1 Q
"RTN","WVBRNED",56,0)
 I '$P(^WV(790.02,DUZ(2),0),U,5) S WVE=1 Q
"RTN","WVBRNED",57,0)
 W !!?3,"Report on all patients for ONE particular Case Manager,"
"RTN","WVBRNED",58,0)
 W !?3,"or report on all patients for ALL Case Managers?"
"RTN","WVBRNED",59,0)
 N DIR,DIRUT,Y
"RTN","WVBRNED",60,0)
 S DIR("A")="   Select ONE or ALL: ",DIR("B")="ALL",WVMGR=""
"RTN","WVBRNED",61,0)
 S DIR(0)="SAM^o:ONE;a:ALL" D HELP3^WVBRNEDH
"RTN","WVBRNED",62,0)
 D ^DIR K DIR
"RTN","WVBRNED",63,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNED",64,0)
 ;---> IF ALL CASE MANAGERS, S WVE=1 AND QUIT.
"RTN","WVBRNED",65,0)
 I Y="a" S WVE=1 Q
"RTN","WVBRNED",66,0)
 ;
"RTN","WVBRNED",67,0)
 W !!,"   Select the Case Manager whose patients you wish to browse."
"RTN","WVBRNED",68,0)
 D DIC^WVFMAN(790.01,"QEMA",.Y,"   Select CASE MANAGER: ")
"RTN","WVBRNED",69,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVBRNED",70,0)
 ;---> FOR ONE CASE MANAGER, SET WVE=0 AND WVMGR=^VA(200 DFN, QUIT.
"RTN","WVBRNED",71,0)
 S WVMGR=+Y,WVE=0
"RTN","WVBRNED",72,0)
 Q
"RTN","WVBRNED",73,0)
 ;
"RTN","WVBRNED",74,0)
 ;
"RTN","WVBRNED",75,0)
ORDER ;EP
"RTN","WVBRNED",76,0)
 ;---> ASK ORDER BY DATE DELINQUENT OR BY PATIENT NAME.
"RTN","WVBRNED",77,0)
 ;---> SORT SEQUENCE IN WVB:  1=DELINQ DATE (DEFAULT), 2=PATIENT NAME
"RTN","WVBRNED",78,0)
 ;---> 3=PRIMARY CARE PROVIDER
"RTN","WVBRNED",79,0)
 N DIR,DIRUT,Y S WVB=1
"RTN","WVBRNED",80,0)
 W !!?3,"Display Procedures in order of:"
"RTN","WVBRNED",81,0)
 W ?37,"1) DATE DELINQUENT (earliest first)"
"RTN","WVBRNED",82,0)
 W !?37,"2) PATIENT NAME (alphabetically)"
"RTN","WVBRNED",83,0)
 W !?37,"3) PRIMARY CARE PROVIDER (alphabetically)"
"RTN","WVBRNED",84,0)
 S DIR("A")="   Selection ",DIR("B")=1
"RTN","WVBRNED",85,0)
 S DIR(0)="SAM^1:DATE DELINQUENT;2:PATIENT NAME;3:PRIMARY CARE PROVIDER"
"RTN","WVBRNED",86,0)
 D HELP2^WVBRNEDH
"RTN","WVBRNED",87,0)
 D ^DIR K DIR
"RTN","WVBRNED",88,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNED",89,0)
 S WVB=Y
"RTN","WVBRNED",90,0)
 Q
"RTN","WVBRNED",91,0)
 ;
"RTN","WVBRNED",92,0)
DEVICE ;EP
"RTN","WVBRNED",93,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVBRNED",94,0)
 S ZTRTN="DEQUEUE^WVBRNED"
"RTN","WVBRNED",95,0)
 F WVSV="A","B","E","DDATE","MGR" D
"RTN","WVBRNED",96,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVBRNED",97,0)
 ;---> SAVE CURRENT COMMUNITY ARRAY.
"RTN","WVBRNED",98,0)
 I $D(WVCC) N N S N=0 F  S N=$O(WVCC(N)) Q:N=""  D
"RTN","WVBRNED",99,0)
 .S ZTSAVE("WVCC("""_N_""")")=""
"RTN","WVBRNED",100,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVBRNED",101,0)
 Q
"RTN","WVBRNED",102,0)
 ;
"RTN","WVBRNED",103,0)
SORT ;EP
"RTN","WVBRNED",104,0)
 ;---> SORT AND STORE LOCAL ARRAY IN ^TMP("WV",$J,1,
"RTN","WVBRNED",105,0)
 ;---> WVA=1 SAYS INCLUDE PATIENTS WITH UNDETERMINED NEEDS.
"RTN","WVBRNED",106,0)
 ;---> 5 & 8 ARE IENS IN ^WV(790.5, AND ^WV(790.51 GLOBALS FOR "UNDETERMINED".
"RTN","WVBRNED",107,0)
 ;
"RTN","WVBRNED",108,0)
 K ^TMP("WV",$J) N N,Y
"RTN","WVBRNED",109,0)
 S N=0
"RTN","WVBRNED",110,0)
 F  S N=$O(^WV(790,N)) Q:'N  D
"RTN","WVBRNED",111,0)
 .S Y=^WV(790,N,0)
"RTN","WVBRNED",112,0)
 .;---> QUIT IF PATIENT IS INACTIVE.
"RTN","WVBRNED",113,0)
 .Q:$P(Y,U,24)
"RTN","WVBRNED",114,0)
 .;---> QUIT IF LOOKING FOR ONE CASE MANAGER AND THIS DOESN'T MATCH.
"RTN","WVBRNED",115,0)
 .I 'WVE Q:$P(Y,U,10)'=WVMGR
"RTN","WVBRNED",116,0)
 .;---> IF WVA=0, DON'T INCLUDE BECAUSE OF UNDETERMINED NEEDS.
"RTN","WVBRNED",117,0)
 .I 'WVA D  Q
"RTN","WVBRNED",118,0)
 ..;---> ONLY IF IT'S A SPECIFIED NEED AND IT'S DELINQUENT, INCLUDE.
"RTN","WVBRNED",119,0)
 ..I 5'[$P(Y,U,11)&($P(Y,U,12)<WVDDATE) D SET Q
"RTN","WVBRNED",120,0)
 ..I 8'[$P(Y,U,18)&($P(Y,U,19)<WVDDATE) D SET Q
"RTN","WVBRNED",121,0)
 .;---> IF WVA=1, INCLUDE BECAUSE OF UNDETERMINED NEEDS.
"RTN","WVBRNED",122,0)
 .I 5[$P(Y,U,11)!(8[$P(Y,U,18)) D SET Q
"RTN","WVBRNED",123,0)
 .;---> IF EITHER NEED IS DELINQUENT, INCLUDE.
"RTN","WVBRNED",124,0)
 .I $P(Y,U,12)<WVDDATE!($P(Y,U,19)<WVDDATE) D SET
"RTN","WVBRNED",125,0)
 Q
"RTN","WVBRNED",126,0)
 ;
"RTN","WVBRNED",127,0)
 ;
"RTN","WVBRNED",128,0)
COPYGBL ;EP
"RTN","WVBRNED",129,0)
 ;---> COPY ^TMP("WV",$J,1 TO ^TMP("WV",$J,2 TO MAKE IT FLAT.
"RTN","WVBRNED",130,0)
 N I,M,N
"RTN","WVBRNED",131,0)
 S N=-1,I=0
"RTN","WVBRNED",132,0)
 F  S N=$O(^TMP("WV",$J,1,N)) Q:N=""  D
"RTN","WVBRNED",133,0)
 .S M=-1
"RTN","WVBRNED",134,0)
 .F  S M=$O(^TMP("WV",$J,1,N,M)) Q:M=""  D
"RTN","WVBRNED",135,0)
 ..S I=I+1,^TMP("WV",$J,2,I)=^TMP("WV",$J,1,N,M)
"RTN","WVBRNED",136,0)
 Q
"RTN","WVBRNED",137,0)
 ;
"RTN","WVBRNED",138,0)
SET ;EP
"RTN","WVBRNED",139,0)
 ;---> SORT SEQUENCE IN WVB: 1=DELINQ DATE (DEFAULT), 2=PATIENT NAME
"RTN","WVBRNED",140,0)
 ;---> 3=PRIMARY CARE PROVIDER
"RTN","WVBRNED",141,0)
 N Z S WVDFN=$P(Y,U) D PATVARS^WVUTL3(WVDFN)
"RTN","WVBRNED",142,0)
 S Z=WVCHRT_U_WVNAME_U_WVCMGR_U_WVCNEED_U_WVBNEED_U_WVDFN
"RTN","WVBRNED",143,0)
 S WVJPCP=$$PROVI^WVUTL1A(WVDFN)
"RTN","WVBRNED",144,0)
 I WVB=1 D  Q
"RTN","WVBRNED",145,0)
 .S WVPDAT=+$P(Y,U,12),WVMDAT=+$P(Y,U,19)
"RTN","WVBRNED",146,0)
 .S ^TMP("WV",$J,1,$S(WVPDAT<WVMDAT:WVPDAT,1:WVMDAT),WVNAME)=Z
"RTN","WVBRNED",147,0)
 I WVB=2 S ^TMP("WV",$J,1,WVNAME,WVDFN)=Z
"RTN","WVBRNED",148,0)
 I WVB=3 S ^TMP("WV",$J,1,WVJPCP,WVNAME)=Z
"RTN","WVBRNED",149,0)
 Q
"RTN","WVBRNED",150,0)
 ;
"RTN","WVBRNED",151,0)
 ;
"RTN","WVBRNED",152,0)
DEQUEUE ;EP
"RTN","WVBRNED",153,0)
 ;---> TASKMAN QUEUE OF PRINTOUT.
"RTN","WVBRNED",154,0)
 D SETVARS^WVUTL5,SORT,COPYGBL,^WVBRNED1,EXIT
"RTN","WVBRNED",155,0)
 Q
"RTN","WVBRNED",156,0)
 ;
"RTN","WVBRNED",157,0)
PRINTX ;EP
"RTN","WVBRNED",158,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVBRNED",159,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVBRNED",160,0)
 Q
"RTN","WVBRNED1")
0^3^B8550078
"RTN","WVBRNED1",1,0)
WVBRNED1 ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE TX NEEDS PAST DUE; ;7/29/98  13:54
"RTN","WVBRNED1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRNED1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRNED1",4,0)
 ;;  DISPLAY CODE FOR BROWSING TX NEEDS.  CALLED BY WVBRNED.
"RTN","WVBRNED1",5,0)
 ;
"RTN","WVBRNED1",6,0)
DISPLAY ;EP
"RTN","WVBRNED1",7,0)
 ;---> WVCONF=DISPLAY "CONFIDENTIAL PT INFO" BANNER.
"RTN","WVBRNED1",8,0)
 ;---> WVTITLE=TITLE AT TOP OF DISPLAY HEADER.
"RTN","WVBRNED1",9,0)
 ;---> WVSUBH=CODE TO EXECUTE FOR SUBHEADER (COLUMN TITLES).
"RTN","WVBRNED1",10,0)
 ;---> WVCODE=CODE TO EXECUTE AS 3RD PIECE OF DIR(0) (AFTER DIR READ).
"RTN","WVBRNED1",11,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (ALLOWS SELECTIONS TO EDIT).
"RTN","WVBRNED1",12,0)
 ;---> WVTAB=6 IF OUTPUT IS TO SCREEN, =3 IF OUTPUT IS TO PRINTER.
"RTN","WVBRNED1",13,0)
 ;---> WVPRMT(1,Q)=PROMPTS FOR DIR.
"RTN","WVBRNED1",14,0)
 ;
"RTN","WVBRNED1",15,0)
 U IO
"RTN","WVBRNED1",16,0)
 S WVCONF=1
"RTN","WVBRNED1",17,0)
 S WVTITLE1=$S(WVB=1:"BY NEED DATE",WVB=2:"ALPHABETICALLY",WVB=3:"BY PRIMARY CARE PROVIDER",1:"?")
"RTN","WVBRNED1",18,0)
 S WVTITLE="*  PATIENTS LISTED "_WVTITLE1_"  *"
"RTN","WVBRNED1",19,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVBRNED1",20,0)
 S WVSUBH="SUBHEAD^WVBRNED1"
"RTN","WVBRNED1",21,0)
 S WVCODE="D EDIT^WVBRNED1 N N D SORT^WVBRNED,COPYGBL^WVBRNED"
"RTN","WVBRNED1",22,0)
 N N S (WVPOP,N,Z)=0
"RTN","WVBRNED1",23,0)
 D TOPHEAD^WVUTL7
"RTN","WVBRNED1",24,0)
 ;---> *SET WVFAC FOR NOW; MAKE WVFAC SELECTABLE IN FUTURE VERSIONS.
"RTN","WVBRNED1",25,0)
 S WVFAC=DUZ(2)
"RTN","WVBRNED1",26,0)
 S WVTAB=$S(WVCRT:6,1:3)
"RTN","WVBRNED1",27,0)
 ;
"RTN","WVBRNED1",28,0)
NOMATCH ;EP
"RTN","WVBRNED1",29,0)
 ;---> QUIT IF NO RECORDS MATCH.
"RTN","WVBRNED1",30,0)
 I '$D(^TMP("WV",$J,1)) D  Q
"RTN","WVBRNED1",31,0)
 .D HEADER5^WVUTL7
"RTN","WVBRNED1",32,0)
 .K WVPRMT,WVPRMT1,WVPRMTQ,DIR
"RTN","WVBRNED1",33,0)
 .W !!?5,"No records match the selected criteria.",!
"RTN","WVBRNED1",34,0)
 .I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVBRNED1",35,0)
 .D ^%ZISC S WVPOP=1
"RTN","WVBRNED1",36,0)
 ;
"RTN","WVBRNED1",37,0)
DISPLAY1 ;EP
"RTN","WVBRNED1",38,0)
 ;---> IF A PROCEDURE IS EDITED ON THE LAST PAGE, GOTO HERE
"RTN","WVBRNED1",39,0)
 ;---> FROM LINELABEL "END" BELOW.
"RTN","WVBRNED1",40,0)
 N M,Y
"RTN","WVBRNED1",41,0)
 D HEADER5^WVUTL7
"RTN","WVBRNED1",42,0)
 F  S N=$O(^TMP("WV",$J,2,N)) Q:'N!(WVPOP)  D
"RTN","WVBRNED1",43,0)
 .I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVBRNED1",44,0)
 ..S WVPAGE=WVPAGE+1
"RTN","WVBRNED1",45,0)
 ..D HEADER5^WVUTL7
"RTN","WVBRNED1",46,0)
 .S Y=^TMP("WV",$J,2,N),M=N
"RTN","WVBRNED1",47,0)
 .;---> DON'T WRITE BROWSE SELECTION#'S IF IO IS NOT A CRT (BRCRT).
"RTN","WVBRNED1",48,0)
 .W !! W:WVCRT $J(N,3),")"                  ;BROWSE SELECTION#
"RTN","WVBRNED1",49,0)
 .W ?WVTAB-2,$P(Y,U)                        ;SSN#
"RTN","WVBRNED1",50,0)
 .W ?WVTAB+10,$E($P(Y,U,2),1,16)," "        ;NAME
"RTN","WVBRNED1",51,0)
 .W $$REPEAT^XLFSTR(".",16-$L($P(Y,U,2)))   ;CONNECTING DOTS
"RTN","WVBRNED1",52,0)
 .W:'WVCRT "..."                            ;ADD DOTS IF NOT A CRT
"RTN","WVBRNED1",53,0)
 .W ?35,$E($P($P(Y,U,3),","),1,9)           ;CASE MANAGER
"RTN","WVBRNED1",54,0)
 .W ?46,$P(Y,U,4),!                         ;CERVICAL TX NEED&DATE
"RTN","WVBRNED1",55,0)
 .;I WVB=3
"RTN","WVBRNED1",56,0)
 .W ?5,"Pr. Provider => ",$E($$PROVI^WVUTL1A($P(Y,U,6)),1,25) ;PRIMARY CARE PROVIDER
"RTN","WVBRNED1",57,0)
 .W ?46,$P(Y,U,5)                           ;BREAST TX NEED&DATE
"RTN","WVBRNED1",58,0)
 ;
"RTN","WVBRNED1",59,0)
 D:'N
"RTN","WVBRNED1",60,0)
 .N WVTITLE S WVTITLE="-----  End of Report  -----"
"RTN","WVBRNED1",61,0)
 .D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE
"RTN","WVBRNED1",62,0)
 I $D(^TMP("WV",$J,1)) I WVCRT&('$D(IO("S"))) D:'WVPOP DIRZ^WVUTL3 W @IOF
"RTN","WVBRNED1",63,0)
 ;
"RTN","WVBRNED1",64,0)
END ;EP
"RTN","WVBRNED1",65,0)
 D ^%ZISC
"RTN","WVBRNED1",66,0)
 Q
"RTN","WVBRNED1",67,0)
 ;
"RTN","WVBRNED1",68,0)
SUBHEAD ;EP
"RTN","WVBRNED1",69,0)
 ;---> SUB HEADER FOR PATIENT BROWSE OUTPUT.
"RTN","WVBRNED1",70,0)
 W !?WVTAB,$$PNLB^WVUTL5(),?WVTAB+10,"PATIENT",?35,"CASE MGR"
"RTN","WVBRNED1",71,0)
 W ?46,"TREATMENT NEED DUE BY DATE",!
"RTN","WVBRNED1",72,0)
 W $$REPEAT^XLFSTR("-",80)
"RTN","WVBRNED1",73,0)
 Q
"RTN","WVBRNED1",74,0)
 ;
"RTN","WVBRNED1",75,0)
EDIT ;EP
"RTN","WVBRNED1",76,0)
 ;---> FROM BROWSE, WVPOP IN TO EDIT AN INDIVIDUAL PATIENT.
"RTN","WVBRNED1",77,0)
 N WVPRMT,WVPRMT1,WVPRMT2,WVPRMTQ
"RTN","WVBRNED1",78,0)
 D SETVARS^WVUTL5
"RTN","WVBRNED1",79,0)
 S X=+X,WVDFN=$P(^TMP("WV",$J,2,X),U,6)
"RTN","WVBRNED1",80,0)
 S WVN=X N X
"RTN","WVBRNED1",81,0)
 D SCREEN^WVPATE(WVDFN)
"RTN","WVBRNED1",82,0)
 ;---> BACK UP 5 RECORDS AFTER EDIT.
"RTN","WVBRNED1",83,0)
 S N=$S(WVN<6:1,1:WVN-5) K WVN
"RTN","WVBRNED1",84,0)
 Q
"RTN","WVBRNEDH")
0^4^B6034170
"RTN","WVBRNEDH",1,0)
WVBRNEDH ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE TX NEEDS PAST DUE;
"RTN","WVBRNEDH",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRNEDH",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRNEDH",4,0)
 ;;  HELP TEXT FOR SELECTING CRITERIA WHEN BROWSING TX NEEDS.
"RTN","WVBRNEDH",5,0)
 ;;  CALLED BY WVBRNED.
"RTN","WVBRNEDH",6,0)
 ;
"RTN","WVBRNEDH",7,0)
HELP1 ;EP
"RTN","WVBRNEDH",8,0)
 ;;Answer "YES" to include in the report those patients whose
"RTN","WVBRNEDH",9,0)
 ;;Breast or Cervical Treatment Needs are undetermined.
"RTN","WVBRNEDH",10,0)
 ;;Answer "NO" to report only those patients whose Breast and
"RTN","WVBRNEDH",11,0)
 ;;Cervical Treatment Needs are known and past their due dates.
"RTN","WVBRNEDH",12,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVBRNEDH",13,0)
 Q
"RTN","WVBRNEDH",14,0)
 ;
"RTN","WVBRNEDH",15,0)
HELP2 ;EP
"RTN","WVBRNEDH",16,0)
 ;;Answer "DATE DELINQUENT" to display Procedures in order of
"RTN","WVBRNEDH",17,0)
 ;;DATE DELINQUENT in other words, earliest DATE first.
"RTN","WVBRNEDH",18,0)
 ;;Answer "PATIENT NAME" to display Procedures alphabetically by
"RTN","WVBRNEDH",19,0)
 ;;patient name.
"RTN","WVBRNEDH",20,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVBRNEDH",21,0)
 Q
"RTN","WVBRNEDH",22,0)
 ;
"RTN","WVBRNEDH",23,0)
HELP3 ;EP
"RTN","WVBRNEDH",24,0)
 ;;Answer "ONE" to browse Procedures for ONE particular Case Manager.
"RTN","WVBRNEDH",25,0)
 ;;Answer "ALL" to browse Procedures for ALL Case Managers.
"RTN","WVBRNEDH",26,0)
 S WVTAB=5,WVLINL="HELP3" D HELPTX
"RTN","WVBRNEDH",27,0)
 Q
"RTN","WVBRNEDH",28,0)
 ;
"RTN","WVBRNEDH",29,0)
HELP4 ;EP
"RTN","WVBRNEDH",30,0)
 ;;The date you select will be the date against which patients' Tx Needs
"RTN","WVBRNEDH",31,0)
 ;;Due Dates will be checked.  If you choose a date in the future,
"RTN","WVBRNEDH",32,0)
 ;;patients with Tx Needs past due on that future date will be included
"RTN","WVBRNEDH",33,0)
 ;;in the report.  Choosing a future date in this report may be of help
"RTN","WVBRNEDH",34,0)
 ;;in anticipating which patients' Tx Needs are about to become past due
"RTN","WVBRNEDH",35,0)
 ;;before they actually become delinquent.
"RTN","WVBRNEDH",36,0)
 S WVTAB=5,WVLINL="HELP4" D HELPTX
"RTN","WVBRNEDH",37,0)
 Q
"RTN","WVBRNEDH",38,0)
 ;
"RTN","WVBRNEDH",39,0)
HELPTX ;EP
"RTN","WVBRNEDH",40,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVBRNEDH",41,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVBRNEDH",42,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVBRNEDH",43,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVBRNEDH",44,0)
 Q
"RTN","WVBRNOT")
0^5^B13589756
"RTN","WVBRNOT",1,0)
WVBRNOT ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE NOTIFICATIONS; ;7/30/98  11:02
"RTN","WVBRNOT",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRNOT",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRNOT",4,0)
 ;;  CALLED BY OPTION: "WV BROWSE NOTIFICATIONS" TO BROWSE AND EDIT
"RTN","WVBRNOT",5,0)
 ;;  NOTIFICATIONS.
"RTN","WVBRNOT",6,0)
 ;
"RTN","WVBRNOT",7,0)
 ;---> VARIABLES:
"RTN","WVBRNOT",8,0)
 ;---> WVA:   1=ALL PATIENTS, 0=ONE PATIENT
"RTN","WVBRNOT",9,0)
 ;---> WVDFN: DFN OF SELECTED PATIENT
"RTN","WVBRNOT",10,0)
 ;---> DATES: WVBEGDT=BEGINNING DATE, WVENDDT=ENDING DATE
"RTN","WVBRNOT",11,0)
 ;---> WVB:   d=DELINQUENT, o=OPEN, q=queued, a=ALL (includes CLOSED).
"RTN","WVBRNOT",12,0)
 ;---> SORT SEQUENCE IN WVC:  1=DATE, PATIENT, PRIORITY
"RTN","WVBRNOT",13,0)
 ;--->                        2=PATIENT, DATE, PRIORITY
"RTN","WVBRNOT",14,0)
 ;--->                        3=PRIORITY, DATE, PATIENT
"RTN","WVBRNOT",15,0)
 ;---> USE NODES 3 & 4 IN ^TMP GLOBAL.
"RTN","WVBRNOT",16,0)
 ;
"RTN","WVBRNOT",17,0)
 D SETVARS^WVUTL5
"RTN","WVBRNOT",18,0)
 D ^WVBRNOT2 G:WVPOP EXIT
"RTN","WVBRNOT",19,0)
 D SORT
"RTN","WVBRNOT",20,0)
 D COPYGBL
"RTN","WVBRNOT",21,0)
 D ^WVBRNOT1
"RTN","WVBRNOT",22,0)
 ;
"RTN","WVBRNOT",23,0)
EXIT ;EP
"RTN","WVBRNOT",24,0)
 D KILLALL^WVUTL8
"RTN","WVBRNOT",25,0)
 Q
"RTN","WVBRNOT",26,0)
 ;
"RTN","WVBRNOT",27,0)
 ;
"RTN","WVBRNOT",28,0)
SORT ;EP
"RTN","WVBRNOT",29,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVBRNOT",30,0)
 K ^TMP("WV",$J)
"RTN","WVBRNOT",31,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVBRNOT",32,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVBRNOT",33,0)
 S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999
"RTN","WVBRNOT",34,0)
 ;
"RTN","WVBRNOT",35,0)
 ;**************************
"RTN","WVBRNOT",36,0)
 ;---> WVA=1: ALL PATIENTS
"RTN","WVBRNOT",37,0)
 I WVA D  Q
"RTN","WVBRNOT",38,0)
 .;---> BY DATE GET EITHER ALL OR OPEN ONLY.
"RTN","WVBRNOT",39,0)
 .N WVDFN,WVIEN,Y
"RTN","WVBRNOT",40,0)
 .S WVXREF=$S(WVB="a":"D",WVB="q":"APRT",1:"AOPEN")
"RTN","WVBRNOT",41,0)
 .S WVDATE=WVBEGDT1
"RTN","WVBRNOT",42,0)
 .F  S WVDATE=$O(^WV(790.4,WVXREF,WVDATE)) Q:'WVDATE!(WVDATE>WVENDDT1)  D
"RTN","WVBRNOT",43,0)
 ..S WVIEN=0
"RTN","WVBRNOT",44,0)
 ..F  S WVIEN=$O(^WV(790.4,WVXREF,WVDATE,WVIEN)) Q:'WVIEN  D
"RTN","WVBRNOT",45,0)
 ...Q:'$D(^WV(790.4,WVIEN,0))
"RTN","WVBRNOT",46,0)
 ...S Y=^WV(790.4,WVIEN,0),WVDFN=$P(Y,U)
"RTN","WVBRNOT",47,0)
 ...;---> QUIT IF SELECTING FOR ONE CASE MANAGER AND THIS DOESN'T MATCH.
"RTN","WVBRNOT",48,0)
 ...I 'WVE Q:$P(^WV(790,WVDFN,0),U,10)'=WVCMGR
"RTN","WVBRNOT",49,0)
 ...;---> QUIT IF LISTING "DELINQUENT" AND THIS PROCDURE IS NOT DELINQ.
"RTN","WVBRNOT",50,0)
 ...I WVB="d" Q:$P(Y,U,13)'<DT!($P(Y,U,13)="")
"RTN","WVBRNOT",51,0)
 ...D STORE
"RTN","WVBRNOT",52,0)
 ;
"RTN","WVBRNOT",53,0)
 ;**************************
"RTN","WVBRNOT",54,0)
 ;---> WVA=0: ONE PATIENT
"RTN","WVBRNOT",55,0)
 N WVIEN,Y S WVIEN=0
"RTN","WVBRNOT",56,0)
 F  S WVIEN=$O(^WV(790.4,"B",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVBRNOT",57,0)
 .S Y=^WV(790.4,WVIEN,0)
"RTN","WVBRNOT",58,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVBRNOT",59,0)
 .S WVDATE=$P(Y,U,2)
"RTN","WVBRNOT",60,0)
 .Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)
"RTN","WVBRNOT",61,0)
 .;---> QUIT IF "QUEUED" AND THIS NOTIFICATION IS NOT QUEUED.
"RTN","WVBRNOT",62,0)
 .I WVB="q" Q:'$P(Y,U,11)  Q:'$D(^WV(790.4,"APRT",$P(Y,U,11),WVIEN))
"RTN","WVBRNOT",63,0)
 .;---> QUIT IF "DELINQUENT" OR OPEN ONLY AND THIS ENTRY IS CLOSED.
"RTN","WVBRNOT",64,0)
 .Q:"do"[WVB&($P(Y,U,14)="c")
"RTN","WVBRNOT",65,0)
 .I WVB="d" Q:$P(Y,U,13)'<DT!($P(Y,U,13)="")
"RTN","WVBRNOT",66,0)
 .D STORE
"RTN","WVBRNOT",67,0)
 Q
"RTN","WVBRNOT",68,0)
 ;
"RTN","WVBRNOT",69,0)
STORE ;EP
"RTN","WVBRNOT",70,0)
 ;--->WVDATE IS ALREADY SET FROM LL SORT ABOVE.      ;---> DATE
"RTN","WVBRNOT",71,0)
 S WVCHRT=$$SSN^WVUTL1(WVDFN)_" "                    ;---> SSN#
"RTN","WVBRNOT",72,0)
 S WVNAME=$$NAME^WVUTL1(WVDFN)                       ;---> NAME
"RTN","WVBRNOT",73,0)
 S WVACC=$P(Y,U,6)                                   ;---> ACCESSION#
"RTN","WVBRNOT",74,0)
 I WVACC]"" S WVACC=$P(^WV(790.1,WVACC,0),U)
"RTN","WVBRNOT",75,0)
 S WVSTAT=$$STATUS^WVUTL4                            ;---> STATUS
"RTN","WVBRNOT",76,0)
 S WVPRIO=9
"RTN","WVBRNOT",77,0)
 S:$P(Y,U,4)]"" WVPRIO=$P(^WV(790.404,$P(Y,U,4),0),U,2)  ;---> PRIORITY
"RTN","WVBRNOT",78,0)
 ;
"RTN","WVBRNOT",79,0)
 S X=WVCHRT_U_WVNAME_U_WVDATE_U_WVACC_U_WVSTAT_U_WVPRIO_U_WVIEN
"RTN","WVBRNOT",80,0)
 I WVC=1 S ^TMP("WV",$J,3,WVDATE,WVNAME,WVPRIO,WVIEN)=X Q
"RTN","WVBRNOT",81,0)
 I WVC=2 S ^TMP("WV",$J,3,WVNAME,WVDATE,WVPRIO,WVIEN)=X Q
"RTN","WVBRNOT",82,0)
 I WVC=3 S ^TMP("WV",$J,3,WVPRIO,WVDATE,WVNAME,WVIEN)=X
"RTN","WVBRNOT",83,0)
 Q
"RTN","WVBRNOT",84,0)
 ;
"RTN","WVBRNOT",85,0)
COPYGBL ;EP
"RTN","WVBRNOT",86,0)
 ;---> COPY ^TMP("WV",$J,3 TO ^TMP("WV",$J,4 TO MAKE IT FLAT.
"RTN","WVBRNOT",87,0)
 N I,M,N,P,Q
"RTN","WVBRNOT",88,0)
 S N=0,I=0
"RTN","WVBRNOT",89,0)
 F  S N=$O(^TMP("WV",$J,3,N)) Q:N=""  D
"RTN","WVBRNOT",90,0)
 .S M=0
"RTN","WVBRNOT",91,0)
 .F  S M=$O(^TMP("WV",$J,3,N,M)) Q:M=""  D
"RTN","WVBRNOT",92,0)
 ..S P=0
"RTN","WVBRNOT",93,0)
 ..F  S P=$O(^TMP("WV",$J,3,N,M,P)) Q:P=""  D
"RTN","WVBRNOT",94,0)
 ...S Q=0
"RTN","WVBRNOT",95,0)
 ...F  S Q=$O(^TMP("WV",$J,3,N,M,P,Q)) Q:Q=""  D
"RTN","WVBRNOT",96,0)
 ....S I=I+1,^TMP("WV",$J,4,I)=^TMP("WV",$J,3,N,M,P,Q)
"RTN","WVBRNOT",97,0)
 Q
"RTN","WVBRNOT",98,0)
 ;
"RTN","WVBRNOT",99,0)
 ;
"RTN","WVBRNOT",100,0)
DEQUEUE ;EP
"RTN","WVBRNOT",101,0)
 ;---> TASKMAN QUEUE OF PRINTOUT.
"RTN","WVBRNOT",102,0)
 D SETVARS^WVUTL5,SORT,COPYGBL,^WVBRNOT1,EXIT
"RTN","WVBRNOT",103,0)
 Q
"RTN","WVBRNOT",104,0)
 ;
"RTN","WVBRNOT",105,0)
FOLLOW(WVDFN) ;EP
"RTN","WVBRNOT",106,0)
 ;---> CALLED FROM PROCEDURE FOLLOWUP MENU.
"RTN","WVBRNOT",107,0)
 D SETVARS^WVUTL5
"RTN","WVBRNOT",108,0)
 S WVA=0,WVB="o",WVBEGDT=(DT-50000),WVC=1,WVE=1,WVENDDT=DT
"RTN","WVBRNOT",109,0)
 D DEVICE^WVBRNOT2 Q:WVPOP
"RTN","WVBRNOT",110,0)
 S WVLOOP=1
"RTN","WVBRNOT",111,0)
 D SORT,COPYGBL,^WVBRNOT1
"RTN","WVBRNOT",112,0)
 Q
"RTN","WVBRNOT1")
0^6^B9549421
"RTN","WVBRNOT1",1,0)
WVBRNOT1 ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE NOTIFICATIONS; ;7/30/98  11:05
"RTN","WVBRNOT1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRNOT1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRNOT1",4,0)
 ;;  DISPLAY CODE FOR BROWSING NOTIFICATIONS.  CALLED BY WVBRNOT.
"RTN","WVBRNOT1",5,0)
 ;
"RTN","WVBRNOT1",6,0)
DISPLAY ;EP
"RTN","WVBRNOT1",7,0)
 ;---> WVCONF=DISPLAY "CONFIDENTIAL PT INFO" BANNER.
"RTN","WVBRNOT1",8,0)
 ;---> WVTITLE=TITLE AT TOP OF DISPLAY HEADER.
"RTN","WVBRNOT1",9,0)
 ;---> WVSUBH=CODE TO EXECUTE FOR SUBHEADER (COLUMN TITLES).
"RTN","WVBRNOT1",10,0)
 ;---> WVCODE=CODE TO EXECUTE AS 3RD PIECE OF DIR(0) (AFTER DIR READ).
"RTN","WVBRNOT1",11,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (ALLOWS SELECTIONS TO EDIT).
"RTN","WVBRNOT1",12,0)
 ;---> WVTAB=6 IF OUTPUT IS TO SCREEN, =3 IF OUTPUT IS TO PRINTER.
"RTN","WVBRNOT1",13,0)
 ;---> WVPRMT(1,Q)=PROMPTS FOR DIR.
"RTN","WVBRNOT1",14,0)
 ;---> WVD=0, TELLS DIRPRMT^WVUTL3 TO DISPLAY SELECTION NUMBERS.
"RTN","WVBRNOT1",15,0)
 ;
"RTN","WVBRNOT1",16,0)
 U IO
"RTN","WVBRNOT1",17,0)
 S WVCONF=1
"RTN","WVBRNOT1",18,0)
 S WVTITLE1=$S(WVC=1:"DATE",WVC=2:"PATIENT",WVC=3:"PRIORITY",1:"?")
"RTN","WVBRNOT1",19,0)
 S WVTITLE="* * *  NOTIFICATIONS LISTED BY "_WVTITLE1_"  * * *"
"RTN","WVBRNOT1",20,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVBRNOT1",21,0)
 S WVSUBH="SUBHEAD^WVBRNOT1"
"RTN","WVBRNOT1",22,0)
 S WVCODE="D EDIT^WVBRNOT1,SORT^WVBRNOT,COPYGBL^WVBRNOT"
"RTN","WVBRNOT1",23,0)
 S (WVD,WVPOP,N,Z)=0
"RTN","WVBRNOT1",24,0)
 D TOPHEAD^WVUTL7
"RTN","WVBRNOT1",25,0)
 S WVTAB=$S(WVCRT:6,1:3)
"RTN","WVBRNOT1",26,0)
 ;
"RTN","WVBRNOT1",27,0)
NOMATCH ;EP
"RTN","WVBRNOT1",28,0)
 ;---> QUIT IF NO RECORDS MATCH.
"RTN","WVBRNOT1",29,0)
 I '$D(^TMP("WV",$J,3)) D  Q
"RTN","WVBRNOT1",30,0)
 .D HEADER1^WVUTL7
"RTN","WVBRNOT1",31,0)
 .K WVPRMT,WVPRMT1,WVPRMTQ,DIR
"RTN","WVBRNOT1",32,0)
 .W !!?5,"No records match the selected criteria.",!
"RTN","WVBRNOT1",33,0)
 .I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVBRNOT1",34,0)
 .D ^%ZISC S WVPOP=1
"RTN","WVBRNOT1",35,0)
 ;
"RTN","WVBRNOT1",36,0)
DISPLAY1 ;EP
"RTN","WVBRNOT1",37,0)
 ;---> IF A NOTIFICATION IS EDITED ON THE LAST PAGE, GOTO HERE
"RTN","WVBRNOT1",38,0)
 ;---> FROM LINELABEL "END" BELOW.
"RTN","WVBRNOT1",39,0)
 D HEADER1^WVUTL7
"RTN","WVBRNOT1",40,0)
 F  S N=$O(^TMP("WV",$J,4,N)) Q:'N!(WVPOP)  D
"RTN","WVBRNOT1",41,0)
 .I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVBRNOT1",42,0)
 ..S WVPAGE=WVPAGE+1
"RTN","WVBRNOT1",43,0)
 ..D HEADER1^WVUTL7 S Z=0
"RTN","WVBRNOT1",44,0)
 .S Y=^TMP("WV",$J,4,N),M=N
"RTN","WVBRNOT1",45,0)
 .W !
"RTN","WVBRNOT1",46,0)
 .;---> DON'T WRITE SSN# AND NAME IF IT MATCHES THE PREVIOUS RECORD.
"RTN","WVBRNOT1",47,0)
 .;---> DON'T WRITE BROWSE SELECTION#'S IF IO IS NOT A CRT (BRCRT).
"RTN","WVBRNOT1",48,0)
 .I $P(Y,U)'=Z D
"RTN","WVBRNOT1",49,0)
 ..W ! W:WVCRT $J(N,3),")"                      ;BROWSE SELECTION#
"RTN","WVBRNOT1",50,0)
 ..W ?WVTAB,$P(Y,U)                             ;SSN#
"RTN","WVBRNOT1",51,0)
 ..W ?WVTAB+10,$E($P(Y,U,2),1,22)," "           ;NAME
"RTN","WVBRNOT1",52,0)
 ..W $$REPEAT^XLFSTR(".",22-$L($P(Y,U,2)))               ;CONNECTING DOTS
"RTN","WVBRNOT1",53,0)
 ..W:'WVCRT "..."                               ;ADD DOTS IF NOT A CRT
"RTN","WVBRNOT1",54,0)
 .I $P(Y,U)=Z D                                 ;IF NEW SSN#...
"RTN","WVBRNOT1",55,0)
 ..W:WVCRT $J(N,3),")"                          ;BROWSE SELECTION#
"RTN","WVBRNOT1",56,0)
 ..W ?WVTAB,". . . .   . . . . . . . . . . . . ." ;CONNECTING DOTS
"RTN","WVBRNOT1",57,0)
 .S Z=$P(Y,U)                                   ;STORE AS PREVIOUS CHRT#
"RTN","WVBRNOT1",58,0)
 .;
"RTN","WVBRNOT1",59,0)
 .W ?40,$$SLDT2^WVUTL5($P(Y,U,3))               ;DATE OF NOTIFICATION
"RTN","WVBRNOT1",60,0)
 .W ?51,$P(Y,U,4)                               ;ACCESSION#
"RTN","WVBRNOT1",61,0)
 .;W ?64,$E($P(Y,U,5),1,6)
"RTN","WVBRNOT1",62,0)
 .W ?65,$E($P(Y,U,5))                           ;STATUS
"RTN","WVBRNOT1",63,0)
 .S X=$P(Y,U,6)                                 ;PRIORITY
"RTN","WVBRNOT1",64,0)
 .W ?70,$S(X=1:"*",1:" ")
"RTN","WVBRNOT1",65,0)
 .W $E($P($P(^DD(790.404,.02,0),X_":",2),";"),1,8) K X
"RTN","WVBRNOT1",66,0)
 I $D(^TMP("WV",$J,3)) I WVCRT&('$D(IO("S"))) D:'WVPOP DIRZ^WVUTL3 W @IOF
"RTN","WVBRNOT1",67,0)
END ;EP
"RTN","WVBRNOT1",68,0)
 D ^%ZISC
"RTN","WVBRNOT1",69,0)
 Q
"RTN","WVBRNOT1",70,0)
 ;
"RTN","WVBRNOT1",71,0)
SUBHEAD ;EP
"RTN","WVBRNOT1",72,0)
 ;---> SUB HEADER FOR NOTIFICATION BROWSE OUTPUT.
"RTN","WVBRNOT1",73,0)
 W !?WVTAB,$$PNLB^WVUTL5()
"RTN","WVBRNOT1",74,0)
 W ?WVTAB+12,"PATIENT",?41,"DATE",?51,"ACC#"
"RTN","WVBRNOT1",75,0)
 W ?63,"STATUS",?71,"PRIORITY",!
"RTN","WVBRNOT1",76,0)
 W $$REPEAT^XLFSTR("-",80)
"RTN","WVBRNOT1",77,0)
 Q
"RTN","WVBRNOT1",78,0)
 ;
"RTN","WVBRNOT1",79,0)
EDIT ;EP
"RTN","WVBRNOT1",80,0)
 ;---> FROM BROWSE, POP IN TO EDIT A SINGLE NOTIFICATION.
"RTN","WVBRNOT1",81,0)
 D SETVARS^WVUTL5
"RTN","WVBRNOT1",82,0)
 S X=+X,DA=$P(^TMP("WV",$J,4,X),U,7)
"RTN","WVBRNOT1",83,0)
 S WVNN=X N X
"RTN","WVBRNOT1",84,0)
 D EDIT2^WVNOTIF(DA)
"RTN","WVBRNOT1",85,0)
 ;---> BACK UP 5 RECORDS AFTER EDIT.
"RTN","WVBRNOT1",86,0)
 S N=$S(WVNN<6:1,1:WVNN-5),Z=0 K WVNN
"RTN","WVBRNOT1",87,0)
 Q
"RTN","WVBRNOT2")
0^7^B32034061
"RTN","WVBRNOT2",1,0)
WVBRNOT2 ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE NOTIFICATIONS;
"RTN","WVBRNOT2",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRNOT2",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRNOT2",4,0)
 ;;  PROMPTS FOR SELECTION CRITERIA WHEN BROWSING NOTIFICATIONS.
"RTN","WVBRNOT2",5,0)
 ;;  CALLED BY WVBRNOT.
"RTN","WVBRNOT2",6,0)
 ;
"RTN","WVBRNOT2",7,0)
 D SETVARS^WVUTL5
"RTN","WVBRNOT2",8,0)
 D TITLE^WVUTL5("BROWSE NOTIFICATIONS")
"RTN","WVBRNOT2",9,0)
 D ONEALL Q:WVPOP
"RTN","WVBRNOT2",10,0)
 D DATES  Q:WVPOP
"RTN","WVBRNOT2",11,0)
 D STATUS Q:WVPOP
"RTN","WVBRNOT2",12,0)
 D CMGR   Q:WVPOP
"RTN","WVBRNOT2",13,0)
 D ORDER  Q:WVPOP
"RTN","WVBRNOT2",14,0)
 D DEVICE Q:WVPOP
"RTN","WVBRNOT2",15,0)
 Q
"RTN","WVBRNOT2",16,0)
 ;
"RTN","WVBRNOT2",17,0)
ONEALL ;EP
"RTN","WVBRNOT2",18,0)
 ;---> SELECT ONE PATIENT OR ALL PATIENTS.
"RTN","WVBRNOT2",19,0)
 K DIR
"RTN","WVBRNOT2",20,0)
 W !!?3,"Browse Notifications for ONE individual patient,"
"RTN","WVBRNOT2",21,0)
 W !?3,"or browse Notifications for ALL patients?"
"RTN","WVBRNOT2",22,0)
 S DIR("A")="   Select ONE or ALL: ",DIR("B")="ALL"
"RTN","WVBRNOT2",23,0)
 S DIR(0)="SAM^o:ONE;a:ALL" D HELP2
"RTN","WVBRNOT2",24,0)
 D ^DIR K DIR
"RTN","WVBRNOT2",25,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNOT2",26,0)
 ;---> IF ALL PATIENTS, S WVA=1 AND QUIT.
"RTN","WVBRNOT2",27,0)
 I Y="a" S WVA=1 Q
"RTN","WVBRNOT2",28,0)
 ;
"RTN","WVBRNOT2",29,0)
 W !!,"   Select the patient whose Notifications you wish to browse."
"RTN","WVBRNOT2",30,0)
 D PATLKUP^WVUTL8(.Y)
"RTN","WVBRNOT2",31,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVBRNOT2",32,0)
 ;---> FOR ONE PATIENT, SET WVA=0 AND WVDFN=PATIENT DFN, QUIT.
"RTN","WVBRNOT2",33,0)
 S WVDFN=+Y,WVA=0,WVCMGR=$P(^WV(790,WVDFN,0),U,10)
"RTN","WVBRNOT2",34,0)
 Q
"RTN","WVBRNOT2",35,0)
 ;
"RTN","WVBRNOT2",36,0)
DATES ;EP
"RTN","WVBRNOT2",37,0)
 ;---> ASK DATE RANGE.  RETURN DATES IN WVBEGDT AND WVENDDT.
"RTN","WVBRNOT2",38,0)
 ;---> IF LOOKING AT ONLY ONE PATIENT, SET DEFAULT BEGIN DATE=T-365.
"RTN","WVBRNOT2",39,0)
 S WVBEGDF=$S(WVA:"T-30",1:"T-365")
"RTN","WVBRNOT2",40,0)
 D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP,WVBEGDF,"T")
"RTN","WVBRNOT2",41,0)
 Q
"RTN","WVBRNOT2",42,0)
 ;
"RTN","WVBRNOT2",43,0)
STATUS ;EP
"RTN","WVBRNOT2",44,0)
 ;---> GET XREF: OPEN OR ALL
"RTN","WVBRNOT2",45,0)
 W !!?3,"Do you wish to browse DELINQUENT, OPEN, QUEUED, "
"RTN","WVBRNOT2",46,0)
 W "or ALL Notifications?"
"RTN","WVBRNOT2",47,0)
 S DIR("A")="   Select DELINQUENT, OPEN, QUEUED or ALL: "
"RTN","WVBRNOT2",48,0)
 S DIR("B")="OPEN"
"RTN","WVBRNOT2",49,0)
 S DIR(0)="SAM^d:DELINQUENT;o:OPEN;q:QUEUED;a:ALL" D HELP4
"RTN","WVBRNOT2",50,0)
 D ^DIR K DIR
"RTN","WVBRNOT2",51,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNOT2",52,0)
 S WVB=Y
"RTN","WVBRNOT2",53,0)
 Q
"RTN","WVBRNOT2",54,0)
 ;
"RTN","WVBRNOT2",55,0)
CMGR ;EP
"RTN","WVBRNOT2",56,0)
 ;---> SELECT CASES FOR ONE CASE MANAGER OR ALL.
"RTN","WVBRNOT2",57,0)
 ;---> DO NOT PROMPT FOR CASE MANAGER IF SITE PARAMETERS SAY NOT TO,
"RTN","WVBRNOT2",58,0)
 ;---> OR IF LOOKING AT PROCEDURES FOR ONLY ONE PATIENT.
"RTN","WVBRNOT2",59,0)
 I '$D(^WV(790.02,DUZ(2),0)) S WVE=1 Q
"RTN","WVBRNOT2",60,0)
 I '$P(^WV(790.02,DUZ(2),0),U,5)!('WVA) S WVE=1 Q
"RTN","WVBRNOT2",61,0)
 W !!?3,"Browse Notifications for ONE particular Case Manager,"
"RTN","WVBRNOT2",62,0)
 W !?3,"or browse Notifications for ALL Case Managers?"
"RTN","WVBRNOT2",63,0)
 S DIR("A")="   Select ONE or ALL: ",DIR("B")="ALL"
"RTN","WVBRNOT2",64,0)
 S DIR(0)="SAM^o:ONE;a:ALL" D HELP5
"RTN","WVBRNOT2",65,0)
 D ^DIR K DIR
"RTN","WVBRNOT2",66,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNOT2",67,0)
 ;---> IF ALL CASE MANAGERS, S WVE=1 AND QUIT.
"RTN","WVBRNOT2",68,0)
 I Y="a" S WVE=1 Q
"RTN","WVBRNOT2",69,0)
 ;
"RTN","WVBRNOT2",70,0)
 W !!,"   Select the Case Manager whose patients you wish to browse."
"RTN","WVBRNOT2",71,0)
 ;
"RTN","WVBRNOT2",72,0)
 D DIC^WVFMAN(790.01,"QEMA",.Y,"   Select CASE MANAGER: ")
"RTN","WVBRNOT2",73,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVBRNOT2",74,0)
 ;---> FOR ONE CASE MANAGER, SET WVE=0 AND WVCMGR=^VA(200 DFN, QUIT.
"RTN","WVBRNOT2",75,0)
 S WVCMGR=+Y,WVE=0
"RTN","WVBRNOT2",76,0)
 Q
"RTN","WVBRNOT2",77,0)
 ;
"RTN","WVBRNOT2",78,0)
 ;
"RTN","WVBRNOT2",79,0)
ORDER ;EP
"RTN","WVBRNOT2",80,0)
 ;---> ASK ORDER BY DATE OR BY PATIENT OR BY PRIORITY.
"RTN","WVBRNOT2",81,0)
 ;---> IF LOOKING AT ONLY ONE PATIENT, ORDER BY DATE AND QUIT.
"RTN","WVBRNOT2",82,0)
 I 'WVA S WVC=1 Q
"RTN","WVBRNOT2",83,0)
 ;
"RTN","WVBRNOT2",84,0)
 ;---> SORT SEQUENCE IN WVC:  1=DATE, PATIENT, PRIORITY
"RTN","WVBRNOT2",85,0)
 ;--->                        2=PATIENT, DATE, PRIORITY
"RTN","WVBRNOT2",86,0)
 ;--->                        3=PRIORITY, DATE, PATIENT
"RTN","WVBRNOT2",87,0)
 ;
"RTN","WVBRNOT2",88,0)
 W !!?3,"Display Notifications in order of:"
"RTN","WVBRNOT2",89,0)
 W ?39,"1) DATE OF NOTIFICATION (earliest first)"
"RTN","WVBRNOT2",90,0)
 W !?39,"2) NAME OF PATIENT (alphabetically)"
"RTN","WVBRNOT2",91,0)
 W !?39,"3) PRIORITY (beginning with URGENT)"
"RTN","WVBRNOT2",92,0)
 S DIR("A")="   Select 1, 2, or 3: ",DIR("B")=1
"RTN","WVBRNOT2",93,0)
 S DIR(0)="SAM^1:DATE;2:NAME;3:PRIORITY" D HELP3
"RTN","WVBRNOT2",94,0)
 D ^DIR K DIR
"RTN","WVBRNOT2",95,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRNOT2",96,0)
 S WVC=Y
"RTN","WVBRNOT2",97,0)
 Q
"RTN","WVBRNOT2",98,0)
 ;
"RTN","WVBRNOT2",99,0)
DEVICE ;EP
"RTN","WVBRNOT2",100,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVBRNOT2",101,0)
 S ZTRTN="DEQUEUE^WVBRNOT"
"RTN","WVBRNOT2",102,0)
 F WVSV="A","B","C","D","E","CMGR","DFN","BEGDT","ENDDT" D
"RTN","WVBRNOT2",103,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVBRNOT2",104,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVBRNOT2",105,0)
 Q
"RTN","WVBRNOT2",106,0)
 ;
"RTN","WVBRNOT2",107,0)
HELP2 ;EP
"RTN","WVBRNOT2",108,0)
 ;;Answer "ONE" to browse Notifications for ONE particular patient.
"RTN","WVBRNOT2",109,0)
 ;;Answer "ALL" to browse Notifications for ALL patients.
"RTN","WVBRNOT2",110,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVBRNOT2",111,0)
 Q
"RTN","WVBRNOT2",112,0)
 ;
"RTN","WVBRNOT2",113,0)
HELP3 ;EP
"RTN","WVBRNOT2",114,0)
 ;;Enter "DATE" to list Notifications in chronological order beginning
"RTN","WVBRNOT2",115,0)
 ;;   with the oldest first.
"RTN","WVBRNOT2",116,0)
 ;;Enter "NAME" to list Notifications by Patient Name in alphabetical
"RTN","WVBRNOT2",117,0)
 ;;   order.
"RTN","WVBRNOT2",118,0)
 ;;Enter "PRIORITY" to list Notifications by degree of urgency,
"RTN","WVBRNOT2",119,0)
 ;;   beginning with the most urgent first.
"RTN","WVBRNOT2",120,0)
 S WVTAB=5,WVLINL="HELP3" D HELPTX
"RTN","WVBRNOT2",121,0)
 Q
"RTN","WVBRNOT2",122,0)
 ;
"RTN","WVBRNOT2",123,0)
HELP4 ;EP
"RTN","WVBRNOT2",124,0)
 ;;"OPEN Notifications" are ones that have not yet been closed,
"RTN","WVBRNOT2",125,0)
 ;;     in other words, the patient has not yet been reached or has not
"RTN","WVBRNOT2",126,0)
 ;;     yet responded.
"RTN","WVBRNOT2",127,0)
 ;;
"RTN","WVBRNOT2",128,0)
 ;;"DELINQUENT Notifications" are OPEN Notifications that have remained
"RTN","WVBRNOT2",129,0)
 ;;     open past the date they were due to be closed (as determined by
"RTN","WVBRNOT2",130,0)
 ;;     the "DATE DELINQUENT BY" field in the Edit Notification screen).
"RTN","WVBRNOT2",131,0)
 ;;
"RTN","WVBRNOT2",132,0)
 ;;"QUEUED Notifications" are only LETTERS waiting to be printed.
"RTN","WVBRNOT2",133,0)
 ;;     They do not include letters that have already been printed.
"RTN","WVBRNOT2",134,0)
 ;;
"RTN","WVBRNOT2",135,0)
 ;;"ALL Notifications" includes DELINQUENT, OPEN and CLOSED.
"RTN","WVBRNOT2",136,0)
 ;;     CLOSED notifications are ones that have been brought to closure,
"RTN","WVBRNOT2",137,0)
 ;;     in other words, either the patient has been contacted or the
"RTN","WVBRNOT2",138,0)
 ;;     case is no longer active.
"RTN","WVBRNOT2",139,0)
 S WVTAB=5,WVLINL="HELP4" D HELPTX
"RTN","WVBRNOT2",140,0)
 Q
"RTN","WVBRNOT2",141,0)
 ;
"RTN","WVBRNOT2",142,0)
HELP5 ;EP
"RTN","WVBRNOT2",143,0)
 ;;Answer "ONE" to browse Notifications for ONE particular Case Manager.
"RTN","WVBRNOT2",144,0)
 ;;Answer "ALL" to browse Notifications for ALL Case Managers.
"RTN","WVBRNOT2",145,0)
 S WVTAB=5,WVLINL="HELP5" D HELPTX
"RTN","WVBRNOT2",146,0)
 Q
"RTN","WVBRNOT2",147,0)
 ;
"RTN","WVBRNOT2",148,0)
HELPTX ;EP
"RTN","WVBRNOT2",149,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVBRNOT2",150,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVBRNOT2",151,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVBRNOT2",152,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVBRNOT2",153,0)
 Q
"RTN","WVBRPCD")
0^8^B19175638
"RTN","WVBRPCD",1,0)
WVBRPCD ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE PROCEDURES; ;7/30/98  11:07
"RTN","WVBRPCD",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRPCD",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRPCD",4,0)
 ;;  CALLED BY OPTION: "WV BROWSE PROCEDURES" TO BROWSE AND EDIT
"RTN","WVBRPCD",5,0)
 ;;  PROCEDURES.
"RTN","WVBRPCD",6,0)
 ;
"RTN","WVBRPCD",7,0)
 ;---> VARIABLES:
"RTN","WVBRPCD",8,0)
 ;---> WVA:   1=ALL PATIENTS, 0=ONE PATIENT
"RTN","WVBRPCD",9,0)
 ;---> WVDFN: DFN OF SELECTED PATIENT
"RTN","WVBRPCD",10,0)
 ;---> DATES: WVBEGDT=BEGINNING DATE, WVENDDT=ENDING DATE
"RTN","WVBRPCD",11,0)
 ;---> WVD:   1=BOTH ABNORMAL AND NORMAL, 0=NORMAL ONLY
"RTN","WVBRPCD",12,0)
 ;---> SORT SEQUENCE IN WVC:  1=DATE, PATIENT, PRIORITY
"RTN","WVBRPCD",13,0)
 ;--->                        2=PATIENT, DATE, PRIORITY
"RTN","WVBRPCD",14,0)
 ;--->                        3=PRIORITY, DATE, PATIENT
"RTN","WVBRPCD",15,0)
 ;---> USE NODES 1 & 2 IN ^TMP GLOBAL
"RTN","WVBRPCD",16,0)
 ;
"RTN","WVBRPCD",17,0)
 D SETVARS^WVUTL5 S WVPOP=0
"RTN","WVBRPCD",18,0)
 D ^WVBRPCD2 G:WVPOP EXIT
"RTN","WVBRPCD",19,0)
 D SORT
"RTN","WVBRPCD",20,0)
 D COPYGBL
"RTN","WVBRPCD",21,0)
 ;---> NEXT LINE: PASS TITLE, HEADER (IN ^WVUTL7), AND CODE TO
"RTN","WVBRPCD",22,0)
 ;---> EXECUTE BY DIR AT BOTTOM OF SCREEN.
"RTN","WVBRPCD",23,0)
 D DISPLAY^WVBRPCD1(WVTITLE,WVHEADER,WVCODE)
"RTN","WVBRPCD",24,0)
 ;
"RTN","WVBRPCD",25,0)
EXIT ;EP
"RTN","WVBRPCD",26,0)
 D KILLALL^WVUTL8
"RTN","WVBRPCD",27,0)
 Q
"RTN","WVBRPCD",28,0)
 ;
"RTN","WVBRPCD",29,0)
 ;
"RTN","WVBRPCD",30,0)
SORT ;EP
"RTN","WVBRPCD",31,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVBRPCD",32,0)
 K ^TMP("WV",$J)
"RTN","WVBRPCD",33,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVBRPCD",34,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVBRPCD",35,0)
 S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999
"RTN","WVBRPCD",36,0)
 ;
"RTN","WVBRPCD",37,0)
 ;***********************
"RTN","WVBRPCD",38,0)
 ;---> WVA=1 ALL PATIENTS
"RTN","WVBRPCD",39,0)
 I WVA D  Q
"RTN","WVBRPCD",40,0)
 .;---> BY DATE GET EITHER ALL OR ABNORMAL ONLY.
"RTN","WVBRPCD",41,0)
 .;---> ("INSUFFICIENT TISSUE" IS INCLUDED IN ABNML XREF.)
"RTN","WVBRPCD",42,0)
 .S WVXREF=$S(WVD:"D",1:"ABNML")
"RTN","WVBRPCD",43,0)
 .S WVDATE=WVBEGDT1
"RTN","WVBRPCD",44,0)
 .F  S WVDATE=$O(^WV(790.1,WVXREF,WVDATE)) Q:'WVDATE!(WVDATE>WVENDDT1)  D
"RTN","WVBRPCD",45,0)
 ..S WVIEN=0
"RTN","WVBRPCD",46,0)
 ..F  S WVIEN=$O(^WV(790.1,WVXREF,WVDATE,WVIEN)) Q:'WVIEN  D
"RTN","WVBRPCD",47,0)
 ...S Y=^WV(790.1,WVIEN,0),WVDFN=$P(Y,U,2)
"RTN","WVBRPCD",48,0)
 ...;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVBRPCD",49,0)
 ...Q:$P(Y,U,5)=8
"RTN","WVBRPCD",50,0)
 ...;---> QUIT IF NOT SELECTING FOR ALL PROCEDURES AND IF THIS IS
"RTN","WVBRPCD",51,0)
 ...;---> NOT ONE OF THE SELECTED PROCEDURES.
"RTN","WVBRPCD",52,0)
 ...I '$D(WVARR("ALL"))  Q:'$D(WVARR($P(Y,U,4)))
"RTN","WVBRPCD",53,0)
 ...;---> QUIT IF NOT "ALL PROCEDURES" AND THIS ENTRY IS "CLOSED".
"RTN","WVBRPCD",54,0)
 ...Q:WVB'="a"&($P(Y,U,14)="c")
"RTN","WVBRPCD",55,0)
 ...;---> QUIT IF SELECTING FOR ONE CASE MANAGER AND THIS DOESN'T MATCH.
"RTN","WVBRPCD",56,0)
 ...I 'WVE Q:$P(^WV(790,WVDFN,0),U,10)'=WVCMGR
"RTN","WVBRPCD",57,0)
 ...;---> QUIT IF LISTING "DELINQUENT" AND THIS PROCDURE IS NOT DELINQ.
"RTN","WVBRPCD",58,0)
 ...I WVB="d" Q:$P(Y,U,13)>DT!($P(Y,U,13)="")
"RTN","WVBRPCD",59,0)
 ...;---> QUIT IF LISTING "NEW" AND THIS PROCDURE IS NOT NEW.
"RTN","WVBRPCD",60,0)
 ...;Q:WVB="n"&($P(Y,U,14)'="n")
"RTN","WVBRPCD",61,0)
 ...D STORE(WVC,WVIEN,Y)
"RTN","WVBRPCD",62,0)
 ;
"RTN","WVBRPCD",63,0)
 ;**********************
"RTN","WVBRPCD",64,0)
 ;---> WVA=0 ONE PATIENT
"RTN","WVBRPCD",65,0)
 S WVIEN=0
"RTN","WVBRPCD",66,0)
 F  S WVIEN=$O(^WV(790.1,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVBRPCD",67,0)
 .;---> SET Y=THE ZERO NODE FOR THIS PROCEDURE.
"RTN","WVBRPCD",68,0)
 .S Y=^WV(790.1,WVIEN,0)
"RTN","WVBRPCD",69,0)
 .;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVBRPCD",70,0)
 .Q:$P(Y,U,5)=8
"RTN","WVBRPCD",71,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVBRPCD",72,0)
 .S WVDATE=$P(Y,U,12)
"RTN","WVBRPCD",73,0)
 .Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)
"RTN","WVBRPCD",74,0)
 .;---> QUIT IF SELECTING FOR "ABNORMAL" ONLY AND THIS PROCEDURE
"RTN","WVBRPCD",75,0)
 .;---> "NORMAL". ("INSUFF TISSUE" AND "UNSAT EXAM" WILL BE "ABNORMAL".)
"RTN","WVBRPCD",76,0)
 .Q:'WVD&('$$NORMAL^WVUTL4($P(Y,U,5)))
"RTN","WVBRPCD",77,0)
 .;---> QUIT IF "DELINQUENT" OR "OPEN" ONLY AND THIS ENTRY IS "CLOSED".
"RTN","WVBRPCD",78,0)
 .Q:WVB'="a"&($P(Y,U,14)="c")
"RTN","WVBRPCD",79,0)
 .;---> QUIT IF LISTING "DELINQUENT" AND THIS PROCDURE IS NOT DELINQ.
"RTN","WVBRPCD",80,0)
 .I WVB="d" Q:$P(Y,U,13)>DT!($P(Y,U,13)="")
"RTN","WVBRPCD",81,0)
 .;Q:WVB="n"&($P(Y,U,14)'="n")
"RTN","WVBRPCD",82,0)
 .D STORE(WVC,WVIEN,Y)
"RTN","WVBRPCD",83,0)
 Q
"RTN","WVBRPCD",84,0)
 ;
"RTN","WVBRPCD",85,0)
STORE(WVC,WVIEN,Y) ;EP
"RTN","WVBRPCD",86,0)
 ;---> CALLED TO STORE PROCEDURES IN ^TMP FOR BROWSING.
"RTN","WVBRPCD",87,0)
 ;---> WVC=LIST ORDER, WVIEN=IEN OR PROCEDURE, Y=ZERO NODE OF PROCEDURE.
"RTN","WVBRPCD",88,0)
 S WVDFN=$P(Y,U,2),WVDATE=$P(Y,U,12)                   ;---> DFN, DATE
"RTN","WVBRPCD",89,0)
 S WVCHRT=$$SSN^WVUTL1(WVDFN)_" "                      ;---> SSN#
"RTN","WVBRPCD",90,0)
 S WVNAME=$$NAME^WVUTL1(WVDFN)                         ;---> NAME
"RTN","WVBRPCD",91,0)
 S WVACC=$P(Y,U)                                       ;---> ACCESSION#
"RTN","WVBRPCD",92,0)
 S WVSTAT=$E($$STATUS^WVUTL4)                          ;---> STATUS
"RTN","WVBRPCD",93,0)
 S WVDIAG=$$DIAG^WVUTL4($P(Y,U,5))                     ;---> RESULT/DIAG
"RTN","WVBRPCD",94,0)
 S X=$P(Y,U,5),WVPRIO=$$PRIOR^WVUTL4 K X               ;---> PRIORITY
"RTN","WVBRPCD",95,0)
 ;
"RTN","WVBRPCD",96,0)
 S X=WVCHRT_U_WVNAME_U_WVDATE_U_WVACC_U_WVDIAG_U_WVPRIO_U_WVSTAT_U_WVIEN
"RTN","WVBRPCD",97,0)
 I WVC=1 S ^TMP("WV",$J,1,WVDATE,WVNAME,WVPRIO,WVIEN)=X Q
"RTN","WVBRPCD",98,0)
 I WVC=2 S ^TMP("WV",$J,1,WVNAME,WVDATE,WVPRIO,WVIEN)=X Q
"RTN","WVBRPCD",99,0)
 I WVC=3 S ^TMP("WV",$J,1,WVPRIO,WVDATE,WVNAME,WVIEN)=X
"RTN","WVBRPCD",100,0)
 Q
"RTN","WVBRPCD",101,0)
 ;
"RTN","WVBRPCD",102,0)
COPYGBL ;EP
"RTN","WVBRPCD",103,0)
 ;---> CALLED TO FLATTEN THE ^TMP ARRAY OF PROCEDURES FOR BROWSING.
"RTN","WVBRPCD",104,0)
 ;---> COPY ^TMP("WV",$J,1 TO ^TMP("WV",$J,2 TO MAKE IT FLAT.
"RTN","WVBRPCD",105,0)
 N I,M,N,P,Q
"RTN","WVBRPCD",106,0)
 S N=0,I=0
"RTN","WVBRPCD",107,0)
 F  S N=$O(^TMP("WV",$J,1,N)) Q:N=""  D
"RTN","WVBRPCD",108,0)
 .S M=0
"RTN","WVBRPCD",109,0)
 .F  S M=$O(^TMP("WV",$J,1,N,M)) Q:M=""  D
"RTN","WVBRPCD",110,0)
 ..S P=0
"RTN","WVBRPCD",111,0)
 ..F  S P=$O(^TMP("WV",$J,1,N,M,P)) Q:P=""  D
"RTN","WVBRPCD",112,0)
 ...S Q=0
"RTN","WVBRPCD",113,0)
 ...F  S Q=$O(^TMP("WV",$J,1,N,M,P,Q)) Q:Q=""  D
"RTN","WVBRPCD",114,0)
 ....S I=I+1,^TMP("WV",$J,2,I)=^TMP("WV",$J,1,N,M,P,Q)
"RTN","WVBRPCD",115,0)
 Q
"RTN","WVBRPCD",116,0)
 ;
"RTN","WVBRPCD",117,0)
DEQUEUE ;EP
"RTN","WVBRPCD",118,0)
 ;---> FOR TASKMAN QUEUE OF PRINTOUT.
"RTN","WVBRPCD",119,0)
 D SETVARS^WVUTL5,SORT,COPYGBL
"RTN","WVBRPCD",120,0)
 D DISPLAY^WVBRPCD1(WVTITLE,WVHEADER,WVCODE)
"RTN","WVBRPCD",121,0)
 D EXIT
"RTN","WVBRPCD",122,0)
 Q
"RTN","WVBRPCD1")
0^9^B8655034
"RTN","WVBRPCD1",1,0)
WVBRPCD1 ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE PROCEDURES; ;8/10/98  16:37
"RTN","WVBRPCD1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRPCD1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRPCD1",4,0)
 ;;  DISPLAY CODE FOR BROWSING PROCEDURES.  CALLED BY BRBRPCD.
"RTN","WVBRPCD1",5,0)
 ;
"RTN","WVBRPCD1",6,0)
DISPLAY(WVTITLE,WVHEADER,WVCODE) ;EP
"RTN","WVBRPCD1",7,0)
 ;---> WVCONF=DISPLAY "CONFIDENTIAL PT INFO" BANNER.
"RTN","WVBRPCD1",8,0)
 ;---> WVTITLE=TITLE AT TOP OF DISPLAY HEADER.
"RTN","WVBRPCD1",9,0)
 ;---> WVHEADER=HEADER CALL TO ^WVUTL7
"RTN","WVBRPCD1",10,0)
 ;---> WVCODE=CODE TO EXECUTE AS 3RD PIECE OF DIR(0) (AFTER DIR READ).
"RTN","WVBRPCD1",11,0)
 ;---> WVSUBH=CODE TO EXECUTE FOR SUBHEADER (COLUMN TITLES).
"RTN","WVBRPCD1",12,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (ALLOWS SELECTIONS TO EDIT).
"RTN","WVBRPCD1",13,0)
 ;---> WVTAB=6 IF OUTPUT IS TO SCREEN, =3 IF OUTPUT IS TO PRINTER.
"RTN","WVBRPCD1",14,0)
 ;---> WVPRMT(1,Q)=PROMPTS FOR DIR.
"RTN","WVBRPCD1",15,0)
 ;
"RTN","WVBRPCD1",16,0)
 U IO
"RTN","WVBRPCD1",17,0)
 S WVCONF=1,WVHEADER=WVHEADER_"^WVUTL7"
"RTN","WVBRPCD1",18,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVBRPCD1",19,0)
 S WVSUBH="SUBHEAD^WVBRPCD1"
"RTN","WVBRPCD1",20,0)
 S (WVPOP,N,Z)=0
"RTN","WVBRPCD1",21,0)
 D TOPHEAD^WVUTL7
"RTN","WVBRPCD1",22,0)
 S WVTAB=$S(WVCRT:5,1:3)
"RTN","WVBRPCD1",23,0)
 ;
"RTN","WVBRPCD1",24,0)
NOMATCH ;EP
"RTN","WVBRPCD1",25,0)
 ;---> QUIT IF NO RECORDS MATCH.
"RTN","WVBRPCD1",26,0)
 I '$D(^TMP("WV",$J,1)) D  Q
"RTN","WVBRPCD1",27,0)
 .D @(WVHEADER)
"RTN","WVBRPCD1",28,0)
 .K WVPRMT,WVPRMT1,WVPRMTQ,DIR
"RTN","WVBRPCD1",29,0)
 .W !!?5,"No records match the selected criteria.",!
"RTN","WVBRPCD1",30,0)
 .I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVBRPCD1",31,0)
 .D ^%ZISC S WVPOP=1
"RTN","WVBRPCD1",32,0)
 ;
"RTN","WVBRPCD1",33,0)
DISPLAY1 ;EP
"RTN","WVBRPCD1",34,0)
 ;---> IF A PROCEDURE IS EDITED ON THE LAST PAGE, GOTO HERE
"RTN","WVBRPCD1",35,0)
 ;---> FROM LINELABEL "END" BELOW.
"RTN","WVBRPCD1",36,0)
 D @(WVHEADER)
"RTN","WVBRPCD1",37,0)
 F  S N=$O(^TMP("WV",$J,2,N)) Q:'N!(WVPOP)  D
"RTN","WVBRPCD1",38,0)
 .I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVBRPCD1",39,0)
 ..S WVPAGE=WVPAGE+1
"RTN","WVBRPCD1",40,0)
 ..D @(WVHEADER) S Z=0
"RTN","WVBRPCD1",41,0)
 .S Y=^TMP("WV",$J,2,N),M=N
"RTN","WVBRPCD1",42,0)
 .W !
"RTN","WVBRPCD1",43,0)
 .;---> DON'T WRITE SSN# AND NAME IF IT MATCHES THE PREVIOUS RECORD.
"RTN","WVBRPCD1",44,0)
 .;---> DON'T WRITE BROWSE SELECTION#'S IF IO IS NOT A CRT (BRCRT).
"RTN","WVBRPCD1",45,0)
 .I $P(Y,U)'=Z D
"RTN","WVBRPCD1",46,0)
 ..W ! W:WVCRT $J(N,3),")"                  ;BROWSE SELECTION#
"RTN","WVBRPCD1",47,0)
 ..W ?WVTAB,$P(Y,U)                         ;SSN#
"RTN","WVBRPCD1",48,0)
 ..W ?WVTAB+10,$E($P(Y,U,2),1,16)," "       ;NAME
"RTN","WVBRPCD1",49,0)
 ..W $$REPEAT^XLFSTR(".",16-$L($P(Y,U,2)))  ;CONNECTING DOTS
"RTN","WVBRPCD1",50,0)
 ..W:'WVCRT "..."                           ;ADD DOTS IF NOT A CRT
"RTN","WVBRPCD1",51,0)
 .I $P(Y,U)=Z D                             ;IF NEW SSN#...
"RTN","WVBRPCD1",52,0)
 ..W:WVCRT $J(N,3),")"                      ;BROWSE SELECTION#
"RTN","WVBRPCD1",53,0)
 ..W ?WVTAB,". . . .   . . . . . . . . . ." ;CONNECTING DOTS
"RTN","WVBRPCD1",54,0)
 .S Z=$P(Y,U)                               ;STORE AS PREVIOUS SSN#
"RTN","WVBRPCD1",55,0)
 .;
"RTN","WVBRPCD1",56,0)
 .W ?34,$$SLDT2^WVUTL5($P(Y,U,3))           ;DATE OF PROCEDURE
"RTN","WVBRPCD1",57,0)
 .W ?44,$P(Y,U,4)                           ;ACCESSION#
"RTN","WVBRPCD1",58,0)
 .W ?57,$S($P(Y,U,7)="D":"*",1:" ")         ;STATUS (* IF DELINQ)
"RTN","WVBRPCD1",59,0)
 .W ?58,$P(Y,U,7)                           ;STATUS
"RTN","WVBRPCD1",60,0)
 .W ?62,$E($P(Y,U,5),1,14)_" ("_$P(Y,U,6)_")" ;RESULTS/DIAGNOSIS (PRIORITY)
"RTN","WVBRPCD1",61,0)
 ;
"RTN","WVBRPCD1",62,0)
END ;EP
"RTN","WVBRPCD1",63,0)
 ;---> IF A PROCEDURE HAS BEEN EDITED, SET N=N-5 AND START (GOTO)
"RTN","WVBRPCD1",64,0)
 ;---> DISPLAY1 OVER AGAIN FROM 5 RECORDS PREVIOUS.
"RTN","WVBRPCD1",65,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 I N S N=N-1 G NOMATCH
"RTN","WVBRPCD1",66,0)
 D ^%ZISC
"RTN","WVBRPCD1",67,0)
 K N,Z
"RTN","WVBRPCD1",68,0)
 Q
"RTN","WVBRPCD1",69,0)
 ;
"RTN","WVBRPCD1",70,0)
SUBHEAD ;EP
"RTN","WVBRPCD1",71,0)
 ;---> SUB HEADER FOR PROCEDURE BROWSE OUTPUT.
"RTN","WVBRPCD1",72,0)
 W !?WVTAB,$$PNLB^WVUTL5()
"RTN","WVBRPCD1",73,0)
 W ?WVTAB+12,"PATIENT",?34,"DATE",?44,"ACC#"
"RTN","WVBRPCD1",74,0)
 W ?57,"STA",?62,"RESULTS/DIAGNOSIS"
"RTN","WVBRPCD1",75,0)
 W !?62,"(PRIORITY)",!
"RTN","WVBRPCD1",76,0)
 W $$REPEAT^XLFSTR("-",80)
"RTN","WVBRPCD1",77,0)
 Q
"RTN","WVBRPCD1",78,0)
 ;
"RTN","WVBRPCD1",79,0)
EDIT ;EP
"RTN","WVBRPCD1",80,0)
 ;---> FROM BROWSE, WVPOP IN TO EDIT A SINGLE PROCEDURE.
"RTN","WVBRPCD1",81,0)
 D SETVARS^WVUTL5
"RTN","WVBRPCD1",82,0)
 S X=+X,DA=$P(^TMP("WV",$J,2,X),U,8)
"RTN","WVBRPCD1",83,0)
 S WVN=X N X
"RTN","WVBRPCD1",84,0)
 D EDIT2^WVPROC1(DA,.WVPOP)
"RTN","WVBRPCD1",85,0)
 ;---> BACK UP 5 RECORDS AFTER EDIT.
"RTN","WVBRPCD1",86,0)
 S N=$S(WVN<6:1,1:WVN-5),Z=0 K WVN
"RTN","WVBRPCD1",87,0)
 Q
"RTN","WVBRPCD2")
0^10^B18857754
"RTN","WVBRPCD2",1,0)
WVBRPCD2 ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE PROCEDURES;
"RTN","WVBRPCD2",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRPCD2",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRPCD2",4,0)
 ;;  PROMPTS FOR SELECTION CRITERIA IN BROWSING PROCEDURES.
"RTN","WVBRPCD2",5,0)
 ;;  CALLED BY WVBRPCD.
"RTN","WVBRPCD2",6,0)
 ;
"RTN","WVBRPCD2",7,0)
 D TITLE^WVUTL5("BROWSE PROCEDURES")
"RTN","WVBRPCD2",8,0)
 D ONEALL Q:WVPOP
"RTN","WVBRPCD2",9,0)
 D SELECT Q:WVPOP
"RTN","WVBRPCD2",10,0)
 D DATES  Q:WVPOP
"RTN","WVBRPCD2",11,0)
 D STATUS Q:WVPOP
"RTN","WVBRPCD2",12,0)
 D RESULT Q:WVPOP
"RTN","WVBRPCD2",13,0)
 D CMGR   Q:WVPOP
"RTN","WVBRPCD2",14,0)
 D ORDER  Q:WVPOP
"RTN","WVBRPCD2",15,0)
 D DEVICE Q:WVPOP
"RTN","WVBRPCD2",16,0)
 Q
"RTN","WVBRPCD2",17,0)
 ;
"RTN","WVBRPCD2",18,0)
ONEALL ;EP
"RTN","WVBRPCD2",19,0)
 ;---> SELECT ONE PATIENT OR ALL PATIENTS.
"RTN","WVBRPCD2",20,0)
 N DIR,DIRUT,Y
"RTN","WVBRPCD2",21,0)
 W !!?3,"Browse Procedures for ONE individual patient,"
"RTN","WVBRPCD2",22,0)
 W !?3,"or browse Procedures for ALL patients?"
"RTN","WVBRPCD2",23,0)
 S DIR("A")="   Select ONE or ALL: ",DIR("B")="ALL"
"RTN","WVBRPCD2",24,0)
 S DIR(0)="SAM^o:ONE;a:ALL" D HELP2^WVBRPCD3
"RTN","WVBRPCD2",25,0)
 D ^DIR
"RTN","WVBRPCD2",26,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRPCD2",27,0)
 ;---> IF ALL PATIENTS, S WVA=1 AND QUIT.
"RTN","WVBRPCD2",28,0)
 I Y="a" S WVA=1 Q
"RTN","WVBRPCD2",29,0)
 ;
"RTN","WVBRPCD2",30,0)
 W !!,"   Select the patient whose Procedures you wish to browse."
"RTN","WVBRPCD2",31,0)
 D PATLKUP^WVUTL8(.Y)
"RTN","WVBRPCD2",32,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVBRPCD2",33,0)
 ;---> FOR ONE PATIENT, SET WVA=0 AND WVDFN=PATIENT DFN, QUIT.
"RTN","WVBRPCD2",34,0)
 S WVDFN=+Y,WVA=0,WVCMGR=$P(^WV(790,WVDFN,0),U,10)
"RTN","WVBRPCD2",35,0)
 Q
"RTN","WVBRPCD2",36,0)
 ;
"RTN","WVBRPCD2",37,0)
SELECT ;EP
"RTN","WVBRPCD2",38,0)
 ;---> SELECT THE PROCEDURES TO BROWSE.
"RTN","WVBRPCD2",39,0)
 D SELECT^WVSELECT("Procedure Type",790.2,"WVARR","","PAP",.WVPOP)
"RTN","WVBRPCD2",40,0)
 Q
"RTN","WVBRPCD2",41,0)
 ;
"RTN","WVBRPCD2",42,0)
DATES ;EP
"RTN","WVBRPCD2",43,0)
 ;---> ASK DATE RANGE.  RETURN DATES IN WVBEGDT AND WVENDDT.
"RTN","WVBRPCD2",44,0)
 ;---> IF LOOKING AT ONLY ONE PATIENT, SET DEFAULT BEGIN DATE=T-365.
"RTN","WVBRPCD2",45,0)
 S WVBEGDF=$S(WVA:"T-30",1:"T-365")
"RTN","WVBRPCD2",46,0)
 D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP,WVBEGDF,"T")
"RTN","WVBRPCD2",47,0)
 Q
"RTN","WVBRPCD2",48,0)
 ;
"RTN","WVBRPCD2",49,0)
STATUS ;EP
"RTN","WVBRPCD2",50,0)
 ;---> GET XREF: OPEN OR ALL
"RTN","WVBRPCD2",51,0)
 N DIR,DIRUT,Y W !!?3
"RTN","WVBRPCD2",52,0)
 W "Do you wish to browse DELINQUENT, OPEN, or ALL Procedures?"
"RTN","WVBRPCD2",53,0)
 S DIR("A")="   Select DELINQUENT, OPEN or ALL: ",DIR("B")="OPEN"
"RTN","WVBRPCD2",54,0)
 S DIR(0)="SAM^d:DELINQUENT;o:OPEN;a:ALL" D HELP4^WVBRPCD3
"RTN","WVBRPCD2",55,0)
 D ^DIR
"RTN","WVBRPCD2",56,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRPCD2",57,0)
 S WVB=Y
"RTN","WVBRPCD2",58,0)
 Q
"RTN","WVBRPCD2",59,0)
 ;
"RTN","WVBRPCD2",60,0)
RESULT ;EP
"RTN","WVBRPCD2",61,0)
 ;---> GET XREF: ABNORMAL OR ALL
"RTN","WVBRPCD2",62,0)
 N DIR,DIRUT,Y
"RTN","WVBRPCD2",63,0)
 W !!?3,"Do you wish to browse only Procedures with ABNORMAL results, "
"RTN","WVBRPCD2",64,0)
 W !?3,"or both ABNORMAL and NORMAL?"
"RTN","WVBRPCD2",65,0)
 S DIR("A")="   Select ABNORMAL or BOTH: "
"RTN","WVBRPCD2",66,0)
 S DIR("B")="ABNORMAL ONLY" D HELP1^WVBRPCD3
"RTN","WVBRPCD2",67,0)
 S DIR(0)="SAM^a:ABNORMAL ONLY;b:BOTH ABNORMAL AND NORMAL"
"RTN","WVBRPCD2",68,0)
 D ^DIR
"RTN","WVBRPCD2",69,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRPCD2",70,0)
 S WVD=$S(Y="a":0,1:1)
"RTN","WVBRPCD2",71,0)
 Q
"RTN","WVBRPCD2",72,0)
 ;
"RTN","WVBRPCD2",73,0)
CMGR ;EP
"RTN","WVBRPCD2",74,0)
 ;---> SELECT CASES FOR ONE CASE MANAGER OR ALL.
"RTN","WVBRPCD2",75,0)
 ;---> DO NOT PROMPT FOR CASE MANAGER IF SITE PARAMETERS SAY NOT TO,
"RTN","WVBRPCD2",76,0)
 ;---> OR IF LOOKING AT PROCEDURES FOR ONLY ONE PATIENT.
"RTN","WVBRPCD2",77,0)
 N DIR,DIRUT,Y
"RTN","WVBRPCD2",78,0)
 I '$D(^WV(790.02,DUZ(2),0)) S WVE=1 Q
"RTN","WVBRPCD2",79,0)
 I '$P(^WV(790.02,DUZ(2),0),U,5)!('WVA) S WVE=1 Q
"RTN","WVBRPCD2",80,0)
 W !!?3,"Browse Procedures for ONE particular Case Manager,"
"RTN","WVBRPCD2",81,0)
 W !?3,"or browse Procedures for ALL Case Managers?"
"RTN","WVBRPCD2",82,0)
 S DIR("A")="   Select ONE or ALL: ",DIR("B")="ALL"
"RTN","WVBRPCD2",83,0)
 S DIR(0)="SAM^o:ONE;a:ALL" D HELP5^WVBRPCD3
"RTN","WVBRPCD2",84,0)
 D ^DIR
"RTN","WVBRPCD2",85,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRPCD2",86,0)
 ;---> IF ALL CASE MANAGERS, S WVE=1 AND QUIT.
"RTN","WVBRPCD2",87,0)
 I Y="a" S WVE=1 Q
"RTN","WVBRPCD2",88,0)
 N DIC
"RTN","WVBRPCD2",89,0)
 W !!,"   Select the Case Manager whose patients you wish to browse."
"RTN","WVBRPCD2",90,0)
 D DIC^WVFMAN(790.01,"QEMA",.Y,"   Select CASE MANAGER: ")
"RTN","WVBRPCD2",91,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVBRPCD2",92,0)
 ;---> FOR ONE CASE MANAGER, SET WVE=0 AND WVCMGR=^VA(200 DFN, QUIT.
"RTN","WVBRPCD2",93,0)
 S WVCMGR=+Y,WVE=0
"RTN","WVBRPCD2",94,0)
 Q
"RTN","WVBRPCD2",95,0)
 ;
"RTN","WVBRPCD2",96,0)
ORDER ;EP
"RTN","WVBRPCD2",97,0)
 ;---> ASK ORDER BY DATE OR BY PATIENT OR BY PRIORITY.
"RTN","WVBRPCD2",98,0)
 ;---> IF LOOKING AT ONLY ONE PATIENT, ORDER BY DATE AND QUIT.
"RTN","WVBRPCD2",99,0)
 I 'WVA S WVC=1 D TITLE Q
"RTN","WVBRPCD2",100,0)
 ;
"RTN","WVBRPCD2",101,0)
 ;---> SORT SEQUENCE IN WVC:  1=DATE, PATIENT, PRIORITY
"RTN","WVBRPCD2",102,0)
 ;--->                        2=PATIENT, DATE, PRIORITY
"RTN","WVBRPCD2",103,0)
 ;--->                        3=PRIORITY, DATE, PATIENT
"RTN","WVBRPCD2",104,0)
 ;
"RTN","WVBRPCD2",105,0)
 N DIR,DIRUT,Y
"RTN","WVBRPCD2",106,0)
 W !!?3,"Display Procedures in order of:"
"RTN","WVBRPCD2",107,0)
 W ?37,"1) DATE OF PROCEDURE (earliest first)"
"RTN","WVBRPCD2",108,0)
 W !?37,"2) NAME OF PATIENT (alphabetically)"
"RTN","WVBRPCD2",109,0)
 W !?37,"3) PRIORITY (most urgent being highest)"
"RTN","WVBRPCD2",110,0)
 S DIR("A")="   Select 1, 2, or 3: ",DIR("B")=1
"RTN","WVBRPCD2",111,0)
 S DIR(0)="SAM^1:DATE;2:NAME;3:PRIORITY" D HELP3^WVBRPCD3
"RTN","WVBRPCD2",112,0)
 D ^DIR
"RTN","WVBRPCD2",113,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVBRPCD2",114,0)
 S WVC=Y D TITLE
"RTN","WVBRPCD2",115,0)
 Q
"RTN","WVBRPCD2",116,0)
 ;
"RTN","WVBRPCD2",117,0)
TITLE ;EP
"RTN","WVBRPCD2",118,0)
 ;---> SET TITLE OF REPORT BASED ON ORDER SELECTED ABOVE.
"RTN","WVBRPCD2",119,0)
 N Y S Y=$S(WVC=1:"DATE",WVC=2:"PATIENT",WVC=3:"DIAGNOSIS",1:"?")
"RTN","WVBRPCD2",120,0)
 S WVTITLE="* * *  PROCEDURES LISTED BY "_Y_"  * * *"
"RTN","WVBRPCD2",121,0)
 S WVCODE="D EDIT^WVBRPCD1,SORT^WVBRPCD,COPYGBL^WVBRPCD"
"RTN","WVBRPCD2",122,0)
 S WVHEADER="HEADER1"
"RTN","WVBRPCD2",123,0)
 Q
"RTN","WVBRPCD2",124,0)
 ;
"RTN","WVBRPCD2",125,0)
DEVICE ;EP
"RTN","WVBRPCD2",126,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVBRPCD2",127,0)
 S ZTRTN="DEQUEUE^WVBRPCD"
"RTN","WVBRPCD2",128,0)
 F WVSV="A","B","C","CODE","D","E","CMGR" D
"RTN","WVBRPCD2",129,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVBRPCD2",130,0)
 F WVSV="DFN","BEGDT","ENDDT","HEADER","TITLE" D
"RTN","WVBRPCD2",131,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVBRPCD2",132,0)
 ;---> SAVE THE SELECTED PROCEDURES ARRAY.
"RTN","WVBRPCD2",133,0)
 I $D(WVARR) N N S N=0 F  S N=$O(WVARR(N)) Q:N=""  D
"RTN","WVBRPCD2",134,0)
 .S ZTSAVE("WVARR("""_N_""")")=""
"RTN","WVBRPCD2",135,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVBRPCD2",136,0)
 Q
"RTN","WVBRPCD3")
0^11^B10799734
"RTN","WVBRPCD3",1,0)
WVBRPCD3 ;HCIOFO/FT,JR IHS/ANMC/MWR - BROWSE PROCEDURES; ;8/10/98  16:12
"RTN","WVBRPCD3",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVBRPCD3",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVBRPCD3",4,0)
 ;;  HELP PROMPTS FOR BROWSING PROCEDURES.  CALLED BY BRBRPCD.
"RTN","WVBRPCD3",5,0)
 ;
"RTN","WVBRPCD3",6,0)
HELP1 ;EP
"RTN","WVBRPCD3",7,0)
 ;;Procedures with a result of "ABNORMAL" require further follow-up
"RTN","WVBRPCD3",8,0)
 ;;and diagnosis.  Procedures with a result of "NORMAL" require a
"RTN","WVBRPCD3",9,0)
 ;;letter of notification to be sent to the patient.
"RTN","WVBRPCD3",10,0)
 ;;
"RTN","WVBRPCD3",11,0)
 ;;Enter "A" to see only Procedures with ABNORMAL results.
"RTN","WVBRPCD3",12,0)
 ;;   (Selecting ABNORMAL will include procedures with a result of
"RTN","WVBRPCD3",13,0)
 ;;    INSUFFICIENT TISSUE and procedures with no result entered yet.)
"RTN","WVBRPCD3",14,0)
 ;;
"RTN","WVBRPCD3",15,0)
 ;;Enter "B" to see BOTH ABNORMAL and NORMAL results.
"RTN","WVBRPCD3",16,0)
 ;;  (Selecting NORMAL will include procedures with a result of
"RTN","WVBRPCD3",17,0)
 ;;   ERROR/DISREGARD.)
"RTN","WVBRPCD3",18,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVBRPCD3",19,0)
 Q
"RTN","WVBRPCD3",20,0)
 ;
"RTN","WVBRPCD3",21,0)
HELP2 ;EP
"RTN","WVBRPCD3",22,0)
 ;;Answer "ONE" to browse Procedures for ONE particular patient.
"RTN","WVBRPCD3",23,0)
 ;;Answer "ALL" to browse Procedures for ALL patients.
"RTN","WVBRPCD3",24,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVBRPCD3",25,0)
 Q
"RTN","WVBRPCD3",26,0)
 ;
"RTN","WVBRPCD3",27,0)
HELP3 ;EP
"RTN","WVBRPCD3",28,0)
 ;;Enter "DATE" to list Procedures in chronological order beginning
"RTN","WVBRPCD3",29,0)
 ;;   with the oldest first.
"RTN","WVBRPCD3",30,0)
 ;;Enter "NAME" to list Procedures by Patient Name in alphabetical
"RTN","WVBRPCD3",31,0)
 ;;   order.
"RTN","WVBRPCD3",32,0)
 ;;Enter "PRIORITY" to list Procedures by degree of urgency of the 
"RTN","WVBRPCD3",33,0)
 ;;   Result/Diagnosis, beginning with the most urgent first.
"RTN","WVBRPCD3",34,0)
 S WVTAB=5,WVLINL="HELP3" D HELPTX
"RTN","WVBRPCD3",35,0)
 Q
"RTN","WVBRPCD3",36,0)
 ;
"RTN","WVBRPCD3",37,0)
HELP4 ;EP
"RTN","WVBRPCD3",38,0)
 ;;"DELINQUENT Procedures" are OPEN Procedures that have remained
"RTN","WVBRPCD3",39,0)
 ;;     open past the date they were due to be closed (as determined by
"RTN","WVBRPCD3",40,0)
 ;;     the "COMPLETE BY (DATE)" field in the Edit Procedure screen).
"RTN","WVBRPCD3",41,0)
 ;;
"RTN","WVBRPCD3",42,0)
 ;;"OPEN Procedures" are any Procedures that have not yet been closed.
"RTN","WVBRPCD3",43,0)
 ;;     (DELINQUENT and NEW Procedures will be included.)
"RTN","WVBRPCD3",44,0)
 ;;
"RTN","WVBRPCD3",45,0)
 ;;"ALL Procedures" includes DELINQUENT, NEW, OPEN and CLOSED.
"RTN","WVBRPCD3",46,0)
 ;;     CLOSED Procedures are ones that have been brought to closure;
"RTN","WVBRPCD3",47,0)
 ;;     in other words, a final diagnosis has been entered, the
"RTN","WVBRPCD3",48,0)
 ;;     procedure has been completed, and the patient has been notified.
"RTN","WVBRPCD3",49,0)
 S WVTAB=5,WVLINL="HELP4" D HELPTX
"RTN","WVBRPCD3",50,0)
 Q
"RTN","WVBRPCD3",51,0)
 ;
"RTN","WVBRPCD3",52,0)
HELP5 ;EP
"RTN","WVBRPCD3",53,0)
 ;;Answer "ONE" to browse Procedures for ONE particular Case Manager.
"RTN","WVBRPCD3",54,0)
 ;;Answer "ALL" to browse Procedures for ALL Case Managers.
"RTN","WVBRPCD3",55,0)
 S WVTAB=5,WVLINL="HELP5" D HELPTX
"RTN","WVBRPCD3",56,0)
 Q
"RTN","WVBRPCD3",57,0)
 ;
"RTN","WVBRPCD3",58,0)
HELPTX ;EP
"RTN","WVBRPCD3",59,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVBRPCD3",60,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVBRPCD3",61,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVBRPCD3",62,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVBRPCD3",63,0)
 Q
"RTN","WVCMGR")
0^12^B11962075
"RTN","WVCMGR",1,0)
WVCMGR ;HCIOFO/FT,JR IHS/ANMC/MWR - ADD/EDIT CASE MANAGER; ;8/10/98  15:08
"RTN","WVCMGR",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVCMGR",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVCMGR",4,0)
 ;;  CALLED BY OPTION: "WV ADD/EDIT CASE MANAGERS" TO ADD AND EDIT
"RTN","WVCMGR",5,0)
 ;;  CASE MANAGERS.
"RTN","WVCMGR",6,0)
 ;
"RTN","WVCMGR",7,0)
 ;---> DIE ADD/EDIT CASE MANAGERS LOOP.
"RTN","WVCMGR",8,0)
 D SETVARS^WVUTL5
"RTN","WVCMGR",9,0)
 N Y
"RTN","WVCMGR",10,0)
 F  D  Q:$G(Y)<0
"RTN","WVCMGR",11,0)
 .D TITLE^WVUTL5("ADD/EDIT CASE MANAGERS")
"RTN","WVCMGR",12,0)
 .S WVDICW="S WVY=Y N Y S Y=$P($G(^WV(790.01,+WVY,0)),U,2) D DD^%DT W:$L(Y)>10 ?32,""DATE INACTIVATED:  "",Y"
"RTN","WVCMGR",13,0)
 .D DIC^WVFMAN(790.01,"QEMAL",.Y,"   Select CASE MANAGER: ","","","","",WVDICW)
"RTN","WVCMGR",14,0)
 .K WVDICW Q:Y<0
"RTN","WVCMGR",15,0)
 .D DIE^WVFMAN(790.01,.02,+Y,.WVPOP)
"RTN","WVCMGR",16,0)
 .S:WVPOP Y=-1
"RTN","WVCMGR",17,0)
 ;
"RTN","WVCMGR",18,0)
EXIT ;EP
"RTN","WVCMGR",19,0)
 D KILLALL^WVUTL8
"RTN","WVCMGR",20,0)
 Q
"RTN","WVCMGR",21,0)
 ;
"RTN","WVCMGR",22,0)
TRANS ;EP
"RTN","WVCMGR",23,0)
 ;---> TRANSFER ONE CASE MANAGER'S PATIENTS TO ANOTHER CASE MANAGER.
"RTN","WVCMGR",24,0)
 ;
"RTN","WVCMGR",25,0)
 D TRANS1
"RTN","WVCMGR",26,0)
 D EXIT
"RTN","WVCMGR",27,0)
 Q
"RTN","WVCMGR",28,0)
 ;
"RTN","WVCMGR",29,0)
TRANS1 ;EP
"RTN","WVCMGR",30,0)
 D TITLE^WVUTL5("TRANSFER A CASE MANAGER'S PATIENTS")
"RTN","WVCMGR",31,0)
 D TEXT1 S WVJOPEN=1
"RTN","WVCMGR",32,0)
 S WVDICW="S WVY=Y N Y S Y=$P($G(^WV(790.01,+WVY,0)),U,2) D DD^%DT W:$L(Y)>10 ?32,""DATE INACTIVATED:  "",Y"
"RTN","WVCMGR",33,0)
 D DIC^WVFMAN(790.01,"QEMA",.Y,"   Select OLD CASE MANAGER: ","","","","",WVDICW)
"RTN","WVCMGR",34,0)
 K WVJOPEN,WVDICW
"RTN","WVCMGR",35,0)
 Q:Y<0
"RTN","WVCMGR",36,0)
 S WVCMGR=+Y
"RTN","WVCMGR",37,0)
 S WVDICW="S WVY=Y N Y S Y=$P($G(^WV(790.01,+WVY,0)),U,2) D DD^%DT W:$L(Y)>10 ?32,""DATE INACTIVATED:  "",Y"
"RTN","WVCMGR",38,0)
 D DIC^WVFMAN(790.01,"QEMA",.Y,"   Select NEW CASE MANAGER: ","","","","",WVDICW)
"RTN","WVCMGR",39,0)
 K WVDICW Q:Y<0
"RTN","WVCMGR",40,0)
 S WVCMGR1=+Y
"RTN","WVCMGR",41,0)
 W !!?3,"All patients currently assigned to: ",$$PERSON^WVUTL1(WVCMGR)
"RTN","WVCMGR",42,0)
 W !?3,"will be reassigned to.............: ",$$PERSON^WVUTL1(WVCMGR1)
"RTN","WVCMGR",43,0)
 ;
"RTN","WVCMGR",44,0)
 ;---> YES/NO
"RTN","WVCMGR",45,0)
 W !!?3,"Do you wish to proceed?"
"RTN","WVCMGR",46,0)
 S DIR("?")="     Enter YES to swap Case Managers."
"RTN","WVCMGR",47,0)
 S DIR(0)="Y",DIR("A")="   Enter Yes or No"
"RTN","WVCMGR",48,0)
 D ^DIR W !
"RTN","WVCMGR",49,0)
 Q:$D(DIRUT)!('Y)
"RTN","WVCMGR",50,0)
 N M,N
"RTN","WVCMGR",51,0)
 S N=0,M=0
"RTN","WVCMGR",52,0)
 F  S N=$O(^WV(790,"C",WVCMGR,N)) Q:'N  D
"RTN","WVCMGR",53,0)
 .D DIE^WVFMAN(790,".1////"_WVCMGR1,N,.WVPOP)
"RTN","WVCMGR",54,0)
 .Q:WVPOP  S M=M+1
"RTN","WVCMGR",55,0)
 W !?3,M," patients transferred from ",$$PERSON^WVUTL1(WVCMGR)
"RTN","WVCMGR",56,0)
 W " to ",$$PERSON^WVUTL1(WVCMGR1),"."  D DIRZ^WVUTL3
"RTN","WVCMGR",57,0)
 Q
"RTN","WVCMGR",58,0)
 ;
"RTN","WVCMGR",59,0)
TEXT1 ;EP
"RTN","WVCMGR",60,0)
 ;;The purpose of this utility is to aid in the transfer of all of one
"RTN","WVCMGR",61,0)
 ;;Case Manager's patients to another Case Manager, such as when there
"RTN","WVCMGR",62,0)
 ;;is a turnover in staff.  The program will ask you for an "OLD" Case
"RTN","WVCMGR",63,0)
 ;;Manager and then for a "NEW" Case Manager.  All patients who were
"RTN","WVCMGR",64,0)
 ;;previously assigned to the "OLD" Case Manager will be reassigned to
"RTN","WVCMGR",65,0)
 ;;the "NEW" Case Manager.
"RTN","WVCMGR",66,0)
 ;;
"RTN","WVCMGR",67,0)
 ;;If the "NEW" Case Manager you are looking for cannot be selected,
"RTN","WVCMGR",68,0)
 ;;that person must first be added to the file of Case Managers by
"RTN","WVCMGR",69,0)
 ;;using the "Add/Edit Case Managers" option.
"RTN","WVCMGR",70,0)
 ;;
"RTN","WVCMGR",71,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVCMGR",72,0)
 Q
"RTN","WVCMGR",73,0)
 ;
"RTN","WVCMGR",74,0)
PRINTX ;EP
"RTN","WVCMGR",75,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVCMGR",76,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVCMGR",77,0)
 Q
"RTN","WVDIAG")
0^13^B26508465
"RTN","WVDIAG",1,0)
WVDIAG ;HCIOFO/FT,JR IHS/ANMC/MWR - PRINTOUT OF WV DIAGNOSIS FILE; ;8/10/98  14:56
"RTN","WVDIAG",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVDIAG",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVDIAG",4,0)
 ;;  CALLED BY OPTION: "WV PRINT RES/DIAG FILE" TO PRINT THE
"RTN","WVDIAG",5,0)
 ;;  RESULTS/DIAGNOSIS TABLE FILE.
"RTN","WVDIAG",6,0)
 ;
"RTN","WVDIAG",7,0)
 D SETUP
"RTN","WVDIAG",8,0)
 D TITLE^WVUTL5("LISTING OF RESULTS/DIAGNOSIS FILE")
"RTN","WVDIAG",9,0)
 D DEVICE I WVPOP D EXIT Q
"RTN","WVDIAG",10,0)
 D SORT
"RTN","WVDIAG",11,0)
 D DISPLAY
"RTN","WVDIAG",12,0)
 ;
"RTN","WVDIAG",13,0)
EXIT ;EP
"RTN","WVDIAG",14,0)
 D KILLALL^WVUTL8
"RTN","WVDIAG",15,0)
 Q
"RTN","WVDIAG",16,0)
 ;
"RTN","WVDIAG",17,0)
SETUP ;EP
"RTN","WVDIAG",18,0)
 D SETVARS^WVUTL5 S WVPOP=0
"RTN","WVDIAG",19,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVDIAG",20,0)
 Q
"RTN","WVDIAG",21,0)
 ;
"RTN","WVDIAG",22,0)
DEVICE ;EP
"RTN","WVDIAG",23,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVDIAG",24,0)
 S ZTRTN="DEQUEUE^WVDIAG"
"RTN","WVDIAG",25,0)
 F WVSV="WVLINE","WVTITLE" D
"RTN","WVDIAG",26,0)
 .I $D(WVSV) S ZTSAVE(WVSV)=""
"RTN","WVDIAG",27,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVDIAG",28,0)
 Q
"RTN","WVDIAG",29,0)
 ;
"RTN","WVDIAG",30,0)
SORT ;EP
"RTN","WVDIAG",31,0)
 ;---> SORT BY RESULT/DIAGNOSIS.  STORED IN ^TMP("WV",$J,1
"RTN","WVDIAG",32,0)
 N N,X,Y K ^TMP("WV",$J)
"RTN","WVDIAG",33,0)
 S N=0
"RTN","WVDIAG",34,0)
 F  S N=$O(^WV(790.31,"B",N)) Q:N=""  D
"RTN","WVDIAG",35,0)
 .S M=$O(^WV(790.31,"B",N,0))
"RTN","WVDIAG",36,0)
 .S Y=^WV(790.31,M,0),WVDIAG=N
"RTN","WVDIAG",37,0)
 .F I=3:1:19 I $P(Y,U,I) D
"RTN","WVDIAG",38,0)
 ..S WVPN=$E($P(^WV(790.2,$P(Y,U,I),0),U),1,30)
"RTN","WVDIAG",39,0)
 ..S X=$P(Y,U,21),WVNORM=$S(X=0:"NORMAL",X=2:"NO RES",1:"ABNORM")
"RTN","WVDIAG",40,0)
 ..S WVPRIO=$P(Y,U,2)
"RTN","WVDIAG",41,0)
 ..S X=WVDIAG_U_WVPRIO_U_WVNORM_U_WVPN
"RTN","WVDIAG",42,0)
 ..S ^TMP("WV",$J,1,WVDIAG,WVPN,1)=X
"RTN","WVDIAG",43,0)
 .I $P(Y,U,20) D
"RTN","WVDIAG",44,0)
 ..S X=$P(Y,U,21),WVNORM=$S(X=0:"NORMAL",X=2:"NO RES",1:"ABNORM")
"RTN","WVDIAG",45,0)
 ..S WVPRIO=$P(Y,U,2),WVPN="ALL PROCEDURES"
"RTN","WVDIAG",46,0)
 ..S X=WVDIAG_U_WVPRIO_U_WVNORM_U_WVPN
"RTN","WVDIAG",47,0)
 ..S ^TMP("WV",$J,1,WVDIAG,WVPN,1)=X
"RTN","WVDIAG",48,0)
 ;
"RTN","WVDIAG",49,0)
 ;---> SORT BY PROCEDURE TYPE.  STORED IN ^TMP("WV",$J,2
"RTN","WVDIAG",50,0)
 S N=0
"RTN","WVDIAG",51,0)
 F  S N=$O(^WV(790.31,"P",N)) Q:N=""  D
"RTN","WVDIAG",52,0)
 .S M=0
"RTN","WVDIAG",53,0)
 .F  S M=$O(^WV(790.31,"P",N,M)) Q:M=""  D
"RTN","WVDIAG",54,0)
 ..S Y=^WV(790.31,M,0)
"RTN","WVDIAG",55,0)
 ..S WVPN=$P(^WV(790.2,N,0),U),WVDIAG=$P(Y,U)
"RTN","WVDIAG",56,0)
 ..S X=$P(Y,U,21),WVNORM=$S(X=0:"NORMAL",X=2:"NO RES",1:"ABNORM")
"RTN","WVDIAG",57,0)
 ..S WVPRIO=$P(Y,U,2)
"RTN","WVDIAG",58,0)
 ..S X=WVPN_U_WVDIAG_U_WVPRIO_U_WVNORM
"RTN","WVDIAG",59,0)
 ..S ^TMP("WV",$J,2,WVPN,WVPRIO,WVDIAG)=X
"RTN","WVDIAG",60,0)
 ;
"RTN","WVDIAG",61,0)
 ;---> ASSOCIATED WITH ALL PROCEDURES
"RTN","WVDIAG",62,0)
 S N=0
"RTN","WVDIAG",63,0)
 F  S N=$O(^WV(790.31,N)) Q:'N  D
"RTN","WVDIAG",64,0)
 .S Y=^WV(790.31,N,0)
"RTN","WVDIAG",65,0)
 .Q:'$P(Y,U,20)
"RTN","WVDIAG",66,0)
 .S WVDIAG=$P(Y,U),WVPRIO=$P(Y,U,2)
"RTN","WVDIAG",67,0)
 .S X=$P(Y,U,21),WVNORM=$S(X=0:"NORMAL",X=2:"NO RES",1:"ABNORM")
"RTN","WVDIAG",68,0)
 .S M=0
"RTN","WVDIAG",69,0)
 .F  S M=$O(^WV(790.2,M)) Q:'M  D
"RTN","WVDIAG",70,0)
 ..S WVPN=$P(^WV(790.2,M,0),U)
"RTN","WVDIAG",71,0)
 ..Q:$P(^WV(790.2,M,0),U,12)
"RTN","WVDIAG",72,0)
 ..S X=WVPN_U_WVDIAG_U_WVPRIO_U_WVNORM
"RTN","WVDIAG",73,0)
 ..S ^TMP("WV",$J,2,WVPN,WVPRIO,WVDIAG)=X
"RTN","WVDIAG",74,0)
 ;
"RTN","WVDIAG",75,0)
 ;---> SORT BY PRIORITY.  STORED IN ^TMP("WV",$J,3
"RTN","WVDIAG",76,0)
 S N=0
"RTN","WVDIAG",77,0)
 F  S N=$O(^WV(790.31,"B",N)) Q:N=""  D
"RTN","WVDIAG",78,0)
 .S M=$O(^WV(790.31,"B",N,0))
"RTN","WVDIAG",79,0)
 .S Y=^WV(790.31,M,0),WVDIAG=N,WVPRIO=$P(Y,U,2)
"RTN","WVDIAG",80,0)
 .S X=$P(Y,U,21),WVNORM=$S(X=0:"NORMAL",X=2:"NO RES",1:"ABNORM")
"RTN","WVDIAG",81,0)
 .S X=WVDIAG_U_WVPRIO_U_WVNORM
"RTN","WVDIAG",82,0)
 .S ^TMP("WV",$J,3,WVPRIO,WVDIAG,1)=X
"RTN","WVDIAG",83,0)
 ;
"RTN","WVDIAG",84,0)
 ;---> COPY TO TMP IN A SINGLE SUBSCRIPT.
"RTN","WVDIAG",85,0)
 F WVS=1,2,3 S WVSS=WVS_WVS D COPYGBL
"RTN","WVDIAG",86,0)
 Q
"RTN","WVDIAG",87,0)
 ;
"RTN","WVDIAG",88,0)
DISPLAY ;EP
"RTN","WVDIAG",89,0)
 U IO
"RTN","WVDIAG",90,0)
 S WVTITLE1="*  WOMEN'S HEALTH: LISTING OF RESULTS/DIAGNOSIS FILE  *"
"RTN","WVDIAG",91,0)
 D CENTERT^WVUTL5(.WVTITLE1)
"RTN","WVDIAG",92,0)
 S WVCRT=$S($E(IOST)="C":1,1:0),(WVPAGE,WVPOP)=0
"RTN","WVDIAG",93,0)
 F WVI=22,33,11 D @("DISPLY"_WVI) Q:WVPOP
"RTN","WVDIAG",94,0)
 D ^%ZISC
"RTN","WVDIAG",95,0)
 Q
"RTN","WVDIAG",96,0)
 ;
"RTN","WVDIAG",97,0)
DISPLY11 ;EP
"RTN","WVDIAG",98,0)
 ;---> LIST BY RESULT/DIAGNOSIS
"RTN","WVDIAG",99,0)
 ;Q
"RTN","WVDIAG",100,0)
 S WVTITLE2=" * BY DIAGNOSIS *" D CENTERT^WVUTL5(.WVTITLE2)
"RTN","WVDIAG",101,0)
 S WVSUB="W !?3,""RESULT/DIAGNOSIS"",?31,""PRIORITY"",?42,""NORMAL"","
"RTN","WVDIAG",102,0)
 S WVSUB=WVSUB_"?50,""ASSOCIATED PROCEDURES"""
"RTN","WVDIAG",103,0)
 N Z S (WVPOP,N,Z)=0
"RTN","WVDIAG",104,0)
 W:WVCRT @IOF D HEADER
"RTN","WVDIAG",105,0)
 F  S N=$O(^TMP("WV",$J,WVI,N)) Q:'N!(WVPOP)  D
"RTN","WVDIAG",106,0)
 .I $Y+8>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER
"RTN","WVDIAG",107,0)
 .S Y=^TMP("WV",$J,WVI,N) W !
"RTN","WVDIAG",108,0)
 .I $P(Y,U)'=Z W !?3,$P(Y,U),?37,$J($P(Y,U,2),2),?42,$P(Y,U,3)
"RTN","WVDIAG",109,0)
 .W ?50,$P(Y,U,4)
"RTN","WVDIAG",110,0)
 .S Z=$P(Y,U)
"RTN","WVDIAG",111,0)
 I WVCRT&('WVPOP) W !! D DIRZ^WVUTL3
"RTN","WVDIAG",112,0)
 Q
"RTN","WVDIAG",113,0)
 ;
"RTN","WVDIAG",114,0)
DISPLY22 ;EP
"RTN","WVDIAG",115,0)
 ;---> LIST BY RESULT/DIAGNOSIS
"RTN","WVDIAG",116,0)
 S WVTITLE2=" * BY PROCEDURE *" D CENTERT^WVUTL5(.WVTITLE2)
"RTN","WVDIAG",117,0)
 S WVSUB="W !?3,""PROCEDURE"",?35,""RESULT/DIAGNOSIS"""
"RTN","WVDIAG",118,0)
 S WVSUB=WVSUB_",?62,""PRIORITY"",?72,""NORMAL"""
"RTN","WVDIAG",119,0)
 N Z S (WVPOP,N,Z)=0
"RTN","WVDIAG",120,0)
 W:WVCRT @IOF D HEADER
"RTN","WVDIAG",121,0)
 F  S N=$O(^TMP("WV",$J,WVI,N)) Q:'N!(WVPOP)  D
"RTN","WVDIAG",122,0)
 .I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER
"RTN","WVDIAG",123,0)
 .S Y=^TMP("WV",$J,WVI,N) W !
"RTN","WVDIAG",124,0)
 .I $P(Y,U)'=Z W !?3,$P(Y,U)
"RTN","WVDIAG",125,0)
 .W ?35,$P(Y,U,2),?68,$J($P(Y,U,3),2),?72,$P(Y,U,4)
"RTN","WVDIAG",126,0)
 .S Z=$P(Y,U)
"RTN","WVDIAG",127,0)
 I WVCRT&('WVPOP) W !! D DIRZ^WVUTL3
"RTN","WVDIAG",128,0)
 Q
"RTN","WVDIAG",129,0)
 ;
"RTN","WVDIAG",130,0)
DISPLY33 ;EP
"RTN","WVDIAG",131,0)
 ;---> LIST BY RESULT/DIAGNOSIS
"RTN","WVDIAG",132,0)
 S WVTITLE2=" * BY PRIORITY *" D CENTERT^WVUTL5(.WVTITLE2)
"RTN","WVDIAG",133,0)
 S WVSUB="W !?3,""RESULT/DIAGNOSIS"",?32,""PRIORITY"",?44,""NORMAL"""
"RTN","WVDIAG",134,0)
 N Z S (WVPOP,N,Z)=0
"RTN","WVDIAG",135,0)
 W:WVCRT @IOF D HEADER
"RTN","WVDIAG",136,0)
 F  S N=$O(^TMP("WV",$J,WVI,N)) Q:'N!(WVPOP)  D
"RTN","WVDIAG",137,0)
 .I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER
"RTN","WVDIAG",138,0)
 .S Y=^TMP("WV",$J,WVI,N)
"RTN","WVDIAG",139,0)
 .W !?3,$P(Y,U),?37,$J($P(Y,U,2),2),?44,$P(Y,U,3)
"RTN","WVDIAG",140,0)
 .S Z=$P(Y,U)
"RTN","WVDIAG",141,0)
 I WVCRT&('WVPOP) W !! D DIRZ^WVUTL3
"RTN","WVDIAG",142,0)
 Q
"RTN","WVDIAG",143,0)
 ;
"RTN","WVDIAG",144,0)
 ;
"RTN","WVDIAG",145,0)
HEADER ;EP
"RTN","WVDIAG",146,0)
 W:WVPAGE @IOF S WVPAGE=WVPAGE+1,Z=0
"RTN","WVDIAG",147,0)
 W WVTITLE1,?70,"PAGE ",WVPAGE,!,WVTITLE2
"RTN","WVDIAG",148,0)
 W !,$$RUNDT^WVUTL1A("C")
"RTN","WVDIAG",149,0)
 W !,WVLINE X WVSUB W !,WVLINE
"RTN","WVDIAG",150,0)
 Q
"RTN","WVDIAG",151,0)
 ;
"RTN","WVDIAG",152,0)
COPYGBL ;EP
"RTN","WVDIAG",153,0)
 ;---> COPY ^TMP("WV",$J,WVS TO ^TMP("WV",$J,WVSS TO MAKE IT FLAT.
"RTN","WVDIAG",154,0)
 N I,M,N,P,Q
"RTN","WVDIAG",155,0)
 S N=0,I=0
"RTN","WVDIAG",156,0)
 F  S N=$O(^TMP("WV",$J,WVS,N)) Q:N=""  D
"RTN","WVDIAG",157,0)
 .S M=0
"RTN","WVDIAG",158,0)
 .F  S M=$O(^TMP("WV",$J,WVS,N,M)) Q:M=""  D
"RTN","WVDIAG",159,0)
 ..S P=0
"RTN","WVDIAG",160,0)
 ..F  S P=$O(^TMP("WV",$J,WVS,N,M,P)) Q:P=""  D
"RTN","WVDIAG",161,0)
 ...S I=I+1,^TMP("WV",$J,WVSS,I)=^TMP("WV",$J,WVS,N,M,P)
"RTN","WVDIAG",162,0)
 Q
"RTN","WVDIAG",163,0)
 ;
"RTN","WVDIAG",164,0)
DEQUEUE ;EP
"RTN","WVDIAG",165,0)
 ;---> CALLED BY TASKMAN
"RTN","WVDIAG",166,0)
 D SETVARS^WVUTL5,SORT,DISPLAY,EXIT
"RTN","WVDIAG",167,0)
 Q
"RTN","WVDIAGS")
0^14^B4731594
"RTN","WVDIAGS",1,0)
WVDIAGS ;HCIOFO/FT,JR IHS/ANMC/MWR - RES/DIAG SYNONYM ADD/EDIT/PRINT ;8/3/98  16:26
"RTN","WVDIAGS",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVDIAGS",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVDIAGS",4,0)
 ;;  ADD/EDIT/PRINT/PURGE SYNONYMS FOR WV RESULTS/DIAGNOSIS FILE.
"RTN","WVDIAGS",5,0)
 ;;
"RTN","WVDIAGS",6,0)
 ;
"RTN","WVDIAGS",7,0)
EDITSYN ;EP
"RTN","WVDIAGS",8,0)
 ;---> EDIT SYNONYMS FOR RESULTS/DIAGNOSIS.
"RTN","WVDIAGS",9,0)
 ;---> CALLED BY OPTION "WV EDIT RES/DIAG SYNONYMS".
"RTN","WVDIAGS",10,0)
 D SETVARS^WVUTL5
"RTN","WVDIAGS",11,0)
 F  D  Q:$G(Y)<0
"RTN","WVDIAGS",12,0)
 .D TITLE^WVUTL5("EDIT SYNONYMS FOR RESULTS/DIAGNOSIS FILE")
"RTN","WVDIAGS",13,0)
 .D TEXT1
"RTN","WVDIAGS",14,0)
 .D DIC^WVFMAN(790.31,"QEMA",.Y,"   Select RESULT/DIAGNOSIS: ")
"RTN","WVDIAGS",15,0)
 .Q:Y<0
"RTN","WVDIAGS",16,0)
 .D DIE^WVFMAN(790.31,".3;.31",+Y,1,.WVPOP)
"RTN","WVDIAGS",17,0)
 .S:WVPOP Y=-1
"RTN","WVDIAGS",18,0)
 W @IOF
"RTN","WVDIAGS",19,0)
 D KILLALL^WVUTL8
"RTN","WVDIAGS",20,0)
 Q
"RTN","WVDIAGS",21,0)
 ;
"RTN","WVDIAGS",22,0)
PRINTSYN ;EP
"RTN","WVDIAGS",23,0)
 ;---> CALLED BY OPTION "WV PRINT RES/DIAG SYNONYMS".
"RTN","WVDIAGS",24,0)
 D SETVARS^WVUTL5
"RTN","WVDIAGS",25,0)
 S DIC="^WV(790.31,"
"RTN","WVDIAGS",26,0)
 S FLDS="[WV PRINT RES/DIAG SYNONYMS]"
"RTN","WVDIAGS",27,0)
 S BY=.01,(FR,TO)=""
"RTN","WVDIAGS",28,0)
 K IO("Q") S %ZIS="Q" D ^%ZIS I POP D EXIT Q
"RTN","WVDIAGS",29,0)
 S IOP=ION I $D(IO("Q")) S IOP="Q;"_ION
"RTN","WVDIAGS",30,0)
 K IO("Q") S WVIOST=$E(IOST)
"RTN","WVDIAGS",31,0)
 D EN1^DIP
"RTN","WVDIAGS",32,0)
 D:$E(WVIOST)="C" DIRZ^WVUTL3
"RTN","WVDIAGS",33,0)
EXIT ;
"RTN","WVDIAGS",34,0)
 K IOP,WVIOST
"RTN","WVDIAGS",35,0)
 D KILLALL^WVUTL8
"RTN","WVDIAGS",36,0)
 Q
"RTN","WVDIAGS",37,0)
 ;
"RTN","WVDIAGS",38,0)
 ;
"RTN","WVDIAGS",39,0)
TEXT1 ;EP
"RTN","WVDIAGS",40,0)
 ;;You may enter a synonym for each Result/Diagnosis.  The synonym will
"RTN","WVDIAGS",41,0)
 ;;allow the Result/Diagnosis to be called up by typing only a few
"RTN","WVDIAGS",42,0)
 ;;characters.  Synonyms should be unique and less than 6 characters.
"RTN","WVDIAGS",43,0)
 ;;
"RTN","WVDIAGS",44,0)
 ;;For example, "C1" might be used for CIN I/mild dysplasia; "C2" for
"RTN","WVDIAGS",45,0)
 ;;CIN II/moderate dysplasia; "C3" for CIN III/severe dysplasia,
"RTN","WVDIAGS",46,0)
 ;;and so on.
"RTN","WVDIAGS",47,0)
 ;;
"RTN","WVDIAGS",48,0)
 ;;
"RTN","WVDIAGS",49,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVDIAGS",50,0)
 Q
"RTN","WVDIAGS",51,0)
 ;
"RTN","WVDIAGS",52,0)
PRINTX ;EP
"RTN","WVDIAGS",53,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVDIAGS",54,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVDIAGS",55,0)
 Q
"RTN","WVENV")
0^66^B2315422
"RTN","WVENV",1,0)
WVENV ;HCIOFO/FT-Environment Check ;9/24/98  09:07
"RTN","WVENV",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVENV",3,0)
 ;;
"RTN","WVENV",4,0)
EN ; check if Rad/nm patch is installed.
"RTN","WVENV",5,0)
 I '$$PATCH^XPDUTL("RA*5.0*2") D
"RTN","WVENV",6,0)
 .S WVTEXT(1)="NOTE: The Radiology/Nuclear Medicine v5.0 package has an event"
"RTN","WVENV",7,0)
 .S WVTEXT(2)="      point (included with RA*5.0*2) which will notify the Women's"
"RTN","WVENV",8,0)
 .S WVTEXT(3)="      Health package whenever a radiology report is verified"
"RTN","WVENV",9,0)
 .S WVTEXT(4)="      for a mammogram. This event point allows mammograms"
"RTN","WVENV",10,0)
 .S WVTEXT(5)="      to be automatically entered into the Women's Health"
"RTN","WVENV",11,0)
 .S WVTEXT(6)="      Procedure file (#790.1)."
"RTN","WVENV",12,0)
 .S WVTEXT(7)=" "
"RTN","WVENV",13,0)
 .S WVTEXT(8)="      To use this functionality install RA*5.0*2."
"RTN","WVENV",14,0)
 .S WVTEXT(9)="      Please continue with this package installation."
"RTN","WVENV",15,0)
 .D BMES^XPDUTL(.WVTEXT)
"RTN","WVENV",16,0)
 .Q
"RTN","WVENV",17,0)
 K WVTEXT
"RTN","WVENV",18,0)
 Q
"RTN","WVEXPTRA")
0^15^B33235957
"RTN","WVEXPTRA",1,0)
WVEXPTRA ;HCIOFO/FT IHS/ANMC/MWR - EXPORT MAMS & BREAST ULTRASOUNDS TO WOMEN'S HEALTH  ;9/3/98  11:40
"RTN","WVEXPTRA",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVEXPTRA",3,0)
 ;---> WVNEWP = TOTAL NEW WOMEN'S HEALTH PATIENTS ADDED.
"RTN","WVEXPTRA",4,0)
 ;---> WVMAM  = TOTAL NEW MAMMOGRAMS PROCEDURES ADDED.
"RTN","WVEXPTRA",5,0)
 ;
"RTN","WVEXPTRA",6,0)
EN1 ;
"RTN","WVEXPTRA",7,0)
 S WVPOP=0
"RTN","WVEXPTRA",8,0)
 D DESC ;describe option
"RTN","WVEXPTRA",9,0)
 D CHECK I WVPOP D KILL Q  ;check if site parameter entry exists
"RTN","WVEXPTRA",10,0)
 D DTRNG I WVPOP D KILL Q  ;get date range
"RTN","WVEXPTRA",11,0)
 D STATUS I WVPOP D KILL Q  ;select status of procedure
"RTN","WVEXPTRA",12,0)
 D QUEUE ;queue a background job
"RTN","WVEXPTRA",13,0)
 D KILL
"RTN","WVEXPTRA",14,0)
 Q
"RTN","WVEXPTRA",15,0)
EN2 ;
"RTN","WVEXPTRA",16,0)
 D CPTS ;get procedure pointers
"RTN","WVEXPTRA",17,0)
 D GET ;get RAD/NM data & store in WH
"RTN","WVEXPTRA",18,0)
 D MAIL ;send mail message to user
"RTN","WVEXPTRA",19,0)
 D KILL ;kill variables
"RTN","WVEXPTRA",20,0)
 Q
"RTN","WVEXPTRA",21,0)
DESC ; Describe option
"RTN","WVEXPTRA",22,0)
 W @IOF
"RTN","WVEXPTRA",23,0)
 W !,"This option searches the Radiology/Nuclear Medicine database for"
"RTN","WVEXPTRA",24,0)
 W !,"all WH patients who had a mammogram or breast ultrasound exam"
"RTN","WVEXPTRA",25,0)
 W !,"(CPT codes are 76090, 76091, 76092 and 76645) during the date"
"RTN","WVEXPTRA",26,0)
 W !,"range you select. These procedures and patients will be added to"
"RTN","WVEXPTRA",27,0)
 W !,"the WH database if not already there.",!
"RTN","WVEXPTRA",28,0)
 W !,"This job will be queued as a background task so as to free up your"
"RTN","WVEXPTRA",29,0)
 W !,"terminal to do other work. You will receive a mail message when"
"RTN","WVEXPTRA",30,0)
 W !,"the job is done. The mail message will contain a count of the"
"RTN","WVEXPTRA",31,0)
 W !,"number of procedures and patients added.",!!
"RTN","WVEXPTRA",32,0)
 Q 
"RTN","WVEXPTRA",33,0)
CHECK ; Check if DUZ(2) exists for user, if entry exists in site parameter
"RTN","WVEXPTRA",34,0)
 ; file and if flag is set to accept rad/nm procedures.
"RTN","WVEXPTRA",35,0)
 D CHECK^WVLOGO
"RTN","WVEXPTRA",36,0)
 I '$G(DUZ(2))!('$D(^WV(790.02,+DUZ(2),0))) S WVPOP=1
"RTN","WVEXPTRA",37,0)
 I '$D(^RADPT) W !,"There is no Radiology/Nuclear Medicine Patient file (#70)",! S WVPOP=1
"RTN","WVEXPTRA",38,0)
 Q
"RTN","WVEXPTRA",39,0)
DTRNG ; prompt for date range, go back three years maximum
"RTN","WVEXPTRA",40,0)
 S WVSTDT=DT-30000
"RTN","WVEXPTRA",41,0)
 K DIR S DIR(0)="DA^"_WVSTDT_":"_DT
"RTN","WVEXPTRA",42,0)
 S DIR("A")="Enter START DATE: "
"RTN","WVEXPTRA",43,0)
 S DIR("?")="Enter the earliest date of the mammograms/breast ultrasounds you wish to retrieve. You can begin your search at "_$$FMTE^XLFDT(WVSTDT,"D")_"."
"RTN","WVEXPTRA",44,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",45,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",46,0)
 S WVSTDT=Y
"RTN","WVEXPTRA",47,0)
 S DIR(0)="DA^"_WVSTDT_":"_DT
"RTN","WVEXPTRA",48,0)
 S DIR("A")="Enter END DATE: ",DIR("B")=$$FMTE^XLFDT(DT,"D")
"RTN","WVEXPTRA",49,0)
 S DIR("?")="Enter the most recent date of the mammograms/breast ultrasounds you wish to retrieve."
"RTN","WVEXPTRA",50,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",51,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",52,0)
 S WVENDT=Y
"RTN","WVEXPTRA",53,0)
 Q
"RTN","WVEXPTRA",54,0)
STATUS ; Select default status for procedures
"RTN","WVEXPTRA",55,0)
 K DIR
"RTN","WVEXPTRA",56,0)
 S DIR(0)="S^o:OPEN;c:CLOSED",DIR("A")="Select STATUS OF IMPORTED MAMMOGRAMS"
"RTN","WVEXPTRA",57,0)
 S DIR("?")="Enter 'O' to give a Status of OPEN to Mammograms imported from the Radiology Software into the Women's Health database. Enter 'C' to give a Status of CLOSED to imported Mammograms."
"RTN","WVEXPTRA",58,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",59,0)
 I $D(DIRUT) S WVPOP=1
"RTN","WVEXPTRA",60,0)
 S WVSTATUS=Y
"RTN","WVEXPTRA",61,0)
 Q
"RTN","WVEXPTRA",62,0)
QUEUE ; Task as background job
"RTN","WVEXPTRA",63,0)
 S ZTIO="",ZTDESC="WH GRAB RAD/NM DATA",ZTRTN="EN2^WVEXPTRA"
"RTN","WVEXPTRA",64,0)
 S ZTDTH=$H,WVPOP=1
"RTN","WVEXPTRA",65,0)
 S ZTSAVE("WVENDT")="",ZTSAVE("WVSTDT")="",ZTSAVE("WVSTATUS")=""
"RTN","WVEXPTRA",66,0)
 D ^%ZTLOAD
"RTN","WVEXPTRA",67,0)
 Q
"RTN","WVEXPTRA",68,0)
CPTS ; Loop through File 71 to get procedure pointers for the CPTs we
"RTN","WVEXPTRA",69,0)
 ; are interested in.
"RTN","WVEXPTRA",70,0)
 S WVIEN=0 K WVARRAY
"RTN","WVEXPTRA",71,0)
 F  S WVIEN=$O(^RAMIS(71,WVIEN)) Q:'WVIEN  D
"RTN","WVEXPTRA",72,0)
 .S WVCPT=$$GET1^DIQ(71,WVIEN,9,"I") ;CPT code
"RTN","WVEXPTRA",73,0)
 .I WVCPT=76090 S WVARRAY(WVIEN)="" Q  ;unilateral mammogram
"RTN","WVEXPTRA",74,0)
 .I WVCPT=76091 S WVARRAY(WVIEN)="" Q  ;bilateral mammogram
"RTN","WVEXPTRA",75,0)
 .I WVCPT=76092 S WVARRAY(WVIEN)="" Q  ;screening mammogram
"RTN","WVEXPTRA",76,0)
 .S:WVCPT=76645 WVARRAY(WVIEN)="" ;echo exam of breast
"RTN","WVEXPTRA",77,0)
 .Q
"RTN","WVEXPTRA",78,0)
 Q
"RTN","WVEXPTRA",79,0)
GET ; get mammograms and breast ultrasounds from RAD/NM database
"RTN","WVEXPTRA",80,0)
 ;---> WVMCNT = total new procedures added.
"RTN","WVEXPTRA",81,0)
 ;---> WVNEWP = total new patients added.
"RTN","WVEXPTRA",82,0)
 S (WVMCNT,WVNEWP)=0
"RTN","WVEXPTRA",83,0)
 Q:'$D(WVARRAY)  ;no mammogram or breast ultrasound procedures in File 71
"RTN","WVEXPTRA",84,0)
 S WVENDT=WVENDT\1,WVENDT=9999999-WVENDT ;inverse end date
"RTN","WVEXPTRA",85,0)
 S WVSTDT=WVSTDT\1,WVSTDT=9999999-WVSTDT ;inverse start date
"RTN","WVEXPTRA",86,0)
 S WVSTDT=WVSTDT_".9999"
"RTN","WVEXPTRA",87,0)
 S WVDFN=0 ;patient dfn
"RTN","WVEXPTRA",88,0)
 F  S WVDFN=$O(^WV(790,WVDFN)) Q:'WVDFN  D  ;WH patient file
"RTN","WVEXPTRA",89,0)
 .Q:'$D(^RADPT(WVDFN))  ;not in RAD/NM patient file
"RTN","WVEXPTRA",90,0)
 .S WVDTI=WVENDT  ;Because the exam date is inverse the end date will
"RTN","WVEXPTRA",91,0)
 .;                will be the lower value.
"RTN","WVEXPTRA",92,0)
 .F  S WVDTI=$O(^RADPT(WVDFN,"DT",WVDTI)) Q:'WVDTI!(WVDTI>WVSTDT)  D
"RTN","WVEXPTRA",93,0)
 ..S WVCNI=0 ;case number
"RTN","WVEXPTRA",94,0)
 ..F  S WVCNI=$O(^RADPT(WVDFN,"DT",WVDTI,"P",WVCNI)) Q:'WVCNI  D
"RTN","WVEXPTRA",95,0)
 ...S WVNODE=$G(^RADPT(WVDFN,"DT",WVDTI,"P",WVCNI,0))
"RTN","WVEXPTRA",96,0)
 ...Q:WVNODE=""
"RTN","WVEXPTRA",97,0)
 ...S WVPROC=$P(WVNODE,U,2) ;procedure pointer
"RTN","WVEXPTRA",98,0)
 ...Q:'WVPROC  ;no pointer to File 71 (no procedure) 
"RTN","WVEXPTRA",99,0)
 ...Q:'$D(WVARRAY(WVPROC))  ;not a mammogram or breast ultrasound
"RTN","WVEXPTRA",100,0)
 ...S WVRPT=$P(WVNODE,U,17) ;report pointer
"RTN","WVEXPTRA",101,0)
 ...Q:'WVRPT  ;no pointer to File 74 (no report)
"RTN","WVEXPTRA",102,0)
 ...Q:$$GET1^DIQ(74,WVRPT,5,"I")'="V"  ;report status, must be VERIFIED
"RTN","WVEXPTRA",103,0)
 ...D CREATEH^WVRALINK(WVDFN,WVDTI,WVCNI,WVSTATUS)
"RTN","WVEXPTRA",104,0)
 ...Q
"RTN","WVEXPTRA",105,0)
 ..Q
"RTN","WVEXPTRA",106,0)
 .Q
"RTN","WVEXPTRA",107,0)
 Q
"RTN","WVEXPTRA",108,0)
MAIL ; send mail message to user with counts of procedures & patients added
"RTN","WVEXPTRA",109,0)
 S XMDUZ=.5 ;message sender
"RTN","WVEXPTRA",110,0)
 S XMY(DUZ)="" ;person who ran option
"RTN","WVEXPTRA",111,0)
 S XMSUB="Export of RAD/NM procedures to WH is done"
"RTN","WVEXPTRA",112,0)
 S WVMSG(1)="  # of New patients added to Women's Health package: "_WVNEWP
"RTN","WVEXPTRA",113,0)
 S WVMSG(2)="# of New procedures added to Women's Health package: "_WVMCNT
"RTN","WVEXPTRA",114,0)
 I '$D(WVARRAY) D
"RTN","WVEXPTRA",115,0)
 .S WVMSG(3)=" "
"RTN","WVEXPTRA",116,0)
 .S WVMSG(4)="There are no mammogram or breast ultrasound procedures listed in your"
"RTN","WVEXPTRA",117,0)
 .S WVMSG(5)="Radiology/Nuclear Medicine package."
"RTN","WVEXPTRA",118,0)
 .Q
"RTN","WVEXPTRA",119,0)
 S XMTEXT="WVMSG("
"RTN","WVEXPTRA",120,0)
 D ^XMD
"RTN","WVEXPTRA",121,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVEXPTRA",122,0)
 Q
"RTN","WVEXPTRA",123,0)
KILL ;
"RTN","WVEXPTRA",124,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT
"RTN","WVEXPTRA",125,0)
 K WVARRAY,WVCNI,WVCPT,WVDFN,WVDTI,WVENDT,WVIEN,WVMCNT,WVNEWP,WVNODE,WVPOP,WVPROC,WVRPT,WVSTATUS,WVSTDT
"RTN","WVEXPTRA",126,0)
 K X,Y,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK
"RTN","WVEXPTRA",127,0)
 Q
"RTN","WVEXPTRA",128,0)
 ;
"RTN","WVFACE")
0^16^B3405696
"RTN","WVFACE",1,0)
WVFACE ;HCIOFO/JR,FT IHS/ANMC/MWR - PRINT A FACE SHEET (FROM REG.); ;8/10/98  15:40
"RTN","WVFACE",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVFACE",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVFACE",4,0)
 ;;  DISPLAY/PRINT A FACE SHEET.
"RTN","WVFACE",5,0)
 ;
"RTN","WVFACE",6,0)
 D SETVARS^WVUTL5 S WVPOP1=0
"RTN","WVFACE",7,0)
 F  D RUN Q:WVPOP1
"RTN","WVFACE",8,0)
 D EXIT
"RTN","WVFACE",9,0)
 Q
"RTN","WVFACE",10,0)
 ;
"RTN","WVFACE",11,0)
RUN ;EP
"RTN","WVFACE",12,0)
 D TITLE^WVUTL5("DISPLAY/PRINT A PATIENT FACE SHEET")
"RTN","WVFACE",13,0)
 D PATIENT I Y<0 S WVPOP1=1 Q
"RTN","WVFACE",14,0)
 ;
"RTN","WVFACE",15,0)
RUN1 ;EP
"RTN","WVFACE",16,0)
 ;---> PATIENT ALREADY SELECTED.
"RTN","WVFACE",17,0)
 D DEVICE Q:WVPOP
"RTN","WVFACE",18,0)
 D FACE
"RTN","WVFACE",19,0)
 Q
"RTN","WVFACE",20,0)
 ;
"RTN","WVFACE",21,0)
EXIT ;EP
"RTN","WVFACE",22,0)
 D KILLALL^WVUTL8
"RTN","WVFACE",23,0)
 Q
"RTN","WVFACE",24,0)
 ;
"RTN","WVFACE",25,0)
 ;
"RTN","WVFACE",26,0)
PATIENT ;EP
"RTN","WVFACE",27,0)
 ;---> SELECT PATIENT (RETURN WVDFN).
"RTN","WVFACE",28,0)
 W !!,"   Select the patient whose Face Sheet you wish to display."
"RTN","WVFACE",29,0)
 D PATLKUP^WVUTL8(.Y)
"RTN","WVFACE",30,0)
 Q:Y<0  S WVDFN=+Y
"RTN","WVFACE",31,0)
 Q
"RTN","WVFACE",32,0)
 ;
"RTN","WVFACE",33,0)
 ;
"RTN","WVFACE",34,0)
DEVICE ;EP
"RTN","WVFACE",35,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVFACE",36,0)
 S ZTRTN="DEQUEUE^WVFACE",ZTSAVE("WVDFN")=""
"RTN","WVFACE",37,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVFACE",38,0)
 Q
"RTN","WVFACE",39,0)
 ;
"RTN","WVFACE",40,0)
 ;
"RTN","WVFACE",41,0)
FACE ;EP
"RTN","WVFACE",42,0)
 ;---> DISPLAY CODE FOR FACE SHEET.
"RTN","WVFACE",43,0)
 U IO
"RTN","WVFACE",44,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVFACE",45,0)
 I WVCRT N IOF S IOF="!"
"RTN","WVFACE",46,0)
 D
"RTN","WVFACE",47,0)
 .I '$D(WVDFN) W !?5,"A Patient has not been selected.",! Q
"RTN","WVFACE",48,0)
 .S DFN=WVDFN
"RTN","WVFACE",49,0)
 .;
"RTN","WVFACE",50,0)
 .;---> VA/STATE SITES MAY SUBSTITUTE AN ALTERNATE CALL BELOW.
"RTN","WVFACE",51,0)
 .;D ^VA_ROUTINE SUCH AS EN^DGRPD, AND QUIT.
"RTN","WVFACE",52,0)
 .;EXAMPLE: D EN^DGRPD Q
"RTN","WVFACE",53,0)
 .D EN^DGRPD Q
"RTN","WVFACE",54,0)
 .Q
"RTN","WVFACE",55,0)
 I WVCRT&('$D(IO("S"))) D:'$G(DGRPOUT) DIRZ^WVUTL3 W @IOF
"RTN","WVFACE",56,0)
 D ^%ZISC
"RTN","WVFACE",57,0)
 Q
"RTN","WVFACE",58,0)
 ;
"RTN","WVFACE",59,0)
FOLLUP(WVDFN) ;EP
"RTN","WVFACE",60,0)
 ;---> CALLED BY PROCEDURE FOLLOW-UP MENU (WVPROC1).
"RTN","WVFACE",61,0)
 D SETVARS^WVUTL5
"RTN","WVFACE",62,0)
 D RUN1
"RTN","WVFACE",63,0)
 Q
"RTN","WVFACE",64,0)
 ;
"RTN","WVFACE",65,0)
DEQUEUE ;EP
"RTN","WVFACE",66,0)
 ;---> EP FOR TASKMAN QUEUE OF PRINTOUT.
"RTN","WVFACE",67,0)
 D SETVARS^WVUTL5,FACE^WVFACE,EXIT
"RTN","WVFACE",68,0)
 Q
"RTN","WVFMAN")
0^17^B7209884
"RTN","WVFMAN",1,0)
WVFMAN ;HCIOFO/FT,JR IHS/ANMC/MWR - FILEMAN CALLS
"RTN","WVFMAN",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVFMAN",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVFMAN",4,0)
 ;;  CALLS TO FILEMAN WITH PRE- AND POST-CALL VARIABLE SETTING.
"RTN","WVFMAN",5,0)
 ;
"RTN","WVFMAN",6,0)
 ;
"RTN","WVFMAN",7,0)
DIC(DIC,DIC0,Y,DICA,DICB,DICS,X,WVPOP,DICW) ;EP
"RTN","WVFMAN",8,0)
 ;---> CALL TO ^DIC
"RTN","WVFMAN",9,0)
 ;---> PARAMETERS:
"RTN","WVFMAN",10,0)
 ;     1 - DIC=DIC       (REQUIRED)
"RTN","WVFMAN",11,0)
 ;     2 - DIC0=DIC(0)   (REQUIRED)
"RTN","WVFMAN",12,0)
 ;     3 - Y             (RETURNED) FROM CALL TO ^DIC
"RTN","WVFMAN",13,0)
 ;     4 - DICA=DIC("A") (OPTIONAL) PROMPT
"RTN","WVFMAN",14,0)
 ;     5 - DICB=DIC("B") (OPTIONAL) DEFAULT
"RTN","WVFMAN",15,0)
 ;     6 - DICS=DIC("S") (OPTIONAL) SCREEN
"RTN","WVFMAN",16,0)
 ;     7 - X             (OPTIONAL) IF DIC(0)'["A"
"RTN","WVFMAN",17,0)
 ;     8 - WVPOP         (OPTIONAL) WVPOP=1 IF DTOUT OR DUOUT
"RTN","WVFMAN",18,0)
 ;     9 - DICW=DIC("W") (OPTIONAL) 
"RTN","WVFMAN",19,0)
 ;
"RTN","WVFMAN",20,0)
 ;---> EXAMPLE: D DIC^WVFMAN(790,"QEMAL",.Y,"   Select PATIENT: ")
"RTN","WVFMAN",21,0)
 ;
"RTN","WVFMAN",22,0)
 I $G(DIC)']""!($G(DIC0)']"") S WVPOP=1 Q
"RTN","WVFMAN",23,0)
 S WVPOP=0 S:DIC DLAYGO=$P(DIC,".")
"RTN","WVFMAN",24,0)
 S DIC(0)=DIC0
"RTN","WVFMAN",25,0)
 S:$G(DICA)]"" DIC("A")=DICA
"RTN","WVFMAN",26,0)
 S:$G(DICB)]"" DIC("B")=DICB
"RTN","WVFMAN",27,0)
 S:$G(DICS)]"" DIC("S")=DICS
"RTN","WVFMAN",28,0)
 S:$G(DICW)]"" DIC("W")=DICW
"RTN","WVFMAN",29,0)
 D ^DIC
"RTN","WVFMAN",30,0)
 S:($D(DTOUT))!($D(DUOUT)) WVPOP=1
"RTN","WVFMAN",31,0)
 D DKILLS
"RTN","WVFMAN",32,0)
 Q
"RTN","WVFMAN",33,0)
 ;
"RTN","WVFMAN",34,0)
DDS(DDSFILE,DR,DA,DDSPARM,DDSCHANG,WVPOP) ;EP
"RTN","WVFMAN",35,0)
 ;---> CALL TO ^DDS
"RTN","WVFMAN",36,0)
 ;---> NOTE: SCREENMAN AUTOMATICALLY USES INCREMENTAL LOCKS.
"RTN","WVFMAN",37,0)
 ;---> PARAMETERS:
"RTN","WVFMAN",38,0)
 ;     1 - DDSFILE=FILE# (REQUIRED)
"RTN","WVFMAN",39,0)
 ;     2 - DR=FORM       (REQUIRED)
"RTN","WVFMAN",40,0)
 ;     3 - DA=RECORD     (REQUIRED)
"RTN","WVFMAN",41,0)
 ;     4 - DDSPARM (C/E) (OPTIONAL) C=REGISTER CHANGE IN DDSCHANG
"RTN","WVFMAN",42,0)
 ;     5 - DDSCHANG      (RETURNED) DDSCHANG=1 IF CHANGE TO DATABASE
"RTN","WVFMAN",43,0)
 ;     6 - WVPOP         (RETURNED) FAIL/QUIT/TIMEOUT
"RTN","WVFMAN",44,0)
 ;
"RTN","WVFMAN",45,0)
 ;---> EXAMPLES:
"RTN","WVFMAN",46,0)
 ;     D DDS^WVFMAN(790.02,"[WV SITE PARAMS-FORM-1]",+Y)
"RTN","WVFMAN",47,0)
 ;     D DDS^WVFMAN(790.1,"[WV PROC-FORM-LAB]",DA,"C",.WVCHG,.WVPOP)
"RTN","WVFMAN",48,0)
 ;
"RTN","WVFMAN",49,0)
 N WVDA S WVDA=DA,WVPOP=0
"RTN","WVFMAN",50,0)
 I DDSFILE S DDSFILE=^DIC(DDSFILE,0,"GL")
"RTN","WVFMAN",51,0)
 L +@(DDSFILE_WVDA_")"):5 I '$T S WVPOP=1 D LOCKED^WVUTL3 Q
"RTN","WVFMAN",52,0)
 K ^TMP("DDS",$J)
"RTN","WVFMAN",53,0)
 D:'$D(IOST(0)) HOME^%ZIS D ENS^%ZISS
"RTN","WVFMAN",54,0)
 D ^DDS
"RTN","WVFMAN",55,0)
 S:$D(DTOUT) WVPOP=1
"RTN","WVFMAN",56,0)
 I $D(DIMSG)!($D(DIERR)) D  S WVPOP=1
"RTN","WVFMAN",57,0)
 .W !?5,"* The Screen Manager could not edit this record."
"RTN","WVFMAN",58,0)
 .W !?7,"Please contact your Site Manager." D DIRZ^WVUTL3
"RTN","WVFMAN",59,0)
 L -@(DDSFILE_WVDA_")")
"RTN","WVFMAN",60,0)
 D DKILLS
"RTN","WVFMAN",61,0)
 Q
"RTN","WVFMAN",62,0)
 ;
"RTN","WVFMAN",63,0)
DIE(DIE,DR,DA,WVPOP,Z) ;EP
"RTN","WVFMAN",64,0)
 ;---> CALL TO ^DIE
"RTN","WVFMAN",65,0)
 ;---> PARAMETERS:
"RTN","WVFMAN",66,0)
 ;     1 - DIE=DIE (REQUIRED)
"RTN","WVFMAN",67,0)
 ;     2 - DR=DR   (REQUIRED)
"RTN","WVFMAN",68,0)
 ;     3 - DA=DA   (REQUIRED)
"RTN","WVFMAN",69,0)
 ;     4 - WVPOP   (RETURNED) WVPOP=1 INDICATES FAILURE/QUIT
"RTN","WVFMAN",70,0)
 ;     5 - Z       (OPTIONAL) Z=1 IF USER SHOULD *NOT* BE NOTIFIED
"RTN","WVFMAN",71,0)
 ;                            RECORD WAS LOCKED.
"RTN","WVFMAN",72,0)
 ;
"RTN","WVFMAN",73,0)
 ;---> EXAMPLE: D DIE^WVFMAN(790,DR,+Y,.WVPOP)
"RTN","WVFMAN",74,0)
 ;              (+Y FROM DIC CALL, DR COULD BE LITERAL IF SHORT.)
"RTN","WVFMAN",75,0)
 ;
"RTN","WVFMAN",76,0)
 N WVDA S WVDA=DA,WVPOP=0
"RTN","WVFMAN",77,0)
 I DIE S DIE=^DIC(DIE,0,"GL")
"RTN","WVFMAN",78,0)
 L +@(DIE_WVDA_")"):5 I '$T S WVPOP=1 D:'$G(Z) LOCKED^WVUTL3 Q
"RTN","WVFMAN",79,0)
 D ^DIE
"RTN","WVFMAN",80,0)
 I $D(DTOUT) S WVPOP=1
"RTN","WVFMAN",81,0)
 L -@(DIE_WVDA_")")
"RTN","WVFMAN",82,0)
 D DKILLS
"RTN","WVFMAN",83,0)
 Q
"RTN","WVFMAN",84,0)
 ;
"RTN","WVFMAN",85,0)
FILE(DIC,DICDR,DIC0,X,DLAYGO,Y) ; EP - CALL FILE^DICN
"RTN","WVFMAN",86,0)
 K DD,DO
"RTN","WVFMAN",87,0)
 I DIC S DIC=^DIC(DIC,0,"GL")
"RTN","WVFMAN",88,0)
 S:$G(DICDR)]"" DIC("DR")=DICDR S DIC(0)=DIC0
"RTN","WVFMAN",89,0)
 D FILE^DICN
"RTN","WVFMAN",90,0)
 D DKILLS
"RTN","WVFMAN",91,0)
 Q
"RTN","WVFMAN",92,0)
 ;
"RTN","WVFMAN",93,0)
DIK ; EP - CALL ^DIK
"RTN","WVFMAN",94,0)
 D ^DIK
"RTN","WVFMAN",95,0)
 D DKILLS
"RTN","WVFMAN",96,0)
 Q
"RTN","WVFMAN",97,0)
 ;
"RTN","WVFMAN",98,0)
DIQ ; EP - CALL ^DIQ
"RTN","WVFMAN",99,0)
 D EN^DIQ
"RTN","WVFMAN",100,0)
 D DKILLS
"RTN","WVFMAN",101,0)
 Q
"RTN","WVFMAN",102,0)
 ;
"RTN","WVFMAN",103,0)
DIQ1 ; EP - CALL ^DIQ1
"RTN","WVFMAN",104,0)
 D EN^DIQ1
"RTN","WVFMAN",105,0)
 D DKILLS
"RTN","WVFMAN",106,0)
 Q
"RTN","WVFMAN",107,0)
 ;
"RTN","WVFMAN",108,0)
DKILLS ;EP
"RTN","WVFMAN",109,0)
 K D,D0,D1,DA,DD,DDH,DI,DIADD,DIC,DIC1,DICR,DIE,DIG,DIH,DIK,DILC
"RTN","WVFMAN",110,0)
 K DINUM,DIRUT,DIQ,DIQ2,DIR,DIU,DIW,DIWF,DIWL,DIWR,DIWT,DK,DL
"RTN","WVFMAN",111,0)
 K DLAYGO,DN,DQ,DR,DTOUT,DUOUT,DX
"RTN","WVFMAN",112,0)
 Q
"RTN","WVGETALL")
0^18^B49945085
"RTN","WVGETALL",1,0)
WVGETALL ;HCIOFO/FT,JR IHS/ANMC/MWR - AUTOLOAD FEMALE PATIENTS ;9/17/98  12:49
"RTN","WVGETALL",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVGETALL",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVGETALL",4,0)
 ;;  AUTOMATICALLY LOADS WOMENS PATIENTS FROM THE MAIN PATIENT FILE,
"RTN","WVGETALL",5,0)
 ;;  LIMITED BY AGE AND CURRENT COMMUNITY.
"RTN","WVGETALL",6,0)
 ;
"RTN","WVGETALL",7,0)
EN D SETVARS^WVUTL5
"RTN","WVGETALL",8,0)
 D INTRO  G:WVPOP EXIT
"RTN","WVGETALL",9,0)
 D SELECT G:WVPOP EXIT
"RTN","WVGETALL",10,0)
 D DEVICE G:WVPOP EXIT
"RTN","WVGETALL",11,0)
 D LOAD
"RTN","WVGETALL",12,0)
 ;
"RTN","WVGETALL",13,0)
EXIT ;EP
"RTN","WVGETALL",14,0)
 D KILLALL^WVUTL8 K WVJSDT,WVJEDT,WVN,WVST
"RTN","WVGETALL",15,0)
 Q
"RTN","WVGETALL",16,0)
 ;
"RTN","WVGETALL",17,0)
 ;
"RTN","WVGETALL",18,0)
INTRO ;EP
"RTN","WVGETALL",19,0)
 ;---> INTRODUCTORY SCREENS.
"RTN","WVGETALL",20,0)
 S WVTITLE="AUTOLOAD PATIENTS"
"RTN","WVGETALL",21,0)
 D TITLE^WVUTL5(WVTITLE)
"RTN","WVGETALL",22,0)
 D TEXT1,DIRZ^WVUTL3
"RTN","WVGETALL",23,0)
 Q:WVPOP
"RTN","WVGETALL",24,0)
 D TITLE^WVUTL5(WVTITLE)
"RTN","WVGETALL",25,0)
 D TEXT2,DIRZ^WVUTL3
"RTN","WVGETALL",26,0)
 Q
"RTN","WVGETALL",27,0)
 ;
"RTN","WVGETALL",28,0)
SELECT ;EP
"RTN","WVGETALL",29,0)
 ;---> SELECT AGE.
"RTN","WVGETALL",30,0)
 D TITLE^WVUTL5(WVTITLE)
"RTN","WVGETALL",31,0)
 ;---> SELECT AGE.
"RTN","WVGETALL",32,0)
 K DIR
"RTN","WVGETALL",33,0)
 W !?5,"Select the age below which patients should NOT be added:"
"RTN","WVGETALL",34,0)
 S DIR("A")="     Enter AGE: ",DIR("B")=19
"RTN","WVGETALL",35,0)
 S DIR(0)="NOA^10:99" D HELP1
"RTN","WVGETALL",36,0)
 D ^DIR K DIR
"RTN","WVGETALL",37,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVGETALL",38,0)
 S WVAGE=+Y
"RTN","WVGETALL",39,0)
 W !!?5,"Define Active Patient for Patient file download."
"RTN","WVGETALL",40,0)
 W !?5,"If the patient has had no activity (visits or admissions) between"
"RTN","WVGETALL",41,0)
 W !?5,"the start and end dates you enter here, she will not be included"
"RTN","WVGETALL",42,0)
 W !?5,"in this Patient file download.",!
"RTN","WVGETALL",43,0)
STD S DIR(0)="DAO",DIR("A")="     Start Date of Patient Activity to Include: "
"RTN","WVGETALL",44,0)
 S Y=DT-30000 D DD^%DT S DIR("B")=Y
"RTN","WVGETALL",45,0)
 S DIR("?",1)="     If the patient has not had a Visit or Admission after this start date,"
"RTN","WVGETALL",46,0)
 S DIR("?",2)="     they will not be included in the auto-load."
"RTN","WVGETALL",47,0)
 S DIR("?")="     This date can be up to 3 years prior to todays date."
"RTN","WVGETALL",48,0)
 D ^DIR K DIR I Y'>0  W !!!! K WVJRDT S WVPOP=1 Q
"RTN","WVGETALL",49,0)
 S WVJSDT=Y
"RTN","WVGETALL",50,0)
K S DIR(0)="DAO",DIR("A")="     End Date of Patient Activity to Include: "
"RTN","WVGETALL",51,0)
 S DIR("?")="   "
"RTN","WVGETALL",52,0)
 S DIR("?",1)="     If the patient has not had a Visit or Admission before this date,"
"RTN","WVGETALL",53,0)
 S DIR("?",2)="     they will not be included in the auto-load."
"RTN","WVGETALL",54,0)
 S DIR("?",3)="     This date may be up to 3 years prior to todays date, but must be"
"RTN","WVGETALL",55,0)
 S DIR("?",4)="     after the start date."
"RTN","WVGETALL",56,0)
 S Y=DT D DD^%DT S DIR("B")=Y
"RTN","WVGETALL",57,0)
 D ^DIR K DIR I Y'>0  W !!!! K WVJSDT S WVPOP=1 Q
"RTN","WVGETALL",58,0)
 I Y<WVJSDT W !!!,"     END DATE MUST BE AFTER START DATE",!!! K WVJSDT G STD
"RTN","WVGETALL",59,0)
 S WVJEDT=Y
"RTN","WVGETALL",60,0)
 Q
"RTN","WVGETALL",61,0)
 ;
"RTN","WVGETALL",62,0)
DEVICE ;EP
"RTN","WVGETALL",63,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVGETALL",64,0)
 S ZTRTN="LOAD^WVGETALL"
"RTN","WVGETALL",65,0)
 S ZTSAVE("WVAGE")="",ZTSAVE("WVJSDT")="",ZTSAVE("WVJEDT")=""
"RTN","WVGETALL",66,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVGETALL",67,0)
 Q
"RTN","WVGETALL",68,0)
 ;
"RTN","WVGETALL",69,0)
LOAD ;EP
"RTN","WVGETALL",70,0)
 ;---> AUTOLOAD OF PATIENTS
"RTN","WVGETALL",71,0)
 N WVCOUNT,WVERROR,N,X,Y D SETVARS^WVUTL5
"RTN","WVGETALL",72,0)
 D TOPHEAD^WVUTL7 S WVCONF=1
"RTN","WVGETALL",73,0)
 S WVTITLE="* AUTOLOAD OF WOMEN PATIENTS *"
"RTN","WVGETALL",74,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVGETALL",75,0)
 U IO
"RTN","WVGETALL",76,0)
 W:$Y>0 @IOF D HEADER7^WVUTL7
"RTN","WVGETALL",77,0)
 S (WVCOUNT,N)=0
"RTN","WVGETALL",78,0)
 S WVN=0 F  S WVN=$O(^DPT("ASX","F",WVN)) Q:'WVN  Q:WVPOP  D
"RTN","WVGETALL",79,0)
 .S Y=^DPT(WVN,0)
"RTN","WVGETALL",80,0)
 .;---> QUIT IF NOT FEMALE.
"RTN","WVGETALL",81,0)
 .Q:$P(Y,U,2)'="F"
"RTN","WVGETALL",82,0)
 .;---> QUIT IF DECEASED OR LESS THAN WVAGE.
"RTN","WVGETALL",83,0)
 .Q:+$$AGE^WVUTL1(WVN)<WVAGE
"RTN","WVGETALL",84,0)
 .Q:$D(^WV(790,WVN,0))
"RTN","WVGETALL",85,0)
 .;Quit if not active patient
"RTN","WVGETALL",86,0)
 .Q:$$HOS(WVN)<1
"RTN","WVGETALL",87,0)
 .I $Y+5>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER7^WVUTL7
"RTN","WVGETALL",88,0)
 .W !?3,$$NAME^WVUTL1(WVN),?30,$$SSN^WVUTL1(WVN)
"RTN","WVGETALL",89,0)
 .W ?45,$$SLDT2^WVUTL5($$DOB^WVUTL1(WVN))
"RTN","WVGETALL",90,0)
 .D AUTOADD^WVPATE(WVN,DUZ(2),.WVERROR)
"RTN","WVGETALL",91,0)
 .I WVERROR<0 W ?60,"FAILED" Q
"RTN","WVGETALL",92,0)
 .S WVCOUNT=WVCOUNT+1 W ?60,"ADDED" ;,?70,WVN
"RTN","WVGETALL",93,0)
 W !!?5,"TOTAL: ",WVCOUNT," PATIENT",$S(WVCOUNT=1:"",1:"S")
"RTN","WVGETALL",94,0)
 W " ADDED TO THE WOMEN'S HEALTH DATABASE.",!
"RTN","WVGETALL",95,0)
 I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVGETALL",96,0)
 K TEST1,TEST2 D ^%ZISC
"RTN","WVGETALL",97,0)
 Q
"RTN","WVGETALL",98,0)
 ;
"RTN","WVGETALL",99,0)
 ;
"RTN","WVGETALL",100,0)
TEXT1 ;EP
"RTN","WVGETALL",101,0)
 ;;This utility will examine the VISTA Patient file(#2) for ALL
"RTN","WVGETALL",102,0)
 ;;women over a given age who were seen as either an Inpatient or
"RTN","WVGETALL",103,0)
 ;;an Outpatient in the date range selected, and add them to the 
"RTN","WVGETALL",104,0)
 ;;Women's Health Database.
"RTN","WVGETALL",105,0)
 ;;
"RTN","WVGETALL",106,0)
 ;;You will be asked to select a cutoff age (e.g., 40 and over). 
"RTN","WVGETALL",107,0)
 ;;You will be asked to select a Start and End Activity date.  
"RTN","WVGETALL",108,0)
 ;;Patients not having a visit or admission between these dates
"RTN","WVGETALL",109,0)
 ;;will not be added to the file.  These dates can be no more
"RTN","WVGETALL",110,0)
 ;;than 3 years prior to todays date.
"RTN","WVGETALL",111,0)
 ;;
"RTN","WVGETALL",112,0)
 ;;Women already in the Women's Health Database will not be added twice.
"RTN","WVGETALL",113,0)
 ;;Women who are deceased will not be added.  Women added to the Women's
"RTN","WVGETALL",114,0)
 ;;Health Database will be given Breast and Cervical Treatment Needs of
"RTN","WVGETALL",115,0)
 ;;"Undetermined", with no due dates.
"RTN","WVGETALL",116,0)
 ;;
"RTN","WVGETALL",117,0)
 ;;This utility may be run at any time, as often as desired.  It may be
"RTN","WVGETALL",118,0)
 ;;useful to run it on a monthly basis in order to pick up new women who
"RTN","WVGETALL",119,0)
 ;;are added to the Patient Database.
"RTN","WVGETALL",120,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVGETALL",121,0)
 Q
"RTN","WVGETALL",122,0)
 ;
"RTN","WVGETALL",123,0)
 ;
"RTN","WVGETALL",124,0)
TEXT2 ;EP
"RTN","WVGETALL",125,0)
 ;;Before the program begins, you will be prompted for a "DEVICE:".
"RTN","WVGETALL",126,0)
 ;;The name, social security number, and date of birth of each
"RTN","WVGETALL",127,0)
 ;;patient added to the Women's Health Database will be displayed
"RTN","WVGETALL",128,0)
 ;;on the DEVICE.
"RTN","WVGETALL",129,0)
 ;;This DEVICE may be a printer, or you may enter "HOME" to have the
"RTN","WVGETALL",130,0)
 ;;information simply display on your screen.
"RTN","WVGETALL",131,0)
 ;;
"RTN","WVGETALL",132,0)
 ;;If the DEVICE you select is a printer, it may be preferable
"RTN","WVGETALL",133,0)
 ;;to "queue" the job, in order to free up your terminal.
"RTN","WVGETALL",134,0)
 ;;See your computer sitemanager for assistance with queuing jobs.
"RTN","WVGETALL",135,0)
 ;;
"RTN","WVGETALL",136,0)
 ;;WARNING: The first time this utility is run, it may add several
"RTN","WVGETALL",137,0)
 ;;thousand patients to the Women's Health Database.  It may take
"RTN","WVGETALL",138,0)
 ;;several minutes or even hours to run, depending on the size of the
"RTN","WVGETALL",139,0)
 ;;database and speed of the computer.  Subsequent runs should be much
"RTN","WVGETALL",140,0)
 ;;quicker.
"RTN","WVGETALL",141,0)
 ;;
"RTN","WVGETALL",142,0)
 ;;You may type "^" at anytime to quit before the program begins.
"RTN","WVGETALL",143,0)
 S WVTAB=5,WVLINL="TEXT2" D PRINTX
"RTN","WVGETALL",144,0)
 Q
"RTN","WVGETALL",145,0)
 ;
"RTN","WVGETALL",146,0)
HELP1 ;EP
"RTN","WVGETALL",147,0)
 ;;Enter a two-digit number that will be the lowest age of patients
"RTN","WVGETALL",148,0)
 ;;added to the Women's Health Database.  For example, if you enter 15,
"RTN","WVGETALL",149,0)
 ;;all women age 15 and older will be included, 14 and under will not.
"RTN","WVGETALL",150,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVGETALL",151,0)
 Q
"RTN","WVGETALL",152,0)
 ;
"RTN","WVGETALL",153,0)
 ;
"RTN","WVGETALL",154,0)
PRINTX ;EP
"RTN","WVGETALL",155,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVGETALL",156,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVGETALL",157,0)
 Q
"RTN","WVGETALL",158,0)
 ;
"RTN","WVGETALL",159,0)
HELPTX ;EP
"RTN","WVGETALL",160,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVGETALL",161,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVGETALL",162,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVGETALL",163,0)
 Q
"RTN","WVGETALL",164,0)
HOS(WVN) ;Comes here to determine if visit/adm. is current
"RTN","WVGETALL",165,0)
 ;WVN=DFN, WVJSDT=Selected earliest date for consideration.
"RTN","WVGETALL",166,0)
 S WVST="ADFN"_WVN
"RTN","WVGETALL",167,0)
 S TEST1=$O(^DGPM(WVST,WVJSDT)) I TEST1>WVJSDT I TEST1<WVJEDT Q 1
"RTN","WVGETALL",168,0)
 S TEST2=$O(^SCE("ADFN",WVN,WVJSDT)) I TEST2>WVJSDT I TEST2<WVJEDT Q 1
"RTN","WVGETALL",169,0)
 Q 0
"RTN","WVLAB")
0^67^B2043349
"RTN","WVLAB",1,0)
WVLAB ;HCIOFO/FT IHS/ANMC/MWR - ADD/EDIT PROCEDURE BY LAB STAFF; ;8/27/98  11:28
"RTN","WVLAB",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVLAB",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLAB",4,0)
 ;;  CALLED BY OPTION: "WV LAB ADD A NEW PROCEDURE" TO ACCESSION
"RTN","WVLAB",5,0)
 ;;  PROCEDURES.
"RTN","WVLAB",6,0)
 ;
"RTN","WVLAB",7,0)
 D SETVARS^WVUTL5
"RTN","WVLAB",8,0)
 F  D  Q:WVPOP
"RTN","WVLAB",9,0)
 .D TITLE^WVUTL5("LAB: ENTER NEW PROCEDURES")
"RTN","WVLAB",10,0)
 .D NEW
"RTN","WVLAB",11,0)
 D EXIT
"RTN","WVLAB",12,0)
 Q
"RTN","WVLAB",13,0)
 ;
"RTN","WVLAB",14,0)
NEW ;EP
"RTN","WVLAB",15,0)
 ;---> SELECT PATIENT.
"RTN","WVLAB",16,0)
 S WVPOP=0 N WVDFN,DIR,DR
"RTN","WVLAB",17,0)
 D PATLKUP^WVUTL8(.Y,"ADD")
"RTN","WVLAB",18,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVLAB",19,0)
 S WVDFN=+Y
"RTN","WVLAB",20,0)
 ;---> SELECT PROCEDURE.
"RTN","WVLAB",21,0)
 D NEW1^WVPROC I WVPOP S WVPOP=0 Q
"RTN","WVLAB",22,0)
 I '$G(DA) D  Q
"RTN","WVLAB",23,0)
 .W !?5,"* FAILURE TO ADD NEW PROCEDURE.  "
"RTN","WVLAB",24,0)
 .W "PLEASE CONTACT YOUR SITE MANAGER" D DIRZ^WVUTL3
"RTN","WVLAB",25,0)
 D EDIT2(DA)
"RTN","WVLAB",26,0)
 Q
"RTN","WVLAB",27,0)
 ;
"RTN","WVLAB",28,0)
EDIT ;EP
"RTN","WVLAB",29,0)
 ;---> CALLED BY OPTION: "WV LAB EDIT ACCESSION".
"RTN","WVLAB",30,0)
 ;---> EDIT JUST THE ACCESSION FIELDS OF AN EXISTING PROCEDURE.
"RTN","WVLAB",31,0)
 D SETVARS^WVUTL5
"RTN","WVLAB",32,0)
 D TITLE^WVUTL5("EDIT AN ACCESSIONED PROCEDURE")
"RTN","WVLAB",33,0)
 D LKUPPCD^WVPROC(.Y)
"RTN","WVLAB",34,0)
 Q:Y<0!($D(DIROUT))
"RTN","WVLAB",35,0)
 ;---> DA=IEN OF PROCEDURE IN PROCEDURE FILE 790.1.
"RTN","WVLAB",36,0)
 S DA=+Y
"RTN","WVLAB",37,0)
 D EDIT2(DA)
"RTN","WVLAB",38,0)
 D EXIT
"RTN","WVLAB",39,0)
 Q
"RTN","WVLAB",40,0)
 ;
"RTN","WVLAB",41,0)
 ;
"RTN","WVLAB",42,0)
EDIT2(DA) ;EP
"RTN","WVLAB",43,0)
 ;---> REQUIRED VARIABLES: DA=IEN IN ^WV(790.1,.
"RTN","WVLAB",44,0)
 Q:'$G(DA)
"RTN","WVLAB",45,0)
 S WVDFN=$P(^WV(790.1,DA,0),U,2)
"RTN","WVLAB",46,0)
 D DDS^WVFMAN(790.1,"[WV PROC-FORM-LAB]",DA,"C",.WVCHG,.WVPOP)
"RTN","WVLAB",47,0)
 Q
"RTN","WVLAB",48,0)
 ;
"RTN","WVLAB",49,0)
EXIT ;EP
"RTN","WVLAB",50,0)
 D KILLALL^WVUTL8
"RTN","WVLAB",51,0)
 Q
"RTN","WVLABLG")
0^68^B26356818
"RTN","WVLABLG",1,0)
WVLABLG ;HCIOFO/FT IHS/ANMC/MWR - DISPLAY LAB LOG; ;8/31/98  16:24
"RTN","WVLABLG",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVLABLG",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLABLG",4,0)
 ;;  CALLED BY OPTION: "WV LAB PRINT LOG" TO PRINT THE "LOG" OF
"RTN","WVLABLG",5,0)
 ;;  OF PROCEDURES THAT HAVE BEEN ENTERED ("ACCESSIONED").
"RTN","WVLABLG",6,0)
 ;
"RTN","WVLABLG",7,0)
 ;---> VARIABLES:
"RTN","WVLABLG",8,0)
 ;---> DATES: WVBEGDT=BEGINNING DATE, WVENDDT=ENDING DATE
"RTN","WVLABLG",9,0)
 ;---> WVA:   1=ALL PROCEDURES, 0=ONLY PROCEDURES WITHOUT RESULTS
"RTN","WVLABLG",10,0)
 ;---> WVB:   1=DISPLAY EACH PROCEDURE, 0=TOTALS ONLY
"RTN","WVLABLG",11,0)
 ;
"RTN","WVLABLG",12,0)
 D SETVARS^WVUTL5 S WVPOP=0
"RTN","WVLABLG",13,0)
 D TITLE^WVUTL5("PRINT LOG OF PROCEDURES ENTRY")
"RTN","WVLABLG",14,0)
 D DATES    G:WVPOP EXIT
"RTN","WVLABLG",15,0)
 D SELECT   G:WVPOP EXIT
"RTN","WVLABLG",16,0)
 D FACILITY G:WVPOP EXIT
"RTN","WVLABLG",17,0)
 D RESULT   G:WVPOP EXIT
"RTN","WVLABLG",18,0)
 D TOTALS   G:WVPOP EXIT
"RTN","WVLABLG",19,0)
 D ORDER    G:WVPOP EXIT
"RTN","WVLABLG",20,0)
 D DEVICE   G:WVPOP EXIT
"RTN","WVLABLG",21,0)
 D SORT
"RTN","WVLABLG",22,0)
 D COPYGBL
"RTN","WVLABLG",23,0)
 D ^WVLABLG1
"RTN","WVLABLG",24,0)
 ;
"RTN","WVLABLG",25,0)
EXIT ;EP
"RTN","WVLABLG",26,0)
 D KILLALL^WVUTL8
"RTN","WVLABLG",27,0)
 Q
"RTN","WVLABLG",28,0)
 ;
"RTN","WVLABLG",29,0)
DATES ;EP
"RTN","WVLABLG",30,0)
 ;---> ASK DATE RANGE.  RETURN DATES IN WVBEGDT AND WVENDDT.
"RTN","WVLABLG",31,0)
 ;---> LAB PEOPLE GENERALLY LOOK AT THE LOG FOR ONE DAY.
"RTN","WVLABLG",32,0)
 D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP,"T-1","",1)
"RTN","WVLABLG",33,0)
 Q
"RTN","WVLABLG",34,0)
 ;
"RTN","WVLABLG",35,0)
SELECT ;EP
"RTN","WVLABLG",36,0)
 ;---> SELECT ENTRIES TO SEARCH FOR.
"RTN","WVLABLG",37,0)
 D SELECT^WVSELECT("Accession Area",790.2,"WVAREA","","PAP",.WVPOP)
"RTN","WVLABLG",38,0)
 Q
"RTN","WVLABLG",39,0)
 ;
"RTN","WVLABLG",40,0)
FACILITY ;EP
"RTN","WVLABLG",41,0)
 ;---> SELECT FACILITY TO SEARCH FOR.
"RTN","WVLABLG",42,0)
 N B S B=$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVLABLG",43,0)
 W !!?3,"Select the Facility for the log you wish to display."
"RTN","WVLABLG",44,0)
 D DIC^WVFMAN(790.02,"QEMA",.Y,"   Select FACILITY: ",B)
"RTN","WVLABLG",45,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVLABLG",46,0)
 S WVFAC=+Y
"RTN","WVLABLG",47,0)
 Q
"RTN","WVLABLG",48,0)
 ;
"RTN","WVLABLG",49,0)
RESULT ;EP
"RTN","WVLABLG",50,0)
 ;---> DISPLAY ALL PROCEDURES, OR ONLY PROCEDURES WITHOUT RESULTS.
"RTN","WVLABLG",51,0)
 N DIR K DIRUT
"RTN","WVLABLG",52,0)
 W !!?3,"Display ALL Procedures, or only Procedures with NO RESULTS?"
"RTN","WVLABLG",53,0)
 S DIR("A")="   Select ALL or NO RESULTS: ",DIR("B")="ALL"
"RTN","WVLABLG",54,0)
 S DIR(0)="SAM^a:ALL;n:NO RESULTS" D HELP1^WVLABLG2
"RTN","WVLABLG",55,0)
 D ^DIR
"RTN","WVLABLG",56,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVLABLG",57,0)
 ;---> IF ALL PPROCEDURES, S WVA=1; IF ONLY NO RESULTS, S WVA=0.
"RTN","WVLABLG",58,0)
 S WVA=$S(Y="a":1,1:0)
"RTN","WVLABLG",59,0)
 Q
"RTN","WVLABLG",60,0)
 ;
"RTN","WVLABLG",61,0)
TOTALS ;EP
"RTN","WVLABLG",62,0)
 ;---> DISPLAY ALL PROCEDURES, OR ONLY TOTALS.
"RTN","WVLABLG",63,0)
 N DIR
"RTN","WVLABLG",64,0)
 W !!?3,"Display data for EACH Procedure, or just TOTALS?"
"RTN","WVLABLG",65,0)
 S DIR("A")="   Select EACH or TOTALS: ",DIR("B")="EACH"
"RTN","WVLABLG",66,0)
 S DIR(0)="SAM^e:EACH;n:TOTALS" D HELP2^WVLABLG2
"RTN","WVLABLG",67,0)
 D ^DIR
"RTN","WVLABLG",68,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVLABLG",69,0)
 ;---> IF DISPLAY EACH PROCEDURE, S WVB=1; IF TOTALS ONLY, S WVB=0
"RTN","WVLABLG",70,0)
 S WVB=$S(Y="e":1,1:0)
"RTN","WVLABLG",71,0)
 Q
"RTN","WVLABLG",72,0)
 ;
"RTN","WVLABLG",73,0)
ORDER ;EP
"RTN","WVLABLG",74,0)
 ;---> ASK ORDER BY ACCESSION# OR BY PATIENT NAME.
"RTN","WVLABLG",75,0)
 ;---> SORT SEQUENCE IN WVC:  1=ACCESSION# (DEFAULT), 2=PATIENT NAME
"RTN","WVLABLG",76,0)
 S WVC=1
"RTN","WVLABLG",77,0)
 ;---> QUIT IF DISPLAYING TOTALS ONLY.
"RTN","WVLABLG",78,0)
 Q:'WVB  N DIR,DIRUT,Y
"RTN","WVLABLG",79,0)
 W !!?3,"Display Procedures in order of:"
"RTN","WVLABLG",80,0)
 W ?37,"1) ACCESSION# (earliest first)"
"RTN","WVLABLG",81,0)
 W !?37,"2) PATIENT NAME (alphabetically)"
"RTN","WVLABLG",82,0)
 S DIR("A")="   Select 1 or 2: ",DIR("B")=1
"RTN","WVLABLG",83,0)
 S DIR(0)="SAM^1:ACCESSION#;2:PATIENT NAME" D HELP3^WVLABLG2
"RTN","WVLABLG",84,0)
 D ^DIR
"RTN","WVLABLG",85,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVLABLG",86,0)
 S WVC=Y
"RTN","WVLABLG",87,0)
 Q
"RTN","WVLABLG",88,0)
 ;
"RTN","WVLABLG",89,0)
DEVICE ;EP
"RTN","WVLABLG",90,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVLABLG",91,0)
 S ZTRTN="DEQUEUE^WVLABLG"
"RTN","WVLABLG",92,0)
 F WVSV="A","B","C","BEGDT","ENDDT","FAC" D
"RTN","WVLABLG",93,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVLABLG",94,0)
 ;---> SAVE ATTRIBUTES ARRAY. NOTE: SUBSTITUTE LOCAL ARRAY FOR WVAREA.
"RTN","WVLABLG",95,0)
 I $D(WVAREA) N N S N=0 F  S N=$O(WVAREA(N)) Q:N=""  D
"RTN","WVLABLG",96,0)
 .S ZTSAVE("WVAREA("""_N_""")")=""
"RTN","WVLABLG",97,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVLABLG",98,0)
 Q
"RTN","WVLABLG",99,0)
 ;
"RTN","WVLABLG",100,0)
SORT ;EP
"RTN","WVLABLG",101,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVLABLG",102,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVLABLG",103,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVLABLG",104,0)
 ;
"RTN","WVLABLG",105,0)
 K ^TMP("WV",$J)
"RTN","WVLABLG",106,0)
 S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999
"RTN","WVLABLG",107,0)
 S WVDATE=WVBEGDT1
"RTN","WVLABLG",108,0)
 F  S WVDATE=$O(^WV(790.1,"ADE",WVDATE)) Q:'WVDATE!(WVDATE>WVENDDT1)  D
"RTN","WVLABLG",109,0)
 .S WVIEN=0
"RTN","WVLABLG",110,0)
 .F  S WVIEN=$O(^WV(790.1,"ADE",WVDATE,WVIEN)) Q:'WVIEN  D
"RTN","WVLABLG",111,0)
 ..S Y=^WV(790.1,WVIEN,0),WVDFN=$P(Y,U,2)
"RTN","WVLABLG",112,0)
 ..;---> QUIT IF NOT DONE AT THE SELECTED FACILITY.
"RTN","WVLABLG",113,0)
 ..Q:$P(Y,U,34)'=WVFAC
"RTN","WVLABLG",114,0)
 ..;---> QUIT IF NOT ALL "ACCESSION AREAS" (PROCEDURE TYPES) AND
"RTN","WVLABLG",115,0)
 ..;---> THIS DOES NOT MATCH THE SELECTED AREA.
"RTN","WVLABLG",116,0)
 ..I '$D(WVAREA("ALL")) Q:$P(Y,U,4)=""  Q:'$D(WVAREA($P(Y,U,4)))
"RTN","WVLABLG",117,0)
 ..D STORE
"RTN","WVLABLG",118,0)
 Q
"RTN","WVLABLG",119,0)
 ;
"RTN","WVLABLG",120,0)
 ;
"RTN","WVLABLG",121,0)
STORE ;EP
"RTN","WVLABLG",122,0)
 ;--->WVDATE IS ALREADY SET FROM LL SORT ABOVE.        ;---> DATE
"RTN","WVLABLG",123,0)
 S WVCHRT=$$SSN^WVUTL1(WVDFN)                          ;---> SSN
"RTN","WVLABLG",124,0)
 S WVNAME=$$NAME^WVUTL1(WVDFN)                         ;---> NAME
"RTN","WVLABLG",125,0)
 S WVACCN=$P(Y,U)                                      ;---> ACCESSION#
"RTN","WVLABLG",126,0)
 S X=$P(Y,U,4),WVPCDN=$$PCDNAM^WVUTL6                  ;---> PROC TYPE
"RTN","WVLABLG",127,0)
 S WVDIAG=$$DIAG^WVUTL4($P(Y,U,5))                     ;---> RESULT/DIAG
"RTN","WVLABLG",128,0)
 S WVRES=$O(^WV(790.1,WVIEN,1,0))                         ;---> RESULT TEXT
"RTN","WVLABLG",129,0)
 ;---> QUIT IF DISPLAYING ONLY PROCEDURES WITH NO RESULTS.
"RTN","WVLABLG",130,0)
 Q:'WVA&($P(Y,U,5))
"RTN","WVLABLG",131,0)
 S WVPDATE=$$SLDT2^WVUTL5($P(Y,U,12))                  ;---> PROC DATE
"RTN","WVLABLG",132,0)
 S WVRCVDT=$$SLDT2^WVUTL5($P(Y,U,17))                  ;---> RCV RES DAT
"RTN","WVLABLG",133,0)
 S X=$P(Y,U,11),WVHLOC=$$HOSPLC^WVUTL6                 ;---> HOSP LOC
"RTN","WVLABLG",134,0)
 S X=$P(Y,U,7),WVPROV=$$PROV^WVUTL6                    ;---> PROVIDER
"RTN","WVLABLG",135,0)
 S X=$P(Y,U,18),WVUSER=$$PROV^WVUTL6                   ;---> ENTERED BY
"RTN","WVLABLG",136,0)
 ;
"RTN","WVLABLG",137,0)
 S X=WVCHRT_U_WVNAME_U_WVDATE_U_WVACCN_U_WVPCDN_U_WVRES_U_WVPDATE
"RTN","WVLABLG",138,0)
 S X=X_U_WVHLOC_U_WVPROV_U_WVUSER_U_WVRCVDT_U_WVDIAG_U_WVIEN
"RTN","WVLABLG",139,0)
 I WVC=1 S ^TMP("WV",$J,1,WVDATE,$P(WVACCN,"-"),$P(WVACCN,"-",2))=X Q
"RTN","WVLABLG",140,0)
 I WVC=2 S ^TMP("WV",$J,1,WVDATE,WVNAME,WVACCN)=X Q
"RTN","WVLABLG",141,0)
 Q
"RTN","WVLABLG",142,0)
 ;
"RTN","WVLABLG",143,0)
COPYGBL ;EP
"RTN","WVLABLG",144,0)
 ;---> COPY ^TMP("WV",$J,1 TO ^TMP("WV",$J,2 TO MAKE IT FLAT.
"RTN","WVLABLG",145,0)
 N I,M,N,P,Q
"RTN","WVLABLG",146,0)
 S N=0,I=0
"RTN","WVLABLG",147,0)
 F  S N=$O(^TMP("WV",$J,1,N)) Q:N=""  D
"RTN","WVLABLG",148,0)
 .S M=0
"RTN","WVLABLG",149,0)
 .F  S M=$O(^TMP("WV",$J,1,N,M)) Q:M=""  D
"RTN","WVLABLG",150,0)
 ..S P=0
"RTN","WVLABLG",151,0)
 ..F  S P=$O(^TMP("WV",$J,1,N,M,P)) Q:P=""  D
"RTN","WVLABLG",152,0)
 ...S I=I+1,^TMP("WV",$J,2,I)=^TMP("WV",$J,1,N,M,P)
"RTN","WVLABLG",153,0)
 Q
"RTN","WVLABLG",154,0)
 ;
"RTN","WVLABLG",155,0)
DEQUEUE ;EP
"RTN","WVLABLG",156,0)
 ;---> TASKMAN QUEUE OF PRINTOUT.
"RTN","WVLABLG",157,0)
 D SETVARS^WVUTL5,SORT,COPYGBL,^WVLABLG1,EXIT
"RTN","WVLABLG",158,0)
 Q
"RTN","WVLABLG1")
0^69^B8011731
"RTN","WVLABLG1",1,0)
WVLABLG1 ;HCIOFO/FT IHS/ANMC/MWR - DISPLAY LAB LOG; ;9/29/98  12:37
"RTN","WVLABLG1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVLABLG1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLABLG1",4,0)
 ;;  DISPLAY CODE FOR LAB LOG.  CALLED BY WVLABLG.
"RTN","WVLABLG1",5,0)
 ;
"RTN","WVLABLG1",6,0)
DISPLAY ;EP
"RTN","WVLABLG1",7,0)
 ;---> WVCONF=DISPLAY "CONFIDENTIAL PT INFO" BANNER.
"RTN","WVLABLG1",8,0)
 ;---> WVTITLE=TITLE AT TOP OF DISPLAY HEADER.
"RTN","WVLABLG1",9,0)
 ;---> WVSUBH=CODE TO EXECUTE FOR SUBHEADER (COLUMN TITLES).
"RTN","WVLABLG1",10,0)
 ;---> WVCODE=CODE TO EXECUTE AS 3RD PIECE OF DIR(0) (AFTER DIR READ).
"RTN","WVLABLG1",11,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (ALLOWS SELECTIONS TO EDIT).
"RTN","WVLABLG1",12,0)
 ;---> WVPRMT(1,Q)=PROMPTS FOR DIR.
"RTN","WVLABLG1",13,0)
 ;
"RTN","WVLABLG1",14,0)
 N WVTITLE,WVTITLE1,N,Y S:WVB WVCONF=1
"RTN","WVLABLG1",15,0)
 U IO
"RTN","WVLABLG1",16,0)
 D
"RTN","WVLABLG1",17,0)
 .I 'WVB S WVTITLE1="TOTALS" Q
"RTN","WVLABLG1",18,0)
 .I WVC=1 S WVTITLE1="LISTED BY ACCESSION#" Q
"RTN","WVLABLG1",19,0)
 .I WVC=2 S WVTITLE1="LISTED BY PATIENT" Q
"RTN","WVLABLG1",20,0)
 .S WVTITLE="UNKNOWN REPORT"
"RTN","WVLABLG1",21,0)
 S WVTITLE="* * *  WOMEN'S HEALTH: LAB LOG "_WVTITLE1_"  * * *"
"RTN","WVLABLG1",22,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVLABLG1",23,0)
 S WVSUBH="SUBHEAD^WVLABLG1"
"RTN","WVLABLG1",24,0)
 D TOPHEAD^WVUTL7
"RTN","WVLABLG1",25,0)
 S (WVPOP,N)=0
"RTN","WVLABLG1",26,0)
NOMATCH ;EP
"RTN","WVLABLG1",27,0)
 ;---> QUIT IF NO RECORDS MATCH.
"RTN","WVLABLG1",28,0)
 I '$D(^TMP("WV",$J,1)) D  Q
"RTN","WVLABLG1",29,0)
 .D HEADER3^WVUTL7
"RTN","WVLABLG1",30,0)
 .W !!?5,"No records match the selected criteria.",!
"RTN","WVLABLG1",31,0)
 .I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVLABLG1",32,0)
 .D ^%ZISC S WVPOP=1
"RTN","WVLABLG1",33,0)
 ;
"RTN","WVLABLG1",34,0)
 D:WVB DISPLAY1
"RTN","WVLABLG1",35,0)
 I WVPOP D
"RTN","WVLABLG1",36,0)
 .W !?5,"Because you have entered ^, the remainder of the individual"
"RTN","WVLABLG1",37,0)
 .W !?5,"procedures will not be displayed.  The totals that follow,"
"RTN","WVLABLG1",38,0)
 .W !?5,"however, are accurate for the selected date range."
"RTN","WVLABLG1",39,0)
 I 'WVB K WVSUBH D HEADER3^WVUTL7
"RTN","WVLABLG1",40,0)
 D TOTALS,END
"RTN","WVLABLG1",41,0)
 Q
"RTN","WVLABLG1",42,0)
 ;
"RTN","WVLABLG1",43,0)
 ;
"RTN","WVLABLG1",44,0)
DISPLAY1 ;EP
"RTN","WVLABLG1",45,0)
 D HEADER3^WVUTL7
"RTN","WVLABLG1",46,0)
 F  S N=$O(^TMP("WV",$J,2,N)) Q:'N!(WVPOP)  D
"RTN","WVLABLG1",47,0)
 .I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVLABLG1",48,0)
 ..S WVPAGE=WVPAGE+1
"RTN","WVLABLG1",49,0)
 ..D HEADER3^WVUTL7
"RTN","WVLABLG1",50,0)
 .S Y=^TMP("WV",$J,2,N),M=N
"RTN","WVLABLG1",51,0)
 .W !,$$SLDT2^WVUTL5($P(Y,U,3))
"RTN","WVLABLG1",52,0)
 .W ?9,$P(Y,U,4)
"RTN","WVLABLG1",53,0)
 .W ?21,$E($P(Y,U,2),1,18)
"RTN","WVLABLG1",54,0)
 .W ?41,$P(Y,U)
"RTN","WVLABLG1",55,0)
 .W ?53,$E($P(Y,U,8),1,10)
"RTN","WVLABLG1",56,0)
 .W ?65,$E($P(Y,U,9),1,14)
"RTN","WVLABLG1",57,0)
 .W !?9,"Date of ",$E($P(Y,U,5),1,23),": ",$P(Y,U,7)
"RTN","WVLABLG1",58,0)
 .W ?53,"Entered by: ",$E($P(Y,U,10),1,14)
"RTN","WVLABLG1",59,0)
 .W !?43,"Res/Diag: ",?53,$E($P(Y,U,12),1,26)
"RTN","WVLABLG1",60,0)
 .W !,WVLINE
"RTN","WVLABLG1",61,0)
 Q
"RTN","WVLABLG1",62,0)
 ;
"RTN","WVLABLG1",63,0)
TOTALS ;EP
"RTN","WVLABLG1",64,0)
 N N,R S (N,R)=0
"RTN","WVLABLG1",65,0)
 I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVLABLG1",66,0)
 .S WVPAGE=WVPAGE+1 K WVSUBH
"RTN","WVLABLG1",67,0)
 .D HEADER3^WVUTL7
"RTN","WVLABLG1",68,0)
 ;
"RTN","WVLABLG1",69,0)
 F  S N=$O(^TMP("WV",$J,2,N)) Q:'N  D
"RTN","WVLABLG1",70,0)
 .S M=N S:($P(^TMP("WV",$J,2,N),U,12)="NOT ENTERED") R=R+1
"RTN","WVLABLG1",71,0)
 W !?4,"*"
"RTN","WVLABLG1",72,0)
 W ?10,"TOTAL PROCEDURES: ",M,?37,"PROCEDURES WITHOUT RESULTS: ",R
"RTN","WVLABLG1",73,0)
 W ?75,"*"
"RTN","WVLABLG1",74,0)
 W !,WVLINE
"RTN","WVLABLG1",75,0)
 Q
"RTN","WVLABLG1",76,0)
 ;
"RTN","WVLABLG1",77,0)
END ;EP
"RTN","WVLABLG1",78,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3
"RTN","WVLABLG1",79,0)
 D ^%ZISC
"RTN","WVLABLG1",80,0)
 Q
"RTN","WVLABLG1",81,0)
 ;
"RTN","WVLABLG1",82,0)
SUBHEAD ;EP
"RTN","WVLABLG1",83,0)
 ;---> SUB HEADER FOR PROCEDURE BROWSE OUTPUT.
"RTN","WVLABLG1",84,0)
 W !,"DATE",?9,"ACCESSION#",?21,"PATIENT"
"RTN","WVLABLG1",85,0)
 W ?41,$$PNLB^WVUTL5(),?53,"LOCATION",?65,"PROVIDER",!
"RTN","WVLABLG1",86,0)
 W $$REPEAT^XLFSTR("=",80)
"RTN","WVLABLG1",87,0)
 Q
"RTN","WVLABLG2")
0^70^B4033277
"RTN","WVLABLG2",1,0)
WVLABLG2 ;HCIOFO/FT IHS/ANMC/MWR - DISPLAY LAB LOG; ;8/19/98  15:43
"RTN","WVLABLG2",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVLABLG2",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLABLG2",4,0)
 ;;  HELP PROMPTS FOR DISPLAYING LAB LOG.  CALLED BY WVLABLG.
"RTN","WVLABLG2",5,0)
 ;
"RTN","WVLABLG2",6,0)
HELP1 ;EP
"RTN","WVLABLG2",7,0)
 ;;Answer "ALL" to display ALL Procedures for the selected date range.
"RTN","WVLABLG2",8,0)
 ;;Answer "NO" to display only those Procedures that at this time
"RTN","WVLABLG2",9,0)
 ;;have NO RESULTS, within the selected date range.
"RTN","WVLABLG2",10,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVLABLG2",11,0)
 Q
"RTN","WVLABLG2",12,0)
 ;
"RTN","WVLABLG2",13,0)
HELP2 ;EP
"RTN","WVLABLG2",14,0)
 ;;Answer "EACH" to display the data for each individual Procedure,
"RTN","WVLABLG2",15,0)
 ;;in other words, show date, accession#, name, chart#, provider, etc.
"RTN","WVLABLG2",16,0)
 ;;Answer "TOTALS" to display only the total counts, in other words,
"RTN","WVLABLG2",17,0)
 ;;show only the number procedures with no results and the total
"RTN","WVLABLG2",18,0)
 ;;number of procedures (for the selected date range).
"RTN","WVLABLG2",19,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVLABLG2",20,0)
 Q
"RTN","WVLABLG2",21,0)
 ;
"RTN","WVLABLG2",22,0)
HELP3 ;EP
"RTN","WVLABLG2",23,0)
 ;;Answer "ACCESSION#" to display Procedures in order of ACCESSION#,
"RTN","WVLABLG2",24,0)
 ;;in other words, earliest ACCESSION# first.
"RTN","WVLABLG2",25,0)
 ;;Answer "PATIENT NAME" to display Procedures alphabetically by
"RTN","WVLABLG2",26,0)
 ;;patient name.
"RTN","WVLABLG2",27,0)
 S WVTAB=5,WVLINL="HELP3" D HELPTX
"RTN","WVLABLG2",28,0)
 Q
"RTN","WVLABLG2",29,0)
 ;
"RTN","WVLABLG2",30,0)
HELPTX ;EP
"RTN","WVLABLG2",31,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVLABLG2",32,0)
 N I,T,X S T="" F I=1:1:WVTAB S T=T_" "
"RTN","WVLABLG2",33,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVLABLG2",34,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVLABLG2",35,0)
 Q
"RTN","WVLETDQ")
0^19^B4180335
"RTN","WVLETDQ",1,0)
WVLETDQ ;HCIOFO/FT,JR IHS/ANMC/MWR - PRINT QUEUED LETTERS;
"RTN","WVLETDQ",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVLETDQ",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLETDQ",4,0)
 ;;  CALLED BY OPTION: "WV PRINT QUEUED LETTERS" TO PRINT LETTERS
"RTN","WVLETDQ",5,0)
 ;;  BY "APRT" XREF IN ^WV(790.4,"APRT".
"RTN","WVLETDQ",6,0)
 ;
"RTN","WVLETDQ",7,0)
START ;EP
"RTN","WVLETDQ",8,0)
 D SETUP G:WVPOP EXIT
"RTN","WVLETDQ",9,0)
 D DEVICE G:WVPOP EXIT
"RTN","WVLETDQ",10,0)
 D PRINT
"RTN","WVLETDQ",11,0)
 ;
"RTN","WVLETDQ",12,0)
EXIT ;EP
"RTN","WVLETDQ",13,0)
 D ^%ZISC
"RTN","WVLETDQ",14,0)
 D KILLALL^WVUTL8
"RTN","WVLETDQ",15,0)
 Q
"RTN","WVLETDQ",16,0)
 ;
"RTN","WVLETDQ",17,0)
SETUP ;EP
"RTN","WVLETDQ",18,0)
 D SETVARS^WVUTL5 S WVPOP=0 K DIR
"RTN","WVLETDQ",19,0)
 S WVDUZ2=$G(DUZ(2))
"RTN","WVLETDQ",20,0)
 D TITLE^WVUTL5("PRINT QUEUED PATIENT LETTERS")
"RTN","WVLETDQ",21,0)
 I '$D(^WV(790.4,"APRT")) D  S WVPOP=1
"RTN","WVLETDQ",22,0)
 .S WVTITLE="* There are no letters waiting to be printed. *"
"RTN","WVLETDQ",23,0)
 .D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVLETDQ",24,0)
 .W !!!!,WVTITLE,!!
"RTN","WVLETDQ",25,0)
 .D DIRZ^WVUTL3
"RTN","WVLETDQ",26,0)
 Q
"RTN","WVLETDQ",27,0)
 ;
"RTN","WVLETDQ",28,0)
DEVICE ;EP
"RTN","WVLETDQ",29,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVLETDQ",30,0)
 K %ZIS,IOP
"RTN","WVLETDQ",31,0)
 S ZTRTN="PRINT^WVLETDQ",ZTSAVE("WVDUZ2")=""
"RTN","WVLETDQ",32,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVLETDQ",33,0)
 Q
"RTN","WVLETDQ",34,0)
 ;
"RTN","WVLETDQ",35,0)
PRINT ;EP
"RTN","WVLETDQ",36,0)
 D SETVARS^WVUTL5
"RTN","WVLETDQ",37,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVLETDQ",38,0)
 ;---> USE WVION TO PRESERVE ION WHEN PRINTING MULTIPLE LETTERS.
"RTN","WVLETDQ",39,0)
 S (WVN,WVM)=0,WVION=ION
"RTN","WVLETDQ",40,0)
 F  S WVN=$O(^WV(790.4,"APRT",WVN)) Q:'WVN!(WVPOP)!(WVN>DT)  D
"RTN","WVLETDQ",41,0)
 .S WVDA=0
"RTN","WVLETDQ",42,0)
 .F  S WVDA=$O(^WV(790.4,"APRT",WVN,WVDA)) Q:'WVDA!(WVPOP)  D
"RTN","WVLETDQ",43,0)
 ..;---> QUIT IF NOT ASSOCIATED WITH THE USER'S CURRENT FACILITY.
"RTN","WVLETDQ",44,0)
 ..N WVFACIL S WVFACIL=$P(^WV(790.4,WVDA,0),U,7)
"RTN","WVLETDQ",45,0)
 ..Q:((WVFACIL'=WVDUZ2)&(WVFACIL))
"RTN","WVLETDQ",46,0)
 ..;---> WVKDT=DATE USED TO KILL "APRT" XREF IN ^WVLETPR
"RTN","WVLETDQ",47,0)
 ..S WVKDT=WVN,ION=WVION
"RTN","WVLETDQ",48,0)
 ..D PRINT^WVLETPR
"RTN","WVLETDQ",49,0)
 ..S WVM=WVM+1 K WVKDT
"RTN","WVLETDQ",50,0)
 I 'WVM D
"RTN","WVLETDQ",51,0)
 .W !!?17,"No letters are due to be printed at this time.",!!
"RTN","WVLETDQ",52,0)
 .D:WVCRT DIRZ^WVUTL3 ;W:'WVCRT @IOF
"RTN","WVLETDQ",53,0)
 Q
"RTN","WVLETPR")
0^20^B31979205
"RTN","WVLETPR",1,0)
WVLETPR ;HCIOFO/FT,JR IHS/ANMC/MWR -  WV PRINT LETTERS.  ;8/18/98  14:30
"RTN","WVLETPR",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVLETPR",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLETPR",4,0)
 ;;  CALLED BY OPTION: "WV PRINT INDIVIDUAL LETTERS" TO PRINT A
"RTN","WVLETPR",5,0)
 ;;  LETTER FOR A SINGLE INDIVIDUAL (AS OPPOSED TO ALL THOSE QUEUED).
"RTN","WVLETPR",6,0)
 ;
"RTN","WVLETPR",7,0)
 D SETVARS^WVUTL5 S (WVPOP1,WVPOP)=0
"RTN","WVLETPR",8,0)
 N WVDA,WVTITLE
"RTN","WVLETPR",9,0)
 F  S WVPOP=0 D  Q:WVPOP1
"RTN","WVLETPR",10,0)
 .D SELECT Q:WVPOP
"RTN","WVLETPR",11,0)
 .D DEVICE Q:WVPOP
"RTN","WVLETPR",12,0)
 .S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVLETPR",13,0)
 .D PRINT
"RTN","WVLETPR",14,0)
 D ^%ZISC
"RTN","WVLETPR",15,0)
 ;
"RTN","WVLETPR",16,0)
EXIT ;EP
"RTN","WVLETPR",17,0)
 D KILLALL^WVUTL8
"RTN","WVLETPR",18,0)
 Q
"RTN","WVLETPR",19,0)
 ;
"RTN","WVLETPR",20,0)
SELECT ;EP
"RTN","WVLETPR",21,0)
 ;---> SELECT PATIENT, THEN SELECT NOTIFICATION.
"RTN","WVLETPR",22,0)
 N DIC,X,Y
"RTN","WVLETPR",23,0)
 D TITLE^WVUTL5("PRINT INDIVIDUAL PATIENT LETTERS")
"RTN","WVLETPR",24,0)
 D PATLKUP^WVUTL8(.Y)
"RTN","WVLETPR",25,0)
 I Y<0 S (WVPOP,WVPOP1)=1 Q
"RTN","WVLETPR",26,0)
 S WVDFN=+Y,X=$$NAME^WVUTL1(WVDFN)
"RTN","WVLETPR",27,0)
 D DIC^WVFMAN(790.4,"EM",.Y,"","","",X,.WVPOP)
"RTN","WVLETPR",28,0)
 I $D(DUOUT)!($D(DTOUT)) S WVPOP=1 Q
"RTN","WVLETPR",29,0)
 I Y<0 D NONE S WVPOP=1 Q
"RTN","WVLETPR",30,0)
 S WVDA=+Y
"RTN","WVLETPR",31,0)
 ;
"RTN","WVLETPR",32,0)
 ;---> IF FACILITIES OF LETTER AND USER DON'T MATCH, QUIT.
"RTN","WVLETPR",33,0)
 N WVFACIL S WVFACIL=$P(^WV(790.4,WVDA,0),U,7)
"RTN","WVLETPR",34,0)
 I ((WVFACIL'=DUZ(2))&(WVFACIL)) D TEXT1,DIRZ^WVUTL3 S WVPOP=1 Q
"RTN","WVLETPR",35,0)
 ;
"RTN","WVLETPR",36,0)
 S WVPURP=$P(^WV(790.4,WVDA,0),U,4)
"RTN","WVLETPR",37,0)
 S WVTYPE=$P(^WV(790.4,WVDA,0),U,3)
"RTN","WVLETPR",38,0)
 ;
"RTN","WVLETPR",39,0)
 ;---> CHECK IF PURPOSE HAS BEEN ENTERED.
"RTN","WVLETPR",40,0)
 I 'WVPURP D  Q
"RTN","WVLETPR",41,0)
 .W !!?5,"No Purpose has been entered for this Notification."
"RTN","WVLETPR",42,0)
 .D DIRZ^WVUTL3 S WVPOP=1 Q
"RTN","WVLETPR",43,0)
 ;
"RTN","WVLETPR",44,0)
 ;---> CHECK IF THIS PURPOSE OF NOTIFICATION HAS A LETTER.
"RTN","WVLETPR",45,0)
 I '$D(^WV(790.404,WVPURP,1,0)) D  Q
"RTN","WVLETPR",46,0)
 .W !!!?5,"No letter has been entered for this Purpose of Notification."
"RTN","WVLETPR",47,0)
 .W !?5,"Programmer information: Notification=^WV(790.4,"_WVDA_",0)."
"RTN","WVLETPR",48,0)
 .W !?5,"                         Purpose IEN=",WVPURP
"RTN","WVLETPR",49,0)
 .W !?5,"                         Patient IEN=",WVDFN
"RTN","WVLETPR",50,0)
 .D DIRZ^WVUTL3 S WVPOP=1 Q
"RTN","WVLETPR",51,0)
 ;
"RTN","WVLETPR",52,0)
 ;---> CHECK IF TYPE OF NOTIFICATION FOR THIS NOTIFICATION IS PRINTABLE.
"RTN","WVLETPR",53,0)
 I 'WVTYPE D CANTPRT Q
"RTN","WVLETPR",54,0)
 I '$P(^WV(790.403,WVTYPE,0),U,2) D CANTPRT Q
"RTN","WVLETPR",55,0)
 Q
"RTN","WVLETPR",56,0)
 ;
"RTN","WVLETPR",57,0)
CANTPRT ;EP
"RTN","WVLETPR",58,0)
 ;---> CAN'T PRINT THIS NOTIFICATION.
"RTN","WVLETPR",59,0)
 W !!?5,"This Type of Notification"
"RTN","WVLETPR",60,0)
 W:WVTYPE ", ",$P(^WV(790.403,WVTYPE,0),U),"," W " is not printable."
"RTN","WVLETPR",61,0)
 D DIRZ^WVUTL3 S WVPOP=1
"RTN","WVLETPR",62,0)
 Q
"RTN","WVLETPR",63,0)
 ;
"RTN","WVLETPR",64,0)
DEVICE ;EP
"RTN","WVLETPR",65,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVLETPR",66,0)
 K %ZIS,IOP
"RTN","WVLETPR",67,0)
 S ZTRTN="PRINT^WVLETPR",ZTSAVE("WVDA")=""
"RTN","WVLETPR",68,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVLETPR",69,0)
 Q
"RTN","WVLETPR",70,0)
 ;
"RTN","WVLETPR",71,0)
PRINT ;EP
"RTN","WVLETPR",72,0)
 ;---> REQUIRED VARIABLE: WVDA=IEN IN ^WV(790.4, ION=DEVICE
"RTN","WVLETPR",73,0)
 ;---> NEXT LINE: IOP WILL INHIBIT ^DIWF FROM PROMPTING FOR DEVICE.
"RTN","WVLETPR",74,0)
 D SETVARS^WVUTL5
"RTN","WVLETPR",75,0)
 N WVDFN,WVPURP,IOP
"RTN","WVLETPR",76,0)
 S IOP=ION
"RTN","WVLETPR",77,0)
 ;---> IF FACILITIES OF LETTER AND USER DON'T MATCH, QUIT (IF NULL, OK).
"RTN","WVLETPR",78,0)
 N WVFACIL S WVFACIL=$P(^WV(790.4,WVDA,0),U,7)
"RTN","WVLETPR",79,0)
 I ((WVFACIL'=DUZ(2))&(WVFACIL)) D TEXT1 H 5 S WVPOP=1 Q
"RTN","WVLETPR",80,0)
 ;
"RTN","WVLETPR",81,0)
 S WVDFN=$P(^WV(790.4,WVDA,0),U)
"RTN","WVLETPR",82,0)
 S WVPURP=$P(^WV(790.4,WVDA,0),U,4)
"RTN","WVLETPR",83,0)
 ;---> WVN=DATE OF "PRINT DATE", USE TO KILL "APRT" XREF BELOW.
"RTN","WVLETPR",84,0)
 S:'$D(WVKDT) WVKDT=$P(^WV(790.4,WVDA,0),U,11)
"RTN","WVLETPR",85,0)
 ;---> IF NO PURPOSE (DELETED), KILL "APRT" XREF AND QUIT.
"RTN","WVLETPR",86,0)
 I 'WVPURP D  Q
"RTN","WVLETPR",87,0)
 .W !!?5,"No Purpose of Notification has been chosen; therefore, this"
"RTN","WVLETPR",88,0)
 .W !?5,"notification cannot be printed."
"RTN","WVLETPR",89,0)
 .D KILLXREF(WVDA,WVKDT)
"RTN","WVLETPR",90,0)
 ;---> IF QUEUED AND WVCRT IS NOT SET, THEN SET IT.
"RTN","WVLETPR",91,0)
 S:'$D(WVCRT) WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVLETPR",92,0)
 S DIWF="^WV(790.404,WVPURP,1,"
"RTN","WVLETPR",93,0)
 S DIWF(1)=790
"RTN","WVLETPR",94,0)
 S BY="INTERNAL(#.01)="_WVDFN
"RTN","WVLETPR",95,0)
 ;---> IF LOCKED, PROMPT DEVICE, QUIT AND LEAVE IN THE QUEUE.
"RTN","WVLETPR",96,0)
 L +^WV(790.4,WVDA):0 I '$T U IO D  D PROMPT Q
"RTN","WVLETPR",97,0)
 .W !!?5,"The selected Notification is being edited by another user."
"RTN","WVLETPR",98,0)
 .W !?5,"Programmer information: Notification=^WV(790.4,"_WVDA_",0)."
"RTN","WVLETPR",99,0)
 .W:'WVCRT @IOF
"RTN","WVLETPR",100,0)
 ;
"RTN","WVLETPR",101,0)
 ;---> IF PATIENT IS DECEASED, DON'T PRINT LETTER; PRINT EXPLANATION,
"RTN","WVLETPR",102,0)
 ;---> CHANGE THE STATUS OF THE NOTIFICATION TO "CLOSED", AND GIVE
"RTN","WVLETPR",103,0)
 ;---> THE OUTCOME OF "PATIENT DECEASED".
"RTN","WVLETPR",104,0)
 I $$DECEASED^WVUTL1(WVDFN) D DECEASED Q
"RTN","WVLETPR",105,0)
 ;
"RTN","WVLETPR",106,0)
 ;---> PRINT IT TO IOP, PRESERVE WVPOP.
"RTN","WVLETPR",107,0)
 D EN2^DIWF
"RTN","WVLETPR",108,0)
 D PROMPT
"RTN","WVLETPR",109,0)
 ;---> DON'T STUFF "DATE PRINTED" IF IT ALREADY HAS A "DATE PRINTED".
"RTN","WVLETPR",110,0)
 I $P(^WV(790.4,WVDA,0),U,10)]"" D KILLXREF(WVDA,WVKDT) L -^WV(790.4,WVDA) Q
"RTN","WVLETPR",111,0)
 ;
"RTN","WVLETPR",112,0)
 ;---> DON'T STUFF "DATE PRINTED" IF IT'S JUST TO THE SCREEN.
"RTN","WVLETPR",113,0)
 I WVCRT D  Q
"RTN","WVLETPR",114,0)
 .W !!?3,"NOTE: Because this letter was only displayed on a screen and"
"RTN","WVLETPR",115,0)
 .W !?9,"not printed on a printer, it will NOT yet be logged by the"
"RTN","WVLETPR",116,0)
 .W !?9,"program as having been ""PRINTED"".",!
"RTN","WVLETPR",117,0)
 .L -^WV(790.4,WVDA) D DIRZ^WVUTL3
"RTN","WVLETPR",118,0)
 ;
"RTN","WVLETPR",119,0)
 ;---> NEXT LINES KILL "APRT" XREF AND SET "DATE PRINTED"=TODAY.
"RTN","WVLETPR",120,0)
 ;---> ("APRT" XREF INDICATE A NOTIFICATION IS QUEUED TO BE PRINTED.)
"RTN","WVLETPR",121,0)
 D KILLXREF(WVDA,WVKDT)
"RTN","WVLETPR",122,0)
 D DIE^WVFMAN(790.4,".1////"_DT,WVDA)
"RTN","WVLETPR",123,0)
 L -^WV(790.4,WVDA) Q
"RTN","WVLETPR",124,0)
 Q
"RTN","WVLETPR",125,0)
 ;
"RTN","WVLETPR",126,0)
KILLXREF(WVDA,WVKDT) ;EP
"RTN","WVLETPR",127,0)
 ;---> KILL "APRT" XREF (REMOVE LETTER FROM QUEUE).
"RTN","WVLETPR",128,0)
 Q:'$G(WVDA)  Q:'$G(WVKDT)
"RTN","WVLETPR",129,0)
 K ^WV(790.4,"APRT",WVKDT,WVDA)
"RTN","WVLETPR",130,0)
 Q
"RTN","WVLETPR",131,0)
 ;
"RTN","WVLETPR",132,0)
DECEASED ;EP
"RTN","WVLETPR",133,0)
 ;---> IF THE PATIENT IS DECEASED.
"RTN","WVLETPR",134,0)
 ;---> DON'T STUFF "DATE PRINTED" IF IT'S JUST TO THE SCREEN.
"RTN","WVLETPR",135,0)
 W !!?3,"NOTE: Because this patient, ",$$NAME^WVUTL1(WVDFN)," #"
"RTN","WVLETPR",136,0)
 W $$SSN^WVUTL1(WVDFN),", is now"
"RTN","WVLETPR",137,0)
 W !?9,"registered as deceased, the letter will NOT be printed."
"RTN","WVLETPR",138,0)
 W !?9,"Instead, this notification will be given a status of CLOSED"
"RTN","WVLETPR",139,0)
 W !?9,"and an outcome of ""Patient Deceased""."
"RTN","WVLETPR",140,0)
 D:WVCRT&('$D(IO("S"))) DIRZ^WVUTL3
"RTN","WVLETPR",141,0)
 W:'WVCRT @IOF
"RTN","WVLETPR",142,0)
 S DR=".14////c;.05///Patient Deceased"
"RTN","WVLETPR",143,0)
 D DIE^WVFMAN(790.4,DR,WVDA)
"RTN","WVLETPR",144,0)
 ;---> KILL "APRT" XREF (FLAGS NOTIFICATION AS QUEUED TO BE PRINTED).
"RTN","WVLETPR",145,0)
 D KILLXREF(WVDA,WVKDT)
"RTN","WVLETPR",146,0)
 L -^WV(790.4,WVDA)
"RTN","WVLETPR",147,0)
 Q
"RTN","WVLETPR",148,0)
 ;
"RTN","WVLETPR",149,0)
PROMPT ;EP
"RTN","WVLETPR",150,0)
 ;---> PROMPT IF NECESSARY, PROMPT DEVICE.
"RTN","WVLETPR",151,0)
 D:WVCRT DIRZ^WVUTL3
"RTN","WVLETPR",152,0)
 Q
"RTN","WVLETPR",153,0)
 ;
"RTN","WVLETPR",154,0)
NONE ;EP
"RTN","WVLETPR",155,0)
 S WVTITLE="* No letters selected for printing. *"
"RTN","WVLETPR",156,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVLETPR",157,0)
 W !!!!,WVTITLE,!!
"RTN","WVLETPR",158,0)
 D DIRZ^WVUTL3
"RTN","WVLETPR",159,0)
 Q
"RTN","WVLETPR",160,0)
 ;
"RTN","WVLETPR",161,0)
TEXT1 ;EP
"RTN","WVLETPR",162,0)
 ;;
"RTN","WVLETPR",163,0)
 ;;* NOTE: The Facility with which this letter is associated does not
"RTN","WVLETPR",164,0)
 ;;        match the Facility under which you are currently logged on.
"RTN","WVLETPR",165,0)
 ;;        To print this Notification, you must either edit the Facility
"RTN","WVLETPR",166,0)
 ;;        for this Notification, or log off and log back in under the
"RTN","WVLETPR",167,0)
 ;;        same Facility with which the Notification is associated.
"RTN","WVLETPR",168,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVLETPR",169,0)
 Q
"RTN","WVLETPR",170,0)
 ;
"RTN","WVLETPR",171,0)
PRINTX ;EP
"RTN","WVLETPR",172,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVLETPR",173,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVLETPR",174,0)
 Q
"RTN","WVLOGO")
0^21^B4306931
"RTN","WVLOGO",1,0)
WVLOGO ;HCIOFO/FT,JR IHS/ANMC/MWR - DISPLAY LOGO WHEN ENTERING PKG; ;8/28/98  13:55
"RTN","WVLOGO",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVLOGO",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVLOGO",4,0)
 ;;  DISPLAYS LOGO.  GETS VERSION FROM LINE 2 OF THIS ROUTINE.
"RTN","WVLOGO",5,0)
 ;
"RTN","WVLOGO",6,0)
 D SETVARS^WVUTL5
"RTN","WVLOGO",7,0)
 N WVVER,Y
"RTN","WVLOGO",8,0)
 ;
"RTN","WVLOGO",9,0)
 S Y=$P($P($T(WVLOGO+1),";;",2),";")
"RTN","WVLOGO",10,0)
 ;
"RTN","WVLOGO",11,0)
 W @IOF
"RTN","WVLOGO",12,0)
 I '$D(DUZ(2)) D  Q
"RTN","WVLOGO",13,0)
 .W !!!,"DUZ(2) is undefined.  Contact your Site Manager.",!!
"RTN","WVLOGO",14,0)
 .D DIRZ^WVUTL3
"RTN","WVLOGO",15,0)
 W !?3,"Women's Health Main Menu v",Y,?55,$E($P(^DIC(4,DUZ(2),0),U),1,24)
"RTN","WVLOGO",16,0)
 Q
"RTN","WVLOGO",17,0)
 ;
"RTN","WVLOGO",18,0)
CHECK ;EP
"RTN","WVLOGO",19,0)
 ;---> UPON ENTRY VIA MAIN MENU (OR LAB DATA ENTRY MENU), CHECKS TO
"RTN","WVLOGO",20,0)
 ;---> SEE THAT USER'S DUZ(2) IS SET UP AS A PACKAGE SITE.
"RTN","WVLOGO",21,0)
 I '$G(DUZ(2)) D WARN D  D CHKOUT Q
"RTN","WVLOGO",22,0)
 .W !?5,"Your DUZ(2) variable is not defined."
"RTN","WVLOGO",23,0)
 I '$D(^WV(790.02,DUZ(2),0)) D WARN D  D CHKOUT Q
"RTN","WVLOGO",24,0)
 .W !?5,"Women's Health Site Parameters have NOT been set for the site"
"RTN","WVLOGO",25,0)
 .W !?5,"you are logged on as: ",$P(^DIC(4,DUZ(2),0),U)
"RTN","WVLOGO",26,0)
 Q
"RTN","WVLOGO",27,0)
 ;
"RTN","WVLOGO",28,0)
WARN ;EP
"RTN","WVLOGO",29,0)
 W @IOF,!!?35,"WARNING",!?34,"---------",!!
"RTN","WVLOGO",30,0)
 Q
"RTN","WVLOGO",31,0)
CHKOUT ;EP
"RTN","WVLOGO",32,0)
 W !!?5,"At this point you should back out of the Women's Health"
"RTN","WVLOGO",33,0)
 W !?5,"package and contact your site manager or the person in charge"
"RTN","WVLOGO",34,0)
 W !?5,"of the Women's Health Software.",!
"RTN","WVLOGO",35,0)
 I $D(^XUSEC("WVZ MANAGER",DUZ)) D
"RTN","WVLOGO",36,0)
 .W !?5,"Or, if you wish to set up site parameters for this site,"
"RTN","WVLOGO",37,0)
 .W !?5,"you may proceed to the Edit Site Parameters option and enter"
"RTN","WVLOGO",38,0)
 .W !?5,"parameters for this site.  (Synonyms: MF-->FM-->ESP)",!
"RTN","WVLOGO",39,0)
 D DIRZ^WVUTL3
"RTN","WVLOGO",40,0)
 Q
"RTN","WVMGRP")
0^23^B8254083
"RTN","WVMGRP",1,0)
WVMGRP ;HCIOFO/FT,JR IHS/ANMC/MWR - MANAGER'S PATIENT EDITS ;7/29/98  16:44
"RTN","WVMGRP",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVMGRP",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVMGRP",4,0)
 ;;  CALLED BY DIFFERENT OPTIONS TO EDIT A PATIENT'S PAP REGIMEN LOG
"RTN","WVMGRP",5,0)
 ;;  AND PREGNANCY LOG.
"RTN","WVMGRP",6,0)
 ;
"RTN","WVMGRP",7,0)
PLOG ;EP
"RTN","WVMGRP",8,0)
 ;---> CALLED BY OPTION: "WV EDIT PAP REGIMEN LOG".
"RTN","WVMGRP",9,0)
 D SETVARS^WVUTL5
"RTN","WVMGRP",10,0)
 N A,DR,Y
"RTN","WVMGRP",11,0)
 F  D  Q:$G(Y)<0
"RTN","WVMGRP",12,0)
 .D TITLE^WVUTL5("EDIT PAP REGIMEN LOG")
"RTN","WVMGRP",13,0)
 .D PLOGTX W !
"RTN","WVMGRP",14,0)
 .S A="   Select PATIENT (or Enter a new BEGIN DATE): "
"RTN","WVMGRP",15,0)
 .D DIC^WVFMAN(790.04,"QEMAL",.Y,A)
"RTN","WVMGRP",16,0)
 .Q:Y<0  K WVJR
"RTN","WVMGRP",17,0)
 .I $P($G(^WV(790.04,+Y,0)),U,2)="" S WVJR=+Y,DIK="^WV(790.04," D DEL Q
"RTN","WVMGRP",18,0)
 .D NAME("^WV(790.04,",+Y)
"RTN","WVMGRP",19,0)
 .S DR=".01;.03"
"RTN","WVMGRP",20,0)
 .D DIE^WVFMAN(790.04,DR,+Y,.WVPOP)
"RTN","WVMGRP",21,0)
 .S:WVPOP Y=-1
"RTN","WVMGRP",22,0)
 .Q
"RTN","WVMGRP",23,0)
 K WVJR
"RTN","WVMGRP",24,0)
 D EXIT
"RTN","WVMGRP",25,0)
 Q
"RTN","WVMGRP",26,0)
DEL ; Delete File 790.04 or 790.05 entry if no patient
"RTN","WVMGRP",27,0)
 S DA=WVJR D ^DIK D
"RTN","WVMGRP",28,0)
 .W !!?10,"****  Patient Name Required  ---  Entry Deleted  ****",!!
"RTN","WVMGRP",29,0)
 D DIRZ^WVUTL3 Q
"RTN","WVMGRP",30,0)
 ;
"RTN","WVMGRP",31,0)
PLOGTX ;EP
"RTN","WVMGRP",32,0)
 ;;WARNING: If you edit the "BEGIN DATE:" of an entry in the PAP REGIMEN
"RTN","WVMGRP",33,0)
 ;;         Log, be SURE that another entry with the same "BEGIN DATE:"
"RTN","WVMGRP",34,0)
 ;;         does not already exist for this patient.
"RTN","WVMGRP",35,0)
 ;;
"RTN","WVMGRP",36,0)
 ;;         (Ordinarily, the program checks this and will not allow
"RTN","WVMGRP",37,0)
 ;;         two separate entries for the same patient on the same
"RTN","WVMGRP",38,0)
 ;;         "BEGIN DATE:".  But under this option you, as the Manager,
"RTN","WVMGRP",39,0)
 ;;         have greater edit capability.)
"RTN","WVMGRP",40,0)
 S WVTAB=5,WVLINL="PLOGTX" D PRINTX
"RTN","WVMGRP",41,0)
 Q
"RTN","WVMGRP",42,0)
 ;
"RTN","WVMGRP",43,0)
 ;
"RTN","WVMGRP",44,0)
EDC ;EP
"RTN","WVMGRP",45,0)
 ;---> CALLED BY OPTION: "WV EDIT PREGNANCY LOG".
"RTN","WVMGRP",46,0)
 D SETVARS^WVUTL5
"RTN","WVMGRP",47,0)
 N A,DR,Y
"RTN","WVMGRP",48,0)
 F  D  Q:$G(Y)<0
"RTN","WVMGRP",49,0)
 .D TITLE^WVUTL5("EDIT PREGNANCY LOG")
"RTN","WVMGRP",50,0)
 .S A="   Select PATIENT (or Enter a new DATE): "
"RTN","WVMGRP",51,0)
 .D DIC^WVFMAN(790.05,"QEMAL",.Y,A)
"RTN","WVMGRP",52,0)
 .Q:Y<0  K WVJR
"RTN","WVMGRP",53,0)
 .I $P($G(^WV(790.05,+Y,0)),U,2)="" S WVJR=+Y,DIK="^WV(790.05," D DEL Q
"RTN","WVMGRP",54,0)
 .D NAME("^WV(790.05,",+Y)
"RTN","WVMGRP",55,0)
 .S DR=".01;.03;.04"
"RTN","WVMGRP",56,0)
 .D DIE^WVFMAN(790.05,DR,+Y,.WVPOP)
"RTN","WVMGRP",57,0)
 .S:WVPOP Y=-1
"RTN","WVMGRP",58,0)
 .Q
"RTN","WVMGRP",59,0)
 K WVJR
"RTN","WVMGRP",60,0)
 D EXIT
"RTN","WVMGRP",61,0)
 Q
"RTN","WVMGRP",62,0)
 ;
"RTN","WVMGRP",63,0)
EXIT ;EP
"RTN","WVMGRP",64,0)
 W @IOF
"RTN","WVMGRP",65,0)
 D KILLALL^WVUTL8
"RTN","WVMGRP",66,0)
 Q
"RTN","WVMGRP",67,0)
 ;
"RTN","WVMGRP",68,0)
PRINTX ;EP
"RTN","WVMGRP",69,0)
 ;---> PRINTS TEXT.
"RTN","WVMGRP",70,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVMGRP",71,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVMGRP",72,0)
 Q
"RTN","WVMGRP",73,0)
 ;
"RTN","WVMGRP",74,0)
NAME(DIC,Y) ;EP
"RTN","WVMGRP",75,0)
 N WVDFN
"RTN","WVMGRP",76,0)
 S WVDFN=$P(@(DIC_Y_",0)"),U,2)
"RTN","WVMGRP",77,0)
 W !!?3,$$NAME^WVUTL1(WVDFN),"   ",$$SSN^WVUTL1(WVDFN),!
"RTN","WVMGRP",78,0)
 Q
"RTN","WVMGRP",79,0)
 ;
"RTN","WVMGRP",80,0)
 ;
"RTN","WVMGRP",81,0)
NONE ;EP
"RTN","WVMGRP",82,0)
 S WVTITLE="* There are no PAP Regimen Log entries for this patient. *"
"RTN","WVMGRP",83,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVMGRP",84,0)
 W !!!!,WVTITLE,!!
"RTN","WVMGRP",85,0)
 D DIRZ^WVUTL3
"RTN","WVMGRP",86,0)
 Q
"RTN","WVNOTIF")
0^24^B20488699
"RTN","WVNOTIF",1,0)
WVNOTIF ;HCIOFO/FT,JR IHS/ANMC/MWR - WV ADD/EDIT WV NOTIFICATIONS; ;7/30/98  11:17
"RTN","WVNOTIF",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVNOTIF",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVNOTIF",4,0)
 ;;  CALLED BY DIFFERENT OPTIONS TO ADD/EDIT NOTIFICATIONS.
"RTN","WVNOTIF",5,0)
 ;
"RTN","WVNOTIF",6,0)
 ;
"RTN","WVNOTIF",7,0)
ADD ;EP
"RTN","WVNOTIF",8,0)
 ;---> CALLED BY OPTION: "WV ADD A NEW NOTIFICATION".
"RTN","WVNOTIF",9,0)
 D SETVARS^WVUTL5
"RTN","WVNOTIF",10,0)
 D TITLE^WVUTL5("ADD NEW NOTIFICATION")
"RTN","WVNOTIF",11,0)
 D PATLKUP^WVUTL8(.Y)
"RTN","WVNOTIF",12,0)
 D:Y>0 NEW(+Y)
"RTN","WVNOTIF",13,0)
 D EXIT
"RTN","WVNOTIF",14,0)
 Q
"RTN","WVNOTIF",15,0)
 ;
"RTN","WVNOTIF",16,0)
 ;
"RTN","WVNOTIF",17,0)
EDIT ;EP
"RTN","WVNOTIF",18,0)
 ;---> CALLED BY OPTION: "WV EDIT NOTIFICATION".
"RTN","WVNOTIF",19,0)
 ;---> EDIT AN EXISTING NOTIFICATION.
"RTN","WVNOTIF",20,0)
 D SETVARS^WVUTL5
"RTN","WVNOTIF",21,0)
 N Y
"RTN","WVNOTIF",22,0)
 D TITLE^WVUTL5("EDIT A NOTIFICATION")
"RTN","WVNOTIF",23,0)
 D DIC^WVFMAN(790.4,"QEMA",.Y,"   Select PATIENT: ")
"RTN","WVNOTIF",24,0)
 G:Y<0 EXIT
"RTN","WVNOTIF",25,0)
 D EDIT2(+Y),EXIT
"RTN","WVNOTIF",26,0)
 Q
"RTN","WVNOTIF",27,0)
 ;
"RTN","WVNOTIF",28,0)
EXIT ;EP
"RTN","WVNOTIF",29,0)
 D KILLALL^WVUTL8
"RTN","WVNOTIF",30,0)
 Q
"RTN","WVNOTIF",31,0)
 ;
"RTN","WVNOTIF",32,0)
 ;
"RTN","WVNOTIF",33,0)
NEW(WVDFN,WVACCN) ;EP
"RTN","WVNOTIF",34,0)
 ;---> STUFF NEW ENTRY IN WV NOTIFICATION FILE, .01=DFN.
"RTN","WVNOTIF",35,0)
 ;---> REQUIRED VARIABLE: WVDFN=IEN OF WV PATIENT, FILE 790.
"RTN","WVNOTIF",36,0)
 ;---> OPTIONAL VARIABLE: WVACCN=ACCESSION# FOR PROCEDURE.
"RTN","WVNOTIF",37,0)
 I $$DECEASED^WVUTL1(WVDFN) D  Q
"RTN","WVNOTIF",38,0)
 .W !!?5,"This patient is registered as deceased." D DIRZ^WVUTL3
"RTN","WVNOTIF",39,0)
 N DA,DIC,X
"RTN","WVNOTIF",40,0)
 S X=WVDFN K DD,DO
"RTN","WVNOTIF",41,0)
 S DIC="^WV(790.4,",DIC(0)="ML",DLAYGO=790
"RTN","WVNOTIF",42,0)
 S DIC("DR")=".02///T;.06///"_$S($D(WVACCN):$P(WVACCN,","),1:"")
"RTN","WVNOTIF",43,0)
 S DIC("DR")=DIC("DR")_";.07////"_$G(DUZ(2))
"RTN","WVNOTIF",44,0)
 D FILE^DICN K DD,DO,DIC
"RTN","WVNOTIF",45,0)
 ;---> IF Y<0, CHECK PERMISSIONS.
"RTN","WVNOTIF",46,0)
 I Y<0 D ERROR1 Q
"RTN","WVNOTIF",47,0)
 D EDIT2(+Y)
"RTN","WVNOTIF",48,0)
 Q
"RTN","WVNOTIF",49,0)
 ;
"RTN","WVNOTIF",50,0)
 ;
"RTN","WVNOTIF",51,0)
EDIT2(DA) ;EP - FROM WVBRNOT2
"RTN","WVNOTIF",52,0)
 ;---> REQUIRED VARIABLES: DA=IEN IN ^WV(790.4,.
"RTN","WVNOTIF",53,0)
 N WVDA D SETVARS^WVUTL5
"RTN","WVNOTIF",54,0)
 S WVDFN=$P(^WV(790.4,DA,0),U)
"RTN","WVNOTIF",55,0)
 D SCREEN(DA,WVDFN,.WVPOP)
"RTN","WVNOTIF",56,0)
 Q:WVPOP
"RTN","WVNOTIF",57,0)
 I $G(DA) S WVDA=DA D PRINTNOW
"RTN","WVNOTIF",58,0)
 ;---> OPPORTUNITY TO EDIT PATIENT'S CASE DATA.
"RTN","WVNOTIF",59,0)
 ;---> IF $D(WVLOOP), NEW (ABOVE) WAS CALLED FROM CASEDATA^WVPATE,
"RTN","WVNOTIF",60,0)
 ;---> SO DON'T LOOP THROUGH AGAIN.
"RTN","WVNOTIF",61,0)
 D:'$D(WVLOOP) CASEDATA^WVPATE(WVDFN)
"RTN","WVNOTIF",62,0)
 Q
"RTN","WVNOTIF",63,0)
 ;
"RTN","WVNOTIF",64,0)
 ;
"RTN","WVNOTIF",65,0)
SCREEN(DA,WVDFN,WVPOP) ;EP
"RTN","WVNOTIF",66,0)
 ;---> EDIT WITH SCREENMAN.
"RTN","WVNOTIF",67,0)
 ;---> NEEDS WVDFN FOR SCREEN ON ACCESSION# FIELD LOOKUP.
"RTN","WVNOTIF",68,0)
 S DDSFILE=790.4,DR="[WV NOTIF-FORM-1]",WVPOP=0
"RTN","WVNOTIF",69,0)
 ;---> IF THIS NOTIFICATION HAS ALREADY BEEN PRINTED, THEN DISALLOW
"RTN","WVNOTIF",70,0)
 ;---> THE USER TO EDIT MOST FIELDS BY USING FORM-2 BELOW.
"RTN","WVNOTIF",71,0)
 S:$P(^WV(790.4,DA,0),U,10) DR="[WV NOTIF-FORM-2]"
"RTN","WVNOTIF",72,0)
 D DDS^WVFMAN(DDSFILE,DR,DA,"","",.WVPOP)
"RTN","WVNOTIF",73,0)
 Q
"RTN","WVNOTIF",74,0)
 ;
"RTN","WVNOTIF",75,0)
 ;
"RTN","WVNOTIF",76,0)
PRINTNOW ;EP
"RTN","WVNOTIF",77,0)
 ;---> PRINT OR VIEW NOTIFICATION NOW, IF IT'S A LETTER.
"RTN","WVNOTIF",78,0)
 ;---> REQUIRED VARIABLE: WVDA=IEN IN ^WV(790.4,
"RTN","WVNOTIF",79,0)
 Q:'$D(WVDA)
"RTN","WVNOTIF",80,0)
 ;---> QUIT IF THIS NOTIFICATION DOES NOT HAVE A "TYPE OF NOTIFICATION".
"RTN","WVNOTIF",81,0)
 Q:'$P(^WV(790.4,WVDA,0),U,3)
"RTN","WVNOTIF",82,0)
 ;---> QUIT IF TYPE OF NOTIFICATION IS NOT PRINTABLE.
"RTN","WVNOTIF",83,0)
 Q:'$P(^WV(790.403,$P(^WV(790.4,WVDA,0),U,3),0),U,2)
"RTN","WVNOTIF",84,0)
 ;---> QUIT IF THIS NOTIFICATION HAS ALREADY BEEN PRINTED.
"RTN","WVNOTIF",85,0)
 ;Q:$P(^WV(790.4,WVDA,0),U,10) ;DISABLED FOR NOW, ALLOW VIEW OR REPRINT.
"RTN","WVNOTIF",86,0)
 F  D  Q:WVPOP  Q:$P(^WV(790.4,WVDA,0),U,10)
"RTN","WVNOTIF",87,0)
 .N WVCRT,DA,DIR
"RTN","WVNOTIF",88,0)
 .N WVPRMT,WVPRMT1,WVPRMT2,WVPRMTQ
"RTN","WVNOTIF",89,0)
 .W !!,"Do you wish to PREVIEW or PRINT this letter now?"
"RTN","WVNOTIF",90,0)
 .S DIR(0)="Y",DIR("B")="NO" D HELP2
"RTN","WVNOTIF",91,0)
 .D ^DIR K DIR W !
"RTN","WVNOTIF",92,0)
 .I $D(DIRUT)!(Y<1) S WVPOP=1 Q
"RTN","WVNOTIF",93,0)
 .;---> QUIT IF NOT ASSOCIATED WITH THE USER'S CURRENT FACILITY.
"RTN","WVNOTIF",94,0)
 .N WVFACIL S WVFACIL=$P(^WV(790.4,WVDA,0),U,7)
"RTN","WVNOTIF",95,0)
 .I ((WVFACIL'=DUZ(2))&(WVFACIL)) D  S WVPOP=1 Q
"RTN","WVNOTIF",96,0)
 ..D TEXT1^WVLETPR,DIRZ^WVUTL3
"RTN","WVNOTIF",97,0)
 .I Y D DEVICE^WVLETPR Q:WVPOP  D PRINT^WVLETPR
"RTN","WVNOTIF",98,0)
 Q
"RTN","WVNOTIF",99,0)
 ;
"RTN","WVNOTIF",100,0)
ERROR1 ;EP
"RTN","WVNOTIF",101,0)
 W !!?10,*7,"NEW NOTIFICATION ENTRY FOR THIS PATIENT FAILED."
"RTN","WVNOTIF",102,0)
 D DIRZ^WVUTL3
"RTN","WVNOTIF",103,0)
 Q
"RTN","WVNOTIF",104,0)
 ;
"RTN","WVNOTIF",105,0)
ADDNOTIF ;EP
"RTN","WVNOTIF",106,0)
 ;---> ADD NEW NOTIFICATION.
"RTN","WVNOTIF",107,0)
 ;---> AT PRESENT THIS EP IS NOT CALLED BY ANTHING.
"RTN","WVNOTIF",108,0)
 W !,"Do you wish to add a NEW Notification for this patient?"
"RTN","WVNOTIF",109,0)
 S DIR(0)="Y",DIR("B")="NO" D HELP1
"RTN","WVNOTIF",110,0)
 D ^DIR K DIR W !
"RTN","WVNOTIF",111,0)
 I Y D
"RTN","WVNOTIF",112,0)
 .N WVLOOP,DIC,DIE,Y
"RTN","WVNOTIF",113,0)
 .S Y=WVDFN,WVLOOP=1 D NEW(WVDFN)
"RTN","WVNOTIF",114,0)
 Q
"RTN","WVNOTIF",115,0)
 ;
"RTN","WVNOTIF",116,0)
HELP1 ;EP
"RTN","WVNOTIF",117,0)
 ;;Enter YES to add a NEW Notification for this patient.  If the
"RTN","WVNOTIF",118,0)
 ;;notification is a letter, the letter may be queued to print shortly
"RTN","WVNOTIF",119,0)
 ;;before the patient's next appointment by selecting an appropriate
"RTN","WVNOTIF",120,0)
 ;;"Print Date".
"RTN","WVNOTIF",121,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVNOTIF",122,0)
 Q
"RTN","WVNOTIF",123,0)
 ;
"RTN","WVNOTIF",124,0)
HELP2 ;EP
"RTN","WVNOTIF",125,0)
 ;;"Preview" allows you to look at the letter that has just been queued.
"RTN","WVNOTIF",126,0)
 ;;To preview this letter, select HOME at the "DEVICE: " prompt.
"RTN","WVNOTIF",127,0)
 ;;
"RTN","WVNOTIF",128,0)
 ;;"Print" will print the letter now (regardless of its "Print Date")
"RTN","WVNOTIF",129,0)
 ;;and remove it from the queue of letters waiting to print.
"RTN","WVNOTIF",130,0)
 ;;To print this letter now, select a printer at the "DEVICE: " prompt.
"RTN","WVNOTIF",131,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVNOTIF",132,0)
 Q
"RTN","WVNOTIF",133,0)
 ;
"RTN","WVNOTIF",134,0)
HELPTX ;EP
"RTN","WVNOTIF",135,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVNOTIF",136,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVNOTIF",137,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVNOTIF",138,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVNOTIF",139,0)
 Q
"RTN","WVNOTIF1")
0^25^B5386446
"RTN","WVNOTIF1",1,0)
WVNOTIF1 ;HCIOFO/FT,JR IHS/ANMC/MWR - WV ADD/EDIT WV NOTIFICATIONS;
"RTN","WVNOTIF1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVNOTIF1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVNOTIF1",4,0)
 ;;  STUFFS A NORMAL LETTER FOR THIS PATIENT.  CALLED BY WVNOTIF.
"RTN","WVNOTIF1",5,0)
 ;
"RTN","WVNOTIF1",6,0)
 ;
"RTN","WVNOTIF1",7,0)
NORMALL(WVDFN,WVACCN,WVSPEC,WVSPTX) ;EP
"RTN","WVNOTIF1",8,0)
 ;---> STUFF A NORMAP PAP/MAM RESULT LETTER ENTRY IN WV NOTIF FILE.
"RTN","WVNOTIF1",9,0)
 ;---> REQUIRED VARIABLES: WVDFN=IEN OF WV PATIENT (FILE 790),
"RTN","WVNOTIF1",10,0)
 ;--->                     WVACCN=ACCESSION# FOR PROCEDURE.
"RTN","WVNOTIF1",11,0)
 ;--->                     WVSPEC=1 FOR PAP, 3,4 OR 5 FOR MAM.
"RTN","WVNOTIF1",12,0)
 ;--->                     WVSPTX=TEXT OF THE SPECIAL PROCEDURE.
"RTN","WVNOTIF1",13,0)
 N WVPC,WVPURP,X
"RTN","WVNOTIF1",14,0)
 ;
"RTN","WVNOTIF1",15,0)
 I '$D(WVDFN)!('$D(WVACCN))!('$D(WVSPEC)) D  D NOLETT Q
"RTN","WVNOTIF1",16,0)
 .W !!?5,"* Patient DFN or Accession# or Special Procedure Code "
"RTN","WVNOTIF1",17,0)
 .W "undefined.",!,"  Contact Site Manager."
"RTN","WVNOTIF1",18,0)
 ;
"RTN","WVNOTIF1",19,0)
 I '$D(^WV(790.02,DUZ(2),0)) D  D NOLETT Q
"RTN","WVNOTIF1",20,0)
 .W !!?5,"* Site Parameters for ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVNOTIF1",21,0)
 .W " have not been set."
"RTN","WVNOTIF1",22,0)
 ;
"RTN","WVNOTIF1",23,0)
 ;---> FIND PIECE OF ^WV(790.02, THAT IDENTIFIES PAP/MAM NORMAL LETTER.
"RTN","WVNOTIF1",24,0)
 S WVPC=$S(WVSPEC=1:4,WVSPEC=2:8,1:0)
"RTN","WVNOTIF1",25,0)
 S WVPURP=$P(^WV(790.02,DUZ(2),0),U,WVPC)
"RTN","WVNOTIF1",26,0)
 I 'WVPURP D  D NOLETT Q
"RTN","WVNOTIF1",27,0)
 .W !!?5,"* The Normal ",WVSPTX," Result Letter is not identified in"
"RTN","WVNOTIF1",28,0)
 .W !?7,"the Site Parameter file.  Check the Site Parameter File."
"RTN","WVNOTIF1",29,0)
 ;
"RTN","WVNOTIF1",30,0)
 I '$O(^WV(790.404,WVPURP,1,0)) D  D NOLETT Q
"RTN","WVNOTIF1",31,0)
 .W !!?5,"* In the Site Parameter file, the Normal ",WVSPTX
"RTN","WVNOTIF1",32,0)
 .W " Result letter"
"RTN","WVNOTIF1",33,0)
 .W !?7,"chosen has no letter text entered.  Check the Notification "
"RTN","WVNOTIF1",34,0)
 .W !?7,"Purpose&Letter File."
"RTN","WVNOTIF1",35,0)
 ;
"RTN","WVNOTIF1",36,0)
 ;---> NOW STUFF A PAP/MAM RESULT NORMAL LETTER WITH ALL FIELDS ENTERED,
"RTN","WVNOTIF1",37,0)
 ;---> QUEUED TO BE PRINTED TODAY.
"RTN","WVNOTIF1",38,0)
 N DIC,Y
"RTN","WVNOTIF1",39,0)
 S X=WVDFN
"RTN","WVNOTIF1",40,0)
 K DD,DO S DIC="^WV(790.4,",DIC(0)="ML",DLAYGO=790
"RTN","WVNOTIF1",41,0)
 S DIC("DR")=".02///T;.03///LETTER, FIRST;.04///"_WVPURP
"RTN","WVNOTIF1",42,0)
 S DIC("DR")=DIC("DR")_";.05///"_WVSPTX_" NORMAL LETTER SENT;.06///"
"RTN","WVNOTIF1",43,0)
 S DIC("DR")=DIC("DR")_WVACCN_";.07////"_DUZ(2)_";.08///T;.11///T"
"RTN","WVNOTIF1",44,0)
 S DIC("DR")=DIC("DR")_";.13///T;.14///CLOSED"
"RTN","WVNOTIF1",45,0)
 D FILE^DICN
"RTN","WVNOTIF1",46,0)
 ;---> IF Y<0, CHECK PERMISSIONS.
"RTN","WVNOTIF1",47,0)
 D:Y<0
"RTN","WVNOTIF1",48,0)
 .W !!?5,"COULD NOT ADD NOTIFICATION, PERMISSION PROBLEM."
"RTN","WVNOTIF1",49,0)
 .W !?5,"CONTACT YOUR SITE MANAGER."  D NOLETT
"RTN","WVNOTIF1",50,0)
 Q
"RTN","WVNOTIF1",51,0)
 ;
"RTN","WVNOTIF1",52,0)
NOLETT ;EP
"RTN","WVNOTIF1",53,0)
 W !?5,"* NO LETTER QUEUED!" D DIRZ^WVUTL3
"RTN","WVNOTIF1",54,0)
 Q
"RTN","WVPATE")
0^26^B6955411
"RTN","WVPATE",1,0)
WVPATE ;HCIOFO/FT,JR IHS/ANMC/MWR -  PATIENT CASE DATA EDIT; ;8/27/98  10:59
"RTN","WVPATE",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPATE",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPATE",4,0)
 ;;  CALLED BY OPTION: "WV EDIT PATIENT CASE DATA".
"RTN","WVPATE",5,0)
 ;
"RTN","WVPATE",6,0)
 D SETVARS^WVUTL5
"RTN","WVPATE",7,0)
 F  D PATIENT Q:WVPOP
"RTN","WVPATE",8,0)
 ;
"RTN","WVPATE",9,0)
EXIT ;EP
"RTN","WVPATE",10,0)
 D KILLALL^WVUTL8
"RTN","WVPATE",11,0)
 Q
"RTN","WVPATE",12,0)
 ;
"RTN","WVPATE",13,0)
 ;
"RTN","WVPATE",14,0)
PATIENT ;EP
"RTN","WVPATE",15,0)
 D TITLE^WVUTL5("EDIT PATIENT CASE DATA")
"RTN","WVPATE",16,0)
PATIENT1 ;EP
"RTN","WVPATE",17,0)
 ;---> TO AVOID @IOF AND TITLE.
"RTN","WVPATE",18,0)
 ;---> SELECT PATIENT.
"RTN","WVPATE",19,0)
 N Y
"RTN","WVPATE",20,0)
 W !!,"   Select the patient you wish to add or edit."
"RTN","WVPATE",21,0)
 D PATLKUP^WVUTL8(.Y,"ADD")
"RTN","WVPATE",22,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVPATE",23,0)
 S WVDFN=+Y
"RTN","WVPATE",24,0)
 D SCREEN(WVDFN) S WVPOP=0
"RTN","WVPATE",25,0)
 Q
"RTN","WVPATE",26,0)
 ;
"RTN","WVPATE",27,0)
 ;
"RTN","WVPATE",28,0)
SCREEN(WVDFN) ;EP
"RTN","WVPATE",29,0)
 ;---> EDIT PATIENT CASE DATA WITH SCREENMAN.
"RTN","WVPATE",30,0)
 ;---> REQUIRED VARIABLES: WVDFN=DFN OF PATIENT.
"RTN","WVPATE",31,0)
 S WVMST=$$MSTDEF^WVUTL1A(WVDFN)
"RTN","WVPATE",32,0)
 N DR
"RTN","WVPATE",33,0)
 S DR="[WV PATIENT-FORM-1]"
"RTN","WVPATE",34,0)
 D DDS^WVFMAN(790,DR,WVDFN,"","",.WVPOP)
"RTN","WVPATE",35,0)
 Q:WVPOP
"RTN","WVPATE",36,0)
 ;Q
"RTN","WVPATE",37,0)
 N DIR W !,"Do you wish to PRINT this patient's Case Data?"
"RTN","WVPATE",38,0)
 S DIR(0)="Y",DIR("B")="NO" D ^DIR K DIR W !
"RTN","WVPATE",39,0)
 D:Y PRTCASE^WVPATP(WVDFN)
"RTN","WVPATE",40,0)
 Q
"RTN","WVPATE",41,0)
 ;
"RTN","WVPATE",42,0)
CASEDATA(WVDFN) ;EP
"RTN","WVPATE",43,0)
 ;---> CALLED AFTER ADD/EDIT OF NOTIFICATIONS.
"RTN","WVPATE",44,0)
 N DIR W !,"Do you wish to EDIT this patient's Case Data?"
"RTN","WVPATE",45,0)
 S DIR("?",1)="   Enter YES to edit this patient's Case Manager, "
"RTN","WVPATE",46,0)
 S DIR("?")="   PAP Regimen, Current Need, etc."
"RTN","WVPATE",47,0)
 S DIR(0)="Y",DIR("B")="NO" D ^DIR K DIR W !
"RTN","WVPATE",48,0)
 D:Y SCREEN(WVDFN)
"RTN","WVPATE",49,0)
 Q
"RTN","WVPATE",50,0)
 ;
"RTN","WVPATE",51,0)
AUTOADD(DFN,SITE,Y,WVPRMT) ;EP
"RTN","WVPATE",52,0)
 ;---> AUTOMATIC ADD OF A NEW PATIENT TO "WV PATIENT FILE".
"RTN","WVPATE",53,0)
 ;---> SET CASEMANAGER TO SITE PARAMETER DEFAULT.
"RTN","WVPATE",54,0)
 ;---> SET PAP TX NEED (#.11), PAP REGIMEN (#.16)="Undetermined",
"RTN","WVPATE",55,0)
 ;---> MAM TX NEED (#.18)="Undetermined".
"RTN","WVPATE",56,0)
 ;---> PARAMETERS:
"RTN","WVPATE",57,0)
 ;     1 - DFN     (REQUIRED) IEN OF PATIENT IN ^DPT(
"RTN","WVPATE",58,0)
 ;     2 - SITE    (REQUIRED) DUZ(2) FOR DEFAULT CASE MANAGER
"RTN","WVPATE",59,0)
 ;     3 - Y       (RETURNED) FROM ^DICN: IEN OR -1 FAILURE TO ADD PT
"RTN","WVPATE",60,0)
 ;     4 - WVPRMT  (OPTIONAL) EQUALS 1 IF PROMPT WHEN FAILURE
"RTN","WVPATE",61,0)
 ;
"RTN","WVPATE",62,0)
 S (DINUM,X)=DFN
"RTN","WVPATE",63,0)
 ;---> SET CASE MANAGER DEFAULT.
"RTN","WVPATE",64,0)
 N WVCMGR,DIC S WVCMGR=$S($D(SITE):$P(^WV(790.02,SITE,0),U,2),1:"")
"RTN","WVPATE",65,0)
 S:'$G(WVPRMT) WVPRMT=0
"RTN","WVPATE",66,0)
 S DIC("DR")=".1////"_WVCMGR_";.11///Undetermined;.16///Undetermined"
"RTN","WVPATE",67,0)
 S DIC("DR")=DIC("DR")_";.18///Undetermined"
"RTN","WVPATE",68,0)
 S DIC("DR")=DIC("DR")_";.21////"_DT
"RTN","WVPATE",69,0)
 S DIC("DR")=DIC("DR")_";.27////"_$$MSTAL^WVUTL1A(DFN)
"RTN","WVPATE",70,0)
 K DD,DO S DIC="^WV(790,",DIC(0)="ML",DLAYGO=790
"RTN","WVPATE",71,0)
 D FILE^DICN K DIC
"RTN","WVPATE",72,0)
 ;---> IF Y<0, CHECK PERMISSIONS.
"RTN","WVPATE",73,0)
 I Y<0,WVPRMT D  Q
"RTN","WVPATE",74,0)
 .W !!?5,"* UNABLE to add this patient to the Women's Health database."
"RTN","WVPATE",75,0)
 .W !?5,"  Please contact your site manager to check permissions."
"RTN","WVPATE",76,0)
 .D DIRZ^WVUTL3
"RTN","WVPATE",77,0)
 S Y=+Y
"RTN","WVPATE",78,0)
 Q
"RTN","WVPATE",79,0)
 ;
"RTN","WVPATP")
0^27^B18965275
"RTN","WVPATP",1,0)
WVPATP ;HCIOFO/FT,JR IHS/ANMC/MWR - Print WH Patient Case Data ;9/17/98  14:22
"RTN","WVPATP",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPATP",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPATP",4,0)
 ;;  PRINT A PATIENT'S CASE DATA.
"RTN","WVPATP",5,0)
 ;
"RTN","WVPATP",6,0)
BEGIN ;EP
"RTN","WVPATP",7,0)
 ;---> LOOP TO PRINT PATIENTS' CASE DATA.
"RTN","WVPATP",8,0)
 ;---> NOT CURRENTLY CALLED BY ANY OPTION.
"RTN","WVPATP",9,0)
 D SETVARS^WVUTL5 S WVPOP=0
"RTN","WVPATP",10,0)
 F  D  Q:$G(Y)<0
"RTN","WVPATP",11,0)
 .D TITLE^WVUTL5("PRINT A PATIENT'S CASE DATA")
"RTN","WVPATP",12,0)
 .D PATLKUP^WVUTL8(.Y) Q:Y<0  S WVDFN=+Y
"RTN","WVPATP",13,0)
 .D DEVICE
"RTN","WVPATP",14,0)
 .I WVPOP S Y=-1 Q
"RTN","WVPATP",15,0)
 .D DATA(WVDFN)
"RTN","WVPATP",16,0)
 D EXIT
"RTN","WVPATP",17,0)
 Q
"RTN","WVPATP",18,0)
 ;
"RTN","WVPATP",19,0)
PRTCASE(WVDFN) ;EP
"RTN","WVPATP",20,0)
 ;---> PRINT CASE DATA ON ONE PATIENT.
"RTN","WVPATP",21,0)
 ;---> CALLED FROM ^WVPATE (EDIT PATIENT CASE DATA).
"RTN","WVPATP",22,0)
 I '$G(WVDFN) D  D DIRZ^WVUTL3 Q
"RTN","WVPATP",23,0)
 .W !?5,"WVDFN not passed.  Please contact your site manager."
"RTN","WVPATP",24,0)
 D DEVICE Q:WVPOP
"RTN","WVPATP",25,0)
 D DATA(WVDFN)
"RTN","WVPATP",26,0)
 Q
"RTN","WVPATP",27,0)
 ;
"RTN","WVPATP",28,0)
DEVICE ;EP
"RTN","WVPATP",29,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVPATP",30,0)
 S ZTRTN="DEQUEUE^WVPATP"
"RTN","WVPATP",31,0)
 F WVSV="DFN" D
"RTN","WVPATP",32,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVPATP",33,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVPATP",34,0)
 Q
"RTN","WVPATP",35,0)
 ;
"RTN","WVPATP",36,0)
DEQUEUE ;EP
"RTN","WVPATP",37,0)
 ;---> TASKED PRINTOUT OF PATIENT CASE DATA.
"RTN","WVPATP",38,0)
 D DATA(WVDFN)
"RTN","WVPATP",39,0)
 D EXIT
"RTN","WVPATP",40,0)
 Q
"RTN","WVPATP",41,0)
 ;
"RTN","WVPATP",42,0)
DATA(WVDFN) ;EP
"RTN","WVPATP",43,0)
 ;---> SORT PROCEDURE TYPE FILE POINTERS.
"RTN","WVPATP",44,0)
 N A,WVNODE,WVTMP,I,N
"RTN","WVPATP",45,0)
 D PATVARS^WVUTL3(WVDFN)
"RTN","WVPATP",46,0)
 ;---> LOOP THROUGH WV PROCEDURE FILE.
"RTN","WVPATP",47,0)
 S I=0
"RTN","WVPATP",48,0)
 S A=WVNAMAGE
"RTN","WVPATP",49,0)
 S WVNODE="Patient Name: "_A_$$S(38-$L(A))_$$PNLAB^WVUTL5()_WVCHRT
"RTN","WVPATP",50,0)
 D NODE
"RTN","WVPATP",51,0)
 S A=$$STREET^WVUTL1(WVDFN)
"RTN","WVPATP",52,0)
 S WVNODE=$$S(6)_"Street: "_A_$$S(31-$L(A))
"RTN","WVPATP",53,0)
 S WVNODE=WVNODE_"Patient Phone: "_$$HPHONE^WVUTL1(WVDFN)
"RTN","WVPATP",54,0)
 D NODE
"RTN","WVPATP",55,0)
 S A=$$CTYSTZ^WVUTL1(WVDFN)
"RTN","WVPATP",56,0)
 S WVNODE=$$S(2)_"Cty/St/Zip: "_A_$$S(33-$L(A))
"RTN","WVPATP",57,0)
 S WVNODE=WVNODE_"Pr Provider: "_$E($$PROVI^WVUTL1A(WVDFN),1,20)
"RTN","WVPATP",58,0)
 D NODE
"RTN","WVPATP",59,0)
 S WVNODE=$$S(51)_"Veteran: "_$$VET^WVUTL1A(WVDFN)
"RTN","WVPATP",60,0)
 D NODE
"RTN","WVPATP",61,0)
 S WVNODE="         " D NODE
"RTN","WVPATP",62,0)
 S A=$E(WVCMGR,1,28)
"RTN","WVPATP",63,0)
 S WVNODE=$$S(10)_"Case Manager: "_A_$$S(29-$L(A))
"RTN","WVPATP",64,0)
 S WVNODE=WVNODE_"Inactive Date: "_$$SLDT2^WVUTL5($$INACT^WVUTL1(WVDFN))
"RTN","WVPATP",65,0)
 D NODE
"RTN","WVPATP",66,0)
 S WVNODE=$$S(8)_"Breast Tx Need: "_WVBNEED
"RTN","WVPATP",67,0)
 D NODE
"RTN","WVPATP",68,0)
 S A="" I WVDFN>0 S A=$P($G(^WV(790,WVDFN,0)),U,25),A=$S(A'="":A,1:"NOT ENTERED") S:A>0 A=$P($G(^DIC(4,A,0)),U)
"RTN","WVPATP",69,0)
 S WVNODE=$$S(7)_"Breast Facility: "_A
"RTN","WVPATP",70,0)
 D NODE
"RTN","WVPATP",71,0)
 S WVNODE=$$S(6)_"Cervical Tx Need: "_WVCNEED
"RTN","WVPATP",72,0)
 D NODE
"RTN","WVPATP",73,0)
 S A="" I WVDFN>0 S A=$P($G(^WV(790,WVDFN,0)),U,26) S A=$S(A'="":A,1:"NOT ENTERED") S:A>0 A=$P($G(^DIC(4,A,0)),U)
"RTN","WVPATP",74,0)
 S WVNODE=$$S(5)_"Cervical Facility: "_A
"RTN","WVPATP",75,0)
 D NODE
"RTN","WVPATP",76,0)
 S WVNODE=$$S(11)_"PAP Regimen: "_WVPAPRG
"RTN","WVPATP",77,0)
 D NODE S WVNODE=" " D NODE
"RTN","WVPATP",78,0)
 S WVNODE=$$S(0)_"Family Hx of Breast CA: "_$$FAMHX^WVUTL1(WVDFN)
"RTN","WVPATP",79,0)
 D NODE
"RTN","WVPATP",80,0)
 S A=$$EDC^WVUTL1(WVDFN)
"RTN","WVPATP",81,0)
 I A="",$P(^WV(790,WVDFN,0),U,13)=0 S A="NO"
"RTN","WVPATP",82,0)
 S WVNODE=$$S(3)_"Currently  Pregnant: "_A_$$S(32-$L(A))
"RTN","WVPATP",83,0)
 S WVNODE=WVNODE_"DES Daughter: "_$$DES^WVUTL1(WVDFN)
"RTN","WVPATP",84,0)
 D NODE
"RTN","WVPATP",85,0)
 S A=$$MST^WVUTL1A(WVDFN)
"RTN","WVPATP",86,0)
 S WVNODE=$$S(9)_"Sexual Trauma: "_A
"RTN","WVPATP",87,0)
 D NODE
"RTN","WVPATP",88,0)
 S A=$$ENRLDT^WVUTL1(WVDFN)
"RTN","WVPATP",89,0)
 S WVNODE=$$S(1)_"Date of 1st Encounter: "_A_$$S(29-$L(A))
"RTN","WVPATP",90,0)
 S WVNODE=WVNODE_"Referral Source: "_$$REFS^WVUTL1(WVDFN)
"RTN","WVPATP",91,0)
 D NODE S WVNODE=" " D NODE
"RTN","WVPATP",92,0)
 S WVNODE=$$S(25)_"----  Text of NOTES  ----"
"RTN","WVPATP",93,0)
 D NODE S WVNODE=" " D NODE
"RTN","WVPATP",94,0)
 S N=0
"RTN","WVPATP",95,0)
 F  S N=$O(^WV(790,WVDFN,1,N)) Q:'N  D
"RTN","WVPATP",96,0)
 .S WVNODE=^WV(790,WVDFN,1,N,0) D NODE
"RTN","WVPATP",97,0)
 S WVNODE=" " D NODE
"RTN","WVPATP",98,0)
 S WVNODE=$$S(20)_"-----  End of Patient Printout  -----" D NODE
"RTN","WVPATP",99,0)
 D DISPLAY
"RTN","WVPATP",100,0)
 Q
"RTN","WVPATP",101,0)
 ;
"RTN","WVPATP",102,0)
NODE ;EP
"RTN","WVPATP",103,0)
 ;---> SET NODE.
"RTN","WVPATP",104,0)
 S I=I+1,WVTMP("WV",$J,I,0)=WVNODE
"RTN","WVPATP",105,0)
 Q
"RTN","WVPATP",106,0)
 ;
"RTN","WVPATP",107,0)
S(S) ;EP
"RTN","WVPATP",108,0)
 ;---> SPACES.
"RTN","WVPATP",109,0)
 Q $$S^WVUTL7($G(S))
"RTN","WVPATP",110,0)
 ;
"RTN","WVPATP",111,0)
DISPLAY ;EP
"RTN","WVPATP",112,0)
 U IO
"RTN","WVPATP",113,0)
 D TOPHEAD^WVUTL7
"RTN","WVPATP",114,0)
 S WVTITLE1="* * *  WOMEN'S HEALTH: PATIENT CASE DATA PRINTOUT  * * *"
"RTN","WVPATP",115,0)
 D CENTERT^WVUTL5(.WVTITLE1)
"RTN","WVPATP",116,0)
 ;
"RTN","WVPATP",117,0)
 S (WVPOP,N,Z)=0
"RTN","WVPATP",118,0)
 W:WVCRT @IOF D HEADER
"RTN","WVPATP",119,0)
 F  S N=$O(WVTMP("WV",$J,N)) Q:'N!(WVPOP)  D
"RTN","WVPATP",120,0)
 .I $Y+5>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER
"RTN","WVPATP",121,0)
 .W !,WVTMP("WV",$J,N,0)
"RTN","WVPATP",122,0)
 I WVCRT&('WVPOP) W !! D DIRZ^WVUTL3
"RTN","WVPATP",123,0)
 D ^%ZISC
"RTN","WVPATP",124,0)
 K WVTMP("WV",$J)
"RTN","WVPATP",125,0)
 Q
"RTN","WVPATP",126,0)
 ;
"RTN","WVPATP",127,0)
HEADER ;EP
"RTN","WVPATP",128,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVPATP",129,0)
 W WVCONFF W:'WVCRT !,WVTIMLN
"RTN","WVPATP",130,0)
 W !!,WVTITLE1,?70,"page: ",WVPAGE
"RTN","WVPATP",131,0)
 W !,$$RUNDT^WVUTL1A("C")
"RTN","WVPATP",132,0)
 W !,WVLINE S WVPAGE=WVPAGE+1
"RTN","WVPATP",133,0)
 ;W !!,"Patient Name: ",WVNAMAGE,?53,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVPATP",134,0)
 Q
"RTN","WVPATP",135,0)
 ;
"RTN","WVPATP",136,0)
EXIT ;EP
"RTN","WVPATP",137,0)
 D KILLALL^WVUTL8
"RTN","WVPATP",138,0)
 Q
"RTN","WVPOST")
0^28^B10391856
"RTN","WVPOST",1,0)
WVPOST ;HCIOFO/FT-Post Installation Routine ;8/18/98  13:02
"RTN","WVPOST",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPOST",3,0)
 ;;
"RTN","WVPOST",4,0)
EN ;
"RTN","WVPOST",5,0)
 Q:'+$$VERSION^XPDUTL("BW")  ;IHS WH not installed
"RTN","WVPOST",6,0)
 D CAL
"RTN","WVPOST",7,0)
 D MST
"RTN","WVPOST",8,0)
 D ACC1
"RTN","WVPOST",9,0)
 D ACC2
"RTN","WVPOST",10,0)
 D ACC3
"RTN","WVPOST",11,0)
 D WVCHSSN
"RTN","WVPOST",12,0)
 Q
"RTN","WVPOST",13,0)
CAL ; Stuff calendar year into Type of Year field (File 790.71, .18)
"RTN","WVPOST",14,0)
 N DA,DR,DIE,WVIEN
"RTN","WVPOST",15,0)
 S WVIEN=0
"RTN","WVPOST",16,0)
 F  S WVIEN=$O(^WV(790.71,WVIEN)) Q:'WVIEN  D
"RTN","WVPOST",17,0)
 .Q:$P($G(^WV(790.71,WVIEN,0)),U,18)]""
"RTN","WVPOST",18,0)
 .S DA=WVIEN,DIE="^WV(790.71,",DR=".18///"_"C"
"RTN","WVPOST",19,0)
 .D ^DIE
"RTN","WVPOST",20,0)
 Q
"RTN","WVPOST",21,0)
MST ; Set Miltary Sexual Trauma value if present in File 2
"RTN","WVPOST",22,0)
 N DA,DR,DIE,WVIEN,WVMST
"RTN","WVPOST",23,0)
 S WVIEN=0
"RTN","WVPOST",24,0)
 F  S WVIEN=$O(^WV(790,WVIEN)) Q:'WVIEN  D
"RTN","WVPOST",25,0)
 .Q:$P($G(^WV(790,WVIEN,0)),U,27)]""
"RTN","WVPOST",26,0)
 .S WVMST=$$MSTAL^WVUTL1A(WVIEN) ;check MST STATUS in File 2
"RTN","WVPOST",27,0)
 .Q:WVMST'="M"
"RTN","WVPOST",28,0)
 .S DA=WVIEN,DIE="^WV(790,",DR=".27//"_"M"
"RTN","WVPOST",29,0)
 .D ^DIE
"RTN","WVPOST",30,0)
 Q
"RTN","WVPOST",31,0)
ACC1 ; Add first two digits to year value for ACCESSION# field (#.01)
"RTN","WVPOST",32,0)
 ; in WV PROCEDURE (790.1) file.
"RTN","WVPOST",33,0)
 N DA,DIE,DR
"RTN","WVPOST",34,0)
 S WVIEN=0
"RTN","WVPOST",35,0)
 F  S WVIEN=$O(^WV(790.1,WVIEN)) Q:'WVIEN  D
"RTN","WVPOST",36,0)
 .S WVACC=$P($G(^WV(790.1,WVIEN,0)),U,1) ;ACCESSION# e.g., MS98-1
"RTN","WVPOST",37,0)
 .Q:WVACC=""
"RTN","WVPOST",38,0)
 .S WVACCP1=$P(WVACC,"-",1)
"RTN","WVPOST",39,0)
 .S WVACCP2=$P(WVACC,"-",2)
"RTN","WVPOST",40,0)
 .S WVACCAB=$E(WVACCP1,1,2)
"RTN","WVPOST",41,0)
 .S WVACCYR=$E(WVACCP1,3,$L(WVACCP1))
"RTN","WVPOST",42,0)
 .Q:$L(WVACCYR)>2  ;accession# year is already 4 digits
"RTN","WVPOST",43,0)
 .I WVACCYR>80 S WVACCYR="19"_WVACCYR ;e.g., 1998
"RTN","WVPOST",44,0)
 .I WVACCYR<79 S WVACCYR="20"_WVACCYR ;e.g., 2001
"RTN","WVPOST",45,0)
 .S WVACC=WVACCAB_WVACCYR_"-"_WVACCP2
"RTN","WVPOST",46,0)
 .S DA=WVIEN,DR=".01///"_WVACC,DIE="^WV(790.1,"
"RTN","WVPOST",47,0)
 .D ^DIE
"RTN","WVPOST",48,0)
 .Q
"RTN","WVPOST",49,0)
 K WVACC,WVACCAB,WVACCP1,WVACCP2,WVACCYR,WVIEN,X,Y
"RTN","WVPOST",50,0)
 Q
"RTN","WVPOST",51,0)
ACC2 ; Add first two digits to year value for LAST ACCESSION# field (.06)
"RTN","WVPOST",52,0)
 ; in WV PROCEDURE TYPE (790.2) file
"RTN","WVPOST",53,0)
 N DA,DIE,DR
"RTN","WVPOST",54,0)
 S WVIEN=0
"RTN","WVPOST",55,0)
 F  S WVIEN=$O(^WV(790.2,WVIEN)) Q:'WVIEN  D
"RTN","WVPOST",56,0)
 .S WVACC=$P($G(^WV(790.2,WVIEN,0)),U,6) ;e.g., 98-1
"RTN","WVPOST",57,0)
 .Q:WVACC=""
"RTN","WVPOST",58,0)
 .S WVACCP1=$P(WVACC,"-",1)
"RTN","WVPOST",59,0)
 .S WVACCP2=$P(WVACC,"-",2)
"RTN","WVPOST",60,0)
 .Q:$L(WVACCP1)>2  ;accession# year is already 4 digits
"RTN","WVPOST",61,0)
 .I WVACCP1>80 S WVACCP1="19"_WVACCP1 ;e.g., 1998
"RTN","WVPOST",62,0)
 .I WVACCP1<79 S WVACCP1="20"_WVACCP1 ;e.g., 2001
"RTN","WVPOST",63,0)
 .S WVACC=WVACCP1_"-"_WVACCP2
"RTN","WVPOST",64,0)
 .S DA=WVIEN,DR=".06///"_WVACC,DIE="^WV(790.2,"
"RTN","WVPOST",65,0)
 .D ^DIE
"RTN","WVPOST",66,0)
 .Q
"RTN","WVPOST",67,0)
 K WVACC,WVACCP1,WVACCP2,WVIEN,X,Y
"RTN","WVPOST",68,0)
 Q
"RTN","WVPOST",69,0)
ACC3 ; Re-index C x-ref (Accession#) on Notification file (790.4)
"RTN","WVPOST",70,0)
 K ^WV(790.4,"C")
"RTN","WVPOST",71,0)
 N DIK
"RTN","WVPOST",72,0)
 S DIK="^WV(790.4,",DIK(1)=".06^C"
"RTN","WVPOST",73,0)
 D ENALL^DIK
"RTN","WVPOST",74,0)
 Q
"RTN","WVPOST",75,0)
WVCHSSN ; Change |BWCHSSN| & |CHART#| in existing form letters.
"RTN","WVPOST",76,0)
 S WVIEN=0
"RTN","WVPOST",77,0)
 F  S WVIEN=$O(^WV(790.404,WVIEN)) Q:'WVIEN  S WVLINE=0 F  S WVLINE=$O(^WV(790.404,WVIEN,1,WVLINE)) Q:'WVLINE  D
"RTN","WVPOST",78,0)
 .S WVNODE=$G(^WV(790.404,WVIEN,1,WVLINE,0)),WVFLAG=0
"RTN","WVPOST",79,0)
 .Q:WVNODE=""
"RTN","WVPOST",80,0)
 .I WVNODE["|BWCHSSN|" D
"RTN","WVPOST",81,0)
 ..S WVNEW=$P(WVNODE,"|BWCHSSN|",1)_"SSN: "_$P(WVNODE,"|BWCHSSN|",2)
"RTN","WVPOST",82,0)
 ..S WVFLAG=1
"RTN","WVPOST",83,0)
 ..S WVNODE=WVNEW
"RTN","WVPOST",84,0)
 ..Q
"RTN","WVPOST",85,0)
 .I WVNODE["|CHART#|" D
"RTN","WVPOST",86,0)
 ..S WVNEW=$P(WVNODE,"|CHART#|",1)_"|SSN#|"_$P(WVNODE,"|CHART#|",2)
"RTN","WVPOST",87,0)
 ..S WVFLAG=1
"RTN","WVPOST",88,0)
 ..S WVNODE=WVNEW
"RTN","WVPOST",89,0)
 ..Q
"RTN","WVPOST",90,0)
 .Q:'WVFLAG  ;no change(s) made
"RTN","WVPOST",91,0)
 .S ^WV(790.404,WVIEN,1,WVLINE,0)=WVNODE
"RTN","WVPOST",92,0)
 .Q
"RTN","WVPOST",93,0)
 K WVFLAG,WVIEN,WVLINE,WVNEW,WVNODE
"RTN","WVPOST",94,0)
 Q
"RTN","WVPRE")
0^30^B19221992
"RTN","WVPRE",1,0)
WVPRE ;HCIOFO/FT-Pre-Installation Routine ;9/16/98  13:06
"RTN","WVPRE",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPRE",3,0)
 ;
"RTN","WVPRE",4,0)
 Q:'+$$VERSION^XPDUTL("BW")  ;IHS WH not installed
"RTN","WVPRE",5,0)
 Q:$D(^WV(790))  ;data transfer has been done already
"RTN","WVPRE",6,0)
 D COPY
"RTN","WVPRE",7,0)
 D NAME
"RTN","WVPRE",8,0)
 D REPAIR
"RTN","WVPRE",9,0)
 D FIELDS
"RTN","WVPRE",10,0)
 D CREDIT
"RTN","WVPRE",11,0)
 Q
"RTN","WVPRE",12,0)
COPY ; Copy data from IHS files into VISTA files.
"RTN","WVPRE",13,0)
 ; Does not delete IHS data.
"RTN","WVPRE",14,0)
 D BMES^XPDUTL("Copying data from IHS files to VISTA Women's Health files.")
"RTN","WVPRE",15,0)
 M ^WV(790)=^BWP
"RTN","WVPRE",16,0)
 M ^WV(790.01)=^BWMGR
"RTN","WVPRE",17,0)
 M ^WV(790.02)=^BWSITE
"RTN","WVPRE",18,0)
 M ^WV(790.03)=^BWPR
"RTN","WVPRE",19,0)
 M ^WV(790.04)=^BWPLOG
"RTN","WVPRE",20,0)
 M ^WV(790.05)=^BWEDC
"RTN","WVPRE",21,0)
 M ^WV(790.1)=^BWPCD
"RTN","WVPRE",22,0)
 M ^WV(790.2)=^BWPN
"RTN","WVPRE",23,0)
 M ^WV(790.31)=^BWDIAG
"RTN","WVPRE",24,0)
 M ^WV(790.32)=^BWRADX
"RTN","WVPRE",25,0)
 M ^WV(790.4)=^BWNOT
"RTN","WVPRE",26,0)
 M ^WV(790.403)=^BWNOTT
"RTN","WVPRE",27,0)
 M ^WV(790.404)=^BWNOTP
"RTN","WVPRE",28,0)
 M ^WV(790.405)=^BWNOTO
"RTN","WVPRE",29,0)
 M ^WV(790.5)=^BWCUR
"RTN","WVPRE",30,0)
 M ^WV(790.51)=^BWMAMT
"RTN","WVPRE",31,0)
 M ^WV(790.6)=^BWLET
"RTN","WVPRE",32,0)
 M ^WV(790.71)=^BWSNAP
"RTN","WVPRE",33,0)
 M ^WV(790.72)=^BWAGDF
"RTN","WVPRE",34,0)
 Q
"RTN","WVPRE",35,0)
NAME ; Change file name and number on zero node
"RTN","WVPRE",36,0)
 S WVX=789.9999
"RTN","WVPRE",37,0)
 F  S WVX=$O(^WV(WVX)) Q:'WVX  D
"RTN","WVPRE",38,0)
 .S WVNODE=$G(^WV(WVX,0))
"RTN","WVPRE",39,0)
 .S WVNAME=$P(WVNODE,U,1),WVNAME="WV"_$P(WVNAME,"BW",2)
"RTN","WVPRE",40,0)
 .S $P(WVNODE,U,1)=WVNAME
"RTN","WVPRE",41,0)
 .S WVNUMBER=$P(WVNODE,U,2),WVNUMBER="790"_$P(WVNUMBER,"9002086",2)
"RTN","WVPRE",42,0)
 .S WVNUMBER=WVNUMBER_$S(WVNUMBER["s":"",1:"s")
"RTN","WVPRE",43,0)
 .S $P(WVNODE,U,2)=WVNUMBER
"RTN","WVPRE",44,0)
 .S ^WV(WVX,0)=WVNODE
"RTN","WVPRE",45,0)
 .Q
"RTN","WVPRE",46,0)
 K WVX,WVNAME,WVNODE,WVNUMBER
"RTN","WVPRE",47,0)
 Q
"RTN","WVPRE",48,0)
REPAIR ; Do data repair/clean up
"RTN","WVPRE",49,0)
 D BMES^XPDUTL("Fixing data copied from IHS Women's Health files.")
"RTN","WVPRE",50,0)
 ; Change NEW status in File 790.1 to OPEN. NEW no longer exists.
"RTN","WVPRE",51,0)
 S WVIEN=0
"RTN","WVPRE",52,0)
 F  S WVIEN=$O(^WV(790.1,WVIEN)) Q:'WVIEN  D
"RTN","WVPRE",53,0)
 .Q:$P(^WV(790.1,WVIEN,0),U,14)'="n"
"RTN","WVPRE",54,0)
 .S $P(^WV(790.1,WVIEN,0),U,14)="o"
"RTN","WVPRE",55,0)
 .K ^WV(790.1,"S","n",WVIEN)
"RTN","WVPRE",56,0)
 .Q
"RTN","WVPRE",57,0)
 ; Change AGENCY value in File 790.02 to VA if not already VA
"RTN","WVPRE",58,0)
 S WVIEN=0
"RTN","WVPRE",59,0)
 F  S WVIEN=$O(^WV(790.02,WVIEN)) Q:'WVIEN  D
"RTN","WVPRE",60,0)
 .Q:$P(^WV(790.02,WVIEN,0),U,15)="v"
"RTN","WVPRE",61,0)
 .S $P(^WV(790.02,WVIEN,0),U,15)="v"
"RTN","WVPRE",62,0)
 .Q
"RTN","WVPRE",63,0)
 K WVIEN
"RTN","WVPRE",64,0)
 Q
"RTN","WVPRE",65,0)
FIELDS ; Set deleted fields values to ""
"RTN","WVPRE",66,0)
 ; Set Date Inactive (File 790, #.24) if patient is dead.
"RTN","WVPRE",67,0)
 ; Kill X-refs on deleted fields 
"RTN","WVPRE",68,0)
 ;   ---> File 790, fld# .2 ("CDC")
"RTN","WVPRE",69,0)
 ;   ---> File 790.1, fld# .17 "ACDC")
"RTN","WVPRE",70,0)
 S WVX=0 F  S WVX=$O(^WV(790,WVX)) Q:WVX'>0  D
"RTN","WVPRE",71,0)
 .S $P(^WV(790,WVX,0),U,20)=""
"RTN","WVPRE",72,0)
 .Q:$P(^WV(790,WVX,0),U,24)  ;Date Inactive exists
"RTN","WVPRE",73,0)
 .S WVDOD=$P($G(^DPT(WVX,.35)),U,1) ;date of death
"RTN","WVPRE",74,0)
 .Q:'WVDOD
"RTN","WVPRE",75,0)
 .S WVDOD=WVDOD\1
"RTN","WVPRE",76,0)
 .S $P(^WV(790,WVX,0),U,24)=WVDOD
"RTN","WVPRE",77,0)
 .Q
"RTN","WVPRE",78,0)
 K ^WV(790,"CDC") S WVX=0
"RTN","WVPRE",79,0)
 F  S WVX=$O(^WV(790.02,WVX)) Q:WVX'>0  D
"RTN","WVPRE",80,0)
 .F WVY=9,11,12,13,14,16,17,20 S $P(^WV(790.02,WVX,0),U,WVY)=""
"RTN","WVPRE",81,0)
 .F WVY=1,2,3,4,7,8,17:1:35,37,38 S $P(^WV(790.02,WVX,WVY),U,2)=""
"RTN","WVPRE",82,0)
 S WVX=0 F  S WVX=$O(^WV(790.1,WVX)) Q:WVX'>0  D
"RTN","WVPRE",83,0)
 .F WVY=3,16,17 S $P(^WV(790.1,WVX,0),U,WVY)=""
"RTN","WVPRE",84,0)
 .K ^WV(790.1,WVX,"PCC")
"RTN","WVPRE",85,0)
 .S WVQUAD=$P($G(^WV(790.1,WVX,2)),U,16)
"RTN","WVPRE",86,0)
 .K ^WV(790.1,WVX,2)
"RTN","WVPRE",87,0)
 .S:WVQUAD]"" $P(^WV(790.1,WVX,2),U,16)=WVQUAD
"RTN","WVPRE",88,0)
 .Q
"RTN","WVPRE",89,0)
 K ^WV(790.1,"ACDC")
"RTN","WVPRE",90,0)
 S WVX=0 F  S WVX=$O(^WV(790.2,WVX)) Q:WVX'>0  D
"RTN","WVPRE",91,0)
 .F WVY=12:1:17 S $P(^WV(790.2,WVX,0),U,WVY)=""
"RTN","WVPRE",92,0)
 S WVX=0 F  S WVX=$O(^WV(790.31,WVX)) Q:WVX'>0  D
"RTN","WVPRE",93,0)
 .F WVY=24:1:27 S $P(^WV(790.31,WVX,0),U,WVY)=""
"RTN","WVPRE",94,0)
 S WVX=0
"RTN","WVPRE",95,0)
 F  S WVX=$O(^WV(790.51,WVX)) Q:WVX'>0  D
"RTN","WVPRE",96,0)
 .S $P(^WV(790.51,WVX,0),U,2)=""
"RTN","WVPRE",97,0)
 .Q
"RTN","WVPRE",98,0)
 S WVX=0
"RTN","WVPRE",99,0)
 F  S WVX=$O(^WV(790.04,WVX)) Q:WVX'>0  D
"RTN","WVPRE",100,0)
 .F WVY=5,6 S $P(^WV(790.04,WVX,0),U,WVY)=""
"RTN","WVPRE",101,0)
 .Q
"RTN","WVPRE",102,0)
 S WVX=0
"RTN","WVPRE",103,0)
 F  S WVX=$O(^WV(790.05,WVX)) Q:WVX'>0  D
"RTN","WVPRE",104,0)
 .F WVY=5,6 S $P(^WV(790.05,WVX,0),U,WVY)=""
"RTN","WVPRE",105,0)
 .Q
"RTN","WVPRE",106,0)
 K WVDOD,WVQUAD,WVX,WVY
"RTN","WVPRE",107,0)
 Q
"RTN","WVPRE",108,0)
CREDIT ; Stuff Credit Method value from Radiology/NM
"RTN","WVPRE",109,0)
 ; "E" x-ref on File 790.1 is rad/nm date-case # (e.g., 060898-94)
"RTN","WVPRE",110,0)
 Q:'$D(^RADPT)  ;no Radiology/NM Patient file (#70)
"RTN","WVPRE",111,0)
 S WVX=""
"RTN","WVPRE",112,0)
 F  S WVX=$O(^WV(790.1,"E",WVX)) Q:WVX=""  S WVY=0 F  S WVY=$O(^WV(790.1,"E",WVX,WVY)) Q:'WVY  D
"RTN","WVPRE",113,0)
 .S WVNODE=$G(^WV(790.1,WVY,0)) Q:WVNODE=""
"RTN","WVPRE",114,0)
 .S WVDFN=$P(WVNODE,U,2) Q:WVDFN=""
"RTN","WVPRE",115,0)
 .D RADCHK
"RTN","WVPRE",116,0)
 .Q:WVCM=""  ;no credit method
"RTN","WVPRE",117,0)
 .S $P(^WV(790.1,WVY,0),U,35)=WVCM
"RTN","WVPRE",118,0)
 .Q
"RTN","WVPRE",119,0)
 K WVCASE,WVCM,WVDATE,WVDFN,WVNODE,WVX,WVY
"RTN","WVPRE",120,0)
 Q
"RTN","WVPRE",121,0)
RADCHK ; Get RAD/NM Patient Credit Method value
"RTN","WVPRE",122,0)
 S WVCM=""
"RTN","WVPRE",123,0)
 Q:'$D(^RADPT("ADC",WVX,WVDFN))  ;e.g., ^RADPT("ADC","060898-94",DFN))
"RTN","WVPRE",124,0)
 S WVDATE=0
"RTN","WVPRE",125,0)
 F  S WVDATE=$O(^RADPT("ADC",WVX,WVDFN,WVDATE)) Q:'WVDATE  S WVCASE=0 F  S WVCASE=$O(^RADPT("ADC",WVX,WVDFN,WVDATE,WVCASE)) Q:'WVCASE  D
"RTN","WVPRE",126,0)
 .S WVCM=$P($G(^RADPT(WVDFN,"DT",WVDATE,"P",WVCASE,0)),U,26)
"RTN","WVPRE",127,0)
 .Q
"RTN","WVPRE",128,0)
 K WVCASE,WVDATE
"RTN","WVPRE",129,0)
 Q
"RTN","WVPROC")
0^31^B38804391
"RTN","WVPROC",1,0)
WVPROC ;HCIOFO/FT,JR IHS/ANMC/MWR - WV ADD/EDIT WV PROCEDURE; ;8/31/98  13:49
"RTN","WVPROC",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPROC",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROC",4,0)
 ;;  CALLED BY VARIOUS OPTIONS TO ADD/EDIT PROCEDURES.
"RTN","WVPROC",5,0)
 ;
"RTN","WVPROC",6,0)
 ;
"RTN","WVPROC",7,0)
ADDNEW ;EP
"RTN","WVPROC",8,0)
 ;---> CALLED BY OPTION: "WV ADD A NEW PROCEDURE".
"RTN","WVPROC",9,0)
 D SETVARS^WVUTL5 S WVPOP1=0
"RTN","WVPROC",10,0)
 N DA,DIC,DIE,Y
"RTN","WVPROC",11,0)
 F  D  Q:WVPOP1
"RTN","WVPROC",12,0)
 .D NEW
"RTN","WVPROC",13,0)
 .Q:WVPOP
"RTN","WVPROC",14,0)
 .D EDIT2^WVPROC1(DA,.WVPOP)
"RTN","WVPROC",15,0)
 .Q:WVPOP
"RTN","WVPROC",16,0)
 .D PCDVARS^WVUTL3(DA,1)
"RTN","WVPROC",17,0)
 .D NORMAL^WVPROC1
"RTN","WVPROC",18,0)
 D EXIT
"RTN","WVPROC",19,0)
 Q
"RTN","WVPROC",20,0)
 ;
"RTN","WVPROC",21,0)
EXIT ;EP
"RTN","WVPROC",22,0)
 D KILLALL^WVUTL8
"RTN","WVPROC",23,0)
 Q
"RTN","WVPROC",24,0)
 ;
"RTN","WVPROC",25,0)
 ;
"RTN","WVPROC",26,0)
NEW ;EP
"RTN","WVPROC",27,0)
 ;---> SELECT A PATIENT.
"RTN","WVPROC",28,0)
 D SETVARS^WVUTL5 K DIC
"RTN","WVPROC",29,0)
 D TITLE^WVUTL5("ADD A NEW PROCEDURE")
"RTN","WVPROC",30,0)
NEWNT ;EP
"RTN","WVPROC",31,0)
 ;---> ENTER NEW WITHOUT A TITLE (ALLOWS OTHER TITLES, E.G., HISTORICAL)
"RTN","WVPROC",32,0)
 ;---> LOOKUP AND SELECT PATIENT FROM WV PATIENT FILE.
"RTN","WVPROC",33,0)
 D PATLKUP^WVUTL8(.Y,"ADD")
"RTN","WVPROC",34,0)
 I Y<0 S (WVPOP,WVPOP1)=1 Q
"RTN","WVPROC",35,0)
 S WVDFN=+Y
"RTN","WVPROC",36,0)
 ;
"RTN","WVPROC",37,0)
NEW1 ;EP
"RTN","WVPROC",38,0)
 ;---> ADD A NEW PROCEDURE.
"RTN","WVPROC",39,0)
 ;---> PATIENT SELECTED ALREADY BUT NOT PROCEDURE.
"RTN","WVPROC",40,0)
 ;---> REQUIRED VARIABLE: WVDFN
"RTN","WVPROC",41,0)
 ;
"RTN","WVPROC",42,0)
 ;---> NOW SELECT PROCEDURE TYPE FROM WV PROCEDURE TYPE FILE.
"RTN","WVPROC",43,0)
 N A,WVPCDN,S
"RTN","WVPROC",44,0)
 S A="   Select PROCEDURE: "
"RTN","WVPROC",45,0)
 ;---> SCREEN: ACTIVE FIELD CAN BE "YES" OR NULL, BUT NOT "NO".
"RTN","WVPROC",46,0)
 S S="I $P($G(^WV(790.02,DUZ(2),Y)),U)'=0"
"RTN","WVPROC",47,0)
 D DIC^WVFMAN(790.2,"QEMA",.Y,A,"PAP SMEAR",S,"",.WVPOP)
"RTN","WVPROC",48,0)
 Q:Y<0
"RTN","WVPROC",49,0)
 ;---> WVPCDN=IEN OF PROCEDURE TYPE, FILE 790.2.
"RTN","WVPROC",50,0)
 S WVPCDN=+Y
"RTN","WVPROC",51,0)
 ;
"RTN","WVPROC",52,0)
 ;---> IF IT'S A UNILATERAL MAMMOGRAM, PROMPT FOR LEFT OR RIGHT.
"RTN","WVPROC",53,0)
 S WVLFRT=""
"RTN","WVPROC",54,0)
 I WVPCDN=26 D  I $D(DIRUT) S WVPOP=1 Q
"RTN","WVPROC",55,0)
 .N DIR
"RTN","WVPROC",56,0)
 .S DIR("?")="   Select LEFT or RIGHT for this Unilateral Mammogram."
"RTN","WVPROC",57,0)
 .S DIR(0)="SAM^l:LEFT;r:RIGHT",DIR("A")="   LEFT OR RIGHT: "
"RTN","WVPROC",58,0)
 .D ^DIR K DIR
"RTN","WVPROC",59,0)
 .Q:$D(DIRUT)
"RTN","WVPROC",60,0)
 .S WVLFRT=Y
"RTN","WVPROC",61,0)
 ;
"RTN","WVPROC",62,0)
 ;---> IF IT'S A COLPOSCOPY, PROMPT FOR PAP THAT INITIATED IT.
"RTN","WVPROC",63,0)
 S WVPPAP=""
"RTN","WVPROC",64,0)
 I WVPCDN=2 D  Q:WVPOP
"RTN","WVPROC",65,0)
 .W !!?3,"Select the PAP Smear that initiated this Colposcopy."
"RTN","WVPROC",66,0)
 .N A,S
"RTN","WVPROC",67,0)
 .S DIC("?",1)="If a previous abnormal PAP Smear was the reason for"
"RTN","WVPROC",68,0)
 .S DIC("?")="this Colposcopy, enter the Accession# of that PAP here."
"RTN","WVPROC",69,0)
 .S A="   PAP Smear: ",S="D PAPSCRN^WVUTL2"
"RTN","WVPROC",70,0)
 .D DIC^WVFMAN(790.1,"QEMA",.Y,A,"",S,"",.WVPOP)
"RTN","WVPROC",71,0)
 .Q:Y<0
"RTN","WVPROC",72,0)
 .;---> WVPPAP=IEN OF PREVIOUS PAP IN WV PROCEDURE FILE 790.1.
"RTN","WVPROC",73,0)
 .S WVPPAP=+Y
"RTN","WVPROC",74,0)
 ;
"RTN","WVPROC",75,0)
 ;---> ASK DATE, CHECK FOR DUPLICATE PROCEDURE ON SAME DATE.
"RTN","WVPROC",76,0)
 D DATECHK Q:WVPOP
"RTN","WVPROC",77,0)
 D NEW2(WVDFN,WVPCDN,WVPCDT,"",WVPPAP,.DA,.WVERROR)
"RTN","WVPROC",78,0)
 Q
"RTN","WVPROC",79,0)
 ;
"RTN","WVPROC",80,0)
NEW2(DFN,PCDIEN,DATE,DRSTRG,PREVPAP,DA,ERROR) ;EP
"RTN","WVPROC",81,0)
 ;---> ADD A NEW PROCEDURE.
"RTN","WVPROC",82,0)
 ;---> PATIENT AND PROCEDURE ALREADY SELECTED.
"RTN","WVPROC",83,0)
 ;---> NOW GENERATE ACCESSION# FOR WV PROCEDURE FILE ENTRY.
"RTN","WVPROC",84,0)
 ;---> REQUIRED VARIABLES: DFN=IEN IN WV PATIENT FILE
"RTN","WVPROC",85,0)
 ;--->                     PCDIEN=IEN OF PROCEDURE TYPE (#790.2).
"RTN","WVPROC",86,0)
 ;
"RTN","WVPROC",87,0)
 S X=$$ACCSSN^WVUTL5(PCDIEN) N DIC
"RTN","WVPROC",88,0)
 I X']"" D  Q
"RTN","WVPROC",89,0)
 .S ERROR=-1
"RTN","WVPROC",90,0)
 .Q:$D(ZTQUEUED)  ;quit if a background (tasked) job
"RTN","WVPROC",91,0)
 .W !!?5,*7,"UNABLE TO GENERATE ACCESSION#. CONTACT YOUR SITE MANAGER."
"RTN","WVPROC",92,0)
 .D DIRZ^WVUTL3
"RTN","WVPROC",93,0)
 .Q
"RTN","WVPROC",94,0)
 ;
"RTN","WVPROC",95,0)
 I $G(DRSTRG)']"" D
"RTN","WVPROC",96,0)
 .;---> DEFAULTS: DATE OF PROCEDURE IS TODAY, STATUS IS OPEN.
"RTN","WVPROC",97,0)
 .S DRSTRG=".02////"_DFN_";.04////"_PCDIEN
"RTN","WVPROC",98,0)
 .S DRSTRG=DRSTRG_";.09///"_$S($D(WVLFRT):WVLFRT,1:"")_";.12///"_DATE
"RTN","WVPROC",99,0)
 .S DRSTRG=DRSTRG_";.14///o"
"RTN","WVPROC",100,0)
 .S DRSTRG=DRSTRG_";.18////"_DUZ_";.19///T;.3////"_$G(PREVPAP)
"RTN","WVPROC",101,0)
 .S DRSTRG=DRSTRG_";.34////"_$G(DUZ(2))
"RTN","WVPROC",102,0)
 ;
"RTN","WVPROC",103,0)
 D FILE^WVFMAN(790.1,DRSTRG,"ML",X,790,.Y)
"RTN","WVPROC",104,0)
 ;---> IF Y<0, CHECK PERMISSIONS.
"RTN","WVPROC",105,0)
 I Y<0 D  Q
"RTN","WVPROC",106,0)
 .S ERROR=Y
"RTN","WVPROC",107,0)
 .Q:$D(ZTQUEUED)  ;quit if a background (tasked) job
"RTN","WVPROC",108,0)
 .W !?5,*7,"UNABLE TO CREATE NEW PROCEDURE."
"RTN","WVPROC",109,0)
 .D DIRZ^WVUTL3 S WVPOP=1
"RTN","WVPROC",110,0)
 .Q
"RTN","WVPROC",111,0)
 S DA=+Y
"RTN","WVPROC",112,0)
 Q
"RTN","WVPROC",113,0)
 ;
"RTN","WVPROC",114,0)
 ;
"RTN","WVPROC",115,0)
EDIT ;EP
"RTN","WVPROC",116,0)
 ;---> CALLED BY OPTION: "WV EDIT PROCEDURE".
"RTN","WVPROC",117,0)
 ;---> EDIT AN EXISTING PROCEDURE.
"RTN","WVPROC",118,0)
 D TITLE^WVUTL5("EDIT A PROCEDURE")
"RTN","WVPROC",119,0)
 D LKUPPCD(.Y)
"RTN","WVPROC",120,0)
 Q:Y<0
"RTN","WVPROC",121,0)
 ;---> DA=IEN OF PROCEDURE IN PROCEDURE FILE 790.1.
"RTN","WVPROC",122,0)
 S DA=+Y D ^WVRADWP
"RTN","WVPROC",123,0)
 D EDIT2^WVPROC1(DA,.WVPOP) Q:WVPOP!($D(WVNOFOL))
"RTN","WVPROC",124,0)
 D EX^WVRADWP
"RTN","WVPROC",125,0)
 D PCDVARS^WVUTL3(DA,1)
"RTN","WVPROC",126,0)
 D NORMAL^WVPROC1
"RTN","WVPROC",127,0)
 D EXIT
"RTN","WVPROC",128,0)
 Q
"RTN","WVPROC",129,0)
 ;
"RTN","WVPROC",130,0)
 ;
"RTN","WVPROC",131,0)
HISTORIC ;EP
"RTN","WVPROC",132,0)
 ;---> CALLED BY OPTION: "WV ADD AN HISTORICAL PROCEDURE".
"RTN","WVPROC",133,0)
 ;---> ADD HISTORICAL PROCEDURES (NO PROVIDER, WARD/CLINIC, FACILITY).
"RTN","WVPROC",134,0)
 D SETVARS^WVUTL5 S WVPOP1=0 N DA,DIE,Y
"RTN","WVPROC",135,0)
 F  D  Q:WVPOP1
"RTN","WVPROC",136,0)
 .D TITLE^WVUTL5("ENTER HISTORICAL DATA")
"RTN","WVPROC",137,0)
 .D NEWNT W !
"RTN","WVPROC",138,0)
 .Q:(WVPOP!('$G(DA)))
"RTN","WVPROC",139,0)
 .S WVPN=$P(^WV(790.1,DA,0),U,4)
"RTN","WVPROC",140,0)
 .S DR=".05;.08;.1;.14////c"
"RTN","WVPROC",141,0)
 .D DIE^WVFMAN(790.1,DR,DA,.WVPOP)
"RTN","WVPROC",142,0)
 D EXIT
"RTN","WVPROC",143,0)
 Q
"RTN","WVPROC",144,0)
 ;
"RTN","WVPROC",145,0)
 ;
"RTN","WVPROC",146,0)
LABEDIT ;EP
"RTN","WVPROC",147,0)
 ;---> CALLED BY OPTION: "WV LAB EDIT PROCEDURE".
"RTN","WVPROC",148,0)
 S WVNOFOL=1 D EDIT,EXIT
"RTN","WVPROC",149,0)
 Q
"RTN","WVPROC",150,0)
 ;
"RTN","WVPROC",151,0)
 ;
"RTN","WVPROC",152,0)
RADMOD(DA) ;EP
"RTN","WVPROC",153,0)
 ;---> MODIFY A PROCEDURE THAT WAS IMPORTED FROM RADIOLOGY AND
"RTN","WVPROC",154,0)
 ;---> HAS BEEN CHANGED.
"RTN","WVPROC",155,0)
 ;---> DA=IEN OF PROCEDURE IN WV PROCEDURE FILE #790.1.
"RTN","WVPROC",156,0)
 Q:'$G(DA)
"RTN","WVPROC",157,0)
 S DR=".13////"_DT_";.14////o"
"RTN","WVPROC",158,0)
 D DIE^WVFMAN(790.1,DR,DA,.WVPOP)
"RTN","WVPROC",159,0)
 Q
"RTN","WVPROC",160,0)
 ;
"RTN","WVPROC",161,0)
 ;
"RTN","WVPROC",162,0)
LKUPPCD(Y) ;EP
"RTN","WVPROC",163,0)
 ;---> LOOKUP A PROCEDURE.
"RTN","WVPROC",164,0)
 N A
"RTN","WVPROC",165,0)
 D SETVARS^WVUTL5
"RTN","WVPROC",166,0)
 S A="Select ACCESSION# or PATIENT NAME: "
"RTN","WVPROC",167,0)
 D DIC^WVFMAN(790.1,"QEMA",.Y,A,"","","",.WVPOP)
"RTN","WVPROC",168,0)
 Q
"RTN","WVPROC",169,0)
 ;
"RTN","WVPROC",170,0)
DATECHK ;EP
"RTN","WVPROC",171,0)
 ;---> PROMPT FOR DATE, CHECK FOR DUPLICATE PROCEDURE ON SAME DATE.
"RTN","WVPROC",172,0)
 N WVNEW,DIR,DIRUT,N,Y S WVPOP=0
"RTN","WVPROC",173,0)
 S DIR("?",1)="   Enter the date on which this procedure was performed:"
"RTN","WVPROC",174,0)
 S DIR("?")="   (NOTE: Dates in the future may NOT be entered.)"
"RTN","WVPROC",175,0)
 S DIR(0)="DA^0:DT:EX",DIR("A")="   Select DATE:      ",DIR("B")="TODAY"
"RTN","WVPROC",176,0)
 D ^DIR K DIR
"RTN","WVPROC",177,0)
 I Y<1 S WVPOP=1 Q
"RTN","WVPROC",178,0)
 S WVPCDT=Y D DD^%DT W "  ",Y
"RTN","WVPROC",179,0)
 S N=0,WVNEW=0
"RTN","WVPROC",180,0)
 F  S N=$O(^WV(790.1,"C",WVDFN,N)) Q:('N)!(WVPOP)!(WVNEW)  D
"RTN","WVPROC",181,0)
 .S Y=^WV(790.1,N,0)
"RTN","WVPROC",182,0)
 .;---> QUIT IF NOT THE SAME PROCEDURE TYPE.
"RTN","WVPROC",183,0)
 .Q:$P(Y,U,4)'=WVPCDN
"RTN","WVPROC",184,0)
 .;---> QUIT IF NOT THE SAME PROCEDURE DATE.
"RTN","WVPROC",185,0)
 .Q:$P(Y,U,12)'=WVPCDT
"RTN","WVPROC",186,0)
 .;---> QUIT IF THIS PROCEDURE HAS A RESULT/DIAG OF "ERROR/DISREGARD".
"RTN","WVPROC",187,0)
 .Q:$P(Y,U,5)=8
"RTN","WVPROC",188,0)
 .N WVPN S WVPN=$P(^WV(790.2,$P(Y,U,4),0),U)
"RTN","WVPROC",189,0)
 .W !!?5,"A ",WVPN," already exists for this patient on this date,"
"RTN","WVPROC",190,0)
 .W !?5,"with an Accession# of ",$P(Y,U)
"RTN","WVPROC",191,0)
 .W ".  You may edit that procedure by"
"RTN","WVPROC",192,0)
 .W !?5,"calling up ",$P(Y,U)," under the ""Edit a Procedure"" option."
"RTN","WVPROC",193,0)
 .W !?5,"Or you may enter another ",WVPN," for this patient"
"RTN","WVPROC",194,0)
 .W !?5,"on this date."
"RTN","WVPROC",195,0)
 .W !!?5,"Do you REALLY want to add another ",WVPN," for this patient"
"RTN","WVPROC",196,0)
 .W !?5,"on this date?"
"RTN","WVPROC",197,0)
 .S DIR("?")="       Enter NO to avoid adding another "_WVPN
"RTN","WVPROC",198,0)
 .S DIR("?")=DIR("?")_" on this date."
"RTN","WVPROC",199,0)
 .S DIR(0)="Y",DIR("A")="     Enter Yes or No",DIR("B")="NO"
"RTN","WVPROC",200,0)
 .D ^DIR K DIR
"RTN","WVPROC",201,0)
 .I $D(DIRUT)!('Y) S WVPOP=1 Q
"RTN","WVPROC",202,0)
 .S WVNEW=1
"RTN","WVPROC",203,0)
 Q
"RTN","WVPROC",204,0)
 ;
"RTN","WVPROC",205,0)
ERROR1 ;EP
"RTN","WVPROC",206,0)
 W !!?10,*7,"NEW PROCEDURE ENTRY FOR THIS PATIENT FAILED."
"RTN","WVPROC",207,0)
 Q
"RTN","WVPROC1")
0^32^B5871495
"RTN","WVPROC1",1,0)
WVPROC1 ;HCIOFO/FT,JR IHS/ANMC/MWR - WV ADD/EDIT WV PROCEDURE; ;8/27/98  11:26
"RTN","WVPROC1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPROC1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROC1",4,0)
 ;;  EDIT A PROCEDURE, ALSO FOLLOW-UP SCREEN.  CALLED BY WVPROC.
"RTN","WVPROC1",5,0)
 ;
"RTN","WVPROC1",6,0)
 ;
"RTN","WVPROC1",7,0)
EDIT2(DA,WVPOP) ;EP
"RTN","WVPROC1",8,0)
 ;---> EDIT A PROCEDURE.
"RTN","WVPROC1",9,0)
 ;---> REQUIRED VARIABLES: DA=IEN IN ^WV(790.1,.
"RTN","WVPROC1",10,0)
 S WVPOP=0
"RTN","WVPROC1",11,0)
 I '$G(DA) D  D OUT^WVUTL3 Q
"RTN","WVPROC1",12,0)
 .W !,"NO PROCEDURE (DA).  PLEASE CONTACT YOUR SITE MANAGER."
"RTN","WVPROC1",13,0)
 I '$D(^WV(790.1,DA,0)) D  D OUT^WVUTL3 Q
"RTN","WVPROC1",14,0)
 .W !,"^WV(790.1, NOT DEFINED.  PLEASE CONTACT YOUR SITE MANAGER."
"RTN","WVPROC1",15,0)
 S WVDFN=$P(^WV(790.1,DA,0),U,2)
"RTN","WVPROC1",16,0)
 D SCREEN(DA,.WVPOP)
"RTN","WVPROC1",17,0)
 ;---> IF ENTRY WAS LOCKED, WVPOP=1.
"RTN","WVPROC1",18,0)
 Q:WVPOP
"RTN","WVPROC1",19,0)
 Q
"RTN","WVPROC1",20,0)
 ;
"RTN","WVPROC1",21,0)
SCREEN(DA,WVPOP) ;EP
"RTN","WVPROC1",22,0)
 ;---> EDIT A PROCEDURE WITH SCREENMAN.
"RTN","WVPROC1",23,0)
 ;---> REQUIRED VARIABLES: DA=IEN IN PROCEDURE FILE.
"RTN","WVPROC1",24,0)
 ;---> STORE OLD ZERO NODE VALUES IN WVOLD TO COMPARE FOR EDITS,
"RTN","WVPROC1",25,0)
 ;---> STORE OLD 2 NODE VALUES IN WVOLD2.
"RTN","WVPROC1",26,0)
 ;
"RTN","WVPROC1",27,0)
 D MSTU^WVUTL1A
"RTN","WVPROC1",28,0)
 N WVOLD,WVOLD2,WVPCDN,DDSFILE,DR,Y
"RTN","WVPROC1",29,0)
 S DDSFILE=790.1
"RTN","WVPROC1",30,0)
 S WVOLD=^WV(790.1,DA,0) S:$D(^(2)) WVOLD2=^WV(790.1,DA,2)
"RTN","WVPROC1",31,0)
 S WVPCDN=$P(WVOLD,U,4)
"RTN","WVPROC1",32,0)
 ;
"RTN","WVPROC1",33,0)
 ;---> SET DR=TO THE APPROPRIATE FORM.
"RTN","WVPROC1",34,0)
 D
"RTN","WVPROC1",35,0)
 .;---> IF THIS IS A COLPOSCOPY-TYPE PROCEDURE, USE FORM-2.
"RTN","WVPROC1",36,0)
 .I $$COLP^WVUTL4(DA) S DR="[WV PROC-FORM-2-COLP]" Q
"RTN","WVPROC1",37,0)
 .;
"RTN","WVPROC1",38,0)
 .;---> OTHERWISE, USE FORM 1 (ONLY PAGE 1).
"RTN","WVPROC1",39,0)
 .S DR="[WV PROC-FORM-1]"
"RTN","WVPROC1",40,0)
 ;
"RTN","WVPROC1",41,0)
 ;---> CALL SCREENMAN.
"RTN","WVPROC1",42,0)
 D DDS^WVFMAN(DDSFILE,DR,DA,"","",.WVPOP)
"RTN","WVPROC1",43,0)
 Q:WVPOP
"RTN","WVPROC1",44,0)
 Q
"RTN","WVPROC1",45,0)
 ;
"RTN","WVPROC1",46,0)
 ;
"RTN","WVPROC1",47,0)
FOLLOWUP(WVDA) ;EP
"RTN","WVPROC1",48,0)
 ;---> PROCEDURE FOLLOW-UP MENU.
"RTN","WVPROC1",49,0)
 ;---> REQUIRED VARIABLES: WVDA=IEN IN PROCEDURE FILE.
"RTN","WVPROC1",50,0)
 ;---> WVLOOP TELLS WVNOTIF (ADD NEW NOTIFICATION) NOT TO OFFER TO EDIT
"RTN","WVPROC1",51,0)
 ;---> CASE DATA, SINCE THAT OPTION IS ALREADY OFFERED IN THIS LOOP.
"RTN","WVPROC1",52,0)
 Q  ;dead code?
"RTN","WVPROC1",53,0)
 ;
"RTN","WVPROC1",54,0)
NORMAL ;EP
"RTN","WVPROC1",55,0)
 ;---> IF RESULT IS NORMAL, ASK TO QUEUE NORMAL PAP/MAM LETTER.
"RTN","WVPROC1",56,0)
 ;---> QUIT IF VARIABLES NOT ADEQUATE.
"RTN","WVPROC1",57,0)
 N DIR,DIRUT,WVSPEC,WVSPTX,X,Y
"RTN","WVPROC1",58,0)
 Q:'$G(WVPCDN)!('$G(WVRESN))!('$D(WVACCN))
"RTN","WVPROC1",59,0)
 ;
"RTN","WVPROC1",60,0)
 ;---> QUIT IF THE RESULT OF THIS PROCEDURE IS NOT NORMAL.
"RTN","WVPROC1",61,0)
 Q:$P(^WV(790.31,WVRESN,0),U,21)
"RTN","WVPROC1",62,0)
 ;
"RTN","WVPROC1",63,0)
 ;---> FOR PAP WVSPEC=1, FOR ANY TYPE OF MAM WVSPEC=2, OTHERWISE 0.
"RTN","WVPROC1",64,0)
 S WVSPEC=$S(WVPCDN=1:1,$$PMAM^WVUTL6(WVPCDN):2,1:0)
"RTN","WVPROC1",65,0)
 ;---> QUIT IF NOT A PAP OR MAM.
"RTN","WVPROC1",66,0)
 Q:'WVSPEC
"RTN","WVPROC1",67,0)
 ;
"RTN","WVPROC1",68,0)
 ;---> QUIT IF THIS IS PAP (OR MAM) AND "AUTOQUEUE NORMAL PAP (OR MAM)
"RTN","WVPROC1",69,0)
 ;---> LETTERS" IS SET TO "NO" IN THE SITE PARAMETERS.
"RTN","WVPROC1",70,0)
 Q:'$D(^WV(790.02,DUZ(2),0))
"RTN","WVPROC1",71,0)
 Q:WVSPEC=1&('$P(^WV(790.02,DUZ(2),0),U,3))
"RTN","WVPROC1",72,0)
 Q:WVSPEC=2&('$P(^WV(790.02,DUZ(2),0),U,7))
"RTN","WVPROC1",73,0)
 ;
"RTN","WVPROC1",74,0)
 ;---> QUIT IF ANY NOTIFICATION ALREADY EXISTS FOR THIS ACCESSION#.
"RTN","WVPROC1",75,0)
 I $D(^WV(790.4,"C",WVACCN)) Q  ;D  Q
"RTN","WVPROC1",76,0)
 ;.W !!
"RTN","WVPROC1",77,0)
 ;.W ?5,"* (One or more Notifications already exist for this Procedure.)"
"RTN","WVPROC1",78,0)
 ;
"RTN","WVPROC1",79,0)
 ;---> SET TEXT.
"RTN","WVPROC1",80,0)
 S WVSPTX=$S(WVSPEC=1:"PAP",WVSPEC=2:"MAM",1:"?")
"RTN","WVPROC1",81,0)
 W !!!
"RTN","WVPROC1",82,0)
 S DIR("A")="QUEUE a "_WVSPTX_" Result Normal letter to be sent to this patient"
"RTN","WVPROC1",83,0)
 S DIR(0)="Y"
"RTN","WVPROC1",84,0)
 D ^DIR
"RTN","WVPROC1",85,0)
 Q:$D(DIRUT)!(Y=0)
"RTN","WVPROC1",86,0)
 D NORMALL^WVNOTIF1(WVDFN,WVACCN,WVSPEC,WVSPTX)
"RTN","WVPROC1",87,0)
 Q
"RTN","WVPROC1",88,0)
 ;
"RTN","WVPROF")
0^33^B9861932
"RTN","WVPROF",1,0)
WVPROF ;HCIOFO/FT,JR IHS/ANMC/MWR - DISPLAY PATIENT PROFILE; ;7/30/98  11:38
"RTN","WVPROF",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPROF",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROF",4,0)
 ;;  CALL ED BY OPTION: "WV PATIENT PROFILE" TO DISPLAY PROFILE.
"RTN","WVPROF",5,0)
 ;
"RTN","WVPROF",6,0)
 ;---> *NOTE: TO ASK DATE RANGE, UNCOMMENT ALL LINES WITH "XDATES",
"RTN","WVPROF",7,0)
 ;--->        AND IN HEADER2^WVUTL7.
"RTN","WVPROF",8,0)
 ;
"RTN","WVPROF",9,0)
 ;---> VARIABLES:
"RTN","WVPROF",10,0)
 ;---> WVDFN: DFN OF SELECTED PATIENT
"RTN","WVPROF",11,0)
 ;---> DATES: WVBEGDT=BEGINNING DATE, WVENDDT=ENDING DATE
"RTN","WVPROF",12,0)
 ;---> USE NODES 1 & 2 IN ^TMP GLOBAL.
"RTN","WVPROF",13,0)
 ;
"RTN","WVPROF",14,0)
 D SETVARS^WVUTL5
"RTN","WVPROF",15,0)
 S:'$D(WVERRORS) WVERRORS=1
"RTN","WVPROF",16,0)
 F  D RUN Q:WVPOP
"RTN","WVPROF",17,0)
 D EXIT
"RTN","WVPROF",18,0)
 Q
"RTN","WVPROF",19,0)
 ;
"RTN","WVPROF",20,0)
RUN ;EP
"RTN","WVPROF",21,0)
 D TITLE^WVUTL5("PATIENT PROFILE")
"RTN","WVPROF",22,0)
 D PATIENT Q:WVPOP
"RTN","WVPROF",23,0)
 D BRIEF   Q:WVPOP
"RTN","WVPROF",24,0)
 D DEVICE  Q:WVPOP
"RTN","WVPROF",25,0)
 D SORT^WVPROF2
"RTN","WVPROF",26,0)
 D COPYGBL
"RTN","WVPROF",27,0)
 D ^WVPROF1 S WVPOP=0
"RTN","WVPROF",28,0)
 K WVD,WVSUBH
"RTN","WVPROF",29,0)
 Q
"RTN","WVPROF",30,0)
 ;
"RTN","WVPROF",31,0)
EXIT ;EP
"RTN","WVPROF",32,0)
 D KILLALL^WVUTL8
"RTN","WVPROF",33,0)
 Q
"RTN","WVPROF",34,0)
 ;
"RTN","WVPROF",35,0)
 ;
"RTN","WVPROF",36,0)
PATIENT ;EP
"RTN","WVPROF",37,0)
 ;---> SELECT PATIENT (RETURN WVDFN).
"RTN","WVPROF",38,0)
 W !!,"   Select the patient whose Profile you wish to display."
"RTN","WVPROF",39,0)
 D PATLKUP^WVUTL8(.Y) S:Y<0 WVPOP=1
"RTN","WVPROF",40,0)
 ;---> USE NEXT LINE IF I WANT TO ADD CAPABILITY OF ADDING NEW PATIENT.
"RTN","WVPROF",41,0)
 ;D PATLKUP^WVUTL8(.Y,$S($G(WVPUSER):"",1:"ADD")) S:Y<0 WVPOP=1
"RTN","WVPROF",42,0)
 S WVDFN=+Y
"RTN","WVPROF",43,0)
 Q
"RTN","WVPROF",44,0)
 ;
"RTN","WVPROF",45,0)
DATES ;EP
"RTN","WVPROF",46,0)
 ;---> ASK DATE RANGE.  RETURN DATES IN WVBEGDT AND WVENDDT.
"RTN","WVPROF",47,0)
 ;---> IF LOOKING AT ONLY ONE PATIENT, SET DEFAULT BEGIN DATE=T-5YEARS.
"RTN","WVPROF",48,0)
 ;S WVBEGDT=2500101,WVENDDT=DT     ;---> XDATES-CAN USE THIS INSTEAD.
"RTN","WVPROF",49,0)
 ;S WVBEGDF="T-60M",WVENDDF="T"    ;---> XDATES
"RTN","WVPROF",50,0)
 ;D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP,"T-365","T")  ;---> XDATES
"RTN","WVPROF",51,0)
 Q
"RTN","WVPROF",52,0)
 ;
"RTN","WVPROF",53,0)
BRIEF ;EP
"RTN","WVPROF",54,0)
 ;---> BRIEF OR DETAILED LISTING OF PROCEDURES (BRIEF DOES NOT LIST
"RTN","WVPROF",55,0)
 ;---> NOTIFICATIONS AND PROVIDERS).
"RTN","WVPROF",56,0)
 N DIR,DIRUT,Y
"RTN","WVPROF",57,0)
 W !!?3,"List Patient Profile in BRIEF or DETAILED format?"
"RTN","WVPROF",58,0)
 S DIR("A")="   Select BRIEF or DETAILED: ",DIR("B")="BRIEF"
"RTN","WVPROF",59,0)
 S DIR(0)="SAM^b:BRIEF;d:DETAILED" D HELP1
"RTN","WVPROF",60,0)
 D ^DIR
"RTN","WVPROF",61,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVPROF",62,0)
 ;---> IF ALL DETAILED, S WVD=1; FOR BRIEF WVD=0
"RTN","WVPROF",63,0)
 S WVD=$S(Y="d":1,1:0)
"RTN","WVPROF",64,0)
 Q
"RTN","WVPROF",65,0)
 ;
"RTN","WVPROF",66,0)
DEVICE ;EP
"RTN","WVPROF",67,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVPROF",68,0)
 S ZTRTN="DEQUEUE^WVPROF"
"RTN","WVPROF",69,0)
 F WVSV="D","DFN","BEGDT","ENDDT","ERRORS" D
"RTN","WVPROF",70,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVPROF",71,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVPROF",72,0)
 Q
"RTN","WVPROF",73,0)
 ;
"RTN","WVPROF",74,0)
COPYGBL ;EP
"RTN","WVPROF",75,0)
 ;---> COPY ^TMP("WV",$J,1 TO ^TMP("WV",$J,2 TO MAKE IT FLAT.
"RTN","WVPROF",76,0)
 N I,M,N,P,Q
"RTN","WVPROF",77,0)
 S N=0,I=0
"RTN","WVPROF",78,0)
 F  S N=$O(^TMP("WV",$J,1,N)) Q:N=""  D
"RTN","WVPROF",79,0)
 .S M=0
"RTN","WVPROF",80,0)
 .F  S M=$O(^TMP("WV",$J,1,N,M)) Q:M=""  D
"RTN","WVPROF",81,0)
 ..S P=0
"RTN","WVPROF",82,0)
 ..F  S P=$O(^TMP("WV",$J,1,N,M,P)) Q:P=""  D
"RTN","WVPROF",83,0)
 ...S Q=0
"RTN","WVPROF",84,0)
 ...F  S Q=$O(^TMP("WV",$J,1,N,M,P,Q)) Q:Q=""  D
"RTN","WVPROF",85,0)
 ....S I=I+1,^TMP("WV",$J,2,I)=^TMP("WV",$J,1,N,M,P,Q)
"RTN","WVPROF",86,0)
 Q
"RTN","WVPROF",87,0)
 ;
"RTN","WVPROF",88,0)
 ;
"RTN","WVPROF",89,0)
DEQUEUE ;EP
"RTN","WVPROF",90,0)
 ;---> EP FOR TASKMAN QUEUE OF PRINTOUT.
"RTN","WVPROF",91,0)
 D SETVARS^WVUTL5,SORT^WVPROF2,COPYGBL,^WVPROF1,EXIT
"RTN","WVPROF",92,0)
 Q
"RTN","WVPROF",93,0)
 ;
"RTN","WVPROF",94,0)
HELP1 ;EP
"RTN","WVPROF",95,0)
 ;;Enter "D" for a "Detailed" listing of the patient's Procedures,
"RTN","WVPROF",96,0)
 ;;Notifications, PAP Regimen and Pregnancy changes.
"RTN","WVPROF",97,0)
 ;;Enter "B" for a "Brief" listing of the patient's Procedures only.
"RTN","WVPROF",98,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVPROF",99,0)
 Q
"RTN","WVPROF",100,0)
 ;
"RTN","WVPROF",101,0)
HELPTX ;EP
"RTN","WVPROF",102,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVPROF",103,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVPROF",104,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVPROF",105,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVPROF",106,0)
 Q
"RTN","WVPROF",107,0)
 ;
"RTN","WVPROF",108,0)
 ;
"RTN","WVPROF",109,0)
USER ;EP
"RTN","WVPROF",110,0)
 ;---> CALLED BY OPTION: "WV PATIENT PROFILE USER"
"RTN","WVPROF",111,0)
 ;---> FOR USER TO VIEW PROFILE AND PRINT PROCEDURES, BUT NO EDIT.
"RTN","WVPROF",112,0)
 S WVPUSER=1
"RTN","WVPROF",113,0)
 D WVPROF K WVPUSER
"RTN","WVPROF",114,0)
 Q
"RTN","WVPROF",115,0)
 ;
"RTN","WVPROF",116,0)
ERRORS ;EP
"RTN","WVPROF",117,0)
 ;---> CALLED BY OPTION: "WV PATIENT PROFILE W/ERRORS"
"RTN","WVPROF",118,0)
 ;---> ENTER HERE TO INCLUDE ERRONEOUS ENTRIES.
"RTN","WVPROF",119,0)
 S WVERRORS=0 G WVPROF
"RTN","WVPROF",120,0)
 Q
"RTN","WVPROF1")
0^34^B5653002
"RTN","WVPROF1",1,0)
WVPROF1 ;HCIOFO/FT,JR IHS/ANMC/MWR - DISPLAY PATIENT PROFILE; ;7/30/98  11:39
"RTN","WVPROF1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPROF1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROF1",4,0)
 ;;  SETUP AND EDIT CODE FOR DISPLAYING PATIENT PROFILE.
"RTN","WVPROF1",5,0)
 ;;  CALLED BY WVPROF.
"RTN","WVPROF1",6,0)
 ;
"RTN","WVPROF1",7,0)
 D DISPLAY Q:WVPOP
"RTN","WVPROF1",8,0)
 D ^WVPROF3
"RTN","WVPROF1",9,0)
 Q
"RTN","WVPROF1",10,0)
 ;
"RTN","WVPROF1",11,0)
 ;
"RTN","WVPROF1",12,0)
DISPLAY ;EP
"RTN","WVPROF1",13,0)
 ;---> WVCONF=DISPLAY "CONFIDENTIAL PATIENT INFO" BANNER.
"RTN","WVPROF1",14,0)
 ;---> WVTITLE=TITLE AT TOP OF DISPLAY HEADER.
"RTN","WVPROF1",15,0)
 ;---> WVCHAGE=DISPLAY CHART AND AGE IN HEADER.
"RTN","WVPROF1",16,0)
 ;---> WVSUBH=CODE TO EXECUTE FOR SUBHEADER (COLUMN TITLES).
"RTN","WVPROF1",17,0)
 ;---> WVCODE=CODE TO EXECUTE AS 3RD PIECE OF DIR(0) (AFTER DIR READ).
"RTN","WVPROF1",18,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (ALLOWS SELECTIONS TO EDIT).
"RTN","WVPROF1",19,0)
 ;---> WVTAB=6 IF OUTPUT IS TO SCREEN, =3 IF OUTPUT IS TO PRINTER.
"RTN","WVPROF1",20,0)
 ;---> WVPRMT(1,Q)=PROMPTS FOR DIR.
"RTN","WVPROF1",21,0)
 ;
"RTN","WVPROF1",22,0)
 U IO
"RTN","WVPROF1",23,0)
 I '$D(WVDFN)!('$D(WVNAME))!('$D(WVCHRT)) D  Q
"RTN","WVPROF1",24,0)
 .W !!,"INSUFFICIENT PATIENT INFORMATION.",!!
"RTN","WVPROF1",25,0)
 .D DIRZ^WVUTL3 S WVPOP=1
"RTN","WVPROF1",26,0)
 ;
"RTN","WVPROF1",27,0)
 S WVCONF=1,WVCHAGE=1
"RTN","WVPROF1",28,0)
 S WVTITLE="* * *  Patient Profile  * * *" D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVPROF1",29,0)
 S WVCODE="Q:'$D(^TMP(""WV"",$J,2,+X))  "
"RTN","WVPROF1",30,0)
 S WVCODE=WVCODE_"D EDIT^WVPROF1 N X D SORT^WVPROF2,COPYGBL^WVPROF"
"RTN","WVPROF1",31,0)
 ;---> IF PROFILE IS BEING ACCESSED BY A USER FROM OUTSIDE OF THE
"RTN","WVPROF1",32,0)
 ;---> PACKAGE (NOT WOMEN'S HEALTH STAFF), THEN OFFER DISPLAY/PRINT
"RTN","WVPROF1",33,0)
 ;---> OF PROCEDURE; DO NOT OFFER EDIT OF PROCEDURE.
"RTN","WVPROF1",34,0)
 D:$G(WVPUSER)
"RTN","WVPROF1",35,0)
 .S WVCODE="D PRINTPCD^WVPROF1"
"RTN","WVPROF1",36,0)
 S (WVACCP,N,WVPOP,Z)=0
"RTN","WVPROF1",37,0)
 D TOPHEAD^WVUTL7
"RTN","WVPROF1",38,0)
 S WVTAB=$S(WVCRT:6,1:3)
"RTN","WVPROF1",39,0)
 Q
"RTN","WVPROF1",40,0)
 ;
"RTN","WVPROF1",41,0)
 ;
"RTN","WVPROF1",42,0)
EDIT ;EP
"RTN","WVPROF1",43,0)
 ;---> FROM BROWSE, WVPOP IN TO EDIT A SINGLE PROCEDURE.
"RTN","WVPROF1",44,0)
 ;---> NOTE: PIECE 10 OF EACH TMP NODE IS THE IEN FOR THAT ENTRY
"RTN","WVPROF1",45,0)
 ;---> IN ITS RESPECTIVE FILE (PROCDURE FILE OR NOTIFICATION FILE).
"RTN","WVPROF1",46,0)
 D SETVARS^WVUTL5
"RTN","WVPROF1",47,0)
 S X=+X,DA=$P(^TMP("WV",$J,2,X),U,10)
"RTN","WVPROF1",48,0)
 S WVNN=X N X D
"RTN","WVPROF1",49,0)
 .I $P(^TMP("WV",$J,2,WVNN),U)=1 D  Q
"RTN","WVPROF1",50,0)
 ..D EDIT2^WVPROC1(DA,.WVPOP) Q:WVPOP
"RTN","WVPROF1",51,0)
 .I $P(^TMP("WV",$J,2,WVNN),U)=2 D EDIT2^WVNOTIF(DA) Q
"RTN","WVPROF1",52,0)
 .W !!?3,*7,"This is neither a PROCEDURE nor a NOTIFICATION.  "
"RTN","WVPROF1",53,0)
 .W "It cannot be edited here."
"RTN","WVPROF1",54,0)
 .D DIRZ^WVUTL3 Q
"RTN","WVPROF1",55,0)
 ;---> BACK UP 5 RECORDS AFTER EDIT.
"RTN","WVPROF1",56,0)
 S N=$S(WVNN<6:1,1:WVNN-5),Z=0 K WVNN
"RTN","WVPROF1",57,0)
 Q
"RTN","WVPROF1",58,0)
 ;
"RTN","WVPROF1",59,0)
 ;
"RTN","WVPROF1",60,0)
PRINTPCD ;EP
"RTN","WVPROF1",61,0)
 ;---> FROM BROWSE, PRINT THIS PROCEDURE.
"RTN","WVPROF1",62,0)
 ;---> NOTE: PIECE 10 OF EACH TMP NODE IS THE IEN FOR THAT ENTRY
"RTN","WVPROF1",63,0)
 ;---> IN ITS RESPECTIVE FILE (PROCDURE FILE OR NOTIFICATION FILE).
"RTN","WVPROF1",64,0)
 D SETVARS^WVUTL5
"RTN","WVPROF1",65,0)
 S X=+X,DA=$P(^TMP("WV",$J,2,X),U,10)
"RTN","WVPROF1",66,0)
 S WVN=X N X D
"RTN","WVPROF1",67,0)
 .I $P(^TMP("WV",$J,2,WVN),U)=1 D TOP^WVPRPCD(DA) Q
"RTN","WVPROF1",68,0)
 .W !!?3,*7,"This is not a PROCEDURE.  "
"RTN","WVPROF1",69,0)
 .D DIRZ^WVUTL3 Q
"RTN","WVPROF1",70,0)
 ;---> BACK UP 5 RECORDS AFTER EDIT.
"RTN","WVPROF1",71,0)
 S N=$S(WVN<6:1,1:WVN-5),Z=0 K WVN
"RTN","WVPROF1",72,0)
 Q
"RTN","WVPROF1",73,0)
 ;
"RTN","WVPROF1",74,0)
 ;
"RTN","WVPROF1",75,0)
SUBHEAD ;EP
"RTN","WVPROF1",76,0)
 ;---> SUB HEADER FOR BRIEF DISPLAY OF PROCEDURES ONLY.
"RTN","WVPROF1",77,0)
 W !?WVTAB,"DATE",?16,"PROCEDURE",?27,"RESULTS/DIAGNOSIS",?71,"STATUS",!
"RTN","WVPROF1",78,0)
 W ?WVTAB,"--------",?16,"---------",?27,"----------------------------"
"RTN","WVPROF1",79,0)
 W ?71,"------"
"RTN","WVPROF1",80,0)
 Q
"RTN","WVPROF2")
0^35^B21646080
"RTN","WVPROF2",1,0)
WVPROF2 ;HCIOFO/FT,JR IHS/ANMC/MWR - DISPLAY PATIENT PROFILE; ;7/30/98  11:41
"RTN","WVPROF2",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPROF2",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROF2",4,0)
 ;;  RETRIEVE AND SORT PROCEDURES, NOTIFICATIONS, PAP REGIMENS,
"RTN","WVPROF2",5,0)
 ;;  AND PREGNANCIES FOR PATIENT PROFILE.  CALLED BY WVPROF.
"RTN","WVPROF2",6,0)
 ;
"RTN","WVPROF2",7,0)
SORT ;EP
"RTN","WVPROF2",8,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVPROF2",9,0)
 ;
"RTN","WVPROF2",10,0)
 K ^TMP("WV",$J)
"RTN","WVPROF2",11,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVPROF2",12,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVPROF2",13,0)
 ;S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999    ;---> XDATES
"RTN","WVPROF2",14,0)
 ;
"RTN","WVPROF2",15,0)
 D PATVARS^WVUTL3(WVDFN)
"RTN","WVPROF2",16,0)
 ;
"RTN","WVPROF2",17,0)
 ;*******************
"RTN","WVPROF2",18,0)
 ;---> GET PROCEDURES
"RTN","WVPROF2",19,0)
 S WVIEN=0
"RTN","WVPROF2",20,0)
 F  S WVIEN=$O(^WV(790.1,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",21,0)
 .;---> SET Y=THE ZERO NODE FOR THIS PROCEDURE.
"RTN","WVPROF2",22,0)
 .S Y=^WV(790.1,WVIEN,0)
"RTN","WVPROF2",23,0)
 .;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVPROF2",24,0)
 .Q:WVERRORS&($P(Y,U,5)=8)
"RTN","WVPROF2",25,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVPROF2",26,0)
 .S (WVDATE,WVDATE1)=$P(Y,U,12)
"RTN","WVPROF2",27,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)                ;---> XDATES
"RTN","WVPROF2",28,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",29,0)
 .S WVACC=$P(Y,U)                                      ;---> ACCESSION#
"RTN","WVPROF2",30,0)
 .S WVPCD=$P(^WV(790.2,$P(Y,U,4),0),U,2)               ;---> PROC TYPE
"RTN","WVPROF2",31,0)
 .S WVSTAT=$$STATUS^WVUTL4                             ;---> STATUS
"RTN","WVPROF2",32,0)
 .S WVDIAG=$$DIAG^WVUTL4($P(Y,U,5))                    ;---> RESULT/DIAG
"RTN","WVPROF2",33,0)
 .S WVPROV=$P(Y,U,7) D                                 ;---> PROVIDER
"RTN","WVPROF2",34,0)
 ..I 'WVPROV S WVPROV="NOT ENTERED" Q
"RTN","WVPROF2",35,0)
 ..S WVPROV=$P($P(^VA(200,WVPROV,0),U),",")
"RTN","WVPROF2",36,0)
 .;---> FOR PROCEDURES, SET 1ST PIECE AND 6TH SUBSCRIPT=1.
"RTN","WVPROF2",37,0)
 .S X=1_U_U_U_WVDATE1_U_WVPCD_U_WVACC_U_WVDIAG
"RTN","WVPROF2",38,0)
 .S X=X_U_WVPROV_U_WVSTAT_U_WVIEN
"RTN","WVPROF2",39,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,WVACC,1,WVIEN)=X Q
"RTN","WVPROF2",40,0)
 ;
"RTN","WVPROF2",41,0)
 ;**********************
"RTN","WVPROF2",42,0)
 ;---> GET NOTIFICATIONS
"RTN","WVPROF2",43,0)
 Q:'WVD
"RTN","WVPROF2",44,0)
 S WVIEN=0
"RTN","WVPROF2",45,0)
 F  S WVIEN=$O(^WV(790.4,"B",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",46,0)
 .S Y=^WV(790.4,WVIEN,0)
"RTN","WVPROF2",47,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.  WVDATE1 PRESERVES NOTIF DATE.
"RTN","WVPROF2",48,0)
 .S (WVDATE,WVDATE1)=$P(Y,U,2)
"RTN","WVPROF2",49,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)               ;---> XDATE
"RTN","WVPROF2",50,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",51,0)
 .S WVACC=$P(Y,U,6) D                                 ;---> ACCESSION#
"RTN","WVPROF2",52,0)
 ..I WVACC="" S WVACC="NO ACC#" Q
"RTN","WVPROF2",53,0)
 ..;---> IF THIS NOTIFICATION PERTAINS TO A PROCEDURE (I.E., IT
"RTN","WVPROF2",54,0)
 ..;---> HAS AN ACCESSION#), RESET ITS DATE SO THAT IT WILL COLLATE
"RTN","WVPROF2",55,0)
 ..;---> UNDER ITS PROCEDURE IN THE DISPLAY.
"RTN","WVPROF2",56,0)
 ..S WVACC=$P(^WV(790.1,WVACC,0),U),WVDATE=$P(^(0),U,12)
"RTN","WVPROF2",57,0)
 .S WVSTAT=$$STATUS^WVUTL4                            ;---> STATUS
"RTN","WVPROF2",58,0)
 .S WVTYPE=$P(Y,U,3)  D                               ;---> TYPE
"RTN","WVPROF2",59,0)
 ..I WVTYPE="" S WVTYPE="NOT ENTERED" Q
"RTN","WVPROF2",60,0)
 ..S WVTYPE=$P(^WV(790.403,WVTYPE,0),U)
"RTN","WVPROF2",61,0)
 .S WVPURP=$P(Y,U,4)  D                               ;---> PURPOSE
"RTN","WVPROF2",62,0)
 ..I WVPURP="" S WVPURP="NOT ENTERED" Q
"RTN","WVPROF2",63,0)
 ..S WVPURP=$P(^WV(790.404,WVPURP,0),U)
"RTN","WVPROF2",64,0)
 .S WVOUT=$P(Y,U,5)  D                                ;---> OUTCOME
"RTN","WVPROF2",65,0)
 ..I WVOUT="" S WVOUT="NOT ENTERED" Q
"RTN","WVPROF2",66,0)
 ..S WVOUT=$P(^WV(790.405,WVOUT,0),U)
"RTN","WVPROF2",67,0)
 .;---> FOR NOTIFICATIONS, SET 1ST PIECE AND 6TH SUBSCRIPT=2.
"RTN","WVPROF2",68,0)
 .;S X=2_U_WVCHRT_U_WVNAME_U_WVDATE1_U_WVACC_U_WVTYPE_U_WVPURP
"RTN","WVPROF2",69,0)
 .S X=2_U_U_U_WVDATE1_U_WVACC_U_WVTYPE_U_WVPURP
"RTN","WVPROF2",70,0)
 .S X=X_U_WVOUT_U_WVSTAT_U_WVIEN
"RTN","WVPROF2",71,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,WVACC,2,WVIEN)=X Q
"RTN","WVPROF2",72,0)
 ;
"RTN","WVPROF2",73,0)
 ;**********************
"RTN","WVPROF2",74,0)
 ;---> GET PAP REGIMENS
"RTN","WVPROF2",75,0)
 S WVIEN=0
"RTN","WVPROF2",76,0)
 F  S WVIEN=$O(^WV(790.04,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",77,0)
 .;---> SET Y=THE ZERO NODE FOR THIS PAP REGIMEN LOG ENTRY.
"RTN","WVPROF2",78,0)
 .S Y=^WV(790.04,WVIEN,0)
"RTN","WVPROF2",79,0)
 .;---> PIECE 1=START DATE FOR THE PAP REGIMEN.
"RTN","WVPROF2",80,0)
 .S (WVDATE,WVDATE1)=$P(Y,U)                           ;---> DATE
"RTN","WVPROF2",81,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVPROF2",82,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)                ;---> XDATES
"RTN","WVPROF2",83,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",84,0)
 .S WVPAPRG1=$$PAPRG1^WVUTL1($P(Y,U,3))                ;---> PAP REGIMEN
"RTN","WVPROF2",85,0)
 .;---> FOR PAP REGIMENS, SET 1ST PIECE AND 6TH SUBSCRIPT=3.
"RTN","WVPROF2",86,0)
 .;S X=3_U_WVCHRT_U_WVNAME_U_WVDATE1_U_WVPAPRG1
"RTN","WVPROF2",87,0)
 .S X=3_U_U_U_WVDATE1_U_WVPAPRG1
"RTN","WVPROF2",88,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,1,3,WVIEN)=X Q
"RTN","WVPROF2",89,0)
 ;
"RTN","WVPROF2",90,0)
 ;**********************
"RTN","WVPROF2",91,0)
 ;---> GET PREGNANCIES
"RTN","WVPROF2",92,0)
 S WVIEN=0
"RTN","WVPROF2",93,0)
 F  S WVIEN=$O(^WV(790.05,"C",WVDFN,WVIEN)) Q:'WVIEN  D
"RTN","WVPROF2",94,0)
 .;---> SET Y=THE ZERO NODE FOR THIS PREGNANCY LOG ENTRY.
"RTN","WVPROF2",95,0)
 .S Y=^WV(790.05,WVIEN,0)
"RTN","WVPROF2",96,0)
 .;---> PIECE 1=DATE PREGNANCY LOG ENTRY WAS MADE.
"RTN","WVPROF2",97,0)
 .S (WVDATE,WVDATE1)=$P(Y,U)                           ;---> DATE
"RTN","WVPROF2",98,0)
 .;---> QUIT IF NOT WITHIN DATE RANGE.
"RTN","WVPROF2",99,0)
 .;Q:WVDATE'>WVBEGDT1!(WVDATE>WVENDDT1)                ;---> XDATES
"RTN","WVPROF2",100,0)
 .S WVDATE1=$$SLDT2^WVUTL5(WVDATE1)
"RTN","WVPROF2",101,0)
 .S WVPSTAT=$S($P(Y,U,3):"PREGNANT",1:"NOT PREGNANT")  ;---> PREG STATUS
"RTN","WVPROF2",102,0)
 .S WVEDCL=$S(X:$$SLDT2^WVUTL5($P(Y,U,4)),1:"")        ;---> EDC
"RTN","WVPROF2",103,0)
 .;---> FOR PREGNANCIES, SET 1ST PIECE AND 6TH SUBSCRIPT=4.
"RTN","WVPROF2",104,0)
 .;S X=4_U_WVCHRT_U_WVNAME_U_WVDATE1_U_WVPSTAT_U_WVEDCL
"RTN","WVPROF2",105,0)
 .S X=4_U_U_U_WVDATE1_U_WVPSTAT_U_WVEDCL
"RTN","WVPROF2",106,0)
 .S ^TMP("WV",$J,1,9999999.9999-WVDATE,1,4,WVIEN)=X Q
"RTN","WVPROF2",107,0)
 Q
"RTN","WVPROF3")
0^36^B20962361
"RTN","WVPROF3",1,0)
WVPROF3 ;HCIOFO/FT,JR IHS/ANMC/MWR - DISPLAY PATIENT PROFILE; ;7/30/98  16:39
"RTN","WVPROF3",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPROF3",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROF3",4,0)
 ;;  DISPLAY CODE FOR PATIENT PROFILE.  CALLED BY WVPROF1.
"RTN","WVPROF3",5,0)
 ;
"RTN","WVPROF3",6,0)
NOMATCH ;EP
"RTN","WVPROF3",7,0)
 ;---> QUIT IF NO RECORDS MATCH.
"RTN","WVPROF3",8,0)
 N M
"RTN","WVPROF3",9,0)
 I '$D(^TMP("WV",$J,1)) D  Q
"RTN","WVPROF3",10,0)
 .D HEADER2^WVUTL7
"RTN","WVPROF3",11,0)
 .K WVPRMT,WVPRMT1,WVPRMTQ,DIR
"RTN","WVPROF3",12,0)
 .W !!?5,"No records match the selected criteria.",!
"RTN","WVPROF3",13,0)
 .I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVPROF3",14,0)
 .D ^%ZISC S WVPOP=1
"RTN","WVPROF3",15,0)
 ;
"RTN","WVPROF3",16,0)
 ;---> WVD=1:DETAILED DISPLAY, WVD=0:BRIEF DISPLAY.
"RTN","WVPROF3",17,0)
 I WVD D DISPLAY1 Q
"RTN","WVPROF3",18,0)
 D DISPLAY2
"RTN","WVPROF3",19,0)
 Q
"RTN","WVPROF3",20,0)
 ;
"RTN","WVPROF3",21,0)
 ;
"RTN","WVPROF3",22,0)
DISPLAY1 ;EP
"RTN","WVPROF3",23,0)
 ;---> IF A PROCEDURE IS EDITED ON THE LAST PAGE, GOTO HERE
"RTN","WVPROF3",24,0)
 ;---> FROM LINELABEL "END" BELOW.
"RTN","WVPROF3",25,0)
 D HEADER2^WVUTL7
"RTN","WVPROF3",26,0)
 F  S N=$O(^TMP("WV",$J,2,N)) Q:'N!(WVPOP)  D
"RTN","WVPROF3",27,0)
 .I $Y+5>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVPROF3",28,0)
 ..S WVPAGE=WVPAGE+1
"RTN","WVPROF3",29,0)
 ..D HEADER2^WVUTL7 S (WVACCP,Z)=0
"RTN","WVPROF3",30,0)
 .S Y=^TMP("WV",$J,2,N),M=N
"RTN","WVPROF3",31,0)
 .W !
"RTN","WVPROF3",32,0)
 .;
"RTN","WVPROF3",33,0)
 .;---> **********************
"RTN","WVPROF3",34,0)
 .;---> DISPLAY PROCEDURES
"RTN","WVPROF3",35,0)
 .;---> IF PIECE 1=1 DISPLAY AS A PROCEDURE.
"RTN","WVPROF3",36,0)
 .I $P(Y,U)=1 D  Q
"RTN","WVPROF3",37,0)
 ..W !,"------------------------------< "
"RTN","WVPROF3",38,0)
 ..W "PROCEDURE: ",$P(Y,U,5)," >"            ;PROCEDURE ABBREVIATION
"RTN","WVPROF3",39,0)
 ..W $$REPEAT^XLFSTR("-",(6-$L($P(Y,U,5))))
"RTN","WVPROF3",40,0)
 ..;F I=1:1:(6-$L($P(Y,U,5))) W "-"
"RTN","WVPROF3",41,0)
 ..W "-----------------------------"
"RTN","WVPROF3",42,0)
 ..W ! W:WVCRT $J(N,3),")" W ?WVTAB          ;BROWSE SELECTION#
"RTN","WVPROF3",43,0)
 ..W $P(Y,U,6)                               ;ACCESSION#
"RTN","WVPROF3",44,0)
 ..W ?17,$P(Y,U,4)                           ;DATE OF PROCEDURE
"RTN","WVPROF3",45,0)
 ..W ?27,"Res/Diag: ",$P(Y,U,7)              ;RESULTS/DIAGNOSIS
"RTN","WVPROF3",46,0)
 ..W !?27,"Provider: ",$E($P(Y,U,8),1,14)    ;PROVIDER
"RTN","WVPROF3",47,0)
 ..W ?62,"Status: ",$P(Y,U,9)                ;STATUS
"RTN","WVPROF3",48,0)
 ..S WVACCP=$P(Y,U,6)                        ;STORE AS PREVIOUS ACCESS#
"RTN","WVPROF3",49,0)
 .;
"RTN","WVPROF3",50,0)
 .;---> **********************
"RTN","WVPROF3",51,0)
 .;---> DISPLAY NOTIFICATIONS
"RTN","WVPROF3",52,0)
 .;---> IF PIECE 1=2 DISPLAY AS A NOTIFICATION.
"RTN","WVPROF3",53,0)
 .I $P(Y,U)=2 D  Q
"RTN","WVPROF3",54,0)
 ..S WVACC=$P(Y,U,5)
"RTN","WVPROF3",55,0)
 ..I WVACC'=Z D
"RTN","WVPROF3",56,0)
 ...W ! W:WVACC["NO ACC#" "-----------------" W ?17
"RTN","WVPROF3",57,0)
 ...W "-------------< NOTIFICATIONS >---------------------------------"
"RTN","WVPROF3",58,0)
 ..W ! W:WVCRT $J(N,3),")" W ?WVTAB           ;BROWSE SELECTION#
"RTN","WVPROF3",59,0)
 ..W:WVACC'=WVACCP!(WVACC["NO ACC#") WVACC    ;ACCESSION#
"RTN","WVPROF3",60,0)
 ..W ?17,$P(Y,U,4)                            ;DATE OF PROCEDURE
"RTN","WVPROF3",61,0)
 ..W ?27,$E($P(Y,U,6)_": "_$P(Y,U,7),1,53)    ;TYPE AND PURPOSE
"RTN","WVPROF3",62,0)
 ..W !?27,"Outcome: ",$E($P(Y,U,8),1,23)      ;OUTCOME OF NOTIFICATION
"RTN","WVPROF3",63,0)
 ..W ?62,"Status: ",$P(Y,U,9)                 ;STATUS
"RTN","WVPROF3",64,0)
 ..S (WVACCP,Z)=WVACC                         ;STORE AS PREVIOUS ACC#
"RTN","WVPROF3",65,0)
 ..;
"RTN","WVPROF3",66,0)
 ..;---> TWO VARIABLES (WVACCP & Z) USED ABOVE: "Z" SAYS "IF THIS NOTIF
"RTN","WVPROF3",67,0)
 ..;---> ACC# IS NOT THE SAME AS THE LAST ONE, DISPLAY --<NOT>-- BANNER.
"RTN","WVPROF3",68,0)
 ..;---> "WVACCP" SAYS "IF THIS NOTIF ACC# MATCHES THE LAST PROCEDURE'S
"RTN","WVPROF3",69,0)
 ..;---> ACC#, DON'T DISPLAY THE ACCESSION#."
"RTN","WVPROF3",70,0)
 ..;---> BOTH VARIABLES ARE RESET AFTER A FORMFEED, IN ORDER TO DISPLAY
"RTN","WVPROF3",71,0)
 ..;---> ON THE NEW PAGE.
"RTN","WVPROF3",72,0)
 .;
"RTN","WVPROF3",73,0)
 .;---> **********************
"RTN","WVPROF3",74,0)
 .;---> DISPLAY PAP REGIMENS
"RTN","WVPROF3",75,0)
 .;---> IF PIECE 1=3 DISPLAY AS A PAP REGIMEN.
"RTN","WVPROF3",76,0)
 .I $P(Y,U)=3 D  Q
"RTN","WVPROF3",77,0)
 ..W !,"------------------------------< PAP REGIMEN CHANGE"
"RTN","WVPROF3",78,0)
 ..W " >----------------------------"
"RTN","WVPROF3",79,0)
 ..W !?10,"Began:"
"RTN","WVPROF3",80,0)
 ..W ?17,$P(Y,U,4)                           ;DATE OF REGIMEN ENTRY
"RTN","WVPROF3",81,0)
 ..W ?27,"Regimen: ",$P(Y,U,5)               ;PAP REGIMEN
"RTN","WVPROF3",82,0)
 .;
"RTN","WVPROF3",83,0)
 .;---> **********************
"RTN","WVPROF3",84,0)
 .;---> DISPLAY PREGNANCIES
"RTN","WVPROF3",85,0)
 .;---> IF PIECE 1=4 DISPLAY AS A PREGNANCY.
"RTN","WVPROF3",86,0)
 .I $P(Y,U)=4 D  Q
"RTN","WVPROF3",87,0)
 ..W !,"------------------------------< PREGNANCY STATUS"
"RTN","WVPROF3",88,0)
 ..W " >------------------------------"
"RTN","WVPROF3",89,0)
 ..W !?8,"Entered:"
"RTN","WVPROF3",90,0)
 ..W ?17,$P(Y,U,4)                           ;DATE OF PREGNANCY EDIT.
"RTN","WVPROF3",91,0)
 ..W ?27,$P(Y,U,5)                           ;PREGNANT/NOT
"RTN","WVPROF3",92,0)
 ..W:$P(Y,U,6)]"" ?50,"EDC: ",$P(Y,U,6)      ;EDC
"RTN","WVPROF3",93,0)
 ;
"RTN","WVPROF3",94,0)
END ;EP
"RTN","WVPROF3",95,0)
 ;---> IF A PROCEDURE HAS BEEN EDITED, SET N=N-5 AND START (GOTO)
"RTN","WVPROF3",96,0)
 ;---> DISPLAY1 OVER AGAIN FROM 5 RECORDS PREVIOUS.
"RTN","WVPROF3",97,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 I N S N=N-1 G NOMATCH
"RTN","WVPROF3",98,0)
 D ^%ZISC
"RTN","WVPROF3",99,0)
 K N,Z
"RTN","WVPROF3",100,0)
 Q
"RTN","WVPROF3",101,0)
 ;
"RTN","WVPROF3",102,0)
 ;
"RTN","WVPROF3",103,0)
 ;
"RTN","WVPROF3",104,0)
DISPLAY2 ;EP
"RTN","WVPROF3",105,0)
 ;---> IF A PROCEDURE IS EDITED ON THE LAST PAGE, GOTO HERE
"RTN","WVPROF3",106,0)
 ;---> FROM LINELABEL "END" BELOW.
"RTN","WVPROF3",107,0)
 S WVSUBH="SUBHEAD^WVPROF1"
"RTN","WVPROF3",108,0)
 D HEADER2^WVUTL7
"RTN","WVPROF3",109,0)
 F  S N=$O(^TMP("WV",$J,2,N)) Q:'N!(WVPOP)  D
"RTN","WVPROF3",110,0)
 .I $Y+5>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVPROF3",111,0)
 ..S WVPAGE=WVPAGE+1
"RTN","WVPROF3",112,0)
 ..D HEADER2^WVUTL7 S (WVACCP,Z)=0
"RTN","WVPROF3",113,0)
 .S Y=^TMP("WV",$J,2,N),M=N
"RTN","WVPROF3",114,0)
 .;---> QUIT IF NOT A PROCEDURE (PIECE 1'=1).
"RTN","WVPROF3",115,0)
 .Q:$P(Y,U)'=1
"RTN","WVPROF3",116,0)
 .W ! W:WVCRT $J(N,3),")" W ?WVTAB          ;BROWSE SELECTION#
"RTN","WVPROF3",117,0)
 .W $P(Y,U,4)                               ;DATE OF PROCEDURE
"RTN","WVPROF3",118,0)
 .W ?17,$P(Y,U,5)                           ;PROCEDURE ABBREVIATION
"RTN","WVPROF3",119,0)
 .W ?27,$P(Y,U,7)                           ;RESULT
"RTN","WVPROF3",120,0)
 .W ?71,$P(Y,U,9)                           ;STATUS
"RTN","WVPROF3",121,0)
 .S WVACCP=$P(Y,U,6)                        ;STORE AS PREVIOUS ACCESS#
"RTN","WVPROF3",122,0)
END2 ;EP
"RTN","WVPROF3",123,0)
 ;---> IF A PROCEDURE HAS BEEN EDITED, SET N=N-1 AND START (GOTO)
"RTN","WVPROF3",124,0)
 ;---> DISPLAY2 OVER AGAIN FROM 5 RECORDS PREVIOUS.
"RTN","WVPROF3",125,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 I N S N=N-1 G NOMATCH
"RTN","WVPROF3",126,0)
 D ^%ZISC
"RTN","WVPROF3",127,0)
 K N,Z
"RTN","WVPROF3",128,0)
 Q
"RTN","WVPRPCD")
0^37^B21766511
"RTN","WVPRPCD",1,0)
WVPRPCD ;HCIOFO/FT,JR IHS/ANMC/MWR - WV PRINT A PROCEDURE; ;9/17/98  16:23
"RTN","WVPRPCD",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPRPCD",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPRPCD",4,0)
 ;;  DISPLAY CODE FOR PRINTING PROCEDURES.  ENTRY POINTS FOR PRINTING
"RTN","WVPRPCD",5,0)
 ;;  INDIVIDUAL PROCEDURES AND ALL NEW PROCEDURES.
"RTN","WVPRPCD",6,0)
 ;
"RTN","WVPRPCD",7,0)
TOP(DA) ;EP
"RTN","WVPRPCD",8,0)
 ;---> PRINT PROCEDURE (NOT CALLED BY ANY OPTION).
"RTN","WVPRPCD",9,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF PROCEDURE IN PROC FILE 790.1.
"RTN","WVPRPCD",10,0)
 ;
"RTN","WVPRPCD",11,0)
 D SETVARS^WVUTL5
"RTN","WVPRPCD",12,0)
 D DEVICE Q:WVPOP
"RTN","WVPRPCD",13,0)
 D START(DA)
"RTN","WVPRPCD",14,0)
 D ^%ZISC
"RTN","WVPRPCD",15,0)
 W @IOF
"RTN","WVPRPCD",16,0)
 Q
"RTN","WVPRPCD",17,0)
 ;
"RTN","WVPRPCD",18,0)
 ;
"RTN","WVPRPCD",19,0)
STARTQ ;EP
"RTN","WVPRPCD",20,0)
 ;---> ENTRY POINT FOR TASKMAN--CANNOT PASS PARAMETERS.
"RTN","WVPRPCD",21,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF PROCEDURE IN PROC FILE 790.1.
"RTN","WVPRPCD",22,0)
 D START(DA)
"RTN","WVPRPCD",23,0)
 Q
"RTN","WVPRPCD",24,0)
 ;
"RTN","WVPRPCD",25,0)
 ;
"RTN","WVPRPCD",26,0)
START(DA) ;EP
"RTN","WVPRPCD",27,0)
 N WVPRMT1,WVTITLE,WVY,N,X
"RTN","WVPRPCD",28,0)
 D SETVARS^WVUTL5
"RTN","WVPRPCD",29,0)
 S WVSL="I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER4^WVUTL7"
"RTN","WVPRPCD",30,0)
 D TOPHEAD^WVUTL7,PCDVARS^WVUTL3(DA)
"RTN","WVPRPCD",31,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (SET BY TOPHEAD^WVUTL7).
"RTN","WVPRPCD",32,0)
 S WVTITLE1="* * *  WOMEN'S HEALTH: PROCEDURE PRINTOUT  * * *"
"RTN","WVPRPCD",33,0)
 D CENTERT^WVUTL5(.WVTITLE1)
"RTN","WVPRPCD",34,0)
 S WVPRMT1="   Press RETURN to continue or '^'to exit, or"
"RTN","WVPRPCD",35,0)
 S WVY=^WV(790.1,DA,0),WVDFN=$P(WVY,U,2)
"RTN","WVPRPCD",36,0)
 ;
"RTN","WVPRPCD",37,0)
 U IO
"RTN","WVPRPCD",38,0)
 D HEADER4^WVUTL7 W:'WVCRT !
"RTN","WVPRPCD",39,0)
 W !?5,"Date of Procedure: ",$$TXDT^WVUTL5($P(WVY,U,12))
"RTN","WVPRPCD",40,0)
 W !?4,"Date First Entered: ",$$TXDT^WVUTL5($P(WVY,U,19))
"RTN","WVPRPCD",41,0)
 W ?42,"First Entered By: " S X=$P(WVY,U,18) W $E($$PROV^WVUTL6,1,20)
"RTN","WVPRPCD",42,0)
 W ! W:$P(WVY,U,15)]"" ?43,"Radiology Case#: ",$P(WVY,U,15)
"RTN","WVPRPCD",43,0)
 W !?4,"Clinician/Provider: ",WVPROV
"RTN","WVPRPCD",44,0)
 W !?2,"Ward/Clinic/Location: " S X=$P(WVY,U,11) W $$HOSPLC^WVUTL6
"RTN","WVPRPCD",45,0)
 W !?2,"Health Care Facility: " S X=$P(WVY,U,10) W $$INSTTX^WVUTL6(X)
"RTN","WVPRPCD",46,0)
 W !?14,"Comments: "
"RTN","WVPRPCD",47,0)
 ;---> WRITE OUT CLINICAL HISTORY; IF TWO LINES, SPLIT BETWEEN WORDS.
"RTN","WVPRPCD",48,0)
 D
"RTN","WVPRPCD",49,0)
 .Q:'$D(^WV(790.1,DA,3))
"RTN","WVPRPCD",50,0)
 .N L,Y
"RTN","WVPRPCD",51,0)
 .S Y=$P(^WV(790.1,DA,3),U)
"RTN","WVPRPCD",52,0)
 .I $L(Y)<57 W Y,! Q
"RTN","WVPRPCD",53,0)
 .S L=56 I Y[" " F  Q:$E(Y,L)=" "  S L=L-1
"RTN","WVPRPCD",54,0)
 .W $E(Y,1,L),! W:$L(Y)>56 ?24,$E(Y,L+1,109)
"RTN","WVPRPCD",55,0)
 ;
"RTN","WVPRPCD",56,0)
 W !?4,"Complete by (Date): ",$$TXDT^WVUTL5($P(WVY,U,13))
"RTN","WVPRPCD",57,0)
 W !?5,"Results/Diagnosis: ",WVRES
"RTN","WVPRPCD",58,0)
 W !," Sec Results/diagnosis: " W $$DIAG^WVUTL4($P(WVY,U,6))
"RTN","WVPRPCD",59,0)
 W ?57,"HPV: " W:$P(WVY,U,8) "YES"
"RTN","WVPRPCD",60,0)
 W !?16,"Status: " S Y=WVY W $$STATUS^WVUTL4
"RTN","WVPRPCD",61,0)
 ;
"RTN","WVPRPCD",62,0)
 ;---> IF THIS PROCEDURE HAS COLPOSCOPY-TYPE RESULTS, DISPLAY COLP PAGE.
"RTN","WVPRPCD",63,0)
 D:$$COLP^WVUTL4(DA)  Q:WVPOP
"RTN","WVPRPCD",64,0)
 .I WVCRT D DIRZ^WVUTL3 Q:WVPOP  D HEADER4^WVUTL7
"RTN","WVPRPCD",65,0)
 .S WVTITLE="-----  CLINICAL FINDINGS  -----"
"RTN","WVPRPCD",66,0)
 .D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE
"RTN","WVPRPCD",67,0)
 .;
"RTN","WVPRPCD",68,0)
 .X WVSL Q:WVPOP  W !?2,"T-Zone Seen Entirely: "
"RTN","WVPRPCD",69,0)
 .W $S($P(WVY,U,21):"YES",$P(WVY,U,21)=0:"NO",1:"")
"RTN","WVPRPCD",70,0)
 .W ?54,"Multifocal: "
"RTN","WVPRPCD",71,0)
 .W $S($P(WVY,U,21):"YES",$P(WVY,U,21)=0:"NO",1:"")
"RTN","WVPRPCD",72,0)
 .;
"RTN","WVPRPCD",73,0)
 .X WVSL Q:WVPOP  W !?2,"Lesion Outside Canal: "
"RTN","WVPRPCD",74,0)
 .W $S($P(WVY,U,22):"YES",$P(WVY,U,22)=0:"NO",1:"")
"RTN","WVPRPCD",75,0)
 .W ?45,"Number of Quadrants: " W $P(WVY,U,24)
"RTN","WVPRPCD",76,0)
 .;
"RTN","WVPRPCD",77,0)
 .X WVSL Q:WVPOP  W !?5,"Satisfactory Exam: "
"RTN","WVPRPCD",78,0)
 .W $S($P(WVY,U,20):"YES",$P(WVY,U,20)=0:"NO",1:"")
"RTN","WVPRPCD",79,0)
 .W ?46,"Quadrant Locations: ",$P($G(^WV(790.1,DA,2)),U,16)
"RTN","WVPRPCD",80,0)
 .X WVSL Q:WVPOP  W !?12,"Impression: "
"RTN","WVPRPCD",81,0)
 .W $$DIAG^WVUTL4($P(WVY,U,29))
"RTN","WVPRPCD",82,0)
 .;
"RTN","WVPRPCD",83,0)
 .X WVSL Q:WVPOP  S WVTITLE="-----  TISSUE PATHOLOGY  -----"
"RTN","WVPRPCD",84,0)
 .D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE
"RTN","WVPRPCD",85,0)
 .;
"RTN","WVPRPCD",86,0)
 .X WVSL Q:WVPOP  W !?9,"ECC Dysplasia: "
"RTN","WVPRPCD",87,0)
 .S X=$P(WVY,U,25) W $$ECCDYS^WVUTL6
"RTN","WVPRPCD",88,0)
 .W ?57,"Margins Clear: "
"RTN","WVPRPCD",89,0)
 .W $S($P(WVY,U,27):"YES",$P(WVY,U,27)=0:"NO",1:"") X WVSL Q:WVPOP
"RTN","WVPRPCD",90,0)
 .X WVSL Q:WVPOP  W !?3,"Ectocervical Biopsy: "
"RTN","WVPRPCD",91,0)
 .W $$DIAG^WVUTL4($P(WVY,U,26))
"RTN","WVPRPCD",92,0)
 .W ?57,"Stage: "
"RTN","WVPRPCD",93,0)
 .W $$STAGE^WVUTL4($P(WVY,U,31)) X WVSL Q:WVPOP
"RTN","WVPRPCD",94,0)
 .X WVSL Q:WVPOP  W !?8,"STD Evaluation: "
"RTN","WVPRPCD",95,0)
 .W $$DIAG^WVUTL4($P(WVY,U,28))
"RTN","WVPRPCD",96,0)
 ;
"RTN","WVPRPCD",97,0)
 I WVCRT D DIRZ^WVUTL3 Q:WVPOP  D HEADER4^WVUTL7
"RTN","WVPRPCD",98,0)
 S WVTITLE="-----  RESULTS TEXT  -----  "
"RTN","WVPRPCD",99,0)
 D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE,!
"RTN","WVPRPCD",100,0)
 S WVTITLE="-----  RESULTS TEXT (continued)  -----"
"RTN","WVPRPCD",101,0)
 D CENTERT^WVUTL5(.WVTITLE) S WVSUBH=WVTITLE
"RTN","WVPRPCD",102,0)
 S N=0
"RTN","WVPRPCD",103,0)
 F  S N=$O(^WV(790.1,DA,1,N)) Q:'N!(WVPOP)  D
"RTN","WVPRPCD",104,0)
 .X WVSL Q:WVPOP
"RTN","WVPRPCD",105,0)
 .W !,^WV(790.1,DA,1,N,0)
"RTN","WVPRPCD",106,0)
 S WVTITLE="-----  End of Procedure Printout  -----"
"RTN","WVPRPCD",107,0)
 D CENTERT^WVUTL5(.WVTITLE) W !!,WVTITLE
"RTN","WVPRPCD",108,0)
 K WVSUBH
"RTN","WVPRPCD",109,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 W @IOF
"RTN","WVPRPCD",110,0)
 Q
"RTN","WVPRPCD",111,0)
 ;
"RTN","WVPRPCD",112,0)
DEVICE ;EP
"RTN","WVPRPCD",113,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVPRPCD",114,0)
 S ZTRTN="STARTQ^WVPRPCD",ZTSAVE("DA")=""
"RTN","WVPRPCD",115,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVPRPCD",116,0)
 Q
"RTN","WVPRPCD",117,0)
 ;
"RTN","WVPRPCD",118,0)
JUSTPRT ;EP
"RTN","WVPRPCD",119,0)
 ;---> CALLED BY OPTION: "WV  PRINT INDIVIDUAL PROCEDURES".
"RTN","WVPRPCD",120,0)
 ;---> JUST PRINT AN INDIVIDUAL PROCEDURE.
"RTN","WVPRPCD",121,0)
 N DA,Y
"RTN","WVPRPCD",122,0)
 F  D  Q:Y<0
"RTN","WVPRPCD",123,0)
 .D TITLE^WVUTL5("PRINT A PROCEDURE")
"RTN","WVPRPCD",124,0)
 .D LKUPPCD^WVPROC(.Y)
"RTN","WVPRPCD",125,0)
 .Q:Y<0
"RTN","WVPRPCD",126,0)
 .D TOP(+Y)
"RTN","WVPRPCD",127,0)
 D EXIT
"RTN","WVPRPCD",128,0)
 Q
"RTN","WVPRPCD",129,0)
 ;
"RTN","WVPRPCD",130,0)
PRTNEW ;EP
"RTN","WVPRPCD",131,0)
 ;---> CALLED BY OPTION: "WV PRINT ALL NEW PROCEDURES".
"RTN","WVPRPCD",132,0)
 ;---> PRINT ALL PROCEDURES WITH A STATUS OF "NEW" (NEW UPLOADED
"RTN","WVPRPCD",133,0)
 ;---> LAB RESULTS).
"RTN","WVPRPCD",134,0)
 D TITLE^WVUTL5("PRINT ALL ""NEW"" PROCEDURES")
"RTN","WVPRPCD",135,0)
 S ZTRTN="DEQUEUE^WVPRPCD"
"RTN","WVPRPCD",136,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVPRPCD",137,0)
 Q:WVPOP
"RTN","WVPRPCD",138,0)
 ;
"RTN","WVPRPCD",139,0)
DEQUEUE ;EP
"RTN","WVPRPCD",140,0)
 ;---> FOR TASKMAN QUEUE OF PRINTOUT.
"RTN","WVPRPCD",141,0)
 S N=0
"RTN","WVPRPCD",142,0)
 F  S N=$O(^WV(790.1,"S","n",N)) Q:'N  D
"RTN","WVPRPCD",143,0)
 .D START(N)
"RTN","WVPRPCD",144,0)
 D ^%ZISC,EXIT
"RTN","WVPRPCD",145,0)
 Q
"RTN","WVPRPCD",146,0)
 ;
"RTN","WVPRPCD",147,0)
EXIT ;EP
"RTN","WVPRPCD",148,0)
 D KILLALL^WVUTL8
"RTN","WVPRPCD",149,0)
 Q
"RTN","WVPURP")
0^38^B14528456
"RTN","WVPURP",1,0)
WVPURP ;HCIOFO/FT,JR IHS/ANMC/MWR - NOTIFICATION TABLES MAINTENANC;
"RTN","WVPURP",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVPURP",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPURP",4,0)
 ;;  ADD/EDIT/PRINT NOTIFICATION PURPOSE FILE ENTRIES, EDIT PCD DAYS,
"RTN","WVPURP",5,0)
 ;;  EDIT NOTIFICATION TYPE SYNONYMS, ADD/EDIT NOTIFICATION OUTCOMES.
"RTN","WVPURP",6,0)
 ;;
"RTN","WVPURP",7,0)
 ;
"RTN","WVPURP",8,0)
PRINTPUR ;EP
"RTN","WVPURP",9,0)
 ;---> CALLED BY OPTION "WV PRINT NOTIF PURPOSE&LETTER".
"RTN","WVPURP",10,0)
 S DIC="^WV(790.404,"
"RTN","WVPURP",11,0)
 S FLDS="[WV PRINT NOTIF PURPOSE&LETTER]"
"RTN","WVPURP",12,0)
 S BY=.01,FR="",TO="",DHD="@"
"RTN","WVPURP",13,0)
 S DIOBEG="S WVPAGE=0"
"RTN","WVPURP",14,0)
 D EN1^DIP
"RTN","WVPURP",15,0)
 D KILLALL^WVUTL8
"RTN","WVPURP",16,0)
 Q
"RTN","WVPURP",17,0)
 ;
"RTN","WVPURP",18,0)
 ;
"RTN","WVPURP",19,0)
EDITPUR ;EP
"RTN","WVPURP",20,0)
 ;---> CALLED BY OPTION "WV EDIT NOTIF PURPOSE&LETTER".
"RTN","WVPURP",21,0)
 D SETVARS^WVUTL5
"RTN","WVPURP",22,0)
 ;---> DISPLAY MENU TITLE FROM WV MENU OPTIONS.
"RTN","WVPURP",23,0)
 F  D  Q:$G(Y)<0
"RTN","WVPURP",24,0)
 .D TITLE^WVUTL5("EDIT NOTIFICATION PURPOSE & LETTER FILE")
"RTN","WVPURP",25,0)
 .D DIC^WVFMAN(790.404,"QEMAL",.Y)
"RTN","WVPURP",26,0)
 .Q:Y<0
"RTN","WVPURP",27,0)
 .S DA=+Y
"RTN","WVPURP",28,0)
 .D:$P(Y,U,3) ADDLET
"RTN","WVPURP",29,0)
 .D:'$P(Y,U,3) REPLACE
"RTN","WVPURP",30,0)
 .Q:WVPOP
"RTN","WVPURP",31,0)
 .;---> EDIT WITH SCREENMAN.
"RTN","WVPURP",32,0)
 .S DR="[WV NOTIFPURPOSE-FORM-1]"
"RTN","WVPURP",33,0)
 .D DDS^WVFMAN(790.404,DR,DA,"","",.WVPOP)
"RTN","WVPURP",34,0)
 D KILLALL^WVUTL8
"RTN","WVPURP",35,0)
 Q
"RTN","WVPURP",36,0)
 ;
"RTN","WVPURP",37,0)
 ;
"RTN","WVPURP",38,0)
ADDLET ;EP
"RTN","WVPURP",39,0)
 ;---> CALLED BY OPTION "WV ADD NOTIF PURPOSE&LETTER".
"RTN","WVPURP",40,0)
 K ^WV(790.404,DA,1)
"RTN","WVPURP",41,0)
 N N S N=0
"RTN","WVPURP",42,0)
 F  S N=$O(^WV(790.6,1,1,N)) Q:'N  D
"RTN","WVPURP",43,0)
 .S ^WV(790.404,DA,1,N,0)=^WV(790.6,1,1,N,0)
"RTN","WVPURP",44,0)
 S ^WV(790.404,DA,1,0)=^WV(790.6,1,1,0)
"RTN","WVPURP",45,0)
 Q
"RTN","WVPURP",46,0)
 ;
"RTN","WVPURP",47,0)
REPLACE ;EP
"RTN","WVPURP",48,0)
 ;---> REPLACE OLD LETTER FOR THIS NOTIF PURPOSE WITH GENERIC SAMPLE.
"RTN","WVPURP",49,0)
 N DIR,DIRUT,Y
"RTN","WVPURP",50,0)
 W !!?3,"Do you wish to delete the old letter for this Purpose of "
"RTN","WVPURP",51,0)
 W "Notification",!?3,"and replace it with the generic sample letter?"
"RTN","WVPURP",52,0)
 S DIR(0)="YA",DIR("B")="NO"
"RTN","WVPURP",53,0)
 S DIR("A")="   Enter Yes or No: " D HELP1
"RTN","WVPURP",54,0)
 D ^DIR W !
"RTN","WVPURP",55,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVPURP",56,0)
 I Y D ADDLET
"RTN","WVPURP",57,0)
 Q
"RTN","WVPURP",58,0)
 ;
"RTN","WVPURP",59,0)
HELP1 ;EP
"RTN","WVPURP",60,0)
 ;;Enter YES to delete the old letter for this Purpose of Notification
"RTN","WVPURP",61,0)
 ;;and to begin with a fresh copy of the generic sample letter.
"RTN","WVPURP",62,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVPURP",63,0)
 Q
"RTN","WVPURP",64,0)
 ;
"RTN","WVPURP",65,0)
HELPTX ;EP
"RTN","WVPURP",66,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVPURP",67,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVPURP",68,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVPURP",69,0)
 Q
"RTN","WVPURP",70,0)
 ;
"RTN","WVPURP",71,0)
TYPE ;EP
"RTN","WVPURP",72,0)
 ;---> EDIT SYNONYMS FOR NOTIFICATION TYPES.
"RTN","WVPURP",73,0)
 D SETVARS^WVUTL5
"RTN","WVPURP",74,0)
 F  D  Q:$G(Y)<0
"RTN","WVPURP",75,0)
 .D TITLE^WVUTL5("EDIT SYNONYMS FOR NOTIFICATION TYPES") D TEXT1
"RTN","WVPURP",76,0)
 .N A S A="   Select NOTIFICATION TYPE: "
"RTN","WVPURP",77,0)
 .D DIC^WVFMAN(790.403,"QEMA",.Y,A)
"RTN","WVPURP",78,0)
 .Q:Y<0
"RTN","WVPURP",79,0)
 .D DIE^WVFMAN(790.403,.03,+Y,.WVPOP)
"RTN","WVPURP",80,0)
 W @IOF
"RTN","WVPURP",81,0)
 D KILLALL^WVUTL8
"RTN","WVPURP",82,0)
 Q
"RTN","WVPURP",83,0)
 ;
"RTN","WVPURP",84,0)
OUTCOME ;EP
"RTN","WVPURP",85,0)
 ;---> ADD/EDIT NOTIFICATION OUTCOME FILE.
"RTN","WVPURP",86,0)
 D SETVARS^WVUTL5
"RTN","WVPURP",87,0)
 F  D  Q:$G(Y)<0
"RTN","WVPURP",88,0)
 .D TITLE^WVUTL5("ADD/EDIT NOTIFICATION OUTCOME FILE")
"RTN","WVPURP",89,0)
 .D DIC^WVFMAN(790.405,"QEMAL",.Y,"   Select OUTCOME: ")
"RTN","WVPURP",90,0)
 .Q:Y<0
"RTN","WVPURP",91,0)
 .D DIE^WVFMAN(790.405,.02,+Y,.WVPOP)
"RTN","WVPURP",92,0)
 W @IOF
"RTN","WVPURP",93,0)
 D KILLALL^WVUTL8
"RTN","WVPURP",94,0)
 Q
"RTN","WVPURP",95,0)
 ;
"RTN","WVPURP",96,0)
TEXT1 ;EP
"RTN","WVPURP",97,0)
 ;;You may enter a synonym for each Notification Type.  The synonym will
"RTN","WVPURP",98,0)
 ;;allow the Notification Type to be called up by typing only a few
"RTN","WVPURP",99,0)
 ;;characters.  Synonyms should be unique and less than 4 characters.
"RTN","WVPURP",100,0)
 ;;
"RTN","WVPURP",101,0)
 ;;For example, "L1" might be used for LETTER,FIRST; "L2" for
"RTN","WVPURP",102,0)
 ;;LETTER,SECOND; "L3" for LETTER,THIRD, and so on.
"RTN","WVPURP",103,0)
 ;;
"RTN","WVPURP",104,0)
 ;;
"RTN","WVPURP",105,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVPURP",106,0)
 Q
"RTN","WVPURP",107,0)
 ;
"RTN","WVPURP",108,0)
PRINTX ;EP
"RTN","WVPURP",109,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVPURP",110,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVPURP",111,0)
 Q
"RTN","WVPURP",112,0)
 ;
"RTN","WVPURP",113,0)
GENSTUFF ;EP
"RTN","WVPURP",114,0)
 ;---> STUFF THE GENERIC SAMPLE LETTER INTO ALL PURPOSES OF NOTIF.
"RTN","WVPURP",115,0)
 N DA
"RTN","WVPURP",116,0)
 S DA=0
"RTN","WVPURP",117,0)
 F  S DA=$O(^WV(790.404,DA)) Q:'DA  W !,DA  D ADDLET^WVPURP
"RTN","WVPURP",118,0)
 Q
"RTN","WVRAD")
0^39^B2023390
"RTN","WVRAD",1,0)
WVRAD ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: MOSTLY PATIENT DATA ;7/22/98  09:46
"RTN","WVRAD",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRAD",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRAD",4,0)
 ;;  EDIT WV MAMMOGRAM DIAG CODE TRANSLATIONS FILE.
"RTN","WVRAD",5,0)
 ;;  PRINT WV MAMMOGRAM DIAG CODE TRANSLATIONS FILE.
"RTN","WVRAD",6,0)
 ;
"RTN","WVRAD",7,0)
 ;
"RTN","WVRAD",8,0)
EDIT ;---> MATCH WV RESULTS/DIAGNOSES WITH RADIOLOGY DIAGNOSTIC CODES.
"RTN","WVRAD",9,0)
 ;---> CALLED BY OPTION "WV EDIT DIAG TRANSLATION".
"RTN","WVRAD",10,0)
 D SETVARS^WVUTL5
"RTN","WVRAD",11,0)
 F  D  Q:$G(Y)<0
"RTN","WVRAD",12,0)
 .D TITLE^WVUTL5("EDIT WV DIAGNOSTIC CODE TRANSLATION FILE")
"RTN","WVRAD",13,0)
 .D DIC^WVFMAN(790.32,"QEMAL",.Y,"   Select RESULT/DIAGNOSIS: ")
"RTN","WVRAD",14,0)
 .Q:Y<0
"RTN","WVRAD",15,0)
 .D DIE^WVFMAN(790.32,".01;.02",+Y,.WVPOP)
"RTN","WVRAD",16,0)
 D EXIT
"RTN","WVRAD",17,0)
 Q
"RTN","WVRAD",18,0)
 ;
"RTN","WVRAD",19,0)
SCREEN ;
"RTN","WVRAD",20,0)
 ;---> SCREEN CALLED BY FILEMAN ^DD(790.32,.01
"RTN","WVRAD",21,0)
 ;---> SCREEN ONLY FOR RESULTS/DIAGNOSES THAT APPLY TO MAMMOGRAMS.
"RTN","WVRAD",22,0)
 ;---> HARDCODED FOR MAM IENS=25, 26 OR 28.  CALLED BY ^DIC.
"RTN","WVRAD",23,0)
 N I
"RTN","WVRAD",24,0)
 F I=3:1:19 I $P(^(0),U,I)=25!($P(^(0),U,I)=26)!($P(^(0),U,I)=28) Q
"RTN","WVRAD",25,0)
 Q
"RTN","WVRAD",26,0)
 ;
"RTN","WVRAD",27,0)
 ;
"RTN","WVRAD",28,0)
PRINT ;EP
"RTN","WVRAD",29,0)
 ;---> CALLED BY OPTION "WV PRINT DIAG TRANSLATION".
"RTN","WVRAD",30,0)
 S DIC="^WV(790.32,"
"RTN","WVRAD",31,0)
 S FLDS="[WV PRINT DIAG CODE TRANSLATION]"
"RTN","WVRAD",32,0)
 S BY=.01,FR="AAAA",TO="ZZZZ"
"RTN","WVRAD",33,0)
 K IO("Q") S %ZIS="Q" D ^%ZIS I POP D EXIT Q
"RTN","WVRAD",34,0)
 S IOP=ION I $D(IO("Q")) S IOP="Q;"_ION
"RTN","WVRAD",35,0)
 K IO("Q") S WVIOST=$E(IOST)
"RTN","WVRAD",36,0)
 D EN1^DIP
"RTN","WVRAD",37,0)
 D:$E(WVIOST)="C" DIRZ^WVUTL3
"RTN","WVRAD",38,0)
 K IOP,WVIOST
"RTN","WVRAD",39,0)
 D EXIT
"RTN","WVRAD",40,0)
 Q
"RTN","WVRAD",41,0)
 ;
"RTN","WVRAD",42,0)
EXIT ;EP
"RTN","WVRAD",43,0)
 D KILLALL^WVUTL8
"RTN","WVRAD",44,0)
 Q
"RTN","WVRADWP")
0^40^B23566212
"RTN","WVRADWP",1,0)
WVRADWP ;HCIOFO/FT-Display Report Data from Related Packages  ;9/14/98  13:37
"RTN","WVRADWP",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRADWP",3,0)
 ;
"RTN","WVRADWP",4,0)
EN ; Determine which report to show (i.e., radiology/nuclear medicine)
"RTN","WVRADWP",5,0)
 ; Called from Edit a Procedure option screen form.
"RTN","WVRADWP",6,0)
 D EX
"RTN","WVRADWP",7,0)
 Q:'$G(DA)
"RTN","WVRADWP",8,0)
 Q:'$D(^WV(790.1,+DA,0))
"RTN","WVRADWP",9,0)
 N WV7901
"RTN","WVRADWP",10,0)
 S WV7901=$E(^WV(790.1,+DA,0),1,2) ;first 2 characters of accession code
"RTN","WVRADWP",11,0)
 Q:WV7901=""
"RTN","WVRADWP",12,0)
 I "^BU^MB^MU^MS^"[WV7901 D EN1 Q  ;show rad/nm report data
"RTN","WVRADWP",13,0)
 Q
"RTN","WVRADWP",14,0)
EN1 ; Set up radiology report data and call FM Browser
"RTN","WVRADWP",15,0)
 N LOOP,WVLCNT,WVRADCSE,WVRADDFN,WVRADDTE,WVRADIEN,WVRPTIEN
"RTN","WVRADWP",16,0)
 S WVRADIEN=$P(^WV(790.1,DA,0),U,15)
"RTN","WVRADWP",17,0)
 Q:WVRADIEN=""  ;no 'radiology mam case #'
"RTN","WVRADWP",18,0)
 S WVRADDFN=$O(^RADPT("ADC",WVRADIEN,0))
"RTN","WVRADWP",19,0)
 Q:'WVRADDFN  ;no dfn
"RTN","WVRADWP",20,0)
 S WVRADDTE=$O(^RADPT("ADC",WVRADIEN,WVRADDFN,0))
"RTN","WVRADWP",21,0)
 Q:'WVRADDTE  ;no inverse exam date
"RTN","WVRADWP",22,0)
 S WVRADCSE=$O(^RADPT("ADC",WVRADIEN,WVRADDFN,WVRADDTE,0))
"RTN","WVRADWP",23,0)
 Q:'WVRADCSE  ;no case number
"RTN","WVRADWP",24,0)
 S WVRPTIEN=+$P(^RADPT(WVRADDFN,"DT",WVRADDTE,"P",WVRADCSE,0),U,17)
"RTN","WVRADWP",25,0)
 Q:'WVRPTIEN  ;no report in File 74
"RTN","WVRADWP",26,0)
 K ^TMP($J,"WV RADRPT"),^TMP("WV RADRPT",$J)
"RTN","WVRADWP",27,0)
 D GETS^DIQ(74,WVRPTIEN_",","*","EI","^TMP($J,""WV RADRPT"")")
"RTN","WVRADWP",28,0)
 S ^TMP("WV RADRPT",$J,1,0)="                   DAY-CASE #: "_$G(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",.01,"E"))
"RTN","WVRADWP",29,0)
 S ^TMP("WV RADRPT",$J,2,0)="               EXAM DATE/TIME: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",3,"E")
"RTN","WVRADWP",30,0)
 S ^TMP("WV RADRPT",$J,3,0)="          VERIFYING PHYSICIAN: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",9,"E")
"RTN","WVRADWP",31,0)
 S ^TMP("WV RADRPT",$J,4,0)="                    PROCEDURE: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",102,"E")
"RTN","WVRADWP",32,0)
 S ^TMP("WV RADRPT",$J,5,0)="             CATEGORY OF EXAM: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",104,"E")
"RTN","WVRADWP",33,0)
 S ^TMP("WV RADRPT",$J,6,0)="                         WARD: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",106,"E")
"RTN","WVRADWP",34,0)
 S ^TMP("WV RADRPT",$J,7,0)=" TREATING SERVICE (INPATIENT): "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",107,"E")
"RTN","WVRADWP",35,0)
 S ^TMP("WV RADRPT",$J,8,0)="             PRINCIPAL CLINIC: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",108,"E")
"RTN","WVRADWP",36,0)
 S ^TMP("WV RADRPT",$J,9,0)="      CONTRACT SHARING SOURCE: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",109,"E")
"RTN","WVRADWP",37,0)
 S ^TMP("WV RADRPT",$J,10,0)="PRIMARY INTERPRETING RESIDENT: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",112,"E")
"RTN","WVRADWP",38,0)
 S ^TMP("WV RADRPT",$J,11,0)="   PRIMARY INTERPRETING STAFF: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",115,"E")
"RTN","WVRADWP",39,0)
 S ^TMP("WV RADRPT",$J,12,0)="            PRIMARY DIAGNOSIS: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",113,"E")
"RTN","WVRADWP",40,0)
 S ^TMP("WV RADRPT",$J,13,0)="         REQUESTING PHYSICIAN: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",114,"E")
"RTN","WVRADWP",41,0)
 S ^TMP("WV RADRPT",$J,14,0)="                 COMPLICATION: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",116,"E")
"RTN","WVRADWP",42,0)
 S ^TMP("WV RADRPT",$J,15,0)=" "
"RTN","WVRADWP",43,0)
 S ^TMP("WV RADRPT",$J,16,0)="CLINICAL HISTORY:"
"RTN","WVRADWP",44,0)
 S LOOP=0,WVLCNT=16
"RTN","WVRADWP",45,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",400,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",46,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",47,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",400,LOOP)
"RTN","WVRADWP",48,0)
 .Q
"RTN","WVRADWP",49,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",50,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)=" "
"RTN","WVRADWP",51,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",52,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)="IMPRESSION TEXT:"
"RTN","WVRADWP",53,0)
 S LOOP=0
"RTN","WVRADWP",54,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",300,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",55,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",56,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",300,LOOP)
"RTN","WVRADWP",57,0)
 .Q
"RTN","WVRADWP",58,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",59,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)=" "
"RTN","WVRADWP",60,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",61,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)="REPORT TEXT:"
"RTN","WVRADWP",62,0)
 S LOOP=0
"RTN","WVRADWP",63,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",200,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",64,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",65,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",200,LOOP)
"RTN","WVRADWP",66,0)
 .Q
"RTN","WVRADWP",67,0)
 K ^TMP($J,"WV RADRPT"),WVLCNT,^WV(790.1,DA,9)
"RTN","WVRADWP",68,0)
 S WVJCN=0 F  S WVJCN=$O(^TMP("WV RADRPT",$J,WVJCN)) Q:WVJCN'>0  D
"RTN","WVRADWP",69,0)
 .S ^WV(790.1,DA,9,WVJCN,0)=$G(^TMP("WV RADRPT",$J,WVJCN,0)) S WVJCN1=WVJCN
"RTN","WVRADWP",70,0)
 S ^WV(790.1,DA,9,0)="^^WVJCN1^WVJCN1"
"RTN","WVRADWP",71,0)
 K ^TMP("WV RADRPT",$J)
"RTN","WVRADWP",72,0)
 Q
"RTN","WVRADWP",73,0)
EX ; delete existing radiology report text stored in WH
"RTN","WVRADWP",74,0)
 K ^WV(790.1,DA,9)
"RTN","WVRADWP",75,0)
 Q
"RTN","WVRADWP",76,0)
MAIL(DFN,WVACCESS,WVPROC,WVPROV) ; Send mail message to case manager when
"RTN","WVRADWP",77,0)
 ; Radiology procedure is added to WH Procedure file (#790.1).
"RTN","WVRADWP",78,0)
 ; Called from WVRALINK
"RTN","WVRADWP",79,0)
 ;      DFN -> Patient ien
"RTN","WVRADWP",80,0)
 ; WVACCESS -> File 790.1 ien (procedure entry)
"RTN","WVRADWP",81,0)
 ;   WVPROC -> File 790.2 ien (procedure type)
"RTN","WVRADWP",82,0)
 ;   WVPROV -> File 200   IEN (provider/requestor)
"RTN","WVRADWP",83,0)
 Q:'$G(DFN)!('$G(WVACCESS))!('$G(WVPROC))
"RTN","WVRADWP",84,0)
 N WVCMGR,WVLOOP,WVMSG,XMDUZ,XMSUB,XMTEXT
"RTN","WVRADWP",85,0)
 S WVCMGR=+$$GET1^DIQ(790,DFN,.1,"I") ;get case manager
"RTN","WVRADWP",86,0)
 S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRADWP",87,0)
 ; if no case manager, then get default case manager(s)
"RTN","WVRADWP",88,0)
 I 'WVCMGR S WVLOOP=0 F  S WVLOOP=$O(^WV(790.02,WVLOOP)) Q:'WVLOOP  D
"RTN","WVRADWP",89,0)
 .S WVCMGR=$$GET1^DIQ(790.02,WVLOOP,.02,"I")
"RTN","WVRADWP",90,0)
 .S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRADWP",91,0)
 .Q
"RTN","WVRADWP",92,0)
 Q:$O(XMY(0))'>0  ;no case manager(s)
"RTN","WVRADWP",93,0)
 S:WVPROV XMY(WVPROV)=""
"RTN","WVRADWP",94,0)
 S XMDUZ=.5 ;message sender
"RTN","WVRADWP",95,0)
 S XMSUB="RAD/NM added a procedure for a WH patient"
"RTN","WVRADWP",96,0)
 S WVMSG(1)="        Patient: "_$P($G(^DPT(DFN,0)),U,1)_" (SSN: "_$$SSN^WVUTL1(DFN)_")"
"RTN","WVRADWP",97,0)
 S WVMSG(2)=" WH Accession #: "_$P($G(^WV(790.1,+WVACCESS,0)),U,1)
"RTN","WVRADWP",98,0)
 S WVMSG(3)="      Procedure: "_$P($G(^WV(790.2,+WVPROC,0)),U,1)
"RTN","WVRADWP",99,0)
 S WVMSG(4)=" "
"RTN","WVRADWP",100,0)
 S WVMSG(5)="Please use the 'Edit a Procedure' option in the WOMEN'S"
"RTN","WVRADWP",101,0)
 S WVMSG(6)="HEALTH package to complete/close this procedure."
"RTN","WVRADWP",102,0)
 S XMTEXT="WVMSG("
"RTN","WVRADWP",103,0)
 D ^XMD
"RTN","WVRADWP",104,0)
 Q
"RTN","WVRALINK")
0^41^B41871307
"RTN","WVRALINK",1,0)
WVRALINK ;HCIOFO/FT IHS/ANMC/MWR - RAD/NM-WOMEN'S HEALTH LINK  ;9/21/98  16:07
"RTN","WVRALINK",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRALINK",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRALINK",4,0)
 ;;  CREATE MAMMOGRAM PROCEDURE IN WOMEN'S HEALTH FOR THIS PATIENT.
"RTN","WVRALINK",5,0)
 ;;  CALLED BY ^RART WHEN A RADIOLOGY REPORT IS VERIFIED.
"RTN","WVRALINK",6,0)
 ;;  CALLED BY ^RARTE1 WHEN A RADIOLOGY REPORT IS UNVERIFIED.
"RTN","WVRALINK",7,0)
 ;;  CALLED BY ^WVEXPTRA WHEN EXPORTING HISTORICAL MAMS TO WOMEN'S HEALTH
"RTN","WVRALINK",8,0)
 ;
"RTN","WVRALINK",9,0)
 ;---> REQUIRED VARIABLES: DFN  = DFN OF RADIOLOGY PATIENT.
"RTN","WVRALINK",10,0)
 ;--->                     DATE = INVERSE DATE/TIME OF VISIT.
"RTN","WVRALINK",11,0)
 ;--->                     CASE = IEN OF RADIOLOGY EXAM (CASE).
"RTN","WVRALINK",12,0)
 ;
"RTN","WVRALINK",13,0)
 ;---> OPTIONAL VARIABLE:  WVNEWP = TOTAL NEW WH PATIENTS ADDED.
"RTN","WVRALINK",14,0)
 ;--->                     WVMCNT = TOTAL NEW MAMS PROCEDURES ADDED.
"RTN","WVRALINK",15,0)
 ;--->                     THESE IF CALLED FROM ^WVEXPTRA ROUTINE.
"RTN","WVRALINK",16,0)
 ;
"RTN","WVRALINK",17,0)
 ;---> GENERATED VARIBLES:
"RTN","WVRALINK",18,0)
 ;---> WVPROC = IEN OF RADIOLOGY PROCEDURE (FILE #71), THEN IT
"RTN","WVRALINK",19,0)
 ;--->          GETS CHANGED TO WOMEN'S HEALTH PROCEDURE TYPE
"RTN","WVRALINK",20,0)
 ;--->                                   (FILE #790.2).
"RTN","WVRALINK",21,0)
 ;---> WVLOC  = WARD/CLINIC/LOCATION (FILE #44).
"RTN","WVRALINK",22,0)
 ;---> WVDATE = DATE OF THE PROCEDURE.
"RTN","WVRALINK",23,0)
 ;---> WVPROV = ORDERING PROVIDER.
"RTN","WVRALINK",24,0)
 ;---> WVMOD  = LEFT OR RIGHT, IF IT'S A UNILATERAL MAMMOGRAM.
"RTN","WVRALINK",25,0)
 ;---> WVDX   = RADIOLOGY DIAGNOSTIC CODE.
"RTN","WVRALINK",26,0)
 ;---> WVBWDX = WOMEN'S HEALTH RESULT/DIAGNOSIS.
"RTN","WVRALINK",27,0)
 ;
"RTN","WVRALINK",28,0)
CREATE(DFN,DATE,CASE) ;
"RTN","WVRALINK",29,0)
 Q:'+$$VERSION^XPDUTL("WV")
"RTN","WVRALINK",30,0)
 Q:($G(DFN)']"")!($G(DATE)']"")!($G(CASE)']"")
"RTN","WVRALINK",31,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WVRALINK",32,0)
 S ZTRTN="CREATEQ^WVRALINK",ZTDESC="WV CREATE MAMMOGRAM ENTRY"
"RTN","WVRALINK",33,0)
 S ZTSAVE("DFN")="",ZTSAVE("DATE")="",ZTSAVE("CASE")=""
"RTN","WVRALINK",34,0)
 S ZTIO="",ZTDTH=$H
"RTN","WVRALINK",35,0)
 D ^%ZTLOAD
"RTN","WVRALINK",36,0)
 Q
"RTN","WVRALINK",37,0)
CREATEH(DFN,DATE,CASE,STATUS) ; Entry from ^WVEXPTRA which looks for exams
"RTN","WVRALINK",38,0)
 ; created before the WH package was installed.
"RTN","WVRALINK",39,0)
 Q:($G(DFN)']"")!($G(DATE)']"")!($G(CASE)']"")!($G(STATUS)']"")
"RTN","WVRALINK",40,0)
 ; 
"RTN","WVRALINK",41,0)
CREATEQ ; Queue data entry creation. Called from CREATE above
"RTN","WVRALINK",42,0)
 N WVPROC,WVLOC,WVDATE,WVPROV,WVMOD,WVDX,WVBWDX,WVLEFT,WVRIGHT
"RTN","WVRALINK",43,0)
 N WVCASE,WVCPT,WVERR,WVCREDIT ;,WVEXAM0
"RTN","WVRALINK",44,0)
 ;---> QUIT IF RADIOLOGY DATA IS NOT DEFINED OR ="".
"RTN","WVRALINK",45,0)
 Q:'$D(^RADPT(DFN,"DT",DATE,"P",CASE,0))
"RTN","WVRALINK",46,0)
 ;
"RTN","WVRALINK",47,0)
 ;---> QUIT IF THIS PROCEDURE DOES NOT HAVE A MAM CPT CODE.
"RTN","WVRALINK",48,0)
 ;---> QUIT IF THIS PROCEDURE DOES NOT HAVE A BREAST ULTRASOUND CPT CODE.
"RTN","WVRALINK",49,0)
 ;---> WVEXAM0=ZERO NODE OF RADIOLOGY EXAM.
"RTN","WVRALINK",50,0)
 S WVEXAM0=^RADPT(DFN,"DT",DATE,"P",CASE,0)
"RTN","WVRALINK",51,0)
 S WVCPT=$P(^RAMIS(71,$P(WVEXAM0,U,2),0),U,9)
"RTN","WVRALINK",52,0)
 Q:(WVCPT'=76090)&(WVCPT'=76091)&(WVCPT'=76092)&(WVCPT'=76645)
"RTN","WVRALINK",53,0)
 Q:$P($G(^DPT(DFN,0)),U,2)'="F"  ;not female
"RTN","WVRALINK",54,0)
 ;
"RTN","WVRALINK",55,0)
 ;---> QUIT IF NO WOMEN'S HEALTH SITE PARAMETER FILE ON THIS MACHINE.
"RTN","WVRALINK",56,0)
 Q:'$D(^WV(790.02,DUZ(2)))
"RTN","WVRALINK",57,0)
 ;
"RTN","WVRALINK",58,0)
 ;---> IF NOT CALLED FROM ^WVEXPTRA (i.e., STATUS is undefined) CHECK
"RTN","WVRALINK",59,0)
 ;---> SITE PARAMETER AND QUIT IF "IMPORT MAMMOGRAMS FROM RADIOLOGY"
"RTN","WVRALINK",60,0)
 ;---> IS NOT SET TO "YES".
"RTN","WVRALINK",61,0)
 N Y S Y=^WV(790.02,DUZ(2),0)
"RTN","WVRALINK",62,0)
 I '$D(STATUS) Q:'$P(Y,U,10)
"RTN","WVRALINK",63,0)
 ;
"RTN","WVRALINK",64,0)
 ;---> SET WVZSTAT =THE STATUS (OPEN OR CLOSED) IN WOMEN'S HEALTH.
"RTN","WVRALINK",65,0)
 ;---> THAT MAMMOGRAMS SHOULD RECEIVE WHEN COPIED OVER FROM RADIOLOGY.
"RTN","WVRALINK",66,0)
 S WVZSTAT=$P(Y,U,23) S:WVZSTAT="" WVZSTAT="o"
"RTN","WVRALINK",67,0)
 I $G(STATUS)]"" S WVZSTAT=$G(STATUS) ;status selected in ^WVEXPTRA
"RTN","WVRALINK",68,0)
 ;
"RTN","WVRALINK",69,0)
 ;---> BELOW ARE IENS FOR WV PROCEDURE TYPE FILE #790.2.
"RTN","WVRALINK",70,0)
 ;---> IEN 26 IN ^WV(790.2, IS UNILATERAL MAMMOGRAM.
"RTN","WVRALINK",71,0)
 ;---> IEN 25 IN ^WV(790.2, IS BILATERAL MAMMOGRAM.
"RTN","WVRALINK",72,0)
 ;---> IEN 28 IN ^WV(790.2, IS SCREENING MAMMOGRAM.
"RTN","WVRALINK",73,0)
 ;---> IEN 38 IN ^WV(790.2, IS ECHO EXAM OF BREAST.
"RTN","WVRALINK",74,0)
 I WVCPT=76090 S WVPROC=26 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",75,0)
 I WVCPT=76091 S WVPROC=25 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",76,0)
 I WVCPT=76092 S WVPROC=28 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",77,0)
 I WVCPT=76645 S WVPROC=38 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",78,0)
 ;
"RTN","WVRALINK",79,0)
EXIT ;EP
"RTN","WVRALINK",80,0)
 K I,N,X
"RTN","WVRALINK",81,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVRALINK",82,0)
 Q
"RTN","WVRALINK",83,0)
 ;
"RTN","WVRALINK",84,0)
 ;
"RTN","WVRALINK",85,0)
COPY(Y) ;EP
"RTN","WVRALINK",86,0)
 ;---> COPY MAM PROCEDURE DATA FROM RADIOLOGY TO WOMEN'S HEALTH.
"RTN","WVRALINK",87,0)
 ;---> VARIABLE DFN=PATIENT
"RTN","WVRALINK",88,0)
 ;---> LOCATION=DUZ(2)
"RTN","WVRALINK",89,0)
 ;---> WARD/CLINIC/LOCATION
"RTN","WVRALINK",90,0)
 N X
"RTN","WVRALINK",91,0)
 S WVLOC=$P(Y,U,8)
"RTN","WVRALINK",92,0)
 ;
"RTN","WVRALINK",93,0)
 ;---> WVDATE=DATE OF THE PROCEDURE.
"RTN","WVRALINK",94,0)
 S WVDATE=$P($P(^RADPT(DFN,"DT",DATE,0),U),".")
"RTN","WVRALINK",95,0)
 ;
"RTN","WVRALINK",96,0)
 ;---> RECONSTRUCT THE FULL CASE# FOR THIS RAD PROCEDURE.
"RTN","WVRALINK",97,0)
 ;---> THIS IS USED AS A LINK (XREF) BETWEEN THE RADIOLOGY PROCEDURE
"RTN","WVRALINK",98,0)
 ;---> AND THE WOMEN'S HEALTH PROCEDURE.
"RTN","WVRALINK",99,0)
 S WVCASE=$E(WVDATE,4,7)_$E(WVDATE,2,3)_"-"_$P(Y,U)
"RTN","WVRALINK",100,0)
 ;---> CHECK TO BE SURE THE CASE# XREF IS REALLY DOWN THERE.
"RTN","WVRALINK",101,0)
 S:'$D(^RADPT("ADC",WVCASE,DFN,DATE,CASE)) WVCASE="UNKNOWN"
"RTN","WVRALINK",102,0)
 ;
"RTN","WVRALINK",103,0)
 ;---> QUIT IF THIS PROCEDURE HAS ALREADY BEEN SENT TO WOMEN'S HEALTH.
"RTN","WVRALINK",104,0)
 Q:$D(^WV(790.1,"E",WVCASE))
"RTN","WVRALINK",105,0)
 ;
"RTN","WVRALINK",106,0)
 ;---> REQUESTING PROVIDER/ORDERING PROVIDER
"RTN","WVRALINK",107,0)
 S WVPROV=$P(Y,U,14)
"RTN","WVRALINK",108,0)
 ;
"RTN","WVRALINK",109,0)
 ;---> IF UNILATERAL, ATTEMPT TO PICK UP LEFT OR RIGHT MODIFIER.
"RTN","WVRALINK",110,0)
 I WVPROC=26 D
"RTN","WVRALINK",111,0)
 .I $D(^RADPT(DFN,"DT",DATE,"P",CASE,"M",0)) D
"RTN","WVRALINK",112,0)
 ..N N S N=0
"RTN","WVRALINK",113,0)
 ..F  S N=$O(^RADPT(DFN,"DT",DATE,"P",CASE,"M",N)) Q:'N  D
"RTN","WVRALINK",114,0)
 ...S WVMOD=$P(^RADPT(DFN,"DT",DATE,"P",CASE,"M",N,0),U)
"RTN","WVRALINK",115,0)
 ...S WVMOD=$P(^RAMIS(71.2,WVMOD,0),U)
"RTN","WVRALINK",116,0)
 ...I "LEFTleft"[WVMOD S WVLEFT=1
"RTN","WVRALINK",117,0)
 ...I "RIGHTright"[WVMOD S WVRIGHT=1
"RTN","WVRALINK",118,0)
 ..Q:$D(WVLEFT)&($D(WVRIGHT))
"RTN","WVRALINK",119,0)
 ..I $D(WVLEFT) S WVMOD="l" Q
"RTN","WVRALINK",120,0)
 ..I $D(WVRIGHT) S WVMOD="r" Q
"RTN","WVRALINK",121,0)
 ;
"RTN","WVRALINK",122,0)
 ;---> IF THERE'S A DIAGNOSTIC CODE, ATTEMPT TO PICK UP DIAGNOSIS.
"RTN","WVRALINK",123,0)
 ;---> USE "WV DIAGNOSTIC CODE TRANSLATION" FILE #790.32.
"RTN","WVRALINK",124,0)
 S WVDX=$P(Y,U,13)
"RTN","WVRALINK",125,0)
 I +WVDX I $D(^WV(790.32,"C",WVDX)) S WVBWDX=$O(^WV(790.32,"C",WVDX,0))
"RTN","WVRALINK",126,0)
 ;
"RTN","WVRALINK",127,0)
 ;---> GET CREDIT METHOD.
"RTN","WVRALINK",128,0)
 S WVCREDIT=$P(Y,U,26)
"RTN","WVRALINK",129,0)
 ;
"RTN","WVRALINK",130,0)
PATIENT ;---> IF PATIENT ISN'T IN WOMEN'S HEALTH DATABASE, ADD HER.
"RTN","WVRALINK",131,0)
 S WVERR=1
"RTN","WVRALINK",132,0)
 I '$D(^WV(790,DFN,0)) D
"RTN","WVRALINK",133,0)
 .D AUTOADD^WVPATE(DFN,DUZ(2),.WVERR)
"RTN","WVRALINK",134,0)
 .I $D(WVNEWP) S:WVERR WVNEWP=WVNEWP+1
"RTN","WVRALINK",135,0)
 Q:WVERR<0
"RTN","WVRALINK",136,0)
 ;
"RTN","WVRALINK",137,0)
PROC ;---> CREATE MAMMOGRAM PROCEDURE IN WV PROCEDURE FILE #790.1.
"RTN","WVRALINK",138,0)
 ;
"RTN","WVRALINK",139,0)
 S WVDR=".02////"_DFN_";.04////"_WVPROC
"RTN","WVRALINK",140,0)
 S WVDR=WVDR_";.05////"_$G(WVBWDX)_";.07////"_WVPROV
"RTN","WVRALINK",141,0)
 S WVDR=WVDR_";.09////"_$G(WVMOD)_";.1////"_DUZ(2)_";.11////"_WVLOC
"RTN","WVRALINK",142,0)
 S WVDR=WVDR_";.12////"_WVDATE_";.14////"_WVZSTAT_";.15////"_WVCASE
"RTN","WVRALINK",143,0)
 S WVDR=WVDR_";.18////.5;.19////"_DT_";.34////"_$G(DUZ(2))_";.35////"_WVCREDIT
"RTN","WVRALINK",144,0)
 ;
"RTN","WVRALINK",145,0)
 D NEW2^WVPROC(DFN,WVPROC,WVDATE,WVDR,"","",.WVERR)
"RTN","WVRALINK",146,0)
 I $D(WVMCNT) S:WVERR>-1 WVMCNT=WVMCNT+1
"RTN","WVRALINK",147,0)
 Q:WVERR<0  ;procedure not added
"RTN","WVRALINK",148,0)
 Q:$D(WVMCNT)  ;mass import of Rad/NM exams
"RTN","WVRALINK",149,0)
 D MAIL^WVRADWP(DFN,+Y,WVPROC,WVPROV) ;iens for patient, accession, procedure, provider/requestor
"RTN","WVRALINK",150,0)
 Q
"RTN","WVRALINK",151,0)
 ;
"RTN","WVRALINK",152,0)
 ;
"RTN","WVRALINK",153,0)
DELETE(DFN,DATE,CASE) ;EP
"RTN","WVRALINK",154,0)
 ;---> MODIFY WOMEN'S HEALTH PROCEDURE TO REFLECT CHANGE.
"RTN","WVRALINK",155,0)
 ;---> CALLED FROM RARTE1 (DELETE A REPORT AND UNVERIFY A REPORT).
"RTN","WVRALINK",156,0)
 ;
"RTN","WVRALINK",157,0)
 Q:'+$$VERSION^XPDUTL("WV")
"RTN","WVRALINK",158,0)
 Q:'$D(DFN)!('$D(DATE))!('$D(CASE))
"RTN","WVRALINK",159,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WVRALINK",160,0)
 S ZTRTN="DELETEQ^WVRALINK",ZTDESC="WV MAMMOGRAM RPT CHANGE"
"RTN","WVRALINK",161,0)
 S ZTSAVE("DFN")="",ZTSAVE("DATE")="",ZTSAVE("CASE")=""
"RTN","WVRALINK",162,0)
 S ZTIO="",ZTDTH=$H
"RTN","WVRALINK",163,0)
 D ^%ZTLOAD
"RTN","WVRALINK",164,0)
 Q
"RTN","WVRALINK",165,0)
DELETEQ ; Modify WV entry when mammogram report is unverified or deleted
"RTN","WVRALINK",166,0)
 Q:'$D(^RADPT(DFN,"DT",DATE,"P",CASE,0))
"RTN","WVRALINK",167,0)
 N WVIEN,WVDATE,WVCASE,WVCMGR,WVLOOP,WVMSG,WVPROV
"RTN","WVRALINK",168,0)
 N XMDUZ,XMSUB,XMTEXT,XMY ;send mail message to case manager
"RTN","WVRALINK",169,0)
 ;
"RTN","WVRALINK",170,0)
 ;---> WVDATE=DATE OF PROCEDURE.
"RTN","WVRALINK",171,0)
 S WVDATE=$P($P(^RADPT(DFN,"DT",DATE,0),U),".")
"RTN","WVRALINK",172,0)
 S WVCASE=$P(^RADPT(DFN,"DT",DATE,"P",CASE,0),U)
"RTN","WVRALINK",173,0)
 ;
"RTN","WVRALINK",174,0)
 ;---> WVCASE=RECONSTRUCTED CASE# OF PROCEDURE.
"RTN","WVRALINK",175,0)
 S WVCASE=$E(WVDATE,4,7)_$E(WVDATE,2,3)_"-"_WVCASE
"RTN","WVRALINK",176,0)
 ;---> QUIT IF NO CASE# XREF IN WOMEN'S HEALTH PROCEDURE FILE.
"RTN","WVRALINK",177,0)
 Q:'$D(^WV(790.1,"E",WVCASE))
"RTN","WVRALINK",178,0)
 ;
"RTN","WVRALINK",179,0)
 S WVIEN=$O(^WV(790.1,"E",WVCASE,0))
"RTN","WVRALINK",180,0)
 Q:'$D(^WV(790.1,WVIEN,0))
"RTN","WVRALINK",181,0)
 D RADMOD^WVPROC(WVIEN) ;update wh status to "open"
"RTN","WVRALINK",182,0)
 S WVPROV=+$$GET1^DIQ(790.1,WVIEN,.07,"I") ;get provider/requestor
"RTN","WVRALINK",183,0)
 S WVCMGR=+$$GET1^DIQ(790,DFN,.1,"I") ;get case manager
"RTN","WVRALINK",184,0)
 S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRALINK",185,0)
 ; if no case manager, then get default case manager(s)
"RTN","WVRALINK",186,0)
 I 'WVCMGR S WVLOOP=0 F  S WVLOOP=$O(^WV(790.02,WVLOOP)) Q:'WVLOOP  D
"RTN","WVRALINK",187,0)
 .S WVCMGR=$$GET1^DIQ(790.02,WVLOOP,.02,"I")
"RTN","WVRALINK",188,0)
 .S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRALINK",189,0)
 .Q
"RTN","WVRALINK",190,0)
 Q:$O(XMY(0))'>0  ;no case manager(s)
"RTN","WVRALINK",191,0)
 S:WVPROV XMY(WVPROV)=""
"RTN","WVRALINK",192,0)
 S XMDUZ=.5 ;message sender
"RTN","WVRALINK",193,0)
 S XMSUB="RAD/NM Rpt for WH patient is UNVERIFIED/DELETED"
"RTN","WVRALINK",194,0)
 S WVMSG(1)="        Patient: "_$P($G(^DPT(DFN,0)),U,1)_" (SSN: "_$$SSN^WVUTL1(DFN)_")"
"RTN","WVRALINK",195,0)
 S WVMSG(2)=" WH Accession #: "_$P($G(^WV(790.1,+WVIEN,0)),U,1)
"RTN","WVRALINK",196,0)
 S WVMSG(3)="  RAD/NM Case #: "_WVCASE
"RTN","WVRALINK",197,0)
 S WVMSG(4)=" "
"RTN","WVRALINK",198,0)
 S WVMSG(5)="NOTE: THIS PROCEDURE HAS BEEN ALTERED IN RADIOLOGY/NM."
"RTN","WVRALINK",199,0)
 S WVMSG(6)="Follow-up is required in the WOMEN'S HEALTH package!"
"RTN","WVRALINK",200,0)
 S XMTEXT="WVMSG("
"RTN","WVRALINK",201,0)
 D ^XMD
"RTN","WVRALINK",202,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVRALINK",203,0)
 Q
"RTN","WVREFUSE")
0^42^B10329454
"RTN","WVREFUSE",1,0)
WVREFUSE ;HCIOFO/JWR - Add/Enter/Manipulate procedure refusals ;7/30/98  11:51
"RTN","WVREFUSE",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVREFUSE",3,0)
EDREF ;EDIT AN EXISTING REFUSAL
"RTN","WVREFUSE",4,0)
 D EXIT,SETVARS^WVUTL5
"RTN","WVREFUSE",5,0)
 D TITLE^WVUTL5("EDIT A REFUSED TREATMENT") W !!
"RTN","WVREFUSE",6,0)
 K DIC S DIC("A")="   Select DATE REFUSED: ",WVPOP=0
"RTN","WVREFUSE",7,0)
 S DIC="^WV(790.3,",DIC(0)="QEMAL" D ^DIC
"RTN","WVREFUSE",8,0)
 I Y'>0!($D(DUOUT))!($D(DTOUT)) D EXIT Q
"RTN","WVREFUSE",9,0)
 S WVDFN=$P($G(^WV(790.3,+Y,0)),U,2),DIDEL=790.3
"RTN","WVREFUSE",10,0)
 D DDS^WVFMAN(790.3,"[WV REFUSED PROCEDURE-ENTRY]",+Y)
"RTN","WVREFUSE",11,0)
 G EDREF
"RTN","WVREFUSE",12,0)
 Q
"RTN","WVREFUSE",13,0)
ADDREF ;ADD A NEW REFUSAL (not used now, use UNIV for adding a refusal)
"RTN","WVREFUSE",14,0)
 D SETVARS^WVUTL5
"RTN","WVREFUSE",15,0)
 D TITLE^WVUTL5("ADD A REFUSED PROCEDURE")
"RTN","WVREFUSE",16,0)
 K DIR S DIR("A")="   Select DATE REFUSED: ",WVDFN=""
"RTN","WVREFUSE",17,0)
 S DIR(0)="DAO",DIR("B")="TODAY"
"RTN","WVREFUSE",18,0)
 D ^DIR K DIR I Y'>0 D EXIT Q
"RTN","WVREFUSE",19,0)
 S DIC("DR")="1;2"
"RTN","WVREFUSE",20,0)
 S DIC="^WV(790.3,",DIC(0)="QEMAL",X=Y
"RTN","WVREFUSE",21,0)
 K DD,DO D FILE^DICN
"RTN","WVREFUSE",22,0)
 Q:Y'>0
"RTN","WVREFUSE",23,0)
 S WVDFN=$P($G(^WV(790.3,+Y,0)),U,2)
"RTN","WVREFUSE",24,0)
 D DDS^WVFMAN(790.3,"[WV REFUSED PROCEDURE-ENTRY]",+Y)
"RTN","WVREFUSE",25,0)
 D EXIT Q
"RTN","WVREFUSE",26,0)
CHECK ;Checks for existing refusals for this patient within 30 day period
"RTN","WVREFUSE",27,0)
 ; for this procedure.
"RTN","WVREFUSE",28,0)
 Q:'$D(^WV(790.3,"C",WVDFN))
"RTN","WVREFUSE",29,0)
 N A,B,C,D,E,F K WVJR,WVJR1,DR,DIC,DA
"RTN","WVREFUSE",30,0)
 S X1=DT,X2=-30 D C^%DTC S A=X
"RTN","WVREFUSE",31,0)
 S X1=DT,X2=+30 D C^%DTC S B=X
"RTN","WVREFUSE",32,0)
 S G=0 F  S G=$O(^WV(790.3,"C",WVDFN,G)) Q:G'>0  S H=$G(^WV(790.3,G,0)) D
"RTN","WVREFUSE",33,0)
 .Q:$P(H,U)'>A!($P(H,U))'<B
"RTN","WVREFUSE",34,0)
 .Q:$P(H,U,3)'=WVJPR
"RTN","WVREFUSE",35,0)
 .S E=$P(H,U,3),D=$P(H,U)
"RTN","WVREFUSE",36,0)
 .S E=$S(E>0:$P($G(^WV(790.2,E,0)),U),1:"")
"RTN","WVREFUSE",37,0)
 .S Y=D D DD^%DT S F=Y
"RTN","WVREFUSE",38,0)
 .S WVJR(D,G)=F_"    "_E
"RTN","WVREFUSE",39,0)
 S C=1,A=0 F  S A=$O(WVJR(A)) Q:A'>0  S B=0 F  S B=$O(WVJR(A,B)) Q:B'>0  D
"RTN","WVREFUSE",40,0)
 .S WVJR1(C)=B_"^"_WVJR(A,B),C=C+1
"RTN","WVREFUSE",41,0)
 S WVC=C-1 I $D(WVJR1) D
"RTN","WVREFUSE",42,0)
 .W !!,"The following Entries for this patient and procedure already exist in the"
"RTN","WVREFUSE",43,0)
 .W !,"Procedure Refusal file.",!
"RTN","WVREFUSE",44,0)
 .D LOOP W !!
"RTN","WVREFUSE",45,0)
 .K DIR S DIR("A")="Is this a NEW Refusal?  ",DIR(0)="YAO"
"RTN","WVREFUSE",46,0)
 .S DIR("B")="Yes" D ^DIR K DIR Q:Y=1!($D(DIRUT))
"RTN","WVREFUSE",47,0)
 .S DIR("A")="Select a Number to edit a refusal from the list.  "
"RTN","WVREFUSE",48,0)
 .S DIR(0)="NAO^1:"_WVC
"RTN","WVREFUSE",49,0)
 .D ^DIR K DIR S WVEDREF=$S(+Y>0:+Y,1:"NS") Q:Y'>0
"RTN","WVREFUSE",50,0)
 Q
"RTN","WVREFUSE",51,0)
UNIV ;Add new Refusal & check other recent (within 30 days) Refusals
"RTN","WVREFUSE",52,0)
 D SETVARS^WVUTL5
"RTN","WVREFUSE",53,0)
 D TITLE^WVUTL5("ADD/EDIT A REFUSED TREATMENT")
"RTN","WVREFUSE",54,0)
 W !! K DIC S DIC("A")="   Select PATIENT: "
"RTN","WVREFUSE",55,0)
 S DIC(0)="AEQZ",DIC="^WV(790,",DIC("W")="D LOOKL^WVUTL1A(+Y)"
"RTN","WVREFUSE",56,0)
 D ^DIC K DIC I Y'>0 D EXIT Q
"RTN","WVREFUSE",57,0)
 S WVDFN=+Y
"RTN","WVREFUSE",58,0)
 S DIR("A")="   DATE REFUSED: "
"RTN","WVREFUSE",59,0)
 S DIR(0)="DAO"
"RTN","WVREFUSE",60,0)
 D ^DIR K DIR I Y'>0 D EXIT Q
"RTN","WVREFUSE",61,0)
 S WVJDAY=+Y
"RTN","WVREFUSE",62,0)
 S DIR(0)="PAO^790.2:AEMNQZ",DIR("A")="   PROCEDURE: "
"RTN","WVREFUSE",63,0)
 D ^DIR K DIR I Y'>0 D EXIT Q
"RTN","WVREFUSE",64,0)
 S WVJPR=+Y
"RTN","WVREFUSE",65,0)
 K WVEDREF D CHECK I $D(DIRUT) K DIRUT D EXIT G UNIV
"RTN","WVREFUSE",66,0)
 I $G(WVEDREF)>0 D  G UNIV
"RTN","WVREFUSE",67,0)
 .S DIDEL=790.3
"RTN","WVREFUSE",68,0)
 .D DDS^WVFMAN(790.3,"[WV REFUSED PROCEDURE-ENTRY]",+WVJR1(WVEDREF))
"RTN","WVREFUSE",69,0)
 I $G(WVEDREF)="NS" D EXIT G UNIV
"RTN","WVREFUSE",70,0)
 L +^WV(790.3)
"RTN","WVREFUSE",71,0)
 S DIC="^WV(790.3,",DIC(0)="QEMAL",X=WVJDAY
"RTN","WVREFUSE",72,0)
 S DIC("DR")="1////^S X=WVDFN;2////^S X=WVJPR"
"RTN","WVREFUSE",73,0)
 K DD,DO D FILE^DICN
"RTN","WVREFUSE",74,0)
 L -^WV(790.3)
"RTN","WVREFUSE",75,0)
 Q:Y'>0
"RTN","WVREFUSE",76,0)
 S WVDFN=$P($G(^WV(790.3,+Y,0)),U,2)
"RTN","WVREFUSE",77,0)
 D DDS^WVFMAN(790.3,"[WV REFUSED PROCEDURE-ENTRY]",+Y)
"RTN","WVREFUSE",78,0)
 G UNIV
"RTN","WVREFUSE",79,0)
 Q
"RTN","WVREFUSE",80,0)
EXIT ;kill variables
"RTN","WVREFUSE",81,0)
 D KILLALL^WVUTL8 K WVEDREF,WVJPR,WVJDAY
"RTN","WVREFUSE",82,0)
 Q
"RTN","WVREFUSE",83,0)
LOOP ;Loop though the array of refuals for this patient & write them out
"RTN","WVREFUSE",84,0)
 S D=0 F  S D=$O(WVJR1(D)) Q:D'>0  D
"RTN","WVREFUSE",85,0)
 .W !,$J(D,6),".  ",$P($G(WVJR1(D)),U,2)
"RTN","WVREFUSE",86,0)
 Q
"RTN","WVRPPCD")
0^43^B23484200
"RTN","WVRPPCD",1,0)
WVRPPCD ;HCIOFO/FT,JR IHS/ANMC/MWR - REPORT: PROCEDURES STATISTICS; ;6/23/98  15:04
"RTN","WVRPPCD",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPPCD",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPPCD",4,0)
 ;;  CALLED BY OPTION: "WV PRINT PROCEDURE STATS".
"RTN","WVRPPCD",5,0)
 ;
"RTN","WVRPPCD",6,0)
 N N,R,X,T,Y,R,PG,PA,JC,J,TR,TR2,JR,JR2,CM,CM2,WVJRC
"RTN","WVRPPCD",7,0)
 K ^TMP("WVRES",$J),^TMP("WVAR",$J)
"RTN","WVRPPCD",8,0)
 D SETVARS^WVUTL5 S WVPOP=0 K WVRES
"RTN","WVRPPCD",9,0)
 D TITLE^WVUTL5("PROCEDURE STATISTICS REPORT")
"RTN","WVRPPCD",10,0)
 D DATES                  G:WVPOP EXIT
"RTN","WVRPPCD",11,0)
 D SELECT                 G:WVPOP EXIT
"RTN","WVRPPCD",12,0)
 D BYAGE(.WVAGRG,.WVPOP)  G:WVPOP EXIT
"RTN","WVRPPCD",13,0)
 D DEVICE                 G:WVPOP EXIT
"RTN","WVRPPCD",14,0)
 D ^WVRPPCD2
"RTN","WVRPPCD",15,0)
 D COPYGBL
"RTN","WVRPPCD",16,0)
 D ^WVRPPCD1
"RTN","WVRPPCD",17,0)
 ;
"RTN","WVRPPCD",18,0)
EXIT ;EP
"RTN","WVRPPCD",19,0)
 D KILLALL^WVUTL8
"RTN","WVRPPCD",20,0)
 Q
"RTN","WVRPPCD",21,0)
 ;
"RTN","WVRPPCD",22,0)
 ;
"RTN","WVRPPCD",23,0)
DATES ;EP
"RTN","WVRPPCD",24,0)
 ;---> ASK DATE RANGE.  RETURN DATES IN WVBEGDT AND WVENDDT.
"RTN","WVRPPCD",25,0)
 D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP,"T-365","T")
"RTN","WVRPPCD",26,0)
 Q
"RTN","WVRPPCD",27,0)
 ;
"RTN","WVRPPCD",28,0)
SELECT ;EP
"RTN","WVRPPCD",29,0)
 D SELECT^WVSELECT("Procedure Type",790.2,"WVARR","","",.WVPOP)
"RTN","WVRPPCD",30,0)
 Q
"RTN","WVRPPCD",31,0)
 ;
"RTN","WVRPPCD",32,0)
BYAGE(WVAGRG,WVPOP) ;EP
"RTN","WVRPPCD",33,0)
 ;---> RETURN AGE RANGE IN WVAGRG.
"RTN","WVRPPCD",34,0)
 N DIR,DIRUT,Y S WVPOP=0
"RTN","WVRPPCD",35,0)
 W !!?3,"Do you wish to display statistics by age group?"
"RTN","WVRPPCD",36,0)
 S DIR(0)="Y",DIR("B")="YES" D HELP1
"RTN","WVRPPCD",37,0)
 S DIR("A")="   Enter Yes or No"
"RTN","WVRPPCD",38,0)
 D ^DIR K DIR W !
"RTN","WVRPPCD",39,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVRPPCD",40,0)
 ;---> IF NOT DISPLAYING BY AGE GROUP, SET WVAGRG (AGE RANGE)=1, QUIT.
"RTN","WVRPPCD",41,0)
 I 'Y S WVAGRG=1 Q
"RTN","WVRPPCD",42,0)
BYAGE1 ;
"RTN","WVRPPCD",43,0)
 W !?5,"Enter the age ranges you wish to select for in the form of:"
"RTN","WVRPPCD",44,0)
 W !?5,"  15-29,30-39,40-105"
"RTN","WVRPPCD",45,0)
 W !?5,"Use a dash ""-"" to separate the limits of a range,"
"RTN","WVRPPCD",46,0)
 W !?5,"use a comma to separate the different ranges."
"RTN","WVRPPCD",47,0)
 W !!?5,"NOTE: Patient ages will reflect the age they were on the"
"RTN","WVRPPCD",48,0)
 W !?5,"      dates of their procedures.  Patient ages will NOT"
"RTN","WVRPPCD",49,0)
 W !?5,"      necessarily be their ages today.",!
"RTN","WVRPPCD",50,0)
 K DIR D HELP2
"RTN","WVRPPCD",51,0)
 S DIR(0)="FOA",DIR("A")="     Enter age ranges: "
"RTN","WVRPPCD",52,0)
 S:$D(^WV(790.72,DUZ,0)) DIR("B")=$P(^(0),U,2)
"RTN","WVRPPCD",53,0)
 D ^DIR K DIR
"RTN","WVRPPCD",54,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVRPPCD",55,0)
 D CHECK(.Y)
"RTN","WVRPPCD",56,0)
 I Y="" D  G BYAGE1
"RTN","WVRPPCD",57,0)
 .W !!?5,"* INVALID AGE RANGE.  Please begin again. (Enter ? for help.)"
"RTN","WVRPPCD",58,0)
 ;---> WVAGRG=SELECTED AGE RANGE(S).
"RTN","WVRPPCD",59,0)
 S WVAGRG=Y
"RTN","WVRPPCD",60,0)
 D DIC^WVFMAN(790.72,"L",.Y,"","","","`"_DUZ)
"RTN","WVRPPCD",61,0)
 Q:Y<0
"RTN","WVRPPCD",62,0)
 D DIE^WVFMAN(790.72,".02////"_WVAGRG,+Y,.WVPOP,1)
"RTN","WVRPPCD",63,0)
 Q
"RTN","WVRPPCD",64,0)
 ;
"RTN","WVRPPCD",65,0)
DEVICE ;EP
"RTN","WVRPPCD",66,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVRPPCD",67,0)
 S ZTRTN="DEQUEUE^WVRPPCD"
"RTN","WVRPPCD",68,0)
 F WVSV="AGRG","BEGDT","ENDDT" D
"RTN","WVRPPCD",69,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVRPPCD",70,0)
 ;---> SAVE PROCEDURES ARRAY.
"RTN","WVRPPCD",71,0)
 I $D(WVARR) N N S N=0 F  S N=$O(WVARR(N)) Q:N=""  D
"RTN","WVRPPCD",72,0)
 .S ZTSAVE("WVARR("""_N_""")")=""
"RTN","WVRPPCD",73,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVRPPCD",74,0)
 Q
"RTN","WVRPPCD",75,0)
 ;
"RTN","WVRPPCD",76,0)
COPYGBL ;EP
"RTN","WVRPPCD",77,0)
 ;---> COPY ^TMP("WVRES",$J,"R") TO ^TMP("WVAR",$J, TO MAKE IT FLAT.
"RTN","WVRPPCD",78,0)
 N I,M,N K WVAR
"RTN","WVRPPCD",79,0)
 S N=0,I=0
"RTN","WVRPPCD",80,0)
 F  S N=$O(^TMP("WVRES",$J,"R",N)) Q:N=""  D
"RTN","WVRPPCD",81,0)
 .S M=0
"RTN","WVRPPCD",82,0)
 .F  S M=$O(^TMP("WVRES",$J,"R",N,M)) Q:M=""  D
"RTN","WVRPPCD",83,0)
 ..S I=I+1,^TMP("WVAR",$J,I)=^TMP("WVRES",$J,"R",N,M)
"RTN","WVRPPCD",84,0)
 Q
"RTN","WVRPPCD",85,0)
 ;
"RTN","WVRPPCD",86,0)
 ;
"RTN","WVRPPCD",87,0)
DEQUEUE ;EP
"RTN","WVRPPCD",88,0)
 ;---> TASKMAN QUEUE OF PRINTOUT.
"RTN","WVRPPCD",89,0)
 D SETVARS^WVUTL5,^WVRPPCD2,COPYGBL,^WVRPPCD1,EXIT
"RTN","WVRPPCD",90,0)
 Q
"RTN","WVRPPCD",91,0)
 ;
"RTN","WVRPPCD",92,0)
HELP1 ;EP
"RTN","WVRPPCD",93,0)
 ;;Answer "YES" to display statistics by age group.  If you choose
"RTN","WVRPPCD",94,0)
 ;;to display by age group, you will be given the opportunity to
"RTN","WVRPPCD",95,0)
 ;;select the age ranges.  For example, you might choose to display
"RTN","WVRPPCD",96,0)
 ;;from ages 15-40,41-65,65-99.
"RTN","WVRPPCD",97,0)
 ;;Answer "NO" to display statistics without grouping by age.
"RTN","WVRPPCD",98,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVRPPCD",99,0)
 Q
"RTN","WVRPPCD",100,0)
 ;
"RTN","WVRPPCD",101,0)
HELP2 ;EP
"RTN","WVRPPCD",102,0)
 ;;Enter each age range you wish to report on by entering the
"RTN","WVRPPCD",103,0)
 ;;earlier age-dash-older age.  For example, 20-29 would report
"RTN","WVRPPCD",104,0)
 ;;on all patients between the ages of 20 and 29 inclusive.
"RTN","WVRPPCD",105,0)
 ;;You may select as many age ranges as you wish.  Age ranges must
"RTN","WVRPPCD",106,0)
 ;;be separated by commas.  For example: 15-19,20-29,30-39
"RTN","WVRPPCD",107,0)
 ;;To select only one age, simply enter that age, with no dashes,
"RTN","WVRPPCD",108,0)
 ;;for example, 30 would report only on women who were 30 years
"RTN","WVRPPCD",109,0)
 ;;of age.
"RTN","WVRPPCD",110,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVRPPCD",111,0)
 Q
"RTN","WVRPPCD",112,0)
 ;
"RTN","WVRPPCD",113,0)
HELPTX ;EP
"RTN","WVRPPCD",114,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVRPPCD",115,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPPCD",116,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVRPPCD",117,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVRPPCD",118,0)
 Q
"RTN","WVRPPCD",119,0)
 ;
"RTN","WVRPPCD",120,0)
CHECK(X) ;EP
"RTN","WVRPPCD",121,0)
 ;---> CHECK SYNTAX OF AGE RANGE STRING.
"RTN","WVRPPCD",122,0)
 ;---> IF X=ONE AGE ONLY, SET IT IN THE FORM X-X AND QUIT.
"RTN","WVRPPCD",123,0)
 I X?1N.N S X=X_"-"_X Q
"RTN","WVRPPCD",124,0)
 ;
"RTN","WVRPPCD",125,0)
 N WV1,FAIL,I,Y,Y1,Y2
"RTN","WVRPPCD",126,0)
 S FAIL=0
"RTN","WVRPPCD",127,0)
 ;---> CHECK EACH RANGE.
"RTN","WVRPPCD",128,0)
 F I=1:1:$L(X,",") S Y=$P(X,",",I) D  Q:FAIL
"RTN","WVRPPCD",129,0)
 .S Y1=$P(Y,"-"),Y2=$P(Y,"-",2)
"RTN","WVRPPCD",130,0)
 .;---> EACH END OF EACH RANGE SHOULD BE A NUMBER.
"RTN","WVRPPCD",131,0)
 .I (Y1'?1N.N)!(Y2'?1N.N) S FAIL=1 Q
"RTN","WVRPPCD",132,0)
 .;---> THE LOWER NUMBER SHOULD BE FIRST.
"RTN","WVRPPCD",133,0)
 .I Y2<Y1 S FAIL=1
"RTN","WVRPPCD",134,0)
 I FAIL S X="" Q
"RTN","WVRPPCD",135,0)
 ;
"RTN","WVRPPCD",136,0)
 ;---> MAKE SURE ORDER IS FROM LOWEST (YOUNGEST) TO HIGHEST (OLDEST).
"RTN","WVRPPCD",137,0)
 F I=1:1:$L(X,",") S Y=$P(X,",",I),Y1=$P(Y,"-"),WV1(Y1)=Y
"RTN","WVRPPCD",138,0)
 S N=0,X=""
"RTN","WVRPPCD",139,0)
 F  S N=$O(WV1(N)) Q:'N  S X=X_WV1(N)_","
"RTN","WVRPPCD",140,0)
 S:$E(X,$L(X))="," X=$E(X,1,($L(X)-1))
"RTN","WVRPPCD",141,0)
 Q
"RTN","WVRPPCD1")
0^44^B29664296
"RTN","WVRPPCD1",1,0)
WVRPPCD1 ;HCIOFO/FT,JR IHS/ANMC/MWR - REPORT: PROCEDURE STATISTICS; ;9/17/98  15:50
"RTN","WVRPPCD1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPPCD1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPPCD1",4,0)
 ;;  DISPLAY CODE FOR PROCEDURE STATISTICS REPORT.  CALLED BY WVRPPCD.
"RTN","WVRPPCD1",5,0)
 ;
"RTN","WVRPPCD1",6,0)
DISPLAY ;EP
"RTN","WVRPPCD1",7,0)
 ;---> WVTITLE=TITLE AT TOP OF DISPLAY HEADER.
"RTN","WVRPPCD1",8,0)
 ;---> WVSUBH=CODE TO EXECUTE FOR SUBHEADER (COLUMN TITLES).
"RTN","WVRPPCD1",9,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (ALLOWS SELECTIONS TO EDIT).
"RTN","WVRPPCD1",10,0)
 ;
"RTN","WVRPPCD1",11,0)
 U IO
"RTN","WVRPPCD1",12,0)
 S WVTITLE="* * *  WOMEN'S HEALTH: PROCEDURE STATISTICS REPORT  * * *"
"RTN","WVRPPCD1",13,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVRPPCD1",14,0)
 S WVSUBH="SUBHEAD^WVRPPCD1"
"RTN","WVRPPCD1",15,0)
 D TOPHEAD^WVUTL7
"RTN","WVRPPCD1",16,0)
 S (WVPOP,N)=0
"RTN","WVRPPCD1",17,0)
 ;
"RTN","WVRPPCD1",18,0)
DISPLAY1 ;EP
"RTN","WVRPPCD1",19,0)
 D HEADER3^WVUTL7
"RTN","WVRPPCD1",20,0)
 I '$D(^TMP("WVAR",$J)) D  Q
"RTN","WVRPPCD1",21,0)
 .W !!?5,"No records match the selected criteria.",!
"RTN","WVRPPCD1",22,0)
 .D ENDREP^WVUTL7()
"RTN","WVRPPCD1",23,0)
 F  S N=$O(^TMP("WVAR",$J,N)) Q:N=""!(WVPOP)  D
"RTN","WVRPPCD1",24,0)
 .I $Y+12>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D
"RTN","WVRPPCD1",25,0)
 ..S WVPAGE=WVPAGE+1
"RTN","WVRPPCD1",26,0)
 ..D HEADER3^WVUTL7
"RTN","WVRPPCD1",27,0)
 .S Y=^TMP("WVAR",$J,N)
"RTN","WVRPPCD1",28,0)
 .S WVARJ=$S($P(Y,U)["MAMMOGRAM":1,$P(Y,U)["ULTRASOUND":1,1:0)
"RTN","WVRPPCD1",29,0)
 .S WVAGRP=$$WVAGRP($P(Y,U,16))
"RTN","WVRPPCD1",30,0)
 .;---> QUIT IF DISPLAYING "ALL AGES" ONLY (NOT GROUPED BY AGE).
"RTN","WVRPPCD1",31,0)
 .Q:WVAGRP=1
"RTN","WVRPPCD1",32,0)
 .S WVPCD="< "_$P(Y,U)_": "_WVAGRP_" >",WVPCDL=$L(WVPCD)
"RTN","WVRPPCD1",33,0)
 .S X=$E(WVLINE,1,31-(WVPCDL/2))
"RTN","WVRPPCD1",34,0)
 .W !!?2,X,WVPCD,X
"RTN","WVRPPCD1",35,0)
 .I WVARJ W !?68," CREDIT"
"RTN","WVRPPCD1",36,0)
 .W !?28,"COUNT",?43,"VETS",?56,"NON-VETS"
"RTN","WVRPPCD1",37,0)
 .I WVARJ W ?66," REG.   NO CR"
"RTN","WVRPPCD1",38,0)
 .W !?26,"----------",?40,"----------",?55,"----------"
"RTN","WVRPPCD1",39,0)
 .I WVARJ W ?67,"-----  -----"
"RTN","WVRPPCD1",40,0)
 .D VERTICAL
"RTN","WVRPPCD1",41,0)
 D ENDREP^WVUTL7()
"RTN","WVRPPCD1",42,0)
 Q
"RTN","WVRPPCD1",43,0)
 ;
"RTN","WVRPPCD1",44,0)
 ;
"RTN","WVRPPCD1",45,0)
VERTICAL ;EP
"RTN","WVRPPCD1",46,0)
 ;---> DISPLAY IN VERTICAL FORMAT.
"RTN","WVRPPCD1",47,0)
 F X=1:1:24 S:$P(Y,U,X)="" $P(Y,U,X)=0
"RTN","WVRPPCD1",48,0)
 F X=25:1:40 S:$P(Y,U,X)'>0 $P(Y,U,X)=""
"RTN","WVRPPCD1",49,0)
 D PG
"RTN","WVRPPCD1",50,0)
 W !?14,$S($P(Y,U)="PREGNANCY TEST:":"PREGNANT",1:"NORMAL:")
"RTN","WVRPPCD1",51,0)
 W ?24,$J($P(Y,U,4),5),?30,"(",$J($P(Y,U,5),3),"%)"
"RTN","WVRPPCD1",52,0)
 W ?38,$J($P(Y,U,17),5),?44,PG(1),?47,$J($P(Y,U,4)-$P(Y,U,17),8)
"RTN","WVRPPCD1",53,0)
 W ?59,PG(2)
"RTN","WVRPPCD1",54,0)
 I WVARJ W ?64,$J($P(Y,U,25),5),?72,$J($P(Y,U,33),5)
"RTN","WVRPPCD1",55,0)
 W !?2,"PROCEDURES"
"RTN","WVRPPCD1",56,0)
 W ?14,$S($P(Y,U)="PREGNANCY TEST":"NOT PREG:",1:"ABNORMAL:")
"RTN","WVRPPCD1",57,0)
 W ?24,$J($P(Y,U,8),5),?30,"(",$J($P(Y,U,9),3),"%)"
"RTN","WVRPPCD1",58,0)
 W ?38,$J($P(Y,U,19),5),?44,PG(3),?47,$J($P(Y,U,8)-$P(Y,U,19),8)
"RTN","WVRPPCD1",59,0)
 W ?59,PG(4)
"RTN","WVRPPCD1",60,0)
 I WVARJ W ?64,$J($P(Y,U,27),5),?72,$J($P(Y,U,35),5)
"RTN","WVRPPCD1",61,0)
 W !?14,"NO RESULT:",?24,$J($P(Y,U,12),5),?30,"(",$J($P(Y,U,13),3),"%)"
"RTN","WVRPPCD1",62,0)
 W ?38,$J($P(Y,U,21),5),?44,PG(5),?47,$J($P(Y,U,12)-$P(Y,U,21),8)
"RTN","WVRPPCD1",63,0)
 W ?59,PG(6)
"RTN","WVRPPCD1",64,0)
 I WVARJ W ?64,$J($P(Y,U,29),5),?72,$J($P(Y,U,37),5)
"RTN","WVRPPCD1",65,0)
 W !?14,"TOTAL:",?24,$J($P(Y,U,15),5),?38,$J($P(Y,U,23),5)
"RTN","WVRPPCD1",66,0)
 W ?44,PG(7),?47,$J($P(Y,U,15)-$P(Y,U,23),8)
"RTN","WVRPPCD1",67,0)
 W ?59,PG(8)
"RTN","WVRPPCD1",68,0)
 I WVARJ W ?64,$J($P(Y,U,31),5),?72,$J($P(Y,U,39),5)
"RTN","WVRPPCD1",69,0)
 W !!?14,$S($P(Y,U)="PREGNANCY TEST":"PREGNANT:",1:"NORMAL:")
"RTN","WVRPPCD1",70,0)
 W ?24,$J($P(Y,U,2),5),?30,"(",$J($P(Y,U,3),3),"%)"
"RTN","WVRPPCD1",71,0)
 W ?38,$J($P(Y,U,18),5),?44,PG(9),?47,$J($P(Y,U,2)-$P(Y,U,18),8)
"RTN","WVRPPCD1",72,0)
 W ?59,PG(10)
"RTN","WVRPPCD1",73,0)
 I WVARJ W ?64,$J($P(Y,U,26),5),?72,$J($P(Y,U,34),5)
"RTN","WVRPPCD1",74,0)
 W !?2,"PATIENTS"
"RTN","WVRPPCD1",75,0)
 W ?14,$S($P(Y,U)="PREGNANCY TEST":"NOT PREG:",1:"ABNORMAL:")
"RTN","WVRPPCD1",76,0)
 W ?24,$J($P(Y,U,6),5),?30,"(",$J($P(Y,U,7),3),"%)"
"RTN","WVRPPCD1",77,0)
 W ?38,$J($P(Y,U,20),5),?44,PG(11),?47,$J($P(Y,U,6)-$P(Y,U,20),8)
"RTN","WVRPPCD1",78,0)
 W ?59,PG(12)
"RTN","WVRPPCD1",79,0)
 I WVARJ W ?64,$J($P(Y,U,28),5),?72,$J($P(Y,U,36),5)
"RTN","WVRPPCD1",80,0)
 W !?14,"NO RESULT:",?24,$J($P(Y,U,10),5),?30,"(",$J($P(Y,U,11),3),"%)"
"RTN","WVRPPCD1",81,0)
 W ?38,$J($P(Y,U,22),5),?44,PG(13),?47,$J($P(Y,U,10)-$P(Y,U,22),8)
"RTN","WVRPPCD1",82,0)
 W ?59,PG(14)
"RTN","WVRPPCD1",83,0)
 I WVARJ W ?64,$J($P(Y,U,30),5),?72,$J($P(Y,U,38),5)
"RTN","WVRPPCD1",84,0)
 W !?14,"TOTAL:",?24,$J($P(Y,U,14),5),?38,$J($P(Y,U,24),5)
"RTN","WVRPPCD1",85,0)
 W ?44,PG(15),?47,$J($P(Y,U,14)-$P(Y,U,24),8)
"RTN","WVRPPCD1",86,0)
 W ?59,PG(16)
"RTN","WVRPPCD1",87,0)
 I WVARJ W ?64,$J($P(Y,U,32),5),?72,$J($P(Y,U,40),5)
"RTN","WVRPPCD1",88,0)
 Q
"RTN","WVRPPCD1",89,0)
PG ;FIGURES %'S FOR VETS & NON VETS
"RTN","WVRPPCD1",90,0)
 F JC=1:1:25 S PG(JC)=0
"RTN","WVRPPCD1",91,0)
 I $P(Y,U,4)'=0 S PG(1)=100*$P(Y,U,17)/$P(Y,U,4)
"RTN","WVRPPCD1",92,0)
 I $P(Y,U,8)'=0 S PG(3)=100*$P(Y,U,19)/$P(Y,U,8)
"RTN","WVRPPCD1",93,0)
 I $P(Y,U,12)'=0 S PG(5)=100*$P(Y,U,21)/$P(Y,U,12)
"RTN","WVRPPCD1",94,0)
 I $P(Y,U,15)'=0 S PG(7)=100*$P(Y,U,23)/$P(Y,U,15)
"RTN","WVRPPCD1",95,0)
 I $P(Y,U,2)'=0 S PG(9)=100*$P(Y,U,18)/$P(Y,U,2)
"RTN","WVRPPCD1",96,0)
 I $P(Y,U,6)'=0 S PG(11)=100*$P(Y,U,20)/$P(Y,U,6)
"RTN","WVRPPCD1",97,0)
 I $P(Y,U,10)'=0 S PG(13)=100*$P(Y,U,22)/$P(Y,U,10)
"RTN","WVRPPCD1",98,0)
 I $P(Y,U,14)'=0 S PG(15)=100*$P(Y,U,24)/$P(Y,U,14) D T
"RTN","WVRPPCD1",99,0)
 S PG(2)=$S($P(Y,U,4)'=0:100-PG(1),1:0)
"RTN","WVRPPCD1",100,0)
 S PG(4)=$S($P(Y,U,8)'=0:100-PG(3),1:0)
"RTN","WVRPPCD1",101,0)
 S PG(6)=$S($P(Y,U,12)'=0:100-PG(5),1:0)
"RTN","WVRPPCD1",102,0)
 S PG(8)=$S($P(Y,U,15)'=0:100-PG(7),1:0)
"RTN","WVRPPCD1",103,0)
 S PG(10)=$S($P(Y,U,2)'=0:100-PG(9),1:0)
"RTN","WVRPPCD1",104,0)
 S PG(12)=$S($P(Y,U,6)'=0:100-PG(11),1:0)
"RTN","WVRPPCD1",105,0)
 S PG(14)=$S($P(Y,U,10)'=0:100-PG(13),1:0)
"RTN","WVRPPCD1",106,0)
 S PG(16)=$S($P(Y,U,14)'=0:100-PG(15),1:0)
"RTN","WVRPPCD1",107,0)
 ;PAD %'S WITH BLANKS
"RTN","WVRPPCD1",108,0)
 F JC=1:1:16 S PG(JC)="  "_PG(JC) D
"RTN","WVRPPCD1",109,0)
 .S PG(JC)=$E(PG(JC),$L(PG(JC))-2,$L(PG(JC)))
"RTN","WVRPPCD1",110,0)
 .S PG(JC)="("_PG(JC)_"%)"
"RTN","WVRPPCD1",111,0)
 Q
"RTN","WVRPPCD1",112,0)
T ;ELIMINTE DECIMAL POINT IN %
"RTN","WVRPPCD1",113,0)
 N S F S=1,3,5,7,9,11,13,15 D
"RTN","WVRPPCD1",114,0)
 .S:$E($P(PG(S),".",2))'<.5 PG(S)=PG(S)+1 S PG(S)=$P(PG(S),".")
"RTN","WVRPPCD1",115,0)
 Q
"RTN","WVRPPCD1",116,0)
 ;
"RTN","WVRPPCD1",117,0)
HORIZ ;EP
"RTN","WVRPPCD1",118,0)
 ;---> NOT USED CURRENTLY: DISPLAY IN HORIZONTAL FORMAT.
"RTN","WVRPPCD1",119,0)
 W !!?2,"NORMAL",?15,"NORMAL",?28,"ABNORMAL",?41,"ABNORMAL"
"RTN","WVRPPCD1",120,0)
 W ?54,"NO RESULT",?67,"NO RESULT"
"RTN","WVRPPCD1",121,0)
 W !?2,"patients",?15,"procedures",?28,"patients",?41,"procedures"
"RTN","WVRPPCD1",122,0)
 W ?54,"patients",?67,"procedures"
"RTN","WVRPPCD1",123,0)
 S X=$E(WVLINE,1,11) W !,?2,X,?15,X,?28,X,?41,X,?54,X,?67,X
"RTN","WVRPPCD1",124,0)
 W !?2,$J($P(Y,U,2),5),"(",$P(Y,U,3),"%)"
"RTN","WVRPPCD1",125,0)
 W ?15,$J($P(Y,U,4),5),"(",$P(Y,U,5),"%)"
"RTN","WVRPPCD1",126,0)
 W ?28,$J($P(Y,U,6),5),"(",$P(Y,U,7),"%)"
"RTN","WVRPPCD1",127,0)
 W ?41,$J($P(Y,U,8),5),"(",$P(Y,U,9),"%)"
"RTN","WVRPPCD1",128,0)
 W ?54,$J($P(Y,U,10),5),"(",$P(Y,U,11),"%)"
"RTN","WVRPPCD1",129,0)
 W ?67,$J($P(Y,U,12),5),"(",$P(Y,U,13),"%)"
"RTN","WVRPPCD1",130,0)
 W !!?10,"Total Patients Receiving ",$P(Y,U),": ",$P(Y,U,14)
"RTN","WVRPPCD1",131,0)
 W !?13,"Total ",$P(Y,U)," Procedures Done: ",$P(Y,U,15),!!
"RTN","WVRPPCD1",132,0)
 Q
"RTN","WVRPPCD1",133,0)
 ;
"RTN","WVRPPCD1",134,0)
 ;
"RTN","WVRPPCD1",135,0)
WVAGRP(AGE) ;EP
"RTN","WVRPPCD1",136,0)
 ;Q:AGE="ALL" "All ages"
"RTN","WVRPPCD1",137,0)
 Q:AGE="ALL" $S(WVAGRP'=1:"Total for selected ages",1:"All ages")
"RTN","WVRPPCD1",138,0)
 Q:AGE=1 1
"RTN","WVRPPCD1",139,0)
 N I,X,Y,Z S X=WVAGRG
"RTN","WVRPPCD1",140,0)
 F I=1:1:$L(X,",")  S Y=$P($P(X,",",I),"-",2)  Q:AGE'>Y
"RTN","WVRPPCD1",141,0)
 S Z=$P($P(X,",",I),"-")
"RTN","WVRPPCD1",142,0)
 Q:AGE<Z "Under "_Y_" yrs"
"RTN","WVRPPCD1",143,0)
 Q:AGE>Y "Over "_Y_" yrs"
"RTN","WVRPPCD1",144,0)
 Q $P(X,",",I)_" yrs"
"RTN","WVRPPCD1",145,0)
 ;---> PUT A FINAL CHECK IN HERE??  *COMEBACK
"RTN","WVRPPCD1",146,0)
 Q "Unknown age"
"RTN","WVRPPCD1",147,0)
 ;
"RTN","WVRPPCD1",148,0)
 ;
"RTN","WVRPPCD1",149,0)
SUBHEAD ;EP
"RTN","WVRPPCD1",150,0)
 ;---> SUB HEADER FOR PROCEDURE BROWSE OUTPUT.
"RTN","WVRPPCD1",151,0)
 W !?5,"NOTE: Patient numbers are not intended to total.  "
"RTN","WVRPPCD1",152,0)
 W "Patients may be"
"RTN","WVRPPCD1",153,0)
 W !,"           included in more than one category.",!
"RTN","WVRPPCD1",154,0)
 W $$REPEAT^XLFSTR("=",80)
"RTN","WVRPPCD1",155,0)
 Q
"RTN","WVRPPCD2")
0^45^B59065887
"RTN","WVRPPCD2",1,0)
WVRPPCD2 ;HCIOFO/FT,JR IHS/ANMC/MWR - REPORT: PROCEDURES STATISTICS;
"RTN","WVRPPCD2",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPPCD2",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPPCD2",4,0)
 ;;  COLLATING CODE CALLED BY WVRPPCD.
"RTN","WVRPPCD2",5,0)
 ;
"RTN","WVRPPCD2",6,0)
 ;
"RTN","WVRPPCD2",7,0)
SORT ;EP
"RTN","WVRPPCD2",8,0)
 ;---> SORT AND STORE LOCAL ARRAY IN ^TMP("WV",$J,1,
"RTN","WVRPPCD2",9,0)
 K ^TMP("WV",$J),WVRES,^TMP("WVX",$J)
"RTN","WVRPPCD2",10,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVRPPCD2",11,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVRPPCD2",12,0)
 S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999
"RTN","WVRPPCD2",13,0)
 S WVDATE=WVBEGDT1
"RTN","WVRPPCD2",14,0)
 N WVDFN,WVIEN,WVPCD,Y
"RTN","WVRPPCD2",15,0)
 F  S WVDATE=$O(^WV(790.1,"D",WVDATE)) Q:'WVDATE!(WVDATE>WVENDDT1)  D
"RTN","WVRPPCD2",16,0)
 .S WVIEN=0
"RTN","WVRPPCD2",17,0)
 .F  S WVIEN=$O(^WV(790.1,"D",WVDATE,WVIEN)) Q:'WVIEN  D
"RTN","WVRPPCD2",18,0)
 ..S Y=^WV(790.1,WVIEN,0)
"RTN","WVRPPCD2",19,0)
 ..;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVRPPCD2",20,0)
 ..Q:$P(Y,U,5)=8
"RTN","WVRPPCD2",21,0)
 ..S WVDFN=$P(Y,U,2),WVPCD=$P(Y,U,4)
"RTN","WVRPPCD2",22,0)
 ..S WVAGE=$$WVAGE(WVDFN,$P(Y,U,12),WVAGRG)
"RTN","WVRPPCD2",23,0)
 ..;---> QUIT IF PATIENT'S AGE IS UNKNOWN OR OUTSIDE OF AGE RANGE.
"RTN","WVRPPCD2",24,0)
 ..Q:'WVAGE
"RTN","WVRPPCD2",25,0)
 ..;---> QUIT IF NOT SELECTING FOR ALL PROCEDURES AND IF THIS IS
"RTN","WVRPPCD2",26,0)
 ..;---> NOT ONE OF THE SELECTED PROCEDURES.
"RTN","WVRPPCD2",27,0)
 ..I '$D(WVARR("ALL")) Q:'$D(WVARR(WVPCD))
"RTN","WVRPPCD2",28,0)
 ..;---> FOR WVRES: 0=NORMAL, 1=ABNORMAL, 2=NO RESULT.
"RTN","WVRPPCD2",29,0)
 ..S WVRES=$$NORMAL^WVUTL4($P(Y,U,5))
"RTN","WVRPPCD2",30,0)
 ..; Below 5 Lines added to gather Rad Credit for rept
"RTN","WVRPPCD2",31,0)
 ..S WVJRC=$P($G(^WV(790.1,WVIEN,0)),U,35) I WVJRC'="" D
"RTN","WVRPPCD2",32,0)
 ...I '$D(^TMP("WVX",$J,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)) D  Q
"RTN","WVRPPCD2",33,0)
 ....S ^TMP("WVX",$J,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)=1
"RTN","WVRPPCD2",34,0)
 ...S X=^TMP("WVX",$J,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)+1
"RTN","WVRPPCD2",35,0)
 ...S ^TMP("WVX",$J,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)=X
"RTN","WVRPPCD2",36,0)
 ..I '$D(^TMP("WV",$J,WVPCD,WVAGE,WVDFN,WVRES)) D  Q
"RTN","WVRPPCD2",37,0)
 ...S ^TMP("WV",$J,WVPCD,WVAGE,WVDFN,WVRES)=1
"RTN","WVRPPCD2",38,0)
 ..S X=^TMP("WV",$J,WVPCD,WVAGE,WVDFN,WVRES)+1
"RTN","WVRPPCD2",39,0)
 ..S ^TMP("WV",$J,WVPCD,WVAGE,WVDFN,WVRES)=X
"RTN","WVRPPCD2",40,0)
 ;
"RTN","WVRPPCD2",41,0)
 ;
"RTN","WVRPPCD2",42,0)
TOTALS ;EP
"RTN","WVRPPCD2",43,0)
 ;---> N=WVPCD, Q=WVAGE, M=WVDFN, P=WVRES (0,1,2)
"RTN","WVRPPCD2",44,0)
 N I,M,N,P,Q
"RTN","WVRPPCD2",45,0)
 S N=0
"RTN","WVRPPCD2",46,0)
 F  S N=$O(^TMP("WV",$J,N)) Q:N=""  D
"RTN","WVRPPCD2",47,0)
 .S Q=0
"RTN","WVRPPCD2",48,0)
 .F  S Q=$O(^TMP("WV",$J,N,Q)) Q:Q=""  D
"RTN","WVRPPCD2",49,0)
 ..F I=0,1,2 S ^TMP("WVRES",$J,N,Q,I,"P")=0 S ^TMP("WVRES",$J,N,Q,I,"T")=0
"RTN","WVRPPCD2",50,0)
 ..S M=0,(^TMP("WVRES",$J,N,Q,"P"),^TMP("WVRES",$J,N,Q,"T"),^TMP("WVRES",$J,N,Q,"VT","P"),^TMP("WVRES",$J,N,Q,"VT","T"))=0
"RTN","WVRPPCD2",51,0)
 ..F  S M=$O(^TMP("WV",$J,N,Q,M)) Q:M=""  D
"RTN","WVRPPCD2",52,0)
 ...S P=-1,^TMP("WVRES",$J,N,Q,"P")=^TMP("WVRES",$J,N,Q,"P")+1
"RTN","WVRPPCD2",53,0)
 ...I $$GET1^DIQ(2,M,1901,"I")="Y" S ^TMP("WVRES",$J,N,Q,"VT","PA")=$G(^TMP("WVRES",$J,N,Q,"VT","PA"))+1
"RTN","WVRPPCD2",54,0)
 ...F  S P=$O(^TMP("WV",$J,N,Q,M,P)) Q:P=""  D
"RTN","WVRPPCD2",55,0)
 ....S ^TMP("WVRES",$J,N,Q,P,"P")=^TMP("WVRES",$J,N,Q,P,"P")+1
"RTN","WVRPPCD2",56,0)
 ....S ^TMP("WVRES",$J,N,Q,P,"T")=^TMP("WVRES",$J,N,Q,P,"T")+^TMP("WV",$J,N,Q,M,P)
"RTN","WVRPPCD2",57,0)
 ....I $$GET1^DIQ(2,M,1901,"I")="Y" D
"RTN","WVRPPCD2",58,0)
 .....S ^TMP("WVRES",$J,N,Q,P,"VT","P")=$G(^TMP("WVRES",$J,N,Q,P,"VT","P"))+1
"RTN","WVRPPCD2",59,0)
 .....S ^TMP("WVRES",$J,N,Q,P,"VT","T")=$G(^TMP("WVRES",$J,N,Q,P,"VT","T"))+^TMP("WV",$J,N,Q,M,P)
"RTN","WVRPPCD2",60,0)
 ....F WVJRC=0,2 D
"RTN","WVRPPCD2",61,0)
 .....I $G(^TMP("WVX",$J,N,Q,M,P,WVJRC))'="" S ^TMP("WVRES",$J,N,Q,"CM","PA",WVJRC)=$G(^TMP("WVRES",$J,N,Q,"CM","PA",WVJRC))+1 D
"RTN","WVRPPCD2",62,0)
 ......S ^TMP("WVRES",$J,N,Q,P,"CM","P",WVJRC)=$G(^TMP("WVRES",$J,N,Q,P,"CM","P",WVJRC))+1
"RTN","WVRPPCD2",63,0)
 ......S ^TMP("WVRES",$J,N,Q,P,"CM","T",WVJRC)=$G(^TMP("WVRES",$J,N,Q,P,"CM","T",WVJRC))+^TMP("WVX",$J,N,Q,M,P,WVJRC)
"RTN","WVRPPCD2",64,0)
 ;---> NOW COMPUTE TOTAL #PROCEDURES FOR EACH PROCEDURE, EACH AGE GROUP.
"RTN","WVRPPCD2",65,0)
 S N=0 F  S N=$O(^TMP("WVRES",$J,N)) Q:'N  D
"RTN","WVRPPCD2",66,0)
 .S Q=0 F  S Q=$O(^TMP("WVRES",$J,N,Q)) Q:'Q  D
"RTN","WVRPPCD2",67,0)
 ..S M=-1 F  S M=$O(^TMP("WVRES",$J,N,Q,M)) Q:M=""!(M'?1N.N)  D
"RTN","WVRPPCD2",68,0)
 ...S ^TMP("WVRES",$J,N,Q,"T")=^TMP("WVRES",$J,N,Q,"T")+^TMP("WVRES",$J,N,Q,M,"T")
"RTN","WVRPPCD2",69,0)
 ...;S ^TMP("WVRES",$J,N,Q,"P")=^TMP("WVRES",$J,N,Q,"P")+^TMP("WVRES",$J,N,Q,M,"P")
"RTN","WVRPPCD2",70,0)
 ...S ^TMP("WVRES",$J,N,Q,"VT","T")=$G(^TMP("WVRES",$J,N,Q,"VT","T"))+$G(^TMP("WVRES",$J,N,Q,M,"VT","T"))
"RTN","WVRPPCD2",71,0)
 ...S ^TMP("WVRES",$J,N,Q,"VT","P")=$G(^TMP("WVRES",$J,N,Q,"VT","P"))+$G(^TMP("WVRES",$J,N,Q,M,"VT","P"))
"RTN","WVRPPCD2",72,0)
 ...;*******************************************
"RTN","WVRPPCD2",73,0)
 ...F WVJRC=0,2 D
"RTN","WVRPPCD2",74,0)
 ....S ^TMP("WVRES",$J,N,Q,"CM","T",WVJRC)=$G(^TMP("WVRES",$J,N,Q,"CM","T",WVJRC))+$G(^TMP("WVRES",$J,N,Q,M,"CM","T",WVJRC))
"RTN","WVRPPCD2",75,0)
 ....S ^TMP("WVRES",$J,N,Q,"CM","P",WVJRC)=$G(^TMP("WVRES",$J,N,Q,"CM","P",WVJRC))+$G(^TMP("WVRES",$J,N,Q,M,"CM","P",WVJRC))
"RTN","WVRPPCD2",76,0)
 ...;*******************************************
"RTN","WVRPPCD2",77,0)
 ;
"RTN","WVRPPCD2",78,0)
 ;
"RTN","WVRPPCD2",79,0)
 ;---> NOW COMPUTE TOTAL #PROCEDURES FOR EACH PROCEDURE.
"RTN","WVRPPCD2",80,0)
 ;---> ^TMP("WVRES",$J,N,"P")=TOTAL PATIENTS WHO RECEIVED THIS PROCEDURE.
"RTN","WVRPPCD2",81,0)
 ;---> ^TMP("WVRES",$J,N,"T")=TOTAL TIMES THIS PROCEDURE WAS PERFORMED.
"RTN","WVRPPCD2",82,0)
 S N=0
"RTN","WVRPPCD2",83,0)
 F  S N=$O(^TMP("WVRES",$J,N)) Q:'N  D
"RTN","WVRPPCD2",84,0)
 .S Q=0,^TMP("WVRES",$J,N,"P")=0,^TMP("WVRES",$J,N,"T")=0,^TMP("WVRES",$J,N,"VT","P")=0
"RTN","WVRPPCD2",85,0)
 .S ^TMP("WVRES",$J,N,"VT","T")=0,^TMP("WVRES",$J,N,"VT","PA")=0
"RTN","WVRPPCD2",86,0)
 .F WVJRC=0,2 S ^TMP("WVRES",$J,N,"CM","T",WVJRC)=0,^TMP("WVRES",$J,N,"CM","PA",WVJRC)=0
"RTN","WVRPPCD2",87,0)
 .F  S Q=$O(^TMP("WVRES",$J,N,Q)) Q:'Q  D
"RTN","WVRPPCD2",88,0)
 ..S ^TMP("WVRES",$J,N,"P")=^TMP("WVRES",$J,N,"P")+^TMP("WVRES",$J,N,Q,"P")
"RTN","WVRPPCD2",89,0)
 ..S ^TMP("WVRES",$J,N,"T")=^TMP("WVRES",$J,N,"T")+^TMP("WVRES",$J,N,Q,"T")
"RTN","WVRPPCD2",90,0)
 ..S ^TMP("WVRES",$J,N,"VT","P")=^TMP("WVRES",$J,N,"VT","P")+$G(^TMP("WVRES",$J,N,Q,"VT","P"))
"RTN","WVRPPCD2",91,0)
 ..S ^TMP("WVRES",$J,N,"VT","T")=^TMP("WVRES",$J,N,"VT","T")+$G(^TMP("WVRES",$J,N,Q,"VT","T"))
"RTN","WVRPPCD2",92,0)
 ..S ^TMP("WVRES",$J,N,"VT","PA")=^TMP("WVRES",$J,N,"VT","PA")+$G(^TMP("WVRES",$J,N,Q,"VT","PA"))
"RTN","WVRPPCD2",93,0)
 ..F WVJRC=0,2 D
"RTN","WVRPPCD2",94,0)
 ...S ^TMP("WVRES",$J,N,"CM","P",WVJRC)=$G(^TMP("WVRES",$J,N,"CM","P",WVJRC))+$G(^TMP("WVRES",$J,N,Q,"CM","P",WVJRC))
"RTN","WVRPPCD2",95,0)
 ...S ^TMP("WVRES",$J,N,"CM","T",WVJRC)=$G(^TMP("WVRES",$J,N,"CM","T",WVJRC))+$G(^TMP("WVRES",$J,N,Q,"CM","T",WVJRC))
"RTN","WVRPPCD2",96,0)
 ...S ^TMP("WVRES",$J,N,"CM","PA",WVJRC)=$G(^TMP("WVRES",$J,N,"CM","PA",WVJRC))+$G(^TMP("WVRES",$J,N,Q,"CM","PA",WVJRC))
"RTN","WVRPPCD2",97,0)
 ;
"RTN","WVRPPCD2",98,0)
 ;
"RTN","WVRPPCD2",99,0)
FLATFL ;EP
"RTN","WVRPPCD2",100,0)
 ;---> WRITE OUT RESULTS AND PECENTAGES IN A FLAT FILE.
"RTN","WVRPPCD2",101,0)
 ;---> PIECE VALUES: 1=PROC TYPE, 2=NORMAL PATS, 3=NORMAL PATS%
"RTN","WVRPPCD2",102,0)
 ;--->               4=NORMAL PROC    5=NORMAL PROC%   6=ABNORM PATS
"RTN","WVRPPCD2",103,0)
 ;--->               7=ABNORM PATS%   8=ABNORM PROC    9=ABNORM PROC%
"RTN","WVRPPCD2",104,0)
 ;--->               10=NO RES PATS   11=NO RES PATS%  12=NO RES PROC
"RTN","WVRPPCD2",105,0)
 ;--->               13=NO RES PROC%  14=TOTAL PATS    15=TOTAL PROC,
"RTN","WVRPPCD2",106,0)
 ;--->               16=AGE GROUP,             17=NORM VETS PROC. 
"RTN","WVRPPCD2",107,0)
 ;--->               18=NORM VETS PATIENTS,    19=ABN VETS PROC.
"RTN","WVRPPCD2",108,0)
 ;--->               20=ABN VETS PATIENTS,     21=NO RES VETS PROC
"RTN","WVRPPCD2",109,0)
 ;--->               22=NO RES VETS PATIENTS   23=TOT # VET PATIENTS
"RTN","WVRPPCD2",110,0)
 ;--->               24=TOT VET PROCEDURES
"RTN","WVRPPCD2",111,0)
 S N=0
"RTN","WVRPPCD2",112,0)
 F  S N=$O(^TMP("WVRES",$J,N)) Q:'N  D
"RTN","WVRPPCD2",113,0)
 .S M=0,(WVPN,X)=$P($G(^WV(790.2,N,0)),U)
"RTN","WVRPPCD2",114,0)
 .F  S M=$O(^TMP("WVRES",$J,N,M)) Q:'M  D
"RTN","WVRPPCD2",115,0)
 ..S X=WVPN,(T,P)=0,J=""
"RTN","WVRPPCD2",116,0)
 ..S PA=$G(^TMP("WVRES",$J,N,M,"VT","PA"))
"RTN","WVRPPCD2",117,0)
 ..S CM=$G(^TMP("WVRES",$J,N,M,"CM","PA",0))
"RTN","WVRPPCD2",118,0)
 ..S CM2=$G(^TMP("WVRES",$J,N,M,"CM","PA",2))
"RTN","WVRPPCD2",119,0)
 ..S (TR2,JR2,TR,JR)="" F I=0,1,2 D
"RTN","WVRPPCD2",120,0)
 ...S X=X_U_^TMP("WVRES",$J,N,M,I,"P")
"RTN","WVRPPCD2",121,0)
 ...S X=X_U_$J((^TMP("WVRES",$J,N,M,I,"P")*100/^TMP("WVRES",$J,N,M,"P")),1,0)
"RTN","WVRPPCD2",122,0)
 ...S X=X_U_^TMP("WVRES",$J,N,M,I,"T")
"RTN","WVRPPCD2",123,0)
 ...S X=X_U_$J((^TMP("WVRES",$J,N,M,I,"T")*100/^TMP("WVRES",$J,N,M,"T")),1,0)
"RTN","WVRPPCD2",124,0)
 ...S J=J_U_$G(^TMP("WVRES",$J,N,M,I,"VT","T")) ;# of procedures total/result
"RTN","WVRPPCD2",125,0)
 ...S J=J_U_$G(^TMP("WVRES",$J,N,M,I,"VT","P")) ;# of pat having this procedure
"RTN","WVRPPCD2",126,0)
 ...S T=T+$G(^TMP("WVRES",$J,N,M,I,"VT","T"))
"RTN","WVRPPCD2",127,0)
 ...S JR=$G(JR)_U_$G(^TMP("WVRES",$J,N,M,I,"CM","T",0)) ;# of procedures total/result
"RTN","WVRPPCD2",128,0)
 ...S JR=JR_U_$G(^TMP("WVRES",$J,N,M,I,"CM","P",0)) ;# of pat having this procedure
"RTN","WVRPPCD2",129,0)
 ...S TR=TR+$G(^TMP("WVRES",$J,N,M,I,"CM","T",0))
"RTN","WVRPPCD2",130,0)
 ...S JR2=$G(JR2)_U_$G(^TMP("WVRES",$J,N,M,I,"CM","T",2)) ;# of procedures total/result
"RTN","WVRPPCD2",131,0)
 ...S JR2=JR2_U_$G(^TMP("WVRES",$J,N,M,I,"CM","P",2)) ;# of pat having this procedure
"RTN","WVRPPCD2",132,0)
 ...S TR2=TR2+$G(^TMP("WVRES",$J,N,M,I,"CM","T",2))
"RTN","WVRPPCD2",133,0)
 ..S X=X_U_^TMP("WVRES",$J,N,M,"P")_U_^TMP("WVRES",$J,N,M,"T")_U_M_J_U_T_U_PA_JR_U_TR_U_CM_JR2_U_TR2_U_CM2
"RTN","WVRPPCD2",134,0)
 ..S ^TMP("WVRES",$J,"R",WVPN,M)=X
"RTN","WVRPPCD2",135,0)
 .;--->
"RTN","WVRPPCD2",136,0)
 .;---> NOW GET TOTALS FOR THIS PROCEDURE.
"RTN","WVRPPCD2",137,0)
 .N A,B,C,D,E,F,G,H,IJ,K,L,M,O,WA,WB,WC,WD,WE,WF,WG,WH,WI,WJ,WK,WL
"RTN","WVRPPCD2",138,0)
 .S (A,B,C,D,E,F,G,H,I,K,L,M,R,O,WA,WB,WC,WD,WE,WF,WG,WH,WI,WJ,WK,WL)=0
"RTN","WVRPPCD2",139,0)
 .F  S M=$O(^TMP("WVRES",$J,"R",WVPN,M)) Q:'M  D
"RTN","WVRPPCD2",140,0)
 ..S J=$O(^WV(790.2,"B",WVPN,""))
"RTN","WVRPPCD2",141,0)
 ..S Y=^TMP("WVRES",$J,"R",WVPN,M)
"RTN","WVRPPCD2",142,0)
 ..S A=A+$P(Y,U,2),B=B+$P(Y,U,4),C=C+$P(Y,U,6)
"RTN","WVRPPCD2",143,0)
 ..S D=D+$P(Y,U,8),E=E+$P(Y,U,10),F=F+$P(Y,U,12)
"RTN","WVRPPCD2",144,0)
 ..S H=H+$P(Y,U,17),I=I+$P(Y,U,18),K=K+$P(Y,U,19)
"RTN","WVRPPCD2",145,0)
 ..S L=L+$P(Y,U,20),R=R+$P(Y,U,21),O=O+$P(Y,U,22)
"RTN","WVRPPCD2",146,0)
 ..S WA=WA+$P(Y,U,25),WB=WB+$P(Y,U,26),WC=WC+$P(Y,U,27)
"RTN","WVRPPCD2",147,0)
 ..S WD=WD+$P(Y,U,28),WE=WE+$P(Y,U,29),WF=WF+$P(Y,U,30)
"RTN","WVRPPCD2",148,0)
 ..S WG=WG+$P(Y,U,33),WH=WH+$P(Y,U,34),WI=WI+$P(Y,U,35)
"RTN","WVRPPCD2",149,0)
 ..S WJ=WJ+$P(Y,U,36),WK=WK+$P(Y,U,37),WL=WL+$P(Y,U,38)
"RTN","WVRPPCD2",150,0)
 .S X=WVPN_U_A_U_$J(A*100/^TMP("WVRES",$J,N,"P"),1,0)
"RTN","WVRPPCD2",151,0)
 .S X=X_U_B_U_$J(B*100/^TMP("WVRES",$J,N,"T"),1,0)
"RTN","WVRPPCD2",152,0)
 .S X=X_U_C_U_$J(C*100/^TMP("WVRES",$J,N,"P"),1,0)
"RTN","WVRPPCD2",153,0)
 .S X=X_U_D_U_$J(D*100/^TMP("WVRES",$J,N,"T"),1,0)
"RTN","WVRPPCD2",154,0)
 .S X=X_U_E_U_$J(E*100/^TMP("WVRES",$J,N,"P"),1,0)
"RTN","WVRPPCD2",155,0)
 .S X=X_U_F_U_$J(F*100/^TMP("WVRES",$J,N,"T"),1,0)
"RTN","WVRPPCD2",156,0)
 .S X=X_U_^TMP("WVRES",$J,N,"P")_U_^TMP("WVRES",$J,N,"T")_U_"ALL"
"RTN","WVRPPCD2",157,0)
 .S J=U_H_U_I_U_K_U_L_U_R_U_O_U
"RTN","WVRPPCD2",158,0)
 .S J=J_$G(^TMP("WVRES",$J,N,"VT","T"))_U_$G(^TMP("WVRES",$J,N,"VT","PA"))
"RTN","WVRPPCD2",159,0)
 .S J=J_U_WA_U_WB_U_WC_U_WD_U_WE_U_WF
"RTN","WVRPPCD2",160,0)
 .S J=J_U_$G(^TMP("WVRES",$J,N,"CM","T",0))_U_$G(^TMP("WVRES",$J,N,"CM","PA",0))
"RTN","WVRPPCD2",161,0)
 .S J=J_U_WG_U_WH_U_WI_U_WJ_U_WK_U_WL
"RTN","WVRPPCD2",162,0)
 .S J=J_U_$G(^TMP("WVRES",$J,N,"CM","T",2))_U_$G(^TMP("WVRES",$J,N,"CM","PA",2))
"RTN","WVRPPCD2",163,0)
 .S ^TMP("WVRES",$J,"R",WVPN,"ALL")=X_J
"RTN","WVRPPCD2",164,0)
 Q
"RTN","WVRPPCD2",165,0)
 ;
"RTN","WVRPPCD2",166,0)
 ;
"RTN","WVRPPCD2",167,0)
WVAGE(DFN,DATE,X) ;EP
"RTN","WVRPPCD2",168,0)
 ;---> SET AGE CATEGORY.
"RTN","WVRPPCD2",169,0)
 ;---> REQUIRED VARIABLES: DATE=DATE PATIENT RECEIVED THIS PROCEDURE.
"RTN","WVRPPCD2",170,0)
 ;--->                     DFN, X=WVAGRG (AGE RANGE).
"RTN","WVRPPCD2",171,0)
 ;---> IF NOT DISPLAY BY AGE, SET ALL WVAGE=1
"RTN","WVRPPCD2",172,0)
 Q:X=1 1
"RTN","WVRPPCD2",173,0)
 N AGE,Y,Z
"RTN","WVRPPCD2",174,0)
 S AGE=$P($$AGEAT^WVUTL1(DFN,DATE),"y/o")
"RTN","WVRPPCD2",175,0)
 ;---> RETURN 0 IF PATIENT'S AGE IS UNKNOWN.
"RTN","WVRPPCD2",176,0)
 Q:'+AGE 0
"RTN","WVRPPCD2",177,0)
 ;
"RTN","WVRPPCD2",178,0)
 F I=1:1:$L(X,",") S Y=$P($P(X,",",I),"-",2) Q:AGE'>Y
"RTN","WVRPPCD2",179,0)
 S Z=$P($P(X,",",I),"-")
"RTN","WVRPPCD2",180,0)
 ;---> RETURN 0 IF PATIENT IS OUTSIDE DATE RANGE.
"RTN","WVRPPCD2",181,0)
 Q:(AGE<Z!(AGE>Y)) 0
"RTN","WVRPPCD2",182,0)
 Q Y
"RTN","WVRPSCR")
0^46^B16852245
"RTN","WVRPSCR",1,0)
WVRPSCR ;HCIOFO/FT,JR IHS/ANMC/MWR - Display Compliance Rates ;8/18/98  21:16
"RTN","WVRPSCR",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPSCR",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSCR",4,0)
 ;;  THIS REPORT WILL DISPLAY COMPLIANCE RATES FOR PAPS & MAMS.
"RTN","WVRPSCR",5,0)
 ;
"RTN","WVRPSCR",6,0)
PRINT ;EP
"RTN","WVRPSCR",7,0)
 ;
"RTN","WVRPSCR",8,0)
 N I,J,M,N,P,Q
"RTN","WVRPSCR",9,0)
 D SETUP
"RTN","WVRPSCR",10,0)
 D TITLE^WVUTL5("COMPLIANCE RATES FOR PAPS AND MAMS")
"RTN","WVRPSCR",11,0)
 D TEXT1,DIRZ^WVUTL3 G:WVPOP EXIT
"RTN","WVRPSCR",12,0)
 D DATES   G:WVPOP EXIT
"RTN","WVRPSCR",13,0)
 D AGERNG  G:WVPOP EXIT
"RTN","WVRPSCR",14,0)
 D DEVICE  G:WVPOP EXIT
"RTN","WVRPSCR",15,0)
 D DATA^WVRPSCR1,EN^WVRPSCR2
"RTN","WVRPSCR",16,0)
 D DISPLAY
"RTN","WVRPSCR",17,0)
 I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVRPSCR",18,0)
 ;
"RTN","WVRPSCR",19,0)
EXIT ;EP
"RTN","WVRPSCR",20,0)
 D KILLALL^WVUTL8
"RTN","WVRPSCR",21,0)
 Q
"RTN","WVRPSCR",22,0)
 ;
"RTN","WVRPSCR",23,0)
SETUP ;EP
"RTN","WVRPSCR",24,0)
 D SETVARS^WVUTL5
"RTN","WVRPSCR",25,0)
 Q
"RTN","WVRPSCR",26,0)
 ;
"RTN","WVRPSCR",27,0)
DATES ;EP
"RTN","WVRPSCR",28,0)
 ;---> ASK DATE RANGE.  RETURN DATES IN WVBEGDT AND WVENDDT.
"RTN","WVRPSCR",29,0)
 D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP)
"RTN","WVRPSCR",30,0)
 Q
"RTN","WVRPSCR",31,0)
 ;
"RTN","WVRPSCR",32,0)
AGERNG ;EP
"RTN","WVRPSCR",33,0)
 ;---> ASK AGE RANGE.
"RTN","WVRPSCR",34,0)
 ;---> RETURN AGE RANGE IN WVAGRG.
"RTN","WVRPSCR",35,0)
 D AGERNG^WVRPSCR1(.WVAGRG,.WVPOP)
"RTN","WVRPSCR",36,0)
 Q
"RTN","WVRPSCR",37,0)
 ;
"RTN","WVRPSCR",38,0)
DEVICE ;EP
"RTN","WVRPSCR",39,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVRPSCR",40,0)
 S ZTRTN="DEQUEUE^WVRPSCR"
"RTN","WVRPSCR",41,0)
 F WVSV="AGRG","BEGDT","ENDDT" D
"RTN","WVRPSCR",42,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVRPSCR",43,0)
 ;---> SAVE ATTRIBUTES ARRAY. NOTE: SUBSTITUTE LOCAL ARRAY FOR WVATT.
"RTN","WVRPSCR",44,0)
 I $D(WVCC) N N S N=0 F  S N=$O(WVCC(N)) Q:N=""  D
"RTN","WVRPSCR",45,0)
 .S ZTSAVE("WVCC("""_N_""")")=""
"RTN","WVRPSCR",46,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVRPSCR",47,0)
 Q
"RTN","WVRPSCR",48,0)
 ;
"RTN","WVRPSCR",49,0)
 ;
"RTN","WVRPSCR",50,0)
DISPLAY ;EP
"RTN","WVRPSCR",51,0)
 U IO
"RTN","WVRPSCR",52,0)
 S WVTITLE="*  WOMEN'S HEALTH: COMPLIANCE RATES FOR PAPS AND MAMS  *"
"RTN","WVRPSCR",53,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVRPSCR",54,0)
 D TOPHEAD^WVUTL7
"RTN","WVRPSCR",55,0)
 S WVPAGE=1,WVPOP=0
"RTN","WVRPSCR",56,0)
 S WVSUB="W !?3,""For Age Range: "",$S(WVAGRG=1:""ALL"",1:WVAGRG)"
"RTN","WVRPSCR",57,0)
 ;
"RTN","WVRPSCR",58,0)
 S (WVPOP,N,Z)=0
"RTN","WVRPSCR",59,0)
 W:WVCRT @IOF D HEADER8^WVUTL7
"RTN","WVRPSCR",60,0)
 F  S N=$O(^TMP("WV",$J,N)) Q:'N!(WVPOP)  D
"RTN","WVRPSCR",61,0)
 .I N=16.001!(N=7.001) W ! D HDR^WVRPSCR2
"RTN","WVRPSCR",62,0)
 .I $Y+3>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  I $O(^TMP("WV",$J,N))'="" W @IOF D HEADER8^WVUTL7 D:'WVCRT HDR^WVRPSCR2
"RTN","WVRPSCR",63,0)
 .W !,^TMP("WV",$J,N,0)
"RTN","WVRPSCR",64,0)
 D ^%ZISC
"RTN","WVRPSCR",65,0)
 Q
"RTN","WVRPSCR",66,0)
 ;
"RTN","WVRPSCR",67,0)
DEQUEUE ;EP
"RTN","WVRPSCR",68,0)
 ;---> CALLED BY TASKMAN
"RTN","WVRPSCR",69,0)
 D SETUP,DATA^WVRPSCR1,EN^WVRPSCR2,DISPLAY,EXIT
"RTN","WVRPSCR",70,0)
 Q
"RTN","WVRPSCR",71,0)
 ;
"RTN","WVRPSCR",72,0)
TEXT1 ;
"RTN","WVRPSCR",73,0)
 ;;This report is designed to serve as an indicator of compliance
"RTN","WVRPSCR",74,0)
 ;;rates for PAPs and MAMs.  The report will display the percentages
"RTN","WVRPSCR",75,0)
 ;;of women who received PAPs and MAMs for compliance purposes only,
"RTN","WVRPSCR",76,0)
 ;;within the selected date range.
"RTN","WVRPSCR",77,0)
 ;;
"RTN","WVRPSCR",78,0)
 ;;Only patients who have had normal results for procedures in the
"RTN","WVRPSCR",79,0)
 ;;specified date range are counted; the intent is to exclude
"RTN","WVRPSCR",80,0)
 ;;any procedures that would involve abnormal results, diagnostic
"RTN","WVRPSCR",81,0)
 ;;and follow-up procedures, etc.  Due to the complexities
"RTN","WVRPSCR",82,0)
 ;;involved in the treatment of individual cases that involve
"RTN","WVRPSCR",83,0)
 ;;abnormal results, those patients will not be included, even
"RTN","WVRPSCR",84,0)
 ;;though some of them may have received screening PAPs or MAMs.
"RTN","WVRPSCR",85,0)
 ;;
"RTN","WVRPSCR",86,0)
 ;;This report, therefore, serves ONLY AS AN INDICATOR (NOT as an exact
"RTN","WVRPSCR",87,0)
 ;;count of compliance rates) for gauging the success rates of annual
"RTN","WVRPSCR",88,0)
 ;;screening programs.  It can be run for several different time frames
"RTN","WVRPSCR",89,0)
 ;;in order to examine trends.  Assuming a screening cycle of one year,
"RTN","WVRPSCR",90,0)
 ;;a minimum date range spanning 15 months is recommended.
"RTN","WVRPSCR",91,0)
 S WVTAB=5,WVLINL="TEXT1" D PRINTX
"RTN","WVRPSCR",92,0)
 Q
"RTN","WVRPSCR",93,0)
 ;
"RTN","WVRPSCR",94,0)
PRINTX ;EP
"RTN","WVRPSCR",95,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPSCR",96,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVRPSCR",97,0)
 Q
"RTN","WVRPSCR1")
0^47^B37305325
"RTN","WVRPSCR1",1,0)
WVRPSCR1 ;HCIOFO/FT,JR IHS/ANMC/MWR - Display Compliance Rates (cont.) ;8/18/98  21:17
"RTN","WVRPSCR1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPSCR1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSCR1",4,0)
 ;;  THIS REPORT WILL DISPLAY COMPLIANCE RATES FOR PAPS & MAMS.
"RTN","WVRPSCR1",5,0)
 ;;  ENTRY POINTS CALLED BY WVRPSCR.
"RTN","WVRPSCR1",6,0)
DATA ;EP
"RTN","WVRPSCR1",7,0)
 ;---> SORT AND STORE ARRAY IN ^TMP("WV",$J
"RTN","WVRPSCR1",8,0)
 K WVTMP,^TMP("WV",$J),^TMP("WVP",$J),WVPR
"RTN","WVRPSCR1",9,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVRPSCR1",10,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVRPSCR1",11,0)
 F WVCNT=20,30,40,50,60,70,200 S WVAGRG(WVCNT)=""
"RTN","WVRPSCR1",12,0)
 S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999
"RTN","WVRPSCR1",13,0)
 ;
"RTN","WVRPSCR1",14,0)
 S WVDATE=WVBEGDT1
"RTN","WVRPSCR1",15,0)
 F  S WVDATE=$O(^WV(790.1,"D",WVDATE)) Q:'WVDATE!(WVDATE>WVENDDT1)  D
"RTN","WVRPSCR1",16,0)
 .S WVIEN=0
"RTN","WVRPSCR1",17,0)
 .F  S WVIEN=$O(^WV(790.1,"D",WVDATE,WVIEN)) Q:'WVIEN  D
"RTN","WVRPSCR1",18,0)
 ..S Y=^WV(790.1,WVIEN,0)
"RTN","WVRPSCR1",19,0)
 ..S WVDFN=$P(Y,U,2),WVPCDN=$P(Y,U,4),WVRES=$P(Y,U,5)
"RTN","WVRPSCR1",20,0)
 ..;
"RTN","WVRPSCR1",21,0)
 ..;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVRPSCR1",22,0)
 ..Q:WVRES=8
"RTN","WVRPSCR1",23,0)
 ..;
"RTN","WVRPSCR1",24,0)
 ..;---> QUIT IF NEITHER A PAP (IEN=1) NOR A SCREENING MAM (IEN=28).
"RTN","WVRPSCR1",25,0)
 ..Q:((WVPCDN'=1)&(WVPCDN'=28))
"RTN","WVRPSCR1",26,0)
 ..;
"RTN","WVRPSCR1",27,0)
 ..;---> QUIT IS PATIENT IS NOT WITHIN AGE RANGE.
"RTN","WVRPSCR1",28,0)
 ..S WVAGE=+$$AGE^WVUTL1(WVDFN)
"RTN","WVRPSCR1",29,0)
 ..I WVAGRG'=1 Q:((WVAGE<$P(WVAGRG,"-"))!(WVAGE>$P(WVAGRG,"-",2)))
"RTN","WVRPSCR1",30,0)
 ..;
"RTN","WVRPSCR1",31,0)
 ..;---> GET VALUE OF RESULT: 0=NORMAL, 1=ABNORMAL, 2=NO RESULT
"RTN","WVRPSCR1",32,0)
 ..S WVNORM=$$NORMAL^WVUTL4(WVRES) S:WVNORM=2 WVNORM=0
"RTN","WVRPSCR1",33,0)
 ..;
"RTN","WVRPSCR1",34,0)
 ..S ^TMP("WV",$J,WVDFN,WVNORM,WVPCDN,WVIEN)=""
"RTN","WVRPSCR1",35,0)
 ..I WVPCDN=1 D
"RTN","WVRPSCR1",36,0)
 ...S WVJPAPR=$P($G(^WV(790,WVDFN,0)),U,16)
"RTN","WVRPSCR1",37,0)
 ...I WVJPAPR'>0 S WVJPAPR="NOT SPECIFIED"
"RTN","WVRPSCR1",38,0)
 ...E  S WVJPAPR=$P($G(^WV(790.03,WVJPAPR,0)),U)
"RTN","WVRPSCR1",39,0)
 ...S ^TMP("WVP",$J,WVJPAPR,WVDFN,WVNORM,WVPCDN,WVIEN)=""
"RTN","WVRPSCR1",40,0)
 ..I WVPCDN=28 D
"RTN","WVRPSCR1",41,0)
 ...S WVJ=$O(WVAGRG(WVAGE))
"RTN","WVRPSCR1",42,0)
 ...S WVJAGER=$S(WVJ=20:"<20",WVJ=30:"20-29",WVJ=40:"30-39",WVJ=50:"40-49",WVJ=60:"50-59",WVJ=70:"60-69",WVJ=200:">70",1:"AGE UNKNOWN")
"RTN","WVRPSCR1",43,0)
 ...S ^TMP("WVP",$J,WVJAGER,WVDFN,WVNORM,WVPCDN,WVIEN)=""
"RTN","WVRPSCR1",44,0)
 ;
"RTN","WVRPSCR1",45,0)
 ;---> NOW COLLATE DATA FROM ^TMP ARRAY INTO LOCAL WVTMP REPORT ARRAY.
"RTN","WVRPSCR1",46,0)
 ;---> FIRST, SEED LOCAL ARRAY WITH ZEROS.
"RTN","WVRPSCR1",47,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR1",48,0)
 .N I F I=1:1:5 S WVTMP("RES",M,I)=0
"RTN","WVRPSCR1",49,0)
 ;
"RTN","WVRPSCR1",50,0)
 ;---> COLLATE DATA.
"RTN","WVRPSCR1",51,0)
 S N=0
"RTN","WVRPSCR1",52,0)
 F  S N=$O(^TMP("WV",$J,N)) Q:'N  D
"RTN","WVRPSCR1",53,0)
 .F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR1",54,0)
 ..Q:$D(^TMP("WV",$J,N,1,M))
"RTN","WVRPSCR1",55,0)
 ..S P=0,Q=0
"RTN","WVRPSCR1",56,0)
 ..F  S P=$O(^TMP("WV",$J,N,0,M,P)) Q:'P  S Q=Q+1
"RTN","WVRPSCR1",57,0)
 ..Q:'Q
"RTN","WVRPSCR1",58,0)
 ..I '$D(WVTMP("RES",M,Q)) S WVTMP("RES",M,Q)=1 Q
"RTN","WVRPSCR1",59,0)
 ..S WVTMP("RES",M,Q)=WVTMP("RES",M,Q)+1
"RTN","WVRPSCR1",60,0)
 ;
"RTN","WVRPSCR1",61,0)
 ;---> STORE ALL NODES >5 IN THE 5+ NODE.
"RTN","WVRPSCR1",62,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR1",63,0)
 .S Q=5
"RTN","WVRPSCR1",64,0)
 .F  S Q=$O(WVTMP("RES",M,Q)) Q:'Q  D
"RTN","WVRPSCR1",65,0)
 ..S WVTMP("RES",M,5)=WVTMP("RES",M,5)+WVTMP("RES",M,Q)
"RTN","WVRPSCR1",66,0)
 ..K WVTMP("RES",M,Q)
"RTN","WVRPSCR1",67,0)
 ;
"RTN","WVRPSCR1",68,0)
 ;---> FIGURE PERCENTAGES OF WOMEN AND STORE IN ARRAY.
"RTN","WVRPSCR1",69,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR1",70,0)
 .S WVTOT=0
"RTN","WVRPSCR1",71,0)
 .F Q=1:1:5 S WVTOT=WVTOT+WVTMP("RES",M,Q)
"RTN","WVRPSCR1",72,0)
 .S:'WVTOT WVTOT=1
"RTN","WVRPSCR1",73,0)
 .F Q=1:1:5 S $P(WVTMP("RES",M,Q),U,2)=$J((+WVTMP("RES",M,Q)/WVTOT),0,2)
"RTN","WVRPSCR1",74,0)
 ;
"RTN","WVRPSCR1",75,0)
 ;---> BUILD DISPLAY ARRAY.
"RTN","WVRPSCR1",76,0)
 N WVNODE K ^TMP("WV",$J)
"RTN","WVRPSCR1",77,0)
 ;
"RTN","WVRPSCR1",78,0)
 ;---> PAPS SUBHEADER LINE.
"RTN","WVRPSCR1",79,0)
 S WVNODE=$$S(40)_"SCREENING PAPS"
"RTN","WVRPSCR1",80,0)
 D WRITE(1,WVNODE)
"RTN","WVRPSCR1",81,0)
 S WVNODE=$$S(39)_"----------------"
"RTN","WVRPSCR1",82,0)
 D WRITE(2,WVNODE)
"RTN","WVRPSCR1",83,0)
 S WVNODE=" # of PAPs:                                        1     2     3     4     5+"
"RTN","WVRPSCR1",84,0)
 D WRITE(4,WVNODE)
"RTN","WVRPSCR1",85,0)
 S WVNODE=" -----------                                     ----- ----- ----- ----- -----"
"RTN","WVRPSCR1",86,0)
 D WRITE(5,WVNODE)
"RTN","WVRPSCR1",87,0)
 ;
"RTN","WVRPSCR1",88,0)
 ;---> PAPS NUMBER OF WOMEN DATA LINE.
"RTN","WVRPSCR1",89,0)
 S WVNODE=" # of Women:                                    "
"RTN","WVRPSCR1",90,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J($P(WVTMP("RES",1,Q),U),6)
"RTN","WVRPSCR1",91,0)
 D WRITE(6,WVNODE)
"RTN","WVRPSCR1",92,0)
 S WVNODE=" % of Women:                                    "
"RTN","WVRPSCR1",93,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J(($P(WVTMP("RES",1,Q),U,2)*100),5)_"%"
"RTN","WVRPSCR1",94,0)
 D WRITE(7,WVNODE)
"RTN","WVRPSCR1",95,0)
 ;
"RTN","WVRPSCR1",96,0)
 ;---> LINE FEEDS BETWEEN PAPS AND MAMS.
"RTN","WVRPSCR1",97,0)
 S WVNODE="" D WRITE(8,WVNODE) S WVNODE="" D WRITE(9,WVNODE)
"RTN","WVRPSCR1",98,0)
 ;
"RTN","WVRPSCR1",99,0)
 ;---> MAMS SUBHEADER LINE.
"RTN","WVRPSCR1",100,0)
 S WVNODE=$$S(40)_"SCREENING MAMS"
"RTN","WVRPSCR1",101,0)
 D WRITE(10,WVNODE)
"RTN","WVRPSCR1",102,0)
 S WVNODE=$$S(39)_"----------------"
"RTN","WVRPSCR1",103,0)
 D WRITE(11,WVNODE)
"RTN","WVRPSCR1",104,0)
 S WVNODE=" # of MAMs:                                        1     2     3     4     5+"
"RTN","WVRPSCR1",105,0)
 D WRITE(13,WVNODE)
"RTN","WVRPSCR1",106,0)
 S WVNODE=" -----------                                     ----- ----- ----- ----- -----"
"RTN","WVRPSCR1",107,0)
 D WRITE(14,WVNODE)
"RTN","WVRPSCR1",108,0)
 ;
"RTN","WVRPSCR1",109,0)
 ;---> PAPS NUMBER OF WOMEN DATA LINE.
"RTN","WVRPSCR1",110,0)
 S WVNODE=" # of Women:                                    "
"RTN","WVRPSCR1",111,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J($P(WVTMP("RES",28,Q),U),6)
"RTN","WVRPSCR1",112,0)
 D WRITE(15,WVNODE)
"RTN","WVRPSCR1",113,0)
 S WVNODE=" % of Women:                                    "
"RTN","WVRPSCR1",114,0)
 F Q=1:1:5 S WVNODE=WVNODE_$J(($P(WVTMP("RES",28,Q),U,2)*100),5)_"%"
"RTN","WVRPSCR1",115,0)
 D WRITE(16,WVNODE)
"RTN","WVRPSCR1",116,0)
 Q
"RTN","WVRPSCR1",117,0)
 ;
"RTN","WVRPSCR1",118,0)
WRITE(I,Y) ;EP
"RTN","WVRPSCR1",119,0)
 S ^TMP("WV",$J,I,0)=Y
"RTN","WVRPSCR1",120,0)
 Q
"RTN","WVRPSCR1",121,0)
 ;
"RTN","WVRPSCR1",122,0)
S(S) ;EP
"RTN","WVRPSCR1",123,0)
 ;---> SPACES.
"RTN","WVRPSCR1",124,0)
 Q $$S^WVUTL7($G(S))
"RTN","WVRPSCR1",125,0)
 ;
"RTN","WVRPSCR1",126,0)
 ;
"RTN","WVRPSCR1",127,0)
AGERNG(WVAGRG,WVPOP) ;EP
"RTN","WVRPSCR1",128,0)
 ;---> ASK AGE RANGE.
"RTN","WVRPSCR1",129,0)
 ;---> RETURN AGE RANGE IN WVAGRG.
"RTN","WVRPSCR1",130,0)
 N DIR,DIRUT,Y S WVPOP=0
"RTN","WVRPSCR1",131,0)
 W !!?3,"Do you wish to limit this report to an age range?"
"RTN","WVRPSCR1",132,0)
 S DIR(0)="Y",DIR("B")="NO" D HELP1
"RTN","WVRPSCR1",133,0)
 S DIR("A")="   Enter Yes or No"
"RTN","WVRPSCR1",134,0)
 D ^DIR K DIR W !
"RTN","WVRPSCR1",135,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVRPSCR1",136,0)
 ;---> IF NOT DISPLAYING BY AGE RANGE, SET WVAGRG (AGE RANGE)=1, QUIT.
"RTN","WVRPSCR1",137,0)
 I 'Y S WVAGRG=1 Q
"RTN","WVRPSCR1",138,0)
BYAGE1 ;
"RTN","WVRPSCR1",139,0)
 W !?5,"Enter the age range you wish to select in the form of: 40-75"
"RTN","WVRPSCR1",140,0)
 W !?5,"Use a dash ""-"" to separate the limits of the range."
"RTN","WVRPSCR1",141,0)
 W !?5,"To select only one age, simply enter that age, with no dash."
"RTN","WVRPSCR1",142,0)
 W !?5,"(NOTE: Patient ages will reflect the age they are today.)",!
"RTN","WVRPSCR1",143,0)
 K DIR
"RTN","WVRPSCR1",144,0)
 S DIR(0)="FOA",DIR("A")="     Enter age range: "
"RTN","WVRPSCR1",145,0)
 S:$D(^WV(790.72,DUZ,0)) DIR("B")=$P(^(0),U,3)
"RTN","WVRPSCR1",146,0)
 D ^DIR K DIR
"RTN","WVRPSCR1",147,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVRPSCR1",148,0)
 D CHECK(.Y)
"RTN","WVRPSCR1",149,0)
 I Y="" D  G BYAGE1
"RTN","WVRPSCR1",150,0)
 .W !!?5,"* INVALID AGE RANGE.  Please begin again."
"RTN","WVRPSCR1",151,0)
 ;---> WVAGRG=SELECTED AGE RANGE(S).
"RTN","WVRPSCR1",152,0)
 S WVAGRG=Y
"RTN","WVRPSCR1",153,0)
 D DIC^WVFMAN(790.72,"L",.Y,"","","","`"_DUZ)
"RTN","WVRPSCR1",154,0)
 Q:Y<0
"RTN","WVRPSCR1",155,0)
 D DIE^WVFMAN(790.72,".03////"_WVAGRG,+Y,.WVPOP,1)
"RTN","WVRPSCR1",156,0)
 Q
"RTN","WVRPSCR1",157,0)
 ;
"RTN","WVRPSCR1",158,0)
HELP1 ;EP
"RTN","WVRPSCR1",159,0)
 ;;Answer "YES" to display screening rates for a specific age range.
"RTN","WVRPSCR1",160,0)
 ;;If you choose to display for an age range, you will be given the
"RTN","WVRPSCR1",161,0)
 ;;opportunity to select the age range.  For example, you might choose
"RTN","WVRPSCR1",162,0)
 ;;to display from ages 50-75.
"RTN","WVRPSCR1",163,0)
 ;;Answer "NO" to display screening rates for all ages.
"RTN","WVRPSCR1",164,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVRPSCR1",165,0)
 Q
"RTN","WVRPSCR1",166,0)
 ;
"RTN","WVRPSCR1",167,0)
PRINTX ;EP
"RTN","WVRPSCR1",168,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPSCR1",169,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  W !,T,$P(X,";;",2)
"RTN","WVRPSCR1",170,0)
 Q
"RTN","WVRPSCR1",171,0)
 ;
"RTN","WVRPSCR1",172,0)
HELPTX ;EP
"RTN","WVRPSCR1",173,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVRPSCR1",174,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPSCR1",175,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVRPSCR1",176,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVRPSCR1",177,0)
 Q
"RTN","WVRPSCR1",178,0)
 ;
"RTN","WVRPSCR1",179,0)
CHECK(X) ;EP
"RTN","WVRPSCR1",180,0)
 ;---> CHECK SYNTAX OF AGE RANGE STRING.
"RTN","WVRPSCR1",181,0)
 ;---> IF X=ONE AGE ONLY, SET IT IN THE FORM X-X AND QUIT.
"RTN","WVRPSCR1",182,0)
 I X?1N.N S X=X_"-"_X Q
"RTN","WVRPSCR1",183,0)
 ;
"RTN","WVRPSCR1",184,0)
 N FAIL,I,Y1,Y2
"RTN","WVRPSCR1",185,0)
 S FAIL=0
"RTN","WVRPSCR1",186,0)
 ;---> CHECK EACH RANGE.
"RTN","WVRPSCR1",187,0)
 S Y1=$P(X,"-"),Y2=$P(X,"-",2)
"RTN","WVRPSCR1",188,0)
 ;---> EACH END OF EACH RANGE SHOULD BE A NUMBER.
"RTN","WVRPSCR1",189,0)
 I (Y1'?1N.N)!(Y2'?1N.N) S X="" Q
"RTN","WVRPSCR1",190,0)
 ;---> THE LOWER NUMBER SHOULD BE FIRST.
"RTN","WVRPSCR1",191,0)
 I Y2<Y1 S FAIL=1
"RTN","WVRPSCR1",192,0)
 I FAIL S X="" Q
"RTN","WVRPSCR1",193,0)
 Q
"RTN","WVRPSCR2")
0^48^B6523050
"RTN","WVRPSCR2",1,0)
WVRPSCR2 ;HCIOFO/JWR - WVRPSCR cont'd, Gathers Pap Regimens info. ;8/3/98  12:38
"RTN","WVRPSCR2",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPSCR2",3,0)
EN ;---> NOW COLLATE DATA FROM ^TMP ARRAY INTO LOCAL WVTMP REPORT ARRAY.
"RTN","WVRPSCR2",4,0)
 ;---> FIRST, SEED LOCAL ARRAY WITH ZEROS.
"RTN","WVRPSCR2",5,0)
 K WVPR
"RTN","WVRPSCR2",6,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR2",7,0)
 .;N J S J=""
"RTN","WVRPSCR2",8,0)
 .;F J=$O(^TMP("WVP",$J,J)) Q:J=""  N I F I=1:1:5 S WVPR(WVJTYP,J,M,I)=0
"RTN","WVRPSCR2",9,0)
 ;
"RTN","WVRPSCR2",10,0)
 ;---> COLLATE DATA.
"RTN","WVRPSCR2",11,0)
 S J="" F  S J=$O(^TMP("WVP",$J,J)) Q:J=""  D
"RTN","WVRPSCR2",12,0)
 .S N=0 F  S N=$O(^TMP("WVP",$J,J,N)) Q:'N  D
"RTN","WVRPSCR2",13,0)
 ..F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR2",14,0)
 ...Q:$D(^TMP("WVP",$J,J,N,1,M))  ;DON'T INCLUDE IF PATIENT HAD ANY ABNOR
"RTN","WVRPSCR2",15,0)
 ...S P=0,Q=0
"RTN","WVRPSCR2",16,0)
 ...F  S P=$O(^TMP("WVP",$J,J,N,0,M,P)) Q:'P  S Q=Q+1
"RTN","WVRPSCR2",17,0)
 ...Q:'Q
"RTN","WVRPSCR2",18,0)
 ...I '$D(WVPR(WVJTYP,J,M,Q)) S WVPR(WVJTYP,J,M,Q)=1 Q
"RTN","WVRPSCR2",19,0)
 ...S WVPR(WVJTYP,J,M,Q)=WVPR(WVJTYP,J,M,Q)+1
"RTN","WVRPSCR2",20,0)
 ;
"RTN","WVRPSCR2",21,0)
 ;---> STORE ALL NODES >5 IN THE 5+ NODE.
"RTN","WVRPSCR2",22,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR2",23,0)
 .S J="" F  S J=$O(^TMP("WVP",$J,J)) Q:J=""  D
"RTN","WVRPSCR2",24,0)
 ..S Q=5
"RTN","WVRPSCR2",25,0)
 ..F  S Q=$O(WVPR(WVJTYP,J,M,Q)) Q:'Q  D
"RTN","WVRPSCR2",26,0)
 ...S WVPR(WVJTYP,J,M,5)=$G(WVPR(WVJTYP,J,M,5))+WVPR(WVJTYP,J,M,Q)
"RTN","WVRPSCR2",27,0)
 ...;K WVPR(WVJTYP,J,M,Q)
"RTN","WVRPSCR2",28,0)
 ;
"RTN","WVRPSCR2",29,0)
 ;---> FIGURE PERCENTAGES OF WOMEN AND STORE IN ARRAY.
"RTN","WVRPSCR2",30,0)
 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") D
"RTN","WVRPSCR2",31,0)
 .S J="" F  S J=$O(WVPR(WVJTYP,J)) Q:J=""  D
"RTN","WVRPSCR2",32,0)
 ..S WVTOT=0
"RTN","WVRPSCR2",33,0)
 ..F Q=1:1:5 S WVTOT=WVTOT+$G(WVPR(WVJTYP,J,M,Q))
"RTN","WVRPSCR2",34,0)
 ..S:'WVTOT WVTOT=1
"RTN","WVRPSCR2",35,0)
 ..F Q=1:1:5 I $D(WVPR(WVJTYP,J,M,Q)) S $P(WVPR(WVJTYP,J,M,Q),U,2)=$J((+WVPR(WVJTYP,J,M,Q)/WVTOT),0,2)
"RTN","WVRPSCR2",36,0)
 ;
"RTN","WVRPSCR2",37,0)
PRINT N BLANK,DATA
"RTN","WVRPSCR2",38,0)
 S $P(BLANK," ",41)="",CN=7.001
"RTN","WVRPSCR2",39,0)
 S WVJST=0 F M=1,28 S WVJTYP=$S(M=1:"PAPR",1:"MAM") S:M=28 CN=16.001 D
"RTN","WVRPSCR2",40,0)
 .S J="" F  S J=$O(WVPR(WVJTYP,J)) Q:J=""  D
"RTN","WVRPSCR2",41,0)
 ..Q:'$D(WVPR(WVJTYP,J,M))
"RTN","WVRPSCR2",42,0)
 ..N P F Q=1:1:5 S DATA=$G(WVPR(WVJTYP,J,M,Q)) D
"RTN","WVRPSCR2",43,0)
 ...S P(1)=$P(DATA,U),P(2)=$P(DATA,U,2)*100 S:P(1)="" P(1)=0
"RTN","WVRPSCR2",44,0)
 ...S P("NO")=$G(P("NO"))_$E(BLANK,1,6-$L(P(1)))_P(1)
"RTN","WVRPSCR2",45,0)
 ...S P("PCT")=$G(P("PCT"))_$E(BLANK,1,5-$L(P(2)))_P(2)_"%"
"RTN","WVRPSCR2",46,0)
 ..S ^TMP("WV",$J,CN,0)=" "_J_$E(BLANK,1,36-$L(J))_"# of Women "_P("NO")
"RTN","WVRPSCR2",47,0)
 ..S CN=CN+.001
"RTN","WVRPSCR2",48,0)
 ..S ^TMP("WV",$J,CN,0)=$E(BLANK,1,37)_"% of Women "_P("PCT")
"RTN","WVRPSCR2",49,0)
 ..S CN=CN+.001
"RTN","WVRPSCR2",50,0)
 ..S ^TMP("WV",$J,CN,0)=""
"RTN","WVRPSCR2",51,0)
 ..S CN=CN+.001
"RTN","WVRPSCR2",52,0)
 Q
"RTN","WVRPSCR2",53,0)
HDR ;
"RTN","WVRPSCR2",54,0)
 ;W !!?14,$S($E(N)=7:"PAPS",1:"MAMS")," SCREENING COMPLIANCE BY PAP REGIMEN"
"RTN","WVRPSCR2",55,0)
 ;W !?13,"------------------------------------------"
"RTN","WVRPSCR2",56,0)
 Q:N>7.9&(N'>16)
"RTN","WVRPSCR2",57,0)
 S WVJHDR=$S(N<8:"PAP REGIMEN",N>16:"AGE GROUPS ",1:"           ")
"RTN","WVRPSCR2",58,0)
 W !!," ",WVJHDR,"                                       1     2     3     4     5+"
"RTN","WVRPSCR2",59,0)
 W !," -----------                                     ----- ----- ----- ----- -----"
"RTN","WVRPSNP")
0^49^B38798701
"RTN","WVRPSNP",1,0)
WVRPSNP ;HCIOFO/FT,JR IHS/ANMC/MWR - REPORT: SNAPSHOT OF PROGRAM  ;8/4/98  16:23
"RTN","WVRPSNP",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPSNP",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSNP",4,0)
 ;;  CALLED BY OPTION: "WV PRINT SNAPSHOT" TO DISPLAY FROM 1/1 CURRENT
"RTN","WVRPSNP",5,0)
 ;;  YEAR TO PRESENT #PATIENTS, #PAPS, #MAMS, #DELINQUENT NEEDS, ETC.
"RTN","WVRPSNP",6,0)
 ;
"RTN","WVRPSNP",7,0)
 D SETVARS^WVUTL5 S WVFAC=DUZ(2) K ^TMP("WVF",$J)
"RTN","WVRPSNP",8,0)
 N A,B,C,D,E,F,G,H,I,J,K,L,M,N,P,Q,R,S,X,Y,WA,WB,WC,WE,WF,WG,WH,WX,N0
"RTN","WVRPSNP",9,0)
 D TITLE^WVUTL5("PROGRAM SNAPSHOT")
"RTN","WVRPSNP",10,0)
 D ASKTOY G:WVPOP EXIT
"RTN","WVRPSNP",11,0)
 D ASKSAVE G:WVPOP EXIT
"RTN","WVRPSNP",12,0)
 D DEVICE  G:WVPOP EXIT
"RTN","WVRPSNP",13,0)
 D GATHER
"RTN","WVRPSNP",14,0)
 D:WVA STORE
"RTN","WVRPSNP",15,0)
 K WVDTIEN
"RTN","WVRPSNP",16,0)
 D ^WVRPSNP1
"RTN","WVRPSNP",17,0)
 ;
"RTN","WVRPSNP",18,0)
EXIT ;EP
"RTN","WVRPSNP",19,0)
 D KILLALL^WVUTL8
"RTN","WVRPSNP",20,0)
 K ^TMP("WVF",$J)
"RTN","WVRPSNP",21,0)
 Q
"RTN","WVRPSNP",22,0)
 ;
"RTN","WVRPSNP",23,0)
ASKTOY ;
"RTN","WVRPSNP",24,0)
 S WVTOY="" S DIR("A")="   Report by (C)alendar or (F)iscal year? "
"RTN","WVRPSNP",25,0)
 S DIR(0)="SAO^C:Calendar Year;F:Fiscal Year",DIR("B")="Fiscal"
"RTN","WVRPSNP",26,0)
 D ^DIR
"RTN","WVRPSNP",27,0)
 I "FC"'[Y S WVPOP=1 Q
"RTN","WVRPSNP",28,0)
 S WVTOY=Y
"RTN","WVRPSNP",29,0)
 S WVJDT=$E(DT,1,3)_"0000"
"RTN","WVRPSNP",30,0)
 I WVTOY="F" I $E(DT,4,5)<10 S WVJDT=$E(DT-10000,1,3)_"1000"
"RTN","WVRPSNP",31,0)
 Q
"RTN","WVRPSNP",32,0)
DEVICE ;EP
"RTN","WVRPSNP",33,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVRPSNP",34,0)
 S ZTRTN="DEQUEUE^WVRPSNP"
"RTN","WVRPSNP",35,0)
 F WVSV="A","FAC","TOY","JDT" D
"RTN","WVRPSNP",36,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVRPSNP",37,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVRPSNP",38,0)
 Q
"RTN","WVRPSNP",39,0)
 ;
"RTN","WVRPSNP",40,0)
ASKSAVE ;EP
"RTN","WVRPSNP",41,0)
 ;---> ASK IF THIS REPORT SHOULD BE SAVED FOR LATER RETRIEVAL.
"RTN","WVRPSNP",42,0)
 N DIR,DIRUT,Y
"RTN","WVRPSNP",43,0)
 W !!?3,"Should today's Snapshot be stored for later retrieval and"
"RTN","WVRPSNP",44,0)
 W " comparisons?"
"RTN","WVRPSNP",45,0)
 S DIR(0)="Y",DIR("A")="   Enter Yes or No",DIR("B")="NO"
"RTN","WVRPSNP",46,0)
 S WVA=0 D HELP1
"RTN","WVRPSNP",47,0)
 D ^DIR K DIR W !
"RTN","WVRPSNP",48,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVRPSNP",49,0)
 S:Y WVA=1
"RTN","WVRPSNP",50,0)
 Q
"RTN","WVRPSNP",51,0)
 ;
"RTN","WVRPSNP",52,0)
DEQUEUE ;EP
"RTN","WVRPSNP",53,0)
 ;---> QUEUED REPORT
"RTN","WVRPSNP",54,0)
 N A,B,C,D,E,F,G,H,J,K,L,M,N,P,Q,R,S,X,Y
"RTN","WVRPSNP",55,0)
 D SETVARS^WVUTL5,GATHER,STORE,^WVRPSNP1,EXIT
"RTN","WVRPSNP",56,0)
 Q
"RTN","WVRPSNP",57,0)
 ;
"RTN","WVRPSNP",58,0)
STORE ;EP
"RTN","WVRPSNP",59,0)
 ;---> STORE REPORT DATA IN FILE #790.71.
"RTN","WVRPSNP",60,0)
 Q:'WVA
"RTN","WVRPSNP",61,0)
 N WVDR,DA,DIC,DIE,X,Y
"RTN","WVRPSNP",62,0)
 S WVDR=".02////"_WVFAC,Y=.02
"RTN","WVRPSNP",63,0)
 F WVI=A,B,C,D,E,F,G,H,S,J,K,L,P,Q,R D
"RTN","WVRPSNP",64,0)
 .S Y=Y+.01,WVDR=WVDR_";"_Y_"////"_WVI
"RTN","WVRPSNP",65,0)
 S Y=.5,WVJDR=".5////"_WVI(1)
"RTN","WVRPSNP",66,0)
 F WVJ=2:1:27 S Y=Y+.01 S WVJDR=WVJDR_";"_Y_"////"_WVI(WVJ)
"RTN","WVRPSNP",67,0)
 S WVDR=WVDR_";.18////"_WVTOY
"RTN","WVRPSNP",68,0)
 N A,B,C,D,E,F,G,H,S,J,K,L,P,Q,R D
"RTN","WVRPSNP",69,0)
 .S A=0,WVJNDA="" F  S A=$O(^WV(790.71,"B",DT,A)) Q:A'>0  D  Q:WVJNDA>0
"RTN","WVRPSNP",70,0)
 ..S:$D(^WV(790.71,"T",WVTOY,A)) WVJNDA=A
"RTN","WVRPSNP",71,0)
 .I WVJNDA'>0 D 
"RTN","WVRPSNP",72,0)
 ..K DD,DO S DIC="^WV(790.71,",DIC(0)="ML",X=DT
"RTN","WVRPSNP",73,0)
 ..D FILE^DICN Q:Y<0  S WVJNDA=+Y
"RTN","WVRPSNP",74,0)
 .S Y=$G(WVJNDA) Q:Y'>0
"RTN","WVRPSNP",75,0)
 .D DIE^WVFMAN(790.71,WVDR,WVJNDA)
"RTN","WVRPSNP",76,0)
 .D DIE^WVFMAN(790.71,WVJDR,WVJNDA)
"RTN","WVRPSNP",77,0)
 Q
"RTN","WVRPSNP",78,0)
 ;
"RTN","WVRPSNP",79,0)
 ;
"RTN","WVRPSNP",80,0)
GATHER ;EP
"RTN","WVRPSNP",81,0)
 ;---> GATHER DATA
"RTN","WVRPSNP",82,0)
 S (A,B,C,D,E,F,G,H,J,K,L,M,N,P,Q,R,S)=0
"RTN","WVRPSNP",83,0)
 ;---> USE WVDT SO THAT THE DATE WON'T CHANGE IF RUN SPANS MIDNIGHT.
"RTN","WVRPSNP",84,0)
 D SETVARS^WVUTL5 S WVDT=DT
"RTN","WVRPSNP",85,0)
 ;
"RTN","WVRPSNP",86,0)
 ;---> PATIENT DATA
"RTN","WVRPSNP",87,0)
 F  S N=$O(^WV(790,N)) Q:'N  S Y=^WV(790,N,0) D
"RTN","WVRPSNP",88,0)
 .;---> QUIT IF PATIENT IS NOT ACTIVE.
"RTN","WVRPSNP",89,0)
 .Q:$P(Y,U,24)
"RTN","WVRPSNP",90,0)
 .;---> QUIT IF PATIENT IS DECEASED.
"RTN","WVRPSNP",91,0)
 .Q:$$DECEASED^WVUTL1($P(Y,U))
"RTN","WVRPSNP",92,0)
 .;---> TOTAL WOMEN IN REGISTER.
"RTN","WVRPSNP",93,0)
 .S A=A+1
"RTN","WVRPSNP",94,0)
 .;---> WOMEN PREGNANT.
"RTN","WVRPSNP",95,0)
 .I $P(Y,U,13)&($P(Y,U,14)>WVDT) S B=B+1
"RTN","WVRPSNP",96,0)
 .;---> DES DAUGHTERS.
"RTN","WVRPSNP",97,0)
 .S:$P(Y,U,15) C=C+1
"RTN","WVRPSNP",98,0)
 .;---> WOMEN WITH CERVICAL TX NEEDS NOT SPECIFIED OR NOT DATED.
"RTN","WVRPSNP",99,0)
 .I 5[$P(Y,U,11)!('$P(Y,U,12)) S D=D+1
"RTN","WVRPSNP",100,0)
 .;---> IF DATE DUE=NULL IT WAS COUNTED LINE ABOVE, SO DON'T COUNT
"RTN","WVRPSNP",101,0)
 .;---> IT IN THE LINE BELOW: +$P(Y,U,19).
"RTN","WVRPSNP",102,0)
 .;---> WOMEN WITH CERVICAL TX NEEDS SPECIFIED AND PAST DUE.
"RTN","WVRPSNP",103,0)
 .I 5'[$P(Y,U,11)&($P(Y,U,12)<WVDT)&(+$P(Y,U,12)) S E=E+1
"RTN","WVRPSNP",104,0)
 .;---> WOMEN WITH BREAST TX NEEDS NOT SPECIFIED OR NOT DATED.
"RTN","WVRPSNP",105,0)
 .I 8[$P(Y,U,18)!('$P(Y,U,19)) S F=F+1
"RTN","WVRPSNP",106,0)
 .;---> WOMEN WITH BREAST TX NEEDS SPECIFIED AND PAST DUE.
"RTN","WVRPSNP",107,0)
 .I 8'[$P(Y,U,18)&($P(Y,U,19)<WVDT)&(+$P(Y,U,19)) S G=G+1
"RTN","WVRPSNP",108,0)
 ;
"RTN","WVRPSNP",109,0)
 ;---> PROCEDURE DATA
"RTN","WVRPSNP",110,0)
 S N=0
"RTN","WVRPSNP",111,0)
 F  S N=$O(^WV(790.1,"S","o",N)) Q:'N  S Y=^WV(790.1,N,0) D
"RTN","WVRPSNP",112,0)
 .Q:"o"'[$P(Y,U,14)
"RTN","WVRPSNP",113,0)
 .Q:$P(Y,U,5)=8
"RTN","WVRPSNP",114,0)
 .S H=H+1 S:$P(Y,U,13)<WVDT S=S+1
"RTN","WVRPSNP",115,0)
 ;
"RTN","WVRPSNP",116,0)
 ;---> TOTAL PAPS, CBES, AND MAMS FOR THIS YEAR (SINCE JAN 1, OR FISCAL).
"RTN","WVRPSNP",117,0)
 S N=WVJDT,WVENDDT1=WVDT+.9999
"RTN","WVRPSNP",118,0)
 F  S N=$O(^WV(790.1,"D",N)) Q:'N!(N>WVENDDT1)  D
"RTN","WVRPSNP",119,0)
 .S M=0
"RTN","WVRPSNP",120,0)
 .F  S M=$O(^WV(790.1,"D",N,M)) Q:'M  S Y=^WV(790.1,M,0) D
"RTN","WVRPSNP",121,0)
 ..;---> BELOW IS HARD CODED FOR IENS IN ^WV(790.2, (PAP, CBE, OR MAM) AND
"RTN","WVRPSNP",122,0)
 ..;---> ^WV(790.31, (ERROR/DISREGARD).  COULD BE MORE ROBUST BY LOOKING
"RTN","WVRPSNP",123,0)
 ..;---> AT #.10 FIELD OF ^WV(790.2 AND #.23 FIELD OF ^WV(790.31,.
"RTN","WVRPSNP",124,0)
 ..Q:$P(Y,U,5)=8
"RTN","WVRPSNP",125,0)
 ..I $P(Y,U,4)=1 S P=P+1 Q                                    ;---> PAP
"RTN","WVRPSNP",126,0)
 ..I $P(Y,U,4)=25!($P(Y,U,4)=26)!($P(Y,U,4)=28) S Q=Q+1 Q     ;---> MAM
"RTN","WVRPSNP",127,0)
 ..I $P(Y,U,4)=27 S R=R+1                                     ;---> CBE
"RTN","WVRPSNP",128,0)
 ;
"RTN","WVRPSNP",129,0)
 ;---> NOTIFICATION DATA
"RTN","WVRPSNP",130,0)
 S N=0
"RTN","WVRPSNP",131,0)
 F  S N=$O(^WV(790.4,"AOPEN",N)) Q:'N  D
"RTN","WVRPSNP",132,0)
 .S M=0
"RTN","WVRPSNP",133,0)
 .F  S M=$O(^WV(790.4,"AOPEN",N,M)) Q:'M  D
"RTN","WVRPSNP",134,0)
 ..I '$D(^WV(790.4,M,0)) K ^WV(790.4,"AOPEN",N,M) Q
"RTN","WVRPSNP",135,0)
 ..S Y=^WV(790.4,M,0)
"RTN","WVRPSNP",136,0)
 ..S:$P(Y,U,14)="o" J=J+1
"RTN","WVRPSNP",137,0)
 ..S:$P(Y,U,14)="o"&($P(Y,U,13)<WVDT) K=K+1
"RTN","WVRPSNP",138,0)
 ;---> LETTERS QUEUED
"RTN","WVRPSNP",139,0)
 S N=0 F  S N=$O(^WV(790.4,"APRT",N)) Q:'N  D
"RTN","WVRPSNP",140,0)
 .S M=0 F  S M=$O(^WV(790.4,"APRT",N,M)) Q:'M  S L=L+1
"RTN","WVRPSNP",141,0)
R ;---> TREATMENT REFUSALS
"RTN","WVRPSNP",142,0)
 K ^TMP("WVREF",$J)
"RTN","WVRPSNP",143,0)
 S WA=0 F  S WA=$O(^WV(790.2,WA)) Q:WA'>0  D
"RTN","WVRPSNP",144,0)
 .S WB=$P($G(^(WA,0)),U),^TMP("WVREF",$J,WB)=0
"RTN","WVRPSNP",145,0)
 S WA=WVJDT F  S WA=$O(^WV(790.3,"B",WA)) Q:WA'>0  D
"RTN","WVRPSNP",146,0)
 .S WB=0 F  S WB=$O(^WV(790.3,"B",WA,WB)) Q:WB'>0  D
"RTN","WVRPSNP",147,0)
 ..S N0=$G(^WV(790.3,WB,0))
"RTN","WVRPSNP",148,0)
 ..K P F P=1,2,3,4 S P(P)=$P(N0,U,P) S:P(P)="" P(P)="NOT ENTERED"
"RTN","WVRPSNP",149,0)
 ..S:P(3)>0 P(3)=$P($G(^WV(790.2,P(3),0)),U)
"RTN","WVRPSNP",150,0)
 ..S ^TMP("WVREF",$J,P(3))=(^TMP("WVREF",$J,P(3))+1)
"RTN","WVRPSNP",151,0)
 S WVCN=1,WVJ="" F  S WVJ=$O(^TMP("WVREF",$J,WVJ)) Q:WVJ=""  D
"RTN","WVRPSNP",152,0)
 .S WVI(WVCN)=$G(^TMP("WVREF",$J,WVJ)),WVCN=WVCN+1
"RTN","WVRPSNP",153,0)
 K ^TMP("WVREF",$J) Q
"RTN","WVRPSNP",154,0)
 ;
"RTN","WVRPSNP",155,0)
 ;
"RTN","WVRPSNP",156,0)
HELP1 ;EP
"RTN","WVRPSNP",157,0)
 ;;Answer "YES" to store the results of today's snapshot after they
"RTN","WVRPSNP",158,0)
 ;;have been printed out.  These results can then be retrieved in the
"RTN","WVRPSNP",159,0)
 ;;future (by calling up today's date) and compared to other Snapshots
"RTN","WVRPSNP",160,0)
 ;;in order to look at the trends and progress of your program over
"RTN","WVRPSNP",161,0)
 ;;time. (Note: If a previous snapshot for today has been run, it will
"RTN","WVRPSNP",162,0)
 ;;be overwritten by this or any later run today.)
"RTN","WVRPSNP",163,0)
 ;;
"RTN","WVRPSNP",164,0)
 ;;Answer "NO" to simply print today's Snapshot without storing it.
"RTN","WVRPSNP",165,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVRPSNP",166,0)
 Q
"RTN","WVRPSNP",167,0)
 ;
"RTN","WVRPSNP",168,0)
HELPTX ;EP
"RTN","WVRPSNP",169,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPSNP",170,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVRPSNP",171,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVRPSNP",172,0)
 Q
"RTN","WVRPSNP1")
0^50^B20919517
"RTN","WVRPSNP1",1,0)
WVRPSNP1 ;HCIOFO/FT,JR IHS/ANMC/MWR - REPORT: SNAPSHOT OF PROGRAM ;7/30/98  11:58
"RTN","WVRPSNP1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPSNP1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSNP1",4,0)
 ;;  DISPLAY CODE FOR SNAPSHOT REPORT.  CALLED BY WVRPSNP.
"RTN","WVRPSNP1",5,0)
 ;
"RTN","WVRPSNP1",6,0)
 ;---> REQUIRED VARIABLES: WVDT=DATE SNAPSHOT WAS RUN.
"RTN","WVRPSNP1",7,0)
 ;--->                     WVFAC=FACILITY IEN IN ^DIC(4 - DUZ(2)
"RTN","WVRPSNP1",8,0)
 ;--->                     A-L,P,Q = FIELDS #.03-#.16 IN FILE 790.71
"RTN","WVRPSNP1",9,0)
 ;
"RTN","WVRPSNP1",10,0)
DISPLAY ;EP
"RTN","WVRPSNP1",11,0)
 U IO
"RTN","WVRPSNP1",12,0)
 S WVTOY=$S($D(WVTOY):WVTOY,1:M),WVPOP=0
"RTN","WVRPSNP1",13,0)
 I '$D(WVJDT) S WVJDT=$S(WVTOY="C":WVDT,$E(WVDT,4,5)>9:WVDT,1:WVDT-10000)
"RTN","WVRPSNP1",14,0)
 S WVJDTO=$S($G(WVTOY)="F":"Oct 1, ",1:"Jan 1, ")_($E($S($D(WVJDT):WVJDT,1:WVDT),1,3)+1700)_":"
"RTN","WVRPSNP1",15,0)
 S WVJTOY=$S(WVTOY="F":"Fiscal Year",1:"Calendar Year")
"RTN","WVRPSNP1",16,0)
 D HDR
"RTN","WVRPSNP1",17,0)
 ;
"RTN","WVRPSNP1",18,0)
 N X,Y
"RTN","WVRPSNP1",19,0)
 W !
"RTN","WVRPSNP1",20,0)
 S X="Total Active Women in Register:",Y=A D PNUM
"RTN","WVRPSNP1",21,0)
 S X="Women Who Are Pregnant:",Y=B D PNUM
"RTN","WVRPSNP1",22,0)
 ;S X="Woman Who Are DES Daughters:",Y=C D PNUM
"RTN","WVRPSNP1",23,0)
 S X="Women with Cervical Tx Needs not specified or not dated:",Y=D
"RTN","WVRPSNP1",24,0)
 D PNUM
"RTN","WVRPSNP1",25,0)
 S X="Women with Cervical Tx Needs specified and past due:",Y=E D PNUM
"RTN","WVRPSNP1",26,0)
 S X="Women with Breast Tx Needs not specified or not dated:",Y=F D PNUM
"RTN","WVRPSNP1",27,0)
 S X="Women with Breast Tx Needs specified and past due:",Y=G D PNUM
"RTN","WVRPSNP1",28,0)
 W !
"RTN","WVRPSNP1",29,0)
 S X="Total Number of Procedures with a Status of ""OPEN"":",Y=H D DOTS
"RTN","WVRPSNP1",30,0)
 S X="Number of OPEN Procedures Past Due (or not dated):",Y=S D DOTS
"RTN","WVRPSNP1",31,0)
 W:'WVCRT !
"RTN","WVRPSNP1",32,0)
 S X="Total Number of PAP Smears done since "_WVJDTO
"RTN","WVRPSNP1",33,0)
 S Y=P D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",34,0)
 S X="Total Number of CBEs done since "_WVJDTO
"RTN","WVRPSNP1",35,0)
 S Y=R D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",36,0)
 S X="Total Number of Mammograms done since "_WVJDTO
"RTN","WVRPSNP1",37,0)
 S Y=Q D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",38,0)
 W !
"RTN","WVRPSNP1",39,0)
 S X="Total Number of Notifications with a Status of ""OPEN"":",Y=J
"RTN","WVRPSNP1",40,0)
 D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",41,0)
 S X="Number of OPEN Notifications Past Due (or not dated):",Y=K D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",42,0)
 S X="Number of Letters Queued (for later printing):",Y=L D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",43,0)
 I $G(WVDTIEN)>0 S WVJX=$G(^WV(790.71,WVDTIEN,2)) D
"RTN","WVRPSNP1",44,0)
 .F P=1:1:27 S WVI(P)=$P(WVJX,U,P)
"RTN","WVRPSNP1",45,0)
 W !!,"   REFUSALS for TREATMENT:"
"RTN","WVRPSNP1",46,0)
 S X="Breast Ultrasounds:",Y=WVI(1) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",47,0)
 S X="Clinical Breast Exams:",Y=WVI(2) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",48,0)
 S X="Colposcopy Impression (No Bx):",Y=WVI(3) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",49,0)
 S X="Colposcopy W/Biopsy:",Y=WVI(4) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",50,0)
 S X="Cone Biopsy:",Y=WVI(5) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",51,0)
 S X="Cryotherapy:",Y=WVI(6) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",52,0)
 S X="Ectocervical Biopsy:",Y=WVI(7) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",53,0)
 S X="Endocervical Currettage:",Y=WVI(8) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",54,0)
 S X="Endometrial Biopsy:",Y=WVI(9) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",55,0)
 S X="Fine Needle Aspiration:",Y=WVI(10) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",56,0)
 S X="General Surgery Consults:",Y=WVI(11) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",57,0)
 S X="Gyn Onc Consults:",Y=WVI(12) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",58,0)
 S X="Hysterectomy:",Y=WVI(13) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",59,0)
 S X="Laser Abilation:",Y=WVI(14) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",60,0)
 S X="Laser Cone:",Y=WVI(15) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",61,0)
 S X="Leep:",Y=WVI(16) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",62,0)
 S X="Lumpectomy:",Y=WVI(17) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",63,0)
 S X="Mammogram Dx Bilat:",Y=WVI(18) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",64,0)
 S X="Mammogram Dx Unilat:",Y=WVI(19) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",65,0)
 S X="Mammogram Screening:",Y=WVI(20) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",66,0)
 S X="Mastectomy:",Y=WVI(21) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",67,0)
 S X="Needle Biopsy:",Y=WVI(22) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",68,0)
 S X="Open Biopsy:",Y=WVI(23) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",69,0)
 S X="Pap Smear:",Y=WVI(24) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",70,0)
 S X="Pregnancy Test:",Y=WVI(25) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",71,0)
 S X="STD Evaluation:",Y=WVI(26) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",72,0)
 S X="Stereotactic Biopsy:",Y=WVI(27) D DOTS G:WVPOP=1 EXIT
"RTN","WVRPSNP1",73,0)
SKIP D:'WVCRT
"RTN","WVRPSNP1",74,0)
 .N WVTITLE S WVTITLE="-----  End of Report  -----"
"RTN","WVRPSNP1",75,0)
 .D CENTERT^WVUTL5(.WVTITLE) W !!!,WVTITLE
"RTN","WVRPSNP1",76,0)
 I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVRPSNP1",77,0)
 D ^%ZISC
"RTN","WVRPSNP1",78,0)
 Q
"RTN","WVRPSNP1",79,0)
 ;
"RTN","WVRPSNP1",80,0)
PNUM ;EP
"RTN","WVRPSNP1",81,0)
 ;---> PATIENT NUMBERS
"RTN","WVRPSNP1",82,0)
 W:'WVCRT ! W !?3,X W $$REPEAT^XLFSTR(" .",(58-$L(X))/2)
"RTN","WVRPSNP1",83,0)
 W ?61,".",?62,$J(Y,5) W:A>0 ?69,$J(Y/A*100,3,0),"%"
"RTN","WVRPSNP1",84,0)
 Q
"RTN","WVRPSNP1",85,0)
 ;
"RTN","WVRPSNP1",86,0)
DOTS ;EP
"RTN","WVRPSNP1",87,0)
 I $Y+4>IOSL D:WVCRT&('$D(IO("S"))) DIRZ^WVUTL3 Q:$G(WVPOP)=1  D HDR
"RTN","WVRPSNP1",88,0)
 W:'WVCRT ! W !?3,X W $$REPEAT^XLFSTR(" .",(58-$L(X))/2)
"RTN","WVRPSNP1",89,0)
 W ?61,".",?62,$J(Y,5)
"RTN","WVRPSNP1",90,0)
 Q
"RTN","WVRPSNP1",91,0)
HDR ;EP
"RTN","WVRPSNP1",92,0)
 S WVTITLE="* * *  PROGRAM SNAPSHOT FOR "_$$TXDT^WVUTL5(WVDT)_"  * * *"
"RTN","WVRPSNP1",93,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVRPSNP1",94,0)
 D TOPHEAD1^WVUTL7,HEADER6^WVUTL7
"RTN","WVRPSNP1",95,0)
 Q
"RTN","WVRPSNP1",96,0)
CH ;
"RTN","WVRPSNP1",97,0)
 Q:$Y+4<IOSL
"RTN","WVRPSNP1",98,0)
 I WVCRT&('$D(IO("S"))) D DIRZ^WVUTL3 W @IOF
"RTN","WVRPSNP1",99,0)
 Q:WVPOP  D HDR
"RTN","WVRPSNP1",100,0)
 Q
"RTN","WVRPSNP1",101,0)
EXIT ;
"RTN","WVRPSNP1",102,0)
 D ^%ZISC,KILLALL^WVUTL8 Q
"RTN","WVRPSNP1",103,0)
 K ^TMP("WVF",$J),^TMP("WVREF",$J)
"RTN","WVRPSNPR")
0^51^B3253058
"RTN","WVRPSNPR",1,0)
WVRPSNPR ;HCIOFO/FT,JR IHS/ANMC/MWR - REPORT: RETRIEVE A SNAPSHOT;
"RTN","WVRPSNPR",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPSNPR",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPSNPR",4,0)
 ;;  CALLED BY OPTION: "WV PRINT/RETRIEVE SNAPSHOT" TO DISPLAY A
"RTN","WVRPSNPR",5,0)
 ;;  PREVIOUS SNAPSHOT.
"RTN","WVRPSNPR",6,0)
 ;
"RTN","WVRPSNPR",7,0)
 D SETVARS^WVUTL5 S WVPOP=0,WVFAC=DUZ(2) K ^TMP("WVF",$J)
"RTN","WVRPSNPR",8,0)
 N A,B,C,D,E,F,G,H,J,K,L,M,N,P,Q,R,S,X,Y
"RTN","WVRPSNPR",9,0)
 D TITLE^WVUTL5("RETRIEVE A PROGRAM SNAPSHOT")
"RTN","WVRPSNPR",10,0)
 D RETRIEVE G:WVPOP EXIT
"RTN","WVRPSNPR",11,0)
 D DEVICE   G:WVPOP EXIT
"RTN","WVRPSNPR",12,0)
 D LOADVARS
"RTN","WVRPSNPR",13,0)
 D ^WVRPSNP1
"RTN","WVRPSNPR",14,0)
 ;
"RTN","WVRPSNPR",15,0)
EXIT ;EP
"RTN","WVRPSNPR",16,0)
 D KILLALL^WVUTL8
"RTN","WVRPSNPR",17,0)
 Q
"RTN","WVRPSNPR",18,0)
 ;
"RTN","WVRPSNPR",19,0)
 ;
"RTN","WVRPSNPR",20,0)
RETRIEVE ;EP
"RTN","WVRPSNPR",21,0)
 ;---> RETRIEVE A SNAPSHOT
"RTN","WVRPSNPR",22,0)
 N DIC,Y
"RTN","WVRPSNPR",23,0)
 W !!?3,"Select the Snapshot you wish to display or print."
"RTN","WVRPSNPR",24,0)
 D DIC^WVFMAN(790.71,"QEMA",.Y,"   Select Snapshot: ")
"RTN","WVRPSNPR",25,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVRPSNPR",26,0)
 S WVDTIEN=+Y
"RTN","WVRPSNPR",27,0)
 Q
"RTN","WVRPSNPR",28,0)
 ;
"RTN","WVRPSNPR",29,0)
DEVICE ;EP
"RTN","WVRPSNPR",30,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVRPSNPR",31,0)
 S ZTRTN="DEQUEUE^WVRPSNPR"
"RTN","WVRPSNPR",32,0)
 F WVSV="DT","DTIEN" D
"RTN","WVRPSNPR",33,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVRPSNPR",34,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVRPSNPR",35,0)
 Q
"RTN","WVRPSNPR",36,0)
 ;
"RTN","WVRPSNPR",37,0)
DEQUEUE ;EP
"RTN","WVRPSNPR",38,0)
 ;---> QUEUED REPORT
"RTN","WVRPSNPR",39,0)
 N A,B,C,D,E,F,G,H,J,K,L,M,N,P,Q,R,S,X,Y
"RTN","WVRPSNPR",40,0)
 D SETVARS^WVUTL5,LOADVARS,^WVRPSNP1,EXIT
"RTN","WVRPSNPR",41,0)
 Q
"RTN","WVRPSNPR",42,0)
 ;
"RTN","WVRPSNPR",43,0)
LOADVARS ;EP
"RTN","WVRPSNPR",44,0)
 S Y=^WV(790.71,WVDTIEN,0)
"RTN","WVRPSNPR",45,0)
 S WVDT=+Y
"RTN","WVRPSNPR",46,0)
 S WVFAC=$P(Y,U,2),A=$P(Y,U,3),B=$P(Y,U,4),C=$P(Y,U,5),D=$P(Y,U,6)
"RTN","WVRPSNPR",47,0)
 S E=$P(Y,U,7),F=$P(Y,U,8),G=$P(Y,U,9),H=$P(Y,U,10),S=$P(Y,U,11)
"RTN","WVRPSNPR",48,0)
 S J=$P(Y,U,12),K=$P(Y,U,13),L=$P(Y,U,14),P=$P(Y,U,15),Q=$P(Y,U,16)
"RTN","WVRPSNPR",49,0)
 S R=$P(Y,U,17),M=$P(Y,U,18)
"RTN","WVRPSNPR",50,0)
 Q
"RTN","WVRPST")
0^64^B14952893
"RTN","WVRPST",1,0)
WVRPST ;HCIOFO/JR - Sexual Trauma Summary ;9/3/98  11:09
"RTN","WVRPST",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVRPST",3,0)
 ;
"RTN","WVRPST",4,0)
 W @IOF,!?33,"WOMEN'S HEALTH"
"RTN","WVRPST",5,0)
 W !?19,"* * *  SEXUAL TRAUMA SUMMARY REPORT  * * *",!
"RTN","WVRPST",6,0)
 K IO("Q") S %ZIS="Q" D ^%ZIS G EXIT:POP I $D(IO("Q")) D  Q
"RTN","WVRPST",7,0)
 .S ZTRTN="GET^WVRPST",ZTDESC="WH SEXUAL TRAUMA SUMMARY"
"RTN","WVRPST",8,0)
 .D ^%ZTLOAD D HOME^%ZIS K IO("Q")
"RTN","WVRPST",9,0)
GET ;get data for rpt
"RTN","WVRPST",10,0)
 U IO
"RTN","WVRPST",11,0)
 N DATA
"RTN","WVRPST",12,0)
 S (WVDFN,WVCNT,WVMV,WVM,WVCV,WVETCN,WVCIVCN,WVC,WVB,WVBV,WVCNALL)=0
"RTN","WVRPST",13,0)
 F  S WVDFN=$O(^WV(790,WVDFN)) Q:WVDFN'>0  S WV0=$G(^(WVDFN,0)) D
"RTN","WVRPST",14,0)
 .S WVST=$P(WV0,U,27)
"RTN","WVRPST",15,0)
 .I '$$NOT(WVDFN) Q
"RTN","WVRPST",16,0)
 .S WVCNALL=WVCNALL+1
"RTN","WVRPST",17,0)
 .S WVET=$S($$GET1^DIQ(2,WVDFN,1901,"I")="Y":"V",1:"")
"RTN","WVRPST",18,0)
 .S:WVET="V" WVETCN=WVETCN+1 S:WVET'="V" WVCIVCN=WVCIVCN+1
"RTN","WVRPST",19,0)
 .Q:WVST=""  S WVCNT=WVCNT+1
"RTN","WVRPST",20,0)
 .S DATA="WV"_WVST_WVET
"RTN","WVRPST",21,0)
 .S @DATA=@DATA+1
"RTN","WVRPST",22,0)
 S WVMALL=WVM+WVMV,WVCALL=WVC+WVCV,WVBALL=WVB+WVBV
"RTN","WVRPST",23,0)
 S WVALL=WVMALL+WVCALL+WVBALL
"RTN","WVRPST",24,0)
 S WVVALL=WVMV+WVCV+WVBV,WVNALL=WVC+WVB+WVM
"RTN","WVRPST",25,0)
 D PRINT
"RTN","WVRPST",26,0)
EXIT ;
"RTN","WVRPST",27,0)
 D ^%ZISC
"RTN","WVRPST",28,0)
 D KILLALL^WVUTL8
"RTN","WVRPST",29,0)
 Q
"RTN","WVRPST",30,0)
PRINT ;Print with %'s based on total WH pats
"RTN","WVRPST",31,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVRPST",32,0)
 D HEAD
"RTN","WVRPST",33,0)
 W !!?3,"Military Trauma",?24,$J(WVMV,5),?31,$$PER(WVMV,WVCNALL)
"RTN","WVRPST",34,0)
 W ?41,$J(WVM,6),?49,$$PER(WVM,WVCNT)
"RTN","WVRPST",35,0)
 W ?59,$J(WVMALL,5),?66,$$PER(WVMALL,WVCNALL)
"RTN","WVRPST",36,0)
 W !!?3,"Civilian Trauma",?24,$J(WVCV,5),?31,$$PER(WVCV,WVCNALL)
"RTN","WVRPST",37,0)
 W ?41,$J(WVC,6),?49,$$PER(WVC,WVCNALL)
"RTN","WVRPST",38,0)
 W ?59,$J(WVCALL,5),?66,$$PER(WVCALL,WVCNALL)
"RTN","WVRPST",39,0)
 W !!?3,"Both",?24,$J(WVBV,5),?31,$$PER(WVBV,WVCNALL)
"RTN","WVRPST",40,0)
 W ?41,$J(WVB,6),?49,$$PER(WVB,WVCNALL)
"RTN","WVRPST",41,0)
 W ?59,$J(WVBALL,5),?66,$$PER(WVBALL,WVCNALL)
"RTN","WVRPST",42,0)
 W !!?2,$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",43,0)
 W !,?3,"TOTALS",?24,$J(WVVALL,5),?31,$$PER(WVVALL,WVCNALL)
"RTN","WVRPST",44,0)
 W ?41,$J(WVNALL,6),?49,$$PER(WVNALL,WVCNALL)
"RTN","WVRPST",45,0)
 W ?59,$J(WVALL,5),?66,$$PER(WVALL,WVCNALL)
"RTN","WVRPST",46,0)
 W !,"  ",$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",47,0)
 W !?5," TOTAL WH PATIENTS ------->",$J(WVCNALL,5)
"RTN","WVRPST",48,0)
 W !?5,"TOTAL VETERAN PATIENTS --->",$J(WVETCN,5)
"RTN","WVRPST",49,0)
 W !?5,"TOTAL NON-VET PATIENTS --->",$J(WVCIVCN,5)
"RTN","WVRPST",50,0)
 W !!?12,"Above percentages are based on Total Active Women patients"
"RTN","WVRPST",51,0)
 W !?22,"in the Women's Health Database."
"RTN","WVRPST",52,0)
 S WVPOP=0
"RTN","WVRPST",53,0)
 I WVCRT&('$D(IO("S")))&('POP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVRPST",54,0)
 Q
"RTN","WVRPST",55,0)
MORE ;Print with %'s based on type of patient (vet! non-vet)
"RTN","WVRPST",56,0)
 D HEAD
"RTN","WVRPST",57,0)
 W !!?3,"Military Trauma",?24,$J(WVMV,5),?31,$$PER(WVMV,WVETCN)
"RTN","WVRPST",58,0)
 W ?41,$J(WVM,6),?49,$$PER(WVM,WVCNT)
"RTN","WVRPST",59,0)
 W !!?3,"Civilian Trauma",?24,$J(WVCV,5),?31,$$PER(WVCV,WVETCN)
"RTN","WVRPST",60,0)
 W ?41,$J(WVC,6),?49,$$PER(WVC,WVCIVCN)
"RTN","WVRPST",61,0)
 W !!?3,"Both",?24,$J(WVBV,5),?31,$$PER(WVBV,WVETCN)
"RTN","WVRPST",62,0)
 W ?41,$J(WVB,6),?49,$$PER(WVB,WVCIVCN)
"RTN","WVRPST",63,0)
 W !!?2,$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",64,0)
 W !,?3,"TOTALS",?24,$J(WVVALL,5),?31,$$PER(WVVALL,WVETCN)
"RTN","WVRPST",65,0)
 W ?41,$J(WVNALL,6),?49,$$PER(WVNALL,WVCIVCN)
"RTN","WVRPST",66,0)
 W !,"  ",$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",67,0)
 W !?5," TOTAL WH PATIENTS ------->",$J(WVCNALL,5)
"RTN","WVRPST",68,0)
 W !?5,"TOTAL VETERAN PATIENTS --->",$J(WVETCN,5)
"RTN","WVRPST",69,0)
 W !?5,"TOTAL NON-VET PATIENTS --->",$J(WVCIVCN,5)
"RTN","WVRPST",70,0)
 W !!?12,"Here Vet percentages are based on Total Active Vet patients."
"RTN","WVRPST",71,0)
 W !?11,"Non-Vet percentages are based on Total Active Non-Vet patients."
"RTN","WVRPST",72,0)
 I WVCRT&('$D(IO("S")))&('POP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVRPST",73,0)
 Q
"RTN","WVRPST",74,0)
HEAD ;
"RTN","WVRPST",75,0)
 W:$Y>0 @IOF
"RTN","WVRPST",76,0)
 W !?26,"SEXUAL TRAUMA SUMMARY REPORT",!!
"RTN","WVRPST",77,0)
 W ?3,$$RUNDT^WVUTL1A()
"RTN","WVRPST",78,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVRPST",79,0)
 W !?3,"Sexual Trauma",?27,"Veterans",?43,"Non-Veterans"
"RTN","WVRPST",80,0)
 W ?60,"Vets & Non-Vets"
"RTN","WVRPST",81,0)
 W !,"  ",$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",82,0)
 Q
"RTN","WVRPST",83,0)
NOT(WVDFN) ;Screen out patients for Inactive & Dead
"RTN","WVRPST",84,0)
 N TEST
"RTN","WVRPST",85,0)
 S TEST=$$GET1^DIQ(2,WVDFN,.351,"I")
"RTN","WVRPST",86,0)
 Q:TEST>0 0
"RTN","WVRPST",87,0)
 S TEST=$P($G(^WV(790,WVDFN,0)),U,24)
"RTN","WVRPST",88,0)
 Q:TEST>0 0
"RTN","WVRPST",89,0)
 Q 1
"RTN","WVRPST",90,0)
PER(WVX,WVY) ;
"RTN","WVRPST",91,0)
 Q:WVY'>0!(WVX'>0) "(  0%)"
"RTN","WVRPST",92,0)
 N WVR S WVR=WVX/WVY*100,WVR(1)=$E($P(WVR,".",2)),WVR=$P(WVR,".")
"RTN","WVRPST",93,0)
 S WVR=$S(WVR<1:"."_WVR(1),WVR(1)>4:WVR+1,1:WVR)
"RTN","WVRPST",94,0)
 S WVR="("_$E("   ",1,3-$L(WVR))_WVR_"%)"
"RTN","WVRPST",95,0)
 Q WVR
"RTN","WVSELECT")
0^52^B7638089
"RTN","WVSELECT",1,0)
WVSELECT ;HCIOFO/FT,JR IHS/ANMC/MWR - SELECT ENTRIES FROM A WVFILE ;
"RTN","WVSELECT",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVSELECT",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVSELECT",4,0)
 ;;  UTILITY TO PROMPT FOR MULTIPLE SELECTIONS FROM A FILE AND STORE
"RTN","WVSELECT",5,0)
 ;;  THEM IN A LOCAL ARRAY FOR SOWV BY CALLING PROGRAM.
"RTN","WVSELECT",6,0)
 ;
"RTN","WVSELECT",7,0)
HOSP ;---> EXAMPLE: SELECT HOSPITAL LOCATIONS.
"RTN","WVSELECT",8,0)
 D SETVARS^WVUTL5
"RTN","WVSELECT",9,0)
 ;---> 1ST PARAMETER=CATAGORIC NAME OF ITEMS BEING SELECTED.
"RTN","WVSELECT",10,0)
 ;---> 2ND PARAMETER=FILE NUMBER FROM WHICH SELECTION IS MADE.
"RTN","WVSELECT",11,0)
 ;---> 3RD PARAMETER=LOCAL ARRAY IN WHICH SELECTIONS WILL BE STORED.
"RTN","WVSELECT",12,0)
 ;--->     NOTE: THIS CANNOT BE "WVARR1" OR IT WILL KILL THE VARIBLE,
"RTN","WVSELECT",13,0)
 ;--->           WVARR1, THAT STORES THE LOCAL ARRAY NAME!
"RTN","WVSELECT",14,0)
 ;---> 4TH PARAMETER=SCREEN USED IN SELECTION LOOKUP.
"RTN","WVSELECT",15,0)
 ;---> 5TH PARAMETER=DEFAULT FIRST SELECTION.
"RTN","WVSELECT",16,0)
 ;---> 6TH PARAMETER=WVPOP=1 IF QUIT OR ERROR.
"RTN","WVSELECT",17,0)
 ;---> SCREEN WOULD BE 4TH PARAMETER.
"RTN","WVSELECT",18,0)
 ;S WVSCRN="I $D(^SC(,""ARC"",""S"",Y))"
"RTN","WVSELECT",19,0)
 D SELECT("clinic/ward",44,"WVLOC","","",.WVPOP)
"RTN","WVSELECT",20,0)
 Q
"RTN","WVSELECT",21,0)
 ;
"RTN","WVSELECT",22,0)
SELECT(WVITEM,WVFILE,WVARR1,WVSCRN,WVDFLT,WVPOP) ;EP
"RTN","WVSELECT",23,0)
 N DIC,DIR,WVGBL,WVITEMS,Y
"RTN","WVSELECT",24,0)
 I '$D(WVITEM)!('$G(WVFILE))!('$D(WVARR1)) S WVPOP=1 Q
"RTN","WVSELECT",25,0)
SELECT1 ;
"RTN","WVSELECT",26,0)
 K @WVARR1
"RTN","WVSELECT",27,0)
 S WVGBL=^DIC(WVFILE,0,"GL")
"RTN","WVSELECT",28,0)
 ;---> IF .01 FIELD IS A POINTER, RESET GLOBAL TO GET TEXT FROM
"RTN","WVSELECT",29,0)
 ;---> POINTED TO GLOBAL.
"RTN","WVSELECT",30,0)
 I $E($P(^DD(WVFILE,.01,0),U,2),2)="P" S WVGBL="^"_$P(^(0),U,3)
"RTN","WVSELECT",31,0)
 D PLURAL
"RTN","WVSELECT",32,0)
 W ! S DIR("A")="   Include ALL "_WVITEMS_" in this listing"
"RTN","WVSELECT",33,0)
 S DIR(0)="Y",DIR("B")="Y"
"RTN","WVSELECT",34,0)
 S DIR("?",1)="     Answer ""YES"" to include ALL "_WVITEMS_";"
"RTN","WVSELECT",35,0)
 S DIR("?")="     Answer ""NO"" to select one or more "_WVITEMS_"."
"RTN","WVSELECT",36,0)
 D ^DIR K DIR
"RTN","WVSELECT",37,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVSELECT",38,0)
 ;---> IF ALL ARE SELECTED, QUIT HERE.
"RTN","WVSELECT",39,0)
 I Y S @(WVARR1_"(""ALL"")")="",WVPOP=0 W ! Q
"RTN","WVSELECT",40,0)
 ;
"RTN","WVSELECT",41,0)
 W !!?3,"Select the "_WVITEM_"(s) you wish to include in this listing."
"RTN","WVSELECT",42,0)
 S DIC(0)="QEMA",DIC=WVFILE
"RTN","WVSELECT",43,0)
 S DIC("A")="   Select "_WVITEM_": "
"RTN","WVSELECT",44,0)
 S:$D(WVDFLT) DIC("B")=WVDFLT
"RTN","WVSELECT",45,0)
 S:$D(WVSCRN) DIC("S")=WVSCRN
"RTN","WVSELECT",46,0)
 F  D ^DIC K DIC("B") Q:Y<0  S @(WVARR1_"(+Y)")=""
"RTN","WVSELECT",47,0)
 I '$D(@WVARR1) D  S WVPOP=1 Q
"RTN","WVSELECT",48,0)
 .W !?3,"No ",WVITEM," selected.",! D DIRZ^WVUTL3
"RTN","WVSELECT",49,0)
 W !!?3,"The following ",WVITEMS," will be included in this report:"
"RTN","WVSELECT",50,0)
 W !?3,$$REPEAT^XLFSTR("-",48+$L(WVITEM))
"RTN","WVSELECT",51,0)
 ;W !?3 F I=1:1:48+$L(WVITEM) W "-"
"RTN","WVSELECT",52,0)
 S N=0 F  S N=$O(@(WVARR1_"(N)")) Q:'N  D
"RTN","WVSELECT",53,0)
 .W !?5,$P(@(WVGBL_"N,0)"),U)
"RTN","WVSELECT",54,0)
 .;---> NEXT LINE WOULD BE CODE TO BUILD FOR DISPLAYING AN ADDITIONAL
"RTN","WVSELECT",55,0)
 .;---> PIECE OF THE ZERO NODE OF THE SELECTED ENTRIES (IDENTIFIERS).
"RTN","WVSELECT",56,0)
 .;W " - ",$P(@(WVGBL_"N,0)"),U,2)
"RTN","WVSELECT",57,0)
 W ! S DIR(0)="Y",DIR("A")="   Is this correct",DIR("B")="Y"
"RTN","WVSELECT",58,0)
 D ^DIR I $D(DIRUT) S WVPOP=1 Q
"RTN","WVSELECT",59,0)
 I 'Y K @WVARR1 D  G SELECT1
"RTN","WVSELECT",60,0)
 .W "   All ",WVITEMS," deleted.",!?26," * Please begin again. *"
"RTN","WVSELECT",61,0)
 S WVPOP=0 W !
"RTN","WVSELECT",62,0)
 Q
"RTN","WVSELECT",63,0)
 ;
"RTN","WVSELECT",64,0)
PLURAL ;EP
"RTN","WVSELECT",65,0)
 ;---> CHANGE Y TO I AND AS ES IF NECESSARY.
"RTN","WVSELECT",66,0)
 I "Yy"[$E(WVITEM,$L(WVITEM)) D  Q
"RTN","WVSELECT",67,0)
 .S WVITEMS=$E(WVITEM,1,($L(WVITEM)-1))_"ies"
"RTN","WVSELECT",68,0)
 S WVITEMS=WVITEM_"s"
"RTN","WVSELECT",69,0)
 Q
"RTN","WVSITE")
0^53^B2489970
"RTN","WVSITE",1,0)
WVSITE ;HCIOFO/FT,JR IHS/ANMC/MWR - EDIT SITE PARAMETERS; ;7/30/98  14:41
"RTN","WVSITE",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVSITE",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVSITE",4,0)
 ;;  CALLED BY OPTION: "WV EDIT SITE PARAMETERS".
"RTN","WVSITE",5,0)
 ;
"RTN","WVSITE",6,0)
 D EDIT
"RTN","WVSITE",7,0)
 ;
"RTN","WVSITE",8,0)
EXIT ;EP
"RTN","WVSITE",9,0)
 W @IOF
"RTN","WVSITE",10,0)
 D KILLALL^WVUTL8
"RTN","WVSITE",11,0)
 Q
"RTN","WVSITE",12,0)
 ;
"RTN","WVSITE",13,0)
EDIT ;EP
"RTN","WVSITE",14,0)
 D SETVARS^WVUTL5
"RTN","WVSITE",15,0)
 N A,B
"RTN","WVSITE",16,0)
 D TITLE^WVUTL5("EDIT SITE PARAMETERS") W !
"RTN","WVSITE",17,0)
 S A="   Select SITE/FACILITY: ",B=""
"RTN","WVSITE",18,0)
 S:$D(DUZ(2)) B=$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVSITE",19,0)
 D DIC^WVFMAN(790.02,"QEMAL",.Y,A,B)
"RTN","WVSITE",20,0)
 Q:Y<0
"RTN","WVSITE",21,0)
 S $P(^WV(790.02,+Y,0),U,15)="v" ;set AGENCY (.15) for VA
"RTN","WVSITE",22,0)
 ;---> EDIT WITH SCREENMAN.
"RTN","WVSITE",23,0)
 D DDS^WVFMAN(790.02,"[WV SITE PARAMS-FORM-1]",+Y)
"RTN","WVSITE",24,0)
 Q
"RTN","WVSITE",25,0)
 ;
"RTN","WVSITE",26,0)
REF ;EP
"RTN","WVSITE",27,0)
 ; WV ADD/EDIT REFERRAL SOURCE option
"RTN","WVSITE",28,0)
 N DIC,DIE
"RTN","WVSITE",29,0)
 D TITLE^WVUTL5("ADD/EDIT REFERRAL SOURCES") W !
"RTN","WVSITE",30,0)
N S DLAYGO=790.07,DIC="^WV(790.07,",DIC("A")="Referral Source Name: "
"RTN","WVSITE",31,0)
 S DIC(0)="AELMNQZ" D ^DIC I Y'>0 K DA,DR,DLAYGO,WVJDA Q
"RTN","WVSITE",32,0)
 S DIE=DIC,DR=".01:1",(WVJDA,DA)=+Y
"RTN","WVSITE",33,0)
 L +^WV(790.07,WVJDA):0 I $T D ^DIE L -^WV(790.07,WVJDA) K DIE,DA,DR,DIC,DLAYGO W ! G N
"RTN","WVSITE",34,0)
 W !!?5,"Another user is editing this entry.",!! G N
"RTN","WVSITE",35,0)
 Q
"RTN","WVUTL1")
0^54^B37895415
"RTN","WVUTL1",1,0)
WVUTL1 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: MOSTLY PATIENT DATA  ;8/27/98  11:03
"RTN","WVUTL1",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL1",4,0)
 ;;  UTILITY: PATIENT DEMOGRAPHICS, NEEDS, AND REGIMENS.
"RTN","WVUTL1",5,0)
 ;;  ALSO DISPLAY PRIORITY, PROCEDURE TYPE.
"RTN","WVUTL1",6,0)
 ;
"RTN","WVUTL1",7,0)
 ;
"RTN","WVUTL1",8,0)
NAME(DFN) ;EP
"RTN","WVUTL1",9,0)
 ;---> PATIENT NAME.
"RTN","WVUTL1",10,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",11,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",12,0)
 Q:'$D(^DPT(DFN,0)) "UNKNOWN"
"RTN","WVUTL1",13,0)
 Q $P(^DPT(DFN,0),U)
"RTN","WVUTL1",14,0)
 ;
"RTN","WVUTL1",15,0)
DOB(DFN) ;EP
"RTN","WVUTL1",16,0)
 ;---> RETURN PATIENT'S DATE OF BIRTH IN FILEMAN FORMAT.
"RTN","WVUTL1",17,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",18,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",19,0)
 Q:'$P(^DPT(DFN,0),U,3) "UNKNOWN"
"RTN","WVUTL1",20,0)
 Q $P(^DPT(DFN,0),U,3)
"RTN","WVUTL1",21,0)
 ;
"RTN","WVUTL1",22,0)
 ;
"RTN","WVUTL1",23,0)
AGE(DFN) ;EP
"RTN","WVUTL1",24,0)
 ;---> YIELD PATIENT'S AGE IN YEARS.
"RTN","WVUTL1",25,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",26,0)
 N X,X1,X2
"RTN","WVUTL1",27,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",28,0)
 S X2=$$DOB(DFN)
"RTN","WVUTL1",29,0)
 Q:'+X2 "UNKNOWN"
"RTN","WVUTL1",30,0)
 I $$DECEASED(DFN) Q "DECEASED: "_$$SLDT2^WVUTL5(+^DPT(DFN,.35))
"RTN","WVUTL1",31,0)
 S X1=DT
"RTN","WVUTL1",32,0)
 D ^%DTC
"RTN","WVUTL1",33,0)
 Q $P(X/365.25,".")_"y/o"
"RTN","WVUTL1",34,0)
 ;
"RTN","WVUTL1",35,0)
DECEASED(DFN) ;EP
"RTN","WVUTL1",36,0)
 ;---> RETURN 1 IF PATIENT IS DECEASED, 0 IF NOT DECEASED.
"RTN","WVUTL1",37,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",38,0)
 Q:'$G(DFN) 0
"RTN","WVUTL1",39,0)
 Q:'$D(^DPT(DFN,.35)) 0
"RTN","WVUTL1",40,0)
 Q:'+^DPT(DFN,.35) 0
"RTN","WVUTL1",41,0)
 Q 1
"RTN","WVUTL1",42,0)
 ;
"RTN","WVUTL1",43,0)
SEX(DFN) ;EP
"RTN","WVUTL1",44,0)
 ;---> RETURN 1 IF PATIENT IS FEMALE.
"RTN","WVUTL1",45,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",46,0)
 Q:'$G(DFN) ""
"RTN","WVUTL1",47,0)
 Q:'$D(^DPT(DFN,0)) ""
"RTN","WVUTL1",48,0)
 Q:$P(^DPT(DFN,0),U,2)'="F" ""
"RTN","WVUTL1",49,0)
 Q 1
"RTN","WVUTL1",50,0)
 ;
"RTN","WVUTL1",51,0)
INACT(DFN) ;EP
"RTN","WVUTL1",52,0)
 ;---> DATE THIS PATIENT BECAME INACTIVE
"RTN","WVUTL1",53,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",54,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",55,0)
 Q:'$D(^DPT(DFN,0)) "UNKNOWN"
"RTN","WVUTL1",56,0)
 Q $P(^WV(790,DFN,0),U,24)
"RTN","WVUTL1",57,0)
 ;
"RTN","WVUTL1",58,0)
AGEAT(DFN,DATE) ;EP
"RTN","WVUTL1",59,0)
 ;---> YIELD PATIENT'S AGE IN YEARS AT GIVEN DATE.
"RTN","WVUTL1",60,0)
 ;---> REQUIRED VARIABLE: DFN =IEN PATIENT FILE
"RTN","WVUTL1",61,0)
 ;--->                    DATE=DATE AT WHICH AGE IS DESIRED.
"RTN","WVUTL1",62,0)
 N X,X1,X2
"RTN","WVUTL1",63,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",64,0)
 Q:'$G(DATE) "NO DATE"
"RTN","WVUTL1",65,0)
 S X2=$$DOB(DFN)
"RTN","WVUTL1",66,0)
 Q:'+X2 "UNKNOWN"
"RTN","WVUTL1",67,0)
 S X1=DATE
"RTN","WVUTL1",68,0)
 D ^%DTC
"RTN","WVUTL1",69,0)
 Q $P(X/365.25,".")_"y/o"
"RTN","WVUTL1",70,0)
 ;
"RTN","WVUTL1",71,0)
NAMAGE(DFN) ;EP
"RTN","WVUTL1",72,0)
 ;---> PATIENT NAME CONCAT WITH AGE.
"RTN","WVUTL1",73,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",74,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",75,0)
 Q $$NAME(DFN)_" ("_$$AGE(DFN)_")"
"RTN","WVUTL1",76,0)
 ;
"RTN","WVUTL1",77,0)
SSN(DFN) ;EP
"RTN","WVUTL1",78,0)
 ;---> SOCIAL SECURITY NUMBER.
"RTN","WVUTL1",79,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",80,0)
 N X
"RTN","WVUTL1",81,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",82,0)
 Q:'$D(^DPT(DFN,0)) "UNKNOWN"
"RTN","WVUTL1",83,0)
 S X=$P(^DPT(DFN,0),U,9)
"RTN","WVUTL1",84,0)
 Q:X']"" "UNKNOWN"
"RTN","WVUTL1",85,0)
 S X=$E(X,1,3)_"-"_$E(X,4,5)_"-"_$E(X,6,9)
"RTN","WVUTL1",86,0)
 Q X
"RTN","WVUTL1",87,0)
 ;
"RTN","WVUTL1",88,0)
HRCN(DFN) ;EP
"RTN","WVUTL1",89,0)
 ;---> RETURN SSN.
"RTN","WVUTL1",90,0)
 ;---> REQUIRED VARIABLE: DFN
"RTN","WVUTL1",91,0)
 Q $$SSN(DFN)
"RTN","WVUTL1",92,0)
 ;
"RTN","WVUTL1",93,0)
HPHONE(DFN) ;EP
"RTN","WVUTL1",94,0)
 ;---> GET HOME PHONE#.
"RTN","WVUTL1",95,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",96,0)
 N WVPHONE
"RTN","WVUTL1",97,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",98,0)
 S WVPHONE=$$GET1^DIQ(2,DFN,.131,"I")
"RTN","WVUTL1",99,0)
 Q:WVPHONE="" "UNKNOWN"
"RTN","WVUTL1",100,0)
 Q WVPHONE
"RTN","WVUTL1",101,0)
 ;
"RTN","WVUTL1",102,0)
STREET(DFN) ;EP
"RTN","WVUTL1",103,0)
 ;---> GET STREET ADDRESS.
"RTN","WVUTL1",104,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",105,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",106,0)
 N WVADDR
"RTN","WVUTL1",107,0)
 S WVADDR=$$GET1^DIQ(2,DFN,.111,"I")
"RTN","WVUTL1",108,0)
 Q:WVADDR="" "UNKNOWN"
"RTN","WVUTL1",109,0)
 Q WVADDR
"RTN","WVUTL1",110,0)
 ;
"RTN","WVUTL1",111,0)
CITY(DFN) ;EP
"RTN","WVUTL1",112,0)
 ;---> GET CITY ADDRESS.
"RTN","WVUTL1",113,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",114,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",115,0)
 N WVCITY
"RTN","WVUTL1",116,0)
 S WVCITY=$$GET1^DIQ(2,DFN,.114,"I")
"RTN","WVUTL1",117,0)
 Q:WVCITY="" "UNKNOWN"
"RTN","WVUTL1",118,0)
 Q WVCITY
"RTN","WVUTL1",119,0)
 ;
"RTN","WVUTL1",120,0)
STATE(DFN) ;EP
"RTN","WVUTL1",121,0)
 ;---> GET STATE ADDRESS.
"RTN","WVUTL1",122,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",123,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",124,0)
 N WVSTATE
"RTN","WVUTL1",125,0)
 S WVSTATE=$$GET1^DIQ(2,DFN,.115,"I")
"RTN","WVUTL1",126,0)
 Q:WVSTATE="" "UNKNOWN"
"RTN","WVUTL1",127,0)
 S WVSTATE=$$GET1^DIQ(5,WVSTATE,1,"I") S:WVSTATE="" WVSTATE="UNKNOWN"
"RTN","WVUTL1",128,0)
 Q WVSTATE
"RTN","WVUTL1",129,0)
 ;
"RTN","WVUTL1",130,0)
ZIP(DFN) ;EP
"RTN","WVUTL1",131,0)
 ;---> GET ZIPCODE ADDRESS.
"RTN","WVUTL1",132,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",133,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",134,0)
 N WVZIP
"RTN","WVUTL1",135,0)
 S WVZIP=$$GET1^DIQ(2,DFN,.116,"I")
"RTN","WVUTL1",136,0)
 Q:WVZIP'>0 "UNKNOWN"
"RTN","WVUTL1",137,0)
 Q WVZIP
"RTN","WVUTL1",138,0)
 ;
"RTN","WVUTL1",139,0)
CTYSTZ(DFN) ;EP
"RTN","WVUTL1",140,0)
 ;---> GET ZIPCODE ADDRESS.
"RTN","WVUTL1",141,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",142,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",143,0)
 Q $$CITY(DFN)_", "_$$STATE(DFN)_"  "_$$ZIP(DFN)
"RTN","WVUTL1",144,0)
 ;
"RTN","WVUTL1",145,0)
CMGR(DFN) ;EP
"RTN","WVUTL1",146,0)
 ;---> YIELD PATIENT'S CASE MANAGER.
"RTN","WVUTL1",147,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",148,0)
 N X
"RTN","WVUTL1",149,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",150,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",151,0)
 S X=$P(^WV(790,DFN,0),U,10)
"RTN","WVUTL1",152,0)
 Q $$PERSON(X)
"RTN","WVUTL1",153,0)
 ;
"RTN","WVUTL1",154,0)
PERSON(X) ;EP
"RTN","WVUTL1",155,0)
 ;---> RETURN PERSON'S NAME FROM FILE #200.
"RTN","WVUTL1",156,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1",157,0)
 Q:'$D(^VA(200,X,0)) "UNKNOWN"
"RTN","WVUTL1",158,0)
 Q $P(^VA(200,X,0),U)
"RTN","WVUTL1",159,0)
 ;
"RTN","WVUTL1",160,0)
EDC(DFN) ;EP
"RTN","WVUTL1",161,0)
 ;---> YIELD IF PATIENT IS PREGNANT, AND EDC.
"RTN","WVUTL1",162,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",163,0)
 N X,Y
"RTN","WVUTL1",164,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",165,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",166,0)
 S Y=$P(^WV(790,DFN,0),U,13)
"RTN","WVUTL1",167,0)
 S X=$P(^WV(790,DFN,0),U,14)
"RTN","WVUTL1",168,0)
 Q:'Y ""
"RTN","WVUTL1",169,0)
 S Y=" PREGNANT"
"RTN","WVUTL1",170,0)
 Q Y_", EDC: "_$S(X:$$SLDT2^WVUTL5(X),1:"NO DATE ")_" "
"RTN","WVUTL1",171,0)
 ;
"RTN","WVUTL1",172,0)
PAPRG(DFN,TXDT) ;EP
"RTN","WVUTL1",173,0)
 ;---> YIELD PATIENT'S PAP REGIMEN AND DATE IT BEGAN.
"RTN","WVUTL1",174,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",175,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE TEXT FORMAT.
"RTN","WVUTL1",176,0)
 N Y,X
"RTN","WVUTL1",177,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",178,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",179,0)
 S Y=$P(^WV(790,DFN,0),U,16)
"RTN","WVUTL1",180,0)
 S X=$P(^WV(790,DFN,0),U,17) D Z(.X,$G(TXDT))
"RTN","WVUTL1",181,0)
 Q $$PAPRG1(Y)_" (began "_X_")"
"RTN","WVUTL1",182,0)
 ;
"RTN","WVUTL1",183,0)
PAPRG1(PREG) ;EP
"RTN","WVUTL1",184,0)
 ;---> YIELD PATIENT'S PAP REGIMEN.
"RTN","WVUTL1",185,0)
 ;---> REQUIRED VARIABLE: PREG=IEN IN WV PAP REGIMEN FILE #790.03.
"RTN","WVUTL1",186,0)
 Q:'$G(PREG) "UNKNOWN"
"RTN","WVUTL1",187,0)
 Q:'$D(^WV(790.03,PREG,0)) "PAP REGIMEN MISSING"
"RTN","WVUTL1",188,0)
 Q $P(^WV(790.03,PREG,0),U)
"RTN","WVUTL1",189,0)
 ;
"RTN","WVUTL1",190,0)
CNEED(DFN,TXDT) ;PEP
"RTN","WVUTL1",191,0)
 ;---> YIELD PATIENT'S CX TX NEED AND CX TX NEED DUE DATE.
"RTN","WVUTL1",192,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",193,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE TEXT FORMAT.
"RTN","WVUTL1",194,0)
 N X,Y
"RTN","WVUTL1",195,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",196,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",197,0)
 S Y=$P(^WV(790,DFN,0),U,11)
"RTN","WVUTL1",198,0)
 Q:'Y "UNKNOWN"
"RTN","WVUTL1",199,0)
 Q:'$D(^WV(790.5,Y,0)) "UNKNOWN"
"RTN","WVUTL1",200,0)
 S X=$P(^WV(790,DFN,0),U,12) D Z(.X,$G(TXDT))
"RTN","WVUTL1",201,0)
 Q $E($P(^WV(790.5,Y,0),U),1,22)_" (by "_X_")"
"RTN","WVUTL1",202,0)
 ;
"RTN","WVUTL1",203,0)
BNEED(DFN,TXDT) ;PEP
"RTN","WVUTL1",204,0)
 ;---> YIELD PATIENT'S BR TX NEED AND BR TX NEED DUE DATE.
"RTN","WVUTL1",205,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",206,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE TEXT FORMAT.
"RTN","WVUTL1",207,0)
 N X,Y,Z
"RTN","WVUTL1",208,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",209,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",210,0)
 S Y=$P(^WV(790,DFN,0),U,18)
"RTN","WVUTL1",211,0)
 Q:'Y "UNKNOWN"
"RTN","WVUTL1",212,0)
 Q:'$D(^WV(790.51,Y,0)) "UNKNOWN"
"RTN","WVUTL1",213,0)
 S X=$P(^WV(790,DFN,0),U,19) D Z(.X,$G(TXDT))
"RTN","WVUTL1",214,0)
 Q $E($P(^WV(790.51,Y,0),U),1,22)_" (by "_X_")"
"RTN","WVUTL1",215,0)
 ;
"RTN","WVUTL1",216,0)
DES(DFN) ;EP
"RTN","WVUTL1",217,0)
 ;---> YIELD PATIENT'S STATUS AS A DES DAUGHTER: 1=YES, 0=NO.
"RTN","WVUTL1",218,0)
 ;---> DFN=IEN PATIENT FILE
"RTN","WVUTL1",219,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",220,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",221,0)
 Q:'$D(^DD(790,.15,0)) "^DD MISSING"
"RTN","WVUTL1",222,0)
 S X=$P(^WV(790,DFN,0),U,15)
"RTN","WVUTL1",223,0)
 Q:X="" ""
"RTN","WVUTL1",224,0)
 Q $P($P(^DD(790,.15,0),X_":",2),";")
"RTN","WVUTL1",225,0)
 ;
"RTN","WVUTL1",226,0)
FAMHX(DFN) ;EP
"RTN","WVUTL1",227,0)
 ;---> RETURN FAMILY HISTORY OF BREAST CANCER.
"RTN","WVUTL1",228,0)
 ;---> DFN=IEN PATIENT FILE
"RTN","WVUTL1",229,0)
 N X
"RTN","WVUTL1",230,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",231,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",232,0)
 Q:'$D(^DD(790,.23,0)) "^DD MISSING"
"RTN","WVUTL1",233,0)
 S X=$P(^WV(790,DFN,0),U,23)
"RTN","WVUTL1",234,0)
 Q:X="" ""
"RTN","WVUTL1",235,0)
 Q $P($P(^DD(790,.23,0),X_":",2),";")
"RTN","WVUTL1",236,0)
 ;
"RTN","WVUTL1",237,0)
REFS(DFN) ;EP
"RTN","WVUTL1",238,0)
 ;---> RETURN REFERRAL SOURCE FOR THIS PATIENT.
"RTN","WVUTL1",239,0)
 ;---> DFN=IEN PATIENT FILE
"RTN","WVUTL1",240,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",241,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",242,0)
 Q:'$D(^DD(790,.22,0)) "^DD MISSING"
"RTN","WVUTL1",243,0)
 S X=$P(^WV(790,DFN,0),U,22) S:X>0 X=$P($G(^WV(790.07,X,0)),U)
"RTN","WVUTL1",244,0)
 Q X
"RTN","WVUTL1",245,0)
 ;
"RTN","WVUTL1",246,0)
ENRLDT(DFN,TXDT) ;PEP
"RTN","WVUTL1",247,0)
 ;---> YIELD PATIENT'S ENROLLMENT DATE.
"RTN","WVUTL1",248,0)
 ;---> REQUIRED VARIABLE: DFN=IEN PATIENT FILE
"RTN","WVUTL1",249,0)
 ;---> OPTIONAL VARIABLE: TXDT=1 IF DATE SHOULD BE IN TEXT FORMAT.
"RTN","WVUTL1",250,0)
 N X
"RTN","WVUTL1",251,0)
 Q:'$G(DFN) "NO PATIENT"
"RTN","WVUTL1",252,0)
 Q:'$D(^WV(790,DFN,0)) "UNKNOWN"
"RTN","WVUTL1",253,0)
 S X=$P(^WV(790,DFN,0),U,21)
"RTN","WVUTL1",254,0)
 Q:'X ""  D Z(.X,$G(TXDT))
"RTN","WVUTL1",255,0)
 Q X
"RTN","WVUTL1",256,0)
 ;
"RTN","WVUTL1",257,0)
Z(X,Z) ;EP
"RTN","WVUTL1",258,0)
 ;---> SET Z = NUMERIC (1/1/95) OR TEXT (JAN 1,1995) FORMAT OF DATE.
"RTN","WVUTL1",259,0)
 ;---> REQUIRED VARIABLE:  X=FILEMAN INTERNAL DATE FORMAT.
"RTN","WVUTL1",260,0)
 ;---> OPTIONAL VARIABLE: Z=1 IF TEXT, 0/"" IF NUMERIC.
"RTN","WVUTL1",261,0)
 S X=$S($G(Z):$$TXDT^WVUTL5(X),1:$$SLDT2^WVUTL5(X))
"RTN","WVUTL1",262,0)
 Q
"RTN","WVUTL1",263,0)
 ;
"RTN","WVUTL1",264,0)
 ;
"RTN","WVUTL1",265,0)
ACC(IEN) ;EP
"RTN","WVUTL1",266,0)
 ;---> ACCESSION#; CONCATENATE SCREENING PAP IF IT EXISTS.
"RTN","WVUTL1",267,0)
 ;---> IEN=IEN IN WV PROCEDURE FILE #790.1).
"RTN","WVUTL1",268,0)
 Q:'$G(IEN) "NO PROC"
"RTN","WVUTL1",269,0)
 Q:'$D(^WV(790.1,IEN,0)) "NO PROC"
"RTN","WVUTL1",270,0)
 N X S X=$P(^WV(790.1,IEN,0),U,30)
"RTN","WVUTL1",271,0)
 I X]"" I $D(^WV(790.1,X,0)) S X=$P(^WV(790.1,X,0),U),X=","_X
"RTN","WVUTL1",272,0)
 Q $E($P(^WV(790.1,IEN,0),U)_X,1,19)
"RTN","WVUTL1A")
0^55^B31120754
"RTN","WVUTL1A",1,0)
WVUTL1A ;HCIOFO/JR - Continuation of ^WVUTL1 (Utilities) ;9/11/98  16:13
"RTN","WVUTL1A",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL1A",3,0)
 ;;
"RTN","WVUTL1A",4,0)
PRIOR() ;EP
"RTN","WVUTL1A",5,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1 TO GET VALUE AND TEXT OF
"RTN","WVUTL1A",6,0)
 ;---> NOTIFICATION PRIORITY AND RESULT/REMINDER, FROM PURPOSE OF
"RTN","WVUTL1A",7,0)
 ;---> NOTIFICATION WHEN FIRST DISPLAYING SCREEN.
"RTN","WVUTL1A",8,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF NOTIFICATION.
"RTN","WVUTL1A",9,0)
 N X
"RTN","WVUTL1A",10,0)
 Q:'$D(DA) "UNKNOWN"
"RTN","WVUTL1A",11,0)
 Q:'$D(^WV(790.4,DA,0)) "UNKNOWN"
"RTN","WVUTL1A",12,0)
 S X=$P(^WV(790.4,DA,0),U,4)
"RTN","WVUTL1A",13,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1A",14,0)
 Q $$PRIOR1
"RTN","WVUTL1A",15,0)
 ;
"RTN","WVUTL1A",16,0)
PRIOR1() ;EP
"RTN","WVUTL1A",17,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1 TO GET VALUE AND TEXT OF
"RTN","WVUTL1A",18,0)
 ;---> NOTIFICATION PRIORITY FROM PURPOSE OF NOTIFICATION AS AN
"RTN","WVUTL1A",19,0)
 ;---> ACTION WHEN EDITING PURPOSE OF NOTIFICATION.  ALSO DISPLAY
"RTN","WVUTL1A",20,0)
 ;---> WHETHER PURPOSE IS A RESULT OR A REMINDER.
"RTN","WVUTL1A",21,0)
 ;---> REQUIRED VARIABLE: X=IEN IN NOTIFICATION PURPOSE FILE.
"RTN","WVUTL1A",22,0)
 N R,Y,Z
"RTN","WVUTL1A",23,0)
 Q:'$D(X) "UNDEFINED"
"RTN","WVUTL1A",24,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1A",25,0)
 Q:'$D(^WV(790.404,X,0)) "UNKNOWN"
"RTN","WVUTL1A",26,0)
 S Y=$P(^WV(790.404,X,0),U,2) D
"RTN","WVUTL1A",27,0)
 .I 'Y S R="UNKNOWN" Q
"RTN","WVUTL1A",28,0)
 .I '$D(^DD(790.404,.02,0)) S R="^DD MISSING"
"RTN","WVUTL1A",29,0)
 .S R=$P($P(^DD(790.404,.02,0),Y_":",2),";")
"RTN","WVUTL1A",30,0)
 S Z=$P(^WV(790.404,X,0),U,6)
"RTN","WVUTL1A",31,0)
 Q:Z="" R
"RTN","WVUTL1A",32,0)
 Q:Z R_", RESULT"
"RTN","WVUTL1A",33,0)
 Q R_", REMINDER"
"RTN","WVUTL1A",34,0)
 ;
"RTN","WVUTL1A",35,0)
 ;
"RTN","WVUTL1A",36,0)
NTPROC() ;EP
"RTN","WVUTL1A",37,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1(?) BLOCK TO DISPLAY PROCEDURE
"RTN","WVUTL1A",38,0)
 ;---> NAME, BASED ON ACCESSION# PTR, WHEN FIRST DISPLAYING SCREEN.
"RTN","WVUTL1A",39,0)
 ;---> REQUIRED VARIABLE: X=ACCESSION# OF PROCEDURE
"RTN","WVUTL1A",40,0)
 N X
"RTN","WVUTL1A",41,0)
 S X=$P(^WV(790.4,DA,0),U,6)
"RTN","WVUTL1A",42,0)
 Q $$PROC
"RTN","WVUTL1A",43,0)
 ;
"RTN","WVUTL1A",44,0)
PROC() ;EP
"RTN","WVUTL1A",45,0)
 ;---> DISPLAY PROCEDURE TYPE OF THIS PROCEDURE.
"RTN","WVUTL1A",46,0)
 ;---> REQUIRED VARIABLE: X=IEN OF PROCEDURE IN PROC FILE #790.1.
"RTN","WVUTL1A",47,0)
 N WVY,WVYY,Y,Z S WVYY="INVALID ACC# OR PTR"
"RTN","WVUTL1A",48,0)
 Q:X']"" ""
"RTN","WVUTL1A",49,0)
 Q:'$D(^WV(790.1,X,0)) WVYY
"RTN","WVUTL1A",50,0)
 S WVY=$P(^WV(790.1,X,0),U,4)
"RTN","WVUTL1A",51,0)
 Q:'WVY WVYY
"RTN","WVUTL1A",52,0)
 Q:'$D(^WV(790.2,WVY,0)) WVYY
"RTN","WVUTL1A",53,0)
 S Z=$P(^WV(790.2,WVY,0),U)
"RTN","WVUTL1A",54,0)
 ;---> IF UNILATERAL AND LEFT/RIGHT HAS A VALUE, REPLACE "UNILATERAL"
"RTN","WVUTL1A",55,0)
 ;---> WITH LEFT OR RIGHT.
"RTN","WVUTL1A",56,0)
 S Y=$P(^WV(790.1,X,0),U,9)
"RTN","WVUTL1A",57,0)
 S Y=$S(Y="l":"LEFT",Y="r":"RIGHT",1:"")
"RTN","WVUTL1A",58,0)
 Q:Y="" Z
"RTN","WVUTL1A",59,0)
 Q $P(Z," ")_" "_Y
"RTN","WVUTL1A",60,0)
 ;
"RTN","WVUTL1A",61,0)
PROC1() ;EP
"RTN","WVUTL1A",62,0)
 ;---> DISPLAY PROCEDURE TYPE OF THIS PROCEDURE, USING DA.
"RTN","WVUTL1A",63,0)
 ;---> CALLED BY WV PROC-HEADER-1, WHICH CANNOT USE X.
"RTN","WVUTL1A",64,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF PROCEDURE IN PROC FILE #790.1.
"RTN","WVUTL1A",65,0)
 N X S X=DA
"RTN","WVUTL1A",66,0)
 Q $$PROC
"RTN","WVUTL1A",67,0)
PROVI(DFN) ;
"RTN","WVUTL1A",68,0)
 ;---> RETURNS THE PRIMARY CARE PROVIDER
"RTN","WVUTL1A",69,0)
 ;---> REQUIRED VARIABLE: DFN
"RTN","WVUTL1A",70,0)
 Q:$G(DFN)'>0 "UNKNOWN"
"RTN","WVUTL1A",71,0)
 N X S X=$P($G(^DPT(DFN,.104)),U)
"RTN","WVUTL1A",72,0)
 S X=$S(X>0:$P($G(^VA(200,X,0)),U),1:"")
"RTN","WVUTL1A",73,0)
 I X="" S X=$P($$OUTPTPR^SDUTL3(DFN),U,2)
"RTN","WVUTL1A",74,0)
 S:X="" X="UNKNOWN"
"RTN","WVUTL1A",75,0)
 Q X
"RTN","WVUTL1A",76,0)
SCR(X) ;
"RTN","WVUTL1A",77,0)
 Q:$G(X)'>0 0
"RTN","WVUTL1A",78,0)
 S WVJX=$S(X>0:$P($G(^WV(790.07,X,0)),U,2),1:0)
"RTN","WVUTL1A",79,0)
 Q WVJX
"RTN","WVUTL1A",80,0)
QUAD(X) ;
"RTN","WVUTL1A",81,0)
 Q:$TR(X,"ULR,")'="" 0
"RTN","WVUTL1A",82,0)
 N TEST,CN,CNT,WVJX S WVJX=X,CN=""
"RTN","WVUTL1A",83,0)
 S (CN("LL"),CN("UL"),CN("UR"),CN("LR"))="",TEST=1
"RTN","WVUTL1A",84,0)
 F  S CN=$O(CN(CN)) Q:CN=""  I $P(WVJX,CN,2,5)[CN S WVJX=$P(WVJX,CN,1,2)_$P(WVJX,CN,3)
"RTN","WVUTL1A",85,0)
 F CN=1:1:11 I $E(WVJX,CN)=","&($E(WVJX,CN+1)=",") S WVJX=$E(WVJX,1,CN)_$E(WVJX,CN+2,11) S CN=CN-1
"RTN","WVUTL1A",86,0)
 F CN=1:1:4 S CNT=$P(X,",",CN) I CNT'="" I '$D(CN(CNT)) S TEST=0 Q
"RTN","WVUTL1A",87,0)
 S:$E(WVJX,$L(WVJX))="," WVJX=$E(WVJX,1,$L(WVJX)-1)
"RTN","WVUTL1A",88,0)
 S:$E(WVJX,1)="," WVJX=$E(WVJX,2,11)
"RTN","WVUTL1A",89,0)
 S:TEST>0 TEST=TEST_"^"_WVJX
"RTN","WVUTL1A",90,0)
 Q TEST
"RTN","WVUTL1A",91,0)
REF ;
"RTN","WVUTL1A",92,0)
 N X,Y,B,L
"RTN","WVUTL1A",93,0)
 Q:$G(DA)=""  S X=DA
"RTN","WVUTL1A",94,0)
 S Y=X,X=$P($G(^WV(790.07,X,0)),U)
"RTN","WVUTL1A",95,0)
 S L="abcdefghijklmnopqrstuvwxyz"
"RTN","WVUTL1A",96,0)
 S B="ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"RTN","WVUTL1A",97,0)
 S X=$TR($E(X,1,$L(X)),L,B)
"RTN","WVUTL1A",98,0)
 I WVACT="SET" S ^WV(790.07,"C",X,Y)=""
"RTN","WVUTL1A",99,0)
 I WVACT="KIL" K ^WV(790.07,"C",X,Y)
"RTN","WVUTL1A",100,0)
 K WVACT Q
"RTN","WVUTL1A",101,0)
FAC N X,Y
"RTN","WVUTL1A",102,0)
 S WVJBFAC="",WVJCFAC="",WVJPCP=""
"RTN","WVUTL1A",103,0)
 Q:$G(WVDFN)'>0
"RTN","WVUTL1A",104,0)
 S X=$G(^WV(790,WVDFN,0))
"RTN","WVUTL1A",105,0)
 S WVJBFAC=$P(X,U,25),WVJCFAC=$P(X,U,26),WVJPCP=$$PROVI(WVDFN)
"RTN","WVUTL1A",106,0)
 S:WVJBFAC>0 WVJBFAC=$E($P($G(^DIC(4,WVJBFAC,0)),U),1,18)
"RTN","WVUTL1A",107,0)
 S:WVJCFAC>0 WVJCFAC=$E($P($G(^DIC(4,WVJCFAC,0)),U),1,18)
"RTN","WVUTL1A",108,0)
 Q
"RTN","WVUTL1A",109,0)
RAXS(DA) ; 
"RTN","WVUTL1A",110,0)
 I $G(DA)'>0 Q 0
"RTN","WVUTL1A",111,0)
 S WVJJ0=$G(^WV(790.1,DA,0))
"RTN","WVUTL1A",112,0)
 I '$D(WVJJ0) Q 0
"RTN","WVUTL1A",113,0)
 I "^BU^MB^MU^MS^"'[$E(WVJJ0,1,2) Q 0
"RTN","WVUTL1A",114,0)
 I $P(WVJJ0,U,15)="" Q 0
"RTN","WVUTL1A",115,0)
 Q 1
"RTN","WVUTL1A",116,0)
FACIL(DFN,TYP) ;Gets Treatment Facility, if typ="C" for Cervix, "B" for Breast
"RTN","WVUTL1A",117,0)
 N X,Y
"RTN","WVUTL1A",118,0)
 S Y=""
"RTN","WVUTL1A",119,0)
 I $G(DFN)'>0 Q Y
"RTN","WVUTL1A",120,0)
 S X=$G(^WV(790,DFN,0))
"RTN","WVUTL1A",121,0)
 S:TYP="B" Y=$P(X,U,25) S:TYP="C" Y=$P(X,U,26)
"RTN","WVUTL1A",122,0)
 S:Y>0 Y=$E($P($G(^DIC(4,Y,0)),U),1,18)
"RTN","WVUTL1A",123,0)
 Q Y
"RTN","WVUTL1A",124,0)
MST(WVDFN) ;Gets Military Sexual Trauma
"RTN","WVUTL1A",125,0)
 I $G(WVDFN)'>0 Q ""
"RTN","WVUTL1A",126,0)
 N J S J=$P($G(^WV(790,WVDFN,0)),U,27)
"RTN","WVUTL1A",127,0)
 S J=$S(J="M":"Military",J="C":"Civilian",J="B":"Both",1:"")
"RTN","WVUTL1A",128,0)
 Q J
"RTN","WVUTL1A",129,0)
SC(WVJ) ;Screen called from File 790.02 to elim. inactive from selectable
"RTN","WVUTL1A",130,0)
 I XQY0["WV ADD/EDIT CASE MANAGERS" Q 1
"RTN","WVUTL1A",131,0)
 I $G(WVJOPEN)>0 Q 1
"RTN","WVUTL1A",132,0)
 I $P($G(^WV(790.01,+WVJ,0)),U,2)>0 Q 0
"RTN","WVUTL1A",133,0)
 Q 1
"RTN","WVUTL1A",134,0)
LOOK(WVJ) ;Display select fields with lookup on 790, not file#2 Identif.
"RTN","WVUTL1A",135,0)
 Q:WVJ'>0
"RTN","WVUTL1A",136,0)
 N DIC,DA,DR,DIQ,Y
"RTN","WVUTL1A",137,0)
 S DIC="^WV(790,",DA=WVJ,DIQ="WVJAR(",DIQ(0)="E"
"RTN","WVUTL1A",138,0)
 S DR=".06;.1;.16" D EN^DIQ1
"RTN","WVUTL1A",139,0)
 S WVJ=WVJAR(790,WVJ,.06,"E")_"    "_WVJAR(790,WVJ,.1,"E")
"RTN","WVUTL1A",140,0)
 K WVJAR
"RTN","WVUTL1A",141,0)
 Q WVJ
"RTN","WVUTL1A",142,0)
LOOKL(WVJ) ;
"RTN","WVUTL1A",143,0)
 N Y,WVX,WVP,WVY,WVDT,WVP,X,WVDTS,WVMARK
"RTN","WVUTL1A",144,0)
 S X1=DT,X2=-30 D C^%DTC S WVDTS=X
"RTN","WVUTL1A",145,0)
 S WVX="" F  S WVX=$O(^WV(790.3,"C",+WVJ,WVX)) Q:WVX'>0  D
"RTN","WVUTL1A",146,0)
 .S WVY=$G(^WV(790.3,WVX,0)),WVDT=+WVY,WVP=$P(WVY,U,3)
"RTN","WVUTL1A",147,0)
 .Q:WVDT'>WVDTS  S WVMARK=1
"RTN","WVUTL1A",148,0)
 .S Y=WVDT D DD^%DT S WVDT=Y
"RTN","WVUTL1A",149,0)
 .;S WVP=$S(WVP'>0:"",1:$P($G(^WV(790.1,WVP,0)),U,4))
"RTN","WVUTL1A",150,0)
 .S:WVP'="" WVP=$P($G(^WV(790.2,WVP,0)),U)
"RTN","WVUTL1A",151,0)
 .W !?32,WVDT,?47,WVP
"RTN","WVUTL1A",152,0)
 W:$G(WVMARK)=1 !
"RTN","WVUTL1A",153,0)
 Q
"RTN","WVUTL1A",154,0)
RUNDT(WVY) ;Get and format run date for various reports 
"RTN","WVUTL1A",155,0)
 ; Center when WVY="C"
"RTN","WVUTL1A",156,0)
 N Y,WVJ
"RTN","WVUTL1A",157,0)
 I $D(WVJRNOW) Q WVJRNOW
"RTN","WVUTL1A",158,0)
 D NOW^%DTC S Y=% D DD^%DT
"RTN","WVUTL1A",159,0)
 S Y=$E(Y,1,12)_"  "_$E(Y,14,18)
"RTN","WVUTL1A",160,0)
 S:$L(Y)'>10 Y=""
"RTN","WVUTL1A",161,0)
 S (WVJRNOW,WVJ)="Run Date: "_Y
"RTN","WVUTL1A",162,0)
 I $G(WVY)="C" Q "                         "_WVJ
"RTN","WVUTL1A",163,0)
 Q WVJ
"RTN","WVUTL1A",164,0)
MSTAL(WVDFN) ; get Military Sexual Trauma (MST) code from File 2
"RTN","WVUTL1A",165,0)
 ; if MST="Y" return "M" (for military, only)
"RTN","WVUTL1A",166,0)
 N WVMST
"RTN","WVUTL1A",167,0)
 S WVMST=$$GET1^DIQ(2,WVDFN,29.01,"I")
"RTN","WVUTL1A",168,0)
 Q:WVMST="Y" "M"
"RTN","WVUTL1A",169,0)
 Q ""
"RTN","WVUTL1A",170,0)
MSTDEF(WVDFN) ;Makes MST default for ScreenMan Patient edits
"RTN","WVUTL1A",171,0)
 N WVMST
"RTN","WVUTL1A",172,0)
 S WVMST=$$GET1^DIQ(790,WVDFN,.27,"E")
"RTN","WVUTL1A",173,0)
 Q:WVMST'="" WVMST
"RTN","WVUTL1A",174,0)
 S WVMST=$$GET1^DIQ(2,WVDFN,29.01,"E")
"RTN","WVUTL1A",175,0)
 Q WVMST
"RTN","WVUTL1A",176,0)
MSTUPD ;Entry point to update Sexual Trauma from Patient file
"RTN","WVUTL1A",177,0)
 ;when the Sexual Trauma field is released for the Patient file.
"RTN","WVUTL1A",178,0)
 S WVDFN=0
"RTN","WVUTL1A",179,0)
 F  S WVDFN=$O(^WV(790,WVDFN)) Q:WVDFN'>0  S WV0=$G(^(WVDFN,0)) D
"RTN","WVUTL1A",180,0)
 .Q:$P(WV0,U,27)'=""
"RTN","WVUTL1A",181,0)
 .Q:$$MSTAL(WVDFN)=""
"RTN","WVUTL1A",182,0)
 .S $P(^WV(790,WVDFN,0),U,27)=$$MSTAL(WVDFN)
"RTN","WVUTL1A",183,0)
 Q
"RTN","WVUTL1A",184,0)
MSTU ;Update procedure header Sexual Trauma when File 2 field is populated
"RTN","WVUTL1A",185,0)
 Q:$G(WVDFN)'>0
"RTN","WVUTL1A",186,0)
 Q:$P($G(^WV(790,WVDFN,0)),U,27)'=""
"RTN","WVUTL1A",187,0)
 Q:$$MSTDEF(WVDFN)=""
"RTN","WVUTL1A",188,0)
 N DR,DA,DIE,DIC
"RTN","WVUTL1A",189,0)
 S DR=".27////"_$E($$MSTDEF(WVDFN))
"RTN","WVUTL1A",190,0)
 S DA=WVDFN
"RTN","WVUTL1A",191,0)
 S DIE=790
"RTN","WVUTL1A",192,0)
 D ^DIE
"RTN","WVUTL1A",193,0)
 Q
"RTN","WVUTL1A",194,0)
LINE ; Called from the WV LINE FOR MENUS option. That option is merely a
"RTN","WVUTL1A",195,0)
 ; place holder in the menu and used for visual purposes. This is 
"RTN","WVUTL1A",196,0)
 ; entry point does nothing.
"RTN","WVUTL1A",197,0)
 Q
"RTN","WVUTL1A",198,0)
VET(DFN) ; Check if patient is a veteran.
"RTN","WVUTL1A",199,0)
 N WVETERAN
"RTN","WVUTL1A",200,0)
 S WVETERAN=$$GET1^DIQ(2,DFN,1901,"I")
"RTN","WVUTL1A",201,0)
 Q $S(WVETERAN="Y":"Yes",WVETERAN="N":"No",1:"Unknown")
"RTN","WVUTL1A",202,0)
 ;
"RTN","WVUTL2")
0^56^B7741474
"RTN","WVUTL2",1,0)
WVUTL2 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: ZIS, XREF, PROSCREEN; ;9/1/98  11:37
"RTN","WVUTL2",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL2",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL2",4,0)
 ;;  UTILITY: ZIS, MUMPS XREFS ON NORMAL/ABNORMAL AND ON STATUS.
"RTN","WVUTL2",5,0)
 ;;  PROCSCRN-SCREEN ON RESULT/DIAGNOSIS BASED ON PROCEDURE.
"RTN","WVUTL2",6,0)
 ;
"RTN","WVUTL2",7,0)
 ;
"RTN","WVUTL2",8,0)
ZIS(WVPOP,WVQUE,WVDEF,WVPRMPT,WVMES) ;EP
"RTN","WVUTL2",9,0)
 ;---> CALL TO ^%ZIS
"RTN","WVUTL2",10,0)
 ;---> PARAMETERS:
"RTN","WVUTL2",11,0)
D ;     1 - WVPOP         (RETURNED) WVPOP=1 IF POP=1 (FAIL OR QUIT).
"RTN","WVUTL2",12,0)
 ;     2 - WVQUE=1       (OPTIONAL) SET=1 IF JOB SHOULD WV QUEUEABLE.
"RTN","WVUTL2",13,0)
 ;     3 - WVDEF=DEFAULT (OPTIONAL) IF EXISTS, EQUALS DEFAULT DEVICE.
"RTN","WVUTL2",14,0)
 ;     4 - WVPRMPT       (OPTIONAL) IF EXISTS, EQUALS PROMPT.
"RTN","WVUTL2",15,0)
 ;     5 - WVMES         (OPTIONAL) A MESSAGE TO DISPLAY IF QUEUED.
"RTN","WVUTL2",16,0)
 ;
"RTN","WVUTL2",17,0)
 ;---> EXAMPLE: D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVUTL2",18,0)
 ;
"RTN","WVUTL2",19,0)
ZIS1 ;EP FOR LOOP BACK FROM FAILED WVQUE.
"RTN","WVUTL2",20,0)
 S WVPOP=0
"RTN","WVUTL2",21,0)
 ;
"RTN","WVUTL2",22,0)
 ;---> WVPRMPT=WVPRMPT.
"RTN","WVUTL2",23,0)
 S %ZIS("A")=$S($D(WVPRMPT):WVPRMPT,1:"   Select DEVICE: ")
"RTN","WVUTL2",24,0)
 ;
"RTN","WVUTL2",25,0)
 ;---> WVDEF=DEFAULT PRINTER.
"RTN","WVUTL2",26,0)
 ;---> IF NO WVDEF, SET WVDEF="P" FOR CLOSEST PRINTER.
"RTN","WVUTL2",27,0)
 D
"RTN","WVUTL2",28,0)
 .I '$D(WVDEF) S %ZIS="P" Q
"RTN","WVUTL2",29,0)
 .S %ZIS("B")=WVDEF,%ZIS=""
"RTN","WVUTL2",30,0)
 ;
"RTN","WVUTL2",31,0)
 ;---> IF WVQUE=1,JOB MAY BE QUEUED.
"RTN","WVUTL2",32,0)
 I $G(WVQUE)]"" I WVQUE S %ZIS=%ZIS_"Q"
"RTN","WVUTL2",33,0)
 ;
"RTN","WVUTL2",34,0)
 W ! D ^%ZIS S:POP WVPOP=1
"RTN","WVUTL2",35,0)
 ;---> QUIT IF WVPOP (DUOUT OR DTOUT) OR IF NOT WVQUED.
"RTN","WVUTL2",36,0)
 G:WVPOP!('$D(IO("Q"))) ZISEXIT
"RTN","WVUTL2",37,0)
 ;
"RTN","WVUTL2",38,0)
 I IO=IO(0) W !?5,"Cannot queue to screen or slave printer!",! G ZIS1
"RTN","WVUTL2",39,0)
 ;
"RTN","WVUTL2",40,0)
 ;---> NEXT LINE: LINE LABEL "ZISQ" ADDED FOR ENTRY WHERE DEVICE
"RTN","WVUTL2",41,0)
 ;---> INFO HAS ALREADY BEEN ASKED AND USER WVQUED OUTPUT.
"RTN","WVUTL2",42,0)
ZISQ ;EP
"RTN","WVUTL2",43,0)
 ;---> NEXT LINES: JOB WAS QUEUED, THEREFORE SET WVPOP=1 SO THAT THE
"RTN","WVUTL2",44,0)
 ;---> CALLING ROUTINE WILL QUIT (AND LET TASKMAN FINISH THIS JOB).
"RTN","WVUTL2",45,0)
 S WVPOP=1
"RTN","WVUTL2",46,0)
 I '$D(ZTRTN) D  G ZISEXIT
"RTN","WVUTL2",47,0)
 .W !?5,*7,"NO ROUTINE NAMED FOR QUEUEING -- CONTACT PROGRAMMER."
"RTN","WVUTL2",48,0)
 I '$D(ZTDESC) S ZTDESC=ZTRTN
"RTN","WVUTL2",49,0)
 S WVMES=$S($D(WVMES):WVMES,1:"W !?5,""Request Queued."",!")
"RTN","WVUTL2",50,0)
 ;
"RTN","WVUTL2",51,0)
 S ZTIO=$S($D(ION):ION,1:"")
"RTN","WVUTL2",52,0)
 I ZTIO]"" D
"RTN","WVUTL2",53,0)
 .I $D(IO("DOC")) S ZTIO=ZTIO_";"_IOST_";"_IO("DOC") Q
"RTN","WVUTL2",54,0)
 .S ZTIO=ZTIO_";"_IOST_";"_IOM_";"_IOSL
"RTN","WVUTL2",55,0)
 S ZTDTH=$H
"RTN","WVUTL2",56,0)
 D ^%ZTLOAD,^%ZISC
"RTN","WVUTL2",57,0)
 ;---> SET WVPOP=1 TO TELL CALLING ROUTINE TO QUIT (LET TASKMAN FINISH).
"RTN","WVUTL2",58,0)
 S WVPOP=1
"RTN","WVUTL2",59,0)
 X:$D(ZTSK) WVMES H 2
"RTN","WVUTL2",60,0)
 ;
"RTN","WVUTL2",61,0)
ZISEXIT ;EP
"RTN","WVUTL2",62,0)
 K WVMES,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK
"RTN","WVUTL2",63,0)
 Q
"RTN","WVUTL2",64,0)
 ;
"RTN","WVUTL2",65,0)
 ;
"RTN","WVUTL2",66,0)
XREFP05 ;EP
"RTN","WVUTL2",67,0)
 ;---> CALLED BY MUMPS "ABNML" XREF ON FIELD .05 IN FILE 790.1.
"RTN","WVUTL2",68,0)
 ;---> REINDEX RESULTS FIELD .05 IN WV PROCEDURE FILE, BY DATE
"RTN","WVUTL2",69,0)
 ;---> (PIECE 12), WHEN RESULT/DIAGNOSIS IS "ABNORMAL" (AS STORED IN
"RTN","WVUTL2",70,0)
 ;---> PIECE 21 OF THE POINTED TO WV RESULTS/DIAGNOSIS ENTRY).
"RTN","WVUTL2",71,0)
 ;---> X=IEN WV RESULT/DIAGNOSIS, DA=ENTRY IN WV PROCEDURE FILE.
"RTN","WVUTL2",72,0)
 Q:'$P(^WV(790.1,DA,0),U,12)
"RTN","WVUTL2",73,0)
 I $P(^WV(790.31,X,0),U,21) S ^WV(790.1,"ABNML",$P(^WV(790.1,DA,0),U,12),DA)="" Q
"RTN","WVUTL2",74,0)
 K ^WV(790.1,"ABNML",$P(^WV(790.1,DA,0),U,12),DA)
"RTN","WVUTL2",75,0)
 Q
"RTN","WVUTL2",76,0)
 ;
"RTN","WVUTL2",77,0)
XREFP12 ;EP
"RTN","WVUTL2",78,0)
 ;---> CALLED BY MUMPS "ABNML1" XREF ON FIELD .12 IN FILE 790.1.
"RTN","WVUTL2",79,0)
 ;---> LOGIC TO REINDEX RESULTS FIELD .05 IN WV PROCEDURE FILE WHEN
"RTN","WVUTL2",80,0)
 ;---> DATE OF PROCEDURE .12 FIELD IS CHANGED.  X=NEWDATE, DA=ENTRY.
"RTN","WVUTL2",81,0)
 ;---> SEE XREFP05 ABOVE.
"RTN","WVUTL2",82,0)
 I '$P(^WV(790.1,DA,0),U,5) S ^WV(790.1,"ABNML",X,DA)="" Q
"RTN","WVUTL2",83,0)
 I $P(^WV(790.31,$P(^WV(790.1,DA,0),U,5),0),U,21) S ^WV(790.1,"ABNML",X,DA)="" Q
"RTN","WVUTL2",84,0)
 K ^WV(790.1,"ABNML",X,DA)
"RTN","WVUTL2",85,0)
 Q
"RTN","WVUTL2",86,0)
 ;
"RTN","WVUTL2",87,0)
REXREFN ;EP
"RTN","WVUTL2",88,0)
 ;---> CALLED BY MUMPS XREF ON FIELD .02 IN FILE 790.4.
"RTN","WVUTL2",89,0)
 ;---> LOGIC TO REINDEX STATUS FIELD .14 IN WV NOTIFICATION FILE
"RTN","WVUTL2",90,0)
 ;---> WHEN DATE NOTIFICATION OPENED .02 FIELD IS CHANGED.
"RTN","WVUTL2",91,0)
 ;---> X=NEWDATE, DA=ENTRY.
"RTN","WVUTL2",92,0)
 ;---> NOTE: IF STATUS IS NULL XREF FOR "AOPEN" GETS SET HERE.
"RTN","WVUTL2",93,0)
 I $P(^WV(790.4,DA,0),U,2) K ^WV(790.4,"AOPEN",$P(^(0),U,2),DA)
"RTN","WVUTL2",94,0)
 I "o"[$P(^WV(790.4,DA,0),U,14) S ^WV(790.4,"AOPEN",X,DA)=""
"RTN","WVUTL2",95,0)
 Q
"RTN","WVUTL2",96,0)
 ;
"RTN","WVUTL2",97,0)
 ;
"RTN","WVUTL2",98,0)
PROCSCRN ;EP
"RTN","WVUTL2",99,0)
 ;---> SCREEN WHEN SELECTING RESULTS/DIAGNOSIS FOR PROCEDURES.
"RTN","WVUTL2",100,0)
 ;---> CALLED BY DIC("S")="D PROCSCRN^WVUTL2" IN SCREEN FOR SEVERAL
"RTN","WVUTL2",101,0)
 ;---> FIELDS IN WV PROCEDURE FILE.
"RTN","WVUTL2",102,0)
 ;---> REQUIRED VARIABLES: WVPN=IEN OF PROCEDURE TYPE
"RTN","WVUTL2",103,0)
 ;--->                        Y=IEN OF RES/DIAG BEING SCREENED
"RTN","WVUTL2",104,0)
 ;---> EACH LINE MAKES THE RES/DIAG AVAILABLE FOR SELECTION IF:
"RTN","WVUTL2",105,0)
 ;---> 1ST LINE: IF SCREEN VARIABLES ARE UNDEFINED (IE, ALL SELECTABLE).
"RTN","WVUTL2",106,0)
 ;---> 2ND LINE: IF RES/DIAG IS FOR ALL & THIS PROCEDURE IS NOT EXCLUDED
"RTN","WVUTL2",107,0)
 ;---> 3RD LINE: IF A "P" XREF FOR THIS PROCEDURE AND RES/DIAG EXISTS.
"RTN","WVUTL2",108,0)
 ;---> 4TH LINE: OTHERWISE RES/DIAG FAILS SCREEN AND IS NOT SELECTABLE.
"RTN","WVUTL2",109,0)
 Q:'$D(WVPN)!('$D(Y))
"RTN","WVUTL2",110,0)
 Q:$P(^WV(790.31,Y,0),U,20)
"RTN","WVUTL2",111,0)
 Q:$D(^WV(790.31,"P",WVPN,Y))
"RTN","WVUTL2",112,0)
 I 0
"RTN","WVUTL2",113,0)
 Q
"RTN","WVUTL2",114,0)
 ;
"RTN","WVUTL2",115,0)
PAPSCRN ;EP
"RTN","WVUTL2",116,0)
 ;---> SCREEN CALLED BY FILEMAN ^DD(790.1,.3
"RTN","WVUTL2",117,0)
 ;---> SCREEN WHEN SELECTING THE PAP THAT INITIATED THIS COLPOSCOPY.
"RTN","WVUTL2",118,0)
 ;---> CALLED BY DIC("S")="D PAPSCRN^WVUTL2" IN FIELD .3 OF
"RTN","WVUTL2",119,0)
 ;---> WV PROCEDURE FILE: FIRST CHECK IF THE PROCEDURE IS FOR THIS
"RTN","WVUTL2",120,0)
 ;---> PATIENT, THEN MAKE SURE IT'S A PAP.
"RTN","WVUTL2",121,0)
 Q:$P(^(0),U,2)=WVDFN&($P(^(0),U,4)=1)
"RTN","WVUTL2",122,0)
 I 0
"RTN","WVUTL2",123,0)
 Q
"RTN","WVUTL2",124,0)
 ;
"RTN","WVUTL3")
0^57^B28285559
"RTN","WVUTL3",1,0)
WVUTL3 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: DATE, LOCK, DIR, PATVARS; ;8/11/98  09:23
"RTN","WVUTL3",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL3",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL3",4,0)
 ;;  UTILITY: ASK DATE RANGE, LOCKS, DIR PROMPTS, STORE/DEL EDC,
"RTN","WVUTL3",5,0)
 ;;  STORE PAP REGIMEN, PCDVARS & PATVARS.
"RTN","WVUTL3",6,0)
 ;
"RTN","WVUTL3",7,0)
 ;
"RTN","WVUTL3",8,0)
OUT ;EP
"RTN","WVUTL3",9,0)
 ;---> CALLED AFTER ERROR MESSAGES ARE DISPLAYED.
"RTN","WVUTL3",10,0)
 S WVPOP=1 D DIRZ
"RTN","WVUTL3",11,0)
 Q
"RTN","WVUTL3",12,0)
 ;
"RTN","WVUTL3",13,0)
ASKDATES(WVB,WVE,WVPOP,WVBDF,WVEDF,WVSAME,WVTIME) ;EP
"RTN","WVUTL3",14,0)
 ;---> ASK DATE RANGE.
"RTN","WVUTL3",15,0)
 ;---> PARAMETERS:
"RTN","WVUTL3",16,0)
 ;     1 - WVB    (RETURNED) BEGIN DATE, FILEMAN FORMAT
"RTN","WVUTL3",17,0)
 ;     2 - WVE    (RETURNED) END DATE, FILEMAN FORMAT
"RTN","WVUTL3",18,0)
 ;     3 - WVPOP  (RETURNED) WVPOP=1 IF QUIT,FAIL,DTOUT,DUOUT
"RTN","WVUTL3",19,0)
 ;     4 - WVBDF  (OPTIONAL) BEGIN DATE DEFAULT, FILEMAN FORMAT
"RTN","WVUTL3",20,0)
 ;     5 - WVEDF  (OPTIONAL) END DATE DEFAULT, FILEMAN FORMAT
"RTN","WVUTL3",21,0)
 ;     6 - WVSAME (OPTIONAL) FORCE END DATE DEFAULT=BEGIN DATE
"RTN","WVUTL3",22,0)
 ;     7 - WVTIME (OPTIONAL) ASK TIMES
"RTN","WVUTL3",23,0)
 ;
"RTN","WVUTL3",24,0)
 ;---> EXAMPLE:
"RTN","WVUTL3",25,0)
 ;        D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP,"T-365","T")
"RTN","WVUTL3",26,0)
 ;
"RTN","WVUTL3",27,0)
 S WVPOP=0 N %DT,Y
"RTN","WVUTL3",28,0)
 W !!,"   *** Date Range Selection ***"
"RTN","WVUTL3",29,0)
 S %DT="APEX"_$S($D(WVTIME):"T",1:"")
"RTN","WVUTL3",30,0)
 S %DT("A")="   Begin with DATE: "
"RTN","WVUTL3",31,0)
 I $G(WVBDF)]"" S Y=WVBDF D DD^%DT S %DT("B")=Y
"RTN","WVUTL3",32,0)
 D ^%DT K %DT
"RTN","WVUTL3",33,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVUTL3",34,0)
 S (%DT(0),WVB)=Y K %DT("B")
"RTN","WVUTL3",35,0)
 S %DT="APEX"_$S($D(WVTIME):"T",1:"")
"RTN","WVUTL3",36,0)
 S %DT("A")="   End with DATE:   "
"RTN","WVUTL3",37,0)
 I $G(WVEDF)]"" S Y=WVEDF D DD^%DT S %DT("B")=Y
"RTN","WVUTL3",38,0)
 I $D(WVSAME) S Y=WVB D DD^%DT S %DT("B")=Y
"RTN","WVUTL3",39,0)
 D ^%DT K %DT
"RTN","WVUTL3",40,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVUTL3",41,0)
 S WVE=Y
"RTN","WVUTL3",42,0)
 Q
"RTN","WVUTL3",43,0)
 ;
"RTN","WVUTL3",44,0)
LOCKED ;EP
"RTN","WVUTL3",45,0)
 Q:$D(ZTQUEUED)  ;quit if called from a background (tasked) job.
"RTN","WVUTL3",46,0)
 W !?5,"Another user is editing this entry.  Please, try again later."
"RTN","WVUTL3",47,0)
 D DIRZ
"RTN","WVUTL3",48,0)
 Q
"RTN","WVUTL3",49,0)
 ;
"RTN","WVUTL3",50,0)
LOCKEDE ;EP
"RTN","WVUTL3",51,0)
 ;---> LOCKED PREGNANCY LOG ENTRY.
"RTN","WVUTL3",52,0)
 W !?5,"Another user is editing the Pregnancy Log for this patient"
"RTN","WVUTL3",53,0)
 W !?5,"for this day.  Please, try again later."
"RTN","WVUTL3",54,0)
 D DIRZ
"RTN","WVUTL3",55,0)
 Q
"RTN","WVUTL3",56,0)
 ;
"RTN","WVUTL3",57,0)
LOCKEDP ;EP
"RTN","WVUTL3",58,0)
 ;---> LOCKED PAP Regimen Log ENTRY.
"RTN","WVUTL3",59,0)
 W !?5,"Another user is editing the PAP Regimen Log for this patient"
"RTN","WVUTL3",60,0)
 W !?5,"for this day.  Please, try again later."
"RTN","WVUTL3",61,0)
 D DIRZ
"RTN","WVUTL3",62,0)
 Q
"RTN","WVUTL3",63,0)
 ;
"RTN","WVUTL3",64,0)
 ;
"RTN","WVUTL3",65,0)
DIRZ ;EP
"RTN","WVUTL3",66,0)
 ;---> PRESS RETURN TO CONTINUE.
"RTN","WVUTL3",67,0)
 N DIR,DIRUT,X,Y
"RTN","WVUTL3",68,0)
 I $D(WVPRMT) S DIR("A")=WVPRMT
"RTN","WVUTL3",69,0)
 I $D(WVPRMT1) S DIR("A",1)=WVPRMT1
"RTN","WVUTL3",70,0)
 I $D(WVPRMT2) S DIR("A",2)=WVPRMT2
"RTN","WVUTL3",71,0)
 I $D(WVPRMTQ) S DIR("?")=WVPRMTQ
"RTN","WVUTL3",72,0)
 S DIR(0)="E" W ! D ^DIR W !
"RTN","WVUTL3",73,0)
 S WVPOP=$S($D(DIRUT):1,Y<1:1,1:0)
"RTN","WVUTL3",74,0)
 Q
"RTN","WVUTL3",75,0)
 ;
"RTN","WVUTL3",76,0)
DIRPRMT ;EP
"RTN","WVUTL3",77,0)
 ;---> REQUIRED VARIABLE: WVPROMPT,M (M=LAST SELECTION# DISPLAYED)
"RTN","WVUTL3",78,0)
 ;---> OPTIONAL VARIABLE: WVCODE (EXECUTABLE CODE ACTING ON INPUT X)
"RTN","WVUTL3",79,0)
 ;---> WVD=1 IF RANGE OF SELECTION NUMBERS SHOULD BE DISPLAYED.
"RTN","WVUTL3",80,0)
 N DIR,DIRUT,Y
"RTN","WVUTL3",81,0)
 W ! S:'$D(WVD) WVD=0
"RTN","WVUTL3",82,0)
 S DIR(0)="LO^"_$S(WVD:":"_M,1:"1:"_M)
"RTN","WVUTL3",83,0)
 I $D(WVPRMT) S DIR("A")=WVPRMT
"RTN","WVUTL3",84,0)
 I $D(WVPRMT1) S DIR("A",1)=WVPRMT1
"RTN","WVUTL3",85,0)
 I $D(WVPRMT2) S DIR("A",2)=WVPRMT2
"RTN","WVUTL3",86,0)
 I $D(WVPRMTQ) S DIR("?")=WVPRMTQ
"RTN","WVUTL3",87,0)
 I $D(WVCODE) S DIR(0)=DIR(0)_U_WVCODE
"RTN","WVUTL3",88,0)
 D ^DIR
"RTN","WVUTL3",89,0)
 S:$D(DTOUT)!($D(DUOUT)) WVPOP=1
"RTN","WVUTL3",90,0)
 Q
"RTN","WVUTL3",91,0)
 ;
"RTN","WVUTL3",92,0)
STOREDC ;EP
"RTN","WVUTL3",93,0)
 ;---> STORE PREGNANCY AND EDC, CALLED BY MUMPS XREF ON FIELDS #.13
"RTN","WVUTL3",94,0)
 ;---> AND #.14 IN WV PATIENT FILE.  NOTE: WHEN AN EDIT IS DONE,
"RTN","WVUTL3",95,0)
 ;---> FIRST KILL AND THEN SET LOGIC OF THE MUMPS XREF IS EXECUTED;
"RTN","WVUTL3",96,0)
 ;---> BUT FOR A DELETE (@), ONLY THE KILL LOGIC IS EXECUTED.
"RTN","WVUTL3",97,0)
 ;---> REQUIRED VARIABLES: WVDFN, WVPREG=PREGNANT(1=YES,0=NO), WVEDC=EDC
"RTN","WVUTL3",98,0)
 Q:'$D(WVEDC)!('$D(WVPREG))!('$D(WVDFN))
"RTN","WVUTL3",99,0)
 Q:'WVDFN
"RTN","WVUTL3",100,0)
 N DA,DIC,DIE,DG,DLAYGO,DR,N,WVQUIT,X
"RTN","WVUTL3",101,0)
 D SETVARS^WVUTL5
"RTN","WVUTL3",102,0)
 S WVQUIT=0,DLAYGO=790
"RTN","WVUTL3",103,0)
 I WVPREG="" D DELETEDC Q
"RTN","WVUTL3",104,0)
 S:WVPREG=0 WVEDC=0
"RTN","WVUTL3",105,0)
 S DIE="^WV(790.05,",DR=".03////"_WVPREG_";.04////"_+WVEDC
"RTN","WVUTL3",106,0)
 S N=0
"RTN","WVUTL3",107,0)
 F  S N=$O(^WV(790.05,"C",WVDFN,N)) Q:'N  D
"RTN","WVUTL3",108,0)
 .I $D(^WV(790.05,"B",DT,N)) S DA=N D
"RTN","WVUTL3",109,0)
 ..L +^WV(790.05,DA):0 I '$T D LOCKEDE S WVQUIT=1 Q
"RTN","WVUTL3",110,0)
 ..D DIE^WVFMAN(790.05,DR,DA) L -^WV(790.05,DA) S WVQUIT=1
"RTN","WVUTL3",111,0)
 Q:WVQUIT
"RTN","WVUTL3",112,0)
 ;
"RTN","WVUTL3",113,0)
 K DD,DO
"RTN","WVUTL3",114,0)
 S DIC="^WV(790.05,",DIC(0)="L",X=DT,DLAYGO=790
"RTN","WVUTL3",115,0)
 S DIC("DR")=".02////"_WVDFN_";.03////"_WVPREG_";.04////"_+WVEDC
"RTN","WVUTL3",116,0)
 D FILE^DICN
"RTN","WVUTL3",117,0)
 Q
"RTN","WVUTL3",118,0)
 ;
"RTN","WVUTL3",119,0)
DELETEDC ;EP
"RTN","WVUTL3",120,0)
 ;---> DELETE PREGANCY LOG ENTRY FOR THIS DAY (DT).
"RTN","WVUTL3",121,0)
 S DIK="^WV(790.05,"
"RTN","WVUTL3",122,0)
 S N=0
"RTN","WVUTL3",123,0)
 F  S N=$O(^WV(790.05,"C",WVDFN,N)) Q:'N  D
"RTN","WVUTL3",124,0)
 .I $D(^WV(790.05,"B",DT,N)) S DA=N D ^DIK
"RTN","WVUTL3",125,0)
 Q
"RTN","WVUTL3",126,0)
 ;
"RTN","WVUTL3",127,0)
STORPAP ;EP
"RTN","WVUTL3",128,0)
 ;---> STORE PAP REGIMEN, START DATE AND DATE ENTERED; CALLED BY
"RTN","WVUTL3",129,0)
 ;---> MUMPS XREF ON FIELDS #.16 AND #.17 IN WV PATIENT FILE.
"RTN","WVUTL3",130,0)
 ;---> REQUIRED VARIABLES: WVLDAT=BEGIN DATE, WVLPRG=PAP REGIMEN, WVDFN.
"RTN","WVUTL3",131,0)
 Q:'$D(WVLDAT)!('$D(WVLPRG))!('$D(WVDFN))
"RTN","WVUTL3",132,0)
 Q:'WVLDAT!('WVLPRG)!('WVDFN)
"RTN","WVUTL3",133,0)
 N DA,DIC,DIE,DLAYGO,DR,N,WVQUIT,X,DG
"RTN","WVUTL3",134,0)
 D SETVARS^WVUTL5
"RTN","WVUTL3",135,0)
 S WVQUIT=0,DLAYGO=790
"RTN","WVUTL3",136,0)
 S DIE="^WV(790.04,"
"RTN","WVUTL3",137,0)
 S DR=".01////"_WVLDAT_";.03////"_WVLPRG
"RTN","WVUTL3",138,0)
 S N=0
"RTN","WVUTL3",139,0)
 F  S N=$O(^WV(790.04,"C",WVDFN,N)) Q:'N!(WVQUIT)  D
"RTN","WVUTL3",140,0)
 .I $D(^WV(790.04,"B",WVLDAT,N)) S DA=N D
"RTN","WVUTL3",141,0)
 ..L +^WV(790.04,DA):0 I '$T D LOCKEDP S WVQUIT=1 Q
"RTN","WVUTL3",142,0)
 ..D DIE^WVFMAN(790.04,DR,DA,.WVPOP) L -^WV(790.04,DA) S WVQUIT=1
"RTN","WVUTL3",143,0)
 Q:WVQUIT
"RTN","WVUTL3",144,0)
 ;
"RTN","WVUTL3",145,0)
 K DD,DO
"RTN","WVUTL3",146,0)
 S DIC="^WV(790.04,",DIC(0)="L",X=WVLDAT,DLAYGO=790
"RTN","WVUTL3",147,0)
 S DIC("DR")=".02////"_WVDFN_";.03////"_WVLPRG
"RTN","WVUTL3",148,0)
 D FILE^DICN
"RTN","WVUTL3",149,0)
 Q
"RTN","WVUTL3",150,0)
 ;
"RTN","WVUTL3",151,0)
 ;
"RTN","WVUTL3",152,0)
PCDVARS(DA,TEXTDATE,COLP) ;EP
"RTN","WVUTL3",153,0)
 ;---> SET VARIABLES FOR PROCEDURE DATA FOR HEADERS.
"RTN","WVUTL3",154,0)
 ;---> REQUIRED VARIABLES: DA=IEN OF PROCEDURE IN PROC FILE 790.1.
"RTN","WVUTL3",155,0)
 ;--->               TEXTDATE=1 PROVIDE DATE IN TEXT FORMAT,
"RTN","WVUTL3",156,0)
 ;--->                          OTHERWISE IN NUMERIC FORMAT (1/1/95)
"RTN","WVUTL3",157,0)
 ;--->                   COLP=1 TO SET WVC0=ASSOC'D COLP IF THIS IS
"RTN","WVUTL3",158,0)
 ;--->                          A PAP.
"RTN","WVUTL3",159,0)
 ;---> Y=ZERO NODE OF PROCEDURE, WVACCN=ACCESSION#,
"RTN","WVUTL3",160,0)
 ;---> WVPCDN=IEN OF PROCEDURE TYPE,
"RTN","WVUTL3",161,0)
 ;---> WVRESN=IEN OF RESULT/DIAG,WVRES=TEXT OF RESULT/DIAG
"RTN","WVUTL3",162,0)
 ;---> WVPN=PROCEDURE TYPE, WVDFN=DFN OF PATIENT.
"RTN","WVUTL3",163,0)
 ;---> WV0=ZERO NODE OF THIS PROCEDURE, WV2=TWO NODE.
"RTN","WVUTL3",164,0)
 ;---> WVPAP=1=PCD IS A PAP, WVMAM=1=PCD IS A SCREENING MAM.
"RTN","WVUTL3",165,0)
 ;---> WVC0=ZERO NODE OF ASSOCIATED COLP (IF THIS IS A PAP).
"RTN","WVUTL3",166,0)
 ;
"RTN","WVUTL3",167,0)
 N X,Y S (WV0,Y)=^WV(790.1,DA,0),WVC0=""
"RTN","WVUTL3",168,0)
 S WV2=$S($D(^WV(790.1,DA,2)):^(2),1:"")
"RTN","WVUTL3",169,0)
 S COLP=$G(COLP) S:COLP WVC0=$$COLP0^WVUTL4(DA)
"RTN","WVUTL3",170,0)
 S TEXTDATE=$G(TEXTDATE)
"RTN","WVUTL3",171,0)
 S WVACCN=$$ACC^WVUTL1(DA)
"RTN","WVUTL3",172,0)
 S WVPCDN=$P(Y,U,4)
"RTN","WVUTL3",173,0)
 S X=DA,WVPN=$$PROC^WVUTL1A
"RTN","WVUTL3",174,0)
 S WVRESN=$P(Y,U,5),WVRES=$$DIAG^WVUTL4(WVRESN)
"RTN","WVUTL3",175,0)
 S X=$P(Y,U,7),WVPROV=$$PROV^WVUTL6
"RTN","WVUTL3",176,0)
 S WVDFN=$P(Y,U,2) D PATVARS(WVDFN,TEXTDATE)
"RTN","WVUTL3",177,0)
 S (WVMAM,WVPAP)=0
"RTN","WVUTL3",178,0)
 S:WVPCDN=28 WVMAM=1 S:WVPCDN=1 WVPAP=1
"RTN","WVUTL3",179,0)
 Q
"RTN","WVUTL3",180,0)
 ;
"RTN","WVUTL3",181,0)
PATVARS(DFN,TEXTDATE) ;EP
"RTN","WVUTL3",182,0)
 ;---> SET VARIABLES FO PATIENT DATA FOR HEADERS.
"RTN","WVUTL3",183,0)
 ;---> REQUIRED VARIABLES: WVDFN=IEN OF PATIENT
"RTN","WVUTL3",184,0)
 ;---> YIELDS: WVNAME=PATIENT NAME, WVCHRT=SSN#
"RTN","WVUTL3",185,0)
 ;---> WVCMGR=CASE MANAGER, WVCNEED=CX TX NEED,
"RTN","WVUTL3",186,0)
 ;---> WVPAPRG=PAP REGIMEN, WVBNEED=BR TX NEED, WVEDC=EDC.
"RTN","WVUTL3",187,0)
 S TEXTDATE=$G(TEXTDATE)
"RTN","WVUTL3",188,0)
 S WVNAME=$$NAME^WVUTL1(DFN)
"RTN","WVUTL3",189,0)
 S WVNAMAGE=$$NAMAGE^WVUTL1(DFN)
"RTN","WVUTL3",190,0)
 S WVCHRT=$$SSN^WVUTL1(DFN)
"RTN","WVUTL3",191,0)
 S WVCMGR=$$CMGR^WVUTL1(DFN)
"RTN","WVUTL3",192,0)
 S WVCNEED=$$CNEED^WVUTL1(DFN,TEXTDATE)
"RTN","WVUTL3",193,0)
 S WVPAPRG=$$PAPRG^WVUTL1(DFN,TEXTDATE)
"RTN","WVUTL3",194,0)
 S WVBNEED=$$BNEED^WVUTL1(DFN,TEXTDATE)
"RTN","WVUTL3",195,0)
 S WVEDC=$$EDC^WVUTL1(DFN)
"RTN","WVUTL3",196,0)
 Q
"RTN","WVUTL4")
0^58^B11446375
"RTN","WVUTL4",1,0)
WVUTL4 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: DATE DEFAULTS, OTH VALUES; ;7/16/98  09:44
"RTN","WVUTL4",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL4",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL4",4,0)
 ;;  UTILITY: DEFAULT "COMPLETE BY" DATES FOR NOTIFS AND PROCEDURES,
"RTN","WVUTL4",5,0)
 ;;  STATUS TEXT, DIAG TEXT, NORMAL VALUE, COLP VALUE, MARGIN? VALUE.
"RTN","WVUTL4",6,0)
 ;
"RTN","WVUTL4",7,0)
 ;
"RTN","WVUTL4",8,0)
NDELQ() ;EP
"RTN","WVUTL4",9,0)
 ;---> FOR NOTIFICATIONS:
"RTN","WVUTL4",10,0)
 ;---> COMPUTE DEFAULT "COMPLETE BY (DATE)" - DATE AT WHICH A
"RTN","WVUTL4",11,0)
 ;---> NOTIFICATION BECOMES DELINQUENT.  CALLED BY WV NOTIF-EDITBLK-1.
"RTN","WVUTL4",12,0)
 ;---> DEFAULT IS CREATED WHEN SCREEN IS FIRST LOADED.
"RTN","WVUTL4",13,0)
 ;---> CODE HERE SETS X=EITHER 1: PRINT DATE (IF PRINTABLE), OR
"RTN","WVUTL4",14,0)
 ;--->                         2: DATE NOTIFICATION OPENED, OR
"RTN","WVUTL4",15,0)
 ;--->                         3: TODAY'S DATE
"RTN","WVUTL4",16,0)
 ;---> THEN $$NDELQ1() IS CALLED TO ADD 30 DAYS UNTIL DELINQUENT.
"RTN","WVUTL4",17,0)
 ;---> REQUIRED VARIABLE: DA (IEN OF NOTIFICATION).
"RTN","WVUTL4",18,0)
 N X
"RTN","WVUTL4",19,0)
 Q:'$D(DA) ""
"RTN","WVUTL4",20,0)
 Q:'DA ""
"RTN","WVUTL4",21,0)
 Q:'$D(^WV(790.4,DA,0)) ""
"RTN","WVUTL4",22,0)
 S X=$P(^WV(790.4,DA,0),U,11)
"RTN","WVUTL4",23,0)
 S:'X X=$P(^WV(790.4,DA,0),U,2)
"RTN","WVUTL4",24,0)
 S:'X X=DT
"RTN","WVUTL4",25,0)
 Q $$NDELQ1
"RTN","WVUTL4",26,0)
 ;
"RTN","WVUTL4",27,0)
NDELQ1() ;EP
"RTN","WVUTL4",28,0)
 ;---> FOR NOTIFICATIONS:
"RTN","WVUTL4",29,0)
 ;---> COMPUTE "COMPLETE BY (DATE)".  CALLED BY UPDATE/EDIT OF
"RTN","WVUTL4",30,0)
 ;---> "PRINT DATE:" IN WV NOTIF-EDITBLK-1.
"RTN","WVUTL4",31,0)
 ;---> X1=EITHER NEW PRINT DATE, OR DATE NOTIF OPENED, OR TODAY.
"RTN","WVUTL4",32,0)
 ;---> X2=30 DAYS ADDED TILL NOTIFICATION BECOMES DELINQUENT.
"RTN","WVUTL4",33,0)
 ;---> REQUIRED VARIABLE: X=PRINT DATE, OR DATE OPENED, OR TODAY.
"RTN","WVUTL4",34,0)
 N %H,X1,X2
"RTN","WVUTL4",35,0)
 Q:'$D(X) ""
"RTN","WVUTL4",36,0)
 Q:'X ""
"RTN","WVUTL4",37,0)
 S X1=X,X2=30
"RTN","WVUTL4",38,0)
 D C^%DTC
"RTN","WVUTL4",39,0)
 Q X
"RTN","WVUTL4",40,0)
 ;
"RTN","WVUTL4",41,0)
PDELQ(DA,DUZ2) ;EP
"RTN","WVUTL4",42,0)
 ;---> FOR PROCEDURES:
"RTN","WVUTL4",43,0)
 ;---> COMPUTE DEFAULT "COMPLETE BY (DATE)" - DATE AT WHICH A
"RTN","WVUTL4",44,0)
 ;---> PROCEDURE BECOMES DELINQUENT.  CALLED BY WV PROC-EDITBLK-1.
"RTN","WVUTL4",45,0)
 ;---> DEFAULT IS CREATED WHEN SCREEN IS FIRST LOADED.
"RTN","WVUTL4",46,0)
 ;---> CODE HERE FIRST RETRIEVES STORED DATE OF PROCEDURE, THEN CALLS
"RTN","WVUTL4",47,0)
 ;---> $$DELQ1 TO COMPUTE "COMPLETE BY (DATE)".
"RTN","WVUTL4",48,0)
 ;---> REQUIRED VARIABLE: DA (IEN OF PROCEDURE), DUZ2=DUZ(2).
"RTN","WVUTL4",49,0)
 Q:'$G(DA)!('$G(DUZ2)) ""
"RTN","WVUTL4",50,0)
 Q:'$D(^WV(790.1,DA,0)) ""
"RTN","WVUTL4",51,0)
 Q:'$P(^WV(790.1,DA,0),U,12) ""
"RTN","WVUTL4",52,0)
 Q $$PDELQ1(DA,$P(^WV(790.1,DA,0),U,12),DUZ2)
"RTN","WVUTL4",53,0)
 ;
"RTN","WVUTL4",54,0)
PDELQ1(WVDA,WVDT,WVDUZ2) ;EP
"RTN","WVUTL4",55,0)
 ;---> FOR PROCEDURES:
"RTN","WVUTL4",56,0)
 ;---> COMPUTE "COMPLETE BY (WVDT)".  CALLED BY UPWVDT/EDIT OF
"RTN","WVUTL4",57,0)
 ;---> "WVDT OF PROCEDURE" IN WV PROC-EDITBLK-1.
"RTN","WVUTL4",58,0)
 ;---> X1=WVDT OF PROCEDURE, X2=DEFAULT NUMBER OF WVDAYS THE
"RTN","WVUTL4",59,0)
 ;---> PROCEDURE IS ALLOWED TO REMAIN OPEN BEFORE BECOMING DELINQUENT.
"RTN","WVUTL4",60,0)
 ;---> REQUIRED VARIABLE: WVDA=IEN OF PROCEDURE, WVDT=DATE OF PROCEDURE,
"RTN","WVUTL4",61,0)
 ;--->                    WVDUZ2=DUZ(2).
"RTN","WVUTL4",62,0)
 N %H,X,X1,X2
"RTN","WVUTL4",63,0)
 Q:'$G(WVDA)!('$G(WVDT)) ""
"RTN","WVUTL4",64,0)
 Q:'$D(^WV(790.1,WVDA,0)) ""
"RTN","WVUTL4",65,0)
 S X2=$P(^WV(790.1,WVDA,0),U,4),X1=WVDT
"RTN","WVUTL4",66,0)
 Q:'X2 ""
"RTN","WVUTL4",67,0)
 Q:'$D(^WV(790.02,WVDUZ2,X2)) ""
"RTN","WVUTL4",68,0)
 S X2=$P(^WV(790.02,WVDUZ2,X2),U,3)
"RTN","WVUTL4",69,0)
 D C^%DTC
"RTN","WVUTL4",70,0)
 Q X
"RTN","WVUTL4",71,0)
 ;
"RTN","WVUTL4",72,0)
STATUS() ;EP
"RTN","WVUTL4",73,0)
 ;---> PROVIDES STATUS (OPEN, DELINQUENT, OR CLOSED).
"RTN","WVUTL4",74,0)
 ;---> Y MUST EQUAL ZERO NODE OF NOTIFICATION.
"RTN","WVUTL4",75,0)
 ;---> REQUIRED VARIABLE: Y=ZERO NODE OF PROCEDURE, DT=FFDATE
"RTN","WVUTL4",76,0)
 Q:'$D(Y) "UNKNOWN"
"RTN","WVUTL4",77,0)
 Q:$P(Y,U,14)="c" "CLOSED"
"RTN","WVUTL4",78,0)
 Q:$P(Y,U,13)]""&($P(Y,U,13)<DT) "DELINQ"
"RTN","WVUTL4",79,0)
 Q "OPEN"
"RTN","WVUTL4",80,0)
 ;
"RTN","WVUTL4",81,0)
DIAG(IEN) ;EP
"RTN","WVUTL4",82,0)
 ;---> RETURN TEXT OF RESULT/DIAGNOSIS.
"RTN","WVUTL4",83,0)
 ;---> REQUIRED VARIABLE X=IEN IN WV RESULTS/DIAGNOSIS FILE 790.31.
"RTN","WVUTL4",84,0)
 Q:'$G(IEN) "NOT ENTERED"
"RTN","WVUTL4",85,0)
 Q:'$D(^WV(790.31,IEN,0)) "UNKNOWN POINTER"
"RTN","WVUTL4",86,0)
 Q $P(^WV(790.31,IEN,0),U)
"RTN","WVUTL4",87,0)
 ;
"RTN","WVUTL4",88,0)
PRIOR() ;EP
"RTN","WVUTL4",89,0)
 ;---> PROVIDE PRIORITY FOR THIS RESULT/DIAGNOSIS (DEFAULT=10).
"RTN","WVUTL4",90,0)
 ;---> REQUIRED VARIABLE X=IEN IN WV RESULTS/DIAGNOSIS FILE.
"RTN","WVUTL4",91,0)
 Q:'$D(X)!(X']"") 10
"RTN","WVUTL4",92,0)
 Q:'$D(^WV(790.31,X,0)) 10
"RTN","WVUTL4",93,0)
 Q:'$P(^WV(790.31,X,0),U,2) 10
"RTN","WVUTL4",94,0)
 Q $P(^WV(790.31,X,0),U,2)
"RTN","WVUTL4",95,0)
 ;
"RTN","WVUTL4",96,0)
NORMAL(X) ;EP
"RTN","WVUTL4",97,0)
 ;---> PROVIDE NORMAL/ABNORMAL FOR THIS RESULT/DIAGNOSIS.
"RTN","WVUTL4",98,0)
 ;---> WILL RETURN 0 IF NORMAL, 1 IF ABNORMAL (DEFAULT=1),
"RTN","WVUTL4",99,0)
 ;---> 2 IF NO RESULT (EITHER THE PROCEDURE HAS NO RESULT OR
"RTN","WVUTL4",100,0)
 ;---> THE RESULT/DIAGNOSIS HAS "NO RESULT" FOR FIELD #.21).
"RTN","WVUTL4",101,0)
 ;---> REQUIRED VARIABLE X=IEN IN WV RESULTS/DIAGNOSIS FILE.
"RTN","WVUTL4",102,0)
 Q:'$D(X)!(X']"") 2
"RTN","WVUTL4",103,0)
 Q:'$D(^WV(790.31,X,0)) 2
"RTN","WVUTL4",104,0)
 Q:$P(^WV(790.31,X,0),U,21)="" 2
"RTN","WVUTL4",105,0)
 Q $P(^WV(790.31,X,0),U,21)
"RTN","WVUTL4",106,0)
 ;
"RTN","WVUTL4",107,0)
COLP(DA) ;EP
"RTN","WVUTL4",108,0)
 ;---> DETERMINE WHETHER OR NOT THE CURRENT PROCEDURE REQUIRES
"RTN","WVUTL4",109,0)
 ;---> PAGE 2 OF PROCEDURE EDIT SCREENS FOR COLPOSCOPY RESULTS.
"RTN","WVUTL4",110,0)
 ;---> RETURNS 1 IF COLP-TYPE RESULTS, OTHERWISE 0.
"RTN","WVUTL4",111,0)
 ;---> DA=IEN OF PROCEDURE IN PROC FILE #790.1.
"RTN","WVUTL4",112,0)
 N Y
"RTN","WVUTL4",113,0)
 Q:'$G(DA) 0
"RTN","WVUTL4",114,0)
 Q:'$D(^WV(790.1,DA,0)) 0
"RTN","WVUTL4",115,0)
 S Y=$P(^WV(790.1,DA,0),U,4)
"RTN","WVUTL4",116,0)
 Q:'Y 0
"RTN","WVUTL4",117,0)
 Q:'$D(^WV(790.2,Y,0)) 0
"RTN","WVUTL4",118,0)
 Q:$P(^WV(790.2,Y,0),U,3)<1 0
"RTN","WVUTL4",119,0)
 Q 1
"RTN","WVUTL4",120,0)
 ;
"RTN","WVUTL4",121,0)
COLPA(DA) ;EP
"RTN","WVUTL4",122,0)
 ;---> LOOK FOR ASSOCIATED COLPOSCOPY, RETURN ITS ACC# AND DATE.
"RTN","WVUTL4",123,0)
 N X,Y
"RTN","WVUTL4",124,0)
 Q:'$G(DA) ""
"RTN","WVUTL4",125,0)
 S Y=$$COLP0(DA)
"RTN","WVUTL4",126,0)
 Q:Y="" "None"
"RTN","WVUTL4",127,0)
 S X=$P(Y,U)_" on "_$$SLDT2^WVUTL5($P(Y,U,12))
"RTN","WVUTL4",128,0)
 I $P(Y,U,5) Q X_"^"_$P(^WV(790.31,$P(Y,U,5),0),U)
"RTN","WVUTL4",129,0)
 Q X_"^"_"Not entered"
"RTN","WVUTL4",130,0)
 ;
"RTN","WVUTL4",131,0)
COLP0(DA) ;EP
"RTN","WVUTL4",132,0)
 ;---> IF THERE IS AN ASSOC'D COLP, RETURN ITS ZERO NODE.
"RTN","WVUTL4",133,0)
 N Y
"RTN","WVUTL4",134,0)
 Q:'$G(DA) ""
"RTN","WVUTL4",135,0)
 Q:'$D(^WV(790.1,DA,0)) ""
"RTN","WVUTL4",136,0)
 Q:'$D(^WV(790.1,"ACOLP",DA)) ""
"RTN","WVUTL4",137,0)
 S Y=$O(^WV(790.1,"ACOLP",DA,0)),Y=$O(^WV(790.1,"ACOLP",DA,Y,0))
"RTN","WVUTL4",138,0)
 Q:'$D(^WV(790.1,Y,0)) ""
"RTN","WVUTL4",139,0)
 Q ^WV(790.1,Y,0)
"RTN","WVUTL4",140,0)
 ;
"RTN","WVUTL4",141,0)
MARGIN(DA) ;EP
"RTN","WVUTL4",142,0)
 ;---> DETERMINE WHETHER THE "MARGINS CLEAR?" QUESTION (PAGE 2 OF
"RTN","WVUTL4",143,0)
 ;---> PROCEDURE EDIT) SHOULD BE ASKED FOR THIS PROCEDURE.
"RTN","WVUTL4",144,0)
 N Y
"RTN","WVUTL4",145,0)
 Q:'$G(DA) 0
"RTN","WVUTL4",146,0)
 Q:'$D(^WV(790.1,DA,0)) 0
"RTN","WVUTL4",147,0)
 S Y=$P(^WV(790.1,DA,0),U,4)
"RTN","WVUTL4",148,0)
 Q:'Y 0
"RTN","WVUTL4",149,0)
 Q:'$D(^WV(790.2,Y,0)) 0
"RTN","WVUTL4",150,0)
 Q:$P(^WV(790.2,Y,0),U,11)<1 0
"RTN","WVUTL4",151,0)
 Q 1
"RTN","WVUTL4",152,0)
 ;
"RTN","WVUTL4",153,0)
STAGE(STAGE) ;EP
"RTN","WVUTL4",154,0)
 ;---> RETURN THE TEXT OF THE STAGE OF CARCINOMA.
"RTN","WVUTL4",155,0)
 Q:'$G(STAGE) ""
"RTN","WVUTL4",156,0)
 Q:'$D(^DD(790.1,.31,0)) "^DD MISSING"
"RTN","WVUTL4",157,0)
 Q $P($P(^DD(790.1,.31,0),STAGE_":",2),";")
"RTN","WVUTL5")
0^59^B14051844
"RTN","WVUTL5",1,0)
WVUTL5 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: ACC#, TITLES, SL/TX DATES; ;8/27/98  11:25
"RTN","WVUTL5",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL5",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL5",4,0)
 ;;  UTILITY: SETVARS, GENERATE ACCESSION#, MENUT, TITLE, CENTERT,
"RTN","WVUTL5",5,0)
 ;;  COPYLET, UPPERCASE XREF, SL/TX DATES.
"RTN","WVUTL5",6,0)
 ;
"RTN","WVUTL5",7,0)
 ;
"RTN","WVUTL5",8,0)
SETVARS ;EP
"RTN","WVUTL5",9,0)
 S:'$D(WVPOP) WVPOP=0
"RTN","WVUTL5",10,0)
 Q
"RTN","WVUTL5",11,0)
 ;**************
"RTN","WVUTL5",12,0)
 ;
"RTN","WVUTL5",13,0)
 ;
"RTN","WVUTL5",14,0)
ACCSSN(PCDTYPE) ;EP
"RTN","WVUTL5",15,0)
 ;---> GENERATE ACCESSION# FOR WV PROCEDURE FILE ENTRY.
"RTN","WVUTL5",16,0)
 ;---> REQUIRED VARIABLE: PCDTYPE=IEN OF PROCEDURE TYPE (#790.2)
"RTN","WVUTL5",17,0)
 N A,C,L,N,P,R,X
"RTN","WVUTL5",18,0)
 Q:'$D(PCDTYPE) ""
"RTN","WVUTL5",19,0)
 Q:'$D(^WV(790.2,PCDTYPE,0)) ""
"RTN","WVUTL5",20,0)
 S X=^WV(790.2,PCDTYPE,0)          ;X=0-NODE OF PROC TYPE
"RTN","WVUTL5",21,0)
 S P=$P(X,U,4)                 ;P=PREFIX
"RTN","WVUTL5",22,0)
 S L=$P(X,U,6)                 ;L=LAST ASSIGNED ACCESSION# FOR THIS PROC
"RTN","WVUTL5",23,0)
 S A=$P(L,"-")                 ;A=ACC YEAR
"RTN","WVUTL5",24,0)
 S C=$P(L,"-",2)               ;C=COUNTER
"RTN","WVUTL5",25,0)
 D NOW^%DTC
"RTN","WVUTL5",26,0)
 S N=($E(%I(3),1,3)+1700)      ;N=YEAR NOW: 94
"RTN","WVUTL5",27,0)
 I A'=N S C=0
"RTN","WVUTL5",28,0)
 F  L +^WV(790.2,PCDTYPE,0):1 Q:$T
"RTN","WVUTL5",29,0)
 F  S C=C+1 S R=P_N_"-"_C Q:'$D(^WV(790.1,"B",R))
"RTN","WVUTL5",30,0)
 S $P(^WV(790.2,PCDTYPE,0),U,6)=N_"-"_C
"RTN","WVUTL5",31,0)
 L -^WV(790.2,PCDTYPE,0)
"RTN","WVUTL5",32,0)
 Q R  ;R=RESULT(NEW ACCESSION#)
"RTN","WVUTL5",33,0)
 ;
"RTN","WVUTL5",34,0)
MENUT(TITLE) ;EP
"RTN","WVUTL5",35,0)
 ;---> DISPLAY MENU TITLE FROM WV MENU OPTIONS.
"RTN","WVUTL5",36,0)
 ;---> REQUIRED VARIABLES: TITLE=TEXT TO BE CENTERED AND DISPLAYED.
"RTN","WVUTL5",37,0)
 ;--->                     DUZ(2)=CURRENT LOCATION TO BE DISPLAYED.
"RTN","WVUTL5",38,0)
 N WVTTAB,WVFAC,WVUNL,I
"RTN","WVUTL5",39,0)
 S:'$D(TITLE) TITLE="* NO TITLE SUPPLIED *"
"RTN","WVUTL5",40,0)
 S TITLE="*  "_TITLE_"  *"
"RTN","WVUTL5",41,0)
 S WVTTAB=39-($L(TITLE)/2)
"RTN","WVUTL5",42,0)
 W @IOF
"RTN","WVUTL5",43,0)
 W !?3,"WOMEN'S HEALTH:"
"RTN","WVUTL5",44,0)
 W ?WVTTAB,TITLE
"RTN","WVUTL5",45,0)
 W ?60,$E($$INSTTX^WVUTL6(DUZ(2)),1,20)
"RTN","WVUTL5",46,0)
 S WVUNL=$$REPEAT^XLFSTR("=",$L(TITLE))
"RTN","WVUTL5",47,0)
 W !?WVTTAB,WVUNL
"RTN","WVUTL5",48,0)
 Q
"RTN","WVUTL5",49,0)
 ;
"RTN","WVUTL5",50,0)
TITLE(TITLE) ;EP
"RTN","WVUTL5",51,0)
 ;---> DISPLAY A TITLE.
"RTN","WVUTL5",52,0)
 ;---> REQUIRED VARIABLES: TITLE=TEXT TO BE CENTERED AND DISPLAYED.
"RTN","WVUTL5",53,0)
 N WVTTAB
"RTN","WVUTL5",54,0)
 S:'$D(TITLE) TITLE="* NO TITLE SUPPLIED *"
"RTN","WVUTL5",55,0)
 S TITLE="* * *  WOMEN'S HEALTH: "_TITLE_"  * * *"
"RTN","WVUTL5",56,0)
 S WVTTAB=39-($L(TITLE)/2)
"RTN","WVUTL5",57,0)
 W @IOF
"RTN","WVUTL5",58,0)
 W !?WVTTAB,TITLE,!!
"RTN","WVUTL5",59,0)
 Q
"RTN","WVUTL5",60,0)
 ;
"RTN","WVUTL5",61,0)
CENTERT(TEXT) ;EP
"RTN","WVUTL5",62,0)
 ;---> ADD LEADING SPACES TO CENTER TEXT.
"RTN","WVUTL5",63,0)
 S:'$D(TEXT) TEXT="* NO TEXT SUPPLIED *"
"RTN","WVUTL5",64,0)
 N I
"RTN","WVUTL5",65,0)
 F I=1:1:(39-($L(TEXT)/2)) S TEXT=" "_TEXT
"RTN","WVUTL5",66,0)
 Q
"RTN","WVUTL5",67,0)
 ;
"RTN","WVUTL5",68,0)
UPPER() ;EP
"RTN","WVUTL5",69,0)
 S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","WVUTL5",70,0)
 Q X
"RTN","WVUTL5",71,0)
 ;
"RTN","WVUTL5",72,0)
COPYLET ;EP
"RTN","WVUTL5",73,0)
 ;---> COPY TEXT OF GENERIC SAMPLE LETTER TO ONE OR MORE WV PURPOSES.
"RTN","WVUTL5",74,0)
 ;---> EDIT NEXT LINE TO INCLUDE IENS OF WV PURPOSES TO BE CHANGED.
"RTN","WVUTL5",75,0)
 ;F DA=15,16,18,19 D
"RTN","WVUTL5",76,0)
 S DA=0
"RTN","WVUTL5",77,0)
 F  S DA=$O(^WV(790.404,DA)) Q:'DA  D
"RTN","WVUTL5",78,0)
 .K ^WV(790.404,DA,1)
"RTN","WVUTL5",79,0)
 .S N=0
"RTN","WVUTL5",80,0)
 .F  S N=$O(^WV(790.6,1,1,N)) Q:'N  D
"RTN","WVUTL5",81,0)
 ..S ^WV(790.404,DA,1,N,0)=^WV(790.6,1,1,N,0)
"RTN","WVUTL5",82,0)
 .S ^WV(790.404,DA,1,0)=^WV(790.6,1,1,0)
"RTN","WVUTL5",83,0)
 Q
"RTN","WVUTL5",84,0)
 ;
"RTN","WVUTL5",85,0)
 ;
"RTN","WVUTL5",86,0)
UPXREF(X,WVGBL) ;EP
"RTN","WVUTL5",87,0)
 ;---> SET UPPERCASE XREF FOR X.  CALLED FROM MUMPS XREFS ON MIXED CASE
"RTN","WVUTL5",88,0)
 ;---> FIELDS WHERE AN ALL UPPERCASE LOOKUP IS NEEDED.
"RTN","WVUTL5",89,0)
 ;---> REQUIRED VARIABLES: WVGBL=GLOBAL ROOT OF FILE, X=TEXT TO BE
"RTN","WVUTL5",90,0)
 ;---> CROSSREFERENCED IN ALL UPPERCASE, DA=IEN.
"RTN","WVUTL5",91,0)
 Q:'$D(WVGBL)!('$D(X))
"RTN","WVUTL5",92,0)
 N WVX S WVX=X,X=$$UPPER
"RTN","WVUTL5",93,0)
 S @(WVGBL_"""U"",$E(X,1,30),DA)")=""
"RTN","WVUTL5",94,0)
 S X=WVX K WVGBL
"RTN","WVUTL5",95,0)
 Q
"RTN","WVUTL5",96,0)
 ;
"RTN","WVUTL5",97,0)
KUPXREF(X,WVGBL) ;EP
"RTN","WVUTL5",98,0)
 ;---> KILL UPPERCASE XREF FOR X.  CALLED FROM MUMPS XREFS ON MIXED CASE
"RTN","WVUTL5",99,0)
 ;---> FIELDS WHERE AN ALL UPPERCASE LOOKUP IS NEEDED.
"RTN","WVUTL5",100,0)
 ;---> REQUIRED VARIABLES: WVGBL=GLOBAL ROOT OF FILE, X=TEXT TO BE
"RTN","WVUTL5",101,0)
 ;---> CROSSREFERENCED IN ALL UPPERCASE, DA=IEN.
"RTN","WVUTL5",102,0)
 Q:'$D(WVGBL)!('$D(X))
"RTN","WVUTL5",103,0)
 N WVX S WVX=X,X=$$UPPER
"RTN","WVUTL5",104,0)
 K @(WVGBL_"""U"",$E(X,1,30),DA)")
"RTN","WVUTL5",105,0)
 S X=WVX K WVGBL
"RTN","WVUTL5",106,0)
 Q
"RTN","WVUTL5",107,0)
 ;
"RTN","WVUTL5",108,0)
AGENCY(SITE) ;EP
"RTN","WVUTL5",109,0)
 ;---> RETURN TYPE OF AGENCY ("i"=IHS, "s"=STATE, "v"=VA, ETC.).
"RTN","WVUTL5",110,0)
 ;---> REQUIRED VARIABLE: SITE=DUZ(2)
"RTN","WVUTL5",111,0)
 ;---> IF SITE NOT PASSED OR PARAMETER NOT SET, IT DEFAULTS TO VA.
"RTN","WVUTL5",112,0)
 Q:'$G(SITE) "v"
"RTN","WVUTL5",113,0)
 Q:'$D(^WV(790.02,SITE,0)) "v"
"RTN","WVUTL5",114,0)
 Q $P(^WV(790.02,SITE,0),U,15)
"RTN","WVUTL5",115,0)
 ;
"RTN","WVUTL5",116,0)
PNLAB() ;EP
"RTN","WVUTL5",117,0)
 ;---> RETURN TEXT FOR PATIENT NUMBER: "   SSN: ".
"RTN","WVUTL5",118,0)
 Q "   SSN: "
"RTN","WVUTL5",119,0)
 ;
"RTN","WVUTL5",120,0)
PNLB() ;EP
"RTN","WVUTL5",121,0)
 ;---> RETURN UPPERCASE TEXT FOR PATIENT NUMBER, NO COLON/SPACES.
"RTN","WVUTL5",122,0)
 Q "SSN"
"RTN","WVUTL5",123,0)
 ;
"RTN","WVUTL5",124,0)
SLDT2(DATE) ;EP
"RTN","WVUTL5",125,0)
 ;---> CONVERT FILEMAN INTERNAL DATE TO "SLASH" FORMAT: MM/DD/YY.
"RTN","WVUTL5",126,0)
 ;---> DATE=DATE IN FILEMAN FORMAT.
"RTN","WVUTL5",127,0)
 Q:'$G(DATE) "NO DATE"
"RTN","WVUTL5",128,0)
 S DATE=$P(DATE,".")
"RTN","WVUTL5",129,0)
 Q:$L(DATE)'=7 DATE
"RTN","WVUTL5",130,0)
 Q:'$E(DATE,4,5) $E(DATE,1,3)+1700
"RTN","WVUTL5",131,0)
 Q:'$E(DATE,6,7) $E(DATE,4,5)_"/"_$E(DATE,2,3)
"RTN","WVUTL5",132,0)
 Q $E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","WVUTL5",133,0)
 ;
"RTN","WVUTL5",134,0)
 ;
"RTN","WVUTL5",135,0)
SLDT1(DATE) ;EP
"RTN","WVUTL5",136,0)
 ;---> CONVERT FILEMAN INTERNAL DATE TO "SLASH" FORMAT: MM/DD/YY
"RTN","WVUTL5",137,0)
 ;---> PLUS TIME.
"RTN","WVUTL5",138,0)
 N Y
"RTN","WVUTL5",139,0)
 Q:'$D(DATE) "unknown"
"RTN","WVUTL5",140,0)
 S Y=DATE,DATE=$P(DATE,".")
"RTN","WVUTL5",141,0)
 Q:'DATE "NO DATE"
"RTN","WVUTL5",142,0)
 Q:$L(DATE)'=7 DATE
"RTN","WVUTL5",143,0)
 Q:'$E(DATE,4,5) $E(DATE,1,3)+1700
"RTN","WVUTL5",144,0)
 Q:'$E(DATE,6,7) $E(DATE,4,5)_"/"_$E(DATE,2,3)
"RTN","WVUTL5",145,0)
 D DD^%DT S:Y["@" Y=" @ "_$P($P(Y,"@",2),":",1,2)
"RTN","WVUTL5",146,0)
 Q $E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)_Y
"RTN","WVUTL5",147,0)
 ;
"RTN","WVUTL5",148,0)
TXDT(DATE) ;EP
"RTN","WVUTL5",149,0)
 ;---> CONVERT FILEMAN INTERNAL DATE TO "TEXT" FORMAT: MMM DD,YYYY.
"RTN","WVUTL5",150,0)
 N Y
"RTN","WVUTL5",151,0)
 Q:'$D(DATE) "UNKNOWN"
"RTN","WVUTL5",152,0)
 S Y=DATE D DD^%DT
"RTN","WVUTL5",153,0)
 I Y[", " S Y=$P(Y,", ")_","_$P(Y,", ",2)
"RTN","WVUTL5",154,0)
 I Y["@" S Y=$P(Y,"@")_"  "_$P($P(Y,"@",2),":",1,2)
"RTN","WVUTL5",155,0)
 Q Y
"RTN","WVUTL6")
0^60^B10580576
"RTN","WVUTL6",1,0)
WVUTL6 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: TEXT VALS, DEF PRINT DATE; ;9/17/98  16:32
"RTN","WVUTL6",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL6",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL6",4,0)
 ;;  UTILITY: TEXT FOR PROVIDER, PROCEDURE, HOSP LOC, INSTIT, & ECC.
"RTN","WVUTL6",5,0)
 ;;  PROC SPECIAL VALUE (PAP, MAM, COLP).  COMPUTE DEFAULT PRINT DATE.
"RTN","WVUTL6",6,0)
 ;
"RTN","WVUTL6",7,0)
 ;
"RTN","WVUTL6",8,0)
PROV() ;EP
"RTN","WVUTL6",9,0)
 ;---> RETURN TEXT OF PROVIDER'S NAME.
"RTN","WVUTL6",10,0)
 ;---> REQUIRED VARIABLE: X=IEN IN NEW PERSON FILE #200.
"RTN","WVUTL6",11,0)
 Q:'$D(X) ""
"RTN","WVUTL6",12,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL6",13,0)
 Q:'$D(^VA(200,X,0)) "UNKNOWN POINTER"
"RTN","WVUTL6",14,0)
 Q $P(^VA(200,X,0),U)
"RTN","WVUTL6",15,0)
 ;
"RTN","WVUTL6",16,0)
 ;
"RTN","WVUTL6",17,0)
PCDNAM() ;EP
"RTN","WVUTL6",18,0)
 ;---> RETURN TEXT OF PROCEDURE TYPE.
"RTN","WVUTL6",19,0)
 ;---> REQUIRED VARIABLE: X=IEN IN WV PROCEDURE TYPE FILE #790.2.
"RTN","WVUTL6",20,0)
 Q:'$D(X) ""
"RTN","WVUTL6",21,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL6",22,0)
 Q:'$D(^WV(790.2,X,0)) "UNKNOWN POINTER"
"RTN","WVUTL6",23,0)
 Q $P(^WV(790.2,X,0),U)
"RTN","WVUTL6",24,0)
 ;
"RTN","WVUTL6",25,0)
HOSPLC() ;EP
"RTN","WVUTL6",26,0)
 ;---> RETURN TEXT OF HOSPITAL LOCATION NAME.
"RTN","WVUTL6",27,0)
 ;---> REQUIRED VARIABLE: X=IEN IN HOSPITAL LOCATION FILE #44.
"RTN","WVUTL6",28,0)
 Q:'$D(X) ""
"RTN","WVUTL6",29,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL6",30,0)
 Q:'$D(^SC(X,0)) "UNKNOWN POINTER"
"RTN","WVUTL6",31,0)
 Q $P(^SC(X,0),U)
"RTN","WVUTL6",32,0)
 ;
"RTN","WVUTL6",33,0)
INSTIT() ;EP
"RTN","WVUTL6",34,0)
 ;---> RETURN IEN OF INSTITUTION (FACILITY) FILE 4, FOR THIS HOSPITAL
"RTN","WVUTL6",35,0)
 ;---> LOCATION ENTRY IN HOSPITAL LOCATION FILE 44.
"RTN","WVUTL6",36,0)
 ;---> ALSO CONCATENATE "`" TO THE FRONT OF IEN FOR USE IN DR STRINGS.
"RTN","WVUTL6",37,0)
 Q:'$D(X) ""
"RTN","WVUTL6",38,0)
 Q:X="" ""
"RTN","WVUTL6",39,0)
 Q:'$D(^SC(X,0)) ""
"RTN","WVUTL6",40,0)
 Q:$P(^SC(X,0),U,4)']"" ""
"RTN","WVUTL6",41,0)
 Q "`"_$P(^SC(X,0),U,4)
"RTN","WVUTL6",42,0)
 ;
"RTN","WVUTL6",43,0)
INSTTX(FACILITY) ;EP
"RTN","WVUTL6",44,0)
 ;---> RETURN TEXT OF INSTITUTION (FACILITY) NAME.
"RTN","WVUTL6",45,0)
 ;---> REQUIRED VARIABLE: X=IEN IN INSTITUTION FILE #4.
"RTN","WVUTL6",46,0)
 Q:'$G(FACILITY) ""
"RTN","WVUTL6",47,0)
 Q:'$D(^DIC(4,FACILITY,0)) "UNKNOWN POINTER"
"RTN","WVUTL6",48,0)
 Q $P(^DIC(4,FACILITY,0),U)
"RTN","WVUTL6",49,0)
 ;
"RTN","WVUTL6",50,0)
ECCDYS() ;EP
"RTN","WVUTL6",51,0)
 ;---> RETURN TEXT FROM SET OF CODES FOR ECC DYSPLASIA, FIELD .25,
"RTN","WVUTL6",52,0)
 ;---> OF PROCEDURE FILE 790.1.
"RTN","WVUTL6",53,0)
 ;---> REQUIRED VARIABLE: X=CODE FOR TEXT OF ECC DYSPLASIA.
"RTN","WVUTL6",54,0)
 Q:'$D(X) ""
"RTN","WVUTL6",55,0)
 Q:X="" ""
"RTN","WVUTL6",56,0)
 Q:'$D(^DD(790.1,.25,0)) "^DD MISSING"
"RTN","WVUTL6",57,0)
 Q $P($P(^DD(790.1,.25,0),X_":",2),";")
"RTN","WVUTL6",58,0)
 ;
"RTN","WVUTL6",59,0)
PNOCX(IEN) ;EP
"RTN","WVUTL6",60,0)
 ;---> RETURN 1 IF THIS PROCEDURE IS NOT ANY TYPE OF CERVICAL TX.
"RTN","WVUTL6",61,0)
 Q:'$G(IEN) 1
"RTN","WVUTL6",62,0)
 Q:'$D(^WV(790.2,IEN,0)) 1
"RTN","WVUTL6",63,0)
 Q:$$PMAM(IEN) 1
"RTN","WVUTL6",64,0)
 Q:IEN=27 1  Q:IEN=29 1  Q:IEN=30 1  Q:IEN=31 1  Q:IEN=32 1
"RTN","WVUTL6",65,0)
 Q:IEN=33 1  Q:IEN=34 1  Q:IEN=35 1
"RTN","WVUTL6",66,0)
 Q 0
"RTN","WVUTL6",67,0)
 ;
"RTN","WVUTL6",68,0)
 ;
"RTN","WVUTL6",69,0)
PMAM(IEN) ;EP
"RTN","WVUTL6",70,0)
 ;---> RETURN 1 IF THIS PROCEDURE IS ANY TYPE OF MAMMOGRAM, RETURN 0
"RTN","WVUTL6",71,0)
 ;---> IF NOT.
"RTN","WVUTL6",72,0)
 ;---> REQUIRED VARIABLE: IEN=IEN IN PROCEDURE TYPE FILE #790.2.
"RTN","WVUTL6",73,0)
 ;---> 25, 26, AND 27 ARE IENS OF MAMS IN ^WV(790.2,.
"RTN","WVUTL6",74,0)
 Q:'$G(IEN) 0
"RTN","WVUTL6",75,0)
 Q:IEN=25 1  Q:IEN=26 1  Q:IEN=28 1
"RTN","WVUTL6",76,0)
 Q 0
"RTN","WVUTL6",77,0)
 ;
"RTN","WVUTL6",78,0)
 ;
"RTN","WVUTL6",79,0)
PRTDATE ;EP
"RTN","WVUTL6",80,0)
 ;---> CALL BY WV NOTIF-EDITBLK-1 TO COMPUTE AND STUFF DATE NOTIFICATION
"RTN","WVUTL6",81,0)
 ;---> LETTER WILL BE PRINTED, "Print Date" FIELD.  CALLED FROM
"RTN","WVUTL6",82,0)
 ;---> "TYPE OF NOTIFICATION" FIELD ORDER, "POST ACTION ON CHANGE".
"RTN","WVUTL6",83,0)
 ;--->
"RTN","WVUTL6",84,0)
 ;---> IF THE "TYPE OF NOTIFICATION" IS PRINTABLE (LETTER), AS STORED
"RTN","WVUTL6",85,0)
 ;---> IN #.02 FIELD OF FILE #790.403, THIS COMPUTES PRINT DATE AND
"RTN","WVUTL6",86,0)
 ;---> STUFFS A DEFAULT "COMPLETE BY DATE" (FIELD #.13) AS WELL.
"RTN","WVUTL6",87,0)
 ;---> "PRINT DATE" WILL BE CX/BR NEED DUE DATE - SITE PARAMETER, AS
"RTN","WVUTL6",88,0)
 ;---> STORED IN #.06 FIELD OF FILE #790.02, OR -30 DAYS IF
"RTN","WVUTL6",89,0)
 ;---> PARAMETER NOT SET.  (SEE PRTDAT^WVUTL2-ABOVE.)
"RTN","WVUTL6",90,0)
 ;---> "COMPLETE BY DATE" WILL BE "PRINT DATE"+30. SEE NDELQ1^WVUTL4.
"RTN","WVUTL6",91,0)
 ;--->
"RTN","WVUTL6",92,0)
 ;---> IF THE "TYPE OF NOTIFICATION" IS NOT PRINTABLE (PHONE), THIS
"RTN","WVUTL6",93,0)
 ;---> SETS "PRINT DATE"="" AND RECOMPUTES "COMPLETE BY DATE" BASED ON
"RTN","WVUTL6",94,0)
 ;---> DATE NOTIFICATION WAS OPENED (FIELD #.02) +30 DAYS.
"RTN","WVUTL6",95,0)
 ;
"RTN","WVUTL6",96,0)
 ;---> (NOTE: FOR UNIFORMITY, EXECUTABLE DEFAULT FOR "PRINT DATE"
"RTN","WVUTL6",97,0)
 ;---> CALLS THIS CODE TO SET ITS STORED VALUE, THEN SETS ITS DEFAULT
"RTN","WVUTL6",98,0)
 ;---> EQUAL TO ITS STORED VALUE.)
"RTN","WVUTL6",99,0)
 ;--->
"RTN","WVUTL6",100,0)
 ;---> REQUIRED VARIABLES: WVDFN=IEN OF PATIENT
"RTN","WVUTL6",101,0)
 ;--->                     DUZ(2)=SITE
"RTN","WVUTL6",102,0)
 ;--->                     WVTYPE=IEN TYPE OF NOTIFICATION (LETTER, ETC)
"RTN","WVUTL6",103,0)
 ;--->                     WVPURP=IEN PURPOSE OF NOTIFICATION
"RTN","WVUTL6",104,0)
 ;
"RTN","WVUTL6",105,0)
 N WVTYPE,WVPURP,X,Y
"RTN","WVUTL6",106,0)
 S WVTYPE=$$GET^DDSVAL(DIE,DA,.03)
"RTN","WVUTL6",107,0)
 I 'WVTYPE D PUT^DDSVAL(DIE,DA,.11,"") Q
"RTN","WVUTL6",108,0)
 ;---> IF NOT PRINTABLE, SET PRINT DATE="".
"RTN","WVUTL6",109,0)
 I '$P(^WV(790.403,WVTYPE,0),U,2) D  Q
"RTN","WVUTL6",110,0)
 .D PUT^DDSVAL(DIE,DA,.11,"")
"RTN","WVUTL6",111,0)
 .S X=$$NDELQ^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"RTN","WVUTL6",112,0)
 S WVPURP=$$GET^DDSVAL(DIE,DA,.04)
"RTN","WVUTL6",113,0)
 ;---> COMPUTE AND STUFF PRINT DATE.
"RTN","WVUTL6",114,0)
 D PRTDAT(WVDFN,DUZ(2),WVTYPE,WVPURP,.X)
"RTN","WVUTL6",115,0)
 D PUT^DDSVAL(DIE,DA,.11,X)
"RTN","WVUTL6",116,0)
 ;---> COMPUTE AND STUFF COMPLETE BY DATE.
"RTN","WVUTL6",117,0)
 S X=$$NDELQ1^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"RTN","WVUTL6",118,0)
 Q
"RTN","WVUTL6",119,0)
 ;
"RTN","WVUTL6",120,0)
 ;
"RTN","WVUTL6",121,0)
PRTDAT(DFN,DUZ2,TYPE,PURP,DATE) ;EP
"RTN","WVUTL6",122,0)
 ;---> YIELD PATIENT'S LETTER PRINT DATE, BASED ON CX/BR NEED.
"RTN","WVUTL6",123,0)
 ;---> DUE DATE MINUS SITE PARAMETER (OR 30 DAYS, IF NOT SET).
"RTN","WVUTL6",124,0)
 ;---> TYPE OF NOTIFICATION MUST BE "PRINTABLE" (#.02 OF #790.403).
"RTN","WVUTL6",125,0)
 ;---> REQUIRED VARIABLES: DFN=IEN OF PATIENT
"RTN","WVUTL6",126,0)
 ;--->                     DUZ2=DUZ(2)
"RTN","WVUTL6",127,0)
 ;--->                     TYPE=IEN TYPE OF NOTIFICATION
"RTN","WVUTL6",128,0)
 ;--->                     PURP=IEN PURPOSE OF NOTIFICATION
"RTN","WVUTL6",129,0)
 ;---> RETURNS VARIABLES:  DATE=DEFAULT DATE LETTER SHOULD BE PRINTED
"RTN","WVUTL6",130,0)
 ;
"RTN","WVUTL6",131,0)
 N P,Q,X,X1,X2
"RTN","WVUTL6",132,0)
 S DATE=""
"RTN","WVUTL6",133,0)
 Q:'TYPE!('PURP)
"RTN","WVUTL6",134,0)
 ;---> QUIT IF THIS "TYPE OF NOTIFICATION" IS NOT "PRINTABLE" (PIECE 2).
"RTN","WVUTL6",135,0)
 Q:'$P(^WV(790.403,TYPE,0),U,2)
"RTN","WVUTL6",136,0)
 S X2=$P(^WV(790.02,DUZ2,0),U,6)
"RTN","WVUTL6",137,0)
 S X2=$S(X2:-X2,1:-30)
"RTN","WVUTL6",138,0)
 Q:'$D(^WV(790,DFN,0))
"RTN","WVUTL6",139,0)
 ;---> IF THIS PURPOSE IS A RESULT LETTER, SET PRINT DATE=TODAY, QUIT.
"RTN","WVUTL6",140,0)
 Q:'$D(^WV(790.404,PURP,0))
"RTN","WVUTL6",141,0)
 I $P(^WV(790.404,PURP,0),U,6) S DATE=DT Q
"RTN","WVUTL6",142,0)
 ;---> IF THIS IS NOT ASSOCIATED WITH BR/CX NEEDS, QUIT WITH DATE="".
"RTN","WVUTL6",143,0)
 Q:$P(^WV(790.404,PURP,0),U,5)=""
"RTN","WVUTL6",144,0)
 S:$P(^WV(790.404,PURP,0),U,5)="CX" P=11,Q=12
"RTN","WVUTL6",145,0)
 S:$P(^WV(790.404,PURP,0),U,5)="BR" P=18,Q=19
"RTN","WVUTL6",146,0)
 ;---> QUIT IF THIS PATIENT HAS NO BR/CX NEED ENTERED.
"RTN","WVUTL6",147,0)
 Q:'$P(^WV(790,DFN,0),U,P)
"RTN","WVUTL6",148,0)
 ;---> QUIT IF THIS PATIENT HAS NO BR/CX NEED DUE DATE.
"RTN","WVUTL6",149,0)
 S X=$P(^WV(790,DFN,0),U,Q) Q:'X
"RTN","WVUTL6",150,0)
 S:'$E(X,7) $E(X,7)=1
"RTN","WVUTL6",151,0)
 S X1=X D C^%DTC
"RTN","WVUTL6",152,0)
 S DATE=X
"RTN","WVUTL6",153,0)
 Q
"RTN","WVUTL7")
0^61^B39329429
"RTN","WVUTL7",1,0)
WVUTL7 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: HEADERS & TRAILERS; ;9/15/98  15:54
"RTN","WVUTL7",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL7",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL7",4,0)
 ;;  UTILITY: HEADERS AND TRAILERS.
"RTN","WVUTL7",5,0)
 ;
"RTN","WVUTL7",6,0)
S(S) ;EP
"RTN","WVUTL7",7,0)
 ;---> RETURN A VALUE OF SPACES EQUAL IN LENGTH TO THE NUMBER S.
"RTN","WVUTL7",8,0)
 N I,SP S SP=$$REPEAT^XLFSTR(" ",80)
"RTN","WVUTL7",9,0)
 Q $E(SP,1,$G(S))
"RTN","WVUTL7",10,0)
 ;
"RTN","WVUTL7",11,0)
TOPHEAD ;EP
"RTN","WVUTL7",12,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",13,0)
 N X
"RTN","WVUTL7",14,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",15,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",16,0)
 S WVPAGE=1
"RTN","WVUTL7",17,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",18,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",19,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",20,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",21,0)
 Q
"RTN","WVUTL7",22,0)
 ;
"RTN","WVUTL7",23,0)
 ;
"RTN","WVUTL7",24,0)
TOPHEAD1 ;EP
"RTN","WVUTL7",25,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",26,0)
 N X
"RTN","WVUTL7",27,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",28,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",29,0)
 S WVPAGE=$G(WVPAGE)+1
"RTN","WVUTL7",30,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",31,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",32,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",33,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",34,0)
 Q
"RTN","WVUTL7",35,0)
 ;
"RTN","WVUTL7",36,0)
HEADER1 ;EP
"RTN","WVUTL7",37,0)
 ;---> BROWSE/REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",38,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",39,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",40,0)
 N X
"RTN","WVUTL7",41,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",42,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",43,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",44,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",45,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",46,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",47,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",48,0)
 .I '$D(WVCMGR) W "UNKNOWN" Q
"RTN","WVUTL7",49,0)
 .I WVCMGR="" W "UNKNOWN" Q
"RTN","WVUTL7",50,0)
 .I '$D(^VA(200,WVCMGR,0)) W "UNKNOWN" Q
"RTN","WVUTL7",51,0)
 .W $P(^VA(200,WVCMGR,0),U)
"RTN","WVUTL7",52,0)
 W ?56,"For period: ",$$TXDT^WVUTL5(WVBEGDT)
"RTN","WVUTL7",53,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",54,0)
 W ?64,"To: ",$$TXDT^WVUTL5(WVENDDT)
"RTN","WVUTL7",55,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",56,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",57,0)
 Q
"RTN","WVUTL7",58,0)
 ;
"RTN","WVUTL7",59,0)
 ;
"RTN","WVUTL7",60,0)
HEADER2 ;EP
"RTN","WVUTL7",61,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, MULTIPLE PROCEDURES.
"RTN","WVUTL7",62,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",63,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",64,0)
 N X
"RTN","WVUTL7",65,0)
 D FAC^WVUTL1A
"RTN","WVUTL7",66,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",67,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",68,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",69,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",70,0)
 W !,"Patient Name: ",WVNAMAGE,?52,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",71,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",72,0)
 W ?50,"Facility: ",$E($$INSTTX^WVUTL6(DUZ(2)),1,19)
"RTN","WVUTL7",73,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",74,0)
 W ?47,"Cx Facility: ",$G(WVJCFAC)
"RTN","WVUTL7",75,0)
 W !,"PAP Regimen : ",WVPAPRG
"RTN","WVUTL7",76,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",77,0)
 W ?47,"Br Facility: ",$G(WVJBFAC)
"RTN","WVUTL7",78,0)
 W !,"Pr Provider : ",$G(WVJPCP)
"RTN","WVUTL7",79,0)
 W ?45,"Sexual Trauma: ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",80,0)
 W !,"Veteran     : ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",81,0)
 W !,$$REPEAT^XLFSTR("=",49)
"RTN","WVUTL7",82,0)
 W $S(WVEDC]"":WVEDC_"======",1:"===============================")
"RTN","WVUTL7",83,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",84,0)
 Q
"RTN","WVUTL7",85,0)
 ;
"RTN","WVUTL7",86,0)
 ;
"RTN","WVUTL7",87,0)
HEADER3 ;EP
"RTN","WVUTL7",88,0)
 ;---> LAB LOG REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",89,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",90,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",91,0)
 N X
"RTN","WVUTL7",92,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",93,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",94,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",95,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",96,0)
 W !,"Facility: ",$$INSTTX^WVUTL6($S($G(WVFAC):WVFAC,1:DUZ(2)))
"RTN","WVUTL7",97,0)
 W ?53,"From: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",98,0)
 W " to ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",99,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",100,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",101,0)
 Q
"RTN","WVUTL7",102,0)
 ;
"RTN","WVUTL7",103,0)
 ;
"RTN","WVUTL7",104,0)
HEADER4 ;EP
"RTN","WVUTL7",105,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, ONE PROCEDURE.
"RTN","WVUTL7",106,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE1,DUZ(2)
"RTN","WVUTL7",107,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",108,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",109,0)
 W WVCONFF W:'WVCRT !,WVTIMLN
"RTN","WVUTL7",110,0)
 W !!,WVTITLE1,?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",111,0)
HEADER41 ;EP
"RTN","WVUTL7",112,0)
 ;---> CALLED BY WVPROC; BYPASSES FORMFEED, TITLE, ETC.
"RTN","WVUTL7",113,0)
 N WVDES
"RTN","WVUTL7",114,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",115,0)
 W !,"Patient Name: ",WVNAMAGE,?53,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",116,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",117,0)
 W ?50,"Procedure: ",$E(WVPN,1,19)
"RTN","WVUTL7",118,0)
 W !,"PAP Regimen : ",WVPAPRG
"RTN","WVUTL7",119,0)
 W ?55,"Acc#: ",WVACCN
"RTN","WVUTL7",120,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",121,0)
 W ?48,"Cx Facility: ",$$FACIL^WVUTL1A(WVDFN,"C")
"RTN","WVUTL7",122,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",123,0)
 W ?48,"Br Facility: ",$$FACIL^WVUTL1A(WVDFN,"B")
"RTN","WVUTL7",124,0)
 W !,"Sexual Trauma: ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",125,0)
 W ?52,"Veteran: ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",126,0)
 S WVDES=$$DES^WVUTL1(WVDFN)
"RTN","WVUTL7",127,0)
 W !,$S(WVDES="YES":"*DES DAUGHTER*",1:"--------------")
"RTN","WVUTL7",128,0)
 W $$REPEAT^XLFSTR("-",37)
"RTN","WVUTL7",129,0)
 W $S(WVEDC]"":WVEDC_"----",1:"-----------------------------")
"RTN","WVUTL7",130,0)
 Q
"RTN","WVUTL7",131,0)
 ;
"RTN","WVUTL7",132,0)
 ;
"RTN","WVUTL7",133,0)
HEADER5 ;EP
"RTN","WVUTL7",134,0)
 ;---> DELINQUENT NEEDS REPORT HEADER: MULTIPLE PATIENTS
"RTN","WVUTL7",135,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",136,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",137,0)
 N X
"RTN","WVUTL7",138,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",139,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",140,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",141,0)
 ;W !!,$$RUNDT^WVUTL1A(DT)
"RTN","WVUTL7",142,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",143,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",144,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",145,0)
 .I $G(WVCMGR)']"" W "UNKNOWN" Q
"RTN","WVUTL7",146,0)
 .I '$D(^VA(200,WVCMGR,0)) W "UNKNOWN" Q
"RTN","WVUTL7",147,0)
 .W $P(^VA(200,WVCMGR,0),U)
"RTN","WVUTL7",148,0)
 ;W ?46,"Communit" D
"RTN","WVUTL7",149,0)
 ;.I $D(WVCC("ALL")) W "ies: ALL" Q
"RTN","WVUTL7",150,0)
 ;.N I,N S N=0 F I=0:1 S N=$O(WVCC(N)) Q:'N
"RTN","WVUTL7",151,0)
 ;.I I=1 W "y: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,22) Q
"RTN","WVUTL7",152,0)
 ;.W "ies: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,18),",..." Q
"RTN","WVUTL7",153,0)
 S Y=DT D DD^%DT W ?46,"Run Date: ",Y
"RTN","WVUTL7",154,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(WVFAC)
"RTN","WVUTL7",155,0)
 W ?46,"Tx Needs Past Due as of ",$$SLDT2^WVUTL5(WVDDATE)
"RTN","WVUTL7",156,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",157,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",158,0)
 Q
"RTN","WVUTL7",159,0)
 ;
"RTN","WVUTL7",160,0)
 ;
"RTN","WVUTL7",161,0)
HEADER6 ;EP
"RTN","WVUTL7",162,0)
 ;---> PROGRAM SNAPSHOT HEADER: JUST TITLE AND FACILITY (NO PATIENTS)
"RTN","WVUTL7",163,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",164,0)
 N X
"RTN","WVUTL7",165,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",166,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",167,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",168,0)
 W !?3,$$RUNDT^WVUTL1A(DT) I $D(WVJTOY) W ?60,"(",WVJTOY,")"
"RTN","WVUTL7",169,0)
 W !,"   Note: This report includes all facilities"
"RTN","WVUTL7",170,0)
 W " using this database."
"RTN","WVUTL7",171,0)
 ;W " Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",172,0)
 ;W " (This report is not site specific.)"
"RTN","WVUTL7",173,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",174,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",175,0)
 Q
"RTN","WVUTL7",176,0)
 ;
"RTN","WVUTL7",177,0)
 ;
"RTN","WVUTL7",178,0)
HEADER7 ;EP
"RTN","WVUTL7",179,0)
 ;---> AUTOLOAD OF PATIENTS HEADER
"RTN","WVUTL7",180,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",181,0)
 N X
"RTN","WVUTL7",182,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",183,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",184,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",185,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",186,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",187,0)
 W ?64,"Cutoff Age: ",WVAGE
"RTN","WVUTL7",188,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",189,0)
 W !,?3,"NAME",?30,$$PNLB^WVUTL5(),?45,"DOB",?60,"STATUS"
"RTN","WVUTL7",190,0)
 W !,WVLINE
"RTN","WVUTL7",191,0)
 Q
"RTN","WVUTL7",192,0)
 ;
"RTN","WVUTL7",193,0)
 ;
"RTN","WVUTL7",194,0)
HEADER8 ;EP
"RTN","WVUTL7",195,0)
 ;---> SCREENING RATES REPORT HEADER: (NO PATIENTS)
"RTN","WVUTL7",196,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",197,0)
 N X
"RTN","WVUTL7",198,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",199,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",200,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",201,0)
 ;W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",202,0)
 W !!?4,"For Age Range: ",$S(WVAGRG=1:"ALL",1:WVAGRG)
"RTN","WVUTL7",203,0)
 W ?56,"For period: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",204,0)
 ;W !?4,"Communit" D
"RTN","WVUTL7",205,0)
 ;.I $D(WVCC("ALL")) W "ies: ALL" Q
"RTN","WVUTL7",206,0)
 ;.N I,N S N=0 F I=0:1 S N=$O(WVCC(N)) Q:'N
"RTN","WVUTL7",207,0)
 ;.I I=1 W "y: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,22) Q
"RTN","WVUTL7",208,0)
 ;.W "ies: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,18),",..." Q
"RTN","WVUTL7",209,0)
 S Y=DT D DD^%DT W !?4,"Run Date: ",Y
"RTN","WVUTL7",210,0)
 W ?64,"To: ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",211,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",212,0)
 W !?4,"(Note: This report includes all facilities"
"RTN","WVUTL7",213,0)
 W " using this database.)",!
"RTN","WVUTL7",214,0)
 ;I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",215,0)
 Q
"RTN","WVUTL7",216,0)
 ;
"RTN","WVUTL7",217,0)
ENDREP(X) ;EP
"RTN","WVUTL7",218,0)
 ;---> END A REPORT, DO FORMFEED OR "Press <Return>" IF NECESSARY.
"RTN","WVUTL7",219,0)
 ;---> REQUIRED VARIABLES: WVCRT=1 IF OUTPUT TO SCREEN
"RTN","WVUTL7",220,0)
 ;--->                     WVPOP=1 IF ESCAPING
"RTN","WVUTL7",221,0)
 ;---> OPTIONAL VARIABLE:  X=1 IF "End of Report" SHOULD NOT DISPLAY.
"RTN","WVUTL7",222,0)
 ;
"RTN","WVUTL7",223,0)
 S WVTITLE="-----  End of Report  -----"
"RTN","WVUTL7",224,0)
 I '$G(X)&('WVPOP) D CENTERT^WVUTL5(.WVTITLE) W !,WVTITLE
"RTN","WVUTL7",225,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVUTL7",226,0)
 D ^%ZISC
"RTN","WVUTL7",227,0)
 Q
"RTN","WVUTL8")
0^62^B22896992
"RTN","WVUTL8",1,0)
WVUTL8 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: PATLKUP, SELECT, KILLALL; ;9/1/98  10:29
"RTN","WVUTL8",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVUTL8",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL8",4,0)
 ;;  UTILITY: PATIENT LOOKUP, SELECT FOR REPORT, KILLALL.
"RTN","WVUTL8",5,0)
 ;
"RTN","WVUTL8",6,0)
PATLKUP(Y,WVADD,DUZ2,WVPOP) ;EP
"RTN","WVUTL8",7,0)
 ;---> WV PATIENT LOOKUP.
"RTN","WVUTL8",8,0)
 ;---> PARAMETERS:
"RTN","WVUTL8",9,0)
 ;     1 - Y             (RETURNED) PATIENT DFN OR -1 IF FAILED.
"RTN","WVUTL8",10,0)
 ;     2 - WVADD         (OPTIONAL) EQUALS "ADD" IF ADD CAPABILITY
"RTN","WVUTL8",11,0)
 ;     3 - DUZ2=DUZ(2)   (OPTIONAL) IF NOT SET, WILL=ENVIROMENTAL DUZ(2)
"RTN","WVUTL8",12,0)
 ;     4 - WVPOP         (RETURNED) WVPOP=1 IF DTOUT OR DUOUT
"RTN","WVUTL8",13,0)
 ;
"RTN","WVUTL8",14,0)
 ;---> EXAMPLE: D PATLKUP^WVUTL8(.Y)
"RTN","WVUTL8",15,0)
 ;              D PATLKUP^WVUTL8(.Y,"ADD") - MAY ADD PATIENT TO WH.
"RTN","WVUTL8",16,0)
 ;
"RTN","WVUTL8",17,0)
 N DFN,DIC,X
"RTN","WVUTL8",18,0)
PATLKUP1 ;---> RETURN HERE IF LOOKUP FAILED FOR SEX OR AGE.
"RTN","WVUTL8",19,0)
 ;---> SET VARIABLES: Y=DFN,WVPOP=1 FOR QUIT.
"RTN","WVUTL8",20,0)
 S WVPOP=0 D SETVARS^WVUTL5
"RTN","WVUTL8",21,0)
 S:$G(DUZ2)]"" DUZ(2)=DUZ2
"RTN","WVUTL8",22,0)
 S DIC="^DPT(",DIC(0)="AEMQ",DIC("S")="I $P(^(0),U,2)=""F"""
"RTN","WVUTL8",23,0)
 D ^DIC
"RTN","WVUTL8",24,0)
 Q:$D(DUOUT)!($D(DTOUT))
"RTN","WVUTL8",25,0)
 Q:Y<0
"RTN","WVUTL8",26,0)
 S (DFN,Y)=+Y
"RTN","WVUTL8",27,0)
 ;---> IF PATIENT ALREADY EXISTS IN WV PATIENT FILE, QUIT.
"RTN","WVUTL8",28,0)
 Q:$D(^WV(790,DFN,0))
"RTN","WVUTL8",29,0)
 ;
"RTN","WVUTL8",30,0)
 ;---> IF PATIENT IS NOT FEMALE, PROMPT USER.
"RTN","WVUTL8",31,0)
 I '$$SEX^WVUTL1(DFN) D  G PATLKUP1
"RTN","WVUTL8",32,0)
 .W !!?3,$$NAME^WVUTL1(DFN)," is not female." D DIRZ^WVUTL3
"RTN","WVUTL8",33,0)
 ;
"RTN","WVUTL8",34,0)
 ;---> QUIT IF NO ADD ("LAYGO") CAPABILITY.
"RTN","WVUTL8",35,0)
 I $G(WVADD)'="ADD" D  G PATLKUP1
"RTN","WVUTL8",36,0)
 .W !!?3,$$NAME^WVUTL1(DFN)
"RTN","WVUTL8",37,0)
 .W " is not currently in the Women's Health database." D DIRZ^WVUTL3
"RTN","WVUTL8",38,0)
 ;
"RTN","WVUTL8",39,0)
 ;---> ASK TO ADD AS A NEW PATIENT.
"RTN","WVUTL8",40,0)
 W !!?3,$$NAME^WVUTL1(DFN)
"RTN","WVUTL8",41,0)
 ;---> IF PATIENT IS UNDER 12 YEARS, PROMPT USER.
"RTN","WVUTL8",42,0)
 W:+$$AGE^WVUTL1(DFN)<12 " is under 12 years of age,",!?3,"and she"
"RTN","WVUTL8",43,0)
 W " is not currently in the Women's Health database."
"RTN","WVUTL8",44,0)
 W !?3,"Do you wish to add her to the Women's Health Database?"
"RTN","WVUTL8",45,0)
 S DIR("?",1)="     Enter YES to ADD this patient to the Women's Health"
"RTN","WVUTL8",46,0)
 S DIR("?",1)=DIR("?",1)_" database."
"RTN","WVUTL8",47,0)
 S DIR("?")="     Enter NO to quit without adding her to the database."
"RTN","WVUTL8",48,0)
 S DIR(0)="Y",DIR("A")="   Enter Yes or No"
"RTN","WVUTL8",49,0)
 D ^DIR W !
"RTN","WVUTL8",50,0)
 I $D(DIRUT) S Y=-1 Q
"RTN","WVUTL8",51,0)
 G:Y=0 PATLKUP1
"RTN","WVUTL8",52,0)
 D AUTOADD^WVPATE(DFN,DUZ(2),.Y,1)
"RTN","WVUTL8",53,0)
 Q
"RTN","WVUTL8",54,0)
 ;
"RTN","WVUTL8",55,0)
KGBL(GBL) ;EP
"RTN","WVUTL8",56,0)
 ;---> KILL A GLOBAL.  GBL SHOULD INCLUDE THE LEADING "^".
"RTN","WVUTL8",57,0)
 S:GBL["(" GBL=$P(GBL,"(")
"RTN","WVUTL8",58,0)
 F  S GBL=$Q(@GBL) Q:GBL=""  K @GBL
"RTN","WVUTL8",59,0)
 Q
"RTN","WVUTL8",60,0)
 ;
"RTN","WVUTL8",61,0)
ZGBL(GBL) ;EP
"RTN","WVUTL8",62,0)
 ;---> ZERO OUT (DELETE ALL DATA) IN A FILEMAN FILE.
"RTN","WVUTL8",63,0)
 ;---> GBL SHOULD INCLUDE THE LEADING "^".
"RTN","WVUTL8",64,0)
 N N,X
"RTN","WVUTL8",65,0)
 S:GBL["(" GBL=$P(GBL,"(")
"RTN","WVUTL8",66,0)
 Q:'$D(@(GBL_"(0)"))
"RTN","WVUTL8",67,0)
 S N=0,X=$P(@(GBL_"(0)"),U,1,2)
"RTN","WVUTL8",68,0)
 F  S N=$O(@(GBL_"("""_N_""")")) Q:N=""  K @(GBL_"("""_N_""")")
"RTN","WVUTL8",69,0)
 S @(GBL_"(0)")=X
"RTN","WVUTL8",70,0)
 Q
"RTN","WVUTL8",71,0)
 ;
"RTN","WVUTL8",72,0)
KILLALL ;EP
"RTN","WVUTL8",73,0)
 ;---> CLEAN UP VARIABLES.
"RTN","WVUTL8",74,0)
 ;---> MSM
"RTN","WVUTL8",75,0)
 ;S X="WV" F  S X=$O(@X) Q:$E(X,1,2)'="WV"  K @X
"RTN","WVUTL8",76,0)
 ;S X="DI" F  S X=$O(@X) Q:$E(X,1,2)'="WV"  K @X
"RTN","WVUTL8",77,0)
 ;---> DSM
"RTN","WVUTL8",78,0)
 ;S X="WV" F  S X=$ZSORT(@X) Q:$E(X,1,2)'="WV"  K @X
"RTN","WVUTL8",79,0)
 ;S X="DI" F  S X=$ZSORT(@X) Q:$E(X,1,2)'="WV"  K @X
"RTN","WVUTL8",80,0)
 ;
"RTN","WVUTL8",81,0)
 ;---> REPLACE KILLS BELOW WITH $O COMMANDS ABOVE WHEN AVAILABLE.
"RTN","WVUTL8",82,0)
 K WV,WV0,WV1,WV1DX,WV2,WV2DX,WVA,WVABBV,WVABBVS,WVACC
"RTN","WVUTL8",83,0)
 K WVACCN,WVACCP,WVADD,WVAGE,WVAGENCY,WVAGRG,WVAGRP,WVAR,WVAREA
"RTN","WVUTL8",84,0)
 K WVARR,WVARR1,WVASKTIM,WVATT,WVB,WVBDF,WVBEGDF,WVBEGDT
"RTN","WVUTL8",85,0)
 K WVBEGDT1,WVBNEED,WVC,WVC0,WVCAPT,WVCBEDA,WVCC,WVCDC,WVCDCV,WVCHAGE
"RTN","WVUTL8",86,0)
 K WVCHG,WVCHRT,WVCHSSN,WVCMGR,WVCMGR1,WVCNEED,WVCODE,WVCOLPS,WVCONF
"RTN","WVUTL8",87,0)
 K WVCONFF,WVCOUNT,WVCRT,WVCUR,WVD,WVDA,WVDATE,WVDATE1,WVDD,WVDDATE
"RTN","WVUTL8",88,0)
 K WVDEF,WVDFLT,WVDFN,WVDIAG,WVDR,WVDT,WVDUZ0,WVDUZ2,WVDX
"RTN","WVUTL8",89,0)
 K WVE,WVEDC,WVEDCL,WVEDF,WVENDDF,WVENDDT,WVENDDT1,WVENDSAM,WVENDT
"RTN","WVUTL8",90,0)
 K WVERR,WVERROR,WVERRORS,WVFAC,WVFACIL,WVFILE,WVFLNM,WVGBL
"RTN","WVUTL8",91,0)
 K WVGBLN,WVHEADER,WVHCF,WVHFS,WVHLOC,WVHRCN,WVI,WVICD,WVIEN,WVION
"RTN","WVUTL8",92,0)
 K WVITEM,WVITEMS,WVKDT,WVLDAT,WVLFRT,WVLINE,WVLINL,WVLOC,WVLOGO
"RTN","WVUTL8",93,0)
 K WVLOOP,WVLPRG,WVM,WVMABN,WVMAM,WVMAMDT,WVMATCH,WVMENUT,WVMES,WVN
"RTN","WVUTL8",94,0)
 K WVNAMAGE,WVNAME,WVNEW,WVNN,WVNODE,WVNOFAC,WVNOFOL,WVNOMAT,WVNORM
"RTN","WVUTL8",95,0)
 K WVNOW,WVOFAC,WVOLD,WVOLD2,WVOUT,WVPABN,WVPAGE,WVPAP,WVPAPDA,WVPAPDT
"RTN","WVUTL8",96,0)
 K WVPAPRG,WVPAPRG1,WVPAPS,WVPATH,WVPATS,WVPC,WVPCCN,WVPCCP,WVPCD,WVPCDL
"RTN","WVUTL8",97,0)
 K WVPCDN,WVPCDS,WVPCDT,WVPDATE,WVPN,WVPNAME,WVPOP,WVPOP1,WVPOST,WVPPAP
"RTN","WVUTL8",98,0)
 K WVPRE,WVPREG,WVPRIO,WVPRMPT,WVPRMT,WVPRMT1,WVPRMT2,WVPRMTQ,WVPROF
"RTN","WVUTL8",99,0)
 K WVPROV,WVPRPCD,WVPRV,WVPSTAT,WVPTITL,WVPURP,WVPUSER,WVQUE,WVQUIT
"RTN","WVUTL8",100,0)
 K WVRCVDT,WVRES,WVRESN,WVRTN,WVS,WVSAME,WVSCRN,WVSITE,WVSL,WVSPEC
"RTN","WVUTL8",101,0)
 K WVSPTX,WVSS,WVSSN,WVSTART,WVSTAT,WVSTTDT,WVSUB,WVSUBH,WVUSER,WVSV
"RTN","WVUTL8",102,0)
 K WVTAB,WVTEST,WVTIME,WVTIMLN,WVTITLE,WVTITLE1,WVTITLE2,WVTMP
"RTN","WVUTL8",103,0)
 K WVTTAB,WVTYPE,WVUNL,WVVER,WVVFIL,WVVGBL,WVX,WVX0,WVX1,WVX2,WVX3
"RTN","WVUTL8",104,0)
 K WVX4,WVX5,WVX6,WVX7,WVX8,WVX9,WVXPORT,WVXREF,WVY,WVYY
"RTN","WVUTL8",105,0)
 K COL,COLLEN,LEN,NN,NODE,V,POP,WVJPCP,WVJDT,WVJDTO,WVJNDA,WVJTOY
"RTN","WVUTL8",106,0)
 K WVTOY,WVJPAPR,WVJST,WVPR,CN,WVCNT,WVJ,WVJAGER,WVJHDR,WVJTYP
"RTN","WVUTL8",107,0)
 K WVDTIEN,WVJX,WVJDR,WVCN,WVJRNOW,WVBALL,WVALL,WVBV,WVCALL,WVCIVCN
"RTN","WVUTL8",108,0)
 K WVCNALL,WVCV,WVET,WVETCN,WVMALL,WVMV,WVNALL,WVST,WVVALL,WVARJ
"RTN","WVUTL8",109,0)
 K WVJBFAC,WVJCFAC
"RTN","WVUTL8",110,0)
 ;
"RTN","WVUTL8",111,0)
 ;---> ADDED MANUALLY.
"RTN","WVUTL8",112,0)
 K WVMDAT,WVMGR,WVPDAT,WVTOT
"RTN","WVUTL8",113,0)
 K ^TMP("WV",$J)
"RTN","WVUTL8",114,0)
 ;
"RTN","WVUTL8",115,0)
 ;---> FILEMAN KILLS.
"RTN","WVUTL8",116,0)
 D DKILLS^WVFMAN
"RTN","WVUTL8",117,0)
 K X,Y,Z,ZTRTN,ZTSAVE
"RTN","WVUTL8",118,0)
 Q
"RTN","WVYNOTP")
0^63^B8467510
"RTN","WVYNOTP",1,0)
WVYNOTP ; GENERATED FROM 'WV PRINT NOTIF PURPOSE&LETTER' PRINT TEMPLATE (#2598) ; 10/16/97 ; (FILE 790.404, MARGIN=80)
"RTN","WVYNOTP",2,0)
 ;;1.0;WOMEN'S HEALTH;;Sep 30, 1998
"RTN","WVYNOTP",3,0)
 G BEGIN
"RTN","WVYNOTP",4,0)
N W !
"RTN","WVYNOTP",5,0)
T W:$X ! I '$D(DIOT(2)),DN,$D(IOSL),$S('$D(DIWF):1,$P(DIWF,"B",2):$P(DIWF,"B",2),1:1)+$Y'<IOSL,$D(^UTILITY($J,1))#2,^(1)?1U1P1E.E X ^(1)
"RTN","WVYNOTP",6,0)
 S DISTP=DISTP+1,DILCT=DILCT+1 D:'(DISTP#100) CSTP^DIO2
"RTN","WVYNOTP",7,0)
 Q
"RTN","WVYNOTP",8,0)
DT I $G(DUZ("LANG"))>1,Y W $$OUT^DIALOGU(Y,"DD") Q
"RTN","WVYNOTP",9,0)
 I Y W $P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC",U,$E(Y,4,5))_" " W:Y#100 $J(Y#100\1,2)_"," W Y\10000+1700 W:Y#1 "  "_$E(Y_0,9,10)_":"_$E(Y_"000",11,12) Q
"RTN","WVYNOTP",10,0)
 W Y Q
"RTN","WVYNOTP",11,0)
M D @DIXX
"RTN","WVYNOTP",12,0)
 Q
"RTN","WVYNOTP",13,0)
BEGIN ;
"RTN","WVYNOTP",14,0)
 S:'$D(DN) DN=1 S DISTP=$G(DISTP),DILCT=$G(DILCT)
"RTN","WVYNOTP",15,0)
 I $D(DXS)<9 F X=0:0 S X=$O(^DIPT(2598,"DXS",X)) Q:'X  S Y=$O(^(X,"")) F X=X:0 Q:Y=""  S DXS(X,Y)=^(Y),Y=$O(^(Y))
"RTN","WVYNOTP",16,0)
 W ?0 S:$D(WVPAGE) WVPAGE=WVPAGE+1 K DIP K:DN Y
"RTN","WVYNOTP",17,0)
 D N:$X>0 Q:'DN  W ?0 W "NOTIFICATION PURPOSE & LETTER LIST"
"RTN","WVYNOTP",18,0)
 D N:$X>47 Q:'DN  W ?47 S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X K DIP K:DN Y S Y=X D DT
"RTN","WVYNOTP",19,0)
 D N:$X>69 Q:'DN  W ?69 W:$D(WVPAGE) "PAGE "_WVPAGE K DIP K:DN Y
"RTN","WVYNOTP",20,0)
 D N:$X>0 Q:'DN  W ?0 S X="-",DIP(1)=X S X=80,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) K DIP K:DN Y W X
"RTN","WVYNOTP",21,0)
 D T Q:'DN  D N D N:$X>1 Q:'DN  W ?1 W "PURPOSE: "
"RTN","WVYNOTP",22,0)
 S X=$G(^WV(790.404,D0,0)) W ?1,$E($P(X,U,1),1,50)
"RTN","WVYNOTP",23,0)
 D N:$X>54 Q:'DN  W ?54 W "SYNONYM: "
"RTN","WVYNOTP",24,0)
 W ?54,$E($P(X,U,3),1,6)
"RTN","WVYNOTP",25,0)
 D N:$X>0 Q:'DN  W ?0 W "PRIORITY: "
"RTN","WVYNOTP",26,0)
 W ?0 S Y=$P(X,U,2) W:Y]"" $S($D(DXS(1,Y)):DXS(1,Y),1:Y)
"RTN","WVYNOTP",27,0)
 D N:$X>55 Q:'DN  W ?55 W "ACTIVE: "
"RTN","WVYNOTP",28,0)
 W ?55 S Y=$P(X,U,4) W:Y]"" $S($D(DXS(2,Y)):DXS(2,Y),1:Y)
"RTN","WVYNOTP",29,0)
 D N:$X>0 Q:'DN  W ?0 W "BR or CX: "
"RTN","WVYNOTP",30,0)
 W ?0 S Y=$P(X,U,5) W:Y]"" $S($D(DXS(3,Y)):DXS(3,Y),1:Y)
"RTN","WVYNOTP",31,0)
 D N:$X>0 Q:'DN  W ?0 S Y=$P(X,U,6) W:Y]"" $S($D(DXS(4,Y)):DXS(4,Y),1:Y)
"RTN","WVYNOTP",32,0)
 W ?0 W " LETTER:"
"RTN","WVYNOTP",33,0)
 D T Q:'DN  D N W ?0 W ""
"RTN","WVYNOTP",34,0)
 S:'$D(DIWF) DIWF="" S:DIWF'["N" DIWF=DIWF_"N" S X="" S I(1)=1,J(1)=790.414 F D1=0:0 Q:$O(^WV(790.404,D0,1,D1))'>0  S D1=$O(^(D1)) D:$X>2 T Q:'DN  D A1
"RTN","WVYNOTP",35,0)
 G A1R
"RTN","WVYNOTP",36,0)
A1 ;
"RTN","WVYNOTP",37,0)
 S X=$G(^WV(790.404,D0,1,D1,0)) S DIWL=3,DIWR=78 D ^DIWP
"RTN","WVYNOTP",38,0)
 Q
"RTN","WVYNOTP",39,0)
A1R ;
"RTN","WVYNOTP",40,0)
 D A^DIWW
"RTN","WVYNOTP",41,0)
 D T Q:'DN  W ?2 D:$E(IOST)="C" DIRZ^WVUTL3 K DIP K:DN Y
"RTN","WVYNOTP",42,0)
 W ?15 W @IOF K DIP K:DN Y
"RTN","WVYNOTP",43,0)
 K Y K DIWF
"RTN","WVYNOTP",44,0)
 Q
"RTN","WVYNOTP",45,0)
HEAD ;
"RTN","WVYNOTP",46,0)
 W !,?0,"S:$D(WVPAGE)"
"RTN","WVYNOTP",47,0)
 W !,?0,"WVPAGE=WVPAGE+1"
"RTN","WVYNOTP",48,0)
 W !,?47,"NOW"
"RTN","WVYNOTP",49,0)
 W !,?0,"DUP("
"RTN","WVYNOTP",50,0)
 W !,?1,"NOTIFICATION PURPOSE",?54,"SYNONYM"
"RTN","WVYNOTP",51,0)
 W !,?0,"PRIORITY",?55,"ACTIVE"
"RTN","WVYNOTP",52,0)
 W !,?0,"ASSOCIATE"
"RTN","WVYNOTP",53,0)
 W !,?0,"WITH BR/CX"
"RTN","WVYNOTP",54,0)
 W !,?0,"TX"
"RTN","WVYNOTP",55,0)
 W !,?2,"LETTER TEXT"
"RTN","WVYNOTP",56,0)
 W !,?2,"D:$E(IOST)=",?15,"W @IOF"
"RTN","WVYNOTP",57,0)
 W !,"--------------------------------------------------------------------------------",!!
"SEC","^DIC",790,790,0,"AUDIT")
@
"SEC","^DIC",790,790,0,"DD")
@
"SEC","^DIC",790,790,0,"DEL")

"SEC","^DIC",790,790,0,"LAYGO")

"SEC","^DIC",790,790,0,"RD")

"SEC","^DIC",790,790,0,"WR")

"SEC","^DIC",790.01,790.01,0,"AUDIT")
@
"SEC","^DIC",790.01,790.01,0,"DD")
@
"SEC","^DIC",790.01,790.01,0,"DEL")

"SEC","^DIC",790.01,790.01,0,"LAYGO")

"SEC","^DIC",790.01,790.01,0,"RD")

"SEC","^DIC",790.01,790.01,0,"WR")

"SEC","^DIC",790.02,790.02,0,"AUDIT")
@
"SEC","^DIC",790.02,790.02,0,"DD")
@
"SEC","^DIC",790.02,790.02,0,"DEL")

"SEC","^DIC",790.02,790.02,0,"LAYGO")

"SEC","^DIC",790.02,790.02,0,"RD")

"SEC","^DIC",790.02,790.02,0,"WR")

"SEC","^DIC",790.03,790.03,0,"AUDIT")
@
"SEC","^DIC",790.03,790.03,0,"DD")
@
"SEC","^DIC",790.03,790.03,0,"DEL")

"SEC","^DIC",790.03,790.03,0,"LAYGO")

"SEC","^DIC",790.03,790.03,0,"RD")

"SEC","^DIC",790.03,790.03,0,"WR")

"SEC","^DIC",790.04,790.04,0,"AUDIT")
@
"SEC","^DIC",790.04,790.04,0,"DD")
@
"SEC","^DIC",790.04,790.04,0,"DEL")

"SEC","^DIC",790.04,790.04,0,"LAYGO")

"SEC","^DIC",790.04,790.04,0,"RD")

"SEC","^DIC",790.04,790.04,0,"WR")

"SEC","^DIC",790.05,790.05,0,"AUDIT")
@
"SEC","^DIC",790.05,790.05,0,"DD")
@
"SEC","^DIC",790.05,790.05,0,"DEL")

"SEC","^DIC",790.05,790.05,0,"LAYGO")

"SEC","^DIC",790.05,790.05,0,"RD")

"SEC","^DIC",790.05,790.05,0,"WR")

"SEC","^DIC",790.07,790.07,0,"AUDIT")
@
"SEC","^DIC",790.07,790.07,0,"DD")
@
"SEC","^DIC",790.07,790.07,0,"DEL")

"SEC","^DIC",790.07,790.07,0,"LAYGO")

"SEC","^DIC",790.07,790.07,0,"RD")

"SEC","^DIC",790.07,790.07,0,"WR")

"SEC","^DIC",790.1,790.1,0,"AUDIT")
@
"SEC","^DIC",790.1,790.1,0,"DD")
@
"SEC","^DIC",790.1,790.1,0,"DEL")

"SEC","^DIC",790.1,790.1,0,"LAYGO")

"SEC","^DIC",790.1,790.1,0,"RD")

"SEC","^DIC",790.1,790.1,0,"WR")

"SEC","^DIC",790.2,790.2,0,"AUDIT")
@
"SEC","^DIC",790.2,790.2,0,"DD")
@
"SEC","^DIC",790.2,790.2,0,"DEL")

"SEC","^DIC",790.2,790.2,0,"LAYGO")

"SEC","^DIC",790.2,790.2,0,"RD")

"SEC","^DIC",790.2,790.2,0,"WR")

"SEC","^DIC",790.3,790.3,0,"AUDIT")
@
"SEC","^DIC",790.3,790.3,0,"DD")
@
"SEC","^DIC",790.3,790.3,0,"DEL")

"SEC","^DIC",790.3,790.3,0,"LAYGO")

"SEC","^DIC",790.3,790.3,0,"RD")

"SEC","^DIC",790.3,790.3,0,"WR")

"SEC","^DIC",790.31,790.31,0,"AUDIT")
@
"SEC","^DIC",790.31,790.31,0,"DD")
@
"SEC","^DIC",790.31,790.31,0,"DEL")

"SEC","^DIC",790.31,790.31,0,"LAYGO")

"SEC","^DIC",790.31,790.31,0,"RD")

"SEC","^DIC",790.31,790.31,0,"WR")

"SEC","^DIC",790.32,790.32,0,"AUDIT")
@
"SEC","^DIC",790.32,790.32,0,"DD")
@
"SEC","^DIC",790.32,790.32,0,"DEL")

"SEC","^DIC",790.32,790.32,0,"LAYGO")

"SEC","^DIC",790.32,790.32,0,"RD")

"SEC","^DIC",790.32,790.32,0,"WR")

"SEC","^DIC",790.4,790.4,0,"AUDIT")
@
"SEC","^DIC",790.4,790.4,0,"DD")
@
"SEC","^DIC",790.4,790.4,0,"DEL")

"SEC","^DIC",790.4,790.4,0,"LAYGO")

"SEC","^DIC",790.4,790.4,0,"RD")

"SEC","^DIC",790.4,790.4,0,"WR")

"SEC","^DIC",790.403,790.403,0,"AUDIT")
@
"SEC","^DIC",790.403,790.403,0,"DD")
@
"SEC","^DIC",790.403,790.403,0,"DEL")

"SEC","^DIC",790.403,790.403,0,"LAYGO")

"SEC","^DIC",790.403,790.403,0,"RD")

"SEC","^DIC",790.403,790.403,0,"WR")

"SEC","^DIC",790.404,790.404,0,"AUDIT")
@
"SEC","^DIC",790.404,790.404,0,"DD")
@
"SEC","^DIC",790.404,790.404,0,"DEL")

"SEC","^DIC",790.404,790.404,0,"LAYGO")

"SEC","^DIC",790.404,790.404,0,"RD")

"SEC","^DIC",790.404,790.404,0,"WR")

"SEC","^DIC",790.405,790.405,0,"AUDIT")
@
"SEC","^DIC",790.405,790.405,0,"DD")
@
"SEC","^DIC",790.405,790.405,0,"DEL")

"SEC","^DIC",790.405,790.405,0,"LAYGO")

"SEC","^DIC",790.405,790.405,0,"RD")

"SEC","^DIC",790.405,790.405,0,"WR")

"SEC","^DIC",790.5,790.5,0,"AUDIT")
@
"SEC","^DIC",790.5,790.5,0,"DD")
@
"SEC","^DIC",790.5,790.5,0,"DEL")

"SEC","^DIC",790.5,790.5,0,"LAYGO")

"SEC","^DIC",790.5,790.5,0,"RD")

"SEC","^DIC",790.5,790.5,0,"WR")

"SEC","^DIC",790.51,790.51,0,"AUDIT")
@
"SEC","^DIC",790.51,790.51,0,"DD")
@
"SEC","^DIC",790.51,790.51,0,"DEL")

"SEC","^DIC",790.51,790.51,0,"LAYGO")

"SEC","^DIC",790.51,790.51,0,"RD")

"SEC","^DIC",790.51,790.51,0,"WR")

"SEC","^DIC",790.6,790.6,0,"AUDIT")
@
"SEC","^DIC",790.6,790.6,0,"DD")
@
"SEC","^DIC",790.6,790.6,0,"DEL")

"SEC","^DIC",790.6,790.6,0,"LAYGO")

"SEC","^DIC",790.6,790.6,0,"RD")

"SEC","^DIC",790.6,790.6,0,"WR")

"SEC","^DIC",790.71,790.71,0,"AUDIT")
@
"SEC","^DIC",790.71,790.71,0,"DD")
@
"SEC","^DIC",790.71,790.71,0,"DEL")

"SEC","^DIC",790.71,790.71,0,"LAYGO")

"SEC","^DIC",790.71,790.71,0,"RD")

"SEC","^DIC",790.71,790.71,0,"WR")

"SEC","^DIC",790.72,790.72,0,"AUDIT")
@
"SEC","^DIC",790.72,790.72,0,"DD")
@
"SEC","^DIC",790.72,790.72,0,"DEL")

"SEC","^DIC",790.72,790.72,0,"LAYGO")

"SEC","^DIC",790.72,790.72,0,"RD")

"SEC","^DIC",790.72,790.72,0,"WR")

"VER")
8.0^21.0
"^DD",790,790,0)
FIELD^^.27^24
"^DD",790,790,0,"DDA")
N
"^DD",790,790,0,"DT")
2980616
"^DD",790,790,0,"ID",.1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790.01,+$P(^(0),U,10),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790.01,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790,790,0,"IX","AEDC",790,.13)

"^DD",790,790,0,"IX","AEDC1",790,.14)

"^DD",790,790,0,"IX","APDLOG",790,.17)

"^DD",790,790,0,"IX","APRLOG",790,.16)

"^DD",790,790,0,"IX","B",790,.01)

"^DD",790,790,0,"IX","C",790,.1)

"^DD",790,790,0,"NM","WV PATIENT")

"^DD",790,790,0,"PT",790.04,.02)

"^DD",790,790,0,"PT",790.05,.02)

"^DD",790,790,0,"PT",790.1,.02)

"^DD",790,790,0,"PT",790.3,1)

"^DD",790,790,0,"PT",790.4,.01)

"^DD",790,790,0,"VRPK")
WOMEN'S HEALTH
"^DD",790,790,.01,0)
NAME^RP2'X^DPT(^0;1^S:$D(X) DINUM=X I $P(^DPT(DINUM,0),"^",2)'="F" K X D EN^DDIOL("Patient is not female.")
"^DD",790,790,.01,1,0)
^.1^^-1
"^DD",790,790,.01,1,1,0)
790^B
"^DD",790,790,.01,1,1,1)
S ^WV(790,"B",$E(X,1,30),DA)=""
"^DD",790,790,.01,1,1,2)
K ^WV(790,"B",$E(X,1,30),DA)
"^DD",790,790,.01,3)

"^DD",790,790,.01,21,0)
^^2^2^2980918^
"^DD",790,790,.01,21,1,0)
This field contains the patient's name.  It is a pointer to the Patient
"^DD",790,790,.01,21,2,0)
(#2) file.
"^DD",790,790,.01,"DT")
2980508
"^DD",790,790,.02,0)
MAILING ADDRESS-STREET^CJ25^^ ; ^X ^DD(790,.02,9.2) S X=$P(Y(790,.02,101),U,1) S D0=Y(790,.02,80)
"^DD",790,790,.02,9)
^
"^DD",790,790,.02,9.01)
2^.111;790^.01
"^DD",790,790,.02,9.1)
.01:.111
"^DD",790,790,.02,9.2)
S Y(790,.02,80)=$S($D(D0):D0,1:""),Y(790,.02,1)=$S($D(^WV(790,D0,0)):^(0),1:""),D0=$P(Y(790,.02,1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S Y(790,.02,101)=$S($D(^DPT(D0,.11)):^(.11),1:"")
"^DD",790,790,.02,21,0)
^^2^2^2980629^
"^DD",790,790,.02,21,1,0)
The street mailing address of this patient.  This is computed from data in
"^DD",790,790,.02,21,2,0)
the Patient file.
"^DD",790,790,.02,"DT")
2980513
"^DD",790,790,.03,0)
MAILING ADDRESS-CITY^CJ20^^ ; ^X ^DD(790,.03,9.2) S X=$P(Y(790,.03,101),U,4) S D0=Y(790,.03,80)
"^DD",790,790,.03,9)
^
"^DD",790,790,.03,9.01)
2^.114;790^.01
"^DD",790,790,.03,9.1)
.01:.114
"^DD",790,790,.03,9.2)
S Y(790,.03,80)=$S($D(D0):D0,1:""),Y(790,.03,1)=$S($D(^WV(790,D0,0)):^(0),1:""),D0=$P(Y(790,.03,1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S Y(790,.03,101)=$S($D(^DPT(D0,.11)):^(.11),1:"")
"^DD",790,790,.03,21,0)
^^2^2^2980629^
"^DD",790,790,.03,21,1,0)
The city mailing address for this patient.  This information in this field
"^DD",790,790,.03,21,2,0)
is obtained from the Patient file.
"^DD",790,790,.03,"DT")
2980513
"^DD",790,790,.04,0)
MAILING ADDRESS-STATE^CJ2^^ ; ^X ^DD(790,.04,9.3) S X=$P(Y(790,.04,201),U,2) S D0=Y(790,.04,80)
"^DD",790,790,.04,9)
^
"^DD",790,790,.04,9.01)
5^1;2^.115;790^.01
"^DD",790,790,.04,9.1)
.01:.115:1
"^DD",790,790,.04,9.2)
S Y(790,.04,80)=$S($D(D0):D0,1:""),Y(790,.04,1)=$S($D(^WV(790,D0,0)):^(0),1:""),D0=$P(Y(790,.04,1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S Y(790,.04,180)=$S($D(D0):D0,1:"")
"^DD",790,790,.04,9.3)
X ^DD(790,.04,9.2) S Y(790,.04,101)=$S($D(^DPT(D0,.11)):^(.11),1:""),D0=$P(Y(790,.04,101),U,5) S:'$D(^DIC(5,+D0,0)) D0=-1 S Y(790,.04,201)=$S($D(^DIC(5,D0,0)):^(0),1:"")
"^DD",790,790,.04,21,0)
^^2^2^2980918^
"^DD",790,790,.04,21,1,0)
The State portion of this patient's mailing address, obtained from the
"^DD",790,790,.04,21,2,0)
Patient file.
"^DD",790,790,.04,"DT")
2980513
"^DD",790,790,.05,0)
MAILING ADDRESS-ZIP^CJ10^^ ; ^X ^DD(790,.05,9.2) S X=$P(Y(790,.05,101),U,6) S D0=Y(790,.05,80)
"^DD",790,790,.05,9)
^
"^DD",790,790,.05,9.01)
2^.116;790^.01
"^DD",790,790,.05,9.1)
.01:.116
"^DD",790,790,.05,9.2)
S Y(790,.05,80)=$S($D(D0):D0,1:""),Y(790,.05,1)=$S($D(^WV(790,D0,0)):^(0),1:""),D0=$P(Y(790,.05,1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S Y(790,.05,101)=$S($D(^DPT(D0,.11)):^(.11),1:"")
"^DD",790,790,.05,21,0)
^^2^2^2980918^
"^DD",790,790,.05,21,1,0)
The zip code portion of this patient's mailing address is obtained from
"^DD",790,790,.05,21,2,0)
the Patient file.
"^DD",790,790,.05,"DT")
2980513
"^DD",790,790,.06,0)
SSN#^CJ12^^ ; ^X ^DD(790,.06,9.2) S X=$P(Y(790,.06,101),U,9) S D0=Y(790,.06,80)
"^DD",790,790,.06,9)
^
"^DD",790,790,.06,9.01)
2^.09;790^.01
"^DD",790,790,.06,9.1)
.01:SSN
"^DD",790,790,.06,9.2)
S Y(790,.06,80)=$S($D(D0):D0,1:""),Y(790,.06,1)=$S($D(^WV(790,D0,0)):^(0),1:""),D0=$P(Y(790,.06,1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S Y(790,.06,101)=$S($D(^DPT(D0,0)):^(0),1:"")
"^DD",790,790,.06,21,0)
^^2^2^2980918^
"^DD",790,790,.06,21,1,0)
This computed field gathers the patient's social security number from the
"^DD",790,790,.06,21,2,0)
Patient file.
"^DD",790,790,.06,"DT")
2980518
"^DD",790,790,.1,0)
CASE MANAGER^RP790.01'^WV(790.01,^0;10^Q
"^DD",790,790,.1,1,0)
^.1
"^DD",790,790,.1,1,1,0)
790^C
"^DD",790,790,.1,1,1,1)
S ^WV(790,"C",$E(X,1,30),DA)=""
"^DD",790,790,.1,1,1,2)
K ^WV(790,"C",$E(X,1,30),DA)
"^DD",790,790,.1,1,1,"DT")
2940917
"^DD",790,790,.1,3)
Select the person who is currently managing this patient's breast and cervical treatment needs, letters, follow-up, etc.
"^DD",790,790,.1,21,0)
^^2^2^2980918^^
"^DD",790,790,.1,21,1,0)
This field contains the name of the person who is currently managing the
"^DD",790,790,.1,21,2,0)
women's health care needs of this patient.
"^DD",790,790,.1,"DT")
2980507
"^DD",790,790,.11,0)
CX TX NEED^P790.5'^WV(790.5,^0;11^Q
"^DD",790,790,.11,3)
Select the current or next cervical procedure needed for this patient.
"^DD",790,790,.11,21,0)
^^2^2^2980629^
"^DD",790,790,.11,21,1,0)
This field contains the name of the current or next cervical procedure or
"^DD",790,790,.11,21,2,0)
treatment need scheduled for this patient.
"^DD",790,790,.11,"DT")
2980507
"^DD",790,790,.12,0)
CX TX NEED DUE DATE^D^^0;12^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",790,790,.12,3)
Enter the date by which this cervical treatment need should be completed.
"^DD",790,790,.12,21,0)
^^2^2^2980918^^
"^DD",790,790,.12,21,1,0)
This field contains the date when this cervical procedure or treatment
"^DD",790,790,.12,21,2,0)
need should be completed.
"^DD",790,790,.12,"DT")
2950317
"^DD",790,790,.13,0)
CURRENTLY PREGNANT^S^1:YES;0:NO;^0;13^Q
"^DD",790,790,.13,1,0)
^.1
"^DD",790,790,.13,1,1,0)
790^AEDC^MUMPS
"^DD",790,790,.13,1,1,1)
S WVPREG=X,WVEDC=$P(^WV(790,DA,0),U,14) D STOREDC^WVUTL3
"^DD",790,790,.13,1,1,2)
S WVPREG="",WVEDC=0 D STOREDC^WVUTL3
"^DD",790,790,.13,1,1,"DT")
2941024
"^DD",790,790,.13,3)
Enter 'Yes' if this patient is currently pregnant, 'No' if not, and leave blank if unknown.
"^DD",790,790,.13,21,0)
^^4^4^2980918^^
"^DD",790,790,.13,21,1,0)
This field contains information on the pregnancy status of the patient.
"^DD",790,790,.13,21,2,0)
The status is a set of codes: 1 = Yes if this patient is currently
"^DD",790,790,.13,21,3,0)
pregnant, 0 = No, if not.  When the pregnanacy status is unknown, the
"^DD",790,790,.13,21,4,0)
field is blank.
"^DD",790,790,.13,"DT")
2941024
"^DD",790,790,.14,0)
EDC^D^^0;14^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",790,790,.14,1,0)
^.1
"^DD",790,790,.14,1,1,0)
790^AEDC1^MUMPS
"^DD",790,790,.14,1,1,1)
S WVEDC=X,WVPREG=$P(^WV(790,DA,0),U,13) D STOREDC^WVUTL3
"^DD",790,790,.14,1,1,2)
S WVEDC="",WVPREG=$P(^WV(790,DA,0),U,13) D STOREDC^WVUTL3
"^DD",790,790,.14,1,1,"DT")
2941024
"^DD",790,790,.14,3)
Enter the estimated date of confinement (delivery date).
"^DD",790,790,.14,21,0)
^^2^2^2980918^^^
"^DD",790,790,.14,21,1,0)
This field stores the patient's delivery date or estimated date of
"^DD",790,790,.14,21,2,0)
confinement (EDC).
"^DD",790,790,.14,"DT")
2941024
"^DD",790,790,.15,0)
DES DAUGHTER^S^1:YES;0:NO;^0;15^Q
"^DD",790,790,.15,3)
Enter 'Yes' if this patient's mother took DES when she was pregnant with this patient.
"^DD",790,790,.15,21,0)
^^3^3^2980918^^
"^DD",790,790,.15,21,1,0)
This field indicates if this patient's mother took diethylstilbestrol
"^DD",790,790,.15,21,2,0)
(DES) when she was pregnant with this patient.  If unknown, leave this
"^DD",790,790,.15,21,3,0)
field blank.
"^DD",790,790,.15,"DT")
2950118
"^DD",790,790,.16,0)
PAP REGIMEN^P790.03'^WV(790.03,^0;16^Q
"^DD",790,790,.16,1,0)
^.1
"^DD",790,790,.16,1,1,0)
790^APRLOG^MUMPS
"^DD",790,790,.16,1,1,1)
S WVLPRG=X,WVLDAT=$P(^WV(790,DA,0),U,17) D STORPAP^WVUTL3
"^DD",790,790,.16,1,1,2)
;
"^DD",790,790,.16,1,1,"DT")
2941021
"^DD",790,790,.16,3)

"^DD",790,790,.16,21,0)
^^1^1^2980630^^^
"^DD",790,790,.16,21,1,0)
This field stores the current PAP regimen for the patient.
"^DD",790,790,.16,"DT")
2980507
"^DD",790,790,.17,0)
PAP REGIMEN START DATE^D^^0;17^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",790,790,.17,1,0)
^.1
"^DD",790,790,.17,1,1,0)
790^APDLOG^MUMPS
"^DD",790,790,.17,1,1,1)
S WVLDAT=X,WVLPRG=$P(^WV(790,DA,0),U,16) D STORPAP^WVUTL3
"^DD",790,790,.17,1,1,2)
;
"^DD",790,790,.17,1,1,"DT")
2941021
"^DD",790,790,.17,3)
Enter the date on which the patient began or will begin the current PAP regimen.
"^DD",790,790,.17,21,0)
^^2^2^2980918^
"^DD",790,790,.17,21,1,0)
This field stores a date on which the patient began or will begin her
"^DD",790,790,.17,21,2,0)
current PAP regimen.
"^DD",790,790,.17,"DT")
2941021
"^DD",790,790,.18,0)
BR TX NEED^P790.51'^WV(790.51,^0;18^Q
"^DD",790,790,.18,3)
Select the current or next breast study procedure needed for this patient.
"^DD",790,790,.18,21,0)
^^2^2^2980630^
"^DD",790,790,.18,21,1,0)
This field contains the name of the the current or next breast study
"^DD",790,790,.18,21,2,0)
procedure needed for this patient.
"^DD",790,790,.18,"DT")
2980507
"^DD",790,790,.19,0)
BR TX NEED DUE DATE^D^^0;19^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",790,790,.19,3)
Enter the date by which this breast Tx procedure should be completed.
"^DD",790,790,.19,21,0)
^^2^2^2980924^
"^DD",790,790,.19,21,1,0)
This field contains the date by which the breast treatment procedure
"^DD",790,790,.19,21,2,0)
should be completed.
"^DD",790,790,.19,"DT")
2950317
"^DD",790,790,.21,0)
DATE OF FIRST ENCOUNTER^DX^^0;21^S %DT="EX",%DT(0)=-DT D ^%DT S X=Y K:Y<1 X K %DT(0)
"^DD",790,790,.21,3)
Enter the date on which this patient was enrolled in the Women's Health package.
"^DD",790,790,.21,21,0)
^^4^4^2980828^^
"^DD",790,790,.21,21,1,0)
This field contains the date of the patient's first clinic visit.
"^DD",790,790,.21,21,2,0)
Although a date is automatically stuffed when the Automatically Load
"^DD",790,790,.21,21,3,0)
Patients [WV AUTOLOAD PATIENTS] option is run, the information can be
"^DD",790,790,.21,21,4,0)
edited through the Edit/Print Patient Case Data option.
"^DD",790,790,.21,"DT")
2980723
"^DD",790,790,.22,0)
REFERRAL SOURCE^P790.07'^WV(790.07,^0;22^Q
"^DD",790,790,.22,3)

"^DD",790,790,.22,21,0)
^^3^3^2980630^
"^DD",790,790,.22,21,1,0)
This field stores information on who referred the patient or how the
"^DD",790,790,.22,21,2,0)
patient found out about the womens health care services at the facility.
"^DD",790,790,.22,21,3,0)
This field points to entries in the WV Referral Source (#790.07) file.
"^DD",790,790,.22,"DT")
2980520
"^DD",790,790,.23,0)
FAMILY HX OF BR CA^S^0:no family history;1:2nd degree relative;2:1st degree relative;3:>1 1st degree relatives;^0;23^Q
"^DD",790,790,.23,3)
Enter the code that describes the category of relative(s) who have had breast cancer.  (1st degree relative is a sister/mother, 2nd degree relatives are extended family.)
"^DD",790,790,.23,21,0)
^^5^5^2980630^^
"^DD",790,790,.23,21,1,0)
This field identifies if the patient's relatives have had breast cancer.
"^DD",790,790,.23,21,2,0)
The information may be selected from a set of codes to indicate no family
"^DD",790,790,.23,21,3,0)
history, a 2nd degree relative (cousin, aunt, grandmother), a 1st degree
"^DD",790,790,.23,21,4,0)
relative (mother OR sister) or multiple 1st degree relatives (mother AND
"^DD",790,790,.23,21,5,0)
sister).
"^DD",790,790,.23,"DT")
2960208
"^DD",790,790,.24,0)
DATE INACTIVE^D^^0;24^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790,790,.24,3)
Enter the date on which this patient became inactive.  ANY date (past, present or future) will cause this patient to be excluded from all reports that assess treatment needs.
"^DD",790,790,.24,21,0)
^^5^5^2980918^
"^DD",790,790,.24,21,1,0)
This field contains the date on which this patient's record became
"^DD",790,790,.24,21,2,0)
inactive.  ANY date (past, present or future) will cause this patient's
"^DD",790,790,.24,21,3,0)
data to be excluded from all reports that assess treatment needs (i.e.,
"^DD",790,790,.24,21,4,0)
Snapshot of the Program Today report and Browse Patients with Needs Past
"^DD",790,790,.24,21,5,0)
Due).
"^DD",790,790,.24,"DT")
2960301
"^DD",790,790,.25,0)
BREAST TX FACILITY^P4'^DIC(4,^0;25^Q
"^DD",790,790,.25,3)
The name of the facility that has the responsibility to provide the appropriate breast tests/exams for this patient.
"^DD",790,790,.25,21,0)
^^3^3^2980918^^
"^DD",790,790,.25,21,1,0)
The name of the facility responsible for performing breast diagnostic
"^DD",790,790,.25,21,2,0)
procedures for this patient if treatment is performed at another facility.
"^DD",790,790,.25,21,3,0)
Facility choices are limited to entries in the Institution (#4) file.
"^DD",790,790,.25,"DT")
2980526
"^DD",790,790,.26,0)
CERVICAL TX FACILITY^P4'^DIC(4,^0;26^Q
"^DD",790,790,.26,3)
The name of the facility that has the responsibility to provide the appropriate cervical tests/exams for this patient.
"^DD",790,790,.26,21,0)
^^4^4^2980918^^
"^DD",790,790,.26,21,1,0)
The name of the facility that is responsible for providing the
"^DD",790,790,.26,21,2,0)
gynecological tests/exams for this patient if treatment is performed at
"^DD",790,790,.26,21,3,0)
another facility. Facility choices are limited to entries in the
"^DD",790,790,.26,21,4,0)
Institution (#4) file.
"^DD",790,790,.26,"DT")
2980526
"^DD",790,790,.27,0)
SEXUAL TRAUMA^S^M:Military;C:Civilian;B:Both;^0;27^Q
"^DD",790,790,.27,21,0)
^^2^2^2980630^
"^DD",790,790,.27,21,1,0)
This field indicates if the patient has experienced any sexual trauma
"^DD",790,790,.27,21,2,0)
(rape, sexual assault, etc.) either in the military and/or as a civilian.
"^DD",790,790,.27,"DT")
2980617
"^DD",790,790,1.01,0)
NOTES^790.06^^1;0
"^DD",790,790,1.01,21,0)
^^2^2^2980706^
"^DD",790,790,1.01,21,1,0)
This field stores special notes regarding the patient and her health care
"^DD",790,790,1.01,21,2,0)
needs.
"^DD",790,790.06,0)
NOTES SUB-FIELD^^.01^1
"^DD",790,790.06,0,"NM","NOTES")

"^DD",790,790.06,0,"UP")
790
"^DD",790,790.06,0,"VRPK")
WOMEN'S HEALTH
"^DD",790,790.06,.01,0)
NOTES^W^^0;1^Q
"^DD",790,790.06,.01,3)
Enter any special notes regarding the patient.
"^DD",790,790.06,.01,21,0)
^^1^1^2980513^^^
"^DD",790,790.06,.01,21,1,0)
Enter any special notes regarding the patient
"^DD",790,790.06,.01,"DT")
2941028
"^DD",790.01,790.01,0)
FIELD^^.02^2
"^DD",790.01,790.01,0,"DDA")
N
"^DD",790.01,790.01,0,"IX","B",790.01,.01)

"^DD",790.01,790.01,0,"IX","U",790.01,.01)

"^DD",790.01,790.01,0,"NM","WV CASE MANAGER")

"^DD",790.01,790.01,0,"PT",790,.1)

"^DD",790.01,790.01,0,"PT",790.02,.02)

"^DD",790.01,790.01,0,"SCR")
I $$SC^WVUTL1A(+Y)
"^DD",790.01,790.01,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.01,790.01,.01,0)
CASE MANAGER^RP200'X^VA(200,^0;1^S:$D(X) DINUM=X
"^DD",790.01,790.01,.01,1,0)
^.1
"^DD",790.01,790.01,.01,1,1,0)
790.01^B
"^DD",790.01,790.01,.01,1,1,1)
S ^WV(790.01,"B",$E(X,1,30),DA)=""
"^DD",790.01,790.01,.01,1,1,2)
K ^WV(790.01,"B",$E(X,1,30),DA)
"^DD",790.01,790.01,.01,1,2,0)
790.01^U^MUMPS
"^DD",790.01,790.01,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.01,")
"^DD",790.01,790.01,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.01,")
"^DD",790.01,790.01,.01,1,2,"%D",0)
^^1^1^2960308^^
"^DD",790.01,790.01,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.01,790.01,.01,1,2,"DT")
2960308
"^DD",790.01,790.01,.01,3)
Enter the name of the person who will be a Women's Health case manager.
"^DD",790.01,790.01,.01,21,0)
^^2^2^2980924^^^
"^DD",790.01,790.01,.01,21,1,0)
This field contains the name(s) of WH case manager(s) assigned to manage
"^DD",790.01,790.01,.01,21,2,0)
women's health needs.
"^DD",790.01,790.01,.01,"DT")
2960308
"^DD",790.01,790.01,.02,0)
DATE INACTIVATED^D^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.01,790.01,.02,3)
Enter the date on which this case manager will be no longer active as a Women's Health case manager.
"^DD",790.01,790.01,.02,21,0)
^^2^2^2980918^^
"^DD",790.01,790.01,.02,21,1,0)
This date field is used to indicate when a person is no longer recognized
"^DD",790.01,790.01,.02,21,2,0)
as a case manager.   
"^DD",790.01,790.01,.02,"DT")
2940923
"^DD",790.02,790.02,0)
FIELD^^.15^65
"^DD",790.02,790.02,0,"DT")
2980630
"^DD",790.02,790.02,0,"IX","B",790.02,.01)

"^DD",790.02,790.02,0,"NM","WV SITE PARAMETER")

"^DD",790.02,790.02,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.02,790.02,.01,0)
SITE/FACILITY NAME^RP4'X^DIC(4,^0;1^S:$D(X) DINUM=X
"^DD",790.02,790.02,.01,1,0)
^.1
"^DD",790.02,790.02,.01,1,1,0)
790.02^B
"^DD",790.02,790.02,.01,1,1,1)
S ^WV(790.02,"B",$E(X,1,30),DA)=""
"^DD",790.02,790.02,.01,1,1,2)
K ^WV(790.02,"B",$E(X,1,30),DA)
"^DD",790.02,790.02,.01,3)
Select the facility whose Women's Health site parameters you which to set.
"^DD",790.02,790.02,.01,21,0)
^^4^4^2980924^
"^DD",790.02,790.02,.01,21,1,0)
This is the name of the facility, division, and/or community based
"^DD",790.02,790.02,.01,21,2,0)
outpatient clinic requiring separate site parameters.  If all divisions
"^DD",790.02,790.02,.01,21,3,0)
are using the same site parameters, then enter the name of the primary or
"^DD",790.02,790.02,.01,21,4,0)
lead facility.
"^DD",790.02,790.02,.01,"DT")
2980508
"^DD",790.02,790.02,.02,0)
DEFAULT CASE MANAGER^P790.01^WV(790.01,^0;2^Q
"^DD",790.02,790.02,.02,3)
Select the name of the person who will be the case manager for most patients.  
"^DD",790.02,790.02,.02,21,0)
^^5^5^2980921^
"^DD",790.02,790.02,.02,21,1,0)
This is the name of the case manager or the individual that will be used
"^DD",790.02,790.02,.02,21,2,0)
to initially seed the patient's record.  Although the patient's care
"^DD",790.02,790.02,.02,21,3,0)
management can be transferred to another individual, this name is used as
"^DD",790.02,790.02,.02,21,4,0)
the default to deter loss of this patient's treatment needs within the
"^DD",790.02,790.02,.02,21,5,0)
facility and database.  Pointer to the WV Case Manager (790.01) file.
"^DD",790.02,790.02,.02,"DT")
2980507
"^DD",790.02,790.02,.03,0)
AUTOQUEUE NORMAL PAP LETTERS^S^0:NO;1:YES;^0;3^Q
"^DD",790.02,790.02,.03,3)
Enter 'Yes' if the prompt to queue a PAP result normal letter should display after the PAP results have been entered into the patient's record.
"^DD",790.02,790.02,.03,21,0)
^^6^6^2980924^
"^DD",790.02,790.02,.03,21,1,0)
This field stores a code (0 = No; 1 = Yes) that displays or hides the
"^DD",790.02,790.02,.03,21,2,0)
prompt: "QUEUE a PAP Result Normal letter to be sent to this patient?".
"^DD",790.02,790.02,.03,21,3,0)
This question displays after the user exits either Add a NEW Procedure or
"^DD",790.02,790.02,.03,21,4,0)
Edit a Procedure option after the results of a PAP smear procedure have
"^DD",790.02,790.02,.03,21,5,0)
been entered into the patient's record and the results/diagnosis was
"^DD",790.02,790.02,.03,21,6,0)
considered normal.
"^DD",790.02,790.02,.03,"DT")
2950319
"^DD",790.02,790.02,.04,0)
PAP RESULT NORMAL LETTER^P790.404'^WV(790.404,^0;4^Q
"^DD",790.02,790.02,.04,3)
Select the name of standard letter that will be used to inform the patient of a normal PAP smear result.
"^DD",790.02,790.02,.04,21,0)
^^4^4^2980921^^^^
"^DD",790.02,790.02,.04,21,1,0)
This field stores the name of the PAP letter that is printed when the user
"^DD",790.02,790.02,.04,21,2,0)
answers, Yes, to the prompt: "QUEUE a PAP Result Normal letter to be sent
"^DD",790.02,790.02,.04,21,3,0)
to this patient?" after the procedures results have been entered into a
"^DD",790.02,790.02,.04,21,4,0)
patient's record.
"^DD",790.02,790.02,.04,"DT")
2980507
"^DD",790.02,790.02,.05,0)
ASK CASE MANAGER^S^0:NO;1:YES;^0;5^Q
"^DD",790.02,790.02,.05,3)
For various reports, should the users be asked if they want to select for a particular case manager?  At smaller sites with one case manager, this should be 'No'.
"^DD",790.02,790.02,.05,21,0)
^^4^4^2980921^^
"^DD",790.02,790.02,.05,21,1,0)
This field is used to display or hide a question asking users if they want
"^DD",790.02,790.02,.05,21,2,0)
to select a particular case manager within the report option, Browse
"^DD",790.02,790.02,.05,21,3,0)
Patients With Needs Past Due.   If there is only one case manager at the
"^DD",790.02,790.02,.05,21,4,0)
facility(s), the answer should be no. 
"^DD",790.02,790.02,.05,"DT")
2940926
"^DD",790.02,790.02,.06,0)
DEFAULT #DAYS TO PRINT LETTER^NJ3,0^^0;6^K:+X'=X!(X>180)!(X<1)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,.06,3)
Enter the default number of days, prior to a patient's CX or BR Tx needs due date, that reminder letters (notifications) should be printed.
"^DD",790.02,790.02,.06,21,0)
^^3^3^2980918^^^^
"^DD",790.02,790.02,.06,21,1,0)
This field contains a default value used to indicate the number of days
"^DD",790.02,790.02,.06,21,2,0)
prior to a patient's cervical (CX) or breast (BR) treatment needs due
"^DD",790.02,790.02,.06,21,3,0)
date, reminder letters (notifications) should be printed.
"^DD",790.02,790.02,.06,"DT")
2950317
"^DD",790.02,790.02,.07,0)
AUTOQUEUE NORMAL MAM LETTERS^S^1:YES;0:NO;^0;7^Q
"^DD",790.02,790.02,.07,3)
Enter 'Yes' if the prompt to queue a MAM result normal letter should display after the mammogram results have been entered into the patient's record.
"^DD",790.02,790.02,.07,21,0)
^^6^6^2980924^
"^DD",790.02,790.02,.07,21,1,0)
This field stores a code (0 = No; 1 = Yes) that displays or hides the
"^DD",790.02,790.02,.07,21,2,0)
prompt: "QUEUE a MAM Result Normal letter to be sent to this patient?".
"^DD",790.02,790.02,.07,21,3,0)
This question displays after the user exits either Add a NEW Procedure or
"^DD",790.02,790.02,.07,21,4,0)
Edit a Procedure option after the results of a mammogram procedure have
"^DD",790.02,790.02,.07,21,5,0)
been entered into the patient's record and the results/diagnosis was
"^DD",790.02,790.02,.07,21,6,0)
considered normal.
"^DD",790.02,790.02,.07,"DT")
2950319
"^DD",790.02,790.02,.08,0)
MAM RESULT NORMAL LETTER^P790.404'^WV(790.404,^0;8^Q
"^DD",790.02,790.02,.08,3)
Select the name of the standard letter that will be used to inform the patient of a normal mammogram result.
"^DD",790.02,790.02,.08,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,.08,21,1,0)
This field stores the name of the MAM letter that is printed when the user
"^DD",790.02,790.02,.08,21,2,0)
answers, YES, to the prompt: "QUEUE a MAM Result Normal letter to be sent
"^DD",790.02,790.02,.08,21,3,0)
to this patient?" after the procedures results have been entered into a
"^DD",790.02,790.02,.08,21,4,0)
patient's record.
"^DD",790.02,790.02,.08,"DT")
2980507
"^DD",790.02,790.02,.1,0)
IMPORT MAMS FROM RADIOLOGY^S^1:YES;0:NO;^0;10^Q
"^DD",790.02,790.02,.1,3)
Enter 'Yes' if the Radiology/Nuclear Medicine package is in use at this site and you wish mammography reports to be imported automatically into the Women's Health database.
"^DD",790.02,790.02,.1,21,0)
^^3^3^2980921^^^
"^DD",790.02,790.02,.1,21,1,0)
This field is used to automatically import and store mammography reports,
"^DD",790.02,790.02,.1,21,2,0)
from the VISTA Radiology/Nuclear Medicine package, in the Women's Health
"^DD",790.02,790.02,.1,21,3,0)
database.
"^DD",790.02,790.02,.1,"DT")
2950526
"^DD",790.02,790.02,.15,0)
AGENCY^S^v:VA;^0;15^Q
"^DD",790.02,790.02,.15,21,0)
^^3^3^2980918^
"^DD",790.02,790.02,.15,21,1,0)
The type of organization associated with this site. Currently, there is
"^DD",790.02,790.02,.15,21,2,0)
only one entry,'V' for Veterans Affairs.  This field is not editable
"^DD",790.02,790.02,.15,21,3,0)
through the Edit Site Parameters option.
"^DD",790.02,790.02,.15,"DT")
2980630
"^DD",790.02,790.02,.23,0)
STATUS OF IMPORTED MAMMOGRAMS^S^o:OPEN;c:CLOSED;^0;23^Q
"^DD",790.02,790.02,.23,3)
Enter a code (O = Open; C = Closed) that will be used to set the status of a mammogram screening record after mammogram results are imported from the Radiology package. 
"^DD",790.02,790.02,.23,21,0)
^^3^3^2980921^^
"^DD",790.02,790.02,.23,21,1,0)
This field automatically stores a default status (O = Open; C = Closed) in
"^DD",790.02,790.02,.23,21,2,0)
the procedure edit screens when mammography reports are imported from the
"^DD",790.02,790.02,.23,21,3,0)
Radiology/Nuclear Medicine application.
"^DD",790.02,790.02,.23,"DT")
2951012
"^DD",790.02,790.02,1.01,0)
PAP ACTIVE^S^1:YES;0:NO;^1;1^Q
"^DD",790.02,790.02,1.01,3)
If users should NOT be allowed to select PAP smear when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make PAP smear active.
"^DD",790.02,790.02,1.01,21,0)
^^4^4^2980918^^
"^DD",790.02,790.02,1.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,1.01,21,2,0)
remove the PAP procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,1.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,1.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,1.01,"DT")
2960116
"^DD",790.02,790.02,1.03,0)
PAP DEF DAYS DELINQ^NJ4,0^^1;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,1.03,3)
Enter the default number of days a PAP smear will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,1.03,21,0)
^^7^7^2980918^^^
"^DD",790.02,790.02,1.03,21,1,0)
This field stores the number of days that a patient's PAP procedure record
"^DD",790.02,790.02,1.03,21,2,0)
is allowed to have an open status.  The software uses this date to
"^DD",790.02,790.02,1.03,21,3,0)
calculate the Complete by (Date) field that resides in the WV Procedure
"^DD",790.02,790.02,1.03,21,4,0)
(790.1) file and which is displayed in the procedure edit options.
"^DD",790.02,790.02,1.03,21,5,0)
Indirectly this file is used to establish a date that the open procedure
"^DD",790.02,790.02,1.03,21,6,0)
is considered delinquent and reflected in the Browse Procedures and
"^DD",790.02,790.02,1.03,21,7,0)
Program Snapshot reports.
"^DD",790.02,790.02,1.03,"DT")
2960116
"^DD",790.02,790.02,2.01,0)
COBX ACTIVE^S^1:YES;0:NO;^2;1^Q
"^DD",790.02,790.02,2.01,3)
If users should NOT be allowed to select colposcopy w/biopsy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make colposcopy w/biopsy active.
"^DD",790.02,790.02,2.01,21,0)
^^4^4^2980918^^
"^DD",790.02,790.02,2.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,2.01,21,2,0)
remove the colposcopy w/biopsy procedure from the procedure look-up list.
"^DD",790.02,790.02,2.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,2.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,2.01,"DT")
2960116
"^DD",790.02,790.02,2.03,0)
COBX DEF DAYS DELINQ^NJ4,0^^2;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,2.03,3)
Enter the default number of days a colposcopy w/biopsy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,2.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,2.03,21,1,0)
This field stores the number of days that a patient's colposcopy w/biopsy
"^DD",790.02,790.02,2.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,2.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,2.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,2.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,2.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,2.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,2.03,"DT")
2960116
"^DD",790.02,790.02,3.01,0)
HYST ACTIVE^S^1:YES;0:NO;^3;1^Q
"^DD",790.02,790.02,3.01,3)
If users should NOT be allowed to select hysterectomy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make hysterectomy active.
"^DD",790.02,790.02,3.01,21,0)
^^4^4^2980918^
"^DD",790.02,790.02,3.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,3.01,21,2,0)
remove the hysterectomy procedure from the procedure look-up list. If the
"^DD",790.02,790.02,3.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,3.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,3.01,"DT")
2960116
"^DD",790.02,790.02,3.03,0)
HYST DEF DAYS DELINQ^NJ4,0^^3;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,3.03,3)
Enter the default number of days a hysterectomy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,3.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,3.03,21,1,0)
This field stores the number of days that a patient's hysterectomy
"^DD",790.02,790.02,3.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,3.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,3.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,3.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,3.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,3.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,3.03,"DT")
2960116
"^DD",790.02,790.02,4.01,0)
CRYO ACTIVE^S^1:YES;0:NO;^4;1^Q
"^DD",790.02,790.02,4.01,3)
If users should NOT be allowed to select cryotherapy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make cryotherapy active.
"^DD",790.02,790.02,4.01,21,0)
^^4^4^2980918^^
"^DD",790.02,790.02,4.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,4.01,21,2,0)
remove the cryotherapy procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,4.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,4.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,4.01,"DT")
2960116
"^DD",790.02,790.02,4.03,0)
CRYO DEF DAYS DELINQ^NJ4,0^^4;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,4.03,3)
Enter the default number of days a cryotherapy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,4.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,4.03,21,1,0)
This field stores the number of days that a patient's cryotherapy
"^DD",790.02,790.02,4.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,4.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,4.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,4.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,4.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,4.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,4.03,"DT")
2960116
"^DD",790.02,790.02,7.01,0)
ECBX ACTIVE^S^1:YES;0:NO;^7;1^Q
"^DD",790.02,790.02,7.01,3)
If users should NOT be allowed to select ectocervical biopsy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make ectocervical biopsy active.
"^DD",790.02,790.02,7.01,21,0)
^^4^4^2980918^
"^DD",790.02,790.02,7.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,7.01,21,2,0)
remove the ectocervical biopsy procedure from the procedure look-up list.
"^DD",790.02,790.02,7.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,7.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,7.01,"DT")
2960116
"^DD",790.02,790.02,7.03,0)
ECBX DEF DAYS DELINQ^NJ4,0^^7;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,7.03,3)
Enter the default number of days a ectocervical biopsy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,7.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,7.03,21,1,0)
This field stores the number of days that a patient's ectocervical biopsy
"^DD",790.02,790.02,7.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,7.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,7.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,7.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,7.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,7.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,7.03,"DT")
2960116
"^DD",790.02,790.02,8.01,0)
EMBX ACTIVE^S^1:YES;0:NO;^8;1^Q
"^DD",790.02,790.02,8.01,3)
If users should NOT be allowed to select endometrial biopsy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make endometrial biopsy active.
"^DD",790.02,790.02,8.01,21,0)
^^4^4^2980918^
"^DD",790.02,790.02,8.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,8.01,21,2,0)
remove the endometrial biopsy procedure from the procedure look-up list.
"^DD",790.02,790.02,8.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,8.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,8.01,"DT")
2960116
"^DD",790.02,790.02,8.03,0)
EMBX DEF DAYS DELINQ^NJ4,0^^8;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,8.03,3)
Enter the default number of days a endometrial biopsy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,8.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,8.03,21,1,0)
This field stores the number of days that a patient's endometrial biopsy
"^DD",790.02,790.02,8.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,8.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,8.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,8.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,8.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,8.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,8.03,"DT")
2960116
"^DD",790.02,790.02,17.01,0)
LEEP ACTIVE^S^1:YES;0:NO;^17;1^Q
"^DD",790.02,790.02,17.01,3)
If users should NOT be allowed to select LEEP when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make LEEP active.
"^DD",790.02,790.02,17.01,21,0)
^^4^4^2980918^^
"^DD",790.02,790.02,17.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,17.01,21,2,0)
remove the LEEP procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,17.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,17.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,17.01,"DT")
2960116
"^DD",790.02,790.02,17.03,0)
LEEP DEF DAYS DELINQ^NJ4,0^^17;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,17.03,3)
Enter the default number of days a LEEP will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,17.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,17.03,21,1,0)
This field stores the number of days that a patient's LEEP procedure
"^DD",790.02,790.02,17.03,21,2,0)
record is allowed to have an open status.  The software uses this date to
"^DD",790.02,790.02,17.03,21,3,0)
calculate the Complete by (Date) field that resides in the WV Procedure
"^DD",790.02,790.02,17.03,21,4,0)
(790.1) file and which is displayed in the procedure edit options.
"^DD",790.02,790.02,17.03,21,5,0)
Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,17.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,17.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,17.03,"DT")
2960116
"^DD",790.02,790.02,18.01,0)
ECC ACTIVE^S^1:YES;0:NO;^18;1^Q
"^DD",790.02,790.02,18.01,3)
If users should NOT be allowed to select endocervical currettage when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make endocervical currettage active.
"^DD",790.02,790.02,18.01,21,0)
^^4^4^2980918^
"^DD",790.02,790.02,18.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,18.01,21,2,0)
remove the endocervical currettage procedure from the procedure look-up
"^DD",790.02,790.02,18.01,21,3,0)
list.  If the procedure is to be included in the tracking of women's
"^DD",790.02,790.02,18.01,21,4,0)
health care and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,18.01,"DT")
2960116
"^DD",790.02,790.02,18.03,0)
ECC DEF DAYS DELINQ^NJ4,0^^18;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,18.03,3)
Enter the default number of days a endocervical currettage will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,18.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,18.03,21,1,0)
This field stores the number of days that a patient's endocervical
"^DD",790.02,790.02,18.03,21,2,0)
currettage procedure record is allowed to have an open status.  The
"^DD",790.02,790.02,18.03,21,3,0)
software uses this date to calculate the Complete by (Date) field that
"^DD",790.02,790.02,18.03,21,4,0)
resides in the WV Procedure (790.1) file and which is displayed in the
"^DD",790.02,790.02,18.03,21,5,0)
procedure edit options. Indirectly this file is used to establish a date
"^DD",790.02,790.02,18.03,21,6,0)
that the open procedure is considered delinquent and reflected in the
"^DD",790.02,790.02,18.03,21,7,0)
Browse Procedures and Program Snapshot reports.
"^DD",790.02,790.02,18.03,"DT")
2960116
"^DD",790.02,790.02,19.01,0)
CONE ACTIVE^S^1:YES;0:NO;^19;1^Q
"^DD",790.02,790.02,19.01,3)
If users should NOT be allowed to select cone biopsy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make cone biopsy active.
"^DD",790.02,790.02,19.01,21,0)
^^4^4^2980918^^^
"^DD",790.02,790.02,19.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,19.01,21,2,0)
remove the cone biopsy procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,19.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,19.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,19.01,"DT")
2960116
"^DD",790.02,790.02,19.03,0)
CONE DEF DAYS DELINQ^NJ4,0^^19;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,19.03,3)
Enter the default number of days a cone biopsy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,19.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,19.03,21,1,0)
This field stores the number of days that a patient's cone biopsy
"^DD",790.02,790.02,19.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,19.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,19.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,19.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,19.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,19.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,19.03,"DT")
2960116
"^DD",790.02,790.02,20.01,0)
HCG ACTIVE^S^1:YES;0:NO;^20;1^Q
"^DD",790.02,790.02,20.01,3)
If users should NOT be allowed to select pregnancy test when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make pregnancy test active.
"^DD",790.02,790.02,20.01,21,0)
^^4^4^2980918^
"^DD",790.02,790.02,20.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,20.01,21,2,0)
remove the pregnancy test procedure from the procedure look-up list.  If
"^DD",790.02,790.02,20.01,21,3,0)
the procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,20.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,20.01,"DT")
2960116
"^DD",790.02,790.02,20.03,0)
HCG DEF DAYS DELINQ^NJ4,0^^20;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,20.03,3)
Enter the default number of days a pregnancy test will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,20.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,20.03,21,1,0)
This field stores the number of days that a patient's pregnancy test
"^DD",790.02,790.02,20.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,20.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,20.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,20.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,20.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,20.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,20.03,"DT")
2960116
"^DD",790.02,790.02,21.01,0)
STD ACTIVE^S^1:YES;0:NO;^21;1^Q
"^DD",790.02,790.02,21.01,3)
If users should NOT be allowed to select STD evaluation when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make STD evaluation active.
"^DD",790.02,790.02,21.01,21,0)
^^5^5^2980918^
"^DD",790.02,790.02,21.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,21.01,21,2,0)
remove the STD (sexually transmitted disease) evaluation procedure from
"^DD",790.02,790.02,21.01,21,3,0)
the procedure look-up list.  If the procedure is to be included in the
"^DD",790.02,790.02,21.01,21,4,0)
tracking of women's health care and treatment needs, this field value
"^DD",790.02,790.02,21.01,21,5,0)
should be 'Yes'.
"^DD",790.02,790.02,21.01,"DT")
2960116
"^DD",790.02,790.02,21.03,0)
STD DEF DAYS DELINQ^NJ4,0^^21;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,21.03,3)
Enter the default number of days a STD evaluation will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,21.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,21.03,21,1,0)
This field stores the number of days that a patient's STD (sexually
"^DD",790.02,790.02,21.03,21,2,0)
transmitted disease) evaluation procedure record is allowed to have an
"^DD",790.02,790.02,21.03,21,3,0)
open status.  The software uses this date to calculate the Complete by
"^DD",790.02,790.02,21.03,21,4,0)
(Date) field that resides in the WV Procedure (790.1) file and which is
"^DD",790.02,790.02,21.03,21,5,0)
displayed in the procedure edit options. Indirectly this file is used to
"^DD",790.02,790.02,21.03,21,6,0)
establish a date that the open procedure is considered delinquent and
"^DD",790.02,790.02,21.03,21,7,0)
reflected in the Browse Procedures and Program Snapshot reports.
"^DD",790.02,790.02,21.03,"DT")
2960116
"^DD",790.02,790.02,22.01,0)
LASA ACTIVE^S^1:YES;0:NO;^22;1^Q
"^DD",790.02,790.02,22.01,3)
If users should NOT be allowed to select laser ablation when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make laser ablation active.
"^DD",790.02,790.02,22.01,21,0)
^^4^4^2980918^
"^DD",790.02,790.02,22.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,22.01,21,2,0)
remove the laser ablation procedure from the procedure look-up list.  If
"^DD",790.02,790.02,22.01,21,3,0)
the procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,22.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,22.01,"DT")
2960116
"^DD",790.02,790.02,22.03,0)
LASA DEF DAYS DELINQ^NJ4,0^^22;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,22.03,3)
Enter the default number of days a laser ablation will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,22.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,22.03,21,1,0)
This field stores the number of days that a patient's laser ablation
"^DD",790.02,790.02,22.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,22.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,22.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,22.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,22.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,22.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,22.03,"DT")
2960116
"^DD",790.02,790.02,23.01,0)
LASC ACTIVE^S^1:YES;0:NO;^23;1^Q
"^DD",790.02,790.02,23.01,3)
If users should NOT be allowed to select laser cone when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make laser cone active.
"^DD",790.02,790.02,23.01,21,0)
^^4^4^2980918^
"^DD",790.02,790.02,23.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,23.01,21,2,0)
remove the laser cone procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,23.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,23.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,23.01,"DT")
2960116
"^DD",790.02,790.02,23.03,0)
LASC DEF DAYS DELINQ^NJ4,0^^23;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,23.03,3)
Enter the default number of days a laser cone will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,23.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,23.03,21,1,0)
This field stores the number of days that a patient's laser cone procedure
"^DD",790.02,790.02,23.03,21,2,0)
record is allowed to have an open status.  The software uses this date to
"^DD",790.02,790.02,23.03,21,3,0)
calculate the Complete by (Date) field that resides in the WV Procedure
"^DD",790.02,790.02,23.03,21,4,0)
(790.1) file and which is displayed in the procedure edit options.
"^DD",790.02,790.02,23.03,21,5,0)
Indirectly this file is used to establish a date that the open procedure
"^DD",790.02,790.02,23.03,21,6,0)
is considered delinquent and reflected in the Browse Procedures and
"^DD",790.02,790.02,23.03,21,7,0)
Program Snapshot reports.
"^DD",790.02,790.02,23.03,"DT")
2960116
"^DD",790.02,790.02,24.01,0)
GYNC ACTIVE^S^1:YES;0:NO;^24;1^Q
"^DD",790.02,790.02,24.01,3)
If users should NOT be allowed to select GYN ONC consult when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make GYN ONC consult active.
"^DD",790.02,790.02,24.01,21,0)
^^4^4^2980921^^
"^DD",790.02,790.02,24.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,24.01,21,2,0)
remove the GYN ONC (gynecologic oncology) consult from the procedure
"^DD",790.02,790.02,24.01,21,3,0)
look-up list.  If the procedure is to be included in the tracking of
"^DD",790.02,790.02,24.01,21,4,0)
women's health care and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,24.01,"DT")
2960116
"^DD",790.02,790.02,24.03,0)
GYNC DEF DAYS DELINQ^NJ4,0^^24;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,24.03,3)
Enter the default number of days a GYN ONC consult will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,24.03,21,0)
^^7^7^2980918^
"^DD",790.02,790.02,24.03,21,1,0)
This field stores the number of days that a patient's GYN ONC (gynecologic
"^DD",790.02,790.02,24.03,21,2,0)
oncology) consult procedure record is allowed to have an open status.  The
"^DD",790.02,790.02,24.03,21,3,0)
software uses this date to calculate the Complete by (Date) field that
"^DD",790.02,790.02,24.03,21,4,0)
resides in the WV Procedure (790.1) file and which is displayed in the
"^DD",790.02,790.02,24.03,21,5,0)
procedure edit options. Indirectly this file is used to establish a date
"^DD",790.02,790.02,24.03,21,6,0)
that the open procedure is considered delinquent and reflected in the
"^DD",790.02,790.02,24.03,21,7,0)
Browse Procedures and Program Snapshot reports.
"^DD",790.02,790.02,24.03,"DT")
2960116
"^DD",790.02,790.02,25.01,0)
MAMB ACTIVE^S^1:YES;0:NO;^25;1^Q
"^DD",790.02,790.02,25.01,3)
If users should NOT be allowed to select mammogram Dx bilat when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make mammogram Dx bilat active.
"^DD",790.02,790.02,25.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,25.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,25.01,21,2,0)
remove the mammogram Dx bilateral procedure from the procedure look-up
"^DD",790.02,790.02,25.01,21,3,0)
list.  If the procedure is to be included in the tracking of women's
"^DD",790.02,790.02,25.01,21,4,0)
health care and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,25.01,"DT")
2960116
"^DD",790.02,790.02,25.03,0)
MAMB DEF DAYS DELINQ^NJ4,0^^25;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,25.03,3)
Enter the default number of days a mammogram Dx bilat will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,25.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,25.03,21,1,0)
This field stores the number of days that a patient's mammogram Dx
"^DD",790.02,790.02,25.03,21,2,0)
bilateral procedure record is allowed to have an open status.  The
"^DD",790.02,790.02,25.03,21,3,0)
software uses this date to calculate the Complete by (Date) field that
"^DD",790.02,790.02,25.03,21,4,0)
resides in the WV Procedure (790.1) file and which is displayed in the
"^DD",790.02,790.02,25.03,21,5,0)
procedure edit options. Indirectly this file is used to establish a date
"^DD",790.02,790.02,25.03,21,6,0)
that the open procedure is considered delinquent and reflected in the
"^DD",790.02,790.02,25.03,21,7,0)
Browse Procedures and Program Snapshot reports.
"^DD",790.02,790.02,25.03,"DT")
2960116
"^DD",790.02,790.02,26.01,0)
MAMU ACTIVE^S^1:YES;0:NO;^26;1^Q
"^DD",790.02,790.02,26.01,3)
If users should NOT be allowed to select mammogram Dx unilat when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make mammogram Dx unilat active.
"^DD",790.02,790.02,26.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,26.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,26.01,21,2,0)
remove the mammogram Dx unilateral procedure from the procedure look-up
"^DD",790.02,790.02,26.01,21,3,0)
list.  If the procedure is to be included in the tracking of women's
"^DD",790.02,790.02,26.01,21,4,0)
health care and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,26.01,"DT")
2960116
"^DD",790.02,790.02,26.03,0)
MAMU DEF DAYS DELINQ^NJ4,0^^26;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,26.03,3)
Enter the default number of days a mammogram Dx unilat will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,26.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,26.03,21,1,0)
This field stores the number of days that a patient's mammogram Dx
"^DD",790.02,790.02,26.03,21,2,0)
unilateral procedure record is allowed to have an open status.  The
"^DD",790.02,790.02,26.03,21,3,0)
software uses this date to calculate the Complete by (Date) field that
"^DD",790.02,790.02,26.03,21,4,0)
resides in the WV Procedure (790.1) file and which is displayed in the
"^DD",790.02,790.02,26.03,21,5,0)
procedure edit options. Indirectly this file is used to establish a date
"^DD",790.02,790.02,26.03,21,6,0)
that the open procedure is considered delinquent and reflected in the
"^DD",790.02,790.02,26.03,21,7,0)
Browse Procedures and Program Snapshot reports.
"^DD",790.02,790.02,26.03,"DT")
2960116
"^DD",790.02,790.02,27.01,0)
CBE ACTIVE^S^1:YES;0:NO;^27;1^Q
"^DD",790.02,790.02,27.01,3)
If users should NOT be allowed to select clinical breast exam when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make clinical breast exam active.
"^DD",790.02,790.02,27.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,27.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,27.01,21,2,0)
remove the clinical breast exam procedure from the procedure look-up list.
"^DD",790.02,790.02,27.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,27.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,27.01,"DT")
2960116
"^DD",790.02,790.02,27.03,0)
CBE DEF DAYS DELINQ^NJ4,0^^27;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,27.03,3)
Enter the default number of days a clinical breast exam will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,27.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,27.03,21,1,0)
This field stores the number of days that a patient's clinical breast exam
"^DD",790.02,790.02,27.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,27.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,27.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,27.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,27.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,27.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,27.03,"DT")
2960116
"^DD",790.02,790.02,28.01,0)
MAMS ACTIVE^S^1:YES;0:NO;^28;1^Q
"^DD",790.02,790.02,28.01,3)
If users should NOT be allowed to select mammogram screening when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make mammogram screening active.
"^DD",790.02,790.02,28.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,28.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,28.01,21,2,0)
remove the mammogram screening procedure from the procedure look-up list.
"^DD",790.02,790.02,28.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,28.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,28.01,"DT")
2960116
"^DD",790.02,790.02,28.03,0)
MAMS DEF DAYS DELINQ^NJ4,0^^28;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,28.03,3)
Enter the default number of days a mammogram screening will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,28.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,28.03,21,1,0)
This field stores the number of days that a patient's mammogram screening
"^DD",790.02,790.02,28.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,28.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,28.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,28.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,28.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,28.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,28.03,"DT")
2980917
"^DD",790.02,790.02,29.01,0)
GSCON ACTIVE^S^1:YES;0:NO;^29;1^Q
"^DD",790.02,790.02,29.01,3)
If users should NOT be allowed to select general surgery consult when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make general surgery consult active.
"^DD",790.02,790.02,29.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,29.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,29.01,21,2,0)
remove the general surgery consult from the procedure look-up list.  If
"^DD",790.02,790.02,29.01,21,3,0)
the procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,29.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,29.01,"DT")
2960116
"^DD",790.02,790.02,29.03,0)
GSCON DEF DAYS DELINQ^NJ4,0^^29;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,29.03,3)
Enter the default number of days a general surgery consult will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,29.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,29.03,21,1,0)
This field stores the number of days that a patient's general surgery
"^DD",790.02,790.02,29.03,21,2,0)
consult procedure record is allowed to have an open status.  The software
"^DD",790.02,790.02,29.03,21,3,0)
uses this date to calculate the Complete by (Date) field that resides in
"^DD",790.02,790.02,29.03,21,4,0)
the WV Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,29.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,29.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,29.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,29.03,"DT")
2960116
"^DD",790.02,790.02,30.01,0)
NDBX ACTIVE^S^1:YES;0:NO;^30;1^Q
"^DD",790.02,790.02,30.01,3)
If users should NOT be allowed to select needle biopsy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make needle biopsy active.
"^DD",790.02,790.02,30.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,30.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,30.01,21,2,0)
remove the needle biopsy procedure from the procedure look-up list.  If
"^DD",790.02,790.02,30.01,21,3,0)
the procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,30.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,30.01,"DT")
2960116
"^DD",790.02,790.02,30.03,0)
NDBX DEF DAYS DELINQ^NJ4,0^^30;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,30.03,3)
Enter the default number of days a needle biopsy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,30.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,30.03,21,1,0)
This field stores the number of days that a patient's needle biopsy
"^DD",790.02,790.02,30.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,30.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,30.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,30.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,30.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,30.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,30.03,"DT")
2960116
"^DD",790.02,790.02,31.01,0)
OPBX ACTIVE^S^1:YES;0:NO;^31;1^Q
"^DD",790.02,790.02,31.01,3)
If users should NOT be allowed to select open biopsy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make open biopsy active.
"^DD",790.02,790.02,31.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,31.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,31.01,21,2,0)
remove the open biopsy procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,31.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,31.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,31.01,"DT")
2960116
"^DD",790.02,790.02,31.03,0)
OPBX DEF DAYS DELINQ^NJ4,0^^31;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,31.03,3)
Enter the default number of days a open biopsy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,31.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,31.03,21,1,0)
This field stores the number of days that a patient's open biopsy
"^DD",790.02,790.02,31.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,31.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,31.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,31.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,31.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,31.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,31.03,"DT")
2960116
"^DD",790.02,790.02,32.01,0)
LMPY ACTIVE^S^1:YES;0:NO;^32;1^Q
"^DD",790.02,790.02,32.01,3)
If users should NOT be allowed to select lumpectomy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make lumpectomy active.
"^DD",790.02,790.02,32.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,32.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,32.01,21,2,0)
remove the lumpectomy procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,32.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,32.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,32.01,"DT")
2960116
"^DD",790.02,790.02,32.03,0)
LMPY DEF DAYS DELINQ^NJ4,0^^32;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,32.03,3)
Enter the default number of days a lumpectomy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,32.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,32.03,21,1,0)
This field stores the number of days that a patient's lumpectomy procedure
"^DD",790.02,790.02,32.03,21,2,0)
record is allowed to have an open status.  The software uses this date to
"^DD",790.02,790.02,32.03,21,3,0)
calculate the Complete by (Date) field that resides in the WV Procedure
"^DD",790.02,790.02,32.03,21,4,0)
(790.1) file and which is displayed in the procedure edit options.
"^DD",790.02,790.02,32.03,21,5,0)
Indirectly this file is used to establish a date that the open procedure
"^DD",790.02,790.02,32.03,21,6,0)
is considered delinquent and reflected in the Browse Procedures and
"^DD",790.02,790.02,32.03,21,7,0)
Program Snapshot reports.
"^DD",790.02,790.02,32.03,"DT")
2960116
"^DD",790.02,790.02,33.01,0)
MAST ACTIVE^S^1:YES;0:NO;^33;1^Q
"^DD",790.02,790.02,33.01,3)
If users should NOT be allowed to select mastectomy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make mastectomy active.
"^DD",790.02,790.02,33.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,33.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,33.01,21,2,0)
remove the mastectomy procedure from the procedure look-up list.  If the
"^DD",790.02,790.02,33.01,21,3,0)
procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,33.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,33.01,"DT")
2960116
"^DD",790.02,790.02,33.03,0)
MAST DEF DAYS DELINQ^NJ4,0^^33;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,33.03,3)
Enter the default number of days a mastectomy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,33.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,33.03,21,1,0)
This field stores the number of days that a patient's mastectomy procedure
"^DD",790.02,790.02,33.03,21,2,0)
record is allowed to have an open status.  The software uses this date to
"^DD",790.02,790.02,33.03,21,3,0)
calculate the Complete by (Date) field that resides in the WV Procedure
"^DD",790.02,790.02,33.03,21,4,0)
(790.1) file and which is displayed in the procedure edit options.
"^DD",790.02,790.02,33.03,21,5,0)
Indirectly this file is used to establish a date that the open procedure
"^DD",790.02,790.02,33.03,21,6,0)
is considered delinquent and reflected in the Browse Procedures and
"^DD",790.02,790.02,33.03,21,7,0)
Program Snapshot reports.
"^DD",790.02,790.02,33.03,"DT")
2960116
"^DD",790.02,790.02,34.01,0)
FNDL ACTIVE^S^1:YES;0:NO;^34;1^Q
"^DD",790.02,790.02,34.01,3)
If users should NOT be allowed to select fine needle aspiration when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make fine needle aspiration active.
"^DD",790.02,790.02,34.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,34.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,34.01,21,2,0)
remove the fine needle aspiration procedure from the procedure look-up
"^DD",790.02,790.02,34.01,21,3,0)
list.  If the procedure is to be included in the tracking of women's
"^DD",790.02,790.02,34.01,21,4,0)
health care and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,34.01,"DT")
2960116
"^DD",790.02,790.02,34.03,0)
FNDL DEF DAYS DELINQ^NJ4,0^^34;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,34.03,3)
Enter the default number of days a fine needle aspiration will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,34.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,34.03,21,1,0)
This field stores the number of days that a patient's fine needle
"^DD",790.02,790.02,34.03,21,2,0)
aspiration procedure record is allowed to have an open status.  The
"^DD",790.02,790.02,34.03,21,3,0)
software uses this date to calculate the Complete by (Date) field that
"^DD",790.02,790.02,34.03,21,4,0)
resides in the WV Procedure (790.1) file and which is displayed in the
"^DD",790.02,790.02,34.03,21,5,0)
procedure edit options. Indirectly this file is used to establish a date
"^DD",790.02,790.02,34.03,21,6,0)
that the open procedure is considered delinquent and reflected in the
"^DD",790.02,790.02,34.03,21,7,0)
Browse Procedures and Program Snapshot reports.
"^DD",790.02,790.02,34.03,"DT")
2960116
"^DD",790.02,790.02,35.01,0)
STBX ACTIVE^S^1:YES;0:NO;^35;1^Q
"^DD",790.02,790.02,35.01,3)
If users should NOT be allowed to select stereotactic biopsy when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make stereotactic biopsy active.
"^DD",790.02,790.02,35.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,35.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,35.01,21,2,0)
remove the stereotactic biopsy procedure from the procedure look-up list.
"^DD",790.02,790.02,35.01,21,3,0)
If the procedure is to be included in the tracking of women's health care
"^DD",790.02,790.02,35.01,21,4,0)
and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,35.01,"DT")
2960116
"^DD",790.02,790.02,35.03,0)
STBX DEF DAYS DELINQ^NJ4,0^^35;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,35.03,3)
Enter the default number of days a stereotactic biopsy will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,35.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,35.03,21,1,0)
This field stores the number of days that a patient's stereotactic biopsy
"^DD",790.02,790.02,35.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,35.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,35.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,35.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,35.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,35.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,35.03,"DT")
2960116
"^DD",790.02,790.02,37.01,0)
CIMP ACTIVE^S^1:YES;0:NO;^37;1^Q
"^DD",790.02,790.02,37.01,3)
If users should NOT be allowed to select colposcopy impression (no Bx) when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make coloscopy impression active.
"^DD",790.02,790.02,37.01,21,0)
^^4^4^2980921^^^^
"^DD",790.02,790.02,37.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,37.01,21,2,0)
remove the colposcopy impression (no Bx) procedure from the procedure
"^DD",790.02,790.02,37.01,21,3,0)
look-up list.  If the procedure is to be included in the tracking of
"^DD",790.02,790.02,37.01,21,4,0)
women's health care and treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,37.01,"DT")
2960116
"^DD",790.02,790.02,37.03,0)
CIMP DEF DAYS DELINQ^NJ4,0^^37;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,37.03,3)
Enter the default number of days a colposcopy impression (no Bx) will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,37.03,21,0)
^^7^7^2980921^^
"^DD",790.02,790.02,37.03,21,1,0)
This field stores the number of days that a patient's colposcopy
"^DD",790.02,790.02,37.03,21,2,0)
impression (no Bx) procedure record is allowed to have an open status. The
"^DD",790.02,790.02,37.03,21,3,0)
software uses this date to calculate the Complete by (Date) field that
"^DD",790.02,790.02,37.03,21,4,0)
resides in the WV Procedure (790.1) file and which is displayed in the
"^DD",790.02,790.02,37.03,21,5,0)
procedure edit options. Indirectly this file is used to establish a date
"^DD",790.02,790.02,37.03,21,6,0)
that the open procedure is considered delinquent and reflected in the
"^DD",790.02,790.02,37.03,21,7,0)
Browse Procedures and Program Snapshot reports.
"^DD",790.02,790.02,37.03,"DT")
2960116
"^DD",790.02,790.02,38.01,0)
BRUL ACTIVE^S^1:YES;0:NO;^38;1^Q
"^DD",790.02,790.02,38.01,3)
If users should NOT be allowed to select breast ultrasound when entering new procedures at this site, then enter 'No' to make it inactive.  Enter 'Yes' to make breast ultrasound active.
"^DD",790.02,790.02,38.01,21,0)
^^4^4^2980921^
"^DD",790.02,790.02,38.01,21,1,0)
This field stores a value (1 = Yes; 0 = No) that is used to display or
"^DD",790.02,790.02,38.01,21,2,0)
remove the breast ultrasound procedure from the procedure look-up list. If
"^DD",790.02,790.02,38.01,21,3,0)
the procedure is to be included in the tracking of women's health care and
"^DD",790.02,790.02,38.01,21,4,0)
treatment needs, this field value should be 'Yes'.
"^DD",790.02,790.02,38.01,"DT")
2960116
"^DD",790.02,790.02,38.03,0)
BRUL DEF DAYS DELINQ^NJ4,0^^38;3^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.02,790.02,38.03,3)
Enter the default number of days a breast ultrasound will be allowed to remain 'Open' before being marked as 'Delinquent'.
"^DD",790.02,790.02,38.03,21,0)
^^7^7^2980921^
"^DD",790.02,790.02,38.03,21,1,0)
This field stores the number of days that a patient's breast ultrasound
"^DD",790.02,790.02,38.03,21,2,0)
procedure record is allowed to have an open status.  The software uses
"^DD",790.02,790.02,38.03,21,3,0)
this date to calculate the Complete by (Date) field that resides in the WV
"^DD",790.02,790.02,38.03,21,4,0)
Procedure (790.1) file and which is displayed in the procedure edit
"^DD",790.02,790.02,38.03,21,5,0)
options. Indirectly this file is used to establish a date that the open
"^DD",790.02,790.02,38.03,21,6,0)
procedure is considered delinquent and reflected in the Browse Procedures
"^DD",790.02,790.02,38.03,21,7,0)
and Program Snapshot reports.
"^DD",790.02,790.02,38.03,"DT")
2960116
"^DD",790.03,790.03,0)
FIELD^^.02^2
"^DD",790.03,790.03,0,"IX","B",790.03,.01)

"^DD",790.03,790.03,0,"IX","C",790.03,.02)

"^DD",790.03,790.03,0,"IX","U",790.03,.01)

"^DD",790.03,790.03,0,"NM","WV PAP REGIMEN")

"^DD",790.03,790.03,0,"PT",790,.16)

"^DD",790.03,790.03,0,"PT",790.04,.03)

"^DD",790.03,790.03,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.03,790.03,.01,0)
PAP REGIMEN^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>35!($L(X)<3)!'(X'?1P.E) X
"^DD",790.03,790.03,.01,1,0)
^.1
"^DD",790.03,790.03,.01,1,1,0)
790.03^B
"^DD",790.03,790.03,.01,1,1,1)
S ^WV(790.03,"B",$E(X,1,30),DA)=""
"^DD",790.03,790.03,.01,1,1,2)
K ^WV(790.03,"B",$E(X,1,30),DA)
"^DD",790.03,790.03,.01,1,2,0)
790.03^U^MUMPS
"^DD",790.03,790.03,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.03,")
"^DD",790.03,790.03,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.03,")
"^DD",790.03,790.03,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.03,790.03,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.03,790.03,.01,1,2,"DT")
2960308
"^DD",790.03,790.03,.01,3)
Answer must be 3-35 characters in length.
"^DD",790.03,790.03,.01,21,0)
^^18^18^2980630^
"^DD",790.03,790.03,.01,21,1,0)
This field stores information used to describe a PAP regimen, such as a
"^DD",790.03,790.03,.01,21,2,0)
procedure and its frequency or a follow-up action. The regimen appears in
"^DD",790.03,790.03,.01,21,3,0)
abbreviated form so that it can display on several screens where there is
"^DD",790.03,790.03,.01,21,4,0)
limited space. The following abbreviations may apply to the PAP regimen
"^DD",790.03,790.03,.01,21,5,0)
string:
"^DD",790.03,790.03,.01,21,6,0)
   
"^DD",790.03,790.03,.01,21,7,0)
   Symbol    Meaning
"^DD",790.03,790.03,.01,21,8,0)
   ------    -------   
"^DD",790.03,790.03,.01,21,9,0)
     P       PAP
"^DD",790.03,790.03,.01,21,10,0)
     C       Colposcopy
"^DD",790.03,790.03,.01,21,11,0)
     wk      Week
"^DD",790.03,790.03,.01,21,12,0)
     m       Month
"^DD",790.03,790.03,.01,21,13,0)
     y       Year
"^DD",790.03,790.03,.01,21,14,0)
     q       Every
"^DD",790.03,790.03,.01,21,15,0)
     pp      Postpartum
"^DD",790.03,790.03,.01,21,16,0)
     x2      Times 2
"^DD",790.03,790.03,.01,21,17,0)
     x3      Times 3
"^DD",790.03,790.03,.01,21,18,0)
     ga      Gestation
"^DD",790.03,790.03,.01,"DT")
2960308
"^DD",790.03,790.03,.02,0)
SELECTION#^NJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",790.03,790.03,.02,1,0)
^.1
"^DD",790.03,790.03,.02,1,1,0)
790.03^C
"^DD",790.03,790.03,.02,1,1,1)
S ^WV(790.03,"C",$E(X,1,30),DA)=""
"^DD",790.03,790.03,.02,1,1,2)
K ^WV(790.03,"C",$E(X,1,30),DA)
"^DD",790.03,790.03,.02,1,1,"DT")
2940930
"^DD",790.03,790.03,.02,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",790.03,790.03,.02,21,0)
^^2^2^2980630^
"^DD",790.03,790.03,.02,21,1,0)
This field is used to order the regimens within displays or selection
"^DD",790.03,790.03,.02,21,2,0)
lists.
"^DD",790.03,790.03,.02,"DT")
2940930
"^DD",790.04,790.04,0)
FIELD^^.01^3
"^DD",790.04,790.04,0,"DT")
2980722
"^DD",790.04,790.04,0,"ID",.02)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.04,790.04,0,"IX","B",790.04,.01)

"^DD",790.04,790.04,0,"IX","C",790.04,.02)

"^DD",790.04,790.04,0,"NM","WV PAP REGIMEN LOG")

"^DD",790.04,790.04,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.04,790.04,.01,0)
BEGIN DATE^RD^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.04,790.04,.01,1,0)
^.1
"^DD",790.04,790.04,.01,1,1,0)
790.04^B
"^DD",790.04,790.04,.01,1,1,1)
S ^WV(790.04,"B",$E(X,1,30),DA)=""
"^DD",790.04,790.04,.01,1,1,2)
K ^WV(790.04,"B",$E(X,1,30),DA)
"^DD",790.04,790.04,.01,3)
Enter the date the patient was given this PAP regimen.
"^DD",790.04,790.04,.01,21,0)
^^1^1^2980720^
"^DD",790.04,790.04,.01,21,1,0)
This field contains the date this PAP regimen was started.
"^DD",790.04,790.04,.01,"DT")
2941021
"^DD",790.04,790.04,.02,0)
PATIENT^P790'^WV(790,^0;2^Q
"^DD",790.04,790.04,.02,1,0)
^.1
"^DD",790.04,790.04,.02,1,1,0)
790.04^C
"^DD",790.04,790.04,.02,1,1,1)
S ^WV(790.04,"C",$E(X,1,30),DA)=""
"^DD",790.04,790.04,.02,1,1,2)
K ^WV(790.04,"C",$E(X,1,30),DA)
"^DD",790.04,790.04,.02,1,1,"DT")
2941020
"^DD",790.04,790.04,.02,3)
Select the patient for this entry.
"^DD",790.04,790.04,.02,21,0)
^^2^2^2980921^
"^DD",790.04,790.04,.02,21,1,0)
This field stores the name of the patient associated with the PAP regimen.
"^DD",790.04,790.04,.02,21,2,0)
Pointer to WV Patient (#790) file. 
"^DD",790.04,790.04,.02,"DT")
2980722
"^DD",790.04,790.04,.03,0)
PAP REGIMEN^P790.03'^WV(790.03,^0;3^Q
"^DD",790.04,790.04,.03,3)
Select the PAP regimen that was given to this patient at the date and time of this entry.
"^DD",790.04,790.04,.03,21,0)
^^1^1^2980720^
"^DD",790.04,790.04,.03,21,1,0)
This field contains the patient's PAP regimen.
"^DD",790.04,790.04,.03,"DT")
2980507
"^DD",790.05,790.05,0)
FIELD^^.01^4
"^DD",790.05,790.05,0,"DDA")
N
"^DD",790.05,790.05,0,"DT")
2980507
"^DD",790.05,790.05,0,"ID",.02)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.05,790.05,0,"IX","B",790.05,.01)

"^DD",790.05,790.05,0,"IX","C",790.05,.02)

"^DD",790.05,790.05,0,"NM","WV PREGNANCY LOG")

"^DD",790.05,790.05,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.05,790.05,.01,0)
DATE ENTERED^RDX^^0;1^S %DT="EX",%DT(0)=-DT D ^%DT S X=Y K:Y<1 X K %DT(0)
"^DD",790.05,790.05,.01,1,0)
^.1
"^DD",790.05,790.05,.01,1,1,0)
790.05^B
"^DD",790.05,790.05,.01,1,1,1)
S ^WV(790.05,"B",$E(X,1,30),DA)=""
"^DD",790.05,790.05,.01,1,1,2)
K ^WV(790.05,"B",$E(X,1,30),DA)
"^DD",790.05,790.05,.01,3)
Enter the date on which this pregnancy was entered into the Women's Heath database.  (This is not the EDC or "due date".)
"^DD",790.05,790.05,.01,21,0)
^^2^2^2980714^
"^DD",790.05,790.05,.01,21,1,0)
This field stores the date this pregnancy status record was created in the
"^DD",790.05,790.05,.01,21,2,0)
Women's Heath database.  
"^DD",790.05,790.05,.01,"DT")
2980723
"^DD",790.05,790.05,.02,0)
PATIENT^P790'^WV(790,^0;2^Q
"^DD",790.05,790.05,.02,1,0)
^.1
"^DD",790.05,790.05,.02,1,1,0)
790.05^C
"^DD",790.05,790.05,.02,1,1,1)
S ^WV(790.05,"C",$E(X,1,30),DA)=""
"^DD",790.05,790.05,.02,1,1,2)
K ^WV(790.05,"C",$E(X,1,30),DA)
"^DD",790.05,790.05,.02,1,1,"DT")
2941023
"^DD",790.05,790.05,.02,3)
Enter the patient for this entry.
"^DD",790.05,790.05,.02,21,0)
^^2^2^2980921^
"^DD",790.05,790.05,.02,21,1,0)
This field identifies the name of the patient associated with this record.
"^DD",790.05,790.05,.02,21,2,0)
It is a pointer to the WV Patient (#790) file. 
"^DD",790.05,790.05,.02,"DT")
2980507
"^DD",790.05,790.05,.03,0)
PREGNANCY STATUS^S^1:YES;0:NO;^0;3^Q
"^DD",790.05,790.05,.03,3)
Enter 'Yes' if the Woman is pregnant, enter 'No' if she is not.
"^DD",790.05,790.05,.03,21,0)
^^2^2^2980921^
"^DD",790.05,790.05,.03,21,1,0)
This field contains the pregnancy status of the patient.  The value is a
"^DD",790.05,790.05,.03,21,2,0)
set of codes: 1 = Yes, the woman is pregnant; 0 = No, she is not pregnant.
"^DD",790.05,790.05,.03,"DT")
2941023
"^DD",790.05,790.05,.04,0)
EDC^D^^0;4^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",790.05,790.05,.04,3)
Enter the EDC (Est'd Date of Confinement) or "due date" for this baby's birth.
"^DD",790.05,790.05,.04,21,0)
^^2^2^2980714^
"^DD",790.05,790.05,.04,21,1,0)
This field stores the estimated date of confinement (EDC) or the patient's
"^DD",790.05,790.05,.04,21,2,0)
delivery date.
"^DD",790.05,790.05,.04,"DT")
2941023
"^DD",790.07,790.07,0)
FIELD^^2^3
"^DD",790.07,790.07,0,"DDA")
N
"^DD",790.07,790.07,0,"DT")
2980520
"^DD",790.07,790.07,0,"IX","B",790.07,.01)

"^DD",790.07,790.07,0,"IX","C",790.07,.01)

"^DD",790.07,790.07,0,"NM","WV REFERRAL SOURCE")

"^DD",790.07,790.07,0,"PT",790,.22)

"^DD",790.07,790.07,0,"SCR")
I $P(^(0),U,2)>0&$G(XQY0)'["REFERRAL"
"^DD",790.07,790.07,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.07,790.07,.01,0)
NAME^RFX^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",790.07,790.07,.01,1,0)
^.1^^-1
"^DD",790.07,790.07,.01,1,1,0)
790.07^B
"^DD",790.07,790.07,.01,1,1,1)
S ^WV(790.07,"B",$E(X,1,30),DA)=""
"^DD",790.07,790.07,.01,1,1,2)
K ^WV(790.07,"B",$E(X,1,30),DA)
"^DD",790.07,790.07,.01,1,3,0)
790.07^C^MUMPS
"^DD",790.07,790.07,.01,1,3,1)
S WVACT="SET" D REF^WVUTL1A
"^DD",790.07,790.07,.01,1,3,2)
S WVACT="KIL" D REF^WVUTL1A
"^DD",790.07,790.07,.01,1,3,"%D",0)
^^5^5^2980522^^
"^DD",790.07,790.07,.01,1,3,"%D",1,0)
The purpose of this cross references on the name field (.01) is to allow
"^DD",790.07,790.07,.01,1,3,"%D",2,0)
user's input to be non-case sensitive during edits.  The name field (.01) 
"^DD",790.07,790.07,.01,1,3,"%D",3,0)
values may contain mixed case entries, which created case sensitivity
"^DD",790.07,790.07,.01,1,3,"%D",4,0)
when editing fields in other files that point to WV REFERRAL SOURCE
"^DD",790.07,790.07,.01,1,3,"%D",5,0)
(#790.07).
"^DD",790.07,790.07,.01,1,3,"DT")
2980522
"^DD",790.07,790.07,.01,3)
Answer must be 3-30 characters in length.
"^DD",790.07,790.07,.01,21,0)
^^4^4^2980721^
"^DD",790.07,790.07,.01,21,1,0)
This field contains a referral source used to describe how the patient was
"^DD",790.07,790.07,.01,21,2,0)
referred to the Women Veterans Health Program.  The source can be a
"^DD",790.07,790.07,.01,21,3,0)
clinic, a special event (e.g., health fair), newspaper advertisement, or
"^DD",790.07,790.07,.01,21,4,0)
individual (such as a primary provider, self, other patient).
"^DD",790.07,790.07,.01,"DEL",1,0)
I 1
"^DD",790.07,790.07,.01,"DT")
2980522
"^DD",790.07,790.07,1,0)
STATUS^RS^1:ACTIVE;0:INACTIVE;^0;2^Q
"^DD",790.07,790.07,1,21,0)
^^3^3^2980721^
"^DD",790.07,790.07,1,21,1,0)
This field stores a set of codes (1 = active and 0 = inactive) used to
"^DD",790.07,790.07,1,21,2,0)
display or hide an entry in a selection list.  If the field is active,
"^DD",790.07,790.07,1,21,3,0)
users of this package can select the entry.
"^DD",790.07,790.07,1,"DT")
2980520
"^DD",790.07,790.07,2,0)
UPPERCASE REFERRAL SOURCE^CJ8^^ ; ^S X=$$REF^WVUTL1A(D0)
"^DD",790.07,790.07,2,9)
^
"^DD",790.07,790.07,2,9.01)

"^DD",790.07,790.07,2,9.1)
S X=$$REF^WVUTL1A(D0)
"^DD",790.07,790.07,2,21,0)
^^2^2^2980709^
"^DD",790.07,790.07,2,21,1,0)
This field converts the referral source to all capital letters for 
"^DD",790.07,790.07,2,21,2,0)
x-referencing.
"^DD",790.07,790.07,2,"DT")
2980709
"^DD",790.1,790.1,0)
FIELD^^.35^36
"^DD",790.1,790.1,0,"DT")
2980624
"^DD",790.1,790.1,0,"ID",.02)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.1,790.1,0,"ID",.12)
W "   ",$E($P(^(0),U,12),4,5)_"-"_$E($P(^(0),U,12),6,7)_"-"_$E($P(^(0),U,12),2,3)
"^DD",790.1,790.1,0,"IX","ABNML",790.1,.05)

"^DD",790.1,790.1,0,"IX","ABNML1",790.1,.12)

"^DD",790.1,790.1,0,"IX","ACOLP",790.1,.3)

"^DD",790.1,790.1,0,"IX","ADE",790.1,.19)

"^DD",790.1,790.1,0,"IX","APCD",790.1,.04)

"^DD",790.1,790.1,0,"IX","B",790.1,.01)

"^DD",790.1,790.1,0,"IX","C",790.1,.02)

"^DD",790.1,790.1,0,"IX","D",790.1,.12)

"^DD",790.1,790.1,0,"IX","E",790.1,.15)

"^DD",790.1,790.1,0,"IX","S",790.1,.14)

"^DD",790.1,790.1,0,"NM","WV PROCEDURE")

"^DD",790.1,790.1,0,"PT",790.1,.3)

"^DD",790.1,790.1,0,"PT",790.4,.06)

"^DD",790.1,790.1,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.1,790.1,.01,0)
ACCESSION#^RF^^0;1^K:$L(X)>12!($L(X)<6) X
"^DD",790.1,790.1,.01,1,0)
^.1
"^DD",790.1,790.1,.01,1,1,0)
790.1^B
"^DD",790.1,790.1,.01,1,1,1)
S ^WV(790.1,"B",$E(X,1,30),DA)=""
"^DD",790.1,790.1,.01,1,1,2)
K ^WV(790.1,"B",$E(X,1,30),DA)
"^DD",790.1,790.1,.01,1,1,"DT")
2940614
"^DD",790.1,790.1,.01,3)
Answer must be 6-12 characters in length.
"^DD",790.1,790.1,.01,21,0)
^^3^3^2980924^
"^DD",790.1,790.1,.01,21,1,0)
This is the record number assigned by the Women's Health package.  It is
"^DD",790.1,790.1,.01,21,2,0)
composed of the procedure's abbreviated code, a four digit year and a
"^DD",790.1,790.1,.01,21,3,0)
sequential number.
"^DD",790.1,790.1,.01,"DT")
2940729
"^DD",790.1,790.1,.02,0)
PATIENT^RP790'^WV(790,^0;2^Q
"^DD",790.1,790.1,.02,1,0)
^.1
"^DD",790.1,790.1,.02,1,1,0)
790.1^C
"^DD",790.1,790.1,.02,1,1,1)
S ^WV(790.1,"C",$E(X,1,30),DA)=""
"^DD",790.1,790.1,.02,1,1,2)
K ^WV(790.1,"C",$E(X,1,30),DA)
"^DD",790.1,790.1,.02,1,1,"DT")
2940731
"^DD",790.1,790.1,.02,21,0)
^^2^2^2980921^^^
"^DD",790.1,790.1,.02,21,1,0)
This field contains the name of the patient associated with the procedure.
"^DD",790.1,790.1,.02,21,2,0)
Pointer to the WV Patient (#790) file.
"^DD",790.1,790.1,.02,"DT")
2980507
"^DD",790.1,790.1,.04,0)
PROCEDURE^RP790.2'^WV(790.2,^0;4^Q
"^DD",790.1,790.1,.04,1,0)
^.1
"^DD",790.1,790.1,.04,1,1,0)
790.1^APCD
"^DD",790.1,790.1,.04,1,1,1)
S ^WV(790.1,"APCD",$E(X,1,30),DA)=""
"^DD",790.1,790.1,.04,1,1,2)
K ^WV(790.1,"APCD",$E(X,1,30),DA)
"^DD",790.1,790.1,.04,1,1,"DT")
2940731
"^DD",790.1,790.1,.04,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.04,21,1,0)
This field stores the name of the procedure performed on the patient.
"^DD",790.1,790.1,.04,21,2,0)
Pointer to the WV Procedure (#790.1) file.
"^DD",790.1,790.1,.04,"DT")
2980507
"^DD",790.1,790.1,.05,0)
RESULTS/DIAGNOSIS^*P790.31'^WV(790.31,^0;5^S DIC("S")="D PROCSCRN^WVUTL2" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.05,1,0)
^.1
"^DD",790.1,790.1,.05,1,1,0)
790.1^ABNML^MUMPS
"^DD",790.1,790.1,.05,1,1,1)
D XREFP05^WVUTL2
"^DD",790.1,790.1,.05,1,1,2)
;
"^DD",790.1,790.1,.05,1,1,"DT")
2941010
"^DD",790.1,790.1,.05,3)

"^DD",790.1,790.1,.05,12)
Select the result or diagnosis for this Procedure.
"^DD",790.1,790.1,.05,12.1)
S DIC("S")="D PROCSCRN^WVUTL2"
"^DD",790.1,790.1,.05,21,0)
^^2^2^2980921^
"^DD",790.1,790.1,.05,21,1,0)
This field stores the main result or diagnosis of the patient's procedure.
"^DD",790.1,790.1,.05,21,2,0)
Pointer to the WV Results/Diagnosis (#790.31) file.
"^DD",790.1,790.1,.05,"DT")
2980507
"^DD",790.1,790.1,.06,0)
SEC RESULT/DIAGNOSIS^*P790.31'^WV(790.31,^0;6^S DIC("S")="D PROCSCRN^WVUTL2" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.06,12)
Select the result or diagnosis for this Procedure.
"^DD",790.1,790.1,.06,12.1)
S DIC("S")="D PROCSCRN^WVUTL2"
"^DD",790.1,790.1,.06,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.06,21,1,0)
This field stores a secondary outcome/diagnosis associated with the
"^DD",790.1,790.1,.06,21,2,0)
procedure.  Pointer to the WV Results/Diagnosis (#790.31) file.
"^DD",790.1,790.1,.06,"DT")
2980507
"^DD",790.1,790.1,.07,0)
PROVIDER^*P200'^VA(200,^0;7^S DIC("S")="I $D(^XUSEC(""PROVIDER"",Y))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.07,3)
Select the provider/clinician who performed this procedure.
"^DD",790.1,790.1,.07,12)
This person must be listed as a PROVIDER in the NEW PERSON file.
"^DD",790.1,790.1,.07,12.1)
S DIC("S")="I $D(^XUSEC(""PROVIDER"",Y))"
"^DD",790.1,790.1,.07,21,0)
^^2^2^2980924^^^
"^DD",790.1,790.1,.07,21,1,0)
This field stores the name of the clinician who ordered and/or performed
"^DD",790.1,790.1,.07,21,2,0)
this procedure.
"^DD",790.1,790.1,.07,"DT")
2960208
"^DD",790.1,790.1,.08,0)
HPV^S^1:YES;0:NO;^0;8^Q
"^DD",790.1,790.1,.08,3)
Enter 'Yes' if the lab reports include HPV.
"^DD",790.1,790.1,.08,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.08,21,1,0)
This field is used to document the presence or absence of the Human
"^DD",790.1,790.1,.08,21,2,0)
Papilloma Virus (HPV) in the cytology reports.
"^DD",790.1,790.1,.08,"DT")
2941013
"^DD",790.1,790.1,.09,0)
MAM UNILATERAL: LEFT OR RIGHT^S^l:LEFT;r:RIGHT;^0;9^Q
"^DD",790.1,790.1,.09,3)
Select left or right for this unilateral mammogram.
"^DD",790.1,790.1,.09,21,0)
^^1^1^2980513
"^DD",790.1,790.1,.09,21,1,0)
Select left or right for this unilateral mammogram.
"^DD",790.1,790.1,.09,"DT")
2950120
"^DD",790.1,790.1,.1,0)
HEALTH CARE FACILITY^P4'^DIC(4,^0;10^Q
"^DD",790.1,790.1,.1,3)
Enter the name of the health care facility where this procedure was performed.
"^DD",790.1,790.1,.1,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.1,21,1,0)
This field identifies the name of the health care facility where this
"^DD",790.1,790.1,.1,21,2,0)
procedure was performed.
"^DD",790.1,790.1,.1,"DT")
2980507
"^DD",790.1,790.1,.11,0)
WARD/CLINIC/LOCATION^P44'^SC(^0;11^Q
"^DD",790.1,790.1,.11,3)
Enter the ward, clinic, or location in which the procedure was performed.
"^DD",790.1,790.1,.11,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.11,21,1,0)
This field contains the name of the ward, clinic, or location where the
"^DD",790.1,790.1,.11,21,2,0)
procedure was performed.
"^DD",790.1,790.1,.11,"DT")
2940712
"^DD",790.1,790.1,.12,0)
DATE OF PROCEDURE^DX^^0;12^S %DT="ETX" D ^%DT S X=Y K:X>DT X K:Y<1 X
"^DD",790.1,790.1,.12,1,0)
^.1
"^DD",790.1,790.1,.12,1,1,0)
790.1^ABNML1^MUMPS
"^DD",790.1,790.1,.12,1,1,1)
D XREFP12^WVUTL2
"^DD",790.1,790.1,.12,1,1,2)
K ^WV(790.1,"ABNML",X,DA)
"^DD",790.1,790.1,.12,1,1,"DT")
2941010
"^DD",790.1,790.1,.12,1,2,0)
790.1^D
"^DD",790.1,790.1,.12,1,2,1)
S ^WV(790.1,"D",$E(X,1,30),DA)=""
"^DD",790.1,790.1,.12,1,2,2)
K ^WV(790.1,"D",$E(X,1,30),DA)
"^DD",790.1,790.1,.12,1,2,"DT")
2941010
"^DD",790.1,790.1,.12,3)
Enter the date on which the procedure was performed.  Dates in the future may not be entered.
"^DD",790.1,790.1,.12,21,0)
^^2^2^2980921^^^
"^DD",790.1,790.1,.12,21,1,0)
This field identifies the date on which the procedure was performed. Dates
"^DD",790.1,790.1,.12,21,2,0)
in the future may not be entered.
"^DD",790.1,790.1,.12,"DT")
2950327
"^DD",790.1,790.1,.13,0)
COMPLETE BY (DATE)^D^^0;13^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.1,790.1,.13,3)
Enter the date after which this procedure will be marked 'Delinquent' if it has not been 'Closed', under the Status field.
"^DD",790.1,790.1,.13,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.13,21,1,0)
This field contains the date used to determine that this procedure record
"^DD",790.1,790.1,.13,21,2,0)
is delinquent when a close status has not been entered in the record.
"^DD",790.1,790.1,.13,"DT")
2940918
"^DD",790.1,790.1,.14,0)
STATUS^S^o:OPEN;c:CLOSED;^0;14^Q
"^DD",790.1,790.1,.14,1,0)
^.1
"^DD",790.1,790.1,.14,1,1,0)
790.1^S
"^DD",790.1,790.1,.14,1,1,1)
S ^WV(790.1,"S",$E(X,1,30),DA)=""
"^DD",790.1,790.1,.14,1,1,2)
K ^WV(790.1,"S",$E(X,1,30),DA)
"^DD",790.1,790.1,.14,1,1,"DT")
2941209
"^DD",790.1,790.1,.14,3)
Enter the status of this procedure.
"^DD",790.1,790.1,.14,21,0)
^^3^3^2980921^^
"^DD",790.1,790.1,.14,21,1,0)
This field contains the status (set of codes: O = Open, C = Closed).  The
"^DD",790.1,790.1,.14,21,2,0)
value of this field is used in the Program Snapshot reports and the Browse
"^DD",790.1,790.1,.14,21,3,0)
Patients with Needs Past Due report.
"^DD",790.1,790.1,.14,"DT")
2980624
"^DD",790.1,790.1,.15,0)
RADIOLOGY MAM CASE#^F^^0;15^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>14!($L(X)<1) X
"^DD",790.1,790.1,.15,1,0)
^.1
"^DD",790.1,790.1,.15,1,1,0)
790.1^E
"^DD",790.1,790.1,.15,1,1,1)
S ^WV(790.1,"E",$E(X,1,30),DA)=""
"^DD",790.1,790.1,.15,1,1,2)
K ^WV(790.1,"E",$E(X,1,30),DA)
"^DD",790.1,790.1,.15,1,1,"%D",0)
^^4^4^2950527^
"^DD",790.1,790.1,.15,1,1,"%D",1,0)
This is the crossreference for the Radiology Case#.  If mammograms from
"^DD",790.1,790.1,.15,1,1,"%D",2,0)
the VISTA Radiology software are imported into the Women's Health database,
"^DD",790.1,790.1,.15,1,1,"%D",3,0)
field #.15 in the WV PROCEDURES file, this xref will allow one to identify
"^DD",790.1,790.1,.15,1,1,"%D",4,0)
the Radiology Procedure that links to this one.
"^DD",790.1,790.1,.15,1,1,"DT")
2950527
"^DD",790.1,790.1,.15,3)
Enter the VISTA Radiology case# for this mammogram.
"^DD",790.1,790.1,.15,21,0)
^^3^3^2980924^^^
"^DD",790.1,790.1,.15,21,1,0)
This field stores the VISTA Radiology/Nuclear Medicine case# for this
"^DD",790.1,790.1,.15,21,2,0)
mammogram procedure when the Women's Health package automatically imports
"^DD",790.1,790.1,.15,21,3,0)
radiology procedures.
"^DD",790.1,790.1,.15,"DT")
2950527
"^DD",790.1,790.1,.18,0)
ENTERING USER^P200'^VA(200,^0;18^Q
"^DD",790.1,790.1,.18,3)
Enter the name of the user who first entered this procedure.
"^DD",790.1,790.1,.18,21,0)
^^1^1^2980921^^
"^DD",790.1,790.1,.18,21,1,0)
This field stores the name of the person initially creating this record.
"^DD",790.1,790.1,.18,"DT")
2941230
"^DD",790.1,790.1,.19,0)
DATE FIRST ENTERED^D^^0;19^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.1,790.1,.19,1,0)
^.1
"^DD",790.1,790.1,.19,1,1,0)
790.1^ADE
"^DD",790.1,790.1,.19,1,1,1)
S ^WV(790.1,"ADE",$E(X,1,30),DA)=""
"^DD",790.1,790.1,.19,1,1,2)
K ^WV(790.1,"ADE",$E(X,1,30),DA)
"^DD",790.1,790.1,.19,1,1,"DT")
2941230
"^DD",790.1,790.1,.19,3)
Enter the date on which this procedure was first entered.
"^DD",790.1,790.1,.19,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.19,21,1,0)
This field stores the date on which this procedure record was first
"^DD",790.1,790.1,.19,21,2,0)
entered.
"^DD",790.1,790.1,.19,"DT")
2941230
"^DD",790.1,790.1,.2,0)
SATISFACTORY EXAM^S^1:YES;0:NO;^0;20^Q
"^DD",790.1,790.1,.2,3)
Enter 'Yes' if this exam was satisfactory.
"^DD",790.1,790.1,.2,21,0)
^^3^3^2980921^^
"^DD",790.1,790.1,.2,21,1,0)
This field documents that the procedure or gynecologic exam was
"^DD",790.1,790.1,.2,21,2,0)
satisfactorily performed without any impediments.  Set of codes (1 = Yes,
"^DD",790.1,790.1,.2,21,3,0)
0 = No).
"^DD",790.1,790.1,.2,"DT")
2941017
"^DD",790.1,790.1,.21,0)
T-ZONE SEEN ENTIRELY^S^1:YES;0:NO;^0;21^Q
"^DD",790.1,790.1,.21,3)
Enter 'Yes' if the entire T-Zone was seen.
"^DD",790.1,790.1,.21,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.21,21,1,0)
This field documents (set of codes: 1 = Yes, 0 = No) that the T-Zone in
"^DD",790.1,790.1,.21,21,2,0)
the colposcopy/biopsy procedure was adequately visualized.
"^DD",790.1,790.1,.21,"DT")
2941017
"^DD",790.1,790.1,.22,0)
LESION OUTSIDE CANAL^S^1:YES;0:NO;^0;22^Q
"^DD",790.1,790.1,.22,3)
Enter 'Yes' if the lesion was outside the canal.
"^DD",790.1,790.1,.22,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.22,21,1,0)
This field documents (set of codes: 1 = Yes, 0 = No) that the lesion seen
"^DD",790.1,790.1,.22,21,2,0)
during the procedure was outside the canal.
"^DD",790.1,790.1,.22,"DT")
2941017
"^DD",790.1,790.1,.23,0)
MULTIFOCAL^S^1:YES;0:NO;^0;23^Q
"^DD",790.1,790.1,.23,3)
Was the lesion multifocal (as opposed to unifocal)?
"^DD",790.1,790.1,.23,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.23,21,1,0)
This field documents (set of codes: 1 = Yes, 0 = No) that the lesion seen
"^DD",790.1,790.1,.23,21,2,0)
during the procedure was multifocal (as opposed to unifocal).
"^DD",790.1,790.1,.23,"DT")
2941017
"^DD",790.1,790.1,.24,0)
NUMBER OF QUADRANTS^NJ1,0^^0;24^K:+X'=X!(X>4)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.1,790.1,.24,3)
Enter the number of quadrants occupied by the lesion.
"^DD",790.1,790.1,.24,21,0)
^^2^2^2980921^
"^DD",790.1,790.1,.24,21,1,0)
This field contains a number (0-4) that identifies the number of quadrants
"^DD",790.1,790.1,.24,21,2,0)
occupied by the lesion.
"^DD",790.1,790.1,.24,"DT")
2941017
"^DD",790.1,790.1,.245,0)
QUADRANT LOCATIONS^FX^^2;16^K:$L(X)>11!($L(X)<2) X Q:$G(X)=""  S WV9=$$QUAD^WVUTL1A(X) K:'WV9 X Q:$G(X)=""  S:X'=$P(WV9,U,2) X=$P(WV9,U,2) K:$P(WV9,U,2)="" X K WV9 Q
"^DD",790.1,790.1,.245,3)
Enter two letter abbreviations for the location(s) of the affected quadrants (ie. UL,LL,UR,LR) separated by commas.  Answer must be 2-11 upper case characters in length.
"^DD",790.1,790.1,.245,21,0)
^^11^11^2980921^
"^DD",790.1,790.1,.245,21,1,0)
     
"^DD",790.1,790.1,.245,21,2,0)
The location of the affected quadrants.  Any of the following abbreviations
"^DD",790.1,790.1,.245,21,3,0)
may be selected: UL,LL,UR,LR.
"^DD",790.1,790.1,.245,21,4,0)
  
"^DD",790.1,790.1,.245,21,5,0)
UL - Upper Left quadrant
"^DD",790.1,790.1,.245,21,6,0)
LL - Lower Left quadrant
"^DD",790.1,790.1,.245,21,7,0)
UR - Upper Right quadrant
"^DD",790.1,790.1,.245,21,8,0)
LR - Lower Right quadrant
"^DD",790.1,790.1,.245,21,9,0)
   
"^DD",790.1,790.1,.245,21,10,0)
If more than one quadrant is included separate them with a comma, ie: LL,
"^DD",790.1,790.1,.245,21,11,0)
UL,UR will represent the inclusion of 3 of the 4 quadrants.
"^DD",790.1,790.1,.245,"DT")
2980521
"^DD",790.1,790.1,.25,0)
ECC DYSPLASIA^S^y:YES;n:NO;nd:Not Done;i:Insufficient Tissue;^0;25^Q
"^DD",790.1,790.1,.25,3)
Choose Yes, No, Not Done, or Insufficient Tissue.
"^DD",790.1,790.1,.25,21,0)
^^3^3^2980921^^
"^DD",790.1,790.1,.25,21,1,0)
This field indicates if ectocervical dysplasia was present, if an
"^DD",790.1,790.1,.25,21,2,0)
insufficient tissue sample was provided, or the sample was not examined
"^DD",790.1,790.1,.25,21,3,0)
for dysplasia.
"^DD",790.1,790.1,.25,"DT")
2941019
"^DD",790.1,790.1,.26,0)
ECTOCERVICAL BIOPSY^*P790.31'^WV(790.31,^0;26^S DIC("S")="D PROCSCRN^WVUTL2" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.26,12)
Select the diagnosis for the Ectocervical Biopsy.
"^DD",790.1,790.1,.26,12.1)
S DIC("S")="D PROCSCRN^WVUTL2"
"^DD",790.1,790.1,.26,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.26,21,1,0)
This field contains the diagnosis or impression resulting from the
"^DD",790.1,790.1,.26,21,2,0)
cytology examination.  Pointer to the WV Results/Diagnosis (#790.31) file.
"^DD",790.1,790.1,.26,"DT")
2980507
"^DD",790.1,790.1,.27,0)
MARGINS CLEAR^S^1:YES;0:NO;^0;27^Q
"^DD",790.1,790.1,.27,3)
Enter 'Yes' if the pathology report states that the margins were clear; enter 'No' if not.
"^DD",790.1,790.1,.27,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.27,21,1,0)
This field indicates tissue sample showed no pathology at the margins of
"^DD",790.1,790.1,.27,21,2,0)
the tissue sample.
"^DD",790.1,790.1,.27,"DT")
2941017
"^DD",790.1,790.1,.28,0)
STD EVALUATION^*P790.31'^WV(790.31,^0;28^S DIC("S")="D PROCSCRN^WVUTL2" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.28,12)
Select the diagnosis for the STD Evaluation.
"^DD",790.1,790.1,.28,12.1)
S DIC("S")="D PROCSCRN^WVUTL2"
"^DD",790.1,790.1,.28,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.28,21,1,0)
This field documents the findings after testing for sexually transmitted
"^DD",790.1,790.1,.28,21,2,0)
diseases.  Pointer to the WV Results/Diagnosis (#790.31) file.
"^DD",790.1,790.1,.28,"DT")
2980507
"^DD",790.1,790.1,.29,0)
IMPRESSION^*P790.31'^WV(790.31,^0;29^S DIC("S")="D PROCSCRN^WVUTL2" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.29,3)

"^DD",790.1,790.1,.29,12)
Select the Result/Diagnosis that best matches the Care Provider's Impression.
"^DD",790.1,790.1,.29,12.1)
S DIC("S")="D PROCSCRN^WVUTL2"
"^DD",790.1,790.1,.29,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.29,21,1,0)
This field contains the impression of the clinician performing the exam.  
"^DD",790.1,790.1,.29,21,2,0)
Pointer to the WV Results/Diagnosis (#790.31) file.
"^DD",790.1,790.1,.29,"DT")
2980507
"^DD",790.1,790.1,.3,0)
SCREENING PAP^*P790.1'^WV(790.1,^0;30^S DIC("S")="D PAPSCRN^WVUTL2" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.3,1,0)
^.1
"^DD",790.1,790.1,.3,1,1,0)
790.1^ACOLP^MUMPS
"^DD",790.1,790.1,.3,1,1,1)
I $P(^WV(790.1,DA,0),U,4)=2 S ^WV(790.1,"ACOLP",X,(9999999-$P(^WV(790.1,DA,0),U,12)),DA)=""
"^DD",790.1,790.1,.3,1,1,2)
K ^WV(790.1,"ACOLP",X,(9999999-$P(^WV(790.1,DA,0),U,12)),DA)
"^DD",790.1,790.1,.3,1,1,"%D",0)
^^3^3^2950801^
"^DD",790.1,790.1,.3,1,1,"%D",1,0)
If this procedure is a Colposcopy, set a crossreference on the PAP that it
"^DD",790.1,790.1,.3,1,1,"%D",2,0)
points to and the inverse date.  This will allow the PAP to bring up the
"^DD",790.1,790.1,.3,1,1,"%D",3,0)
most recent Colp related to it.
"^DD",790.1,790.1,.3,1,1,"DT")
2950801
"^DD",790.1,790.1,.3,12)
Select the Screening PAP that initiated this Colposcopy.
"^DD",790.1,790.1,.3,12.1)
S DIC("S")="D PAPSCRN^WVUTL2"
"^DD",790.1,790.1,.3,21,0)
^^2^2^2980921^^
"^DD",790.1,790.1,.3,21,1,0)
This field stores the PAP procedure associated with the follow-up
"^DD",790.1,790.1,.3,21,2,0)
procedure (e.g., colposcopy).  Pointer to the WV Procedure (#790.1) file.
"^DD",790.1,790.1,.3,"DT")
2950801
"^DD",790.1,790.1,.31,0)
STAGE AT FINAL DX^S^1:I;2:II;3:III;4:IV;5:S-Local;6:S-Regional;7:S-Distant;8:Unknown;^0;31^Q
"^DD",790.1,790.1,.31,3)
If the final diagnosis is "Invasive carcinoma" enter the pathologic or clinical stage.  If clinical stage is unknown, enter the summary ('S-') stage.
"^DD",790.1,790.1,.31,21,0)
^^3^3^2980921^^
"^DD",790.1,790.1,.31,21,1,0)
This field is used to document the clinical stage for invasive carcinoma
"^DD",790.1,790.1,.31,21,2,0)
of the cervix.  If clinical stage is unknown, enter the summary ('S-')
"^DD",790.1,790.1,.31,21,3,0)
stage.
"^DD",790.1,790.1,.31,"DT")
2950731
"^DD",790.1,790.1,.32,0)
DATE RESULTS RECEIVED^D^^0;32^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.1,790.1,.32,3)
Enter the date that the results were received/uploaded from the lab.
"^DD",790.1,790.1,.32,21,0)
^^1^1^2980513
"^DD",790.1,790.1,.32,21,1,0)
Enter the date that the results were received/uploaded from the lab.
"^DD",790.1,790.1,.32,"DT")
2950815
"^DD",790.1,790.1,.33,0)
FINAL DX PAP/COLP^*P790.31'^WV(790.31,^0;33^S DIC("S")="I $P(^(0),U,26)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.1,790.1,.33,3)
Enter the Final Diagnosis for this PAP/Colp case.
"^DD",790.1,790.1,.33,12)
Only Pap/Colp Final Diagnoses may be selected.
"^DD",790.1,790.1,.33,12.1)
S DIC("S")="I $P(^(0),U,26)"
"^DD",790.1,790.1,.33,21,0)
^^1^1^2980513
"^DD",790.1,790.1,.33,21,1,0)
Enter the Final Diagnosis for this PAP/Colp case.
"^DD",790.1,790.1,.33,"DT")
2980507
"^DD",790.1,790.1,.34,0)
FACILITY WHERE ACCESSIONED^P4'^DIC(4,^0;34^Q
"^DD",790.1,790.1,.34,3)
Select the facility where this procedure was accessioned.
"^DD",790.1,790.1,.34,21,0)
^^1^1^2980921^
"^DD",790.1,790.1,.34,21,1,0)
Select the facility where this procedure was accessioned.
"^DD",790.1,790.1,.34,"DT")
2980507
"^DD",790.1,790.1,.35,0)
RADIOLOGY CREDIT METHOD^S^0:Regular Credit;1:Interpretation Only;2:No credit;3:Technical Component Only;^0;35^Q
"^DD",790.1,790.1,.35,21,0)
^^9^9^2980828^
"^DD",790.1,790.1,.35,21,1,0)
This field is a set of codes that identify if the radiology exam was
"^DD",790.1,790.1,.35,21,2,0)
performed at the facility or elsewhere. This value is automatically
"^DD",790.1,790.1,.35,21,3,0)
entered by the Radiology/NM package when a radiology report is verified
"^DD",790.1,790.1,.35,21,4,0)
and the WH site parameter is set to accept data from the Radiology/NM
"^DD",790.1,790.1,.35,21,5,0)
package.
"^DD",790.1,790.1,.35,21,6,0)
 
"^DD",790.1,790.1,.35,21,7,0)
This piece of information will be used for WH reporting requirements to
"^DD",790.1,790.1,.35,21,8,0)
determine how many radiology procedures were performed at the facility and
"^DD",790.1,790.1,.35,21,9,0)
elsewhere.
"^DD",790.1,790.1,.35,"DT")
2980617
"^DD",790.1,790.1,1.01,0)
RESULTS TEXT^790.11^^1;0
"^DD",790.1,790.1,1.01,21,0)
^^1^1^2980518^
"^DD",790.1,790.1,1.01,21,1,0)
Elaborate further on the results of this patients various tests.
"^DD",790.1,790.1,3.01,0)
COMMENTS^F^^3;1^K:$L(X)>78!($L(X)<1) X
"^DD",790.1,790.1,3.01,3)
You may enter a one-line clinical history note (limited to 78 characters).
"^DD",790.1,790.1,3.01,21,0)
^^1^1^2980513
"^DD",790.1,790.1,3.01,21,1,0)
You may enter a one-line clinical history note (limited to 78 characters).
"^DD",790.1,790.1,3.01,"DT")
2980526
"^DD",790.1,790.1,9,0)
RADIOLOGY/NM REPORT^790.19^^9;0
"^DD",790.1,790.1,9,21,0)
^^1^1^2980828^^^
"^DD",790.1,790.1,9,21,1,0)
This field is not editable through WH options.  The radiology exams related to this procedure are presented here.
"^DD",790.1,790.1,9,"DT")
2980529
"^DD",790.1,790.11,0)
RESULTS TEXT SUB-FIELD^^.01^1
"^DD",790.1,790.11,0,"NM","RESULTS TEXT")

"^DD",790.1,790.11,0,"UP")
790.1
"^DD",790.1,790.11,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.1,790.11,.01,0)
RESULTS TEXT^W^^0;1^Q
"^DD",790.1,790.11,.01,21,0)
^^1^1^2980518^
"^DD",790.1,790.11,.01,21,1,0)
Elaborate on the results of the various tests.
"^DD",790.1,790.11,.01,"DT")
2940729
"^DD",790.1,790.19,0)
RADIOLOGY/NM REPORT SUB-FIELD^^.01^1
"^DD",790.1,790.19,0,"DT")
2980529
"^DD",790.1,790.19,0,"NM","RADIOLOGY/NM REPORT")

"^DD",790.1,790.19,0,"UP")
790.1
"^DD",790.1,790.19,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.1,790.19,.01,0)
RADIOLOGY REPORT^W^^0;1^Q
"^DD",790.1,790.19,.01,3)
The radiology report is uneditable and is extracted from the Radiology package each time it is viewed.
"^DD",790.1,790.19,.01,21,0)
^^1^1^2980828^^
"^DD",790.1,790.19,.01,21,1,0)
This field is not editable through WH options.  The radiology exams related to this procedure are presented here.
"^DD",790.1,790.19,.01,"DT")
2980529
"^DD",790.2,790.2,0)
FIELD^^.21^10
"^DD",790.2,790.2,0,"ID",.04)
W "   ",$P(^(0),U,4)
"^DD",790.2,790.2,0,"IX","B",790.2,.01)

"^DD",790.2,790.2,0,"IX","C",790.2,.02)

"^DD",790.2,790.2,0,"IX","D",790.2,.04)

"^DD",790.2,790.2,0,"IX","E",790.2,.2)

"^DD",790.2,790.2,0,"IX","F",790.2,.21)

"^DD",790.2,790.2,0,"NM","WV PROCEDURE TYPE")

"^DD",790.2,790.2,0,"PT",790.1,.04)

"^DD",790.2,790.2,0,"PT",790.3,2)

"^DD",790.2,790.2,0,"PT",790.31,.03)

"^DD",790.2,790.2,0,"PT",790.31,.04)

"^DD",790.2,790.2,0,"PT",790.31,.05)

"^DD",790.2,790.2,0,"PT",790.31,.06)

"^DD",790.2,790.2,0,"PT",790.31,.07)

"^DD",790.2,790.2,0,"PT",790.31,.08)

"^DD",790.2,790.2,0,"PT",790.31,.09)

"^DD",790.2,790.2,0,"PT",790.31,.1)

"^DD",790.2,790.2,0,"PT",790.31,.11)

"^DD",790.2,790.2,0,"PT",790.31,.12)

"^DD",790.2,790.2,0,"PT",790.31,.13)

"^DD",790.2,790.2,0,"PT",790.31,.14)

"^DD",790.2,790.2,0,"PT",790.31,.15)

"^DD",790.2,790.2,0,"PT",790.31,.16)

"^DD",790.2,790.2,0,"PT",790.31,.17)

"^DD",790.2,790.2,0,"PT",790.31,.18)

"^DD",790.2,790.2,0,"PT",790.31,.19)

"^DD",790.2,790.2,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.2,790.2,.01,0)
PROCEDURE TYPE^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",790.2,790.2,.01,1,0)
^.1
"^DD",790.2,790.2,.01,1,1,0)
790.2^B
"^DD",790.2,790.2,.01,1,1,1)
S ^WV(790.2,"B",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.01,1,1,2)
K ^WV(790.2,"B",$E(X,1,30),DA)
"^DD",790.2,790.2,.01,3)
Answer must be 3-30 characters in length.
"^DD",790.2,790.2,.01,21,0)
^^4^4^2980706^
"^DD",790.2,790.2,.01,21,1,0)
This field contains the name of the procedure type.  It may be a test
"^DD",790.2,790.2,.01,21,2,0)
(e.g., mammography, pregnancy test), diagnostic procedure (such as an
"^DD",790.2,790.2,.01,21,3,0)
open biopsy, fine needle aspiration), therapeutic procedure (e.g.,
"^DD",790.2,790.2,.01,21,4,0)
cryotherapy, lumpectomy) or a consult to a specific treating specialty.
"^DD",790.2,790.2,.01,"DT")
2960312
"^DD",790.2,790.2,.02,0)
ABBREVIATION^F^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>8!($L(X)<1) X
"^DD",790.2,790.2,.02,1,0)
^.1
"^DD",790.2,790.2,.02,1,1,0)
790.2^C
"^DD",790.2,790.2,.02,1,1,1)
S ^WV(790.2,"C",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.02,1,1,2)
K ^WV(790.2,"C",$E(X,1,30),DA)
"^DD",790.2,790.2,.02,1,1,"DT")
2940614
"^DD",790.2,790.2,.02,3)
Answer must be 1-8 characters in length.
"^DD",790.2,790.2,.02,21,0)
^^2^2^2980706^
"^DD",790.2,790.2,.02,21,1,0)
This field contains an abbreviation for a procedure type.  The data is
"^DD",790.2,790.2,.02,21,2,0)
used as a display identifier.
"^DD",790.2,790.2,.02,"DT")
2960312
"^DD",790.2,790.2,.03,0)
ASK COLPOSCOPY-TYPE RESULTS^S^0:NO;1:YES;^0;3^Q
"^DD",790.2,790.2,.03,3)
This field indicates that colposcopy-type results (page 2) should be available when editing this procedure.
"^DD",790.2,790.2,.03,21,0)
^^9^9^2980921^
"^DD",790.2,790.2,.03,21,1,0)
This field turns on and off the display of the clinical findings/tissue
"^DD",790.2,790.2,.03,21,2,0)
pathology screen that is used to document clinical exam and pathology
"^DD",790.2,790.2,.03,21,3,0)
information related to specific cervical procedures such as colposcopy,
"^DD",790.2,790.2,.03,21,4,0)
cone biopsy, laser cone and LEEP's. The value of this field should be 1
"^DD",790.2,790.2,.03,21,5,0)
(Yes) when associated with the above procedure types and new procedures
"^DD",790.2,790.2,.03,21,6,0)
that have similar documentation requirements. The clinical findings/tissue
"^DD",790.2,790.2,.03,21,7,0)
pathology screen appears in the Add a NEW Procedure and Edit a Procedure
"^DD",790.2,790.2,.03,21,8,0)
options as page 2.  Information such as related PAP accession #, quadrant
"^DD",790.2,790.2,.03,21,9,0)
involvement, impression, biopsy and staging data may be documented.
"^DD",790.2,790.2,.03,"DT")
2960312
"^DD",790.2,790.2,.04,0)
ACCESSION PREFIX^F^^0;4^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>10!($L(X)<1) X
"^DD",790.2,790.2,.04,1,0)
^.1
"^DD",790.2,790.2,.04,1,1,0)
790.2^D
"^DD",790.2,790.2,.04,1,1,1)
S ^WV(790.2,"D",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.04,1,1,2)
K ^WV(790.2,"D",$E(X,1,30),DA)
"^DD",790.2,790.2,.04,1,1,"DT")
2950216
"^DD",790.2,790.2,.04,3)
Answer must be 1-10 characters in length.
"^DD",790.2,790.2,.04,21,0)
^^4^4^2980708^^
"^DD",790.2,790.2,.04,21,1,0)
This field contains an abbreviation or synonym that is used to identify
"^DD",790.2,790.2,.04,21,2,0)
the procedure (e.g., CBE = clinical breast exam, CY = Cryotherapy). The
"^DD",790.2,790.2,.04,21,3,0)
data in this field may be concatenated with an accession # to facilitate
"^DD",790.2,790.2,.04,21,4,0)
selection of patient procedures within the software.
"^DD",790.2,790.2,.04,"DT")
2960312
"^DD",790.2,790.2,.06,0)
LAST ACCESSION#^F^^0;6^K:$L(X)>15!($L(X)<1) X
"^DD",790.2,790.2,.06,3)
Answer must be 1-15 characters in length.
"^DD",790.2,790.2,.06,21,0)
^^6^6^2980921^
"^DD",790.2,790.2,.06,21,1,0)
This field stores the most recent accession number associated with a
"^DD",790.2,790.2,.06,21,2,0)
specific procedure type.  The accession number is a combination of the
"^DD",790.2,790.2,.06,21,3,0)
year and an incremental number generated by the software. There may be
"^DD",790.2,790.2,.06,21,4,0)
multiple occurrences of the same accession number within the WV Procedure
"^DD",790.2,790.2,.06,21,5,0)
Type file, but concatenation of the accession prefix with the accession #
"^DD",790.2,790.2,.06,21,6,0)
makes this value unique within the software.
"^DD",790.2,790.2,.06,"DT")
2940705
"^DD",790.2,790.2,.08,0)
CPT CODE^P81'^ICPT(^0;8^Q
"^DD",790.2,790.2,.08,21,0)
^^3^3^2980828^
"^DD",790.2,790.2,.08,21,1,0)
This field contains the CPT code that corresponds to this procedure type.
"^DD",790.2,790.2,.08,21,2,0)
In Women's Health Version 1.0, the CPT code field is only used to generate
"^DD",790.2,790.2,.08,21,3,0)
local FileMan reports.
"^DD",790.2,790.2,.08,"DT")
2940620
"^DD",790.2,790.2,.09,0)
ICD CODE^P80.1'^ICD0(^0;9^Q
"^DD",790.2,790.2,.09,21,0)
^^3^3^2980828^
"^DD",790.2,790.2,.09,21,1,0)
This field contains the ICD code that corresponds to this procedure type.
"^DD",790.2,790.2,.09,21,2,0)
In Women's Health Version 1.0, the ICD code field is only used to generate
"^DD",790.2,790.2,.09,21,3,0)
local FileMan reports.
"^DD",790.2,790.2,.09,"DT")
2940620
"^DD",790.2,790.2,.11,0)
ASK MARGINS CLEAR? QUESTION^S^1:YES;0:NO;^0;11^Q
"^DD",790.2,790.2,.11,3)
Should the question "Margins Clear?" be asked on page 2 of treatment data screen.
"^DD",790.2,790.2,.11,21,0)
^^5^5^2980921^
"^DD",790.2,790.2,.11,21,1,0)
This field permits or denies the user from entering information at the
"^DD",790.2,790.2,.11,21,2,0)
Margins Clear prompt on the clinical findings/tissue pathology screen
"^DD",790.2,790.2,.11,21,3,0)
(page 2) of ADD a NEW Procedure and Edit a Procedure options.  This field
"^DD",790.2,790.2,.11,21,4,0)
does not affect the display of the prompt just the navigation of the
"^DD",790.2,790.2,.11,21,5,0)
cursor on the screen.
"^DD",790.2,790.2,.11,"DT")
2941016
"^DD",790.2,790.2,.2,0)
SYNONYM1^F^^0;20^K:$L(X)>30!($L(X)<1) X
"^DD",790.2,790.2,.2,1,0)
^.1
"^DD",790.2,790.2,.2,1,1,0)
790.2^E
"^DD",790.2,790.2,.2,1,1,1)
S ^WV(790.2,"E",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.2,1,1,2)
K ^WV(790.2,"E",$E(X,1,30),DA)
"^DD",790.2,790.2,.2,1,1,"DT")
2960210
"^DD",790.2,790.2,.2,3)
Enter a synonym for this procedure type.
"^DD",790.2,790.2,.2,21,0)
^^2^2^2980709^
"^DD",790.2,790.2,.2,21,1,0)
This field contains an alternative name for this procedure type.
"^DD",790.2,790.2,.2,21,2,0)
.
"^DD",790.2,790.2,.2,"DT")
2960210
"^DD",790.2,790.2,.21,0)
SYNONYM2^F^^0;21^K:$L(X)>30!($L(X)<1) X
"^DD",790.2,790.2,.21,1,0)
^.1
"^DD",790.2,790.2,.21,1,1,0)
790.2^F
"^DD",790.2,790.2,.21,1,1,1)
S ^WV(790.2,"F",$E(X,1,30),DA)=""
"^DD",790.2,790.2,.21,1,1,2)
K ^WV(790.2,"F",$E(X,1,30),DA)
"^DD",790.2,790.2,.21,1,1,"DT")
2960210
"^DD",790.2,790.2,.21,3)
Enter a synomym for this procedure type.
"^DD",790.2,790.2,.21,21,0)
^^1^1^2980921^
"^DD",790.2,790.2,.21,21,1,0)
This field contains an alternative name for this procedure type.
"^DD",790.2,790.2,.21,"DT")
2960210
"^DD",790.3,790.3,0)
FIELD^^4^5
"^DD",790.3,790.3,0,"DDA")
N
"^DD",790.3,790.3,0,"DT")
2980616
"^DD",790.3,790.3,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.3,790.3,0,"ID",2)
S %I=Y,Y=$S('$D(^(0)):"",$D(^WV(790.2,+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(790.2,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.3,790.3,0,"IX","B",790.3,.01)

"^DD",790.3,790.3,0,"IX","C",790.3,1)

"^DD",790.3,790.3,0,"NM","WV REFUSALS")

"^DD",790.3,790.3,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.3,790.3,.01,0)
REFUSAL DATE^RDX^^0;1^S %DT="EX",%DT(0)=-DT D ^%DT S X=Y K:Y<1 X K %DT(0)
"^DD",790.3,790.3,.01,1,0)
^.1
"^DD",790.3,790.3,.01,1,1,0)
790.3^B
"^DD",790.3,790.3,.01,1,1,1)
S ^WV(790.3,"B",$E(X,1,30),DA)=""
"^DD",790.3,790.3,.01,1,1,2)
K ^WV(790.3,"B",$E(X,1,30),DA)
"^DD",790.3,790.3,.01,3)

"^DD",790.3,790.3,.01,21,0)
^^2^2^2980701^
"^DD",790.3,790.3,.01,21,1,0)
This field contains the date the patient refused the procedure, test or
"^DD",790.3,790.3,.01,21,2,0)
examination.
"^DD",790.3,790.3,.01,"DT")
2980723
"^DD",790.3,790.3,1,0)
PATIENT^RP790'^WV(790,^0;2^Q
"^DD",790.3,790.3,1,1,0)
^.1
"^DD",790.3,790.3,1,1,1,0)
790.3^C
"^DD",790.3,790.3,1,1,1,1)
S ^WV(790.3,"C",$E(X,1,30),DA)=""
"^DD",790.3,790.3,1,1,1,2)
K ^WV(790.3,"C",$E(X,1,30),DA)
"^DD",790.3,790.3,1,1,1,"DT")
2980626
"^DD",790.3,790.3,1,21,0)
^^2^2^2980701^
"^DD",790.3,790.3,1,21,1,0)
This field identifies the patient who refused health care (e.g.,
"^DD",790.3,790.3,1,21,2,0)
procedure, exam, tests).  Pointer to the WV Patient (#790) file.
"^DD",790.3,790.3,1,"DT")
2980626
"^DD",790.3,790.3,2,0)
PROCEDURE^RP790.2'^WV(790.2,^0;3^Q
"^DD",790.3,790.3,2,21,0)
^^2^2^2980701^
"^DD",790.3,790.3,2,21,1,0)
This field identifies the procedure or type of health care the patient
"^DD",790.3,790.3,2,21,2,0)
refused.  Pointer to the WV Procedure Type (#790.2) file.
"^DD",790.3,790.3,2,"DT")
2980610
"^DD",790.3,790.3,3,0)
REASON^S^1:TREATED ELSEWHERE;2:NO REASON;3:OTHER;^0;4^Q
"^DD",790.3,790.3,3,3)

"^DD",790.3,790.3,3,21,0)
^^3^3^2980921^
"^DD",790.3,790.3,3,21,1,0)
This field indicates a general reason for why the patient refused
"^DD",790.3,790.3,3,21,2,0)
treatment, i.e., (1) treatment was provided elsewhere, (2) no reason was
"^DD",790.3,790.3,3,21,3,0)
given by the patient, or (3) an other reason was provided by the patient.
"^DD",790.3,790.3,3,"DT")
2980616
"^DD",790.3,790.3,4,0)
COMMENTS^F^^1;1^K:$L(X)>75!($L(X)<3) X
"^DD",790.3,790.3,4,3)
Answer must be 3-75 characters in length.
"^DD",790.3,790.3,4,21,0)
^^1^1^2980701^
"^DD",790.3,790.3,4,21,1,0)
This field contains comments related to this refusal.  
"^DD",790.3,790.3,4,"DT")
2980616
"^DD",790.31,790.31,0)
FIELD^^.31^25
"^DD",790.31,790.31,0,"DDA")
N
"^DD",790.31,790.31,0,"DT")
2980507
"^DD",790.31,790.31,0,"ID",.02)
W "   ",$P(^(0),U,2)
"^DD",790.31,790.31,0,"IX","B",790.31,.01)

"^DD",790.31,790.31,0,"IX","C",790.31,.02)

"^DD",790.31,790.31,0,"IX","P10",790.31,.1)

"^DD",790.31,790.31,0,"IX","P11",790.31,.11)

"^DD",790.31,790.31,0,"IX","P12",790.31,.12)

"^DD",790.31,790.31,0,"IX","P13",790.31,.13)

"^DD",790.31,790.31,0,"IX","P14",790.31,.14)

"^DD",790.31,790.31,0,"IX","P15",790.31,.15)

"^DD",790.31,790.31,0,"IX","P16",790.31,.16)

"^DD",790.31,790.31,0,"IX","P17",790.31,.17)

"^DD",790.31,790.31,0,"IX","P18",790.31,.18)

"^DD",790.31,790.31,0,"IX","P19",790.31,.19)

"^DD",790.31,790.31,0,"IX","P3",790.31,.03)

"^DD",790.31,790.31,0,"IX","P4",790.31,.04)

"^DD",790.31,790.31,0,"IX","P5",790.31,.05)

"^DD",790.31,790.31,0,"IX","P6",790.31,.06)

"^DD",790.31,790.31,0,"IX","P7",790.31,.07)

"^DD",790.31,790.31,0,"IX","P8",790.31,.08)

"^DD",790.31,790.31,0,"IX","P9",790.31,.09)

"^DD",790.31,790.31,0,"IX","S",790.31,.3)

"^DD",790.31,790.31,0,"IX","U",790.31,.01)

"^DD",790.31,790.31,0,"NM","WV RESULTS/DIAGNOSIS")

"^DD",790.31,790.31,0,"PT",790.1,.05)

"^DD",790.31,790.31,0,"PT",790.1,.06)

"^DD",790.31,790.31,0,"PT",790.1,.26)

"^DD",790.31,790.31,0,"PT",790.1,.28)

"^DD",790.31,790.31,0,"PT",790.1,.29)

"^DD",790.31,790.31,0,"PT",790.1,.33)

"^DD",790.31,790.31,0,"PT",790.32,.01)

"^DD",790.31,790.31,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.31,790.31,.01,0)
RESULTS/DIAGNOSIS^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",790.31,790.31,.01,1,0)
^.1
"^DD",790.31,790.31,.01,1,1,0)
790.31^B
"^DD",790.31,790.31,.01,1,1,1)
S ^WV(790.31,"B",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.01,1,1,2)
K ^WV(790.31,"B",$E(X,1,30),DA)
"^DD",790.31,790.31,.01,1,2,0)
790.31^U^MUMPS
"^DD",790.31,790.31,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.31,")
"^DD",790.31,790.31,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.31,")
"^DD",790.31,790.31,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.31,790.31,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.31,790.31,.01,1,2,"DT")
2960308
"^DD",790.31,790.31,.01,3)
Answer must be 3-30 characters in length.
"^DD",790.31,790.31,.01,21,0)
^^5^5^2980909^
"^DD",790.31,790.31,.01,21,1,0)
This field contains terms that are used to document results or diagnoses
"^DD",790.31,790.31,.01,21,2,0)
associated with specific procedure types.  The diagnosis or results for
"^DD",790.31,790.31,.01,21,3,0)
PAP smears are based on the Bethesda Classification system; those for
"^DD",790.31,790.31,.01,21,4,0)
mammograms use the American College of Radiology classification.  Entries
"^DD",790.31,790.31,.01,21,5,0)
should not be locally edited.
"^DD",790.31,790.31,.01,"DT")
2960312
"^DD",790.31,790.31,.02,0)
PRIORITY^RNJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",790.31,790.31,.02,1,0)
^.1
"^DD",790.31,790.31,.02,1,1,0)
790.31^C
"^DD",790.31,790.31,.02,1,1,1)
S ^WV(790.31,"C",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.02,1,1,2)
K ^WV(790.31,"C",$E(X,1,30),DA)
"^DD",790.31,790.31,.02,1,1,"DT")
2941007
"^DD",790.31,790.31,.02,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",790.31,790.31,.02,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.02,21,1,0)
This field stores an arbitrary number used to prioritize the results or
"^DD",790.31,790.31,.02,21,2,0)
diagnosis term. The range is from 1-90 with 90 being defined as normal or
"^DD",790.31,790.31,.02,21,3,0)
no results.
"^DD",790.31,790.31,.02,"DT")
2941013
"^DD",790.31,790.31,.03,0)
ASSOCIATED PROCEDURE-3^P790.2'^WV(790.2,^0;3^Q
"^DD",790.31,790.31,.03,1,0)
^.1
"^DD",790.31,790.31,.03,1,1,0)
790.31^P3^MUMPS
"^DD",790.31,790.31,.03,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.03,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.03,1,1,"DT")
2941015
"^DD",790.31,790.31,.03,3)
Select the procedure name with which this procedure result will be associated.
"^DD",790.31,790.31,.03,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.03,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.03,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.03,21,3,0)
biopsy, mammogram) with a specific result/diagnosis.
"^DD",790.31,790.31,.03,"DT")
2980507
"^DD",790.31,790.31,.04,0)
ASSOCIATED PROCEDURE-4^P790.2'^WV(790.2,^0;4^Q
"^DD",790.31,790.31,.04,1,0)
^.1
"^DD",790.31,790.31,.04,1,1,0)
790.31^P4^MUMPS
"^DD",790.31,790.31,.04,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.04,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.04,1,1,"DT")
2941015
"^DD",790.31,790.31,.04,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.04,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.04,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.04,21,3,0)
biopsy, mammogram) with a specific result/diagnosis.
"^DD",790.31,790.31,.04,"DT")
2980507
"^DD",790.31,790.31,.05,0)
ASSOCIATED PROCEDURE-5^P790.2'^WV(790.2,^0;5^Q
"^DD",790.31,790.31,.05,1,0)
^.1
"^DD",790.31,790.31,.05,1,1,0)
790.31^P5^MUMPS
"^DD",790.31,790.31,.05,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.05,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.05,1,1,"DT")
2941015
"^DD",790.31,790.31,.05,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.05,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.05,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.05,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.05,"DT")
2980507
"^DD",790.31,790.31,.06,0)
ASSOCIATED PROCEDURE-6^P790.2'^WV(790.2,^0;6^Q
"^DD",790.31,790.31,.06,1,0)
^.1
"^DD",790.31,790.31,.06,1,1,0)
790.31^P6^MUMPS
"^DD",790.31,790.31,.06,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.06,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.06,1,1,"DT")
2941015
"^DD",790.31,790.31,.06,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.06,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.06,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.06,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.06,"DT")
2980507
"^DD",790.31,790.31,.07,0)
ASSOCIATED PROCEDURE-7^P790.2'^WV(790.2,^0;7^Q
"^DD",790.31,790.31,.07,1,0)
^.1
"^DD",790.31,790.31,.07,1,1,0)
790.31^P7^MUMPS
"^DD",790.31,790.31,.07,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.07,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.07,1,1,"DT")
2941015
"^DD",790.31,790.31,.07,21,0)
^^3^3^2980909^^
"^DD",790.31,790.31,.07,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.07,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.07,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.07,"DT")
2980507
"^DD",790.31,790.31,.08,0)
ASSOCIATED PROCEDURE-8^P790.2'^WV(790.2,^0;8^Q
"^DD",790.31,790.31,.08,1,0)
^.1
"^DD",790.31,790.31,.08,1,1,0)
790.31^P8^MUMPS
"^DD",790.31,790.31,.08,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.08,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.08,1,1,"DT")
2941015
"^DD",790.31,790.31,.08,21,0)
^^3^3^2980909^^
"^DD",790.31,790.31,.08,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.08,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.08,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.08,"DT")
2980507
"^DD",790.31,790.31,.09,0)
ASSOCIATED PROCEDURE-9^P790.2'^WV(790.2,^0;9^Q
"^DD",790.31,790.31,.09,1,0)
^.1
"^DD",790.31,790.31,.09,1,1,0)
790.31^P9^MUMPS
"^DD",790.31,790.31,.09,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.09,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.09,1,1,"DT")
2941015
"^DD",790.31,790.31,.09,21,0)
^^3^3^2980909^^
"^DD",790.31,790.31,.09,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.09,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.09,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.09,"DT")
2980507
"^DD",790.31,790.31,.1,0)
ASSOCIATED PROCEDURE-10^P790.2'^WV(790.2,^0;10^Q
"^DD",790.31,790.31,.1,1,0)
^.1
"^DD",790.31,790.31,.1,1,1,0)
790.31^P10^MUMPS
"^DD",790.31,790.31,.1,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.1,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.1,1,1,"DT")
2941016
"^DD",790.31,790.31,.1,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.1,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.1,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.1,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.1,"DT")
2980507
"^DD",790.31,790.31,.11,0)
ASSOCIATED PROCEDURE-11^P790.2'^WV(790.2,^0;11^Q
"^DD",790.31,790.31,.11,1,0)
^.1
"^DD",790.31,790.31,.11,1,1,0)
790.31^P11^MUMPS
"^DD",790.31,790.31,.11,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.11,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.11,1,1,"DT")
2941016
"^DD",790.31,790.31,.11,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.11,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.11,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.11,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.11,"DT")
2980507
"^DD",790.31,790.31,.12,0)
ASSOCIATED PROCEDURE-12^P790.2'^WV(790.2,^0;12^Q
"^DD",790.31,790.31,.12,1,0)
^.1
"^DD",790.31,790.31,.12,1,1,0)
790.31^P12^MUMPS
"^DD",790.31,790.31,.12,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.12,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.12,1,1,"DT")
2941016
"^DD",790.31,790.31,.12,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.12,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.12,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.12,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.12,"DT")
2980507
"^DD",790.31,790.31,.13,0)
ASSOCIATED PROCEDURE-13^P790.2'^WV(790.2,^0;13^Q
"^DD",790.31,790.31,.13,1,0)
^.1
"^DD",790.31,790.31,.13,1,1,0)
790.31^P13^MUMPS
"^DD",790.31,790.31,.13,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.13,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.13,1,1,"DT")
2960316
"^DD",790.31,790.31,.13,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.13,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.13,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.13,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.13,"DT")
2980507
"^DD",790.31,790.31,.14,0)
ASSOCIATED PROCEDURE-14^P790.2'^WV(790.2,^0;14^Q
"^DD",790.31,790.31,.14,1,0)
^.1
"^DD",790.31,790.31,.14,1,1,0)
790.31^P14^MUMPS
"^DD",790.31,790.31,.14,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.14,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.14,1,1,"DT")
2941016
"^DD",790.31,790.31,.14,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.14,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.14,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.14,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.14,"DT")
2980507
"^DD",790.31,790.31,.15,0)
ASSOCIATED PROCEDURE-15^P790.2'^WV(790.2,^0;15^Q
"^DD",790.31,790.31,.15,1,0)
^.1
"^DD",790.31,790.31,.15,1,1,0)
790.31^P15^MUMPS
"^DD",790.31,790.31,.15,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.15,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.15,1,1,"DT")
2941016
"^DD",790.31,790.31,.15,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.15,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.15,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.15,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.15,"DT")
2980507
"^DD",790.31,790.31,.16,0)
ASSOCIATED PROCEDURE-16^P790.2'^WV(790.2,^0;16^Q
"^DD",790.31,790.31,.16,1,0)
^.1
"^DD",790.31,790.31,.16,1,1,0)
790.31^P16^MUMPS
"^DD",790.31,790.31,.16,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.16,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.16,1,1,"DT")
2941016
"^DD",790.31,790.31,.16,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.16,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.16,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.16,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.16,"DT")
2980507
"^DD",790.31,790.31,.17,0)
ASSOCIATED PROCEDURE-17^P790.2'^WV(790.2,^0;17^Q
"^DD",790.31,790.31,.17,1,0)
^.1
"^DD",790.31,790.31,.17,1,1,0)
790.31^P17^MUMPS
"^DD",790.31,790.31,.17,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.17,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.17,1,1,"DT")
2941016
"^DD",790.31,790.31,.17,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.17,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.17,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.17,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.17,"DT")
2980507
"^DD",790.31,790.31,.18,0)
ASSOCIATED PROCEDURE-18^P790.2'^WV(790.2,^0;18^Q
"^DD",790.31,790.31,.18,1,0)
^.1
"^DD",790.31,790.31,.18,1,1,0)
790.31^P18^MUMPS
"^DD",790.31,790.31,.18,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.18,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.18,1,1,"DT")
2941016
"^DD",790.31,790.31,.18,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.18,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.18,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.18,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.18,"DT")
2980507
"^DD",790.31,790.31,.19,0)
ASSOCIATED PROCEDURE-19^P790.2'^WV(790.2,^0;19^Q
"^DD",790.31,790.31,.19,1,0)
^.1
"^DD",790.31,790.31,.19,1,1,0)
790.31^P19^MUMPS
"^DD",790.31,790.31,.19,1,1,1)
S ^WV(790.31,"P",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.19,1,1,2)
K ^WV(790.31,"P",$E(X,1,30),DA)
"^DD",790.31,790.31,.19,1,1,"DT")
2941016
"^DD",790.31,790.31,.19,21,0)
^^3^3^2980909^
"^DD",790.31,790.31,.19,21,1,0)
This field is used to associate the name of a single procedure type stored
"^DD",790.31,790.31,.19,21,2,0)
in the WV Procedure Type (#790.2) file (e.g., PAP smear, CBE, endometrial
"^DD",790.31,790.31,.19,21,3,0)
biopsy, mammogram) with a specific result/diagnosis. 
"^DD",790.31,790.31,.19,"DT")
2980507
"^DD",790.31,790.31,.2,0)
ASSOC WITH ALL PROCEDURES^S^1:YES;0:NO;^0;20^Q
"^DD",790.31,790.31,.2,3)
Enter "YES" if this Result/Diagnosis should be associated with ALL Procedures.
"^DD",790.31,790.31,.2,21,0)
^^2^2^2980909^
"^DD",790.31,790.31,.2,21,1,0)
This field indicates, by a set of codes (1 = YES; 0 = NO), that the
"^DD",790.31,790.31,.2,21,2,0)
results/diagnosis should be associated with ALL Procedures.
"^DD",790.31,790.31,.2,"DT")
2941006
"^DD",790.31,790.31,.21,0)
NORMAL/ABNORMAL^RS^0:NORMAL;1:ABNORMAL;2:NO RESULT;^0;21^Q
"^DD",790.31,790.31,.21,3)
'Normal' procedure results will not appear in 'Abnormal Only' reports.
"^DD",790.31,790.31,.21,21,0)
^^3^3^2980917^
"^DD",790.31,790.31,.21,21,1,0)
This field is used to categorize the results/diagnosis of the procedure
"^DD",790.31,790.31,.21,21,2,0)
using a set of codes (0 = Normal, 1 = Abnormal, 2 = No Results).  This
"^DD",790.31,790.31,.21,21,3,0)
data is used in producing the Procedure Statistics report.
"^DD",790.31,790.31,.21,"DT")
2950109
"^DD",790.31,790.31,.22,0)
INCLUDES HPV^S^1:YES;0:NO;^0;22^Q
"^DD",790.31,790.31,.22,3)
Enter 'Yes' if this results/diagnosis includes HPV.
"^DD",790.31,790.31,.22,21,0)
^^3^3^2980917^
"^DD",790.31,790.31,.22,21,1,0)
This field indicates whether the HPV prompt is displayed on the edit
"^DD",790.31,790.31,.22,21,2,0)
screens of the Add a New Procedure and Edit a Procedure options.  Set of
"^DD",790.31,790.31,.22,21,3,0)
codes (1 = Yes, 0 = No).
"^DD",790.31,790.31,.22,"DT")
2941015
"^DD",790.31,790.31,.23,0)
EXCLUDE FROM REGULAR OUTPUTS^S^1:YES;0:NO;^0;23^Q
"^DD",790.31,790.31,.23,3)
Should this result/diagnosis be excluded from most regular reports, profiles, etc.  For example, the result 'Error/disregard' should be 'Yes' here.
"^DD",790.31,790.31,.23,21,0)
^^3^3^2980917^
"^DD",790.31,790.31,.23,21,1,0)
This field contains data (set of codes: 1 = Yes, 0 = No) indicating that a
"^DD",790.31,790.31,.23,21,2,0)
procedure's result/diagnosis be excluded from most regular reports,
"^DD",790.31,790.31,.23,21,3,0)
snapshots, profiles, etc.
"^DD",790.31,790.31,.23,"DT")
2941020
"^DD",790.31,790.31,.3,0)
SYNONYM1^F^^0;30^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>9!($L(X)<1) X
"^DD",790.31,790.31,.3,1,0)
^.1
"^DD",790.31,790.31,.3,1,1,0)
790.31^S
"^DD",790.31,790.31,.3,1,1,1)
S ^WV(790.31,"S",$E(X,1,30),DA)=""
"^DD",790.31,790.31,.3,1,1,2)
K ^WV(790.31,"S",$E(X,1,30),DA)
"^DD",790.31,790.31,.3,1,1,"DT")
2951104
"^DD",790.31,790.31,.3,3)
Answer must be 1-9 characters in length.
"^DD",790.31,790.31,.3,21,0)
^^3^3^2980917^^
"^DD",790.31,790.31,.3,21,1,0)
This field contains a 1-9 character long abbreviation for the
"^DD",790.31,790.31,.3,21,2,0)
result/diagnosis. A facility may add/edit/delete a synonym to suit its
"^DD",790.31,790.31,.3,21,3,0)
needs.
"^DD",790.31,790.31,.3,"DT")
2960301
"^DD",790.31,790.31,.31,0)
SYNONYM2^F^^0;31^K:$L(X)>9!($L(X)<1) X
"^DD",790.31,790.31,.31,3)
Answer must be 1-9 characters in length.
"^DD",790.31,790.31,.31,21,0)
^^3^3^2980917^^
"^DD",790.31,790.31,.31,21,1,0)
This field contains an additional 1-9 character long abbreviation for the
"^DD",790.31,790.31,.31,21,2,0)
result/diagnosis. A facility may add/edit/delete a synonym to suit its
"^DD",790.31,790.31,.31,21,3,0)
needs.
"^DD",790.31,790.31,.31,"DT")
2960301
"^DD",790.32,790.32,0)
FIELD^^.02^2
"^DD",790.32,790.32,0,"DDA")
N
"^DD",790.32,790.32,0,"DT")
2980507
"^DD",790.32,790.32,0,"IX","B",790.32,.01)

"^DD",790.32,790.32,0,"IX","C",790.32,.02)

"^DD",790.32,790.32,0,"NM","WV DIAGNOSTIC CODE TRANSLATION")

"^DD",790.32,790.32,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.32,790.32,.01,0)
WOMEN'S HEALTH DX^R*P790.31'X^WV(790.31,^0;1^S:$D(X) DINUM=X S DIC("S")="D SCREEN^WVRAD" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.32,790.32,.01,1,0)
^.1
"^DD",790.32,790.32,.01,1,1,0)
790.32^B
"^DD",790.32,790.32,.01,1,1,1)
S ^WV(790.32,"B",$E(X,1,30),DA)=""
"^DD",790.32,790.32,.01,1,1,2)
K ^WV(790.32,"B",$E(X,1,30),DA)
"^DD",790.32,790.32,.01,3)
Choose the women's health results/diagnosis code you wish to match to a radiology diagnostic code.
"^DD",790.32,790.32,.01,12)
Only Results/Diagnoses that apply to Mammograms may be selected.
"^DD",790.32,790.32,.01,12.1)
S DIC("S")="D SCREEN^WVRAD"
"^DD",790.32,790.32,.01,21,0)
^^2^2^2980924^^^^
"^DD",790.32,790.32,.01,21,1,0)
This field contains women's health results/diagnosis terms relating to
"^DD",790.32,790.32,.01,21,2,0)
radiology procedures.  Pointer to the WV Results/Diagnosis (#790.31) file.
"^DD",790.32,790.32,.01,"DT")
2980828
"^DD",790.32,790.32,.02,0)
RADIOLOGY DIAGNOSTIC CODE^P78.3'^RA(78.3,^0;2^Q
"^DD",790.32,790.32,.02,1,0)
^.1
"^DD",790.32,790.32,.02,1,1,0)
790.32^C
"^DD",790.32,790.32,.02,1,1,1)
S ^WV(790.32,"C",$E(X,1,30),DA)=""
"^DD",790.32,790.32,.02,1,1,2)
K ^WV(790.32,"C",$E(X,1,30),DA)
"^DD",790.32,790.32,.02,1,1,"DT")
2950526
"^DD",790.32,790.32,.02,3)
Enter the radiology diagnostic code you which to match with this women's health results/diagnosis.
"^DD",790.32,790.32,.02,21,0)
^^3^3^2980921^
"^DD",790.32,790.32,.02,21,1,0)
This field contains the radiology diagnostic code associated with a
"^DD",790.32,790.32,.02,21,2,0)
women's health results/diagnosis. Pointer to Diagnostic Codes (#78.3)
"^DD",790.32,790.32,.02,21,3,0)
file.
"^DD",790.32,790.32,.02,"DT")
2950526
"^DD",790.4,790.4,0)
FIELD^^.14^13
"^DD",790.4,790.4,0,"DT")
2980602
"^DD",790.4,790.4,0,"ID",.02)
W "   ",$E($P(^(0),U,2),4,5)_"-"_$E($P(^(0),U,2),6,7)_"-"_$E($P(^(0),U,2),2,3) I $P(^(0),U,6),$D(^WV(790.1,$P(^(0),U,6),0)) W "   ",$P(^WV(790.1,$P(^WV(790.4,Y,0),U,6),0),U)
"^DD",790.4,790.4,0,"IX","AOPEN",790.4,.02)

"^DD",790.4,790.4,0,"IX","AOPENS",790.4,.14)

"^DD",790.4,790.4,0,"IX","APRT",790.4,.11)

"^DD",790.4,790.4,0,"IX","B",790.4,.01)

"^DD",790.4,790.4,0,"IX","C",790.4,.06)

"^DD",790.4,790.4,0,"IX","D",790.4,.02)

"^DD",790.4,790.4,0,"NM","WV NOTIFICATION")

"^DD",790.4,790.4,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.4,790.4,.01,0)
PATIENT^RP790'^WV(790,^0;1^Q
"^DD",790.4,790.4,.01,1,0)
^.1^^-1
"^DD",790.4,790.4,.01,1,1,0)
790.4^B
"^DD",790.4,790.4,.01,1,1,1)
S ^WV(790.4,"B",$E(X,1,30),DA)=""
"^DD",790.4,790.4,.01,1,1,2)
K ^WV(790.4,"B",$E(X,1,30),DA)
"^DD",790.4,790.4,.01,3)

"^DD",790.4,790.4,.01,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.01,21,1,0)
This field stores the name of the patient associated with the notification
"^DD",790.4,790.4,.01,21,2,0)
record. Points to the WV Patient (#790) file.
"^DD",790.4,790.4,.01,"DT")
2980507
"^DD",790.4,790.4,.02,0)
DATE NOTIFICATION OPENED^RDX^^0;2^S %DT="EX",%DT(0)=-DT D ^%DT S X=Y K:Y<1 X K %DT(0)
"^DD",790.4,790.4,.02,1,0)
^.1
"^DD",790.4,790.4,.02,1,1,0)
790.4^AOPEN^MUMPS
"^DD",790.4,790.4,.02,1,1,1)
I "o"[$P(^WV(790.4,DA,0),U,14) S ^WV(790.4,"AOPEN",X,DA)=""
"^DD",790.4,790.4,.02,1,1,2)
K ^WV(790.4,"AOPEN",X,DA)
"^DD",790.4,790.4,.02,1,1,"%D",0)
^^3^3^2940818^^^^
"^DD",790.4,790.4,.02,1,1,"%D",1,0)
The "AOPEN",DATE xref, exists only for those entries where there has been
"^DD",790.4,790.4,.02,1,1,"%D",2,0)
no closure to the notification, i.e., the patient has not yet been
"^DD",790.4,790.4,.02,1,1,"%D",3,0)
reached or has not yet responded.
"^DD",790.4,790.4,.02,1,1,"DT")
2940725
"^DD",790.4,790.4,.02,1,2,0)
790.4^D
"^DD",790.4,790.4,.02,1,2,1)
S ^WV(790.4,"D",$E(X,1,30),DA)=""
"^DD",790.4,790.4,.02,1,2,2)
K ^WV(790.4,"D",$E(X,1,30),DA)
"^DD",790.4,790.4,.02,1,2,"DT")
2940714
"^DD",790.4,790.4,.02,3)
This is the date that the notification was first entered, the beginning of the process to contact the patient with information.
"^DD",790.4,790.4,.02,21,0)
^^3^3^2980909^
"^DD",790.4,790.4,.02,21,1,0)
This field stores the date that the notification was entered into
"^DD",790.4,790.4,.02,21,2,0)
database.  It may be today's date or a date in the past.  A future date
"^DD",790.4,790.4,.02,21,3,0)
cannot be associated with this record.
"^DD",790.4,790.4,.02,"DT")
2980722
"^DD",790.4,790.4,.03,0)
TYPE OF NOTIFICATION^P790.403'^WV(790.403,^0;3^Q
"^DD",790.4,790.4,.03,1,0)
^.1^^0
"^DD",790.4,790.4,.03,4)

"^DD",790.4,790.4,.03,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.03,21,1,0)
This field stores the method used to notify the patient from the choices
"^DD",790.4,790.4,.03,21,2,0)
available in the WV Notification Type (#790.403) file.
"^DD",790.4,790.4,.03,"DT")
2980507
"^DD",790.4,790.4,.04,0)
PURPOSE OF NOTIFICATION^*P790.404'^WV(790.404,^0;4^S DIC("S")="I $P(^(0),U,4)'=0" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.4,790.4,.04,12)
Select the purpose for this Notification.
"^DD",790.4,790.4,.04,12.1)
S DIC("S")="I $P(^(0),U,4)'=0"
"^DD",790.4,790.4,.04,21,0)
^^5^5^2980921^
"^DD",790.4,790.4,.04,21,1,0)
This field contains the reason for the notification, (e.g., the results of
"^DD",790.4,790.4,.04,21,2,0)
a test, reminder to schedule a procedure).  The information is required to
"^DD",790.4,790.4,.04,21,3,0)
autoqueue normal PAP and mammogram letters when the appropriate fields
"^DD",790.4,790.4,.04,21,4,0)
(.03, .04, .07 and .08) in the WV Site Parameter (#790.02) file are
"^DD",790.4,790.4,.04,21,5,0)
completed.  Pointer to the WV Notification Purpose (#790.404) file.
"^DD",790.4,790.4,.04,"DT")
2980507
"^DD",790.4,790.4,.05,0)
OUTCOME^*P790.405'^WV(790.405,^0;5^S DIC("S")="I $P(^(0),U,2)'=0" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.4,790.4,.05,12)
Select the outcome for this Notification.
"^DD",790.4,790.4,.05,12.1)
S DIC("S")="I $P(^(0),U,2)'=0"
"^DD",790.4,790.4,.05,21,0)
^^4^4^2980921^
"^DD",790.4,790.4,.05,21,1,0)
This field stores the results or outcome, which may be a goal or an event,
"^DD",790.4,790.4,.05,21,2,0)
associated with this patient's notification.  Data used to populate this
"^DD",790.4,790.4,.05,21,3,0)
field is obtained from the Notification Outcome (#790.405) file that can
"^DD",790.4,790.4,.05,21,4,0)
be edited through the Add/Edit Notification Outcomes option by the ADPAC.
"^DD",790.4,790.4,.05,"DT")
2980507
"^DD",790.4,790.4,.06,0)
ACCESSION#^*P790.1'^WV(790.1,^0;6^S DIC("S")="I $D(WVDFN) I $P(^(0),U,2)=WVDFN" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",790.4,790.4,.06,1,0)
^.1
"^DD",790.4,790.4,.06,1,1,0)
790.4^C^MUMPS
"^DD",790.4,790.4,.06,1,1,1)
S ^WV(790.4,"C",$P(^WV(790.1,X,0),U),DA)=""
"^DD",790.4,790.4,.06,1,1,2)
K ^WV(790.4,"C",$P(^WV(790.1,X,0),U))
"^DD",790.4,790.4,.06,1,1,"DT")
2941229
"^DD",790.4,790.4,.06,3)
Select an accession number from the Procedure File for this patient.
"^DD",790.4,790.4,.06,12)
Only Accession#'s pertaining to this patient may be selected.
"^DD",790.4,790.4,.06,12.1)
S DIC("S")="I $D(WVDFN) I $P(^(0),U,2)=WVDFN"
"^DD",790.4,790.4,.06,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.06,21,1,0)
This field stores the accession number of the procedure associated with
"^DD",790.4,790.4,.06,21,2,0)
this patient's notification.  Pointer to the WV Procedure (#790.1) file.
"^DD",790.4,790.4,.06,"DT")
2980507
"^DD",790.4,790.4,.07,0)
FACILITY^P4'^DIC(4,^0;7^Q
"^DD",790.4,790.4,.07,3)
Select the health care facility initiating or printing this notification.
"^DD",790.4,790.4,.07,21,0)
^^3^3^2980909^
"^DD",790.4,790.4,.07,21,1,0)
This field contains the name of the health care facility that initiated
"^DD",790.4,790.4,.07,21,2,0)
and printed the letter or notification.  Pointer to the Institution (#4)
"^DD",790.4,790.4,.07,21,3,0)
file.
"^DD",790.4,790.4,.07,"DT")
2980507
"^DD",790.4,790.4,.08,0)
DATE NOTIFICATION CLOSED^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.4,790.4,.08,3)
Enter the date that an outcome for this notification was entered and marked 'Closed'.
"^DD",790.4,790.4,.08,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.08,21,1,0)
This is the date that an outcome for this notification was entered and
"^DD",790.4,790.4,.08,21,2,0)
marked 'Closed'.
"^DD",790.4,790.4,.08,"DT")
2940722
"^DD",790.4,790.4,.09,0)
PT EDUCATION^S^n:NO;y:YES;^0;9^Q
"^DD",790.4,790.4,.09,3)
Enter whether or not patient education occurred. 
"^DD",790.4,790.4,.09,21,0)
^^2^2^2980921^
"^DD",790.4,790.4,.09,21,1,0)
This field documents, through a set of codes (Y = Yes, N = No), that
"^DD",790.4,790.4,.09,21,2,0)
patient education was provided at the time of the visit.
"^DD",790.4,790.4,.09,"DT")
2980602
"^DD",790.4,790.4,.1,0)
DATE LETTER PRINTED^DX^^0;10^S %DT="ETX",%DT(0)=-DT D ^%DT S X=Y K:Y<1 X K %DT(0)
"^DD",790.4,790.4,.1,3)
If the type of notification is a letter, then enter the date the letter was printed.
"^DD",790.4,790.4,.1,21,0)
^^5^5^2980909^^^
"^DD",790.4,790.4,.1,21,1,0)
This field contains the date on which the notification letter was printed.
"^DD",790.4,790.4,.1,21,2,0)
The date the letter is printed automatically displays through the Add a
"^DD",790.4,790.4,.1,21,3,0)
New Notification and Edit a Notification options.  Data cannot be manually
"^DD",790.4,790.4,.1,21,4,0)
entered by the user through the above options. This field is also used in
"^DD",790.4,790.4,.1,21,5,0)
generating the Program Snapshot and Browse Notifications reports.
"^DD",790.4,790.4,.1,"DT")
2980722
"^DD",790.4,790.4,.11,0)
PRINT DATE^D^^0;11^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.4,790.4,.11,1,0)
^.1
"^DD",790.4,790.4,.11,1,1,0)
790.4^APRT
"^DD",790.4,790.4,.11,1,1,1)
S ^WV(790.4,"APRT",$E(X,1,30),DA)=""
"^DD",790.4,790.4,.11,1,1,2)
K ^WV(790.4,"APRT",$E(X,1,30),DA)
"^DD",790.4,790.4,.11,1,1,"DT")
2941003
"^DD",790.4,790.4,.11,3)
Enter the date on which you would like this letter printed.
"^DD",790.4,790.4,.11,21,0)
^^8^8^2980909^
"^DD",790.4,790.4,.11,21,1,0)
This field stores the date on which this letter should be queued or
"^DD",790.4,790.4,.11,21,2,0)
printed by the Print Queued Letters option.  The letter will print out on
"^DD",790.4,790.4,.11,21,3,0)
the specified date or later depending on when the Print Queued Letters
"^DD",790.4,790.4,.11,21,4,0)
option is run.  When a default date displays in this field, it is based on
"^DD",790.4,790.4,.11,21,5,0)
whether this letter is a 'reminder' or 'results' letter.  A reminder
"^DD",790.4,790.4,.11,21,6,0)
letter's default date is based on the due date of the treatment need
"^DD",790.4,790.4,.11,21,7,0)
associated with the purpose for notification.  The default date for the
"^DD",790.4,790.4,.11,21,8,0)
results letter is today's date.
"^DD",790.4,790.4,.11,"DT")
2941003
"^DD",790.4,790.4,.13,0)
COMPLETE BY (DATE)^D^^0;13^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",790.4,790.4,.13,3)
Enter the date this notification will be marked 'Delinquent' if it has not been 'Closed'.
"^DD",790.4,790.4,.13,21,0)
^^4^4^2980909^
"^DD",790.4,790.4,.13,21,1,0)
This field contains the date that this notification will be considered
"^DD",790.4,790.4,.13,21,2,0)
delinquent or past due if it does not have a status of closed.  The value
"^DD",790.4,790.4,.13,21,3,0)
of this field is used to generate the information on the Browse
"^DD",790.4,790.4,.13,21,4,0)
Notifications and Program Snapshot reports.
"^DD",790.4,790.4,.13,"DT")
2940918
"^DD",790.4,790.4,.14,0)
STATUS^S^o:OPEN;c:CLOSED;^0;14^Q
"^DD",790.4,790.4,.14,1,0)
^.1
"^DD",790.4,790.4,.14,1,1,0)
790.4^AOPENS^MUMPS
"^DD",790.4,790.4,.14,1,1,1)
S:"o"[X ^WV(790.4,"AOPEN",$P(^WV(790.4,DA,0),U,2),DA)="" K:X="c" ^WV(790.4,"AOPEN",$P(^WV(790.4,DA,0),U,2),DA)
"^DD",790.4,790.4,.14,1,1,2)
;
"^DD",790.4,790.4,.14,1,1,"DT")
2940913
"^DD",790.4,790.4,.14,3)
Enter the status for this notification.
"^DD",790.4,790.4,.14,21,0)
^^3^3^2980921^
"^DD",790.4,790.4,.14,21,1,0)
This field stores the status (set of codes: O = Open, C = Closed) for this
"^DD",790.4,790.4,.14,21,2,0)
notification.  The value of this field is used in generating the Program
"^DD",790.4,790.4,.14,21,3,0)
Snapshot and Browse Notifications reports.
"^DD",790.4,790.4,.14,"DT")
2940913
"^DD",790.403,790.403,0)
FIELD^^.03^3
"^DD",790.403,790.403,0,"DDA")
N
"^DD",790.403,790.403,0,"DT")
2980921
"^DD",790.403,790.403,0,"ID",.03)
W "   ",$P(^(0),U,3)
"^DD",790.403,790.403,0,"IX","B",790.403,.01)

"^DD",790.403,790.403,0,"IX","C",790.403,.03)

"^DD",790.403,790.403,0,"NM","WV NOTIFICATION TYPE")

"^DD",790.403,790.403,0,"PT",790.4,.03)

"^DD",790.403,790.403,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.403,790.403,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",790.403,790.403,.01,1,0)
^.1
"^DD",790.403,790.403,.01,1,1,0)
790.403^B
"^DD",790.403,790.403,.01,1,1,1)
S ^WV(790.403,"B",$E(X,1,30),DA)=""
"^DD",790.403,790.403,.01,1,1,2)
K ^WV(790.403,"B",$E(X,1,30),DA)
"^DD",790.403,790.403,.01,3)
Answer must be 3-30 characters in length.
"^DD",790.403,790.403,.01,21,0)
^^4^4^2980921^
"^DD",790.403,790.403,.01,21,1,0)
This field contains types of notifications which indicate how patients
"^DD",790.403,790.403,.01,21,2,0)
were informed about test and procedure results, and treatment needs.  For
"^DD",790.403,790.403,.01,21,3,0)
example, contact PHN (primary health nurse), conversation with patient,
"^DD",790.403,790.403,.01,21,4,0)
consult, or 2nd phone call.
"^DD",790.403,790.403,.01,"DT")
2980921
"^DD",790.403,790.403,.02,0)
PRINTABLE (EG.,LETTER)^S^0:NO;1:YES;^0;2^Q
"^DD",790.403,790.403,.02,3)
Enter 'Yes' if this type of notification will be printed.
"^DD",790.403,790.403,.02,21,0)
^^2^2^2980921^
"^DD",790.403,790.403,.02,21,1,0)
This field stores a code (0 = No, 1 = Yes) that indicates if this
"^DD",790.403,790.403,.02,21,2,0)
notification type will be printed.
"^DD",790.403,790.403,.02,"DT")
2940926
"^DD",790.403,790.403,.03,0)
SYNONYM^F^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>4!($L(X)<1) X
"^DD",790.403,790.403,.03,1,0)
^.1
"^DD",790.403,790.403,.03,1,1,0)
790.403^C
"^DD",790.403,790.403,.03,1,1,1)
S ^WV(790.403,"C",$E(X,1,30),DA)=""
"^DD",790.403,790.403,.03,1,1,2)
K ^WV(790.403,"C",$E(X,1,30),DA)
"^DD",790.403,790.403,.03,1,1,"DT")
2950319
"^DD",790.403,790.403,.03,3)
Enter an abbreviation or short synonym by which this notification type may be selected.  For example, "LF" for "Letter, First".  Answer must be 4 characters or less.
"^DD",790.403,790.403,.03,21,0)
^^3^3^2980921^
"^DD",790.403,790.403,.03,21,1,0)
This field stores an abbreviation or short synonym for the notification
"^DD",790.403,790.403,.03,21,2,0)
type.  For example, "LF" for "Letter, First".  New synonyms may be entered
"^DD",790.403,790.403,.03,21,3,0)
or edited by the case manager.
"^DD",790.403,790.403,.03,"DT")
2950319
"^DD",790.404,790.404,0)
FIELD^^1.01^7
"^DD",790.404,790.404,0,"DDA")
N
"^DD",790.404,790.404,0,"ID",.02)
W " ",$P(^(0),U,3),"   ",@("$P($P($C(59)_$S($D(^DD(790.404,.02,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,2)_"":"",2),$C(59),1)")
"^DD",790.404,790.404,0,"IX","B",790.404,.01)

"^DD",790.404,790.404,0,"IX","C",790.404,.03)

"^DD",790.404,790.404,0,"IX","U",790.404,.01)

"^DD",790.404,790.404,0,"NM","WV NOTIFICATION PURPOSE")

"^DD",790.404,790.404,0,"PT",790.02,.04)

"^DD",790.404,790.404,0,"PT",790.02,.08)

"^DD",790.404,790.404,0,"PT",790.4,.04)

"^DD",790.404,790.404,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.404,790.404,.01,0)
NOTIFICATION PURPOSE^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>50!($L(X)<3)!'(X'?1P.E) X
"^DD",790.404,790.404,.01,1,0)
^.1
"^DD",790.404,790.404,.01,1,1,0)
790.404^B
"^DD",790.404,790.404,.01,1,1,1)
S ^WV(790.404,"B",$E(X,1,50),DA)=""
"^DD",790.404,790.404,.01,1,1,2)
K ^WV(790.404,"B",$E(X,1,50),DA)
"^DD",790.404,790.404,.01,1,2,0)
790.404^U^MUMPS
"^DD",790.404,790.404,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.404,")
"^DD",790.404,790.404,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.404,")
"^DD",790.404,790.404,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.404,790.404,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.404,790.404,.01,1,2,"DT")
2960308
"^DD",790.404,790.404,.01,3)
Answer must be 3-50 characters in length.
"^DD",790.404,790.404,.01,21,0)
^^5^5^2980921^
"^DD",790.404,790.404,.01,21,1,0)
This field stores the reason for the notification.  The reason should
"^DD",790.404,790.404,.01,21,2,0)
include information that distinguishes it (the letter/notification) from
"^DD",790.404,790.404,.01,21,3,0)
similar procedure/test results or future treatment needs. For example,
"^DD",790.404,790.404,.01,21,4,0)
pregnancy test positive vs. pregnancy test negative; PAP (Annual Due)
"^DD",790.404,790.404,.01,21,5,0)
vs.PAP (Follow-up Due).
"^DD",790.404,790.404,.01,"DT")
2960308
"^DD",790.404,790.404,.02,0)
PRIORITY^RS^1:URGENT;2:ASAP;3:ROUTINE;^0;2^Q
"^DD",790.404,790.404,.02,3)
Enter the priority for this purpose of notification.
"^DD",790.404,790.404,.02,21,0)
^^4^4^2980904^^
"^DD",790.404,790.404,.02,21,1,0)
This field associates a priority with the notification.  The priority
"^DD",790.404,790.404,.02,21,2,0)
choices are (1) urgent, (2) ASAP, and (3) routine. These priorities are
"^DD",790.404,790.404,.02,21,3,0)
used within the Browse Notifications options to print a list of
"^DD",790.404,790.404,.02,21,4,0)
notifications by priority.
"^DD",790.404,790.404,.02,"DT")
2941005
"^DD",790.404,790.404,.03,0)
SYNONYM^F^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>6!($L(X)<1) X
"^DD",790.404,790.404,.03,1,0)
^.1
"^DD",790.404,790.404,.03,1,1,0)
790.404^C
"^DD",790.404,790.404,.03,1,1,1)
S ^WV(790.404,"C",$E(X,1,30),DA)=""
"^DD",790.404,790.404,.03,1,1,2)
K ^WV(790.404,"C",$E(X,1,30),DA)
"^DD",790.404,790.404,.03,1,1,"DT")
2950216
"^DD",790.404,790.404,.03,3)
Enter an abbreviation or short synonym by which this notification purpose & letter may be selected.  For example, "P6" for "PAP 6 weeks P.P.".  Answer must be 6 characters or less.
"^DD",790.404,790.404,.03,21,0)
^^3^3^2980904^^
"^DD",790.404,790.404,.03,21,1,0)
This field contains an abbreviation or short synonym that is used to
"^DD",790.404,790.404,.03,21,2,0)
select a type of notification.  For example, "P6" for "PAP 6 weeks
"^DD",790.404,790.404,.03,21,3,0)
post PAP" or "C1" for "Colp follow-up, PAP next month."
"^DD",790.404,790.404,.03,"DT")
2950216
"^DD",790.404,790.404,.04,0)
ACTIVE^S^1:YES;0:NO;^0;4^Q
"^DD",790.404,790.404,.04,3)
Enter 'Yes' to allow users to choose this purpose & letter.  Enter 'No' to prevent users from choosing this purpose & letter.  (If 'No', this purpose will not be presented.)
"^DD",790.404,790.404,.04,21,0)
^^3^3^2980921^
"^DD",790.404,790.404,.04,21,1,0)
This field contains a set of codes (1 = Yes, 0 = No) used to display or
"^DD",790.404,790.404,.04,21,2,0)
hide an entry in a selection list.  If the field is active and contains a
"^DD",790.404,790.404,.04,21,3,0)
'1' or yes, users of this package can select the entry. 
"^DD",790.404,790.404,.04,"DT")
2950316
"^DD",790.404,790.404,.05,0)
ASSOCIATE WITH BR/CX TX^S^BR:BREAST TX;CX:CERVICAL TX;^0;5^Q
"^DD",790.404,790.404,.05,3)
If this purpose of notification is used exclusively for cervical or breast treatment needs, select CX or BR.  This will be used in calculating default print dates of letters, based on Tx needs.
"^DD",790.404,790.404,.05,21,0)
^^6^6^2980921^
"^DD",790.404,790.404,.05,21,1,0)
This field has a 2-fold purpose. It identifies that the notification
"^DD",790.404,790.404,.05,21,2,0)
letter is associated with cervical or breast treatment needs and also
"^DD",790.404,790.404,.05,21,3,0)
determines a default print date based on the treatment need type. The
"^DD",790.404,790.404,.05,21,4,0)
value of this field is a set of codes (BR for breast Tx need; CX for
"^DD",790.404,790.404,.05,21,5,0)
cervical Tx need).  If a clinician does not want to automatically print a
"^DD",790.404,790.404,.05,21,6,0)
letter, the field may be left blank.
"^DD",790.404,790.404,.05,"DT")
2950317
"^DD",790.404,790.404,.06,0)
RESULT OR REMINDER LETTER^S^1:RESULT;0:REMINDER;^0;6^Q
"^DD",790.404,790.404,.06,3)
Enter result if the default to print this letter should be today (to send results to the patient immediately).  Enter reminder if the default print date should be in the future (e.g., Annual PAP).
"^DD",790.404,790.404,.06,21,0)
^^4^4^2980921^
"^DD",790.404,790.404,.06,21,1,0)
This field contains a code (1 = Result; 2 = Reminder) used to determine a
"^DD",790.404,790.404,.06,21,2,0)
print date for the letter.  A notification identified as a result is
"^DD",790.404,790.404,.06,21,3,0)
printed immediately and a reminder is printed on a future date (e.g.,
"^DD",790.404,790.404,.06,21,4,0)
Annual PAP).
"^DD",790.404,790.404,.06,"DT")
2950317
"^DD",790.404,790.404,1.01,0)
LETTER TEXT^790.414^^1;0
"^DD",790.404,790.404,1.01,21,0)
^^1^1^2980716^
"^DD",790.404,790.404,1.01,21,1,0)
This field stores the text of the notification letter.
"^DD",790.404,790.414,0)
LETTER TEXT SUB-FIELD^^.01^1
"^DD",790.404,790.414,0,"NM","LETTER TEXT")

"^DD",790.404,790.414,0,"UP")
790.404
"^DD",790.404,790.414,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.404,790.414,.01,0)
LETTER TEXT^WL^^0;1^Q
"^DD",790.404,790.414,.01,21,0)
^^1^1^2980518^
"^DD",790.404,790.414,.01,21,1,0)
Enter the text of the letter that you want included for notifications.
"^DD",790.404,790.414,.01,"DT")
2940822
"^DD",790.405,790.405,0)
FIELD^^.02^2
"^DD",790.405,790.405,0,"DDA")
N
"^DD",790.405,790.405,0,"DT")
2980921
"^DD",790.405,790.405,0,"IX","B",790.405,.01)

"^DD",790.405,790.405,0,"IX","U",790.405,.01)

"^DD",790.405,790.405,0,"NM","WV NOTIFICATION OUTCOME")

"^DD",790.405,790.405,0,"PT",790.4,.05)

"^DD",790.405,790.405,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.405,790.405,.01,0)
OUTCOME^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",790.405,790.405,.01,1,0)
^.1
"^DD",790.405,790.405,.01,1,1,0)
790.405^B
"^DD",790.405,790.405,.01,1,1,1)
S ^WV(790.405,"B",$E(X,1,30),DA)=""
"^DD",790.405,790.405,.01,1,1,2)
K ^WV(790.405,"B",$E(X,1,30),DA)
"^DD",790.405,790.405,.01,1,2,0)
790.405^U^MUMPS
"^DD",790.405,790.405,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.405,")
"^DD",790.405,790.405,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.405,")
"^DD",790.405,790.405,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.405,790.405,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.405,790.405,.01,1,2,"DT")
2960308
"^DD",790.405,790.405,.01,3)
Answer must be 3-30 characters in length.
"^DD",790.405,790.405,.01,21,0)
^^3^3^2980921^
"^DD",790.405,790.405,.01,21,1,0)
This field contains the terms describing a notification outcome.  An
"^DD",790.405,790.405,.01,21,2,0)
outcome may be a goal or an event (e.g., PAP normal letter sent, provider
"^DD",790.405,790.405,.01,21,3,0)
consult, CBE refused, scheduled appt for MAM).
"^DD",790.405,790.405,.01,"DT")
2980921
"^DD",790.405,790.405,.02,0)
ACTIVE^S^0:NO;1:YES;^0;2^Q
"^DD",790.405,790.405,.02,3)
Enter 'Yes' if this notification outcome should be available for the user to choose.  Enter 'No' if it should no longer be available.
"^DD",790.405,790.405,.02,21,0)
^^3^3^2980921^
"^DD",790.405,790.405,.02,21,1,0)
This field contains a set of codes (1 = Yes, 0 = No) used to display or
"^DD",790.405,790.405,.02,21,2,0)
hide an entry in a selection list.  If the field is active and contains a
"^DD",790.405,790.405,.02,21,3,0)
'1' or yes, users of this package can select the entry.
"^DD",790.405,790.405,.02,"DT")
2950320
"^DD",790.5,790.5,0)
FIELD^^.01^1
"^DD",790.5,790.5,0,"IX","B",790.5,.01)

"^DD",790.5,790.5,0,"IX","U",790.5,.01)

"^DD",790.5,790.5,0,"NM","WV CERVICAL TX NEED")

"^DD",790.5,790.5,0,"PT",790,.11)

"^DD",790.5,790.5,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.5,790.5,.01,0)
CERVICAL TX NEED^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<3)!'(X'?1P.E) X
"^DD",790.5,790.5,.01,1,0)
^.1
"^DD",790.5,790.5,.01,1,1,0)
790.5^B
"^DD",790.5,790.5,.01,1,1,1)
S ^WV(790.5,"B",$E(X,1,30),DA)=""
"^DD",790.5,790.5,.01,1,1,2)
K ^WV(790.5,"B",$E(X,1,30),DA)
"^DD",790.5,790.5,.01,1,2,0)
790.5^U^MUMPS
"^DD",790.5,790.5,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.5,")
"^DD",790.5,790.5,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.5,")
"^DD",790.5,790.5,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.5,790.5,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.5,790.5,.01,1,2,"DT")
2960308
"^DD",790.5,790.5,.01,3)
Answer must be 3-20 characters in length.
"^DD",790.5,790.5,.01,21,0)
^^3^3^2980630^
"^DD",790.5,790.5,.01,21,1,0)
This field stores the name or terms used to describe cervical treatment
"^DD",790.5,790.5,.01,21,2,0)
needs such as tests, therapeutic procedures, and referrals to another
"^DD",790.5,790.5,.01,21,3,0)
agency.
"^DD",790.5,790.5,.01,"DT")
2960308
"^DD",790.51,790.51,0)
FIELD^^.01^1
"^DD",790.51,790.51,0,"DDA")
N
"^DD",790.51,790.51,0,"IX","B",790.51,.01)

"^DD",790.51,790.51,0,"IX","U",790.51,.01)

"^DD",790.51,790.51,0,"NM","WV BREAST TX NEED")

"^DD",790.51,790.51,0,"PT",790,.18)

"^DD",790.51,790.51,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.51,790.51,.01,0)
BREAST TX NEED^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<3)!'(X'?1P.E) X
"^DD",790.51,790.51,.01,1,0)
^.1
"^DD",790.51,790.51,.01,1,1,0)
790.51^B
"^DD",790.51,790.51,.01,1,1,1)
S ^WV(790.51,"B",$E(X,1,30),DA)=""
"^DD",790.51,790.51,.01,1,1,2)
K ^WV(790.51,"B",$E(X,1,30),DA)
"^DD",790.51,790.51,.01,1,2,0)
790.51^U^MUMPS
"^DD",790.51,790.51,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.51,")
"^DD",790.51,790.51,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.51,")
"^DD",790.51,790.51,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.51,790.51,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.51,790.51,.01,1,2,"DT")
2960308
"^DD",790.51,790.51,.01,3)
Answer must be 3-20 characters in length.
"^DD",790.51,790.51,.01,21,0)
^^2^2^2980630^
"^DD",790.51,790.51,.01,21,1,0)
This field contains the accepted tests and actions (e.g., referrals to
"^DD",790.51,790.51,.01,21,2,0)
another agency) associated with women's breast treatment needs.
"^DD",790.51,790.51,.01,"DT")
2960308
"^DD",790.6,790.6,0)
FIELD^^1.01^2
"^DD",790.6,790.6,0,"IX","B",790.6,.01)

"^DD",790.6,790.6,0,"NM","WV LETTER")

"^DD",790.6,790.6,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.6,790.6,.01,0)
LETTER^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
"^DD",790.6,790.6,.01,1,0)
^.1
"^DD",790.6,790.6,.01,1,1,0)
790.6^B
"^DD",790.6,790.6,.01,1,1,1)
S ^WV(790.6,"B",$E(X,1,30),DA)=""
"^DD",790.6,790.6,.01,1,1,2)
K ^WV(790.6,"B",$E(X,1,30),DA)
"^DD",790.6,790.6,.01,3)
NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
"^DD",790.6,790.6,.01,21,0)
^^1^1^2980721^
"^DD",790.6,790.6,.01,21,1,0)
This field contains the name of the generic sample letter.
"^DD",790.6,790.6,1.01,0)
LETTER TEXT^790.61^^1;0
"^DD",790.6,790.6,1.01,21,0)
^^1^1^2980721^
"^DD",790.6,790.6,1.01,21,1,0)
This field stores the body of the generic or sample notification letter.
"^DD",790.6,790.61,0)
LETTER TEXT SUB-FIELD^^.01^1
"^DD",790.6,790.61,0,"NM","LETTER TEXT")

"^DD",790.6,790.61,0,"UP")
790.6
"^DD",790.6,790.61,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.6,790.61,.01,0)
LETTER TEXT^WL^^0;1^Q
"^DD",790.6,790.61,.01,21,0)
^^1^1^2980518^
"^DD",790.6,790.61,.01,21,1,0)
This field is where the generic backup letter is stored.
"^DD",790.6,790.61,.01,"DT")
2940822
"^DD",790.71,790.71,0)
FIELD^^.76^45
"^DD",790.71,790.71,0,"DDA")
N
"^DD",790.71,790.71,0,"DT")
2980709
"^DD",790.71,790.71,0,"ID",.02)
S %I=Y,Y=$S('$D(^(0)):"",$D(^DIC(4,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(4,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",790.71,790.71,0,"ID",.18)
W "   ",@("$P($P($C(59)_$S($D(^DD(790.71,.18,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,18)_"":"",2),$C(59),1)")
"^DD",790.71,790.71,0,"IX","B",790.71,.01)

"^DD",790.71,790.71,0,"IX","C",790.71,.02)

"^DD",790.71,790.71,0,"IX","T",790.71,.18)

"^DD",790.71,790.71,0,"NM","WV SNAPSHOT REPORTS")

"^DD",790.71,790.71,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.71,790.71,.01,0)
DATE OF SNAPSHOT^RDX^^0;1^S %DT="EX" D ^%DT S X=Y S:$D(X) DINUM=X K:Y<1 X
"^DD",790.71,790.71,.01,1,0)
^.1
"^DD",790.71,790.71,.01,1,1,0)
790.71^B
"^DD",790.71,790.71,.01,1,1,1)
S ^WV(790.71,"B",$E(X,1,30),DA)=""
"^DD",790.71,790.71,.01,1,1,2)
K ^WV(790.71,"B",$E(X,1,30),DA)
"^DD",790.71,790.71,.01,3)
Enter the date on which this snapshot report was run.
"^DD",790.71,790.71,.01,21,0)
^^1^1^2980708^
"^DD",790.71,790.71,.01,21,1,0)
This field stores the date on which a Program Snapshot report was run.
"^DD",790.71,790.71,.01,"DT")
2980610
"^DD",790.71,790.71,.02,0)
Facility^P4'^DIC(4,^0;2^Q
"^DD",790.71,790.71,.02,1,0)
^.1
"^DD",790.71,790.71,.02,1,1,0)
790.71^C
"^DD",790.71,790.71,.02,1,1,1)
S ^WV(790.71,"C",$E(X,1,30),DA)=""
"^DD",790.71,790.71,.02,1,1,2)
K ^WV(790.71,"C",$E(X,1,30),DA)
"^DD",790.71,790.71,.02,1,1,"DT")
2950124
"^DD",790.71,790.71,.02,3)
Enter the facility for which this snapshot report was run.
"^DD",790.71,790.71,.02,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.02,21,1,0)
This field stores the name of the facility for which this Program Snapshot
"^DD",790.71,790.71,.02,21,2,0)
report was run.
"^DD",790.71,790.71,.02,"DT")
2980507
"^DD",790.71,790.71,.03,0)
Total Women in Register^NJ6,0^^0;3^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.03,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.03,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.03,21,1,0)
This field contains the total number of women with active records in the
"^DD",790.71,790.71,.03,21,2,0)
WV Patient (#790) file.
"^DD",790.71,790.71,.03,"DT")
2950123
"^DD",790.71,790.71,.04,0)
Women Who Are Pregnant^NJ6,0^^0;4^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.04,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.04,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.04,21,1,0)
This field contains the number of women who were pregnant at the time
"^DD",790.71,790.71,.04,21,2,0)
the Program Snapshot report option was run.
"^DD",790.71,790.71,.04,"DT")
2950123
"^DD",790.71,790.71,.05,0)
Women Who Are DES Daughters^NJ6,0^^0;5^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.05,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.05,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.05,21,1,0)
This field contains the number of women who were DES daughters when the
"^DD",790.71,790.71,.05,21,2,0)
Program Snapshot report option was run. 
"^DD",790.71,790.71,.05,"DT")
2950123
"^DD",790.71,790.71,.06,0)
PAP Needs Not Spec'd/Dated^NJ6,0^^0;6^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.06,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.06,21,0)
^^3^3^2980708^
"^DD",790.71,790.71,.06,21,1,0)
This field contains the number of women whose records indicated that their
"^DD",790.71,790.71,.06,21,2,0)
cervical treatment needs were not specificed or the due date was not
"^DD",790.71,790.71,.06,21,3,0)
recorded.
"^DD",790.71,790.71,.06,"DT")
2950123
"^DD",790.71,790.71,.07,0)
PAP Needs Spec'd & Past Due^NJ6,0^^0;7^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.07,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.07,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.07,21,1,0)
This field contains the number of women whose records indicated that their
"^DD",790.71,790.71,.07,21,2,0)
cervical treatment needs were specificed and are past due.
"^DD",790.71,790.71,.07,"DT")
2950123
"^DD",790.71,790.71,.08,0)
MAM Needs Not Spec'd/Dated^NJ6,0^^0;8^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.08,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.08,21,0)
^^3^3^2980708^
"^DD",790.71,790.71,.08,21,1,0)
This field contains the number of women whose records indicated that
"^DD",790.71,790.71,.08,21,2,0)
breast treatment needs were not specificed or the due date was not
"^DD",790.71,790.71,.08,21,3,0)
entered.
"^DD",790.71,790.71,.08,"DT")
2950123
"^DD",790.71,790.71,.09,0)
MAM Needs Spec'd & Past Due^NJ6,0^^0;9^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.09,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.09,21,0)
^^2^2^2980708^
"^DD",790.71,790.71,.09,21,1,0)
This field contains the number of women whose records indicated that
"^DD",790.71,790.71,.09,21,2,0)
their breast treatment needs were specificed and are past due.
"^DD",790.71,790.71,.09,"DT")
2950123
"^DD",790.71,790.71,.1,0)
Total Procedures Status OPEN^NJ6,0^^0;10^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.1,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.1,21,0)
^^2^2^2980713^^
"^DD",790.71,790.71,.1,21,1,0)
This field contains the number of procedure records that have a status of
"^DD",790.71,790.71,.1,21,2,0)
open.
"^DD",790.71,790.71,.1,"DT")
2950123
"^DD",790.71,790.71,.11,0)
OPEN Procedures Past Due^NJ6,0^^0;11^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.11,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.11,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.11,21,1,0)
This field contains the number of procedure records (with an 'Open'
"^DD",790.71,790.71,.11,21,2,0)
status) which indicate that breast or cervical treatment needs are past
"^DD",790.71,790.71,.11,21,3,0)
due.
"^DD",790.71,790.71,.11,"DT")
2950123
"^DD",790.71,790.71,.12,0)
Total PAPS for the Year^NJ6,0^^0;12^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.12,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.12,21,0)
^^2^2^2980921^
"^DD",790.71,790.71,.12,21,1,0)
This field contains a count of the PAP smears done since the beginning of
"^DD",790.71,790.71,.12,21,2,0)
the calendar or fiscal year, depending upon what the user selected.
"^DD",790.71,790.71,.12,"DT")
2980713
"^DD",790.71,790.71,.13,0)
Total MAMS for the Year^NJ6,0^^0;13^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.13,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.13,21,0)
^^2^2^2980921^
"^DD",790.71,790.71,.13,21,1,0)
This field contains a count of the mammograms done since the beginning of
"^DD",790.71,790.71,.13,21,2,0)
the calendar or fiscal year, depending upon what the user selected.
"^DD",790.71,790.71,.13,"DT")
2980713
"^DD",790.71,790.71,.14,0)
Total Notifications Stat OPEN^NJ6,0^^0;14^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.14,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.14,21,0)
^^2^2^2980713^
"^DD",790.71,790.71,.14,21,1,0)
This field stores the number of notification records, with a status of
"^DD",790.71,790.71,.14,21,2,0)
open, when the Program Snapshot report was run.
"^DD",790.71,790.71,.14,"DT")
2950123
"^DD",790.71,790.71,.15,0)
OPEN Notifications Past Due^NJ6,0^^0;15^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.15,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.15,21,0)
^^2^2^2980713^
"^DD",790.71,790.71,.15,21,1,0)
This field contains the number of notification records that were past
"^DD",790.71,790.71,.15,21,2,0)
due when the Program Snaphot report was run. 
"^DD",790.71,790.71,.15,"DT")
2950123
"^DD",790.71,790.71,.16,0)
Number of Letters Queued^NJ6,0^^0;16^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.16,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.16,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.16,21,1,0)
This field contains the number of letters scheduled to be queued at a
"^DD",790.71,790.71,.16,21,2,0)
future time.  This count is calculated from the type of notification and
"^DD",790.71,790.71,.16,21,3,0)
the print date fields in the WV Notification (790.4) file.
"^DD",790.71,790.71,.16,"DT")
2950123
"^DD",790.71,790.71,.17,0)
Total CBEs for the Year^NJ6,0^^0;17^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.17,3)
Type a number between 0 and 999999, 0 decimal digits.
"^DD",790.71,790.71,.17,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.17,21,1,0)
This field contains a count of the clinical breast exams (CBE) done since
"^DD",790.71,790.71,.17,21,2,0)
the beginning of the calendar or fiscal year, depending upon what the user
"^DD",790.71,790.71,.17,21,3,0)
selected.
"^DD",790.71,790.71,.17,"DT")
2980713
"^DD",790.71,790.71,.18,0)
TYPE OF YEAR^S^F:Fiscal Year;C:Calendar Year;^0;18^Q
"^DD",790.71,790.71,.18,1,0)
^.1
"^DD",790.71,790.71,.18,1,1,0)
790.71^T
"^DD",790.71,790.71,.18,1,1,1)
S ^WV(790.71,"T",$E(X,1,30),DA)=""
"^DD",790.71,790.71,.18,1,1,2)
K ^WV(790.71,"T",$E(X,1,30),DA)
"^DD",790.71,790.71,.18,1,1,"DT")
2980611
"^DD",790.71,790.71,.18,21,0)
^^2^2^2980709^
"^DD",790.71,790.71,.18,21,1,0)
This field contains a code to identify if the report output is for a
"^DD",790.71,790.71,.18,21,2,0)
calendar year (1/1-12/31) or a fiscal year (10/1/-9/30).
"^DD",790.71,790.71,.18,"DT")
2980709
"^DD",790.71,790.71,.5,0)
Breast Ultrasounds^NJ7,0^^2;1^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.5,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.5,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.5,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.5,21,2,0)
a patient declined having a breast ultrasound within the timeframe
"^DD",790.71,790.71,.5,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.5,"DT")
2980624
"^DD",790.71,790.71,.51,0)
Clinical Breast Exams^NJ7,0^^2;2^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.51,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.51,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.51,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.51,21,2,0)
a patient declined having a clinical breast exam within the timeframe
"^DD",790.71,790.71,.51,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.51,"DT")
2980624
"^DD",790.71,790.71,.52,0)
Colposcopy Impression (NO BX)^NJ7,0^^2;3^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.52,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.52,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.52,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.52,21,2,0)
a patient declined having the procedure, colposcopy impression without
"^DD",790.71,790.71,.52,21,3,0)
biopsy, within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.52,"DT")
2980624
"^DD",790.71,790.71,.53,0)
Colposcopy W/Biopsy^NJ7,0^^2;4^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.53,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.53,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.53,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.53,21,2,0)
a patient declined having the procedure, colposcopy with biopsy, within
"^DD",790.71,790.71,.53,21,3,0)
the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.53,"DT")
2980624
"^DD",790.71,790.71,.54,0)
Cone Biopsy^NJ7,0^^2;5^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.54,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.54,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.54,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.54,21,2,0)
a patient declined having the procedure, cone biopsy, within the timeframe
"^DD",790.71,790.71,.54,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.54,"DT")
2980624
"^DD",790.71,790.71,.55,0)
Cryotherapy^NJ7,0^^2;6^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.55,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.55,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.55,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.55,21,2,0)
a patient declined having the procedure, cryotherapy, within the timeframe
"^DD",790.71,790.71,.55,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.55,"DT")
2980624
"^DD",790.71,790.71,.56,0)
Ectocervical Biopsy^NJ8,0^^2;7^K:+X'=X!(X>10000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.56,3)
Type a number between 0 and 10000000, 0 decimal digits.
"^DD",790.71,790.71,.56,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.56,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.56,21,2,0)
a patient declined having the procedure, ectocervical biospy, within the
"^DD",790.71,790.71,.56,21,3,0)
timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.56,"DT")
2980624
"^DD",790.71,790.71,.57,0)
Endocervical Currettage^NJ7,0^^2;8^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.57,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.57,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.57,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.57,21,2,0)
a patient declined having the procedure, endocervical currettage, within
"^DD",790.71,790.71,.57,21,3,0)
the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.57,"DT")
2980624
"^DD",790.71,790.71,.58,0)
Endometrial Biopsy^NJ7,0^^2;9^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.58,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.58,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.58,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.58,21,2,0)
a patient declined having the procedure, endometrial biopsy, within the
"^DD",790.71,790.71,.58,21,3,0)
timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.58,"DT")
2980624
"^DD",790.71,790.71,.59,0)
Fine Needle Aspiration^NJ7,0^^2;10^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.59,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.59,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.59,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.59,21,2,0)
a patient declined having the procedure, fine needle aspiration, within
"^DD",790.71,790.71,.59,21,3,0)
the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.59,"DT")
2980624
"^DD",790.71,790.71,.6,0)
General Surgery Consult^NJ7,0^^2;11^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.6,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.6,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.6,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.6,21,2,0)
a patient declined a general surgery consult referral within the timeframe
"^DD",790.71,790.71,.6,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.6,"DT")
2980624
"^DD",790.71,790.71,.61,0)
Gyn Onc Consult^NJ7,0^^2;12^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.61,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.61,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.61,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.61,21,2,0)
a patient declined a gynecological oncology consult referral, within the
"^DD",790.71,790.71,.61,21,3,0)
timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.61,"DT")
2980624
"^DD",790.71,790.71,.62,0)
Hysterectomy^NJ7,0^^2;13^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.62,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.62,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.62,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.62,21,2,0)
a patient declined having a hysterectomy within the timeframe associated
"^DD",790.71,790.71,.62,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.62,"DT")
2980624
"^DD",790.71,790.71,.63,0)
Laser Abilation^NJ7,0^^2;14^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.63,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.63,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.63,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.63,21,2,0)
a patient declined having a laser abilation procedure within the timeframe
"^DD",790.71,790.71,.63,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.63,"DT")
2980624
"^DD",790.71,790.71,.64,0)
Laser Cone^NJ7,0^^2;15^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.64,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.64,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.64,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.64,21,2,0)
a patient declined having a laser cone procedure, within the timeframe
"^DD",790.71,790.71,.64,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.64,"DT")
2980624
"^DD",790.71,790.71,.65,0)
Leep^NJ7,0^^2;16^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.65,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.65,21,0)
^^3^3^2980716^
"^DD",790.71,790.71,.65,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.65,21,2,0)
a patient declined having a loop electrosurgical excision procedure (LEEP)
"^DD",790.71,790.71,.65,21,3,0)
within the timeframe of the Program Snapshot report.
"^DD",790.71,790.71,.65,"DT")
2980624
"^DD",790.71,790.71,.66,0)
Lumpectomy^NJ7,0^^2;17^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.66,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.66,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.66,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.66,21,2,0)
a patient declined having lumpectomy (of the breast) within the timeframe
"^DD",790.71,790.71,.66,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.66,"DT")
2980624
"^DD",790.71,790.71,.67,0)
Mammogram Dx Bilat^NJ7,0^^2;18^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.67,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.67,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.67,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.67,21,2,0)
a patient declined having the radiology test, mammogram Dx bilateral,
"^DD",790.71,790.71,.67,21,3,0)
within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.67,"DT")
2980624
"^DD",790.71,790.71,.68,0)
Mammogram Dx Unilat^NJ7,0^^2;19^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.68,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.68,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.68,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.68,21,2,0)
a patient declined having the radiology test, mammogram Dx unilateral,
"^DD",790.71,790.71,.68,21,3,0)
within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.68,"DT")
2980624
"^DD",790.71,790.71,.69,0)
Mammogram Screening^NJ7,0^^2;20^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.69,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.69,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.69,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.69,21,2,0)
a patient declined having the radiology procedure, mammogram screening,
"^DD",790.71,790.71,.69,21,3,0)
within the timeframe associated with the Program Snapshot report.
"^DD",790.71,790.71,.69,"DT")
2980624
"^DD",790.71,790.71,.7,0)
Masectomy^NJ7,0^^2;21^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.7,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.7,21,0)
^^3^3^2980713^
"^DD",790.71,790.71,.7,21,1,0)
This field contains the number of records (in File #790.3) indicating that
"^DD",790.71,790.71,.7,21,2,0)
a patient declined having a mastectomy within the timeframe associated
"^DD",790.71,790.71,.7,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.7,"DT")
2980624
"^DD",790.71,790.71,.71,0)
Needle Biopsy^NJ7,0^^2;22^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.71,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.71,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.71,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.71,21,2,0)
patient declined having a needle biopsy within the timeframe associated
"^DD",790.71,790.71,.71,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.71,"DT")
2980624
"^DD",790.71,790.71,.72,0)
Open Biopsy^NJ7,0^^2;23^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.72,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.72,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.72,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.72,21,2,0)
patient declined having an open biopsy within the timeframe associated
"^DD",790.71,790.71,.72,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.72,"DT")
2980624
"^DD",790.71,790.71,.73,0)
Pap Smear^NJ7,0^^2;24^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.73,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.73,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.73,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.73,21,2,0)
patient declined having a PAP smear within the timeframe associated with
"^DD",790.71,790.71,.73,21,3,0)
the Program Snapshot report.
"^DD",790.71,790.71,.73,"DT")
2980624
"^DD",790.71,790.71,.74,0)
Pregnancy Test^NJ7,0^^2;25^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.74,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.74,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.74,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.74,21,2,0)
patient declined having a pregnancy test within the timeframe associated
"^DD",790.71,790.71,.74,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.74,"DT")
2980624
"^DD",790.71,790.71,.75,0)
STD Evaluation^NJ7,0^^2;26^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.75,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.75,21,0)
^^3^3^2980921^
"^DD",790.71,790.71,.75,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.75,21,2,0)
patient declined having a STD evaluation within the timeframe associated
"^DD",790.71,790.71,.75,21,3,0)
with the Program Snapshot report.
"^DD",790.71,790.71,.75,"DT")
2980624
"^DD",790.71,790.71,.76,0)
Stereotactic Biopsy^NJ7,0^^2;27^K:+X'=X!(X>1000000)!(X<0)!(X?.E1"."1N.N) X
"^DD",790.71,790.71,.76,3)
Type a number between 0 and 1000000, 0 decimal digits.
"^DD",790.71,790.71,.76,21,0)
^^3^3^2980714^
"^DD",790.71,790.71,.76,21,1,0)
This field contains the number of records (in File #790.3) indicating a
"^DD",790.71,790.71,.76,21,2,0)
patient declined having a stereotactic biospy within the timeframe
"^DD",790.71,790.71,.76,21,3,0)
associated with the Program Snapshot report.
"^DD",790.71,790.71,.76,"DT")
2980624
"^DD",790.72,790.72,0)
FIELD^^.03^3
"^DD",790.72,790.72,0,"DDA")
N
"^DD",790.72,790.72,0,"IX","B",790.72,.01)

"^DD",790.72,790.72,0,"NM","WV AGE RANGE DEFAULT")

"^DD",790.72,790.72,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.72,790.72,.01,0)
USER^RP200'X^VA(200,^0;1^S:$D(X) DINUM=X
"^DD",790.72,790.72,.01,1,0)
^.1
"^DD",790.72,790.72,.01,1,1,0)
790.72^B
"^DD",790.72,790.72,.01,1,1,1)
S ^WV(790.72,"B",$E(X,1,30),DA)=""
"^DD",790.72,790.72,.01,1,1,2)
K ^WV(790.72,"B",$E(X,1,30),DA)
"^DD",790.72,790.72,.01,3)
Enter the user whose default is being stored.
"^DD",790.72,790.72,.01,21,0)
^^3^3^2980624^^^
"^DD",790.72,790.72,.01,21,1,0)
This is the name of the user whose (age range) defaults (for the Procedure
"^DD",790.72,790.72,.01,21,2,0)
Statistics Report and the Screening Rates for PAPs and MAMs reports) are
"^DD",790.72,790.72,.01,21,3,0)
being stored.
"^DD",790.72,790.72,.01,"DT")
2951019
"^DD",790.72,790.72,.02,0)
AGE RANGE FOR PROC STATS^F^^0;2^K:$L(X)>120!($L(X)<1) X
"^DD",790.72,790.72,.02,3)
Enter an age range (e.g., 20-29,30-39,40-60).
"^DD",790.72,790.72,.02,21,0)
^^2^2^2980921^
"^DD",790.72,790.72,.02,21,1,0)
This field contains the user's age range default value for the Procedure
"^DD",790.72,790.72,.02,21,2,0)
Statistics report.
"^DD",790.72,790.72,.02,"DT")
2960301
"^DD",790.72,790.72,.03,0)
AGE RANGE FOR SCRN RATES^F^^0;3^K:$L(X)>10!($L(X)<1) X
"^DD",790.72,790.72,.03,3)
Enter the age range that will be stored as this user's default for future reports.
"^DD",790.72,790.72,.03,21,0)
^^2^2^2980921^
"^DD",790.72,790.72,.03,21,1,0)
This field contains the user's age range default value for the Screening
"^DD",790.72,790.72,.03,21,2,0)
Rates for PAPs and MAMs reports.
"^DD",790.72,790.72,.03,"DT")
2960301
"^DIC",790,790,0)
WV PATIENT^790
"^DIC",790,790,0,"GL")
^WV(790,
"^DIC",790,790,"%D",0)
^^15^15^2980828^
"^DIC",790,790,"%D",1,0)
This file contains the names of patient's tracked by the Women's Health
"^DIC",790,790,"%D",2,0)
application.  Patient names may be either manually entered by a case
"^DIC",790,790,"%D",3,0)
manager or loaded through the Automatically Load Patients [WV AUTOLOAD
"^DIC",790,790,"%D",4,0)
PATIENTS] option.
"^DIC",790,790,"%D",5,0)
 
"^DIC",790,790,"%D",6,0)
Other data stored in this file can be categorized as demographic,
"^DIC",790,790,"%D",7,0)
administrative, and clinical information.  The clinical data reflects
"^DIC",790,790,"%D",8,0)
current breast and cervical treatment needs, pregnancy information, breast
"^DIC",790,790,"%D",9,0)
and cervical treatment regimes, family history of breast cancer and DES,
"^DIC",790,790,"%D",10,0)
name of facility responsible for breast and treatment needs, and personal
"^DIC",790,790,"%D",11,0)
history of sexual trauma. Information specific to the results of breast
"^DIC",790,790,"%D",12,0)
and cervical exams and procedures are stored in the WV Procedure (#790.1)
"^DIC",790,790,"%D",13,0)
file.  Administrative data is limited to the name of the current case
"^DIC",790,790,"%D",14,0)
manager, the date of first encounter, and the date the patient record was
"^DIC",790,790,"%D",15,0)
inactivated.
"^DIC",790,"B","WV PATIENT",790)

"^DIC",790.01,790.01,0)
WV CASE MANAGER^790.01
"^DIC",790.01,790.01,0,"GL")
^WV(790.01,
"^DIC",790.01,790.01,"%D",0)
^^4^4^2980828^
"^DIC",790.01,790.01,"%D",1,0)
This file contains the names of Women's Health case managers located at
"^DIC",790.01,790.01,"%D",2,0)
the medical center. Case managers are assigned to each female patient
"^DIC",790.01,790.01,"%D",3,0)
entered into the package and the information is used in displays and
"^DIC",790.01,790.01,"%D",4,0)
reports.
"^DIC",790.01,"B","WV CASE MANAGER",790.01)

"^DIC",790.02,790.02,0)
WV SITE PARAMETER^790.02
"^DIC",790.02,790.02,0,"GL")
^WV(790.02,
"^DIC",790.02,790.02,"%D",0)
^^8^8^2980915^
"^DIC",790.02,790.02,"%D",1,0)
This file stores the facility configurable software parameters that are
"^DIC",790.02,790.02,"%D",2,0)
used by the Women's Health package.  Parameters may be specific to a
"^DIC",790.02,790.02,"%D",3,0)
single facility or multiple divisions within a single facility.  The data
"^DIC",790.02,790.02,"%D",4,0)
in this file addresses the name of the default case manager, autoqueueing
"^DIC",790.02,790.02,"%D",5,0)
of result letters for normal PAPs and mammograms, linkages with the
"^DIC",790.02,790.02,"%D",6,0)
Radiology/Nuclear Medicine package, switches permitting the selection of
"^DIC",790.02,790.02,"%D",7,0)
specific procedures, and default dates for marking procedures as
"^DIC",790.02,790.02,"%D",8,0)
delinquent.
"^DIC",790.02,"B","WV SITE PARAMETER",790.02)

"^DIC",790.03,790.03,0)
WV PAP REGIMEN^790.03
"^DIC",790.03,790.03,0,"GL")
^WV(790.03,
"^DIC",790.03,790.03,"%D",0)
^^3^3^2980630^
"^DIC",790.03,790.03,"%D",1,0)
This file contains a list of PAP regimens and their selection numbers.
"^DIC",790.03,790.03,"%D",2,0)
There is no option to edit this file; new entries may be added through
"^DIC",790.03,790.03,"%D",3,0)
FileMan.
"^DIC",790.03,"B","WV PAP REGIMEN",790.03)

"^DIC",790.04,790.04,0)
WV PAP REGIMEN LOG^790.04
"^DIC",790.04,790.04,0,"GL")
^WV(790.04,
"^DIC",790.04,790.04,"%D",0)
^^2^2^2980720^^
"^DIC",790.04,790.04,"%D",1,0)
This file tracks the PAP regimens, when they begin, who the patient is,
"^DIC",790.04,790.04,"%D",2,0)
and who entered the most recent information on the regimen.
"^DIC",790.04,"B","WV PAP REGIMEN LOG",790.04)

"^DIC",790.05,790.05,0)
WV PREGNANCY LOG^790.05
"^DIC",790.05,790.05,0,"GL")
^WV(790.05,
"^DIC",790.05,790.05,"%D",0)
^^2^2^2980714^
"^DIC",790.05,790.05,"%D",1,0)
This file tracks the pregnancy status of patients and their estimated date
"^DIC",790.05,790.05,"%D",2,0)
of confinement (EDC) or delievery date.
"^DIC",790.05,"B","WV PREGNANCY LOG",790.05)

"^DIC",790.07,790.07,0)
WV REFERRAL SOURCE^790.07
"^DIC",790.07,790.07,0,"GL")
^WV(790.07,
"^DIC",790.07,790.07,"%D",0)
^^8^8^2980828^
"^DIC",790.07,790.07,"%D",1,0)
This file contains sources of referral for patients to the Women's Health
"^DIC",790.07,790.07,"%D",2,0)
Program.  For example, entries may be references to clinics or hospital
"^DIC",790.07,790.07,"%D",3,0)
services (e.g., General Medicine Clinic, Triage), community activities or
"^DIC",790.07,790.07,"%D",4,0)
special events (e.g., health fairs), specific individuals, and newspapers
"^DIC",790.07,790.07,"%D",5,0)
advertisements or articles.  Additional information may be added to this
"^DIC",790.07,790.07,"%D",6,0)
file by the case manager through the Add/Edit to Referral Source File
"^DIC",790.07,790.07,"%D",7,0)
option.  This file is also referenced through the Edit/Print Patient Case
"^DIC",790.07,790.07,"%D",8,0)
Data to document a specific referral source for a patient.
"^DIC",790.07,"B","WV REFERRAL SOURCE",790.07)

"^DIC",790.1,790.1,0)
WV PROCEDURE^790.1
"^DIC",790.1,790.1,0,"GL")
^WV(790.1,
"^DIC",790.1,790.1,"%D",0)
^^2^2^2980519^
"^DIC",790.1,790.1,"%D",1,0)
This file contains the Women Veterans Health's database of procedures 
"^DIC",790.1,790.1,"%D",2,0)
actually performed and the data associated with them.
"^DIC",790.1,"B","WV PROCEDURE",790.1)

"^DIC",790.2,790.2,0)
WV PROCEDURE TYPE^790.2
"^DIC",790.2,790.2,0,"GL")
^WV(790.2,
"^DIC",790.2,790.2,"%D",0)
^^5^5^2980706^^
"^DIC",790.2,790.2,"%D",1,0)
This file stores and defines the type of procedures that may be
"^DIC",790.2,790.2,"%D",2,0)
associated with patients within this application.  The procedure type
"^DIC",790.2,790.2,"%D",3,0)
definitions includes the name, abbreviation, synonyms, last accession #,
"^DIC",790.2,790.2,"%D",4,0)
CPT and ICD codes, and colposcopy related information.  There is no option
"^DIC",790.2,790.2,"%D",5,0)
to edit this file although new entries may be added through FileMan. 
"^DIC",790.2,"B","WV PROCEDURE TYPE",790.2)

"^DIC",790.3,790.3,0)
WV REFUSALS^790.3
"^DIC",790.3,790.3,0,"GL")
^WV(790.3,
"^DIC",790.3,790.3,"%D",0)
^^2^2^2980828^
"^DIC",790.3,790.3,"%D",1,0)
This file identifies instances where patients in the Women's Health
"^DIC",790.3,790.3,"%D",2,0)
database were offered, but refused care (e.g., screening mammogram).
"^DIC",790.3,"B","WV REFUSALS",790.3)

"^DIC",790.31,790.31,0)
WV RESULTS/DIAGNOSIS^790.31
"^DIC",790.31,790.31,0,"GL")
^WV(790.31,
"^DIC",790.31,790.31,"%D",0)
^^7^7^2980918^^
"^DIC",790.31,790.31,"%D",1,0)
This file stores a list of official results/diagnosis based on the
"^DIC",790.31,790.31,"%D",2,0)
Bethesda Classification system for PAP smears and the American College of
"^DIC",790.31,790.31,"%D",3,0)
Radiology (ACR) for mammograms.  Every result or diagnosis is associated
"^DIC",790.31,790.31,"%D",4,0)
with procedure types appropriate for that term.  File data is used to
"^DIC",790.31,790.31,"%D",5,0)
document appropriate results for procedures performed on women patients
"^DIC",790.31,790.31,"%D",6,0)
through the Add a New Procedure and Edit a Procedure options.  This file
"^DIC",790.31,790.31,"%D",7,0)
is exported with data and should not be locally edited.
"^DIC",790.31,"B","WV RESULTS/DIAGNOSIS",790.31)

"^DIC",790.32,790.32,0)
WV DIAGNOSTIC CODE TRANSLATION^790.32
"^DIC",790.32,790.32,0,"GL")
^WV(790.32,
"^DIC",790.32,790.32,"%",0)
^1.005
"^DIC",790.32,790.32,"%D",0)
^^3^3^2980625^^^
"^DIC",790.32,790.32,"%D",1,0)
This file allows for entries in the WV Results/Diagnosis (#790.31) file
"^DIC",790.32,790.32,"%D",2,0)
(related to radiology procedures only) to be matched to corresponding
"^DIC",790.32,790.32,"%D",3,0)
entries in the Radiology Diagnostic Codes (#78.3) file.
"^DIC",790.32,"B","WV DIAGNOSTIC CODE TRANSLATION",790.32)

"^DIC",790.4,790.4,0)
WV NOTIFICATION^790.4
"^DIC",790.4,790.4,0,"GL")
^WV(790.4,
"^DIC",790.4,790.4,"%D",0)
^^4^4^2980820^
"^DIC",790.4,790.4,"%D",1,0)
This file stores information surrounding the date/time, purpose, and
"^DIC",790.4,790.4,"%D",2,0)
circumstances (scheduling of procedures, results of tests, etc.) for each
"^DIC",790.4,790.4,"%D",3,0)
patient notification.  These records are used to view the Browse
"^DIC",790.4,790.4,"%D",4,0)
Notifications and Program Snapshot reports.
"^DIC",790.4,"B","WV NOTIFICATION",790.4)

"^DIC",790.403,790.403,0)
WV NOTIFICATION TYPE^790.403
"^DIC",790.403,790.403,0,"GL")
^WV(790.403,
"^DIC",790.403,790.403,"%D",0)
^^12^12^2980716^
"^DIC",790.403,790.403,"%D",1,0)
This file stores the notification types which decribe how test or
"^DIC",790.403,790.403,"%D",2,0)
procedure results and treatment needs are communicated to the patient. The
"^DIC",790.403,790.403,"%D",3,0)
notification type may be a letter, personal contact, an organization's
"^DIC",790.403,790.403,"%D",4,0)
name, or other term that describes the communication process.  Entries in
"^DIC",790.403,790.403,"%D",5,0)
this file may be tagged to identify the number of attempts associated with
"^DIC",790.403,790.403,"%D",6,0)
the type of contact, e.g., first letter, second letter (certified), 3rd
"^DIC",790.403,790.403,"%D",7,0)
phone call.
"^DIC",790.403,790.403,"%D",8,0)
 
"^DIC",790.403,790.403,"%D",9,0)
New Notification Types can be entered into this file through VA FileMan.
"^DIC",790.403,790.403,"%D",10,0)
Synonyms can be entered by the case manager(s) through the Edit Synonyms
"^DIC",790.403,790.403,"%D",11,0)
for Notification Types option.  This information is stored in a patient's
"^DIC",790.403,790.403,"%D",12,0)
record through the Add a New Notification or Edit a Notification option.
"^DIC",790.403,"B","WV NOTIFICATION TYPE",790.403)

"^DIC",790.404,790.404,0)
WV NOTIFICATION PURPOSE^790.404
"^DIC",790.404,790.404,0,"GL")
^WV(790.404,
"^DIC",790.404,790.404,"%D",0)
^^14^14^2980716^
"^DIC",790.404,790.404,"%D",1,0)
This file contains reasons for the notification i.e., the notification
"^DIC",790.404,790.404,"%D",2,0)
is in response to (a) the results of a test or procedure or (b) the
"^DIC",790.404,790.404,"%D",3,0)
scheduling of future treatment needs.  The other fields in this file are
"^DIC",790.404,790.404,"%D",4,0)
used to (1) assign a priority (urgent, as soon as possible, routine), (2)
"^DIC",790.404,790.404,"%D",5,0)
associate a synonym or abbreviation, (3) flag an entry as active or
"^DIC",790.404,790.404,"%D",6,0)
inactive, (4) store the text of the letter, (5) calculate default print
"^DIC",790.404,790.404,"%D",7,0)
dates for letters to patients on breast and cervical treatment needs, and
"^DIC",790.404,790.404,"%D",8,0)
(6) indicate whether a letter should be printed today or in the future.
"^DIC",790.404,790.404,"%D",9,0)
 
"^DIC",790.404,790.404,"%D",10,0)
Letters may be created and edited by the case manager through the Add/Edit
"^DIC",790.404,790.404,"%D",11,0)
a Notification Purpose & Letter option.  All information in this file, can
"^DIC",790.404,790.404,"%D",12,0)
be printed through the Print Notification Purpose & Letter File option.
"^DIC",790.404,790.404,"%D",13,0)
Notification information can be entered into a patient's record through
"^DIC",790.404,790.404,"%D",14,0)
the Add a New Notification and Edit a Notification options.
"^DIC",790.404,"B","WV NOTIFICATION PURPOSE",790.404)

"^DIC",790.405,790.405,0)
WV NOTIFICATION OUTCOME^790.405
"^DIC",790.405,790.405,0,"GL")
^WV(790.405,
"^DIC",790.405,790.405,"%D",0)
^^6^6^2980720^
"^DIC",790.405,790.405,"%D",1,0)
This file stores outcomes that can be associated with a patient
"^DIC",790.405,790.405,"%D",2,0)
notification.  These entries may be goal oriented (e.g., scheduled appt
"^DIC",790.405,790.405,"%D",3,0)
for PAP, MAM normal letter sent), or an event (e.g., patient decease, Tx
"^DIC",790.405,790.405,"%D",4,0)
elsewhere, unable to contact patient).  Notification outcomes are
"^DIC",790.405,790.405,"%D",5,0)
documented through the Add a New Notification and Edit a Notification
"^DIC",790.405,790.405,"%D",6,0)
options.
"^DIC",790.405,"B","WV NOTIFICATION OUTCOME",790.405)

"^DIC",790.5,790.5,0)
WV CERVICAL TX NEED^790.5
"^DIC",790.5,790.5,0,"GL")
^WV(790.5,
"^DIC",790.5,790.5,"%D",0)
^^5^5^2980630^
"^DIC",790.5,790.5,"%D",1,0)
This file contains a list of terms/phrases used to describe the cervial
"^DIC",790.5,790.5,"%D",2,0)
treatment needs of women patients.  Entries may be tests, therapeutic
"^DIC",790.5,790.5,"%D",3,0)
procedures, or other actions (e.g., referral to another
"^DIC",790.5,790.5,"%D",4,0)
facility, chart review).  There is no option to edit this file; new
"^DIC",790.5,790.5,"%D",5,0)
entries may be added through FileMan.
"^DIC",790.5,"B","WV CERVICAL TX NEED",790.5)

"^DIC",790.51,790.51,0)
WV BREAST TX NEED^790.51
"^DIC",790.51,790.51,0,"GL")
^WV(790.51,
"^DIC",790.51,790.51,"%D",0)
^^5^5^2980630^
"^DIC",790.51,790.51,"%D",1,0)
This file contains a list of terms/phrases used to describe breast
"^DIC",790.51,790.51,"%D",2,0)
treatment needs for women patients.  Entries may be tests,
"^DIC",790.51,790.51,"%D",3,0)
therapeutic procedures, or other actions (e.g., referral to another
"^DIC",790.51,790.51,"%D",4,0)
facility, chart review) related to breast care.  There is no option to
"^DIC",790.51,790.51,"%D",5,0)
edit this file; new entries may be added through FileMan.
"^DIC",790.51,"B","WV BREAST TX NEED",790.51)

"^DIC",790.6,790.6,0)
WV LETTER^790.6
"^DIC",790.6,790.6,0,"GL")
^WV(790.6,
"^DIC",790.6,790.6,"%D",0)
^^5^5^2980722^
"^DIC",790.6,790.6,"%D",1,0)
This file holds a copy of the original generic notification letter which
"^DIC",790.6,790.6,"%D",2,0)
can be used to restore the sample letter in the Notification Purpose file
"^DIC",790.6,790.6,"%D",3,0)
(#790.404) if it is accidentally deleted. The actual restoration or
"^DIC",790.6,790.6,"%D",4,0)
placement of a copy of this letter in File 790.404 is performed by the
"^DIC",790.6,790.6,"%D",5,0)
case manager through the Add/Edit a Notification Purpose & Letter option.
"^DIC",790.6,"B","WV LETTER",790.6)

"^DIC",790.71,790.71,0)
WV SNAPSHOT REPORTS^790.71
"^DIC",790.71,790.71,0,"GL")
^WV(790.71,
"^DIC",790.71,790.71,"%D",0)
^^8^8^2980713^
"^DIC",790.71,790.71,"%D",1,0)
This file contains information aggregated from data stored in the WV
"^DIC",790.71,790.71,"%D",2,0)
Procedure (790.1), WV Notification (790.4), and WV Refusals (790.3) files.
"^DIC",790.71,790.71,"%D",3,0)
Data storage is dependent upon running the Snapshot of the Program Today
"^DIC",790.71,790.71,"%D",4,0)
option and answering YES to the question, "Should today's Snapshot be
"^DIC",790.71,790.71,"%D",5,0)
stored for later retrieval and comparisons?" These records provide a
"^DIC",790.71,790.71,"%D",6,0)
historical perspective of the Woman Veterans Health Program at your
"^DIC",790.71,790.71,"%D",7,0)
facility and may be printed through the Retrieve/Print Earlier Snapshot
"^DIC",790.71,790.71,"%D",8,0)
option.
"^DIC",790.71,"B","WV SNAPSHOT REPORTS",790.71)

"^DIC",790.72,790.72,0)
WV AGE RANGE DEFAULT^790.72
"^DIC",790.72,790.72,0,"GL")
^WV(790.72,
"^DIC",790.72,790.72,"%D",0)
^^4^4^2980624^
"^DIC",790.72,790.72,"%D",1,0)
This file stores an age range that is used to print a Procedure Statistics
"^DIC",790.72,790.72,"%D",2,0)
Report and a Screening Rates for PAPs and MAMs report.  The age range
"^DIC",790.72,790.72,"%D",3,0)
string is entered through the age range sort prompt within each report
"^DIC",790.72,790.72,"%D",4,0)
option and is displayed as the default when printing additional reports.
"^DIC",790.72,"B","WV AGE RANGE DEFAULT",790.72)

**END**
**END**
