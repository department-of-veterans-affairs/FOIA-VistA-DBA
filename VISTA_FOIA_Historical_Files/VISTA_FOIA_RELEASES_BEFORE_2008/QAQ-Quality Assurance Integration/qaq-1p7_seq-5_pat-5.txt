$TXT Created by CURTIN,EDNA at MNTVBB.ISC-ALBANY.VA.GOV  (KIDS) on TUESDAY, 09/29/98 at 14:32
=============================================================================
Run Date: NOV 12, 1998                     Designation: QAQ*1.7*5
Package : QAQ - QUALITY ASSURANCE Priority: Mandatory
Version : 1.7         SEQ #5                   Status: Released
=============================================================================

Associated patches: (v)QAQ*1.7*2   <<= must be installed BEFORE `QAQ*1.7*5'

Subject: UPDATING AD HOC MACROS

Category: 
  - Routine

Description: 
============

 This patch gives the user the ability to update sort and print macros from
 the Ad Hoc Reports options in the QA packages.  If the Ad Hoc Report menu
 has changed since the macro was created the system will display the
 existing macro so that the user can decide whether to edit the macro,
 enter a new macro or have the system update the macro.
  
 The routine that determines if the macro is not current is in the
 Integration Module package.  It is used by the QA packages such as the
 Patient Representative package, the Incident Reporting package,
 Occurrence Screening package or the Clinical Monitoring package.
  
  
  
 This patch addresses the following NOIS message:
  
 DUB-0796-32024
 Users report that Ad Hoc Report macros from the Patient Representative
 package that were created before the installation of V2.0 can no longer be
 loaded when using the Ad Hoc Report option [QAC ADHOC].
  
  
 If installed during the normal work day it is recommended that
 the following menu options (File #19) and all of their descendants be
 disabled to prevent possible conflicts while running the KIDS Install.
 Other VistA users will not be affected.
  
        [QAC ADHOC] Ad Hoc Report
        [QAM RPT ADHOC] Ad Hoc Fall Out Report
        [QAN ADHOC REPORT] Ad Hoc Report
        [QAOS RPT AD HOC] Ad Hoc Reports
        [QARAPHOC] ADHOC Report for Applicant File
        [QARNPHOC] ADHOC Report for New Person File
  
  
  
 Install Time - less than 10 minutes
  
  
          ================INSTALLATION INSTRUCTIONS =================
   
   1.   LOAD TRANSPORT GLOBAL 
        ---------------------
        Choose the PackMan message containing this patch and invoke the 
        INSTALL/CHECK MESSAGE PackMan option.  
              
   2.   DISABLE ROUTINE MAPPING 
        -----------------------
        Disable routine mapping on all systems for the routines listed in 
        step 3 below.  
        NOTE:  If the routines included in this patch are not currently in 
        your mapped routine set, please skip this step.
   
   3.   ROUTINES SENT WITH PATCH 
        ------------------------
        The following is a list of the routines included in this patch.  
        The second line of each of these routines now looks like: 
   
            ;;1.7;QM Integration Module;**[patch list]**; 07/25/1995
   
                       CHECK^XTSUMBLD results
  
    Routine          Before Patch     After Patch   Patch List 
    -------          ------------     -----------   ----------
    QAQAHOC3           11996485         18396841      1,2,5
    QAQAHOC4            6864385          7056005      2,5
    QAQAHOC5              N/A            2700413      5
  
                  Total number of routines - 3
   
   4.   START UP KIDS 
        -------------
        Start up the Kernel Installation and Distribution System Menu 
        [XPD MAIN]: 
    
             Edits and Distribution ...  
             Utilities ...  
             Installation ...  
    
   Select Kernel Installation & Distribution System Option: INStallation 
                                                            ---
             Load a Distribution 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Install Package(s) 
             Restart Install of Package(s) 
             Unload a Distribution 
             Backup a Transport Global 
    
   Select Installation Option: 
    
   5.   Select Installation Option: 
        --------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter QAQ*1.7*5):
       
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
      
   6.   Select Installation Option: Install Package(s) (When prompted for
                                    ----------------
     the INSTALL NAME, enter QAQ*1.7*5):
        **This is the step to start the installation of this KIDS patch: 
    
        a.  Choose the Install Package(s) option to start the patch
            install.
        b.  When prompted 'Want to DISABLE Scheduled Options, Menu 
            Options, and Protocols? YES//' answer YES.
        c.  When prompted 'Enter options you wish to mark as 'Out Of
            Order':'  Enter the following options:
   
                [QAC ADHOC] Ad Hoc Report
                [QAM RPT ADHOC] Ad Hoc Fall Out Report
                [QAN ADHOC REPORT] Ad Hoc Report
                [QAOS RPT AD HOC] Ad Hoc Reports
                [QARAPHOC] ADHOC Report for Applicant File
                [QARNPHOC] ADHOC Report for New Person File
  
        d.  When prompted 'Enter protocols you wish to mark as 'Out Of
            Order': press <return>.
  
   7. ENABLE MENU OPTIONS
      -------------------
     Optional - If you disabled any menu options (file #19) prior to
     installing this patch, please remember to enable them at this time.
  
   8. ENABLE ROUTINE MAPPING
      ----------------------
     If any routines were unmapped as a part of step 2, they should be
     returned to the mapped set once the installation has run to
     completion.

Routine Information:
====================

Routine Name:
  - QAQAHOC3

 Routine altered to compare the checksum of the current ad hoc menu with
 the checksum of the macro.  If they do not agree it means that the menu
 has been changed since the macro was created.  User will be shown the
 macro, asked if it is still what is needed, if so the checksum on the
 macro will be updated and the field information will be also checked. If
 the macro is no longer valid the user will be advised to start a new
 macro.

Routine Checksum:

Routine Name:
  - QAQAHOC4

 Check to see if line number has an identifier(s) in the macro - the
 check is in PS1 and PP1 - if so strip it off, as it is confusing in the
 display.

Routine Checksum:

Routine Name:
  - QAQAHOC5

 New routine created to hold continuation of the update process from
 QAQAHOC3.

Routine Checksum:

=============================================================================
User Information:                               
Entered By  : CURTIN,EDNA                    Date Entered : JUN 01, 1998
Completed By: PETERSON,JAMES R             Date Completed: SEP 29, 1998
Released By : LEWIS-LITNER,ANN E           Date Released : NOV 12, 1998
=============================================================================


Packman Mail Message:
=====================

$END TXT
