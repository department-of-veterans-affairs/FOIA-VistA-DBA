Released PSS*1*108 SEQ #105
Extracted from mail message
**KIDS**:PSS*1.0*108^

**INSTALL NAME**
PSS*1.0*108
"BLD",6046,0)
PSS*1.0*108^PHARMACY DATA MANAGEMENT^0^3060804^y
"BLD",6046,1,0)
^9.61A^30^30^3060629^^^^
"BLD",6046,1,1,0)
This patch contains updated Application Program Interfaces (APIs) that will 
"BLD",6046,1,2,0)
be used by calling applications that currently do direct global reads or 
"BLD",6046,1,3,0)
writes to the Pharmacy Data Management files.
"BLD",6046,1,4,0)
 
"BLD",6046,1,5,0)
The ORDERABLE ITEM STATUS TRACKER (#81) field has been added as a returned
"BLD",6046,1,6,0)
data element for the PSS^PSS59P7 API on the Pharmacy System file (#59.7).
"BLD",6046,1,7,0)
 
"BLD",6046,1,8,0)
The ORIGINAL WARD (#9), OTHER PRINT INFO (#31) & MED ROUTE (#132) fields 
"BLD",6046,1,9,0)
were added to the PSS436 component of the PSS55 API on the Pharmacy 
"BLD",6046,1,10,0)
Patient file (#55).  
"BLD",6046,1,11,0)
 
"BLD",6046,1,12,0)
The DIC^PSSDI API has been modified to allow drug selection with matches
"BLD",6046,1,13,0)
to certain VA Classes that are passed to the call.
"BLD",6046,1,14,0)
 
"BLD",6046,1,15,0)
Classes to be included or excluded are to be set up in the PSSVACL array
"BLD",6046,1,16,0)
within the DIC component.
"BLD",6046,1,17,0)
 
"BLD",6046,1,18,0)
For example, if only drugs with a VA Class of DX201 & DX202 were to be
"BLD",6046,1,19,0)
available for selection, the local variable array would look like this:
"BLD",6046,1,20,0)
 
"BLD",6046,1,21,0)
PSSVACL("DX201")=""
"BLD",6046,1,22,0)
PSSVACL("DX202")=""
"BLD",6046,1,23,0)
PSSVACL("R")="" - The "R" means only drugs with these classes will be
"BLD",6046,1,24,0)
                  available for selection. If these classes were to be
"BLD",6046,1,25,0)
                  excluded, the letter "P" would be used instead.
"BLD",6046,1,26,0)
 
"BLD",6046,1,27,0)
 
"BLD",6046,1,28,0)
A new API was added to routine PSS51P1. The PSSDQ component displays all 
"BLD",6046,1,29,0)
the entries in the Administrative Schedules file (#51.1). 
"BLD",6046,1,30,0)
 
"BLD",6046,6.3)
10
"BLD",6046,"KRN",0)
^9.67PA^^
"BLD",6046,"KRN",.4,0)
.4
"BLD",6046,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",6046,"KRN",.401,0)
.401
"BLD",6046,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",6046,"KRN",.402,0)
.402
"BLD",6046,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",6046,"KRN",.403,0)
.403
"BLD",6046,"KRN",.5,0)
.5
"BLD",6046,"KRN",.84,0)
.84
"BLD",6046,"KRN",3.6,0)
3.6
"BLD",6046,"KRN",3.8,0)
3.8
"BLD",6046,"KRN",9.2,0)
9.2
"BLD",6046,"KRN",9.8,0)
9.8
"BLD",6046,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",6046,"KRN",9.8,"NM",1,0)
PSS59P7^^0^B3153955
"BLD",6046,"KRN",9.8,"NM",2,0)
PSS55^^0^B41074993
"BLD",6046,"KRN",9.8,"NM",3,0)
PSSDI^^0^B33977209
"BLD",6046,"KRN",9.8,"NM",4,0)
PSS551^^0^B14966377
"BLD",6046,"KRN",9.8,"NM",5,0)
PSS51P1^^0^B16972270
"BLD",6046,"KRN",9.8,"NM","B","PSS51P1",5)

"BLD",6046,"KRN",9.8,"NM","B","PSS55",2)

"BLD",6046,"KRN",9.8,"NM","B","PSS551",4)

"BLD",6046,"KRN",9.8,"NM","B","PSS59P7",1)

"BLD",6046,"KRN",9.8,"NM","B","PSSDI",3)

"BLD",6046,"KRN",19,0)
19
"BLD",6046,"KRN",19.1,0)
19.1
"BLD",6046,"KRN",101,0)
101
"BLD",6046,"KRN",409.61,0)
409.61
"BLD",6046,"KRN",771,0)
771
"BLD",6046,"KRN",869.2,0)
869.2
"BLD",6046,"KRN",870,0)
870
"BLD",6046,"KRN",8994,0)
8994
"BLD",6046,"KRN","B",.4,.4)

"BLD",6046,"KRN","B",.401,.401)

"BLD",6046,"KRN","B",.402,.402)

"BLD",6046,"KRN","B",.403,.403)

"BLD",6046,"KRN","B",.5,.5)

"BLD",6046,"KRN","B",.84,.84)

"BLD",6046,"KRN","B",3.6,3.6)

"BLD",6046,"KRN","B",3.8,3.8)

"BLD",6046,"KRN","B",9.2,9.2)

"BLD",6046,"KRN","B",9.8,9.8)

"BLD",6046,"KRN","B",19,19)

"BLD",6046,"KRN","B",19.1,19.1)

"BLD",6046,"KRN","B",101,101)

"BLD",6046,"KRN","B",409.61,409.61)

"BLD",6046,"KRN","B",771,771)

"BLD",6046,"KRN","B",869.2,869.2)

"BLD",6046,"KRN","B",870,870)

"BLD",6046,"KRN","B",8994,8994)

"BLD",6046,"QUES",0)
^9.62^^
"BLD",6046,"REQB",0)
^9.611^2^2
"BLD",6046,"REQB",1,0)
PSS*1.0*101^1
"BLD",6046,"REQB",2,0)
PSS*1.0*104^1
"BLD",6046,"REQB","B","PSS*1.0*101",1)

"BLD",6046,"REQB","B","PSS*1.0*104",2)

"BLD",6046,"REQG",0)
^9.611^^
"MBREQ")
0
"PKG",517,-1)
1^1
"PKG",517,0)
PHARMACY DATA MANAGEMENT^PSS^Maintenance of Pharmacy files.
"PKG",517,20,0)
^9.402P^^
"PKG",517,22,0)
^9.49I^1^1
"PKG",517,22,1,0)
1.0^2970930^2971014^11595
"PKG",517,22,1,"PAH",1,0)
108^3060804
"PKG",517,22,1,"PAH",1,1,0)
^^30^30^3060804
"PKG",517,22,1,"PAH",1,1,1,0)
This patch contains updated Application Program Interfaces (APIs) that will 
"PKG",517,22,1,"PAH",1,1,2,0)
be used by calling applications that currently do direct global reads or 
"PKG",517,22,1,"PAH",1,1,3,0)
writes to the Pharmacy Data Management files.
"PKG",517,22,1,"PAH",1,1,4,0)
 
"PKG",517,22,1,"PAH",1,1,5,0)
The ORDERABLE ITEM STATUS TRACKER (#81) field has been added as a returned
"PKG",517,22,1,"PAH",1,1,6,0)
data element for the PSS^PSS59P7 API on the Pharmacy System file (#59.7).
"PKG",517,22,1,"PAH",1,1,7,0)
 
"PKG",517,22,1,"PAH",1,1,8,0)
The ORIGINAL WARD (#9), OTHER PRINT INFO (#31) & MED ROUTE (#132) fields 
"PKG",517,22,1,"PAH",1,1,9,0)
were added to the PSS436 component of the PSS55 API on the Pharmacy 
"PKG",517,22,1,"PAH",1,1,10,0)
Patient file (#55).  
"PKG",517,22,1,"PAH",1,1,11,0)
 
"PKG",517,22,1,"PAH",1,1,12,0)
The DIC^PSSDI API has been modified to allow drug selection with matches
"PKG",517,22,1,"PAH",1,1,13,0)
to certain VA Classes that are passed to the call.
"PKG",517,22,1,"PAH",1,1,14,0)
 
"PKG",517,22,1,"PAH",1,1,15,0)
Classes to be included or excluded are to be set up in the PSSVACL array
"PKG",517,22,1,"PAH",1,1,16,0)
within the DIC component.
"PKG",517,22,1,"PAH",1,1,17,0)
 
"PKG",517,22,1,"PAH",1,1,18,0)
For example, if only drugs with a VA Class of DX201 & DX202 were to be
"PKG",517,22,1,"PAH",1,1,19,0)
available for selection, the local variable array would look like this:
"PKG",517,22,1,"PAH",1,1,20,0)
 
"PKG",517,22,1,"PAH",1,1,21,0)
PSSVACL("DX201")=""
"PKG",517,22,1,"PAH",1,1,22,0)
PSSVACL("DX202")=""
"PKG",517,22,1,"PAH",1,1,23,0)
PSSVACL("R")="" - The "R" means only drugs with these classes will be
"PKG",517,22,1,"PAH",1,1,24,0)
                  available for selection. If these classes were to be
"PKG",517,22,1,"PAH",1,1,25,0)
                  excluded, the letter "P" would be used instead.
"PKG",517,22,1,"PAH",1,1,26,0)
 
"PKG",517,22,1,"PAH",1,1,27,0)
 
"PKG",517,22,1,"PAH",1,1,28,0)
A new API was added to routine PSS51P1. The PSSDQ component displays all 
"PKG",517,22,1,"PAH",1,1,29,0)
the entries in the Administrative Schedules file (#51.1). 
"PKG",517,22,1,"PAH",1,1,30,0)
 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","PSS51P1")
0^5^B16972270^B16199904
"RTN","PSS51P1",1,0)
PSS51P1 ;BIR/LDT - API FOR INFORMATION FROM FILE 51.1 ;5 Sep 03
"RTN","PSS51P1",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91,108**;9/30/97;Build 10
"RTN","PSS51P1",3,0)
 ;
"RTN","PSS51P1",4,0)
ZERO(PSSIEN,PSSFT,PSSPP,PSSTSCH,LIST) ;
"RTN","PSS51P1",5,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",6,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",7,0)
 ;PSSPP - PACKAGE PREFIX field (#4) in ADMINISTRATION SCHEDULE file (#51.1). Screens for Administration
"RTN","PSS51P1",8,0)
 ;Schedules for the Package Prefix passed.
"RTN","PSS51P1",9,0)
 ;PSSTSCH - TYPE OF SCHEDULE field (#5) of ADMINISTRATION SCHEDULE file (#51.1). Screens for
"RTN","PSS51P1",10,0)
 ;          One-time "O" if PSSTSCH passed in.
"RTN","PSS51P1",11,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",12,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",13,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), FREQUENCY (IN MINUTES) field (#2),
"RTN","PSS51P1",14,0)
 ;MAXIMUM DAYS FOR ORDERS field (#2.5), PACKAGE PREFIX field (#4), TYPE OF SCHEDULE field (#5),
"RTN","PSS51P1",15,0)
 ;STANDARD SHIFTS field (#6), OUTPATIENT EXPANSION field (#8), and OTHER LANGUAGE EXPANSIONS field (#8.1)
"RTN","PSS51P1",16,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",17,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS
"RTN","PSS51P1",18,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",19,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",20,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",21,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",22,0)
 I $G(PSSTSCH)]"",PSSTSCH'="O" S PSSTSCH=""
"RTN","PSS51P1",23,0)
 S SCR("S")="" I $G(PSSTSCH)]""!$G(PSSPP)]"" D SETSCR
"RTN","PSS51P1",24,0)
 I +$G(PSSIEN)>0 N PSSIEN2 S PSSIEN2=$$FIND1^DIC(51.1,"","A","`"_PSSIEN,"B",SCR("S"),"") D
"RTN","PSS51P1",25,0)
 .I +PSSIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",26,0)
 .S ^TMP($J,LIST,0)=1
"RTN","PSS51P1",27,0)
 .D GETS^DIQ(51.1,+PSSIEN2,".01;1;2;4;5;6;2.5;8;8.1","IE","PSS51P1") S PSS(1)=0
"RTN","PSS51P1",28,0)
 .F  S PSS(1)=$O(PSS51P1(51.1,PSS(1))) Q:'PSS(1)  D SETZRO^PSS51P1B
"RTN","PSS51P1",29,0)
 I +$G(PSSIEN)'>0,$G(PSSFT)]"" D
"RTN","PSS51P1",30,0)
 .I PSSFT["??" D LOOP^PSS51P1B(1) Q
"RTN","PSS51P1",31,0)
 .D FIND^DIC(51.1,,"@;.01;1","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS51P1",32,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",33,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1",34,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K PSS51P1 D GETS^DIQ(51.1,+PSSIEN,".01;1;2;4;5;6;2.5;8;8.1","IE","PSS51P1") S PSS(1)=0
"RTN","PSS51P1",35,0)
 ..F  S PSS(1)=$O(PSS51P1(51.1,PSS(1))) Q:'PSS(1)  D SETZRO^PSS51P1B
"RTN","PSS51P1",36,0)
 K ^TMP("DILIST",$J)
"RTN","PSS51P1",37,0)
 Q
"RTN","PSS51P1",38,0)
 ;
"RTN","PSS51P1",39,0)
WARD(PSSIEN,PSSFT,PSSIEN2,LIST) ;
"RTN","PSS51P1",40,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",41,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",42,0)
 ;PSSIEN2 - IEN of entry in WARD sub-file (#51.11)
"RTN","PSS51P1",43,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",44,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",45,0)
 ;Returns NAME field (#.01), WARD multiple (#51.11) WARD field (#.01), and WARD ADMINISTRATION TIMES field (#1)
"RTN","PSS51P1",46,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",47,0)
 N DIERR,ZZERR,PSS51P1,PSS,CNT
"RTN","PSS51P1",48,0)
 S CNT=0
"RTN","PSS51P1",49,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",50,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",51,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",52,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",53,0)
 I $G(PSSIEN2)]"",+$G(PSSIEN2)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",54,0)
 D WARD^PSS51P1C
"RTN","PSS51P1",55,0)
 Q
"RTN","PSS51P1",56,0)
 ;
"RTN","PSS51P1",57,0)
HOSP(PSSIEN,PSSFT,LIST) ;
"RTN","PSS51P1",58,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",59,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",60,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",61,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",62,0)
 ;Returns NAME field (#.01), HOSPITAL LOCATION multiple (#51.17) HOSPITAL LOCATION field (#.01), ADMINISTRATION TIMES field (#1),
"RTN","PSS51P1",63,0)
 ;and SHIFTS field (#2) of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",64,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS,CNT
"RTN","PSS51P1",65,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",66,0)
 D HOSP^PSS51P1A
"RTN","PSS51P1",67,0)
 Q
"RTN","PSS51P1",68,0)
 ;
"RTN","PSS51P1",69,0)
IEN(PSSFT,LIST) ;
"RTN","PSS51P1",70,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",71,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",72,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",73,0)
 ;Returns NAME field (#.01) and STANDARD ADMINISTRATION TIMES field (#1) of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",74,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS
"RTN","PSS51P1",75,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",76,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",77,0)
 I $G(PSSFT)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",78,0)
 D IEN^PSS51P1A
"RTN","PSS51P1",79,0)
 Q
"RTN","PSS51P1",80,0)
 ;
"RTN","PSS51P1",81,0)
AP(PSSPP,PSSFT,PSSWDIEN,PSSTYP,LIST) ;
"RTN","PSS51P1",82,0)
 ;PSSPP - PACKAGE PREFIX in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",83,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",84,0)
 ;PSSWDIEN - IEN of entry of WARD multiple in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",85,0)
 ;PSSSTYP - TYPE OF SCHEDULE field (#5) in ADMINISTRATION SCHEDULE file (#51.1). 
"RTN","PSS51P1",86,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",87,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",88,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), and PACKAGE PREFIX field (#4)
"RTN","PSS51P1",89,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",90,0)
 ;If PSSWDIEN is passed in then the WARD multiple (#51.11) WARD field (#.01), and WARD ADMINISTRATION TIMES field (#1)
"RTN","PSS51P1",91,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1) is returned.
"RTN","PSS51P1",92,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS,PSSIEN
"RTN","PSS51P1",93,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",94,0)
 D AP^PSS51P1A
"RTN","PSS51P1",95,0)
 Q
"RTN","PSS51P1",96,0)
 ;
"RTN","PSS51P1",97,0)
IX(PSSFT,PSSPP,LIST) ;
"RTN","PSS51P1",98,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",99,0)
 ;PSSPP - PACKAGE PREFIX in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",100,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",101,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",102,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), FREQUENCY (IN MINUTES) field (#2),
"RTN","PSS51P1",103,0)
 ;MAXIMUM DAYS FOR ORDERS field (#2.5),PACKAGE PREFIX field (#4), TYPE OF SCHEDULE field (#5), STANDARD
"RTN","PSS51P1",104,0)
 ;SHIFTS field (#6), OUTPATIENT EXPANSION field (#8), and OTHER LANGUAGE EXPANSION field (#8.1) of
"RTN","PSS51P1",105,0)
 ;ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",106,0)
 N DIERR,ZZERR,PSS51P1,PSS
"RTN","PSS51P1",107,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",108,0)
 D IX^PSS51P1A
"RTN","PSS51P1",109,0)
 Q
"RTN","PSS51P1",110,0)
 ;
"RTN","PSS51P1",111,0)
ADM(PSSADM) ; admin times
"RTN","PSS51P1",112,0)
 N X S X=PSSADM
"RTN","PSS51P1",113,0)
 I $S($L($P(X,"-"))>4:1,$L(X)>119:1,$L(X)<2:1,X'>0:1,1:X'?.ANP) K X Q "^"
"RTN","PSS51P1",114,0)
 S X(1)=$P(X,"-") I X(1)'?2N,X(1)'?4N K X Q "^"
"RTN","PSS51P1",115,0)
 S X(1)=$L(X(1)) F X(2)=2:1:$L(X,"-") S X(3)=$P(X,"-",X(2)) I $S($L(X(3))'=X(1):1,X(3)>$S(X(1)=2:24,1:2400):1,1:X(3)'>$P(X,"-",X(2)-1)) K X Q
"RTN","PSS51P1",116,0)
 I '$D(X) Q "^"
"RTN","PSS51P1",117,0)
 K:$D(X) X(1),X(2),X(3) Q PSSADM
"RTN","PSS51P1",118,0)
 ;
"RTN","PSS51P1",119,0)
ALL(PSSIEN,PSSFT,LIST) ;
"RTN","PSS51P1",120,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",121,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",122,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",123,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",124,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), FREQUENCY (IN MINUTES) field (#2),
"RTN","PSS51P1",125,0)
 ;MAXIMUM DAYS FOR ORDERS field (#2.5), PACKAGE PREFIX field (#4), TYPE OF SCHEDULE field (#5),
"RTN","PSS51P1",126,0)
 ;STANDARD SHIFTS field (#6), OUTPATIENT EXPANSION field (#8), OTHER LANGUAGE EXPANSIONS field (#8.1),
"RTN","PSS51P1",127,0)
 ; HOSPITAL LOCATION multiple (#51.17) HOSPITAL LOCATION field (#.01), ADMINISTRATION TIMES field (#1),
"RTN","PSS51P1",128,0)
 ;SHIFTS field (#2), WARD multiple (#51.11) WARD field (#.01), and WARD ADMINISTRATION TIMES field (#1)
"RTN","PSS51P1",129,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",130,0)
 N DIERR,ZZERR,PSS
"RTN","PSS51P1",131,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",132,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",133,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",134,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",135,0)
 D ALL^PSS51P1C
"RTN","PSS51P1",136,0)
 Q
"RTN","PSS51P1",137,0)
 ;
"RTN","PSS51P1",138,0)
SETSCR ;Set Screen for One-time schedule type
"RTN","PSS51P1",139,0)
 ;Naked reference below refers to ^PS(51.1,+Y,0)
"RTN","PSS51P1",140,0)
 I $G(PSSTSCH)]"" S SCR("S")="I $P(^(0),""^"",5)=""O"""
"RTN","PSS51P1",141,0)
 ;Naked reference below refers to ^PS(51.1,+Y,0)
"RTN","PSS51P1",142,0)
 I $G(PSSPP)]"" S SCR("S")=$S(SCR("S")]"":SCR("S")_" I $P(^(0),""^"",4)=PSSPP",1:"I $P(^(0),""^"",4)=PSSPP")
"RTN","PSS51P1",143,0)
 Q
"RTN","PSS51P1",144,0)
PSSDQ ;DQ^DICQ call on 51.1
"RTN","PSS51P1",145,0)
 N DIC,D,DZ S DIC="^PS(51.1,",D="B",DIC(0)="EQS",DZ="??" D DQ^DICQ Q
"RTN","PSS55")
0^2^B41074993^B67992607
"RTN","PSS55",1,0)
PSS55 ;BHM/DB - API FOR PHARMACY PATIENT FILE ;15 JUN 05
"RTN","PSS55",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**101,108**;9/30/97;Build 10
"RTN","PSS55",3,0)
PSS431(DFN,PO,PSDATE,PEDATE,LIST) ;
"RTN","PSS55",4,0)
 G ^PSS551
"RTN","PSS55",5,0)
PSS432(DFN,PO,LIST) ;SRS 3.2.43.2
"RTN","PSS55",6,0)
 N D0,DA,DR,DIC,IEN
"RTN","PSS55",7,0)
 ;DFN: IEN of Patient [REQUIRED]
"RTN","PSS55",8,0)
 ;PO: Order # IEN [optional] If left blank, all active orders will be returned
"RTN","PSS55",9,0)
 ;LIST: Subscript name used in ^TMP global [REQUIRED]
"RTN","PSS55",10,0)
 N PSSPO,PSSDT,PSSIEN,PSSDATA
"RTN","PSS55",11,0)
 Q:$G(LIST)=""  K ^TMP($J,LIST)
"RTN","PSS55",12,0)
 I +$G(DFN)'>0 G NODATA
"RTN","PSS55",13,0)
 S ^TMP($J,LIST,0)=0
"RTN","PSS55",14,0)
 I '$D(^PS(55,DFN,0)) G NODATA
"RTN","PSS55",15,0)
 I $G(PO)'="",$D(^PS(55,DFN,5,PO)) S PSSPO=$P(^PS(55,DFN,5,PO,0),"^") I $G(PSSPO)>0 S (DA(55.06),IEN)=PO G AUS2
"RTN","PSS55",16,0)
 I $G(PO)'="",$G(PSSPO)="" G NODATA
"RTN","PSS55",17,0)
 S PSSDT=0
"RTN","PSS55",18,0)
AUS ;Loop through stop date/time xref
"RTN","PSS55",19,0)
 F  S PSSDT=$O(^PS(55,DFN,5,"AUS",PSSDT)) Q:PSSDT'>0  S PSSIEN=0 D
"RTN","PSS55",20,0)
 .F  S PSSIEN=$O(^PS(55,DFN,5,"AUS",PSSDT,PSSIEN)) Q:PSSIEN'>0  D
"RTN","PSS55",21,0)
 ..S (IEN,DA(55.06))=PSSIEN,PSSDATA=$G(^PS(55,DFN,5,PSSIEN,0)) I $P(PSSDATA,"^",9)'="A" Q
"RTN","PSS55",22,0)
 ..D AUSDIQ
"RTN","PSS55",23,0)
 S ^TMP($J,LIST,0)=$S(^TMP($J,LIST,0)=0:"-1^NO DATA FOUND",1:^TMP($J,LIST,0))
"RTN","PSS55",24,0)
 K PSSIEN,PSSDT,PSSDATA,LIST
"RTN","PSS55",25,0)
 Q
"RTN","PSS55",26,0)
AUSDIQ K ^UTILITY("DIQ1",$J),DIQ
"RTN","PSS55",27,0)
 S DA=DFN,DIC=55,DR=62,DR(55.06)=".01;.5;1;3;4;5;6;7;9;11;12;26;27;27.1;28",DIQ(0)="IE" D EN^DIQ1
"RTN","PSS55",28,0)
 S PSSPO=$G(^UTILITY("DIQ1",$J,55.06,IEN,.01,"E")) F X=.01,.5,1,3,4,5,6,7,9,11,12,26,27,27.1,28 S ^TMP($J,LIST,IEN,X)=$G(^UTILITY("DIQ1",$J,55.06,IEN,X,"I"))
"RTN","PSS55",29,0)
 F X=.5,1,3,4,5,6,7,9,27,27.1,28 S ^TMP($J,LIST,IEN,X)=$S($G(^UTILITY("DIQ1",$J,55.06,IEN,X,"E"))'="":^TMP($J,LIST,IEN,X)_"^"_$G(^UTILITY("DIQ1",$J,55.06,IEN,X,"E")),1:"")
"RTN","PSS55",30,0)
 K ^UTILITY("DIQ1",$J),DIQ
"RTN","PSS55",31,0)
 S ^TMP($J,LIST,"B",IEN)="",^TMP($J,LIST,0)=$G(^TMP($J,LIST,0))+1
"RTN","PSS55",32,0)
 Q
"RTN","PSS55",33,0)
AUS2 ;one PO
"RTN","PSS55",34,0)
 S PSSQ=1 D AUSDIQ
"RTN","PSS55",35,0)
 S ^TMP($J,LIST,0)=$S(^TMP($J,LIST,0)=0:"-1^NO DATA FOUND",1:^TMP($J,LIST,0))
"RTN","PSS55",36,0)
AUSQ K PSSDT,PSSIEN,PSSDATA,PSSPO,LIST,X,PSSQ,DA,DR,DIC Q
"RTN","PSS55",37,0)
 ;
"RTN","PSS55",38,0)
PSS433(DFN,LIST) ;
"RTN","PSS55",39,0)
 ;DFN: IEN of Patient [REQUIRED]
"RTN","PSS55",40,0)
 ;LIST: Subscript name used in ^TMP global [REQUIRED]
"RTN","PSS55",41,0)
 N X,DA,DR,PSSPO,PSSIEN,D0,IEN
"RTN","PSS55",42,0)
 Q:$G(LIST)=""  K ^TMP($J,LIST)
"RTN","PSS55",43,0)
 I $G(DFN)'>0 S ^TMP($J,LIST,0)="-1^NO DATA FOUND" Q
"RTN","PSS55",44,0)
 I '$D(^PS(55,DFN)) G NODATA
"RTN","PSS55",45,0)
 S PSSIEN=0,^TMP($J,LIST,0)=0
"RTN","PSS55",46,0)
BGN433 S PSSIEN=$O(^PS(55,DFN,5,PSSIEN)) G Q433:PSSIEN'>0 S PSSPO=$P($G(^PS(55,DFN,5,PSSIEN,0)),"^")
"RTN","PSS55",47,0)
 S (IEN,DA(55.06))=PSSIEN,DIC=55,DA=DFN,DR=62,DR(55.06)=".5;9;25;26;34;41;42;70",DIQ(0)="IE" D EN^DIQ1
"RTN","PSS55",48,0)
 F X=.5,9,25,26,34,41,42,70 S ^TMP($J,LIST,+PSSIEN,X)=$G(^UTILITY("DIQ1",$J,55.06,IEN,X,"I"))
"RTN","PSS55",49,0)
 F X=.5,9,25,34,70 S ^TMP($J,LIST,+PSSIEN,X)=$S($G(^UTILITY("DIQ1",$J,55.06,IEN,X,"E"))'="":^TMP($J,LIST,+PSSIEN,X)_"^"_$G(^UTILITY("DIQ1",$J,55.06,IEN,X,"E")),1:"")
"RTN","PSS55",50,0)
 S ^TMP($J,LIST,0)=$G(^TMP($J,LIST,0))+1
"RTN","PSS55",51,0)
 S ^TMP($J,LIST,"B",+PSSIEN)=""
"RTN","PSS55",52,0)
 G BGN433
"RTN","PSS55",53,0)
Q433 K ^UTILITY("DIQ1",$J),PSSIEN,X,DR,DIC,DA,LIST Q
"RTN","PSS55",54,0)
PSS435(DFN,PO,LIST) ;SRS 3.2.43.5
"RTN","PSS55",55,0)
 N D0,DA,DIC,DR,IEN,X,PSSPO,PSSDATA,PSSIEN,PSSDT
"RTN","PSS55",56,0)
 ;DFN:  IEN of Patient [REQUIRED]
"RTN","PSS55",57,0)
 ;PO: Order # [optional] If left blank, all active orders will be returned. 
"RTN","PSS55",58,0)
 ;LIST: Subscript name used in ^TMP global [REQUIRED]
"RTN","PSS55",59,0)
 ;Active hyperal orders utilizing "AIT" cross reference
"RTN","PSS55",60,0)
 Q:$G(LIST)=""  K ^TMP($J,LIST)
"RTN","PSS55",61,0)
 I $G(DFN)'>0  S ^TMP($J,LIST,0)="-1^NO DATA FOUND" Q
"RTN","PSS55",62,0)
 I '$D(^PS(55,DFN,"IV","AIT","H")) S ^TMP($J,LIST,0)="-1^NO DATA FOUND" Q
"RTN","PSS55",63,0)
 S PSSDT=0,^TMP($J,LIST,0)=0
"RTN","PSS55",64,0)
AIT ;loop trough AIT xref
"RTN","PSS55",65,0)
 S PSSDT=$O(^PS(55,DFN,"IV","AIT","H",PSSDT)) G AITQ:PSSDT'>0 S PSSIEN=0
"RTN","PSS55",66,0)
AIT1 S PSSIEN=$O(^PS(55,DFN,"IV","AIT","H",PSSDT,PSSIEN)) G AIT:PSSIEN'>0
"RTN","PSS55",67,0)
 S PSSDATA=$G(^PS(55,DFN,"IV",PSSIEN,0)),PSSSTAT=$P($G(PSSDATA),"^",17) I PSSSTAT'="A",$G(PO)'>0 G AIT1
"RTN","PSS55",68,0)
 I +$G(PO)>0 G AIT1:PSSIEN'=PO
"RTN","PSS55",69,0)
 S PSSPO=$P(PSSDATA,"^",1),^TMP($J,LIST,"B",+PSSIEN)=""
"RTN","PSS55",70,0)
AITDIQ K ^UTILITY("DIQ1",$J) S DA=DFN,(IEN,DA(55.01))=PSSIEN,DIC=55,DR=100,DIQ(0)="IE",DR(55.01)=".01;.02;.03;.04;.06;.08;.09;.12;.17;.24;9;31;100;104;106;108;110;112;120;121;132" D EN^DIQ1
"RTN","PSS55",71,0)
 F X=.01,.02,.03,.04,.06,.08,.09,.12,.17,.24,9,31,100,104,106,108,110,112,120,121,132 S ^TMP($J,LIST,PSSPO,X)=$G(^UTILITY("DIQ1",$J,55.01,IEN,X,"I"))
"RTN","PSS55",72,0)
 F X=.02,.03,.04,.06,9,100,106,108,112,120,121,132 S ^TMP($J,LIST,PSSPO,X)=$S($G(^UTILITY("DIQ1",$J,55.01,IEN,X,"E"))'="":^TMP($J,LIST,PSSPO,X)_"^"_$G(^UTILITY("DIQ1",$J,55.01,IEN,X,"E")),1:"")
"RTN","PSS55",73,0)
 K ^UTILITY("DIQ1",$J)
"RTN","PSS55",74,0)
 S ^TMP($J,LIST,0)=$G(^TMP($J,LIST,0))+1
"RTN","PSS55",75,0)
 G AIT1
"RTN","PSS55",76,0)
AITQ I $G(^TMP($J,LIST,0))=0 K ^TMP($J,LIST) S ^TMP($J,LIST,0)="-1^NO DATA FOUND"
"RTN","PSS55",77,0)
 K PSSIEN,PSSDT,PSSSTAT,PSSDATA,PO,X,LIST Q
"RTN","PSS55",78,0)
 ;
"RTN","PSS55",79,0)
PSS436(DFN,ORDER,LIST) ;SRS 3.2.43.6
"RTN","PSS55",80,0)
 N D0,IEN,X
"RTN","PSS55",81,0)
 ;DFN: IEN of Patient [REQUIRED]
"RTN","PSS55",82,0)
 ;ORDER:  ORDER NUMBER [REQUIRED]
"RTN","PSS55",83,0)
 ;LIST: Subscript name used in ^TMP global [REQUIRED]
"RTN","PSS55",84,0)
 ;Active IV AD nodes
"RTN","PSS55",85,0)
 K PSSLOOP Q:$G(LIST)=""  K ^TMP($J,LIST) I $G(DFN)'>0  S ^TMP($J,LIST,0)="-1^NO DATA FOUND" Q
"RTN","PSS55",86,0)
 I '$D(^PS(55,DFN)) S ^TMP($J,LIST,0)="-1^NO DATA FOUND" Q
"RTN","PSS55",87,0)
 K ^TMP($J,LIST) I $G(ORDER)="" S PSSLOOP=1 S ORDER=0 G LOOP436
"RTN","PSS55",88,0)
 I $G(ORDER)'="" S PSSPO=$O(^PS(55,DFN,"IV","B",ORDER,0)) G PSS436Q:$G(PSSPO)'>0 G DIQ436
"RTN","PSS55",89,0)
LOOP436 S ORDER=$O(^PS(55,DFN,"IV","B",ORDER)) G PSS436Q:ORDER'>0  S PSSPO=$O(^PS(55,DFN,"IV","B",ORDER,0))
"RTN","PSS55",90,0)
DIQ436 K DA,DR S DA=DFN,(IEN,DA(55.01))=PSSPO,DIC=55,DR=100
"RTN","PSS55",91,0)
 S DR(55.01)=".01;.02;.03;.04;.06;.08;.09;.12;.17;.24;9;31;100;104;106;108;110;112;120;121;132;147"
"RTN","PSS55",92,0)
 S DIQ(0)="IE" D EN^DIQ1 I '$D(^UTILITY("DIQ1",$J)) G NODATA
"RTN","PSS55",93,0)
 F X=.01,.02,.03,.04,.06,.08,.09,.12,.17,.24,9,31,100,104,106,108,110,112,120,121,132,147 S ^TMP($J,LIST,PSSPO,X)=$G(^UTILITY("DIQ1",$J,55.01,IEN,X,"I"))
"RTN","PSS55",94,0)
 F X=.02,.03,.04,.06,9,100,106,108,112,120,121,132,147 S ^TMP($J,LIST,PSSPO,X)=$S($G(^UTILITY("DIQ1",$J,55.01,IEN,X,"E"))'="":^TMP($J,LIST,PSSPO,X)_"^"_$G(^UTILITY("DIQ1",$J,55.01,IEN,X,"E")),1:"")
"RTN","PSS55",95,0)
 S ^TMP($J,LIST,"B",PSSPO)="",PSSA=0,^TMP($J,LIST,0)=$G(^TMP($J,LIST,0))+1
"RTN","PSS55",96,0)
 S ^TMP($J,LIST,PSSPO,"ADD",0)=0
"RTN","PSS55",97,0)
PSSA S PSSA=$O(^PS(55,DFN,"IV",PSSPO,"AD",PSSA)) I PSSA'>0 S PSSS=0 S ^TMP($J,LIST,PSSPO,"SOL",0)=0 G PSSS
"RTN","PSS55",98,0)
 S PSSDATA=$G(^PS(55,DFN,"IV",PSSPO,"AD",PSSA,0)),X1=$P(PSSDATA,"^"),X2=$P(PSSDATA,"^",2),X3=$P(PSSDATA,"^",3)
"RTN","PSS55",99,0)
 S ^TMP($J,LIST,PSSPO,"ADD",PSSA,.01)=X1_"^"_$P($G(^PS(52.6,X1,0)),"^")
"RTN","PSS55",100,0)
 S ^TMP($J,LIST,PSSPO,"ADD",PSSA,.02)=X2
"RTN","PSS55",101,0)
 S ^TMP($J,LIST,PSSPO,"ADD",PSSA,.03)=X3
"RTN","PSS55",102,0)
 S ^TMP($J,LIST,PSSPO,"ADD",0)=$G(^TMP($J,LIST,PSSPO,"ADD",0))+1
"RTN","PSS55",103,0)
 G PSSA
"RTN","PSS55",104,0)
PSSS I ^TMP($J,LIST,PSSPO,"ADD",0)'>0 S ^TMP($J,LIST,PSSPO,"ADD",0)="-1^NO DATA FOUND"
"RTN","PSS55",105,0)
 S PSSS=$O(^PS(55,DFN,"IV",PSSPO,"SOL",PSSS)) I PSSS'>0,$G(PSSLOOP)'=1 D  G PSS436Q
"RTN","PSS55",106,0)
 .I ^TMP($J,LIST,PSSPO,"SOL",0)=0 S ^TMP($J,LIST,PSSPO,"SOL",0)="-1^NO DATA FOUND"
"RTN","PSS55",107,0)
 I PSSS'>0 D  G LOOP436
"RTN","PSS55",108,0)
 .I ^TMP($J,LIST,PSSPO,"SOL",0)=0 S ^TMP($J,LIST,PSSPO,"SOL",0)="-1^NO DATA FOUND"
"RTN","PSS55",109,0)
 S PSSDATA=$G(^PS(55,DFN,"IV",PSSPO,"SOL",PSSS,0)),X1=$P(PSSDATA,"^"),X2=$P(PSSDATA,"^",2)
"RTN","PSS55",110,0)
 S ^TMP($J,LIST,PSSPO,"SOL",PSSS,.01)=X1_"^"_$P($G(^PS(52.7,X1,0)),"^")
"RTN","PSS55",111,0)
 S ^TMP($J,LIST,PSSPO,"SOL",PSSS,1)=X2
"RTN","PSS55",112,0)
 S ^TMP($J,LIST,PSSPO,"SOL",0)=$G(^TMP($J,LIST,PSSPO,"SOL",0))+1
"RTN","PSS55",113,0)
 G PSSS
"RTN","PSS55",114,0)
PSS436Q K ^UTILITY("DIQ1",$J),DIQ I '$D(^TMP($J,LIST,"B")) S ^TMP($J,LIST,0)="-1^NO DATA FOUND"
"RTN","PSS55",115,0)
 K PSSPO,PSSA,PSSDATA,X,LIST,X1,X2,PSSS,ORDER,PSSLOOP,DA,DR,DIC Q
"RTN","PSS55",116,0)
NODATA S ^TMP($J,LIST,0)="-1^NO DATA FOUND"
"RTN","PSS55",117,0)
Q K IEN,PSSA,PSSS,PSSSTAT,X,LIST,X1,X2,X3,PSSDIY Q
"RTN","PSS551")
0^4^B14966377^n/a
"RTN","PSS551",1,0)
PSS551 ;BHM/DB - API FOR PHARMACY PATIENT FILE ;15 JUN 05
"RTN","PSS551",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**108**;9/30/97;Build 10
"RTN","PSS551",3,0)
 ;DFN: IEN of Patient [REQUIRED]
"RTN","PSS551",4,0)
 ;PO: Order # [optional]
"RTN","PSS551",5,0)
 ;PSDATE: Start Date [optional]
"RTN","PSS551",6,0)
 ;PEDATE: End Date [optional]
"RTN","PSS551",7,0)
 ;If a start date is sent, an end date must also be sent
"RTN","PSS551",8,0)
 ;LIST: Subscript name used in ^TMP global [REQUIRED]
"RTN","PSS551",9,0)
 N PSSPO,PSSIEN,DA,DR,DIC,PSS,CNT1,X
"RTN","PSS551",10,0)
 I $G(LIST)="" Q
"RTN","PSS551",11,0)
 K ^TMP($J,LIST)
"RTN","PSS551",12,0)
 I $G(DFN)="" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS551",13,0)
 S PSSIEN=$G(DFN),PSSPO=$G(PO) S ^TMP($J,LIST,0)=0
"RTN","PSS551",14,0)
 I $G(PSSPO)>0,$G(PSSIEN)>0 S DA=PSSIEN,(IEN,DA(55.06))=PSSPO G DIQ431
"RTN","PSS551",15,0)
 I $G(PSSPO)="",$G(PSDATE)'="",$G(PEDATE)'="" S PSDATE=$S('$P(PSDATE,".",2):PSDATE_.000001,1:PSDATE),PEDATE=$S('$P($G(PEDATE),".",2):PEDATE_.999999,1:$G(PEDATE)) N PSS56 G DT431
"RTN","PSS551",16,0)
 I $G(PSSPO)="" N PSSPO1 G LOOP431
"RTN","PSS551",17,0)
 Q
"RTN","PSS551",18,0)
LOOP431 S (PSSPO1,PSSPO)=0 F  S PSSPO1=$O(^PS(55,DFN,5,"B",PSSPO1)) Q:PSSPO1'>0  F  S PSSPO=$O(^PS(55,DFN,5,"B",PSSPO1,PSSPO)) Q:PSSPO'>0  S PO=PSSPO D DIQ431
"RTN","PSS551",19,0)
 Q
"RTN","PSS551",20,0)
DIQ431 ;
"RTN","PSS551",21,0)
 I '$D(^PS(55,DFN,5,PO,0)) Q
"RTN","PSS551",22,0)
 S PSSIEN=PO_","_DFN_"," K DIQ
"RTN","PSS551",23,0)
 D GETS^DIQ(55.06,PSSIEN,".01;.5;1;2*;3;4;5;6;7;11;12;27;27.1;28","IE","^TMP(""PSS5506"",$J)")
"RTN","PSS551",24,0)
 F X=.01,.5,1,3,4,5,6,7,11,12,27,27.1,28 S ^TMP($J,LIST,+PSSPO,X)=$G(^TMP("PSS5506",$J,55.06,PSSIEN,X,"I"))
"RTN","PSS551",25,0)
 F X=.5,1,3,4,5,6,7,27,27.1,28 S ^TMP($J,LIST,+PSSPO,X)=$S($G(^TMP("PSS5506",$J,55.06,PSSIEN,X,"E"))'="":^TMP($J,LIST,+PSSPO,X)_"^"_$G(^TMP("PSS5506",$J,55.06,PSSIEN,X,"E")),1:"")
"RTN","PSS551",26,0)
 S (PSS(1),CNT1)=0 F  S PSS(1)=$O(^TMP("PSS5506",$J,55.07,PSS(1))) Q:'PSS(1)  D
"RTN","PSS551",27,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.11)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.11,"I"))
"RTN","PSS551",28,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.12)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.12,"I"))
"RTN","PSS551",29,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.01)=$S($G(^TMP("PSS5506",$J,55.07,PSS(1),.01,"E"))'="":$G(^TMP("PSS5506",$J,55.07,PSS(1),.01,"I"))_"^"_$G(^TMP("PSS5506",$J,55.07,PSS(1),.01,"E")),1:"")
"RTN","PSS551",30,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.02)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.02,"I"))
"RTN","PSS551",31,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.03)=$S($G(^TMP("PSS5506",$J,55.07,PSS(1),.03,"E"))'="":$G(^TMP("PSS5506",$J,55.07,PSS(1),.03,"I"))_"^"_$G(^TMP("PSS5506",$J,55.07,PSS(1),.03,"E")),1:"")
"RTN","PSS551",32,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.04)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.04,"I"))
"RTN","PSS551",33,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.05)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.05,"I"))
"RTN","PSS551",34,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.06)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.06,"I"))
"RTN","PSS551",35,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.07)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.07,"I"))
"RTN","PSS551",36,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.08)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.08,"I"))
"RTN","PSS551",37,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.09)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.09,"I"))
"RTN","PSS551",38,0)
 .S ^TMP($J,LIST,+PSSPO,"DDRUG",+PSS(1),.1)=$G(^TMP("PSS5506",$J,55.07,PSS(1),.1,"I"))
"RTN","PSS551",39,0)
 .S CNT1=CNT1+1
"RTN","PSS551",40,0)
 K ^TMP("PSS5506",$J),PSS(1) S ^TMP($J,LIST,"B",+PSSPO)=""
"RTN","PSS551",41,0)
 S ^TMP($J,LIST,0)=^TMP($J,LIST,0)+1
"RTN","PSS551",42,0)
 S ^TMP($J,LIST,+PSSPO,"DDRUG",0)=$S(CNT1=0:"-1^NO DATA FOUND",1:CNT1)
"RTN","PSS551",43,0)
 S ^TMP($J,LIST,0)=$S(^TMP($J,LIST,0)=0:"-1^NO DATA FOUND",1:^TMP($J,LIST,0))
"RTN","PSS551",44,0)
 Q
"RTN","PSS551",45,0)
DT431 F  S PSDATE=$O(^PS(55,DFN,5,"AUS",PSDATE)) Q:((+$G(PEDATE)>0)&(PSDATE>$G(PEDATE)))  Q:PSDATE'>0  D
"RTN","PSS551",46,0)
 .S PSS56=0 F  S PSS56=$O(^PS(55,DFN,5,"AUS",PSDATE,PSS56)) Q:PSS56'>0  S (PSSPO,PO)=PSS56 D DIQ431
"RTN","PSS551",47,0)
 S ^TMP($J,LIST,0)=$S(^TMP($J,LIST,0)=0:"-1^NO DATA FOUND",1:^TMP($J,LIST,0))
"RTN","PSS551",48,0)
 K CNT1,LIST,DA,DFN,DIC,DIQ,DR,IEN,PEDATE,PO,PSDATE,PSS,PSS56,PSSPO,PSSPO1,X Q
"RTN","PSS59P7")
0^1^B3153955^B2286501
"RTN","PSS59P7",1,0)
PSS59P7 ;BHM/DB - Pharmacy System File API ;1 JUL 05
"RTN","PSS59P7",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**101,108**;9/30/97;Build 10
"RTN","PSS59P7",3,0)
PSS(PSSIEN,PSSTXT,LIST) ;SRS 3.2.78
"RTN","PSS59P7",4,0)
 ;PSSIEN - INTERNAL ENTRY NUMBER (optional)
"RTN","PSS59P7",5,0)
 ;PSSTXT - Free Text site name (optional)
"RTN","PSS59P7",6,0)
 ;LIST: Subscript name used in ^TMP global [REQUIRED]
"RTN","PSS59P7",7,0)
 N X,DA,DR,DIC,DIQ
"RTN","PSS59P7",8,0)
 I $G(PSSIEN)="",$G(PSSTXT)="" Q
"RTN","PSS59P7",9,0)
 I $G(LIST)="" Q
"RTN","PSS59P7",10,0)
 K ^TMP($J,LIST),DA,^UTILITY("DIQ1",$J),DIQ
"RTN","PSS59P7",11,0)
 I $G(PSSIEN)]"" S DA=PSSIEN I '$D(^PS(59.7,DA,0)) G RET0
"RTN","PSS59P7",12,0)
 I $G(PSSTXT)'="",$G(PSSIEN)'>0,'$D(^PS(59.7,"B",PSSTXT)) G RET0
"RTN","PSS59P7",13,0)
 I $G(PSSTXT)'="",$G(DA)'>0 S DA=$O(^PS(59.7,"B",PSSTXT,0))
"RTN","PSS59P7",14,0)
 K ^UTILITY("DIQ1",$J),DIC S DIC=59.7,DR=".01;40.1;49.99;81",DIQ(0)="IE" D EN^DIQ1
"RTN","PSS59P7",15,0)
 I '$D(^UTILITY("DIQ1",$J)) G RET0
"RTN","PSS59P7",16,0)
 S:$G(PSSTXT)="" PSSTXT=^UTILITY("DIQ1",$J,59.7,DA,.01,"E")
"RTN","PSS59P7",17,0)
 F X=40.1,49.99,81 S ^TMP($J,LIST,DA,X)=$G(^UTILITY("DIQ1",$J,59.7,DA,X,"I"))
"RTN","PSS59P7",18,0)
 S ^TMP($J,LIST,DA,40.1)=$S($G(^UTILITY("DIQ1",$J,59.7,DA,40.1,"E"))'="":^TMP($J,LIST,DA,40.1)_"^"_$G(^UTILITY("DIQ1",$J,59.7,DA,40.1,"E")),1:"")
"RTN","PSS59P7",19,0)
 S ^TMP($J,LIST,DA,81)=$S($G(^UTILITY("DIQ1",$J,59.7,DA,81,"E"))'="":^TMP($J,LIST,DA,81)_"^"_$G(^UTILITY("DIQ1",$J,59.7,DA,81,"E")),1:"")
"RTN","PSS59P7",20,0)
 S ^TMP($J,LIST,"B",PSSTXT,DA)=""
"RTN","PSS59P7",21,0)
 K PSSIEN,DA,X,PSSTXT,DR,DIC,^UTILITY("DIQ1",$J) Q
"RTN","PSS59P7",22,0)
RET0 ;return no data
"RTN","PSS59P7",23,0)
 S ^TMP($J,LIST,0)="-1^NO DATA FOUND" Q
"RTN","PSSDI")
0^3^B33977209^B25698318
"RTN","PSSDI",1,0)
PSSDI ;BIR/LDT - API FOR FILEMAN CALLS ;5 Sep 03
"RTN","PSSDI",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91,97,104,108**;9/30/97;Build 10
"RTN","PSSDI",3,0)
 ;
"RTN","PSSDI",4,0)
DIC(PSSFILE,PSSAPP,DIC,X,DLAYGO,PSSSCRDT,PSSSCRUS,PSSVACL) ;
"RTN","PSSDI",5,0)
 S PSSDIY=""
"RTN","PSSDI",6,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",7,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",8,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",9,0)
 K DIC("S")
"RTN","PSSDI",10,0)
 I +$G(PSSSCRDT)>0 N PSSSUBSC,PSSPIECE D SCREEN
"RTN","PSSDI",11,0)
 I $D(PSSVACL),$O(PSSVACL(0))'="" D VACL I $D(PSSX1) S DIC("S")=$S($G(DIC("S"))'="":DIC("S")_" ",1:"")_PSSX1 K PSSX1
"RTN","PSSDI",12,0)
 I $G(PSSSCRUS)'="",$G(PSSFILE)=50 N PSSAPLP D
"RTN","PSSDI",13,0)
 .S DIC("S")=$S($G(DIC("S"))'="":DIC("S")_" ",1:"")_"F PSSAPLP=1:1:$L(PSSSCRUS) I $P($G(^(2)),""^"",3)[$E(PSSSCRUS,PSSAPLP) Q"
"RTN","PSSDI",14,0)
 I '$P(PSRTEST,"^",2) K DLAYGO I $G(DIC(0))'="" S DIC(0)=$TR(DIC(0),"L","") I $G(DIC(0))="" S PSSDIY=-1 G Q
"RTN","PSSDI",15,0)
 I $G(DIC(0))="",$G(X)="" S PSSDIY=-1 G Q
"RTN","PSSDI",16,0)
 K DTOUT,DUOUT D ^DIC
"RTN","PSSDI",17,0)
 G Q
"RTN","PSSDI",18,0)
DO(PSSFILE,PSSAPP,DIC) ;
"RTN","PSSDI",19,0)
 S PSSDIY=""
"RTN","PSSDI",20,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",21,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",22,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",23,0)
 K DTOUT,DUOUT D DO^DIC1
"RTN","PSSDI",24,0)
 Q
"RTN","PSSDI",25,0)
IX(PSSFILE,PSSAPP,DIC,D,X,DLAYGO) ;
"RTN","PSSDI",26,0)
 S PSSDIY=""
"RTN","PSSDI",27,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",28,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",29,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",30,0)
 I '$P(PSRTEST,"^",2) K DLAYGO I $G(DIC(0))'="" S DIC(0)=$TR(DIC(0),"L","") I $G(DIC(0))="" S PSSDIY=-1 G Q
"RTN","PSSDI",31,0)
 I $G(DIC(0))="",$G(X)="" S PSSDIY=-1 G Q
"RTN","PSSDI",32,0)
 K DTOUT,DUOUT D IX^DIC
"RTN","PSSDI",33,0)
 Q
"RTN","PSSDI",34,0)
MIX(PSSFILE,PSSAPP,DIC,D,X,DLAYGO,PSSSCRDT,PSSSCRUS,PSSVACL) ;
"RTN","PSSDI",35,0)
 S PSSDIY=""
"RTN","PSSDI",36,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",37,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",38,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",39,0)
 K DIC("S")
"RTN","PSSDI",40,0)
 I +$G(PSSSCRDT)>0 N PSSSUBSC,PSSPIECE D SCREEN
"RTN","PSSDI",41,0)
 I $D(PSSVACL),$O(PSSVACL(0))'="" D VACL I $D(PSSX1) S DIC("S")=$S($G(DIC("S"))'="":DIC("S")_" ",1:"")_PSSX1 K PSSX1
"RTN","PSSDI",42,0)
 I $G(PSSSCRUS)'="",$G(PSSFILE)=50 N PSSAPLP D
"RTN","PSSDI",43,0)
 .S DIC("S")=$S($G(DIC("S"))'="":DIC("S")_" ",1:"")_"F PSSAPLP=1:1:$L(PSSSCRUS) I $P($G(^(2)),""^"",3)[$E(PSSSCRUS,PSSAPLP) Q"
"RTN","PSSDI",44,0)
 I '$P(PSRTEST,"^",2) K DLAYGO I $G(DIC(0))'="" S DIC(0)=$TR(DIC(0),"L","") I $G(DIC(0))="" S PSSDIY=-1 G Q
"RTN","PSSDI",45,0)
 I $G(DIC(0))="",$G(X)="" S PSSDIY=-1 G Q
"RTN","PSSDI",46,0)
 K DTOUT,DUOUT D MIX^DIC1
"RTN","PSSDI",47,0)
 G Q
"RTN","PSSDI",48,0)
FILE(PSSFILE,PSSAPP,DIC,DA,X,DINUM,DLAYGO) ;
"RTN","PSSDI",49,0)
 S PSSDIY=""
"RTN","PSSDI",50,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",51,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",52,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",53,0)
 I '$P(PSRTEST,"^",2) S PSSDIY=-1 G Q
"RTN","PSSDI",54,0)
 K DTOUT,DUOUT,DO D FILE^DICN
"RTN","PSSDI",55,0)
 Q
"RTN","PSSDI",56,0)
DIE(PSSFILE,PSSAPP,DIE,DA,DR,DIDEL) ;
"RTN","PSSDI",57,0)
 S PSSDIY=""
"RTN","PSSDI",58,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",59,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",60,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",61,0)
 I '$P(PSRTEST,"^",2) S PSSDIY=-1 G Q
"RTN","PSSDI",62,0)
 K DTOUT D ^DIE
"RTN","PSSDI",63,0)
 Q
"RTN","PSSDI",64,0)
EN1(PSSFILE,PSSAPP,DIC,L,FLDS,BY,FR,TO,DHD) ;
"RTN","PSSDI",65,0)
 S PSSDIY=""
"RTN","PSSDI",66,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",67,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",68,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",69,0)
 D EN1^DIP
"RTN","PSSDI",70,0)
 Q
"RTN","PSSDI",71,0)
EN(PSSFILE,PSSAPP,DIC,DR,DA,DIQ) ;
"RTN","PSSDI",72,0)
 S PSSDIY=""
"RTN","PSSDI",73,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 G Q
"RTN","PSSDI",74,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",75,0)
 I 'PSRTEST S PSSDIY=-1 G Q
"RTN","PSSDI",76,0)
 D EN^DIQ1
"RTN","PSSDI",77,0)
 Q
"RTN","PSSDI",78,0)
FNAME(PSSFNO,PSSFILE) ;
"RTN","PSSDI",79,0)
 ;Return the label for the field of the File or Subfile passed in
"RTN","PSSDI",80,0)
 ;PSSFNO  - Field number
"RTN","PSSDI",81,0)
 ;PSSFILE - File or Subfile number
"RTN","PSSDI",82,0)
 Q $$FNAME^PSS50E($G(PSSFNO),$G(PSSFILE))
"RTN","PSSDI",83,0)
 ;
"RTN","PSSDI",84,0)
TEST(PSTFILE) ;
"RTN","PSSDI",85,0)
 N CNT,PSSAPP2,PSFFLAG,PSFLOOP,PSFTEST,PSLNODE,PSRSLT S PSRSLT="0^0",PSFFLAG=0
"RTN","PSSDI",86,0)
 F PSFLOOP=1:1 S PSFTEST=$P($T(FILE2+PSFLOOP),";;",2) Q:+$G(PSFTEST)'>0!PSFFLAG  I +PSFTEST=PSTFILE S $P(PSRSLT,"^")=1 S PSLNODE=$T(FILE2+PSFLOOP) D
"RTN","PSSDI",87,0)
 .F CNT=2:1:$L(PSLNODE,";;") S PSSAPP2=$P(PSLNODE,";;",CNT) Q:$P(PSRSLT,"^",2)=1  I PSSAPP2=$G(PSSAPP) S PSFFLAG=1,$P(PSRSLT,"^",2)=1
"RTN","PSSDI",88,0)
 Q PSRSLT
"RTN","PSSDI",89,0)
 ;
"RTN","PSSDI",90,0)
FILE2 ;For DIC call, IF PACKAGE IS LISTED, PACKAGE HAS WRITE ACCESS          
"RTN","PSSDI",91,0)
 ;;50;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",92,0)
 ;;50.1;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",93,0)
 ;;50.0214;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",94,0)
 ;;50.037;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",95,0)
 ;;50.065;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",96,0)
 ;;50.0212;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",97,0)
 ;;50.0441;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",98,0)
 ;;50.01;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",99,0)
 ;;50.02;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",100,0)
 ;;50.0903;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",101,0)
 ;;50.0904;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",102,0)
 ;;50.4;;PSJ;;PSS
"RTN","PSSDI",103,0)
 ;;50.606;;PSJ;;PSN;;PSS
"RTN","PSSDI",104,0)
 ;;50.7;;PSJ;;PSO;;PSN;;PSS
"RTN","PSSDI",105,0)
 ;;50.76;;PSJ;;PSO;;PSN;;PSS
"RTN","PSSDI",106,0)
 ;;50.72;;PSJ;;PSO;;PSN;;PSS
"RTN","PSSDI",107,0)
 ;;51;;PSJ;;PSS
"RTN","PSSDI",108,0)
 ;;51.01;;PSJ;;PSS
"RTN","PSSDI",109,0)
 ;;51.1;;PSJ;;PSS
"RTN","PSSDI",110,0)
 ;;51.11;;PSJ;;PSS
"RTN","PSSDI",111,0)
 ;;51.17;;PSJ;;PSS
"RTN","PSSDI",112,0)
 ;;51.2;;PSJ;;PSS
"RTN","PSSDI",113,0)
 ;;51.5;;PSS
"RTN","PSSDI",114,0)
 ;;52.6;;PSJ;;PSN;;PSS
"RTN","PSSDI",115,0)
 ;;52.61;;PSJ;;PSN;;PSS
"RTN","PSSDI",116,0)
 ;;52.62;;PSJ;;PSN;;PSS
"RTN","PSSDI",117,0)
 ;;52.63;;PSJ;;PSN;;PSS
"RTN","PSSDI",118,0)
 ;;52.64;;PSJ;;PSN;;PSS
"RTN","PSSDI",119,0)
 ;;52.7;;PSJ;;PSN;;PSS
"RTN","PSSDI",120,0)
 ;;52.702;;PSJ;;PSN;;PSS
"RTN","PSSDI",121,0)
 ;;52.703;;PSJ;;PSN;;PSS
"RTN","PSSDI",122,0)
 ;;52.704;;PSJ;;PSN;;PSS
"RTN","PSSDI",123,0)
 ;;54;;PSS;;PSO
"RTN","PSSDI",124,0)
 ;;54.1;;PSS;;PSO
"RTN","PSSDI",125,0)
 ;;9009032.3;;PSS
"RTN","PSSDI",126,0)
 ;;9009032.5;;PSS
"RTN","PSSDI",127,0)
 ;;
"RTN","PSSDI",128,0)
 Q
"RTN","PSSDI",129,0)
 ;
"RTN","PSSDI",130,0)
FILE3 ;For Lookup calls, check for Inactive Date Screen
"RTN","PSSDI",131,0)
 ;;50;;I;;1
"RTN","PSSDI",132,0)
 ;;50.606;;0;;2
"RTN","PSSDI",133,0)
 ;;50.7;;0;;4
"RTN","PSSDI",134,0)
 ;;51.2;;0;;5
"RTN","PSSDI",135,0)
 ;;52.6;;I;;1
"RTN","PSSDI",136,0)
 ;;52.7;;I;;1
"RTN","PSSDI",137,0)
 ;;
"RTN","PSSDI",138,0)
 Q
"RTN","PSSDI",139,0)
SCREEN ;Set screen if Inactive Date is passed in, and for File 50, addition screen if Application Packages Use is passed in
"RTN","PSSDI",140,0)
 N PSSILOOP,PSSILOC,PSSINFLG,PSSINODE S PSSINFLG=0
"RTN","PSSDI",141,0)
 F PSSILOOP=1:1 S PSSILOC=$P($T(FILE3+PSSILOOP),";;",2) Q:+$G(PSSILOC)'>0!PSSINFLG  I +PSSILOC=PSSFILE S PSSINFLG=1 S PSSINODE=$T(FILE3+PSSILOOP) D
"RTN","PSSDI",142,0)
 .S PSSSUBSC=$P(PSSINODE,";;",3),PSSPIECE=$P(PSSINODE,";;",4)
"RTN","PSSDI",143,0)
 .I PSSSUBSC'="",PSSPIECE'="" S DIC("S")="I $P($G(^(PSSSUBSC)),""^"",PSSPIECE)=""""!(+$P($G(^(PSSSUBSC)),""^"",PSSPIECE)>+$G(PSSSCRDT))"
"RTN","PSSDI",144,0)
 Q
"RTN","PSSDI",145,0)
VACL S PSSVACL1=0,PSSX=$S($D(PSSVACL("R")):"=",1:"'=") K PSSX1
"RTN","PSSDI",146,0)
 F  S PSSVACL1=$O(PSSVACL(PSSVACL1)) Q:PSSVACL1=""  I PSSVACL1'="R",PSSVACL1'="P" S PSSX1=$S($G(PSSX1)="":"I $P(^PSDRUG(+Y,0),U,2)"_PSSX_""""_PSSVACL1_"""",1:PSSX1_$S(PSSX="=":"!",1:"&")_"($P(^PSDRUG(+Y,0),U,2)"_PSSX_""""_PSSVACL1_""""_")")
"RTN","PSSDI",147,0)
 Q
"RTN","PSSDI",148,0)
Q K PSSVACL,PSSVACL1,PSSX,PSSX1,PSSFILE,PSSAPP,PSSINODE,PSSSCRUS Q
"VER")
8.0^22.0
"BLD",6046,6)
^105
**END**
**END**
