Released WV*1*14 SEQ #13
Extracted from mail message
**KIDS**:WV*1.0*14^

**INSTALL NAME**
WV*1.0*14
"BLD",2969,0)
WV*1.0*14^WOMEN'S HEALTH^0^3010412^y
"BLD",2969,1,0)
^^2^2^3010102^
"BLD",2969,1,1,0)
Please read the WV*1*14 patch description on FORUM for an explanation of
"BLD",2969,1,2,0)
what this patch does.
"BLD",2969,4,0)
^9.64PA^790^1
"BLD",2969,4,790,0)
790
"BLD",2969,4,790,2,0)
^9.641^790^1
"BLD",2969,4,790,2,790,0)
WV PATIENT  (File-top level)
"BLD",2969,4,790,2,790,1,0)
^9.6411^.28^1
"BLD",2969,4,790,2,790,1,.28,0)
CST
"BLD",2969,4,790,222)
y^n^p^^^^n
"BLD",2969,4,"APDD",790,790)

"BLD",2969,4,"APDD",790,790,.28)

"BLD",2969,4,"B",790,790)

"BLD",2969,"ABNS",0)
^9.66A^^
"BLD",2969,"ABPKG")
^n
"BLD",2969,"INI")
WV14PRE
"BLD",2969,"INIT")
WV14PST
"BLD",2969,"KRN",0)
^9.67PA^19^17
"BLD",2969,"KRN",.4,0)
.4
"BLD",2969,"KRN",.401,0)
.401
"BLD",2969,"KRN",.402,0)
.402
"BLD",2969,"KRN",.403,0)
.403
"BLD",2969,"KRN",.403,"NM",0)
^9.68A^6^6
"BLD",2969,"KRN",.403,"NM",1,0)
WV PATIENT-FORM-1    FILE #790^790^0
"BLD",2969,"KRN",.403,"NM",2,0)
WV NOTIF-FORM-1    FILE #790.4^790.4^0
"BLD",2969,"KRN",.403,"NM",3,0)
WV NOTIF-FORM-2    FILE #790.4^790.4^0
"BLD",2969,"KRN",.403,"NM",4,0)
WV PROC-FORM-1    FILE #790.1^790.1^0
"BLD",2969,"KRN",.403,"NM",5,0)
WV PROC-FORM-2-COLP    FILE #790.1^790.1^0
"BLD",2969,"KRN",.403,"NM",6,0)
WV REFUSED PROCEDURE-ENTRY    FILE #790.3^790.3^0
"BLD",2969,"KRN",.403,"NM","B","WV NOTIF-FORM-1    FILE #790.4",2)

"BLD",2969,"KRN",.403,"NM","B","WV NOTIF-FORM-2    FILE #790.4",3)

"BLD",2969,"KRN",.403,"NM","B","WV PATIENT-FORM-1    FILE #790",1)

"BLD",2969,"KRN",.403,"NM","B","WV PROC-FORM-1    FILE #790.1",4)

"BLD",2969,"KRN",.403,"NM","B","WV PROC-FORM-2-COLP    FILE #790.1",5)

"BLD",2969,"KRN",.403,"NM","B","WV REFUSED PROCEDURE-ENTRY    FILE #790.3",6)

"BLD",2969,"KRN",.5,0)
.5
"BLD",2969,"KRN",.84,0)
.84
"BLD",2969,"KRN",3.6,0)
3.6
"BLD",2969,"KRN",3.8,0)
3.8
"BLD",2969,"KRN",9.2,0)
9.2
"BLD",2969,"KRN",9.8,0)
9.8
"BLD",2969,"KRN",9.8,"NM",0)
^9.68A^16^14
"BLD",2969,"KRN",9.8,"NM",1,0)
WV14PST^^0^B23147211
"BLD",2969,"KRN",9.8,"NM",2,0)
WV14PST1^^0^B37673901
"BLD",2969,"KRN",9.8,"NM",5,0)
WVPATE^^0^B7871612
"BLD",2969,"KRN",9.8,"NM",6,0)
WVPROC1^^0^B5772282
"BLD",2969,"KRN",9.8,"NM",7,0)
WVRPST^^0^B17898839
"BLD",2969,"KRN",9.8,"NM",8,0)
WVUTL10^^0^B2064411
"BLD",2969,"KRN",9.8,"NM",9,0)
WVUTL1A^^0^B29494019
"BLD",2969,"KRN",9.8,"NM",10,0)
WVUTL7^^0^B43817823
"BLD",2969,"KRN",9.8,"NM",11,0)
WVPATP^^0^B20379343
"BLD",2969,"KRN",9.8,"NM",12,0)
WVMST^^1^
"BLD",2969,"KRN",9.8,"NM",13,0)
WVMST1^^1^
"BLD",2969,"KRN",9.8,"NM",14,0)
WVMSTL^^0^B16285914
"BLD",2969,"KRN",9.8,"NM",15,0)
WVMSTL1^^0^B7801554
"BLD",2969,"KRN",9.8,"NM",16,0)
WV14PRE^^0^B261229
"BLD",2969,"KRN",9.8,"NM","B","WV14PRE",16)

"BLD",2969,"KRN",9.8,"NM","B","WV14PST",1)

"BLD",2969,"KRN",9.8,"NM","B","WV14PST1",2)

"BLD",2969,"KRN",9.8,"NM","B","WVMST",12)

"BLD",2969,"KRN",9.8,"NM","B","WVMST1",13)

"BLD",2969,"KRN",9.8,"NM","B","WVMSTL",14)

"BLD",2969,"KRN",9.8,"NM","B","WVMSTL1",15)

"BLD",2969,"KRN",9.8,"NM","B","WVPATE",5)

"BLD",2969,"KRN",9.8,"NM","B","WVPATP",11)

"BLD",2969,"KRN",9.8,"NM","B","WVPROC1",6)

"BLD",2969,"KRN",9.8,"NM","B","WVRPST",7)

"BLD",2969,"KRN",9.8,"NM","B","WVUTL10",8)

"BLD",2969,"KRN",9.8,"NM","B","WVUTL1A",9)

"BLD",2969,"KRN",9.8,"NM","B","WVUTL7",10)

"BLD",2969,"KRN",19,0)
19
"BLD",2969,"KRN",19,"NM",0)
^9.68A^4^3
"BLD",2969,"KRN",19,"NM",2,0)
WV SEXUAL TRAUMA LIST^^0
"BLD",2969,"KRN",19,"NM",3,0)
WV SEXUAL TRAUMA SUMMARY^^0
"BLD",2969,"KRN",19,"NM",4,0)
WV ADD TO MST^^1^
"BLD",2969,"KRN",19,"NM","B","WV ADD TO MST",4)

"BLD",2969,"KRN",19,"NM","B","WV SEXUAL TRAUMA LIST",2)

"BLD",2969,"KRN",19,"NM","B","WV SEXUAL TRAUMA SUMMARY",3)

"BLD",2969,"KRN",19.1,0)
19.1
"BLD",2969,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",2969,"KRN",101,0)
101
"BLD",2969,"KRN",409.61,0)
409.61
"BLD",2969,"KRN",771,0)
771
"BLD",2969,"KRN",870,0)
870
"BLD",2969,"KRN",8994,0)
8994
"BLD",2969,"KRN","B",.4,.4)

"BLD",2969,"KRN","B",.401,.401)

"BLD",2969,"KRN","B",.402,.402)

"BLD",2969,"KRN","B",.403,.403)

"BLD",2969,"KRN","B",.5,.5)

"BLD",2969,"KRN","B",.84,.84)

"BLD",2969,"KRN","B",3.6,3.6)

"BLD",2969,"KRN","B",3.8,3.8)

"BLD",2969,"KRN","B",9.2,9.2)

"BLD",2969,"KRN","B",9.8,9.8)

"BLD",2969,"KRN","B",19,19)

"BLD",2969,"KRN","B",19.1,19.1)

"BLD",2969,"KRN","B",101,101)

"BLD",2969,"KRN","B",409.61,409.61)

"BLD",2969,"KRN","B",771,771)

"BLD",2969,"KRN","B",870,870)

"BLD",2969,"KRN","B",8994,8994)

"BLD",2969,"QUES",0)
^9.62^^
"BLD",2969,"REQB",0)
^9.611^4^4
"BLD",2969,"REQB",1,0)
WV*1.0*7^2
"BLD",2969,"REQB",2,0)
WV*1.0*10^2
"BLD",2969,"REQB",3,0)
WV*1.0*11^2
"BLD",2969,"REQB",4,0)
WV*1.0*13^2
"BLD",2969,"REQB","B","WV*1.0*10",2)

"BLD",2969,"REQB","B","WV*1.0*11",3)

"BLD",2969,"REQB","B","WV*1.0*13",4)

"BLD",2969,"REQB","B","WV*1.0*7",1)

"FIA",790)
WV PATIENT
"FIA",790,0)
^WV(790,
"FIA",790,0,0)
790IP
"FIA",790,0,1)
y^n^p^^^^n
"FIA",790,0,10)

"FIA",790,0,11)

"FIA",790,0,"RLRO")

"FIA",790,0,"VR")
1.0^WV
"FIA",790,790)
1
"FIA",790,790,.28)

"INI")
WV14PRE
"INIT")
WV14PST
"KRN",.403,69,-1)
0^4
"KRN",.403,69,0)
WV PROC-FORM-1^^^^2940620^^^790.1^0^0^1
"KRN",.403,69,11)

"KRN",.403,69,12)

"KRN",.403,69,40,0)
^.4031I^1^1
"KRN",.403,69,40,1,0)
1^^1,1^^^0
"KRN",.403,69,40,1,1)
PAGE 1
"KRN",.403,69,40,1,11)

"KRN",.403,69,40,1,12)

"KRN",.403,69,40,1,40,0)
^.4032PI^315^2
"KRN",.403,69,40,1,40,250,0)
WV PROC-EDITBLK-1^3^9,1^e
"KRN",.403,69,40,1,40,315,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,70,-1)
0^2
"KRN",.403,70,0)
WV NOTIF-FORM-1^^^^2940713^^^790.4^0^0^1
"KRN",.403,70,11)

"KRN",.403,70,12)

"KRN",.403,70,40,0)
^.4031I^1^1
"KRN",.403,70,40,1,0)
1^^1,1^^^0
"KRN",.403,70,40,1,1)
PAGE 1
"KRN",.403,70,40,1,40,0)
^.4032PI^252^2
"KRN",.403,70,40,1,40,252,0)
WV NOTIF-HEADER-1^2^1,1^d
"KRN",.403,70,40,1,40,253,0)
WV NOTIF-EDITBLK-1^1^9,1^e
"KRN",.403,71,-1)
0^1
"KRN",.403,71,0)
WV PATIENT-FORM-1^^^^2940917^^^790^0^0^1
"KRN",.403,71,40,0)
^.4031I^1^1
"KRN",.403,71,40,1,0)
1^^1,1^^^0
"KRN",.403,71,40,1,1)
PAGE 1
"KRN",.403,71,40,1,40,0)
^.4032PI^326^2
"KRN",.403,71,40,1,40,255,0)
WV PATIENT-EDITBLK-1^1^8,1^e
"KRN",.403,71,40,1,40,326,0)
WV PATIENT-HEADER-2^2^1,1^d
"KRN",.403,72,-1)
0^3
"KRN",.403,72,0)
WV NOTIF-FORM-2^^^^2941003^^^790.4^0^0^1
"KRN",.403,72,11)

"KRN",.403,72,40,0)
^.4031I^1^1
"KRN",.403,72,40,1,0)
1^WV NOTIF-HEADER-1^1,1^^^0
"KRN",.403,72,40,1,1)
PAGE 1
"KRN",.403,72,40,1,40,0)
^.4032PI^257^1
"KRN",.403,72,40,1,40,257,0)
WV NOTIF-EDITBLK-2^1^9,1^e
"KRN",.403,73,-1)
0^5
"KRN",.403,73,0)
WV PROC-FORM-2-COLP^^^^2940620^^^790.1^0^0^1
"KRN",.403,73,40,0)
^.4031I^2^2
"KRN",.403,73,40,1,0)
1^^1,1^2^2^0
"KRN",.403,73,40,1,1)
PAGE 1
"KRN",.403,73,40,1,40,0)
^.4032PI^315^2
"KRN",.403,73,40,1,40,250,0)
WV PROC-EDITBLK-1^1^9,1^e
"KRN",.403,73,40,1,40,315,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,73,40,2,0)
2^^1,1^1^1^0
"KRN",.403,73,40,2,1)
PAGE 2
"KRN",.403,73,40,2,40,0)
^.4032PI^315^2
"KRN",.403,73,40,2,40,256,0)
WV PROC-EDITBLK-2-COLP^1^9,1^e
"KRN",.403,73,40,2,40,315,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,85,-1)
0^6
"KRN",.403,85,0)
WV REFUSED PROCEDURE-ENTRY^@^@^^2980617.0721^^^790.3^0^0^1
"KRN",.403,85,40,0)
^.4031I^1^1
"KRN",.403,85,40,1,0)
1^^1,1
"KRN",.403,85,40,1,1)
Page 1
"KRN",.403,85,40,1,40,0)
^.4032IP^^0
"KRN",.403,85,40,1,40,318,0)
WV REFUSAL-DISPLAY-1^1^1,1^d
"KRN",.403,85,40,1,40,319,0)
WV REFUSAL-EDIT-1^2^10,1^e
"KRN",.404,250,0)
WV PROC-EDITBLK-1^790.1
"KRN",.404,250,11)
D:$$COLP^WVUTL4(DA) HLP^DDSUTL(" * Move to PAGE 2 to edit clinical and pathology findings. ")
"KRN",.404,250,12)

"KRN",.404,250,15,0)
^^1^1^2980605^
"KRN",.404,250,15,1,0)
WV PROCEDURE-EDIT-BLOCK-1
"KRN",.404,250,40,0)
^.4044I^18^15
"KRN",.404,250,40,1,0)
1^Date of Procedure^3
"KRN",.404,250,40,1,1)
.12
"KRN",.404,250,40,1,2)
2,25^18^2,6
"KRN",.404,250,40,1,3)
T
"KRN",.404,250,40,1,4)
1
"KRN",.404,250,40,1,13)
N WVX S WVX=$$PDELQ1^WVUTL4(DA,X,DUZ(2)) D PUT^DDSVAL(DIE,DA,.13,WVX)
"KRN",.404,250,40,3,0)
2^Clinician/Provider^3
"KRN",.404,250,40,3,1)
.07
"KRN",.404,250,40,3,2)
3,25^25^3,5
"KRN",.404,250,40,3,4)
0
"KRN",.404,250,40,4,0)
3^Ward/Clinic/Location^3
"KRN",.404,250,40,4,1)
.11
"KRN",.404,250,40,4,2)
4,25^30^4,3
"KRN",.404,250,40,4,4)
0
"KRN",.404,250,40,4,13)
D PUT^DDSVAL(790.1,.DA,.1,$$INSTIT^WVUTL6)
"KRN",.404,250,40,5,0)
4^Health Care Facility^3
"KRN",.404,250,40,5,1)
.1
"KRN",.404,250,40,5,2)
5,25^30^5,3
"KRN",.404,250,40,5,4)
1^^^
"KRN",.404,250,40,6,0)
9^Results/Diagnosis^3
"KRN",.404,250,40,6,1)
.05
"KRN",.404,250,40,6,2)
8,25^30^8,6
"KRN",.404,250,40,6,10)
S DDSBR=$S(X:12,1:13)
"KRN",.404,250,40,6,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,250,40,6,12)
K WVPN I X,$P(^WV(790.31,X,0),U,22) D PUT^DDSVAL(DIE,DA,.08,1)
"KRN",.404,250,40,7,0)
10^Notes (WP)^3
"KRN",.404,250,40,7,1)
1.01
"KRN",.404,250,40,7,2)
5,77^1^5,65
"KRN",.404,250,40,7,4)
^^^0
"KRN",.404,250,40,7,10)
S DDSBR=5
"KRN",.404,250,40,9,0)
6^Complete by (Date)^3
"KRN",.404,250,40,9,1)
.13
"KRN",.404,250,40,9,2)
7,25^12^7,5
"KRN",.404,250,40,9,3)
!M
"KRN",.404,250,40,9,3.1)
S Y=$$PDELQ^WVUTL4(DA,DUZ(2))
"KRN",.404,250,40,9,10)
S DDSBR=9
"KRN",.404,250,40,10,0)
14^Status^3
"KRN",.404,250,40,10,1)
.14
"KRN",.404,250,40,10,2)
8,65^6^8,57
"KRN",.404,250,40,10,3)
o
"KRN",.404,250,40,11,0)
15^!M^1^
"KRN",.404,250,40,11,.1)
I $$COLP^WVUTL4(DA) S Y="(PAGE 1 OF 2)"
"KRN",.404,250,40,11,2)
^^9,60
"KRN",.404,250,40,12,0)
12^Sec Results/Diagnosis^3^
"KRN",.404,250,40,12,1)
.06
"KRN",.404,250,40,12,2)
9,25^30^9,2
"KRN",.404,250,40,12,10)
S:$$PNOCX^WVUTL6($P(^WV(790.1,DA,0),U,4)) DDSBR=13
"KRN",.404,250,40,12,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,250,40,12,12)
K WVPN I X,$P(^WV(790.31,X,0),U,22) D PUT^DDSVAL(DIE,DA,.08,1)
"KRN",.404,250,40,13,0)
13^HPV^3
"KRN",.404,250,40,13,1)
.08
"KRN",.404,250,40,13,2)
7,65^3^7,60
"KRN",.404,250,40,14,0)
11^!M^1^
"KRN",.404,250,40,14,.1)
N WVROOT S WVROOT=$$GET^DDSVAL(DIE,DA,1.01) I WVROOT]"",$O(@WVROOT@(0)) S Y="+"
"KRN",.404,250,40,14,2)
^^5,77
"KRN",.404,250,40,15,0)
5^Comments^3
"KRN",.404,250,40,15,1)
3.01
"KRN",.404,250,40,15,2)
6,25^53^6,15
"KRN",.404,250,40,17,0)
7^!M^1
"KRN",.404,250,40,17,.1)
S:$O(^WV(790.1,DA,9,0)) Y="+"
"KRN",.404,250,40,17,2)
^^4,77
"KRN",.404,250,40,18,0)
8^Reports (WP)^3
"KRN",.404,250,40,18,1)
9
"KRN",.404,250,40,18,2)
4,78^1^4,63
"KRN",.404,250,40,18,4)
^^^1
"KRN",.404,250,40,18,10)
S DDSBR=4
"KRN",.404,252,0)
WV NOTIF-HEADER-1^790.4^
"KRN",.404,252,40,0)
^.4044I^23^22
"KRN",.404,252,40,1,0)
1^* * *  EDIT A NOTIFICATION  * * *^1^
"KRN",.404,252,40,1,2)
^^1,23^
"KRN",.404,252,40,2,0)
2^!M^1^
"KRN",.404,252,40,2,.1)
S Y=IOINORM_"Patient Name: "_IOINHI_$$NAME^WVUTL1(WVDFN)_" ("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,252,40,2,2)
^^2,1
"KRN",.404,252,40,3,0)
3^!M^1^
"KRN",.404,252,40,3,.1)
S Y=IOINORM_$$PNLAB^WVUTL5()_IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,252,40,3,2)
^^2,55
"KRN",.404,252,40,4,0)
10^--------------------------------------------------------------------------------^1^
"KRN",.404,252,40,4,2)
^^9,1
"KRN",.404,252,40,5,0)
5^!M^1^
"KRN",.404,252,40,5,.1)
S Y=IOINORM_"Patient Phone: "_IOINHI_$$HPHONE^WVUTL1(WVDFN)
"KRN",.404,252,40,5,2)
^^3,48
"KRN",.404,252,40,6,0)
4^!M^1^
"KRN",.404,252,40,6,.1)
S Y=IOINORM_"Case Manager: "_IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,252,40,6,2)
^^3,1
"KRN",.404,252,40,7,0)
6^!M^1^
"KRN",.404,252,40,7,.1)
S Y=IOINORM_"Cx Tx Need  : "_IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,252,40,7,2)
^^4,1
"KRN",.404,252,40,8,0)
7^!M^1^
"KRN",.404,252,40,8,.1)
S Y=IOINORM_"PAP Regimen : "_IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,252,40,8,2)
^^6,1
"KRN",.404,252,40,9,0)
11^!M^1^
"KRN",.404,252,40,9,.1)
S Y=IOINHI_$$EDC^WVUTL1(WVDFN)_IOINORM
"KRN",.404,252,40,9,2)
^^9,51
"KRN",.404,252,40,10,0)
8^!M^1^
"KRN",.404,252,40,10,.1)
S Y=IOINORM_"Br Tx Need  : "_IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,252,40,10,2)
^^5,1
"KRN",.404,252,40,11,0)
9^!M^1^
"KRN",.404,252,40,11,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")_IOINORM
"KRN",.404,252,40,11,2)
^^6,63
"KRN",.404,252,40,12,0)
12^Cx Tx Fac:^1
"KRN",.404,252,40,12,2)
^^4,52
"KRN",.404,252,40,13,0)
13^Br Tx Fac:^1
"KRN",.404,252,40,13,2)
^^5,52
"KRN",.404,252,40,14,0)
14^!M^1
"KRN",.404,252,40,14,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"C")_IOINORM
"KRN",.404,252,40,14,2)
^^4,63
"KRN",.404,252,40,15,0)
15^!M^1
"KRN",.404,252,40,15,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"B")_IOINORM
"KRN",.404,252,40,15,2)
^^5,63
"KRN",.404,252,40,17,0)
17^MST         :^1
"KRN",.404,252,40,17,2)
^^8,1
"KRN",.404,252,40,18,0)
18^!M^1
"KRN",.404,252,40,18,.1)
S Y=IOINHI_$$MST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,252,40,18,2)
^^8,15
"KRN",.404,252,40,19,0)
19^Veteran:^1
"KRN",.404,252,40,19,2)
^^7,54
"KRN",.404,252,40,20,0)
20^!M^1
"KRN",.404,252,40,20,.1)
S Y=IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,252,40,20,2)
^^7,63
"KRN",.404,252,40,21,0)
21^!M^1
"KRN",.404,252,40,21,.1)
S Y=IOINORM_"Elig Code   : "_IOINHI_$P($$ELIG^WVUTL9(WVDFN),U,2)_IOINORM
"KRN",.404,252,40,21,2)
^^7,1
"KRN",.404,252,40,22,0)
22^CST:^1
"KRN",.404,252,40,22,2)
^^8,58
"KRN",.404,252,40,23,0)
23^!M^1
"KRN",.404,252,40,23,.1)
S Y=IOINHI_$$CST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,252,40,23,2)
^^8,63
"KRN",.404,253,0)
WV NOTIF-EDITBLK-1^790.4
"KRN",.404,253,11)

"KRN",.404,253,12)

"KRN",.404,253,40,0)
^.4044I^13^13
"KRN",.404,253,40,1,0)
3^Date Notification Opened^3
"KRN",.404,253,40,1,1)
.02
"KRN",.404,253,40,1,2)
3,29^12^3,3
"KRN",.404,253,40,1,3)
T
"KRN",.404,253,40,2,0)
1^Accession#^3
"KRN",.404,253,40,2,1)
.06
"KRN",.404,253,40,2,2)
2,15^12^2,3
"KRN",.404,253,40,2,11)
S DIC("S")="I $P(^WV(790.1,Y,0),U,2)=WVDFN"
"KRN",.404,253,40,2,12)
I X]"" W IOINORM,"  Procedure: ",$$PROC^WVUTL1A,IOELEOL
"KRN",.404,253,40,3,0)
6^Type of Notification^3
"KRN",.404,253,40,3,1)
.03
"KRN",.404,253,40,3,2)
6,29^26^6,7
"KRN",.404,253,40,3,10)
S:'X DDSBR=7 I X S:'$P(^WV(790.403,X,0),U,2) DDSBR=7
"KRN",.404,253,40,3,13)
D PRTDATE^WVUTL6
"KRN",.404,253,40,4,0)
4^Purpose of Notification^3
"KRN",.404,253,40,4,1)
.04
"KRN",.404,253,40,4,2)
4,29^50^4,4
"KRN",.404,253,40,4,4)
1
"KRN",.404,253,40,4,13)
S Y=X W !?18,"PRIORITY: ",$$PRIOR1^WVUTL1A,"               " D PRTDATE^WVUTL6
"KRN",.404,253,40,5,0)
8^Outcome^3
"KRN",.404,253,40,5,1)
.05
"KRN",.404,253,40,5,2)
8,29^30^8,20
"KRN",.404,253,40,5,12)
S X=$S(X:"c",1:"o") D PUT^DDSVAL(790.4,DA,.14,X)
"KRN",.404,253,40,6,0)
9^Status^3
"KRN",.404,253,40,6,1)
.14
"KRN",.404,253,40,6,2)
9,29^6^9,21
"KRN",.404,253,40,7,0)
5^!M^1^
"KRN",.404,253,40,7,.1)
S Y="Priority: "_IOINHI_$$PRIOR^WVUTL1A_IOINORM
"KRN",.404,253,40,7,2)
^^5,19
"KRN",.404,253,40,8,0)
2^!M^1^
"KRN",.404,253,40,8,.1)
S Y=IOINORM_"  Procedure: "_IOINHI_$$NTPROC^WVUTL1A_IOINORM
"KRN",.404,253,40,8,2)
^^2,27
"KRN",.404,253,40,9,0)
10^Patient Ed^3
"KRN",.404,253,40,9,1)
.09
"KRN",.404,253,40,9,2)
9,69^7^9,57
"KRN",.404,253,40,10,0)
7^Complete by (Date)^3
"KRN",.404,253,40,10,1)
.13
"KRN",.404,253,40,10,2)
7,29^12^7,9
"KRN",.404,253,40,10,3)
!M
"KRN",.404,253,40,10,3.1)
S Y=$$NDELQ^WVUTL4
"KRN",.404,253,40,11,0)
6.5^Print Date^3
"KRN",.404,253,40,11,1)
.11
"KRN",.404,253,40,11,2)
6,69^11^6,57
"KRN",.404,253,40,11,3)
!M
"KRN",.404,253,40,11,3.1)
D PRTDATE^WVUTL6 S Y=$$GET^DDSVAL(DIE,DA,.11)
"KRN",.404,253,40,11,13)
S:'X X=$$GET^DDSVAL(DIE,DA,.02) S X=$$NDELQ1^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"KRN",.404,253,40,12,0)
7.5^Printed^3
"KRN",.404,253,40,12,1)
.1
"KRN",.404,253,40,12,2)
7,69^12^7,60
"KRN",.404,253,40,12,4)
^^^1
"KRN",.404,253,40,12,11)
W IOINHI
"KRN",.404,253,40,12,12)
W IOINORM
"KRN",.404,253,40,13,0)
3.5^Facility^3
"KRN",.404,253,40,13,1)
.07
"KRN",.404,253,40,13,2)
3,56^23^3,46
"KRN",.404,253,40,13,4)
1
"KRN",.404,255,0)
WV PATIENT-EDITBLK-1^790
"KRN",.404,255,40,0)
^.4044I^23^20
"KRN",.404,255,40,1,0)
1^Case Manager^3
"KRN",.404,255,40,1,1)
.1
"KRN",.404,255,40,1,2)
2,21^28^2,7
"KRN",.404,255,40,1,3)
!M
"KRN",.404,255,40,1,3.1)
S:$D(DUZ(2)) Y=IOINHI_"`"_$P(^WV(790.02,DUZ(2),0),U,2)_IOINORM
"KRN",.404,255,40,2,0)
4^Cervical Tx Need^3
"KRN",.404,255,40,2,1)
.11
"KRN",.404,255,40,2,2)
3,65^16^3,47
"KRN",.404,255,40,3,0)
5^Cervical Tx Due Date^3
"KRN",.404,255,40,3,1)
.12
"KRN",.404,255,40,3,2)
4,65^11^4,43
"KRN",.404,255,40,4,0)
7^Currently Pregnant^3
"KRN",.404,255,40,4,1)
.13
"KRN",.404,255,40,4,2)
9,25^3^9,5
"KRN",.404,255,40,4,10)
S:'X DDSBR=9
"KRN",.404,255,40,4,12)
D:'X PUT^DDSVAL(DIE,DA,.14,"")
"KRN",.404,255,40,5,0)
8^EDC^3
"KRN",.404,255,40,5,1)
.14
"KRN",.404,255,40,5,2)
9,37^12^9,32
"KRN",.404,255,40,6,0)
9^DES Daughter^3
"KRN",.404,255,40,6,1)
.15
"KRN",.404,255,40,6,2)
9,68^7^9,54
"KRN",.404,255,40,7,0)
2^Breast Tx Need^3
"KRN",.404,255,40,7,1)
.18
"KRN",.404,255,40,7,2)
3,21^20^3,5
"KRN",.404,255,40,8,0)
5.5^PAP Regimen Start Date^3
"KRN",.404,255,40,8,1)
.17
"KRN",.404,255,40,8,2)
7,25^11^7,1
"KRN",.404,255,40,9,0)
6^Notes (WP)^3
"KRN",.404,255,40,9,1)
1.01
"KRN",.404,255,40,9,2)
8,68^1^8,56
"KRN",.404,255,40,9,4)
^^^0
"KRN",.404,255,40,9,10)
S DDSBR=7
"KRN",.404,255,40,10,0)
3^Breast Tx Due Date^3
"KRN",.404,255,40,10,1)
.19
"KRN",.404,255,40,10,2)
4,21^11^4,1
"KRN",.404,255,40,11,0)
5.3^PAP Regimen^3
"KRN",.404,255,40,11,1)
.16
"KRN",.404,255,40,11,2)
6,21^25^6,8
"KRN",.404,255,40,12,0)
10^Date of 1st Encounter^3
"KRN",.404,255,40,12,1)
.21
"KRN",.404,255,40,12,2)
10,25^11^10,2
"KRN",.404,255,40,12,3)
!M
"KRN",.404,255,40,12,3.1)
S Y="T"
"KRN",.404,255,40,13,0)
6.1^!M^1^
"KRN",.404,255,40,13,.1)
N WVROOT S WVROOT=$$GET^DDSVAL(DIE,DA,1.01) I WVROOT]"",$O(@WVROOT@(0)) S Y="+"
"KRN",.404,255,40,13,2)
^^8,69
"KRN",.404,255,40,14,0)
11^Referral Source^3
"KRN",.404,255,40,14,1)
.22
"KRN",.404,255,40,14,2)
10,68^8^10,51
"KRN",.404,255,40,15,0)
6.5^Family Hx of Breast CA^3
"KRN",.404,255,40,15,1)
.23
"KRN",.404,255,40,15,2)
8,25^23^8,1
"KRN",.404,255,40,16,0)
1.2^Inactive Date^3
"KRN",.404,255,40,16,1)
.24
"KRN",.404,255,40,16,2)
2,65^11^2,50
"KRN",.404,255,40,16,10)
S:X DDSBR=99
"KRN",.404,255,40,17,0)
99^ ^1
"KRN",.404,255,40,17,2)
^^10,78
"KRN",.404,255,40,18,0)
3.5^Breast Tx Facility^3
"KRN",.404,255,40,18,1)
.25
"KRN",.404,255,40,18,2)
5,21^20^5,1
"KRN",.404,255,40,19,0)
5.2^Cervical Tx Facility^3
"KRN",.404,255,40,19,1)
.26
"KRN",.404,255,40,19,2)
5,65^15^5,43
"KRN",.404,255,40,23,0)
5.8^CST^3
"KRN",.404,255,40,23,1)
.28
"KRN",.404,255,40,23,2)
7,68^12^7,63
"KRN",.404,255,40,23,10)
S DDSBR=6.5
"KRN",.404,256,0)
WV PROC-EDITBLK-2-COLP^790.1
"KRN",.404,256,11)

"KRN",.404,256,40,0)
^.4044I^16^14
"KRN",.404,256,40,2,0)
2^T-Zone Seen Entirely^3
"KRN",.404,256,40,2,1)
.21
"KRN",.404,256,40,2,2)
3,25^3^3,3
"KRN",.404,256,40,3,0)
3^Lesion Outside Canal^3
"KRN",.404,256,40,3,1)
.22
"KRN",.404,256,40,3,2)
4,25^3^4,3
"KRN",.404,256,40,4,0)
4^Satisfactory Exam^3
"KRN",.404,256,40,4,1)
.2
"KRN",.404,256,40,4,2)
5,25^3^5,6
"KRN",.404,256,40,5,0)
5^Multifocal^3
"KRN",.404,256,40,5,1)
.23
"KRN",.404,256,40,5,2)
3,67^3^3,55
"KRN",.404,256,40,6,0)
6^Number of Quadrants^3
"KRN",.404,256,40,6,1)
.24
"KRN",.404,256,40,6,2)
4,67^3^4,46
"KRN",.404,256,40,8,0)
8^ECC Dysplasia^3
"KRN",.404,256,40,8,1)
.25
"KRN",.404,256,40,8,2)
7,25^20^7,10
"KRN",.404,256,40,8,12)
S:'$$MARGIN^WVUTL4(DA) DDSBR=9
"KRN",.404,256,40,9,0)
9^Ectocervical Biopsy^3
"KRN",.404,256,40,9,1)
.26
"KRN",.404,256,40,9,2)
8,25^30^8,4
"KRN",.404,256,40,9,11)
S WVPN=$O(^WV(790.2,"B","ECTOCERVICAL BIOPSY",0))
"KRN",.404,256,40,9,12)
K WVPN
"KRN",.404,256,40,10,0)
12^!M^1^
"KRN",.404,256,40,10,.1)
S Y="(PAGE 2 OF 2)"
"KRN",.404,256,40,10,2)
^^9,58^
"KRN",.404,256,40,11,0)
11^STD Evaluation^3
"KRN",.404,256,40,11,1)
.28
"KRN",.404,256,40,11,2)
9,25^30^9,9^0
"KRN",.404,256,40,11,11)
S WVPN=$O(^WV(790.2,"B","STD EVALUATION",0))
"KRN",.404,256,40,11,12)
K WVPN
"KRN",.404,256,40,12,0)
8.5^Margins Clear^3
"KRN",.404,256,40,12,1)
.27
"KRN",.404,256,40,12,2)
7,73^3^7,58^0
"KRN",.404,256,40,13,0)
6.5^IMPRESSION^3
"KRN",.404,256,40,13,1)
.29
"KRN",.404,256,40,13,2)
6,25^30^6,13
"KRN",.404,256,40,13,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,256,40,13,12)
K WVPN
"KRN",.404,256,40,14,0)
.5^Screening PAP^3
"KRN",.404,256,40,14,1)
.3
"KRN",.404,256,40,14,2)
2,25^10^2,10
"KRN",.404,256,40,15,0)
10^Stage^3
"KRN",.404,256,40,15,1)
.31
"KRN",.404,256,40,15,2)
8,65^10^8,58^0
"KRN",.404,256,40,16,0)
6.4^Quadrant Locations^3
"KRN",.404,256,40,16,1)
.245
"KRN",.404,256,40,16,2)
5,67^11^5,47
"KRN",.404,257,0)
WV NOTIF-EDITBLK-2^790.4
"KRN",.404,257,11)
D HLP^DDSUTL("*** NOTE: Most fields cannot be edited because the letter has been printed. ***")
"KRN",.404,257,40,0)
^.4044I^13^13
"KRN",.404,257,40,1,0)
3^Date of Notification^3
"KRN",.404,257,40,1,1)
.02
"KRN",.404,257,40,1,2)
3,25^12^3,3
"KRN",.404,257,40,1,3)
T
"KRN",.404,257,40,1,4)
^^^1
"KRN",.404,257,40,2,0)
1^Accession#^3
"KRN",.404,257,40,2,1)
.06
"KRN",.404,257,40,2,2)
2,15^12^2,3
"KRN",.404,257,40,2,4)
^^^1
"KRN",.404,257,40,2,11)
S DIC("S")="I $P(^WV(790.1,Y,0),U,2)=WVDFN"
"KRN",.404,257,40,2,12)
I X]"" W ?46,IOINORM,"PROCEDURE: ",$$NTPROC^WVUTL1A,IOELEOL
"KRN",.404,257,40,3,0)
6^Type of Notification^3
"KRN",.404,257,40,3,1)
.03
"KRN",.404,257,40,3,2)
6,29^26^6,7
"KRN",.404,257,40,3,4)
^^^1
"KRN",.404,257,40,3,10)
I X S:'$P(^WV(790.403,X,0),U,2) DDSBR=7
"KRN",.404,257,40,3,13)
D PRTDATE^WVUTL2
"KRN",.404,257,40,4,0)
4^Purpose of Notification^3
"KRN",.404,257,40,4,1)
.04
"KRN",.404,257,40,4,2)
4,29^50^4,4
"KRN",.404,257,40,4,4)
^^^1
"KRN",.404,257,40,4,13)
S Y=X W !?18,"PRIORITY: ",$$PRIOR1^WVUTL1A,"     " S X=$$NDELQ1^WVUTL4 D PUT^DDSVAL(DIE,DA,.13,X)
"KRN",.404,257,40,5,0)
8^Outcome^3
"KRN",.404,257,40,5,1)
.05
"KRN",.404,257,40,5,2)
8,29^30^8,20
"KRN",.404,257,40,5,12)
S X=$S(X:"c",1:"o") D PUT^DDSVAL(790.4,DA,.14,X)
"KRN",.404,257,40,6,0)
9^Status^3
"KRN",.404,257,40,6,1)
.14
"KRN",.404,257,40,6,2)
9,29^6^9,21
"KRN",.404,257,40,7,0)
5^!M^1^
"KRN",.404,257,40,7,.1)
S Y="Priority: "_IOINHI_$$PRIOR^WVUTL1A_IOINORM
"KRN",.404,257,40,7,2)
^^5,19
"KRN",.404,257,40,8,0)
2^!M^1^
"KRN",.404,257,40,8,.1)
S Y=IOINORM_"Procedure: "_IOINHI_$$NTPROC^WVUTL1A_IOINORM
"KRN",.404,257,40,8,2)
^^2,38
"KRN",.404,257,40,9,0)
10^Patient Ed^3
"KRN",.404,257,40,9,1)
.09
"KRN",.404,257,40,9,2)
9,69^7^9,57
"KRN",.404,257,40,10,0)
7^Complete by (Date)^3
"KRN",.404,257,40,10,1)
.13
"KRN",.404,257,40,10,2)
7,29^12^7,9
"KRN",.404,257,40,10,4)
^^^1
"KRN",.404,257,40,11,0)
6.5^Print Date^3
"KRN",.404,257,40,11,1)
.11
"KRN",.404,257,40,11,2)
6,69^11^6,57
"KRN",.404,257,40,11,4)
^^^1
"KRN",.404,257,40,12,0)
7.5^Printed^3
"KRN",.404,257,40,12,1)
.1
"KRN",.404,257,40,12,2)
7,69^12^7,60
"KRN",.404,257,40,12,4)
^^^1
"KRN",.404,257,40,12,11)
W IOINHI
"KRN",.404,257,40,12,12)
W IOINORM
"KRN",.404,257,40,13,0)
3.5^Facility^3
"KRN",.404,257,40,13,1)
.07
"KRN",.404,257,40,13,2)
3,56^23^3,46
"KRN",.404,257,40,13,4)
^^^1
"KRN",.404,315,0)
WV PROC-DISPLAY-1^790.1^
"KRN",.404,315,40,0)
^.4044I^37^34
"KRN",.404,315,40,1,0)
1^* * *  EDIT A PROCEDURE  * * *^1
"KRN",.404,315,40,1,2)
^^1,19
"KRN",.404,315,40,2,0)
2^Patient Name:^1
"KRN",.404,315,40,2,2)
^^2,1
"KRN",.404,315,40,3,0)
3^Case Manager:^1
"KRN",.404,315,40,3,2)
^^3,1
"KRN",.404,315,40,5,0)
5^!M^1
"KRN",.404,315,40,5,.1)
S Y="PAP Regimen :"
"KRN",.404,315,40,5,2)
^^4,1
"KRN",.404,315,40,6,0)
6^Br Tx Need  :^1
"KRN",.404,315,40,6,2)
^^6,1
"KRN",.404,315,40,7,0)
2.5^SSN:^1
"KRN",.404,315,40,7,2)
^^2,56
"KRN",.404,315,40,8,0)
3.5^Procedure:^1
"KRN",.404,315,40,8,2)
^^3,50
"KRN",.404,315,40,9,0)
4.5^Cx Facility:^1
"KRN",.404,315,40,9,2)
^^5,48
"KRN",.404,315,40,10,0)
6.5^Br Facility:^1
"KRN",.404,315,40,10,2)
^^6,48
"KRN",.404,315,40,11,0)
5.5^Acc#:^1
"KRN",.404,315,40,11,2)
^^4,55
"KRN",.404,315,40,12,0)
2.2^!M^1
"KRN",.404,315,40,12,.1)
S Y=IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,315,40,12,2)
^^2,15
"KRN",.404,315,40,13,0)
3.2^!M^1
"KRN",.404,315,40,13,.1)
S Y=IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,13,2)
^^3,15
"KRN",.404,315,40,14,0)
4.2^!M^1
"KRN",.404,315,40,14,.1)
S Y=IOINHI_$E($$PROC1^WVUTL1A,1,19)_IOINORM
"KRN",.404,315,40,14,2)
^^3,61
"KRN",.404,315,40,16,0)
5.3^Cx Tx Need  :^1
"KRN",.404,315,40,16,2)
^^5,1
"KRN",.404,315,40,17,0)
5.4^!M^1
"KRN",.404,315,40,17,.1)
S Y=IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,315,40,17,2)
^^5,15
"KRN",.404,315,40,18,0)
4.3^!M^1
"KRN",.404,315,40,18,.1)
S Y=IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,315,40,18,2)
^^4,15
"KRN",.404,315,40,19,0)
6.2^ ^1
"KRN",.404,315,40,19,2)
^^4,11
"KRN",.404,315,40,20,0)
2.8^!M^1
"KRN",.404,315,40,20,.1)
S Y=IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,20,2)
^^2,61
"KRN",.404,315,40,21,0)
4.8^!M^1
"KRN",.404,315,40,21,.1)
S Y=IOINHI_$$ACC^WVUTL1(DA)_IOINORM
"KRN",.404,315,40,21,2)
^^4,61
"KRN",.404,315,40,23,0)
6.4^!M^1
"KRN",.404,315,40,23,.1)
S Y=IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,315,40,23,2)
^^6,15
"KRN",.404,315,40,24,0)
20^--------------------------------------------------------------------------------^1
"KRN",.404,315,40,24,2)
^^9,1
"KRN",.404,315,40,25,0)
32^!M^1
"KRN",.404,315,40,25,.1)
S Y=IOINHI_$$EDC^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,25,2)
^^9,53
"KRN",.404,315,40,26,0)
31^!M^1
"KRN",.404,315,40,26,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")
"KRN",.404,315,40,26,2)
^^9,25
"KRN",.404,315,40,27,0)
21^!M^1
"KRN",.404,315,40,27,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"C")_IOINORM
"KRN",.404,315,40,27,2)
^^5,61
"KRN",.404,315,40,28,0)
22^!M^1
"KRN",.404,315,40,28,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"B")_IOINORM
"KRN",.404,315,40,28,2)
^^6,61
"KRN",.404,315,40,29,0)
23^MST         :^1
"KRN",.404,315,40,29,2)
^^8,1
"KRN",.404,315,40,30,0)
24^!M^1
"KRN",.404,315,40,30,.1)
S Y=IOINHI_$$MST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,315,40,30,2)
^^8,15
"KRN",.404,315,40,32,0)
25^Veteran:^1
"KRN",.404,315,40,32,2)
^^7,52
"KRN",.404,315,40,33,0)
26^!M^1
"KRN",.404,315,40,33,.1)
S Y=IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,315,40,33,2)
^^7,61
"KRN",.404,315,40,34,0)
27^Elig Code   :^1
"KRN",.404,315,40,34,2)
^^7,1
"KRN",.404,315,40,35,0)
28^!M^1
"KRN",.404,315,40,35,.1)
S Y=IOINHI_$P($$ELIG^WVUTL9(WVDFN),U,2)_IOINORM
"KRN",.404,315,40,35,2)
^^7,15
"KRN",.404,315,40,36,0)
29^CST:^1
"KRN",.404,315,40,36,2)
^^8,56
"KRN",.404,315,40,37,0)
30^!M^1
"KRN",.404,315,40,37,.1)
S Y=IOINHI_$$CST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,315,40,37,2)
^^8,61
"KRN",.404,318,0)
WV REFUSAL-DISPLAY-1^790.1^
"KRN",.404,318,40,0)
^.4044I^36^28
"KRN",.404,318,40,1,0)
1^* * *  ADD/EDIT A REFUSAL  * * *^1
"KRN",.404,318,40,1,2)
^^1,22
"KRN",.404,318,40,2,0)
2^Patient Name:^1
"KRN",.404,318,40,2,2)
^^3,1
"KRN",.404,318,40,3,0)
3^Case Manager:^1
"KRN",.404,318,40,3,2)
^^4,1
"KRN",.404,318,40,5,0)
5^!M^1
"KRN",.404,318,40,5,.1)
S Y="PAP Regimen:"
"KRN",.404,318,40,5,2)
^^4,48
"KRN",.404,318,40,6,0)
6^Br Tx Need  :^1
"KRN",.404,318,40,6,2)
^^6,1
"KRN",.404,318,40,7,0)
2.5^SSN:^1
"KRN",.404,318,40,7,2)
^^3,56
"KRN",.404,318,40,9,0)
4.5^Cx Tx Fac:^1
"KRN",.404,318,40,9,2)
^^5,50
"KRN",.404,318,40,10,0)
6.5^Br Tx Fac:^1
"KRN",.404,318,40,10,2)
^^6,50
"KRN",.404,318,40,12,0)
2.2^!M^1
"KRN",.404,318,40,12,.1)
S Y=IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,318,40,12,2)
^^3,15
"KRN",.404,318,40,13,0)
3.2^!M^1
"KRN",.404,318,40,13,.1)
S Y=IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,318,40,13,2)
^^4,15
"KRN",.404,318,40,16,0)
5.3^Cx Tx Need  :^1
"KRN",.404,318,40,16,2)
^^5,1
"KRN",.404,318,40,17,0)
5.4^!M^1
"KRN",.404,318,40,17,.1)
S Y=IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,318,40,17,2)
^^5,15
"KRN",.404,318,40,18,0)
4.3^!M^1
"KRN",.404,318,40,18,.1)
S Y=IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,318,40,18,2)
^^4,61
"KRN",.404,318,40,20,0)
2.8^!M^1
"KRN",.404,318,40,20,.1)
S Y=IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,318,40,20,2)
^^3,61
"KRN",.404,318,40,23,0)
6.4^!M^1
"KRN",.404,318,40,23,.1)
S Y=IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,318,40,23,2)
^^6,15
"KRN",.404,318,40,24,0)
20^--------------------------------------------------------------------------------^1
"KRN",.404,318,40,24,2)
^^10,1
"KRN",.404,318,40,25,0)
19^!M^1
"KRN",.404,318,40,25,.1)
S Y=$$EDC^WVUTL1(WVDFN)
"KRN",.404,318,40,25,2)
^^9,1
"KRN",.404,318,40,26,0)
17^!M^1
"KRN",.404,318,40,26,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")
"KRN",.404,318,40,26,2)
^^9,61
"KRN",.404,318,40,27,0)
21^!M^1
"KRN",.404,318,40,27,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"C")_IOINORM
"KRN",.404,318,40,27,2)
^^5,61
"KRN",.404,318,40,28,0)
22^!M^1
"KRN",.404,318,40,28,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"B")_IOINORM
"KRN",.404,318,40,28,2)
^^6,61
"KRN",.404,318,40,29,0)
23^MST         :^1
"KRN",.404,318,40,29,2)
^^8,1
"KRN",.404,318,40,30,0)
24^!M^1
"KRN",.404,318,40,30,.1)
S Y=IOINHI_$$MST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,318,40,30,2)
^^8,15
"KRN",.404,318,40,31,0)
25^Veteran:^1
"KRN",.404,318,40,31,2)
^^7,52
"KRN",.404,318,40,32,0)
26^!M^1
"KRN",.404,318,40,32,.1)
S Y=IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,318,40,32,2)
^^7,61
"KRN",.404,318,40,33,0)
27^Elig Code   :^1
"KRN",.404,318,40,33,2)
^^7,1
"KRN",.404,318,40,34,0)
28^!M^1
"KRN",.404,318,40,34,.1)
S Y=IOINHI_$P($$ELIG^WVUTL9(WVDFN),U,2)_IOINORM
"KRN",.404,318,40,34,2)
^^7,15
"KRN",.404,318,40,35,0)
23.1^CST:^1
"KRN",.404,318,40,35,2)
^^8,56
"KRN",.404,318,40,36,0)
23.2^!M^1
"KRN",.404,318,40,36,.1)
S Y=IOINHI_$$CST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,318,40,36,2)
^^8,61
"KRN",.404,319,0)
WV REFUSAL-EDIT-1^790.3
"KRN",.404,319,40,0)
^.4044I^5^4
"KRN",.404,319,40,1,0)
1^Date Refused^3
"KRN",.404,319,40,1,1)
.01
"KRN",.404,319,40,1,2)
2,15^11^2,1
"KRN",.404,319,40,1,11)
W IOINHI
"KRN",.404,319,40,1,12)
W IOINORM
"KRN",.404,319,40,2,0)
4^Reason^3
"KRN",.404,319,40,2,1)
3
"KRN",.404,319,40,2,2)
6,15^17^6,7
"KRN",.404,319,40,3,0)
5^Comments^3
"KRN",.404,319,40,3,1)
4
"KRN",.404,319,40,3,2)
8,15^63^8,5
"KRN",.404,319,40,5,0)
3^Procedure^3
"KRN",.404,319,40,5,1)
2
"KRN",.404,319,40,5,2)
4,15^30^4,4
"KRN",.404,326,0)
WV PATIENT-HEADER-2^790^
"KRN",.404,326,40,0)
^.4044I^11^11
"KRN",.404,326,40,1,0)
1^* * *  EDIT PATIENT CASE DATA  * * *^1
"KRN",.404,326,40,1,2)
^^1,22
"KRN",.404,326,40,2,0)
2^!M^1
"KRN",.404,326,40,2,.1)
S Y=IOINORM_"Patient Name: "_IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,326,40,2,2)
^^3,1
"KRN",.404,326,40,3,0)
3^!M^1
"KRN",.404,326,40,3,.1)
S Y=IOINORM_$$PNLAB^WVUTL5()_IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,326,40,3,2)
^^3,52
"KRN",.404,326,40,4,0)
4^!M^1
"KRN",.404,326,40,4,.1)
S Y=IOINORM_"Street: "_IOINHI_$$STREET^WVUTL1(WVDFN)_IOINORM
"KRN",.404,326,40,4,2)
^^4,7
"KRN",.404,326,40,5,0)
5^!M^1
"KRN",.404,326,40,5,.1)
S Y=IOINORM_"Patient Phone: "_IOINHI_$$HPHONE^WVUTL1(WVDFN)
"KRN",.404,326,40,5,2)
^^4,45
"KRN",.404,326,40,6,0)
6^!M^1
"KRN",.404,326,40,6,.1)
S Y=IOINORM_"Cty/St/Zip: "_IOINHI_$$CTYSTZ^WVUTL1(WVDFN)_IOINORM
"KRN",.404,326,40,6,2)
^^5,3
"KRN",.404,326,40,7,0)
7^!M^1
"KRN",.404,326,40,7,.1)
S Y=IOINORM_"Pr Provider: "_IOINHI_$E($$PROVI^WVUTL1A(WVDFN),1,20)
"KRN",.404,326,40,7,2)
^^5,47
"KRN",.404,326,40,8,0)
8^!M^1
"KRN",.404,326,40,8,.1)
S Y=IOINORM_"Veteran: "_IOINHI_$$VET^WVUTL1A(WVDFN)
"KRN",.404,326,40,8,2)
^^6,51
"KRN",.404,326,40,9,0)
9^________________________________________________________________________________^1
"KRN",.404,326,40,9,2)
^^8,1
"KRN",.404,326,40,10,0)
10^!M^1
"KRN",.404,326,40,10,.1)
S Y=IOINORM_"Elig Code: "_IOINHI_$P($$ELIG^WVUTL9(WVDFN),U,2)
"KRN",.404,326,40,10,2)
^^6,4
"KRN",.404,326,40,11,0)
11^!M^1
"KRN",.404,326,40,11,.1)
S Y=IOINORM_"MST: "_IOINHI_$$MST^WVUTL1A(WVDFN)
"KRN",.404,326,40,11,2)
^^7,10
"KRN",19,10421,-1)
0^3
"KRN",19,10421,0)
WV SEXUAL TRAUMA SUMMARY^Sexual Trauma Summary Report^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,10421,1,0)
^^6^6^3010228^
"KRN",19,10421,1,1,0)
This option provides the user with a short report of the number of WH
"KRN",19,10421,1,2,0)
patients who have experienced sexual trauma. The report may include
"KRN",19,10421,1,3,0)
patients for a single case manager or all case managers.
"KRN",19,10421,1,4,0)
 
"KRN",19,10421,1,5,0)
Patients who are deceased or have a date entered into the DATE INACTIVE
"KRN",19,10421,1,6,0)
(#.24) field of the WV PATIENT (#790) file are not counted in this report.
"KRN",19,10421,25)
WVRPST
"KRN",19,10421,"U")
SEXUAL TRAUMA SUMMARY REPORT
"KRN",19,11016,-1)
0^2
"KRN",19,11016,0)
WV SEXUAL TRAUMA LIST^List Sexual Trauma Data^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,11016,1,0)
^^17^17^3010402^
"KRN",19,11016,1,1,0)
This option displays a list of patients, their Civilian Sexual Trauma
"KRN",19,11016,1,2,0)
value from the WH package and the Military Sexual Trauma (MST) value from
"KRN",19,11016,1,3,0)
the MST module of the Registration package. The patient's name, SSN, case
"KRN",19,11016,1,4,0)
manager, age, veteran status and eligibility code are displayed, too.
"KRN",19,11016,1,5,0)
 
"KRN",19,11016,1,6,0)
Patients are sorted by case manager first, then MST status and finally
"KRN",19,11016,1,7,0)
patient name. The MST status order is:
"KRN",19,11016,1,8,0)
 1) Yes, Screened reports MST
"KRN",19,11016,1,9,0)
 2) No, Screened does not report MST
"KRN",19,11016,1,10,0)
 3) Screened Declines to answer
"KRN",19,11016,1,11,0)
 4) Unknown, not screened   
"KRN",19,11016,1,12,0)
 
"KRN",19,11016,1,13,0)
Non-veteran patients are displayed after the veterans.
"KRN",19,11016,1,14,0)
 
"KRN",19,11016,1,15,0)
The user may choose to see the patients for one case manager or all case
"KRN",19,11016,1,16,0)
managers. Patients who are deceased or have an Inactive Date (prior to
"KRN",19,11016,1,17,0)
today's date) will not appear on the listing.
"KRN",19,11016,25)
WVMSTL
"KRN",19,11016,"U")
LIST SEXUAL TRAUMA DATA
"KRN",19,11265,-1)
1^4
"KRN",19,11265,0)
WV ADD TO MST
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",364,-1)
1^1
"PKG",364,0)
WOMEN'S HEALTH^WV^Tracks health issues specific to female patients.
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
1.0^2980925^2980508^547
"PKG",364,22,1,"PAH",1,0)
14^3010412
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^3010412
"PKG",364,22,1,"PAH",1,1,1,0)
Please read the WV*1*14 patch description on FORUM for an explanation of
"PKG",364,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
14
"RTN","WV14PRE")
0^16^B261229
"RTN","WV14PRE",1,0)
WV14PRE ;HCIOFO/FT-WV*1*14 PRE-INSTALL/Transfer Sexual Trauma Data to DG MST Module ;3/19/01  13:25
"RTN","WV14PRE",2,0)
 ;;1.0;WOMEN'S HEALTH;**14**;Sep 30, 1998
"RTN","WV14PRE",3,0)
 ;
"RTN","WV14PRE",4,0)
 ; This routine uses the following IAs:
"RTN","WV14PRE",5,0)
 ; #1157 - $$DELETE^XPDMENU   (supported)
"RTN","WV14PRE",6,0)
 ;
"RTN","WV14PRE",7,0)
REMOVE ; Remove [WV ADD TO MST] option from File Maintenance Menu
"RTN","WV14PRE",8,0)
 N WVFLAG,WVMENU,WVOPTION
"RTN","WV14PRE",9,0)
 S WVMENU="WV MENU-FILE MAINTENANCE"
"RTN","WV14PRE",10,0)
 S WVOPTION="WV ADD TO MST"
"RTN","WV14PRE",11,0)
 S WVFLAG=$$DELETE^XPDMENU(WVMENU,WVOPTION)
"RTN","WV14PRE",12,0)
 Q
"RTN","WV14PST")
0^1^B23147211
"RTN","WV14PST",1,0)
WV14PST ;HCIOFO/FT-WV*1*14 POST INSTALL/Transfer Sexual Trauma Data to DG MST Module ;4/4/01  11:41
"RTN","WV14PST",2,0)
 ;;1.0;WOMEN'S HEALTH;**14**;Sep 30, 1998
"RTN","WV14PST",3,0)
 ;
"RTN","WV14PST",4,0)
 ; This routine uses the following IAs:
"RTN","WV14PST",5,0)
 ; #1625 - $$GET^XUA4A72      (supported)
"RTN","WV14PST",6,0)
 ; #2716 - $$GETSTAT^DGMSTAPI (supported)
"RTN","WV14PST",7,0)
 ; #2716 - $$NEWSTAT^DGMSTAPI (supported)
"RTN","WV14PST",8,0)
 ; #1157 - $$DELETE^XPDMENU   (supported)
"RTN","WV14PST",9,0)
 ;
"RTN","WV14PST",10,0)
DESC ; Description of post install
"RTN","WV14PST",11,0)
 ; This post install converts the WH Sexual Trauma data (File 790,
"RTN","WV14PST",12,0)
 ; Field .27) into a Military Sexual Trauma (MST) value and a Civilian
"RTN","WV14PST",13,0)
 ; Sexual Trauma (CST) value. The MST value is then transferred to the
"RTN","WV14PST",14,0)
 ; Registration package. The CST value is stored in the Women's Health
"RTN","WV14PST",15,0)
 ; package. The MST module tracks data for veterans only. Data for
"RTN","WV14PST",16,0)
 ; non-veterans is not added to the MST module. WH patients whose Sexual
"RTN","WV14PST",17,0)
 ; Trauma value is 'Military', 'Civilian', 'Both' or 'None' will have
"RTN","WV14PST",18,0)
 ; that value translated into a MST value and added to the MST module.
"RTN","WV14PST",19,0)
 ;  WH value      MST value     CST value
"RTN","WV14PST",20,0)
 ;  --------      ---------     ---------
"RTN","WV14PST",21,0)
 ;  Military      Yes           No
"RTN","WV14PST",22,0)
 ;  Civilian      No            Yes
"RTN","WV14PST",23,0)
 ;  Both          Yes           Yes
"RTN","WV14PST",24,0)
 ;  None          No            No
"RTN","WV14PST",25,0)
 ;  <null>        no transfer   Unknown
"RTN","WV14PST",26,0)
 ;
"RTN","WV14PST",27,0)
 ; NOTE: If a WH patient is already in the MST module with a value of
"RTN","WV14PST",28,0)
 ; 'Yes' then no additional MST entry is made. Also, if a WH patient
"RTN","WV14PST",29,0)
 ; is already in the MST module with a value of 'No' and the WH Sexual
"RTN","WV14PST",30,0)
 ; Trauma value is 'None' or 'Civilian' then no additional MST entry
"RTN","WV14PST",31,0)
 ; is made.
"RTN","WV14PST",32,0)
 ; The provider who determined the value must be stored in the MST
"RTN","WV14PST",33,0)
 ; module. If the case manager associated with the patient or the user
"RTN","WV14PST",34,0)
 ; running this option is a provider, then the case manager or the user
"RTN","WV14PST",35,0)
 ; is identified as the provider who did the screening. If neither is
"RTN","WV14PST",36,0)
 ; a provider, then that patient's data is not added to the MST module.
"RTN","WV14PST",37,0)
 ; This option will display a list of WH patients whose data was added
"RTN","WV14PST",38,0)
 ; to the MST module. It will also display a list of WH patients whose
"RTN","WV14PST",39,0)
 ; data could not be added to the MST module. These lists are then sent
"RTN","WV14PST",40,0)
 ; to the case managers in a MailMan message.
"RTN","WV14PST",41,0)
 ;
"RTN","WV14PST",42,0)
EN ; Run in the background
"RTN","WV14PST",43,0)
 N WVMESAGE,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WV14PST",44,0)
 S ZTRTN="Q^WV14PST",ZTDESC="WV*1*14 INSTALLED"
"RTN","WV14PST",45,0)
 S ZTIO="",ZTDTH=$H
"RTN","WV14PST",46,0)
 D ^%ZTLOAD
"RTN","WV14PST",47,0)
 S WVMESAGE="The post-installation will run as background job #"_$G(ZTSK)
"RTN","WV14PST",48,0)
 D MES^XPDUTL(WVMESAGE)
"RTN","WV14PST",49,0)
 Q
"RTN","WV14PST",50,0)
Q ; Entry point for the background job
"RTN","WV14PST",51,0)
 D REMOVE
"RTN","WV14PST",52,0)
 D START
"RTN","WV14PST",53,0)
 D DELETE
"RTN","WV14PST",54,0)
 D EXIT
"RTN","WV14PST",55,0)
 Q
"RTN","WV14PST",56,0)
EXIT ; Exit and clean up
"RTN","WV14PST",57,0)
 K ^TMP($J)
"RTN","WV14PST",58,0)
 K WVCST,WVDASHES,WVDATE,WVDFN,WVDGMST,WVDUZ,WVFLAG,WVLINE,WVMGR,WVMGRN
"RTN","WV14PST",59,0)
 K WVMGRO,WVMSG,WVNAME,WVNODE,WVPROV,WVREASON,WVSPACES,WVSSN,WVST
"RTN","WV14PST",60,0)
 K WVTITLEN,WVTITLEY,WVUSER,WVX
"RTN","WV14PST",61,0)
 K X,XMDUN,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,Y
"RTN","WV14PST",62,0)
 Q
"RTN","WV14PST",63,0)
START ; Loop through FILE 790
"RTN","WV14PST",64,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WV14PST",65,0)
 K ^TMP($J)
"RTN","WV14PST",66,0)
 S WVDFN=0
"RTN","WV14PST",67,0)
 F  S WVDFN=$O(^WV(790,WVDFN)) Q:'WVDFN  D SET
"RTN","WV14PST",68,0)
 D EMAIL^WV14PST1 ;send email to case manager(s).
"RTN","WV14PST",69,0)
 Q
"RTN","WV14PST",70,0)
SET ; Set tmp global
"RTN","WV14PST",71,0)
 S WVNODE=$G(^WV(790,WVDFN,0)) Q:WVNODE=""
"RTN","WV14PST",72,0)
 S WVST=$P(WVNODE,U,27) ;WH sexual trauma value
"RTN","WV14PST",73,0)
 ; determine CST value
"RTN","WV14PST",74,0)
 S WVCST=$S(WVST="C":"Y",WVST="B":"Y",WVST="N":"N",WVST="M":"N",1:"U")
"RTN","WV14PST",75,0)
 S:$P(WVNODE,U,28)="" $P(^WV(790,WVDFN,0),U,28)=WVCST ;set CST value
"RTN","WV14PST",76,0)
 S $P(^WV(790,WVDFN,0),U,27)="" ;null out (new) MST field
"RTN","WV14PST",77,0)
 Q:WVST=""  ;no value to transfer to Registration
"RTN","WV14PST",78,0)
 Q:$$VET^WVUTL1A(WVDFN)'="Yes"  ;veterans only
"RTN","WV14PST",79,0)
 S WVMGR=$P(WVNODE,U,10) ;case manager ien
"RTN","WV14PST",80,0)
 I '$D(XMY(WVMGR)) S XMY(WVMGR)="" ;send message to these case mgrs
"RTN","WV14PST",81,0)
 ; $$GETSTAT^DGMSTAPI supported API - IA #2716
"RTN","WV14PST",82,0)
 S WVDGMST=$$GETSTAT^DGMSTAPI(WVDFN) ;get MST value from Registration
"RTN","WV14PST",83,0)
 Q:+WVDGMST=-1  ;couldn't retrieve MST status (i.e., DFN is null)
"RTN","WV14PST",84,0)
 S WVDGMST=$E($P(WVDGMST,U,2),1)
"RTN","WV14PST",85,0)
 Q:WVDGMST="Y"  ;MST already set to YES                                
"RTN","WV14PST",86,0)
 I WVST="N",WVDGMST="N" Q  ;both are NO, don't update MST
"RTN","WV14PST",87,0)
 I WVST="C",WVDGMST="N" Q  ;Civilian & No, don't update MST
"RTN","WV14PST",88,0)
 S WVDGMST=$$CONVERT(WVST)
"RTN","WV14PST",89,0)
 Q:WVDGMST=""  ;not an MST value                                        
"RTN","WV14PST",90,0)
 S WVMGRN=$$PERSON^WVUTL1(WVMGR) ;case manager name
"RTN","WV14PST",91,0)
 S WVPROV=$$PROVIDER(DUZ,WVMGR)
"RTN","WV14PST",92,0)
 S WVNAME=$$NAME^WVUTL1(WVDFN) ;patient name
"RTN","WV14PST",93,0)
 S WVSSN=$$SSN^WVUTL1(WVDFN) ;patient ssn
"RTN","WV14PST",94,0)
 S WVST=$S(WVST="M":"Military",WVST="C":"Civilian",WVST="B":"Both",WVST="N":"None",1:"<no value>")
"RTN","WV14PST",95,0)
 I WVPROV="" S ^TMP($J,"WVNO",WVMGRN,WVMGR,WVNAME,WVDFN)=WVST_U_U_U_WVSSN_U_"Determining Provider Unknown" Q
"RTN","WV14PST",96,0)
 ; $$NEWSTAT^DGMSTAPI supported API - IA 2716
"RTN","WV14PST",97,0)
 ; parameters(dfn,mst status,date/time,provider ien). A null d/t=NOW.
"RTN","WV14PST",98,0)
 S WVFLAG=$$NEWSTAT^DGMSTAPI(WVDFN,WVDGMST,"",WVPROV)
"RTN","WV14PST",99,0)
 ; +WVFLAG will be the ien of the MST entry, if successful
"RTN","WV14PST",100,0)
 I +WVFLAG=-1 S ^TMP($J,"WVNO",WVMGRN,WVMGR,WVNAME,WVDFN)=WVST_U_U_U_WVSSN_U_$P(WVFLAG,U,2) Q  ;no entry made in Registration
"RTN","WV14PST",101,0)
 S WVDGMST=$S(WVDGMST="Y":"Yes",WVDGMST="N":"No",WVDGMST="D":"Declined",WVDGMST="U":"Undefined",1:"<no value>")
"RTN","WV14PST",102,0)
 I WVPROV S WVPROV=$$PERSON^WVUTL1(WVPROV) ;get provider name
"RTN","WV14PST",103,0)
 I +WVFLAG S ^TMP($J,"WVYES",WVMGRN,WVMGR,WVNAME,WVDFN)=WVST_U_WVDGMST_U_WVPROV_U_WVSSN
"RTN","WV14PST",104,0)
 Q
"RTN","WV14PST",105,0)
CONVERT(WVST) ; Convert WH code to MST code
"RTN","WV14PST",106,0)
 ; Convert Military or Both to Yes.
"RTN","WV14PST",107,0)
 ;    "    Civilian or None to No.
"RTN","WV14PST",108,0)
 ; Ignore null.
"RTN","WV14PST",109,0)
 Q $S(WVST="M":"Y",WVST="C":"N",WVST="B":"Y",WVST="N":"N",1:"")
"RTN","WV14PST",110,0)
 ;
"RTN","WV14PST",111,0)
PROVIDER(WVDUZ,WVMGR) ; Determine provider.
"RTN","WV14PST",112,0)
 ; Try case manager first, then try user (i.e., DUZ). 
"RTN","WV14PST",113,0)
 ; $$GET^XUA4A72 supported API - IA #1625
"RTN","WV14PST",114,0)
 I WVMGR I +$$GET^XUA4A72(WVMGR)>0 Q WVMGR
"RTN","WV14PST",115,0)
 I WVDUZ I +$$GET^XUA4A72(WVDUZ)>0 Q WVDUZ
"RTN","WV14PST",116,0)
 Q ""
"RTN","WV14PST",117,0)
 ;
"RTN","WV14PST",118,0)
REMOVE ; Remove [WV ADD TO MST] option from File Maintenance Menu
"RTN","WV14PST",119,0)
 ; Remove [DGMST ENTER NEW MST] option from Patient Management menu
"RTN","WV14PST",120,0)
 N WVFLAG,WVMENU,WVOPTION
"RTN","WV14PST",121,0)
 S WVMENU="WV MENU-PATIENT MANAGEMENT"
"RTN","WV14PST",122,0)
 S WVOPTION="DGMST ENTER NEW MST"
"RTN","WV14PST",123,0)
 S WVFLAG=$$DELETE^XPDMENU(WVMENU,WVOPTION)
"RTN","WV14PST",124,0)
 Q
"RTN","WV14PST",125,0)
DELETE ; Delete the SEXUAL TRAUMA field (FILE 790, Field #.27)
"RTN","WV14PST",126,0)
 N DA,DIK
"RTN","WV14PST",127,0)
 S DIK="^DD(790,",DA=.27,DA(1)=790
"RTN","WV14PST",128,0)
 D ^DIK
"RTN","WV14PST",129,0)
 Q
"RTN","WV14PST1")
0^2^B37673901
"RTN","WV14PST1",1,0)
WV14PST1 ;HCIOFO/FT-WV*1*14/Print Sexual Trauma Data Transfer to DG MST Module (cont.) ;4/3/01  16:11
"RTN","WV14PST1",2,0)
 ;;1.0;WOMEN'S HEALTH;**14**;Sep 30, 1998
"RTN","WV14PST1",3,0)
 ;
"RTN","WV14PST1",4,0)
EMAIL ; Create report in mail message
"RTN","WV14PST1",5,0)
 S WVDASHES=$$REPEAT^XLFSTR("-",79) ;line of dashes
"RTN","WV14PST1",6,0)
 S WVSPACES=$$REPEAT^XLFSTR(" ",79) ;line of spaces
"RTN","WV14PST1",7,0)
 S WVDATE=$$FMTE^XLFDT($$NOW^XLFDT(),"2") ;current date & time
"RTN","WV14PST1",8,0)
 S WVUSER=$$PERSON^WVUTL1(DUZ) ;user's name
"RTN","WV14PST1",9,0)
 D INTRO
"RTN","WV14PST1",10,0)
 D HDRY
"RTN","WV14PST1",11,0)
 I '$D(^TMP($J,"WVYES")) D NONEY
"RTN","WV14PST1",12,0)
 I $D(^TMP($J,"WVYES")) D YES
"RTN","WV14PST1",13,0)
 D HDRN
"RTN","WV14PST1",14,0)
 I '$D(^TMP($J,"WVNO")) D NONEN
"RTN","WV14PST1",15,0)
 I $D(^TMP($J,"WVNO")) D NO
"RTN","WV14PST1",16,0)
 D SEND
"RTN","WV14PST1",17,0)
 Q
"RTN","WV14PST1",18,0)
HDRY ; header for entries added to MST
"RTN","WV14PST1",19,0)
 S ^TMP($J,"WVMSG",+$$LINE())=" "
"RTN","WV14PST1",20,0)
 S ^TMP($J,"WVMSG",+$$LINE())="Patient Data Added to MST Module"
"RTN","WV14PST1",21,0)
 S ^TMP($J,"WVMSG",+$$LINE())="Report Run by: "_WVUSER
"RTN","WV14PST1",22,0)
 S ^TMP($J,"WVMSG",+$$LINE())="     Run Date: "_WVDATE
"RTN","WV14PST1",23,0)
 S ^TMP($J,"WVMSG",+$$LINE())=$$FILLER(55,0)_"DETERMINING"
"RTN","WV14PST1",24,0)
 S WVX="  PATIENT"
"RTN","WV14PST1",25,0)
 S WVX=WVX_$$FILLER(34,$L(WVX))_"WH VALUE"
"RTN","WV14PST1",26,0)
 S WVX=WVX_$$FILLER(44,$L(WVX))_"MST VALUE"
"RTN","WV14PST1",27,0)
 S WVX=WVX_$$FILLER(55,$L(WVX))_"PROVIDER"
"RTN","WV14PST1",28,0)
 S ^TMP($J,"WVMSG",+$$LINE())=WVX
"RTN","WV14PST1",29,0)
 S ^TMP($J,"WVMSG",+$$LINE())=WVDASHES
"RTN","WV14PST1",30,0)
 Q
"RTN","WV14PST1",31,0)
HDRN ; header for entries not added to MST
"RTN","WV14PST1",32,0)
 S ^TMP($J,"WVMSG",+$$LINE())=" "
"RTN","WV14PST1",33,0)
 S ^TMP($J,"WVMSG",+$$LINE())=" "
"RTN","WV14PST1",34,0)
 S ^TMP($J,"WVMSG",+$$LINE())="Patient Data Not Added to MST Module"
"RTN","WV14PST1",35,0)
 S ^TMP($J,"WVMSG",+$$LINE())="Report Run by: "_WVUSER
"RTN","WV14PST1",36,0)
 S ^TMP($J,"WVMSG",+$$LINE())="     Run Date: "_WVDATE
"RTN","WV14PST1",37,0)
 S ^TMP($J,"WVMSG",+$$LINE())=" "
"RTN","WV14PST1",38,0)
 S WVX="  PATIENT"
"RTN","WV14PST1",39,0)
 S WVX=WVX_$$FILLER(34,$L(WVX))_"WH VALUE"
"RTN","WV14PST1",40,0)
 S WVX=WVX_$$FILLER(44,$L(WVX))_"REASON DATA NOT ADDED"
"RTN","WV14PST1",41,0)
 S ^TMP($J,"WVMSG",+$$LINE())=WVX
"RTN","WV14PST1",42,0)
 S ^TMP($J,"WVMSG",+$$LINE())=WVDASHES
"RTN","WV14PST1",43,0)
 Q
"RTN","WV14PST1",44,0)
NONEY ; no wh patient data was added to MST module
"RTN","WV14PST1",45,0)
 S ^TMP($J,"WVMSG",+$$LINE())="<No Women's Health patient data was added to the MST module>"
"RTN","WV14PST1",46,0)
 S ^TMP($J,"WVMSG",+$$LINE())="<of the Registration package.>"
"RTN","WV14PST1",47,0)
 Q
"RTN","WV14PST1",48,0)
NONEN ; no unsuccessful attempts to add MST data
"RTN","WV14PST1",49,0)
 S ^TMP($J,"WVMSG",+$$LINE())="<All Women's Health patient data that could be added to the MST>"
"RTN","WV14PST1",50,0)
 S ^TMP($J,"WVMSG",+$$LINE())="<module was added successfully.>"
"RTN","WV14PST1",51,0)
 Q
"RTN","WV14PST1",52,0)
YES ; List patient data successfully added to MST module
"RTN","WV14PST1",53,0)
 S (WVMGRN,WVMGRO)=""
"RTN","WV14PST1",54,0)
 F  S WVMGRN=$O(^TMP($J,"WVYES",WVMGRN)) Q:WVMGRN=""  S WVMGR=0 F  S WVMGR=$O(^TMP($J,"WVYES",WVMGRN,WVMGR)) Q:'WVMGR  D
"RTN","WV14PST1",55,0)
 .I WVMGRN'=WVMGRO S ^TMP($J,"WVMSG",+$$LINE())="CASE MGR: "_WVMGRN S WVMGRO=WVMGRN ;identify cm
"RTN","WV14PST1",56,0)
 .S WVNAME=""
"RTN","WV14PST1",57,0)
 .F  S WVNAME=$O(^TMP($J,"WVYES",WVMGRN,WVMGR,WVNAME)) Q:WVNAME=""  S WVDFN=0 F  S WVDFN=$O(^TMP($J,"WVYES",WVMGRN,WVMGR,WVNAME,WVDFN)) Q:'WVDFN  D
"RTN","WV14PST1",58,0)
 ..S WVNODE=^TMP($J,"WVYES",WVMGRN,WVMGR,WVNAME,WVDFN)
"RTN","WV14PST1",59,0)
 ..S WVST=$P(WVNODE,U,1),WVDGMST=$P(WVNODE,U,2),WVPROV=$P(WVNODE,U,3)
"RTN","WV14PST1",60,0)
 ..S WVSSN=$P(WVNODE,U,4)
"RTN","WV14PST1",61,0)
 ..S WVX="  "_WVNAME
"RTN","WV14PST1",62,0)
 ..S WVX=WVX_$$FILLER(34,$L(WVX))_WVST
"RTN","WV14PST1",63,0)
 ..S WVX=WVX_$$FILLER(44,$L(WVX))_WVDGMST
"RTN","WV14PST1",64,0)
 ..S WVX=WVX_$$FILLER(54,$L(WVX))_WVPROV
"RTN","WV14PST1",65,0)
 ..S ^TMP($J,"WVMSG",+$$LINE())=WVX
"RTN","WV14PST1",66,0)
 ..S ^TMP($J,"WVMSG",+$$LINE())="  ("_WVSSN_")"
"RTN","WV14PST1",67,0)
 ..Q
"RTN","WV14PST1",68,0)
 .Q
"RTN","WV14PST1",69,0)
 Q
"RTN","WV14PST1",70,0)
NO ; List patient data not added to MST module and reason it wasn't added
"RTN","WV14PST1",71,0)
 S (WVMGRN,WVMGRO)=""
"RTN","WV14PST1",72,0)
 F  S WVMGRN=$O(^TMP($J,"WVNO",WVMGRN)) Q:WVMGRN=""  S WVMGR=0 F  S WVMGR=$O(^TMP($J,"WVNO",WVMGRN,WVMGR)) Q:'WVMGR  D
"RTN","WV14PST1",73,0)
 .I WVMGRN'=WVMGRO D
"RTN","WV14PST1",74,0)
 ..S ^TMP($J,"WVMSG",+$$LINE())="CASE MGR: "_WVMGRN S WVMGRO=WVMGRN ;identify cm
"RTN","WV14PST1",75,0)
 .S WVNAME=""
"RTN","WV14PST1",76,0)
 .F  S WVNAME=$O(^TMP($J,"WVNO",WVMGRN,WVMGR,WVNAME)) Q:WVNAME=""  S WVDFN=0 F  S WVDFN=$O(^TMP($J,"WVNO",WVMGRN,WVMGR,WVNAME,WVDFN)) Q:'WVDFN  D
"RTN","WV14PST1",77,0)
 ..S WVNODE=^TMP($J,"WVNO",WVMGRN,WVMGR,WVNAME,WVDFN)
"RTN","WV14PST1",78,0)
 ..S WVST=$P(WVNODE,U,1),WVSSN=$P(WVNODE,U,4),WVREASON=$P(WVNODE,U,5)
"RTN","WV14PST1",79,0)
 ..S WVX="  "_WVNAME
"RTN","WV14PST1",80,0)
 ..S WVX=WVX_$$FILLER(34,$L(WVX))_WVST
"RTN","WV14PST1",81,0)
 ..S WVX=WVX_$$FILLER(44,$L(WVX))_WVREASON
"RTN","WV14PST1",82,0)
 ..S ^TMP($J,"WVMSG",+$$LINE())=WVX
"RTN","WV14PST1",83,0)
 ..S ^TMP($J,"WVMSG",+$$LINE())="  ("_WVSSN_")"
"RTN","WV14PST1",84,0)
 ..Q
"RTN","WV14PST1",85,0)
 .Q
"RTN","WV14PST1",86,0)
 Q
"RTN","WV14PST1",87,0)
LINE() ; Increment line counter by 1
"RTN","WV14PST1",88,0)
 S WVLINE=+$G(WVLINE)+1
"RTN","WV14PST1",89,0)
 Q WVLINE
"RTN","WV14PST1",90,0)
 ;
"RTN","WV14PST1",91,0)
FILLER(L,S) ; Returns the number of spaces desired.
"RTN","WV14PST1",92,0)
 ; L - larger number
"RTN","WV14PST1",93,0)
 ; S - smaller number
"RTN","WV14PST1",94,0)
 ; WVSPACES must be defined.
"RTN","WV14PST1",95,0)
 I '$D(WVSPACES) Q ""
"RTN","WV14PST1",96,0)
 Q $E(WVSPACES,1,L-S)
"RTN","WV14PST1",97,0)
 ;
"RTN","WV14PST1",98,0)
SEND ; Send mail message to case managers
"RTN","WV14PST1",99,0)
 S XMDUZ=.5 ;message sender
"RTN","WV14PST1",100,0)
 S XMSUB="Women's Health patch #14 installed"
"RTN","WV14PST1",101,0)
 S XMTEXT="^TMP($J,""WVMSG"","
"RTN","WV14PST1",102,0)
 D ^XMD
"RTN","WV14PST1",103,0)
 Q
"RTN","WV14PST1",104,0)
INTRO ; Set message introduction text
"RTN","WV14PST1",105,0)
 S ^TMP($J,"WVMSG",+$$LINE())="Patch WV*1*14 for the Women's Health (WH) package was installed. This patch"
"RTN","WV14PST1",106,0)
 S ^TMP($J,"WVMSG",+$$LINE())="modifies the way the WH package stores and retrieves Military Sexual Trauma"
"RTN","WV14PST1",107,0)
 S ^TMP($J,"WVMSG",+$$LINE())="(MST) data. MST data that was stored in the WH package is now stored in the"
"RTN","WV14PST1",108,0)
 S ^TMP($J,"WVMSG",+$$LINE())="Registration package. This message identifies WH patients whose MST data was"
"RTN","WV14PST1",109,0)
 S ^TMP($J,"WVMSG",+$$LINE())="successfully added to the Registration package and those WH patients whose"
"RTN","WV14PST1",110,0)
 S ^TMP($J,"WVMSG",+$$LINE())="MST data could not be added to the Registration package. If the patient's"
"RTN","WV14PST1",111,0)
 S ^TMP($J,"WVMSG",+$$LINE())="WH sexual trauma status matched the MST status in the Registration package,"
"RTN","WV14PST1",112,0)
 S ^TMP($J,"WVMSG",+$$LINE())="then no additional entry was made in the Registration package. MST data was"
"RTN","WV14PST1",113,0)
 S ^TMP($J,"WVMSG",+$$LINE())="transferred to the Registration package for veterans only. All MST data"
"RTN","WV14PST1",114,0)
 S ^TMP($J,"WVMSG",+$$LINE())="has been deleted from the WH package. Civilian Sexual Trauma (CST) data"
"RTN","WV14PST1",115,0)
 S ^TMP($J,"WVMSG",+$$LINE())="continues to be stored in the WH package."
"RTN","WV14PST1",116,0)
 S ^TMP($J,"WVMSG",+$$LINE())=" "
"RTN","WV14PST1",117,0)
 S ^TMP($J,"WVMSG",+$$LINE())="To see what other changes were made to the WH reports and displays, please"
"RTN","WV14PST1",118,0)
 S ^TMP($J,"WVMSG",+$$LINE())="contact your IRMS support person for the WH User Manual changes concerning"
"RTN","WV14PST1",119,0)
 S ^TMP($J,"WVMSG",+$$LINE())="this patch."
"RTN","WV14PST1",120,0)
 Q
"RTN","WVMST")
1^12
"RTN","WVMST1")
1^13
"RTN","WVMSTL")
0^14^B16285914
"RTN","WVMSTL",1,0)
WVMSTL ;HCIOFO/FT-List WH Sexual Trauma Data ;3/27/01  11:12
"RTN","WVMSTL",2,0)
 ;;1.0;WOMEN'S HEALTH;**11,14**;Sep 30, 1998
"RTN","WVMSTL",3,0)
 ;
"RTN","WVMSTL",4,0)
 ; This routine uses the following IAs:
"RTN","WVMSTL",5,0)
 ; #2716 - $$GETSTAT^DGMSTAPI (supported)
"RTN","WVMSTL",6,0)
 ;
"RTN","WVMSTL",7,0)
BEGIN ;EP
"RTN","WVMSTL",8,0)
 S WVE="",(WVMGR,WVPOP)=0
"RTN","WVMSTL",9,0)
 D CMGR G:WVPOP EXIT
"RTN","WVMSTL",10,0)
 D DEVICE G:WVPOP EXIT
"RTN","WVMSTL",11,0)
 D START
"RTN","WVMSTL",12,0)
EXIT ; Exit and clean up
"RTN","WVMSTL",13,0)
 K ^TMP($J)
"RTN","WVMSTL",14,0)
 D ^%ZISC
"RTN","WVMSTL",15,0)
 K DIR,DIRUT,DIROUT,DTOUT,DUOUT
"RTN","WVMSTL",16,0)
 K WVCRT,WVCST,WVDATE,WVDFN,WVDG,WVDGMST,WVDGMSTC,WVE,WVEC,WVLINE,WVLINL,WVMGR,WVMGRN,WVMGRO,WVMSTN,WVNAME
"RTN","WVMSTL",17,0)
 K WVNODE,WVPAGE,WVPOP,WVPROV,WVSORT,WVSSN,WVST,WVSV,WVTAB,WVTITLE,WVUSER,WVVET,WVZSTOP
"RTN","WVMSTL",18,0)
 K X,Y,ZTQUEUED,ZTREQ,ZTRTN,ZTSAVE
"RTN","WVMSTL",19,0)
 Q
"RTN","WVMSTL",20,0)
CMGR ;EP
"RTN","WVMSTL",21,0)
 ;---> SELECT ONE CASE MANAGER OR ALL.
"RTN","WVMSTL",22,0)
 W !!?3,"Show data for all patients for ONE particular Case Manager,"
"RTN","WVMSTL",23,0)
 W !?3,"or all patients for ALL Case Managers?"
"RTN","WVMSTL",24,0)
 N DIR,DIRUT,Y
"RTN","WVMSTL",25,0)
 S DIR("A")="   Select ONE or ALL: ",DIR("B")="ONE",WVMGR=""
"RTN","WVMSTL",26,0)
 S DIR(0)="SAM^o:ONE;a:ALL" D HELP1^WVMSTL
"RTN","WVMSTL",27,0)
 D ^DIR K DIR
"RTN","WVMSTL",28,0)
 I Y=-1!($D(DIRUT)) S WVPOP=1 Q
"RTN","WVMSTL",29,0)
 ;---> IF ALL CASE MANAGERS, S WVE=1 AND QUIT.
"RTN","WVMSTL",30,0)
 I Y="a" S WVE=1 Q
"RTN","WVMSTL",31,0)
 D DIC^WVFMAN(790.01,"QEMA",.Y,"   Select CASE MANAGER: ")
"RTN","WVMSTL",32,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVMSTL",33,0)
 ;---> FOR ONE CASE MANAGER, SET WVE=0 AND WVMGR=^VA(200 DFN, QUIT.
"RTN","WVMSTL",34,0)
 S WVMGR=+Y,WVE=0
"RTN","WVMSTL",35,0)
 Q
"RTN","WVMSTL",36,0)
DEVICE ;EP
"RTN","WVMSTL",37,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVMSTL",38,0)
 S ZTRTN="DEQUEUE^WVMSTL"
"RTN","WVMSTL",39,0)
 S ZTDESC="List Sexual Trauma Data"
"RTN","WVMSTL",40,0)
 F WVSV="E","MGR" D
"RTN","WVMSTL",41,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVMSTL",42,0)
 D ZIS^WVUTL2(.WVPOP,1,"HOME")
"RTN","WVMSTL",43,0)
 Q
"RTN","WVMSTL",44,0)
START ; Start data gathering
"RTN","WVMSTL",45,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVMSTL",46,0)
 K ^TMP($J)
"RTN","WVMSTL",47,0)
 Q:$G(WVE)=""
"RTN","WVMSTL",48,0)
 S (WVDFN,WVZSTOP)=0
"RTN","WVMSTL",49,0)
 ; all case managers
"RTN","WVMSTL",50,0)
 I WVE=1 F  S WVDFN=$O(^WV(790,WVDFN)) Q:'WVDFN!($G(ZTSTOP)=1)  D SET
"RTN","WVMSTL",51,0)
 ; one case manager
"RTN","WVMSTL",52,0)
 I WVE=0,WVMGR F  S WVDFN=$O(^WV(790,"C",WVMGR,WVDFN)) Q:'WVDFN!($G(ZTSTOP)=1)  D SET
"RTN","WVMSTL",53,0)
 Q:$G(ZTSTOP)=1
"RTN","WVMSTL",54,0)
 D PRINT^WVMSTL1
"RTN","WVMSTL",55,0)
 Q
"RTN","WVMSTL",56,0)
SET ; Set temp global
"RTN","WVMSTL",57,0)
 S WVZSTOP=WVZSTOP+1
"RTN","WVMSTL",58,0)
 ; if a background task, check if user requested to stop the task 
"RTN","WVMSTL",59,0)
 I $D(ZTQUEUED),WVZSTOP#100=0 D STOPCHK^WVUTL10(0) Q:$G(ZTSTOP)=1
"RTN","WVMSTL",60,0)
 Q:$$DECEASED^WVUTL1(WVDFN)  ;deceased
"RTN","WVMSTL",61,0)
 S WVNODE=$G(^WV(790,WVDFN,0)) Q:WVNODE=""
"RTN","WVMSTL",62,0)
 I $P(WVNODE,U,24)>0,$P(WVNODE,U,24)<DT Q  ;inactive date before today
"RTN","WVMSTL",63,0)
 S WVVET=$$VET^WVUTL1A(WVDFN) ;veterans status
"RTN","WVMSTL",64,0)
 S WVEC=$$ELIG^WVUTL9(WVDFN),WVEC=$P(WVEC,U,2) ;primary eligibility code
"RTN","WVMSTL",65,0)
 S WVPROV=$$PROVI^WVUTL1A(WVDFN) ;primary provider
"RTN","WVMSTL",66,0)
 S WVMGR=$P(WVNODE,U,10) ;case manager ien
"RTN","WVMSTL",67,0)
 S WVDGMST="<N/A Not a Veteran>"
"RTN","WVMSTL",68,0)
 S WVDGMSTC=""
"RTN","WVMSTL",69,0)
 I $E(WVVET)="Y" D
"RTN","WVMSTL",70,0)
 .; $$GETSTAT^DGMSTAPI supported API - IA #2716
"RTN","WVMSTL",71,0)
 .S WVDGMST=$$GETSTAT^DGMSTAPI(WVDFN) ;get MST value from Registration
"RTN","WVMSTL",72,0)
 .S WVDGMSTC=$P(WVDGMST,U,2) ;mst status code
"RTN","WVMSTL",73,0)
 .S WVDGMST=$P(WVDGMST,U,6) ;mst status text
"RTN","WVMSTL",74,0)
 .S:WVDGMST="" WVDGMST="Unknown, not screened"
"RTN","WVMSTL",75,0)
 .Q
"RTN","WVMSTL",76,0)
 S WVMSTN=$S(WVDGMSTC="Y":1,WVDGMSTC="N":2,WVDGMSTC="D":3,WVDGMSTC="U":4,1:5)
"RTN","WVMSTL",77,0)
 S WVMGRN=$$PERSON^WVUTL1(WVMGR) ;case manager name
"RTN","WVMSTL",78,0)
 S WVNAME=$$NAME^WVUTL1(WVDFN) ;patient name
"RTN","WVMSTL",79,0)
 S WVSSN=$$SSN^WVUTL1(WVDFN) ;patient ssn
"RTN","WVMSTL",80,0)
 S WVCST=$$CST^WVUTL1A(WVDFN) ;Civilian Sexual Trauma
"RTN","WVMSTL",81,0)
 S:WVCST="" WVCST="<no value>"
"RTN","WVMSTL",82,0)
 S:'$D(WVDG(WVMSTN)) WVDG(WVMSTN)=WVDGMST
"RTN","WVMSTL",83,0)
 S ^TMP($J,"WVST",WVMGRN,WVMGR,WVMSTN,WVNAME,WVDFN)=WVSSN_U_WVPROV_U_WVVET_U_WVEC_U_WVCST_U_WVDGMST
"RTN","WVMSTL",84,0)
 Q
"RTN","WVMSTL",85,0)
DEQUEUE ; WVE and WVMGR variables must be set.
"RTN","WVMSTL",86,0)
 D START,EXIT
"RTN","WVMSTL",87,0)
 Q
"RTN","WVMSTL",88,0)
HELP1 ;EP
"RTN","WVMSTL",89,0)
 ;;Answer "ONE" to list patients for ONE particular Case Manager.
"RTN","WVMSTL",90,0)
 ;;Answer "ALL" to list patients for ALL Case Managers.
"RTN","WVMSTL",91,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVMSTL",92,0)
 Q
"RTN","WVMSTL",93,0)
HELPTX ;EP
"RTN","WVMSTL",94,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVMSTL",95,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVMSTL",96,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVMSTL",97,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVMSTL",98,0)
 Q
"RTN","WVMSTL1")
0^15^B7801554
"RTN","WVMSTL1",1,0)
WVMSTL1 ;HCIOFO/FT-List Sexual Trauma Data (cont.) ;2/16/01  16:07
"RTN","WVMSTL1",2,0)
 ;;1.0;WOMEN'S HEALTH;**11,14**;Sep 30, 1998
"RTN","WVMSTL1",3,0)
 ;
"RTN","WVMSTL1",4,0)
PRINT ; Print list
"RTN","WVMSTL1",5,0)
 U IO
"RTN","WVMSTL1",6,0)
 S WVLINE=$$REPEAT^XLFSTR("-",79),(WVPAGE,WVPOP)=0
"RTN","WVMSTL1",7,0)
 S WVDATE=$$FMTE^XLFDT($$NOW^XLFDT(),"2")
"RTN","WVMSTL1",8,0)
 S WVUSER=$$PERSON^WVUTL1(DUZ),WVSORT=$S(WVE=0:"ONE",1:"ALL")
"RTN","WVMSTL1",9,0)
 S WVTITLE="* LIST SEXUAL TRAUMA DATA *"
"RTN","WVMSTL1",10,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVMSTL1",11,0)
 S WVTAB=$L(WVTITLE),WVTAB=(80-WVTAB)\2
"RTN","WVMSTL1",12,0)
 I '$D(^TMP($J,"WVST")) D HDR Q:WVPOP  D NODATA
"RTN","WVMSTL1",13,0)
 I $D(^TMP($J,"WVST")) D HDR Q:WVPOP  D DATA
"RTN","WVMSTL1",14,0)
 I WVCRT&('$D(IO("S"))) D:'WVPOP DIRZ^WVUTL3 W @IOF
"RTN","WVMSTL1",15,0)
 Q
"RTN","WVMSTL1",16,0)
HDR ; Report header
"RTN","WVMSTL1",17,0)
 W:$Y>0 @IOF
"RTN","WVMSTL1",18,0)
 S WVPAGE=WVPAGE+1
"RTN","WVMSTL1",19,0)
 W !,?WVTAB,WVTITLE
"RTN","WVMSTL1",20,0)
 W !,"Report Run by: "_WVUSER,?50,"    Page: "_WVPAGE
"RTN","WVMSTL1",21,0)
 W !,"Case Mgr Sort: "_WVSORT,?50,"Run Date: "_WVDATE
"RTN","WVMSTL1",22,0)
 W !!,"SSN",?14,"PATIENT",?41,"MST & CST VALUES"
"RTN","WVMSTL1",23,0)
 W !,WVLINE
"RTN","WVMSTL1",24,0)
 I $D(ZTQUEUED) D STOPCHK^WVUTL10(1) D  ;stop background task?
"RTN","WVMSTL1",25,0)
 .S:$G(ZTSTOP)=1 WVPOP=1
"RTN","WVMSTL1",26,0)
 .Q
"RTN","WVMSTL1",27,0)
 Q
"RTN","WVMSTL1",28,0)
NODATA ; no wh patient data found
"RTN","WVMSTL1",29,0)
 W !,"<No patient data was found.>",!
"RTN","WVMSTL1",30,0)
 Q
"RTN","WVMSTL1",31,0)
DATA ; Loop through TMP global
"RTN","WVMSTL1",32,0)
 S (WVMGRN,WVMGRO)=""
"RTN","WVMSTL1",33,0)
 F  S WVMGRN=$O(^TMP($J,"WVST",WVMGRN)) Q:WVMGRN=""!(WVPOP)  S WVMGR=0 F  S WVMGR=$O(^TMP($J,"WVST",WVMGRN,WVMGR)) Q:'WVMGR!(WVPOP)  D
"RTN","WVMSTL1",34,0)
 .I WVMGRN'=WVMGRO D
"RTN","WVMSTL1",35,0)
 ..W:WVMGRO="" !! ;first cm
"RTN","WVMSTL1",36,0)
 ..W:WVMGRO]"" !!! ;subsequent cms
"RTN","WVMSTL1",37,0)
 ..W "CASE MGR: "_WVMGRN
"RTN","WVMSTL1",38,0)
 ..S WVMGRO=WVMGRN ;identify cm
"RTN","WVMSTL1",39,0)
 ..Q
"RTN","WVMSTL1",40,0)
 .S WVMSTN=0
"RTN","WVMSTL1",41,0)
 .F  S WVMSTN=$O(^TMP($J,"WVST",WVMGRN,WVMGR,WVMSTN)) Q:'WVMSTN  D
"RTN","WVMSTL1",42,0)
 ..S WVNAME=""
"RTN","WVMSTL1",43,0)
 ..F  S WVNAME=$O(^TMP($J,"WVST",WVMGRN,WVMGR,WVMSTN,WVNAME)) Q:WVNAME=""!(WVPOP)  S WVDFN=0 F  S WVDFN=$O(^TMP($J,"WVST",WVMGRN,WVMGR,WVMSTN,WVNAME,WVDFN)) Q:'WVDFN!(WVPOP)  D
"RTN","WVMSTL1",44,0)
 ...I ($Y+6)>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HDR Q:WVPOP
"RTN","WVMSTL1",45,0)
 ...S WVNODE=^TMP($J,"WVST",WVMGRN,WVMGR,WVMSTN,WVNAME,WVDFN)
"RTN","WVMSTL1",46,0)
 ...S WVSSN=$P(WVNODE,U,1),WVPROV=$P(WVNODE,U,2),WVVET=$P(WVNODE,U,3)
"RTN","WVMSTL1",47,0)
 ...S WVEC=$P(WVNODE,U,4),WVCST=$P(WVNODE,U,5),WVDGMST=$P(WVNODE,U,6)
"RTN","WVMSTL1",48,0)
 ...W !!,WVSSN,?14,WVNAME,?41,"MST= "_WVDGMST
"RTN","WVMSTL1",49,0)
 ...W !,"Pr. Provider => "_WVPROV,?41,"CST= "_WVCST
"RTN","WVMSTL1",50,0)
 ...W !,"Age: "_$$AGE^WVUTL9(WVDFN)_" / Veteran: "_WVVET_" / Eligibility: "_WVEC
"RTN","WVMSTL1",51,0)
 ...Q
"RTN","WVMSTL1",52,0)
 ..Q
"RTN","WVMSTL1",53,0)
 .Q
"RTN","WVMSTL1",54,0)
 Q
"RTN","WVPATE")
0^5^B7871612
"RTN","WVPATE",1,0)
WVPATE ;HCIOFO/FT,JR-PATIENT CASE DATA EDIT; ;4/3/01  13:13
"RTN","WVPATE",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,13,14**;Sep 30, 1998
"RTN","WVPATE",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVPATE",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPATE",5,0)
 ;;  CALLED BY OPTION: "WV EDIT PATIENT CASE DATA".
"RTN","WVPATE",6,0)
 ;
"RTN","WVPATE",7,0)
 ; This routine uses the following IAs:
"RTN","WVPATE",8,0)
 ; #1625 - $$GET^XUA4A72      (supported)
"RTN","WVPATE",9,0)
 ;
"RTN","WVPATE",10,0)
 D SETVARS^WVUTL5
"RTN","WVPATE",11,0)
 F  D PATIENT Q:WVPOP
"RTN","WVPATE",12,0)
 ;
"RTN","WVPATE",13,0)
EXIT ;EP
"RTN","WVPATE",14,0)
 D KILLALL^WVUTL8
"RTN","WVPATE",15,0)
 Q
"RTN","WVPATE",16,0)
 ;
"RTN","WVPATE",17,0)
 ;
"RTN","WVPATE",18,0)
PATIENT ;EP
"RTN","WVPATE",19,0)
 D TITLE^WVUTL5("EDIT PATIENT CASE DATA")
"RTN","WVPATE",20,0)
PATIENT1 ;EP
"RTN","WVPATE",21,0)
 ;---> TO AVOID @IOF AND TITLE.
"RTN","WVPATE",22,0)
 ;---> SELECT PATIENT.
"RTN","WVPATE",23,0)
 ; Quit if no default case manager
"RTN","WVPATE",24,0)
 I '$$DCM^WVUTL9(DUZ(2)) D NODCM^WVUTL9 S WVPOP=1 Q
"RTN","WVPATE",25,0)
 N Y
"RTN","WVPATE",26,0)
 W !!,"   Select the patient you wish to add or edit."
"RTN","WVPATE",27,0)
 D PATLKUP^WVUTL8(.Y,"ADD")
"RTN","WVPATE",28,0)
 I Y<0 S WVPOP=1 Q
"RTN","WVPATE",29,0)
 S WVDFN=+Y
"RTN","WVPATE",30,0)
 D SCREEN(WVDFN) S WVPOP=0
"RTN","WVPATE",31,0)
 Q
"RTN","WVPATE",32,0)
 ;
"RTN","WVPATE",33,0)
 ;
"RTN","WVPATE",34,0)
SCREEN(WVDFN) ;EP
"RTN","WVPATE",35,0)
 ;---> EDIT PATIENT CASE DATA WITH SCREENMAN.
"RTN","WVPATE",36,0)
 ;---> REQUIRED VARIABLES: WVDFN=DFN OF PATIENT.
"RTN","WVPATE",37,0)
 I '$P($G(^WV(790,WVDFN,0)),U,10) D STUFF
"RTN","WVPATE",38,0)
 N DR
"RTN","WVPATE",39,0)
 S DR="[WV PATIENT-FORM-1]"
"RTN","WVPATE",40,0)
 D DDS^WVFMAN(790,DR,WVDFN,"","",.WVPOP)
"RTN","WVPATE",41,0)
 N DIR W !,"Do you wish to PRINT this patient's Case Data?"
"RTN","WVPATE",42,0)
 S DIR(0)="Y",DIR("B")="NO" D ^DIR K DIR W !
"RTN","WVPATE",43,0)
 D:Y PRTCASE^WVPATP(WVDFN)
"RTN","WVPATE",44,0)
 Q
"RTN","WVPATE",45,0)
 ;
"RTN","WVPATE",46,0)
CASEDATA(WVDFN) ;EP
"RTN","WVPATE",47,0)
 ;---> CALLED AFTER ADD/EDIT OF NOTIFICATIONS.
"RTN","WVPATE",48,0)
 N DIR W !,"Do you wish to EDIT this patient's Case Data?"
"RTN","WVPATE",49,0)
 S DIR("?",1)="   Enter YES to edit this patient's Case Manager, "
"RTN","WVPATE",50,0)
 S DIR("?")="   PAP Regimen, Current Need, etc."
"RTN","WVPATE",51,0)
 S DIR(0)="Y",DIR("B")="NO" D ^DIR K DIR W !
"RTN","WVPATE",52,0)
 D:Y SCREEN(WVDFN)
"RTN","WVPATE",53,0)
 Q
"RTN","WVPATE",54,0)
 ;
"RTN","WVPATE",55,0)
AUTOADD(DFN,SITE,Y,WVPRMT) ;EP
"RTN","WVPATE",56,0)
 ;---> AUTOMATIC ADD OF A NEW PATIENT TO "WV PATIENT FILE".
"RTN","WVPATE",57,0)
 ;---> SET CASEMANAGER TO SITE PARAMETER DEFAULT.
"RTN","WVPATE",58,0)
 ;---> SET PAP TX NEED (#.11), PAP REGIMEN (#.16)="Undetermined",
"RTN","WVPATE",59,0)
 ;---> MAM TX NEED (#.18)="Undetermined".
"RTN","WVPATE",60,0)
 ;---> PARAMETERS:
"RTN","WVPATE",61,0)
 ;     1 - DFN     (REQUIRED) IEN OF PATIENT IN ^DPT(
"RTN","WVPATE",62,0)
 ;     2 - SITE    (REQUIRED) DUZ(2) FOR DEFAULT CASE MANAGER
"RTN","WVPATE",63,0)
 ;     3 - Y       (RETURNED) FROM ^DICN: IEN OR -1 FAILURE TO ADD PT
"RTN","WVPATE",64,0)
 ;     4 - WVPRMT  (OPTIONAL) EQUALS 1 IF PROMPT WHEN FAILURE
"RTN","WVPATE",65,0)
 ;
"RTN","WVPATE",66,0)
 ;---> SET CASE MANAGER DEFAULT.
"RTN","WVPATE",67,0)
 N WVCMGR,DIC S WVCMGR=$S($D(SITE):$P(^WV(790.02,SITE,0),U,2),1:"")
"RTN","WVPATE",68,0)
 S:'$G(WVPRMT) WVPRMT=0
"RTN","WVPATE",69,0)
 S DIC("DR")=".1////"_WVCMGR_";.11///Undetermined;.16///Undetermined"
"RTN","WVPATE",70,0)
 S DIC("DR")=DIC("DR")_";.18///Undetermined"
"RTN","WVPATE",71,0)
 S DIC("DR")=DIC("DR")_";.21////"_DT
"RTN","WVPATE",72,0)
 S (DINUM,X)=DFN
"RTN","WVPATE",73,0)
 K DD,DO S DIC="^WV(790,",DIC(0)="ML",DLAYGO=790
"RTN","WVPATE",74,0)
 D FILE^DICN K DIC
"RTN","WVPATE",75,0)
 ;---> IF Y<0, CHECK PERMISSIONS.
"RTN","WVPATE",76,0)
 I Y<0,WVPRMT D  Q
"RTN","WVPATE",77,0)
 .W !!?5,"* UNABLE to add this patient to the Women's Health database."
"RTN","WVPATE",78,0)
 .W !?5,"  Please contact your site manager to check permissions."
"RTN","WVPATE",79,0)
 .D DIRZ^WVUTL3
"RTN","WVPATE",80,0)
 S Y=+Y
"RTN","WVPATE",81,0)
 Q
"RTN","WVPATE",82,0)
 ;
"RTN","WVPATE",83,0)
STUFF ; Stuff case manager if none
"RTN","WVPATE",84,0)
 Q:'+$G(WVDFN)
"RTN","WVPATE",85,0)
 Q:'+$G(DUZ(2))
"RTN","WVPATE",86,0)
 S $P(^WV(790,WVDFN,0),U,10)=$P($G(^WV(790.02,DUZ(2),0)),U,2)
"RTN","WVPATE",87,0)
 Q
"RTN","WVPATP")
0^11^B20379343
"RTN","WVPATP",1,0)
WVPATP ;HCIOFO/FT,JR-Print WH Patient Case Data ;4/2/01  09:24
"RTN","WVPATP",2,0)
 ;;1.0;WOMEN'S HEALTH;**10,14**;Sep 30, 1998
"RTN","WVPATP",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVPATP",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPATP",5,0)
 ;;  PRINT A PATIENT'S CASE DATA.
"RTN","WVPATP",6,0)
 ;
"RTN","WVPATP",7,0)
BEGIN ;EP
"RTN","WVPATP",8,0)
 ;---> LOOP TO PRINT PATIENTS' CASE DATA.
"RTN","WVPATP",9,0)
 ;---> NOT CURRENTLY CALLED BY ANY OPTION.
"RTN","WVPATP",10,0)
 D SETVARS^WVUTL5 S WVPOP=0
"RTN","WVPATP",11,0)
 F  D  Q:$G(Y)<0
"RTN","WVPATP",12,0)
 .D TITLE^WVUTL5("PRINT A PATIENT'S CASE DATA")
"RTN","WVPATP",13,0)
 .D PATLKUP^WVUTL8(.Y) Q:Y<0  S WVDFN=+Y
"RTN","WVPATP",14,0)
 .D DEVICE
"RTN","WVPATP",15,0)
 .I WVPOP S Y=-1 Q
"RTN","WVPATP",16,0)
 .D DATA(WVDFN)
"RTN","WVPATP",17,0)
 D EXIT
"RTN","WVPATP",18,0)
 Q
"RTN","WVPATP",19,0)
 ;
"RTN","WVPATP",20,0)
PRTCASE(WVDFN) ;EP
"RTN","WVPATP",21,0)
 ;---> PRINT CASE DATA ON ONE PATIENT.
"RTN","WVPATP",22,0)
 ;---> CALLED FROM ^WVPATE (EDIT PATIENT CASE DATA).
"RTN","WVPATP",23,0)
 I '$G(WVDFN) D  D DIRZ^WVUTL3 Q
"RTN","WVPATP",24,0)
 .W !?5,"WVDFN not passed.  Please contact your site manager."
"RTN","WVPATP",25,0)
 D DEVICE Q:WVPOP
"RTN","WVPATP",26,0)
 D DATA(WVDFN)
"RTN","WVPATP",27,0)
 Q
"RTN","WVPATP",28,0)
 ;
"RTN","WVPATP",29,0)
DEVICE ;EP
"RTN","WVPATP",30,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVPATP",31,0)
 S ZTRTN="DEQUEUE^WVPATP"
"RTN","WVPATP",32,0)
 F WVSV="DFN" D
"RTN","WVPATP",33,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVPATP",34,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVPATP",35,0)
 Q
"RTN","WVPATP",36,0)
 ;
"RTN","WVPATP",37,0)
DEQUEUE ;EP
"RTN","WVPATP",38,0)
 ;---> TASKED PRINTOUT OF PATIENT CASE DATA.
"RTN","WVPATP",39,0)
 D DATA(WVDFN)
"RTN","WVPATP",40,0)
 D EXIT
"RTN","WVPATP",41,0)
 Q
"RTN","WVPATP",42,0)
 ;
"RTN","WVPATP",43,0)
DATA(WVDFN) ;EP
"RTN","WVPATP",44,0)
 ;---> SORT PROCEDURE TYPE FILE POINTERS.
"RTN","WVPATP",45,0)
 N A,WVNODE,WVTMP,I,N
"RTN","WVPATP",46,0)
 D PATVARS^WVUTL3(WVDFN)
"RTN","WVPATP",47,0)
 ;---> LOOP THROUGH WV PROCEDURE FILE.
"RTN","WVPATP",48,0)
 S I=0
"RTN","WVPATP",49,0)
 S A=WVNAMAGE
"RTN","WVPATP",50,0)
 S WVNODE="Patient Name: "_A_$$S(38-$L(A))_$$PNLAB^WVUTL5()_WVCHRT
"RTN","WVPATP",51,0)
 D NODE
"RTN","WVPATP",52,0)
 S A=$$STREET^WVUTL1(WVDFN)
"RTN","WVPATP",53,0)
 S WVNODE=$$S(6)_"Street: "_A_$$S(31-$L(A))
"RTN","WVPATP",54,0)
 S WVNODE=WVNODE_"Patient Phone: "_$$HPHONE^WVUTL1(WVDFN)
"RTN","WVPATP",55,0)
 D NODE
"RTN","WVPATP",56,0)
 S A=$$CTYSTZ^WVUTL1(WVDFN)
"RTN","WVPATP",57,0)
 S WVNODE=$$S(2)_"Cty/St/Zip: "_A_$$S(33-$L(A))
"RTN","WVPATP",58,0)
 S WVNODE=WVNODE_"Pr Provider: "_$E($$PROVI^WVUTL1A(WVDFN),1,20)
"RTN","WVPATP",59,0)
 D NODE
"RTN","WVPATP",60,0)
 S WVNODE="   Elig Code: "_$P($$ELIG^WVUTL9(WVDFN),U,2)
"RTN","WVPATP",61,0)
 S WVNODE=WVNODE_$$S(51-$L(WVNODE))_"Veteran: "_$$VET^WVUTL1A(WVDFN)
"RTN","WVPATP",62,0)
 D NODE
"RTN","WVPATP",63,0)
 S WVNODE="         " D NODE
"RTN","WVPATP",64,0)
 S A=$E(WVCMGR,1,28)
"RTN","WVPATP",65,0)
 S WVNODE=$$S(10)_"Case Manager: "_A_$$S(29-$L(A))
"RTN","WVPATP",66,0)
 S WVNODE=WVNODE_"Inactive Date: "_$$SLDT2^WVUTL5($$INACT^WVUTL1(WVDFN))
"RTN","WVPATP",67,0)
 D NODE
"RTN","WVPATP",68,0)
 S WVNODE=$$S(8)_"Breast Tx Need: "_WVBNEED
"RTN","WVPATP",69,0)
 D NODE
"RTN","WVPATP",70,0)
 S A="" I WVDFN>0 S A=$P($G(^WV(790,WVDFN,0)),U,25),A=$S(A'="":A,1:"NOT ENTERED") S:A>0 A=$$INSTTX^WVUTL6(A)
"RTN","WVPATP",71,0)
 S WVNODE=$$S(7)_"Breast Facility: "_A
"RTN","WVPATP",72,0)
 D NODE
"RTN","WVPATP",73,0)
 S WVNODE=$$S(6)_"Cervical Tx Need: "_WVCNEED
"RTN","WVPATP",74,0)
 D NODE
"RTN","WVPATP",75,0)
 S A="" I WVDFN>0 S A=$P($G(^WV(790,WVDFN,0)),U,26) S A=$S(A'="":A,1:"NOT ENTERED") S:A>0 A=$$INSTTX^WVUTL6(A)
"RTN","WVPATP",76,0)
 S WVNODE=$$S(5)_"Cervical Facility: "_A
"RTN","WVPATP",77,0)
 D NODE
"RTN","WVPATP",78,0)
 S WVNODE=$$S(11)_"PAP Regimen: "_WVPAPRG
"RTN","WVPATP",79,0)
 D NODE S WVNODE=" " D NODE
"RTN","WVPATP",80,0)
 S WVNODE=$$S(0)_"Family Hx of Breast CA: "_$$FAMHX^WVUTL1(WVDFN)
"RTN","WVPATP",81,0)
 D NODE
"RTN","WVPATP",82,0)
 S A=$$EDC^WVUTL1(WVDFN)
"RTN","WVPATP",83,0)
 I A="",$P(^WV(790,WVDFN,0),U,13)=0 S A="NO"
"RTN","WVPATP",84,0)
 S WVNODE=$$S(3)_"Currently  Pregnant: "_A_$$S(32-$L(A))
"RTN","WVPATP",85,0)
 S WVNODE=WVNODE_"DES Daughter: "_$$DES^WVUTL1(WVDFN)
"RTN","WVPATP",86,0)
 D NODE
"RTN","WVPATP",87,0)
 S A=$$MST^WVUTL1A(WVDFN)
"RTN","WVPATP",88,0)
 S WVNODE=$$S(19)_"MST: "_A
"RTN","WVPATP",89,0)
 D NODE
"RTN","WVPATP",90,0)
 S A=$$CST^WVUTL1A(WVDFN)
"RTN","WVPATP",91,0)
 S WVNODE=$$S(19)_"CST: "_A
"RTN","WVPATP",92,0)
 D NODE
"RTN","WVPATP",93,0)
 S A=$$ENRLDT^WVUTL1(WVDFN)
"RTN","WVPATP",94,0)
 S WVNODE=$$S(1)_"Date of 1st Encounter: "_A_$$S(29-$L(A))
"RTN","WVPATP",95,0)
 S WVNODE=WVNODE_"Referral Source: "_$$REFS^WVUTL1(WVDFN)
"RTN","WVPATP",96,0)
 D NODE S WVNODE=" " D NODE
"RTN","WVPATP",97,0)
 S WVNODE=$$S(25)_"----  Text of NOTES  ----"
"RTN","WVPATP",98,0)
 D NODE S WVNODE=" " D NODE
"RTN","WVPATP",99,0)
 S N=0
"RTN","WVPATP",100,0)
 F  S N=$O(^WV(790,WVDFN,1,N)) Q:'N  D
"RTN","WVPATP",101,0)
 .S WVNODE=^WV(790,WVDFN,1,N,0) D NODE
"RTN","WVPATP",102,0)
 S WVNODE=" " D NODE
"RTN","WVPATP",103,0)
 S WVNODE=$$S(20)_"-----  End of Patient Printout  -----" D NODE
"RTN","WVPATP",104,0)
 D DISPLAY
"RTN","WVPATP",105,0)
 Q
"RTN","WVPATP",106,0)
 ;
"RTN","WVPATP",107,0)
NODE ;EP
"RTN","WVPATP",108,0)
 ;---> SET NODE.
"RTN","WVPATP",109,0)
 S I=I+1,WVTMP("WV",$J,I,0)=WVNODE
"RTN","WVPATP",110,0)
 Q
"RTN","WVPATP",111,0)
 ;
"RTN","WVPATP",112,0)
S(S) ;EP
"RTN","WVPATP",113,0)
 ;---> SPACES.
"RTN","WVPATP",114,0)
 Q $$S^WVUTL7($G(S))
"RTN","WVPATP",115,0)
 ;
"RTN","WVPATP",116,0)
DISPLAY ;EP
"RTN","WVPATP",117,0)
 U IO
"RTN","WVPATP",118,0)
 D TOPHEAD^WVUTL7
"RTN","WVPATP",119,0)
 S WVTITLE1="* * *  WOMEN'S HEALTH: PATIENT CASE DATA PRINTOUT  * * *"
"RTN","WVPATP",120,0)
 D CENTERT^WVUTL5(.WVTITLE1)
"RTN","WVPATP",121,0)
 ;
"RTN","WVPATP",122,0)
 S (WVPOP,N,Z)=0
"RTN","WVPATP",123,0)
 W:WVCRT @IOF D HEADER
"RTN","WVPATP",124,0)
 F  S N=$O(WVTMP("WV",$J,N)) Q:'N!(WVPOP)  D
"RTN","WVPATP",125,0)
 .I $Y+5>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D HEADER
"RTN","WVPATP",126,0)
 .W !,WVTMP("WV",$J,N,0)
"RTN","WVPATP",127,0)
 I WVCRT&('WVPOP) W !! D DIRZ^WVUTL3
"RTN","WVPATP",128,0)
 D ^%ZISC
"RTN","WVPATP",129,0)
 K WVTMP("WV",$J)
"RTN","WVPATP",130,0)
 Q
"RTN","WVPATP",131,0)
 ;
"RTN","WVPATP",132,0)
HEADER ;EP
"RTN","WVPATP",133,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVPATP",134,0)
 W WVCONFF W:'WVCRT !,WVTIMLN
"RTN","WVPATP",135,0)
 W !!,WVTITLE1,?70,"page: ",WVPAGE
"RTN","WVPATP",136,0)
 W !,$$RUNDT^WVUTL1A("C")
"RTN","WVPATP",137,0)
 W !,WVLINE S WVPAGE=WVPAGE+1
"RTN","WVPATP",138,0)
 ;W !!,"Patient Name: ",WVNAMAGE,?53,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVPATP",139,0)
 Q
"RTN","WVPATP",140,0)
 ;
"RTN","WVPATP",141,0)
EXIT ;EP
"RTN","WVPATP",142,0)
 D KILLALL^WVUTL8
"RTN","WVPATP",143,0)
 Q
"RTN","WVPROC1")
0^6^B5772282
"RTN","WVPROC1",1,0)
WVPROC1 ;HCIOFO/FT,JR IHS/ANMC/MWR - WV ADD/EDIT WV PROCEDURE; ;1/26/01  15:12
"RTN","WVPROC1",2,0)
 ;;1.0;WOMEN'S HEALTH;**14**;Sep 30, 1998
"RTN","WVPROC1",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVPROC1",4,0)
 ;;  EDIT A PROCEDURE, ALSO FOLLOW-UP SCREEN.  CALLED BY WVPROC.
"RTN","WVPROC1",5,0)
 ;
"RTN","WVPROC1",6,0)
 ;
"RTN","WVPROC1",7,0)
EDIT2(DA,WVPOP) ;EP
"RTN","WVPROC1",8,0)
 ;---> EDIT A PROCEDURE.
"RTN","WVPROC1",9,0)
 ;---> REQUIRED VARIABLES: DA=IEN IN ^WV(790.1,.
"RTN","WVPROC1",10,0)
 S WVPOP=0
"RTN","WVPROC1",11,0)
 I '$G(DA) D  D OUT^WVUTL3 Q
"RTN","WVPROC1",12,0)
 .W !,"NO PROCEDURE (DA).  PLEASE CONTACT YOUR SITE MANAGER."
"RTN","WVPROC1",13,0)
 I '$D(^WV(790.1,DA,0)) D  D OUT^WVUTL3 Q
"RTN","WVPROC1",14,0)
 .W !,"^WV(790.1, NOT DEFINED.  PLEASE CONTACT YOUR SITE MANAGER."
"RTN","WVPROC1",15,0)
 S WVDFN=$P(^WV(790.1,DA,0),U,2)
"RTN","WVPROC1",16,0)
 D SCREEN(DA,.WVPOP)
"RTN","WVPROC1",17,0)
 ;---> IF ENTRY WAS LOCKED, WVPOP=1.
"RTN","WVPROC1",18,0)
 Q:WVPOP
"RTN","WVPROC1",19,0)
 Q
"RTN","WVPROC1",20,0)
 ;
"RTN","WVPROC1",21,0)
SCREEN(DA,WVPOP) ;EP
"RTN","WVPROC1",22,0)
 ;---> EDIT A PROCEDURE WITH SCREENMAN.
"RTN","WVPROC1",23,0)
 ;---> REQUIRED VARIABLES: DA=IEN IN PROCEDURE FILE.
"RTN","WVPROC1",24,0)
 ;---> STORE OLD ZERO NODE VALUES IN WVOLD TO COMPARE FOR EDITS,
"RTN","WVPROC1",25,0)
 ;---> STORE OLD 2 NODE VALUES IN WVOLD2.
"RTN","WVPROC1",26,0)
 ;
"RTN","WVPROC1",27,0)
 N WVOLD,WVOLD2,WVPCDN,DDSFILE,DR,Y
"RTN","WVPROC1",28,0)
 S DDSFILE=790.1
"RTN","WVPROC1",29,0)
 S WVOLD=^WV(790.1,DA,0) S:$D(^(2)) WVOLD2=^WV(790.1,DA,2)
"RTN","WVPROC1",30,0)
 S WVPCDN=$P(WVOLD,U,4)
"RTN","WVPROC1",31,0)
 ;
"RTN","WVPROC1",32,0)
 ;---> SET DR=TO THE APPROPRIATE FORM.
"RTN","WVPROC1",33,0)
 D
"RTN","WVPROC1",34,0)
 .;---> IF THIS IS A COLPOSCOPY-TYPE PROCEDURE, USE FORM-2.
"RTN","WVPROC1",35,0)
 .I $$COLP^WVUTL4(DA) S DR="[WV PROC-FORM-2-COLP]" Q
"RTN","WVPROC1",36,0)
 .;
"RTN","WVPROC1",37,0)
 .;---> OTHERWISE, USE FORM 1 (ONLY PAGE 1).
"RTN","WVPROC1",38,0)
 .S DR="[WV PROC-FORM-1]"
"RTN","WVPROC1",39,0)
 ;
"RTN","WVPROC1",40,0)
 ;---> CALL SCREENMAN.
"RTN","WVPROC1",41,0)
 D DDS^WVFMAN(DDSFILE,DR,DA,"","",.WVPOP)
"RTN","WVPROC1",42,0)
 Q:WVPOP
"RTN","WVPROC1",43,0)
 Q
"RTN","WVPROC1",44,0)
 ;
"RTN","WVPROC1",45,0)
 ;
"RTN","WVPROC1",46,0)
FOLLOWUP(WVDA) ;EP
"RTN","WVPROC1",47,0)
 ;---> PROCEDURE FOLLOW-UP MENU.
"RTN","WVPROC1",48,0)
 ;---> REQUIRED VARIABLES: WVDA=IEN IN PROCEDURE FILE.
"RTN","WVPROC1",49,0)
 ;---> WVLOOP TELLS WVNOTIF (ADD NEW NOTIFICATION) NOT TO OFFER TO EDIT
"RTN","WVPROC1",50,0)
 ;---> CASE DATA, SINCE THAT OPTION IS ALREADY OFFERED IN THIS LOOP.
"RTN","WVPROC1",51,0)
 Q  ;dead code?
"RTN","WVPROC1",52,0)
 ;
"RTN","WVPROC1",53,0)
NORMAL ;EP
"RTN","WVPROC1",54,0)
 ;---> IF RESULT IS NORMAL, ASK TO QUEUE NORMAL PAP/MAM LETTER.
"RTN","WVPROC1",55,0)
 ;---> QUIT IF VARIABLES NOT ADEQUATE.
"RTN","WVPROC1",56,0)
 N DIR,DIRUT,WVSPEC,WVSPTX,X,Y
"RTN","WVPROC1",57,0)
 Q:'$G(WVPCDN)!('$G(WVRESN))!('$D(WVACCN))
"RTN","WVPROC1",58,0)
 ;
"RTN","WVPROC1",59,0)
 ;---> QUIT IF THE RESULT OF THIS PROCEDURE IS NOT NORMAL.
"RTN","WVPROC1",60,0)
 Q:$P(^WV(790.31,WVRESN,0),U,21)
"RTN","WVPROC1",61,0)
 ;
"RTN","WVPROC1",62,0)
 ;---> FOR PAP WVSPEC=1, FOR ANY TYPE OF MAM WVSPEC=2, OTHERWISE 0.
"RTN","WVPROC1",63,0)
 S WVSPEC=$S(WVPCDN=1:1,$$PMAM^WVUTL6(WVPCDN):2,1:0)
"RTN","WVPROC1",64,0)
 ;---> QUIT IF NOT A PAP OR MAM.
"RTN","WVPROC1",65,0)
 Q:'WVSPEC
"RTN","WVPROC1",66,0)
 ;
"RTN","WVPROC1",67,0)
 ;---> QUIT IF THIS IS PAP (OR MAM) AND "AUTOQUEUE NORMAL PAP (OR MAM)
"RTN","WVPROC1",68,0)
 ;---> LETTERS" IS SET TO "NO" IN THE SITE PARAMETERS.
"RTN","WVPROC1",69,0)
 Q:'$D(^WV(790.02,DUZ(2),0))
"RTN","WVPROC1",70,0)
 Q:WVSPEC=1&('$P(^WV(790.02,DUZ(2),0),U,3))
"RTN","WVPROC1",71,0)
 Q:WVSPEC=2&('$P(^WV(790.02,DUZ(2),0),U,7))
"RTN","WVPROC1",72,0)
 ;
"RTN","WVPROC1",73,0)
 ;---> QUIT IF ANY NOTIFICATION ALREADY EXISTS FOR THIS ACCESSION#.
"RTN","WVPROC1",74,0)
 I $D(^WV(790.4,"C",WVACCN)) Q  ;D  Q
"RTN","WVPROC1",75,0)
 ;.W !!
"RTN","WVPROC1",76,0)
 ;.W ?5,"* (One or more Notifications already exist for this Procedure.)"
"RTN","WVPROC1",77,0)
 ;
"RTN","WVPROC1",78,0)
 ;---> SET TEXT.
"RTN","WVPROC1",79,0)
 S WVSPTX=$S(WVSPEC=1:"PAP",WVSPEC=2:"MAM",1:"?")
"RTN","WVPROC1",80,0)
 W !!!
"RTN","WVPROC1",81,0)
 S DIR("A")="QUEUE a "_WVSPTX_" Result Normal letter to be sent to this patient"
"RTN","WVPROC1",82,0)
 S DIR(0)="Y"
"RTN","WVPROC1",83,0)
 D ^DIR
"RTN","WVPROC1",84,0)
 Q:$D(DIRUT)!(Y=0)
"RTN","WVPROC1",85,0)
 D NORMALL^WVNOTIF1(WVDFN,WVACCN,WVSPEC,WVSPTX)
"RTN","WVPROC1",86,0)
 Q
"RTN","WVPROC1",87,0)
 ;
"RTN","WVRPST")
0^7^B17898839
"RTN","WVRPST",1,0)
WVRPST ;HCIOFO/JR,FT-Sexual Trauma Summary ;4/11/01  09:16
"RTN","WVRPST",2,0)
 ;;1.0;WOMEN'S HEALTH;**7,14**;Sep 30, 1998
"RTN","WVRPST",3,0)
 ;
"RTN","WVRPST",4,0)
 ; This routine uses the following IAs:
"RTN","WVRPST",5,0)
 ;  #2716 - $$GETSTAT^DGMSTAPI  (supported)
"RTN","WVRPST",6,0)
 ; #10035 - ^DPT(DFN,.351       (supported)
"RTN","WVRPST",7,0)
 ;
"RTN","WVRPST",8,0)
 ; EP for List Sexual Trauma Data [WV SEXUAL TRAUMA LIST] option
"RTN","WVRPST",9,0)
 W @IOF,!?33,"WOMEN'S HEALTH"
"RTN","WVRPST",10,0)
 W !?19,"* * *  SEXUAL TRAUMA SUMMARY REPORT  * * *",!
"RTN","WVRPST",11,0)
 S WVE="",(WVMGR,WVPOP)=0
"RTN","WVRPST",12,0)
 D CMGR^WVMSTL ;select one or all case mgrs to sort by
"RTN","WVRPST",13,0)
 I WVPOP D EXIT Q
"RTN","WVRPST",14,0)
 K IO("Q") S %ZIS="Q" D ^%ZIS G EXIT:POP I $D(IO("Q")) D  Q
"RTN","WVRPST",15,0)
 .S ZTRTN="GET^WVRPST",ZTDESC="WH SEXUAL TRAUMA SUMMARY"
"RTN","WVRPST",16,0)
 .S ZTSAVE("WVE")="",ZTSAVE("WVMGR")=""
"RTN","WVRPST",17,0)
 .D ^%ZTLOAD D HOME^%ZIS K IO("Q")
"RTN","WVRPST",18,0)
 .Q
"RTN","WVRPST",19,0)
GET ; Get data for report
"RTN","WVRPST",20,0)
 U IO
"RTN","WVRPST",21,0)
 Q:WVE=""  ;no case mgr selection
"RTN","WVRPST",22,0)
 S (WVBOTH,WVDFN,WVCIVCNT,WVCNALL,WVETCNT,WVZSTOP)=0
"RTN","WVRPST",23,0)
 S (WVCSTV("Y"),WVCSTV("N"),WVCSTV("D"),WVCSTV("U"))=0
"RTN","WVRPST",24,0)
 S (WVCSTNV("Y"),WVCSTNV("N"),WVCSTNV("D"),WVCSTNV("U"))=0
"RTN","WVRPST",25,0)
 S (WVMSTV("Y"),WVMSTV("N"),WVMSTV("D"),WVMSTV("U"))=0
"RTN","WVRPST",26,0)
 S WVLINE=$$REPEAT^XLFSTR("-",76)
"RTN","WVRPST",27,0)
 S WVDASH=$$REPEAT^XLFSTR("=",80)
"RTN","WVRPST",28,0)
 F  S WVDFN=$O(^WV(790,WVDFN)) Q:WVDFN'>0!($G(ZSTOP)=1)  S WV0=$G(^(WVDFN,0)) D
"RTN","WVRPST",29,0)
 .S WVZSTOP=WVZSTOP+1
"RTN","WVRPST",30,0)
 .;If background task, then every 100 records check if user wants to
"RTN","WVRPST",31,0)
 .;stop the task.
"RTN","WVRPST",32,0)
 .I $D(ZTQUEUED),WVZSTOP#100=0 D STOPCHK^WVUTL10(0) Q:$G(ZTSTOP)=1
"RTN","WVRPST",33,0)
 .I '$$NOT(WVDFN) Q  ;active patient in WH package?
"RTN","WVRPST",34,0)
 .I WVE=0,WVMGR'=$P(WV0,U,10) Q  ;not the case mgr selected by user
"RTN","WVRPST",35,0)
 .S WVCST=$P(WV0,U,28) ;CST value
"RTN","WVRPST",36,0)
 .S WVMST=$P($$GETSTAT^DGMSTAPI(WVDFN),U,2) ;get MST status
"RTN","WVRPST",37,0)
 .S WVCNALL=WVCNALL+1 ;count of active patients in WH
"RTN","WVRPST",38,0)
 .S WVET=$E($$VET^WVUTL1A(WVDFN)) ;check veteran status
"RTN","WVRPST",39,0)
 .S:WVET="Y" WVETCNT=WVETCNT+1 ;count of veterans
"RTN","WVRPST",40,0)
 .S:WVET'="Y" WVCIVCNT=WVCIVCNT+1 ;count of non-veterans
"RTN","WVRPST",41,0)
 .I WVET="Y" D  ;CST count for veterans
"RTN","WVRPST",42,0)
 ..I WVCST="Y" S WVCSTV("Y")=WVCSTV("Y")+1 Q
"RTN","WVRPST",43,0)
 ..I WVCST="N" S WVCSTV("N")=WVCSTV("N")+1 Q
"RTN","WVRPST",44,0)
 ..I WVCST="D" S WVCSTV("D")=WVCSTV("D")+1 Q
"RTN","WVRPST",45,0)
 ..S WVCSTV("U")=WVCSTV("U")+1
"RTN","WVRPST",46,0)
 ..Q
"RTN","WVRPST",47,0)
 .I WVET'="Y" D  ;CST count for non-veterans
"RTN","WVRPST",48,0)
 ..I WVCST="Y" S WVCSTNV("Y")=WVCSTNV("Y")+1 Q
"RTN","WVRPST",49,0)
 ..I WVCST="N" S WVCSTNV("N")=WVCSTNV("N")+1 Q
"RTN","WVRPST",50,0)
 ..I WVCST="D" S WVCSTNV("D")=WVCSTNV("D")+1 Q
"RTN","WVRPST",51,0)
 ..S WVCSTNV("U")=WVCSTNV("U")+1
"RTN","WVRPST",52,0)
 ..Q
"RTN","WVRPST",53,0)
 .I WVET="Y" D  ;MST count - applies to veterans only
"RTN","WVRPST",54,0)
 ..I WVMST="Y" S WVMSTV("Y")=WVMSTV("Y")+1 S:WVCST="Y" WVBOTH=WVBOTH+1 Q
"RTN","WVRPST",55,0)
 ..I WVMST="N" S WVMSTV("N")=WVMSTV("N")+1 Q
"RTN","WVRPST",56,0)
 ..I WVMST="D" S WVMSTV("D")=WVMSTV("D")+1 Q
"RTN","WVRPST",57,0)
 ..S WVMSTV("U")=WVMSTV("U")+1
"RTN","WVRPST",58,0)
 ..Q
"RTN","WVRPST",59,0)
 .Q
"RTN","WVRPST",60,0)
 I $G(ZTSTOP)=1 D EXIT Q
"RTN","WVRPST",61,0)
 D PRINT
"RTN","WVRPST",62,0)
EXIT ;
"RTN","WVRPST",63,0)
 D ^%ZISC
"RTN","WVRPST",64,0)
 K WV0,WVBOTH,WVCIVCNT,WVCNALL,WVCRT,WVCST,WVCSTNV,WVCSTV,WVDASH,WVDFN
"RTN","WVRPST",65,0)
 K WVE,WVET,WVETCNT,WVJRNOW,WVLINE,WVLINL,WVMGR,WVMST,WVMSTV,WVPOP,WVTAB,WVZSTOP
"RTN","WVRPST",66,0)
 K POP,X,Y
"RTN","WVRPST",67,0)
 Q
"RTN","WVRPST",68,0)
PRINT ; Print counts
"RTN","WVRPST",69,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVRPST",70,0)
 D HEAD
"RTN","WVRPST",71,0)
 W !,"MST",?18,"YES",?29,"NO",?35,"DECLINED",?45,"UNKNOWN"
"RTN","WVRPST",72,0)
 W !,WVLINE
"RTN","WVRPST",73,0)
 W !,"VETERANS",?15,$J(WVMSTV("Y"),6),?25,$J(WVMSTV("N"),6),?35,$J(WVMSTV("D"),6),?45,$J(WVMSTV("U"),6)
"RTN","WVRPST",74,0)
 W !!,WVDASH
"RTN","WVRPST",75,0)
 W !!,"CST",?18,"YES",?29,"NO",?35,"DECLINED",?45,"UNKNOWN"
"RTN","WVRPST",76,0)
 W !,WVLINE
"RTN","WVRPST",77,0)
 W !,"VETERANS",?15,$J(WVCSTV("Y"),6),?25,$J(WVCSTV("N"),6),?35,$J(WVCSTV("D"),6),?45,$J(WVCSTV("U"),6)
"RTN","WVRPST",78,0)
 W !,"NON-VETS",?15,$J(WVCSTNV("Y"),6),?25,$J(WVCSTNV("N"),6),?35,$J(WVCSTNV("D"),6),?45,$J(WVCSTNV("U"),6)
"RTN","WVRPST",79,0)
 W !,WVDASH
"RTN","WVRPST",80,0)
 W !?5,"# OF PATIENTS ---------------->",$J(WVCNALL,5)
"RTN","WVRPST",81,0)
 W !?5,"# WHO ARE VETERANS ----------->",$J(WVETCNT,5)
"RTN","WVRPST",82,0)
 W !?5,"# WHO ARE NON-VETERANS ------->",$J(WVCIVCNT,5)
"RTN","WVRPST",83,0)
 W !?5,"# WITH MST & CST ------------->",$J(WVBOTH,5)
"RTN","WVRPST",84,0)
 W !!?12,"Above numbers are based on Active Women's Health patients"
"RTN","WVRPST",85,0)
 I WVE=1 W !?12,"for all case managers."
"RTN","WVRPST",86,0)
 I WVE=0 W !?12,"for "_$$PERSON^WVUTL1(WVMGR)_"."
"RTN","WVRPST",87,0)
 S WVPOP=0
"RTN","WVRPST",88,0)
 I WVCRT&('$D(IO("S")))&('POP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVRPST",89,0)
 Q
"RTN","WVRPST",90,0)
HEAD ; Print the report header
"RTN","WVRPST",91,0)
 W:$Y>0 @IOF
"RTN","WVRPST",92,0)
 W !?26,"SEXUAL TRAUMA SUMMARY REPORT"
"RTN","WVRPST",93,0)
 W !,$$RUNDT^WVUTL1A("C")
"RTN","WVRPST",94,0)
 W !,WVDASH
"RTN","WVRPST",95,0)
 Q
"RTN","WVRPST",96,0)
NOT(WVDFN) ;Screen out patients for Inactive & Dead
"RTN","WVRPST",97,0)
 N TEST
"RTN","WVRPST",98,0)
 S TEST=$$GET1^DIQ(2,WVDFN,.351,"I")
"RTN","WVRPST",99,0)
 Q:TEST>0 0
"RTN","WVRPST",100,0)
 S TEST=$P($G(^WV(790,WVDFN,0)),U,24)
"RTN","WVRPST",101,0)
 Q:TEST>0 0
"RTN","WVRPST",102,0)
 Q 1
"RTN","WVUTL10")
0^8^B2064411
"RTN","WVUTL10",1,0)
WVUTL10 ;HCIOFO/FT-Women's Health Utility Routine ;1/12/01  14:41
"RTN","WVUTL10",2,0)
 ;;1.0;WOMEN'S HEALTH;**14**;Sep 30, 1998
"RTN","WVUTL10",3,0)
STOPCHK(FLAG) ; Does user want to stop background task?
"RTN","WVUTL10",4,0)
 ; FLAG: 0 - Check is done before any output to the user.
"RTN","WVUTL10",5,0)
 ;       1 - Check is done after output to user has begun.
"RTN","WVUTL10",6,0)
 Q:'$D(ZTQUEUED)  ;not a background task
"RTN","WVUTL10",7,0)
 I $$S^%ZTLOAD D
"RTN","WVUTL10",8,0)
 .S ZTSTOP=1 ;set TaskMan variable equal to 1 to stop task
"RTN","WVUTL10",9,0)
 .K ZTREQ ;keep record of task in task log
"RTN","WVUTL10",10,0)
 .Q
"RTN","WVUTL10",11,0)
 Q:+$G(ZTSTOP)=0  ;no request to stop task
"RTN","WVUTL10",12,0)
 Q:'FLAG  ;don't send message to output device
"RTN","WVUTL10",13,0)
 ; Print message to output device
"RTN","WVUTL10",14,0)
 N WVSTOP
"RTN","WVUTL10",15,0)
 S WVSTOP(1)="          *** OUTPUT STOPPED AT USER'S REQUEST ***"
"RTN","WVUTL10",16,0)
 S WVSTOP(2)="               Option Name: "_$S($P($G(XQY0),"^")]"":$P($G(XQY0),"^"),1:"Unknown")
"RTN","WVUTL10",17,0)
 S WVSTOP(3)="          Option Menu Text: "_$S($P($G(XQY0),"^",2)]"":$P($G(XQY0),"^",2),1:"Unknown")
"RTN","WVUTL10",18,0)
 S WVSTOP(4)="                    Task #: "_$S(+$G(ZTSK)>0:+$G(ZTSK),1:"Unknown")
"RTN","WVUTL10",19,0)
 D EN^DDIOL(.WVSTOP,"","!?10")
"RTN","WVUTL10",20,0)
 Q
"RTN","WVUTL1A")
0^9^B29494019
"RTN","WVUTL1A",1,0)
WVUTL1A ;HCIOFO/JR,FT-Continuation of ^WVUTL1 (Utilities) ;4/10/01  11:29
"RTN","WVUTL1A",2,0)
 ;;1.0;WOMEN'S HEALTH;**4,7,14**;Sep 30, 1998
"RTN","WVUTL1A",3,0)
 ;
"RTN","WVUTL1A",4,0)
 ; This routine uses the following IAs:
"RTN","WVUTL1A",5,0)
 ;  #1252 - $$OUTPTPR^SDUTL3     (supported)
"RTN","WVUTL1A",6,0)
 ;  #2483 - FILE 2, Field 1901   (private)
"RTN","WVUTL1A",7,0)
 ;  #2716 - $$GETSTAT^DGMSTAPI   (supported)
"RTN","WVUTL1A",8,0)
 ; #10035 - ^DPT(DFN,.104        (supported)
"RTN","WVUTL1A",9,0)
 ; #10060 - FILE 200 fields      (supported)
"RTN","WVUTL1A",10,0)
 ; #10090 - FILE 4 fields        (supported)
"RTN","WVUTL1A",11,0)
 ;
"RTN","WVUTL1A",12,0)
PRIOR() ;EP
"RTN","WVUTL1A",13,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1 TO GET VALUE AND TEXT OF
"RTN","WVUTL1A",14,0)
 ;---> NOTIFICATION PRIORITY AND RESULT/REMINDER, FROM PURPOSE OF
"RTN","WVUTL1A",15,0)
 ;---> NOTIFICATION WHEN FIRST DISPLAYING SCREEN.
"RTN","WVUTL1A",16,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF NOTIFICATION.
"RTN","WVUTL1A",17,0)
 N X
"RTN","WVUTL1A",18,0)
 Q:'$D(DA) "UNKNOWN"
"RTN","WVUTL1A",19,0)
 Q:'$D(^WV(790.4,DA,0)) "UNKNOWN"
"RTN","WVUTL1A",20,0)
 S X=$P(^WV(790.4,DA,0),U,4)
"RTN","WVUTL1A",21,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1A",22,0)
 Q $$PRIOR1
"RTN","WVUTL1A",23,0)
 ;
"RTN","WVUTL1A",24,0)
PRIOR1() ;EP
"RTN","WVUTL1A",25,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1 TO GET VALUE AND TEXT OF
"RTN","WVUTL1A",26,0)
 ;---> NOTIFICATION PRIORITY FROM PURPOSE OF NOTIFICATION AS AN
"RTN","WVUTL1A",27,0)
 ;---> ACTION WHEN EDITING PURPOSE OF NOTIFICATION.  ALSO DISPLAY
"RTN","WVUTL1A",28,0)
 ;---> WHETHER PURPOSE IS A RESULT OR A REMINDER.
"RTN","WVUTL1A",29,0)
 ;---> REQUIRED VARIABLE: X=IEN IN NOTIFICATION PURPOSE FILE.
"RTN","WVUTL1A",30,0)
 N R,Y,Z
"RTN","WVUTL1A",31,0)
 Q:'$D(X) "UNDEFINED"
"RTN","WVUTL1A",32,0)
 Q:'X "UNKNOWN"
"RTN","WVUTL1A",33,0)
 Q:'$D(^WV(790.404,X,0)) "UNKNOWN"
"RTN","WVUTL1A",34,0)
 S Y=$P(^WV(790.404,X,0),U,2) D
"RTN","WVUTL1A",35,0)
 .I 'Y S R="UNKNOWN" Q
"RTN","WVUTL1A",36,0)
 .I '$$VFIELD^DILFD(790.404,.02) S R="^DD MISSING"
"RTN","WVUTL1A",37,0)
 .S R=$$EXTERNAL^DILFD(790.404,.02,"",Y)
"RTN","WVUTL1A",38,0)
 S Z=$P(^WV(790.404,X,0),U,6)
"RTN","WVUTL1A",39,0)
 Q:Z="" R
"RTN","WVUTL1A",40,0)
 Q:Z R_", RESULT"
"RTN","WVUTL1A",41,0)
 Q R_", REMINDER"
"RTN","WVUTL1A",42,0)
 ;
"RTN","WVUTL1A",43,0)
 ;
"RTN","WVUTL1A",44,0)
NTPROC() ;EP
"RTN","WVUTL1A",45,0)
 ;---> CALLED FROM WV NOTIF-EDITBLK-1(?) BLOCK TO DISPLAY PROCEDURE
"RTN","WVUTL1A",46,0)
 ;---> NAME, BASED ON ACCESSION# PTR, WHEN FIRST DISPLAYING SCREEN.
"RTN","WVUTL1A",47,0)
 ;---> REQUIRED VARIABLE: X=ACCESSION# OF PROCEDURE
"RTN","WVUTL1A",48,0)
 N X
"RTN","WVUTL1A",49,0)
 S X=$P(^WV(790.4,DA,0),U,6)
"RTN","WVUTL1A",50,0)
 Q $$PROC
"RTN","WVUTL1A",51,0)
 ;
"RTN","WVUTL1A",52,0)
PROC() ;EP
"RTN","WVUTL1A",53,0)
 ;---> DISPLAY PROCEDURE TYPE OF THIS PROCEDURE.
"RTN","WVUTL1A",54,0)
 ;---> REQUIRED VARIABLE: X=IEN OF PROCEDURE IN PROC FILE #790.1.
"RTN","WVUTL1A",55,0)
 N WVY,WVYY,Y,Z S WVYY="INVALID ACC# OR PTR"
"RTN","WVUTL1A",56,0)
 Q:X']"" ""
"RTN","WVUTL1A",57,0)
 Q:'$D(^WV(790.1,X,0)) WVYY
"RTN","WVUTL1A",58,0)
 S WVY=$P(^WV(790.1,X,0),U,4)
"RTN","WVUTL1A",59,0)
 Q:'WVY WVYY
"RTN","WVUTL1A",60,0)
 Q:'$D(^WV(790.2,WVY,0)) WVYY
"RTN","WVUTL1A",61,0)
 S Z=$P(^WV(790.2,WVY,0),U)
"RTN","WVUTL1A",62,0)
 ;---> IF UNILATERAL AND LEFT/RIGHT HAS A VALUE, REPLACE "UNILATERAL"
"RTN","WVUTL1A",63,0)
 ;---> WITH LEFT OR RIGHT.
"RTN","WVUTL1A",64,0)
 S Y=$P(^WV(790.1,X,0),U,9)
"RTN","WVUTL1A",65,0)
 S Y=$S(Y="l":"LEFT",Y="r":"RIGHT",1:"")
"RTN","WVUTL1A",66,0)
 Q:Y="" Z
"RTN","WVUTL1A",67,0)
 Q $P(Z," ")_" "_Y
"RTN","WVUTL1A",68,0)
 ;
"RTN","WVUTL1A",69,0)
PROC1() ;EP
"RTN","WVUTL1A",70,0)
 ;---> DISPLAY PROCEDURE TYPE OF THIS PROCEDURE, USING DA.
"RTN","WVUTL1A",71,0)
 ;---> CALLED BY WV PROC-HEADER-1, WHICH CANNOT USE X.
"RTN","WVUTL1A",72,0)
 ;---> REQUIRED VARIABLE: DA=IEN OF PROCEDURE IN PROC FILE #790.1.
"RTN","WVUTL1A",73,0)
 N X S X=DA
"RTN","WVUTL1A",74,0)
 Q $$PROC
"RTN","WVUTL1A",75,0)
PROVI(DFN) ;
"RTN","WVUTL1A",76,0)
 ;---> RETURNS THE PRIMARY CARE PROVIDER
"RTN","WVUTL1A",77,0)
 ;---> REQUIRED VARIABLE: DFN
"RTN","WVUTL1A",78,0)
 Q:$G(DFN)'>0 "UNKNOWN"
"RTN","WVUTL1A",79,0)
 N X S X=$P($G(^DPT(DFN,.104)),U)
"RTN","WVUTL1A",80,0)
 S X=$S(X>0:$$GET1^DIQ(200,X,.01,"E"),1:"")
"RTN","WVUTL1A",81,0)
 I X="" S X=$P($$OUTPTPR^SDUTL3(DFN),U,2)
"RTN","WVUTL1A",82,0)
 S:X="" X="UNKNOWN"
"RTN","WVUTL1A",83,0)
 Q X
"RTN","WVUTL1A",84,0)
SCR(X) ;
"RTN","WVUTL1A",85,0)
 Q:$G(X)'>0 0
"RTN","WVUTL1A",86,0)
 S WVJX=$S(X>0:$P($G(^WV(790.07,X,0)),U,2),1:0)
"RTN","WVUTL1A",87,0)
 Q WVJX
"RTN","WVUTL1A",88,0)
QUAD(X) ;
"RTN","WVUTL1A",89,0)
 Q:$TR(X,"ULR,")'="" 0
"RTN","WVUTL1A",90,0)
 N TEST,CN,CNT,WVJX S WVJX=X,CN=""
"RTN","WVUTL1A",91,0)
 S (CN("LL"),CN("UL"),CN("UR"),CN("LR"))="",TEST=1
"RTN","WVUTL1A",92,0)
 F  S CN=$O(CN(CN)) Q:CN=""  I $P(WVJX,CN,2,5)[CN S WVJX=$P(WVJX,CN,1,2)_$P(WVJX,CN,3)
"RTN","WVUTL1A",93,0)
 F CN=1:1:11 I $E(WVJX,CN)=","&($E(WVJX,CN+1)=",") S WVJX=$E(WVJX,1,CN)_$E(WVJX,CN+2,11) S CN=CN-1
"RTN","WVUTL1A",94,0)
 F CN=1:1:4 S CNT=$P(X,",",CN) I CNT'="" I '$D(CN(CNT)) S TEST=0 Q
"RTN","WVUTL1A",95,0)
 S:$E(WVJX,$L(WVJX))="," WVJX=$E(WVJX,1,$L(WVJX)-1)
"RTN","WVUTL1A",96,0)
 S:$E(WVJX,1)="," WVJX=$E(WVJX,2,11)
"RTN","WVUTL1A",97,0)
 S:TEST>0 TEST=TEST_"^"_WVJX
"RTN","WVUTL1A",98,0)
 Q TEST
"RTN","WVUTL1A",99,0)
REF ;
"RTN","WVUTL1A",100,0)
 N X,Y,B,L
"RTN","WVUTL1A",101,0)
 Q:$G(DA)=""  S X=DA
"RTN","WVUTL1A",102,0)
 S Y=X,X=$P($G(^WV(790.07,X,0)),U)
"RTN","WVUTL1A",103,0)
 S L="abcdefghijklmnopqrstuvwxyz"
"RTN","WVUTL1A",104,0)
 S B="ABCDEFGHIJKLMNOPQRSTUVWXYZ"
"RTN","WVUTL1A",105,0)
 S X=$TR($E(X,1,$L(X)),L,B)
"RTN","WVUTL1A",106,0)
 I WVACT="SET" S ^WV(790.07,"C",X,Y)=""
"RTN","WVUTL1A",107,0)
 I WVACT="KIL" K ^WV(790.07,"C",X,Y)
"RTN","WVUTL1A",108,0)
 K WVACT Q
"RTN","WVUTL1A",109,0)
FAC N X,Y
"RTN","WVUTL1A",110,0)
 S WVJBFAC="",WVJCFAC="",WVJPCP=""
"RTN","WVUTL1A",111,0)
 Q:$G(WVDFN)'>0
"RTN","WVUTL1A",112,0)
 S X=$G(^WV(790,WVDFN,0))
"RTN","WVUTL1A",113,0)
 S WVJBFAC=$P(X,U,25),WVJCFAC=$P(X,U,26),WVJPCP=$$PROVI(WVDFN)
"RTN","WVUTL1A",114,0)
 S:WVJBFAC>0 WVJBFAC=$E($$GET1^DIQ(4,WVJBFAC,.01,"E"),1,18)
"RTN","WVUTL1A",115,0)
 S:WVJCFAC>0 WVJCFAC=$E($$GET1^DIQ(4,WVJCFAC,.01,"E"),1,18)
"RTN","WVUTL1A",116,0)
 Q
"RTN","WVUTL1A",117,0)
RAXS(DA) ; 
"RTN","WVUTL1A",118,0)
 I $G(DA)'>0 Q 0
"RTN","WVUTL1A",119,0)
 S WVJJ0=$G(^WV(790.1,DA,0))
"RTN","WVUTL1A",120,0)
 I '$D(WVJJ0) Q 0
"RTN","WVUTL1A",121,0)
 I "^BU^MB^MU^MS^"'[$E(WVJJ0,1,2) Q 0
"RTN","WVUTL1A",122,0)
 I $P(WVJJ0,U,15)="" Q 0
"RTN","WVUTL1A",123,0)
 Q 1
"RTN","WVUTL1A",124,0)
FACIL(DFN,TYP) ;Gets Treatment Facility, if typ="C" for Cervix, "B" for Breast
"RTN","WVUTL1A",125,0)
 N X,Y
"RTN","WVUTL1A",126,0)
 S Y=""
"RTN","WVUTL1A",127,0)
 I $G(DFN)'>0 Q Y
"RTN","WVUTL1A",128,0)
 S X=$G(^WV(790,DFN,0))
"RTN","WVUTL1A",129,0)
 S:TYP="B" Y=$P(X,U,25) S:TYP="C" Y=$P(X,U,26)
"RTN","WVUTL1A",130,0)
 S:Y>0 Y=$E($$GET1^DIQ(4,Y,.01,"E"),1,18)
"RTN","WVUTL1A",131,0)
 Q Y
"RTN","WVUTL1A",132,0)
MST(WVDFN) ;Gets Military Sexual Trauma
"RTN","WVUTL1A",133,0)
 I $G(WVDFN)'>0 Q ""
"RTN","WVUTL1A",134,0)
 N X,WVMST
"RTN","WVUTL1A",135,0)
 S WVMST=$$GETSTAT^DGMSTAPI(WVDFN)
"RTN","WVUTL1A",136,0)
 S WVMST=$S($P(WVMST,U,6)]"":$P(WVMST,U,6),1:"")
"RTN","WVUTL1A",137,0)
 S:WVMST="" WVMST="Unknown, not screened"
"RTN","WVUTL1A",138,0)
 I $E($$VET(WVDFN))'="Y" S WVMST="<N/A Not a Veteran>"
"RTN","WVUTL1A",139,0)
 Q WVMST
"RTN","WVUTL1A",140,0)
 ;
"RTN","WVUTL1A",141,0)
SC(WVJ) ;Screen called from File 790.02 to elim. inactive from selectable
"RTN","WVUTL1A",142,0)
 I $G(XQY0)["WV ADD/EDIT CASE MANAGERS" Q 1
"RTN","WVUTL1A",143,0)
 I $G(WVJOPEN)>0 Q 1
"RTN","WVUTL1A",144,0)
 N WVINACT
"RTN","WVUTL1A",145,0)
 S WVINACT=$P($G(^WV(790.01,+WVJ,0)),U,2) ;date inactivated
"RTN","WVUTL1A",146,0)
 I WVINACT>0,WVINACT<$G(DT) Q 0
"RTN","WVUTL1A",147,0)
 Q 1
"RTN","WVUTL1A",148,0)
LOOK(WVJ) ;Display select fields with lookup on 790, not file#2 Identif.
"RTN","WVUTL1A",149,0)
 Q:WVJ'>0
"RTN","WVUTL1A",150,0)
 N DIC,DA,DR,DIQ,Y
"RTN","WVUTL1A",151,0)
 S DIC="^WV(790,",DA=WVJ,DIQ="WVJAR(",DIQ(0)="E"
"RTN","WVUTL1A",152,0)
 S DR=".06;.1;.16" D EN^DIQ1
"RTN","WVUTL1A",153,0)
 S WVJ=WVJAR(790,WVJ,.06,"E")_"    "_WVJAR(790,WVJ,.1,"E")
"RTN","WVUTL1A",154,0)
 K WVJAR
"RTN","WVUTL1A",155,0)
 Q WVJ
"RTN","WVUTL1A",156,0)
LOOKL(WVJ) ;
"RTN","WVUTL1A",157,0)
 N Y,WVX,WVP,WVY,WVDT,WVP,X,WVDTS,WVMARK
"RTN","WVUTL1A",158,0)
 S X1=DT,X2=-30 D C^%DTC S WVDTS=X
"RTN","WVUTL1A",159,0)
 S WVX="" F  S WVX=$O(^WV(790.3,"C",+WVJ,WVX)) Q:WVX'>0  D
"RTN","WVUTL1A",160,0)
 .S WVY=$G(^WV(790.3,WVX,0)),WVDT=+WVY,WVP=$P(WVY,U,3)
"RTN","WVUTL1A",161,0)
 .Q:WVDT'>WVDTS  S WVMARK=1
"RTN","WVUTL1A",162,0)
 .S Y=WVDT D DD^%DT S WVDT=Y
"RTN","WVUTL1A",163,0)
 .;S WVP=$S(WVP'>0:"",1:$P($G(^WV(790.1,WVP,0)),U,4))
"RTN","WVUTL1A",164,0)
 .S:WVP'="" WVP=$P($G(^WV(790.2,WVP,0)),U)
"RTN","WVUTL1A",165,0)
 .W !?32,WVDT,?47,WVP
"RTN","WVUTL1A",166,0)
 W:$G(WVMARK)=1 !
"RTN","WVUTL1A",167,0)
 Q
"RTN","WVUTL1A",168,0)
RUNDT(WVY) ;Get and format run date for various reports 
"RTN","WVUTL1A",169,0)
 ; Center when WVY="C"
"RTN","WVUTL1A",170,0)
 N Y,WVJ
"RTN","WVUTL1A",171,0)
 I $D(WVJRNOW) Q WVJRNOW
"RTN","WVUTL1A",172,0)
 D NOW^%DTC S Y=% D DD^%DT
"RTN","WVUTL1A",173,0)
 S Y=$E(Y,1,12)_"  "_$E(Y,14,18)
"RTN","WVUTL1A",174,0)
 S:$L(Y)'>10 Y=""
"RTN","WVUTL1A",175,0)
 S (WVJRNOW,WVJ)="Run Date: "_Y
"RTN","WVUTL1A",176,0)
 I $G(WVY)="C" S (WVJ,WVJRNOW)="                         "_WVJRNOW
"RTN","WVUTL1A",177,0)
 Q WVJ
"RTN","WVUTL1A",178,0)
 ;
"RTN","WVUTL1A",179,0)
LINE ; Called from the WV LINE FOR MENUS option. That option is merely a
"RTN","WVUTL1A",180,0)
 ; place holder in the menu and used for visual purposes. This is 
"RTN","WVUTL1A",181,0)
 ; entry point does nothing.
"RTN","WVUTL1A",182,0)
 Q
"RTN","WVUTL1A",183,0)
VET(DFN) ; Check if patient is a veteran.
"RTN","WVUTL1A",184,0)
 N WVETERAN
"RTN","WVUTL1A",185,0)
 S WVETERAN=$$GET1^DIQ(2,DFN,1901,"I")
"RTN","WVUTL1A",186,0)
 Q $S(WVETERAN="Y":"Yes",WVETERAN="N":"No",1:"Unknown")
"RTN","WVUTL1A",187,0)
 ;
"RTN","WVUTL1A",188,0)
CST(WVDFN) ; Return Civilian Sexual Trauma value
"RTN","WVUTL1A",189,0)
 Q $$GET1^DIQ(790,+WVDFN,.28,"E")
"RTN","WVUTL1A",190,0)
 ;
"RTN","WVUTL7")
0^10^B43817823
"RTN","WVUTL7",1,0)
WVUTL7 ;HCIOFO/FT,JR-UTIL: HEADERS & TRAILERS; ;4/2/01  11:23
"RTN","WVUTL7",2,0)
 ;;1.0;WOMEN'S HEALTH;**5,7,10,14**;Sep 30, 1998
"RTN","WVUTL7",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVUTL7",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL7",5,0)
 ;;  UTILITY: HEADERS AND TRAILERS.
"RTN","WVUTL7",6,0)
 ;
"RTN","WVUTL7",7,0)
 ; This routine uses the following IAs:
"RTN","WVUTL7",8,0)
 ; #10060 - FILE 200 fields      (supported)
"RTN","WVUTL7",9,0)
 ;
"RTN","WVUTL7",10,0)
S(S) ;EP
"RTN","WVUTL7",11,0)
 ;---> RETURN A VALUE OF SPACES EQUAL IN LENGTH TO THE NUMBER S.
"RTN","WVUTL7",12,0)
 N I,SP S SP=$$REPEAT^XLFSTR(" ",80)
"RTN","WVUTL7",13,0)
 Q $E(SP,1,$G(S))
"RTN","WVUTL7",14,0)
 ;
"RTN","WVUTL7",15,0)
TOPHEAD ;EP
"RTN","WVUTL7",16,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",17,0)
 N X
"RTN","WVUTL7",18,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",19,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",20,0)
 S WVPAGE=1
"RTN","WVUTL7",21,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",22,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",23,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",24,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",25,0)
 Q
"RTN","WVUTL7",26,0)
 ;
"RTN","WVUTL7",27,0)
TOPHEAD1 ;EP
"RTN","WVUTL7",28,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",29,0)
 N X
"RTN","WVUTL7",30,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",31,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",32,0)
 S WVPAGE=$G(WVPAGE)+1
"RTN","WVUTL7",33,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",34,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",35,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",36,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",37,0)
 Q
"RTN","WVUTL7",38,0)
 ;
"RTN","WVUTL7",39,0)
HEADER1 ;EP
"RTN","WVUTL7",40,0)
 ;---> BROWSE/REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",41,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",42,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",43,0)
 N X
"RTN","WVUTL7",44,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",45,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",46,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",47,0)
 W !,$$RUNDT^WVUTL1A("C"),!
"RTN","WVUTL7",48,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",49,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",50,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",51,0)
 .I '$D(WVCMGR) W "UNKNOWN" Q
"RTN","WVUTL7",52,0)
 .I WVCMGR="" W "UNKNOWN" Q
"RTN","WVUTL7",53,0)
 .N WVCMGRNM
"RTN","WVUTL7",54,0)
 .S WVCMGRNM=$$GET1^DIQ(200,WVCMGR,.01,"E")
"RTN","WVUTL7",55,0)
 .W $S(WVCMGRNM]"":WVCMGRNM,1:"UNKNOWN")
"RTN","WVUTL7",56,0)
 W ?56,"For period: ",$$TXDT^WVUTL5(WVBEGDT)
"RTN","WVUTL7",57,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",58,0)
 W ?64,"To: ",$$TXDT^WVUTL5(WVENDDT)
"RTN","WVUTL7",59,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",60,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",61,0)
 Q
"RTN","WVUTL7",62,0)
 ;
"RTN","WVUTL7",63,0)
HEADER2 ;EP
"RTN","WVUTL7",64,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, MULTIPLE PROCEDURES.
"RTN","WVUTL7",65,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",66,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",67,0)
 N X
"RTN","WVUTL7",68,0)
 D FAC^WVUTL1A
"RTN","WVUTL7",69,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",70,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",71,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",72,0)
 W !,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",73,0)
 W !,"Patient Name: ",WVNAMAGE,?52,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",74,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",75,0)
 W ?50,"Facility: ",$E($$INSTTX^WVUTL6(DUZ(2)),1,19)
"RTN","WVUTL7",76,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",77,0)
 W ?47,"Cx Facility: ",$G(WVJCFAC)
"RTN","WVUTL7",78,0)
 W !,"PAP Regimen : ",WVPAPRG,?47,"Pr Provider: ",$G(WVJPCP)
"RTN","WVUTL7",79,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",80,0)
 W ?47,"Br Facility: ",$G(WVJBFAC)
"RTN","WVUTL7",81,0)
 W !,"Hx of BR CA : ",$$GET1^DIQ(790,WVDFN,.23,"E")
"RTN","WVUTL7",82,0)
 W !,"Elig Code   : ",$P($$ELIG^WVUTL9(WVDFN),U,2)
"RTN","WVUTL7",83,0)
 W ?51,"Veteran: ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",84,0)
 W !,"MST         : ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",85,0)
 W ?55,"CST: ",$$CST^WVUTL1A(WVDFN)
"RTN","WVUTL7",86,0)
 W !,$$REPEAT^XLFSTR("=",49)
"RTN","WVUTL7",87,0)
 W $S(WVEDC]"":WVEDC_"======",1:"===============================")
"RTN","WVUTL7",88,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",89,0)
 Q
"RTN","WVUTL7",90,0)
 ;
"RTN","WVUTL7",91,0)
HEADER3 ;EP
"RTN","WVUTL7",92,0)
 ;---> LAB LOG REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",93,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",94,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",95,0)
 N X
"RTN","WVUTL7",96,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",97,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",98,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",99,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",100,0)
 W !,"Facility: ",$$INSTTX^WVUTL6($S($G(WVFAC):WVFAC,1:DUZ(2)))
"RTN","WVUTL7",101,0)
 W ?53,"From: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",102,0)
 W " to ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",103,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",104,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",105,0)
 Q
"RTN","WVUTL7",106,0)
 ;
"RTN","WVUTL7",107,0)
HEADER4 ;EP
"RTN","WVUTL7",108,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, ONE PROCEDURE.
"RTN","WVUTL7",109,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE1,DUZ(2)
"RTN","WVUTL7",110,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",111,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",112,0)
 W WVCONFF W:'WVCRT !,WVTIMLN
"RTN","WVUTL7",113,0)
 W !!,WVTITLE1,?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",114,0)
HEADER41 ;EP
"RTN","WVUTL7",115,0)
 ;---> CALLED BY WVPROC; BYPASSES FORMFEED, TITLE, ETC.
"RTN","WVUTL7",116,0)
 N WVDES
"RTN","WVUTL7",117,0)
 W !,$$RUNDT^WVUTL1A("C"),!
"RTN","WVUTL7",118,0)
 W !,"Patient Name: ",WVNAMAGE,?53,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",119,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",120,0)
 W ?50,"Procedure: ",$E(WVPN,1,19)
"RTN","WVUTL7",121,0)
 W !,"PAP Regimen : ",WVPAPRG
"RTN","WVUTL7",122,0)
 W ?55,"Acc#: ",WVACCN
"RTN","WVUTL7",123,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",124,0)
 W ?48,"Cx Facility: ",$$FACIL^WVUTL1A(WVDFN,"C")
"RTN","WVUTL7",125,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",126,0)
 W ?48,"Br Facility: ",$$FACIL^WVUTL1A(WVDFN,"B")
"RTN","WVUTL7",127,0)
 W !,"Elig Code   : ",$P($$ELIG^WVUTL9(WVDFN),U,2)
"RTN","WVUTL7",128,0)
 W ?52,"Veteran: ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",129,0)
 W !,"MST         : ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",130,0)
 W ?56,"CST: ",$$CST^WVUTL1A(WVDFN)
"RTN","WVUTL7",131,0)
 S WVDES=$$DES^WVUTL1(WVDFN)
"RTN","WVUTL7",132,0)
 W !,$S(WVDES="YES":"*DES DAUGHTER*",1:"--------------")
"RTN","WVUTL7",133,0)
 W $$REPEAT^XLFSTR("-",37)
"RTN","WVUTL7",134,0)
 W $S(WVEDC]"":WVEDC_"----",1:"-----------------------------")
"RTN","WVUTL7",135,0)
 Q
"RTN","WVUTL7",136,0)
 ;
"RTN","WVUTL7",137,0)
HEADER5 ;EP
"RTN","WVUTL7",138,0)
 ;---> DELINQUENT NEEDS REPORT HEADER: MULTIPLE PATIENTS
"RTN","WVUTL7",139,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",140,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",141,0)
 N X
"RTN","WVUTL7",142,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",143,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",144,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",145,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",146,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",147,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",148,0)
 .I $G(WVMGR)']"" W "UNKNOWN" Q
"RTN","WVUTL7",149,0)
 .N WVCMGRNM
"RTN","WVUTL7",150,0)
 .S WVCMGRNM=$$GET1^DIQ(200,WVMGR,.01,"E")
"RTN","WVUTL7",151,0)
 .W $S(WVCMGRNM]"":WVCMGRNM,1:"UNKNOWN")
"RTN","WVUTL7",152,0)
 S Y=DT D DD^%DT W ?46,"Run Date: ",Y
"RTN","WVUTL7",153,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(WVFAC)
"RTN","WVUTL7",154,0)
 W ?46,"Tx Needs Past Due as of ",$$SLDT2^WVUTL5(WVDDATE)
"RTN","WVUTL7",155,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",156,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",157,0)
 Q
"RTN","WVUTL7",158,0)
 ;
"RTN","WVUTL7",159,0)
HEADER6 ;EP
"RTN","WVUTL7",160,0)
 ;---> PROGRAM SNAPSHOT HEADER: JUST TITLE AND FACILITY (NO PATIENTS)
"RTN","WVUTL7",161,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",162,0)
 N X
"RTN","WVUTL7",163,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",164,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",165,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",166,0)
 W !?3,$$RUNDT^WVUTL1A() I $D(WVJTOY) W ?60,"(",WVJTOY,")"
"RTN","WVUTL7",167,0)
 W !,"   Note: This report includes all divisions"
"RTN","WVUTL7",168,0)
 W " using this database."
"RTN","WVUTL7",169,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",170,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",171,0)
 Q
"RTN","WVUTL7",172,0)
 ;
"RTN","WVUTL7",173,0)
HEADER7 ;EP
"RTN","WVUTL7",174,0)
 ;---> AUTOLOAD OF PATIENTS HEADER
"RTN","WVUTL7",175,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",176,0)
 N X
"RTN","WVUTL7",177,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",178,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",179,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",180,0)
 W !!,$$RUNDT^WVUTL1A()
"RTN","WVUTL7",181,0)
 W ?45,"Date Range: "_$$FMTE^XLFDT($G(WVJSDT),"2D")_"-"_$$FMTE^XLFDT($P($G(WVJEDT),".",1),"2D")
"RTN","WVUTL7",182,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",183,0)
 W ?45,"Cutoff Age: ",WVAGE
"RTN","WVUTL7",184,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",185,0)
 W !,?3,"NAME",?30,$$PNLB^WVUTL5(),?45,"DOB",?60,"STATUS"
"RTN","WVUTL7",186,0)
 W !,WVLINE
"RTN","WVUTL7",187,0)
 Q
"RTN","WVUTL7",188,0)
 ;
"RTN","WVUTL7",189,0)
HEADER8 ;EP
"RTN","WVUTL7",190,0)
 ;---> SCREENING RATES REPORT HEADER: (NO PATIENTS)
"RTN","WVUTL7",191,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",192,0)
 N X
"RTN","WVUTL7",193,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",194,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",195,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",196,0)
 W !!?4,"For Age Range: ",$S(WVAGRG=1:"ALL",1:WVAGRG)
"RTN","WVUTL7",197,0)
 W ?56,"For period: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",198,0)
 S Y=DT D DD^%DT W !?4,"Run Date: ",Y
"RTN","WVUTL7",199,0)
 W ?64,"To: ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",200,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",201,0)
 W !?4,"(Note: This report includes all divisions using this database.)"
"RTN","WVUTL7",202,0)
 W !?11,"Number of Active Patients: "_$G(WVTOT),!
"RTN","WVUTL7",203,0)
 Q
"RTN","WVUTL7",204,0)
 ;
"RTN","WVUTL7",205,0)
ENDREP(X) ;EP
"RTN","WVUTL7",206,0)
 ;---> END A REPORT, DO FORMFEED OR "Press <Return>" IF NECESSARY.
"RTN","WVUTL7",207,0)
 ;---> REQUIRED VARIABLES: WVCRT=1 IF OUTPUT TO SCREEN
"RTN","WVUTL7",208,0)
 ;--->                     WVPOP=1 IF ESCAPING
"RTN","WVUTL7",209,0)
 ;---> OPTIONAL VARIABLE:  X=1 IF "End of Report" SHOULD NOT DISPLAY.
"RTN","WVUTL7",210,0)
 ;
"RTN","WVUTL7",211,0)
 S WVTITLE="-----  End of Report  -----"
"RTN","WVUTL7",212,0)
 I '$G(X)&('WVPOP) D CENTERT^WVUTL5(.WVTITLE) W !,WVTITLE
"RTN","WVUTL7",213,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVUTL7",214,0)
 D ^%ZISC
"RTN","WVUTL7",215,0)
 Q
"VER")
8.0^22
"^DD",790,790,.28,0)
CST^S^Y:Yes;N:No;D:Declined to Answer;U:Unknown;^0;28^Q
"^DD",790,790,.28,21,0)
^.001^2^2^3001229^^
"^DD",790,790,.28,21,1,0)
This field indicates if the patient has experienced any sexual trauma
"^DD",790,790,.28,21,2,0)
(rape, sexual assault, etc.) as a civilian.
"^DD",790,790,.28,"DT")
3001229
**END**
**END**
