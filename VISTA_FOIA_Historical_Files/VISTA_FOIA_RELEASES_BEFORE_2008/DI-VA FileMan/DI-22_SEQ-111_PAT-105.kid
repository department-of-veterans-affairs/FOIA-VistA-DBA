Released DI*22*105 SEQ #111
Extracted from mail message
**KIDS**:DI*22.0*105^

**INSTALL NAME**
DI*22.0*105
"BLD",403,0)
DI*22.0*105^VA FILEMAN^0^3021223^y
"BLD",403,1,0)
^^2^2^3020307^^
"BLD",403,1,1,0)
See patch DI*22*105 in the National Patch Module on FORUM for complete
"BLD",403,1,2,0)
information on this patch.
"BLD",403,4,0)
^9.64PA^^
"BLD",403,"KRN",0)
^9.67PA^8989.52^17
"BLD",403,"KRN",.4,0)
.4
"BLD",403,"KRN",.401,0)
.401
"BLD",403,"KRN",.402,0)
.402
"BLD",403,"KRN",.403,0)
.403
"BLD",403,"KRN",.5,0)
.5
"BLD",403,"KRN",.84,0)
.84
"BLD",403,"KRN",3.6,0)
3.6
"BLD",403,"KRN",3.8,0)
3.8
"BLD",403,"KRN",9.2,0)
9.2
"BLD",403,"KRN",9.8,0)
9.8
"BLD",403,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",403,"KRN",9.8,"NM",1,0)
DID^^0^B55435936
"BLD",403,"KRN",9.8,"NM",2,0)
DID1^^0^B21401139
"BLD",403,"KRN",9.8,"NM",3,0)
DIDC^^0^B11995156
"BLD",403,"KRN",9.8,"NM",4,0)
DIDG^^0^B10960393
"BLD",403,"KRN",9.8,"NM",5,0)
DIDH1^^0^B18698333
"BLD",403,"KRN",9.8,"NM",6,0)
DID2^^0^B19296587
"BLD",403,"KRN",9.8,"NM","B","DID",1)

"BLD",403,"KRN",9.8,"NM","B","DID1",2)

"BLD",403,"KRN",9.8,"NM","B","DID2",6)

"BLD",403,"KRN",9.8,"NM","B","DIDC",3)

"BLD",403,"KRN",9.8,"NM","B","DIDG",4)

"BLD",403,"KRN",9.8,"NM","B","DIDH1",5)

"BLD",403,"KRN",19,0)
19
"BLD",403,"KRN",19.1,0)
19.1
"BLD",403,"KRN",101,0)
101
"BLD",403,"KRN",409.61,0)
409.61
"BLD",403,"KRN",8989.51,0)
8989.51
"BLD",403,"KRN",8989.52,0)
8989.52
"BLD",403,"KRN",8994,0)
8994
"BLD",403,"KRN","B",.4,.4)

"BLD",403,"KRN","B",.401,.401)

"BLD",403,"KRN","B",.402,.402)

"BLD",403,"KRN","B",.403,.403)

"BLD",403,"KRN","B",.5,.5)

"BLD",403,"KRN","B",.84,.84)

"BLD",403,"KRN","B",3.6,3.6)

"BLD",403,"KRN","B",3.8,3.8)

"BLD",403,"KRN","B",9.2,9.2)

"BLD",403,"KRN","B",9.8,9.8)

"BLD",403,"KRN","B",19,19)

"BLD",403,"KRN","B",19.1,19.1)

"BLD",403,"KRN","B",101,101)

"BLD",403,"KRN","B",409.61,409.61)

"BLD",403,"KRN","B",8989.51,8989.51)

"BLD",403,"KRN","B",8989.52,8989.52)

"BLD",403,"KRN","B",8994,8994)

"BLD",403,"QUES",0)
^9.62^^
"BLD",403,"REQB",0)
^9.611^4^4
"BLD",403,"REQB",1,0)
DI*22.0*7^2
"BLD",403,"REQB",2,0)
DI*22.0*19^2
"BLD",403,"REQB",3,0)
DI*22.0*24^2
"BLD",403,"REQB",4,0)
DI*22.0*76^2
"BLD",403,"REQB","B","DI*22.0*19",2)

"BLD",403,"REQB","B","DI*22.0*24",3)

"BLD",403,"REQB","B","DI*22.0*7",1)

"BLD",403,"REQB","B","DI*22.0*76",4)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
VA FILEMAN^DI^FM INIT
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
22.0^2990330^3021217^12
"PKG",5,22,1,"PAH",1,0)
105^3021223
"PKG",5,22,1,"PAH",1,1,0)
^^2^2^3021223
"PKG",5,22,1,"PAH",1,1,1,0)
See patch DI*22*105 in the National Patch Module on FORUM for complete
"PKG",5,22,1,"PAH",1,1,2,0)
information on this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","DID")
0^1^B55435936
"RTN","DID",1,0)
DID ;SFISC/XAK-LIST DD'S ;2:19 PM  5 Mar 2002
"RTN","DID",2,0)
 ;;22.0;VA FileMan;**24,105**;Mar 30, 1999
"RTN","DID",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","DID",4,0)
 D KL,L^DICRW1 I $D(DIC) S (DUB,DIB,DFF)=+Y G O:Y'=+DIB(1),SUB
"RTN","DID",5,0)
KL K DIS,DIJS,DHIT,DIB,DINM,DIDX,DIGR,DIDH,BY,DICMX,DIOEND,FLDS
"RTN","DID",6,0)
 K DFF,DIFF,DID,DUB,DHD,DIC,DICS,POP,DA,DR,S,F,J,K,Z,W,X,Y,M,G,N,I
"RTN","DID",7,0)
 K DIWF,DIPP,DPP,DIMS,DIPQ,DJ,DDL1,DDL2,DDL3,DDLF,DDN1,X1,DDRG,I1
"RTN","DID",8,0)
 K DIDRANGE,DIDFLD,DIDTYP
"RTN","DID",9,0)
 Q
"RTN","DID",10,0)
 ;
"RTN","DID",11,0)
SUB S DIC="^DD("_+Y_"," G O:$O(^DD(+Y,"SB",0))'>0 S DIC(0)="AEQZ",DIC("A")="      Select SUB-FILE: ",DIC("S")="I $P(^(0),U,2)" D ^DIC G KL:$D(DTOUT) I Y>0 S (DFF,Y)=+$P(Y(0),U,2) G SUB
"RTN","DID",12,0)
 G KL:X[U
"RTN","DID",13,0)
O K DIC S:DFF-DUB DIC("S")="I Y-5" S DIC="^DOPT(""DID"",",DIC(0)="AEQ",DIC("B")=1 D ^DIC G KL:Y<0
"RTN","DID",14,0)
O1 K DIC S DIC="^DD(DFF,"
"RTN","DID",15,0)
 I +Y=3 D  D EN^DIP G KL
"RTN","DID",16,0)
 .I $D(^DIC(DFF)) S DIB(1)=$O(^DD($O(^DIC(DIB(1)))),-1)
"RTN","DID",17,0)
 .S DIS(0)="I $D(^DD(DFF,D0,0))",DIOEND="G L^DIDC"
"RTN","DID",18,0)
 .S DIOBEG="S L=0 I $G(DQI),$D(^UTILITY($J,2)) S ^(1.5)=""W $O(^DD(DIB,0,""""NM"""",0)),"""" """" W:'$D(^DIC(DIB)) """"SUB-"""" W """"FILE """""",^(2)=""X ^(1.5) ""_^(2)"
"RTN","DID",19,0)
 I +Y=4,'$D(DIFORMAT) D MOD^DID2 G KL:X[U
"RTN","DID",20,0)
 S L=0,FLDS="",BY="@.001" I +Y=5 S (FR,TO)=.01,DHIT="S F(1)=DUB",DHD="W """" D H1^DIDG",DIOEND="D T^DID" G G
"RTN","DID",21,0)
 I +Y=8 D  G:DIDTYP=""!(DIDFLD=-1) KL G G
"RTN","DID",22,0)
 . S DIDTYP=$$ASKTYP Q:DIDTYP=""
"RTN","DID",23,0)
 . S DIDFLD=$$ASKFLD(DFF) Q:DIDFLD=-1
"RTN","DID",24,0)
 . S (FR,TO)=.01,DHIT="S F(1)=DFF"
"RTN","DID",25,0)
 . S DHD="W """" D IXHEAD1^DID"
"RTN","DID",26,0)
 . S DIOEND="D IX^DID"
"RTN","DID",27,0)
 I +Y=9 S (FR,TO)=.01,DHIT="S F(1)=DFF",DHD="W """" D KEYHEAD1^DID",DIOEND="D KEY^DID" G G
"RTN","DID",28,0)
 S DHIT="D ^DID1",DHD="W """" D ^DIDH",(FR,TO)="",DIOEND="D END^DID"
"RTN","DID",29,0)
 I +Y=6 S DHIT="D ^DIDG",DIOEND="D END^DIDG"
"RTN","DID",30,0)
 I +Y=2 S DHIT="D ^DIDX",DIDX=0,%=2 I '$D(DIFORMAT) D AH^DIDX G KL:%<1
"RTN","DID",31,0)
 I +Y=7 S DHIT="S (X1,X2)=DFF D ^DIDC",DHD="@" S DIOEND="D IOF^DID"
"RTN","DID",32,0)
 I "^1^2^4^"[(U_+Y_U),'$D(DIGR) D ASKRANGE(DFF,BY,.FR,.TO) G:FR=-1 KL S DIDRANGE=FR]""
"RTN","DID",33,0)
G Q:DIB=0  S DIOEND(1)=DIOEND,DIOEND="D LOOP^DID" D EN1^DIP G KL
"RTN","DID",34,0)
LOOP I $D(Y),Y=U Q
"RTN","DID",35,0)
 X DIOEND(1) I $D(M),M=U Q
"RTN","DID",36,0)
 I IOST?1"C-".E W $C(7) R X:DTIME I X[U!'$T Q
"RTN","DID",37,0)
 S DN=1,D0=0,DIB=$O(^DIC(+DIB)) Q:DIB>DIB(1)!(+DIB'=DIB)  S (F(1),DUB,DFF)=DIB,DC="," D ^DIO2 I $D(M),M=U Q
"RTN","DID",38,0)
 G LOOP
"RTN","DID",39,0)
 ;
"RTN","DID",40,0)
END ;
"RTN","DID",41,0)
 I $D(^UTILITY($J,"P")) W !!!?6,"FILES POINTED TO",?44,"FIELDS",! D PTR^DIDC
"RTN","DID",42,0)
D K ^UTILITY($J,"P") G IOF:DHIT["DIDX"!$G(DIDRANGE)
"RTN","DID",43,0)
 D IX I M=U S DN=0 Q
"RTN","DID",44,0)
T ;
"RTN","DID",45,0)
 S S=0,M=1
"RTN","DID",46,0)
T1 S S=S+1 D:$Y+3>IOSL HDR^DIDG Q:M=U
"RTN","DID",47,0)
 W !!,$S(S<4:$P("INPU^PRIN^SOR",U,S)_"T TEMPLATE(S):",1:"FORM(S)/BLOCK(S):")
"RTN","DID",48,0)
 S DFF="^DI"_$P("E^PT^BT^ST(.403)",U,S),DA=""
"RTN","DID",49,0)
 F  S DA=$O(@DFF@("F"_F(1),DA)) Q:DA=""  D  Q:M=U
"RTN","DID",50,0)
 . S DUB=0 F  S DUB=$O(@DFF@("F"_F(1),DA,DUB)) Q:'DUB  D  Q:M=U
"RTN","DID",51,0)
 .. I $D(@DFF@(DUB,0))#2 S %1=^(0) D TEMPL
"RTN","DID",52,0)
 K %1 G Q:M=U,T1:S<4
"RTN","DID",53,0)
IOF W:IOST'?1"C".E @IOF Q
"RTN","DID",54,0)
 ;
"RTN","DID",55,0)
TEMPL I $Y+3>IOSL D HDR^DIDG Q:M=U
"RTN","DID",56,0)
 W !,$P(%1,U),?30 G:DFF["DIST" FORM
"RTN","DID",57,0)
 S W="",Y=$P(%1,U,2) I Y D DD^%DT W Y
"RTN","DID",58,0)
 W ?50,"USER #"_+$P(%1,U,5),?61 I $D(@(DFF_"(DUB,""ROU"")")) W ^("ROU")_$P("*",U,DFF["DIBT")_" "
"RTN","DID",59,0)
 I $D(^("H")) S Y=^("H"),%=$L(Y) W:65+%>IOM ! W "   ",?IOM-%-1,$E(Y,1,IOM-4)
"RTN","DID",60,0)
 G DES:DFF'="^DIBT"
"RTN","DID",61,0)
 I $D(^("DIPT")) W ?55 S Y=" '"_^("DIPT")_"' Print Template always used" W:$X+$L(Y)>IOM ! W ?IOM-$L(Y)-1,Y
"RTN","DID",62,0)
 I $D(^(2)) S D0=DUB,DICMX="W !?4,X" X $P(^DD(.401,1620,0),U,5,99)
"RTN","DID",63,0)
 F Y=1:1 Q:'$D(^DIBT(DUB,"O",Y,0))  W "  " S %=^(0),D=IOM-$L(%)-5 W:$X>D !?$S(D>55:55,1:D) W %
"RTN","DID",64,0)
DES N A1,%1,X S A1=$P($G(@(DFF_"(DUB,""%D"",0)")),U,3) F %1=0:0 S %1=$O(@(DFF_"(DUB,""%D"",%1)")) Q:%1'>0  Q:+A1&(%1>A1)  S X=^(%1,0) W !,?5,X
"RTN","DID",65,0)
Q W:DFF["DIBT" ! Q
"RTN","DID",66,0)
DT G DT^DIO2
"RTN","DID",67,0)
 ;
"RTN","DID",68,0)
EN ;
"RTN","DID",69,0)
 Q:'$D(DIC)  I 'DIC,$D(@(DIC_"0)")) S DIC=+$P(^(0),U,2)
"RTN","DID",70,0)
 Q:'DIC!'$D(^DIC(DIC,0,"GL"))  S (DFF,DUB,DIB,DIB(1))=DIC
"RTN","DID",71,0)
 G O:'$D(DIFORMAT) S Y=DIFORMAT I 'Y S Y=$O(^DOPT("DID","B",Y,0))
"RTN","DID",72,0)
 Q:Y>9!'Y  G O1
"RTN","DID",73,0)
 ;
"RTN","DID",74,0)
FORM ;
"RTN","DID",75,0)
 S Y=$P(%1,U,5) I Y D DD^%DT W ?30,Y
"RTN","DID",76,0)
 W ?50,"USER #"_+$P(%1,U,4)
"RTN","DID",77,0)
 ;
"RTN","DID",78,0)
 N B,L,P
"RTN","DID",79,0)
 S L=1,L(1)=U
"RTN","DID",80,0)
 S P=0 F  S P=$O(^DIST(.403,DUB,40,P)) Q:'P  D  Q:M=U
"RTN","DID",81,0)
 . Q:$D(^DIST(.403,DUB,40,P,0))[0  S B=$P(^(0),U,2) D:B BLOCK  Q:M=U
"RTN","DID",82,0)
 . S B=0 F  S B=$O(^DIST(.403,DUB,40,P,40,B)) Q:'B  D BLOCK  Q:M=U
"RTN","DID",83,0)
 S %1=0 F  S %1=$O(@DFF@(DUB,15,%1)) Q:'%1  W:$D(^(%1,0))#2 !?5,^(0)
"RTN","DID",84,0)
 W !
"RTN","DID",85,0)
 Q
"RTN","DID",86,0)
BLOCK ;
"RTN","DID",87,0)
 N I
"RTN","DID",88,0)
 F I=1:1:L I L(I)[(U_B_U) G BLOCKQ
"RTN","DID",89,0)
 S:$L(L)+$L(B)+1>245 L=L+1,L(L)=U S L(L)=L(L)_B_U
"RTN","DID",90,0)
 Q:$D(^DIST(.404,B,0))[0  S %1=^(0)
"RTN","DID",91,0)
 ;
"RTN","DID",92,0)
 I $Y+3>IOSL D HDR^DIDG Q:M=U
"RTN","DID",93,0)
 W !?2,$P(%1,U) W:$P(%1,U,2)]"" ?32,"DD #"_$P(%1,U,2)
"RTN","DID",94,0)
BLOCKQ Q
"RTN","DID",95,0)
 ;
"RTN","DID",96,0)
IX ;Print index details
"RTN","DID",97,0)
 N DIDPG,DIDFLG
"RTN","DID",98,0)
 S DIDPG("H")="W """" D IXHEAD^DID S:M=U PAGE(U)=1"
"RTN","DID",99,0)
 D WRLN^DIKCP("",0,.DIDPG) Q:M=U
"RTN","DID",100,0)
 I DHIT="S F(1)=DFF" D
"RTN","DID",101,0)
 . S DIDFLG=$S(DIDTYP="B":"",DIDTYP="T":"O",1:"FR")_$E("M",'$G(DIDFLD))
"RTN","DID",102,0)
 E  S DIDFLG="RM"
"RTN","DID",103,0)
 S DIDFLG=DIDFLG_"SL2"_$E("N",$D(DINM)#2)
"RTN","DID",104,0)
 D PRINT^DIKCP(F(1),$G(DIDFLD),DIDFLG,.DIDPG)
"RTN","DID",105,0)
 Q
"RTN","DID",106,0)
 ;
"RTN","DID",107,0)
IXHEAD S DC=DC+1 I IOST?1"C".E W $C(7) R M:DTIME S:'$T M=U Q:M=U
"RTN","DID",108,0)
IXHEAD1 W:$D(DIFF)&($Y) @IOF S DIFF=1
"RTN","DID",109,0)
 W $S("B"[$G(DIDTYP):"INDEX AND CROSS-REFERENCE",DIDTYP="T":"TRADITIONAL CROSS-REFERENCE",1:"NEW-STYLE INDEX")
"RTN","DID",110,0)
 W " LIST -- FILE #"_DIB_$S($G(DIDFLD):", FIELD #"_DIDFLD,1:"")
"RTN","DID",111,0)
 W ?(IOM-20),$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_"    PAGE "_DC
"RTN","DID",112,0)
 S M="",$P(M,"-",IOM)="" W !,M
"RTN","DID",113,0)
 Q
"RTN","DID",114,0)
 ;
"RTN","DID",115,0)
KEY ;Print keys
"RTN","DID",116,0)
 N DIDPG
"RTN","DID",117,0)
 S DIDPG("H")="W """" D KEYHEAD^DID S:M=U PAGE(U)=1"
"RTN","DID",118,0)
 D WRLN^DIKKP("",0,.DIDPG) Q:M=U
"RTN","DID",119,0)
 D PRINT^DIKKP(F(1),"","ML2",.DIDPG)
"RTN","DID",120,0)
 Q
"RTN","DID",121,0)
 ;
"RTN","DID",122,0)
KEYHEAD S DC=DC+1 I IOST?1"C".E W $C(7) R M:DTIME S:'$T M=U Q:M=U
"RTN","DID",123,0)
KEYHEAD1 W:$D(DIFF)&($Y) @IOF S DIFF=1 W "KEY LIST -- FILE #"_DIB,?(IOM-20),$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_"    PAGE "_DC
"RTN","DID",124,0)
 S M="",$P(M,"-",IOM)="" W !,M
"RTN","DID",125,0)
 Q
"RTN","DID",126,0)
 ;
"RTN","DID",127,0)
ASKFLD(DIDFILE) ;Ask for a single field
"RTN","DID",128,0)
 Q:'$G(DIDFILE) ""
"RTN","DID",129,0)
 ;
"RTN","DID",130,0)
 N %,D,D0,DA,DDD,DIC,DICR,DIX,DO,DP,DZ,X,Y,DTOUT,DUOUT
"RTN","DID",131,0)
 S DIC="^DD("_DIDFILE_",",DIC(0)="QAEN"
"RTN","DID",132,0)
 S DIC("S")="I '$P(^(0),U,2)&($P(^(0),U,2)'[""C"")"
"RTN","DID",133,0)
 S DIC("A")="Which field: ALL// "
"RTN","DID",134,0)
 D ^DIC K DIC
"RTN","DID",135,0)
 Q $S(X="":"",1:+Y)
"RTN","DID",136,0)
 ;
"RTN","DID",137,0)
ASKTYP() ;Ask for type of cross-reference
"RTN","DID",138,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","DID",139,0)
 S DIR(0)="SAM^T:TRADITIONAL;N:NEW;B:BOTH"
"RTN","DID",140,0)
 S DIR("A")="What type of cross-reference (Traditional or New)? "
"RTN","DID",141,0)
 S DIR("B")="Both"
"RTN","DID",142,0)
 S DIR("?",1)="Enter 'T' to print only traditional cross-references."
"RTN","DID",143,0)
 S DIR("?",2)="  Traditional cross references are stored in the data"
"RTN","DID",144,0)
 S DIR("?",3)="  dictionary under ^DD(file#,field#,1)."
"RTN","DID",145,0)
 S DIR("?",4)=" "
"RTN","DID",146,0)
 S DIR("?",5)="Enter 'N' to print only new-style cross-references."
"RTN","DID",147,0)
 S DIR("?",6)="  New-Style cross references are stored in the Index file."
"RTN","DID",148,0)
 S DIR("?",7)=" "
"RTN","DID",149,0)
 S DIR("?")="Enter 'B' to print both kinds of cross-references."
"RTN","DID",150,0)
 D ^DIR
"RTN","DID",151,0)
 Q $S($D(DIRUT):"",1:Y)
"RTN","DID",152,0)
 ;
"RTN","DID",153,0)
ASKRANGE(DIDFILE,DIDBY,DIDFR,DIDTO) ;Ask for a range of fields
"RTN","DID",154,0)
 Q:'$G(DIDFILE)
"RTN","DID",155,0)
 ;
"RTN","DID",156,0)
 N %,D,D0,DA,DDD,DIC,DICR,DIX,DO,DP,DZ,X,Y,DTOUT,DUOUT
"RTN","DID",157,0)
 S DIC="^DD("_DIDFILE_",",DIC(0)="QAEN"
"RTN","DID",158,0)
 S DIC("A")="Start with field: FIRST// "
"RTN","DID",159,0)
 D ^DIC K DIC
"RTN","DID",160,0)
 I X="" S (DIDFR,DIDTO)="" Q
"RTN","DID",161,0)
 I Y=-1 S (DIDFR,DIDTO)=-1 Q
"RTN","DID",162,0)
 S DIDFR=$S(DIDBY[".001":+Y,1:$P(Y,U,2))
"RTN","DID",163,0)
 ;
"RTN","DID",164,0)
 S DIC="^DD("_DIDFILE_",",DIC(0)="QAEN"
"RTN","DID",165,0)
 S DIC("A")="Go to field: "
"RTN","DID",166,0)
 D ^DIC K DIC
"RTN","DID",167,0)
 I X="" S DIDTO="" Q
"RTN","DID",168,0)
 I Y=-1 S (DIDFR,DIDTO)=-1 Q
"RTN","DID",169,0)
 S DIDTO=$S(DIDBY[".001":+Y,1:$P(Y,U,2))
"RTN","DID",170,0)
 ;
"RTN","DID",171,0)
 S:DIDTO']]DIDFR %=DIDTO,DIDTO=DIDFR,DIDFR=%
"RTN","DID",172,0)
 Q
"RTN","DID",173,0)
 ;
"RTN","DID",174,0)
FILELST(DIDROOT) ;
"RTN","DID",175,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DID",176,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DID",177,0)
 N DIDARRAY
"RTN","DID",178,0)
 D EN4^DIQGDD
"RTN","DID",179,0)
 M @DIDROOT=DIDARRAY
"RTN","DID",180,0)
 Q
"RTN","DID",181,0)
 ;
"RTN","DID",182,0)
FILE(DIQGR,DIQGPARM,DR,DIQGTA,DIQGERRA,DIQGIPAR) ;
"RTN","DID",183,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DID",184,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DID",185,0)
 G EN2^DIQGDDF
"RTN","DID",186,0)
 ;
"RTN","DID",187,0)
FIELDLST(DIDROOT) ;
"RTN","DID",188,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DID",189,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DID",190,0)
 N DIDARRAY
"RTN","DID",191,0)
 D EN5^DIQGDD
"RTN","DID",192,0)
 M @DIDROOT=DIDARRAY
"RTN","DID",193,0)
 Q
"RTN","DID",194,0)
 ;
"RTN","DID",195,0)
FIELD(DIQGR,DA,DIQGPARM,DR,DIQGTA,DIQGERRA,DIQGIPAR) ;
"RTN","DID",196,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DID",197,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DID",198,0)
 G EN1^DIQGDD
"RTN","DID",199,0)
 ;
"RTN","DID",200,0)
GET1(DIQGR,DA,DIQGPARM,DR,DIQGETA,DIQGERRA,DIQGIPAR) ;
"RTN","DID",201,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DID",202,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DID",203,0)
 G EN3^DIQGDD
"RTN","DID",204,0)
 ;
"RTN","DID",205,0)
PIECE(DIQGR,DA,DIQGPARM,DR,DIQGTA,DIQGERRA,DIQGIPAR) ;CLOSEDREF,PIECE,FLAG,ATTRIBUTE,TARGETARRAY,ERRORARRAY,INTERNAL
"RTN","DID",206,0)
 ;PROCEDURE CALL AND  * * RETURN RESULTS IN TARGET ARRAY * *
"RTN","DID",207,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DID",208,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DID",209,0)
 G EN6^DIQGDD0
"RTN","DID1")
0^2^B21401139
"RTN","DID1",1,0)
DID1 ;SFISC/XAK,JLT-STD DD LIST ;1:53 PM  6 Mar 2002
"RTN","DID1",2,0)
 ;;22.0;VA FileMan;**7,76,105**;Mar 30, 1999
"RTN","DID1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","DID1",4,0)
 S DJ(Z)=D0,DDL1=14,DDL2=32 G B
"RTN","DID1",5,0)
 ;
"RTN","DID1",6,0)
L S DJ(Z)=0
"RTN","DID1",7,0)
A S DJ(Z)=$O(^DD(F(Z),DJ(Z))) I DJ(Z)'>0 S:DJ(Z)="" DJ(Z)=-1 W !! S Z=Z-1 Q
"RTN","DID1",8,0)
B S N=^DD(F(Z),DJ(Z),0) K DDF I $D(DIGR),Z<2!(DJ(Z)-.01) X DIGR E  G ND
"RTN","DID1",9,0)
 D HD:$Y+6>IOSL Q:M=U  W !!,F(Z),",",DJ(Z)
"RTN","DID1",10,0)
 W ?(Z+Z+12),$P(N,U,1),?DDL2+4," "_$P(N,U,4)
"RTN","DID1",11,0)
 S X=$P(N,U,2) I X,$D(^DD(+X,.01,0)) S W=$P(^(0),U,2) I W["W" W "   WORD-PROCESSING #",+X W:W["L" " (NOWRAP)" S X=""
"RTN","DID1",12,0)
 F W="BOOLEAN","COMPUTED","FREE TEXT","SET","DATE","NUMBER","POINTER","K","VARIABLE POINTER","p" I X[$E(W) D VP^DIDX:$E(W)="V" S:W="K" W="MUMPS" S:W="p" W="POINTER" W ?40," "_W G ND:M=U
"RTN","DID1",13,0)
 I +X S W=" Multiple" S W=W_" #"_+X D W G ND:M=U
"RTN","DID1",14,0)
 I X["V" S I=0 F  S I=$O(^DD(F(Z),D0,"V",I)) Q:I'>0  S %Y=$P(^(I,0),U) I $D(^DIC(%Y,0)),$D(@(^(0,"GL")_"0)")) S ^UTILITY($J,"P",$E($P(^(0),U),1,30),0)=%Y,^(F(Z),DJ(Z))=0
"RTN","DID1",15,0)
 S:I="" I=-1 G MP:X'["P"!X S Y=$P(N,U,3) I Y]"",$D(@("^"_Y_"0)")) S %Y=+$P(X,"P",2),W=" TO "_$P(^(0),U,1)_" FILE (#"_%Y_")",^UTILITY($J,"P",$E($P(^(0),U,1),1,30),0)=%Y,^(F(Z),DJ(Z))=0 D W G ND:M=U,MP
"RTN","DID1",16,0)
 S W=" ** TO AN UNDEFINED FILE ** " W:($L(W)+$X)'<IOM ! D W G ND:M=U
"RTN","DID1",17,0)
MP I X'["V" D RT^DIDX G:M=U ND
"RTN","DID1",18,0)
S I X["S" D  G ND:M=U
"RTN","DID1",19,0)
 . N N1
"RTN","DID1",20,0)
 . S N1=$P(N,U,3) F %1=1:1 S Y=$P(N1,";",%1) Q:Y=""  W ! S W="'"_$P(Y,":",1)_"' FOR "_$P(Y,":",2)_"; " D W Q:M=U
"RTN","DID1",21,0)
 G RD:$D(DINM) I X["C" S W=$P(N,U,5,99) W !?DDL1,"MUMPS CODE: " D W G ND:M=U G RD
"RTN","DID1",22,0)
 I "Q"'[$P(N,U,5) W !?DDL1,"INPUT TRANSFORM:" S W=$P(N,U,5,99) D W G ND:M=U
"RTN","DID1",23,0)
 I $D(^DD(F(Z),DJ(Z),2))#2 W !?DDL1,"OUTPUT TRANSFORM:" S W=$S($D(^DD(F(Z),DJ(Z),2.1)):^(2.1),1:^(2)) D W G ND:M=U
"RTN","DID1",24,0)
RD D ^DID2:$O(^DD(F(Z),DJ(Z),2.99))]"" G ND:M=U I 'X S W="UNEDITABLE" W:X["I" ! D W:X["I" G N
"RTN","DID1",25,0)
 I $O(^DD(+X,0,"ID",""))]"" W !?DDL1,"IDENTIFIED BY:" S W="" F %=0:0 S %=$O(^DD(+X,0,"ID",%)) S:%>0 W=W_$P(^DD(+X,%,0),U)_"(#"_%_")"_$S($P(^(0),U,2)["R":"[R]",1:"")_", " I %'>0 S:W?.E1", " W=$E(W,1,$L(W)-2) D W G ND:M=U Q
"RTN","DID1",26,0)
 ;
"RTN","DID1",27,0)
 ;Print "WRITE" identifiers
"RTN","DID1",28,0)
 I '$D(DINM) S %=" " F  S %=$O(^DD(+X,0,"ID",%)) Q:%=""  D  Q:M=U
"RTN","DID1",29,0)
 . N DIDLN,DIDPG
"RTN","DID1",30,0)
 . S DIDLN(1)=$G(^DD(+X,0,"ID",%)) Q:DIDLN(1)?."^"
"RTN","DID1",31,0)
 . S DIDLN(0)=""""_%_""":    "
"RTN","DID1",32,0)
 . S DIDLN(0)=$J("",DDL2-DDL1-$L(DIDLN(0)))_DIDLN(0)
"RTN","DID1",33,0)
 . S DIDPG("H")="W """" D H^DIDH S:M=U PAGE(U)=1"
"RTN","DID1",34,0)
 . D WRPHI^DIKCP1(.DIDLN,IOM-1-DDL2,DDL1,DDL2-DDL1,1,.DIDPG)
"RTN","DID1",35,0)
 G:M=U ND
"RTN","DID1",36,0)
 ;
"RTN","DID1",37,0)
 I $D(^DD("KEY","B",+X)) D  G:M=U ND
"RTN","DID1",38,0)
 . N DIDPG
"RTN","DID1",39,0)
 . S DIDPG("H")="W """" S DC=DC+1 D ^DIDH1 S:M=U PAGE(U)=1"
"RTN","DID1",40,0)
 . D PRINT^DIKKP(+X,"","L"_DDL1_"C"_(DDL2-DDL1),.DIDPG)
"RTN","DID1",41,0)
 I $D(^DD("IX","B",+X)) D  G:M=U ND
"RTN","DID1",42,0)
 . N DIDPG
"RTN","DID1",43,0)
 . S DIDPG("H")="W """" S DC=DC+1 D ^DIDH1 S:M=U PAGE(U)=1"
"RTN","DID1",44,0)
 . D LIST^DIKCP(+X,"","L"_DDL1_"C"_(DDL2-DDL1),.DIDPG)
"RTN","DID1",45,0)
 S Z=Z+1,DDL1=DDL1+2,DDL2=DDL2+2,F(Z)=+X
"RTN","DID1",46,0)
 D L
"RTN","DID1",47,0)
N K DDN1 I X["X" S DDN1=1 W !,?DDL1,"NOTES:",?DDL2,"XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER" W ! G ND:M=U
"RTN","DID1",48,0)
 S W=0 I $O(^DD(F(Z),DJ(Z),5,W))'="",'$D(DDN1) W !?DDL1,"NOTES:"
"RTN","DID1",49,0)
TR S W=$O(^DD(F(Z),DJ(Z),5,W)) S:W="" W=-1 G IX:W'>0 S I=^(W,0),%=+I I '$D(^DD(%,$P(I,U,2),0))!$D(W(I)) K ^DD(F(Z),DJ(Z),5,W) G TR
"RTN","DID1",50,0)
 S W(I)=0 S WS=W D WR^DIDH1 W ! S W=WS K WS G TR
"RTN","DID1",51,0)
IX S F=0 F  G ND:M=U S F=$O(^DD(F(Z),DJ(Z),1,F)) Q:F'>0  W !?DDL1,"CROSS-REFERENCE:" D IX1
"RTN","DID1",52,0)
 S:F="" F=-1
"RTN","DID1",53,0)
 I $D(^DD("IX","F",F(Z),DJ(Z))) D  S:M=U DN=0
"RTN","DID1",54,0)
 . N DIDPG,DIDFLAG
"RTN","DID1",55,0)
 . S DIDPG("H")="W """" S DC=DC+1 D ^DIDH1 S:M=U PAGE(U)=1"
"RTN","DID1",56,0)
 . S DIDFLAG="L"_DDL1_"C"_(DDL2-DDL1)_"T1"
"RTN","DID1",57,0)
 . D PRINT^DIKCP(F(Z),DJ(Z),$E("R",$G(DIDRANGE))_"FS"_DIDFLAG_$E("N",$D(DINM)#2),.DIDPG) Q:M=U
"RTN","DID1",58,0)
 . D:'$G(DIDRANGE) LIST^DIKCP(F(Z),DJ(Z),"RS"_DIDFLAG,.DIDPG)
"RTN","DID1",59,0)
ND S X="" G:M'=U A:Z>1 Q
"RTN","DID1",60,0)
IX1 S W=^(F,0)_" " K DDF W ?DDL2,W,! G ND:M=U D TP:$P(W,U,3)["TRIG" I '$D(DINM) S X=0 F %=0:0 S X=$O(^DD(F(Z),DJ(Z),1,F,X)) Q:X=""  I X'="%D",X'="DT" S W=^(X) S:$L(W)<248 W=X_")= "_W K:X=3 DDF D W W ! G ND:M=U
"RTN","DID1",61,0)
 Q:'$D(^("%D"))
"RTN","DID1",62,0)
 ;
"RTN","DID1",63,0)
 N DIDI,DIDN,DIDZ,DIWF,DIWL,DIWR,X
"RTN","DID1",64,0)
 K ^UTILITY($J,"W")
"RTN","DID1",65,0)
 S DIWF="W",DIWL=DDL2+1,DIWR=IOM,DIDZ=Z
"RTN","DID1",66,0)
 S DIDN=$P($G(^DD(F(DIDZ),DJ(DIDZ),1,F,"%D",0)),U,3),DIDI=0
"RTN","DID1",67,0)
 F  S DIDI=$O(^DD(F(DIDZ),DJ(DIDZ),1,F,"%D",DIDI)) Q:'DIDI!(DIDN&(DIDI>DIDN))  S X=^(DIDI,0) D ^DIWP I $D(DN),'DN S M=U Q
"RTN","DID1",68,0)
 I M'=U D ^DIWW I $D(DN),'DN S M=U
"RTN","DID1",69,0)
 I M'=U W !
"RTN","DID1",70,0)
 E  K DIOEND
"RTN","DID1",71,0)
 S Z=DIDZ
"RTN","DID1",72,0)
 K ^UTILITY($J,"W")
"RTN","DID1",73,0)
 Q
"RTN","DID1",74,0)
 ;
"RTN","DID1",75,0)
TP S X=+$P(^(0),U,4) I F(Z)-X,$D(^DIC(X,0))#2 S ^UTILITY($J,"P",$E($P(^(0),U,1),1,30),0)=X,^(F(Z),DJ(Z))=6
"RTN","DID1",76,0)
 Q
"RTN","DID1",77,0)
W F K=0:0 W:$D(DDF) ! S:(($L(W)+DDL2)>IOM) DDL2=32 W ?DDL2 S %Y=$E(W,IOM-$X,999) W $E(W,1,IOM-$X-1) Q:%Y=""  S W=%Y,DDF=1
"RTN","DID1",78,0)
 K:'X DDF Q:$Y+6<IOSL
"RTN","DID1",79,0)
HD S DC=DC+1 D ^DIDH Q
"RTN","DID2")
0^6^B19296587
"RTN","DID2",1,0)
DID2 ;SFISC/GFT-MODIFIED DD ;9:41 AM  23 Dec 2002
"RTN","DID2",2,0)
 ;;22.0;VA FileMan;**7,105**;Mar 30, 1999
"RTN","DID2",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","DID2",4,0)
 I $D(DINM) G DZ:X'["C"!(X["X")!'$D(^DD(F(Z),DJ(Z),9.1)) S %Y=X,X=^(9.1),W=" --  "_X D ^DIM,W1^DIDH1:'$D(X) S X=%Y G Q:M=U G DZ
"RTN","DID2",5,0)
 F I=9.2:.1 Q:'$D(^(I))#2  W ! S W=I_" = "_^(I) D W G Q:M=U
"RTN","DID2",6,0)
 I $D(^(9.1))#2 S W=^(9.1),%Y="9.1 = " S:X["C" %Y="ALGORITHM:  " W !,?DDL1,%Y D W S W=$P("  (ALWAYS "_$E(N,$L(N)-1)_" DECIMAL DIGITS)",U,N?.E1" S X=$J(X,0,"1N1")") D W G Q:M=U
"RTN","DID2",7,0)
DZ ;
"RTN","DID2",8,0)
 I $D(^("DT")) S Y=^("DT") D D^DIQ W !?DDL1,"LAST EDITED: " S W=Y D W1^DIDH1 G Q:M=U
"RTN","DID2",9,0)
H K W I $D(^DD(F(Z),DJ(Z),3)),^(3)]"" W !?DDL1,"HELP-PROMPT:" S W=^(3) D W1^DIDH1 G Q:M=U
"RTN","DID2",10,0)
 F %Y=21,23 I $O(^DD(F(Z),DJ(Z),%Y,0))>0 D DE^DIDH1 G:M=U Q
"RTN","DID2",11,0)
SC ;
"RTN","DID2",12,0)
 I $D(^DD(F(Z),DJ(Z),12.1)),'$D(DINM) I X["P"!(X["S") W !?DDL1,"SCREEN:" S W=^(12.1) D W I $D(^(12)) W !?DDL1,"EXPLANATION:" S W=^(12) D W G Q:M=U
"RTN","DID2",13,0)
 I '$D(DINM),$D(^DD(F(Z),DJ(Z),4)),^(4)]"" W !?DDL1,"EXECUTABLE HELP:" S W=^(4) D W G Q:M=U
"RTN","DID2",14,0)
 I $D(^(9.02))#2 W !?DDL1,"SUM:" S W=^(9.02) D W G Q:M=U
"RTN","DID2",15,0)
AUD S W=$G(^DD(F(Z),DJ(Z),"AUDIT")) I "n"'[W D  G:M=U Q
"RTN","DID2",16,0)
 . W !?DDL1,"AUDIT: "
"RTN","DID2",17,0)
 . S W=$S(W="y":"YES, ALWAYS",W="e":"EDITED OR DELETED",1:W) D W Q:M=U
"RTN","DID2",18,0)
 . S W=$G(^DD(F(Z),DJ(Z),"AX"))
"RTN","DID2",19,0)
 . I '$D(DINM),W]"" W !?DDL1,"AUDIT CONDITION: " D W
"RTN","DID2",20,0)
PRELKUP I '$D(DINM),DJ(Z)=.01,$G(^DD(F(Z),DJ(Z),7.5))]"" W !?DDL1,"PRE-LOOKUP: " S W=^(7.5) D W G:M=U Q
"RTN","DID2",21,0)
DEL N DIDND
"RTN","DID2",22,0)
 I '$D(DINM) S DIDND=$O(^DD(F(Z),DJ(Z),"DEL","")) I DIDND]"" D  G:M=U Q W !
"RTN","DID2",23,0)
 . W !?DDL1,"DELETE TEST: "
"RTN","DID2",24,0)
 . F  D  S DIDND=$O(^DD(F(Z),DJ(Z),"DEL",DIDND)) Q:DIDND=""!(M=U)  W !!
"RTN","DID2",25,0)
 .. W ?DDL2,$$QT(DIDND)_",0)= "
"RTN","DID2",26,0)
 .. S W=$G(^DD(F(Z),DJ(Z),"DEL",DIDND,0)) D W
"RTN","DID2",27,0)
LAYGO I '$D(DINM),DJ(Z)=.01 S DIDND=$O(^DD(F(Z),DJ(Z),"LAYGO","")) I DIDND]"" D  G:M=U Q W !
"RTN","DID2",28,0)
 . W !?DDL1,"LAYGO TEST: "
"RTN","DID2",29,0)
 . F  D  S DIDND=$O(^DD(F(Z),DJ(Z),"LAYGO",DIDND)) Q:DIDND=""!(M=U)  W !!
"RTN","DID2",30,0)
 .. W ?DDL2,$$QT(DIDND)_",0)= "
"RTN","DID2",31,0)
 .. S W=$G(^DD(F(Z),DJ(Z),"LAYGO",DIDND,0)) D W
"RTN","DID2",32,0)
D I $D(^(8.5)) W !?DDL1,"DELETE AUTHORITY: " S W=^(8.5) D W G Q:M=U
"RTN","DID2",33,0)
 I X'["C",$D(^(9))#2,^(9)]"" W !?DDL1,"WRITE AUTHORITY:" S W=^(9) D W G Q:M=U
"RTN","DID2",34,0)
RD I $D(^(8))#2,^(8)]"" W !?DDL1,"READ AUTHORITY:" S W=^(8) D W G Q:M=U
"RTN","DID2",35,0)
 I $D(^(10))#2,^(10)]"" W !?DDL1,"SOURCE OF DATA:" S W=^(10) D W G Q:M=U
"RTN","DID2",36,0)
 I $O(^(11,0))>0 W !?DDL1,"DATA DESTINATION:" S I=0 F  S I=$O(^DD(F(Z),DJ(Z),11,I)) Q:I=""  S:$D(^DIC(.2,+^(I,0),0)) W=$P(^(0),U)
"RTN","DID2",37,0)
 I  S I=-1 D W G Q:M=U
"RTN","DID2",38,0)
 I $O(^DD(F(Z),DJ(Z),20,0))>0 W !?DDL1,"GROUP:" S I=0 F  S I=$O(^DD(F(Z),DJ(Z),20,I)) Q:I=""  S W=$P(^(I,0),U)
"RTN","DID2",39,0)
 I  S I=-1 D W
"RTN","DID2",40,0)
 Q
"RTN","DID2",41,0)
 ;
"RTN","DID2",42,0)
W F K=0:0 S:(($L(W)+DDL2)>IOM) DDL2=32 W ?DDL2 S %Y=$E(W,IOM-$X,999) W $E(W,1,IOM-$X-1) Q:%Y=""  S W=%Y W !
"RTN","DID2",43,0)
 I $Y+6>IOSL S DC=DC+1 D ^DIDH
"RTN","DID2",44,0)
 I $D(^DD(F(Z),DJ(Z),0))
"RTN","DID2",45,0)
 Q
"RTN","DID2",46,0)
 ;
"RTN","DID2",47,0)
Q G ND^DID1
"RTN","DID2",48,0)
 ;
"RTN","DID2",49,0)
MOD ;FROM DID
"RTN","DID2",50,0)
 S X=U,%=2 W !,"WANT THE LISTING TO INCLUDE MUMPS CODE" D YN^DICN Q:%<0  S:%=2 DINM=1 I '% W !?5,"Enter YES, to see the MUMPS code as in the STANDARD listing.",!?5,"Enter NO, to eliminate MUMPS code from the listing." G MOD
"RTN","DID2",51,0)
MOD2 S %=2 W !,"WANT TO RESTRICT LISTING TO CERTAIN GROUPS OF FIELDS" D YN^DICN S:%=2 X=0 Q:%<0!(%=2)  I '% W !?5,"Enter YES, to select the Groups you wish to see in this listing.",!?5,"Enter NO, to see all fields." G MOD2
"RTN","DID2",52,0)
 W ! S DP="",L=""","_$S(Y-2:"DJ(Z)",1:"D1")_"))"
"RTN","DID2",53,0)
G R "Include GROUP: ",X:DTIME S:'$T X=U,DTOUT=1 I X[""""!($L(X)>30)!(X'?.ANP) W $C(7),!,"SORRY, THAT ISN'T WHAT A 'GROUP' NAME CAN LOOK LIKE",! G G
"RTN","DID2",54,0)
 Q:X[U  I X'?."?" S C="!" S:X?1"'"1E.E X=$E(X,2,99),C="&'" S DP=DP_C_"$D(^DD(F(Z),""GR"","""_X_L W !,"And " G G
"RTN","DID2",55,0)
 I X="" S:DP]"" DIGR="I "_$E(DP,2,999) Q
"RTN","DID2",56,0)
 W !?5,"To list only those fields which have a particular 'GROUP'",!?5,"(or several 'GROUPS') associated with them, Enter the GROUP NAME",!
"RTN","DID2",57,0)
 W ?5,"To screen out a group, Type ""'"" in front of its name.",!
"RTN","DID2",58,0)
 G G
"RTN","DID2",59,0)
 ;
"RTN","DID2",60,0)
QT(X) ;Quote X if noncanonic
"RTN","DID2",61,0)
 Q:X=+$P(X,"E") X
"RTN","DID2",62,0)
 S X=$NA(X(X)),X=$E(X,3,$L(X)-1)
"RTN","DID2",63,0)
 Q X
"RTN","DIDC")
0^3^B11995156
"RTN","DIDC",1,0)
DIDC ;SFISC-CONDENSED DD ;10:02 AM  4 Mar 2002
"RTN","DIDC",2,0)
 ;;22.0;VA FileMan;**19,105**;Mar 30, 1999
"RTN","DIDC",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","DIDC",4,0)
 S DM="",DAT=$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3),X="I $Y+3>IOSL W $C(7) D P"
"RTN","DIDC",5,0)
EN S N(0)=$O(^DD(X1),-1),I=0 F  S N(0)=$O(^DD(N(0))) Q:N(0)'>0!(N(0)>X2)  S NAME=$O(^DD(N(0),0,"NM",0)) I NAME'="" S P=0 D P,P2 G:DM["^" EXIT
"RTN","DIDC",6,0)
EXIT K %DT,%ZIS,DAT,I,J,K,K1,M,N,N1,NAME,MO,P,X,X1,X2,Y,KK,NF,NY,POP S D0="B",M=DM K DM Q
"RTN","DIDC",7,0)
P S P=P+1 I IOST?1"C-".E R:P'=1 DM:DTIME Q:DM["^"!'$T
"RTN","DIDC",8,0)
 W:$D(DIFF)&($Y) @IOF S DIFF=1 W !!,"CONDENSED DATA DICTIONARY---",NAME," FILE"," (#",N(0),")" I $D(^%ZOSF("UCI"))#2 X ^("UCI") W ?47,"UCI: "_Y
"RTN","DIDC",9,0)
 W ?63,$S($G(^DD(N(0),0,"VR"))]"":"   VERSION: "_$P(^("VR"),U),1:" ") W !!,"STORED IN: ",$S($D(^DIC(N(0),0,"GL")):^("GL"),1:""),?58,DAT,?70,"PAGE ",P W ! F I=0:1:IOM-1 W "-"
"RTN","DIDC",10,0)
 G P1:P'=1 W !!,?50,"FILE SECURITY"
"RTN","DIDC",11,0)
 W !,?35,"DD SECURITY    : ",$S($D(^DIC(N(0),0,"DD")):^("DD"),1:""),?58,"DELETE SECURITY: ",$S($D(^("DEL")):^("DEL"),1:"")
"RTN","DIDC",12,0)
 W !,?35,"READ SECURITY  : ",$S($D(^("RD")):^("RD"),1:""),?58,"LAYGO SECURITY : ",$S($D(^("LAYGO")):^("LAYGO"),1:"")
"RTN","DIDC",13,0)
 W !,?35,"WRITE SECURITY : ",$S($D(^("WR")):^("WR"),1:"")
"RTN","DIDC",14,0)
 I $D(^VA(200,"AFOF")) W !?10,"(NOTE: Kernel's File Access Security has been installed in this UCI.)",!
"RTN","DIDC",15,0)
 W !,"CROSS REFERENCED BY:",!,?5
"RTN","DIDC",16,0)
 S NY="" F KK=1:1 S NY=$O(^DD(N(0),0,"IX",NY)) Q:NY=""  S NF=+$O(^(NY,0)),N1=+$O(^(NF,0)) D
"RTN","DIDC",17,0)
 .N % S %=0 F  S %=$O(^DD(NF,N1,1,%)) Q:'%  I $D(^(%,0)),+^(0)=N(0),$P(^(0),U,2)=NY W:$X>50&($L($P(^DD(NF,N1,0),"^",1)>20)) !,?5 W " ",$P(^DD(NF,N1,0),"^",1),"(",NY,") "
"RTN","DIDC",18,0)
 D LIST^DIKCP(N(0),"","M")
"RTN","DIDC",19,0)
P1 W !!!,?33,"FILE STRUCTURE",!! W "FIELD",?10,"FIELD",!,"NUMBER",?10,"NAME",! Q
"RTN","DIDC",20,0)
P2 S M(0)=0 F K1=0:0 S M(0)=$O(^DD(N(0),M(0))),K=0 Q:+M(0)'>0!(M(0)?1U.U)  X X Q:DM["^"  W !,M(0),?10,$P(^DD(N(0),M(0),0),U,1)," " D M I J S K=K+1 D MO Q:DM["^"
"RTN","DIDC",21,0)
 Q
"RTN","DIDC",22,0)
MO X X Q:DM["^"  S N(K)=+$P(^DD(N(K-1),M(K-1),0),U,2) S M(K)=0
"RTN","DIDC",23,0)
 F L=0:0 S M(K)=$O(^DD(N(K),M(K))) Q:M(K)'>0  X X Q:DM["^"  W !,?10+((K-1)*5),M(K),?15+((K-1)*5),$P(^DD(N(K),M(K),0),U,1)," " D M I J S K=K+1 D MO Q:DM["^"
"RTN","DIDC",24,0)
 Q:DM["^"  X X Q:DM["^"  S K=K-1 Q
"RTN","DIDC",25,0)
M S J=$P(^(0),U,2) W $S(+J:"(Multiple-"_+J,1:"("_J),"), [",$P(^(0),U,4),"]"
"RTN","DIDC",26,0)
 Q
"RTN","DIDC",27,0)
PTR ;
"RTN","DIDC",28,0)
 S F=0,I=0 F  S F=$O(^UTILITY($J,"P",F)) Q:F=""  D PT
"RTN","DIDC",29,0)
 S F=-1 Q
"RTN","DIDC",30,0)
PT W !,F_" " W:$X>24 !?19 W "(#"_^(F,0)_") "
"RTN","DIDC",31,0)
 S %=0 F  S %=$O(^UTILITY($J,"P",F,%)) Q:%=""  W ?33," ",$S(%=F(1):"",1:$P(^DD(%,0)," SUB-FIELD",1)_":") S S=0 F  S S=$O(^UTILITY($J,"P",F,%,S)) Q:S=""  W ?34,$P(^DD(%,S,0),U)," (#"_S_")",!
"RTN","DIDC",32,0)
 S (%,S)=-1 Q
"RTN","DIDC",33,0)
 ;
"RTN","DIDC",34,0)
L ; CUSTOM LOOP
"RTN","DIDC",35,0)
 I $G(Y)=U!($G(M)=U) G Q
"RTN","DIDC",36,0)
 I DJ,IOST?1"C-".E W $C(7) R X:DTIME I X[U!'$T G Q
"RTN","DIDC",37,0)
 K ^UTILITY($J,0)
"RTN","DIDC",38,0)
DD S DIB=$O(^DD(+DIB)) G:DIB>DIB(1)!(+DIB'=DIB) Q G:$D(^(DIB,0))[0 DD
"RTN","DIDC",39,0)
 I $G(DIPP(0,"IX"))["^DD(DFF,""AUDIT""",$O(^DD(DIB,"AUDIT",""))="" G DD:'$D(^DIC(DIB)) D  G:'DIB!(DIB>DIB(1)) Q
"RTN","DIDC",40,0)
 . F  S DIB=$O(^DIC(+DIB)) Q:'DIB!(DIB>DIB(1))  Q:$O(^DD(DIB,"AUDIT",""))]""
"RTN","DIDC",41,0)
 S %X="DIPP(",%Y="DPP(" D %XY^%RCR S DPP=DIPP,L=0
"RTN","DIDC",42,0)
 S DISEARCH=1,DFF=DIB,DJ=DIJS,DPQ=DIPQ,M=DIMS S:'$D(DIA) DC="," G ^DIO
"RTN","DIDC",43,0)
Q S DFF=DIB(1) G STOP^DIO4
"RTN","DIDG")
0^4^B10960393
"RTN","DIDG",1,0)
DIDG ;SFISC/RWF-GLOBAL MAP ;1:24 PM  1 Mar 2002
"RTN","DIDG",2,0)
 ;;22.0;VA FileMan;**105**;Mar 30, 1999
"RTN","DIDG",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","DIDG",4,0)
 K W S DJ(Z)=D0,F=0,W=F(Z),M=1,DP=0
"RTN","DIDG",5,0)
 W !
"RTN","DIDG",6,0)
UP I $D(^DD(W,0,"UP")) S Y=^("UP"),N=$O(^DD(Y,"SB",W,0)) I $D(^DD(Y,N,0)) S F=F+1,W(F)=$P($P(^(0),U,4),";",1),W=Y G UP
"RTN","DIDG",7,0)
 S W=$S($D(^DIC(W,0,"GL")):^("GL"),1:"^("),Y=0 F N=F:-1:1 S W=W_"D"_Y_","_$S(+W(N)=W(N):W(N),1:""""_W(N)_"""")_",",Y=Y+1
"RTN","DIDG",8,0)
 S DID(Z-1)=W K W
"RTN","DIDG",9,0)
 ;
"RTN","DIDG",10,0)
L S DN(Z)=""
"RTN","DIDG",11,0)
A S DN(Z)=$O(^DD(F(Z),"GL",DN(Z))),DP(0)=0 I DN(Z)="" D POP Q
"RTN","DIDG",12,0)
 S DID(Z)=DID(Z-1)_"D"_(F+Z-1)_","_DN(Z) I $O(^DD(F(Z),"GL",DN(Z),""))'=0 S W=DID(Z)_")=" W ! D WL Q:M=U
"RTN","DIDG",13,0)
B S DP=$O(^DD(F(Z),"GL",DN(Z),DP)) G PUSH:DP=0,A:DP=""
"RTN","DIDG",14,0)
 S DF=$O(^DD(F(Z),"GL",DN(Z),DP,0))
"RTN","DIDG",15,0)
 I DP(0)+1<DP F I1=DP(0)+1:1:DP-1 S W=" ^ " D WL Q:M=U
"RTN","DIDG",16,0)
 S N=^DD(F(Z),DF,0),DP(0)=DP
"RTN","DIDG",17,0)
 S X=$P(N,U,2) I +X S Z=Z+1,F(Z)=+X D L G B
"RTN","DIDG",18,0)
 S W="(#"_DF_") "_$P(N,U,1)_" ["_DP
"RTN","DIDG",19,0)
 F Y="F","S","D","N","P","W","V","K" I X[Y S W=W_Y S:Y="P" W=W_":"_+$P(X,"P",2)
"RTN","DIDG",20,0)
 S W=W_"] ^ " D WL Q:M=U  G B
"RTN","DIDG",21,0)
 ;
"RTN","DIDG",22,0)
PUSH S N=$O(^DD(F(Z),"GL",DN(Z),DP,0)) S:N="" N=-1 S Y=^DD(F(Z),N,0),DID(Z)=DID(Z)_","
"RTN","DIDG",23,0)
 W !,DID(Z)_"0)=^"_$P(Y,U,2)_"^^  (#",N,") "_$P(Y,U,1) S Z=Z+1,F(Z)=+$P(Y,U,2)
"RTN","DIDG",24,0)
 D L Q:M=U  G A
"RTN","DIDG",25,0)
 ;
"RTN","DIDG",26,0)
POP S Z=Z-1,DID(Z)=$E(DID(Z),1,$L(DID(Z))-1) Q:Z  K DN,W,DP,DG,DID S DN=0 W ! Q
"RTN","DIDG",27,0)
 ;
"RTN","DIDG",28,0)
END ;
"RTN","DIDG",29,0)
 S S=0,M=1
"RTN","DIDG",30,0)
T1 S S=S+1 D:$Y+3>IOSL HDR Q:M=U
"RTN","DIDG",31,0)
 W !!,$S(S<4:$P("INPU^PRIN^SOR",U,S)_"T TEMPLATE(S):",1:"FORM(S)/BLOCK(S):")
"RTN","DIDG",32,0)
 S DFF="^DI"_$P("E^PT^BT^ST(.403)",U,S),DA=""
"RTN","DIDG",33,0)
 F  S DA=$O(@DFF@("F"_F(1),DA)) Q:DA=""  D  Q:M=U
"RTN","DIDG",34,0)
 . S DUB=0 F  S DUB=$O(@DFF@("F"_F(1),DA,DUB)) Q:DUB'>0  D  Q:M=U
"RTN","DIDG",35,0)
 .. I $D(@DFF@(DUB,0))#2 S %1=^(0) D TEMPL
"RTN","DIDG",36,0)
 K %1 Q:M=U  G T1:S<4
"RTN","DIDG",37,0)
Q Q
"RTN","DIDG",38,0)
TEMPL I $Y+3>IOSL D HDR Q:M=U
"RTN","DIDG",39,0)
 N % S %=$S($D(^("ROU")):"Compiled: "_^("ROU"),'$D(^("ROU"))&($D(^("ROUOLD"))):"Previously Compiled: "_^("ROUOLD"),1:"")
"RTN","DIDG",40,0)
 I %]"",DFF["DIBT" S %=%_"*"
"RTN","DIDG",41,0)
 I DFF'["DIST" W !,DFF,"("_DUB_")= ",$P(%1,U)_"    "_%
"RTN","DIDG",42,0)
 E  D FORM
"RTN","DIDG",43,0)
 Q
"RTN","DIDG",44,0)
WL I $Y+4>IOSL S %1=W D HD Q:M=U  S W=%1 I W[DID(Z) S W=""
"RTN","DIDG",45,0)
 F I=1:1 S Y=$P(W," ",I)_" " Q:$P(W," ",I,99)=""  W:$X+$L(Y)+2>IOM !,?$L(DID(Z)),"==>" W Y
"RTN","DIDG",46,0)
 Q
"RTN","DIDG",47,0)
W W:$X+$L(W)+3>IOM !,?$S(IOM-$L(W)-5<M:IOM-5-$L(W),1:M),S S %Y=$E(W,IOM-$X,999) W $E(W,1,IOM-$X-1),S Q:%Y=""  S W=%Y G W
"RTN","DIDG",48,0)
 ;
"RTN","DIDG",49,0)
HD S DC=DC+1 D ^DIDH Q:M=U  W !,DID(Z),")= " Q
"RTN","DIDG",50,0)
 ;
"RTN","DIDG",51,0)
HDR ;
"RTN","DIDG",52,0)
 S DC=DC+1 I IOST?1"C".E W $C(7) R M:DTIME S:'$T M=U Q:M=U
"RTN","DIDG",53,0)
H1 W:$D(DIFF)&($Y) @IOF S DIFF=1 W "TEMPLATE LIST  --  FILE #"_DIB,?(IOM-20),$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_"    PAGE "_DC
"RTN","DIDG",54,0)
 S M="",$P(M,"-",IOM)="" W !,M
"RTN","DIDG",55,0)
 Q
"RTN","DIDG",56,0)
 ;
"RTN","DIDG",57,0)
FORM ;
"RTN","DIDG",58,0)
 W !,"^DIST(.403,"_DUB_")= ",$P(%1,U)_"    "_%
"RTN","DIDG",59,0)
 ;
"RTN","DIDG",60,0)
 N B,L,P
"RTN","DIDG",61,0)
 S L=1,L(1)=U
"RTN","DIDG",62,0)
 S P=0 F  S P=$O(^DIST(.403,DUB,40,P)) Q:'P  D  Q:M=U
"RTN","DIDG",63,0)
 . Q:$D(^DIST(.403,DUB,40,P,0))[0  S B=$P(^(0),U,2) D:B BLOCK  Q:M=U
"RTN","DIDG",64,0)
 . S B=0 F  S B=$O(^DIST(.403,DUB,40,P,40,B)) Q:'B  D BLOCK  Q:M=U
"RTN","DIDG",65,0)
 W !
"RTN","DIDG",66,0)
 Q
"RTN","DIDG",67,0)
BLOCK ;
"RTN","DIDG",68,0)
 N I
"RTN","DIDG",69,0)
 F I=1:1:L I L(I)[(U_B_U) G BLOCKQ
"RTN","DIDG",70,0)
 S:$L(L)+$L(B)+1>245 L=L+1,L(L)=U S L(L)=L(L)_B_U
"RTN","DIDG",71,0)
 Q:$D(^DIST(.404,B,0))[0  S %1=^(0)
"RTN","DIDG",72,0)
 ;
"RTN","DIDG",73,0)
 I $Y+3>IOSL D HDR Q:M=U
"RTN","DIDG",74,0)
 W !?2,"^DIST(.404,"_B_")= ",$P(%1,U)
"RTN","DIDG",75,0)
BLOCKQ Q
"RTN","DIDH1")
0^5^B18698333
"RTN","DIDH1",1,0)
DIDH1 ;SFISC-HDR FOR DD LISTS ;1:51 PM  6 Mar 2002
"RTN","DIDH1",2,0)
 ;;22.0;VA FileMan;**76,105**;Mar 30, 1999
"RTN","DIDH1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","DIDH1",4,0)
 N DIDHI,DIDHJ D
"RTN","DIDH1",5,0)
 .N I,J D IJ^DIUTL(DFF) M DIDHJ=J,DIDHI=I S DIDHJ=$O(J(""),-1)
"RTN","DIDH1",6,0)
 S M=1 I DC=1 S (F(1),DA)=DFF,Z=1
"RTN","DIDH1",7,0)
 E  I $Y,IOST?1"C".E W $C(7) R M:DTIME I M=U!'$T K DIOEND S M=U,DN=0 Q
"RTN","DIDH1",8,0)
 S M1=$S($G(^DD(F(1),0,"VR"))]"":" (VERSION "_$P(^("VR"),U)_")   ",1:"") I IOST?1"C".E S DIFF=1
"RTN","DIDH1",9,0)
 W:$D(DIFF)&($Y) @IOF S DIFF=1 W $S(DHIT["DIDX":"BRIEF",DHIT["DIDG":"GLOBAL MAP",$D(DINM):"MODIFIED",1:"STANDARD")
"RTN","DIDH1",10,0)
 W " DATA DICTIONARY #"_DFF_" -- "_$O(^DD(DFF,0,"NM",0))_" "_$S(DIDHJ:"SUB-",1:"")_"FILE   "
"RTN","DIDH1",11,0)
 S DIC=^DIC(DUB,0,"GL") D
"RTN","DIDH1",12,0)
 .N X,Y
"RTN","DIDH1",13,0)
 .X ^DD("FUNC",24,1) S Y=X X ^DD("DD")
"RTN","DIDH1",14,0)
 .S W=Y_"  PAGE "_DC W:$L(W)+$X+2>IOM ! W ?(IOM-$L(W)-1),W
"RTN","DIDH1",15,0)
 S M=IOM\2,S=" ",W="" I $D(^DD("SITE")) S W="SITE: "_^("SITE")_"   "
"RTN","DIDH1",16,0)
 I $D(^%ZOSF("UCI"))#2 X ^("UCI") S W=W_"UCI: "_Y
"RTN","DIDH1",17,0)
 W ! I DHIT["DIDX" W W,?(IOM-$L(M1)-1),M1 S W="",$P(W,"-",IOM)="" W !,W S W="" G Q^DIDH
"RTN","DIDH1",18,0)
 W "STORED IN ",DIC F I=1:1 Q:'$D(DIDHI(I))  W "D",I-1,",",DIDHI(I),","
"RTN","DIDH1",19,0)
 I 'DIDHJ D
"RTN","DIDH1",20,0)
 .I $O(@(DIC_"0)"))'>0 W "  *** NO DATA STORED YET ***" Q
"RTN","DIDH1",21,0)
 .S I=$P(^(0),U,4) W:I "  ("_I_" ENTR"_$S(I=1:"Y)",1:"IES)")
"RTN","DIDH1",22,0)
 W "   ",W,?(IOM-$L(M1)-1),M1 D:DHIT'["DIDG"
"RTN","DIDH1",23,0)
 .W !!,"DATA",?14,"NAME",?36,"GLOBAL",?50,"DATA",!,"ELEMENT",?14,"TITLE",?36,"LOCATION",?50,"TYPE"
"RTN","DIDH1",24,0)
G W ! F I=1:1:IOM-1 W "-"
"RTN","DIDH1",25,0)
 S W="" Q:DC>1!$G(DIDRANGE)
"RTN","DIDH1",26,0)
PAGE1 I 'DIDHJ,'$$WP^DIUTL($NA(^DIC(DA,"%D"))) S M="^" Q
"RTN","DIDH1",27,0)
 I DIDHJ D  I M=U Q
"RTN","DIDH1",28,0)
 .S W=DIDHJ(DIDHJ-1),W=$NA(^DD(W,+$O(^DD(W,"SB",DFF,"")))) I '$$WP^DIUTL($NA(@W@(21))) S M=U Q
"RTN","DIDH1",29,0)
 .I $D(@W@(23)) W !,"TECHNICAL DESCRIPTION:",! I '$$WP^DIUTL($NA(@W@(23))) S M=U
"RTN","DIDH1",30,0)
 .F I=8,9 I $D(@W@(I)) W !,?15,$P("READ^WRITE",U,I-7)," ACCESS: ",^(I)
"RTN","DIDH1",31,0)
 I DHIT["DIDG" D  Q
"RTN","DIDH1",32,0)
 . D XR^DIDH Q:M=U
"RTN","DIDH1",33,0)
 . N DIDPG S DIDPG("H")="W """" D H^DIDH S:M=U PAGE(U)=1"
"RTN","DIDH1",34,0)
 . D LIST^DIKCP(DA,"","C15",.DIDPG) Q:M=U
"RTN","DIDH1",35,0)
 . D WRLN^DIKCP1("",0,.DIDPG)
"RTN","DIDH1",36,0)
 Q:DHIT["DIDX"!(M=U)  W !
"RTN","DIDH1",37,0)
 F %=1:1:4 S X=$P("SCR^DIC^ACT^DIK",U,%) I $G(^DD(DA,0,X))]"" W !,$P("FILE SCREEN (SCR-node) ^SPECIAL LOOKUP ROUTINE ^POST-SELECTION ACTION  ^COMPILED CROSS-REFERENCE ROUTINE",U,%)_": " S W=^(X) D W^DIDH G Q:M=U
"RTN","DIDH1",38,0)
 W:$P($G(^DD(DA,0,"DI")),U)["Y" !,"THIS IS AN ARCHIVE FILE."
"RTN","DIDH1",39,0)
 W:$P($G(^DD(DA,0,"DI")),U,2)["Y" !,"EDITING OF FILE IS NOT ALLOWED."
"RTN","DIDH1",40,0)
 F N="DD","RD","WR","DEL","LAYGO","AUDIT" I $D(^DIC(DA,0,N)) W !?(Z+Z+14-$L(N)),N," ACCESS: ",^(N)
"RTN","DIDH1",41,0)
 I $D(^VA(200,"AFOF")) W !!?8,"(NOTE: Kernel's File Access Security has been installed in this UCI.)",!
"RTN","DIDH1",42,0)
 I $O(^DD(DA,0,"ID",""))]"" W !,"IDENTIFIED BY: "
"RTN","DIDH1",43,0)
 S X=0 F  S X=$O(^DD(DA,0,"ID",X)) Q:X=""  Q:'$D(^DD(DA,X,0))  S I1=$P(^(0),U)_" (#"_X_")"_$S($P(^(0),U,2)["R":"[R]",1:"") W:($L(I1)+$X)+1>IOM ! W ?15,I1 I $O(^DD(DA,0,"ID",X)) W ", "
"RTN","DIDH1",44,0)
 S:X="" X=-1
"RTN","DIDH1",45,0)
 ;
"RTN","DIDH1",46,0)
 ;Print "WRITE" identifiers
"RTN","DIDH1",47,0)
 I '$D(DINM) S X=" " F  S X=$O(^DD(DA,0,"ID",X)) Q:X=""  D  Q:M=U
"RTN","DIDH1",48,0)
 . N DIDLN,DIDPG
"RTN","DIDH1",49,0)
 . S DIDLN(1)=$G(^DD(DA,0,"ID",X)) Q:DIDLN(1)?."^"
"RTN","DIDH1",50,0)
 . S DIDLN(0)=""""_X_""": "
"RTN","DIDH1",51,0)
 . S DIDLN(0)=$J("",15-$L(DIDLN(0)))_DIDLN(0)
"RTN","DIDH1",52,0)
 . S DIDPG("H")="W """" D H^DIDH S:M=U PAGE(U)=1"
"RTN","DIDH1",53,0)
 . D WRPHI^DIKCP1(.DIDLN,IOM-16,0,15,1,.DIDPG)
"RTN","DIDH1",54,0)
 Q:M=U
"RTN","DIDH1",55,0)
 ;
"RTN","DIDH1",56,0)
 I $D(^DD("KEY","B",DA)) D
"RTN","DIDH1",57,0)
 . N DIDPG
"RTN","DIDH1",58,0)
 . S DIDPG("H")="W """" D H^DIDH S:M=U PAGE(U)=1"
"RTN","DIDH1",59,0)
 . D PRINT^DIKKP(DA,"","C20",.DIDPG)
"RTN","DIDH1",60,0)
 D POINT^DIDH Q:M=U  D TRIG^DIDH,XR^DIDH Q:M=U
"RTN","DIDH1",61,0)
 I $D(^DD("IX","B",DA)) D  Q:M=U  W !
"RTN","DIDH1",62,0)
 . N DIDPG
"RTN","DIDH1",63,0)
 . S DIDPG("H")="W """" D H^DIDH S:M=U PAGE(U)=1"
"RTN","DIDH1",64,0)
 . D LIST^DIKCP(DA,"","C15",.DIDPG)
"RTN","DIDH1",65,0)
 S N=$G(^DIC(DA,"%A")),Y=$P(N,U,2) I Y X ^DD("DD") W !!?3,"CREATED ON: "_Y I $S($D(^VA(200,0)):1,1:$D(^DIC(3,0))),^(0)["NEW PERSON"!(^(0)["USER")!(^(0)["EMPLOY"),$D(^(+N,0)) W " by "_$P(^(0),U)
"RTN","DIDH1",66,0)
Q Q
"RTN","DIDH1",67,0)
W W:$X+$L(W)+3>IOM !,?$S(IOM-$L(W)-5<M:IOM-5-$L(W),1:M),S S %Y=$E(W,IOM-$X,999) W $E(W,1,IOM-$X-1),S Q:%Y=""  S W=%Y G W
"RTN","DIDH1",68,0)
 Q
"RTN","DIDH1",69,0)
WR ;
"RTN","DIDH1",70,0)
 S W="TRIGGERED by the "_$P(^(0),U)_" field"
"RTN","DIDH1",71,0)
UP1 S W=W_" of the "_$O(^DD(%,0,"NM",0))
"RTN","DIDH1",72,0)
 I $D(^DD(%,0,"UP")) S %=^("UP") S W=W_" sub-field" G UP1
"RTN","DIDH1",73,0)
 S W=W_" File"
"RTN","DIDH1",74,0)
W1 S DDV1="" W ?DDL2 F K=1:1 S DDV=$P(W," ",K)_" ",DDV1=DDV1_DDV W:$L(DDV)+$X>IOM !?DDL2 W DDV Q:$L(DDV1)>$L(W)
"RTN","DIDH1",75,0)
 I $Y+6>IOSL S DC=DC+1 D DIDH1
"RTN","DIDH1",76,0)
 K DDV,DDV1 Q
"RTN","DIDH1",77,0)
DE ;
"RTN","DIDH1",78,0)
 W !?DDL1,$P("DESCRIPTION:^TECHNICAL DESCR:",U,%Y=23+1)
"RTN","DIDH1",79,0)
 I '$$WP^DIUTL($NA(^DD(F(Z),DJ(Z),%Y)),DDL2+1) S M="^"
"RTN","DIDH1",80,0)
 Q
"VER")
8.0^22.0
**END**
**END**
