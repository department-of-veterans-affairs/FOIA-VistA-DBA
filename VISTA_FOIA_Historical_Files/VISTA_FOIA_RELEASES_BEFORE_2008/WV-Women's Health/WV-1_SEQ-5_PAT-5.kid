Released WV*1*5 SEQ #5
Extracted from mail message
**KIDS**:WV*1.0*5^

**INSTALL NAME**
WV*1.0*5
"BLD",1243,0)
WV*1.0*5^WOMEN'S HEALTH^0^2990315^y
"BLD",1243,1,0)
^^2^2^2990305^^^
"BLD",1243,1,1,0)
Please read the WV*1*5 patch description on FORUM for an explanation of
"BLD",1243,1,2,0)
what this patch does.
"BLD",1243,4,0)
^9.64PA^790.5^1
"BLD",1243,4,790.5,0)
790.5
"BLD",1243,4,790.5,222)
n^n^f^^n^^y^o^n
"BLD",1243,4,790.5,224)
I $P(^WV(790.5,Y,0),U,1)="Not Indicated"
"BLD",1243,4,"B",790.5,790.5)

"BLD",1243,"ABPKG")
n
"BLD",1243,"KRN",0)
^9.67PA^19^18
"BLD",1243,"KRN",.4,0)
.4
"BLD",1243,"KRN",.401,0)
.401
"BLD",1243,"KRN",.402,0)
.402
"BLD",1243,"KRN",.403,0)
.403
"BLD",1243,"KRN",.403,"NM",0)
^9.68A^4^4
"BLD",1243,"KRN",.403,"NM",1,0)
WV PATIENT-FORM-1    FILE #790^790^0
"BLD",1243,"KRN",.403,"NM",2,0)
WV PROC-FORM-1    FILE #790.1^790.1^0
"BLD",1243,"KRN",.403,"NM",3,0)
WV PROC-FORM-2-COLP    FILE #790.1^790.1^0
"BLD",1243,"KRN",.403,"NM",4,0)
WV NOTIFPURPOSE-FORM-1    FILE #790.404^790.404^0
"BLD",1243,"KRN",.403,"NM","B","WV NOTIFPURPOSE-FORM-1    FILE #790.404",4)

"BLD",1243,"KRN",.403,"NM","B","WV PATIENT-FORM-1    FILE #790",1)

"BLD",1243,"KRN",.403,"NM","B","WV PROC-FORM-1    FILE #790.1",2)

"BLD",1243,"KRN",.403,"NM","B","WV PROC-FORM-2-COLP    FILE #790.1",3)

"BLD",1243,"KRN",.5,0)
.5
"BLD",1243,"KRN",.84,0)
.84
"BLD",1243,"KRN",3.6,0)
3.6
"BLD",1243,"KRN",3.8,0)
3.8
"BLD",1243,"KRN",9.2,0)
9.2
"BLD",1243,"KRN",9.8,0)
9.8
"BLD",1243,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",1243,"KRN",9.8,"NM",1,0)
WVEXPTRA^^0^B39152195
"BLD",1243,"KRN",9.8,"NM",2,0)
WVUTL7^^0^B40273960
"BLD",1243,"KRN",9.8,"NM",3,0)
WVRADWP^^0^B25617370
"BLD",1243,"KRN",9.8,"NM",4,0)
WVRALINK^^0^B44170831
"BLD",1243,"KRN",9.8,"NM",5,0)
WVRALIN1^^0^B4910147
"BLD",1243,"KRN",9.8,"NM",6,0)
WVHS^^0^B1353281
"BLD",1243,"KRN",9.8,"NM",7,0)
WVUTL5^^0^B13601829
"BLD",1243,"KRN",9.8,"NM","B","WVEXPTRA",1)

"BLD",1243,"KRN",9.8,"NM","B","WVHS",6)

"BLD",1243,"KRN",9.8,"NM","B","WVRADWP",3)

"BLD",1243,"KRN",9.8,"NM","B","WVRALIN1",5)

"BLD",1243,"KRN",9.8,"NM","B","WVRALINK",4)

"BLD",1243,"KRN",9.8,"NM","B","WVUTL5",7)

"BLD",1243,"KRN",9.8,"NM","B","WVUTL7",2)

"BLD",1243,"KRN",19,0)
19
"BLD",1243,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",1243,"KRN",19,"NM",1)
^^^
"BLD",1243,"KRN",19,"NM",1,0)
WV HS-USER DEFINED^^0
"BLD",1243,"KRN",19,"NM",2,0)
WV MENU-PATIENT MANAGEMENT^^2
"BLD",1243,"KRN",19,"NM","B","WV HS-USER DEFINED",1)

"BLD",1243,"KRN",19,"NM","B","WV MENU-PATIENT MANAGEMENT",2)

"BLD",1243,"KRN",19.1,0)
19.1
"BLD",1243,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",1243,"KRN",101,0)
101
"BLD",1243,"KRN",409.61,0)
409.61
"BLD",1243,"KRN",771,0)
771
"BLD",1243,"KRN",869.2,0)
869.2
"BLD",1243,"KRN",870,0)
870
"BLD",1243,"KRN",8994,0)
8994
"BLD",1243,"KRN","B",.4,.4)

"BLD",1243,"KRN","B",.401,.401)

"BLD",1243,"KRN","B",.402,.402)

"BLD",1243,"KRN","B",.403,.403)

"BLD",1243,"KRN","B",.5,.5)

"BLD",1243,"KRN","B",.84,.84)

"BLD",1243,"KRN","B",3.6,3.6)

"BLD",1243,"KRN","B",3.8,3.8)

"BLD",1243,"KRN","B",9.2,9.2)

"BLD",1243,"KRN","B",9.8,9.8)

"BLD",1243,"KRN","B",19,19)

"BLD",1243,"KRN","B",19.1,19.1)

"BLD",1243,"KRN","B",101,101)

"BLD",1243,"KRN","B",409.61,409.61)

"BLD",1243,"KRN","B",771,771)

"BLD",1243,"KRN","B",869.2,869.2)

"BLD",1243,"KRN","B",870,870)

"BLD",1243,"KRN","B",8994,8994)

"BLD",1243,"QUES",0)
^9.62^^
"BLD",1243,"REQB",0)
^9.611^2^2
"BLD",1243,"REQB",1,0)
WV*1.0*3^2
"BLD",1243,"REQB",2,0)
WV*1.0*4^2
"BLD",1243,"REQB","B","WV*1.0*3",1)

"BLD",1243,"REQB","B","WV*1.0*4",2)

"DATA",790.5,13,0)
Not Indicated
"FIA",790.5)
WV CERVICAL TX NEED
"FIA",790.5,0)
^WV(790.5,
"FIA",790.5,0,0)
790.5
"FIA",790.5,0,1)
n^n^f^^n^^y^o^n
"FIA",790.5,0,10)

"FIA",790.5,0,11)
I $P(^WV(790.5,Y,0),U,1)="Not Indicated"
"FIA",790.5,0,"RLRO")

"FIA",790.5,0,"VR")
1.0^WV
"FIA",790.5,790.5)
0
"KRN",.403,74,-1)
0^2
"KRN",.403,74,0)
WV PROC-FORM-1^^^^2940620^^^790.1^0^0^1
"KRN",.403,74,11)

"KRN",.403,74,12)

"KRN",.403,74,40,0)
^.4031I^1^1
"KRN",.403,74,40,1,0)
1^^1,1^^^0
"KRN",.403,74,40,1,1)
PAGE 1
"KRN",.403,74,40,1,11)

"KRN",.403,74,40,1,12)

"KRN",.403,74,40,1,40,0)
^.4032PI^307^2
"KRN",.403,74,40,1,40,294,0)
WV PROC-EDITBLK-1^3^8,1^e
"KRN",.403,74,40,1,40,307,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,76,-1)
0^1
"KRN",.403,76,0)
WV PATIENT-FORM-1^^^^2940917^^^790^0^0^1
"KRN",.403,76,40,0)
^.4031I^1^1
"KRN",.403,76,40,1,0)
1^^1,1^^^0
"KRN",.403,76,40,1,1)
PAGE 1
"KRN",.403,76,40,1,40,0)
^.4032PI^315^2
"KRN",.403,76,40,1,40,298,0)
WV PATIENT-EDITBLK-1^1^8,1^e
"KRN",.403,76,40,1,40,315,0)
WV PATIENT-HEADER-2^2^1,1^d
"KRN",.403,78,-1)
0^3
"KRN",.403,78,0)
WV PROC-FORM-2-COLP^^^^2940620^^^790.1^0^0^1
"KRN",.403,78,40,0)
^.4031I^2^2
"KRN",.403,78,40,1,0)
1^^1,1^2^2^0
"KRN",.403,78,40,1,1)
PAGE 1
"KRN",.403,78,40,1,40,0)
^.4032PI^307^2
"KRN",.403,78,40,1,40,294,0)
WV PROC-EDITBLK-1^1^8,1^e
"KRN",.403,78,40,1,40,307,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,78,40,2,0)
2^^1,1^1^1^0
"KRN",.403,78,40,2,1)
PAGE 2
"KRN",.403,78,40,2,40,0)
^.4032PI^307^2
"KRN",.403,78,40,2,40,299,0)
WV PROC-EDITBLK-2-COLP^1^9,1^e
"KRN",.403,78,40,2,40,307,0)
WV PROC-DISPLAY-1^2^1,1^d
"KRN",.403,79,-1)
0^4
"KRN",.403,79,0)
WV NOTIFPURPOSE-FORM-1^^^^2950316^^^790.404^0^0^1
"KRN",.403,79,40,0)
^.4031I^1^1
"KRN",.403,79,40,1,0)
1^^1,1^^^0
"KRN",.403,79,40,1,1)
PAGE 1
"KRN",.403,79,40,1,40,0)
^.4032PI^301^1
"KRN",.403,79,40,1,40,301,0)
WV NOTIFPURPOSE-EDITBLK-1^1^1,1^e
"KRN",.404,294,0)
WV PROC-EDITBLK-1^790.1
"KRN",.404,294,11)
D:$$COLP^WVUTL4(DA) HLP^DDSUTL(" * Move to PAGE 2 to edit clinical and pathology findings. ")
"KRN",.404,294,12)

"KRN",.404,294,15,0)
^^1^1^2980605^
"KRN",.404,294,15,1,0)
WV PROCEDURE-EDIT-BLOCK-1
"KRN",.404,294,40,0)
^.4044I^18^15
"KRN",.404,294,40,1,0)
1^Date of Procedure^3
"KRN",.404,294,40,1,1)
.12
"KRN",.404,294,40,1,2)
2,25^18^2,6
"KRN",.404,294,40,1,3)
T
"KRN",.404,294,40,1,4)
1
"KRN",.404,294,40,1,13)
N WVX S WVX=$$PDELQ1^WVUTL4(DA,X,DUZ(2)) D PUT^DDSVAL(DIE,DA,.13,WVX)
"KRN",.404,294,40,3,0)
2^Clinician/Provider^3
"KRN",.404,294,40,3,1)
.07
"KRN",.404,294,40,3,2)
3,25^25^3,5
"KRN",.404,294,40,3,4)
0
"KRN",.404,294,40,4,0)
3^Ward/Clinic/Location^3
"KRN",.404,294,40,4,1)
.11
"KRN",.404,294,40,4,2)
4,25^30^4,3
"KRN",.404,294,40,4,4)
0
"KRN",.404,294,40,4,13)
D PUT^DDSVAL(790.1,.DA,.1,$$INSTIT^WVUTL6)
"KRN",.404,294,40,5,0)
4^Health Care Facility^3
"KRN",.404,294,40,5,1)
.1
"KRN",.404,294,40,5,2)
5,25^30^5,3
"KRN",.404,294,40,5,4)
1^^^
"KRN",.404,294,40,6,0)
9^Results/Diagnosis^3
"KRN",.404,294,40,6,1)
.05
"KRN",.404,294,40,6,2)
8,25^30^8,6
"KRN",.404,294,40,6,10)
S DDSBR=$S(X:12,1:13)
"KRN",.404,294,40,6,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,294,40,6,12)
K WVPN I X,$P(^WV(790.31,X,0),U,22) D PUT^DDSVAL(DIE,DA,.08,1)
"KRN",.404,294,40,7,0)
10^Notes (WP)^3
"KRN",.404,294,40,7,1)
1.01
"KRN",.404,294,40,7,2)
5,77^1^5,65
"KRN",.404,294,40,7,4)
^^^0
"KRN",.404,294,40,7,10)
S DDSBR=5
"KRN",.404,294,40,9,0)
6^Complete by (Date)^3
"KRN",.404,294,40,9,1)
.13
"KRN",.404,294,40,9,2)
7,25^12^7,5
"KRN",.404,294,40,9,3)
!M
"KRN",.404,294,40,9,3.1)
S Y=$$PDELQ^WVUTL4(DA,DUZ(2))
"KRN",.404,294,40,9,10)
S DDSBR=9
"KRN",.404,294,40,10,0)
14^Status^3
"KRN",.404,294,40,10,1)
.14
"KRN",.404,294,40,10,2)
9,65^6^9,57
"KRN",.404,294,40,10,3)
o
"KRN",.404,294,40,11,0)
15^!M^1^
"KRN",.404,294,40,11,.1)
I $$COLP^WVUTL4(DA) S Y="(PAGE 1 OF 2)"
"KRN",.404,294,40,11,2)
^^10,60
"KRN",.404,294,40,12,0)
12^Sec Results/Diagnosis^3^
"KRN",.404,294,40,12,1)
.06
"KRN",.404,294,40,12,2)
9,25^30^9,2
"KRN",.404,294,40,12,10)
S:$$PNOCX^WVUTL6($P(^WV(790.1,DA,0),U,4)) DDSBR=13
"KRN",.404,294,40,12,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,294,40,12,12)
K WVPN I X,$P(^WV(790.31,X,0),U,22) D PUT^DDSVAL(DIE,DA,.08,1)
"KRN",.404,294,40,13,0)
13^HPV^3
"KRN",.404,294,40,13,1)
.08
"KRN",.404,294,40,13,2)
8,65^3^8,60
"KRN",.404,294,40,14,0)
11^!M^1^
"KRN",.404,294,40,14,.1)
N WVROOT S WVROOT=$$GET^DDSVAL(DIE,DA,1.01) I WVROOT]"",$O(@WVROOT@(0)) S Y="+"
"KRN",.404,294,40,14,2)
^^5,77
"KRN",.404,294,40,15,0)
5^Comments^3
"KRN",.404,294,40,15,1)
3.01
"KRN",.404,294,40,15,2)
6,25^53^6,15
"KRN",.404,294,40,17,0)
7^!M^1
"KRN",.404,294,40,17,.1)
S:$O(^WV(790.1,DA,9,0)) Y="+"
"KRN",.404,294,40,17,2)
^^4,77
"KRN",.404,294,40,18,0)
8^Reports (WP)^3
"KRN",.404,294,40,18,1)
9
"KRN",.404,294,40,18,2)
4,78^1^4,63
"KRN",.404,294,40,18,4)
^^^1
"KRN",.404,294,40,18,10)
S DDSBR=4
"KRN",.404,298,0)
WV PATIENT-EDITBLK-1^790
"KRN",.404,298,40,0)
^.4044I^22^20
"KRN",.404,298,40,1,0)
1^Case Manager^3
"KRN",.404,298,40,1,1)
.1
"KRN",.404,298,40,1,2)
2,21^28^2,7
"KRN",.404,298,40,1,3)
!M
"KRN",.404,298,40,1,3.1)
S:$D(DUZ(2)) Y=IOINHI_"`"_$P(^WV(790.02,DUZ(2),0),U,2)_IOINORM
"KRN",.404,298,40,2,0)
4^Cervical Tx Need^3
"KRN",.404,298,40,2,1)
.11
"KRN",.404,298,40,2,2)
3,65^16^3,47
"KRN",.404,298,40,3,0)
5^Cervical Tx Due Date^3
"KRN",.404,298,40,3,1)
.12
"KRN",.404,298,40,3,2)
4,65^11^4,43
"KRN",.404,298,40,4,0)
7^Currently Pregnant^3
"KRN",.404,298,40,4,1)
.13
"KRN",.404,298,40,4,2)
9,25^3^9,5
"KRN",.404,298,40,4,10)
S:'X DDSBR=9
"KRN",.404,298,40,4,12)
D:'X PUT^DDSVAL(DIE,DA,.14,"")
"KRN",.404,298,40,5,0)
8^EDC^3
"KRN",.404,298,40,5,1)
.14
"KRN",.404,298,40,5,2)
9,37^12^9,32
"KRN",.404,298,40,6,0)
9^DES Daughter^3
"KRN",.404,298,40,6,1)
.15
"KRN",.404,298,40,6,2)
9,69^7^9,55
"KRN",.404,298,40,7,0)
2^Breast Tx Need^3
"KRN",.404,298,40,7,1)
.18
"KRN",.404,298,40,7,2)
3,21^20^3,5
"KRN",.404,298,40,8,0)
5.5^PAP Regimen Start Date^3
"KRN",.404,298,40,8,1)
.17
"KRN",.404,298,40,8,2)
7,25^11^7,1
"KRN",.404,298,40,9,0)
6^Notes (WP)^3
"KRN",.404,298,40,9,1)
1.01
"KRN",.404,298,40,9,2)
8,69^1^8,57
"KRN",.404,298,40,9,4)
^^^0
"KRN",.404,298,40,9,10)
S DDSBR=7
"KRN",.404,298,40,10,0)
3^Breast Tx Due Date^3
"KRN",.404,298,40,10,1)
.19
"KRN",.404,298,40,10,2)
4,21^11^4,1
"KRN",.404,298,40,11,0)
5.3^PAP Regimen^3
"KRN",.404,298,40,11,1)
.16
"KRN",.404,298,40,11,2)
6,25^25^6,12
"KRN",.404,298,40,12,0)
10^Date of 1st Encounter^3
"KRN",.404,298,40,12,1)
.21
"KRN",.404,298,40,12,2)
10,25^11^10,2
"KRN",.404,298,40,12,3)
!M
"KRN",.404,298,40,12,3.1)
S Y="T"
"KRN",.404,298,40,13,0)
6.1^!M^1^
"KRN",.404,298,40,13,.1)
N WVROOT S WVROOT=$$GET^DDSVAL(DIE,DA,1.01) I WVROOT]"",$O(@WVROOT@(0)) S Y="+"
"KRN",.404,298,40,13,2)
^^8,69
"KRN",.404,298,40,14,0)
11^Referral Source^3
"KRN",.404,298,40,14,1)
.22
"KRN",.404,298,40,14,2)
10,69^8^10,52
"KRN",.404,298,40,15,0)
6.5^Family Hx of Breast CA^3
"KRN",.404,298,40,15,1)
.23
"KRN",.404,298,40,15,2)
8,25^23^8,1
"KRN",.404,298,40,16,0)
1.2^Inactive Date^3
"KRN",.404,298,40,16,1)
.24
"KRN",.404,298,40,16,2)
2,65^11^2,50
"KRN",.404,298,40,16,10)
S:X DDSBR=99
"KRN",.404,298,40,17,0)
99^ ^1
"KRN",.404,298,40,17,2)
^^10,78
"KRN",.404,298,40,18,0)
3.5^Breast Tx Facility^3
"KRN",.404,298,40,18,1)
.25
"KRN",.404,298,40,18,2)
5,21^20^5,1
"KRN",.404,298,40,19,0)
5.2^Cervical Tx Facility^3
"KRN",.404,298,40,19,1)
.26
"KRN",.404,298,40,19,2)
5,65^15^5,43
"KRN",.404,298,40,22,0)
5.7^Sexual Trauma^3
"KRN",.404,298,40,22,1)
.27
"KRN",.404,298,40,22,2)
7,69^12^7,54
"KRN",.404,298,40,22,3)
!M
"KRN",.404,298,40,22,3.1)
S Y=$G(WVMST)
"KRN",.404,298,40,22,10)
S DDSBR=6.5
"KRN",.404,299,0)
WV PROC-EDITBLK-2-COLP^790.1
"KRN",.404,299,11)

"KRN",.404,299,40,0)
^.4044I^16^16
"KRN",.404,299,40,1,0)
1^* Clinical Findings *^1^
"KRN",.404,299,40,1,2)
^^1,29
"KRN",.404,299,40,2,0)
2^T-Zone Seen Entirely^3
"KRN",.404,299,40,2,1)
.21
"KRN",.404,299,40,2,2)
2,25^3^2,3^0
"KRN",.404,299,40,3,0)
3^Lesion Outside Canal^3
"KRN",.404,299,40,3,1)
.22
"KRN",.404,299,40,3,2)
3,25^3^3,3^0
"KRN",.404,299,40,4,0)
4^Satisfactory Exam^3
"KRN",.404,299,40,4,1)
.2
"KRN",.404,299,40,4,2)
4,25^3^4,6^0
"KRN",.404,299,40,5,0)
5^Multifocal^3
"KRN",.404,299,40,5,1)
.23
"KRN",.404,299,40,5,2)
2,67^3^2,55^0
"KRN",.404,299,40,6,0)
6^Number of Quadrants^3
"KRN",.404,299,40,6,1)
.24
"KRN",.404,299,40,6,2)
3,67^3^3,46
"KRN",.404,299,40,7,0)
7^* Tissue Pathology *^1^
"KRN",.404,299,40,7,2)
^^6,29^
"KRN",.404,299,40,8,0)
8^ECC Dysplasia^3
"KRN",.404,299,40,8,1)
.25
"KRN",.404,299,40,8,2)
7,25^20^7,10^0
"KRN",.404,299,40,8,12)
S:'$$MARGIN^WVUTL4(DA) DDSBR=9
"KRN",.404,299,40,9,0)
9^Ectocervical Biopsy^3
"KRN",.404,299,40,9,1)
.26
"KRN",.404,299,40,9,2)
8,25^30^8,4^0
"KRN",.404,299,40,9,11)
S WVPN=$O(^WV(790.2,"B","ECTOCERVICAL BIOPSY",0))
"KRN",.404,299,40,9,12)
K WVPN
"KRN",.404,299,40,10,0)
12^!M^1^
"KRN",.404,299,40,10,.1)
S Y="(PAGE 2 OF 2)"
"KRN",.404,299,40,10,2)
^^9,58^
"KRN",.404,299,40,11,0)
11^STD Evaluation^3
"KRN",.404,299,40,11,1)
.28
"KRN",.404,299,40,11,2)
9,25^30^9,9^0
"KRN",.404,299,40,11,11)
S WVPN=$O(^WV(790.2,"B","STD EVALUATION",0))
"KRN",.404,299,40,11,12)
K WVPN
"KRN",.404,299,40,12,0)
8.5^Margins Clear^3
"KRN",.404,299,40,12,1)
.27
"KRN",.404,299,40,12,2)
7,73^3^7,58^0
"KRN",.404,299,40,13,0)
6.5^IMPRESSION^3
"KRN",.404,299,40,13,1)
.29
"KRN",.404,299,40,13,2)
5,25^30^5,13^0
"KRN",.404,299,40,13,11)
S WVPN=$$GET^DDSVAL(DIE,DA,.04)
"KRN",.404,299,40,13,12)
K WVPN
"KRN",.404,299,40,14,0)
.5^Screening PAP^3
"KRN",.404,299,40,14,1)
.3
"KRN",.404,299,40,14,2)
1,16^10^1,1
"KRN",.404,299,40,15,0)
10^Stage^3
"KRN",.404,299,40,15,1)
.31
"KRN",.404,299,40,15,2)
8,65^10^8,58^0
"KRN",.404,299,40,16,0)
6.4^Quadrant Locations^3
"KRN",.404,299,40,16,1)
.245
"KRN",.404,299,40,16,2)
4,67^11^4,47
"KRN",.404,301,0)
WV NOTIFPURPOSE-EDITBLK-1^790.404
"KRN",.404,301,40,0)
^.4044I^10^10
"KRN",.404,301,40,1,0)
1^* * *  EDIT NOTIFICATION PURPOSE & LETTER  * * *^1^
"KRN",.404,301,40,1,2)
^^3,16^
"KRN",.404,301,40,2,0)
2^Purpose of Notification^3
"KRN",.404,301,40,2,1)
.01
"KRN",.404,301,40,2,2)
6,30^48^6,5^0
"KRN",.404,301,40,2,4)
^^^1
"KRN",.404,301,40,3,0)
4^Synonym^3
"KRN",.404,301,40,3,1)
.03
"KRN",.404,301,40,3,2)
10,30^6^10,21^0
"KRN",.404,301,40,4,0)
5^Priority^3
"KRN",.404,301,40,4,1)
.02
"KRN",.404,301,40,4,2)
12,30^10^12,20
"KRN",.404,301,40,4,10)
S DDSBR=7
"KRN",.404,301,40,5,0)
6^FORM LETTER (WP)^3
"KRN",.404,301,40,5,1)
1.01
"KRN",.404,301,40,5,2)
12,68^1^12,50
"KRN",.404,301,40,6,0)
3^Active^3
"KRN",.404,301,40,6,1)
.04
"KRN",.404,301,40,6,2)
8,30^3^8,22^0
"KRN",.404,301,40,6,3)
YES
"KRN",.404,301,40,6,10)
S:'X DDSBR=8
"KRN",.404,301,40,7,0)
1.5^________________________________________________________________________________^1^
"KRN",.404,301,40,7,2)
^^4,1^
"KRN",.404,301,40,8,0)
7^Result or Reminder Letter^3
"KRN",.404,301,40,8,1)
.06
"KRN",.404,301,40,8,2)
14,30^9^14,3^0
"KRN",.404,301,40,9,0)
8^Associate with BR or CX Tx^3
"KRN",.404,301,40,9,1)
.05
"KRN",.404,301,40,9,2)
15,30^9^15,2^0
"KRN",.404,301,40,10,0)
6.1^!M^1
"KRN",.404,301,40,10,.1)
N WVROOT S WVROOT=$$GET^DDSVAL(DIE,DA,1.01) I WVROOT]"",$O(@WVROOT@(0)) S Y="+"
"KRN",.404,301,40,10,2)
^^12,68
"KRN",.404,307,0)
WV PROC-DISPLAY-1^790.1^
"KRN",.404,307,40,0)
^.4044I^33^30
"KRN",.404,307,40,1,0)
1^* * *  EDIT A PROCEDURE  * * *^1
"KRN",.404,307,40,1,2)
^^1,19
"KRN",.404,307,40,2,0)
2^Patient Name:^1
"KRN",.404,307,40,2,2)
^^2,1
"KRN",.404,307,40,3,0)
3^Case Manager:^1
"KRN",.404,307,40,3,2)
^^3,1
"KRN",.404,307,40,5,0)
5^!M^1
"KRN",.404,307,40,5,.1)
S Y="PAP Regimen :"
"KRN",.404,307,40,5,2)
^^4,1
"KRN",.404,307,40,6,0)
6^Br Tx Need  :^1
"KRN",.404,307,40,6,2)
^^6,1
"KRN",.404,307,40,7,0)
2.5^SSN:^1
"KRN",.404,307,40,7,2)
^^2,56
"KRN",.404,307,40,8,0)
3.5^Procedure:^1
"KRN",.404,307,40,8,2)
^^3,50
"KRN",.404,307,40,9,0)
4.5^Cx Facility:^1
"KRN",.404,307,40,9,2)
^^5,48
"KRN",.404,307,40,10,0)
6.5^Br Facility:^1
"KRN",.404,307,40,10,2)
^^6,48
"KRN",.404,307,40,11,0)
5.5^Acc#:^1
"KRN",.404,307,40,11,2)
^^4,55
"KRN",.404,307,40,12,0)
2.2^!M^1
"KRN",.404,307,40,12,.1)
S Y=IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,307,40,12,2)
^^2,15
"KRN",.404,307,40,13,0)
3.2^!M^1
"KRN",.404,307,40,13,.1)
S Y=IOINHI_$$CMGR^WVUTL1(WVDFN)_IOINORM
"KRN",.404,307,40,13,2)
^^3,15
"KRN",.404,307,40,14,0)
4.2^!M^1
"KRN",.404,307,40,14,.1)
S Y=IOINHI_$E($$PROC1^WVUTL1A,1,19)_IOINORM
"KRN",.404,307,40,14,2)
^^3,61
"KRN",.404,307,40,16,0)
5.3^Cx Tx Need  :^1
"KRN",.404,307,40,16,2)
^^5,1
"KRN",.404,307,40,17,0)
5.4^!M^1
"KRN",.404,307,40,17,.1)
S Y=IOINHI_$$CNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,307,40,17,2)
^^5,15
"KRN",.404,307,40,18,0)
4.3^!M^1
"KRN",.404,307,40,18,.1)
S Y=IOINHI_$$PAPRG^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,307,40,18,2)
^^4,15
"KRN",.404,307,40,19,0)
6.2^ ^1
"KRN",.404,307,40,19,2)
^^4,11
"KRN",.404,307,40,20,0)
2.8^!M^1
"KRN",.404,307,40,20,.1)
S Y=IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,307,40,20,2)
^^2,61
"KRN",.404,307,40,21,0)
4.8^!M^1
"KRN",.404,307,40,21,.1)
S Y=IOINHI_$$ACC^WVUTL1(DA)_IOINORM
"KRN",.404,307,40,21,2)
^^4,61
"KRN",.404,307,40,23,0)
6.4^!M^1
"KRN",.404,307,40,23,.1)
S Y=IOINHI_$$BNEED^WVUTL1(WVDFN,1)_IOINORM
"KRN",.404,307,40,23,2)
^^6,15
"KRN",.404,307,40,24,0)
20^--------------------------------------------------------------------------------^1
"KRN",.404,307,40,24,2)
^^8,1
"KRN",.404,307,40,25,0)
19^!M^1
"KRN",.404,307,40,25,.1)
S Y=IOINHI_$$EDC^WVUTL1(WVDFN)_IOINORM
"KRN",.404,307,40,25,2)
^^8,48
"KRN",.404,307,40,26,0)
17^!M^1
"KRN",.404,307,40,26,.1)
S Y=IOINHI_$S($$DES^WVUTL1(WVDFN)="YES":"*DES DAUGHTER*",1:"")
"KRN",.404,307,40,26,2)
^^7,31
"KRN",.404,307,40,27,0)
21^!M^1
"KRN",.404,307,40,27,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"C")_IOINORM
"KRN",.404,307,40,27,2)
^^5,61
"KRN",.404,307,40,28,0)
22^!M^1
"KRN",.404,307,40,28,.1)
S Y=IOINHI_$$FACIL^WVUTL1A(WVDFN,"B")_IOINORM
"KRN",.404,307,40,28,2)
^^6,61
"KRN",.404,307,40,29,0)
23^Sexual Trauma:^1
"KRN",.404,307,40,29,2)
^^7,1
"KRN",.404,307,40,30,0)
24^!M^1
"KRN",.404,307,40,30,.1)
S Y=IOINHI_$$MST^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,307,40,30,2)
^^7,16
"KRN",.404,307,40,32,0)
25^Veteran:^1
"KRN",.404,307,40,32,2)
^^7,52
"KRN",.404,307,40,33,0)
26^!M^1
"KRN",.404,307,40,33,.1)
S Y=IOINHI_$$VET^WVUTL1A(WVDFN)_IOINORM
"KRN",.404,307,40,33,2)
^^7,61
"KRN",.404,315,0)
WV PATIENT-HEADER-2^790^
"KRN",.404,315,40,0)
^.4044I^9^9
"KRN",.404,315,40,1,0)
1^* * *  EDIT PATIENT CASE DATA  * * *^1
"KRN",.404,315,40,1,2)
^^1,22
"KRN",.404,315,40,2,0)
2^!M^1
"KRN",.404,315,40,2,.1)
S Y=IOINORM_"Patient Name: "_IOINHI_$$NAME^WVUTL1(WVDFN)_"("_$$AGE^WVUTL1(WVDFN)_")"_IOINORM
"KRN",.404,315,40,2,2)
^^3,1
"KRN",.404,315,40,3,0)
3^!M^1
"KRN",.404,315,40,3,.1)
S Y=IOINORM_$$PNLAB^WVUTL5()_IOINHI_$$SSN^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,3,2)
^^3,52
"KRN",.404,315,40,4,0)
4^!M^1
"KRN",.404,315,40,4,.1)
S Y=IOINORM_"Street: "_IOINHI_$$STREET^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,4,2)
^^4,7
"KRN",.404,315,40,5,0)
5^!M^1
"KRN",.404,315,40,5,.1)
S Y=IOINORM_"Patient Phone: "_IOINHI_$$HPHONE^WVUTL1(WVDFN)
"KRN",.404,315,40,5,2)
^^4,45
"KRN",.404,315,40,6,0)
6^!M^1
"KRN",.404,315,40,6,.1)
S Y=IOINORM_"Cty/St/Zip: "_IOINHI_$$CTYSTZ^WVUTL1(WVDFN)_IOINORM
"KRN",.404,315,40,6,2)
^^5,3
"KRN",.404,315,40,7,0)
7^!M^1
"KRN",.404,315,40,7,.1)
S Y=IOINORM_"Pr Provider: "_IOINHI_$E($$PROVI^WVUTL1A(WVDFN),1,20)
"KRN",.404,315,40,7,2)
^^5,47
"KRN",.404,315,40,8,0)
8^!M^1
"KRN",.404,315,40,8,.1)
S Y=IOINORM_"Veteran: "_IOINHI_$$VET^WVUTL1A(WVDFN)
"KRN",.404,315,40,8,2)
^^6,6
"KRN",.404,315,40,9,0)
9^________________________________________________________________________________^1
"KRN",.404,315,40,9,2)
^^7,1
"KRN",19,11223,-1)
2^2
"KRN",19,11223,0)
WV MENU-PATIENT MANAGEMENT^Patient Management^^M^1776^^^^^^^532^^1^
"KRN",19,11223,10,0)
^19.01PI^22^22
"KRN",19,11223,10,22,0)
11503^HS^5.5
"KRN",19,11223,10,22,"^")
WV HS-USER DEFINED
"KRN",19,11223,"U")
PATIENT MANAGEMENT
"KRN",19,11503,-1)
0^1
"KRN",19,11503,0)
WV HS-USER DEFINED^Health Summary^^R^^^^^^^^WOMEN'S HEALTH
"KRN",19,11503,1,0)
^^10^10^2990208^
"KRN",19,11503,1,1,0)
This option allows the user to create a health summary report for the
"KRN",19,11503,1,2,0)
patient selected. The user may select multiple health summary components
"KRN",19,11503,1,3,0)
to create the health summary report.
"KRN",19,11503,1,4,0)
 
"KRN",19,11503,1,5,0)
The health summary components offer default values for the number of
"KRN",19,11503,1,6,0)
occurences to return and time span to cover. The user may edit these
"KRN",19,11503,1,7,0)
defaults by entering the component at the "Select COMPONENT(S) to EDIT or
"KRN",19,11503,1,8,0)
other COMPONENT(S) to ADD:" prompt and then changing the defaults for the
"KRN",19,11503,1,9,0)
"OCCURRENCE LIMIT" and "TIME LIMIT:" prompts. Also, a special "HEADER
"KRN",19,11503,1,10,0)
NAME" may be assigned to the report output.
"KRN",19,11503,25)
UD^WVHS
"KRN",19,11503,"U")
HEALTH SUMMARY
"MBREQ")
0
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",532,-1)
1^1
"PKG",532,0)
WOMEN'S HEALTH^WV^Tracks health issues specific to female patients.
"PKG",532,20,0)
^9.402P^^
"PKG",532,22,0)
^9.49I^1^1
"PKG",532,22,1,0)
1.0^2980925^2980929^1776
"PKG",532,22,1,"PAH",1,0)
5^2990315^1776
"PKG",532,22,1,"PAH",1,1,0)
^^2^2^2990315
"PKG",532,22,1,"PAH",1,1,1,0)
Please read the WV*1*5 patch description on FORUM for an explanation of
"PKG",532,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","WVEXPTRA")
0^1^B39152195
"RTN","WVEXPTRA",1,0)
WVEXPTRA ;HCIOFO/FT IHS/ANMC/MWR - EXPORT MAMS & BREAST ULTRASOUNDS TO WOMEN'S HEALTH  ;1/7/99  12:38
"RTN","WVEXPTRA",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,5**;Sep 30, 1998
"RTN","WVEXPTRA",3,0)
 ;---> WVNEWP = TOTAL NEW WOMEN'S HEALTH PATIENTS ADDED.
"RTN","WVEXPTRA",4,0)
 ;---> WVMAM  = TOTAL NEW MAMMOGRAMS PROCEDURES ADDED.
"RTN","WVEXPTRA",5,0)
 ;
"RTN","WVEXPTRA",6,0)
EN1 ;
"RTN","WVEXPTRA",7,0)
 S WVPOP=0
"RTN","WVEXPTRA",8,0)
 D CHECK I WVPOP D KILL Q  ;check if site parameter entry exists
"RTN","WVEXPTRA",9,0)
 D DESC ;describe option
"RTN","WVEXPTRA",10,0)
 D DTRNG I WVPOP D KILL Q  ;get date range
"RTN","WVEXPTRA",11,0)
 D STATUS I WVPOP D KILL Q  ;select status of procedure
"RTN","WVEXPTRA",12,0)
 D VET I WVPOP D KILL Q  ;veterans/non-veterans
"RTN","WVEXPTRA",13,0)
 D QUEUE ;queue a background job
"RTN","WVEXPTRA",14,0)
 D KILL
"RTN","WVEXPTRA",15,0)
 Q
"RTN","WVEXPTRA",16,0)
EN2 ;
"RTN","WVEXPTRA",17,0)
 D CPTS ;get procedure pointers
"RTN","WVEXPTRA",18,0)
 D GET ;get RAD/NM data & store in WH
"RTN","WVEXPTRA",19,0)
 D MAIL ;send mail message to user
"RTN","WVEXPTRA",20,0)
 D KILL ;kill variables
"RTN","WVEXPTRA",21,0)
 Q
"RTN","WVEXPTRA",22,0)
DESC ; Describe option
"RTN","WVEXPTRA",23,0)
 W @IOF
"RTN","WVEXPTRA",24,0)
 W !,"This option searches the Radiology/Nuclear Medicine database for"
"RTN","WVEXPTRA",25,0)
 W !,"all female patients who had a mammogram or breast ultrasound exam"
"RTN","WVEXPTRA",26,0)
 W !,"(CPT codes are 76090, 76091, 76092 and 76645) during the date"
"RTN","WVEXPTRA",27,0)
 W !,"range you select. These procedures and patients will be added to"
"RTN","WVEXPTRA",28,0)
 W !,"the WH database if not already there.",!
"RTN","WVEXPTRA",29,0)
 W !,"This job will be queued as a background task so as to free up your"
"RTN","WVEXPTRA",30,0)
 W !,"terminal to do other work. You will receive a mail message when"
"RTN","WVEXPTRA",31,0)
 W !,"the job is done. The mail message will contain a count of the"
"RTN","WVEXPTRA",32,0)
 W !,"number of procedures and patients added.",!!
"RTN","WVEXPTRA",33,0)
 Q 
"RTN","WVEXPTRA",34,0)
CHECK ; Check if DUZ(2) exists for user, if entry exists in site parameter
"RTN","WVEXPTRA",35,0)
 ; file, if case manager, and if File 70 exists.
"RTN","WVEXPTRA",36,0)
 D CHECK^WVLOGO
"RTN","WVEXPTRA",37,0)
 I '$G(DUZ(2))!('$D(^WV(790.02,+DUZ(2),0))) S WVPOP=1
"RTN","WVEXPTRA",38,0)
 I '$P($G(^WV(790.02,+$G(DUZ(2)),0)),U,2) D
"RTN","WVEXPTRA",39,0)
 .D NODCM^WVUTL9
"RTN","WVEXPTRA",40,0)
 .S WVPOP=1
"RTN","WVEXPTRA",41,0)
 .Q
"RTN","WVEXPTRA",42,0)
 I '$D(^RADPT) W !,"There is no Radiology/Nuclear Medicine Patient file (#70)",! S WVPOP=1
"RTN","WVEXPTRA",43,0)
 Q
"RTN","WVEXPTRA",44,0)
DTRNG ; prompt for date range, go back three years maximum
"RTN","WVEXPTRA",45,0)
 S WVSTDT=DT-30000
"RTN","WVEXPTRA",46,0)
 K DIR S DIR(0)="DA^"_WVSTDT_":"_DT
"RTN","WVEXPTRA",47,0)
 S DIR("A")="Enter START DATE: "
"RTN","WVEXPTRA",48,0)
 S DIR("?")="Enter the earliest date of the mammograms/breast ultrasounds you wish to retrieve. You can begin your search at "_$$FMTE^XLFDT(WVSTDT,"D")_"."
"RTN","WVEXPTRA",49,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",50,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",51,0)
 S WVSTDT=Y
"RTN","WVEXPTRA",52,0)
 S DIR(0)="DA^"_WVSTDT_":"_DT
"RTN","WVEXPTRA",53,0)
 S DIR("A")="Enter END DATE: ",DIR("B")=$$FMTE^XLFDT(DT,"D")
"RTN","WVEXPTRA",54,0)
 S DIR("?")="Enter the most recent date of the mammograms/breast ultrasounds you wish to retrieve."
"RTN","WVEXPTRA",55,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",56,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",57,0)
 S WVENDT=Y
"RTN","WVEXPTRA",58,0)
 Q
"RTN","WVEXPTRA",59,0)
STATUS ; Select default status for procedures
"RTN","WVEXPTRA",60,0)
 K DIR
"RTN","WVEXPTRA",61,0)
 S DIR(0)="S^o:OPEN;c:CLOSED",DIR("A")="Select STATUS OF IMPORTED MAMMOGRAMS"
"RTN","WVEXPTRA",62,0)
 S DIR("?")="Enter 'O' to give a Status of OPEN to Mammograms imported from the Radiology Software into the Women's Health database. Enter 'C' to give a Status of CLOSED to imported Mammograms."
"RTN","WVEXPTRA",63,0)
 D ^DIR K DIR
"RTN","WVEXPTRA",64,0)
 I $D(DIRUT) S WVPOP=1
"RTN","WVEXPTRA",65,0)
 S WVSTATUS=Y
"RTN","WVEXPTRA",66,0)
 Q
"RTN","WVEXPTRA",67,0)
VET ; Add veterans only
"RTN","WVEXPTRA",68,0)
 W ! S WVVET=""
"RTN","WVEXPTRA",69,0)
 N DIR S DIR(0)="Y",DIR("A")="Add veterans only"
"RTN","WVEXPTRA",70,0)
 S DIR("?",1)="Answer YES to add veterans only."
"RTN","WVEXPTRA",71,0)
 S DIR("?")="Answer NO to include non-veterans (e.g., employees)."
"RTN","WVEXPTRA",72,0)
 D ^DIR
"RTN","WVEXPTRA",73,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVEXPTRA",74,0)
 S WVVET=+Y
"RTN","WVEXPTRA",75,0)
 Q
"RTN","WVEXPTRA",76,0)
QUEUE ; Task as background job
"RTN","WVEXPTRA",77,0)
 S ZTIO="",ZTDESC="WH GRAB RAD/NM DATA",ZTRTN="EN2^WVEXPTRA"
"RTN","WVEXPTRA",78,0)
 S ZTDTH=$H,WVPOP=1
"RTN","WVEXPTRA",79,0)
 S ZTSAVE("WVENDT")="",ZTSAVE("WVSTDT")="",ZTSAVE("WVSTATUS")=""
"RTN","WVEXPTRA",80,0)
 S ZTSAVE("WVVET")=""
"RTN","WVEXPTRA",81,0)
 D ^%ZTLOAD
"RTN","WVEXPTRA",82,0)
 Q
"RTN","WVEXPTRA",83,0)
CPTS ; Loop through File 71 to get procedure pointers for the CPTs we
"RTN","WVEXPTRA",84,0)
 ; are interested in.
"RTN","WVEXPTRA",85,0)
 S WVIEN=0 K WVARRAY
"RTN","WVEXPTRA",86,0)
 F  S WVIEN=$O(^RAMIS(71,WVIEN)) Q:'WVIEN  D
"RTN","WVEXPTRA",87,0)
 .S WVCPT=$$GET1^DIQ(71,WVIEN,9,"I") ;CPT code
"RTN","WVEXPTRA",88,0)
 .I WVCPT=76090 S WVARRAY(WVIEN)="" Q  ;unilateral mammogram
"RTN","WVEXPTRA",89,0)
 .I WVCPT=76091 S WVARRAY(WVIEN)="" Q  ;bilateral mammogram
"RTN","WVEXPTRA",90,0)
 .I WVCPT=76092 S WVARRAY(WVIEN)="" Q  ;screening mammogram
"RTN","WVEXPTRA",91,0)
 .S:WVCPT=76645 WVARRAY(WVIEN)="" ;echo exam of breast
"RTN","WVEXPTRA",92,0)
 .Q
"RTN","WVEXPTRA",93,0)
 Q
"RTN","WVEXPTRA",94,0)
GET ; get mammograms and breast ultrasounds from RAD/NM database
"RTN","WVEXPTRA",95,0)
 ;---> WVMCNT = total new procedures added.
"RTN","WVEXPTRA",96,0)
 ;---> WVNEWP = total new patients added.
"RTN","WVEXPTRA",97,0)
 S (WVMCNT,WVNEWP)=0
"RTN","WVEXPTRA",98,0)
 Q:'$D(WVARRAY)  ;no mammogram or breast ultrasound procedures in File 71
"RTN","WVEXPTRA",99,0)
 S WVENDT=WVENDT\1,WVENDT=9999999-WVENDT ;inverse end date
"RTN","WVEXPTRA",100,0)
 S WVSTDT=WVSTDT\1,WVSTDT=9999999-WVSTDT ;inverse start date
"RTN","WVEXPTRA",101,0)
 S WVSTDT=WVSTDT_".9999"
"RTN","WVEXPTRA",102,0)
 S WVDFN=0 ;patient dfn
"RTN","WVEXPTRA",103,0)
 F  S WVDFN=$O(^RADPT(WVDFN)) Q:'WVDFN  D  ;RAD/NM patient file
"RTN","WVEXPTRA",104,0)
 .Q:$P($G(^DPT(WVDFN,0)),U,2)'="F"  ;not female
"RTN","WVEXPTRA",105,0)
 .I WVVET,$$GET1^DIQ(2,WVDFN,1901,"I")'="Y" Q  ;don't add non-veterans
"RTN","WVEXPTRA",106,0)
 .S WVDTI=WVENDT  ;Because the exam date is inverse the end date will
"RTN","WVEXPTRA",107,0)
 .;                will be the lower value.
"RTN","WVEXPTRA",108,0)
 .F  S WVDTI=$O(^RADPT(WVDFN,"DT",WVDTI)) Q:'WVDTI!(WVDTI>WVSTDT)  D
"RTN","WVEXPTRA",109,0)
 ..S WVCNI=0 ;case number
"RTN","WVEXPTRA",110,0)
 ..F  S WVCNI=$O(^RADPT(WVDFN,"DT",WVDTI,"P",WVCNI)) Q:'WVCNI  D
"RTN","WVEXPTRA",111,0)
 ...S WVNODE=$G(^RADPT(WVDFN,"DT",WVDTI,"P",WVCNI,0))
"RTN","WVEXPTRA",112,0)
 ...Q:WVNODE=""
"RTN","WVEXPTRA",113,0)
 ...S WVPROC=$P(WVNODE,U,2) ;procedure pointer
"RTN","WVEXPTRA",114,0)
 ...Q:'WVPROC  ;no pointer to File 71 (no procedure) 
"RTN","WVEXPTRA",115,0)
 ...Q:'$D(WVARRAY(WVPROC))  ;not a mammogram or breast ultrasound
"RTN","WVEXPTRA",116,0)
 ...S WVRPT=$P(WVNODE,U,17) ;report pointer
"RTN","WVEXPTRA",117,0)
 ...Q:'WVRPT  ;no pointer to File 74 (no report)
"RTN","WVEXPTRA",118,0)
 ...Q:$$GET1^DIQ(74,WVRPT,5,"I")'="V"  ;report status, must be VERIFIED
"RTN","WVEXPTRA",119,0)
 ...D CREATEH^WVRALINK(WVDFN,WVDTI,WVCNI,WVSTATUS)
"RTN","WVEXPTRA",120,0)
 ...Q
"RTN","WVEXPTRA",121,0)
 ..Q
"RTN","WVEXPTRA",122,0)
 .Q
"RTN","WVEXPTRA",123,0)
 Q
"RTN","WVEXPTRA",124,0)
MAIL ; send mail message to user with counts of procedures & patients added
"RTN","WVEXPTRA",125,0)
 S XMDUZ=.5 ;message sender
"RTN","WVEXPTRA",126,0)
 S XMY(DUZ)="" ;person who ran option
"RTN","WVEXPTRA",127,0)
 S XMSUB="Export of RAD/NM procedures to WH is done"
"RTN","WVEXPTRA",128,0)
 S WVMSG(1)="  # of New patients added to Women's Health package: "_WVNEWP
"RTN","WVEXPTRA",129,0)
 S WVMSG(2)="# of New procedures added to Women's Health package: "_WVMCNT
"RTN","WVEXPTRA",130,0)
 I '$D(WVARRAY) D
"RTN","WVEXPTRA",131,0)
 .S WVMSG(3)=" "
"RTN","WVEXPTRA",132,0)
 .S WVMSG(4)="There are no mammogram or breast ultrasound procedures listed in your"
"RTN","WVEXPTRA",133,0)
 .S WVMSG(5)="Radiology/Nuclear Medicine package."
"RTN","WVEXPTRA",134,0)
 .Q
"RTN","WVEXPTRA",135,0)
 S XMTEXT="WVMSG("
"RTN","WVEXPTRA",136,0)
 D ^XMD
"RTN","WVEXPTRA",137,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVEXPTRA",138,0)
 Q
"RTN","WVEXPTRA",139,0)
KILL ;
"RTN","WVEXPTRA",140,0)
 K DIR,DIROUT,DIRUT,DTOUT,DUOUT
"RTN","WVEXPTRA",141,0)
 K WVARRAY,WVCNI,WVCPT,WVDFN,WVDTI,WVENDT,WVIEN,WVMCNT,WVNEWP,WVNODE,WVPOP,WVPROC,WVRPT,WVSTATUS,WVSTDT,WVVET
"RTN","WVEXPTRA",142,0)
 K X,Y,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK
"RTN","WVEXPTRA",143,0)
 Q
"RTN","WVEXPTRA",144,0)
 ;
"RTN","WVHS")
0^6^B1353281
"RTN","WVHS",1,0)
WVHS ;HCIOFO/FT-HEALTH SUMMARY INTERFACE ;3/1/99  11:28
"RTN","WVHS",2,0)
 ;;1.0;WOMEN'S HEALTH;**5**;Sep 30, 1998
"RTN","WVHS",3,0)
 ;
"RTN","WVHS",4,0)
UD ; User Defined Health Summary. Called from [WV HS-USER DEFINED] option
"RTN","WVHS",5,0)
 ; Select patient (DFN) and call HS supported call.
"RTN","WVHS",6,0)
 S WVPOP=0 N DFN
"RTN","WVHS",7,0)
 D PATIENT I WVPOP D KILL Q
"RTN","WVHS",8,0)
 N GMP,GMPATT,GMTSPHDR
"RTN","WVHS",9,0)
 I $T(MAIN^GMTSADOR)']"" D  D KILL Q
"RTN","WVHS",10,0)
 .W !,"Sorry, the Health Summary package utility 'MAIN^GMTSADOR' does not exist.",!,"Please contact your IRM support person.",!
"RTN","WVHS",11,0)
 .Q
"RTN","WVHS",12,0)
 D MAIN^GMTSADOR
"RTN","WVHS",13,0)
 D KILL
"RTN","WVHS",14,0)
 Q
"RTN","WVHS",15,0)
PATIENT ; Select a patient (can be male or female)
"RTN","WVHS",16,0)
 N DIC,DTOUT,DUOUT
"RTN","WVHS",17,0)
 S DIC="^DPT(",DIC(0)="AEMQZ"
"RTN","WVHS",18,0)
 D ^DIC
"RTN","WVHS",19,0)
 I Y<0!($D(DTOUT))!($D(DUOUT)) S WVPOP=1 Q
"RTN","WVHS",20,0)
 S DFN=+Y
"RTN","WVHS",21,0)
 Q
"RTN","WVHS",22,0)
KILL ;
"RTN","WVHS",23,0)
 K WVDFN,WVEND,WVPOP,WVSTART,WVTYPE,X,Y
"RTN","WVHS",24,0)
 Q
"RTN","WVRADWP")
0^3^B25617370
"RTN","WVRADWP",1,0)
WVRADWP ;HCIOFO/FT-Display Report Data from Related Packages  ;3/1/99  12:25
"RTN","WVRADWP",2,0)
 ;;1.0;WOMEN'S HEALTH;**4,5**;Sep 30, 1998
"RTN","WVRADWP",3,0)
 ;
"RTN","WVRADWP",4,0)
EN ; Determine which report to show (i.e., radiology/nuclear medicine)
"RTN","WVRADWP",5,0)
 ; Called from Edit a Procedure option screen form.
"RTN","WVRADWP",6,0)
 D EX
"RTN","WVRADWP",7,0)
 Q:'$G(DA)
"RTN","WVRADWP",8,0)
 Q:'$D(^WV(790.1,+DA,0))
"RTN","WVRADWP",9,0)
 N WV7901
"RTN","WVRADWP",10,0)
 S WV7901=$E(^WV(790.1,+DA,0),1,2) ;first 2 characters of accession code
"RTN","WVRADWP",11,0)
 Q:WV7901=""
"RTN","WVRADWP",12,0)
 I "^BU^MB^MU^MS^"[WV7901 D EN1 Q  ;show rad/nm report data
"RTN","WVRADWP",13,0)
 Q
"RTN","WVRADWP",14,0)
EN1 ; Set up radiology report data and call FM Browser
"RTN","WVRADWP",15,0)
 N LOOP,WVLCNT,WVRADCSE,WVRADDFN,WVRADDTE,WVRADIEN,WVRPTIEN
"RTN","WVRADWP",16,0)
 S WVRADIEN=$P(^WV(790.1,DA,0),U,15)
"RTN","WVRADWP",17,0)
 Q:WVRADIEN=""  ;no 'radiology mam case #'
"RTN","WVRADWP",18,0)
 S WVRADDFN=$P(^WV(790.1,DA,0),U,2)
"RTN","WVRADWP",19,0)
 Q:'WVRADDFN  ;no dfn
"RTN","WVRADWP",20,0)
 S WVRADDTE=$O(^RADPT("ADC",WVRADIEN,WVRADDFN,0))
"RTN","WVRADWP",21,0)
 Q:'WVRADDTE  ;no inverse exam date
"RTN","WVRADWP",22,0)
 S WVRADCSE=$O(^RADPT("ADC",WVRADIEN,WVRADDFN,WVRADDTE,0))
"RTN","WVRADWP",23,0)
 Q:'WVRADCSE  ;no case number
"RTN","WVRADWP",24,0)
 S WVRPTIEN=+$P(^RADPT(WVRADDFN,"DT",WVRADDTE,"P",WVRADCSE,0),U,17)
"RTN","WVRADWP",25,0)
 Q:'WVRPTIEN  ;no report in File 74
"RTN","WVRADWP",26,0)
 K ^TMP($J,"WV RADRPT"),^TMP("WV RADRPT",$J)
"RTN","WVRADWP",27,0)
 D GETS^DIQ(74,WVRPTIEN_",","*","EI","^TMP($J,""WV RADRPT"")")
"RTN","WVRADWP",28,0)
 S ^TMP("WV RADRPT",$J,1,0)="                   DAY-CASE #: "_$G(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",.01,"E"))_$S($$AMEND(WVRPTIEN):"                    (AMENDED REPORT)",1:"")
"RTN","WVRADWP",29,0)
 S ^TMP("WV RADRPT",$J,2,0)="               EXAM DATE/TIME: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",3,"E")
"RTN","WVRADWP",30,0)
 S ^TMP("WV RADRPT",$J,3,0)="          VERIFYING PHYSICIAN: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",9,"E")
"RTN","WVRADWP",31,0)
 S ^TMP("WV RADRPT",$J,4,0)="                    PROCEDURE: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",102,"E")
"RTN","WVRADWP",32,0)
 S ^TMP("WV RADRPT",$J,5,0)="             CATEGORY OF EXAM: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",104,"E")
"RTN","WVRADWP",33,0)
 S ^TMP("WV RADRPT",$J,6,0)="                         WARD: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",106,"E")
"RTN","WVRADWP",34,0)
 S ^TMP("WV RADRPT",$J,7,0)=" TREATING SERVICE (INPATIENT): "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",107,"E")
"RTN","WVRADWP",35,0)
 S ^TMP("WV RADRPT",$J,8,0)="             PRINCIPAL CLINIC: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",108,"E")
"RTN","WVRADWP",36,0)
 S ^TMP("WV RADRPT",$J,9,0)="      CONTRACT SHARING SOURCE: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",109,"E")
"RTN","WVRADWP",37,0)
 S ^TMP("WV RADRPT",$J,10,0)="PRIMARY INTERPRETING RESIDENT: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",112,"E")
"RTN","WVRADWP",38,0)
 S ^TMP("WV RADRPT",$J,11,0)="   PRIMARY INTERPRETING STAFF: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",115,"E")
"RTN","WVRADWP",39,0)
 S ^TMP("WV RADRPT",$J,12,0)="            PRIMARY DIAGNOSIS: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",113,"E")
"RTN","WVRADWP",40,0)
 S ^TMP("WV RADRPT",$J,13,0)="         REQUESTING PHYSICIAN: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",114,"E")
"RTN","WVRADWP",41,0)
 S ^TMP("WV RADRPT",$J,14,0)="                 COMPLICATION: "_^TMP($J,"WV RADRPT",74,WVRPTIEN_",",116,"E")
"RTN","WVRADWP",42,0)
 S ^TMP("WV RADRPT",$J,15,0)=" "
"RTN","WVRADWP",43,0)
 S ^TMP("WV RADRPT",$J,16,0)="CLINICAL HISTORY:"
"RTN","WVRADWP",44,0)
 S LOOP=0,WVLCNT=16
"RTN","WVRADWP",45,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",400,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",46,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",47,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",400,LOOP)
"RTN","WVRADWP",48,0)
 .Q
"RTN","WVRADWP",49,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",50,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)=" "
"RTN","WVRADWP",51,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",52,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)="IMPRESSION TEXT:"
"RTN","WVRADWP",53,0)
 S LOOP=0
"RTN","WVRADWP",54,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",300,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",55,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",56,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",300,LOOP)
"RTN","WVRADWP",57,0)
 .Q
"RTN","WVRADWP",58,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",59,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)=" "
"RTN","WVRADWP",60,0)
 S WVLCNT=WVLCNT+1
"RTN","WVRADWP",61,0)
 S ^TMP("WV RADRPT",$J,WVLCNT,0)="REPORT TEXT:"
"RTN","WVRADWP",62,0)
 S LOOP=0
"RTN","WVRADWP",63,0)
 F  S LOOP=$O(^TMP($J,"WV RADRPT",74,WVRPTIEN_",",200,LOOP)) Q:'LOOP  D
"RTN","WVRADWP",64,0)
 .S WVLCNT=WVLCNT+1
"RTN","WVRADWP",65,0)
 .S ^TMP("WV RADRPT",$J,WVLCNT,0)=^TMP($J,"WV RADRPT",74,WVRPTIEN_",",200,LOOP)
"RTN","WVRADWP",66,0)
 .Q
"RTN","WVRADWP",67,0)
 K ^TMP($J,"WV RADRPT"),WVLCNT,^WV(790.1,DA,9)
"RTN","WVRADWP",68,0)
 S WVJCN=0 F  S WVJCN=$O(^TMP("WV RADRPT",$J,WVJCN)) Q:WVJCN'>0  D
"RTN","WVRADWP",69,0)
 .S ^WV(790.1,DA,9,WVJCN,0)=$G(^TMP("WV RADRPT",$J,WVJCN,0)) S WVJCN1=WVJCN
"RTN","WVRADWP",70,0)
 S ^WV(790.1,DA,9,0)="^^"_WVJCN1_"^"_WVJCN1
"RTN","WVRADWP",71,0)
 K ^TMP("WV RADRPT",$J)
"RTN","WVRADWP",72,0)
 Q
"RTN","WVRADWP",73,0)
EX ; delete existing radiology report text stored in WH
"RTN","WVRADWP",74,0)
 K ^WV(790.1,DA,9)
"RTN","WVRADWP",75,0)
 Q
"RTN","WVRADWP",76,0)
MAIL(DFN,WVACCESS,WVPROC,WVPROV) ; Send mail message to case manager when
"RTN","WVRADWP",77,0)
 ; Radiology procedure is added to WH Procedure file (#790.1).
"RTN","WVRADWP",78,0)
 ; Called from WVRALINK
"RTN","WVRADWP",79,0)
 ;      DFN -> Patient ien
"RTN","WVRADWP",80,0)
 ; WVACCESS -> File 790.1 ien (procedure entry)
"RTN","WVRADWP",81,0)
 ;   WVPROC -> File 790.2 ien (procedure type)
"RTN","WVRADWP",82,0)
 ;   WVPROV -> File 200   IEN (provider/requestor)
"RTN","WVRADWP",83,0)
 Q:'$G(DFN)!('$G(WVACCESS))!('$G(WVPROC))
"RTN","WVRADWP",84,0)
 N WVCMGR,WVLOOP,WVMSG,XMDUZ,XMSUB,XMTEXT
"RTN","WVRADWP",85,0)
 S WVCMGR=+$$GET1^DIQ(790,DFN,.1,"I") ;get case manager
"RTN","WVRADWP",86,0)
 S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRADWP",87,0)
 ; if no case manager, then get default case manager(s)
"RTN","WVRADWP",88,0)
 I 'WVCMGR S WVLOOP=0 F  S WVLOOP=$O(^WV(790.02,WVLOOP)) Q:'WVLOOP  D
"RTN","WVRADWP",89,0)
 .S WVCMGR=$$GET1^DIQ(790.02,WVLOOP,.02,"I")
"RTN","WVRADWP",90,0)
 .S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRADWP",91,0)
 .Q
"RTN","WVRADWP",92,0)
 Q:$O(XMY(0))'>0  ;no case manager(s)
"RTN","WVRADWP",93,0)
 S:WVPROV XMY(WVPROV)=""
"RTN","WVRADWP",94,0)
 S XMDUZ=.5 ;message sender
"RTN","WVRADWP",95,0)
 S XMSUB="RAD/NM added a procedure for a WH patient"
"RTN","WVRADWP",96,0)
 S WVMSG(1)="        Patient: "_$P($G(^DPT(DFN,0)),U,1)_" (SSN: "_$$SSN^WVUTL1(DFN)_")"
"RTN","WVRADWP",97,0)
 S WVMSG(2)=" WH Accession #: "_$P($G(^WV(790.1,+WVACCESS,0)),U,1)
"RTN","WVRADWP",98,0)
 S WVMSG(3)="      Procedure: "_$P($G(^WV(790.2,+WVPROC,0)),U,1)
"RTN","WVRADWP",99,0)
 S WVMSG(4)=" "
"RTN","WVRADWP",100,0)
 S WVMSG(5)="Please use the 'Edit a Procedure' option in the WOMEN'S"
"RTN","WVRADWP",101,0)
 S WVMSG(6)="HEALTH package to complete/close this procedure."
"RTN","WVRADWP",102,0)
 S XMTEXT="WVMSG("
"RTN","WVRADWP",103,0)
 D ^XMD
"RTN","WVRADWP",104,0)
 Q
"RTN","WVRADWP",105,0)
AMEND(WVRPTIEN) ; Check if RAD/NM report is amended.
"RTN","WVRADWP",106,0)
 ; WVRPTIEN - File 74 ien
"RTN","WVRADWP",107,0)
 N WVAMEND
"RTN","WVRADWP",108,0)
 K ^TMP("DILIST",$J),^TMP("DIERR",$J)
"RTN","WVRADWP",109,0)
 D LIST^DIC(74.06,","_WVRPTIEN_",",.01)
"RTN","WVRADWP",110,0)
 S WVAMEND=$O(^TMP("DILIST",$J,0))
"RTN","WVRADWP",111,0)
 K ^TMP("DILIST",$J),^TMP("DIERR",$J)
"RTN","WVRADWP",112,0)
 Q WVAMEND
"RTN","WVRALIN1")
0^5^B4910147
"RTN","WVRALIN1",1,0)
WVRALIN1 ;HCIOFO/FT-RAD/NM-WOMEN'S HEALTH LINK (cont.) ;1/26/99  12:50
"RTN","WVRALIN1",2,0)
 ;;1.0;WOMEN'S HEALTH;**5**;Sep 30, 1998
"RTN","WVRALIN1",3,0)
 ;
"RTN","WVRALIN1",4,0)
FIND ; Try to associate an incoming RAD/NM entry with an existing WH
"RTN","WVRALIN1",5,0)
 ; procedure that has no link to RAD/NM entry.
"RTN","WVRALIN1",6,0)
 ; Called from WVRALINK.
"RTN","WVRALIN1",7,0)
 ; Input variables needed:
"RTN","WVRALIN1",8,0)
 ;    DFN - patient ien
"RTN","WVRALIN1",9,0)
 ; WVPROC - ien of WV Procedure Type (790.2)
"RTN","WVRALIN1",10,0)
 ; WVDATE - date portion of date of rad/nm procedure
"RTN","WVRALIN1",11,0)
 ;
"RTN","WVRALIN1",12,0)
 ; First, loop through Date of Procedure x-ref
"RTN","WVRALIN1",13,0)
 N WVDTECHK,WVFLAG,WVIEN,WVLOOP,WVNODE
"RTN","WVRALIN1",14,0)
 S WVDTECHK=WVDATE_".999999",WVFLAG=0,WVLOOP=WVDATE-.000001
"RTN","WVRALIN1",15,0)
 F  S WVLOOP=$O(^WV(790.1,"D",WVLOOP)) Q:'WVLOOP!(WVLOOP>WVDTECHK)!(WVFLAG)  S WVIEN=0 F  S WVIEN=$O(^WV(790.1,"D",WVLOOP,WVIEN)) Q:'WVIEN!(WVFLAG)  D
"RTN","WVRALIN1",16,0)
 .S WVNODE=$G(^WV(790.1,WVIEN,0)) Q:WVNODE=""
"RTN","WVRALIN1",17,0)
 .Q:$P(WVNODE,U,15)]""  ;already has a rad/nm link
"RTN","WVRALIN1",18,0)
 .Q:$P(WVNODE,U,2)'=DFN  ;not the same patient
"RTN","WVRALIN1",19,0)
 .Q:$P(WVNODE,U,4)'=WVPROC  ;not the same procedure
"RTN","WVRALIN1",20,0)
 .D LINK
"RTN","WVRALIN1",21,0)
 .S WVFLAG=1 ;flag that link is made to an existing record, so quit loop
"RTN","WVRALIN1",22,0)
 .Q
"RTN","WVRALIN1",23,0)
 Q
"RTN","WVRALIN1",24,0)
LINK ; Update values in existing entry including day-case # link.
"RTN","WVRALIN1",25,0)
 ; Input variables needed:
"RTN","WVRALIN1",26,0)
 ;  WVNODE - zero node of a File 790.1 entry.
"RTN","WVRALIN1",27,0)
 ;   WVIEN - File 790.1 ien
"RTN","WVRALIN1",28,0)
 Q:$G(WVNODE)=""  Q:'$G(WVIEN)
"RTN","WVRALIN1",29,0)
 N DIE,DA,DR
"RTN","WVRALIN1",30,0)
 S DIE="^WV(790.1,",DA=WVIEN
"RTN","WVRALIN1",31,0)
 ; fill in missing data where possible.
"RTN","WVRALIN1",32,0)
 S DR=".15////"_WVCASE ;radiology mam case# (i.e., link to RAD/NM entry)
"RTN","WVRALIN1",33,0)
 I $P(WVNODE,U,5)="",$G(WVBWDX)]"" S DR=DR_";.05////"_WVBWDX ;result/dx
"RTN","WVRALIN1",34,0)
 I $P(WVNODE,U,7)="",$G(WVPROV)]"" S DR=DR_";.07////"_WVPROV ;provider
"RTN","WVRALIN1",35,0)
 I $P(WVNODE,U,9)="",$G(WVMOD)]"" S DR=DR_";.09////"_WVMOD ;modifier
"RTN","WVRALIN1",36,0)
 I $P(WVNODE,U,10)="",$G(DUZ(2))]"" S DR=DR_";.1////"_DUZ(2) ;facility
"RTN","WVRALIN1",37,0)
 I $P(WVNODE,U,11)="",$G(WVLOC)]"" S DR=DR_";.11////"_WVLOC ;location
"RTN","WVRALIN1",38,0)
 I $P(WVNODE,U,35)="",$G(WVCREDIT)]"" S DR=DR_";.35////"_WVCREDIT ;rad/nm credit method
"RTN","WVRALIN1",39,0)
 D ^DIE
"RTN","WVRALIN1",40,0)
 Q
"RTN","WVRALINK")
0^4^B44170831
"RTN","WVRALINK",1,0)
WVRALINK ;HCIOFO/FT IHS/ANMC/MWR - RAD/NM-WOMEN'S HEALTH LINK  ;2/19/99  15:35
"RTN","WVRALINK",2,0)
 ;;1.0;WOMEN'S HEALTH;**3,5**;Sep 30, 1998
"RTN","WVRALINK",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRALINK",4,0)
 ;;  CREATE MAMMOGRAM PROCEDURE IN WOMEN'S HEALTH FOR THIS PATIENT.
"RTN","WVRALINK",5,0)
 ;;  CALLED BY ^RART WHEN A RADIOLOGY REPORT IS VERIFIED.
"RTN","WVRALINK",6,0)
 ;;  CALLED BY ^RARTE1 WHEN A RADIOLOGY REPORT IS UNVERIFIED.
"RTN","WVRALINK",7,0)
 ;;  CALLED BY ^WVEXPTRA WHEN EXPORTING HISTORICAL MAMS TO WOMEN'S HEALTH
"RTN","WVRALINK",8,0)
 ;
"RTN","WVRALINK",9,0)
 ;---> REQUIRED VARIABLES: DFN  = DFN OF RADIOLOGY PATIENT.
"RTN","WVRALINK",10,0)
 ;--->                     DATE = INVERSE DATE/TIME OF VISIT.
"RTN","WVRALINK",11,0)
 ;--->                     CASE = IEN OF RADIOLOGY EXAM (CASE).
"RTN","WVRALINK",12,0)
 ;
"RTN","WVRALINK",13,0)
 ;---> OPTIONAL VARIABLE:  WVNEWP = TOTAL NEW WH PATIENTS ADDED.
"RTN","WVRALINK",14,0)
 ;--->                     WVMCNT = TOTAL NEW MAMS PROCEDURES ADDED.
"RTN","WVRALINK",15,0)
 ;--->                     THESE IF CALLED FROM ^WVEXPTRA ROUTINE.
"RTN","WVRALINK",16,0)
 ;
"RTN","WVRALINK",17,0)
 ;---> GENERATED VARIBLES:
"RTN","WVRALINK",18,0)
 ;---> WVPROC = IEN OF RADIOLOGY PROCEDURE (FILE #71), THEN IT
"RTN","WVRALINK",19,0)
 ;--->          GETS CHANGED TO WOMEN'S HEALTH PROCEDURE TYPE
"RTN","WVRALINK",20,0)
 ;--->                                   (FILE #790.2).
"RTN","WVRALINK",21,0)
 ;---> WVLOC  = WARD/CLINIC/LOCATION (FILE #44).
"RTN","WVRALINK",22,0)
 ;---> WVDATE = DATE OF THE PROCEDURE.
"RTN","WVRALINK",23,0)
 ;---> WVPROV = ORDERING PROVIDER.
"RTN","WVRALINK",24,0)
 ;---> WVMOD  = LEFT OR RIGHT, IF IT'S A UNILATERAL MAMMOGRAM.
"RTN","WVRALINK",25,0)
 ;---> WVDX   = RADIOLOGY DIAGNOSTIC CODE.
"RTN","WVRALINK",26,0)
 ;---> WVBWDX = WOMEN'S HEALTH RESULT/DIAGNOSIS.
"RTN","WVRALINK",27,0)
 ;
"RTN","WVRALINK",28,0)
CREATE(DFN,DATE,CASE) ;
"RTN","WVRALINK",29,0)
 Q:'+$$VERSION^XPDUTL("WV")
"RTN","WVRALINK",30,0)
 Q:($G(DFN)']"")!($G(DATE)']"")!($G(CASE)']"")
"RTN","WVRALINK",31,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WVRALINK",32,0)
 S ZTRTN="CREATEQ^WVRALINK",ZTDESC="WV CREATE MAMMOGRAM ENTRY"
"RTN","WVRALINK",33,0)
 S ZTSAVE("DFN")="",ZTSAVE("DATE")="",ZTSAVE("CASE")=""
"RTN","WVRALINK",34,0)
 S ZTIO="",ZTDTH=$H
"RTN","WVRALINK",35,0)
 D ^%ZTLOAD
"RTN","WVRALINK",36,0)
 Q
"RTN","WVRALINK",37,0)
CREATEH(DFN,DATE,CASE,STATUS) ; Entry from ^WVEXPTRA which looks for exams
"RTN","WVRALINK",38,0)
 ; created before the WH package was installed.
"RTN","WVRALINK",39,0)
 Q:($G(DFN)']"")!($G(DATE)']"")!($G(CASE)']"")!($G(STATUS)']"")
"RTN","WVRALINK",40,0)
 ; 
"RTN","WVRALINK",41,0)
CREATEQ ; Queue data entry creation. Called from CREATE above
"RTN","WVRALINK",42,0)
 N WVPROC,WVLOC,WVDATE,WVPROV,WVMOD,WVDX,WVBWDX,WVLEFT,WVRIGHT
"RTN","WVRALINK",43,0)
 N WVCASE,WVCPT,WVERR,WVCREDIT ;,WVEXAM0
"RTN","WVRALINK",44,0)
 ;---> QUIT IF RADIOLOGY DATA IS NOT DEFINED OR ="".
"RTN","WVRALINK",45,0)
 Q:'$D(^RADPT(DFN,"DT",DATE,"P",CASE,0))
"RTN","WVRALINK",46,0)
 ;
"RTN","WVRALINK",47,0)
 ;---> QUIT IF THIS PROCEDURE DOES NOT HAVE A MAM CPT CODE.
"RTN","WVRALINK",48,0)
 ;---> QUIT IF THIS PROCEDURE DOES NOT HAVE A BREAST ULTRASOUND CPT CODE.
"RTN","WVRALINK",49,0)
 ;---> WVEXAM0=ZERO NODE OF RADIOLOGY EXAM.
"RTN","WVRALINK",50,0)
 S WVEXAM0=^RADPT(DFN,"DT",DATE,"P",CASE,0)
"RTN","WVRALINK",51,0)
 S WVCPT=$P(^RAMIS(71,$P(WVEXAM0,U,2),0),U,9)
"RTN","WVRALINK",52,0)
 Q:(WVCPT'=76090)&(WVCPT'=76091)&(WVCPT'=76092)&(WVCPT'=76645)
"RTN","WVRALINK",53,0)
 Q:$P($G(^DPT(DFN,0)),U,2)'="F"  ;not female
"RTN","WVRALINK",54,0)
 ;
"RTN","WVRALINK",55,0)
 ;---> QUIT IF NO WOMEN'S HEALTH SITE PARAMETER FILE ON THIS MACHINE.
"RTN","WVRALINK",56,0)
 ;     OR NO DEFAULT CASE MANAGER
"RTN","WVRALINK",57,0)
 Q:'$D(^WV(790.02,DUZ(2)))
"RTN","WVRALINK",58,0)
 Q:'$P($G(^WV(790.02,+$G(DUZ(2)),0)),U,2)
"RTN","WVRALINK",59,0)
 ;
"RTN","WVRALINK",60,0)
 ;---> IF NOT CALLED FROM ^WVEXPTRA (i.e., STATUS is undefined) CHECK
"RTN","WVRALINK",61,0)
 ;---> SITE PARAMETER AND QUIT IF "IMPORT MAMMOGRAMS FROM RADIOLOGY"
"RTN","WVRALINK",62,0)
 ;---> IS NOT SET TO "YES".
"RTN","WVRALINK",63,0)
 N Y S Y=^WV(790.02,DUZ(2),0)
"RTN","WVRALINK",64,0)
 I '$D(STATUS) Q:'$P(Y,U,10)
"RTN","WVRALINK",65,0)
 ;
"RTN","WVRALINK",66,0)
 ;---> SET WVZSTAT =THE STATUS (OPEN OR CLOSED) IN WOMEN'S HEALTH.
"RTN","WVRALINK",67,0)
 ;---> THAT MAMMOGRAMS SHOULD RECEIVE WHEN COPIED OVER FROM RADIOLOGY.
"RTN","WVRALINK",68,0)
 S WVZSTAT=$P(Y,U,23) S:WVZSTAT="" WVZSTAT="o"
"RTN","WVRALINK",69,0)
 I $G(STATUS)]"" S WVZSTAT=$G(STATUS) ;status selected in ^WVEXPTRA
"RTN","WVRALINK",70,0)
 ;
"RTN","WVRALINK",71,0)
 ;---> BELOW ARE IENS FOR WV PROCEDURE TYPE FILE #790.2.
"RTN","WVRALINK",72,0)
 ;---> IEN 26 IN ^WV(790.2, IS UNILATERAL MAMMOGRAM.
"RTN","WVRALINK",73,0)
 ;---> IEN 25 IN ^WV(790.2, IS BILATERAL MAMMOGRAM.
"RTN","WVRALINK",74,0)
 ;---> IEN 28 IN ^WV(790.2, IS SCREENING MAMMOGRAM.
"RTN","WVRALINK",75,0)
 ;---> IEN 38 IN ^WV(790.2, IS ECHO EXAM OF BREAST.
"RTN","WVRALINK",76,0)
 I WVCPT=76090 S WVPROC=26 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",77,0)
 I WVCPT=76091 S WVPROC=25 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",78,0)
 I WVCPT=76092 S WVPROC=28 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",79,0)
 I WVCPT=76645 S WVPROC=38 D COPY(WVEXAM0) G EXIT
"RTN","WVRALINK",80,0)
 ;
"RTN","WVRALINK",81,0)
EXIT ;EP
"RTN","WVRALINK",82,0)
 K I,N,X
"RTN","WVRALINK",83,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVRALINK",84,0)
 Q
"RTN","WVRALINK",85,0)
 ;
"RTN","WVRALINK",86,0)
 ;
"RTN","WVRALINK",87,0)
COPY(Y) ;EP
"RTN","WVRALINK",88,0)
 ;---> COPY MAM PROCEDURE DATA FROM RADIOLOGY TO WOMEN'S HEALTH.
"RTN","WVRALINK",89,0)
 ;---> VARIABLE DFN=PATIENT
"RTN","WVRALINK",90,0)
 ;---> LOCATION=DUZ(2)
"RTN","WVRALINK",91,0)
 ;---> WARD/CLINIC/LOCATION
"RTN","WVRALINK",92,0)
 N X
"RTN","WVRALINK",93,0)
 S WVLOC=$P(Y,U,8)
"RTN","WVRALINK",94,0)
 ;
"RTN","WVRALINK",95,0)
 ;---> WVDATE=DATE OF THE PROCEDURE.
"RTN","WVRALINK",96,0)
 S WVDATE=$P($P(^RADPT(DFN,"DT",DATE,0),U),".")
"RTN","WVRALINK",97,0)
 ;
"RTN","WVRALINK",98,0)
 ;---> RECONSTRUCT THE FULL CASE# FOR THIS RAD PROCEDURE.
"RTN","WVRALINK",99,0)
 ;---> THIS IS USED AS A LINK (XREF) BETWEEN THE RADIOLOGY PROCEDURE
"RTN","WVRALINK",100,0)
 ;---> AND THE WOMEN'S HEALTH PROCEDURE.
"RTN","WVRALINK",101,0)
 S WVCASE=$E(WVDATE,4,7)_$E(WVDATE,2,3)_"-"_$P(Y,U)
"RTN","WVRALINK",102,0)
 ;---> CHECK TO BE SURE THE CASE# XREF IS REALLY DOWN THERE.
"RTN","WVRALINK",103,0)
 S:'$D(^RADPT("ADC",WVCASE,DFN,DATE,CASE)) WVCASE="UNKNOWN"
"RTN","WVRALINK",104,0)
 ;
"RTN","WVRALINK",105,0)
 ;---> QUIT IF THIS PROCEDURE HAS ALREADY BEEN SENT TO WOMEN'S HEALTH.
"RTN","WVRALINK",106,0)
 Q:$D(^WV(790.1,"E",WVCASE))
"RTN","WVRALINK",107,0)
 ;
"RTN","WVRALINK",108,0)
 ;---> REQUESTING PROVIDER/ORDERING PROVIDER
"RTN","WVRALINK",109,0)
 S WVPROV=$P(Y,U,14)
"RTN","WVRALINK",110,0)
 ;
"RTN","WVRALINK",111,0)
 ;---> IF UNILATERAL, ATTEMPT TO PICK UP LEFT OR RIGHT MODIFIER.
"RTN","WVRALINK",112,0)
 I WVPROC=26 D
"RTN","WVRALINK",113,0)
 .I $D(^RADPT(DFN,"DT",DATE,"P",CASE,"M",0)) D
"RTN","WVRALINK",114,0)
 ..N N S N=0
"RTN","WVRALINK",115,0)
 ..F  S N=$O(^RADPT(DFN,"DT",DATE,"P",CASE,"M",N)) Q:'N  D
"RTN","WVRALINK",116,0)
 ...S WVMOD=$P(^RADPT(DFN,"DT",DATE,"P",CASE,"M",N,0),U)
"RTN","WVRALINK",117,0)
 ...S WVMOD=$P(^RAMIS(71.2,WVMOD,0),U)
"RTN","WVRALINK",118,0)
 ...I "LEFTleft"[WVMOD S WVLEFT=1
"RTN","WVRALINK",119,0)
 ...I "RIGHTright"[WVMOD S WVRIGHT=1
"RTN","WVRALINK",120,0)
 ..Q:$D(WVLEFT)&($D(WVRIGHT))
"RTN","WVRALINK",121,0)
 ..I $D(WVLEFT) S WVMOD="l" Q
"RTN","WVRALINK",122,0)
 ..I $D(WVRIGHT) S WVMOD="r" Q
"RTN","WVRALINK",123,0)
 ;
"RTN","WVRALINK",124,0)
 ;---> IF THERE'S A DIAGNOSTIC CODE, ATTEMPT TO PICK UP DIAGNOSIS.
"RTN","WVRALINK",125,0)
 ;---> USE "WV DIAGNOSTIC CODE TRANSLATION" FILE #790.32.
"RTN","WVRALINK",126,0)
 S WVDX=$P(Y,U,13)
"RTN","WVRALINK",127,0)
 I +WVDX I $D(^WV(790.32,"C",WVDX)) S WVBWDX=$O(^WV(790.32,"C",WVDX,0))
"RTN","WVRALINK",128,0)
 ;
"RTN","WVRALINK",129,0)
 ;---> GET CREDIT METHOD.
"RTN","WVRALINK",130,0)
 S WVCREDIT=$P(Y,U,26)
"RTN","WVRALINK",131,0)
 ;
"RTN","WVRALINK",132,0)
PATIENT ;---> IF PATIENT ISN'T IN WOMEN'S HEALTH DATABASE, ADD HER.
"RTN","WVRALINK",133,0)
 S WVERR=1
"RTN","WVRALINK",134,0)
 I '$D(^WV(790,DFN,0)) D
"RTN","WVRALINK",135,0)
 .D AUTOADD^WVPATE(DFN,DUZ(2),.WVERR)
"RTN","WVRALINK",136,0)
 .I $D(WVNEWP) S:WVERR WVNEWP=WVNEWP+1
"RTN","WVRALINK",137,0)
 Q:WVERR<0
"RTN","WVRALINK",138,0)
 D FIND^WVRALIN1 ;check for 'unlinked' entry in File 790.1
"RTN","WVRALINK",139,0)
 Q:$D(^WV(790.1,"E",WVCASE))  ;quit if link was made in WVRALIN1
"RTN","WVRALINK",140,0)
PROC ;---> CREATE MAMMOGRAM PROCEDURE IN WV PROCEDURE FILE #790.1.
"RTN","WVRALINK",141,0)
 S WVDR=".02////"_DFN_";.04////"_WVPROC
"RTN","WVRALINK",142,0)
 S WVDR=WVDR_";.05////"_$G(WVBWDX)_";.07////"_WVPROV
"RTN","WVRALINK",143,0)
 S WVDR=WVDR_";.09////"_$G(WVMOD)_";.1////"_DUZ(2)_";.11////"_WVLOC
"RTN","WVRALINK",144,0)
 S WVDR=WVDR_";.12////"_WVDATE_";.14////"_WVZSTAT_";.15////"_WVCASE
"RTN","WVRALINK",145,0)
 S WVDR=WVDR_";.18////.5;.19////"_DT_";.34////"_$G(DUZ(2))_";.35////"_WVCREDIT
"RTN","WVRALINK",146,0)
 ;
"RTN","WVRALINK",147,0)
 D NEW2^WVPROC(DFN,WVPROC,WVDATE,WVDR,"","",.WVERR)
"RTN","WVRALINK",148,0)
 I $D(WVMCNT) S:WVERR>-1 WVMCNT=WVMCNT+1
"RTN","WVRALINK",149,0)
 Q:WVERR<0  ;procedure not added
"RTN","WVRALINK",150,0)
 Q:$D(WVMCNT)  ;mass import of Rad/NM exams
"RTN","WVRALINK",151,0)
 ;Q:$P($G(^WV(790.02,+DUZ(2),0)),U,23)="c"  ;Status=closed
"RTN","WVRALINK",152,0)
 D MAIL^WVRADWP(DFN,+Y,WVPROC,WVPROV) ;iens for patient, accession, procedure, provider/requestor
"RTN","WVRALINK",153,0)
 Q
"RTN","WVRALINK",154,0)
 ;
"RTN","WVRALINK",155,0)
 ;
"RTN","WVRALINK",156,0)
DELETE(DFN,DATE,CASE) ;EP
"RTN","WVRALINK",157,0)
 ;---> MODIFY WOMEN'S HEALTH PROCEDURE TO REFLECT CHANGE.
"RTN","WVRALINK",158,0)
 ;---> CALLED FROM RARTE1 (DELETE A REPORT AND UNVERIFY A REPORT).
"RTN","WVRALINK",159,0)
 ;
"RTN","WVRALINK",160,0)
 Q:'+$$VERSION^XPDUTL("WV")
"RTN","WVRALINK",161,0)
 Q:'$D(DFN)!('$D(DATE))!('$D(CASE))
"RTN","WVRALINK",162,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","WVRALINK",163,0)
 S ZTRTN="DELETEQ^WVRALINK",ZTDESC="WV MAMMOGRAM RPT CHANGE"
"RTN","WVRALINK",164,0)
 S ZTSAVE("DFN")="",ZTSAVE("DATE")="",ZTSAVE("CASE")=""
"RTN","WVRALINK",165,0)
 S ZTIO="",ZTDTH=$H
"RTN","WVRALINK",166,0)
 D ^%ZTLOAD
"RTN","WVRALINK",167,0)
 Q
"RTN","WVRALINK",168,0)
DELETEQ ; Modify WV entry when mammogram report is unverified or deleted
"RTN","WVRALINK",169,0)
 Q:'$D(^RADPT(DFN,"DT",DATE,"P",CASE,0))
"RTN","WVRALINK",170,0)
 N WVIEN,WVDATE,WVCASE,WVCMGR,WVLOOP,WVMSG,WVPROV
"RTN","WVRALINK",171,0)
 N XMDUZ,XMSUB,XMTEXT,XMY ;send mail message to case manager
"RTN","WVRALINK",172,0)
 ;
"RTN","WVRALINK",173,0)
 ;---> WVDATE=DATE OF PROCEDURE.
"RTN","WVRALINK",174,0)
 S WVDATE=$P($P(^RADPT(DFN,"DT",DATE,0),U),".")
"RTN","WVRALINK",175,0)
 S WVCASE=$P(^RADPT(DFN,"DT",DATE,"P",CASE,0),U)
"RTN","WVRALINK",176,0)
 ;
"RTN","WVRALINK",177,0)
 ;---> WVCASE=RECONSTRUCTED CASE# OF PROCEDURE.
"RTN","WVRALINK",178,0)
 S WVCASE=$E(WVDATE,4,7)_$E(WVDATE,2,3)_"-"_WVCASE
"RTN","WVRALINK",179,0)
 ;---> QUIT IF NO CASE# XREF IN WOMEN'S HEALTH PROCEDURE FILE.
"RTN","WVRALINK",180,0)
 Q:'$D(^WV(790.1,"E",WVCASE))
"RTN","WVRALINK",181,0)
 ;
"RTN","WVRALINK",182,0)
 S WVIEN=$O(^WV(790.1,"E",WVCASE,0))
"RTN","WVRALINK",183,0)
 Q:'$D(^WV(790.1,WVIEN,0))
"RTN","WVRALINK",184,0)
 D RADMOD^WVPROC(WVIEN) ;update wh status to "open"
"RTN","WVRALINK",185,0)
 S WVPROV=+$$GET1^DIQ(790.1,WVIEN,.07,"I") ;get provider/requestor
"RTN","WVRALINK",186,0)
 S WVCMGR=+$$GET1^DIQ(790,DFN,.1,"I") ;get case manager
"RTN","WVRALINK",187,0)
 S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRALINK",188,0)
 ; if no case manager, then get default case manager(s)
"RTN","WVRALINK",189,0)
 I 'WVCMGR S WVLOOP=0 F  S WVLOOP=$O(^WV(790.02,WVLOOP)) Q:'WVLOOP  D
"RTN","WVRALINK",190,0)
 .S WVCMGR=$$GET1^DIQ(790.02,WVLOOP,.02,"I")
"RTN","WVRALINK",191,0)
 .S:WVCMGR XMY(WVCMGR)=""
"RTN","WVRALINK",192,0)
 .Q
"RTN","WVRALINK",193,0)
 Q:$O(XMY(0))'>0  ;no case manager(s)
"RTN","WVRALINK",194,0)
 S:WVPROV XMY(WVPROV)=""
"RTN","WVRALINK",195,0)
 S XMDUZ=.5 ;message sender
"RTN","WVRALINK",196,0)
 S XMSUB="RAD/NM Rpt for WH patient is UNVERIFIED/DELETED"
"RTN","WVRALINK",197,0)
 S WVMSG(1)="        Patient: "_$P($G(^DPT(DFN,0)),U,1)_" (SSN: "_$$SSN^WVUTL1(DFN)_")"
"RTN","WVRALINK",198,0)
 S WVMSG(2)=" WH Accession #: "_$P($G(^WV(790.1,+WVIEN,0)),U,1)
"RTN","WVRALINK",199,0)
 S WVMSG(3)="  RAD/NM Case #: "_WVCASE
"RTN","WVRALINK",200,0)
 S WVMSG(4)=" "
"RTN","WVRALINK",201,0)
 S WVMSG(5)="NOTE: THIS PROCEDURE HAS BEEN ALTERED IN RADIOLOGY/NM."
"RTN","WVRALINK",202,0)
 S WVMSG(6)="Follow-up is required in the WOMEN'S HEALTH package!"
"RTN","WVRALINK",203,0)
 S XMTEXT="WVMSG("
"RTN","WVRALINK",204,0)
 D ^XMD
"RTN","WVRALINK",205,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVRALINK",206,0)
 Q
"RTN","WVUTL5")
0^7^B13601829
"RTN","WVUTL5",1,0)
WVUTL5 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: ACC#, TITLES, SL/TX DATES; ;1/29/99  15:15
"RTN","WVUTL5",2,0)
 ;;1.0;WOMEN'S HEALTH;**5**;Sep 30, 1998
"RTN","WVUTL5",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL5",4,0)
 ;;  UTILITY: SETVARS, GENERATE ACCESSION#, MENUT, TITLE, CENTERT,
"RTN","WVUTL5",5,0)
 ;;  COPYLET, UPPERCASE XREF, SL/TX DATES.
"RTN","WVUTL5",6,0)
 ;
"RTN","WVUTL5",7,0)
 ;
"RTN","WVUTL5",8,0)
SETVARS ;EP
"RTN","WVUTL5",9,0)
 S:'$D(WVPOP) WVPOP=0
"RTN","WVUTL5",10,0)
 Q
"RTN","WVUTL5",11,0)
 ;**************
"RTN","WVUTL5",12,0)
 ;
"RTN","WVUTL5",13,0)
 ;
"RTN","WVUTL5",14,0)
ACCSSN(PCDTYPE) ;EP
"RTN","WVUTL5",15,0)
 ;---> GENERATE ACCESSION# FOR WV PROCEDURE FILE ENTRY.
"RTN","WVUTL5",16,0)
 ;---> REQUIRED VARIABLE: PCDTYPE=IEN OF PROCEDURE TYPE (#790.2)
"RTN","WVUTL5",17,0)
 N A,C,L,N,P,R,X
"RTN","WVUTL5",18,0)
 Q:'$D(PCDTYPE) ""
"RTN","WVUTL5",19,0)
 Q:'$D(^WV(790.2,PCDTYPE,0)) ""
"RTN","WVUTL5",20,0)
 S X=^WV(790.2,PCDTYPE,0)          ;X=0-NODE OF PROC TYPE
"RTN","WVUTL5",21,0)
 S P=$P(X,U,4)                 ;P=PREFIX
"RTN","WVUTL5",22,0)
 S L=$P(X,U,6)                 ;L=LAST ASSIGNED ACCESSION# FOR THIS PROC
"RTN","WVUTL5",23,0)
 S A=$P(L,"-")                 ;A=ACC YEAR
"RTN","WVUTL5",24,0)
 S C=$P(L,"-",2)               ;C=COUNTER
"RTN","WVUTL5",25,0)
 D NOW^%DTC
"RTN","WVUTL5",26,0)
 S N=($E(%I(3),1,3)+1700)      ;N=YEAR NOW: 94
"RTN","WVUTL5",27,0)
 I A'=N S C=0
"RTN","WVUTL5",28,0)
 F  L +^WV(790.2,PCDTYPE,0):1 Q:$T
"RTN","WVUTL5",29,0)
 F  S C=C+1 S R=P_N_"-"_C Q:'$D(^WV(790.1,"B",R))
"RTN","WVUTL5",30,0)
 S $P(^WV(790.2,PCDTYPE,0),U,6)=N_"-"_C
"RTN","WVUTL5",31,0)
 L -^WV(790.2,PCDTYPE,0)
"RTN","WVUTL5",32,0)
 Q R  ;R=RESULT(NEW ACCESSION#)
"RTN","WVUTL5",33,0)
 ;
"RTN","WVUTL5",34,0)
MENUT(TITLE) ;EP
"RTN","WVUTL5",35,0)
 ;---> DISPLAY MENU TITLE FROM WV MENU OPTIONS.
"RTN","WVUTL5",36,0)
 ;---> REQUIRED VARIABLES: TITLE=TEXT TO BE CENTERED AND DISPLAYED.
"RTN","WVUTL5",37,0)
 ;--->                     DUZ(2)=CURRENT LOCATION TO BE DISPLAYED.
"RTN","WVUTL5",38,0)
 N WVTTAB,WVFAC
"RTN","WVUTL5",39,0)
 S:'$D(TITLE) TITLE="* NO TITLE SUPPLIED *"
"RTN","WVUTL5",40,0)
 S TITLE="*  "_TITLE_"  *"
"RTN","WVUTL5",41,0)
 S WVTTAB=39-($L(TITLE)/2)
"RTN","WVUTL5",42,0)
 W @IOF
"RTN","WVUTL5",43,0)
 W !?3,"WOMEN'S HEALTH:"
"RTN","WVUTL5",44,0)
 W ?WVTTAB,TITLE
"RTN","WVUTL5",45,0)
 W ?60,$E($$INSTTX^WVUTL6(DUZ(2)),1,20)
"RTN","WVUTL5",46,0)
 Q
"RTN","WVUTL5",47,0)
 ;
"RTN","WVUTL5",48,0)
TITLE(TITLE) ;EP
"RTN","WVUTL5",49,0)
 ;---> DISPLAY A TITLE.
"RTN","WVUTL5",50,0)
 ;---> REQUIRED VARIABLES: TITLE=TEXT TO BE CENTERED AND DISPLAYED.
"RTN","WVUTL5",51,0)
 N WVTTAB
"RTN","WVUTL5",52,0)
 S:'$D(TITLE) TITLE="* NO TITLE SUPPLIED *"
"RTN","WVUTL5",53,0)
 S TITLE="* * *  WOMEN'S HEALTH: "_TITLE_"  * * *"
"RTN","WVUTL5",54,0)
 S WVTTAB=39-($L(TITLE)/2)
"RTN","WVUTL5",55,0)
 W @IOF
"RTN","WVUTL5",56,0)
 W !?WVTTAB,TITLE,!!
"RTN","WVUTL5",57,0)
 Q
"RTN","WVUTL5",58,0)
 ;
"RTN","WVUTL5",59,0)
CENTERT(TEXT) ;EP
"RTN","WVUTL5",60,0)
 ;---> ADD LEADING SPACES TO CENTER TEXT.
"RTN","WVUTL5",61,0)
 S:'$D(TEXT) TEXT="* NO TEXT SUPPLIED *"
"RTN","WVUTL5",62,0)
 N I
"RTN","WVUTL5",63,0)
 F I=1:1:(39-($L(TEXT)/2)) S TEXT=" "_TEXT
"RTN","WVUTL5",64,0)
 Q
"RTN","WVUTL5",65,0)
 ;
"RTN","WVUTL5",66,0)
UPPER() ;EP
"RTN","WVUTL5",67,0)
 S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","WVUTL5",68,0)
 Q X
"RTN","WVUTL5",69,0)
 ;
"RTN","WVUTL5",70,0)
COPYLET ;EP
"RTN","WVUTL5",71,0)
 ;---> COPY TEXT OF GENERIC SAMPLE LETTER TO ONE OR MORE WV PURPOSES.
"RTN","WVUTL5",72,0)
 ;---> EDIT NEXT LINE TO INCLUDE IENS OF WV PURPOSES TO BE CHANGED.
"RTN","WVUTL5",73,0)
 ;F DA=15,16,18,19 D
"RTN","WVUTL5",74,0)
 S DA=0
"RTN","WVUTL5",75,0)
 F  S DA=$O(^WV(790.404,DA)) Q:'DA  D
"RTN","WVUTL5",76,0)
 .K ^WV(790.404,DA,1)
"RTN","WVUTL5",77,0)
 .S N=0
"RTN","WVUTL5",78,0)
 .F  S N=$O(^WV(790.6,1,1,N)) Q:'N  D
"RTN","WVUTL5",79,0)
 ..S ^WV(790.404,DA,1,N,0)=^WV(790.6,1,1,N,0)
"RTN","WVUTL5",80,0)
 .S ^WV(790.404,DA,1,0)=^WV(790.6,1,1,0)
"RTN","WVUTL5",81,0)
 Q
"RTN","WVUTL5",82,0)
 ;
"RTN","WVUTL5",83,0)
 ;
"RTN","WVUTL5",84,0)
UPXREF(X,WVGBL) ;EP
"RTN","WVUTL5",85,0)
 ;---> SET UPPERCASE XREF FOR X.  CALLED FROM MUMPS XREFS ON MIXED CASE
"RTN","WVUTL5",86,0)
 ;---> FIELDS WHERE AN ALL UPPERCASE LOOKUP IS NEEDED.
"RTN","WVUTL5",87,0)
 ;---> REQUIRED VARIABLES: WVGBL=GLOBAL ROOT OF FILE, X=TEXT TO BE
"RTN","WVUTL5",88,0)
 ;---> CROSSREFERENCED IN ALL UPPERCASE, DA=IEN.
"RTN","WVUTL5",89,0)
 Q:'$D(WVGBL)!('$D(X))
"RTN","WVUTL5",90,0)
 N WVX S WVX=X,X=$$UPPER
"RTN","WVUTL5",91,0)
 S @(WVGBL_"""U"",$E(X,1,30),DA)")=""
"RTN","WVUTL5",92,0)
 S X=WVX K WVGBL
"RTN","WVUTL5",93,0)
 Q
"RTN","WVUTL5",94,0)
 ;
"RTN","WVUTL5",95,0)
KUPXREF(X,WVGBL) ;EP
"RTN","WVUTL5",96,0)
 ;---> KILL UPPERCASE XREF FOR X.  CALLED FROM MUMPS XREFS ON MIXED CASE
"RTN","WVUTL5",97,0)
 ;---> FIELDS WHERE AN ALL UPPERCASE LOOKUP IS NEEDED.
"RTN","WVUTL5",98,0)
 ;---> REQUIRED VARIABLES: WVGBL=GLOBAL ROOT OF FILE, X=TEXT TO BE
"RTN","WVUTL5",99,0)
 ;---> CROSSREFERENCED IN ALL UPPERCASE, DA=IEN.
"RTN","WVUTL5",100,0)
 Q:'$D(WVGBL)!('$D(X))
"RTN","WVUTL5",101,0)
 N WVX S WVX=X,X=$$UPPER
"RTN","WVUTL5",102,0)
 K @(WVGBL_"""U"",$E(X,1,30),DA)")
"RTN","WVUTL5",103,0)
 S X=WVX K WVGBL
"RTN","WVUTL5",104,0)
 Q
"RTN","WVUTL5",105,0)
 ;
"RTN","WVUTL5",106,0)
AGENCY(SITE) ;EP
"RTN","WVUTL5",107,0)
 ;---> RETURN TYPE OF AGENCY ("i"=IHS, "s"=STATE, "v"=VA, ETC.).
"RTN","WVUTL5",108,0)
 ;---> REQUIRED VARIABLE: SITE=DUZ(2)
"RTN","WVUTL5",109,0)
 ;---> IF SITE NOT PASSED OR PARAMETER NOT SET, IT DEFAULTS TO VA.
"RTN","WVUTL5",110,0)
 Q:'$G(SITE) "v"
"RTN","WVUTL5",111,0)
 Q:'$D(^WV(790.02,SITE,0)) "v"
"RTN","WVUTL5",112,0)
 Q $P(^WV(790.02,SITE,0),U,15)
"RTN","WVUTL5",113,0)
 ;
"RTN","WVUTL5",114,0)
PNLAB() ;EP
"RTN","WVUTL5",115,0)
 ;---> RETURN TEXT FOR PATIENT NUMBER: "   SSN: ".
"RTN","WVUTL5",116,0)
 Q "   SSN: "
"RTN","WVUTL5",117,0)
 ;
"RTN","WVUTL5",118,0)
PNLB() ;EP
"RTN","WVUTL5",119,0)
 ;---> RETURN UPPERCASE TEXT FOR PATIENT NUMBER, NO COLON/SPACES.
"RTN","WVUTL5",120,0)
 Q "SSN"
"RTN","WVUTL5",121,0)
 ;
"RTN","WVUTL5",122,0)
SLDT2(DATE) ;EP
"RTN","WVUTL5",123,0)
 ;---> CONVERT FILEMAN INTERNAL DATE TO "SLASH" FORMAT: MM/DD/YY.
"RTN","WVUTL5",124,0)
 ;---> DATE=DATE IN FILEMAN FORMAT.
"RTN","WVUTL5",125,0)
 Q:'$G(DATE) "NO DATE"
"RTN","WVUTL5",126,0)
 S DATE=$P(DATE,".")
"RTN","WVUTL5",127,0)
 Q:$L(DATE)'=7 DATE
"RTN","WVUTL5",128,0)
 Q:'$E(DATE,4,5) $E(DATE,1,3)+1700
"RTN","WVUTL5",129,0)
 Q:'$E(DATE,6,7) $E(DATE,4,5)_"/"_$E(DATE,2,3)
"RTN","WVUTL5",130,0)
 Q $E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","WVUTL5",131,0)
 ;
"RTN","WVUTL5",132,0)
 ;
"RTN","WVUTL5",133,0)
SLDT1(DATE) ;EP
"RTN","WVUTL5",134,0)
 ;---> CONVERT FILEMAN INTERNAL DATE TO "SLASH" FORMAT: MM/DD/YY
"RTN","WVUTL5",135,0)
 ;---> PLUS TIME.
"RTN","WVUTL5",136,0)
 N Y
"RTN","WVUTL5",137,0)
 Q:'$D(DATE) "unknown"
"RTN","WVUTL5",138,0)
 S Y=DATE,DATE=$P(DATE,".")
"RTN","WVUTL5",139,0)
 Q:'DATE "NO DATE"
"RTN","WVUTL5",140,0)
 Q:$L(DATE)'=7 DATE
"RTN","WVUTL5",141,0)
 Q:'$E(DATE,4,5) $E(DATE,1,3)+1700
"RTN","WVUTL5",142,0)
 Q:'$E(DATE,6,7) $E(DATE,4,5)_"/"_$E(DATE,2,3)
"RTN","WVUTL5",143,0)
 D DD^%DT S:Y["@" Y=" @ "_$P($P(Y,"@",2),":",1,2)
"RTN","WVUTL5",144,0)
 Q $E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)_Y
"RTN","WVUTL5",145,0)
 ;
"RTN","WVUTL5",146,0)
TXDT(DATE) ;EP
"RTN","WVUTL5",147,0)
 ;---> CONVERT FILEMAN INTERNAL DATE TO "TEXT" FORMAT: MMM DD,YYYY.
"RTN","WVUTL5",148,0)
 N Y
"RTN","WVUTL5",149,0)
 Q:'$D(DATE) "UNKNOWN"
"RTN","WVUTL5",150,0)
 S Y=DATE D DD^%DT
"RTN","WVUTL5",151,0)
 I Y[", " S Y=$P(Y,", ")_","_$P(Y,", ",2)
"RTN","WVUTL5",152,0)
 I Y["@" S Y=$P(Y,"@")_"  "_$P($P(Y,"@",2),":",1,2)
"RTN","WVUTL5",153,0)
 Q Y
"RTN","WVUTL7")
0^2^B40273960
"RTN","WVUTL7",1,0)
WVUTL7 ;HCIOFO/FT,JR IHS/ANMC/MWR - UTIL: HEADERS & TRAILERS; ;1/25/99  12:39
"RTN","WVUTL7",2,0)
 ;;1.0;WOMEN'S HEALTH;**5**;Sep 30, 1998
"RTN","WVUTL7",3,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVUTL7",4,0)
 ;;  UTILITY: HEADERS AND TRAILERS.
"RTN","WVUTL7",5,0)
 ;
"RTN","WVUTL7",6,0)
S(S) ;EP
"RTN","WVUTL7",7,0)
 ;---> RETURN A VALUE OF SPACES EQUAL IN LENGTH TO THE NUMBER S.
"RTN","WVUTL7",8,0)
 N I,SP S SP=$$REPEAT^XLFSTR(" ",80)
"RTN","WVUTL7",9,0)
 Q $E(SP,1,$G(S))
"RTN","WVUTL7",10,0)
 ;
"RTN","WVUTL7",11,0)
TOPHEAD ;EP
"RTN","WVUTL7",12,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",13,0)
 N X
"RTN","WVUTL7",14,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",15,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",16,0)
 S WVPAGE=1
"RTN","WVUTL7",17,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",18,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",19,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",20,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",21,0)
 Q
"RTN","WVUTL7",22,0)
 ;
"RTN","WVUTL7",23,0)
 ;
"RTN","WVUTL7",24,0)
TOPHEAD1 ;EP
"RTN","WVUTL7",25,0)
 ;---> CODE TO SET VARIABLES FOR HEADER.
"RTN","WVUTL7",26,0)
 N X
"RTN","WVUTL7",27,0)
 D NOW^%DTC S WVNOW=$$SLDT1^WVUTL5(%)
"RTN","WVUTL7",28,0)
 S WVLINE=$$REPEAT^XLFSTR("-",80)
"RTN","WVUTL7",29,0)
 S WVPAGE=$G(WVPAGE)+1
"RTN","WVUTL7",30,0)
 S WVCRT=$S($E(IOST)="C":1,1:0)
"RTN","WVUTL7",31,0)
 S WVCONFF="*********************** CONFIDENTIAL PATIENT INFORMATION "
"RTN","WVUTL7",32,0)
 S WVCONFF=WVCONFF_"***********************"
"RTN","WVUTL7",33,0)
 S WVTIMLN=$E(WVLINE,1,26)_" printed: "_WVNOW_" "_$E(WVLINE,1,27)
"RTN","WVUTL7",34,0)
 Q
"RTN","WVUTL7",35,0)
 ;
"RTN","WVUTL7",36,0)
HEADER1 ;EP
"RTN","WVUTL7",37,0)
 ;---> BROWSE/REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",38,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",39,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",40,0)
 N X
"RTN","WVUTL7",41,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",42,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",43,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",44,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",45,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",46,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",47,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",48,0)
 .I '$D(WVCMGR) W "UNKNOWN" Q
"RTN","WVUTL7",49,0)
 .I WVCMGR="" W "UNKNOWN" Q
"RTN","WVUTL7",50,0)
 .I '$D(^VA(200,WVCMGR,0)) W "UNKNOWN" Q
"RTN","WVUTL7",51,0)
 .W $P(^VA(200,WVCMGR,0),U)
"RTN","WVUTL7",52,0)
 W ?56,"For period: ",$$TXDT^WVUTL5(WVBEGDT)
"RTN","WVUTL7",53,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",54,0)
 W ?64,"To: ",$$TXDT^WVUTL5(WVENDDT)
"RTN","WVUTL7",55,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",56,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",57,0)
 Q
"RTN","WVUTL7",58,0)
 ;
"RTN","WVUTL7",59,0)
 ;
"RTN","WVUTL7",60,0)
HEADER2 ;EP
"RTN","WVUTL7",61,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, MULTIPLE PROCEDURES.
"RTN","WVUTL7",62,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",63,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",64,0)
 N X
"RTN","WVUTL7",65,0)
 D FAC^WVUTL1A
"RTN","WVUTL7",66,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",67,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",68,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",69,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",70,0)
 W !,"Patient Name: ",WVNAMAGE,?52,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",71,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",72,0)
 W ?50,"Facility: ",$E($$INSTTX^WVUTL6(DUZ(2)),1,19)
"RTN","WVUTL7",73,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",74,0)
 W ?47,"Cx Facility: ",$G(WVJCFAC)
"RTN","WVUTL7",75,0)
 W !,"PAP Regimen : ",WVPAPRG
"RTN","WVUTL7",76,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",77,0)
 W ?47,"Br Facility: ",$G(WVJBFAC)
"RTN","WVUTL7",78,0)
 W !,"Pr Provider : ",$G(WVJPCP)
"RTN","WVUTL7",79,0)
 W ?45,"Sexual Trauma: ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",80,0)
 W !,"Hx of BR CA : ",$S($P($G(^WV(790,WVDFN,0)),U,23)]"":$$GET1^DIQ(790,WVDFN,.23,"E"),1:"UNKNOWN")
"RTN","WVUTL7",81,0)
 W ?51,"Veteran: ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",82,0)
 W !,$$REPEAT^XLFSTR("=",49)
"RTN","WVUTL7",83,0)
 W $S(WVEDC]"":WVEDC_"======",1:"===============================")
"RTN","WVUTL7",84,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",85,0)
 Q
"RTN","WVUTL7",86,0)
 ;
"RTN","WVUTL7",87,0)
 ;
"RTN","WVUTL7",88,0)
HEADER3 ;EP
"RTN","WVUTL7",89,0)
 ;---> LAB LOG REPORT HEADER: MULTIPLE PATIENTS, MULTIPLE PROCEDURES.
"RTN","WVUTL7",90,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",91,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",92,0)
 N X
"RTN","WVUTL7",93,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",94,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",95,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",96,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",97,0)
 W !,"Facility: ",$$INSTTX^WVUTL6($S($G(WVFAC):WVFAC,1:DUZ(2)))
"RTN","WVUTL7",98,0)
 W ?53,"From: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",99,0)
 W " to ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",100,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",101,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",102,0)
 Q
"RTN","WVUTL7",103,0)
 ;
"RTN","WVUTL7",104,0)
 ;
"RTN","WVUTL7",105,0)
HEADER4 ;EP
"RTN","WVUTL7",106,0)
 ;---> PATIENT REPORT HEADER: ONE PATIENT, ONE PROCEDURE.
"RTN","WVUTL7",107,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE1,DUZ(2)
"RTN","WVUTL7",108,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",109,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",110,0)
 W WVCONFF W:'WVCRT !,WVTIMLN
"RTN","WVUTL7",111,0)
 W !!,WVTITLE1,?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",112,0)
HEADER41 ;EP
"RTN","WVUTL7",113,0)
 ;---> CALLED BY WVPROC; BYPASSES FORMFEED, TITLE, ETC.
"RTN","WVUTL7",114,0)
 N WVDES
"RTN","WVUTL7",115,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",116,0)
 W !,"Patient Name: ",WVNAMAGE,?53,$$PNLAB^WVUTL5(),WVCHRT
"RTN","WVUTL7",117,0)
 W !,"Case Manager: ",WVCMGR
"RTN","WVUTL7",118,0)
 W ?50,"Procedure: ",$E(WVPN,1,19)
"RTN","WVUTL7",119,0)
 W !,"PAP Regimen : ",WVPAPRG
"RTN","WVUTL7",120,0)
 W ?55,"Acc#: ",WVACCN
"RTN","WVUTL7",121,0)
 W !,"Cx Tx Need  : ",WVCNEED
"RTN","WVUTL7",122,0)
 W ?48,"Cx Facility: ",$$FACIL^WVUTL1A(WVDFN,"C")
"RTN","WVUTL7",123,0)
 W !,"Br Tx Need  : ",WVBNEED
"RTN","WVUTL7",124,0)
 W ?48,"Br Facility: ",$$FACIL^WVUTL1A(WVDFN,"B")
"RTN","WVUTL7",125,0)
 W !,"Sexual Trauma: ",$$MST^WVUTL1A(WVDFN)
"RTN","WVUTL7",126,0)
 W ?52,"Veteran: ",$$VET^WVUTL1A(WVDFN)
"RTN","WVUTL7",127,0)
 S WVDES=$$DES^WVUTL1(WVDFN)
"RTN","WVUTL7",128,0)
 W !,$S(WVDES="YES":"*DES DAUGHTER*",1:"--------------")
"RTN","WVUTL7",129,0)
 W $$REPEAT^XLFSTR("-",37)
"RTN","WVUTL7",130,0)
 W $S(WVEDC]"":WVEDC_"----",1:"-----------------------------")
"RTN","WVUTL7",131,0)
 Q
"RTN","WVUTL7",132,0)
 ;
"RTN","WVUTL7",133,0)
 ;
"RTN","WVUTL7",134,0)
HEADER5 ;EP
"RTN","WVUTL7",135,0)
 ;---> DELINQUENT NEEDS REPORT HEADER: MULTIPLE PATIENTS
"RTN","WVUTL7",136,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVUTL7",137,0)
 ;---> OPTIONAL VARIABLE:  WVCONF (CONFIDENTIAL), WVSUBH (SUBHEADER).
"RTN","WVUTL7",138,0)
 N X
"RTN","WVUTL7",139,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",140,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",141,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",142,0)
 ;W !!,$$RUNDT^WVUTL1A(DT)
"RTN","WVUTL7",143,0)
 W !,"Case Mgr: " D
"RTN","WVUTL7",144,0)
 .I '$D(WVE) W "ALL" Q
"RTN","WVUTL7",145,0)
 .I WVE W "ALL" Q
"RTN","WVUTL7",146,0)
 .I $G(WVCMGR)']"" W "UNKNOWN" Q
"RTN","WVUTL7",147,0)
 .I '$D(^VA(200,WVCMGR,0)) W "UNKNOWN" Q
"RTN","WVUTL7",148,0)
 .W $P(^VA(200,WVCMGR,0),U)
"RTN","WVUTL7",149,0)
 ;W ?46,"Communit" D
"RTN","WVUTL7",150,0)
 ;.I $D(WVCC("ALL")) W "ies: ALL" Q
"RTN","WVUTL7",151,0)
 ;.N I,N S N=0 F I=0:1 S N=$O(WVCC(N)) Q:'N
"RTN","WVUTL7",152,0)
 ;.I I=1 W "y: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,22) Q
"RTN","WVUTL7",153,0)
 ;.W "ies: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,18),",..." Q
"RTN","WVUTL7",154,0)
 S Y=DT D DD^%DT W ?46,"Run Date: ",Y
"RTN","WVUTL7",155,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(WVFAC)
"RTN","WVUTL7",156,0)
 W ?46,"Tx Needs Past Due as of ",$$SLDT2^WVUTL5(WVDDATE)
"RTN","WVUTL7",157,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",158,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",159,0)
 Q
"RTN","WVUTL7",160,0)
 ;
"RTN","WVUTL7",161,0)
 ;
"RTN","WVUTL7",162,0)
HEADER6 ;EP
"RTN","WVUTL7",163,0)
 ;---> PROGRAM SNAPSHOT HEADER: JUST TITLE AND FACILITY (NO PATIENTS)
"RTN","WVUTL7",164,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",165,0)
 N X
"RTN","WVUTL7",166,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",167,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",168,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",169,0)
 W !?3,$$RUNDT^WVUTL1A(DT) I $D(WVJTOY) W ?60,"(",WVJTOY,")"
"RTN","WVUTL7",170,0)
 W !,"   Note: This report includes all facilities"
"RTN","WVUTL7",171,0)
 W " using this database."
"RTN","WVUTL7",172,0)
 ;W " Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",173,0)
 ;W " (This report is not site specific.)"
"RTN","WVUTL7",174,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",175,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",176,0)
 Q
"RTN","WVUTL7",177,0)
 ;
"RTN","WVUTL7",178,0)
 ;
"RTN","WVUTL7",179,0)
HEADER7 ;EP
"RTN","WVUTL7",180,0)
 ;---> AUTOLOAD OF PATIENTS HEADER
"RTN","WVUTL7",181,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",182,0)
 N X
"RTN","WVUTL7",183,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",184,0)
 W:$D(WVCONF) WVCONFF,! W:'WVCRT WVTIMLN,!
"RTN","WVUTL7",185,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE S WVPAGE=WVPAGE+1
"RTN","WVUTL7",186,0)
 W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",187,0)
 W !,"Facility: ",$$INSTTX^WVUTL6(DUZ(2))
"RTN","WVUTL7",188,0)
 W ?64,"Cutoff Age: ",WVAGE
"RTN","WVUTL7",189,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",190,0)
 W !,?3,"NAME",?30,$$PNLB^WVUTL5(),?45,"DOB",?60,"STATUS"
"RTN","WVUTL7",191,0)
 W !,WVLINE
"RTN","WVUTL7",192,0)
 Q
"RTN","WVUTL7",193,0)
 ;
"RTN","WVUTL7",194,0)
 ;
"RTN","WVUTL7",195,0)
HEADER8 ;EP
"RTN","WVUTL7",196,0)
 ;---> SCREENING RATES REPORT HEADER: (NO PATIENTS)
"RTN","WVUTL7",197,0)
 ;---> REQUIRED VARIABLES: WVCRT,WVTITLE,DUZ(2)
"RTN","WVUTL7",198,0)
 N X
"RTN","WVUTL7",199,0)
 W:WVPAGE>1!WVCRT @IOF,!
"RTN","WVUTL7",200,0)
 W:'WVCRT !,WVTIMLN,!
"RTN","WVUTL7",201,0)
 W !,WVTITLE W:'WVCRT ?70,"page: ",WVPAGE
"RTN","WVUTL7",202,0)
 ;W !!,$$RUNDT^WVUTL1A("C")
"RTN","WVUTL7",203,0)
 W !!?4,"For Age Range: ",$S(WVAGRG=1:"ALL",1:WVAGRG)
"RTN","WVUTL7",204,0)
 W ?56,"For period: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVUTL7",205,0)
 ;W !?4,"Communit" D
"RTN","WVUTL7",206,0)
 ;.I $D(WVCC("ALL")) W "ies: ALL" Q
"RTN","WVUTL7",207,0)
 ;.N I,N S N=0 F I=0:1 S N=$O(WVCC(N)) Q:'N
"RTN","WVUTL7",208,0)
 ;.I I=1 W "y: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,22) Q
"RTN","WVUTL7",209,0)
 ;.W "ies: ",$E($P(^AUTTCOM($O(WVCC(N)),0),U),1,18),",..." Q
"RTN","WVUTL7",210,0)
 S Y=DT D DD^%DT W !?4,"Run Date: ",Y
"RTN","WVUTL7",211,0)
 W ?64,"To: ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVUTL7",212,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVUTL7",213,0)
 W !?4,"(Note: This report includes all facilities"
"RTN","WVUTL7",214,0)
 W " using this database.)",!
"RTN","WVUTL7",215,0)
 ;I $D(WVSUBH) D @WVSUBH
"RTN","WVUTL7",216,0)
 Q
"RTN","WVUTL7",217,0)
 ;
"RTN","WVUTL7",218,0)
ENDREP(X) ;EP
"RTN","WVUTL7",219,0)
 ;---> END A REPORT, DO FORMFEED OR "Press <Return>" IF NECESSARY.
"RTN","WVUTL7",220,0)
 ;---> REQUIRED VARIABLES: WVCRT=1 IF OUTPUT TO SCREEN
"RTN","WVUTL7",221,0)
 ;--->                     WVPOP=1 IF ESCAPING
"RTN","WVUTL7",222,0)
 ;---> OPTIONAL VARIABLE:  X=1 IF "End of Report" SHOULD NOT DISPLAY.
"RTN","WVUTL7",223,0)
 ;
"RTN","WVUTL7",224,0)
 S WVTITLE="-----  End of Report  -----"
"RTN","WVUTL7",225,0)
 I '$G(X)&('WVPOP) D CENTERT^WVUTL5(.WVTITLE) W !,WVTITLE
"RTN","WVUTL7",226,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 W @IOF,!
"RTN","WVUTL7",227,0)
 D ^%ZISC
"RTN","WVUTL7",228,0)
 Q
"VER")
8.0^21.0
"^DD",790.5,790.5,0)
FIELD^^.01^1
"^DD",790.5,790.5,0,"IX","B",790.5,.01)

"^DD",790.5,790.5,0,"IX","U",790.5,.01)

"^DD",790.5,790.5,0,"NM","WV CERVICAL TX NEED")

"^DD",790.5,790.5,0,"PT",790,.11)

"^DD",790.5,790.5,0,"VRPK")
WOMEN'S HEALTH
"^DD",790.5,790.5,.01,0)
CERVICAL TX NEED^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<3)!'(X'?1P.E) X
"^DD",790.5,790.5,.01,1,0)
^.1
"^DD",790.5,790.5,.01,1,1,0)
790.5^B
"^DD",790.5,790.5,.01,1,1,1)
S ^WV(790.5,"B",$E(X,1,30),DA)=""
"^DD",790.5,790.5,.01,1,1,2)
K ^WV(790.5,"B",$E(X,1,30),DA)
"^DD",790.5,790.5,.01,1,2,0)
790.5^U^MUMPS
"^DD",790.5,790.5,.01,1,2,1)
D UPXREF^WVUTL5(X,"^WV(790.5,")
"^DD",790.5,790.5,.01,1,2,2)
D KUPXREF^WVUTL5(X,"^WV(790.5,")
"^DD",790.5,790.5,.01,1,2,"%D",0)
^^1^1^2960308^
"^DD",790.5,790.5,.01,1,2,"%D",1,0)
Sets uppercase xref.
"^DD",790.5,790.5,.01,1,2,"DT")
2960308
"^DD",790.5,790.5,.01,3)
Answer must be 3-20 characters in length.
"^DD",790.5,790.5,.01,21,0)
^^3^3^2980630^
"^DD",790.5,790.5,.01,21,1,0)
This field stores the name or terms used to describe cervical treatment
"^DD",790.5,790.5,.01,21,2,0)
needs such as tests, therapeutic procedures, and referrals to another
"^DD",790.5,790.5,.01,21,3,0)
agency.
"^DD",790.5,790.5,.01,"DT")
2960308
"^DIC",790.5,790.5,0)
WV CERVICAL TX NEED^790.5
"^DIC",790.5,790.5,0,"GL")
^WV(790.5,
"^DIC",790.5,790.5,"%D",0)
^^5^5^2980630^
"^DIC",790.5,790.5,"%D",1,0)
This file contains a list of terms/phrases used to describe the cervial
"^DIC",790.5,790.5,"%D",2,0)
treatment needs of women patients.  Entries may be tests, therapeutic
"^DIC",790.5,790.5,"%D",3,0)
procedures, or other actions (e.g., referral to another
"^DIC",790.5,790.5,"%D",4,0)
facility, chart review).  There is no option to edit this file; new
"^DIC",790.5,790.5,"%D",5,0)
entries may be added through FileMan.
"^DIC",790.5,"B","WV CERVICAL TX NEED",790.5)

**END**
**END**
