Released DVB*4*56 SEQ #54
Extracted from mail message
**KIDS**:DVB*4.0*56^

**INSTALL NAME**
DVB*4.0*56
"BLD",5963,0)
DVB*4.0*56^HINQ^0^3060807^y
"BLD",5963,4,0)
^9.64PA^^
"BLD",5963,6)
8^
"BLD",5963,"ABNS",0)
^9.66A^1^1
"BLD",5963,"ABNS",1,0)
DVB
"BLD",5963,"ABNS",1,1,0)
^9.661A^^
"BLD",5963,"ABNS","B","DVB",1)

"BLD",5963,"ABPKG")
y^n
"BLD",5963,"KRN",0)
^9.67PA^8989.52^19
"BLD",5963,"KRN",.4,0)
.4
"BLD",5963,"KRN",.401,0)
.401
"BLD",5963,"KRN",.402,0)
.402
"BLD",5963,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",5963,"KRN",.402,"NM",1,0)
DVBHINQ UPDATE    FILE #2^2^0
"BLD",5963,"KRN",.402,"NM","B","DVBHINQ UPDATE    FILE #2",1)

"BLD",5963,"KRN",.403,0)
.403
"BLD",5963,"KRN",.5,0)
.5
"BLD",5963,"KRN",.84,0)
.84
"BLD",5963,"KRN",3.6,0)
3.6
"BLD",5963,"KRN",3.8,0)
3.8
"BLD",5963,"KRN",9.2,0)
9.2
"BLD",5963,"KRN",9.8,0)
9.8
"BLD",5963,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5963,"KRN",9.8,"NM",1,0)
DVBHQD1^^0^B77965596
"BLD",5963,"KRN",9.8,"NM",2,0)
DVBHQUP^^0^B37378101
"BLD",5963,"KRN",9.8,"NM",3,0)
DVBHS2^^0^B10150900
"BLD",5963,"KRN",9.8,"NM",4,0)
DVBHT^^0^B27405943
"BLD",5963,"KRN",9.8,"NM","B","DVBHQD1",1)

"BLD",5963,"KRN",9.8,"NM","B","DVBHQUP",2)

"BLD",5963,"KRN",9.8,"NM","B","DVBHS2",3)

"BLD",5963,"KRN",9.8,"NM","B","DVBHT",4)

"BLD",5963,"KRN",19,0)
19
"BLD",5963,"KRN",19.1,0)
19.1
"BLD",5963,"KRN",101,0)
101
"BLD",5963,"KRN",409.61,0)
409.61
"BLD",5963,"KRN",771,0)
771
"BLD",5963,"KRN",870,0)
870
"BLD",5963,"KRN",8989.51,0)
8989.51
"BLD",5963,"KRN",8989.52,0)
8989.52
"BLD",5963,"KRN",8994,0)
8994
"BLD",5963,"KRN","B",.4,.4)

"BLD",5963,"KRN","B",.401,.401)

"BLD",5963,"KRN","B",.402,.402)

"BLD",5963,"KRN","B",.403,.403)

"BLD",5963,"KRN","B",.5,.5)

"BLD",5963,"KRN","B",.84,.84)

"BLD",5963,"KRN","B",3.6,3.6)

"BLD",5963,"KRN","B",3.8,3.8)

"BLD",5963,"KRN","B",9.2,9.2)

"BLD",5963,"KRN","B",9.8,9.8)

"BLD",5963,"KRN","B",19,19)

"BLD",5963,"KRN","B",19.1,19.1)

"BLD",5963,"KRN","B",101,101)

"BLD",5963,"KRN","B",409.61,409.61)

"BLD",5963,"KRN","B",771,771)

"BLD",5963,"KRN","B",870,870)

"BLD",5963,"KRN","B",8989.51,8989.51)

"BLD",5963,"KRN","B",8989.52,8989.52)

"BLD",5963,"KRN","B",8994,8994)

"BLD",5963,"QUES",0)
^9.62^^
"BLD",5963,"REQB",0)
^9.611^1^1
"BLD",5963,"REQB",1,0)
DVB*4.0*57^2
"BLD",5963,"REQB","B","DVB*4.0*57",1)

"KRN",.402,651,-1)
0^1
"KRN",.402,651,0)
DVBHINQ UPDATE^3060308.0827^^2^^^3060802
"KRN",.402,651,"AR",2,303)
1^DVBHCE34
"KRN",.402,651,"AR",2,634)
2^DVBHCE34
"KRN",.402,651,"AR",2,635)
3^DVBHCE34
"KRN",.402,651,"AR",2,636)
4^DVBHCE34
"KRN",.402,651,"DIAB",1,0,2,7)
.32945;Service NNTL Episode
"KRN",.402,651,"DIAB",1,0,2,9)
.306//"TODAY"
"KRN",.402,651,"DIAB",2,0,2,4)
SERVICE ENTRY DATE [NTL];"NTL-EOD"
"KRN",.402,651,"DIAB",3,0,2,1)
SERVICE ENTRY DATE [LAST];"L-EOD"
"KRN",.402,651,"DIAB",3,0,2,3)
.3285;Service NTL Episode
"KRN",.402,651,"DIAB",3,0,2,4)
SERVICE SEPARATION DATE [NTL];"NTL-RAD"
"KRN",.402,651,"DIAB",3,0,2,7)
SERVICE ENTRY DATE [NNTL];"NNTL-EOD"
"KRN",.402,651,"DIAB",4,0,2,1)
SERVICE SEPARATION DATE [LAST];"L-RAD";C15
"KRN",.402,651,"DIAB",4,0,2,4)
SERVICE BRANCH [NTL];"NTL-Bran. Ser."
"KRN",.402,651,"DIAB",4,0,2,7)
SERVICE SEPARATION DATE [NNTL];"NNTL-RAD"
"KRN",.402,651,"DIAB",5,0,2,1)
SERVICE BRANCH [LAST];L-Bran.. Ser.
"KRN",.402,651,"DIAB",5,0,2,4)
SERVICE DISCHARGE TYPE [NTL];"NTL-Char. Ser."
"KRN",.402,651,"DIAB",5,0,2,7)
SERVICE BRANCH [NNTL];"NNTL-Bran. Ser."
"KRN",.402,651,"DIAB",6,0,2,4)
SERVICE NUMBER [NTL];"NTL-Ser. Num."
"KRN",.402,651,"DIAB",6,0,2,7)
SERVICE DISCHARGE TYPE [NNTL];"NNTL-Char. Ser."
"KRN",.402,651,"DIAB",7,0,2,1)
SERVICE DISCHARGE TYPE [LAST];L-Char. Ser.
"KRN",.402,651,"DIAB",7,0,2,7)
SERVICE NUMBER [NNTL];"NNTL-Ser. Num."
"KRN",.402,651,"DIAB",8,0,2,1)
SERVICE NUMBER [LAST];L-Ser. Num.
"KRN",.402,651,"DIAB",13,0,2,8)
.3612//"TODAY"
"KRN",.402,651,"DR",1,2)
@101;W @$S('$D(IOF):"#",IOF="":"#",1:IOF),! K ^UTILITY($J) D ^DVBHSVER;@7;D Q^DVBHUTIL;S DIE("NO^")="";@1001;D ^DVBHS1 S Y="@5";@1;D ^DVBHS2 S Y="@5" W !;@2;D ^DVBHS3 S Y="@5";@3;D ^DVBHS4 S Y="@5";@1006;@30;I Z2'[1 S Y="@32";
"KRN",.402,651,"DR",1,2,1)
S DVBSCR=1 D ^DVBHS4 W !,?34,DVBON,"[LAST]",DVBOFF X DVBLIT1;S DVBJC=$S('$D(^DPT(DFN,.32)):"",1:$P(^(0),U,5));.326L-EOD~;.327C15~L-RAD~;.325L-Bran.. Ser.~;I X'=DVBJC S DVBJ2=1;.324L-Char. Ser.~;.328L-Ser. Num.~;@32;
"KRN",.402,651,"DR",1,2,2)
I Z2'[2 S Y="@31";I '$D(^DPT(D0,.32)) W !!,*7,?17,DVBON,"No Last episode can't edit NTLast   <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";
"KRN",.402,651,"DR",1,2,3)
I $P(^DPT(D0,.32),U,6)="" W !!,*7,?17,DVBON,"No last episode can't edit NTLast   <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";S DVBSCR=1 D ^DVBHS4 W !,?34,DVBON,"[NTLAST]",DVBOFF X DVBLIT1;.3285Service NTL Episode~;
"KRN",.402,651,"DR",1,2,4)
I $P(^DPT(D0,.32),U,19)'="Y" S Y="@31";.3292NTL-EOD~;.3293NTL-RAD~;.3291NTL-Bran. Ser.~;.329NTL-Char. Ser.~;.3294NTL-Ser. Num.~;@31;I Z2'[3 S Y="@33";
"KRN",.402,651,"DR",1,2,5)
I '$D(^DPT(D0,.32)) W !!,*7,?17,DVBON,"No NTLast episode can't edit NNTLast   <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";
"KRN",.402,651,"DR",1,2,6)
I $P(^DPT(D0,.32),U,19)'="Y" W !!,*7,?17,DVBON,"No NTLast episode can't edit NNTLast   <RET>.",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";S DVBSCR=1 D ^DVBHS4 W !,?34,DVBON,"[NNTLAST]",DVBOFF X DVBLIT1;
"KRN",.402,651,"DR",1,2,7)
.32945Service NNTL Episode~;I $P(^DPT(D0,.32),U,20)'="Y" S Y="@33";.3297NNTL-EOD~;.3298NNTL-RAD~;.3296NNTL-Bran. Ser.~;.3295NNTL-Char. Ser.~;.3299NNTL-Ser. Num.~;@33;I Z2'[4 S Y="@3";S DVBSCR=1 D ^DVBHS4;
"KRN",.402,651,"DR",1,2,8)
S DVBJC2=$S($D(^DPT(D0,.32)):$P(^(.32),U,3),1:"");.323;I X'=DVBJC2 S DVBJ2=1;K DVBJC2;S Y="@3";@104;D ^DVBHS5 S Y="@5" K DXS;@204;I Z2'[1 S Y="@205";S DVBSCR=1 D ^DVBHS5 S DVBJ2=1;.3611;Q;.3612//^S X="TODAY";.3615//^S X="HINQ";Q;
"KRN",.402,651,"DR",1,2,9)
.306//^S X="TODAY";361;@205;I Z2'[2 S Y="@206";S DVBSCR=1 D ^DVBHS5 S DVBJ2=1;391;1901;.301;I X="N" S Y="@2063";@2063;.361;@206;I Z2'[3 S Y="@104";S DVBSCR=1 D ^DVBHS5 S DVBJ2=1;.36205;.36215;.36235;.3025;.36295;@2062;S Y="@104";
"KRN",.402,651,"DR",1,2,10)
@11;S DVBJ2=1;.111;.112;.113;.114;.115;.1112;.117;S Y="@1001";@5;D SCRQ^DVBHUTIL;@6;D B^DVBHQEDT R AA:DTIME K AA S Y=$S(DVBJS=11:"@1001",DVBJS=28:"@1",DVBJS=35:"@2",DVBJS=44:"@3",DVBJS=53:"@104",1:"@10");@8;
"KRN",.402,651,"DR",1,2,11)
S Y=$S(ANS="^0":"@101",ANS="^1":"@1001",ANS="^2":"@1",ANS="^3":"@2",ANS="^4":"@3",ANS="^5":"@104",1:Y) I Y["@" W @$S('$D(IOF):"#",IOF="":"#",1:IOF);
"KRN",.402,651,"DR",1,2,12)
D A^DVBHQEDT S Z2=Z I ERROR K ERROR S Y=$S(DVBJS=11:"@1001",DVBJS=28:"@1",DVBJS=35:"@2",DVBJS=44:"@3",DVBJS=53:"@104",1:"@10");@20;S JP=1,Y=$S(DVBJS=11:"@11",DVBJS=35:"@40",DVBJS=44:"@30",DVBJS=53:"@204",1:Y);@21;
"KRN",.402,651,"DR",1,2,13)
I $P(Z2,U,JP)'=1 S Y="@22";I '$D(DVBCN) S Y="@22",JP=JP+1;I 'DVBCN S Y="@22",JP=JP+1;S DVBCN=$TR(DVBCN," ");
"KRN",.402,651,"DR",1,2,14)
I $L(DVBCN)=9,(DVBCN?9N),(DVBCN'=$P(^DPT(D0,0),U,9)) W !!,*7,"HINQ claim # is a SSN, does not match patient file SSN  NO UPDATING claim #" R !,?25,"<RET to continue>",DVBQ:DTIME K DVBQ S Y="@22",JP=JP+1;.313///^S X=DVBCN;
"KRN",.402,651,"DR",1,2,15)
W "." S JP=JP+1,DVBJ2=1;@22;I $P(Z2,U,JP)'=2 S Y="@225";W !,"Date of Birth cannot be edited with this option.";H 1;W "." S JP=JP+1,DVBJ2=1;@225;I $P(Z2,U,JP)'=3 S Y="@23";W !,"Sex cannot be edited with this option.";H 1;
"KRN",.402,651,"DR",1,2,16)
W "." S JP=JP+1,DVBJ2=1;@23;I $P(Z2,U,JP)'=4 S Y="@24";K Z1 I $D(DVBP(6)),+$P(DVBP(6),U) S Z1=$P(DVBP(6),U),Z1=$E(Z1,1,2)_" "_$E(Z1,3,4)_" "_$E(Z1,5,8);
"KRN",.402,651,"DR",1,2,17)
I $D(DVBVET),$P(DVBVET,U,1)="B",+$P(DVBVET,U,12) S Z1=$P(DVBVET,U,12),Z1=$E(Z1,5,6)_" "_$E(Z1,7,8)_" "_$E(Z1,1,4);I '$D(Z1) S Y="@24",JP=JP+1;I 'Z1 S Y="@24",JP=JP+1;
"KRN",.402,651,"DR",1,2,18)
I $D(^DPT(D0,.105)) W !!,"Patient is currently in-house." W !,"Discharge patient with a discharge type of DEATH." R !,?25,"<RET to continue>",DVBQ:DTIME K DVBQ S Y="@24",JP=JP+1;.351///^S X=Z1;W "." S JP=JP+1,DVBJ2=1;@24;
"KRN",.402,651,"DR",1,2,19)
I $P(Z2,U,JP)'=5 S Y="@25";K DVBSICK I $D(DVBP(6)) S DVBSICK=$P(DVBP(6),U,7);I $D(DVBCI) S DVBSICK=DVBCI;I '$D(DVBSICK) S Y="@25",JP=JP+1;.293///^S X=$S((DVBSICK="I")!(DVBSICK="Y"):1,1:0);W "." S JP=JP+1,DVBJ2=1 K DVBSICK;@25;
"KRN",.402,651,"DR",1,2,20)
I $P(Z2,U,JP)'=6 S Y="@26";I '$D(DVBPOW),'$D(DVBPOWD) S Y="@26",JP=JP+1;I '$D(DVBPOW),$D(DVBPOWD),+DVBPOWD W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";
"KRN",.402,651,"DR",1,2,21)
I '$D(DVBPOW),'+DVBPOWD S Y="@26",JP=JP+1;I '$D(DVBPOWD),$D(DVBPOW),DVBPOW>0 W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";
"KRN",.402,651,"DR",1,2,22)
I $D(DVBPOWD),$D(DVBPOW),DVBPOWD=0,DVBPOW>0 W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";
"KRN",.402,651,"DR",1,2,23)
I $D(DVBPOWD),$D(DVBPOW),+DVBPOW<1,+DVBPOWD W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";D POW^DVBHUTIL;.525///^S X=DVBPOW1;K DVBPOW1 W "." S JP=JP+1,DVBJ2=1;@26;
"KRN",.402,651,"DR",1,2,24)
I $P(Z2,U,JP)'=7 S Y="@27";I '$D(DVBFL) S Y="@27",JP=JP+1;I DVBFL']"" S Y="@27",JP=JP+1;I DVBFL'?3N1" - "1U.E S Y="@27",JP=JP+1;.314///^S X=+DVBFL;W "." S JP=JP+1,DVBJ2=1;@27;I $P(Z2,U,JP)'=8 S Y="@50";
"KRN",.402,651,"DR",1,2,25)
I '$D(DVBEI) S Y="@50",JP=JP+1;.305///^S X=$S(DVBEI="Y":"Y",1:"N");W "." S JP=JP+1,DVBJ2=1;S Y="@50";@40;I $P(Z2,U,JP)'=1 S Y="@42";I '$D(DVBP(6)) S Y="@42",JP=JP+1;
"KRN",.402,651,"DR",1,2,26)
I $S($P(DVBP(6),U,8)'="Y":1,'$D(^DPT(DFN,.32)):1,+$P(^(0),U,2):1,1:0) S Y="@42",JP=JP+1;.322///^S X="T";W "." S JP=JP+1,DVBJ2=1;@42;I $P(Z2,U,JP)'=2 S Y="@45";I '$D(DVBP(6)) S Y="@45",JP=JP+1;
"KRN",.402,651,"DR",1,2,27)
I $P(DVBP(6),U,4)[" " S Y="@45",JP=JP+1;.32101///^S X=$P(DVBP(6),U,4);W "." S JP=JP+1,DVBJ2=1;@45;I $P(Z2,U,JP)'=3!('$D(DVBDX(1))) S Y="@50";S:'$D(DVBFL) DVBFL="UNKNOWN";
"KRN",.402,651,"DR",1,2,28)
I $D(DVBCAP),DVBCAP["No C&P",$P(DVBBIR,U,5)'="Y" D CHK^DVBHUTIL;@47;
"KRN",.402,651,"DR",1,2,29)
S DVB4=$S($D(^DPT(DFN,.3))>0:$P(^(.3),U),1:0),DVB5=$S($D(^DPT(DFN,.36))>0:$P(^(.36),U),1:0),DVB6=$S($D(^DPT(DFN,"VET"))>0:^("VET"),1:0),DVB7=$S($D(^DPT(DFN,"TYPE"))>0:^("TYPE"),1:0);
"KRN",.402,651,"DR",1,2,30)
S DVB8=$O(^DIC(8,"B","SERVICE CONNECTED 50% to 100%",0)),DVB9=$O(^DIC(8,"B","SC LESS THAN 50%",0));I DVBDXNO I ((DVB8'=DVB5&(DVB9'=DVB5))!(DVB4'="Y")!(DVB6'="Y")!(DVB7'=1)) S Y="@70";
"KRN",.402,651,"DR",1,2,31)
W ! K ^DPT(DFN,.372),JP4,JP6 S ^DPT(DFN,.372,0)="^2.04P^^0",JP=0;S $P(^DPT(DFN,.3),U,2)="",$P(^DPT(DFN,.3),U,14)="";.302///^S X=+$G(DVBDXPCT);.3014///^S X=$G(DVBEFF);@46;S JP=$O(DVBDX(JP)) I 'JP S Y="@50";
"KRN",.402,651,"DR",1,2,32)
S JPP=+$P(DVBDX(JP),U,2) I JPP'>0 S Y="@46";I '$D(^DIC(31,JPP)) D CHKDIS^DVBHS3 S Y="@46";.3721///^S X="""`"_$P(DVBDX(JP),U,2)_"""";W "." S DVBJ2=1;S Y="@46";@61;S Y="@4";I Z2'[1 S Y="@62";I '$D(DVBSSA) S Y="@62",JP=JP+1;
"KRN",.402,651,"DR",1,2,33)
I DVBSSA S DVBYN="Y",DVBXYN=DVBSSA;I 'DVBSSA S DVBYN="N",DVBXYN="";.36225///^S X=DVBYN;W "." S JP=JP+1,DVBJ2=1 K DVBYN,DVBXYN;@62;I Z2'[2 S Y="@63";I '$D(DVBRETT) S Y="@63",JP=JP+1;
"KRN",.402,651,"DR",1,2,34)
I DVBRETT=""!("BMCROX"'[DVBRETT) S Y="@63",JP=JP+1;.36285///^S X=DVBRETT;W "." S JP=JP+1,DVBJ2=1;@63;I Z2'[3 S Y="@64";I '$D(DVBRETO) S Y="@64",JP=JP+1;S X=DVBRETO I X=""!(X=0) S X="@";.3628///^S X=X;W "." S JP=JP+1,DVBJ2=1;@64;
"KRN",.402,651,"DR",1,2,35)
I Z2'[4 S Y="@1006";I '$D(DVBOINC) S Y="@1006",JP=JP+1;S X=DVBOINC I X=""!(X=0) S X="@";.3629///^S X=X;W "." S JP=JP+1,DVBJ2=1,Y="@1006";@4;S Y=$S(DVBJS=11:"@1",DVBJS=28:"@2",DVBJS=35:"@3",DVBJS=44:"@104",1:"@10");@70;
"KRN",.402,651,"DR",1,2,36)
W !!,*7,"HINQ contains SC disabilities, Patient is NSC no updating allowed.  Check       patient's SERVICE CONNECTION, ELIGIBILITY CODE, VET STATUS, or PATIENT TYPE.     Screen 5 contains this.";
"KRN",.402,651,"DR",1,2,37)
R !!,?25,"<RET> to continue.",ZZ:DTIME K ZZ,JP3,JP4;@50;K DVBJX,JP,JPP S Y=$S(DVBJS=28:"@1",DVBJS=35:"@2",1:"@10");@10;I $G(DVBRADL)]"" D DX^DVBHQEDT(DVBRADL);K DVBRADL;
"KRN",.402,651,"DR",2,2.0361)
.01;
"KRN",.402,651,"DR",2,2.04)
2///^S X=$S($P(DVBDX(JP),U,3)="X0":100,1:+$P(DVBDX(JP),U,3));3///^S X=1;4///^S X=$P($G(DVBDX(JP)),U,4);5///^S X=$P($G(DVBDX(JP)),U,5);6///^S X=$P($G(DVBDX(JP)),U,6);
"KRN",.402,651,"ROU")
^DVBHCE
"KRN",.402,651,"ROUOLD")
DVBHCE
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",119,-1)
1^1
"PKG",119,0)
HINQ^DVB^HINQ(Hospital Inquiry)
"PKG",119,20,0)
^9.402P^^
"PKG",119,22,0)
^9.49I^1^1
"PKG",119,22,1,0)
4.0^2920325^3030902
"PKG",119,22,1,"PAH",1,0)
56^3060807^83
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","DVBHQD1")
0^1^B77965596^B24138320
"RTN","DVBHQD1",1,0)
DVBHQD1 ;ISC-ALBANY/PKE/PHH- HINQ receiver ; 5/15/06 10:58am
"RTN","DVBHQD1",2,0)
 ;;4.0;HINQ;**3,12,16,22,23,32,34,40,46,49,57,56**; 03/25/92 
"RTN","DVBHQD1",3,0)
 ;
"RTN","DVBHQD1",4,0)
 S:'$D(DTIME) DTIME=300 S DVBTIME=DTIME
"RTN","DVBHQD1",5,0)
EN S:$G(IO(0))="" IO(0)=$I S (C,DVBTSK,DVBABORT)=0,DVBXM=1,DTIME=30 U IO(0)
"RTN","DVBHQD1",6,0)
 ;
"RTN","DVBHQD1",7,0)
SEL S (DVBRTC,DVBTRY)=1,DVBNRT="Y"
"RTN","DVBHQD1",8,0)
 R !!," Select Input: (P)atient File, or (D)irect  P//",X:DTIME I '$T!(X["^") G HINQ
"RTN","DVBHQD1",9,0)
 I "Pp"[$E(X) S DVBPRGM="TM^DVBHIQD" G ASK
"RTN","DVBHQD1",10,0)
 I "Dd"[$E(X_1) S DVBPRGM="EN^DVBHQDE" G ASK
"RTN","DVBHQD1",11,0)
 I X["?" D HP^DVBHQAT G SEL
"RTN","DVBHQD1",12,0)
 G SEL
"RTN","DVBHQD1",13,0)
ASK S:$G(IO(0))="" IO(0)=$I W ! S Y=0,DVBIO=IO D @DVBPRGM
"RTN","DVBHQD1",14,0)
ASK1 I Y'<0,$D(DVBP),$L(DVBP)=4 S IO=DVBIO D STUFF^DVBHQAT:$D(DFN),MES
"RTN","DVBHQD1",15,0)
 I $D(DVBMISS) K DVBMISS D:DVBTRY>3 RETRY^DVBHQD2 G:DVBNRT="N" LOAD2^DVBHQD2 I DVBTRY<4&(DVBRTC<4) S DVBTRY=DVBTRY+1 U IO(0) W ?35,"Retrying Request." G ASK1
"RTN","DVBHQD1",16,0)
 S IO=DVBIO U IO(0) K DVBP S DVBABORT=0
"RTN","DVBHQD1",17,0)
 I '$D(Y) G ASK
"RTN","DVBHQD1",18,0)
 I Y>0 G ASK
"RTN","DVBHQD1",19,0)
 ;
"RTN","DVBHQD1",20,0)
HINQ U IO(0) W !!,"Do you wish to continue" S %=2 D YN^DICN G:'% HINQ I %=1 W ! G EN
"RTN","DVBHQD1",21,0)
EX S DTIME=$S($D(DVBTIME):DVBTIME,1:300)
"RTN","DVBHQD1",22,0)
 Q
"RTN","DVBHQD1",23,0)
MES ;
"RTN","DVBHQD1",24,0)
 S:$G(IO(0))="" IO(0)=$I S E=$L(DVBZ) I '$D(DVBDXX),($E(DVBZ,E-7,E-4)'=DVBNUM) S DVBZ=$E(DVBZ,1,E-4)_DVBNUM_$E(DVBZ,E-3,999)
"RTN","DVBHQD1",25,0)
 K E H 1 S DVBEND="NNNN" S:'$D(DVBXM) DVBXM=0 S:'$D(C) C=0
"RTN","DVBHQD1",26,0)
 ;
"RTN","DVBHQD1",27,0)
TOTIMS S TRY=0,CN=$F(DVBZ,"/CN",24),DVBZ0=DVBZ
"RTN","DVBHQD1",28,0)
 I $S('$D(DFN):1,DFN:0,1:1) S CN=0 D SEND^DVBHQD2,KTO^DVBHQD2 Q
"RTN","DVBHQD1",29,0)
 I 'CN D CNLKUP^DVBHQAT
"RTN","DVBHQD1",30,0)
 DO  D SEND^DVBHQD2 I TRY DO  I TRY H 1 D SEND^DVBHQD2
"RTN","DVBHQD1",31,0)
 .I CN,'TRY S DVBZ0=$E(DVBZ,1,23)_$E(DVBZ,24,CN-3)_$E(DVBZ,CN+9,999) Q
"RTN","DVBHQD1",32,0)
 .I CN,TRY S DVBZ1=$E(DVBZ,1,23)_$E(DVBZ,CN-2,999) Q
"RTN","DVBHQD1",33,0)
 .I 'CN S DVBZ0=DVBZ,TRY=0 Q
"RTN","DVBHQD1",34,0)
 I $D(DVBMISS)&($D(DVBPRGM)) I (DVBPRGM["TM") K DVBMISS D:DVBTRY>3 RETRY^DVBHQD2 G:DVBNRT="N" LOAD^DVBHQD2 I DVBTRY<4&(DVBRTC<4) S DVBTRY=DVBTRY+1 U IO(0) W ?35,"Retrying Request." G MES
"RTN","DVBHQD1",35,0)
 G KTO^DVBHQD2
"RTN","DVBHQD1",36,0)
 ;
"RTN","DVBHQD1",37,0)
 ;z1 is first x(),z9 is last x()
"RTN","DVBHQD1",38,0)
OK ;I 'DVBTSK DO
"RTN","DVBHQD1",39,0)
 ;. U IO(0) W !!?3 S Z1=0 F  S Z1=$O(X(Z1)) Q:'Z1  S LX=$G(LX)+$L(X(Z1)) W Z1," ",$L(X(Z1)),"   "
"RTN","DVBHQD1",40,0)
 ;. W !?9,LX,! K LX H 3 U IO
"RTN","DVBHQD1",41,0)
 S:$G(IO(0))="" IO(0)=$I S Z1=$O(X(0)) F  Q:$E(X(Z1))'=$C(10)  S X(Z1)=$E(X(Z1),2,999)
"RTN","DVBHQD1",42,0)
 I $G(X(Z1))["HINQ" S X(Z1)="HINQ"_$P(X(Z1),"HINQ",2)
"RTN","DVBHQD1",43,0)
 E  K X(Z1) DO
"RTN","DVBHQD1",44,0)
 . S Z1=$O(X(0)) I Z1="" S Z1=0,X(0)=""
"RTN","DVBHQD1",45,0)
 . I $G(X(Z1))["HINQ" S X(Z1)="HINQ"_$P(X(Z1),"HINQ",2)
"RTN","DVBHQD1",46,0)
 I $L(X(Z1))>25 S DVBLEN=+$E(X(Z1),22,25)
"RTN","DVBHQD1",47,0)
 I $L(X(Z1))'>25 D
"RTN","DVBHQD1",48,0)
 . I $D(X(Z1+1)) DO
"RTN","DVBHQD1",49,0)
 . . S DVBLEN=+$E($E(X(Z1),1,99)_$E(X(Z1+1),1,30),22,25)
"RTN","DVBHQD1",50,0)
 . I '$D(X(Z1+1)) D
"RTN","DVBHQD1",51,0)
 . . S DVBLEN=$L(X(Z1)) ;DVB*4*49 - error response may be < 25 chars
"RTN","DVBHQD1",52,0)
 I '$D(DVBLEN) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing string" U IO Q
"RTN","DVBHQD1",53,0)
 ;
"RTN","DVBHQD1",54,0)
 I $D(F3) S DVBLEN=DVBLEN-F3 K F3
"RTN","DVBHQD1",55,0)
 I "456789ABCDUVWNMXYZ"'[$E(X(Z1),5) S DVBLEN=DVBLEN-2
"RTN","DVBHQD1",56,0)
 ;
"RTN","DVBHQD1",57,0)
 S (Z,Z9,F2)=0 F  S Z=$O(X(Z)) Q:'Z  S Z9=Z,F2=F2+$L(X(Z))
"RTN","DVBHQD1",58,0)
 ;
"RTN","DVBHQD1",59,0)
 I DVBLEN'=F2,X(Z9)[$C(10) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing character" S DVBMISS="" Q
"RTN","DVBHQD1",60,0)
 I $E(X(Z1),5)'=2 S F2=F2+1
"RTN","DVBHQD1",61,0)
 ;
"RTN","DVBHQD1",62,0)
 I DVBLEN'=F2-1,X(Z9)'[$C(10),$S('$D(X(Z9-1)):1,1:$S(X(Z9-1)'[$C(10):1,1:0)) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing character" S DVBMISS="" Q
"RTN","DVBHQD1",63,0)
 ;trim,e will pack back to x(1)
"RTN","DVBHQD1",64,0)
 I Z9 S:$D(X) DVBSOX=X D TRIM,E^DVBHQAT S:$D(DVBSOX) X=DVBSOX K DVBSOX I $E(X(1),1,4)["HINQ","AXY69"'[$E($E(X(1),5)_1) D ALLM Q
"RTN","DVBHQD1",65,0)
 ;
"RTN","DVBHQD1",66,0)
 S DVBABORT=DVBABORT+1 Q:$E(X(1),1,4)'="HINQ"
"RTN","DVBHQD1",67,0)
 I $E(X(1),5)="A" U IO(0) W:'DVBTSK !,"VBA File not Available" U IO H 2 D ALL QUIT
"RTN","DVBHQD1",68,0)
 ;
"RTN","DVBHQD1",69,0)
 I DVBTSK,"69XY"[$E($E(X(1),5)_1) S DVBBADP="" D ALL QUIT
"RTN","DVBHQD1",70,0)
 I 'Z9 Q
"RTN","DVBHQD1",71,0)
 ;
"RTN","DVBHQD1",72,0)
ALL I 'DVBXM,$D(DFN),+DFN K:C ^TMP("DVBHINQ",$J,DFN) S Z=0 F  S Z=$O(X(Z)) Q:'Z  S ^TMP("DVBHINQ",$J,DFN,Z)=X(Z)
"RTN","DVBHQD1",73,0)
 E  I DVBXM D  K DVBTX Q
"RTN","DVBHQD1",74,0)
 . N DVBQT
"RTN","DVBHQD1",75,0)
 . D RS,A^DVBHIQR
"RTN","DVBHQD1",76,0)
 . I $G(DFN)>1,('DVBTSK),($E(X(1),5)=2),('$D(DVBERCS)) D CHKID I DVBQT D  Q
"RTN","DVBHQD1",77,0)
 . . N DVBTMP1,DVBTMP2
"RTN","DVBHQD1",78,0)
 . . S DVBTMP1=$G(DVBNOALR)
"RTN","DVBHQD1",79,0)
 . . S DVBTMP2=$G(DVBJ2)
"RTN","DVBHQD1",80,0)
 . . S DVBNOALR=";4///c;5////"_DUZ_";6///N",DVBJ2=1
"RTN","DVBHQD1",81,0)
 . . D FILE^DVBHQUP
"RTN","DVBHQD1",82,0)
 . . S DVBNOALR=DVBTMP1
"RTN","DVBHQD1",83,0)
 . . S DVBJ2=DVBTMP2
"RTN","DVBHQD1",84,0)
 . D RECMAL^DVBHQD2
"RTN","DVBHQD1",85,0)
 . D IALERT^DVBHT2,EN^DVBHIQM H 1 D WRT
"RTN","DVBHQD1",86,0)
 I DVBABORT=3!($D(DVBBADP)) S DFN=0
"RTN","DVBHQD1",87,0)
 Q
"RTN","DVBHQD1",88,0)
 ; do all if no error or retrying
"RTN","DVBHQD1",89,0)
ALLM I "BC"'[$E($E(X(1),5)_1) D ALL Q
"RTN","DVBHQD1",90,0)
 I CN,'TRY S TRY=1 D:DVBXM DCN Q
"RTN","DVBHQD1",91,0)
 I 'CN D ALL Q
"RTN","DVBHQD1",92,0)
 S X(1)=X(1)_"[TRY]1" D ALL Q
"RTN","DVBHQD1",93,0)
 ;
"RTN","DVBHQD1",94,0)
DCN S:$G(IO(0))="" IO(0)=$I U IO(0) W !,"..Name, SSN didn't work ....retrying using Claim Number",! U IO Q
"RTN","DVBHQD1",95,0)
 ;
"RTN","DVBHQD1",96,0)
RS Q:'$D(DFN)  Q:'DFN  Q:'$D(^DVB(395.5,DFN,0))  S DVBDFN=DFN,DVBCS=0
"RTN","DVBHQD1",97,0)
 F DVBSZ=0:0 S DVBSZ=$O(X(DVBSZ)) D SC^DVBHQST Q:'DVBSZ  D ST^DVBHQDB
"RTN","DVBHQD1",98,0)
 K DVBSZ,DVBDFN Q
"RTN","DVBHQD1",99,0)
 ;
"RTN","DVBHQD1",100,0)
TRIM Q:F1=999
"RTN","DVBHQD1",101,0)
 I '$D(F1) S F1=$F(X(Z9),DVBEND)
"RTN","DVBHQD1",102,0)
 I $E(X(Z9),F1-F4)=$C(10) S F1=F1-1
"RTN","DVBHQD1",103,0)
 S X(Z9)=$E(X(Z9),1,F1-F4)
"RTN","DVBHQD1",104,0)
 K F1 Q
"RTN","DVBHQD1",105,0)
 ;
"RTN","DVBHQD1",106,0)
WRT S:$G(IO(0))="" IO(0)=$I S DVBJIO=IO(0)
"RTN","DVBHQD1",107,0)
WRT1 S:$G(DVBJIO)="" DVBJIO=$I S:'$D(DVBIOSL) DVBIOSL=IOSL S:'$D(DVBIOST) DVBIOST=IOST S:'$D(DVBIOF) DVBIOF=IOF
"RTN","DVBHQD1",108,0)
 S X="" U DVBJIO W !!! D CODE^DVBHQUS W !! S Y0=$Y F Z=0:0 S Z=$O(^TMP($J,Z)) Q:'Z  I $D(^(Z,0)) W ^(0),! D:$Y-Y0>(DVBIOSL-4) SROLL^DVBHQD2 Q:X="^"  D:$Y<Y0 ABS^DVBHQD2
"RTN","DVBHQD1",109,0)
 Q:X="^"  K DVBJIO D SROLL^DVBHQD2 Q
"RTN","DVBHQD1",110,0)
 ;
"RTN","DVBHQD1",111,0)
CH S F1=0
"RTN","DVBHQD1",112,0)
 I X(W)=$C(10)_"NNNN" K X(W) S F1=999 Q
"RTN","DVBHQD1",113,0)
 I $L(X(W))>4!($L(X(W))<1) Q
"RTN","DVBHQD1",114,0)
 F A=$L(X(W)):-1:1 Q:$E(X(W),A)'="N"
"RTN","DVBHQD1",115,0)
 I A=1,$E(X(W),A)="N" S F1=$L(X(W-1))+1,F3=$L(X(W)),F4=5-$L(X(W)) K X(W)
"RTN","DVBHQD1",116,0)
 Q
"RTN","DVBHQD1",117,0)
CHKID ;checks 4 critical identifier fields
"RTN","DVBHQD1",118,0)
 ;fields are name, DOB, SSN and sex.
"RTN","DVBHQD1",119,0)
 ;DVBQT 0 to continue, 1 to stop processing
"RTN","DVBHQD1",120,0)
 N DA,DIC,DIQ,DIR,DR,X,Y
"RTN","DVBHQD1",121,0)
 N DVBBIRTH,DVBCNT,DVBNAM,DVBNM,DVBSEX,DVBSOCL,DVBSSN
"RTN","DVBHQD1",122,0)
 N DVBDIQ
"RTN","DVBHQD1",123,0)
 S DVBCNT=0
"RTN","DVBHQD1",124,0)
 S DVBQT=0
"RTN","DVBHQD1",125,0)
 S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHQD1",126,0)
 S DR=".01;.02;.03;.09"
"RTN","DVBHQD1",127,0)
 D EN^DIQ1
"RTN","DVBHQD1",128,0)
 S DVBNAM=$S($D(DVBADR(1)):DVBADR(1),$D(DVBNAME):$E(DVBNAME,1,30),1:"")
"RTN","DVBHQD1",129,0)
 S DVBSEX=""
"RTN","DVBHQD1",130,0)
 I $D(DVBVET),$P(DVBVET,U)="A" S DVBSEX=$S($P(DVBVET,U,3)="M":"MALE",$P(DVBVET,U,3)="F":"FEMALE",1:"")
"RTN","DVBHQD1",131,0)
 I '$D(DVBVET),($D(DVBBIR)) S DVBSEX=$S($P(DVBBIR,U,25)="M":"MALE",$P(DVBBIR,U,25)="F":"FEMALE",1:"")
"RTN","DVBHQD1",132,0)
 S DVBSOCL=""
"RTN","DVBHQD1",133,0)
 I $D(DVBREF),($P(DVBREF,U)?9N) S DVBSOCL=$P(DVBREF,U)
"RTN","DVBHQD1",134,0)
 I $P($G(DVBREF),U)'?9N I $D(DVBSSN),(DVBSSN?9N) S DVBSOCL=DVBSSN
"RTN","DVBHQD1",135,0)
 S DVBBIRTH=""
"RTN","DVBHQD1",136,0)
 ;change date of birth to match the Patient file ext value (DVBBIRTH)
"RTN","DVBHQD1",137,0)
 I $D(DVBDOB),(DVBDOB?8N) S DVBBIRTH=$E(DVBDOB,1,2)_"/"_$E(DVBDOB,3,4)_"/"_$E(DVBDOB,5,8)
"RTN","DVBHQD1",138,0)
 ;change ext Patient file value for name to HINQ name format
"RTN","DVBHQD1",139,0)
 I '$$NAME(DVBDIQ(2,DFN,.01,"E")) S DVBCNT=DVBCNT+1
"RTN","DVBHQD1",140,0)
 I $G(DVBSEX)'=$G(DVBDIQ(2,DFN,.02,"E")) S DVBCNT=DVBCNT+1
"RTN","DVBHQD1",141,0)
 I $G(DVBBIRTH)'=$G(DVBDIQ(2,DFN,.03,"E")) S DVBCNT=DVBCNT+1
"RTN","DVBHQD1",142,0)
 I $G(DVBSOCL)'=$G(DVBDIQ(2,DFN,.09,"E")) S DVBCNT=DVBCNT+1
"RTN","DVBHQD1",143,0)
 I DVBCNT>0 D WARN
"RTN","DVBHQD1",144,0)
 Q
"RTN","DVBHQD1",145,0)
WARN ;warns user if there are any discrepancies between HINQ and VistA for 
"RTN","DVBHQD1",146,0)
 ;4 critical identifier fields - name, DOB, SSN and sex.
"RTN","DVBHQD1",147,0)
 N DIRUT,DUOUT
"RTN","DVBHQD1",148,0)
 U IO(0)
"RTN","DVBHQD1",149,0)
 H 1
"RTN","DVBHQD1",150,0)
 D TEXT
"RTN","DVBHQD1",151,0)
 D DISPL
"RTN","DVBHQD1",152,0)
 S DVBQT=1
"RTN","DVBHQD1",153,0)
 N DIR
"RTN","DVBHQD1",154,0)
 S DIR(0)="N^1:3:0",DIR("A")="Do you want to process the HINQ on "_DVBDIQ(2,DFN,.01,"E")_"? ",DIR("B")="NO"
"RTN","DVBHQD1",155,0)
 W !!
"RTN","DVBHQD1",156,0)
 S DIR("A",1)="Check displayed data before proceeding."
"RTN","DVBHQD1",157,0)
 S DIR("A",2)=""
"RTN","DVBHQD1",158,0)
 S DIR("A",3)="Choose one of the following:"
"RTN","DVBHQD1",159,0)
 S DIR("A",4)="    1.  Update this record."
"RTN","DVBHQD1",160,0)
 S DIR("A",5)="    2.  Take no action at this time."
"RTN","DVBHQD1",161,0)
 S DIR("A",6)="    3.  Delete this record from the SUSPENSE file."
"RTN","DVBHQD1",162,0)
 S DIR("A",7)=""
"RTN","DVBHQD1",163,0)
 S DIR("?")="      Select 1 - 3"
"RTN","DVBHQD1",164,0)
 S DIR("?",1)="  If you want to continue processing this HINQ enter 1."
"RTN","DVBHQD1",165,0)
 S DIR("?",3)="  If you cannot process this patient data at this time enter 2."
"RTN","DVBHQD1",166,0)
 S DIR("?",2)="  If the HINQ data is for the wrong patient, enter 3."
"RTN","DVBHQD1",167,0)
 S DIR("B")=2
"RTN","DVBHQD1",168,0)
 D ^DIR
"RTN","DVBHQD1",169,0)
 W !!
"RTN","DVBHQD1",170,0)
 I Y=1 S DVBQT=0 Q  ;update
"RTN","DVBHQD1",171,0)
 I Y=2 Q  ;ignore
"RTN","DVBHQD1",172,0)
 I Y="^"!($G(DIRUT)=1)!($G(DUOUT)=1) S DVBOUT="^" Q  ;"^" out of option
"RTN","DVBHQD1",173,0)
 N DA,DIK ;delete
"RTN","DVBHQD1",174,0)
 S DA=DFN
"RTN","DVBHQD1",175,0)
 S DIK="^DVB(395.5,"
"RTN","DVBHQD1",176,0)
 D ^DIK
"RTN","DVBHQD1",177,0)
 Q
"RTN","DVBHQD1",178,0)
TEXT ;warning text
"RTN","DVBHQD1",179,0)
 W @IOF
"RTN","DVBHQD1",180,0)
 W !!!!
"RTN","DVBHQD1",181,0)
 W ?2,"*********************************************************************"
"RTN","DVBHQD1",182,0)
 W !?2,"*     NOTE: IDENTIFYING DATA FROM HINQ AND VISTA DOES NOT MATCH     *"
"RTN","DVBHQD1",183,0)
 W !?2,"*    PATIENT FROM HINQ RESPONSE MAY NOT BE THE PATIENT REQUESTED    *"
"RTN","DVBHQD1",184,0)
 W !?2,"*********************************************************************"
"RTN","DVBHQD1",185,0)
 Q
"RTN","DVBHQD1",186,0)
DISPL ;display ID data
"RTN","DVBHQD1",187,0)
 W !!?17,"Patient File data",?45,"HINQ Data"
"RTN","DVBHQD1",188,0)
 W !?17,"-----------------",?45,"---------"
"RTN","DVBHQD1",189,0)
 W !?11,"Name: "_$G(DVBDIQ(2,DFN,.01,"E")),?45,$G(DVBNAM)
"RTN","DVBHQD1",190,0)
 W !?12,"Sex: "_$G(DVBDIQ(2,DFN,.02,"E")),?45,$G(DVBSEX)
"RTN","DVBHQD1",191,0)
 W !?2,"Date of Birth: "_$G(DVBDIQ(2,DFN,.03,"E")),?45,$G(DVBBIRTH)
"RTN","DVBHQD1",192,0)
 W !?12,"SSN: "_$G(DVBDIQ(2,DFN,.09,"E")),?45,$G(DVBSOCL)
"RTN","DVBHQD1",193,0)
 Q
"RTN","DVBHQD1",194,0)
NAME(DVBNM) ;set local variables to hold the VistA and HINQ formats of the
"RTN","DVBHQD1",195,0)
 ;patient name so they can be compared, DVB*4*56
"RTN","DVBHQD1",196,0)
 ;first check for the HINQ name on the first address line
"RTN","DVBHQD1",197,0)
 N DVBARR,DVBHFRST,DVBHLST,DVBHMID,DVBOK,DVBSTUB,DVBVFRST,DVBVLST,DVBVMID
"RTN","DVBHQD1",198,0)
 S (DVBARR,DVBOK,DVBSTUB)=0
"RTN","DVBHQD1",199,0)
 ;set variable with HINQ name parts
"RTN","DVBHQD1",200,0)
 I $G(DVBADR(1))]"" D
"RTN","DVBHQD1",201,0)
 . S DVBARR=1
"RTN","DVBHQD1",202,0)
 . S DVBHFRST=$P(DVBADR(1)," ") ;first name
"RTN","DVBHQD1",203,0)
 . S DVBHMID=$P(DVBADR(1)," ",2) ;middle name, if there is one
"RTN","DVBHQD1",204,0)
 . S DVBHLST=$P(DVBADR(1)," ",3) ;last name, if there was a middle name
"RTN","DVBHQD1",205,0)
 ;then check for the HINQ 7 character name stub
"RTN","DVBHQD1",206,0)
 I DVBARR=0,($G(DVBNAME)]"") S DVBSTUB=1
"RTN","DVBHQD1",207,0)
 ;get VistA name parts
"RTN","DVBHQD1",208,0)
 N DVBREST
"RTN","DVBHQD1",209,0)
 S DVBVLST=$P(DVBNM,",")
"RTN","DVBHQD1",210,0)
 S DVBREST=$P(DVBNM,",",2,3)
"RTN","DVBHQD1",211,0)
 S DVBVFRST=$P(DVBREST," ")
"RTN","DVBHQD1",212,0)
 S DVBVMID=$P(DVBREST," ",2)
"RTN","DVBHQD1",213,0)
 ;now compare
"RTN","DVBHQD1",214,0)
 I DVBARR=1 D  Q DVBOK
"RTN","DVBHQD1",215,0)
 . N DVBOK1,DVBOK2,DVBOK3
"RTN","DVBHQD1",216,0)
 . S (DVBOK1,DVBOK2,DVBOK3)=0
"RTN","DVBHQD1",217,0)
 . ;if name is long, HINQ first name may have been truncated to 1 char
"RTN","DVBHQD1",218,0)
 . I $L(DVBHFRST)=1 S DVBVFRST=$E(DVBVFRST)
"RTN","DVBHQD1",219,0)
 . ;if last name is > 16 chars, it may be truncated
"RTN","DVBHQD1",220,0)
 . I $L(DVBVLST)>16 S DVBVLST=$E(DVBVLST,1,$L(DVBHLST))
"RTN","DVBHQD1",221,0)
 . ;if name is long, HINQ middle name may have been truncated to 1 char
"RTN","DVBHQD1",222,0)
 . ;but, if there is no HINQ middle name, do not try to compare
"RTN","DVBHQD1",223,0)
 . I $G(DVBHMID)']"" S DVBOK3=1
"RTN","DVBHQD1",224,0)
 . I DVBOK3=0 D
"RTN","DVBHQD1",225,0)
 . . I $L(DVBHMID)=1 S DVBVMID=$E(DVBVMID)
"RTN","DVBHQD1",226,0)
 . . I DVBVMID=DVBHMID S DVBOK3=1
"RTN","DVBHQD1",227,0)
 . I DVBVFRST=DVBHFRST S DVBOK1=1
"RTN","DVBHQD1",228,0)
 . I DVBVLST=DVBHLST S DVBOK2=1
"RTN","DVBHQD1",229,0)
 . I DVBOK1=1,(DVBOK2=1),(DVBOK3=1) S DVBOK=1 Q
"RTN","DVBHQD1",230,0)
 ;if the first line of the address array is not populated, compare
"RTN","DVBHQD1",231,0)
 ;DVBNAME which is a HINQ stub name to the equivalent patient file stub
"RTN","DVBHQD1",232,0)
 I DVBARR=0,(DVBSTUB=1) D
"RTN","DVBHQD1",233,0)
 . N DVBVSTUB
"RTN","DVBHQD1",234,0)
 . I DVBVMID']"" S DVBVMID=" "
"RTN","DVBHQD1",235,0)
 . S DVBVSTUB=$E(DVBVFRST)_$E(DVBVMID)_$E(DVBVLST,1,5)
"RTN","DVBHQD1",236,0)
 . I DVBVSTUB=DVBNAME S DVBOK=1
"RTN","DVBHQD1",237,0)
 Q DVBOK
"RTN","DVBHQUP")
0^2^B37378101^B32139458
"RTN","DVBHQUP",1,0)
DVBHQUP ;ALB/JLU  This routine is used for the upload option. ; 3/9/06 4:16pm
"RTN","DVBHQUP",2,0)
 ;;4.0;HINQ;**12,49,56**;03/25/92 
"RTN","DVBHQUP",3,0)
A D A^DVBHUTIL
"RTN","DVBHQUP",4,0)
B W !
"RTN","DVBHQUP",5,0)
B1 R !,"Do you want to examine the Suspense file by 'P'atient or 'A'll  P// ",K1:DTIME G:'$T KA1 D P:"Pp"[K1!(K1=""),L:"Aa"[$E(K1_1)
"RTN","DVBHQUP",6,0)
 G:DVBOUT="^" KA1
"RTN","DVBHQUP",7,0)
 I K1="?"!(K1'="^") W !!,*7,?15,"Answer with capital A or P <RET> also for P",!! G B1
"RTN","DVBHQUP",8,0)
KA1 D KA1^DVBHQEDT Q
"RTN","DVBHQUP",9,0)
KA D KA^DVBHQEDT
"RTN","DVBHQUP",10,0)
 Q
"RTN","DVBHQUP",11,0)
P S K1="^" K DVBDIQ D P1 I Y<0 S DVBOUT="^" Q
"RTN","DVBHQUP",12,0)
 N DVBQT,DVBTMP1,DVBTMP2
"RTN","DVBHQUP",13,0)
 S DIE="^DPT(",(DA,DFN)=+Y,DR="[DVBHINQ UPDATE]",DVBJ2=0 D TEM^DVBHIQR
"RTN","DVBHQUP",14,0)
 I '$D(DVBERCS) D CHKID^DVBHQD1
"RTN","DVBHQUP",15,0)
 I $G(DVBQT) D  G P
"RTN","DVBHQUP",16,0)
 . S DVBTMP1=$G(DVBNOALR)
"RTN","DVBHQUP",17,0)
 . S DVBTMP2=$G(DVBJ2)
"RTN","DVBHQUP",18,0)
 . S DVBNOALR=";4///a;5////"_DUZ_";6///N",DVBJ2=1 D FILE
"RTN","DVBHQUP",19,0)
 . S DVBNOALR=DVBTMP1
"RTN","DVBHQUP",20,0)
 . S DVBJ2=DVBTMP2
"RTN","DVBHQUP",21,0)
 D ^DIE:'$D(DVBERCS) K DIE,DR,DA
"RTN","DVBHQUP",22,0)
 D C I DVBOUT'="^" G P
"RTN","DVBHQUP",23,0)
 Q
"RTN","DVBHQUP",24,0)
L S ANS="",K1="^"
"RTN","DVBHQUP",25,0)
 I '$D(^DVB(395.5,"AC","N")) W !!,"No patients to be updated." H 3 Q
"RTN","DVBHQUP",26,0)
 F K2=0:0 S K2=$O(^DVB(395.5,"AC","N",K2)) Q:'K2!(DVBOUT="^")  D
"RTN","DVBHQUP",27,0)
 . I $D(^DVB(395.5,K2,"RS",0)),$P(^DVB(395.5,K2,0),U,5)'="Y",$P(^(0),U,5)'="I" D
"RTN","DVBHQUP",28,0)
 . . S DIE="^DPT(",(DA,DFN)=K2,DR="[DVBHINQ UPDATE]",DVBJ2=0 D TEM^DVBHIQR
"RTN","DVBHQUP",29,0)
 . . N DVBQT,DVBTMP1,DVBTMP2
"RTN","DVBHQUP",30,0)
 . . S DVBQT=1
"RTN","DVBHQUP",31,0)
 . . I '$D(DVBERCS) D CHKID^DVBHQD1 I DVBQT D  Q
"RTN","DVBHQUP",32,0)
 . . . S DVBTMP1=$G(DVBNOALR)
"RTN","DVBHQUP",33,0)
 . . . S DVBTMP2=$G(DVBJ2)
"RTN","DVBHQUP",34,0)
 . . . S DVBNOALR=";4///a;5////"_DUZ_";6///N",DVBJ2=1 D FILE
"RTN","DVBHQUP",35,0)
 . . . S DVBNOALR=DVBTMP1
"RTN","DVBHQUP",36,0)
 . . . S DVBJ2=DVBTMP2
"RTN","DVBHQUP",37,0)
 . . D ^DIE:'$D(DVBERCS) D C,KA Q:DVBOUT="^"
"RTN","DVBHQUP",38,0)
 Q
"RTN","DVBHQUP",39,0)
C ;SETS UPDATED? FIELD, RUNS INCONSIS. CHECKER.
"RTN","DVBHQUP",40,0)
 Q:DVBOUT["^"  S DVB=DFN,DVBLP=2,DVBMM=1,DVBMM2=1 D QB^DVBHQZ6
"RTN","DVBHQUP",41,0)
 Q:'DVBJ2  I DVBJ2 S $P(^DVB(395.5,DFN,0),U,5)="Y" S DGEDCN=1 D ^DGRPC I 1
"RTN","DVBHQUP",42,0)
 E  S $P(^DVB(395.5,DFN,0),U,5)="N"
"RTN","DVBHQUP",43,0)
 D FILE K DVBDIQ Q
"RTN","DVBHQUP",44,0)
 ;
"RTN","DVBHQUP",45,0)
 ;I '$D(^DVB(395.7,DFN,0)) K DIC,DD,DO S DIC(0)="LQ",DIC="^DVB(395.7,",DIC("DR")="1////"_DUZ_";2///"_"N",(X,DINUM)=DFN D FILE^DICN I 1
"RTN","DVBHQUP",46,0)
 ;E  S DIE="^DVB(395.7,",DA=DFN,DR="1////"_DUZ_";2///"_"N" D ^DIE
"RTN","DVBHQUP",47,0)
 ;
"RTN","DVBHQUP",48,0)
FILE I '$D(^DVB(395.7,DFN,0)) DO
"RTN","DVBHQUP",49,0)
 .K DIC,DD,DO S DIC(0)="LQ",DIC="^DVB(395.7,"
"RTN","DVBHQUP",50,0)
 .S DIC("DR")="1////"_DUZ_";2///"_"N"_$S($D(DVBNOALR):DVBNOALR,1:"")
"RTN","DVBHQUP",51,0)
 .S (X,DINUM)=DFN D FILE^DICN
"RTN","DVBHQUP",52,0)
 E  DO
"RTN","DVBHQUP",53,0)
 .K DIC S (DIC,DIE)="^DVB(395.7,",DA=DFN
"RTN","DVBHQUP",54,0)
 .S DR="1////"_DUZ_";2///"_"N"_$S($D(DVBNOALR):DVBNOALR,1:"")
"RTN","DVBHQUP",55,0)
 .I 'DVBJ2,$D(DVBNOALR),DVBNOALR]"" S DR=$E(DVBNOALR,2,99)
"RTN","DVBHQUP",56,0)
 .L +^DVB(395.7,DFN):3 I $T D ^DIE
"RTN","DVBHQUP",57,0)
 .L -^DVB(395.7,DFN)
"RTN","DVBHQUP",58,0)
 K DIC,DIE,DA,DR Q
"RTN","DVBHQUP",59,0)
 ;
"RTN","DVBHQUP",60,0)
 ;ENRTY PT FOR PRINT OPTION
"RTN","DVBHQUP",61,0)
PT W @$S('$D(IOF):"#",IOF="":"#",1:IOF),!!!!!!!!!!
"RTN","DVBHQUP",62,0)
PT1 R "Do you want a print out of a (S)ingle patient or (A)ll of the patients?  S// ",DVBJA:DTIME G:'$T KA1 D S:DVBJA="S"!(DVBJA=""),T:DVBJA="A"
"RTN","DVBHQUP",63,0)
 I DVBJA="?"!(DVBJA'="^") W !!,*7,?15,"Answer with a capital A or S or <RET> for S",!! G PT1
"RTN","DVBHQUP",64,0)
 D KA1 Q
"RTN","DVBHQUP",65,0)
S D P1 I Y<0 S DVBJA="^" Q
"RTN","DVBHQUP",66,0)
 S (DFN,D0,ZTSAVE("D0"),ZTSAVE("DFN"))=+Y,ZTRTN="S1^DVBHQUP" D RP I $D(IO("Q"))!POP S DVBJA="^" Q
"RTN","DVBHQUP",67,0)
S1 U IO D TEM^DVBHIQR,^DVBHCG:'$D(DVBERCS) I '$D(ZTSK) X ^%ZIS("C")
"RTN","DVBHQUP",68,0)
 S DVBJA="^" Q
"RTN","DVBHQUP",69,0)
T S DVBJA="^",ZTRTN="RP1^DVBHQUP"
"RTN","DVBHQUP",70,0)
 W !!,?6,"Select one of the following:",!!,?11,"1   Updated",!,?11,"2   NOT  Updated",!,?11,"3   Both",!,"How would you like your print sorted?  Updated//"
"RTN","DVBHQUP",71,0)
 R Y:DTIME Q:Y="^"!('$T)
"RTN","DVBHQUP",72,0)
 S (ZTSAVE("DVBY"),DVBY)=$S(Y=1!(Y="")!(Y["U"):1,Y=2!(Y["N"):2,Y=3!(Y["B"):3,1:"")
"RTN","DVBHQUP",73,0)
 I DVBY="" W !!,*7,"Answer with a code from the list." G T
"RTN","DVBHQUP",74,0)
 D CT Q
"RTN","DVBHQUP",75,0)
 ;
"RTN","DVBHQUP",76,0)
AU ;ENTRY POINT FOR DISPLAY OF AUDIT.
"RTN","DVBHQUP",77,0)
 W @$S('$D(IOF):"#",IOF="":"#",1:IOF),!!!!!
"RTN","DVBHQUP",78,0)
AU1 W !!,?6,"Select one of the following:",!!,?11,"1   Patient",!,?11,"2   User",!,?11,"3   Date/Time",!,"By which would you like the sort to begin? : Patient//"
"RTN","DVBHQUP",79,0)
 R Y:DTIME Q:Y="^"!('$T)
"RTN","DVBHQUP",80,0)
 S (FLDS,BY)=$S(Y=1!(Y="")!(Y["P"):"[DVBHINQ AUDIT/PAT]",Y=2!(Y["U"):"[DVBHINQ AUDIT/USER]",Y=3!(Y["D"):"[DVBHINQ AUDIT/DT]",1:"")
"RTN","DVBHQUP",81,0)
 I BY="" W !!,*7,"Answer with a code from the above list." G AU1
"RTN","DVBHQUP",82,0)
 S L=0,DIC="^DVB(395.7,",(FR,TO)="" D EN1^DIP Q
"RTN","DVBHQUP",83,0)
 ;
"RTN","DVBHQUP",84,0)
P1 W ! D KA S DIC="^DVB(395.5,",DIC(0)="AEMZQ",DIC("S")="I ($P(^(0),U,4)=""N""),($D(^(""RS"",0)))",DIC("A")="Select Patient from ""HINQ Suspense file"":" D ^DIC K DIC Q
"RTN","DVBHQUP",85,0)
 ;
"RTN","DVBHQUP",86,0)
RP S %IS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) S ZTDESC="This is a job for the HINQ report.",ZTIO=ION D ^%ZTLOAD X ^%ZIS("C") Q
"RTN","DVBHQUP",87,0)
 Q:DVBJA=""!(DVBJA="S")
"RTN","DVBHQUP",88,0)
RP1 S DVB8="" U IO F D0=0:0 S (D0,DFN)=$O(^DVB(395.5,"AC","N",D0)) Q:'D0  S DVBJ1=$S((DVBY=1)&($P(^DVB(395.5,D0,0),U,5)="Y"):1,(DVBY=2)&($P(^(0),U,5)'="Y"):1,DVBY=3:1,1:0) D:DVBJ1 TEM^DVBHIQR,^DVBHCG:'$D(DVBERCS) Q:DVB8["^"  D KA
"RTN","DVBHQUP",89,0)
 I '$D(ZTSK) X ^%ZIS("C")
"RTN","DVBHQUP",90,0)
 Q
"RTN","DVBHQUP",91,0)
 ;
"RTN","DVBHQUP",92,0)
CT S DVB1=0 F DVB=0:0 S DVB1=$O(^DVB(395.5,"AC","N",DVB1)) Q:'DVB1  S DVB=$S(DVBY=1&($P(^DVB(395.5,DVB1,0),U,5)="Y"):DVB+1,DVBY=2&($P(^(0),U,5)'="Y"):DVB+1,DVBY=3:DVB+1,1:DVB)
"RTN","DVBHQUP",93,0)
 I 'DVB W !,"There are no patients at this time for this print." Q
"RTN","DVBHQUP",94,0)
CT1 W !!,"There are ",DVB," patients for this report, do you wish to continue" S %=1 D YN^DICN Q:%=2!(%<0)  I '% W !,"A YES answer will continue on with the report, answer with Y or N" G CT1
"RTN","DVBHQUP",95,0)
 D RP Q
"RTN","DVBHQUP",96,0)
LSTR ;lists the SC disabilities in the ReviewPatient vs. HINQ data 
"RTN","DVBHQUP",97,0)
 ;option, [DVB HUPLOAD-PRINT]
"RTN","DVBHQUP",98,0)
 ;called from print template [DVBHINQ PAT-HINQ COMP]
"RTN","DVBHQUP",99,0)
 N DVBIEN
"RTN","DVBHQUP",100,0)
 K DVBERR
"RTN","DVBHQUP",101,0)
 D GETS^DIQ(2,DFN_",",".302;.3014;.3721*","EI","DVBDIQ","DVBERR")
"RTN","DVBHQUP",102,0)
 W "-Comb. SC%: "_+DVBDIQ(2,DFN_",",.302,"E")_"  "
"RTN","DVBHQUP",103,0)
 W "Eff. Date Comb. Eval.: "_DVBDIQ(2,DFN_",",.3014,"E")
"RTN","DVBHQUP",104,0)
 I $P($G(^DPT(DFN,.372,0)),U,3)>0 D LABELS^DVBHS3
"RTN","DVBHQUP",105,0)
 S LP=""
"RTN","DVBHQUP",106,0)
 I $D(DVBDIQ(2.04)) F  S LP=$O(DVBDIQ(2.04,LP)) Q:'LP  D
"RTN","DVBHQUP",107,0)
 . I ($Y+5)>IOSL,$E(IOST,1,2)="C-" D PAUSE^DVBHS3
"RTN","DVBHQUP",108,0)
 . W !,$E(DVBDIQ(2.04,LP,.01,"E"),1,40),?42,DVBDIQ(2.04,LP,2,"E")
"RTN","DVBHQUP",109,0)
 . W ?50,$G(DVBDIQ(2.04,LP,4,"I")),?55,$G(DVBDIQ(2.04,LP,5,"E"))
"RTN","DVBHQUP",110,0)
 . W ?68,$G(DVBDIQ(2.04,LP,6,"E"))
"RTN","DVBHQUP",111,0)
 Q
"RTN","DVBHQUP",112,0)
 N DVBFR,DVBLAST,DVBX,QUIT
"RTN","DVBHQUP",113,0)
 S DVBFR=""
"RTN","DVBHQUP",114,0)
 S DVBLAST=$O(^DPT(DFN,.372,""),-1)
"RTN","DVBHQUP",115,0)
 I $G(DVBLAST)']"" Q
"RTN","DVBHQUP",116,0)
 F DVBX=0:0 D LOOP I $G(QUIT)=1!(DVBFR(2)>DVBLAST) K QUIT Q
"RTN","DVBHQUP",117,0)
 Q
"RTN","DVBHQUP",118,0)
LOOP ;
"RTN","DVBHQUP",119,0)
 D LIST
"RTN","DVBHQUP",120,0)
 N DVBCT
"RTN","DVBHQUP",121,0)
 F DVBCT=0:0  S DVBCT=$O(DVBARR("DILIST",DVBCT)) Q:'DVBCT!(DVBCT>19)  D
"RTN","DVBHQUP",122,0)
 . W !?36,$P(DVBARR("DILIST",DVBCT,0),U,2),?68,$P(DVBARR("DILIST",DVBCT,0),U,4),?74,$P(DVBARR("DILIST",DVBCT,0),U,5)
"RTN","DVBHQUP",123,0)
 D PAUSE^DVBHS3
"RTN","DVBHQUP",124,0)
 Q
"RTN","DVBHQUP",125,0)
LIST ;
"RTN","DVBHQUP",126,0)
 D LIST^DIC(2.04,","_DFN_",",".01;2;3","P",20,.DVBFR,,,,,"DVBARR",)
"RTN","DVBHQUP",127,0)
 I $G(DVBFR(2))'>0 S QUIT=1
"RTN","DVBHQUP",128,0)
 Q 
"RTN","DVBHS2")
0^3^B10150900^B10155550
"RTN","DVBHS2",1,0)
DVBHS2 ;ALB/JLU;This is the display for screen 2 ;10/7/91
"RTN","DVBHS2",2,0)
 ;;4.0;HINQ;**11,17,49,56**;03/25/92 
"RTN","DVBHS2",3,0)
 ;
"RTN","DVBHS2",4,0)
 N Y
"RTN","DVBHS2",5,0)
 K DVBX(1)
"RTN","DVBHS2",6,0)
 F LP2=.02,.03,.293,.314,.351,.525,.313,.305 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHS2",7,0)
 I $D(X(1)) S DVBX(1)=X(1)
"RTN","DVBHS2",8,0)
 S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHS2",9,0)
 S DR=".02;.03;.293;.313;.314;.351;.525;.305"
"RTN","DVBHS2",10,0)
 D EN^DIQ1
"RTN","DVBHS2",11,0)
 I $D(DVBX(1)) S X(1)=DVBX(1) K DVBX(1)
"RTN","DVBHS2",12,0)
 ;
"RTN","DVBHS2",13,0)
 S DVBSCRN=2 D SCRHD^DVBHUTIL
"RTN","DVBHS2",14,0)
 S DVBJS=28
"RTN","DVBHS2",15,0)
 ;
"RTN","DVBHS2",16,0)
 W !,DVBON,"[1]",DVBOFF X DVBLIT1
"RTN","DVBHS2",17,0)
 W ?4,"Claim Num. :"
"RTN","DVBHS2",18,0)
 W ?19,DVBDIQ(2,DFN,.313,"E")
"RTN","DVBHS2",19,0)
 I $D(DVBCN),DVBCN W ?49,DVBCN
"RTN","DVBHS2",20,0)
 ;
"RTN","DVBHS2",21,0)
 W !,DVBON,"<2>",DVBOFF X DVBLIT1
"RTN","DVBHS2",22,0)
 W ?4,"Date of Birth:"
"RTN","DVBHS2",23,0)
 W ?19,DVBDIQ(2,DFN,.03,"E")
"RTN","DVBHS2",24,0)
 I $D(DVBDOB),DVBDOB I DVBDOB?8N S M=$E(DVBDOB,1,2) D MM^DVBHQM11 W ?49,M_" "_$S(+$E(DVBDOB,3,4)>0:$E(DVBDOB,3,4)_", ",1:" ")_$E(DVBDOB,5,8) K M
"RTN","DVBHS2",25,0)
 ;
"RTN","DVBHS2",26,0)
 W !,DVBON,"<3>",DVBOFF X DVBLIT1
"RTN","DVBHS2",27,0)
 W ?4,"Sex:"
"RTN","DVBHS2",28,0)
 W ?19,DVBDIQ(2,DFN,.02,"E")
"RTN","DVBHS2",29,0)
 I $D(DVBVET),$P(DVBVET,U,1)'="C" W ?49,$S($P(DVBVET,U,3)="M":"MALE",$P(DVBVET,U,3)="F":"FEMALE",1:"")
"RTN","DVBHS2",30,0)
 E  I $D(DVBBIR) W ?49,$S($P(DVBBIR,U,25)="M":"MALE",$P(DVBBIR,U,25)="F":"FEMALE",1:"")
"RTN","DVBHS2",31,0)
 ;
"RTN","DVBHS2",32,0)
 W !,DVBON,"[4]",DVBOFF X DVBLIT1
"RTN","DVBHS2",33,0)
 W ?4,"Date of Death:"
"RTN","DVBHS2",34,0)
 W ?19,DVBDIQ(2,DFN,.351,"E")
"RTN","DVBHS2",35,0)
 I $D(DVBVET),$P(DVBVET,U,1)="B",+$P(DVBVET,U,12),$P(DVBVET,U,12)?8N S M2=$P(DVBVET,U,12),M=$E(M2,5,6) D MM^DVBHQM11 W ?49,M_" "_$E(M2,7,8)_", "_$E(M2,1,4) K M,M2 I 1
"RTN","DVBHS2",36,0)
 E  I $D(DVBP(6)),(+$P(DVBP(6),U)),$P(DVBP(6),U)?8N S M=$E(DVBP(6),1,2) D MM^DVBHQM11 W ?49,M_" "_$S(+$E(DVBP(6),3,4)>0:$E(DVBP(6),3,4)_", ",1:" ")_$E(DVBP(6),5,8) K M
"RTN","DVBHS2",37,0)
 ;
"RTN","DVBHS2",38,0)
 W !,DVBON,"[5]",DVBOFF X DVBLIT1
"RTN","DVBHS2",39,0)
 W ?4,"Rated Incomp.:"
"RTN","DVBHS2",40,0)
 W ?19,DVBDIQ(2,DFN,.293,"E")
"RTN","DVBHS2",41,0)
 I $D(DVBCI) W ?49,$S("1"[DVBCI!(DVBCI="C"):"Competent, or not an issue",DVBCI="I"!(DVBCI=2):"Incompetent",1:DVBCI)
"RTN","DVBHS2",42,0)
 ;
"RTN","DVBHS2",43,0)
 W !,DVBON,"[6]",DVBOFF X DVBLIT1
"RTN","DVBHS2",44,0)
 W ?4,"POW:"
"RTN","DVBHS2",45,0)
 W ?19,DVBDIQ(2,DFN,.525,"E")
"RTN","DVBHS2",46,0)
 W ?49
"RTN","DVBHS2",47,0)
 W $S('$D(DVBPOW):"No POW Ind.",DVBPOW=0:"No Prisoner of war",DVBPOW=1:"30 days or fewer",DVBPOW=2:"more than 30 days",DVBPOW=" ":"Not applicable",1:DVBPOW),"/"
"RTN","DVBHS2",48,0)
 W $S('$D(DVBPOWD):"No POW Days Ind.",1:DVBPOWD)
"RTN","DVBHS2",49,0)
 ;
"RTN","DVBHS2",50,0)
 ;
"RTN","DVBHS2",51,0)
 W !,DVBON,"[7]",DVBOFF X DVBLIT1
"RTN","DVBHS2",52,0)
 W ?4,"Folder Loc. :"
"RTN","DVBHS2",53,0)
 W ?19,DVBDIQ(2,DFN,.314,"E")
"RTN","DVBHS2",54,0)
 I $D(DVBFL) W ?49,DVBFL
"RTN","DVBHS2",55,0)
 ;
"RTN","DVBHS2",56,0)
 W !,DVBON,"[8]",DVBOFF X DVBLIT1
"RTN","DVBHS2",57,0)
 W ?4,"Unemployable:"
"RTN","DVBHS2",58,0)
 I $D(DVBDIQ(2,DFN,.305,"E")) W ?19,DVBDIQ(2,DFN,.305,"E")
"RTN","DVBHS2",59,0)
 I $D(DVBEI) W ?49,$S(DVBEI=1!(DVBEI="N"):"Employable",DVBEI=2!(DVBEI="Y"):"Unemployable",1:DVBEI)
"RTN","DVBHS2",60,0)
 K Y
"RTN","DVBHS2",61,0)
 Q
"RTN","DVBHT")
0^4^B27405943^B24943458
"RTN","DVBHT",1,0)
DVBHT ;PKE/ISC-ALBANY; HINQ alert parser; 5/10/92 ; 3/9/06 4:18pm
"RTN","DVBHT",2,0)
 ;;4.0;HINQ;**12,18,20,56**;03/25/92
"RTN","DVBHT",3,0)
 ;
"RTN","DVBHT",4,0)
 ;call alert
"RTN","DVBHT",5,0)
ALERT I '$D(ZTQUEUED) H 1 W $C(7),".. Alert found."
"RTN","DVBHT",6,0)
 S (I,Y)=0,XQAMSG=""
"RTN","DVBHT",7,0)
 F  S Y=$O(DVBDATA(Y)) Q:'Y  DO
"RTN","DVBHT",8,0)
 .S $P(DVBDATA,"^",I+1)=Y
"RTN","DVBHT",9,0)
 .S XQAMSG=XQAMSG_$S(I:", ",1:"")_Y S I=I+1
"RTN","DVBHT",10,0)
 .K DVBDATA(Y)
"RTN","DVBHT",11,0)
 S XQAMSG="Screen"_$S(I>1:"s ",1:"  ")_XQAMSG
"RTN","DVBHT",12,0)
 ;
"RTN","DVBHT",13,0)
 D MAILGP^DVBHT2,REQUSR^DVBHT2
"RTN","DVBHT",14,0)
 I $D(XQA)'>9 S XQA(DUZ)=""
"RTN","DVBHT",15,0)
 S Y=DT D TM
"RTN","DVBHT",16,0)
 ;
"RTN","DVBHT",17,0)
 S XQAMSG=$E($P(^DPT(DFN,0),"^")_"        ",1,9)_" "_"("_$E(^(0))_$E($P(^(0),"^",9),6,10)_")"_$S('$L($E($P(^(0),"^",9),10)):":",1:"")_" HINQ Update . "_$E(XQAMSG_"                ",1,16)_$J(Y,8)
"RTN","DVBHT",18,0)
 I '$O(XQA(0))
"RTN","DVBHT",19,0)
 E  S XQAMSG=XQAMSG_" "_$E($P($P(^VA(200,$O(XQA(0)),0),"^"),","),1,10)
"RTN","DVBHT",20,0)
 ;
"RTN","DVBHT",21,0)
TST S XQAID="DVB,"_DFN
"RTN","DVBHT",22,0)
 S XQAROU="SETUP^DVBHT"
"RTN","DVBHT",23,0)
 ;S XQAFLG="R"
"RTN","DVBHT",24,0)
 S XQADATA=DFN_"^"_DVBDATA K DVBDATA
"RTN","DVBHT",25,0)
 ;
"RTN","DVBHT",26,0)
 D SETUP^XQALERT
"RTN","DVBHT",27,0)
 S $P(^DVB(395.5,DFN,0),"^",6)=1 Q  ;set alert SET
"RTN","DVBHT",28,0)
 ;
"RTN","DVBHT",29,0)
 ;entry action from alert
"RTN","DVBHT",30,0)
SETUP S DVBDATA=XQADATA K XQADATA,XQAKILL,DVBNOALR
"RTN","DVBHT",31,0)
 S Y=+$P(DVBDATA,"^") Q:'Y
"RTN","DVBHT",32,0)
 S DFN=Y,DVBDATA=$P(DVBDATA,"^",2,99)
"RTN","DVBHT",33,0)
 I '$D(^DVB(395.5,Y,0)) S XQAKILL=0 D KIL Q
"RTN","DVBHT",34,0)
 I '$P(^DVB(395.5,Y,0),"^",6) DO  D KIL Q
"RTN","DVBHT",35,0)
 .W !,?15," another request pending, alert cleared"
"RTN","DVBHT",36,0)
 .S XQAKILL=0
"RTN","DVBHT",37,0)
 I '$D(^XUSEC("DG ELIGIBILITY",DUZ)) DO  D KIL Q
"RTN","DVBHT",38,0)
 .S XQAKILL=1
"RTN","DVBHT",39,0)
 .D DISPLAY
"RTN","DVBHT",40,0)
 .D PAGE
"RTN","DVBHT",41,0)
 ;if no to hinq screens
"RTN","DVBHT",42,0)
 I $P(^DVB(395,1,0),"^",5)="n" DO  D END Q
"RTN","DVBHT",43,0)
 .S XQAKILL=0,DVBJ2=1
"RTN","DVBHT",44,0)
 .D TEM^DVBHIQR I $D(DVBERCS) K XQAKILL Q
"RTN","DVBHT",45,0)
 .D ACHK^DVBHT1
"RTN","DVBHT",46,0)
 .D DISPLAY
"RTN","DVBHT",47,0)
 .I $D(DVBNOALR) D PAGE,FILE^DVBHQUP Q
"RTN","DVBHT",48,0)
 .D ACKNOW
"RTN","DVBHT",49,0)
 .I $D(DVBNOALR) D FILE^DVBHQUP Q
"RTN","DVBHT",50,0)
 .K XQAKILL
"RTN","DVBHT",51,0)
 ;
"RTN","DVBHT",52,0)
 D A^DVBHUTIL W !
"RTN","DVBHT",53,0)
 K DVBDIQ
"RTN","DVBHT",54,0)
 ;
"RTN","DVBHT",55,0)
UPD L +^DPT(DFN):3 I $T DO
"RTN","DVBHT",56,0)
 .N XQAID
"RTN","DVBHT",57,0)
 .S DIE="^DPT(",(DA,DFN)=+Y,DR="[DVBHINQ UPDATE]",DVBJ2=0 D TEM^DVBHIQR
"RTN","DVBHT",58,0)
 .N DVBQT
"RTN","DVBHT",59,0)
 .I '$D(DVBERCS) D CHKID^DVBHQD1 I DVBQT D  Q
"RTN","DVBHT",60,0)
 .. N DVBTMP1,DVBTMP2
"RTN","DVBHT",61,0)
 .. S DVBTMP1=$G(DVBNOALR)
"RTN","DVBHT",62,0)
 .. S DVBTMP2=$G(DVBJ2)
"RTN","DVBHT",63,0)
 .. S DVBNOALR=";4///a;5////"_DUZ_";6///N",DVBJ2=1
"RTN","DVBHT",64,0)
 .. D FILE^DVBHQUP
"RTN","DVBHT",65,0)
 .. S DVBNOALR=DVBTMP1
"RTN","DVBHT",66,0)
 .. S DVBJ2=DVBTMP2
"RTN","DVBHT",67,0)
 .D ^DIE:'$D(DVBERCS) K DIE,DR,DA Q
"RTN","DVBHT",68,0)
 E  W !?3,"This patient data is being edited by another user" H 1 G END
"RTN","DVBHT",69,0)
 L -^DPT(DFN)
"RTN","DVBHT",70,0)
 ;
"RTN","DVBHT",71,0)
 I DVBJ2 DO  ;patient updated, alerts filed in up
"RTN","DVBHT",72,0)
 .W !!,"Checking the alerts ."
"RTN","DVBHT",73,0)
 .D ACHK^DVBHT1
"RTN","DVBHT",74,0)
 .I $D(DVBNOALR) DO
"RTN","DVBHT",75,0)
 . .S DVBNOALR=";4///c;5////"_DUZ_";6///N"
"RTN","DVBHT",76,0)
 . .W ". OK"
"RTN","DVBHT",77,0)
 .E  DO
"RTN","DVBHT",78,0)
 . .W ". need more changes"
"RTN","DVBHT",79,0)
 . .D DISPLAY
"RTN","DVBHT",80,0)
 . .D ACKNOW
"RTN","DVBHT",81,0)
 .H 1
"RTN","DVBHT",82,0)
 E  DO  ;patient not updated
"RTN","DVBHT",83,0)
 .I $D(DVBNOALR) DO  Q
"RTN","DVBHT",84,0)
 . .I DVBNOALR]"" D FILE^DVBHQUP
"RTN","DVBHT",85,0)
 . .;;;D DISPLAY
"RTN","DVBHT",86,0)
 .D ACHK^DVBHT1
"RTN","DVBHT",87,0)
 .D DISPLAY I $D(DVBNOALR) Q
"RTN","DVBHT",88,0)
 .D ACKNOW
"RTN","DVBHT",89,0)
 .I $D(DVBNOALR),DVBNOALR]"" D FILE^DVBHQUP
"RTN","DVBHT",90,0)
 ;
"RTN","DVBHT",91,0)
 K DVBDIQ D C^DVBHQUP
"RTN","DVBHT",92,0)
 ;
"RTN","DVBHT",93,0)
END S END="N DVBNOALR,XQAID D KILL^XUSCLEAN" X END
"RTN","DVBHT",94,0)
 I $D(DVBNOALR) S XQAKILL=0
"RTN","DVBHT",95,0)
KIL K DVBNOALR,DVBDATA,DFN,DVBJ2,DR,DVBDIQ,LP2,DIC,DIQ,DA,D0 Q
"RTN","DVBHT",96,0)
 ;
"RTN","DVBHT",97,0)
 ;display alert
"RTN","DVBHT",98,0)
DISPLAY Q:'$D(DVBDATA)  I '$L($P(DVBDATA,"^",11)) DO CMSG Q
"RTN","DVBHT",99,0)
INFO ;
"RTN","DVBHT",100,0)
 ;;Diagnostic Ver.Ind.: NO   Verify Service Connections at RO
"RTN","DVBHT",101,0)
 I '$D(DVBDIQ(2,DFN,.01,"E")) S DR=".01;.09" D DIQDR^DVBHT1
"RTN","DVBHT",102,0)
 S DVBALERT="LOAD/EDIT Screen"_$S(DVBDATA'["SC D":" 7",1:"s 7, 11")
"RTN","DVBHT",103,0)
 W !," ----------------------------------------------------------------------------"
"RTN","DVBHT",104,0)
 W !,"| ",DVBDIQ(2,DFN,.01,"E"),"  "
"RTN","DVBHT",105,0)
 W $E(DVBDIQ(2,DFN,.01,"E")),$E(DVBDIQ(2,DFN,.09,"E"),6,10)
"RTN","DVBHT",106,0)
 W ?39,DVBALERT,?69,"HINQ"
"RTN","DVBHT",107,0)
 W ?77,"|",!
"RTN","DVBHT",108,0)
 I $D(XQAKILL)
"RTN","DVBHT",109,0)
 F I=11:1 S DVBALERT=$P(DVBDATA,"^",I)_"'" Q:'DVBALERT  DO
"RTN","DVBHT",110,0)
 .W:$X<10 "|",?6
"RTN","DVBHT",111,0)
 .I $E(DVBALERT,2)="+" W "HINQ has data not in patient file `"
"RTN","DVBHT",112,0)
 .I $E(DVBALERT,2)="-" W "Patient file has data not in HINQ `"
"RTN","DVBHT",113,0)
 .I $E(DVBALERT,2)="?" W "HINQ, Patient file are different  `"
"RTN","DVBHT",114,0)
 .I $E(DVBALERT,2)="X" DO
"RTN","DVBHT",115,0)
 . .I $E(DVBALERT,3) W $P($T(INFO+$E(DVBALERT,3)),";;",2)
"RTN","DVBHT",116,0)
 . .S DVBALERT=$E(DVBALERT)
"RTN","DVBHT",117,0)
 .W $E(DVBALERT,3,$L(DVBALERT))
"RTN","DVBHT",118,0)
 .W ?66,"Screen (",$E(DVBALERT),")",?77,"|",!
"RTN","DVBHT",119,0)
 W " ----------------------------------------------------------------------------"
"RTN","DVBHT",120,0)
 K DVBALERT
"RTN","DVBHT",121,0)
 Q
"RTN","DVBHT",122,0)
ACKNOW K DIR S DIR("A")="Do you wish to acknowledge inconsistencies and clear this Alert ? "
"RTN","DVBHT",123,0)
 S DIR("B")="No"
"RTN","DVBHT",124,0)
 S DIR("?",1)="If the patient file has data that should not be updated by HINQ, this Alert"
"RTN","DVBHT",125,0)
 S DIR("?",2)="can be acknowledged and cleared by entering 'Y'es.  Otherwise, just continue"
"RTN","DVBHT",126,0)
 S DIR("?")="Press RETURN to continue,'Y'es to acknowledge, '^' to exit:"
"RTN","DVBHT",127,0)
 S DIR(0)="YAO" D ^DIR K DIR Q:'Y
"RTN","DVBHT",128,0)
 S DVBNOALR=";4///a;5////"_DUZ_";6///N"
"RTN","DVBHT",129,0)
 W !!?6,"   Alert will be cleared" H 1 Q
"RTN","DVBHT",130,0)
 ;
"RTN","DVBHT",131,0)
PAGE K DVBALERT S DIR(0)="E" D ^DIR K DIR Q
"RTN","DVBHT",132,0)
 ;
"RTN","DVBHT",133,0)
CMSG W !!,?20,"Alerts have been cleared",! Q
"RTN","DVBHT",134,0)
 ;
"RTN","DVBHT",135,0)
TM S Y=$E(Y,4,5)_"/"_$E(Y,6,7)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") Q
"VER")
8.0^22.0
"BLD",5963,6)
^54
**END**
**END**
