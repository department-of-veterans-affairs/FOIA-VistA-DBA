Released ONC*2.11*31 SEQ #31
Extracted from mail message
**KIDS**:ONC*2.11*31^

**INSTALL NAME**
ONC*2.11*31
"BLD",3357,0)
ONC*2.11*31^ONCOLOGY^0^3011127^y
"BLD",3357,4,0)
^9.64PA^^0
"BLD",3357,"ABPKG")
n
"BLD",3357,"KRN",0)
^9.67PA^19^17
"BLD",3357,"KRN",.4,0)
.4
"BLD",3357,"KRN",.401,0)
.401
"BLD",3357,"KRN",.402,0)
.402
"BLD",3357,"KRN",.403,0)
.403
"BLD",3357,"KRN",.5,0)
.5
"BLD",3357,"KRN",.84,0)
.84
"BLD",3357,"KRN",3.6,0)
3.6
"BLD",3357,"KRN",3.8,0)
3.8
"BLD",3357,"KRN",9.2,0)
9.2
"BLD",3357,"KRN",9.8,0)
9.8
"BLD",3357,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",3357,"KRN",9.8,"NM",1,0)
ONCODIS^^0^B1391975
"BLD",3357,"KRN",9.8,"NM",2,0)
ONCACD1^^0^B35633134
"BLD",3357,"KRN",9.8,"NM",3,0)
ONCACDU2^^0^B34938218
"BLD",3357,"KRN",9.8,"NM","B","ONCACD1",2)

"BLD",3357,"KRN",9.8,"NM","B","ONCACDU2",3)

"BLD",3357,"KRN",9.8,"NM","B","ONCODIS",1)

"BLD",3357,"KRN",19,0)
19
"BLD",3357,"KRN",19.1,0)
19.1
"BLD",3357,"KRN",101,0)
101
"BLD",3357,"KRN",409.61,0)
409.61
"BLD",3357,"KRN",771,0)
771
"BLD",3357,"KRN",870,0)
870
"BLD",3357,"KRN",8994,0)
8994
"BLD",3357,"KRN","B",.4,.4)

"BLD",3357,"KRN","B",.401,.401)

"BLD",3357,"KRN","B",.402,.402)

"BLD",3357,"KRN","B",.403,.403)

"BLD",3357,"KRN","B",.5,.5)

"BLD",3357,"KRN","B",.84,.84)

"BLD",3357,"KRN","B",3.6,3.6)

"BLD",3357,"KRN","B",3.8,3.8)

"BLD",3357,"KRN","B",9.2,9.2)

"BLD",3357,"KRN","B",9.8,9.8)

"BLD",3357,"KRN","B",19,19)

"BLD",3357,"KRN","B",19.1,19.1)

"BLD",3357,"KRN","B",101,101)

"BLD",3357,"KRN","B",409.61,409.61)

"BLD",3357,"KRN","B",771,771)

"BLD",3357,"KRN","B",870,870)

"BLD",3357,"KRN","B",8994,8994)

"BLD",3357,"QUES",0)
^9.62^^
"BLD",3357,"REQB",0)
^9.611^1^1
"BLD",3357,"REQB",1,0)
ONC*2.11*29^1
"BLD",3357,"REQB","B","ONC*2.11*29",1)

"MBREQ")
0
"PKG",14,-1)
1^1
"PKG",14,0)
ONCOLOGY^ONC^Oncology treatment tracking & tumor registry package.
"PKG",14,20,0)
^9.402P^^
"PKG",14,22,0)
^9.49I^1^1
"PKG",14,22,1,0)
2.11^2950307^2950417
"PKG",14,22,1,"PAH",1,0)
31^3011127
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ONCACD1")
0^2^B35633134
"RTN","ONCACD1",1,0)
ONCACD1 ;HIRMFO/GWB - Annual Call for Data; 06/11/01
"RTN","ONCACD1",2,0)
 ;;2.11;Oncology;**9,12,14,18,20,22,24,25,26,28,29,31**;Mar 07, 1995
"RTN","ONCACD1",3,0)
 ;;
"RTN","ONCACD1",4,0)
EN1 ;Main entry point
"RTN","ONCACD1",5,0)
 K ^TMP($J)
"RTN","ONCACD1",6,0)
 N PAGE,OIEN
"RTN","ONCACD1",7,0)
 S PAGE=1
"RTN","ONCACD1",8,0)
 S OIEN=0
"RTN","ONCACD1",9,0)
 D SETUP
"RTN","ONCACD1",10,0)
 I DEVICE S:$D(ZTQUEUED) ZTREQ="@" Q
"RTN","ONCACD1",11,0)
 I 'DEVICE W $C(26) H 30
"RTN","ONCACD1",12,0)
 Q
"RTN","ONCACD1",13,0)
HEAD(IEN,OUT) ;Header print
"RTN","ONCACD1",14,0)
 N FLG
"RTN","ONCACD1",15,0)
 I IEN=OIEN S FLG=0
"RTN","ONCACD1",16,0)
 I IEN'=OIEN S OIEN=IEN,FLG=1
"RTN","ONCACD1",17,0)
 I 'FLG Q:$Y+4<IOSL
"RTN","ONCACD1",18,0)
 I PAGE'=1 D  Q:OUT
"RTN","ONCACD1",19,0)
 .Q:$E(IOST,1)'="C"
"RTN","ONCACD1",20,0)
 .N DIR,Y
"RTN","ONCACD1",21,0)
 .S DIR("A")="Press ENTER to Continue or ""^"" to Quit: "
"RTN","ONCACD1",22,0)
 .S DIR(0)="EA" D ^DIR
"RTN","ONCACD1",23,0)
 .I 'Y S OUT=1 Q
"RTN","ONCACD1",24,0)
 D HEADER
"RTN","ONCACD1",25,0)
 Q
"RTN","ONCACD1",26,0)
HEADER ;Master header
"RTN","ONCACD1",27,0)
 I PAGE'=1 W @IOF
"RTN","ONCACD1",28,0)
 I PAGE=1,$E(IOST,1)="C" W @IOF
"RTN","ONCACD1",29,0)
 W !,$P(^ONCO(160.16,HDRIEN,0),U),?70,"Page: ",PAGE S PAGE=PAGE+1
"RTN","ONCACD1",30,0)
 W !,"Patient: ",$$GET1^DIQ(160,ACD160,.01,"E")
"RTN","ONCACD1",31,0)
 W ?55,"SSN: ",$$GET1^DIQ(160,ACD160,2,"E")
"RTN","ONCACD1",32,0)
 W !,"Col#",?5,"Data item",?51,"Data Value",!
"RTN","ONCACD1",33,0)
 F I=1:1:79 W "="
"RTN","ONCACD1",34,0)
 Q
"RTN","ONCACD1",35,0)
SETUP ;Setup the data to be verified.
"RTN","ONCACD1",36,0)
 N IEN,BLANK,NINE,ZERO,X
"RTN","ONCACD1",37,0)
 I 'DEVICE S X=0 X ^%ZOSF("RM") ;disable autowrap
"RTN","ONCACD1",38,0)
 S BLANK=" "
"RTN","ONCACD1",39,0)
 S (IEN,ZERO)=0
"RTN","ONCACD1",40,0)
 S NINE=9
"RTN","ONCACD1",41,0)
 S OUT=$G(OUT,0)
"RTN","ONCACD1",42,0)
 I STEXT=0 F  S IEN=$O(^ONCO(165.5,"AY",DATE,IEN)) Q:IEN<1  I $$DIV^ONCFUNC(IEN)=DUZ(2) D  Q:OUT
"RTN","ONCACD1",43,0)
 .Q:$G(^ONCO(165.5,IEN,0))=""
"RTN","ONCACD1",44,0)
 .D LOOP
"RTN","ONCACD1",45,0)
 I STEXT=1 S SDT=SDT-1 F  S SDT=$O(^ONCO(165.5,"AAD",SDT)) Q:(SDT<1)!(SDT>EDT)!(OUT=1)  F  S IEN=$O(^ONCO(165.5,"AAD",SDT,IEN)) Q:IEN<1  I $$DIV^ONCFUNC(IEN)=DUZ(2) D  Q:OUT
"RTN","ONCACD1",46,0)
 .Q:$G(^ONCO(165.5,IEN,0))=""
"RTN","ONCACD1",47,0)
 .D LOOP
"RTN","ONCACD1",48,0)
 Q
"RTN","ONCACD1",49,0)
LOOP ;Loop though the data that was given
"RTN","ONCACD1",50,0)
 N RULES,VALID,JUMP
"RTN","ONCACD1",51,0)
 S RULES=0
"RTN","ONCACD1",52,0)
 F  S RULES=$O(^ONCO(160.16,EXTRACT,"RULES",RULES)) Q:RULES<1  D
"RTN","ONCACD1",53,0)
 .N LINE
"RTN","ONCACD1",54,0)
 .S LINE=^ONCO(160.16,EXTRACT,"RULES",RULES,0)
"RTN","ONCACD1",55,0)
 .X LINE
"RTN","ONCACD1",56,0)
 Q:'VALID
"RTN","ONCACD1",57,0)
 S ^TMP($J,IEN)=""
"RTN","ONCACD1",58,0)
 D OUTPUT(IEN,EXTRACT,JUMP,.OUT)
"RTN","ONCACD1",59,0)
 I 'DEVICE W !
"RTN","ONCACD1",60,0)
 Q
"RTN","ONCACD1",61,0)
OUTPUT(IEN,EXTRACT,JUMP,OUT) ;Output the data
"RTN","ONCACD1",62,0)
 N POS
"RTN","ONCACD1",63,0)
 S ACD160=$P(^ONCO(165.5,IEN,0),U,2)
"RTN","ONCACD1",64,0)
 I DEVICE D HEAD(IEN,.OUT) Q:OUT
"RTN","ONCACD1",65,0)
 S POS=0
"RTN","ONCACD1",66,0)
 F  S POS=$O(^ONCO(160.16,EXTRACT,"FIELD","B",POS)) Q:POS<1  D  Q:OUT
"RTN","ONCACD1",67,0)
 .N NODE
"RTN","ONCACD1",68,0)
 .S NODE=0
"RTN","ONCACD1",69,0)
 .F  S NODE=$O(^ONCO(160.16,EXTRACT,"FIELD","B",POS,NODE)) Q:NODE<1  D  Q:OUT
"RTN","ONCACD1",70,0)
 ..N STRING,DEFAULT,FILL,LEN
"RTN","ONCACD1",71,0)
 ..Q:$G(^ONCO(160.16,EXTRACT,"FIELD",NODE,0))=""
"RTN","ONCACD1",72,0)
 ..D DISPLAY(DEVICE,$P(^ONCO(160.16,EXTRACT,"FIELD",NODE,0),U,1)_U_$P(^ONCO(160.16,EXTRACT,"FIELD",NODE,0),U,4),.OUT)
"RTN","ONCACD1",73,0)
 ..Q:OUT
"RTN","ONCACD1",74,0)
 ..S STRING=$TR(^ONCO(160.16,EXTRACT,"FIELD",NODE,1),"~","^")
"RTN","ONCACD1",75,0)
 ..S DEFAULT=^ONCO(160.16,EXTRACT,"FIELD",NODE,2)
"RTN","ONCACD1",76,0)
 ..S FILL=^ONCO(160.16,EXTRACT,"FIELD",NODE,3)
"RTN","ONCACD1",77,0)
 ..S LEN=$P(^ONCO(160.16,EXTRACT,"FIELD",NODE,0),U,2)
"RTN","ONCACD1",78,0)
 ..D DATA(IEN,ACD160,STRING,DEFAULT,FILL,LEN,JUMP,NODE,POS)
"RTN","ONCACD1",79,0)
 ..I $G(^ONCO(160.16,EXTRACT,0))["ACD" D
"RTN","ONCACD1",80,0)
 ...I $O(^ONCO(160.16,EXTRACT,"FIELD","B",POS))>1 Q  ; Search for last
"RTN","ONCACD1",81,0)
 ...N EXTRACT,NODE,POS
"RTN","ONCACD1",82,0)
 ...;============================================
"RTN","ONCACD1",83,0)
 ...;| This Code is to support the PCE Extract. |
"RTN","ONCACD1",84,0)
 ...;============================================
"RTN","ONCACD1",85,0)
 ...S EXTRACT=100,JUMP=0
"RTN","ONCACD1",86,0)
 ...;S:$D(^ONCO(165.5,"APCE","BLA",IEN)) EXTRACT=1
"RTN","ONCACD1",87,0)
 ...; ^==== Bladder 95,90,85
"RTN","ONCACD1",88,0)
 ...;S:$D(^ONCO(165.5,"APCE","THY",IEN)) EXTRACT=2
"RTN","ONCACD1",89,0)
 ...; ^==== Thyroid 96,91,86
"RTN","ONCACD1",90,0)
 ...;S:$D(^ONCO(165.5,"APCE","STS",IEN)) EXTRACT=3
"RTN","ONCACD1",91,0)
 ...; ^==== Soft Tissue 96,91,86
"RTN","ONCACD1",92,0)
 ...;S:$D(^ONCO(165.5,"APCE","COL",IEN)) EXTRACT=4
"RTN","ONCACD1",93,0)
 ...; ^==== Colorectal 97,92,87
"RTN","ONCACD1",94,0)
 ...;S:$D(^ONCO(165.5,"APCE","NHL",IEN)) EXTRACT=5
"RTN","ONCACD1",95,0)
 ...; ^==== Non-Hodgkins 97,92,87
"RTN","ONCACD1",96,0)
 ...S:$D(^ONCO(165.5,"APCE","BRE",IEN)) EXTRACT=6
"RTN","ONCACD1",97,0)
 ...; ^==== Breast 98,93,88
"RTN","ONCACD1",98,0)
 ...S:$D(^ONCO(165.5,"APCE","PRO2",IEN)) EXTRACT=7
"RTN","ONCACD1",99,0)
 ...; ^==== Prostate 98,93,88
"RTN","ONCACD1",100,0)
 ...S:$D(^ONCO(165.5,"APCE","MEL",IEN)) EXTRACT=8
"RTN","ONCACD1",101,0)
 ...; ^==== Melanoma 99,94,89
"RTN","ONCACD1",102,0)
 ...S:$D(^ONCO(165.5,"APCE","HEP",IEN)) EXTRACT=9
"RTN","ONCACD1",103,0)
 ...; ^==== Hepatocellular Cancers 00,95,90
"RTN","ONCACD1",104,0)
 ...S:$D(^ONCO(165.5,"APCE","CNS",IEN)) EXTRACT=10
"RTN","ONCACD1",105,0)
 ...; ^==== Primary Intracranial/CNS Tumors 00,95,90
"RTN","ONCACD1",106,0)
 ...S:$D(^ONCO(165.5,"APCE","LNG",IEN)) EXTRACT=11
"RTN","ONCACD1",107,0)
 ...; ^==== Lung (NSCLC) 01,96,91
"RTN","ONCACD1",108,0)
 ...S:$D(^ONCO(165.5,"APCE","GAS",IEN)) EXTRACT=12
"RTN","ONCACD1",109,0)
 ...; ^==== Gastric Cancers 01,96,91
"RTN","ONCACD1",110,0)
 ...S POS=0
"RTN","ONCACD1",111,0)
 ...F  S POS=$O(^ONCO(160.17,EXTRACT,"FIELD","B",POS)) Q:POS<1  D  Q:OUT
"RTN","ONCACD1",112,0)
 ....N NODE
"RTN","ONCACD1",113,0)
 ....S NODE=0
"RTN","ONCACD1",114,0)
 ....F  S NODE=$O(^ONCO(160.17,EXTRACT,"FIELD","B",POS,NODE)) Q:NODE<1  D  Q:OUT
"RTN","ONCACD1",115,0)
 .....N STRING,DEFAULT,FILL,LEN
"RTN","ONCACD1",116,0)
 .....Q:$G(^ONCO(160.17,EXTRACT,"FIELD",NODE,0))=""
"RTN","ONCACD1",117,0)
 .....D DISPLAY(DEVICE,$P(^ONCO(160.17,EXTRACT,"FIELD",NODE,0),U,1)_U_$P(^ONCO(160.17,EXTRACT,"FIELD",NODE,0),U,4),.OUT)
"RTN","ONCACD1",118,0)
 .....Q:OUT
"RTN","ONCACD1",119,0)
 .....S STRING=$TR(^ONCO(160.17,EXTRACT,"FIELD",NODE,1),"~","^")
"RTN","ONCACD1",120,0)
 .....S DEFAULT=^ONCO(160.17,EXTRACT,"FIELD",NODE,2)
"RTN","ONCACD1",121,0)
 .....S FILL=^ONCO(160.17,EXTRACT,"FIELD",NODE,3)
"RTN","ONCACD1",122,0)
 .....S LEN=$P(^ONCO(160.17,EXTRACT,"FIELD",NODE,0),U,2)
"RTN","ONCACD1",123,0)
 .....D DATA(IEN,ACD160,STRING,DEFAULT,FILL,LEN,JUMP,NODE,POS)
"RTN","ONCACD1",124,0)
 Q
"RTN","ONCACD1",125,0)
DISPLAY(DEVICE,WRITE,OUT) ; Display Data
"RTN","ONCACD1",126,0)
 Q:'DEVICE
"RTN","ONCACD1",127,0)
 N DOTS,COL,ITEM
"RTN","ONCACD1",128,0)
 I DEVICE,($Y+5)>IOSL D HEAD(0,.OUT) Q:OUT
"RTN","ONCACD1",129,0)
 S COL=$P(WRITE,U,1)
"RTN","ONCACD1",130,0)
 S COL=$S($L(COL)=1:"   "_COL,$L(COL)=2:"  "_COL,$L(COL)=3:" "_COL,1:COL)
"RTN","ONCACD1",131,0)
 S ITEM=$P(WRITE,U,2),ITEM=$E(ITEM,1,45)
"RTN","ONCACD1",132,0)
 S DOTS=(46-$L(ITEM))
"RTN","ONCACD1",133,0)
 W !,COL,?5,ITEM
"RTN","ONCACD1",134,0)
 F I=1:1:DOTS W "."
"RTN","ONCACD1",135,0)
 Q
"RTN","ONCACD1",136,0)
DATA(IEN,ACD160,STRING,DEFAULT,FILL,LEN,JUMP,NODE,POS) ; Data print
"RTN","ONCACD1",137,0)
 N ACDANS,EXIT
"RTN","ONCACD1",138,0)
 S EXIT=0
"RTN","ONCACD1",139,0)
 I JUMP'="0" D
"RTN","ONCACD1",140,0)
 .I POS<$P(JUMP,U) Q
"RTN","ONCACD1",141,0)
 .I POS>$P(JUMP,U,2) Q
"RTN","ONCACD1",142,0)
 .N I
"RTN","ONCACD1",143,0)
 .S EXIT=1
"RTN","ONCACD1",144,0)
 .F I=1:1:LEN W BLANK
"RTN","ONCACD1",145,0)
 Q:EXIT
"RTN","ONCACD1",146,0)
 X STRING
"RTN","ONCACD1",147,0)
 I ACDANS="" D  Q
"RTN","ONCACD1",148,0)
 .N X,I
"RTN","ONCACD1",149,0)
 .S X=""
"RTN","ONCACD1",150,0)
 .F I=1:1:LEN W @DEFAULT
"RTN","ONCACD1",151,0)
 I $L(ACDANS)=LEN W ACDANS Q
"RTN","ONCACD1",152,0)
 I $L(ACDANS)>LEN W $E(ACDANS,1,LEN) Q
"RTN","ONCACD1",153,0)
 E  D  Q
"RTN","ONCACD1",154,0)
 .N JUST,STUFF,I,REM,CAL
"RTN","ONCACD1",155,0)
 .S JUST=$P(FILL,","),STUFF=$P(FILL,",",2)
"RTN","ONCACD1",156,0)
 .S REM=LEN-$L(ACDANS) ; Find out how meny charcter need to be filled
"RTN","ONCACD1",157,0)
 .I JUST="R" W ACDANS ; Fill to the right of the data
"RTN","ONCACD1",158,0)
 .F I=1:1:REM W @STUFF ; Fill in the filler data
"RTN","ONCACD1",159,0)
 .I JUST="L" W ACDANS ; Fill to the left of the data
"RTN","ONCACD1",160,0)
 Q
"RTN","ONCACDU2")
0^3^B34938218
"RTN","ONCACDU2",1,0)
ONCACDU2 ;Hines OIFO/GWB - UTILITY ROUTINE #1;09/20/2000
"RTN","ONCACDU2",2,0)
 ;;2.11;Oncology;**12,18,20,21,22,24,26,27,29,30,31**;Mar 07, 1995
"RTN","ONCACDU2",3,0)
 ;
"RTN","ONCACDU2",4,0)
HOSP1(PROC,IEN) ;Check to see if the site is breast or prostate
"RTN","ONCACDU2",5,0)
 ;Inputs: PROC = Process Number to be processed
"RTN","ONCACDU2",6,0)
 ;         IEN = Record within File 160.16
"RTN","ONCACDU2",7,0)
 ;Output; X data for field.
"RTN","ONCACDU2",8,0)
 ;
"RTN","ONCACDU2",9,0)
 N PTR,X,SITE
"RTN","ONCACDU2",10,0)
 S X=0
"RTN","ONCACDU2",11,0)
 S SITE=$$GET1^DIQ(165.5,IEN,.01,"I")
"RTN","ONCACDU2",12,0)
 S SITE=$$GET1^DIQ(164.2,SITE,.01,"I")
"RTN","ONCACDU2",13,0)
 I SITE="BREAST" D
"RTN","ONCACDU2",14,0)
 .I PROC=1 S PTR=$$GET1^DIQ(165.5,IEN,141,"I") S:PTR'="" X=$P($G(^ONCO(164,67500,"BP5",PTR,0)),U,2)
"RTN","ONCACDU2",15,0)
 .I PROC=2 S PTR=$$GET1^DIQ(165.5,IEN,142,"I") S:PTR'="" X=$P($G(^ONCO(164,67500,"GU5",PTR,0)),U,2)
"RTN","ONCACDU2",16,0)
 .I PROC=3 S X=$$GET1^DIQ(165.5,IEN,143,"I")
"RTN","ONCACDU2",17,0)
 .I PROC=4 S X=$$GET1^DIQ(165.5,IEN,144,"I")
"RTN","ONCACDU2",18,0)
 ;
"RTN","ONCACDU2",19,0)
 I SITE="PROSTATE" D
"RTN","ONCACDU2",20,0)
 .I PROC=1 S PTR=$$GET1^DIQ(165.5,IEN,141,"I") S:PTR'="" X=$P($G(^ONCO(164,67619,"BP5",PTR,0)),U,2)
"RTN","ONCACDU2",21,0)
 .I PROC=2 S PTR=$$GET1^DIQ(165.5,IEN,142,"I") S:PTR'="" X=$P($G(^ONCO(164,67619,"GU5",PTR,0)),U,2)
"RTN","ONCACDU2",22,0)
 .I PROC=3 S X=$$GET1^DIQ(165.5,IEN,145,"I")
"RTN","ONCACDU2",23,0)
 .I PROC=4 S X=$$GET1^DIQ(165.5,IEN,146,"I")
"RTN","ONCACDU2",24,0)
 Q X
"RTN","ONCACDU2",25,0)
 ;
"RTN","ONCACDU2",26,0)
VAFLD(ACDANS) ;Convert data to valid external format
"RTN","ONCACDU2",27,0)
 ;Input: ACDANS
"RTN","ONCACDU2",28,0)
 ;       Y=1
"RTN","ONCACDU2",29,0)
 ;       N=0
"RTN","ONCACDU2",30,0)
 ;       U=9
"RTN","ONCACDU2",31,0)
 I ACDANS="N" S ACDANS=0
"RTN","ONCACDU2",32,0)
 I ACDANS="Y" S ACDANS=1
"RTN","ONCACDU2",33,0)
 I ACDANS="U" S ACDANS=9
"RTN","ONCACDU2",34,0)
 Q ACDANS
"RTN","ONCACDU2",35,0)
 ;
"RTN","ONCACDU2",36,0)
VASIT() ;This function will pass back the VISN value
"RTN","ONCACDU2",37,0)
 ;Output: X = VISN
"RTN","ONCACDU2",38,0)
 N X
"RTN","ONCACDU2",39,0)
 S OSPIEN=$O(^ONCO(160.1,0))
"RTN","ONCACDU2",40,0)
 S X=$P($G(^ONCO(160.1,OSPIEN,1)),U,7)
"RTN","ONCACDU2",41,0)
 K OSPIEN
"RTN","ONCACDU2",42,0)
 Q X
"RTN","ONCACDU2",43,0)
VER(IEN) ;This function will return the COC Coding System
"RTN","ONCACDU2",44,0)
 N X
"RTN","ONCACDU2",45,0)
 S X=$S($$GET1^DIQ(165.5,IEN,3,"I")<2980000:6,1:7)
"RTN","ONCACDU2",46,0)
 Q X
"RTN","ONCACDU2",47,0)
STATE() ;Vendor Name [2170] 981-990
"RTN","ONCACDU2",48,0)
 N X,VERSION
"RTN","ONCACDU2",49,0)
 S VERSION=$P($G(^ONCO(160.16,EXTRACT,0))," ",3)
"RTN","ONCACDU2",50,0)
 S X="VA"_VERSION_"P31"
"RTN","ONCACDU2",51,0)
 Q X
"RTN","ONCACDU2",52,0)
BDATE(ACD160) ;Get birthdate
"RTN","ONCACDU2",53,0)
 N D0,X
"RTN","ONCACDU2",54,0)
 S D0=ACD160
"RTN","ONCACDU2",55,0)
 D DOB^ONCOES
"RTN","ONCACDU2",56,0)
 S X=$G(X)
"RTN","ONCACDU2",57,0)
 Q X
"RTN","ONCACDU2",58,0)
WORD(IEN,NODE,LEN) ;Get word processing data
"RTN","ONCACDU2",59,0)
 N X
"RTN","ONCACDU2",60,0)
 S X=""
"RTN","ONCACDU2",61,0)
 I $D(^ONCO(165.5,IEN,NODE,0)) D
"RTN","ONCACDU2",62,0)
 .N CNT,LINE
"RTN","ONCACDU2",63,0)
 .S CNT=0
"RTN","ONCACDU2",64,0)
 .S LINE=""
"RTN","ONCACDU2",65,0)
 .F  S CNT=$O(^ONCO(165.5,IEN,NODE,CNT)) Q:CNT<1  D  Q:($L(LINE)>LEN)
"RTN","ONCACDU2",66,0)
 ..Q:'$D(^ONCO(165.5,IEN,NODE,CNT,0))
"RTN","ONCACDU2",67,0)
 ..S LINE=LINE_^ONCO(165.5,IEN,NODE,CNT,0)_" "
"RTN","ONCACDU2",68,0)
 ..Q
"RTN","ONCACDU2",69,0)
 .S X=LINE
"RTN","ONCACDU2",70,0)
 .Q
"RTN","ONCACDU2",71,0)
 Q X
"RTN","ONCACDU2",72,0)
STAGE(IEN,TYPE) ;
"RTN","ONCACDU2",73,0)
 ;TNM Path Descriptor [910] 430-430
"RTN","ONCACDU2",74,0)
 ;TNM Clin Descriptor [980] 440-440
"RTN","ONCACDU2",75,0)
 N LOC,X
"RTN","ONCACDU2",76,0)
 S X=""
"RTN","ONCACDU2",77,0)
 S LOC=$S(TYPE="P":89.1,TYPE="C":37,1:"")
"RTN","ONCACDU2",78,0)
 I TYPE'="" D
"RTN","ONCACDU2",79,0)
 .N STRING
"RTN","ONCACDU2",80,0)
 .S STRING=$$GET1^DIQ(165.5,IEN,LOC,"E")
"RTN","ONCACDU2",81,0)
 .I ($P(STRING," ")["m")&($P(STRING," ")["y") S X=6 Q
"RTN","ONCACDU2",82,0)
 .I $P(STRING," ")["m" S X=3 Q
"RTN","ONCACDU2",83,0)
 .I $P(STRING," ")["y" S X=4 Q
"RTN","ONCACDU2",84,0)
 Q X
"RTN","ONCACDU2",85,0)
CCOUNTY(ACD160) ;Get County Code for Current County
"RTN","ONCACDU2",86,0)
 N ZIP,X
"RTN","ONCACDU2",87,0)
 S X=""
"RTN","ONCACDU2",88,0)
 S ZIP=$$GET1^DIQ(160,ACD160,.116,"E")
"RTN","ONCACDU2",89,0)
 I ZIP'="" D
"RTN","ONCACDU2",90,0)
 .N ZIP1,CODE,COUNTY
"RTN","ONCACDU2",91,0)
 .S ZIP1=$P($P(ZIP,",",2)," ",3) S:$L(ZIP1)>5 ZIP1=$E(ZIP1,1,5)
"RTN","ONCACDU2",92,0)
 .Q:$L(ZIP1)<5
"RTN","ONCACDU2",93,0)
 .S CODE=$O(^VIC(5.11,"C",ZIP1,""))
"RTN","ONCACDU2",94,0)
 .Q:CODE<1
"RTN","ONCACDU2",95,0)
 .S COUNTY=$$GET1^DIQ(5.11,CODE,2,"I")
"RTN","ONCACDU2",96,0)
 .Q:COUNTY=""
"RTN","ONCACDU2",97,0)
 .S X=$$GET1^DIQ(5.1,COUNTY,2,"I")
"RTN","ONCACDU2",98,0)
 .Q
"RTN","ONCACDU2",99,0)
 Q X
"RTN","ONCACDU2",100,0)
SUB(IEN,CNT,FIELD) ;Treatment - Subsq & Other
"RTN","ONCACDU2",101,0)
 N X
"RTN","ONCACDU2",102,0)
 S CNT=CNT-1
"RTN","ONCACDU2",103,0)
 S X=""
"RTN","ONCACDU2",104,0)
 I $O(^ONCO(165.5,IEN,4,0)) D
"RTN","ONCACDU2",105,0)
 .N IENS,SUB,SUBFLD,ENTRY,SUBIEN
"RTN","ONCACDU2",106,0)
 .S SUBIEN=0 F I=1:1 S SUBIEN=$O(^ONCO(165.5,IEN,4,SUBIEN)) Q:(I=CNT)!(SUBIEN'>0)
"RTN","ONCACDU2",107,0)
 .I SUBIEN="" S X="" Q
"RTN","ONCACDU2",108,0)
 .S IENS=SUBIEN_","_IEN
"RTN","ONCACDU2",109,0)
 .S ENTRY=$$GET1^DIQ(165.51,IENS,FIELD,"I") I ENTRY="" S X="" Q
"RTN","ONCACDU2",110,0)
 .I $S(FIELD=".01":1,FIELD=".05":1,FIELD=".06":1,FIELD=".07":1,FIELD=".08":1,FIELD=".09":1,FIELD="37":1,1:0) S X=ENTRY Q
"RTN","ONCACDU2",111,0)
 .I $$GET1^DIQ(165.5,IEN,3,"I")<2980000 S X=ENTRY Q
"RTN","ONCACDU2",112,0)
 .S SUBFLD=$S(FIELD=33:"RR5",FIELD=35:"SC5",FIELD=36:"SO5",FIELD=.04:"SPS",1:"") I SUBFLD="" S X="" Q
"RTN","ONCACDU2",113,0)
 .S X=$$SUB164^ONCACDU2(IEN,SUBFLD,ENTRY)
"RTN","ONCACDU2",114,0)
 .Q
"RTN","ONCACDU2",115,0)
 I FIELD=.04,$L(X)=1 S X="0"_X
"RTN","ONCACDU2",116,0)
 Q X
"RTN","ONCACDU2",117,0)
SUB164(IEN,SUBFLD,ENTRY) ;Get values out of file 164
"RTN","ONCACDU2",118,0)
 N X,TOP1,TOP2
"RTN","ONCACDU2",119,0)
 S X=""
"RTN","ONCACDU2",120,0)
 S TOP1=$$GET1^DIQ(165.5,IEN,20,"I") D:TOP1'=""
"RTN","ONCACDU2",121,0)
 .S TOP2=$$GET1^DIQ(164,TOP1,107,"I") D:TOP2'=""
"RTN","ONCACDU2",122,0)
 ..S X=$P($G(^ONCO(164,TOP2,SUBFLD,ENTRY,0)),U,2)
"RTN","ONCACDU2",123,0)
 ..Q
"RTN","ONCACDU2",124,0)
 .Q
"RTN","ONCACDU2",125,0)
 Q X
"RTN","ONCACDU2",126,0)
RXPRI(IEN,FIELD,SUBFLD) ;This is to collect primary
"RTN","ONCACDU2",127,0)
 N X,ENTRY
"RTN","ONCACDU2",128,0)
 S X=""
"RTN","ONCACDU2",129,0)
 S ENTRY=$$GET1^DIQ(165.5,IEN,FIELD,"I") D:ENTRY'=""
"RTN","ONCACDU2",130,0)
 .I $$GET1^DIQ(165.5,IEN,3,"I")<2980000 S X=$S(FIELD=23:$$GET1^DIQ(160.4,ENTRY,.01,"I"),FIELD=74:$$GET1^DIQ(160.6,ENTRY,.01,"I"),1:ENTRY) Q
"RTN","ONCACDU2",131,0)
 .S X=$$SUB164^ONCACDU2(IEN,SUBFLD,ENTRY)
"RTN","ONCACDU2",132,0)
 .Q
"RTN","ONCACDU2",133,0)
 Q X
"RTN","ONCACDU2",134,0)
LAST(ACD160) ;Last contact information
"RTN","ONCACDU2",135,0)
 N X
"RTN","ONCACDU2",136,0)
 S X="A"
"RTN","ONCACDU2",137,0)
 S X=$O(^ONCO(160,ACD160,"F",X),-1)
"RTN","ONCACDU2",138,0)
 I X'>0 S X=""
"RTN","ONCACDU2",139,0)
 Q X
"RTN","ONCACDU2",140,0)
FNODE(ACD160,FIELD) ;Get F Node data
"RTN","ONCACDU2",141,0)
 N FNODE,X
"RTN","ONCACDU2",142,0)
 S FNODE=$$LAST(ACD160),X=""
"RTN","ONCACDU2",143,0)
 I FNODE'="" D
"RTN","ONCACDU2",144,0)
 .N IENS
"RTN","ONCACDU2",145,0)
 .S IENS=FNODE_","_ACD160_","
"RTN","ONCACDU2",146,0)
 .S X=$$GET1^DIQ(160.04,IENS,FIELD,"I")
"RTN","ONCACDU2",147,0)
 .Q
"RTN","ONCACDU2",148,0)
 Q X
"RTN","ONCACDU2",149,0)
CS(IEN) ;Cancer Status
"RTN","ONCACDU2",150,0)
 N X,Z,FNODE
"RTN","ONCACDU2",151,0)
 S FNODE=0
"RTN","ONCACDU2",152,0)
 S X=""
"RTN","ONCACDU2",153,0)
 S FNODE=$O(^ONCO(165.5,IEN,"TS",FNODE))
"RTN","ONCACDU2",154,0)
 I FNODE>0 D
"RTN","ONCACDU2",155,0)
 .N IENS,PT
"RTN","ONCACDU2",156,0)
 .S FNODE=$O(^ONCO(165.5,IEN,"TS"," "),-1)
"RTN","ONCACDU2",157,0)
 .Q:FNODE<1
"RTN","ONCACDU2",158,0)
 .S IENS=FNODE_","_IEN_","
"RTN","ONCACDU2",159,0)
 .S PT=$$GET1^DIQ(165.573,IENS,.02,"I")
"RTN","ONCACDU2",160,0)
 .Q:PT<1
"RTN","ONCACDU2",161,0)
 .S X=$$GET1^DIQ(164.42,PT,1,"I")
"RTN","ONCACDU2",162,0)
 .Q
"RTN","ONCACDU2",163,0)
 Q X
"RTN","ONCACDU2",164,0)
CCTST(ACD160) ;Current City
"RTN","ONCACDU2",165,0)
 N X,D0,ONCOX1,OIEN,INCOM,ONCON,ONCOX
"RTN","ONCACDU2",166,0)
 S X=""
"RTN","ONCACDU2",167,0)
 S D0=ACD160
"RTN","ONCACDU2",168,0)
 I $D(^ONCO(160,D0,0)) D SETUP1^ONCOES
"RTN","ONCACDU2",169,0)
 I $D(ONCOX1) S X=$S($D(@ONCOX1):$P(@ONCOX1,U,4),1:"")
"RTN","ONCACDU2",170,0)
 Q X
"RTN","ONCACDU2",171,0)
CSTST(ACD160) ;Current State
"RTN","ONCACDU2",172,0)
 N X,D0,ONCOX1,OIEN,INCOM,ONCON,ONCOX
"RTN","ONCACDU2",173,0)
 S X=""
"RTN","ONCACDU2",174,0)
 S D0=ACD160
"RTN","ONCACDU2",175,0)
 I $D(^ONCO(160,D0,0)) D SETUP1^ONCOES
"RTN","ONCACDU2",176,0)
 I $D(ONCOX1) S X=$S($D(@ONCOX1):$P(@ONCOX1,U,5),1:"")
"RTN","ONCACDU2",177,0)
 S:X'="" X=$$GET1^DIQ(5,X,1,"I")
"RTN","ONCACDU2",178,0)
 Q X
"RTN","ONCACDU2",179,0)
ICD(ICD) ;Convert ICD Code
"RTN","ONCACDU2",180,0)
 N X
"RTN","ONCACDU2",181,0)
 S ICD=$S(ICD'="":$P($G(^ICD9(ICD,0)),U),1:"0000")
"RTN","ONCACDU2",182,0)
 I ICD["." S ICD=$P(ICD,".")_$P(ICD,".",2)
"RTN","ONCACDU2",183,0)
 S:$L(ICD)=3 ICD=ICD_9
"RTN","ONCACDU2",184,0)
 S:$L(ICD)<4 ICD=$E("0000",1,4-$L(ICD))_ICD
"RTN","ONCACDU2",185,0)
 S:$L(ICD)>4 ICD=$E(ICD,1,4)
"RTN","ONCACDU2",186,0)
 I $E(ICD,4)="X"!($E(ICD,4)="-") S ICD=$E(ICD,1,3)_9
"RTN","ONCACDU2",187,0)
 Q ICD
"RTN","ONCACDU2",188,0)
ICDR(ICD) ;Revision Number
"RTN","ONCACDU2",189,0)
 N ICDR
"RTN","ONCACDU2",190,0)
 S ICD=$$ICD(ICD)
"RTN","ONCACDU2",191,0)
 S ICDR=$S(ICD="    ":0,1:$$GET1^DIQ(160,ACD160,20,"I"))
"RTN","ONCACDU2",192,0)
 S:ICDR="" ICDR=0
"RTN","ONCACDU2",193,0)
 Q ICDR
"RTN","ONCACDU2",194,0)
LINK(ACD160) ;Linkage Name
"RTN","ONCACDU2",195,0)
 N NAME,X
"RTN","ONCACDU2",196,0)
 S DFN=ACD160 D DEM^VADPT
"RTN","ONCACDU2",197,0)
 S NAME=VADM(1)
"RTN","ONCACDU2",198,0)
 D KVAR^VADPT
"RTN","ONCACDU2",199,0)
 S X=($A($E(NAME,1)))+($A($E(NAME,2)))
"RTN","ONCACDU2",200,0)
 S X=X-128 I X<1 S X=""
"RTN","ONCACDU2",201,0)
 Q X
"RTN","ONCACDU2",202,0)
PPAY(IEN) ;PRIMARY PAYER AT DX (165.5,18)
"RTN","ONCACDU2",203,0)
 N X
"RTN","ONCACDU2",204,0)
 S X=$$GET1^DIQ(165.5,IEN,18,"I")
"RTN","ONCACDU2",205,0)
 S X=$$GET1^DIQ(160.3,$S(X'="":X,1:99),.01,"I")
"RTN","ONCACDU2",206,0)
 S X=$S(X<42:X,X>47:X,1:X-1)
"RTN","ONCACDU2",207,0)
 Q X
"RTN","ONCODIS")
0^1^B1391975
"RTN","ONCODIS",1,0)
ONCODIS ;Hines OIFO/GWB - ONCOLOGY DISPLAYS ;05/25/00
"RTN","ONCODIS",2,0)
 ;;2.11;Oncology;**6,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31**;Mar 07, 1995
"RTN","ONCODIS",3,0)
MAIN ;Begin main menu VA display
"RTN","ONCODIS",4,0)
 S VR=$P($T(ONCODIS+1),";",3),NM="ONCOLOGY TUMOR REGISTRY" D LOGO,FUNCT Q
"RTN","ONCODIS",5,0)
FUNCT ;INTRODUCTION
"RTN","ONCODIS",6,0)
 W !!?10,"Choose among the following functions:"
"RTN","ONCODIS",7,0)
 Q
"RTN","ONCODIS",8,0)
LOGO ;DISPLAY LOGO
"RTN","ONCODIS",9,0)
 S:'$D(IOF) IOP="HOME" D:'$D(IOF) ^%ZIS
"RTN","ONCODIS",10,0)
 W *7,@IOF W !!!!!!! F I=1:1:9 W !,?22,$P($T(DISP+I),";",3)
"RTN","ONCODIS",11,0)
 W !!,?23,"Department of Veterans Affairs",!!?23,NM_" V"_VR_"P31" Q
"RTN","ONCODIS",12,0)
DISP ;
"RTN","ONCODIS",13,0)
 ;;VVVV            VVAA
"RTN","ONCODIS",14,0)
 ;; VVVV          VVAAAA
"RTN","ONCODIS",15,0)
 ;;  VVVV        VVAAAAAA
"RTN","ONCODIS",16,0)
 ;;   VVVV      VVAA  AAAA
"RTN","ONCODIS",17,0)
 ;;    VVVV    VVAA    AAAA
"RTN","ONCODIS",18,0)
 ;;     VVVV  VVAA      AAAA
"RTN","ONCODIS",19,0)
 ;;      VVVVVVAA        AAAA
"RTN","ONCODIS",20,0)
 ;;       VVVVAA   AAAAAAAAAAA
"RTN","ONCODIS",21,0)
 ;;        VVAA     AAAAAAAAAAA
"RTN","ONCODIS",22,0)
D W !!?30,"INSTALLATION",!!,?20,NM," PACKAGE",!!,?31,"VERSION ",VR Q
"VER")
8.0^22
**END**
**END**
