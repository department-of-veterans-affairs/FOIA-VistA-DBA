Released PRS*4*103 SEQ #93
Extracted from mail message
**KIDS**:PRS*4.0*103^

**INSTALL NAME**
PRS*4.0*103
"BLD",6392,0)
PRS*4.0*103^PAID^0^3060125^y
"BLD",6392,1,0)
^^5^5^3060125^
"BLD",6392,1,1,0)
This patch addresses one issues:
"BLD",6392,1,2,0)
The Employee Leave Pattern Report does not include all 
"BLD",6392,1,3,0)
types of leave that are available for a leave request. A
"BLD",6392,1,4,0)
request was made to include all types of time that are
"BLD",6392,1,5,0)
available for a leave request on this report.
"BLD",6392,4,0)
^9.64PA^^
"BLD",6392,"ABPKG")
n
"BLD",6392,"KRN",0)
^9.67PA^8989.52^19
"BLD",6392,"KRN",.4,0)
.4
"BLD",6392,"KRN",.401,0)
.401
"BLD",6392,"KRN",.402,0)
.402
"BLD",6392,"KRN",.403,0)
.403
"BLD",6392,"KRN",.5,0)
.5
"BLD",6392,"KRN",.84,0)
.84
"BLD",6392,"KRN",3.6,0)
3.6
"BLD",6392,"KRN",3.8,0)
3.8
"BLD",6392,"KRN",9.2,0)
9.2
"BLD",6392,"KRN",9.8,0)
9.8
"BLD",6392,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6392,"KRN",9.8,"NM",1,0)
PRSRL4^^0^B50550222
"BLD",6392,"KRN",9.8,"NM","B","PRSRL4",1)

"BLD",6392,"KRN",19,0)
19
"BLD",6392,"KRN",19.1,0)
19.1
"BLD",6392,"KRN",101,0)
101
"BLD",6392,"KRN",409.61,0)
409.61
"BLD",6392,"KRN",771,0)
771
"BLD",6392,"KRN",870,0)
870
"BLD",6392,"KRN",8989.51,0)
8989.51
"BLD",6392,"KRN",8989.52,0)
8989.52
"BLD",6392,"KRN",8994,0)
8994
"BLD",6392,"KRN","B",.4,.4)

"BLD",6392,"KRN","B",.401,.401)

"BLD",6392,"KRN","B",.402,.402)

"BLD",6392,"KRN","B",.403,.403)

"BLD",6392,"KRN","B",.5,.5)

"BLD",6392,"KRN","B",.84,.84)

"BLD",6392,"KRN","B",3.6,3.6)

"BLD",6392,"KRN","B",3.8,3.8)

"BLD",6392,"KRN","B",9.2,9.2)

"BLD",6392,"KRN","B",9.8,9.8)

"BLD",6392,"KRN","B",19,19)

"BLD",6392,"KRN","B",19.1,19.1)

"BLD",6392,"KRN","B",101,101)

"BLD",6392,"KRN","B",409.61,409.61)

"BLD",6392,"KRN","B",771,771)

"BLD",6392,"KRN","B",870,870)

"BLD",6392,"KRN","B",8989.51,8989.51)

"BLD",6392,"KRN","B",8989.52,8989.52)

"BLD",6392,"KRN","B",8994,8994)

"BLD",6392,"QUES",0)
^9.62^^
"BLD",6392,"REQB",0)
^9.611^1^1
"BLD",6392,"REQB",1,0)
PRS*4.0*35^2
"BLD",6392,"REQB","B","PRS*4.0*35",1)

"MBREQ")
0
"PKG",408,-1)
1^1
"PKG",408,0)
PAID^PRS^PAID
"PKG",408,20,0)
^9.402P^^
"PKG",408,22,0)
^9.49I^1^1
"PKG",408,22,1,0)
4.0^2950912^2960130
"PKG",408,22,1,"PAH",1,0)
103^3060125
"PKG",408,22,1,"PAH",1,1,0)
^^5^5^3060125
"PKG",408,22,1,"PAH",1,1,1,0)
This patch addresses one issues:
"PKG",408,22,1,"PAH",1,1,2,0)
The Employee Leave Pattern Report does not include all 
"PKG",408,22,1,"PAH",1,1,3,0)
types of leave that are available for a leave request. A
"PKG",408,22,1,"PAH",1,1,4,0)
request was made to include all types of time that are
"PKG",408,22,1,"PAH",1,1,5,0)
available for a leave request on this report.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PRSRL4")
0^1^B50550222^B48387040
"RTN","PRSRL4",1,0)
PRSRL4 ;WIRMFO/JAH-INDIVIDUAL EMPLOYEE LEAVE USE PATTERN ;22-JAN-1998
"RTN","PRSRL4",2,0)
 ;;4.0;PAID;**2,16,19,21,35,103**;Sep 21, 1995
"RTN","PRSRL4",3,0)
SUP ;
"RTN","PRSRL4",4,0)
 N SSN,PRSTLV,PRSAI,PRSR,TLE,TLI,SW,PRSRDUZ,USR,XX,YY
"RTN","PRSRL4",5,0)
 N ALOO,FR,TO,TOP,FRP,EMPNAM
"RTN","PRSRL4",6,0)
 ;
"RTN","PRSRL4",7,0)
 ; DA(2)= stores pay periods in Year-pay period # format
"RTN","PRSRL4",8,0)
 ;
"RTN","PRSRL4",9,0)
 ; set flags for supervisor entry point
"RTN","PRSRL4",10,0)
 S PRSTLV=3,(PRSAI,PRSR)=1
"RTN","PRSRL4",11,0)
 ;
"RTN","PRSRL4",12,0)
 ; Select 1 T&L unit.
"RTN","PRSRL4",13,0)
 ; Defined after TLESEL call
"RTN","PRSRL4",14,0)
 ;    PRSRDUZ, USR = user IEN in PAID EMPLOYEE (450)
"RTN","PRSRL4",15,0)
 ;    SSN          = users SSN
"RTN","PRSRL4",16,0)
 ;    SW
"RTN","PRSRL4",17,0)
 ;    TLE          = selected T&L unit code
"RTN","PRSRL4",18,0)
 ;    TLI          = selected T&L unit IEN in T&L unit file (455.5)
"RTN","PRSRL4",19,0)
 ;    TLE(1)       = "T&L unit code ^ T&L unit name"
"RTN","PRSRL4",20,0)
 ;    TLE(1,n)     = "T&L unit member IEN in file (450) ^ member name"
"RTN","PRSRL4",21,0)
 D TLESEL^PRSRUT0 G Q:$G(TLE)=""!(SSN="") W !
"RTN","PRSRL4",22,0)
 ;
"RTN","PRSRL4",23,0)
 ; TLI    = T&L unit of User
"RTN","PRSRL4",24,0)
 S TLI=$S(PRSRDUZ:$P($G(^(0)),"^",8),1:"000")
"RTN","PRSRL4",25,0)
 ;
"RTN","PRSRL4",26,0)
EN1 ; User look up 4 employee under T&L x-ref in 450
"RTN","PRSRL4",27,0)
 S DIC="^PRSPC(",DIC(0)="AEQZ"
"RTN","PRSRL4",28,0)
 S D="ATL"_$P(TLE(1),"^",1)
"RTN","PRSRL4",29,0)
 S DIC("S")="I $$INXR^PRSRL1($P(TLE(1),U),Y)"
"RTN","PRSRL4",30,0)
 S DIC("A")="Enter employee name: "
"RTN","PRSRL4",31,0)
 D IX^DIC
"RTN","PRSRL4",32,0)
 G Q1:$D(DUOUT)!$D(DTOUT)!(Y=-1)
"RTN","PRSRL4",33,0)
 ; Save IEN (450) of selected employee in PRSRY.  PRSRY1 = 0 node.
"RTN","PRSRL4",34,0)
 ; D0 = selected employee name.  PRSRSSN = SSN from 0 node of 450.
"RTN","PRSRL4",35,0)
 S PRSRY=Y
"RTN","PRSRL4",36,0)
 S PRSRY1=$S($D(Y(0)):Y(0),1:"") ;     0 node of selected emp from 450
"RTN","PRSRL4",37,0)
 S D0=$P(PRSRY,"^") ;                  Selected employee IEN from 450
"RTN","PRSRL4",38,0)
 S EMPNAM=$P(PRSRY,"^",2) ;            employee Name from 450
"RTN","PRSRL4",39,0)
 S PRSRSSN=$P(PRSRY1,"^",9) ;          employee SSN
"RTN","PRSRL4",40,0)
 S SSN=$E(PRSRSSN,1,3)_"-"_$E(PRSRSSN,4,5)_"-"_$E(PRSRSSN,6,9)
"RTN","PRSRL4",41,0)
 S TLUNIT=$P(PRSRY1,"^",7) ;           employee Station Number
"RTN","PRSRL4",42,0)
 S TLE=$P(^PRSPC(D0,0),"^",8) ;        employ T&L unit
"RTN","PRSRL4",43,0)
 ;
"RTN","PRSRL4",44,0)
 ; Get cost center/org code (ccoc) description from selected 
"RTN","PRSRL4",45,0)
 ; employee record.  If no description send a bulletin to G.PAD 
"RTN","PRSRL4",46,0)
 ; & continue using numeric codes instead.
"RTN","PRSRL4",47,0)
 S ORG=$$CCORG^PRSRUTL(PRSRY1)
"RTN","PRSRL4",48,0)
 I +ORG>0 D CCORGBUL^PRSRUTL(ORG,PRSRDUZ,0,EMPNAM)
"RTN","PRSRL4",49,0)
 ;
"RTN","PRSRL4",50,0)
 ;SW should always get set to zero.
"RTN","PRSRL4",51,0)
 S SW=$S(PRSRY'=-1:0,1:1)
"RTN","PRSRL4",52,0)
 ;
"RTN","PRSRL4",53,0)
 D CHKTLE^PRSRUTL G EN1:'STFSW W !
"RTN","PRSRL4",54,0)
 ;
"RTN","PRSRL4",55,0)
ASK ; ask begin date 4 report
"RTN","PRSRL4",56,0)
 S %DT("A")="Enter Beginning Date "
"RTN","PRSRL4",57,0)
 S %DT(0)=-DT ;      date must be <= to today
"RTN","PRSRL4",58,0)
 S %DT("B")="T" ;    default response of today
"RTN","PRSRL4",59,0)
 S %DT="AEX" ;       ask user, echo, must include day & month
"RTN","PRSRL4",60,0)
 D ^%DT
"RTN","PRSRL4",61,0)
 S FR=Y ;            FR = FileMan 4mat of begin date
"RTN","PRSRL4",62,0)
 G Q1:$D(DTOUT)!(X="")!(X="^"),MSG2:FR=-1
"RTN","PRSRL4",63,0)
 ;
"RTN","PRSRL4",64,0)
 ; ask end date 4 report
"RTN","PRSRL4",65,0)
 S %DT("A")="Enter Ending Date "
"RTN","PRSRL4",66,0)
 S %DT("B")="T" ;    default date of today
"RTN","PRSRL4",67,0)
 S %DT(0)=FR ;       end date must be > begin date
"RTN","PRSRL4",68,0)
 S %DT="AEX" ;       ask, echo, day & month
"RTN","PRSRL4",69,0)
 D ^%DT
"RTN","PRSRL4",70,0)
 S TO=Y
"RTN","PRSRL4",71,0)
 G Q1:$D(DTOUT)!(X="")!(X="^"),MSG2:TO=-1
"RTN","PRSRL4",72,0)
 ;
"RTN","PRSRL4",73,0)
 ; Get external representation of begin & end date 4 display
"RTN","PRSRL4",74,0)
 ; XX = begin date
"RTN","PRSRL4",75,0)
 ; YY = end date
"RTN","PRSRL4",76,0)
 S Y=FR D DD^%DT S XX=Y
"RTN","PRSRL4",77,0)
 S Y=TO D DD^%DT S YY=Y
"RTN","PRSRL4",78,0)
 ;
"RTN","PRSRL4",79,0)
 ; Get pay periods (FRP & TOP) that begin & end dates fall in.
"RTN","PRSRL4",80,0)
 ; Vars returned from PP call are  DAY & PPE
"RTN","PRSRL4",81,0)
 N PPE,D1 S D1=FR D PP^PRSAPPU S FRP=PPE
"RTN","PRSRL4",82,0)
 N PPE,D1 S D1=TO D PP^PRSAPPU S TOP=PP4Y
"RTN","PRSRL4",83,0)
 ;
"RTN","PRSRL4",84,0)
 ; Ask user if they want to see all leave, including days off &
"RTN","PRSRL4",85,0)
 ; Holidays or if they want to see only leave taken immediately
"RTN","PRSRL4",86,0)
 ; be4 or after Holidays & days off.
"RTN","PRSRL4",87,0)
 ; ALOO =  users choice ALL, Only or Uparrow (A or O or ^)
"RTN","PRSRL4",88,0)
 S ALOO=$$ASKDSPLY^PRSRL41()
"RTN","PRSRL4",89,0)
 Q:ALOO["^"
"RTN","PRSRL4",90,0)
 ;
"RTN","PRSRL4",91,0)
 ;
"RTN","PRSRL4",92,0)
 S ZTRTN="START^PRSRL4",ZTDESC="EMPLOYEE LEAVE USAGE PATTERN" D ST^PRSRUTL,LOOP,QUE1^PRSRUT0 G Q1:POP!($D(ZTSK))
"RTN","PRSRL4",93,0)
 ;
"RTN","PRSRL4",94,0)
 ;
"RTN","PRSRL4",95,0)
START ;
"RTN","PRSRL4",96,0)
 ; Set up variable 4 Leave check call CKTOUR^PRSUT0 in subroutine LEV
"RTN","PRSRL4",97,0)
 S LVT=";AL:Annual Leave;SL:Sick Leave;WP:Leave Without Pay;ML:Military Leave;TV:Travel;HX:Holiday Excuse;CB:Family Care;"
"RTN","PRSRL4",98,0)
 S LVT=LVT_"AA:Authorized Absence;AD:Adoption;CU:Comp Time/Credit Hrs.;DL:Donor Leave;NL:Non-Pay Annual Leave;RL:Restored Annual Leave;"
"RTN","PRSRL4",99,0)
 S (CNT,POUT,DAT(1))=0
"RTN","PRSRL4",100,0)
 K ^TMP($J)
"RTN","PRSRL4",101,0)
 S ^TMP($J,"USE")="EMPLOYEE LEAVE PATTERN"
"RTN","PRSRL4",102,0)
 S ^TMP($J,"US",0)="COMMENTS"
"RTN","PRSRL4",103,0)
 ;
"RTN","PRSRL4",104,0)
 ;loop thru Time & Attendance file, 4 digit yr "AB" Pay Period X-ref.
"RTN","PRSRL4",105,0)
 ; Start loop w/ payperiod previous begin date
"RTN","PRSRL4",106,0)
 ; Quit loop when pay per. is past end date 
"RTN","PRSRL4",107,0)
 ;
"RTN","PRSRL4",108,0)
 S DA(2)=$$PREP^PRSAPPU(FRP) ;call to get previous pay period
"RTN","PRSRL4",109,0)
 ;
"RTN","PRSRL4",110,0)
 F II=0:0 S DA(2)=$O(^PRST(458,"AB",DA(2))) Q:DA(2)=""!(DA(2)]TOP)  D
"RTN","PRSRL4",111,0)
 .; get pay period IEN
"RTN","PRSRL4",112,0)
 .  S DA(1)=$O(^PRST(458,"AB",DA(2),0))
"RTN","PRSRL4",113,0)
 .;
"RTN","PRSRL4",114,0)
 .; FM dates string 4 curr pay per
"RTN","PRSRL4",115,0)
 .  S DATES=$G(^PRST(458,DA(1),1))
"RTN","PRSRL4",116,0)
 .;
"RTN","PRSRL4",117,0)
 .; get days of week 4 current pay period (Sun  9-Jan-94^...^)
"RTN","PRSRL4",118,0)
 .S DAYSOFWK=$G(^PRST(458,DA(1),2))
"RTN","PRSRL4",119,0)
 .;
"RTN","PRSRL4",120,0)
 .; loop thru days of employee's pay period
"RTN","PRSRL4",121,0)
 .  S DA=0
"RTN","PRSRL4",122,0)
 .  F I=0:0 S DA=$O(^PRST(458,DA(1),"E",D0,"D",DA)) Q:DA'>0  D
"RTN","PRSRL4",123,0)
 ..;
"RTN","PRSRL4",124,0)
 ..;  quit if outside date range
"RTN","PRSRL4",125,0)
 ..   Q:$P(DATES,"^",DA)<FR!($P(DATES,"^",DA)>TO)
"RTN","PRSRL4",126,0)
 ..;
"RTN","PRSRL4",127,0)
 ..;  tour of duty 4 current day
"RTN","PRSRL4",128,0)
 ..   S TOD=$P($G(^PRST(458,DA(1),"E",D0,"D",DA,0)),"^",2)
"RTN","PRSRL4",129,0)
 ..;
"RTN","PRSRL4",130,0)
 ..;  tour of duty 4 next day
"RTN","PRSRL4",131,0)
 ..   S TOD(1)=$P($G(^PRST(458,DA(1),"E",D0,"D",DA+1,0)),"^",2) Q:TOD=""
"RTN","PRSRL4",132,0)
 ..;
"RTN","PRSRL4",133,0)
 ..   D LEV
"RTN","PRSRL4",134,0)
 ..   Q
"RTN","PRSRL4",135,0)
 .  Q
"RTN","PRSRL4",136,0)
 S DAT=$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","PRSRL4",137,0)
 U IO I 'CNT D HDR1^PRSRL41 W !,"|",?10,"No leave Usage on File within this Date Range.",?79,"|" S POUT=1 D NONE G Q1
"RTN","PRSRL4",138,0)
 D ^PRSRL41
"RTN","PRSRL4",139,0)
 G Q1:POUT I CNT D VLIDSH0^PRSRL41 S CODE="L005",FOOT="VA TIME & ATTENDANCE SYSTEM" D FOOT2^PRSRUT0
"RTN","PRSRL4",140,0)
 ;
"RTN","PRSRL4",141,0)
 ;
"RTN","PRSRL4",142,0)
Q I $E(IOST)="C"!($G(IOT)="VTRM") R !!,"Press Return/Enter to continue. ",X:DTIME
"RTN","PRSRL4",143,0)
Q1 K %9,%DT,%RET,%TG,C,CNT,CODE,COM,COS,COSORG,D0,D1,DA,DAT,DATE,DATES,DATT,DAY,DDH,DIC,EDT,FOOT,FR,FRP,I,II,INX,K,LEV,LVT,NAM,ORG,POP,POUT,PP,PPE,PPI,PRSPRSR,PRSRY,PRSRY1
"RTN","PRSRL4",144,0)
 K RG,SSN,STFSW,SW,TC,TIM,TL,TLE,TLEV,TLI,TLUNIT,TO,TOD,TOP,TOUR,TOUR1,TYL,X,X1,X2,XX,Y,YY,Z,Z1,ZTDESC,ZTRTN,ZTSAVE,^TMP($J) D ^%ZISC S:$D(ZTSK) ZTREQ="@" K ZTSK W:$E(IOST)="C"!($G(IOT)="VTRM") @IOF
"RTN","PRSRL4",145,0)
 Q
"RTN","PRSRL4",146,0)
LEV ;
"RTN","PRSRL4",147,0)
 S DAY=$P($P(DAYSOFWK,"^",DA)," ") ;  current day of week (SUN, MON...)
"RTN","PRSRL4",148,0)
 S DAY(1)=$P($P(DAYSOFWK,"^",DA+1)," ") ; next day of week
"RTN","PRSRL4",149,0)
 ;
"RTN","PRSRL4",150,0)
 ; TOUR = ((day off) or (NODE with either 
"RTN","PRSRL4",151,0)
 ;        (start and stop times) or (null for worked entire tour))
"RTN","PRSRL4",152,0)
 S TOUR=$S(TOD'=1:$G(^PRST(458,DA(1),"E",D0,"D",DA,2)),1:"DO")
"RTN","PRSRL4",153,0)
 ;
"RTN","PRSRL4",154,0)
 ;Check 4 leave in LVT variable (SL,AL,ML,TV,HX)
"RTN","PRSRL4",155,0)
 ;if today not a day off
"RTN","PRSRL4",156,0)
 ;Quit if employee worked entire tour (tour="")
"RTN","PRSRL4",157,0)
 D CKTOUR^PRSRUT0(.TOUR):TOD'=1 Q:TOUR=""
"RTN","PRSRL4",158,0)
 ;
"RTN","PRSRL4",159,0)
 ;TOUR(1) = same as TOUR exept next day.
"RTN","PRSRL4",160,0)
 S TOUR1=$S(TOD(1)'=1:$G(^PRST(458,DA(1),"E",D0,"D",DA+1,2)),1:"DO")
"RTN","PRSRL4",161,0)
 ;
"RTN","PRSRL4",162,0)
 ;Check 4 leave in LVT variable (SL,AL,ML,TV,HX)
"RTN","PRSRL4",163,0)
 ;if today not a day off
"RTN","PRSRL4",164,0)
 ;Quit if employee worked entire tour, unless they've selected ALL
"RTN","PRSRL4",165,0)
 D CKTOUR^PRSRUT0(.TOUR1):TOD(1)'=1 Q:((TOUR1="")&(ALOO'="A"))
"RTN","PRSRL4",166,0)
 ;
"RTN","PRSRL4",167,0)
 ;Test whether leave should be saved for display
"RTN","PRSRL4",168,0)
 Q:'$$SHOWLEAV()
"RTN","PRSRL4",169,0)
 ;
"RTN","PRSRL4",170,0)
 ;
"RTN","PRSRL4",171,0)
 ;If we've made it this far store the leave or day off in the temp
"RTN","PRSRL4",172,0)
 ;global for display, unless it's already there.
"RTN","PRSRL4",173,0)
 I $G(DAY)'="",$G(^TMP($J,"USE",CNT,DA(2),$P(DATES,"^",DA),DAY))'=TOUR D
"RTN","PRSRL4",174,0)
 .  S CNT=CNT+1
"RTN","PRSRL4",175,0)
 .  S ^TMP($J,"USE",CNT,DA(2),$P(DATES,"^",DA),DAY)=TOUR
"RTN","PRSRL4",176,0)
 .  S ^TMP($J,"US",CNT)=$G(^PRST(458,DA(1),"E",D0,"D",DA,3))
"RTN","PRSRL4",177,0)
 ;
"RTN","PRSRL4",178,0)
 W:'$D(ZTSK)&($E(IOST)'="P")!($G(IOT)="VTRM")&($R(30)) "."
"RTN","PRSRL4",179,0)
 ;
"RTN","PRSRL4",180,0)
 I $G(DAY(1))'="",$G(^TMP($J,"USE",CNT,DA(2),$P(DATES,"^",DA+1),DAY(1)))'=TOUR1 D
"RTN","PRSRL4",181,0)
 .  S CNT=CNT+1
"RTN","PRSRL4",182,0)
 .  S ^TMP($J,"USE",CNT,DA(2),$P(DATES,"^",DA+1),DAY(1))=TOUR1
"RTN","PRSRL4",183,0)
 .  S ^TMP($J,"US",CNT)=$G(^PRST(458,DA(1),"E",D0,"D",DA+1,3))
"RTN","PRSRL4",184,0)
 ;
"RTN","PRSRL4",185,0)
 W:'$D(ZTSK)&($E(IOST)'="P")!($G(IOT)="VTRM")&($R(30)) "."
"RTN","PRSRL4",186,0)
 ;
"RTN","PRSRL4",187,0)
 ;
"RTN","PRSRL4",188,0)
 S DAT(1)=$P(DATES,"^",DA+1),DAY(2)=DAY
"RTN","PRSRL4",189,0)
 Q
"RTN","PRSRL4",190,0)
NONE I IOSL<66 F I=$Y:1:IOSL-5 D VLIN0^PRSRL41
"RTN","PRSRL4",191,0)
 D HDR^PRSRL41
"RTN","PRSRL4",192,0)
 Q
"RTN","PRSRL4",193,0)
MSG1 W !!,*7,"*** Employee name not found." G EN1
"RTN","PRSRL4",194,0)
MSG2 W !!,*7,"The Date was invalid." G ASK
"RTN","PRSRL4",195,0)
 ;
"RTN","PRSRL4",196,0)
 ;Save all variables 4 tasked job
"RTN","PRSRL4",197,0)
LOOP F X="ALOO","FR","FRP","TLE","TLI","TO","TOP","DT","NAM","SSN","SW","LOC","POS","PRSRDUZ","PRSRY","PRSRY1","COS","^TMP($J,""USE"",","ORG","D0","TLUNIT","XX","YY","PRSRSSN" S ZTSAVE(X)=""
"RTN","PRSRL4",198,0)
 Q
"RTN","PRSRL4",199,0)
 ;=====================================================================
"RTN","PRSRL4",200,0)
SHOWLEAV() ;
"RTN","PRSRL4",201,0)
 ;If user has selected 'All', then show leave (return true)
"RTN","PRSRL4",202,0)
 ;
"RTN","PRSRL4",203,0)
 ;Otherwise, don't store leave 4 display IF: 
"RTN","PRSRL4",204,0)
 ; (next day tour = day off) & (current day tour = Holiday) or
"RTN","PRSRL4",205,0)
 ; (todays tour = day off) & (next days tour = day off) or
"RTN","PRSRL4",206,0)
 ; user has selected only leave around days off & 
"RTN","PRSRL4",207,0)
 ; (todays tour is not = day off) & (next day is not day off)
"RTN","PRSRL4",208,0)
 ;
"RTN","PRSRL4",209,0)
 Q:ALOO="A" 1
"RTN","PRSRL4",210,0)
 S RTN=1
"RTN","PRSRL4",211,0)
 I ((TOD=1&(TOUR1["HX"))!(TOD(1)=1&(TOUR["HX"))!(TOUR="DO"&(TOUR1="DO"))!((ALOO="O")&(TOUR'="DO"&(TOUR1'="DO")))) S RTN=0
"RTN","PRSRL4",212,0)
 Q RTN
"VER")
8.0^22.0
"BLD",6392,6)
^93
**END**
**END**
