Released QAC*2*12 SEQ #10
Extracted from mail message
**KIDS**:QAC*2.0*12^

**INSTALL NAME**
QAC*2.0*12
"BLD",1933,0)
QAC*2.0*12^PATIENT REPRESENTATIVE^0^2990923^y
"BLD",1933,4,0)
^9.64PA^^
"BLD",1933,"ABNS",0)
^9.66A^^
"BLD",1933,"ABPKG")
n^n
"BLD",1933,"KRN",0)
^9.67PA^19^18
"BLD",1933,"KRN",.4,0)
.4
"BLD",1933,"KRN",.401,0)
.401
"BLD",1933,"KRN",.402,0)
.402
"BLD",1933,"KRN",.403,0)
.403
"BLD",1933,"KRN",.5,0)
.5
"BLD",1933,"KRN",.84,0)
.84
"BLD",1933,"KRN",3.6,0)
3.6
"BLD",1933,"KRN",3.8,0)
3.8
"BLD",1933,"KRN",9.2,0)
9.2
"BLD",1933,"KRN",9.8,0)
9.8
"BLD",1933,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",1933,"KRN",9.8,"NM",1,0)
QACADHOC^^0^B25277228
"BLD",1933,"KRN",9.8,"NM",2,0)
QACALRT1^^0^B26710451
"BLD",1933,"KRN",9.8,"NM",3,0)
QACCSSTD^^0^B59372805
"BLD",1933,"KRN",9.8,"NM",4,0)
QACNEWSV^^0^B1111653
"BLD",1933,"KRN",9.8,"NM",5,0)
QACSPRD^^0^B8609405
"BLD",1933,"KRN",9.8,"NM",6,0)
QACSPRD2^^0^B34198846
"BLD",1933,"KRN",9.8,"NM","B","QACADHOC",1)

"BLD",1933,"KRN",9.8,"NM","B","QACALRT1",2)

"BLD",1933,"KRN",9.8,"NM","B","QACCSSTD",3)

"BLD",1933,"KRN",9.8,"NM","B","QACNEWSV",4)

"BLD",1933,"KRN",9.8,"NM","B","QACSPRD",5)

"BLD",1933,"KRN",9.8,"NM","B","QACSPRD2",6)

"BLD",1933,"KRN",19,0)
19
"BLD",1933,"KRN",19.1,0)
19.1
"BLD",1933,"KRN",101,0)
101
"BLD",1933,"KRN",409.61,0)
409.61
"BLD",1933,"KRN",771,0)
771
"BLD",1933,"KRN",869.2,0)
869.2
"BLD",1933,"KRN",870,0)
870
"BLD",1933,"KRN",8994,0)
8994
"BLD",1933,"KRN","B",.4,.4)

"BLD",1933,"KRN","B",.401,.401)

"BLD",1933,"KRN","B",.402,.402)

"BLD",1933,"KRN","B",.403,.403)

"BLD",1933,"KRN","B",.5,.5)

"BLD",1933,"KRN","B",.84,.84)

"BLD",1933,"KRN","B",3.6,3.6)

"BLD",1933,"KRN","B",3.8,3.8)

"BLD",1933,"KRN","B",9.2,9.2)

"BLD",1933,"KRN","B",9.8,9.8)

"BLD",1933,"KRN","B",19,19)

"BLD",1933,"KRN","B",19.1,19.1)

"BLD",1933,"KRN","B",101,101)

"BLD",1933,"KRN","B",409.61,409.61)

"BLD",1933,"KRN","B",771,771)

"BLD",1933,"KRN","B",869.2,869.2)

"BLD",1933,"KRN","B",870,870)

"BLD",1933,"KRN","B",8994,8994)

"BLD",1933,"QUES",0)
^9.62^^
"BLD",1933,"REQB",0)
^9.611^3^3
"BLD",1933,"REQB",1,0)
QAC*2.0*10^1
"BLD",1933,"REQB",2,0)
QAC*2.0*9^1
"BLD",1933,"REQB",3,0)
QAC*2.0*5^1
"BLD",1933,"REQB","B","QAC*2.0*10",1)

"BLD",1933,"REQB","B","QAC*2.0*5",3)

"BLD",1933,"REQB","B","QAC*2.0*9",2)

"MBREQ")
0
"PKG",380,-1)
1^1
"PKG",380,0)
PATIENT REPRESENTATIVE^QAC^PATIENT REPRESENTATIVE PACKAGE
"PKG",380,20,0)
^9.402P^^
"PKG",380,22,0)
^9.49I^1^1
"PKG",380,22,1,0)
2.0^2950725^2950914
"PKG",380,22,1,"PAH",1,0)
12^2990923
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","QACADHOC")
0^1^B25277228
"RTN","QACADHOC",1,0)
QACADHOC ;HISC/DAD-AD HOC REPORT INTERFACE FOR THE CONSUMER CONTACT FILE (#745.1) ;6/13/95  13:20
"RTN","QACADHOC",2,0)
 ;;2.0;Patient Representative;**1,3,5,6,8,10,12**;07/25/1995
"RTN","QACADHOC",3,0)
 ;;1.6;QM Integration Module;;03/28/1994
"RTN","QACADHOC",4,0)
 ; *** Set up required and optional variables and call Ad Hoc Rpt Gen
"RTN","QACADHOC",5,0)
 S QAQMRTN="MENU^QACADHOC",QAQORTN="OTHER^QACADHOC",QAQDIC=745.1
"RTN","QACADHOC",6,0)
 S QAQMHDR="Patient Representative"
"RTN","QACADHOC",7,0)
 D ^QAQAHOC0
"RTN","QACADHOC",8,0)
 Q
"RTN","QACADHOC",9,0)
MENU ; *** Build the menu array
"RTN","QACADHOC",10,0)
 S QAQMENU=1
"RTN","QACADHOC",11,0)
 F QA=1:1 S X=$P($T(TEXT+QA),";;",2,99) Q:X=""  S QAQMENU(QAQMENU)=X,QAQMENU=QAQMENU+1
"RTN","QACADHOC",12,0)
 Q
"RTN","QACADHOC",13,0)
OTHER ; *** Set up other (optional) EN1^DIP variables, e.g.
"RTN","QACADHOC",14,0)
 ; *** DCOPIES,DHD,DHIT,DIOBEG,DIOEND,DIS(),IOP,PG
"RTN","QACADHOC",15,0)
 K QAQFOUND S QAQFOUND=0,DHIT="S QAQFOUND=1"
"RTN","QACADHOC",16,0)
 S DIOEND="I 'QAQFOUND W !!,""No data found for this report !!"""
"RTN","QACADHOC",17,0)
 Q
"RTN","QACADHOC",18,0)
TEXT ;;*** Sort Yes/No ^ Menu Text ^ ~Field # ^ DIR(0)
"RTN","QACADHOC",19,0)
 ;;0^Contact Number^~.01;"Contact Number"^NAO^-999999999:999999999:9^
"RTN","QACADHOC",20,0)
 ;;1^Date of Contact^~1;"Date Of Contact"^DAO^::AETS^D DATE^QAQAHOC2
"RTN","QACADHOC",21,0)
 ;;1^Patient Name^~2;"Patient Name"^PAO^2:AEMQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",22,0)
 ;;1^SSN^~3^FAO^1:60^
"RTN","QACADHOC",23,0)
 ;;1^Date of Birth^~4;"Date of Birth"^DAO^::AETS^D DATE^QAQAHOC2
"RTN","QACADHOC",24,0)
 ;;1^Sex^~5;"Sex"^SOA^M:MALE;F:FEMALE;^I $D(Y(0)) S Y=Y(0)
"RTN","QACADHOC",25,0)
 ;;1^Eligibility Status^~6;"Eligibility Status"^PAO^8:AEMQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",26,0)
 ;;1^Category^~7;"Category"^PAO^408.32:AEMQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",27,0)
 ;;1^Info Taken by^~8;"Info Taken by"^PAO^200:AEMQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",28,0)
 ;;1^Entered by^~9;"Entered by"^PAO^200:AEMQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",29,0)
 ;;0^Name of Contact^~10;"Name of Contact"^FAO^1:60^
"RTN","QACADHOC",30,0)
 ;;0^Phone of Contact^~11;"Phone of Contact"^FAO^1:60^
"RTN","QACADHOC",31,0)
 ;;1^Contact Made by^~12;"Contact Made by"^SOA^PA:Patient;RE:Relative;FR:Friend;CO:Congressional;VH:VISN/HQ;VO:Veterans Service Org.;AT:Atty/Guard/Consv/Trustee;DI:Director's Office - VAMC;ST:Staff - VAMC;OT:Other;^D SET^QAQAHOC2
"RTN","QACADHOC",32,0)
 ;;1^Source of Contact(to 10/1/97)^~13;"Source of Contact"^SOA^L:Letter;W:Ward Visit;V:Visit;P:Phone;S:Survey;^D SET^QAQAHOC2
"RTN","QACADHOC",33,0)
 ;;1^Source(s) of Contact^30,~.01;"Source(s) of Contact (after 9/1/97)"^SOA^L:Letter;W:Ward Visit;V:Visit;P:Phone;S:Survey;I:Internet;^D SET^QAQAHOC2
"RTN","QACADHOC",34,0)
 ;;1^Location of Event^~14;"Location of Event"^PAO^44:AEMNQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",35,0)
 ;;1^Treatment Status^~16.5;"Treatment Status"^SOA^I:Inpatient;O:Outpatient;D:Domiciliary;N:NHCU;L:Long Term Psych;E:Extended/Intermed. Care;H:HBHC;^D SET^QAQAHOC2
"RTN","QACADHOC",36,0)
 ;;1^Employee^17,~.01;"Employee"^PAO^200:AEMQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",37,0)
 ;;1^Refer Contact to^28,~.01;"Refer Contact to"^PAO^200:AEMNQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",38,0)
 ;;1^Congressional Contact^~29;"Congressional Contact"^PAO^745.4:AEMNQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",39,0)
 ;;1^Date Sent^~19;"Date Sent"^DAO^::AETS^D DATE^QAQAHOC2
"RTN","QACADHOC",40,0)
 ;;1^Date Due^~20.1;"Date Due"^DAO^::AETS^D DATE^QAQAHOC2
"RTN","QACADHOC",41,0)
 ;;1^Issue Codes^21,.01:,~.01;"Issue Codes"^PAO^745.2:AEMNQZ^I $D(Y(0)) S Y=$P(Y(0),U)
"RTN","QACADHOC",42,0)
 ;;1^Serv/Sect Involved(to 10/1/97)^21,1,~.01;"Serv/Sect Involved"^POA^49:AEMNQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",43,0)
 ;;1^Serv/Discipline Involved^21,3,~.01;"Section/Discipline Involved"^POA^745.55:AEMNQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",44,0)
 ;;1^Disciplines^21,3,~1;"Discipline"^PAO^745.5:AEMZQ^D POINTER^QAQAHOC2
"RTN","QACADHOC",45,0)
 ;;0^Issue Text^~22;"Issue Text"^
"RTN","QACADHOC",46,0)
 ;;1^Qm Involvement^24,~.01;"QM Involvement"^SOA^1:Tort Claim;2:Incident Report (10-2633);3:Peer Review;4:Board of Investigation;5:Other;^D SET^QAQAHOC2
"RTN","QACADHOC",47,0)
 ;;0^Resolution Comments^~25;"Resolution Comments"^
"RTN","QACADHOC",48,0)
 ;;1^Date Resolved^~26;"Date Resolved"^DAO^::AETS^D DATE^QAQAHOC2
"RTN","QACADHOC",49,0)
 ;;1^Status^~27;"Status"^SOA^O:Open;C:Closed;^D SET^QAQAHOC2
"RTN","QACADHOC",50,0)
 ;;1^Code Status^21,~.01:4;"Code Status"^SOA^1:INACTIVE;N:NATIONAL;L:LOCATION;^D SET^QAQAHOC2
"RTN","QACADHOC",51,0)
 ;;0^Code Definition^21,~.01:5;"Code Definition"
"RTN","QACADHOC",52,0)
 ;;1^Refer to SEAT^~33;"Referred to SEAT"^SOA^Y:YES;N:NO;^D SET^QAQAHOC2
"RTN","QACADHOC",53,0)
 ;;1^Division^~37;"Division"^PAO^4:AEMNQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",54,0)
 ;;1^Level of Satisfaction^~36;"Level of Satisfaction"^SOA^1:Not at all satisfied;2:Slightly satisfied;3:Somewhat satisfied;4:Pretty satisfied;5:Very satisfied;6:Extremely satisifed;^D SET^QAQAHOC2
"RTN","QACADHOC",55,0)
 ;;1^Persian Gulf Service?^~32;"Persian Gulf Service?"^SOA^Y:YES;N:NO;^D SET^QAQAHOC2
"RTN","QACADHOC",56,0)
 ;;1^Period of Service^~31;"Period of Service"^POA^21:AEMNQZ^D POINTER^QAQAHOC2
"RTN","QACADHOC",57,0)
 ;;0^Issue Code Name^21,.01:2;"Issue Code Name"^PAO^745.2:AEMNQZ^
"RTN","QACALRT1")
0^2^B26710451
"RTN","QACALRT1",1,0)
QACALRT1 ;HISC/DAD-PROCESS AN ALERT ;3/23/95  10:22
"RTN","QACALRT1",2,0)
 ;;2.0;Patient Representative;**3,7,6,9,12**;07/25/1995
"RTN","QACALRT1",3,0)
EN ;
"RTN","QACALRT1",4,0)
 N QACDATE
"RTN","QACALRT1",5,0)
 K QACDELET
"RTN","QACALRT1",6,0)
 S QACX=$P(XQADATA,U),QACD0=$P(XQADATA,U,2),QACDUZ=$P(XQADATA,U,3)
"RTN","QACALRT1",7,0)
 S QACXQAID=$P(XQAID,";")
"RTN","QACALRT1",8,0)
 ;
"RTN","QACALRT1",9,0)
 ; Display contact information when alert processed.
"RTN","QACALRT1",10,0)
 S QAC=QACD0,QACRES=0 D START1^QACRPT
"RTN","QACALRT1",11,0)
 ;
"RTN","QACALRT1",12,0)
 S QAC=$S($D(^QA(745.1,QACD0,0))[0:1,$P($G(^(7)),U,2)="C":2,1:0)
"RTN","QACALRT1",13,0)
 I QAC D  G EXIT
"RTN","QACALRT1",14,0)
 . W !!?5,"*** The Patient Rep record associated with this alert"
"RTN","QACALRT1",15,0)
 . W ?63,"***",!?5,"*** has been ",$P("deleted^closed",U,QAC)
"RTN","QACALRT1",16,0)
 . W ".  No response needed, killing alert.",?63,"***",$C(7)
"RTN","QACALRT1",17,0)
 . D KILLALRT
"RTN","QACALRT1",18,0)
 . Q
"RTN","QACALRT1",19,0)
 ;
"RTN","QACALRT1",20,0)
 I $O(^XTMP(QACXQAID,"TXT",0)) D
"RTN","QACALRT1",21,0)
 . W !!?5,"*** You have an unsent response to this alert. ***",$C(7)
"RTN","QACALRT1",22,0)
 . Q
"RTN","QACALRT1",23,0)
 ;
"RTN","QACALRT1",24,0)
 ; Alert action (Respond / Ignore / Delete / Print)
"RTN","QACALRT1",25,0)
 K DIR S QACACTN=""
"RTN","QACALRT1",26,0)
 F  D  Q:QACACTN]""
"RTN","QACALRT1",27,0)
 . S DIR(0)="SOM^R:Respond;I:Ignore;D:Delete;P:Print"
"RTN","QACALRT1",28,0)
 . S DIR("A")="Alert action"
"RTN","QACALRT1",29,0)
 . S DIR("?",1)="  Enter (R)espond to enter your response to this alert."
"RTN","QACALRT1",30,0)
 . S DIR("?",2)="  Enter (I)gnore to save this alert for a later response."
"RTN","QACALRT1",31,0)
 . S DIR("?",3)="  Enter (D)elete to delete this alert without a response."
"RTN","QACALRT1",32,0)
 . S DIR("?",4)="  Enter (P)rint to print the report of contact."
"RTN","QACALRT1",33,0)
 . S DIR("?")="  Enter one of the codes listed above."
"RTN","QACALRT1",34,0)
 . W ! D ^DIR S QACACTN=$S($D(DIRUT):U,1:Y)
"RTN","QACALRT1",35,0)
 . I QACACTN="P" D
"RTN","QACALRT1",36,0)
 .. S QAC=QACD0,QACRES=0
"RTN","QACALRT1",37,0)
 .. N QACD0,QACX,QACXQAID
"RTN","QACALRT1",38,0)
 .. D EN^QACRPT
"RTN","QACALRT1",39,0)
 .. S QACACTN="",DIR("B")="Ignore"
"RTN","QACALRT1",40,0)
 .. Q
"RTN","QACALRT1",41,0)
 . Q
"RTN","QACALRT1",42,0)
 I (QACACTN="I")!(QACACTN=U) D SAVEALRT
"RTN","QACALRT1",43,0)
 I QACACTN="D" S QACDELET=1 D RESPOND,KILLALRT
"RTN","QACALRT1",44,0)
 I QACACTN="R" D RESPOND
"RTN","QACALRT1",45,0)
 G EXIT
"RTN","QACALRT1",46,0)
 ;
"RTN","QACALRT1",47,0)
RESPOND ; Get user's response
"RTN","QACALRT1",48,0)
 I $O(^XTMP(QACXQAID,"TXT",0))'>0 K ^XTMP(QACXQAID)
"RTN","QACALRT1",49,0)
 K DIC,DIWEPSE,DTOUT,DWLW,DWPK
"RTN","QACALRT1",50,0)
 S ^XTMP(QACXQAID,0)=$$FMADD^XLFDT(DT,14)_U_DT
"RTN","QACALRT1",51,0)
 I $G(QACDELET)<1 D
"RTN","QACALRT1",52,0)
 . S DIC="^XTMP("""_QACXQAID_""",""TXT"","
"RTN","QACALRT1",53,0)
 . D EN^DIWE
"RTN","QACALRT1",54,0)
 I $G(QACDELET)=1 D DELMSG
"RTN","QACALRT1",55,0)
 I $O(^XTMP(QACXQAID,"TXT",0))'>0 K ^XTMP(QACXQAID) D SAVEALRT Q
"RTN","QACALRT1",56,0)
 I $D(DTOUT) D  Q
"RTN","QACALRT1",57,0)
 . W $C(7),!
"RTN","QACALRT1",58,0)
 . W !?5,"***     You have timed out while entering a response.     ***"
"RTN","QACALRT1",59,0)
 . W !?5,"*** The text can be recovered if you re-enter the alert.  ***"
"RTN","QACALRT1",60,0)
 . W !?5,"*** If not, it will be automatically purged in two weeks. ***"
"RTN","QACALRT1",61,0)
 . D SAVEALRT
"RTN","QACALRT1",62,0)
 . Q
"RTN","QACALRT1",63,0)
 S QACX(0)=$P($G(^VA(200,QACX,0)),U) I QACX(0)="" S QACX(0)="UNKNOWN"
"RTN","QACALRT1",64,0)
 S QACHDR="***  "_$$FMTE^XLFDT($$NOW^XLFDT,"2PS")_"  "_QACX(0)_"  ***"
"RTN","QACALRT1",65,0)
 S ^XTMP(QACXQAID,"TXT",.1,0)=""
"RTN","QACALRT1",66,0)
 S ^XTMP(QACXQAID,"TXT",.2,0)=QACHDR
"RTN","QACALRT1",67,0)
 S ^XTMP(QACXQAID,"TXT",.3,0)=""
"RTN","QACALRT1",68,0)
 ; Save user's response
"RTN","QACALRT1",69,0)
 W !!,"Saving your response, please wait . . . "
"RTN","QACALRT1",70,0)
 K ^TMP("QACALRT1",$J)
"RTN","QACALRT1",71,0)
 S %X="^XTMP("""_QACXQAID_""",""TXT"","
"RTN","QACALRT1",72,0)
 S %Y="^TMP(""QACALRT1"",$J,"
"RTN","QACALRT1",73,0)
 D %XY^%RCR
"RTN","QACALRT1",74,0)
 S ZTRTN="TASK^QACALRT1",ZTDESC="Patient Rep resolution comments update"
"RTN","QACALRT1",75,0)
 S (ZTSAVE("QACD0"),ZTSAVE("^TMP(""QACALRT1"",$J,"),ZTIO)="",ZTDTH=$H
"RTN","QACALRT1",76,0)
 S (ZTSAVE("QACX"),ZTSAVE("QACDUZ"))=""
"RTN","QACALRT1",77,0)
 S ZTSAVE("QACDELET")=""
"RTN","QACALRT1",78,0)
 D ^%ZTLOAD
"RTN","QACALRT1",79,0)
 W "Done"
"RTN","QACALRT1",80,0)
KILLALRT ; Kill this alert
"RTN","QACALRT1",81,0)
 K ^XTMP(QACXQAID)
"RTN","QACALRT1",82,0)
 S XQAKILL=1
"RTN","QACALRT1",83,0)
 Q
"RTN","QACALRT1",84,0)
SAVEALRT ; Do not kill this alert
"RTN","QACALRT1",85,0)
 K XQAKILL
"RTN","QACALRT1",86,0)
 Q
"RTN","QACALRT1",87,0)
 ;
"RTN","QACALRT1",88,0)
TASK ; Tasked entry point
"RTN","QACALRT1",89,0)
 F  L +^QA(745.1,QACD0):5 Q:$T  H 5
"RTN","QACALRT1",90,0)
 I $D(^QA(745.1,QACD0,0))[0 L -^QA(745.1,QACD0) G EXIT
"RTN","QACALRT1",91,0)
 S (QACD1,QACD1(0))=0
"RTN","QACALRT1",92,0)
 F  S QACD1=$O(^QA(745.1,QACD0,6,QACD1)) Q:QACD1'>0  S QACD1(0)=QACD1
"RTN","QACALRT1",93,0)
 S (QACTMP,QACOUNT)=0
"RTN","QACALRT1",94,0)
 F  S QACTMP=$O(^TMP("QACALRT1",$J,QACTMP)) Q:QACTMP'>0  D
"RTN","QACALRT1",95,0)
 . S QACOUNT=QACOUNT+1
"RTN","QACALRT1",96,0)
 . S ^QA(745.1,QACD0,6,QACD1(0)+QACOUNT,0)=^TMP("QACALRT1",$J,QACTMP,0)
"RTN","QACALRT1",97,0)
 . Q
"RTN","QACALRT1",98,0)
 S QACOUNT=QACOUNT+1
"RTN","QACALRT1",99,0)
 S ^QA(745.1,QACD0,6,QACD1(0)+QACOUNT,0)=""
"RTN","QACALRT1",100,0)
 S QACOUNT=QACOUNT+1
"RTN","QACALRT1",101,0)
 S ^QA(745.1,QACD0,6,QACD1(0)+QACOUNT,0)="***  End of response  ***"
"RTN","QACALRT1",102,0)
 S QACWPHDR=$G(^QA(745.1,QACD0,6,0))
"RTN","QACALRT1",103,0)
 S $P(QACWPHDR,U,3)=($P(QACWPHDR,U,3)+QACOUNT)
"RTN","QACALRT1",104,0)
 S $P(QACWPHDR,U,4)=($P(QACWPHDR,U,4)+QACOUNT)
"RTN","QACALRT1",105,0)
 S $P(QACWPHDR,U,5)=DT
"RTN","QACALRT1",106,0)
 S ^QA(745.1,QACD0,6,0)=QACWPHDR
"RTN","QACALRT1",107,0)
 L -^QA(745.1,QACD0)
"RTN","QACALRT1",108,0)
 S QACX(0)=$P($G(^VA(200,+QACX,0)),U) S:QACX(0)="" QACX(0)="UNKNOWN"
"RTN","QACALRT1",109,0)
 S QACCASE=$P($G(^QA(745.1,+QACD0,0)),U) S:QACCASE="" QACCASE="UNKNOWN"
"RTN","QACALRT1",110,0)
 S XQA(+QACDUZ)=""
"RTN","QACALRT1",111,0)
 S XQAMSG="Patient Rep response by "_QACX(0)_" to "_QACCASE_"."
"RTN","QACALRT1",112,0)
 I $G(QACDELET)=1 S XQAMSG="Patient Rep Alert "_QACCASE_" deleted by "_QACX(0)_"."
"RTN","QACALRT1",113,0)
 D SETUP^XQALERT
"RTN","QACALRT1",114,0)
 ;D SET^QACALRT0(+QACDUZ,QACD0)
"RTN","QACALRT1",115,0)
EXIT ;
"RTN","QACALRT1",116,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACALRT1",117,0)
 K DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,QAC,QACACTN,QACCASE,QACD0,QACD1
"RTN","QACALRT1",118,0)
 K QACDUZ,QACEE,QACHDR,QACOUNT,QACRES,QACTMP,QACWPHDR,QACX,QACXQAID,X,Y
"RTN","QACALRT1",119,0)
 K ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,^TMP("QACALRT1",$J),%X,%Y
"RTN","QACALRT1",120,0)
 Q
"RTN","QACALRT1",121,0)
DELMSG ;If user deletes an alert on a report of contact a message is sent
"RTN","QACALRT1",122,0)
 ;as if it were a response to the alert.  It will be stored in the 
"RTN","QACALRT1",123,0)
 ;Resolution Comments field.
"RTN","QACALRT1",124,0)
 S $P(^XTMP(QACXQAID,"TXT",0),U,5)=DT
"RTN","QACALRT1",125,0)
 F QACEE=3,4  S $P(^XTMP(QACXQAID,"TXT",0),U,QACEE)=$P(^XTMP(QACXQAID,"TXT",0),U,QACEE)+1
"RTN","QACALRT1",126,0)
 S Y=DT D DD^%DT S QACDATE=Y
"RTN","QACALRT1",127,0)
 S QACNAME=$P($P(^VA(200,DUZ,0),U),",",2)_" "_$P($P(^VA(200,DUZ,0),U),",")
"RTN","QACALRT1",128,0)
 S ^XTMP(QACXQAID,"TXT",1,0)="VA Alert on Report of Contact "_$P(QACXQAID,"-",2)_" deleted by "_QACNAME_" on "_QACDATE
"RTN","QACALRT1",129,0)
 Q
"RTN","QACCSSTD")
0^3^B59372805
"RTN","QACCSSTD",1,0)
QACCSSTD  ;WCIOFO/ERC - Routine for CSS totals ;8/16/97
"RTN","QACCSSTD",2,0)
 ;;2.0;Patient Representative;**3,5,7,9,12**;07/25/1995
"RTN","QACCSSTD",3,0)
DATE ; Establish date range
"RTN","QACCSSTD",4,0)
 K QACDVTOT
"RTN","QACCSSTD",5,0)
 N QACCSS,QACDC,QACDFLG,QACISS,QACNODIV,QACSFLG,QACSRV,QACSV,QACYES
"RTN","QACCSSTD",6,0)
 S QACRTN="QACCSSTD"
"RTN","QACCSSTD",7,0)
 S QACDESC="Customer Service Standards Totals"
"RTN","QACCSSTD",8,0)
 S (QACSUM,QACYES)=0
"RTN","QACCSSTD",9,0)
 S DIR(0)="SOA^D:Detailed;S:Summary"
"RTN","QACCSSTD",10,0)
 S DIR("A")="Select report format: "
"RTN","QACCSSTD",11,0)
 S DIR("A",1)="Report Format (D)etailed or (S)ummary:"
"RTN","QACCSSTD",12,0)
 S DIR("?")="Select ""D"" for detailed or ""S"" for summary."
"RTN","QACCSSTD",13,0)
 D ^DIR Q:$D(DIRUT)
"RTN","QACCSSTD",14,0)
 K DIR
"RTN","QACCSSTD",15,0)
 I Y="S" S QACSUM=1
"RTN","QACCSSTD",16,0)
 D DATDIV^QACUTL0 Q:$G(QAQPOP)=1
"RTN","QACCSSTD",17,0)
 I $G(QACDV)=0!($G(QACDV)']"") S QACNODIV=1
"RTN","QACCSSTD",18,0)
 I $G(QACSUM)=1 G TASK
"RTN","QACCSSTD",19,0)
 S DIR(0)="YOA"
"RTN","QACCSSTD",20,0)
 S DIR("A")="Do you want to print this report for just one Discipline? "
"RTN","QACCSSTD",21,0)
 S DIR("B")="No"
"RTN","QACCSSTD",22,0)
 S DIR("?")="Enter 'YES' if you prefer to print this report for one specific Discipline."
"RTN","QACCSSTD",23,0)
 D ^DIR Q:$D(DIRUT)  I Y=1 D DISC
"RTN","QACCSSTD",24,0)
 I QACYES=0 D
"RTN","QACCSSTD",25,0)
 . S DIR("A")="Do you want to print this report for just one Service/Discipline? "
"RTN","QACCSSTD",26,0)
 . S DIR("B")="No"
"RTN","QACCSSTD",27,0)
 . S DIR("?")="Enter 'Yes' if you prefer to print this report for one Service/Discipline."
"RTN","QACCSSTD",28,0)
 . D ^DIR Q:$D(DIRUT)
"RTN","QACCSSTD",29,0)
 . I Y=1 D SERV
"RTN","QACCSSTD",30,0)
 Q:$D(DIRUT)
"RTN","QACCSSTD",31,0)
TASK ;
"RTN","QACCSSTD",32,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS G:POP EXIT
"RTN","QACCSSTD",33,0)
 I $D(IO("Q")) D  G EXIT
"RTN","QACCSSTD",34,0)
 . S (ZTSAVE("QACD0"),ZTSAVE("QAISS"),ZTSAVE("QACISSC"))=""
"RTN","QACCSSTD",35,0)
 . S ZTSAVE("QACSTD")=""
"RTN","QACCSSTD",36,0)
 . S (ZTSAVE("QACSFLG"),ZTSAVE("QACDFLG"))=""
"RTN","QACCSSTD",37,0)
 . S (ZTSAVE("QACDIS"),ZTSAVE("QACSVD"))=""
"RTN","QACCSSTD",38,0)
 . S ZTDESC=QACDESC
"RTN","QACCSSTD",39,0)
 . S ZTSAVE("QACCSS")=""
"RTN","QACCSSTD",40,0)
 . S ZTSAVE("QACRTN")=""
"RTN","QACCSSTD",41,0)
 . S ZTSAVE("QACSTD")=""
"RTN","QACCSSTD",42,0)
 . S ZTSAVE("QAQRANG")=""
"RTN","QACCSSTD",43,0)
 . S ZTSAVE("QACSUM")=""
"RTN","QACCSSTD",44,0)
 . S ZTSAVE("QACEE")=""
"RTN","QACCSSTD",45,0)
 . S ZTRTN="TSK^QACCSSTD"
"RTN","QACCSSTD",46,0)
 . D TASK^QACUTL0
"RTN","QACCSSTD",47,0)
 . Q
"RTN","QACCSSTD",48,0)
TSK ; Get data for totaling
"RTN","QACCSSTD",49,0)
 U IO
"RTN","QACCSSTD",50,0)
INIT ; set up counters for each CSS, discipline and for the total count
"RTN","QACCSSTD",51,0)
 D SETUP^QACEMPE
"RTN","QACCSSTD",52,0)
 ;set up local array for CSS in external format
"RTN","QACCSSTD",53,0)
 S QACAA=0
"RTN","QACCSSTD",54,0)
 F  S QACAA=$O(^QA(745.6,QACAA)) Q:QACAA'>0  D
"RTN","QACCSSTD",55,0)
 . S QACSTD(QACAA)=$P(^QA(745.6,QACAA,0),U,2)
"RTN","QACCSSTD",56,0)
 S QACROU="SET^QACCSSTD"
"RTN","QACCSSTD",57,0)
 ;loop through "D" cross-reference (date)
"RTN","QACCSSTD",58,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACCSSTD",59,0)
 I $G(QACSUM)=1 D PRINTSUM D EXIT Q
"RTN","QACCSSTD",60,0)
 D PRINT
"RTN","QACCSSTD",61,0)
 D EXIT
"RTN","QACCSSTD",62,0)
 Q
"RTN","QACCSSTD",63,0)
SET ;
"RTN","QACCSSTD",64,0)
 S QACDDV=$P(^QA(745.1,QACD0,0),U,16)
"RTN","QACCSSTD",65,0)
 D INST^QACUTL0(QACDDV,.QACDDD)
"RTN","QACCSSTD",66,0)
 I $G(QAC1DIV)]"" I $G(QAC1DIV)'=$G(QACDDV) Q
"RTN","QACCSSTD",67,0)
 S QACDDV=QACDDD
"RTN","QACCSSTD",68,0)
 ;if not integrated division set to 0 for sorting purposes in ^TMP
"RTN","QACCSSTD",69,0)
 S QACDDV=$S($G(QACNODIV)'=1:$G(QACDDV,"Unknown"),1:0)
"RTN","QACCSSTD",70,0)
 ;loops through the issue code multiple
"RTN","QACCSSTD",71,0)
 K QACIC
"RTN","QACCSSTD",72,0)
 D ISSLOOP^QACBYLOC
"RTN","QACCSSTD",73,0)
 I '$D(QACIC) Q
"RTN","QACCSSTD",74,0)
 S QACAA=0
"RTN","QACCSSTD",75,0)
 F  S QACAA=$O(QACIC(QACAA)) Q:QACAA'>0  D
"RTN","QACCSSTD",76,0)
 . Q:'$D(^QA(745.2,QACIC(QACAA),0))
"RTN","QACCSSTD",77,0)
 . S QACCSS=$P(^QA(745.2,QACIC(QACAA),0),U,7) Q:QACCSS']""
"RTN","QACCSSTD",78,0)
 . S QACCSS=$P(^QA(745.6,QACCSS,0),U,2)
"RTN","QACCSSTD",79,0)
 . I $G(QACSUM)=1 D COUNTSUM Q
"RTN","QACCSSTD",80,0)
 . S QACBB=0,QACQUT=""
"RTN","QACCSSTD",81,0)
 . F  S QACBB=$O(^QA(745.1,QACD0,3,QACAA,3,QACBB)) Q:(QACBB'>0)&(QACBB]"")  Q:$G(QACQUT)  D
"RTN","QACCSSTD",82,0)
 . . I $G(QACBB)'>0 I ($G(QACDFLG)=1!$G(QACSFLG)=1) S QACQUT=1 Q
"RTN","QACCSSTD",83,0)
 . . I $G(QACBB)'>0 S (QACSVD,QACDIS)="Unknown",QACQUT=1 G COUNT
"RTN","QACCSSTD",84,0)
 . . S QACNODE=^QA(745.1,QACD0,3,QACAA,3,QACBB,0)
"RTN","QACCSSTD",85,0)
 . . S QACSVD=$P(^QA(745.55,$P(QACNODE,U),0),U) Q:$G(QACSVD)']""
"RTN","QACCSSTD",86,0)
 . . I $G(QACSFLG)=1 I $G(QACSRV)'=$P(QACNODE,U) Q
"RTN","QACCSSTD",87,0)
 . . I $P(QACNODE,U,2)]"" S QACDIS=$P(^QA(745.5,$P(QACNODE,U,2),0),U,2) Q:$G(QACDIS)']""
"RTN","QACCSSTD",88,0)
 . . I $P(QACNODE,U,2)']"" S QACDIS="Unknown"
"RTN","QACCSSTD",89,0)
 . . I $P(QACNODE,U,2)']"",($G(QACDISC)]"") Q  ;if discipline
"RTN","QACCSSTD",90,0)
 . . ;is unknown, there will be no match with the one discipline
"RTN","QACCSSTD",91,0)
 . . ;in variable QACDISC
"RTN","QACCSSTD",92,0)
 . . I $G(QACDFLG)=1 I $G(QACDISC)'=$P(^QA(745.5,$P(QACNODE,U,2),0),U) Q
"RTN","QACCSSTD",93,0)
COUNT . . ;counts for detailed report
"RTN","QACCSSTD",94,0)
 . . S QACTOT=$G(QACTOT)+1
"RTN","QACCSSTD",95,0)
 . . I $G(QACDDV)]"" S QACDVTOT(QACDDV)=$G(QACDVTOT(QACDDV))+1
"RTN","QACCSSTD",96,0)
 . . S ^TMP(QACRTN,$J,QACDDV,QACSVD,QACDIS,QACCSS)=$G(^TMP(QACRTN,$J,QACDDV,QACSVD,QACDIS,QACCSS))+1
"RTN","QACCSSTD",97,0)
 . . S ^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD)=$G(^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD))+1
"RTN","QACCSSTD",98,0)
 . .S ^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD,QACDIS)=$G(^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD,QACDIS))+1
"RTN","QACCSSTD",99,0)
 Q
"RTN","QACCSSTD",100,0)
PRINT ;print routine for detailed report
"RTN","QACCSSTD",101,0)
 U IO
"RTN","QACCSSTD",102,0)
 S QACEE=""
"RTN","QACCSSTD",103,0)
 F  S QACEE=$O(^TMP(QACRTN,$J,QACEE)) Q:QACEE']""  D  Q:QACQUIT
"RTN","QACCSSTD",104,0)
 . I QACEE="COUNT" Q
"RTN","QACCSSTD",105,0)
 . S QACFF=""
"RTN","QACCSSTD",106,0)
 . F  S QACFF=$O(^TMP(QACRTN,$J,QACEE,QACFF)) Q:QACFF']""  D  Q:QACQUIT
"RTN","QACCSSTD",107,0)
 . . D HEAD
"RTN","QACCSSTD",108,0)
 . . I $G(QACEE)'=0 W !?5,"Total for Division: "_QACEE_"    "_QACDVTOT(QACEE)
"RTN","QACCSSTD",109,0)
 . . I $G(QACFF)'=0 W !?5,"Total for Service/Discipline: "_QACFF_"    "_^TMP(QACRTN,$J,"COUNT",QACEE,QACFF)
"RTN","QACCSSTD",110,0)
 . . S QACGG=""
"RTN","QACCSSTD",111,0)
 . . F  S QACGG=$O(^TMP(QACRTN,$J,QACEE,QACFF,QACGG)) Q:QACGG']""  D  Q:QACQUIT
"RTN","QACCSSTD",112,0)
 . . . I $G(QACGG)'=0 W !?5,"Total for Discipline: "_QACGG_"    "_^TMP(QACRTN,$J,"COUNT",QACEE,QACFF,QACGG),!
"RTN","QACCSSTD",113,0)
 . . . S QACHH=""
"RTN","QACCSSTD",114,0)
 . . . F  S QACHH=$O(QACSTD(QACHH)) Q:QACHH']""  D  Q:QACQUIT
"RTN","QACCSSTD",115,0)
 . . . . I $Y>(IOSL-6) D HEAD Q:QACQUIT  I $G(QACEE)'=0 W !?5,"Division: ",QACEE
"RTN","QACCSSTD",116,0)
 . . . . W !?10,QACSTD(QACHH),?50,$G(^TMP(QACRTN,$J,QACEE,QACFF,QACGG,QACSTD(QACHH)),0)
"RTN","QACCSSTD",117,0)
 W:$G(QACTOT)>0 !!?20,"Grand Total: "_QACTOT
"RTN","QACCSSTD",118,0)
 I '$D(^TMP(QACRTN,$J)) D
"RTN","QACCSSTD",119,0)
 . D HEAD
"RTN","QACCSSTD",120,0)
 . W !!!?25,"No data to report."
"RTN","QACCSSTD",121,0)
 Q
"RTN","QACCSSTD",122,0)
HEAD ;
"RTN","QACCSSTD",123,0)
 S QACPAGE=$G(QACPAGE)+1
"RTN","QACCSSTD",124,0)
 I QACPAGE>1 D  Q:QACQUIT
"RTN","QACCSSTD",125,0)
 . W $C(7)
"RTN","QACCSSTD",126,0)
 . I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR S QACQUIT=$S(Y'>0:1,1:0)
"RTN","QACCSSTD",127,0)
 W:$E(IOST)="C"!(QACPAGE>1) @IOF
"RTN","QACCSSTD",128,0)
 W !,QACDESC,?48,QACTODAY,?70,"PAGE ",QACPAGE
"RTN","QACCSSTD",129,0)
 W !,"Date "_QAQRANG
"RTN","QACCSSTD",130,0)
 W !,$S($G(QACSUM)=1:"SUMMARY",1:"DETAILED")," Report"
"RTN","QACCSSTD",131,0)
 W !?51,"NUMBER OF"
"RTN","QACCSSTD",132,0)
 W !?10,"CUSTOMER SERVICE STANDARD",?50,"OCCURRENCES"
"RTN","QACCSSTD",133,0)
 W !,QACUNDL,!
"RTN","QACCSSTD",134,0)
 Q
"RTN","QACCSSTD",135,0)
EXIT ;
"RTN","QACCSSTD",136,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACCSSTD",137,0)
 K ^TMP(QACRTN,$J)
"RTN","QACCSSTD",138,0)
 K QAC1DIV,QACCSS,QACD0,QACDCNT,QACDESC,QACDDD,QACDDV,QACDFLG,QACDV
"RTN","QACCSSTD",139,0)
 K QACDVTOT,QACDIS,QACDISC,QACIC,QACNODE,QACPAGE,QACQUIT,QACQUT
"RTN","QACCSSTD",140,0)
 K QACROU,QACRTN,QACSFLG,QACSTD,QACSUM,QACSVD,QACTODAY,QACTOT,QACUNDL
"RTN","QACCSSTD",141,0)
 K QACAA,QACBB,QACDD,QACEE,QACFF,QACGG,QACHH
"RTN","QACCSSTD",142,0)
 K QAQNBEG,QAQNEND,QAQPOP,QAQRANG
"RTN","QACCSSTD",143,0)
 K DIR,DIRUT,POP,ZTSAVE,ZTDESC,ZTRTN
"RTN","QACCSSTD",144,0)
 D K^QAQDATE
"RTN","QACCSSTD",145,0)
 Q
"RTN","QACCSSTD",146,0)
DISC ; Select one discipline for this report
"RTN","QACCSSTD",147,0)
 K DIR
"RTN","QACCSSTD",148,0)
 S DIR(0)="FAO^^K:X'?2U X"
"RTN","QACCSSTD",149,0)
 S DIR("A")="Enter the Discipline as a two letter abbreviation: "
"RTN","QACCSSTD",150,0)
 D ^DIR K DIR Q:$D(DIRUT)!($D(DIROUT))
"RTN","QACCSSTD",151,0)
 I $O(^QA(745.5,"B",Y,0)) S QACDISC=Y,QACDFLG=1,QACYES=1
"RTN","QACCSSTD",152,0)
 E  D  G DISC
"RTN","QACCSSTD",153,0)
 . W !!,"Not a valid Discipline, choose from:"
"RTN","QACCSSTD",154,0)
 . S QACEE=0
"RTN","QACCSSTD",155,0)
 . F  S QACEE=$O(^QA(745.5,QACEE)) Q:QACEE'>0  D
"RTN","QACCSSTD",156,0)
 . . W !?5,$P(^QA(745.5,QACEE,0),U),"   (",$P(^QA(745.5,QACEE,0),U,2),")"
"RTN","QACCSSTD",157,0)
 Q
"RTN","QACCSSTD",158,0)
SERV ; Select one Service/Discipline for this report
"RTN","QACCSSTD",159,0)
 K DIR
"RTN","QACCSSTD",160,0)
 S DIR(0)="POA^745.55:EMZ"
"RTN","QACCSSTD",161,0)
 S DIR("A")="Enter the Service/Discipline: "
"RTN","QACCSSTD",162,0)
 D ^DIR K DIR Q:$D(DIRUT)!($D(DIROUT))
"RTN","QACCSSTD",163,0)
 I $G(^QA(745.55,+Y,0))]"" S QACSRV=+Y,QACSFLG=1
"RTN","QACCSSTD",164,0)
 E  D  G SERV
"RTN","QACCSSTD",165,0)
 . W !!,"Not a valid service/discipline.  Try again."
"RTN","QACCSSTD",166,0)
 Q 
"RTN","QACCSSTD",167,0)
COUNTSUM ;counts for summary report
"RTN","QACCSSTD",168,0)
 S QACBB=0
"RTN","QACCSSTD",169,0)
 F  S QACBB=$O(^QA(745.1,QACD0,3,QACAA,3,QACBB)) Q:QACBB'>0  D
"RTN","QACCSSTD",170,0)
 . S ^TMP(QACRTN,$J,"TOT")=$G(^TMP(QACRTN,$J,"TOT"))+1
"RTN","QACCSSTD",171,0)
 . S ^TMP(QACRTN,$J,"TOT",QACDDV)=$G(^TMP(QACRTN,$J,"TOT",QACDDV))+1
"RTN","QACCSSTD",172,0)
 . S ^TMP(QACRTN,$J,"SUM",QACDDV,QACCSS)=$G(^TMP(QACRTN,$J,"SUM",QACDDV,QACCSS))+1
"RTN","QACCSSTD",173,0)
 . S ^TMP(QACRTN,$J,"SUMCSS",QACCSS)=$G(^TMP(QACRTN,$J,"SUMCSS",QACCSS))+1
"RTN","QACCSSTD",174,0)
 Q
"RTN","QACCSSTD",175,0)
PRINTSUM ;print routine for summary report
"RTN","QACCSSTD",176,0)
 U IO
"RTN","QACCSSTD",177,0)
 D HEAD
"RTN","QACCSSTD",178,0)
 I '$D(^TMP(QACRTN,$J)) D  Q
"RTN","QACCSSTD",179,0)
 . W !!!?25,"No data to report."
"RTN","QACCSSTD",180,0)
 S QACDCN=0,QACEE=""
"RTN","QACCSSTD",181,0)
 F  S QACEE=$O(^TMP(QACRTN,$J,"SUM",QACEE)) Q:QACEE']""  D  Q:QACQUIT
"RTN","QACCSSTD",182,0)
 . S QACDCNT=$G(QACDCNT)+1
"RTN","QACCSSTD",183,0)
 . I $G(QACEE)=0,($D(QAC1DIV)) W !?5,"For all Divisions"
"RTN","QACCSSTD",184,0)
 . I $G(QACEE)'=0 W !?5,"Division: ",QACEE
"RTN","QACCSSTD",185,0)
 . S QACGG=""
"RTN","QACCSSTD",186,0)
 . F  S QACGG=$O(QACSTD(QACGG)) Q:QACGG']""  D
"RTN","QACCSSTD",187,0)
 . . I $Y>(IOSL-6) D HEAD Q:QACQUIT  I $G(QACEE)'=0 W !?5,"Division: ",QACEE
"RTN","QACCSSTD",188,0)
 . . W !?10,QACSTD(QACGG),?55,$G(^TMP(QACRTN,$J,"SUM",QACEE,QACSTD(QACGG)),0)
"RTN","QACCSSTD",189,0)
 . W !?53,"-----"
"RTN","QACCSSTD",190,0)
 . W !?45,"TOTAL:",?55,^TMP(QACRTN,$J,"TOT",QACEE)
"RTN","QACCSSTD",191,0)
 I $G(QACDCNT)>1 D
"RTN","QACCSSTD",192,0)
 . I $Y>(IOSL-6) D HEAD Q:QACQUIT  I $G(QACEE)'=0 W !?5,"Division: ",QACEE
"RTN","QACCSSTD",193,0)
 . W !!!?5,"Totals for all Divisions:"
"RTN","QACCSSTD",194,0)
 . S QACFF=""
"RTN","QACCSSTD",195,0)
 . F  S QACFF=$O(QACSTD(QACFF)) Q:QACFF']""  D
"RTN","QACCSSTD",196,0)
 . . I $Y>(IOSL-6) D HEAD Q:QACQUIT
"RTN","QACCSSTD",197,0)
 . . W !?10,QACSTD(QACFF),?55,$G(^TMP(QACRTN,$J,"SUMCSS",QACSTD(QACFF)),0)
"RTN","QACCSSTD",198,0)
 . W !?53,"-----"
"RTN","QACCSSTD",199,0)
 . W !?38,"GRAND TOTAL:",?55,^TMP(QACRTN,$J,"TOT")
"RTN","QACCSSTD",200,0)
 Q
"RTN","QACNEWSV")
0^4^B1111653
"RTN","QACNEWSV",1,0)
QACNEWSV ;WCIOFO/ERC-Enter a new Service/Discipline ;9/13/97
"RTN","QACNEWSV",2,0)
 ;;2.0;Patient Representative;**3,5,12**;07/25/1995
"RTN","QACNEWSV",3,0)
 ;This routine allows Patient Advocates to make new entries in the
"RTN","QACNEWSV",4,0)
 ;Service/Discipline file (#745.55)
"RTN","QACNEWSV",5,0)
 S DIC="^QA(745.55,"
"RTN","QACNEWSV",6,0)
 S DIC(0)="AEL"
"RTN","QACNEWSV",7,0)
 S DIC("A")="Enter a new Service/Discipline: "
"RTN","QACNEWSV",8,0)
 S DLAYGO=745.55
"RTN","QACNEWSV",9,0)
 D ^DIC
"RTN","QACNEWSV",10,0)
 K DLAYGO
"RTN","QACNEWSV",11,0)
 Q:$G(Y)<0
"RTN","QACNEWSV",12,0)
 S DIE=DIC,DR=".01;1;2;3"
"RTN","QACNEWSV",13,0)
 S (DA,QACDA)=+Y
"RTN","QACNEWSV",14,0)
 D ^DIE
"RTN","QACNEWSV",15,0)
 ; if user does not enter a Discipline, display a message and give 
"RTN","QACNEWSV",16,0)
 ; another chance
"RTN","QACNEWSV",17,0)
 I $P(^QA(745.55,QACDA,0),U,3)']"" D
"RTN","QACNEWSV",18,0)
 . W !!?5,"Service/Discipline must point to a Discipline.",!
"RTN","QACNEWSV",19,0)
 . S DR="2;3" D ^DIE
"RTN","QACNEWSV",20,0)
 ; if still no discipline display a message & delete Service/Discipline
"RTN","QACNEWSV",21,0)
 I $P(^QA(745.55,QACDA,0),U,3)']"" D
"RTN","QACNEWSV",22,0)
 . W !!?5,"No Discipline entered - deleting Service/Discipline.",!
"RTN","QACNEWSV",23,0)
 . S DIK=DIE,DA=QACDA D ^DIK
"RTN","QACNEWSV",24,0)
 K DA,DIC,DIE,DR,QACDA
"RTN","QACNEWSV",25,0)
 Q
"RTN","QACSPRD")
0^5^B8609405
"RTN","QACSPRD",1,0)
QACSPRD ;HISC/CEW - Spreadsheet reports ;7/17/95  11:04
"RTN","QACSPRD",2,0)
 ;;2.0;Patient Representative;**3,9,12**;07/25/1995
"RTN","QACSPRD",3,0)
DATE ;
"RTN","QACSPRD",4,0)
 N QACIFLG,QACXFLG
"RTN","QACSPRD",5,0)
 S QAQPOP=0
"RTN","QACSPRD",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACSPRD",7,0)
BEGIN ;
"RTN","QACSPRD",8,0)
 K DIR
"RTN","QACSPRD",9,0)
 S DIR(0)="NA^1:13"
"RTN","QACSPRD",10,0)
 W !!?5,"1   Contact made by (#C)",!?5,"2   Issue Headers (#I)",!?5,"3   Issues"
"RTN","QACSPRD",11,0)
 W !?5,"4   Location (#I)"
"RTN","QACSPRD",12,0)
 W !?5,"5   Service (Old field - Service field de-activated 10/97 - #I)"
"RTN","QACSPRD",13,0)
 W !?5,"6   Service/Discipline (#I)",!?5,"7   Sex (#I)"
"RTN","QACSPRD",14,0)
 W !?5,"8   Contact Source (#C)",!?5,"9   Treatment Status (#C)"
"RTN","QACSPRD",15,0)
 W !?5,"10  Treatment Status (#I)",!?5,"11  Discipline (#I)"
"RTN","QACSPRD",16,0)
 W !?5,"12  Division (#C)",!?5,"13  Division (#I)",!!
"RTN","QACSPRD",17,0)
 S DIR("A")="Print Spreadsheet Totals for: "
"RTN","QACSPRD",18,0)
 S DIR("?")="     Select the number or item you want totalled."
"RTN","QACSPRD",19,0)
 S DIR("?",1)="     #I means total is by Issues. #C means total is by Contacts."
"RTN","QACSPRD",20,0)
 S DIR("?",2)="     Enter ""^"" or <RET> to exit."
"RTN","QACSPRD",21,0)
 D ^DIR K DIR G:$D(DIRUT)!$D(DIROUT) EXIT S QACITEM=Y
"RTN","QACSPRD",22,0)
 K COUNT,QACPCE,QACLABEL,QACDIV
"RTN","QACSPRD",23,0)
 N QACRTN
"RTN","QACSPRD",24,0)
 I QACITEM=1 D CONTACT^QACSPRD1
"RTN","QACSPRD",25,0)
 I QACITEM=2 D HEAD^QACSPRD3
"RTN","QACSPRD",26,0)
 I QACITEM=3 D CODE^QACSPRD2
"RTN","QACSPRD",27,0)
 I QACITEM=4 D LOC^QACSPRD2
"RTN","QACSPRD",28,0)
 I QACITEM=5 D SERVICE^QACSPRD2
"RTN","QACSPRD",29,0)
 I QACITEM=6 D SRVDS^QACSPRD3
"RTN","QACSPRD",30,0)
 I QACITEM=7 D SEX^QACSPRD3
"RTN","QACSPRD",31,0)
 I QACITEM=8 D SOURCE^QACSPRD1
"RTN","QACSPRD",32,0)
 I QACITEM=9 D TREATC^QACSPRD1
"RTN","QACSPRD",33,0)
 I QACITEM=10 D TREATI^QACSPRD1
"RTN","QACSPRD",34,0)
 I QACITEM=11 D DISC^QACSPRD2
"RTN","QACSPRD",35,0)
 I QACITEM=12 D DIVC^QACSPRD3
"RTN","QACSPRD",36,0)
 I QACITEM=13 D DIVI^QACSPRD3
"RTN","QACSPRD",37,0)
 K DIR S DIR(0)="E" D ^DIR G EXIT:$D(DIRUT),DATE
"RTN","QACSPRD",38,0)
EXIT ;
"RTN","QACSPRD",39,0)
 K DIR,DIROUT,DIRUT,POP,Y
"RTN","QACSPRD",40,0)
 K QAC1DIV,QACDT,QACITEM,QACNUM,QACPOP,QAQPOP,QACWW
"RTN","QACSPRD",41,0)
 D K^QAQDATE
"RTN","QACSPRD",42,0)
 Q
"RTN","QACSPRD",43,0)
LOOP1(ROU,NBEG,NEND,QACD0) ;loop through #745.1 within the date range
"RTN","QACSPRD",44,0)
 S QACDT=NBEG-.0000001 F  S QACDT=$O(^QA(745.1,"D",QACDT)) Q:(QACDT'>0)!(QACDT>NEND)!(QACDT\1'?7N)  D
"RTN","QACSPRD",45,0)
 . S QACD0=0 F  S QACD0=$O(^QA(745.1,"D",QACDT,QACD0)) Q:QACD0'>0  D
"RTN","QACSPRD",46,0)
 . . S QACDIV=$P(^QA(745.1,QACD0,0),U,16)
"RTN","QACSPRD",47,0)
 . . I $G(QACDIV)']"" S QACDIV=0
"RTN","QACSPRD",48,0)
 . . S QACWW=""
"RTN","QACSPRD",49,0)
 . . I $O(^QA(740,1,"QAC2","B",QACDIV,QACWW))']"" S QACDIV=0
"RTN","QACSPRD",50,0)
 . . I $G(QAC1DIV)]"" I $G(QACDIV)=$G(QAC1DIV) D @ROU
"RTN","QACSPRD",51,0)
 . . I $G(QAC1DIV)']"" D @ROU
"RTN","QACSPRD",52,0)
 Q
"RTN","QACSPRD",53,0)
ZIS1(ZTRTN,DESC,XFLG) ;subroutine sets up and calls ^%ZIS and ^%ZTLOAD
"RTN","QACSPRD",54,0)
 K QACXFLG
"RTN","QACSPRD",55,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS I POP S QACPOP=1 Q
"RTN","QACSPRD",56,0)
 I $D(IO("Q")) D
"RTN","QACSPRD",57,0)
 . S (ZTSAVE("QAQNBEG"),ZTSAVE("QAQNEND"))=""
"RTN","QACSPRD",58,0)
 . S (ZTSAVE("QAC1DIV"),ZTSAVE("QACDIV"),ZTSAVE("QAQPOP"))=""
"RTN","QACSPRD",59,0)
 . S (ZTSAVE("QACTITLE"),ZTSAVE("QACIFLG"))=""
"RTN","QACSPRD",60,0)
 . I $G(QACIFLG)=1 K ^TMP("QACSPRD2",$J)
"RTN","QACSPRD",61,0)
 . I $G(QACIFLG)=1 S (ZTSAVE("^TMP(""QACSPRD2"",$J,"),ZTSAVE("QACODE"))=""
"RTN","QACSPRD",62,0)
 . S ZTDESC="Patient Rep "_DESC_"Spreadsheet Report"
"RTN","QACSPRD",63,0)
 . D ^%ZTLOAD S QACXFLG=1
"RTN","QACSPRD",64,0)
 Q
"RTN","QACSPRD2")
0^6^B34198846
"RTN","QACSPRD2",1,0)
QACSPRD2 ;HINES/CEW - Spreadsheet report selections ;7/17/95  11:17
"RTN","QACSPRD2",2,0)
 ;;2.0;Patient Representative;**3,9,12**;07/25/1995
"RTN","QACSPRD2",3,0)
CODE ;
"RTN","QACSPRD2",4,0)
 ;Sub-routine to count total number of issues for each issue code
"RTN","QACSPRD2",5,0)
 S QACTITLE="Issue Code "
"RTN","QACSPRD2",6,0)
 S QACRTN="CODETSK^QACSPRD2"
"RTN","QACSPRD2",7,0)
 S QACIFLG=1
"RTN","QACSPRD2",8,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACD0) G:$G(QACPOP) EXIT
"RTN","QACSPRD2",9,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD2",10,0)
CODETSK ;
"RTN","QACSPRD2",11,0)
 ;Tasked entry point for CODE
"RTN","QACSPRD2",12,0)
 S QACROU="CODETSK1^QACSPRD2"
"RTN","QACSPRD2",13,0)
 D TSK
"RTN","QACSPRD2",14,0)
 Q
"RTN","QACSPRD2",15,0)
CODETSK1 ;
"RTN","QACSPRD2",16,0)
 D ICLOOP
"RTN","QACSPRD2",17,0)
 S QACRR=0
"RTN","QACSPRD2",18,0)
 F  S QACRR=$O(QACODE(QACRR)) Q:QACRR']""  D
"RTN","QACSPRD2",19,0)
 . I '$D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",20,0)
 . I $D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDIV,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",21,0)
 . Q
"RTN","QACSPRD2",22,0)
 Q
"RTN","QACSPRD2",23,0)
LOC ;
"RTN","QACSPRD2",24,0)
 ;Sub-routine to count total number of issues for Location of Event
"RTN","QACSPRD2",25,0)
 S QACTITLE="Location "
"RTN","QACSPRD2",26,0)
 S QACRTN="LOCTSK^QACSPRD2"
"RTN","QACSPRD2",27,0)
 S QACIFLG=1
"RTN","QACSPRD2",28,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACD0) G:$G(QACPOP) EXIT
"RTN","QACSPRD2",29,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD2",30,0)
LOCTSK ;
"RTN","QACSPRD2",31,0)
 ;Tasked entry point for LOC
"RTN","QACSPRD2",32,0)
 S QACROU="LOCTSK1^QACSPRD2"
"RTN","QACSPRD2",33,0)
 D TSK
"RTN","QACSPRD2",34,0)
 Q
"RTN","QACSPRD2",35,0)
LOCTSK1 ;
"RTN","QACSPRD2",36,0)
 D ICLOOP
"RTN","QACSPRD2",37,0)
 S QACLNUM=$P(^QA(745.1,QACD0,0),U,12) Q:QACLNUM=""  D
"RTN","QACSPRD2",38,0)
 . S QACLOC=$P($G(^SC(+QACLNUM,0)),U,1)
"RTN","QACSPRD2",39,0)
 Q:$G(QACLOC)']""
"RTN","QACSPRD2",40,0)
 S QACRR=0
"RTN","QACSPRD2",41,0)
 F  S QACRR=$O(QACODE(QACRR)) Q:QACRR']""  D
"RTN","QACSPRD2",42,0)
 . I '$D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACLOC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",43,0)
 . I $D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDIV,QACLOC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",44,0)
 . Q
"RTN","QACSPRD2",45,0)
 Q
"RTN","QACSPRD2",46,0)
SERVICE ;
"RTN","QACSPRD2",47,0)
 ;Sub-routine to count total number of issues for Service
"RTN","QACSPRD2",48,0)
 ;This field is the old service/section involved field, no longer used
"RTN","QACSPRD2",49,0)
 ;after 10/01/97.  Report is kept for records entered prior to that date.
"RTN","QACSPRD2",50,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS G:POP EXIT
"RTN","QACSPRD2",51,0)
 I $D(IO("Q")) D  G EXIT
"RTN","QACSPRD2",52,0)
 . S (ZTSAVE("QAQNBEG"),ZTSAVE("QAQNEND"))=""
"RTN","QACSPRD2",53,0)
 . S ZTSAVE("^TMP(""QACSPRD2"",$J,")=""
"RTN","QACSPRD2",54,0)
 . S ZTDESC="Patient Rep Service Spreadsheet"
"RTN","QACSPRD2",55,0)
 . S ZTRTN="SERVTSK^QACSPRD2" D ^%ZTLOAD
"RTN","QACSPRD2",56,0)
 . Q
"RTN","QACSPRD2",57,0)
SERVTSK ;
"RTN","QACSPRD2",58,0)
 ;Tasked entry point for SERVICE
"RTN","QACSPRD2",59,0)
 U IO
"RTN","QACSPRD2",60,0)
 S QACDT=QAQNBEG-.0000001 F  S QACDT=$O(^QA(745.1,"D",QACDT)) Q:(QACDT'>0)!(QACDT>QAQNEND)!(QACDT\1'?7N)  D
"RTN","QACSPRD2",61,0)
 . S QACD0=0 F  S QACD0=$O(^QA(745.1,"D",QACDT,QACD0)) Q:QACD0'>0  D
"RTN","QACSPRD2",62,0)
 .. Q:'$D(^QA(745.1,QACD0,3,0))
"RTN","QACSPRD2",63,0)
 .. S QACCN=0 F  S QACCN=$O(^QA(745.1,QACD0,3,QACCN)) Q:QACCN'>0  D
"RTN","QACSPRD2",64,0)
 ... S QACCIEN=$P($G(^QA(745.1,QACD0,3,QACCN,0)),U,1) Q:QACCIEN=""
"RTN","QACSPRD2",65,0)
 ... S QACICODE=$P($G(^QA(745.2,QACCIEN,0)),U,1) Q:QACICODE=""  D
"RTN","QACSPRD2",66,0)
 .... Q:'$D(^QA(745.1,QACD0,3,QACCN,1,0))
"RTN","QACSPRD2",67,0)
 .... S QACSIEN=0 F  S QACSIEN=$O(^QA(745.1,QACD0,3,QACCN,1,"B",QACSIEN)) Q:QACSIEN'>0  D
"RTN","QACSPRD2",68,0)
 ..... S QACSERV=$$EN4^QACUTIL(+QACSIEN)
"RTN","QACSPRD2",69,0)
 ..... S ^TMP("QACSPRD2",$J,QACSERV,QACICODE,QACD0)=""
"RTN","QACSPRD2",70,0)
 ..... Q
"RTN","QACSPRD2",71,0)
 .... Q
"RTN","QACSPRD2",72,0)
 ... Q
"RTN","QACSPRD2",73,0)
 .. Q
"RTN","QACSPRD2",74,0)
 . Q
"RTN","QACSPRD2",75,0)
 S QACSERV="" F  S QACSERV=$O(^TMP("QACSPRD2",$J,QACSERV)) Q:QACSERV=""  D
"RTN","QACSPRD2",76,0)
 . S QACICODE="",QACTOT=0 F  S QACICODE=$O(^TMP("QACSPRD2",$J,QACSERV,QACICODE)) Q:QACICODE=""  D
"RTN","QACSPRD2",77,0)
 .. S QACREC=0 F  S QACREC=$O(^TMP("QACSPRD2",$J,QACSERV,QACICODE,QACREC)) Q:QACREC'>0  D
"RTN","QACSPRD2",78,0)
 ... S QACTOT=QACTOT+1
"RTN","QACSPRD2",79,0)
 ... Q
"RTN","QACSPRD2",80,0)
 .. Q
"RTN","QACSPRD2",81,0)
 . W !,QACSERV_","_QACTOT
"RTN","QACSPRD2",82,0)
 . Q
"RTN","QACSPRD2",83,0)
 D EXIT
"RTN","QACSPRD2",84,0)
 Q
"RTN","QACSPRD2",85,0)
DISC ; Sub-routine to count total issue per discipline
"RTN","QACSPRD2",86,0)
 S QACTITLE="Discipline "
"RTN","QACSPRD2",87,0)
 S QACRTN="DISCTSK^QACSPRD2"
"RTN","QACSPRD2",88,0)
 S QACIFLG=1
"RTN","QACSPRD2",89,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACD0) G:$G(QACPOP) EXIT
"RTN","QACSPRD2",90,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD2",91,0)
DISCTSK ; Tasked entry point for DISCIPLINE
"RTN","QACSPRD2",92,0)
 S QACROU="DISCTSK1^QACSPRD2"
"RTN","QACSPRD2",93,0)
 D TSK
"RTN","QACSPRD2",94,0)
 Q
"RTN","QACSPRD2",95,0)
DISCTSK1 ;
"RTN","QACSPRD2",96,0)
 D ICLOOP
"RTN","QACSPRD2",97,0)
 ;Q:'$D(^QA(745.1,QACD0,3,QACCN,3,0))
"RTN","QACSPRD2",98,0)
 S QACRR=0
"RTN","QACSPRD2",99,0)
 F  S QACRR=$O(QACODE(QACRR)) Q:QACRR'>0  D
"RTN","QACSPRD2",100,0)
 . ;Q:'$D(^QA(745.1,QACD0,3,QACODE(QACRR),3,0))
"RTN","QACSPRD2",101,0)
 . S QACWW=0
"RTN","QACSPRD2",102,0)
 . F  S QACWW=$O(^QA(745.1,QACD0,3,QACCODE(QACRR),3,"B",QACWW)) Q:QACWW'>0  D
"RTN","QACSPRD2",103,0)
 . . S QACDIEN=$P(^QA(745.55,QACWW,0),U,3) Q:$G(QACDIEN)']""
"RTN","QACSPRD2",104,0)
 . . S QACDISC=$$EN7^QACUTIL(+QACDIEN)
"RTN","QACSPRD2",105,0)
 . . I '$D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDISC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",106,0)
 . . I $D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDIV,QACDISC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",107,0)
 . . Q
"RTN","QACSPRD2",108,0)
 . Q
"RTN","QACSPRD2",109,0)
 Q
"RTN","QACSPRD2",110,0)
EXIT ;
"RTN","QACSPRD2",111,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACSPRD2",112,0)
 K ^TMP("QACSPRD2",$J),IOP,POP,ZTRTN,ZTSAVE,ZTDESC,%ZIS
"RTN","QACSPRD2",113,0)
 K COUNT,QAC1,QAC1DIV,QAC2,QAC3,QAC4,QACCIEN,QACCODE,QACCN,QACD0
"RTN","QACSPRD2",114,0)
 K QACDD,QACDIV,QACDIEN,QACDISC,QACDV,QACDNUM,QACDT,QACEE,QACICODE
"RTN","QACSPRD2",115,0)
 K QACIFLG,QACISSUE,QACLOC,QACLNUM,QACMM,QACNUM,QACPN,QACPOP,QACREC
"RTN","QACSPRD2",116,0)
 K QACROU,QACRR,QACRTN,QACSERV,QACSIEN,QACTITLE,QACTOT,QACWW,QACXFLG
"RTN","QACSPRD2",117,0)
 K QAQNBEG,QAQNEND
"RTN","QACSPRD2",118,0)
 Q
"RTN","QACSPRD2",119,0)
ICLOOP ;
"RTN","QACSPRD2",120,0)
 U IO
"RTN","QACSPRD2",121,0)
 K QACODE
"RTN","QACSPRD2",122,0)
 Q:'$D(^QA(745.1,QACD0,3,0))
"RTN","QACSPRD2",123,0)
 S QACEE=0 F  S QACEE=$O(^QA(745.1,QACD0,3,"B",QACEE)) Q:QACEE'>0  D
"RTN","QACSPRD2",124,0)
 . S QACODE(QACEE)=$P($G(^QA(745.2,QACEE,0)),U,1) I QACODE(QACEE)="" K QACODE(QACEE) Q
"RTN","QACSPRD2",125,0)
 . ;get the issue code IEN so that in DISCTSK1 can get the discpline
"RTN","QACSPRD2",126,0)
 . S QACMM=0 S QACMM=$O(^QA(745.1,QACD0,3,"B",QACEE,QACMM)) I $G(QACMM)>0 S QACCODE(QACEE)=QACMM
"RTN","QACSPRD2",127,0)
 Q
"RTN","QACSPRD2",128,0)
COUNT ;
"RTN","QACSPRD2",129,0)
 N QACCNT,QACCNT2,QACCNT3,QACCNT4,QACTOT
"RTN","QACSPRD2",130,0)
 S QAC1=""
"RTN","QACSPRD2",131,0)
 S (QACCNT2,QACCNT3,QACCNT4)=0
"RTN","QACSPRD2",132,0)
 F  S QAC1=$O(^TMP("QACSPRD2",$J,QAC1)) Q:QAC1']""  D
"RTN","QACSPRD2",133,0)
 . I $D(QAC1DIV) D
"RTN","QACSPRD2",134,0)
 . . I $G(QAC1)>0 D INST^QACUTL0(QAC1,.QACDV)
"RTN","QACSPRD2",135,0)
 . . W !!?5,"Division: "_$S(QAC1=0:"Unknown",1:QACDV)
"RTN","QACSPRD2",136,0)
 . S QAC2=""
"RTN","QACSPRD2",137,0)
 . F  S QAC2=$O(^TMP("QACSPRD2",$J,QAC1,QAC2)) Q:QAC2']""  D
"RTN","QACSPRD2",138,0)
 . . S QACCNT2=$G(QACCNT2)+1
"RTN","QACSPRD2",139,0)
 . . S QAC3=""
"RTN","QACSPRD2",140,0)
 . .; S QACTOT=0
"RTN","QACSPRD2",141,0)
 . . F  S QAC3=$O(^TMP("QACSPRD2",$J,QAC1,QAC2,QAC3)) Q:QAC3']""  D
"RTN","QACSPRD2",142,0)
 . . . S QACCNT3=$G(QACCNT3)+1
"RTN","QACSPRD2",143,0)
 . . . S QAC4=""
"RTN","QACSPRD2",144,0)
 . . . F  S QAC4=$O(^TMP("QACSPRD2",$J,QAC1,QAC2,QAC3,QAC4)) Q:QAC4']""  D
"RTN","QACSPRD2",145,0)
 . . . . S QACCNT4=$G(QACCNT4)+1
"RTN","QACSPRD2",146,0)
 . . I $D(QAC1DIV) W !,QAC2_", "_$S($G(QACCNT4)>0:QACCNT4,1:QACCNT3) S (QACCNT3,QACCNT4)=0
"RTN","QACSPRD2",147,0)
 . I '$D(QAC1DIV) W !?5,QAC1_", "_$S($G(QACCNT3)>0:QACCNT3,1:QACCNT2) S (QACCNT3,QACCNT2)=0
"RTN","QACSPRD2",148,0)
 ;. . S (QACCNT3,QACCNT4)=0
"RTN","QACSPRD2",149,0)
 Q
"RTN","QACSPRD2",150,0)
TSK ;
"RTN","QACSPRD2",151,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACSPRD2",152,0)
 D WRIT^QACSPRD1
"RTN","QACSPRD2",153,0)
 D COUNT
"RTN","QACSPRD2",154,0)
 D EXIT
"RTN","QACSPRD2",155,0)
 Q
"RTN","QACSPRD2",156,0)
LOOP2 ;
"RTN","QACSPRD2",157,0)
 S (QACDD,QACTOT)=0
"RTN","QACSPRD2",158,0)
 F  S QACDD=$O(^TMP("QACSPRD2",$J,QAC1,QAC2,QACDD)) Q:QACDD']""  D
"RTN","QACSPRD2",159,0)
 . S QACTOT=QACTOT+1
"RTN","QACSPRD2",160,0)
 W !,QAC2_", "_QACTOT
"RTN","QACSPRD2",161,0)
 I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE^QACGEN S QACPFLG=1 D WRIT^QACSPRD1
"RTN","QACSPRD2",162,0)
 S QACTOT=0
"RTN","QACSPRD2",163,0)
 K QACPFLG
"RTN","QACSPRD2",164,0)
 Q
"VER")
8.0^22.0
**END**
**END**
