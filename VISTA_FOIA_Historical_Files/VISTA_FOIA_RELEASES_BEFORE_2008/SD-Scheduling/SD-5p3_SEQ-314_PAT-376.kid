Released SD*5.3*376 SEQ #314
Extracted from mail message
**KIDS**:SD*5.3*376^

**INSTALL NAME**
SD*5.3*376
"BLD",5631,0)
SD*5.3*376^SCHEDULING^0^3041108^y
"BLD",5631,1,0)
^^6^6^3041001^^^
"BLD",5631,1,1,0)
Two main purposes of this patch are:
"BLD",5631,1,2,0)
- inclusion of Combat Veteran and Military History into PAIT
"BLD",5631,1,3,0)
- automatic verification of PAIT transmission data via a Forum.S.Server
"BLD",5631,1,4,0)
Additionally, several fixes/modifications are included following their 
"BLD",5631,1,5,0)
identification in NOIS calls.
"BLD",5631,1,6,0)

"BLD",5631,4,0)
^9.64PA^409.6^1
"BLD",5631,4,409.6,0)
409.6
"BLD",5631,4,409.6,2,0)
^9.641^409.69^1
"BLD",5631,4,409.6,2,409.69,0)
PATIENT  (sub-file)
"BLD",5631,4,409.6,2,409.69,1,0)
^9.6411^2^2
"BLD",5631,4,409.6,2,409.69,1,2,0)
HL7 MESSAGE ID
"BLD",5631,4,409.6,2,409.69,1,8,0)
APPOINTMENT TYPE
"BLD",5631,4,409.6,222)
y^n^p^^^^n^^n
"BLD",5631,4,409.6,224)

"BLD",5631,4,"APDD",409.6,409.69)

"BLD",5631,4,"APDD",409.6,409.69,2)

"BLD",5631,4,"APDD",409.6,409.69,8)

"BLD",5631,4,"B",409.6,409.6)

"BLD",5631,"INIT")
SD376P
"BLD",5631,"KRN",0)
^9.67PA^8989.52^19
"BLD",5631,"KRN",.4,0)
.4
"BLD",5631,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",5631,"KRN",.4,"NM",1,0)
SD-PAIT PATIENT HL7 LOCATION    FILE #409.6^409.6^0
"BLD",5631,"KRN",.4,"NM","B","SD-PAIT PATIENT HL7 LOCATION    FILE #409.6",1)

"BLD",5631,"KRN",.401,0)
.401
"BLD",5631,"KRN",.401,"NM",0)
^9.68A^1^1
"BLD",5631,"KRN",.401,"NM",1,0)
SD-PAIT PATIENT HL7 LOCATION    FILE #409.6^409.6^0
"BLD",5631,"KRN",.401,"NM","B","SD-PAIT PATIENT HL7 LOCATION    FILE #409.6",1)

"BLD",5631,"KRN",.402,0)
.402
"BLD",5631,"KRN",.403,0)
.403
"BLD",5631,"KRN",.5,0)
.5
"BLD",5631,"KRN",.84,0)
.84
"BLD",5631,"KRN",3.6,0)
3.6
"BLD",5631,"KRN",3.8,0)
3.8
"BLD",5631,"KRN",9.2,0)
9.2
"BLD",5631,"KRN",9.8,0)
9.8
"BLD",5631,"KRN",9.8,"NM",0)
^9.68A^18^17
"BLD",5631,"KRN",9.8,"NM",1,0)
SDRPA00^^0^B79872528
"BLD",5631,"KRN",9.8,"NM",2,0)
SDRPA02^^0^B12428480
"BLD",5631,"KRN",9.8,"NM",3,0)
SDRPA03^^0^B31121600
"BLD",5631,"KRN",9.8,"NM",4,0)
SDRPA05^^0^B24254070
"BLD",5631,"KRN",9.8,"NM",5,0)
SDRPA06^^0^B58400495
"BLD",5631,"KRN",9.8,"NM",6,0)
SDRPA07^^0^B52873373
"BLD",5631,"KRN",9.8,"NM",7,0)
SDRPA08^^0^B43490788
"BLD",5631,"KRN",9.8,"NM",9,0)
SDRPA10^^0^B44760083
"BLD",5631,"KRN",9.8,"NM",10,0)
SDRPA11^^0^B23971806
"BLD",5631,"KRN",9.8,"NM",11,0)
SDRPA12^^0^B64935773
"BLD",5631,"KRN",9.8,"NM",12,0)
SDRPA13^^0^B60320496
"BLD",5631,"KRN",9.8,"NM",13,0)
SDRPA14^^0^B74206620
"BLD",5631,"KRN",9.8,"NM",14,0)
SDRPA15^^0^B78928522
"BLD",5631,"KRN",9.8,"NM",15,0)
SDRPA16^^0^B26005812
"BLD",5631,"KRN",9.8,"NM",16,0)
SDRPA17^^0^B69972812
"BLD",5631,"KRN",9.8,"NM",17,0)
SDRPA18^^0^B1553282
"BLD",5631,"KRN",9.8,"NM",18,0)
SDRPA04^^0^B37937936
"BLD",5631,"KRN",9.8,"NM","B","SDRPA00",1)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA02",2)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA03",3)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA04",18)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA05",4)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA06",5)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA07",6)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA08",7)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA10",9)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA11",10)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA12",11)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA13",12)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA14",13)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA15",14)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA16",15)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA17",16)

"BLD",5631,"KRN",9.8,"NM","B","SDRPA18",17)

"BLD",5631,"KRN",19,0)
19
"BLD",5631,"KRN",19,"NM",0)
^9.68A^3^3
"BLD",5631,"KRN",19,"NM",1,0)
SD-PAIT REPAIR^^0
"BLD",5631,"KRN",19,"NM",2,0)
SD-PAIT PATIENT HL7 LOCATION^^0
"BLD",5631,"KRN",19,"NM",3,0)
SD-PAIT REPORTS^^3
"BLD",5631,"KRN",19,"NM","B","SD-PAIT PATIENT HL7 LOCATION",2)

"BLD",5631,"KRN",19,"NM","B","SD-PAIT REPAIR",1)

"BLD",5631,"KRN",19,"NM","B","SD-PAIT REPORTS",3)

"BLD",5631,"KRN",19.1,0)
19.1
"BLD",5631,"KRN",101,0)
101
"BLD",5631,"KRN",409.61,0)
409.61
"BLD",5631,"KRN",771,0)
771
"BLD",5631,"KRN",870,0)
870
"BLD",5631,"KRN",8989.51,0)
8989.51
"BLD",5631,"KRN",8989.52,0)
8989.52
"BLD",5631,"KRN",8994,0)
8994
"BLD",5631,"KRN","B",.4,.4)

"BLD",5631,"KRN","B",.401,.401)

"BLD",5631,"KRN","B",.402,.402)

"BLD",5631,"KRN","B",.403,.403)

"BLD",5631,"KRN","B",.5,.5)

"BLD",5631,"KRN","B",.84,.84)

"BLD",5631,"KRN","B",3.6,3.6)

"BLD",5631,"KRN","B",3.8,3.8)

"BLD",5631,"KRN","B",9.2,9.2)

"BLD",5631,"KRN","B",9.8,9.8)

"BLD",5631,"KRN","B",19,19)

"BLD",5631,"KRN","B",19.1,19.1)

"BLD",5631,"KRN","B",101,101)

"BLD",5631,"KRN","B",409.61,409.61)

"BLD",5631,"KRN","B",771,771)

"BLD",5631,"KRN","B",870,870)

"BLD",5631,"KRN","B",8989.51,8989.51)

"BLD",5631,"KRN","B",8989.52,8989.52)

"BLD",5631,"KRN","B",8994,8994)

"BLD",5631,"QUES",0)
^9.62^^
"BLD",5631,"REQB",0)
^9.611^2^2
"BLD",5631,"REQB",1,0)
SD*5.3*349^2
"BLD",5631,"REQB",2,0)
XU*8.0*284^2
"BLD",5631,"REQB","B","SD*5.3*349",1)

"BLD",5631,"REQB","B","XU*8.0*284",2)

"FIA",409.6)
PATIENT APPOINTMENT INFO LOG
"FIA",409.6,0)
^SDWL(409.6,
"FIA",409.6,0,0)
409.6D
"FIA",409.6,0,1)
y^n^p^^^^n^^n
"FIA",409.6,0,10)

"FIA",409.6,0,11)

"FIA",409.6,0,"RLRO")

"FIA",409.6,0,"VR")
5.3^SD
"FIA",409.6,409.6)
1
"FIA",409.6,409.69)
1
"FIA",409.6,409.69,2)

"FIA",409.6,409.69,8)

"INIT")
SD376P
"IX",409.6,409.6,"AMSG",0)
409.6^AMSG^Message xref^R^^R^IR^W^409.69^^^^^S
"IX",409.6,409.6,"AMSG",1)
S ^SDWL(409.6,"AMSG",$E(X(1),1,30),$E(X(2),1,30),DA(1),DA)=""
"IX",409.6,409.6,"AMSG",2)
K ^SDWL(409.6,"AMSG",$E(X(1),1,30),$E(X(2),1,30),DA(1),DA)
"IX",409.6,409.6,"AMSG",2.5)
K ^SDWL(409.6,"AMSG")
"IX",409.6,409.6,"AMSG",11.1,0)
^.114IA^2^2
"IX",409.6,409.6,"AMSG",11.1,1,0)
1^F^409.69^2^30^1^F
"IX",409.6,409.6,"AMSG",11.1,1,3)

"IX",409.6,409.6,"AMSG",11.1,2,0)
2^F^409.69^3^30^2^F
"IX",409.6,409.6,"AMSG",11.1,2,3)

"KRN",.4,2676,-1)
0^1
"KRN",.4,2676,0)
SD-PAIT PATIENT HL7 LOCATION^3041005.1046^@^409.6^^@^3041005
"KRN",.4,2676,"F",2)
2,.01;L20~2,1~2,"  ";" HL7 MESSAGE"~2,2;X~2,"-"~2,3;X~
"KRN",.4,2676,"H")
SD-PAIT PATIENT HL7 LOCATION
"KRN",.401,2012,-1)
0^1
"KRN",.401,2012,0)
SD-PAIT PATIENT HL7 LOCATION^3041005.0959^@^409.6^^@^3041005
"KRN",.401,2012,2,0)
^.4014^1^1
"KRN",.401,2012,2,1,0)
409.69^1^APPT DATE^@^^^^^^1
"KRN",.401,2012,2,1,1,0)
^.40141^1^1
"KRN",.401,2012,2,1,1,1,0)
409.6^1
"KRN",.401,2012,2,1,1,"B",409.6,1)

"KRN",.401,2012,2,1,"ASK")
1
"KRN",.401,2012,2,1,"F")
3040904.999999^Sep 5,2004^Sep 5,2004
"KRN",.401,2012,2,1,"GET")
S DISX(1)=$P($G(^SDWL(409.6,D0,1,D1,0)),U,2)
"KRN",.401,2012,2,1,"QCON")
I (DISX(1)]]3040904.999999)&(DISX(1)']]3041005.24)
"KRN",.401,2012,2,1,"T")
3041005.24^Oct 5,2004@2400^Oct 5,2004@24:00
"KRN",.401,2012,2,1,"TXT")
APPT DATE from Sep 5,2004 to Oct 5,2004@24:00
"KRN",.401,2012,2,"B",409.69,1)

"KRN",19,11864,-1)
3^3
"KRN",19,11864,0)
SD-PAIT REPORTS^PAIT Reports Menu^^M^^^^^^^y^SCHEDULING
"KRN",19,11864,1,0)
^19.06^1^1^3041005^^
"KRN",19,11864,1,1,0)
This SD-PAIT top level report menu.
"KRN",19,11864,10,0)
^19.01IP^5^5
"KRN",19,11864,10,5,0)
12157
"KRN",19,11864,10,5,"^")
SD-PAIT PATIENT HL7 LOCATION
"KRN",19,11864,99)
59840,41533
"KRN",19,11864,99.1)
59847,42636
"KRN",19,11864,"U")
PAIT REPORTS MENU
"KRN",19,12132,-1)
0^1
"KRN",19,12132,0)
SD-PAIT REPAIR^SD-PAIT Last Run Repair^^R^^^^^^^^^^1
"KRN",19,12132,1,0)
^19.06^4^4^3041031^^^^
"KRN",19,12132,1,1,0)
This option will allow repair of a PAIT that was interrupted either by a system
"KRN",19,12132,1,2,0)
problem or an error. The error cause has to be addressed before this repairing
"KRN",19,12132,1,3,0)
process takes place and a new transmission starts.
"KRN",19,12132,1,4,0)

"KRN",19,12132,20)
S SDR=+$O(^SDWL(409.6,99999999),-1) I $P($G(^SDWL(409.6,SDR,0)),"^",7)?7N1".".N W !,"NO ENTRY TO REPAIR!",! S SDR="" H 1 Q
"KRN",19,12132,25)
RPAIT^SDRPA04(SDR)
"KRN",19,12132,"U")
SD-PAIT LAST RUN REPAIR
"KRN",19,12157,-1)
0^2
"KRN",19,12157,0)
SD-PAIT PATIENT HL7 LOCATION^Patient HL7 Location^^P^^^^^^^^
"KRN",19,12157,30)
SDWL(409.6,
"KRN",19,12157,60)
SDWL(409.6,
"KRN",19,12157,63)
[SD-PAIT PATIENT HL7 LOCATION]
"KRN",19,12157,64)
[SD-PAIT PATIENT HL7 LOCATION]
"KRN",19,12157,"U")
PATIENT HL7 LOCATION
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",6,.401)
.401;6;;;EDEOUT^DIFROMSO(.401,DA,"",XPDA);FPRE^DIFROMSI(.401,"",XPDA);EPRE^DIFROMSI(.401,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.401,DA,"",XPDA);DEL^DIFROMSK(.401,"",%)
"ORD",6,.401,0)
SORT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
376^3041108^100892
"PKG",16,22,1,"PAH",1,1,0)
^^6^6^3041108
"PKG",16,22,1,"PAH",1,1,1,0)
Two main purposes of this patch are:
"PKG",16,22,1,"PAH",1,1,2,0)
- inclusion of Combat Veteran and Military History into PAIT
"PKG",16,22,1,"PAH",1,1,3,0)
- automatic verification of PAIT transmission data via a Forum.S.Server
"PKG",16,22,1,"PAH",1,1,4,0)
Additionally, several fixes/modifications are included following their 
"PKG",16,22,1,"PAH",1,1,5,0)
identification in NOIS calls.
"PKG",16,22,1,"PAH",1,1,6,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
18
"RTN","SD376P")
0^^B6743560
"RTN","SD376P",1,0)
SD376P ;BP-OIFO/esw,swo - POSTINSTALL DRIVER ; 10/27/04 3:39pm
"RTN","SD376P",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SD376P",3,0)
EN ;manual entry point
"RTN","SD376P",4,0)
 ;ST   :  station number
"RTN","SD376P",5,0)
 ;STR  :  list of stations receiving AA ack's only
"RTN","SD376P",6,0)
 ;STS  :  current station number with comma's concatenated
"RTN","SD376P",7,0)
 I '$$PROD^XUPROD(1) D  Q
"RTN","SD376P",8,0)
 . D BMES^XPDUTL("NOT A PRODUCTION SYSTEM.  POST INIT CANCELLED")
"RTN","SD376P",9,0)
EN1 N ST,STR,STS
"RTN","SD376P",10,0)
 S ST=$P($$SITE^VASITE(),"^",3)
"RTN","SD376P",11,0)
 Q:ST=""
"RTN","SD376P",12,0)
 S STR=","_$P($T(STAT),";;",2)_","
"RTN","SD376P",13,0)
 S STS=","_ST_","
"RTN","SD376P",14,0)
 I STR[STS D EN^SDRPA18,CLEAN Q  ;process stations that received AA ack only then quit
"RTN","SD376P",15,0)
 I ST=674 D EN^SDRPA17(ST),EN^SDRPA18,CLEAN Q
"RTN","SD376P",16,0)
 I ST<529 D EN^SDRPA10(ST),EN^SDRPA18,CLEAN Q 
"RTN","SD376P",17,0)
 I ST<547 D EN^SDRPA11(ST),EN^SDRPA18,CLEAN Q
"RTN","SD376P",18,0)
 I ST<555 D EN^SDRPA12(ST),EN^SDRPA18,CLEAN Q
"RTN","SD376P",19,0)
 I ST<571 D EN^SDRPA13(ST),EN^SDRPA18,CLEAN Q
"RTN","SD376P",20,0)
 I ST<619 D EN^SDRPA14(ST),EN^SDRPA18,CLEAN Q
"RTN","SD376P",21,0)
 I ST<664 D EN^SDRPA15(ST),EN^SDRPA18,CLEAN Q
"RTN","SD376P",22,0)
 D EN^SDRPA16(ST),EN^SDRPA18,CLEAN Q
"RTN","SD376P",23,0)
 Q
"RTN","SD376P",24,0)
PR(SB,SM,ER,SQ) ;process the message number and error code
"RTN","SD376P",25,0)
 ;SB - Batch #
"RTN","SD376P",26,0)
 ;SM - Message #
"RTN","SD376P",27,0)
 ;ER - Error code
"RTN","SD376P",28,0)
 ;SQ - Sequence number
"RTN","SD376P",29,0)
 ;V1 - Run number
"RTN","SD376P",30,0)
 ;V2 - ien in appt multiple
"RTN","SD376P",31,0)
 ;V3 - ien in batch tracking multiple
"RTN","SD376P",32,0)
 ;SM is the batch # found in the "AMSG" xref and corresponds to the message control id
"RTN","SD376P",33,0)
 ;SB is our batch control, use for the 2 node multiples B xref lookups
"RTN","SD376P",34,0)
 N V1,V2,V3
"RTN","SD376P",35,0)
 ;get the run number
"RTN","SD376P",36,0)
 S V1=$O(^SDWL(409.6,"AMSG",SM,SQ,"")) Q:'V1  D
"RTN","SD376P",37,0)
 . ;get the ien in that run
"RTN","SD376P",38,0)
 . S V2=$O(^SDWL(409.6,"AMSG",SM,SQ,V1,"")) Q:'V2  D
"RTN","SD376P",39,0)
 .. ;now get the ien of the batch tracking entry
"RTN","SD376P",40,0)
 .. S V3=$O(^SDWL(409.6,V1,2,"B",SB,"")) Q:'V3  D
"RTN","SD376P",41,0)
 ... ;quit if there is an ack date
"RTN","SD376P",42,0)
 ... I $P($G(^SDWL(409.6,V1,2,V3,0)),"^",4)'="" Q
"RTN","SD376P",43,0)
 ... ;update batch tracking
"RTN","SD376P",44,0)
 ... I ER="" S DA=V3,DA(1)=V1,DIE="^SDWL(409.6,"_V1_",2,",DR=".04///"_$$NOW^XLFDT_";.05///AE" D ^DIE K DIE,DA,DR Q
"RTN","SD376P",45,0)
 ...;
"RTN","SD376P",46,0)
 ...;update error codes
"RTN","SD376P",47,0)
 ... S DA=V2,DA(1)=V1,DIE="^SDWL(409.6,"_V1_",1,"
"RTN","SD376P",48,0)
 ... S DR="7////"_$O(^SCPT(404.472,"B",ER,"")) D ^DIE
"RTN","SD376P",49,0)
 ... I $D(^SDWL(409.6,"AE","Y",V1,V2)) Q
"RTN","SD376P",50,0)
 ... I $D(^SDWL(409.6,"AE","N",V1,V2)) D
"RTN","SD376P",51,0)
 .... S DR="4///Y" D ^DIE K DIE,DA,DR
"RTN","SD376P",52,0)
 Q
"RTN","SD376P",53,0)
CLEAN ;clean up batches previous to current one by checking for "AE",("S" or "R") xref and
"RTN","SD376P",54,0)
 ;deleting if entry in xref exists
"RTN","SD376P",55,0)
 ;RUN  :  run #           (ien of multiple entry)
"RTN","SD376P",56,0)
 ;V1   :  previous run #  (ien of multiple entry)  
"RTN","SD376P",57,0)
 ;V2   :  ien           (ien in multiple)
"RTN","SD376P",58,0)
 N V1,V2,V3,ZNODE
"RTN","SD376P",59,0)
 S V1=9999999 F  S V1=$O(^SDWL(409.6,V1),-1) Q:'V1  D
"RTN","SD376P",60,0)
 .F V3="R","S" S V2=0 F  S V2=$O(^SDWL(409.6,"AE",V3,V1,V2)) Q:'V2  D
"RTN","SD376P",61,0)
 ..S ZNODE=$G(^SDWL(409.6,V1,1,V2,0))
"RTN","SD376P",62,0)
 ..S DIK="^SDWL(409.6,"_V1_",1,"
"RTN","SD376P",63,0)
 ..S DA(1)=V1,DA=V2 D ^DIK K DIK
"RTN","SD376P",64,0)
 Q
"RTN","SD376P",65,0)
 ;listing of all stations that received only AA ack - no rejection
"RTN","SD376P",66,0)
STAT ;;358,405,463,503,516,517,523,538,540,542,552,564,575,583,600,613,632,649,653,656,676,679,687,692,693,757
"RTN","SDRPA00")
0^1^B79872528
"RTN","SDRPA00",1,0)
SDRPA00 ;BP-OIFO/OWAIN,ESW - Patient Appointment Information Transmission  ; 11/2/04 11:09am
"RTN","SDRPA00",2,0)
 ;;5.3;Scheduling;**290,333,349,376**;Aug 13,1993
"RTN","SDRPA00",3,0)
 Q
"RTN","SDRPA00",4,0)
EN ;manual entry
"RTN","SDRPA00",5,0)
 N SDI,Y,ZTSK,ZTRTN,ZTDESC,ZTDTH,ZTIO,ZTSAVE,RUNID,REC
"RTN","SDRPA00",6,0)
 I '$$RUNCK^SDRPA02() W !,"You attempted to start PAIT outside the authorized transmission dates.",!,"Job has been terminated.",! Q
"RTN","SDRPA00",7,0)
 S RUNID=$O(^SDWL(409.6,":"),-1)
"RTN","SDRPA00",8,0)
 I RUNID S ZTSK=$P(^SDWL(409.6,RUNID,0),"^",2) D STAT^%ZTLOAD I ZTSK(1)=1!(ZTSK(1)=2) W !,"A task is currently active." Q
"RTN","SDRPA00",9,0)
 K ZTSK N SDCON S SDCON=1
"RTN","SDRPA00",10,0)
 S %DT("A")="Queue to run:  "
"RTN","SDRPA00",11,0)
 S %DT="AEFXR" W ! D ^%DT S DT=Y D:Y'=-1  Q:'SDCON
"RTN","SDRPA00",12,0)
 .S ZTDTH=Y,ZTRTN="START^SDRPA00",ZTIO=""
"RTN","SDRPA00",13,0)
 .S ZTDESC="PAIT"
"RTN","SDRPA00",14,0)
 .I RUNID I $P(^SDWL(409.6,RUNID,0),U,7)="" S SDCON=0 D
"RTN","SDRPA00",15,0)
 ..W !,"The previous run errored out, not repaired!",!,"Please address a problem and then use option SD-PAIT REPAIR to fix the run."
"RTN","SDRPA00",16,0)
 .Q:'SDCON
"RTN","SDRPA00",17,0)
 .F SDI=1:1:20 D ^%ZTLOAD Q:$G(ZTSK)
"RTN","SDRPA00",18,0)
 .I $G(ZTSK) W !,"Task # "_ZTSK_" queued!"
"RTN","SDRPA00",19,0)
 I '$G(ZTSK) W !!,"Task not queued, check Taskman",! Q
"RTN","SDRPA00",20,0)
 W !!,"Task number: ",ZTSK,!
"RTN","SDRPA00",21,0)
 Q
"RTN","SDRPA00",22,0)
START ;Tasked entry
"RTN","SDRPA00",23,0)
 N SDOUT,DFN,DFNEND,SDCNT,SDCNT0,RUNID,RUNDT,SDPREV,FIRST,SDDAM,TODAY,SD6A,SD8A,SD68,RUNIDP,SDPR,ZTSKN
"RTN","SDRPA00",24,0)
 I '$$RUNCK^SDRPA02() Q  ;check scheduling
"RTN","SDRPA00",25,0)
 I $G(ZTSK)="" D  Q
"RTN","SDRPA00",26,0)
 . W !,"NOT AN INTERACTIVE OPTION...schedule through TaskMan",!!
"RTN","SDRPA00",27,0)
 S ZTSKN=ZTSK
"RTN","SDRPA00",28,0)
 S SDPR=$O(^SDWL(409.6,":"),-1) ;previous run
"RTN","SDRPA00",29,0)
 I SDPR N SD1 S SD1=0 D  Q:SD1  ;finish if task is still running
"RTN","SDRPA00",30,0)
 .I $P(^SDWL(409.6,SDPR,0),U,7)'="" Q  ; previous task finished
"RTN","SDRPA00",31,0)
 .N ZTSK
"RTN","SDRPA00",32,0)
 .S ZTSK=$P(^SDWL(409.6,SDPR,0),"^",2) D STAT^%ZTLOAD I ZTSK(1)=1!(ZTSK(1)=2) S SD1=1
"RTN","SDRPA00",33,0)
 .;send message
"RTN","SDRPA00",34,0)
 .N SDAMX,XMSUB,XMY,XMTEXT,XMDUZ
"RTN","SDRPA00",35,0)
 .S XMSUB="PAIT BACKGROUND JOB"
"RTN","SDRPA00",36,0)
 .S XMY("G.SD-PAIT")=""
"RTN","SDRPA00",37,0)
 .S XMTEXT="SDAMX("
"RTN","SDRPA00",38,0)
 .S XMDUZ="POSTMASTER"
"RTN","SDRPA00",39,0)
 .S SDAMX(1)="The PAIT requested task has been terminated."
"RTN","SDRPA00",40,0)
 .S SDAMX(2)="The previous task #: "_ZTSK_" run #: "_SDPR_" has not been completed."
"RTN","SDRPA00",41,0)
 .I SD1=1 S SDAMX(3)="It is still running.",SDAMX(4)=""
"RTN","SDRPA00",42,0)
 .E  S SD1=2 D
"RTN","SDRPA00",43,0)
 ..S SDAMX(3)="The previous run errored out, not repaired!"
"RTN","SDRPA00",44,0)
 ..S SDAMX(4)="Address a problem and use option SD-PAIT REPAIR to fix the run."
"RTN","SDRPA00",45,0)
 .D ^XMD
"RTN","SDRPA00",46,0)
 S DIC=409.6,DIC(0)="X"
"RTN","SDRPA00",47,0)
 D NOW^%DTC S TODAY=X
"RTN","SDRPA00",48,0)
 K DO D FILE^DICN
"RTN","SDRPA00",49,0)
 S DA=+Y,DIE=DIC,DR="1///"_ZTSK D ^DIE
"RTN","SDRPA00",50,0)
 ;send START message
"RTN","SDRPA00",51,0)
 D STMES
"RTN","SDRPA00",52,0)
 S (SDOUT,SDCNT)=0
"RTN","SDRPA00",53,0)
 K ^TMP("SDDPT",$J)
"RTN","SDRPA00",54,0)
 N CRUNID S CRUNID=$O(^SDWL(409.6,"AD",ZTSK,""))
"RTN","SDRPA00",55,0)
 S RUNDT=$P(^SDWL(409.6,CRUNID,0),"^")
"RTN","SDRPA00",56,0)
 I SDPR=0 S SDPREV=3020831,FIRST=1 ;first run
"RTN","SDRPA00",57,0)
 E  S SDPREV=$P(^SDWL(409.6,SDPR,0),U,4),FIRST=0 ;
"RTN","SDRPA00",58,0)
 N SDFIN,SDPEN,SDF,SDTR S (RUNID,SDFIN,SDPEN,SDTR,SDF)=0
"RTN","SDRPA00",59,0)
 S SDDAM=SDPREV ;creation date
"RTN","SDRPA00",60,0)
 D NOW^%DTC S TODAY=X
"RTN","SDRPA00",61,0)
 F  S SDDAM=$O(^DPT("ASADM",SDDAM)) Q:SDDAM=""  Q:SDDAM=TODAY!SDOUT  D
"RTN","SDRPA00",62,0)
 .N DFN S DFN=0
"RTN","SDRPA00",63,0)
 .F  S DFN=$O(^DPT("ASADM",SDDAM,DFN)) Q:+DFN'=DFN!SDOUT  D
"RTN","SDRPA00",64,0)
 ..N SDADT S SDADT=0 ;appt date/time
"RTN","SDRPA00",65,0)
 ..S SDADT=0
"RTN","SDRPA00",66,0)
 ..F  S SDADT=$O(^DPT("ASADM",SDDAM,DFN,SDADT)) Q:+SDADT'=SDADT!SDOUT  D
"RTN","SDRPA00",67,0)
 ...I SDDAM'=$$GET1^DIQ(2.98,SDADT_","_DFN_",",20,"I") Q  ;compare creation dates
"RTN","SDRPA00",68,0)
 ...; Check for 'stop task' request
"RTN","SDRPA00",69,0)
 ...S SDCNT=SDCNT+1 I SDCNT#500=0 S SDOUT=$$S^%ZTLOAD I SDOUT D  N SDBCID,SDMCID,SDSTOP D SNDS19^SDRPA07(ZTSK,.SDBCID,.SDMCID) S SDSTOP=1 D MSGT^SDRPA03(CRUNID,SDPEN,SDFIN,,SDSTOP) K ^TMP("SDDPT",$J) Q
"RTN","SDRPA00",70,0)
 ....N DA,DIE,DR,SDD,SDLAST D
"RTN","SDRPA00",71,0)
 ....S SDLAST=$O(^SDWL(409.6,CRUNID,1,"B"),-1) S SDD=$P(^SDWL(409.6,CRUNID,1,SDLAST,0),U,7)-1
"RTN","SDRPA00",72,0)
 ....S DA=CRUNID,DIE=409.6,DR="1.2///"_SDD D ^DIE
"RTN","SDRPA00",73,0)
 ...N SDCL,SDSTAT,SDSTTY
"RTN","SDRPA00",74,0)
 ...S SDCL=$$GET1^DIQ(2.98,SDADT_","_DFN_",",.01,"I")
"RTN","SDRPA00",75,0)
 ...Q:SDCL=""  ; If this happens, there's something wrong. Do we need to handle exceptions like this?
"RTN","SDRPA00",76,0)
 ...;
"RTN","SDRPA00",77,0)
 ...; Check status.
"RTN","SDRPA00",78,0)
 ...; If the appointment is finalized and it is the first run, do not send if the date appoinment made is before Sep 1, 2003
"RTN","SDRPA00",79,0)
 ...; If it is not the first run, send but don't create a pending file
"RTN","SDRPA00",80,0)
 ...; Otherwise add to pending file.
"RTN","SDRPA00",81,0)
 ...D NOW^%DTC N STODAY S STODAY=X
"RTN","SDRPA00",82,0)
 ...S SDSTAT=$$STATUS^SDRPA05(DFN,SDADT,SDCL,STODAY,1)
"RTN","SDRPA00",83,0)
 ...I $P(SDSTAT,"^")=0 Q
"RTN","SDRPA00",84,0)
 ...N SDCLL S SDCLL=$P(SDSTAT,U,6) I SDCLL'="" S SDCL=SDCLL ;assign a new clinic if from matching non count with encounter
"RTN","SDRPA00",85,0)
 ...S SDSTTY=$P(SDSTAT,U,2),SD6A=$P(SDSTAT,U,3),SD8A=$P(SDSTAT,U,4)
"RTN","SDRPA00",86,0)
 ...I SDSTTY="F" Q:'$$GT90DAYS(SDDAM,3030831)  ; pending and final from 09/01/2003, previously 90 days
"RTN","SDRPA00",87,0)
 ...I SDSTTY="F",SD6A="NM",SD8A="NC" Q  ; skip non-count if not matching count and scheduled date already expired
"RTN","SDRPA00",88,0)
 ...N SDCOA,SDMSHA S SDCOA=$P(SDSTAT,U,5) S SDMSHA=$P(SDSTAT,U)
"RTN","SDRPA00",89,0)
 ...N SDCE Q:'$$DPT^SDRPA08(DFN,.SDCE)  ; Create demographic node of ^TMP file. Quit if this failed.
"RTN","SDRPA00",90,0)
 ...N DIC,DA,X,SDRET D
"RTN","SDRPA00",91,0)
 ....N SDRET S SDRET=$S(SDSTTY="F":"N",1:"Y")
"RTN","SDRPA00",92,0)
 ....S DIC="^SDWL(409.6,"_CRUNID_",1,",DA(1)=CRUNID,DIC("P")=409.69,DIC(0)="X"
"RTN","SDRPA00",93,0)
 ....K DO S X=DFN D FILE^DICN
"RTN","SDRPA00",94,0)
 ....S DA=+Y,DIE=DIC,DR="1///"_SDADT_";4///"_SDRET_";5///"_SD6A_";6///"_SDDAM_";8///"_SD8A_";9////"_SDCL D ^DIE
"RTN","SDRPA00",95,0)
 ....Q
"RTN","SDRPA00",96,0)
 ...D APPT^SDRPA08(DFN,SDADT,$$DTCONV^SDRPA08(SDDAM),SDCL,SDSTAT)
"RTN","SDRPA00",97,0)
 ...S SDFF=$P(SDSTAT,"^",4) D STAT(SDSTTY,SDFF,.SDFIN,.SDPEN,.SDF)
"RTN","SDRPA00",98,0)
 ...S SDTR=SDTR+1 I SDTR=5000 D SNDS19^SDRPA07(ZTSK,.SDBCID,.SDMCID) K ^TMP("SDDPT",$J) S SDTR=0
"RTN","SDRPA00",99,0)
 Q:SDOUT
"RTN","SDRPA00",100,0)
 N SDD S SDD=$O(^DPT("ASADM",TODAY),-1) ;enter the last scanned day
"RTN","SDRPA00",101,0)
 S DA=CRUNID,DIE=409.6,DR="1.2///"_SDD D ^DIE
"RTN","SDRPA00",102,0)
 ; scan the previous runs
"RTN","SDRPA00",103,0)
 S RUNID=0
"RTN","SDRPA00",104,0)
 F  S RUNID=$O(^SDWL(409.6,RUNID)) Q:+RUNID=CRUNID!SDOUT  D
"RTN","SDRPA00",105,0)
 .N APPTID,SDADT,REC
"RTN","SDRPA00",106,0)
 .S APPTID=0
"RTN","SDRPA00",107,0)
 .;scanning only appointments that were sent as 'pending'
"RTN","SDRPA00",108,0)
 .F  S APPTID=$O(^SDWL(409.6,"AE","Y",RUNID,APPTID)) Q:APPTID=""!SDOUT  S REC=$G(^SDWL(409.6,RUNID,1,APPTID,0)) D
"RTN","SDRPA00",109,0)
 ..IF REC="" K ^SDWL(409.6,"AE","Y",RUNID,APPTID) Q  ;anticipate
"RTN","SDRPA00",110,0)
 ..S DFN=$P(REC,"^"),SDADT=$P(REC,"^",2)
"RTN","SDRPA00",111,0)
 ..; Check for 'stop task'
"RTN","SDRPA00",112,0)
 ..S SDCNT=SDCNT+1 I SDCNT#500=0 S SDOUT=$$S^%ZTLOAD I SDOUT N SDBCID,SDMCID,SDSTOP D SNDS19^SDRPA07(ZTSK,.SDBCID,.SDMCID) S SDSTOP=1 D MSGT^SDRPA03(CRUNID,SDPEN,SDFIN,,SDSTOP) K ^TMP("SDDPT",$J) Q  ;
"RTN","SDRPA00",113,0)
 ..N SDCL,SDCLO,SDCE,SDSTAT,SDREJ,SDDAM,SDDAMO
"RTN","SDRPA00",114,0)
 ..S SDCLO=$P(REC,"^",10)
"RTN","SDRPA00",115,0)
 ..S SDREJ=$P(REC,"^",8),SDDAMO=$P(REC,"^",7) ;esw
"RTN","SDRPA00",116,0)
 ..I SDDAMO="" D
"RTN","SDRPA00",117,0)
 ...N SDD S SDD=9999999 F  S SDD=$O(^DPT("ASADM",SDD),-1) Q:SDD'>0  I $D(^DPT("ASADM",SDD,DFN,SDADT)) S SDDAMO=SDD Q
"RTN","SDRPA00",118,0)
 ..Q:SDDAMO=""  ;cannot determine what was original creation date
"RTN","SDRPA00",119,0)
 ..;evaluate if the same creation date
"RTN","SDRPA00",120,0)
 ..S SDDAM=$$GET1^DIQ(2.98,SDADT_","_DFN_",",20,"I")
"RTN","SDRPA00",121,0)
 ..S SDCL=$$GET1^DIQ(2.98,SDADT_","_DFN_",",.01,"I")
"RTN","SDRPA00",122,0)
 ..Q:SDCL=""  ;
"RTN","SDRPA00",123,0)
 ..I SDCLO="" S SDCLO=SDCL
"RTN","SDRPA00",124,0)
 ..I SDDAM'?7N!(SDDAM'>3020831) S SDDAM=SDDAMO ; need to finalize the previously sent
"RTN","SDRPA00",125,0)
 ..; Check status. If it is a termination, continue.
"RTN","SDRPA00",126,0)
 ..Q:$D(^TMP("SDDPT",$J,DFN,SDADT))  ; overridden to be process next time
"RTN","SDRPA00",127,0)
 ..;anothercross reference entry will be created; do not need to quit
"RTN","SDRPA00",128,0)
 ..;Q:$D(^SDWL(409.6,"AC",DFN,SDADT,+$G(CRUNID)))  ;see above
"RTN","SDRPA00",129,0)
 ..S SDSTAT=""
"RTN","SDRPA00",130,0)
 ..I SDDAM'=SDDAMO!(SDCL'=SDCLO) D
"RTN","SDRPA00",131,0)
 ...; create CT status; the current SDADT has different creation date
"RTN","SDRPA00",132,0)
 ...S SDSTAT="S15"_U_"F"_U_"CT"_U_U_U_U_U S SDDAM=SDDAMO,SDCL=SDCLO
"RTN","SDRPA00",133,0)
 ..I SDSTAT="" D NOW^%DTC N SDTODAY S SDTODAY=X S SDSTAT=$$STATUS^SDRPA05(DFN,SDADT,SDCL,SDTODAY,0)
"RTN","SDRPA00",134,0)
 ..I $P(SDSTAT,"^")=0 Q
"RTN","SDRPA00",135,0)
 ..N SDCOA,SDMSHA S SDCOA=$P(SDSTAT,U,5) S SDMSHA=$P(SDSTAT,U),SD6A=$P(SDSTAT,U,3),SD8A=$P(SDSTAT,U,4)
"RTN","SDRPA00",136,0)
 ..N SDCLL S SDCLL=$P(SDSTAT,U,6) I SDCLL'="" S SDCL=SDCLL
"RTN","SDRPA00",137,0)
 ..S SDSTTY=$P(SDSTAT,U,2)
"RTN","SDRPA00",138,0)
 ..I SDSTTY="P"&(SDREJ="") Q  ;do not send in pending status if not rejected ;esw
"RTN","SDRPA00",139,0)
 ..N SDCE Q:'$$DPT^SDRPA08(DFN,.SDCE)  ; Create demographic node of ^TMP file. Quit if this failed.
"RTN","SDRPA00",140,0)
 ..N DIC,DA,X D
"RTN","SDRPA00",141,0)
 ...N SDRET S SDRET=$S(SDSTTY="F":"N",1:"Y")
"RTN","SDRPA00",142,0)
 ...S DIC="^SDWL(409.6,"_CRUNID_",1,",DA(1)=CRUNID,DIC("P")=409.69,DIC(0)="X"
"RTN","SDRPA00",143,0)
 ...K DO S X=DFN D FILE^DICN
"RTN","SDRPA00",144,0)
 ...S DA=+Y,DIE=DIC,DA=+Y,DR="1///"_SDADT_";4///"_SDRET_";5///"_SD6A_";6///"_SDDAM_";8///"_SD8A_";9////"_SDCL D ^DIE
"RTN","SDRPA00",145,0)
 ...Q
"RTN","SDRPA00",146,0)
 ..N DIC,DA D
"RTN","SDRPA00",147,0)
 ...; not rejected can be sent only as 'S'- sent as final
"RTN","SDRPA00",148,0)
 ...N SDRET S SDRET=$S(SDREJ'="":"R",1:"S") ; indicates that it was: R - sent as rejected, S - sent as final
"RTN","SDRPA00",149,0)
 ...S DIC="^SDWL(409.6,"_RUNID_",1,",DA(1)=RUNID
"RTN","SDRPA00",150,0)
 ...S DA=APPTID,DIE=DIC,DR="4////"_SDRET D ^DIE
"RTN","SDRPA00",151,0)
 ...Q
"RTN","SDRPA00",152,0)
 ..D APPT^SDRPA08(DFN,SDADT,$$DTCONV^SDRPA08(SDDAM),SDCL,SDSTAT)
"RTN","SDRPA00",153,0)
 ..S SDFF=$P(SDSTAT,"^",4) D STAT(SDSTTY,SDFF,.SDFIN,.SDPEN,.SDF)
"RTN","SDRPA00",154,0)
 ..S SDTR=SDTR+1 I SDTR=5000 D SNDS19^SDRPA07(ZTSK,.SDBCID,.SDMCID) K ^TMP("SDDPT",$J) S SDTR=0
"RTN","SDRPA00",155,0)
 ..Q
"RTN","SDRPA00",156,0)
 .Q
"RTN","SDRPA00",157,0)
 Q:SDOUT
"RTN","SDRPA00",158,0)
 I $O(^TMP("SDDPT",$J,"")) D SNDS19^SDRPA07(ZTSK,.SDBCID,.SDMCID)
"RTN","SDRPA00",159,0)
 K ^TMP("SDDPT",$J)
"RTN","SDRPA00",160,0)
 D MSGT^SDRPA03(CRUNID,SDPEN,SDFIN)
"RTN","SDRPA00",161,0)
 Q
"RTN","SDRPA00",162,0)
STMES ;generate start message
"RTN","SDRPA00",163,0)
 N SDS,SD870,SD87
"RTN","SDRPA00",164,0)
 S SD870=$O(^HLCS(870,"B","SD-PAIT",""))
"RTN","SDRPA00",165,0)
 N ARRAY D GETS^DIQ(870,SD870_",",4,"I","ARRAY")
"RTN","SDRPA00",166,0)
 N SD87 S SD87=SD870_","
"RTN","SDRPA00",167,0)
 S SDSTAT=ARRAY(870,SD87,4,"I")
"RTN","SDRPA00",168,0)
 D NOW^%DTC
"RTN","SDRPA00",169,0)
 N SDDT,SDST S SDDT=%
"RTN","SDRPA00",170,0)
 S SDST=$P($$SITE^VASITE(),"^",3)
"RTN","SDRPA00",171,0)
 N SDAMX,XMSUB,CMY,XMTEXT,XMDUZ
"RTN","SDRPA00",172,0)
 S XMSUB=$G(SDST)_" - PAIT START JOB"
"RTN","SDRPA00",173,0)
 S XMY("G.SD-PAIT")=""
"RTN","SDRPA00",174,0)
 S XMY("S.SD-PAIT-SERVER@FORUM.VA.GOV")=""
"RTN","SDRPA00",175,0)
 S XMTEXT="SDAMX("
"RTN","SDRPA00",176,0)
 S XMDUZ="POSTMASTER"
"RTN","SDRPA00",177,0)
 S SDAMX(1)="The PAIT job has started - TASK #: "_ZTSK
"RTN","SDRPA00",178,0)
 S SDAMX(2)="Site   Started       SD-PAIT status    Task #"
"RTN","SDRPA00",179,0)
 S SDAMX(3)=SDST_"  |"_SDDT_" |"_SDSTAT_"    |"_ZTSK
"RTN","SDRPA00",180,0)
 ;
"RTN","SDRPA00",181,0)
 I SDSTAT="Shutdown" S XMY("VHACIONHD@MED.VA.GOV")="" D
"RTN","SDRPA00",182,0)
 .S SDAMX(4)=" Please start NOIS call for station "_SDST
"RTN","SDRPA00",183,0)
 .S SDAMX(5)="SD-PAIT Logical Link has to be started."
"RTN","SDRPA00",184,0)
 .S SDAMX(6)=""
"RTN","SDRPA00",185,0)
 D ^XMD
"RTN","SDRPA00",186,0)
 Q
"RTN","SDRPA00",187,0)
 ;
"RTN","SDRPA00",188,0)
GT90DAYS(X1,X2) ; Date is older than Sep 1st 2003, see specs.
"RTN","SDRPA00",189,0)
 ; X1 - creation date. More efficient to have it set at the top instead of every time this subroutine is called.
"RTN","SDRPA00",190,0)
 ; X2 - comparison date, now sent as Sep 1 2003, both in Vista format cyymmdd
"RTN","SDRPA00",191,0)
 D ^%DTC
"RTN","SDRPA00",192,0)
 Q X>0  ;
"RTN","SDRPA00",193,0)
STAT(SDSTTY,SDFF,SDFIN,SDPEN,SDF) ;summarize pending and finals
"RTN","SDRPA00",194,0)
 I SDSTTY="F" S SDFIN=SDFIN+1 Q
"RTN","SDRPA00",195,0)
 I SDSTTY="P" S SDPEN=SDPEN+1 I SDFF="F" S SDF=SDF+1
"RTN","SDRPA00",196,0)
 Q
"RTN","SDRPA02")
0^2^B12428480
"RTN","SDRPA02",1,0)
SDRPA02 ;bp-oifo/swo pait utils ; 9/10/04 9:33am
"RTN","SDRPA02",2,0)
 ;;5.3;Scheduling;**349,376**;AUG 13, 1993
"RTN","SDRPA02",3,0)
 Q       ;no entry from top
"RTN","SDRPA02",4,0)
DUP(RUNIEN,BATCHIDO) ;check for duplicate ACK response
"RTN","SDRPA02",5,0)
 ;RUNIEN     :  the ien in file 409.6 of the run
"RTN","SDRPA02",6,0)
 ;BATCHIDO   :  batchid pulled from the ACK message
"RTN","SDRPA02",7,0)
 ;V3         :  returns 0 if dup ACK or error and 1 new ACK
"RTN","SDRPA02",8,0)
 N V1,V2,V3,VNODE
"RTN","SDRPA02",9,0)
 S V3=0
"RTN","SDRPA02",10,0)
 I $G(RUNIEN)="" Q V3
"RTN","SDRPA02",11,0)
 I $G(BATCHIDO)="" Q V3
"RTN","SDRPA02",12,0)
 I $G(^SDWL(409.6,RUNIEN,2,0))="" Q V3
"RTN","SDRPA02",13,0)
 S V1=$O(^SDWL(409.6,RUNIEN,2,"B",BATCHIDO,"")) I V1="" Q V3
"RTN","SDRPA02",14,0)
 S VNODE=$G(^SDWL(409.6,RUNIEN,2,V1,0))
"RTN","SDRPA02",15,0)
 I $P(VNODE,"^")'=BATCHIDO Q V3
"RTN","SDRPA02",16,0)
 I $P(VNODE,"^",4)="" S V3=1
"RTN","SDRPA02",17,0)
 Q V3
"RTN","SDRPA02",18,0)
RSTAT ;check the status of the last run
"RTN","SDRPA02",19,0)
 ;V1     :  last run ien
"RTN","SDRPA02",20,0)
 ;VNODE  :  zero node of the run
"RTN","SDRPA02",21,0)
 ;ZTSK   :  the task number
"RTN","SDRPA02",22,0)
 N V1,V2,V3,VNODE,ZTSK
"RTN","SDRPA02",23,0)
 S V1=$O(^SDWL(409.6,999999999),-1) Q:'V1
"RTN","SDRPA02",24,0)
 S VNODE=$G(^SDWL(409.6,V1,0)) Q:VNODE=""
"RTN","SDRPA02",25,0)
 I $P(VNODE,"^",7) Q  ;the run has finished
"RTN","SDRPA02",26,0)
 S ZTSK=$P(VNODE,"^",2) Q:'ZTSK
"RTN","SDRPA02",27,0)
 D STAT^%ZTLOAD
"RTN","SDRPA02",28,0)
 I ZTSK(1)=1!(ZTSK(1)=2) Q  ;still running
"RTN","SDRPA02",29,0)
 ;S V2=$$RPAIT^SDRPA03(V1) ADD MESSAGE TO HELP DESK THAT TASK ERRORED
"RTN","SDRPA02",30,0)
 Q
"RTN","SDRPA02",31,0)
RUNCK() ;date check for run start
"RTN","SDRPA02",32,0)
 ;V1     :  ien file 19.2
"RTN","SDRPA02",33,0)
 ;V2     :  returns 0=do not run, 1=okay to run
"RTN","SDRPA02",34,0)
 ;V3     :  1st day of scheduling pattern
"RTN","SDRPA02",35,0)
 ;V4     :  2nd day of scheduling pattern
"RTN","SDRPA02",36,0)
 ;VNODE  :  zero node of 19.2
"RTN","SDRPA02",37,0)
 ;VDAY   :  current day plussed
"RTN","SDRPA02",38,0)
 ;run may be started on the 1st or 15th with a 3 day grace window
"RTN","SDRPA02",39,0)
 ;if no entry in 19.2 allow to run anytime
"RTN","SDRPA02",40,0)
 ;if scheduling pattern is not 1M(1,15) allow to run anytime
"RTN","SDRPA02",41,0)
 N V1,V2,V3,V4,VNODE,VDAY
"RTN","SDRPA02",42,0)
 S V2=0
"RTN","SDRPA02",43,0)
 S V1=$O(^DIC(19,"B","SD-PAIT TASKED TRANSMISSION","")) ;is the option scheduled?
"RTN","SDRPA02",44,0)
 S V1=$O(^DIC(19.2,"B",V1,""))
"RTN","SDRPA02",45,0)
 I V1="" S V2=1 D NSMSG Q V2  ;not scheduled, allow to run anytime
"RTN","SDRPA02",46,0)
 S VNODE=$G(^DIC(19.2,V1,0))
"RTN","SDRPA02",47,0)
 I VNODE="" S V2=1 Q V2  ;b xref, but no entry, allow to run anytime
"RTN","SDRPA02",48,0)
 I $P(VNODE,"^",6)'?1"1M("1.2N1","1.2N1")" S V2=1 D NSMSG Q V2  ;not our scheduling pattern, allow to run anytime
"RTN","SDRPA02",49,0)
 S V3=+$P($P($P(VNODE,"^",6),"(",2),",") ;1st date in month to run
"RTN","SDRPA02",50,0)
 S V4=+$P($P($P(VNODE,"^",6),",",2),")") ;2nd date in month to run
"RTN","SDRPA02",51,0)
 S VDAY=+$E($$DT^XLFDT(),6,7)
"RTN","SDRPA02",52,0)
 I VDAY'=V3,VDAY'=(V3+1),VDAY'=(V3+2),VDAY'=(V3+3),VDAY'=V4,VDAY'=(V4+1),VDAY'=(V4+2),VDAY'=(V4+3) D NRMSG Q V2
"RTN","SDRPA02",53,0)
 S V2=1
"RTN","SDRPA02",54,0)
 Q V2
"RTN","SDRPA02",55,0)
NRMSG ;no run message
"RTN","SDRPA02",56,0)
 N XMSUB,XMY,XMTEXT,XMDUZ,SDAMX,SDNOW,SDNAM
"RTN","SDRPA02",57,0)
 S XMSUB="PAIT Transmission"
"RTN","SDRPA02",58,0)
 S XMY("G.SD-PAIT")=""
"RTN","SDRPA02",59,0)
 S XMTEXT="SDAMX("
"RTN","SDRPA02",60,0)
 S XMDUZ="POSTMASTER"
"RTN","SDRPA02",61,0)
 S SDNOW=$$HTE^XLFDT($H,)
"RTN","SDRPA02",62,0)
 S SDNAM=$$GET1^DIQ(200,+$G(DUZ)_",",.01,"I")
"RTN","SDRPA02",63,0)
 S SDAMX(1)=SDNAM_" (DUZ="_DUZ_") attempted to start the PAIT transmission"
"RTN","SDRPA02",64,0)
 S SDAMX(2)="on "_SDNOW_", outside the authorized transmission dates."
"RTN","SDRPA02",65,0)
 S SDAMX(3)="The job has been cancelled"
"RTN","SDRPA02",66,0)
 D ^XMD
"RTN","SDRPA02",67,0)
 Q
"RTN","SDRPA02",68,0)
NSMSG ;non scheduled start-up
"RTN","SDRPA02",69,0)
 N XMSUB,XMY,XMTEXT,XMDUZ,SDAMX,SDNOW,SDNAM
"RTN","SDRPA02",70,0)
 S XMSUB="PAIT Transmission"
"RTN","SDRPA02",71,0)
 S XMY("G.SD-PAIT")=""
"RTN","SDRPA02",72,0)
 ;S XMY("VHACIONHD@MED.VA.GOV")
"RTN","SDRPA02",73,0)
 S XMTEXT="SDAMX("
"RTN","SDRPA02",74,0)
 S XMDUZ="POSTMASTER"
"RTN","SDRPA02",75,0)
 S SDNOW=$$HTE^XLFDT($H,)
"RTN","SDRPA02",76,0)
 S SDNAM=$$GET1^DIQ(200,+$G(DUZ)_",",.01,"I")
"RTN","SDRPA02",77,0)
 S SDAMX(1)=SDNAM_" (DUZ="_DUZ_") started the PAIT transmission "
"RTN","SDRPA02",78,0)
 S SDAMX(2)="on "_SDNOW_".  Option SD-PAIT TASKED TRANSMISSION has no "
"RTN","SDRPA02",79,0)
 S SDAMX(3)="entry or an incorrect entry for scheduling frequency.  The correct frequency "
"RTN","SDRPA02",80,0)
 S SDAMX(4)="is 1M(1,15).  The National Help Desk has been notified to initiate a NOIS"
"RTN","SDRPA02",81,0)
 D ^XMD
"RTN","SDRPA02",82,0)
 Q
"RTN","SDRPA03")
0^3^B31121600
"RTN","SDRPA03",1,0)
SDRPA03 ;BP-OIFO/ESW - PAIT - SDRPA00 continuation  ; 11/2/04 10:09am
"RTN","SDRPA03",2,0)
 ;;5.3;Scheduling;**349,376**;Aug 13, 1993
"RTN","SDRPA03",3,0)
 Q
"RTN","SDRPA03",4,0)
MSGT(CRUNID,SDPEN,SDFIN,SDTOT,SDSTOP) ;create completion messages
"RTN","SDRPA03",5,0)
 ;CRUNID - current run number
"RTN","SDRPA03",6,0)
 ;SDPEN  - pendings
"RTN","SDRPA03",7,0)
 ;SDFIN  - finals
"RTN","SDRPA03",8,0)
 ;SDTOT  - total
"RTN","SDRPA03",9,0)
 ;SDSTOP - task stop flag
"RTN","SDRPA03",10,0)
 N SDB,SDTRF
"RTN","SDRPA03",11,0)
 I '$D(SDTOT) S SDTOT=SDPEN+SDFIN
"RTN","SDRPA03",12,0)
 N SFF S SFF=0
"RTN","SDRPA03",13,0)
 I +SDTOT=0 S (SDPEN,SDFIN)=0,SFF=1
"RTN","SDRPA03",14,0)
 I '$D(SDPEN),'$D(SDFIN) S (SDPEN,SDFIN)="undetermined",SFF=1
"RTN","SDRPA03",15,0)
 N SDB,SDTRF
"RTN","SDRPA03",16,0)
 S SDB=SDTOT\5000 I SDTOT-(5000*SDB)>0 S SDB=SDB+1 ;# of batches
"RTN","SDRPA03",17,0)
 N NOW S NOW=$$NOW^XLFDT S SDTRF=$$FMTE^XLFDT(NOW,2),SDTRF=$P(SDTRF,":",1,2)
"RTN","SDRPA03",18,0)
 N DA,DIE,DR D
"RTN","SDRPA03",19,0)
 .S DA=CRUNID,DIE=409.6,DR="1.3///"_SDTOT_";1.4///"_SDB_";1.5///"_NOW D ^DIE
"RTN","SDRPA03",20,0)
 D CLEAN(CRUNID)
"RTN","SDRPA03",21,0)
 N SDS,SDSTAT,SDIP,SDAR,SDAP,SDMT,SDMS,SD870
"RTN","SDRPA03",22,0)
 ;SDS - STATION #
"RTN","SDRPA03",23,0)
 ;SDSTAT - SD-PAIT STATUS
"RTN","SDRPA03",24,0)
 ;SDAIP  - IP ADDRESS
"RTN","SDRPA03",25,0)
 ;SDAR   - COMMIT ACK RECEIVED
"RTN","SDRPA03",26,0)
 ;SDAP   - COMMIT ACK PROCESSED
"RTN","SDRPA03",27,0)
 ;SDMT   - MESSAGES (BATCHES) TO SEND
"RTN","SDRPA03",28,0)
 ;SDMS   - MESSAGES (BATCHES) SENT
"RTN","SDRPA03",29,0)
 S SD870=$O(^HLCS(870,"B","SD-PAIT",""))
"RTN","SDRPA03",30,0)
 N ARRAY D GETS^DIQ(870,SD870_",","4;5;6;7;8;400.01","I","ARRAY")
"RTN","SDRPA03",31,0)
 N SD87 S SD87=SD870_","
"RTN","SDRPA03",32,0)
 S SDSTAT=ARRAY(870,SD87,4,"I")
"RTN","SDRPA03",33,0)
 S SDAR=ARRAY(870,SD87,5,"I")
"RTN","SDRPA03",34,0)
 S SDAP=ARRAY(870,SD87,6,"I")
"RTN","SDRPA03",35,0)
 S SDMS=ARRAY(870,SD87,7,"I")
"RTN","SDRPA03",36,0)
 S SDMT=ARRAY(870,SD87,8,"I")
"RTN","SDRPA03",37,0)
 S SDIP=ARRAY(870,SD87,400.01,"I")
"RTN","SDRPA03",38,0)
 S SDS=$P($$SITE^VASITE(),"^",3)
"RTN","SDRPA03",39,0)
 ;S SDS=$E($O(^SDWL(409.6,"AMSG","")),1,3)
"RTN","SDRPA03",40,0)
 N SDBT,STSK,SDSL ; Starting and Last scanned date
"RTN","SDRPA03",41,0)
 S SDBT=$P(^SDWL(409.6,CRUNID,0),U),SDSL=$P(^SDWL(409.6,CRUNID,0),U,4)
"RTN","SDRPA03",42,0)
 S STSK=$P(^SDWL(409.6,CRUNID,0),U,2)
"RTN","SDRPA03",43,0)
 S SDBT=$$FMTE^XLFDT(SDBT,2),SDSL=$$FMTE^XLFDT(SDSL,2)
"RTN","SDRPA03",44,0)
MSG ;send mail message
"RTN","SDRPA03",45,0)
 N SDAMX,XMSUB,XMY,XMTEXT,XMDUZ
"RTN","SDRPA03",46,0)
 S XMSUB=$G(SDS)_" - PAIT BACKGROUND JOB"
"RTN","SDRPA03",47,0)
 S XMY("G.SD-PAIT")=""
"RTN","SDRPA03",48,0)
 S XMY("S.SD-PAIT-SERVER@FORUM.VA.GOV")=""
"RTN","SDRPA03",49,0)
 S XMTEXT="SDAMX("
"RTN","SDRPA03",50,0)
 S DUZ="" S XMDUZ="POSTMASTER"
"RTN","SDRPA03",51,0)
 S SDAMX(1)=""
"RTN","SDRPA03",52,0)
 S SDAMX(2)="The PAIT job has completed - TASK #: "_STSK_" Log #: "_CRUNID_" on "_SDTRF
"RTN","SDRPA03",53,0)
 S SDAMX(3)="Started: "_SDBT_"                        Last Scanned: "_SDSL
"RTN","SDRPA03",54,0)
 S SDAMX(4)="Pending appointments: "_$J(SDPEN,10)
"RTN","SDRPA03",55,0)
 S SDAMX(5)="Final appointments:   "_$J(SDFIN,10)
"RTN","SDRPA03",56,0)
 S SDAMX(6)="                       ----------"
"RTN","SDRPA03",57,0)
 S SDAMX(7)="Total appointments:   "_$J(SDTOT,10)_"   Number of batches: "_SDB
"RTN","SDRPA03",58,0)
 S SDAMX(8)=""
"RTN","SDRPA03",59,0)
 S SDAMX(9)="Fac Log Bch Appt #  Date finished  IP Address  Gen  Sent Com R Com P  Status"
"RTN","SDRPA03",60,0)
 S SDAMX(10)="-----------------------------------------------------------------------"
"RTN","SDRPA03",61,0)
 S SDAMX(11)=SDS_"|"_$J(CRUNID,3)_"|"_$J(SDB,3)_"|"_$J(SDTOT,7)_"|"_SDTRF_"|"_$J(SDIP,11)_"|"_$J(SDMT,4)_"|"_$J(SDMS,4)_"|"_$J(SDAR,4)_"|"_$J(SDAP,4)_"| "_SDSTAT
"RTN","SDRPA03",62,0)
 S SDAMX(12)=""
"RTN","SDRPA03",63,0)
 I $G(SDSTOP) S XMY("VHACIONHD@MED.VA.GOV")="" D  D ^XMD Q
"RTN","SDRPA03",64,0)
 .S SDAMX(13)="WARNING: TASK STOPPED BY USER, NEEDS TO BE RESTARTED."
"RTN","SDRPA03",65,0)
 .S SDAMX(14)="INITIATE a NOIS TO FOLLOW UP."
"RTN","SDRPA03",66,0)
 I 'SFF I SDMT>0!(SDB=0) D  D ^XMD Q
"RTN","SDRPA03",67,0)
 .I (SDMT-SDMS)=0 D  Q
"RTN","SDRPA03",68,0)
 ..S SDAMX(13)="SUCCESS: Transmission completed."
"RTN","SDRPA03",69,0)
 .I (SDMT-SDMS)<SDB D  Q
"RTN","SDRPA03",70,0)
 ..S SDAMX(13)="WARNING: "_(SDMT-SDMS)_" out of "_SDB_" still have to be transmitted,"
"RTN","SDRPA03",71,0)
 ..S SDAMX(14)="please verify with the HL7 System Monitor."
"RTN","SDRPA03",72,0)
 .S XMY("VHACIONHD@MED.VA.GOV")=""
"RTN","SDRPA03",73,0)
 .I SDMT-SDMS'<SDB D  Q
"RTN","SDRPA03",74,0)
 ..S XMY("VHACIONHD@MED.VA.GOV")=""
"RTN","SDRPA03",75,0)
 ..I SDSTAT["Shutdown" S SDAMX(13)="SD-PAIT Logical Link has to be started!"
"RTN","SDRPA03",76,0)
 ..E  S SDAMX(13)="Initiate a NOIS for VistA Interface Engine - communication problem."
"RTN","SDRPA03",77,0)
 ;D ^XMD
"RTN","SDRPA03",78,0)
 K ^TMP("SDDPT",$J)
"RTN","SDRPA03",79,0)
 Q
"RTN","SDRPA03",80,0)
CLEAN(CRUNID) ;housekeeping
"RTN","SDRPA03",81,0)
 ;clean up batches previous to current one by checking for "AE",("S" or "R") xref and
"RTN","SDRPA03",82,0)
 ;deleting if entry in xref exists
"RTN","SDRPA03",83,0)
 ;RUN  :  run #           (ien of multiple entry)
"RTN","SDRPA03",84,0)
 ;V1   :  previous run #  (ien of multiple entry)  
"RTN","SDRPA03",85,0)
 ;V2   :  ien           (ien in multiple)
"RTN","SDRPA03",86,0)
 N V1,V2,V3,ZNODE,DIK
"RTN","SDRPA03",87,0)
 S V1=CRUNID F  S V1=$O(^SDWL(409.6,V1),-1) Q:'V1  D
"RTN","SDRPA03",88,0)
 .F V3="R","S" S V2=0 F  S V2=$O(^SDWL(409.6,"AE",V3,V1,V2)) Q:'V2  D
"RTN","SDRPA03",89,0)
 ..S ZNODE=$G(^SDWL(409.6,V1,1,V2,0))
"RTN","SDRPA03",90,0)
 ..S ^XTMP("SDRPA-"_$P(ZNODE,"^",3),0)=$$HTFM^XLFDT($H+7,1)_U_$$HTFM^XLFDT($H,1)
"RTN","SDRPA03",91,0)
 ..S DIK="^SDWL(409.6,"_V1_",1,"
"RTN","SDRPA03",92,0)
 ..S DA(1)=V1,DA=V2 D ^DIK
"RTN","SDRPA03",93,0)
 ..S ^XTMP("SDRPA-"_$P(ZNODE,"^",3),"CLEAN",+$P(ZNODE,"^",4),0)=ZNODE ;diagnostics
"RTN","SDRPA03",94,0)
 Q
"RTN","SDRPA03",95,0)
RPAIT(RUN) ;
"RTN","SDRPA03",96,0)
 ;RUN - run number - entry ^SDWL(409.6,RUN,0) to be repaired
"RTN","SDRPA03",97,0)
 N SDE,SDEB,SDFE,SDLSD,SDRCNT,SDLSD1,SDLSD2
"RTN","SDRPA03",98,0)
 Q:+$G(RUN)'>1
"RTN","SDRPA03",99,0)
 S SDE=$G(^SDWL(409.6,RUN,0)) Q:SDE=""
"RTN","SDRPA03",100,0)
 S SDEB=+$P(SDE,"^",3) ; last batch # submitted to HL7
"RTN","SDRPA03",101,0)
 S SDRCNT=$O(^SDWL(409.6,RUN,1,999999999),-1) ;last entry
"RTN","SDRPA03",102,0)
 I SDEB=0 S SDFE=0 S $P(^SDWL(409.6,RUN,0),U,4)=$P(^SDWL(409.6,RUN-1,0),U,4)
"RTN","SDRPA03",103,0)
 I +SDEB>0 D
"RTN","SDRPA03",104,0)
 .S SDFE=SDRCNT+1 F  S SDFE=$O(^SDWL(409.6,RUN,1,SDFE),-1) I $P(^SDWL(409.6,RUN,1,SDFE,0),U,3)=SDEB Q  ; last accepted entry
"RTN","SDRPA03",105,0)
 .S SDLSD1=$P(^SDWL(409.6,RUN,1,SDFE,0),U,7) ;retrieve the last used creation date of HL7 created 
"RTN","SDRPA03",106,0)
 .S SDLSD2=$P(^SDWL(409.6,RUN,1,SDFE+1,0),U,7)
"RTN","SDRPA03",107,0)
 .S SDLSD=$P(SDE,U,4) ; last scanned date
"RTN","SDRPA03",108,0)
 .I SDLSD="" D
"RTN","SDRPA03",109,0)
 ..S $P(^SDWL(409.6,RUN,0),U,4)=$S(SDLSD2>SDLSD1:SDLSD1,1:SDLSD1-1)
"RTN","SDRPA03",110,0)
 .E  S $P(^SDWL(409.6,RUN,0),U,4)=SDLSD-1
"RTN","SDRPA03",111,0)
 N SDS F SDS=SDFE+1:1:SDRCNT D EVAL(RUN,SDS) S DIK="^SDWL(409.6,"_RUN_",1,",DA(1)=RUN,DA=SDS D ^DIK
"RTN","SDRPA03",112,0)
 S SDB=SDFE\5000 I SDFE-(5000*SDB)>0 S SDB=SDB+1
"RTN","SDRPA03",113,0)
 S NOW=$$NOW^XLFDT
"RTN","SDRPA03",114,0)
 S $P(^SDWL(409.6,RUN,0),U,5)=SDFE
"RTN","SDRPA03",115,0)
 S $P(^SDWL(409.6,RUN,0),U,6)=SDB
"RTN","SDRPA03",116,0)
 S $P(^SDWL(409.6,RUN,0),U,7)=NOW
"RTN","SDRPA03",117,0)
 D MSGT(RUN,,,SDFE)
"RTN","SDRPA03",118,0)
 Q 1
"RTN","SDRPA03",119,0)
EVAL(RUN,SDS) ;
"RTN","SDRPA03",120,0)
 ;evaluate if to update any 'S' or 'R' Retention Flags for
"RTN","SDRPA03",121,0)
 ;the previous entry if exists.
"RTN","SDRPA03",122,0)
 N SDSTR,DFN,SDDT S SDSTR=^SDWL(409.6,RUN,1,SDS,0)
"RTN","SDRPA03",123,0)
 S DFN=+SDSTR,SDDT=$P(SDSTR,"^",2)
"RTN","SDRPA03",124,0)
 ;find a prior entry SDRUN
"RTN","SDRPA03",125,0)
 N SDRUN S SDRUN=$O(^SDWL(409.6,"AC",DFN,SDDT,RUN),-1) Q:SDRUN=""
"RTN","SDRPA03",126,0)
 N SDSQ S SDSQ=$O(^SDWL(409.6,"AC",DFN,SDDT,SDRUN,""))
"RTN","SDRPA03",127,0)
 N SDSTRP S SDSTRP=^SDWL(409.6,SDRUN,1,SDSQ,0)
"RTN","SDRPA03",128,0)
 N SDRET,DIC S SDRET=$P(SDSTRP,"^",5) I SDRET="S"!(SDRET="R") D
"RTN","SDRPA03",129,0)
 .S SDRET="Y",DIC="^SDWL(409.6,"_SDRUN_",1,",DA(1)=SDRUN,DA=SDSQ,DIE=DIC,DR="4///"_SDRET D ^DIE
"RTN","SDRPA03",130,0)
 Q
"RTN","SDRPA04")
0^18^B37937936
"RTN","SDRPA04",1,0)
SDRPA04 ;BP-OIFO/ESW - PAIT - REPAIR  ; 11/2/04 11:47am
"RTN","SDRPA04",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA04",3,0)
 Q
"RTN","SDRPA04",4,0)
MSGT(CRUNID,SDPEN,SDFIN,SDTOT,SDSTOP) ;create completion messages
"RTN","SDRPA04",5,0)
 ;CRUNID - current run number
"RTN","SDRPA04",6,0)
 ;SDPEN  - pendings
"RTN","SDRPA04",7,0)
 ;SDFIN  - finals
"RTN","SDRPA04",8,0)
 ;SDTOT  - total
"RTN","SDRPA04",9,0)
 ;SDSTOP - task stop flag
"RTN","SDRPA04",10,0)
 N SDB,SDTRF
"RTN","SDRPA04",11,0)
 I '$D(SDTOT) S SDTOT=SDPEN+SDFIN
"RTN","SDRPA04",12,0)
 N SFF S SFF=0
"RTN","SDRPA04",13,0)
 I +SDTOT=0 S (SDPEN,SDFIN)=0,SFF=1
"RTN","SDRPA04",14,0)
 I '$D(SDPEN),'$D(SDFIN) S (SDPEN,SDFIN)="undetermined",SFF=1
"RTN","SDRPA04",15,0)
 N SDB,SDTRF
"RTN","SDRPA04",16,0)
 S SDB=SDTOT\5000 I SDTOT-(5000*SDB)>0 S SDB=SDB+1 ;# of batches
"RTN","SDRPA04",17,0)
 N NOW S NOW=$$NOW^XLFDT S SDTRF=$$FMTE^XLFDT(NOW,2),SDTRF=$P(SDTRF,":",1,2)
"RTN","SDRPA04",18,0)
 N DA,DIE,DR D
"RTN","SDRPA04",19,0)
 .S DA=CRUNID,DIE=409.6,DR="1.3///"_SDTOT_";1.4///"_SDB_";1.5///"_NOW D ^DIE
"RTN","SDRPA04",20,0)
 D CLEAN(CRUNID)
"RTN","SDRPA04",21,0)
 N SDS,SDSTAT,SDIP,SDAR,SDAP,SDMT,SDMS,SD870
"RTN","SDRPA04",22,0)
 ;SDS - STATION #
"RTN","SDRPA04",23,0)
 ;SDSTAT - SD-PAIT STATUS
"RTN","SDRPA04",24,0)
 ;SDAIP  - IP ADDRESS
"RTN","SDRPA04",25,0)
 ;SDAR   - COMMIT ACK RECEIVED
"RTN","SDRPA04",26,0)
 ;SDAP   - COMMIT ACK PROCESSED
"RTN","SDRPA04",27,0)
 ;SDMT   - MESSAGES (BATCHES) TO SEND
"RTN","SDRPA04",28,0)
 ;SDMS   - MESSAGES (BATCHES) SENT
"RTN","SDRPA04",29,0)
 S SD870=$O(^HLCS(870,"B","SD-PAIT",""))
"RTN","SDRPA04",30,0)
 N ARRAY D GETS^DIQ(870,SD870_",","4;5;6;7;8;400.01","I","ARRAY")
"RTN","SDRPA04",31,0)
 N SD87 S SD87=SD870_","
"RTN","SDRPA04",32,0)
 S SDSTAT=ARRAY(870,SD87,4,"I")
"RTN","SDRPA04",33,0)
 S SDAR=ARRAY(870,SD87,5,"I")
"RTN","SDRPA04",34,0)
 S SDAP=ARRAY(870,SD87,6,"I")
"RTN","SDRPA04",35,0)
 S SDMS=ARRAY(870,SD87,7,"I")
"RTN","SDRPA04",36,0)
 S SDMT=ARRAY(870,SD87,8,"I")
"RTN","SDRPA04",37,0)
 S SDIP=ARRAY(870,SD87,400.01,"I")
"RTN","SDRPA04",38,0)
 S SDS=$P($$SITE^VASITE(),"^",3)
"RTN","SDRPA04",39,0)
 ;S SDS=$E($O(^SDWL(409.6,"AMSG","")),1,3)
"RTN","SDRPA04",40,0)
 N SDBT,STSK,SDSL ; Starting and Last scanned date
"RTN","SDRPA04",41,0)
 S SDBT=$P(^SDWL(409.6,CRUNID,0),U),SDSL=$P(^SDWL(409.6,CRUNID,0),U,4)
"RTN","SDRPA04",42,0)
 S STSK=$P(^SDWL(409.6,CRUNID,0),U,2)
"RTN","SDRPA04",43,0)
 S SDBT=$$FMTE^XLFDT(SDBT,2),SDSL=$$FMTE^XLFDT(SDSL,2)
"RTN","SDRPA04",44,0)
MSG ;send mail message
"RTN","SDRPA04",45,0)
 N SDAMX,XMSUB,XMY,XMTEXT,XMDUZ
"RTN","SDRPA04",46,0)
 S XMSUB=$G(SDS)_" - PAIT BACKGROUND JOB"
"RTN","SDRPA04",47,0)
 S XMY("G.SD-PAIT")=""
"RTN","SDRPA04",48,0)
 S XMY("S.SD-PAIT-SERVER@FORUM.VA.GOV")=""
"RTN","SDRPA04",49,0)
 S XMTEXT="SDAMX("
"RTN","SDRPA04",50,0)
 S DUZ=""
"RTN","SDRPA04",51,0)
 S XMDUZ="POSTMASTER"
"RTN","SDRPA04",52,0)
 S SDAMX(1)=""
"RTN","SDRPA04",53,0)
 S SDAMX(2)="The PAIT job has completed - TASK #: "_STSK_" Log #: "_CRUNID_" on "_SDTRF
"RTN","SDRPA04",54,0)
 S SDAMX(3)="Started: "_SDBT_"                        Last Scanned: "_SDSL
"RTN","SDRPA04",55,0)
 S SDAMX(4)="Pending appointments: "_$J(SDPEN,10)
"RTN","SDRPA04",56,0)
 S SDAMX(5)="Final appointments:   "_$J(SDFIN,10)
"RTN","SDRPA04",57,0)
 S SDAMX(6)="                       ----------"
"RTN","SDRPA04",58,0)
 S SDAMX(7)="Total appointments:   "_$J(SDTOT,10)_"   Number of batches: "_SDB
"RTN","SDRPA04",59,0)
 S SDAMX(8)=""
"RTN","SDRPA04",60,0)
 S SDAMX(9)="Fac Log Bch Appt #  Date finished  IP Address  Gen  Sent Com R Com P  Status"
"RTN","SDRPA04",61,0)
 S SDAMX(10)="-----------------------------------------------------------------------"
"RTN","SDRPA04",62,0)
 S SDAMX(11)=SDS_"|"_$J(CRUNID,3)_"|"_$J(SDB,3)_"|"_$J(SDTOT,7)_"|"_SDTRF_"|"_$J(SDIP,11)_"|"_$J(SDMT,4)_"|"_$J(SDMS,4)_"|"_$J(SDAR,4)_"|"_$J(SDAP,4)_"| "_SDSTAT
"RTN","SDRPA04",63,0)
 S SDAMX(12)=""
"RTN","SDRPA04",64,0)
 I $G(SDSTOP) S XMY("VHACIONHD@MED.VA.GOV")="" D  D ^XMD Q
"RTN","SDRPA04",65,0)
 .S SDAMX(13)="WARNING: TASK STOPPED BY USER, NEEDS TO BE RESTARTED."
"RTN","SDRPA04",66,0)
 .S SDAMX(14)="INITIATE a NOIS TO FOLLOW UP."
"RTN","SDRPA04",67,0)
 I 'SFF I SDMT>0!(SDB=0) D  D ^XMD Q
"RTN","SDRPA04",68,0)
 .I (SDMT-SDMS)=0 D  Q
"RTN","SDRPA04",69,0)
 ..S SDAMX(13)="SUCCESS: Transmission completed."
"RTN","SDRPA04",70,0)
 .I (SDMT-SDMS)<SDB D  Q
"RTN","SDRPA04",71,0)
 ..S SDAMX(13)="WARNING: "_(SDMT-SDMS)_" out of "_SDB_" batches still have to be transmitted,"
"RTN","SDRPA04",72,0)
 ..S SDAMX(14)="please verify with the HL7 System Monitor."
"RTN","SDRPA04",73,0)
 .S XMY("VHACIONHD@MED.VA.GOV")=""
"RTN","SDRPA04",74,0)
 .I SDMT-SDMS'<SDB D  Q
"RTN","SDRPA04",75,0)
 ..S XMY("VHACIONHD@MED.VA.GOV")=""
"RTN","SDRPA04",76,0)
 ..I SDSTAT["Shutdown" S SDAMX(13)="SD-PAIT Logical Link has to be started!"
"RTN","SDRPA04",77,0)
 ..E  S SDAMX(13)="Initiate a NOIS for VistA Interface Engine - communication problem."
"RTN","SDRPA04",78,0)
 I SFF S XMY("VHACIONHD@MED.VA.GOV")="" D  D ^XMD Q
"RTN","SDRPA04",79,0)
 .S SDAMX(13)="WARNING!!!: Transmission of run#: "_CRUNID_" has been repaired."
"RTN","SDRPA04",80,0)
 .S SDAMX(14)="Please create a NOIS to verify if the problem has been addressed."
"RTN","SDRPA04",81,0)
 .I SDB>0 I (SDMT-SDMS)'<SDB D
"RTN","SDRPA04",82,0)
 ..S SDAMX(15)="WARNING!!!: Transmission communication problem, please review."
"RTN","SDRPA04",83,0)
 ;D ^XMD
"RTN","SDRPA04",84,0)
 K ^TMP("SDDPT",$J)
"RTN","SDRPA04",85,0)
 Q
"RTN","SDRPA04",86,0)
CLEAN(CRUNID) ;housekeeping
"RTN","SDRPA04",87,0)
 ;clean up batches previous to current one by checking for "AE",("S" or "R") xref and
"RTN","SDRPA04",88,0)
 ;deleting if entry in xref exists
"RTN","SDRPA04",89,0)
 ;RUN  :  run #           (ien of multiple entry)
"RTN","SDRPA04",90,0)
 ;V1   :  previous run #  (ien of multiple entry)  
"RTN","SDRPA04",91,0)
 ;V2   :  ien           (ien in multiple)
"RTN","SDRPA04",92,0)
 N V1,V2,V3,ZNODE,DIK
"RTN","SDRPA04",93,0)
 S V1=CRUNID F  S V1=$O(^SDWL(409.6,V1),-1) Q:'V1  D
"RTN","SDRPA04",94,0)
 .F V3="R","S" S V2=0 F  S V2=$O(^SDWL(409.6,"AE",V3,V1,V2)) Q:'V2  D
"RTN","SDRPA04",95,0)
 ..S ZNODE=$G(^SDWL(409.6,V1,1,V2,0))
"RTN","SDRPA04",96,0)
 ..S ^XTMP("SDRPA-"_$P(ZNODE,"^",3),0)=$$HTFM^XLFDT($H+7,1)_U_$$HTFM^XLFDT($H,1)
"RTN","SDRPA04",97,0)
 ..S DIK="^SDWL(409.6,"_V1_",1,"
"RTN","SDRPA04",98,0)
 ..S DA(1)=V1,DA=V2 D ^DIK
"RTN","SDRPA04",99,0)
 ..S ^XTMP("SDRPA-"_$P(ZNODE,"^",3),"CLEAN",+$P(ZNODE,"^",4),0)=ZNODE ;diagnostics
"RTN","SDRPA04",100,0)
 Q
"RTN","SDRPA04",101,0)
RPAIT(RUN) ;
"RTN","SDRPA04",102,0)
 ;RUN - run number - entry ^SDWL(409.6,RUN,0) to be repaired
"RTN","SDRPA04",103,0)
 Q:+$G(RUN)'>1
"RTN","SDRPA04",104,0)
 W !,"The repairing in progress...",!
"RTN","SDRPA04",105,0)
 N SDE,SDEB,SDFE,SDLSD,SDRCNT,ZTSK
"RTN","SDRPA04",106,0)
 S SDE=$G(^SDWL(409.6,RUN,0)) Q:SDE=""
"RTN","SDRPA04",107,0)
 S ZTSK=$P(SDE,"^",2) D STAT^%ZTLOAD I ZTSK(1)=1!(ZTSK(1)=2) W !,"Task "_ZTSK_"is still active!" Q
"RTN","SDRPA04",108,0)
 S SDEB=+$P(SDE,"^",3) ; last batch # submitted to HL7
"RTN","SDRPA04",109,0)
 S SDRCNT=$O(^SDWL(409.6,RUN,1,999999999),-1) ;last entry
"RTN","SDRPA04",110,0)
 I SDEB=0 S SDFE=0 S $P(^SDWL(409.6,RUN,0),U,4)=$P(^SDWL(409.6,RUN-1,0),U,4)
"RTN","SDRPA04",111,0)
 I +SDEB>0 D
"RTN","SDRPA04",112,0)
 .S SDFE=SDRCNT+1 F  S SDFE=$O(^SDWL(409.6,RUN,1,SDFE),-1) I $P(^SDWL(409.6,RUN,1,SDFE,0),U,3)=SDEB Q  ; last accepted entry
"RTN","SDRPA04",113,0)
 .N SDLSD1 S SDLSD1=$P(^SDWL(409.6,RUN,1,SDFE,0),U,7) ;retrieve the last used creation date of HL7 created 
"RTN","SDRPA04",114,0)
 .N SDLSD2 S SDLSD2=$P($G(^SDWL(409.6,RUN,1,SDFE+1,0)),U,7)
"RTN","SDRPA04",115,0)
 .S SDLSD=$P(SDE,U,4) ; last scanned date
"RTN","SDRPA04",116,0)
 .I SDLSD="" D
"RTN","SDRPA04",117,0)
 ..S $P(^SDWL(409.6,RUN,0),U,4)=$S(SDLSD2>SDLSD1:SDLSD1,1:SDLSD1-1)
"RTN","SDRPA04",118,0)
 .E  S $P(^SDWL(409.6,RUN,0),U,4)=SDLSD-1
"RTN","SDRPA04",119,0)
 N SDS,DIK F SDS=SDFE+1:1:SDRCNT D EVAL(RUN,SDS) S DIK="^SDWL(409.6,"_RUN_",1,",DA(1)=RUN,DA=SDS D ^DIK
"RTN","SDRPA04",120,0)
 S SDB=SDFE\5000 I SDFE-(5000*SDB)>0 S SDB=SDB+1
"RTN","SDRPA04",121,0)
 S NOW=$$NOW^XLFDT
"RTN","SDRPA04",122,0)
 S $P(^SDWL(409.6,RUN,0),U,5)=SDFE
"RTN","SDRPA04",123,0)
 S $P(^SDWL(409.6,RUN,0),U,6)=SDB
"RTN","SDRPA04",124,0)
 S $P(^SDWL(409.6,RUN,0),U,7)=NOW
"RTN","SDRPA04",125,0)
 D MSGT(RUN,,,SDFE)
"RTN","SDRPA04",126,0)
 W !!,"The last run number has been repaired, you may ONE TIME QUEUE the next one.",!
"RTN","SDRPA04",127,0)
 Q
"RTN","SDRPA04",128,0)
EVAL(RUN,SDS) ;
"RTN","SDRPA04",129,0)
 ;evaluate if to update any 'S' or 'R' Retention Flags for
"RTN","SDRPA04",130,0)
 ;the previous entry if exists.
"RTN","SDRPA04",131,0)
 N SDSTR,DFN,SDDT S SDSTR=^SDWL(409.6,RUN,1,SDS,0)
"RTN","SDRPA04",132,0)
 S DFN=+SDSTR,SDDT=$P(SDSTR,"^",2)
"RTN","SDRPA04",133,0)
 ;find a prior entry SDRUN
"RTN","SDRPA04",134,0)
 N SDRUN S SDRUN=$O(^SDWL(409.6,"AC",DFN,SDDT,RUN),-1) Q:SDRUN=""
"RTN","SDRPA04",135,0)
 N SDSQ S SDSQ=$O(^SDWL(409.6,"AC",DFN,SDDT,SDRUN,""))
"RTN","SDRPA04",136,0)
 N SDSTRP S SDSTRP=^SDWL(409.6,SDRUN,1,SDSQ,0)
"RTN","SDRPA04",137,0)
 N SDRET S SDRET=$P(SDSTRP,"^",5)
"RTN","SDRPA04",138,0)
 I SDRET="S"!(SDRET="R") N DIC D
"RTN","SDRPA04",139,0)
 .S SDRET="Y",DIC="^SDWL(409.6,"_SDRUN_",1,",DA(1)=SDRUN,DA=SDSQ,DIE=DIC,DR="4///"_SDRET D ^DIE
"RTN","SDRPA04",140,0)
 Q
"RTN","SDRPA05")
0^4^B24254070
"RTN","SDRPA05",1,0)
SDRPA05 ;BP-OIFO/ESW - Evaluate appointment status for HL7  ; 9/10/04 9:34am
"RTN","SDRPA05",2,0)
 ;;5.3;Scheduling;**290,333,349,376**;AUG 13, 2003
"RTN","SDRPA05",3,0)
 ;Evaluation of the appointment status is done from the computed field to match the displayed/printed status in the appointment management
"RTN","SDRPA05",4,0)
 Q
"RTN","SDRPA05",5,0)
 ;
"RTN","SDRPA05",6,0)
STATUS(DFN,SDADT,SDCL,TODAY,SFD) ;
"RTN","SDRPA05",7,0)
 ;Input:
"RTN","SDRPA05",8,0)
 ;      SDADT - Appt date/time
"RTN","SDRPA05",9,0)
 ;      SDCL  - Clinic IEN
"RTN","SDRPA05",10,0)
 ;      SFD:   - 0 - if called from scanning previous runs - update
"RTN","SDRPA05",11,0)
 ;             - 1 - if called from scanning 2.98
"RTN","SDRPA05",12,0)
 ;Output: 
"RTN","SDRPA05",13,0)
 ;       SDSTAT=SDMSH_U_SD25_U_SD6_U_SD8_U_SDCO_U_SDCLL_U_SD8RD
"RTN","SDRPA05",14,0)
 ;        where:
"RTN","SDRPA05",15,0)
 ;              SDMSH -HL7 segment
"RTN","SDRPA05",16,0)
 ;              SD25  - Filler Status:
"RTN","SDRPA05",17,0)
 ;                                    P - Pending
"RTN","SDRPA05",18,0)
 ;                                    F - Final
"RTN","SDRPA05",19,0)
 ;              SD6   - Event Reason
"RTN","SDRPA05",20,0)
 ;              SD8   - Appt Type
"RTN","SDRPA05",21,0)
 ;              SD8RD - rescheduled date/time if SD8="RS"
"RTN","SDRPA05",22,0)
 ;              SDCO  - check out date
"RTN","SDRPA05",23,0)
 ;              SDCLL - clinic IEN from matching encounter
"RTN","SDRPA05",24,0)
 ;
"RTN","SDRPA05",25,0)
 N SD0,SDST,SD6,SD8,SD25,SDMSH,SDCO,SDSTAT,SD8S,SD8RD
"RTN","SDRPA05",26,0)
 S SDST=$$GET1^DIQ(2.98,SDADT_","_DFN_",",3,"I")
"RTN","SDRPA05",27,0)
 I SDST'="" I SDST'="NT"&(SDST'="I") D  Q SDSTAT
"RTN","SDRPA05",28,0)
 .S SD25="F",SDCO="",SD8RD=""
"RTN","SDRPA05",29,0)
 .I SDST="C" S SD6="CC",SD8="",SDMSH="S15" D  ;cancel by clinic
"RTN","SDRPA05",30,0)
 ..S SD8S=$$SCHEDULE(DFN,SDCL,SDADT),SD8=$P(SD8S,U),SD8RD=$P(SD8S,U,2)
"RTN","SDRPA05",31,0)
 .I SDST="CA" S SD6="CC",SD8="ABK",SDMSH="S15" ;cancel bt clinic and auto rebook
"RTN","SDRPA05",32,0)
 .I SDST="PC" S SD6="CP",SD8="",SDMSH="S15" D  ; cancel by patient
"RTN","SDRPA05",33,0)
 ..S SD8S=$$SCHEDULE(DFN,SDCL,SDADT),SD8=$P(SD8S,U),SD8RD=$P(SD8S,U,2)
"RTN","SDRPA05",34,0)
 .I SDST="PCA" S SD6="CP",SD8="ABK",SDMSH="S15" ;cancel by patient and auto rebook
"RTN","SDRPA05",35,0)
 .I SDST="NA" S SD6="NS",SD8="ABK",SDMSH="S26" ;no show and auto rebook
"RTN","SDRPA05",36,0)
 .I SDST="N" S SD6="NS",SD8="",SDMSH="S26" ;no show
"RTN","SDRPA05",37,0)
 .;evaluate 'non-count'
"RTN","SDRPA05",38,0)
 .I $P($G(^SC(SDCL,0)),U,17)="Y" D
"RTN","SDRPA05",39,0)
 ..I SD8="" S SD8="NC" Q
"RTN","SDRPA05",40,0)
 ..I SD8="RS" S SD8="RSN"
"RTN","SDRPA05",41,0)
 .;
"RTN","SDRPA05",42,0)
 .S SDSTAT=SDMSH_U_SD25_U_SD6_U_SD8_U_SDCO_U_U_SD8RD
"RTN","SDRPA05",43,0)
 ;process all others
"RTN","SDRPA05",44,0)
 S SD0=^DPT(DFN,"S",SDADT,0)
"RTN","SDRPA05",45,0)
 ; check out from OUTPAT ENCOUNTER
"RTN","SDRPA05",46,0)
 ;N SCE S SCE=$P(SD0,"^",20) S SDCO="" I SCE>0 S SDCO=$P(^SCE(SCE,0),"^",7)
"RTN","SDRPA05",47,0)
 N SCE S SCE=$P(SD0,"^",20) S SDCO="" I SCE>0,$D(^SCE(SCE,0)) S SDCO=$P(^SCE(SCE,0),"^",7)
"RTN","SDRPA05",48,0)
 N SDSTATX,SDX3
"RTN","SDRPA05",49,0)
 S SDSTATX=$$STATUS^SDAM1(DFN,SDADT,SDCL,SD0) ;call to compute the status (VistA)
"RTN","SDRPA05",50,0)
 ;SDSTATX=Appt status IFN in 409.63 ; status name ; print status ; check in ; check out 
"RTN","SDRPA05",51,0)
 I SDCO="" S SDCO=$P(SDSTATX,";",5) ; check out from clinic if NULL
"RTN","SDRPA05",52,0)
 I SDCO'=""&(+SDSTATX'=12) D  Q SDSTAT
"RTN","SDRPA05",53,0)
 .S SD6="CO",SD25="F",SD8="",SD8RD="",SDMSH=$S(SFD=0:"S14",1:"S12")
"RTN","SDRPA05",54,0)
 .I +SDSTATX=3 S SD8="AR" ; action required
"RTN","SDRPA05",55,0)
 .I +SDSTATX=8 S SD8="I" ;inpatient
"RTN","SDRPA05",56,0)
 .;I +SDSTATX=12 S SD8="NC" ;non-count excluded to be compared to possible encounter does not matter if check out
"RTN","SDRPA05",57,0)
 .I +SDSTATX=2 S SD8="O" ;outpatient
"RTN","SDRPA05",58,0)
 .S SDSTAT=SDMSH_U_SD25_U_SD6_U_SD8_U_SDCO_U_U_SD8RD
"RTN","SDRPA05",59,0)
 I +SDSTATX=3 D  Q SDSTAT
"RTN","SDRPA05",60,0)
 .S SD25="P",SDMSH="S12",SDCO="",SD8RD=""
"RTN","SDRPA05",61,0)
 .I $P(SDSTATX,";",4)'="" S SD6="CI",SD8="AR" ;check in/action required
"RTN","SDRPA05",62,0)
 .E  S SD6="",SD8="NAT",SD8RD="" ;no action taken
"RTN","SDRPA05",63,0)
 .S SDSTAT=SDMSH_U_SD25_U_SD6_U_SD8_U_SDCO_U_U_SD8RD
"RTN","SDRPA05",64,0)
 I +SDSTATX=8!(+SDSTATX=11) S SD25="P",SD8RD="" D  Q SDSTAT
"RTN","SDRPA05",65,0)
 .I +SDSTATX=8 S SD6="",SD8="I",SDCO="",SDMSH="S12" ;inpatient
"RTN","SDRPA05",66,0)
 .I +SDSTATX=11 S SD6="",SD8="F",SDCO="",SDMSH="S12" ;future
"RTN","SDRPA05",67,0)
 .S SDSTAT=SDMSH_U_SD25_U_SD6_U_SD8_U_SDCO_U_U_SD8RD
"RTN","SDRPA05",68,0)
 ;
"RTN","SDRPA05",69,0)
 ;process non-count (not checked out)
"RTN","SDRPA05",70,0)
 I +SDSTATX=12 N SDCLL S SDCLL="" D  S:SD6'="COE" SDCLL=SDCL S SDSTAT=SDMSH_U_SD25_U_SD6_U_SD8_U_SDCO_U_SDCLL Q SDSTAT
"RTN","SDRPA05",71,0)
 .S SD6="",SD8="NC",SDCO="",SDMSH="S12",SD25="P"
"RTN","SDRPA05",72,0)
 .I (SDADT\1)-(TODAY\1)>0 S SD6="",SD8="NCF",SD25="P" Q
"RTN","SDRPA05",73,0)
 .N SDADTC,SDSCE,SDADTCK S SDADTC=(SDADT\1)-1+.99,SDADTCK=SDADTC+1 F  D  Q:'SDSCE!(SD6="COE")
"RTN","SDRPA05",74,0)
 ..S SDSCE=$$EXAE^SDOE(DFN,SDADTC,SDADTCK)
"RTN","SDRPA05",75,0)
 ..I SDSCE>1 N SDDATA D GETGEN^SDOE(SDSCE,"SDDATA") D
"RTN","SDRPA05",76,0)
 ...N SDCL0,SDCL1,SDCL2
"RTN","SDRPA05",77,0)
 ...S SDCLL=$P(SDDATA(0),"^",4) I $P(^SC(SDCLL,0),"^",17)="Y" D  Q
"RTN","SDRPA05",78,0)
 ....S SDADTC=$P(^SCE(SDSCE,0),"^")+.000001 ;
"RTN","SDRPA05",79,0)
 ...S SDCL0=$P(^SC(SDCL,0),"^",7)_$P(^SC(SDCL,0),"^",18)
"RTN","SDRPA05",80,0)
 ...S SDCL2=$P(^SC(SDCLL,0),"^",7)_$P(^SC(SDCLL,0),"^",18)
"RTN","SDRPA05",81,0)
 ...I SDCL0'=SDCL2 S SDADTC=$P(^SCE(SDSCE,0),"^")+.000001 Q
"RTN","SDRPA05",82,0)
 ...; proceed if the same DSS IDs pairs
"RTN","SDRPA05",83,0)
 ...S SDCO=$P(SDDATA(0),"^",7)
"RTN","SDRPA05",84,0)
 ...I SDCO'="" S SD6="COE",SD25="F",SDMSH=$S(SFD=0:"S14",1:"S12") Q
"RTN","SDRPA05",85,0)
 ...;encounter exists but not in final (chek out) status
"RTN","SDRPA05",86,0)
 ...S SDADTC=$P(^SCE(SDSCE,0),"^")+.000001
"RTN","SDRPA05",87,0)
 .I SD6="COE" Q
"RTN","SDRPA05",88,0)
 .;check out by matching encounter
"RTN","SDRPA05",89,0)
 .E  I ((TODAY\1)-(SDADT\1))>2 D   ;give 2 days to update
"RTN","SDRPA05",90,0)
 ..S SD6="NM",SD25="F",SDMSH=$S(SFD=0:"S14",1:0) ;no match, to be skipped
"RTN","SDRPA05",91,0)
 Q 0
"RTN","SDRPA05",92,0)
 ;
"RTN","SDRPA05",93,0)
SCHEDULE(DFN,SDCL,SDADT) ; Scheduling flag
"RTN","SDRPA05",94,0)
 ; If the patient has another appointment created on the same day as the cancellation date of the canceled appt, and that
"RTN","SDRPA05",95,0)
 ; appointment is created for a clinic with the same stop code then return "RS".
"RTN","SDRPA05",96,0)
 ; If there is not another appointment made on the same day, return "".
"RTN","SDRPA05",97,0)
 N SDCDT,SDCLN S SDCDT=$$GET1^DIQ(2.98,SDADT_","_DFN_",",15,"I") ;cancellation date
"RTN","SDRPA05",98,0)
 Q:'SDCDT ""
"RTN","SDRPA05",99,0)
 N SDCDTI S SDCDTI=SDCDT\1
"RTN","SDRPA05",100,0)
 N SDRESCH S SDRESCH=""
"RTN","SDRPA05",101,0)
 ;exclude the same appointments
"RTN","SDRPA05",102,0)
 N SDAPDT S SDAPDT="" F  S SDAPDT=$O(^DPT("ASADM",SDCDTI,DFN,SDAPDT)) Q:SDAPDT=""  I SDAPDT'=SDADT I $D(^DPT(DFN,"S",SDAPDT)) D  Q:SDRESCH'=""
"RTN","SDRPA05",103,0)
 .S SDCLN=+$P(^DPT(DFN,"S",SDAPDT,0),U) I $P(^SC(SDCLN,0),"^",7)=$P(^SC(SDCL,0),"^",7) S SDRESCH="RS"_"^"_SDAPDT ;compare stop code pointers
"RTN","SDRPA05",104,0)
 S:SDRESCH="" SDRESCH="^" Q SDRESCH
"RTN","SDRPA06")
0^5^B58400495
"RTN","SDRPA06",1,0)
SDRPA06 ;bp-oifo/swo pait hl7 ack handling ; 10/31/04 3:53pm
"RTN","SDRPA06",2,0)
 ;;5.3;Scheduling;**290,333,349,376**;AUG 13, 1993
"RTN","SDRPA06",3,0)
 ;routine called from Vista HL7 when ack messages are received in response
"RTN","SDRPA06",4,0)
 ;to an out going HL7 message generated by protocol SC-PAIT-EVENT
"RTN","SDRPA06",5,0)
ACK ;entry point from Vista HL7
"RTN","SDRPA06",6,0)
 ;ACKDATE   :  date/time ack received
"RTN","SDRPA06",7,0)
 ;FLDSEP    :  field separator
"RTN","SDRPA06",8,0)
 ;CMPNTSEP  :  component separator
"RTN","SDRPA06",9,0)
 ;REPTNSEP  :  repetition separator
"RTN","SDRPA06",10,0)
 ;ACKCODE   :  acknowledgement code
"RTN","SDRPA06",11,0)
 ;ERROR     :  reject reason
"RTN","SDRPA06",12,0)
 ;BATCHID   :  batch control ID
"RTN","SDRPA06",13,0)
 ;BATCHIDO  :  original batch control ID
"RTN","SDRPA06",14,0)
 N ACKCODE,ACKDATE,BATCHID,BATCHIDO,CMPNTSEP,ERROR,FLDSEP,REPTNSEP,RUNIEN,SDZAP,V1
"RTN","SDRPA06",15,0)
 ;disable automatic repair of the last run, not needed to process acks
"RTN","SDRPA06",16,0)
 ;NHD will be notified when the completion message does not come out
"RTN","SDRPA06",17,0)
 ;D RSTAT^SDRPA02 ;check the status of the last run
"RTN","SDRPA06",18,0)
 K ^TMP("SDRPA06",$J)
"RTN","SDRPA06",19,0)
 S SDZAP=0
"RTN","SDRPA06",20,0)
 S ACKDATE=$$NOW^XLFDT()
"RTN","SDRPA06",21,0)
 S FLDSEP=HL("FS")
"RTN","SDRPA06",22,0)
 S CMPNTSEP=$E(HL("ECH"),1)
"RTN","SDRPA06",23,0)
 S REPTNSEP=$E(HL("ECH"),2)
"RTN","SDRPA06",24,0)
 S ACKCODE=$P(HLMSA,FLDSEP)
"RTN","SDRPA06",25,0)
 S ERROR=$P(HLMSA,FLDSEP,4)
"RTN","SDRPA06",26,0)
 S (BATCHID,BATCHIDO)=$P(HLMSA,FLDSEP,2)
"RTN","SDRPA06",27,0)
 S RUNIEN=$$RUNIEN(BATCHIDO) Q:'RUNIEN
"RTN","SDRPA06",28,0)
 S BATCHID=$$OURB(RUNIEN,BATCHIDO) ;convert to our batch id
"RTN","SDRPA06",29,0)
 Q:'BATCHID  ;error needs to be handled
"RTN","SDRPA06",30,0)
 ;S V1=$O(^SDWL(409.6,"AMSG",BATCHID,"")),RUNIEN=$O(^SDWL(409.6,"AMSG",BATCHID,V1,""))
"RTN","SDRPA06",31,0)
 S V1=$O(^SDWL(409.6,"AMSG",BATCHID,"")) Q:V1=""
"RTN","SDRPA06",32,0)
 Q:'$$DUP^SDRPA02(RUNIEN,BATCHIDO)  ;check for duplicate
"RTN","SDRPA06",33,0)
 S ^XTMP("SDRPA-"_BATCHID,0)=$$FMADD^XLFDT($$DT^XLFDT(),3)_"^"_$$DT^XLFDT() ;set xtmp global for diagnostics
"RTN","SDRPA06",34,0)
 I $E(ACKCODE,1,2)="AR" D AR(BATCHID,BATCHIDO),MSG(BATCHIDO,3,RUNIEN,BATCHID) Q  ;whole batch rejection
"RTN","SDRPA06",35,0)
 ;Q:($E(ACKCODE,1,2)'="AA")  ;quit if not a application ack
"RTN","SDRPA06",36,0)
 ;will only be 2 ACKCODEs AA and AE so don't have to screen anymore
"RTN","SDRPA06",37,0)
 F  X HLNEXT Q:(HLQUIT'>0)  D  ;start looping the msg text
"RTN","SDRPA06",38,0)
 . Q:($E(HLNODE,1,3)'="MSA")  ;skip if not a MSA segment
"RTN","SDRPA06",39,0)
 . I $P(HLNODE,FLDSEP,2)="AE" D  ;it's an error
"RTN","SDRPA06",40,0)
 .. Q:($P($P(HLNODE,FLDSEP,3),"-",2))=""  ;no message number
"RTN","SDRPA06",41,0)
 .. S ^TMP("SDRPA06",$J,+$P($P(HLNODE,FLDSEP,3),"-",2))=+$P(HLNODE,"^",4) ;set xref with message #
"RTN","SDRPA06",42,0)
 I '$D(^TMP("SDRPA06",$J)) D AA(BATCHID,BATCHIDO),MSG(BATCHIDO,2,RUNIEN,BATCHID) Q  ;whole batch accept
"RTN","SDRPA06",43,0)
 D AAAR(BATCHID,BATCHIDO),MSG(BATCHIDO,1,RUNIEN,BATCHID) ;batch accept with errors   
"RTN","SDRPA06",44,0)
 Q
"RTN","SDRPA06",45,0)
AR(BATCH,BATCHIDO) ;whole batch rejection
"RTN","SDRPA06",46,0)
 ;BATCH    :  originating batch number
"RTN","SDRPA06",47,0)
 ;BATCHIDO :  original batch number from HL7 ACK
"RTN","SDRPA06",48,0)
 ;V1       :  sequence #  (individual message number in batch)
"RTN","SDRPA06",49,0)
 ;V2       :  run #       (ien of multiple entry)
"RTN","SDRPA06",50,0)
 ;V3       :  ien         (ien in patient multiple)
"RTN","SDRPA06",51,0)
 ;V4       :  ien         (ien batch tracking multiple)
"RTN","SDRPA06",52,0)
 Q:($G(BATCH)="")
"RTN","SDRPA06",53,0)
 N DA,DIE,DR,V1,V2,V3,V4,ZNODE
"RTN","SDRPA06",54,0)
 S V1=0
"RTN","SDRPA06",55,0)
 F  S V1=$O(^SDWL(409.6,"AMSG",BATCH,V1)) Q:'V1  D
"RTN","SDRPA06",56,0)
 . S V2=$O(^SDWL(409.6,"AMSG",BATCH,V1,"")) Q:'V2
"RTN","SDRPA06",57,0)
 . ;batch tracking enhancement
"RTN","SDRPA06",58,0)
 . S V4=$O(^SDWL(409.6,V2,2,"B",BATCHIDO,"")) Q:'V4  D
"RTN","SDRPA06",59,0)
 .. S DA=V4,DA(1)=V2,DIE="^SDWL(409.6,"_V2_",2,",DR=".04///"_$$NOW^XLFDT_";.05///"_ACKCODE
"RTN","SDRPA06",60,0)
 .. D ^DIE K DIE
"RTN","SDRPA06",61,0)
 . S V3=0 F  S V3=$O(^SDWL(409.6,"AMSG",BATCH,V1,V2,V3)) Q:'V3  D
"RTN","SDRPA06",62,0)
 .. S ZNODE=$G(^SDWL(409.6,V2,1,V3,0)) Q:ZNODE=""
"RTN","SDRPA06",63,0)
 .. ;4TH PIECE IS MESSAGE NUMBER
"RTN","SDRPA06",64,0)
 .. S DA=V3,DA(1)=V2,DIE="^SDWL(409.6,"_V2_",1,"
"RTN","SDRPA06",65,0)
 .. S DR="7////"_$O(^SCPT(404.472,"B","R","")) D ^DIE
"RTN","SDRPA06",66,0)
 .. I $D(^SDWL(409.6,"AE","Y",V2,V3)) Q
"RTN","SDRPA06",67,0)
 .. I $D(^SDWL(409.6,"AE","N",V2,V3)) D
"RTN","SDRPA06",68,0)
 ... S DR="4///Y" D ^DIE
"RTN","SDRPA06",69,0)
 Q
"RTN","SDRPA06",70,0)
AA(BATCH,BATCHIDO) ;whole batch accept
"RTN","SDRPA06",71,0)
 ;if the batch is accepted and no rejections then get the run # sequence #
"RTN","SDRPA06",72,0)
 ;from AMSG xref.  If no "AE","Y" xref then call DIK to delete the entry
"RTN","SDRPA06",73,0)
 ;BATCH    :  originating batch number
"RTN","SDRPA06",74,0)
 ;BATCHIDO :  original batch number from HL7 ACK
"RTN","SDRPA06",75,0)
 ;V1       :  sequence #  (individual message number in batch)
"RTN","SDRPA06",76,0)
 ;V2       :  run #       (ien of multiple entry)
"RTN","SDRPA06",77,0)
 ;V3       :  ien         (ien in patient multiple)
"RTN","SDRPA06",78,0)
 ;V4       :  ien         (ien batch tracking multiple)
"RTN","SDRPA06",79,0)
 Q:($G(BATCH)="")
"RTN","SDRPA06",80,0)
 N DA,DIK,DR,V1,V2,V3,V4,ZNODE
"RTN","SDRPA06",81,0)
 S V1=0
"RTN","SDRPA06",82,0)
 F  S V1=$O(^SDWL(409.6,"AMSG",BATCH,V1)) Q:'V1  D
"RTN","SDRPA06",83,0)
 . S V2=$O(^SDWL(409.6,"AMSG",BATCH,V1,"")) Q:'V2
"RTN","SDRPA06",84,0)
 . ;batch tracking enhancement
"RTN","SDRPA06",85,0)
 . S V4=$O(^SDWL(409.6,V2,2,"B",BATCHIDO,"")) Q:'V4  D
"RTN","SDRPA06",86,0)
 .. S DA=V4,DA(1)=V2,DIE="^SDWL(409.6,"_V2_",2,",DR=".04///"_$$NOW^XLFDT_";.05///"_ACKCODE
"RTN","SDRPA06",87,0)
 .. D ^DIE K DIE
"RTN","SDRPA06",88,0)
 . S V3=0 F  S V3=$O(^SDWL(409.6,"AMSG",BATCH,V1,V2,V3)) Q:'V3  D
"RTN","SDRPA06",89,0)
 .. S ZNODE=$G(^SDWL(409.6,V2,1,V3,0)) Q:ZNODE=""
"RTN","SDRPA06",90,0)
 .. ;4th piece is the message #
"RTN","SDRPA06",91,0)
 .. I '$D(^SDWL(409.6,"AE","Y",V2,V3)) D
"RTN","SDRPA06",92,0)
 ... S DIK="^SDWL(409.6,"_V2_",1,"
"RTN","SDRPA06",93,0)
 ... S DA(1)=V2,DA=V3 D ^DIK
"RTN","SDRPA06",94,0)
 ... S ^XTMP("SDRPA-"_BATCH,+$P(ZNODE,"^",4),0)=ZNODE ;diagnostics
"RTN","SDRPA06",95,0)
 Q
"RTN","SDRPA06",96,0)
AAAR(BATCH,BATCHIDO) ;batch accept with errors
"RTN","SDRPA06",97,0)
 ;BATCH    :  originating batch number
"RTN","SDRPA06",98,0)
 ;BATCHIDO :  original batch number from HL7 ACK
"RTN","SDRPA06",99,0)
 ;V1       :  sequence #  (individual message number in batch)
"RTN","SDRPA06",100,0)
 ;V2       :  run #       (ien of multiple entry)
"RTN","SDRPA06",101,0)
 ;V3       :  ien         (ien in patient multiple)
"RTN","SDRPA06",102,0)
 ;V4       :  ien         (ien batch tracking multiple))
"RTN","SDRPA06",103,0)
 Q:($G(BATCH)="")
"RTN","SDRPA06",104,0)
 N DA,DIK,DR,V1,V2,V3,V4,ZNODE
"RTN","SDRPA06",105,0)
 S V1=0
"RTN","SDRPA06",106,0)
 F  S V1=$O(^SDWL(409.6,"AMSG",BATCH,V1)) Q:'V1  D
"RTN","SDRPA06",107,0)
 . S V2=$O(^SDWL(409.6,"AMSG",BATCH,V1,"")) Q:'V2
"RTN","SDRPA06",108,0)
 . ;batch tracking enhancement
"RTN","SDRPA06",109,0)
 . S V4=$O(^SDWL(409.6,V2,2,"B",BATCHIDO,"")) Q:'V4  D
"RTN","SDRPA06",110,0)
 .. S DA=V4,DA(1)=V2,DIE="^SDWL(409.6,"_V2_",2,",DR=".04///"_$$NOW^XLFDT_";.05///"_ACKCODE
"RTN","SDRPA06",111,0)
 .. D ^DIE K DIE
"RTN","SDRPA06",112,0)
 . S V3=0 F  S V3=$O(^SDWL(409.6,"AMSG",BATCH,V1,V2,V3)) Q:'V3  D
"RTN","SDRPA06",113,0)
 .. S ZNODE=$G(^SDWL(409.6,V2,1,V3,0)) Q:ZNODE=""
"RTN","SDRPA06",114,0)
 .. ;4th piece is the message #
"RTN","SDRPA06",115,0)
 .. ;next line screens for accepted batch + accepted message + status final and can be deleted
"RTN","SDRPA06",116,0)
 .. I '$D(^SDWL(409.6,"AE","Y",V2,V3))&('$D(^TMP("SDRPA06",$J,$P(ZNODE,"^",4)))) D
"RTN","SDRPA06",117,0)
 ... S DIK="^SDWL(409.6,"_V2_",1,"
"RTN","SDRPA06",118,0)
 ... S DA(1)=V2,DA=V3 D ^DIK
"RTN","SDRPA06",119,0)
 ... S ^XTMP("SDRPA-"_BATCH,+$P(ZNODE,"^",4),0)=ZNODE ;diagnostics
"RTN","SDRPA06",120,0)
 .. ;next line screens for accepted batch + error message
"RTN","SDRPA06",121,0)
 .. I $D(^TMP("SDRPA06",$J,$P(ZNODE,"^",4))) D
"RTN","SDRPA06",122,0)
 ... S DA=V3,DA(1)=V2,DIE="^SDWL(409.6,"_V2_",1,"
"RTN","SDRPA06",123,0)
 ... S DR="7////"_$O(^SCPT(404.472,"B",$G(^TMP("SDRPA06",$J,$P(ZNODE,"^",4))),"")) D ^DIE
"RTN","SDRPA06",124,0)
 ... I $D(^SDWL(409.6,"AE","Y",V2,V3)) Q
"RTN","SDRPA06",125,0)
 ... I $D(^SDWL(409.6,"AE","N",V2,V3)) D
"RTN","SDRPA06",126,0)
 .... S DR="4///Y" D ^DIE
"RTN","SDRPA06",127,0)
 Q
"RTN","SDRPA06",128,0)
CLEAN(RUN) ;housekeeping
"RTN","SDRPA06",129,0)
 ;clean up batch previous to current one by checking for "AE",("S" or "R") xref and
"RTN","SDRPA06",130,0)
 ;deleting if entry in xref exists
"RTN","SDRPA06",131,0)
 ;RUN  :  run #           (ien of multiple entry)
"RTN","SDRPA06",132,0)
 ;V1   :  previous run #  (ien of multiple entry)  
"RTN","SDRPA06",133,0)
 ;V2   :  ien           (ien in multiple)
"RTN","SDRPA06",134,0)
 Q:($G(RUN)="")
"RTN","SDRPA06",135,0)
 N V1,V2,V3
"RTN","SDRPA06",136,0)
 S V1=$O(^SDWL(409.6,RUN),-1) Q:'V1
"RTN","SDRPA06",137,0)
 F V3="R","S" S V2=0 F  S V2=$O(^SDWL(409.6,"AE",V3,V1,V2)) Q:'V2  D
"RTN","SDRPA06",138,0)
 . S ZNODE=$G(^SDWL(409.6,V1,1,V2,0))
"RTN","SDRPA06",139,0)
 . S DIK="^SDWL(409.6,"_V1_",1,"
"RTN","SDRPA06",140,0)
 . S DA(1)=V1,DA=V2 D ^DIK
"RTN","SDRPA06",141,0)
 . S ^XTMP("SDRPA-"_$P(ZNODE,"^",3),"CLEAN",+$P(ZNODE,"^",4),0)=ZNODE ;diagnostics
"RTN","SDRPA06",142,0)
 Q
"RTN","SDRPA06",143,0)
MSG(BATCHIDO,TYPE,RUNIEN,BATCHID) ;acknowledgement notification to mail group
"RTN","SDRPA06",144,0)
 ;BATCHID :  Our Message ID
"RTN","SDRPA06",145,0)
 ;BATCHIDO:  Batch Control ID
"RTN","SDRPA06",146,0)
 ;TYPE    :  type of message (accept with rejects - 1, whole accept 2, whole reject -3)
"RTN","SDRPA06",147,0)
 ;RUNIEN  :  run ien associated with this batch
"RTN","SDRPA06",148,0)
 ;SDAMX   :  message text array
"RTN","SDRPA06",149,0)
 ;XMSUB   :  subject
"RTN","SDRPA06",150,0)
 ;XMY     :  addressee
"RTN","SDRPA06",151,0)
 ;XMTEXT  :  location of text array
"RTN","SDRPA06",152,0)
 ;XMDUZ   :  sender of the message
"RTN","SDRPA06",153,0)
 ;RUNZ    :  zero node of run associated with this batch
"RTN","SDRPA06",154,0)
 N RUNZ,SDAMX,V0,V1,V2,V3,XMSUB,XMY,XMTEXT,XMDUZ
"RTN","SDRPA06",155,0)
 Q:BATCHID=""
"RTN","SDRPA06",156,0)
 S V0=$P($G(^SDWL(409.6,RUNIEN,2,0)),"^",4)
"RTN","SDRPA06",157,0)
 S (V1,V3)=0 F  S V1=$O(^SDWL(409.6,RUNIEN,2,V1)) Q:'V1  D
"RTN","SDRPA06",158,0)
 . S V2=$P($G(^SDWL(409.6,RUNIEN,2,V1,0)),"^",4)
"RTN","SDRPA06",159,0)
 . S:V2'="" V3=V3+1
"RTN","SDRPA06",160,0)
 . ;S V3=V3+1
"RTN","SDRPA06",161,0)
 S RUNZ=$G(^SDWL(409.6,RUNIEN,0))
"RTN","SDRPA06",162,0)
 S XMSUB="PAIT BATCH ACKNOWLEGEMENT "_BATCHIDO
"RTN","SDRPA06",163,0)
 S XMY("G.SD-PAIT")=""
"RTN","SDRPA06",164,0)
 S XMY("S.SD-PAIT-SERVER@FORUM.VA.GOV")=""
"RTN","SDRPA06",165,0)
 S XMTEXT="SDAMX("
"RTN","SDRPA06",166,0)
 S XMDUZ="POSTMASTER"
"RTN","SDRPA06",167,0)
 I TYPE=1 D
"RTN","SDRPA06",168,0)
 . S SDAMX(1)="  Station Number: "_$P($$SITE^VASITE(),"^",3)
"RTN","SDRPA06",169,0)
 . S SDAMX(2)="Batch Control ID: "_BATCHIDO
"RTN","SDRPA06",170,0)
 . S SDAMX(3)="      Message ID: "_BATCHID
"RTN","SDRPA06",171,0)
 . S SDAMX(4)="       Log Entry: "_RUNIEN
"RTN","SDRPA06",172,0)
 . S SDAMX(5)="        Run Date: "_$$FMTE^XLFDT($P(RUNZ,"^",7))
"RTN","SDRPA06",173,0)
 . S SDAMX(6)="          Status: Acknowledged - with rejections "
"RTN","SDRPA06",174,0)
 . S SDAMX(7)="                  "_V3_" of "_V0_" ACKs received for this run date"
"RTN","SDRPA06",175,0)
 . S SDAMX(8)=""
"RTN","SDRPA06",176,0)
 . S SDAMX(9)="Use option SD-PAIT REJECTED  Rejected Transmissions to view the rejections."
"RTN","SDRPA06",177,0)
 I TYPE=2 D
"RTN","SDRPA06",178,0)
 . S SDAMX(1)="  Station Number: "_$P($$SITE^VASITE(),"^",3)
"RTN","SDRPA06",179,0)
 . S SDAMX(2)="Batch Control ID: "_BATCHIDO
"RTN","SDRPA06",180,0)
 . S SDAMX(3)="      Message ID: "_BATCHID
"RTN","SDRPA06",181,0)
 . S SDAMX(4)="       Log Entry: "_RUNIEN
"RTN","SDRPA06",182,0)
 . S SDAMX(5)="        Run Date: "_$$FMTE^XLFDT($P(RUNZ,"^",7))
"RTN","SDRPA06",183,0)
 . S SDAMX(6)="          Status: Acknowledged - No Rejections"
"RTN","SDRPA06",184,0)
 . S SDAMX(7)="                  "_V3_" of "_V0_" ACKs received for this run date"
"RTN","SDRPA06",185,0)
 I TYPE=3 D
"RTN","SDRPA06",186,0)
 . S SDAMX(1)="  Station Number: "_$P($$SITE^VASITE(),"^",3)
"RTN","SDRPA06",187,0)
 . S SDAMX(2)="Batch Control ID: "_BATCHIDO
"RTN","SDRPA06",188,0)
 . S SDAMX(3)="      Message ID: "_BATCHID
"RTN","SDRPA06",189,0)
 . S SDAMX(4)="       Log Entry: "_RUNIEN
"RTN","SDRPA06",190,0)
 . S SDAMX(5)="        Run Date: "_$$FMTE^XLFDT($P(RUNZ,"^",7))
"RTN","SDRPA06",191,0)
 . S SDAMX(6)="          Status: Acknowledged - Entire Batch Rejected"
"RTN","SDRPA06",192,0)
 . S SDAMX(7)="                  "_V3_" of "_V0_" ACKs received for this run date"
"RTN","SDRPA06",193,0)
 D ^XMD
"RTN","SDRPA06",194,0)
 Q
"RTN","SDRPA06",195,0)
OURB(RUNIEN,BATCHIDO) ;match batch id to msg control id ("AMSG" xref)
"RTN","SDRPA06",196,0)
 ;RUNIEN     :  the ien in file 409.6 of the run
"RTN","SDRPA06",197,0)
 ;BATCHIDO   :  batchid pulled from the ACK message
"RTN","SDRPA06",198,0)
 ;V2         :  returns 0 if none, or msg control id
"RTN","SDRPA06",199,0)
 N V1,V2,VNODE
"RTN","SDRPA06",200,0)
 S V2=0
"RTN","SDRPA06",201,0)
 I '$G(RUNIEN) Q V2
"RTN","SDRPA06",202,0)
 I '$G(BATCHIDO) Q V2
"RTN","SDRPA06",203,0)
 I $G(^SDWL(409.6,RUNIEN,2,0))="" Q V2
"RTN","SDRPA06",204,0)
 S V1=0 F  S V1=$O(^SDWL(409.6,RUNIEN,2,"B",BATCHIDO,V1)) Q:'V1  D
"RTN","SDRPA06",205,0)
 . S VNODE=$G(^SDWL(409.6,RUNIEN,2,V1,0)) Q:VNODE=""
"RTN","SDRPA06",206,0)
 . I $P(VNODE,"^",3)="" Q
"RTN","SDRPA06",207,0)
 . S V2=$P(VNODE,"^",3) Q
"RTN","SDRPA06",208,0)
 Q V2
"RTN","SDRPA06",209,0)
RUNIEN(BATCHID) ;get runien
"RTN","SDRPA06",210,0)
 N V1,V2
"RTN","SDRPA06",211,0)
 S V2=0
"RTN","SDRPA06",212,0)
 S V1=999999999 F  S V1=$O(^SDWL(409.6,V1),-1) Q:'V1!(V2)  D
"RTN","SDRPA06",213,0)
 . I $O(^SDWL(409.6,V1,2,"B",BATCHID,"")) S V2=V1 Q
"RTN","SDRPA06",214,0)
 Q V2
"RTN","SDRPA07")
0^6^B52873373
"RTN","SDRPA07",1,0)
SDRPA07 ;BP-OIFO/ESW - APPOINTMENT BATCH TRANSMISSION BUILDER; ; 9/14/04 9:20am
"RTN","SDRPA07",2,0)
 ;;5.3;Scheduling;**290,333,349,376**;AUG 13 1993
"RTN","SDRPA07",3,0)
 ;
"RTN","SDRPA07",4,0)
 ;
"RTN","SDRPA07",5,0)
SNDS19(ZTSK,SDBCID,SDMCID) ;Main entry point for the sending of SIU-S19 batch messages to
"RTN","SDRPA07",6,0)
 ; the National Patient Care Database
"RTN","SDRPA07",7,0)
 ;
"RTN","SDRPA07",8,0)
 ;Input  : ZTSK
"RTN","SDRPA07",9,0)
 ;Output : SDBCID - Batch Control ID
"RTN","SDRPA07",10,0)
 ;         SDMCID - Message Control ID
"RTN","SDRPA07",11,0)
 ;
"RTN","SDRPA07",12,0)
 ;
"RTN","SDRPA07",13,0)
 ;Declare variables
"RTN","SDRPA07",14,0)
 N X,X1,X2,%H
"RTN","SDRPA07",15,0)
 N BATCHC,MSGN,CURLINE
"RTN","SDRPA07",16,0)
 N LINEN,MSHLINE,XMITERR,HL7XMIT,ERROR,ORIGENT,ORIGMNT
"RTN","SDRPA07",17,0)
 N HLEID,HL,HLECH,HLFS,HLQ,HLMID,HLMTIEN,HLDT,HLDT1,MSGID,HLRESLT,HLP
"RTN","SDRPA07",18,0)
 ;Set message count limit for batch message
"RTN","SDRPA07",19,0)
 ;Initialize global locations
"RTN","SDRPA07",20,0)
 S XMITERR="^TMP(""SD-PAIT-BLD"","_$J_",""ERRORS"")"
"RTN","SDRPA07",21,0)
 S HL7XMIT="^TMP(""HLS"","_$J_")"
"RTN","SDRPA07",22,0)
 K @XMITERR,@HL7XMIT
"RTN","SDRPA07",23,0)
 ;Initiate
"RTN","SDRPA07",24,0)
 D INIT^HLFNC2("SD-PAIT-EVENT",.HL)
"RTN","SDRPA07",25,0)
 ;Unable to initiate HL7 variable - send error bulletin - done
"RTN","SDRPA07",26,0)
 ;I ($O(HL(""))="") D ERRBUL($P(HL,U,2)) Q  ; create ERRBUL later
"RTN","SDRPA07",27,0)
 ;Create batch message
"RTN","SDRPA07",28,0)
 D CREATE^HLTF(.HLMID,.HLMTIEN,.HLDT,.HLDT1)
"RTN","SDRPA07",29,0)
 ;HLMID - value of batch ID
"RTN","SDRPA07",30,0)
 ;HLMTIEN - IEN of Message Text file entry
"RTN","SDRPA07",31,0)
 ;HLDT - current date/time in FM internal format
"RTN","SDRPA07",32,0)
 ;HLDT1 - current date/time in HL7 format
"RTN","SDRPA07",33,0)
 N SDA,SDDT S SDA=HLMID,SDDT=HLDT ; to be used to file later
"RTN","SDRPA07",34,0)
 ;Unable to create batch message - send error bulletin - done
"RTN","SDRPA07",35,0)
 ;I ('HLMTIEN) D ERRBUL("Unable to create batch HL7 message") Q
"RTN","SDRPA07",36,0)
 ;Initialize message count
"RTN","SDRPA07",37,0)
 S BATCHC=0
"RTN","SDRPA07",38,0)
 ;Initialize message number
"RTN","SDRPA07",39,0)
 S MSGN=0
"RTN","SDRPA07",40,0)
 ;Initialize line count
"RTN","SDRPA07",41,0)
 S LINEN=1
"RTN","SDRPA07",42,0)
 S CURLINE=LINEN
"RTN","SDRPA07",43,0)
 ;Loop through list of appointments requiring transmission
"RTN","SDRPA07",44,0)
 N RUNID S RUNID=$O(^SDWL(409.6,"AD",ZTSK,""))
"RTN","SDRPA07",45,0)
 N DFN,SD25,SD6,SD8,SD7,SDPATCL S DFN="" F  S DFN=$O(^TMP("SDDPT",$J,DFN)) Q:DFN=""  D
"RTN","SDRPA07",46,0)
 .N SDP,ICN,SSN,SNM,FNM,MNM,DOB,SDSC,SDSCP,SDENRO,SDAPPT S SDP=^TMP("SDDPT",$J,DFN)
"RTN","SDRPA07",47,0)
 .S ICN=$P(SDP,U),SSN=$P(SDP,U,2),SNM=$P(SDP,U,3),FNM=$P(SDP,U,4)
"RTN","SDRPA07",48,0)
 .S MNM=$P(SDP,U,5),DOB=$P(SDP,U,6),SDSC=$P(SDP,U,7),SDSCP=$P(SDP,U,8),SDENRO=$P(SDP,U,9)
"RTN","SDRPA07",49,0)
 .N SDADT S SDADT="" F  S SDADT=$O(^TMP("SDDPT",$J,DFN,SDADT)) Q:SDADT=""  D
"RTN","SDRPA07",50,0)
 ..N SDPT,SDADID,SDSDDT,SDSTAT,SDNAVA,SDCHKOUT,SDCDT,SDARF,SDARDT,SDNEW,SDCL,SDCLNUM,SDSTOP,SDCSTOP,SDFAC,SDDAM,SDCLNM,SDSTOPD,SDCSTOPD
"RTN","SDRPA07",51,0)
 ..N SDSTOPDD,SD8RD
"RTN","SDRPA07",52,0)
 ..S SDPT=^TMP("SDDPT",$J,DFN,SDADT),SDADID=$P(SDPT,U),SDDAM=$P(SDPT,U,2),SDSDDT=$P(SDPT,U,3),SDNAVA=$P(SDPT,U,5)
"RTN","SDRPA07",53,0)
 ..S SDCHKOUT=$P(SDPT,U,6),SDCDT=$P(SDPT,U,7),SDARDT=$P(SDPT,U,9),SDNEW=$P(SDPT,U,10),SDCL=$P(SDPT,U,12),SDCLNM=$P(SDPT,U,13)
"RTN","SDRPA07",54,0)
 ..S SDSTOP=$P(SDPT,U,14),SDCSTOP=$P(SDPT,U,15),SDFAC=$P(SDPT,U,16),SDPATCL=$P(SDPT,U,4)
"RTN","SDRPA07",55,0)
 ..S SDAPPT=^TMP("SDDPT",$J,DFN,SDADT,"SCH"),SD25=$P(SDAPPT,"^",2),SD6=$P(SDAPPT,"^",3),SD8=$P(SDAPPT,"^",4),SD8RD=$P(SDAPPT,"^",7)
"RTN","SDRPA07",56,0)
 ..S SDSTOPDD=^TMP("SDDPT",$J,DFN,SDADT,"STDC"),SDSTOPD=$P(SDSTOPDD,"^"),SDCSTOPD=$P(SDSTOPDD,"^",2)
"RTN","SDRPA07",57,0)
 ..;Calculate message control ID
"RTN","SDRPA07",58,0)
 ..S MSGN=MSGN+1
"RTN","SDRPA07",59,0)
 ..S MSGID=HLMID_"-"_MSGN
"RTN","SDRPA07",60,0)
 ..;Build MSG segment
"RTN","SDRPA07",61,0)
 ..I (MSGID'="") D
"RTN","SDRPA07",62,0)
 ...;remember orig message and event type
"RTN","SDRPA07",63,0)
 ...S ORIGMNT="SIU"
"RTN","SDRPA07",64,0)
 ...S ORIGENT="S12"
"RTN","SDRPA07",65,0)
 ...S HL("MNT")="SIU",HL("ETN")=$P(SDAPPT,"^")
"RTN","SDRPA07",66,0)
 ...;build MSH segment
"RTN","SDRPA07",67,0)
 ...K RESULT D MSH^HLFNC2(.HL,MSGID,.RESULT)
"RTN","SDRPA07",68,0)
 ...;reset message & event type to its orig values
"RTN","SDRPA07",69,0)
 ...S HL("MNT")=ORIGMNT
"RTN","SDRPA07",70,0)
 ...S HL("ETN")=ORIGENT
"RTN","SDRPA07",71,0)
 ...;copy MSH segment into HL7 message
"RTN","SDRPA07",72,0)
 ...S @HL7XMIT@(CURLINE)=RESULT
"RTN","SDRPA07",73,0)
 ...N SDFACL S SDFACL=$P($$SITE^VASITE(),"^",3)
"RTN","SDRPA07",74,0)
 ...S $P(@HL7XMIT@(CURLINE),U,4)=SDFACL ;sending facility station #
"RTN","SDRPA07",75,0)
 ...S $P(@HL7XMIT@(CURLINE),U,5)="SD-AAC-PAIT" ;Receiving Application
"RTN","SDRPA07",76,0)
 ...S $P(@HL7XMIT@(CURLINE),U,6)=200 ; Receiving Facility
"RTN","SDRPA07",77,0)
 ...I ($D(RESULT(1))) D
"RTN","SDRPA07",78,0)
 ....S @HL7XMIT@(CURLINE,1)=RESULT(1)
"RTN","SDRPA07",79,0)
 ....S CURLINE=CURLINE+1
"RTN","SDRPA07",80,0)
 ...E  S CURLINE=CURLINE+1
"RTN","SDRPA07",81,0)
 ..;get list of segments
"RTN","SDRPA07",82,0)
 ..N SDSCH S SDSCH="SCH"_HLFS_1_"^^^^^"
"RTN","SDRPA07",83,0)
 ..S SD7=SDNAVA
"RTN","SDRPA07",84,0)
 ..;S ^TMP("HLS",$J,CURLINE)
"RTN","SDRPA07",85,0)
 ..S @HL7XMIT@(CURLINE)=SDSCH_SD6_"^"_SD7_"^"_SD8_"^^^"
"RTN","SDRPA07",86,0)
 ..N SDDAT S SDDAT="~~~"_SDDAM_"~~~"_"Date Appt Created|~~~"_SDSDDT_"~~~"_"Desired Date|~~~"_SDADID_"~~~"_"Appt Date"
"RTN","SDRPA07",87,0)
 ..S SDDAT=SDDAT_"|~~~"_SDCHKOUT_"~~~"_"Checkout Date"
"RTN","SDRPA07",88,0)
 ..S SDDAT=SDDAT_"|~~~"_SDCDT_"~~~"_"Cancellation Date"
"RTN","SDRPA07",89,0)
 ..S SDDAT=SDDAT_"|~~~"_SDARDT_"~~~"_"Auto-rebook Date"
"RTN","SDRPA07",90,0)
 ..S SDDAT=SDDAT_"|~~~"_SD8RD_"~~~"_"Resched Date"
"RTN","SDRPA07",91,0)
 ..;S $P(SDSCH,U,12)=SDDAT,$P(SDSCH,U,26)=SDSTAT
"RTN","SDRPA07",92,0)
 ..S @HL7XMIT@(CURLINE,1)=SDDAT_"^^^^^^^^^^^^^^"_SD25
"RTN","SDRPA07",93,0)
 ..S CURLINE=CURLINE+1
"RTN","SDRPA07",94,0)
 ..S @HL7XMIT@(CURLINE)=$$EN^VAFHLPID(DFN,"1,3,5,7,11,19",1,1)
"RTN","SDRPA07",95,0)
 ..N SDCDFN S SDCDFN=$P(@HL7XMIT@(CURLINE),"^",4),SDCDFN=SDCDFN_"|"_DFN_"~~~USVHA&&L~PI" I $P(SDCDFN,"~")["V" S $P(SDCDFN,"~",2)=""
"RTN","SDRPA07",96,0)
 ..S $P(@HL7XMIT@(CURLINE),"^",4)=SDCDFN
"RTN","SDRPA07",97,0)
 ..N SDZIP S SDZIP=$P(@HL7XMIT@(CURLINE),U,12),SDZIP=$P(SDZIP,"~",5) S $P(@HL7XMIT@(CURLINE),U,12)="~~~~"_SDZIP
"RTN","SDRPA07",98,0)
 ..S CURLINE=CURLINE+1
"RTN","SDRPA07",99,0)
 ..S @HL7XMIT@(CURLINE)="PV1^1^"_SDPATCL_"^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"_SDFAC
"RTN","SDRPA07",100,0)
 ..S CURLINE=CURLINE+1
"RTN","SDRPA07",101,0)
 ..S SDNEW=$S(SDNEW=1:"NSF",SDNEW=2:"OPN",SDNEW=3:"SHB")
"RTN","SDRPA07",102,0)
 ..S @HL7XMIT@(CURLINE)="PV2^^^^^^^^^^^^^^^^^^^^^^^^"_SDNEW
"RTN","SDRPA07",103,0)
 ..S CURLINE=CURLINE+1
"RTN","SDRPA07",104,0)
 ..I $D(^TMP("SDDPT",$J,DFN,SDADT,"ROL")) D
"RTN","SDRPA07",105,0)
 ...N SDCNT,SDAIP S SDAIP="AIP^" S SDCNT="" F  S SDCNT=$O(^TMP("SDDPT",$J,DFN,SDADT,"ROL",SDCNT)) Q:SDCNT=""  D
"RTN","SDRPA07",106,0)
 ....N SDPOVID,SDPROVNM,SDROLS
"RTN","SDRPA07",107,0)
 ....S SDROLS=^TMP("SDDPT",$J,DFN,SDADT,"ROL",SDCNT)
"RTN","SDRPA07",108,0)
 ....S SDPOVID=$P(SDROLS,U,3),SDPROVNM=$P(SDROLS,U,4),SDPROVNM=$TR(SDPROVNM,",","~")
"RTN","SDRPA07",109,0)
 ....S SDPROVNM=$TR(SDPROVNM," ","~")
"RTN","SDRPA07",110,0)
 ....I $L(SDPROVNM,"~")=2 S SDPROVNM=SDPROVNM_"~~"
"RTN","SDRPA07",111,0)
 ....E  I $L(SDPROVNM,"~")=3 S SDPROVNM=SDPROVNM_"~"
"RTN","SDRPA07",112,0)
 ....S @HL7XMIT@(CURLINE)=SDAIP_SDCNT_"^^"_SDPOVID_"~"_SDPROVNM_"^"_"Provider"
"RTN","SDRPA07",113,0)
 ....S CURLINE=CURLINE+1
"RTN","SDRPA07",114,0)
 ..S @HL7XMIT@(CURLINE)="AIL^1^^"_SDCL_"~~~~~~~~"_SDCLNM_"^"_SDSTOP_"~"_SDSTOPD_"~DSS Clinic ID^"_SDCSTOP_"~"_SDCSTOPD_"~DSS Credit Stop"
"RTN","SDRPA07",115,0)
 ..S CURLINE=CURLINE+1
"RTN","SDRPA07",116,0)
 ..N SDCNT S SDCNT="" F  S SDCNT=$O(^TMP("SDDPT",$J,DFN,SDADT,"ZCL",SDCNT)) Q:SDCNT=""  D
"RTN","SDRPA07",117,0)
 ...S @HL7XMIT@(CURLINE)=^TMP("SDDPT",$J,DFN,SDADT,"ZCL",SDCNT,0)
"RTN","SDRPA07",118,0)
 ...S CURLINE=CURLINE+1
"RTN","SDRPA07",119,0)
 ..;create ZEN only if enrollment was retrieved
"RTN","SDRPA07",120,0)
 ..I SDENRO>0 S @HL7XMIT@(CURLINE)="ZEN^1^^^^^^^^"_SDENRO,CURLINE=CURLINE+1
"RTN","SDRPA07",121,0)
 ..S @HL7XMIT@(CURLINE)="ZSP^1^"_SDSC_"^"_SDSCP
"RTN","SDRPA07",122,0)
 ..S CURLINE=CURLINE+1
"RTN","SDRPA07",123,0)
 ..;ZEL
"RTN","SDRPA07",124,0)
 ..N SDZEL D EN1^VAFHLZEL(DFN,"1,37,38",1,.SDZEL) D
"RTN","SDRPA07",125,0)
 ...;need to modify 37 WITH THE CREATION DATE
"RTN","SDRPA07",126,0)
 ...N SDDAMV S SDDAMV=$$HL7TFM^XLFDT(SDDAM)
"RTN","SDRPA07",127,0)
 ...N SDVC S SDVC=$$CVEDT^DGCV(DFN,SDDAMV),SDVC=$P(SDVC,"^",3) D
"RTN","SDRPA07",128,0)
 ....S $P(SDZEL(1),"^",38)=$S(SDVC=1:1,SDVC=0:0,1:"U")
"RTN","SDRPA07",129,0)
 ....I $P(SDZEL(1),"^",39)'?8N S $P(SDZEL(1),"^",39)=""
"RTN","SDRPA07",130,0)
 ...S @HL7XMIT@(CURLINE)=SDZEL(1)
"RTN","SDRPA07",131,0)
 ..S CURLINE=CURLINE+1
"RTN","SDRPA07",132,0)
 ..;ZMH
"RTN","SDRPA07",133,0)
 ..N SAR D ENTER^VAFHLZMH(DFN,"SAR","1,5,10","3,4",HL("FS"),HL("ECH"),"")
"RTN","SDRPA07",134,0)
 ..S $P(SAR(1,0),"^",4)="" ;
"RTN","SDRPA07",135,0)
 ..;service separation date
"RTN","SDRPA07",136,0)
 ..;combat indication and location;gulf war indication
"RTN","SDRPA07",137,0)
 ..S $P(SAR(1,0),"^",5)="~"_$P($P(SAR(1,0),"^",5),"~",2)
"RTN","SDRPA07",138,0)
 ..N SS F SS=2,3 D
"RTN","SDRPA07",139,0)
 ...S $P(SAR(SS,0),"^",5)=""
"RTN","SDRPA07",140,0)
 ..I $E($P(SAR(2,0),"^",4))'="Y" S $P(SAR(2,0),"^",4)="N~"
"RTN","SDRPA07",141,0)
 ..I $E($P(SAR(3,0),"^",4))'="Y" S $P(SAR(3,0),"^",4)="N"
"RTN","SDRPA07",142,0)
 ..N SDD F SDD=1,2,3 S @HL7XMIT@(CURLINE)=SAR(SDD,0) S CURLINE=CURLINE+1
"RTN","SDRPA07",143,0)
 ..;file MSGID into 409.69 separately as batch # and ID #
"RTN","SDRPA07",144,0)
 ..N DIE,DA D
"RTN","SDRPA07",145,0)
 ...S DIE="^SDWL(409.6,"_RUNID_",1,",DA(1)=RUNID
"RTN","SDRPA07",146,0)
 ...S DA=$O(^SDWL(409.6,"AC",DFN,SDADT,RUNID,"")) D
"RTN","SDRPA07",147,0)
 ....I $P(^SDWL(409.6,RUNID,1,DA,0),"^",3)'="" S DA=$O(^SDWL(409.6,"AC",DFN,SDADT,RUNID,DA))
"RTN","SDRPA07",148,0)
 ...S DR="2///"_+MSGID_";3///"_$P(MSGID,"-",2) D ^DIE
"RTN","SDRPA07",149,0)
 D GENERATE^HLMA("SD-PAIT-EVENT","GB",1,.HLRESLT,HLMTIEN,.HLP) K @HL7XMIT
"RTN","SDRPA07",150,0)
 N DA,DIE,DR S DA=RUNID,DIE=409.6,DR="1.1///"_+$G(MSGID) D ^DIE
"RTN","SDRPA07",151,0)
 S SDMCID=+$G(SDMCID)
"RTN","SDRPA07",152,0)
 ;file message control ID # and batch control ID number
"RTN","SDRPA07",153,0)
 N DIC,DA,X,Y D
"RTN","SDRPA07",154,0)
 .S DIC="^SDWL(409.6,"_RUNID_",2,",DA(1)=RUNID,DIC("P")=409.7,DIC(0)="X"
"RTN","SDRPA07",155,0)
 .S SDBCID=+$G(HLRESLT)
"RTN","SDRPA07",156,0)
 .K DO S X=+$G(SDBCID) D FILE^DICN
"RTN","SDRPA07",157,0)
 .S DA=+Y,DIE=DIC,DR=".02///"_+$G(SDDT)_";.03///"_+$G(SDA) D ^DIE
"RTN","SDRPA07",158,0)
 Q
"RTN","SDRPA08")
0^7^B43490788
"RTN","SDRPA08",1,0)
SDRPA08 ;BP-OIFO/OWAIN,ESW - Patient Appointment Data Compilation  ; 9/10/04 9:41am
"RTN","SDRPA08",2,0)
 ;;5.3;Scheduling;**290,333,349,376**;AUG 13, 1993
"RTN","SDRPA08",3,0)
 ;This program generates appointment data into ^TMP("SDDPT",$J to be used by HL7 builder
"RTN","SDRPA08",4,0)
 Q
"RTN","SDRPA08",5,0)
 ;
"RTN","SDRPA08",6,0)
APPT(DFN,SDADT,SDDM,SDCL,SDSTAT) ;
"RTN","SDRPA08",7,0)
 ;SDDM - HL7 format of creation date
"RTN","SDRPA08",8,0)
 ;SDSTAT - string from SDRPA05
"RTN","SDRPA08",9,0)
 N ARRAY,SDCLNM,SDSTOP,SDSTOP1,SDCSTOP,SDCSTOP1,SDINST,SDFAC,SDSDDT,SDCDT,SDARF,SDARDT,SDENRO,SDNAVA,SD6A,SD8A,SD8RD
"RTN","SDRPA08",10,0)
 N SDNEW,SDSCHED,SDCHKOUT,SDPRVSEQ,SDCNT,SDSCE,SDSTOPD,SDCSTOPD
"RTN","SDRPA08",11,0)
 D GETS^DIQ(44,SDCL_",",".01;3;8;99;2503","I","ARRAY")  ; GETS called to try to improve efficiency.
"RTN","SDRPA08",12,0)
 S SDCLNM=$G(ARRAY(44,SDCL_",",.01,"I"))  ; Clinic name.
"RTN","SDRPA08",13,0)
 S SDSTOP1=$G(ARRAY(44,SDCL_",",8,"I"))  ; DSS identifier of clinic.
"RTN","SDRPA08",14,0)
 S SDSTOP=$$GET1^DIQ(40.7,SDSTOP1_",",1,"I")
"RTN","SDRPA08",15,0)
 S SDSTOPD=$$GET1^DIQ(40.7,SDSTOP1_",",.01,"I") ;description
"RTN","SDRPA08",16,0)
 S SDCSTOP1=$G(ARRAY(44,SDCL_",",2503,"I"))  ; DSS credit stop of clinic.
"RTN","SDRPA08",17,0)
 S SDCSTOP="",SDCSTOPD=""
"RTN","SDRPA08",18,0)
 I SDCSTOP1>0 S SDCSTOP=$$GET1^DIQ(40.7,SDCSTOP1_",",1,"I"),SDCSTOPD=$$GET1^DIQ(40.7,SDCSTOP1_",",.01,"I")
"RTN","SDRPA08",19,0)
 S SDINST=$G(ARRAY(44,SDCL_",",3,"I"))  ; Institution
"RTN","SDRPA08",20,0)
 S SDFAC=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Station
"RTN","SDRPA08",21,0)
 I SDFAC="" S SDDIV=$$GET1^DIQ(44,SDCL_",",3.5,"I") D
"RTN","SDRPA08",22,0)
 .I SDDIV'="" S SDINST=$$GET1^DIQ(40.8,SDDIV_",",.07,"I") I SDINST'="" D
"RTN","SDRPA08",23,0)
 ..S SDFAC=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Station
"RTN","SDRPA08",24,0)
 .I SDDIV="" S SDFAC=$P($$SITE^VASITE(,),"^",3)
"RTN","SDRPA08",25,0)
 ;
"RTN","SDRPA08",26,0)
 ;N SEQ S SEQ=0 F  S SEQ=$O(^SC(SDCL,"S",SDADT,1,SEQ)) Q:+SEQ'=SEQ  I $P(^SC(SDCL,"S",SDADT,1,SEQ,0),"^")=DFN Q
"RTN","SDRPA08",27,0)
 ;S SDCHKOUT=$$DTCONV($$GET1^DIQ(44.003,SEQ_","_SDADT_","_SDCL_",",303,"I"))  ; Checked out date.
"RTN","SDRPA08",28,0)
 S SDCHKOUT=""
"RTN","SDRPA08",29,0)
 I $P(SDSTAT,"^",5)'="" S SDCHKOUT=$$DTCONV($P(SDSTAT,"^",5))
"RTN","SDRPA08",30,0)
 S SD8RD=""
"RTN","SDRPA08",31,0)
 I $P(SDSTAT,"^",7)'="" S SD8RD=$$DTCONV($P(SDSTAT,"^",7))
"RTN","SDRPA08",32,0)
 S SDSDDT=$$DTCONV($$GET1^DIQ(2.98,SDADT_","_DFN_",",27,"I"))  ; desired date 
"RTN","SDRPA08",33,0)
 S SDCDT=$$GET1^DIQ(2.98,SDADT_","_DFN_",",15,"I")  ; Cancellation date.
"RTN","SDRPA08",34,0)
 S SDARF=$S($$GET1^DIQ(2.98,SDADT_","_DFN_",",25,"I")="A":"A",1:"")  ; Auto-rebook flag.
"RTN","SDRPA08",35,0)
 S SDARDT=$$DTCONV($$GET1^DIQ(2.98,SDADT_","_DFN_",",12,"I"))  ; Auto-rebook date.
"RTN","SDRPA08",36,0)
 S SDNAVA=$$GET1^DIQ(2.98,SDADT_","_DFN_",",26,"I")  ; Next available appointment indicator.
"RTN","SDRPA08",37,0)
 I SDNAVA=0 D
"RTN","SDRPA08",38,0)
 .I SDARF="A" S SDNAVA=4
"RTN","SDRPA08",39,0)
 .E  S SDNAVA=5
"RTN","SDRPA08",40,0)
 I SDNAVA="" S SDNAVA=6
"RTN","SDRPA08",41,0)
 S SDNEW=$$NEWAT(DFN,SDADT,SDSTOP1,SDCSTOP1,SDFAC)  ; New to facility/clinic flag.
"RTN","SDRPA08",42,0)
 ;
"RTN","SDRPA08",43,0)
 S SD6A=$P(SDSTAT,"^",3) S SD8A=$P(SDSTAT,"^",4)
"RTN","SDRPA08",44,0)
 S ^TMP("SDDPT",$J,DFN,SDADT)=$$DTCONV(SDADT)_"^"_SDDM_"^"_SDSDDT_"^^"_SDNAVA_"^"_SDCHKOUT_"^"_$$DTCONV(SDCDT)_"^^"_SDARDT
"RTN","SDRPA08",45,0)
 S ^TMP("SDDPT",$J,DFN,SDADT)=^TMP("SDDPT",$J,DFN,SDADT)_"^"_SDNEW_"^^"_SDCL_"^"_SDCLNM_"^"_SDSTOP_"^"_SDCSTOP_"^"_SDFAC
"RTN","SDRPA08",46,0)
 S ^TMP("SDDPT",$J,DFN,SDADT,"SCH")=$P(SDSTAT,U,1,6)_U_SD8RD
"RTN","SDRPA08",47,0)
 S ^TMP("SDDPT",$J,DFN,SDADT,"STDC")=SDSTOPD_"^"_SDCSTOPD
"RTN","SDRPA08",48,0)
 ; Outpatient classification.
"RTN","SDRPA08",49,0)
 S SDSCE=$$GET1^DIQ(2.98,SDADT_","_DFN_",",21,"I")
"RTN","SDRPA08",50,0)
 I SDSCE'="" D EN^VAFHLZCL(DFN,SDSCE,"1,2,3","","^","^TMP(""SDDPT"",$J,DFN,SDADT,""ZCL"")")
"RTN","SDRPA08",51,0)
 ;get patient class
"RTN","SDRPA08",52,0)
 D GETAPPT^SDAMA201(DFN,"12",,SDADT,SDADT) N SDPATCL D  K ^TMP($J,"SDAMA201")
"RTN","SDRPA08",53,0)
 .S SDPATCL=$G(^TMP($J,"SDAMA201","GETAPPT",1,12))
"RTN","SDRPA08",54,0)
 .I SDPATCL="" D
"RTN","SDRPA08",55,0)
 ..I SDSCE'="" N SDVST S SDVST=$$GET1^DIQ(409.68,SDSCE_",",.05,"I") D
"RTN","SDRPA08",56,0)
 ...I SDVST S SDPATCL=$$GET1^DIQ(9000010,SDVST_",",15002,"I")
"RTN","SDRPA08",57,0)
 ...S SDPATCL=$S(SDPATCL=1:"I",SDPATCL=0:"O",1:"U")
"RTN","SDRPA08",58,0)
 ..I SDSCE="" S SDPATCL="U"
"RTN","SDRPA08",59,0)
 .S $P(^TMP("SDDPT",$J,DFN,SDADT),"^",4)=SDPATCL
"RTN","SDRPA08",60,0)
 ; Get providers for clinic.
"RTN","SDRPA08",61,0)
 N SDPROV S (SDPRVSEQ,SDCNT)=0,SDPROV=""
"RTN","SDRPA08",62,0)
 N PROVID
"RTN","SDRPA08",63,0)
 F  S SDPRVSEQ=$O(^SC(SDCL,"PR",SDPRVSEQ)) Q:+SDPRVSEQ'=SDPRVSEQ!(SDCNT>10)  D
"RTN","SDRPA08",64,0)
 .S SDCNT=SDCNT+1,PROVID=$$GET1^DIQ(44.1,SDPRVSEQ_","_SDCL_",",.01,"I")
"RTN","SDRPA08",65,0)
 .S ^TMP("SDDPT",$J,DFN,SDADT,"ROL",SDCNT)="ROL^"_SDCNT_"^"_PROVID_"^"_$$GET1^DIQ(200,PROVID_",",.01,"I")
"RTN","SDRPA08",66,0)
 .Q
"RTN","SDRPA08",67,0)
 Q
"RTN","SDRPA08",68,0)
NEWAT(DFN,SDADT,SDSTOP1,SDCSTOP1,SDFAC) ; New to facility/clinic flag.
"RTN","SDRPA08",69,0)
 N OK,SDADT0,SDFAC1,SDDIV
"RTN","SDRPA08",70,0)
 S OK=0,SDADT0=SDADT
"RTN","SDRPA08",71,0)
 F  S SDADT=$O(^DPT(DFN,"S",SDADT),-1) Q:'SDADT  Q:$$GT24(SDADT,SDADT0)  D  Q:OK
"RTN","SDRPA08",72,0)
 .N SDCL,SDDIV,ARRAY
"RTN","SDRPA08",73,0)
 .S SDCL=$$GET1^DIQ(2.98,SDADT_","_DFN_",",.01,"I")
"RTN","SDRPA08",74,0)
 .Q:$$GET1^DIQ(44,SDCL_",",8,"I")'=SDSTOP1
"RTN","SDRPA08",75,0)
 .Q:$$GET1^DIQ(44,SDCL_",",2503,"I")'=SDCSTOP1
"RTN","SDRPA08",76,0)
 .D GETS^DIQ(44,SDCL_",","3","I","ARRAY")
"RTN","SDRPA08",77,0)
 .S SDINST=$G(ARRAY(44,SDCL_",",3,"I"))  ; Institution
"RTN","SDRPA08",78,0)
 .S SDFAC1=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Facility.
"RTN","SDRPA08",79,0)
 .I SDFAC1="" S SDDIV=$$GET1^DIQ(44,SDCL_",",3.5,"I") I SDDIV'="" D
"RTN","SDRPA08",80,0)
 ..S SDINST=$$GET1^DIQ(40.8,SDDIV_",",.07,"I") I SDINST'="" D
"RTN","SDRPA08",81,0)
 ...S SDFAC1=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Facility.
"RTN","SDRPA08",82,0)
 .I SDFAC1="" D
"RTN","SDRPA08",83,0)
 ..I SDDIV'="" S SDFAC1=$P($$SITE^VASITE(,SDDIV),"^",3) Q
"RTN","SDRPA08",84,0)
 ..S SDFAC1=$P($$SITE^VASITE(,),"^",3)
"RTN","SDRPA08",85,0)
 .I SDFAC1=SDFAC S OK=3
"RTN","SDRPA08",86,0)
 .Q
"RTN","SDRPA08",87,0)
 I OK Q OK
"RTN","SDRPA08",88,0)
 S SDADT=SDADT0
"RTN","SDRPA08",89,0)
 F  S SDADT=$O(^DPT(DFN,"S",SDADT),-1) Q:'SDADT  Q:$$GT24(SDADT,SDADT0)  D  Q:OK
"RTN","SDRPA08",90,0)
 .N SDCL,SDDIV,ARRAY
"RTN","SDRPA08",91,0)
 .S SDCL=$$GET1^DIQ(2.98,SDADT_","_DFN_",",.01,"I")
"RTN","SDRPA08",92,0)
 .Q:$$GET1^DIQ(44,SDCL_",",8,"I")'=SDSTOP1
"RTN","SDRPA08",93,0)
 .D GETS^DIQ(44,SDCL_",","3","I","ARRAY")
"RTN","SDRPA08",94,0)
 .S SDINST=$G(ARRAY(44,SDCL_",",3,"I"))  ; Institution
"RTN","SDRPA08",95,0)
 .S SDFAC1=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Facility.
"RTN","SDRPA08",96,0)
 .I SDFAC1="" S SDDIV=$$GET1^DIQ(44,SDCL_",",3.5,"I") I SDDIV'="" D
"RTN","SDRPA08",97,0)
 ..S SDINST=$$GET1^DIQ(40.8,SDDIV_",",.07,"I") I SDINST'="" D
"RTN","SDRPA08",98,0)
 ...S SDFAC1=$S(SDINST="":"",1:$$GET1^DIQ(4,SDINST_",",99,"I"))  ; Facility.
"RTN","SDRPA08",99,0)
 .I SDFAC1="" D
"RTN","SDRPA08",100,0)
 ..I SDDIV'="" S SDFAC1=$P($$SITE^VASITE(,SDDIV),"^",3) Q
"RTN","SDRPA08",101,0)
 ..S SDFAC1=$P($$SITE^VASITE(,),"^",3)
"RTN","SDRPA08",102,0)
 .I $E(SDFAC1,1,3)=$E(SDFAC,1,3) S OK=2
"RTN","SDRPA08",103,0)
 .Q
"RTN","SDRPA08",104,0)
 I OK Q OK
"RTN","SDRPA08",105,0)
 S OK=1 Q OK
"RTN","SDRPA08",106,0)
 ;
"RTN","SDRPA08",107,0)
GT24(DATE1,DATE2) ; Are two dates greater than 24 months apart?
"RTN","SDRPA08",108,0)
 ; DATE1 should be before DATE2.
"RTN","SDRPA08",109,0)
 ; If they are not in that order, they are swapped anyway.
"RTN","SDRPA08",110,0)
 N MONTHS,TEMP
"RTN","SDRPA08",111,0)
 I DATE1>DATE2 S TEMP=DATE1,DATE1=DATE2,DATE2=TEMP
"RTN","SDRPA08",112,0)
 S MONTHS=$E(DATE2,2,3)-$E(DATE1,2,3)*12+$E(DATE2,4,5)-$E(DATE1,4,5)
"RTN","SDRPA08",113,0)
 Q MONTHS>24
"RTN","SDRPA08",114,0)
DPT(DFN,SDCE) ;
"RTN","SDRPA08",115,0)
 ; Extrinsic. Returns boolean, 0: ^TMP("SDDPT",$J,DFN) not created; 1: created.
"RTN","SDRPA08",116,0)
 ;
"RTN","SDRPA08",117,0)
 N SDNAMEL,SDNAMEF,SDNAMEM,SDNAMES,SDNAME,NAME,DOB,SSN,SSNP,SDSC,ICN,SDADT,SDSCP,ARRAY,SDDCE
"RTN","SDRPA08",118,0)
 S SDDCE=$$GET1^DIQ(2,DFN_",",27.01,"I")  ; Current enrollment. Required elsewhere.
"RTN","SDRPA08",119,0)
 S:SDDCE="" SDCE="" I SDDCE>0 S SDCE=$$GET1^DIQ(27.11,SDDCE_",",.07,"I") ; Enrollment priority
"RTN","SDRPA08",120,0)
 Q:$D(^TMP("SDDPT",$J,DFN)) 1
"RTN","SDRPA08",121,0)
 D GETS^DIQ(2,DFN_",",".301;.302;991.01","I","ARRAY")  ; GETS called to try to improve efficiency.
"RTN","SDRPA08",122,0)
 S SDSC=$G(ARRAY(2,DFN_",",.301,"I"))  ; Service connected.
"RTN","SDRPA08",123,0)
 S SDSCP=$G(ARRAY(2,DFN_",",.302,"I"))  ; Service connected percentage.
"RTN","SDRPA08",124,0)
 S ICN=$$GETICN^MPIF001(DFN)  ; Integration Control Number.
"RTN","SDRPA08",125,0)
 I +ICN<0 S ICN="" ; 
"RTN","SDRPA08",126,0)
 D DEM^VADPT ;VADM array as output of this call
"RTN","SDRPA08",127,0)
 S (SDNAMEL,SDNAMEF,SDNAMEM,SDNAMES,SDNAME,NAME(1))=""
"RTN","SDRPA08",128,0)
 S NAME=$$GETNAME(DFN)
"RTN","SDRPA08",129,0)
 S DOB=$$DTCONV($P($G(VADM(3)),"^"))  ; Date of birth.
"RTN","SDRPA08",130,0)
 S (SSN,SSNP)="" S SSN=$P($G(VADM(2)),"^") I SSN["P" S SSNP="P",SSN=$E(SSN,1,9)  ; Social security number.
"RTN","SDRPA08",131,0)
 Q:$E(SSN,1,5)="00000" 0  ; Exclude test patients.
"RTN","SDRPA08",132,0)
 ;
"RTN","SDRPA08",133,0)
 S ^TMP("SDDPT",$J,DFN)=ICN_"^"_SSN_SSNP_"^"_NAME_"^"_DOB_"^"_$E(SDSC)_"^"_SDSCP_"^"_SDCE
"RTN","SDRPA08",134,0)
 Q 1
"RTN","SDRPA08",135,0)
DTCONV(DT) ; Date conversion.
"RTN","SDRPA08",136,0)
 ; CYYMMDD -> CCYYMMDD
"RTN","SDRPA08",137,0)
 ; CYYMMDD.H{HMMSS} -> CCYYMMDDHHMM
"RTN","SDRPA08",138,0)
 I DT?7N Q DT+17E6
"RTN","SDRPA08",139,0)
 Q:DT?7N1"."1.6N DT\1+17E6_$E(DT#1+1*1E4,2,5)
"RTN","SDRPA08",140,0)
 Q ""
"RTN","SDRPA08",141,0)
GETNAME(NMID) ; Name in HL7 format.
"RTN","SDRPA08",142,0)
 N SDNAME,NAME,SDNAMEL,SDNAMF,SDNAMEM,SDNAMES,SDNAMEF
"RTN","SDRPA08",143,0)
 S SDNAME("FILE")=2,SDNAME("IENS")=NMID,SDNAME("FIELD")=.01
"RTN","SDRPA08",144,0)
 S NAME(1)=$$HLNAME^XLFNAME(.SDNAME,"","^")
"RTN","SDRPA08",145,0)
 S SDNAMEL=$P($G(NAME(1)),"^"),SDNAMEF=$P($G(NAME(1)),"^",2),SDNAMEM=$P($G(NAME(1)),"^",3),SDNAMES=$P($G(NAME(1)),"^",4)
"RTN","SDRPA08",146,0)
 Q SDNAMEL_"^"_SDNAMEF_"^"_SDNAMEM_" "_SDNAMES
"RTN","SDRPA08",147,0)
 Q
"RTN","SDRPA10")
0^9^B44760083
"RTN","SDRPA10",1,0)
SDRPA10 ;BP-OIFO/ESW - UTILITY ; 10/31/04 5:42pm
"RTN","SDRPA10",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA10",3,0)
EN(ST) ;
"RTN","SDRPA10",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ
"RTN","SDRPA10",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:+STR'=ST  D
"RTN","SDRPA10",6,0)
 .S SA=$P(STR,";",2) Q:SA'="B"
"RTN","SDRPA10",7,0)
 .S SB=$P(STR,";",3),SM=$P(STR,";",4) D
"RTN","SDRPA10",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:+STE'=ST!($P(STE,";",2)="B")  D
"RTN","SDRPA10",9,0)
 ...S ER=$P(STE,";",3) S SQS=$P(STE,";",4) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA10",10,0)
 ..;update batch acknowledgement
"RTN","SDRPA10",11,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA10",12,0)
 Q
"RTN","SDRPA10",13,0)
 ;SB - batch # ; SM - message # ; ER - error code ; SQ - message sequence
"RTN","SDRPA10",14,0)
402 ;;
"RTN","SDRPA10",15,0)
 ;;402;B;40210857923;40219758875
"RTN","SDRPA10",16,0)
 ;;402;ER;200;1844,2139,2144,3441,4922,
"RTN","SDRPA10",17,0)
 ;;402;B;40210857979;40219758931
"RTN","SDRPA10",18,0)
 ;;402;ER;350;953,
"RTN","SDRPA10",19,0)
 ;;402;B;40210857991;40219758943
"RTN","SDRPA10",20,0)
 ;;402;ER;350;1768,
"RTN","SDRPA10",21,0)
 ;;402;B;40210858009;40219758963
"RTN","SDRPA10",22,0)
 ;;402;ER;350;2041,
"RTN","SDRPA10",23,0)
436 ;;
"RTN","SDRPA10",24,0)
 ;;436;B;43612717288;43617215164
"RTN","SDRPA10",25,0)
 ;;436;ER;350;4168,
"RTN","SDRPA10",26,0)
 ;;436;B;43612718897;43617216823
"RTN","SDRPA10",27,0)
 ;;436;ER;400;2842,
"RTN","SDRPA10",28,0)
437 ;;
"RTN","SDRPA10",29,0)
 ;;437;B;4378705080;43712485531
"RTN","SDRPA10",30,0)
 ;;437;ER;350;2756,
"RTN","SDRPA10",31,0)
438 ;;
"RTN","SDRPA10",32,0)
 ;;438;B;4389221661;43815419260
"RTN","SDRPA10",33,0)
 ;;438;ER;200;4949,
"RTN","SDRPA10",34,0)
 ;;438;B;4389221674;43815419273
"RTN","SDRPA10",35,0)
 ;;438;ER;200;91,1229,
"RTN","SDRPA10",36,0)
 ;;438;B;4389221676;43815419274
"RTN","SDRPA10",37,0)
 ;;438;ER;200;948,1560,1615,
"RTN","SDRPA10",38,0)
 ;;438;B;4389221682;43815419281
"RTN","SDRPA10",39,0)
 ;;438;ER;200;988,2897,4536,4942,
"RTN","SDRPA10",40,0)
 ;;438;B;4389221702;43815419301
"RTN","SDRPA10",41,0)
 ;;438;ER;200;462,
"RTN","SDRPA10",42,0)
 ;;438;B;4389221703;43815419302
"RTN","SDRPA10",43,0)
 ;;438;ER;200;686,687,1289,2171,4213,4981,
"RTN","SDRPA10",44,0)
 ;;438;B;4389221705;43815419305
"RTN","SDRPA10",45,0)
 ;;438;ER;200;3157,
"RTN","SDRPA10",46,0)
 ;;438;B;4389221706;43815419306
"RTN","SDRPA10",47,0)
 ;;438;ER;200;4992,
"RTN","SDRPA10",48,0)
 ;;438;B;4389221707;43815419307
"RTN","SDRPA10",49,0)
 ;;438;ER;200;438,2474,2476,3218,4580,
"RTN","SDRPA10",50,0)
 ;;438;B;4389221708;43815419308
"RTN","SDRPA10",51,0)
 ;;438;ER;200;428,3378,4629,
"RTN","SDRPA10",52,0)
 ;;438;B;4389221730;43815419329
"RTN","SDRPA10",53,0)
 ;;438;ER;200;1641,4616,4711,
"RTN","SDRPA10",54,0)
 ;;438;B;4389221735;43815419335
"RTN","SDRPA10",55,0)
 ;;438;ER;200;2156,2708,
"RTN","SDRPA10",56,0)
 ;;438;B;4389221736;43815419336
"RTN","SDRPA10",57,0)
 ;;438;ER;200;1338,
"RTN","SDRPA10",58,0)
 ;;438;B;4389221742;43815419339
"RTN","SDRPA10",59,0)
 ;;438;ER;200;426,1814,3007,
"RTN","SDRPA10",60,0)
 ;;438;B;4389221748;43815419349
"RTN","SDRPA10",61,0)
 ;;438;ER;200;1005,1082,4511,4732,
"RTN","SDRPA10",62,0)
 ;;438;B;4389221766;43815419355
"RTN","SDRPA10",63,0)
 ;;438;ER;200;77,501,2789,3734,4790,
"RTN","SDRPA10",64,0)
 ;;438;B;4389221770;43815419371
"RTN","SDRPA10",65,0)
 ;;438;ER;200;4475,
"RTN","SDRPA10",66,0)
 ;;438;B;4389221771;43815419372
"RTN","SDRPA10",67,0)
 ;;438;ER;200;1616,4749,
"RTN","SDRPA10",68,0)
 ;;438;B;4389221775;43815419381
"RTN","SDRPA10",69,0)
 ;;438;ER;200;4867,
"RTN","SDRPA10",70,0)
442 ;;
"RTN","SDRPA10",71,0)
 ;;442;B;4428421492;44210088571
"RTN","SDRPA10",72,0)
 ;;442;ER;200;858,2156,
"RTN","SDRPA10",73,0)
 ;;442;B;4428421522;44210088601
"RTN","SDRPA10",74,0)
 ;;442;ER;200;817,3201,
"RTN","SDRPA10",75,0)
 ;;442;B;4428421547;44210088620
"RTN","SDRPA10",76,0)
 ;;442;ER;200;4373,
"RTN","SDRPA10",77,0)
 ;;442;B;4428421618;44210088697
"RTN","SDRPA10",78,0)
 ;;442;ER;200;2127,
"RTN","SDRPA10",79,0)
 ;;442;B;4428421643;44210088721
"RTN","SDRPA10",80,0)
 ;;442;ER;200;210,
"RTN","SDRPA10",81,0)
 ;;442;B;4428421682;44210088777
"RTN","SDRPA10",82,0)
 ;;442;ER;200;654,
"RTN","SDRPA10",83,0)
 ;;442;B;4428421706;44210088801
"RTN","SDRPA10",84,0)
 ;;442;ER;200;115,1818,1962,2524,2793,2998,3015,3054,3298,3651,3894,3918,4318,4388,4556,4844,4889
"RTN","SDRPA10",85,0)
 ;;442;B;4428421720;44210088815
"RTN","SDRPA10",86,0)
 ;;442;ER;200;279,2567,2610,2698,3062,3410,3670,3826,3844,4378,
"RTN","SDRPA10",87,0)
 ;;442;B;4428421834;44210088934
"RTN","SDRPA10",88,0)
 ;;442;ER;200;47,296,1393,1459,1468,2258,3328,3343,4104,4162,4862,
"RTN","SDRPA10",89,0)
 ;;442;B;4428421858;44210088958
"RTN","SDRPA10",90,0)
 ;;442;ER;200;449,491,845,1371,1475,2121,2942,3311,3829,4142,4720,
"RTN","SDRPA10",91,0)
 ;;442;B;4428421860;44210088960
"RTN","SDRPA10",92,0)
 ;;442;ER;200;230,350,359,437,533,760,910,1199,1365,1399,1524,1590,1591,1644,2179,2202,2221,2438,2526
"RTN","SDRPA10",93,0)
 ;;442;ER;200;2599,2777,2783,3161,3268,3407,3668,3689,3702,3719,3763,3788,3837,4013,4067,4325,4437,4829,4855,
"RTN","SDRPA10",94,0)
 ;;442;B;4428421870;44210088966
"RTN","SDRPA10",95,0)
 ;;442;ER;200;53,265,603,1556,1593,2222,3295,4190,4305,
"RTN","SDRPA10",96,0)
 ;;442;B;4428421896;44210088996
"RTN","SDRPA10",97,0)
 ;;442;ER;200;14,289,292,370,409,450,518,812,831,861,1043,1174,1391,1424,1472,1547,1634,2031,2096,2537,2887,2892,3079,3116,3143,3224,3256,3421,3533,3796,3850,4176,4284,4369,4401,4446,4562,4589,4717,4809,
"RTN","SDRPA10",98,0)
 ;;442;B;4428421938;44210089034
"RTN","SDRPA10",99,0)
 ;;442;ER;200;320,398,433,543,610,1423,1952,2007,2335,3200,3756,3772,4633,4699,
"RTN","SDRPA10",100,0)
 ;;442;B;4428421974;44210089067
"RTN","SDRPA10",101,0)
 ;;442;ER;200;233,360,985,1036,1242,1436,1630,1652,1731,1763,2066,2109,2181,2390,2419,2626,2850,2853,2877,2878,2882,3532,3564,3588,3643,3981,4109,4209,4475,4593,4679,4742,4748,4866,4867,4880,
"RTN","SDRPA10",102,0)
 ;;442;B;4428422002;44210089103
"RTN","SDRPA10",103,0)
 ;;442;ER;200;118,140,277,460,622,1415,1417,1444,1637,1986,1987,2266,2332,2356,2376,2377,2815,
"RTN","SDRPA10",104,0)
459 ;;
"RTN","SDRPA10",105,0)
 ;;459;B;4596864446;4599796156
"RTN","SDRPA10",106,0)
 ;;459;ER;350;2333,
"RTN","SDRPA10",107,0)
460 ;;
"RTN","SDRPA10",108,0)
 ;;460;B;46010937546;46028948497
"RTN","SDRPA10",109,0)
 ;;460;ER;350;2611,
"RTN","SDRPA10",110,0)
 ;;460;B;46010937548;46028948499
"RTN","SDRPA10",111,0)
 ;;460;ER;700;4060,
"RTN","SDRPA10",112,0)
501 ;;
"RTN","SDRPA10",113,0)
 ;;501;B;50122428626;50132956451
"RTN","SDRPA10",114,0)
 ;;501;ER;350;1606,
"RTN","SDRPA10",115,0)
 ;;501;B;50122430493;50132959797
"RTN","SDRPA10",116,0)
 ;;501;ER;350;3703,
"RTN","SDRPA10",117,0)
 ;;501;B;50122431559;50132961242
"RTN","SDRPA10",118,0)
 ;;501;ER;350;200,
"RTN","SDRPA10",119,0)
 ;;501;B;50122432583;50132962548
"RTN","SDRPA10",120,0)
 ;;501;ER;350;731,
"RTN","SDRPA10",121,0)
 ;;501;B;50122436969;50132968262
"RTN","SDRPA10",122,0)
 ;;501;ER;350;2980,
"RTN","SDRPA10",123,0)
 ;;501;B;50122437407;50132968754
"RTN","SDRPA10",124,0)
 ;;501;ER;350;4828,
"RTN","SDRPA10",125,0)
502 ;;
"RTN","SDRPA10",126,0)
 ;;502;B;50214602922;50221153579
"RTN","SDRPA10",127,0)
 ;;502;ER;350;1090,1710,2390,
"RTN","SDRPA10",128,0)
 ;;502;B;50214607691;50221158166
"RTN","SDRPA10",129,0)
 ;;502;ER;350;4182,
"RTN","SDRPA10",130,0)
504 ;;
"RTN","SDRPA10",131,0)
 ;;504;B;50420220750;50427829687
"RTN","SDRPA10",132,0)
 ;;504;ER;350;3900,
"RTN","SDRPA10",133,0)
 ;;504;B;50420616901;50428098750
"RTN","SDRPA10",134,0)
 ;;504;ER;350;4036,
"RTN","SDRPA10",135,0)
506 ;;
"RTN","SDRPA10",136,0)
 ;;506;B;50639348097;50615666027
"RTN","SDRPA10",137,0)
 ;;506;ER;350;3397,
"RTN","SDRPA10",138,0)
508 ;;
"RTN","SDRPA10",139,0)
 ;;508;B;50884117473;50882608095
"RTN","SDRPA10",140,0)
 ;;508;ER;350;242,
"RTN","SDRPA10",141,0)
509 ;;
"RTN","SDRPA10",142,0)
 ;;509;B;50919307755;50922262566
"RTN","SDRPA10",143,0)
 ;;509;ER;350;4721,
"RTN","SDRPA10",144,0)
512 ;;
"RTN","SDRPA10",145,0)
 ;;512;B;51222906369;51278176746
"RTN","SDRPA10",146,0)
 ;;512;ER;200;936,
"RTN","SDRPA10",147,0)
 ;;512;B;51222906997;51278177702
"RTN","SDRPA10",148,0)
 ;;512;ER;200;648,
"RTN","SDRPA10",149,0)
 ;;512;B;51222907307;51278177906
"RTN","SDRPA10",150,0)
 ;;512;ER;200;4042,
"RTN","SDRPA10",151,0)
 ;;512;B;51222922663;51278202692
"RTN","SDRPA10",152,0)
 ;;512;ER;200;2115,
"RTN","SDRPA10",153,0)
 ;;512;B;51222926995;51278209444
"RTN","SDRPA10",154,0)
 ;;512;ER;200;3315,
"RTN","SDRPA10",155,0)
 ;;512;B;51222931310;51278216568
"RTN","SDRPA10",156,0)
 ;;512;ER;200;263,2488,
"RTN","SDRPA10",157,0)
 ;;512;ER;350;4652,
"RTN","SDRPA10",158,0)
 ;;512;B;51222932194;51278218171
"RTN","SDRPA10",159,0)
 ;;512;ER;200;4452,
"RTN","SDRPA10",160,0)
 ;;512;ER;350;439,
"RTN","SDRPA10",161,0)
 ;;512;B;51222935398;51278224630
"RTN","SDRPA10",162,0)
 ;;512;ER;350;2107,3932,
"RTN","SDRPA10",163,0)
 ;;512;B;51222965309;51278276117
"RTN","SDRPA10",164,0)
 ;;512;ER;350;3707,
"RTN","SDRPA10",165,0)
 ;;512;ER;400;320,
"RTN","SDRPA10",166,0)
 ;;512;B;51222966140;51278277440
"RTN","SDRPA10",167,0)
 ;;512;ER;400;520,521,
"RTN","SDRPA10",168,0)
515 ;;
"RTN","SDRPA10",169,0)
 ;;515;B;51520625697;51525930296
"RTN","SDRPA10",170,0)
 ;;515;ER;350;3195,
"RTN","SDRPA10",171,0)
518 ;;
"RTN","SDRPA10",172,0)
 ;;518;B;51814498699;51818440994
"RTN","SDRPA10",173,0)
 ;;518;ER;700;4644,
"RTN","SDRPA10",174,0)
 ;;518;B;51814498703;51818440998
"RTN","SDRPA10",175,0)
 ;;518;ER;350;2322,
"RTN","SDRPA10",176,0)
519 ;;
"RTN","SDRPA10",177,0)
 ;;519;B;51910042024;51914931317
"RTN","SDRPA10",178,0)
 ;;519;ER;700;201,
"RTN","SDRPA10",179,0)
 ;;519;B;51910042034;51914931327
"RTN","SDRPA10",180,0)
 ;;519;ER;350;1471,
"RTN","SDRPA10",181,0)
520 ;;
"RTN","SDRPA10",182,0)
 ;;520;B;52025224144;52045807380
"RTN","SDRPA10",183,0)
 ;;520;ER;700;911,
"RTN","SDRPA10",184,0)
 ;;520;B;52025267102;52045863837
"RTN","SDRPA10",185,0)
 ;;520;ER;700;911,
"RTN","SDRPA10",186,0)
 ;;520;B;52025267720;52045864913
"RTN","SDRPA10",187,0)
 ;;520;ER;350;680,
"RTN","SDRPA10",188,0)
521 ;;
"RTN","SDRPA10",189,0)
 ;;521;B;52120966450;52129317600
"RTN","SDRPA10",190,0)
 ;;521;ER;400;432,
"RTN","SDRPA10",191,0)
 ;;521;B;52120976473;52129326054
"RTN","SDRPA10",192,0)
 ;;521;ER;400;263,264,
"RTN","SDRPA10",193,0)
 ;;521;B;52121000431;52129348123
"RTN","SDRPA10",194,0)
 ;;521;ER;350;3284,
"RTN","SDRPA10",195,0)
 ;;521;B;52121033791;52129371057
"RTN","SDRPA10",196,0)
 ;;521;ER;400;406,
"RTN","SDRPA10",197,0)
 ;;521;B;52121036445;52129372420
"RTN","SDRPA10",198,0)
 ;;521;ER;400;454,
"RTN","SDRPA10",199,0)
 ;;521;B;52121038181;52129373296
"RTN","SDRPA10",200,0)
 ;;521;ER;400;400,
"RTN","SDRPA10",201,0)
 ;;521;B;52121052324;52129380558
"RTN","SDRPA10",202,0)
 ;;521;ER;400;166,
"RTN","SDRPA10",203,0)
526 ;;
"RTN","SDRPA10",204,0)
 ;;526;B;52691389;52655067
"RTN","SDRPA10",205,0)
 ;;526;ER;400;563,
"RTN","SDRPA10",206,0)
 ;;526;B;526103887;52665506
"RTN","SDRPA10",207,0)
 ;;526;ER;350;925,
"RTN","SDRPA10",208,0)
 ;;526;B;526143960;52695953
"RTN","SDRPA10",209,0)
 ;;526;ER;400;388,
"RTN","SDRPA10",210,0)
 ;;526;B;526407496;52613214901
"RTN","SDRPA10",211,0)
 ;;526;ER;350;3700,
"RTN","SDRPA10",212,0)
528 ;;
"RTN","SDRPA10",213,0)
 ;;528;B;52815285504;52846320778
"RTN","SDRPA10",214,0)
 ;;528;ER;350;4055,
"RTN","SDRPA10",215,0)
 ;;528;B;52815299211;52846398475
"RTN","SDRPA10",216,0)
 ;;528;ER;350;3305,
"RTN","SDRPA10",217,0)
 ;;528;B;52815310259;52846460347
"RTN","SDRPA10",218,0)
 ;;528;ER;350;2871,
"RTN","SDRPA10",219,0)
 ;;528;B;52815327503;52846543629
"RTN","SDRPA10",220,0)
 ;;528;ER;350;1402,
"RTN","SDRPA10",221,0)
 ;;528;B;52815328650;52846552937
"RTN","SDRPA10",222,0)
 ;;528;ER;400;1998,
"RTN","SDRPA10",223,0)
 ;;528;B;52815329287;52846556720
"RTN","SDRPA10",224,0)
 ;;528;ER;350;2490,
"RTN","SDRPA10",225,0)
 ;;528;B;52815380770;52846791898
"RTN","SDRPA10",226,0)
 ;;528;ER;400;2161,
"RTN","SDRPA11")
0^10^B23971806
"RTN","SDRPA11",1,0)
SDRPA11 ;BP-OIFO/ESW - UTILITY ; 6/9/04 8:21am
"RTN","SDRPA11",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA11",3,0)
EN(ST) ;
"RTN","SDRPA11",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ
"RTN","SDRPA11",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:+STR'=ST  D
"RTN","SDRPA11",6,0)
 .S SA=$P(STR,";",2) Q:SA'="B"
"RTN","SDRPA11",7,0)
 .S SB=$P(STR,";",3),SM=$P(STR,";",4) D
"RTN","SDRPA11",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:+STE'=ST!($P(STE,";",2)="B")  D
"RTN","SDRPA11",9,0)
 ...S ER=$P(STE,";",3) S SQS=$P(STE,";",4) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA11",10,0)
 ..;update batch acknowledgement
"RTN","SDRPA11",11,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA11",12,0)
 Q
"RTN","SDRPA11",13,0)
529 ;;
"RTN","SDRPA11",14,0)
 ;;529;B;5297795920;52911332691
"RTN","SDRPA11",15,0)
 ;;529;ER;200;11,65,69,105,106,150,247,462,464,467,578,580,588,590,593,680,717,719,861,872,873,952,953,1144,1224,1502,1760,1863,1990,2522,2524,3396,3397,
"RTN","SDRPA11",16,0)
 ;;529;ER;200;3461,3562,3565,3566,3567,3919,3921,3922,3923,3925,3926,3928,3929,3931,4102,4270,4272,4273,4276,4277,4394,4427,4491,4638,4641,4643,4645,4646,4647,4648,4707,4709,
"RTN","SDRPA11",17,0)
 ;;529;ER;200;4727,4738,4789,4790,4791,4794,4795,4796,4797,4897,4911,4912,4976,4988,4989,4990,4991,4995,4997,
"RTN","SDRPA11",18,0)
 ;;529;B;5297795922;52911332697
"RTN","SDRPA11",19,0)
 ;;529;ER;200;655,656,1288,1386,1387,1396,1397,1400,1401,1402,4628,4702,4703,4704,4768,4919,
"RTN","SDRPA11",20,0)
 ;;529;B;5297796072;52911332854
"RTN","SDRPA11",21,0)
 ;;529;ER;200;338,340,1423,1514,2281,2282,3543,4586,4690,4691,
"RTN","SDRPA11",22,0)
 ;;529;B;5297796074;52911332856
"RTN","SDRPA11",23,0)
 ;;529;ER;200;301,400,1639,1990,4663,4938,4941,
"RTN","SDRPA11",24,0)
 ;;529;B;5297796084;52911332866
"RTN","SDRPA11",25,0)
 ;;529;ER;200;770,962,4222,4223,4652,
"RTN","SDRPA11",26,0)
 ;;529;B;5297796086;52911332868
"RTN","SDRPA11",27,0)
 ;;529;ER;200;760,990,1355,1357,1526,1751,4655,4853,4917,4921,
"RTN","SDRPA11",28,0)
 ;;529;B;5297796088;52911332870
"RTN","SDRPA11",29,0)
 ;;529;ER;200;753,799,1309,1457,1540,1543,2194,4705,4706,4707,4797,4799,4917,4918,4919,4920,4921,4922,
"RTN","SDRPA11",30,0)
 ;;529;B;5297796091;52911332873
"RTN","SDRPA11",31,0)
 ;;529;ER;200;772,825,1280,2272,2277,3695,4724,4866,
"RTN","SDRPA11",32,0)
 ;;529;B;5297796093;52911332876
"RTN","SDRPA11",33,0)
 ;;529;ER;200;839,1575,4720,4829,
"RTN","SDRPA11",34,0)
 ;;529;B;5297796099;52911332884
"RTN","SDRPA11",35,0)
 ;;529;ER;200;144,322,323,324,325,692,733,1021,1022,1023,2457,2681,3627,3801,3846,4210,4596,4597,4726,4727,4729,
"RTN","SDRPA11",36,0)
 ;;529;B;5297796104;52911332889
"RTN","SDRPA11",37,0)
 ;;529;ER;200;393,781,1112,1113,1115,1158,1623,2585,2586,3308,4548,4549,4639,4642,
"RTN","SDRPA11",38,0)
 ;;529;B;5297796109;52911332894
"RTN","SDRPA11",39,0)
 ;;529;ER;200;2,158,305,397,607,670,1125,1263,1264,1414,1415,3162,3305,3830,3831,3995,4252,4253,4687,
"RTN","SDRPA11",40,0)
 ;;529;B;5297796111;52911332896
"RTN","SDRPA11",41,0)
 ;;529;ER;200;689,702,1039,1757,2708,2709,3760,3908,4059,4589,4650,
"RTN","SDRPA11",42,0)
 ;;529;B;5297796113;52911332898
"RTN","SDRPA11",43,0)
 ;;529;ER;200;576,577,1773,2032,2119,2120,2121,
"RTN","SDRPA11",44,0)
531 ;;
"RTN","SDRPA11",45,0)
 ;;531;B;53119169425;53192855136
"RTN","SDRPA11",46,0)
 ;;531;ER;350;2893,
"RTN","SDRPA11",47,0)
 ;;531;B;53119169505;53192855212
"RTN","SDRPA11",48,0)
 ;;531;ER;400;4221,4222,
"RTN","SDRPA11",49,0)
534 ;;
"RTN","SDRPA11",50,0)
 ;;534;B;53429620410;53419772381
"RTN","SDRPA11",51,0)
 ;;534;ER;350;1718,
"RTN","SDRPA11",52,0)
 ;;534;B;53429715403;53419846814
"RTN","SDRPA11",53,0)
 ;;534;ER;350;601,4771,
"RTN","SDRPA11",54,0)
 ;;534;B;53429731676;53419857147
"RTN","SDRPA11",55,0)
 ;;534;ER;350;749,
"RTN","SDRPA11",56,0)
 ;;534;B;53429732848;53419857945
"RTN","SDRPA11",57,0)
 ;;534;ER;350;1482,
"RTN","SDRPA11",58,0)
537 ;;
"RTN","SDRPA11",59,0)
 ;;537;B;53735470560;53745265152
"RTN","SDRPA11",60,0)
 ;;537;ER;350;4853,
"RTN","SDRPA11",61,0)
 ;;537;B;53735471635;53745266672
"RTN","SDRPA11",62,0)
 ;;537;ER;350;3757,
"RTN","SDRPA11",63,0)
 ;;537;B;53735471760;53745267247
"RTN","SDRPA11",64,0)
 ;;537;ER;350;518,
"RTN","SDRPA11",65,0)
 ;;537;B;53735472129;53745267876
"RTN","SDRPA11",66,0)
 ;;537;ER;350;756,
"RTN","SDRPA11",67,0)
 ;;537;B;53735472828;53745268806
"RTN","SDRPA11",68,0)
 ;;537;ER;350;2261,
"RTN","SDRPA11",69,0)
 ;;537;B;53735473888;53745270371
"RTN","SDRPA11",70,0)
 ;;537;ER;350;733,
"RTN","SDRPA11",71,0)
 ;;537;B;53735475021;53745272010
"RTN","SDRPA11",72,0)
 ;;537;ER;350;2602,
"RTN","SDRPA11",73,0)
 ;;537;B;53735479605;53745279167
"RTN","SDRPA11",74,0)
 ;;537;ER;350;4993,
"RTN","SDRPA11",75,0)
 ;;537;B;53735503027;53745313697
"RTN","SDRPA11",76,0)
 ;;537;ER;350;4652,
"RTN","SDRPA11",77,0)
 ;;537;B;53735503953;53745315198
"RTN","SDRPA11",78,0)
 ;;537;ER;350;1465,
"RTN","SDRPA11",79,0)
539 ;;
"RTN","SDRPA11",80,0)
 ;;539;B;53933787453;53940055432
"RTN","SDRPA11",81,0)
 ;;539;ER;350;513,
"RTN","SDRPA11",82,0)
 ;;539;ER;700;51,52,
"RTN","SDRPA11",83,0)
 ;;539;B;53933787850;53940055890
"RTN","SDRPA11",84,0)
 ;;539;ER;350;2568,2569,
"RTN","SDRPA11",85,0)
 ;;539;B;53933798889;53940063916
"RTN","SDRPA11",86,0)
 ;;539;ER;350;2033,
"RTN","SDRPA11",87,0)
 ;;539;B;53933804361;53940068636
"RTN","SDRPA11",88,0)
 ;;539;ER;350;266,
"RTN","SDRPA11",89,0)
 ;;539;B;53933862286;53940119176
"RTN","SDRPA11",90,0)
 ;;539;ER;350;3501,
"RTN","SDRPA11",91,0)
541 ;;
"RTN","SDRPA11",92,0)
 ;;541;B;54111500367;54180257613
"RTN","SDRPA11",93,0)
 ;;541;ER;350;1515,
"RTN","SDRPA11",94,0)
 ;;541;B;54111506210;54180292305
"RTN","SDRPA11",95,0)
 ;;541;ER;350;1888,
"RTN","SDRPA11",96,0)
 ;;541;B;54111507474;54180301756
"RTN","SDRPA11",97,0)
 ;;541;ER;350;2487,2488,3501,4664,
"RTN","SDRPA11",98,0)
 ;;541;B;54111507861;54180303147
"RTN","SDRPA11",99,0)
 ;;541;ER;350;3530,
"RTN","SDRPA11",100,0)
 ;;541;B;54111514729;54180342697
"RTN","SDRPA11",101,0)
 ;;541;ER;350;4980,
"RTN","SDRPA11",102,0)
 ;;541;B;54111521658;54180384213
"RTN","SDRPA11",103,0)
 ;;541;ER;350;3902,
"RTN","SDRPA11",104,0)
 ;;541;B;54111527072;54180427801
"RTN","SDRPA11",105,0)
 ;;541;ER;350;1673,
"RTN","SDRPA11",106,0)
 ;;541;B;54111529245;54180441238
"RTN","SDRPA11",107,0)
 ;;541;ER;400;5,
"RTN","SDRPA11",108,0)
 ;;541;B;54111537488;54180498625
"RTN","SDRPA11",109,0)
 ;;541;ER;350;650,
"RTN","SDRPA11",110,0)
 ;;541;B;54111539596;54180511438
"RTN","SDRPA11",111,0)
 ;;541;ER;350;1312,
"RTN","SDRPA11",112,0)
 ;;541;B;54111542820;54180530340
"RTN","SDRPA11",113,0)
 ;;541;ER;350;4635,
"RTN","SDRPA11",114,0)
 ;;541;B;54111543032;54180531719
"RTN","SDRPA11",115,0)
 ;;541;ER;350;3498,
"RTN","SDRPA11",116,0)
 ;;541;B;54111637583;54181143457
"RTN","SDRPA11",117,0)
 ;;541;ER;700;2688,
"RTN","SDRPA11",118,0)
 ;;541;B;54111662851;54181310927
"RTN","SDRPA11",119,0)
 ;;541;ER;400;8,
"RTN","SDRPA11",120,0)
544 ;;
"RTN","SDRPA11",121,0)
 ;;544;B;54425329584;54433704269
"RTN","SDRPA11",122,0)
 ;;544;ER;350;2563,
"RTN","SDRPA11",123,0)
 ;;544;B;54425371042;54433736350
"RTN","SDRPA11",124,0)
 ;;544;ER;350;2191,
"RTN","SDRPA11",125,0)
546 ;;
"RTN","SDRPA11",126,0)
 ;;546;B;54654062543;54658177137
"RTN","SDRPA11",127,0)
 ;;546;ER;350;2857,3790,
"RTN","SDRPA11",128,0)
 ;;546;B;54654075634;54658186625
"RTN","SDRPA11",129,0)
 ;;546;ER;350;1142,1616,
"RTN","SDRPA11",130,0)
 ;;546;B;54654075856;54658186864
"RTN","SDRPA11",131,0)
 ;;546;ER;350;1563,2377,3855,
"RTN","SDRPA11",132,0)
 ;;546;B;54654086082;54658198129
"RTN","SDRPA11",133,0)
 ;;546;ER;350;3153,
"RTN","SDRPA11",134,0)
 ;;546;B;54654089535;54658201995
"RTN","SDRPA11",135,0)
 ;;546;ER;350;2404,
"RTN","SDRPA11",136,0)
 ;;546;B;54654093439;54658207190
"RTN","SDRPA11",137,0)
 ;;546;ER;350;1281,2767,
"RTN","SDRPA11",138,0)
 ;;546;B;54654096575;54658211269
"RTN","SDRPA11",139,0)
 ;;546;ER;350;887,
"RTN","SDRPA11",140,0)
 ;;546;B;54654100397;54658217572
"RTN","SDRPA11",141,0)
 ;;546;ER;350;506,
"RTN","SDRPA11",142,0)
 ;;546;B;54654115613;54658239891
"RTN","SDRPA11",143,0)
 ;;546;ER;350;149,
"RTN","SDRPA11",144,0)
 ;;546;B;54654116042;54658240421
"RTN","SDRPA11",145,0)
 ;;546;ER;350;7,
"RTN","SDRPA11",146,0)
 ;;546;B;54654116758;54658241465
"RTN","SDRPA11",147,0)
 ;;546;ER;350;3987,
"RTN","SDRPA11",148,0)
 ;;546;B;54654128189;54658246454
"RTN","SDRPA11",149,0)
 ;;546;ER;350;1314,
"RTN","SDRPA11",150,0)
 ;;546;B;54654132002;54658252972
"RTN","SDRPA11",151,0)
 ;;546;ER;350;216,1566,
"RTN","SDRPA11",152,0)
 ;;546;B;54654152367;54658277081
"RTN","SDRPA11",153,0)
 ;;546;ER;350;189,1155,
"RTN","SDRPA12")
0^11^B64935773
"RTN","SDRPA12",1,0)
SDRPA12 ;BP-OIFO/ESW - UTILITY ; 6/9/04 8:25am
"RTN","SDRPA12",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA12",3,0)
EN(ST) ;
"RTN","SDRPA12",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ
"RTN","SDRPA12",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:+STR'=ST  D
"RTN","SDRPA12",6,0)
 .S SA=$P(STR,";",2) Q:SA'="B"
"RTN","SDRPA12",7,0)
 .S SB=$P(STR,";",3),SM=$P(STR,";",4) D
"RTN","SDRPA12",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:+STE'=ST!($P(STE,";",2)="B")  D
"RTN","SDRPA12",9,0)
 ...S ER=$P(STE,";",3) S SQS=$P(STE,";",4) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA12",10,0)
 ..;update batch acknowledgement
"RTN","SDRPA12",11,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA12",12,0)
 Q
"RTN","SDRPA12",13,0)
548 ;;
"RTN","SDRPA12",14,0)
 ;;548;B;54818160756;54828864362
"RTN","SDRPA12",15,0)
 ;;548;ER;200;1850,3653,3903,
"RTN","SDRPA12",16,0)
 ;;548;B;54818166052;54828871385
"RTN","SDRPA12",17,0)
 ;;548;ER;200;5,118,180,190,210,262,544,603,618,711,715,821,908,917,952,1090,1116,1158,1169,1286,1424,1471,1634,1711,1760,1862,1881,2143,2193,2231,2274
"RTN","SDRPA12",18,0)
 ;;548;ER;200;2500,2532,2584,2701,2787,2872,3046,3299,3320,3438,3547,4012,4021,4066,4089,4314,4397,4454,4679,4832,
"RTN","SDRPA12",19,0)
 ;;548;B;54818194910;54828910086
"RTN","SDRPA12",20,0)
 ;;548;ER;200;328,861,957,987,1102,1143,1220,1262,1283,1334,1359,1677,2148,2305,2350,2474,2723,2911,3169,3243,3840,3980,4610,4723,4725,4794,4931,
"RTN","SDRPA12",21,0)
 ;;548;B;54818200225;54828918603
"RTN","SDRPA12",22,0)
 ;;548;ER;200;1541,3040,4932,
"RTN","SDRPA12",23,0)
 ;;548;ER;350;3781,
"RTN","SDRPA12",24,0)
 ;;548;B;54818288056;54829043683
"RTN","SDRPA12",25,0)
 ;;548;ER;200;1841,3655,3910,
"RTN","SDRPA12",26,0)
 ;;548;B;54818288920;54829045138
"RTN","SDRPA12",27,0)
 ;;548;ER;200;5,117,177,187,206,257,546,603,618,710,714,821,908,917,958,1095,1120,1173,1290,1431,1478,1648,1724,1773,1875,1894,2157,2210,2251,2292,2504
"RTN","SDRPA12",28,0)
 ;;548;ER;200;2534,2585,2713,2800,2879,3051,3303,3323,3431,3532,4002,4011,4056,4079,4292,4379,4437,4630,4666,4753,4754,4817,4862,
"RTN","SDRPA12",29,0)
 ;;548;B;54818289488;54829046109
"RTN","SDRPA12",30,0)
 ;;548;ER;200;425,1146,1238,1265,1377,1417,1488,1526,1547,1598,1621,1909,2347,2492,2537,2650,2872,3039,3284,3352,3915,4043,4931,
"RTN","SDRPA12",31,0)
 ;;548;B;54818290189;54829047084
"RTN","SDRPA12",32,0)
 ;;548;ER;200;1626,2796,4774,
"RTN","SDRPA12",33,0)
 ;;548;ER;350;3537,
"RTN","SDRPA12",34,0)
 ;;548;B;54818290375;54829047315
"RTN","SDRPA12",35,0)
 ;;548;ER;200;1631,
"RTN","SDRPA12",36,0)
 ;;548;B;54818290631;54829047661
"RTN","SDRPA12",37,0)
 ;;548;ER;200;480,2374,4381,
"RTN","SDRPA12",38,0)
 ;;548;B;54818290766;54829047830
"RTN","SDRPA12",39,0)
 ;;548;ER;200;541,571,1564,4235,
"RTN","SDRPA12",40,0)
 ;;548;B;54818291018;54829048182
"RTN","SDRPA12",41,0)
 ;;548;ER;200;760,
"RTN","SDRPA12",42,0)
 ;;548;B;54818291121;54829048372
"RTN","SDRPA12",43,0)
 ;;548;ER;200;1446,
"RTN","SDRPA12",44,0)
 ;;548;B;54818291215;54829048589
"RTN","SDRPA12",45,0)
 ;;548;ER;200;217,319,771,773,3126,3768,3890,4216,
"RTN","SDRPA12",46,0)
 ;;548;B;54818291319;54829048754
"RTN","SDRPA12",47,0)
 ;;548;ER;200;1548,1905,2156,
"RTN","SDRPA12",48,0)
 ;;548;B;54818291468;54829049069
"RTN","SDRPA12",49,0)
 ;;548;ER;200;94,95,1322,1323,2952,2953,
"RTN","SDRPA12",50,0)
 ;;548;B;54818291672;54829049292
"RTN","SDRPA12",51,0)
 ;;548;ER;200;320,490,685,941,977,1491,1493,
"RTN","SDRPA12",52,0)
 ;;548;B;54818291774;54829049539
"RTN","SDRPA12",53,0)
 ;;548;ER;200;881,2689,
"RTN","SDRPA12",54,0)
 ;;548;B;54818291903;54829049888
"RTN","SDRPA12",55,0)
 ;;548;ER;200;534,1258,1886,2685,3446,
"RTN","SDRPA12",56,0)
 ;;548;B;54818292004;54829050054
"RTN","SDRPA12",57,0)
 ;;548;ER;200;4793,
"RTN","SDRPA12",58,0)
 ;;548;B;54818292138;54829050419
"RTN","SDRPA12",59,0)
 ;;548;ER;200;751,
"RTN","SDRPA12",60,0)
 ;;548;B;54818292219;54829050855
"RTN","SDRPA12",61,0)
 ;;548;ER;200;2161,
"RTN","SDRPA12",62,0)
 ;;548;B;54818292276;54829051049
"RTN","SDRPA12",63,0)
 ;;548;ER;200;294,2069,
"RTN","SDRPA12",64,0)
 ;;548;B;54818292313;54829051221
"RTN","SDRPA12",65,0)
 ;;548;ER;200;197,2155,3529,
"RTN","SDRPA12",66,0)
 ;;548;B;54818292383;54829051384
"RTN","SDRPA12",67,0)
 ;;548;ER;200;1582,4153,
"RTN","SDRPA12",68,0)
 ;;548;B;54818292438;54829051580
"RTN","SDRPA12",69,0)
 ;;548;ER;200;1121,
"RTN","SDRPA12",70,0)
 ;;548;B;54818292490;54829051742
"RTN","SDRPA12",71,0)
 ;;548;ER;200;749,2400,2725,
"RTN","SDRPA12",72,0)
 ;;548;B;54818292500;54829051848
"RTN","SDRPA12",73,0)
 ;;548;ER;200;147,967,4129,4242,
"RTN","SDRPA12",74,0)
 ;;548;B;54818292529;54829051957
"RTN","SDRPA12",75,0)
 ;;548;ER;200;156,1427,1969,2331,2333,2370,2939,2991,2992,3101,3122,3172,3751,3791,3879,4658,4681,
"RTN","SDRPA12",76,0)
 ;;548;B;54818292536;54829052025
"RTN","SDRPA12",77,0)
 ;;548;ER;200;425,738,1330,1484,3175,4740,4952,
"RTN","SDRPA12",78,0)
 ;;548;B;54818292567;54829052109
"RTN","SDRPA12",79,0)
 ;;548;ER;200;276,353,439,508,549,850,884,1014,1140,1148,1375,1563,1761,1943,2010,2181,2401,2509,2563,2565,2964,3125,3204,3549,3899,4099,4177,4208,4367,4659,
"RTN","SDRPA12",80,0)
 ;;548;B;54818292969;54829052821
"RTN","SDRPA12",81,0)
 ;;548;ER;200;204,2675,2984,3666,4809,
"RTN","SDRPA12",82,0)
 ;;548;B;54818293396;54829053399
"RTN","SDRPA12",83,0)
 ;;548;ER;200;303,1761,4697,4905,
"RTN","SDRPA12",84,0)
 ;;548;B;54818293629;54829053787
"RTN","SDRPA12",85,0)
 ;;548;ER;200;1014,2834,2835,
"RTN","SDRPA12",86,0)
 ;;548;B;54818294033;54829054304
"RTN","SDRPA12",87,0)
 ;;548;ER;200;74,236,848,902,1704,2369,
"RTN","SDRPA12",88,0)
 ;;548;B;54818295165;54829055642
"RTN","SDRPA12",89,0)
 ;;548;ER;200;477,1866,2076,2211,3685,3979,
"RTN","SDRPA12",90,0)
 ;;548;B;54818297170;54829057907
"RTN","SDRPA12",91,0)
 ;;548;ER;200;3516,4632,4648,4979,
"RTN","SDRPA12",92,0)
 ;;548;B;54818298074;54829059351
"RTN","SDRPA12",93,0)
 ;;548;ER;200;467,540,645,1347,4077,
"RTN","SDRPA12",94,0)
 ;;548;B;54818298951;54829060561
"RTN","SDRPA12",95,0)
 ;;548;ER;200;1814,2173,
"RTN","SDRPA12",96,0)
 ;;548;B;54818299748;54829061733
"RTN","SDRPA12",97,0)
 ;;548;ER;200;104,1135,2822,2823,3423,4709,
"RTN","SDRPA12",98,0)
 ;;548;ER;350;3065,
"RTN","SDRPA12",99,0)
 ;;548;B;54818300552;54829062945
"RTN","SDRPA12",100,0)
 ;;548;ER;200;23,848,1237,1797,1811,2894,
"RTN","SDRPA12",101,0)
 ;;548;B;54818302529;54829065875
"RTN","SDRPA12",102,0)
 ;;548;ER;200;221,1198,1604,4814,
"RTN","SDRPA12",103,0)
 ;;548;B;54818303659;54829067540
"RTN","SDRPA12",104,0)
 ;;548;ER;200;1731,2098,4773,4774,
"RTN","SDRPA12",105,0)
 ;;548;B;54818304348;54829068917
"RTN","SDRPA12",106,0)
 ;;548;ER;200;3485,
"RTN","SDRPA12",107,0)
 ;;548;B;54818306098;54829071392
"RTN","SDRPA12",108,0)
 ;;548;ER;200;273,279,1284,1549,3130,4944,
"RTN","SDRPA12",109,0)
 ;;548;B;54818306823;54829072511
"RTN","SDRPA12",110,0)
 ;;548;ER;200;842,2682,2916,4654,
"RTN","SDRPA12",111,0)
 ;;548;B;54818307611;54829073657
"RTN","SDRPA12",112,0)
 ;;548;ER;200;376,415,2578,2865,3016,
"RTN","SDRPA12",113,0)
 ;;548;B;54818308786;54829074974
"RTN","SDRPA12",114,0)
 ;;548;ER;200;364,669,2051,3400,3801,4221,4365,
"RTN","SDRPA12",115,0)
 ;;548;B;54818309466;54829076246
"RTN","SDRPA12",116,0)
 ;;548;ER;200;4814,
"RTN","SDRPA12",117,0)
 ;;548;B;54818309937;54829076990
"RTN","SDRPA12",118,0)
 ;;548;ER;200;386,438,731,1922,
"RTN","SDRPA12",119,0)
 ;;548;B;54818310455;54829077796
"RTN","SDRPA12",120,0)
 ;;548;ER;200;917,1536,4141,
"RTN","SDRPA12",121,0)
 ;;548;B;54818311033;54829078850
"RTN","SDRPA12",122,0)
 ;;548;ER;200;2791,3743,4287,
"RTN","SDRPA12",123,0)
 ;;548;B;54818313864;54829083315
"RTN","SDRPA12",124,0)
 ;;548;ER;200;1214,4982,
"RTN","SDRPA12",125,0)
 ;;548;ER;700;4836,
"RTN","SDRPA12",126,0)
 ;;548;B;54818314573;54829084335
"RTN","SDRPA12",127,0)
 ;;548;ER;200;1202,2680,3276,
"RTN","SDRPA12",128,0)
 ;;548;B;54818315538;54829085625
"RTN","SDRPA12",129,0)
 ;;548;ER;200;4089,4725,4814,4816,4850,
"RTN","SDRPA12",130,0)
 ;;548;B;54818317094;54829087723
"RTN","SDRPA12",131,0)
 ;;548;ER;200;236,517,605,1345,4228,
"RTN","SDRPA12",132,0)
 ;;548;B;54818318068;54829089189
"RTN","SDRPA12",133,0)
 ;;548;ER;200;1069,1213,2393,2427,2451,2554,2574,2908,3712,3898,4485,4581,
"RTN","SDRPA12",134,0)
 ;;548;B;54818319216;54829090966
"RTN","SDRPA12",135,0)
 ;;548;ER;200;285,287,1064,1065,1522,
"RTN","SDRPA12",136,0)
 ;;548;B;54818319710;54829091574
"RTN","SDRPA12",137,0)
 ;;548;ER;200;708,4014,4371,
"RTN","SDRPA12",138,0)
 ;;548;B;54818320244;54829092353
"RTN","SDRPA12",139,0)
 ;;548;ER;200;1909,2615,2937,4152,4960,
"RTN","SDRPA12",140,0)
 ;;548;B;54818320807;54829093035
"RTN","SDRPA12",141,0)
 ;;548;ER;200;925,
"RTN","SDRPA12",142,0)
 ;;548;B;54818321240;54829093681
"RTN","SDRPA12",143,0)
 ;;548;ER;200;501,1868,2274,4170,
"RTN","SDRPA12",144,0)
 ;;548;B;54818321527;54829094021
"RTN","SDRPA12",145,0)
 ;;548;ER;200;1100,1469,
"RTN","SDRPA12",146,0)
 ;;548;B;54818321822;54829094496
"RTN","SDRPA12",147,0)
 ;;548;ER;200;2288,2790,
"RTN","SDRPA12",148,0)
 ;;548;B;54818322241;54829095183
"RTN","SDRPA12",149,0)
 ;;548;ER;200;687,1990,2496,2960,3002,
"RTN","SDRPA12",150,0)
 ;;548;B;54818322575;54829095767
"RTN","SDRPA12",151,0)
 ;;548;ER;200;1253,
"RTN","SDRPA12",152,0)
 ;;548;B;54818322800;54829096012
"RTN","SDRPA12",153,0)
 ;;548;ER;200;3204,3266,3463,4080,
"RTN","SDRPA12",154,0)
 ;;548;B;54818323154;54829096628
"RTN","SDRPA12",155,0)
 ;;548;ER;200;1896,2012,3488,
"RTN","SDRPA12",156,0)
 ;;548;B;54818323271;54829096846
"RTN","SDRPA12",157,0)
 ;;548;ER;200;98,389,502,1157,2135,
"RTN","SDRPA12",158,0)
 ;;548;B;54818323420;54829097129
"RTN","SDRPA12",159,0)
 ;;548;ER;200;1215,1296,1721,3474,3566,4891,
"RTN","SDRPA12",160,0)
 ;;548;B;54818323541;54829097327
"RTN","SDRPA12",161,0)
 ;;548;ER;200;89,2619,3937,
"RTN","SDRPA12",162,0)
 ;;548;B;54818323694;54829097662
"RTN","SDRPA12",163,0)
 ;;548;ER;200;597,
"RTN","SDRPA12",164,0)
 ;;548;B;54818323792;54829097809
"RTN","SDRPA12",165,0)
 ;;548;ER;200;244,1490,2740,3795,4099,4154,4348,4893,
"RTN","SDRPA12",166,0)
 ;;548;B;54818323865;54829097952
"RTN","SDRPA12",167,0)
 ;;548;ER;200;165,343,628,1016,1541,
"RTN","SDRPA12",168,0)
 ;;548;B;54818324004;54829098174
"RTN","SDRPA12",169,0)
 ;;548;ER;200;533,807,1514,1892,2560,2872,3210,
"RTN","SDRPA12",170,0)
 ;;548;B;54818324140;54829098538
"RTN","SDRPA12",171,0)
 ;;548;ER;200;26,414,2947,2986,2999,3955,4291,4357,4509,
"RTN","SDRPA12",172,0)
 ;;548;B;54818324290;54829099214
"RTN","SDRPA12",173,0)
 ;;548;ER;200;957,1337,1842,4187,
"RTN","SDRPA12",174,0)
 ;;548;B;54818324605;54829099651
"RTN","SDRPA12",175,0)
 ;;548;ER;200;170,196,290,421,523,646,659,668,685,967,1207,1209,1480,1531,2033,2109,2207,2289,2312,2523,2673,2695,2872,2988,3245,3284,3410,3460,3501,
"RTN","SDRPA12",176,0)
 ;;548;ER;200;3556,3629,3646,3727,3898,3977,4161,4166,4225,4377,4382,4438,4481,4619,4647,4741,
"RTN","SDRPA12",177,0)
 ;;548;B;54818324954;54829100043
"RTN","SDRPA12",178,0)
 ;;548;ER;200;440,680,2346,3585,3587,
"RTN","SDRPA12",179,0)
 ;;548;B;54818325147;54829100396
"RTN","SDRPA12",180,0)
 ;;548;ER;200;307,1536,4468,
"RTN","SDRPA12",181,0)
 ;;548;B;54818325308;54829100621
"RTN","SDRPA12",182,0)
 ;;548;ER;200;215,4823,
"RTN","SDRPA12",183,0)
 ;;548;B;54818325494;54829100918
"RTN","SDRPA12",184,0)
 ;;548;ER;200;89,1130,1498,2744,2904,3308,4589,
"RTN","SDRPA12",185,0)
 ;;548;B;54818325579;54829101045
"RTN","SDRPA12",186,0)
 ;;548;ER;200;289,779,2072,2271,3606,4434,4593,
"RTN","SDRPA12",187,0)
 ;;548;B;54818325680;54829101185
"RTN","SDRPA12",188,0)
 ;;548;ER;200;1113,1991,
"RTN","SDRPA12",189,0)
 ;;548;B;54818325802;54829101343
"RTN","SDRPA12",190,0)
 ;;548;ER;200;1449,
"RTN","SDRPA12",191,0)
 ;;548;B;54818325877;54829101459
"RTN","SDRPA12",192,0)
 ;;548;ER;200;71,508,2166,3596,
"RTN","SDRPA12",193,0)
 ;;548;B;54818325949;54829101550
"RTN","SDRPA12",194,0)
 ;;548;ER;200;583,1193,1294,1316,1937,2075,2256,3016,4969,
"RTN","SDRPA12",195,0)
 ;;548;B;54818326079;54829101744
"RTN","SDRPA12",196,0)
 ;;548;ER;200;535,1410,3134,
"RTN","SDRPA12",197,0)
 ;;548;B;54818326119;54829101822
"RTN","SDRPA12",198,0)
 ;;548;ER;200;1286,1351,4164,4249,4346,4626,4970,
"RTN","SDRPA12",199,0)
 ;;548;B;54818326215;54829102014
"RTN","SDRPA12",200,0)
 ;;548;ER;200;704,900,902,1190,1203,1480,3986,
"RTN","SDRPA12",201,0)
 ;;548;B;54818326296;54829102172
"RTN","SDRPA12",202,0)
 ;;548;ER;200;800,801,1042,1959,2639,2640,4294,4543,4831,4924,4985,
"RTN","SDRPA12",203,0)
 ;;548;B;54818326349;54829102269
"RTN","SDRPA12",204,0)
 ;;548;ER;200;1572,
"RTN","SDRPA12",205,0)
 ;;548;B;54818326505;54829102518
"RTN","SDRPA12",206,0)
 ;;548;ER;200;1100,4482,4488,
"RTN","SDRPA12",207,0)
 ;;548;B;54818326660;54829102937
"RTN","SDRPA12",208,0)
 ;;548;ER;200;90,797,1062,1729,1963,
"RTN","SDRPA12",209,0)
 ;;548;B;54818326758;54829103194
"RTN","SDRPA12",210,0)
 ;;548;ER;200;1194,1644,1884,4727,
"RTN","SDRPA12",211,0)
 ;;548;B;54818326836;54829103398
"RTN","SDRPA12",212,0)
 ;;548;ER;200;269,4005,4007,
"RTN","SDRPA12",213,0)
 ;;548;B;54818327030;54829103767
"RTN","SDRPA12",214,0)
 ;;548;ER;200;790,954,1063,1271,4459,
"RTN","SDRPA12",215,0)
 ;;548;B;54818327155;54829103994
"RTN","SDRPA12",216,0)
 ;;548;ER;200;23,2734,3329,3896,3898,4739,
"RTN","SDRPA12",217,0)
549 ;;
"RTN","SDRPA12",218,0)
 ;;549;B;54930411303;54996011224
"RTN","SDRPA12",219,0)
 ;;549;ER;350;2085,
"RTN","SDRPA12",220,0)
 ;;549;B;54930422921;54996033827
"RTN","SDRPA12",221,0)
 ;;549;ER;350;866,
"RTN","SDRPA12",222,0)
 ;;549;ER;700;16,52,210,1976,3931,3978,
"RTN","SDRPA12",223,0)
 ;;549;B;54930436137;54996062733
"RTN","SDRPA12",224,0)
 ;;549;ER;350;3649,
"RTN","SDRPA12",225,0)
 ;;549;B;54930437952;54996066052
"RTN","SDRPA12",226,0)
 ;;549;ER;350;2274,
"RTN","SDRPA12",227,0)
 ;;549;B;54930441184;54996074598
"RTN","SDRPA12",228,0)
 ;;549;ER;350;2263,
"RTN","SDRPA12",229,0)
 ;;549;B;54930443465;54996080214
"RTN","SDRPA12",230,0)
 ;;549;ER;350;3992,
"RTN","SDRPA12",231,0)
 ;;549;B;54930445405;54996083947
"RTN","SDRPA12",232,0)
 ;;549;ER;350;877,
"RTN","SDRPA12",233,0)
 ;;549;B;54930446720;54996085824
"RTN","SDRPA12",234,0)
 ;;549;ER;700;2313,
"RTN","SDRPA12",235,0)
 ;;549;B;54930448103;54996089837
"RTN","SDRPA12",236,0)
 ;;549;ER;350;2075,
"RTN","SDRPA12",237,0)
 ;;549;B;54930454903;54996103266
"RTN","SDRPA12",238,0)
 ;;549;ER;350;4752,
"RTN","SDRPA12",239,0)
550 ;;
"RTN","SDRPA12",240,0)
 ;;550;B;55014778664;55021524711
"RTN","SDRPA12",241,0)
 ;;550;ER;350;668,
"RTN","SDRPA12",242,0)
553 ;;
"RTN","SDRPA12",243,0)
 ;;553;B;55320661406;5537211698
"RTN","SDRPA12",244,0)
 ;;553;ER;350;3194,
"RTN","SDRPA12",245,0)
 ;;553;B;55320662266;5537212619
"RTN","SDRPA12",246,0)
 ;;553;ER;350;2677,
"RTN","SDRPA13")
0^12^B60320496
"RTN","SDRPA13",1,0)
SDRPA13 ;BP-OIFO/ESW - UTILITY ; 6/9/04 8:24am
"RTN","SDRPA13",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA13",3,0)
EN(ST) ;
"RTN","SDRPA13",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ
"RTN","SDRPA13",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:+STR'=ST  D
"RTN","SDRPA13",6,0)
 .S SA=$P(STR,";",2) Q:SA'="B"
"RTN","SDRPA13",7,0)
 .S SB=$P(STR,";",3),SM=$P(STR,";",4) D
"RTN","SDRPA13",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:+STE'=ST!($P(STE,";",2)="B")  D
"RTN","SDRPA13",9,0)
 ...S ER=$P(STE,";",3) S SQS=$P(STE,";",4) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA13",10,0)
 ..;update batch acknowledgement
"RTN","SDRPA13",11,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA13",12,0)
 Q
"RTN","SDRPA13",13,0)
554 ;;
"RTN","SDRPA13",14,0)
 ;;554;B;55437796563;55448521745
"RTN","SDRPA13",15,0)
 ;;554;ER;350;388,
"RTN","SDRPA13",16,0)
 ;;554;B;55437797821;55448523185
"RTN","SDRPA13",17,0)
 ;;554;ER;350;1674,
"RTN","SDRPA13",18,0)
 ;;554;ER;400;283,
"RTN","SDRPA13",19,0)
 ;;554;B;55437799590;55448525823
"RTN","SDRPA13",20,0)
 ;;554;ER;350;2430,
"RTN","SDRPA13",21,0)
 ;;554;B;55437800230;55448526572
"RTN","SDRPA13",22,0)
 ;;554;ER;350;4361,
"RTN","SDRPA13",23,0)
 ;;554;B;55437800577;55448526877
"RTN","SDRPA13",24,0)
 ;;554;ER;350;389,
"RTN","SDRPA13",25,0)
 ;;554;B;55437801818;55448528456
"RTN","SDRPA13",26,0)
 ;;554;ER;400;4932,
"RTN","SDRPA13",27,0)
 ;;554;B;55437806185;55448532888
"RTN","SDRPA13",28,0)
 ;;554;ER;400;4856,4857,4858,4859,
"RTN","SDRPA13",29,0)
 ;;554;B;55437816254;55448544676
"RTN","SDRPA13",30,0)
 ;;554;ER;400;649,
"RTN","SDRPA13",31,0)
 ;;554;B;55437909261;55448657090
"RTN","SDRPA13",32,0)
 ;;554;ER;400;119,
"RTN","SDRPA13",33,0)
556 ;;
"RTN","SDRPA13",34,0)
 ;;556;B;55614723975;55621263555
"RTN","SDRPA13",35,0)
 ;;556;ER;350;2967,
"RTN","SDRPA13",36,0)
 ;;556;B;55614724139;55621263748
"RTN","SDRPA13",37,0)
 ;;556;ER;350;1708,
"RTN","SDRPA13",38,0)
 ;;556;B;55614724207;55621263828
"RTN","SDRPA13",39,0)
 ;;556;ER;350;4497,
"RTN","SDRPA13",40,0)
557 ;;
"RTN","SDRPA13",41,0)
 ;;557;B;55723601318;55729649231
"RTN","SDRPA13",42,0)
 ;;557;ER;700;672,
"RTN","SDRPA13",43,0)
558 ;;
"RTN","SDRPA13",44,0)
 ;;558;B;55830098578;55844865732
"RTN","SDRPA13",45,0)
 ;;558;ER;350;1113,2920,
"RTN","SDRPA13",46,0)
 ;;558;B;55830102189;55844871123
"RTN","SDRPA13",47,0)
 ;;558;ER;350;4287,
"RTN","SDRPA13",48,0)
 ;;558;B;55830103593;55844873399
"RTN","SDRPA13",49,0)
 ;;558;ER;350;1955,
"RTN","SDRPA13",50,0)
561 ;;
"RTN","SDRPA13",51,0)
 ;;561;B;56130833860;56129081726
"RTN","SDRPA13",52,0)
 ;;561;ER;700;2271,
"RTN","SDRPA13",53,0)
 ;;561;B;56130901834;56129473527
"RTN","SDRPA13",54,0)
 ;;561;ER;350;2830,
"RTN","SDRPA13",55,0)
 ;;561;B;56130903196;56129481304
"RTN","SDRPA13",56,0)
 ;;561;ER;350;343,
"RTN","SDRPA13",57,0)
 ;;561;B;56130903290;56129482010
"RTN","SDRPA13",58,0)
 ;;561;ER;350;3491,
"RTN","SDRPA13",59,0)
562 ;;
"RTN","SDRPA13",60,0)
 ;;562;B;5627678452;5626309900
"RTN","SDRPA13",61,0)
 ;;562;ER;350;3253,
"RTN","SDRPA13",62,0)
565 ;;
"RTN","SDRPA13",63,0)
 ;;565;B;56516370753;56523143655
"RTN","SDRPA13",64,0)
 ;;565;ER;350;1249,4039,
"RTN","SDRPA13",65,0)
568 ;;
"RTN","SDRPA13",66,0)
 ;;568;B;56810669869;56815555226
"RTN","SDRPA13",67,0)
 ;;568;ER;200;2077,
"RTN","SDRPA13",68,0)
 ;;568;B;56810669876;56815555246
"RTN","SDRPA13",69,0)
 ;;568;ER;200;3855,3858,3861,3864,3867,3872,3875,3876,3877,3878,3879,3880,4279,
"RTN","SDRPA13",70,0)
 ;;568;B;56810669881;56815555251
"RTN","SDRPA13",71,0)
 ;;568;ER;200;4148,4151,4152,4153,4154,4155,4156,4157,4158,4159,4160,4161,
"RTN","SDRPA13",72,0)
 ;;568;B;56810669904;56815555280
"RTN","SDRPA13",73,0)
 ;;568;ER;200;4219,
"RTN","SDRPA13",74,0)
 ;;568;B;56810669927;56815555303
"RTN","SDRPA13",75,0)
 ;;568;ER;200;150,608,709,868,888,1011,1257,1511,1834,1890,2171,2644,2696,2789,2948,2989,3797,3969,4013,4016,4020,4024,4027,4030,4031,4032,4033,4034,4035,
"RTN","SDRPA13",76,0)
 ;;568,ER;200;4036,4075,4077,4080,4082,4083,4084,4085,4086,4087,4088,4089,4090,4091,4092,4093,4096,4097,4098,4099,4100,4101,4102,4103,4113,4265,4318,4592,4608,4632,4648,4670,4676,4807,4906,
"RTN","SDRPA13",77,0)
 ;;568;B;56810669937;56815555313
"RTN","SDRPA13",78,0)
 ;;568;ER;200;3062,3066,3067,3069,3070,3071,3072,3073,3074,3075,3076,3077,3078,4284,4717,4718,4719,4720,4721,4906,4910,4914,4918,4921,4924,4927,4929,4930,4931,4932,4933,
"RTN","SDRPA13",79,0)
 ;;568;B;56810669946;56815555322
"RTN","SDRPA13",80,0)
 ;;568;ER;200;3474,3477,3478,3479,3480,3481,4217,4218,4219,4220,4221,4222,4223,4224,4225,4226,4227,4923,
"RTN","SDRPA13",81,0)
 ;;568;B;56810669968;56815555343
"RTN","SDRPA13",82,0)
 ;;568;ER;200;2596,2601,2604,2608,2611,2613,2616,2618,2619,2620,2621,2622,
"RTN","SDRPA13",83,0)
 ;;568;B;56810669978;56815555355
"RTN","SDRPA13",84,0)
 ;;568;ER;200;1179,1182,1185,1188,1190,1193,1195,1197,1198,1199,1200,4076,4079,4082,4085,4086,4087,4088,4089,4090,4091,4092,
"RTN","SDRPA13",85,0)
 ;;568;B;56810669983;56815555360
"RTN","SDRPA13",86,0)
 ;;568;ER;200;4935,4937,4939,4940,4941,4942,4943,4944,4945,4946,
"RTN","SDRPA13",87,0)
 ;;568;B;56810669986;56815555363
"RTN","SDRPA13",88,0)
 ;;568;ER;200;560,788,842,925,955,1006,1173,1265,1352,1391,1793,2034,3174,3361,3653,3654,3658,3661,3665,3668,3670,3673,3676,3678,3679,3680,4233,4315,4589,
"RTN","SDRPA13",89,0)
 ;;568,ER;200;4594,4597,4600,4603,4606,4609,4610,4611,4612,4613,4645,4669,4672,4675,4678,4681,4684,4687,4689,4692,4696,4699,4700,4701,4761,4831,4859,4885,4892,4898,4910,4915,4921,
"RTN","SDRPA13",90,0)
 ;;568;B;56810670008;56815555376
"RTN","SDRPA13",91,0)
 ;;568;ER;200;2821,2831,2836,2839,2841,2844,2846,2849,2852,2855,2856,2857,4660,
"RTN","SDRPA13",92,0)
 ;;568;B;56810670085;56815555454
"RTN","SDRPA13",93,0)
 ;;568;ER;200;1026,1031,1035,1037,1042,1044,1047,1050,3814,3815,3816,3817,3818,3819,3820,3821,3822,3823,3824,3825,
"RTN","SDRPA13",94,0)
 ;;568;B;56810670093;56815555473
"RTN","SDRPA13",95,0)
 ;;568;ER;200;2009,2195,3523,3525,3526,3527,3528,3529,3530,3531,3532,3533,3534,3535,4246,
"RTN","SDRPA13",96,0)
 ;;568;B;56810670098;56815555478
"RTN","SDRPA13",97,0)
 ;;568;ER;200;4793,4795,4796,4797,4798,4799,4800,4801,4802,4803,4804,4805,4808,4811,4812,4813,4814,4815,4816,4818,4819,4820,4821,4822,
"RTN","SDRPA13",98,0)
 ;;568;B;56810670101;56815555481
"RTN","SDRPA13",99,0)
 ;;568;ER;200;580,1141,1330,1433,1687,1690,1693,1695,1698,1701,1703,1705,1708,1711,1713,1714,1774,1997,2061,2075,3296,3298,3300,3301,3302,3303,3304,
"RTN","SDRPA13",100,0)
 ;;568;ER;200;3305,3306,3307,3308,3309,3748,4816,4818,4821,4823,4826,4829,4832,4834,4836,4839,4842,4843,
"RTN","SDRPA13",101,0)
 ;;568;B;56810670128;56815555505
"RTN","SDRPA13",102,0)
 ;;568;ER;200;2789,2888,3422,3479,3484,3489,3493,3498,3501,3505,3509,3512,3514,3515,3516,4195,4205,4266,4317,4338,4402,4508,4571,4787,4911,
"RTN","SDRPA13",103,0)
 ;;568;ER;200;1222,1223,1224,1225,1226,1227,1228,1229,1230,1231,1232
"RTN","SDRPA13",104,0)
 ;;568;ER;200;1222,1223,1224,1225,1226,1227,1228,1229,1230,1231,1232,1233,4842,4846,4850,4853,4856,4859,4862,4865,4866,4867,4868,4869,
"RTN","SDRPA13",105,0)
 ;;568;B;56810670150;56815555529
"RTN","SDRPA13",106,0)
 ;;568;ER;200;3958,3962,3965,3968,3971,3974,3977,3981,3982,3983,3984,3985,4484,4489,4494,4499,4503,4507,4512,4515,4517,4518,4519,
"RTN","SDRPA13",107,0)
 ;;568;B;56810670151;56815555532
"RTN","SDRPA13",108,0)
 ;;568;ER;200;2252,2253,2254,2255,2256,2257,2258,2259,2260,2261,2262,2263,
"RTN","SDRPA13",109,0)
 ;;568;B;56810670156;56815555543
"RTN","SDRPA13",110,0)
 ;;568;ER;200;2308,2309,2310,2311,2312,2313,2314,2315,2316,2317,2318,2465,2466,2467,2468,2469,2470,2471,2472,2473,2474,2475,
"RTN","SDRPA13",111,0)
 ;;568;B;56810670169;56815555566
"RTN","SDRPA13",112,0)
 ;;568;ER;200;118,754,796,1460,1764,2435,2669,4468,4471,4472,4473,4474,4475,4476,4477,4478,4479,4480,4481,
"RTN","SDRPA13",113,0)
 ;;568;B;56810670178;56815555575
"RTN","SDRPA13",114,0)
 ;;568;ER;200;2472,2770,3180,3445,3532,3740,3873,3903,4143,4274,4293,4411,4607,4762,4803,4813,4827,4839,4931,4944,4952,4963,
"RTN","SDRPA13",115,0)
 ;;568;B;56810670187;56815555585
"RTN","SDRPA13",116,0)
 ;;568;ER;200;1507,1508,1509,1510,1511,1512,1513,1514,1515,1516,1517,1518,4274,4278,4280,4283,4288,4291,4294,4297,4298,4299,4300,4301,
"RTN","SDRPA13",117,0)
 ;;568;B;56810670188;56815555586
"RTN","SDRPA13",118,0)
 ;;568;ER;200;2206,2314,
"RTN","SDRPA13",119,0)
 ;;568;B;56810670193;56815555591
"RTN","SDRPA13",120,0)
 ;;568;ER;200;2074,2189,
"RTN","SDRPA13",121,0)
 ;;568;B;56810670242;56815555640
"RTN","SDRPA13",122,0)
 ;;568;ER;200;300,372,1468,1605,1753,2116,2161,3371,3955,3956,3964,3965,3972,3973,3976,3977,3978,3979,3980,3981,3982,3983,3984,3985,3986,3987,3988,3989,3990,3991,3992,4161,4423,4681,4682,4683,4684,
"RTN","SDRPA13",123,0)
 ;;568;B;56810670243;56815555641
"RTN","SDRPA13",124,0)
 ;;568;ER;200;1174,1176,1177,1178,1179,1180,1181,1182,1183,1184,1185,1186,2144,2145,2146,2147,2148,2149,2150,2151,2152,2153,2154,2155,4089,4137,4326,4604,4606,4607,4608,4609,4610,4611,4612,4623,4767,4857,4895,
"RTN","SDRPA13",125,0)
 ;;568;B;56810670244;56815555642
"RTN","SDRPA13",126,0)
 ;;568;ER;200;4006,4009,4010,4011,4012,4013,4014,4015,4016,4017,4018,4554,4555,4556,4557,4558,4559,4560,4561,4562,4563,4564,4565,
"RTN","SDRPA13",127,0)
 ;;568;B;56810670249;56815555643
"RTN","SDRPA13",128,0)
 ;;568;ER;200;440,1999,
"RTN","SDRPA13",129,0)
 ;;568;B;56810670250;56815555648
"RTN","SDRPA13",130,0)
 ;;568;ER;200;2099,3746,3747,3748,3749,3750,3751,3752,3753,3754,3755,3756,3849,3850,3851,3852,3853,3854,3855,3856,3857,3858,3859,3860,
"RTN","SDRPA13",131,0)
 ;;568;B;56810670267;56815555666
"RTN","SDRPA13",132,0)
 ;;568;ER;200;4522,4529,4535,4536,4537,4538,4539,4540,4541,4542,4543,4544,4897,4900,4906,4909,4912,4915,4918,4919,4920,4921,4922,4923,
"RTN","SDRPA13",133,0)
 ;;568;B;56810670272;56815555677
"RTN","SDRPA13",134,0)
 ;;568;ER;200;1370,1373,1376,1379,1382,1384,1385,1386,1387,1388,1389,2035,2045,2154,3795,
"RTN","SDRPA13",135,0)
 ;;568;B;56810670277;56815555682
"RTN","SDRPA13",136,0)
 ;;568;ER;200;540,816,817,1009,1602,1608,1699,2200,2401,2701,3026,3374,3822,4066,4254,4456,4707,4717,4848,4855,4861,4946,
"RTN","SDRPA13",137,0)
 ;;568;B;56810670293;56815555698
"RTN","SDRPA13",138,0)
 ;;568;ER;200;1177,1180,1183,1188,1191,1194,1197,1198,1199,1200,4620,4623,4626,4629,4632,4635,4637,4638,4639,4640,4641,
"RTN","SDRPA13",139,0)
 ;;568;ER;350;3973,
"RTN","SDRPA13",140,0)
 ;;568;B;56810670298;56815555703
"RTN","SDRPA13",141,0)
 ;;568;ER;200;1470,1473,1474,1475,1476,1477,1478,1479,1480,1481,1482,1483,4491,4918,4919,4920,4921,4922,4923,4924,4925,4926,4927,4928,4929,
"RTN","SDRPA13",142,0)
 ;;568;ER;200;426,925,1591,1596,1599,1602,1605,1608,1611,1613,1614,1
"RTN","SDRPA13",143,0)
 ;;568;ER;200;426,925,1591,1596,1599,1602,1605,1608,1611,1613,1614,1615,1616,1617,2887,3120,3386,3505,3508,3511,3514,3517,3521,3525,3529,3531,3533,3534,3535,3841,3845,3850,3854,3858,3862,3868,3870,3872,3874,3876,3877,
"RTN","SDRPA13",144,0)
 ;;568;B;56810670313;56815555741
"RTN","SDRPA13",145,0)
 ;;568;ER;200;2007,2010,2013,2016,2019,2022,2024,2025,2026,2027,2028,2870,2932,3220,3855,4799,4810,4860,4862,4863,4864,4865,4866,4867,4868,4873,4879,4894,
"RTN","SDRPA13",146,0)
 ;;568;B;56810670351;56815555786
"RTN","SDRPA13",147,0)
 ;;568;ER;200;2539,2545,2551,2557,2560,2561,2563,2564,2565,2566,2567,2568,
"RTN","SDRPA13",148,0)
570 ;;
"RTN","SDRPA13",149,0)
 ;;570;B;57010414709;5707880258
"RTN","SDRPA13",150,0)
 ;;570;ER;350;3290,
"RTN","SDRPA13",151,0)
 ;;570;B;57010414740;5707880290
"RTN","SDRPA13",152,0)
 ;;570;ER;400;1323,
"RTN","SDRPA13",153,0)
 ;;570;B;57010414742;5707880292
"RTN","SDRPA13",154,0)
 ;;570;ER;350;4114,
"RTN","SDRPA13",155,0)
 ;;570;B;57010414760;5707880310
"RTN","SDRPA13",156,0)
 ;;570;ER;350;5000,
"RTN","SDRPA13",157,0)
 ;;570;B;57010414762;5707880313
"RTN","SDRPA13",158,0)
 ;;570;ER;350;3633,
"RTN","SDRPA13",159,0)
 ;;570;ER;400;98,
"RTN","SDRPA13",160,0)
 ;;570;B;57010414824;5707880399
"RTN","SDRPA13",161,0)
 ;;570;ER;400;1075,
"RTN","SDRPA13",162,0)
 ;;570;B;57010414853;5707880442
"RTN","SDRPA13",163,0)
 ;;570;ER;400;419,
"RTN","SDRPA14")
0^13^B74206620
"RTN","SDRPA14",1,0)
SDRPA14 ;BP-OIFO/ESW - UTILITY ; 6/9/04 8:27am
"RTN","SDRPA14",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA14",3,0)
EN(ST) ;
"RTN","SDRPA14",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ
"RTN","SDRPA14",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:+STR'=ST  D
"RTN","SDRPA14",6,0)
 .S SA=$P(STR,";",2) Q:SA'="B"
"RTN","SDRPA14",7,0)
 .S SB=$P(STR,";",3),SM=$P(STR,";",4) D
"RTN","SDRPA14",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:+STE'=ST!($P(STE,";",2)="B")  D
"RTN","SDRPA14",9,0)
 ...S ER=$P(STE,";",3) S SQS=$P(STE,";",4) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA14",10,0)
 ..;update batch acknowledgement
"RTN","SDRPA14",11,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA14",12,0)
 Q
"RTN","SDRPA14",13,0)
573 ;;
"RTN","SDRPA14",14,0)
 ;;573;B;57341415896;57315611095
"RTN","SDRPA14",15,0)
 ;;573;ER;350;3839,4363,4523,
"RTN","SDRPA14",16,0)
 ;;573;B;57341418138;57315613298
"RTN","SDRPA14",17,0)
 ;;573;ER;350;4376,
"RTN","SDRPA14",18,0)
 ;;573;B;57341485488;57315713018
"RTN","SDRPA14",19,0)
 ;;573;ER;350;1166,
"RTN","SDRPA14",20,0)
 ;;573;B;57341487141;57315716177
"RTN","SDRPA14",21,0)
 ;;573;ER;400;196,
"RTN","SDRPA14",22,0)
 ;;573;B;57341489204;57315718962
"RTN","SDRPA14",23,0)
 ;;573;ER;200;2755,
"RTN","SDRPA14",24,0)
 ;;573;B;57341489679;57315719529
"RTN","SDRPA14",25,0)
 ;;573;ER;200;2509,
"RTN","SDRPA14",26,0)
 ;;573;B;57341492136;57315722645
"RTN","SDRPA14",27,0)
 ;;573;ER;200;4636,
"RTN","SDRPA14",28,0)
 ;;573;B;57341492794;57315724385
"RTN","SDRPA14",29,0)
 ;;573;ER;700;1820,1821,1822,1823,
"RTN","SDRPA14",30,0)
 ;;573;B;57341495581;57315727630
"RTN","SDRPA14",31,0)
 ;;573;ER;200;4448,
"RTN","SDRPA14",32,0)
 ;;573;ER;400;550,
"RTN","SDRPA14",33,0)
 ;;573;B;57341498824;57315731474
"RTN","SDRPA14",34,0)
 ;;573;ER;200;1816,2711,
"RTN","SDRPA14",35,0)
 ;;573;B;57341500431;57315733222
"RTN","SDRPA14",36,0)
 ;;573;ER;400;35,
"RTN","SDRPA14",37,0)
 ;;573;B;57341503288;57315737113
"RTN","SDRPA14",38,0)
 ;;573;ER;200;2480,
"RTN","SDRPA14",39,0)
 ;;573;B;57341520649;57315761979
"RTN","SDRPA14",40,0)
 ;;573;ER;350;1962,4422,
"RTN","SDRPA14",41,0)
 ;;573;ER;400;259,
"RTN","SDRPA14",42,0)
 ;;573;B;57341569767;57315841639
"RTN","SDRPA14",43,0)
 ;;573;ER;200;1577,
"RTN","SDRPA14",44,0)
 ;;573;B;57341570917;57315843211
"RTN","SDRPA14",45,0)
 ;;573;ER;200;1678,2517,2826,
"RTN","SDRPA14",46,0)
 ;;573;B;57341575458;57315852716
"RTN","SDRPA14",47,0)
 ;;573;ER;200;4596,
"RTN","SDRPA14",48,0)
 ;;573;ER;350;4077,
"RTN","SDRPA14",49,0)
 ;;573;B;57341579418;57315857030
"RTN","SDRPA14",50,0)
 ;;573;ER;200;1818,
"RTN","SDRPA14",51,0)
 ;;573;B;57341674187;57316001990
"RTN","SDRPA14",52,0)
 ;;573;ER;200;3044,3292,
"RTN","SDRPA14",53,0)
 ;;573;B;57341679090;57316011044
"RTN","SDRPA14",54,0)
 ;;573;ER;200;2092,2094,
"RTN","SDRPA14",55,0)
 ;;573;B;57341681987;57316015213
"RTN","SDRPA14",56,0)
 ;;573;ER;200;1380,
"RTN","SDRPA14",57,0)
 ;;573;ER;350;1516,
"RTN","SDRPA14",58,0)
 ;;573;B;57341695560;57316035922
"RTN","SDRPA14",59,0)
 ;;573;ER;200;4518,
"RTN","SDRPA14",60,0)
 ;;573;B;57341698193;57316040853
"RTN","SDRPA14",61,0)
 ;;573;ER;400;651,652,653,654,655,
"RTN","SDRPA14",62,0)
 ;;573;B;57341706343;57316060325
"RTN","SDRPA14",63,0)
 ;;573;ER;200;2505,2901,3195,
"RTN","SDRPA14",64,0)
 ;;573;B;57341707374;57316061797
"RTN","SDRPA14",65,0)
 ;;573;ER;200;4600,
"RTN","SDRPA14",66,0)
 ;;573;B;57341709992;57316070530
"RTN","SDRPA14",67,0)
 ;;573;ER;200;4570,
"RTN","SDRPA14",68,0)
 ;;573;B;57341710221;57316070949
"RTN","SDRPA14",69,0)
 ;;573;ER;200;4093,
"RTN","SDRPA14",70,0)
 ;;573;B;57341711151;57316071850
"RTN","SDRPA14",71,0)
 ;;573;ER;200;1729,
"RTN","SDRPA14",72,0)
 ;;573;B;57341716961;57316079101
"RTN","SDRPA14",73,0)
 ;;573;ER;700;1071,
"RTN","SDRPA14",74,0)
 ;;573;B;57341773438;57316162909
"RTN","SDRPA14",75,0)
 ;;573;ER;400;228,229,692,750,
"RTN","SDRPA14",76,0)
 ;;573;B;57341781048;57316175318
"RTN","SDRPA14",77,0)
 ;;573;ER;400;612,
"RTN","SDRPA14",78,0)
 ;;573;B;57341791215;57316189877
"RTN","SDRPA14",79,0)
 ;;573;ER;200;1702,2431,
"RTN","SDRPA14",80,0)
 ;;573;B;57341828949;57316236656
"RTN","SDRPA14",81,0)
 ;;573;ER;200;3837,4318,
"RTN","SDRPA14",82,0)
 ;;573;B;57341832016;57316242557
"RTN","SDRPA14",83,0)
 ;;573;ER;200;1379,
"RTN","SDRPA14",84,0)
 ;;573;ER;400;693,
"RTN","SDRPA14",85,0)
 ;;573;B;57341834624;57316245932
"RTN","SDRPA14",86,0)
 ;;573;ER;200;325,326,4404,
"RTN","SDRPA14",87,0)
 ;;573;B;57341836365;57316248426
"RTN","SDRPA14",88,0)
 ;;573;ER;400;660,
"RTN","SDRPA14",89,0)
 ;;573;B;57341836617;57316248858
"RTN","SDRPA14",90,0)
 ;;573;ER;200;2279,2978,
"RTN","SDRPA14",91,0)
 ;;573;B;57341836857;57316248968
"RTN","SDRPA14",92,0)
 ;;573;ER;400;320,
"RTN","SDRPA14",93,0)
 ;;573;B;57341837065;57316249491
"RTN","SDRPA14",94,0)
 ;;573;ER;200;375,
"RTN","SDRPA14",95,0)
 ;;573;B;57341837257;57316249683
"RTN","SDRPA14",96,0)
 ;;573;ER;200;2151,2154,
"RTN","SDRPA14",97,0)
 ;;573;B;57341837471;57316250076
"RTN","SDRPA14",98,0)
 ;;573;ER;200;4501,4505,
"RTN","SDRPA14",99,0)
 ;;573;B;57341839782;57316252638
"RTN","SDRPA14",100,0)
 ;;573;ER;400;235,
"RTN","SDRPA14",101,0)
 ;;573;B;57341842379;57316255955
"RTN","SDRPA14",102,0)
 ;;573;ER;400;615,
"RTN","SDRPA14",103,0)
 ;;573;B;57341874437;57316306782
"RTN","SDRPA14",104,0)
 ;;573;ER;200;1504,1505,1845,2273,2274,2275,2625,2626,2930,2931,2932,4740,4741,
"RTN","SDRPA14",105,0)
 ;;573;ER;350;1377,1633,
"RTN","SDRPA14",106,0)
 ;;573;ER;400;173,482,483,484,485,486,
"RTN","SDRPA14",107,0)
578 ;;
"RTN","SDRPA14",108,0)
 ;;578;B;57829530511;57849068398
"RTN","SDRPA14",109,0)
 ;;578;ER;350;3390,
"RTN","SDRPA14",110,0)
 ;;578;B;57829546923;57849087498
"RTN","SDRPA14",111,0)
 ;;578;ER;350;1795,
"RTN","SDRPA14",112,0)
 ;;578;B;57829548330;57849089338
"RTN","SDRPA14",113,0)
 ;;578;ER;350;4065,
"RTN","SDRPA14",114,0)
 ;;578;B;57829549548;57849090878
"RTN","SDRPA14",115,0)
 ;;578;ER;350;4573,
"RTN","SDRPA14",116,0)
 ;;578;B;57829556791;57849099346
"RTN","SDRPA14",117,0)
 ;;578;ER;350;2541,
"RTN","SDRPA14",118,0)
 ;;578;B;57829562050;57849105770
"RTN","SDRPA14",119,0)
 ;;578;ER;350;1246,
"RTN","SDRPA14",120,0)
580 ;;
"RTN","SDRPA14",121,0)
 ;;580;B;58028677146;58060598974
"RTN","SDRPA14",122,0)
 ;;580;ER;350;4691,
"RTN","SDRPA14",123,0)
 ;;580;B;58028679370;58060601963
"RTN","SDRPA14",124,0)
 ;;580;ER;350;4301,
"RTN","SDRPA14",125,0)
 ;;580;B;58028680566;58060603502
"RTN","SDRPA14",126,0)
 ;;580;ER;350;3453,
"RTN","SDRPA14",127,0)
 ;;580;B;58028681606;58060605513
"RTN","SDRPA14",128,0)
 ;;580;ER;350;2195,
"RTN","SDRPA14",129,0)
 ;;580;B;58028681697;58060605606
"RTN","SDRPA14",130,0)
 ;;580;ER;350;4365,
"RTN","SDRPA14",131,0)
 ;;580;B;58028681963;58060605959
"RTN","SDRPA14",132,0)
 ;;580;ER;350;4217,
"RTN","SDRPA14",133,0)
 ;;580;B;58028682205;58060606364
"RTN","SDRPA14",134,0)
 ;;580;ER;350;4720,
"RTN","SDRPA14",135,0)
 ;;580;B;58028682294;58060606550
"RTN","SDRPA14",136,0)
 ;;580;ER;350;4977,
"RTN","SDRPA14",137,0)
581 ;;
"RTN","SDRPA14",138,0)
 ;;581;B;58119172408;58129312063
"RTN","SDRPA14",139,0)
 ;;581;ER;350;3445,
"RTN","SDRPA14",140,0)
 ;;581;B;58119173049;58129312699
"RTN","SDRPA14",141,0)
 ;;581;ER;350;2436,
"RTN","SDRPA14",142,0)
585 ;;
"RTN","SDRPA14",143,0)
 ;;585;B;58519290836;58520450002
"RTN","SDRPA14",144,0)
 ;;585;ER;350;790,
"RTN","SDRPA14",145,0)
 ;;585;B;58519291576;58520450521
"RTN","SDRPA14",146,0)
 ;;585;ER;350;702,
"RTN","SDRPA14",147,0)
586 ;;
"RTN","SDRPA14",148,0)
 ;;586;B;58613842182;58629011651
"RTN","SDRPA14",149,0)
 ;;586;ER;350;4319,
"RTN","SDRPA14",150,0)
 ;;586;B;58613842258;58629011775
"RTN","SDRPA14",151,0)
 ;;586;ER;350;4099,4102,
"RTN","SDRPA14",152,0)
 ;;586;B;58613842571;58629012161
"RTN","SDRPA14",153,0)
 ;;586;ER;350;4462,
"RTN","SDRPA14",154,0)
 ;;586;B;58613842662;58629012274
"RTN","SDRPA14",155,0)
 ;;586;ER;350;1791,
"RTN","SDRPA14",156,0)
 ;;586;B;58613842821;58629012513
"RTN","SDRPA14",157,0)
 ;;586;ER;350;1185,
"RTN","SDRPA14",158,0)
 ;;586;B;58613842835;58629012534
"RTN","SDRPA14",159,0)
 ;;586;ER;350;3752,
"RTN","SDRPA14",160,0)
589 ;;
"RTN","SDRPA14",161,0)
 ;;589;B;58960524418;58991794662
"RTN","SDRPA14",162,0)
 ;;589;ER;700;1248,
"RTN","SDRPA14",163,0)
 ;;589;B;58960551798;58991828049
"RTN","SDRPA14",164,0)
 ;;589;ER;350;593,
"RTN","SDRPA14",165,0)
590 ;;
"RTN","SDRPA14",166,0)
 ;;590;B;59012333707;59019239340
"RTN","SDRPA14",167,0)
 ;;590;ER;350;2431,
"RTN","SDRPA14",168,0)
593 ;;
"RTN","SDRPA14",169,0)
 ;;593;B;59326911928;59332408266
"RTN","SDRPA14",170,0)
 ;;593;ER;350;4666,
"RTN","SDRPA14",171,0)
595 ;;
"RTN","SDRPA14",172,0)
 ;;595;B;59592063554;59560474846
"RTN","SDRPA14",173,0)
 ;;595;ER;350;2801,3556,
"RTN","SDRPA14",174,0)
 ;;595;B;59592068645;59560477543
"RTN","SDRPA14",175,0)
 ;;595;ER;350;2423,
"RTN","SDRPA14",176,0)
 ;;595;B;59592093832;59560491541
"RTN","SDRPA14",177,0)
 ;;595;ER;350;4741,
"RTN","SDRPA14",178,0)
 ;;595;B;59592097396;59560493679
"RTN","SDRPA14",179,0)
 ;;595;ER;350;4302,
"RTN","SDRPA14",180,0)
 ;;595;B;59592097407;59560493726
"RTN","SDRPA14",181,0)
 ;;595;ER;350;2566,
"RTN","SDRPA14",182,0)
596 ;;
"RTN","SDRPA14",183,0)
 ;;596;B;59670076649;59628464879
"RTN","SDRPA14",184,0)
 ;;596;ER;350;81,
"RTN","SDRPA14",185,0)
598 ;;
"RTN","SDRPA14",186,0)
 ;;598;B;59832615755;5988785037
"RTN","SDRPA14",187,0)
 ;;598;ER;350;4295,
"RTN","SDRPA14",188,0)
 ;;598;B;59832665961;5988862464
"RTN","SDRPA14",189,0)
 ;;598;ER;350;3621,
"RTN","SDRPA14",190,0)
 ;;598;B;59832666979;5988863704
"RTN","SDRPA14",191,0)
 ;;598;ER;350;2505,
"RTN","SDRPA14",192,0)
 ;;598;B;59832676491;5988875993
"RTN","SDRPA14",193,0)
 ;;598;ER;350;1646,
"RTN","SDRPA14",194,0)
 ;;598;B;59832676797;5988876476
"RTN","SDRPA14",195,0)
 ;;598;ER;350;4771,
"RTN","SDRPA14",196,0)
 ;;598;B;59832685366;5988894468
"RTN","SDRPA14",197,0)
 ;;598;ER;350;1207,
"RTN","SDRPA14",198,0)
603 ;;
"RTN","SDRPA14",199,0)
 ;;603;B;60323022947;60331845934
"RTN","SDRPA14",200,0)
 ;;603;ER;400;824,
"RTN","SDRPA14",201,0)
 ;;603;B;60323025516;60331848091
"RTN","SDRPA14",202,0)
 ;;603;ER;350;4781,
"RTN","SDRPA14",203,0)
 ;;603;B;60323027636;60331850083
"RTN","SDRPA14",204,0)
 ;;603;ER;350;3003,
"RTN","SDRPA14",205,0)
 ;;603;B;60323028154;60331850561
"RTN","SDRPA14",206,0)
 ;;603;ER;350;2667,
"RTN","SDRPA14",207,0)
 ;;603;B;60323029629;60331851961
"RTN","SDRPA14",208,0)
 ;;603;ER;350;4024,
"RTN","SDRPA14",209,0)
 ;;603;B;60323058642;60331889465
"RTN","SDRPA14",210,0)
 ;;603;ER;400;4978,4979,4980,
"RTN","SDRPA14",211,0)
605 ;;
"RTN","SDRPA14",212,0)
 ;;605;B;60529709067;60542594202
"RTN","SDRPA14",213,0)
 ;;605;ER;700;101,
"RTN","SDRPA14",214,0)
 ;;605;B;60529709962;60542595441
"RTN","SDRPA14",215,0)
 ;;605;ER;350;839,
"RTN","SDRPA14",216,0)
 ;;605;B;60529717983;60542605175
"RTN","SDRPA14",217,0)
 ;;605;ER;400;314,
"RTN","SDRPA14",218,0)
607 ;;
"RTN","SDRPA14",219,0)
 ;;607;B;60715816407;60724532978
"RTN","SDRPA14",220,0)
 ;;607;ER;350;1741,
"RTN","SDRPA14",221,0)
 ;;607;B;60715816891;60724533804
"RTN","SDRPA14",222,0)
 ;;607;ER;350;835,1243,
"RTN","SDRPA14",223,0)
 ;;607;B;60715819072;60724536838
"RTN","SDRPA14",224,0)
 ;;607;ER;350;13,
"RTN","SDRPA14",225,0)
 ;;607;B;60715827931;60724547414
"RTN","SDRPA14",226,0)
 ;;607;ER;350;3880,
"RTN","SDRPA14",227,0)
608 ;;
"RTN","SDRPA14",228,0)
 ;;608;B;60812360929;60817646348
"RTN","SDRPA14",229,0)
 ;;608;ER;350;242,
"RTN","SDRPA14",230,0)
610 ;;
"RTN","SDRPA14",231,0)
 ;;610;B;61012402904;6106912019
"RTN","SDRPA14",232,0)
 ;;610;ER;350;3204,
"RTN","SDRPA14",233,0)
 ;;610;B;61012406207;6106916012
"RTN","SDRPA14",234,0)
 ;;610;ER;350;144,758,
"RTN","SDRPA14",235,0)
612 ;;
"RTN","SDRPA14",236,0)
 ;;612;B;61224607028;61252523748
"RTN","SDRPA14",237,0)
 ;;612;ER;350;2923,
"RTN","SDRPA14",238,0)
 ;;612;B;61224625224;61252550343
"RTN","SDRPA14",239,0)
 ;;612;ER;350;1612,
"RTN","SDRPA14",240,0)
614 ;;
"RTN","SDRPA14",241,0)
 ;;614;B;61493778802;61475834672
"RTN","SDRPA14",242,0)
 ;;614;ER;350;1092,
"RTN","SDRPA14",243,0)
 ;;614;B;61493947493;61475941007
"RTN","SDRPA14",244,0)
 ;;614;ER;350;1025,
"RTN","SDRPA14",245,0)
618 ;;
"RTN","SDRPA14",246,0)
 ;;618;B;61830310882;61849207623
"RTN","SDRPA14",247,0)
 ;;618;ER;350;2998,4699,
"RTN","SDRPA14",248,0)
 ;;618;B;61830311669;61849208422
"RTN","SDRPA14",249,0)
 ;;618;ER;400;621,803,
"RTN","SDRPA14",250,0)
 ;;618;B;61830311696;61849208514
"RTN","SDRPA14",251,0)
 ;;618;ER;350;2242,
"RTN","SDRPA14",252,0)
 ;;618;B;61830311701;61849208519
"RTN","SDRPA14",253,0)
 ;;618;ER;350;1794,2023,
"RTN","SDRPA14",254,0)
 ;;618;B;61830311823;61849208661
"RTN","SDRPA14",255,0)
 ;;618;ER;350;2001,2293,
"RTN","SDRPA14",256,0)
 ;;618;B;61830311868;61849208729
"RTN","SDRPA14",257,0)
 ;;618;ER;350;913,
"RTN","SDRPA14",258,0)
 ;;618;B;61830311894;61849208756
"RTN","SDRPA14",259,0)
 ;;618;ER;350;1662,2226,3314,
"RTN","SDRPA14",260,0)
 ;;618;B;61830311915;61849208778
"RTN","SDRPA14",261,0)
 ;;618;ER;350;488,4560,4726,4864,4910,4936,4973,
"RTN","SDRPA14",262,0)
 ;;618;B;61830312071;61849208939
"RTN","SDRPA14",263,0)
 ;;618;ER;350;2809,
"RTN","SDRPA14",264,0)
 ;;618;B;61830312114;61849208976
"RTN","SDRPA14",265,0)
 ;;618;ER;350;4487,4918,
"RTN","SDRPA14",266,0)
 ;;618;ER;400;255,
"RTN","SDRPA14",267,0)
 ;;618;B;61830312149;61849209021
"RTN","SDRPA14",268,0)
 ;;618;ER;350;629,
"RTN","SDRPA14",269,0)
 ;;618;B;61830312286;61849209163
"RTN","SDRPA14",270,0)
 ;;618;ER;350;1007,
"RTN","SDRPA14",271,0)
 ;;618;ER;400;688,
"RTN","SDRPA14",272,0)
 ;;618;B;61830312303;61849209178
"RTN","SDRPA14",273,0)
 ;;618;ER;350;1767,
"RTN","SDRPA14",274,0)
 ;;618;B;61830312324;61849209205
"RTN","SDRPA14",275,0)
 ;;618;ER;350;4703,
"RTN","SDRPA14",276,0)
 ;;618;B;61830312361;61849209237
"RTN","SDRPA14",277,0)
 ;;618;ER;350;3419,
"RTN","SDRPA14",278,0)
 ;;618;B;61830312364;61849209252
"RTN","SDRPA14",279,0)
 ;;618;ER;350;4771,
"RTN","SDRPA14",280,0)
 ;;618;B;61830312391;61849209282
"RTN","SDRPA14",281,0)
 ;;618;ER;350;4831,
"RTN","SDRPA14",282,0)
 ;;618;B;61830312397;61849209288
"RTN","SDRPA14",283,0)
 ;;618;ER;350;326,
"RTN","SDRPA14",284,0)
 ;;618;B;61830312452;61849209355
"RTN","SDRPA14",285,0)
 ;;618;ER;350;3504,
"RTN","SDRPA14",286,0)
 ;;618;B;61830312457;61849209357
"RTN","SDRPA14",287,0)
 ;;618;ER;400;585,586,587,
"RTN","SDRPA14",288,0)
 ;;618;B;61830312599;61849209503
"RTN","SDRPA14",289,0)
 ;;618;ER;350;1091,
"RTN","SDRPA14",290,0)
 ;;618;B;61830312620;61849209524
"RTN","SDRPA14",291,0)
 ;;618;ER;400;840,
"RTN","SDRPA14",292,0)
 ;;618;B;61830312636;61849209548
"RTN","SDRPA14",293,0)
 ;;618;ER;350;1309,1681,
"RTN","SDRPA14",294,0)
 ;;618;B;61830312685;61849209597
"RTN","SDRPA14",295,0)
 ;;618;ER;350;1298,2501,
"RTN","SDRPA14",296,0)
 ;;618;B;61830312800;61849209700
"RTN","SDRPA14",297,0)
 ;;618;ER;350;3111,
"RTN","SDRPA14",298,0)
 ;;618;B;61830312869;61849209793
"RTN","SDRPA14",299,0)
 ;;618;ER;350;4521,
"RTN","SDRPA14",300,0)
 ;;618;B;61830313456;61849210463
"RTN","SDRPA14",301,0)
 ;;618;ER;350;1227,2620,
"RTN","SDRPA14",302,0)
 ;;618;B;61830313650;61849210673
"RTN","SDRPA14",303,0)
 ;;618;ER;400;372,
"RTN","SDRPA14",304,0)
 ;;618;B;61830465384;61849405161
"RTN","SDRPA14",305,0)
 ;;618;ER;350;3727,
"RTN","SDRPA14",306,0)
 ;;618;B;61830466498;61849406601
"RTN","SDRPA14",307,0)
 ;;618;ER;400;231,232,
"RTN","SDRPA14",308,0)
 ;;618;B;61830466967;61849407222
"RTN","SDRPA14",309,0)
 ;;618;ER;400;197,
"RTN","SDRPA14",310,0)
 ;;618;B;61830471715;61849413242
"RTN","SDRPA14",311,0)
 ;;618;ER;400;104,
"RTN","SDRPA14",312,0)
 ;;618;B;61830472001;61849413603
"RTN","SDRPA14",313,0)
 ;;618;ER;350;1038,2211,2825,3555,4156,
"RTN","SDRPA14",314,0)
 ;;618;B;61830477267;61849420417
"RTN","SDRPA14",315,0)
 ;;618;ER;400;151,278,
"RTN","SDRPA14",316,0)
 ;;618;B;61830481012;61849425245
"RTN","SDRPA14",317,0)
 ;;618;"ER";400;199,
"RTN","SDRPA15")
0^14^B78928522
"RTN","SDRPA15",1,0)
SDRPA15 ;BP-OIFO/ESW - UTILITY ; 6/9/04 8:28am
"RTN","SDRPA15",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA15",3,0)
EN(ST) ;
"RTN","SDRPA15",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ
"RTN","SDRPA15",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:+STR'=ST  D
"RTN","SDRPA15",6,0)
 .S SA=$P(STR,";",2) Q:SA'="B"
"RTN","SDRPA15",7,0)
 .S SB=$P(STR,";",3),SM=$P(STR,";",4) D
"RTN","SDRPA15",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:+STE'=ST!($P(STE,";",2)="B")  D
"RTN","SDRPA15",9,0)
 ...S ER=$P(STE,";",3) S SQS=$P(STE,";",4) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA15",10,0)
 ..;update batch acknowledgement
"RTN","SDRPA15",11,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA15",12,0)
 Q
"RTN","SDRPA15",13,0)
619 ;;
"RTN","SDRPA15",14,0)
 ;;619;B;61934461160;61935566249
"RTN","SDRPA15",15,0)
 ;;619;ER;350;1495,1996,3185,3411,
"RTN","SDRPA15",16,0)
 ;;619;B;61934467364;61935570694
"RTN","SDRPA15",17,0)
 ;;619;ER;350;3713,
"RTN","SDRPA15",18,0)
 ;;619;B;61934475278;61935575320
"RTN","SDRPA15",19,0)
 ;;619;ER;350;1233,
"RTN","SDRPA15",20,0)
 ;;619;B;61934476854;61935576213
"RTN","SDRPA15",21,0)
 ;;619;ER;400;1715,
"RTN","SDRPA15",22,0)
 ;;619;B;61934478706;61935577448
"RTN","SDRPA15",23,0)
 ;;619;ER;350;271,
"RTN","SDRPA15",24,0)
 ;;619;B;61934479827;61935578142
"RTN","SDRPA15",25,0)
 ;;619;ER;350;3315,
"RTN","SDRPA15",26,0)
 ;;619;ER;400;190,
"RTN","SDRPA15",27,0)
620 ;;
"RTN","SDRPA15",28,0)
 ;;620;B;62094177662;62065197692
"RTN","SDRPA15",29,0)
 ;;620;ER;350;1836,
"RTN","SDRPA15",30,0)
 ;;620;B;62094207805;62065214364
"RTN","SDRPA15",31,0)
 ;;620;ER;350;611,
"RTN","SDRPA15",32,0)
621 ;;
"RTN","SDRPA15",33,0)
 ;;621;B;62184281093;62139478336
"RTN","SDRPA15",34,0)
 ;;621;ER;350;2847,
"RTN","SDRPA15",35,0)
 ;;621;B;62184285387;62139480913
"RTN","SDRPA15",36,0)
 ;;621;ER;350;3329,
"RTN","SDRPA15",37,0)
623 ;;
"RTN","SDRPA15",38,0)
 ;;623;B;62313573887;62324520029
"RTN","SDRPA15",39,0)
 ;;623;ER;350;3210,
"RTN","SDRPA15",40,0)
 ;;623;B;62313584324;62324534684
"RTN","SDRPA15",41,0)
 ;;623;ER;350;480,
"RTN","SDRPA15",42,0)
626 ;;
"RTN","SDRPA15",43,0)
 ;;626;B;62641068414;626126580504
"RTN","SDRPA15",44,0)
 ;;626;ER;350;3360,3549,
"RTN","SDRPA15",45,0)
 ;;626;B;62641276624;626126720487
"RTN","SDRPA15",46,0)
 ;;626;ER;350;1058,
"RTN","SDRPA15",47,0)
 ;;626;B;62641662292;626126985971
"RTN","SDRPA15",48,0)
 ;;626;ER;400;4934,
"RTN","SDRPA15",49,0)
 ;;626;B;62641691414;626127005866
"RTN","SDRPA15",50,0)
 ;;626;ER;400;4901,4902,
"RTN","SDRPA15",51,0)
629 ;;
"RTN","SDRPA15",52,0)
 ;;629;B;62921109547;62958401319
"RTN","SDRPA15",53,0)
 ;;629;ER;700;203,
"RTN","SDRPA15",54,0)
 ;;629;B;62921230076;62958619265
"RTN","SDRPA15",55,0)
 ;;629;ER;700;203,
"RTN","SDRPA15",56,0)
630 ;;
"RTN","SDRPA15",57,0)
 ;;630;B;63050701981;630157174109
"RTN","SDRPA15",58,0)
 ;;630;ER;350;4936,
"RTN","SDRPA15",59,0)
 ;;630;B;63050913340;630157820628
"RTN","SDRPA15",60,0)
 ;;630;ER;450;3028,
"RTN","SDRPA15",61,0)
631 ;;
"RTN","SDRPA15",62,0)
 ;;631;B;6319029561;63113225143
"RTN","SDRPA15",63,0)
 ;;631;ER;350;1127,
"RTN","SDRPA15",64,0)
635 ;;
"RTN","SDRPA15",65,0)
 ;;635;B;63520523705;63537174321
"RTN","SDRPA15",66,0)
 ;;635;ER;400;159,
"RTN","SDRPA15",67,0)
 ;;635;B;63520523873;63537174702
"RTN","SDRPA15",68,0)
 ;;635;ER;400;520,521,522,
"RTN","SDRPA15",69,0)
 ;;635;B;63520524115;63537174943
"RTN","SDRPA15",70,0)
 ;;635;ER;350;664,
"RTN","SDRPA15",71,0)
 ;;635;ER;400;1452,
"RTN","SDRPA15",72,0)
 ;;635;B;63520525121;63537176250
"RTN","SDRPA15",73,0)
 ;;635;ER;350;1120,
"RTN","SDRPA15",74,0)
 ;;635;B;63520527107;63537177775
"RTN","SDRPA15",75,0)
 ;;635;ER;400;679,
"RTN","SDRPA15",76,0)
 ;;635;B;63520531762;63537184107
"RTN","SDRPA15",77,0)
 ;;635;ER;400;747,
"RTN","SDRPA15",78,0)
 ;;635;B;63520538010;63537192878
"RTN","SDRPA15",79,0)
 ;;635;ER;350;1563,
"RTN","SDRPA15",80,0)
 ;;635;ER;400;790,
"RTN","SDRPA15",81,0)
 ;;635;B;63520542593;63537198482
"RTN","SDRPA15",82,0)
 ;;635;ER;350;2498,
"RTN","SDRPA15",83,0)
 ;;635;B;63520543699;63537200310
"RTN","SDRPA15",84,0)
 ;;635;ER;350;975,4219,
"RTN","SDRPA15",85,0)
 ;;635;ER;400;1093,
"RTN","SDRPA15",86,0)
 ;;635;B;63520544591;63537201534
"RTN","SDRPA15",87,0)
 ;;635;ER;400;1213,
"RTN","SDRPA15",88,0)
 ;;635;B;63520545094;63537202138
"RTN","SDRPA15",89,0)
 ;;635;ER;350;1184,
"RTN","SDRPA15",90,0)
 ;;635;B;63520549024;63537207961
"RTN","SDRPA15",91,0)
 ;;635;ER;400;875,
"RTN","SDRPA15",92,0)
 ;;635;B;63520589371;63537253180
"RTN","SDRPA15",93,0)
 ;;635;ER;400;838,
"RTN","SDRPA15",94,0)
 ;;635;B;63520596578;63537262680
"RTN","SDRPA15",95,0)
 ;;635;ER;400;635,
"RTN","SDRPA15",96,0)
 ;;635;B;63520598566;63537265274
"RTN","SDRPA15",97,0)
 ;;635;ER;400;584,
"RTN","SDRPA15",98,0)
636 ;;
"RTN","SDRPA15",99,0)
 ;;636;B;63635193423;63662847520
"RTN","SDRPA15",100,0)
 ;;636;ER;350;3571,
"RTN","SDRPA15",101,0)
 ;;636;B;63635202403;63662859075
"RTN","SDRPA15",102,0)
 ;;636;ER;700;581,
"RTN","SDRPA15",103,0)
 ;;636;B;63635462920;63663227039
"RTN","SDRPA15",104,0)
 ;;636;ER;350;3569,
"RTN","SDRPA15",105,0)
 ;;636;B;63635467872;63663232717
"RTN","SDRPA15",106,0)
 ;;636;ER;700;527,
"RTN","SDRPA15",107,0)
 ;;636;B;63635805870;63663722429
"RTN","SDRPA15",108,0)
 ;;636;ER;350;1479,
"RTN","SDRPA15",109,0)
 ;;636;B;63635807214;63663724105
"RTN","SDRPA15",110,0)
 ;;636;ER;450;895,
"RTN","SDRPA15",111,0)
 ;;636;B;63636979130;63665361302
"RTN","SDRPA15",112,0)
 ;;636;ER;350;3571,
"RTN","SDRPA15",113,0)
 ;;636;B;63636983651;63665367674
"RTN","SDRPA15",114,0)
 ;;636;ER;700;331,
"RTN","SDRPA15",115,0)
 ;;636;B;63636986728;63665371597
"RTN","SDRPA15",116,0)
 ;;636;ER;350;1668,
"RTN","SDRPA15",117,0)
 ;;636;B;63636987649;63665372545
"RTN","SDRPA15",118,0)
 ;;636;ER;350;1267,1317,
"RTN","SDRPA15",119,0)
 ;;636;B;63637000797;63665391307
"RTN","SDRPA15",120,0)
 ;;636;ER;350;1245,
"RTN","SDRPA15",121,0)
 ;;636;B;63637044170;63665453294
"RTN","SDRPA15",122,0)
 ;;636;ER;350;1432,
"RTN","SDRPA15",123,0)
 ;;636;B;63637045723;63665455406
"RTN","SDRPA15",124,0)
 ;;636;ER;350;1953,
"RTN","SDRPA15",125,0)
637 ;;
"RTN","SDRPA15",126,0)
 ;;637;B;63712358412;63720591588
"RTN","SDRPA15",127,0)
 ;;637;ER;350;644,
"RTN","SDRPA15",128,0)
640 ;;
"RTN","SDRPA15",129,0)
 ;;640;B;64028032219;64071284831
"RTN","SDRPA15",130,0)
 ;;640;ER;400;1947,
"RTN","SDRPA15",131,0)
 ;;640;B;64028034427;64071292241
"RTN","SDRPA15",132,0)
 ;;640;ER;350;3954,
"RTN","SDRPA15",133,0)
 ;;640;B;64028035904;64071295525
"RTN","SDRPA15",134,0)
 ;;640;ER;350;3137,
"RTN","SDRPA15",135,0)
 ;;640;B;64028037495;64071297942
"RTN","SDRPA15",136,0)
 ;;640;ER;350;3880,
"RTN","SDRPA15",137,0)
 ;;640;B;64028040018;64071309972
"RTN","SDRPA15",138,0)
 ;;640;ER;350;1058,
"RTN","SDRPA15",139,0)
 ;;640;B;64028040706;64071312241
"RTN","SDRPA15",140,0)
 ;;640;ER;350;4996,
"RTN","SDRPA15",141,0)
 ;;640;B;64028041583;64071316787
"RTN","SDRPA15",142,0)
 ;;640;ER;350;4816,
"RTN","SDRPA15",143,0)
642 ;;
"RTN","SDRPA15",144,0)
 ;;642;B;64219040764;64247692763
"RTN","SDRPA15",145,0)
 ;;642;ER;350;3918,
"RTN","SDRPA15",146,0)
 ;;642;B;64219044000;64247697805
"RTN","SDRPA15",147,0)
 ;;642;ER;350;4345,
"RTN","SDRPA15",148,0)
 ;;642;B;64219055644;64247719067
"RTN","SDRPA15",149,0)
 ;;642;ER;350;1856,
"RTN","SDRPA15",150,0)
 ;;642;B;64219064867;64247734420
"RTN","SDRPA15",151,0)
 ;;642;ER;350;2019,
"RTN","SDRPA15",152,0)
 ;;642;B;64219066381;64247736808
"RTN","SDRPA15",153,0)
 ;;642;ER;350;1633,
"RTN","SDRPA15",154,0)
 ;;642;B;64219070163;64247743950
"RTN","SDRPA15",155,0)
 ;;642;ER;350;1946,
"RTN","SDRPA15",156,0)
 ;;642;B;64219070384;64247744318
"RTN","SDRPA15",157,0)
 ;;642;ER;350;2242,
"RTN","SDRPA15",158,0)
 ;;642;B;64219071069;64247745564
"RTN","SDRPA15",159,0)
 ;;642;ER;350;3850,
"RTN","SDRPA15",160,0)
 ;;642;B;64219071155;64247745706
"RTN","SDRPA15",161,0)
 ;;642;ER;350;1505,2788,4683,
"RTN","SDRPA15",162,0)
 ;;642;B;64219071235;64247745877
"RTN","SDRPA15",163,0)
 ;;642;ER;350;3030,
"RTN","SDRPA15",164,0)
 ;;642;B;64219071531;64247746887
"RTN","SDRPA15",165,0)
 ;;642;ER;350;1791,
"RTN","SDRPA15",166,0)
 ;;642;B;64219071792;64247747601
"RTN","SDRPA15",167,0)
 ;;642;ER;350;300,3686,
"RTN","SDRPA15",168,0)
 ;;642;B;64219073896;64247756907
"RTN","SDRPA15",169,0)
 ;;642;ER;700;1011,
"RTN","SDRPA15",170,0)
644 ;;
"RTN","SDRPA15",171,0)
 ;;644;B;64431818656;64446027218
"RTN","SDRPA15",172,0)
 ;;644;ER;350;2278,
"RTN","SDRPA15",173,0)
 ;;644;B;64431874728;64446084905
"RTN","SDRPA15",174,0)
 ;;644;ER;350;2167,
"RTN","SDRPA15",175,0)
 ;;644;B;64431889209;64446101223
"RTN","SDRPA15",176,0)
 ;;644;ER;350;4004,
"RTN","SDRPA15",177,0)
 ;;644;B;64431896874;64446108951
"RTN","SDRPA15",178,0)
 ;;644;ER;350;3130,
"RTN","SDRPA15",179,0)
 ;;644;B;64431904135;64446116323
"RTN","SDRPA15",180,0)
 ;;644;ER;350;2433,
"RTN","SDRPA15",181,0)
 ;;644;B;64431978829;64446192826
"RTN","SDRPA15",182,0)
 ;;644;ER;200;31,163,412,
"RTN","SDRPA15",183,0)
 ;;644;B;64431980821;64446195496
"RTN","SDRPA15",184,0)
 ;;644;ER;200;643,727,734,1250,1386,1760,1905,2107,2244,2598,2676,3513,3538,3552,3823,3945,4733,
"RTN","SDRPA15",185,0)
 ;;644;B;64431989436;64446203597
"RTN","SDRPA15",186,0)
 ;;644;ER;200;33,
"RTN","SDRPA15",187,0)
 ;;644;B;64431992122;64446205828
"RTN","SDRPA15",188,0)
 ;;644;ER;200;386,453,557,689,755,798,803,982,1030,1440,1605,1788,1885,2290,2393,3004,3787,3790,4628,
"RTN","SDRPA15",189,0)
 ;;644;B;64431993591;64446207840
"RTN","SDRPA15",190,0)
 ;;644;ER;200;65,353,354,388,499,656,1151,1198,1365,1835,1840,2382,2620,
"RTN","SDRPA15",191,0)
 ;;644;B;64431994207;64446208461
"RTN","SDRPA15",192,0)
 ;;644;ER;200;2279,2589,2894,2991,3450,3894,4064,
"RTN","SDRPA15",193,0)
 ;;644;B;64432000557;64446214187
"RTN","SDRPA15",194,0)
 ;;644;ER;200;235,939,972,1005,1056,1125,1162,1589,1624,1942,1954,2071,2351,2439,2482,
"RTN","SDRPA15",195,0)
 ;;644;B;64432001163;64446214612
"RTN","SDRPA15",196,0)
 ;;644;ER;200;589,804,1007,1355,1424,
"RTN","SDRPA15",197,0)
646 ;;
"RTN","SDRPA15",198,0)
 ;;646;B;64622152067;64636125592
"RTN","SDRPA15",199,0)
 ;;646;ER;350;3641,
"RTN","SDRPA15",200,0)
 ;;646;B;64622172061;64636149373
"RTN","SDRPA15",201,0)
 ;;646;ER;350;2807,
"RTN","SDRPA15",202,0)
 ;;646;B;64622177731;64636158072
"RTN","SDRPA15",203,0)
 ;;646;ER;350;2913,
"RTN","SDRPA15",204,0)
 ;;646;B;64622182360;64636165439
"RTN","SDRPA15",205,0)
 ;;646;ER;350;2350,
"RTN","SDRPA15",206,0)
 ;;646;B;64622182634;64636165816
"RTN","SDRPA15",207,0)
 ;;646;ER;350;1713,
"RTN","SDRPA15",208,0)
648 ;;
"RTN","SDRPA15",209,0)
 ;;648;B;64830169503;64859420738
"RTN","SDRPA15",210,0)
 ;;648;ER;350;3226,
"RTN","SDRPA15",211,0)
 ;;648;B;64830173491;64859426791
"RTN","SDRPA15",212,0)
 ;;648;ER;350;559,
"RTN","SDRPA15",213,0)
 ;;648;B;64830176032;64859430610
"RTN","SDRPA15",214,0)
 ;;648;ER;350;3576,
"RTN","SDRPA15",215,0)
 ;;648;B;64830176493;64859431425
"RTN","SDRPA15",216,0)
 ;;648;ER;350;4437,
"RTN","SDRPA15",217,0)
 ;;648;B;64830181488;64859439943
"RTN","SDRPA15",218,0)
 ;;648;ER;200;201,2116,4485,
"RTN","SDRPA15",219,0)
650 ;;
"RTN","SDRPA15",220,0)
 ;;650;B;65013317751;65024393176
"RTN","SDRPA15",221,0)
 ;;650;ER;350;1964,
"RTN","SDRPA15",222,0)
652 ;;
"RTN","SDRPA15",223,0)
 ;;652;B;65211886530;65213575232
"RTN","SDRPA15",224,0)
 ;;652;ER;350;618,
"RTN","SDRPA15",225,0)
 ;;652;B;65211887675;65213578292
"RTN","SDRPA15",226,0)
 ;;652;ER;350;3143,
"RTN","SDRPA15",227,0)
 ;;652;B;65211888822;65213581189
"RTN","SDRPA15",228,0)
 ;;652;ER;350;1029,
"RTN","SDRPA15",229,0)
 ;;652;B;65211914787;65213619795
"RTN","SDRPA15",230,0)
 ;;652;ER;350;525,
"RTN","SDRPA15",231,0)
654 ;;
"RTN","SDRPA15",232,0)
 ;;654;B;65413112674;65419363257
"RTN","SDRPA15",233,0)
 ;;654;ER;350;3301,4157,
"RTN","SDRPA15",234,0)
 ;;654;B;65413223658;65419507467
"RTN","SDRPA15",235,0)
 ;;654;ER;350;2008,2759,3776,
"RTN","SDRPA15",236,0)
655 ;;
"RTN","SDRPA15",237,0)
 ;;655;B;65516549087;65520295193
"RTN","SDRPA15",238,0)
 ;;655;ER;350;3324,
"RTN","SDRPA15",239,0)
657 ;;
"RTN","SDRPA15",240,0)
 ;;657;B;65729884244;65764668755
"RTN","SDRPA15",241,0)
 ;;657;ER;700;4874,
"RTN","SDRPA15",242,0)
 ;;657;B;65729887352;65764672552
"RTN","SDRPA15",243,0)
 ;;657;ER;350;4759,
"RTN","SDRPA15",244,0)
 ;;657;B;65729928496;65764736980
"RTN","SDRPA15",245,0)
 ;;657;ER;700;725,
"RTN","SDRPA15",246,0)
 ;;657;B;65729931738;65764743255
"RTN","SDRPA15",247,0)
 ;;657;ER;700;4571,4782,
"RTN","SDRPA15",248,0)
658 ;;
"RTN","SDRPA15",249,0)
 ;;658;B;65814078326;65822477724
"RTN","SDRPA15",250,0)
 ;;658;ER;350;639,
"RTN","SDRPA15",251,0)
 ;;658;B;65814085475;65822487961
"RTN","SDRPA15",252,0)
 ;;658;ER;350;3798,
"RTN","SDRPA15",253,0)
 ;;658;B;65814091130;65822495944
"RTN","SDRPA15",254,0)
 ;;658;ER;350;3614,
"RTN","SDRPA15",255,0)
 ;;658;B;65814093437;65822499879
"RTN","SDRPA15",256,0)
 ;;658;ER;350;4423,
"RTN","SDRPA15",257,0)
 ;;658;B;65814093863;65822500443
"RTN","SDRPA15",258,0)
 ;;658;ER;350;3272,
"RTN","SDRPA15",259,0)
 ;;658;B;65814093973;65822500660
"RTN","SDRPA15",260,0)
 ;;658;ER;350;4009,
"RTN","SDRPA15",261,0)
 ;;658;B;65814094754;65822504108
"RTN","SDRPA15",262,0)
 ;;658;ER;350;3727,
"RTN","SDRPA15",263,0)
 ;;658;B;65814094883;65822504172
"RTN","SDRPA15",264,0)
 ;;658;ER;350;4794,
"RTN","SDRPA15",265,0)
659 ;;
"RTN","SDRPA15",266,0)
 ;;659;B;65921670759;65928910087
"RTN","SDRPA15",267,0)
 ;;659;ER;350;2755,
"RTN","SDRPA15",268,0)
 ;;659;B;65921671754;65928911209
"RTN","SDRPA15",269,0)
 ;;659;ER;350;3033,
"RTN","SDRPA15",270,0)
 ;;659;B;65921672431;65928911663
"RTN","SDRPA15",271,0)
 ;;659;ER;350;1453,
"RTN","SDRPA15",272,0)
 ;;659;B;65921687821;65928931958
"RTN","SDRPA15",273,0)
 ;;659;ER;350;3395,
"RTN","SDRPA15",274,0)
 ;;659;B;65921746315;65929005443
"RTN","SDRPA15",275,0)
 ;;659;ER;350;4798,
"RTN","SDRPA15",276,0)
 ;;659;B;65921748734;65929009131
"RTN","SDRPA15",277,0)
 ;;659;ER;400;4948,
"RTN","SDRPA15",278,0)
660 ;;
"RTN","SDRPA15",279,0)
 ;;660;B;6608026700;66033848678
"RTN","SDRPA15",280,0)
 ;;660;ER;350;4353,
"RTN","SDRPA15",281,0)
 ;;660;ER;700;34,
"RTN","SDRPA15",282,0)
662 ;;
"RTN","SDRPA15",283,0)
 ;;662;B;66220042896;66219570876
"RTN","SDRPA15",284,0)
 ;;662;ER;400;556,642,643,644,
"RTN","SDRPA15",285,0)
 ;;662;B;66220043286;66219571232
"RTN","SDRPA15",286,0)
 ;;662;ER;400;653,654,655,
"RTN","SDRPA15",287,0)
 ;;662;B;66220043544;66219571400
"RTN","SDRPA15",288,0)
 ;;662;ER;400;699,813,814,815,816,817,
"RTN","SDRPA15",289,0)
 ;;662;B;66220043608;66219571476
"RTN","SDRPA15",290,0)
 ;;662;ER;400;779,780,
"RTN","SDRPA15",291,0)
 ;;662;B;66220043997;66219571735
"RTN","SDRPA15",292,0)
 ;;662;ER;400;743,
"RTN","SDRPA15",293,0)
 ;;662;B;66220044158;66219571900
"RTN","SDRPA15",294,0)
 ;;662;ER;400;744,745,
"RTN","SDRPA15",295,0)
 ;;662;B;66220044918;66219572474
"RTN","SDRPA15",296,0)
 ;;662;ER;350;3643,
"RTN","SDRPA15",297,0)
 ;;662;B;66220045352;66219572827
"RTN","SDRPA15",298,0)
 ;;662;ER;400;923,
"RTN","SDRPA15",299,0)
 ;;662;B;66220045649;66219573166
"RTN","SDRPA15",300,0)
 ;;662;ER;400;975,
"RTN","SDRPA15",301,0)
 ;;662;B;66220049393;66219576633
"RTN","SDRPA15",302,0)
 ;;662;ER;350;4777,4778,
"RTN","SDRPA15",303,0)
 ;;662;B;66220049792;66219577884
"RTN","SDRPA15",304,0)
 ;;662;ER;350;4175,
"RTN","SDRPA15",305,0)
 ;;662;ER;400;651,652,
"RTN","SDRPA15",306,0)
 ;;662;B;66220050273;66219579204
"RTN","SDRPA15",307,0)
 ;;662;ER;350;3735,
"RTN","SDRPA15",308,0)
 ;;662;B;66220076364;66219608607
"RTN","SDRPA15",309,0)
 ;;662;ER;350;4527,
"RTN","SDRPA15",310,0)
 ;;662;B;66220084134;66219618992
"RTN","SDRPA15",311,0)
 ;;662;ER;350;3875,
"RTN","SDRPA15",312,0)
 ;;662;B;66220096015;66219631665
"RTN","SDRPA15",313,0)
 ;;662;ER;350;4527,4584,
"RTN","SDRPA15",314,0)
 ;;662;ER;400;740,
"RTN","SDRPA15",315,0)
663 ;;
"RTN","SDRPA15",316,0)
 ;;663;B;66335145156;66354303336
"RTN","SDRPA15",317,0)
 ;;663;ER;350;553,
"RTN","SDRPA15",318,0)
 ;;663;B;66335183905;66354349535
"RTN","SDRPA15",319,0)
 ;;663;ER;350;553,
"RTN","SDRPA15",320,0)
 ;;663;B;66335202779;66354372618
"RTN","SDRPA15",321,0)
 ;;663;ER;350;225,
"RTN","SDRPA15",322,0)
 ;;663;B;66335218249;66354391533
"RTN","SDRPA15",323,0)
 ;;663;ER;350;1802,
"RTN","SDRPA16")
0^15^B26005812
"RTN","SDRPA16",1,0)
SDRPA16 ;BP-OIFO/ESW - UTILITY ; 6/9/04 8:30am
"RTN","SDRPA16",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA16",3,0)
EN(ST) ;
"RTN","SDRPA16",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ
"RTN","SDRPA16",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:+STR'=ST  D
"RTN","SDRPA16",6,0)
 .S SA=$P(STR,";",2) Q:SA'="B"
"RTN","SDRPA16",7,0)
 .S SB=$P(STR,";",3),SM=$P(STR,";",4) D
"RTN","SDRPA16",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:+STE'=ST!($P(STE,";",2)="B")  D
"RTN","SDRPA16",9,0)
 ...S ER=$P(STE,";",3) S SQS=$P(STE,";",4) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA16",10,0)
 ..;update batch acknowledgement
"RTN","SDRPA16",11,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA16",12,0)
 Q
"RTN","SDRPA16",13,0)
664 ;;
"RTN","SDRPA16",14,0)
 ;;664;B;66428349836;66444721425
"RTN","SDRPA16",15,0)
 ;;664;ER;400;503,
"RTN","SDRPA16",16,0)
 ;;664;B;66428368268;66444741152
"RTN","SDRPA16",17,0)
 ;;664;ER;350;1452,
"RTN","SDRPA16",18,0)
 ;;664;B;66428368989;66444741953
"RTN","SDRPA16",19,0)
 ;;664;ER;350;4755,
"RTN","SDRPA16",20,0)
 ;;664;ER;400;519,
"RTN","SDRPA16",21,0)
 ;;664;B;66428375804;66444748723
"RTN","SDRPA16",22,0)
 ;;664;ER;350;3217,
"RTN","SDRPA16",23,0)
 ;;664;B;66428383184;66444755266
"RTN","SDRPA16",24,0)
 ;;664;ER;400;597,
"RTN","SDRPA16",25,0)
 ;;664;B;66428386245;66444758330
"RTN","SDRPA16",26,0)
 ;;664;ER;400;534,
"RTN","SDRPA16",27,0)
666 ;;
"RTN","SDRPA16",28,0)
 ;;666;B;6669797547;66610952037
"RTN","SDRPA16",29,0)
 ;;666;ER;350;3244,
"RTN","SDRPA16",30,0)
667 ;;
"RTN","SDRPA16",31,0)
 ;;667;B;66713122874;66738994513
"RTN","SDRPA16",32,0)
 ;;667;ER;350;184,
"RTN","SDRPA16",33,0)
 ;;667;B;66713133064;66739009240
"RTN","SDRPA16",34,0)
 ;;667;ER;350;1647,
"RTN","SDRPA16",35,0)
 ;;667;B;66713155082;66739041926
"RTN","SDRPA16",36,0)
 ;;667;ER;350;3290,
"RTN","SDRPA16",37,0)
668 ;;
"RTN","SDRPA16",38,0)
 ;;668;B;66810464290;66817886230
"RTN","SDRPA16",39,0)
 ;;668;ER;350;4754,
"RTN","SDRPA16",40,0)
 ;;668;B;66810466850;66817889332
"RTN","SDRPA16",41,0)
 ;;668;ER;350;2207,
"RTN","SDRPA16",42,0)
 ;;668;B;66810474924;66817900838
"RTN","SDRPA16",43,0)
 ;;668;ER;350;4754,
"RTN","SDRPA16",44,0)
 ;;668;B;66810475458;66817901533
"RTN","SDRPA16",45,0)
 ;;668;ER;350;2153,
"RTN","SDRPA16",46,0)
 ;;668;B;66810488617;66817919364
"RTN","SDRPA16",47,0)
 ;;668;ER;350;4754,
"RTN","SDRPA16",48,0)
 ;;668;B;66810488785;66817919561
"RTN","SDRPA16",49,0)
 ;;668;ER;350;2140,
"RTN","SDRPA16",50,0)
671 ;;
"RTN","SDRPA16",51,0)
 ;;671;B;67132981217;67159117106
"RTN","SDRPA16",52,0)
 ;;671;ER;350;833,2035,3868,
"RTN","SDRPA16",53,0)
 ;;671;B;67132987909;67159125467
"RTN","SDRPA16",54,0)
 ;;671;ER;350;4073,
"RTN","SDRPA16",55,0)
 ;;671;B;67133036913;67159200628
"RTN","SDRPA16",56,0)
 ;;671;ER;350;643,1237,
"RTN","SDRPA16",57,0)
 ;;671;B;67133041690;67159206920
"RTN","SDRPA16",58,0)
 ;;671;ER;350;4773,
"RTN","SDRPA16",59,0)
 ;;671;B;67133042133;67159207528
"RTN","SDRPA16",60,0)
 ;;671;ER;350;3832,
"RTN","SDRPA16",61,0)
 ;;671;B;67133045694;67159211695
"RTN","SDRPA16",62,0)
 ;;671;ER;350;2299,
"RTN","SDRPA16",63,0)
 ;;671;B;67133046570;67159212323
"RTN","SDRPA16",64,0)
 ;;671;ER;350;4381,
"RTN","SDRPA16",65,0)
 ;;671;B;67133047309;67159213658
"RTN","SDRPA16",66,0)
 ;;671;ER;350;3620,
"RTN","SDRPA16",67,0)
 ;;671;B;67133048613;67159215258
"RTN","SDRPA16",68,0)
 ;;671;ER;350;1902,
"RTN","SDRPA16",69,0)
 ;;671;B;67133050070;67159216787
"RTN","SDRPA16",70,0)
 ;;671;ER;350;1954,
"RTN","SDRPA16",71,0)
 ;;671;B;67133050455;67159217438
"RTN","SDRPA16",72,0)
 ;;671;ER;350;4661,
"RTN","SDRPA16",73,0)
 ;;671;B;67133058683;67159227958
"RTN","SDRPA16",74,0)
 ;;671;ER;350;3228,
"RTN","SDRPA16",75,0)
 ;;671;B;67133098028;67159287146
"RTN","SDRPA16",76,0)
 ;;671;ER;400;4927,4928,4929,4930,4931,
"RTN","SDRPA16",77,0)
 ;;671;B;67133111103;67159303091
"RTN","SDRPA16",78,0)
 ;;671;ER;350;2048,
"RTN","SDRPA16",79,0)
 ;;671;B;67133133529;67159334455
"RTN","SDRPA16",80,0)
 ;;671;ER;200;301,
"RTN","SDRPA16",81,0)
 ;;671;B;67133137194;67159341590
"RTN","SDRPA16",82,0)
 ;;671;ER;200;2161,
"RTN","SDRPA16",83,0)
 ;;671;B;67133141268;67159347813
"RTN","SDRPA16",84,0)
 ;;671;ER;200;3057,3865,
"RTN","SDRPA16",85,0)
 ;;671;B;67133213967;67159469557
"RTN","SDRPA16",86,0)
 ;;671;ER;200;3679,
"RTN","SDRPA16",87,0)
 ;;671;ER;350;224,611,3475,4651,
"RTN","SDRPA16",88,0)
672 ;;
"RTN","SDRPA16",89,0)
 ;;672;B;67229599250;67247153270
"RTN","SDRPA16",90,0)
 ;;672;ER;350;991,
"RTN","SDRPA16",91,0)
 ;;672;B;67229626113;67247191361
"RTN","SDRPA16",92,0)
 ;;672;ER;350;1503,
"RTN","SDRPA16",93,0)
 ;;672;B;67229626569;67247192113
"RTN","SDRPA16",94,0)
 ;;672;ER;350;2080,
"RTN","SDRPA16",95,0)
 ;;672;B;67229627431;67247194800
"RTN","SDRPA16",96,0)
 ;;672;ER;350;3597,
"RTN","SDRPA16",97,0)
 ;;672;B;67229629617;67247197857
"RTN","SDRPA16",98,0)
 ;;672;ER;350;135,
"RTN","SDRPA16",99,0)
 ;;672;B;67229641291;67247214235
"RTN","SDRPA16",100,0)
 ;;672;ER;350;2778,
"RTN","SDRPA16",101,0)
 ;;672;B;67229652973;67247229333
"RTN","SDRPA16",102,0)
 ;;672;ER;350;4323,
"RTN","SDRPA16",103,0)
 ;;672;B;67229690512;67247282637
"RTN","SDRPA16",104,0)
 ;;672;ER;400;4959,
"RTN","SDRPA16",105,0)
673 ;;
"RTN","SDRPA16",106,0)
 ;;673;B;67356533673;67315769886
"RTN","SDRPA16",107,0)
 ;;673;ER;350;4512,
"RTN","SDRPA16",108,0)
 ;;673;B;67356593151;67315849807
"RTN","SDRPA16",109,0)
 ;;673;ER;350;2927,
"RTN","SDRPA16",110,0)
 ;;673;B;67356619775;67315884695
"RTN","SDRPA16",111,0)
 ;;673;ER;350;3404,
"RTN","SDRPA16",112,0)
 ;;673;B;67356621574;67315887362
"RTN","SDRPA16",113,0)
 ;;673;ER;350;862,
"RTN","SDRPA16",114,0)
678 ;;
"RTN","SDRPA16",115,0)
 ;;678;B;6784062356;67841327096
"RTN","SDRPA16",116,0)
 ;;678;ER;350;2133,
"RTN","SDRPA16",117,0)
 ;;678;B;6784064606;67841330669
"RTN","SDRPA16",118,0)
 ;;678;ER;350;2680,
"RTN","SDRPA16",119,0)
688 ;;
"RTN","SDRPA16",120,0)
 ;;688;B;68830770661;68845659219
"RTN","SDRPA16",121,0)
 ;;688;ER;350;3609,
"RTN","SDRPA16",122,0)
 ;;688;B;68830785983;68845682134
"RTN","SDRPA16",123,0)
 ;;688;ER;400;238,
"RTN","SDRPA16",124,0)
 ;;688;B;68830816605;68845723675
"RTN","SDRPA16",125,0)
 ;;688;ER;400;527,
"RTN","SDRPA16",126,0)
689 ;;
"RTN","SDRPA16",127,0)
 ;;689;B;68926206064;68946706330
"RTN","SDRPA16",128,0)
 ;;689;ER;350;3394,
"RTN","SDRPA16",129,0)
 ;;689;B;68926226721;68946729321
"RTN","SDRPA16",130,0)
 ;;689;ER;350;1414,
"RTN","SDRPA16",131,0)
 ;;689;B;68926228196;68946731460
"RTN","SDRPA16",132,0)
 ;;689;ER;350;687,
"RTN","SDRPA16",133,0)
 ;;689;B;68926229578;68946732672
"RTN","SDRPA16",134,0)
 ;;689;ER;350;3689,
"RTN","SDRPA16",135,0)
 ;;689;B;68926230786;68946733904
"RTN","SDRPA16",136,0)
 ;;689;ER;350;1692,
"RTN","SDRPA16",137,0)
 ;;689;B;68926231927;68946735396
"RTN","SDRPA16",138,0)
 ;;689;ER;350;677,
"RTN","SDRPA16",139,0)
 ;;689;B;68926235812;68946739193
"RTN","SDRPA16",140,0)
 ;;689;ER;350;447,
"RTN","SDRPA16",141,0)
 ;;689;B;68926238671;68946741989
"RTN","SDRPA16",142,0)
 ;;689;ER;350;1617,
"RTN","SDRPA16",143,0)
 ;;689;B;68926240742;68946744272
"RTN","SDRPA16",144,0)
 ;;689;ER;350;1941,
"RTN","SDRPA16",145,0)
691 ;;
"RTN","SDRPA16",146,0)
 ;;691;B;69115467595;69199974034
"RTN","SDRPA16",147,0)
 ;;691;ER;350;3515,
"RTN","SDRPA16",148,0)
 ;;691;B;69115473812;691100057312
"RTN","SDRPA16",149,0)
 ;;691;ER;350;569,791,2239,3291,
"RTN","SDRPA16",150,0)
 ;;691;B;69115473843;691100057730
"RTN","SDRPA16",151,0)
 ;;691;ER;350;3558,
"RTN","SDRPA16",152,0)
 ;;691;B;69115474016;691100059938
"RTN","SDRPA16",153,0)
 ;;691;ER;350;4558,
"RTN","SDRPA16",154,0)
 ;;691;ER;400;1900,
"RTN","SDRPA16",155,0)
 ;;691;B;69115474436;691100065253
"RTN","SDRPA16",156,0)
 ;;691;ER;350;2084,
"RTN","SDRPA16",157,0)
 ;;691;B;69115475068;691100072896
"RTN","SDRPA16",158,0)
 ;;691;ER;350;2292,
"RTN","SDRPA16",159,0)
 ;;691;B;69115475285;691100076254
"RTN","SDRPA16",160,0)
 ;;691;ER;350;2492,
"RTN","SDRPA16",161,0)
 ;;691;B;69115477604;691100106895
"RTN","SDRPA16",162,0)
 ;;691;ER;400;4378,
"RTN","SDRPA16",163,0)
695 ;;
"RTN","SDRPA16",164,0)
 ;;695;B;69547025705;69566977886
"RTN","SDRPA16",165,0)
 ;;695;ER;700;747,
"RTN","SDRPA16",166,0)
 ;;695;B;69547184760;69567085569
"RTN","SDRPA16",167,0)
 ;;695;ER;350;1522,
"RTN","SDRPA16",168,0)
 ;;695;B;69547228336;69567113862
"RTN","SDRPA16",169,0)
 ;;695;ER;350;4578,
"RTN","SDRPA16",170,0)
 ;;695;B;69547301923;69567168441
"RTN","SDRPA16",171,0)
 ;;695;ER;350;3721,
"RTN","SDRPA16",172,0)
 ;;695;B;69547309355;69567175635
"RTN","SDRPA16",173,0)
 ;;695;ER;350;4755,
"RTN","SDRPA16",174,0)
 ;;695;B;69547362795;69567213604
"RTN","SDRPA16",175,0)
 ;;695;ER;350;966,
"RTN","SDRPA16",176,0)
 ;;695;B;69547380956;69567225219
"RTN","SDRPA16",177,0)
 ;;695;ER;350;2566,
"RTN","SDRPA16",178,0)
 ;;695;B;69547650192;69567407656
"RTN","SDRPA16",179,0)
 ;;695;ER;350;4474,
"RTN","SDRPA16",180,0)
756 ;;
"RTN","SDRPA16",181,0)
 ;;756;B;75611363180;75615911397
"RTN","SDRPA16",182,0)
 ;;756;ER;700;2781,
"RTN","SDRPA17")
0^16^B69972812
"RTN","SDRPA17",1,0)
SDRPA17 ;BP-OIFO/ESW - UTILITY ; 10/31/04 6:00pm
"RTN","SDRPA17",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA17",3,0)
EN(ST) ;
"RTN","SDRPA17",4,0)
 N SR,II,STR,SA,STE,GG,SS,SQS,ER,SB,SM,SQ,SBE,SME
"RTN","SDRPA17",5,0)
 F II=1:1 S STR=$P($T(@ST+II),";;",2) Q:STR=""  D
"RTN","SDRPA17",6,0)
 .S SA=$P(STR,";") Q:SA="E"
"RTN","SDRPA17",7,0)
 .S SB=$P(STR,";"),SM=$P(STR,";",2) D
"RTN","SDRPA17",8,0)
 ..F GG=1:1 S STE=$P($T(@ST+II+GG),";;",2) Q:$P(STE,";")'="E"  D
"RTN","SDRPA17",9,0)
 ...S ER=$P(STE,";",2) S SQS=$P(STE,";",3) F SS=1:1 S SQ=$P(SQS,",",SS) Q:SQ=""  S SBE=ST_SB,SME=ST_SM D PR^SD376P(SBE,SME,ER,SQ)
"RTN","SDRPA17",10,0)
 ..S ER="" S SQ=$O(^SDWL(409.6,"AMSG",SM,"")) Q:SQ=""  D PR^SD376P(SB,SM,ER,SQ)
"RTN","SDRPA17",11,0)
 Q
"RTN","SDRPA17",12,0)
 ;batch;ms
"RTN","SDRPA17",13,0)
 ;E;ere cd;seq1,seq2,
"RTN","SDRPA17",14,0)
674 ;;
"RTN","SDRPA17",15,0)
 ;;25217915;48941214
"RTN","SDRPA17",16,0)
 ;;E;350;2192,
"RTN","SDRPA17",17,0)
 ;;25277627;49053629
"RTN","SDRPA17",18,0)
 ;;E;200;367,384,475,521,1190,1271,1318,1708,1710,1759,1961,2038,2093,2729,3126,3440,3688,3736,3793,3817,3856,
"RTN","SDRPA17",19,0)
 ;;25283907;49065301
"RTN","SDRPA17",20,0)
 ;;E;200;378,717,949,2020,2136,2527,2741,3082,3367,3385,3446,3711,3836,4029,4071,4376,4928,
"RTN","SDRPA17",21,0)
 ;;25294638;49080201
"RTN","SDRPA17",22,0)
 ;;E;200;476,747,1433,1455,1637,2486,2524,2594,2622,2646,2727,2887,2912,3222,3241,3344,3519,3787,3889,4121,4413,4894,
"RTN","SDRPA17",23,0)
 ;;25303583;49092494
"RTN","SDRPA17",24,0)
 ;;E;200;502,565,725,726,761,965,1415,1626,1752,1999,2074,2077,2089,2101,2114,2435,2574,3193,3352,3463,3685,3750,3760,3761,3932,4173,4180,
"RTN","SDRPA17",25,0)
 ;;E;200;517,607,778,867,913,944,1224,1309,1476,1481,1668,1922,2155
"RTN","SDRPA17",26,0)
 ;;E;200;517,607,778,867,913,944,1224,1309,1476,1481,1668,1922,2155,2284,2300,2320,2454,2569,2572,2658,2696,2801,2904,2907,2913,2918,2971,2975,2984,
"RTN","SDRPA17",27,0)
 ;;E;200;3002,3017,3067,3108,3171,3240,3411,3479,3601,3625,3796,3808,4057,4218,
"RTN","SDRPA17",28,0)
 ;;25318368;49107676
"RTN","SDRPA17",29,0)
 ;;E;200;609,921,1170,1173,1267,1726,1962,2000,2872,2947,2959,2975,2988,2991,3117,3128,3183,3286,3293,3340,3416,3506,3526,3530,3543,3698,3742,4003,4095,4125,4192,4229,4244,4297,4310,
"RTN","SDRPA17",30,0)
 ;;25325672;49115510
"RTN","SDRPA17",31,0)
 ;;E;200;341,413,417,486,523,769,1069,1184,1232,1302,1313,1418,1490,1599,2392,2404,2566,2675,2737,2993,3011,3251,3295,3523,3584,3747,3962,4352,
"RTN","SDRPA17",32,0)
 ;;25326509;49119268
"RTN","SDRPA17",33,0)
 ;;E;200;192,194,384,502,504,624,662,769,954,1006,1517,1615,1821,2026,2057,2175,2293,2420,2502,2526,2541,2672,2817,2862,3022,3085,3092,3115,3257,3333,3487,3610,3660,3688,3782,3804,3831,3933,3980,4416,4878,4887,
"RTN","SDRPA17",34,0)
 ;;25326945;49119456
"RTN","SDRPA17",35,0)
 ;;E;200;2477,2682,2761,2763,2770,2795,2815,2869,2925,3278,3283,3330,3334,3507,3519,3701,3966,4005,4293,4367,4372,4380,4384,
"RTN","SDRPA17",36,0)
 ;;25327195;49120057
"RTN","SDRPA17",37,0)
 ;;E;200;564,703,1024,1803,1852,2144,2165,2693,2707,3077,3104,3500,3837,4281,4415,4563,
"RTN","SDRPA17",38,0)
 ;;E;350;1512,
"RTN","SDRPA17",39,0)
 ;;25327503;49120443
"RTN","SDRPA17",40,0)
 ;;E;200;22,561,1122,1927,2297,2353,2471,2534,2652,2832,2919,2920,4120,4323,4561,4881,
"RTN","SDRPA17",41,0)
 ;;25328054;49120936
"RTN","SDRPA17",42,0)
 ;;E;200;519,670,817,1501,2433,2926,3111,4358,
"RTN","SDRPA17",43,0)
 ;;25328395;49121277
"RTN","SDRPA17",44,0)
 ;;E;200;246,654,1379,1960,2090,2355,2601,2608,3171,3690,3716,3730,
"RTN","SDRPA17",45,0)
 ;;25328504;49125090
"RTN","SDRPA17",46,0)
 ;;E;200;400,460,1006,1032,2128,2613,2795,3098,3439,3892,4502,4662,
"RTN","SDRPA17",47,0)
 ;;25328711;49130992
"RTN","SDRPA17",48,0)
 ;;E;200;1355,1609,1653,1863,1887,2179,2420,2445,2463,2681,2927,4059,4409,4497,
"RTN","SDRPA17",49,0)
 ;;25331266;49133070
"RTN","SDRPA17",50,0)
 ;;E;200;407,570,1342,2418,2634,3503,3933,4091,4356,4667,4961,
"RTN","SDRPA17",51,0)
 ;;25334891;49135124
"RTN","SDRPA17",52,0)
 ;;E;200;1024,2445,3476,
"RTN","SDRPA17",53,0)
 ;;25341571;49141053
"RTN","SDRPA17",54,0)
 ;;E;200;1404,2995,4559,
"RTN","SDRPA17",55,0)
 ;;25350367;49150046
"RTN","SDRPA17",56,0)
 ;;E;200;2172,2190,2288,2913,3303,3416,3418,4523,
"RTN","SDRPA17",57,0)
 ;;25359268;49158911
"RTN","SDRPA17",58,0)
 ;;E;200;1527,2338,2384,2412,3269,3318,3375,3758,4970,
"RTN","SDRPA17",59,0)
 ;;25374264;49172416
"RTN","SDRPA17",60,0)
 ;;E;200;385,1172,1195,2012,2229,2553,2706,2850,3356,3358,3486,3740,
"RTN","SDRPA17",61,0)
 ;;E;200;358,2303,3529,3676,3764,3878,4271,4295,4743,
"RTN","SDRPA17",62,0)
 ;;E;200;358,2303,3529,3676,3764,3878,4271,4295,4743,
"RTN","SDRPA17",63,0)
 ;;25394823;49196200
"RTN","SDRPA17",64,0)
 ;;E;200;2387,3542,3543,3544,3578,3954,4012,4953,
"RTN","SDRPA17",65,0)
 ;;25395743;49198142
"RTN","SDRPA17",66,0)
 ;;E;200;402,1723,1724,2526,2592,4947,
"RTN","SDRPA17",67,0)
 ;;25396049;49199202
"RTN","SDRPA17",68,0)
 ;;E;200;736,1095,1305,1812,2190,2245,2557,2720,2821,2939,3037,3088,3274,3388,3500,3551,4086,4542,
"RTN","SDRPA17",69,0)
 ;;25397679;49200650
"RTN","SDRPA17",70,0)
 ;;E;200;295,868,1329,1918,2102,2206,2222,2351,2403,2529,2551,2556,2632,2807,2972,3235,3553,3742,3782,3878,
"RTN","SDRPA17",71,0)
 ;;25397799;49201471
"RTN","SDRPA17",72,0)
 ;;E;200;203,1110,1554,2324,2334,2355,2623,3662,4231,4427,
"RTN","SDRPA17",73,0)
 ;;25399817;49202495
"RTN","SDRPA17",74,0)
 ;;E;200;815,1046,1799,2175,2346,3786,3838,4055,
"RTN","SDRPA17",75,0)
 ;;25400603;49204834
"RTN","SDRPA17",76,0)
 ;;E;200;1023,1204,1428,2303,2873,2898,3199,3259,3615,4437,4905,
"RTN","SDRPA17",77,0)
 ;;25401313;49205730
"RTN","SDRPA17",78,0)
 ;;E;200;285,976,3091,3706,
"RTN","SDRPA17",79,0)
 ;;E;350;702,
"RTN","SDRPA17",80,0)
 ;;25402604;49207029
"RTN","SDRPA17",81,0)
 ;;E;200;1606,2163,2967,3121,3199,3274,3843,
"RTN","SDRPA17",82,0)
 ;;25404729;49209854
"RTN","SDRPA17",83,0)
 ;;E;200;1656,4942,
"RTN","SDRPA17",84,0)
 ;;25407371;49213437
"RTN","SDRPA17",85,0)
 ;;E;200;645,911,1420,1422,1424,3406,3522,
"RTN","SDRPA17",86,0)
 ;;25409997;49217489
"RTN","SDRPA17",87,0)
 ;;E;200;1299,4549,4943,4954,4959,
"RTN","SDRPA17",88,0)
 ;;25412615;49221198
"RTN","SDRPA17",89,0)
 ;;E;200;1244,1460,1542,2094,2180,2626,2658,3149,3160,3806,4220,4297,4811,
"RTN","SDRPA17",90,0)
 ;;25414954;49224644
"RTN","SDRPA17",91,0)
 ;;E;200;1119,1358,1641,1725,3899,4105,4983,
"RTN","SDRPA17",92,0)
 ;;25416867;49227691
"RTN","SDRPA17",93,0)
 ;;E;200;249,985,2098,2162,2229,2678,3224,4156,4216,
"RTN","SDRPA17",94,0)
 ;;25418438;49230058
"RTN","SDRPA17",95,0)
 ;;E;200;2151,2659,2865,
"RTN","SDRPA17",96,0)
 ;;25419453;49232241
"RTN","SDRPA17",97,0)
 ;;E;200;2858,3711,3720,
"RTN","SDRPA17",98,0)
 ;;25420309;49233464
"RTN","SDRPA17",99,0)
 ;;E;200;2041,2857,3629,3634,3670,4869,
"RTN","SDRPA17",100,0)
 ;;25421225;49234819
"RTN","SDRPA17",101,0)
 ;;E;200;2462,2577,2603,2910,3491,3512,
"RTN","SDRPA17",102,0)
 ;;25422730;49236705
"RTN","SDRPA17",103,0)
 ;;E;200;202,755,1802,2196,3016,3360,3899,3934,4457,
"RTN","SDRPA17",104,0)
 ;;25424211;49238806
"RTN","SDRPA17",105,0)
 ;;E;200;823,865,1449,2497,3544,3555,
"RTN","SDRPA17",106,0)
 ;;25425867;49240848
"RTN","SDRPA17",107,0)
 ;;E;200;457,661,1056,2314,2882,2954,3500,3538,3655,3865,
"RTN","SDRPA17",108,0)
 ;;25427378;49243258
"RTN","SDRPA17",109,0)
 ;;E;200;1158,1268,2363,2922,3089,3730,3952,4046,4087,4346,4975,
"RTN","SDRPA17",110,0)
 ;;25429538;49245769
"RTN","SDRPA17",111,0)
 ;;E;200;228,342,1041,1289,1324,1825,1870,1962,2329,2590,2646,2785,3217,3386,3455,3897,4154,
"RTN","SDRPA17",112,0)
 ;;E;350;2364,
"RTN","SDRPA17",113,0)
 ;;25434564;49249773
"RTN","SDRPA17",114,0)
 ;;E;200;228,261,905,1351,1997,2766,2847,2850,2956,2995,3816,4163,4448,4583,4615,
"RTN","SDRPA17",115,0)
 ;;25443721;49264947
"RTN","SDRPA17",116,0)
 ;;E;200;267,357,707,1165,2431,3759,3843,
"RTN","SDRPA17",117,0)
 ;;25452444;49279635
"RTN","SDRPA17",118,0)
 ;;E;200;580,623,1059,1547,2403,2666,2896,3019,4405,4496,
"RTN","SDRPA17",119,0)
 ;;25461201;49294789
"RTN","SDRPA17",120,0)
 ;;E;200;23,1175,2026,2202,2215,3245,4533,
"RTN","SDRPA17",121,0)
 ;;25468737;49310022
"RTN","SDRPA17",122,0)
 ;;E;200;189,1515,2342,2656,
"RTN","SDRPA17",123,0)
 ;;25468907;49314903
"RTN","SDRPA17",124,0)
 ;;E;200;112,1062,1063,1064,1367,1854,2327,2608,2884,2974,4032,4354,
"RTN","SDRPA17",125,0)
 ;;E;200;357,1869,1880,2391,4181,4404,
"RTN","SDRPA17",126,0)
 ;;E;200;357,1869,1880,2391,4181,4404,
"RTN","SDRPA17",127,0)
 ;;25469461;49315572
"RTN","SDRPA17",128,0)
 ;;E;200;1446,1616,1786,2413,2704,2975,3527,3602,4202,
"RTN","SDRPA17",129,0)
 ;;25469691;49315992
"RTN","SDRPA17",130,0)
 ;;E;200;2906,3213,3256,4417,
"RTN","SDRPA17",131,0)
 ;;25470125;49316720
"RTN","SDRPA17",132,0)
 ;;E;200;34,1321,3175,
"RTN","SDRPA17",133,0)
 ;;E;350;899,
"RTN","SDRPA17",134,0)
 ;;25471835;49318630
"RTN","SDRPA17",135,0)
 ;;E;200;439,1527,3394,
"RTN","SDRPA17",136,0)
 ;;25472066;49319452
"RTN","SDRPA17",137,0)
 ;;E;200;2996,3225,3439,3795,3897,4314,
"RTN","SDRPA17",138,0)
 ;;25472460;49319895
"RTN","SDRPA17",139,0)
 ;;E;200;2911,3944,3952,4075,4317,
"RTN","SDRPA17",140,0)
 ;;25473511;49320217
"RTN","SDRPA17",141,0)
 ;;E;200;1508,1551,2981,
"RTN","SDRPA17",142,0)
 ;;25476116;49323337
"RTN","SDRPA17",143,0)
 ;;E;200;1528,3138,3806,4295,4977,
"RTN","SDRPA17",144,0)
 ;;25480593;49326190
"RTN","SDRPA17",145,0)
 ;;E;200;746,1134,1692,2836,3127,
"RTN","SDRPA17",146,0)
 ;;25485809;49330202
"RTN","SDRPA17",147,0)
 ;;E;200;1324,3437,3734,3825,
"RTN","SDRPA17",148,0)
 ;;25492908;49339053
"RTN","SDRPA17",149,0)
 ;;E;200;357,1504,2342,2678,2823,3040,3729,3975,4190,4891,4960,
"RTN","SDRPA17",150,0)
 ;;25500445;49351142
"RTN","SDRPA17",151,0)
 ;;E;200;411,1133,1249,1277,1956,2351,2426,2479,2736,2898,4798,
"RTN","SDRPA17",152,0)
 ;;25505015;49362568
"RTN","SDRPA17",153,0)
 ;;E;200;266,843,1599,2231,2269,2944,3387,3554,3560,3760,
"RTN","SDRPA17",154,0)
 ;;25505257;49362915
"RTN","SDRPA17",155,0)
 ;;E;200;2928,3338,4208,4590,4996,
"RTN","SDRPA17",156,0)
 ;;25505404;49363170
"RTN","SDRPA17",157,0)
 ;;E;200;261,1464,2449,2536,4973,
"RTN","SDRPA17",158,0)
 ;;25505757;49363649
"RTN","SDRPA17",159,0)
 ;;E;200;1667,3542,3877,4368,4650,4940,
"RTN","SDRPA17",160,0)
 ;;25505949;49363966
"RTN","SDRPA17",161,0)
 ;;E;200;2656,3482,3861,4027,4453,
"RTN","SDRPA17",162,0)
 ;;25506011;49364101
"RTN","SDRPA17",163,0)
 ;;E;200;839,1178,2616,3213,3603,3954,
"RTN","SDRPA17",164,0)
 ;;25506117;49364326
"RTN","SDRPA17",165,0)
 ;;E;200;1169,2100,3391,4860,
"RTN","SDRPA17",166,0)
 ;;25506465;49365020
"RTN","SDRPA17",167,0)
 ;;E;200;326,477,1416,1990,4320,
"RTN","SDRPA17",168,0)
 ;;25507536;49365318
"RTN","SDRPA17",169,0)
 ;;E;200;813,1430,2867,3164,4528,
"RTN","SDRPA17",170,0)
 ;;25516134;49372625
"RTN","SDRPA17",171,0)
 ;;E;200;982,1734,2632,3932,4626,
"RTN","SDRPA17",172,0)
 ;;25520238;49377650
"RTN","SDRPA17",173,0)
 ;;E;200;647,1939,2004,2972,3866,4211,
"RTN","SDRPA17",174,0)
 ;;25531241;49394904
"RTN","SDRPA17",175,0)
 ;;E;200;288,1031,2160,2319,3980,4043,4097,
"RTN","SDRPA17",176,0)
 ;;25541170;49411587
"RTN","SDRPA17",177,0)
 ;;E;200;1675,1856,2193,2250,2546,2838,3127,3323,3727,3739,3831,3894,3903,4050,
"RTN","SDRPA17",178,0)
 ;;25548018;49425352
"RTN","SDRPA17",179,0)
 ;;E;200;8,907,938,1218,2342,2699,3474,3564,3632,4247,
"RTN","SDRPA17",180,0)
 ;;25555062;49438387
"RTN","SDRPA17",181,0)
 ;;E;200;511,1784,2369,3049,3067,3128,3318,3445,3769,4436,4633,
"RTN","SDRPA17",182,0)
 ;;25561820;49452155
"RTN","SDRPA17",183,0)
 ;;E;200;270,1223,1278,1466,1948,2055,2860,3127,3139,3226,3328,4020,4823,
"RTN","SDRPA17",184,0)
 ;;25567090;49463144
"RTN","SDRPA17",185,0)
 ;;E;200;1606,4213,
"RTN","SDRPA17",186,0)
 ;;25573772;49474801
"RTN","SDRPA17",187,0)
 ;;E;200;478,1756,2888,3180,
"RTN","SDRPA17",188,0)
 ;;25625346;49568812
"RTN","SDRPA17",189,0)
 ;;E;200;198,1650,2029,2330,2346,2462,2531,3096,3774,
"RTN","SDRPA17",190,0)
 ;;25643600;49593770
"RTN","SDRPA17",191,0)
 ;;E;200;1273,2727,2976,4287,
"RTN","SDRPA17",192,0)
 ;;25655016;49610188
"RTN","SDRPA17",193,0)
 ;;E;200;2781,3110,3779,4016,4213,
"RTN","SDRPA17",194,0)
 ;;25666966;49627379
"RTN","SDRPA17",195,0)
 ;;E;200;407,2026,2098,3821,4367,
"RTN","SDRPA17",196,0)
 ;;25679867;49645638
"RTN","SDRPA17",197,0)
 ;;E;200;194,563,576,2504,3237,
"RTN","SDRPA17",198,0)
 ;;25690081;49661769
"RTN","SDRPA17",199,0)
 ;;E;200;2567,3003,4260,
"RTN","SDRPA17",200,0)
 ;;25700586;49678334
"RTN","SDRPA17",201,0)
 ;;E;200;2850,3041,3280,4995,
"RTN","SDRPA17",202,0)
 ;;25710517;49694824
"RTN","SDRPA17",203,0)
 ;;E;200;387,769,837,1882,3110,4737,
"RTN","SDRPA17",204,0)
 ;;25716592;49708375
"RTN","SDRPA17",205,0)
 ;;E;200;719,1123,2018,3161,
"RTN","SDRPA17",206,0)
 ;;25717026;49711576
"RTN","SDRPA17",207,0)
 ;;E;200;1371,3359,
"RTN","SDRPA17",208,0)
 ;;25717197;49711953
"RTN","SDRPA17",209,0)
 ;;E;200;2292,2467,2542,4158,4960,
"RTN","SDRPA17",210,0)
 ;;25718056;49712467
"RTN","SDRPA17",211,0)
 ;;E;200;326,719,934,989,1552,1815,2000,2277,2446,2498,2892,3094,3114,3251,4038,4321,4599,
"RTN","SDRPA17",212,0)
 ;;25719726;49713442
"RTN","SDRPA17",213,0)
 ;;E;200;176,193,1128,1205,1443,1518,1601,1733,2017,2281,2585,3285,3474,3775,3902,3996,4397,4495,4590,4788,
"RTN","SDRPA17",214,0)
 ;;25722959;49717477
"RTN","SDRPA17",215,0)
 ;;E;200;270,499,502,1217,1379,1412,1660,1846,2204,2705,2726,2792,3009,3256,3511,3712,3865,4507,4548,
"RTN","SDRPA17",216,0)
 ;;25727920;49721425
"RTN","SDRPA17",217,0)
 ;;E;200;463,1576,1852,3433,3590,3637,3663,4130,4218,
"RTN","SDRPA17",218,0)
 ;;25736902;49729062
"RTN","SDRPA17",219,0)
 ;;E;200;859,1049,1689,1819,2346,2699,3582,
"RTN","SDRPA17",220,0)
 ;;25747319;49739528
"RTN","SDRPA17",221,0)
 ;;E;200;764,1868,2243,3196,3254,3385,3602,
"RTN","SDRPA17",222,0)
 ;;25757985;49749729
"RTN","SDRPA17",223,0)
 ;;E;200;1363,1580,3528,3851,4457,4979,
"RTN","SDRPA17",224,0)
 ;;25773129;49765154
"RTN","SDRPA17",225,0)
 ;;E;200;1044,1505,3616,4998,
"RTN","SDRPA17",226,0)
 ;;25783897;49776025
"RTN","SDRPA17",227,0)
 ;;E;200;924,1852,2186,2924,3551,3558,3660,
"RTN","SDRPA17",228,0)
 ;;25796860;49788059
"RTN","SDRPA17",229,0)
 ;;E;200;430,1158,1319,1593,1972,2802,
"RTN","SDRPA17",230,0)
 ;;E;400;4977,4978,
"RTN","SDRPA17",231,0)
 ;;25807730;49801466
"RTN","SDRPA17",232,0)
 ;;E;200;1260,3237,4127,4674,4901,
"RTN","SDRPA17",233,0)
 ;;25815463;49809685
"RTN","SDRPA17",234,0)
 ;;E;200;244,2444,
"RTN","SDRPA17",235,0)
 ;;25823127;49815307
"RTN","SDRPA17",236,0)
 ;;E;200;2151,2161,3514,3584,
"RTN","SDRPA17",237,0)
 ;;25831454;49824154
"RTN","SDRPA17",238,0)
 ;;E;200;2695,3009,3060,3815,4020,4534,4759,
"RTN","SDRPA17",239,0)
 ;;25836868;49830035
"RTN","SDRPA17",240,0)
 ;;E;200;1566,
"RTN","SDRPA17",241,0)
 ;;25843436;49836859
"RTN","SDRPA17",242,0)
 ;;E;200;639,3326,4438,
"RTN","SDRPA17",243,0)
 ;;25849534;49844065
"RTN","SDRPA17",244,0)
 ;;E;200;1503,2259,3123,
"RTN","SDRPA17",245,0)
 ;;25863893;49858904
"RTN","SDRPA17",246,0)
 ;;E;200;597,1251,1856,1974,2099,2754,2789,3140,
"RTN","SDRPA17",247,0)
 ;;25866728;49862842
"RTN","SDRPA17",248,0)
 ;;E;200;811,877,1678,2178,
"RTN","SDRPA17",249,0)
 ;;25869715;49868135
"RTN","SDRPA17",250,0)
 ;;E;200;1015,2935,3181,3285,
"RTN","SDRPA17",251,0)
 ;;25873785;49874214
"RTN","SDRPA17",252,0)
 ;;E;200;2294,2583,2910,3573,3592,
"RTN","SDRPA17",253,0)
 ;;25875986;49877861
"RTN","SDRPA17",254,0)
 ;;E;200;3237,3238,4448,
"RTN","SDRPA17",255,0)
 ;;25878155;49880484
"RTN","SDRPA17",256,0)
 ;;E;200;3693,
"RTN","SDRPA17",257,0)
 ;;25879802;49883628
"RTN","SDRPA17",258,0)
 ;;E;200;969,3433,
"RTN","SDRPA17",259,0)
 ;;25881077;49886044
"RTN","SDRPA17",260,0)
 ;;E;200;2871,
"RTN","SDRPA17",261,0)
 ;;25882473;49887880
"RTN","SDRPA17",262,0)
 ;;E;200;1129,
"RTN","SDRPA17",263,0)
 ;;25884241;49890003
"RTN","SDRPA17",264,0)
 ;;E;200;481,
"RTN","SDRPA18")
0^17^B1553282
"RTN","SDRPA18",1,0)
SDRPA18 ;BP-OIFO/ESW,SWO - UTILITY ; 10/31/04 6:05pm
"RTN","SDRPA18",2,0)
 ;;5.3;Scheduling;**376**;Aug 13, 1993
"RTN","SDRPA18",3,0)
EN ;Check the 1st and 2nd run for missing ACK's
"RTN","SDRPA18",4,0)
 ;BTRAK  :  ien of batch tracking entry
"RTN","SDRPA18",5,0)
 ;V1     :  ien of run
"RTN","SDRPA18",6,0)
 ;ZNODE  :  zero node of batch tracking entry
"RTN","SDRPA18",7,0)
 N BTRAK,DA,DIK,RUN,V1,V2,V3,ZNODE
"RTN","SDRPA18",8,0)
 S V1=0 F  S V1=$O(^SDWL(409.6,V1)) Q:V1'>0  Q:+$G(^SDWL(409.6,V1,0))>3040514  D
"RTN","SDRPA18",9,0)
 . S BTRAK=0 F  S BTRAK=$O(^SDWL(409.6,V1,2,BTRAK)) Q:'BTRAK  D
"RTN","SDRPA18",10,0)
 .. S ZNODE=$G(^SDWL(409.6,V1,2,BTRAK,0)) Q:ZNODE=""
"RTN","SDRPA18",11,0)
 .. I $P(ZNODE,"^",4)=""!($P(ZNODE,"^",5)="") D UPD(V1,BTRAK)
"RTN","SDRPA18",12,0)
 .;check the "AE" xref for this run
"RTN","SDRPA18",13,0)
 .F V2="S","N","R" S V3=0 I $D(^SDWL(409.6,"AE",V2,V1)) F  S V3=$O(^SDWL(409.6,"AE",V2,V1,V3)) Q:'V3  D
"RTN","SDRPA18",14,0)
 .. S DIK="^SDWL(409.6,"_V1_",1," S DA=V3,DA(1)=V1 D ^DIK
"RTN","SDRPA18",15,0)
 Q
"RTN","SDRPA18",16,0)
UPD(V1,V2) ;update the missed ACK as AA
"RTN","SDRPA18",17,0)
 ;V1  :  ien of run
"RTN","SDRPA18",18,0)
 ;V2  :  ien of batch tracking multiple
"RTN","SDRPA18",19,0)
 N DA,DIE,DR
"RTN","SDRPA18",20,0)
 S DA=V2,DA(1)=V1,DIE="^SDWL(409.6,"_V1_",2,"
"RTN","SDRPA18",21,0)
 S DR=".04///"_$$NOW^XLFDT_";.05///AA"
"RTN","SDRPA18",22,0)
 D ^DIE K DIE
"RTN","SDRPA18",23,0)
 Q
"UP",409.6,409.69,-1)
409.6^1
"UP",409.6,409.69,0)
409.69
"VER")
8.0^22
"^DD",409.6,409.69,2,0)
HL7 MESSAGE ID^F^^0;3^K:$L(X)>50!($L(X)<1) X
"^DD",409.6,409.69,2,3)
The HL7 message number.
"^DD",409.6,409.69,2,21,0)
^.001^6^6^3041005^^^^
"^DD",409.6,409.69,2,21,1,0)
This field represents the HL7 message number.  The message number is used in
"^DD",409.6,409.69,2,21,2,0)
conjunction with incoming HL7 acknowledgement messages to identify the 
"^DD",409.6,409.69,2,21,3,0)
original extract message. This message # corresponds to the Message Control 
"^DD",409.6,409.69,2,21,4,0)
ID in MSG segment. Each message # corresponds to a unique batch # and that
"^DD",409.6,409.69,2,21,5,0)
relation is identified in the Batch Tracking multiple  (#3) where it is
"^DD",409.6,409.69,2,21,6,0)
represented as the MESSAGE CONTROL ID field (#.03).
"^DD",409.6,409.69,2,23,0)
^.001^2^2^3041005^^^
"^DD",409.6,409.69,2,23,1,0)
The first three digits represent site number and by dropping it you have
"^DD",409.6,409.69,2,23,2,0)
the Internal Entry Number of the HL7 MESSAGE TEXT file (#772). 
"^DD",409.6,409.69,2,"DT")
3041005
"^DD",409.6,409.69,8,0)
APPOINTMENT TYPE^S^AR:Action Required;NAT:No Action Taken;F:Future;NC:Non Count;I:Inpatient;NCF:Non Count Future;ABK:Auto Rebook;RS:Rescheduled;O:Outpatient;RSN:Rescheduled Non Count;^0;9^Q
"^DD",409.6,409.69,8,3)

"^DD",409.6,409.69,8,21,0)
^.001^2^2^3040921^^
"^DD",409.6,409.69,8,21,1,0)
This field records a descriptive code of the appointment type and it 
"^DD",409.6,409.69,8,21,2,0)
implements the Event Reason as the appointment identifier.
"^DD",409.6,409.69,8,"DT")
3040921
**END**
**END**
