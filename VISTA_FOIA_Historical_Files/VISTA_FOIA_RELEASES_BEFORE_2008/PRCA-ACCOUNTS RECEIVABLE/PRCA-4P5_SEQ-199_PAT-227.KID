Released PRCA*4.5*227 SEQ #199
Extracted from mail message
**KIDS**:PRCA*4.5*227^

**INSTALL NAME**
PRCA*4.5*227
"BLD",5680,0)
PRCA*4.5*227^ACCOUNTS RECEIVABLE^0^3050114^y
"BLD",5680,1,0)
^^1^1^3041228^^
"BLD",5680,1,1,0)
Patch to fix errors caused by bad records.
"BLD",5680,4,0)
^9.64PA^^
"BLD",5680,"ABPKG")
n
"BLD",5680,"KRN",0)
^9.67PA^8989.52^19
"BLD",5680,"KRN",.4,0)
.4
"BLD",5680,"KRN",.401,0)
.401
"BLD",5680,"KRN",.402,0)
.402
"BLD",5680,"KRN",.403,0)
.403
"BLD",5680,"KRN",.5,0)
.5
"BLD",5680,"KRN",.84,0)
.84
"BLD",5680,"KRN",3.6,0)
3.6
"BLD",5680,"KRN",3.8,0)
3.8
"BLD",5680,"KRN",9.2,0)
9.2
"BLD",5680,"KRN",9.8,0)
9.8
"BLD",5680,"KRN",9.8,"NM",0)
^9.68A^9^9
"BLD",5680,"KRN",9.8,"NM",1,0)
RCXVCHK^^0^B2284145
"BLD",5680,"KRN",9.8,"NM",2,0)
RCXVTSK^^0^B36296410
"BLD",5680,"KRN",9.8,"NM",3,0)
RCXVDC1^^0^B13716905
"BLD",5680,"KRN",9.8,"NM",4,0)
RCXVDC2^^0^B3005574
"BLD",5680,"KRN",9.8,"NM",5,0)
RCXVDC3^^0^B16505134
"BLD",5680,"KRN",9.8,"NM",6,0)
RCXVDC4^^0^B7342357
"BLD",5680,"KRN",9.8,"NM",7,0)
RCXVDC5^^0^B2962184
"BLD",5680,"KRN",9.8,"NM",8,0)
RCXVDC6^^0^B4452546
"BLD",5680,"KRN",9.8,"NM",9,0)
RCXVFTV^^0^B8021027
"BLD",5680,"KRN",9.8,"NM","B","RCXVCHK",1)

"BLD",5680,"KRN",9.8,"NM","B","RCXVDC1",3)

"BLD",5680,"KRN",9.8,"NM","B","RCXVDC2",4)

"BLD",5680,"KRN",9.8,"NM","B","RCXVDC3",5)

"BLD",5680,"KRN",9.8,"NM","B","RCXVDC4",6)

"BLD",5680,"KRN",9.8,"NM","B","RCXVDC5",7)

"BLD",5680,"KRN",9.8,"NM","B","RCXVDC6",8)

"BLD",5680,"KRN",9.8,"NM","B","RCXVFTV",9)

"BLD",5680,"KRN",9.8,"NM","B","RCXVTSK",2)

"BLD",5680,"KRN",19,0)
19
"BLD",5680,"KRN",19.1,0)
19.1
"BLD",5680,"KRN",101,0)
101
"BLD",5680,"KRN",409.61,0)
409.61
"BLD",5680,"KRN",771,0)
771
"BLD",5680,"KRN",870,0)
870
"BLD",5680,"KRN",8989.51,0)
8989.51
"BLD",5680,"KRN",8989.52,0)
8989.52
"BLD",5680,"KRN",8994,0)
8994
"BLD",5680,"KRN","B",.4,.4)

"BLD",5680,"KRN","B",.401,.401)

"BLD",5680,"KRN","B",.402,.402)

"BLD",5680,"KRN","B",.403,.403)

"BLD",5680,"KRN","B",.5,.5)

"BLD",5680,"KRN","B",.84,.84)

"BLD",5680,"KRN","B",3.6,3.6)

"BLD",5680,"KRN","B",3.8,3.8)

"BLD",5680,"KRN","B",9.2,9.2)

"BLD",5680,"KRN","B",9.8,9.8)

"BLD",5680,"KRN","B",19,19)

"BLD",5680,"KRN","B",19.1,19.1)

"BLD",5680,"KRN","B",101,101)

"BLD",5680,"KRN","B",409.61,409.61)

"BLD",5680,"KRN","B",771,771)

"BLD",5680,"KRN","B",870,870)

"BLD",5680,"KRN","B",8989.51,8989.51)

"BLD",5680,"KRN","B",8989.52,8989.52)

"BLD",5680,"KRN","B",8994,8994)

"BLD",5680,"QUES",0)
^9.62^^
"BLD",5680,"REQB",0)
^9.611^2^2
"BLD",5680,"REQB",1,0)
PRCA*4.5*201^1
"BLD",5680,"REQB",2,0)
IB*2.0*233^1
"BLD",5680,"REQB","B","IB*2.0*233",2)

"BLD",5680,"REQB","B","PRCA*4.5*201",1)

"MBREQ")
0
"PKG",299,-1)
1^1
"PKG",299,0)
ACCOUNTS RECEIVABLE^PRCA^FMS
"PKG",299,20,0)
^9.402P^1^1
"PKG",299,20,1,0)
2^^PRCAMRG
"PKG",299,20,1,1)

"PKG",299,20,"B",2,1)

"PKG",299,22,0)
^9.49I^1^1
"PKG",299,22,1,0)
4.5^2950913^2951006
"PKG",299,22,1,"PAH",1,0)
227^3050114
"PKG",299,22,1,"PAH",1,1,0)
^^1^1^3050114
"PKG",299,22,1,"PAH",1,1,1,0)
Patch to fix errors caused by bad records.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","RCXVCHK")
0^1^B2284145
"RTN","RCXVCHK",1,0)
RCXVCHK ;DAOU/ALA-Check for bad records ;26-DEC-2004
"RTN","RCXVCHK",2,0)
 ;;4.5;Accounts Receivable;**227**;Mar 20, 1995
"RTN","RCXVCHK",3,0)
 ;
"RTN","RCXVCHK",4,0)
 ;**Program Description**
"RTN","RCXVCHK",5,0)
 ;  This program checks for records in the queue which
"RTN","RCXVCHK",6,0)
 ;  does not have a bill number
"RTN","RCXVCHK",7,0)
 ;
"RTN","RCXVCHK",8,0)
EN ; Entry point
"RTN","RCXVCHK",9,0)
 K ^TMP("RCXVBREC",$J)
"RTN","RCXVCHK",10,0)
 S ^TMP("RCXVBREC",$J,0)=0
"RTN","RCXVCHK",11,0)
 S BTN=0
"RTN","RCXVCHK",12,0)
BT S BTN=$O(^RCXV(BTN)) G EXIT:'BTN
"RTN","RCXVCHK",13,0)
 S BIL=0
"RTN","RCXVCHK",14,0)
BL S BIL=$O(^RCXV(BTN,1,BIL)) G BT:'BIL
"RTN","RCXVCHK",15,0)
 I $P($G(^PRCA(430,BIL,0)),"^",1)="" D
"RTN","RCXVCHK",16,0)
 . NEW CT
"RTN","RCXVCHK",17,0)
 . S CT=$G(^TMP("RCXVBREC",$J,0))+1,^TMP("RCXVBREC",$J,0)=CT
"RTN","RCXVCHK",18,0)
 . S ^TMP("RCXVBREC",$J,CT,0)="Bill IEN: "_BIL_" does not have a Bill Number in File #430."
"RTN","RCXVCHK",19,0)
 . S DA(1)=BTN,DA=BIL
"RTN","RCXVCHK",20,0)
 . S DIK="^RCXV("_DA(1)_",1,"
"RTN","RCXVCHK",21,0)
 . D ^DIK
"RTN","RCXVCHK",22,0)
 . S $P(^RCXV(BTN,0),"^",7)=$P(^RCXV(BTN,0),"^",7)-1
"RTN","RCXVCHK",23,0)
 G BL
"RTN","RCXVCHK",24,0)
 ;
"RTN","RCXVCHK",25,0)
EXIT K BTN,BIL,DA,DIK,RCXMGRP
"RTN","RCXVCHK",26,0)
 Q
"RTN","RCXVCHK",27,0)
 ;
"RTN","RCXVCHK",28,0)
MSG ;  Send mail message about bad record
"RTN","RCXVCHK",29,0)
 I $G(^TMP("RCXVBREC",$J,0))=""!($G(^TMP("RCXVBREC",$J,0))=0) Q
"RTN","RCXVCHK",30,0)
 S RCXMGRP=$$GET1^DIQ(342,"1,",20.02,"E")
"RTN","RCXVCHK",31,0)
 I RCXMGRP="" S RCXMGRP="IRM"
"RTN","RCXVCHK",32,0)
 S RCXMGRP="G."_RCXMGRP
"RTN","RCXVCHK",33,0)
 S XMDUZ="CBO DATA EXTRACT",XMY(RCXMGRP)=""
"RTN","RCXVCHK",34,0)
 S XMSUB="BAD RECORD(S) FOUND"
"RTN","RCXVCHK",35,0)
 S XMTEXT="^TMP(""RCXVBREC"",$J,"
"RTN","RCXVCHK",36,0)
 D ^XMD
"RTN","RCXVCHK",37,0)
 K XMDUN,XMDUZ,XMZ,XMY,XMSUB,XMTEXT
"RTN","RCXVCHK",38,0)
 Q
"RTN","RCXVDC1")
0^3^B13716905
"RTN","RCXVDC1",1,0)
RCXVDC1 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC1",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVDC1",3,0)
 ;
"RTN","RCXVDC1",4,0)
 Q
"RTN","RCXVDC1",5,0)
EN ; Entry Point
"RTN","RCXVDC1",6,0)
 K ^TMP($J)
"RTN","RCXVDC1",7,0)
D430 ; Get #430 data given RCXVBLN 
"RTN","RCXVDC1",8,0)
 N RCXVD,RCXVD1,RCXVD2,RCXVD3,RCXVD4,RCXVP1,RCXVP2
"RTN","RCXVDC1",9,0)
 N RCXVDA,RCXVDB,RCXVDC,RCXVVP1,RCXVVP,RCXVX,RCXVY
"RTN","RCXVDC1",10,0)
 S RCXVD1=$G(^PRCA(430,RCXVBLN,0))
"RTN","RCXVDC1",11,0)
 S RCXVD2=$G(^PRCA(430,RCXVBLN,6))
"RTN","RCXVDC1",12,0)
 S RCXVD3=$G(^PRCA(430,RCXVBLN,7))
"RTN","RCXVDC1",13,0)
 S RCXVD4=$G(^PRCA(430,RCXVBLN,11))
"RTN","RCXVDC1",14,0)
 S RCXVBLNA=$P(RCXVD1,U,1)
"RTN","RCXVDC1",15,0)
 S RCXVBLNB=$P(RCXVBLNA,"-",1)_"-"
"RTN","RCXVDC1",16,0)
 S RCXVDA=RCXVBLNA ; Bill #
"RTN","RCXVDC1",17,0)
 S RCXVP1=$P(RCXVD1,U,2),RCXVP2=""
"RTN","RCXVDC1",18,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430.2,RCXVP1,0)),U,1)
"RTN","RCXVDC1",19,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; Cat (P)
"RTN","RCXVDC1",20,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,3) ; Orig Amt
"RTN","RCXVDC1",21,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,4) ; GL #
"RTN","RCXVDC1",22,0)
 S RCXVP1=$P(RCXVD1,U,8),RCXVP2=""
"RTN","RCXVDC1",23,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430.3,RCXVP1,0)),U,1)
"RTN","RCXVDC1",24,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; Cur Stat (P)
"RTN","RCXVDC1",25,0)
 S RCXVDBN=$$GET1^DIQ(430,RCXVBLN_",",9,"I")
"RTN","RCXVDC1",26,0)
 I RCXVDBN'="" S RCXVDBN=$P($G(^RCD(340,RCXVDBN,0)),U,1) I RCXVDBN="" D
"RTN","RCXVDC1",27,0)
 . NEW CT
"RTN","RCXVDC1",28,0)
 . S CT=$G(^TMP("RCXVBREC",$J,0))+1,^TMP("RCXVBREC",$J,0)=CT
"RTN","RCXVDC1",29,0)
 . S ^TMP("RCXVBREC",$J,CT,0)="Bill # "_$P(^PRCA(430,RCXVBLN,0),"^",1)_" has a bad debtor record."
"RTN","RCXVDC1",30,0)
 I RCXVDBN["DPT",DFN="" S DFN=$P(RCXVDBN,";",1)
"RTN","RCXVDC1",31,0)
 S RCXVVP1=$S(RCXVDBN["DPT":"PATIENT",1:$$GET1^DIQ(430,RCXVBLN_",",9,"E"))
"RTN","RCXVDC1",32,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVVP1 ; Debtor (P)
"RTN","RCXVDC1",33,0)
 S RCXVDT=$P(RCXVD1,U,10)
"RTN","RCXVDC1",34,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT Bill Preprd 
"RTN","RCXVDC1",35,0)
 S RCXVY(430,11,1)=$G(^PRCA(430,RCXVBLN,7)) ; Cur Bal - Comp
"RTN","RCXVDC1",36,0)
 S RCXVX=$P(RCXVY(430,11,1),U,1)+$P(RCXVY(430,11,1),U,2)+$P(RCXVY(430,11,1),U,3)+$P(RCXVY(430,11,1),U,4)+$P(RCXVY(430,11,1),U,5) S RCXVX=$J(RCXVX,0,2)
"RTN","RCXVDC1",37,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVX ;  Cur. Bal. - computed
"RTN","RCXVDC1",38,0)
 S RCXVDT=$P(RCXVD1,U,14)
"RTN","RCXVDC1",39,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT Stat Upd
"RTN","RCXVDC1",40,0)
 S RCXVDT=$P($P(RCXVD2,U,21),".",1)
"RTN","RCXVDC1",41,0)
 S RCXVDB=$$HLDATE^HLFNC(RCXVDT) ; DT acct actd
"RTN","RCXVDC1",42,0)
 S RCXVDT=$P(RCXVD2,U,1)
"RTN","RCXVDC1",43,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Letter 1 (DT)
"RTN","RCXVDC1",44,0)
 S RCXVDT=$P(RCXVD2,U,4)
"RTN","RCXVDC1",45,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Ref DT
"RTN","RCXVDC1",46,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD2,U,5) ; RF code
"RTN","RCXVDC1",47,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD2,U,6) ; RF amt
"RTN","RCXVDC1",48,0)
 S RCXVDT=$P(RCXVD2,U,10)
"RTN","RCXVDC1",49,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; RF DT
"RTN","RCXVDC1",50,0)
 S RCXVDT=$P(RCXVD2,U,11)
"RTN","RCXVDC1",51,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Rtrn DT
"RTN","RCXVDC1",52,0)
 S RCXVDT=$P(RCXVD2,U,12)
"RTN","RCXVDC1",53,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; RF DT to COWC
"RTN","RCXVDC1",54,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD2,U,13) ; RF amt to COWC
"RTN","RCXVDC1",55,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD4,U,23) ; RSC
"RTN","RCXVDC1",56,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD3,U,1) ; PRIN BAL
"RTN","RCXVDC1",57,0)
 S RCXVDC=$P(RCXVD3,U,2) ; INT BAL
"RTN","RCXVDC1",58,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,3) ; ADMIN COST BAL
"RTN","RCXVDC1",59,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,7) ; TOT PAID PRINC
"RTN","RCXVDC1",60,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,8) ; TOT PAID INT
"RTN","RCXVDC1",61,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,9) ; TOT PAID ADMIN
"RTN","RCXVDC1",62,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,10) ; TOT PAID MARSHAL FEE
"RTN","RCXVDC1",63,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD4,U,17) ;  FUND
"RTN","RCXVDC1",64,0)
 S RCXVP1=$P(RCXVD4,U,6),RCXVP2=""
"RTN","RCXVDC1",65,0)
 I RCXVP1'="" S RCXVP2=$P($G(^RC(347.3,RCXVP1,0)),U,1)
"RTN","RCXVDC1",66,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; REV SRCE (P)
"RTN","RCXVDC1",67,0)
 S RCXVDT=$$DFP^RCXVUTIL(RCXVBLN)
"RTN","RCXVDC1",68,0)
 S RCXVDC=RCXVDC_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT 1ST PAYMNT
"RTN","RCXVDC1",69,0)
 ; 
"RTN","RCXVDC1",70,0)
 S ^TMP($J,RCXVBLN,"1-430A")=RCXVDA
"RTN","RCXVDC1",71,0)
 S ^TMP($J,RCXVBLN,"1-430B")=RCXVDB
"RTN","RCXVDC1",72,0)
 S ^TMP($J,RCXVBLN,"1-430C")=RCXVDC
"RTN","RCXVDC1",73,0)
 Q
"RTN","RCXVDC1",74,0)
 ;
"RTN","RCXVDC2")
0^4^B3005574
"RTN","RCXVDC2",1,0)
RCXVDC2 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC2",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVDC2",3,0)
 ;
"RTN","RCXVDC2",4,0)
 ; PATIENT FILE (# 2)
"RTN","RCXVDC2",5,0)
 Q
"RTN","RCXVDC2",6,0)
D2 ; 
"RTN","RCXVDC2",7,0)
 NEW RCXVDT,RCXVD,RCXVD1,RCXVPF,RCXVDA,RCXVENR,RCXVPE,RCXVPE1,RCXVCT
"RTN","RCXVDC2",8,0)
 NEW RCXVCTY,RCXVICN,RCXVELG
"RTN","RCXVDC2",9,0)
 S RCXVD=$G(^DPT(DFN,0))
"RTN","RCXVDC2",10,0)
 S RCXVDT=$P(RCXVD,U,3)
"RTN","RCXVDC2",11,0)
 S RCXVDA=$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT of Birth
"RTN","RCXVDC2",12,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,9) ; SSN
"RTN","RCXVDC2",13,0)
 S RCXVICN=$P($G(^DPT(DFN,"MPI")),U,1)
"RTN","RCXVDC2",14,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVICN ; ICN
"RTN","RCXVDC2",15,0)
 S RCXVDA=RCXVDA_RCXVU_$P($$SITE^VASITE(),U,3)_"v"_DFN ; IEN
"RTN","RCXVDC2",16,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,2) ; SEX
"RTN","RCXVDC2",17,0)
 S RCXVD1=$G(^DPT(DFN,.11))
"RTN","RCXVDC2",18,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,6) ; ZIPCODE
"RTN","RCXVDC2",19,0)
 ;
"RTN","RCXVDC2",20,0)
 NEW VAPA,VAERR
"RTN","RCXVDC2",21,0)
 D ADD^VADPT
"RTN","RCXVDC2",22,0)
 S RCXVCTY=$P($G(VAPA(7)),U,2)
"RTN","RCXVDC2",23,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVCTY ; COUNTY
"RTN","RCXVDC2",24,0)
 ;
"RTN","RCXVDC2",25,0)
 S RCXVPE="",RCXVPE1=""
"RTN","RCXVDC2",26,0)
 S RCXVENR=$P($G(^DPT(DFN,"ENR")),U,1)
"RTN","RCXVDC2",27,0)
 I RCXVENR'="" D
"RTN","RCXVDC2",28,0)
 . S RCXVPE=$P($G(^DGEN(27.11,RCXVENR,0)),U,7) ; Enrollment priority
"RTN","RCXVDC2",29,0)
 . S RCXVPE1=$$GET1^DIQ(27.11,RCXVENR_",",.12,"E") ; Enrollment subgroup
"RTN","RCXVDC2",30,0)
 ;
"RTN","RCXVDC2",31,0)
 ;Primary Eligibility Code
"RTN","RCXVDC2",32,0)
 S RCXVELG=$P($G(^DPT(DFN,.36)),U,1)
"RTN","RCXVDC2",33,0)
 I RCXVELG'="" S RCXVELG=$P($G(^DIC(8,RCXVELG,0)),U,1)
"RTN","RCXVDC2",34,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVPE_RCXVU_RCXVPE1_RCXVU_RCXVELG
"RTN","RCXVDC2",35,0)
 S ^TMP($J,RCXVBLN,"2-2A")=RCXVDA
"RTN","RCXVDC2",36,0)
 Q
"RTN","RCXVDC2",37,0)
 ;
"RTN","RCXVDC3")
0^5^B16505134
"RTN","RCXVDC3",1,0)
RCXVDC3 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC3",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVDC3",3,0)
 ;
"RTN","RCXVDC3",4,0)
 ; CLAIMS (# 399)
"RTN","RCXVDC3",5,0)
 Q
"RTN","RCXVDC3",6,0)
D399 ;
"RTN","RCXVDC3",7,0)
 NEW RCXVD,RCXVBC,RCXVDT,RCXVD1,RCXVD2,RCXVD3
"RTN","RCXVDC3",8,0)
 NEW RCXVD4,RCXVD5,RCXVD6,RCXVDA,RCXVDB,RCXVDC
"RTN","RCXVDC3",9,0)
 NEW RCXVP1,RCXVP2,RCXVD0C,RCXVP3,RCXVP4,RCXVCFL
"RTN","RCXVDC3",10,0)
 ;
"RTN","RCXVDC3",11,0)
 I $P(RCXVBLNA,"-",2)="" Q
"RTN","RCXVDC3",12,0)
 S RCXVD0=$O(^DGCR(399,"B",$P(RCXVBLNA,"-",2),""))
"RTN","RCXVDC3",13,0)
 I RCXVD0="" Q
"RTN","RCXVDC3",14,0)
 S RCXVD1=$G(^DGCR(399,RCXVD0,0))
"RTN","RCXVDC3",15,0)
 I $G(DFN)="" S DFN=$P(RCXVD1,U,2)
"RTN","RCXVDC3",16,0)
 S RCXVD2=$G(^DGCR(399,RCXVD0,"S"))
"RTN","RCXVDC3",17,0)
 S RCXVD3=$G(^DGCR(399,RCXVD0,"U"))
"RTN","RCXVDC3",18,0)
 S RCXVDA=$P(RCXVD1,U,1) ; BILL #
"RTN","RCXVDC3",19,0)
 S (RCXVEVDT,RCXVDT)=$P($P(RCXVD1,U,3),".",1)
"RTN","RCXVDC3",20,0)
 ;S RCXVDA=RCXVBLNB_RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; EVNT DT
"RTN","RCXVDC3",21,0)
 S RCXVDA=RCXVBLNA_RCXVU_$P(^DPT(DFN,0),U,9) ; SSN
"RTN","RCXVDC3",22,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; EVNT DT
"RTN","RCXVDC3",23,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,5) ; BILL CLASS
"RTN","RCXVDC3",24,0)
 S RCXVP1=$P(RCXVD1,U,7),RCXVP2=""
"RTN","RCXVDC3",25,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DGCR(399.3,RCXVP1,0)),U,1)
"RTN","RCXVDC3",26,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; RATE TYPE (P) 
"RTN","RCXVDC3",27,0)
 S RCXVP1=$P(RCXVD2,U,11),RCXVP2=""
"RTN","RCXVDC3",28,0)
 I RCXVP1'="" S RCXVP2=$P($G(^VA(200,RCXVP1,2,0)),U,1)_RCXVP1 ; SITE_IEN
"RTN","RCXVDC3",29,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVSITE_RCXVP2 ; Authorizer (P)
"RTN","RCXVDC3",30,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,13) ; Stat 
"RTN","RCXVDC3",31,0)
 S RCXVDT=$P(RCXVD1,U,14)
"RTN","RCXVDC3",32,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Stat DT
"RTN","RCXVDC3",33,0)
 S RCXVP1=$P(RCXVD1,U,22),RCXVP2=""
"RTN","RCXVDC3",34,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DG(40.8,RCXVP1,0)),U,2)
"RTN","RCXVDC3",35,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; Default divison
"RTN","RCXVDC3",36,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,24) ; UB92 Location
"RTN","RCXVDC3",37,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,27) ; Bill Chrg type
"RTN","RCXVDC3",38,0)
 S RCXVDT=$P(RCXVD2,U,10)
"RTN","RCXVDC3",39,0)
 S RCXVDB=$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Auth. DT
"RTN","RCXVDC3",40,0)
 S RCXVDT=$P(RCXVD2,U,12)
"RTN","RCXVDC3",41,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT 1st printd
"RTN","RCXVDC3",42,0)
 S (RCXVP1,RCXVD0C)=$P($G(^DGCR(399,RCXVD0,"M")),U,1),RCXVP2=""
"RTN","RCXVDC3",43,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DIC(36,RCXVP1,0)),U,1)
"RTN","RCXVDC3",44,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2 ; PRIM. INSR (P)
"RTN","RCXVDC3",45,0)
 ;
"RTN","RCXVDC3",46,0)
 ; Type of Plan
"RTN","RCXVDC3",47,0)
 S RCXVP2="",RCXVI=0,RCXVP3="",RCXVP4=""
"RTN","RCXVDC3",48,0)
 F  S RCXVI=$O(^DPT(DFN,.312,RCXVI)) Q:'RCXVI  D
"RTN","RCXVDC3",49,0)
 . I RCXVD0C=$P($G(^DPT(DFN,.312,RCXVI,0)),U,1) D
"RTN","RCXVDC3",50,0)
 .. S RCXVP1=$P($G(^DPT(DFN,.312,RCXVI,0)),U,18),RCXVP2=""
"RTN","RCXVDC3",51,0)
 .. S RCXVP3=$P($G(^DPT(DFN,.312,RCXVI,0)),U,6)
"RTN","RCXVDC3",52,0)
 .. I RCXVP1'="" S RCXVP2=$$GET1^DIQ(355.3,RCXVP1_",",.09,"E")
"RTN","RCXVDC3",53,0)
 .. S RCXVP4=$P($G(^DPT(DFN,.312,RCXVI,1)),U,9)
"RTN","RCXVDC3",54,0)
 .. Q
"RTN","RCXVDC3",55,0)
 . Q
"RTN","RCXVDC3",56,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2_RCXVU_RCXVP3_RCXVU_RCXVP4,RCXVD5="",RCXVD6=""
"RTN","RCXVDC3",57,0)
 ; 
"RTN","RCXVDC3",58,0)
 ; 36, 36.3 ADDRESS/EDI
"RTN","RCXVDC3",59,0)
 I RCXVD0C S RCXVD5=$G(^DIC(36,RCXVD0C,.11))
"RTN","RCXVDC3",60,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,1) ; STRT ADD 1 
"RTN","RCXVDC3",61,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,2) ; STRT ADD 2
"RTN","RCXVDC3",62,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,4) ; CITY
"RTN","RCXVDC3",63,0)
 S RCXVP1=$P(RCXVD5,U,5),RCXVP2=""
"RTN","RCXVDC3",64,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DIC(5,RCXVP1,0)),U,1)
"RTN","RCXVDC3",65,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2 ; STATE (P)
"RTN","RCXVDC3",66,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,6) ; ZIP
"RTN","RCXVDC3",67,0)
 I RCXVD0C'="" S RCXVD6=$G(^DIC(36,RCXVD0C,3))
"RTN","RCXVDC3",68,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD6,U,2) ; EDI - PROF
"RTN","RCXVDC3",69,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD6,U,4) ; EDI - INST
"RTN","RCXVDC3",70,0)
 S RCXVDB=RCXVDB_RCXVU_$$GET1^DIQ(36,RCXVD0C_",",1,"I") ; REIMBURSE?
"RTN","RCXVDC3",71,0)
 ;
"RTN","RCXVDC3",72,0)
 S RCXVPFDT=$P(RCXVD3,U,1)
"RTN","RCXVDC3",73,0)
 S RCXVDC=$$HLDATE^HLFNC(RCXVPFDT) ; STMT COVERS FROM
"RTN","RCXVDC3",74,0)
 S RCXVPTDT=$P(RCXVD3,U,2)
"RTN","RCXVDC3",75,0)
 S RCXVDC=RCXVDC_RCXVU_$$HLDATE^HLFNC(RCXVPTDT) ; STMT COVERS TO
"RTN","RCXVDC3",76,0)
 S RCXVP1=$P(RCXVD3,U,11),RCXVP2=""
"RTN","RCXVDC3",77,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DGCR(399.1,RCXVP1,0)),U,1)
"RTN","RCXVDC3",78,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; DISCH. BED SEC.
"RTN","RCXVDC3",79,0)
 S RCXVD4=$G(^DGCR(399,RCXVD0,"U1"))
"RTN","RCXVDC3",80,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD4,U,1) ; TOT CHRG
"RTN","RCXVDC3",81,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD4,U,2) ; OFFSET AMT
"RTN","RCXVDC3",82,0)
 ;
"RTN","RCXVDC3",83,0)
 S RCXVP1=$P($G(^DGCR(399,RCXVD0,"U2")),U,10),RCXVP2=""
"RTN","RCXVDC3",84,0)
 I RCXVP1'="" S RCXVP2=$P($G(^IBA(355.93,RCXVP1,0)),U,1)
"RTN","RCXVDC3",85,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; NON VA FAC (P)
"RTN","RCXVDC3",86,0)
 ;
"RTN","RCXVDC3",87,0)
 ;  Get VACARE or NONVACARE flag
"RTN","RCXVDC3",88,0)
 NEW RCXVIEN
"RTN","RCXVDC3",89,0)
 D CARE^RCXVUTIL(RCXVD0)
"RTN","RCXVDC3",90,0)
 S RCXVDC=RCXVDC_RCXVU_$S(RCXVCFL=1:"VACARE",1:"NONVACARE")
"RTN","RCXVDC3",91,0)
 S ^TMP($J,RCXVBLN,"3-399A")=RCXVDA
"RTN","RCXVDC3",92,0)
 S ^TMP($J,RCXVBLN,"3-399B")=RCXVDB
"RTN","RCXVDC3",93,0)
 S ^TMP($J,RCXVBLN,"3-399C")=RCXVDC
"RTN","RCXVDC3",94,0)
 Q
"RTN","RCXVDC3",95,0)
 ;
"RTN","RCXVDC4")
0^6^B7342357
"RTN","RCXVDC4",1,0)
RCXVDC4 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC4",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVDC4",3,0)
 ;
"RTN","RCXVDC4",4,0)
 ; Procedures 
"RTN","RCXVDC4",5,0)
 Q
"RTN","RCXVDC4",6,0)
D399PC ;
"RTN","RCXVDC4",7,0)
 I RCXVD0="" Q
"RTN","RCXVDC4",8,0)
 N RCXVD,RCXVAD,RCXVB,RCXVPC,RCXVP1,RCXVP2
"RTN","RCXVDC4",9,0)
 N RCXVDT3,RCXVCP,RCXVPCDT
"RTN","RCXVDC4",10,0)
 ; RCXVPC=PROC. CODE IEN, RCXVCP=CPT CODE IEN
"RTN","RCXVDC4",11,0)
 ; LOOP THRU PROC.
"RTN","RCXVDC4",12,0)
 F RCXVPC=1:1 Q:'$D(^DGCR(399,RCXVD0,"CP",RCXVPC,0))  D D399PCA
"RTN","RCXVDC4",13,0)
 Q
"RTN","RCXVDC4",14,0)
D399PCA ;
"RTN","RCXVDC4",15,0)
 S RCXVD=$G(^DGCR(399,RCXVD0,"CP",RCXVPC,0))
"RTN","RCXVDC4",16,0)
 S RCXVP1=$P(RCXVD,U,1),RCXVVP="",RCXVVP1=""
"RTN","RCXVDC4",17,0)
 I RCXVP1'="" S RCXVVP="^"_$P(RCXVP1,";",2)_$P(RCXVP1,";",1)_",0)"
"RTN","RCXVDC4",18,0)
 I RCXVVP'="" S RCXVVP1=$P($G(@RCXVVP),U,1) I RCXVVP1="" D
"RTN","RCXVDC4",19,0)
 . NEW CT
"RTN","RCXVDC4",20,0)
 . S CT=$G(^TMP("RCXVBREC",$J,0))+1,^TMP("RCXVBREC",$J,0)=CT
"RTN","RCXVDC4",21,0)
 . S ^TMP("RCXVBREC",$J,CT,0)="Bill # "_$P($G(^DGCR(399,RCXVD0,0)),"^",1)_" has a bad CPT code at IEN # "_RCXVPC_" check ^DGCR(399,"_RCXVD0_",""CP"","_RCXVPC_",0)"
"RTN","RCXVDC4",22,0)
 S RCXVDA=RCXVBLNA_RCXVU_RCXVVP1 ; PROC.
"RTN","RCXVDC4",23,0)
 S RCXVDT=$P(RCXVD,U,2)
"RTN","RCXVDC4",24,0)
 S RCXVPCDT=$E($$HLDATE^HLFNC(RCXVDT),1,8)
"RTN","RCXVDC4",25,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVPCDT ; DT 
"RTN","RCXVDC4",26,0)
 S RCXVP1=$P(RCXVD,U,11),RCXVP2=""
"RTN","RCXVDC4",27,0)
 I RCXVP1'="" S RCXVP1=$P($G(^IBA(362.3,RCXVP1,0)),U,1)
"RTN","RCXVDC4",28,0)
 I RCXVP1'="" S RCXVP2=$P($G(^ICD9(RCXVP1,0)),U,1)
"RTN","RCXVDC4",29,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; ASSOC DXN (1)
"RTN","RCXVDC4",30,0)
 S RCXVP1=$P(RCXVD,U,7),RCXVP2=""
"RTN","RCXVDC4",31,0)
 I RCXVP1'="" S RCXVP2=$P($G(^SC(RCXVP1,0)),U,1)
"RTN","RCXVDC4",32,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; ASSC. CLNC (P) 
"RTN","RCXVDC4",33,0)
 S RCXVP1=$P(RCXVD,U,18),RCXVP2=""
"RTN","RCXVDC4",34,0)
 I RCXVP1'="" S RCXVP2=$P($G(^VA(200,RCXVP1,0)),U,1)
"RTN","RCXVDC4",35,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; PRVDR (P)
"RTN","RCXVDC4",36,0)
 S ^TMP($J,RCXVBLN,"4-399A",RCXVPC)=RCXVDA
"RTN","RCXVDC4",37,0)
 ; LOOP THRU CPT
"RTN","RCXVDC4",38,0)
 F RCXVCP=1:1 Q:'($D(^DGCR(399,RCXVD0,"CP",RCXVPC,"MOD",RCXVCP,0)))  D
"RTN","RCXVDC4",39,0)
 . ; ^DGCR(399,D0,CP,D1,MOD,D2,0)= (#.01) CPT MODIFIER SEQUENCE [1N]
"RTN","RCXVDC4",40,0)
 . ; (#.02) CPT ==>MODIFIER [2P:81.3]
"RTN","RCXVDC4",41,0)
 . S RCXVP1=$P($G(^DGCR(399,RCXVD0,"CP",RCXVPC,"MOD",RCXVCP,0)),U,2)
"RTN","RCXVDC4",42,0)
 . I RCXVP1'="" S RCXVP2=$P($G(^DIC(81.3,RCXVP1,0)),U,1)
"RTN","RCXVDC4",43,0)
 . S ^TMP($J,RCXVBLN,"4-399A",RCXVPC,RCXVCP)=RCXVP2
"RTN","RCXVDC4",44,0)
 . Q
"RTN","RCXVDC4",45,0)
D39942 ; CHARGES FROM 399.042
"RTN","RCXVDC4",46,0)
 ; LOOP THRU 399.042
"RTN","RCXVDC4",47,0)
 S RCXVD1=$G(^DGCR(399,RCXVD0,"RC",RCXVPC,0))
"RTN","RCXVDC4",48,0)
 I RCXVD1="" Q
"RTN","RCXVDC4",49,0)
 S RCXVDB=RCXVBLNA_RCXVU_$P(RCXVD1,U,1) ; Revenue Code
"RTN","RCXVDC4",50,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD1,U,6) ; Procedures [P]
"RTN","RCXVDC4",51,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVPCDT ; PROC. DT
"RTN","RCXVDC4",52,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD1,U,2) ; Charges
"RTN","RCXVDC4",53,0)
 S ^TMP($J,RCXVBLN,"4-399B",RCXVPC)=RCXVDB
"RTN","RCXVDC4",54,0)
 Q
"RTN","RCXVDC4",55,0)
 ;
"RTN","RCXVDC5")
0^7^B2962184
"RTN","RCXVDC5",1,0)
RCXVDC5 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC5",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVDC5",3,0)
 ;
"RTN","RCXVDC5",4,0)
 ; Integrated Billing Action File (# 350) 
"RTN","RCXVDC5",5,0)
 Q
"RTN","RCXVDC5",6,0)
D350 ; 
"RTN","RCXVDC5",7,0)
 NEW RCXVD,RCXVDA,RCXVDB,RCXVD0A,RCXVDT,RCXVP1,RCXVP2,RCXVPC,RCT
"RTN","RCXVDC5",8,0)
 S RCXVD0A="",RCT=0
"RTN","RCXVDC5",9,0)
 F  S RCXVD0A=$O(^IB("ABIL",RCXVBLNA,RCXVD0A)) Q:RCXVD0A=""  D
"RTN","RCXVDC5",10,0)
 . S RCXVD=$G(^IB(RCXVD0A,0))
"RTN","RCXVDC5",11,0)
 . I $G(DFN)="" S DFN=$P(RCXVD,U,2)
"RTN","RCXVDC5",12,0)
 . ;
"RTN","RCXVDC5",13,0)
 . S RCXVDA=RCXVBLNA_RCXVU_$P(RCXVD,U,1)
"RTN","RCXVDC5",14,0)
 . S RCXVDA=RCXVDA_RCXVU_$$GET1^DIQ(350,RCXVD0A_",",.05,"E")
"RTN","RCXVDC5",15,0)
 . S RCXVP1=$P(RCXVD,U,3),RCXVP2=""
"RTN","RCXVDC5",16,0)
 . I RCXVP1'="" S RCXVP2=$P($G(^IBE(350.1,RCXVP1,0)),U,1)
"RTN","RCXVDC5",17,0)
 . S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; ACTION TYPE (P)
"RTN","RCXVDC5",18,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,6) ; UNITS
"RTN","RCXVDC5",19,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,7) ; TOTAL CHARGE
"RTN","RCXVDC5",20,0)
 . S RCXVDT=$P(RCXVD,U,14)
"RTN","RCXVDC5",21,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT BILLD FROM
"RTN","RCXVDC5",22,0)
 . S RCXVDT=$P(RCXVD,U,15)
"RTN","RCXVDC5",23,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT BILLD TO
"RTN","RCXVDC5",24,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,11) ; AR BILL #
"RTN","RCXVDC5",25,0)
 . S RCXVDT=$P($P($G(^IB(RCXVD0A,1)),U,2),".",1)
"RTN","RCXVDC5",26,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT ENTRY ADDED
"RTN","RCXVDC5",27,0)
 . S RCXVDA=RCXVDA_RCXVU_$P($G(^DPT(DFN,0)),U,9) ; SSN
"RTN","RCXVDC5",28,0)
 . S RCT=RCT+1
"RTN","RCXVDC5",29,0)
 . S ^TMP($J,RCXVBLN,"5-350A",RCT)=RCXVDA
"RTN","RCXVDC5",30,0)
 Q
"RTN","RCXVDC5",31,0)
 ;
"RTN","RCXVDC6")
0^8^B4452546
"RTN","RCXVDC6",1,0)
RCXVDC6 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC6",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVDC6",3,0)
 ;
"RTN","RCXVDC6",4,0)
 ; Accounts Recv. Trans. File (# 433) 
"RTN","RCXVDC6",5,0)
 Q
"RTN","RCXVDC6",6,0)
D433 ; 
"RTN","RCXVDC6",7,0)
 K ^TMP($J,RCXVBLN,"6-433A")
"RTN","RCXVDC6",8,0)
 ; LOOP THRU(^PRCA(433,"C",RCXVBLN)
"RTN","RCXVDC6",9,0)
 ;
"RTN","RCXVDC6",10,0)
 ;  If the current fiscal year flag is set, must loop for
"RTN","RCXVDC6",11,0)
 ;  all the transactions since the beginning of the fiscal year
"RTN","RCXVDC6",12,0)
 I $G(RCXVCFLG)=1 S RCXVBDT=RCXVFFD
"RTN","RCXVDC6",13,0)
 NEW RCXVD,RCXVDA,RCXVDT,RCXVI,RCXVP1,RCXVP2,RCXVD0B
"RTN","RCXVDC6",14,0)
 S RCXVD0B=""
"RTN","RCXVDC6",15,0)
 F RCXVI=1:1 S RCXVD0B=$O(^PRCA(433,"C",RCXVBLN,RCXVD0B)) Q:RCXVD0B=""  D D433A
"RTN","RCXVDC6",16,0)
 Q
"RTN","RCXVDC6",17,0)
D433A ;
"RTN","RCXVDC6",18,0)
 S RCXVD=$G(^PRCA(433,RCXVD0B,1))
"RTN","RCXVDC6",19,0)
 S RCXVP1=$P($G(^PRCA(433,RCXVD0B,0)),U,2),RCXVP2=""
"RTN","RCXVDC6",20,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430,RCXVP1,0)),U,1)
"RTN","RCXVDC6",21,0)
 S RCXVDA=RCXVP2 ; BILL NUMBER (P) 
"RTN","RCXVDC6",22,0)
 S RCXVDA=RCXVDA_RCXVU_$P($G(^PRCA(433,RCXVD0B,0)),U,1) ; TRANS. #
"RTN","RCXVDC6",23,0)
 S RCXVDT=$P(RCXVD,U,1)
"RTN","RCXVDC6",24,0)
 I RCXVDT<RCXVBDT Q  ;QUIT IF TRANS. IS OLDER THAN BATCH DATE
"RTN","RCXVDC6",25,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; TRANS. DT
"RTN","RCXVDC6",26,0)
 S RCXVP1=$P(RCXVD,U,2),RCXVP2=""
"RTN","RCXVDC6",27,0)
 I RCXVP1'="",+$P($G(^PRCA(430.3,RCXVP1,0)),U,6)=0 Q
"RTN","RCXVDC6",28,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430.3,RCXVP1,0)),U,1)
"RTN","RCXVDC6",29,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; TRANS TYPE (P)
"RTN","RCXVDC6",30,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT ENTRD
"RTN","RCXVDC6",31,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,5) ; TRANS AMT
"RTN","RCXVDC6",32,0)
 S RCXVDA=RCXVDA_RCXVU_$$GET1^DIQ(433,RCXVD0B_",",88,"E") ; CONT. ADJ.
"RTN","RCXVDC6",33,0)
 S ^TMP($J,RCXVBLN,"6-433A",RCXVI)=RCXVDA
"RTN","RCXVDC6",34,0)
 Q
"RTN","RCXVDC6",35,0)
 ;
"RTN","RCXVDC6",36,0)
D433B ;
"RTN","RCXVDC6",37,0)
 NEW RCXVDA,RCXVD0B,RCXVI,RQFL
"RTN","RCXVDC6",38,0)
 S RCXVD0B="",RQFL=0
"RTN","RCXVDC6",39,0)
 F RCXVI=1:1 S RCXVD0B=$O(^PRCA(433,"C",RCXVBLN,RCXVD0B)) Q:RCXVD0B=""  D  Q:RQFL
"RTN","RCXVDC6",40,0)
 . S RCXVDA=$$GET1^DIQ(433,RCXVD0B_",",88,"E") ; Contractual Adj
"RTN","RCXVDC6",41,0)
 . I RCXVDA'="" S $P(^TMP($J,RCXVBLN,"6-433A",1),U,7)=RCXVDA,RQFL=1
"RTN","RCXVDC6",42,0)
 Q
"RTN","RCXVFTV")
0^9^B8021027
"RTN","RCXVFTV",1,0)
RCXVFTV ;DAOU/ALA-FTP for VMS ;08-SEP-03
"RTN","RCXVFTV",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVFTV",3,0)
 ;
"RTN","RCXVFTV",4,0)
 ;
"RTN","RCXVFTV",5,0)
VMSO ;  Outgoing for VMS systems
"RTN","RCXVFTV",6,0)
 ;
"RTN","RCXVFTV",7,0)
 ;  Set up variables
"RTN","RCXVFTV",8,0)
 ;    RCXVFTP = Executable filename
"RTN","RCXVFTV",9,0)
 ;    RCXVPTH = Path name
"RTN","RCXVFTV",10,0)
 ;    RCXVNME = Outgoing filename
"RTN","RCXVFTV",11,0)
 ;    RCXVTXT = .TXT filename
"RTN","RCXVFTV",12,0)
 ;    RCXVBAT = .COM filename
"RTN","RCXVFTV",13,0)
 ;
"RTN","RCXVFTV",14,0)
 D VTXT
"RTN","RCXVFTV",15,0)
 ;
"RTN","RCXVFTV",16,0)
 S Y=$$GTF^%ZISH($NA(^TMP($J,"RCXVFTP",1,0)),3,RCXVPTH,RCXVBAT)
"RTN","RCXVFTV",17,0)
 K ^TMP($J,"RCXVFTP")
"RTN","RCXVFTV",18,0)
 I 'Y S VALMSG="Not able to create the .COM file" Q
"RTN","RCXVFTV",19,0)
 ;
"RTN","RCXVFTV",20,0)
VOBAT ;  Output and create the .COM file
"RTN","RCXVFTV",21,0)
 ;
"RTN","RCXVFTV",22,0)
 ;  Create the executable commands for the .TXT file
"RTN","RCXVFTV",23,0)
 S ^TMP($J,"RCXVFTP",1,0)="SET TYPE ASCII"
"RTN","RCXVFTV",24,0)
 S ^TMP($J,"RCXVFTP",2,0)="PUT "_RCXVNME
"RTN","RCXVFTV",25,0)
 S ^TMP($J,"RCXVFTP",3,0)="EXIT"
"RTN","RCXVFTV",26,0)
 ;
"RTN","RCXVFTV",27,0)
 ;  Output and create the .TXT file
"RTN","RCXVFTV",28,0)
 S Y=$$GTF^%ZISH($NA(^TMP($J,"RCXVFTP",1,0)),3,RCXVPTH,RCXVTXT)
"RTN","RCXVFTV",29,0)
 K ^TMP($J,"RCXVFTP")
"RTN","RCXVFTV",30,0)
 I 'Y S VALMSG="Not able to create the .TXT file" Q
"RTN","RCXVFTV",31,0)
 ;
"RTN","RCXVFTV",32,0)
 X RCXVOUT
"RTN","RCXVFTV",33,0)
 ;
"RTN","RCXVFTV",34,0)
 HANG 60
"RTN","RCXVFTV",35,0)
 ;
"RTN","RCXVFTV",36,0)
 Q
"RTN","RCXVFTV",37,0)
 ;
"RTN","RCXVFTV",38,0)
VTXT ;  Create the .TXT file
"RTN","RCXVFTV",39,0)
 S RCXVFTP="RCXVCBO"
"RTN","RCXVFTV",40,0)
 S RCXVSCR=RCXVSCR_".LIS",^TMP("RCXVMSG",$J,RCXVSCR_";1")=""
"RTN","RCXVFTV",41,0)
 S RCXVBAT=RCXVFTP_$S($G(RCXVSYS)="VMS":".COM",1:".BAT")
"RTN","RCXVFTV",42,0)
 S RCXVTXT=RCXVFTP_".TXT"
"RTN","RCXVFTV",43,0)
 ;
"RTN","RCXVFTV",44,0)
 I RCXVSYT="DSM" S RCXVOUT="S X=$ZC(%SUBMIT,RCXVPTH_$S($E(RCXVPTH,$L(RCXVPTH))[""]"":"""",1:"":"")_RCXVBAT)"
"RTN","RCXVFTV",45,0)
 I RCXVSYT="CACHE" S RCXVOUT="S X=$ZF(-1,""SUBMIT ""_RCXVPTH_$S($E(RCXVPTH,$L(RCXVPTH))[""]"":"""",1:"":"")_RCXVBAT_""/NOLOG_FILE/NOPRINT"")"
"RTN","RCXVFTV",46,0)
 ;
"RTN","RCXVFTV",47,0)
 I $G(RCXVVMS)="" S RCXVVMS="U"
"RTN","RCXVFTV",48,0)
 ;
"RTN","RCXVFTV",49,0)
 ;  Kill off the .COM and .TXT files
"RTN","RCXVFTV",50,0)
 S RCXVARRY(RCXVTXT)="",RCXVARRY(RCXVBAT)=""
"RTN","RCXVFTV",51,0)
 S Y=$$DEL^%ZISH(RCXVPTH,$NA(RCXVARRY))
"RTN","RCXVFTV",52,0)
 K RCXVARRY
"RTN","RCXVFTV",53,0)
 ;
"RTN","RCXVFTV",54,0)
 ;  This sets the .COM file name for VMS systems
"RTN","RCXVFTV",55,0)
 I RCXVSYS="VMS" D
"RTN","RCXVFTV",56,0)
 . S ^TMP($J,"RCXVFTP",1,0)="$SET NOON"
"RTN","RCXVFTV",57,0)
 . S ^TMP($J,"RCXVFTP",2,0)="$SET NOVERIFY"
"RTN","RCXVFTV",58,0)
 . S ^TMP($J,"RCXVFTP",3,0)="$SET DEFAULT "_RCXVPTH
"RTN","RCXVFTV",59,0)
 . S ^TMP($J,"RCXVFTP",4,0)="$DEL "_RCXVSCR_";*"
"RTN","RCXVFTV",60,0)
 . S ^TMP($J,"RCXVFTP",5,0)="$DEF SYS$OUTPUT "_RCXVSCR
"RTN","RCXVFTV",61,0)
 . I RCXVVMS="M" S ^TMP($J,"RCXVFTP",6,0)="FTP /TAKE_FILE="_RCXVTXT
"RTN","RCXVFTV",62,0)
 . I RCXVVMS="U" S ^TMP($J,"RCXVFTP",6,0)="FTP "_RCXVIP_" /USERNAME="""_RCXVUSR_""" /PASSWORD="""_RCXVPAS_""" /INPUT="_RCXVTXT
"RTN","RCXVFTV",63,0)
 . S ^TMP($J,"RCXVFTP",7,0)="$DEASSIGN SYS$OUTPUT"
"RTN","RCXVFTV",64,0)
 . S ^TMP($J,"RCXVFTP",8,0)="$SET FILE/PROTECTION=(S:RWED,O:RWED,G:RWED,W:RWED) "_RCXVSCR
"RTN","RCXVFTV",65,0)
 ;
"RTN","RCXVFTV",66,0)
 Q
"RTN","RCXVTSK")
0^2^B36296410
"RTN","RCXVTSK",1,0)
RCXVTSK ;DAOU/ALA-AR Data Extract Nightly Task ;23-JUL-03
"RTN","RCXVTSK",2,0)
 ;;4.5;Accounts Receivable;**201,227**;Mar 20, 1995
"RTN","RCXVTSK",3,0)
 ;
"RTN","RCXVTSK",4,0)
 ;** Program Description **
"RTN","RCXVTSK",5,0)
 ;  This program is the nightly task program for the
"RTN","RCXVTSK",6,0)
 ;  CBO Data Extract to the Boston Allocation Resource
"RTN","RCXVTSK",7,0)
 ;  Center
"RTN","RCXVTSK",8,0)
 ;
"RTN","RCXVTSK",9,0)
EN ;  Entry point
"RTN","RCXVTSK",10,0)
 ;
"RTN","RCXVTSK",11,0)
 ;  If a test system has 'turned off' extract, quit
"RTN","RCXVTSK",12,0)
 I '$$GET1^DIQ(342,"1,",20.04,"I") Q
"RTN","RCXVTSK",13,0)
 ;
"RTN","RCXVTSK",14,0)
 N $ES,$ET
"RTN","RCXVTSK",15,0)
 S $ET="D ER^RCXVTSK"
"RTN","RCXVTSK",16,0)
 ;
"RTN","RCXVTSK",17,0)
 L +^RCXVTSK:60 E  Q
"RTN","RCXVTSK",18,0)
 ;
"RTN","RCXVTSK",19,0)
 ;  Purge completed batches
"RTN","RCXVTSK",20,0)
 S IEN="",DIK="^RCXV("
"RTN","RCXVTSK",21,0)
 F  S IEN=$O(^RCXV("AC","C",IEN)) Q:IEN=""  D
"RTN","RCXVTSK",22,0)
 . S DA=IEN D ^DIK
"RTN","RCXVTSK",23,0)
 ;
"RTN","RCXVTSK",24,0)
 K ^TMP("RCXVMSG",$J)
"RTN","RCXVTSK",25,0)
 ;
"RTN","RCXVTSK",26,0)
 ;  Find all deposits/receipts
"RTN","RCXVTSK",27,0)
 S RCXVD0="",RCXVRNUM=0,RCXVDT=$$FMADD^XLFDT(DT,-1)
"RTN","RCXVTSK",28,0)
 F  S RCXVD0=$O(^RCY(344,"ASTAT",0,RCXVD0)) Q:RCXVD0=""  D
"RTN","RCXVTSK",29,0)
 . S RCXVEDT=$P($G(^RCY(344,RCXVD0,0)),U,12)\1
"RTN","RCXVTSK",30,0)
 . I RCXVEDT'=RCXVDT Q
"RTN","RCXVTSK",31,0)
 . S RCXVRNUM=RCXVRNUM+1
"RTN","RCXVTSK",32,0)
 . D FIL^RCXVDEQ("R")
"RTN","RCXVTSK",33,0)
 . D UDR^RCXVDEQ
"RTN","RCXVTSK",34,0)
 ;
"RTN","RCXVTSK",35,0)
 K RCXVD0,RCXVRNUM,RCXVDT,RCXVEDT,RCXVDA,RCVXCTY,RCXVBDT
"RTN","RCXVTSK",36,0)
 ;
"RTN","RCXVTSK",37,0)
 S RCXVBTN="",RCXVU="^",RCXVXDT=DT
"RTN","RCXVTSK",38,0)
 ;
"RTN","RCXVTSK",39,0)
 ;  If the CCPC calculation is scheduled to run, don't
"RTN","RCXVTSK",40,0)
 ;  run the nightly task
"RTN","RCXVTSK",41,0)
 S X1=$$STD^RCCPCFN,X2=-3 D C^%DTC I X=DT L -^RCXVTSK K X Q
"RTN","RCXVTSK",42,0)
 K X1,X2
"RTN","RCXVTSK",43,0)
 ;
"RTN","RCXVTSK",44,0)
NM ;  Find all new batches to be transmitted
"RTN","RCXVTSK",45,0)
 S RBSQ=0,RBTOT=0
"RTN","RCXVTSK",46,0)
 F  S RCXVBTN=$O(^RCXV("AC","P",RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",47,0)
 . I $G(^RCXV(RCXVBTN,0))="" Q
"RTN","RCXVTSK",48,0)
 . S RBSQ=RBSQ+1,RBTOT=RBTOT+1
"RTN","RCXVTSK",49,0)
 . I $P(^RCXV(RCXVBTN,0),U,1)'=RCXVBTN S RCXVUP(348.4,RCXVBTN_",",.01)=RCXVBTN
"RTN","RCXVTSK",50,0)
 . S RCXVUP(348.4,RCXVBTN_",",.05)=RBSQ
"RTN","RCXVTSK",51,0)
 F  S RCXVBTN=$O(RCXVUP(348.4,RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",52,0)
 . S RCXVUP(348.4,RCXVBTN,.06)=RBTOT
"RTN","RCXVTSK",53,0)
 D FILE^DIE("","RCXVUP","RCXVERR")
"RTN","RCXVTSK",54,0)
 K RCXVUP
"RTN","RCXVTSK",55,0)
 ;
"RTN","RCXVTSK",56,0)
 S RCXVBTN=""
"RTN","RCXVTSK",57,0)
STRT ;  Start the build and transmission of batches
"RTN","RCXVTSK",58,0)
 D ^RCXVCHK
"RTN","RCXVTSK",59,0)
 F RCSTAT="T","P" F  S RCXVBTN=$O(^RCXV("AC",RCSTAT,RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",60,0)
 . S RCXVBLN=0,RQFL=0
"RTN","RCXVTSK",61,0)
 . S RCXVSITE=$P($$SITE^VASITE(),U,3)
"RTN","RCXVTSK",62,0)
 . S RCXVDIR=$P($G(^RC(342,1,20)),U,1)
"RTN","RCXVTSK",63,0)
 . S RCXVBDT=$P($G(^RCXV(RCXVBTN,0)),U,2)
"RTN","RCXVTSK",64,0)
 . S RCXVBTY=$P($G(^RCXV(RCXVBTN,0)),U,4)
"RTN","RCXVTSK",65,0)
 . S RCXVSEQ=$P($G(^RCXV(RCXVBTN,0)),U,5)
"RTN","RCXVTSK",66,0)
 . S RCXVSTOT=$P($G(^RCXV(RCXVBTN,0)),U,6)
"RTN","RCXVTSK",67,0)
 . S RCXVLDOM=$P($G(^RC(342,1,20)),U,8)
"RTN","RCXVTSK",68,0)
 . S RCXVLEG=+$P($G(^RC(342,1,20)),U,7)
"RTN","RCXVTSK",69,0)
 . ;
"RTN","RCXVTSK",70,0)
 . I RCSTAT'="T" D  Q:RQFL
"RTN","RCXVTSK",71,0)
 .. I $G(RCXVSEQ)="" S RQFL=1 Q
"RTN","RCXVTSK",72,0)
 .. I $P(^RCXV(RCXVBTN,0),U,3)="C" S RQFL=1 Q
"RTN","RCXVTSK",73,0)
 .. S RCXVUP(348.4,RCXVBTN_",",.03)="T"
"RTN","RCXVTSK",74,0)
 .. D FILE^DIE("I","RCXVUP","RCXVERR")
"RTN","RCXVTSK",75,0)
 .. K RCXVUP
"RTN","RCXVTSK",76,0)
 . ;
"RTN","RCXVTSK",77,0)
 . ; If a file has been transmitted but no acknowledgement
"RTN","RCXVTSK",78,0)
 . ; has been received after 5 days, resend
"RTN","RCXVTSK",79,0)
 . I RCSTAT="T" D  Q:RQFL
"RTN","RCXVTSK",80,0)
 .. S RCXVTRD=$P($G(^RCXV(RCXVBTN,0)),U,8)\1
"RTN","RCXVTSK",81,0)
 .. S RCXVARD=$P($G(^RCXV(RCXVBTN,0)),U,9)\1
"RTN","RCXVTSK",82,0)
 .. I $$FMADD^XLFDT(RCXVTRD,5)>DT S RQFL=1
"RTN","RCXVTSK",83,0)
 .. ;I RCXVARD=0,RCXVLEG,RCXVTRD'=0 S RQFL=1
"RTN","RCXVTSK",84,0)
 . ;
"RTN","RCXVTSK",85,0)
 . Q:RQFL
"RTN","RCXVTSK",86,0)
 . ; FILENAME=SITE_DATE_BATCH# 
"RTN","RCXVTSK",87,0)
 . S RCXVFILE="RCXV"_RCXVSITE_RCXVBDT_RCXVBTN_".TXT"
"RTN","RCXVTSK",88,0)
 . S RCXVSCR="TMP_RCXV"_RCXVSITE_"_"_RCXVBTN
"RTN","RCXVTSK",89,0)
 . D OPEN^%ZISH("RCXVHNDL",RCXVDIR,RCXVFILE,"W")
"RTN","RCXVTSK",90,0)
 . U IO
"RTN","RCXVTSK",91,0)
 . S RCXVDMN=$P($G(^XTV(8989.3,1,0)),U,1)
"RTN","RCXVTSK",92,0)
 . S RCXVDMN=$P($G(^DIC(4.2,RCXVDMN,0)),U,1)
"RTN","RCXVTSK",93,0)
 . S RCXVRN=$P($G(^RCXV(RCXVBTN,1,0)),U,4) ; # OF REC
"RTN","RCXVTSK",94,0)
 . S RCXVRT=$P($G(^RCXV(RCXVBTN,0)),U,4) ; TYPE OF DATA 
"RTN","RCXVTSK",95,0)
 . W "HDR:"_RCXVSITE_RCXVU_RCXVDMN_RCXVU_RCXVRT_RCXVU_RCXVRN_RCXVU_RCXVBDT_RCXVU_RCXVXDT_RCXVU_RCXVSEQ_RCXVU_RCXVSTOT_RCXVU_RCXVLDOM,!
"RTN","RCXVTSK",96,0)
 . F  S RCXVBLN=$O(^RCXV(RCXVBTN,1,RCXVBLN)) Q:'RCXVBLN  D
"RTN","RCXVTSK",97,0)
 .. S DFN=$P(^RCXV(RCXVBTN,1,RCXVBLN,0),U,2)
"RTN","RCXVTSK",98,0)
 .. D EN^RCXVDC
"RTN","RCXVTSK",99,0)
 . ;
"RTN","RCXVTSK",100,0)
 . S RCXVD0=0
"RTN","RCXVTSK",101,0)
 . F  S RCXVD0=$O(^RCXV(RCXVBTN,2,RCXVD0)) Q:'RCXVD0  D
"RTN","RCXVTSK",102,0)
 .. S RCXVEDT=$P($G(^RCY(344,RCXVD0,0)),U,12)\1
"RTN","RCXVTSK",103,0)
 .. D D344^RCXVDC8
"RTN","RCXVTSK",104,0)
 . ;
"RTN","RCXVTSK",105,0)
 . D CLOSE^%ZISH("RCXVHNDL")
"RTN","RCXVTSK",106,0)
 . ;
"RTN","RCXVTSK",107,0)
 . S $P(^RC(342,1,20),U,9)=$$NOW^XLFDT()
"RTN","RCXVTSK",108,0)
 . ;
"RTN","RCXVTSK",109,0)
 . ;  FTP directly to ARC
"RTN","RCXVTSK",110,0)
 . D EN^RCXVFTP(RCXVFILE,RCXVDIR)
"RTN","RCXVTSK",111,0)
 ;
"RTN","RCXVTSK",112,0)
 ;  Check on FTP transfer messages
"RTN","RCXVTSK",113,0)
 D ^RCXVFTR
"RTN","RCXVTSK",114,0)
 ;
"RTN","RCXVTSK",115,0)
 L -^RCXVTSK
"RTN","RCXVTSK",116,0)
EXIT D MSG^RCXVCHK
"RTN","RCXVTSK",117,0)
 K IEN,DIK,DA,RCXVBLN,RCXVBTN,RCSTAT,RCXVBDT,RCXVDMN,RCXVXDT,RCXVTRD
"RTN","RCXVTSK",118,0)
 K RCXVSITE,RCXVFILE,RCXVRN,RCXVRT,RCXVDIR,RCXVATP,RCXVU,DTACT,RBSQ,RBTOT
"RTN","RCXVTSK",119,0)
 K RCFDATE,RCXVCFLG,RCXVDBN,RCXVIDT,RCXVSEQ,RCXVSTOT,RCXVTRD,CCT,DTENT
"RTN","RCXVTSK",120,0)
 K RCBLN,RCDBTR,RCDEBT,RCTRAN,RCXVTR,RCBCN,RCXVPFDT,RCXVPTDT,RCXRMB
"RTN","RCXVTSK",121,0)
 K RCXVLDOM,RCXVARD,RCXVSUB,RCXVBTY,RCXVLEG,RCXVSCR,Y,X
"RTN","RCXVTSK",122,0)
 K ^TMP("RCXVMSG",$J),^TMP("RCXVA",$J),^TMP("RCXVIN",$J)
"RTN","RCXVTSK",123,0)
 Q
"RTN","RCXVTSK",124,0)
 ;
"RTN","RCXVTSK",125,0)
HIS ;  Historical data extract
"RTN","RCXVTSK",126,0)
 ;
"RTN","RCXVTSK",127,0)
 L +^RCXVTSK:60 E  HANG 600 G HIS
"RTN","RCXVTSK",128,0)
 ;
"RTN","RCXVTSK",129,0)
 I $G(DT)="" D DT^DICRW
"RTN","RCXVTSK",130,0)
 ;
"RTN","RCXVTSK",131,0)
 I $G(RCXVFFD)="" D
"RTN","RCXVTSK",132,0)
 . S RCFDATE=$$FYCY^IBCU8(DT)
"RTN","RCXVTSK",133,0)
 . S RCXVFFD=$P(RCFDATE,U,3),RCXVFTD=$P(RCFDATE,U,4)
"RTN","RCXVTSK",134,0)
 ;
"RTN","RCXVTSK",135,0)
 S RCXVDAT=RCXVFFD-.01
"RTN","RCXVTSK",136,0)
 F  S RCXVDAT=$O(^PRCA(430,"ACTDT",RCXVDAT)) Q:RCXVDAT=""!(RCXVDAT>RCXVFTD)  D
"RTN","RCXVTSK",137,0)
 . S IEN=""
"RTN","RCXVTSK",138,0)
 . F  S IEN=$O(^PRCA(430,"ACTDT",RCXVDAT,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",139,0)
 .. I $P(^PRCA(430,IEN,0),U,8)=16!($P(^PRCA(430,IEN,0),U,8)=40) Q
"RTN","RCXVTSK",140,0)
 .. S RCXVBLN=IEN,DFN=$P(^PRCA(430,IEN,0),U,7)
"RTN","RCXVTSK",141,0)
 .. D FIL^RCXVDEQ("H")
"RTN","RCXVTSK",142,0)
 ;
"RTN","RCXVTSK",143,0)
 L -^RCXVTSK
"RTN","RCXVTSK",144,0)
 ;
"RTN","RCXVTSK",145,0)
 D EN
"RTN","RCXVTSK",146,0)
 K RCXVDAT,RCFDATE,RCXVFFD,RCXVFTD,IEN,DFN,RCXVBLN
"RTN","RCXVTSK",147,0)
 ;
"RTN","RCXVTSK",148,0)
 Q
"RTN","RCXVTSK",149,0)
 ;
"RTN","RCXVTSK",150,0)
CUR ;  Find all current fiscal year bills
"RTN","RCXVTSK",151,0)
 ;
"RTN","RCXVTSK",152,0)
 L +^RCXVTSK:60 E  HANG 600 G CUR
"RTN","RCXVTSK",153,0)
 ;
"RTN","RCXVTSK",154,0)
 S TTYP=""
"RTN","RCXVTSK",155,0)
 F  S TTYP=$O(^PRCA(433,"AT",TTYP)) Q:TTYP=""  D
"RTN","RCXVTSK",156,0)
 . I '+$P(^PRCA(430.3,TTYP,0),U,6) Q
"RTN","RCXVTSK",157,0)
 . S RDATE=RCXVFFD-.01
"RTN","RCXVTSK",158,0)
 . F  S RDATE=$O(^PRCA(433,"AT",TTYP,RDATE)) Q:RDATE=""!(RDATE\1>RCXVFTD)  D
"RTN","RCXVTSK",159,0)
 .. S IEN=""
"RTN","RCXVTSK",160,0)
 .. F  S IEN=$O(^PRCA(433,"AT",TTYP,RDATE,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",161,0)
 ... S RCXVBLN=$P(^PRCA(433,IEN,0),U,2)
"RTN","RCXVTSK",162,0)
 ... I RCXVBLN="" Q
"RTN","RCXVTSK",163,0)
 ... D FIL^RCXVDEQ("C")
"RTN","RCXVTSK",164,0)
 ;
"RTN","RCXVTSK",165,0)
 L -^RCXVTSK
"RTN","RCXVTSK",166,0)
 ;
"RTN","RCXVTSK",167,0)
 D EN
"RTN","RCXVTSK",168,0)
 K TTYP,RDATE,RCXVFFD,RCXVFTD,RCXVBLN
"RTN","RCXVTSK",169,0)
 Q
"RTN","RCXVTSK",170,0)
 ;
"RTN","RCXVTSK",171,0)
ACT ;  Active data extract
"RTN","RCXVTSK",172,0)
 ;
"RTN","RCXVTSK",173,0)
 L +^RCXVTSK:60 E  HANG 600 G ACT
"RTN","RCXVTSK",174,0)
 ;
"RTN","RCXVTSK",175,0)
 NEW STAT,CSTAT,QFL
"RTN","RCXVTSK",176,0)
 ;  Set up the AR Data Queue for all 'Active' and 'Suspended' bills
"RTN","RCXVTSK",177,0)
 F STAT=16,40 S IEN="" F  S IEN=$O(^PRCA(430,"AC",STAT,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",178,0)
 . S RCXVBLN=IEN,DFN=$P(^PRCA(430,IEN,0),U,7)
"RTN","RCXVTSK",179,0)
 . I $P(^PRCA(430,IEN,0),U,2)="" Q
"RTN","RCXVTSK",180,0)
 . S CSTAT=$P(^PRCA(430,IEN,0),U,8)
"RTN","RCXVTSK",181,0)
 . I CSTAT'=STAT S QFL=0 D  Q:QFL
"RTN","RCXVTSK",182,0)
 .. I CSTAT'=16!(CSTAT'=40) S QFL=1
"RTN","RCXVTSK",183,0)
 . D FIL^RCXVDEQ("A")
"RTN","RCXVTSK",184,0)
 ;
"RTN","RCXVTSK",185,0)
 L -^RCXVTSK
"RTN","RCXVTSK",186,0)
 ;
"RTN","RCXVTSK",187,0)
 D EN
"RTN","RCXVTSK",188,0)
 Q
"RTN","RCXVTSK",189,0)
 ;
"RTN","RCXVTSK",190,0)
ER ; Unlock and log error
"RTN","RCXVTSK",191,0)
 L -^RCXVTSK
"RTN","RCXVTSK",192,0)
 D ^%ZTER
"RTN","RCXVTSK",193,0)
 D UNWIND^%ZTER
"RTN","RCXVTSK",194,0)
 Q
"VER")
8.0^22.0
**END**
**END**
