Released LR*5.2*364 SEQ #290
Extracted from mail message
**KIDS**:LR*5.2*364^

**INSTALL NAME**
LR*5.2*364
"BLD",6992,0)
LR*5.2*364^LAB SERVICE^0^3071001^y
"BLD",6992,1,0)
^^2^2^3071001^^^^
"BLD",6992,1,1,0)
This patch corrects a problem with 2 CPRS displays which show a 
"BLD",6992,1,2,0)
collection time that is not correct. 
"BLD",6992,4,0)
^9.64PA^^
"BLD",6992,6)
2^
"BLD",6992,6.3)
3
"BLD",6992,"ABPKG")
n
"BLD",6992,"KRN",0)
^9.67PA^8989.52^19
"BLD",6992,"KRN",.4,0)
.4
"BLD",6992,"KRN",.401,0)
.401
"BLD",6992,"KRN",.402,0)
.402
"BLD",6992,"KRN",.403,0)
.403
"BLD",6992,"KRN",.5,0)
.5
"BLD",6992,"KRN",.84,0)
.84
"BLD",6992,"KRN",3.6,0)
3.6
"BLD",6992,"KRN",3.8,0)
3.8
"BLD",6992,"KRN",9.2,0)
9.2
"BLD",6992,"KRN",9.8,0)
9.8
"BLD",6992,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",6992,"KRN",9.8,"NM",1,0)
LR7OGG^^0^B39052367
"BLD",6992,"KRN",9.8,"NM",2,0)
LR7OGMG^^0^B12297173
"BLD",6992,"KRN",9.8,"NM",3,0)
LR7OGMM^^0^B7948709
"BLD",6992,"KRN",9.8,"NM","B","LR7OGG",1)

"BLD",6992,"KRN",9.8,"NM","B","LR7OGMG",2)

"BLD",6992,"KRN",9.8,"NM","B","LR7OGMM",3)

"BLD",6992,"KRN",19,0)
19
"BLD",6992,"KRN",19.1,0)
19.1
"BLD",6992,"KRN",101,0)
101
"BLD",6992,"KRN",409.61,0)
409.61
"BLD",6992,"KRN",771,0)
771
"BLD",6992,"KRN",870,0)
870
"BLD",6992,"KRN",8989.51,0)
8989.51
"BLD",6992,"KRN",8989.52,0)
8989.52
"BLD",6992,"KRN",8994,0)
8994
"BLD",6992,"KRN","B",.4,.4)

"BLD",6992,"KRN","B",.401,.401)

"BLD",6992,"KRN","B",.402,.402)

"BLD",6992,"KRN","B",.403,.403)

"BLD",6992,"KRN","B",.5,.5)

"BLD",6992,"KRN","B",.84,.84)

"BLD",6992,"KRN","B",3.6,3.6)

"BLD",6992,"KRN","B",3.8,3.8)

"BLD",6992,"KRN","B",9.2,9.2)

"BLD",6992,"KRN","B",9.8,9.8)

"BLD",6992,"KRN","B",19,19)

"BLD",6992,"KRN","B",19.1,19.1)

"BLD",6992,"KRN","B",101,101)

"BLD",6992,"KRN","B",409.61,409.61)

"BLD",6992,"KRN","B",771,771)

"BLD",6992,"KRN","B",870,870)

"BLD",6992,"KRN","B",8989.51,8989.51)

"BLD",6992,"KRN","B",8989.52,8989.52)

"BLD",6992,"KRN","B",8994,8994)

"BLD",6992,"QUES",0)
^9.62^^
"BLD",6992,"REQB",0)
^9.611^3^2
"BLD",6992,"REQB",2,0)
LR*5.2*331^2
"BLD",6992,"REQB",3,0)
LR*5.2*312^2
"BLD",6992,"REQB","B","LR*5.2*312",3)

"BLD",6992,"REQB","B","LR*5.2*331",2)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
364^3071001^33237
"PKG",26,22,1,"PAH",1,1,0)
^^2^2^3071001
"PKG",26,22,1,"PAH",1,1,1,0)
This patch corrects a problem with 2 CPRS displays which show a 
"PKG",26,22,1,"PAH",1,1,2,0)
collection time that is not correct. 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","LR7OGG")
0^1^B39052367^B38034627
"RTN","LR7OGG",1,0)
LR7OGG ;DALOI/STAFF- Interim report rpc grid ; Feb 9, 2005
"RTN","LR7OGG",2,0)
 ;;5.2;LAB SERVICE;**187,290,364**;Sep 27, 1994;Build 3
"RTN","LR7OGG",3,0)
 ;
"RTN","LR7OGG",4,0)
TEST ; test use only
"RTN","LR7OGG",5,0)
 N CNT,I K ^TMP("LR7OGX",$J)
"RTN","LR7OGG",6,0)
 S ^TMP("LR7OGX",$J,"INPUT",1)="2^2970202^2920202"
"RTN","LR7OGG",7,0)
 S CNT=1
"RTN","LR7OGG",8,0)
 ;F I=1:1:10 I $D(^LAB(60,I,0)) S CNT=CNT+1,^TMP("LR7OGX",$J,"INPUT",CNT)=I
"RTN","LR7OGG",9,0)
 F I=7,173,9,1 I $D(^LAB(60,I,0)) S CNT=CNT+1,^TMP("LR7OGX",$J,"INPUT",CNT)=I
"RTN","LR7OGG",10,0)
 D GRIDDATA
"RTN","LR7OGG",11,0)
 S I=0 F  S I=$O(^TMP("LR7OGX",$J,"OUTPUT",I)) Q:I<1  W !,^(I)
"RTN","LR7OGG",12,0)
 K ^TMP("LR7OGX",$J)
"RTN","LR7OGG",13,0)
 Q
"RTN","LR7OGG",14,0)
 ;
"RTN","LR7OGG",15,0)
GRID(ROOT,DFN,DATE1,DATE2,SPEC,TESTS) ; from ORWLRR
"RTN","LR7OGG",16,0)
 N CNT,NUM
"RTN","LR7OGG",17,0)
 K ^TMP("LR7OGX",$J,"INPUT"),^("OUTPUT")
"RTN","LR7OGG",18,0)
 S ROOT=$NA(^TMP("LR7OGX",$J,"OUTPUT"))
"RTN","LR7OGG",19,0)
 S ^TMP("LR7OGX",$J,"INPUT",1)=DFN_U_DATE1_U_DATE2_U_+SPEC
"RTN","LR7OGG",20,0)
 S CNT=1,NUM=0 F  S NUM=$O(TESTS(NUM)) Q:NUM<1  D
"RTN","LR7OGG",21,0)
 .S CNT=CNT+1
"RTN","LR7OGG",22,0)
 .S ^TMP("LR7OGX",$J,"INPUT",CNT)=+TESTS(NUM)
"RTN","LR7OGG",23,0)
 D GRIDDATA
"RTN","LR7OGG",24,0)
 Q
"RTN","LR7OGG",25,0)
 ;
"RTN","LR7OGG",26,0)
GRIDDATA ;
"RTN","LR7OGG",27,0)
 ; input format
"RTN","LR7OGG",28,0)
 ; ^TMP("LR7OGX",$J,"INPUT",1)=dfn^start date^end date^spec^all tests
"RTN","LR7OGG",29,0)
 ; ^TMP("LR7OGX",$J,"INPUT",#)=test#  (tests displayed in this order)
"RTN","LR7OGG",30,0)
 ;   (these tests should, be atomic, subscript - ch, type - both or output)
"RTN","LR7OGG",31,0)
 ;
"RTN","LR7OGG",32,0)
 S ^TMP("LR7OGX",$J,"OUTPUT",1)="0^0^0^1"
"RTN","LR7OGG",33,0)
 N ABCNT,ABDCNT,ABLINE,ABTCNT,ABTLINE,ADCNT,ADSEQ,AGE,ATCNT,ATSEQ,CDT,CHSUB,COMCNT,COMMENT,DATACNT,DATESEQ,DFN,EDATE,EDT,FLAG,IDT
"RTN","LR7OGG",34,0)
 N LINE,LRCW,LRDFN,LRX,NUM,ONLYSPEC,OUTCNT,PNM,PRNTCODE,RESULT,SDATE,SEX,SPEC,SPECNAME,TESTNAME,TESTNUM,TESTSEQ,TESTZERO,X,ZERO,INEXACT,DISPDATE
"RTN","LR7OGG",35,0)
 K ^TMP("LR7OG",$J)
"RTN","LR7OGG",36,0)
 S DFN=+^TMP("LR7OGX",$J,"INPUT",1),SDATE=+$P(^(1),U,2),EDATE=+$P(^(1),U,3),ONLYSPEC=+$P(^(1),U,4)
"RTN","LR7OGG",37,0)
 D DEMO^LR7OGU(DFN,.LRDFN,.PNM,.AGE,.SEX)
"RTN","LR7OGG",38,0)
 Q:'DFN  Q:'SDATE  Q:'EDATE  Q:'LRDFN
"RTN","LR7OGG",39,0)
 S OUTCNT=1,(ADCNT,ADSEQ,ATCNT,ATSEQ,COMCNT,DATACNT,DATESEQ,TESTSEQ,TCNT)=0
"RTN","LR7OGG",40,0)
 S NUM=1
"RTN","LR7OGG",41,0)
 F  S NUM=$O(^TMP("LR7OGX",$J,"INPUT",NUM)) Q:NUM<1  S TESTNUM=+^(NUM) D
"RTN","LR7OGG",42,0)
 . S TESTZERO=$G(^LAB(60,TESTNUM,0))
"RTN","LR7OGG",43,0)
 . S CHSUB=$P($P(TESTZERO,U,5),";",2)
"RTN","LR7OGG",44,0)
 . I 'CHSUB Q
"RTN","LR7OGG",45,0)
 . S TESTNAME=$P($G(^LAB(60,TESTNUM,.1)),U),PRNTCODE=$P($G(^(.1)),U,3)
"RTN","LR7OGG",46,0)
 . I TESTNAME="" S TESTNAME=$P(TESTZERO,U)
"RTN","LR7OGG",47,0)
 . S TESTSEQ=TESTSEQ+1
"RTN","LR7OGG",48,0)
 . S LINE=TESTSEQ_U_TESTNUM_U_TESTNAME_U_PRNTCODE
"RTN","LR7OGG",49,0)
 . S ^TMP("LR7OG",$J,"TEST",CHSUB)=LINE
"RTN","LR7OGG",50,0)
 . S OUTCNT=OUTCNT+1
"RTN","LR7OGG",51,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGG",52,0)
 S ^TMP("LR7OGX",$J,"OUTPUT",1)=TESTSEQ
"RTN","LR7OGG",53,0)
 S EDATE=EDATE\1
"RTN","LR7OGG",54,0)
 S IDT=9999999-SDATE,EDT=9999999-EDATE
"RTN","LR7OGG",55,0)
 F  S IDT=$O(^LR(LRDFN,"CH",IDT)) Q:IDT<1  Q:IDT>EDT  D
"RTN","LR7OGG",56,0)
 . S ZERO=^LR(LRDFN,"CH",IDT,0)
"RTN","LR7OGG",57,0)
 . I '$P(ZERO,U,3) Q
"RTN","LR7OGG",58,0)
 . S CDT=+ZERO,INEXACT=$P(ZERO,U,2),SPEC=+$P(ZERO,U,5),SPECNAME=$P($G(^LAB(61,SPEC,0)),U),COMMENT=$S($O(^LR(LRDFN,"CH",IDT,1,0)):"**",1:"")
"RTN","LR7OGG",59,0)
 . I ONLYSPEC,SPEC'=ONLYSPEC Q
"RTN","LR7OGG",60,0)
 . S CHSUB=1
"RTN","LR7OGG",61,0)
 . F  S CHSUB=$O(^LR(LRDFN,"CH",IDT,CHSUB)) Q:CHSUB=""  D
"RTN","LR7OGG",62,0)
 . . I '$D(^TMP("LR7OG",$J,"TEST",CHSUB)) Q
"RTN","LR7OGG",63,0)
 . . I '$D(^TMP("LR7OG",$J,"DATE",IDT)) S ^(IDT)="" D
"RTN","LR7OGG",64,0)
 . . . S DATESEQ=DATESEQ+1
"RTN","LR7OGG",65,0)
 . . . S OUTCNT=OUTCNT+1
"RTN","LR7OGG",66,0)
 . . . S DISPDATE=$S(INEXACT:CDT\1,1:CDT)
"RTN","LR7OGG",67,0)
 . . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=DATESEQ_U_CDT_U_SPEC_U_SPECNAME_U_COMMENT_U_DISPDATE
"RTN","LR7OGG",68,0)
 . . . I COMMENT'="" D
"RTN","LR7OGG",69,0)
 . . . . S COMCNT=COMCNT+1
"RTN","LR7OGG",70,0)
 . . . . S ^TMP("LR7OG",$J,"COMMENT",COMCNT)=$P($$FMTE^XLFDT(CDT),":",1,2)_" ** Comments:"
"RTN","LR7OGG",71,0)
 . . . . S NUM=0
"RTN","LR7OGG",72,0)
 . . . . F  S NUM=$O(^LR(LRDFN,"CH",IDT,1,NUM)) Q:NUM<1  S LINE=$G(^(NUM,0)) D
"RTN","LR7OGG",73,0)
 . . . . . S COMCNT=COMCNT+1
"RTN","LR7OGG",74,0)
 . . . . . S ^TMP("LR7OG",$J,"COMMENT",COMCNT)=LINE
"RTN","LR7OGG",75,0)
 . . . . S COMCNT=COMCNT+1
"RTN","LR7OGG",76,0)
 . . . . S ^TMP("LR7OG",$J,"COMMENT",COMCNT)=""
"RTN","LR7OGG",77,0)
 . . S LRX=$$TSTRES^LRRPU(LRDFN,"CH",IDT,CHSUB,"")
"RTN","LR7OGG",78,0)
 . . S RESULT=$P(LRX,"^"),FLAG=$P(LRX,U,2)
"RTN","LR7OGG",79,0)
 . . S PRNTCODE=$P(^TMP("LR7OG",$J,"TEST",CHSUB),U,4)
"RTN","LR7OGG",80,0)
 . . I PRNTCODE'="" S X=RESULT,LRCW=8 S @("RESULT="_PRNTCODE)
"RTN","LR7OGG",81,0)
 . . E  S RESULT=$J(RESULT,8)
"RTN","LR7OGG",82,0)
 . . S RESULT=$$STRIP^LR7OGU(RESULT)
"RTN","LR7OGG",83,0)
 . . I FLAG'="" D
"RTN","LR7OGG",84,0)
 . . . S ABTLINE=^TMP("LR7OG",$J,"TEST",CHSUB)
"RTN","LR7OGG",85,0)
 . . . I '$D(^TMP("LR7OG",$J,"ABTSEQ",+ABTLINE)) S ^(+ABTLINE)=U_$P(ABTLINE,U,2,3)
"RTN","LR7OGG",86,0)
 . . . I '$D(^TMP("LR7OG",$J,"ABDSEQ",IDT)) S ^(IDT)=U_CDT_U_SPEC_U_SPECNAME_U_COMMENT
"RTN","LR7OGG",87,0)
 . . . S ^TMP("LR7OG",$J,"ABDATA",IDT,+ABTLINE)=RESULT_U_FLAG
"RTN","LR7OGG",88,0)
 . . S TESTSEQ=+^TMP("LR7OG",$J,"TEST",CHSUB)
"RTN","LR7OGG",89,0)
 . . S DATACNT=DATACNT+1
"RTN","LR7OGG",90,0)
 . . S ^TMP("LR7OG",$J,"DATA",DATACNT)=DATESEQ_U_TESTSEQ_U_RESULT_U_FLAG
"RTN","LR7OGG",91,0)
 . . D TESTSPEC(CHSUB,SPEC,SPECNAME,AGE,SEX)
"RTN","LR7OGG",92,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,2,3)=DATESEQ_U_DATACNT
"RTN","LR7OGG",93,0)
 S DATACNT=0
"RTN","LR7OGG",94,0)
 F  S DATACNT=$O(^TMP("LR7OG",$J,"DATA",DATACNT)) Q:DATACNT<1  S LINE=^(DATACNT) D
"RTN","LR7OGG",95,0)
 . S OUTCNT=OUTCNT+1,^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGG",96,0)
 S OUTCNT=OUTCNT+1,ABLINE=OUTCNT
"RTN","LR7OGG",97,0)
 S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="0^0^0"
"RTN","LR7OGG",98,0)
 ;
"RTN","LR7OGG",99,0)
 S (ABTCNT,ATSEQ)=0
"RTN","LR7OGG",100,0)
 F  S ATSEQ=$O(^TMP("LR7OG",$J,"ABTSEQ",ATSEQ)) Q:ATSEQ<1  D
"RTN","LR7OGG",101,0)
 . S ABTCNT=ABTCNT+1
"RTN","LR7OGG",102,0)
 . S $P(^TMP("LR7OG",$J,"ABTSEQ",ATSEQ),U)=ABTCNT
"RTN","LR7OGG",103,0)
 . S OUTCNT=OUTCNT+1
"RTN","LR7OGG",104,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=^TMP("LR7OG",$J,"ABTSEQ",ATSEQ)
"RTN","LR7OGG",105,0)
 ;
"RTN","LR7OGG",106,0)
 S (ABDCNT,ADSEQ)=0
"RTN","LR7OGG",107,0)
 F  S ADSEQ=$O(^TMP("LR7OG",$J,"ABDSEQ",ADSEQ)) Q:ADSEQ<1  D
"RTN","LR7OGG",108,0)
 . S ABDCNT=ABDCNT+1
"RTN","LR7OGG",109,0)
 . S $P(^TMP("LR7OG",$J,"ABDSEQ",ADSEQ),U)=ABDCNT
"RTN","LR7OGG",110,0)
 . S OUTCNT=OUTCNT+1
"RTN","LR7OGG",111,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=^TMP("LR7OG",$J,"ABDSEQ",ADSEQ)
"RTN","LR7OGG",112,0)
 ;
"RTN","LR7OGG",113,0)
 S (ABCNT,ADSEQ)=0
"RTN","LR7OGG",114,0)
 F  S ADSEQ=$O(^TMP("LR7OG",$J,"ABDATA",ADSEQ)) Q:ADSEQ<1  D
"RTN","LR7OGG",115,0)
 . S ADCNT=+^TMP("LR7OG",$J,"ABDSEQ",ADSEQ)
"RTN","LR7OGG",116,0)
 . S ATSEQ=0
"RTN","LR7OGG",117,0)
 .  F  S ATSEQ=$O(^TMP("LR7OG",$J,"ABDATA",ADSEQ,ATSEQ)) Q:ATSEQ<1  D
"RTN","LR7OGG",118,0)
 . . S ATCNT=+^TMP("LR7OG",$J,"ABTSEQ",ATSEQ)
"RTN","LR7OGG",119,0)
 . . S ABCNT=ABCNT+1
"RTN","LR7OGG",120,0)
 . . S OUTCNT=OUTCNT+1
"RTN","LR7OGG",121,0)
 . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=ADCNT_U_ATCNT_U_^TMP("LR7OG",$J,"ABDATA",ADSEQ,ATSEQ)
"RTN","LR7OGG",122,0)
 ;
"RTN","LR7OGG",123,0)
 S ^TMP("LR7OGX",$J,"OUTPUT",ABLINE)=ABTCNT_U_ABDCNT_U_ABCNT
"RTN","LR7OGG",124,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,4)=OUTCNT
"RTN","LR7OGG",125,0)
 S TESTSEQ=0
"RTN","LR7OGG",126,0)
  F  S TESTSEQ=$O(^TMP("LR7OG",$J,"TESTSPEC",TESTSEQ)) Q:TESTSEQ<1  D
"RTN","LR7OGG",127,0)
 . S SPEC=0
"RTN","LR7OGG",128,0)
 . F  S SPEC=$O(^TMP("LR7OG",$J,"TESTSPEC",TESTSEQ,SPEC)) Q:SPEC<1  S LINE=^(SPEC) D
"RTN","LR7OGG",129,0)
 . . S OUTCNT=OUTCNT+1
"RTN","LR7OGG",130,0)
 . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGG",131,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,5)=OUTCNT
"RTN","LR7OGG",132,0)
 ;
"RTN","LR7OGG",133,0)
 S NUM=0
"RTN","LR7OGG",134,0)
 F  S NUM=$O(^TMP("LR7OG",$J,"COMMENT",NUM)) Q:NUM<1  S LINE=^(NUM) D
"RTN","LR7OGG",135,0)
 . S OUTCNT=OUTCNT+1
"RTN","LR7OGG",136,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGG",137,0)
 K ^TMP("LR7OG",$J)
"RTN","LR7OGG",138,0)
 Q
"RTN","LR7OGG",139,0)
 ;
"RTN","LR7OGG",140,0)
 ;
"RTN","LR7OGG",141,0)
TESTSPEC(CHSUB,SPEC,SPECNAME,AGE,SEX) ;
"RTN","LR7OGG",142,0)
 N RANGE,TESTNAME,TESTNUM,TESTSEQ,UNITS
"RTN","LR7OGG",143,0)
 S TESTSEQ=+$P(^TMP("LR7OG",$J,"TEST",CHSUB),U),TESTNUM=+$P(^(CHSUB),U,2),TESTNAME=$P(^(CHSUB),U,3)
"RTN","LR7OGG",144,0)
 I $D(^TMP("LR7OG",$J,"TESTSPEC",TESTSEQ,SPEC)) Q
"RTN","LR7OGG",145,0)
 D URANGE^LR7OGU(TESTNUM,SPEC,AGE,SEX,.UNITS,.RANGE)
"RTN","LR7OGG",146,0)
 S ^TMP("LR7OG",$J,"TESTSPEC",TESTSEQ,SPEC)=TESTNUM_U_SPECNAME_U_SPEC_U_UNITS_U_$P(RANGE," - ")_U_$P($P(RANGE," - ",2)," (")
"RTN","LR7OGG",147,0)
 Q
"RTN","LR7OGMG")
0^2^B12297173^B11682184
"RTN","LR7OGMG",1,0)
LR7OGMG ;DALOI/STAFF- Interim report rpc memo grid ;July 19, 2006
"RTN","LR7OGMG",2,0)
 ;;5.2;LAB SERVICE;**187,230,286,290,331,364**;Sep 27, 1994;Build 3
"RTN","LR7OGMG",3,0)
 ;
"RTN","LR7OGMG",4,0)
GRID(OUTCNT) ; from LR7OGMC
"RTN","LR7OGMG",5,0)
 N ACC,AGE,CDT,CMNT,DATA,DOC,FLAG,IDT,INTP,LINE,LRCW,LRX,MPLS,PLS,PORDER,PRNTCODE,RANGE,SEX,SPEC,SUB,TCNT,TESTNAME,TESTNUM
"RTN","LR7OGMG",6,0)
 N UNITS,VALUE,X,ZERO,INEXACT,DISPDATE
"RTN","LR7OGMG",7,0)
 ; the variables AGE, SEX, LRCW, and X are used withing the lab's print codes and ref ranges
"RTN","LR7OGMG",8,0)
 K ^TMP("LRMPLS",$J)
"RTN","LR7OGMG",9,0)
 S AGE=$P(^TMP("LR7OG",$J,"G"),U,4),SEX=$P(^("G"),U,5),LRCW=$P(^("G"),U,6)
"RTN","LR7OGMG",10,0)
 S CDT=+$O(^TMP("LR7OG",$J,"TP",0)) Q:'CDT
"RTN","LR7OGMG",11,0)
 S IDT=9999999-CDT
"RTN","LR7OGMG",12,0)
 S ZERO=$S($D(^TMP("LR7OG",$J,"TP",CDT))#2:^(CDT),1:"")
"RTN","LR7OGMG",13,0)
 I '$P(ZERO,U,3) Q
"RTN","LR7OGMG",14,0)
 S SPEC=+$P(ZERO,U,5)
"RTN","LR7OGMG",15,0)
 S INEXACT=$P(ZERO,U,2),DISPDATE=$S(INEXACT:CDT\1,1:CDT)
"RTN","LR7OGMG",16,0)
 S DOC=$$NAME^LR7OGMP(+$P(ZERO,U,10))
"RTN","LR7OGMG",17,0)
 S ACC=$P(ZERO,U,6)
"RTN","LR7OGMG",18,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,4,6)=SPEC_U_$P($G(^LAB(61,SPEC,0)),U)_U_ACC_U_DOC
"RTN","LR7OGMG",19,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U,10)=DISPDATE
"RTN","LR7OGMG",20,0)
 S (TCNT,MPLS,PORDER,PLS)=0
"RTN","LR7OGMG",21,0)
 S PLS=$O(^TMP("LRPLS",$J,0))
"RTN","LR7OGMG",22,0)
 I $O(^TMP("LRPLS",$J,PLS)) S MPLS=1 ; multiple performing labs
"RTN","LR7OGMG",23,0)
 F  S PORDER=$O(^TMP("LR7OG",$J,"TP",CDT,PORDER)) Q:PORDER'>0  S DATA=^(PORDER) D
"RTN","LR7OGMG",24,0)
 . I $P(DATA,U,7)="" Q
"RTN","LR7OGMG",25,0)
 . S TCNT=TCNT+1
"RTN","LR7OGMG",26,0)
 . S TESTNUM=+DATA,TESTNAME=$P(DATA,U,2),PRNTCODE=$P(DATA,U,5),SUB=$P(DATA,U,6),FLAG=$P(DATA,U,8),X=$P(DATA,U,7),UNITS=$P(DATA,U,9),RANGE=$P(DATA,U,10),PLS=$P(DATA,U,11)
"RTN","LR7OGMG",27,0)
 . I MPLS,PLS S ^TMP("LRMPLS",$J,PLS,TESTNAME)=""
"RTN","LR7OGMG",28,0)
 . I PRNTCODE="" S VALUE=$J(X,8)
"RTN","LR7OGMG",29,0)
 . E  S @("VALUE="_PRNTCODE)
"RTN","LR7OGMG",30,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=TESTNUM_U_TESTNAME_U_VALUE_U_FLAG_U_UNITS_U_RANGE
"RTN","LR7OGMG",31,0)
 . S OUTCNT=OUTCNT+1
"RTN","LR7OGMG",32,0)
 S $P(^TMP("LR7OGX",$J,"OUTPUT",1),U)=TCNT
"RTN","LR7OGMG",33,0)
 ;
"RTN","LR7OGMG",34,0)
 S PORDER=0
"RTN","LR7OGMG",35,0)
 F  S PORDER=$O(^TMP("LR7OG",$J,"TP",CDT,PORDER)) Q:PORDER'>0  S DATA=^(PORDER) D
"RTN","LR7OGMG",36,0)
 . I $O(^TMP("LR7OG",$J,"TP",CDT,PORDER,0))>0 D
"RTN","LR7OGMG",37,0)
 . . S TESTNAME=$P(DATA,U,3)
"RTN","LR7OGMG",38,0)
 . . S INTP=0
"RTN","LR7OGMG",39,0)
 . . F  S INTP=+$O(^TMP("LR7OG",$J,"TP",CDT,PORDER,INTP)) Q:INTP<1  D
"RTN","LR7OGMG",40,0)
 . . . S LINE=TESTNAME_" Eval: "_^TMP("LR7OG",$J,"TP",CDT,PORDER,INTP)
"RTN","LR7OGMG",41,0)
 . . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGMG",42,0)
 . . . S OUTCNT=OUTCNT+1
"RTN","LR7OGMG",43,0)
 ;
"RTN","LR7OGMG",44,0)
 I $D(^TMP("LR7OG",$J,"TP",CDT,"C")) D
"RTN","LR7OGMG",45,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="Comment: "
"RTN","LR7OGMG",46,0)
 . S OUTCNT=OUTCNT+1,CMNT=0
"RTN","LR7OGMG",47,0)
 . F  S CMNT=+$O(^TMP("LR7OG",$J,"TP",CDT,"C",CMNT)) Q:CMNT<1  S LINE=^(CMNT) D
"RTN","LR7OGMG",48,0)
 . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="   "_LINE
"RTN","LR7OGMG",49,0)
 . . S OUTCNT=OUTCNT+1
"RTN","LR7OGMG",50,0)
 ;
"RTN","LR7OGMG",51,0)
 D PLS
"RTN","LR7OGMG",52,0)
 Q
"RTN","LR7OGMG",53,0)
 ;
"RTN","LR7OGMG",54,0)
 ;
"RTN","LR7OGMG",55,0)
PLS ; List performing laboratories
"RTN","LR7OGMG",56,0)
 ; If multiple performing labs then list tests associated with each lab.
"RTN","LR7OGMG",57,0)
 ;
"RTN","LR7OGMG",58,0)
 N CNT,LINE,LRPLS,X
"RTN","LR7OGMG",59,0)
 S (CNT,LRPLS)=0
"RTN","LR7OGMG",60,0)
 F  S LRPLS=$O(^TMP("LRPLS",$J,LRPLS)) Q:LRPLS<1  D
"RTN","LR7OGMG",61,0)
 . I CNT S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=" ",OUTCNT=OUTCNT+1
"RTN","LR7OGMG",62,0)
 . I $D(^TMP("LRMPLS",$J,LRPLS)) D
"RTN","LR7OGMG",63,0)
 . . S TESTNAME="",LINE="For test(s): "
"RTN","LR7OGMG",64,0)
 . . F  S TESTNAME=$O(^TMP("LRMPLS",$J,LRPLS,TESTNAME)) Q:TESTNAME=""  D
"RTN","LR7OGMG",65,0)
 . . . I ($L(LINE)+$L(TESTNAME))>240 D
"RTN","LR7OGMG",66,0)
 . . . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE
"RTN","LR7OGMG",67,0)
 . . . . S OUTCNT=OUTCNT+1,LINE=""
"RTN","LR7OGMG",68,0)
 . . . S LINE=LINE_TESTNAME_", "
"RTN","LR7OGMG",69,0)
 . . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE,OUTCNT=OUTCNT+1
"RTN","LR7OGMG",70,0)
 . S LINE=$$NAME^XUAF4(LRPLS)
"RTN","LR7OGMG",71,0)
 . S X=$$PADD^XUAF4(LRPLS)
"RTN","LR7OGMG",72,0)
 . S LINE=LINE_"  "_$P(X,U)_"  "_$P(X,U,2)_", "_$P(X,U,3)_" "_$P(X,U,4)
"RTN","LR7OGMG",73,0)
 . S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="Performing Lab: "_LINE
"RTN","LR7OGMG",74,0)
 . S OUTCNT=OUTCNT+1,CNT=CNT+1
"RTN","LR7OGMG",75,0)
 ;
"RTN","LR7OGMG",76,0)
 K ^TMP("LRPLS",$J),^TMP("LRMPLS",$J)
"RTN","LR7OGMG",77,0)
 Q
"RTN","LR7OGMM")
0^3^B7948709^B6478402
"RTN","LR7OGMM",1,0)
LR7OGMM ;SLC/STAFF- Interim report rpc memo micro ;5/20/97  18:52
"RTN","LR7OGMM",2,0)
 ;;5.2;LAB SERVICE;**187,312,364**;Sep 27, 1994;Build 3
"RTN","LR7OGMM",3,0)
 ;
"RTN","LR7OGMM",4,0)
MI(LRDFN,IDT,MICROSUB,ALL,OUTCNT,FORMAT,DONE) ; from LR7OGM
"RTN","LR7OGMM",5,0)
 N MISUB,OK,ZERO,INEXACT,DISPDATE,XDT
"RTN","LR7OGMM",6,0)
 I '$D(^LR(LRDFN,"MI",IDT)) Q
"RTN","LR7OGMM",7,0)
 S OK=ALL
"RTN","LR7OGMM",8,0)
 I 'OK S MISUB=0 F  S MISUB=+$O(MICROSUB(MISUB)) Q:MISUB<1  I $D(^LR(LRDFN,"MI",IDT,MISUB)) S OK=1 Q
"RTN","LR7OGMM",9,0)
 I 'OK Q
"RTN","LR7OGMM",10,0)
 I $G(FORMAT) D
"RTN","LR7OGMM",11,0)
 .S XDT=9999999-IDT
"RTN","LR7OGMM",12,0)
 .S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="^MI^"_XDT D
"RTN","LR7OGMM",13,0)
 ..; determine if collection time is "inexact" and put the 
"RTN","LR7OGMM",14,0)
 ..; collection day/time that is to be displayed in piece 10
"RTN","LR7OGMM",15,0)
 ..S ZERO=$G(^LR(LRDFN,"MI",IDT,0)) Q:ZERO=""
"RTN","LR7OGMM",16,0)
 ..S INEXACT=$P(ZERO,U,2)
"RTN","LR7OGMM",17,0)
 ..S DISPDATE=$S(INEXACT:XDT\1,1:XDT)
"RTN","LR7OGMM",18,0)
 ..S $P(^TMP("LR7OGX",$J,"OUTPUT",OUTCNT),U,10)=DISPDATE
"RTN","LR7OGMM",19,0)
 .S OUTCNT=OUTCNT+1
"RTN","LR7OGMM",20,0)
 .S DONE=1
"RTN","LR7OGMM",21,0)
 D MIC(LRDFN,IDT,.OUTCNT)
"RTN","LR7OGMM",22,0)
 Q
"RTN","LR7OGMM",23,0)
 ;
"RTN","LR7OGMM",24,0)
MIC(LRDFN,LRIDT,OUTCNT) ;
"RTN","LR7OGMM",25,0)
 N AGE,GCNT,GIOM,LINE,LREND,LRONESPC,LRONETST,NUM,SEX
"RTN","LR7OGMM",26,0)
 S GCNT=0,GIOM=80,LREND=0,LRONESPC="",LRONETST=0
"RTN","LR7OGMM",27,0)
 S AGE=$P(^TMP("LR7OG",$J,"G"),U,5),SEX=$P(^("G"),U,6)
"RTN","LR7OGMM",28,0)
 ; new variables used by LR7OSMZ0
"RTN","LR7OGMM",29,0)
 N %,A,A8,AB,B,B1,B2,B3,C,CCNT,DIC,DZ,I,IA,II,INC,J,K,LR1PASS,LR2ORMOR,LRAA,LRABCNT,LRACC,LRACNT,LRAD,LRADM,LRADX,LRAFS,LRAMT,LRAN,LRAO,LRAX
"RTN","LR7OGMM",30,0)
 N LRBN,LRBRR,LRBUG,LRCMNT,LRCOMTAB,LRCS,LRDCOM,LRDOC,LRDRTM1,LRDRTM2,LREF,LRFLAG,LRFMT,LRGRM,LRIFN,LRINT,LRJ02,LRLABKY,LRLLT,LRMYC,LRNS,LRNUM
"RTN","LR7OGMM",31,0)
 N LRORG,LRPAR,LRPATLOC,LRPC,LRPG,LRPRE,LRPRINT,LRQU,LRRC,LRRES,LRSB,LRSBC1,LRSBC2,LRSET,LRSIC1,LRSIC2,LRSET,LRSIC1,LRSIC2,LRSPEC,LRSSD,LRST
"RTN","LR7OGMM",32,0)
 N LRTA,LRTB,LRTBA,LRTBC,LRTBS,LRTK,LRTS,LRTSTS,LRTUS,LRUS,LRWRD,LRWRDVEW,N,S1,SP,X,X1,Y,Y1
"RTN","LR7OGMM",33,0)
 K DIC,LR1PASS,LRBUG,LRDCOM,LRINT,LRRES,LRTS K ^TMP("LR",$J),^TMP("LRC",$J),^TMP("LRT",$J)
"RTN","LR7OGMM",34,0)
 D EN1^LR7OSMZ0
"RTN","LR7OGMM",35,0)
 I '$O(^TMP("LRC",$J,0)) Q
"RTN","LR7OGMM",36,0)
 S NUM=0 F  S NUM=$O(^TMP("LRC",$J,NUM)) Q:NUM<1  S LINE=^(NUM,0) D
"RTN","LR7OGMM",37,0)
 .S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)=LINE,OUTCNT=OUTCNT+1
"RTN","LR7OGMM",38,0)
 S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="===============================================================================",OUTCNT=OUTCNT+1
"RTN","LR7OGMM",39,0)
 K ^TMP("LR",$J),^TMP("LRC",$J),^TMP("LRT",$J)
"RTN","LR7OGMM",40,0)
 Q
"VER")
8.0^22.0
"BLD",6992,6)
^290
**END**
**END**
