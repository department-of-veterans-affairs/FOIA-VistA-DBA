Released XM*7.1*45 SEQ #39
Extracted from mail message
**KIDS**:XM*7.1*45^

**INSTALL NAME**
XM*7.1*45
"BLD",28,0)
XM*7.1*45^MAILMAN^0^2970424^n
"BLD",28,1,0)
^^46^46^2970424^^^^
"BLD",28,1,1,0)
MailMan patch XM*7.1*45 contains the following bug fix:
"BLD",28,1,2,0)

"BLD",28,1,3,0)
E3R:        9706
"BLD",28,1,4,0)
Rtns:       ^XMA5,^XMHIG
"BLD",28,1,5,0)
Option:     XMHELPGROUP
"BLD",28,1,6,0)
Test Sites: Fort Meade, Brockton
"BLD",28,1,7,0)
When a user deletes a mail group, references to it from other mail groups
"BLD",28,1,8,0)
are not deleted.  When a user gets help on a mail group which has a
"BLD",28,1,9,0)
non-existent mail group as a member, MailMan bombs.  This patch will keep
"BLD",28,1,10,0)
MailMan from bombing and will delete non-existent mail group references
"BLD",28,1,11,0)
during mail group inquiry.
"BLD",28,1,12,0)

"BLD",28,1,13,0)
===========================================================================
"BLD",28,1,14,0)
This patch should be installed after hours, when user activity is at a
"BLD",28,1,15,0)
minimum.  You should put the XMUSER Option out of order.
"BLD",28,1,16,0)
===========================================================================
"BLD",28,1,17,0)
 
"BLD",28,1,18,0)
INSTALLATION:
"BLD",28,1,19,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"BLD",28,1,20,0)
    disable mapping for the affected routine(s).
"BLD",28,1,21,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"BLD",28,1,22,0)
    the patch into a Transport Global on your system.
"BLD",28,1,23,0)
3.  On the KIDS:Installation menu, use the following options to install the
"BLD",28,1,24,0)
    Transport Global:
"BLD",28,1,25,0)
       Verify Checksums in Transport Global
"BLD",28,1,26,0)
       Print Transport Global
"BLD",28,1,27,0)
       Compare Transport Global to Current System
"BLD",28,1,28,0)
       Backup a Transport Global
"BLD",28,1,29,0)
       Install Package(s)
"BLD",28,1,30,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",28,1,31,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"BLD",28,1,32,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"BLD",28,1,33,0)
============================================================================ 
"BLD",28,1,34,0)
  
"BLD",28,1,35,0)
ROUTINES:
"BLD",28,1,36,0)
The second line of the routine now looks like:
"BLD",28,1,37,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",28,1,38,0)
 
"BLD",28,1,39,0)
              Before          After
"BLD",28,1,40,0)
Name          Checksum        Checksum        Patch List
"BLD",28,1,41,0)
----------------------------------------------------------
"BLD",28,1,42,0)
XMA5           1197080         11192062       31,45
"BLD",28,1,43,0)
XMHIG          * new *          4741088       45
"BLD",28,1,44,0)

"BLD",28,1,45,0)
* Checksums produced by CHECK^XTSUMBLD
"BLD",28,1,46,0)
============================================================================
"BLD",28,4,0)
^9.64PA^^0
"BLD",28,"INI")

"BLD",28,"INIT")

"BLD",28,"KRN",0)
^9.67PA^19^12
"BLD",28,"KRN",.4,0)
.4
"BLD",28,"KRN",.401,0)
.401
"BLD",28,"KRN",.402,0)
.402
"BLD",28,"KRN",.403,0)
.403
"BLD",28,"KRN",.5,0)
.5
"BLD",28,"KRN",.84,0)
.84
"BLD",28,"KRN",3.6,0)
3.6
"BLD",28,"KRN",3.8,0)
3.8
"BLD",28,"KRN",9.2,0)
9.2
"BLD",28,"KRN",9.8,0)
9.8
"BLD",28,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",28,"KRN",9.8,"NM",1,0)
XMA5^^0^B20320901
"BLD",28,"KRN",9.8,"NM",2,0)
XMHIG^^0^B18748906
"BLD",28,"KRN",9.8,"NM","B","XMA5",1)

"BLD",28,"KRN",9.8,"NM","B","XMHIG",2)

"BLD",28,"KRN",19,0)
19
"BLD",28,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",28,"KRN",19,"NM",1,0)
XMHELPGROUP^^0
"BLD",28,"KRN",19,"NM","B","XMHELPGROUP",1)

"BLD",28,"KRN",19.1,0)
19.1
"BLD",28,"KRN","B",.4,.4)

"BLD",28,"KRN","B",.401,.401)

"BLD",28,"KRN","B",.402,.402)

"BLD",28,"KRN","B",.403,.403)

"BLD",28,"KRN","B",.5,.5)

"BLD",28,"KRN","B",.84,.84)

"BLD",28,"KRN","B",3.6,3.6)

"BLD",28,"KRN","B",3.8,3.8)

"BLD",28,"KRN","B",9.2,9.2)

"BLD",28,"KRN","B",9.8,9.8)

"BLD",28,"KRN","B",19,19)

"BLD",28,"KRN","B",19.1,19.1)

"BLD",28,"QUES",0)
^9.62^^
"BLD",28,"REQB",0)
^9.611^^
"KRN",19,400,-1)
0^1
"KRN",19,400,0)
XMHELPGROUP^Group information^^R^^^^^^^^^^
"KRN",19,400,1,0)
^^1^1^2910328^^^
"KRN",19,400,1,1,0)
This option allows the user to get more detailed information about groups.
"KRN",19,400,25)
HELP^XMHIG
"KRN",19,400,"U")
GROUP INFORMATION
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",6,-1)
1^1
"PKG",6,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.1^2940602^2950925
"PKG",6,22,1,"PAH",1,0)
45^2970424
"PKG",6,22,1,"PAH",1,1,0)
^^46^46^2970424
"PKG",6,22,1,"PAH",1,1,1,0)
MailMan patch XM*7.1*45 contains the following bug fix:
"PKG",6,22,1,"PAH",1,1,2,0)

"PKG",6,22,1,"PAH",1,1,3,0)
E3R:        9706
"PKG",6,22,1,"PAH",1,1,4,0)
Rtns:       ^XMA5,^XMHIG
"PKG",6,22,1,"PAH",1,1,5,0)
Option:     XMHELPGROUP
"PKG",6,22,1,"PAH",1,1,6,0)
Test Sites: Fort Meade, Brockton
"PKG",6,22,1,"PAH",1,1,7,0)
When a user deletes a mail group, references to it from other mail groups
"PKG",6,22,1,"PAH",1,1,8,0)
are not deleted.  When a user gets help on a mail group which has a
"PKG",6,22,1,"PAH",1,1,9,0)
non-existent mail group as a member, MailMan bombs.  This patch will keep
"PKG",6,22,1,"PAH",1,1,10,0)
MailMan from bombing and will delete non-existent mail group references
"PKG",6,22,1,"PAH",1,1,11,0)
during mail group inquiry.
"PKG",6,22,1,"PAH",1,1,12,0)

"PKG",6,22,1,"PAH",1,1,13,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,14,0)
This patch should be installed after hours, when user activity is at a
"PKG",6,22,1,"PAH",1,1,15,0)
minimum.  You should put the XMUSER Option out of order.
"PKG",6,22,1,"PAH",1,1,16,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,17,0)
 
"PKG",6,22,1,"PAH",1,1,18,0)
INSTALLATION:
"PKG",6,22,1,"PAH",1,1,19,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"PKG",6,22,1,"PAH",1,1,20,0)
    disable mapping for the affected routine(s).
"PKG",6,22,1,"PAH",1,1,21,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"PKG",6,22,1,"PAH",1,1,22,0)
    the patch into a Transport Global on your system.
"PKG",6,22,1,"PAH",1,1,23,0)
3.  On the KIDS:Installation menu, use the following options to install the
"PKG",6,22,1,"PAH",1,1,24,0)
    Transport Global:
"PKG",6,22,1,"PAH",1,1,25,0)
       Verify Checksums in Transport Global
"PKG",6,22,1,"PAH",1,1,26,0)
       Print Transport Global
"PKG",6,22,1,"PAH",1,1,27,0)
       Compare Transport Global to Current System
"PKG",6,22,1,"PAH",1,1,28,0)
       Backup a Transport Global
"PKG",6,22,1,"PAH",1,1,29,0)
       Install Package(s)
"PKG",6,22,1,"PAH",1,1,30,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",6,22,1,"PAH",1,1,31,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"PKG",6,22,1,"PAH",1,1,32,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"PKG",6,22,1,"PAH",1,1,33,0)
============================================================================ 
"PKG",6,22,1,"PAH",1,1,34,0)
  
"PKG",6,22,1,"PAH",1,1,35,0)
ROUTINES:
"PKG",6,22,1,"PAH",1,1,36,0)
The second line of the routine now looks like:
"PKG",6,22,1,"PAH",1,1,37,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",6,22,1,"PAH",1,1,38,0)
 
"PKG",6,22,1,"PAH",1,1,39,0)
              Before          After
"PKG",6,22,1,"PAH",1,1,40,0)
Name          Checksum        Checksum        Patch List
"PKG",6,22,1,"PAH",1,1,41,0)
----------------------------------------------------------
"PKG",6,22,1,"PAH",1,1,42,0)
XMA5           1197080         11192062       31,45
"PKG",6,22,1,"PAH",1,1,43,0)
XMHIG          * new *          4741088       45
"PKG",6,22,1,"PAH",1,1,44,0)

"PKG",6,22,1,"PAH",1,1,45,0)
* Checksums produced by CHECK^XTSUMBLD
"PKG",6,22,1,"PAH",1,1,46,0)
============================================================================
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","XMA5")
0^1^B20320901
"RTN","XMA5",1,0)
XMA5 ;(WASH ISC)/THM/CAP- EDIT/ADD/SUBTRACT RECIPIENTS ;04/16/97  15:41
"RTN","XMA5",2,0)
 ;;7.1;MailMan;**31,45**;Jun 02, 1994
"RTN","XMA5",3,0)
 ;'$D(XMQUE)    : SHORT HEADER
"RTN","XMA5",4,0)
 ;XMQUE=text : SEARCH FOR RECIPIENT
"RTN","XMA5",5,0)
 ;XMQUE=1  : Addressed as list
"RTN","XMA5",6,0)
 ;XMQUE=2  : Network Header
"RTN","XMA5",7,0)
 ;XMQUE=3  : EXPANDED RECIPIENT LIST
"RTN","XMA5",8,0)
 ;
"RTN","XMA5",9,0)
QUER ;
"RTN","XMA5",10,0)
 S:'$D(XMQUE) XMQUE="" W @IOF I XMDUZ'=DUZ D S W !,*7,"User ",$P(^VA(200,DUZ,0),U)," acting as a surrogate for ",XMDUN
"RTN","XMA5",11,0)
 W ! S XMA5("HDR")=XMK D ENTCRT^XMAP K XMA5("HDR")
"RTN","XMA5",12,0)
QE2 S:'$D(XMQUE) XMQUE="" W ! S XMR=$S($D(^XMB(3.9,XMZ,0)):^(0),1:0) Q:XMR=0
"RTN","XMA5",13,0)
 S XMSG="Local Message-ID: "_XMZ_"@"_^XMB("NAME")_"  "_$S($P(XMR,U,7)["P":"*PRIORITY*",$P(XMR,U,7)["S":"[SPOOL]",$P(XMR,U,8):"<RESPONSE>",1:"")
"RTN","XMA5",14,0)
 S %=$G(^XMB(3.9,XMZ,1,0)) I $P(%,U,4) S XMSG=XMSG_" ("_$P(%,U,4)_" Recipients)"
"RTN","XMA5",15,0)
 I "yY"[$E($P(XMR,U,5)_" ") S XMSG=XMSG_" Confirmation requested.   "
"RTN","XMA5",16,0)
 I $P(XMR,U,10)'="" S XMSG=XMSG_" Scramble Hint: "_$P(XMR,U,10)
"RTN","XMA5",17,0)
 D OUT G Z:$D(XMOUT)
"RTN","XMA5",18,0)
 I $O(^XMB(3.9,XMZ,2005,0)) D LIST^XMA2B
"RTN","XMA5",19,0)
 S XMSG="" I "Yy"[$E($P(XMR,U,9)_" ") S XMSG="Closed. "
"RTN","XMA5",20,0)
 I "Yy"[$E($P(XMR,U,11)_" ") S XMSG=XMSG_"Confidential."
"RTN","XMA5",21,0)
 I "Yy"[$E($P(XMR,U,12)_" ") S XMSG=XMSG_" 'Information only' for all recipients."
"RTN","XMA5",22,0)
 D:$L(XMSG) OUT
"RTN","XMA5",23,0)
 I $D(^XMB(3.9,XMZ,4)) S XMSG="Lock: "_^(4) D OUT G Z:$D(XMOUT)
"RTN","XMA5",24,0)
 I $D(XMK),$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) S %=$P(^(0),U,5) I % S XMSG="Automatic Deletion Date: "_$E(%,4,5)_"/"_$E(%,6,7)_"/"_$E(%,2,3) D OUT
"RTN","XMA5",25,0)
 G QE3:XMQUE'=2
"RTN","XMA5",26,0)
 I $D(^XMB(3.9,XMZ,2,.001)) W !!,"Network header:",! F I=0:0 S I=$O(^XMB(3.9,XMZ,2,I)) Q:I=""!(I>.999)  S XMSG=^(I,0) D OUT Q:X[U
"RTN","XMA5",27,0)
 Q:X="^"  S XMSG="" D OUT G Z:$D(XMOUT)
"RTN","XMA5",28,0)
QE3 S I=.999 I XMQUE'?1.N,$L(XMQUE) S XMSG="Searching for recipients that match '"_XMQUE_"'." D OUT S XMSG="" D OUT
"RTN","XMA5",29,0)
 I XMQUE=2,$O(^XMB(3.9,XMZ,2,0))>.999 S XMSG="This message originated locally.  There is NO NETWORK HEADER !" D OUT
"RTN","XMA5",30,0)
 S XMF0=0 G ^XMA5A
"RTN","XMA5",31,0)
OUT S X="" D O Q:$D(XMOUT)  I $L(XMSG)<IOM W !,XMSG K XMSG G S
"RTN","XMA5",32,0)
 S %0=0
"RTN","XMA5",33,0)
P I $L(XMSG)+10>IOM F %1=IOM-20:1:IOM-10 Q:" ,-"[$E(XMSG,%1)
"RTN","XMA5",34,0)
 S %=$E(XMSG,1,%1),XMSG=$E(XMSG,%1+1,999) W !?%0,% D S S %0=9 G P:$L(XMSG)
"RTN","XMA5",35,0)
 K %,%1,%0 Q
"RTN","XMA5",36,0)
S S XMAPLCNT=$G(XMAPLCNT)+1 Q
"RTN","XMA5",37,0)
Q D ENT7^XMAH G QQ:$O(^TMP("XMY",$J,0))="" D RCPTS^XMA50 G Z:X[U
"RTN","XMA5",38,0)
QQ R !,"Want user information? NO// ",X:DTIME G Z:X["^"!'$T,QQ1:'$L(X) D Y G QQ:Y=1 D UHELP^XMA7:'Y
"RTN","XMA5",39,0)
QQ1 R !,"Want Mail Group information? NO// ",X:DTIME G Z:X["^"!'$T,QQ2:X="" D Y G QQ1:Y=1 D HELP^XMHIG:'Y
"RTN","XMA5",40,0)
QQ2 R !,"Want Domain information? NO// ",X:DTIME G QQ3:X="",Z:X["^"!'$T D Y G QQ2:Y=1 D QQ2^XMA50:'Y
"RTN","XMA5",41,0)
QQ3 ;MailLink Help
"RTN","XMA5",42,0)
 G Z:'$O(^XMD(4.2997,0))
"RTN","XMA5",43,0)
 ;
"RTN","XMA5",44,0)
 L +^XMD("XMDIR1"):1 E  W !!,"Update in progress.  Please continue..."
"RTN","XMA5",45,0)
 L -^XMD("XMDIR1")
"RTN","XMA5",46,0)
QQ3A R !,"Want MailLink Help ? NO// ",X:DTIME G Z:X=""!(X["^")!'$T D Y G QQ3A:Y=1,Z:Y=2
"RTN","XMA5",47,0)
QQ3B S DIC="^XMD(4.2997,",DIC(0)="AEFMQ",DIC("A")="Enter LASTNAME, Mail Code or part of LOCATION (one word only): " D ^DIC G Z:Y<0 S DA=+Y,DR=0 D EN^DIQ
"RTN","XMA5",48,0)
 G QQ3A
"RTN","XMA5",49,0)
ENTQ D H S XMB=+Y F XMA5=1,5:1:7 S XMA=0 D Q3 Q:$D(XMOUT)  W !
"RTN","XMA5",50,0)
 W ! K XMA5,XMOUT G Z
"RTN","XMA5",51,0)
Q3 S XMA=$O(^XMB(3.8,XMB,XMA5,XMA)) Q:+XMA'=XMA  S XMA5(0)=$P(^(XMA,0),U) D O Q:$D(XMOUT)  D H:$Y<2 W !,?5 S (J,X)=XMA5(0)
"RTN","XMA5",52,0)
 I '$D(XMDISPI) D DSP^XM
"RTN","XMA5",53,0)
 G V:'X,N:XMA5'=1,N:'$D(^VA(200,X,0)) S %=X,I=^(0),X=$P(I,U)
"RTN","XMA5",54,0)
 I $P(XMDISPI,U)["T",$P(I,U,9) S I=$G(^DIC(3.1,$P(I,U,9),0)) I $L($P(I,U)) S X=X_" - "_$P(I,U)
"RTN","XMA5",55,0)
 I $P(XMDISPI,U)["I",$D(^XMB(3.7,%,6000)) S X=X_" ("_$P(^(6000),U)_")"
"RTN","XMA5",56,0)
N I XMA5=5 S X="<Member Group>: "_$P(^XMB(3.8,+X,0),U)
"RTN","XMA5",57,0)
 I XMA5=7 S %=^XMB(3.816,+X,0),X="** Distribution List: "_$P(%,U) I $D(^(1,0)) S X=X_" (To "_$P(^(0),U,4)_" Domains)"
"RTN","XMA5",58,0)
V W X,?55 I XMA5=1 W $S($D(^XMB(3.7,+J,"L")):$P(^("L"),U),1:"<< Never Used MailMan >>")
"RTN","XMA5",59,0)
 G Q3
"RTN","XMA5",60,0)
H W !,?5,"Member",?55,"Last Used MailMan",! Q
"RTN","XMA5",61,0)
O Q:IOSL-6'<$Y  K DIR,XMOUT S DIR(0)="E" D:$E(IOST)="C" ^DIR S X="" S:$D(DTOUT)!$D(DUOUT) XMOUT=1 K DUOUT,DTOUT,DIRUT W @IOF Q
"RTN","XMA5",62,0)
Z K %,DIC,DIR,I,X,X1,X2,X3,Y,XMA,XMB,XMOUT,XMQUE,XMSG
"RTN","XMA5",63,0)
 I $D(XMAPLCNT) S %1="LINES_READ" L +^XMBPOST(%1) S %=$G(^XMBPOST(%1,0)),%=%+XMAPLCNT,^(0)=% L -^XMBPOST(%1) K %,%1,XMAPLCNT
"RTN","XMA5",64,0)
 Q
"RTN","XMA5",65,0)
Y S Y=0,X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","XMA5",66,0)
 Q:$E("YES",1,$L(X))=X  I $E("NO",1,$L(X))=X S Y=2 Q
"RTN","XMA5",67,0)
 W "   Please answer 'Yes', 'No' or enter '^' to abort." S Y=1 Q
"RTN","XMHIG")
0^2^B18748906
"RTN","XMHIG",1,0)
XMHIG ;ISC-SF/GMB Mail Group Info ;04/24/97  09:29
"RTN","XMHIG",2,0)
 ;;7.1;MailMan;**45**;Jun 02, 1994
"RTN","XMHIG",3,0)
 ; Replaces ENTQ^XMA5,GHELP^XMA7G (ISC-WASH/THM/CAP/RJ)
"RTN","XMHIG",4,0)
HELP ; Group Info
"RTN","XMHIG",5,0)
 N DIC,Y
"RTN","XMHIG",6,0)
 S:'$D(XMDUZ) XMDUZ=DUZ
"RTN","XMHIG",7,0)
 S DIC="^XMB(3.8,",DIC(0)="AEQMZ"
"RTN","XMHIG",8,0)
 ; Screen:  Group is public OR user is organizer OR user is member
"RTN","XMHIG",9,0)
 S DIC("S")="I $P(^(0),U,2)=""PU""!($G(^(3))=XMDUZ)!($D(^(1,""B"",XMDUZ)))"
"RTN","XMHIG",10,0)
 F  W ! D ^DIC Q:Y<0  D
"RTN","XMHIG",11,0)
 . D DISPLAY(+Y)
"RTN","XMHIG",12,0)
 Q
"RTN","XMHIG",13,0)
DISPLAY(XMGIEN) ;
"RTN","XMHIG",14,0)
 N XMABORT
"RTN","XMHIG",15,0)
 S XMABORT=0
"RTN","XMHIG",16,0)
 W @IOF
"RTN","XMHIG",17,0)
 D FIELDS(XMGIEN)
"RTN","XMHIG",18,0)
 D MEMBERS(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",19,0)
 D GROUP(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",20,0)
 D REMOTE(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",21,0)
 D DISTR(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",22,0)
 D FAXMEMBR(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",23,0)
 D FAXGROUP(XMGIEN,.XMABORT) Q:XMABORT
"RTN","XMHIG",24,0)
 Q
"RTN","XMHIG",25,0)
FIELDS(DA) ;
"RTN","XMHIG",26,0)
 N DIC,DR
"RTN","XMHIG",27,0)
 S DIC="^XMB(3.8,"
"RTN","XMHIG",28,0)
 F DR=0,3,4,2 D EN^DIQ
"RTN","XMHIG",29,0)
 Q
"RTN","XMHIG",30,0)
MEMBERS(XMGIEN,XMABORT) ;
"RTN","XMHIG",31,0)
 Q:'$O(^XMB(3.8,XMGIEN,1,0))
"RTN","XMHIG",32,0)
 N I,XMMIEN,XMNAME,XMTITLE,XMREC
"RTN","XMHIG",33,0)
 D:'$D(XMDISPI) DSP^XM
"RTN","XMHIG",34,0)
 D HEADER
"RTN","XMHIG",35,0)
 S I=0
"RTN","XMHIG",36,0)
 F  S I=$O(^XMB(3.8,XMGIEN,1,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMHIG",37,0)
 . I $Y+3>IOSL D PAGE(.XMABORT,1) Q:XMABORT
"RTN","XMHIG",38,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,1,I,0),U)
"RTN","XMHIG",39,0)
 . S XMREC=$G(^VA(200,XMMIEN,0))
"RTN","XMHIG",40,0)
 . I XMREC="" D DELETE(XMGIEN,1,I) Q
"RTN","XMHIG",41,0)
 . S XMNAME=$P(XMREC,U,1)
"RTN","XMHIG",42,0)
 . I $P(XMDISPI,U)["T",$P(XMREC,U,9) D  ; Show title
"RTN","XMHIG",43,0)
 . . S XMTITLE=$P($G(^DIC(3.1,$P(XMREC,U,9),0)),U,1)
"RTN","XMHIG",44,0)
 . . S:XMTITLE'="" XMNAME=XMNAME_" - "_XMTITLE
"RTN","XMHIG",45,0)
 . I $P(XMDISPI,U)["I",$D(^XMB(3.7,XMMIEN,6000)) S XMNAME=XMNAME_" ("_$P(^(6000),U)_")"  ; Show institution
"RTN","XMHIG",46,0)
 . W !,$E(XMNAME,1,44),?45,$S($D(^XMB(3.7,XMMIEN,"L")):$E($P(^("L"),U),1,35),1:"Never Used MailMan")
"RTN","XMHIG",47,0)
 Q
"RTN","XMHIG",48,0)
DELETE(XMGIEN,XMNODE,DA) ;
"RTN","XMHIG",49,0)
 N DIK
"RTN","XMHIG",50,0)
 L +^XMB(3.8,XMGIEN,XMNODE)
"RTN","XMHIG",51,0)
 S DA(1)=XMGIEN
"RTN","XMHIG",52,0)
 S DIK="^XMB(3.8,"_DA(1)_","_XMNODE_","
"RTN","XMHIG",53,0)
 D ^DIK
"RTN","XMHIG",54,0)
 L -^XMB(3.8,XMGIEN,XMNODE)
"RTN","XMHIG",55,0)
 Q
"RTN","XMHIG",56,0)
GROUP(XMGIEN,XMABORT) ; Member Groups
"RTN","XMHIG",57,0)
 Q:'$O(^XMB(3.8,XMGIEN,5,0))
"RTN","XMHIG",58,0)
 N I,XMMIEN,XMNAME
"RTN","XMHIG",59,0)
 W !
"RTN","XMHIG",60,0)
 S I=0
"RTN","XMHIG",61,0)
 F  S I=$O(^XMB(3.8,XMGIEN,5,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMHIG",62,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",63,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,5,I,0),U)
"RTN","XMHIG",64,0)
 . S XMNAME=$P($G(^XMB(3.8,XMMIEN,0)),U)
"RTN","XMHIG",65,0)
 . I XMNAME="" D DELETE(XMGIEN,5,I) Q
"RTN","XMHIG",66,0)
 . W !,"Member Group: ",XMNAME
"RTN","XMHIG",67,0)
 Q
"RTN","XMHIG",68,0)
REMOTE(XMGIEN,XMABORT) ; Remote Members
"RTN","XMHIG",69,0)
 Q:'$O(^XMB(3.8,XMGIEN,6,0))
"RTN","XMHIG",70,0)
 N I,XMNAME
"RTN","XMHIG",71,0)
 W !
"RTN","XMHIG",72,0)
 S I=0
"RTN","XMHIG",73,0)
 F  S I=$O(^XMB(3.8,XMGIEN,6,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMHIG",74,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",75,0)
 . S XMNAME=$P(^XMB(3.8,XMGIEN,6,I,0),U)
"RTN","XMHIG",76,0)
 . W !,"Remote Member: ",XMNAME
"RTN","XMHIG",77,0)
 Q
"RTN","XMHIG",78,0)
DISTR(XMGIEN,XMABORT) ; Distribution list
"RTN","XMHIG",79,0)
 Q:'$O(^XMB(3.8,XMGIEN,7,0))
"RTN","XMHIG",80,0)
 N I,XMMIEN,XMNAME
"RTN","XMHIG",81,0)
 W !
"RTN","XMHIG",82,0)
 S I=0
"RTN","XMHIG",83,0)
 F  S I=$O(^XMB(3.8,XMGIEN,7,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMHIG",84,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",85,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,7,I,0),U)
"RTN","XMHIG",86,0)
 . S XMNAME=$P($G(^XMB(3.816,XMMIEN,0)),U)
"RTN","XMHIG",87,0)
 . I XMNAME="" D DELETE(XMGIEN,7,I) Q
"RTN","XMHIG",88,0)
 . W !,"Distribution List: ",XMNAME W:$D(^XMB(3.816,XMMIEN,1,0)) " (To "_$P(^(0),U,4)_" Domains)"
"RTN","XMHIG",89,0)
 Q
"RTN","XMHIG",90,0)
FAXGROUP(XMGIEN,XMABORT) ; Fax Groups
"RTN","XMHIG",91,0)
 Q:'$O(^XMB(3.8,XMGIEN,9,0))
"RTN","XMHIG",92,0)
 N I,XMMIEN,XMNAME
"RTN","XMHIG",93,0)
 W !
"RTN","XMHIG",94,0)
 S I=0
"RTN","XMHIG",95,0)
 F  S I=$O(^XMB(3.8,XMGIEN,9,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMHIG",96,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",97,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,9,I,0),U)
"RTN","XMHIG",98,0)
 . S XMNAME=$P($G(^AKF("FAXG",XMMIEN,0)),U)
"RTN","XMHIG",99,0)
 . I XMNAME="" D DELETE(XMGIEN,9,I) Q
"RTN","XMHIG",100,0)
 . W !,"Fax Group: ",XMNAME
"RTN","XMHIG",101,0)
 Q
"RTN","XMHIG",102,0)
FAXMEMBR(XMGIEN,XMABORT) ; Fax Members
"RTN","XMHIG",103,0)
 Q:'$O(^XMB(3.8,XMGIEN,8,0))
"RTN","XMHIG",104,0)
 N I,XMMIEN,XMNAME
"RTN","XMHIG",105,0)
 W !
"RTN","XMHIG",106,0)
 S I=0
"RTN","XMHIG",107,0)
 F  S I=$O(^XMB(3.8,XMGIEN,8,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMHIG",108,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMHIG",109,0)
 . S XMMIEN=$P(^XMB(3.8,XMGIEN,8,I,0),U)
"RTN","XMHIG",110,0)
 . S XMNAME=$P($G(^AKF("FAXR",XMMIEN,0)),U)
"RTN","XMHIG",111,0)
 . I XMNAME="" D DELETE(XMGIEN,8,I) Q
"RTN","XMHIG",112,0)
 . W !,"Fax Recipient: ",XMNAME
"RTN","XMHIG",113,0)
 Q
"RTN","XMHIG",114,0)
GSCREEN ; This routine is a screen [DIC("S")] for a fileman lookup
"RTN","XMHIG",115,0)
 ; The naked reference is set to ^XMB(3.8,Y,0)
"RTN","XMHIG",116,0)
 I $P(^(0),U,2)="PU" Q        ; Group is public
"RTN","XMHIG",117,0)
 I $G(^(3))=XMDUZ Q           ; User is organizer of the group
"RTN","XMHIG",118,0)
 I $D(^(1,"B",XMDUZ)) Q       ; User is a member of the group
"RTN","XMHIG",119,0)
 ; *** But this doesn't handle the case in which a user might not be
"RTN","XMHIG",120,0)
 ; *** a member of this group, but is a member of a member group.
"RTN","XMHIG",121,0)
 Q
"RTN","XMHIG",122,0)
PAGE(XMABORT,XMHDR) ;
"RTN","XMHIG",123,0)
 N DIR,Y
"RTN","XMHIG",124,0)
 S DIR(0)="E" D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMHIG",125,0)
 W @IOF
"RTN","XMHIG",126,0)
 D:$G(XMHDR) HEADER
"RTN","XMHIG",127,0)
 Q
"RTN","XMHIG",128,0)
HEADER ;
"RTN","XMHIG",129,0)
 W ?2,"Member",?45,"Last Used MailMan"
"RTN","XMHIG",130,0)
 Q
"VER")
8.0^21.0
**END**
**END**
