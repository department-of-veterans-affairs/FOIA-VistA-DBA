Released LR*5.2*322 SEQ #257
Extracted from mail message
**KIDS**:LR*5.2*322^

**INSTALL NAME**
LR*5.2*322
"BLD",5937,0)
LR*5.2*322^LAB SERVICE^0^3050606^y
"BLD",5937,1,0)
^^5^5^3050201^
"BLD",5937,1,1,0)
The three problems addressed in this patch were originally described in
"BLD",5937,1,2,0)
the following NOIS calls:
"BLD",5937,1,3,0)
DAY-0204-42022 - EN+13~LRUPS undefined variable
"BLD",5937,1,4,0)
BHS-0804-11324 - <UNDEFINED>B+2^LRAUDA ERROR
"BLD",5937,1,5,0)
LON-0904-61172 - MAJOR SECTION REPORT, BOTH SCROLLING AND PRINTING
"BLD",5937,4,0)
^9.64PA^^
"BLD",5937,"ABPKG")
n
"BLD",5937,"KRN",0)
^9.67PA^8989.52^19
"BLD",5937,"KRN",.4,0)
.4
"BLD",5937,"KRN",.401,0)
.401
"BLD",5937,"KRN",.402,0)
.402
"BLD",5937,"KRN",.403,0)
.403
"BLD",5937,"KRN",.5,0)
.5
"BLD",5937,"KRN",.84,0)
.84
"BLD",5937,"KRN",3.6,0)
3.6
"BLD",5937,"KRN",3.8,0)
3.8
"BLD",5937,"KRN",9.2,0)
9.2
"BLD",5937,"KRN",9.8,0)
9.8
"BLD",5937,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",5937,"KRN",9.8,"NM",1,0)
LRUPS^^0^B8370560
"BLD",5937,"KRN",9.8,"NM",2,0)
LRCAPMA^^0^B3686642
"BLD",5937,"KRN",9.8,"NM",3,0)
LRAUDA^^0^B5184827
"BLD",5937,"KRN",9.8,"NM",4,0)
LRCAPML^^0^B3486620
"BLD",5937,"KRN",9.8,"NM",5,0)
LRARCML^^0^B2735123
"BLD",5937,"KRN",9.8,"NM","B","LRARCML",5)

"BLD",5937,"KRN",9.8,"NM","B","LRAUDA",3)

"BLD",5937,"KRN",9.8,"NM","B","LRCAPMA",2)

"BLD",5937,"KRN",9.8,"NM","B","LRCAPML",4)

"BLD",5937,"KRN",9.8,"NM","B","LRUPS",1)

"BLD",5937,"KRN",19,0)
19
"BLD",5937,"KRN",19.1,0)
19.1
"BLD",5937,"KRN",101,0)
101
"BLD",5937,"KRN",409.61,0)
409.61
"BLD",5937,"KRN",771,0)
771
"BLD",5937,"KRN",870,0)
870
"BLD",5937,"KRN",8989.51,0)
8989.51
"BLD",5937,"KRN",8989.52,0)
8989.52
"BLD",5937,"KRN",8994,0)
8994
"BLD",5937,"KRN","B",.4,.4)

"BLD",5937,"KRN","B",.401,.401)

"BLD",5937,"KRN","B",.402,.402)

"BLD",5937,"KRN","B",.403,.403)

"BLD",5937,"KRN","B",.5,.5)

"BLD",5937,"KRN","B",.84,.84)

"BLD",5937,"KRN","B",3.6,3.6)

"BLD",5937,"KRN","B",3.8,3.8)

"BLD",5937,"KRN","B",9.2,9.2)

"BLD",5937,"KRN","B",9.8,9.8)

"BLD",5937,"KRN","B",19,19)

"BLD",5937,"KRN","B",19.1,19.1)

"BLD",5937,"KRN","B",101,101)

"BLD",5937,"KRN","B",409.61,409.61)

"BLD",5937,"KRN","B",771,771)

"BLD",5937,"KRN","B",870,870)

"BLD",5937,"KRN","B",8989.51,8989.51)

"BLD",5937,"KRN","B",8989.52,8989.52)

"BLD",5937,"KRN","B",8994,8994)

"BLD",5937,"QUES",0)
^9.62^^
"BLD",5937,"REQB",0)
^9.611^3^2
"BLD",5937,"REQB",2,0)
LR*5.2*248^1
"BLD",5937,"REQB",3,0)
LR*5.2*259^2
"BLD",5937,"REQB","B","LR*5.2*248",2)

"BLD",5937,"REQB","B","LR*5.2*259",3)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950611
"PKG",26,22,1,"PAH",1,0)
322^3050606^520637395
"PKG",26,22,1,"PAH",1,1,0)
^^5^5^3050606
"PKG",26,22,1,"PAH",1,1,1,0)
The three problems addressed in this patch were originally described in
"PKG",26,22,1,"PAH",1,1,2,0)
the following NOIS calls:
"PKG",26,22,1,"PAH",1,1,3,0)
DAY-0204-42022 - EN+13~LRUPS undefined variable
"PKG",26,22,1,"PAH",1,1,4,0)
BHS-0804-11324 - <UNDEFINED>B+2^LRAUDA ERROR
"PKG",26,22,1,"PAH",1,1,5,0)
LON-0904-61172 - MAJOR SECTION REPORT, BOTH SCROLLING AND PRINTING
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","LRARCML")
0^5^B2735123
"RTN","LRARCML",1,0)
LRARCML ;DALISC/CKA  -  ARCHIVED WKLD COST REPORT BY MAJ SCTN; 5/22/95
"RTN","LRARCML",2,0)
 ;;5.2;LAB SERVICE;**59,322**;Aug 31, 1995
"RTN","LRARCML",3,0)
 ;same as LRCAPML except archived wkld file
"RTN","LRARCML",4,0)
EN ;
"RTN","LRARCML",5,0)
 ; GET THE PARAMETERS
"RTN","LRARCML",6,0)
 S (LRSUMM,LREND)=0,LRNDFN="UNDEFINED"
"RTN","LRARCML",7,0)
 ;Check for lab archival activity in archived status
"RTN","LRARCML",8,0)
 S LRART=64.1,LRARC=0 S LRARC=$O(^LAB(95.11,"O",2,LRART,LRARC))
"RTN","LRARCML",9,0)
 I LRARC="" D ERROR
"RTN","LRARCML",10,0)
 D ASKCOM^LRARCMR2
"RTN","LRARCML",11,0)
 D ^LRARCMR
"RTN","LRARCML",12,0)
 I 'LREND D
"RTN","LRARCML",13,0)
 . I IO'=IO(0) D LOAD Q
"RTN","LRARCML",14,0)
 . D DQ
"RTN","LRARCML",15,0)
 D CLEAN
"RTN","LRARCML",16,0)
 Q
"RTN","LRARCML",17,0)
DQ ;
"RTN","LRARCML",18,0)
 K ^TMP("LRAR-WL",$J)
"RTN","LRARCML",19,0)
 S (LREND,LRLOOP,LRBLDONE)=0
"RTN","LRARCML",20,0)
 S:$D(ZTQUEUED) ZTREQ="@" K ZTSK
"RTN","LRARCML",21,0)
 I 'LRIN S LRLOOP=1
"RTN","LRARCML",22,0)
 D EN^LRARCML1
"RTN","LRARCML",23,0)
 D EN^LRARCML2
"RTN","LRARCML",24,0)
 D:$D(ZTQUEUED) CLEAN
"RTN","LRARCML",25,0)
 Q
"RTN","LRARCML",26,0)
LOAD ;
"RTN","LRARCML",27,0)
 S ZTDESC="WKLD STATS BY MAJ SEC REP"
"RTN","LRARCML",28,0)
 S ZTRTN="DQ^LRARCML",ZTSAVE("LR*")=""
"RTN","LRARCML",29,0)
 D ^%ZTLOAD
"RTN","LRARCML",30,0)
 Q
"RTN","LRARCML",31,0)
CLEAN ;
"RTN","LRARCML",32,0)
 W !! W:$E(IOST,1,2)="P-" @IOF D ^%ZISC,PRTCLN^LRARCU,WKLDCLN^LRARCU,CLNMAN^LRARCMR1
"RTN","LRARCML",33,0)
 K ^TMP("LRAR-WL",$J)
"RTN","LRARCML",34,0)
 D KILLALL^LRARCU
"RTN","LRARCML",35,0)
 Q
"RTN","LRARCML",36,0)
ERROR W !!,$C(7),"This file does not have an archival activity with the status of archived."
"RTN","LRARCML",37,0)
 W !,"Therefore this file may be incomplete if archiving is still in progress."
"RTN","LRARCML",38,0)
 W !!
"RTN","LRARCML",39,0)
 Q
"RTN","LRAUDA")
0^3^B5184827
"RTN","LRAUDA",1,0)
LRAUDA ;AVAMC/REG/WTY/KLL - AUTOPSY PATH DATA ENTRY ;08/20/01
"RTN","LRAUDA",2,0)
 ;;5.2;LAB SERVICE;**72,248,259,322**;Sep 27, 1994
"RTN","LRAUDA",3,0)
 ;
"RTN","LRAUDA",4,0)
L ;Define AU Section
"RTN","LRAUDA",5,0)
 S LRDICS="AU",LRQUIT=0,XPAD=""
"RTN","LRAUDA",6,0)
 D ^LRAP
"RTN","LRAUDA",7,0)
 I '$D(Y) D
"RTN","LRAUDA",8,0)
 .S LRQUIT=1
"RTN","LRAUDA",9,0)
 Q
"RTN","LRAUDA",10,0)
P ;Autopsy Protocol
"RTN","LRAUDA",11,0)
 D L
"RTN","LRAUDA",12,0)
 I LRQUIT D END Q
"RTN","LRAUDA",13,0)
 D PDR
"RTN","LRAUDA",14,0)
 S LRSOP="P",LR(6)=1
"RTN","LRAUDA",15,0)
 D EDIT
"RTN","LRAUDA",16,0)
 Q
"RTN","LRAUDA",17,0)
PDR ;Entry for resetting DR string
"RTN","LRAUDA",18,0)
 K DR
"RTN","LRAUDA",19,0)
 ;KLL-RESET PAD SEPARATE FROM PROTOCOL
"RTN","LRAUDA",20,0)
 S:XPAD'="D" DR="13;13.01///^S X=LRWHO;32.1;32.2;32.3;99"
"RTN","LRAUDA",21,0)
 S:XPAD="D" DR="13.01///^S X=LRWHO;32.2;32.3;14.9"
"RTN","LRAUDA",22,0)
 Q
"RTN","LRAUDA",23,0)
PAD ;Provisional Anatomic Diagnoses
"RTN","LRAUDA",24,0)
 D L
"RTN","LRAUDA",25,0)
 I LRQUIT D END Q
"RTN","LRAUDA",26,0)
 K DR S DR="13.01///^S X=LRWHO;32.2;32.3;14.9"
"RTN","LRAUDA",27,0)
 ;KLL-S XPAD=D TO KEEP PAD SEPARATE FROM PROTOCOL
"RTN","LRAUDA",28,0)
 S XPAD="D"
"RTN","LRAUDA",29,0)
 ;
"RTN","LRAUDA",30,0)
 S LRSOP="P",LR(6)=1
"RTN","LRAUDA",31,0)
 D EDIT
"RTN","LRAUDA",32,0)
 Q
"RTN","LRAUDA",33,0)
 ;
"RTN","LRAUDA",34,0)
S ;Special Studies
"RTN","LRAUDA",35,0)
 D L
"RTN","LRAUDA",36,0)
 I LRQUIT D END Q
"RTN","LRAUDA",37,0)
 K DR
"RTN","LRAUDA",38,0)
 S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS) "
"RTN","LRAUDA",39,0)
 S DR=DR_"I LRREL(1) D VMSG^LRAUDA S Y=0;32"
"RTN","LRAUDA",40,0)
 S DR(2,63.2)=".01;5"
"RTN","LRAUDA",41,0)
 D EDIT
"RTN","LRAUDA",42,0)
 Q
"RTN","LRAUDA",43,0)
B ;Autopsy Report/SNOMED Coding
"RTN","LRAUDA",44,0)
 D L
"RTN","LRAUDA",45,0)
 I LRQUIT D END Q
"RTN","LRAUDA",46,0)
 S LR(2)=1
"RTN","LRAUDA",47,0)
 D BDR
"RTN","LRAUDA",48,0)
 D EDIT
"RTN","LRAUDA",49,0)
 Q
"RTN","LRAUDA",50,0)
BDR ;Entry for resetting DR string
"RTN","LRAUDA",51,0)
 K DR S DR="13;13.01///^S X=LRWHO;32.1;32.2;32.3;99;32"
"RTN","LRAUDA",52,0)
 S DR(2,63.2)=".01;I '$D(LR(1)) S Y=4;1;1.5;3;4"
"RTN","LRAUDA",53,0)
 S DR(3,63.21)=".01",DR(3,63.22)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAUDA",54,0)
 S DR(3,63.24)=".01;S:'$P(^LAB(61.5,X,0),U,3) Y=0;.02"
"RTN","LRAUDA",55,0)
 S DR(4,63.23)=".01",LRSOP="B"
"RTN","LRAUDA",56,0)
 Q
"RTN","LRAUDA",57,0)
 ;
"RTN","LRAUDA",58,0)
A ;Autopsy Report/ICD9CM Coding
"RTN","LRAUDA",59,0)
 D L
"RTN","LRAUDA",60,0)
 I LRQUIT D END Q
"RTN","LRAUDA",61,0)
 D ADR
"RTN","LRAUDA",62,0)
 S LRSOP="A"
"RTN","LRAUDA",63,0)
 D EDIT
"RTN","LRAUDA",64,0)
 Q
"RTN","LRAUDA",65,0)
ADR ;Entry for resetting DR string
"RTN","LRAUDA",66,0)
 K DR S DR="13;13.01///^S X=LRWHO;32.1;32.2;32.3;99;80"
"RTN","LRAUDA",67,0)
 Q
"RTN","LRAUDA",68,0)
R ;Autopsy Supplementary Report
"RTN","LRAUDA",69,0)
 D L
"RTN","LRAUDA",70,0)
 I LRQUIT D END Q
"RTN","LRAUDA",71,0)
 S LRSOP="R",LRSFLG="S"
"RTN","LRAUDA",72,0)
 D EDIT
"RTN","LRAUDA",73,0)
 K LRSFLG
"RTN","LRAUDA",74,0)
 Q
"RTN","LRAUDA",75,0)
I ;ICD9CM coding
"RTN","LRAUDA",76,0)
 D L
"RTN","LRAUDA",77,0)
 I LRQUIT D END Q
"RTN","LRAUDA",78,0)
 I '$D(Y) D END Q
"RTN","LRAUDA",79,0)
 S DR=80,LRSOP="I"
"RTN","LRAUDA",80,0)
 D EDIT
"RTN","LRAUDA",81,0)
 Q
"RTN","LRAUDA",82,0)
F ;Final Anatomic DX Date
"RTN","LRAUDA",83,0)
 D L
"RTN","LRAUDA",84,0)
 I LRQUIT D END Q
"RTN","LRAUDA",85,0)
 K DR S DR="13.1;83.1;83.2"
"RTN","LRAUDA",86,0)
 S LRSOP="F"
"RTN","LRAUDA",87,0)
 D EDIT
"RTN","LRAUDA",88,0)
 Q
"RTN","LRAUDA",89,0)
VMSG ;Verified message
"RTN","LRAUDA",90,0)
 N LRMSG
"RTN","LRAUDA",91,0)
 S LRMSG=$C(7)_"Report verified.  Cannot edit with this option."
"RTN","LRAUDA",92,0)
 D EN^DDIOL(LRMSG,"","!!")
"RTN","LRAUDA",93,0)
 Q
"RTN","LRAUDA",94,0)
EDIT ;
"RTN","LRAUDA",95,0)
 D ^LRAPDA
"RTN","LRAUDA",96,0)
END ;
"RTN","LRAUDA",97,0)
 K LRQUIT
"RTN","LRAUDA",98,0)
 D V^LRU
"RTN","LRAUDA",99,0)
 Q
"RTN","LRCAPMA")
0^2^B3686642
"RTN","LRCAPMA",1,0)
LRCAPMA ;SLC/AM/DALISC/FHS/J0  -  WKLD REPORT BY MAJOR SECTION; 2/6/91@16:04
"RTN","LRCAPMA",2,0)
 ;;5.2;LAB SERVICE;**322**;Sep 27, 1994
"RTN","LRCAPMA",3,0)
EN ;
"RTN","LRCAPMA",4,0)
 ; GET THE PARAMETERS
"RTN","LRCAPMA",5,0)
 S (LRSUMM,LREND)=0,LRNDFN="UNDEFINED"
"RTN","LRCAPMA",6,0)
 D ASKCOM^LRCAPMR2
"RTN","LRCAPMA",7,0)
 D ^LRCAPMR
"RTN","LRCAPMA",8,0)
 I 'LREND D
"RTN","LRCAPMA",9,0)
 . I IO'=IO(0) D LOAD Q
"RTN","LRCAPMA",10,0)
 . D DQ
"RTN","LRCAPMA",11,0)
 D CLEAN
"RTN","LRCAPMA",12,0)
 Q
"RTN","LRCAPMA",13,0)
DQ ;
"RTN","LRCAPMA",14,0)
 K ^TMP("LR-WL",$J)
"RTN","LRCAPMA",15,0)
 S (LREND,LRLOOP,LRBLDONE)=0
"RTN","LRCAPMA",16,0)
 S (LRCGT,LRIGT,LROGT,LRNGT)=0
"RTN","LRCAPMA",17,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","LRCAPMA",18,0)
 I 'LRIN S LRLOOP=1
"RTN","LRCAPMA",19,0)
 D EN^LRCAPMA1
"RTN","LRCAPMA",20,0)
 D EN^LRCAPMA2
"RTN","LRCAPMA",21,0)
 D:$D(ZTQUEUED) CLEAN
"RTN","LRCAPMA",22,0)
 Q
"RTN","LRCAPMA",23,0)
LOAD ;
"RTN","LRCAPMA",24,0)
 S ZTDESC="WKLD STATS BY MAJ SEC REP"
"RTN","LRCAPMA",25,0)
 S ZTRTN="DQ^LRCAPMA",ZTSAVE("LR*")=""
"RTN","LRCAPMA",26,0)
 D ^%ZTLOAD
"RTN","LRCAPMA",27,0)
 Q
"RTN","LRCAPMA",28,0)
CLEAN ;
"RTN","LRCAPMA",29,0)
 D ^%ZISC,PRTCLN^LRCAPU,WKLDCLN^LRCAPU,CLNMAN^LRCAPMR1
"RTN","LRCAPMA",30,0)
 K ^TMP("LR-WL",$J)
"RTN","LRCAPMA",31,0)
 K LRANS,LRCC,LRCDT,LRCTM,LRCW,LRCGT,LRIGT,LROGT,LRNGT,LRQC,LRRPT,LRST
"RTN","LRCAPMA",32,0)
 K LRTC,LRMA,LRMAN,LRLSS,LRLSSN,LRUC,LRX,LRTSN,LRPAG,LRBLDONE,LRGETIN
"RTN","LRCAPMA",33,0)
 K LRGT,LRSTD,LRX1,LRX2,LRAGT,LRGTOTS,LRSUMM,LRNDFN,LRAA,LRTYP,LRZTSK
"RTN","LRCAPMA",34,0)
 K LREND,LRIN,LRINN,LRCDTB,LRCTMB,LRDT1,LRCDTE,LRCTME,LRDT2,LRLOOP,LRLAB
"RTN","LRCAPMA",35,0)
 K LRGTREC,LRREC,LRMAA,LRLSSA,LRLDIV,LRAPICGT,LRAPIIGT,LRAPINGT,LRAPIOGT
"RTN","LRCAPMA",36,0)
 K LRCPICGT,LRCPIIGT,LRCPINGT,LRCPIOGT,LRIAGT,LRICGT,LRIIGT,LRINGT,LRIOGT
"RTN","LRCAPMA",37,0)
 K LRCOM,LRCOMM,LRMNODE,LRSQRM,LRCM
"RTN","LRCAPMA",38,0)
 K ZTDESC,ZTIO,ZTRTN,ZTSAVE,ZTSK,ZTQUEUED,%IO,%ZIS
"RTN","LRCAPMA",39,0)
 K DTOUT,DUOUT,DIRUT,DIC,DIR,%DT,Y1,Y2,DX,DY,X,Y
"RTN","LRCAPMA",40,0)
 Q
"RTN","LRCAPML")
0^4^B3486620
"RTN","LRCAPML",1,0)
LRCAPML ;SLC/AM/DALISC/FHS/J0  -  WKLD COST REPORT BY MAJ SCTN; 2/6/91@16:04
"RTN","LRCAPML",2,0)
 ;;5.2;LAB SERVICE;**59,322**;Sep 27, 1994
"RTN","LRCAPML",3,0)
EN ;
"RTN","LRCAPML",4,0)
 ; GET THE PARAMETERS
"RTN","LRCAPML",5,0)
 S (LRSUMM,LREND)=0,LRNDFN="UNDEFINED"
"RTN","LRCAPML",6,0)
 D ASKCOM^LRCAPMR2
"RTN","LRCAPML",7,0)
 D ^LRCAPMR
"RTN","LRCAPML",8,0)
 I 'LREND D
"RTN","LRCAPML",9,0)
 . I IO'=IO(0) D LOAD Q
"RTN","LRCAPML",10,0)
 . D DQ
"RTN","LRCAPML",11,0)
 D CLEAN
"RTN","LRCAPML",12,0)
 Q
"RTN","LRCAPML",13,0)
DQ ;
"RTN","LRCAPML",14,0)
 K ^TMP("LR-WL",$J)
"RTN","LRCAPML",15,0)
 S (LREND,LRLOOP,LRBLDONE)=0
"RTN","LRCAPML",16,0)
 S:$D(ZTQUEUED) ZTREQ="@" K ZTSK
"RTN","LRCAPML",17,0)
 I 'LRIN S LRLOOP=1
"RTN","LRCAPML",18,0)
 D EN^LRCAPML1
"RTN","LRCAPML",19,0)
 D EN^LRCAPML2
"RTN","LRCAPML",20,0)
 D:$D(ZTQUEUED) CLEAN
"RTN","LRCAPML",21,0)
 Q
"RTN","LRCAPML",22,0)
LOAD ;
"RTN","LRCAPML",23,0)
 S ZTDESC="WKLD STATS BY MAJ SEC REP"
"RTN","LRCAPML",24,0)
 S ZTRTN="DQ^LRCAPML",ZTSAVE("LR*")=""
"RTN","LRCAPML",25,0)
 D ^%ZTLOAD
"RTN","LRCAPML",26,0)
 Q
"RTN","LRCAPML",27,0)
CLEAN ;
"RTN","LRCAPML",28,0)
 W !! W:$E(IOST,1,2)="P-" @IOF D ^%ZISC,PRTCLN^LRCAPU,WKLDCLN^LRCAPU,CLNMAN^LRCAPMR1
"RTN","LRCAPML",29,0)
 K ^TMP("LR-WL",$J)
"RTN","LRCAPML",30,0)
 K LRANS,LRCC,LRCDT,LRCTM,LRCW,LRUW,LRWC,LRIGT,LRIGTU,LRQC,LRRPT,LRST
"RTN","LRCAPML",31,0)
 K LRTC,LRMA,LRMAN,LRLSS,LRLSSN,LRUC,LRX,LRTSN,LRPAG,LRBLDONE,LRGETIN
"RTN","LRCAPML",32,0)
 K LRGT,LRSTD,LRX1,LRX2,LRAGT,LRGTOTS,LRSUMM,LRNDFN,LRAA,LRTYP,LRZTSK
"RTN","LRCAPML",33,0)
 K LREND,LRIN,LRINN,LRCDTB,LRCTMB,LRDT1,LRCDTE,LRCTME,LRDT2,LRLOOP,LRLAB
"RTN","LRCAPML",34,0)
 K LRGTREC,LRREC,LRMAA,LRLSSA,LRLDIV,LRAPIGT,LRAPIGTU,LRCPIGT,LRCPIGTU
"RTN","LRCAPML",35,0)
 K LRFIRST,LRGTU,LRCOM,LRCOMM,LRMNODE,LRSQRM,LRSTU,LRCM
"RTN","LRCAPML",36,0)
 K ZTDESC,ZTIO,ZTRTN,ZTSAVE,ZTSK,ZTQUEUED,%IO,%ZIS
"RTN","LRCAPML",37,0)
 K DTOUT,DUOUT,DIRUT,DIC,DIR,%DT,Y1,Y2,DX,DY,X,Y
"RTN","LRCAPML",38,0)
 Q
"RTN","LRUPS")
0^1^B8370560
"RTN","LRUPS",1,0)
LRUPS ;AVAMC/REG/WTY - PATIENT SPEC LOOK-UP ;3/20/01
"RTN","LRUPS",2,0)
 ;;5.2;LAB SERVICE;**72,248,259,322**;Sep 27, 1994
"RTN","LRUPS",3,0)
 ;Removed space between "No  data" at tag EN
"RTN","LRUPS",4,0)
 ;
"RTN","LRUPS",5,0)
GETP W ! K LRAN,DIC S X="",DFN=-1,DIC(0)="EQM",(LRX,LRDPF)="" D DPA^LRDPA
"RTN","LRUPS",6,0)
 I DFN=-1 S LRAN=-1 Q
"RTN","LRUPS",7,0)
I N LRAY
"RTN","LRUPS",8,0)
 I '$D(LRPFLG) N LRPFLG S LRPFLG=0
"RTN","LRUPS",9,0)
 I LRSS="AU" G AU
"RTN","LRUPS",10,0)
EN I '$D(^LR(LRDFN,LRSS))!($P($G(^LR(LRDFN,LRSS,0)),U,3)<1) W $C(7),!!,"No data for ",PNM G GETP
"RTN","LRUPS",11,0)
 S (LRI,LRLIDT,E)=0 S:'$D(LRABV) LRABV=0
"RTN","LRUPS",12,0)
 I "CYEMSP"'[LRSS W !!,"Count #",?10,"Accession #",?29,"Date",?45,"Site/specimen"
"RTN","LRUPS",13,0)
 E  W !!,"Specimen(s)",?30,"Count #",?40,"Accession #",?55,"Date Obtained"
"RTN","LRUPS",14,0)
 S C=0
"RTN","LRUPS",15,0)
 F  S LRI=$O(^LR(LRDFN,LRSS,LRI)) Q:'LRI!(E)  D
"RTN","LRUPS",16,0)
 .S X=^LR(LRDFN,LRSS,LRI,0),LRAC=$P(X,U,6)
"RTN","LRUPS",17,0)
 .I $P(LRAC," ")=LRABV!(LRABV=0) D WT:C#5=0 Q:E  D
"RTN","LRUPS",18,0)
 ..S LRAY=$P(LRAC," ",2)
"RTN","LRUPS",19,0)
 ..I LRPFLG,LRAY'=$E(LRAD,2,3) Q
"RTN","LRUPS",20,0)
 ..S C=C+1,LRAN=+$P(LRAC," ",3)
"RTN","LRUPS",21,0)
 ..S LRAN(C)=LRI_U_LRAN,LRLIDT=LRI
"RTN","LRUPS",22,0)
 ..S Y=$P(X,U),LRST=$P(X,U,5) D D^LRU,@($S("CYEMSP"[LRSS:"SP",1:"CY"))
"RTN","LRUPS",23,0)
 I 'C W !!,"No specimens entered for "_LRH(0) G GETP
"RTN","LRUPS",24,0)
 I C=1 S LRI=+LRAN(1),Y(0)=^LR(LRDFN,LRSS,LRI,0),LRTK=+Y(0) G L
"RTN","LRUPS",25,0)
ACC W !?11,"Choose Count #(1-",C,"): " R X:DTIME I X=""!(X[U) S LRAN=-1 Q
"RTN","LRUPS",26,0)
 I X'?1N.N W $C(7),!!,"Enter numbers only",!! G ACC
"RTN","LRUPS",27,0)
OK I '$D(LRAN(X)) W "  Doesn't exist for ",PNM G ACC
"RTN","LRUPS",28,0)
GOT S LRI=+LRAN(X),Y(0)=^LR(LRDFN,LRSS,LRI,0),LRTK=+Y(0)
"RTN","LRUPS",29,0)
L S LRAC=$P(Y(0),U,6),LRAN=+$P(LRAC," ",3),Y=$P(Y(0),U) D D^LRU W !!," Accession #: ",LRAC W:Y'[1700 " Date Obtained: ",Y,! S LRWW=$S(Y'[1700:Y,1:"")
"RTN","LRUPS",30,0)
 Q
"RTN","LRUPS",31,0)
WT I C>0 W !,"More accessions " S %=2 D YN^LRU S E=$S(%=1:0,1:1) Q
"RTN","LRUPS",32,0)
 Q
"RTN","LRUPS",33,0)
SP W !?30,"(",$J(C,2),")",?40,LRAC,?55,Y I '$P(X,"^",11) W " not verified"
"RTN","LRUPS",34,0)
 S LRST=0 F A=0:1 S LRST=$O(^LR(LRDFN,LRSS,LRI,.1,LRST)) Q:'LRST  W:$D(^(LRST,0)) !,$P(^(0),"^")
"RTN","LRUPS",35,0)
 Q
"RTN","LRUPS",36,0)
CY W !?2,"(",$J(C,2),")",?10,LRAC,?25,Y W:LRST ?45,$S($D(^LAB(61,LRST,0)):$E($P(^(0),U),1,34),1:"") Q
"RTN","LRUPS",37,0)
AU S LRND=$G(^LR(LRDFN,"AU"))
"RTN","LRUPS",38,0)
 I '$L(LRND) W $C(7),!!,"No autopsy entry for ",LRP,!! S LRAN="?" Q
"RTN","LRUPS",39,0)
 S LRAC=$P(LRND,U,6)
"RTN","LRUPS",40,0)
 I $P(LRAC," ")'=LRABV W $C(7),!!,"No autopsy accession" S LRAN="?" Q
"RTN","LRUPS",41,0)
 S LRAY=$P(LRAC," ",2)
"RTN","LRUPS",42,0)
 I LRPFLG,LRAY'=$E(LRAD,2,3) D  Q
"RTN","LRUPS",43,0)
 .W $C(7),!!,"No autopsy accession for "_LRH(0) S LRAN="?"
"RTN","LRUPS",44,0)
 S LRAN=+$P(LRAC," ",3)
"RTN","LRUPS",45,0)
 I 'LRAN S LRAN=-1 W $C(7),!!,"No autopsy # for ",LRP Q
"RTN","LRUPS",46,0)
 S Y=+LRND D D^LRU W !,"Autopsy performed: ",Y,"  Acc # ",LRAC
"RTN","LRUPS",47,0)
 Q
"RTN","LRUPS",48,0)
EN1 ;from LRAPMOD, LRSPRPT, LRSPT
"RTN","LRUPS",49,0)
 W ! K DIC,LRAN S DIC(0)="EQM",(LRX,LRDPF)="" D DPA^LRDPA I DFN=-1 S LRAN=-1 Q
"RTN","LRUPS",50,0)
 G I
"VER")
8.0^22.0
"BLD",5937,6)
^SEQ #257
**END**
**END**
