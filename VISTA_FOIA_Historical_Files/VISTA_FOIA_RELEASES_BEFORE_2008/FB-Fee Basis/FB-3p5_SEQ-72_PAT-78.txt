$TXT Created by BAUMANN,SCOTT A at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Thursday, 04/22/04 at 15:04
=============================================================================
Run Date: AUG 04, 2004                     Designation: FB*3.5*78
Package : FB - FEE BASIS                      Priority: Mandatory
Version : 3.5        SEQ #72                    Status: Released
                  Compliance Date: SEP 04, 2004
=============================================================================

Associated patches: (v)FB*3.5*14   <<= must be installed BEFORE `FB*3.5*78'
                    (v)FB*3.5*16   <<= must be installed BEFORE `FB*3.5*78'

Subject: ENCAPSULATION PROJECT APIS

Category: 
  - Enhancement (Mandatory)
  - Routine

Description:
============

 This enhancement patch introduces two new application program interfaces
 (APIs) and modifies one existing API to support encapsulation of VistA Fee
 Basis.  The APIs are provided for other VistA applications that need to
 obtain Fee Basis data.
  
 ******************************** N O T E ********************************
 There is no conflict between this patch and the FB-CoreFLS software.
 Installation of this patch by the CoreFLS sites will not cause any
 problems.
 *************************************************************************
  
 Associated NOIS:
 ================
 N/A
  
 Associated E3R:
 ===============
 N/A 
  
 Test Sites:
 =============
 Big Spring, TX
 Durham, NC
 Greater Los Angeles, CA
 Manchester, NH
 Walla Walla, WA
  
  
 The changes made by this patch are described below:
  
 1. ADD NEW API $$RSXUM^FBRXUTL()
  
    The Outpatient Pharmacy package obtains fee pharmacy data by directly 
    reading the global of the FEE BASIS PHARMACY INVOICE (#162.1) file per
    integration agreement #203.
  
    This patch adds a new API, $$RXSUM^FBRXUTL(), that will provide the
    count and cost of prescriptions for a given date. This new API is
    documented by integration agreement #4395.
  
    The Outpatient Pharmacy package will be modified by a separate patch to
    call the $$RXSUM^FBRXUTL() API instead of directly accessing the Fee
    Basis global.  This should isolate the Outpatient Pharmacy package from
    future changes as the fee replacement system is implemented.
  
  
 2. ADD NEW API $$AUTHL^FBUTL()
  
    The Scheduling package obtains fee authorization data by directly 
    reading the global of the FEE BASIS PATIENT (#161) file per integration
    agreement #2459.
  
    This patch adds a new API, $$AUTHL^FBUTL(), that will provide
    authorization data for a given patient. This new API is documented by
    integration agreement #4396.
  
    The Scheduling package will be modified by a separate patch to call the
    $$AUTHL^FBUTL() API instead of directly accessing the Fee Basis
    global.  This should isolate the Scheduling package from future changes
    as the fee replacement system is implemented.
  
  
 3. MODIFY EXISTING API EN^FBHLZFE()
  
    The Income Verification Match (IVM) package obtains HL7 ZFE segments 
    that contain fee authorization data for a patient by calling API
    EN^FBHLZFE() per integration agreement #2485.
  
    This patch modifies EN^FBHLZFE() so exceptions are checked for and
    reported back to the calling application.  If an exception occurs, the
    API will return FBZFE(0) = -1 ^ exception number ^ exception text
  
    List of exceptions
      -1^101^Valid date not specified.
      -1^103^Patient DFN not specified.
      -1^104^ICN could not be determined for the specified patient.
      -1^110^Database Unavailable.
      -1^201^HL7 variables not defined.
  
    If an exception does not occur, then FBZFE(0) will not be defined.
  
    The IVM package will ignore any reported exceptions from Fee Basis.
  
  
 ====================== INSTALLATION INSTRUCTIONS ====================== 
  
 *** IMPORTANT NOTE ***
 This patch should NOT be installed when the IVM BACKGROUND JOB is
 scheduled to run since that job calls the EN^FBHLZFE() API.  Other VISTA
 users will not be affected by installation of this patch.
  
 Install Time -
   The estimated install time for this patch is approximately 2 minutes.
  
  1.  LOAD TRANSPORT GLOBAL 
      ---------------------
      Choose the PackMan message containing this patch and invoke the 
      INSTALL/CHECK MESSAGE PackMan option.  
              
  2.  DISABLE ROUTINE MAPPING   (DSM for Open VMS sites only) 
      -----------------------
      Disable routine mapping on all systems for the routines listed in 
      step 3 below.  
      NOTE:  If the routines included in this patch are not currently in 
      your mapped routine set, please skip this step.
   
  3.  COMPONENTS SENT WITH PATCH 
      --------------------------
      The following is a list of the routines included in this patch.  
      The second line of each of these routines now looks like: 
     
          ;;3.5;FEE BASIS;**[patch list]**;JAN 30, 1995 
   
                   CHECK^XTSUMBLD results
  
        Routine   Before Patch  After Patch  Patch List 
        --------  ------------  -----------  ----------
        FBHLZFE   3852916       6364473      14,78
        FBRXUTL   new           2132784      78
        FBUTL     877870        4811852      16,78
  
           Total number of routines - 3
           Total number of new routines - 1
   
  4.  START UP KIDS 
      -------------
      Start up the Kernel Installation and Distribution System Menu 
      [XPD MAIN]: 
    
           Edits and Distribution ...  
           Utilities ...  
           Installation ...  
    
      Select Kernel Installation & Distribution System Option: INStallation
                                                               ---
           Load a Distribution 
           Print Transport Global 
           Compare Transport Global to Current System 
           Verify Checksums in Transport Global 
           Install Package(s) 
           Restart Install of Package(s) 
           Unload a Distribution 
           Backup a Transport Global 
    
      Select Installation Option: 
    
  5.  Select Installation Option: 
      --------------------------
      NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
             NAME, enter FB*3.5*78):
       
      a.  Backup a Transport Global - This option will create a backup
          message of any routines exported with this patch.  It will not
          backup any other changes such as DD's or templates.
      b.  Compare Transport Global to Current System - This option will
          allow you to view all changes that will be made when this patch
          is installed.  It compares all components of this patch
          (routines, DD's, templates, etc.).
      c.  Verify Checksums in Transport Global - This option will allow
          you to ensure the integrity of the routines that are in the
          transport global.
      
  6.  Select Installation Option: Install Package(s) 
                                  ----------------
      **This is the step to start the installation of this KIDS patch: 
    
      a.  Choose the Install Package(s) option to start the patch install.
      b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install?
          YES//' answer NO.
      c.  When prompted 'Want to DISABLE Scheduled Options, Menu Options,
          and Protocols? YES//' answer NO.
  
  7.  REBUILD MAPPED ROUTINE(S)  (DSM for Open VMS sites only)
      -------------------------
      Optional - Include the routines distributed with this patch in the
      mapped routine set.
      
      NOTE: This step is only necessary if you performed step 2 or if you
      wish to include the routines in your mapped set.

Routine Information:
====================

Routine Name:
  - FBHLZFE

 Check for exceptions.

Routine Checksum:

Routine Name:
  - FBRXUTL

 Add new API $$RXSUM^FBRXUTL().

Routine Checksum:

Routine Name:
  - FBUTL

 Add new API $$AUTHL^FBUTL().

Routine Checksum:

=============================================================================
User Information:
Entered By  : BAUMANN,SCOTT A               Date Entered  : MAR 24, 2004
Completed By: TORRANCE,LORI                 Date Completed: AUG 04, 2004
Released By : JACKSON,SHERYL                Date Released : AUG 04, 2004
=============================================================================


Packman Mail Message:
=====================

$END TXT
