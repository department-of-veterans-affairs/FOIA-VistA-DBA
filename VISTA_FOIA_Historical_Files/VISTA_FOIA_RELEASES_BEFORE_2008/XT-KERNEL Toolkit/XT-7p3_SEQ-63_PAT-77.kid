Released XT*7.3*77 SEQ #63
Extracted from mail message
**KIDS**:XT*7.3*77^

**INSTALL NAME**
XT*7.3*77
"BLD",769,0)
XT*7.3*77^TOOLKIT^0^3030805^y
"BLD",769,4,0)
^9.64PA^^
"BLD",769,"ABPKG")
n
"BLD",769,"KRN",0)
^9.67PA^8989.52^19
"BLD",769,"KRN",.4,0)
.4
"BLD",769,"KRN",.401,0)
.401
"BLD",769,"KRN",.402,0)
.402
"BLD",769,"KRN",.403,0)
.403
"BLD",769,"KRN",.5,0)
.5
"BLD",769,"KRN",.84,0)
.84
"BLD",769,"KRN",3.6,0)
3.6
"BLD",769,"KRN",3.8,0)
3.8
"BLD",769,"KRN",9.2,0)
9.2
"BLD",769,"KRN",9.8,0)
9.8
"BLD",769,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",769,"KRN",9.8,"NM",1,0)
XDRDVAL2^^0^B40608530
"BLD",769,"KRN",9.8,"NM","B","XDRDVAL2",1)

"BLD",769,"KRN",19,0)
19
"BLD",769,"KRN",19.1,0)
19.1
"BLD",769,"KRN",101,0)
101
"BLD",769,"KRN",409.61,0)
409.61
"BLD",769,"KRN",771,0)
771
"BLD",769,"KRN",870,0)
870
"BLD",769,"KRN",8989.51,0)
8989.51
"BLD",769,"KRN",8989.52,0)
8989.52
"BLD",769,"KRN",8994,0)
8994
"BLD",769,"KRN","B",.4,.4)

"BLD",769,"KRN","B",.401,.401)

"BLD",769,"KRN","B",.402,.402)

"BLD",769,"KRN","B",.403,.403)

"BLD",769,"KRN","B",.5,.5)

"BLD",769,"KRN","B",.84,.84)

"BLD",769,"KRN","B",3.6,3.6)

"BLD",769,"KRN","B",3.8,3.8)

"BLD",769,"KRN","B",9.2,9.2)

"BLD",769,"KRN","B",9.8,9.8)

"BLD",769,"KRN","B",19,19)

"BLD",769,"KRN","B",19.1,19.1)

"BLD",769,"KRN","B",101,101)

"BLD",769,"KRN","B",409.61,409.61)

"BLD",769,"KRN","B",771,771)

"BLD",769,"KRN","B",870,870)

"BLD",769,"KRN","B",8989.51,8989.51)

"BLD",769,"KRN","B",8989.52,8989.52)

"BLD",769,"KRN","B",8994,8994)

"BLD",769,"QUES",0)
^9.62^^
"BLD",769,"REQB",0)
^9.611^1^1
"BLD",769,"REQB",1,0)
XT*7.3*45^1
"BLD",769,"REQB","B","XT*7.3*45",1)

"MBREQ")
0
"PKG",6,-1)
1^1
"PKG",6,0)
TOOLKIT^XT^PROGRAMMERS OPTIONS, MULTI. TERM LOOKUP^
"PKG",6,20,0)
^9.402P^^
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.3^2961029^2970513^2
"PKG",6,22,1,"PAH",1,0)
77^3030805
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XDRDVAL2")
0^1^B40608530
"RTN","XDRDVAL2",1,0)
XDRDVAL2 ;SF-IRMFO.SEA/JLI - IDENTIFY FIELDS THAT NEED CHECKING FOR MERGE ;02/07/2000  09:55
"RTN","XDRDVAL2",2,0)
 ;;7.3;TOOLKIT;**23,34,36,42,45,77**;Apr 25, 1995
"RTN","XDRDVAL2",3,0)
 ;;
"RTN","XDRDVAL2",4,0)
 Q
"RTN","XDRDVAL2",5,0)
 ;
"RTN","XDRDVAL2",6,0)
CHKMERG(FILENUM,IENFROM,IENTO,ARRAY) ;
"RTN","XDRDVAL2",7,0)
 N XDRDVALF
"RTN","XDRDVAL2",8,0)
 S XDRDVALF=1
"RTN","XDRDVAL2",9,0)
 S FILE=FILENUM D SETUP^XDRMERG(2)
"RTN","XDRDVAL2",10,0)
 D CHKFMERG(FILE,IENFROM,IENTO,ARRAY)
"RTN","XDRDVAL2",11,0)
 S XGLOB="" F  S XGLOB=$O(^TMP($J,"XGLOB",XGLOB)) Q:XGLOB=""  D
"RTN","XDRDVAL2",12,0)
 . I $P($G(^TMP($J,"XGLOB",XGLOB,0,1)),U,3)="DINUM" S F=$P(^(1),U) D CHKFMERG(F,IENFROM,IENTO,ARRAY)
"RTN","XDRDVAL2",13,0)
 Q
"RTN","XDRDVAL2",14,0)
 ;
"RTN","XDRDVAL2",15,0)
CHKFMERG(XFILNO,IENFROM,IENTO,LOCATION) ; CHECK VALIDITY FOR MERGE OF TWO ENTRIES IN FILE
"RTN","XDRDVAL2",16,0)
 N F,FILE,FILENUM,XGLOB,NODE,NODE1,NODE2,NODEA,SFILE,XDRFROM,XDRTO,NODEA,VALUE,XVALUE,XDRXX,NODEB,DIK,DA,I,Y,VREF,XNN,IENTOSTR,DFN,XDRZZ
"RTN","XDRDVAL2",17,0)
 N XDRAA ; DEBUG STATEMENT
"RTN","XDRDVAL2",18,0)
 ;
"RTN","XDRDVAL2",19,0)
 S XDRDIC=$G(^DIC(XFILNO,0,"GL")) Q:XDRDIC=""
"RTN","XDRDVAL2",20,0)
 S IENTOSTR=IENTO_","
"RTN","XDRDVAL2",21,0)
 S DFN=IENTO
"RTN","XDRDVAL2",22,0)
 ;
"RTN","XDRDVAL2",23,0)
 ; CHECK FOR BROKEN LR NODES IF PATIENT FILE
"RTN","XDRDVAL2",24,0)
 ;
"RTN","XDRDVAL2",25,0)
 ; FOLLOWING LINE MODIFIED TO INCLUDE IDENTIFIED PROBLEMS IN OUTPUT - JLI 03/23/99
"RTN","XDRDVAL2",26,0)
 I XFILNO=2 F I=IENFROM,IENTO S J=$G(^DPT(I,"LR")) I J>0,($P(^LR(J,0),U,2)'=2)!($P(^LR(J,0),U,3)'=I) S @LOCATION@(2,(I_","),63,"INVALID")="Broken ""LR"" node pointers for PATIENT file and LAB DATA FILE - DFN="_I_"   LRFN="_J
"RTN","XDRDVAL2",27,0)
 ;
"RTN","XDRDVAL2",28,0)
 ; NOW MERGE DATA GOING NODE BY NODE
"RTN","XDRDVAL2",29,0)
 ;
"RTN","XDRDVAL2",30,0)
 S NODE=""
"RTN","XDRDVAL2",31,0)
 F  D  Q:NODE=""
"RTN","XDRDVAL2",32,0)
 . S NODE1=$O(@(XDRDIC_IENFROM_","""_NODE_""")"))
"RTN","XDRDVAL2",33,0)
 . I NODE1="" S NODE="" Q  ; NOTHING MORE TO MOVE OVER
"RTN","XDRDVAL2",34,0)
 . S NODE2=$O(@(XDRDIC_IENTO_","""_NODE_""")"))
"RTN","XDRDVAL2",35,0)
 . I NODE2'="",NODE1]NODE2 S NODE=NODE2 Q  ; NODE ON TO, BUT NOT ON FROM - GO TO NEXT
"RTN","XDRDVAL2",36,0)
 . S NODE=NODE1
"RTN","XDRDVAL2",37,0)
 . I $D(@(XDRDIC_IENFROM_","""_NODE_""")"))=1 D  Q  ; SINGLE NODE, MERGE DATA
"RTN","XDRDVAL2",38,0)
 . . I NODE2]NODE1!(NODE2="") D  Q  ;  MISSING NODE, JUST MOVE IT OVER
"RTN","XDRDVAL2",39,0)
 . . . N XDRXX,FLD,N,J
"RTN","XDRDVAL2",40,0)
 . . . F N=0:0 S N=$O(^DD(XFILNO,"GL",NODE,N)) Q:N'>0  S FLD=$O(^(N,0)) I $O(^DD(XFILNO,FLD,1,0))>0 D
"RTN","XDRDVAL2",41,0)
 . . . . S X=0 F J=0:0 S J=$O(^DD(XFILNO,FLD,1,J)) Q:J'>0  I $O(^(J,0))>0 S X=1 Q
"RTN","XDRDVAL2",42,0)
 . . . . I X>0 D
"RTN","XDRDVAL2",43,0)
 . . . . . S XDRXX(XFILNO,IENTOSTR,FLD)=$$GETEXT(XDRDIC,IENFROM,XFILNO,FLD)
"RTN","XDRDVAL2",44,0)
 . . . I $D(XDRXX) D CHEKFDA("XDRXX",LOCATION)
"RTN","XDRDVAL2",45,0)
 . . I $D(@(XDRDIC_IENTO_","""_NODE_""")"))>1 Q  ; MISMATCH SKIP
"RTN","XDRDVAL2",46,0)
 . . N XDRXX,FLD
"RTN","XDRDVAL2",47,0)
 . . S X1=@(XDRDIC_IENFROM_","""_NODE_""")")
"RTN","XDRDVAL2",48,0)
 . . S (X2,X3)=@(XDRDIC_IENTO_","""_NODE_""")")
"RTN","XDRDVAL2",49,0)
 . . F XDRI=1:1 Q:X1=""  S X=$P(X1,U),X1=$P(X1,U,2,999) I X'="" D
"RTN","XDRDVAL2",50,0)
 . . . S Y=$P(X2,U,XDRI)
"RTN","XDRDVAL2",51,0)
 . . . I Y=""  D
"RTN","XDRDVAL2",52,0)
 . . . . S $P(X2,U,XDRI)=X
"RTN","XDRDVAL2",53,0)
 . . . . S FLD=$O(^DD(XFILNO,"GL",NODE,XDRI,0)) S JXFLD=FLD
"RTN","XDRDVAL2",54,0)
 . . . . I FLD>0,$O(^DD(XFILNO,FLD,1,0))>0 S XDRXX(XFILNO,IENTOSTR,FLD)=$$GETEXT(XDRDIC,IENFROM,XFILNO,FLD)
"RTN","XDRDVAL2",55,0)
 . . I X2'=X3 D
"RTN","XDRDVAL2",56,0)
 . . . I $D(XDRXX) D
"RTN","XDRDVAL2",57,0)
 . . . . N X2 D CHEKFDA("XDRXX",LOCATION)
"RTN","XDRDVAL2",58,0)
 . ;
"RTN","XDRDVAL2",59,0)
 . ; THE FOLLOWING HANDLES NODES THAT HAVE MULTIPLES
"RTN","XDRDVAL2",60,0)
 . ;
"RTN","XDRDVAL2",61,0)
 . S XDRFROM=XDRDIC_IENFROM_","""_NODE_""","
"RTN","XDRDVAL2",62,0)
 . S XDRTO=XDRDIC_IENTO_","""_NODE_""","
"RTN","XDRDVAL2",63,0)
 . I NODE="DIS",XFILNO=2 Q
"RTN","XDRDVAL2",64,0)
 . S IENTOSTR=IENTO_","
"RTN","XDRDVAL2",65,0)
 . D CHKSUBS(XDRFROM,XDRTO,IENTOSTR,IENTO)
"RTN","XDRDVAL2",66,0)
 Q
"RTN","XDRDVAL2",67,0)
 ;
"RTN","XDRDVAL2",68,0)
CHKSUBS(XDRFROM,XDRTO,IENTOSTR,XDRDASEQ) ;
"RTN","XDRDVAL2",69,0)
 N NODEA,SFILE,VALUE,XVALUE,XDRXX,XDRYY,YVALUE,XENTOSTR
"RTN","XDRDVAL2",70,0)
 N XDRAA,XDRZZ ; DEBUG STATEMENT
"RTN","XDRDVAL2",71,0)
 S SFILE=+$P($G(@(XDRFROM_"0)")),U,2)
"RTN","XDRDVAL2",72,0)
 I SFILE'>0 Q  ; NO FILE NUMBER, NOT FILE MANAGER COMPATIBLE
"RTN","XDRDVAL2",73,0)
 I $P($G(^DD(SFILE,.01,0)),U,2)["W" Q  ; HANDLE WORD PROCESSING FIELDS
"RTN","XDRDVAL2",74,0)
 F NODEA=0:0 S NODEA=$O(@(XDRFROM_NODEA_")")) Q:NODEA'>0  D
"RTN","XDRDVAL2",75,0)
 . S VALUE=$P($G(@(XDRFROM_NODEA_",0)")),U) ; GET .01 VALUE
"RTN","XDRDVAL2",76,0)
 . N XDRDT S XDRDT=^DD(SFILE,.01,0)
"RTN","XDRDVAL2",77,0)
 . I $P(XDRDT,U,2)["D" S XDRDT=$P(XDRDT,U,5,999),XDRDINUM=$S(XDRDT["DINUM":1,1:0) I XDRDINUM S XDRDT=0 D DINUMDAT Q:XDRDT  ; HANDLE DINUMED DATES BY SIMPLY MOVING THEM
"RTN","XDRDVAL2",78,0)
 . S YVALUE=0,XVALUE=0 I $D(^DD(SFILE,.001,0)) S YVALUE=NODEA I $D(@(XDRTO_NODEA_")")) S XVALUE=YVALUE
"RTN","XDRDVAL2",79,0)
 . I XVALUE=0,$P(^DD(SFILE,.01,0),U,5,99)["DINUM",$D(@(XDRTO_NODEA_")")) S XVALUE=NODEA
"RTN","XDRDVAL2",80,0)
 . I XVALUE=0 S XVALUE=+$$FIND1^DIC(SFILE,(","_IENTOSTR),"Q",VALUE) ; FIND CURRENT ENTRY NUMBER, IF PRESENT
"RTN","XDRDVAL2",81,0)
 . I XVALUE>0 D  Q  ; SUBFILE EXISTS IN IENTO, CHECK FOR LOWER SUBFILES
"RTN","XDRDVAL2",82,0)
 . . N X,X1,NODE,NEWFROM,NEWTO,NEWTOIEN
"RTN","XDRDVAL2",83,0)
 . . S NODE=""
"RTN","XDRDVAL2",84,0)
 . . F  S NODE=$O(@(XDRFROM_NODEA_","""_NODE_""")")) Q:NODE=""  D
"RTN","XDRDVAL2",85,0)
 . . . I $D(@(XDRFROM_NODEA_","""_NODE_""")"))'>1 Q
"RTN","XDRDVAL2",86,0)
 . . . S NEWFROM=XDRFROM_NODEA_","""_NODE_""","
"RTN","XDRDVAL2",87,0)
 . . . S NEWTO=XDRTO_XVALUE_","""_NODE_""","
"RTN","XDRDVAL2",88,0)
 . . . S NEWTOIEN=XVALUE_","_IENTOSTR
"RTN","XDRDVAL2",89,0)
 . . . D CHKSUBS(NEWFROM,NEWTO,NEWTOIEN,(XVALUE_U_XDRDASEQ))
"RTN","XDRDVAL2",90,0)
 . K XDRYY I YVALUE>0 S XDRYY(1)=YVALUE
"RTN","XDRDVAL2",91,0)
 . S XENTOSTR="+1,"_IENTOSTR
"RTN","XDRDVAL2",92,0)
 . S XDRFILTY=$P($G(^DD(SFILE,.01,0)),U,2)
"RTN","XDRDVAL2",93,0)
 . ;I XDRFILTY["P",SFILE'=2.011 S VALUE="`"_VALUE
"RTN","XDRDVAL2",94,0)
 . ;I XDRFILTY["V" D
"RTN","XDRDVAL2",95,0)
 . ;. N Y S Y=$P(VALUE,";",2) Q:Y=""
"RTN","XDRDVAL2",96,0)
 . ;. S Y=$P($G(@("^"_Y_"0)")),U) Q:Y=""
"RTN","XDRDVAL2",97,0)
 . ;. S VALUE=Y_".`"_(+VALUE)
"RTN","XDRDVAL2",98,0)
 . ;. Q
"RTN","XDRDVAL2",99,0)
 . I (XDRFILTY["P")!(XDRFILTY["V")!(XDRFILTY["D") Q  ; HANDLE AS INTERNAL VALUES ;  JLI 9-1-99
"RTN","XDRDVAL2",100,0)
 . I SFILE=2.011 Q  ; SPECIAL HANDLING ;  JLI 9-1-99
"RTN","XDRDVAL2",101,0)
 . S XDRXX(SFILE,XENTOSTR,.01)=$$GETEXT(XDRFROM,NODEA,SFILE,.01)
"RTN","XDRDVAL2",102,0)
 . D CHEKFDA("XDRXX",LOCATION)
"RTN","XDRDVAL2",103,0)
 . F XDRID=0:0 S XDRID=$O(^DD(SFILE,0,"ID",XDRID)) Q:XDRID'>0  D
"RTN","XDRDVAL2",104,0)
 . . Q:$P(^DD(SFILE,XDRID,0),U,2)'["R"
"RTN","XDRDVAL2",105,0)
 . . S VALUE=$$GETEXT(XDRFROM,NODEA,SFILE,XDRID)
"RTN","XDRDVAL2",106,0)
 . . I VALUE="" W !,"PROBLEM WITH IDENTIFIER  FILE=",SFILE,"  IENSTR=",XENTOSTR,"   FIELD=",XDRID
"RTN","XDRDVAL2",107,0)
 Q
"RTN","XDRDVAL2",108,0)
 ;
"RTN","XDRDVAL2",109,0)
GETEXT(DICA,DA,FILNUM,FIELD,TYPE) ; GET EXTERNAL VALUE FOR .01 FIELD
"RTN","XDRDVAL2",110,0)
 N DIC,DIQ,DR,XDRQ,TEMP
"RTN","XDRDVAL2",111,0)
 I $G(FIELD)="" S FIELD=.01
"RTN","XDRDVAL2",112,0)
 I $G(TYPE)="" S TYPE="E"
"RTN","XDRDVAL2",113,0)
 S DIC=DICA,DIC("P")=FILNUM,DR=FIELD,DIQ="XDRQ",DIQ(0)="I"
"RTN","XDRDVAL2",114,0)
 D EN^DIQ1
"RTN","XDRDVAL2",115,0)
 S TEMP=$G(XDRQ(FILNUM,DA,FIELD,"I")) I TEMP="" Q ""
"RTN","XDRDVAL2",116,0)
 S DIC=DICA,DIC("P")=FILNUM,DR=FIELD,DIQ="XDRQ",DIQ(0)="E" K XDRQ
"RTN","XDRDVAL2",117,0)
 D EN^DIQ1
"RTN","XDRDVAL2",118,0)
 Q TEMP_U_$G(XDRQ(FILNUM,DA,FIELD,"E"))
"RTN","XDRDVAL2",119,0)
 Q $G(XDRQ(FILNUM,DA,FIELD,TYPE))
"RTN","XDRDVAL2",120,0)
 ;
"RTN","XDRDVAL2",121,0)
DINUMDAT ; PROCESS ENTRIES WITH SAMPLE DATE/TIMES WITH SECONDS, NEEDS DINUM
"RTN","XDRDVAL2",122,0)
 I $D(@(XDRTO_NODEA_")")) Q
"RTN","XDRDVAL2",123,0)
 S XDRDT=1
"RTN","XDRDVAL2",124,0)
 Q
"RTN","XDRDVAL2",125,0)
 ;
"RTN","XDRDVAL2",126,0)
CHEKFDA(FDA,LOCATION) ;
"RTN","XDRDVAL2",127,0)
 N FILE,IENS,FIELD,VAL,VALEXT
"RTN","XDRDVAL2",128,0)
 F FILE=0:0 S FILE=$O(@FDA@(FILE)) Q:FILE'>0  D
"RTN","XDRDVAL2",129,0)
 . S IENS="" F  S IENS=$O(@FDA@(FILE,IENS)) Q:IENS=""  D
"RTN","XDRDVAL2",130,0)
 . . F FIELD=0:0 S FIELD=$O(@FDA@(FILE,IENS,FIELD)) Q:FIELD'>0  D
"RTN","XDRDVAL2",131,0)
 . . . S VAL=@FDA@(FILE,IENS,FIELD),VALEXT=$P(VAL,U,2),VAL=$P(VAL,U) I VAL="" Q
"RTN","XDRDVAL2",132,0)
 . . . I FILE=2,FIELD=.09 Q  ; SSN NUMBER IS ENTERED AS INTERNAL
"RTN","XDRDVAL2",133,0)
 . . . I FILE=2,$P(^DD(FILE,FIELD,0),U,5,99)["DGLOCK2" Q  ; no NOK check
"RTN","XDRDVAL2",134,0)
 . . . I FILE=70.03,FIELD=.01 Q  ; TIES UP EVERYTHING... ;  JLI 9-1-99
"RTN","XDRDVAL2",135,0)
 . . . I FILE=354,FIELD=.03!(FIELD=.05) Q  ; THIS ONE IS TOUGH, DON'T WORRY ABOUT IT
"RTN","XDRDVAL2",136,0)
 . . . I FILE=2,FIELD=63 Q  ; LAB DATA POINTER HAS SPECIAL PROCESSING
"RTN","XDRDVAL2",137,0)
 . . . I FILE=161,FIELD=.5 Q  ; FB has special processing, JDS XT*7.3*77, 8/5/03
"RTN","XDRDVAL2",138,0)
 . . . S MESGROOT=$NA(^TMP($J,"MESG")) K @MESGROOT
"RTN","XDRDVAL2",139,0)
 . . . D CHKVALID^XDRDVAL(MESGROOT,FILE,IENS,FIELD,VALEXT,VAL)
"RTN","XDRDVAL2",140,0)
 . . . I $D(@MESGROOT) M @LOCATION=@MESGROOT K @MESGROOT
"RTN","XDRDVAL2",141,0)
 . . . Q
"RTN","XDRDVAL2",142,0)
 . . Q
"RTN","XDRDVAL2",143,0)
 . Q
"RTN","XDRDVAL2",144,0)
 Q
"VER")
8.0^22.0
**END**
**END**
