Released RA*5*72 SEQ #61
Extracted from mail message
**KIDS**:RA*5.0*72^

**INSTALL NAME**
RA*5.0*72
"BLD",6008,0)
RA*5.0*72^RADIOLOGY/NUCLEAR MEDICINE^0^3060330^y
"BLD",6008,1,0)
^^1^1^3060323^
"BLD",6008,1,1,0)
CORRECT UNDEF ERROR DURING RAD PATIENT REG
"BLD",6008,4,0)
^9.64PA^^
"BLD",6008,6.3)
8
"BLD",6008,"INIT")

"BLD",6008,"KRN",0)
^9.67PA^8989.52^19
"BLD",6008,"KRN",.4,0)
.4
"BLD",6008,"KRN",.401,0)
.401
"BLD",6008,"KRN",.402,0)
.402
"BLD",6008,"KRN",.403,0)
.403
"BLD",6008,"KRN",.5,0)
.5
"BLD",6008,"KRN",.84,0)
.84
"BLD",6008,"KRN",3.6,0)
3.6
"BLD",6008,"KRN",3.8,0)
3.8
"BLD",6008,"KRN",9.2,0)
9.2
"BLD",6008,"KRN",9.8,0)
9.8
"BLD",6008,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6008,"KRN",9.8,"NM",1,0)
RAUTL8^^0^38825839
"BLD",6008,"KRN",9.8,"NM","B","RAUTL8",1)

"BLD",6008,"KRN",19,0)
19
"BLD",6008,"KRN",19.1,0)
19.1
"BLD",6008,"KRN",101,0)
101
"BLD",6008,"KRN",409.61,0)
409.61
"BLD",6008,"KRN",771,0)
771
"BLD",6008,"KRN",870,0)
870
"BLD",6008,"KRN",8989.51,0)
8989.51
"BLD",6008,"KRN",8989.52,0)
8989.52
"BLD",6008,"KRN",8994,0)
8994
"BLD",6008,"KRN","B",.4,.4)

"BLD",6008,"KRN","B",.401,.401)

"BLD",6008,"KRN","B",.402,.402)

"BLD",6008,"KRN","B",.403,.403)

"BLD",6008,"KRN","B",.5,.5)

"BLD",6008,"KRN","B",.84,.84)

"BLD",6008,"KRN","B",3.6,3.6)

"BLD",6008,"KRN","B",3.8,3.8)

"BLD",6008,"KRN","B",9.2,9.2)

"BLD",6008,"KRN","B",9.8,9.8)

"BLD",6008,"KRN","B",19,19)

"BLD",6008,"KRN","B",19.1,19.1)

"BLD",6008,"KRN","B",101,101)

"BLD",6008,"KRN","B",409.61,409.61)

"BLD",6008,"KRN","B",771,771)

"BLD",6008,"KRN","B",870,870)

"BLD",6008,"KRN","B",8989.51,8989.51)

"BLD",6008,"KRN","B",8989.52,8989.52)

"BLD",6008,"KRN","B",8994,8994)

"BLD",6008,"QUES",0)
^9.62^^
"BLD",6008,"REQB",0)
^9.611^1^1
"BLD",6008,"REQB",1,0)
RA*5.0*45^1
"BLD",6008,"REQB","B","RA*5.0*45",1)

"MBREQ")
0
"PKG",18,-1)
1^1
"PKG",18,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",18,20,0)
^9.402P^^
"PKG",18,22,0)
^9.49I^1^1
"PKG",18,22,1,0)
5.0^3051109^2980407^50
"PKG",18,22,1,"PAH",1,0)
72^3060330
"PKG",18,22,1,"PAH",1,1,0)
^^1^1^3060330
"PKG",18,22,1,"PAH",1,1,1,0)
CORRECT UNDEF ERROR DURING RAD PATIENT REG
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RAUTL8")
0^1^B38825839^B35832037
"RTN","RAUTL8",1,0)
RAUTL8 ;HISC/CAH-Utility routines ;10/3/97  16:02
"RTN","RAUTL8",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**45,72**;Mar 16, 1998
"RTN","RAUTL8",3,0)
 ;
"RTN","RAUTL8",4,0)
 ;Called by File 70, Exam subfile, Procedure Fld 2 Input transform
"RTN","RAUTL8",5,0)
 ;RA*5*45: modified -  logic in PRC1, ASK, ASK1, & MES1 subroutines
"RTN","RAUTL8",6,0)
 ;          removed -  MES subroutine
"RTN","RAUTL8",7,0)
 ;RA*5*72 03/23/2006 BAY/GJC/KAM Remedy Call 136200 Correct UNDEF issue
"RTN","RAUTL8",8,0)
 ;
"RTN","RAUTL8",9,0)
PRC G PRC1:'$D(^RADPT(DA(2),"DT","AP",X)) ; check for C.M. reaction
"RTN","RAUTL8",10,0)
 N RADUP S RADUP=+$$DPDT^RAUTL8(X,.DA)
"RTN","RAUTL8",11,0)
 I RADUP D ASK Q:'$D(X)
"RTN","RAUTL8",12,0)
PRC1 ; Check for C.M. reaction on this patient
"RTN","RAUTL8",13,0)
 ; +X is the IEN of the Rad/Nuc Med Procedure in file 71
"RTN","RAUTL8",14,0)
 ; RA*5*72 - Changed next line to preserve variables
"RTN","RAUTL8",15,0)
 N RAGMRAOR S RAGMRAOR=$$GMRAOR(DA(2)) Q:RAGMRAOR'=1
"RTN","RAUTL8",16,0)
 D CONTRAST^RAUTL2(+X) ;displays contrast(s) associated with procedure
"RTN","RAUTL8",17,0)
 ;use RAPMSG for CONTRAST REACTION MESSAGE field 25, file 79
"RTN","RAUTL8",18,0)
 S RAPMSG=$G(^RA(79,+$P(^RADPT(DA(2),"DT",DA(1),0),"^",3),"CON"))
"RTN","RAUTL8",19,0)
 D:RAPMSG'="" EN^DDIOL("..."_RAPMSG_"...","","!?3")
"RTN","RAUTL8",20,0)
 D EN^DDIOL("","","!") ;line feed
"RTN","RAUTL8",21,0)
 K RAPMSG
"RTN","RAUTL8",22,0)
 D:$P($G(^RAMIS(71,+X,0)),U,20)="Y" MES1 ;message only if CM used
"RTN","RAUTL8",23,0)
 Q
"RTN","RAUTL8",24,0)
ASK ; Prompt user for yes/no response
"RTN","RAUTL8",25,0)
 N RAX D EN^DDIOL("Procedure is already entered for this date. Is it ok to continue? No// ","","!!?3")
"RTN","RAUTL8",26,0)
ASK1 R RAX:DTIME
"RTN","RAUTL8",27,0)
 S:'$T!(RAX="")!(RAX["^")!("Nn"[$E(RAX)) RAX="N"
"RTN","RAUTL8",28,0)
 K:RAX="N" X Q:'$D(X)
"RTN","RAUTL8",29,0)
 I "Yy"'[$E(RAX) S RAPMSG(1)="Enter 'YES' to register patient for this procedure, or 'NO' to edit the",RAPMSG(2)="above procedure. No// ",RAPMSG(1,"F")="!!?3",RAPMSG(2,"F")="!?3" D EN^DDIOL(.RAPMSG) K RAPMSG G ASK1
"RTN","RAUTL8",30,0)
 Q
"RTN","RAUTL8",31,0)
 ;
"RTN","RAUTL8",32,0)
MES1 ; display procedure acceptance message
"RTN","RAUTL8",33,0)
 R !?5,"...Type 'OK' to acknowledge or '^' to select another procedure   ==> ",RAX:DTIME
"RTN","RAUTL8",34,0)
 S RAX=$$UP^XLFSTR(RAX)
"RTN","RAUTL8",35,0)
 I '$T!(RAX["^")!(RAX="OK") K:RAX'="OK" X K RAX,RAI Q
"RTN","RAUTL8",36,0)
 G MES1
"RTN","RAUTL8",37,0)
 ;
"RTN","RAUTL8",38,0)
STATSEL ;Select one or more order statuses
"RTN","RAUTL8",39,0)
 ;INPUT VARIABLES:
"RTN","RAUTL8",40,0)
 ;   RANO() array contains status codes prohibited from selection
"RTN","RAUTL8",41,0)
 ;OUTPUT VARIABLES:
"RTN","RAUTL8",42,0)
 ;   RAST is a string of status codes selected (ex: 1^3^8)
"RTN","RAUTL8",43,0)
 ;   RAORST() is an array of selected status codes and status names
"RTN","RAUTL8",44,0)
 ;     (ex:   RAORST(1)="DISCONTINUED", RAORST(3)="HOLD", ... )
"RTN","RAUTL8",45,0)
 K RAST,RAORST W ! S RAORSTS=$P(^DD(75.1,5,0),U,3) F I=1:1 S X=$P(RAORSTS,";",I) Q:X=""  S X1=$P(X,":",1) I '$D(RANO(X1)) S X2=$P(X,":",2),RAORST(X1)=X2
"RTN","RAUTL8",46,0)
 W !!,"Select statuses to include on report.",! S X1="" F  S X1=$O(RAORST(X1)) Q:X1=""  W !?5,$J(X1,2,0)_"   "_RAORST(X1)
"RTN","RAUTL8",47,0)
STAT W ! K DIR S DIR(0)="L" D ^DIR Q:'$D(Y(0))
"RTN","RAUTL8",48,0)
 S RAST="" F I=1:1 S RASTX=$P(Y(0),",",I) Q:RASTX=""  I $D(RAORST(RASTX)) S RAST=RAST_"^"_RASTX
"RTN","RAUTL8",49,0)
 S RAST=$E(RAST,2,99) I RAST="" W !,"  ?? Sorry, invalid status selection.  Please try again.",! G STAT
"RTN","RAUTL8",50,0)
 S I="" F  S I=$O(RAORST(I)) Q:I=""  I RAST'[I K RAORST(I)
"RTN","RAUTL8",51,0)
 K RASTX,I,X,X1,X2 Q
"RTN","RAUTL8",52,0)
 ;
"RTN","RAUTL8",53,0)
 ;INPUT TRANSFORM FOR SECONDARY INTERPRETING RESIDENT
"RTN","RAUTL8",54,0)
S() ; do not enter primary OR SAME SEC in secondary interpreting resident
"RTN","RAUTL8",55,0)
 I '$D(X)!('$D(DA(3))) G S2
"RTN","RAUTL8",56,0)
 I '$D(^RADPT(DA(3),"DT",DA(2),"P",DA(1),0)) G S2
"RTN","RAUTL8",57,0)
 I $D(^RADPT(DA(3),"DT",DA(2),"P",DA(1),"SRR","B",+Y)) Q 0 ;SAME SEC RES
"RTN","RAUTL8",58,0)
 I $P(^RADPT(DA(3),"DT",DA(2),"P",DA(1),0),"^",12)=+Y Q 0
"RTN","RAUTL8",59,0)
 Q 1
"RTN","RAUTL8",60,0)
S2 I '$D(^RADPT(DA(2),"DT",DA(1),"P",DA,0)) Q 0
"RTN","RAUTL8",61,0)
 I $D(^RADPT(DA(2),"DT",DA(1),"P",DA,"SRR","B",+Y)) Q 0 ;SAME SEC RES
"RTN","RAUTL8",62,0)
 I $P(^RADPT(DA(2),"DT",DA(1),"P",DA,0),"^",12)=+Y Q 0
"RTN","RAUTL8",63,0)
 Q 1
"RTN","RAUTL8",64,0)
 ;INPUT TRANSFORM FOR SECONDARY INTERPRETING STAFF
"RTN","RAUTL8",65,0)
SSR() ; do not enter primary OR SAME SEC in secondary interpreting staff
"RTN","RAUTL8",66,0)
 I '$D(X)!('$D(DA(3))) G SSR2
"RTN","RAUTL8",67,0)
 I '$D(^RADPT(DA(3),"DT",DA(2),"P",DA(1),0)) G SSR2
"RTN","RAUTL8",68,0)
 I $D(^RADPT(DA(3),"DT",DA(2),"P",DA(1),"SSR","B",+Y)) Q 0 ;SAME SEC STF
"RTN","RAUTL8",69,0)
 I $P(^RADPT(DA(3),"DT",DA(2),"P",DA(1),0),"^",15)=+Y Q 0
"RTN","RAUTL8",70,0)
 Q 1
"RTN","RAUTL8",71,0)
SSR2 I '$D(^RADPT(DA(2),"DT",DA(1),"P",DA,0)) Q 0
"RTN","RAUTL8",72,0)
 I $D(^RADPT(DA(2),"DT",DA(1),"P",DA,"SSR","B",+Y)) Q 0 ;SAME SEC STF
"RTN","RAUTL8",73,0)
 I $P(^RADPT(DA(2),"DT",DA(1),"P",DA,0),"^",15)=+Y Q 0
"RTN","RAUTL8",74,0)
 Q 1
"RTN","RAUTL8",75,0)
 ;INPUT TRANSFORM FOR PRIMARY INTERPRETING RESIDENT
"RTN","RAUTL8",76,0)
 ; *** NOT USED - See EN ***
"RTN","RAUTL8",77,0)
PRRS() ; do not enter secondary into primary interpreting resident screen
"RTN","RAUTL8",78,0)
 ; called from input transform ^DD(70.03,12,0)
"RTN","RAUTL8",79,0)
 I $D(^RADPT(DA(2),"DT",DA(1),"P",DA,"SRR","B",+Y)) Q 0
"RTN","RAUTL8",80,0)
 Q 1
"RTN","RAUTL8",81,0)
 ;INPUT TRANSFORM FOR PRIMARY INTERPRETING STAFF
"RTN","RAUTL8",82,0)
 ; *** NOT USED - See EN ***
"RTN","RAUTL8",83,0)
PSRS() ; do not enter secondary into primary interpreting staff screen
"RTN","RAUTL8",84,0)
 ; called from input transform ^DD(70.03,15,0)
"RTN","RAUTL8",85,0)
 I $D(^RADPT(DA(2),"DT",DA(1),"P",DA,"SSR","B",+Y)) Q 0
"RTN","RAUTL8",86,0)
 Q 1
"RTN","RAUTL8",87,0)
EN(X,FLD,RA) ;Input transform screen for Primary Staff, Primary Res
"RTN","RAUTL8",88,0)
 ;Used by fields 70.03,12 & 70.03,15.  If 'Primary' is found in
"RTN","RAUTL8",89,0)
 ; the 'Secondary' multiple then delete the 'Secondary' entry.
"RTN","RAUTL8",90,0)
 ; X = 'Primary' IEN,  FLD = 'Secondary' mult. to check,  RA = DA array
"RTN","RAUTL8",91,0)
 N DA,DEL,HDR,IEN,NODE,SAVEX,SUBDD,XREF
"RTN","RAUTL8",92,0)
 S NODE=$S(FLD=60:"SSR",FLD=70:"SRR",1:""),SAVEX=X
"RTN","RAUTL8",93,0)
 S SUBDD=$S(FLD=60:70.11,FLD=70:70.09,1:""),(IEN,DEL)=0
"RTN","RAUTL8",94,0)
 I (NODE="")!(X'>0)!(FLD'>0)!(SUBDD'>0) Q
"RTN","RAUTL8",95,0)
 F  S IEN=$O(^RADPT(RA(2),"DT",RA(1),"P",RA,NODE,"B",X,IEN)) Q:IEN'>0  D
"RTN","RAUTL8",96,0)
 . S XREF=0
"RTN","RAUTL8",97,0)
 . F  S XREF=$O(^DD(SUBDD,.01,1,XREF)) Q:XREF'>0  D
"RTN","RAUTL8",98,0)
 .. S (D0,DA(3))=RA(2),(D1,DA(2))=RA(1),(D2,DA(1))=RA,(D3,DA)=IEN,X=SAVEX
"RTN","RAUTL8",99,0)
 .. I $G(^DD(SUBDD,.01,1,XREF,2))]"" X ^(2)
"RTN","RAUTL8",100,0)
 .. Q
"RTN","RAUTL8",101,0)
 . K ^RADPT(RA(2),"DT",RA(1),"P",RA,NODE,IEN,0) S DEL=DEL+1
"RTN","RAUTL8",102,0)
 . Q
"RTN","RAUTL8",103,0)
 I DEL D
"RTN","RAUTL8",104,0)
 . S HDR=$G(^RADPT(RA(2),"DT",RA(1),"P",RA,NODE,0)) Q:HDR=""
"RTN","RAUTL8",105,0)
 . S HDR(3)=+$O(^RADPT(RA(2),"DT",RA(1),"P",RA,NODE,0))
"RTN","RAUTL8",106,0)
 . S HDR(4)=$P(HDR,U,4)-DEL
"RTN","RAUTL8",107,0)
 . S:HDR(3)'>0 HDR(3)="" S:HDR(4)'>0 HDR(4)=""
"RTN","RAUTL8",108,0)
 . S $P(^RADPT(RA(2),"DT",RA(1),"P",RA,NODE,0),U,3,4)=HDR(3)_U_HDR(4)
"RTN","RAUTL8",109,0)
 . Q
"RTN","RAUTL8",110,0)
 S X=SAVEX
"RTN","RAUTL8",111,0)
 Q
"RTN","RAUTL8",112,0)
DPDT(RAPRC,RAY) ; Check for registration of duplicate procedures on the same
"RTN","RAUTL8",113,0)
 ; date/time.  Called from PRC above.
"RTN","RAUTL8",114,0)
 ; INPUT VARIABLES
"RTN","RAUTL8",115,0)
 ; 'RAPRC' --> IEN of the procedure (71)
"RTN","RAUTL8",116,0)
 ; 'RAY'   --> DA array i.e, DA, DA(1), & DA(2)
"RTN","RAUTL8",117,0)
 ; OUTPUT VARIABLES
"RTN","RAUTL8",118,0)
 ; 'RAFLG' --> RAFLG=1 procedure registered for this date/time
"RTN","RAUTL8",119,0)
 ;         --> RAFLG=0 initial registration for procedure@date/time
"RTN","RAUTL8",120,0)
 N RA72,RABDT,RACIEN,RAEDT,RAFLG,RAI S RAFLG=0
"RTN","RAUTL8",121,0)
 S RABDT=RAY(1)\1,RAEDT=RABDT_".9999",RAI=RABDT-.0000001
"RTN","RAUTL8",122,0)
 F  S RAI=$O(^RADPT(RAY(2),"DT","AP",RAPRC,RAI)) Q:RAI'>0!(RAI>RAEDT)  D  Q:RAFLG
"RTN","RAUTL8",123,0)
 . Q:RAI=RAY(1)  ; At this point our exam status is 'WAITING FOR EXAM'
"RTN","RAUTL8",124,0)
 . S RACIEN=$O(^RADPT(RAY(2),"DT","AP",RAPRC,RAI,0)) Q:'RACIEN
"RTN","RAUTL8",125,0)
 . S RA72=+$P($G(^RADPT(RAY(2),"DT",RAI,"P",RACIEN,0)),U,3) ;xam stat
"RTN","RAUTL8",126,0)
 . S RA72(3)=$P($G(^RA(72,RA72,0)),U,3)
"RTN","RAUTL8",127,0)
 . I RA72(3)'=0 S RAFLG=1 ; cancelled exams are not taken into account
"RTN","RAUTL8",128,0)
 . Q
"RTN","RAUTL8",129,0)
 Q RAFLG
"RTN","RAUTL8",130,0)
SCRN(RADA,RARS,Y,RALVL) ; check if the primary or secondary int'ng staff
"RTN","RAUTL8",131,0)
 ; or resident has access to a location or locations which have
"RTN","RAUTL8",132,0)
 ; an imaging type which match the imaging type of the examination.
"RTN","RAUTL8",133,0)
 ; This screen will also check the classification of the individual to 
"RTN","RAUTL8",134,0)
 ; ensure that they are active and valid for the field being edited.
"RTN","RAUTL8",135,0)
 ;
"RTN","RAUTL8",136,0)
 ; Called from DD's: ^DD(70.03,12 - ^DD(70.03,15  - ^DD(70.03,60
"RTN","RAUTL8",137,0)
 ;                   ^DD(70.03,70 - ^DD(70.09,.01 - ^DD(70.11,.01
"RTN","RAUTL8",138,0)
 ;
"RTN","RAUTL8",139,0)
 ; Input variables:  RADA-> DA array, maps to RADFN, RADTI & RACNI
"RTN","RAUTL8",140,0)
 ;                   RARS-> Classification: Resident("R") or Staff("S")
"RTN","RAUTL8",141,0)
 ;                      Y-> selected resident/staff
"RTN","RAUTL8",142,0)
 ;                   RALVL-> "PRI"=Primary physician, "SEC"=Secondary
"RTN","RAUTL8",143,0)
 ;
"RTN","RAUTL8",144,0)
 ; Output variable: $S(1:I-Types & classification match, resident/staff
"RTN","RAUTL8",145,0)
 ;                      ok,0:no match re-select resident/staff)
"RTN","RAUTL8",146,0)
 ;
"RTN","RAUTL8",147,0)
 I $S('$D(^VA(200,+Y,"RA")):1,'$P(^("RA"),U,3):1,DT'>$P(^("RA"),U,3):1,1:0),($D(^VA(200,"ARC",RARS,+Y)))
"RTN","RAUTL8",148,0)
 Q:'$T 0 ; failed the classification part of the screen
"RTN","RAUTL8",149,0)
 Q:$D(^XUSEC("RA ALLOC",+Y)) 1 ; Resident/Staff has access to all loc's!
"RTN","RAUTL8",150,0)
 N RA7002,RACCESS
"RTN","RAUTL8",151,0)
 ; adjust RADA() due Fileman's unpredictable retention of DA() levels
"RTN","RAUTL8",152,0)
 I RALVL="SEC" D
"RTN","RAUTL8",153,0)
 . I '$D(RADA(3)) S RA7002=$G(^RADPT(RADA(2),"DT",RADA(1),0))
"RTN","RAUTL8",154,0)
 . I $D(RADA(3)),(RADA(2)'=RADA(3)) S RA7002=$G(^RADPT(RADA(3),"DT",RADA(2),0))
"RTN","RAUTL8",155,0)
 . I $D(RADA(3)),(RADA(2)=RADA(3)) S RA7002=$G(^RADPT(RADA(2),"DT",RADA(1),0))
"RTN","RAUTL8",156,0)
 I RALVL="PRI" S RA7002=$G(^RADPT(RADA(2),"DT",RADA(1),0))
"RTN","RAUTL8",157,0)
 D VARACC^RAUTL6(+Y) ; set-up access array for selected resident/staff
"RTN","RAUTL8",158,0)
 Q:'$D(RACCESS(+Y,"IMG",+$P(RA7002,"^",2))) 0 ; no i-type match
"RTN","RAUTL8",159,0)
 Q 1
"RTN","RAUTL8",160,0)
 ;
"RTN","RAUTL8",161,0)
CMEDIA(RADFN,RADTI,RACNI) ;return the CM used with an exam
"RTN","RAUTL8",162,0)
 ;input: RADFN=patient DFN, RADTI=inv. date/time of exam, RACNI=exam IEN
"RTN","RAUTL8",163,0)
 ;return: contrast media administered to the patient during an exam
"RTN","RAUTL8",164,0)
 N RAI,RAS S RAI=0,RAS=""
"RTN","RAUTL8",165,0)
 F  S RAI=$O(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CM",RAI)) Q:'RAI  D
"RTN","RAUTL8",166,0)
 .S RAI(0)=$P($G(^RADPT(RADFN,"DT",RADTI,"P",RACNI,"CM",RAI,0)),U)
"RTN","RAUTL8",167,0)
 .S RAS=RAS_$$EXTERNAL^DILFD(70.3225,.01,"",RAI(0))_", "
"RTN","RAUTL8",168,0)
 Q $P(RAS,", ",1,($L(RAS,", ")-1))
"RTN","RAUTL8",169,0)
 ;
"RTN","RAUTL8",170,0)
GMRAOR(RADA2) ;look for a contrast media reaction
"RTN","RAUTL8",171,0)
 N D,D0,D1,D2,D3,DA,DC,DD,DFN,DG,DH,DI,DIC,DIE,DIEDA,DIEL,DIETMP,DIEXREF,DIFLD,DIIENS,DIOV,DIP,DK,DL,DLAYGO,DM,DN,DOV,DP,DQ,DR,X,Y
"RTN","RAUTL8",172,0)
 Q $$ORCHK^GMRAOR(RADA2,"CM")
"RTN","RAUTL8",173,0)
 ;
"VER")
8.0^22.0
"BLD",6008,6)
^61
**END**
**END**
