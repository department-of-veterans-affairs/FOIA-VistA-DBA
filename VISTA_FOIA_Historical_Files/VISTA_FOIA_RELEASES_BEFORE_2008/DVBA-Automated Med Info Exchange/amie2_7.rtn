12:17 PM  18-APR-95
AMIE V2.7 Routine set 4/18/95
DVBAADM1
DVBAADM1 ;ALB ISC/THM-CHECK FOR ADMISSION TO HOSPITAL ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 S DVBAX=0,DVBAX=$O(^DGPM("APTT1",DFN,DVBAX)) G INP:DVBAX'>0 S ADM=1 Q
 ;
INP K DVBAX D STATUS I '$D(ADM) Q
 Q
STATUS ;PATIENT STATUS
 S:'$D(DOCTYPE) DOCTYPE="A" I DOCTYPE="A",'$D(ADM) W *7,!!,"This patient has never been admitted.",!! K Z H 3 Q
 Q

DVBAADMR
DVBAADMR ;ALB ISC/THM-ADMISSION REVIEW FOR AMIE ;21 JUL 89;
 ;;2.7;AMIE;;Apr 10, 1995
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL
 S LN="ADMISSION REVIEW REPORT" D HOME^%ZIS
 ;
EN1 S %DT(0)=-DT W @IOF,!?(IOM-$L(LN)\2),LN,!!! S %DT="AE",%DT("A")="Enter ADMISSION REVIEW DATE: " D ^%DT S RVDT=Y K %DT(0)
 I +Y<0 G END
 W *7,!!,"Note:  This program requires 132 columns to correctly print the report.",!!
 D PRINT
 I $D(IOST) I IOST?1"C-".E W !!,"Press [RETURN] to continue or ""^"" to exit    " R ANS:DTIME I ANS=U!('$T) G END
 G EN1
 ;
END K %DT,RVDT,FR,TO,L,DIC,ANS,DIJ,DP,P,X,Y,LN,IOY,DA,DO,C,D,DE,DHD,DIK,DIS,I,J,K,IOP,BY,FLDS
 W @IOF,! Q
 ;
PRINT S DHD="Admission Review Report for "_$P(^DVB(396.1,1,0),U,1)_" for " S Y=RVDT X ^DD("DD") S DHD=DHD_Y,L=0,DIC="^DGPM(",FR=RVDT,TO=RVDT,BY="[DVBA ADMISSION REVIEW]",FLDS="[DVBA ADMISSION REVIEW]" D EN1^DIP Q

DVBAADRP
DVBAADRP ;ALB/GTS-557/THM-AMIE COMPLETE ADMISSION RPT ; 1/22/91  1:19 PM
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP($J) G TERM
SET Q:'$D(^DPT(DA,0))  S DFN=DA D RCV^DVBAVDPT Q:CFLOC'=RONUM&(RO="Y")&(CFLOC'=0)&(CFLOC'=376)
 S ^TMP($J,XCN,CFLOC,MB,DA)=MA_U_RCVAA_U_RCVPEN_U_CNUM
 Q
 ;
PRINTB S MA=$P(DATA,U),RCVAA=$P(DATA,U,2),RCVPEN=$P(DATA,U,3),CNUM=$P(DATA,U,4),DFN=DA,QUIT1=1 D ADM^DVBAVDPT
 S:ADMDT]"" ADMDT=$E(ADMDT,4,5)_"/"_$E(ADMDT,6,7)_"/"_$E(ADMDT,2,3) S:DCHGDT]"" DCHGDT=$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3)
 W:(IOST?1"C-".E!($D(DVBAON2))) @IOF
 W !!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!!
 W ?10,"Patient Name:",?26,PNAM,!!,?14,"Claim No:",?26,CNUM,!,?6,"Claim Folder Loc:",?26,CFLOC,!,?9,"Social Sec No:",?26,SSN,!,?8,"Admission Date:",?26,ADMDT,!,?3,"Admitting Diagnosis:",?26,DIAG,!
 W ?8,"Discharge Date:",?26,DCHGDT,!,?11,"Bed Service:",?26,BEDSEC,!,?13,"Recv A&A?:",?26,$S(RCVAA=0:"NO",RCVAA=1:"YES",1:"Not specified"),!
 W ?14,"Pension?:",?26,$S(RCVPEN=0:"NO",RCVPEN=1:"YES",1:"Not specified"),! D ELIG^DVBAVDPT I IOST'?1"C-".E S DVBAON2=""
 I IOST?1"C-".E DO
 .I ($O(^TMP($J,XCN))'=""!($O(^TMP($J,XCN,CFLOC))'=""!($O(^TMP($J,XCN,CFLOC,ADM))'=""!($O(^TMP($J,XCN,CFLOC,ADM,DA))'="")))) DO
 ..W *7,!,"Press RETURN to continue or ""^"" to stop    "
 ..R ANS:DTIME
 ..S:ANS=U!('$T) QUIT=1
 ..I '$T S DVBAQUIT=1
 .I ($O(^TMP($J,XCN))=""&($O(^TMP($J,XCN,CFLOC))=""&($O(^TMP($J,XCN,CFLOC,ADM))=""&($O(^TMP($J,XCN,CFLOC,ADM,DA))="")))) DO
 ..W *7,!,"Press RETURN to continue  "
 ..R ANS:DTIME
 Q
 ;
PRINT U IO S QUIT="" K MA,MB
 S XCN="" F M=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""!(QUIT=1)  S CFLOC="" F J=0:0 S CFLOC=$O(^TMP($J,XCN,CFLOC)) Q:CFLOC=""!(QUIT=1)  D PRINT1
 Q
PRINT1 S ADM="" F K=0:0 S ADM=$O(^TMP($J,XCN,CFLOC,ADM)) Q:ADM=""!(QUIT=1)  S DA="" F L=0:0 S DA=$O(^TMP($J,XCN,CFLOC,ADM,DA)) Q:DA=""!(QUIT=1)  S DATA=^(DA) D PRINTB
 Q
 ;
TERM D HOME^%ZIS K NOASK,QUIT1
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL
 ;
SETUP W @IOF,!,"VARO COMPLETE ADMISSION REPORT" S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="TOTAL ADMISSION REPORT",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 W !,HEAD1
EN1 W !!,"Please enter dates for search, oldest date first, most recent date last.",!!,"Last report was run on " S Y=$P(DTAR,U,3) X ^DD("DD") W Y,!!
 D DATE^DVBAUTIL
 G:X=""!(Y<0) KILL S %ZIS="AEQ" D ^%ZIS K %ZIS
 I POP K DVBAON2,DCHPTR,M,Y,J G KILL^DVBAUTIL
 ;
QUEUE I $D(IO("Q")) S ZTRTN="DEQUE^DVBAADRP",ZTIO=ION,NOASK=1,ZTDESC="AMIE ADMISSION REPORT" F I="BDATE","EDATE","HEAD","HEAD1","RO","RONUM","FDT(0)","NOASK" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! G KILL
 ;
GO S MA=BDATE F J=0:0 S MA=$O(^DGPM("AMV1",MA)) Q:$P(MA,".")>EDATE!(MA="")  W:'$D(NOASK) "." F DA=0:0 S DA=$O(^DGPM("AMV1",MA,DA)) Q:DA=""  F MB=0:0 S MB=$O(^DGPM("AMV1",MA,DA,MB)) Q:MB=""  I MA'>EDATE D SET
 I '$D(^TMP($J)) U IO W !!,*7,"No data found for parameters entered.",!! H 2 G KILL
 I $D(^TMP($J)) D PRINT I $D(DVBAQUIT) K DVBAON2,DCHPTR,M,Y,J G KILL^DVBAUTIL
 ;
KILL D ^%ZISC S X=3 K DVBAON2,DCHPTR,M,Y,J D:$D(ZTQUEUED) KILL^%ZTLOAD G FINAL^DVBAUTIL
 ;
DEQUE K ^TMP($J) G GO

DVBAALRT
DVBAALRT ;ALB/THM-ALERT RO REPORTS THAT ARE READY ; 1/16/91  7:11 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN I '$D(IOF) D HOME^%ZIS
 D DUZ2^DVBAUTIL I $D(DVBAQUIT) K DVBAQUIT,DVBAD2 Q
 I $D(^DVB(396.2,"C",DVBAD2,"R")) W !!,*7,"You have new NOTICES OF DISCHARGE to print.",! H 2
 I $D(^DVB(396.3,"AF","R",DUZ(2))) W !!,*7,"You have new C&P EXAM REPORTS to print.",! H 2
 I $D(^DVB(396,"AC",DVBAD2,"R")) W !!,*7,"You have new 21-DAY CERTIFICATES to print.",! H 2
 Q

DVBAAPLK
DVBAAPLK ;ALB/GTS-557/THM-FORMATTING ROUTINE FOR APPTS (DVBAREN1) ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 S XDD=^DD("DD")
 ;
EN1 W @IOF,!,"Non-admitted Veteran Date Selection",!
 S DISTYPE="" W !!,?5,"Select from:",!!,?10,"(A)ppointment date",!
 W ?10,"(D)isposition log-in date",!
 W ?10,"(S)top code",!!
 W !,"Enter selection:  A// " R DISTYPE:DTIME I '$T S Y=-1,AROWOUT=1,DVBAQUIT=1 Q
 I DISTYPE["?" G CHECK
 I DISTYPE="" S DISTYPE="A"
 I DISTYPE=U S Y=-1,AROWOUT=1 Q
 I DISTYPE'?1"A"&(DISTYPE'?1"D")&(DISTYPE'?1"S") W !!,*7,"Must be A, D, or S",!! H 2 G EN1
 W @IOF,!,$S(DISTYPE="A":"Appointment",DISTYPE="D":"Disposition Log-in",1:"Stop code")_" Date Selection for "_PNAM,!!!
 D @DISTYPE K APPT,DISTYPE,K,ANS,^TMP("DVBA",$J),ANS1,DIC,I,J,X
 Q
 ;
A S Y=-1 I '$D(^DPT(DFN,"S")) W !!,*7,"This veteran has no appointments on file.",!! S OUT=1 H 2 Q
 W !!,"Choose from these appointment dates: " W !!
 S ANS="" S K=0 F I=0:0 S I=$O(^DPT(DFN,"S",I)) Q:I=""  S J=$P(^(I,0),"^",1) S Y=I X XDD S K=K+1 S ^TMP("DVBA",$J,K)=I D WRITE
 I ANS="" D SELECT
 I ANS="" S OUT=1 Q
 I ANS]"",ANS'="^" S Y=^TMP("DVBA",$J,ANS) K ^TMP("DVBA",$J)
 I ANS="^"!(ANS']"") S AROWOUT=1,Y=-1 K APPT Q
 S APPDT=$P(Y,".",1),Y=-1
 Q
WRITE W ?5,K_".  ",?10,$P(Y,"@",1),?25,$P(Y,"@",2,99),?35,$S($D(^SC(J,0)):$P(^SC(J,0),U,1),1:"Unknown clinic"),! I $Y#11=0 D SELECT W !! S:ANS]"" I=9999999.999 Q:ANS]""
 Q
SELECT S ANS="" W !,"Select 1 to "_K_",",!," [RETURN] to continue to search,",!,"  OR ""^"" to QUIT.   " R ANS:DTIME Q:ANS=U!(ANS="")!('$T)
 I ANS'?1.3N!(ANS<1)!(ANS>K) W !!,*7,"Must be between 1 and "_K_" ,RETURN, or ""^""",!! H 2 G SELECT
 Q
 ;
D I '$D(^DPT(DFN,"DIS")) W !!,*7,"This veteran has no log-ins on file.",!! H 2 S Y=-1,OUT=1 Q
 S DIC="^DPT(DFN,""DIS"",",DIC(0)="AEQM",DIC("A")="Enter Disposition Log-in time: " D ^DIC I X=""!(X=U) S Y=-1,AROWOUT=1 Q
 S APPDT=$E($P(Y,U,2),1,7),Y=-1
 Q
 ;
S I '$D(^SDV("ADT",DFN)) W !!,*7,"This veteran has no stop codes on file.",!! H 2 S OUT=1,Y=-1 Q
 S DIC="^SDV(",DIC(0)="EQM",X=$P(^DPT(DFN,0),U,9) D ^DIC I Y=-1 S OUT=1 Q
 S APPDT=$E($P(Y,U,2),1,7),Y=-1
 Q
 ;
CHECK ;check what choices are available
 W @IOF,!!,"The following choices are available for this Veteran:",!!
 I $D(^DPT(DFN,"S")) W "Appointments",!
 I $D(^SDV("ADT",DFN)) W "Stop codes",!
 I $D(^DPT(DFN,"DIS")) W "Disposition Log-in dates",!
 W !!,"Press [RETURN] to continue or ""^"" to quit   " R ANS1:DTIME S:ANS1=U AROWOUT=1 Q:ANS1=U  I '$T S DVBAQUIT=1 Q
 G EN1

DVBACERT
DVBACERT ;ALB/GTS-557/THM-21 DAY CERT CHECKER ; 1/23/91  11:17 AM
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP($J) S DVBAMAN=""
 S HD="MANUAL 21 DAY CERTIFICATE PROCESSING" D HOME^%ZIS
 I '$D(DT) S X="T" D ^%DT S DT=Y
 W @IOF,!?(IOM-$L(HD)\2),HD,!!,"This program should be run only if the Task Manager fails.",!!!
 S %ZIS="AEQ" D ^%ZIS K %ZIS G:POP KILL
 I $D(IO("Q")) S ZTIO=ION,ZTDESC="Manual 21-day Cert program",ZTRTN="DATA^DVBACERT" F I="HD","HD1","DVBAMAN" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! G KILL
 G DATA
 ;
CHK S ADMDT=$P(^DVB(396,XDA,0),U,4),DFN=$P(^(0),U,1),STAT=$P(^(1),U,12) Q:STAT]""
 K TEMP F I=0:0 S I=$O(^DGPM("APTT1",DFN,I)) Q:I=""  F J=0:0 S J=$O(^DGPM("APTT1",DFN,I,J)) Q:J=""  S ZJ=$S($D(^DGPM(J,0)):^(0),1:"") I ZJ]"" S TEMP(I,DFN)=J_U_I
 S DCHGDT="" I $D(TEMP(ADMDT,DFN)) D CHK1
 I DCHGDT]"" D LOS^DVBAUTIL I LOS'<21 S ^TMP($J,ADMDT,MB,DFN)=XDA_U_DCHGDT_U_$P(TEMP(ADMDT,DFN),U,2) Q  ;**Dischrgd, stay >21 days
 I DCHGDT]"" D LOS^DVBAUTIL I LOS<21 S DR="6.5////C;6.8////"_DT_";6.9////"_"Not applicable",DA=XDA,DIE="^DVB(396," D ^DIE K DA Q  ;**Dchgd, stay <21
 Q
 ;
LOOK1 S XDA=$P(^TMP($J,ADMDT,LADM,DFN),U,1),DCHGDT=$P(^(DFN),U,2) D CREATE
 Q
 ;
CHK1 S MB=$P(TEMP(ADMDT,DFN),U,1),DCHPTR=+$P(^DGPM(MB,0),U,17)
 S DCHGDT=$S($D(^DGPM(DCHPTR,0)):$P(^(0),U,1),1:"") I DCHGDT="" S DCHGDT=DT D LOS^DVBAUTIL S DCHGDT="" I LOS'<21 S ^TMP($J,ADMDT,MB,DFN)=XDA_U_DT_U_$P(TEMP(ADMDT,DFN),U,2) Q
 ;null DCHGDT/use DT if vet still in hosp
 ;** If vet not discharged, DCHGDT="" on Quit
 Q
 ;
LOOK F ADMDT=0:0 S ADMDT=$O(^TMP($J,ADMDT)) Q:ADMDT=""  F LADM=0:0 S LADM=$O(^TMP($J,ADMDT,LADM)) Q:LADM=""  F DFN=0:0 S DFN=$O(^TMP($J,ADMDT,LADM,DFN)) Q:DFN=""  D LOOK1
 Q
 ;
DATA S Y=DT X ^DD("DD") S FDT(0)=Y,CNT=0
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL ;for TaskMan,manual
 S DTAR=^DVB(396.1,1,0),HD1=$P(DTAR,U,1)
 U IO S NAME="" F J=0:0 S NAME=$O(^DVB(396,"B",NAME)) Q:NAME=""  F XDA=0:0 S XDA=$O(^DVB(396,"B",NAME,XDA)) Q:XDA=""  I $P(^DVB(396,XDA,0),U,7)="YES"&($P(^(0),U,13)="P") D CHK
 D LOOK ;**Loop Recs to create 21-day certs
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!,"Notice to MAS personnel on "_FDT(0),! I '$D(^TMP($J)) W !!!,"There were no 21 day certificates to print today.",!! G KILL
 W !!!,"There were "_CNT_" certificates processed on "_FDT(0),!!
 ;
KILL I $D(DVBAMAN)&($D(ZTQUEUED)) D KILL^%ZTLOAD
 K DVBAMAN,DVBAON2,^TMP($J) G KILL^DVBAUTIL
 ;
CREATE ;CERTIFICATE CREATE
 I $D(^DVB(396,XDA,2)) Q:$P(^(2),U,10)="L"
 I '$D(^DPT(DFN,0)) W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF W !!,"Patient record missing for DFN "_DFN,!! Q
 S VAINDT=$P(^TMP($J,ADMDT,LADM,DFN),U,3),VA200="" D INP^VADPT K VA200 S WARD=$P(VAIN(4),U,2) S PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown")
 S BED="Unknown" I $D(^DPT(DFN,.101)) S BED=$S($P(^(.101),U,1)]"":$P(^(.101),U,1),1:"Unknown")
 U IO
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !,FDT(0),?32,"REPORT OF CONTACT",!,?31,"21-DAY CERTIFICATE",?(80-11),"PAGE: 1",!,?(80-$L(HD1)\2),HD1,!!!!!!!,"Patient name: ",?16,PNAM,!,?9,"SSN: ",?16,SSN,?33,"Claim #: ",?43,CNUM,!!,?9,"Ward: ",?16,WARD,?25," Bed: ",BED,!!!
 W "     The patient above has been hospitalized for 21 consecutive days ",!,"from " S Y=ADMDT X ^DD("DD") W Y," to " S Y=DCHGDT X ^DD("DD") W Y,", and the major diagnosis for",!,"this period is:",!!!!!!!!!!!!!!!!!!!!
 W "Physician signature: " F LINE=$X:1:80 W "_"
 W !!!,"        Approved by: " F LINE=$X:1:65 W "_"
 W !!?5,"ROC  119",!
 S REQDIV=$P(^DVB(396,XDA,2),"^",9)
 S DIE="^DVB(396,",DA=XDA,DR="6.5///C;6.8///"_DT_";6.9////"_"21-day certificate",NEWREQ=0 D ^DIE ;new request
 I $P(^DVB(396,XDA,0),U,9)="" S DIE="^DVB(396,",DA=XDA,DR="4///YES;4.5///P;4.6///"_REQDIV_";4.7///"_DT,NEWREQ=1 D ^DIE ;notice of dischg request
 I $P(^DVB(396,XDA,0),U,11)="" S DIE="^DVB(396,",DA=XDA,DR="5///YES;5.5///P;5.6///"_REQDIV_";5.7///"_DT,NEWREQ=1 D ^DIE ;hospital summary request
 K REQDIV
 S WWHO=$S($D(^DVB(396,XDA,2)):$P(^(2),U,8),1:"Unknown") I NEWREQ=1 S DIE="^DVB(396,",DA=XDA,DR="23///"_DT_";24///"_DT_";28///"_$E(WWHO,1,24)_"*" D ^DIE ;make new request to MAS
 ;NOTE: "*" system maintenance via this program
 S DIE="^DVB(396,",DR="6.82///N;6.86///"_DCHGDT_";6.87///"_WARD_";6.88///"_BED S DA=XDA D ^DIE S CNT=CNT+1
 S DVBAON2=""
 Q

DVBACMRP
DVBACMRP ;ALB/GTS-557/THM-INCOMPETENT RPT ; 1/16/91  7:23 AM
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP($J) G TERM
SET Q:'$D(^DPT(DA,.29))  S ICDAT=^(.29) Q:$P(ICDAT,U,12)'=1&(ICDAT']"")  S INCMP="" S:$P(ICDAT,U)]""!($P(ICDAT,U,12)=1) INCMP=1 Q:INCMP'=1  S ICDAT2=$P(ICDAT,U,2),ICDAT=$P(ICDAT,U)
 S:ICDAT]"" ICDAT=$E(ICDAT,4,5)_"/"_$E(ICDAT,6,7)_"/"_$E(ICDAT,2,3) S:ICDAT2]"" ICDAT2=$E(ICDAT2,4,5)_"/"_$E(ICDAT2,6,7)_"/"_$E(ICDAT2,2,3)
 Q:'$D(^DPT(DA,0))  S DFN=DA D RCV^DVBAVDPT Q:CFLOC'=RONUM&(RO="Y")&(CFLOC'=0)&(CFLOC'=376)
 S ^TMP($J,XCN,CFLOC,MB,DA)=MA_U_RCVAA_U_RCVPEN_U_CNUM_U_ICDAT_U_ICDAT2_U_INCMP
 Q
 ;
PRINTB S MA=$P(DATA,U),RCVAA=$P(DATA,U,2),RCVPEN=$P(DATA,U,3),CNUM=$P(DATA,U,4),ICDAT=$P(DATA,U,5),ICDAT2=$P(DATA,U,6),INCMP=$P(DATA,U,7),DFN=DA,QUIT1=1 D ADM^DVBAVDPT
 S ADMDT=$E(ADMDT,4,5)_"/"_$E(ADMDT,6,7)_"/"_$E(ADMDT,2,3),DCHGDT=$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3)
 S LADM=ADM,TDIS="UNKNOWN",TO="",DCHPTR=$P(^DGPM(LADM,0),U,17),TDIS=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U,18),1:"") I TDIS="" S TDIS="Unknown discharge type"
 S:'$D(^DG(405.2,+TDIS,0)) TDIS="Unknown discharge type" I $D(^(0)) S TDIS=$S($P(^DG(405.2,+TDIS,0),U,1)]"":$P(^(0),U,1),1:"Unknown discharge type")
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!!
 W ?10,"Patient Name:",?26,PNAM,!!,?14,"Claim No:",?26,CNUM,!,?6,"Claim Folder Loc:",?26,CFLOC,!,?9,"Social Sec No:",?26,SSN,!,?8,"Admission Date:",?26,ADMDT,!,?3,"Admitting Diagnosis:",?26,DIAG,!
 W ?8,"Discharge Date:",?26,DCHGDT,! W:DCHGDT]"" ?5,"Type of Discharge:",?26,TDIS_$S(TO]"":" TO "_$S($D(^DIC(4,+TO,0)):$P(^(0),U,1),1:""),1:""),!
 W ?11,"Bed Service:",?26,BEDSEC,!,?13,"Recv A&A?:",?26,$S(RCVAA=0:"NO",RCVAA=1:"YES",1:"Not specified"),!
 W ?14,"Pension?:",?26,$S(RCVPEN=0:"NO",RCVPEN=1:"YES",1:"Not specified"),! D ELIG^DVBAVDPT
 W !,?5,"DATE RULED INCOMP:" W:ICDAT]"" ?26,ICDAT_" (VA)" W:ICDAT2]"" " - ",ICDAT2_" (CIVIL)" W !
 I IOST?1"C-".E W *7,!,"Press RETURN to continue or ""^"" to stop    " R ANS:DTIME S:ANS=U!('$T) QUIT=1 I '$T S DVBAQUIT=1
 S DVBAON2=""
 Q
 ;
PRINT U IO S QUIT=""
 S XCN="" F M=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""!(QUIT=1)  S CFLOC="" F J=0:0 S CFLOC=$O(^TMP($J,XCN,CFLOC)) Q:CFLOC=""!(QUIT=1)  D PRINT1
 Q
PRINT1 S ADM="" F K=0:0 S ADM=$O(^TMP($J,XCN,CFLOC,ADM)) Q:ADM=""!(QUIT=1)  S DA="" F L=0:0 S DA=$O(^TMP($J,XCN,CFLOC,ADM,DA)) Q:DA=""!(QUIT=1)  S DATA=^(DA) D PRINTB
 Q
 ;
TERM D HOME^%ZIS K NOASK
 ;
SETUP W @IOF,!,"VARO INCOMPETENCY REPORT" D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="INCOMPETENCY REPORT",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 W !,HEAD1
EN1 W !!,"Please enter dates for search, oldest date first, most recent date last.",!!,"Last report was run on " S Y=$P(DTAR,U,5) X ^DD("DD") W Y,!!
 D DATE^DVBAUTIL G:X=""!(Y<0) KILL
 S %ZIS="Q" D ^%ZIS K %ZIS G:POP KILL^DVBAUTIL
 ;
QUEUE I $D(IO("Q")) S ZTRTN="DEQUE^DVBACMRP",ZTIO=ION,NOASK=1,ZTDESC="AMIE INCOMPETENT VET REPORT" F I="FDT(0)","HEAD","HEAD1","BDATE","EDATE","TYPE","RO","RONUM","NOASK" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! G KILL
 ;
GO S MA=BDATE F J=0:0 S MA=$O(^DGPM("AMV1",MA)) Q:$P(MA,".")>EDATE!(MA="")  F DA=0:0 S DA=$O(^DGPM("AMV1",MA,DA)) Q:DA=""  F MB=0:0 S MB=$O(^DGPM("AMV1",MA,DA,MB)) Q:MB=""  D SET I '$D(NOASK) W "."
 I '$D(^TMP($J)) U IO W !!,*7,"No data found for parameters entered.",!! H 2 G KILL
 I $D(^TMP($J)) D PRINT I $D(DVBAQUIT) K DVBAON2 G KILL^DVBAUTIL
 ;
KILL D ^%ZISC S X=5 K DVBAON2 D:$D(ZTQUEUED) KILL^%ZTLOAD G FINAL^DVBAUTIL
 ;
DEQUE K ^TMP($J) G GO

DVBACRMS
DVBACRMS ;ALB/GTS-557/THM-PRINT 21-DAY CERT FOR RO ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 D DUZ2^DVBAUTIL G:$D(DVBAQUIT) KILL
 I '$D(^DVB(396,"AC",DVBAD2,"R")) W !!,*7,"There are no new 21-DAY CERTIFICATES to print.",! H 2 Q
 I $D(DUZ)#2=0 W !!,*7,"Your USER NUMBER is missing.  Call the site manager.",!! H 3 G KILL
 S HD="REGIONAL OFFICE 21-DAY CERTIFICATE PRINTING" D HOME^%ZIS D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL S DTAR=^DVB(396.1,1,0),HD1=$P(DTAR,U,1)
 S OPER=$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"Unknown")
 I '$D(DT) S X="T" D ^%DT S DT=Y
 S Y=DT X ^DD("DD") S FDT(0)=Y
 W @IOF,!?(IOM-$L(HD)\2),HD,!!!,"This program generates ORIGINAL Regional Office 21-day certificates.",!!
 W !! S %ZIS="AEQ" D ^%ZIS K %ZIS G:POP KILL
 I $D(IO("Q")) S ZTIO=ION,ZTDESC="Original RO 21-day Cert Printing",ZTRTN="DATA^DVBACRMS" F I="DVBAD2","HD","HD1","OPER","FDT(0)" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! K ZTSK,ZTIO,ZTRTN,ZTDESC G KILL
 G DATA
 ;
DATA U IO F XDA=0:0 S XDA=$O(^DVB(396,"AC",DVBAD2,"R",XDA)) Q:XDA=""  S DFN=$P(^DVB(396,XDA,0),U,1) D CREATE
 ;
KILL K DVBAON2 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBAUTIL
 ;
CREATE ;CERTIFICATE CREATE
 ;Note:  DCHGDT becomes a pseudo-discharge date, that is the date the
 ;       report was run and he became eligible for a 21-day cert.
 I $D(^DVB(396,XDA,2)) Q:$P(^(2),U,10)="L"
 I '$D(^DPT(DFN,0)) W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 I '$D(^DPT(DFN,0)) W !!,"Patient record missing for DFN ",DFN,!!
 I '$D(^DPT(DFN,0)) S DVBAON2="" Q
 S PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown")
 S WARD=$P(^DVB(396,XDA,4),U,6),BED=$P(^(4),U,7),DCHGDT=$P(^(4),U,5),ADMDT=$P(^(0),U,4)
 U IO W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !,FDT(0),?32,"REPORT OF CONTACT",!,?31,"21-DAY CERTIFICATE",?(80-11),"PAGE: 1",!,?(80-$L(HD1)\2),HD1,!!!!!!!,"Patient name: ",?16,PNAM,!,?9,"SSN: ",?16,SSN,?33,"Claim #: ",?43,CNUM,!!,?9,"Ward: ",?16,WARD,?30,"Bed: ",?36,BED,!!!
 W "     The patient above has been hospitalized for 21 consecutive days ",!,"from " S Y=ADMDT X ^DD("DD") W Y," to " S Y=DCHGDT X ^DD("DD") W Y,", and the major diagnosis for",!,"this period is:",!!!
 K ^UTILITY($J,"W")
 F LINE=0:0 S LINE=$O(^DVB(396,XDA,3,LINE)) Q:LINE=""  S X=^(LINE,0),DIWL=5,DIWR=75,DIWF="NW" D ^DIWP
 D ^DIWW W !!!,"A signed copy of this document is on file at "_HD1,!
 W !!?5,"R0C  119",!
 S DIE="^DVB(396,",DA=XDA,DR="6.82///P;6.85///"_DT_";6.89///"_OPER D ^DIE
 S DVBAON2=""
 Q

DVBACRRP
DVBACRRP ;ALB/GTS-557/THM-REPRINT 21-DAY CERT FOR MAS ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 D INIT
 I 'CONT G KIL
 S DVBSEL=$$SELECT^DVBAUTL5("Original Processing Date","21 Day Certificate")
 I DVBSEL="D" S SDATE=$$DATE() G:SDATE<0 KIL
 I DVBSEL="N" S XDA=$$PAT^DVBAUTL5("MAS") G:XDA<1 KIL
 I DVBSEL=0 G KIL
 D DEVICE
 I 'CONT G KIL
 D DATA
 ;
KIL D KILL
 Q
 ;
DATA ;
 I DVBSEL="D" DO
 .U IO
 .S NAME=""
 .F J=0:0 S NAME=$O(^DVB(396,"B",NAME)) Q:NAME=""  F XDA=0:0 S XDA=$O(^DVB(396,"B",NAME,XDA)) Q:XDA=""  I $P(^DVB(396,XDA,0),U,14)=SDATE S DFN=$P(^(0),U,1) D CREATE
 .Q
 I DVBSEL="N" DO
 .S DFN=$P(^DVB(396,XDA,0),U,1)
 .D CREATE
 .Q
 I NODTA=0 DO
 .S VAR(1,0)="0,0,0,2:2,0^No data found to reprint"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .Q
 Q
 ;
KILL K %DT(0),SDATE,DVBAON2,DVBSEL,VAR,CONT
 I $D(ZTQUEUED) D KILL^%ZTLOAD
 D KILL^DVBAUTIL
 Q
 ;
CREATE ;CERTIFICATE CREATE
 Q:'$D(^DVB(396,XDA,4))
 I $D(^DVB(396,XDA,2)) Q:$P(^(2),U,10)="L"
 I '$D(^DPT(DFN,0)) W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 I '$D(^DPT(DFN,0)) W !!,"Patient record missing for DFN ",DFN,!!
 I '$D(^DPT(DFN,0)) S DVBAON2="" Q
 S PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown")
 S WARD=$P(^DVB(396,XDA,4),U,6),BED=$P(^(4),U,7),DCHGDT=$P(^(4),U,5),ADMDT=$P(^(0),U,4)
 U IO W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !,FDT(0),?32,"REPORT OF CONTACT",!,?31,"21-DAY CERTIFICATE",?(80-11),"PAGE: 1",!,?(80-$L(HD1)\2),HD1,!!!!!!!,"Patient name: ",?16,PNAM,!,?9,"SSN: ",?16,SSN,?33,"Claim #: ",?43,CNUM,!!,?9,"Ward: ",?16,WARD,?30,"Bed: ",?36,BED,!!!
 W "     The patient above has been hospitalized for 21 consecutive days ",!,"from " S Y=ADMDT X ^DD("DD") W Y," to " S Y=DCHGDT X ^DD("DD") W Y,", and the major diagnosis for",!,"this period is:",!!!!!!!!!!!!!!!!!!!!
 W "Physician signature: " F LINE=$X:1:80 W "_"
 W !!!,"        Approved by: " F LINE=$X:1:65 W "_"
 W !!?5,"R0C  119",!
 S NODTA=1
 S DVBAON2=""
 Q
 ;
INIT ;
 K ^TMP($J)
 S CONT=1,NODTA=0,HD="21-DAY CERTIFICATE REPRINTING"
 D HOME^%ZIS
 D NOPARM^DVBAUTL2
 I $D(DVBAQUIT) S CONT=0 Q
 S HD1=$$SITE^DVBCUTL4()
 I '$D(DT) S X="T" D ^%DT S DT=Y
 S Y=DT X ^DD("DD") S FDT(0)=Y
 S VAR(1,0)="0,0,(IOM-$L(HD)\2),1:3,1:0^"_HD
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
DATE() ;THis function returns a date of the original request from the user.
 S %DT(0)=-DT
 S %DT("A")="Enter ORIGINAL PROCESSING DATE: ",%DT="AEQ"
 D ^%DT
 K %DT
 Q Y
 ;
DEVICE ;
 S VAR(1,0)="0,0,0,2:0,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 S %ZIS="AEQ"
 D ^%ZIS K %ZIS
 I POP S CONT=0 Q
 I $D(IO("Q")) DO
 .S CONT=0
 .S ZTIO=ION,ZTDESC="21-day Cert reprint",ZTRTN="DATA^DVBACRRP"
 .F I="XDA","DVBSEL","FDT(0)","HD","HD1","SDATE","NODTA" S ZTSAVE(I)=""
 .D ^%ZTLOAD
 .D ^%ZISC
 .I $D(ZTSK) DO
 ..S VAR(1,0)="0,0,0,2:2,0^Request queued."
 ..D WR^DVBAUTL4("VAR")
 ..K VAR
 ..Q
 .Q
 Q

DVBACRRR
DVBACRRR ;ALB/GTS-557/THM-REPRINT 21-DAY CERT FOR THE RO ;21 JUL 89 
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 D INIT
 I CONT=0 G KIL
 D HDR
 S DVBSEL=$$SELECT^DVBAUTL5("ORIGINAL PROCESSING DATE","21 Day Certificate")
 I DVBSEL="D" S SDATE=$$DATE^DVBACRRP G:SDATE<0 KIL
 I DVBSEL="N" S XDA=$$PAT^DVBAUTL5("RO") G:XDA<1 KIL
 I DVBSEL=0 G KIL
 I 'CONT G KIL
 D DEVICE
 I 'CONT G KIL
 D DATA
KIL D KILL
 Q
 ;
DEVICE ;
 S VAR(1,0)="0,0,0,2:0,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 S %ZIS="AEQ"
 D ^%ZIS
 K %ZIS
 I POP S CONT=0 Q
 I $D(IO("Q")) DO
 .S CONT=0
 .S ZTIO=ION,ZTDESC="21-day Cert reprint",ZTRTN="DATA^DVBACRRR"
 .F I="DVBSEL","XDA","DVBAD2","FDT(0)","HD","HD1","SDATE","NODTA" S ZTSAVE(I)=""
 .D ^%ZTLOAD
 .D ^%ZISC
 .I $D(ZTSK) DO
 ..S VAR(1,0)="0,0,0,2:2,0^Request queued."
 ..D WR^DVBAUTL4("VAR")
 ..K VAR
 ..Q
 .Q
 Q
 ;
DATA ;
 I DVBSEL="D" DO  ;by date range
 .U IO
 .F XDA=0:0 S XDA=$O(^DVB(396,"AC",DVBAD2,"P",XDA)) Q:XDA=""  S DFN=$P(^DVB(396,XDA,0),U,1) I $P(^(4),U,4)=SDATE D CREATE
 .Q
 I DVBSEL="N" DO  ;by name/ssn
 .S DFN=$P(^DVB(396,XDA,0),U,1)
 .D CREATE
 .Q
 I NODTA=0 DO  ;no data found
 .S VAR(1,0)="0,0,0,2:2,0^No data found to reprint"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .Q
 ;
KILL K DVBAON2,DVBSEL,VAR,DVBAD2,CONT
 D:$D(ZTQUEUED) KILL^%ZTLOAD
 D KILL^DVBAUTIL
 Q
 ;
CREATE ;CERTIFICATE CREATE
 I $D(^DVB(396,XDA,2)) Q:$P(^(2),U,10)="L"
 I '$D(^DPT(DFN,0)) W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 I '$D(^DPT(DFN,0)) W !!,"Patient record missing for DFN ",DFN,!!
 I '$D(^DPT(DFN,0)) S DVBAON2="" Q
 S PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown")
 S WARD=$P(^DVB(396,XDA,4),U,6),BED=$P(^(4),U,7),DCHGDT=$P(^(4),U,5),ADMDT=$P(^(0),U,4)
 U IO W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !,FDT(0),?32,"REPORT OF CONTACT",!,?31,"21-DAY CERTIFICATE",?(80-11),"PAGE: 1",!,?(80-$L(HD1)\2),HD1,!!!!!!!,"Patient name: ",?16,PNAM,!,?9,"SSN: ",?16,SSN,?33,"Claim #: ",?43,CNUM,!!,?9,"Ward: ",?16,WARD,?30,"Bed: ",?36,BED,!!!
 W "     The patient above has been hospitalized for 21 consecutive days ",!,"from " S Y=ADMDT X ^DD("DD") W Y," to " S Y=DCHGDT X ^DD("DD") W Y,", and the major diagnosis for",!,"this period is:",!!!
 K ^UTILITY($J,"W")
 F LINE=0:0 S LINE=$O(^DVB(396,XDA,3,LINE)) Q:LINE=""  S X=^(LINE,0),DIWL=5,DIWR=75,DIWF="NW" D ^DIWP
 D ^DIWW W !!!,"A signed copy of this document is on file at "_HD1,!
 W !!?5,"R0C  119",!
 S NODTA=1,DVBAON2=""
 Q
 ;
HDR ;Displays the header to this option.
 S VAR(1,0)="0,0,(IOM-$L(HD)\2),1:3,1:0^"_HD
 D WR^DVBAUTL4("VAR")
 K VAR
 S VAR(1,0)="0,0,0,0:2,0^This program REPRINTS 21-day certificates for the RO."
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
INIT ;sets up and checks various variables
 S CONT=1
 D DUZ2^DVBAUTIL
 I $D(DVBAQUIT) S CONT=0
 I $D(DUZ)#2=0 DO
 .S VAR(1,0)="1,0,0,2:2,0^Your USER NUMBER is missing.  Call the site manager."
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .D PAUSE^DVBCUTL4
 .S CONT=0
 .Q
 I CONT=0 Q
 S NODTA=0,HD="REGIONAL OFFICE 21-DAY CERTIFICATE REPRINTING"
 D HOME^%ZIS
 D NOPARM^DVBAUTL2
 I $D(DVBAQUIT) S CONT=0
 S HD1=$$SITE^DVBCUTL4
 I '$D(DT) S X="T" D ^%DT S DT=Y
 S Y=DT X ^DD("DD") S FDT(0)=Y
 Q

DVBADSCK
DVBADSCK ;ALB/GTS-557/THM-DISCHARGE CHECKER ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S DVBAMAN=""
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL
 S HD="MANUAL 7132 PROCESSING" D HOME^%ZIS K ^TMP($J)
DATE S %DT(0)=-DT,%DT="AE",%DT("A")="Enter BEGINNING date: "
 W @IOF,!?(IOM-$L(HD)\2),HD,!!!
 D ^%DT G:Y<0 KILL S (BDATE,BDATE1)=Y,BDATE=BDATE-.1
 S %DT("A")="     and ENDING date: ",%DT="AE" D ^%DT G:Y<0 DATE S (EDATE1,EDATE)=Y,EDATE=EDATE+.5
 I EDATE<BDATE W *7,!!,"Invalid date sequence." H 3 G DATE
 K %DT S Y=DT X ^DD("DD") S FDT(0)=Y
 W !! S %ZIS="AEQ",%ZIS("A")="Enter output device: " D ^%ZIS K %ZIS G:POP KILL
 I $D(IO("Q")) S ZTRTN="DATA^DVBADSCK",ZTIO=ION,NOASK=1,ZTDESC="AMIE Discharge Checker" F I="BDATE*","EDATE*","FDT(0)","HD","NOASK","DVBAMAN" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",! G KILL
 G DATA
 ;
ZTM D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL
 I '$D(DT) S X="T" D ^%DT S DT=Y
 S Y=DT X ^DD("DD") S FDT(0)=Y
 K ^TMP($J) S X="T-7" D ^%DT Q:Y<0  S (BDATE,BDATE1)=Y,BDATE=Y-.1,(EDATE1,EDATE)=Y,EDATE=Y+.5 G DATA
 ;
CHK ;* Find the IFN of the 7131 which matches the admission date (If a 7131
 ;*  exists).
 F XDA=0:0 S XDA=$O(^DVB(396,"B",DFN,XDA)) Q:XDA=""  I $P(^DVB(396,XDA,0),U,4)=ADMDT Q
 Q
 ;
SET ;* Set up TMP global of admissions for discharges within range
 S DFN=DA,VAINDT=$S($D(^DGPM(+MB,0)):$P(^(0),U,1),1:""),VAINDT=VAINDT-.000002,VA200="" D INP^VADPT K VA200 S ADMDT=$P(VAIN(7),U,1),ADMNUM=VAIN(1)
 ;I ADMDT]"" S ADMDT=$P(ADMDT,".",1)
 Q:ADMDT=""  S ^TMP($J,ADMDT,+ADMNUM,DA)=""
 Q
 ;
SET1 ;* Get the discharge type and execute CREATE and CREAT1 as needed
 S DCHPTR=$P(^DGPM(LADM,0),U,17),TDIS=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U,18),1:"") I TDIS="" S TDIS="Unknown discharge type"
 S:'$D(^DG(405.2,+TDIS,0)) TDIS="Unknown discharge type" I $D(^(0)) S TDIS=$S($P(^DG(405.2,+TDIS,0),U,1)]"":$P(^(0),U,1),1:"Unknown discharge type")
 I XDA]"",$D(^DVB(396,XDA,0)) D CREATE Q
 I TDIS["DEATH"!(TDIS["TO CNH") D CREAT1
 Q
 ;
LOOK ;* Loop through Admission Date TMP global execute CHK and SET1
 K MA,DA,MB F ADMDT=0:0 S ADMDT=$O(^TMP($J,ADMDT)) Q:ADMDT=""  F LADM=0:0 S LADM=$O(^TMP($J,ADMDT,LADM)) Q:LADM=""  F DFN=0:0 S DFN=$O(^TMP($J,ADMDT,LADM,DFN)) Q:DFN=""  D CHK,SET1
 Q
 ;
DATA U IO W:(IOST?1"C-".E) @IOF
 W !,"Notices of discharge created on "_FDT(0)_" for discharge date range " S Y=$P(BDATE1,".",1) X ^DD("DD") W Y," TO " S Y=$P(EDATE1,".",1) X ^DD("DD") W Y,!!!
 W "Name",?35,"SSN",?50,"Admission date",! F LINE=1:1:IOM W "-"
 ;
 ;* Set up XRO array containing regional office station numbers
 ;*  contained in the AMIE Site Parameter File
 ;
 F I=0:0 S I=$O(^DVB(396.1,1,1,I)) Q:I=""!(+I=0)  S J=$P(^(I,0),U,1),J=$S($D(^DIC(4,+J,99)):$P(^(99),U),1:"") I J]"" S XRO(J)=""
 ;
 ;* Loop through Discharges ("AMV3") within entered date range DO SET
 ;*  when a discharge is found
 ;
 W !! S COUNT=0,MA=BDATE F J=0:0 S MA=$O(^DGPM("AMV3",MA)) Q:$P(MA,".")>EDATE!(MA="")  F DA=0:0 S DA=$O(^DGPM("AMV3",MA,DA)) Q:DA=""  F MB=0:0 S MB=$O(^DGPM("AMV3",MA,DA,MB)) Q:MB=""  I MA'>EDATE D SET
 ;
 ;* Loop through admission date TMP global
 ;
 D LOOK W @IOF,!!!,"Notice to MAS operator on ",FDT(0),!!! I '$D(NEW) W "There were no NOTICES OF DISCHARGE to create.",!!!
 I $D(NEW) W "There ",$S(COUNT=1:"was ",1:"were ")_COUNT_$S(COUNT=1:" notice",1:" notices")_" of discharge created.",!!!
 ;
KILL I $D(DVBAMAN)&($D(ZTQUEUED)) D KILL^%ZTLOAD
 K NEW,COUNT,XRO G KILL^DVBAUTIL
 ;
CREATE ;create notice
 ;* If a Notice of Discharge is requested on 7131, created it
 I $D(^DVB(396,XDA,2)) Q:$P(^(2),U,10)="L"
 Q:$P(^DVB(396,XDA,0),U,5)'="YES"  Q:$P(^(0),U,9)'="P"
 S XADMDT=$P(^DVB(396,XDA,0),U,4) Q:ADMDT'=XADMDT
CREAT1 Q:'$D(^DPT(DFN,0))  D ADM^DVBAVDPT I '$D(XRO(CFLOC))&(CFLOC'=376) Q  ;not a user RO
 I CFLOC=376,TDIS["DEATH" S CFLOC=$O(XRO(0)) Q:CFLOC=""
 Q:$D(^DVB(396.2,"D",ADMDT,DFN))  ;quit if one for admit date exists
 S (DIC,DIE)="^DVB(396.2,",DR="3.5///"_CFLOC_";1///"_ADMDT_";2///"_LADM_";3///R" S DLAYGO=396.2,DIC(0)="QLM",X=""""_SSN_"""" D ^DIC Q:+Y<0  S DA=+Y D ^DIE S NEW=1,COUNT=COUNT+1 K DLAYGO
 W PNAM,?35,SSN S Y=ADMDT X ^DD("DD") W ?50,Y,?70,TDIS,!
 Q
 ;
DOC ;XADMDT=admission date on 7131
 ;XDA=7131 file pointer--not all patients will have it
 ;DA=patient file pointer
 ;MB,LADM=admission pointers
 ;NOTE: DEATH,TO CNH discharges will NOT record discharge dates

DVBADSNT
DVBADSNT ;ALB/GTS-557/THM-GENERATE AMIE NOTICE OF DISCHARGE ; 1/16/91  7:37 AM
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP($J) G TERM
 ;
SET Q:'$D(^DPT(DFN,0))  D RCV^DVBAVDPT S ^TMP($J,XCN,CFLOC,MB,DFN)=XDA_U_XDA2_U_ADMDT_U_RCVAA_U_RCVPEN_U_CNUM
 Q
 ;
PRINTB S XDA=$P(DATA,U),XDA2=$P(DATA,U,2),ADMDT=$P(DATA,U,3),RCVAA=$P(DATA,U,4),RCVPEN=$P(DATA,U,5),CNUM=$P(DATA,U,6),QUIT1=1 D ADM^DVBAVDPT
 S LADM=ADM
 I '$D(^DGPM(LADM,0)) S FND=1
 I $D(^DGPM(LADM,0)) N HPAT S HPAT=$P(^DGPM(LADM,0),"^",3) I $D(^DPT(HPAT,0)) S HPAT=$P(^DPT(HPAT,0),"^") I (HPAT'=PNAM)!(ADMDT'=$P(^DGPM(LADM,0),"^")) S FND=1
 I $D(FND) N Y S Y=ADMDT D DD^%DT W !!,"Admission entry in Patient Movement File has been deleted for: ",!,?5,PNAM,?25,SSN,?35," at ",Y,!,"Contact VAMC for further information.",! K Y,FND D FUPD Q
 S DCHPTR=$P(^DGPM(LADM,0),U,17),TDIS=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U,18),1:"") I TDIS="" S TDIS="Unknown discharge type"
 S:'$D(^DG(405.2,+TDIS,0)) TDIS="Unknown discharge type" I $D(^(0)) S TDIS=$S($P(^DG(405.2,+TDIS,0),U,1)]"":$P(^(0),U,1),1:"Unknown discharge type")
 I DCHGDT="" S DCHGDT=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U),1:"")
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!!
 W ?10,"Patient Name:",?26,PNAM,!!,?14,"Claim No:",?26,CNUM,!,?6,"Claim Folder Loc:",?26,CFLOC,!,?9,"Social Sec No:",?26,SSN,!,?8,"Discharge Date:",?26,$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3),!
 W ?5,"Type of Discharge:",?26,TDIS,!
 D LOS^DVBAUTIL W ?8,"Length of Stay:",?26,LOS_$S(LOS="":"Discharged same day",LOS=1:" day",1:" days"),!
 W ?11,"Bed Service:",?26,BEDSEC,! S DA=DFN D ELIG^DVBAVDPT
FUPD K DA I XDA2]"",$P(^DVB(396,XDA2,0),U,9)="P" S DA=XDA2,DIE="^DVB(396,",DR="4.5////C;4.8////"_DT_";4.9////"_"Notice of Discharge" D ^DIE K DA
 I $D(DVBAD2) I DVBAD2=CFLOC!(CFLOC=376) S DIE="^DVB(396.2,",DA=XDA,DR="3///P;4///"_DT_";5///"_DUZ D ^DIE
 I IOST?1"C-".E W *7,!,"Press RETURN to continue or ""^"" to stop    " R ANS:DTIME S:ANS=U!('$T) QUIT=1 I '$T S DVBAQUIT=1
 S DVBAON2=""
 Q
 ;
PRINT U IO S QUIT=""
 S XCN="" F M=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""!(QUIT=1)  S CFLOC="" F J=0:0 S CFLOC=$O(^TMP($J,XCN,CFLOC)) Q:CFLOC=""!(QUIT=1)  D PRINT1
 Q
PRINT1 S ADM="" F K=0:0 S ADM=$O(^TMP($J,XCN,CFLOC,ADM)) Q:ADM=""  S DFN="" F L=0:0 S DFN=$O(^TMP($J,XCN,CFLOC,ADM,DFN)) Q:DFN=""!(QUIT=1)  S DATA=^(DFN) D PRINTB
 Q
 ;
TERM D HOME^%ZIS K NOASK
 D DUZ2^DVBAUTIL I $D(DVBAQUIT) K DVBAQUIT G KILL
 ;
SETUP W @IOF,!,"NOTICE OF DISCHARGE REPORT" D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="NOTICE OF DISCHARGE",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 W !,HEAD1
EN1 W !!,"This program will print out any new NOTICES OF DISCHARGE,",!,"based on the hospital's discharges.",!!,"Do you want to continue" S %=2 D YN^DICN
 I $D(%Y) I %Y["?" W !!,"Enter Y to print out the notice, N if you want to exit the program.",! G EN1
 G:%'=1 KILL S %ZIS="Q" D ^%ZIS K %ZIS I POP G KILL
 ;
QUEUE I $D(IO("Q")) S ZTRTN="DEQUE^DVBADSNT",ZTIO=ION,NOASK=1,ZTDESC="AMIE NOTICE OF DISCHARGE REPORT" F I="FDT(0)","HEAD","HEAD1","NOASK","DVBAD2" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! K ZTSK G KILL
 ;
GO F XDA=0:0 S XDA=$O(^DVB(396.2,"C",DVBAD2,"R",XDA)) Q:XDA=""  I $D(^DVB(396.2,XDA,0)) S MB=^(0),DFN=$P(MB,U),ADMDT=$P(MB,U,2),MB=$P(MB,U,3) D CHK,SET I '$D(NOASK) W "."
 I '$D(^TMP($J)) U IO W !!,*7,"No data found.",!! H 2 G KILL
 D PRINT
KILL D:$D(ZTQUEUED) KILL^%ZTLOAD K DVBAON2 G KILL^DVBAUTIL
 ;
DEQUE K ^TMP($J) G GO
 ;
CHK ;pull 7131 pointer
 F XDA2=0:0 S XDA2=$O(^DVB(396,"G",ADMDT,XDA2)) Q:XDA2=""  Q:$P(^DVB(396,XDA2,0),U,1)=DFN
 Q
 ;
REPRINT D CHK,SET,PRINT G KILL

DVBADSR1
DVBADSR1 ;ALB/GTS-557/THM-REPRINT AMIE NOTICE OF DISCHARGE ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 D HOME^%ZIS
 D DUZ2^DVBAUTIL I $D(DVBAQUIT) K DVBAQUIT G EXIT
 ;
SETUP S HD="SINGLE NOTICE OF DISCHARGE REPRINTING"
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="NOTICE OF DISCHARGE",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 ;
EN W @IOF,!?(IOM-$L(HD)\2),HD,!!
 S DIC="^DVB(396.2,",DIC(0)="AEQM",DIC("A")="Enter NAME to reprint: "
 S DIC("W")="S DFN=$P(^DVB(396.2,+Y,0),U,1),ADM=$P(^(0),U,3) I $D(^DGPM(+ADM,0)),$P(^(0),U,17)]"""" S DCHPTR=$P(^(0),U,17),DISCH=$S($P(^DGPM(DCHPTR,0),U,1)]"""":$P(^(0),U,1),1:"""") X DVBA(""W"")"
 S DVBA("W")="W:$X>50 ! W ?($X+5),""Discharge date: "",$E(DISCH,4,5)_""-""_$E(DISCH,6,7)_""-""_$E(DISCH,2,3)"
 D ^DIC I X=""!(X=U) K DVBA G EXIT
 I +Y<0 W *7,"   ??" H 1 G EN
 I $P(^DVB(396.2,+Y,0),U,7)'=DVBAD2 W *7,!!,"This does not belong to your RO.",!! H 3 G EN
 I +Y>0 S XDA=+Y,DA=$P(^DVB(396.2,+Y,0),U,1),ADMDT=$P(^(0),U,2),MB=$P(^(0),U,3)
 S %ZIS("B")="0;P-OTHER",%ZIS="AEQ",%ZIS("A")="Output device: " D ^%ZIS K %ZIS
 I $D(IO("Q")) S ZTIO=ION,ZTRTN="REPRINT^DVBADSNT",ZTDESC="Reprint notice of discharge" F I="H*","D*","FDT*","A*","XDA","MB" S ZTSAVE(I)=""
 I  D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued",!! H 2 G KILL^DVBAUTIL
 I POP G KILL^DVBAUTIL
 D REPRINT^DVBADSNT K ^TMP($J) G SETUP
 ;
EXIT G KILL^DVBAUTIL

DVBADSRP
DVBADSRP ;ALB/GTS-557/THM-REPRINT NOTICE OF DISCHARGE ; 1/22/91  12:05 PM
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP($J) G TERM
SET Q:'$D(^DPT(DA,0))  S DFN=DA D RCV^DVBAVDPT S ^TMP($J,XCN,CFLOC,MB,DA)=ADMDT_U_RCVAA_U_RCVPEN_U_CNUM
 Q
 ;
PRINTB S ADMDT=$P(DTA,U),RCVAA=$P(DTA,U,2),RCVPEN=$P(DTA,U,3),CNUM=$P(DTA,U,4),QUIT1=1,DFN=DA D ADM^DVBAVDPT
 S LADM=ADM
 I '$D(DGPM(LADM,0)) S FND=1
 I $D(^DGPM(LADM,0)) N HPAT S HPAT=$P(^DGPM(LADM,0),"^",3) I $D(^DPT(HPAT,0)) S HPAT=$P(^DPT(HPAT,0),"^") I (HPAT'=PNAM)!(ADMDT'=$P(^DGPM(LADM,0),"^")) S FND=1
 I $D(FND) N Y S Y=ADMDT D DD^%DT W !!,"Admission entry in Patient Movement File has been deleted for: ",!,?5,PNAM,?25,SSN,?35," at ",Y,!,"Contact VAMC for further information.",! K Y,FND S DVBAON2="" Q
 S DCHPTR=$P(^DGPM(LADM,0),U,17),TDIS=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U,18),1:"") I TDIS="" S TDIS="Unknown discharge type"
 S:'$D(^DG(405.2,+TDIS,0)) TDIS="Unknown discharge type" I $D(^(0)) S TDIS=$S($P(^DG(405.2,+TDIS,0),U,1)]"":$P(^(0),U,1),1:"Unknown discharge type")
 I DCHGDT="" S DCHGDT=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U),1:"")
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!!
 W ?10,"Patient Name:",?26,PNAM,!!,?14,"Claim No:",?26,CNUM,!,?6,"Claim Folder Loc:",?26,CFLOC,!,?9,"Social Sec No:",?26,SSN,!,?8,"Discharge Date:",?26,$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3),!
 W ?5,"Type of Discharge:",?26,TDIS,!
 D LOS^DVBAUTIL W ?8,"Length of Stay:",?26,LOS_$S(LOS="":"Discharged same day",LOS=1:" day",1:" days"),!
 W ?11,"Bed Service:",?26,BEDSEC,! D ELIG^DVBAVDPT ;no updating required
 I IOST?1"C-".E W *7,!,"Press RETURN to continue or ""^"" to stop" R ANS:DTIME S:ANS=U!('$T) QUIT=1 I '$T S DVBAQUIT=1
 S DVBAON2=""
 Q
 ;
PRINT U IO S QUIT=""
 S XCN="" F M=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""!(QUIT=1)  S CFLOC="" F J=0:0 S CFLOC=$O(^TMP($J,XCN,CFLOC)) Q:CFLOC=""!(QUIT=1)  D PRINT1
 Q
PRINT1 S ADM="" F K=0:0 S ADM=$O(^TMP($J,XCN,CFLOC,ADM)) Q:ADM=""!(QUIT=1)  S DA="" F L=0:0 S DA=$O(^TMP($J,XCN,CFLOC,ADM,DA)) Q:DA=""!(QUIT=1)  S DTA=^(DA) D PRINTB
 Q
 ;
TERM D HOME^%ZIS K NOASK
 D DUZ2^DVBAUTIL I $D(DVBAQUIT) K DVBAQUIT G KILL
 ;
SETUP W @IOF,!,"* REPRINT * NOTICE OF DISCHARGE REPORT" D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="NOTICE OF DISCHARGE REPRINT",U="^",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 W !,HEAD1
EN1 W !!,"This program will reprint NOTICES OF DISCHARGE,",!!,"Do you want to continue" S %=2 D YN^DICN
 I $D(%Y) I %Y["?" W !!,"Enter Y to reprint or N to quit.",! G EN1
 I %'=1 G KILL
ONE W !!,"Do you want only one Veteran" S %=2 D YN^DICN G:%=1 ^DVBADSR1
 I $D(%Y) I %Y["?" W !!,"Enter Y to get one VET, N for all.",! G ONE
 G:$D(DTOUT)!(%<0) KILL
 ;
ASK W ! S %DT(0)=-DT,%DT("A")="Enter ORIGINAL PROCESSING date: ",%DT="AE" D ^%DT G:Y<0 KILL S BDATE=Y K %DT
 I X["?" W !,"The date the notices were originally printed on.",! G ASK
 G:X=""!(X=U) KILL S %ZIS="AEQ",%ZIS("B")="0;P-OTHER" D ^%ZIS K %ZIS
 I POP G KILL
 ;
QUEUE I $D(IO("Q")) S ZTRTN="DEQUE^DVBADSRP",ZTIO=ION,NOASK=1,ZTDESC="AMIE NOTICE OF DISCHARGE RPT" F I="REP","DVBATYPS","BDATE","FDT(0)","HEAD","HEAD1","NOASK","DVBAD2" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued." G KILL
GO F XDA=0:0 S XDA=$O(^DVB(396.2,"C",DVBAD2,"P",XDA)) Q:XDA=""  S MB=^DVB(396.2,XDA,0),DA=$P(MB,U),ADMDT=$P(MB,U,2),MB=$P(MB,U,3) D:$P(^DVB(396.2,XDA,0),U,5)=BDATE SET I '$D(NOASK) W "."
 I '$D(^TMP($J)) U IO W !!,*7,"No data found for parameters.",!! H 2 G KILL
 D PRINT I $D(DVBAQUIT) K DVBAON2 G KILL^DVBAUTIL
 ;
KILL K DVBAON2 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBAUTIL
 ;
DEQUE K ^TMP($J) G GO
 ;
REPRINT D SET,PRINT G KILL

DVBADSRT
DVBADSRT ;ALB/GTS-557/THM-AMIE DISCHARGE RPT ; 1/16/91  4:23 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K ^TMP($J) G TERM
 ;
SET Q:'$D(^DPT(DA,0))  S DFN=DA,DVBASC="" D RCV^DVBAVDPT Q:CFLOC'=RONUM&(RO="Y")&(CFLOC'=0)&(CFLOC'=376)  Q:ADTYPE="S"&(DVBASC'="Y")  Q:ADTYPE="A"&(RCVAA'=1)  Q:ADTYPE="P"&(RCVPEN'="1")
 S TDIS=$S($D(^DGPM(+MB,0)):$P(^(0),U,18),1:"")
 I $D(^DG(405.2,+TDIS,0)) DO
 .I '$D(^TMP("DVBA",$J,"DUP",+TDIS)) Q
 .S TDIS=$S($P(^DG(405.2,+TDIS,0),U,1)]"":$P(^(0),U,1),1:"Unknown discharge type")
 .S ^TMP($J,XCN,CFLOC,MB,DA)=MA_U_RCVAA_U_RCVPEN_U_CNUM_U_TDIS
 .Q
 Q
 ;
PRINTB S MA=$P(DATA,U),RCVAA=$P(DATA,U,2),RCVPEN=$P(DATA,U,3),CNUM=$P(DATA,U,4),TDIS=$P(DATA,U,5),DFN=DA,QUIT1=1 D DCHGDT^DVBAVDPT
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!!
 W ?10,"Patient Name:",?26,PNAM,!!,?14,"Claim No:",?26,CNUM,!,?6,"Claim Folder Loc:",?26,CFLOC,!,?9,"Social Sec No:",?26,SSN,!
 W ?8,"Discharge Date:",?26,$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3),!,?5,"Type of Discharge:",?26,TDIS,!
 D LOS^DVBAUTIL W ?8,"Length of Stay:",?26,LOS_$S(LOS="":"Discharged same day",LOS=1:" day",1:" days"),!
 W ?11,"Bed Service:",?26,BEDSEC,!
 W ?13,"Recv A&A?:",?26,$S(RCVAA="0":"NO",RCVAA="1":"YES",1:"Not specified"),!
 W ?14,"Pension?:",?26,$S(RCVPEN="0":"NO",RCVPEN="1":"YES",1:"Not specified"),! D ELIG^DVBAVDPT
 I IOST?1"C-".E W *7,!,"Press RETURN to continue or ""^"" to stop    " R ANS:DTIME S:ANS=U!('$T) QUIT=1 I ANS=U S DVBAQUIT=1
 S DVBAON2=""
 Q
 ;
PRINT U IO S QUIT=""
 S XCN="" F M=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""!(QUIT=1)  S CFLOC="" F J=0:0 S CFLOC=$O(^TMP($J,XCN,CFLOC)) Q:CFLOC=""!(QUIT=1)  D PRINT1
 Q
PRINT1 S ADM="" F K=0:0 S ADM=$O(^TMP($J,XCN,CFLOC,ADM)) Q:ADM=""!(QUIT=1)  S DA="" F L=0:0 S DA=$O(^TMP($J,XCN,CFLOC,ADM,DA)) Q:DA=""!(QUIT=1)  S DATA=^(DA) D PRINTB
 Q
 ;
TERM D HOME^%ZIS K NOASK
 ;
SETUP W @IOF,!,"VARO DISCHARGE REPORT" D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S DSRP=1,HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0) W !,HEAD1
 ;
EN1 W !!,"Please enter dates for search, oldest date first, most recent date last.",!!,"Last report was run on " S Y=$P(DTAR,U,4) X ^DD("DD") W Y,!!
 D DATE^DVBAUTIL
 G:X=""!(Y<0) KILL
 ;
ADTYPE D ADTYPE^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL
 W @IOF
 K DVBACEPT
 D EN^VALM("DVBA DISCHARGE TYPES")
 I '$D(DVBACEPT) D KILL^DVBAUTIL Q
 I '$O(^TMP("DVBA",$J,"DUP",0)) D KILL^DVBAUTIL Q
 ;
 W !!! S %ZIS="Q" D ^%ZIS K %ZIS G:POP KILL^DVBAUTIL
 ;
QUEUE I $D(IO("Q")) S ZTRTN="DEQUE^DVBADSRT",ZTIO=ION,NOASK=1,ZTDESC="AMIE DISCHARGE REPORT" F I="^TMP(""DVBA"",$J,""DUP""","ADTYPE","DVBATYPS","BDATE","BDATE1","EDATE","FDT(0)","HEAD","HEAD1","HD","RO","RONUM","NOASK" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",! G KILL
 ;
GO S MA=BDATE F J=0:0 S MA=$O(^DGPM("AMV3",MA)) Q:MA>EDATE!(MA="")  W:'$D(NOASK) "." F DA=0:0 S DA=$O(^DGPM("AMV3",MA,DA)) Q:DA=""  F MB=0:0 S MB=$O(^DGPM("AMV3",MA,DA,MB)) Q:MB=""  D SET
 I '$D(^TMP($J)) U IO W !!,*7,"No data found for parameters entered.",!! H 2 G KILL
 D PRINT I $D(DVBAQUIT) K DVBAON2 G KILL^DVBAUTIL
 ;
KILL D ^%ZISC D:$D(ZTQUEUED) KILL^%ZTLOAD S X=4 K DVBAON2 G FINAL^DVBAUTIL
 ;
DEQUE K ^TMP($J) G GO

DVBADXFR
DVBADXFR ;ALB/GTS-AMIE 7131 DIVISIONAL TRANSFER RTN ; 12/6/94  2:00 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
MAIN ;**Loop to select and update 7131 report divisions
 F  DO  I $D(DTOUT)!($D(DUOUT)!($D(DVBAOUT))) Q  ;**QUIT top 'For' loop
 .D HOME^%ZIS
 .W @IOF
 .W !!,?5,"7131 Divisional Transfer",!!
 .S REQDA=$$SEL7131^DVBAUTL7()
 .S:+REQDA'>0 DVBAOUT=""
 .I +REQDA>0 DO
 ..D INITIAL,REQVARS
 ..D INITRPT^DVBAUTL7(REQDA)
 ..K DTOUT,DUOUT,DVBAOUT
 ..F  DO  I $D(DTOUT)!($D(DUOUT)!($D(DVBAOUT))) Q  ;**QUIT 'For' loop
 ...K NODIV
 ...D DRAW
 ...D READ I $D(DTOUT)!($D(DUOUT)!($D(DVBAOUT))) Q  ;**QUIT 'For' loop
 ...D DIVSEL I $D(DTOUT)!($D(DUOUT)!($D(DVBAOUT))) Q  ;**QUIT 'For' loop
 ...D:'$D(NODIV) ADJ
 ..I '$D(DTOUT)&('$D(DUOUT)) D FILE^DVBAUTL7
 ..D EXITLP
 K DVBAOUT,REQDA,DA,DIE,DIR,DR,DTOUT,DUOUT
 W @IOF
 Q
 ;
EXITLP K A,DA,DIE,DIR,DR,DTOUT,DUOUT,DVBADSCH,DVBAER,DVBAHD21,DVBALN,DVBAOUT
 K FLDDIV,FLDDTE,REQDIV,DVBARPT,DVBATDT,DVBATITL,DVBAX,X,Z,DVBAP,DVBAO
 K REQDTE,DVBARPT,REQDA,DVBCSSNO,SSN,HNAME,PNAM,DVBREQDT,DFN,RPTVAR
 K NDIVIEN,NDIVNAME,CNUM,NODIV
 Q
 ;
INITIAL ;**initialize general variables
 S $P(DVBALN,"-",80)=""
 S DVBATITL="7131 Divisional Transfer"
 S X="NOW",%DT="ST"
 D ^%DT
 X ^DD("DD")
 S DVBATDT=Y
 S HNAME=$$SITE^DVBCUTL4()
 K X,Y,%DT
 Q
 ;
REQVARS ;**Set variables unique to 7131
 S DVBREQDT=$P(^DVB(396,REQDA,0),U,4)
 I $P(^DVB(396,REQDA,2),U,10)="L" D ACT
 I $P(^DVB(396,REQDA,2),U,10)="A" D ADM
 S DFN=$P(^DVB(396,REQDA,0),U,1)
 S PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^DPT(+DFN,0),U,9)
 S CNUM=$S($D(^DPT(+DFN,.31)):$P(^(.31),U,3),1:"Unknown")
 D SSNOUT^DVBCUTIL
 S SSN=DVBCSSNO
 Q
 ;
ADM ;**Set up admission date and discharge variables
 S Y=DVBREQDT
 D DD^%DT
 S DVBAHD21="Admission Date: "_Y
 K Y
 Q
 ;
ACT ;**Set up activity date variable
 S Y=DVBREQDT
 D DD^%DT
 S DVBAHD21="Activity Date: "_Y
 K Y
 Q
 ;
DRAW ;** Output Division screen
 I IOST?1"C-".E W @IOF
 W "Information Request Form"
 W ?35,HNAME
 W ?59,DVBATDT
 W !,DVBALN
 W !,"Patient: "
 W PNAM
 W ?54,"SSN: "
 W SSN
 W !,"Claim #: ",CNUM,!
 W DVBAHD21
 W !!,?9,"Report",?37,"Selected",?48,"Status",?58,"Division"
 W !,DVBALN
 F DVBAX=0:0 S DVBAX=$O(DVBARPT(DVBAX)) Q:'DVBAX  D DRAW1
 W !,DVBALN
 Q
 ;
DRAW1 ;** Output a report to the screen
 W !,DVBAX
 W ?3,$P(DVBARPT(DVBAX),U,1)
 W ?40,$S($P(DVBARPT(DVBAX),U,2)["Y":"YES",1:"NO")
 W ?48,$S($P(DVBARPT(DVBAX),U,3)="C":"Completed",$P(DVBARPT(DVBAX),U,3)="P":"Pending",1:"")
 W ?58,$E($P(DVBARPT(DVBAX),U,4),1,20)
 Q
 ;
READ ;** Read selected report
 S DIR(0)="LAO^1:11^K:X[""."" X"
 S DIR("A")="Select Report(s) to Transfer: "
 S DIR("?",1)="Select a number or range of numbers from 1 to 10 (1,3,5 or 2-4,8).  You will"
 S DIR("?",2)="then be asked to select a division to transfer the report(s) to.  After a"
 S DIR("?")="division is selected, the new division will display next to the report(s)."
 D ^DIR
 I $D(DUOUT)!($D(DTOUT)) Q
 I 'Y S DVBAOUT="" ;**User hit Return at report prompt
 S:$D(Y) RPTVAR=Y
 Q
 ;
DIVSEL ;** Select a division to transfer to  (Division must be in AMIE Site
 ;**  Parameter File)
 N PARAMDA
 S PARAMDA=$$IFNPAR^DVBAUTL3()
 D:PARAMDA'>0 PARAMERR
 I PARAMDA>0 DO
 .S DIC(0)="AEMQ"
 .S DIC("A")="Select a Division to Transfer to: "
 .S DIC="^DVB(396.1,PARAMDA,2,"
 .D ^DIC
 .S:+Y>0 NDIVIEN=$P(^DVB(396.1,PARAMDA,2,+Y,0),U,1)
 .S:+Y>0 NDIVNAME=$P(^DG(40.8,NDIVIEN,0),U,1)
 .S:+Y'>0 NODIV=""
 .K DIC,Y
 Q
 ;
PARAMERR ;** Error if the AMIE Site Parameter file has a problem
 W *7,!,"The AMIE Site Parameter File is not set up properly."
 W !,"Contact the Medical Center's IRM department."
 W !,?30,"<Return> to continue."
 R Z:DTIME
 S DVBAOUT=""
 Q
 ;
ADJ ;** Adjust local array DVBARPT(#)
 K DVBAER
 N X,A
 F X=1:1:11 S A=$P(RPTVAR,",",X) Q:'A  D CHECK
 D:'$D(DVBAER) CHNG
 K Y
 Q
 ;
CHECK ;** Check for X-fer of report with status '= Pending
 I $P(DVBARPT(A),U,3)'="P" DO:'$D(DVBAER)  S DVBAER=1 Q
 .W *7,!,"You have selected a report with a status other than Pending."
 .W !,"All reports selected for transfer must be Pending."
 .W !,?30,"<Return> to continue."
 .R Z:DTIME
 .Q
 Q
 ;
CHNG ;** Update local array DVBARPT(#)
 F X=1:1:11 S A=$P(RPTVAR,",",X) Q:'A  DO
 .I $P(DVBARPT(A),U,3)="P" DO
 ..S $P(DVBARPT(A),U,4)=NDIVNAME
 ..S $P(DVBARPT(A),U,5)=NDIVIEN
 Q

DVBAEDIT
DVBAEDIT ;ALB ISC/THM-EDIT AMIE BENEFICIARY INFO STATUS ;21 JUL 89@0117
 ;;2.7;AMIE;;Apr 10, 1995
 I $D(DUZ)#2=0 W !!,*7,"You have no USER NUMBER.  Contact the site manager.",!! H 3 G EXIT
 ;
TERM D HOME^%ZIS S OPER=$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"Unknown operator")
 S HD="7131 REQUEST STATUS EDITING"
 ;
SETUP W @IOF,!?(IOM-$L(HD)\2),HD,!! S DIE="^DVB(396,",DR="[DVBA STATUS EDIT]",DIC=DIE,DIC(0)="AEQMZ",DIC("A")="Enter PATIENT NAME: " K DVBACORR,OUT
 D DICW^DVBAUTIL
 S DVBACORR="N",SUPER=0 I $D(^XUSEC("DVBA SUPERVISOR",DUZ)) S SUPER=1,DVBACORR="Y"
 ;
EDIT D ^DIC G:X=U!(X="") EXIT W:Y<0 *7,"  ??" G:Y<0 EDIT I Y>0 S DVBAPNAM=Y(0,0),DA=+Y W !! G CHK
 ;;;OLD  D ^DIC G:X=U!(X="") EXIT W:Y<0 *7,"  ??" G:Y<0 EDIT I Y>0 S DA=+Y W !! G CHK
 ;
EDIT1 K OUT,%,%Y S %DT(0)=-DT I SUPER=1 W !!!,*7,"Supervisory edit -- all fields available.",!!
 I  W "Note:  As a Supervisor you will be allowed to use the ""^"" to escape",!,"from the program if desired.  This is not normally allowed.",! S DIE("NO^")="OUTOK" D CON G:$D(OUT) FINAL
 I SUPER=0 S DIE("NO^")=1
 W @IOF,!,?(IOM-$L(HD)\2),HD,!!!,"Patient Name: ",DVBAPNAM D ^DIE K DIE("NO^")
 ; NEW FIX - W !,?(IOM-$L(HD)\2) D ^DIE K DIE("NO^")
 ;
FINAL D CHK1 G:NOFINAL=1 SETUP W !!,*7,"All items are completed.  This record is now FINALIZED.",!
 S DIE="^DVB(396,",DR="25////"_DT_";26////"_OPER W !,"Updating record, please wait  ",! D ^DIE H 1
 D CON G:$D(OUT) EXIT
 K DA,Y G SETUP
 ;
EXIT W @IOF K DIE,DR,DIC,DIC(0),DIC("A"),DA,OPER,FDATE,%DT,X,NOFINAL,ZA,Y,%DT,HD,ANS,ZTYPE,DVBADIC,CODE,D0,DLAYGO,DQ,C,%X,%Y,%,DREF,DI,DIYS,ZX,%DT,DVBASTAT,DVBADT,CODE,ZX,FDT(0)
 K DVBAPNAM,POP,DG,DIFLD,DK,DL,DM,SUPER,OUT,DVBACORR,D,OLDDR,DTOUT
 Q
 ;
CHK ;CHECK TO SEE IF FINALIZED
 K %,%Y
 I SUPER=1,$D(^DVB(396,DA,1)),$P(^(1),U,12)]"" W *7,!,"This is finalized.  Do you want to 'unfinalize' it" S %=1 D YN^DICN I $D(%Y),%Y["?" W !!,"Enter Y if you wish to reopen this and be able to edit it,",!,"or N to leave it as is",!! G CHK
 G:$D(DTOUT) EXIT I SUPER=1,$D(%),%=1 S OLDDR=DR,DR="25///@",DIE="^DVB(396," D ^DIE S DR=OLDDR G EDIT1
 I SUPER=1,$D(%),%'=1 G SETUP
 I SUPER=0,$P(^DVB(396,DA,1),U,12)'="" S FDATE=$P(^(1),U,12) W !!,*7,"This record has already been finalized on ",$E(FDATE,4,5),"/",$E(FDATE,6,7),"/",$E(FDATE,2,3),! H 3 G SETUP
 G EDIT1
 ;
CHK1 ;CHECK STATUS OF EACH FIELD
 S NOFINAL=0
 F ZA=9,11,13,15,17,19,21,23,26,28 I $P(^DVB(396,DA,0),U,ZA)="P" S NOFINAL=1 Q
 Q:NOFINAL=1  I $P(^DVB(396,DA,1),U,7)="P" S NOFINAL=1 Q
 Q
CON ;continue
 W !!,"Press RETURN to continue or ""^"" to exit  " R ANS:DTIME S:'$T!(ANS=U) OUT=1
 Q

DVBAENVR
DVBAENVR ;ALB/JLU;environment check routine.;10/17/94
 ;;2.7;AMIE;;Apr 10, 1995
EN ;the main entry point of the enviroment check routine.
 N VAR,DVBA
 S VAR(1,0)="0,0,0,2,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 I '$D(DUZ)#2 DO  Q
 .S VAR(1,0)="1,0,0,1:2,0^DUZ must be set to a valid user to run this init."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 I '$D(DUZ(0)) DO  Q
 .S VAR(1,0)="1,0,0,1:2,0^DUZ(0) must be defined"
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 I DUZ(0)'="@" DO  Q
 .S VAR(1,0)="1,0,0,1:2,0^DUZ(0) must be equal to '@'"
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
EN1 ;around the normal DUZ checks
 ;FM CHECK
 S DVBA=$$VERSION^XPDUTL("VA FILEMAN")
 I +DVBA<20 DO  Q
 .S VAR(1,0)="1,0,0,1,0^Your site seems to be running a version of FileMan that is less than 20."
 .S VAR(2,0)="0,0,0,1:2,0^Please investigate the version of FileMan."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 ;KERNEL CHECK
 S DVBA=$$VERSION^XPDUTL("XU")
 I +DVBA<7.1 DO  Q
 .S VAR(1,0)="1,0,0,1,0^Your site seems to be running a version of Kernel that is less than 7.1"
 .S VAR(2,0)="0,0,0,1:2,0^Please investigate the version of Kernel."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 ;MAILMAN CHECK
 S DVBA=$$VERSION^XPDUTL("XM")
 I +DVBA<7.1 DO  Q
 .S VAR(1,0)="1,0,0,1,0^Your site seems to be running a version of MailMan that is less than 7.1"
 .S VAR(2,0)="0,0,0,1:2,0^Please investigate the version of MailMan."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 ;KERNEL TOOL KIT
 S DVBA=$$VERSION^XPDUTL("XT")
 I +DVBA<7.2 DO  Q
 .S VAR(1,0)="1,0,0,1,0^Your site seems to be running a version of Kernel Tool Kit less than 7.2."
 .S VAR(2,0)="0,0,0,1:2,0^Please investigate the version of Kernel Tool Kit."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 ;LAB
 S DVBA=$$VERSION^XPDUTL("LR")
 I +DVBA<5.0 DO  Q
 .S VAR(1,0)="1,0,0,1,0^Your site seems to be running a version of LAB. less than 5.0."
 .S VAR(2,0)="0,0,0,1:2,0^Please investigate the version of LAB."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 ;PIMS CHECK
 S DVBA=$$VERSION^XPDUTL("REGISTRATION")
 I +DVBA<5.3 DO  Q
 .S VAR(1,0)="1,0,0,1,0^Your site seems to be running a version of PIMS less than 5.3."
 .S VAR(2,0)="0,0,0,1:2,0^Please investigate the version of PIMS."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 ;HINQ check
 S DVBA=$$VERSION^XPDUTL("HINQ")
 I +DVBA<4.0 DO  Q
 .S VAR(1,0)="1,0,0,1,0^Your site seems to be running a version of HINQ less than 4.0."
 .S VAR(2,0)="0,0,0,1:2,0^Please investigate the version of HINQ."
 .D WR^DVBAUTL4("VAR")
 .K VAR,DIFQ
 .Q
 ;
 S VAR(1,0)="0,0,0,2,0^Environment check completed OK!"
 D WR^DVBAUTL4("VAR")
 K VAR
 Q

DVBAERMK
DVBAERMK ;557/THM-EDIT AMIE 7131 REMARKS; 21 JUL 89@0118
 ;;2.7;AMIE;;Apr 10, 1995
 ;
TERM D HOME^%ZIS
 S HD="EDIT 7131 REMARKS"
 ;
SETUP W @IOF,!?(IOM-$L(HD)\2),HD,!! S DIE="^DVB(396,",DR="[DVBA EDIT REMARKS]",DIC=DIE,DIC(0)="AEQM",DIC("A")="Enter PATIENT NAME: "
 D DICW^DVBAUTIL
 ;
EDIT D ^DIC G:X=U!(X="") EXIT W:Y<0 *7,"  ??" G:Y<0 EDIT I Y>0 S DA=+$P(Y,U,1) W !!
 D ^DIE H 3
 G SETUP
 ;
EXIT W @IOF D KILL^DVBAUTIL
 Q

DVBAFINL
DVBAFINL ;ALB/GTS-557/THM-AUTO-FINALIZE 7131 REQUESTS; 21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 I $D(DUZ)#2=0 W *7,!!,"Your user number is not set.",!! H 3 Q
 I DUZ'>0 W *7,!!,"Your user number is invalid.  Please log off and back on.",!! H 3 Q
 ;
SETUP I '$D(DT) S %DT="",X="T" D ^%DT S DT=Y
 S OPER=$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"Unknown operator"),CNT=0
 D HOME^%ZIS
 ;
EN W @IOF,!,"AUTOMATIC 7131 FINALIZATION - USER MODE",!!!,"This program will search the entire 7131 file",!,"and FINALIZE all requests that are ready."
ASK W !!,"Do you want to continue" S %=2 D YN^DICN
 I $D(%Y) I %Y["?" W !!,"Enter Y to go ahead and finalize all requests which are ready",!,"or N to exit.",!! H 1 G ASK
 G:%'=1 EXIT S %ZIS="AEQ",%ZIS("A")="Output device: " W ! D ^%ZIS K %ZIS G:POP EXIT
 I $D(IO("Q")) S ZTIO=ION,ZTRTN="EN1^DVBAFINL",ZTDESC="Automatic 7131 Finalization",ZTSAVE("OPER")="",ZTSAVE("CNT")=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! G EXIT
 ;
EN1 U IO W:(IOST?1"C-".E) @IOF
 W !,"The following Veterans had requests automatically finalized on " S Y=DT X ^DD("DD") W Y,!!
 W "Veteran name",?37,"Soc Sec #",?49,"Admission date",! F LINE=1:1:IOM W "-"
 W !! F DFN=0:0 S DFN=$O(^DVB(396,"B",DFN)) Q:DFN=""  F DA=0:0 S DA=$O(^DVB(396,"B",DFN,DA)) Q:DA=""  D CHK1
 W !!,"Total requests finalized: ",$J(CNT,4,0),!!
 G EXIT
 ;
CHK1 ;check status of each field
 S NOFINAL=0
 I '$D(^DVB(396,DA,1)) W !!,"Bad 7131 record for internal entry # ",DA,"!...Notify IRM!!" Q
 Q:$P(^DVB(396,DA,1),U,12)'=""
 F ZA=9,11,13,15,17,19,21,23,26,28 I $P(^DVB(396,DA,0),U,ZA)="P" S NOFINAL=1 Q
 Q:NOFINAL=1  I $P(^DVB(396,DA,1),U,7)="P" S NOFINAL=1 Q
 Q:NOFINAL=1
 W $P(^DPT(DFN,0),U,1),?37,$P(^DPT(DFN,0),U,9),?49 S Y=$P(^DVB(396,DA,0),U,4) X ^DD("DD") W Y,! I $Y>55 D HDR
 S DIE="^DVB(396,",DR="25///"_DT_";26///"_OPER D ^DIE
 S CNT=CNT+1 Q
 ;
EXIT I $D(ZTQUEUED)&(OPER'="Auto-finalized") D KILL^%ZTLOAD
 K ZA G KILL^DVBAUTIL
 ;
HDR W @IOF,!,"Automatic 7131 finalization on " S Y=DT X ^DD("DD") W Y,!!
 Q
 ;
ZTM D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) EXIT
 S OPER="Auto-finalized",CNT=0 I '$D(DT) S X="T" D ^%DT S DT=Y
 G EN1

DVBAI001
DVBAI001 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(31)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(31,0,"GL")
 ;;=^DIC(31,
 ;;^DIC("B","DISABILITY CONDITION",31)
 ;;=
 ;;^DIC(31,"%D",0)
 ;;=^^2^2^2940215^^^^
 ;;^DIC(31,"%D",1,0)
 ;;=This file contains the VA recognized Disability conditions as used
 ;;^DIC(31,"%D",2,0)
 ;;=when rating for compensation/pension.
 ;;^DD(31,0)
 ;;=FIELD^NL^10^6
 ;;^DD(31,0,"DDA")
 ;;=N
 ;;^DD(31,0,"DT")
 ;;=2940307
 ;;^DD(31,0,"ID",2)
 ;;=W:$D(^("0")) "   ",$P(^("0"),U,3)
 ;;^DD(31,0,"IX","AC",31,10)
 ;;=
 ;;^DD(31,0,"IX","ADVB",31,10)
 ;;=
 ;;^DD(31,0,"IX","B",31,.01)
 ;;=
 ;;^DD(31,0,"IX","C",31,2)
 ;;=
 ;;^DD(31,0,"NM","DISABILITY CONDITION")
 ;;=
 ;;^DD(31,0,"PT",2.04,.01)
 ;;=
 ;;^DD(31,0,"PT",396.61,.01)
 ;;=
 ;;^DD(31,0,"PT",396.701,.01)
 ;;=
 ;;^DD(31,0,"PT",662.06,.01)
 ;;=
 ;;^DD(31,0,"PT",8984.1,.02)
 ;;=
 ;;^DD(31,0,"PT",8984.2,.02)
 ;;=
 ;;^DD(31,.01,0)
 ;;=NAME^RFX^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>45!($L(X)<4)!'(X'?1P.E) X
 ;;^DD(31,.01,1,0)
 ;;=^.1
 ;;^DD(31,.01,1,1,0)
 ;;=31^B
 ;;^DD(31,.01,1,1,1)
 ;;=S ^DIC(31,"B",$E(X,1,30),DA)=""
 ;;^DD(31,.01,1,1,2)
 ;;=K ^DIC(31,"B",$E(X,1,30),DA)
 ;;^DD(31,.01,3)
 ;;=ANSWER MUST BE 4-45 CHARACTERS IN LENGTH
 ;;^DD(31,.01,10)
 ;;=
 ;;^DD(31,.01,21,0)
 ;;=^^2^2^2930614^^^^
 ;;^DD(31,.01,21,1,0)
 ;;=VBA DISABILITY CODES
 ;;^DD(31,.01,21,2,0)
 ;;=MP-6,PART IV Supp 4.1  401.02f
 ;;^DD(31,.01,"DT")
 ;;=2920312
 ;;^DD(31,10,0)
 ;;=LONG DESCRIPTION^F^^1;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>200!($L(X)<1) X
 ;;^DD(31,10,1,0)
 ;;=^.1
 ;;^DD(31,10,1,1,0)
 ;;=31^ADVB^MUMPS
 ;;^DD(31,10,1,1,1)
 ;;=S %="^DIC(31,""ADVB"",I,DA)" D S^XTLKWIC
 ;;^DD(31,10,1,1,2)
 ;;=S %="^DIC(31,""ADVB"",I,DA)" D K^XTLKWIC
 ;;^DD(31,10,1,1,"%D",0)
 ;;=^^1^1^2950126^^^^
 ;;^DD(31,10,1,1,"%D",1,0)
 ;;=This is the MTLU cross reference lookup for the AMIE application.
 ;;^DD(31,10,1,1,"DT")
 ;;=2940126
 ;;^DD(31,10,1,2,0)
 ;;=31^AC^MUMPS
 ;;^DD(31,10,1,2,1)
 ;;=S ^DIC(31,"AC",$E(X,1,80),DA)=""
 ;;^DD(31,10,1,2,2)
 ;;=K ^DIC(31,"AC",$E(X,1,80),DA)
 ;;^DD(31,10,1,2,"%D",0)
 ;;=^^3^3^2940325^^^
 ;;^DD(31,10,1,2,"%D",1,0)
 ;;=This cross reference was created so that a lookup could be performed on it
 ;;^DD(31,10,1,2,"%D",2,0)
 ;;=using IX or MIX.  It was created so that interactive FM could not use it.
 ;;^DD(31,10,1,2,"%D",3,0)
 ;;=As a result users will not get confused at a selection prompt.
 ;;^DD(31,10,1,2,"DT")
 ;;=2940210
 ;;^DD(31,10,3)
 ;;=Answer must be 1-200 characters in length.
 ;;^DD(31,10,21,0)
 ;;=^^1^1^2940126^
 ;;^DD(31,10,21,1,0)
 ;;=This is the long description per the VBA Rating Schedule.
 ;;^DD(31,10,"DT")
 ;;=2940307

DVBAI002
DVBAI002 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396,0,"GL")
 ;;=^DVB(396,
 ;;^DIC("B","FORM 7131",396)
 ;;=
 ;;^DIC(396,"%",0)
 ;;=^1.005^1^1
 ;;^DIC(396,"%",1,0)
 ;;=DVBA
 ;;^DIC(396,"%","B","DVBA",1)
 ;;=
 ;;^DIC(396,"%D",0)
 ;;=^^17^17^2950126^^^^
 ;;^DIC(396,"%D",1,0)
 ;;=Holds all requests for 7131 information.  This is the information which
 ;;^DIC(396,"%D",2,0)
 ;;=was requested on the old paper 7131 forms.
 ;;^DIC(396,"%D",3,0)
 ;;= 
 ;;^DIC(396,"%D",4,0)
 ;;=Node 6 was added with Version 2.7 of AMIE.  This node contains the
 ;;^DIC(396,"%D",5,0)
 ;;=divisions a selected report on a 7131 has been transferred to.
 ;;^DIC(396,"%D",6,0)
 ;;=Node 7 was added with Version 2.7 of AMIE.  This node contains the
 ;;^DIC(396,"%D",7,0)
 ;;=dates a report on a 7131 was transferred to another division.
 ;;^DIC(396,"%D",8,0)
 ;;=These nodes are used only by Multidivisional facilities that transfer
 ;;^DIC(396,"%D",9,0)
 ;;=reports on a 7131.  The decimal portion of the field numbers for the
 ;;^DIC(396,"%D",10,0)
 ;;=fields on nodes 6 and 7 indicates the node the field exists on.
 ;;^DIC(396,"%D",11,0)
 ;;=The piece position for each field on nodes 6 and 7 corresponds to the
 ;;^DIC(396,"%D",12,0)
 ;;=piece position of its respective report status field on that report's node.
 ;;^DIC(396,"%D",13,0)
 ;;= 
 ;;^DIC(396,"%D",14,0)
 ;;=NOTE:  The 'AE' and 'AF' cross-references are specialized MUMPS cross-
 ;;^DIC(396,"%D",15,0)
 ;;=references used to implement the Divisional Transfer of reports on a
 ;;^DIC(396,"%D",16,0)
 ;;=7131 request.  Please follow the technical descriptions of the above
 ;;^DIC(396,"%D",17,0)
 ;;=cross-references when reindexing.
 ;;^DD(396,0)
 ;;=FIELD^^30^89
 ;;^DD(396,0,"DDA")
 ;;=N
 ;;^DD(396,0,"DT")
 ;;=2941207
 ;;^DD(396,0,"IX","AC",396,6.82)
 ;;=
 ;;^DD(396,0,"IX","AE1",396,4.6)
 ;;=
 ;;^DD(396,0,"IX","AE10",396,9.7)
 ;;=
 ;;^DD(396,0,"IX","AE11",396,11.6)
 ;;=
 ;;^DD(396,0,"IX","AE12",396,11.7)
 ;;=
 ;;^DD(396,0,"IX","AE13",396,13.6)
 ;;=
 ;;^DD(396,0,"IX","AE14",396,13.7)
 ;;=
 ;;^DD(396,0,"IX","AE15",396,15.6)
 ;;=
 ;;^DD(396,0,"IX","AE16",396,15.7)
 ;;=
 ;;^DD(396,0,"IX","AE17",396,17.6)
 ;;=
 ;;^DD(396,0,"IX","AE18",396,17.7)
 ;;=
 ;;^DD(396,0,"IX","AE19",396,18.6)
 ;;=
 ;;^DD(396,0,"IX","AE2",396,4.7)
 ;;=
 ;;^DD(396,0,"IX","AE20",396,18.7)
 ;;=
 ;;^DD(396,0,"IX","AE21",396,20.6)
 ;;=
 ;;^DD(396,0,"IX","AE22",396,20.7)
 ;;=
 ;;^DD(396,0,"IX","AE23",396,23)
 ;;=
 ;;^DD(396,0,"IX","AE24",396,29)
 ;;=
 ;;^DD(396,0,"IX","AE3",396,5.6)
 ;;=
 ;;^DD(396,0,"IX","AE4",396,5.7)
 ;;=
 ;;^DD(396,0,"IX","AE5",396,6.6)
 ;;=
 ;;^DD(396,0,"IX","AE6",396,6.7)
 ;;=
 ;;^DD(396,0,"IX","AE7",396,7.6)
 ;;=
 ;;^DD(396,0,"IX","AE8",396,7.7)
 ;;=
 ;;^DD(396,0,"IX","AE9",396,9.6)
 ;;=
 ;;^DD(396,0,"IX","AF1",396,4.6)
 ;;=
 ;;^DD(396,0,"IX","AF10",396,9.7)
 ;;=
 ;;^DD(396,0,"IX","AF11",396,11.6)
 ;;=
 ;;^DD(396,0,"IX","AF12",396,11.7)
 ;;=
 ;;^DD(396,0,"IX","AF13",396,13.6)
 ;;=
 ;;^DD(396,0,"IX","AF14",396,13.7)
 ;;=
 ;;^DD(396,0,"IX","AF15",396,15.6)
 ;;=
 ;;^DD(396,0,"IX","AF16",396,15.7)
 ;;=
 ;;^DD(396,0,"IX","AF17",396,17.6)
 ;;=
 ;;^DD(396,0,"IX","AF18",396,17.7)
 ;;=
 ;;^DD(396,0,"IX","AF19",396,18.6)
 ;;=
 ;;^DD(396,0,"IX","AF2",396,4.7)
 ;;=
 ;;^DD(396,0,"IX","AF20",396,18.7)
 ;;=
 ;;^DD(396,0,"IX","AF21",396,20.6)
 ;;=
 ;;^DD(396,0,"IX","AF22",396,20.7)
 ;;=
 ;;^DD(396,0,"IX","AF3",396,5.6)
 ;;=
 ;;^DD(396,0,"IX","AF4",396,5.7)
 ;;=
 ;;^DD(396,0,"IX","AF5",396,6.6)
 ;;=
 ;;^DD(396,0,"IX","AF6",396,6.7)
 ;;=
 ;;^DD(396,0,"IX","AF7",396,7.6)
 ;;=
 ;;^DD(396,0,"IX","AF8",396,7.7)
 ;;=
 ;;^DD(396,0,"IX","AF9",396,9.6)
 ;;=
 ;;^DD(396,0,"IX","B",396,.01)
 ;;=
 ;;^DD(396,0,"IX","E",396,23)
 ;;=
 ;;^DD(396,0,"IX","F",396,25)
 ;;=
 ;;^DD(396,0,"IX","G",396,3)
 ;;=
 ;;^DD(396,0,"NM","FORM 7131")
 ;;=
 ;;^DD(396,.01,0)
 ;;=PATIENT NAME^RP2'^DPT(^0;1^Q
 ;;^DD(396,.01,1,0)
 ;;=^.1^^-1
 ;;^DD(396,.01,1,1,0)
 ;;=396^B
 ;;^DD(396,.01,1,1,1)
 ;;=S ^DVB(396,"B",$E(X,1,30),DA)=""
 ;;^DD(396,.01,1,1,2)
 ;;=K ^DVB(396,"B",$E(X,1,30),DA)
 ;;^DD(396,.01,3)
 ;;=Enter the Veteran's name as it appears on the records or the last four.  The SSN may also be used for lookup.
 ;;^DD(396,.01,21,0)
 ;;=^^2^2^2930503^^^
 ;;^DD(396,.01,21,1,0)
 ;;=Enter the patient's name, 'last four', or social security number.
 ;;^DD(396,.01,21,2,0)
 ;;=This is the name of the patient from the PATIENT file.
 ;;^DD(396,.01,"DT")
 ;;=2890920
 ;;^DD(396,.5,0)
 ;;=ADDITIONAL REMARKS^396.02^^5;0
 ;;^DD(396,.5,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396,.5,21,1,0)
 ;;=This field holds the remarks entered for a 7131 request.  It is a word
 ;;^DD(396,.5,21,2,0)
 ;;=processing field.
 ;;^DD(396,1,0)
 ;;=C-NUMBER^CJ9^^ ; ^X ^DD(396,1,9.2) S Y(396,1,101)=$S($D(^DPT(D0,.31)):^(.31),1:"") S X=$P(Y(396,1,101),U,3) S D0=Y(396,1,80)

DVBAI003
DVBAI003 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,1,9)
 ;;=^
 ;;^DD(396,1,9.01)
 ;;=2^.313;396^.01
 ;;^DD(396,1,9.1)
 ;;=PATIENT NAME:CLAIM NUMBER
 ;;^DD(396,1,9.2)
 ;;=S Y(396,1,80)=$S($D(D0):D0,1:""),Y(396,1,1)=$S($D(^DVB(396,D0,0)):^(0),1:""),D0=$P(Y(396,1,1),U,1) S:'$D(^DPT(+D0,0)) D0=-1
 ;;^DD(396,1,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,1,21,1,0)
 ;;=The patient claim number, as it appears in the PATIENT file (#2).
 ;;^DD(396,2,0)
 ;;=SOC SEC NUMBER^CJ9^^ ; ^X ^DD(396,2,9.2) S X=$P(Y(396,2,101),U,9) S D0=Y(396,2,80)
 ;;^DD(396,2,9)
 ;;=^
 ;;^DD(396,2,9.01)
 ;;=2^.09;396^.01
 ;;^DD(396,2,9.1)
 ;;=PATIENT NAME:SSN
 ;;^DD(396,2,9.2)
 ;;=S Y(396,2,80)=$S($D(D0):D0,1:""),Y(396,2,1)=$S($D(^DVB(396,D0,0)):^(0),1:""),D0=$P(Y(396,2,1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S Y(396,2,101)=$S($D(^DPT(D0,0)):^(0),1:"")
 ;;^DD(396,2,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,2,21,1,0)
 ;;=This is the patient's SSN as it appears in the PATIENT file.
 ;;^DD(396,2,"DT")
 ;;=2890902
 ;;^DD(396,3,0)
 ;;=ADMISSION DATE^D^^0;4^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,3,1,0)
 ;;=^.1
 ;;^DD(396,3,1,1,0)
 ;;=396^G
 ;;^DD(396,3,1,1,1)
 ;;=S ^DVB(396,"G",$E(X,1,30),DA)=""
 ;;^DD(396,3,1,1,2)
 ;;=K ^DVB(396,"G",$E(X,1,30),DA)
 ;;^DD(396,3,3)
 ;;=This field is computer maintained.  Alter only for corrections.
 ;;^DD(396,3,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,3,21,1,0)
 ;;=This is the admission date this request is associated with.
 ;;^DD(396,3,"DT")
 ;;=2900222
 ;;^DD(396,4,0)
 ;;=NOTICE OF DISCHARGE^RS^YES:YES;NO:NO;^0;5^Q
 ;;^DD(396,4,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,4,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,4,21,1,0)
 ;;=This field indicates if a notice of discharge is requested.
 ;;^DD(396,4.5,0)
 ;;=NOTICE/DISCHG STATUS^S^P:PENDING;C:COMPLETED;^0;9^Q
 ;;^DD(396,4.5,1,0)
 ;;=^.1^^0
 ;;^DD(396,4.5,3)
 ;;=Enter C if this item is completed or RETURN to leave item as pending.
 ;;^DD(396,4.5,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,4.5,21,1,0)
 ;;=Indicates the status of the notice of discharge report.
 ;;^DD(396,4.5,"DT")
 ;;=2891229
 ;;^DD(396,4.6,0)
 ;;=NOTICE OF DISCHARGE DIVISION^P40.8'^DG(40.8,^6;9^Q
 ;;^DD(396,4.6,1,0)
 ;;=^.1
 ;;^DD(396,4.6,1,1,0)
 ;;=396^AE1^MUMPS
 ;;^DD(396,4.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,9) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,4)=""
 ;;^DD(396,4.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,9) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,4)
 ;;^DD(396,4.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,4.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,4.6,1,1,"%D",2,0)
 ;;=It is on the Notice of Discharge Tran Date and Division.
 ;;^DD(396,4.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,4.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex 
 ;;^DD(396,4.6,1,1,"%D",5,0)
 ;;=either the Notice of Discharge Tran Date or Division.  This will NOT reindex
 ;;^DD(396,4.6,1,1,"%D",6,0)
 ;;=the 'AE' X-ref on other fields in the file.
 ;;^DD(396,4.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,4.6,1,2,0)
 ;;=396^AF1^MUMPS
 ;;^DD(396,4.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,9) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),4)=""
 ;;^DD(396,4.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,9) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),4)
 ;;^DD(396,4.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,4.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,4.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,4.6,1,2,"%D",3,0)
 ;;=It is on the Notice of Discharge Tran Date and Division.
 ;;^DD(396,4.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,4.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex 
 ;;^DD(396,4.6,1,2,"%D",6,0)
 ;;=either the Notice of Discharge Tran Date or Division.  This will NOT reindex
 ;;^DD(396,4.6,1,2,"%D",7,0)
 ;;=the 'AF' X-ref on other fields in the file.
 ;;^DD(396,4.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,4.6,3)
 ;;=Enter the division the Notice of Dishcarge is to be completed by.
 ;;^DD(396,4.6,21,0)
 ;;=^^3^3^2941130^^
 ;;^DD(396,4.6,21,1,0)
 ;;=This field is a pointer to the Medical Center Division file.  It contains
 ;;^DD(396,4.6,21,2,0)
 ;;=the division the Notice of Discharge requested on the 7131 has been
 ;;^DD(396,4.6,21,3,0)
 ;;=transferred to.
 ;;^DD(396,4.6,23,0)
 ;;=^^1^1^2941216^^^
 ;;^DD(396,4.6,23,1,0)
 ;;=This field is a pointer to file 40.8.
 ;;^DD(396,4.6,"DT")
 ;;=2941201
 ;;^DD(396,4.7,0)
 ;;=NOTICE OF DISCHARGE TRAN DATE^D^^7;9^S %DT="ETX" D ^%DT S X=Y K:Y<1 X

DVBAI004
DVBAI004 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,4.7,1,0)
 ;;=^.1
 ;;^DD(396,4.7,1,1,0)
 ;;=396^AE2^MUMPS
 ;;^DD(396,4.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,9) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,4)=""
 ;;^DD(396,4.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,9) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,4)
 ;;^DD(396,4.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396,4.7,1,1,"%D",1,0)
 ;;=This cross reference is used to print the New 7131 Report (Long).
 ;;^DD(396,4.7,1,1,"%D",2,0)
 ;;=It is on the Notice of Discharge Tran Date and Division.
 ;;^DD(396,4.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,4.7,1,2,0)
 ;;=396^AF2^MUMPS
 ;;^DD(396,4.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,9) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,4)=""
 ;;^DD(396,4.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,9) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,4)
 ;;^DD(396,4.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396,4.7,1,2,"%D",1,0)
 ;;=This cross reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,4.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,4.7,1,2,"%D",3,0)
 ;;=It is on the Notice of Discharge Tran Date and Division.
 ;;^DD(396,4.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,4.7,3)
 ;;=Enter the date the Notice of Discharge was transferred to another division.
 ;;^DD(396,4.7,21,0)
 ;;=^^2^2^2941130^
 ;;^DD(396,4.7,21,1,0)
 ;;=This field contains the date the Notice of Discharge was transferred to
 ;;^DD(396,4.7,21,2,0)
 ;;=another division at a multi-divisional facility.
 ;;^DD(396,4.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,4.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,4.7,"DT")
 ;;=2941201
 ;;^DD(396,4.8,0)
 ;;=NOTICE/DISCHG COMPLETION DATE^D^^0;10^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,4.8,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,4.8,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,4.8,21,1,0)
 ;;=Date the notice of discharge was completed.
 ;;^DD(396,4.8,"DT")
 ;;=2900222
 ;;^DD(396,4.9,0)
 ;;=EDIT4.5^F^^1;13^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,4.9,3)
 ;;=Computer maintained field.  Alter only for corrections.
 ;;^DD(396,4.9,21,0)
 ;;=^^1^1^2930503^^^
 ;;^DD(396,4.9,21,1,0)
 ;;=Holds name of person who last edited the NOTICE OF DISCHARGE field.
 ;;^DD(396,5,0)
 ;;=HOSPITAL SUMMARY^RS^YES:YES;NO:NO;^0;6^Q
 ;;^DD(396,5,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,5,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,5,21,1,0)
 ;;=Indicates whether a hospital summary has been selected.
 ;;^DD(396,5.5,0)
 ;;=HOSPITAL SUMMARY STATUS^S^P:PENDING;C:COMPLETED;^0;11^Q
 ;;^DD(396,5.5,1,0)
 ;;=^.1^^0
 ;;^DD(396,5.5,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,5.5,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,5.5,21,1,0)
 ;;=Indicates the status of the hospital summary report.
 ;;^DD(396,5.5,"DT")
 ;;=2891229
 ;;^DD(396,5.6,0)
 ;;=HOSPITAL SUMMARY DIVISION^P40.8'^DG(40.8,^6;11^Q
 ;;^DD(396,5.6,1,0)
 ;;=^.1
 ;;^DD(396,5.6,1,1,0)
 ;;=396^AE3^MUMPS
 ;;^DD(396,5.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,11) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,5)=""
 ;;^DD(396,5.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,11) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,5)
 ;;^DD(396,5.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,5.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,5.6,1,1,"%D",2,0)
 ;;=It is on the Hospital Summary Tran Date and Division.
 ;;^DD(396,5.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,5.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex 
 ;;^DD(396,5.6,1,1,"%D",5,0)
 ;;=either the Hospital Summary Tran Date or Division.  This will NOT reindex
 ;;^DD(396,5.6,1,1,"%D",6,0)
 ;;=the 'AE' X-ref on other fields in the file.
 ;;^DD(396,5.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,5.6,1,2,0)
 ;;=396^AF3^MUMPS
 ;;^DD(396,5.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,11) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),5)=""
 ;;^DD(396,5.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,11) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),5)
 ;;^DD(396,5.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,5.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,5.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,5.6,1,2,"%D",3,0)
 ;;=It is on the Hospital Summary Tran Date and Division.
 ;;^DD(396,5.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,5.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex 

DVBAI005
DVBAI005 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,5.6,1,2,"%D",6,0)
 ;;=either the Hospital Summary Tran Date or Division.  This will NOT reindex
 ;;^DD(396,5.6,1,2,"%D",7,0)
 ;;=the 'AF' X-ref on other fields in the file.
 ;;^DD(396,5.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,5.6,3)
 ;;=Enter the division the Hospital Summary is to be completed by.
 ;;^DD(396,5.6,21,0)
 ;;=^^2^2^2941129^
 ;;^DD(396,5.6,21,1,0)
 ;;=This field contains the division the Hospital Summary on the 7131 was
 ;;^DD(396,5.6,21,2,0)
 ;;=transferred to.
 ;;^DD(396,5.6,23,0)
 ;;=^^1^1^2941129^
 ;;^DD(396,5.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division File (40.8).
 ;;^DD(396,5.6,"DT")
 ;;=2941201
 ;;^DD(396,5.7,0)
 ;;=HOSPITAL SUMMARY TRAN DATE^D^^7;11^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,5.7,1,0)
 ;;=^.1
 ;;^DD(396,5.7,1,1,0)
 ;;=396^AE4^MUMPS
 ;;^DD(396,5.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,11) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,5)=""
 ;;^DD(396,5.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,11) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,5)
 ;;^DD(396,5.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396,5.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,5.7,1,1,"%D",2,0)
 ;;=It is on the Hospital Summary Tran Date and Division.
 ;;^DD(396,5.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,5.7,1,2,0)
 ;;=396^AF4^MUMPS
 ;;^DD(396,5.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,11) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,5)=""
 ;;^DD(396,5.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,11) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,5)
 ;;^DD(396,5.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396,5.7,1,2,"%D",1,0)
 ;;=This cross reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,5.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,5.7,1,2,"%D",3,0)
 ;;=It is on the Hospital Summary Tran Date and Division.
 ;;^DD(396,5.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,5.7,3)
 ;;=Enter the date the Hospital Summary was transferred to another division.
 ;;^DD(396,5.7,21,0)
 ;;=^^2^2^2941130^
 ;;^DD(396,5.7,21,1,0)
 ;;=This field contains the date the Hospital Summary was transferred to
 ;;^DD(396,5.7,21,2,0)
 ;;=another division at a multi-divisional facility.
 ;;^DD(396,5.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,5.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,5.7,"DT")
 ;;=2941201
 ;;^DD(396,5.8,0)
 ;;=HOSP SUMMARY COMPLETION DATE^D^^0;12^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,5.8,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,5.8,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,5.8,21,1,0)
 ;;=The date the hospital summary was completed.
 ;;^DD(396,5.8,"DT")
 ;;=2900222
 ;;^DD(396,5.9,0)
 ;;=EDIT5.5^F^^1;14^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,5.9,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,5.9,21,0)
 ;;=^^1^1^2930503^^^
 ;;^DD(396,5.9,21,1,0)
 ;;=Holds the name of the person who last edited the hospital summary status.
 ;;^DD(396,6,0)
 ;;=CERTIFICATE (21-DAY)^RS^YES:YES;NO:NO;^0;7^Q
 ;;^DD(396,6,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,6,21,0)
 ;;=^^1^1^2940304^^
 ;;^DD(396,6,21,1,0)
 ;;=Indicates whether a 21 day certificate is selected.
 ;;^DD(396,6.5,0)
 ;;=(21-DAY) CERTIFICATE STATUS^S^P:PENDING;C:COMPLETED;^0;13^Q
 ;;^DD(396,6.5,1,0)
 ;;=^.1^^0
 ;;^DD(396,6.5,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,6.5,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,6.5,21,1,0)
 ;;=Indicates the status of the 21 day certificate.
 ;;^DD(396,6.5,"DT")
 ;;=2891229
 ;;^DD(396,6.6,0)
 ;;=CERTIFICATE (21-DAY) DIVISION^P40.8'^DG(40.8,^6;13^Q
 ;;^DD(396,6.6,1,0)
 ;;=^.1
 ;;^DD(396,6.6,1,1,0)
 ;;=396^AE5^MUMPS
 ;;^DD(396,6.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,13) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,6)=""
 ;;^DD(396,6.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,13) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,6)
 ;;^DD(396,6.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,6.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,6.6,1,1,"%D",2,0)
 ;;=It is on the 21-Day Cert Tran Date and Division.
 ;;^DD(396,6.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,6.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex 
 ;;^DD(396,6.6,1,1,"%D",5,0)
 ;;=either the 21-Day Cert Tran Date or Division.  This will NOT reindex
 ;;^DD(396,6.6,1,1,"%D",6,0)
 ;;=the 'AE' X-ref on other fields in the file.
 ;;^DD(396,6.6,1,1,"DT")
 ;;=2941201

DVBAI006
DVBAI006 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,6.6,1,2,0)
 ;;=396^AF5^MUMPS
 ;;^DD(396,6.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,13) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),6)=""
 ;;^DD(396,6.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,13) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),6)
 ;;^DD(396,6.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,6.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and
 ;;^DD(396,6.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,6.6,1,2,"%D",3,0)
 ;;=It is on the 21-Day Cert Tran Date and Division.
 ;;^DD(396,6.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,6.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex 
 ;;^DD(396,6.6,1,2,"%D",6,0)
 ;;=either the 21-Day Cert Tran Date or Division.  This will NOT reindex
 ;;^DD(396,6.6,1,2,"%D",7,0)
 ;;=the 'AF' X-ref on other fields in the file.
 ;;^DD(396,6.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,6.6,3)
 ;;=Enter the division the 21-Day Certificate is to be completed by.
 ;;^DD(396,6.6,21,0)
 ;;=^^2^2^2941207^^^
 ;;^DD(396,6.6,21,1,0)
 ;;=This field contains the division the 21 Day Certificate was transferred to
 ;;^DD(396,6.6,21,2,0)
 ;;=on the 7131.
 ;;^DD(396,6.6,23,0)
 ;;=^^1^1^2941207^^^
 ;;^DD(396,6.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,6.6,"DT")
 ;;=2941201
 ;;^DD(396,6.7,0)
 ;;=CERTIFICATE (21-DAY) TRAN DATE^D^^7;13^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,6.7,1,0)
 ;;=^.1
 ;;^DD(396,6.7,1,1,0)
 ;;=396^AE6^MUMPS
 ;;^DD(396,6.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,13) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,6)=""
 ;;^DD(396,6.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,13) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,6)
 ;;^DD(396,6.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396,6.7,1,1,"%D",1,0)
 ;;=This cross reference is used to print the New 7131 Report (Long).
 ;;^DD(396,6.7,1,1,"%D",2,0)
 ;;=It is on the 21-Day Cert Tran Date and Division.
 ;;^DD(396,6.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,6.7,1,2,0)
 ;;=396^AF6^MUMPS
 ;;^DD(396,6.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,13) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,6)=""
 ;;^DD(396,6.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,13) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,6)
 ;;^DD(396,6.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396,6.7,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,6.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,6.7,1,2,"%D",3,0)
 ;;=It is on the 21-Day Cert Tran Date and Division.
 ;;^DD(396,6.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,6.7,3)
 ;;=Enter the date the 21-Day Cert was transferred to another division.
 ;;^DD(396,6.7,21,0)
 ;;=^^2^2^2941207^^
 ;;^DD(396,6.7,21,1,0)
 ;;=This field contains the date the 21-Day Certificate was transferred to
 ;;^DD(396,6.7,21,2,0)
 ;;=another division at a multi-divisional facility.
 ;;^DD(396,6.7,23,0)
 ;;=^^1^1^2941207^^
 ;;^DD(396,6.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,6.7,"DT")
 ;;=2941201
 ;;^DD(396,6.8,0)
 ;;=(21-DAY) COMPLETION DATE^D^^0;14^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,6.8,1,0)
 ;;=^.1^^0
 ;;^DD(396,6.8,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,6.8,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,6.8,21,1,0)
 ;;=Indicates the date the 21 day certificate was completed.
 ;;^DD(396,6.8,"DT")
 ;;=2940707
 ;;^DD(396,6.81,0)
 ;;=21 DAY CERT TEXT^396.01^^3;0
 ;;^DD(396,6.81,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,6.81,21,1,0)
 ;;=This field contains the text of the 21 day certificate.
 ;;^DD(396,6.82,0)
 ;;=21 DAY CERT RELEASE STATUS^S^R:RELEASED, READY TO PRINT;P:PRINTED BY RO;N:NEW;^4;1^Q
 ;;^DD(396,6.82,1,0)
 ;;=^.1
 ;;^DD(396,6.82,1,1,0)
 ;;=396^AC^MUMPS
 ;;^DD(396,6.82,1,1,1)
 ;;=N DVBALOC,DVBADA S DVBADA=$P(^DVB(396,DA,0),U,1),DVBALOC=$$STATION^DVBAUTL1(DVBADA) Q:DVBALOC=-1  S ^DVB(396,"AC",DVBALOC,$E(X,1,30),DA)=""
 ;;^DD(396,6.82,1,1,2)
 ;;=N DVBALOC,DVBADA S DVBADA=$P(^DVB(396,DA,0),U,1),DVBALOC=$$STATION^DVBAUTL1(DVBADA) Q:DVBALOC=-1  K ^DVB(396,"AC",DVBALOC,$E(X,1,30),DA)
 ;;^DD(396,6.82,1,1,"%D",0)
 ;;=^^2^2^2950104^^^^
 ;;^DD(396,6.82,1,1,"%D",1,0)
 ;;=This cross reference orders 21 Day Certificates by their release status and
 ;;^DD(396,6.82,1,1,"%D",2,0)
 ;;=Claim folder location.
 ;;^DD(396,6.82,1,1,"DT")
 ;;=2950104
 ;;^DD(396,6.82,3)
 ;;=This is maintained by editing programs.  Change only for corrections.
 ;;^DD(396,6.82,21,0)
 ;;=^^3^3^2930503^^^^

DVBAI007
DVBAI007 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,6.82,21,1,0)
 ;;=Indicates the various stages of the 21 day certificate process.  There are
 ;;^DD(396,6.82,21,2,0)
 ;;=three stages defined here; released and ready to be printed by the RO, 
 ;;^DD(396,6.82,21,3,0)
 ;;=printed by the RO, and new - ready for processing.
 ;;^DD(396,6.82,"DT")
 ;;=2950104
 ;;^DD(396,6.83,0)
 ;;=21 DAY CERT MAS RELEASE DATE^D^^4;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,6.83,3)
 ;;=Enter the date the 21-day certificate was released by MAS.
 ;;^DD(396,6.83,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,6.83,21,1,0)
 ;;=This is the date the certificate was released by MAS to the Regional Office.
 ;;^DD(396,6.83,"DT")
 ;;=2900222
 ;;^DD(396,6.84,0)
 ;;=21 DAY CERT RELEASED BY^P200'^VA(200,^4;3^Q
 ;;^DD(396,6.84,3)
 ;;=Enter the DUZ or name of the person releasing the certificate.
 ;;^DD(396,6.84,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396,6.84,21,1,0)
 ;;=This field contains the name of the person who released the 21 day
 ;;^DD(396,6.84,21,2,0)
 ;;=certificate.
 ;;^DD(396,6.84,"DT")
 ;;=2930128
 ;;^DD(396,6.85,0)
 ;;=DATE 21 DAY CERT PRINTED BY RO^D^^4;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,6.85,3)
 ;;=This is the date the certificate was actually printed by the Regional Office.
 ;;^DD(396,6.85,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,6.85,21,1,0)
 ;;=Contains the date the 21 day certificate was printed by the Regional Office.
 ;;^DD(396,6.85,"DT")
 ;;=2900222
 ;;^DD(396,6.86,0)
 ;;=21 DAY CERT TO DATE^D^^4;5^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,6.86,3)
 ;;=This is the date through which the certificate length of stay was calculated.
 ;;^DD(396,6.86,21,0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396,6.86,21,1,0)
 ;;=Contains the date to which the 21 day certificate length of stay
 ;;^DD(396,6.86,21,2,0)
 ;;=was calculated.
 ;;^DD(396,6.86,"DT")
 ;;=2900301
 ;;^DD(396,6.87,0)
 ;;=21 DAY CERT WARD^F^^4;6^K:$L(X)>15!($L(X)<1) X
 ;;^DD(396,6.87,3)
 ;;=Enter the ward of the patient on the certificate date.
 ;;^DD(396,6.87,21,0)
 ;;=^^2^2^2940304^^
 ;;^DD(396,6.87,21,1,0)
 ;;=Contains the ward the patient was on when the 21 day certificate was
 ;;^DD(396,6.87,21,2,0)
 ;;=generated.
 ;;^DD(396,6.88,0)
 ;;=21 DAY CERT BED^F^^4;7^K:$L(X)>10!($L(X)<1) X
 ;;^DD(396,6.88,3)
 ;;=Enter the bed number of the patient on the certificate date.
 ;;^DD(396,6.88,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396,6.88,21,1,0)
 ;;=Contains the location of the bed the patient occupied when the certificate
 ;;^DD(396,6.88,21,2,0)
 ;;=was generated.
 ;;^DD(396,6.89,0)
 ;;=21 DAY CERT PRINTED BY^F^^4;8^K:$L(X)>35!($L(X)<3) X
 ;;^DD(396,6.89,.1)
 ;;=
 ;;^DD(396,6.89,3)
 ;;=The name of the person at the Regional Office who actually printed out the 21-day certificate.
 ;;^DD(396,6.89,21,0)
 ;;=^^1^1^2930503^^^
 ;;^DD(396,6.89,21,1,0)
 ;;=This is the name of the Regional Office employee who printed the certificate.
 ;;^DD(396,6.9,0)
 ;;=EDIT6.5^F^^1;15^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,6.9,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,6.9,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,6.9,21,1,0)
 ;;=Holds the name of the person who last edited the 21 day certificate status.
 ;;^DD(396,7,0)
 ;;=OTHER/EXAM (REVIEW REMARKS)^RS^YES:YES;NO:NO;^0;8^Q
 ;;^DD(396,7,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,7,21,0)
 ;;=^^2^2^2950210^^^
 ;;^DD(396,7,21,1,0)
 ;;=Indicates that the user should review the REMARKS section for further 
 ;;^DD(396,7,21,2,0)
 ;;=instructions concerning this request.
 ;;^DD(396,7,"DT")
 ;;=2950210
 ;;^DD(396,7.6,0)
 ;;=OTHER/EXAM LISTED IN REM DIV^P40.8'^DG(40.8,^6;15^Q
 ;;^DD(396,7.6,1,0)
 ;;=^.1
 ;;^DD(396,7.6,1,1,0)
 ;;=396^AE7^MUMPS
 ;;^DD(396,7.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,15) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,7)=""
 ;;^DD(396,7.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,15) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,7)
 ;;^DD(396,7.6,1,1,"%D",0)
 ;;=^^6^6^2950214^^^^
 ;;^DD(396,7.6,1,1,"%D",1,0)
 ;;=This cross reference is used to print the New 7131 Report (Long).
 ;;^DD(396,7.6,1,1,"%D",2,0)
 ;;=It is on the OTHER/EXAM LISTED TRAN DATE and Division.
 ;;^DD(396,7.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,7.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex 
 ;;^DD(396,7.6,1,1,"%D",5,0)
 ;;=either the OTHER/EXAM LISTED TRAN DATE or Division.  This will NOT 
 ;;^DD(396,7.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,7.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,7.6,1,2,0)
 ;;=396^AF7^MUMPS
 ;;^DD(396,7.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,15) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),7)=""

DVBAI008
DVBAI008 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,7.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,15) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),7)
 ;;^DD(396,7.6,1,2,"%D",0)
 ;;=^^7^7^2950214^^^^
 ;;^DD(396,7.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,7.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,7.6,1,2,"%D",3,0)
 ;;=It is on the OTHER/EXAM LISTED TRAN DATE and Division.
 ;;^DD(396,7.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,7.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,7.6,1,2,"%D",6,0)
 ;;=either the OTHER/EXAM LISTED TRAN DATE or Division.  This will NOT 
 ;;^DD(396,7.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,7.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,7.6,3)
 ;;=Enter the Medical Center division to which the Exam of Cond's is transferred.
 ;;^DD(396,7.6,21,0)
 ;;=^^2^2^2950210^^^
 ;;^DD(396,7.6,21,1,0)
 ;;=This field contains the division the OTHER/EXAM  Listed in Remarks
 ;;^DD(396,7.6,21,2,0)
 ;;=was transferred to.
 ;;^DD(396,7.6,23,0)
 ;;=^^1^1^2941130^^
 ;;^DD(396,7.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,7.6,"DT")
 ;;=2950210
 ;;^DD(396,7.7,0)
 ;;=OTHER/EXAM LISTED TRAN DATE^D^^7;15^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,7.7,1,0)
 ;;=^.1
 ;;^DD(396,7.7,1,1,0)
 ;;=396^AE8^MUMPS
 ;;^DD(396,7.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,15) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,7)=""
 ;;^DD(396,7.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,15) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,7)
 ;;^DD(396,7.7,1,1,"%D",0)
 ;;=^^2^2^2950214^^^^
 ;;^DD(396,7.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,7.7,1,1,"%D",2,0)
 ;;=It is on the OTHER/EXAM LISTED TRAN DATE and Division.
 ;;^DD(396,7.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,7.7,1,2,0)
 ;;=396^AF8^MUMPS
 ;;^DD(396,7.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,15) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,7)=""
 ;;^DD(396,7.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,15) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,7)
 ;;^DD(396,7.7,1,2,"%D",0)
 ;;=^^3^3^2950214^^^^
 ;;^DD(396,7.7,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,7.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,7.7,1,2,"%D",3,0)
 ;;=It is on the OTHER/EXAM LISTED TRAN DATE and Division.
 ;;^DD(396,7.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,7.7,3)
 ;;=Enter the date the Exam of Conditions listed was transferred to another division.
 ;;^DD(396,7.7,21,0)
 ;;=^^2^2^2950210^^
 ;;^DD(396,7.7,21,1,0)
 ;;=This field contains the date the OTHER/EXAM Listed in Remarks was
 ;;^DD(396,7.7,21,2,0)
 ;;=transferred to another division in a multi-divisional facility.
 ;;^DD(396,7.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,7.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,7.7,"DT")
 ;;=2950210
 ;;^DD(396,8,0)
 ;;=STATUS OF OTHER/EXAM^S^P:PENDING;C:COMPLETED;^0;15^Q
 ;;^DD(396,8,1,0)
 ;;=^.1^^0
 ;;^DD(396,8,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,8,21,0)
 ;;=^^1^1^2950210^^^
 ;;^DD(396,8,21,1,0)
 ;;=Indicates the status of the OTHER/EXAM listed in the ADDITIONAL REMARKS field.
 ;;^DD(396,8,"DT")
 ;;=2950210
 ;;^DD(396,8.5,0)
 ;;=OTHER/EXAM COMPLETION DATE^D^^1;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,8.5,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,8.5,21,0)
 ;;=^^1^1^2950210^^
 ;;^DD(396,8.5,21,1,0)
 ;;=This is the date that this report was completed.
 ;;^DD(396,8.5,"DT")
 ;;=2950210
 ;;^DD(396,8.7,0)
 ;;=EDIT8^F^^1;16^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,8.7,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,8.7,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,8.7,21,1,0)
 ;;=Holds the name of the person who last edited the STATUS OF EXAM CONDITIONS.
 ;;^DD(396,9,0)
 ;;=SPECIAL REPORT^RS^YES:YES;NO:NO;^0;16^Q
 ;;^DD(396,9,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,9,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,9,21,1,0)
 ;;=Indicates whether a special report is requested.
 ;;^DD(396,9.6,0)
 ;;=SPECIAL REPORT DIVISION^P40.8'^DG(40.8,^6;17^Q
 ;;^DD(396,9.6,1,0)
 ;;=^.1
 ;;^DD(396,9.6,1,1,0)
 ;;=396^AE9^MUMPS
 ;;^DD(396,9.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,17) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,9)=""
 ;;^DD(396,9.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,17) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,9)

DVBAI009
DVBAI009 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,9.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,9.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,9.6,1,1,"%D",2,0)
 ;;=It is on the Special Report Tran Date and Division.
 ;;^DD(396,9.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,9.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex
 ;;^DD(396,9.6,1,1,"%D",5,0)
 ;;=either the Special Report Tran Date or Division.  This will NOT 
 ;;^DD(396,9.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,9.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,9.6,1,2,0)
 ;;=396^AF9^MUMPS
 ;;^DD(396,9.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,17) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),9)=""
 ;;^DD(396,9.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,17) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),9)
 ;;^DD(396,9.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,9.6,1,2,"%D",1,0)
 ;;=This cross reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,9.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,9.6,1,2,"%D",3,0)
 ;;=It is on the Special Report Tran Date and Division.
 ;;^DD(396,9.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,9.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,9.6,1,2,"%D",6,0)
 ;;=either the Special Report Tran Date or Division.  This will NOT 
 ;;^DD(396,9.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,9.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,9.6,3)
 ;;=Enter the Medical Center division which the Special Report is transferred to.
 ;;^DD(396,9.6,21,0)
 ;;=^^1^1^2941130^^
 ;;^DD(396,9.6,21,1,0)
 ;;=This field contains the division the Special Report was transferred to.
 ;;^DD(396,9.6,23,0)
 ;;=^^1^1^2941130^^
 ;;^DD(396,9.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,9.6,"DT")
 ;;=2941201
 ;;^DD(396,9.7,0)
 ;;=SPECIAL REPORT TRAN DATE^D^^7;17^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,9.7,1,0)
 ;;=^.1
 ;;^DD(396,9.7,1,1,0)
 ;;=396^AE10^MUMPS
 ;;^DD(396,9.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,17) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,9)=""
 ;;^DD(396,9.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,17) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,9)
 ;;^DD(396,9.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396,9.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,9.7,1,1,"%D",2,0)
 ;;=It is on the Special Report Tran Date and Division.
 ;;^DD(396,9.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,9.7,1,2,0)
 ;;=396^AF10^MUMPS
 ;;^DD(396,9.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,17) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,9)=""
 ;;^DD(396,9.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,17) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,9)
 ;;^DD(396,9.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396,9.7,1,2,"%D",1,0)
 ;;=This cross reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,9.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,9.7,1,2,"%D",3,0)
 ;;=It is on the Special Report Tran Date and Division.
 ;;^DD(396,9.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,9.7,3)
 ;;=Enter the date the Special Report was transferred to another division.
 ;;^DD(396,9.7,21,0)
 ;;=^^2^2^2941130^
 ;;^DD(396,9.7,21,1,0)
 ;;=This field contains the date the Special Report was transferred to another
 ;;^DD(396,9.7,21,2,0)
 ;;=division at a multi-divisional facility.
 ;;^DD(396,9.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,9.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,9.7,"DT")
 ;;=2941201
 ;;^DD(396,10,0)
 ;;=STATUS OF SPECIAL REPORT^S^P:PENDING;C:COMPLETED;^0;17^Q
 ;;^DD(396,10,1,0)
 ;;=^.1^^0
 ;;^DD(396,10,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,10,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,10,21,1,0)
 ;;=Indicates the status of the special report.
 ;;^DD(396,10,"DT")
 ;;=2891229
 ;;^DD(396,10.5,0)
 ;;=SPECIAL REPORT COMPLETION DATE^D^^1;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,10.5,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,10.5,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,10.5,21,1,0)
 ;;=Contains the date on which the special report was completed.
 ;;^DD(396,10.5,"DT")
 ;;=2900222
 ;;^DD(396,10.7,0)
 ;;=EDIT10^F^^1;17^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,10.7,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,10.7,21,0)
 ;;=^^1^1^2930430^^

DVBAI00A
DVBAI00A ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,10.7,21,1,0)
 ;;=Holds the name of the person who last edited the STATUS OF SPECIAL REPORT.
 ;;^DD(396,11,0)
 ;;=COMPETENCY REPORT^RS^YES:YES;NO:NO;^0;18^Q
 ;;^DD(396,11,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,11,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,11,21,1,0)
 ;;=Indicates whether or not a competency report has been selected.
 ;;^DD(396,11.6,0)
 ;;=COMPETENCY REPORT DIVISION^P40.8'^DG(40.8,^6;19^Q
 ;;^DD(396,11.6,1,0)
 ;;=^.1
 ;;^DD(396,11.6,1,1,0)
 ;;=396^AE11^MUMPS
 ;;^DD(396,11.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,19) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,11)=""
 ;;^DD(396,11.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,19) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,11)
 ;;^DD(396,11.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,11.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,11.6,1,1,"%D",2,0)
 ;;=It is on the Competency Report Tran Date and Division.
 ;;^DD(396,11.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,11.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex
 ;;^DD(396,11.6,1,1,"%D",5,0)
 ;;=either the Competency Report Tran Date or Division.  This will NOT 
 ;;^DD(396,11.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,11.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,11.6,1,2,0)
 ;;=396^AF11^MUMPS
 ;;^DD(396,11.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,19) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),11)=""
 ;;^DD(396,11.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,19) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),11)
 ;;^DD(396,11.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,11.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,11.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,11.6,1,2,"%D",3,0)
 ;;=It is on the Competency Report Tran Date and Division.
 ;;^DD(396,11.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,11.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,11.6,1,2,"%D",6,0)
 ;;=either the Competency Report Tran Date or Division.  This will NOT 
 ;;^DD(396,11.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,11.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,11.6,3)
 ;;=Enter the Medical Center division which the Competency Rpt is transferred to.
 ;;^DD(396,11.6,21,0)
 ;;=^^1^1^2941130^^
 ;;^DD(396,11.6,21,1,0)
 ;;=This field contains the division the Special Report was transferred to.
 ;;^DD(396,11.6,23,0)
 ;;=^^1^1^2941130^^
 ;;^DD(396,11.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,11.6,"DT")
 ;;=2941201
 ;;^DD(396,11.7,0)
 ;;=COMPETENCY REPORT TRAN DATE^D^^7;19^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,11.7,1,0)
 ;;=^.1
 ;;^DD(396,11.7,1,1,0)
 ;;=396^AE12^MUMPS
 ;;^DD(396,11.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,19) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,11)=""
 ;;^DD(396,11.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,19) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,11)
 ;;^DD(396,11.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396,11.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,11.7,1,1,"%D",2,0)
 ;;=It is on the Competency Report Tran Date and Division.
 ;;^DD(396,11.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,11.7,1,2,0)
 ;;=396^AF12^MUMPS
 ;;^DD(396,11.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,19) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,11)=""
 ;;^DD(396,11.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,19) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,11)
 ;;^DD(396,11.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396,11.7,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,11.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,11.7,1,2,"%D",3,0)
 ;;=It is on the Competency Report Tran Date and Division.
 ;;^DD(396,11.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,11.7,3)
 ;;=Enter the date the Competency Rpt was transferred to another division.
 ;;^DD(396,11.7,21,0)
 ;;=^^2^2^2950126^^
 ;;^DD(396,11.7,21,1,0)
 ;;=This field contains the date the Competency Report was transferred to
 ;;^DD(396,11.7,21,2,0)
 ;;=another division at a multidivisional facility.
 ;;^DD(396,11.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,11.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,11.7,"DT")
 ;;=2941201

DVBAI00B
DVBAI00B ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,12,0)
 ;;=STATUS OF COMPETENCY REPORT^S^P:PENDING;C:COMPLETED;^0;19^Q
 ;;^DD(396,12,1,0)
 ;;=^.1^^0
 ;;^DD(396,12,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,12,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,12,21,1,0)
 ;;=Indicates the current status of this report.
 ;;^DD(396,12,"DT")
 ;;=2891229
 ;;^DD(396,12.5,0)
 ;;=COMPETENCY RPT COMPLETION DATE^D^^1;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,12.5,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,12.5,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,12.5,21,1,0)
 ;;=This is the date the competency report was completed by MAS.
 ;;^DD(396,12.5,"DT")
 ;;=2900222
 ;;^DD(396,12.7,0)
 ;;=EDIT12^F^^1;18^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,12.7,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,12.7,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,12.7,21,1,0)
 ;;=Holds the name of the person who last edited the STATUS OF COMPETENCY REPORT.
 ;;^DD(396,13,0)
 ;;=VA FORM 21-2680^RS^YES:YES;NO:NO;^0;20^Q
 ;;^DD(396,13,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,13,21,0)
 ;;=^^1^1^2940304^^^^
 ;;^DD(396,13,21,1,0)
 ;;=Indicates whether a VA FORM 21-2680 is requested.
 ;;^DD(396,13.6,0)
 ;;=VA FORM 21-2680 DIVISION^P40.8'^DG(40.8,^6;21^Q
 ;;^DD(396,13.6,1,0)
 ;;=^.1
 ;;^DD(396,13.6,1,1,0)
 ;;=396^AE13^MUMPS
 ;;^DD(396,13.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,21) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,13)=""
 ;;^DD(396,13.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,21) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,13)
 ;;^DD(396,13.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,13.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,13.6,1,1,"%D",2,0)
 ;;=It is on the 21-2680 Tran Date and Division.
 ;;^DD(396,13.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,13.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex
 ;;^DD(396,13.6,1,1,"%D",5,0)
 ;;=either the 21-2680 Tran Date or Division.  This will NOT 
 ;;^DD(396,13.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,13.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,13.6,1,2,0)
 ;;=396^AF13^MUMPS
 ;;^DD(396,13.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,21) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),13)=""
 ;;^DD(396,13.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,21) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),13)
 ;;^DD(396,13.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,13.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,13.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,13.6,1,2,"%D",3,0)
 ;;=It is on the 21-2680 Tran Date and Division.
 ;;^DD(396,13.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,13.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,13.6,1,2,"%D",6,0)
 ;;=either the 21-2680 Tran Date or Division.  This will NOT 
 ;;^DD(396,13.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,13.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,13.6,3)
 ;;=Enter the Medical Center division which the 21-2680 is transferred to.
 ;;^DD(396,13.6,21,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,13.6,21,1,0)
 ;;=This field contains the division the VA Form 21-2680 was transferred to.
 ;;^DD(396,13.6,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,13.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,13.6,"DT")
 ;;=2941201
 ;;^DD(396,13.7,0)
 ;;=VA FORM 21-2680 TRAN DATE^D^^7;21^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,13.7,1,0)
 ;;=^.1
 ;;^DD(396,13.7,1,1,0)
 ;;=396^AE14^MUMPS
 ;;^DD(396,13.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,21) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,13)=""
 ;;^DD(396,13.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,21) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,13)
 ;;^DD(396,13.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396,13.7,1,1,"%D",1,0)
 ;;=This cross reference is used to print the New 7131 Report (Long).
 ;;^DD(396,13.7,1,1,"%D",2,0)
 ;;=It is on the 21-2680 Tran Date and Division.
 ;;^DD(396,13.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,13.7,1,2,0)
 ;;=396^AF14^MUMPS
 ;;^DD(396,13.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,21) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,13)=""
 ;;^DD(396,13.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,21) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,13)
 ;;^DD(396,13.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^

DVBAI00C
DVBAI00C ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,13.7,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,13.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,13.7,1,2,"%D",3,0)
 ;;=It is on the 21-2680 Tran Date and Division.
 ;;^DD(396,13.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,13.7,3)
 ;;=Enter the date the 21-2680 was transferred to another division.
 ;;^DD(396,13.7,21,0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396,13.7,21,1,0)
 ;;=This field contains the date the VA Form 21-2680 was transferred to another
 ;;^DD(396,13.7,21,2,0)
 ;;=division in a multidivisonal facility.
 ;;^DD(396,13.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,13.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,13.7,"DT")
 ;;=2941201
 ;;^DD(396,14,0)
 ;;=STATUS OF VA FORM 21-2680^S^P:PENDING;C:COMPLETED;^0;21^Q
 ;;^DD(396,14,1,0)
 ;;=^.1^^0
 ;;^DD(396,14,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,14,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,14,21,1,0)
 ;;=Indicates the current status of this report.
 ;;^DD(396,14,"DT")
 ;;=2891229
 ;;^DD(396,14.5,0)
 ;;=FORM 21-2680 COMPLETION DATE^D^^1;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,14.5,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,14.5,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,14.5,21,1,0)
 ;;=The date this report was completed by MAS.
 ;;^DD(396,14.5,"DT")
 ;;=2900222
 ;;^DD(396,14.7,0)
 ;;=EDIT14^F^^2;1^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,14.7,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,14.7,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,14.7,21,1,0)
 ;;=Holds the name of the person who last edited STATUS OF VA FORM 21-2680.
 ;;^DD(396,15,0)
 ;;=ASSET INFORMATION^RS^YES:YES;NO:NO;^0;22^Q
 ;;^DD(396,15,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,15,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,15,21,1,0)
 ;;=Indicates whether asset information is requested.
 ;;^DD(396,15.6,0)
 ;;=ASSET INFORMATION DIVISION^P40.8'^DG(40.8,^6;23^Q
 ;;^DD(396,15.6,1,0)
 ;;=^.1
 ;;^DD(396,15.6,1,1,0)
 ;;=396^AE15^MUMPS
 ;;^DD(396,15.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,23) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,15)=""
 ;;^DD(396,15.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,23) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,15)
 ;;^DD(396,15.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,15.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,15.6,1,1,"%D",2,0)
 ;;=It is on the Asset Information Tran Date and Division.
 ;;^DD(396,15.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,15.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex
 ;;^DD(396,15.6,1,1,"%D",5,0)
 ;;=either the Asset Information Tran Date or Division.  This will NOT 
 ;;^DD(396,15.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,15.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,15.6,1,2,0)
 ;;=396^AF15^MUMPS
 ;;^DD(396,15.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,23) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),15)=""
 ;;^DD(396,15.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,23) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),15)
 ;;^DD(396,15.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,15.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,15.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,15.6,1,2,"%D",3,0)
 ;;=It is on the Asset Information Tran Date and Division.
 ;;^DD(396,15.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,15.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,15.6,1,2,"%D",6,0)
 ;;=either the Asset Information Tran Date or Division.  This will NOT 
 ;;^DD(396,15.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,15.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,15.6,3)
 ;;=Enter the Medical Center division which the Asset Info is transferred to.
 ;;^DD(396,15.6,21,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,15.6,21,1,0)
 ;;=This field contains the division the Asset Information was transferred to.
 ;;^DD(396,15.6,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,15.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,15.6,"DT")
 ;;=2941201
 ;;^DD(396,15.7,0)
 ;;=ASSET INFORMATION TRAN DATE^D^^7;23^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,15.7,1,0)
 ;;=^.1
 ;;^DD(396,15.7,1,1,0)
 ;;=396^AE16^MUMPS
 ;;^DD(396,15.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,23) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,15)=""

DVBAI00D
DVBAI00D ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,15.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,23) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,15)
 ;;^DD(396,15.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396,15.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,15.7,1,1,"%D",2,0)
 ;;=It is on the Asset Information Tran Date and Division.
 ;;^DD(396,15.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,15.7,1,2,0)
 ;;=396^AF16^MUMPS
 ;;^DD(396,15.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,23) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,15)=""
 ;;^DD(396,15.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,23) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,15)
 ;;^DD(396,15.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396,15.7,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,15.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,15.7,1,2,"%D",3,0)
 ;;=It is on the Asset Information Tran Date and Division.
 ;;^DD(396,15.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,15.7,3)
 ;;=Enter the date the Asset Information was transferred to another division.
 ;;^DD(396,15.7,21,0)
 ;;=^^2^2^2950126^^
 ;;^DD(396,15.7,21,1,0)
 ;;=This field contains the date the Asset Information was transferred to
 ;;^DD(396,15.7,21,2,0)
 ;;=another division in a multidivisional facility.
 ;;^DD(396,15.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,15.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,15.7,"DT")
 ;;=2941201
 ;;^DD(396,16,0)
 ;;=STATUS OF ASSET INFORMATION^S^P:PENDING;C:COMPLETED;^0;23^Q
 ;;^DD(396,16,1,0)
 ;;=^.1^^0
 ;;^DD(396,16,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,16,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,16,21,1,0)
 ;;=Status of the requested asset information report.
 ;;^DD(396,16,"DT")
 ;;=2891229
 ;;^DD(396,16.5,0)
 ;;=ASSET INFO COMPLETION DATE^D^^1;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,16.5,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,16.5,21,0)
 ;;=^^1^1^2930430^^^^
 ;;^DD(396,16.5,21,1,0)
 ;;=This is the date the asset information was completed by MAS.
 ;;^DD(396,16.5,"DT")
 ;;=2900222
 ;;^DD(396,16.7,0)
 ;;=EDIT16^F^^2;2^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,16.7,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,16.7,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,16.7,21,1,0)
 ;;=Holds the name of the person who last edited STATUS OF ASSET INFORMATION.
 ;;^DD(396,17,0)
 ;;=ADMISSION REPORT^RS^YES:YES;NO:NO;^0;24^Q
 ;;^DD(396,17,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,17,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,17,21,1,0)
 ;;=Indicates whether an admission report was requested.
 ;;^DD(396,17.4,0)
 ;;=ADMISSION REPORT STATUS^S^P:PENDING;C:COMPLETED;^1;7^Q
 ;;^DD(396,17.4,1,0)
 ;;=^.1^^0
 ;;^DD(396,17.4,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,17.4,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,17.4,21,1,0)
 ;;=This is the current status of the admission report.
 ;;^DD(396,17.4,"DT")
 ;;=2891229
 ;;^DD(396,17.6,0)
 ;;=ADMISSION REPORT DIVISION^P40.8'^DG(40.8,^6;7^Q
 ;;^DD(396,17.6,1,0)
 ;;=^.1
 ;;^DD(396,17.6,1,1,0)
 ;;=396^AE17^MUMPS
 ;;^DD(396,17.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,7) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,17)=""
 ;;^DD(396,17.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,7) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,17)
 ;;^DD(396,17.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,17.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,17.6,1,1,"%D",2,0)
 ;;=It is on the Admission Report Tran Date and Division.
 ;;^DD(396,17.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,17.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex
 ;;^DD(396,17.6,1,1,"%D",5,0)
 ;;=either the Admission Report Tran Date or Division.  This will NOT 
 ;;^DD(396,17.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,17.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,17.6,1,2,0)
 ;;=396^AF17^MUMPS
 ;;^DD(396,17.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,7) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),17)=""
 ;;^DD(396,17.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,7) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),17)
 ;;^DD(396,17.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,17.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,17.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).

DVBAI00E
DVBAI00E ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,17.6,1,2,"%D",3,0)
 ;;=It is on the Admission Report Tran Date and Division.
 ;;^DD(396,17.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,17.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,17.6,1,2,"%D",6,0)
 ;;=either the Admission Report Tran Date or Division.  This will NOT 
 ;;^DD(396,17.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,17.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,17.6,3)
 ;;=Enter the Medical Center division which the Admission Rpt is transferred to.
 ;;^DD(396,17.6,21,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,17.6,21,1,0)
 ;;=This field contains the division the Asset Information was transferred to.
 ;;^DD(396,17.6,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,17.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,17.6,"DT")
 ;;=2941201
 ;;^DD(396,17.7,0)
 ;;=ADMISSION REPORT TRAN DATE^D^^7;7^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,17.7,1,0)
 ;;=^.1
 ;;^DD(396,17.7,1,1,0)
 ;;=396^AE18^MUMPS
 ;;^DD(396,17.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,7) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,17)=""
 ;;^DD(396,17.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,7) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,17)
 ;;^DD(396,17.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396,17.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,17.7,1,1,"%D",2,0)
 ;;=It is on the Admission Report Tran Date and Division.
 ;;^DD(396,17.7,1,1,"DT")
 ;;=2941201
 ;;^DD(396,17.7,1,2,0)
 ;;=396^AF18^MUMPS
 ;;^DD(396,17.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,7) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,17)=""
 ;;^DD(396,17.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,7) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,17)
 ;;^DD(396,17.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^
 ;;^DD(396,17.7,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,17.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,17.7,1,2,"%D",3,0)
 ;;=It is on the Admission Report Tran Date and Division.
 ;;^DD(396,17.7,1,2,"DT")
 ;;=2941201
 ;;^DD(396,17.7,3)
 ;;=Enter the date the Admission Report was transferred to another division.
 ;;^DD(396,17.7,21,0)
 ;;=^^2^2^2950126^^
 ;;^DD(396,17.7,21,1,0)
 ;;=This field contains the date the Admission Report was transferred to
 ;;^DD(396,17.7,21,2,0)
 ;;=another division at a multidivisional facility.
 ;;^DD(396,17.7,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,17.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,17.7,"DT")
 ;;=2941201
 ;;^DD(396,17.8,0)
 ;;=ADMISSION RPT COMPLETION DATE^D^^1;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,17.8,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,17.8,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,17.8,21,1,0)
 ;;=This is the date the admission report was completed.
 ;;^DD(396,17.8,"DT")
 ;;=2900222
 ;;^DD(396,17.9,0)
 ;;=EDIT17.4^F^^2;3^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,17.9,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,17.9,21,0)
 ;;=^^2^2^2930503^^^
 ;;^DD(396,17.9,21,1,0)
 ;;=Holds the name of the person who last edited the ADMISSION REPORT STATUS
 ;;^DD(396,17.9,21,2,0)
 ;;=field.
 ;;^DD(396,18,0)
 ;;=OPT TREATMENT RPT (DATE RANGE)^F^^0;25^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,18,3)
 ;;=If you want to receive the Outpatient Treatment report for a specific veteran, enter the date range that you want that report to cover.  (A Yes or No answer is not correct here.)
 ;;^DD(396,18,4)
 ;;=
 ;;^DD(396,18,21,0)
 ;;=^^2^2^2940309^^^^
 ;;^DD(396,18,21,1,0)
 ;;=This will contain the date range that the user has selected for the OPT
 ;;^DD(396,18,21,2,0)
 ;;=report. (This field is free text and intended to hold a From/To date range.)
 ;;^DD(396,18,"DT")
 ;;=2900705
 ;;^DD(396,18.6,0)
 ;;=OPT TREATMENT RPT DIVISION^P40.8'^DG(40.8,^6;26^Q
 ;;^DD(396,18.6,1,0)
 ;;=^.1
 ;;^DD(396,18.6,1,1,0)
 ;;=396^AE19^MUMPS
 ;;^DD(396,18.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,26) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,18)=""
 ;;^DD(396,18.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,26) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,18)
 ;;^DD(396,18.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,18.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).  It is
 ;;^DD(396,18.6,1,1,"%D",2,0)
 ;;=on the OPT Treatment Rpt Tran Date and Division.
 ;;^DD(396,18.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,18.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex

DVBAI00F
DVBAI00F ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,18.6,1,1,"%D",5,0)
 ;;=either the OPT Treatment Rpt Tran Date or Division.  This will NOT 
 ;;^DD(396,18.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,18.6,1,1,"DT")
 ;;=2941207
 ;;^DD(396,18.6,1,2,0)
 ;;=396^AF19^MUMPS
 ;;^DD(396,18.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,26) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),18)=""
 ;;^DD(396,18.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,26) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),18)
 ;;^DD(396,18.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,18.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,18.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).  It is on the OPT Treatment Rpt Tran Date and
 ;;^DD(396,18.6,1,2,"%D",3,0)
 ;;=Division.
 ;;^DD(396,18.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,18.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,18.6,1,2,"%D",6,0)
 ;;=either the Admission Report Tran Date or Division.  This will NOT 
 ;;^DD(396,18.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,18.6,1,2,"DT")
 ;;=2941207
 ;;^DD(396,18.6,3)
 ;;=Enter the division the OPT Treatment Rpt is to be completed by.
 ;;^DD(396,18.6,21,0)
 ;;=^^2^2^2941207^
 ;;^DD(396,18.6,21,1,0)
 ;;=This field contains the division the OPT Treatment Rpt was transferred to
 ;;^DD(396,18.6,21,2,0)
 ;;=on the 7131.
 ;;^DD(396,18.6,23,0)
 ;;=^^1^1^2941207^
 ;;^DD(396,18.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,18.6,"DT")
 ;;=2941207
 ;;^DD(396,18.7,0)
 ;;=OPT TREATMENT RPT TRAN DATE^D^^7;26^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,18.7,1,0)
 ;;=^.1
 ;;^DD(396,18.7,1,1,0)
 ;;=396^AE20^MUMPS
 ;;^DD(396,18.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,26) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,18)=""
 ;;^DD(396,18.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,26) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,18)
 ;;^DD(396,18.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396,18.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).  It is
 ;;^DD(396,18.7,1,1,"%D",2,0)
 ;;=on the OPT Treatment Rpt Tran Date and Division.
 ;;^DD(396,18.7,1,1,"DT")
 ;;=2941207
 ;;^DD(396,18.7,1,2,0)
 ;;=396^AF20^MUMPS
 ;;^DD(396,18.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,26) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,18)=""
 ;;^DD(396,18.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,26) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,18)
 ;;^DD(396,18.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^^
 ;;^DD(396,18.7,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,18.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).  It is on the OPT Treatment Rpt Tran Date
 ;;^DD(396,18.7,1,2,"%D",3,0)
 ;;=and Division.
 ;;^DD(396,18.7,1,2,"DT")
 ;;=2941207
 ;;^DD(396,18.7,3)
 ;;=Enter the date the OPT Treatment Rpt was transferred to another division.
 ;;^DD(396,18.7,21,0)
 ;;=^^2^2^2941207^
 ;;^DD(396,18.7,21,1,0)
 ;;=This field contains the date the OPT Treatment Rpt was transferred to
 ;;^DD(396,18.7,21,2,0)
 ;;=another division.
 ;;^DD(396,18.7,23,0)
 ;;=^^1^1^2941207^
 ;;^DD(396,18.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,18.7,"DT")
 ;;=2941207
 ;;^DD(396,19,0)
 ;;=STATUS OF OPT TREATMENT RPT^S^P:PENDING;C:COMPLETED;^0;26^Q
 ;;^DD(396,19,1,0)
 ;;=^.1^^0
 ;;^DD(396,19,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.
 ;;^DD(396,19,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,19,21,1,0)
 ;;=Contains the current status of the OPT report.
 ;;^DD(396,19,"DT")
 ;;=2891229
 ;;^DD(396,19.5,0)
 ;;=OPT TREAT RPT COMPLETION DATE^D^^1;9^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,19.5,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,19.5,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,19.5,21,1,0)
 ;;=This is the date the OPT report was completed by MAS.
 ;;^DD(396,19.5,"DT")
 ;;=2900222
 ;;^DD(396,19.7,0)
 ;;=EDIT19^F^^2;4^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,19.7,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,19.7,21,0)
 ;;=^^2^2^2930430^^^
 ;;^DD(396,19.7,21,1,0)
 ;;=Holds the name of the person who last edited the STATUS OF OPT TREATMENT
 ;;^DD(396,19.7,21,2,0)
 ;;=RPT field.
 ;;^DD(396,20,0)
 ;;=BEGINNING DATE/CARE (CHAP 17)^RS^YES:YES;NO:NO;^0;27^Q
 ;;^DD(396,20,3)
 ;;=Enter Y if you wish to receive this item, N if not.
 ;;^DD(396,20,21,0)
 ;;=^^1^1^2930430^

DVBAI00G
DVBAI00G ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,20,21,1,0)
 ;;=This field indicates whether the beginning date/care report is selected.
 ;;^DD(396,20.6,0)
 ;;=BEGINNING DATE/CARE DIVISION^P40.8'^DG(40.8,^6;28^Q
 ;;^DD(396,20.6,1,0)
 ;;=^.1
 ;;^DD(396,20.6,1,1,0)
 ;;=396^AE21^MUMPS
 ;;^DD(396,20.6,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,28) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,20)=""
 ;;^DD(396,20.6,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,28) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,20)
 ;;^DD(396,20.6,1,1,"%D",0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396,20.6,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).
 ;;^DD(396,20.6,1,1,"%D",2,0)
 ;;=It is on the Beginning Date/Care Tran Date and Division.
 ;;^DD(396,20.6,1,1,"%D",3,0)
 ;;= 
 ;;^DD(396,20.6,1,1,"%D",4,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex
 ;;^DD(396,20.6,1,1,"%D",5,0)
 ;;=either the Beginning Date/Care Tran Date or Division.  This will NOT 
 ;;^DD(396,20.6,1,1,"%D",6,0)
 ;;=reindex the 'AE' X-ref on other fields in the file.
 ;;^DD(396,20.6,1,1,"DT")
 ;;=2941201
 ;;^DD(396,20.6,1,2,0)
 ;;=396^AF21^MUMPS
 ;;^DD(396,20.6,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,28) S:A'="" ^DVB(396,"AF",DA,A,$E(X,1,30),20)=""
 ;;^DD(396,20.6,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,7)) A=$P(^DVB(396,DA,7),U,28) I A'="" K ^DVB(396,"AF",DA,A,$E(X,1,30),20)
 ;;^DD(396,20.6,1,2,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,20.6,1,2,"%D",1,0)
 ;;=This cross-reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,20.6,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).
 ;;^DD(396,20.6,1,2,"%D",3,0)
 ;;=It is on the Beginning Date/Care Tran Date and Division.
 ;;^DD(396,20.6,1,2,"%D",4,0)
 ;;= 
 ;;^DD(396,20.6,1,2,"%D",5,0)
 ;;=To reindex the 'AF' X-ref for these fields, the user need only reindex
 ;;^DD(396,20.6,1,2,"%D",6,0)
 ;;=either the Beginning Date/Care Tran Date or Division.  This will NOT 
 ;;^DD(396,20.6,1,2,"%D",7,0)
 ;;=reindex the 'AF' X-ref on other fields in the file.
 ;;^DD(396,20.6,1,2,"DT")
 ;;=2941201
 ;;^DD(396,20.6,3)
 ;;=Enter the Medical Center division which the Begining Dte/Care is transferred to.
 ;;^DD(396,20.6,21,0)
 ;;=^^2^2^2941130^
 ;;^DD(396,20.6,21,1,0)
 ;;=This field contains the division the Begining Date/Care (Chapt 17) was
 ;;^DD(396,20.6,21,2,0)
 ;;=transferred to.
 ;;^DD(396,20.6,23,0)
 ;;=^^1^1^2941130^
 ;;^DD(396,20.6,23,1,0)
 ;;=This field is a pointer to the Medical Center Division file (40.8).
 ;;^DD(396,20.6,"DT")
 ;;=2941201
 ;;^DD(396,20.7,0)
 ;;=BEGINNING DATE/CARE TRAN DATE^D^^7;28^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,20.7,1,0)
 ;;=^.1
 ;;^DD(396,20.7,1,1,0)
 ;;=396^AE22^MUMPS
 ;;^DD(396,20.7,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,28) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,20)=""
 ;;^DD(396,20.7,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,28) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,20)
 ;;^DD(396,20.7,1,1,"%D",0)
 ;;=^^2^2^2950126^^
 ;;^DD(396,20.7,1,1,"%D",1,0)
 ;;=This cross-reference is used to print the New 7131 Report (Long).  It is
 ;;^DD(396,20.7,1,1,"%D",2,0)
 ;;=on the Beginning Date/Care Tran Date and Division.
 ;;^DD(396,20.7,1,1,"DT")
 ;;=2941202
 ;;^DD(396,20.7,1,2,0)
 ;;=396^AF22^MUMPS
 ;;^DD(396,20.7,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,28) S:+A>0 ^DVB(396,"AF",DA,$E(X,1,30),A,20)=""
 ;;^DD(396,20.7,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,6)) A=$P(^DVB(396,DA,6),U,28) I +A>0 K ^DVB(396,"AF",DA,$E(X,1,30),A,20)
 ;;^DD(396,20.7,1,2,"%D",0)
 ;;=^^3^3^2950126^^
 ;;^DD(396,20.7,1,2,"%D",1,0)
 ;;=This cross reference is used to print the Pending 7131 Report and the New
 ;;^DD(396,20.7,1,2,"%D",2,0)
 ;;=7131 Request Report (Short).  It is on the Beginning Date/Care Tran Date
 ;;^DD(396,20.7,1,2,"%D",3,0)
 ;;=and Division.
 ;;^DD(396,20.7,1,2,"DT")
 ;;=2941202
 ;;^DD(396,20.7,3)
 ;;=Enter the date the Beginning Date/Care was transferred to another division.
 ;;^DD(396,20.7,21,0)
 ;;=^^2^2^2950126^^
 ;;^DD(396,20.7,21,1,0)
 ;;=This field contains the date the Beginning Date/Care was transferred to
 ;;^DD(396,20.7,21,2,0)
 ;;=another division at a multidivisional facility.
 ;;^DD(396,20.7,23,0)
 ;;=^^1^1^2941202^
 ;;^DD(396,20.7,23,1,0)
 ;;=This field is a PRECISE date in which Time can be entered.
 ;;^DD(396,20.7,"DT")
 ;;=2941202
 ;;^DD(396,21,0)
 ;;=STATUS-BEG DATE/CARE (CHAP 17)^S^P:PENDING;C:COMPLETED;^0;28^Q
 ;;^DD(396,21,1,0)
 ;;=^.1^^0
 ;;^DD(396,21,3)
 ;;=Enter C if this item is completed or RETURN to leave this item as pending.

DVBAI00H
DVBAI00H ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,21,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,21,21,1,0)
 ;;=Indicates the current status of the beginning date/care report.
 ;;^DD(396,21,"DT")
 ;;=2891229
 ;;^DD(396,21.5,0)
 ;;=BEG/DATE/CARE COMPLETION DATE^D^^1;10^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,21.5,3)
 ;;=Enter the date this item was completed by MAS.
 ;;^DD(396,21.5,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,21.5,21,1,0)
 ;;=This field holds the date the beginning date/care report was completed.
 ;;^DD(396,21.5,"DT")
 ;;=2900222
 ;;^DD(396,21.7,0)
 ;;=EDIT21^F^^2;5^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,21.7,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,21.7,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,21.7,21,1,0)
 ;;=Holds the name of the person who last edited the STATUS-BEG DATE/CARE field.
 ;;^DD(396,22,0)
 ;;=*ADDITIONAL REMARKS^F^^0;29^K:$L(X)>65!($L(X)<1) X
 ;;^DD(396,22,3)
 ;;=ANSWER MUST BE 1-65 CHARACTERS IN LENGTH (STARRED FOR DELETION)
 ;;^DD(396,22,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,22,21,1,0)
 ;;=This field is starred for deletion and is being replaced by a WP field.
 ;;^DD(396,22,"DT")
 ;;=2930122
 ;;^DD(396,23,0)
 ;;=DATE OF REQUEST^D^^1;1^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,23,1,0)
 ;;=^.1
 ;;^DD(396,23,1,1,0)
 ;;=396^E
 ;;^DD(396,23,1,1,1)
 ;;=S ^DVB(396,"E",$E(X,1,30),DA)=""
 ;;^DD(396,23,1,1,2)
 ;;=K ^DVB(396,"E",$E(X,1,30),DA)
 ;;^DD(396,23,1,2,0)
 ;;=396^AE23^MUMPS
 ;;^DD(396,23,1,2,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,2)) A=$P(^DVB(396,DA,2),U,9) S:+A>0 ^DVB(396,"AE",$E(X,1,30),A,DA,23)=""
 ;;^DD(396,23,1,2,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,2)) A=$P(^DVB(396,DA,2),U,9) I +A>0 K ^DVB(396,"AE",$E(X,1,30),A,DA,23)
 ;;^DD(396,23,1,2,"%D",0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396,23,1,2,"%D",1,0)
 ;;=This cross-reference will be used by the New 7131 Request Report (Long).
 ;;^DD(396,23,1,2,"%D",2,0)
 ;;=It is needed to print a 7131 at the Division the request has been sent to
 ;;^DD(396,23,1,2,"%D",3,0)
 ;;=by the Regional Office.
 ;;^DD(396,23,1,2,"DT")
 ;;=2941202
 ;;^DD(396,23,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,23,21,1,0)
 ;;=This field contains the date the 7131 request was entered.
 ;;^DD(396,23,"DT")
 ;;=2941202
 ;;^DD(396,24,0)
 ;;=DATE LAST STATUS EDIT^D^^1;11^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,24,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,24,21,1,0)
 ;;=This field contains the date the status of any of the reports was changed.
 ;;^DD(396,25,0)
 ;;=FINALIZATION DATE^D^^1;12^S %DT="E" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396,25,1,0)
 ;;=^.1
 ;;^DD(396,25,1,1,0)
 ;;=396^F
 ;;^DD(396,25,1,1,1)
 ;;=S ^DVB(396,"F",$E(X,1,30),DA)=""
 ;;^DD(396,25,1,1,2)
 ;;=K ^DVB(396,"F",$E(X,1,30),DA)
 ;;^DD(396,25,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,25,21,1,0)
 ;;=This field contains the date that the 7131 was finalized.
 ;;^DD(396,26,0)
 ;;=FINALIZED BY^F^^2;6^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396,26,3)
 ;;=ANSWER MUST BE 1-25 CHARACTERS IN LENGTH
 ;;^DD(396,26,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396,26,21,1,0)
 ;;=This field contains the name of the user who finalized the 7131 request.
 ;;^DD(396,27,0)
 ;;=REQUESTING LOCATION^RF^^2;7^K:$L(X)>30!($L(X)<1) X
 ;;^DD(396,27,3)
 ;;=Answer must be 1-30 characters in length.
 ;;^DD(396,27,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396,27,21,1,0)
 ;;=The name of the Regional Office that requested this 7131.
 ;;^DD(396,27,"DT")
 ;;=2930408
 ;;^DD(396,28,0)
 ;;=REQUESTED BY^RF^^2;8^K:$L(X)>30!($L(X)<3) X
 ;;^DD(396,28,3)
 ;;=ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
 ;;^DD(396,28,21,0)
 ;;=^^1^1^2930503^^^
 ;;^DD(396,28,21,1,0)
 ;;=The Regional Office employee who requested the 7131.
 ;;^DD(396,29,0)
 ;;=DIVISION^RP40.8'^DG(40.8,^2;9^Q
 ;;^DD(396,29,1,0)
 ;;=^.1
 ;;^DD(396,29,1,1,0)
 ;;=396^AE24^MUMPS
 ;;^DD(396,29,1,1,1)
 ;;=N A S A="" S:$D(^DVB(396,DA,1)) A=$P(^DVB(396,DA,1),U,1) S:A'="" ^DVB(396,"AE",A,$E(X,1,30),DA,23)=""
 ;;^DD(396,29,1,1,2)
 ;;=N A S A="" S:$D(^DVB(396,DA,1)) A=$P(^DVB(396,DA,1),U,1) I A'="" K ^DVB(396,"AE",A,$E(X,1,30),DA,23)
 ;;^DD(396,29,1,1,"%D",0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396,29,1,1,"%D",1,0)
 ;;=This cross reference will be used by the New 7131 Request Report (Long).
 ;;^DD(396,29,1,1,"%D",2,0)
 ;;=It is needed to print a 7131 at the Division the request has been sent to
 ;;^DD(396,29,1,1,"%D",3,0)
 ;;=by the Regional Office.
 ;;^DD(396,29,1,1,"%D",4,0)
 ;;= 
 ;;^DD(396,29,1,1,"%D",5,0)
 ;;=To reindex the 'AE' X-ref for these fields, the user need only reindex  
 ;;^DD(396,29,1,1,"%D",6,0)
 ;;=either the Date of Request or Division.  This will NOT reindex the 'AE' 
 ;;^DD(396,29,1,1,"%D",7,0)
 ;;=X-ref on other fields in the file. 
 ;;^DD(396,29,1,1,"DT")
 ;;=2941202
 ;;^DD(396,29,3)
 ;;=Enter the routing location for this request (required).

DVBAI00I
DVBAI00I ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396,29,4)
 ;;=
 ;;^DD(396,29,21,0)
 ;;=^^1^1^2930503^^
 ;;^DD(396,29,21,1,0)
 ;;=This field containts the division to which the 7131 request should be sent.
 ;;^DD(396,29,"DT")
 ;;=2941202
 ;;^DD(396,30,0)
 ;;=DOCUMENT TYPE^RS^L:ACTIVITY DATE;A:ADMISSION DATE;^2;10^Q
 ;;^DD(396,30,3)
 ;;=Enter the type of document being entered A for admission date or L for activity date.
 ;;^DD(396,30,21,0)
 ;;=^^2^2^2930503^^
 ;;^DD(396,30,21,1,0)
 ;;=Stores the document type of the 7131 request; either admission date or
 ;;^DD(396,30,21,2,0)
 ;;=activity date.
 ;;^DD(396,30,"DT")
 ;;=2890823
 ;;^DD(396.01,0)
 ;;=21 DAY CERT TEXT SUB-FIELD^^.01^1
 ;;^DD(396.01,0,"NM","21 DAY CERT TEXT")
 ;;=
 ;;^DD(396.01,0,"UP")
 ;;=396
 ;;^DD(396.01,.01,0)
 ;;=21 DAY CERT TEXT^W^^0;1^Q
 ;;^DD(396.01,.01,3)
 ;;=Enter the text of the 21-day certificate.
 ;;^DD(396.02,0)
 ;;=ADDITIONAL REMARKS SUB-FIELD^^.01^1
 ;;^DD(396.02,0,"DT")
 ;;=2930122
 ;;^DD(396.02,0,"NM","ADDITIONAL REMARKS")
 ;;=
 ;;^DD(396.02,0,"UP")
 ;;=396
 ;;^DD(396.02,.01,0)
 ;;=ADDITIONAL REMARKS^W^^0;1^Q
 ;;^DD(396.02,.01,3)
 ;;=Enter any ADDITIONAL REMARKS pertaining to this 7131 request.
 ;;^DD(396.02,.01,"DT")
 ;;=2930122

DVBAI00J
DVBAI00J ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.1,0,"GL")
 ;;=^DVB(396.1,
 ;;^DIC("B","AMIE SITE PARAMETER",396.1)
 ;;=
 ;;^DIC(396.1,"%",0)
 ;;=^1.005^1^1
 ;;^DIC(396.1,"%",1,0)
 ;;=DVBA
 ;;^DIC(396.1,"%","B","DVBA",1)
 ;;=
 ;;^DIC(396.1,"%D",0)
 ;;=^^1^1^2941216^^^^
 ;;^DIC(396.1,"%D",1,0)
 ;;=Holds the package specific parameters for the AMIE site.
 ;;^DD(396.1,0)
 ;;=FIELD^^18^19
 ;;^DD(396.1,0,"DDA")
 ;;=N
 ;;^DD(396.1,0,"DT")
 ;;=2941018
 ;;^DD(396.1,0,"IX","B",396.1,.01)
 ;;=
 ;;^DD(396.1,0,"NM","AMIE SITE PARAMETER")
 ;;=
 ;;^DD(396.1,.01,0)
 ;;=SITE NAME^RFX^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X S:$D(X) DINUM=1
 ;;^DD(396.1,.01,1,0)
 ;;=^.1
 ;;^DD(396.1,.01,1,1,0)
 ;;=396.1^B
 ;;^DD(396.1,.01,1,1,1)
 ;;=S ^DVB(396.1,"B",$E(X,1,30),DA)=""
 ;;^DD(396.1,.01,1,1,2)
 ;;=K ^DVB(396.1,"B",$E(X,1,30),DA)
 ;;^DD(396.1,.01,3)
 ;;=Enter the name of your facility as you wish it to appear on the AMIE reports.
 ;;^DD(396.1,.01,21,0)
 ;;=^^2^2^2930430^^
 ;;^DD(396.1,.01,21,1,0)
 ;;=This field contains the name of the facility running the
 ;;^DD(396.1,.01,21,2,0)
 ;;=AMIE software.
 ;;^DD(396.1,.01,"DT")
 ;;=2890823
 ;;^DD(396.1,.11,0)
 ;;=DAYS TO KEEP 2507 HISTORY^NJ3,0^^0;11^K:+X'=X!(X>999)!(X<120)!(X?.E1"."1N.N) X
 ;;^DD(396.1,.11,3)
 ;;=
 ;;^DD(396.1,.11,4)
 ;;=D PURGE^DVBAUTLH
 ;;^DD(396.1,.11,21,0)
 ;;=^^1^1^2940901^
 ;;^DD(396.1,.11,21,1,0)
 ;;=This is the number of days a 2507 request will be kept before it is purged.
 ;;^DD(396.1,.11,"DT")
 ;;=2940901
 ;;^DD(396.1,2,0)
 ;;=ALL ADMISSIONS REPORT DATE^D^^0;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.1,2,3)
 ;;=Computer maintained date.  Alter only for corrections.
 ;;^DD(396.1,2,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.1,2,21,1,0)
 ;;=This field contains the date the admission reports are run.
 ;;^DD(396.1,3,0)
 ;;=DISCHARGE REPORT DATE^D^^0;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.1,3,3)
 ;;=Computer maintained date.  Alter only for corrections.
 ;;^DD(396.1,3,21,0)
 ;;=^^1^1^2940304^^
 ;;^DD(396.1,3,21,1,0)
 ;;=This field contains the date the discharge report is run.
 ;;^DD(396.1,4,0)
 ;;=INCOMPETENT REPORT DATE^D^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.1,4,3)
 ;;=Computer maintained date.  Alter only for corrections.
 ;;^DD(396.1,4,21,0)
 ;;=^^1^1^2940304^^
 ;;^DD(396.1,4,21,1,0)
 ;;=This field contains the date the incompetent report is run.
 ;;^DD(396.1,6,0)
 ;;=READMISSION REPORT DATE^D^^0;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.1,6,3)
 ;;=Computer maintained date.  Alter only for corrections.
 ;;^DD(396.1,6,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.1,6,21,1,0)
 ;;=This field contains the date the readmission report is run.
 ;;^DD(396.1,7,0)
 ;;=SERVICE-CONNECTED REPORT DATE^D^^0;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.1,7,3)
 ;;=Computer maintained date.  Alter only for corrections.
 ;;^DD(396.1,7,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.1,7,21,1,0)
 ;;=This field contains the date the service-connected report is run.
 ;;^DD(396.1,8,0)
 ;;=PENSION/A&A REPORT DATE^D^^0;9^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.1,8,3)
 ;;=Computer maintained date.  Alter only for corrections.
 ;;^DD(396.1,8,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.1,8,21,1,0)
 ;;=This field contains the date the pension/A&A report is run.
 ;;^DD(396.1,9,0)
 ;;=NUMBER OF DAYS TO KEEP HISTORY^NJ3,0^^0;10^K:+X'=X!(X>999)!(X<30)!(X?.E1"."1N.N) X
 ;;^DD(396.1,9,3)
 ;;=Type a Number between 30 and 999, 0 Decimal Digits
 ;;^DD(396.1,9,21,0)
 ;;=^^2^2^2941006^^^^
 ;;^DD(396.1,9,21,1,0)
 ;;=This field determines how many days of 7131 information are kept
 ;;^DD(396.1,9,21,2,0)
 ;;=as history by the 7131 purge routine.
 ;;^DD(396.1,10,0)
 ;;=REGIONAL OFFICES ALLOWED^396.12P^^1;0
 ;;^DD(396.1,10,21,0)
 ;;=^^2^2^2930430^^
 ;;^DD(396.1,10,21,1,0)
 ;;=This field contains the regional offices that will be using AMIE
 ;;^DD(396.1,10,21,2,0)
 ;;=at the site.
 ;;^DD(396.1,11,0)
 ;;=REMOTE SITE (7131)^396.13P^^2;0
 ;;^DD(396.1,11,21,0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396.1,11,21,1,0)
 ;;=This field contains the names of the divisions that will be using
 ;;^DD(396.1,11,21,2,0)
 ;;=the 7131 portion of AMIE.
 ;;^DD(396.1,12,0)
 ;;=REMOTE SITE (2507)^396.14P^^3;0
 ;;^DD(396.1,12,21,0)
 ;;=^^2^2^2940304^^^^
 ;;^DD(396.1,12,21,1,0)
 ;;=This field contains the names of the divisions that will be using
 ;;^DD(396.1,12,21,2,0)
 ;;=the C&P portion of AMIE.
 ;;^DD(396.1,12,"DT")
 ;;=2930601
 ;;^DD(396.1,14,0)
 ;;=2507 INTEGRITY REPORT STATUS^RS^1:OPEN;2:COMPLETED;3:ALL;4:OFF;^0;15^Q
 ;;^DD(396.1,14,3)
 ;;=Enter the C&P link control parameter for the C&P Exam Integrity Report
 ;;^DD(396.1,14,21,0)
 ;;=^^2^2^2950126^^
 ;;^DD(396.1,14,21,1,0)
 ;;=This field contains the parameter that controls the 2507's to review when

DVBAI00K
DVBAI00K ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.1,14,21,2,0)
 ;;=reporting C&P Appointment Links on the C&P Exam Integrity report.
 ;;^DD(396.1,14,23,0)
 ;;=^^4^4^2950126^^
 ;;^DD(396.1,14,23,1,0)
 ;;='Open' means review only 2507 requests with a status of 'P' or 'S'.
 ;;^DD(396.1,14,23,2,0)
 ;;='Completed' means review only 2507 requests with a status of 'R' or 'C'.
 ;;^DD(396.1,14,23,3,0)
 ;;='All' means 2507 requests with any status will be reviewed.
 ;;^DD(396.1,14,23,4,0)
 ;;='Off' means no 2507 requests will be reviewed.
 ;;^DD(396.1,14,"DT")
 ;;=2941018
 ;;^DD(396.1,15,0)
 ;;=C&P ROUTING LOCATION^396.115P^^4;0
 ;;^DD(396.1,15,21,0)
 ;;=^^7^7^2950126^^^^
 ;;^DD(396.1,15,21,1,0)
 ;;=This field is a pointer to the HOSPITAL LOCATION file.  Its' purpose is to
 ;;^DD(396.1,15,21,2,0)
 ;;=identify any Hospital location that requests C&P exams.  This field will
 ;;^DD(396.1,15,21,3,0)
 ;;=also allow screening of Lab and Radiology data for printing with the final
 ;;^DD(396.1,15,21,4,0)
 ;;=exam results.  When final results are printed, the system will search for
 ;;^DD(396.1,15,21,5,0)
 ;;=Lab/Radiology results previous to 30 days from the request Release Date
 ;;^DD(396.1,15,21,6,0)
 ;;=and print the results if they are associated with a location contained in
 ;;^DD(396.1,15,21,7,0)
 ;;=this multiple.
 ;;^DD(396.1,16,0)
 ;;=RUN NEW REQUESTS ON SATURDAY?^RS^Y:YES;N:NO;^0;14^Q
 ;;^DD(396.1,16,3)
 ;;=Enter Y to run new requests on Saturday or N to skip.  Sunday is always skipped.
 ;;^DD(396.1,16,21,0)
 ;;=11^^5^5^2940304^^^^
 ;;^DD(396.1,16,21,1,0)
 ;;=The DATE REPORTED TO MAS is the start of the clock for a 2507 request.
 ;;^DD(396.1,16,21,2,0)
 ;;=If the Hospital C&P section is open on Saturday, this field will be marked
 ;;^DD(396.1,16,21,3,0)
 ;;='Yes' so that the Clerks can process 'New' requests on Saturday.        
 ;;^DD(396.1,16,21,4,0)
 ;;=If Saturdays are skipped, those requests entered on Friday will be reported 
 ;;^DD(396.1,16,21,5,0)
 ;;=as 'New' on Monday morning.
 ;;^DD(396.1,16,"DT")
 ;;=2900628
 ;;^DD(396.1,17,0)
 ;;=APPT LINKING ENHANCED DIALOGUE^RS^0:OFF;1:ON;^0;18^Q
 ;;^DD(396.1,17,3)
 ;;=Enter the C&P appointment dialogue parameter.  (Controls C&P appt dialogue)
 ;;^DD(396.1,17,21,0)
 ;;=^^2^2^2941018^
 ;;^DD(396.1,17,21,1,0)
 ;;=This field is an On/Off switch controlling the warnings and prompts that 
 ;;^DD(396.1,17,21,2,0)
 ;;=may display when scheduling C&P appointments.
 ;;^DD(396.1,17,23,0)
 ;;=^^6^6^2941018^
 ;;^DD(396.1,17,23,1,0)
 ;;=This field will control the amount of dialogue the user is issued when
 ;;^DD(396.1,17,23,2,0)
 ;;=scheduling C&P appointments.  If Off, the user will only be asked the
 ;;^DD(396.1,17,23,3,0)
 ;;=2507 request selection prompt and then only if more than one pending
 ;;^DD(396.1,17,23,4,0)
 ;;=request exists for the veteran.  If On, the user will see additional
 ;;^DD(396.1,17,23,5,0)
 ;;=prompts and warnings to aid proper linking of C&P appointments to the
 ;;^DD(396.1,17,23,6,0)
 ;;=2507 request.
 ;;^DD(396.1,17,"DT")
 ;;=2941018
 ;;^DD(396.1,18,0)
 ;;=C&P REPORT PARAMETER^RSI^0:OFF;1:ON;^0;19^Q
 ;;^DD(396.1,18,3)
 ;;=Enter the C&P appointment control parameter for the C&P Integrity report.
 ;;^DD(396.1,18,21,0)
 ;;=^^2^2^2950126^^^^
 ;;^DD(396.1,18,21,1,0)
 ;;=This field is an On/Off switch controlling inclusion of the C&P Appointment
 ;;^DD(396.1,18,21,2,0)
 ;;=Report in the C&P Integrity Report.
 ;;^DD(396.1,18,23,0)
 ;;=^^20^20^2950126^^^^
 ;;^DD(396.1,18,23,1,0)
 ;;=This is an On/Off switch referenced by AMIE software.  If turned Off, the
 ;;^DD(396.1,18,23,2,0)
 ;;=site will not receive the C&P appointment part of the integrity report.
 ;;^DD(396.1,18,23,3,0)
 ;;=If On, the user will receive this report with the integrity report.  The
 ;;^DD(396.1,18,23,4,0)
 ;;=functionality of this parameter is not supported nationally and this
 ;;^DD(396.1,18,23,5,0)
 ;;=field is reserved for other purposes in future versions.
 ;;^DD(396.1,18,23,6,0)
 ;;= 
 ;;^DD(396.1,18,23,7,0)
 ;;=This parameter is different from the 2507 INTEGRITY REPORT STATUS parameter
 ;;^DD(396.1,18,23,8,0)
 ;;=in that it will over ride the value in the 2507 INTEGRITY REPORT STATUS
 ;;^DD(396.1,18,23,9,0)
 ;;=parameter for the additional report generated with version 2.7.  If the
 ;;^DD(396.1,18,23,10,0)
 ;;=C&P REPORT PARAMETER is turned off, the unlinked appointment report will
 ;;^DD(396.1,18,23,11,0)
 ;;=not be included with the C&P Integrity Report regardless of the value of
 ;;^DD(396.1,18,23,12,0)
 ;;=the 2507 INTEGRITY REPORT STATUS parameter.  The C&P REPORT PARAMETER

DVBAI00L
DVBAI00L ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.1,18,23,13,0)
 ;;=will allow the site to list those 2507 requests lacking appointment links
 ;;^DD(396.1,18,23,14,0)
 ;;=on the C&P Integrity Report without printing the unlinked appointment
 ;;^DD(396.1,18,23,15,0)
 ;;=report.
 ;;^DD(396.1,18,23,16,0)
 ;;= 
 ;;^DD(396.1,18,23,17,0)
 ;;=AGAIN: This parameter is not supported in the release of V2.7 but is
 ;;^DD(396.1,18,23,18,0)
 ;;=included to allow future support of this functionality.  Future versions
 ;;^DD(396.1,18,23,19,0)
 ;;=of AMIE may remove this parameter and the potential functionality it
 ;;^DD(396.1,18,23,20,0)
 ;;=provides.
 ;;^DD(396.1,18,"DT")
 ;;=2941228
 ;;^DD(396.1,50,0)
 ;;=LAST EXAM NUMBER^NJ12,0I^^5;1^K:+X'=X!(X>999999999999)!(X<1)!(X?.E1"."1N.N) X
 ;;^DD(396.1,50,3)
 ;;=Type a Number between 1 and 999999999999, 0 Decimal Digits
 ;;^DD(396.1,50,9)
 ;;=^
 ;;^DD(396.1,50,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.1,50,21,1,0)
 ;;=This field contains the number of the last entry in the 2507 EXAM file
 ;;^DD(396.1,50,21,2,0)
 ;;=(#396.4).  It should NEVER be edited.
 ;;^DD(396.1,50,"DT")
 ;;=2930209
 ;;^DD(396.1,90,0)
 ;;=POST INIT SCRATCH^F^^POST;1^K:$L(X)>245!($L(X)<1) X
 ;;^DD(396.1,90,3)
 ;;=Answer must be 1-245 characters in length.
 ;;^DD(396.1,90,21,0)
 ;;=^^2^2^2940309^^
 ;;^DD(396.1,90,21,1,0)
 ;;=This field is used during AMIE installations to globally store data needed
 ;;^DD(396.1,90,21,2,0)
 ;;=to complete a post initialization.
 ;;^DD(396.1,90,"DT")
 ;;=2940126
 ;;^DD(396.115,0)
 ;;=C&P ROUTING LOCATION SUB-FIELD^^.01^1
 ;;^DD(396.115,0,"IX","B",396.115,.01)
 ;;=
 ;;^DD(396.115,0,"NM","C&P ROUTING LOCATION")
 ;;=
 ;;^DD(396.115,0,"UP")
 ;;=396.1
 ;;^DD(396.115,.01,0)
 ;;=C&P ROUTING LOCATION^MP44'^SC(^0;1^Q
 ;;^DD(396.115,.01,1,0)
 ;;=^.1
 ;;^DD(396.115,.01,1,1,0)
 ;;=396.115^B
 ;;^DD(396.115,.01,1,1,1)
 ;;=S ^DVB(396.1,DA(1),4,"B",$E(X,1,30),DA)=""
 ;;^DD(396.115,.01,1,1,2)
 ;;=K ^DVB(396.1,DA(1),4,"B",$E(X,1,30),DA)
 ;;^DD(396.115,.01,3)
 ;;=Enter a C&P routing location.
 ;;^DD(396.115,.01,21,0)
 ;;=^^1^1^2950126^^^^
 ;;^DD(396.115,.01,21,1,0)
 ;;=This field contains Hospital Locations that request 2507 requests.
 ;;^DD(396.115,.01,"DT")
 ;;=2900827
 ;;^DD(396.12,0)
 ;;=REGIONAL OFFICES ALLOWED SUB-FIELD^^.01^1
 ;;^DD(396.12,0,"IX","B",396.12,.01)
 ;;=
 ;;^DD(396.12,0,"NM","REGIONAL OFFICES ALLOWED")
 ;;=
 ;;^DD(396.12,0,"UP")
 ;;=396.1
 ;;^DD(396.12,.01,0)
 ;;=REGIONAL OFFICES ALLOWED^MP4'^DIC(4,^0;1^Q
 ;;^DD(396.12,.01,1,0)
 ;;=^.1
 ;;^DD(396.12,.01,1,1,0)
 ;;=396.12^B
 ;;^DD(396.12,.01,1,1,1)
 ;;=S ^DVB(396.1,DA(1),1,"B",$E(X,1,30),DA)=""
 ;;^DD(396.12,.01,1,1,2)
 ;;=K ^DVB(396.1,DA(1),1,"B",$E(X,1,30),DA)
 ;;^DD(396.12,.01,3)
 ;;=Enter the number or name of the Regional Offices which will be using this package at your station.
 ;;^DD(396.12,.01,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.12,.01,21,1,0)
 ;;=This field contains the regional offices that will be using AMIE
 ;;^DD(396.12,.01,21,2,0)
 ;;=at the site.
 ;;^DD(396.13,0)
 ;;=REMOTE SITE (7131) SUB-FIELD^^1^2
 ;;^DD(396.13,0,"IX","B",396.13,.01)
 ;;=
 ;;^DD(396.13,0,"NM","REMOTE SITE (7131)")
 ;;=
 ;;^DD(396.13,0,"UP")
 ;;=396.1
 ;;^DD(396.13,.01,0)
 ;;=REMOTE SITE (7131)^MP40.8'^DG(40.8,^0;1^Q
 ;;^DD(396.13,.01,1,0)
 ;;=^.1
 ;;^DD(396.13,.01,1,1,0)
 ;;=396.13^B
 ;;^DD(396.13,.01,1,1,1)
 ;;=S ^DVB(396.1,DA(1),2,"B",$E(X,1,30),DA)=""
 ;;^DD(396.13,.01,1,1,2)
 ;;=K ^DVB(396.1,DA(1),2,"B",$E(X,1,30),DA)
 ;;^DD(396.13,.01,3)
 ;;=Enter the name of the hospital or a valid remote site.
 ;;^DD(396.13,.01,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.13,.01,21,1,0)
 ;;=This field contains the names of the divisions that will be using
 ;;^DD(396.13,.01,21,2,0)
 ;;=the 7131 portion of AMIE.
 ;;^DD(396.13,1,0)
 ;;=PRINTER NUMBER^FX^^0;2^K:$L(X)>30!($L(X)<1) X I $D(X) S DVBAX=X,%ZIS="NQ",IOP=DVBAX K X D ^%ZIS K:POP DVBAX S:$D(DVBAX) X=ION W:$D(X) "  Stored internally as ",X S IOP="HOME" D ^%ZIS K DVBAX,IOP,%ZIS
 ;;^DD(396.13,1,3)
 ;;=Must already be in the DEVICE file (#3.5).  [1-30 characters]
 ;;^DD(396.13,1,4)
 ;;=D HLP2^%ZIS
 ;;^DD(396.13,1,21,0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396.13,1,21,1,0)
 ;;=This field contains the name of the printer designated by the
 ;;^DD(396.13,1,21,2,0)
 ;;=division for AMIE reports.  NOTE:  This field must be entered
 ;;^DD(396.13,1,21,3,0)
 ;;=exactly as the printer is defined in the Device file.
 ;;^DD(396.13,1,"DT")
 ;;=2900222
 ;;^DD(396.14,0)
 ;;=REMOTE SITE (2507) SUB-FIELD^^1^2
 ;;^DD(396.14,0,"IX","B",396.14,.01)
 ;;=
 ;;^DD(396.14,0,"NM","REMOTE SITE (2507)")
 ;;=
 ;;^DD(396.14,0,"UP")
 ;;=396.1
 ;;^DD(396.14,.01,0)
 ;;=REMOTE SITE (2507)^MP40.8'^DG(40.8,^0;1^Q

DVBAI00M
DVBAI00M ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.1)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.14,.01,1,0)
 ;;=^.1
 ;;^DD(396.14,.01,1,1,0)
 ;;=396.14^B
 ;;^DD(396.14,.01,1,1,1)
 ;;=S ^DVB(396.1,DA(1),3,"B",$E(X,1,30),DA)=""
 ;;^DD(396.14,.01,1,1,2)
 ;;=K ^DVB(396.1,DA(1),3,"B",$E(X,1,30),DA)
 ;;^DD(396.14,.01,3)
 ;;=Enter the name of the hospital or a valid remote site.
 ;;^DD(396.14,.01,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.14,.01,21,1,0)
 ;;=This field contains the names of the divisions that will be using
 ;;^DD(396.14,.01,21,2,0)
 ;;=the C&P portion of AMIE.
 ;;^DD(396.14,1,0)
 ;;=PRINTER NUMBER^FX^^0;2^K:$L(X)>30!($L(X)<1) X I $D(X) S DVBAX=X,%ZIS="NQ",IOP=DVBAX K X D ^%ZIS K:POP DVBAX S:$D(DVBAX) X=ION W:$D(X) "  Stored internally as ",X S IOP="HOME" D ^%ZIS K IOP,%ZIS
 ;;^DD(396.14,1,3)
 ;;=Must already be in the Device file.  [1-30 characters]
 ;;^DD(396.14,1,4)
 ;;=D HLP2^%ZIS
 ;;^DD(396.14,1,21,0)
 ;;=^^3^3^2940304^^^^
 ;;^DD(396.14,1,21,1,0)
 ;;=This field contains the name of the printer designated by the
 ;;^DD(396.14,1,21,2,0)
 ;;=division to be used for 2507 reports.  NOTE:  This field must be
 ;;^DD(396.14,1,21,3,0)
 ;;=entered exactly as the printer is defined in the Device file.
 ;;^DD(396.14,1,"DT")
 ;;=2900222

DVBAI00N
DVBAI00N ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.2,0,"GL")
 ;;=^DVB(396.2,
 ;;^DIC("B","AMIE REPORT",396.2)
 ;;=
 ;;^DIC(396.2,"%",0)
 ;;=^1.005^1^1
 ;;^DIC(396.2,"%",1,0)
 ;;=DVBA
 ;;^DIC(396.2,"%","B","DVBA",1)
 ;;=
 ;;^DIC(396.2,"%D",0)
 ;;=^^5^5^2941216^^^^
 ;;^DIC(396.2,"%D",1,0)
 ;;=File to hold various parameters for specialized reporting in the A.M.I.E.
 ;;^DIC(396.2,"%D",2,0)
 ;;=package.  Information is deleted as soon as possible.
 ;;^DIC(396.2,"%D",3,0)
 ;;= 
 ;;^DIC(396.2,"%D",4,0)
 ;;=(This file is used specifically when generating and printing Notices of
 ;;^DIC(396.2,"%D",5,0)
 ;;=Discharge.)
 ;;^DD(396.2,0)
 ;;=FIELD^^5^7
 ;;^DD(396.2,0,"DDA")
 ;;=N
 ;;^DD(396.2,0,"DT")
 ;;=2930128
 ;;^DD(396.2,0,"IX","B",396.2,.01)
 ;;=
 ;;^DD(396.2,0,"IX","C",396.2,3)
 ;;=
 ;;^DD(396.2,0,"IX","D",396.2,1)
 ;;=
 ;;^DD(396.2,0,"NM","AMIE REPORT")
 ;;=
 ;;^DD(396.2,.01,0)
 ;;=NAME^RP2'^DPT(^0;1^Q
 ;;^DD(396.2,.01,1,0)
 ;;=^.1
 ;;^DD(396.2,.01,1,1,0)
 ;;=396.2^B
 ;;^DD(396.2,.01,1,1,1)
 ;;=S ^DVB(396.2,"B",$E(X,1,30),DA)=""
 ;;^DD(396.2,.01,1,1,2)
 ;;=K ^DVB(396.2,"B",$E(X,1,30),DA)
 ;;^DD(396.2,.01,3)
 ;;=Pointer to patient file for DFN
 ;;^DD(396.2,.01,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.2,.01,21,1,0)
 ;;=Name of the Patient.
 ;;^DD(396.2,.01,23,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.2,.01,23,1,0)
 ;;=Pointer to the Patient File.
 ;;^DD(396.2,1,0)
 ;;=7132 ADMISSION DATE^D^^0;2^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.2,1,1,0)
 ;;=^.1
 ;;^DD(396.2,1,1,1,0)
 ;;=396.2^D^MUMPS
 ;;^DD(396.2,1,1,1,1)
 ;;=S DVBADFN=$P(^DVB(396.2,DA,0),U,1) S ^DVB(396.2,"D",$E(X,1,30),DVBADFN,DA)="" K DVBADFN
 ;;^DD(396.2,1,1,1,2)
 ;;=S DVBADFN=$P(^DVB(396.2,DA,0),U,1) K ^DVB(396.2,"D",$E(X,1,30),DVBADFN,DA),DVBADFN
 ;;^DD(396.2,1,1,1,"%D",0)
 ;;=^^1^1^2940304^
 ;;^DD(396.2,1,1,1,"%D",1,0)
 ;;=This cross reference orders 7132 Admission Dates by date then patient.
 ;;^DD(396.2,1,3)
 ;;=This field is generated by the Notice of Discharge program.
 ;;^DD(396.2,1,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.2,1,21,1,0)
 ;;=This field holds the date of admission for a veteran.  It is used when
 ;;^DD(396.2,1,21,2,0)
 ;;=printing Notices of Discharge.
 ;;^DD(396.2,1,23,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.2,1,23,1,0)
 ;;=Entered by the routine DVBADSCK.
 ;;^DD(396.2,1,"DT")
 ;;=2920618
 ;;^DD(396.2,2,0)
 ;;=7132 ADMISSION POINTER^NJ9,0^^0;3^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
 ;;^DD(396.2,2,3)
 ;;=Type a Number between 1 and 999999999, 0 Decimal Digits
 ;;^DD(396.2,2,21,0)
 ;;=^^1^1^2940304^^
 ;;^DD(396.2,2,21,1,0)
 ;;=Pointer to the Patient Movement file.
 ;;^DD(396.2,2,"DT")
 ;;=2910622
 ;;^DD(396.2,3,0)
 ;;=7132 STATUS^S^P:PRINTED;R:READY TO PRINT;^0;4^Q
 ;;^DD(396.2,3,1,0)
 ;;=^.1
 ;;^DD(396.2,3,1,1,0)
 ;;=396.2^C^MUMPS
 ;;^DD(396.2,3,1,1,1)
 ;;=S DVBADFN=$P(^DVB(396.2,DA,0),U,1),XLOC=$P(^(0),U,7) Q:XLOC=""  S ^DVB(396.2,"C",XLOC,$E(X,1,30),DA)="" K DVBADFN,XLOC
 ;;^DD(396.2,3,1,1,2)
 ;;=S DVBADFN=$P(^DVB(396.2,DA,0),U,1),XLOC=$P(^(0),U,7) Q:XLOC=""  K ^DVB(396.2,"C",XLOC,$E(X,1,30),DA),XLOC,DVBADFN
 ;;^DD(396.2,3,1,1,"%D",0)
 ;;=^^1^1^2940304^
 ;;^DD(396.2,3,1,1,"%D",1,0)
 ;;=This cross reference orders 7132s by routing location and status.
 ;;^DD(396.2,3,3)
 ;;=Status of the notice of discharge.
 ;;^DD(396.2,3,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.2,3,21,1,0)
 ;;=The print status of the Notice of Discharge Record.
 ;;^DD(396.2,3,23,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.2,3,23,1,0)
 ;;=Set by the Notice of Discharge checking routine and the Notice of Discharge
 ;;^DD(396.2,3,23,2,0)
 ;;=print routine.
 ;;^DD(396.2,3.5,0)
 ;;=7132 ROUTING LOCATION^NJ3,0^^0;7^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
 ;;^DD(396.2,3.5,3)
 ;;=This is the number of the RO to which this belongs.
 ;;^DD(396.2,3.5,21,0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396.2,3.5,21,1,0)
 ;;=Holds the Patient File Claim Folder Location for the patient that a Notice
 ;;^DD(396.2,3.5,21,2,0)
 ;;=of Discharge was generated.
 ;;^DD(396.2,3.5,23,0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396.2,3.5,23,1,0)
 ;;=This field value must match the user's Station Number from the Institution
 ;;^DD(396.2,3.5,23,2,0)
 ;;=file for the user to be able to print the Notice of Discharge.
 ;;^DD(396.2,4,0)
 ;;=DATE 7132 PRINTED^D^^0;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.2,4,3)
 ;;=Date printed by the RO.
 ;;^DD(396.2,4,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.2,4,21,1,0)
 ;;=This field contains the date the Notice of Discharge was originally printed.
 ;;^DD(396.2,4,23,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.2,4,23,1,0)
 ;;=Set by the routine DVBADSNT.
 ;;^DD(396.2,5,0)
 ;;=7132 PRINTED BY^P200'^VA(200,^0;6^Q
 ;;^DD(396.2,5,3)
 ;;=Name of person who printed the notice of discharge.

DVBAI00O
DVBAI00O ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.2)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.2,5,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.2,5,21,1,0)
 ;;=Indicates the name of the person who originally printed the Notice of
 ;;^DD(396.2,5,21,2,0)
 ;;=Discharge.
 ;;^DD(396.2,5,23,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.2,5,23,1,0)
 ;;=Contains the DUZ of the person who printed the Notice of Discharge with
 ;;^DD(396.2,5,23,2,0)
 ;;=the routine DVBADSNT.
 ;;^DD(396.2,5,"DT")
 ;;=2930128

DVBAI00P
DVBAI00P ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.3,0,"GL")
 ;;=^DVB(396.3,
 ;;^DIC("B","2507 REQUEST",396.3)
 ;;=
 ;;^DIC(396.3,"%D",0)
 ;;=^^1^1^2950210^^^^
 ;;^DIC(396.3,"%D",1,0)
 ;;=Holds all 2507 requests generated from Regional Office users.
 ;;^DD(396.3,0)
 ;;=FIELD^^45^42
 ;;^DD(396.3,0,"DDA")
 ;;=N
 ;;^DD(396.3,0,"DT")
 ;;=2941116
 ;;^DD(396.3,0,"ID",1)
 ;;=W "   ",$E($P(^(0),U,2),4,5)_"-"_$E($P(^(0),U,2),6,7)_"-"_$E($P(^(0),U,2),2,3)
 ;;^DD(396.3,0,"ID","WRITE")
 ;;=D DICW^DVBCUTIL
 ;;^DD(396.3,0,"IX","AC",396.3,23.5)
 ;;=
 ;;^DD(396.3,0,"IX","AD",396.3,23.3)
 ;;=
 ;;^DD(396.3,0,"IX","ADP1",396.3,4)
 ;;=
 ;;^DD(396.3,0,"IX","ADP2",396.3,9)
 ;;=
 ;;^DD(396.3,0,"IX","AE",396.3,31)
 ;;=
 ;;^DD(396.3,0,"IX","AF",396.3,17)
 ;;=
 ;;^DD(396.3,0,"IX","AG",396.3,2)
 ;;=
 ;;^DD(396.3,0,"IX","AORQ",396.3,44)
 ;;=
 ;;^DD(396.3,0,"IX","B",396.3,.01)
 ;;=
 ;;^DD(396.3,0,"IX","C",396.3,1)
 ;;=
 ;;^DD(396.3,0,"IX","E",396.3,11)
 ;;=
 ;;^DD(396.3,0,"NM","2507 REQUEST")
 ;;=
 ;;^DD(396.3,0,"PT",396.3,44)
 ;;=
 ;;^DD(396.3,0,"PT",396.4,.02)
 ;;=
 ;;^DD(396.3,0,"PT",396.95,.06)
 ;;=
 ;;^DD(396.3,.01,0)
 ;;=NAME^RP2^DPT(^0;1^Q
 ;;^DD(396.3,.01,1,0)
 ;;=^.1
 ;;^DD(396.3,.01,1,1,0)
 ;;=396.3^B
 ;;^DD(396.3,.01,1,1,1)
 ;;=S ^DVB(396.3,"B",$E(X,1,30),DA)=""
 ;;^DD(396.3,.01,1,1,2)
 ;;=K ^DVB(396.3,"B",$E(X,1,30),DA)
 ;;^DD(396.3,.01,3)
 ;;=Enter the name of the Veteran as it appears on the hospital records or how it appears on your records.
 ;;^DD(396.3,.01,21,0)
 ;;=^^2^2^2940919^^^
 ;;^DD(396.3,.01,21,1,0)
 ;;=This field contains the name of the veteran for whom you are requesting
 ;;^DD(396.3,.01,21,2,0)
 ;;=a 2507 exam.
 ;;^DD(396.3,1,0)
 ;;=REQUEST DATE^MRD^^0;2^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,1,1,0)
 ;;=^.1
 ;;^DD(396.3,1,1,1,0)
 ;;=396.3^C
 ;;^DD(396.3,1,1,1,1)
 ;;=S ^DVB(396.3,"C",$E(X,1,30),DA)=""
 ;;^DD(396.3,1,1,1,2)
 ;;=K ^DVB(396.3,"C",$E(X,1,30),DA)
 ;;^DD(396.3,1,3)
 ;;=Enter the date and time of the request.  Seconds may be used and are encouraged.
 ;;^DD(396.3,1,21,0)
 ;;=^^1^1^2930512^^
 ;;^DD(396.3,1,21,1,0)
 ;;=This field contains the date the 2507 request was entered.
 ;;^DD(396.3,1,"DT")
 ;;=2900719
 ;;^DD(396.3,2,0)
 ;;=REGIONAL OFFICE NUMBER^RP4'^DIC(4,^0;3^Q
 ;;^DD(396.3,2,1,0)
 ;;=^.1
 ;;^DD(396.3,2,1,1,0)
 ;;=396.3^AG^MUMPS
 ;;^DD(396.3,2,1,1,1)
 ;;=N DVBCSTAT S DVBCSTAT=$P(^DVB(396.3,DA,0),U,18) S:DVBCSTAT]"" ^DVB(396.3,"AF",DVBCSTAT,$E(X,1,30),DA)=""
 ;;^DD(396.3,2,1,1,2)
 ;;=N DVBCSTAT S DVBCSTAT=$P(^DVB(396.3,DA,0),U,18) K:DVBCSTAT]"" ^DVB(396.3,"AF",DVBCSTAT,$E(X,1,30),DA)
 ;;^DD(396.3,2,1,1,"%D",0)
 ;;=^^2^2^2950126^^
 ;;^DD(396.3,2,1,1,"%D",1,0)
 ;;=This is the other half of the complex cross reference on the REQUEST 
 ;;^DD(396.3,2,1,1,"%D",2,0)
 ;;=STATUS field.
 ;;^DD(396.3,2,1,1,"DT")
 ;;=2940906
 ;;^DD(396.3,2,3)
 ;;=Enter the name or number of the Regional Office which owns this request.
 ;;^DD(396.3,2,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,2,21,1,0)
 ;;=This field contains the name of the regional office that entered the
 ;;^DD(396.3,2,21,2,0)
 ;;=request.
 ;;^DD(396.3,2,"DT")
 ;;=2940906
 ;;^DD(396.3,3,0)
 ;;=REQUESTER^RP200'^VA(200,^0;4^Q
 ;;^DD(396.3,3,3)
 ;;=The name of the person who entered the request.
 ;;^DD(396.3,3,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,3,21,1,0)
 ;;=This field contains the name of the regional office employee who entered
 ;;^DD(396.3,3,21,2,0)
 ;;=the 2507 request.
 ;;^DD(396.3,3,"DT")
 ;;=2930128
 ;;^DD(396.3,4,0)
 ;;=DATE REPORTED TO MAS^D^^0;5^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,4,1,0)
 ;;=^.1
 ;;^DD(396.3,4,1,1,0)
 ;;=396.3^ADP1^MUMPS
 ;;^DD(396.3,4,1,1,1)
 ;;=S:$P(^DVB(396.3,DA,0),U,10)'="" ^DVB(396.3,"ADP",$E(X,1,30),$P(^(0),U,10),DA)=""
 ;;^DD(396.3,4,1,1,2)
 ;;=I $P(^DVB(396.3,DA,0),U,10)'="" K ^DVB(396.3,"ADP",$E(X,1,30),$P(^(0),U,10),DA)
 ;;^DD(396.3,4,1,1,"%D",0)
 ;;=^^2^2^2941116^^^
 ;;^DD(396.3,4,1,1,"%D",1,0)
 ;;=The 'ADP' cross reference is used by the 'Summary Insufficient Exam Report'
 ;;^DD(396.3,4,1,1,"%D",2,0)
 ;;=as generated by the Insufficient Exam Report option.
 ;;^DD(396.3,4,1,1,"DT")
 ;;=2941116
 ;;^DD(396.3,4,3)
 ;;=The date the request was printed out for MAS.
 ;;^DD(396.3,4,21,0)
 ;;=4^^4^4^2930503^
 ;;^DD(396.3,4,21,1,0)
 ;;=This is the date the request was reported (printed) to MAS.  It can only
 ;;^DD(396.3,4,21,2,0)
 ;;=be set one time, at the first printing.  Future prints or reprints of
 ;;^DD(396.3,4,21,3,0)
 ;;=the same request will not alter the "starting" date.  This date is the
 ;;^DD(396.3,4,21,4,0)
 ;;=basis for when the clock begins for both the RO and MAS.
 ;;^DD(396.3,4,21,5,0)
 ;;= 
 ;;^DD(396.3,4,21,6,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled

DVBAI00Q
DVBAI00Q ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.3,4,21,7,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.3,4,21,8,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.3,4,21,9,0)
 ;;=modifications.
 ;;^DD(396.3,4,23,0)
 ;;=^^1^1^2940209^^
 ;;^DD(396.3,4,23,1,0)
 ;;=Modified when the is printed as a new 2507 request.
 ;;^DD(396.3,4,"DT")
 ;;=2941116
 ;;^DD(396.3,5,0)
 ;;=DATE SCHEDULING COMPLETED^D^^0;6^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,5,3)
 ;;=The date the last exam was successfully scheduled by MAS.
 ;;^DD(396.3,5,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,5,21,1,0)
 ;;=This field contains the date scheduling of the 2507 request was completed
 ;;^DD(396.3,5,21,2,0)
 ;;=through the AMIE option.
 ;;^DD(396.3,5,21,3,0)
 ;;= 
 ;;^DD(396.3,5,21,4,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled
 ;;^DD(396.3,5,21,5,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.3,5,21,6,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.3,5,21,7,0)
 ;;=modifications.
 ;;^DD(396.3,5,21,8,0)
 ;;= 
 ;;^DD(396.3,5,23,0)
 ;;=^^3^3^2940209^^^^
 ;;^DD(396.3,5,23,1,0)
 ;;=Modified by the option 'Schedule C&P Exams' when the user enters 'Yes'
 ;;^DD(396.3,5,23,2,0)
 ;;=to the prompt 'Has scheduling for all exams been completed?'.  Todays date
 ;;^DD(396.3,5,23,3,0)
 ;;=is entered.
 ;;^DD(396.3,6,0)
 ;;=DATE COMPLETED^D^^0;7^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,6,3)
 ;;=The date the entire request was completed.
 ;;^DD(396.3,6,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,6,21,1,0)
 ;;=This field contains the date the entire 2507 request was completed.
 ;;^DD(396.3,9,0)
 ;;=PRIORITY OF EXAM^RS^T:TERMINAL;P:POW;OS:ORIGINAL SC;ON:ORIGINAL NSC;I:INCREASE;R:REVIEW;OTR:OTHER;E:INSUFFICIENT EXAM;^0;10^Q
 ;;^DD(396.3,9,1,0)
 ;;=^.1
 ;;^DD(396.3,9,1,1,0)
 ;;=396.3^ADP2^MUMPS
 ;;^DD(396.3,9,1,1,1)
 ;;=S:$P(^DVB(396.3,DA,0),U,5)'="" ^DVB(396.3,"ADP",$P(^(0),U,5),$E(X,1,30),DA)=""
 ;;^DD(396.3,9,1,1,2)
 ;;=I $P(^DVB(396.3,DA,0),U,5)'="" K ^DVB(396.3,"ADP",$P(^(0),U,5),$E(X,1,30),DA)
 ;;^DD(396.3,9,1,1,"%D",0)
 ;;=^^2^2^2941116^^^^
 ;;^DD(396.3,9,1,1,"%D",1,0)
 ;;=The 'ADP' cross reference is used by the 'Summary Insufficient Exam Report'
 ;;^DD(396.3,9,1,1,"%D",2,0)
 ;;=as generated by the Insufficient Exam Report option.
 ;;^DD(396.3,9,1,1,"DT")
 ;;=2941116
 ;;^DD(396.3,9,3)
 ;;=Enter the priority of the exam to be conducted.
 ;;^DD(396.3,9,21,0)
 ;;=^^1^1^2940830^^^
 ;;^DD(396.3,9,21,1,0)
 ;;=This field contains the status of the 2507 exam to be conducted.
 ;;^DD(396.3,9,"DT")
 ;;=2941116
 ;;^DD(396.3,10,0)
 ;;=OTHER DISABILITIES [Line 1]^F^^0;11^K:$L(X)>75!($L(X)<1) X
 ;;^DD(396.3,10,.1)
 ;;=OTHER DIS. [Line 1]
 ;;^DD(396.3,10,3)
 ;;=Enter any other disabilities known or stated by the Veteran.  [1-75 characters].
 ;;^DD(396.3,10,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,10,21,1,0)
 ;;=This field contains other known disabilities or those stated by the veteran.
 ;;^DD(396.3,10.1,0)
 ;;=OTHER DISABILITIES [Line 2]^F^^1;9^K:$L(X)>75!($L(X)<1) X
 ;;^DD(396.3,10.1,.1)
 ;;=OTHER DIS. [Line 2]
 ;;^DD(396.3,10.1,3)
 ;;=Answer must be 1-75 characters in length.
 ;;^DD(396.3,10.1,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,10.1,21,1,0)
 ;;=This field contains other known disabilities or those stated by the veteran.
 ;;^DD(396.3,10.1,"DT")
 ;;=2900608
 ;;^DD(396.3,10.2,0)
 ;;=OTHER DISABILITIES [Line 3]^F^^1;10^K:$L(X)>75!($L(X)<1) X
 ;;^DD(396.3,10.2,.1)
 ;;=OTHER DIS. [Line 3]
 ;;^DD(396.3,10.2,3)
 ;;=Answer must be 1-75 characters in length.
 ;;^DD(396.3,10.2,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,10.2,21,1,0)
 ;;=This field contains other known disabilities or those stated by the veteran.
 ;;^DD(396.3,11,0)
 ;;=TRANSCRIPTION DATE^D^^0;12^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,11,1,0)
 ;;=^.1
 ;;^DD(396.3,11,1,1,0)
 ;;=396.3^E
 ;;^DD(396.3,11,1,1,1)
 ;;=S ^DVB(396.3,"E",$E(X,1,30),DA)=""
 ;;^DD(396.3,11,1,1,2)
 ;;=K ^DVB(396.3,"E",$E(X,1,30),DA)
 ;;^DD(396.3,11,3)
 ;;=Enter the date and time the transcription was completed.
 ;;^DD(396.3,11,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,11,21,1,0)
 ;;=This field contains the date/time transcription was completed.
 ;;^DD(396.3,11,"DT")
 ;;=2900112
 ;;^DD(396.3,12,0)
 ;;=DATE APPROVED^D^^0;13^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,12,3)
 ;;=Enter the date and time the exam results were approved.
 ;;^DD(396.3,12,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,12,21,1,0)
 ;;=This field contains the date/time exam results were approved.

DVBAI00R
DVBAI00R ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.3,13,0)
 ;;=DATE RELEASED^D^^0;14^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,13,3)
 ;;=Enter the date and time that the request was released to the RO for printing.
 ;;^DD(396.3,13,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,13,21,1,0)
 ;;=This field contains the date/time the 2507 request was released to the
 ;;^DD(396.3,13,21,2,0)
 ;;=regional office for printing.
 ;;^DD(396.3,13,21,3,0)
 ;;= 
 ;;^DD(396.3,13,21,4,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled
 ;;^DD(396.3,13,21,5,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.3,13,21,6,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.3,13,21,7,0)
 ;;=modifications.
 ;;^DD(396.3,14,0)
 ;;=RELEASED BY^P200'^VA(200,^0;15^Q
 ;;^DD(396.3,14,3)
 ;;=The name of the person who released the request to the RO.
 ;;^DD(396.3,14,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,14,21,1,0)
 ;;=This field contains the name of the MAS employee who released the request
 ;;^DD(396.3,14,21,2,0)
 ;;=to the regional office.
 ;;^DD(396.3,14,"DT")
 ;;=2930128
 ;;^DD(396.3,15,0)
 ;;=DATE PRINTED BY THE RO^MD^^0;16^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,15,3)
 ;;=The date and time the examination results were printed by the RO.
 ;;^DD(396.3,15,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,15,21,1,0)
 ;;=This field contains the date/time the examination results were printed by
 ;;^DD(396.3,15,21,2,0)
 ;;=the regional office.
 ;;^DD(396.3,16,0)
 ;;=PRINTED BY^P200'^VA(200,^0;17^Q
 ;;^DD(396.3,16,3)
 ;;=The name of the person that printed the examination results.
 ;;^DD(396.3,16,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,16,21,1,0)
 ;;=This field contains the name of the regional office employee who printed
 ;;^DD(396.3,16,21,2,0)
 ;;=the examination results.
 ;;^DD(396.3,16,"DT")
 ;;=2930128
 ;;^DD(396.3,17,0)
 ;;=REQUEST STATUS^RS^N:NEW;P:PENDING, REPORTED;S:PENDING, SCHEDULED;R:RELEASED TO RO, NOT PRINTED;C:COMPLETED, PRINTED BY RO;X:CANCELLED BY MAS;RX:CANCELLED BY RO;T:TRANSCRIBED;NT:NEW, TRANSFERRED IN;CT:COMPLETED, TRANSFERRED OUT;^0;18^Q
 ;;^DD(396.3,17,1,0)
 ;;=^.1
 ;;^DD(396.3,17,1,1,0)
 ;;=396.3^AF^MUMPS
 ;;^DD(396.3,17,1,1,1)
 ;;=S DVBCRO=$P(^DVB(396.3,DA,0),U,3) S:DVBCRO]"" ^DVB(396.3,"AF",$E(X,1,30),DVBCRO,DA)="" K DVBCRO
 ;;^DD(396.3,17,1,1,2)
 ;;=S DVBCRO=$P(^DVB(396.3,DA,0),U,3) K:DVBCRO]"" ^DVB(396.3,"AF",$E(X,1,30),DVBCRO,DA) K DVBCRO
 ;;^DD(396.3,17,1,1,"%D",0)
 ;;=^^2^2^2940906^
 ;;^DD(396.3,17,1,1,"%D",1,0)
 ;;=This cross reference is to collect all entries with the same Regional
 ;;^DD(396.3,17,1,1,"%D",2,0)
 ;;=Office number and request status.
 ;;^DD(396.3,17,1,1,"DT")
 ;;=2940906
 ;;^DD(396.3,17,3)
 ;;=The status of the entire request.
 ;;^DD(396.3,17,21,0)
 ;;=^^1^1^2950126^^
 ;;^DD(396.3,17,21,1,0)
 ;;=This field contains the request status of the 2507 exam request.
 ;;^DD(396.3,17,"DT")
 ;;=2940906
 ;;^DD(396.3,18,0)
 ;;=ELAPSED TIME^CJ8,0^^ ; ^S Y(396.3,18,1)=$S($D(^DVB(396.3,D0,0)):^(0),1:""),X=DT S X=X,X1=X,X2=$P(Y(396.3,18,1),U,5),X="" D:X2 ^%DTC:X1 S X=$J(X,0,0)
 ;;^DD(396.3,18,9)
 ;;=^
 ;;^DD(396.3,18,9.01)
 ;;=396.3^4
 ;;^DD(396.3,18,9.1)
 ;;=TODAY-DATE REPORTED TO MAS
 ;;^DD(396.3,18,21,0)
 ;;=^^1^1^2930503^^^
 ;;^DD(396.3,18,21,1,0)
 ;;=This field contains the computation of TODAY - DATE REPORTED TO MAS.
 ;;^DD(396.3,18,"DT")
 ;;=2900619
 ;;^DD(396.3,19,0)
 ;;=CANCELLATION DATE^D^^0;19^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,19,3)
 ;;=The date and time the entire request was cancelled.
 ;;^DD(396.3,19,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,19,21,1,0)
 ;;=This field contains the date/time the entire request was cancelled.
 ;;^DD(396.3,19,21,2,0)
 ;;= 
 ;;^DD(396.3,19,21,3,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled
 ;;^DD(396.3,19,21,4,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.3,19,21,5,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.3,19,21,6,0)
 ;;=modifications.
 ;;^DD(396.3,20,0)
 ;;=CANCELLED BY^P200'^VA(200,^1;1^Q
 ;;^DD(396.3,20,3)
 ;;=The name of the person who cancelled the entire request.
 ;;^DD(396.3,20,21,0)
 ;;=^^2^2^2950126^^
 ;;^DD(396.3,20,21,1,0)
 ;;=This field contains the name of the employee who cancelled the entire
 ;;^DD(396.3,20,21,2,0)
 ;;=request.
 ;;^DD(396.3,20,"DT")
 ;;=2930128
 ;;^DD(396.3,21,0)
 ;;=CLAIM FOLDER REQUIRED?^RS^Y:YES;N:NO;^1;2^Q
 ;;^DD(396.3,21,3)
 ;;=Enter Y if a claim folder review will be required or N if no review will be necessary.

DVBAI00S
DVBAI00S ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.3,21,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,21,21,1,0)
 ;;=This field indicates whether or not a claim folder is required for this
 ;;^DD(396.3,21,21,2,0)
 ;;=request.
 ;;^DD(396.3,21,"DT")
 ;;=2900413
 ;;^DD(396.3,22,0)
 ;;=OTHER DOCUMENTS REQUIRED?^RS^Y:YES;N:NO;^1;3^Q
 ;;^DD(396.3,22,3)
 ;;=Enter 'Y' if other documents will be required or 'N' if not.  A 'N' answer will prompt the Regional Office to print this request as New.  A 'Y' answer will prevent this prompting at the R/O.
 ;;^DD(396.3,22,21,0)
 ;;=^^3^3^2950126^^^^
 ;;^DD(396.3,22,21,1,0)
 ;;=This field indicates whether or not a document will be able to be printed
 ;;^DD(396.3,22,21,2,0)
 ;;=at the regional office.  If YES, the regional office will not be prompted
 ;;^DD(396.3,22,21,3,0)
 ;;=to print the document when it is released by the Medical Center. 
 ;;^DD(396.3,22,23,0)
 ;;=^^9^9^2950126^^^^
 ;;^DD(396.3,22,23,1,0)
 ;;=If the user enters YES to this field upon release to the Regional Office,
 ;;^DD(396.3,22,23,2,0)
 ;;=fields DATE COMPLETED, DATE APPROVED, DATE RELEASED and DATE PRINTED BY THE 
 ;;^DD(396.3,22,23,3,0)
 ;;=RO are marked with the date/time of release; fields RELEASED BY and PRINTED 
 ;;^DD(396.3,22,23,4,0)
 ;;=BY are entered with the date of the person releasing the request; and the
 ;;^DD(396.3,22,23,5,0)
 ;;=field REQUEST STATUS is marked with a status of COMPLETED, PRINTED BY RO.
 ;;^DD(396.3,22,23,6,0)
 ;;= 
 ;;^DD(396.3,22,23,7,0)
 ;;=This means that the regional office will not be prompted to print this
 ;;^DD(396.3,22,23,8,0)
 ;;=request as a new request when they log into their report menus.  This
 ;;^DD(396.3,22,23,9,0)
 ;;=request can be reprinted, however.
 ;;^DD(396.3,22,"DT")
 ;;=2900420
 ;;^DD(396.3,23,0)
 ;;=REMARKS^396.323^^2;0
 ;;^DD(396.3,23,21,0)
 ;;=^^1^1^2940721^^^^
 ;;^DD(396.3,23,21,1,0)
 ;;=This field contains the remarks that are entered for a 2507 request.
 ;;^DD(396.3,23.3,0)
 ;;=LAST EXAM ADD DATE^D^^0;20^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,23.3,1,0)
 ;;=^.1
 ;;^DD(396.3,23.3,1,1,0)
 ;;=396.3^AD
 ;;^DD(396.3,23.3,1,1,1)
 ;;=S ^DVB(396.3,"AD",$E(X,1,30),DA)=""
 ;;^DD(396.3,23.3,1,1,2)
 ;;=K ^DVB(396.3,"AD",$E(X,1,30),DA)
 ;;^DD(396.3,23.3,3)
 ;;=The last date that an exam was added to this request.
 ;;^DD(396.3,23.3,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,23.3,21,1,0)
 ;;=This field contains the last date an exam was added to this request.
 ;;^DD(396.3,23.3,"DT")
 ;;=2901011
 ;;^DD(396.3,23.4,0)
 ;;=LAST PERSON TO ADD EXAM^P200'^VA(200,^0;21^Q
 ;;^DD(396.3,23.4,3)
 ;;=The name of the last person to add an exam to this request after logging by the regional office.
 ;;^DD(396.3,23.4,21,0)
 ;;=^^2^2^2930503^^
 ;;^DD(396.3,23.4,21,1,0)
 ;;=This field contains the name of the last person to add an exam to this
 ;;^DD(396.3,23.4,21,2,0)
 ;;=request after it was originally entered by the RO.
 ;;^DD(396.3,23.4,"DT")
 ;;=2930128
 ;;^DD(396.3,23.5,0)
 ;;=REMARKS MODIFICATION DATE^D^^0;8^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,23.5,1,0)
 ;;=^.1
 ;;^DD(396.3,23.5,1,1,0)
 ;;=396.3^AC
 ;;^DD(396.3,23.5,1,1,1)
 ;;=S ^DVB(396.3,"AC",$E(X,1,30),DA)=""
 ;;^DD(396.3,23.5,1,1,2)
 ;;=K ^DVB(396.3,"AC",$E(X,1,30),DA)
 ;;^DD(396.3,23.5,3)
 ;;=The date and time of the last REMARKS field modification.
 ;;^DD(396.3,23.5,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,23.5,21,1,0)
 ;;=This field contains the date the REMARKS field was last modified.
 ;;^DD(396.3,23.5,"DT")
 ;;=2900906
 ;;^DD(396.3,23.6,0)
 ;;=REMARKS MODIFIED BY^P200'^VA(200,^0;9^Q
 ;;^DD(396.3,23.6,3)
 ;;=The name of the person who last modified the REMARKS field.
 ;;^DD(396.3,23.6,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,23.6,21,1,0)
 ;;=This field contains the name of the employee who last modified the REMARKS
 ;;^DD(396.3,23.6,21,2,0)
 ;;=field.
 ;;^DD(396.3,23.6,"DT")
 ;;=2930128
 ;;^DD(396.3,24,0)
 ;;=ROUTING LOCATION^RP40.8'^DG(40.8,^1;4^Q
 ;;^DD(396.3,24,3)
 ;;=Enter the name or station number of the site which will be responsible for this request.
 ;;^DD(396.3,24,21,0)
 ;;=^^2^2^2930503^^
 ;;^DD(396.3,24,21,1,0)
 ;;=This field contains the station name or number of the site which will be
 ;;^DD(396.3,24,21,2,0)
 ;;=responsible for this request.
 ;;^DD(396.3,24,"DT")
 ;;=2900116
 ;;^DD(396.3,25,0)
 ;;=APPROVED BY^F^^1;5^K:$L(X)>30!($L(X)<3) X
 ;;^DD(396.3,25,3)
 ;;=Enter the name of the person who approved the exam results. [3-30 characters]
 ;;^DD(396.3,25,21,0)
 ;;=^^2^2^2950328^^
 ;;^DD(396.3,25,21,1,0)
 ;;=This field contains the name of the employee who approved the examination
 ;;^DD(396.3,25,21,2,0)
 ;;=results.

DVBAI00T
DVBAI00T ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.3,25,"DT")
 ;;=2910903
 ;;^DD(396.3,26,0)
 ;;=APPROVAL DATE/TIME^DX^^1;6^S %DT="ESTXR",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,26,3)
 ;;=Enter the date and time that the exam was approved.
 ;;^DD(396.3,26,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,26,21,1,0)
 ;;=This field contains the date/time the exam was approved.
 ;;^DD(396.3,26,"DT")
 ;;=2930601
 ;;^DD(396.3,27,0)
 ;;=*EXAM^396.327P^^3;0
 ;;^DD(396.3,27,21,0)
 ;;=^^1^1^2930503^^^
 ;;^DD(396.3,27,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.3,27,"DT")
 ;;=2930316
 ;;^DD(396.3,27.5,0)
 ;;=RETURNED TO OWNER SITE BY^F^^4;2^K:$L(X)>35!($L(X)<3) X
 ;;^DD(396.3,27.5,3)
 ;;=The free text name of the person who transferred part or all of this request.
 ;;^DD(396.3,27.5,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,27.5,21,1,0)
 ;;=This field contains the name of the employee who returned the transferred
 ;;^DD(396.3,27.5,21,2,0)
 ;;=request to the owner site.
 ;;^DD(396.3,27.5,"DT")
 ;;=2910419
 ;;^DD(396.3,28,0)
 ;;=OWNER DOMAIN^P4.2'^DIC(4.2,^0;22^Q
 ;;^DD(396.3,28,3)
 ;;=Enter the domain of the hospital which owns this request.  Transfers ONLY!!
 ;;^DD(396.3,28,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,28,21,1,0)
 ;;=For transferred-in requests, this field contains the domain of the site
 ;;^DD(396.3,28,21,2,0)
 ;;=which owns the request.
 ;;^DD(396.3,28,"DT")
 ;;=2901026
 ;;^DD(396.3,29,0)
 ;;=LAST RATING EXAM DATE^D^^1;7^S %DT="E" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,29,3)
 ;;=Enter the date of the last rating exam, if it is known.
 ;;^DD(396.3,29,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.3,29,21,1,0)
 ;;=This field contains the date of the last rating exam.
 ;;^DD(396.3,29,"DT")
 ;;=2900219
 ;;^DD(396.3,30,0)
 ;;=ORIGINAL REQUEST POINTER^NJ15,0^^1;8^K:+X'=X!(X>999999999999999)!(X<1)!(X?.E1"."1N.N) X
 ;;^DD(396.3,30,3)
 ;;=Type a Number between 1 and 999999999999999, 0 Decimal Digits.  This is the original record indicator for transfers ONLY.
 ;;^DD(396.3,30,21,0)
 ;;=^^2^2^2930503^
 ;;^DD(396.3,30,21,1,0)
 ;;=This field contains a number which is used to point to the original request
 ;;^DD(396.3,30,21,2,0)
 ;;=at the original site.
 ;;^DD(396.3,30,"DT")
 ;;=2901026
 ;;^DD(396.3,31,0)
 ;;=TRANSFERRED TO ANOTHER SITE?^S^y:YES;^4;1^Q
 ;;^DD(396.3,31,1,0)
 ;;=^.1
 ;;^DD(396.3,31,1,1,0)
 ;;=396.3^AE
 ;;^DD(396.3,31,1,1,1)
 ;;=S ^DVB(396.3,"AE",$E(X,1,30),DA)=""
 ;;^DD(396.3,31,1,1,2)
 ;;=K ^DVB(396.3,"AE",$E(X,1,30),DA)
 ;;^DD(396.3,31,1,1,"DT")
 ;;=2910426
 ;;^DD(396.3,31,3)
 ;;=System controlled.  Change only if necessary.
 ;;^DD(396.3,31,21,0)
 ;;=^^2^2^2940215^^^
 ;;^DD(396.3,31,21,1,0)
 ;;=This field is set to YES if either the entire request or individual exams
 ;;^DD(396.3,31,21,2,0)
 ;;=on it have been transferred to another site.
 ;;^DD(396.3,31,23,0)
 ;;=^^2^2^2940215^^^
 ;;^DD(396.3,31,23,1,0)
 ;;=Edited by the DVBCXFR* routines when 2507's are transferred to remote sites
 ;;^DD(396.3,31,23,2,0)
 ;;=and received back from remote sites.
 ;;^DD(396.3,31,"DT")
 ;;=2910426
 ;;^DD(396.3,32,0)
 ;;=DATE TRANSFERRED TO OTHER SITE^D^^4;3^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,32,3)
 ;;=The last date the owner site transferred an exam from this request to another site.
 ;;^DD(396.3,32,21,0)
 ;;=^^1^1^2950113^^^
 ;;^DD(396.3,32,21,1,0)
 ;;=This is the date the owner site transferred this request to another site.
 ;;^DD(396.3,32,21,2,0)
 ;;= 
 ;;^DD(396.3,32,21,3,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled
 ;;^DD(396.3,32,21,4,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.3,32,21,5,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.3,32,21,6,0)
 ;;=modifications.
 ;;^DD(396.3,32,"DT")
 ;;=2910523
 ;;^DD(396.3,33,0)
 ;;=DATE TRANSFRD IN FRM REM SITE^D^^4;4^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,33,.1)
 ;;=DATE TRANSFERRED IN FROM REMOTE SITE
 ;;^DD(396.3,33,3)
 ;;=The date this site received this request from the owner site.
 ;;^DD(396.3,33,21,0)
 ;;=^^2^2^2930503^^
 ;;^DD(396.3,33,21,1,0)
 ;;=This field contains the date this transferred in request was received
 ;;^DD(396.3,33,21,2,0)
 ;;=from the owner site.
 ;;^DD(396.3,33,21,3,0)
 ;;= 
 ;;^DD(396.3,33,21,4,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled
 ;;^DD(396.3,33,21,5,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.3,33,21,6,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.3,33,21,7,0)
 ;;=modifications.

DVBAI00U
DVBAI00U ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.3,33,"DT")
 ;;=2910523
 ;;^DD(396.3,34,0)
 ;;=DATE ALL TRANSFERS RETURNED^D^^4;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.3,34,3)
 ;;=The date that all transfers were returned to the owner site
 ;;^DD(396.3,34,21,0)
 ;;=^^3^3^2930503^^^
 ;;^DD(396.3,34,21,1,0)
 ;;=A request may be transferred to multiple sites.  This field represents the
 ;;^DD(396.3,34,21,2,0)
 ;;=date the last transfer on the request was received back at the owner site.
 ;;^DD(396.3,34,21,3,0)
 ;;=Only after this date is set will the request be counted on the AMIS 290.
 ;;^DD(396.3,34,21,4,0)
 ;;= 
 ;;^DD(396.3,34,21,5,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled
 ;;^DD(396.3,34,21,6,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.3,34,21,7,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.3,34,21,8,0)
 ;;=modifications.
 ;;^DD(396.3,34,"DT")
 ;;=2910523
 ;;^DD(396.3,44,0)
 ;;=ORIGINAL 2507 REQUEST^P396.3'^DVB(396.3,^5;1^Q
 ;;^DD(396.3,44,1,0)
 ;;=^.1
 ;;^DD(396.3,44,1,1,0)
 ;;=396.3^AORQ
 ;;^DD(396.3,44,1,1,1)
 ;;=S ^DVB(396.3,"AORQ",$E(X,1,30),DA)=""
 ;;^DD(396.3,44,1,1,2)
 ;;=K ^DVB(396.3,"AORQ",$E(X,1,30),DA)
 ;;^DD(396.3,44,1,1,"%D",0)
 ;;=^^3^3^2941115^^
 ;;^DD(396.3,44,1,1,"%D",1,0)
 ;;=The 'AORQ' cross reference will be used by the 'Purge old 2507 Requests
 ;;^DD(396.3,44,1,1,"%D",2,0)
 ;;=(Taskman)' option to prevent the deletion of a 2507 request record linked
 ;;^DD(396.3,44,1,1,"%D",3,0)
 ;;=to a 2507 request entered with a priority of 'Insufficient'.
 ;;^DD(396.3,44,1,1,"DT")
 ;;=2941115
 ;;^DD(396.3,44,3)
 ;;=Select the original 2507 request this request is being entered for.
 ;;^DD(396.3,44,21,0)
 ;;=^^2^2^2941115^^
 ;;^DD(396.3,44,21,1,0)
 ;;=This field is a pointer to the insufficient request this 2507 was entered
 ;;^DD(396.3,44,21,2,0)
 ;;=for.
 ;;^DD(396.3,44,23,0)
 ;;=^^1^1^2941115^^
 ;;^DD(396.3,44,23,1,0)
 ;;=This field is a pointer to the 2507 Request file (396.3).
 ;;^DD(396.3,44,"DT")
 ;;=2941115
 ;;^DD(396.3,45,0)
 ;;=ORIGINAL 2507 PROCESSING TIME^NJ6,0^^5;2^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1N.N) X
 ;;^DD(396.3,45,3)
 ;;=Enter the number of days the original request took to complete processing.
 ;;^DD(396.3,45,21,0)
 ;;=^^2^2^2941116^^^
 ;;^DD(396.3,45,21,1,0)
 ;;=This field contains the processing time of the original request the
 ;;^DD(396.3,45,21,2,0)
 ;;=insufficient request was entered for.
 ;;^DD(396.3,45,23,0)
 ;;=^^2^2^2941116^^^
 ;;^DD(396.3,45,23,1,0)
 ;;=This field is entered by the Regional Office if the Original Request has
 ;;^DD(396.3,45,23,2,0)
 ;;=been purged from the system.
 ;;^DD(396.3,45,"DT")
 ;;=2941116
 ;;^DD(396.323,0)
 ;;=REMARKS SUB-FIELD^^.01^1
 ;;^DD(396.323,0,"NM","REMARKS")
 ;;=
 ;;^DD(396.323,0,"UP")
 ;;=396.3
 ;;^DD(396.323,.01,0)
 ;;=REMARKS^W^^0;1^Q
 ;;^DD(396.323,.01,3)
 ;;=Enter any pertinent remarks about the Veteran.
 ;;^DD(396.323,.01,"DT")
 ;;=2900110
 ;;^DD(396.327,0)
 ;;=*EXAM SUB-FIELD^^11^16
 ;;^DD(396.327,0,"DT")
 ;;=2930128
 ;;^DD(396.327,0,"IX","B",396.327,.01)
 ;;=
 ;;^DD(396.327,0,"NM","*EXAM")
 ;;=
 ;;^DD(396.327,0,"UP")
 ;;=396.3
 ;;^DD(396.327,.01,0)
 ;;=*EXAM^MP396.6'^DVB(396.6,^0;1^Q
 ;;^DD(396.327,.01,1,0)
 ;;=^.1
 ;;^DD(396.327,.01,1,1,0)
 ;;=396.327^B
 ;;^DD(396.327,.01,1,1,1)
 ;;=S ^DVB(396.3,DA(1),3,"B",$E(X,1,30),DA)=""
 ;;^DD(396.327,.01,1,1,2)
 ;;=K ^DVB(396.3,DA(1),3,"B",$E(X,1,30),DA)
 ;;^DD(396.327,.01,3)
 ;;=Enter the name of the exam you wish to select for the Veteran.
 ;;^DD(396.327,.01,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,.01,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,.01,"DT")
 ;;=2930316
 ;;^DD(396.327,.5,0)
 ;;=*WORKSHEET PRINTED?^S^Y:YES;N:NO;^0;10^Q
 ;;^DD(396.327,.5,1,0)
 ;;=^.1^^0
 ;;^DD(396.327,.5,3)
 ;;=System maintained.  Designates whether worksheet has been printed.
 ;;^DD(396.327,.5,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,.5,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,.5,"DT")
 ;;=2930316
 ;;^DD(396.327,1,0)
 ;;=*STATUS^S^O:OPEN;C:COMPLETED;X:CANCELLED BY MAS;RX:CANCELLED BY RO;T:TRANSFERRED OUT;^0;2^Q
 ;;^DD(396.327,1,3)
 ;;=The status of the individual exam.
 ;;^DD(396.327,1,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,1,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,1,"DT")
 ;;=2930316
 ;;^DD(396.327,2,0)
 ;;=*CANCELLATION REASON^P396.5'^DVB(396.5,^0;3^Q
 ;;^DD(396.327,2,3)
 ;;=Enter the reason which best describes the cancellation.
 ;;^DD(396.327,2,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,2,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.

DVBAI00V
DVBAI00V ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.3)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.327,2,"DT")
 ;;=2930316
 ;;^DD(396.327,2.3,0)
 ;;=*EXAM CANCELLED BY^P200'^VA(200,^0;6^Q
 ;;^DD(396.327,2.3,3)
 ;;=The name of the person who cancelled the INDIVIDUAL exam.
 ;;^DD(396.327,2.3,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,2.3,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,2.3,"DT")
 ;;=2930316
 ;;^DD(396.327,2.5,0)
 ;;=*EXAM CANCELLATION DATE/TIME^D^^0;7^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.327,2.5,3)
 ;;=Date and time the INDIVIDUAL exam was cancelled.
 ;;^DD(396.327,2.5,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,2.5,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,2.5,"DT")
 ;;=2930316
 ;;^DD(396.327,3,0)
 ;;=*DATE OF EXAM^D^^0;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.327,3,3)
 ;;=The date the exam was performed.
 ;;^DD(396.327,3,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,3,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,3,"DT")
 ;;=2930316
 ;;^DD(396.327,4,0)
 ;;=*EXAMINING PHYSICIAN^F^^0;5^K:$L(X)>30!($L(X)<3) X
 ;;^DD(396.327,4,3)
 ;;=Enter the name of the physician which performed the examination.
 ;;^DD(396.327,4,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,4,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,4,"DT")
 ;;=2930316
 ;;^DD(396.327,5,0)
 ;;=*IS THIS A FEE EXAM?^RS^Y:YES;N:NO;^0;8^Q
 ;;^DD(396.327,5,3)
 ;;=Enter Y if this will be a fee exam or N if not.
 ;;^DD(396.327,5,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,5,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,5,"DT")
 ;;=2930316
 ;;^DD(396.327,6,0)
 ;;=*EXAM PLACE^S^C:CLINIC;F:FEE LOCATION;O:OTHER STATION;^0;9^Q
 ;;^DD(396.327,6,3)
 ;;=Enter the code which best describes where this exam will take place.
 ;;^DD(396.327,6,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,6,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,6,"DT")
 ;;=2930316
 ;;^DD(396.327,7,0)
 ;;=*RESULTS^396.3277^^1;0
 ;;^DD(396.327,7,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,7,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,7,"DT")
 ;;=2930316
 ;;^DD(396.327,8,0)
 ;;=*TRANSFERRED OUT TO^P4.2'^DIC(4.2,^0;11^Q
 ;;^DD(396.327,8,3)
 ;;=Enter the domain to which this exam was transferred.
 ;;^DD(396.327,8,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,8,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,8,"DT")
 ;;=2930316
 ;;^DD(396.327,8.5,0)
 ;;=*TRANSFERRED OUT BY^F^^0;15^K:$L(X)>35!($L(X)<3) X
 ;;^DD(396.327,8.5,3)
 ;;=The free-text name of the person who originally transferred out this exam. [3-35 characters]
 ;;^DD(396.327,8.5,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,8.5,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,8.5,"DT")
 ;;=2930316
 ;;^DD(396.327,9,0)
 ;;=*DATE TRANSFERRED OUT^D^^0;12^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.327,9,3)
 ;;=The date this exam was transferred out to a remote site.
 ;;^DD(396.327,9,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,9,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,9,"DT")
 ;;=2930316
 ;;^DD(396.327,10,0)
 ;;=*DATE TRANSFERRED IN^D^^0;13^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.327,10,3)
 ;;=The date this exam was transferred to this site from another site.
 ;;^DD(396.327,10,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,10,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,10,"DT")
 ;;=2930316
 ;;^DD(396.327,11,0)
 ;;=*DATE RETURNED TO OWNER SITE^D^^0;14^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.327,11,3)
 ;;=The date this exam and its results were returned to the owner site.
 ;;^DD(396.327,11,21,0)
 ;;=^^1^1^2930503^
 ;;^DD(396.327,11,21,1,0)
 ;;=Data moved to File #396.4; field starred for deletion.
 ;;^DD(396.327,11,"DT")
 ;;=2930316
 ;;^DD(396.3277,0)
 ;;=*RESULTS SUB-FIELD^^.01^1
 ;;^DD(396.3277,0,"NM","*RESULTS")
 ;;=
 ;;^DD(396.3277,0,"UP")
 ;;=396.327
 ;;^DD(396.3277,.01,0)
 ;;=RESULTS^W^^0;1^Q
 ;;^DD(396.3277,.01,"DT")
 ;;=2900727

DVBAI00W
DVBAI00W ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.4,0,"GL")
 ;;=^DVB(396.4,
 ;;^DIC("B","2507 EXAM",396.4)
 ;;=
 ;;^DIC(396.4,"%D",0)
 ;;=^^7^7^2950103^^^^
 ;;^DIC(396.4,"%D",1,0)
 ;;=This file contains all the exams that are associated with the various 2507
 ;;^DIC(396.4,"%D",2,0)
 ;;=requests.  
 ;;^DIC(396.4,"%D",3,0)
 ;;= 
 ;;^DIC(396.4,"%D",4,0)
 ;;= NOTICE: This file is part of an implementation of a Nationally
 ;;^DIC(396.4,"%D",5,0)
 ;;=         Controlled Procedure.  Local modifications to this file
 ;;^DIC(396.4,"%D",6,0)
 ;;=         are prohibited per VHA Directive 10-93-142.
 ;;^DIC(396.4,"%D",7,0)
 ;;= 
 ;;^DD(396.4,0)
 ;;=FIELD^^80^22
 ;;^DD(396.4,0,"DDA")
 ;;=N
 ;;^DD(396.4,0,"DT")
 ;;=2950210
 ;;^DD(396.4,0,"ID",.03)
 ;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^DVB(396.6,+$P(^(0),U,3),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(396.6,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
 ;;^DD(396.4,0,"IX","AC",396.4,.03)
 ;;=
 ;;^DD(396.4,0,"IX","AD",396.4,.04)
 ;;=
 ;;^DD(396.4,0,"IX","AE",396.4,.03)
 ;;=
 ;;^DD(396.4,0,"IX","AF",396.4,.02)
 ;;=
 ;;^DD(396.4,0,"IX","AIT",396.4,.11)
 ;;=
 ;;^DD(396.4,0,"IX","AIT2",396.4,.03)
 ;;=
 ;;^DD(396.4,0,"IX","APE",396.4,.02)
 ;;=
 ;;^DD(396.4,0,"IX","APS",396.4,.02)
 ;;=
 ;;^DD(396.4,0,"IX","ARQ",396.4,.03)
 ;;=
 ;;^DD(396.4,0,"IX","B",396.4,.01)
 ;;=
 ;;^DD(396.4,0,"IX","C",396.4,.02)
 ;;=
 ;;^DD(396.4,0,"IX","F",396.4,.03)
 ;;=
 ;;^DD(396.4,0,"NM","2507 EXAM")
 ;;=
 ;;^DD(396.4,.01,0)
 ;;=EXAM REFERENCE NUMBER^RNJ12,0I^^0;1^K:+X'=X!(X>999999999999)!(X<1)!(X?.E1"."1N.N) X
 ;;^DD(396.4,.01,1,0)
 ;;=^.1
 ;;^DD(396.4,.01,1,1,0)
 ;;=396.4^B
 ;;^DD(396.4,.01,1,1,1)
 ;;=S ^DVB(396.4,"B",$E(X,1,30),DA)=""
 ;;^DD(396.4,.01,1,1,2)
 ;;=K ^DVB(396.4,"B",$E(X,1,30),DA)
 ;;^DD(396.4,.01,3)
 ;;=Type a Number between 1 and 999999999999, 0 Decimal Digits
 ;;^DD(396.4,.01,4)
 ;;=
 ;;^DD(396.4,.01,21,0)
 ;;=^^2^2^2941017^^^^
 ;;^DD(396.4,.01,21,1,0)
 ;;=This field contains an entry number of the exam in the 2507 Exam file.
 ;;^DD(396.4,.01,21,2,0)
 ;;=It is not related to an Exam number or a worksheet number.
 ;;^DD(396.4,.01,23,0)
 ;;=^^2^2^2941017^^^^
 ;;^DD(396.4,.01,23,1,0)
 ;;=This field is generated from the LAST EXAM NUMBER field in the AMIE site
 ;;^DD(396.4,.01,23,2,0)
 ;;=parameter file.
 ;;^DD(396.4,.01,"DT")
 ;;=2941220
 ;;^DD(396.4,.02,0)
 ;;=2507 REQUEST^RP396.3'I^DVB(396.3,^0;2^Q
 ;;^DD(396.4,.02,1,0)
 ;;=^.1^^-1
 ;;^DD(396.4,.02,1,1,0)
 ;;=396.4^C
 ;;^DD(396.4,.02,1,1,1)
 ;;=S ^DVB(396.4,"C",$E(X,1,30),DA)=""
 ;;^DD(396.4,.02,1,1,2)
 ;;=K ^DVB(396.4,"C",$E(X,1,30),DA)
 ;;^DD(396.4,.02,1,1,"%D",0)
 ;;=^^1^1^2940304^
 ;;^DD(396.4,.02,1,1,"%D",1,0)
 ;;=This is a standard FM cross reference for this field.
 ;;^DD(396.4,.02,1,1,"DT")
 ;;=2930218
 ;;^DD(396.4,.02,1,2,0)
 ;;=396.4^APS^MUMPS
 ;;^DD(396.4,.02,1,2,1)
 ;;=N A S A=^DVB(396.4,DA,0) I $P(A,U,3)]"",$P(A,U,4)]"" S ^DVB(396.4,"APS",$P(^DVB(396.3,$E(X,1,30),0),U,1),$P(A,U,3),$P(A,U,4),DA)=""
 ;;^DD(396.4,.02,1,2,2)
 ;;=N A S A=^DVB(396.4,DA,0) I $P(A,U,3)]"",$P(A,U,4)]"" K ^DVB(396.4,"APS",$P(^DVB(396.3,$E(X,1,30),0),U,1),$P(A,U,3),$P(A,U,4),DA)
 ;;^DD(396.4,.02,1,2,"%D",0)
 ;;=^^3^3^2930510^^
 ;;^DD(396.4,.02,1,2,"%D",1,0)
 ;;=This cross reference contains the patient's internal file number, the exam
 ;;^DD(396.4,.02,1,2,"%D",2,0)
 ;;=IFN and the exam status.  It is set on two other fields .03 and .04.  
 ;;^DD(396.4,.02,1,2,"%D",3,0)
 ;;=Recross referencing any one of these fields will be acceptable.
 ;;^DD(396.4,.02,1,2,"DT")
 ;;=2930422
 ;;^DD(396.4,.02,1,3,0)
 ;;=396.4^APE^MUMPS
 ;;^DD(396.4,.02,1,3,1)
 ;;=N A,B S A=^DVB(396.3,$E(X,1,30),0) I $P(A,U,1)]"",$P(A,U,2)]"" S B=^DVB(396.4,DA,0) I $P(B,U,3)]"" S ^DVB(396.4,"APE",$P(A,U,1),$P(^DVB(396.6,$P(B,U,3),0),U,1),$P(A,U,2),DA)=""
 ;;^DD(396.4,.02,1,3,2)
 ;;=N A,B S A=^DVB(396.3,$E(X,1,30),0) I $P(A,U,1)]"",$P(A,U,2)]"" S B=^DVB(396.4,DA,0) I $P(B,U,3)]"" K ^DVB(396.4,"APE",$P(A,U,1),$P(^DVB(396.6,$P(B,U,3),0),U,1),$P(A,U,2),DA)
 ;;^DD(396.4,.02,1,3,"%D",0)
 ;;=^^3^3^2930510^
 ;;^DD(396.4,.02,1,3,"%D",1,0)
 ;;=This cross reference contains the patient's IFN, the exam name, and the
 ;;^DD(396.4,.02,1,3,"%D",2,0)
 ;;=request date.  It is set on one other field .03.  Recross referencing either
 ;;^DD(396.4,.02,1,3,"%D",3,0)
 ;;=one of these fields would be acceptable.
 ;;^DD(396.4,.02,1,3,"DT")
 ;;=2930422
 ;;^DD(396.4,.02,1,4,0)
 ;;=396.4^AF^MUMPS
 ;;^DD(396.4,.02,1,4,1)
 ;;=N A S A=$P(^DVB(396.4,DA,0),U,3) I A]"" S ^DVB(396.4,"ARQ"_X,A,DA)=""
 ;;^DD(396.4,.02,1,4,2)
 ;;=N A S A=$P(^DVB(396.4,DA,0),U,3) I A]"" K ^DVB(396.4,"ARQ"_X,A,DA)
 ;;^DD(396.4,.02,1,4,"%D",0)
 ;;=^^2^2^2940304^^

DVBAI00X
DVBAI00X ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.4,.02,1,4,"%D",1,0)
 ;;=This cross reference is used to quickly find the correct exams that are
 ;;^DD(396.4,.02,1,4,"%D",2,0)
 ;;=related to a specific request.
 ;;^DD(396.4,.02,1,4,"DT")
 ;;=2930902
 ;;^DD(396.4,.02,3)
 ;;=Enter the request that this exam belongs to.  You will select the veteran then which request.
 ;;^DD(396.4,.02,21,0)
 ;;=^^2^2^2940721^^
 ;;^DD(396.4,.02,21,1,0)
 ;;=This field connects the given record with the 2507 request record that
 ;;^DD(396.4,.02,21,2,0)
 ;;=the exam is on.
 ;;^DD(396.4,.02,23,0)
 ;;=^^1^1^2940721^^
 ;;^DD(396.4,.02,23,1,0)
 ;;=A pointer to the 2507 Request file (396.3).
 ;;^DD(396.4,.02,"DT")
 ;;=2941118
 ;;^DD(396.4,.03,0)
 ;;=EXAM TYPE^RP396.6'I^DVB(396.6,^0;3^Q
 ;;^DD(396.4,.03,1,0)
 ;;=^.1
 ;;^DD(396.4,.03,1,1,0)
 ;;=396.4^ARQ^MUMPS
 ;;^DD(396.4,.03,1,1,1)
 ;;=N A S A=$P(^DVB(396.4,DA,0),U,2) I A]"" S ^DVB(396.4,"ARQ"_A,$E(X,1,30),DA)=""
 ;;^DD(396.4,.03,1,1,2)
 ;;=N A S A=$P(^DVB(396.4,DA,0),U,2) I A]"" K ^DVB(396.4,"ARQ"_A,$E(X,1,30),DA)
 ;;^DD(396.4,.03,1,1,"%D",0)
 ;;=^^1^1^2930902^
 ;;^DD(396.4,.03,1,1,"%D",1,0)
 ;;=This cross reference is to aid in the look up on the 2507 exam file 396.4
 ;;^DD(396.4,.03,1,1,"DT")
 ;;=2930902
 ;;^DD(396.4,.03,1,2,0)
 ;;=396.4^AC^MUMPS
 ;;^DD(396.4,.03,1,2,1)
 ;;=N A S A=^DVB(396.4,DA,0) I $P(A,U,2)]"",$P(A,U,4)]"" S ^DVB(396.4,"APS",$P(^DVB(396.3,$P(A,U,2),0),U,1),$E(X,1,30),$P(A,U,4),DA)=""
 ;;^DD(396.4,.03,1,2,2)
 ;;=N A S A=^DVB(396.4,DA,0) I $P(A,U,2)]"",$P(A,U,4)]"" K ^DVB(396.4,"APS",$P(^DVB(396.3,$P(A,U,2),0),U,1),$E(X,1,30),$P(A,U,4),DA)
 ;;^DD(396.4,.03,1,2,"%D",0)
 ;;=^^3^3^2930510^^^^
 ;;^DD(396.4,.03,1,2,"%D",1,0)
 ;;=This cross reference contains the patient's internal file number, the exam 
 ;;^DD(396.4,.03,1,2,"%D",2,0)
 ;;=IFN and the exam status.  It is set on two other fields .02 and .04.   
 ;;^DD(396.4,.03,1,2,"%D",3,0)
 ;;=Recross referencing any one of these fields will be acceptable.
 ;;^DD(396.4,.03,1,2,"DT")
 ;;=2930422
 ;;^DD(396.4,.03,1,3,0)
 ;;=396.4^AE^MUMPS
 ;;^DD(396.4,.03,1,3,1)
 ;;=N A S A=$P(^DVB(396.4,DA,0),U,2) I A]"" S A=^DVB(396.3,A,0) I $P(A,U,1)]"",$P(A,U,2)]"" S ^DVB(396.4,"APE",$P(A,U,1),$P(^DVB(396.6,$E(X,1,30),0),U,1),$P(A,U,2),DA)=""
 ;;^DD(396.4,.03,1,3,2)
 ;;=N A S A=$P(^DVB(396.4,DA,0),U,2) I A]"" S A=^DVB(396.3,A,0) I $P(A,U,1)]"",$P(A,U,2)]"" K ^DVB(396.4,"APE",$P(A,U,1),$P(^DVB(396.6,$E(X,1,30),0),U,1),$P(A,U,2),DA)
 ;;^DD(396.4,.03,1,3,"%D",0)
 ;;=^^3^3^2930510^
 ;;^DD(396.4,.03,1,3,"%D",1,0)
 ;;=This cross reference contains the patient's IFN, the exam name, and the
 ;;^DD(396.4,.03,1,3,"%D",2,0)
 ;;=request date.  It is set on one other field .03.  Recross referencing either
 ;;^DD(396.4,.03,1,3,"%D",3,0)
 ;;=one of these fields would be acceptable.
 ;;^DD(396.4,.03,1,3,"DT")
 ;;=2930422
 ;;^DD(396.4,.03,1,4,0)
 ;;=396.4^F
 ;;^DD(396.4,.03,1,4,1)
 ;;=S ^DVB(396.4,"F",$E(X,1,30),DA)=""
 ;;^DD(396.4,.03,1,4,2)
 ;;=K ^DVB(396.4,"F",$E(X,1,30),DA)
 ;;^DD(396.4,.03,1,4,"DT")
 ;;=2930218
 ;;^DD(396.4,.03,1,5,0)
 ;;=396.4^AIT2^MUMPS
 ;;^DD(396.4,.03,1,5,1)
 ;;=S:+$P(^DVB(396.4,DA,0),U,11)>0 ^DVB(396.4,"AIT",$P(^(0),U,11),$E(X,1,30),DA)=""
 ;;^DD(396.4,.03,1,5,2)
 ;;=I +$P(^DVB(396.4,DA,0),U,11)>0 K ^DVB(396.4,"AIT",$P(^(0),U,11),$E(X,1,30),DA)
 ;;^DD(396.4,.03,1,5,"%D",0)
 ;;=^^2^2^2941116^^^
 ;;^DD(396.4,.03,1,5,"%D",1,0)
 ;;=This cross reference is on the Insufficient Reason and Exam Type fields.
 ;;^DD(396.4,.03,1,5,"%D",2,0)
 ;;=It is used by the the Detailed Insufficient Exam Report.
 ;;^DD(396.4,.03,1,5,"DT")
 ;;=2941116
 ;;^DD(396.4,.03,3)
 ;;=Enter the name of the exam for this request.
 ;;^DD(396.4,.03,4)
 ;;=
 ;;^DD(396.4,.03,21,0)
 ;;=^^1^1^2940722^^
 ;;^DD(396.4,.03,21,1,0)
 ;;=Contains the name of the exam.
 ;;^DD(396.4,.03,23,0)
 ;;=^^1^1^2940722^^
 ;;^DD(396.4,.03,23,1,0)
 ;;=This field is a pointer to the 2507 Exam File (396.6).
 ;;^DD(396.4,.03,"DT")
 ;;=2941118
 ;;^DD(396.4,.04,0)
 ;;=STATUS^S^O:OPEN;C:COMPLETED;X:CANCELED BY MAS;RX:CANCELED BY RO;T:TRANSFERRED OUT;^0;4^Q
 ;;^DD(396.4,.04,1,0)
 ;;=^.1^^-1
 ;;^DD(396.4,.04,1,1,0)
 ;;=396.4^AD^MUMPS
 ;;^DD(396.4,.04,1,1,1)
 ;;=N A S A=^DVB(396.4,DA,0) I $P(A,U,2)]"",$P(A,U,3)]"" S ^DVB(396.4,"APS",$P(^DVB(396.3,$P(A,U,2),0),U,1),$P(A,U,3),$E(X,1,30),DA)=""
 ;;^DD(396.4,.04,1,1,2)
 ;;=N A S A=^DVB(396.4,DA,0) I $P(A,U,2)]"",$P(A,U,3)]"" K ^DVB(396.4,"APS",$P(^DVB(396.3,$P(A,U,2),0),U,1),$P(A,U,3),$E(X,1,30),DA)
 ;;^DD(396.4,.04,1,1,"%D",0)
 ;;=^^3^3^2930510^^^^
 ;;^DD(396.4,.04,1,1,"%D",1,0)
 ;;=This cross reference contains the patient's internal file number, the exam 

DVBAI00Y
DVBAI00Y ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.4,.04,1,1,"%D",2,0)
 ;;=IFN and the exam status.  It is set on two other fields .02 and .03.   
 ;;^DD(396.4,.04,1,1,"%D",3,0)
 ;;=Recross referencing any one of these fields will be acceptable.
 ;;^DD(396.4,.04,1,1,"DT")
 ;;=2930422
 ;;^DD(396.4,.04,3)
 ;;=This is the status of the exam in AMIE.
 ;;^DD(396.4,.04,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.4,.04,21,1,0)
 ;;=The value of the status of the exam record.  (Open, Closed, Transferred or
 ;;^DD(396.4,.04,21,2,0)
 ;;=Cancelled)
 ;;^DD(396.4,.04,21,3,0)
 ;;= 
 ;;^DD(396.4,.04,21,4,0)
 ;;=This field is used as part of the implementation of a Nationally Controlled
 ;;^DD(396.4,.04,21,5,0)
 ;;=Procedure (AMIS 290).  Per VHA Directive 10-93-142, the information 
 ;;^DD(396.4,.04,21,6,0)
 ;;=contained in this field is not to be changed as the results of local (site) 
 ;;^DD(396.4,.04,21,7,0)
 ;;=modifications.
 ;;^DD(396.4,.04,23,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.4,.04,23,1,0)
 ;;=This field is a set of codes.  It controls what AMIE functions can be 
 ;;^DD(396.4,.04,23,2,0)
 ;;=performed on the exam record.
 ;;^DD(396.4,.04,"DT")
 ;;=2941018
 ;;^DD(396.4,.05,0)
 ;;=WORK SHEET PRINTED^S^Y:YES;N:NO;^0;5^Q
 ;;^DD(396.4,.05,3)
 ;;=Indicates whether a worksheet has been printed or not.
 ;;^DD(396.4,.05,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.4,.05,21,1,0)
 ;;=Indicates if the user has printed the worksheet when a request was logged
 ;;^DD(396.4,.05,21,2,0)
 ;;=or an exam was added to a request.
 ;;^DD(396.4,.05,"DT")
 ;;=2930128
 ;;^DD(396.4,.06,0)
 ;;=DATE OF EXAM^DX^^0;6^S %DT="EST",%DT(0)="-NOW" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.4,.06,3)
 ;;=This is the date this exam was performed.
 ;;^DD(396.4,.06,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396.4,.06,21,1,0)
 ;;=The date the exam was performed.
 ;;^DD(396.4,.06,23,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396.4,.06,23,1,0)
 ;;=Entered with the transcription routine ^DVBCEDIT.
 ;;^DD(396.4,.06,"DT")
 ;;=2930430
 ;;^DD(396.4,.07,0)
 ;;=EXAMINING PHYSICIAN^F^^0;7^K:$L(X)>30!($L(X)<1) X
 ;;^DD(396.4,.07,3)
 ;;=Enter the name of the physician who performed this exam.
 ;;^DD(396.4,.07,21,0)
 ;;=^^1^1^2940721^^
 ;;^DD(396.4,.07,21,1,0)
 ;;=The name of the Doctor that performed the examination.
 ;;^DD(396.4,.07,"DT")
 ;;=2930301
 ;;^DD(396.4,.08,0)
 ;;=FEE EXAM^RS^Y:YES;N:NO;^0;8^Q
 ;;^DD(396.4,.08,3)
 ;;=Enter 'Y' if this is to be a FEE exam.
 ;;^DD(396.4,.08,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.4,.08,21,1,0)
 ;;=Indicates if the exam was performed on a Fee basis.
 ;;^DD(396.4,.08,"DT")
 ;;=2930128
 ;;^DD(396.4,.09,0)
 ;;=EXAM PLACE^S^C:CLINIC;F:FEE LOCATION;O:OTHER STATION;^0;9^Q
 ;;^DD(396.4,.09,3)
 ;;=Enter the code where this exam took place.  Select the code that best fits the situation.
 ;;^DD(396.4,.09,21,0)
 ;;=^^1^1^2950126^^
 ;;^DD(396.4,.09,21,1,0)
 ;;=Indicates where the exam was performed.
 ;;^DD(396.4,.09,"DT")
 ;;=2930128
 ;;^DD(396.4,.1,0)
 ;;=DOCTOR'S ELECTRONIC SIGNATURE^FOI^^0;10^K:$L(X)>30!($L(X)<1) X
 ;;^DD(396.4,.1,2)
 ;;=S Y(0)=Y S Y="  <Hidden>"
 ;;^DD(396.4,.1,2.1)
 ;;=S Y="  <Hidden>"
 ;;^DD(396.4,.1,3)
 ;;=This is the Doctor's electronic signature tied to this exam.
 ;;^DD(396.4,.1,21,0)
 ;;=^^2^2^2950126^^
 ;;^DD(396.4,.1,21,1,0)
 ;;=The doctor's electronic signature.  This is for use with the Kurzweil
 ;;^DD(396.4,.1,21,2,0)
 ;;=system.
 ;;^DD(396.4,.1,"DT")
 ;;=2930201
 ;;^DD(396.4,.11,0)
 ;;=INSUFFICIENT REASON^P396.94'^DVB(396.94,^0;11^Q
 ;;^DD(396.4,.11,1,0)
 ;;=^.1
 ;;^DD(396.4,.11,1,1,0)
 ;;=396.4^AIT^MUMPS
 ;;^DD(396.4,.11,1,1,1)
 ;;=S:+$P(^DVB(396.4,DA,0),U,3)>0 ^DVB(396.4,"AIT",$E(X,1,30),$P(^(0),U,3),DA)=""
 ;;^DD(396.4,.11,1,1,2)
 ;;=I +$P(^DVB(396.4,DA,0),U,3)>0 K ^DVB(396.4,"AIT",$E(X,1,30),$P(^(0),U,3),DA)
 ;;^DD(396.4,.11,1,1,"%D",0)
 ;;=^^2^2^2941116^^^^
 ;;^DD(396.4,.11,1,1,"%D",1,0)
 ;;=This cross reference is on the Insufficient Reason and Exam Type fields.
 ;;^DD(396.4,.11,1,1,"%D",2,0)
 ;;=It is used by the Detailed Insufficient Exam Report.
 ;;^DD(396.4,.11,1,1,"DT")
 ;;=2941116
 ;;^DD(396.4,.11,3)
 ;;=Enter the insufficient reason this exam is being returned.
 ;;^DD(396.4,.11,4)
 ;;=
 ;;^DD(396.4,.11,21,0)
 ;;=^^1^1^2950210^^^^
 ;;^DD(396.4,.11,21,1,0)
 ;;=This field contains a pointer to the Insufficient Reason file (396.94).
 ;;^DD(396.4,.11,23,0)
 ;;=^^3^3^2950210^^^^
 ;;^DD(396.4,.11,23,1,0)
 ;;=This field is a pointer to the Insufficient Reason File.  It is entered 
 ;;^DD(396.4,.11,23,2,0)
 ;;=when the user adds an exam to a 2507 request that has a priority of
 ;;^DD(396.4,.11,23,3,0)
 ;;='Insufficient'.
 ;;^DD(396.4,.11,"DT")
 ;;=2950210
 ;;^DD(396.4,.12,0)
 ;;=ORIGINAL PROVIDER^F^^0;12^K:$L(X)>30!($L(X)<1) X

DVBAI00Z
DVBAI00Z ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.4,.12,3)
 ;;=Enter the name of the provider who performed the original exam.
 ;;^DD(396.4,.12,21,0)
 ;;=^^3^3^2941221^^
 ;;^DD(396.4,.12,21,1,0)
 ;;=This field contains the name of the provider who performed the original
 ;;^DD(396.4,.12,21,2,0)
 ;;=exam.  If the exam was transferred from another Medical Center, the name
 ;;^DD(396.4,.12,21,3,0)
 ;;=of that site should be included in this field.
 ;;^DD(396.4,.12,23,0)
 ;;=^^3^3^2941221^^
 ;;^DD(396.4,.12,23,1,0)
 ;;=This field is populated by AMIE software when the original 2507 request
 ;;^DD(396.4,.12,23,2,0)
 ;;=has not been purged.  If the original 2507 record has been purged, the user
 ;;^DD(396.4,.12,23,3,0)
 ;;=enters this information.
 ;;^DD(396.4,.12,"DT")
 ;;=2941221
 ;;^DD(396.4,50,0)
 ;;=CANCELLATION DATE/TIME^D^^CAN;1^S %DT="EST" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.4,50,3)
 ;;=Date and Time the INDIVIDUAL exam was canceled.
 ;;^DD(396.4,50,21,0)
 ;;=^^1^1^2930521^^
 ;;^DD(396.4,50,21,1,0)
 ;;=Indicates when the exam was cancelled.
 ;;^DD(396.4,50,23,0)
 ;;=^^1^1^2930521^^
 ;;^DD(396.4,50,23,1,0)
 ;;=Updated only when the exam is cancelled.
 ;;^DD(396.4,50,"DT")
 ;;=2930521
 ;;^DD(396.4,51,0)
 ;;=CANCELED BY^P200'^VA(200,^CAN;2^Q
 ;;^DD(396.4,51,3)
 ;;=This field holds the name of the person who canceled the individual exam.
 ;;^DD(396.4,51,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.4,51,21,1,0)
 ;;=Indicates who cancelled the exam.
 ;;^DD(396.4,51,23,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.4,51,23,1,0)
 ;;=Contains the DUZ of the person who cancelled the exam.  (Pointer)
 ;;^DD(396.4,51,"DT")
 ;;=2930128
 ;;^DD(396.4,52,0)
 ;;=CANCELLATION REASON^P396.5'^DVB(396.5,^CAN;3^Q
 ;;^DD(396.4,52,3)
 ;;=Enter the response which best describes the reason for the cancellation.
 ;;^DD(396.4,52,21,0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396.4,52,21,1,0)
 ;;=Contains the reason for cancellation from the 2507 CANCELLATION REASON file
 ;;^DD(396.4,52,21,2,0)
 ;;=(396.5).
 ;;^DD(396.4,52,23,0)
 ;;=^^1^1^2950126^^^
 ;;^DD(396.4,52,23,1,0)
 ;;=Pointer to file 396.5.
 ;;^DD(396.4,52,"DT")
 ;;=2930521
 ;;^DD(396.4,60,0)
 ;;=DATE TRANSFERRED OUT^D^^TRAN;1^S %DT="EST" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.4,60,3)
 ;;=Enter the date this exam was transferred to the remote site.
 ;;^DD(396.4,60,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.4,60,21,1,0)
 ;;=Indicates the date an exam was transferred to another VAMC.
 ;;^DD(396.4,60,"DT")
 ;;=2930128
 ;;^DD(396.4,61,0)
 ;;=TRANSFERRED OUT BY^F^^TRAN;2^K:$L(X)>30!($L(X)<1) X
 ;;^DD(396.4,61,3)
 ;;=Answer must be 1-30 characters in length.  Enter the name of the person who transferred out this exam.
 ;;^DD(396.4,61,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.4,61,21,1,0)
 ;;=A Free Text field which contains the name of the user that transferred an
 ;;^DD(396.4,61,21,2,0)
 ;;=exam to another VAMC.
 ;;^DD(396.4,61,"DT")
 ;;=2930128
 ;;^DD(396.4,62,0)
 ;;=TRANSFERRED OUT TO^P4.2'^DIC(4.2,^TRAN;3^Q
 ;;^DD(396.4,62,3)
 ;;=Enter the domain this exam was transferred to.
 ;;^DD(396.4,62,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.4,62,21,1,0)
 ;;=Contains the name of the institution that an exam was transferred out to.
 ;;^DD(396.4,62,23,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.4,62,23,1,0)
 ;;=A pointer to the Domain File.
 ;;^DD(396.4,62,"DT")
 ;;=2930128
 ;;^DD(396.4,63,0)
 ;;=DATE TRANSFERRED IN^D^^TRAN;4^S %DT="EST" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.4,63,3)
 ;;=Enter the date this exam was transferred to this site.
 ;;^DD(396.4,63,21,0)
 ;;=^^1^1^2950126^^
 ;;^DD(396.4,63,21,1,0)
 ;;=Contains the date an exam was received at a remote site.
 ;;^DD(396.4,63,"DT")
 ;;=2930128
 ;;^DD(396.4,64,0)
 ;;=DATE RETURNED TO OWNER SITE^D^^TRAN;5^S %DT="EST" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.4,64,3)
 ;;=Enter the date this exam and its results were returned to the originating site.
 ;;^DD(396.4,64,21,0)
 ;;=^^4^4^2930430^
 ;;^DD(396.4,64,21,1,0)
 ;;=Used by a remote site when an exam is transferred to that site for 
 ;;^DD(396.4,64,21,2,0)
 ;;=completion.  Upon completion and release of a transferred exam, this
 ;;^DD(396.4,64,21,3,0)
 ;;=field records at the remote site the date the exam was released to the
 ;;^DD(396.4,64,21,4,0)
 ;;=originating site.
 ;;^DD(396.4,64,"DT")
 ;;=2930128
 ;;^DD(396.4,70,0)
 ;;=EXAM RESULTS^396.41^^RES;0
 ;;^DD(396.4,70,21,0)
 ;;=^^1^1^2931013^^
 ;;^DD(396.4,70,21,1,0)
 ;;=Contains the results of a completed exam.
 ;;^DD(396.4,70,23,0)
 ;;=^^1^1^2931013^^
 ;;^DD(396.4,70,23,1,0)
 ;;=Entered by the transcriptionist with the routine ^DVBCEDIT.
 ;;^DD(396.4,80,0)
 ;;=INSUFFICIENT REMARKS^396.42^^INREM;0
 ;;^DD(396.4,80,21,0)
 ;;=^^3^3^2941115^
 ;;^DD(396.4,80,21,1,0)
 ;;=This field contains insufficient remarks entered by the Regional Office

DVBAI010
DVBAI010 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.4)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.4,80,21,2,0)
 ;;=when the C&P Exam Request is returned with a Priority of 'E'
 ;;^DD(396.4,80,21,3,0)
 ;;=(Insufficient).
 ;;^DD(396.4,80,23,0)
 ;;=^^2^2^2941115^
 ;;^DD(396.4,80,23,1,0)
 ;;=This information is reported when the Medical Center prints a 2507 request
 ;;^DD(396.4,80,23,2,0)
 ;;=that has a priority of Insufficient.
 ;;^DD(396.41,0)
 ;;=EXAM RESULTS SUB-FIELD^^.01^1
 ;;^DD(396.41,0,"DT")
 ;;=2930128
 ;;^DD(396.41,0,"NM","EXAM RESULTS")
 ;;=
 ;;^DD(396.41,0,"UP")
 ;;=396.4
 ;;^DD(396.41,.01,0)
 ;;=EXAM RESULTS^W^^0;1^Q
 ;;^DD(396.41,.01,3)
 ;;=Enter the results for this exam.
 ;;^DD(396.41,.01,4)
 ;;=S Y=$$PHYS^DVBCUTL4("YES") K Y
 ;;^DD(396.41,.01,"DT")
 ;;=2930128
 ;;^DD(396.42,0)
 ;;=INSUFFICIENT REMARKS SUB-FIELD^^.01^1
 ;;^DD(396.42,0,"DT")
 ;;=2941115
 ;;^DD(396.42,0,"NM","INSUFFICIENT REMARKS")
 ;;=
 ;;^DD(396.42,0,"UP")
 ;;=396.4
 ;;^DD(396.42,.01,0)
 ;;=INSUFFICIENT REMARKS^W^^0;1^Q
 ;;^DD(396.42,.01,3)
 ;;=Enter the insufficient remarks detailing the reason the exam is being returned.
 ;;^DD(396.42,.01,21,0)
 ;;=^^4^4^2941115^
 ;;^DD(396.42,.01,21,1,0)
 ;;=This field contains insufficient remarks entered by the Regional Office
 ;;^DD(396.42,.01,21,2,0)
 ;;=when the C&P Exam Request is returned with a Priority of 'E'            
 ;;^DD(396.42,.01,21,3,0)
 ;;=(Insufficient).
 ;;^DD(396.42,.01,21,4,0)
 ;;= 
 ;;^DD(396.42,.01,23,0)
 ;;=^^2^2^2941115^
 ;;^DD(396.42,.01,23,1,0)
 ;;=This information is reported when the Medical Center prints a 2507 request
 ;;^DD(396.42,.01,23,2,0)
 ;;=that has a priority of Insufficient.
 ;;^DD(396.42,.01,"DT")
 ;;=2941115

DVBAI011
DVBAI011 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.5,0,"GL")
 ;;=^DVB(396.5,
 ;;^DIC("B","2507 CANCELLATION REASON",396.5)
 ;;=
 ;;^DIC(396.5,"%D",0)
 ;;=^^5^5^2941216^^^^
 ;;^DIC(396.5,"%D",1,0)
 ;;=This file has all current reasons that a 2507 exam may be cancelled.
 ;;^DIC(396.5,"%D",2,0)
 ;;= 
 ;;^DIC(396.5,"%D",3,0)
 ;;= NOTICE: This file is part of an implementation of a Nationally
 ;;^DIC(396.5,"%D",4,0)
 ;;=         Controlled Procedure.  Local modifications to this file
 ;;^DIC(396.5,"%D",5,0)
 ;;=         are prohibited per VHA Directive 10-93-142.
 ;;^DD(396.5,0)
 ;;=FIELD^^1^2
 ;;^DD(396.5,0,"DDA")
 ;;=N
 ;;^DD(396.5,0,"IX","B",396.5,.01)
 ;;=
 ;;^DD(396.5,0,"IX","C",396.5,1)
 ;;=
 ;;^DD(396.5,0,"NM","2507 CANCELLATION REASON")
 ;;=
 ;;^DD(396.5,0,"PT",396.327,2)
 ;;=
 ;;^DD(396.5,0,"PT",396.4,52)
 ;;=
 ;;^DD(396.5,.01,0)
 ;;=NAME^RF^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X
 ;;^DD(396.5,.01,1,0)
 ;;=^.1
 ;;^DD(396.5,.01,1,1,0)
 ;;=396.5^B
 ;;^DD(396.5,.01,1,1,1)
 ;;=S ^DVB(396.5,"B",$E(X,1,30),DA)=""
 ;;^DD(396.5,.01,1,1,2)
 ;;=K ^DVB(396.5,"B",$E(X,1,30),DA)
 ;;^DD(396.5,.01,3)
 ;;=NAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION
 ;;^DD(396.5,.01,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.5,.01,21,1,0)
 ;;=This field holds the values of possible reasons a user may select whenever
 ;;^DD(396.5,.01,21,2,0)
 ;;=cancelling a 2507 exam.
 ;;^DD(396.5,.01,23,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.5,.01,23,1,0)
 ;;=A record in this file is pointed to by CANCELLATION REASON field in the
 ;;^DD(396.5,.01,23,2,0)
 ;;=file 396.4.
 ;;^DD(396.5,1,0)
 ;;=*SEQUENCE^NJ3,0^^0;2^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
 ;;^DD(396.5,1,1,0)
 ;;=^.1
 ;;^DD(396.5,1,1,1,0)
 ;;=396.5^C
 ;;^DD(396.5,1,1,1,1)
 ;;=S ^DVB(396.5,"C",$E(X,1,30),DA)=""
 ;;^DD(396.5,1,1,1,2)
 ;;=K ^DVB(396.5,"C",$E(X,1,30),DA)
 ;;^DD(396.5,1,3)
 ;;=Type a Number between 1 and 999, 0 Decimal Digits
 ;;^DD(396.5,1,21,0)
 ;;=^^1^1^2930430^^
 ;;^DD(396.5,1,21,1,0)
 ;;=This field is the sequence number of the cancellation reason.

DVBAI012
DVBAI012 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQR(396.5)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,396.5)
 ;;=^DVB(396.5,
 ;;^UTILITY(U,$J,396.5,0)
 ;;=2507 CANCELLATION REASON^396.5^14^14
 ;;^UTILITY(U,$J,396.5,1,0)
 ;;=ADEQUATE MEDICAL EVIDENCE^1
 ;;^UTILITY(U,$J,396.5,2,0)
 ;;=VETERAN WITHDREW CLAIM^2
 ;;^UTILITY(U,$J,396.5,3,0)
 ;;=FAILED TO REPORT^3
 ;;^UTILITY(U,$J,396.5,4,0)
 ;;=INCORRECT TEST ORDERED^4
 ;;^UTILITY(U,$J,396.5,5,0)
 ;;=EXAM NAME DELETED FROM FILE^5
 ;;^UTILITY(U,$J,396.5,6,0)
 ;;=INCORRECT JURISDICTION^6
 ;;^UTILITY(U,$J,396.5,7,0)
 ;;=EMPLOYEE^7
 ;;^UTILITY(U,$J,396.5,8,0)
 ;;=DUPLICATE EXAM^8
 ;;^UTILITY(U,$J,396.5,9,0)
 ;;=NO EXAMS ORDERED
 ;;^UTILITY(U,$J,396.5,10,0)
 ;;=NOT ENOUGH INFORMATION
 ;;^UTILITY(U,$J,396.5,11,0)
 ;;=INCOMPLETE REQUEST
 ;;^UTILITY(U,$J,396.5,12,0)
 ;;=UNDELIVERED NOTIFICATION
 ;;^UTILITY(U,$J,396.5,13,0)
 ;;=VET REFUSED EXAM THIS LOCATION
 ;;^UTILITY(U,$J,396.5,14,0)
 ;;=VETERAN DIED

DVBAI013
DVBAI013 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.6,0,"GL")
 ;;=^DVB(396.6,
 ;;^DIC("B","AMIE EXAM",396.6)
 ;;=
 ;;^DIC(396.6,"%D",0)
 ;;=^^8^8^2950103^^^^
 ;;^DIC(396.6,"%D",1,0)
 ;;=Current listing of all valid 2507 exams that may be requested.  The exams
 ;;^DIC(396.6,"%D",2,0)
 ;;=may be inactivated by the setting of the active/inactive flag.  Only the 
 ;;^DIC(396.6,"%D",3,0)
 ;;=Regional Office may determine if an exam is active or inactive.
 ;;^DIC(396.6,"%D",4,0)
 ;;= 
 ;;^DIC(396.6,"%D",5,0)
 ;;= 
 ;;^DIC(396.6,"%D",6,0)
 ;;=NOTICE: This file is part of an implementation of a Nationally 
 ;;^DIC(396.6,"%D",7,0)
 ;;=        Controlled Procedure.  Local modifications to this file
 ;;^DIC(396.6,"%D",8,0)
 ;;=        are prohibited per VHA Directive 10-93-142.  
 ;;^DD(396.6,0)
 ;;=FIELD^^10^7
 ;;^DD(396.6,0,"DDA")
 ;;=N
 ;;^DD(396.6,0,"DT")
 ;;=2940126
 ;;^DD(396.6,0,"ID",.07)
 ;;=W "   ",$P(^(0),U,7)
 ;;^DD(396.6,0,"IX","B",396.6,.01)
 ;;=
 ;;^DD(396.6,0,"IX","C",396.6,2)
 ;;=
 ;;^DD(396.6,0,"IX","D",396.6,.07)
 ;;=
 ;;^DD(396.6,0,"NM","AMIE EXAM")
 ;;=
 ;;^DD(396.6,0,"PT",396.327,.01)
 ;;=
 ;;^DD(396.6,0,"PT",396.4,.03)
 ;;=
 ;;^DD(396.6,0,"PT",396.93,.02)
 ;;=
 ;;^DD(396.6,.01,0)
 ;;=NAME^RF^^0;1^K:$L(X)>60!($L(X)<3)!'(X'?1P.E) X
 ;;^DD(396.6,.01,1,0)
 ;;=^.1
 ;;^DD(396.6,.01,1,1,0)
 ;;=396.6^B
 ;;^DD(396.6,.01,1,1,1)
 ;;=S ^DVB(396.6,"B",$E(X,1,30),DA)=""
 ;;^DD(396.6,.01,1,1,2)
 ;;=K ^DVB(396.6,"B",$E(X,1,30),DA)
 ;;^DD(396.6,.01,3)
 ;;=ANSWER MUST BE 3-60 CHARACTERS IN LENGTH
 ;;^DD(396.6,.01,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.6,.01,21,1,0)
 ;;=The name of the 2507 Exam that a user may add to a 2507 Exam Request.
 ;;^DD(396.6,.01,23,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.6,.01,23,1,0)
 ;;=Designed for use with the 2507 Request File (396.3).
 ;;^DD(396.6,.01,"DT")
 ;;=2890410
 ;;^DD(396.6,.07,0)
 ;;=AMIE WORKSHEET #^F^^0;7^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>6!($L(X)<1) X
 ;;^DD(396.6,.07,1,0)
 ;;=^.1
 ;;^DD(396.6,.07,1,1,0)
 ;;=396.6^D
 ;;^DD(396.6,.07,1,1,1)
 ;;=S ^DVB(396.6,"D",$E(X,1,30),DA)=""
 ;;^DD(396.6,.07,1,1,2)
 ;;=K ^DVB(396.6,"D",$E(X,1,30),DA)
 ;;^DD(396.6,.07,1,1,"%D",0)
 ;;=^^1^1^2940126^
 ;;^DD(396.6,.07,1,1,"%D",1,0)
 ;;=Used during the lookup for the Physician's guide.
 ;;^DD(396.6,.07,1,1,"DT")
 ;;=2940126
 ;;^DD(396.6,.07,3)
 ;;=Answer must be 1-6 characters in length.
 ;;^DD(396.6,.07,21,0)
 ;;=^^2^2^2940721^^^
 ;;^DD(396.6,.07,21,1,0)
 ;;=This is the worksheet number.  It is used not only in AMIE but in the
 ;;^DD(396.6,.07,21,2,0)
 ;;=Physician's Guide as well.
 ;;^DD(396.6,.07,"DT")
 ;;=2940126
 ;;^DD(396.6,.5,0)
 ;;=STATUS^S^A:ACTIVE;I:INACTIVE;^0;5^Q
 ;;^DD(396.6,.5,3)
 ;;=Enter A if the exam is active or I if inactive.  If inactive it cannot be selected by the RO.
 ;;^DD(396.6,.5,21,0)
 ;;=^^1^1^2940721^^
 ;;^DD(396.6,.5,21,1,0)
 ;;=The status of the 2507 Exam.  May be 'I' for Inacactive or 'A' for Active.
 ;;^DD(396.6,.5,23,0)
 ;;=2
 ;;^DD(396.6,.5,23,1,0)
 ;;=This field is used with VA FileMan screens to prevent users from selecting 
 ;;^DD(396.6,.5,23,2,0)
 ;;=exams at a VAMC that the VAMC does not have facilities to perform.
 ;;^DD(396.6,.5,"DT")
 ;;=2900327
 ;;^DD(396.6,2,0)
 ;;=BODY SYSTEM^RP396.7'^DVB(396.7,^0;3^Q
 ;;^DD(396.6,2,1,0)
 ;;=^.1
 ;;^DD(396.6,2,1,1,0)
 ;;=396.6^C
 ;;^DD(396.6,2,1,1,1)
 ;;=S ^DVB(396.6,"C",$E(X,1,30),DA)=""
 ;;^DD(396.6,2,1,1,2)
 ;;=K ^DVB(396.6,"C",$E(X,1,30),DA)
 ;;^DD(396.6,2,3)
 ;;=Enter the body system to which this exam belongs.
 ;;^DD(396.6,2,21,0)
 ;;=^^1^1^2940304^^
 ;;^DD(396.6,2,21,1,0)
 ;;=Indicates which Body System the exam pertains to.                   
 ;;^DD(396.6,2,23,0)
 ;;=^^1^1^2940304^^
 ;;^DD(396.6,2,23,1,0)
 ;;=A pointer to the Body System File.
 ;;^DD(396.6,2,"DT")
 ;;=2900326
 ;;^DD(396.6,6,0)
 ;;=PRINT NAME^RF^^0;2^K:$L(X)>25!($L(X)<1) X
 ;;^DD(396.6,6,3)
 ;;=Answer must be 1-25 characters in length.
 ;;^DD(396.6,6,21,0)
 ;;=^^1^1^2930430^
 ;;^DD(396.6,6,21,1,0)
 ;;=This field holds the name of the exam as it will appear on reports.
 ;;^DD(396.6,6,"DT")
 ;;=2900216
 ;;^DD(396.6,7,0)
 ;;=REPORTING PROGRAM NAME^FX^^0;4^X ^%ZOSF("TEST") K:$L(X)>8!($L(X)<1)!('$T) X
 ;;^DD(396.6,7,3)
 ;;=Enter the name of valid program that will be used to generate the exams for the physicians.
 ;;^DD(396.6,7,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.6,7,21,1,0)
 ;;=This field holds the name of the worksheet routine that is printed when
 ;;^DD(396.6,7,21,2,0)
 ;;=a user prints worksheets after logging or adding exams to 2507 requests.
 ;;^DD(396.6,7,23,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.6,7,23,1,0)
 ;;=This value of this field is a routine name.  It is pulled into a variable
 ;;^DD(396.6,7,23,2,0)
 ;;=and called via indirection from other routines.

DVBAI014
DVBAI014 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.6,7,"DT")
 ;;=2900123
 ;;^DD(396.6,10,0)
 ;;=RELATED DISABILITIES^396.61P^^1;0
 ;;^DD(396.6,10,21,0)
 ;;=^^1^1^2940126^
 ;;^DD(396.6,10,21,1,0)
 ;;=These are the specfic disabilities that belong to this AMIE worksheet
 ;;^DD(396.6,10,23,0)
 ;;=^^1^1^2940126^
 ;;^DD(396.6,10,23,1,0)
 ;;= 
 ;;^DD(396.61,0)
 ;;=RELATED DISABILITIES SUB-FIELD^^.01^1
 ;;^DD(396.61,0,"DT")
 ;;=2940126
 ;;^DD(396.61,0,"IX","B",396.61,.01)
 ;;=
 ;;^DD(396.61,0,"NM","RELATED DISABILITIES")
 ;;=
 ;;^DD(396.61,0,"UP")
 ;;=396.6
 ;;^DD(396.61,.01,0)
 ;;=RELATED DISABILITIES^MP31'^DIC(31,^0;1^Q
 ;;^DD(396.61,.01,1,0)
 ;;=^.1
 ;;^DD(396.61,.01,1,1,0)
 ;;=396.61^B
 ;;^DD(396.61,.01,1,1,1)
 ;;=S ^DVB(396.6,DA(1),1,"B",$E(X,1,30),DA)=""
 ;;^DD(396.61,.01,1,1,2)
 ;;=K ^DVB(396.6,DA(1),1,"B",$E(X,1,30),DA)
 ;;^DD(396.61,.01,"DT")
 ;;=2940126

DVBAI015
DVBAI015 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQR(396.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,396.6)
 ;;=^DVB(396.6,
 ;;^UTILITY(U,$J,396.6,0)
 ;;=AMIE EXAM^396.6^84^83
 ;;^UTILITY(U,$J,396.6,1,0)
 ;;=AUDIO^AUDIO^^DVBCADCK^A^^1305^
 ;;^UTILITY(U,$J,396.6,1,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,2,0)
 ;;=VISUAL^VISUAL^^DVBCVSCK^A^^1330^
 ;;^UTILITY(U,$J,396.6,2,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,3,0)
 ;;=GENERAL MEDICAL^GENERAL MEDICAL^^DVBCGMCK^A^^0505^
 ;;^UTILITY(U,$J,396.6,3,1,0)
 ;;=^396.61P^0^0
 ;;^UTILITY(U,$J,396.6,4,0)
 ;;=MUSCLES^MUSCLES^^DVBCMSCK^A^^1435^
 ;;^UTILITY(U,$J,396.6,4,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,5,0)
 ;;=SCARS^SCARS^^DVBCSCCK^I^^1445^
 ;;^UTILITY(U,$J,396.6,5,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,6,0)
 ;;=BONES^BONES^^DVBCBNCK^A^^1410^
 ;;^UTILITY(U,$J,396.6,6,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,7,0)
 ;;=JOINTS^JOINTS^^DVBCJNCK^A^^1430^
 ;;^UTILITY(U,$J,396.6,7,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,8,0)
 ;;=HAND, THUMB, FINGERS^HAND, THUMB, FINGERS^^DVBCHNCK^A^^1420^
 ;;^UTILITY(U,$J,396.6,8,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,9,0)
 ;;=SPINE^SPINE^^DVBCSPCK^A^^1450^
 ;;^UTILITY(U,$J,396.6,9,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,10,0)
 ;;=HIP^HIP^^DVBCHPCK^A^^1425^
 ;;^UTILITY(U,$J,396.6,10,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,11,0)
 ;;=FEET^FEET^^DVBCFTCK^A^^1415^
 ;;^UTILITY(U,$J,396.6,11,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,12,0)
 ;;=AMPUTATION STUMPS^AMPUTATION STUMPS^^DVBCAMCK^A^^1405^
 ;;^UTILITY(U,$J,396.6,12,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,13,0)
 ;;=NECK - NOT SPINAL CONDITION^NECK, NOT SPINAL COND^^DVBCNKCK^A^^1440^
 ;;^UTILITY(U,$J,396.6,13,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,14,0)
 ;;=NEPHRITIS, ALL FORMS EXCEPT CHRONIC PYELONEPHRITIS^ALL FORMS NEPHRITIS^^DVBCNPCK^A^^1105^
 ;;^UTILITY(U,$J,396.6,14,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,15,0)
 ;;=PYELITIS, NEPHROLITHIAIS, ETC.^PYELONEPHRITIS, ETC.^^DVBCPYCK^A^^0620^
 ;;^UTILITY(U,$J,396.6,15,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,16,0)
 ;;=CYSTITIS,BLADDER CALC.,BLADDER INJURY,PROSTATE,SURG. RESID.^CYSTITIS,BLAD CALC, ETC^^DVBCCYCK^A^^0605^
 ;;^UTILITY(U,$J,396.6,16,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,17,0)
 ;;=TESTES, TRAUMA OR DISEASE^TESTES-TRAUMA/DISEASE^^DVBCTTCK^A^^0625^
 ;;^UTILITY(U,$J,396.6,17,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,18,0)
 ;;=LOSS OF PENIS, ALL OR PARTIAL^LOSS OF PENIS^^DVBCPNCK^A^^0610^
 ;;^UTILITY(U,$J,396.6,18,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,19,0)
 ;;=URETHRAL FISTULA^URETHRAL FISTULA^^DVBCFSCK^A^^0630^
 ;;^UTILITY(U,$J,396.6,19,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,20,0)
 ;;=MALIGNANCIES OR TUBERCULOSIS^MALIGNANCIES/TUBERCULOSIS^^DVBCMLCK^A^^0615^
 ;;^UTILITY(U,$J,396.6,20,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,21,0)
 ;;=OTHER GENITOURINARY^OTHER GENITOURINARY^^DVBCGOCK^I^^0625^
 ;;^UTILITY(U,$J,396.6,21,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,22,0)
 ;;=DISEASES OF THE HEART^DISEASES OF THE HEART^^DVBCDHCK^A^^0110^
 ;;^UTILITY(U,$J,396.6,22,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,23,0)
 ;;=DISEASES OF ARTERIES/VEINS^DISEASE OF ARTERIES/VEINS^^DVBCDACK^A^^0105^
 ;;^UTILITY(U,$J,396.6,23,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,24,0)
 ;;=HYPERTENSION^HYPERTENSION^^DVBCHTCK^A^^0115^
 ;;^UTILITY(U,$J,396.6,24,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,25,0)
 ;;=ESOPHAGUS^ESOPHAGUS^^DVBCESCK^A^^0310^
 ;;^UTILITY(U,$J,396.6,25,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,26,0)
 ;;=STOMACH^STOMACH^^DVBCSTCK^A^^0325^
 ;;^UTILITY(U,$J,396.6,26,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,27,0)
 ;;=INTESTINE^INTESTINE^^DVBCNICK^A^^0315^
 ;;^UTILITY(U,$J,396.6,27,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,28,0)
 ;;=RECTUM AND ANUS^RECTUM AND ANUS^^DVBCRACK^A^^0320^
 ;;^UTILITY(U,$J,396.6,28,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,29,0)
 ;;=ALIMENTARY APPENDAGES^ALIMENTARY APPENDAGES^^DVBCAACK^A^^0305^
 ;;^UTILITY(U,$J,396.6,29,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,30,0)
 ;;=MENTAL DISORDERS^MENTAL DISORDERS^^DVBCMNCK^A^^0905^
 ;;^UTILITY(U,$J,396.6,30,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,31,0)
 ;;=MOUTH AND THROAT^MOUTH AND THROAT^^DVBCMTCK^A^^1310^
 ;;^UTILITY(U,$J,396.6,31,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,32,0)
 ;;=NOSE AND SINUSES^NOSE AND SINUSES^^DVBCNSCK^A^^1315^
 ;;^UTILITY(U,$J,396.6,32,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,33,0)
 ;;=SENSE OF SMELL^SENSE OF SMELL^^DVBCSMCK^A^^1320^
 ;;^UTILITY(U,$J,396.6,33,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,34,0)
 ;;=SENSE OF TASTE^SENSE OF TASTE^^DVBCTSCK^A^^1325^
 ;;^UTILITY(U,$J,396.6,34,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,35,0)
 ;;=NOSE AND THROAT (PULMONARY)^NOSE AND THROAT (PUL)^^DVBCNTCK^A^^1510^

DVBAI016
DVBAI016 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQR(396.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,396.6,35,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,36,0)
 ;;=SYSTEMIC CONDITIONS^SYSTEMIC CONDITIONS^^DVBCSYCK^A^^1805^
 ;;^UTILITY(U,$J,396.6,36,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,37,0)
 ;;=TRACHEA AND BRONCHI^TRACHEA/BRONCHI^^DVBCBRCK^A^^1525^
 ;;^UTILITY(U,$J,396.6,37,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,38,0)
 ;;=PULMONARY TUBERCULOSIS AND TUBERCULOSIS DISEASES^PULMONARY TB/TB DISEASES^^DVBCPDCK^A^^1515^
 ;;^UTILITY(U,$J,396.6,38,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,39,0)
 ;;=NON-TUBERCULOSIS DISEASES AND INJURIES^NON TB DISEASES/INJURIES^^DVBCPICK^A^^1505^
 ;;^UTILITY(U,$J,396.6,39,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,40,0)
 ;;=RESPIRATORY MANIF. OF DISEASES OF OTHER SYSTEMS^RESP MANIF OTH DISEASES^^DVBCRMCK^A^^1520^
 ;;^UTILITY(U,$J,396.6,40,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,41,0)
 ;;=HEMATOLOGIC DISORDERS^HEMATOLOGIC DISORDERS^^DVBCHMCK^A^^^
 ;;^UTILITY(U,$J,396.6,42,0)
 ;;=SKIN (OTHER THAN SCARS)^SKIN (OTHER THAN SCARS)^^DVBCSKCK^A^^1610^
 ;;^UTILITY(U,$J,396.6,42,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,43,0)
 ;;=SCARS (SKIN)^SCARS (SKIN)^^DVBCSCCK^A^^1445^
 ;;^UTILITY(U,$J,396.6,43,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,44,0)
 ;;=POST-TRAUMATIC STRESS DISORDER^POST-TRAUMATIC STRESS DIS^^DVBCPTCK^A^^0910^
 ;;^UTILITY(U,$J,396.6,44,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,45,0)
 ;;=GYNECOLOGICAL^GYNECOLOGICAL^^DVBCGNCK^A^^0705^
 ;;^UTILITY(U,$J,396.6,45,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,46,0)
 ;;=MAMMARY^MAMMARY^^DVBCMMCK^A^^0710^
 ;;^UTILITY(U,$J,396.6,46,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,47,0)
 ;;=HYPERTHYROIDISM, THYROID ADENOMA^HPRTHYROIDISM/THY ADENOMA^^DVBCHACK^A^^0425^
 ;;^UTILITY(U,$J,396.6,47,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,48,0)
 ;;=DIABETES MELLITUS^DIABETES MELLITUS^^DVBCDMCK^A^^0410^
 ;;^UTILITY(U,$J,396.6,48,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,49,0)
 ;;=HEMATOLOGIC DISORDERS-BLOOD^HEMATOLOGIC DIS -BLOOD^^DVBCHMCK^A^^0805^
 ;;^UTILITY(U,$J,396.6,49,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,50,0)
 ;;=HYPOTHYROIDISM^HYPOTHYROIDISM^^DVBCHDCK^A^^0430^
 ;;^UTILITY(U,$J,396.6,50,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,51,0)
 ;;=SCARS (BURN)^SCARS (BURN)^^DVBCSRCK^A^^1605^
 ;;^UTILITY(U,$J,396.6,51,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,52,0)
 ;;=HYPERPITUITARISM (CUSHINGS SYNDROME)^HYPERPITUITARISM^^DVBCCUCK^A^^0420^
 ;;^UTILITY(U,$J,396.6,52,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,53,0)
 ;;=DIABETES INSIPIDUS^DIABETES INSIPIDUS^^DVBCDICK^A^^0405^
 ;;^UTILITY(U,$J,396.6,53,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,54,0)
 ;;=DENTAL^DENTAL^^DVBCDNCK^A^^0205^
 ;;^UTILITY(U,$J,396.6,54,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,55,0)
 ;;=HEMATOLOGICAL (NEC)^HEMATOLOGICAL (NEC)^^DVBCNLCK^I^^0710^
 ;;^UTILITY(U,$J,396.6,55,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,56,0)
 ;;=DIGESTIVE (NEC)^DIGESTIVE (NEC)^^DVBCNLCK^I^^0310^
 ;;^UTILITY(U,$J,396.6,56,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,57,0)
 ;;=MUSCULOSKELETAL (NEC)^MUSCULOSKELETEL (NEC)^^DVBCNLCK^I^^1455^
 ;;^UTILITY(U,$J,396.6,57,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,58,0)
 ;;=ORGANS OF SENSE (NEC)^ORGANS OF SENSE (NEC)^^DVBCNLCK^I^^1320^
 ;;^UTILITY(U,$J,396.6,58,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,59,0)
 ;;=PULMONARY (NEC)^PULMONARY (NEC)^^DVBCNLCK^I^^1515^
 ;;^UTILITY(U,$J,396.6,59,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,60,0)
 ;;=CARDIOVASCULAR (NEC)^CARDIOVASCULAR (NEC)^^DVBCNLCK^I^^0105^
 ;;^UTILITY(U,$J,396.6,60,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,61,0)
 ;;=GENITOURINARY (NEC)^GENITOURINARY (NEC)^^DVBCNLCK^I^^0610^
 ;;^UTILITY(U,$J,396.6,61,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,62,0)
 ;;=GYNECOLOGICAL (NEC)^GYNECOLOGICAL (NEC)^^DVBCNLCK^I^^0710^
 ;;^UTILITY(U,$J,396.6,62,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,63,0)
 ;;=SKIN (NEC)^SKIN (NEC)^^DVBCNLCK^I^^1610^
 ;;^UTILITY(U,$J,396.6,63,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,64,0)
 ;;=NEUROLOGICAL (NEC)^NEUROLOGICAL (NEC)^^DVBCNLCK^I^^1230^
 ;;^UTILITY(U,$J,396.6,64,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,65,0)
 ;;=MENTAL (NEC)^MENTAL (NEC)^^DVBCNLCK^I^^0905^
 ;;^UTILITY(U,$J,396.6,65,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,66,0)
 ;;=NEPHROLOGICAL (NEC)^NEPHROLOGICAL (NEC)^^DVBCNLCK^I^^1115^
 ;;^UTILITY(U,$J,396.6,66,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,67,0)
 ;;=PRISONER OF WAR^PRISONER OF WAR^^DVBCPWCK^A^^1705^
 ;;^UTILITY(U,$J,396.6,67,1,0)
 ;;=^396.61P^0^0
 ;;^UTILITY(U,$J,396.6,68,0)
 ;;=ENDOCRINE DISORDERS (NEC)^ENDOCRINE (NEC)^^DVBCNLCK^I^^0415^
 ;;^UTILITY(U,$J,396.6,68,1,0)
 ;;=^396.61P^^0

DVBAI017
DVBAI017 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQR(396.6)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,396.6,69,0)
 ;;=DISEASES/INJURIES OF THE BRAIN^DISEASE/INJURIES-BRAIN^^DVBCDBCK^A^^1210^
 ;;^UTILITY(U,$J,396.6,69,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,71,0)
 ;;=MISCELLANEOUS NEUROLOGICAL DISORDERS^MISC NEURO DISORDERS^^DVBCMDCK^A^^1225^
 ;;^UTILITY(U,$J,396.6,71,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,72,0)
 ;;=PITUITARY TUMORS^PITUITARY TUMORS^^DVBCPUCK^A^^0435^
 ;;^UTILITY(U,$J,396.6,72,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,73,0)
 ;;=PERIPHERAL NERVES^THE PERIPHERAL NERVES^^DVBCPRCK^A^^1230^
 ;;^UTILITY(U,$J,396.6,73,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,74,0)
 ;;=HYPERPARATHYROIDISM^HYPERPARATHYROIDISM^^DVBCHYCK^A^^0415^
 ;;^UTILITY(U,$J,396.6,74,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,75,0)
 ;;=EPILEPSY AND NARCOLEPSY^EPILEPSY AND NARCOLEPSY^^DVBCENCK^A^^1220^
 ;;^UTILITY(U,$J,396.6,75,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,76,0)
 ;;=DISEASES/INJURIES OF THE SPINAL CORD^DISEASES/INJ SPINAL CORD^^DVBCXSCK^A^^1215^
 ;;^UTILITY(U,$J,396.6,76,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,77,0)
 ;;=NEPHROLOGICAL^NEPHROLOGICAL^^DVBCNHCK^A^^1110^
 ;;^UTILITY(U,$J,396.6,77,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,78,0)
 ;;=AGENT ORANGE^AGENT ORANGE^^DVBCAOCK^A^^1710^
 ;;^UTILITY(U,$J,396.6,78,1,0)
 ;;=^396.61P^0^0
 ;;^UTILITY(U,$J,396.6,79,0)
 ;;=CRANIAL NERVES^THE CRANIAL NERVES^^DVBCCRCK^A^^1205^
 ;;^UTILITY(U,$J,396.6,79,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,80,0)
 ;;=HEMATOLOGIC DISORDERS-LYMPHATIC^HEMATOLOGIC DIS-LYMPHATIC^^DVBCHLCK^A^^0810^
 ;;^UTILITY(U,$J,396.6,80,1,0)
 ;;=^396.61P^^0
 ;;^UTILITY(U,$J,396.6,81,0)
 ;;=AID AND ATTENDANCE/HOUSEBOUND^A&A/HOUSEBOUND^^DVBCARCK^A^^1715^
 ;;^UTILITY(U,$J,396.6,81,1,0)
 ;;=^396.61P^0^0
 ;;^UTILITY(U,$J,396.6,82,0)
 ;;=HIGHER LEVEL AID AND ATTENDANCE^HIGHER LEVEL A&A^^DVBCATCK^A^^1720^
 ;;^UTILITY(U,$J,396.6,82,1,0)
 ;;=^396.61P^0^0
 ;;^UTILITY(U,$J,396.6,83,0)
 ;;=REGULAR AID AND ATTENDANCE/HOUSEBOUND^REG A&A/HOUSEBOUND^^DVBCARCK^I^^1715^
 ;;^UTILITY(U,$J,396.6,83,1,0)
 ;;=^396.61P^0^0
 ;;^UTILITY(U,$J,396.6,84,0)
 ;;=AUDIO-EAR DISEASE^AUDIO-EAR DISEASE^^DVBCEDCK^A^^1306^
 ;;^UTILITY(U,$J,396.6,84,1,0)
 ;;=^396.61P^^0

DVBAI018
DVBAI018 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.7,0,"GL")
 ;;=^DVB(396.7,
 ;;^DIC("B","2507 BODY SYSTEM",396.7)
 ;;=
 ;;^DIC(396.7,"%D",0)
 ;;=^^1^1^2941216^^^
 ;;^DIC(396.7,"%D",1,0)
 ;;=Contains all body system names to which the 2507 exams are related.
 ;;^DD(396.7,0)
 ;;=FIELD^^10^2
 ;;^DD(396.7,0,"DDA")
 ;;=N
 ;;^DD(396.7,0,"DT")
 ;;=2940119
 ;;^DD(396.7,0,"IX","B",396.7,.01)
 ;;=
 ;;^DD(396.7,0,"NM","2507 BODY SYSTEM")
 ;;=
 ;;^DD(396.7,0,"PT",396.6,2)
 ;;=
 ;;^DD(396.7,.01,0)
 ;;=NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
 ;;^DD(396.7,.01,1,0)
 ;;=^.1
 ;;^DD(396.7,.01,1,1,0)
 ;;=396.7^B
 ;;^DD(396.7,.01,1,1,1)
 ;;=S ^DVB(396.7,"B",$E(X,1,30),DA)=""
 ;;^DD(396.7,.01,1,1,2)
 ;;=K ^DVB(396.7,"B",$E(X,1,30),DA)
 ;;^DD(396.7,.01,3)
 ;;=Answer must be 3-30 characters in length and be the name of a specific 2507 Exam Body System.
 ;;^DD(396.7,.01,21,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.7,.01,21,1,0)
 ;;=Contains the specific Body System Name.  2507 Request Exams belong to
 ;;^DD(396.7,.01,21,2,0)
 ;;=specific body systems.  This field holds the name of those systems.
 ;;^DD(396.7,.01,23,0)
 ;;=^^2^2^2930430^
 ;;^DD(396.7,.01,23,1,0)
 ;;=This field was designed to be pointed to by the 'Body System' field in the
 ;;^DD(396.7,.01,23,2,0)
 ;;=AMIE file 396.6 (2507 Exam File).
 ;;^DD(396.7,.01,"DT")
 ;;=2930430
 ;;^DD(396.7,10,0)
 ;;=RELATED DISABILITIES^396.701P^^1;0
 ;;^DD(396.7,10,21,0)
 ;;=^^2^2^2940304^^^^
 ;;^DD(396.7,10,21,1,0)
 ;;=This field contains all the Disability Conditions that are associated with
 ;;^DD(396.7,10,21,2,0)
 ;;=this particular Body System.                                        
 ;;^DD(396.7,10,23,0)
 ;;=^^1^1^2940304^^
 ;;^DD(396.7,10,23,1,0)
 ;;= 
 ;;^DD(396.701,0)
 ;;=RELATED DISABILITIES SUB-FIELD^^.01^1
 ;;^DD(396.701,0,"DT")
 ;;=2940119
 ;;^DD(396.701,0,"IX","AC",396.701,.01)
 ;;=
 ;;^DD(396.701,0,"IX","B",396.701,.01)
 ;;=
 ;;^DD(396.701,0,"NM","RELATED DISABILITIES")
 ;;=
 ;;^DD(396.701,0,"UP")
 ;;=396.7
 ;;^DD(396.701,.01,0)
 ;;=RELATED DISABILITIES^MP31'^DIC(31,^0;1^Q
 ;;^DD(396.701,.01,1,0)
 ;;=^.1
 ;;^DD(396.701,.01,1,1,0)
 ;;=396.701^B
 ;;^DD(396.701,.01,1,1,1)
 ;;=S ^DVB(396.7,DA(1),1,"B",$E(X,1,30),DA)=""
 ;;^DD(396.701,.01,1,1,2)
 ;;=K ^DVB(396.7,DA(1),1,"B",$E(X,1,30),DA)
 ;;^DD(396.701,.01,1,2,0)
 ;;=396.701^AC^MUMPS
 ;;^DD(396.701,.01,1,2,1)
 ;;=I $D(^DVB(396.7,DA(1),1,DA,0)) N DVBA,X S DVBA=$P(^(0),U,1) I DVBA'="" S %="^DIC(31,""ADVB"",I,DVBA,""DVB(396.7"",DA(1),DA)",X=$P(^DVB(396.7,DA(1),0),U,1) D S^XTLKWIC
 ;;^DD(396.701,.01,1,2,2)
 ;;=I $D(^DVB(396.7,DA(1),1,DA,0)) N DVBA,X S DVBA=$P(^(0),U,1) I DVBA'="" S %="^DIC(31,""ADVB"",I,DVBA,""DVB(396.7"",DA(1),DA)",X=$P(^DVB(396.7,DA(1),0),U,1) D K^XTLKWIC
 ;;^DD(396.701,.01,1,2,"%D",0)
 ;;=^^3^3^2940304^^^^
 ;;^DD(396.701,.01,1,2,"%D",1,0)
 ;;=This cross reference is to help seed the MTLU look up cross reference on
 ;;^DD(396.701,.01,1,2,"%D",2,0)
 ;;=file 31.
 ;;^DD(396.701,.01,1,2,"%D",3,0)
 ;;= 
 ;;^DD(396.701,.01,1,2,"DT")
 ;;=2940127
 ;;^DD(396.701,.01,"DT")
 ;;=2940127

DVBAI019
DVBAI019 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQR(396.7)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,396.7)
 ;;=^DVB(396.7,
 ;;^UTILITY(U,$J,396.7,0)
 ;;=2507 BODY SYSTEM^396.7^18^18
 ;;^UTILITY(U,$J,396.7,1,0)
 ;;=GENERAL MEDICAL
 ;;^UTILITY(U,$J,396.7,2,0)
 ;;=MUSCULOSKELETAL
 ;;^UTILITY(U,$J,396.7,3,0)
 ;;=ORGANS OF SENSE
 ;;^UTILITY(U,$J,396.7,3,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,4,0)
 ;;=SYSTEMIC
 ;;^UTILITY(U,$J,396.7,4,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,5,0)
 ;;=PULMONARY
 ;;^UTILITY(U,$J,396.7,5,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,6,0)
 ;;=CARDIOVASCULAR
 ;;^UTILITY(U,$J,396.7,6,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,7,0)
 ;;=DIGESTIVE
 ;;^UTILITY(U,$J,396.7,7,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,8,0)
 ;;=GENITOURINARY
 ;;^UTILITY(U,$J,396.7,8,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,9,0)
 ;;=GYNECOLOGICAL
 ;;^UTILITY(U,$J,396.7,9,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,10,0)
 ;;=HEMATOLOGICAL
 ;;^UTILITY(U,$J,396.7,10,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,11,0)
 ;;=SKIN
 ;;^UTILITY(U,$J,396.7,11,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,12,0)
 ;;=ENDOCRINE
 ;;^UTILITY(U,$J,396.7,12,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,13,0)
 ;;=NEUROLOGICAL
 ;;^UTILITY(U,$J,396.7,13,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,14,0)
 ;;=MENTAL
 ;;^UTILITY(U,$J,396.7,14,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,15,0)
 ;;=DENTAL
 ;;^UTILITY(U,$J,396.7,15,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,16,0)
 ;;=ORTHOPEDIC
 ;;^UTILITY(U,$J,396.7,16,1,0)
 ;;=^396.701P^^0
 ;;^UTILITY(U,$J,396.7,17,0)
 ;;=SPECIAL
 ;;^UTILITY(U,$J,396.7,18,0)
 ;;=NEPHROLOGICAL
 ;;^UTILITY(U,$J,396.7,18,1,0)
 ;;=^396.701P^^0

DVBAI01A
DVBAI01A ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.91)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.91,0,"GL")
 ;;=^DVBP(396.91,
 ;;^DIC("B","AMIE DOCUMENT",396.91)
 ;;=
 ;;^DIC(396.91,"%D",0)
 ;;=^^9^9^2950322^^^^
 ;;^DIC(396.91,"%D",1,0)
 ;;=This file contains the Physician's Guide document text.  
 ;;^DIC(396.91,"%D",2,0)
 ;;= 
 ;;^DIC(396.91,"%D",3,0)
 ;;= NOTICE: This file is part of an implementation of a Nationally
 ;;^DIC(396.91,"%D",4,0)
 ;;=         Controlled Procedure.  Local modifications to this file
 ;;^DIC(396.91,"%D",5,0)
 ;;=         are prohibited per VHA Directive 10-93-142.
 ;;^DIC(396.91,"%D",6,0)
 ;;= 
 ;;^DIC(396.91,"%D",7,0)
 ;;= 
 ;;^DIC(396.91,"%D",8,0)
 ;;= 
 ;;^DIC(396.91,"%D",9,0)
 ;;=This file must NOT be reindexed!
 ;;^DD(396.91,0)
 ;;=FIELD^^50^5
 ;;^DD(396.91,0,"DDA")
 ;;=N
 ;;^DD(396.91,0,"DT")
 ;;=2940308
 ;;^DD(396.91,0,"IX","AIND",396.91,.01)
 ;;=
 ;;^DD(396.91,0,"IX","B",396.91,.01)
 ;;=
 ;;^DD(396.91,0,"NM","AMIE DOCUMENT")
 ;;=
 ;;^DD(396.91,0,"PT",396.92,.01)
 ;;=
 ;;^DD(396.91,.01,0)
 ;;=DOCUMENT NAME^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>40!($L(X)<3)!'(X'?1P.E) X
 ;;^DD(396.91,.01,1,0)
 ;;=^.1
 ;;^DD(396.91,.01,1,1,0)
 ;;=396.91^B
 ;;^DD(396.91,.01,1,1,1)
 ;;=S ^DVBP(396.91,"B",$E(X,1,30),DA)=""
 ;;^DD(396.91,.01,1,1,2)
 ;;=K ^DVBP(396.91,"B",$E(X,1,30),DA)
 ;;^DD(396.91,.01,1,2,0)
 ;;=396.91^AIND^MUMPS
 ;;^DD(396.91,.01,1,2,1)
 ;;=I $D(DVBAINDX) D S^DVBAUTIL
 ;;^DD(396.91,.01,1,2,2)
 ;;=I $D(DVBAINDX) D K^DVBAUTIL
 ;;^DD(396.91,.01,1,2,"%D",0)
 ;;=^^2^2^2940308^
 ;;^DD(396.91,.01,1,2,"%D",1,0)
 ;;=This index is build in order to provide quick lookups by the
 ;;^DD(396.91,.01,1,2,"%D",2,0)
 ;;=AMIE application software.
 ;;^DD(396.91,.01,1,2,"DT")
 ;;=2940308
 ;;^DD(396.91,.01,3)
 ;;=Answer must be 3-40 characters in length.
 ;;^DD(396.91,.01,21,0)
 ;;=^^2^2^2940308^^
 ;;^DD(396.91,.01,21,1,0)
 ;;=This is the name of the document that is to be accessed through
 ;;^DD(396.91,.01,21,2,0)
 ;;=the AMIE application.
 ;;^DD(396.91,.01,"DT")
 ;;=2940308
 ;;^DD(396.91,.02,0)
 ;;=AUTHOR^F^^0;2^K:$L(X)>35!($L(X)<1) X
 ;;^DD(396.91,.02,3)
 ;;=Answer must be 1-35 characters in length.
 ;;^DD(396.91,.02,21,0)
 ;;=^^1^1^2940308^
 ;;^DD(396.91,.02,21,1,0)
 ;;=This is who wrote the document.
 ;;^DD(396.91,.02,"DT")
 ;;=2940308
 ;;^DD(396.91,.03,0)
 ;;=DATE OF DOCUMENT^D^^0;3^S %DT="ET" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.91,.03,21,0)
 ;;=^^2^2^2940309^^
 ;;^DD(396.91,.03,21,1,0)
 ;;=This is the date the document was loaded.  It is
 ;;^DD(396.91,.03,21,2,0)
 ;;=currently not used.
 ;;^DD(396.91,.03,"DT")
 ;;=2940308
 ;;^DD(396.91,.04,0)
 ;;=NUMBER OF LINES^NJ9,0^^0;4^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
 ;;^DD(396.91,.04,3)
 ;;=Type a Number between 0 and 999999999, 0 Decimal Digits
 ;;^DD(396.91,.04,21,0)
 ;;=^^1^1^2940309^^
 ;;^DD(396.91,.04,21,1,0)
 ;;=This is the total number of lines in the document.
 ;;^DD(396.91,.04,"DT")
 ;;=2940308
 ;;^DD(396.91,50,0)
 ;;=DOCUMENT TEXT^396.9101^^D;0
 ;;^DD(396.9101,0)
 ;;=DOCUMENT TEXT SUB-FIELD^^.01^1
 ;;^DD(396.9101,0,"DT")
 ;;=2940308
 ;;^DD(396.9101,0,"NM","DOCUMENT TEXT")
 ;;=
 ;;^DD(396.9101,0,"UP")
 ;;=396.91
 ;;^DD(396.9101,.01,0)
 ;;=DOCUMENT TEXT^WL^^0;1^Q
 ;;^DD(396.9101,.01,"DT")
 ;;=2940308

DVBAI01B
DVBAI01B ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.92)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.92,0,"GL")
 ;;=^DVBP(396.92,
 ;;^DIC("B","AMIE DOCUMENT TABLE OF CONTENTS",396.92)
 ;;=
 ;;^DIC(396.92,"%D",0)
 ;;=^^10^10^2950328^^^^
 ;;^DIC(396.92,"%D",1,0)
 ;;=This file contains the Table Of Contents from the Physician's Guide for
 ;;^DIC(396.92,"%D",2,0)
 ;;=Disability Evaluation Examinations.  
 ;;^DIC(396.92,"%D",3,0)
 ;;= 
 ;;^DIC(396.92,"%D",4,0)
 ;;= NOTICE: This file is part of an implementation of a Nationally
 ;;^DIC(396.92,"%D",5,0)
 ;;=         Controlled Procedure.  Local modifications to this file
 ;;^DIC(396.92,"%D",6,0)
 ;;=         are prohibited per VHA Directive 10-93-142.
 ;;^DIC(396.92,"%D",7,0)
 ;;= 
 ;;^DIC(396.92,"%D",8,0)
 ;;= 
 ;;^DIC(396.92,"%D",9,0)
 ;;= 
 ;;^DIC(396.92,"%D",10,0)
 ;;=This file must NOT be reindexed!
 ;;^DD(396.92,0)
 ;;=FIELD^^.1^2
 ;;^DD(396.92,0,"DDA")
 ;;=N
 ;;^DD(396.92,0,"DT")
 ;;=2940308
 ;;^DD(396.92,0,"IX","AC",396.92,.01)
 ;;=
 ;;^DD(396.92,0,"IX","AF",396.9201,.03)
 ;;=
 ;;^DD(396.92,0,"IX","AG",396.9201,.04)
 ;;=
 ;;^DD(396.92,0,"IX","ATC",396.9201,.02)
 ;;=
 ;;^DD(396.92,0,"IX","B",396.92,.01)
 ;;=
 ;;^DD(396.92,0,"NM","AMIE DOCUMENT TABLE OF CONTENTS")
 ;;=
 ;;^DD(396.92,.01,0)
 ;;=ASSOCIATED DOCUMENTS^RP396.91'^DVBP(396.91,^0;1^Q
 ;;^DD(396.92,.01,1,0)
 ;;=^.1
 ;;^DD(396.92,.01,1,1,0)
 ;;=396.92^B
 ;;^DD(396.92,.01,1,1,1)
 ;;=S ^DVBP(396.92,"B",$E(X,1,30),DA)=""
 ;;^DD(396.92,.01,1,1,2)
 ;;=K ^DVBP(396.92,"B",$E(X,1,30),DA)
 ;;^DD(396.92,.01,1,2,0)
 ;;=396.92^AC^MUMPS
 ;;^DD(396.92,.01,1,2,1)
 ;;=I $D(DVBAINDX) D S1^DVBAUTIL
 ;;^DD(396.92,.01,1,2,2)
 ;;=I $D(DVBAINDX) D K1^DVBAUTIL
 ;;^DD(396.92,.01,1,2,"%D",0)
 ;;=^^4^4^2940304^
 ;;^DD(396.92,.01,1,2,"%D",1,0)
 ;;=This cross reference will be used to set up the appropriate index for the
 ;;^DD(396.92,.01,1,2,"%D",2,0)
 ;;=AMIE software to find the necessary info. in a document.  At this time
 ;;^DD(396.92,.01,1,2,"%D",3,0)
 ;;=it will not set up the index.  Albany creates the index and sends it out
 ;;^DD(396.92,.01,1,2,"%D",4,0)
 ;;=with the document globals.
 ;;^DD(396.92,.01,1,2,"DT")
 ;;=2940107
 ;;^DD(396.92,.01,3)
 ;;=
 ;;^DD(396.92,.01,21,0)
 ;;=^^3^3^2940309^^^^
 ;;^DD(396.92,.01,21,1,0)
 ;;=This field contains the text of the Table of contents.  It is not a unique
 ;;^DD(396.92,.01,21,2,0)
 ;;=reference to this file.  Lookups to this file are only done though the AMIE
 ;;^DD(396.92,.01,21,3,0)
 ;;=application.
 ;;^DD(396.92,.01,23,0)
 ;;=^^4^4^2940309^^^^
 ;;^DD(396.92,.01,23,1,0)
 ;;=This .01 is not intended to be a unique .01.  A unique key is created
 ;;^DD(396.92,.01,23,2,0)
 ;;=throught the MUMPS cross reference that is built in the fields.  This file
 ;;^DD(396.92,.01,23,3,0)
 ;;=was not intented to be directly accessed though FileManager, only though
 ;;^DD(396.92,.01,23,4,0)
 ;;=the AMIE application.
 ;;^DD(396.92,.01,"DT")
 ;;=2940308
 ;;^DD(396.92,.1,0)
 ;;=TEXT^396.9201^^T;0
 ;;^DD(396.92,.1,21,0)
 ;;=^^3^3^2940304^^^^
 ;;^DD(396.92,.1,21,1,0)
 ;;=This is a multiple of Physician's Guide for Disability Evaluation 
 ;;^DD(396.92,.1,21,2,0)
 ;;=Examinations TOC text.  It is used by the Document Retrieval portion of 
 ;;^DD(396.92,.1,21,3,0)
 ;;=AMIE.
 ;;^DD(396.9201,0)
 ;;=TEXT SUB-FIELD^^99^6
 ;;^DD(396.9201,0,"IX","B",396.9201,.01)
 ;;=
 ;;^DD(396.9201,0,"IX","C",396.9201,.01)
 ;;=
 ;;^DD(396.9201,0,"NM","TEXT")
 ;;=
 ;;^DD(396.9201,0,"UP")
 ;;=396.92
 ;;^DD(396.9201,.01,0)
 ;;=TEXT^MRF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>80!($L(X)<1) X
 ;;^DD(396.9201,.01,1,0)
 ;;=^.1
 ;;^DD(396.9201,.01,1,1,0)
 ;;=396.9201^B
 ;;^DD(396.9201,.01,1,1,1)
 ;;=S ^DVBP(396.92,DA(1),"T","B",$E(X,1,30),DA)=""
 ;;^DD(396.9201,.01,1,1,2)
 ;;=K ^DVBP(396.92,DA(1),"T","B",$E(X,1,30),DA)
 ;;^DD(396.9201,.01,1,2,0)
 ;;=396.9201^C^MUMPS
 ;;^DD(396.9201,.01,1,2,1)
 ;;=N VAR,HLD S HLD=X S VAR=$$SPACES^DVBCPGU(X) S ^DVBP(396.92,DA(1),"T","C",$E(VAR,1,30),DA)="" S X=HLD
 ;;^DD(396.9201,.01,1,2,2)
 ;;=N VAR,HLD S HLD=X S VAR=$$SPACES^DVBCPGU(X) K ^DVBP(396.92,DA(1),"T","C",$E(VAR,1,30),DA) S X=HLD
 ;;^DD(396.9201,.01,1,2,"%D",0)
 ;;=^^2^2^2940215^^^
 ;;^DD(396.9201,.01,1,2,"%D",1,0)
 ;;=Creates a cross reference similar to "B" with the extra spaces removed
 ;;^DD(396.9201,.01,1,2,"%D",2,0)
 ;;=from the line.
 ;;^DD(396.9201,.01,1,2,"DT")
 ;;=2940215
 ;;^DD(396.9201,.01,3)
 ;;=Answer must be 1-80 characters in length.
 ;;^DD(396.9201,.01,21,0)
 ;;=^^1^1^2940215^^
 ;;^DD(396.9201,.01,21,1,0)
 ;;=This is the actual text lines from the Physician's Guide.
 ;;^DD(396.9201,.01,"DT")
 ;;=2940215
 ;;^DD(396.9201,.02,0)
 ;;=OCCURRENCE^RNJ9,0^^0;2^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
 ;;^DD(396.9201,.02,1,0)
 ;;=^.1

DVBAI01C
DVBAI01C ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.92)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.9201,.02,1,1,0)
 ;;=396.92^ATC^MUMPS
 ;;^DD(396.9201,.02,1,1,1)
 ;;=N B S B=^DVBP(396.92,DA(1),"T",DA,0) I $P(B,U,3)]"",$P(B,U,4)]"" S ^DVBP(396.92,DA(1),"T","ATC",$E(X,1,30),$P(B,U,3),$P(B,U,4),DA)=""
 ;;^DD(396.9201,.02,1,1,2)
 ;;=N B S B=^DVBP(396.92,DA(1),"T",DA,0) I $P(B,U,3)]"",$P(B,U,4)]"" K ^DVBP(396.92,DA(1),"T","ATC",$E(X,1,30),$P(B,U,3),$P(B,U,4),DA)
 ;;^DD(396.9201,.02,1,1,"%D",0)
 ;;=^^3^3^2940304^
 ;;^DD(396.9201,.02,1,1,"%D",1,0)
 ;;=This cross reference is built to help sort and order the lines of text
 ;;^DD(396.9201,.02,1,1,"%D",2,0)
 ;;=in each document.  Each of the fields needs to defined in order for this
 ;;^DD(396.9201,.02,1,1,"%D",3,0)
 ;;=to execute.
 ;;^DD(396.9201,.02,1,1,"DT")
 ;;=2940107
 ;;^DD(396.9201,.02,3)
 ;;=Type a Number between 0 and 999999999, 0 Decimal Digits
 ;;^DD(396.9201,.02,21,0)
 ;;=^^2^2^2940304^^^
 ;;^DD(396.9201,.02,21,1,0)
 ;;=This is one of the counters that the AMIE software uses in order to keep
 ;;^DD(396.9201,.02,21,2,0)
 ;;=track of the guide's contents.
 ;;^DD(396.9201,.02,"DT")
 ;;=2940304
 ;;^DD(396.9201,.03,0)
 ;;=LINE^RNJ9,0^^0;3^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
 ;;^DD(396.9201,.03,1,0)
 ;;=^.1
 ;;^DD(396.9201,.03,1,1,0)
 ;;=396.92^AF^MUMPS
 ;;^DD(396.9201,.03,1,1,1)
 ;;=N B S B=^DVBP(396.92,DA(1),"T",DA,0) I $P(B,U,2)]"",$P(B,U,4)]"" S ^DVBP(396.92,DA(1),"T","ATC",$P(B,U,2),$E(X,1,30),$P(B,U,4),DA)=""
 ;;^DD(396.9201,.03,1,1,2)
 ;;=N B S B=^DVBP(396.92,DA(1),"T",DA,0) I $P(B,U,2)]"",$P(B,U,4)]"" K ^DVBP(396.92,DA(1),"T","ATC",$P(B,U,2),$E(X,1,30),$P(B,U,4),DA)
 ;;^DD(396.9201,.03,1,1,"%D",0)
 ;;=^^1^1^2940304^
 ;;^DD(396.9201,.03,1,1,"%D",1,0)
 ;;=This is the same cross reference as in field .02 of this multiple.
 ;;^DD(396.9201,.03,1,1,"DT")
 ;;=2940107
 ;;^DD(396.9201,.03,3)
 ;;=Type a Number between 0 and 999999999, 0 Decimal Digits
 ;;^DD(396.9201,.03,21,0)
 ;;=^^1^1^2940215^
 ;;^DD(396.9201,.03,21,1,0)
 ;;=This is the line number within the total table of contents.
 ;;^DD(396.9201,.03,"DT")
 ;;=2940107
 ;;^DD(396.9201,.04,0)
 ;;=HEADING LEVEL^RNJ2,0^^0;4^K:+X'=X!(X>99)!(X<0)!(X?.E1"."1N.N) X
 ;;^DD(396.9201,.04,1,0)
 ;;=^.1
 ;;^DD(396.9201,.04,1,1,0)
 ;;=396.92^AG^MUMPS
 ;;^DD(396.9201,.04,1,1,1)
 ;;=N B S B=^DVBP(396.92,DA(1),"T",DA,0) I $P(B,U,2)]"",$P(B,U,3)]"" S ^DVBP(396.92,DA(1),"T","ATC",$P(B,U,2),$P(B,U,3),$E(X,1,30),DA)=""
 ;;^DD(396.9201,.04,1,1,2)
 ;;=N B S B=^DVBP(396.92,DA(1),"T",DA,0) I $P(B,U,2)]"",$P(B,U,3)]"" K ^DVBP(396.92,DA(1),"T","ATC",$P(B,U,2),$P(B,U,3),$E(X,1,30),DA)
 ;;^DD(396.9201,.04,1,1,"%D",0)
 ;;=^^1^1^2940304^
 ;;^DD(396.9201,.04,1,1,"%D",1,0)
 ;;=This is the same cross reference as in fields .02 and .03
 ;;^DD(396.9201,.04,1,1,"DT")
 ;;=2940107
 ;;^DD(396.9201,.04,3)
 ;;=Type a Number between 0 and 99, 0 Decimal Digits
 ;;^DD(396.9201,.04,21,0)
 ;;=^^2^2^2940215^
 ;;^DD(396.9201,.04,21,1,0)
 ;;=This defines what heading level this portion of text has been defined as.
 ;;^DD(396.9201,.04,21,2,0)
 ;;= 
 ;;^DD(396.9201,.04,"DT")
 ;;=2940107
 ;;^DD(396.9201,.05,0)
 ;;=PREVIOUS HEADING LEVEL^NJ2,0^^0;5^K:+X'=X!(X>99)!(X<0)!(X?.E1"."1N.N) X
 ;;^DD(396.9201,.05,3)
 ;;=Type a Number between 0 and 99, 0 Decimal Digits
 ;;^DD(396.9201,.05,21,0)
 ;;=^^3^3^2940304^^
 ;;^DD(396.9201,.05,21,1,0)
 ;;=This tells the AMIE software the previous heading level that this sub
 ;;^DD(396.9201,.05,21,2,0)
 ;;=level belongs to.  It is used to help define multiple layers of
 ;;^DD(396.9201,.05,21,3,0)
 ;;=heading levels.
 ;;^DD(396.9201,.05,"DT")
 ;;=2940107
 ;;^DD(396.9201,99,0)
 ;;=AMIE REFERENCE^F^^99;1^K:$L(X)>80!($L(X)<1) X
 ;;^DD(396.9201,99,3)
 ;;=Answer must be 1-80 characters in length.
 ;;^DD(396.9201,99,21,0)
 ;;=^^2^2^2940215^
 ;;^DD(396.9201,99,21,1,0)
 ;;=This contains the string that is used to fine the match in the on-line
 ;;^DD(396.9201,99,21,2,0)
 ;;=Physician's Guide.
 ;;^DD(396.9201,99,23,0)
 ;;=^^1^1^2940215^
 ;;^DD(396.9201,99,23,1,0)
 ;;= 
 ;;^DD(396.9201,99,"DT")
 ;;=2940107

DVBAI01D
DVBAI01D ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.93)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.93,0,"GL")
 ;;=^DVB(396.93,
 ;;^DIC("B","EXAM EXCEPTIONS",396.93)
 ;;=
 ;;^DIC(396.93,"%D",0)
 ;;=^^8^8^2950125^^^^
 ;;^DIC(396.93,"%D",1,0)
 ;;=This file contains the exams that do not have a match in the Disability
 ;;^DIC(396.93,"%D",2,0)
 ;;=Condition file.  It also contains the reference to the Physician's Guide.
 ;;^DIC(396.93,"%D",3,0)
 ;;= 
 ;;^DIC(396.93,"%D",4,0)
 ;;=The data in this file should not be edited or changed in any way by the
 ;;^DIC(396.93,"%D",5,0)
 ;;=sites.  Nor should the "ADVB" cross-reference be reindexed.  This cross-
 ;;^DIC(396.93,"%D",6,0)
 ;;=reference will contain entries from other files.  The reindexing of this
 ;;^DIC(396.93,"%D",7,0)
 ;;=file from within this one file will not result in a correct rebuilding
 ;;^DIC(396.93,"%D",8,0)
 ;;=of this index.
 ;;^DD(396.93,0)
 ;;=FIELD^^.03^3
 ;;^DD(396.93,0,"DDA")
 ;;=N
 ;;^DD(396.93,0,"DT")
 ;;=2940310
 ;;^DD(396.93,0,"IX","AC",396.93,.02)
 ;;=
 ;;^DD(396.93,0,"IX","ADVB",396.93,.01)
 ;;=
 ;;^DD(396.93,0,"IX","B",396.93,.01)
 ;;=
 ;;^DD(396.93,0,"IX","C",396.93,.01)
 ;;=
 ;;^DD(396.93,0,"NM","EXAM EXCEPTIONS")
 ;;=
 ;;^DD(396.93,0,"PT",8984.1,.02)
 ;;=
 ;;^DD(396.93,0,"PT",8984.2,.02)
 ;;=
 ;;^DD(396.93,.01,0)
 ;;=NAME^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>150!($L(X)<3)!'(X'?1P.E) X
 ;;^DD(396.93,.01,1,0)
 ;;=^.1
 ;;^DD(396.93,.01,1,1,0)
 ;;=396.93^B
 ;;^DD(396.93,.01,1,1,1)
 ;;=S ^DVB(396.93,"B",$E(X,1,30),DA)=""
 ;;^DD(396.93,.01,1,1,2)
 ;;=K ^DVB(396.93,"B",$E(X,1,30),DA)
 ;;^DD(396.93,.01,1,2,0)
 ;;=396.93^C^KWIC
 ;;^DD(396.93,.01,1,2,1)
 ;;=S %1=1 F %=1:1:$L(X)+1 S I=$E(X,%) I "(,.?! '-/&:;)"[I S I=$E($E(X,%1,%-1),1,30),%1=%+1 I $L(I)>2,^DD("KWIC")'[I S ^DVB(396.93,"C",I,DA)=""
 ;;^DD(396.93,.01,1,2,2)
 ;;=S %1=1 F %=1:1:$L(X)+1 S I=$E(X,%) I "(,.?! '-/&:;)"[I S I=$E($E(X,%1,%-1),1,30),%1=%+1 I $L(I)>2 K ^DVB(396.93,"C",I,DA)
 ;;^DD(396.93,.01,1,2,"%D",0)
 ;;=^^1^1^2940222^
 ;;^DD(396.93,.01,1,2,"%D",1,0)
 ;;=KIWC cross reference to allow lookups if single word entered.
 ;;^DD(396.93,.01,1,2,"DT")
 ;;=2940222
 ;;^DD(396.93,.01,1,3,0)
 ;;=396.93^ADVB^MUMPS
 ;;^DD(396.93,.01,1,3,1)
 ;;=S %="^DVB(396.93,""ADVB"",I,DA)" D S^XTLKWIC
 ;;^DD(396.93,.01,1,3,2)
 ;;=S %="^DVB(396.93,""ADVB"",I,DA)" D K^XTLKWIC
 ;;^DD(396.93,.01,1,3,"%D",0)
 ;;=^^1^1^2940915^^
 ;;^DD(396.93,.01,1,3,"%D",1,0)
 ;;=This is the cross reference to set up the MTLU lookup on this file.
 ;;^DD(396.93,.01,1,3,"DT")
 ;;=2940915
 ;;^DD(396.93,.01,3)
 ;;=Answer must be 3-150 characters in length.
 ;;^DD(396.93,.01,21,0)
 ;;=^^2^2^2940310^^
 ;;^DD(396.93,.01,21,1,0)
 ;;=This is the name of the exams that are exceptions.  These exams do not
 ;;^DD(396.93,.01,21,2,0)
 ;;=have match entries in the Disability Condition file.
 ;;^DD(396.93,.01,"DT")
 ;;=2940915
 ;;^DD(396.93,.02,0)
 ;;=AMIE WORKSHEET^P396.6'^DVB(396.6,^0;2^Q
 ;;^DD(396.93,.02,1,0)
 ;;=^.1^^-1
 ;;^DD(396.93,.02,1,1,0)
 ;;=396.93^AC
 ;;^DD(396.93,.02,1,1,1)
 ;;=S ^DVB(396.93,"AC",$E(X,1,30),DA)=""
 ;;^DD(396.93,.02,1,1,2)
 ;;=K ^DVB(396.93,"AC",$E(X,1,30),DA)
 ;;^DD(396.93,.02,1,1,"DT")
 ;;=2940215
 ;;^DD(396.93,.02,21,0)
 ;;=^^1^1^2940216^
 ;;^DD(396.93,.02,21,1,0)
 ;;=Points to the AMIE worksheet that this exam is recorded on.
 ;;^DD(396.93,.02,"DT")
 ;;=2940216
 ;;^DD(396.93,.03,0)
 ;;=PHYSICIAN'S GUIDE REFERENCE^F^^0;3^K:$L(X)>50!($L(X)<1) X
 ;;^DD(396.93,.03,3)
 ;;=Answer must be 1-50 characters in length.
 ;;^DD(396.93,.03,21,0)
 ;;=^^1^1^2940216^
 ;;^DD(396.93,.03,21,1,0)
 ;;=This field contains the references to the Physician's Guide for this exam.
 ;;^DD(396.93,.03,"DT")
 ;;=2940215

DVBAI01E
DVBAI01E ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.94)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.94,0,"GL")
 ;;=^DVB(396.94,
 ;;^DIC("B","2507 INSUFFICIENT REASONS",396.94)
 ;;=
 ;;^DIC(396.94,"%D",0)
 ;;=^^7^7^2941230^^^^
 ;;^DIC(396.94,"%D",1,0)
 ;;=This file has been added for use by the 2507 EXAM File (396.4).  It
 ;;^DIC(396.94,"%D",2,0)
 ;;=contains the reason an exam is returned by the Regional Office to the
 ;;^DIC(396.94,"%D",3,0)
 ;;=Medical Center as 'Insufficient'.
 ;;^DIC(396.94,"%D",4,0)
 ;;= 
 ;;^DIC(396.94,"%D",5,0)
 ;;=The reasons contained in this file were developed and agreed upon by the
 ;;^DIC(396.94,"%D",6,0)
 ;;=AMIE Sub-group of the PII-EP.  This information should not be modified by
 ;;^DIC(396.94,"%D",7,0)
 ;;=the site.
 ;;^DD(396.94,0)
 ;;=FIELD^^.01^3
 ;;^DD(396.94,0,"DDA")
 ;;=N
 ;;^DD(396.94,0,"DT")
 ;;=2941115
 ;;^DD(396.94,0,"IX","B",396.94,.01)
 ;;=
 ;;^DD(396.94,0,"IX","C",396.94,.02)
 ;;=
 ;;^DD(396.94,0,"NM","2507 INSUFFICIENT REASONS")
 ;;=
 ;;^DD(396.94,0,"PT",396.4,.11)
 ;;=
 ;;^DD(396.94,.01,0)
 ;;=INSUFFICIENT REASON^RF^^0;1^K:$L(X)>75!($L(X)<1)!'(X'?1P.E) X
 ;;^DD(396.94,.01,1,0)
 ;;=^.1
 ;;^DD(396.94,.01,1,1,0)
 ;;=396.94^B
 ;;^DD(396.94,.01,1,1,1)
 ;;=S ^DVB(396.94,"B",$E(X,1,30),DA)=""
 ;;^DD(396.94,.01,1,1,2)
 ;;=K ^DVB(396.94,"B",$E(X,1,30),DA)
 ;;^DD(396.94,.01,3)
 ;;=Enter the reason a 2507 exam may be returned as insufficient.
 ;;^DD(396.94,.01,4)
 ;;=
 ;;^DD(396.94,.01,21,0)
 ;;=^^2^2^2950210^^^^
 ;;^DD(396.94,.01,21,1,0)
 ;;=This field contains the text of the reason that the 2507 exam was
 ;;^DD(396.94,.01,21,2,0)
 ;;=insufficient.
 ;;^DD(396.94,.01,23,0)
 ;;=^^5^5^2950210^^^^
 ;;^DD(396.94,.01,23,1,0)
 ;;=The information in this field should not be modified by the site.  The
 ;;^DD(396.94,.01,23,2,0)
 ;;=reasons included in this file have been established by the AMIE Sub-group
 ;;^DD(396.94,.01,23,3,0)
 ;;=of the PII-EP.
 ;;^DD(396.94,.01,23,4,0)
 ;;= 
 ;;^DD(396.94,.01,23,5,0)
 ;;=This information should not be modified by the site.
 ;;^DD(396.94,.01,"DT")
 ;;=2941115
 ;;^DD(396.94,.02,0)
 ;;=INSUFFICIENT CODE^RF^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>6!($L(X)<1) X
 ;;^DD(396.94,.02,1,0)
 ;;=^.1
 ;;^DD(396.94,.02,1,1,0)
 ;;=396.94^C
 ;;^DD(396.94,.02,1,1,1)
 ;;=S ^DVB(396.94,"C",$E(X,1,30),DA)=""
 ;;^DD(396.94,.02,1,1,2)
 ;;=K ^DVB(396.94,"C",$E(X,1,30),DA)
 ;;^DD(396.94,.02,1,1,"%D",0)
 ;;=^^2^2^2941129^
 ;;^DD(396.94,.02,1,1,"%D",1,0)
 ;;=This cross reference has been added to allow transfers of 2507 requests
 ;;^DD(396.94,.02,1,1,"%D",2,0)
 ;;=with a Priority of Insufficient to add the Insufficient Reason via Code.
 ;;^DD(396.94,.02,1,1,"DT")
 ;;=2941129
 ;;^DD(396.94,.02,3)
 ;;=Enter the insufficient reason code.
 ;;^DD(396.94,.02,21,0)
 ;;=^^6^6^2950126^^^^
 ;;^DD(396.94,.02,21,1,0)
 ;;=This field is used when transferring insufficient exams.  It is included to
 ;;^DD(396.94,.02,21,2,0)
 ;;=allow the implementation of access of insufficient reasons by an
 ;;^DD(396.94,.02,21,3,0)
 ;;=associated code.
 ;;^DD(396.94,.02,21,4,0)
 ;;= 
 ;;^DD(396.94,.02,21,5,0)
 ;;=Because this code is used by the AMIE 2507 transfer processing, it should
 ;;^DD(396.94,.02,21,6,0)
 ;;=not be modified.
 ;;^DD(396.94,.02,23,0)
 ;;=^^2^2^2941115^^^^
 ;;^DD(396.94,.02,23,1,0)
 ;;=This fields allows the implementation of access to insufficient reasons by
 ;;^DD(396.94,.02,23,2,0)
 ;;=an associated code.
 ;;^DD(396.94,.02,"DT")
 ;;=2941129
 ;;^DD(396.94,.03,0)
 ;;=INSUFFICIENT REASON (REPORT)^RF^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>45!($L(X)<1) X
 ;;^DD(396.94,.03,1,0)
 ;;=^.1^^0
 ;;^DD(396.94,.03,3)
 ;;=Enter a shorter version of the Insufficient Reason for reporting purposes.
 ;;^DD(396.94,.03,21,0)
 ;;=^^1^1^2941115^^^^
 ;;^DD(396.94,.03,21,1,0)
 ;;=This field contains an abridged version of the Insufficient Reason.
 ;;^DD(396.94,.03,23,0)
 ;;=^^1^1^2941115^^^^
 ;;^DD(396.94,.03,23,1,0)
 ;;=This field is used by the summary and detailed insufficient exam reports.
 ;;^DD(396.94,.03,"DT")
 ;;=2950210

DVBAI01F
DVBAI01F ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQR(396.94)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,396.94)
 ;;=^DVB(396.94,
 ;;^UTILITY(U,$J,396.94,0)
 ;;=2507 INSUFFICIENT REASONS^396.94^13^13
 ;;^UTILITY(U,$J,396.94,1,0)
 ;;=FAILED TO PROVIDE TEST ROUTINELY DONE FOR SPECIFIC CONDITION^RT^Failed to provide test for specific condition^^^^
 ;;^UTILITY(U,$J,396.94,2,0)
 ;;=FAILED TO PROVIDE ADDITIONAL EXAM RECOMMENDED BY EXAMINING PHYSICIAN^RE^Failed to provide recommended exam^^^^
 ;;^UTILITY(U,$J,396.94,3,0)
 ;;=FAILED TO COMPLY WITH BVA REMAND INSTRUCTIONS^RI^Failed to comply with BVA remand instructions^^^^
 ;;^UTILITY(U,$J,396.94,4,0)
 ;;=FAILED TO PROVIDE RANGE OF MOTION^RM^Failed to provide range of motion^^^^
 ;;^UTILITY(U,$J,396.94,5,0)
 ;;=FAILED TO ADDRESS ALL CONDITIONS REQUESTED^RC^Failed to address all conditions requested^^^^
 ;;^UTILITY(U,$J,396.94,6,0)
 ;;=FAILED TO PERFORM REQUESTED SPECIALIST EXAM^RSE^Failed to perform requested specialist exam^^^^
 ;;^UTILITY(U,$J,396.94,7,0)
 ;;=EXAM PREVIOUSLY RETURNED AS INSUFFICIENT, RETURN AGAIN INSUFFICIENT^PRI^Previously insufficient exam returned again^^^^
 ;;^UTILITY(U,$J,396.94,8,0)
 ;;=EYE EXAM IS INSUFFICIENT^EI^Eye exam is insufficient^^^^
 ;;^UTILITY(U,$J,396.94,9,0)
 ;;=FAILED TO PROVIDE DIAGNOSIS^PD^Failed to provide diagnosis^^^^
 ;;^UTILITY(U,$J,396.94,10,0)
 ;;=FAILED TO REVIEW TEST RESULTS BEFORE MAKING DIAGNOSIS^RTR^Failed to review results before diagnosis^^^^
 ;;^UTILITY(U,$J,396.94,11,0)
 ;;=DIAGNOSIS INCONSISTENT WITH EVIDENCE^DI^Diagnosis inconsistent with evidence^^^^
 ;;^UTILITY(U,$J,396.94,12,0)
 ;;=FAILED TO PROVIDE REQUESTED MEDICAL OPINION^RMO^Failed to provide requested medical opinion^^^^
 ;;^UTILITY(U,$J,396.94,13,0)
 ;;=OTHER^O^Other^^^^

DVBAI01G
DVBAI01G ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.95)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DIC(396.95,0,"GL")
 ;;=^DVB(396.95,
 ;;^DIC("B","AMIE C&P EXAM TRACKING",396.95)
 ;;=
 ;;^DIC(396.95,"%D",0)
 ;;=^^10^10^2941230^^^^
 ;;^DIC(396.95,"%D",1,0)
 ;;=This file has been added for use by the 2507 REQUEST File (396.3).  It
 ;;^DIC(396.95,"%D",2,0)
 ;;=contains information about C&P appointments linked to 2507 Requests.
 ;;^DIC(396.95,"%D",3,0)
 ;;= 
 ;;^DIC(396.95,"%D",4,0)
 ;;=This file should not be edited via FileMan.  The information in this file
 ;;^DIC(396.95,"%D",5,0)
 ;;=is crucial to proper calculation of the Average Processing Time on the
 ;;^DIC(396.95,"%D",6,0)
 ;;=AMIE AMIS 290.
 ;;^DIC(396.95,"%D",7,0)
 ;;= 
 ;;^DIC(396.95,"%D",8,0)
 ;;=NOTICE: This file is part of an implementation of a Nationally
 ;;^DIC(396.95,"%D",9,0)
 ;;=        Controlled Procedure.  Local modifications to this file
 ;;^DIC(396.95,"%D",10,0)
 ;;=        are prohibited per VHA Directive 10-93-142
 ;;^DD(396.95,0)
 ;;=FIELD^^.08^8
 ;;^DD(396.95,0,"DDA")
 ;;=N
 ;;^DD(396.95,0,"DT")
 ;;=2941107
 ;;^DD(396.95,0,"ID",.03)
 ;;=W "   ",$E($P(^(0),U,3),4,5)_"-"_$E($P(^(0),U,3),6,7)_"-"_$E($P(^(0),U,3),2,3)
 ;;^DD(396.95,0,"ID",.06)
 ;;=S %I=Y,Y=$S('$D(^(0)):"",$D(^DVB(396.3,+$P(^(0),U,6),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(396.3,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
 ;;^DD(396.95,0,"IX","AB",396.95,.03)
 ;;=
 ;;^DD(396.95,0,"IX","AB2",396.95,.06)
 ;;=
 ;;^DD(396.95,0,"IX","AR",396.95,.06)
 ;;=
 ;;^DD(396.95,0,"IX","ARO",396.95,.02)
 ;;=
 ;;^DD(396.95,0,"IX","ARO1",396.95,.06)
 ;;=
 ;;^DD(396.95,0,"IX","ARVC",396.95,.03)
 ;;=
 ;;^DD(396.95,0,"IX","ARVO",396.95,.02)
 ;;=
 ;;^DD(396.95,0,"IX","AVC2",396.95,.04)
 ;;=
 ;;^DD(396.95,0,"IX","AVC3",396.95,.06)
 ;;=
 ;;^DD(396.95,0,"IX","AVO2",396.95,.04)
 ;;=
 ;;^DD(396.95,0,"IX","AVO3",396.95,.06)
 ;;=
 ;;^DD(396.95,0,"IX","B",396.95,.01)
 ;;=
 ;;^DD(396.95,0,"IX","CD",396.95,.03)
 ;;=
 ;;^DD(396.95,0,"NM","AMIE C&P EXAM TRACKING")
 ;;=
 ;;^DD(396.95,.01,0)
 ;;=INITIAL APPT DATE^RD^^0;1^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.95,.01,1,0)
 ;;=^.1
 ;;^DD(396.95,.01,1,1,0)
 ;;=396.95^B
 ;;^DD(396.95,.01,1,1,1)
 ;;=S ^DVB(396.95,"B",$E(X,1,30),DA)=""
 ;;^DD(396.95,.01,1,1,2)
 ;;=K ^DVB(396.95,"B",$E(X,1,30),DA)
 ;;^DD(396.95,.01,3)
 ;;=Enter the first appointment date scheduled.
 ;;^DD(396.95,.01,21,0)
 ;;=^^1^1^2941018^^^^
 ;;^DD(396.95,.01,21,1,0)
 ;;=This field contains the initial appointment date.
 ;;^DD(396.95,.01,23,0)
 ;;=^^2^2^2941018^^^^
 ;;^DD(396.95,.01,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.01,23,2,0)
 ;;=contains the date of the first appointment scheduled for the examination.
 ;;^DD(396.95,.01,"DT")
 ;;=2941028
 ;;^DD(396.95,.02,0)
 ;;=ORIGINAL APPT DATE^D^^0;2^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.95,.02,1,0)
 ;;=^.1
 ;;^DD(396.95,.02,1,1,0)
 ;;=396.95^ARO^MUMPS
 ;;^DD(396.95,.02,1,1,1)
 ;;=I $P(^DVB(396.95,DA,0),U,6)'="" S ^DVB(396.95,"ARO",$P(^DVB(396.95,DA,0),U,6),$E(X,1,30),DA)=""
 ;;^DD(396.95,.02,1,1,2)
 ;;=I $P(^DVB(396.95,DA,0),U,6)'="" K ^DVB(396.95,"ARO",$P(^DVB(396.95,DA,0),U,6),$E(X,1,30),DA)
 ;;^DD(396.95,.02,1,1,"%D",0)
 ;;=^^4^4^2941018^^^
 ;;^DD(396.95,.02,1,1,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.02,1,1,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total
 ;;^DD(396.95,.02,1,1,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last original
 ;;^DD(396.95,.02,1,1,"%D",4,0)
 ;;=appointment date on a 2507 request.
 ;;^DD(396.95,.02,1,1,"DT")
 ;;=2940919
 ;;^DD(396.95,.02,1,2,0)
 ;;=396.95^ARVO^MUMPS
 ;;^DD(396.95,.02,1,2,1)
 ;;=I $P(^DVB(396.95,DA,0),U,4)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,4) S ^DVB(396.95,"ARVO",A,B,$E(X,1,30),DA)=""
 ;;^DD(396.95,.02,1,2,2)
 ;;=I $P(^DVB(396.95,DA,0),U,4)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,4) K ^DVB(396.95,"ARVO",A,B,$E(X,1,30),DA)
 ;;^DD(396.95,.02,1,2,"%D",0)
 ;;=^^6^6^2940919^
 ;;^DD(396.95,.02,1,2,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.02,1,2,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total
 ;;^DD(396.95,.02,1,2,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last original
 ;;^DD(396.95,.02,1,2,"%D",4,0)
 ;;=appointment date on those appointments that have been cancelled by the
 ;;^DD(396.95,.02,1,2,"%D",5,0)
 ;;=veteran.  This is to ensure that all appointments rescheduled at the
 ;;^DD(396.95,.02,1,2,"%D",6,0)
 ;;=request of the veteran are completed within 30 days.

DVBAI01H
DVBAI01H ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.95)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.95,.02,1,2,"DT")
 ;;=2940919
 ;;^DD(396.95,.02,3)
 ;;=Enter the date of the original appointment for the examination.
 ;;^DD(396.95,.02,21,0)
 ;;=^^1^1^2941018^^^^
 ;;^DD(396.95,.02,21,1,0)
 ;;=This field contains the original appointment date.
 ;;^DD(396.95,.02,23,0)
 ;;=^^8^8^2941018^^^^
 ;;^DD(396.95,.02,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.02,23,2,0)
 ;;=contains the date of the original appointment for the examination.
 ;;^DD(396.95,.02,23,3,0)
 ;;=This date will equal the current appointment until the veteran
 ;;^DD(396.95,.02,23,4,0)
 ;;=reschedules.
 ;;^DD(396.95,.02,23,5,0)
 ;;= 
 ;;^DD(396.95,.02,23,6,0)
 ;;=This date will be used for the clock stop date in the event of a veteran
 ;;^DD(396.95,.02,23,7,0)
 ;;=reschedule, if it is the latest original appointment date rescheduled by
 ;;^DD(396.95,.02,23,8,0)
 ;;=the veteran.
 ;;^DD(396.95,.02,"DT")
 ;;=2941028
 ;;^DD(396.95,.03,0)
 ;;=CURRENT APPT DATE^D^^0;3^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.95,.03,1,0)
 ;;=^.1
 ;;^DD(396.95,.03,1,1,0)
 ;;=396.95^AB^MUMPS
 ;;^DD(396.95,.03,1,1,1)
 ;;=N A S A=$P(^DVB(396.95,DA,0),U,6) I +A>0 S ^DVB(396.95,"AB",A,$E(X,1,30),DA)=""
 ;;^DD(396.95,.03,1,1,2)
 ;;=N A S A=$P(^DVB(396.95,DA,0),U,6) I +A>0 K ^DVB(396.95,"AB",A,$E(X,1,30),DA)
 ;;^DD(396.95,.03,1,1,"%D",0)
 ;;=^^3^3^2941018^^^^
 ;;^DD(396.95,.03,1,1,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.03,1,1,"%D",2,0)
 ;;=This cross reference is used to reference all the current appointment dates
 ;;^DD(396.95,.03,1,1,"%D",3,0)
 ;;=on a specific 2507 request.
 ;;^DD(396.95,.03,1,1,"DT")
 ;;=2941018
 ;;^DD(396.95,.03,1,2,0)
 ;;=396.95^CD
 ;;^DD(396.95,.03,1,2,1)
 ;;=S ^DVB(396.95,"CD",$E(X,1,30),DA)=""
 ;;^DD(396.95,.03,1,2,2)
 ;;=K ^DVB(396.95,"CD",$E(X,1,30),DA)
 ;;^DD(396.95,.03,1,2,"%D",0)
 ;;=^^3^3^2941018^^
 ;;^DD(396.95,.03,1,2,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.03,1,2,"%D",2,0)
 ;;=This Cross Reference is used by the AMIE Appointment Management software to
 ;;^DD(396.95,.03,1,2,"%D",3,0)
 ;;=find a specific appointment link in the AMIE C&P Exam Tracking File.
 ;;^DD(396.95,.03,1,2,"DT")
 ;;=2940919
 ;;^DD(396.95,.03,1,3,0)
 ;;=396.95^ARVC^MUMPS
 ;;^DD(396.95,.03,1,3,1)
 ;;=I $P(^DVB(396.95,DA,0),U,4)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,4) S ^DVB(396.95,"ARVC",A,B,$E(X,1,30),DA)=""
 ;;^DD(396.95,.03,1,3,2)
 ;;=I $P(^DVB(396.95,DA,0),U,4)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,4) K ^DVB(396.95,"ARVC",A,B,$E(X,1,30),DA)
 ;;^DD(396.95,.03,1,3,"%D",0)
 ;;=^^6^6^2940919^^^^
 ;;^DD(396.95,.03,1,3,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.03,1,3,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total
 ;;^DD(396.95,.03,1,3,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last current
 ;;^DD(396.95,.03,1,3,"%D",4,0)
 ;;=appointment date on those appointments that have been cancelled by the
 ;;^DD(396.95,.03,1,3,"%D",5,0)
 ;;=veteran.  This is to ensure that all appointments rescheduled at the
 ;;^DD(396.95,.03,1,3,"%D",6,0)
 ;;=request of the veteran are completed within 30 days.
 ;;^DD(396.95,.03,1,3,"DT")
 ;;=2940919
 ;;^DD(396.95,.03,3)
 ;;=Enter the date of the current appointment for the examination.
 ;;^DD(396.95,.03,21,0)
 ;;=^^1^1^2941018^^^
 ;;^DD(396.95,.03,21,1,0)
 ;;=This field contains the current appointment date for the examination.
 ;;^DD(396.95,.03,23,0)
 ;;=^^4^4^2941018^^^
 ;;^DD(396.95,.03,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.03,23,2,0)
 ;;=contains the date of the current appointment for the examination.  This
 ;;^DD(396.95,.03,23,3,0)
 ;;=date may be used for the clock start date in the event of a veteran
 ;;^DD(396.95,.03,23,4,0)
 ;;=reschedule.
 ;;^DD(396.95,.03,"DT")
 ;;=2941028
 ;;^DD(396.95,.04,0)
 ;;=VETERAN CANCELLATION^RS^0:NO;1:YES;^0;4^Q
 ;;^DD(396.95,.04,1,0)
 ;;=^.1
 ;;^DD(396.95,.04,1,1,0)
 ;;=396.95^AVC2^MUMPS
 ;;^DD(396.95,.04,1,1,1)
 ;;=I $P(^DVB(396.95,DA,0),U,3)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,3) S ^DVB(396.95,"ARVC",A,$E(X,1,30),B,DA)=""
 ;;^DD(396.95,.04,1,1,2)
 ;;=I $P(^DVB(396.95,DA,0),U,3)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,3) K ^DVB(396.95,"ARVC",A,$E(X,1,30),B,DA)
 ;;^DD(396.95,.04,1,1,"%D",0)
 ;;=^^6^6^2940919^^^
 ;;^DD(396.95,.04,1,1,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.04,1,1,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total

DVBAI01I
DVBAI01I ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.95)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.95,.04,1,1,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last current
 ;;^DD(396.95,.04,1,1,"%D",4,0)
 ;;=appointment date on those appointments that have been cancelled by the
 ;;^DD(396.95,.04,1,1,"%D",5,0)
 ;;=veteran.  This is to ensure that all appointments rescheduled at the
 ;;^DD(396.95,.04,1,1,"%D",6,0)
 ;;=request of the veteran are completed within 30 days.
 ;;^DD(396.95,.04,1,1,"DT")
 ;;=2940919
 ;;^DD(396.95,.04,1,2,0)
 ;;=396.95^AVO2^MUMPS
 ;;^DD(396.95,.04,1,2,1)
 ;;=I $P(^DVB(396.95,DA,0),U,2)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,2) S ^DVB(396.95,"ARVO",A,$E(X,1,30),B,DA)=""
 ;;^DD(396.95,.04,1,2,2)
 ;;=I $P(^DVB(396.95,DA,0),U,2)'="",($P(^DVB(396.95,DA,0),U,6)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,6),B=$P(^DVB(396.95,DA,0),U,2) K ^DVB(396.95,"ARVO",A,$E(X,1,30),B,DA)
 ;;^DD(396.95,.04,1,2,"%D",0)
 ;;=^^6^6^2940919^
 ;;^DD(396.95,.04,1,2,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.04,1,2,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total
 ;;^DD(396.95,.04,1,2,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last original
 ;;^DD(396.95,.04,1,2,"%D",4,0)
 ;;=appointment date on those appointments that have been cancelled by the
 ;;^DD(396.95,.04,1,2,"%D",5,0)
 ;;=veteran.  This is to ensure that all appointments rescheduled at the
 ;;^DD(396.95,.04,1,2,"%D",6,0)
 ;;=request of the veteran are completed within 30 days.
 ;;^DD(396.95,.04,1,2,"DT")
 ;;=2940919
 ;;^DD(396.95,.04,3)
 ;;=Enter the date of the current appointment for the examination.
 ;;^DD(396.95,.04,21,0)
 ;;=^^2^2^2941018^^^
 ;;^DD(396.95,.04,21,1,0)
 ;;=This field contains a code indicating if the appointment has been cancelled
 ;;^DD(396.95,.04,21,2,0)
 ;;=at the request of the veteran.
 ;;^DD(396.95,.04,23,0)
 ;;=^^4^4^2941018^^^
 ;;^DD(396.95,.04,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.04,23,2,0)
 ;;=contains either of two values for a set of codes (Yes or No).  In the
 ;;^DD(396.95,.04,23,3,0)
 ;;=event of a veteran reschedule, this field will indicate the occurance so
 ;;^DD(396.95,.04,23,4,0)
 ;;=the Original Appt Date will not be modified with any subsequent reschedules.
 ;;^DD(396.95,.04,"DT")
 ;;=2941028
 ;;^DD(396.95,.05,0)
 ;;=VETERAN REQ APPT DATE^D^^0;5^S %DT="ETXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.95,.05,1,0)
 ;;=^.1^^0
 ;;^DD(396.95,.05,3)
 ;;=Enter the last appointment date rescheduled for at the veteran's request.
 ;;^DD(396.95,.05,21,0)
 ;;=^^2^2^2941018^^^^
 ;;^DD(396.95,.05,21,1,0)
 ;;=This field contains the date to which the veteran last requested the
 ;;^DD(396.95,.05,21,2,0)
 ;;=appointment be rescheduled.
 ;;^DD(396.95,.05,23,0)
 ;;=^^2^2^2941018^^^^
 ;;^DD(396.95,.05,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.05,23,2,0)
 ;;=contains the last date of the appointment rescheduled to by the veteran.
 ;;^DD(396.95,.05,"DT")
 ;;=2941028
 ;;^DD(396.95,.06,0)
 ;;=2507 REQUEST^RP396.3'^DVB(396.3,^0;6^Q
 ;;^DD(396.95,.06,1,0)
 ;;=^.1
 ;;^DD(396.95,.06,1,1,0)
 ;;=396.95^AB2^MUMPS
 ;;^DD(396.95,.06,1,1,1)
 ;;=N A S A=$P(^DVB(396.95,DA,0),U,3) I +A>0 S ^DVB(396.95,"AB",$E(X,1,30),A,DA)=""
 ;;^DD(396.95,.06,1,1,2)
 ;;=N A S A=$P(^DVB(396.95,DA,0),U,3) I +A>0 K ^DVB(396.95,"AB",$E(X,1,30),A,DA)
 ;;^DD(396.95,.06,1,1,"%D",0)
 ;;=^^3^3^2941018^^^^
 ;;^DD(396.95,.06,1,1,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.06,1,1,"%D",2,0)
 ;;=This cross reference is used to look up Current Appt Dates on specific 
 ;;^DD(396.95,.06,1,1,"%D",3,0)
 ;;=2507 requests.
 ;;^DD(396.95,.06,1,1,"DT")
 ;;=2941018
 ;;^DD(396.95,.06,1,2,0)
 ;;=396.95^AR
 ;;^DD(396.95,.06,1,2,1)
 ;;=S ^DVB(396.95,"AR",$E(X,1,30),DA)=""
 ;;^DD(396.95,.06,1,2,2)
 ;;=K ^DVB(396.95,"AR",$E(X,1,30),DA)
 ;;^DD(396.95,.06,1,2,"%D",0)
 ;;=^^3^3^2941018^^
 ;;^DD(396.95,.06,1,2,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.06,1,2,"%D",2,0)
 ;;=This Cross-Reference is used by DVBCPURG to delete those appointment
 ;;^DD(396.95,.06,1,2,"%D",3,0)
 ;;=records that are associated with the 2507 request being deleted.
 ;;^DD(396.95,.06,1,2,"DT")
 ;;=2940919
 ;;^DD(396.95,.06,1,3,0)
 ;;=396.95^ARO1^MUMPS
 ;;^DD(396.95,.06,1,3,1)
 ;;=I $P(^DVB(396.95,DA,0),U,2)'="" S ^DVB(396.95,"ARO",$E(X,1,30),$P(^DVB(396.95,DA,0),U,2),DA)=""
 ;;^DD(396.95,.06,1,3,2)
 ;;=I $P(^DVB(396.95,DA,0),U,2)'="" K ^DVB(396.95,"ARO",$E(X,1,30),$P(^DVB(396.95,DA,0),U,2),DA)
 ;;^DD(396.95,.06,1,3,"%D",0)
 ;;=^^4^4^2941018^^
 ;;^DD(396.95,.06,1,3,"%D",1,0)
 ;;= 

DVBAI01J
DVBAI01J ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 Q:'DIFQ(396.95)  F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^DD(396.95,.06,1,3,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total
 ;;^DD(396.95,.06,1,3,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last original
 ;;^DD(396.95,.06,1,3,"%D",4,0)
 ;;=appointment date on a 2507 request.
 ;;^DD(396.95,.06,1,3,"DT")
 ;;=2940919
 ;;^DD(396.95,.06,1,4,0)
 ;;=396.95^AVC3^MUMPS
 ;;^DD(396.95,.06,1,4,1)
 ;;=I ($P(^DVB(396.95,DA,0),U,3)'=""),($P(^DVB(396.95,DA,0),U,4)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,4),B=$P(^DVB(396.95,DA,0),U,3) S ^DVB(396.95,"ARVC",$E(X,1,30),A,B,DA)=""
 ;;^DD(396.95,.06,1,4,2)
 ;;=I ($P(^DVB(396.95,DA,0),U,3)'=""),($P(^DVB(396.95,DA,0),U,4)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,4),B=$P(^DVB(396.95,DA,0),U,3) K ^DVB(396.95,"ARVC",$E(X,1,30),A,B,DA)
 ;;^DD(396.95,.06,1,4,"%D",0)
 ;;=^^6^6^2940919^^^
 ;;^DD(396.95,.06,1,4,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.06,1,4,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total
 ;;^DD(396.95,.06,1,4,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last current
 ;;^DD(396.95,.06,1,4,"%D",4,0)
 ;;=appointment date on those appointments that have been cancelled by the
 ;;^DD(396.95,.06,1,4,"%D",5,0)
 ;;=veteran.  This is to ensure that all appointments rescheduled at the
 ;;^DD(396.95,.06,1,4,"%D",6,0)
 ;;=request of the veteran are completed within 30 days.
 ;;^DD(396.95,.06,1,4,"DT")
 ;;=2940919
 ;;^DD(396.95,.06,1,5,0)
 ;;=396.95^AVO3^MUMPS
 ;;^DD(396.95,.06,1,5,1)
 ;;=I $P(^DVB(396.95,DA,0),U,2)'="",($P(^DVB(396.95,DA,0),U,4)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,4),B=$P(^DVB(396.95,DA,0),U,2) S ^DVB(396.95,"ARVO",$E(X,1,30),A,B,DA)=""
 ;;^DD(396.95,.06,1,5,2)
 ;;=I $P(^DVB(396.95,DA,0),U,2)'="",($P(^DVB(396.95,DA,0),U,4)'="") N A,B S A=$P(^DVB(396.95,DA,0),U,4),B=$P(^DVB(396.95,DA,0),U,2) K ^DVB(396.95,"ARVO",$E(X,1,30),A,B,DA)
 ;;^DD(396.95,.06,1,5,"%D",0)
 ;;=^^6^6^2940919^
 ;;^DD(396.95,.06,1,5,"%D",1,0)
 ;;= 
 ;;^DD(396.95,.06,1,5,"%D",2,0)
 ;;=This Cross-Reference is used by the software that calculates the total
 ;;^DD(396.95,.06,1,5,"%D",3,0)
 ;;=processing time for a 2507 request.  It is used to find the last original
 ;;^DD(396.95,.06,1,5,"%D",4,0)
 ;;=appointment date on those appointments that have been cancelled by the
 ;;^DD(396.95,.06,1,5,"%D",5,0)
 ;;=veteran.  This is to ensure that all appointments rescheduled at the
 ;;^DD(396.95,.06,1,5,"%D",6,0)
 ;;=request of the veteran are completed within 30 days.
 ;;^DD(396.95,.06,1,5,"DT")
 ;;=2940919
 ;;^DD(396.95,.06,3)
 ;;=Enter the IEN from the 2507 Request this record points to.
 ;;^DD(396.95,.06,21,0)
 ;;=^^2^2^2941018^^^^
 ;;^DD(396.95,.06,21,1,0)
 ;;=This field contains a pointer to the 2507 request record this appointment
 ;;^DD(396.95,.06,21,2,0)
 ;;=is scheduled for.
 ;;^DD(396.95,.06,23,0)
 ;;=^^2^2^2941018^^^^
 ;;^DD(396.95,.06,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.06,23,2,0)
 ;;=contains an IEN from file 396.3.
 ;;^DD(396.95,.06,"DT")
 ;;=2941028
 ;;^DD(396.95,.07,0)
 ;;=APPOINTMENT STATUS^RS^1:ACTIVE;0:CANCELLED;^0;7^Q
 ;;^DD(396.95,.07,3)
 ;;=Enter the status of the appointment tracked by this record.
 ;;^DD(396.95,.07,21,0)
 ;;=^^1^1^2941018^^
 ;;^DD(396.95,.07,21,1,0)
 ;;=This field contains a code indicating the status of the appointment.
 ;;^DD(396.95,.07,23,0)
 ;;=^^2^2^2941018^^
 ;;^DD(396.95,.07,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.07,23,2,0)
 ;;=contains either of two values for a set of codes (Active or Cancelled).
 ;;^DD(396.95,.07,"DT")
 ;;=2941028
 ;;^DD(396.95,.08,0)
 ;;=DATE APPT CANCELLED^D^^0;8^S %DT="ESTXR" D ^%DT S X=Y K:Y<1 X
 ;;^DD(396.95,.08,3)
 ;;=Enter the date the appointment this record is linked to was cancelled.
 ;;^DD(396.95,.08,21,0)
 ;;=^^2^2^2950126^^^
 ;;^DD(396.95,.08,21,1,0)
 ;;=This field contains the date the appointment this link is associated with
 ;;^DD(396.95,.08,21,2,0)
 ;;=was last cancelled.
 ;;^DD(396.95,.08,23,0)
 ;;=^^2^2^2941107^^
 ;;^DD(396.95,.08,23,1,0)
 ;;=The information in this field should not be modified by the site.  It
 ;;^DD(396.95,.08,23,2,0)
 ;;=contains the last date the appointment was cancelled.
 ;;^DD(396.95,.08,"DT")
 ;;=2941107

DVBAI01K
DVBAI01K ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"BUL",70,0)
 ;;=DVBA C 2507 EXAM READY^C & P Exam Ready for Release
 ;;^UTILITY(U,$J,"BUL",70,1,0)
 ;;=^^10^10^2940810^^^^
 ;;^UTILITY(U,$J,"BUL",70,1,1,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",70,1,2,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",70,1,3,0)
 ;;=A 2507 request for:
 ;;^UTILITY(U,$J,"BUL",70,1,4,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",70,1,5,0)
 ;;=               Name: |1|
 ;;^UTILITY(U,$J,"BUL",70,1,6,0)
 ;;=                SSN: |2|
 ;;^UTILITY(U,$J,"BUL",70,1,7,0)
 ;;=       Request Date: |3|
 ;;^UTILITY(U,$J,"BUL",70,1,8,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",70,1,9,0)
 ;;=has been completely transcribed and may now be
 ;;^UTILITY(U,$J,"BUL",70,1,10,0)
 ;;=reviewed for release to the regional office.
 ;;^UTILITY(U,$J,"BUL",70,3,0)
 ;;=^^1^1^2940810^^^^
 ;;^UTILITY(U,$J,"BUL",70,3,1,0)
 ;;=Alerts selected personnel that a 2507 exam is ready for release.
 ;;^UTILITY(U,$J,"BUL",70,4,0)
 ;;=^3.64A^3^3
 ;;^UTILITY(U,$J,"BUL",70,4,1,0)
 ;;=1
 ;;^UTILITY(U,$J,"BUL",70,4,1,1,0)
 ;;=^^1^1^2900528^
 ;;^UTILITY(U,$J,"BUL",70,4,1,1,1,0)
 ;;=patient name
 ;;^UTILITY(U,$J,"BUL",70,4,2,0)
 ;;=2
 ;;^UTILITY(U,$J,"BUL",70,4,2,1,0)
 ;;=^^1^1^2900528^
 ;;^UTILITY(U,$J,"BUL",70,4,2,1,1,0)
 ;;=social security number
 ;;^UTILITY(U,$J,"BUL",70,4,3,0)
 ;;=3
 ;;^UTILITY(U,$J,"BUL",70,4,3,1,0)
 ;;=^^1^1^2921125^^
 ;;^UTILITY(U,$J,"BUL",70,4,3,1,1,0)
 ;;=date of request for 2507
 ;;^UTILITY(U,$J,"BUL",71,0)
 ;;=DVBA C 2507 EXAM REOPENED^2507 Exam Reopened |7|
 ;;^UTILITY(U,$J,"BUL",71,1,0)
 ;;=^^11^11^2940928^^^^
 ;;^UTILITY(U,$J,"BUL",71,1,1,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",71,1,2,0)
 ;;=One or more C&P exams for:
 ;;^UTILITY(U,$J,"BUL",71,1,3,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",71,1,4,0)
 ;;=                Name: |1|
 ;;^UTILITY(U,$J,"BUL",71,1,5,0)
 ;;=                 SSN: |2|
 ;;^UTILITY(U,$J,"BUL",71,1,6,0)
 ;;=        Request date: |3|
 ;;^UTILITY(U,$J,"BUL",71,1,7,0)
 ;;=Request Release Date: |5|
 ;;^UTILITY(U,$J,"BUL",71,1,8,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",71,1,9,0)
 ;;=has been reopened by |4|.
 ;;^UTILITY(U,$J,"BUL",71,1,10,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",71,1,11,0)
 ;;=|6|
 ;;^UTILITY(U,$J,"BUL",71,3,0)
 ;;=^^1^1^2940928^^^^
 ;;^UTILITY(U,$J,"BUL",71,3,1,0)
 ;;=Alerts supervisors to a 2507 exam being reopened.
 ;;^UTILITY(U,$J,"BUL",71,4,0)
 ;;=^3.64A^7^7
 ;;^UTILITY(U,$J,"BUL",71,4,1,0)
 ;;=1
 ;;^UTILITY(U,$J,"BUL",71,4,1,1,0)
 ;;=^^1^1^2940912^^
 ;;^UTILITY(U,$J,"BUL",71,4,1,1,1,0)
 ;;=patient name
 ;;^UTILITY(U,$J,"BUL",71,4,2,0)
 ;;=2
 ;;^UTILITY(U,$J,"BUL",71,4,2,1,0)
 ;;=^^1^1^2900528^
 ;;^UTILITY(U,$J,"BUL",71,4,2,1,1,0)
 ;;=social security number
 ;;^UTILITY(U,$J,"BUL",71,4,3,0)
 ;;=3
 ;;^UTILITY(U,$J,"BUL",71,4,3,1,0)
 ;;=^^1^1^2940912^^^
 ;;^UTILITY(U,$J,"BUL",71,4,3,1,1,0)
 ;;=date of request for 2507
 ;;^UTILITY(U,$J,"BUL",71,4,4,0)
 ;;=4
 ;;^UTILITY(U,$J,"BUL",71,4,4,1,0)
 ;;=^^1^1^2940919^^^^
 ;;^UTILITY(U,$J,"BUL",71,4,4,1,1,0)
 ;;=DUZ of user who reopened the exams.
 ;;^UTILITY(U,$J,"BUL",71,4,5,0)
 ;;=5
 ;;^UTILITY(U,$J,"BUL",71,4,5,1,0)
 ;;=^^1^1^2940919^
 ;;^UTILITY(U,$J,"BUL",71,4,5,1,1,0)
 ;;=Date the request was released back to the Regional Office.
 ;;^UTILITY(U,$J,"BUL",71,4,6,0)
 ;;=6
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,0)
 ;;=^^7^7^2940920^
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,1,0)
 ;;=One of two messages will be displayed.  A message will be displayed when
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,2,0)
 ;;=an exam is re-opened on a request that has not been released back to the
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,3,0)
 ;;=Regional Office.  The message lets the receipants know that this re-open
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,4,0)
 ;;=does not affect the AMIE AMIS 290 report.  A message will be displayed
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,5,0)
 ;;=when an exam is re-opened on a request that has been released back to the
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,6,0)
 ;;=Regional Office.  The message lets the receipants know that this re-open
 ;;^UTILITY(U,$J,"BUL",71,4,6,1,7,0)
 ;;=DOES affect the AMIE AMIS 290 report.
 ;;^UTILITY(U,$J,"BUL",71,4,7,0)
 ;;=7
 ;;^UTILITY(U,$J,"BUL",71,4,7,1,0)
 ;;=^^2^2^2940920^^
 ;;^UTILITY(U,$J,"BUL",71,4,7,1,1,0)
 ;;=When the AMIE AMIS 290 is affected, this will be noted in the subject line
 ;;^UTILITY(U,$J,"BUL",71,4,7,1,2,0)
 ;;=of the bulletin.  Otherwise nothing will be added to the subject line.
 ;;^UTILITY(U,$J,"BUL",72,0)
 ;;=DVBA C NEW C&P VETERAN^New C&P Veteran Added to Patient File
 ;;^UTILITY(U,$J,"BUL",72,1,0)
 ;;=^^9^9^2940831^^^^
 ;;^UTILITY(U,$J,"BUL",72,1,1,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",72,1,2,0)
 ;;=The following veteran has been added to the Patient file
 ;;^UTILITY(U,$J,"BUL",72,1,3,0)
 ;;=for Compensation and Pension exam purposes:

DVBAI01L
DVBAI01L ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"BUL",72,1,4,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",72,1,5,0)
 ;;= Name: |1|
 ;;^UTILITY(U,$J,"BUL",72,1,6,0)
 ;;=  SSN: |2|
 ;;^UTILITY(U,$J,"BUL",72,1,7,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",72,1,8,0)
 ;;=Added by: |3| on |4|.
 ;;^UTILITY(U,$J,"BUL",72,1,9,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",72,3,0)
 ;;=^^1^1^2940831^^^^
 ;;^UTILITY(U,$J,"BUL",72,3,1,0)
 ;;=Alerts MAS of new C&P veteran when added to Patient file (#2).
 ;;^UTILITY(U,$J,"BUL",72,4,0)
 ;;=^3.64A^4^4
 ;;^UTILITY(U,$J,"BUL",72,4,1,0)
 ;;=1
 ;;^UTILITY(U,$J,"BUL",72,4,1,1,0)
 ;;=^^1^1^2930323^^^
 ;;^UTILITY(U,$J,"BUL",72,4,1,1,1,0)
 ;;=Veteran name.
 ;;^UTILITY(U,$J,"BUL",72,4,2,0)
 ;;=2
 ;;^UTILITY(U,$J,"BUL",72,4,2,1,0)
 ;;=^^1^1^2930323^^^
 ;;^UTILITY(U,$J,"BUL",72,4,2,1,1,0)
 ;;=Social security number.
 ;;^UTILITY(U,$J,"BUL",72,4,3,0)
 ;;=3
 ;;^UTILITY(U,$J,"BUL",72,4,3,1,0)
 ;;=^^1^1^2930323^^^
 ;;^UTILITY(U,$J,"BUL",72,4,3,1,1,0)
 ;;=Person who added veteran (name).
 ;;^UTILITY(U,$J,"BUL",72,4,4,0)
 ;;=4
 ;;^UTILITY(U,$J,"BUL",72,4,4,1,0)
 ;;=^^1^1^2930323^^
 ;;^UTILITY(U,$J,"BUL",72,4,4,1,1,0)
 ;;=Date new veteran was added.
 ;;^UTILITY(U,$J,"BUL",76,0)
 ;;=DVBA C EDIT ADDRESS^Editing of patient address
 ;;^UTILITY(U,$J,"BUL",76,1,0)
 ;;=^^5^5^2940816^^^^
 ;;^UTILITY(U,$J,"BUL",76,1,1,0)
 ;;=The address information for |1|
 ;;^UTILITY(U,$J,"BUL",76,1,2,0)
 ;;=was changed on |2| by |3|.
 ;;^UTILITY(U,$J,"BUL",76,1,3,0)
 ;;= 
 ;;^UTILITY(U,$J,"BUL",76,1,4,0)
 ;;=        Old Permanent Address               Changed Permanent Address
 ;;^UTILITY(U,$J,"BUL",76,1,5,0)
 ;;=        ---------------------               -------------------------
 ;;^UTILITY(U,$J,"BUL",76,3,0)
 ;;=^^2^2^2940816^^^^
 ;;^UTILITY(U,$J,"BUL",76,3,1,0)
 ;;=This bulletin will contain which patient address got changed by whom and
 ;;^UTILITY(U,$J,"BUL",76,3,2,0)
 ;;=when.
 ;;^UTILITY(U,$J,"BUL",76,4,0)
 ;;=^3.64A^3^3
 ;;^UTILITY(U,$J,"BUL",76,4,1,0)
 ;;=1
 ;;^UTILITY(U,$J,"BUL",76,4,1,1,0)
 ;;=^^1^1^2930310^
 ;;^UTILITY(U,$J,"BUL",76,4,1,1,1,0)
 ;;=this is the patient's name
 ;;^UTILITY(U,$J,"BUL",76,4,2,0)
 ;;=2
 ;;^UTILITY(U,$J,"BUL",76,4,2,1,0)
 ;;=^^1^1^2930310^^
 ;;^UTILITY(U,$J,"BUL",76,4,2,1,1,0)
 ;;=When the address was edited.
 ;;^UTILITY(U,$J,"BUL",76,4,3,0)
 ;;=3
 ;;^UTILITY(U,$J,"BUL",76,4,3,1,0)
 ;;=^^1^1^2930323^^^
 ;;^UTILITY(U,$J,"BUL",76,4,3,1,1,0)
 ;;=Who did the editing of the address
 ;;^UTILITY(U,$J,"DIBT",611,0)
 ;;=DVBA INCOMP REQ REPORT^2890727^^396^^^^
 ;;^UTILITY(U,$J,"DIBT",611,2,1)
 ;;=396^^FINALIZATION DATE=""^]"@B^;L1
 ;;^UTILITY(U,$J,"DIBT",611,2,1,"CM")
 ;;=S Y(1)=$S($D(^DVB(396,D0,1)):^(1),1:"") S X=$P(Y(1),U,12)="" I D0>0 S X(1)=X
 ;;^UTILITY(U,$J,"DIBT",611,2,1,"F")
 ;;=0
 ;;^UTILITY(U,$J,"DIBT",611,2,1,"T")
 ;;=1
 ;;^UTILITY(U,$J,"DIBT",611,2,2)
 ;;=396^23^DATE OF REQUEST^+@^;S2
 ;;^UTILITY(U,$J,"DIBT",611,2,2,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",611,2,2,"F")
 ;;=2890100.99999
 ;;^UTILITY(U,$J,"DIBT",611,2,2,"IX")
 ;;=^DVB(396,"E",^DVB(396,^2
 ;;^UTILITY(U,$J,"DIBT",611,2,2,"T")
 ;;=2890727.9999
 ;;^UTILITY(U,$J,"DIBT",612,0)
 ;;=DVBA FINALIZED REPORT^2880809^^396^^^^
 ;;^UTILITY(U,$J,"DIBT",612,2,1)
 ;;=396^25^FINALIZATION DATE^@+^;S2
 ;;^UTILITY(U,$J,"DIBT",612,2,1,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",612,2,1,"F")
 ;;=2010100.99999
 ;;^UTILITY(U,$J,"DIBT",612,2,1,"IX")
 ;;=^DVB(396,"F",^DVB(396,^2
 ;;^UTILITY(U,$J,"DIBT",612,2,1,"T")
 ;;=2990101.9999
 ;;^UTILITY(U,$J,"DIBT",612,2,2)
 ;;=396^23^DATE OF REQUEST^@^
 ;;^UTILITY(U,$J,"DIBT",612,2,2,"IX")
 ;;=^DVB(396,"E",^DVB(396,^2
 ;;^UTILITY(U,$J,"DIBT",613,0)
 ;;=DVBA NOT/DIS-21 DAY CERT CHECK^2890202^^396^^^^
 ;;^UTILITY(U,$J,"DIBT",613,2,1)
 ;;=396^^PATIENT NAME^".01^;S1
 ;;^UTILITY(U,$J,"DIBT",613,2,1,"CM")
 ;;=S Y(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) I D0>0 S X(1)=X
 ;;^UTILITY(U,$J,"DIBT",613,2,2)
 ;;=396^^NOTICE OF DISCHARGE="YES"!(CERTIFICATE (21-DAY)="YES")^"@B^;L1
 ;;^UTILITY(U,$J,"DIBT",613,2,2,"CM")
 ;;=X DPP(2,"OVF0",9.3) S X=X!Y I D0>0 S X(2)=X
 ;;^UTILITY(U,$J,"DIBT",613,2,2,"F")
 ;;=0
 ;;^UTILITY(U,$J,"DIBT",613,2,2,"OVF0",9.2)
 ;;=S Y(2)=$C(59)_$S($D(^DD(396,4,0)):$P(^(0),U,3),1:""),Y(4)=$C(59)_$S($D(^DD(396,6,0)):$P(^(0),U,3),1:""),Y(1)=$S($D(^DVB(396,D0,0)):^(0),1:"")
 ;;^UTILITY(U,$J,"DIBT",613,2,2,"OVF0",9.3)
 ;;=X DPP(2,"OVF0",9.2) S X=$P($P(Y(2),$C(59)_$P(Y(1),U,5)_":",2),$C(59),1)="YES",Y(3)=X S X=$P($P(Y(4),$C(59)_$P(Y(1),U,7)_":",2),$C(59),1)="YES",Y=X,X=Y(3),X=X
 ;;^UTILITY(U,$J,"DIBT",613,2,2,"T")
 ;;=1
 ;;^UTILITY(U,$J,"DIBT",614,0)
 ;;=DVBA ADMISSION REVIEW^2910122.1224^^405^^^^
 ;;^UTILITY(U,$J,"DIBT",614,2,1)
 ;;=405^.01^DATE/TIME^@^

DVBAI01M
DVBAI01M ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"DIBT",614,2,1,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",614,2,1,"F")
 ;;=2010100.99999
 ;;^UTILITY(U,$J,"DIBT",614,2,1,"IX")
 ;;=^DGPM("B",^DGPM(^2
 ;;^UTILITY(U,$J,"DIBT",614,2,1,"T")
 ;;=2910122.9999
 ;;^UTILITY(U,$J,"DIBT",614,2,2)
 ;;=405^^TRANSACTION^@".02^
 ;;^UTILITY(U,$J,"DIBT",614,2,2,"CM")
 ;;=S Y(1)=$S($D(^DGPM(D0,0)):^(0),1:"") S X=$S('$D(^DG(405.3,+$P(Y(1),U,2),0)):"",1:$P(^(0),U,1)) I D0>0 S X(2)=X
 ;;^UTILITY(U,$J,"DIBT",614,2,2,"F")
 ;;=ADMISSIOMz
 ;;^UTILITY(U,$J,"DIBT",614,2,2,"T")
 ;;=ADMISSION
 ;;^UTILITY(U,$J,"DIBT",615,0)
 ;;=DVBA C EXAM CHECKLIST^2900423.1444^^396.6^^^^
 ;;^UTILITY(U,$J,"DIBT",615,2,1)
 ;;=396.6^^BODY SYSTEM^"2^;S2;C1
 ;;^UTILITY(U,$J,"DIBT",615,2,1,"CM")
 ;;=S Y(1)=$S($D(^DVB(396.6,D0,0)):^(0),1:"") S X=$S('$D(^DVB(396.7,+$P(Y(1),U,3),0)):"",1:$P(^(0),U,1)) I D0>0 S X(1)=X
 ;;^UTILITY(U,$J,"DIBT",615,2,2)
 ;;=396.6^.01^NAME^^
 ;;^UTILITY(U,$J,"DIBT",615,2,2,"IX")
 ;;=^DVB(396.6,"B",^DVB(396.6,^2
 ;;^UTILITY(U,$J,"DIBT",615,"%D",0)
 ;;=^^1^1^2930623^^^
 ;;^UTILITY(U,$J,"DIBT",615,"%D",1,0)
 ;;=Generates checklist for proofing new or old exam data that was entered.
 ;;^UTILITY(U,$J,"DIBT",616,0)
 ;;=DVBA C EXAM LAYOUT^2900309.1016^^396.6^^^^
 ;;^UTILITY(U,$J,"DIBT",616,2,1)
 ;;=396.6^.01^NAME^^;S2
 ;;^UTILITY(U,$J,"DIBT",616,2,1,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",616,2,1,"F")
 ;;=    
 ;;^UTILITY(U,$J,"DIBT",616,2,1,"IX")
 ;;=^DVB(396.6,"B",^DVB(396.6,^2
 ;;^UTILITY(U,$J,"DIBT",616,2,1,"T")
 ;;=ZZZZ
 ;;^UTILITY(U,$J,"DIBT",616,2,2)
 ;;=396.65^.01^LINE NUMBER^^
 ;;^UTILITY(U,$J,"DIBT",616,2,2,396.6)
 ;;=2
 ;;^UTILITY(U,$J,"DIBT",616,"%D",0)
 ;;=^^1^1^2930319^^
 ;;^UTILITY(U,$J,"DIBT",616,"%D",1,0)
 ;;=Shows how exam lines are laid out for printing.
 ;;^UTILITY(U,$J,"DIBT",617,0)
 ;;=DVBA C REQUESTS BY DATE RANGE^2900720.1334^^396.3^^^^
 ;;^UTILITY(U,$J,"DIBT",617,2,1)
 ;;=396.3^1^REQUEST DATE^@^
 ;;^UTILITY(U,$J,"DIBT",617,2,1,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",617,2,1,"F")
 ;;=2900100.99999
 ;;^UTILITY(U,$J,"DIBT",617,2,1,"IX")
 ;;=^DVB(396.3,"C",^DVB(396.3,^2
 ;;^UTILITY(U,$J,"DIBT",617,2,1,"T")
 ;;=2900720.9999
 ;;^UTILITY(U,$J,"DIBT",617,2,2)
 ;;=396.3^^NAME^".01^
 ;;^UTILITY(U,$J,"DIBT",617,2,2,"CM")
 ;;=S Y(1)=$S($D(^DVB(396.3,D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) I D0>0 S X(2)=X
 ;;^UTILITY(U,$J,"DIBT",799,0)
 ;;=DVBA C REQUESTS BY PHYSICIAN^2930519.1524^^396.4^^^^
 ;;^UTILITY(U,$J,"DIBT",799,2,1)
 ;;=396.4^.06^DATE OF EXAM^@^
 ;;^UTILITY(U,$J,"DIBT",799,2,1,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",799,2,1,"F")
 ;;=2930519.15209^N
 ;;^UTILITY(U,$J,"DIBT",799,2,1,"T")
 ;;=z^
 ;;^UTILITY(U,$J,"DIBT",799,2,2)
 ;;=396.4^^2507 REQUEST:NAME^@"^
 ;;^UTILITY(U,$J,"DIBT",799,2,2,"CM")
 ;;=X DPP(2,"OVF0",9.2) S X=$S('$D(^DPT(+$P(Y(101),U,1),0)):"",1:$P(^(0),U,1)) S D0=I(0,0) I D0>0 S X(2)=X
 ;;^UTILITY(U,$J,"DIBT",799,2,2,"OVF0",9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^DVB(396.4,D0,0)):^(0),1:""),D0=$P(Y(1),U,2) S:'$D(^DVB(396.3,+D0,0)) D0=-1 S Y(101)=$S($D(^DVB(396.3,D0,0)):^(0),1:"")
 ;;^UTILITY(U,$J,"DIBT",799,2,3)
 ;;=396.4^^2507 REQUEST:REGIONAL OFFICE NUMBER^@"^;"REGIONAL OFFICE NUMBER"
 ;;^UTILITY(U,$J,"DIBT",799,2,3,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",799,2,3,"CM")
 ;;=X DPP(3,"OVF0",9.2) S X=$S('$D(^DIC(4,+$P(Y(101),U,3),0)):"",1:$P(^(0),U,1)) S D0=I(0,0) I D0>0 S X(3)=X
 ;;^UTILITY(U,$J,"DIBT",799,2,3,"F")
 ;;=499.99999^500
 ;;^UTILITY(U,$J,"DIBT",799,2,3,"OVF0",9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),Y(1)=$S($D(^DVB(396.4,D0,0)):^(0),1:""),D0=$P(Y(1),U,2) S:'$D(^DVB(396.3,+D0,0)) D0=-1 S Y(101)=$S($D(^DVB(396.3,D0,0)):^(0),1:"")
 ;;^UTILITY(U,$J,"DIBT",799,2,3,"T")
 ;;=z^
 ;;^UTILITY(U,$J,"DIBT",799,2,4)
 ;;=396.4^.07^EXAMINING PHYSICIAN^@^
 ;;^UTILITY(U,$J,"DIBT",799,2,4,"ASK")
 ;;=
 ;;^UTILITY(U,$J,"DIBT",799,2,4,"F")
 ;;=BILKz^BILL
 ;;^UTILITY(U,$J,"DIBT",799,2,4,"T")
 ;;=z^
 ;;^UTILITY(U,$J,"DIBT",920,0)
 ;;=DVBA NOTICE OF DISCHARGE^2940915.0824^^396^^^^
 ;;^UTILITY(U,$J,"DIBT",920,2,1)
 ;;=396^^PATIENT NAME^".01^
 ;;^UTILITY(U,$J,"DIBT",920,2,1,"CM")
 ;;=S Y(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) I D0>0 S X(1)=X
 ;;^UTILITY(U,$J,"DIBT",920,2,2)
 ;;=396^^NOTICE OF DISCHARGE="YES"^"@B^;L1
 ;;^UTILITY(U,$J,"DIBT",920,2,2,"CM")
 ;;=S Y(2)=$C(59)_$S($D(^DD(396,4,0)):$P(^(0),U,3),1:""),Y(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,5)_":",2),$C(59),1)="YES" I D0>0 S X(2)=X
 ;;^UTILITY(U,$J,"DIBT",920,2,2,"F")
 ;;=0
 ;;^UTILITY(U,$J,"DIBT",920,2,2,"T")
 ;;=1
 ;;^UTILITY(U,$J,"DIBT",921,0)
 ;;=DVBA 21 DAY CERT^2940915.0836^^396^^^^

DVBAI01N
DVBAI01N ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"DIBT",921,2,1)
 ;;=396^^PATIENT NAME^".01^
 ;;^UTILITY(U,$J,"DIBT",921,2,1,"CM")
 ;;=S Y(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(Y(1),U,1),0)):"",1:$P(^(0),U,1)) I D0>0 S X(1)=X
 ;;^UTILITY(U,$J,"DIBT",921,2,2)
 ;;=396^^CERTIFICATE (21-DAY)="YES"^"@B^;L1
 ;;^UTILITY(U,$J,"DIBT",921,2,2,"CM")
 ;;=S Y(2)=$C(59)_$S($D(^DD(396,6,0)):$P(^(0),U,3),1:""),Y(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,7)_":",2),$C(59),1)="YES" I D0>0 S X(2)=X
 ;;^UTILITY(U,$J,"DIBT",921,2,2,"F")
 ;;=0
 ;;^UTILITY(U,$J,"DIBT",921,2,2,"T")
 ;;=1
 ;;^UTILITY(U,$J,"DIE",987,0)
 ;;=DVBA ELIGIBILITY EDIT^2890922^^2^^^^
 ;;^UTILITY(U,$J,"DIE",987,"DR",1,2)
 ;;=.293;
 ;;^UTILITY(U,$J,"DIE",989,0)
 ;;=DVBA STATUS EDIT^2930125.1147^^396^^^^
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396)
 ;;=S CODE=$P(^DVB(396,D0,0),U,9) S:CODE="" Y="@2" S:DVBACORR="N"&(CODE'="P") Y="@2";4.5;S DVBASTAT=X S:X="C" Y="@1";S DVBADT=$P(^DVB(396,D0,0),U,10) S:DVBADT=""&(X="P") Y="@2";4.8///@;S Y="@2";@1;4.9////^S X=OPER;4.8;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,1)
 ;;=I X=""&(DVBASTAT="C") W !!,"Completed status must have date.",*7,!! S Y="@1";@2;S CODE=$P(^DVB(396,D0,0),U,11) S:CODE="" Y="@4" S:DVBACORR="N"&(CODE'="P") Y="@4";5.5;S DVBASTAT=X S:X="C" Y="@3";
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,2)
 ;;=S DVBADT=$P(^DVB(396,D0,0),U,12) S:DVBADT=""&(X="P") Y="@4";5.8///@;S Y="@4";@3;5.9////^S X=OPER;5.8;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@3";@4;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,3)
 ;;=S CODE=$P(^DVB(396,D0,0),U,13) S:CODE="" Y="@6" S:DVBACORR="N"&(CODE'="P") Y="@6";6.5;S DVBASTAT=X S:X="C" Y="@5";S DVBADT=$P(^DVB(396,D0,0),U,14) S:DVBADT=""&(X="P") Y="@6";6.8///@;S Y="@6";@5;6.9////^S X=OPER;6.8;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,4)
 ;;=I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@5";@6;S CODE=$P(^DVB(396,D0,0),U,15) S:CODE="" Y="@8" S:DVBACORR="N"&(CODE'="P") Y="@8";8;S DVBASTAT=X S:X="C" Y="@7";
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,5)
 ;;=S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,2),1:"") S:DVBADT=""&(X="P") Y="@8";8.5///@;S Y="@8";@7;8.7////^S X=OPER;8.5;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@7";@8;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,6)
 ;;=S CODE=$P(^DVB(396,D0,0),U,17) S:CODE="" Y="@10" S:DVBACORR="N"&(CODE'="P") Y="@10";10;S DVBASTAT=X S:X="C" Y="@9";S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,3),1:"") S:DVBADT=""&(X="P") Y="@10";10.5///@;S Y="@10";@9;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,7)
 ;;=10.7////^S X=OPER;10.5;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@9";@10;S CODE=$P(^DVB(396,D0,0),U,19) S:CODE="" Y="@12" S:DVBACORR="N"&(CODE'="P") Y="@12";12;S DVBASTAT=X S:X="C" Y="@11";
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,8)
 ;;=S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,4),1:"") S:X="P"&(DVBADT="") Y="@12";12.5///@;S Y="@12";@11;12.7////^S X=OPER;12.5;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@11";@12;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,9)
 ;;=S CODE=$P(^DVB(396,D0,0),U,21) S:CODE="" Y="@14" S:DVBACORR="N"&(CODE'="P") Y="@14";14;S DVBASTAT=X S:X="C" Y="@13";S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,5),1:"") S:X="P"&(DVBADT="") Y="@14";14.5///@;S Y="@14";@13;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,10)
 ;;=14.7////^S X=OPER;14.5;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@13";@14;S CODE=$P(^DVB(396,D0,0),U,23) S:CODE="" Y="@16" S:DVBACORR="N"&(CODE'="P") Y="@16";16;S DVBASTAT=X S:X="C" Y="@15";
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,11)
 ;;=S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,6),1:"") S:X="P"&(DVBADT="") Y="@16";16.5///@;S Y="@16";@15;16.7////^S X=OPER;16.5;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@15";@16;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,12)
 ;;=S CODE=$S($D(^DVB(396,D0,1)):$P(^(1),U,7),1:"") S:CODE="" Y="@18" S:DVBACORR="N"&(CODE'="P") Y="@18";17.4;S DVBASTAT=X S:X="C" Y="@17";S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,8),1:"") S:X="P"&(DVBADT="") Y="@18";17.8///@;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,13)
 ;;=S Y="@18";@17;17.9////^S X=OPER;17.8;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@17";@18;S CODE=$P(^DVB(396,D0,0),U,26) S:CODE="" Y="@20" S:DVBACORR="N"&(CODE'="P") Y="@20";19;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,14)
 ;;=S DVBASTAT=X S:X="C" Y="@19";S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,9),1:"") S:X="P"&(DVBADT="") Y="@20";19.5///@;S Y="@20";@19;19.7////^S X=OPER;19.5;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@19";

DVBAI01O
DVBAI01O ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,15)
 ;;=@20;S CODE=$P(^DVB(396,D0,0),U,28) S:CODE="" Y="@22" S:DVBACORR="N"&(CODE'="P") Y="@22";21;S DVBASTAT=X S:X="C" Y="@21";S DVBADT=$S($D(^DVB(396,D0,1)):$P(^(1),U,10),1:"") S:X="P"&(DVBADT="") Y="@22";21.5///@;S Y="@22";@21;
 ;;^UTILITY(U,$J,"DIE",989,"DR",1,396,16)
 ;;=21.7////^S X=OPER;21.5;I X=""&(DVBASTAT="C") W *7,!!,"Completed status must have date.",!! S Y="@21";@22;
 ;;^UTILITY(U,$J,"DIE",989,"ROU")
 ;;=^DVBAXS
 ;;^UTILITY(U,$J,"DIE",989,"ROUOLD")
 ;;=DVBAXS
 ;;^UTILITY(U,$J,"DIE",990,0)
 ;;=DVBA EDIT REMARKS^2930125.0856^^396^^^^
 ;;^UTILITY(U,$J,"DIE",990,"DR",1,396)
 ;;=.5;
 ;;^UTILITY(U,$J,"DIE",992,0)
 ;;=DVBA SITE EDIT^2941021.1548^^396.1^^^^
 ;;^UTILITY(U,$J,"DIE",992,"DR",1,396.1)
 ;;=.01:10;11;12;14:17;
 ;;^UTILITY(U,$J,"DIE",992,"DR",2,396.115)
 ;;=.01
 ;;^UTILITY(U,$J,"DIE",992,"DR",2,396.12)
 ;;=.01
 ;;^UTILITY(U,$J,"DIE",992,"DR",2,396.13)
 ;;=.01;1;
 ;;^UTILITY(U,$J,"DIE",992,"DR",2,396.14)
 ;;=.01;1;
 ;;^UTILITY(U,$J,"DIE",993,0)
 ;;=DVBA C ADD 2507 PAT^2941107.1519^^2^^^^
 ;;^UTILITY(U,$J,"DIE",993,"%D",0)
 ;;=^^1^1^2930608^^^^
 ;;^UTILITY(U,$J,"DIE",993,"%D",1,0)
 ;;=Allows checking for new 2507 veterans in file #2.
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",1,0,2,1)
 ;;=.111;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",4,0,2,1)
 ;;=.114;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",5,0,2,0)
 ;;=.02;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",5,0,2,1)
 ;;=.115;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",6,0,2,0)
 ;;=.09;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",6,0,2,1)
 ;;=.1112;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",7,0,2,0)
 ;;=.313;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",7,0,2,1)
 ;;=.117;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",8,0,2,0)
 ;;=.314;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",13,0,2,0)
 ;;=.361;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",14,0,2,0)
 ;;=.525;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DIAB",15,0,2,0)
 ;;=.323;REQ
 ;;^UTILITY(U,$J,"DIE",993,"DR",1,2)
 ;;=I '$D(IOF) S IOP="HOME" D ^%ZIS K IOP;W @IOF,!,"Please review previous information entered as well as",!,"entering additional REQUIRED information:",!!!;@1;.01;.02R~;.09R~;.313R~;.314R~;.301;.302;391;1901;.361R~;.525R~;.323R~;
 ;;^UTILITY(U,$J,"DIE",993,"DR",1,2,1)
 ;;=.111R~;.112;.113;.114R~;.115R~;.1112R~;.117R~;.131;.132;.326;.327;@2;W *7,!!,"Need to edit the information you've just entered" S %=1 D YN^DICN;
 ;;^UTILITY(U,$J,"DIE",993,"DR",1,2,2)
 ;;=I $D(%Y) I %Y["?" W !!,"Enter Y to go back and correct any errors or ",!,"you may enter N to proceed." S Y="@2";I $D(%),%=1 W @IOF,! S Y="@1";K %,%Y;
 ;;^UTILITY(U,$J,"DIE",993,"ROU")
 ;;=^DVBAXA
 ;;^UTILITY(U,$J,"DIE",993,"ROUOLD")
 ;;=DVBAXA
 ;;^UTILITY(U,$J,"DIPT",792,0)
 ;;=DVBA STATUS^2950214.1031^^396^^^^
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",1,9.2)
 ;;=S DIP(2)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=" Patient Name: ",DIP(1)=X S X=$S('$D(^DPT(+$P(DIP(2),U,1),0)):"",1:$P(^(0),U,1)),DIP(3)=X S X=1,DIP(4)=X S X=25
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",2,9)
 ;;=X DXS(2,9.2) S X=X="ACTIVITY DATE",DIP(3)=X S X=" Activity",DIP(4)=X S X=1,DIP(5)=X S X="Admission",X=$S(DIP(3):DIP(4),DIP(5):X)_" Date:"
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",2,9.2)
 ;;=S DIP(2)=$C(59)_$S($D(^DD(396,30,0)):$P(^(0),U,3),1:""),DIP(1)=$S($D(^DVB(396,D0,2)):^(2),1:"") S X=$P($P(DIP(2),$C(59)_$P(DIP(1),U,10)_":",2),$C(59),1)
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",3,9)
 ;;=S FINALDTE=$P(^DVB(396,D0,1),U,12) W:FINALDTE'="" ?45,"FINALIZED BY: ",$P(^DVB(396,D0,2),U,6),!,?56,"ON: ",$E(FINALDTE,4,5)_"/"_$E(FINALDTE,6,7)_"/"_$E(FINALDTE,2,3)
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",4,9)
 ;;=S:FINALDTE="" ZDAT=$P(^DVB(396,D0,1),U,1),ZDAT1=$P(^DVB(396,D0,1),U,11) W:FINALDTE="" ?49,"Date of Request: ",$E(ZDAT,4,5)_"/"_$E(ZDAT,6,7)_"/"_$E(ZDAT,2,3)
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",5,9)
 ;;=W:FINALDTE="" ?49,"Date Last Edited: ",$E(ZDAT1,4,5)_"/"_$E(ZDAT1,6,7)_"/"_$E(ZDAT1,2,3)
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",6,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",6,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",7,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",7,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",8,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",8,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",9,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",9,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",10,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",10,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",11,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",11,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",12,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",12,"P")
 ;;=PENDING

DVBAI01P
DVBAI01P ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",13,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",13,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",14,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",14,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",15,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",15,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",16,"C")
 ;;=COMPLETED
 ;;^UTILITY(U,$J,"DIPT",792,"DXS",16,"P")
 ;;=PENDING
 ;;^UTILITY(U,$J,"DIPT",792,"F",1)
 ;;=X DXS(1,9.2) S X=$E(DIP(3),DIP(4),X) S Y=X,X=DIP(1),X=X_Y W X K DIP;Y1;Z;"" Patient Name: "_$E(PATIENT NAME,1,25)"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",2)
 ;;=X DXS(2,9) W X K DIP;C42;Y1;Z;"$S(DOCUMENT TYPE="ACTIVITY DATE":" Activity",1:"Admission")_" Date:""~
 ;;^UTILITY(U,$J,"DIPT",792,"F",3)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$P(DIP(1),U,4) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;C58;Y1;Z;"NUMDATE(ADMISSION DATE)"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",4)
 ;;=X $P(^DD(396,2,0),U,5,99) S DIP(1)=X S X="SSN: "_DIP(1) W X K DIP;Y2;C11;Z;""SSN: "_SOC SEC NUMBER"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",5)
 ;;=X $P(^DD(396,1,0),U,5,99) S DIP(1)=X S X="Claim Number: "_DIP(1) W X K DIP;C44;Y2;Z;""Claim Number: "_C-NUMBER"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",6)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,2)):^(2),1:"") S X="Receiving Div: "_$S('$D(^DG(40.8,+$P(DIP(1),U,9),0)):"",1:$P(^(0),U,1)) W X K DIP;Y3;Z;""Receiving Div: "_DIVISION"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",7)
 ;;="Requisition";Y4;C5~"Status";C23~"Status Date";C35~"Operator";C50~"Current Division";C62~
 ;;^UTILITY(U,$J,"DIPT",792,"F",8)
 ;;="---------------------------------------------------------------------------"~"Notice/Discharge:";C3;Y6~4.5;C23~4.8;C35~4.9;C50;L11~4.6;C62;L16~
 ;;^UTILITY(U,$J,"DIPT",792,"F",9)
 ;;="Hospital Summary:";Y7;C3~5.5;C23~5.8;C35~5.9;C50;L11~5.6;C62;L16~"21-day Certificate:";Y8~6.5;C23~6.8;C35~6.9;C50;L11~6.6;C62;L16~"Other/Exam:";Y9;C9~
 ;;^UTILITY(U,$J,"DIPT",792,"F",10)
 ;;=8;C23~8.5;C35~8.7;C50;L11~7.6;C62;L16~"Special Report:";Y10;C5~10;C23~10.5;C35~10.7;C50;L11~9.6;C62;L16~"Competency Report:";Y11;C2~12;C23~12.5;C35~
 ;;^UTILITY(U,$J,"DIPT",792,"F",11)
 ;;=12.7;C50;L11~11.6;C62;L16~"Form 21-2680:";Y12;C7~14;C23~14.5;C35~14.7;C50;L11~13.6;C62;L16~"Asset Information:";Y13;C2~16;C23~16.5;C35~16.7;C50;L11~
 ;;^UTILITY(U,$J,"DIPT",792,"F",12)
 ;;=15.6;C62;L16~"Admission Report:";Y14;C3~17.4;C23~17.8;C35~17.9;C50;L11~17.6;C62;L16~"OPT Treatment Rpt:";Y15;C2~19;C23~19.5;C35~19.7;C50;L11~
 ;;^UTILITY(U,$J,"DIPT",792,"F",13)
 ;;=18.6;C62;L16~"Beg Date/Care:";Y16;C6~21;C23~21.5;C35~21.7;C50;L11~20.6;C62;L16~"REMARKS:";Y18~.5,.01;C11~"Requesting location: ";C0;Y20~
 ;;^UTILITY(U,$J,"DIPT",792,"F",14)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,2)):^(2),1:"") S X=$P(DIP(1),U,7),DIP(2)=X S X=1,DIP(3)=X S X=20,X=$E(DIP(2),DIP(3),X) W X K DIP;C23;Z;"$E(REQUESTING LOCATION,1,20)"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",15)
 ;;=X DXS(3,9);Z;"S FINALDTE=$P(^DVB(396,D0,1),U,12) W:FINALDTE'="" ?45,"FINALIZED BY: ",$P(^DVB(396,D0,2),U,6),!,?56,"ON: ",$E(FINALDTE,4,5)_"/"_$E(FINALDTE,6,7)_"/"_$E(FINALDTE,2,3)"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",16)
 ;;=X DXS(4,9);Z;"S:FINALDTE="" ZDAT=$P(^DVB(396,D0,1),U,1),ZDAT1=$P(^DVB(396,D0,1),U,11) W:FINALDTE="" ?49,"Date of Request: ",$E(ZDAT,4,5)_"/"_$E(ZDAT,6,7)_"/"_$E(ZDAT,2,3)"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",17)
 ;;="Requested by: ";C8;Y21~
 ;;^UTILITY(U,$J,"DIPT",792,"F",18)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,2)):^(2),1:"") S X=$P(DIP(1),U,8),DIP(2)=X S X=1,DIP(3)=X S X=25,X=$E(DIP(2),DIP(3),X) W X K DIP;C23;Z;"$E(REQUESTED BY,1,25)"~
 ;;^UTILITY(U,$J,"DIPT",792,"F",19)
 ;;=X DXS(5,9);Z;"W:FINALDTE="" ?49,"Date Last Edited: ",$E(ZDAT1,4,5)_"/"_$E(ZDAT1,6,7)_"/"_$E(ZDAT1,2,3)"~
 ;;^UTILITY(U,$J,"DIPT",792,"H")
 ;;=@
 ;;^UTILITY(U,$J,"DIPT",792,"IOM")
 ;;=80
 ;;^UTILITY(U,$J,"DIPT",792,"LAST")
 ;;=1
 ;;^UTILITY(U,$J,"DIPT",792,"ROU")
 ;;=^DVBAXP
 ;;^UTILITY(U,$J,"DIPT",792,"ROUOLD")
 ;;=DVBAXP
 ;;^UTILITY(U,$J,"DIPT",792,"SUB")
 ;;=1
 ;;^UTILITY(U,$J,"DIPT",793,0)
 ;;=DVBA INCOMP REQ REPORT^2890907^^396^^^^
 ;;^UTILITY(U,$J,"DIPT",793,"DCL","396^-1")
 ;;=!
 ;;^UTILITY(U,$J,"DIPT",793,"DXS",1,9)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(DIP(1),U,1),0)):"",1:$P(^(0),U,1)),DIP(2)=X S X=1,DIP(3)=X S X=15,X=$E(DIP(2),DIP(3),X)
 ;;^UTILITY(U,$J,"DIPT",793,"F",1)
 ;;=X DXS(1,9) W X K DIP;"PATIENT NAME";C0;Z;"$E(PATIENT NAME,1,15)"~2;C18;L11~
 ;;^UTILITY(U,$J,"DIPT",793,"F",2)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,1)):^(1),1:"") S X=$P(DIP(1),U,1) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3);"DATE OF REQUEST";;;Z;"NUMDATE(DATE OF REQUEST)";!~

DVBAI01Q
DVBAI01Q ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"DIPT",793,"F",3)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,2)):^(2),1:"") S X=$P(DIP(1),U,7),DIP(2)=X S X=1,DIP(3)=X S X=12,X=$E(DIP(2),DIP(3),X) W X K DIP;"REQUESTING LOCATION";Z;"$E(REQUESTING LOCATION,1,12)"~
 ;;^UTILITY(U,$J,"DIPT",793,"F",4)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,2)):^(2),1:"") S X=$P(DIP(1),U,8),DIP(2)=X S X=1,DIP(3)=X S X=15,X=$E(DIP(2),DIP(3),X) W X K DIP;"REQUESTED BY";Z;"$E(REQUESTED BY,1,15)"~
 ;;^UTILITY(U,$J,"DIPT",793,"H")
 ;;=A.M.I.E. Incomplete Request Report
 ;;^UTILITY(U,$J,"DIPT",794,0)
 ;;=DVBA FINALIZED REPORT^2921230.0837^^396^^^^
 ;;^UTILITY(U,$J,"DIPT",794,"DCL","396^-1")
 ;;=&
 ;;^UTILITY(U,$J,"DIPT",794,"DXS",1,9)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$S('$D(^DPT(+$P(DIP(1),U,1),0)):"",1:$P(^(0),U,1)),DIP(2)=X S X=1,DIP(3)=X S X=15,X=$E(DIP(2),DIP(3),X)
 ;;^UTILITY(U,$J,"DIPT",794,"DXS",2,9)
 ;;=X DXS(2,9.2) S D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S DIP(201)=$S($D(^DPT(D0,0)):^(0),1:"") S X=$P(DIP(201),U,9) S D0=I(0,0)
 ;;^UTILITY(U,$J,"DIPT",794,"DXS",2,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S I(100,0)=$S($D(D0):D0,1:"")
 ;;^UTILITY(U,$J,"DIPT",794,"F",1)
 ;;=X DXS(1,9) W X K DIP;"PATIENT NAME";!;C0;Z;"$E(PATIENT NAME,1,15)"~
 ;;^UTILITY(U,$J,"DIPT",794,"F",2)
 ;;=X DXS(2,9) W X K DIP;"SSN";C18;Z;"PATIENT NAME IN PATIENT FILE:SOCIAL SECURITY NUMBER"~
 ;;^UTILITY(U,$J,"DIPT",794,"F",3)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,2)):^(2),1:"") S X=$P(DIP(1),U,7),DIP(2)=X S X=1,DIP(3)=X S X=15,X=$E(DIP(2),DIP(3),X) W X K DIP;"REQUESTING VARO";C36;Z;"$E(REQUESTING LOCATION,1,15)"~
 ;;^UTILITY(U,$J,"DIPT",794,"F",4)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,1)):^(1),1:"") S X=$P(DIP(1),U,12),X1=X,X2=$P(DIP(1),U,1),X="" D:X2 ^%DTC:X1;"TOTAL DAYS TO PROCESS";C54;;;Z;"FINALIZATION DATE-DATE OF REQUEST";&~
 ;;^UTILITY(U,$J,"DIPT",794,"F",5)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,1)):^(1),1:"") S X=$P(DIP(1),U,1) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;"DATE OF REQUEST";Z;"NUMDATE(DATE OF REQUEST)"~
 ;;^UTILITY(U,$J,"DIPT",794,"F",6)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,1)):^(1),1:"") S X=$P(DIP(1),U,12) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;"FINAL DATE";Z;"NUMDATE(FINALIZATION DATE)"~
 ;;^UTILITY(U,$J,"DIPT",794,"F",7)
 ;;=26;L15~
 ;;^UTILITY(U,$J,"DIPT",794,"H")
 ;;=A.M.I.E. Finalized Report
 ;;^UTILITY(U,$J,"DIPT",794,"IOM")
 ;;=132
 ;;^UTILITY(U,$J,"DIPT",794,"LAST")
 ;;=
 ;;^UTILITY(U,$J,"DIPT",794,"ROU")
 ;;=^DVBAXF
 ;;^UTILITY(U,$J,"DIPT",794,"ROUOLD")
 ;;=DVBAXF
 ;;^UTILITY(U,$J,"DIPT",794,"STATS","S",1)
 ;;=0
 ;;^UTILITY(U,$J,"DIPT",794,"T",53)
 ;;=9^1^0^C0^
 ;;^UTILITY(U,$J,"DIPT",795,0)
 ;;=DVBA NOT/DIS-21 DAY CERT CHECK^2930120.1513^^396^^^^
 ;;^UTILITY(U,$J,"DIPT",795,"DXS",1,9)
 ;;=X DXS(1,9.2) S D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S DIP(201)=$S($D(^DPT(D0,0)):^(0),1:"") S X=$P(DIP(201),U,9) S D0=I(0,0)
 ;;^UTILITY(U,$J,"DIPT",795,"DXS",1,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S I(100,0)=$S($D(D0):D0,1:"")
 ;;^UTILITY(U,$J,"DIPT",795,"F",1)
 ;;=.01;L20~X DXS(1,9) W X K DIP;"SSN";Z;"PATIENT NAME IN PATIENT FILE:SOCIAL SECURITY NUMBER"~4;L7;"NOT/DIS REQ?"~
 ;;^UTILITY(U,$J,"DIPT",795,"F",2)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$P(DIP(1),U,10) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;L8;"NT/DIS COMP DATE";Z;"NUMDATE(NOTICE/DISCHG COMPLETION DATE)"~
 ;;^UTILITY(U,$J,"DIPT",795,"F",3)
 ;;=4.5;L8;"NOT/DIS STATUS"~4.9;"NOT/DIS COMPLETED BY";L15~6;"21-DAY CERT REQ?";L7~
 ;;^UTILITY(U,$J,"DIPT",795,"F",4)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$P(DIP(1),U,14) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;"21-DAY CERT COMP DATE";L10;Z;"NUMDATE(#6.8)"~
 ;;^UTILITY(U,$J,"DIPT",795,"F",5)
 ;;=6.5;L12;"21-DAY STATUS"~6.9;L15;"21-DAY CERT COMPLETED BY"~
 ;;^UTILITY(U,$J,"DIPT",795,"H")
 ;;=Notice of Discharge/21-day certificate Follow-up Listing
 ;;^UTILITY(U,$J,"DIPT",796,0)
 ;;=DVBA ADMISSION REVIEW^2910122.1223^^405^^^^
 ;;^UTILITY(U,$J,"DIPT",796,"F",1)
 ;;=-2,^DPT(^^S I(0,0)=D0 S DIP(1)=$S($D(^DGPM(D0,0)):^(0),1:"") S X=$P(DIP(1),U,3),X=X S D(0)=+X;Z;"PATIENT:"~-2,.01;L25~-2,.09;L12~-2,.312;"C-FOLD LOC";L3~
 ;;^UTILITY(U,$J,"DIPT",796,"F",2)
 ;;=-2,.361;L27~-2,.3611;L15~
 ;;^UTILITY(U,$J,"DIPT",796,"F",3)
 ;;=-2,S DIP(101)=$S($D(^DPT(D0,.361)):^(.361),1:"") S X=$P(DIP(101),U,2) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;L8;"ELIG STATUS DATE";Z;"NUMDATE(ELIGIBILITY STATUS DATE)"~

DVBAI01R
DVBAI01R ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"DIPT",796,"F",4)
 ;;=-2,.301;L3;"SC?~-2,.36205;"A&A";L3~-2,.36235;L3;"PEN"~-2,.293~
 ;;^UTILITY(U,$J,"DIPT",796,"H")
 ;;=PATIENT MOVEMENT LIST
 ;;^UTILITY(U,$J,"DIPT",797,0)
 ;;=DVBA C EXAM CHECKLIST^2900524.1114^^396.6^^^^
 ;;^UTILITY(U,$J,"DIPT",797,"F",2)
 ;;="(  )";C0;S1~S DIP(1)=$S($D(^DVB(396.6,D0,0)):^(0),1:"") S X=$P(DIP(1),U,1) W ?($S($X>5:50,1:10)),X W X K DIP;Z;"DVBC SPLIT COL(NAME)"~
 ;;^UTILITY(U,$J,"DIPT",797,"H")
 ;;=[DVBC EXAM CHECKLIST HEADER]
 ;;^UTILITY(U,$J,"DIPT",798,0)
 ;;=DVBA C EXAM CHECKLIST HEADER^2900123^^396.6^^^^
 ;;^UTILITY(U,$J,"DIPT",798,"F",1)
 ;;="Regional Office Compensation and Pension Exam Order Form"~
 ;;^UTILITY(U,$J,"DIPT",798,"F",2)
 ;;="Veteran name: ___________________________________________     Location: ______________________________";S1~
 ;;^UTILITY(U,$J,"DIPT",798,"F",3)
 ;;="Date ordered: __________________     By: ____________________________";S1~
 ;;^UTILITY(U,$J,"DIPT",798,"F",4)
 ;;="Entered by: ________________________________________     Date: __________________";S1~
 ;;^UTILITY(U,$J,"DIPT",798,"H")
 ;;=@
 ;;^UTILITY(U,$J,"DIPT",798,"SUB")
 ;;=1
 ;;^UTILITY(U,$J,"DIPT",799,0)
 ;;=DVBA C EXAM LAYOUT^2900220.1132^^396.6^^^^
 ;;^UTILITY(U,$J,"DIPT",799,"F",2)
 ;;=5,.01~5,1~5,2~5,5~5,3~5,4~
 ;;^UTILITY(U,$J,"DIPT",799,"H")
 ;;=2507 EXAM LAYOUT LISTING
 ;;^UTILITY(U,$J,"DIPT",800,0)
 ;;=DVBA C CHECK DR STRING^2900412.1639^^396.6^^^^
 ;;^UTILITY(U,$J,"DIPT",800,"F",2)
 ;;=4~S X="_",DIP(1)=X S X=125,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;S2;Z;"DUP("_",125)"~
 ;;^UTILITY(U,$J,"DIPT",800,"H")
 ;;=2507 DR STRING CHECK LIST
 ;;^UTILITY(U,$J,"DIPT",801,0)
 ;;=DVBA C REQUESTS BY DATE RANGE^2921230.1131^^396.3^^^^
 ;;^UTILITY(U,$J,"DIPT",801,"DXS",1,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396.3,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S DIP(101)=$S($D(^DPT(D0,0)):^(0),1:"")
 ;;^UTILITY(U,$J,"DIPT",801,"F",1)
 ;;=.01;L30~X DXS(1,9.2) S X=$P(DIP(101),U,9) S D0=I(0,0) W X K DIP;"SSN";L11;Z;"NAME:SOCIAL SECURITY NUMBER"~
 ;;^UTILITY(U,$J,"DIPT",801,"F",2)
 ;;=S DIP(1)=$S($D(^DVB(396.3,D0,0)):^(0),1:"") S X=$P(DIP(1),U,2) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;"REQUEST DATE";Z;"NUMDATE(REQUEST DATE)"~
 ;;^UTILITY(U,$J,"DIPT",801,"F",3)
 ;;=3;L20~
 ;;^UTILITY(U,$J,"DIPT",801,"H")
 ;;=2507 REQUEST LIST
 ;;^UTILITY(U,$J,"DIPT",1051,0)
 ;;=DVBA C REQUESTS BY PHYSICIAN^2930304.094^^396.4^^^^
 ;;^UTILITY(U,$J,"DIPT",1051,"DXS",1,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396.4,D0,0)):^(0),1:""),D0=$P(DIP(1),U,2) S:'$D(^DVB(396.3,+D0,0)) D0=-1 S DIP(101)=$S($D(^DVB(396.3,D0,0)):^(0),1:"")
 ;;^UTILITY(U,$J,"DIPT",1051,"DXS",2,9)
 ;;=X DXS(2,9.2) S DIP(101)=$S($D(^DVB(396.3,D0,0)):^(0),1:""),D0=$P(DIP(101),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S DIP(201)=$S($D(^DPT(D0,0)):^(0),1:"") S X=$P(DIP(201),U,9) S D0=I(0,0)
 ;;^UTILITY(U,$J,"DIPT",1051,"DXS",2,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396.4,D0,0)):^(0),1:""),D0=$P(DIP(1),U,2) S:'$D(^DVB(396.3,+D0,0)) D0=-1 S I(100,0)=$S($D(D0):D0,1:"")
 ;;^UTILITY(U,$J,"DIPT",1051,"DXS",3,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396.4,D0,0)):^(0),1:""),D0=$P(DIP(1),U,2) S:'$D(^DVB(396.3,+D0,0)) D0=-1 S DIP(101)=$S($D(^DVB(396.3,D0,0)):^(0),1:"")
 ;;^UTILITY(U,$J,"DIPT",1051,"F",1)
 ;;=X DXS(1,9.2) S X=$S('$D(^DPT(+$P(DIP(101),U,1),0)):"",1:$P(^(0),U,1)) S D0=I(0,0) W X K DIP;"NAME";L25;Z;"2507 REQUEST:NAME"~
 ;;^UTILITY(U,$J,"DIPT",1051,"F",2)
 ;;=X DXS(2,9) W X K DIP;"SSN";L13;Z;"2507 REQUEST:NAME:SSN"~
 ;;^UTILITY(U,$J,"DIPT",1051,"F",3)
 ;;=X DXS(3,9.2) S X=$S('$D(^DIC(4,+$P(DIP(101),U,3),0)):"",1:$P(^(0),U,1)) S D0=I(0,0) W X K DIP;"REGIONAL OFFICE NUMBER";L15;Z;"2507 REQUEST:REGIONAL OFFICE NUMBER"~
 ;;^UTILITY(U,$J,"DIPT",1051,"F",4)
 ;;=.03;"EXAM";L30~
 ;;^UTILITY(U,$J,"DIPT",1051,"F",5)
 ;;=S DIP(1)=$S($D(^DVB(396.4,D0,0)):^(0),1:"") S X=$P(DIP(1),U,6) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;"EXAM DATE";L8;Z;"NUMDATE(DATE OF EXAM)"~
 ;;^UTILITY(U,$J,"DIPT",1051,"F",6)
 ;;=.07;L30~
 ;;^UTILITY(U,$J,"DIPT",1051,"H")
 ;;=2507 EXAM LIST
 ;;^UTILITY(U,$J,"DIPT",1210,0)
 ;;=DVBA NOTICE OF DISCHARGE^2940915.0827^^396^^^^
 ;;^UTILITY(U,$J,"DIPT",1210,"DXS",1,9)
 ;;=X DXS(1,9.2) S D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S DIP(201)=$S($D(^DPT(D0,0)):^(0),1:"") S X=$P(DIP(201),U,9) S D0=I(0,0)
 ;;^UTILITY(U,$J,"DIPT",1210,"DXS",1,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S I(100,0)=$S($D(D0):D0,1:"")

DVBAI01S
DVBAI01S ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"DIPT",1210,"F",1)
 ;;=.01;L20~X DXS(1,9) W X K DIP;"SSN";Z;"PATIENT NAME IN PATIENT FILE:SOCIAL SECURITY NUMBER"~4;L7;"NOT/DIS REQ?"~
 ;;^UTILITY(U,$J,"DIPT",1210,"F",2)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$P(DIP(1),U,10) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;L8;"NT/DIS COMP DATE";Z;"NUMDATE(NOTICE/DISCHG COMPLETION DATE)"~
 ;;^UTILITY(U,$J,"DIPT",1210,"F",3)
 ;;=4.5;L8;"NOT/DIS STATUS"~4.9;"NOT/DIS COMPLETED BY";L15~
 ;;^UTILITY(U,$J,"DIPT",1210,"H")
 ;;=FORM 7131 LIST
 ;;^UTILITY(U,$J,"DIPT",1211,0)
 ;;=DVBA 21 DAY CERT^2940915.0844^^396^^^^
 ;;^UTILITY(U,$J,"DIPT",1211,"DXS",1,9.2)
 ;;=S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^DPT(+D0,0)) D0=-1 S DIP(101)=$S($D(^DPT(D0,0)):^(0),1:"")
 ;;^UTILITY(U,$J,"DIPT",1211,"F",1)
 ;;=.01;L20~X DXS(1,9.2) S X=$P(DIP(101),U,9) S D0=I(0,0) W X K DIP;"SSN";Z;"PATIENT:SOCIAL SECURITY NUMBER"~6;"21-DAY CERT REQ?";L4~
 ;;^UTILITY(U,$J,"DIPT",1211,"F",2)
 ;;=S DIP(1)=$S($D(^DVB(396,D0,0)):^(0),1:"") S X=$P(DIP(1),U,14) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W X K DIP;"21-DAY CERT COMP DATE";L8;Z;"NUMDATE(#6.8)"~
 ;;^UTILITY(U,$J,"DIPT",1211,"F",3)
 ;;=6.5;L10;"21-DAY STATUS"~6.9;L15;"21-DAY CERT COMPLETED BY"~
 ;;^UTILITY(U,$J,"DIPT",1211,"H")
 ;;=FORM 7131 LIST
 ;;^UTILITY(U,$J,"KEY",120,0)
 ;;=DVBA SUPERVISOR
 ;;^UTILITY(U,$J,"KEY",120,1,0)
 ;;=^^1^1^2930209^^^^
 ;;^UTILITY(U,$J,"KEY",120,1,1,0)
 ;;=Supervisor key for DVBA package only.
 ;;^UTILITY(U,$J,"KEY",121,0)
 ;;=DVBA RELEASE 21-DAY CERT
 ;;^UTILITY(U,$J,"KEY",121,1,0)
 ;;=^^2^2^2920416^^^^
 ;;^UTILITY(U,$J,"KEY",121,1,1,0)
 ;;=ALLOWS RELEASE OF 21-DAY CERTIFICATES TO THE REGIONAL OFFICE SO THEY
 ;;^UTILITY(U,$J,"KEY",121,1,2,0)
 ;;=MAY BE PRINTED.
 ;;^UTILITY(U,$J,"KEY",122,0)
 ;;=DVBA 21-DAY CERT CLERK
 ;;^UTILITY(U,$J,"KEY",122,1,0)
 ;;=^^1^1^2940707^^^^
 ;;^UTILITY(U,$J,"KEY",122,1,1,0)
 ;;=ALLOWS HOLDER TO EDIT 21 DAY CERT TEXT.
 ;;^UTILITY(U,$J,"KEY",139,0)
 ;;=DVBA C RELEASE 2507
 ;;^UTILITY(U,$J,"KEY",139,1,0)
 ;;=^^1^1^2930329^^^
 ;;^UTILITY(U,$J,"KEY",139,1,1,0)
 ;;=Allows user to release 2507 requests to the Regional Offices.
 ;;^UTILITY(U,$J,"KEY",140,0)
 ;;=DVBA C SUPERVISOR
 ;;^UTILITY(U,$J,"KEY",140,1,0)
 ;;=^^1^1^2930319^^
 ;;^UTILITY(U,$J,"KEY",140,1,1,0)
 ;;=Controls supervisor functions in 2507 package.
 ;;^UTILITY(U,$J,"OPT",3148,0)
 ;;=DVBA EDIT REMARKS^Edit 7131 Remarks ^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3148,1,0)
 ;;=^^1^1^2921124^^^^
 ;;^UTILITY(U,$J,"OPT",3148,1,1,0)
 ;;=This option allows editing of the ADDITIONAL REMARKS field.
 ;;^UTILITY(U,$J,"OPT",3148,25)
 ;;=DVBAERMK
 ;;^UTILITY(U,$J,"OPT",3148,30)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3148,31)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3148,32)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3148,35)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3148,50)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3148,51)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3148,99)
 ;;=55756,45109
 ;;^UTILITY(U,$J,"OPT",3148,"U")
 ;;=EDIT 7131 REMARKS 
 ;;^UTILITY(U,$J,"OPT",3149,0)
 ;;=DVBA SERV CONN ADM REPORT^Admission Report for Service Connected Veterans^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3149,1,0)
 ;;=^^3^3^2920417^^
 ;;^UTILITY(U,$J,"OPT",3149,1,1,0)
 ;;=This option produces an admission report for the requested date range
 ;;^UTILITY(U,$J,"OPT",3149,1,2,0)
 ;;=for SERVICE CONNECTED admissions only.  It greatly reduces the amount of
 ;;^UTILITY(U,$J,"OPT",3149,1,3,0)
 ;;=paper work for the Regional Office.
 ;;^UTILITY(U,$J,"OPT",3149,25)
 ;;=DVBASCRP
 ;;^UTILITY(U,$J,"OPT",3149,"U")
 ;;=ADMISSION REPORT FOR SERVICE C
 ;;^UTILITY(U,$J,"OPT",3150,0)
 ;;=DVBA COMPETENCY EDIT^Edit Competency Status^^E^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3150,1,0)
 ;;=^^1^1^2940608^^^^
 ;;^UTILITY(U,$J,"OPT",3150,1,1,0)
 ;;=This option allows editing of the Veteran's competency status.
 ;;^UTILITY(U,$J,"OPT",3150,30)
 ;;=DPT(
 ;;^UTILITY(U,$J,"OPT",3150,31)
 ;;=AEMQ
 ;;^UTILITY(U,$J,"OPT",3150,50)
 ;;=DPT(
 ;;^UTILITY(U,$J,"OPT",3150,51)
 ;;=[DVBA ELIGIBILITY EDIT]
 ;;^UTILITY(U,$J,"OPT",3150,"U")
 ;;=EDIT COMPETENCY STATUS
 ;;^UTILITY(U,$J,"OPT",3151,0)
 ;;=DVBA INCOMPETENT VET REPORT^Incompetent Veterans Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3151,1,0)
 ;;=^^2^2^2920417^^
 ;;^UTILITY(U,$J,"OPT",3151,1,1,0)
 ;;=This report lists all veterans who are admitted and are ruled incompetent
 ;;^UTILITY(U,$J,"OPT",3151,1,2,0)
 ;;=for CIVIL or VA.
 ;;^UTILITY(U,$J,"OPT",3151,25)
 ;;=DVBACMRP
 ;;^UTILITY(U,$J,"OPT",3151,"U")
 ;;=INCOMPETENT VETERANS REPORT

DVBAI01T
DVBAI01T ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3152,0)
 ;;=DVBA 7131 INFORMATION REQUEST^Request for 7131 Information^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3152,1,0)
 ;;=^^2^2^2941122^^^^
 ;;^UTILITY(U,$J,"OPT",3152,1,1,0)
 ;;=This option allows a request for 7131 information to be entered.  It does
 ;;^UTILITY(U,$J,"OPT",3152,1,2,0)
 ;;=not matter if the user has Admission or Non-Admission information.
 ;;^UTILITY(U,$J,"OPT",3152,25)
 ;;=DVBAREG1
 ;;^UTILITY(U,$J,"OPT",3152,99)
 ;;=55613,44840
 ;;^UTILITY(U,$J,"OPT",3152,"U")
 ;;=REQUEST FOR 7131 INFORMATION
 ;;^UTILITY(U,$J,"OPT",3153,0)
 ;;=DVBA ALL ADMISSIONS^Admission Inquiry by Date  (All Admissions)^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3153,1,0)
 ;;=^^1^1^2920420^^
 ;;^UTILITY(U,$J,"OPT",3153,1,1,0)
 ;;=This option gives all admissions for any given date range.
 ;;^UTILITY(U,$J,"OPT",3153,25)
 ;;=DVBAADRP
 ;;^UTILITY(U,$J,"OPT",3153,"U")
 ;;=ADMISSION INQUIRY BY DATE  (AL
 ;;^UTILITY(U,$J,"OPT",3154,0)
 ;;=DVBA STATUS EDIT^Edit Beneficiary Information Status^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3154,1,0)
 ;;=^^1^1^2861217^
 ;;^UTILITY(U,$J,"OPT",3154,1,1,0)
 ;;=This option allows MAS personnel to update 7131 request statuses.
 ;;^UTILITY(U,$J,"OPT",3154,25)
 ;;=DVBAEDIT
 ;;^UTILITY(U,$J,"OPT",3154,"U")
 ;;=EDIT BENEFICIARY INFORMATION S
 ;;^UTILITY(U,$J,"OPT",3155,0)
 ;;=DVBA STATUS INQUIRY^Beneficiary Information Status Inquiry^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3155,1,0)
 ;;=^^1^1^2950302^^^^
 ;;^UTILITY(U,$J,"OPT",3155,1,1,0)
 ;;=This option gives the status of any particular information request.
 ;;^UTILITY(U,$J,"OPT",3155,25)
 ;;=DVBASTAT
 ;;^UTILITY(U,$J,"OPT",3155,99)
 ;;=55627,47179
 ;;^UTILITY(U,$J,"OPT",3155,"U")
 ;;=BENEFICIARY INFORMATION STATUS
 ;;^UTILITY(U,$J,"OPT",3156,0)
 ;;=DVBA REGIONAL OFFICE MENU^A.M.I.E Regional Office Main Menu^OUT OF ORDER^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3156,1,0)
 ;;=^^1^1^2941028^^^^
 ;;^UTILITY(U,$J,"OPT",3156,1,1,0)
 ;;=Regional menu for requesting 7131 information.
 ;;^UTILITY(U,$J,"OPT",3156,10,0)
 ;;=^19.01PI^22^16
 ;;^UTILITY(U,$J,"OPT",3156,10,1,0)
 ;;=3152^1^1
 ;;^UTILITY(U,$J,"OPT",3156,10,1,"^")
 ;;=DVBA 7131 INFORMATION REQUEST
 ;;^UTILITY(U,$J,"OPT",3156,10,3,0)
 ;;=3155^3^3
 ;;^UTILITY(U,$J,"OPT",3156,10,3,"^")
 ;;=DVBA STATUS INQUIRY
 ;;^UTILITY(U,$J,"OPT",3156,10,4,0)
 ;;=3153^5^5
 ;;^UTILITY(U,$J,"OPT",3156,10,4,"^")
 ;;=DVBA ALL ADMISSIONS
 ;;^UTILITY(U,$J,"OPT",3156,10,5,0)
 ;;=3148^4^4
 ;;^UTILITY(U,$J,"OPT",3156,10,5,"^")
 ;;=DVBA EDIT REMARKS
 ;;^UTILITY(U,$J,"OPT",3156,10,6,0)
 ;;=3149^6^6
 ;;^UTILITY(U,$J,"OPT",3156,10,6,"^")
 ;;=DVBA SERV CONN ADM REPORT
 ;;^UTILITY(U,$J,"OPT",3156,10,8,0)
 ;;=3162^7^7
 ;;^UTILITY(U,$J,"OPT",3156,10,8,"^")
 ;;=DVBA DISCHARGE RPT
 ;;^UTILITY(U,$J,"OPT",3156,10,10,0)
 ;;=3151^8^8
 ;;^UTILITY(U,$J,"OPT",3156,10,10,"^")
 ;;=DVBA INCOMPETENT VET REPORT
 ;;^UTILITY(U,$J,"OPT",3156,10,12,0)
 ;;=23^15^15
 ;;^UTILITY(U,$J,"OPT",3156,10,12,"^")
 ;;=XMUSER
 ;;^UTILITY(U,$J,"OPT",3156,10,13,0)
 ;;=197^10^10
 ;;^UTILITY(U,$J,"OPT",3156,10,13,"^")
 ;;=DG INPATIENT INQUIRY EXTENDED
 ;;^UTILITY(U,$J,"OPT",3156,10,15,0)
 ;;=3164^11^11
 ;;^UTILITY(U,$J,"OPT",3156,10,15,"^")
 ;;=DVBA REPORT PENSION/A&A
 ;;^UTILITY(U,$J,"OPT",3156,10,16,0)
 ;;=3165^12^12
 ;;^UTILITY(U,$J,"OPT",3156,10,16,"^")
 ;;=DVBA RE-ADMISSION REPORT
 ;;^UTILITY(U,$J,"OPT",3156,10,17,0)
 ;;=240^13^13
 ;;^UTILITY(U,$J,"OPT",3156,10,17,"^")
 ;;=SDPATIENT
 ;;^UTILITY(U,$J,"OPT",3156,10,19,0)
 ;;=3172^16^16
 ;;^UTILITY(U,$J,"OPT",3156,10,19,"^")
 ;;=DVBA REGIONAL 7132 MENU
 ;;^UTILITY(U,$J,"OPT",3156,10,20,0)
 ;;=3159^14^14
 ;;^UTILITY(U,$J,"OPT",3156,10,20,"^")
 ;;=DVBA PENDING REQUESTS RPT
 ;;^UTILITY(U,$J,"OPT",3156,10,21,0)
 ;;=3184^9^9
 ;;^UTILITY(U,$J,"OPT",3156,10,21,"^")
 ;;=DVBA REG OFF PATIENT INQ
 ;;^UTILITY(U,$J,"OPT",3156,10,22,0)
 ;;=3197^17^17
 ;;^UTILITY(U,$J,"OPT",3156,10,22,"^")
 ;;=DVBA C REGIONAL OFFICE MENU
 ;;^UTILITY(U,$J,"OPT",3156,15)
 ;;=K DVBAROUS W:$D(IOF) @IOF,!
 ;;^UTILITY(U,$J,"OPT",3156,20)
 ;;=S DVBAROUS="" D ^DVBAALRT S HD="A. M. I. E.   R E G I O N A L   O F F I C E   M A I N   M E N U" W @IOF,!,?(79-$L(HD)\2),HD,!! K HD,ANS,IOP
 ;;^UTILITY(U,$J,"OPT",3156,99)
 ;;=56209,43641
 ;;^UTILITY(U,$J,"OPT",3156,99.1)
 ;;=54234,75476
 ;;^UTILITY(U,$J,"OPT",3156,"U")
 ;;=A.M.I.E REGIONAL OFFICE MAIN M
 ;;^UTILITY(U,$J,"OPT",3157,0)
 ;;=DVBA MEDICAL ADM 7131 MENU^A.M.I.E. Medical Administration Menu^OUT OF ORDER^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3157,1,0)
 ;;=^^1^1^2941209^^^^

DVBAI01U
DVBAI01U ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3157,1,1,0)
 ;;=Menu for MAS to respond to the Regional Office 7131 requests.
 ;;^UTILITY(U,$J,"OPT",3157,10,0)
 ;;=^19.01PI^16^14
 ;;^UTILITY(U,$J,"OPT",3157,10,3,0)
 ;;=3154^1^1
 ;;^UTILITY(U,$J,"OPT",3157,10,3,"^")
 ;;=DVBA STATUS EDIT
 ;;^UTILITY(U,$J,"OPT",3157,10,4,0)
 ;;=3163^3^3
 ;;^UTILITY(U,$J,"OPT",3157,10,4,"^")
 ;;=DVBA NEW REQUEST
 ;;^UTILITY(U,$J,"OPT",3157,10,5,0)
 ;;=3155^4^4
 ;;^UTILITY(U,$J,"OPT",3157,10,5,"^")
 ;;=DVBA STATUS INQUIRY
 ;;^UTILITY(U,$J,"OPT",3157,10,6,0)
 ;;=3159^5^5
 ;;^UTILITY(U,$J,"OPT",3157,10,6,"^")
 ;;=DVBA PENDING REQUESTS RPT
 ;;^UTILITY(U,$J,"OPT",3157,10,7,0)
 ;;=3161^6^6
 ;;^UTILITY(U,$J,"OPT",3157,10,7,"^")
 ;;=DVBA SITE PARAMETERS
 ;;^UTILITY(U,$J,"OPT",3157,10,8,0)
 ;;=3148^2^2
 ;;^UTILITY(U,$J,"OPT",3157,10,8,"^")
 ;;=DVBA EDIT REMARKS
 ;;^UTILITY(U,$J,"OPT",3157,10,9,0)
 ;;=3166^7^7
 ;;^UTILITY(U,$J,"OPT",3157,10,9,"^")
 ;;=DVBA INCOMPLETE REQUEST RPT
 ;;^UTILITY(U,$J,"OPT",3157,10,10,0)
 ;;=3167^8^8
 ;;^UTILITY(U,$J,"OPT",3157,10,10,"^")
 ;;=DVBA FINALIZED REPORT
 ;;^UTILITY(U,$J,"OPT",3157,10,11,0)
 ;;=3171^12^12
 ;;^UTILITY(U,$J,"OPT",3157,10,11,"^")
 ;;=DVBA MEDICAL ADM 7132 MENU
 ;;^UTILITY(U,$J,"OPT",3157,10,12,0)
 ;;=3175^9^9
 ;;^UTILITY(U,$J,"OPT",3157,10,12,"^")
 ;;=DVBA ADMISSION REVIEW
 ;;^UTILITY(U,$J,"OPT",3157,10,13,0)
 ;;=3182^10^10
 ;;^UTILITY(U,$J,"OPT",3157,10,13,"^")
 ;;=DVBA AUTO FINALIZE USER MODE
 ;;^UTILITY(U,$J,"OPT",3157,10,14,0)
 ;;=3150^11^11
 ;;^UTILITY(U,$J,"OPT",3157,10,14,"^")
 ;;=DVBA COMPETENCY EDIT
 ;;^UTILITY(U,$J,"OPT",3157,10,15,0)
 ;;=3198^13^13
 ;;^UTILITY(U,$J,"OPT",3157,10,15,"^")
 ;;=DVBA C MEDICAL ADMIN C&P MENU
 ;;^UTILITY(U,$J,"OPT",3157,10,16,0)
 ;;=4828^14^14
 ;;^UTILITY(U,$J,"OPT",3157,10,16,"^")
 ;;=DVBA 7131 DIVISIONAL TRANSFER
 ;;^UTILITY(U,$J,"OPT",3157,15)
 ;;=W:$D(IOF) @IOF
 ;;^UTILITY(U,$J,"OPT",3157,20)
 ;;=S HD="A. M. I. E.   M E D I C A L   A D M I N I S T R A T I O N   M E N U" W @IOF,!,?(IOM-$L(HD)\2),HD,!!! K HD
 ;;^UTILITY(U,$J,"OPT",3157,99)
 ;;=56225,57188
 ;;^UTILITY(U,$J,"OPT",3157,99.1)
 ;;=54146,30955
 ;;^UTILITY(U,$J,"OPT",3157,"U")
 ;;=A.M.I.E. MEDICAL ADMINISTRATIO
 ;;^UTILITY(U,$J,"OPT",3158,0)
 ;;=DVBA REGIONAL PURGING PROGRAM^File 7131 Purging Program^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3158,1,0)
 ;;=^^4^4^2950324^^^^
 ;;^UTILITY(U,$J,"OPT",3158,1,1,0)
 ;;=This program purges the File 7131 request information for all records
 ;;^UTILITY(U,$J,"OPT",3158,1,2,0)
 ;;=that have a finalization date set.  It is run only on the Task Manager 
 ;;^UTILITY(U,$J,"OPT",3158,1,3,0)
 ;;=and deletes all completed requests within the purge parameters
 ;;^UTILITY(U,$J,"OPT",3158,1,4,0)
 ;;=set by the hospital AMIE coordinator.
 ;;^UTILITY(U,$J,"OPT",3158,25)
 ;;=DVBARPUR
 ;;^UTILITY(U,$J,"OPT",3158,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3158,"U")
 ;;=FILE 7131 PURGING PROGRAM
 ;;^UTILITY(U,$J,"OPT",3159,0)
 ;;=DVBA PENDING REQUESTS RPT^Pending Form 7131 Requests Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3159,1,0)
 ;;=^^2^2^2930507^^^^
 ;;^UTILITY(U,$J,"OPT",3159,1,1,0)
 ;;=This program prints out all file 7131 records that are not finalized.
 ;;^UTILITY(U,$J,"OPT",3159,1,2,0)
 ;;=It shows only what is not completed for each patient request.
 ;;^UTILITY(U,$J,"OPT",3159,25)
 ;;=DVBAPEND
 ;;^UTILITY(U,$J,"OPT",3159,99)
 ;;=55685,39909
 ;;^UTILITY(U,$J,"OPT",3159,"U")
 ;;=PENDING FORM 7131 REQUESTS REP
 ;;^UTILITY(U,$J,"OPT",3160,0)
 ;;=DVBA REGIONAL TASK^New Form 7131 Requests (TaskManager Version)^^A^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1
 ;;^UTILITY(U,$J,"OPT",3160,1,0)
 ;;=^^2^2^2950125^^^^
 ;;^UTILITY(U,$J,"OPT",3160,1,1,0)
 ;;=This option prints out new 7131 requests from the Regional
 ;;^UTILITY(U,$J,"OPT",3160,1,2,0)
 ;;=Office daily for "T-1".
 ;;^UTILITY(U,$J,"OPT",3160,20)
 ;;=D TASK^DVBAREQ1
 ;;^UTILITY(U,$J,"OPT",3160,25)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3160,99)
 ;;=55651,38528
 ;;^UTILITY(U,$J,"OPT",3160,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3160,"U")
 ;;=NEW FORM 7131 REQUESTS (TASKMA
 ;;^UTILITY(U,$J,"OPT",3161,0)
 ;;=DVBA SITE PARAMETERS^Regional File Site Parameter Setup^^R^^DVBA SUPERVISOR^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3161,1,0)
 ;;=^^1^1^2940630^^^
 ;;^UTILITY(U,$J,"OPT",3161,1,1,0)
 ;;=This option sets up certain site specific parameters.
 ;;^UTILITY(U,$J,"OPT",3161,25)
 ;;=DVBASITE
 ;;^UTILITY(U,$J,"OPT",3161,"U")
 ;;=REGIONAL FILE SITE PARAMETER S
 ;;^UTILITY(U,$J,"OPT",3162,0)
 ;;=DVBA DISCHARGE RPT^Discharge Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3162,1,0)
 ;;=^^2^2^2940727^^^^

DVBAI01V
DVBAI01V ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3162,1,1,0)
 ;;=This option produces a discharge report for any discharge date range.
 ;;^UTILITY(U,$J,"OPT",3162,1,2,0)
 ;;=The user may select discharges for A&A, pension, SC or all .
 ;;^UTILITY(U,$J,"OPT",3162,25)
 ;;=DVBADSRT
 ;;^UTILITY(U,$J,"OPT",3162,"U")
 ;;=DISCHARGE REPORT
 ;;^UTILITY(U,$J,"OPT",3163,0)
 ;;=DVBA NEW REQUEST^New Form 7131 Request Report^^R^^DVBA SUPERVISOR^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3163,1,0)
 ;;=^^2^2^2940620^^^^
 ;;^UTILITY(U,$J,"OPT",3163,1,1,0)
 ;;=This option reports new 7131 requests by date, for any date range.
 ;;^UTILITY(U,$J,"OPT",3163,1,2,0)
 ;;=The operator would normally request only one day at a time.
 ;;^UTILITY(U,$J,"OPT",3163,25)
 ;;=DVBAREQ1
 ;;^UTILITY(U,$J,"OPT",3163,"U")
 ;;=NEW FORM 7131 REQUEST REPORT
 ;;^UTILITY(U,$J,"OPT",3164,0)
 ;;=DVBA REPORT PENSION/A&A^Report for Pension and A&A^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3164,1,0)
 ;;=^^3^3^2940727^^^^
 ;;^UTILITY(U,$J,"OPT",3164,1,1,0)
 ;;=Report for the Regional Office to allow pension/A&A searches for
 ;;^UTILITY(U,$J,"OPT",3164,1,2,0)
 ;;=an admission date range. The report then segregates vets by
 ;;^UTILITY(U,$J,"OPT",3164,1,3,0)
 ;;=the discharge types selected, whether they are s/c, etc.
 ;;^UTILITY(U,$J,"OPT",3164,25)
 ;;=DVBASPDC
 ;;^UTILITY(U,$J,"OPT",3164,"U")
 ;;=REPORT FOR PENSION AND A&A
 ;;^UTILITY(U,$J,"OPT",3165,0)
 ;;=DVBA RE-ADMISSION REPORT^Re-admission Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3165,1,0)
 ;;=^^4^4^2920420^^^^
 ;;^UTILITY(U,$J,"OPT",3165,1,1,0)
 ;;=Option to identify patients who have a discharge of less than 180 days
 ;;^UTILITY(U,$J,"OPT",3165,1,2,0)
 ;;=before the current admission date.  Only patients who are receiving
 ;;^UTILITY(U,$J,"OPT",3165,1,3,0)
 ;;=pension are reported.
 ;;^UTILITY(U,$J,"OPT",3165,1,4,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3165,25)
 ;;=DVBARADM
 ;;^UTILITY(U,$J,"OPT",3165,99)
 ;;=55782,46120
 ;;^UTILITY(U,$J,"OPT",3165,"U")
 ;;=RE-ADMISSION REPORT
 ;;^UTILITY(U,$J,"OPT",3166,0)
 ;;=DVBA INCOMPLETE REQUEST RPT^Incomplete Request Report^^P^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3166,1,0)
 ;;=^^1^1^2940608^^^^
 ;;^UTILITY(U,$J,"OPT",3166,1,1,0)
 ;;=Prints out statistics on incomplete requests.
 ;;^UTILITY(U,$J,"OPT",3166,60)
 ;;=DVB(396,
 ;;^UTILITY(U,$J,"OPT",3166,62)
 ;;=0
 ;;^UTILITY(U,$J,"OPT",3166,63)
 ;;=[DVBA INCOMP REQ REPORT]
 ;;^UTILITY(U,$J,"OPT",3166,64)
 ;;=[DVBA INCOMP REQ REPORT]
 ;;^UTILITY(U,$J,"OPT",3166,"U")
 ;;=INCOMPLETE REQUEST REPORT
 ;;^UTILITY(U,$J,"OPT",3167,0)
 ;;=DVBA FINALIZED REPORT^Finalized Report^^P^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3167,1,0)
 ;;=^^1^1^2930622^^^^
 ;;^UTILITY(U,$J,"OPT",3167,1,1,0)
 ;;=Gives statistics on finalized reports.
 ;;^UTILITY(U,$J,"OPT",3167,60)
 ;;=DVB(396,
 ;;^UTILITY(U,$J,"OPT",3167,62)
 ;;=0
 ;;^UTILITY(U,$J,"OPT",3167,63)
 ;;=[DVBA FINALIZED REPORT]
 ;;^UTILITY(U,$J,"OPT",3167,64)
 ;;=[DVBA FINALIZED REPORT]
 ;;^UTILITY(U,$J,"OPT",3167,99)
 ;;=55628,55037
 ;;^UTILITY(U,$J,"OPT",3167,"U")
 ;;=FINALIZED REPORT
 ;;^UTILITY(U,$J,"OPT",3168,0)
 ;;=DVBA NOTICE/DISCHARGE PRINT^Print New Notices of Discharge^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3168,1,0)
 ;;=^^1^1^2940525^^^^
 ;;^UTILITY(U,$J,"OPT",3168,1,1,0)
 ;;=Prints out new notices of discharge directly at the Regional Office.
 ;;^UTILITY(U,$J,"OPT",3168,25)
 ;;=DVBADSNT
 ;;^UTILITY(U,$J,"OPT",3168,"U")
 ;;=PRINT NEW NOTICES OF DISCHARGE
 ;;^UTILITY(U,$J,"OPT",3169,0)
 ;;=DVBA 7132 TASKMAN^Notification of Discharge via TaskMan^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3169,1,0)
 ;;=^^1^1^2930507^^^^
 ;;^UTILITY(U,$J,"OPT",3169,1,1,0)
 ;;=Task Manager version of auto-notification of discharge.
 ;;^UTILITY(U,$J,"OPT",3169,25)
 ;;=ZTM^DVBADSCK
 ;;^UTILITY(U,$J,"OPT",3169,99)
 ;;=55634,35882
 ;;^UTILITY(U,$J,"OPT",3169,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3169,"U")
 ;;=NOTIFICATION OF DISCHARGE VIA 
 ;;^UTILITY(U,$J,"OPT",3171,0)
 ;;=DVBA MEDICAL ADM 7132 MENU^Medical Administration 7132 Menu^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3171,1,0)
 ;;=^^1^1^2880907^^^
 ;;^UTILITY(U,$J,"OPT",3171,1,1,0)
 ;;=Medical Administration 7132 processing and maintenance menu.
 ;;^UTILITY(U,$J,"OPT",3171,10,0)
 ;;=^19.01PI^8^5
 ;;^UTILITY(U,$J,"OPT",3171,10,4,0)
 ;;=3173^1^1
 ;;^UTILITY(U,$J,"OPT",3171,10,4,"^")
 ;;=DVBA MANUAL NOTIFY
 ;;^UTILITY(U,$J,"OPT",3171,10,5,0)
 ;;=3177^2^2
 ;;^UTILITY(U,$J,"OPT",3171,10,5,"^")
 ;;=DVBA RE-GENERATE 21-DAY CERTIF

DVBAI01W
DVBAI01W ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3171,10,6,0)
 ;;=3180^4^4
 ;;^UTILITY(U,$J,"OPT",3171,10,6,"^")
 ;;=DVBA RELEASE 21-DAY CERT
 ;;^UTILITY(U,$J,"OPT",3171,10,7,0)
 ;;=3183^5^5
 ;;^UTILITY(U,$J,"OPT",3171,10,7,"^")
 ;;=DVBA 21-DAY/NOT DISCHG RPT
 ;;^UTILITY(U,$J,"OPT",3171,10,8,0)
 ;;=3185^3^3
 ;;^UTILITY(U,$J,"OPT",3171,10,8,"^")
 ;;=DVBA MAS REPRINT 21-DAY CERT
 ;;^UTILITY(U,$J,"OPT",3171,15)
 ;;=W:$D(IOF) @IOF,!!
 ;;^UTILITY(U,$J,"OPT",3171,20)
 ;;=S HD="A. M. I. E.   M E D I C A L   A D M I N I S T R A T I O N   7 1 3 2   M E N U" W @IOF,!,?(IOM-$L(HD)\2),HD,!! K HD
 ;;^UTILITY(U,$J,"OPT",3171,99)
 ;;=56204,45343
 ;;^UTILITY(U,$J,"OPT",3171,99.1)
 ;;=54128,60062
 ;;^UTILITY(U,$J,"OPT",3171,"U")
 ;;=MEDICAL ADMINISTRATION 7132 ME
 ;;^UTILITY(U,$J,"OPT",3172,0)
 ;;=DVBA REGIONAL 7132 MENU^Regional Office 7132 Menu^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3172,1,0)
 ;;=^^1^1^2930521^^^^
 ;;^UTILITY(U,$J,"OPT",3172,1,1,0)
 ;;=Regional office part of 7132 package.
 ;;^UTILITY(U,$J,"OPT",3172,10,0)
 ;;=^19.01PI^5^4
 ;;^UTILITY(U,$J,"OPT",3172,10,2,0)
 ;;=3168^1^1
 ;;^UTILITY(U,$J,"OPT",3172,10,2,"^")
 ;;=DVBA NOTICE/DISCHARGE PRINT
 ;;^UTILITY(U,$J,"OPT",3172,10,3,0)
 ;;=3174^2^2
 ;;^UTILITY(U,$J,"OPT",3172,10,3,"^")
 ;;=DVBA REPRINT NOTICE/DISCHARGE
 ;;^UTILITY(U,$J,"OPT",3172,10,4,0)
 ;;=3178^3^3
 ;;^UTILITY(U,$J,"OPT",3172,10,4,"^")
 ;;=DVBA RO PRINT 21-DAY CERT
 ;;^UTILITY(U,$J,"OPT",3172,10,5,0)
 ;;=3179^4^4
 ;;^UTILITY(U,$J,"OPT",3172,10,5,"^")
 ;;=DVBA RO REPRINT 21-DAY CERT
 ;;^UTILITY(U,$J,"OPT",3172,15)
 ;;=W:$D(IOF) @IOF,!!
 ;;^UTILITY(U,$J,"OPT",3172,20)
 ;;=S HD="A. M. I. E.   R E G I O N A L   O F F I C E   7 1 3 2   M E N U" W @IOF,!,?(79-$L(HD)\2),HD,!! K HD,IOP
 ;;^UTILITY(U,$J,"OPT",3172,99)
 ;;=56204,45342
 ;;^UTILITY(U,$J,"OPT",3172,"U")
 ;;=REGIONAL OFFICE 7132 MENU
 ;;^UTILITY(U,$J,"OPT",3173,0)
 ;;=DVBA MANUAL NOTIFY^Manual Discharge Notification Processing^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3173,1,0)
 ;;=^^2^2^2940401^^
 ;;^UTILITY(U,$J,"OPT",3173,1,1,0)
 ;;=This manually runs the 7132 discharge checker.  This is in case the
 ;;^UTILITY(U,$J,"OPT",3173,1,2,0)
 ;;=Task Manager fails.
 ;;^UTILITY(U,$J,"OPT",3173,25)
 ;;=DVBADSCK
 ;;^UTILITY(U,$J,"OPT",3173,"U")
 ;;=MANUAL DISCHARGE NOTIFICATION 
 ;;^UTILITY(U,$J,"OPT",3174,0)
 ;;=DVBA REPRINT NOTICE/DISCHARGE^Reprint a Notice of Discharge^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3174,1,0)
 ;;=^^1^1^2920420^^^
 ;;^UTILITY(U,$J,"OPT",3174,1,1,0)
 ;;=Allows reprinting of any notice of discharge for any date.
 ;;^UTILITY(U,$J,"OPT",3174,25)
 ;;=DVBADSRP
 ;;^UTILITY(U,$J,"OPT",3174,"U")
 ;;=REPRINT A NOTICE OF DISCHARGE
 ;;^UTILITY(U,$J,"OPT",3175,0)
 ;;=DVBA ADMISSION REVIEW^Admission Review Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3175,1,0)
 ;;=^^1^1^2890922^^^
 ;;^UTILITY(U,$J,"OPT",3175,1,1,0)
 ;;=Review prior day's admissions for accuracy.
 ;;^UTILITY(U,$J,"OPT",3175,25)
 ;;=DVBAADMR
 ;;^UTILITY(U,$J,"OPT",3175,60)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3175,62)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3175,63)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3175,64)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3175,"U")
 ;;=ADMISSION REVIEW REPORT
 ;;^UTILITY(U,$J,"OPT",3176,0)
 ;;=DVBA GENERATE 21-DAY CERTIF^Generate 21-day cert via Task Manager^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3176,1,0)
 ;;=^^2^2^2940401^^^^
 ;;^UTILITY(U,$J,"OPT",3176,1,1,0)
 ;;=Generates a 21-day certificate via Task Manager for all 7131 requests that 
 ;;^UTILITY(U,$J,"OPT",3176,1,2,0)
 ;;=have it flagged.
 ;;^UTILITY(U,$J,"OPT",3176,25)
 ;;=DATA^DVBACERT
 ;;^UTILITY(U,$J,"OPT",3176,99)
 ;;=55647,52633
 ;;^UTILITY(U,$J,"OPT",3176,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3176,"U")
 ;;=GENERATE 21-DAY CERT VIA TASK 
 ;;^UTILITY(U,$J,"OPT",3177,0)
 ;;=DVBA RE-GENERATE 21-DAY CERTIF^Manual 21-day Certificate Processing^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3177,1,0)
 ;;=^^3^3^2940617^^^^
 ;;^UTILITY(U,$J,"OPT",3177,1,1,0)
 ;;=This option is only used in case the Task Manager ever fails.  It is used
 ;;^UTILITY(U,$J,"OPT",3177,1,2,0)
 ;;=to ENTIRELY reprocess a date.  Only one date at a time can be reprinted
 ;;^UTILITY(U,$J,"OPT",3177,1,3,0)
 ;;=using this option.
 ;;^UTILITY(U,$J,"OPT",3177,25)
 ;;=DVBACERT
 ;;^UTILITY(U,$J,"OPT",3177,"U")
 ;;=MANUAL 21-DAY CERTIFICATE PROC
 ;;^UTILITY(U,$J,"OPT",3178,0)
 ;;=DVBA RO PRINT 21-DAY CERT^Regional Office 21-day Certificate Printing^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3178,1,0)
 ;;=^^2^2^2920827^^^
 ;;^UTILITY(U,$J,"OPT",3178,1,1,0)
 ;;=Generates original REGIONAL OFFICE 21-day certificates.  They must have

DVBAI01X
DVBAI01X ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3178,1,2,0)
 ;;=been completed and released by MAS before they will be printed.
 ;;^UTILITY(U,$J,"OPT",3178,25)
 ;;=DVBACRMS
 ;;^UTILITY(U,$J,"OPT",3178,"U")
 ;;=REGIONAL OFFICE 21-DAY CERTIFI
 ;;^UTILITY(U,$J,"OPT",3179,0)
 ;;=DVBA RO REPRINT 21-DAY CERT^Reprint a 21-day Certificate for the RO^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3179,1,0)
 ;;=^^3^3^2940617^^^^
 ;;^UTILITY(U,$J,"OPT",3179,1,1,0)
 ;;=This option will reprint any one day of certificates for the RO.  The only
 ;;^UTILITY(U,$J,"OPT",3179,1,2,0)
 ;;=prerequisite is that the RO know what day the certificate was originally
 ;;^UTILITY(U,$J,"OPT",3179,1,3,0)
 ;;=printed.
 ;;^UTILITY(U,$J,"OPT",3179,25)
 ;;=DVBACRRR
 ;;^UTILITY(U,$J,"OPT",3179,"U")
 ;;=REPRINT A 21-DAY CERTIFICATE F
 ;;^UTILITY(U,$J,"OPT",3180,0)
 ;;=DVBA RELEASE 21-DAY CERT^MAS Edit/Release of 21-day Certificates^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3180,1,0)
 ;;=^^2^2^2881014^^^^
 ;;^UTILITY(U,$J,"OPT",3180,1,1,0)
 ;;=This option will allow editing of the 21-day certificate text.  Once edited
 ;;^UTILITY(U,$J,"OPT",3180,1,2,0)
 ;;=it will be subsequently tagged as "released" and the RO may then print it.
 ;;^UTILITY(U,$J,"OPT",3180,25)
 ;;=DVBARL21
 ;;^UTILITY(U,$J,"OPT",3180,"U")
 ;;=MAS EDIT/RELEASE OF 21-DAY CER
 ;;^UTILITY(U,$J,"OPT",3181,0)
 ;;=DVBA AUTO FINALIZE 7131 TASK^Automatic 7131 Finalization via TaskMan^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3181,1,0)
 ;;=^^2^2^2930409^^^^
 ;;^UTILITY(U,$J,"OPT",3181,1,1,0)
 ;;=Provides automatic 7131 finalizing via TaskMan.  Completely removes user
 ;;^UTILITY(U,$J,"OPT",3181,1,2,0)
 ;;=obligation for finalizing requests.
 ;;^UTILITY(U,$J,"OPT",3181,25)
 ;;=ZTM^DVBAFINL
 ;;^UTILITY(U,$J,"OPT",3181,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3181,"U")
 ;;=AUTOMATIC 7131 FINALIZATION VI
 ;;^UTILITY(U,$J,"OPT",3182,0)
 ;;=DVBA AUTO FINALIZE USER MODE^Automatic 7131 Finalization (User Mode)^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3182,1,0)
 ;;=^^2^2^2921026^^^
 ;;^UTILITY(U,$J,"OPT",3182,1,1,0)
 ;;=Allows manual finalization of all 7131 requests that are ready.  This is
 ;;^UTILITY(U,$J,"OPT",3182,1,2,0)
 ;;=designed to run in a user-assisted mode.
 ;;^UTILITY(U,$J,"OPT",3182,25)
 ;;=DVBAFINL
 ;;^UTILITY(U,$J,"OPT",3182,"U")
 ;;=AUTOMATIC 7131 FINALIZATION (U
 ;;^UTILITY(U,$J,"OPT",3183,0)
 ;;=DVBA 21-DAY/NOT DISCHG RPT^21-day Cert/Notice of Discharge Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3183,1,0)
 ;;=^^1^1^2950315^^^^
 ;;^UTILITY(U,$J,"OPT",3183,1,1,0)
 ;;=Follow up report for 21-day certificate and notice of discharge production.
 ;;^UTILITY(U,$J,"OPT",3183,25)
 ;;=DVBANT21
 ;;^UTILITY(U,$J,"OPT",3183,60)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3183,62)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3183,63)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3183,64)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3183,99)
 ;;=55628,31796
 ;;^UTILITY(U,$J,"OPT",3183,"U")
 ;;=21-DAY CERT/NOTICE OF DISCHARG
 ;;^UTILITY(U,$J,"OPT",3184,0)
 ;;=DVBA REG OFF PATIENT INQ^Regional Office Patient Inquiry^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3184,1,0)
 ;;=^^2^2^2920417^^^
 ;;^UTILITY(U,$J,"OPT",3184,1,1,0)
 ;;=AMIE option which uses DGRPD from the ADT/Scheduling package.
 ;;^UTILITY(U,$J,"OPT",3184,1,2,0)
 ;;=Used only as a customizing option for the RO.
 ;;^UTILITY(U,$J,"OPT",3184,20)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3184,25)
 ;;=DGRPD
 ;;^UTILITY(U,$J,"OPT",3184,"U")
 ;;=REGIONAL OFFICE PATIENT INQUIR
 ;;^UTILITY(U,$J,"OPT",3185,0)
 ;;=DVBA MAS REPRINT 21-DAY CERT^Reprint 21-day Certificates for MAS^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3185,1,0)
 ;;=^^3^3^2940617^^^^
 ;;^UTILITY(U,$J,"OPT",3185,1,1,0)
 ;;=Allow reprinting of original copies of 21-day certs.
 ;;^UTILITY(U,$J,"OPT",3185,1,2,0)
 ;;=This is NOT to be confused with reprocessing a day, which is when
 ;;^UTILITY(U,$J,"OPT",3185,1,3,0)
 ;;=the Task Manager fails.
 ;;^UTILITY(U,$J,"OPT",3185,25)
 ;;=DVBACRRP
 ;;^UTILITY(U,$J,"OPT",3185,99)
 ;;=55676,29176
 ;;^UTILITY(U,$J,"OPT",3185,"U")
 ;;=REPRINT 21-DAY CERTIFICATES FO
 ;;^UTILITY(U,$J,"OPT",3186,0)
 ;;=DVBA C C&P MASTER MENU^Compensation and Pension Main Menu^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3186,1,0)
 ;;=^^1^1^2940204^^^
 ;;^UTILITY(U,$J,"OPT",3186,1,1,0)
 ;;=Main menu driver for the C&P package.
 ;;^UTILITY(U,$J,"OPT",3186,10,0)
 ;;=^19.01PI^20^18
 ;;^UTILITY(U,$J,"OPT",3186,10,1,0)
 ;;=3187^^1
 ;;^UTILITY(U,$J,"OPT",3186,10,1,"^")
 ;;=DVBA C ENTER C&P REQUEST
 ;;^UTILITY(U,$J,"OPT",3186,10,2,0)
 ;;=3188^^8

DVBAI01Y
DVBAI01Y ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3186,10,2,"^")
 ;;=DVBA C PRINT NEW C&P REQUESTS
 ;;^UTILITY(U,$J,"OPT",3186,10,3,0)
 ;;=3189^TRS^3
 ;;^UTILITY(U,$J,"OPT",3186,10,3,"^")
 ;;=DVBA C TRANSCRIBE REQUEST DATA
 ;;^UTILITY(U,$J,"OPT",3186,10,4,0)
 ;;=3190^^5
 ;;^UTILITY(U,$J,"OPT",3186,10,4,"^")
 ;;=DVBA C CANCEL REQUESTS/EXAMS
 ;;^UTILITY(U,$J,"OPT",3186,10,5,0)
 ;;=3192^^6
 ;;^UTILITY(U,$J,"OPT",3186,10,5,"^")
 ;;=DVBA C REOPEN REQUEST/EXAMS
 ;;^UTILITY(U,$J,"OPT",3186,10,6,0)
 ;;=3193^^12
 ;;^UTILITY(U,$J,"OPT",3186,10,6,"^")
 ;;=DVBA C INQUIRY
 ;;^UTILITY(U,$J,"OPT",3186,10,7,0)
 ;;=3194^^4
 ;;^UTILITY(U,$J,"OPT",3186,10,7,"^")
 ;;=DVBA C ADD ADDITIONAL EXAM
 ;;^UTILITY(U,$J,"OPT",3186,10,9,0)
 ;;=3195^^2
 ;;^UTILITY(U,$J,"OPT",3186,10,9,"^")
 ;;=DVBA C SCHEDULE EXAMS
 ;;^UTILITY(U,$J,"OPT",3186,10,11,0)
 ;;=3196^^9
 ;;^UTILITY(U,$J,"OPT",3186,10,11,"^")
 ;;=DVBA C PRINT NEW C&P REQ TM
 ;;^UTILITY(U,$J,"OPT",3186,10,12,0)
 ;;=3200^^11
 ;;^UTILITY(U,$J,"OPT",3186,10,12,"^")
 ;;=DVBA C REPRINT 2507 FINAL RPT
 ;;^UTILITY(U,$J,"OPT",3186,10,13,0)
 ;;=3201^^7
 ;;^UTILITY(U,$J,"OPT",3186,10,13,"^")
 ;;=DVBA C RELEASE C&P REQUESTS
 ;;^UTILITY(U,$J,"OPT",3186,10,14,0)
 ;;=3202^^13
 ;;^UTILITY(U,$J,"OPT",3186,10,14,"^")
 ;;=DVBA C MEDICAL ADM REPORT MENU
 ;;^UTILITY(U,$J,"OPT",3186,10,15,0)
 ;;=3203^^14
 ;;^UTILITY(U,$J,"OPT",3186,10,15,"^")
 ;;=DVBA C REGIONAL OFF RPT MENU
 ;;^UTILITY(U,$J,"OPT",3186,10,16,0)
 ;;=3191^FIN^10
 ;;^UTILITY(U,$J,"OPT",3186,10,16,"^")
 ;;=DVBA C PRINT FINAL RESULTS
 ;;^UTILITY(U,$J,"OPT",3186,10,17,0)
 ;;=3206^^15
 ;;^UTILITY(U,$J,"OPT",3186,10,17,"^")
 ;;=DVBA C PENDING REPORT
 ;;^UTILITY(U,$J,"OPT",3186,10,18,0)
 ;;=3323^^16
 ;;^UTILITY(U,$J,"OPT",3186,10,18,"^")
 ;;=DVBA C NOT SCHEDULED IN 3 DAYS
 ;;^UTILITY(U,$J,"OPT",3186,10,19,0)
 ;;=3204^^17
 ;;^UTILITY(U,$J,"OPT",3186,10,19,"^")
 ;;=DVBA C EDIT C&P REQUEST INFO
 ;;^UTILITY(U,$J,"OPT",3186,10,20,0)
 ;;=3208^CHK^18
 ;;^UTILITY(U,$J,"OPT",3186,10,20,"^")
 ;;=DVBA C EXAM CHECKLIST
 ;;^UTILITY(U,$J,"OPT",3186,15)
 ;;=W:$D(IOF) @IOF,!!!!
 ;;^UTILITY(U,$J,"OPT",3186,20)
 ;;=S HD="COMPENSATION AND PENSION EXAM MAIN MENU" W @IOF,?(IOM-$L(HD)\2),HD,!! K HD
 ;;^UTILITY(U,$J,"OPT",3186,99)
 ;;=56204,45381
 ;;^UTILITY(U,$J,"OPT",3186,99.1)
 ;;=54203,59131
 ;;^UTILITY(U,$J,"OPT",3186,"U")
 ;;=COMPENSATION AND PENSION MAIN 
 ;;^UTILITY(U,$J,"OPT",3187,0)
 ;;=DVBA C ENTER C&P REQUEST^Enter a C&P Exam Request^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3187,1,0)
 ;;=^^1^1^2931028^^^^
 ;;^UTILITY(U,$J,"OPT",3187,1,1,0)
 ;;=Allows initial entry of a C&P request.
 ;;^UTILITY(U,$J,"OPT",3187,25)
 ;;=DVBCLOG
 ;;^UTILITY(U,$J,"OPT",3187,99)
 ;;=55623,27517
 ;;^UTILITY(U,$J,"OPT",3187,"U")
 ;;=ENTER A C&P EXAM REQUEST
 ;;^UTILITY(U,$J,"OPT",3188,0)
 ;;=DVBA C PRINT NEW C&P REQUESTS^Manual Printing of New C&P Requests^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3188,1,0)
 ;;=^^2^2^2940401^^^^
 ;;^UTILITY(U,$J,"OPT",3188,1,1,0)
 ;;=Allows manual printing of new C&P Requests.  This should be used in case
 ;;^UTILITY(U,$J,"OPT",3188,1,2,0)
 ;;=the TaskManager ever fails.
 ;;^UTILITY(U,$J,"OPT",3188,25)
 ;;=DVBCREQP
 ;;^UTILITY(U,$J,"OPT",3188,99)
 ;;=55628,56053
 ;;^UTILITY(U,$J,"OPT",3188,"U")
 ;;=MANUAL PRINTING OF NEW C&P REQ
 ;;^UTILITY(U,$J,"OPT",3189,0)
 ;;=DVBA C TRANSCRIBE REQUEST DATA^Transcribe C&P Data^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3189,1,0)
 ;;=^^2^2^2940707^^^^
 ;;^UTILITY(U,$J,"OPT",3189,1,1,0)
 ;;=Allows original transcription of C&P data as well as any editing that may
 ;;^UTILITY(U,$J,"OPT",3189,1,2,0)
 ;;=be desired later.
 ;;^UTILITY(U,$J,"OPT",3189,25)
 ;;=DVBCEDIT
 ;;^UTILITY(U,$J,"OPT",3189,"U")
 ;;=TRANSCRIBE C&P DATA
 ;;^UTILITY(U,$J,"OPT",3190,0)
 ;;=DVBA C CANCEL REQUESTS/EXAMS^Cancel C&P Requests/Exams^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3190,1,0)
 ;;=^^1^1^2920707^^^^
 ;;^UTILITY(U,$J,"OPT",3190,1,1,0)
 ;;=Allows cancellation of entire request or only selected tests.
 ;;^UTILITY(U,$J,"OPT",3190,25)
 ;;=DVBCCNCL
 ;;^UTILITY(U,$J,"OPT",3190,99)
 ;;=55675,42365
 ;;^UTILITY(U,$J,"OPT",3190,"U")
 ;;=CANCEL C&P REQUESTS/EXAMS
 ;;^UTILITY(U,$J,"OPT",3191,0)
 ;;=DVBA C PRINT FINAL RESULTS^Print C&P Final Report  (Manual)^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3191,1,0)
 ;;=^^1^1^2950322^^^^
 ;;^UTILITY(U,$J,"OPT",3191,1,1,0)
 ;;=Allows manual printing of 2507 Exam results.
 ;;^UTILITY(U,$J,"OPT",3191,25)
 ;;=DVBCPRNT
 ;;^UTILITY(U,$J,"OPT",3191,31)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3191,99)
 ;;=55661,43325
 ;;^UTILITY(U,$J,"OPT",3191,"U")
 ;;=PRINT C&P FINAL REPORT  (MANUA

DVBAI01Z
DVBAI01Z ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3192,0)
 ;;=DVBA C REOPEN REQUEST/EXAMS^Reopen C&P Requests/Exams (Supervisors Only)^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3192,1,0)
 ;;=^^2^2^2920407^^^^
 ;;^UTILITY(U,$J,"OPT",3192,1,1,0)
 ;;=Allows reopening of a 2507 Request in its entirety or only for selected
 ;;^UTILITY(U,$J,"OPT",3192,1,2,0)
 ;;=exams.  Request and exam reopening must be done by a supervisor.
 ;;^UTILITY(U,$J,"OPT",3192,25)
 ;;=DVBCROPN
 ;;^UTILITY(U,$J,"OPT",3192,99)
 ;;=55762,54399
 ;;^UTILITY(U,$J,"OPT",3192,"U")
 ;;=REOPEN C&P REQUESTS/EXAMS (SUP
 ;;^UTILITY(U,$J,"OPT",3193,0)
 ;;=DVBA C INQUIRY^Inquiry for C&P Requests^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3193,1,0)
 ;;=^^2^2^2930506^^^
 ;;^UTILITY(U,$J,"OPT",3193,1,1,0)
 ;;=Inquires on 2507 requests.  Shows basic information, what is on file
 ;;^UTILITY(U,$J,"OPT",3193,1,2,0)
 ;;=and gives detailed exam information.
 ;;^UTILITY(U,$J,"OPT",3193,25)
 ;;=DVBCENQ
 ;;^UTILITY(U,$J,"OPT",3193,99)
 ;;=55623,47171
 ;;^UTILITY(U,$J,"OPT",3193,"U")
 ;;=INQUIRY FOR C&P REQUESTS
 ;;^UTILITY(U,$J,"OPT",3194,0)
 ;;=DVBA C ADD ADDITIONAL EXAM^Add an Exam to an Existing Request^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3194,1,0)
 ;;=^^4^4^2930318^^^^
 ;;^UTILITY(U,$J,"OPT",3194,1,1,0)
 ;;=Allows adding another exam to an existing request provided
 ;;^UTILITY(U,$J,"OPT",3194,1,2,0)
 ;;=that it has a status which will allow addition.  Those that
 ;;^UTILITY(U,$J,"OPT",3194,1,3,0)
 ;;=are transcribed, cancelled , completed or transferred in
 ;;^UTILITY(U,$J,"OPT",3194,1,4,0)
 ;;=will not be allowed to have exams added.
 ;;^UTILITY(U,$J,"OPT",3194,25)
 ;;=DVBCADEX
 ;;^UTILITY(U,$J,"OPT",3194,"U")
 ;;=ADD AN EXAM TO AN EXISTING REQ
 ;;^UTILITY(U,$J,"OPT",3195,0)
 ;;=DVBA C SCHEDULE EXAMS^Schedule C&P Exams^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3195,1,0)
 ;;=^^3^3^2940401^^^^
 ;;^UTILITY(U,$J,"OPT",3195,1,1,0)
 ;;=Schedules individual exams for C&P Requests via ^SDM in ADT/Scheduling
 ;;^UTILITY(U,$J,"OPT",3195,1,2,0)
 ;;=package.  Operator must write down appointment dates and enter manually
 ;;^UTILITY(U,$J,"OPT",3195,1,3,0)
 ;;=upon returning from the Scheduling package.
 ;;^UTILITY(U,$J,"OPT",3195,25)
 ;;=DVBCSCHD
 ;;^UTILITY(U,$J,"OPT",3195,99)
 ;;=55663,42959
 ;;^UTILITY(U,$J,"OPT",3195,"U")
 ;;=SCHEDULE C&P EXAMS
 ;;^UTILITY(U,$J,"OPT",3196,0)
 ;;=DVBA C PRINT NEW C&P REQ TM^Print New C&P Requests (Task Manager)^^A^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1
 ;;^UTILITY(U,$J,"OPT",3196,1,0)
 ;;=^^5^5^2940707^^^^
 ;;^UTILITY(U,$J,"OPT",3196,1,1,0)
 ;;=Prints new C&P requests for "T-?".  Prints without regard to when
 ;;^UTILITY(U,$J,"OPT",3196,1,2,0)
 ;;=the actual exams are scheduled.
 ;;^UTILITY(U,$J,"OPT",3196,1,3,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3196,1,4,0)
 ;;=The routine DVBCREQ2 screens the date range based on the day of the week
 ;;^UTILITY(U,$J,"OPT",3196,1,5,0)
 ;;=and entries in the AMIE SITE PARAMETER file.
 ;;^UTILITY(U,$J,"OPT",3196,20)
 ;;=D TASK^DVBCREQP
 ;;^UTILITY(U,$J,"OPT",3196,99)
 ;;=55651,58015
 ;;^UTILITY(U,$J,"OPT",3196,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3196,"U")
 ;;=PRINT NEW C&P REQUESTS (TASK M
 ;;^UTILITY(U,$J,"OPT",3197,0)
 ;;=DVBA C REGIONAL OFFICE MENU^Regional Office C&P Menu^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3197,1,0)
 ;;=^^1^1^2930329^^^^
 ;;^UTILITY(U,$J,"OPT",3197,1,1,0)
 ;;=Main C&P Menu for the Regional Office.
 ;;^UTILITY(U,$J,"OPT",3197,10,0)
 ;;=^19.01PI^9^7
 ;;^UTILITY(U,$J,"OPT",3197,10,1,0)
 ;;=3187^1^1
 ;;^UTILITY(U,$J,"OPT",3197,10,1,"^")
 ;;=DVBA C ENTER C&P REQUEST
 ;;^UTILITY(U,$J,"OPT",3197,10,2,0)
 ;;=3190^4^4
 ;;^UTILITY(U,$J,"OPT",3197,10,2,"^")
 ;;=DVBA C CANCEL REQUESTS/EXAMS
 ;;^UTILITY(U,$J,"OPT",3197,10,3,0)
 ;;=3193^5^5
 ;;^UTILITY(U,$J,"OPT",3197,10,3,"^")
 ;;=DVBA C INQUIRY
 ;;^UTILITY(U,$J,"OPT",3197,10,6,0)
 ;;=3203^7^7
 ;;^UTILITY(U,$J,"OPT",3197,10,6,"^")
 ;;=DVBA C REGIONAL OFF RPT MENU
 ;;^UTILITY(U,$J,"OPT",3197,10,7,0)
 ;;=3204^3^3
 ;;^UTILITY(U,$J,"OPT",3197,10,7,"^")
 ;;=DVBA C EDIT C&P REQUEST INFO
 ;;^UTILITY(U,$J,"OPT",3197,10,8,0)
 ;;=3194^2^2
 ;;^UTILITY(U,$J,"OPT",3197,10,8,"^")
 ;;=DVBA C ADD ADDITIONAL EXAM
 ;;^UTILITY(U,$J,"OPT",3197,10,9,0)
 ;;=3931^6^6
 ;;^UTILITY(U,$J,"OPT",3197,10,9,"^")
 ;;=DVBA C EDIT PAT ADDRESS
 ;;^UTILITY(U,$J,"OPT",3197,15)
 ;;=W:$D(IOF) @IOF,!!
 ;;^UTILITY(U,$J,"OPT",3197,20)
 ;;=D ^DVBAALRT D HOME^%ZIS K IOP S HD="Regional Office C&P Menu" W @IOF,?(IOM-$L(HD)\2),HD,!!! K HD
 ;;^UTILITY(U,$J,"OPT",3197,99)
 ;;=56204,45495
 ;;^UTILITY(U,$J,"OPT",3197,99.1)
 ;;=54745,46641

DVBAI020
DVBAI020 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3197,"U")
 ;;=REGIONAL OFFICE C&P MENU
 ;;^UTILITY(U,$J,"OPT",3198,0)
 ;;=DVBA C MEDICAL ADMIN C&P MENU^Medical Administration C&P Menu^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3198,1,0)
 ;;=^^1^1^2941108^^^^
 ;;^UTILITY(U,$J,"OPT",3198,1,1,0)
 ;;=Medical Administration main C&P menu.
 ;;^UTILITY(U,$J,"OPT",3198,10,0)
 ;;=^19.01PI^16^12
 ;;^UTILITY(U,$J,"OPT",3198,10,1,0)
 ;;=3190^5^5
 ;;^UTILITY(U,$J,"OPT",3198,10,1,"^")
 ;;=DVBA C CANCEL REQUESTS/EXAMS
 ;;^UTILITY(U,$J,"OPT",3198,10,2,0)
 ;;=3189^7^7
 ;;^UTILITY(U,$J,"OPT",3198,10,2,"^")
 ;;=DVBA C TRANSCRIBE REQUEST DATA
 ;;^UTILITY(U,$J,"OPT",3198,10,3,0)
 ;;=3193^9^9
 ;;^UTILITY(U,$J,"OPT",3198,10,3,"^")
 ;;=DVBA C INQUIRY
 ;;^UTILITY(U,$J,"OPT",3198,10,6,0)
 ;;=3195^4^4
 ;;^UTILITY(U,$J,"OPT",3198,10,6,"^")
 ;;=DVBA C SCHEDULE EXAMS
 ;;^UTILITY(U,$J,"OPT",3198,10,8,0)
 ;;=3192^6^6
 ;;^UTILITY(U,$J,"OPT",3198,10,8,"^")
 ;;=DVBA C REOPEN REQUEST/EXAMS
 ;;^UTILITY(U,$J,"OPT",3198,10,10,0)
 ;;=3201^8^8
 ;;^UTILITY(U,$J,"OPT",3198,10,10,"^")
 ;;=DVBA C RELEASE C&P REQUESTS
 ;;^UTILITY(U,$J,"OPT",3198,10,11,0)
 ;;=3202^10^10
 ;;^UTILITY(U,$J,"OPT",3198,10,11,"^")
 ;;=DVBA C MEDICAL ADM REPORT MENU
 ;;^UTILITY(U,$J,"OPT",3198,10,12,0)
 ;;=3194^1^1
 ;;^UTILITY(U,$J,"OPT",3198,10,12,"^")
 ;;=DVBA C ADD ADDITIONAL EXAM
 ;;^UTILITY(U,$J,"OPT",3198,10,13,0)
 ;;=3215^2^2
 ;;^UTILITY(U,$J,"OPT",3198,10,13,"^")
 ;;=DVBA C TRANSFER C&P REQUEST
 ;;^UTILITY(U,$J,"OPT",3198,10,14,0)
 ;;=3216^3^3
 ;;^UTILITY(U,$J,"OPT",3198,10,14,"^")
 ;;=DVBA C MANUAL C&P XFER RETURN
 ;;^UTILITY(U,$J,"OPT",3198,10,15,0)
 ;;=4538^11^11
 ;;^UTILITY(U,$J,"OPT",3198,10,15,"^")
 ;;=DVBA C PHYSICIANS GUIDE
 ;;^UTILITY(U,$J,"OPT",3198,10,16,0)
 ;;=4783^12^12
 ;;^UTILITY(U,$J,"OPT",3198,10,16,"^")
 ;;=DVBA C C&P LINK MANAGEMENT
 ;;^UTILITY(U,$J,"OPT",3198,15)
 ;;=W:$D(IOF) @IOF,!!
 ;;^UTILITY(U,$J,"OPT",3198,20)
 ;;=D HOME^%ZIS K IOP S HD="Medical Administration C&P Menu" W @IOF,?(IOM-$L(HD)\2),HD,!!! K HD
 ;;^UTILITY(U,$J,"OPT",3198,99)
 ;;=56347,49366
 ;;^UTILITY(U,$J,"OPT",3198,99.1)
 ;;=54240,37637
 ;;^UTILITY(U,$J,"OPT",3198,"U")
 ;;=MEDICAL ADMINISTRATION C&P MEN
 ;;^UTILITY(U,$J,"OPT",3199,0)
 ;;=DVBA C PURGE 2507^Purge Old 2507 Requests (TaskMan)^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3199,1,0)
 ;;=^^4^4^2940831^^^^
 ;;^UTILITY(U,$J,"OPT",3199,1,1,0)
 ;;=Purges 2507 requests that are older than the number of days in the
 ;;^UTILITY(U,$J,"OPT",3199,1,2,0)
 ;;=parameter, DAYS TO KEEP 2507 HISTORY.  
 ;;^UTILITY(U,$J,"OPT",3199,1,3,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3199,1,4,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3199,25)
 ;;=DVBCPURG
 ;;^UTILITY(U,$J,"OPT",3199,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3199,"U")
 ;;=PURGE OLD 2507 REQUESTS (TASKM
 ;;^UTILITY(U,$J,"OPT",3200,0)
 ;;=DVBA C REPRINT 2507 FINAL RPT^Reprint C&P Final Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3200,1,0)
 ;;=^^6^6^2950322^^^^
 ;;^UTILITY(U,$J,"OPT",3200,1,1,0)
 ;;=Reprints final 2507 for the RO or anyone else who wishes it.  The user must
 ;;^UTILITY(U,$J,"OPT",3200,1,2,0)
 ;;=have a division which matches the claim folder location of the veteran or
 ;;^UTILITY(U,$J,"OPT",3200,1,3,0)
 ;;=he/she must hold the DVBA C SUPERVISOR key.
 ;;^UTILITY(U,$J,"OPT",3200,1,4,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3200,1,5,0)
 ;;=The user is queried whether he/she is from the RO or MAS and the answer will
 ;;^UTILITY(U,$J,"OPT",3200,1,6,0)
 ;;=affect the footer type on the last page of the exam results.
 ;;^UTILITY(U,$J,"OPT",3200,25)
 ;;=DVBCRPON
 ;;^UTILITY(U,$J,"OPT",3200,99)
 ;;=55677,59235
 ;;^UTILITY(U,$J,"OPT",3200,"U")
 ;;=REPRINT C&P FINAL REPORT
 ;;^UTILITY(U,$J,"OPT",3201,0)
 ;;=DVBA C RELEASE C&P REQUESTS^Release C&P Requests^^R^^DVBA C RELEASE 2507^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3201,1,0)
 ;;=^^3^3^2940706^^^^
 ;;^UTILITY(U,$J,"OPT",3201,1,1,0)
 ;;=Allows release of any 2507 requests which have all exams showing as 
 ;;^UTILITY(U,$J,"OPT",3201,1,2,0)
 ;;=completed.  All exams on a request MUST be completed before it can be
 ;;^UTILITY(U,$J,"OPT",3201,1,3,0)
 ;;=released.
 ;;^UTILITY(U,$J,"OPT",3201,25)
 ;;=DVBCRELS
 ;;^UTILITY(U,$J,"OPT",3201,"U")
 ;;=RELEASE C&P REQUESTS
 ;;^UTILITY(U,$J,"OPT",3202,0)
 ;;=DVBA C MEDICAL ADM REPORT MENU^C&P Reports Menu^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3202,1,0)
 ;;=^^1^1^2941129^^^^
 ;;^UTILITY(U,$J,"OPT",3202,1,1,0)
 ;;=The menu that has all reports for the Medical Administration.
 ;;^UTILITY(U,$J,"OPT",3202,10,0)
 ;;=^19.01PI^11^10
 ;;^UTILITY(U,$J,"OPT",3202,10,1,0)
 ;;=3205^5^5

DVBAI021
DVBAI021 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3202,10,1,"^")
 ;;=DVBA C AMIS REPORT
 ;;^UTILITY(U,$J,"OPT",3202,10,2,0)
 ;;=3206^3^3
 ;;^UTILITY(U,$J,"OPT",3202,10,2,"^")
 ;;=DVBA C PENDING REPORT
 ;;^UTILITY(U,$J,"OPT",3202,10,3,0)
 ;;=3323^4^4
 ;;^UTILITY(U,$J,"OPT",3202,10,3,"^")
 ;;=DVBA C NOT SCHEDULED IN 3 DAYS
 ;;^UTILITY(U,$J,"OPT",3202,10,4,0)
 ;;=3188^1^1
 ;;^UTILITY(U,$J,"OPT",3202,10,4,"^")
 ;;=DVBA C PRINT NEW C&P REQUESTS
 ;;^UTILITY(U,$J,"OPT",3202,10,6,0)
 ;;=3200^7^7
 ;;^UTILITY(U,$J,"OPT",3202,10,6,"^")
 ;;=DVBA C REPRINT 2507 FINAL RPT
 ;;^UTILITY(U,$J,"OPT",3202,10,7,0)
 ;;=3209^6^6
 ;;^UTILITY(U,$J,"OPT",3202,10,7,"^")
 ;;=DVBA C PRINT FEE COVER SHEET
 ;;^UTILITY(U,$J,"OPT",3202,10,8,0)
 ;;=3210^8^8
 ;;^UTILITY(U,$J,"OPT",3202,10,8,"^")
 ;;=DVBA C REQUESTS BY DATE RANGE
 ;;^UTILITY(U,$J,"OPT",3202,10,9,0)
 ;;=3211^9^9
 ;;^UTILITY(U,$J,"OPT",3202,10,9,"^")
 ;;=DVBA C CHECK 2507 INTEGRITY
 ;;^UTILITY(U,$J,"OPT",3202,10,10,0)
 ;;=3214^2^2
 ;;^UTILITY(U,$J,"OPT",3202,10,10,"^")
 ;;=DVBA C PRINT WORKSHEETS
 ;;^UTILITY(U,$J,"OPT",3202,10,11,0)
 ;;=4784^10^10
 ;;^UTILITY(U,$J,"OPT",3202,10,11,"^")
 ;;=DVBA C INSUFFICIENT EXAM RPT
 ;;^UTILITY(U,$J,"OPT",3202,15)
 ;;=W:$D(IOF) @IOF,!!!!
 ;;^UTILITY(U,$J,"OPT",3202,20)
 ;;=S DVBCHD="Medical Administration C&P Reports Menu" W:$D(IOF) @IOF W !,?(79-$L(DVBCHD)\2),DVBCHD,!!! K DVBCHD
 ;;^UTILITY(U,$J,"OPT",3202,99)
 ;;=56204,45735
 ;;^UTILITY(U,$J,"OPT",3202,"U")
 ;;=C&P REPORTS MENU
 ;;^UTILITY(U,$J,"OPT",3203,0)
 ;;=DVBA C REGIONAL OFF RPT MENU^Regional Office Reports Menu^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE^^1^1
 ;;^UTILITY(U,$J,"OPT",3203,1,0)
 ;;=^^1^1^2941117^^^^
 ;;^UTILITY(U,$J,"OPT",3203,1,1,0)
 ;;=Has all reports that the Regional Office will use.
 ;;^UTILITY(U,$J,"OPT",3203,10,0)
 ;;=^19.01PI^6^6
 ;;^UTILITY(U,$J,"OPT",3203,10,1,0)
 ;;=3213^4^4
 ;;^UTILITY(U,$J,"OPT",3203,10,1,"^")
 ;;=DVBA C RO AMIS 290
 ;;^UTILITY(U,$J,"OPT",3203,10,2,0)
 ;;=3206^3^3
 ;;^UTILITY(U,$J,"OPT",3203,10,2,"^")
 ;;=DVBA C PENDING REPORT
 ;;^UTILITY(U,$J,"OPT",3203,10,3,0)
 ;;=3191^1^1
 ;;^UTILITY(U,$J,"OPT",3203,10,3,"^")
 ;;=DVBA C PRINT FINAL RESULTS
 ;;^UTILITY(U,$J,"OPT",3203,10,4,0)
 ;;=3200^2^2
 ;;^UTILITY(U,$J,"OPT",3203,10,4,"^")
 ;;=DVBA C REPRINT 2507 FINAL RPT
 ;;^UTILITY(U,$J,"OPT",3203,10,5,0)
 ;;=3208^5^5
 ;;^UTILITY(U,$J,"OPT",3203,10,5,"^")
 ;;=DVBA C EXAM CHECKLIST
 ;;^UTILITY(U,$J,"OPT",3203,10,6,0)
 ;;=4784^6^6
 ;;^UTILITY(U,$J,"OPT",3203,10,6,"^")
 ;;=DVBA C INSUFFICIENT EXAM RPT
 ;;^UTILITY(U,$J,"OPT",3203,15)
 ;;=W:$D(IOF) @IOF,!!!!
 ;;^UTILITY(U,$J,"OPT",3203,20)
 ;;=S DVBCHD="Regional Office Reports Menu" W:$D(IOF) @IOF,! W ?(79-$L(DVBCHD)\2),DVBCHD,!!! K DVBCHD
 ;;^UTILITY(U,$J,"OPT",3203,99)
 ;;=56204,45735
 ;;^UTILITY(U,$J,"OPT",3203,"U")
 ;;=REGIONAL OFFICE REPORTS MENU
 ;;^UTILITY(U,$J,"OPT",3204,0)
 ;;=DVBA C EDIT C&P REQUEST INFO^Edit C&P Request Information^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3204,1,0)
 ;;=^^2^2^2920813^^^^
 ;;^UTILITY(U,$J,"OPT",3204,1,1,0)
 ;;=Allows editing of only the static 2507 information and the remarks.
 ;;^UTILITY(U,$J,"OPT",3204,1,2,0)
 ;;=Does not allow any editing of exam information.
 ;;^UTILITY(U,$J,"OPT",3204,25)
 ;;=DVBCREDT
 ;;^UTILITY(U,$J,"OPT",3204,"U")
 ;;=EDIT C&P REQUEST INFORMATION
 ;;^UTILITY(U,$J,"OPT",3205,0)
 ;;=DVBA C AMIS REPORT^AMIS 290 Report for C&P^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3205,1,0)
 ;;=^^3^3^2940610^^^^
 ;;^UTILITY(U,$J,"OPT",3205,1,1,0)
 ;;=Generates AMIS figures for the C&P exams.  Also will optionally send a
 ;;^UTILITY(U,$J,"OPT",3205,1,2,0)
 ;;=bulletin when completed.  The bulletins may be sent via NetMail if
 ;;^UTILITY(U,$J,"OPT",3205,1,3,0)
 ;;=desired.
 ;;^UTILITY(U,$J,"OPT",3205,25)
 ;;=DVBCAMIS
 ;;^UTILITY(U,$J,"OPT",3205,"U")
 ;;=AMIS 290 REPORT FOR C&P
 ;;^UTILITY(U,$J,"OPT",3206,0)
 ;;=DVBA C PENDING REPORT^Pending C&P Exams Report^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3206,1,0)
 ;;=^^7^7^2940401^^^^
 ;;^UTILITY(U,$J,"OPT",3206,1,1,0)
 ;;=Reports any C&P request which are not R, X, RX, C, or CT status.
 ;;^UTILITY(U,$J,"OPT",3206,1,2,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3206,1,3,0)
 ;;="R" status indicates "released to RO, not printed".
 ;;^UTILITY(U,$J,"OPT",3206,1,4,0)
 ;;="C" status indicates "Completed, printed by the RO".
 ;;^UTILITY(U,$J,"OPT",3206,1,5,0)
 ;;="X" status indicates "Cancelled by MAS".
 ;;^UTILITY(U,$J,"OPT",3206,1,6,0)
 ;;="RX" status indicates "Cancelled by the RO".
 ;;^UTILITY(U,$J,"OPT",3206,1,7,0)
 ;;="CT" status indicates "Completed, transferred out".
 ;;^UTILITY(U,$J,"OPT",3206,25)
 ;;=DVBCPNDR

DVBAI022
DVBAI022 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3206,"U")
 ;;=PENDING C&P EXAMS REPORT
 ;;^UTILITY(U,$J,"OPT",3208,0)
 ;;=DVBA C EXAM CHECKLIST^Print Exam Check List for RO^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3208,1,0)
 ;;=^^5^5^2940401^^^^
 ;;^UTILITY(U,$J,"OPT",3208,1,1,0)
 ;;=Prints a checklist for the RO which is to be used by the Rating Board
 ;;^UTILITY(U,$J,"OPT",3208,1,2,0)
 ;;=in the selection of C & P Exams for Veterans.  It may be run as often
 ;;^UTILITY(U,$J,"OPT",3208,1,3,0)
 ;;=as needed by the RO and should be run whenever exam changes occur.
 ;;^UTILITY(U,$J,"OPT",3208,1,4,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3208,1,5,0)
 ;;=This checklist will only be used internally by the RO.
 ;;^UTILITY(U,$J,"OPT",3208,25)
 ;;=DVBCEXML
 ;;^UTILITY(U,$J,"OPT",3208,60)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3208,62)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3208,63)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3208,64)
 ;;=
 ;;^UTILITY(U,$J,"OPT",3208,"U")
 ;;=PRINT EXAM CHECK LIST FOR RO
 ;;^UTILITY(U,$J,"OPT",3209,0)
 ;;=DVBA C PRINT FEE COVER SHEET^Print a Fee Exam Cover Sheet^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3209,1,0)
 ;;=^^2^2^2920813^^^
 ;;^UTILITY(U,$J,"OPT",3209,1,1,0)
 ;;=Prints a cover sheet for cases where the Veteran's physician might not
 ;;^UTILITY(U,$J,"OPT",3209,1,2,0)
 ;;=be familiar with Comp and Pen exams.
 ;;^UTILITY(U,$J,"OPT",3209,25)
 ;;=DVBCFEE
 ;;^UTILITY(U,$J,"OPT",3209,"U")
 ;;=PRINT A FEE EXAM COVER SHEET
 ;;^UTILITY(U,$J,"OPT",3210,0)
 ;;=DVBA C REQUESTS BY DATE RANGE^C&P Request List by Date Range^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3210,1,0)
 ;;=^^4^4^2930329^^^^
 ;;^UTILITY(U,$J,"OPT",3210,1,1,0)
 ;;=This option is used to produce a listing of any 2507 requests on a
 ;;^UTILITY(U,$J,"OPT",3210,1,2,0)
 ;;=date range basis.  A typical use for this option would be to help
 ;;^UTILITY(U,$J,"OPT",3210,1,3,0)
 ;;=reconcile missing requests if some were lost due to printer problems
 ;;^UTILITY(U,$J,"OPT",3210,1,4,0)
 ;;=during the morning printing.
 ;;^UTILITY(U,$J,"OPT",3210,25)
 ;;=DVBCRLST
 ;;^UTILITY(U,$J,"OPT",3210,99)
 ;;=55629,27358
 ;;^UTILITY(U,$J,"OPT",3210,"U")
 ;;=C&P REQUEST LIST BY DATE RANGE
 ;;^UTILITY(U,$J,"OPT",3211,0)
 ;;=DVBA C CHECK 2507 INTEGRITY^Check C&P File Integrity^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3211,1,0)
 ;;=^^1^1^2940401^^^^
 ;;^UTILITY(U,$J,"OPT",3211,1,1,0)
 ;;=Checks 2507 REQUEST file (396.3) for missing crucial information.
 ;;^UTILITY(U,$J,"OPT",3211,25)
 ;;=DVBCCHKR
 ;;^UTILITY(U,$J,"OPT",3211,"U")
 ;;=CHECK C&P FILE INTEGRITY
 ;;^UTILITY(U,$J,"OPT",3212,0)
 ;;=DVBA C CHECK 2507 INTEGRITY TM^Check C&P File Integrity (TaskMan)^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3212,1,0)
 ;;=^^1^1^2940401^^
 ;;^UTILITY(U,$J,"OPT",3212,1,1,0)
 ;;=TaskMan version of the 2507 REQUEST integrity checker.
 ;;^UTILITY(U,$J,"OPT",3212,25)
 ;;=GO^DVBCCHKR
 ;;^UTILITY(U,$J,"OPT",3212,200.9)
 ;;=y
 ;;^UTILITY(U,$J,"OPT",3212,"U")
 ;;=CHECK C&P FILE INTEGRITY (TASK
 ;;^UTILITY(U,$J,"OPT",3213,0)
 ;;=DVBA C RO AMIS 290^AMIS 290 for the Regional Office^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3213,1,0)
 ;;=^^1^1^2920828^^^^
 ;;^UTILITY(U,$J,"OPT",3213,1,1,0)
 ;;=This option will give AMIS 290 totals for individual regional offices.
 ;;^UTILITY(U,$J,"OPT",3213,25)
 ;;=DVBCAMRO
 ;;^UTILITY(U,$J,"OPT",3213,"U")
 ;;=AMIS 290 FOR THE REGIONAL OFFI
 ;;^UTILITY(U,$J,"OPT",3214,0)
 ;;=DVBA C PRINT WORKSHEETS^Print/Reprint C&P Work Sheets^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3214,1,0)
 ;;=^^2^2^2930624^^^^
 ;;^UTILITY(U,$J,"OPT",3214,1,1,0)
 ;;=Allows medical center to reprint C&P work sheets on an 'one, many, all'
 ;;^UTILITY(U,$J,"OPT",3214,1,2,0)
 ;;=basis.
 ;;^UTILITY(U,$J,"OPT",3214,25)
 ;;=RPRT^DVBCADE1
 ;;^UTILITY(U,$J,"OPT",3214,99)
 ;;=55692,62678
 ;;^UTILITY(U,$J,"OPT",3214,"U")
 ;;=PRINT/REPRINT C&P WORK SHEETS
 ;;^UTILITY(U,$J,"OPT",3215,0)
 ;;=DVBA C TRANSFER C&P REQUEST^Transfer a C&P Request to Another Site^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3215,1,0)
 ;;=^^2^2^2940712^^^^
 ;;^UTILITY(U,$J,"OPT",3215,1,1,0)
 ;;=Transfers a C&P request to another site.  This option should be used
 ;;^UTILITY(U,$J,"OPT",3215,1,2,0)
 ;;=only when necessary and by persons who are familiar with what it does.
 ;;^UTILITY(U,$J,"OPT",3215,25)
 ;;=DVBCXFRA
 ;;^UTILITY(U,$J,"OPT",3215,99)
 ;;=55783,54953
 ;;^UTILITY(U,$J,"OPT",3215,"U")
 ;;=TRANSFER A C&P REQUEST TO ANOT
 ;;^UTILITY(U,$J,"OPT",3216,0)
 ;;=DVBA C MANUAL C&P XFER RETURN^Manual Return of Transferred C&P Requests^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE

DVBAI023
DVBAI023 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",3216,1,0)
 ;;=^^8^8^2930521^^^^
 ;;^UTILITY(U,$J,"OPT",3216,1,1,0)
 ;;=This option is used to manually return transferred C&P requests.  It should
 ;;^UTILITY(U,$J,"OPT",3216,1,2,0)
 ;;=only be used when the normal return (via the release option) fails.
 ;;^UTILITY(U,$J,"OPT",3216,1,3,0)
 ;;= 
 ;;^UTILITY(U,$J,"OPT",3216,1,4,0)
 ;;=When a request is released, the system checks to see if it is a transfer.  
 ;;^UTILITY(U,$J,"OPT",3216,1,5,0)
 ;;=If it is, it will automatically attempt to return it at release time.  
 ;;^UTILITY(U,$J,"OPT",3216,1,6,0)
 ;;=However, due to problems that may arise (user deletion of information, etc)
 ;;^UTILITY(U,$J,"OPT",3216,1,7,0)
 ;;=the return may fail.  In this event the MAS supervisor should repair any
 ;;^UTILITY(U,$J,"OPT",3216,1,8,0)
 ;;=problems and attempt to send it back with this option.
 ;;^UTILITY(U,$J,"OPT",3216,25)
 ;;=MANUAL^DVBCXFRE
 ;;^UTILITY(U,$J,"OPT",3216,"U")
 ;;=MANUAL RETURN OF TRANSFERRED C
 ;;^UTILITY(U,$J,"OPT",3323,0)
 ;;=DVBA C NOT SCHEDULED IN 3 DAYS^Report for Exams Not Scheduled in Three Days^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3323,1,0)
 ;;=^^2^2^2930119^^^^
 ;;^UTILITY(U,$J,"OPT",3323,1,1,0)
 ;;=Reports exams which have not been scheduled within three days of the
 ;;^UTILITY(U,$J,"OPT",3323,1,2,0)
 ;;=request date.
 ;;^UTILITY(U,$J,"OPT",3323,25)
 ;;=DVBCNTSC
 ;;^UTILITY(U,$J,"OPT",3323,99)
 ;;=55628,55202
 ;;^UTILITY(U,$J,"OPT",3323,"U")
 ;;=REPORT FOR EXAMS NOT SCHEDULED
 ;;^UTILITY(U,$J,"OPT",3931,0)
 ;;=DVBA C EDIT PAT ADDRESS^Edit Patient Address Information^^R^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",3931,1,0)
 ;;=^^1^1^2930427^^
 ;;^UTILITY(U,$J,"OPT",3931,1,1,0)
 ;;=This option will allow the user to edit any patient's address information.
 ;;^UTILITY(U,$J,"OPT",3931,25)
 ;;=DVBCADR
 ;;^UTILITY(U,$J,"OPT",3931,"U")
 ;;=EDIT PATIENT ADDRESS INFORMATI
 ;;^UTILITY(U,$J,"OPT",4048,0)
 ;;=DVBA C PROCESS MAIL MESSAGE^Process C&P Mail Message^OUT OF ORDER^S^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"OPT",4048,1,0)
 ;;=^^2^2^2941003^^^^
 ;;^UTILITY(U,$J,"OPT",4048,1,1,0)
 ;;=Automatically processes C&P request transfer from site to site.
 ;;^UTILITY(U,$J,"OPT",4048,1,2,0)
 ;;=This is a MailMan server routine.
 ;;^UTILITY(U,$J,"OPT",4048,25)
 ;;=DVBCXFRC
 ;;^UTILITY(U,$J,"OPT",4048,220)
 ;;=^R^^Y^N^R
 ;;^UTILITY(U,$J,"OPT",4048,"U")
 ;;=PROCESS C&P MAIL MESSAGE
 ;;^UTILITY(U,$J,"OPT",4538,0)
 ;;=DVBA C PHYSICIANS GUIDE^Physician's Guide for Disability Evaluation Exams^OUT OF ORDER^R^^^^^^^^
 ;;^UTILITY(U,$J,"OPT",4538,1,0)
 ;;=^^2^2^2940801^^^^
 ;;^UTILITY(U,$J,"OPT",4538,1,1,0)
 ;;=An addition to the AMIE menu system to access the Physician's Guide for
 ;;^UTILITY(U,$J,"OPT",4538,1,2,0)
 ;;=Disability Evaluation Examinations.
 ;;^UTILITY(U,$J,"OPT",4538,25)
 ;;=N^DVBCPGD
 ;;^UTILITY(U,$J,"OPT",4538,"U")
 ;;=PHYSICIAN'S GUIDE FOR DISABILI
 ;;^UTILITY(U,$J,"OPT",4783,0)
 ;;=DVBA C C&P LINK MANAGEMENT^AMIE/C&P Appointment Link Management^^R^^^^^^^^^^^1
 ;;^UTILITY(U,$J,"OPT",4783,1,0)
 ;;=^^3^3^2941230^^^^
 ;;^UTILITY(U,$J,"OPT",4783,1,1,0)
 ;;=This option has been added to the DVBA C MEDICAL ADMIN C&P MENU.  It allows
 ;;^UTILITY(U,$J,"OPT",4783,1,2,0)
 ;;=a C&P user to maintain the C&P appointment to 2507 request links in the
 ;;^UTILITY(U,$J,"OPT",4783,1,3,0)
 ;;=AMIE C&P EXAM TRACKING file (396.95).
 ;;^UTILITY(U,$J,"OPT",4783,15)
 ;;=W:$D(IOF) @IOF,!!
 ;;^UTILITY(U,$J,"OPT",4783,25)
 ;;=DVBCLKTL
 ;;^UTILITY(U,$J,"OPT",4783,"U")
 ;;=AMIE/C&P APPOINTMENT LINK MANA
 ;;^UTILITY(U,$J,"OPT",4784,0)
 ;;=DVBA C INSUFFICIENT EXAM RPT^Insufficient Exam Report^^R^^^^^^^^^^^1
 ;;^UTILITY(U,$J,"OPT",4784,1,0)
 ;;=^^3^3^2941117^^
 ;;^UTILITY(U,$J,"OPT",4784,1,1,0)
 ;;=This option is used by both Medical Center and Regional Office users to
 ;;^UTILITY(U,$J,"OPT",4784,1,2,0)
 ;;=report information about 2507 requests returned with a priority of
 ;;^UTILITY(U,$J,"OPT",4784,1,3,0)
 ;;=Insufficient Exam.
 ;;^UTILITY(U,$J,"OPT",4784,15)
 ;;=W:$D(IOF) @IOF,!!
 ;;^UTILITY(U,$J,"OPT",4784,25)
 ;;=DVBCIRPT
 ;;^UTILITY(U,$J,"OPT",4784,"U")
 ;;=INSUFFICIENT EXAM REPORT
 ;;^UTILITY(U,$J,"OPT",4828,0)
 ;;=DVBA 7131 DIVISIONAL TRANSFER^7131 Divisional Transfer^^R^^^^^^^^^^^1
 ;;^UTILITY(U,$J,"OPT",4828,1,0)
 ;;=^^2^2^2941209^
 ;;^UTILITY(U,$J,"OPT",4828,1,1,0)
 ;;=This option is used by Medical Center users to transfer reports
 ;;^UTILITY(U,$J,"OPT",4828,1,2,0)
 ;;=requested on 7131's received from their Regional Offices.
 ;;^UTILITY(U,$J,"OPT",4828,15)
 ;;=W:$D(IOF) @IOF,!!

DVBAI024
DVBAI024 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"OPT",4828,25)
 ;;=DVBADXFR
 ;;^UTILITY(U,$J,"OPT",4828,"U")
 ;;=7131 DIVISIONAL TRANSFER
 ;;^UTILITY(U,$J,"OR",223,0)
 ;;=223^DVBA
 ;;^UTILITY(U,$J,"OR",223,1,0)
 ;;=^100.9951PA^5^5
 ;;^UTILITY(U,$J,"OR",223,1,1,0)
 ;;=VALM NEXT SCREEN
 ;;^UTILITY(U,$J,"OR",223,1,1,1,0)
 ;;=^100.99511PA^1^1
 ;;^UTILITY(U,$J,"OR",223,1,1,1,1,0)
 ;;=DVBA C VIEW EXAMS (MENU)
 ;;^UTILITY(U,$J,"OR",223,1,2,0)
 ;;=VALM PREVIOUS SCREEN
 ;;^UTILITY(U,$J,"OR",223,1,2,1,0)
 ;;=^100.99511PA^1^1
 ;;^UTILITY(U,$J,"OR",223,1,2,1,1,0)
 ;;=DVBA C VIEW EXAMS (MENU)
 ;;^UTILITY(U,$J,"OR",223,1,3,0)
 ;;=VALM PRINT LIST
 ;;^UTILITY(U,$J,"OR",223,1,3,1,0)
 ;;=^100.99511PA^1^1
 ;;^UTILITY(U,$J,"OR",223,1,3,1,1,0)
 ;;=DVBA C VIEW EXAMS (MENU)
 ;;^UTILITY(U,$J,"OR",223,1,4,0)
 ;;=VALM QUIT
 ;;^UTILITY(U,$J,"OR",223,1,4,1,0)
 ;;=^100.99511PA^2^2
 ;;^UTILITY(U,$J,"OR",223,1,4,1,1,0)
 ;;=DVBA C VIEW EXAMS (MENU)
 ;;^UTILITY(U,$J,"OR",223,1,4,1,2,0)
 ;;=DVBA DISCHARGE TYPES (MENU)
 ;;^UTILITY(U,$J,"OR",223,1,5,0)
 ;;=DVBA C&P SCHD EVENT
 ;;^UTILITY(U,$J,"OR",223,1,5,1,0)
 ;;=^100.99511PA^1^1
 ;;^UTILITY(U,$J,"OR",223,1,5,1,1,0)
 ;;=SDAM APPOINTMENT EVENTS
 ;;^UTILITY(U,$J,"PKG",223,0)
 ;;=AUTOMATED MED INFO EXCHANGE^DVBA^The entire AMIE package 7131/2507.
 ;;^UTILITY(U,$J,"PKG",223,1,0)
 ;;=^^4^4^2950307^^^^
 ;;^UTILITY(U,$J,"PKG",223,1,1,0)
 ;;=This is the entire AMIE package.  Both the 7131 and the 2507 portions
 ;;^UTILITY(U,$J,"PKG",223,1,2,0)
 ;;=are carried under a single namespace.  AMIE was designed to help
 ;;^UTILITY(U,$J,"PKG",223,1,3,0)
 ;;=automate the requesting process for both of these programs.
 ;;^UTILITY(U,$J,"PKG",223,1,4,0)
 ;;=(Note: Routines for the 2507 portion are still namespaced DVBC.)
 ;;^UTILITY(U,$J,"PKG",223,2,0)
 ;;=^9.42A^^0
 ;;^UTILITY(U,$J,"PKG",223,3,0)
 ;;=^9.43^2^2
 ;;^UTILITY(U,$J,"PKG",223,3,1,0)
 ;;=DVB
 ;;^UTILITY(U,$J,"PKG",223,3,1,4,0)
 ;;=^^1^1^2941129^^^^
 ;;^UTILITY(U,$J,"PKG",223,3,1,4,1,0)
 ;;=The DVB global contains all of the AMIE files.
 ;;^UTILITY(U,$J,"PKG",223,3,1,5)
 ;;=O
 ;;^UTILITY(U,$J,"PKG",223,3,2,0)
 ;;=DVBP
 ;;^UTILITY(U,$J,"PKG",223,3,2,4,0)
 ;;=^^2^2^2950307^^^^
 ;;^UTILITY(U,$J,"PKG",223,3,2,4,1,0)
 ;;=This global currently contains the Physician's Guide and its table of
 ;;^UTILITY(U,$J,"PKG",223,3,2,4,2,0)
 ;;=contents.
 ;;^UTILITY(U,$J,"PKG",223,3,2,5)
 ;;=O
 ;;^UTILITY(U,$J,"PKG",223,3,"B","DVB",1)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,3,"B","DVBP",2)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,0)
 ;;=^9.44PA^14^14
 ;;^UTILITY(U,$J,"PKG",223,4,1,0)
 ;;=396
 ;;^UTILITY(U,$J,"PKG",223,4,1,222)
 ;;=y^y^^n^^^n^^y
 ;;^UTILITY(U,$J,"PKG",223,4,2,0)
 ;;=396.1
 ;;^UTILITY(U,$J,"PKG",223,4,2,222)
 ;;=y^y^^n^^^n^^y
 ;;^UTILITY(U,$J,"PKG",223,4,3,0)
 ;;=396.2
 ;;^UTILITY(U,$J,"PKG",223,4,3,222)
 ;;=y^y^^n^^^n^^y
 ;;^UTILITY(U,$J,"PKG",223,4,4,0)
 ;;=396.3
 ;;^UTILITY(U,$J,"PKG",223,4,4,222)
 ;;=y^y^^n^^^n^^y
 ;;^UTILITY(U,$J,"PKG",223,4,5,0)
 ;;=396.4
 ;;^UTILITY(U,$J,"PKG",223,4,5,222)
 ;;=y^y^^n^^^n^^y
 ;;^UTILITY(U,$J,"PKG",223,4,6,0)
 ;;=396.5
 ;;^UTILITY(U,$J,"PKG",223,4,6,222)
 ;;=y^y^^n^^^y^o^n
 ;;^UTILITY(U,$J,"PKG",223,4,7,0)
 ;;=396.6
 ;;^UTILITY(U,$J,"PKG",223,4,7,222)
 ;;=y^y^^n^^^y^o^n
 ;;^UTILITY(U,$J,"PKG",223,4,8,0)
 ;;=396.7
 ;;^UTILITY(U,$J,"PKG",223,4,8,222)
 ;;=y^y^^n^^^y^o^n
 ;;^UTILITY(U,$J,"PKG",223,4,9,0)
 ;;=396.91
 ;;^UTILITY(U,$J,"PKG",223,4,9,222)
 ;;=y^y^^n^^^n
 ;;^UTILITY(U,$J,"PKG",223,4,10,0)
 ;;=396.92
 ;;^UTILITY(U,$J,"PKG",223,4,10,222)
 ;;=y^y^^n^^^n
 ;;^UTILITY(U,$J,"PKG",223,4,11,0)
 ;;=31
 ;;^UTILITY(U,$J,"PKG",223,4,11,1,0)
 ;;=^9.45A^1^1
 ;;^UTILITY(U,$J,"PKG",223,4,11,1,1,0)
 ;;=LONG DESCRIPTION
 ;;^UTILITY(U,$J,"PKG",223,4,11,1,"B","LONG DESCRIPTION",1)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,11,222)
 ;;=y^n^^n^^^n
 ;;^UTILITY(U,$J,"PKG",223,4,12,0)
 ;;=396.93
 ;;^UTILITY(U,$J,"PKG",223,4,12,222)
 ;;=y^y^^n^^^n
 ;;^UTILITY(U,$J,"PKG",223,4,13,0)
 ;;=396.95
 ;;^UTILITY(U,$J,"PKG",223,4,13,222)
 ;;=y^y^^n^^^n^^n
 ;;^UTILITY(U,$J,"PKG",223,4,14,0)
 ;;=396.94
 ;;^UTILITY(U,$J,"PKG",223,4,14,222)
 ;;=y^y^^n^^^y^o^n
 ;;^UTILITY(U,$J,"PKG",223,4,"B",31,11)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396,1)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.1,2)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.2,3)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.3,4)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.4,5)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.5,6)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.6,7)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.7,8)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.91,9)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.92,10)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.93,12)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.94,14)
 ;;=

DVBAI025
DVBAI025 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"PKG",223,4,"B",396.95,13)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,5)
 ;;=ALB
 ;;^UTILITY(U,$J,"PKG",223,7)
 ;;=ALB^^I
 ;;^UTILITY(U,$J,"PKG",223,8,0)
 ;;=^9.404ID^^0
 ;;^UTILITY(U,$J,"PKG",223,9)
 ;;=^
 ;;^UTILITY(U,$J,"PKG",223,10,0)
 ;;=^9.409P^^0
 ;;^UTILITY(U,$J,"PKG",223,11)
 ;;=396^396.99
 ;;^UTILITY(U,$J,"PKG",223,22,0)
 ;;=^9.49I^21^29
 ;;^UTILITY(U,$J,"PKG",223,22,2,0)
 ;;=2.0^2911004^2911114
 ;;^UTILITY(U,$J,"PKG",223,22,2.1,0)
 ;;=2.1^2930322^2930326
 ;;^UTILITY(U,$J,"PKG",223,22,2.2,0)
 ;;=2.5T2^2930401
 ;;^UTILITY(U,$J,"PKG",223,22,2.3,0)
 ;;=2.5T3^2930409^2930414
 ;;^UTILITY(U,$J,"PKG",223,22,2.4,0)
 ;;=2.5T4^2930430^2930422
 ;;^UTILITY(U,$J,"PKG",223,22,2.5,0)
 ;;=2.5T5^2930504^2930505
 ;;^UTILITY(U,$J,"PKG",223,22,2.6,0)
 ;;=2.5T6^2930513^2930519
 ;;^UTILITY(U,$J,"PKG",223,22,2.7,0)
 ;;=2.5T7^2930526
 ;;^UTILITY(U,$J,"PKG",223,22,2.8,0)
 ;;=2.5V1^2930616
 ;;^UTILITY(U,$J,"PKG",223,22,2.9,0)
 ;;=2.5V2^2930629
 ;;^UTILITY(U,$J,"PKG",223,22,3,0)
 ;;=2.5^2931013^2930826
 ;;^UTILITY(U,$J,"PKG",223,22,4,0)
 ;;=2.6^2940415^2940511
 ;;^UTILITY(U,$J,"PKG",223,22,4,1,0)
 ;;=^^1^1^2940126^
 ;;^UTILITY(U,$J,"PKG",223,22,4,1,1,0)
 ;;= 
 ;;^UTILITY(U,$J,"PKG",223,22,5,0)
 ;;=2.6T2^2940222^2940228
 ;;^UTILITY(U,$J,"PKG",223,22,6,0)
 ;;=2.6T3^2940307^2940307
 ;;^UTILITY(U,$J,"PKG",223,22,7,0)
 ;;=2.6T4^2940307^2940308
 ;;^UTILITY(U,$J,"PKG",223,22,8,0)
 ;;=2.6T5^2940321
 ;;^UTILITY(U,$J,"PKG",223,22,9,0)
 ;;=2.6V1^2940325^2940325
 ;;^UTILITY(U,$J,"PKG",223,22,10,0)
 ;;=2.6V2^2940411^2940405
 ;;^UTILITY(U,$J,"PKG",223,22,11,0)
 ;;=2.6V3^2940414
 ;;^UTILITY(U,$J,"PKG",223,22,12,0)
 ;;=2.7J1^2940801
 ;;^UTILITY(U,$J,"PKG",223,22,13,0)
 ;;=2.7T1^2941202
 ;;^UTILITY(U,$J,"PKG",223,22,13,1,0)
 ;;=^^1^1^2941202^^^
 ;;^UTILITY(U,$J,"PKG",223,22,13,1,1,0)
 ;;= 
 ;;^UTILITY(U,$J,"PKG",223,22,14,0)
 ;;=2.7T2^2941228
 ;;^UTILITY(U,$J,"PKG",223,22,15,0)
 ;;=2.7T3^2950104
 ;;^UTILITY(U,$J,"PKG",223,22,16,0)
 ;;=2.7T4^2950127
 ;;^UTILITY(U,$J,"PKG",223,22,17,0)
 ;;=2.7T5^2950215
 ;;^UTILITY(U,$J,"PKG",223,22,18,0)
 ;;=2.7T6^2950315
 ;;^UTILITY(U,$J,"PKG",223,22,19,0)
 ;;=2.7T7^2950323
 ;;^UTILITY(U,$J,"PKG",223,22,20,0)
 ;;=2.7T8^2950404
 ;;^UTILITY(U,$J,"PKG",223,22,21,0)
 ;;=2.7^2950410
 ;;^UTILITY(U,$J,"PKG",223,22,"B",2.1,2.1)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B",2.5,3)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B",2.6,4)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B",2.7,21)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.0",2)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5T2",2.2)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5T3",2.3)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5T4",2.4)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5T5",2.5)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5T6",2.6)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5T7",2.7)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5V1",2.8)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.5V2",2.9)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.6T2",5)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.6T3",6)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.6T4",7)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.6T5",8)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.6V1",9)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.6V2",10)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.6V3",11)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7J1",12)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T1",13)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T2",14)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T3",15)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T4",16)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T5",17)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T6",18)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T7",19)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,22,"B","2.7T8",20)
 ;;=
 ;;^UTILITY(U,$J,"PKG",223,"DEV")
 ;;=ALBANY JLU/GTS
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",0)
 ;;=^9.48^10^10
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",1,0)
 ;;=DVBA ADMISSION REVIEW^405
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",2,0)
 ;;=DVBA C EXAM CHECKLIST^396.6
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",3,0)
 ;;=DVBA C EXAM LAYOUT^396.6
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",4,0)
 ;;=DVBA C REQUESTS BY DATE RANGE^396.3
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",5,0)
 ;;=DVBA C REQUESTS BY PHYSICIAN^396.4
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",6,0)
 ;;=DVBA FINALIZED REPORT^396
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",7,0)
 ;;=DVBA INCOMP REQ REPORT^396
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",8,0)
 ;;=DVBA NOT/DIS-21 DAY CERT CHECK^396
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",9,0)
 ;;=DVBA 21 DAY CERT^396
 ;;^UTILITY(U,$J,"PKG",223,"DIBT",10,0)
 ;;=DVBA NOTICE OF DISCHARGE^396
 ;;^UTILITY(U,$J,"PKG",223,"DIE",0)
 ;;=^9.47^5^5
 ;;^UTILITY(U,$J,"PKG",223,"DIE",1,0)
 ;;=DVBA C ADD 2507 PAT^2

DVBAI026
DVBAI026 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"PKG",223,"DIE",2,0)
 ;;=DVBA EDIT REMARKS^396
 ;;^UTILITY(U,$J,"PKG",223,"DIE",3,0)
 ;;=DVBA ELIGIBILITY EDIT^2
 ;;^UTILITY(U,$J,"PKG",223,"DIE",4,0)
 ;;=DVBA SITE EDIT^396.1
 ;;^UTILITY(U,$J,"PKG",223,"DIE",5,0)
 ;;=DVBA STATUS EDIT^396
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",0)
 ;;=^9.46^13^13
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",1,0)
 ;;=DVBA ADMISSION REVIEW^405
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",2,0)
 ;;=DVBA C CHECK DR STRING^396.6
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",3,0)
 ;;=DVBA C EXAM CHECKLIST^396.6
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",4,0)
 ;;=DVBA C EXAM CHECKLIST HEADER^396.6
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",5,0)
 ;;=DVBA C EXAM LAYOUT^396.6
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",6,0)
 ;;=DVBA C REQUESTS BY DATE RANGE^396.3
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",7,0)
 ;;=DVBA C REQUESTS BY PHYSICIAN^396.4
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",8,0)
 ;;=DVBA FINALIZED REPORT^396
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",9,0)
 ;;=DVBA INCOMP REQ REPORT^396
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",10,0)
 ;;=DVBA NOT/DIS-21 DAY CERT CHECK^396
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",11,0)
 ;;=DVBA STATUS^396
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",12,0)
 ;;=DVBA 21 DAY CERT^396
 ;;^UTILITY(U,$J,"PKG",223,"DIPT",13,0)
 ;;=DVBA NOTICE OF DISCHARGE^396
 ;;^UTILITY(U,$J,"PKG",223,"EX",0)
 ;;=^9.432^^0
 ;;^UTILITY(U,$J,"PKG",223,"INI")
 ;;=DVBAPRE^
 ;;^UTILITY(U,$J,"PKG",223,"INIT")
 ;;=DVBAPOST^
 ;;^UTILITY(U,$J,"PKG",223,"M",0)
 ;;=^9.495
 ;;^UTILITY(U,$J,"PKG",223,"PRE")
 ;;=DVBAENVR^
 ;;^UTILITY(U,$J,"SBF",31,31)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396,396)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396,396.01)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396,396.02)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.1,396.1)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.1,396.115)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.1,396.12)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.1,396.13)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.1,396.14)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.2,396.2)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.3,396.3)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.3,396.323)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.3,396.327)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.3,396.3277)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.4,396.4)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.4,396.41)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.4,396.42)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.5,396.5)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.6,396.6)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.6,396.61)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.7,396.7)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.7,396.701)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.91,396.91)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.91,396.9101)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.92,396.92)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.92,396.9201)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.93,396.93)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.94,396.94)
 ;;=
 ;;^UTILITY(U,$J,"SBF",396.95,396.95)
 ;;=

DVBAINI1
DVBAINI1 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ; LOADS AND INDEXES DD'S
 ;
 K DIF,DIK,D,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DFR,DTN,DIX,DZ D DT^DICRW S %=1,U="^",DSEC=1
 S NO=$P("I 0^I $D(@X)#2,X[U",U,%) I %<1 K DIFQ Q
ASK I %=1,$D(DIFQ(0)) W !,"SHALL I WRITE OVER FILE SECURITY CODES" S %=2 D YN^DICN S DSEC=%=1 I %<1 K DIFQ Q
 F X="BUL","DIB","DIE","DIP","KEY","OPT" D W Q:'$D(DIFQ)
 Q:'$D(DIFQ)  S %=2 W !!,"ARE YOU SURE EVERYTHING'S OK" D YN^DICN I %-1 K DIFQ Q
 D ^DVBAPRE D NOW^%DTC S DIFROM("INI")=%
 I $D(DIFKEP) F DIDIU=0:0 S DIDIU=$O(DIFKEP(DIDIU)) Q:DIDIU'>0  S DIU=DIDIU,DIU(0)=DIFKEP(DIDIU) D EN^DIU2
 D DT^DICRW K ^UTILITY(U,$J),^UTILITY("DIK",$J) D WAIT^DICD
 S DN="^DVBAI" F R=1:1:78 D @(DN_$$B36(R)) W "."
 F  S D=$O(^UTILITY(U,$J,"SBF","")) Q:D'>0  K:'DIFQ(D) ^(D) S D=$O(^(D,"")) I D>0  K ^(D) D IX
DATA W "." S (D,DDF(1),DDT(0))=$O(^UTILITY(U,$J,0)) Q:D'>0
 I DIFQR(D) S DTO=0,DMRG=1,DTO(0)=^(D),Z=^(D)_"0)",D0=^(D,0),@Z=D0,DFR(1)="^UTILITY(U,$J,DDF(1),D0,",DKP=DIFQR(D)'=2 F D0=0:0 S D0=$O(^UTILITY(U,$J,DDF(1),D0)) S:D0="" D0=-1 Q:'$D(^(D0,0))  S Z=^(0) D I^DITR
 K ^UTILITY(U,$J,DDF(1)),DDF,DDT,DTO,DFR,DFN,DTN G DATA
 ;
W S Y=$P($T(@X),";",2) W !,"NOTE: This package also contains "_Y_"S",! Q:'$D(DIFQ(0))
 S %=1 W ?6,"SHALL I WRITE OVER EXISTING "_Y_"S OF THE SAME NAME" D YN^DICN I '% W !?6,"Answer YES to replace the current "_Y_"S with the incoming ones." G W
 S:%=2 DIFQ(X)=0 K:%<0 DIFQ
 Q
 ;
OPT ;OPTION
RTN ;ROUTINE DOCUMENTATION NOTE
FUN ;FUNCTION
BUL ;BULLETIN
KEY ;SECURITY KEY
HEL ;HELP FRAME
DIP ;PRINT TEMPLATE
DIE ;INPUT TEMPLATE
DIB ;SORT TEMPLATE
DIS ;SCREEN TEMPLATE
 ;
SBF ;FILE AND SUB FILE NUMBERS
IX W "." S DIK="A" F %=0:0 S DIK=$O(^DD(D,DIK)) Q:DIK=""  K ^(DIK)
 S DA(1)=D,DIK="^DD("_D_"," D IXALL^DIK
 I $D(^DIC(D,"%",0)) S DIK="^DIC(D,""%""," G IXALL^DIK
 Q
B36(X) Q $$N(X\(36*36)#36+1)_$$N(X\36#36+1)_$$N(X#36+1)
N(%) Q $E("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",%)
MSG ;
 I $P(^XMB(3.9,XMZ,0),U,7)'="X" Q
 S X=$S($D(^XMB(3.9,XMZ,2,XCN,0)):^(0),1:"") Q:X=""
M0 D M1 Q:$P(X,"$END MESSAGE")=""  D SAVE,NT G M0
NT S XCN=$O(^XMB(3.9,XMZ,2,XCN)) Q:XCN'?1.N  S X=^(XCN,0) Q
SAVE D NT Q:$E(X)="$"  S Y=X D NT Q:$E(X)="$"
 I $A(X)=126 S A0=X D NT S X=A0_$E(X,2,999) K A0
 S:% @Y=$E(X,2,999) G SAVE
 Q
M1 S Y=$E(X,2,4),%=0 I Y="DDD" S D=+$P(X,"(#",2),%=DIFQ(D) Q:D  S:$P(X,"(#",2)["FILE SECURITY" %=DSEC Q
 Q:Y="END"
 I Y="DTA" S %=DIFQR(D) Q
 I (Y="OR ")!(Y="PKG") S %=1 Q
 I $T(@Y)]"" S %=1 Q
 Q

DVBAINI2
DVBAINI2 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;
 K ^UTILITY("DIFROM",$J),DIC S DIDUZ=0 S:$D(DUZ)#2 DIDUZ=DUZ S DUZ=.5
 I $D(^DIC(9.2,0))#2,^(0)?1"HEL".E S (DIC,DLAYGO)=9.2,N="HEL",DIC(0)="LX" G ADD
 Q
 ;
ADD F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R'>0  S X=$P(^(R,0),U,1) W "." K DA D ^DIC I Y>0,'$D(DIFQ(N))!$P(Y,U,3) S ^UTILITY("DIFROM",$J,N,X)=+Y K ^DIC(9.2,+Y,1),^(2),^(3),^(10) S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y D %XY^%RCR
 S DIK=DIC
HELP S R=$O(^UTILITY("DIFROM",$J,N,R)) Q:R=""  W !,"'"_R_"' Help Frame filed." S DA=^(R)
 F X=0:0 S X=$O(^DIC(9.2,DA,2,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$P(I,U,2) S:Y]"" Y=$O(^DIC(9.2,"B",Y,0)) S ^(0)=$P(^DIC(9.2,DA,2,X,0),U,1)_U_$S(Y>0:Y,1:"")_U_$P(^(0),U,3,99)
 S I=0 F X=0:0 S X=$O(^DIC(9.2,DA,10,X)) Q:'X  I $D(^(X,0)) S Y=$P(^(0),U),Y=$S(Y]"":$O(^MAG("B",Y,0)),1:0) S:Y $P(^DIC(9.2,DA,10,X,0),U)=Y,I=I+1,%=X I 'Y K ^DIC(9.2,DA,10,X,0)
 I I S $P(^DIC(9.2,DA,10,0),U,3,4)=%_U_I
IX D IX1^DIK G HELP
 ;
U I $D(DIRUT) S DIFQ=1
 W ! Q
REP S DIR(0)="Y",DIR("A")="Shall I change the NAME of the file to "_DIF
 S DIR("??")="^D REP^DIFROMH1",DIR("B")="NO" D ^DIR G U:$D(DIRUT)
 I Y S DIE=1,DIFQ=0,DA=N,DR=".01////"_DIF D ^DIE Q
 S DIR("A")="Shall I replace your file with mine"
 S DIR("??")="^D AG^DIFROMH1" D ^DIR G U:$D(DIRUT)!'Y
 S DIU(0)="E",DIR("A")="Do you want to keep the Data"
 S DIR("??")="^D CHG^DIFROMH1" D ^DIR G U:$D(DIRUT)
 S:'Y DIU(0)=DIU(0)_"D"
 S DIR("A")="Do you want to keep the Templates"
 S DIR("??")="^D TEMP^DIFROMH1" D ^DIR G U:$D(DIRUT) S:'Y DIU(0)=DIU(0)_"T"
 S DIFQ(N)=1,DIFKEP(N)=DIU(0) W !?15," (",DIF,") " Q

DVBAINI3
DVBAINI3 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;
 K ^UTILITY("DIFROM",$J) S DIC(0)="LX",(DIC,DLAYGO)=3.6,N="BUL" D ADD:$D(^XMB(3.6,0))
 S X=0 F R=0:0 S X=$O(^UTILITY("DIFROM",$J,N,X)) Q:X=""  W !,"'",X,"' BULLETIN FILED -- Remember to add mail groups for new bulletins."
 I $D(^DIC(9.4,0))#2,^(0)?1"PACK".E S N="PKG",(DIC,DLAYGO)=9.4 D ADD
 G NP:'$D(DA) S %=+$O(^DIC(9.4,DA,22,"B",DIFROM,0)) I $D(^DIC(9.4,DA,22,%,0)) S $P(^(0),U,3)=DT
 I $D(^DIC(9.4,DA,0))#2 S %=$P(^(0),U,4) I %]"" S %=$O(^DIC(9.2,"B",%,0)) S:%]"" $P(^DIC(9.4,DA,0),U,4)=%
OR I $D(^ORD(100.99))&$O(^UTILITY(U,$J,"OR","")) D EN^DVBAINI4
NP K DIC,^UTILITY("DIFROM",$J) S DIC(0)="LX" I $D(^DIC(19,0))#2,^(0)?1"OPTION".E S (DIC,DLAYGO)=19,N="OPT" D ADD,OP
 I $D(^DIC(19.1,0))#2,($P(^(0),U)?1"SECUR".E)!($P(^(0),U)="KEY") S (DIC,DLAYGO)=19.1,N="KEY" D ADD K ^UTILITY("DIFROM",$J)
 I $D(^DIC(9.8,0))#2,^(0)?1"ROUTINE^".E S (DIC,DLAYGO)=9.8,N="RTN" D ADD
 S DIC=.5,DLAYGO=0,N="FUN" D ADD
 S DIC("S")="I $P(^(0),U,4)=DIFL" F N="DIPT","DIBT","DIE" S DIC=U_N_"(" D ADD
 K DIC("S") S N="DIST(.404,",DIC=U_N,DLAYGO=.404 D ADD
 S DIC("S")="I $P(^(0),U,8)=DIFL",N="DIST(.403,",DIC=U_N,DLAYGO=.403 D ADD
 K ^UTILITY(U,$J),DIC,DLAYGO F DIFR="DIE","DIPT" D DIEZ
 K ^UTILITY("DIFROM",$J) Q
DIEZ I ^DD("VERSION")>17.4,'$D(DISYS) D OS^DII
 E  S DISYS=^DD("OS")
 Q:'$D(^DD("OS",DISYS,"ZS"))
 S DIFR1=""
DZ1 S DIFR1=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1)) Q:DIFR1=""
 F DIFR2=0:0 S DIFR2=$O(^UTILITY("DIFROM",$J,DIFR,DIFR1,DIFR2)) Q:'DIFR2  S Y=DIFR2 I $D(@(U_DIFR_"(Y,""ROU"")")) K ^("ROU") I $D(^("ROUOLD")) S X=^("ROUOLD"),DMAX=^DD("ROU") D:X]"" @("EN^DI"_$E(DIFR,3)_"Z")
 G DZ1
 ;
OP S R=$O(^UTILITY("DIFROM",$J,N,R)) I R="" K ^UTILITY("DIFROM",$J) G Q
 W !,"'"_R_"' Option Filed" S DA=+^UTILITY("DIFROM",$J,N,R) G:$P(^(R),U,2,3)="XUCORE^"!($P(^(R),U,2,3)="XUCOMMAND^") OP
 I $D(^DIC(19,DA,220)) S %=$P(^(220),U) S:%]"" %=$O(^XMB(3.6,"B",%,0)) S $P(^DIC(19,DA,220),U)=%,%=$P(^(220),U,3) S:%]"" %=$O(^XMB(3.8,"B",%,0)) S $P(^DIC(19,DA,220),U,3)=%
 S %=$P(^DIC(19,DA,0),U,12) S:%]"" %=$O(^DIC(9.4,"B",%,0))
 S $P(^DIC(19,DA,0),U,12)=%,%=$P(^(0),U,7),(DZ,DIX)=0
 D:$D(^DIC(19,DA,10,"B")) KAD(DA) S:%]"" %=$O(^DIC(9.2,"B",%,0)) S $P(^DIC(19,DA,0),U,7)=%,%=$P(^(0),U,4),%="MOQXL"[% K ^(10,"B"),^("C")
 F X=0:0 S X=$O(^DIC(19,DA,10,X)) Q:'X  S I=$S($D(^(X,0)):^(0),1:0),Y=$S($D(^(U)):^(U),1:"") K ^DIC(19,DA,10,X) I Y]"",% S D=$O(^DIC(19,"B",Y,0)) I D S ^DIC(19,DA,10,X,0)=D_U_$P(I,U,2,9),DZ=DZ+1,DIX=X
 S:% ^DIC(19,DA,10,0)="^19.01PI^"_DIX_U_DZ D IX1^DIK G OP
 ;
ADD F R=0:0 S R=$O(^UTILITY(U,$J,N,R)) Q:R=""  S X=$P(^(R,0),U),DIFL=$S(N="DIST(.403,":$P(^(0),U,8),N="DIST(.404,":$P(^(0),U,2),1:$P(^(0),U,4)) W "." K DA D ^DIC I Y>0,'$D(DIFQ($E(N,1,3)))!$P(Y,U,3) S Y=Y_U D A
Q Q
A I N="BUL" K % S %(0)=$G(@(DIC_"+Y,2,0)")) F %=0:0 S %=$O(@(DIC_"+Y,2,%)")) Q:'%  S %(%)=$G(^(%,0))
 K:N'="KEY"&(N'="OPT") @(DIC_"+Y)") S ^UTILITY("DIFROM",$J,N,X)=Y S:$E(N,1,2)="DI" ^(X,+Y)="" S:N="PKG" DIFROM(0)=+Y Q:$P(Y,U,2,3)="XUCORE^"!($P(Y,U,2,3)="XUCOMMAND^")
 I N="BUL",%(0)]"" S @(DIC_"+Y,2,0)")=%(0) F %=0:0 S %=$O(%(%)) Q:'%  S @(DIC_"+Y,2,%,0)")=%(%)
 I $E(N,1,2)="DI",('DIFL)!('$D(^DD(+DIFL))) W !,"**WARNING--"_$S(N="DIE":"INPUT",N="DIPT":"PRINT",N="DIBT":"SORT",1:"FORM or BLOCK")_" template "_$P(Y,U,2)_" has been installed,",!,"but associated file "_DIFL_" not on your system!"
 I N="OPT" S:$P(^DIC(19,+Y,0),U,6)]"" DIOPT=$P(^(0),U,6) I $O(^UTILITY(U,$J,N,R,1,0)) K ^DIC(19,+Y,1)
 I N="DIST(.403," D BLK
 S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+Y,",DA=+Y,DIK=DIC D %XY^%RCR
 D IX1^DIK:N'="OPT" I N="OPT",$D(DIOPT) S:$P(^DIC(19,DA,0),U,6)="" $P(^(0),U,6)=DIOPT K DIOPT
 Q
BLK F J=0:0 S J=$O(^UTILITY(U,$J,N,R,40,J)) Q:'J  I $D(^(J,0)) S %=$P(^(0),U,2) S:%]"" %=$O(^DIST(.404,"B",%,0)) S:% $P(^UTILITY(U,$J,N,R,40,J,0),U,2)=% D B1
 K A0,A1,A2,J,L Q
B1 F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,40,L)) Q:'L  S A0=$G(^(L,0)),%=$P(A0,U) I %]"" S %=$O(^DIST(.404,"B",%,0)) I % S $P(A0,U)=%,^UTILITY(U,$J,N,R,40,J,"BLK",%,0)=A0
 S A0=$G(^UTILITY(U,$J,N,R,40,J,40,0)) Q:A0=""  K ^UTILITY(U,$J,N,R,40,J,40) S (A1,A2)=0
 F L=0:0 S L=$O(^UTILITY(U,$J,N,R,40,J,"BLK",L)) Q:'L  S ^UTILITY(U,$J,N,R,40,J,40,L,0)=^(L,0),A1=L,A2=A2+1
 S $P(A0,U,3,4)=A1_U_A2,^UTILITY(U,$J,N,R,40,J,40,0)=A0 K ^UTILITY(U,$J,N,R,40,J,"BLK")
 Q
KAD(D0) N D1,X
 S X=0 F  S X=$O(^DIC(19,D0,10,"B",X)) Q:X'>0  S D1=0 F  S D1=$O(^DIC(19,D0,10,"B",X,D1)) Q:D1'>0  K ^DIC(19,"AD",X,D0,D1)
 Q

DVBAINI4
DVBAINI4 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;
EN S DA(1)=1,DIK="^ORD(100.99,1,5," I $D(^ORD(100.99,1,5,DA)) D ^DIK
 S %X="^UTILITY(U,$J,""OR"","_$O(^UTILITY(U,$J,"OR",""))_",",%Y=DIK_DA_","
 S:'$D(^ORD(100.99,1,5,0)) ^(0)="^100.995P^^" S $P(^(0),U,3,4)=DA_U_($P(^(0),U,4)+1)
 D %XY^%RCR S $P(^ORD(100.99,1,5,DA,0),U)=DA,%=$P(^(0),U,4)
 I %]"" S %=$O(^ORD(100.98,"B",%,0)) I %>0 S $P(^ORD(100.99,1,5,DA,0),U,4)=%
 D OR
 S DA(1)=1 D IX1^DIK
 Q
OR S (N,I)=0,X=""
 F  S N=$O(^ORD(100.99,1,5,DA,1,N)) Q:'N  S X=$P(^(N,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,0)=% S X=N,I=I+1,(R,J)=0,Y="" D OR1
 S:I $P(^ORD(100.99,1,5,DA,1,0),U,3,4)=X_U_I S (N,I)=0,X=""
 F  S N=$O(^ORD(100.99,1,5,DA,5,N)) Q:'N  S X=$P(^(N,0),U,3) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% $P(^ORD(100.99,1,5,DA,5,N,0),U,3)=% S X=N,I=I+1
 S:I $P(^ORD(100.99,1,5,DA,5,0),U,3,4)=X_U_I K N,R,X,Y,I,J
 Q
OR1 N X F  S R=$O(^ORD(100.99,1,5,DA,1,N,1,R)) Q:'R  S X=$P(^(R,0),U) I X]"" S %=$O(^ORD(101,"B",X,0)) D:'% ADDP S:% ^ORD(100.99,1,5,DA,1,N,1,R,0)=% S Y=R,J=J+1
 S:J $P(^ORD(100.99,1,5,DA,1,N,1,0),U,3,4)=Y_U_J
 Q
ADDP N I,J,N,R,DA,DLAYGO S %=""
 S DIC="^ORD(101,",DIC(0)="LX",DLAYGO=101 D FILE^DICN K DIC Q:Y=-1  S %=+Y Q

DVBAINI5
DVBAINI5 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 K ^UTILITY("DIF",$J) S DIFRDIFI=1 F I=1:1:28 S ^UTILITY("DIF",$J,DIFRDIFI)=$T(IXF+I),DIFRDIFI=DIFRDIFI+1
 Q
IXF ;;AUTOMATED MED INFO EXCHANGE^DVBA
 ;;31I;DISABILITY CONDITION;^DIC(31,;1;y;n;;n;;;n
 ;;
 ;;396IP;FORM 7131;^DVB(396,;0;y;y;;n;;;n;;y
 ;;
 ;;396.1;AMIE SITE PARAMETER;^DVB(396.1,;0;y;y;;n;;;n;;y
 ;;
 ;;396.2IP;AMIE REPORT;^DVB(396.2,;0;y;y;;n;;;n;;y
 ;;
 ;;396.3IP;2507 REQUEST;^DVB(396.3,;0;y;y;;n;;;n;;y
 ;;
 ;;396.4I;2507 EXAM;^DVB(396.4,;0;y;y;;n;;;n;;y
 ;;
 ;;396.5;2507 CANCELLATION REASON;^DVB(396.5,;0;y;y;;n;;;y;o;n
 ;;
 ;;396.6;AMIE EXAM;^DVB(396.6,;0;y;y;;n;;;y;o;n
 ;;
 ;;396.7;2507 BODY SYSTEM;^DVB(396.7,;0;y;y;;n;;;y;o;n
 ;;
 ;;396.91;AMIE DOCUMENT;^DVBP(396.91,;0;y;y;;n;;;n
 ;;
 ;;396.92P;AMIE DOCUMENT TABLE OF CONTENTS;^DVBP(396.92,;0;y;y;;n;;;n
 ;;
 ;;396.93;EXAM EXCEPTIONS;^DVB(396.93,;0;y;y;;n;;;n
 ;;
 ;;396.94;2507 INSUFFICIENT REASONS;^DVB(396.94,;0;y;y;;n;;;y;o;n
 ;;
 ;;396.95ID;AMIE C&P EXAM TRACKING;^DVB(396.95,;0;y;y;;n;;;n;;n
 ;;

DVBAINIS
DVBAINIS ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
PAC(PKG,VER) ; called from package init (DIFROM7 created this routine)
 ; PKG = $T(IXF) of the INIT routine.
 ; VER is an array that is contained in DIFROM from the INIT routine
 ;
 N %,%I,%H,DATE,DIFROM,NOW,PACKAGE,RUN,SERVER,SITE,START,X,XMDUZ,XMSUB,XMTEXT,XMY,Y K ^TMP("DVBAINIS",$J)
 ;
 ; Site tracking updates only occur if run in a VA production primary domain
 ; account.
 I $G(^XMB("NETNAME"))'[".VA.GOV" Q
 Q:'$D(^%ZOSF("UCI"))  Q:'$D(^%ZOSF("PROD"))
 X ^%ZOSF("UCI") I Y'=^%ZOSF("PROD") Q
 ;
 S SERVER="S.A5CSTS@FORUM.VA.GOV"
 S PACKAGE=$P($P(PKG,";",3),U)
 S SITE=$G(^XMB("NETNAME"))
 S START=$P($G(^DIC(9.4,VER(0),"PRE")),U,2) I '$L(START) S START="Unknown"
 D  ; check if ok to use kernel functions
 .S X="XLFDT" X ^%ZOSF("TEST") I $T D  Q
 ..S NOW=$$HTFM^XLFDT($H)
 ..S RUN="Unknown" I START S RUN=$$FMDIFF^XLFDT(NOW,START,3)
 ..S START=$$FMTE^XLFDT(START)
 ..S DATE=NOW\1
 ..S NOW=$$FMTE^XLFDT(NOW)
 .D NOW^%DTC S NOW=%,DATE=X
 .S RUN="" ; don't bother to compute
 .S Y=START D DD^%DT S START=Y
 .S Y=NOW D DD^%DT S NOW=Y
 ;
 ; Message for server
 S ^TMP("DVBAINIS",$J,1,0)="PACKAGE INSTALL"
 S ^TMP("DVBAINIS",$J,2,0)="SITE: "_SITE
 S ^TMP("DVBAINIS",$J,3,0)="PACKAGE: "_PACKAGE
 S ^TMP("DVBAINIS",$J,4,0)="VERSION: "_VER
 S ^TMP("DVBAINIS",$J,5,0)="Start time: "_START
 S ^TMP("DVBAINIS",$J,6,0)="Completion time: "_NOW
 S ^TMP("DVBAINIS",$J,7,0)="Run time: "_RUN
 S ^TMP("DVBAINIS",$J,8,0)="DATE: "_DATE
 ;
 ; Data is sent to server on FORUM - S.A5CSTS
 S XMY(SERVER)="",XMDUZ=.5,XMTEXT="^TMP(""DVBAINIS"",$J,",XMSUB=PACKAGE_" VERSION "_VER_" INSTALLATION"
 D ^XMD
 K ^TMP("DVBAINIS",$J)
 Q

DVBAINIT
DVBAINIT ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K DIF,DIFQ,DIFQR,DIFQN,DIK,DDF,DDT,DTO,D0,DLAYGO,DIC,DIDUZ,DIR,DA,DIFROM,DFR,DTN,DIX,DZ,DIRUT,DTOUT,DUOUT
 S U="^",DIFQ=0,DIFROM="2.7" W !,"This version (#2.7) of 'DVBAINIT' was created on 10-APR-1995"
 W !?9,"(at ALBANY CAMPUS DEVELOPMENT, by VA FileMan V.20.0)",!
 I $D(^DD("VERSION")),^("VERSION")'<20 G GO
 W !,"FIRST, I'LL FRESHEN UP YOUR VA FILEMAN...." D N^DINIT
 I ^DD("VERSION")<20 W !,"BUT I NEED VERSION 20 OF THE VA FILEMAN!" G Q
GO ;
 W !,"I HAVE TO RUN AN ENVIRONMENT CHECK ROUTINE." D PKG,^DVBAENVR Q:'$D(DIFQ)  D NOW^%DTC S DIFROM("PRE")=%
EN ; ENTER HERE TO BYPASS THE PRE-INIT PROGRAM
 S DIFQ=0 K DIRUT,DTOUT,DUOUT
 F DIFRIR=1:1:1 S DIFRRTN="^DVBAINI"_$E("5",DIFRIR) D @DIFRRTN
 W:1 !,"I AM GOING TO SET UP THE FOLLOWING FILES:" F I=1:2:28 S DIF(I)=^UTILITY("DIF",$J,I) D 1 G Q:DIFQ!$D(DIRUT) K DIF(I)
 S DIFROM="2.7" D PKG:'$D(DIFROM(0)),^DVBAINI1 G Q:'$D(DIFQ) S DIK(0)="AB"
 F DIF=1:2:28 S %=^UTILITY("DIF",$J,DIF),DIK=$P(%,";",5),N=$P(%,";",3),D=$P(%,";",4)_U_N D D K DIFQ(N)
 K DIFQR D ^DVBAINI2,^DVBAINI3
 L  S DUZ=DIDUZ W:1 !,"NO"_$P("TE THAT FILE",U,DSEC)_" SECURITY-CODE PROTECTION HAS BEEN MADE"
 D ^DVBAPOST,NOW^%DTC S DIFROM("INIT")=%
 I DIFROM F DIF=1:2:28 S %=^UTILITY("DIF",$J,DIF),N=+$P(%,";",3) I N,$P(%,";",8)="y" S ^DD(N,0,"VR")=DIFROM
 I DIFROM(0)>0 F %="PRE","INI","INIT" S:$D(DIFROM(%)) $P(^DIC(9.4,DIFROM(0),%),U,2)=DIFROM(%)
 I $G(DIFQN) S $P(^(0),U,3,4)=$P(DIFQN,U,2)_U_($P(^DIC(0),U,4)+DIFQN) K DIFQN
 I DIFROM,$D(^%ZTSK) S X="DVBAINIS" X ^%ZOSF("TEST") D:$T PAC^DVBAINIS($T(IXF),.DIFROM)
 S:DIFROM(0)>0 ^DIC(9.4,DIFROM(0),"VERSION")=DIFROM G Q^DIFROM0
D S:$D(^DIC(+N,0))[0 ^(0)=D S X=$D(@(DIK_"0)")),^(0)=D_U_$S(X#2:$P(^(0),U,3,9),1:U)
 S DIFQR=DIFQR(+N) I ^DD("VERSION")>17.5,$D(^DD(+N,0,"DIK"))#2 S X=^("DIK"),Y=+N,DMAX=^DD("ROU") D EN^DIKZ
 I DIFQR D IXALL^DIK:$O(@(DIK_"0)")) W "."
 Q
R G REP^DVBAINI2
 ;
1 S N=+$P(DIF(I),";",3),DIF=$P(DIF(I),";",4),S=$P(DIF(I),";",5)
 W !!?3,N,?13,DIF,$P("  (Partial Definition)",U,$P(DIF(I),";",6)),$P("  (including data)",U,$P(DIF(I),";",13)="y") S Z=$S($D(^DIC(N,0))#2:^(0),1:"")
 I Z="" S DIFQ(N)=1,DIFQN=$G(DIFQN)+1_U_N G S
 I $L($P(Z,DIF)) W $C(7),!,"*BUT YOU ALREADY HAVE '",$P(Z,U),"' AS FILE #",N,"!" D R Q:DIFQ  G S:$D(DIFKEP(N)),1
 S DIFQ(N)=$P(DIF(I),";",7)'="n"
 I $L(Z) W $C(7),!,"Note:  You already have the '",$P(Z,U),"' File." S DIFQ(0)=1
 S %=$E(^UTILITY("DIF",$J,I+1),4,245) I %]"" X % S DIFQ(N)=$T W:'$T !,"Screen on this Data Dictionary did not pass--DD will not be installed!" G S
 I $L(Z),$P(DIF(I),";",10)="y" S DIR("A")="Shall I write over the existing Data Definition",DIR("??")="^D DD^DIFROMH1",DIR("B")="YES",DIR(0)="Y" D ^DIR S DIFQ(N)=Y
S S DIFQR(N)=0 Q:$P(DIF(I),";",13)'="y"!$D(DIRUT)
 I $P(DIF(I),";",15)="y",$O(@(S_"0)"))>0 S DIF=$P(DIF(I),";",14)="o",DIR("A")="Want my data "_$P("merged with^to overwrite",U,DIF+1)_" yours",DIR("??")="^D DTA^DIFROMH1",DIR(0)="Y" D ^DIR S DIFQR(N)=$S('Y:Y,1:Y+DIF) Q
 S %=$P(DIF(I),";",14)="o" W !,$C(7),"I will ",$P("MERGE^OVERWRITE",U,%+1)," your data with mine." S DIFQR(N)=%+1
 Q
Q W $C(7),!!,"NO UPDATING HAS OCCURRED!" G Q^DIFROM0
 ;
PKG S X=$P($T(IXF),";",3),DIC="^DIC(9.4,",DIC(0)="",DIC("S")="I $P(^(0),U,2)="""_$P(X,U,2)_"""",X=$P(X,U) D ^DIC S DIFROM(0)=+Y K DIC
 Q
 ;
IXF ;;AUTOMATED MED INFO EXCHANGE^DVBA;622
ERX W $C(7),!!,"This INIT was built as a Network Mail Message and can ONLY be installed",!,"within the Mail system!!" G Q

DVBAL
DVBAL ; List Template Exporter ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 W !,"'DVBA C VIEW EXAMS' List Template..."
 S DA=$O(^SD(409.61,"B","DVBA C VIEW EXAMS",0)),DIK="^SD(409.61," D ^DIK:DA
 K DO,DD S DIC(0)="L",DIC="^SD(409.61,",X="DVBA C VIEW EXAMS" D FILE^DICN S VALM=+Y
 I VALM>0 D
 .S ^SD(409.61,VALM,0)="DVBA C VIEW EXAMS^1^^80^3^20^1^1^^DVBA C VIEW EXAMS (MENU)^DVBA C VIEW EXAMS^1^^1"
 .S ^SD(409.61,VALM,1)="^VALM HIDDEN ACTIONS"
 .S ^SD(409.61,VALM,"ARRAY")=" ^TMP"
 .S ^SD(409.61,VALM,"FNL")="D EXIT^DVBCVW2"
 .S ^SD(409.61,VALM,"HDR")="D HEADER^DVBCVW2"
 .S ^SD(409.61,VALM,"HLP")="D HELP^DVBCVW2"
 .S ^SD(409.61,VALM,"INIT")="D INIT^DVBCVW2"
 .S DA=VALM,DIK="^SD(409.61," D IX1^DIK K DA,DIK
 .W "Filed."
 ;
 W !,"'DVBA DISCHARGE TYPES' List Template..."
 S DA=$O(^SD(409.61,"B","DVBA DISCHARGE TYPES",0)),DIK="^SD(409.61," D ^DIK:DA
 K DO,DD S DIC(0)="L",DIC="^SD(409.61,",X="DVBA DISCHARGE TYPES" D FILE^DICN S VALM=+Y
 I VALM>0 D
 .S ^SD(409.61,VALM,0)="DVBA DISCHARGE TYPES^1^^80^5^20^1^1^^DVBA DISCHARGE TYPES (MENU)^Discharge Type Selection^1^^1"
 .S ^SD(409.61,VALM,1)="^VALM HIDDEN ACTIONS"
 .S ^SD(409.61,VALM,"ARRAY")=" ^TMP(""AMIE"",$J)"
 .S ^SD(409.61,VALM,"COL",0)="^409.621^5^4"
 .S ^SD(409.61,VALM,"COL",2,0)="DISCHARGE TYPE^8^41^DISCHARGE TYPE"
 .S ^SD(409.61,VALM,"COL",3,0)="DISCHARGE CODE^51^4^CODE"
 .S ^SD(409.61,VALM,"COL",4,0)="ITEM^2^4^ITEM"
 .S ^SD(409.61,VALM,"COL",5,0)="STATUS^60^9^STATUS"
 .S ^SD(409.61,VALM,"FNL")="D EXIT^DVBALD"
 .S ^SD(409.61,VALM,"HDR")="D HDR^DVBALD"
 .S ^SD(409.61,VALM,"HLP")="D HELP^DVBALD"
 .S ^SD(409.61,VALM,"INIT")="D INIT^DVBALD"
 .S DA=VALM,DIK="^SD(409.61," D IX1^DIK K DA,DIK
 .W "Filed."
 ;
 K DIC,DIK,VALM,X,DA Q

DVBALD
DVBALD ;ALB/JLU;List Man created routine ; 01-AUG-1994
 ;;2.7;AMIE;;Apr 10, 1995
EN ; -- main entry point for DVBA DISCHARGE TYPES
 D EN^VALM("DVBA DISCHARGE TYPES")
 Q
 ;
HDR ; -- header code
 S VALMHDR(1)="This is a list of the default discharge types."
 S VALMHDR(2)="Some of these types may not be active at this site."
 Q
 ;
INIT ; -- init variables and list array
 N DVBX,DVBY
 K ^TMP("AMIE",$J),^TMP("DVBA",$J)
 S VALMCNT=0
 F DVBX=1:1 S DVBY=$T(TEXT+DVBX) S DVBY=$P(DVBY,";;",2) Q:DVBY="END"  D SETARAY^DVBALD1(DVBY)
 Q
 ;
TEXT ;these are the default discharge types
 ;;10^TRANSFER OUT
 ;;18^READMISSION TO NHCU/DOMICILIARY
 ;;31^TO NHCU FROM HOSP
 ;;32^TO DOM FROM HOSP
 ;;33^TO NHCU FROM DOM
 ;;34^DISCHARGE TO CNH
 ;;35^VA NHCU TO CNH
 ;;40^TO ASIH
 ;;41^FROM ASIH
 ;;43^TO ASIH (OTHER FACILITY)
 ;;END
 ;
HELP ; -- help code
 S X="?" D DISP^XQORM1 W !!
 Q
 ;
EXIT ; -- exit code
 D CLEAR^VALM1
 K ^TMP("AMIE",$J),DVBAQUIT,VALMCK,VALMNOD
 Q
 ;
EXPND ; -- expand code
 Q
 ;
ADD ;this is the code for the ADD action in the discharge List Man
 D FULL^VALM1
 D ADD^DVBALD1("AD")
 S VALMBCK="R"
 Q
 ;
DELETE ;this is the code for the DELETE action in the discharge List Man
 D FULL^VALM1
 D DELETE^DVBALD1
 S VALMBCK="R"
 Q
 ;
CREATE ;this is the code for the CREATE action in the discharge List Man
 D FULL^VALM1
 K ^TMP("AMIE",$J),^TMP("DVBA",$J)
 S VALMCNT=0
 D ADD^DVBALD1("CL")
 I '$D(@VALMAR@(1)) DO
 .S VAR(1,0)="0,0,0,2,0^No new discharge types were selected."
 .S VAR(2,0)="0,0,0,1,0^I will go back to the default list."
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .D PAUSE^VALM1
 .D INIT
 .Q
 S VALMBCK="R"
 Q
 ;
ACCEPT ;this line tag is for the acceptance of the discharge list.
 S DVBACEPT=1
 S VALMCK="Q"
 Q
 ;

DVBALD1
DVBALD1 ;ALB/JLU;extension of DVBALD;9/19/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
ADD(WHO) ;this is used by both the add and create actions of List Man
 ;discharge.
 K DVBAQUIT
 S VAR(1,0)="0,0,0,2,1^"_$S(WHO="AD":"You may now add to the default list of discharge types.",1:"You may now select a new list of discharge types.")
 S VAR(2,0)="0,0,0,1,0^Both 'active' and 'inactive' discharge types can be selected."
 S VAR(3,0)="0,0,0,1:2,0^If help or a list is needed enter a '?'"
 D WR^DVBAUTL4("VAR")
 K VAR
 S DVBIEDSC=$$DSCTIEN^DVBAUTL6("DISCHARGE") ;gets the IFN of "discharge"
 I DVBIEDSC<1 DO  Q
 .S VAR(1,0)="1,0,0,2,0^No discharge type MAS Movement Transaction type was found"
 .S VAR(2,0)="0,0,0,1,0^Contact your site manager."
 .D WR^DVBAUTL4("VAR")
 .S DVBAQUIT=1
 .K VAR
 .Q
 F  DO  Q:$D(DVBAQUIT)  ;loop to keep asking for movement types
 .S DIC="^DG(405.2,",DIC(0)="AEMQZ"
 .S DIC("S")="I DVBIEDSC=$P(^(0),U,2)!(+Y=18)!(+Y=40)!(+Y=43) I '$D(^TMP(""DVBA"",$J,""DUP"",+Y))"
 .D ^DIC
 .I +Y>0 DO
 ..I $$CHECKDUP(+Y) Q  ;checks for duplicates not really needed but
 ..D SETARAY(Y)
 ..Q
 .I +Y<1 S DVBAQUIT=1
 .Q
 K DVBIEDSC
 Q
 ;
CHECKDUP(A) ;checks if an entry has already been selected.  if yes returns a 1
 I $D(^TMP("DVBA",$J,"DUP",+Y)) DO  Q 1
 .S VAR(1,0)="1,0,0,2,0^This discharge type has already been selected."
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .Q
 E  Q 0
 ;
SETARAY(A) ;sets the necessary listmanager and global arrays for this
 ;selection
 ;A is the IEN of the discharge type and the second piece is the
 ;external value
 N TEXT
 S VALMCNT=VALMCNT+1
 S TEXT=$$SETFLD^VALM1(VALMCNT,"","ITEM")
 S TEXT=$$SETFLD^VALM1($P(A,U,2),TEXT,"DISCHARGE TYPE")
 S TEXT=$$SETFLD^VALM1(+A,TEXT,"DISCHARGE CODE")
 S DVBA=$$CHECK^DVBAUTL6(+A)
 I DVBA=0 S TEXT=$$SETFLD^VALM1("INACTIVE",TEXT,"STATUS")
 S @VALMAR@(VALMCNT,0)=TEXT
 S @VALMAR@("IDX",VALMCNT,VALMCNT)=""
 S ^TMP("DVBA",$J,"DUP",+A)=""
 S @VALMAR@("FND",VALMCNT,+A)=""
 Q
 ;
DELETE ;This entry point allows the users to delete from the list of discharge
 ;types
 K DVBAQUIT
 F  DO  Q:$D(DVBAQUIT)
 .D RE^VALM4
 .S VALMNOD=$G(XQORNOD(0))
 .D EN^VALM2(VALMNOD,"O")
 .I '$O(VALMY("")) S DVBAQUIT=1 Q
 .S DVBA=""
 .F  S DVBA=$O(VALMY(DVBA)) Q:DVBA=""  DO
 ..S DVBB=$O(@VALMAR@("FND",DVBA,0))
 ..K ^TMP("DVBA",$J,"DUP",DVBB)
 ..K @VALMAR@("FND",DVBA,DVBB)
 ..K @VALMAR@(DVBA,0)
 ..K @VALMAR@("IDX",DVBA)
 ..Q
 .D RELIST
 .Q
 K DVBA,DVBB
 Q
 ;
RELIST ;re-organizes the list after a deletion
 N DVBA,DVBOLD,DVBOLDC
 S VALMCNT=0,DVBA=""
 F  S DVBA=$O(@VALMAR@(DVBA)) Q:'DVBA  DO
 .S VALMCNT=VALMCNT+1
 .S DVBOLD=$$SETFLD^VALM1(VALMCNT,@VALMAR@(DVBA,0),"ITEM")
 .S DVBOLDC=$O(@VALMAR@("FND",DVBA,0))
 .K @VALMAR@(DVBA,0)
 .K @VALMAR@("IDX",DVBA)
 .K @VALMAR@("FND",DVBA)
 .S @VALMAR@(VALMCNT,0)=DVBOLD
 .S @VALMAR@("IDX",VALMCNT,VALMCNT)=""
 .S @VALMAR@("FND",VALMCNT,DVBOLDC)=""
 .Q
 Q

DVBANT21
DVBANT21 ;ALB/JLU;pending 21 day certificate;9/15/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;the main entry point
 D HDR
 S DVBTYPE=$$TYPE()
 I DVBTYPE'=1 DO
 .I DVBTYPE="B" D BOTH
 .I DVBTYPE="N" D NOTICE
 .I DVBTYPE="C" D CERTIF
 .S L=0,DIC="^DVB(396,",(FR,TO)=""
 .D EN1^DIP
 .K L,DIC,FR,TO,BY,FLDS
 .Q
 D KILL
 Q
 ;
KILL K DVBTYPE,DUOUT,DTOUT
 Q
 ;
HDR ;issues an initial form feed
 S VAR(1,0)="0,0,0,0,1^"
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
TYPE() ;gets from the user what type of report they are interested in.
 N DVBOUT
 S DIR(0)="SM^N:Notice of Discharge;C:21 Day Certificate;B:Both"
 S DIR("A")="Select the desired report"
 D ^DIR
 K DIR
 I $D(DUOUT)!($D(DTOUT)) S DVBOUT=1
 I Y="" S DVBOUT=1
 I "NCB"[Y S DVBOUT=Y
 E  S DVBOUT=1
 Q DVBOUT
 ;
NOTICE ;sets up the templates for the notice of discharge reports.
 S (FLDS,BY)="[DVBA NOTICE OF DISCHARGE]"
 Q
 ;
BOTH ;sets up the templates for both the notice of discharge and 21 day cert
 S (FLDS,BY)="[DVBA NOT/DIS-21 DAY CERT CHECK]"
 Q
 ;
CERTIF ;sets up the templates for the 21 day certificate
 S (FLDS,BY)="[DVBA 21 DAY CERT]"
 Q

DVBANTE0
DVBANTE0 ;ISC/XTSUMBLD KERNEL - Package checksum checker ;APR 10, 1995@13:51:40
 ;;2.7;AMIE;;Apr 10, 1995
 ;;7.2;APR 10, 1995@13:51:40
 S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
CONT F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
 G CONT^DVBANTE1
 K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
ONE S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
 W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
 W ! G CONT
ROU ;;
DVBAPSYN ;;2378133
DVBAPW1 ;;8347851
DVBAPW2 ;;15046563
DVBAPWKS ;;2574436
DVBARAD1 ;;9779353
DVBARADM ;;13766190
DVBAREG1 ;;5604558
DVBAREG2 ;;6796936
DVBAREG3 ;;496700
DVBAREN1 ;;5110486
DVBAREQ1 ;;6046247
DVBAREQ3 ;;11591429
DVBAREQS ;;4101625
DVBARL21 ;;9497644
DVBARPUR ;;2109695
DVBARQP ;;7408065
DVBASCRP ;;10618584
DVBASITE ;;432310
DVBASPD2 ;;12609416
DVBASPDC ;;1855839
DVBASTAT ;;1731141
DVBAUTIL ;;17077948
DVBAUTL1 ;;671413
DVBAUTL2 ;;11376979
DVBAUTL3 ;;5126380
DVBAUTL4 ;;1068079
DVBAUTL5 ;;2400662
DVBAUTL6 ;;1039958
DVBAUTL7 ;;4947961
DVBAUTL8 ;;2009228
DVBAUTLH ;;1322144
DVBAVDPT ;;6199074
DVBCAACK ;;10697058
DVBCADCK ;;16662513
DVBCADE1 ;;12482920
DVBCADE2 ;;12838391
DVBCADEX ;;5964579
DVBCADR ;;5562753
DVBCAMC1 ;;16773745
DVBCAMCK ;;24825901
DVBCAMI1 ;;5901817
DVBCAMI2 ;;12729591
DVBCAMI3 ;;3088709
DVBCAMIS ;;5835381
DVBCAMR1 ;;2817493
DVBCAMR2 ;;11670627
DVBCAMRO ;;5648976
DVBCAOC1 ;;15597069
DVBCAOCK ;;16213615
DVBCARC1 ;;11119260
DVBCARC2 ;;3468613
DVBCARCK ;;5894420
DVBCATC1 ;;10433901
DVBCATCK ;;3242113
DVBCBNCK ;;9472567
DVBCBRCK ;;9688091
DVBCBUL1 ;;6490294
DVBCBULL ;;11261928
DVBCCECK ;;5348778
DVBCCHKR ;;11985936
DVBCCNC1 ;;10329224
DVBCCNCL ;;14608393
DVBCCNNS ;;6465570
DVBCCRCK ;;10796464
DVBCCUCK ;;9102724
DVBCCYCK ;;8998698
DVBCDACK ;;10981371
DVBCDBCK ;;11708644
DVBCDECK ;;5200660
DVBCDHCK ;;9236029
DVBCDICK ;;9010550
DVBCDMCK ;;10183017
DVBCDNCK ;;7857444
DVBCEDCK ;;12782887
DVBCEDIT ;;13356686
DVBCEEXM ;;6444590
DVBCENCK ;;11064281
DVBCENQ ;;3137584
DVBCENQ1 ;;17735634
DVBCENQ2 ;;5360800
DVBCESCK ;;8586267
DVBCEXML ;;5745207
DVBCFEE ;;4823842
DVBCFSCK ;;8400570
DVBCFTCK ;;11486991
DVBCGECK ;;5329066
DVBCGMC1 ;;11580608
DVBCGMCK ;;19361685
DVBCGNCK ;;16937132
DVBCGOCK ;;14320767
DVBCGSCK ;;5315275
DVBCHACK ;;10806048
DVBCHDCK ;;8836870
DVBCHECK ;;5877095
DVBCHLCK ;;15488784
DVBCHLOR ;;984544
DVBCHLQ ;;6640186
DVBCHLR ;;11476557
DVBCHLUT ;;3110204
DVBCHMC1 ;;2272934
DVBCHMCK ;;9509200
DVBCHNCK ;;13792552
DVBCHPCK ;;11448190
DVBCHS0 ;;1790541
DVBCHS1 ;;1496798
DVBCHS2 ;;2433797
DVBCHTCK ;;8302169
DVBCHYCK ;;7996254
DVBCIRP1 ;;11482024
DVBCIRPT ;;4499283
DVBCIUT1 ;;2146997
DVBCIUTL ;;5639159
DVBCJNCK ;;15001703
DVBCLABR ;;4708883
DVBCLKT2 ;;7808623
DVBCLKTL ;;6998431
DVBCLMHD ;;57210
DVBCLMU2 ;;314744
DVBCLMU5 ;;1478779
DVBCLOG ;;11143383
DVBCLOG2 ;;2684669
DVBCLOGE ;;10765565
DVBCLTR ;;2127008
DVBCLTR2 ;;3092277
DVBCLURN ;;1306910
DVBCMDCK ;;9944806
DVBCMECK ;;5385050
DVBCMKL2 ;;9133939
DVBCMKLK ;;6462243
DVBCMLCK ;;9262268
DVBCMMCK ;;10979579
DVBCMNCK ;;14329368
DVBCMOCK ;;5723689
DVBCMSCK ;;10520804
DVBCMTCK ;;9589187
DVBCNHCK ;;8951617
DVBCNICK ;;8854235
DVBCNKCK ;;10172030
DVBCNLCK ;;12481864
DVBCNNCK ;;5288860
DVBCNPCK ;;9891090
DVBCNSCK ;;9764945
DVBCNTCK ;;10392687
DVBCNTSC ;;9266168
DVBCNUCK ;;5317272
DVBCOECK ;;5356538
DVBCPATA ;;5360197
DVBCPDCK ;;12898016
DVBCPECK ;;5210166
DVBCPG1 ;;511338
DVBCPG2 ;;814756

DVBANTE1
DVBANTE1 ;ISC/XTSUMBLD KERNEL - Package checksum checker ;APR 10, 1995@13:51:40
 ;;2.7;AMIE;;Apr 10, 1995
 ;;7.2;APR 10, 1995@13:51:40
 S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
CONT F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
 ;
 K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
ONE S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
 W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
 W ! G CONT
ROU ;;
DVBCPGC ;;3629785
DVBCPGD ;;11420689
DVBCPGD1 ;;572906
DVBCPGH ;;3373772
DVBCPGL ;;1850746
DVBCPGR ;;9240313
DVBCPGR2 ;;5229832
DVBCPGU ;;203249
DVBCPICK ;;13939469
DVBCPNCK ;;10044404
DVBCPND1 ;;16899646
DVBCPNDR ;;16810308
DVBCPRCK ;;9547206
DVBCPRN1 ;;13330130
DVBCPRNT ;;10116611
DVBCPTCK ;;11835787
DVBCPTS1 ;;9638269
DVBCPUCK ;;8892327
DVBCPURG ;;2431903
DVBCPWC1 ;;22513970
DVBCPWC2 ;;8815419
DVBCPWC3 ;;4489767
DVBCPWC4 ;;7046962
DVBCPWCK ;;12425723
DVBCPYCK ;;8272715
DVBCRACK ;;8048704
DVBCREDT ;;10184147
DVBCRELS ;;11302743
DVBCREQ1 ;;9905931
DVBCREQ2 ;;8627439
DVBCREQ3 ;;2872183
DVBCREQM ;;3068313
DVBCREQP ;;13619707
DVBCRLST ;;5612320
DVBCRMCK ;;10472657
DVBCROP1 ;;2112790
DVBCROPN ;;13604559
DVBCRPON ;;10309052
DVBCRPR1 ;;8547301
DVBCRPRT ;;9132762
DVBCSCCK ;;14602586
DVBCSCHD ;;14356477
DVBCSDEV ;;742431
DVBCSECK ;;5042896
DVBCSKCK ;;16733993
DVBCSMCK ;;9642868
DVBCSPCK ;;12224238
DVBCSRCK ;;10038108
DVBCSTCK ;;9443868
DVBCSYCK ;;11659947
DVBCTRN ;;7222901
DVBCTRN1 ;;2117428
DVBCTRNN ;;1315735
DVBCTSCK ;;9953638
DVBCTTCK ;;8903016
DVBCULAP ;;6951849
DVBCUTA1 ;;7784264
DVBCUTA2 ;;7425828
DVBCUTA3 ;;6525329
DVBCUTA4 ;;1930083
DVBCUTIL ;;17784731
DVBCUTL2 ;;16484712
DVBCUTL3 ;;14291313
DVBCUTL4 ;;6410758
DVBCUTL5 ;;4812185
DVBCUTL6 ;;5521630
DVBCUTL7 ;;4066959
DVBCUTL8 ;;5560283
DVBCVSC1 ;;8410639
DVBCVSC2 ;;3179214
DVBCVSCK ;;8269704
DVBCVW2 ;;3362992
DVBCXFRA ;;14804015
DVBCXFRB ;;10012404
DVBCXFRC ;;14794975
DVBCXFRD ;;5143029
DVBCXFRE ;;14434836
DVBCXFRS ;;6119351
DVBCXSCK ;;10643105
DVBCXUTL ;;1017429

DVBANTEG
DVBANTEG ;ISC/XTSUMBLD KERNEL - Package checksum checker ;APR 10, 1995@13:51:40
 ;;2.7;AMIE;;Apr 10, 1995
 ;;7.2;APR 10, 1995@13:51:40
 S XT4="I 1",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
CONT F XT1=1:1 S XT2=$T(ROU+XT1) Q:XT2=""  S X=$P(XT2," ",1),XT3=$P(XT2,";",3) X XT4 I $T W !,X X ^%ZOSF("TEST") S:'$T XT3=0 X:XT3 ^%ZOSF("RSUM") W ?10,$S('XT3:"Routine not in UCI",XT3'=Y:"Calculated "_$C(7)_Y_", off by "_(Y-XT3),1:"ok")
 G CONT^DVBANTE0
 K %1,%2,%3,X,Y,XT1,XT2,XT3,XT4 Q
ONE S XT4="I $D(^UTILITY($J,X))",X=$T(+3) W !!,"Checksum routine created on ",$P(X,";",4)," by KERNEL V",$P(X,";",3),!
 W !,"Check a subset of routines:" K ^UTILITY($J) X ^%ZOSF("RSEL")
 W ! G CONT
ROU ;;
DVBAADM1 ;;638257
DVBAADMR ;;3192270
DVBAADRP ;;11281413
DVBAALRT ;;969678
DVBAAPLK ;;6762813
DVBACERT ;;16541319
DVBACMRP ;;14742419
DVBACRMS ;;8195822
DVBACRRP ;;6672179
DVBACRRR ;;7192044
DVBADSCK ;;11427543
DVBADSNT ;;14580376
DVBADSR1 ;;3955541
DVBADSRP ;;14116837
DVBADSRT ;;11545161
DVBADXFR ;;5748263
DVBAEDIT ;;9839591
DVBAENVR ;;5167682
DVBAERMK ;;822652
DVBAFINL ;;5664221
DVBAI001 ;;3984946
DVBAI002 ;;7866078
DVBAI003 ;;9465736
DVBAI004 ;;9426448
DVBAI005 ;;9168773
DVBAI006 ;;9757793
DVBAI007 ;;9844024
DVBAI008 ;;9414143
DVBAI009 ;;9305581
DVBAI00A ;;9714050
DVBAI00B ;;9020543
DVBAI00C ;;9205465
DVBAI00D ;;9275269
DVBAI00E ;;10702094
DVBAI00F ;;9264996
DVBAI00G ;;9888686
DVBAI00H ;;8631990
DVBAI00I ;;2666346
DVBAI00J ;;8624033
DVBAI00K ;;11375562
DVBAI00L ;;9023586
DVBAI00M ;;3654681
DVBAI00N ;;8288884
DVBAI00O ;;1499139
DVBAI00P ;;8500746
DVBAI00Q ;;9547260
DVBAI00R ;;11396004
DVBAI00S ;;10868518
DVBAI00T ;;9805564
DVBAI00U ;;8802965
DVBAI00V ;;7168357
DVBAI00W ;;9596589
DVBAI00X ;;10329148
DVBAI00Y ;;8702207
DVBAI00Z ;;9399915
DVBAI010 ;;3326017
DVBAI011 ;;3708388
DVBAI012 ;;1579336
DVBAI013 ;;8361562
DVBAI014 ;;1684479
DVBAI015 ;;7142274
DVBAI016 ;;7573161
DVBAI017 ;;4202819
DVBAI018 ;;6043854
DVBAI019 ;;1963020
DVBAI01A ;;4682695
DVBAI01B ;;8066247
DVBAI01C ;;8472098
DVBAI01D ;;6719976
DVBAI01E ;;7549877
DVBAI01F ;;6406205
DVBAI01G ;;9927999
DVBAI01H ;;11184873
DVBAI01I ;;10454297
DVBAI01J ;;11118349
DVBAI01K ;;7304944
DVBAI01L ;;7088947
DVBAI01M ;;8609341
DVBAI01N ;;23872670
DVBAI01O ;;12878748
DVBAI01P ;;16144162
DVBAI01Q ;;15894662
DVBAI01R ;;13555576
DVBAI01S ;;10109941
DVBAI01T ;;8315375
DVBAI01U ;;7822572
DVBAI01V ;;8807572
DVBAI01W ;;8780467
DVBAI01X ;;9786334
DVBAI01Y ;;7073206
DVBAI01Z ;;8706653
DVBAI020 ;;8048446
DVBAI021 ;;7564126
DVBAI022 ;;9900450
DVBAI023 ;;9894542
DVBAI024 ;;5713031
DVBAI025 ;;4951735
DVBAI026 ;;3222134
DVBAINI1 ;;5770759
DVBAINI2 ;;5232529
DVBAINI3 ;;16092457
DVBAINI4 ;;3357701
DVBAINI5 ;;1903353
DVBAINIS ;;2207479
DVBAINIT ;;11258137
DVBAL ;;3279129
DVBALD ;;1530456
DVBALD1 ;;4391960
DVBANT21 ;;698454
DVBAO001 ;;6460949
DVBAO002 ;;4296819
DVBAONI1 ;;1696470
DVBAONI2 ;;82755
DVBAONI3 ;;10576517
DVBAONIT ;;991575
DVBAORPH ;;3955878
DVBAPADD ;;3497529
DVBAPB1 ;;17920740
DVBAPBDY ;;2080048
DVBAPCXR ;;54860
DVBAPEND ;;6684165
DVBAPK1 ;;8583019
DVBAPK2 ;;6721462
DVBAPK3 ;;9969058
DVBAPK4 ;;7382410
DVBAPK5 ;;20407396
DVBAPK6 ;;3832227
DVBAPK7 ;;13981008
DVBAPK8 ;;6707125
DVBAPK9 ;;14020154
DVBAPKY ;;3837287
DVBAPL1 ;;4046552
DVBAPL10 ;;6712841
DVBAPL2 ;;7267685
DVBAPL3 ;;7327937
DVBAPL4 ;;2566783
DVBAPL5 ;;6525199
DVBAPL6 ;;6047068
DVBAPL7 ;;5890852
DVBAPL8 ;;6021230
DVBAPL9 ;;2474407
DVBAPLL ;;7328205
DVBAPLNG ;;3091129
DVBAPND1 ;;10210532
DVBAPOK1 ;;160506
DVBAPOKY ;;3153890
DVBAPOP2 ;;5414428
DVBAPOPU ;;2122566
DVBAPOST ;;7636342
DVBAPRE ;;2020496
DVBAPS1 ;;976623
DVBAPST1 ;;821822
DVBAPST3 ;;6045742

DVBAO001
DVBAO001 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"PRO",634,0)
 ;;=VALM NEXT SCREEN^Next Screen^^A^^^^^^^^LIST MANAGER
 ;;^UTILITY(U,$J,"PRO",634,1,0)
 ;;=^^2^2^2920519^^^
 ;;^UTILITY(U,$J,"PRO",634,1,1,0)
 ;;=This action will allow the user to view the next screen
 ;;^UTILITY(U,$J,"PRO",634,1,2,0)
 ;;=of entries, if any exist.
 ;;^UTILITY(U,$J,"PRO",634,2,0)
 ;;=^101.02A^1^1
 ;;^UTILITY(U,$J,"PRO",634,2,1,0)
 ;;=NX
 ;;^UTILITY(U,$J,"PRO",634,2,"B","NX",1)
 ;;=
 ;;^UTILITY(U,$J,"PRO",634,20)
 ;;=D NEXT^VALM4
 ;;^UTILITY(U,$J,"PRO",634,99)
 ;;=56328,39808
 ;;^UTILITY(U,$J,"PRO",634,"MEN","DVBA C VIEW EXAMS (MENU)")
 ;;=634^NX^11
 ;;^UTILITY(U,$J,"PRO",635,0)
 ;;=VALM PREVIOUS SCREEN^Previous Screen^^A^^^^^^^^LIST MANAGER
 ;;^UTILITY(U,$J,"PRO",635,1,0)
 ;;=^^2^2^2920113^^
 ;;^UTILITY(U,$J,"PRO",635,1,1,0)
 ;;=This action will allow the user to view the previous screen
 ;;^UTILITY(U,$J,"PRO",635,1,2,0)
 ;;=of entries, if any exist.
 ;;^UTILITY(U,$J,"PRO",635,2,0)
 ;;=^101.02A^3^2
 ;;^UTILITY(U,$J,"PRO",635,2,1,0)
 ;;=PR
 ;;^UTILITY(U,$J,"PRO",635,2,2,0)
 ;;=BK
 ;;^UTILITY(U,$J,"PRO",635,2,3,0)
 ;;=PR
 ;;^UTILITY(U,$J,"PRO",635,2,"B","BK",2)
 ;;=
 ;;^UTILITY(U,$J,"PRO",635,2,"B","PR",1)
 ;;=
 ;;^UTILITY(U,$J,"PRO",635,2,"B","PR",3)
 ;;=
 ;;^UTILITY(U,$J,"PRO",635,20)
 ;;=D PREV^VALM4
 ;;^UTILITY(U,$J,"PRO",635,99)
 ;;=56328,39808
 ;;^UTILITY(U,$J,"PRO",635,"MEN","DVBA C VIEW EXAMS (MENU)")
 ;;=635^BU^12
 ;;^UTILITY(U,$J,"PRO",642,0)
 ;;=VALM QUIT^Quit^^A^^^^^^^^LIST MANAGER
 ;;^UTILITY(U,$J,"PRO",642,.1)
 ;;= 
 ;;^UTILITY(U,$J,"PRO",642,1,0)
 ;;=^^1^1^2911105^
 ;;^UTILITY(U,$J,"PRO",642,1,1,0)
 ;;=This protocol can be used as a generic 'quit' action.
 ;;^UTILITY(U,$J,"PRO",642,2,0)
 ;;=^101.02A^2^2
 ;;^UTILITY(U,$J,"PRO",642,2,1,0)
 ;;=EXIT
 ;;^UTILITY(U,$J,"PRO",642,2,2,0)
 ;;=QUIT
 ;;^UTILITY(U,$J,"PRO",642,2,"B","EXIT",1)
 ;;=
 ;;^UTILITY(U,$J,"PRO",642,2,"B","QUIT",2)
 ;;=
 ;;^UTILITY(U,$J,"PRO",642,20)
 ;;=Q
 ;;^UTILITY(U,$J,"PRO",642,99)
 ;;=56328,39808
 ;;^UTILITY(U,$J,"PRO",642,"MEN","DVBA C VIEW EXAMS (MENU)")
 ;;=642^QU^31
 ;;^UTILITY(U,$J,"PRO",642,"MEN","DVBA DISCHARGE TYPES (MENU)")
 ;;=642^QU^5
 ;;^UTILITY(U,$J,"PRO",644,0)
 ;;=VALM PRINT LIST^Print List^^A^^^^^^^^LIST MANAGER
 ;;^UTILITY(U,$J,"PRO",644,1,0)
 ;;=^^2^2^2920113^
 ;;^UTILITY(U,$J,"PRO",644,1,1,0)
 ;;=This action allws the user to print the entire list of
 ;;^UTILITY(U,$J,"PRO",644,1,2,0)
 ;;=entries currently being displayed.
 ;;^UTILITY(U,$J,"PRO",644,20)
 ;;=D PRTL^VALM1
 ;;^UTILITY(U,$J,"PRO",644,99)
 ;;=56328,39808
 ;;^UTILITY(U,$J,"PRO",644,"MEN","DVBA C VIEW EXAMS (MENU)")
 ;;=644^PL^22
 ;;^UTILITY(U,$J,"PRO",1106,0)
 ;;=DVBA C VIEW EXAMS (MENU)^View Exams^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"PRO",1106,1,0)
 ;;=^^1^1^2940321^^
 ;;^UTILITY(U,$J,"PRO",1106,1,1,0)
 ;;=View exams protocol for displaying Physician's Guide
 ;;^UTILITY(U,$J,"PRO",1106,4)
 ;;=26^4
 ;;^UTILITY(U,$J,"PRO",1106,10,0)
 ;;=^101.01PA^2^6
 ;;^UTILITY(U,$J,"PRO",1106,10,1,0)
 ;;=1108^SQ^32
 ;;^UTILITY(U,$J,"PRO",1106,10,1,"^")
 ;;=DVBA C SUPER QUIT
 ;;^UTILITY(U,$J,"PRO",1106,10,2,0)
 ;;=1107^JMP^21
 ;;^UTILITY(U,$J,"PRO",1106,10,2,"^")
 ;;=DVBA C VIEW JUMP (ACTION)
 ;;^UTILITY(U,$J,"PRO",1106,24)
 ;;=I 1 X:$D(^ORD(101,+$P(^ORD(101,DA(1),10,DA,0),"^",1),24)) ^(24)
 ;;^UTILITY(U,$J,"PRO",1106,26)
 ;;=D SHOW^VALM,KEYSET^DVBCVW2
 ;;^UTILITY(U,$J,"PRO",1106,28)
 ;;=Select Action: 
 ;;^UTILITY(U,$J,"PRO",1106,99)
 ;;=56340,37314
 ;;^UTILITY(U,$J,"PRO",1107,0)
 ;;=DVBA C VIEW JUMP (ACTION)^Jump to New Exam^^A^^^^^^^^
 ;;^UTILITY(U,$J,"PRO",1107,20)
 ;;=D INIT^DVBCLMU5
 ;;^UTILITY(U,$J,"PRO",1107,24)
 ;;=I DVBAC'="O"&(DVBAC'="E")
 ;;^UTILITY(U,$J,"PRO",1107,99)
 ;;=56328,39807
 ;;^UTILITY(U,$J,"PRO",1108,0)
 ;;=DVBA C SUPER QUIT^Super Quit^^A^^^^^^^^
 ;;^UTILITY(U,$J,"PRO",1108,20)
 ;;=D QUIT^DVBCLMU5
 ;;^UTILITY(U,$J,"PRO",1108,99)
 ;;=56328,39807
 ;;^UTILITY(U,$J,"PRO",1155,0)
 ;;=DVBA ADD DISCHARGE TYPE^ADD TYPES^^A^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"PRO",1155,4)
 ;;=^^^IDENTIFIRE
 ;;^UTILITY(U,$J,"PRO",1155,10,0)
 ;;=^101.01PA^0^0
 ;;^UTILITY(U,$J,"PRO",1155,20)
 ;;=D ADD^DVBALD
 ;;^UTILITY(U,$J,"PRO",1155,26)
 ;;=
 ;;^UTILITY(U,$J,"PRO",1155,99)
 ;;=56328,39806
 ;;^UTILITY(U,$J,"PRO",1156,0)
 ;;=DVBA DISCHARGE TYPES (MENU)^DISCHARGE TYPES MENU^^M^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"PRO",1156,1,0)
 ;;=^^1^1^2941109^
 ;;^UTILITY(U,$J,"PRO",1156,1,1,0)
 ;;= 
 ;;^UTILITY(U,$J,"PRO",1156,4)
 ;;=26^3^^TEST MENU ID
 ;;^UTILITY(U,$J,"PRO",1156,10,0)
 ;;=^101.01PA^4^5
 ;;^UTILITY(U,$J,"PRO",1156,10,1,0)
 ;;=1159^AL^1
 ;;^UTILITY(U,$J,"PRO",1156,10,1,"^")
 ;;=DVBA ACCEPT DISCHARGE TYPES

DVBAO002
DVBAO002 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 F I=1:2 S X=$T(Q+I) Q:X=""  S Y=$E($T(Q+I+1),4,999),X=$E(X,4,999) S:$A(Y)=126 I=I+1,Y=$E(Y,2,999)_$E($T(Q+I+1),5,99) S:$A(Y)=61 Y=$E(Y,2,999) X NO E  S @X=Y
Q Q
 ;;^UTILITY(U,$J,"PRO",1156,10,2,0)
 ;;=1155^AD^2
 ;;^UTILITY(U,$J,"PRO",1156,10,2,"^")
 ;;=DVBA ADD DISCHARGE TYPE
 ;;^UTILITY(U,$J,"PRO",1156,10,3,0)
 ;;=1157^DT^3
 ;;^UTILITY(U,$J,"PRO",1156,10,3,"^")
 ;;=DVBA DELETE DISCHARGE TYPES
 ;;^UTILITY(U,$J,"PRO",1156,10,4,0)
 ;;=1158^CL^4
 ;;^UTILITY(U,$J,"PRO",1156,10,4,"^")
 ;;=DVBA CREATE DISCHARGE TYPE LIST
 ;;^UTILITY(U,$J,"PRO",1156,20)
 ;;=S XQORM("B")="AL"
 ;;^UTILITY(U,$J,"PRO",1156,26)
 ;;=DO SHOW^VALM
 ;;^UTILITY(U,$J,"PRO",1156,99)
 ;;=56328,39808
 ;;^UTILITY(U,$J,"PRO",1157,0)
 ;;=DVBA DELETE DISCHARGE TYPES^DELETE TYPES^^A^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"PRO",1157,20)
 ;;=D DELETE^DVBALD
 ;;^UTILITY(U,$J,"PRO",1157,99)
 ;;=56328,39807
 ;;^UTILITY(U,$J,"PRO",1158,0)
 ;;=DVBA CREATE DISCHARGE TYPE LIST^CREATE NEW LIST^^A^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"PRO",1158,20)
 ;;=D CREATE^DVBALD
 ;;^UTILITY(U,$J,"PRO",1158,99)
 ;;=56328,39807
 ;;^UTILITY(U,$J,"PRO",1159,0)
 ;;=DVBA ACCEPT DISCHARGE TYPES^ACCEPT TYPES^^A^^^^^^^^AUTOMATED MED INFO EXCHANGE
 ;;^UTILITY(U,$J,"PRO",1159,1,0)
 ;;=^^1^1^2941209^
 ;;^UTILITY(U,$J,"PRO",1159,1,1,0)
 ;;=///
 ;;^UTILITY(U,$J,"PRO",1159,20)
 ;;=D ACCEPT^DVBALD
 ;;^UTILITY(U,$J,"PRO",1159,99)
 ;;=56328,39806
 ;;^UTILITY(U,$J,"PRO",1195,0)
 ;;=DVBA C&P SCHD EVENT^AMIE 2507 Exam to C&P Appointment Link Processing^AMIE LINK OUT OF ORDER^A^^^^^^^^
 ;;^UTILITY(U,$J,"PRO",1195,1,0)
 ;;=^^4^4^2950224^^^^
 ;;^UTILITY(U,$J,"PRO",1195,1,1,0)
 ;;=AMIE C&P appointment processing protocol.  This protocol is executed from
 ;;^UTILITY(U,$J,"PRO",1195,1,2,0)
 ;;=the SDAM APPOINTMENT EVENTS protocol as an Item.  It asks a series of
 ;;^UTILITY(U,$J,"PRO",1195,1,3,0)
 ;;=questions to any user making a C&P appointment.  It's purpose is to provide
 ;;^UTILITY(U,$J,"PRO",1195,1,4,0)
 ;;=a tracking mechanism between AMIE 2507 exams and C&P appointments.
 ;;^UTILITY(U,$J,"PRO",1195,20)
 ;;=D ^DVBCSDEV
 ;;^UTILITY(U,$J,"PRO",1195,99)
 ;;=56328,39807
 ;;^UTILITY(U,$J,"PRO",1195,101.0431,0)
 ;;=^^1^1^2941205^^^^
 ;;^UTILITY(U,$J,"PRO",1195,101.0431,1,0)
 ;;= 
 ;;^UTILITY(U,$J,"PRO",1195,"MEN","SDAM APPOINTMENT EVENTS")
 ;;=1195^^8

DVBAONI1
DVBAONI1 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ; LOADS
 ;
 I $S('$D(DUZ)#2:1,'$D(DUZ(0))#2:1,1:0) W !,"DUZ and DUZ(0) must be defined to continue." K DIFQ Q
 K DIF,DIK,D,DDF,DDT,DTO,D0,DLAYGO,DIC,DIR,DA,DFR,DTN,DIX,DZ D DT^DVBAONI2 S %=1,U="^",DSEC=1
 S NO=$P("I 0^I $D(@X)#2,X[U",U,%) I %<1 K DIFQ Q
 W !,"    PROTOCOL INSTALLATION"
 Q:'$D(DIFQ)  ;S %=0 W !!,"ARE YOU SURE YOU WANT TO CONTINUE" D YN^DICN I %-1 K DIFQ Q
 D DT^DVBAONI2 K ^UTILITY(U,$J),^UTILITY("DIK",$J) W !,"...OK, this may take a while, hold on please..." F R=1001:1:1002 D @("^DVBAO"_$E(R,2,4)) W "."

DVBAONI2
DVBAONI2 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;
 K ^UTILITY("ORVROM",$J),DIC
 Q
DT W !
 I '$D(DTIME) S DTIME=999
 K %DT D NOW^%DTC S DT=X
 K DIK,DIC,%I,DICS Q
 ;

DVBAONI3
DVBAONI3 ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;
 K ^UTILITY("ORVROM",$J) S DIC(0)="LX",ORNMCHK=1 I $D(^ORD(101,0))#2,^(0)?1"PROTOCOL".E S DIC="^ORD(101,",DLAYGO=101,N="PRO" D ADD,OP
 K ^UTILITY(U,$J),DIC,DLAYGO
 Q
DIEZ I ^DD("VERSION")>17.4,'$D(DISYS),$D(^%ZOSF("OS"))#2 S DISYS=+$P(^("OS"),"^",2)
 E  S DISYS=^DD("OS")
 Q:'$D(^DD("OS",DISYS,"ZS"))
 S N=$O(^UTILITY("ORVROM",$J,DIR,0)) Q:N=""  S Y=+^(N) K ^(N)
 I $D(@("^"_DIR_"(Y,""ROU"")")) K ^("ROU") I $D(^("ROUOLD")) S X=^("ROUOLD"),DMAX=^DD("ROU") D:X]"" @("EN^DI"_$E(DIR,3)_"Z")
 G DIEZ
 ;
OP S NM=$O(^UTILITY("ORVROM",$J,N,NM)) I NM="" K ^UTILITY("ORVROM",$J) G Q
 S R=$O(^UTILITY("ORVROM",$J,N,NM,0)) G:R="" OP
 W !,"'"_NM_"' Protocol Filed" S DA=+^UTILITY("ORVROM",$J,N,NM,R)
 S %=$P(^ORD(101,DA,0),U,12) S:%]"" %=$O(^DIC(9.4,"B",%,0))
 S $P(^ORD(101,DA,0),U,12)=%,(ORDZ,ORDIX)=0
 S %=$S($D(^ORD(101,DA,5)):$P(^(5),"^"),1:"") I $L(%) S $P(^(5),"^")="",X=$P(%,";",2),%=$P(%,";") I $D(@("^"_X_"""B"","""_%_""")")) S %=$O(^(%,0)) S %=$S(%:%_";"_X,1:""),$P(^ORD(101,DA,5),"^")=%
 I $D(^ORD(101,DA,3,0)) S I=0 F  S I=$O(^ORD(101,DA,3,I)) Q:I<1  S KEY=^(I,0) K ^(0) I $D(^DIC(19.1,"B",KEY)) S KEY=$O(^(KEY,0)) I KEY S ^ORD(101,DA,3,I,0)=KEY
 I $D(^ORD(101,DA,3)) S I=0 F  S I=$O(^ORD(101,DA,3,I)) Q:I<1  S ORDZ=ORDZ+1,ORDIX=X
 I  S $P(^ORD(101,DA,3,0),"^",3,4)=ORDIX_"^"_ORDZ
 I $D(^UTILITY("ORVROM",$J,N,NM,R,10)) S X=0 F  S X=$O(^UTILITY("ORVROM",$J,N,NM,R,10,X)) Q:X<1  D A1
 S (ORDZ,ORDIX)=0 S X=0 F  S X=$O(^ORD(101,DA,10,X)) Q:X<1  S ORDZ=ORDZ+1,ORDIX=X
 S:$D(^ORD(101,DA,10,0)) ^(0)="^101.01PA^"_ORDIX_U_ORDZ D IX1^DIK
 I $D(^UTILITY("ORVROM",$J,N,NM,R,"MEN")) S IMEN=0 F  S IMEN=$O(^UTILITY("ORVROM",$J,N,NM,R,"MEN",IMEN)) Q:IMEN=""  S OMEN=^(IMEN),MEN=IMEN D MEN
 K MEN,IMEN,OMEN
 G OP
 ;
ADD S R=0 F  S R=$O(^UTILITY(U,$J,N,R)) Q:R=""  S X=$P(^(R,0),U),I=$P(^(0),U,4) D
 . I $L($T(DOT^ORVOM)) D DOT^ORVOM
 . I '$L($T(DOT^ORVOM)) W "."
 . I $O(^ORD(101,"B",X,0)) S Y=$O(^(0)),ORA=Y,Y=Y_U D A Q
 . D ^DIC I Y>0,'$D(DIFQ(N))!$P(Y,U,3) S ORA=Y,Y=Y_U D A
Q K ORA,MEN,OMEN,ORNMCHK,ORDZ,ORDIX S (NM,R)=0 Q
A S ^UTILITY("ORVROM",$J,N,X,R)=Y
 I $O(^UTILITY(U,$J,N,R,1,0))>0 K ^ORD(101,+Y,1)
 I $O(^UTILITY(U,$J,N,R,10,0))>0 S %X="^UTILITY(U,$J,N,R,10,",%Y="^UTILITY(""ORVROM"",$J,N,X,R,10," D %XY^%RCR K ^UTILITY(U,$J,N,R,10)
 I $D(^UTILITY(U,$J,N,R,"MEN")) S %X="^UTILITY(U,$J,N,R,""MEN"",",%Y="^UTILITY(""ORVROM"",$J,N,X,R,""MEN""," D %XY^%RCR K ^UTILITY(U,$J,N,R,"MEN")
 S %X="^UTILITY(U,$J,N,R,",%Y=DIC_"+ORA,",DA=+ORA,DIK=DIC D %XY^%RCR
 Q
A1 S ORA=DA N DA,DIC,ORI S Y="",ORI=0,DIC="^ORD(101,"_+ORA_",10,",DIC(0)="L",DA(1)=+ORA S:'$D(^ORD(101,DA(1),10,0)) ^(0)="^101.01PA^^"
 F  S ORI=$O(^UTILITY("ORVROM",$J,N,NM,R,10,ORI)) Q:ORI<1  S X0=^(ORI,0),X=$S($D(^(U)):^(U),1:"") I $L(X) D A2
 K DA,^UTILITY("ORVROM",$J,N,NM,R,10)
 Q
A2 N X1 S DLAYGO=101 D ^DIC Q:'Y
 I $P(Y,"^",3) W !?2,X_" added as item to "_$P(^ORD(101,DA(1),0),"^")_"."
 S X0=^UTILITY("ORVROM",$J,N,NM,R,10,ORI,0)
 S %=$P(X0,"^",4) I $L(%) S %=$O(^ORD(101,"B",%,0)) S:% $P(X0,"^",4)=%
 S $P(^ORD(101,DA(1),10,+Y,0),"^",2,99)=$P(X0,"^",2,99)
 S X1=0 F  S X1=$O(^UTILITY("ORVROM",$J,N,NM,R,10,ORI,X1)) Q:X1=""  I X1'["^" S X0=^UTILITY("ORVROM",$J,N,NM,R,10,ORI,X1),^ORD(101,DA(1),10,+Y,X1)=X0
 Q
MEN S MEN=$S($D(^ORD(101,"B",MEN)):$O(^(MEN,0)),1:"") I 'MEN K ^UTILITY("ORVROM",$J,N,NM,R,"MEN") Q
 S X=NM,X0=OMEN,DIC="^ORD(101,"_MEN_",10,",DIC(0)="L",DA(1)=MEN S:'$D(^ORD(101,DA(1),10,0)) ^(0)="^101.01PA^^"
 S DIC("DR")="2///"_$P(X0,"^",2)_";3///"_$P(X0,"^",3)_";4///"_$P(X0,"^",4)_";5///"_$P(X0,"^",5)_";6///"_$P(X0,"^",6),DLAYGO=101 D ^DIC
 I $P(Y,"^",3) W !?2,X_" added as item to "_$P(^ORD(101,DA(1),0),"^")_"."
 Q

DVBAONIT
DVBAONIT ; ; 10-APR-1995
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K DIF,DIK,DDF,DDT,DTO,D0,DLAYGO,DIC,DIR,DA,ORVROM,DFR,DTN,DIX,DZ
 S DIFQ=0,ORVROM=22 W !!,"This version of 'DVBAONIT' was created on 10-APR-1995"
 W !?9,"(at ALBANY CAMPUS DEVELOPMENT, by OE/RR V.2.5)",!
 G Q:DIFQ D ^DVBAONI1 G Q:'$D(DIFQ) S DIK(0)="B"
 D ^DVBAONI2,^DVBAONI3
 L  W !,*7,"OK, Protocol Installation is Complete.",!
 K %ZW,%,%H,D0,DA,DIF,DIFQ,DIG,DIH,DIK,DIU,DIV,DSEC,I,J,KEY,DIY,N,NM,NO,ORVROM,R,X,X0
 Q
 ;
Q W *7,!!,"NO UPDATING HAS OCCURRED!" Q
 ;
IXF ;;DVBA

DVBAORPH
DVBAORPH ;ALB/JLU;updates the exam exceptions;2/18/94
 ;;2.7;AMIE;;Apr 10, 1995
EN S CTR=0
 S VAR=" - Updating the Exam Exceptions file."
 F LP=1:1:2 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 W !!,VAR
 F LP=1:1:9 S LP1=$T(TXT+LP) Q:LP1=""  DO
 .K JSTOP
 .D CH
 .I $D(JSTOP) Q
 .S X=$P(LP1,";",4)
 .S DIC("DR")=".02///"_$P(LP1,";",3)_";.03////"_$P(LP1,";",5)
 .S DIC="^DVB(396.93,"
 .S DIC(0)="ELMZ",DLAYGO=396.93
 .K DO,DD
 .D FILE^DICN
 .K DLAYGO
 .I +Y W "." S CTR=CTR+1
 .I Y<0 D ERR
 .K Y,DIC,DD,DO,X
 .Q
 S V1="Update of Exam Exceptions file has completed.  "_CTR_" were updated."
 W !,V1
 D BUMP^DVBAPOST(V1)
 K V1,LP,LP1,CTR
 Q
 ;
CH ;checks for the existance of the amie worksheet/exams and for 
 ;duplicates in 396.93
 I $D(^DVB(396.93,"B",$E($P(LP1,";",4),1,30))) D STUFF S JSTOP=1 Q  ;orphan exam
 I '$D(^DVB(396.6,"B",$E($P(LP1,";",3),1,30))) DO  ;worksheet
 .S JSTOP=1
 .S V1="'"_$P(LP1,";",3)_"' is not a valid exam in the AMIE Exam file.  "_$P(LP1,";",4)_" Exam exception not added."
 .W !!,V1
 .D BUMP^DVBAPOST(V1)
 .Q
 Q
 ;
STUFF ;will write over lookup entrie if orphan exists
 S DA=$O(^DVB(396.93,"B",$E($P(LP1,";",4),1,30),""))
 Q:'$D(^DVB(396.93,DA,0))
 S DIE="^DVB(396.93,",DR=".02///"_$P(LP1,";",3)_";.03////"_$P(LP1,";",5)
 D ^DIE
 W "." S CTR=CTR+1
 Q
 ;
ERR ;writes an error when the addition fails.
 S V1="Addition of exam exception "_$P(LP1,";",4)_" has failed.  Please consult install guide."
 D BUMP^DVBAPOST(V1)
 Q
 ;
TXT ;worksheet names;exam name;reference
 ;;GENERAL MEDICAL;GENERAL MEDICAL;GENERAL WITHIN2L MEDICAL
 ;;PRISONER OF WAR;FORMER PRISONER OF WAR, GENERAL MEDICAL;FORMER WITHIN2L GENERAL
 ;;PRISONER OF WAR;FORMER PRISONER OF WAR, MENTAL DISORDERS;FORMER WITHIN2L MENTAL
 ;;AGENT ORANGE;AGENT ORANGE;AGENT WITHIN2L ORANGE
 ;;AID AND ATTENDANCE/HOUSEBOUND;REGULAR AID AND ATTENDANCE OR HOUSEBOUND STATUS;REGULAR WITHIN2L ATTENDANCE
 ;;HIGHER LEVEL AID AND ATTENDANC;HIGHER LEVEL AID AND ATTENDANCE;HIGHER WITHIN2L ATTENDANCE
 ;;GENERAL MEDICAL;IONIZING RADIATION;IONIZING WITHIN2L AMIE
 ;;GENERAL MEDICAL;PERSIAN GULF;PERSIAN WITHIN2L AMIE
 ;;GENERAL MEDICAL;SEXUAL ASSAULT;SEXUAL WITHIN1L ASSAULT

DVBAPADD
DVBAPADD ;ALB/JLU;adds new disability codes to file 31
 ;;2.7;AMIE;;Apr 10, 1995
EN ;start of routine
 I +$$VERSION^DVBAPST1>2.59 DO  Q
 .S VAR=" - Version 2.6 of AMIE has already been loaded."
 .D BUMPBLK^DVBAPOST
 .D BUMPBLK^DVBAPOST
 .D BUMP^DVBAPOST(VAR)
 .W !!,VAR
 .S VAR="There is no need to update the Disability Condition file."
 .D BUMP^DVBAPOST(VAR)
 .W !,VAR,!
 .D BUMPBLK^DVBAPOST
 .Q
 S JCNT=0
 N LP,LP1
 S VAR="Adding to the Disability Condition file."
 W !!,VAR,!
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
 F LP=1:1 S LP1=$T(TXT+LP) Q:LP1=""  DO
 .S DCODE=$P(LP1,";;",2)
 .S DTEXT=$P(DCODE,";",2)
 .S DCODE=$P(DCODE,";",1)
 .I $L(DTEXT)>45 S DTEXT=$E(DTEXT,1,45)
 .K JSTOP
 .D CHK
 .I $D(JSTOP) Q
 .S DIC="^DIC(31,",DIC("DR")="2///"_DCODE,X=DTEXT,DLAYGO=31,DIC(0)="L"
 .K DD,DO
 .D FILE^DICN
 .K DO,DD,DLAYGO
 .I +Y>0 S JCNT=JCNT+1 W "."
 .I +Y<0 D ERR
 .Q
 S VAR="Additions to the Disability Condition file (31) has finished.  "_JCNT_" were added."
 W !!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 K DIC,JSTOP,JCNT,DLAYGO,X,DCODE,DTEXT
 Q
 ;
CHK ;checks for the existance of the codes in the c cross ref.
 I $D(^DIC(31,"C",DCODE)) S JSTOP=1
 I $D(^DIC(31,"B",$E(DTEXT,1,30))) S JSTOP=1
 I $D(JSTOP) DO
 .S VAR="Disability Condition "_DCODE_" was not added.  Entry already exists."
 .W !,VAR
 .D BUMPBLK^DVBAPOST
 .D BUMP^DVBAPOST(VAR)
 .Q
 Q
 ;
ERR ;not added
 S VAR="Not able to add Disability Condition "_DCODE_".  Consult the Install Guide."
 W !,VAR
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 Q
 ;
TXT ;new exams to be added.
 ;;7532;RENAL TUBULAR DISORDERS
 ;;7533;CYSTIC DISEASES OF THE KIDNEYS
 ;;7534;ATHEROSCLEROTIC RENAL DISEASE
 ;;7535;TOXIC NEUROPATHY
 ;;7536;GLOMERULONEPHRITIS
 ;;7537;INTERSTITIAL NEPHRITIS
 ;;7538;PAPILLARY NECROSIS
 ;;7539;RENAL AMYLOID DISEASE
 ;;7540;DISSEMINATED INTRAVASCULAR COAGULATION WITH RENAL CORTICAL NECROSIS
 ;;7541;RENAL INVOLVEMENT IN DIABETES, SICKLE CELL ANEMIA, SYSTEMIC LUPUS ERYTHEMATOSUS, VASCULITIS OR OTHER SYSTEMIC DISEASE PROCESES
 ;;7542;NEUROGENIC BLADDER
 ;;9914;MAXILLA, LOSS OF MORE THAN HALF
 ;;9915;MAXILLA, LOSS OF HALF OR LESS
 ;;9916;MAXILLA, MALUNION OR NONUNION

DVBAPB1
DVBAPB1 ;ALB/CMM BODY SYSTEM FILE UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Body System ; Exam numbers seperated by ;
 ;
EN ;
 ;;CARDIOVASCULAR;7100;7101;7110;7111;7112;7113;7114;7115;7116;7117;7118;7119;7120;7121;7122;7123;7000;7001;7002;7003;7004;7005;7006;7007;7008;7010;7011;7012;7013;7014;7015;7016;7017
 ;;DENTAL;9900;9901;9902;9903;9904;9905;9906;9907;9908;9909;9911;9912;9913;9914;9915;9916
 ;;DIGESTIVE;7200;7201;7202;7311;7312;7313;7314;7315;7316;7317;7318;7338;7339;7340;7342;7343;7344;7345;7346;7347;7348;7203;7204;7205;7301;7319;7321;7322;7323;7324;7325;7326;7327;7328;7329;7330;7331;7332;7333;7334;7335;7336
 ;;DIGESTIVE;7337;7304;7305;7306;7307;7308;7309;7310
 ;;ENDOCRINE;7909;7913;7904;7905;7907;7908;7911;7900;7901;7902;7903;7908;7910;7912;7914;7915
 ;;GENITOURINARY;7510;7511;7512;7515;7516;7517;7518;7519;7527;7520;7521;7522;7528;7529;7508;7509;7510;7511;7523;7524;7525;7516;7519;7542
 ;;GYNECOLOGICAL;7610;7611;7612;7613;7614;7615;7617;7618;7619;7620;7621;7622;7623;7624;7625;7626;7627
 ;;HEMATOLOGICAL;7700;7701;7702;7703;7704;7705;7706;7707;7714;7709;7710;7711;7712;7713;7715
 ;;MENTAL;9201;9202;9203;9204;9205;9206;9207;9208;9209;9210;9300;9301;9302;9303;9304;9305;9306;9307;9308;9309;9310;9311;9312;9315;9322;9324;9325;9400;9401;9402;9403;9404;9405;9408;9409;9410;9500;9501;9502;9505;9506;9507;9508;9509;9510;9511;9411
 ;;NEPHROLOGICAL;7505;7507;7508;7509;7500;7501;7502;7504;7530;7531;7532;7533;7534;7538;7535;7536;7537;7539;7540;7541
 ;;NEUROLOGICAL;5296;8205;8207;8209;8210;8211;8212;8305;8307;8309;8310;8311;8312;8405;8407;8409;8410;8411;8412;8000;8002;8003;8004;8005;8007;8008;8009;8013;8017;8018;8019;8020;8045;8046
 ;;NEUROLOGICAL;8010;8011;8012;8014;8015;8017;8018;8019;8021;8022;8023;8024;8025;8108;8910;8911;8912;8913;8914;8100;8103;8104;8105;8106;8107;8510;8511;8512;8513;8514;8515;8516;8517
 ;;NEUROLOGICAL;8518;8519;8520;8521;8522;8523;8524;8525;8526;8527;8528;8529;8530;8540;8610;8611;8612;8613;8614;8615;8616;8617;8618;8619;8620;8621;8622;8623;8624;8625;8626;8627;8628
 ;;NEUROLOGICAL;8629;8630;8710;8711;8712;8713;8714;8715;8716;8717;8718;8719;8720;8721;8722;8723;8724;8725;8726;8727;8728;8729;8730
 ;;ORGANS OF SENSE;6200;6201;6202;6203;6204;6205;6206;6207;6208;6209;6210;6211;6260;6516;6517;6518;6519;6520;6501;6502;6504;;6511;6512;6513;6514;6275;6276;6000;6001;6002;6003;6004;6005;6006
 ;;ORGANS OF SENSE;6007;6008;6009;6010;6011;6012;6013;6014;6015;6016;6017;6018;6019;6020;6021;6022;6023;6024;6025;6026;6027;6028;6029;6030;6031;6032;6033;6034;6035;6061;6062;6063;6064;6065;6066;6067;6068;6069
 ;;ORGANS OF SENSE;6070;6071;6072;6073;6074;6075;6076;6077;6078;6079;6080;6081;6090;6091;6092
 ;;ORGANS OF SENSE;6515;6100;6101;6102;6103;6104;6105;6106;6107;6108;6109;6110
 ;;ORTHOPEDIC;5104;5105;5106;5107;5108;5109;5110;5111;5120;5121;5122;5123;5124;5125;5126;5127;5128;5129;5130;5131;5132;5133;5134;5135;5136;5137;5138;5139;5140;5141;5142;5143;5144;5145;5146;5147;5148;5149;5150;5151;5152;5153
 ;;ORTHOPEDIC;5154;5155;5156;5160;5161;5162;5163;5164;5165;5166;5167;5170;5171;5172;5173;5000;5262;5263
 ;;ORTHOPEDIC;5276;5277;5278;5279;5280;5281;5282;5283;5284;5218;5219;5220;5221;5222;5223;5224;5225;5226;5227;5054;5250;5251;5252;5253;5254;5255;5001;5002;5003;5004;5005;5006;5007
 ;;ORTHOPEDIC;5008;5009;5010;5011;5012;5013;5014;5015;5016;5017;5018;5019;5020;5021;5022;5023;5024;5051;5052;5053;5055;5056;5200;5201;5202;5203;5205;5206;5207;5208;5209;5210;5211;5212;5213;5214;5215;5256;5257
 ;;ORTHOPEDIC;5258;5259;5260;5261;5272;5273;5274;5275;5301;5302;5303;5304;5305;5306;5307;5308;5309;5310;5311;5312;5313;5314;5315;5316;5317;5318;5319;5320;5321;5322;5323
 ;;ORTHOPEDIC;5324;5325;5326;5327;5328;5329;5285;5287;5290;5293;7800;7803;7804;7805;5286;5288;5289;5291;5292;5294;5295;5298
 ;;PULMONARY;5297;6800;6801;6802;6803;6804;6805;6806;6807;6808;6809;6810;6811;6812;6813;6814;6815;6816;6817;6818;6819;6820;6821;6501;6502;6504;6510;6511;6512;6513;6514;6515;6516;6517;6518;6519
 ;;PULMONARY;6520;6701;6702;6703;6704;6721;6722;6723;6724;6730;6731;6732;5288;5321;6600;6601;6602;6603
 ;;SKIN;7801;7802;7806;7807;7808;7809;7810;7811;7812;7813;7814;7815;7816;7817;7818;7819
  ;;SYSTEMIC;6300;6301;6302;6304;6305;6306;6307;6308;6309;6310;6311;6313;6314;6315;6316;6317;6318;6350;6351

DVBAPBDY
DVBAPBDY ;ALB/CMM BODY SYSTEM FILE UPDATE ;1/19/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;
 N BDYCNT
 S BDYCNT=0
 D SET
 D LOOP
 D SG1
 D EXIT
 Q
SET N VAR
 S VAR=" - Adding to 2507 Body System File."
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 W !!!,VAR
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
SET1 ;
 S DIF="^TMP($J,""DVBA"",",XCNP=0
 K ^TMP($J,"DVBA")
 F ROU="DVBAPB1" S X=ROU X ^%ZOSF("LOAD") W "."
 K DIF,XCNP,ROU
 Q
LOOP ;
 N LP,LP1
 S LP=0
 F  S LP=$O(^TMP($J,"DVBA",LP)) Q:(LP="")  D
 .K STOP
 .S LINE=^TMP($J,"DVBA",LP,0)
 .I (LINE'[";;")!(LINE[";AMIE;")!(LINE="") Q
 .S BODY=$P(LINE,";",3)
 .D GET
 .I $D(STOP) Q
 .I '$D(^DVB(396.7,BODY,1,0)) S ^DVB(396.7,BODY,1,0)="^396.701P^0^0"
 .F LP1=4:1:999 S X=$P(LINE,";",LP1) Q:X=""  D
 ..K STOP
 ..D CHK
 ..I $D(STOP) Q
 ..K DA
 ..D SETUP
 ..I $D(STOP) Q
 ..K DD,DO
 ..S DLAYGO=396,DIC="^DVB(396.7,"_BODY_",1,",DA(1)=BODY,DIC(0)="LMZ" D FILE^DICN
 ..K DIC,DA,DLAYGO,DD,DO
 ..I Y<0 D SE Q
 ..W:'(LP1#10) "."
 ..S BDYCNT=BDYCNT+1
 Q
GET ;
 K DIC
 S DIC="^DVB(396.7,",X=BODY,DIC(0)="MOZ"
 D ^DIC
 I Y<0 D SE1 S STOP=1 Q
 S BODY=+Y
 Q
SE ;
 N VAR
 S VAR="Could not add code "_X_" to body system "_BODY
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
SE1 ;
 N VAR
 S VAR="Could not find body system "_BODY
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
CHK ;
 N COD,COD1
 S COD=$O(^DIC(31,"C",X,""))
 I COD="" S STOP=1 W !,"Error adding exam "_X Q
 S COD1=$O(^DVB(396.7,BODY,1,"B",COD,""))
 I COD1'="" S STOP=1
 Q
SG1 ;writes and updates the tmp global with the finish
 N LP1,V1
 F LP1=1:1:2 D BUMPBLK^DVBAPOST
 S V1="I have updated "_BDYCNT_" exams to the 2507 Body System File!"
 W !!,V1
 D BUMP^DVBAPOST(V1)
 D BUMPBLK^DVBAPOST
 Q
EXIT ;
 K X,Y,BODY,STOP,LINE,^TMP($J,"DVBA")
 Q
SETUP ;
 S DVBAVAR=$O(^DIC(31,"C",X,""))
 I '$D(^DIC(31,DVBAVAR,0)) D SE2 S STOP=1 Q
 S X=DVBAVAR
 Q
SE2 ;
 N VAR
 S VAR="Zero node of the "_X_" code does not exist.  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q

DVBAPCXR
DVBAPCXR ;ALB/JLU;Utility routine for the post inits;9/15/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
ORPHAN ;
 S DIK="^DVB(396.93,",DIK(1)=".01^ADVB"
 D ENALL^DIK
 Q

DVBAPEND
DVBAPEND ;ALB/GTS-557/THM-PENDING REPORT ; 7/6/90  1:18 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL
TERM D HOME^%ZIS W @IOF,!,"Pending 7131 Report",!!! K NOASK,^TMP($J)
 S DVBADD=^DD("DD"),(RONUM,Y)=0 D SORT^DVBAUTIL G:Y<0 KILL
 D SORTDIV^DVBAPND1 G:Y<0 KILL S %ZIS="Q" D ^%ZIS K %ZIS G:POP KILL
 ;
QUEUE I $D(IO("Q")) S ZTRTN="SETUP^DVBAPEND",ZTIO=ION,ZTDESC="AMIE PENDING REPORT",NOASK=1 F I="DIVNAM","SELDIV","DVBADD","RONUM","RO","NOASK","Y","DIVNUM" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! H 1 G KILL
 ;
SETUP D STM^DVBCUTL4
 S FDT(0)=$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3),(PG,DVBAQUIT)=0
 S HEAD="PENDING REQUEST REPORT FOR "_$P(^DVB(396.1,1,0),U,1)
 S HEAD2=$S(RO="Y":"FOR REGIONAL OFFICE "_RONUM,1:"ALL REGIONAL OFFICES")
 S HEAD2=HEAD2_$S(SELDIV="Y":", FOR DIVISION "_DIVNAM,1:", ALL DIVISIONS")
 S PROCDT="Processed on: "_FDT(0)
 S QQ=1,NODTA=0 U IO D HEADER^DVBAPND1
DATA N REQDTE S REQDTE=""
 S:SELDIV="Y" ADIV=DIVNAM
 F J=0:0 S REQDTE=$O(^DVB(396,"E",REQDTE)) Q:REQDTE=""  F DA=0:0 S DA=$O(^DVB(396,"E",REQDTE,DA)) Q:DA=""  I $D(^DVB(396,DA,1)),($P(^DVB(396,DA,1),U,12)="")  D:SELDIV="N" ADIV D MAKUTL
 S (ADIV,REQDTE)=""
 F L=0:0 S REQDTE=$O(^TMP($J,REQDTE)) Q:REQDTE=""  D LVL2LP
 ;
EXIT I NODTA=0 U IO W *7,"No pending requests found for parameters entered.",!!
 ;
KILL S XRTN=$T(+0)
 D SPM^DVBCUTL4
 K ^TMP("DVBA","ADMIT",$J),^TMP($J),DVBAQUIT,SELDIV,DIVNUM,REQDTE
 K LPCNT1,PATDA,DIVNAM,XJ,XI,GDIVPTR,GDIVNUM,GINSTPT,GDIVNAM,GDIV
 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBAUTIL
 Q
 ;
LVL2LP  ;  ** 2nd level of the 2nd loop in the DATA tag - search ADIV **
 F J=0:0 S ADIV=$O(^TMP($J,REQDTE,ADIV)) Q:ADIV=""  D LPLVL3
 Q
 ;
LPLVL3 ;  **  2nd level of the loop in the LVL2LP tag - search DA **
 F DA=0:0 S DA=$O(^TMP($J,REQDTE,ADIV,DA)) Q:DA=""  D PRINT^DVBAPND1 S:DVBAQUIT=1 ADIV="ZZZZ",DA=999999999,REQDTE=9999999 S QQ=1
 Q
 ;
MAKUTL ;  **  Sort on Request Date to set up a temporary utility global  **
 S REQDTE=$P(^DVB(396,DA,1),"^",1),PATDA=$P(^DVB(396,DA,0),"^",1)
 S CFLOC=$$STATION^DVBAUTL1(PATDA)
 S:CFLOC=-1 CFLOC=0
 I SELDIV="Y"&(RO="Y") I CFLOC=RONUM D CHKDIV D:$D(DVBAFND) SETARY
 I SELDIV="Y"&(RO="N") D CHKDIV D:$D(DVBAFND) SETARY
 I SELDIV="N"&(RO="Y") I CFLOC=RONUM D SETARY
 I SELDIV="N"&(RO="N") D SETARY
 K DVBAFND
 QUIT
 ;
SETARY ;  ** Set temporary utility global **
 S ^TMP($J,REQDTE,ADIV,DA)=""
 QUIT
 ;
ADIV S ADIV=$S($D(^DVB(396,DA,2)):$P(^(2),U,9),1:"") S ADIV=$S($D(^DG(40.8,+ADIV,0)):$P(^(0),U,1),1:"Unknown Division")
 Q
 ;
CHKDIV ;**Check for selected Div
 N FLDVAR
 I $D(^DVB(396,DA,6)) DO
 .F FLDVAR=7,9,11,13,15,17,19,21,23,26,28 Q:$D(DVBAFND)  DO
 ..I ($P(^DVB(396,DA,6),U,FLDVAR)=DIVNUM) DO
 ...I FLDVAR=7 S:$P(^DVB(396,DA,1),U,FLDVAR)="P" DVBAFND=""
 ...I FLDVAR'=7 S:$P(^DVB(396,DA,0),U,FLDVAR)="P" DVBAFND=""
 I $D(^DVB(396,DA,2)),('$D(DVBAFND)) DO  ;**Check Routing Loc Division
 .I $D(^DVB(396,DA,1)) DO
 ..I $P(^DVB(396,DA,2),U,9)=DIVNUM,($P(^DVB(396,DA,1),U,12)="") DO
 ...S DVBAFND=""
 Q

DVBAPK1
DVBAPK1 ;ALB/CMM - AMIE KEYWORD FILE UPDATE ;2/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam number ^ words seperated by ;
 ;
EN ;
 ;;7500^NEPHRECTOMY
 ;;7501^CHRONIC KIDNEY INFECTION
 ;;7502^CHRONIC KIDNEY INFECTION
 ;;7504^TB OF KIDNEY;RENAL TB;POTT'S DISEASE OF KIDNEY
 ;;7507^RENAL ARTERY DISEASE
 ;;7508^KIDNEY STONE;STAGHORN CALCULUS
 ;;7510^KIDNEY STONE;URETER STONE;URETER CALCULUS
 ;;7512^BLADDER INFECTION,CHRONIC
 ;;7515^BLADDER STONE
 ;;7522^PEYRONIE'S DISEASE
 ;;7524^ORCHIECTOMY;ORCHIDECTOMY;CASTRATION
 ;;7525^TB OF TESTICLE
 ;;7528^RENAL CARCIONOMA;RENAL CELL CARCINOMA;RCC;NEPHROBLASTOMA;ADULT WILM'S TUMOR
 ;;7529^RENAL ADENOMA;JUXTAGLOMERULAR TUMOR;RENAL ONCOCYTOMA;ANGIOMYOLIPOMA-HAMARTOMA
 ;;7531^RENAL TRANSPLANT
 ;;7532^RENAL GLYCOSURIA;AMINOACIDURIA;RENAL TUBULAR ACIDOSIS;FANCONI'S SYNDROME;BARTTER'S SYNDROME
 ;;7533^POLYCYSTIC KIDNEY;MEDULLARY SPONGE KIDNEY;MEDULLARY CYSTIC DISEASE OF KIDNEY
 ;;7534^RENAL ARTERY STENOSIS;ATHERO EMBOLIC RENAL DISEASE
 ;;7540^DIC
 ;;7541^RENAL DIABETES;SICKLE CELL ANEMIA;SYSTEMIC LUPUS ERYTHEMATOSIS;SLE;VASCULITIS
 ;;7613^ENDOMETRITIS
 ;;7614^TUBAL INFECTION;TUBAL ABSCESS;TUBOOVARIAN ABSCESS
 ;;7615^INFECTED OVARIES;TUBOOVARIAN ABSCESS
 ;;7617^HYSTERECTOMY WITH OOPHORECTOMY AND SALPINGECTOMY;TOTAL HYSTERECTOMY
 ;;7618^HYSTERECTOMY;VAGINAL HYSTERECTOMY
 ;;7619^OOPHORECTOMY
 ;;7623^ECTOPIC PREGNANCY;TUBAL PREGNANCY;OVARIAN PREGANCY;HETEROTOPIC PREGNANCY;CERVICAL PREGNANCY;SPONTANEOUS ABORTION
 ;;7626^MASTECTOMY;RADICAL MASTECTOMY;PARTIAL MASTECTOMY
 ;;7627^CARCINOMA OF THE BREAST;CARCINOMA OF THE CERVIX;CARCINOMA OF UTERUS;CARCINOMA OF OVARY;LEIOMYOSARCOMA OF UTERUS;SARCOMA BOTRYOIDES;SQUAMOUS CELL CARCIONOMA OF VAGINA
 ;;5000^CHRONIC OSTEO;BONE INFECTION
 ;;5001^TB OF BONE;TB OF JOINT;GRANULOMATOUS SYNOVITIS
 ;;5002^RA;RHEUMATOID ARTHRITIS;RHEUMATOID SYNOVITIS
 ;;5003^SEPTIC ARTHRITIS;BACTERIAL ARTHRITIS;JOINT INFECTION
 ;;5004^SEPTIC ARTHRITIS;BACTERIAL ARTHRITIS;JOINT INFECTION
 ;;5005^SEPTIC ARTHRITIS;BACTERIAL ARTHRITIS;JOINT INFECTION
 ;;5006^SEPTIC ARTHRITIS;BACTERIAL ARTHRITIS;JOINT INFECTION
 ;;5007^SEPTIC ARTHRITIS;BACTERIAL ARTHRITIS;JOINT INFECTION
 ;;5008^SEPTIC ARTHRITIS;BACTERIAL ARTHRITIS;JOINT INFECTION
 ;;5009^SEPTIC ARTHRITIS;BACTERIAL ARTHRITIS;JOINT INFECTION;INFLAMMATORY ARTHRITIS;REITER'S SYNDROME;ANKYLOSING SPONDYLITIS;MARIE-STRUMPELL'S DISEASE
 ;;5010^POSTTRAUMATIC ARTHRITIS;DJD;DEGENERATIVE ARTHRITIS;DEGENERATIVE JOINT DISEASE
 ;;5011^BENDS
 ;;5012^OSTEOSARCOMA;CHONDROSARCOMA;FIBROSARCOMA OF BONE;EWING'S SARCOMA;ADAMANTINOMA;METASTIC CARCINOMA
 ;;5014^SOFT BONES;RICKETS
 ;;5015^FIBROUS CORTICAL DEFECT;NON-OSSIFYING FIBROMA;FIBROUS DYSPLASIA;OSTEOCHONDROMA;CHONDROMA;CHONDROBLASTOMA;OSTEOID OSTEOMA;OSTEOBLASTOMA;GIANT CELL TUMOR;EOSINOPHILIC GRANULOMA;ANEURYSMAL BONE CYST
 ;;5016^PAGET'S DISEASE
 ;;5017^PODAGRA;HYPERUREMIA;TOPHACEOUS GOUT
 ;;5018^WATER ON THE KNEE;JOINT EFFUSION
 ;;5051^TOTAL SHOULDER
 ;;5052^TOTAL ELBOW
 ;;5053^TOTAL WRIST
 ;;5054^TOTAL HIP;THA;THR
 ;;5055^TOTAL KNEE;TKA;THR
 ;;5056^TOTAL ANKLE

DVBAPK2
DVBAPK2 ;ALB/CMM - AMIE KEY WORD FILE UPDATE ;2/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam number ^ words sperated by ;
 ;
EN ;
 ;;5150^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5151^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5152^SINGLE FINGER AMPUTATION;SINGLE DIGIT AMPUTATION;PARTIAL HAND AMPUTATION
 ;;5153^SINGLE FINGER AMPUTATION;SINGLE DIGIT AMPUTATION;PARTIAL HAND AMPUTATION
 ;;5154^SINGLE FINGER AMPUTATION;SINGLE DIGIT AMPUTATION;PARTIAL HAND AMPUTATION
 ;;5155^SINGLE FINGER AMPUTATION;SINGLE DIGIT AMPUTATION;PARTIAL HAND AMPUTATION
 ;;5156^SINGLE FINGER AMPUTATION;SINGLE DIGIT AMPUTATION;PARTIAL HAND AMPUTATION
 ;;5160^HIP DISARTICULATION
 ;;5161^ABOVE KNEE AMPUTATION;AK AMPUTATION;AKA
 ;;5162^ABOVE KNEE AMPUTATION;AK AMPUTATION;AKA
 ;;5163^BELOW KNEE AMPUTATION;BK AMPUTATION;BKA
 ;;5164^BELOW KNEE AMPUTATION;BK AMPUTATION;BKA
 ;;5165^BELOW KNEE AMPUTATION;BK AMPUTATION;BKA
 ;;5166^HIND FOOT AMPUTATION;CHOPART'S AMPUTATION;LISFRANC AMPUTATION
 ;;5170^TRANSMETATARSAL AMPUTATION;TRANSMET AMP;TOE DISARTICULATION
 ;;5171^HALLUX AMPUTATION;BIG TOE AMPUTATION
 ;;5200^SHOULDER FUSION
 ;;5201^FROZEN SHOULDER
 ;;5202^FLAIL SHOULDER;NON-UNION HUMERUS FRACTURE;FIBROUS UNION HUMER FRACTURE;MALUNION HUMERUS FRACTURE;UNSTABLE SHOULDER;CHRONIC DISLOCATION OF SHOULDER
 ;;5203^DISLOCATED CLAVICLE;DISLOCATED AC JOINT;DISLOCATED SC JOINT;NON-UNION OF CLAVICLE;MALUNION OF CLAVICLE
 ;;5205^ELBOW FUSION
 ;;5206^LIMITED ELBOW MOTION
 ;;5207^LIMITED ELBOW MOTION
 ;;5208^LIMITED ELBOW MOTION
 ;;5210^FRACTURE BOTH BONES OF FOREARM
 ;;5211^MALUNION FOREARM FRACTURE;NON-UNION FOREARM FRACTURE
 ;;5212^MALUNION FOREARM FRACTURE;NON-UNION FOREARM FRACTURE
 ;;5213^LOSS OF FOREARM ROTATION
 ;;5214^FUSED WRIST
 ;;5215^FROZEN WRIST;STIFF WRIST
 ;;5216^FROZEN FINGERS;STIFF FINGERS
 ;;5217^FROZEN FINGERS;STIFF FINGERS
 ;;5218^FROZEN FINGERS;STIFF FINGERS
 ;;5219^FROZEN FINGERS;STIFF FINGERS
 ;;5220^FROZEN FINGERS;STIFF FINGERS
 ;;5221^FROZEN FINGERS;STIFF FINGERS
 ;;5222^FROZEN FINGERS;STIFF FINGERS
 ;;5223^FROZEN FINGERS;STIFF FINGERS
 ;;5224^FROZEN FINGER;STIFF FINGER
 ;;5225^FROZEN FINGER;STIFF FINGER
 ;;5226^FROZEN FINGER;STIFF FINGER
 ;;5227^FROZEN FINGER;STIFF FINGER
 ;;5250^FUSED HIP;HIP FUSION
 ;;5251^STIFF HIP;LIMITED HIP MOTION
 ;;5252^STIFF HIP;LIMITED HIP MOTION
 ;;5253^STIFF HIP;LIMITED HIP MOTION
 ;;5255^NON-UNION OF FEMUR;MALUNION OF FEMUR;AVASCULAR NECROSIS OF FEMORAL HEAD;AVN
 ;;5256^KNEE FUSION;FUSED KNEE
 ;;5257^TORN ACL;TORN PCL;TORN MEDIAL COLLATERAL LIGAMENT;TORN LATERAL COLLATERAL LIGAMENT;TORN ANTERIOR CRUCIATE;TORN POSTERIOR CRUCIATE;UNSTABLE KNEE
 ;;5258^TORN CARTILAGE;TORN MENISCUS
 ;;5259^TORN CARTILAGE;TORN MENISCUS
 ;;5260^EXTENSION CONTRACTURE OF KNEE;LOSS OF KNEE MOTION
 ;;5261^FLEXION CONTRACTURE OF KNEE;LOSS OF KNEE MOTION
 ;;5262^FRACTURED TIBIA;MALUNION OF TIBIA;NON-UNION OF TIBIA;DELAYED UNION OF TIBIA

DVBAPK3
DVBAPK3 ;ALB/CMM - AMIE KEY WORD FILE UPDATE ;2/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam number ^ words sperated by ;
 ;
EN ;
 ;;5270^FUSED ANKLE;ANKLE FUSION
 ;;5272^SUB-TALAR FUSION
 ;;5273^FRACTURED CALCANEUS;FRACTURED TALUS;HIND FOOT FRACTURE
 ;;5274^TALECTOMY
 ;;5275^LEG LENGTH DISCREPANCY;SHORT LEG;LEG LENGTH INEQUALITY
 ;;5279^MORTON'S NEUROMA
 ;;5280^BUNION
 ;;5281^FROZEN BIG TOE;FROZEN GREAT TOE
 ;;5286^MARIE-STRUMPELL DISEASE;ANKYLOSING SPONDYLITIS;DISH;DISSEMINATED IDEOPATHIC SKELETAL HYPEROSTOSIS;FUSED SPINE;BECHTEREW'S DISEASE;SPONDYLITIS DEFORMANS
 ;;5287^MARIE-STRUMPELL DISEASE;ANKYLOSING SPONDYLITIS;DISH;DISSEMINATED IDEOPATHIC SKELETAL HYPEROSTOSIS;FUSED SPINE;BECHTEREW'S DISEASE;SPONDYLITIS DEFORMANS
 ;;5288^MARIE-STRUMPELL DISEASE;ANKYLOSING SPONDYLITIS;DISH;DISSEMINATED IDEOPATHIC SKELETAL HYPEROSTOSIS;FUSED SPINE;BECHTEREW'S DISEASE;SPONDYLITIS DEFORMANS
 ;;5289^MARIE-STRUMPELL DISEASE;ANKYLOSING SPONDYLITIS;DISH;DISSEMINATED IDEOPATHIC SKELETAL HYPEROSTOSIS;FUSED SPINE;BECHTEREW'S DISEASE;SPONDYLITIS DEFORMANS
 ;;5290^MARIE-STRUMPELL DISEASE;ANKYLOSING SPONDYLITIS;DISH;DISSEMINATED IDEOPATHIC SKELETAL HYPEROSTOSIS;FUSED SPINE;BECHTEREW'S DISEASE;SPONDYLITIS DEFORMANS
 ;;5291^MARIE-STRUMPELL DISEASE;ANKYLOSING SPONDYLITIS;DISH;DISSEMINATED IDEOPATHIC SKELETAL HYPEROSTOSIS;FUSED SPINE;BECHTEREW'S DISEASE;SPONDYLITIS DEFORMANS
 ;;5292^MARIE-STRUMPELL DISEASE;ANKYLOSING SPONDYLITIS;DISH;DISSEMINATED IDEOPATHIC SKELETAL HYPEROSTOSIS;FUSED SPINE;BECHTEREW'S DISEASE;SPONDYLITIS DEFORMANS
 ;;5293^HERNIATED DISC;DEGENERATIVE DISC DISEASE;HNP;HERNIATED NUCLEUS PULPOSIS;LAMINECTOMY;DISCECTOMY
 ;;5294^S.I. JOINT ARTHRITIS;ANKYLOSING SPONDYLITIS
 ;;5295^CHRONIC LUMBAR STRAIN
 ;;5301^WEAK SHOULDER,PARALYZED SHOULDER;MUSCLE LOSS OF SHOULDER
 ;;5302^WEAK SHOULDER,PARALYZED SHOULDER;MUSCLE LOSS OF SHOULDER
 ;;5303^WEAK SHOULDER,PARALYZED SHOULDER;MUSCLE LOSS OF SHOULDER
 ;;5304^WEAK SHOULDER,PARALYZED SHOULDER;MUSCLE LOSS OF SHOULDER
 ;;5305^WEAK ELBOW;PARALYZED ELBOW;MUSCLE LOSS OF ELBOW
 ;;5306^WEAK ELBOW;PARALYZED ELBOW;MUSCLE LOSS OF ELBOW
 ;;5307^WEAK WRIST FLEXORS;WEAK LONG FLEXORS OF HAND
 ;;5308^WEAK WRIST EXTENSORS;WEAK LONG EXTENSORS FINGERS
 ;;5309^WEAK HAND MUSCLES;WEAK THUMB INTRINSICS
 ;;5311^WEAK PLANTAR FLEXORS;WEAK FOOT EVERTERS;GASTROC WEAKNESS
 ;;5312^WEAK ANKLE DORSIFLEXORS;WEAK LONG TOE EXTENSORS;WEAK FOOT INVERTORS
 ;;5313^WEAK HAMSTRINGS;WEAK KNEE FLEXORS
 ;;5314^WEAK QUADRICEPS;WEAK QUADS;WEAK KNEE EXTENSORS
 ;;5315^WEAK ADDUCTORS;WEAK HIP ADDUCTORS
 ;;5316^WEAK HIP FLEXORS;WEAK ILIO-PSOAS
 ;;5317^WEAK ABDUCTORS;WEAK GLUTEUS;WEAK HIP EXTENSORS
 ;;5318^WEAK HIP EXTERNAL ROTATORS
 ;;5322^WEAK NECK FLEXORS;WEAK NECK ROTATORS;WEAK SWALLOWING MOTORS;WEAK DEGLUTITION
 ;;5323^WEAK NECK EXTENSORS
 ;;5327^FIBROSARCOMA;LIPOSARCOMA;KAPOSI'S SARCOMA;ANGIOSARCOMA;LEIOMYOSARCOMA;MYOSARCOMA;RHABDOMYOSARCOMA

DVBAPK4
DVBAPK4 ;ALB/CMM - AMIE KEYWORD FILE UPDATE #1 ;2/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam number ^ words seperated by ;
 ;
EN ;
 ;;5104^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5105^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5106^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5107^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5108^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5109^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5110^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5111^COMBINED LOSSES;MULTIPLE EXTREMITY LOSSES
 ;;5120^ABOVE ELBOW AMPUTATION;AE AMPUTATION
 ;;5121^ABOVE ELBOW AMPUTATION;AE AMPUTATION
 ;;5122^ABOVE ELBOW AMPUTATION;AE AMPUTATION
 ;;5123^ELBOW DISARTICULATION;BELOW ELBOW AMPUTATION;BE AMPUTATION
 ;;5124^BELOW ELBOW AMPUTATION;BE AMPUTATION
 ;;5125^BELOW ELBOW AMPUTATION;BE AMPUTATION
 ;;5126^BELOW ELBOW AMPUTATION;BE AMPUTATION
 ;;5127^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5128^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5129^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5130^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5131^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5132^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5133^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5134^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5135^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5136^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5137^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5138^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5139^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5140^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5141^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5142^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5143^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5144^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5145^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5146^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5147^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5148^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION
 ;;5149^MULTIPLE FINGER AMPUTATIONS;PARTIAL HAND AMPUTATION;MULTIPLE DIGIT AMPUTATION

DVBAPK5
DVBAPK5 ;ALB/CMM - AMIE KEYWORD FILE UPDATE #1 ;2/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam number ^ words seperated by ;
 ;
EN ;
 ;;7007^LEFT VENTRICULAR HYPERTROPHY;LVH;HYPERTENSIVE HEART DISEASE;CONCENTRIC HYPERTROPHY
 ;;7010^MULTIFOCAL ATRIAL TACHYCARDIA;SINUS BRADYCARDIA;PREMATURE ATRIAL CONTRACTIONS;PACS;ATRIAL PREMATURE SYSTOLES;APBS;ATRIAL FLUTTER;WOLFF-PARKINSON-WHITE;WPW;SUPRAVENTRICULAR ARRHYTHMIAS;SVT;ATRIAL ARRHYTHMIA
 ;;7011^VENTRICULAR TACHYCARDIA;V TACH;VENTRICULAR FIBRILLATION;V FIB;ACCELERATED VENTRICULAR RHYTHM;VENTRICULAR FLUTTER;VENTRICULAR PARASYSTOLE;TORSADE DES POINTES;TORSADE;VENTRICULAR ARRHYTHMIAS
 ;;7000^MITRAL VALVE DISEASE;MITRAL STENOSIS;MITRAL REGURGITATION;MITRAL VALVE PROLAPSE;BARLOW SYNDROME;AORTIC VALVE DISEASE;AORTIC STENOSIS;RHEUMATIC HEART DISEASE;VALVULAR HEART DISEASE
 ;;7000^AORTIC REGURGITATION;TRICUSPID VALVE DISEASE;TRISCUSPID STENOSIS;TRICUSPID REGURGITATION;IHSS;IDIOPATHIC HYPERTROPHIC SUBAORTIC STENOSIS;HYPERTROPHIC CARDIOMYOPATHY;HYPERTROPH
 ;;7001^MARANTIC ENDOCARDITIS;ACUTE RHEUMATIC FEVER;LIBMAN SACKS;ENDOCARDITIS;SBE;SUBACUTE BACTERIAL ENDOCARDITIS;ABE;ACUTE BACTERIAL ENDOCARDITIS;INFECTIVE ENDOCARDITIS
 ;;7002^CHYLOPERICARDIUM;HEMOPERICARDIUM;PNEUMOPERICARDIUM;PERICARDITIS;PERICARDIAL EFFUSION;TAMPONADE
 ;;7015^FIRST DEGREE AV BLOCK;SECOND DEGREE AV BLOCK;THIRD DEGREE AV BLOCK;COMPLETE HEART BLOCK;WENCKEBACH;ATRIOVENTRICULAR BLOCK;AV BLOCK
 ;;7114^PERIPHERAL VASCULAR DISEASE;PVD;OCCLUSIVE ARTERIAL DISEASE;LERICHE SYNDROME;AORTOILIAC OCCLSIVE DISEASE;ARTERIOSCLEROSIS OBLITERANS
 ;;7117^VASOSPASTIC DISEASE;VASOSPASTIC COLD SENSITIVITY;ACROCYANOSIS;RAYNAUD'S DISEASE;RAYNAUD'S PHENOMENON
 ;;7118^URTICARIA;ANGIONEUROTIC EDEMA
 ;;7120^POSTPHLEBITIS SYNDROME;VARICOSE VEINS;VARICOSITIES
 ;;7122^CHILBLAIN;ERYTHROCYANOSIS;FROSTBITE;FROZEN FEET;IMMERSION FOOT;TRENCH FOOT
 ;;7123^ANGIOMA;HEMANGIOMA;CAPILLARY HEMANGIOMA;CAVERNOUS HEMANGIOMA;SCLEROSING HEMANGIOMA;HEMANGIOPERICYTOMA;CAROTID BODY TUMOR;HEMANGIOENDOTHELIOMA;HEMANGIOENDOTHELIOSARCOMA;KAPOSI'S SARCOMA;SARCOMA (VASCULAR)
 ;;7203^LOWER ESOPHAGEAL RING;SCLERODERMAL ESOPHAGITIS;SCHATZKI'S RING;ESOPHAGEAL STRICTURE;BENIGN ESOPHAGEAL STRICTURE
 ;;7204^ACHALASIA;ESOPHAGEAL SPASM
 ;;7301^PERITONITIS;PANNICULITIS;MESENTERITIS;PERITONEUM, ADHESIONS;PERITONEAL ADHESIONS
 ;;7305^PEPTIC ULCER DISEASE;ZOLLINGER-ELLISON SYNDROME;DUODENAL ULCER
 ;;7312^WILSON'S CIRRHOSIS;HEMOCHROMATOSIS;BILIARY CIRRHOSIS;CHRONIC ACTIVE HEPATITIS;HEPATIC VEIN OCCLUSION;BUDD-CHIARI SYNDROME;LIVER CIRRHOSIS;MICRONODULAR CIRRHOSIS;MACRONODULAR CIRRHOSIS
 ;;7312^POSTNECROTIC CIRRHOSIS;PORTAL CIRRHOSIS;ALCOHOLIC CIRRHOSIS;LAENNEC'S CIRRHOSIS
 ;;7313^AMEBIC ABSCESS;PYOGENIC LIVER ABSCESS;LIVER ABCESS
 ;;7315^GALLSTONE ILCUS;CHOLELITHIASIS;CHOLODOCHOLITHIASIS;GALLSTONES
 ;;7316^BILIARY CIRRHOSIS;CHOLANGITIS
 ;;7318^POST-CHOLECYSTECTOMY SYNDROME;GALL BLADDER, REMOVAL;CHOLECYSTECTOMY
 ;;7319^MUCUS COLITIS;SPASTIC COLITIS;IRRITABLE COLON;IRRITABLE BOWEL;IBS
 ;;7322^INFECTIOUS COLITIS;TOXIC COLITIS;DYSENTERY, BACILLARY;SHIGELLOSIS
 ;;7323^PROCTOCOLITIS;ULCERATIVE COLITIS;CROHN'S DISEASE;INFLAMMATORY BOWEL DISEASE;REGIONAL ENTERITIS
 ;;7325^EOSPHAGITIS;GASTRITIS;DUODENITIS;JEJEUNITIS;ELEITIS;CELIAC SPRUE;TROPICAL SPRUE;WHIPPLE'S DISEASE;EOSINOPHILIC GASTROENTERITIS;IL;ENTERITIS
 ;;7326^MEGACOLON;ENTEROCOLITIS
 ;;7343^ESOPHAGEAL CARCINOMA;ESOPHAGEAL SARCOMA;GASTRIC CARCINOMA;CARCINOID;ARGENTAFFINOMA;GASTRIC SARCOMA;SMALL BOWEL CARCINOMA;SMALL BOWEL LYMPHOMA;SMALL BOWEL SARCOMA;COLON CARCINOMA;SQUAMOUS CELL CARCINOMA OF ANUS
 ;;7343^COLON SARCOMA;MELANOCARCINOMA;PERITONEAL MESOTHELIOMA;HEPATOCARCINOMA;CHOLANGIOCARCINOMA;CARCINOMA OF AMPULLA OF VATER;PANCREATIC CARCINOMA;NEW GROWTHS, MALIGNANT
 ;;7344^LEIOMYOMA;STOMACH ADENOMA;SMALL BOWEL POLYP;PEDUNCULATED ADENOMA;VILLOUS ADENOMA;SESSILE ADENOMA;HEREDOFAMILIAL POLYPOSIS;CAVERNOUS HEMANGIOMA;HAMARTOMA;PAPILLOMA;PANCREATIC CYST;NEW GROWTHS, BENIGN
 ;;7346^BARRETT'S ESOPHAGOS;HERNIA, HIATAL;GERD;GASTROESOPHAGEAL REFLUX;HEARTBURN;DYSPEPSIA

DVBAPK6
DVBAPK6 ;ALB/GTS - AMIE KEYWORD FILE UPDATE #1 ;2/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam number ^ words seperated by ;
 ;
EN ;
 ;;7005^ARTERIOSCLEROSTIC HEART DISEASE;ASCVD;ASHD;CORONARY HEART DISEASE;CAD;ANGINA;ANGINA PECTORIS;ISCHEMIC HEART DISEASE;MYOCARDIAL ISCHEMIA
 ;;7006^MYOCARDIAL INFARCTION;MI;ACUTE MYOCARDIAL INFARCTION;AMI;CORONARY THROMBOSIS
 ;;7008^HYPERTHYROID HEART DISEASE
 ;;7003^ADHESIONS, PERICARDIAL;CONSTRICTIVE PERICARDITIS
 ;;7004^SYPHILITIC HEART DISEASE
 ;;7012^AURICULAR FIBRILLATION;ATRIAL FIBRILLATION;A FIB
 ;;7013^TACHYCARDIA, PAROXYSMAL
 ;;7014^SINUS TACHYCARDIA;SINUS TACH
 ;;7016^HEART VALVE REPLACEMENT
 ;;7017^CORONARY ARTERY BYPASS;CABG
 ;;7100^ARTERIOSCLEROSIS;ATHERSCLEROSIS
 ;;7101^HYPERTENSIVE VASCULAR DISEASE;HYPERTENSION;HTN
 ;;7110^ANEURYSM, AORTIC;AAA;AORTIC ANEURYSM
 ;;7111^ARTERY, ANEURYSM
 ;;7112^ARTERY, ANEURYSM
 ;;7113^ARTERIOVENOUS ANEURYSM;AV ANEURYSM;AV MALFORMATION;AVM;AV FISTULA;FISTULA
 ;;7115^THROMBOANGLITIS;BUERGER'S DISEASE
 ;;7116^CLAUDICATION
 ;;7119^ERYTHROMELALGIA
 ;;7202^TONGUE, LOSS
 ;;7205^ESOPHAGEAL DIVERTICULUM
 ;;7304^GASTRIC ULCER
 ;;7306^ULCER, MARGINAL
 ;;7307^GASTRITIS HYPERTROPHIC;MENETRIER'S DISEASE
 ;;7308^POSTGASTRECTOMY SYNDROME;DUMPING SYNDROME
 ;;7309^STOMACH, STENOSIS;PYLORIC OBSTRUCTION
 ;;7311^LIVER INJURY
 ;;7314^CHOLECYSTITIS;CHOLEDOCHOCYSTITIS;BILIARY COLIC
 ;;7317^GALL BLADDER INJURY
 ;;7321^AMEBIASIS
 ;;7327^DIVERTICULITIS;DIVERTICULOSIS
 ;;7328^INTESTINE, SMALL, RESECTION
 ;;7329^INTESTINE, LARGE RESECTION;COLECTOMY
 ;;7330^INTESTINE, FISTULA
 ;;7331^PERITONITIS, TUBERCULOUS
 ;;7332^RECTUM & ANUS, SPHINCTER
 ;;7333^RECTUM & ANUS, STRICTURE
 ;;7334^RECTUM, PROLAPSED
 ;;7336^HEMORRHOIDS
 ;;7337^PRURITIS ANI
 ;;7338^HERNIA, INGUINAL
 ;;7339^HERNIA, VENTRAL
 ;;7340^HERNIA, FEMORAL
 ;;7345^HEPATITIS, INFECTIOUS;VIRAL HEPATITIS;HEPATITIS A;HEPATITIS B;HEPATITIS C;NON-A, NON-B HEPATITIS
 ;;7347^PANCREATITIS;ACUTE PANCREATITIS;CHRONIC PANCREATITIS
 ;;7348^VAGOTOMY
 ;;7121^PHLEBITIS;THROMBOPHLEBITIS;PHLEBOTHROMBOSIS;SUPERFICIAL PHLEBITIS;DEEP VEIN PHLEBITIS

DVBAPK7
DVBAPK7 ;ALB/CMM KEYWORD DATA ROUTINE ;3/29/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;The format is exam number ^ keyword seperated by ;
 ;
EN ;
 ;;8000^HERPES ENCEPHALITIS;RABIES;ENCEPHALITIS
 ;;8002^GLIOMA;OLIGODENDROGLIA;GLIOBIASTOMA MULTIFORME;LYMPHOMA;ANAPLASTIC ASTROCYTOMA;METSTATIC TUMORS;MALIGNANT BRAIN TUMOR
 ;;8003^ACOUSTIC NEUROMA;DERMOID;CHORDOMA;BENIGN BRAIN TUMOR
 ;;8004^PARALYSIS AGITANS
 ;;8005^LACUNAR STATE;BULBAR PALSY
 ;;8007^CARDIOGENIC STROKE;EMBOLIC CVA
 ;;8008^LACUNAR INFARCT;THROMBOTIC CVA
 ;;8009^SUBARACHNOID HEMORRHAGE;SAH;HEMORRBAGIC INFARCT;INTRACEREBRAL HEMORRAHE;ICH;HEMORRHAGIC CVA
 ;;8010^LCM;CHORIOMENINGITIS;HERPES ZOSTER;MYELITIS
 ;;8011^POST-POLIO SYNDROME
 ;;8012^HEMATOMYELITIS
 ;;8013^NEUROSYPHILIS;CSF SYPHILIS
 ;;8014^NEUROSYPHILIS;MENINGOVASC SYPHILIS
 ;;8015^NEUROSYPHILIS;TABES DORSALIS
 ;;8017^MOTOR NEURON DISEASE
 ;;8019^MENGITIS, EPIDEMIC
 ;;8020^CEREBRITIS;CEREBRAL TUBERCULOSIS;COCCIDIOMYCOSIS;HISTOPLASMOSIS;MUCORMYCOSIS;BLASTOMYCOSIS;TOXOPLASMOSIS;BRAIN ABSCESS
 ;;8021^INTRAMEDULLARY GLIOMA;HEMANGIOMA;METASTATIC TUMOR;SC MALIGNANT TUMOR
 ;;8022^MENINGIOMA;EPENDYMOMA;SC BENIGN TUMOR
 ;;8023^PROGRESS MUSC ATROPHY
 ;;8024^SYRINX;CAVITATION;HYDROMYELIA;SYRINGOMYELIA
 ;;8025^MG;MYESTHENIA;MYESTHENIA GRAVIS;OCULAR MYESTHENIA;MYESTHENIA
 ;;8045^CONCUSSION;CONTUSION;SUBDURAL HEMATOMA;EPIDURAL HEMATOMA;TRAUMATIC ENCEPHALOPATHY;BRAIN TRAUMA
 ;;8046^LACUNAR INFARCT;CAROTID SIPHON DISEASE;CEREBRAL ARTERIOSCLEROSIS
 ;;8100^MIGRAINES
 ;;8103^TIC CONVULSIVE
 ;;8104^SEIZURE;MYOCLONIC EPILEPSY
 ;;8106^RHEUMATIC FEVER;CHOREA MINOR;CHOREA SYDENHAM'S
 ;;8107^HD;HUNTINGTON'S DISEASE;CHOREA;CHOREA HUNTINGTON'S;CHOREA MAJOR
 ;;8108^NARCOLEPSY
 ;;8540^SLEEP ATTACKS;NEUROGENIC SARCOMA
 ;;8910^SEIZURE;TONIC-CLONIC;GM EPILEPSY
 ;;8911^SEIZURE;ABSENCE;PM EPILEPSY
 ;;8912^SEIZURE;SENSORY SEIZURE;PARTIAL SEIZURE;JACKSONIAN EPILEPSY
 ;;8913^SEIZURE;DIENCEPHALIC EPILEPSY
 ;;8914^SEIZURE;COMPLEX PARTIAL SEIZURE;PSYCHOMOTOR EPILEPSY
 ;;7800^ROSACEA;SCARS, DISFIGURING
 ;;7801^SCARS, THIRD DEGREE
 ;;7802^SCARS, SECOND DEGREE
 ;;7803^SCARS, SUPERFICIAL
 ;;7805^VITILIGO;KELOID;SCLERODERMA;MORPHEA;SCARS OTHERS
 ;;7806^ATOPY;ATOPIC DERMATITIS;CONTACT DERMATITIS;DYSHYROSIS;ERYTHEMA MULTIFORME;DRUG ERUPTION;FIXED DRUG ERUPTION;PHOTODERMATITIS;POISON IVY;RHUS DERMATITIS;RADIATION DERMATITIS;XEROSIS;ECZEMA
 ;;7807^LEISHMANIASIS AMERICANA
 ;;7808^LEISHMANIASIS OLD WORLD
 ;;7809^DISCOID LUPUS;DLE
 ;;7810^SYPHILIS;CHANCROID;LEPROSY;PINLD
 ;;7811^TURBERCULOSIS
 ;;7812^VERRUGA
 ;;7813^DERMATOPHYTOSIS;TINEA VERSICOLOR;CANDIDIASIS;JUNGLE ROT;TRENCH FOOT;ONYCHOMYCOSIS
 ;;7814^TINEA BARBA
 ;;7815^EPIDERMOLYSIS BULLOSA;BULLA;BULLOUS ERUPTION;PORPHYRIA;PEMPHIGOID;PEMPHIGUS
 ;;7816^KERATODERMA;LICHEN PLANUS;SEBORRHEIC DERMATITIS;STASIS DERMATITIS;PSORIASIS
 ;;7817^ICHTHYOSIS;DERMATITIS EXFOLIATIVA
 ;;7818^BASAL CELL CARCINOMA;SQUAMOUS CELL CARCINOMA;BOWEN'S DISEASE;PADGET'S DISEASE;MALIGNANT MELANOMA;MELANOMA;CUTANEOUS T CELL LYMPHOMA;CTCL;KAPOSI'S SARCOMA;DASAL CELL NEVUS SYNDROME;NEW GROWTHS, MALIGNANT
 ;;7819^VERRUCA;SEBACEOUS NEVUS;WART;SARCOIDOSIS;ROSACEA;MOLLUSCUM CONTAGIOSUM;NEVUS;MILIARIA;LEUKOPLAKIA;CUTANEOUS HORN;KERATOACANTHOMA;HEMANGIOMA;CAPILLARY HEMANGIOMA;GRANULOMA ANNULARE;FOLLICULITIS;DEMATOFIBROMA
 ;;7819^PILAR CYST;VARICELLA ZOSTER;CHELITIS;CHLORACNE;HERPES SIMPLEX;SPOROTRICHOSIS;BLASTOMYCOSIS;HISTOPLASMOSIS;COCCIDIOMYCOSIS;DISSECTING CELLULITIS;ACNE;PANICULITIS;SKIN TAGS;FRIBROEPITHELIAL POLYPS;CHERRY HEMANGIOMA
 ;;7819^NEUROFIBROMATOSIS;VON RECKLINGHAUSEN'S DISEASE;CONDYLOMA;CONDYLOMATA;PAPILLOMA;PRIRIGO NODULARIS;NEURODERMATITIS;NECROBIOSIS;NLD;ACTINIC KERATOSIS;AK;SEBORRHEIC KERATOSIS;SK;LICHEN SIMPLEX;ERYTHEMA NODOSUM;NEW GROWTHS, BENIGN

DVBAPK8
DVBAPK8 ;ALB/CMM KEYWORD DATA ROUTINE ;3/29/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;The format is exam number ^ keyword seperated by ;
 ;
EN ;
 ;;8510^UPPER BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8610^UPPER BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8710^UPPER BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8511^MIDDLE BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8611^MIDDLE BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8711^MIDDLE BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8512^LOWER BRACHIAL PLEXUS PALSY BRACHIAL PLEXOPATHY
 ;;8612^LOWER BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8712^LOWER BRACHIAL PLEXUS PALSY;BRACHIAL PLEXOPATHY
 ;;8513^COMPLETE BRACHIAL PLEXOPATHY;COMPLETE BRACHIAL PLEXUS PALSY
 ;;8613^COMPLETE BRACHIAL PLEXOPATHY;COMPLETE BRACHIAL PLEXUS PALSY
 ;;8713^COMPLETE BRACHIAL PLEXOPATHY;COMPLETE BRACHIAL PLEXUS PALSY
 ;;8514^RADIAL PALSY;WRIST DROP;MUSCULOSPINAL NERVE PALSY
 ;;8614^RADIAL PALSY;WRIST DROP;MUSCULOSPINAL NERVE PALSY
 ;;8714^RADIAL PALSY;WRIST DROP;MUSCULOSPINAL NERVE PALSY
 ;;8515^MEDIAN PALSY;CARPAL TUNNEL SYNDROME;CTS;MEDIAN NEUROPATHY
 ;;8615^MEDIAN PALSY;CARPAL TUNNEL SYNDROME;CTS;MEDIAN NEUROPATHY
 ;;8715^MEDIAN PALSY;CARPAL TUNNEL SYNDROME;CTS;MEDIAN NEUROPATHY
 ;;8516^ULNAR PALSY;ULNAR NEUROPATHY;CUBITAL TUNNEL SYNDROME
 ;;8616^ULNAR PALSY;ULNAR NEUROPATHY;CUBITAL TUNNEL SYNDROME
 ;;8716^ULNAR PALSY;ULNAR NEUROPATHY;CUBITAL TUNNEL SYNDROME
 ;;8519^WINGED SCAPULA
 ;;8619^WINGED SCAPULA
 ;;8719^WINGED SCAPULA
 ;;8520^SCIATIC PALSY;SCIATICA;LOWER LEG PARALYSIS;LOWER LEG PARESIS
 ;;8620^SCIATIC PALSY;SCIATICA;LOWER LEG PARALYSIS;LOWER LEG PARESIS
 ;;8720^SCIATIC PALSY;SCIATICA;LOWER LEG PARALYSIS;LOWER LEG PARESIS
 ;;8521^PERONEAL PALSY;FOOT DROP
 ;;8621^PERONEAL PALSY;FOOT DROP
 ;;8721^PERONEAL PALSY;FOOT DROP
 ;;8522^^PERONEAL PALSY;FOOT DROP
 ;;8622^PERONEAL PALSY;FOOT DROP
 ;;8722^PERONEAL PALSY;FOOT DROP
 ;;8523^PERONEAL PALSY;FOOT DROP
 ;;8623^PERONEAL PALSY;FOOT DROP
 ;;8723^PERONEAL PALSY;FOOT DROP
 ;;8524^TIBIAL NEUROPATHY;TIBIAL PARESIS
 ;;8624^TIBIAL NEUROPATHY;TIBIAL PARESIS
 ;;8724^TIBIAL NEUROPATHY;TIBIAL PARESIS
 ;;8525^TIBIAL NEUROPATHY;TIBIAL PARESIS
 ;;8625^TIBIAL NEUROPATHY;TIBIAL PARESIS
 ;;8725^TIBIAL NEUROPATHY;TIBIAL PARESIS
 ;;8526^FEMORAL NEUROPATHY;FEMORAL PARALYSIS;QUADRICEP PARALYSIS;QUADRICEPS PARESIS
 ;;8626^FEMORAL NEUROPATHY;FEMORAL PARALYSIS;QUADRICEP PARALYSIS;QUADRICEPS PARESIS
 ;;8726^FEMORAL NEUROPATHY;FEMORAL PARALYSIS;QUADRICEP PARALYSIS;QUADRICEPS PARESIS
 ;;8528^ADDUCTOR PARESIS;ADDUCTOR PARALYSIS
 ;;8628^ADDUCTOR PARESIS;ADDUCTOR PARALYSIS
 ;;8728^ADDUCTOR PARESIS;ADDUCTOR PARALYSIS
 ;;8529^LATERAL FEMORAL CUTANEOUS NEUROPATHY;MYRALGIA PARESTHETICA
 ;;8629^LATERAL FEMORAL CUTANEOUS NEUROPATHY;MYRALGIA PARESTHETICA
 ;;8729^LATERAL FEMORAL CUTANEOUS NEUROPATHY;MYRALGIA PARESTHETICA
 ;;8540^FIBROSACOMA OF NERVE;MICROGLIOMA;RETICULUM-CELL SARCOM OF NERVE
 ;;8910^GRAND MAL SEIZURES;CONVULSIONS;TONIC-CLONIC CONVULSIONS
 ;;8911^PETIT MAL SEIZURES;MINOR SEIZURE;MYOTONIC SEIZURE;MYOCLONIC SEIZURE;ABSENCE SPELLS;AKINETIC SEIZURE
 ;;8912^JACKSONIAN SEIZURE;FOCAL SEIZURE;FOCAL MOTOR SEIZURE;FOCAL EPILEPSY
 ;;8914^PSYCHOMOTOR SEIZURES;PYSCHOMOTOR EPILIPSY;TEMPORAL LOBE EPILEPSY;TEMPORAL LOBE SEIZURE

DVBAPK9
DVBAPK9 ;ALB/CMM KEYWORD DATA ROUTINE ;3/29/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;The format is exam number ^ keyword seperated by ;
 ;
EN ;
 ;;8000^ENCEPHALOMYELITIS;ACUTE POST INFECTIONS ENCEPHALITIS;EASTERN EQUINE ENCEPHALITIS
 ;;8002^ASTROCYTOMA;GLIOBLASTOMA;OLIGODENDROGLIOMA;EPENDYMOMA;EPENDYMOBLASTOMAS;SUBEPENDYMOMA;CHOROID PLEXUS PAPILLOMA;MEDULLOBLASTOMA;GANGLIONEUROMA;GANGLIONGLIOMA;PINEALOMA;PINEOCYTOMA;PINEOBLASTOMAS;MELANOMA;MELANOMA OF CENTRAL NERVOUS SYSTEM
 ;;8002^INTRACRANIAL FIBROSARCOMA;INTRACRANIAL RETICULUM CELL SARCOMA;MICROGLIOMA;CHORDOMA
 ;;8003^COLLOID CYSTS OF THIRD VENTRICLE;COLLOID CYSTS;SCHWANNOMA;NEURILEMMONAS;NEURINOMA;NEUROFIBROMA;VON RECKLINGHAUSEN'S NEUROFIBROMATOSIS;MENINGIOMA;CRANIOPHARYNGIOMA;PITUITARY ADENOMA;EPIDERMOID CYST
 ;;8003^DEMOID CYST;HEMANGIOBLASOMA;VON HIPPEL-LINDAU DISEASE
 ;;8004^PARKINSON'S;PARKINSON'S DISEASE
 ;;8005^MULTIPLE SCLEROSIS;AMYOTHROPHIC LATERAL SCLEROSIS
 ;;8007^STROKE;CVA;CEREBRAL VASCULAR ACCIDENT;EMBOLIC STROKE
 ;;8008^STROKE;CVA;CEREBRAL VASCULAR ACCIDENT;CEREBRAL THROMBOSIS;CEREBRAL CLOT
 ;;8009^STROKE;CVA;CEREBRAL VASCULAR ACCIDENT;CEREBRAL BLEED;INTRACRANIAL BLEED
 ;;8010^ACUTE TRANSVERSE MYELITIS;LEUKOMYELITIS
 ;;8011^POLIO;INFANTILE PARALYSIS
 ;;8012^SPINAL CORD CONFUSION;TRAUMATIC MYELOPATHY;TRANSVERSE MYELOPATHY
 ;;8013^LUES;TERTIARY LUES;TERTIARY SYPHYLIS;PARESIS;DEMENTIA PARALYTICA;GENERAL PARESIS;PARALYTIC DEMENTIA
 ;;8014^LUES;TERTIARY LUES;TERTIARY SYPHYLIS;PARESIS;DEMENTIA PARALYTICA;GENERAL PARESIS;PARALYTIC DEMENTIA
 ;;8015^LUES;TERTIARY LUES;TERTIARY SYPHYLIS;PARESIS;DEMENTIA PARALYTICA;GENERAL PARESIS;PARALYTIC DEMENTIA
 ;;8017^ALS;LOU GHERIG'S DISEASE;ARAN-DUCHENE MUSCULAR ATROPHY
 ;;8018^MS
 ;;8019^SPINAL MENINGITIS;BACTERIAL MENINGITIS
 ;;8021^ASTROCYTOMA;GLIOBLASTOMA;OLIGODENDROGLIOMA;EPENDYMOMA;EPENDYMOBLASTOMAS;SUBEPENDYMOMA;CHOROID PLEXUS PAPILLOMA;MEDULLOBLASTOMA;GANGLIONEUROMA;PINEOBLASTOMAS;MELANOMA;MELANOMA OF CENTRAL NERVOUS SYSTEM
 ;;8021^INTRACRANIAL FIBROSARCOMA;INTRACRANIAL RETICULUM CELL SARCOMA;MICROGLIOMA;CHORDOMA;GANGLIONGLIOMA;PINEALOMA;PINEOCYTOMA
 ;;8022^COLLOID CYSTS OF THIRD VENTRICLE;COLLOID CYSTS;SCHWANNOMA;NEURILEMMONAS;NEURINOMA;NEUROFIBROMA;VON RECKLINGHAUSEN'S NEUROFIBROMATOSIS;MENINGIOMA;CRANIOPHARYNGIOMA;PITUITARY ADENOMA;EPIDERMOID CYST
 ;;8022^DEMOID CYST;HEMANDIOBLASOMA;VON HIPPEL-LINDAU DISEASE
 ;;8023^MUSCULAR DYSTROPHY;DUCHENNE'S PSEUDOHYPERTROPHIC MUSCULAR DYSTROPHY;FACIOSCAPULAR MUSCULAR DYSTROPHY;LIMB-GIRDLE MYOPATHY;DISTAL MYOPATHY;MYOFONIC DYSTROPHY
 ;;8045^TRAUMATIC ENCEPHALOPATHY;POST TRAUMATIC ENCEPHALOPATHY;POST TRAUMATIC BRAIN DISEASE
 ;;8046^HARDENING OF THE ARTERIES
 ;;8100^VASCULAR HEADACHE;CLUSTER HEADACHE;HEADACHE
 ;;8103^MIMIC SPASM
 ;;8104^MYOCLONIC SEIZURE
 ;;8105^SYDENHAN'S CHOREA;CHOREA MINOR;RHEUMATIC CHOREA
 ;;8106^HUNTINGTON'S CHOREA;CHRONIC CHOREA;DEGENERATIVE CHOREA
 ;;8108^CATAPLEXY;SLEEP PARALYSIS
 ;;8205^TRIGEMINAL NEURALGIA;FIFTH NERVE PARALYSIS
 ;;8305^TRIGEMINAL NEURITIS;FIFTH NERVE NEURITIS
 ;;8405^TRIGEMINAL NEURALGIA;TIC DOULOUREUX
 ;;8207^FACIAL PARALYSIS
 ;;8307^FACIAL NEURITIS
 ;;8407^FACIAL NEURALGIA
 ;;8209^GLOSSOPHARYNGEAL PARALYSIS
 ;;8309^GLOSSOPHARYNGEAL NEURITIS
 ;;8409^GLOSSOPHARYNGEAL NEURALGIA
 ;;8210^VAGUS PARALYSIS
 ;;8310^VAGAL NEURITIS
 ;;8410^VAGAL NEURALGIA;HYPERTONIC VAGUS
 ;;8211^SPINAL ACCESSORY PARALYSIS
 ;;8311^SPINAL ACCESSORY NEURITIS
 ;;8411^SPINAL ACCESSORY NEURALGIA
 ;;8212^HYPOGLOSSAL PARALYSIS
 ;;8312^HYPOGLOSSAL NEURITIS
 ;;8412^HYPOGLOSSAL NEURALGIA
 ;;6601^KARTAGNER'S SYNDROME;BRONCHIECTASIS
 ;;6502^NASAL FRACTURE;BROKEN NOSE;SEPTAL DEVIATION
 ;;6516^HORSENESS;VOICE, LOSS OF
 ;;6801^SAND PNEUMOCONIOSIS
 ;;6809^ANAEROBIC LUNG INFECTION
 ;;6808^FUNGAL PNEUMONIA;LUNG, FUNGAL INFECTION
 ;;6820^SARCOIDOSIS
 ;;7915^MULTIPLE ENDOCRINE NEOPLASIA;INSULINOMA;PHEOCHROMOCYTOMA
 ;;6300^VIBRIO CHOLERAE
 ;;6313^NUTRITIONAL DEFICIENCY;MALNUTRITION
 ;;6314^THIAMINE DEFICIENCY;VITAMIN B1 DEFICIENCY
 ;;6315^NIACIN DEFICIENCY

DVBAPKY
DVBAPKY ;ALB/JLU,GTS- KEYWORD FILE UPDATE ;1/25/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;
 D SET
 D LOOP
 D SG1
 D EXIT
 Q
SET N VAR
 S VAR=" - Adding to Local Keyword File.",KWCNT=0
 W !!!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
SET1 ;
 S DIF="^TMP($J,""DVBA"",",XCNP=0
 K ^TMP($J,"DVBA")
 F ROU="DVBAPK1","DVBAPK2","DVBAPK3","DVBAPK4","DVBAPK5","DVBAPK6","DVBAPK7","DVBAPK8","DVBAPK9" S X=ROU X ^%ZOSF("LOAD") W "."
 K DIF,XCNP,ROU,X
 Q
LOOP ; ** Loop through text lines in Routine files DVBAPK# **
 S PREFIX=""
 I $D(^DVB(396.1,1,"POST")) S PREFIX=$P(^DVB(396.1,1,"POST"),";",1)
 I PREFIX="" DO
 .N VAR
 .S VAR="Prefix DVBA not set up on AMIE Site Parameter file.  Conversion aborted!"
 .W !!,VAR
 .D BUMP^DVBAPOST(VAR)
 Q:PREFIX=""  ;** QUIT out of LOOP Tag
 N LP,KW,KWPCE,LP2
 S LP=0
 F  S LP=$O(^TMP($J,"DVBA",LP)) Q:(LP="")  I $D(^TMP($J,"DVBA",LP,0)) S LINE=^TMP($J,"DVBA",LP,0) DO
 .I (LINE[";;"),(LINE'[";AMIE;"),(LINE'="") DO
 ..W:(LP#10) "."
 ..S CODE=$P(LINE,U,1)
 ..S CODE=+($P(CODE,";;",2))
 ..S KW=$P(LINE,U,2)
 ..F LP2=1:1 S KWPCE=$P(KW,";",LP2) Q:KWPCE=""  DO
 ...K STOP
 ...D DCH
 ...D:'$D(STOP) ADDKW
 Q
 ;
ADDKW ; ** Add a KEYWORD to the lookup file **
 K DIC,DA,DR,DLAYGO,Y,DD,DO
 D SETUP
 I $D(STOP) Q
 S DIC="^XT(8984.1,",DIC(0)="LX",DLAYGO="8984.1"
 S DIC("DR")=".02////^S X=DVBAVAR"
 S X=KWPCE D FILE^DICN
 I Y<0 D SE
 I Y'<0 S KWCNT=KWCNT+1
 K DA,DR,DIC,DLAYGO,Y,DD,DO,X
 Q
SE ;
 N VAR
 S VAR="Addition of Keyword "_KWPCE_" for code "_CODE_" has Failed.  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
SE1 ;
 N VAR
 S VAR="Could not find the  "_CODE_" code in the 'C' X-ref.  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
DCH ;
 N LP1,LP2,KWPCEX
 S KWPCEX=$E(KWPCE,1,30)
 F LP1=0:0 S LP1=$O(^XT(8984.1,"B",KWPCEX,LP1)) Q:'LP1!($D(STOP))  DO
 .I $P(^XT(8984.1,LP1,0),U,1)=KWPCE DO
 ..S JC=$O(^DIC(31,"C",CODE,""))
 ..I JC="" D SE1 S STOP=1 I 1
 ..E  S LP2=JC_";DIC(31," I $P(^XT(8984.1,LP1,0),U,2)=LP2 S STOP=1
 Q
 ;
SG1 ;writes and updates the tmp global at completion
 N LP1,V1
 F LP1=1:1:2 D BUMPBLK^DVBAPOST
 S V1="The Local Keyword file has completed update of "_KWCNT_" Keywords!"
 W !!,V1
 D BUMP^DVBAPOST(V1)
 D BUMPBLK^DVBAPOST
 Q
EXIT ;
 K X,Y,STOP,LINE,^TMP($J,"DVBA"),PREFIX,CODE,KWCNT,JC
 Q
SETUP ;gets the first entry in dic 31
 S DVBAVAR=$O(^DIC(31,"C",CODE,""))
 I DVBAVAR="" D SE1 S STOP=1 Q
 I '$D(^DIC(31,DVBAVAR,0)) D SE2 S STOP=1 Q
 S DVBAVAR=DVBAVAR_";DIC(31,"
 Q
SE2 ;
 N VA
 S VAR="Zero node of the "_CODE_" code does not exist.  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q

DVBAPL1
DVBAPL1 ;ALB/CMM LONG DESCRIPTIONS FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;7909;HYPOPITUITARISM (DIABETES INSIPIDUS)
 ;;7913;DIABETES MELLITUS
 ;;7904;HYPERPARATHYROIDISM (OSTEITIS FIBROSA CYSTICA)
 ;;7905;HYPOPARATHYROIDISM
 ;;7907;HYPERPITUITARISM (PITUITARY BASOPHILISM, CUSHING'S SYNDROME)
 ;;7908;HYPERPITUITARISM (ACROMEGALY OR GIGANTISM)
 ;;7911;ADDISON'S DISEASE
 ;;7900;HYPERTHYROIDISM
 ;;7901;THYROID GLAND, TOXIC ADENOMA OF
 ;;7902;THYROID GLAND, NONTOXIC ADENOMA OF
 ;;7903;HYPOTHYROIDISM
 ;;7910;HYPERADRENIA (ADRENOGENITAL SYNDROME)
 ;;7912;PLURIGLANDULAR SYNDROMES
 ;;7914;NEW GROWTHS, MALIGNANT, ANY SPECIFIED PART OF ENDOCRINE SYSTEM
 ;;7915;NEW GROWTHS, BENIGN, ANY SPECIFIED PART OF ENDOCRINE SYSTEM
 ;;7510;URETEROLITHIASIS
 ;;7511;URETER, STRICTURE OF
 ;;7512;CYSTITIS, CHRONIC, INCLUDES INTERSTITIAL AND ALL ETIOLOGIES, INFECTIOUS AND NON-INFECTIOUS
 ;;7515;BLADDER, CALCULUS IN, WITH SYMPTOMS INTERFERING WITH FUNCTION
 ;;7516;BLADDER, FISTULA OF
 ;;7517;BLADDER, INJURY OF
 ;;7518;URETHRA, STRICTURE OF
 ;;7519;URETHRA, FISTULA OF
 ;;7527;PROSTATE GLAND INJURIES, INFECTIONS, HYPERTROPHY, POST-OPERTIVE RESIDUALS
 ;;7542;NEUROGENIC BLADDER
 ;;7520;PENIS, REMOVAL OF HALF OR MORE
 ;;7521;PENIS, REMOVAL OF GLANS
 ;;7522;PENIS, DEFORMITY, WITH LOSS OF ERECTILE POWER
 ;;7528;MALIGNANT NEOPLASMS OF THE GENITOURINARY SYSTEM
 ;;7529;BENIGN NEOPLASMS OF THE GENITOURINARY SYSTEM
 ;;7508;NEPHROLITHIASIS
 ;;7509;HYDRONEPHROSIS
 ;;7523;TESTIS, ATROPHY COMPLETE
 ;;7524;TESTIS, REMOVAL
 ;;7525;EPIDIYMO-ORCHITIS, CHRONIC ONLY
 ;;7610;VULVOVAGINITIS
 ;;7611;VAGINITIS
 ;;7612;CERVICITIS
 ;;7613;METRITIS
 ;;7614;SALPINGITIS
 ;;7615;OOPHORITIS
 ;;7617;UTERUS AND BOTH OVARIES, REMOVAL OF, COMPLETE
 ;;7618;UTERUS, REMOVAL OF, INCLUDING CORPUS
 ;;7619;OVARIES, REMOVAL OF BOTH
 ;;7620;OVARIES, ATROPHY OF BOTH, COMPLETE
 ;;7621;UTERUS, PROLAPSE
 ;;7622;UTERUS, DISPLACEMENT OF
 ;;7623;PREGNANCY, SURGICAL COMPLICATIONS OF
 ;;7624;FISTULA, RECTOVAGINAL
 ;;7625;FISTULA, URETHROVAGINAL
 ;;7627;NEW GROWTHS, MALIGNANT, GYNECOLOGICAL SYSTEM OR MAMMARY GLANDS
 ;;7626;MAMMARY GLANDS, REMOVAL OF
 ;;7700;ANEMIA, PERNICIOUS
 ;;7701;ANEMIA, SECONDARY
 ;;7702;AGRANULOCYTOSIS, ACUTE
 ;;7703;LEUKEMIA
 ;;7704;POLYCYTHEMIA, PRIMARY
 ;;7705;PURPURA HEMORRHAGICA
 ;;7706;SPLENECTOMY
 ;;7707;SPLEEN, INJURY OF, HEALED
 ;;7714;SICKLE CELL ANEMIA
 ;;7709;LYMPHOGRANULOMATOSIS (HODGKIN'S DISEASE)
 ;;7710;ADENITIS, CERVICAL, TUBERCULOUS, ACTIVE OR INACTIVE
 ;;7711;ADENITIS, AXILLARY, TUBERCULOUS, ACTIVE OR INACTIVE
 ;;7712;ADENITIS, INGUINAL, TUBERCULOUS, ACTIVE OR INACTIVE
 ;;7713;ADENITIS, SECONDARY
 ;;7715;NON-HODGKIN'S LYMPHOMA

DVBAPL10
DVBAPL10 ;ALB/CMM LONG DESCIRPTION FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;7100;ARTERIOSCLEROSIS, GENERAL
 ;;7101;HYPERTENSIVE VASCULAR DISEASE (ESSENTIAL ARTERIAL HYPERTENSION)
 ;;7110;ANEURYSM, AORTIC, FUSIFORM, SACULAR, DISSECTION AND/OR WITH STENOSIS
 ;;7111;ARTERY, ANY LARGE ARTERY, ANEURYSM OF
 ;;7112;ARTERY, SMALL, ANEURYSMAL DILATATION OF
 ;;7113;ARTERIOVENOUS ANEURYSM, TRAUMATIC 
 ;;7114;ARTERIOSCLEROSIS OBLITERANS 
 ;;7115;THROMBOANGITIS OBLITERANS (BUERGER'S DISEASE) 
 ;;7116;CLAUDICATION, INTERMITTENT
 ;;7117;RAYNAUD'S DISEASE
 ;;7118;ANGIONEUROTIC EDEMA
 ;;7119;ERYTHROMYALGIA
 ;;7120;VARICOSE VEINS
 ;;7121;PHLEBITIS OR THROMBOPHLEBITIS, UNILATERAL, WITH OBLITERATION OF DEEP RETURN CIRCULATION, INCLUDING TRAUMATIC CONDITIONS
 ;;7122;FROZEN FEET, RESIDUALS OF (IMMERSION FOOT) 
 ;;7123;SOFT-TISSUE SARCOMA (OF VASCULAR ORIGIN) 
 ;;7000;RHEUMATIC HEART DISEASE
 ;;7001;ENDOCARDITIS, BACTERIAL, SUBACUTE 
 ;;7002;PERICARDITIS, BACTERIAL OR RHEUMATIC, ACUTE 
 ;;7003;ADHESIONS, PERICARDIAL
 ;;7004;SYPHILITIC HEART DISEASE 
 ;;7005;ARTERIOSCLEROTIC HEART DISEASE 
 ;;7006;MYOCARDIUM, INFARCTION OF, DUE TO THROMBOSIS OR EMBOLISM
 ;;7007;HYPERTENSIVE HEART DISEASE 
 ;;7008;HYPERTHYROID HEART DISEASE
 ;;7010;AURICULAR FLUTTER, PAROXYSMAL
 ;;7011;AURICULAR FIBRILLATION, PAROXYSMAL 
 ;;7012;AURICULAR FIBRILLATION, PERMANENT 
 ;;7013;TACHYCARDIA, PAROXYSMAL
 ;;7014;SINUS TACHYCARDIA
 ;;7015;AURICULOVENTRICULAR BLOCK
 ;;7016;HEART VALVE REPLACEMENT (PROSTHESIS) 
 ;;7017;CORONARY ARTERY BYPASS
 ;;9900;MAXILLA OR MANDIBLE, OSTEOMYELITIS OF, CHRONIC 
 ;;9901;MANDIBLE, LOSS OF, COMPLETE, BETWEEN ANGLES
 ;;9902;MANDIBLE, LOSS OF APPROXIMATELY ONE-HALF 
 ;;9903;MANDIBLE, NONUNION OF
 ;;9904;MANDIBLE, MALUNION OF
 ;;9905;TEMPOROMANDIBULAR ARTICULATION, LIMITED MOTION OF 
 ;;9906;RAMUS, LOSS OF WHOLE OR PART OF
 ;;9907;RAMUS, LOSS OF LESS THAN ONE-HALF THE SUBSTANCE OF, NOT INVOLVING LOSS OF CONTINUITY
 ;;9908;CONDYLOID PROCESS, LOSS OF, ONE OR BOTH SIDES 
 ;;9909;CORONOID PROCESS, LOSS OF
 ;;9911;HARD PALATE, LOSS OF HALF OR MORE
 ;;9912;HARD PALATE, LOSS OF LESS THAN HALF OF 
 ;;9913;TEETH, LOSS OF, DUE TO LOSS OF SUBSTANCE OF BODY OF MAXILLA OR MANDIBLE
 ;;7200;MOUTH, INJURIES OF
 ;;7201;LIPS, INJURIES OF
 ;;7202;TONGUE, LOSS OF WHOLE OR PART
 ;;7311;LIVER, INJURY OF
 ;;7312;LIVER, CIRRHOSIS OF
 ;;7313;LIVER, ABSCESS OF, RESIDUALS 
 ;;7314;CHOLECYSTITIS, CHRONIC
 ;;7315;CHOLELITHIASIS, CHRONIC
 ;;7316;CHOLANGITIS, CHRONIC
 ;;7317;GALL BLADDER, INJURY OF
 ;;7318;GALL BLADDER, REMOVAL OF
 ;;7338;HERNIA, INGUINAL
 ;;7339;HERNIA, VENTRAL, POSTOPERATIVE
 ;;7340;HERNIA, FEMORAL
 ;;7342;VISCEROPTOSIS, SYMPTOMATIC, MARKED
 ;;7343;NEW GROWTHS, MALIGNANT, EXCLUSIVE OF SKIN GROWTHS 
 ;;7344;NEW GROWTHS, BENIGN, ANY SPECIFIED PART OF DIGESTIVE SYSTEM, EXCLUSIVE OF SKIN GROWTHS
 ;;7345;HEPATITIS, INFECTIOUS
 ;;7346;HERNIA HIATAL
 ;;7347;PANCREATITIS
 ;;7348;VAGOTOMY WITH PYLOROPLASTY OR GASTROENTEROSTOMY 
 ;;7203;ESOPHAGUS, STRICTURE OF
 ;;7204;ESOPHAGUS, SPASM OF (CARDIOSPASM) 
 ;;7205;ESOPHAGUS, DIVERTICULUM OF, ACQUIRED
 ;;7301;PERITONEUM, ADHESIONS OF 
 ;;7319;IRRITABLE COLON SYNDROME (SPASTIC COLITIS, MUCOUS COLITIS, ETC)
 ;;7321;AMEBIASIS
 ;;7322;DYSENTERY, BACILLARY
 ;;7323;COLITIS, ULCERATIVE
 ;;7324;DISTOMIASIS, INTESTINAL OR HEPATIC 
 ;;7325;ENTERITIS, CHRONIC
 ;;7326;ENTEROCOLITIS, CHRONIC
 ;;7327;DIVERTICULITIS
 ;;7328;INTESTINE, SMALL, RESECTION OF 
 ;;7329;INTESTINE, LARGE, RESECTION OF 
 ;;7330;INTESTINE, FISTULA OF, PERSISTENT, OR AFTER ATTEMPT AT OPERATIVE CLOSURE
 ;;7331;PERITONITIS, TUBERCULOUS, ACTIVE OR INACTIVE 
 ;;7332;RECTUM AND ANUS, IMPAIRMENT OF SPHINCTER CONTROL 
 ;;7333;RECTUM AND ANUS, STRICTURE OF
 ;;7334;RECTUM, PROLAPSE OF
 ;;7335;ANO, FISTULA IN 
 ;;7336;HEMORRHOIDS, EXTERNAL OR INTERNAL 
 ;;7337;PRURITUS ANI
 ;;7304;ULCER, GASTRIC
 ;;7305;ULCER, DUODENAL
 ;;7306;ULCER, MARGINAL (GASTROJEJUNAL) 
 ;;7307;GASTRITIS, HYPERTROPHIC (IDENTIFIED BY GASTROSCOPE)
 ;;7308;POSTGRASTRECTOMY SYNDROMES
 ;;7309;STOMACH, STENOSIS OF
 ;;7310;STOMACH, INJURY OF, RESIDUALS
 ;;6275;LOSS OF SENSE OF SMELL, COMPLETE
 ;;6276;LOSS OF SENSE OF TASTE, COMPLETE

DVBAPL2
DVBAPL2 ;ALB/CMM LONG DESCRIPTION FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;9201;SCHIZOPHRENIA, DISORGANIZED TYPE
 ;;9202;SCHIZOPHRENIA, CATATONIC TYPE
 ;;9203;SCHIZOPHRENIA, PARANOID TYPE
 ;;9204;SCHIZOPHRENIA, UNDIFFERENTIATED TYPE
 ;;9205;SCHIZOPHRENIA, RESIDUAL TYPE; SCHIZOAFFECTIVE DISORDER; OTHER AND UNSPECIFIED TYPES
 ;;9206;BIPOLAR DISORDER, MANIC, DEPRESSED, OR MIXED
 ;;9207;MAJOR DEPRESSION WITH PSYCHOTIC FEATURES
 ;;9208;PARANOID DISORDERS
 ;;9209;MAJOR DEPRESSION WITH MELANCHOLIA
 ;;9210;ATYPICAL PSYCHOSIS
 ;;9300;DELIRIUM ASSOCIATED WITH INFECTION, TRAUMA, CIRCULATORY DISTURBANCE, ETC.
 ;;9301;DEMENTIA ASSOCIATED WITH CENTRAL NERVOUS SYSTEM SYPHILIS
 ;;9302;DEMENTIA ASSOCIATED WITH INTRACRANIAL INFECTIONS OTHER THAN SYPHILIS
 ;;9303;DEMENTIA ASSOCIATED WITH ALCOHOLISM
 ;;9304;DEMENTIA ASSOCIATED WITH BRAIN TRAUMA
 ;;9305;MULTI-INFARCT DEMENTIA WITH CEREBRAL ARTERIOSCLEROSIS
 ;;9306;MULTI-INFARCT DEMENTIA DUE TO CAUSES OTHER THAN CEREBRAL ARTERIOSCLEROSIS
 ;;9307;DEMENTIA ASSOCIATED WITH CONVULSIVE DISORDER (IDIOPATHIC EPILEPSY)
 ;;9308;DEMENTIA ASSOCIATED WITH DISTURBANCES OF METABOLISM
 ;;9309;DEMENTIA ASSOCIATED WITH BRAIN TUMOR
 ;;9310;DEMENTIA DUE TO UNKNOWN CAUSE
 ;;9311;DEMENTIA DUE TO UNDIAGNOSED CAUSE
 ;;9312;DEMENTIA, PRIMARY, DEGENERATIVE
 ;;9315;DEMENTIA ASSOCIATED WITH EPIDEMIC ENCEPHALITIS
 ;;9322;DEMENTIA ASSOCIATED WITH ENDOCRINE DISORDER
 ;;9324;DEMENTIA ASSOCIATED WITH SYSTEMIC INFECTION
 ;;9325;DEMENTIA ASSOCIATED WITH DRUG OR POISON INTOXICATION (OTHER THAN ALCOHOL)
 ;;9400;GENERALIZED ANXIETY DISORDER
 ;;9401;PSYCHOGENIC AMNESIA; PSYCHOGENIC FUGUE; MULTIPLE PERSONALITY
 ;;9402;CONVERSION DISORDER; PSYCHOGENIC PAIN DISORDER
 ;;9403;PHOBIC DISORDER
 ;;9404;OBSESSIVE COMPULSIVE DISORDER
 ;;9405;DYSTHYMIC DISORDER; ADJUSTMENT DISORDER WITH DEPRESSED MOOD; MAJOR DEPRESSION WITHOUT MELANCHOLIA
 ;;9408;DEPERSONALIZATION DISORDER
 ;;9409;HYPOCHONDRIASIS
 ;;9410;OTHER AND UNSPECIFIED NEUROSIS
 ;;9500;PSYCHOLOGICAL FACTORS AFFECTING SKIN CONDITION
 ;;9501;PSYCHOLOGICAL FACTORS AFFECTING CARDIOVASCULAR CONDITION
 ;;9502;PSYCHOLOGICAL FACTORS AFFECTING GASTROINTESTINAL CONDITION
 ;;9505;PSYCHOLOGICAL FACTORS AFFECTING MUSCULOSKELETAL CONDITION
 ;;9506;PSYCHOLOGICAL FACTORS AFFECTING RESPIRATORY CONDITION
 ;;9507;PSYCHOLOGICAL FACTORS AFFECTING HEMIC AND LYMPHATIC CONDITION
 ;;9508;PSYCHOLOGICAL FACTORS AFFECTING GENITOURINARY CONDITION
 ;;9509;PSYCHOLOGICAL FACTORS AFFECTING ENDOCRINE CONDITION
 ;;9510;PSYCHOLOGICAL FACTORS AFFECTING CONDITION OF ORGAN OF SPECIAL SENSE
 ;;9511;PSYCHOLOGICAL FACTORS AFFECTING OTHER TYPE OF PHYSICAL CONDITION
 ;;9411;POST-TRAUMATIC STRESS DISORDER
 ;;7505;KIDNEY, TUBERCULOSIS OF
 ;;7507;NEPHROSCLEROSIS, ARTERIOLAR
 ;;7535;TOXIC NEPHROPATHY
 ;;7536;GLOMERULONEPHRITIS
 ;;7537;INTERSTITIAL NEPHRITIS
 ;;7539;RENAL AMYLOID DISEASE
 ;;7540;DISSEMINATED INTRAVASCULAR COAGULATION WITH RENAL CORTICAL NECROSIS
 ;;7541;RENAL INVOLVEMENT IN DIABETES, SICKLE CELL ANEMIA, SYSTEMIC LUPUS ERYTHEMATOSIS, VASCULITIS OR OTHER SYSTEMIC DISEASE PROCESSES
 ;;7500;KIDNEY, REMOVAL OF ONE, WITH NEPHRITIS, INFECTION, OR PATHOLOGY OF THE OTHER
 ;;7501;KIDNEY, ABSCESS OF
 ;;7502;NEPHRITIS, CHRONIC
 ;;7504;PYELONEPHRITIS, CHRONIC
 ;;7530;CHRONIC RENAL DISEASE REQUIRING REGULAR DIALYSIS
 ;;7531;KIDNEY TRANSPLANT
 ;;7532;RENAL TUBULAR DISORDERS
 ;;7533;CYSTIC DISEASES OF THE KIDNEYS
 ;;7534;ATHEROSCLEROTIC RENAL DISEASE
 ;;7538;PAPILLARY NECROSIS
 ;;9914;MAXILLA, LOSS OF MORE THAN HALF
 ;;9915;MAXILLA, LOSS OF HALF OR LESS
 ;;9916;MAXILLA, MALUNION OR NONUNION

DVBAPL3
DVBAPL3 ;ALB/CMM LONG DESCRIPTION FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;5296;SKULL, LOSS OF PART OF, BOTH INNER AND OUTER TABLES
 ;;8205;PARALYSIS OF FIFTH (TRIGEMINAL) CRANIAL NERVE
 ;;8207;PARALYSIS OF SEVENTH (FACIAL) CRANIAL NERVE
 ;;8209;PARALYSIS OF NINTH (GLOSSOPHARYNEGEAL) CRANIAL NERVE
 ;;8210;PARALYSIS OF TENTH (PNEUMOGASTRIC, VAGUS) CRANIAL NERVE
 ;;8211;PARALYSIS OF ELEVENTH (SPINAL ACCESSORY, EXTERNAL BRANCH) CRANIAL NERVE
 ;;8212;PARALYSIS OF TWELFTH (HYPOGLOSSAL) CRANIAL NERVE
 ;;8305;NEURITIS OF FIFTH (TRIGEMINAL) CRANIAL NERVE
 ;;8307;NEURITIS OF SEVENTH (FACIAL) CRANIAL NERVE
 ;;8309;NEURITIS OF NINTH (GLOSSOPHARYNGEAL) CRANIAL NERVE
 ;;8310;NEURITIS OF TENTH (PNEUMOGASTRIC, VAGUS) CRANIAL NERVE
 ;;8311;NEURITIS OF ELEVENTH (SPINAL ACCESSORY, EXTERNAL BRANCH) CRANIAL NERVE
 ;;8312;NEURITIS OF TWELFTH (HYPOGLOSSAL) CRANIAL NERVE
 ;;8405;NEURALGIA OF FIFTH (TRIGEMINAL) CRANIAL NERVE
 ;;8407;NEURALGIA OF SEVENTH (FACIAL) CRANIAL NERVE
 ;;8409;NEURALGIA OF NINTH (GLOSSOPHARYNGEAL) CRANIAL NERVE
 ;;8410;NEURALGIA OF TENTH (PNEUMOGASTRIC, VAGUS) CRANIAL NERVE
 ;;8411;NEURALGIA OF ELEVENTH (SPINAL ACCESSORY, EXTERNAL BRANCH) CRANIAL NERVE
 ;;8412;NEURALGIA OF TWELFTH (HYPOGLOSSAL) CRANIAL NERVE
 ;;8000;ENCEPHALITIS, EPIDEMIC, CHRONIC
 ;;8002;MALIGNANT
 ;;8003;BENIGN, MINIMUM
 ;;8004;PARALYSIS AGITANS
 ;;8005;BULBAR PALSY
 ;;8007;BRAIN, VESSELS, EMBOLISM OF
 ;;8008;BRAIN, VESSELS, THROMBOSIS OF
 ;;8009;BRAIN, VESSELS, HEMORRHAGE FROM
 ;;8013;SYPHILIS, CEREBROSPINAL
 ;;8017;AMYOTROPHIC LATERAL SCLEROSIS
 ;;8018;MULTIPLE SCLEROSIS
 ;;8019;MENINGITIS, CEREBROSPINAL, EPIDEMIC
 ;;8020;BRAIN, ABSCESS OF
 ;;8045;BRAIN DISEASE DUE TO TRAUMA
 ;;8046;CEREBRAL ARTERIOSCLEROSIS
 ;;8010;MYELITIS
 ;;8011;POLIOMYELITIS, ANTERIOR
 ;;8012;HEMATOMYELIA
 ;;8014;SYPHILIS, MENINGOVASCULAR
 ;;8015;TABES DORSALIS
 ;;8021;NEW GROWTHS OF THE SPINAL CORD, MALIGNANT
 ;;8022;NEW GROWTHS OF THE SPINAL CORD, BENIGN
 ;;8023;PROGRESSIVE MUSCULAR ATROPHY
 ;;8024;SYRINGOMYELIA
 ;;8025;MYASTHENIA GRAVIS
 ;;8108;NARCOLEPSY
 ;;8910;EPILEPSY, GRAND MAL
 ;;8911;EPILEPSY, PETIT MAL
 ;;8912;EPILEPSY, JACKSONIAN AND FOCAL MOTOR OR SENSORY
 ;;8913;EPILEPSY, DIENCEPHALIC
 ;;8914;EPILEPSY, PSYCHOMOTOR
 ;;8100;MIGRAINE
 ;;8103;TIC, CONVULSIVE
 ;;8104;PARAMYOCLONUS MULTIPLEX (CONVULSIVE STATE, MYOLONIC TYPE)
 ;;8105;CHOREA, SYDENHAM'S
 ;;8106;CHOREA, HUNTINGTON'S
 ;;8107;ATHETOSIS, ACQUIRED
 ;;8510;PARALYSIS OF UPPER RADICULAR GROUP (FIFTH AND SIXTH CERVICALS)
 ;;8511;PARALYSIS OF MIDDLE RADICULAR GROUP
 ;;8512;PARALYSIS OF LOWER RADICULAR GROUP
 ;;8513;PARALYSIS OF ALL RADICULAR GROUPS
 ;;8514;PARALYSIS OF THE MUSCULOSPIRAL NERVE (RADIAL NERVE)
 ;;8515;PARALYSIS OF THE MEDIAN NERVE
 ;;8516;PARALYSIS OF THE ULNAR NERVE
 ;;8517;PARALYSIS OF MUSCULOCUTANEOUS NERVE
 ;;8518;PARALYSIS OF CIRCUMFLEX NERVE
 ;;8519;PARALYSIS OF LONG THORACIC NERVE
 ;;8520;PARALYSIS OF SCIATIC NERVE
 ;;8521;PARALYSIS OF EXTERNAL POPLITEAL NERVE (COMMON PERONEAL)
 ;;8522;PARALYSIS OF MUSCULOCUTANEOUS NERVE (SUPERFICIAL PERONEAL)
 ;;8523;PARALYSIS OF ANTERIOR TIBIAL NERVE (DEEP PERONEAL)
 ;;8524;PARALYSIS OF INTERNAL POPLITEAL NERVE (TIBIAL)
 ;;8525;PARALYSIS OF POSTERIOR TIBIAL NERVE
 ;;8526;PARALYSIS OF ANTERIOR CRURAL NERVE (FEMORAL)
 ;;8527;PARALYSIS OF INTERNAL SAPHENOUS NERVE
 ;;8528;PARALYSIS OF OBTURATOR NERVE
 ;;8529;PARALYSIS OF EXTERNAL CUTANEOUS NERVE OF THIGH
 ;;8530;PARALYSIS OF ILIO-INGUINAL NERVE
 ;;8540;SOFT TISSUE SARCOMA (OF NEUROGENIC ORIGIN)
 ;;8610;NEURITIS OF UPPER RADICULAR GROUP (FIFTH AND SIXTH CERVICALS)
 ;;8611;NEURITIS OF MIDDLE RDICULAR GROUP
 ;;8612;NEURITIS OF LOWER RADICULAR GROUP
 ;;8613;NEURITIS OF ALL RADICULAR GROUPS
 ;;8614;NEURITIS OF THE MUSCULOSPIRAL NERVE (RADIAL NERVE)
 ;;8615;NEURITIS OF THE MEDIAN NERVE
 ;;8616;NEURITIS OF THE ULNAR NERVE
 ;;8617;NEURITIS OF MUSCULOCUTANEOUS NERVE
 ;;8618;NEURITIS OF CIRCUMFLEX NERVE
 ;;8619;NEURITIS OF LONG THORACIC NERVE
 ;;8620;NEURITIS OF SCIATIC NERVE
 ;;8621;NEURITIS OF EXTERNAL POPLITEAL NERVE (COMMON PERONEAL)
 ;;8622;NEURITIS OF MUSCULOCUTANEOUS NERVE (SUPERFICIAL PERONEAL)
 ;;8623;NEURITIS OF ANTERIOR TIBIAL NERVE (DEEP PERONEAL)
 ;;8624;NEURITIS OF INTERNAL POPLITEAL NERVE (TIBIAL)
 ;;8625;NEURITIS OF POSTERIOR TIBIAL NERVE
 ;;8626;NEURITIS OF ANTERIOR CRURAL NERVE (FEMORAL)
 ;;8627;NEURITIS OF INTERNAL SAPHENOUS NERVE
 ;;8628;NEURITIS OF OBTURATOR NERVE
 ;;8629;NEURITIS OF EXTERNAL CUTANEOUS NERVE OF THIGH
 ;;8630;NEURITIS OF ILIO-INGUINAL NERVE

DVBAPL4
DVBAPL4 ;ALB/CMM LONG DESCRIPTION FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;8710;NEURALGIA OF UPPER RADICULAR GROUP (FIFTH AND SIXTH CERVICALS)
 ;;8711;NEURALGIA OF MIDDLE RADICULAR GROUP
 ;;8712;NEURALGIA OF LOWER RADICULAR GROUP
 ;;8713;NEURALGIA OF ALL RADICULAR GROUPS
 ;;8714;NEURALGIA OF THE MUSCULOSPIRAL NERVE (RADIAL NERVE)
 ;;8715;NEURALGIA OF THE MEDIAN NERVE
 ;;8716;NEURALGIA OF THE ULNAR NERVE
 ;;8717;NEURALGIA OF MUSCULOCUTANEOUS NERVE
 ;;8718;NEURALGIA OF CIRCUMFLEX NERVE
 ;;8719;NEURALGIA OF LONG THORACIC NERVE
 ;;8720;NEURALGIA OF SCIATIC NERVE
 ;;8721;NEURALGIA OF EXTERNAL POPLITEAL NERVE (COMMON PERONEAL)
 ;;8722;NEURALGIA OF MUSCULOCUTANEOUS NERVE (SUPERFICIAL PERONEAL)
 ;;8723;NEURALGIA OF ANTERIOR TIBIAL NERVE (DEEP PERONEAL)
 ;;8724;NEURALGIA OF INTERNAL POPLITEAL NERVE (TIBIAL)
 ;;8725;NEURALGIA OF POSTERIOR TIBIAL NERVE
 ;;8726;NEURALGIA OF ANTERIOR CRURAL NERVE (FEMORAL)
 ;;8727;NEURALGIA OF INTERNAL SAPHENOUS NERVE
 ;;8728;NEURALGIA OF OBTURATOR NERVE
 ;;8729;NEURALGIA OF EXTERNAL CUTANEOUS NERVE OF THIGH
 ;;8730;NEURALGIA OF ILIO-INGUINAL NERVE
 ;;6200;OTITIS MEDIA, SUPPURATIVE, CHRONIC
 ;;6201;OTITIS MEDIA, CATARRHAL, CHRONIC
 ;;6202;OTOSCLEROSIS
 ;;6203;OTITIS INTERNA
 ;;6204;LABYRINTHITIS, CHRONIC
 ;;6205;MENIERE'S SYNDROME
 ;;6206;MASTOIDITIS
 ;;6207;AURICLE, lOSS OF
 ;;6208;NEW GROWTHS, MALIGNANT, EAR, OTHER THAN OF SKIN ONLY
 ;;6209;NEW GROWTHS, BENIGN, EAR, OTHER THAN OF SKIN ONLY
 ;;6210;AUDITORY CANAL, DISEASE OF
 ;;6211;TYMPANIC MEMBRANE, PERFORATION OF
 ;;6260;TINNITUS
 ;;6100;DEFECTIVE HEARING
 ;;6101;DEFECTIVE HEARING
 ;;6102;DEFECTIVE HEARING
 ;;6103;DEFECTIVE HEARING
 ;;6104;DEFECTIVE HEARING
 ;;6105;DEFECTIVE HEARING
 ;;6106;DEFECTIVE HEARING
 ;;6107;DEFECTIVE HEARING
 ;;6108;DEFECTIVE HEARING
 ;;6109;DEFECTIVE HEARING
 ;;6110;DEFECTIVE HEARING

DVBAPL5
DVBAPL5 ;ALB/CMM LONG DESCRIPTION FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;5104;ANATOMICAL LOSS OF ONE HAND AND LOSS OF USE OF ONE FOOT
 ;;5106;ANATOMICAL LOSS OF BOTH HANDS
 ;;5107;ANATOMICAL LOSS OF BOTH FEET
 ;;5108;ANATOMICAL LOSS OF ONE HAND AND ONE FOOT
 ;;5110;LOSS OF USE OF BOTH FEET
 ;;5120;ARM, AMPUTATION OF, DISARTICULATION OF SHOULDER
 ;;5121;ARM, AMPUTATION OF, ABOVE INSERTION OF DELTOID
 ;;5122;ARM, AMPUTATION OF, BELOW INSERTION OF DELTOID
 ;;5123;FOREARM, AMPUTATION OF, ABOVE INSERTION OF PRONATOR TERES
 ;;5124;FOREARM, AMPUTATION OF, BELOW INSERTION OF PRONATOR TERES
 ;;5125;HAND, LOSS OF USE OF
 ;;5126;AMPUTATION OF FIVE DIGITS OF ONE HAND
 ;;5127;AMPUTATION OF THUMB, INDEX, MIDDLE AND RING FINGERS
 ;;5128;AMPUTATION OF THUMB, INDEX, MIDDLE AND LITTLE FINGERS
 ;;5129;AMPUTATION OF THUMB, INDEX, RING AND LITTLE FINGERS
 ;;5130;AMPUTATION OF THUMB, MIDDLE, RING AND LITTLE FINGERS
 ;;5131;AMPUTATION OF INDEX, MIDDLE, RING AND LITTLE FINGERS
 ;;5132;AMPUTATION OF THUMB, INDEX AND MIDDLE FINGERS
 ;;5133;AMPUTATION OF THUMB, INDEX AND RING FINGERS
 ;;5134;AMPUTATION OF THUMB, INDEX AND LITTLE FINGERS
 ;;5135;AMPUTATION OF THUMB, MIDDLE AND RING FINGERS
 ;;5136;AMPUTATION OF THUMB, MIDDLE AND LITTLE FINGERS
 ;;5137;AMPUTATION OF THUMB, RING AND LITTLE FINGERS
 ;;5138;AMPUTATION OF INDEX, MIDDLE AND RING FINGERS
 ;;5139;AMPUTATION OF INDEX, MIDDLE AND LITTLE FINGERS
 ;;5140;AMPUTATION OF INDEX, RING AND LITTLE FINGERS
 ;;5141;AMPUTATION OF MIDDLE, RING AND LITTLE FINGERS
 ;;5142;AMPUTATION OF THUMB AND INDEX FINGERS
 ;;5143;AMPUTATION OF THUMB AND MIDDLE FINGERS
 ;;5144;AMPUTATION OF THUMB AND RING FINGERS
 ;;5145;AMPUTATION OF THUMB AND LITTLE FINGERS
 ;;5146;AMPUTATION OF INDEX AND MIDDLE FINGERS
 ;;5147;AMPUTATION OF INDEX AND RING FINGERS
 ;;5148;AMPUTATION OF INDEX AND LITTLE FINGERS
 ;;5149;AMPUTATION OF MIDDLE AND RING FINGERS
 ;;5150;AMPUTATION OF MIDDLE AND LITTLE FINGERS
 ;;5151;AMPUTATION OF RING AND LITTLE FINGERS
 ;;5152;AMPUTATION OF THUMB
 ;;5153;AMPUTATION OF INDEX FINGER
 ;;5154;AMPUTATION OF MIDDLE FINGER
 ;;5155;AMPUTATION OF RING FINGER
 ;;5156;AMPUTATION OF LITTLE FINGER
 ;;5160;AMPUTATION OF THIGH, DISARTICULATION OF HIP WITH LOSS OF EXTRINSIC PELVIC GIRDLE MUSCLES
 ;;5161;AMPUTATION OF THIGH, UPPER THIRD, ONE-THIRD OF THE DISTANCE FROM PERINEUM TO KNEE JOINT MEASURED FROM PERINEUM
 ;;5162;AMPUTATION OF THIGH, MIDDLE OR LOWER THIRDS
 ;;5163;AMPUTATION OF LEG, WITH DEFECTIVE STUMP, THIGH, AMPUTATION RECOMMENDED
 ;;5164;AMPUTATION OF LEG, AMPUTATION NOT IMPROVEABLE BY PROSTHESIS CONTROLLED BY NATURAL KNEE ACTION
 ;;5165;AMPUTATION OF LEG AT A LOWER LEVEL, PERMITTING PROSTHESIS
 ;;5166;FOREFOOT, AMPUTATION PROXIMAL TO METATARSAL BONES (MORE THAN ONE-HALF OF METATARSAL LOSS)
 ;;5167;FOOT, LOSE OF USE OF
 ;;5170;AMPUTATION OF ALL TOES WITHOUT METATARSAL LOSS
 ;;5171;AMPUTATION OF GREAT TOE
 ;;5172;AMPUTATION OF TOES OTHER THAN GREAT WITH REMOVAL OF METATARSAL HEAD
 ;;5173;AMPUTATION OF THREE OR FOUR TOES WITHOUT METATARSAL INVOLVEMENT
 ;;5000;OSTEOMYELITIS, ACUTE, SUBACUTE OR CHRONIC
 ;;5010;ARTHRITIS, DUE TO TRAUMA, SUBSTANTIATED BY X-RAY FINDINGS
 ;;5011;BONES, CAISSON DISEASE OF
 ;;5012;BONES, NEW GROWTHS OF, MALIGNANT
 ;;5013;OSTEOPOROSIS, WITH JOINT MANIFESTATIONS
 ;;5014;OSTEOMALACIA
 ;;5015;BONES, NEW GROWTHS OF, BENIGN
 ;;5016;OSTEITIS DEFORMANS

DVBAPL6
DVBAPL6 ;ALB/CMM LONG DESCRIPTION FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;7800;SCARS, DISFIGURING, HEAD, FACE OR NECK
 ;;7803;SCARS, SUPERFICIAL, POORLY NOURISHED, WITH REPEATED ULCERATION
 ;;7804;SCARS, SUPERFICIAL, TENDER AND PAINFUL ON OBJECTIVE DEMONSTRATION
 ;;7805;SCARS, OTHER
 ;;5285;VERTEBRA, FRACTURE OF, RESIDUALS
 ;;5286;SPINE, COMPLETE BONY FIXATION (ANKYLOSIS) OF
 ;;5287;SPINE, ANKYLOSIS OF, CERVICAL
 ;;5288;SPINE, ANKYLOSIS OF, DORSAL
 ;;5289;SPINE, ANKYLOSIS OF, LUMBAR
 ;;5290;SPINE, LIMITATION OF MOTION OF, CERVICAL
 ;;5291;SPINE, LIMITATION OF MOTION OF, DORSAL
 ;;5292;SPINE, LIMITATION OF MOTION OF, LUMBAR
 ;;5293;INTERVERTEBRAL DISC SYNDROME
 ;;5294;SACRO-ILIAC INJURY AND WEAKNESS
 ;;5295;LUMBOSACRAL STRAIN
 ;;5298;COCCYX, REMOVAL OF
 ;;5297;RIBS, REMOVAL OF
 ;;6800;ANTHRACOSIS (BLACK LUNG DISEASE)
 ;;6801;SILICOSIS
 ;;6802;PNEUMOCONIOSIS, UNSPECIFIED
 ;;6803;ACTINOMYCOSIS OF LUNG
 ;;6804;STREPTOTRICHOSIS OF LUNG
 ;;6805;BLASTOMYCOSIS OF LUNG
 ;;6806;SPOROTRICHOSIS OF LUNG
 ;;6807;ASPERGILLOSIS OF LUNG
 ;;6808;MYCOSIS OF LUNG, UNSPECIFIED
 ;;6809;LUNG, ABSCESS OF
 ;;6810;PLEURISY, SEROFIBRINOUS
 ;;6811;PLEURISY, PURULENT (EMPYEMA)
 ;;6812;FISTULA, BRONCHOCUTANEOUS, OR BRONCHOPLEURAL
 ;;6813;LUNG
 ;;6814;PNEUMOTHORAX, SPONTANEOUS, FOR 6 MONTHS
 ;;6815;PNEUMONECTOMY
 ;;6816;LOBECTOMY, BILATERAL OR UNILATERAL
 ;;6817;LUNG, CHRONIC PASSIVE CONGESTION OF
 ;;6818;PLEURAL CAVITY, INJURIES, RESIDUALS OF, INCLUDING GUNSHOT WOUNDS
 ;;6819;NEW GROWTHS OF, MALIGNANT, ANY SPECIFIED PART OF RESPIRATORY SYSTEM EXCLUSIVE OF SKIN GROWTHS
 ;;6820;NEW GROWTHS OF, BENIGN, ANY SPECIFIED PART OF RESPIRATORY SYSTEM
 ;;6821;COCCIDIOIDOMYCOSIS
 ;;6501;RHINITIS, ATROPHIC, CHRONIC
 ;;6502;SEPTUM, NASAL, DEFLECTION OF
 ;;6504;NOSE, LOSS OF PART OF, OR SCARS
 ;;6510;SINUSITIS, PANSINUSITIS, CHRONIC
 ;;6511;SINUSITIS, ETHMOID, CHRONIC
 ;;6512;SINUSITIS, FRONTAL, CHRONIC
 ;;6513;SINUSITIS, MAXILLARY, CHRONIC
 ;;6514;SINUSITIS, SPHENOID, CHRONIC
 ;;6515;LARYNGITIS, TUBERCULOUS, ACTIVE OR INACTIVE
 ;;6516;LARYNGITIS, CHRONIC
 ;;6517;LARYNX, INJURIES OF, HEALED
 ;;6518;LARYNGECTOMY
 ;;6519;APHONIA, ORGANIC
 ;;6520;LARYNX, STENOSIS OF
 ;;6701;TUBERCULOSIS, PULMONARY, CHRONIC, FAR ADVANCED, ACTIVE
 ;;6702;TUBERCULOSIS, PULMONARY, CHRONIC, MODERATELY ADVANCED, ACTIVE
 ;;6703;TUBERCULOSIS, PULMONARY, CHRONIC, MINIMAL, ACTIVE
 ;;6704;TUBERCULOSIS, PULMONARY, CHRONIC, ACTIVE, ADVANCEMENT UNSPECIFIED
 ;;6721;TUBERCULOSIS, PULMONARY, CHRONIC, FAR ADVANCED, INACTIVE
 ;;6722;TUBERCULOSIS, PULMONARY, CHRONIC, MODERATELY ADVANCED, INACTIVE
 ;;6723;TUBERCULOSIS, PULMONARY, CHRONIC, MINIMAL, INACTIVE
 ;;6724;TUBERCULOSIS, PULMONARY, CHRONIC, INACTIVE, ADVANCEMENT UNSPECIFIED
 ;;6730;TUBERCULOSIS, PULMONARY, CHRONIC, ACTIVE
 ;;6731;TUBERCULOSIS, PULMONARY, CHRONIC, INACTIVE
 ;;6732;PLEURISY, TUBERCULOUS, ACTIVE OR INACTIVE
 ;;6600;BRONCHITIS, CHRONIC
 ;;6601;BRONCHIECTASIS
 ;;6602;ASTHMA, BRONCHIAL
 ;;6603;EMPHYSEMA, PULMONARY
 ;;7801;SCARS, BURNS, THIRD DEGREE
 ;;7802;SCARS, BURNS, SECOND DEGREE
 ;;7806;ECZEMA
 ;;7807;LEISHMANIASIS, AMERICANA (MUCOCUTANEOUS, ESPUNDIA)
 ;;7808;LEISHMANIASIS, OLD WORLD (CUTANEOUS, ORIENTAL SORE)
 ;;7809;LUPUS ERYTHEMATOSUS, DISCOID
 ;;7810;PINTA
 ;;7811;TUBERCULOSIS LUPOSA (LUPUS VULGARIS), ACTIVE OR INACTIVE
 ;;7812;VERRUGA PERUANA
 ;;7813;DERMATOPHYTOSIS
 ;;7814;TINEA BARBAE
 ;;7815;PEMPHIGUS
 ;;7816;PSORIASIS
 ;;7817;DERMATITIS EXFOLIATIVA
 ;;7818;NEW GROWTHS, MALIGNANT, SKIN
 ;;7819;NEW GROWTHS, BENIGN, SKIN
 ;;6300;CHOLERA, ASIATIC
 ;;6301;KALA-AZAR (VISCERAL LEISHMANIASIS)
 ;;6302;LEPROSY (HANSEN'S DISEASE)
 ;;6304;MALARIA
 ;;6305;FILARIASIS
 ;;6306;OROYA FEVER
 ;;6307;PLAGUE
 ;;6308;RELAPSING FEVER
 ;;6309;RHEUMATIC FEVER
 ;;6310;SYPHILIS
 ;;6311;TUBERCULOSIS, MILIARY
 ;;6313;AVITAMINOSIS
 ;;6314;BERIBERI
 ;;6315;PELLAGRA
 ;;6316;BRUCELLOSIS (MALTA OR UNDULANT FEVER)
 ;;6317;TYPHUS, SCRUB
 ;;6318;MELIOIDOSIS
 ;;6350;LUPUS ERYTHEMATOSUS, SYSTEMIC (DISSEMINATED)
 ;;6351;HIV-RELATED ILLNESS

DVBAPL7
DVBAPL7 ;ALB/CMM LONG DESCRIPTIONS FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;5001;BONES AND JOINTS, TUBERCULOSIS OF, ACTIVE OR INACTIVE
 ;;5002;ARTHRITIS RHEUMATOID (ATROPHIC) AS AN ACTIVE PROCESS
 ;;5003;ARTHRITIS, DEGENERATIVE (HYPERTROPHIC OR OSTEOARTHRITIS)
 ;;5004;ARTHRITIS, GONORRHEAL
 ;;5005;ARTHRITIS, PNEUMOCOCCIC
 ;;5006;ARTHRITIS, TYPHOID
 ;;5007;ARTHRITIS, SYPHILITIC
 ;;5008;ARTHRITIS, STREPTOCOCCIC
 ;;5009;ARTHRITIS, OTHER TYPES
 ;;5017;GOUT
 ;;5018;HYDRARTHROSIS, INTERMITTENT
 ;;5019;BURSITIS
 ;;5020;SYNOVITIS
 ;;5021;MYOSITIS
 ;;5022;PERIOSTITIS
 ;;5023;MYOSITIS OSSIFICANS
 ;;5024;TENOSYNOVITIS
 ;;5051;SHOULDER REPLACEMENT (PROSTHESIS)
 ;;5052;ELBOW REPLACEMENT (PROSTHESIS)
 ;;5053;WRIST REPLACEMENT (PROSTHESIS)
 ;;5055;KNEE REPLACEMENT (PROSTHESIS)
 ;;5056;ANKLE REPLACEMENT (PROSTHESIS)
 ;;5200;SCAPULOHUMERAL ARTICULATION, ANKYLOSIS OF
 ;;5201;ARM, LIMITATION OF MOTION OF
 ;;5205;ELBOW, ANKYLOSIS OF
 ;;5206;FOREARM, LIMITATION OF FLEXION OF
 ;;5207;FOREARM, LIMITATION OF EXTENSION OF
 ;;5208;FOREARM, FLEXION LIMITED TO 100 DEGREES AND EXTENSION TO 45 DEGREES
 ;;5213;SUPINATION AND PRONATION, IMPAIRMENT OF
 ;;5214;WRIST, ANKYLOSIS OF
 ;;5215;WRIST, LIMITATION OF MOTION OF
 ;;5256;KNEE, ANKYLOSIS OF
 ;;5257;KNEE, OTHER IMPAIRMENT OF
 ;;5258;CARTILAGE, SEMILUNAR, DISLOCATED, WITH FREQUENT EPISODES OF LOCKING, PAIN, AND EFFUSION INTO THE JOINT
 ;;5259;CARTILAGE, SEMILUNAR, REMOVAL OF, SYMPTOMATIC
 ;;5260;LEG, LIMITATION OF FLEXION OF
 ;;5261;LEG, LIMITATION OF EXTENSION OF
 ;;5262;TIBIA AND FIBULA, IMPAIRMENT OF
 ;;5263;GENU RECURVATUM (ACQUIRED, TRAUMATIC, WITH WEAKNESS AND INSECURITY IN WEIGHT-BEARING OBJECTIVELY DEMONSTRATED)
 ;;5270;ANKLE, ANKYLOSIS OF
 ;;5271;ANKLE, LIMITED MOTION OF
 ;;5272;SUBASTRAGALAR OR TARSAL JOINT, ANKYLOSIS OF
 ;;5273;OS CALCIS OR ASTRAGALUS, MALUNION OF
 ;;5274;ASTRAGALECTOMY
 ;;5275;BONES OF THE LOWER EXTREMITY, SHORTENING OF
 ;;5301;GROUP I. EXTRINSIC MUSCLES OF SHOULDER GIRDLE
 ;;5302;GROUP II. EXTRINSIC MUSCLES OF SHOULDER GIRDLE
 ;;5303;GROUP III. INTRINSIC MUSCLES OF SHOULDER GIRDLE
 ;;5304;GROUP IV. INTRINSIC MUSCLES OF SHOULDER GIRDLE
 ;;5305;GROUP V. FLEXOR MUSCLES OF THE ELBOW
 ;;5306;GROUP VI. EXTENSOR MUSCLES OF THE ELBOW
 ;;5307;GROUP VII. MUSCLES ARISING FROM INTERNAL CONDYLE OF HUMERUS
 ;;5308;GROUP VIII. MUSCLES ARISING MAINLY FROM EXTERNAL CONDYLE OF HUMERUS
 ;;5309;GROUP IX. INTRINSIC MUSCLES OF THE HAND
 ;;5310;GROUP X. INTRINSIC MUSCLES OF THE FOOT
 ;;5311;GROUP XI. POSTERIOR AND LATERAL CRURAL MUSCLES
 ;;5312;GROUP XII. ANTERIOR MUSCLES OF THE LEG
 ;;5313;GROUP XIII. POSTERIOR THIGH GROUP
 ;;5314;GROUP XIV. ANTERIOR THIGH GROUP
 ;;5315;GROUP XV. MESIAL THIGH GROUP
 ;;5316;GROUP XVI. PELVIC GIRDLE GROUP 1
 ;;5317;GROUP XVII. PELVIC GIRDLE GROUP 2
 ;;5318;GROUP XVIII. PELVIC GIRDLE GROUP 3
 ;;5319;GROUP XIX. MUSCLES OF THE ABDOMINAL WALL
 ;;5320;GROUP XX. SPINAL MUSCLES
 ;;5321;GROUP XXI. MUSCLES OF RESPIRATION. THORACIC MUSCLE GROUP
 ;;5322;GROUP XXII. LATERAL, SUPRA AND INFRAHYOID GROUP
 ;;5323;GROUP XXIII. LATERAL AND POSTERIOR MUSCLES OF THE NECK
 ;;5324;DIAPHRAGM, RUPTURE OF, WITH HERNIATION
 ;;5325;MUSCLE INJURY, FACIAL MUSCLES
 ;;5326;MUSCLE HERNIA, EXTENSIVE, WITHOUT OTHER INJURY TO THE MUSCLE
 ;;5327;MUSCLE, NEW GROWTH OF, MALIGNANT
 ;;5328;MUSCLE, NEW GROWTH, BENIGN, POSTOPERATIVE
 ;;5329;SOFT-TISSUE SARCOMA (OF MUSCLE, FAT, OR FIBROUS CONNECTIVE TISSUE)

DVBAPL8
DVBAPL8 ;ALB/CMM LONG DESCRIPTIONS FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;6000;UVEITIS
 ;;6001;KERATITIS
 ;;6002;SCLERITIS
 ;;6003;IRITIS
 ;;6004;CYCLITIS
 ;;6005;CHOROIDITIS
 ;;6006;RETINITIS
 ;;6007;HEMORRHAGE, INTRA-OCULAR, RECENT
 ;;6008;RETINA, DETACHMENT OF
 ;;6009;EYE, INJURY OF, UNHEALED
 ;;6010;EYE, TUBERCULOSIS OF, ACTIVE OR INACTIVE
 ;;6011;RETINA, LOCALIZED SCARS, ATROPHY OR IRREGULARITIES OF, CENTRALLY LOCATED, WITH IRREGULAR, DUPLICATED ENLARGED OR DIMINISHED IMAGE
 ;;6012;GLAUCOMA, CONGESTIVE OR INFLAMMATORY
 ;;6013;GLAUCOMA, SIMPLE, PRIMARY, NONCONGESTIVE
 ;;6014;NEW GROWTHS, MALIGNANT (EYEBALL ONLY)
 ;;6015;NEW GROWTHS, BENIGN (EYEBALL AND ADNEXA, OTHER THAN SUPERFICIAL)
 ;;6016;NYSTAGMUS, CENTRAL
 ;;6017;CONJUNCTIVITIS, TRACHOMATOUS, CHRONIC
 ;;6018;CONJUNCTIVITIS, OTHER, CHRONIC
 ;;6019;PTOSIS, UNILATERAL OR BILATERAL
 ;;6020;ECTROPION
 ;;6021;ENTROPION
 ;;6022;LAGOPHTHALMOS
 ;;6023;EYEBROWS, LOSS OF, COMPLETE, UNILATERAL OR BILATERAL
 ;;6024;EYELASHES, LOSS OF, COMPLETE, UNILATERAL OR BILATERAL
 ;;6025;EPIPHORA (LACRYMAL DUCT, INTERFERENCE WITH, FROM ANY CAUSE)
 ;;6026;NEURITIS, OPTIC
 ;;6027;CATARACT, TRAUMATIC
 ;;6028;CATARACT, SENILE, AND OTHERS
 ;;6029;APHAKIA
 ;;6030;ACCOMMODATION, PARALYSIS OF
 ;;6031;DACRYOCYSTITIS
 ;;6032;EYELIDS, LOSS OF PORTION OF
 ;;6033;LENS, CRYSTALLINE, DISLOCATION OF
 ;;6034;PTERYGIUM
 ;;6035;KERATOCONUS
 ;;6061;ANATOMICAL LOSS OF BOTH EYES
 ;;6062;BLINDNESS IN BOTH EYES HAVING ONLY LIGHT PERCEPTION
 ;;6063;ANATOMICAL LOSS OF 1 EYE AND, IN THE OTHER EYE, 5/200 (1.5/60)
 ;;6064;ANATOMCIAL LOSS OF 1 EYE AND, IN THE OTHER EYE, 10/200 (3/60), 15/200 (4.5/60), OR 20/200 (6/60)
 ;;6065;ANATOMICAL LOSS OF 1 EYE AND, IN THE OTHER EYE, 20/100 (6/30), 20/70 (6/21) OR 20/50 (6/15)
 ;;6066;ANATOMICAL LOSS OF 1 EYE AND, IN THE OTHER EYE, 20/40 (6/12)
 ;;6067;BLINDNESS IN 1 EYE, HAVING ONLY LIGHT PERCEPTION, AND, IN THE OTHER EYE, 5/200 (1.5/60)
 ;;6068;BLINDNESS IN 1 EYE, HAVING ONLY LIGHT PERCEPTION, AND, IN THE OTHER EYE, 10/200 (3/60), 15/200 (4.5/60), OR 20/200 (6/60)
 ;;6069;BLINDNESS IN 1 EYE, HAVING ONLY LIGHT PERCEPTION, AND, IN THE OTHER EYE, 20/100 (6/30), 20/70 (6/21), OR 20/50 (6/15)
 ;;6070;BLINDNESS IN 1 EYE, HAVING ONLY LIGHT PERCEPTION, AND, IN THE OTHER EYE, 20/40 (6/12)
 ;;6071;VISION IN 1 EYE 5/200 (1.5/60) AND, IN THE OTHER EYE, 5/200 (1.5/60)
 ;;6072;VISION IN 1 EYE 5/200 (1.5/60) AND, IN THE OTHER EYE, 10/200 (3/60), 15/200 (4.5/60), OR 20/200 (6/60)
 ;;6073;VISION IN 1 EYE 5/200 (1.5/60) AND, IN THE OTHER EYE, 20/100 (6/30), 20/70 (6/21), OR 20/50 (6/15)
 ;;6074;VISION IN 1 EYE 5/200 (1.5/60) AND, IN THE OTHER EYE, 20/40 (6/12)
 ;;6075;DEFECTIVE VISUAL ACUITY
 ;;6076;DEFECTIVE VISUAL ACUITY
 ;;6077;DEFECTIVE VISUAL ACUITY
 ;;6078;DEFECTIVE VISUAL ACUITY
 ;;6079;DEFECTIVE VISUAL ACUITY
 ;;6080;IMPAIRMENT OF FIELD VISION
 ;;6081;SCOTOMA, PATHOLOGICAL, UNILATERAL
 ;;6090;IMPAIRMENT OF MUSCLE FUNCTION (EYE)
 ;;6091;SYMBLEPHARON
 ;;6092;DIPLOPIA, DUE TO LIMITED MUSCLE FUNCTION

DVBAPL9
DVBAPL9 ;ALB/CMM LONG DESCRIPTION FOR FILE 31 UPDATE ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Exam Number ; Long Description
 ;
EN ;
 ;;5202;HUMERUS, OTHER IMPAIRMENT OF
 ;;5203;CLAVICLE OR SCAPULA, IMPAIRMENT OF
 ;;5209;ELBOW, OTHER IMPAIRMENT OF FLAIL JOINT
 ;;5210;RADIUS AND ULNA, NONUNION OF, WITH FLAIL FALSE JOINT
 ;;5211;ULNA, IMPAIRMENT OF
 ;;5212;RADIUS, IMPAIRMENT OF
 ;;5255;FEMUR, IMPAIRMENT OF
 ;;5276;FLATFOOT, ACQUIRED
 ;;5277;WEAK FOOT, BILATERAL
 ;;5278;CLAW FOOT (PES CAVUS), ACQUIRED
 ;;5279;METATARSALGIA, ANTERIOR (MORTON'S DISEASE), UNILATERAL OR BILATERAL
 ;;5280;HALLUX VALGUS, UNILATERAL
 ;;5281;HALLUX RIGIDUS, UNILATERAL, SEVERE
 ;;5282;HAMMER TOE
 ;;5283;TARSAL OR METATARSAL BONES, MALUNION OF, OR NONUNION OF
 ;;5284;FOOT INJURIES, OTHER
 ;;5105;ANATOMICAL LOSS OF ONE FOOT AND LOSS OF USE OF ONE HAND
 ;;5109;LOSS OF USE OF BOTH HANDS
 ;;5111;LOSS OF USE OF ONE HAND AND ONE FOOT
 ;;5216;FIVE DIGITS OF ONE HAND, UNFAVORABLE ANKYLOSIS OF
 ;;5217;FOUR DIGITS OF ONE HAND, UNFAVORABLE ANKYLOSIS OF
 ;;5218;THREE DIGITS OF ONE HAND, UNFAVORABLE ANKYLOSIS OF
 ;;5219;TWO DIGITS OF ONE HAND, UNFAVORABLE ANKYLOSIS OF
 ;;5220;FIVE DIGITS OF ONE HAND, FAVORABLE ANKYLOSIS OF
 ;;5221;FOUR DIGITS OF ONE HAND, FAVORABLE ANKYLOSIS OF
 ;;5222;THREE DIGITS OF ONE HAND, FAVORABLE ANKYLOSIS
 ;;5223;TWO DIGITS OF ONE HAND, FAVORABLE ANKYLOSIS OF
 ;;5224;ANKYLOSIS OF THUMB
 ;;5225;ANKYLOSIS OF INDEX FINGER
 ;;5226;ANKYLOSIS OF MIDDLE FINGER
 ;;5227;ANKYLOSIS OF ANY OTHER FINGER
 ;;5054;HIP REPLACEMENT (PROSTHESIS)
 ;;5250;ANKYLOSIS OF HIP
 ;;5251;THIGH, LIMITATION OF EXTENSION OF
 ;;5252;THIGH, LIMITATION OF FLEXION OF
 ;;5253;THIGH, IMPAIRMENT OF
 ;;5254;HIP, FLAIL JOINT
 ;;5255;FEMUR, IMPAIRMENT OF

DVBAPLL
DVBAPLL ;ALB/JLU;adds to Local Lookup file.;1/24/94
 ;;2.7;AMIE;;Apr 10, 1995
EN ;MAIN ENTRY POINT
 F DVBFILE=31,396.93 DO
 .D SG
 .D CHK ;checks for paramter file entries and file 31 in 8984.4
 .I '$D(STOP) DO  ;stops if something wrong
 ..D ADD ;adds to the 8984.4, 8984.1, 8984.2
 ..Q
 .D EXIT ;kills off variables. *** STOP SHOULD NOT BE KILLED
 .Q
 K DVBFILE
 Q
 ;
SG ;
 N LP1
 S VAR=" - Updating the Local Lookup file for "_$S(DVBFILE=31:"Disability Conditions",1:"Exam Exceptions")
 W !!,VAR
 F LP1=1:1:2 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 Q
EXIT ;
 K VAR,VAR1,VAR2,DIC,X,Y,DA,DR,LP,DIE,ENT,ENT1,STOP
 Q
 ;
CHK ;two checks to ensure proper addition
 N DVBX
 S DVBX=$S(DVBFILE=31:1,1:3)
 S VAR1=$G(^DVB(396.1,1,"POST"))
 S VAR2=$P(VAR1,";",DVBX+1) ;the necessary index for MTLU
 S VAR1=$P(VAR1,";",DVBX) ;the necessary prefix for MTLU
 I VAR1=""!(VAR2="") S STOP=1 D SE3 Q
 ;
 ;look up to see if file 31 already exists in MTLU
 S DIC="^XT(8984.4,",X=$S(DVBFILE=31:31,1:396.93),DIC(0)="MO"
 D ^DIC
 I Y>0 S STOP=1 D SE Q
 K DIC,X,Y
 ;
 ;checks the MTLU file for this prefix var1
 S DIC="^DD(8984.1,.02,""V"",",DIC(0)="Z",D="P",X=VAR1
 D IX^DIC
 I Y>1 S STOP=1 S LP=8984.1 D SE2 K LP Q
 K DIC,X,Y
 ;
 ;checks the MTLU file for this prefix var1
 S DIC="^DD(8984.2,.02,""V"",",DIC(0)="Z",D="P",X=VAR1
 S LP="8984.4"
 D IX^DIC
 I Y>1 S STOP=1 D SE2 K LP Q
 K DIC,X,Y,LP
 Q
 ;
ADD ;adds the new entry to Local Lookup then calls to add to Key word and
 ;Synonym files
 S (DINUM,X)=$S(DVBFILE=31:31,1:396.93),DIC="^XT(8984.4,",DIC(0)="MOZL"
 S DIC("DR")=".02////"_$S(DVBFILE=31:"DVBCLURN",1:"ORPHAN^DVBCLURN")_";.03////"_VAR2
 K DD,DO
 S DLAYGO=8984.4
 D FILE^DICN ;adds to the Local lookup file
 K DLAYGO
 I Y<0 S STOP=1 D SE1
 K DINUM,DD,DO,DIC,X
 Q:$D(STOP)
 S ENT1=Y(0,0)
 S ENT=+Y
 K Y
 D ADDV ; calls off to add to key and syn.
 I '$D(STOP) D SG1
 Q
 ;
ADDV ;Loop to add variable pointer to Local Keyword and Local Synonym files
 F LP="8984.1","8984.2" S (DIE,DIC)="^DD("_LP_",.02,""V"",",DIC(0)="L",X=ENT,DA(1)=.02,DA(2)=LP,DLAYGO=LP D ^DIC K DLAYGO,DIC D SE2:Y<1 Q:Y<1  D S,^DIE
 Q
 ;
S ;setting of a DR string for addition purposes
 S DA=+Y,DR=".02////"_ENT1_";.03////"_DA_";.05////n;.06////n;.04////"_VAR1
 Q
 ;
SE ;if an entry in 8984.4 already exists for file 31
 S VAR="An entry for the "_$S(DVBFILE=31:"'Disability Condition'",1:"'Exam Exception'")_" file in the Local Lookup file already   exists.  Check the AMIE Install Guide for details."
 W !,VAR
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 Q
 ;
SE1 ;
 S VAR="Unable to add the new entry "_$S(DVBFILE=31:"'Disability Condition'",1:"'Exam Exception'")_" to the Local Lookup file.    Check the AMIE Install Guide for details."
 W !!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 Q
 ;
SE2 ;
 S VAR="Unable to add the variable pointer to file "_LP_"  Check the AMIE Install Guide for details."
 W !!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 S STOP=1
 Q
 ;
SE3 ;
 S VAR="Unable to get the proper index and prefix from the AMIE parameter file.  Check  the AMIE Install Guide for details."
 W !!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 Q
 ;
SG1 ;
 S VAR="Local Lookup file updated!"
 W !!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 Q

DVBAPLNG
DVBAPLNG ;ALB/JLU;updates the long description of file 31.;1/18/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN I +$$VERSION^DVBAPST1>2.59 DO  Q
 .S VAR=" - Version 2.6 of AMIE has already been loaded."
 .D BUMPBLK^DVBAPOST
 .D BUMPBLK^DVBAPOST
 .D BUMP^DVBAPOST(VAR)
 .W !!,VAR
 .S VAR="There is no need to add Long Descriptions to the Disability Condition file."
 .D BUMP^DVBAPOST(VAR)
 .W !,VAR,!
 .D BUMPBLK^DVBAPOST
 .Q
 D SET ;sets up variables.
 D LOOP ;loops through tmp global and adds long desc
 D SG1 ;write ending and updates tmp
 D EXIT
 Q
 ;
SET S CT=0
 S DIE="^DIC(31,"
 F LP1=1:1:3 D BUMPBLK^DVBAPOST
 S V1=" - Adding Long Description to the Disability Condition file."
 W !!!,V1,!
 D BUMP^DVBAPOST(V1)
 D BUMPBLK^DVBAPOST
SET1 S DIF="^TMP($J,""DVBA"",",XCNP=0
 K ^TMP($J,"DVBA")
 N R
 F R="DVBAPL1","DVBAPL2","DVBAPL3","DVBAPL4","DVBAPL5","DVBAPL6","DVBAPL7","DVBAPL8","DVBAPL9","DVBAPL10" S X=R X ^%ZOSF("LOAD") W "."
 K DIF,XCNP,R,X
 Q
 ;
EXIT ;cleans variables and exit.
 K CODE,CT,DIE,JA,JB,LP,LP1,V1,TEXT,DIR,^TMP($J,"DVBA")
 Q
 ;
SE ;writes and updates the tmp global with error message.
 ;
 S V1="- Problems exist with the disability condition "_CODE_"."
 W !,V1
 D BUMP^DVBAPOST(V1)
 S V1=" Long description NOT added!"
 W !,V1
 D BUMP^DVBAPOST(V1)
 Q
 ;
SG1 ;writes and updates the tmp global with the finish.
 ;
 F LP1=1:1:2 D BUMPBLK^DVBAPOST
 S V1="I have finished updating the long descriptions of the Disability Condition file!"
 W !!,V1
 D BUMP^DVBAPOST(V1)
 S V1="I updated "_CT_" disabilities."
 W !,V1
 D BUMP^DVBAPOST(V1)
 D BUMPBLK^DVBAPOST
 Q
 ;
LOOP ;loops through tmp and updates file 31 long description field.
 ;
 F LP=0:0 S LP=$O(^TMP($J,"DVBA",LP)) Q:LP=""  I $D(^(LP,0)) S CODE=$P(^(0),";;",2) I +CODE DO
 .S TEXT=$P(CODE,";",2)
 .S CODE=+CODE
 .K STOP
 .DO ADCHK
 .I $D(STOP) Q
 .Q
 Q
 ;
ADCHK ;checks to see if the disability code exists and if it already has a
 ;long description.
 ;
 I CODE<4900 S STOP=1 Q
 I '$D(^DIC(31,"C",CODE)) D SE S STOP=1 Q
 S JA=$O(^DIC(31,"C",CODE,""))
 I '$D(^DIC(31,JA,0)) D SE S STOP=1 Q
 S JB=$G(^DIC(31,JA,1))
 I JB=""!($P(JB,U,1)'=TEXT) DO ADD
 Q
 ;
ADD ;adds the long description to file 31 long description field.
 ;
 S DA=JA
 S DR="10////"_TEXT
 D ^DIE
 K DA,DR
 S CT=CT+1
 W:'(LP#10) "."
 Q

DVBAPND1
DVBAPND1 ;ALB ISC/GTS-AMIE PENDING RPT UT ;13 JAN 93@08:10 ; 7/2/90  2:48 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;  ** The following routines are called from DVBAPEND **
SORTDIV W !!,"Sort by Division" S %=1 D YN^DICN
 I $D(DTOUT)!(%<0) K DTOUT S Y=-1 Q
 I $D(%Y),(%Y["?") W !!,*7,"Enter Y to sort by the Division you"
 I $D(%Y),(%Y["?") W !,"select or enter N to report ALL Divisions."
 I $D(%Y),(%Y["?") G SORTDIV
 I %'=1 S SELDIV="N",DIVNUM=0 Q
 I %=1 S SELDIV="Y" G ENTDIV
 W !,*7,"Invalid response.",!! G SORTDIV
 ;  ** Allow user to enter a selected Division to report **
ENTDIV S DIC="^DG(40.8,",DIC(0)="AEMQ",DIC("A")="Division number: "
 D ^DIC K DIC S DIVNUM=+Y
 S DIVNAM=$S($D(^DG(40.8,+Y,0)):$P(^(0),"^",1),1:"Unknown Division")
 Q
 ;
DCHGDT S DCHGDT="",DCHPTR=$P(^DGPM(XJ,0),U,17),XADMDT=$P(^(0),U,1) I DCHPTR]"",$D(^DGPM(+DCHPTR,0)) S DCHGDT=$P(^DGPM(+DCHPTR,0),U,1)
 K DCHPTR
 Q
 ;
PRINT S DOCTYPE=$S($D(^DVB(396,DA,2)):$P(^(2),U,10),1:""),DFN=$P(^DVB(396,DA,0),U,1),ADMDT=$P(^(0),U,4),RDATE=$P(^(1),U,1),PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^(.31)):$P(^(.31),U,3),1:"UNKNOWN")
 I RO="Y" S CFLOC=$$STATION^DVBAUTL1(DFN),CFLOC=$S(CFLOC>0:CFLOC,1:9999) Q:CFLOC'=RONUM&(CFLOC'=0)&(CFLOC'=376)
 K ^TMP("DVBA","ADMIT",$J)
 F XI=0:0 S XI=$O(^DGPM("APTT1",DFN,XI)) Q:XI=""  F XJ=0:0 S XJ=$O(^DGPM("APTT1",DFN,XI,XJ)) Q:XJ=""  D DCHGDT S ^TMP("DVBA","ADMIT",$J,XADMDT,DFN)=XI_U_DCHGDT
 W:SELDIV="Y" !,?10,"Division: "_ADIV,!
 W:SELDIV="N" !,?10,"Original Division: "_ADIV,!
 W !,PNAM,?49,"SSN: ",SSN,!,?44,"Claim no: ",CNUM,!,?38,$S(DOCTYPE="L":" Activity date: ",1:"Admission date: "),$E(ADMDT,4,5),"/",$E(ADMDT,6,7),"/",$E(ADMDT,2,3),!,?40,"Request date: ",$E(RDATE,4,5),"/",$E(RDATE,6,7),"/",$E(RDATE,2,3)
 S DCHGDT="" I $D(^TMP("DVBA","ADMIT",$J,+ADMDT,DFN)) S DCHGDT=$P(^TMP("DVBA","ADMIT",$J,+ADMDT,DFN),U,2)
 D ELAPSED
 W ! I DCHGDT]"" S Y=DCHGDT X DVBADD W "** Discharged: ",Y
 W ?40,"Elapsed days: ",EDAYS,!!,?3,"Items Pending:"
ITEMS F Q=9,11,13,15,17,19,21,23,26,28 I $P(^DVB(396,DA,0),U,Q)="P" D PRINT1 Q:DVBAQUIT=1
 S Q=7 I $P(^DVB(396,DA,1),U,Q)="P" D PRINT1 Q:DVBAQUIT=1
 W !! W:$D(^DVB(396,DA,2)) "Requested by: ",$S($P(^DVB(396,DA,2),U,8)]"":$P(^(2),U,8),1:" (Not specified) ")," AT ",$S($P(^(2),U,7)]"":$P(^(2),U,7),1:" (Not specified) "),! F L=1:1:79 W "-"
 W !
 D TOP Q:DVBAQUIT=1
 Q
 ;
PRINT1 S:$D(^DVB(396,DA,6)) GDIVPTR=$P(^DVB(396,DA,6),"^",Q)
 S:'$D(^DVB(396,DA,6)) GDIVPTR=$P(^DVB(396,DA,2),"^",9)
 S:+GDIVPTR>0 GDIVNAM=$P(^DG(40.8,GDIVPTR,0),"^",1)
 S:+GDIVPTR'>0 GDIVNAM=""
 S NODTA=1 I QQ S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(9+(23-$L(MC))))_")" W !,?8,MD,GDIV S QQ='QQ Q
 I 'QQ S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(9+(23-$L(MC))))_")" W ?46,MD,GDIV S QQ='QQ I $Y>22 D TOP Q:DVBAQUIT=1
 Q
 ;
TOP I IOST?1"C-".E,'$D(NOASK) W !!,*7,"Press RETURN to continue or ""^"" to exit   " R ANS:DTIME W @IOF I ANS=U!('$T) S DVBAQUIT=1 Q
 I $Y'<53 D HEADER
 Q
 ;
ELAPSED K EDAYS,X1,X S X1=DT,X=RDATE D ^XUWORKDY
 S EDAYS=X
 Q
 ;
HEADER S PG=PG+1 W:(IOST?1"C-".E)!(PG>1) @IOF,!
 W ?(80-$L(HEAD)\2),HEAD,?71,"Page: ",PG,! I HEAD2]"" W ?(80-$L(HEAD2)\2),HEAD2,!
 W ?(80-$L(PROCDT)\2),PROCDT,!!
 Q
FIELDS ;
7 ;;ADMISSION RPT
9 ;;NOTICE OF DISCHARGE
11 ;;HOSPITAL SUMMARY
13 ;;21-DAY CERTIFICATE
15 ;;OTHER/EXAM REVIEW RMKS
17 ;;SPECIAL REPORT
19 ;;COMPETENCY REPORT
21 ;;VA FORM 21-2680
23 ;;ASSET INFORMATION
26 ;;OPT TREATMENT REPORT
28 ;;BEGINNING DATE/CARE
 Q

DVBAPOK1
DVBAPOK1 ;ALB/JLU;data routine for orphan key words
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;The format is orphan title^keyword;keyword
 ;
EN ;
 ;;FORMER PRISONER OF WAR, GENERAL MEDICAL^POW
 ;;FORMER PRISONER OF WAR, MENTAL DISORDERS^POW

DVBAPOKY
DVBAPOKY ;ALB/JLU;orphan keyword;9/16/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;
 D SET
 D LOOP
 D SG1
 D EXIT
 Q
SET N VAR
 S VAR=" - Adding Orphan keywords to Local Keyword File.",KWCNT=0
 W !!!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
SET1 ;
 S DIF="^TMP($J,""DVBA"",",XCNP=0
 K ^TMP($J,"DVBA")
 F ROU="DVBAPOK1" S X=ROU X ^%ZOSF("LOAD") W "."
 K DIF,XCNP,ROU,X
 Q
LOOP ; ** Loop through text lines in Routine files DVBAPOK# **
 N LP,KW,KWPCE,LP2
 S LP=0
 F  S LP=$O(^TMP($J,"DVBA",LP)) Q:(LP="")  I $D(^TMP($J,"DVBA",LP,0)) S LINE=^TMP($J,"DVBA",LP,0) DO
 .I (LINE[";;"),(LINE'[";AMIE;"),(LINE'="") DO
 ..W:(LP#10) "."
 ..S TITLE=$P(LINE,U,1)
 ..S TITLE=$P(TITLE,";;",2)
 ..S KW=$P(LINE,U,2)
 ..F LP2=1:1 S KWPCE=$P(KW,";",LP2) Q:KWPCE=""  DO
 ...K STOP
 ...D DCH
 ...D:'$D(STOP) ADDKW
 Q
 ;
ADDKW ; ** Add a KEYWORD to the lookup file **
 K DIC,DA,DR,DLAYGO,Y,DD,DO
 D SETUP
 I $D(STOP) Q
 S DIC="^XT(8984.1,",DIC(0)="LX",DLAYGO="8984.1"
 S DIC("DR")=".02////^S X=DVBAVAR"
 S X=KWPCE D FILE^DICN
 I Y<0 D SE
 I Y'<0 S KWCNT=KWCNT+1
 K DA,DR,DIC,DLAYGO,Y,DD,DO,X
 Q
SE ;
 N VAR
 S VAR="Addition of Keyword "_KWPCE_" for orphan "_TITLE_" has Failed.  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
SE1 ;
 N VAR
 S VAR="Could not find the  "_TITLE_" entry in the 'B' X-ref.  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
DCH ;
 N LP1,LP2,KWPCEX
 S KWPCEX=$E(KWPCE,1,30)
 F LP1=0:0 S LP1=$O(^XT(8984.1,"B",KWPCEX,LP1)) Q:'LP1!($D(STOP))  DO
 .I $P(^XT(8984.1,LP1,0),U,1)=KWPCE DO
 ..S JC=$O(^DVB(396.93,"B",$E(TITLE,1,30),""))
 ..I JC="" D SE1 S STOP=1 I 1
 ..E  S LP2=JC_";DVB(396.93," I $P(^XT(8984.1,LP1,0),U,2)=LP2 S STOP=1
 Q
 ;
SG1 ;writes and updates the tmp global at completion
 N LP1,V1
 F LP1=1:1:2 D BUMPBLK^DVBAPOST
 S V1="The Local Keyword file has completed update of "_KWCNT_" orphans!"
 W !!,V1
 D BUMP^DVBAPOST(V1)
 D BUMPBLK^DVBAPOST
 Q
EXIT ;
 K X,Y,STOP,LINE,^TMP($J,"DVBA"),PREFIX,TITLE,KWCNT,JC
 Q
SETUP ;gets the first entry in 396.93
 S DVBAVAR=$O(^DVB(396.93,"B",$E(TITLE,1,30),""))
 I DVBAVAR="" D SE1 S STOP=1 Q
 I '$D(^DVB(396.93,DVBAVAR,0)) D SE2 S STOP=1 Q
 S DVBAVAR=DVBAVAR_";DVB(396.93,"
 Q
SE2 ;
 N VA
 S VAR="Zero node of the "_TITLE_" entry does not exist.  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q

DVBAPOP2
DVBAPOP2 ;ALB/JLU;another post init population routine
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SETPTR ;This entry point sets up the pointers from file 396.6 to 396.7
 ;this data could not come in with difrom because difrom does not
 ;evaluate pointers.
 ;
 N DVBX,DVBX1,DVBX2,DVBX3,DVBX4,VAR
 S DVBX3=0
 F DVBX=1:1 S DVBX1=$T(EXAM+DVBX) Q:DVBX1'[";;"  DO
 .S DVBX1=$P(DVBX1,";;",2)
 .S DVBX2=$P(DVBX1,U,2)
 .S DVBX1=$P(DVBX1,U,1)
 .S IEN3966=$$IEN6^DVBAPOPU(DVBX1)
 .Q:'+IEN3966
 .S IEN3967=$$IEN7^DVBAPOPU(DVBX2)
 .Q:'+IEN3967
 .I $P(^DVB(396.6,IEN3966,0),U,3)'=IEN3967 DO
 ..S DVBX4=$P(^DVB(396.6,IEN3966,0),U,3)
 ..S DIE="^DVB(396.6,",DA=IEN3966,DR="2////"_IEN3967
 ..D ^DIE
 ..S DVBX3=DVBX3+1
 ..D BUMPBLK^DVBAPOST
 ..S VAR="Changed record "_IEN3966_" of the AMIE Exam File from  "_DVBX4_" to "_IEN3967
 ..W !,VAR D BUMP^DVBAPOST(VAR)
 ..Q
 .Q
 S VAR=" - Updating AMIE Exam file pointers to the 2507 Body System file is complete"
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 W !!,VAR D BUMP^DVBAPOST(VAR)
 S VAR=DVBX3_" records were updated."
 W !,VAR D BUMP^DVBAPOST(VAR)
 Q
 ;
EXAM ;
 ;;AGENT ORANGE^SPECIAL
 ;;AID AND ATTENDANCE/HOUSEBOUND^SPECIAL
 ;;ALIMENTARY APPENDAGES^DIGESTIVE
 ;;AMPUTATION STUMPS^ORTHOPEDIC
 ;;AUDIO^ORGANS OF SENSE
 ;;AUDIO-EAR DISEASE^ORGANS OF SENSE
 ;;BONES^ORTHOPEDIC
 ;;CARDIOVASCULAR (NEC)^CARDIOVASCULAR
 ;;CRANIAL NERVES^NEUROLOGICAL
 ;;CYSTITIS,BLADDER CALC.,BLADDER INJURY,PROSTATE,SURG. RESID.^GENITOURINARY
 ;;DENTAL^DENTAL
 ;;DIABETES INSIPIDUS^ENDOCRINE
 ;;DIABETES MELLITUS^ENDOCRINE
 ;;DIGESTIVE (NEC)^DIGESTIVE
 ;;DISEASES OF ARTERIES/VEINS^CARDIOVASCULAR
 ;;DISEASES OF THE HEART^CARDIOVASCULAR
 ;;DISEASES/INJURIES OF THE BRAIN^NEUROLOGICAL
 ;;DISEASES/INJURIES OF THE SPINAL CORD^NEUROLOGICAL
 ;;ENDOCRINE DISORDERS (NEC)^ENDOCRINE
 ;;EPILEPSY AND NARCOLEPSY^NEUROLOGICAL
 ;;ESOPHAGUS^DIGESTIVE
 ;;FEET^ORTHOPEDIC
 ;;GENERAL MEDICAL^GENERAL MEDICAL
 ;;GENITOURINARY (NEC)^GENITOURINARY
 ;;GYNECOLOGICAL^GYNECOLOGICAL
 ;;GYNECOLOGICAL (NEC)^GYNECOLOGICAL
 ;;HAND, THUMB, FINGERS^ORTHOPEDIC
 ;;HEMATOLOGIC DISORDERS^HEMATOLOGICAL
 ;;HEMATOLOGIC DISORDERS-BLOOD^HEMATOLOGICAL
 ;;HEMATOLOGIC DISORDERS-LYMPHATIC^HEMATOLOGICAL
 ;;HEMATOLOGICAL (NEC)^HEMATOLOGICAL
 ;;HIGHER LEVEL AID AND ATTENDANCE^SPECIAL
 ;;HIP^ORTHOPEDIC
 ;;HYPERPARATHYROIDISM^ENDOCRINE
 ;;HYPERPITUITARISM (CUSHINGS SYNDROME)^ENDOCRINE
 ;;HYPERTENSION^CARDIOVASCULAR
 ;;HYPERTHYROIDISM, THYROID ADENOMA^ENDOCRINE
 ;;HYPOTHYROIDISM^ENDOCRINE
 ;;INTESTINE^DIGESTIVE
 ;;JOINTS^ORTHOPEDIC
 ;;LOSS OF PENIS, ALL OR PARTIAL^GENITOURINARY
 ;;MALIGNANCIES OR TUBERCULOSIS^GENITOURINARY
 ;;MAMMARY^GYNECOLOGICAL
 ;;MENTAL (NEC)^MENTAL
 ;;MENTAL DISORDERS^MENTAL
 ;;MISCELLANEOUS NEUROLOGICAL DISORDERS^NEUROLOGICAL
 ;;MOUTH AND THROAT^ORGANS OF SENSE
 ;;MUSCLES^ORTHOPEDIC
 ;;MUSCULOSKELETAL (NEC)^ORTHOPEDIC
 ;;NECK - NOT SPINAL CONDITION^ORTHOPEDIC
 ;;NEPHRITIS, ALL FORMS EXCEPT CHRONIC PYELONEPHRITIS^NEPHROLOGICAL
 ;;NEPHROLOGICAL^NEPHROLOGICAL
 ;;NEPHROLOGICAL (NEC)^NEPHROLOGICAL
 ;;NEUROLOGICAL (NEC)^NEUROLOGICAL
 ;;NON-TUBERCULOSIS DISEASES AND INJURIES^PULMONARY
 ;;NOSE AND SINUSES^ORGANS OF SENSE
 ;;NOSE AND THROAT (PULMONARY)^PULMONARY
 ;;ORGANS OF SENSE (NEC)^ORGANS OF SENSE
 ;;OTHER GENITOURINARY^GENITOURINARY
 ;;PERIPHERAL NERVES^NEUROLOGICAL
 ;;PITUITARY TUMORS^ENDOCRINE
 ;;POST-TRAUMATIC STRESS DISORDER^MENTAL
 ;;PRISONER OF WAR^SPECIAL
 ;;PULMONARY (NEC)^PULMONARY
 ;;PULMONARY TUBERCULOSIS AND TUBERCULOSIS DISEASES^PULMONARY
 ;;PYELITIS, NEPHROLITHIAIS, ETC.^GENITOURINARY
 ;;RECTUM AND ANUS^DIGESTIVE
 ;;REGULAR AID AND ATTENDANCE/HOUSEBOUND^SPECIAL
 ;;RESPIRATORY MANIF. OF DISEASES OF OTHER SYSTEMS^PULMONARY
 ;;SCARS^ORTHOPEDIC
 ;;SCARS (BURN)^SKIN
 ;;SCARS (SKIN)^SKIN
 ;;SENSE OF SMELL^ORGANS OF SENSE
 ;;SENSE OF TASTE^ORGANS OF SENSE
 ;;SKIN (NEC)^SKIN
 ;;SKIN (OTHER THAN SCARS)^SKIN
 ;;SPINE^ORTHOPEDIC
 ;;STOMACH^DIGESTIVE
 ;;SYSTEMIC CONDITIONS^SYSTEMIC
 ;;TESTES, TRAUMA OR DISEASE^GENITOURINARY
 ;;TRACHEA AND BRONCHI^PULMONARY
 ;;URETHRAL FISTULA^GENITOURINARY
 ;;VISUAL^ORGANS OF SENSE

DVBAPOPU
DVBAPOPU ;ALB/JLU;utility routine for post inits;9/1/94
 ;;2.7;AMIE;;Apr 10, 1995
EN ;the main entry point
 D SETPURG
 Q
 ;
SETPURG ;this set up the DAYS TO KEEP 2507 HISTORY parameter.
 N PAR
 S VAR=" - Checking 2507 purge parameter"
 W !!,VAR
 D BUMPBLK^DVBAPOST,BUMPBLK^DVBAPOST,BUMP^DVBAPOST(VAR)
 K VAR
 S PAR=$$IFNPAR^DVBAUTL3
 I 'PAR DO  I 1
 .N VAR
 .S VAR="No parameter file entry exists!"
 .W *7,!!,VAR
 .D BUMPBLK^DVBAPOST,BUMPBLK^DVBAPOST,BUMP^DVBAPOST(VAR)
 .S VAR="Consult the AMIE installation manual for further details."
 .W !,VAR
 .D BUMP^DVBAPOST(VAR)
 .Q
 E  DO
 .I +$P(^DVB(396.1,PAR,0),U,11)>119 Q
 .S $P(^DVB(396.1,PAR,0),U,11)=120
 .Q
 Q
 ;
IEN6(X) ;this entry point returns the internal value of the amie exam file
 ;a null is returned if not found.
 ;
 N X1
 S X1=$O(^DVB(396.6,"B",$E(X,1,30),0))
 I X1="" D ERR1("AMIE EXAM file",X) Q X1
 I '$D(^DVB(396.6,X1,0)) D ERR2("AMIE EXAM file",X) S X1=""
 Q X1
 ;
IEN7(X) ;this entry point returns the internal value of the amie 2507 BODY SYSTEM
 ;file.
 ;a null is returned if not found.
 ;
 N X1
 S X1=$O(^DVB(396.7,"B",X,0))
 I X1="" D ERR1("2507 BODY SYSTEM file",X) Q X1
 I '$D(^DVB(396.7,X1,0)) D ERR2("2507 BODY SYSTEM file",X) S X1=""
 Q X1
 ;
ERR1(A,B) ;this entry point is to inform the user of an error in the
 ;B cross reference of the file
 ;A is the file name
 ;B is the entry number
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 S VAR="The entry "_B_" is not defined in "_A
 W !,VAR D BUMP^DVBAPOST(VAR)
 S VAR="Consult the AMIE Install Guide for details"
 W !,VAR D BUMP^DVBAPOST(VAR)
 Q
 ;
ERR2(A,B) ;this entry point is to inform the user of an error in the
 ;the zero node of the file
 ;A is the file name
 ;B is the entry number
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 S VAR="The zero node of the entry "_B_" is missing in the "_A
 W !,VAR D BUMP^DVBAPOST(VAR)
 S VAR="Consult the AMIE Install Guide for details"
 W !,VAR D BUMP^DVBAPOST(VAR)
 Q
 ;
DELETE ;this entry point is used to kill the files 396.91, and 396.92
 N VAR
 K ^DVBP(396.91)
 K ^DVBP(396.92)
 S VAR(1,0)="0,0,0,1,0^Removal of data from file 396.91 and 396.92 is complete!"
 D WR^DVBAUTL4("VAR")
 Q

DVBAPOST
DVBAPOST ;ALBANY-ISC/GTS-AMIE 2.6 POST-INIT RTN ;1/15/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN D SET1^DVBAUTL1
 K ^TMP("DVBA",$J)
 W !,"Setting up List Manager Templates",!
 D ^DVBAL ;set up templates used by List Manager screens
 D ^DVBAONIT ;calls the onits to set up the List Manager screens/actions
 D REINDAC^DVBAPST1
 D REINDAF^DVBAPST1
 D REINDAE^DVBAPST1
EN12 D ^DVBAPOPU ;populates various global information
EN14 D ^DVBAPOP2 ;populates the pointer field of 396.6
EN11 D EN^DVBAPADD ;adds new disability conditions
EN10 D ^DVBAORPH ;adds orphan exams.
EN1 K STOP
 D CHECK ; checks if pre init ran ok.
 I $D(STOP) D SE G MAIL ;stops if pre init did not run ok.
EN2 D EN^DVBAPLNG ;updates the long description of file 31.
EN3 K STOP
 D EN^DVBAPLL ;updates the local lookup file with file 31.
 I $D(STOP) D SE1 G MAIL ;stops if problems adding to Local Lookup file.
 D ORPHAN^DVBAPCXR
EN4 ;;;D EN^DVBAPSHT ;enters the short cuts into the MTLU files. (DVBAPH1-99)
EN5 D EN^DVBAPKY ;enters the keywords into the MTLU files. (DVBAPK1-99)
EN13 D EN^DVBAPOKY ;enters the orphan keywords into the MTLU files. (DVBAPOK1)
EN6 D EN^DVBAPSYN ;enters the synonyms into the MTLU files. (DVBAPS1-99)
EN7 D EN^DVBAPBDY ;enters the disability codes into the body system file. (DVBAPB1-99)
EN8 D EN^DVBAPWKS ;enters the disability codes into the AMIE worksheets. (DVBAPW1-99)
 D FINISHED ;prints out a completed message
MAIL S V3=$$MAL($J) ;builds and sends the mail message from the post init running
 D EXIT^DVBAUTL1
 Q
 ;
FINISHED ;
 N VAR
 S VAR="The Post-Init has completed."
 W *7,!!!,VAR
 D BUMP(VAR)
 Q
 ;
CHECK ;checks for the 'post' node to see if the pre init ran ok.
 I '$D(^DVB(396.1,1,"POST")) S STOP=1 Q
 I ^DVB(396.1,1,"POST")']"" S STOP=1 Q
 Q
MAL(V2) ;builds a mail message and sends to the DUZ defined.  v2 must be the
 ;$J from the job of the post init.
 ;
 N LNE,LNCNT
 S XMDUZ="AMIE POST INIT"
 S XMSUB="AMIE v2.7 install results"
 D XMZ^XMA2 ;** Get message number
 I XMZ'>0 DO
 .W !!,"Mail Message containing Error Log has failed!",!
 .W "Errors contained in ^TMP(""DVBA"","_V2_") global.",!
 .W "Investigate this global to determine any existing problems."
 .W !!
 I XMZ>0 DO
 .F LNE=0:0 S LNE=$O(^TMP("DVBA",V2,LNE)) Q:'LNE  DO
 ..S ^XMB(3.9,XMZ,2,LNE,0)=(^TMP("DVBA",V2,LNE)),LNCNT=LNE
 .S ^XMB(3.9,XMZ,2,0)="^3.92A^"_LNCNT_"^"_LNCNT_"^"_DT
 .K XMDUN
 .S (XMY(DUZ),XMY(.5))=""
 .D ENT1^XMD
 .W !!,"Mail message containing Error Log has been sent.",!
 .W "Check your mail to see this log.",!!
 .K ^TMP("DVBA",V2)
 Q 1
 ;
SET ;set necessary local variables
 S CNT=1
 Q
 ;
SE S VAR="The pre-init found a problem in the version of MTLU and KERNEL."
 W !!,VAR D BUMPBLK,BUMP(VAR)
 S VAR="Please review and correct.  See install guide for further details."
 W !,VAR D BUMP(VAR)
 S VAR="No updates have occurred to the following files:"
 W !,VAR D BUMP(VAR)
 S VAR="      Local Lookup"
 W !,VAR D BUMP(VAR)
 S VAR="      Local keyword"
 W !,VAR D BUMP(VAR)
 S VAR="      Local Synonym"
 W !,VAR D BUMP(VAR)
 ;;;S VAR="      Local Shortcut"
 ;;;W !,VAR D BUMP(VAR)
 S VAR="      2507 Body System"
 W !,VAR D BUMP(VAR)
 S VAR="      AMIE Exam file."
 W !,VAR D BUMP(VAR)
 S VAR="      Long Descriptions of the Disability Condition file."
 W !,VAR D BUMP(VAR)
 Q
 ;
SE1 ;
 S VAR="The post init could not add to the Local Lookup file."
 W !!,VAR D BUMPBLK,BUMP(VAR)
 S VAR="No updates have occurred to the following files:"
 W !,VAR D BUMP(VAR)
 S VAR="      Local keyword"
 W !,VAR D BUMP(VAR)
 S VAR="      Local Synonym"
 W !,VAR D BUMP(VAR)
 S VAR="      Local Shortcut"
 W !,VAR D BUMP(VAR)
 S VAR="      2507 Body System"
 W !,VAR D BUMP(VAR)
 S VAR="      AMIE Exam file."
 W !,VAR D BUMP(VAR)
 Q
 ;
BUMP(V1) ;adds the entry and bumps the general counter.
 S ^TMP("DVBA",$J,CNT)=V1
 S CNT=CNT+1
 Q
 ;
BUMPBLK ;adds a blank line to the array
 S ^TMP("DVBA",$J,CNT)=""
 S CNT=CNT+1
 Q
 ;
OPEN F LP3=1:1 S LP4=$T(OPT+LP3) Q:LP4'[";;"  S LP4=$P(LP4,";;",2) DO
 .S DIC="^DIC(19,",DIC(0)="MZ",X=LP4
 .D ^DIC
 .K DIC
 .I Y<0 D ERR Q
 .I Y>0 DO
 ..S DIE="^DIC(19,",DIC(0)="MZ",DA=+Y,DR="2///@"
 ..D ^DIE
 ..W !,LP4," Now in order!"
 ..K DIE,DIC,VAR,DR
 ..Q
 .K Y
 .Q
 K DIC,DIE,X,Y,DA,DR
 S DIC="^ORD(101,",DIC(0)="MZ",X="DVBA C&P SCHD EVENT"
 D ^DIC
 K DIC
 I Y<0 D ERR
 I Y>0 DO
 .S DIE="^ORD(101,",DIC(0)="MZ",DA=+Y,DR="2///@"
 .D ^DIE
 .W !,"DVBA C&P SCHD EVENT Now in order!"
 K DIC,DIE,X,Y,LP3,LP4,DA,DR
 Q
 ;
ERR ;
 W "Could not find menu option ",X," NOT opened!"
 Q
 ;
OPT ;
 ;;DVBA MEDICAL ADM 7131 MENU
 ;;DVBA REGIONAL OFFICE MENU
 ;;DVBA C PROCESS MAIL MESSAGE
 ;;DVBA C PHYSICIANS GUIDE
 ;

DVBAPRE
DVBAPRE ;ALB ISC/JLU-PREINIT ROUTINE ;02/02/91
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN S CNT=1
 D REMD
 D CORSPEL
 Q
 ;
REMD ;this entry point is to remove the 'D' cross reference in file 396.3
 D BUMPBLK^DVBAPOST,BUMPBLK^DVBAPOST,BUMPBLK^DVBAPOST
 S VAR="Removing the 'D' cross reference from file 396.3"
 D BUMP^DVBAPOST(VAR)
 W !,VAR
REMD1 ;gets you around the displays
 N JL
 S JL=0
 F  S JL=$O(^DD(396.3,17,1,JL)) Q:'JL  I $D(^(JL,0)),^(0)="396.3^D^MUMPS" DO  Q
 .S DIK="^DD(396.3,17,1,",DA(2)=396.3,DA(1)=17,DA=JL
 .D ^DIK
 .K ^DVB(396.3,"D")
 .S VAR="Cross reference and data for 'D' in 396.3 deleted!"
 .D BUMP^DVBAPOST(VAR)
 .D BUMPBLK^DVBAPOST
 .D BUMPBLK^DVBAPOST
 .W !,VAR
 .K DIK,DA
 .Q
 ;
REMC ;to remove the 'C' cross reference
 S VAR="Removing the 'C' cross reference from 396"
 D BUMP^DVBAPOST(VAR)
 W !!,VAR
REMC1 ;around the displays
 N JL
 S JL=0
 F  S JL=$O(^DD(396,6.82,1,JL)) Q:'JL  I $D(^(JL,0)),^(0)="396^C^MUMPS" DO  Q
 .S DIK="^DD(396,6.82,1,",DA(2)=396,DA(1)=6.82,DA=JL
 .D ^DIK
 .K ^DVB(396,"C")
 .S VAR="Cross reference and data for 'C' in 396 deleted!"
 .D BUMP^DVBAPOST(VAR)
 .W !,VAR
 .K DI,DA
 .Q
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 Q
 ;
CORSPEL ;this subroutine is to correct the spelling of an entry in 396.6
 ;It should be removed for future versions of AMIE.
 ;
 N DVBAPRE
 S DVBAPRE=$O(^DVB(396.6,"B","EPILEPESY AND NARCOLEPSY",""))
 I DVBAPRE DO
 .S DIE="^DVB(396.6,",DA=DVBAPRE,DR=".01///EPILEPSY AND NARCOLEPSY"
 .D ^DIE
 .K DIE,DA,DR
 .S VAR="Renaming of ""EPILEPESY AND NARCOLEPSY"" to ""EPILEPSY AND NARCOLEPSY"" is complete!"
 .D BUMPBLK^DVBAPOST
 .D BUMPBLK^DVBAPOST
 .W !!,VAR,!!
 .D BUMP^DVBAPOST(VAR)
 .D BUMPBLK^DVBAPOST
 .D BUMPBLK^DVBAPOST
 .K VAR
 .Q
 Q

DVBAPS1
DVBAPS1 ;ALB/CMM - SYNONYM FIE UPDATE #1 ;2/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Word ^ Synomyns seperated by ;
 ;
EN ;
 ;;MALARIA^MALARIA;PLASMODIUM
 ;;SYPHILIS^SYPHILIS;LUES
 ;;HYPOTHYROIDISM^HYPOTHYROIDISM;MYXOEDEMA;MYXEDEMA
 ;;HYPERPITUITARISM^HYERPITUITARISM;ACROMEGLY;GIGANTISM
 ;;OSTEOMYELITIS^OSTEOMYELITIS;OSTEO
 ;;TUBERCULOSIS^TUBERCULOSIS;TB
 ;;ARTHRITIS^ARTHRITIS;RHEUMATISM;OSTEOARTHRITIS;DJD;OA;INFLAMMATORYARTHRITIS;GOUT;SYNOVITIS;HYDRARTHROSIS
 ;;AMPUTATION^AMPUTATION;AMP
 ;;FUSION^FUSION;ANKYLOSED;ANKYLOSIS
 ;;TALUS^TALUS;ASTRAGULUS
 ;;PARALYSIS^PARALYSIS;WEAKNESS;DENERVATION

DVBAPST1
DVBAPST1 ;ALB/JLU;UTILITY ROUTINE FOR POST INIT;9/6/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
REINDAC ;this entry point will reindex the 'AC' ref. in 396
 S VAR=" - Reindexing the 'AC' cross-reference."
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
REAC1 ;around the displays
 S DIK="^DVB(396,",DIK(1)=6.82
 D ENALL^DIK
 K DIK
 S VAR="Reindexing of 'AC' complete!"
 W !,VAR
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 K VAR
 Q
 ;
REINDAF ;reindexing the 'AF' cross-reference
 S VAR=" - Reindexing the 'AF' cross-reference."
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
REAF ;around displays
 S DIK="^DVB(396.3,",DIK(1)=17
 D ENALL^DIK
 K DIK
 S VAR="Reindexing of 'AF' complete!"
 W !,VAR
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 K VAR
 Q
 ;
REINDAE ;** Reindexing the 'AE' and 'E' cross references (396)
 S VAR=" - Reindexing the 'AE' cross-reference."
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
REAE ;** Around displays
 S DIK="^DVB(396,",DIK(1)=23
 D ENALL^DIK
 K DIK
 S VAR="Reindexing 'AE' for field 23 complete!"
 W !,VAR
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 K VAR
 Q
 ;
VERSION() ;this function call returns the version of AMIE that is running.
 ;It uses the 396 file.
 ;
 Q $G(^DD(396,0,"VR"))

DVBAPST3
DVBAPST3 ;ALB/JLU;post init to set up hl7 files ;05/03/93
 ;;2.7;AMIE;;Apr 10, 1995
EN ;main entry point
 I +$$VERSION^XPDUTL("HL")<1.5 W !,"HL7 Version 1.5 not installed, I will not attempt to set up the AMIE/Kurzweil entries." Q
 ;check for DVBA AMIE entry in file 771
 K DIC,X,Y
 S DIC="^HL(771,",X="DVBA AMIE",DIC(0)="MO" D ^DIC
 I Y>0 W *7,!!,"The HL7 DHCP Application Parameter file (771) already ",!,"has a DVBA AMIE  entry!  No updating of this file." K DIC,X,Y G EN1
 K DO,DD
 S DIC="^HL(771,",DIC(0)="AELMQ",DIC("DR")="2///ACTIVE",X="DVBA AMIE"
 W !!,"."
 W !,"Setting up the entry in the HL7 DHCP Application Parameter file (771)."
 S DLAYGO=771
 D FILE^DICN
 K DLAYGO
 I Y<0 W !!,*7,"An error has occurred entering the entry into file 771. This file must be checked and set up properly.  Continuing on to 770."
 I Y>0 D ENTRY1
 ;
EN1 K DIC,DIE,DD,DO
 ;check for AMIE entry in file 770
 K DIC,X,Y
 S DIC="^HL(770,",X="AMIE",DIC(0)="MO" D ^DIC
 I Y>0 W *7,!!,"The HL7 Non-DHCP Application Parameter file (770) already",!,"has an  AMIE  entry.  No updating of this file." K DIC,X,Y Q
 S DIC="^HL(770,",DIC(0)="AELMQ",X="AMIE"
 S DIC("DR")="3///KURZWEIL;4///245;5///3;7///2.1;8///DVBA AMIE;9///30;14///P"
 W !!,"Now setting up the entry in the HL7 Non-DHCP Application Parameter file (770).",!!
 S DLAYGO=770
 D FILE^DICN
 K DLAYGO
 ;
 I Y<0 W !!,*7,"An error has occurred entering the necessary entry in file 770.  This entry must be set up before use." Q
 ;
 ;ask for Station Number and HL7 Device (site specific fields in 770)
 K DA,DIE,DR
 S DA=$P(Y,"^"),DIE="^HL(770,",DR="2;6"
 D ^DIE
 ;
WR1 W !!!,"The post init has finished!"
 ;
EXIT K DIC,DIE,DVBA,DVBVAR,DR,DA,Y,X
 Q
 ;
ENTRY1 K DIC,DIE,DR
 S DIC(0)="LMQ"
 S DA=+Y
 S DIE="^HL(771,"
 S DR="5///QRD"
 S DR(2,771.05)=".01///QRD;2///1"
 S DLAYGO=771
 D ^DIE K DLAYGO
 I '$D(DA) D WR Q
 S DIC(0)="LMQ",DIE="^HL(771,"
 F DVBA=1:1:6 D SET,^DIE K DLAYGO I '$D(DA) D WR Q
 Q
 ;
WR W !,*7,"An error has occurred entering the message or segment types into file 771.  Please check"
 W !,"this file to make sure all the necessary file entries exists."
 Q
 ;
TYPE ;these are the hl7 message types and routines
 ;;ORU^DVBCHLR
 ;;ORM^DVBCHLOR
 ;;QRY^DVBCHLQ
 ;;ORR^NONE
 ;;ORF^NONE
 ;;ACK^NONE
 Q
 ;
SET ;
 K DR
 S DVBVAR=$E($T(TYPE+DVBA),4,99)
 S DR="6///"_$P(DVBVAR,U,1)
 S DR(2,771.06)=".01///"_$P(DVBVAR,U,1)_";1///"_$P(DVBVAR,U,2)
 S DLAYGO=771
 Q

DVBAPSYN
DVBAPSYN ;ALB/JLU,GTS- SYNONYM FILE UPDATE ;1/21/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;
 D SET
 D LOOP
 D SG1
 D EXIT
 Q
SET N VAR
 S VAR=" - Adding to Local Synonym File",SYNCNT=0
 W !!!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
SET1 ;
 S DIF="^TMP($J,""DVBA"",",XCNP=0
 K ^TMP($J,"DVBA")
 F ROU="DVBAPS1" S X=ROU X ^%ZOSF("LOAD") W "."
 K DIF,XCNP,ROU,X
 Q
LOOP ; ** Loop through text lines in Routine files DVBAPS# **
 N LP,TERM,SYN
 S LP=0
 F  S LP=$O(^TMP($J,"DVBA",LP)) Q:(LP="")  I $D(^TMP($J,"DVBA",LP,0)) S LINE=^TMP($J,"DVBA",LP,0) DO
 .I (LINE'[";;")!(LINE[";AMIE;")!(LINE="") Q
 .S TERM=$P(LINE,U,1)
 .S TERM=$P(TERM,";;",2)
 .S SYN=$P(LINE,U,2)
 .K STOP
 .D DCH
 .D:'$D(STOP) ADDT
 .D:$D(STOP) ADDS
 Q
 ;
ADDT ; ** Add a term to the lookup file **
 K DIC,DA,DR,DLAYGO,Y
 S DIC="^XT(8984.3,",DIC(0)="L",DLAYGO="8984.3"
 S DIC("S")="I $P(^(0),U,2)=31",DIC("DR")=".02///31",X=TERM D ^DIC
 S ENT=+Y
 D:+ENT<0 SE
 K DA,DR,DIC,DLAYGO,Y
 D:+ENT>0 ADDS
 Q
ADDS ; ** Add a synonym to the synonym file **
 F LOOP1=1:1 S X=$P(SYN,";",LOOP1) Q:(LOOP1=""!(X=""))  DO
 .K STOP
 .D DCH1
 .I '$D(STOP) DO
 ..I '$D(^XT(8984.3,ENT,1,0)) S ^XT(8984.3,ENT,1,0)="^8984.31A^0^0"
 ..K DD,DO,DA,Y,DIC
 ..S DIC="^XT(8984.3,"_ENT_",1,",DA(1)=ENT,DIC(0)="LX"
 ..D ^DIC
 ..K DD,DO,DA,DIC
 ..I Y<0 D SE1
 ..S:Y>0 SYNCNT=SYNCNT+1
 ..W:(LOOP1#10) "."
 K STOP
 Q
SE ;
 N VAR
 S VAR="Term "_TERM_" not in Local Lookup File or addition failed."
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
SE1 ;
 N VAR
 S VAR="Addition of synonym "_X_" to "_TERM_" has failed."
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
DCH ;
 S DIC="^XT(8984.3,",DIC(0)="MO",X=TERM,DIC("S")="I $P(^(0),U,2)=31"
 D ^DIC
 I Y>0 S ENT=+Y,STOP=1
 K DIC,X,Y
 Q
 ;
DCH1 I $O(^XT(8984.3,ENT,1,"B",X,"")) S STOP=1
 Q
 ;
SG1 ;writes and updates the tmp global with the finish
 N LP1,V1
 F LP1=1:1:2 D BUMPBLK^DVBAPOST
 S V1="The Local Synonym file has completed update of "_SYNCNT_" synonyms!"
 W !!,V1
 D BUMP^DVBAPOST(V1)
 D BUMPBLK^DVBAPOST
 Q
EXIT ;
 K X,Y,STOP,EXAM,LINE,^TMP($J,"DVBA"),SYNCNT,ENT,LOOP1
 Q

DVBAPW1
DVBAPW1 ;ALB/CMM AMIE EXAM FILE UPDATE #1 ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Worksheet Name;Worksheet Number;exam numbers seperated by ;
 ;
EN ;
 ;;DISEASES OF ARTERIES/VEINS;0105;7100;7101;7110;7111;7112;7113;7114;7115;7116;7117;7118;7119;7120;7121;7122;7123
 ;;DISEASES OF THE HEART;0110;7000;7001;7002;7003;7004;7005;7006;7007;7008;7010;7011;7012;7013;7014;7015;7016;7017
 ;;HYPERTENSION;0115;7007;7101
 ;;DENTAL;0205;9900;9901;9902;9903;9904;9905;9906;9907;9908;9909;9911;9912;9913;9914;9915;9916
 ;;ALIMENTARY APPENDAGES;0305;7200;7201;7202;7311;7312;7313;7314;7315;7316;7317;7318;7338;7339;7340;7342;7343;7344;7345;7346;7347;7348
 ;;ESOPHAGUS;0310;7203;7204;7205
 ;;INTESTINE;0315;7301;7319;7321;7322;7323;7324;7325;7326;7327;7328;7329;7330;7331
 ;;RECTUM AND ANUS;0320;7332;7333;7334;7335;7336;7337
 ;;STOMACH;0325;7304;7305;7306;7307;7308;7309;7310
 ;;DIABETES INSIPIDUS;0405;7909
 ;;DIABETES MELLITUS;0410;7913
 ;;HYPERPARATHYROIDISM;0415;7904;7905
 ;;HYPERPITUITARISM (CUSHINGS SYN;0420;7907;7908;7911
 ;;HYPERTHYROIDISM, THYROID ADENO;0425;7900;7901;7902
 ;;HYPOTHYROIDISM;0430;7903
 ;;PITUITARY TUMORS;0435;7908;7910;7912;7914;7915
 ;;GENERAL MEDICAL;0505
 ;;CYSTITIS, BLADDER CALC.,BLADDER;0605;7510;7511;7512;7515;7516;7517;7518;7519;7527;7542
 ;;LOSS OF PENIS, ALL OR PARTIAL;0610;7520;7521;7522
 ;;MALIGNANCIES OR TUBERCULOSIS;0615;7528;7529
 ;;PYELITIS, NEPHROLITHIAIS, ETC.;0620;7508;7509;7510;7511
 ;;TESTES, TRAUMA OR DISEASE;0625;7523;7524;7525
 ;;URETHRAL FISTULA;0630;7516;7519
 ;;GYNECOLOGICAL;0705;7610;7611;7612;7613;7614;7615;7617;7618;7619;7620;7621;7622;7623;7624;7625;7627
 ;;HEMATOLOGIC DISORDERS-BLOOD;0805;7700;7701;7702;7703;7704;7705;7706;7707;7714
 ;;HEMATOLOGIC DISORDERS-LYMPHATI;0810;7709;7710;7711;7712;7713;7715
 ;;MENTAL DISORDERS;0905;9201;9202;9203;9204;9205;9206;9207;9208;9209;9210;9300;9301;9302;9303;9304;9305;9306;9307;9308;9309;9310;9311;9312;9315;9322;9324;9325;9400;9401;9402;9403;9404;9405;9408;9409;9410
 ;;MENTAL DISORDERS;0905;9500;9501;9502;9505;9506;9507;9508;9509;9510;9511
 ;;POST-TRAUMATIC STRESS DISORDER;0910;9411
 ;;NEPHRITIS, ALL FORMS EXCEPT CH;1105;7505;7507;7508;7509;7535;7536;7537;7539;7540;7541
 ;;NEPHROLOGICAL;1110;7500;7501;7502;7504;7530;7531;7532;7533;7534;7538
 ;;CRANIAL NERVES;1205;5296;8205;8207;8209;8210;8211;8212;8305;8307;8309;8310;8311;8312;8405;8407;8409;8410;8411;8412
 ;;DISEASES/INJURIES OF THE BRAIN;1210;5296;8000;8002;8003;8004;8005;8007;8008;8009;8013;8017;8018;8019;8020;8045;8046
 ;;DISEASES/INJURIES OF THE SPINA;1215;8010;8011;8012;8014;8015;8017;8018;8019;8021;8022;8023;8024;8025
 ;;EPILEPSY AND NARCOLEPSY;1220;8108;8910;8911;8912;8913;8914
 ;;MISCELLANEOUS NEUROLOGICAL DIS;1225;5296;8100;8103;8104;8105;8106;8107
 ;;PERIPHERAL NERVES;1230;8510;8511;8512;8513;8514;8515;8516;8517;8518;8519;8520;8521;8522;8523;8524;8525;8526;8527;8528;8529;8530;8540;8610;8611;8612;8613;8614;8615;8616;8617;8618;8619;8620;8621;8622;8623;8624;8625;8626;8627
 ;;PERIPHERAL NERVES;1230;8628;8629;8630;8710;8711;8712;8713;8714;8715;8716;8717;8718;8719;8720;8721;8722;8723;8724;8725;8726;8727;8728;8729;8730

DVBAPW2
DVBAPW2 ;ALB/CMM AMIE EXAM FILE UPDATE #2 ;2/2/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Format is Worksheet Name;Worksheet Number;exam numbers seperate by ;
 ;
EN ;
 ;;AUDIO;1305;6200;6201;6202;6203;6204;6205;6206;6207;6208;6209;6210;6211;6260;6100;6101;6102;6103;6104;6105;6106;6107;6108;6109;6110
 ;;AUDIO-EAR DISEASE;1306;6200;6201;6202;6203;6204;6205;6206;6207;6208;6209;6210;6211;6260;6100;6101;6102;6103;6104;6105;6106;6107;6108;6109;6110
 ;;MOUTH AND THROAT;1310;6515;6516;6517;6518;6519;6520
 ;;NOSE AND SINUSES;1315;6501;6502;6504;6510;6511;6512;6513;6514
 ;;SENSE OF SMELL;1320;6275
 ;;SENSE OF TASTE;1325;6276
 ;;VISUAL;1330;6000;6001;6002;6003;6004;6005;6006;6007;6008;6009;6010;6011;6012;6013;6014;6015;6016;6017;6018;6019;6020;6021;6022;6023;6024;6025;6026;6027;6028;6029;6030;6031;6032;6033;6034;6035;6061;6062;6063;6064;6065;6066;6067;6068;6069;6070;
 ;;VISUAL;1330;6071;6072;6073;6074;6075;6076;6077;6078;6079;6080;6081;6090;6091;6092
 ;;AMPUTATION STUMPS;1405;5104;5105;5106;5107;5108;5109;5110;5111;5120;5121;5122;5123;5124;5125;5126;5127;5128;5129;5130;5131;5132;5133;5134;5135;5136;5137;5138;5139;5140;5141;5142;5143;5144;5145;5146;5147;5148;5149
 ;;AMPUTATION STUMPS;1405;5150;5151;5152;5153;5154;5155;5156;5160;5161;5162;5163;5164;5165;5166;5167;5170;5171;5172;5173
 ;;BONES;1410;5000;5010;5011;5012;5013;5014;5015;5016;5202;5203;5209;5210;5211;5212;5255;5262;5263;5275
 ;;FEET;1415;5166;5167;5170;5171;5172;5173;5276;5277;5278;5279;5280;5281;5282;5283;5284
 ;;HAND, THUMB, FINGERS;1420;5105;5109;5111;5125;5216;5217;5218;5219;5220;5221;5222;5223;5224;5225;5226;5227
 ;;HIP;1425;5054;5250;5251;5252;5253;5254;5255
 ;;JOINTS;1430;5001;5002;5003;5004;5005;5006;5007;5008;5009;5010;5011;5012;5013;5014;5015;5016;5017;5018;5019;5020;5021;5022;5023;5024;5051;5052;5053;5055;5056;5200;5201;5202;5203;5205;5206;5207;5208;5209;5210;5211;5212;5213;5214
 ;;JOINTS;1430;5215;5256;5257;5258;5259;5260;5261;5262;5263;5270;5271;5272;5273;5274;5275
 ;;MUSCLES;1435;5021;5023;5301;5302;5303;5304;5305;5306;5307;5308;5309;5310;5311;5312;5313;5314;5315;5316;5317;5318;5319;5320;5321;5322;5323;5324;5325;5326;5327;5328;5329
 ;;NECK - NOT SPINAL CONDITION;1440;5285;5287;5290;5293
 ;;SCARS;1445;5104;5105;5109;5110;5111;7800;7803;7804;7805
 ;;SPINE;1450;5285;5286;5287;5288;5289;5290;5291;5292;5293;5294;5295;5298
 ;;NON-TUBERCULOSIS DISEASES AND ;1505;5297;6800;6801;6802;6803;6804;6805;6806;6807;6808;6809;6810;6811;6812;6813;6814;6815;6816;6817;6818;6819;6820;6821
 ;;NOSE AND THROAT (PULMONARY);1510;6501;6502;6504;6510;6511;6512;6513;6514;6515;6516;6517;6518;6519;6520
 ;;PULMONARY TUBERCULOSIS AND TUB;1515;6701;6702;6703;6704;6721;6722;6723;6724;6730;6731;6732
 ;;RESPIRATORY MANIF. OF DISEASES;1520;5288;5321
 ;;TRACHEA AND BRONCHI;1525;6600;6601;6602;6603
 ;;SCARS (BURN);1605;7801;7802
 ;;SKIN (OTHER THAN SCARS);1610;7806;7807;7808;7809;7810;7811;7812;7813;7814;7815;7816;7817;7818;7819
 ;;PRISONER OF WAR;1705
 ;;AGENT ORANGE;1710
 ;;REGULAR AID AND ATTENDANCE/HOU;1715
 ;;AID AND ATTENDANCE/HOUSEBOUND;1715
 ;;HIGHER LEVEL AID AND ATTENDANC;1720
 ;;SYSTEMIC CONDITIONS;1805;6300;6301;6302;6304;6305;6306;6307;6308;6309;6310;6311;6313;6314;6315;6316;6317;6318;6350;6351
 ;;CARDIOVASCULAR (NEC);0105;7100;7101;7110;7111;7112;7113;7114;7115;7116;7117;7118;7119;7120;7121;7122;7123
 ;;DIGESTIVE (NEC);0310;7203;7204;7205
 ;;ENDOCRINE DISORDERS (NEC);0415;7904;7905
 ;;GENITOURINARY (NEC);0610;7520;7521;7522
 ;;GYNECOLOGICAL (NEC);0710;7626;7627
 ;;HEMATOLOGICAL (NEC);0710;7626;7627
 ;;MAMMARY;0710;7626;7627
 ;;MENTAL (NEC);0905;9201;9202;9203;9204;9205;9206;9207;9208;9209;9210;9300;9301;9302;9303;9304;9305;9306;9307;9308;9309;9310;9311;9312;9315;9322;9324;9325;9400;9401;9402;9403;9404;9405;9408;9409;9410
 ;;MENTAL (NEC);0905;9500;9501;9502;9505;9506;9507;9508;9509;9510;9511
 ;;MUSCULOSKELETAL (NEC);1455;5104;5105;5109;5110;5111;7800;7803;7804;7805
 ;;NEPHROLOGICAL (NEC);1115;7500;7501;7502;7504;7530;7531;7532;7533;7534;7538
 ;;NEUROLOGICAL (NEC);1230;8510;8511;8512;8513;8514;8515;8516;8517;8518;8519;8520;8521;8522;8523;8524;8525;8526;8527;8528;8529;8530;8540;8610;8611;8612;8613;8614;8615;8616;8617;8618;8619;8620;8621;8622;8623;8624
 ;;NEUROLOGICAL (NEC);1230;8625;8626;8627;8628;8629;8630;8710;8711;8712;8713;8714;8715;8716;8717;8718;8719;8720;8721;8722;8723;8724;8725;8726;8727;8728;8729;8730
 ;;ORGANS OF SENSE (NEC);1320;6275
 ;;OTHER GENITOURINARY;0625;7523;7524;7525
 ;;PULMONARY (NEC);1515;6701;6702;6703;6704;6721;6722;6723;6724;6730;6731;6732
 ;;SCARS (SKIN);1445;5104;5105;5109;5110;5111;7800;7803;7804;7805
 ;;SKIN (NEC);1610;7806;7807;7808;7809;7810;7811;7812;7813;7814;7815;7816;7817;7818;7819

DVBAPWKS
DVBAPWKS ;ALB/CMM AMIE EXAM FILE UPDATE ;1/20/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;
 N WKSCNT
 S WKSCNT=0
 D SET
 D LOOP
 D SG1
 D EXIT
 Q
SET N VAR
 S VAR=" - Adding to AMIE Exam File"
 W !!!,VAR
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMPBLK^DVBAPOST
 D BUMP^DVBAPOST(VAR)
 D BUMPBLK^DVBAPOST
SET1 ;
 S DIF="^TMP($J,""DVBA"",",XCNP=0
 K ^TMP($J,"DVBA")
 F ROU="DVBAPW1","DVBAPW2" S X=ROU X ^%ZOSF("LOAD") W "."
 K DIF,XCNP,ROU
 Q
LOOP ;
 N LP,EXM,WKS
 S LP=0
 F  S LP=$O(^TMP($J,"DVBA",LP)) Q:(LP="")  D
 .K STOP
 .S LINE=^TMP($J,"DVBA",LP,0)
 .I (LINE'[";;")!(LINE[";AMIE;")!(LINE="") Q
 .S EXM=$P(LINE,";",3)
 .S WKS=$P(LINE,";",4)
 .D CHK
 .I $D(STOP) D SE Q
 .;;;D ADDW
 .D ADDE
 .W:(LP#10) "."
 Q
ADDW ;
 S DIE="^DVB(396.6,",DA=EXAM,DR=".07///"_WKS
 D ^DIE
 K DIW,DA,DR,DIE
 Q
ADDE ;
 I '$D(^DVB(396.6,EXAM,1,0)) S ^DVB(396.6,EXAM,1,0)="^396.61P^0^0"
 F LP1=5:1:999 S X=$P(LINE,";",LP1) Q:X=""  D
 .K STOP,DA
 .D SETUP
 .I $D(STOP) Q
 .S DLAYGO=396
 .K DD,DO
 .S DIC="^DVB(396.6,"_EXAM_",1,",DA(1)=EXAM,DIC(0)="LZM" D FILE^DICN
 .K DD,DO
 .I Y<0 D SE1
 .K DA,DIC,DLAYGO
 .I Y>0 S WKSCNT=WKSCNT+1
 Q
SE ;
 N VAR
 S VAR="Could not find AMIE Exam "_EXM
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
SE1 ;
 N VAR
 S VAR="Addition of exam "_X_" to "_EXM_" has failed."
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
CHK ;
 S DIC="^DVB(396.6,",DIC(0)="OZ",X=EXM,D="B"
 ;LOOKUP ONLY ON "B" CROSS REFERENCE
 D IX^DIC
 I Y<0 S STOP=1
 K DIC,X,D
 S EXAM=+Y
 Q
 ;
SG1 ;writes and updates the tmp global with the finish
 N LP1,V1
 F LP1=1:1:2 D BUMPBLK^DVBAPOST
 S V1="I have updated "_WKSCNT_" exams to the AMIE Exam file."
 W !!,V1
 D BUMP^DVBAPOST(V1)
 D BUMPBLK^DVBAPOST
 Q
EXIT ;
 K X,Y,STOP,EXAM,LINE,^TMP($J,"DVBA"),DVBAVAR
 Q
 ;
SETUP ;
 S DVBAVAR=$O(^DIC(31,"C",X,""))
 I DVBAVAR="" D SE3 S STOP=1 Q
 I '$D(^DIC(31,DVBAVAR,0)) D SE2 S STOP=1 Q
 I $O(^DVB(396.6,EXAM,1,"B",DVBAVAR,""))'="" S STOP=1 Q
 S X=DVBAVAR
 Q
 ;
SE2 ;
 N VAR
 S VAR="Zero node of the "_X_" code does not exist, AMIE Exam "_EXM_".  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q
 ;
SE3 ;
 N VAR
 S VAR="'C' cross reference for code "_X_" does not exist, AMIE Exam "_EXM_".  Please investigate!"
 W !!,VAR
 D BUMP^DVBAPOST(VAR)
 Q

DVBARAD1
DVBARAD1 ;RE-ADMISSION REPORT, PRINT DRIVER ; 1/23/91  7:37 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S ZX="PENSION   ",ZY="A & A     "
 S MSG="" F ZZ=1:1:7 S MSG=MSG_ZX
 S MSG1="" F ZZ=1:1:7 S MSG1=MSG1_ZY
 U IO K DVBAQUIT
 F DVBAT="PEN","A&A" W:((IOST?1"C-".E)!(IOST'?1"P-OTHER".E)) @IOF W !!!!!!!!!! D PRINT Q:$D(DVBAQUIT)
 G KILL
 ;
PRINTB S DATA1=$S($D(^TMP("DVBA",DVBAT,$J,XCN,XCFLOC,K,DA,"LADM")):^("LADM"),1:"") S (LADMDT,ADMDT)=$P(DATA1,U),LTDIS=$P(DATA1,U,2),DFN=DA,QUIT1=1 K DATA1 D ADM^DVBAVDPT K QUIT1,DVBAQ
 S LBEDSEC=BEDSEC,LDIAG=DIAG,LDCHGDT=DCHGDT,ADMDT=$P(DATA,U),RCVAA=$P(DATA,U,2),RCVPEN=$P(DATA,U,3),CNUM=$P(DATA,U,4),TDIS=$P(DATA,U,5) D ADM^DVBAVDPT
 S RCVPEN=$S(RCVPEN=0:"NO",RCVPEN=1:"YES",1:"Not specified"),RCVAA=$S(RCVAA=0:"NO",RCVAA=1:"YES",1:"Not specified")
 W @IOF,!!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!,?(80-$L(HEADDT)\2),HEADDT,!!!
 S:ADMDT]"" ADMDT=$E(ADMDT,4,5)_"/"_$E(ADMDT,6,7)_"/"_$E(ADMDT,2,3) S:DCHGDT]"" DCHGDT=$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3)
 S:LADMDT]"" LADMDT=$E(LADMDT,4,5)_"/"_$E(LADMDT,6,7)_"/"_$E(LADMDT,2,3) S:LDCHGDT]"" LDCHGDT=$E(LDCHGDT,4,5)_"/"_$E(LDCHGDT,6,7)_"/"_$E(LDCHGDT,2,3)
 W "Patient: ",PNAM,?60,"SSN: ",SSN,!,"Claim #: ",CNUM,?56,"Pension: ",RCVPEN,!,"Claim Folder Loc: ",CFLOC,?60,"A&A: ",RCVAA,! D ELIG F LINE=1:1:80 W "="
 W !?26,"------- Admission data -------",!!?18,"Current",?57,"Prior",!,?18,"-------",?57,"-----",!
 W ?(25-$L(ADMDT)),ADMDT,?26,"------ Admission date -------  ",LADMDT,!
 W ?(25-$L(DIAG)),$E(DIAG,1,26),?26,"---- Admitting diagnosis ----  ",$E(LDIAG,1,23),!
 W ?(25-$L(DCHGDT)),DCHGDT,?26,"------- Discharge date ------- ",LDCHGDT,!
 W ?(25-$L(TDIS)),$E(TDIS,1,26),?26,"------- Discharge type ------- ",$E(LTDIS,1,23),!
 W ?(25-$L(BEDSEC)),BEDSEC,?26,"-------- Bed Service --------- ",LBEDSEC,!
 I IOST?1"C-".E W *7,!,"Press RETURN to continue or ""^"" to stop    " R ANS:DTIME S:ANS=U!('$T) XCN="ZZZZ" I '$T S DVBAQUIT=1
 Q
 ;
PRINT S NODTA=1 S (XCN,XCFLOC,ANS)=""
 I $D(^TMP("DVBA",DVBAT,$J)) F XLINE=1:1:5 W ?5,$S(DVBAT="PEN":MSG,DVBAT="A&A":MSG1,1:""),!!
 F DVBAM=0:0 S XCN=$O(^TMP("DVBA",DVBAT,$J,XCN)) Q:XCN=""  F J=0:0 S XCFLOC=$O(^TMP("DVBA",DVBAT,$J,XCN,XCFLOC)) Q:XCFLOC=""  F K=0:0 S K=$O(^TMP("DVBA",DVBAT,$J,XCN,XCFLOC,K)) Q:K=""  D PRINTC
 Q
 ;
PRINTC F DA=0:0 S DA=$O(^TMP("DVBA",DVBAT,$J,XCN,XCFLOC,K,DA)) Q:DA=""  S DATA=^(DA) D PRINTB
 Q
 ;
KILL K ^TMP("DVBA","A&A",$J),^TMP("DVBA","PEN",$J)
 D ^%ZISC S X=7 D:$D(ZTQUEUED) KILL^%ZTLOAD G FINAL^DVBAUTIL
 ;
ELIG S ELIG=DVBAELIG,INCMP=0
 W "Eligibility: "
 I ELIG]"" S ELIG=ELIG_" ("_$S(DVBAELST="P":"Pend Ver",DVBAELST="R":"Pend Re-verif",DVBAELST="V":"Verified",1:"Not Verified")_")"
 I $D(^DPT(DA,.29)),$P(^(.29),U,1)]"" S INCMP=1 ;date ruled incomp, VA
 I $D(^DPT(DA,.29)),$P(^(.29),U,12)=1 S INCMP=1 ;ruled incomp field
 W ELIG_$S(ELIG]"":", ",1:"") W:$X>60 !?14 W $S(INCMP=1:"Incompetent",1:""),!

DVBARADM
DVBARADM ;ALB/GTS-557/THM-READMISSION REPORT ; 1/23/91  8:01 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 G TERM
SORT D RCV^DVBAVDPT I $D(RONUM),$D(RO) Q:CFLOC'=RONUM&(RO="Y")
 I RCVAA S ^TMP("DVBA",$J,"A&A",DFN)=""
 I RCVPEN S ^TMP("DVBA",$J,"PEN",DFN)=""
 Q
 ;
DCHGDT S (LADMDT,LDCHGDT)="",DCHPTR=$P(^DGPM(VY,0),U,17),LADMDT=$P(^(0),U,1) I DCHPTR]"",$D(^DGPM(+DCHPTR,0)) S LDCHGDT=$P(^DGPM(+DCHPTR,0),U,1)
 Q
 ;
CAL S I="",ZI=1 F DVBAI=0:0 S I=$O(^DGPM("APID",DFN,I)) Q:I=""  F J=0:0 S J=$O(^DGPM("APID",DFN,I,J)) Q:J=""  S ZJ=$S($D(^DGPM(J,0)):^(0),1:"") I $P(ZJ,U,1)'>EDATE,$P(ZJ,U,2)=1 S ^TMP("DVBA",$J,"ADM",DFN,ZI,J)="",ZI=ZI+1
 S VX=$O(^TMP("DVBA",$J,"ADM",DFN,1,0)) Q:VX=""  S CURADMDT=$P(^DGPM(VX,0),U,1) Q:CURADMDT=""
 F VX=1:1 S VX=$O(^TMP("DVBA",$J,"ADM",DFN,VX)) Q:VX=""  F VY=0:0 S VY=$O(^TMP("DVBA",$J,"ADM",DFN,VX,VY)) Q:VY=""  D DCHGDT I CURADMDT["."&(LADMDT[".") D SET
 Q
TDIS S TDIS=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U,18),1:"") Q:TDIS=""
 S:'$D(^DG(405.2,+TDIS,0)) TDIS="Unknown discharge type" I $D(^(0)) S TDIS=$S($P(^DG(405.2,+TDIS,0),U,1)]"":$P(^(0),U,1),1:"Unknown discharge type")
 Q
 ;
SET S X1=CURADMDT,X2=LDCHGDT D ^%DTC Q:X>185
 S X2=LADMDT,X1=LDCHGDT D ^%DTC S LOS=X Q:LOS'>HOSPDAYS
 S ADMDT=CURADMDT D ADM^DVBAVDPT,TDIS
 S ^TMP("DVBA",DVBAT,$J,XCN,CFLOC,VY,DFN)=CURADMDT_U_RCVAA_U_RCVPEN_U_CNUM_U_TDIS
 S ADMDT=LADMDT D ADM^DVBAVDPT,TDIS
 I TDIS["IRREGULAR"&(DVBAT'="A&A") S ^TMP("DVBA",DVBAT,$J,XCN,CFLOC,VY,DFN,"LADM")=LADMDT_U_TDIS
 K DVBARADQ S (VX,VY)=9999999
 Q
 ;
TERM D HOME^%ZIS K ^TMP("DVBA",$J),^TMP("DVBA","PEN",$J),^TMP("DVBA","A&A",$J),NOASK
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL
 ;
SETUP W @IOF,!,"VARO RE-ADMISSION REPORT" S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="RE-ADMISSION REPORT",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 W !,HEAD1
EN1 W !!,"Please enter admission dates for search, oldest date first,",!,"most recent date last.",!!,"Last report was run on " S Y=$P(DTAR,U,7) X ^DD("DD") W Y,!!
 D DATE^DVBAUTIL G:Y<0 KILL^DVBAUTIL
 S BDATE1=BDATE+.5,HEADDT="Date range: "_$E(BDATE1,4,5)_"/"_$E(BDATE1,6,7)_"/"_$E(BDATE1,2,3)_" to "_$E(EDATE,4,5)_"/"_$E(EDATE,6,7)_"/"_$E(EDATE,2,3)
 ;
ASK W !!,"Do you want (H)ospital or Hospital-(D)om   H// " R DVBAH:DTIME G:'$T!(DVBAH=U) KILL^DVBAUTIL
 I DVBAH="" S DVBAH="H" W DVBAH
 S:DVBAH="d" DVBAH="D"
 S:DVBAH="h" DVBAH="H"
 I DVBAH'?1"H"&(DVBAH'?1"D") W *7,!!,"Must be H for HOSPITAL or D for HOSPITAL-DOM",!! H 3 G ASK
 S HEAD=HEAD_" ("_$S(DVBAH="H":"Hospital",DVBAH="D":"Hospital-Dom",1:"Unknown selection")_")"
 S Z=$S(DVBAH="D":1,DVBAH="H":2,1:0) W $P("om^ospital",U,Z),!!
 S %ZIS("B")="0;P-OTHER",%ZIS("A")="Printing device: ",%ZIS="AEQ" D ^%ZIS G:POP KILL^DVBAUTIL
 I $D(IO("Q")) F I="NOASK","HEAD*","FDT(0)","DTAR","BDATE*","EDATE*","DVBAH" S ZTSAVE(I)=""
 I  S NOASK=1,ZTRTN="DQ^DVBARADM",ZTDESC="AMIE Re-admission Report",ZTIO=ION D ^%ZTLOAD W:$D(ZTSK) !,"Request queued.",!! G KILL^DVBAUTIL
GO I '$D(NOASK) W !!,"Looking for Pension and A&A cases ...",!!
 F DVBADT=BDATE:0 S DVBADT=$O(^DGPM("AMV1",DVBADT)) Q:DVBADT=""!(DVBADT>EDATE)  W:'$D(NOASK) "." F DFN=0:0 S DFN=$O(^DGPM("AMV1",DVBADT,DFN)) Q:DFN=""  F ADM=0:0 S ADM=$O(^DGPM("AMV1",DVBADT,DFN,ADM)) Q:ADM=""  D SORT
 I '$D(NOASK) W !!,"Examining cases found for re-admissions within 185 days ...",!!
 F DVBAT="PEN","A&A" S HOSPDAYS=$S(DVBAT="PEN"&(DVBAH="H"):89,DVBAT="PEN"&(DVBAH="D"):59,1:29) F DFN=0:0 S DFN=$O(^TMP("DVBA",$J,DVBAT,DFN)) Q:DFN=""  D CAL W:'$D(NOASK) "+"
 K ^TMP("DVBA",$J,"PEN"),^TMP("DVBA",$J,"A&A")
 I '$D(^TMP("DVBA","PEN",$J))&('$D(^TMP("DVBA","A&A",$J))) W *7,!!,"No data found for parameters entered.",!! H 2 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBAUTIL
 G ^DVBARAD1
 ;
DQ K ^TMP("DVBA",$J),^TMP("DVBA","PEN",$J),^TMP("DVBA","A&A",$J)
 G GO

DVBAREG1
DVBAREG1 ;ALB/JLU;557/THM-REQ FOR ADMITTED VETS ; 10/29/90  7:53 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN ;this is the main entry point for the driver
 D TERM
 I '$D(DVBAQUIT) DO
 .F  D BODY Q:$D(DVBAQUIT)
 .Q
 D EXIT^DVBAUTIL
 Q
 ;
TERM ;this subroutine will set various necessary variables
 ;
 K DVBAQUIT
 D DUZ2^DVBAUTIL
 Q:$D(DVBAQUIT)
 D NOPARM^DVBAUTL2
 Q:$D(DVBAQUIT)
 D HOME^%ZIS
 Q:$D(DVBAQUIT)
 S OPER=$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"Unknown")
 S HD="PATIENT LOOKUP"
 S LOC=$S($D(^DIC(4,+DUZ(2),0)):$P(^(0),U,1),1:"")
 S HNAME=$$SITE^DVBCUTL4()
 S DVBAENTR=0
 Q
 ;
BODY ;this subroutine is a subdriver for thisfunctionality
 S DVBAENTR=0
 D UNLOCK^DVBAUTL6(DVBAENTR) ;unlocks the record
 D CLEAN^DVBAREG2 ;cleans up some variables
 D PAGE^DVBAREG2 ;checks for bottom of the screen or page
 D SET1^DVBAREG3 ;sets a few variables
 S DFN=$$PAT^DVBAREG3() ;function call to get the patient
 I DFN=0 S DVBAQUIT=1 Q
 D SET2^DVBAREG3 ;sets up patient information variables
 D CLEAR^DVBAUTL4
 D DTRNG^DVBAREG2(DFN) ;gets the date range
 I $D(DVBAQUIT)!($D(DVBASTOP)) Q
 I DVBBDT>0 S DVBCHK=$$CHK(DFN,DVBBDT,DVBEDT)
 I DVBBDT=0 S DVBCHK=$$CHK(DFN,2010101,DT)
 D CLEAR^DVBAUTL4
 I DVBCHK=0 D ERR^DVBAUTL6(DVBBDT) S DVBASTOP=1 Q
 I DVBCHK="B" D QUEST1(DFN) Q:$D(DVBAQUIT)
 D OLD^DVBAREN1
 D DISPLAY
 Q:$D(DVBAQUIT)
 I $D(DVBANS) S DVBDOC=$$DOC^DVBAREG3(DVBANS) ;gets document type
 I '$D(DVBANS) DO SRCH I $D(DVBASTOP)!($D(DVBAQUIT))!('$D(DVBAENTR)) Q
 I $D(DVBANS) D SELECT^DVBAREG2
 Q:$D(DVBASTOP)!($D(DVBAQUIT))
 D ^DVBARQP
 D UNLOCK^DVBAUTL6(DVBAENTR)
 Q
 ;
CHK(A,B,C) ;checks for the existance of admissions, appointments, dispositions 
 ;or stop codes
 ;A is the DFN of the Patient
 ;B is the beginning date
 ;C is the ending date
 ;If all is selected then B and C should be dates that encompise all
 ;possible dates
 ;the date ranges provided must iclude the +/-for end of days
 N ADM,APT,DISP,SPCOD,B1,C1,C2,DVBADM,DVBAPT,DVBDISP,DVBSPCOD
 S (DVBADM,DVBAPT,DVBDISP,DVBSPCOD)=0
 S B1=9999999.9999999-B
 S C1=9999999.9999999-C
 S ADM=$O(^DGPM("APTT1",+A,B))
 I ADM,ADM'>C S DVBADM=1
 S APT=$O(^DPT(+A,"S",B))
 I APT,APT'>C S DVBAPT=1
 S DISP=$O(^DPT(+A,"DIS",C1))
 I DISP,DISP'>B1 S DVBDISP=1
 S SPCOD=$O(^SDV("ADT",+A,B))
 I SPCOD,SPCOD'>C S DVBSPCOD=1
 I DVBADM&((DVBAPT)!(DVBDISP)!(DVBSPCOD)) Q "B"
 I DVBADM Q "A"
 I DVBAPT!(DVBDISP)!(DVBSPCOD) Q "N"
 Q 0
 ;
QUEST1(DFN) ;ask user which they wish to see admission or non
 S DIR("A")="Which would you prefer"
 S DIR("A",1)=$P(DFN,U,2)_" has both Admission and Non Admission information."
 S DIR(0)="SM^A:Admissions;N:Non Admissions;B:Both"
 D ^DIR
 K DIR
 I $D(DTOUT)!($D(DUOUT))!(X="") S DVBAQUIT=1 Q
 S DVBCHK=Y
 Q
 ;
DISPLAY ;displays the patient information to the user.  Also asks the user
 ;to select which info.
 N X1,X2,X3,X4,VAR1
 I DVBANL=1 D SINGLE^DVBAREG2 Q
 K DVBANS
 S X2=$O(^TMP("DVBA",$J,0))
 I 'X2 S DVBASTOP=1 Q
 S $P(VAR1," ",5)=""
 S DVBCNT=0
 F X1=1:1 DO  Q:$D(DVBASTOP)!($D(DVBANS))
 .S DVBCNT=DVBCNT+1
 .S VAR(DVBCNT,0)="0,0,0,1,0^"_X1_$E(VAR1,1,5-$L(X1))_$P(^TMP("DVBA",$J,X2),U,1)
 .S X2=$O(^TMP("DVBA",$J,X2))
 .I '(X1#12)!('X2) DO
 ..D WR^DVBAUTL4("VAR")
 ..K VAR
 ..S DVBCNT=0
 ..D CONT^DVBAREG2
 ..Q
 .I '$D(DVBANS),('X2) S DVBASTOP=1 Q
 .Q
 I $D(DVBANS) DO
 .S X4=0
 .F X3=1:1:DVBANS S X4=$O(^TMP("DVBA",$J,X4))
 .S DVBANS=X4
 .Q
 Q
 ;
SRCH ;searches the 7131 file for an existing 7131 request.
 K DA,Y,DVBASTOP,DVBAENTR
 D DICW^DVBAUTIL
 S VAR(1,0)="0,0,0,2,0^Searching file for existing 7131 requests for "_PNAM
 D WR^DVBAUTL4("VAR")
 K VAR
 S DIC="^DVB(396,",DIC(0)="EM",X=SSN
 I DVBCHK'="B",DVBBDT=0 S DIC("S")=$S(DVBCHK="A":"I $P(^(2),U,10)=""A""",1:"I $P(^(2),U,10)=""L"""),DVBDOC=$S(DVBCHK="A":"A",1:"L")
 I DVBCHK'="B",DVBBDT>0 S DIC("S")=$S(DVBCHK="A":"I $P(^(2),U,10)=""A""",1:"I $P(^(2),U,10)=""L""")_",$P(^(0),U,4)>(DVBBDT-.0000001),$P(^(0),U,4)<(DVBEDT+.0000001)"
 D ^DIC
 K DIC
 S DVBAY=Y
 I DVBAY<0 DO  Q
 .S VAR(1,0)="0,0,0,2:2,0^No selection made!"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .D CONTMES^DVBCUTL4
 .S DVBASTOP=1
 .Q
 I DVBAY>0 DO
 .I '$$LOCK^DVBAUTL6(+DVBAY) S DVBASTOP=1 Q
 .S (ZI,DA,DVBAIFN)=+DVBAY
 .S DVBREQDT=$P(^DVB(396,DA,0),U,4)
 .D ALERT^DVBAREG2(+DVBAY)
 .D ASK^DVBAREG2
 .Q:$D(DVBAQUIT)!($D(DVBASTOP))
 .S ONFILE=0
 .S DVBAENTR=+DVBAY
 .S DVBDOC=$P(^DVB(396,DVBAENTR,2),U,10)
 .I DVBDOC["A" S ADMNUM=$$ADM(DVBREQDT,+DFN)
 .I STAT'="" D ALERT1^DVBAREG2
 .I $D(DVBAQUIT) K DVBAEDT
 .I ONFILE=1 S DVBASTOP=1 Q
 .Q
 K DVBAY
 Q
 ;
ADM(A,B) ;This entry point will return the IEN in DGPM for the patient
 ;and admission date given.  A will be the admission date and B will
 ;be the DFN of the patient.
 ;
 N X
 S A=9999999.9999999-A
 S X=$O(^DGPM("ATID1",+B,A,0))
 I X DO
 .I '$D(^DGPM(X,0)) S X=""
 .Q
 I X="" Q 0
 Q X

DVBAREG2
DVBAREG2 ;ALB/JLU;second half of the 7131 input;9/20/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
CONT ;asks for the selection from the list
 S DIR(0)="NAO^1:"_X1_":0"
 S DIR("A")="Select 1-"_X1_"   or '^' to Exit or Return to continue "
 D ^DIR
 K DIR
 I $D(DTOUT)!$D(DUOUT) S DVBASTOP=1 Q
 I Y]"" S DVBANS=Y
 E  K DVBANS
 Q
 ;
SINGLE ;when selecting a single entry point
 S X1=$O(^TMP("DVBA",$J,0))
 I X1="" S DVBASTOP=1 Q
 S DIR("A",1)=""
 S DIR("A",2)=$P(^TMP("DVBA",$J,X1),U)
 S DIR("A")="Is this the correct information? "
 S DIR("B")="NO"
 S DIR(0)="YA"
 D ^DIR
 K DIR
 I $D(DUOUT)!($D(DTOUT)) S DVBASTOP=1 Q
 I Y S DVBANS=X1
 E  K DVBANS
 Q
 ;
DTRNG(DFN) ;gets the date range from the user
 S DIR("A",1)="Display Admission or Activity information"
 S DIR("A")="for "_$P(DFN,U,2)_"  by"
 S DIR("?")="Date Range will allow the user to select the specific dates."
 S DIR("?",1)="All Dates will show the user all possible information."
 S DIR(0)="SM^D:Date Range;A:All Dates"
 D ^DIR
 K DIR
 I $D(DTOUT)!($D(DUOUT)) S DVBAQUIT=1 Q
 I X="" S DVBASTOP=1 Q
 S DVBBDT=0,DVBEDT=0
 S VAR(1,0)="0,0,0,1,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 I Y="D" DO
 .D DATE^DVBCUTL4(.DVBBDT,.DVBEDT)
 .S Y="D"
 .I DVBBDT>0,'+$P(DVBBDT,".",2) S DVBBDT=DVBBDT-.0000001
 .I DVBEDT>0,'+$P(DVBEDT,".",2) S DVBEDT=DVBEDT+.9999999
 .I DVBBDT=0,DVBEDT=0 S DVBAQUIT=1
 .I DVBBDT=-1,DVBEDT=-1 S DVBASTOP=1
 .Q
 Q
 ;
CLEAN ;cleans up variables
 K DA,ADM,ADMDT,ADMNUM,DFN,DIC,A,DR,PNAM,SSN,TRN,Z,DINUM,DTAR,C,J,K,L,C,D,DIE,ONFILE,%,OLDDA,%Y,DIK,ZI,X,Y,AROWOUT,DVBAEDT,DVBAENTR,DVBASTOP,DVBREQDT,DVBANS
 K ^TMP("DVBA",$J),^UTILITY("DIQ1")
 Q
 ;
PAGE ;pages and dispays end of page or screen
 S VAR(1,0)="0,0,0,0,1^"
 S VAR(2,0)="0,0,"_(IOM-$L(HD)\2)_":0,0,0^"_HD
 S VAR(3,0)="0,0,"_(IOM-$L(HNAME)\2)_":0,1:2,0^"_HNAME
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
SELECT ;checks document type, status of current request and calls deletion 
 ;if necessary.
 N ZI
 K DVBAENTR
 S DVBREQDT=9999999.9999999-DVBANS
 I ^TMP("DVBA",$J,DVBANS)["ADMISSION" S ADMNUM=$P(^(DVBANS),U,2)
 F ZI=0:0 S ZI=$O(^DVB(396,"B",+DFN,ZI)) Q:ZI=""  I $D(^DVB(396,"G",DVBREQDT,ZI)) S DVBAENTR=ZI Q
 I $D(DVBAENTR) DO
 .D ALERT(ZI)
 .D ASK
 .Q:$D(DVBAQUIT)!($D(DVBASTOP))
 .I '$$LOCK^DVBAUTL6(DVBAENTR) S DVBASTOP=1 Q
 .S STAT=$P(^DVB(396,DVBAENTR,1),U,12)
 .S ONFILE=0
 .I STAT'="" D ALERT1
 .Q:$D(DVBAQUIT)!($D(DVBASTOP))
 .I ONFILE=1 S DVBASTOP=1 Q
 .Q
 I '$D(DVBAENTR) DO
 .D DICW^DVBAUTIL
 .D ASK1
 .I $D(DVBASTOP)!($D(DVBAQUIT)) Q
 .D STUFF
 .Q
 I '$D(DVBAENTR) S DVBASTOP=1
 Q
 ;
ALERT(Y) ;displays when there is a potential hit in the 7131 file.
 S VAR(1,0)="1,0,0,2,0^There is a 7131 already on file for "_$E(DVBREQDT,4,5)_"/"_$E(DVBREQDT,6,7)_"/"_$E(DVBREQDT,2,3)
 S STAT=$P(^DVB(396,+Y,1),U,12)
 S VAR(2,0)="0,0,0,1:1,0^Status is "_$S(STAT'="":"FINALIZED",1:"OPEN")
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
ALERT1 ;
 I STAT'="" DO
 .S VAR(1,0)="0,0,0,1,0^"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .S DIR("A")="Do you want to delete the existing 7131 for this date: "
 .S DIR(0)="YAO"
 .S DIR("B")="NO"
 .S DIR("?")="Answer YES or No.  You may not have two 1731s fo rthe same admission date."
 .D ^DIR
 .K DIR
 .I $D(DTOUT)!($D(DUOUT))!(Y="") S DVBAQUIT=1 Q
 .I 'Y S DVBASTOP=1 Q
 .I Y DO
 ..S DA=+DVBAENTR
 ..D REOPEN^DVBAUTL2
 ..K DA
 ..Q
 .Q
 Q
 ;
ASK1 ;ask the user if they wish to add a new 7131 request.
 S VAR(1,0)="1,0,0,1,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 S DIR("A",1)="Do you want to add a NEW 7131"
 S DIR("A")="for "_$P(PNAM,",",2,99)_" "_$P(PNAM,",",1,1)_" :"
 S DIR(0)="YAO"
 S DIR("B")="NO"
 S DIR("?")="'YES' to enter a new 7131. 'NO' to search for an existing one."
 D ^DIR
 K DIR
 I $D(DUOUT)!($D(DTOUT)) S DVBAQUIT=1 Q
 I Y=0 S DVBASTOP=1 Q
 Q
 ;
ASK ;ask the user if they wish to edit the existing 7131 request.
 S VAR(1,0)="1,0,0,1,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 S DIR("A")="Are you sure you want to edit this 7131 request: "
 S DIR("B")="NO"
 S DIR("?")="'YES' to edit the 7131 request."
 S DIR(0)="YAO"
 D ^DIR
 K DIR
 I $D(DUOUT)!($D(DTOUT)) S DVBAQUIT=1 Q
 I Y=0 S DVBASTOP=1 Q
 I Y=1 S DVBAEDT=1
 Q
 ;
STUFF ;enters the 7131 into the 7131 form file.
 K DA,DIC("S"),DD,DO
 S DLAYGO=396,DIC(0)="QLM",DIC="^DVB(396,",X=+DFN
 D FILE^DICN
 I 'Y DO  S DVBASTOP=1 Q
 .S VAR(1,0)="1,0,0,2,0^Unable to add this new record!"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .Q
 I '$$LOCK^DVBAUTL6(Y) S DVBASTOP=1 Q
 S DVBAENTR=+Y
 S DR="1////"_CNUM_";2////"_SSN_";3////"_DVBREQDT_";23////"_DT_";24////"_DT_";27////"_LOC_";28////"_OPER_";30////"_$S($D(ADMNUM):"A",1:"L")
 S DIE=DIC
 D ^DIE
 K DLAYGO,DIC,DIE
 Q
 ;

DVBAREG3
DVBAREG3 ;ALB/JLU;continuation of DVBAREG2 and DVBAREG1
 ;;2.7;AMIE;;Apr 10, 1995
 ;
DOC(ANS) ;returns a document type.
 ;the return will either be a "A" for admission or "L"
 S ANS=$S(^TMP("DVBA",$J,ANS)["ADMISSION":"A",1:"L")
 Q ANS
 ;
PAT() ;this is a function call to look up the patient
 N STOP
 S DIC="^DPT(",DIC(0)="AEMQZ",DIC("A")="Enter Patient name: "
 K DIC("W")
 D ^DIC
 I $D(DTOUT)!($D(DUOUT))!(X="") S STOP=0
 E  S STOP=Y
 Q STOP
 ;
SET1 ;sets more variables
 S (ONFILE,REOPEN,ARROWOUT,OUT)=0
 Q
 ;
SET2 ;sets the patient information variables
 S PNAM=$P(DFN,U,2),SSN=$P(^DPT(+DFN,0),U,9)
 S CNUM=$S($D(^DPT(+DFN,.31)):$P(^(.31),U,3),1:"Unknown")
 Q

DVBAREN1
DVBAREN1 ;ALB/JLU;NEW 7131 REQ FOR NON-ADMIT VETS;9/20/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;this routine contains the logic to search for admissions, appointments, dispositions, and stop codes.
 ;
OLD ;this is the main entry point.
 S DVBANL=0
 I DVBCHK="A" D A1,COLADM
 I DVBCHK="N" D N1,COLAPT,COLLOG,COLSTP
 I DVBCHK="B" D B1,COLADM,COLAPT,COLLOG,COLSTP
 K DVBAWARN
 Q
A1 ;writes header statement for admission dates
 S VAR(1,0)="0,0,0,2:1,1^The following is a list of Admission dates for "_$P(DFN,U,2)
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
N1 ;writes the header statement for activity dates
 S VAR(1,0)="0,0,0,2:1,1^The following is a list of activity dates for "_$P(DFN,U,2)
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
B1 ;writes the header statement for both admission and activity dates
 S VAR(1,0)="0,0,0,2:1,1^The following is a list of Admission and Activity dates for "_$P(DFN,U,2)
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
COLADM ;gathers the admission info. and stores in to the ^TMP global
 I DVBBDT=0 DO
 .N X,X1,X2
 .S X1=0
 .F X=1:1 S X1=$O(^DGPM("ATID1",+DFN,X1)) Q:'X1  D ADMSET(X1)
 .Q
 I DVBBDT>0 DO
 .N DVBBDT1,DVBEDT1,X,X1,X2
 .S DVBBDT1=9999999.9999999-(DVBBDT-.0000001)
 .S DVBEDT1=9999999.9999999-DVBEDT
 .S X1=DVBEDT1
 .F X=1:1 S X1=$O(^DGPM("ATID1",+DFN,X1)) Q:'X1!(X1>DVBBDT1)  D ADMSET(X1)
 .Q
 Q
 ;
ADMSET(A) ;starts the process of setting up the ^TMP global
 ;A is the internal entry number of the admission in the patient movement
 ;file.
 N X2,X3
 S X2=$O(^DGPM("ATID1",+DFN,A,0))
 S X3=$P(^DGPM(X2,0),U,4)
 Q:X3']""
 D SET(A,9999999.9999999-A,"ADMISSION",$P(^DG(405.1,X3,0),U,1),X2)
 S DVBANL=DVBANL+1
 Q
 ;
COLAPT ;gathers the appointment information
 I DVBBDT=0 DO
 .N X,X1,X2
 .S X1=0
 .F X=1:1 S X1=$O(^DPT(+DFN,"S",X1)) Q:'X1  D APTSET(X1)
 .Q
 I DVBBDT>0 DO
 .N X,X1
 .S X1=DVBBDT-.0000001
 .F X=1:1 S X1=$O(^DPT(+DFN,"S",X1)) Q:'X1!(X1>DVBEDT)  D APTSET(X1)
 .Q
 Q
 ;
APTSET(A) ;begins to set up the ^TMP global for appointments
 N X2
 S X2=$P(^DPT(+DFN,"S",A,0),U,1)
 S X2=$S($D(^SC(X2,0)):$P(^(0),U,1),1:"Unknown")
 D SET(9999999.9999999-X1,X1,"Appointment",X2)
 S DVBANL=DVBANL+1
 Q
 ;
COLSTP ;gathers the stop code information
 I DVBBDT=0 DO
 .N DVBA,DVBA1,DVBA3,DVBA4,DVBALA,DVBA6
 .S DVBA1=0
 .F DVBA=1:1 S DVBA1=$O(^SDV("C",+DFN,DVBA1)) Q:'DVBA1  DO
 ..S DVBA3=9999999.9999999-DVBA1
 ..S DVBA4=0
 ..F DVBA6=1:1 S DVBA4=$O(^SDV(DVBA1,"CS",DVBA4)) Q:'DVBA4
 ..D SET(DVBA3,DVBA1,"Stop Code(s)",(DVBA6-1)_" Stops")
 ..S DVBANL=DVBANL+1
 ..Q
 .Q
 I DVBBDT>0 DO
 .N X,X1,DVBBDT1
 .S X1=DVBBDT-1
 .F X=1:1 S X1=$O(^SDV("ADT",+DFN,X1)) Q:'X1!(X1>DVBEDT)  DO
 ..N X2,X3,X4
 ..S X4=^(X1) ;naked from loop
 ..Q:'$D(^SDV(X4,0))
 ..S X3=0
 ..F X2=1:1 S X3=$O(^SDV(X4,"CS",X3)) Q:'X3  ;only counting the stop codes
 ..D SET(9999999.9999999-X4,X4,"Stop Code(s)",X2_" Stops")
 ..S DVBANL=DVBANL+1
 ..Q
 .Q
 Q
 ;
COLLOG ;gathers the disposition information
 I DVBBDT>0 DO
 .N DVBBDT1,DVBEDT1,DVBA,DVBA1,DVBA2,DVBVAR
 .S DVBBDT1=9999999.9999999-(DVBBDT-.0000001)
 .S DVBEDT1=9999999.9999999-DVBEDT
 .S DVBA1=DVBEDT1
 .F DVBA=1:1 S DVBA1=$O(^DPT(+DFN,"DIS",DVBA1)) Q:'DVBA1!(DVBA1>DVBBDT1)  D DISSET(DVBA1)
 .Q
 I DVBBDT=0 DO
 .N DVBA,DVBA1,DVBA2
 .S DVBA1=0
 .F DVBA=1:1 S DVBA1=$O(^DPT(+DFN,"DIS",DVBA1)) Q:'DVBA1  D DISSET(DVBA1)
 .Q
 Q
 ;
DISSET(DVBA2) ;begins to set up the ^TMP with dispositions
 I '$D(^DPT(+DFN,"DIS",0)),'$D(DVBAWARN) DO
 .S VAR(1,0)="1,0,0,2:1,0^There is a problem with the Disposition Login information.  Contact IRM"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .D CONTMES^DVBCUTL4
 .S DVBAWARN=""
 I $D(^DPT(+DFN,"DIS",0)) DO  ;**Bullet Proof
 .K ^UTILITY("DIQ1",$J)
 .S DIC="^DPT(",DA=+DFN,DR=1000,DA(2.101)=DVBA2
 .S DR(2.101)=1,DIQ(0)="E"
 .D EN^DIQ1
 .K DIQ,DIC,DR,DA
 .D SET(DVBA2,9999999.9999999-DVBA2,"Disposition Login",^UTILITY("DIQ1",$J,2.101,DVBA2,1,"E"))
 .S DVBANL=DVBANL+1
 Q
 ;
SET(IDT,CDT,TYP,FTYP,X2) ;
 N VAR1
 S $P(VAR1," ",22)=""
 S Y=CDT
 D DD^%DT
 S ^TMP("DVBA",$J,IDT)=Y_$E(VAR1,1,23-$L(Y))_TYP_": "_FTYP_"^"_$S($D(X2):X2,1:"")
 Q
 ;

DVBAREQ1
DVBAREQ1 ;ALB/GTS-557/THM-AMIE NEW REQUESTS; 21 JUL 89@0128
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 D INIT
 S DVBSEL=$$SELECT^DVBAUTL5("Date Range","7131 Request")
 I DVBSEL="D" D BYDATE
 I DVBSEL="N" D BYNAME
 D KILL^DVBAREQS
 Q
 ;
BYDATE ;Selection by the date like old way
 F  DO  Q:DVBOUT
 .S DVBSTOP=0,DVBOUT=0
 .D KILL1^DVBAREQS
 .D LINE
 .D REMOTE
 .I DVBOUT Q
 .D DATE
 .I DVBOUT Q
 .S DVBVER=$$VERSION^DVBAREQS()
 .I DVBVER=0 S DVBOUT=1 Q
 .I DVBVER="S" D ^DVBAREQS Q
 .D DEVICE
 .I DVBOUT!(DVBSTOP) Q
 .I DVBVER="L" DO
 ..D GO
 ..D EXIT
 ..Q
 .Q
 Q
 ;
BYNAME ;Selection by patient name
 F  DO  Q:DVBOUT
 .S DVBSTOP=0,DVBOUT=0
 .D KILL1^DVBAREQS
 .D LINE
 .S DVBDA=$$PAT^DVBAUTL5(7131)
 .S XDIV="ALL"
 .I DVBDA<0!('DVBDA) S DVBOUT=1 Q
 .S DVBVER=$$VERSION^DVBAREQS()
 .I DVBVER=0 S DVBOUT=1 Q
 .I DVBVER="S" DO
 ..S DA=DVBDA
 ..D NAME^DVBAREQS
 ..Q
 .I DVBVER="L" DO
 ..S DVBDA=+DVBDA
 ..S (BDT,EDT)=""
 ..D DEVICE
 ..I DVBOUT!(DVBSTOP) Q
 ..S QQ=1,NODTA=0,DA=+DVBDA U IO
 ..D PRINT^DVBAREQ3
 ..D EXIT
 ..Q
 .Q
 Q
 ;
LINE ;LINE FEED
 S VAR(1,0)="0,0,0,3,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
REMOTE ;Get remote site name from user
 S XDIV=""
 S VAR(1,0)="0,0,0,2,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 S DIC("A")="For REMOTE SITE (Press RETURN for all sites) : ",DIC(0)="AEQM",DIC="^DG(40.8,"
 D ^DIC
 I $D(DTOUT)!(X=U) S DVBOUT=1 Q
 I +Y>0 S XDIV=+Y
ASK I +Y<0 DO
 .S DIR(0)="YA"
 .S DIR("A")="Are you sure you want ALL REMOTE SITES: "
 .S DIR("B")="NO"
 .S DIR("?")="Enter Y to get all remote sites N for just one"
 .D ^DIR
 .I $D(DTOUT)!($D(DUOUT)) S DVBOUT=1 Q
 .I Y=1 S XDIV="ALL"
 .I Y=0 S VAR=1
 .Q
 I $D(VAR) G REMOTE
 K VAR,DIR
 Q
 ;
DATE ;Gets beginning and ending dates from user
 S VAR(1,0)="0,0,0,1,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 S %DT(0)=-DT,%DT("A")="BEGINNING date: ",%DT="AE"
 D ^%DT
 I X="^"!(Y=-1) S DVBOUT=1 Q
 S BDT=Y
 S %DT("A")="   ENDING date: "
 D ^%DT
 I X="^"!(Y=-1) S DVBOUT=1 Q
 S EDT=Y_".2359"
 I EDT<BDT DO  G DATE
 .S VAR(1,0)="1,0,0,2:2,0^Invalid dates!  Ending must not be before beginning."
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .D PAUSE^DVBCUTL4
 .Q
 K %DT
 Q
 ;
GO D STM^DVBCUTL4
 S QQ=1,NODTA=0 U IO
 ;
DATA S MA=BDT-.5 F J=0:0 S MA=$O(^DVB(396,"AE",MA)) Q:MA>EDT!(MA="")  S:XDIV'="ALL" LPDIV=+XDIV-1 S:XDIV="ALL" LPDIV="" DO LOOPDIV
 D EXIT
 Q
 ;
LOOPDIV ;** Loop through Division - 'AE' X-ref
 F LPVAR=0:0 S LPDIV=$O(^DVB(396,"AE",MA,LPDIV)) Q:(LPDIV=""!(XDIV'="ALL"&(XDIV'=LPDIV)))  D LOOPDA
 K LPVAR
 Q
 ;
LOOPDA ;** Loop through DA - 'AE' X-ref
 F DA=0:0 S DA=$O(^DVB(396,"AE",MA,LPDIV,DA)) Q:DA=""  DO
 .I $D(DVBATASK) D:'$D(^TMP($J,LPDIV,DA)) PRINT^DVBAREQ3 S QQ=1
 .I '$D(DVBATASK) D:'$D(^TMP($J,DA)) PRINT^DVBAREQ3 S QQ=1
 Q
 ;
EXIT I NODTA=0 DO
 .U IO
 .I IOST?1"C-".E S VAR(1,0)="0,0,0,0,1^" D WR^DVBAUTL4("VAR") K VAR
 .S VAR(1,0)="0,0,0,3,0^Notice to MAS on "_FDT(0)
 .S VAR(2,0)="0,0,0,1,0^There were no new 7131 requests"
 .S VAR(3,0)="0,0,0,1:3,0^"_$S(XDIV'="ALL":"for "_$P(^DG(40.8,XDIV,0),U,1)_" ",1:"")
 .I BDT]"" DO
 ..S Y=$P(BDT,".",1)
 ..X ^DD("DD")
 ..S VAR(3,0)=VAR(3,0)_"from "_Y_" to "
 ..S Y=$P(EDT,".",1)
 ..X ^DD("DD")
 ..S VAR(3,0)=VAR(3,0)_Y
 ..Q
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .Q
 D ^%ZISC
 Q
 ;
TASK S X="T-1" D ^%DT S BDT=Y
 S X="T-1" D ^%DT S EDT=Y_".2359"
 S Y=DT X ^DD("DD") S FDT(0)=Y
 D NOPARM^DVBAUTL2
 I $D(DVBAQUIT) D KILL^DVBAREQS Q
 S DVBSEL="D",DVBATASK=""
 S HOSP=$$SITE^DVBCUTL4
 F ZI=0:0 S ZI=$O(^DVB(396.1,1,2,"B",ZI)) Q:ZI=""  F ZJ=0:0 S ZJ=$O(^DVB(396.1,1,2,"B",ZI,ZJ)) Q:ZJ=""  D CLIN
 D KILL^DVBAREQS
 Q
 ;
DEQUE Q:'$D(XDIV)
 I DVBSEL="D" D GO
 I DVBSEL="N" DO
 .S DA=DVBDA,QQ=1,NODTA=0
 .D PRINT^DVBAREQ3
 .D EXIT
 .Q
 D KILL^DVBAREQS
 Q
 ;
CLIN ;Logic not changed, it is the original - needs to be
 ;looked at for efficiency
 S XDIV=ZI,ZTRTN="GO^DVBAREQ1",ZTIO=$P(^DVB(396.1,1,2,ZJ,0),U,2),ZTDESC="AMIE New Req for "_$S($D(^DG(40.8,XDIV,0)):$P(^(0),U,1),1:"Unknown")
 F I="DVBATASK","DVBSEL","FDT(0)","XDIV","BDT","EDT","HOSP" S ZTSAVE(I)=""
 S ZTDTH=$H D ^%ZTLOAD
 Q
 ;
INIT ;Initialize variables
 S DVBOUT=0
 D NOPARM^DVBAUTL2
 I $D(DVBAQUIT) S DVBOUT=1
 D HOME^%ZIS
 D HDR
 S DVBAMAN=""
 S HOSP=$$SITE^DVBCUTL4
 S Y=DT X ^DD("DD") S FDT(0)=Y
 K NOASK
 Q
 ;
HDR ;Writes header info
 S VAR(1,0)="0,0,0,1:3,1^AMIE New Request Report"
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
DEVICE ;Get device to print to
 S VAR(1,0)="0,0,0,1,0^"
 D WR^DVBAUTL4("VAR")
 K VAR
 S %ZIS="Q"
 D ^%ZIS
 K %ZIS
 I POP S DVBOUT=1 Q
 I $D(IO("Q")) DO
 .S NOASK=1,DVBSTOP=1
 .S ZTRTN="DEQUE^DVBAREQ1"
 .S ZTIO=ION,ZTDESC="Amie new request rpt"
 .F I="DVBSEL","DVBDA","FDT(0)","XDIV","BDT","EDT","VER","NOASK","HOSP","DVBAMAN" S ZTSAVE(I)=""
 .D ^%ZTLOAD
 .D ^%ZISC
 .I $D(ZTSK) DO
 ..S VAR(1,0)="0,0,0,2:2,0^Request queued."
 ..D WR^DVBAUTL4("VAR")
 ..K VAR
 ..Q
 .Q

DVBAREQ3
DVBAREQ3 ;ALB/GTS-557/THM-PRINT ROUTINE NEW REQUEST RPT ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 ;
PRINT S:$D(DVBATASK) ^TMP($J,LPDIV,DA)="" ;**Only 1 7131 printed per division
 S:'$D(DVBATASK) ^TMP($J,DA)="" ;**Only 1 7131 printed.
 S DFN=$P(^DVB(396,DA,0),U,1),ADMDT=$P(^(0),U,4),RDATE=$P(^(1),U,1),PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^(.31)):$P(^(.31),U,3),1:"Unknown"),DOCTYPE=$P(^DVB(396,DA,2),U,10)
 S ADIV=$S($D(^DVB(396,DA,2)):$P(^(2),U,9),1:"")
 I DVBSEL="D" Q:'$D(XDIV)  D HEADER
 I DVBSEL="N" D HEADER2
 S NODTA=1
 W !,PNAM,?49,"SSN: ",SSN,!,?44,"CLAIM NO: ",CNUM,!,?38,$S(DOCTYPE="L":" ACTIVITY DATE: ",1:"ADMISSION DATE: "),$E(ADMDT,4,5),"/",$E(ADMDT,6,7),"/",$E(ADMDT,2,3),!
 W ?40,"REQUEST DATE: ",$E(RDATE,4,5),"/",$E(RDATE,6,7),"/",$E(RDATE,2,3),!!,?3,"Items Requested:",!
 ;
ITEMS F Q=5,6,7,8,16,18,20,22,24,27 I $P(^DVB(396,DA,0),U,Q)'="NO" D PRINT1
 I $P(^DVB(396,DA,0),U,25)'="" S Q=25 D GETDIV S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(20+(23-$L(MC))))_")" W !,?8,MD,GDIV,": ",$P(^DVB(396,DA,0),U,25)
 S DVBAWO="N"
 K ^UTILITY($J,"W") W !!,"Remarks: " S DIWL=5,DIWR=65,DIWF="WB5I9"
 F LPCNT=1:1 S X=($S($D(^DVB(396,DA,5,LPCNT,0)):^(0),1:"")) Q:X=""  D ^DIWP S DVBAWO="Y"
 K LPCNT,DIWL,DIWR,DIWF
 I DVBAWO="Y" D ^DIWW
 K DVBAWO W !! W:$D(^DVB(396,DA,2)) "Requested by: ",$S($P(^DVB(396,DA,2),U,8)]"":$P(^(2),U,8),1:" (Not specified)")," AT ",$S($P(^(2),U,7)]"":$P(^(2),U,7),1:" (Not specified) "),!
 I $D(^DVB(396,DA,1)) I $P(^DVB(396,DA,1),U,12)'="" S FNLDT=$P(^(1),U,12) W !!,"This record was FINALIZED on ",$E(FNLDT,4,5)_"/"_$E(FNLDT,6,7)_"/"_$E(FNLDT,2,3)
 I ADIV="" W !,?5."**Request is incomplete, contact the Regional Office to complete**"
 I IOST?1"PK-"!(IOST?1"P-") W !!!!!,"Record Processing Notes: " F LN=1:1:50 W "-" ;print processing notes for admin folder if not going to a screen
 W !! D TOP
 Q
 ;
HEADER W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!!!,"AMIE 7131 NEW REQUEST REPORT FOR ",$E(BDT,4,5),"/",$E(BDT,6,7),"/",$E(BDT,2,3)," TO ",$E(EDT,4,5),"/",$E(EDT,6,7),"/",$E(EDT,2,3)_" * LONG VERSION *",!
 I ADIV="" W ?5,"FOR ",HOSP,", DIVISION NOT GIVEN"
 I ADIV'="" S DIVHD=$S($D(^DG(40.8,ADIV,0)):$P(^(0),U,1),1:"") W ?5,"FOR ",HOSP W:DIVHD]"" ", DIVISION ",DIVHD,!! I DIVHD="" W ", UNABLE TO DETERMINE DIVISION",!!
 S DVBAON2=""
 Q
 ;
PRINT1 D GETDIV
 I QQ S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(9+(23-$L(MD))))_")" W !,?8,MD,GDIV S QQ='QQ Q
 I 'QQ S MC=$T(@Q),MD=$P(MC,";;",2) S GDIV=" ("_$E(GDIVNAM,1,(9+(22-$L(MD))))_")" W ?46,MD,GDIV S QQ='QQ
 Q
 ;
TOP K ANS I IOST?1"C-".E,'$D(NOASK) W !!,*7,"Press RETURN to continue or ""^"" to stop   " R ANS:DTIME S:'$T ANS=U I ANS=U S DA="",MA=9999999
 Q
 ;
HEADER2 ;prints a heading for the name selection
 I IOST?1"C-".E!($D(DVBAON2)) DO
 .S VAR(1,0)="0,0,0,0,1^"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .Q
 S VAR(1,0)="0,0,0,4:1,0^AMIE 7131 NEW REQUEST REPORT FOR "_PNAM_" **Long Version**"
 I ADIV="" S VAR(2,0)="0,0,5,0,0^FOR "_HOSP_", DIVISION NOT GIVEN"
 I ADIV'="" DO
 .S DIVHD=$S($D(^DG(40.8,ADIV,0)):$P(^(0),U,1),1:"")
 .S VAR(2,0)="0,0,5,1:2,0^FOR "_HOSP_", DIVISION "_$S(DIVHD]"":DIVHD,1:"UNABLE TO DETERMINE")
 .Q
 D WR^DVBAUTL4("VAR")
 K VAR
 Q
 ;
GETDIV ;** Get the division for 7131 Rpt
 I $D(^DVB(396,DA,6)) DO
 .I Q=5 S GDIVPTR=$P(^DVB(396,DA,6),"^",9)
 .I Q=6 S GDIVPTR=$P(^DVB(396,DA,6),"^",11)
 .I Q=7 S GDIVPTR=$P(^DVB(396,DA,6),"^",13)
 .I Q=8 S GDIVPTR=$P(^DVB(396,DA,6),"^",15)
 .I Q=24 S GDIVPTR=$P(^DVB(396,DA,6),"^",7)
 .I Q>15&(Q'=24) DO
 ..S DVBAPCE=Q+1
 ..S GDIVPTR=$P(^DVB(396,DA,6),"^",DVBAPCE)
 ..K DVBAPCE
 S:'$D(GDIVPTR) GDIVPTR=$P(^DVB(396,DA,2),"^",9)
 I $D(GDIVPTR),(GDIVPTR="") S GDIVPTR=$P(^DVB(396,DA,2),"^",9)
 S GDIVNAM=$P(^DG(40.8,GDIVPTR,0),"^",1)
 K GDIVPTR
 Q
 ;
FIELDS ;
5 ;;NOTICE OF DISCHARGE
6 ;;HOSPITAL SUMMARY
7 ;;21-DAY CERTIFICATE
8 ;;OTHER/EXAM REVIEW RMKS
16 ;;SPECIAL REPORT
18 ;;COMPETENCY REPORT
20 ;;VA FORM 21-2680
22 ;;ASSET INFORMATION
24 ;;ADMISSION REPORT
25 ;;OPT TREATMENT REPORT
27 ;;BEGINNING DATE/CARE
 Q

DVBAREQS
DVBAREQS ;ALB ISC/THM-SHORT RPT FOR NEW 7131 REQUESTS; 21 JUL 89@0129 
 ;;2.7;AMIE;;Apr 10, 1995
 ;called by DVBAREQ1 for short version of new requests
 ;
SETUP S %DT="AE",DIC="^DVB(396,",BDT1=$E(BDT,4,5)_"/"_$E(BDT,6,7)_"/"_$E(BDT,2,3),EDT1=$E(EDT,4,5)_"/"_$E(EDT,6,7)_"/"_$E(EDT,2,3)
 I XDIV'="ALL" S (BDIV,EDIV)=$P(^DG(40.8,XDIV,0),U,1)
 I XDIV="ALL" S BDIV="@",EDIV=999
 ;
INFO S DHD="VARO 7131 NEW REQUEST REPORT FOR "_BDT1_" TO "_EDT1_" * SHORT VERSION *",L=0,FLDS=".01;L15,1;L12,2;L12,NUMDATE(#3);L8;""ACT/ADM DATE"",23;L11,29;L9"
 S DHIT="D WRDIV^DVBAUTL2"
 I XDIV="ALL" S BY="DOCUMENT TYPE;S2,DATE OF REQUEST,DIVISION,PATIENT NAME",FR="  ,"_BDT_","_BDIV_",       ",TO="ZZ,"_EDT_","_EDIV_",ZZZZZZZZZZZZZZZ"
 ;
 I XDIV'="ALL" DO
 .S BY="DOCUMENT TYPE;S2"_",DATE OF REQUEST,PATIENT NAME"
 .S FR="  ,"_BDT_",       ",TO="ZZ,"_EDT_",ZZZZZZZZZZZZZZZ"
 .S DIS(0)="D CHKDIV^DVBAUTL2 I $D(DVXST)"
 S DHIT="I $P($G(^DVB(396,D0,2)),U,9)="""" W ?9,""** REGIONAL OFFICE MUST EDIT THE INCOMPLETE REQUEST LISTED ABOVE **"",!"
 ;
PRINT D EN1^DIP
 ;
EXIT K FR,BY,DIS,DHIT,TO,L,FLDS,DHD
 Q
 ;
NAME ;this is called from DVBAREQ1 when a selection is made by name.
 S DHD="VARO 7131 NEW REQUEST REPORT FOR "_$P(DA,U,2)_" * SHORT VERSION *",(FR,TO)=+DA,BY="@NUMBER"
 S L=0,DIC="^DVB(396,"
 S FLDS=".01;L15,1;L12,2;L12,NUMDATE(#3);L8;""ACT/ADM DATE"",23;L11,29;L9"
 D PRINT
 Q
 ;
VERSION() ;Get whether user wants long or short version
 N DTOUT,DUOUT,Y
 S DIR(0)="SM^L:Long;S:Short",DIR("A")="Select version",DIR("B")="Long"
 D ^DIR
 K DIR
 I $D(DTOUT)!($D(DUOUT)) Q 0
 Q $S(Y="L"!(Y="S"):Y,1:0)
 ;
KILL1 ;
 K DVBDA,DVBVER,DA,NODTA,QQ,DVBAON2,^TMP($J),VAR
 Q
 ;
KILL S XRTN=$T(+0)
 D SPM^DVBCUTL4
 I $D(ZTQUEUED)&($D(DVBAMAN)) D KILL^%ZTLOAD
 K DVBAON2,DVBAMAN,^TMP($J),LPDIV,DVBOUT,DVBSEL,VAR,DVBVER,DVBDA,DVBATASK,DVBSTOP
 D KILL^DVBAUTIL
 Q
 ;

DVBARL21
DVBARL21 ;ALB/GTS-557/THM-EDIT 21 DAY CERTIFICATE TEXT ;21 JUL 89@0600
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 I $D(DUZ)#2=0 W *7,!!,"You have no user number.",!! H 3 Q
TERM D HOME^%ZIS S OPER=$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"Unknown"),HD="21-DAY CERTIFICATE TEXT ENTRY/EDITING"
 S DVBAENTR=0
 ;
SETUP D UNLOCK^DVBAUTL6(DVBAENTR)
 K DVBAQUIT W @IOF S DIE="^DVB(396,",DR="6.81;D RELEASE^DVBARL21 I $D(DVBAQUIT) S Y=""@99"";6.82////R;6.83////"_DT_";6.84///"_OPER_";W !!,""This record is now released."",!! H 2;@99",DIC=DIE,DIC(0)="AEQM",DIC("A")="Enter PATIENT NAME: "
 I '$D(^XUSEC("DVBA 21-DAY CERT CLERK",+DUZ)) W !!,*7,"You do not have the proper key to use this option.",!! H 3 G EXIT
 D DICW^DVBAUTIL
 ;
EDIT D ^DIC G:X=U!(X="") EXIT W:Y<0 *7,"  ??" G:Y<0 EDIT
 S OUT=0
 I '$$LOCK^DVBAUTL6(Y) G SETUP
 I Y>0 S DVBAENTR=+Y,DA=+$P(Y,U,1),DFN=$P(Y,U,2),NAME=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9) W !!
 I $D(^DVB(396,DA,2)) I $P(^(2),U,10)="L" W !!,*7,"Wrong request type !",!,"This is an ACTIVITY DATE request, not ADMISSION DATE.",!! H 3 G SETUP
 ;I $P(^DVB(396,DA,1),U,12)]"" W !!,*7,"This request has already been FINALIZED and the text may not be changed.",!! H 3 G SETUP ;for future revisions
 I $P(^DVB(396,DA,0),U,7)'="YES" W *7,!!,"No 21-day certificate has been requested for this Veteran.",!! H 3 G SETUP
 I $P(^DVB(396,DA,0),U,7)="YES",'$D(^(4)) W !!,*7,"This Veteran has a 21-day certificate requested but",!," it has not yet been processed.",!! H 3 G SETUP
 I $P(^DVB(396,DA,4),U,1)'="N" W !!,*7,"This certificate has been released to the RO",!,$S($P(^(4),U,1)="R":" but has not been printed.",$P(^(4),U,1)="P":" and has already been printed.",1:" but the status is unknown."),!! H 3 G SETUP
 S Y=$P(^DVB(396,DA,0),U,4) X ^DD("DD") S ADMDT=Y
 H 1 W @IOF,!?(79-$L(HD)\2),HD,!!!,?15,"Name: ",NAME,!,?16,"SSN: ",SSN,?40,"Admit date: ",ADMDT,!!! D ^DIE
 G SETUP
 ;
EXIT W @IOF K DVBAENTR,OUT,WWHO,DVBAQUIT G KILL^DVBAUTIL
 Q
RELEASE ;verify release is ok
 I '$D(^XUSEC("DVBA RELEASE 21-DAY CERT",+DUZ)) S DVBAQUIT=1 Q
 W !!,"Ok to release this 21-day certificate text" S %=2 D YN^DICN
 I $D(%Y) I %Y["?" W !!,"Enter Y to go ahead and release this certificate to the RO",!,"or N to be able to make corrections and release later.",!! G RELEASE
 I %'=1 S DVBAQUIT=1
 Q

DVBARPUR
DVBARPUR ;557/THM-PURGE AMIE FILES ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 ;NOTE:  This program was designed to run on the TaskManager.  There is
 ;       no output at all.  It will, however, run real-time, if desired.
 ;
SETUP D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) EXIT ;no parameters set
 I '$D(DT) S X="T" D ^%DT S DT=Y
 ;
PART1 ;for 7131 file--^DVB(396,
 S HIST=$S($P(^DVB(396.1,1,0),U,10)]"":$P(^(0),U,10),1:60) ;IF NOTHING SET, KEEP 60 DAYS
 D DATE
GO S MA="" F I=0:0 S MA=$O(^DVB(396,"F",MA)) Q:MA=""  S MB="" F J=0:0 S MB=$O(^DVB(396,"F",MA,MB)) Q:MB=""  D KILL
 D PART2
 ;
EXIT K DVBAQUIT,NODE,DIK,X,Y,MA,MB,I,J,DA,PDATE,X1,X2,HIST,%,%DT,%H,LOC
 Q
 ;
KILL I '$D(^DVB(396,MB,0)) K ^DVB(396,"F",MA,MB)
 I $D(^DVB(396,MB,0)) DO 
  .S X1=PDATE,X2=MA D ^%DTC I X>0 S DA=MB,DIK="^DVB(396," D ^DIK K DIK,DA
 Q
DATE S X1=DT,X2=HIST,X2=-X2 D C^%DTC S PDATE=X
 Q
PART2 ;for NOTICE OF DISCHARGE file--^DVB(396.2
 S HIST=30 D DATE
 F LOC=0:0 S LOC=$O(^DVB(396.2,"C",LOC)) Q:LOC=""  F NODE=0:0 S NODE=$O(^DVB(396.2,"C",LOC,"P",NODE)) Q:NODE=""  D KILL2
 Q
 ;
KILL2 I '$D(^DVB(396.2,NODE)) K ^DVB(396.2,"C",LOC,"P",NODE) Q
 S X1=PDATE,X2=$P(^DVB(396.2,NODE,0),U,5) D ^%DTC I X>0 S DA=NODE,DIK="^DVB(396.2," D ^DIK K DIK,DA
 Q

DVBARQP
DVBARQP ;ALB/JLU-7131 request processing routine ;1/28/93
 ;;2.7;AMIE;;Apr 10, 1995
BEG ;
 D INITIAL
 D INITRPT^DVBAUTL3
 F  DO  I DVBANY>0!($D(DTOUT)) Q
 .S DVBAOUT=0
 .F  DO  I $D(DTOUT)!($D(DUOUT))!(DVBAOUT) Q
 ..D DRAW
 ..D READ I $D(DTOUT)!($D(DUOUT))!(DVBAOUT) Q
 ..D ADJ
 ..Q
 .D FILE
 .Q
 D EXIT
 Q
 ;
EXIT K A,ADMNUM,DA,DIE,DIR,DR,DTOUT,DUOUT,DVBADSCH,DVBAER,DVBAHD21,DVBAHD22,DVBALN,DVBAOLD,DVBAOUT,DVBARPT,DVBATDT,DVBATITL,DVBAX,X,Z,DVBAP,DVBAO,DVBANY
 Q
 ;
INITIAL ;This subroutine will initialize most of the variable needed for this
 ;option.
 S $P(DVBALN,"-",80)=""
 S DVBATITL="7131 Report Requesting"
 S X="NOW",%DT="ST"
 D ^%DT
 X ^DD("DD")
 S DVBATDT=Y
 I $D(ADMNUM) D ADM
 I DVBDOC="L" D ACT
 D SSNOUT^DVBCUTIL
 S SSN=DVBCSSNO
 S DVBANY=0
 Q
 ;
ADM ;sets up admission date variable and discharge variable if applicable
 S Y=DVBREQDT
 D DD^%DT
 S DVBAHD21="Admission Date: "_Y
 I '$D(^DGPM(+ADMNUM,0)) K Y Q
 I $P(^DGPM(+ADMNUM,0),U,17)]"" DO
 .S Y=$P(^(0),U,17) ;naked from line before
 .S Y=$P(^DGPM(+Y,0),U,1)
 .D DD^%DT
 .S DVBADSCH=Y
 .S DVBAHD22="Discharge Date: "_Y
 .Q
 K Y
 Q
 ;
ACT ;sets up activity date variable
 S Y=DVBREQDT
 D DD^%DT
 S DVBAHD21="Activity Date: "_Y
 K Y
 Q
 ;
DRAW ;This subroutine will draw the screen
 I IOST?1"C-".E W @IOF
 W "Information Request Form"
 W ?35,HNAME
 W ?59,DVBATDT
 W !,DVBALN
 W !,"Patient: "
 W PNAM
 W ?54,"SSN: "
 W SSN
 W !,"Claim #: ",CNUM,!
 W DVBAHD21
 W:$D(DVBAHD22) ?40,DVBAHD22
 W !!,?9,"Report",?37,"Selected",?60,"Status"
 W !,DVBALN
 F DVBAX=0:0 S DVBAX=$O(DVBARPT(DVBAX)) Q:'DVBAX  D DRAW1
 W !,DVBALN
 Q
 ;
DRAW1 ;rights the reports to the screen
 W !,DVBAX
 W ?3,$P(DVBARPT(DVBAX),U,1)
 W ?40,$S($P(DVBARPT(DVBAX),U,2)["Y":"YES",1:"NO")
 W ?60,$S($P(DVBARPT(DVBAX),U,3)="C":"Completed",$P(DVBARPT(DVBAX),U,3)="P":"Pending",1:"")
 Q
 ;
READ ;reads the user answer
 S DIR(0)="LAO^1:10^K:X[""."" X"
 S DIR("A")="Select Report: "
 S DIR("?",1)="Select a number or range of numbers from 1 to 10 (1,3,5 or 2-4,8).  This will"
 S DIR("?",2)="initially mark the report as 'YES'.  If the number is selected again then it"
 S DIR("?")="will be changed to 'NO' or vice versa"
 D ^DIR
 I $D(DUOUT)!($D(DTOUT)) Q
 I 'Y S DVBAOUT=1
 Q
 ;
ADJ ;This subroutine adjusts the local array
 K DVBAER
 N X,A
 F X=1:1:10 S A=$P(Y,",",X) Q:'A  D DISC
 Q
 ;
DISC ;checks for bad answers
 I $D(ADMNUM),$D(DVBADSCH),A=1 DO:'$D(DVBAER)  S DVBAER=1 Q
 .W *7,!,"Vet already discharged - you cannot request Notice of Discharge."
 .W !,?30,"<Return> to continue."
 .R Z:DTIME
 .Q
 I DVBDOC="L",(A=1!(A=2)!(A=3)!(A=9)) DO:'$D(DVBAER)  S DVBAER=1 Q
 .W *7,!,"Cannot select 'Notice of Discharge', 'Hospital Summary', 'Certificate (21-day)', or 'Admission Report' for an activity date."
 . W !,?30,"<Return> to continue."
 .R Z:DTIME
 .Q
 D CHNG
 Q
 ;
CHNG ;updates the local array
 Q:$P(DVBARPT(A),U,3)["C"
 S DVBAOLD=$P(DVBARPT(A),U,2)
 S DVBAOLD=$S(DVBAOLD["Y":"NO",1:"YES")
 S $P(DVBARPT(A),U,2)=DVBAOLD
 S $P(DVBARPT(A),U,3)=$S(DVBAOLD["Y":"P",1:"")
 Q
 ;
FILE ;this subroutine sets the data into the file and asks the last three 
 ;questions
 I $D(DTOUT) S DVBANY=1 D DEL^DVBAUTL3(DVBAENTR):'$D(DVBAEDT) Q
 I $D(DUOUT) DO  Q
 .I '$D(DVBAEDT) S DVBANY=1 D DEL^DVBAUTL3(DVBAENTR) Q
 .S DVBANY=$$ANYSEL(DVBAENTR)
 .I DVBANY'>0 D ERR
 .Q
 D LAST
 I $D(Y) I '$D(DVBAEDT) DO  Q
 .D DEL^DVBAUTL3(DVBAENTR)
 .S DVBANY=1
 .Q
 S DVBANY=$$ANYSEL(DVBAENTR)
 I 'DVBANY D ERR Q
 D STM^DVBCUTL4
 D FILE^DVBAUTL3
 S XRTN=$T(+0)
 D SPM^DVBCUTL4
 ;;;D TEST:'$D(DVBAEDT)
 Q
 ;
ERR ;this subroutine will print out an error message when no reports are
 ;selected on the 7131.
 S VAR(1,0)="1,0,0,2,0^You have not selected any reports for this 7131 request"
 S VAR(2,0)="0,0,0,1:2,0^or have selected number 4 but not entered any remarks."
 D WR^DVBAUTL4("VAR")
 K VAR
 D CONTMES^DVBCUTL4
 Q
 ;
ANYSEL(B) ;
 ;This subroutine checks to see if any reports were selected on the 7131
 ;request.
 ;B is the internal entry number in file 396
 N X,CNT
 S CNT=0
 F X=0:0 S X=$O(DVBARPT(X)) Q:'X!(CNT)  DO  ;checking each report
 . I $P(DVBARPT(X),U,2)="YES" S CNT=1
 .Q
 I $P(^DVB(396,B,0),U,25)]"" S CNT=1 ;checking opt date range
 I $P(DVBARPT(4),U,2)="YES",'$O(^DVB(396,B,5,0)) S CNT=0 ;if no remarks set to zero
 Q CNT
 ;
LAST ;this subroutine will ask the last three questions
 S DIE="^DVB(396,",DA=DVBAENTR
 S DR="18;S X=X;19///^S X=$S($P(^DVB(396,DA,0),U,25)']"""":""@"",$P(^(0),U,26)=""C"":""C"",1:""P"");29Routing Location;.5;23///"_DT_";24///"_DT_";27///"_LOC_";28///"_OPER
 D ^DIE
 Q
 ;
TEST ;tests to see if the user wants this 7131
 D DRAW
 W !,*7,"Do you want to file this request"
 S %=1 D YN^DICN
 I %=2 D DEL^DVBAUTL3(DVBAENTR)
 Q

DVBASCRP
DVBASCRP ;ALB/GTS-557/THM-SC 7131 ADMISSION RPT ;12/3/90  14:58
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP($J) G TERM
SET Q:'$D(^DPT(DA,0))  S DFN=DA,DVBASC="" D SC^DVBAVDPT Q:DVBASC'="Y"  Q:CFLOC'=RONUM&(RO="Y")&(CFLOC'=0)&(CFLOC'=376)  S ^TMP($J,XCN,CFLOC,MB,DA)=MA
 Q
 ;
PRINTB S ADMDT=$P(DATA,U),DFN=DA D ADM^DVBAVDPT
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!!
 S:ADMDT]"" ADMDT=$E(ADMDT,4,5)_"/"_$E(ADMDT,6,7)_"/"_$E(ADMDT,2,3) S:DCHGDT]"" DCHGDT=$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3)
 W ?10,"Patient Name:",?26,PNAM,!!,?14,"Claim No:",?26,CNUM,!,?6,"Claim Folder Loc:",?26,CFLOC,!,?9,"Social Sec No:",?26,SSN,!,?8,"Admission Date:",?26,ADMDT,!,?3,"Admitting Diagnosis:",?26,DIAG,!
 W ?8,"Discharge Date:",?26,DCHGDT,!,?11,"Bed Service:",?26,BEDSEC,!,?13,"Recv A&A?:",?26,$S(RCVAA=0:"NO",RCVAA=1:"YES",1:"Not specified"),!
 W ?14,"Pension?:",?26,$S(RCVPEN=0:"NO",RCVPEN=1:"YES",1:"Not specified"),! D ELIG^DVBAVDPT
 I IOST?1"C-".E W *7,!,"Press RETURN to continue or ""^"" to stop    " R ANS:DTIME S:ANS=U!('$T) QUIT=1 I '$T S DVBAQUIT=1
 S DVBAON2=""
 Q
 ;
PRINT U IO K MA S QUIT=""
 S XCN="" F M=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""!(QUIT=1)  S CFLOC="" F J=0:0 S CFLOC=$O(^TMP($J,XCN,CFLOC)) Q:CFLOC=""!(QUIT=1)  D PRINT1
 Q
PRINT1 S ADM="" F K=0:0 S ADM=$O(^TMP($J,XCN,CFLOC,ADM)) Q:ADM=""!(QUIT=1)  S DA="" F L=0:0 S DA=$O(^TMP($J,XCN,CFLOC,ADM,DA)) Q:DA=""!(QUIT=1)  S DATA=^(DA) D PRINTB
 Q
 ;
TERM D HOME^%ZIS K NOASK
 ;
 W @IOF,!,"VARO SERVICE-CONNECTED ADMISSION REPORT" D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="SERVICE-CONNECTED ADMISSION REPORT",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 W !,HEAD1
 W !!,"Please enter dates for search, oldest date first, most recent date last.",!!,"Last report was run on " S Y=$P(DTAR,U,8) X ^DD("DD") W Y,!!
 D DATE^DVBAUTIL
 G:X=""!(Y<0) KILL
 S %ZIS="Q" D ^%ZIS K %ZIS G:POP KILL^DVBAUTIL
 ;
 I $D(IO("Q")) S ZTRTN="DEQUE^DVBASCRP",ZTIO=ION,NOASK=1,ZTDESC="AMIE SC ADMISSION REPORT" F I="FDT(0)","HEAD","HEAD1","BDATE","EDATE","TYPE","RO","RONUM","NOASK" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! G KILL
 ;
GO S MA=BDATE F J=0:0 S MA=$O(^DGPM("AMV1",MA)) Q:$P(MA,".")>EDATE!(MA="")  F DA=0:0 S DA=$O(^DGPM("AMV1",MA,DA)) Q:DA=""  F MB=0:0 S MB=$O(^DGPM("AMV1",MA,DA,MB)) Q:MB=""  D SET W:'$D(NOASK) "."
 I '$D(^TMP($J)) U IO W !!,*7,"No data found for parameters entered.",!! H 2 G KILL
 D PRINT I $D(DVBAQUIT) K DVBAON2 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBAUTIL
 ;
KILL D:$D(ZTQUEUED) KILL^%ZTLOAD D ^%ZISC S X=8 K DVBAON2 G FINAL^DVBAUTIL
 ;
DEQUE K ^TMP($J) G GO

DVBASITE
DVBASITE ;ALB ISC/THM-SET UP AMIE SITE PARAMETERS; 21 JUL 89@0131
 ;;2.7;AMIE;;Apr 10, 1995
 S HD="AMIE SITE PARAMETER EDITING"
 D HOME^%ZIS
 I $D(^DVB(396.1,1,0)) S DIC("B")=$P(^(0),U,1)
EN1 W @IOF,!?(79-$L(HD)\2),HD,!!
 S DR="[DVBA SITE EDIT]",(DIC,DIE)="^DVB(396.1,"
 S DIC("A")="Enter SITE NAME: ",DLAYGO=396.1,DIC(0)="AEQLM"
 D ^DIC G:X=""!(X=U) EXIT
 I +Y>0 S DA=+Y
 G:Y<0 EXIT D ^DIE
 K DIC,DA,DIE G EN1
EXIT W @IOF,!! K DIC,DIE,DA,Y,X,DR,HD,DLAYGO Q

DVBASPD2
DVBASPD2 ;ALB/GTS-557/THM-AMIE SPECIAL REPORT ; 9/15/91  8:22 PM
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP($J) G TERM
SET Q:'$D(^DPT(DA,0))  S DFN=DA D RCV^DVBAVDPT Q:RCVPEN'=1&(REP="P")  Q:RCVAA'=1&(REP="A")  Q:CFLOC'=RONUM&(RO="Y")&(CFLOC'=0)&(CFLOC'=376)
 S DCHPTR=$P(^DGPM(MB,0),U,17),TDIS=$S($D(^DGPM(+DCHPTR,0)):$P(^(0),U,18),1:"")
 I $D(^DG(405.2,+TDIS,0)) DO
 .I '$D(^TMP("DVBA",$J,"DUP",+TDIS)) Q
 .S TDIS=$S($P(^DG(405.2,+TDIS,0),U,1)]"":$P(^(0),U,1),1:"Unknown discharge type")
 .S ^TMP($J,XCN,CFLOC,MB,DA)=MA_U_RCVAA_U_RCVPEN_U_CNUM_U_TDIS
 .Q
 Q
 ;
PRINTB S TO="",MA=$P(DATA,U),RCVAA=$P(DATA,U,2),RCVPEN=$P(DATA,U,3),CNUM=$P(DATA,U,4),TDIS=$P(DATA,U,5),DFN=DA,QUIT1=1 D ADM^DVBAVDPT
 W:(IOST?1"C-".E)!($D(DVBAON2)) @IOF
 W !!!,?(80-$L(HEAD)\2),HEAD,!,?(80-$L(HEAD1)\2),HEAD1,!!
 S:ADMDT]"" ADMDT=$E(ADMDT,4,5)_"/"_$E(ADMDT,6,7)_"/"_$E(ADMDT,2,3) S:DCHGDT]"" DCHGDT=$E(DCHGDT,4,5)_"/"_$E(DCHGDT,6,7)_"/"_$E(DCHGDT,2,3)
 W ?10,"Patient Name:",?26,PNAM,!!,?14,"Claim No:",?26,CNUM,!,?6,"Claim Folder Loc:",?26,XCFLOC,!,?9,"Social Sec No:",?26,SSN,!,?8,"Admission Date:",?26,ADMDT,!,?3,"Admitting Diagnosis:",?26,DIAG,!
 W ?8,"Discharge Date:",?26,DCHGDT,! W:DCHGDT]"" ?5,"Type of Discharge:",?26,TDIS_$S(TO]"":" TO "_$S($D(^DIC(4,+TO,0)):$P(^(0),U,1),1:""),1:""),!
 W ?11,"Bed Service:",?26,BEDSEC,!,?13,"Recv A&A?:",?26,$S(RCVAA=0:"NO",RCVAA=1:"YES",1:"Not specified"),!
 W ?14,"Pension?:",?26,$S(RCVPEN=0:"NO",RCVPEN=1:"YES",1:"Not specified"),! D ELIG^DVBAVDPT
 I IOST?1"C-".E W *7,!,"Press RETURN to continue or ""^"" to stop    " R ANS:DTIME S:ANS=U!('$T) QUIT=1 I '$T S DVBAQUIT=1 I '$T S DVBAQUIT=1
 S DVBAON2=""
 Q
 ;
PRINT U IO S QUIT=""
 S XCN="" F M=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""!(QUIT=1)  S XCFLOC="" F J=0:0 S XCFLOC=$O(^TMP($J,XCN,XCFLOC)) Q:XCFLOC=""!(QUIT=1)  D PRINT1
 Q
PRINT1 S ADM="" F K=0:0 S ADM=$O(^TMP($J,XCN,XCFLOC,ADM)) Q:ADM=""!(QUIT=1)  S DA="" F L=0:0 S DA=$O(^TMP($J,XCN,XCFLOC,ADM,DA)) Q:DA=""!(QUIT=1)  S DATA=^(DA) D PRINTB
 Q
 ;
TERM D HOME^%ZIS K NOASK
 ;
SETUP W @IOF,!,"VARO REPORT"_$S(REP="A":" FOR A & A",1:" FOR PENSION") S DTAR=^DVB(396.1,1,0),FDT(0)=$E(DT,4,5)_"-"_$E(DT,6,7)_"-"_$E(DT,2,3)
 S HEAD="SPECIAL "_$S(REP="A":"A & A",1:"PENSION")_" REPORT",HEAD1="FOR "_$P(DTAR,U,1)_" ON "_FDT(0)
 W !,HEAD1
EN1 W !!,"Please enter dates for search, oldest date first, most recent date last.",!!,"Last report was run on " S Y=$P(DTAR,U,9) X ^DD("DD") W Y,!!
 D DATE^DVBAUTIL
 G:X=""!(Y<0) KILL
 S %ZIS="Q" D ^%ZIS K %ZIS G:POP KILL^DVBAUTIL
 ;
QUEUE I $D(IO("Q")) S ZTRTN="DEQUE^DVBASPD2",ZTIO=ION,NOASK=1,ZTDESC="AMIE PENSION/A&A REPORT" F I="^TMP(""DVBA"",$J,""DUP""","DVBATYPS","REP","FDT(0)","HEAD","HEAD1","BDATE","EDATE","TYPE","RO","RONUM","NOASK" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! G KILL
 ;
GO S MA=BDATE F J=0:0 S MA=$O(^DGPM("AMV1",MA)) Q:$P(MA,".")>EDATE!(MA="")  W:'$D(NOASK) "." F DA=0:0 S DA=$O(^DGPM("AMV1",MA,DA)) Q:DA=""  F MB=0:0 S MB=$O(^DGPM("AMV1",MA,DA,MB)) Q:MB=""  D SET
 I '$D(^TMP($J)) U IO W !!,*7,"No data found for parameters entered.",!! H 2 G KILL
 D PRINT I $D(DVBAQUIT) D:$D(ZTQUEUED) KILL^%ZTLOAD K DVBAON2 G KILL^DVBAUTIL
 ;
KILL D ^%ZISC D:$D(ZTQUEUED) KILL^%ZTLOAD S X=9 K DVBAON2 G FINAL^DVBAUTIL
 ;
DEQUE K ^TMP($J) G GO

DVBASPDC
DVBASPDC ;ALB/GTS-557/THM-AMIE SPECIAL REPORT SELECTION ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 D HOME^%ZIS
 D NOPARM^DVBAUTL2 G:$D(DVBAQUIT) KILL^DVBAUTIL
EN W @IOF,!,"REGIONAL OFFICE SPECIAL REPORT",!,"FOR A&A AND PENSION",!!!,"This report prints only Veterans receiving A&A or Pension.",!!!
EN2 W "Do you want (A)&A or (P)ension ?  " R REP:DTIME G:'$T!(REP="")!(REP=U) KILL^DVBAUTIL W !
 S X=REP X ^%ZOSF("UPPERCASE") S REP=Y
 I REP'="A"&(REP'="P") W *7,!,"Must be either A for A&A ",!,"or P for Pension or ""^"" or [RETURN] to escape.",!! G EN2
 ;
EN1 K DVBACEPT
 D EN^VALM("DVBA DISCHARGE TYPES")
 I '$D(DVBACEPT) D KILL^DVBAUTIL Q
 I '$O(^TMP("DVBA",$J,"DUP",0)) D KILL^DVBAUTIL Q
 G ^DVBASPD2

DVBASTAT
DVBASTAT ;ALB/GTS-557/THM-AMIE REQUEST STATUS INQUIRY ;21 JUL 89
 ;;2.7;AMIE;;Apr 10, 1995
 ;
TERM D HOME^%ZIS
 ;
SETUP D KILL D DICW^DVBAUTIL
 W @IOF S DIC("A")="Enter PATIENT NAME: ",DIC="^DVB(396,",DIC(0)="AEQM" D ^DIC G:X=""!(X=U) EXIT I Y>0 S DA=+Y
 I Y<0 W *7,"   ??" H 2 G SETUP
PRINT ;
 S BY="@NUMBER",FLDS="[DVBA STATUS]",L=0,FR=DA,TO=DA
 D EN1^DIP
 ;
CONT S ANS="" I IOST?1"C-".E U IO(0) W !,*7,"Enter E to end, ""^"" to EXIT or RETURN to continue   " R ANS:DTIME
 G:ANS="E"!('$T)!(ANS=U) EXIT I ANS="" D KILL G SETUP
 G CONT
 ;
EXIT I IOST?1"C-".E W @IOF
 ;
KILL K ANS,BY,CNUM,DA,DIC,DIC(0),FLDS,FR,L,PNAM,SSN,TO,X,Y,%XX,%YY,DP,FINALDTE,P,ZDAT,DATE,NAME,ZDAT1,ZTYPE,ZX,DIJ,IOY,DVBADIC,FDT(0),DIYS
 Q

DVBAUTIL
DVBAUTIL ;ALB ISC/THM-AMIE UTILITIES ; 1/16/91  2:58 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SORT W !!,"Sort by Regional Office number" S %=1 D YN^DICN I $D(DTOUT)!(%<0) K DTOUT S Y=-1 Q
 I $D(%Y) I %Y["?" W !!,*7,"Enter Y to sort by the Regional Office number you",!,"select or enter N to get ALL Regional Offices reported." G SORT
 I %'=1 S RO="N",RONUM=0 Q
 I %=1 S RO="Y" G RONUM
 W !,*7,"Invalid response.",!! G SORT
 ;
RONUM W !,"Regional Office number: " R RONUM:DTIME G:RONUM["^" SORT I '$T!(RONUM="") W *7 S Y=-1 Q
 I RONUM'?1.3N W *7,"     Must be 1-3 numbers.",!! G RONUM
 Q
 ;
KILL ;kill all variables and exit selected program
 D ^%ZISC
KILL1 K %DT,%ZIS,ANS,BDATE,CNUM,EDATE,L,MA,DA,NODTA,PNAM,Q,QQ,RDATE,SSN,XY,VER,J,LN,POP,FINALDTE,ADMDT,BEDSEC,CFLOC,DIAG,DCHGDT,HEAD,HEAD1,MB,RCVAA,RCVPEN,A,TYPE,C,ADMNUM,DIPGM,DIS,HNAME,DVBAQUIT,DSRP
 K WARD,NOASK,^TMP($J),DTOUT,ZTSK,IO("C"),I,RO,RONUM,LADM,K,RADM,%X,%Y,%XX,%YY,X,Y,ICDAT2,ICDAT,LOS,TDIS,DIC,POP,DVBATYPS,TO,NUMSEL,REP,DVBAFIND,DVBATP,DVBAPRNT,SITE,LINE,OPER,PG,HD,HD1,HEAD2,DVBADD
 K ZTIO,ZTDESC,ZTRTN,DATA,SC,LDCH,FDT(0),NAME,DIE,DR,ZX,ZI,XDA,XADMDT,DLAYGO,HD,D,DIC,Y,Z,ZTYPE,D0,D1,DI,DQ,CNM,CFLC,XDTA,MC,MD,PROCDT,ADMDATE,EDAYS,CNT,XLOC,TEMP,TEMPDA,%ZIS,%IS,DIVHD,XDIV,DVBADIV,ADIV,BDT,EDT
 K ZTYPE,DO,DTAR,X,Y,HEAD,HEAD1,ADTYPE,NDCH,DOCTYPE,ELIG,INCMP,LG,OUT,LADMDT,NONE,BDATE1,XDA2,ADM,DFN,DISCH,XCN,LCN,HOSP,NODE,T,TRN,ZTSAVE,ZDT,ZDT1,ZDA,IO("Q"),IOP,BDIV,EDIV,BDT1,EDT1,NEWREQ,BED,STAT,DVBADIC,ADMNUM
 K X2,DHD,DIWF,DIWL,DIWR,DVBASC,DVBAELIG,FNLDT,CFLC,HIST,DVBAELST,OLDY,PDATE,ZTDTH,DTA,VAINDT,VAIN,WWHO,SDATE,%,DVBAQUIT,NODE,NOFINAL,^TMP("ADMIT",$J),LOC,AA,DVBASTAT,OLDY,ADMDT,ANS1,CURADMDT,DVBADT,DVBAH,DVBAQ
 K DVBAI,DVBAT,HEADDT,HOSPDAYS,LBEDSEC,LDCHGDT,LDIAG,LLADM,LTDIS,MSG,MSG1,VX,VY,X1,XLINE,ZJ,ZY,ZZ,LOC,QUIT,QUIT1,^UTILITY($J),^TMP("DVBA",$J),^TMP("DVBA","PEN"),^TMP("DVBA","A&A"),DVBACEPT,DCHPTR,DVBA
 Q
 ;
LOS ;compute length of stay for discharge report
 S %DT="T" S X=ADMDT D ^%DT S X2=Y
 S X=DCHGDT D ^%DT S X1=Y K Y
 D ^%DTC S LOS=X I LOS=0 S LOS=""
 Q
DATE S %DT(0)=-DT
 S %DT("A")="BEGINNING date: ",%DT="AET" D ^%DT W:X="^"!(Y=-1) !! Q:X=""!(Y=-1)  S BDATE=Y
 S %DT("A")="   ENDING date: ",%DT="AET" D ^%DT S EDATE=Y Q:X="^"
 I EDATE<BDATE W !!,*7,"Invalid date sequence.  Beginning date must be before the ending date.",!! H 2 G DATE
 S BDATE=BDATE-.5,EDATE=EDATE+.5
 D SORT K %DT(0) Q
 ;
DICW S DVBADIC(0,"W")="S ZX=$P(^DVB(396,+Y,0),U,4) W:$X>40 ! W ""  Admission date: "",$E(ZX,4,5)_""-""_$E(ZX,6,7)_""-""_$E(ZX,2,3) W ""  "",$S($P(^(1),U,12)'="""":""Finalized"",1:""Open"")"
 ;
DICW1 S DVBADIC(1,"W")="S ZX=$P(^DVB(396,+Y,0),U,4) W:$X>40 ! W ""  Activity date: "",$E(ZX,4,5)_""-""_$E(ZX,6,7)_""-""_$E(ZX,2,3) W ""  "",$S($P(^(1),U,12)'="""":""Finalized"",1:""Open"")"
 ;
DICW2 S DIC("W")="S ZTYPE=$S($D(^DVB(396,+Y,2)):$P(^(2),U,10),1:""A"") X $S(ZTYPE=""L"":DVBADIC(1,""W""),1:DVBADIC(0,""W""))"
 Q
 ;
FINAL ;
 S $P(^DVB(396.1,1,0),"^",X)=DT ;x is the corresponding date field
 G KILL1
 ;
DUZ2 K DVBAQUIT
 I '$D(DUZ(2)) W *7,!!,"You have no division code.  Please contact the site manager.",!! H 3 S DVBAQUIT=1 Q
 S DVBAD2=$S($D(^DIC(4,+DUZ(2),99)):$P(^(99),U,1),1:0)
 I DVBAD2=0 W *7,!!,"Your division code is invalid.",!! H 3 S DVBAQUIT=1
 Q
S ;
 ;this code is currently not available but will be in future version
 ;of AMIE.
 Q
S1 ;
 ;this code is currently not available but will be in future version
 ;of AMIE.
 Q
K ;
 ;this code is currently not available but will be in future version
 ;of AMIE.
 Q
K1 ;
 ;this code is currently not available but will be in future version
 ;of AMIE.
 Q
 ;
EXIT ;called from the DVBAREG1 routine, kills off variables at end.
 S VAR(1,0)="0,0,0,0:2,1^"
 D WR^DVBAUTL4("VAR")
 K VAR,ADM,ADMDT,ANS,CNUM,DA,DFN,DIC,DIE,DR,PNAM,SSN,ZA,OPER,X,Y,POP,LOC,%,ZI,ONFILE,REOPEN,DVBADIV,STAT,ZX,HD,I,NAME,HNAME,DTAR,DTOUT,%Y,DOCTYPE,%Y1,DQ,DVBADIC,OUT,ZTYPE,A,ADMNUM,ANS1,OLDY,DVBASTAT,DVBAENTR,DVBAEDT
 K DVBAD2,DVBAX,DVBCSSNO,AROWOUT,DVBADM,DVBANL,DVBAPT,DVBAQUIT,DVBBDT,DVBCHK,DVBDISP,DVBEDT,DVBSPCOD,DVBVAR,DVBCNT,DVBAY,DVBDOC,DVBAIFN,DVBANS
 K ^TMP("DVBA",$J),^UTILITY("DIQ1",$J)
 Q
 ;

DVBAUTL1
DVBAUTL1 ;ALB/JLU;UTILITY ROUTINE;11/8/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
STATION(DFN) ;
 ;this function call returns the station number of the patient in the
 ;parameter or -1 if no station number.
 ;
 N X
 I '$D(^DPT(DFN,.31)) Q -1
 S X=$P(^DPT(DFN,.31),U,4)
 I X="" Q -1
 I '$D(^DIC(4,X,99)) Q -1
 S X=$P(^DIC(4,X,99),U,1)
 I X<1 Q -1
 Q X
 ;
EXIT ;this entry point is called from the DVBAPOST routine.  It is used as
 ;the kill statment at the end of the post init.
 ;
 I $D(V3) K CNT,LP1,V3,XMZ,XMY(DUZ),XMY(.5),XMSUB,XMDUZ
 K STOP
 Q
 ;
SET1 ;sets the parameter file node to be used in the post init Keyword
 ;population.
 I '$D(CNT) S CNT=1
 I $D(^DVB(396.1,0)) DO
 .N DVBA
 .S DVBA=$$IFNPAR^DVBAUTL3()
 .I DVBA=0 DO
 ..S DIC="^DVB(396.1,",DIC(0)="L"
 ..K DD,D0
 ..S X=$P(^DG(40.8,$$PRIM^VASITE,0),U,1)
 ..D FILE^DICN
 ..S DVBA=$S(Y=-1:0,1:+Y)
 ..K DIC,DD,D0,Y,X
 ..Q
 .S ^DVB(396.1,DVBA,"POST")="DVBA;ADVB;DVBB;ADVB"
 .S:$P(^DVB(396.1,DVBA,0),U,15)']"" $P(^(0),U,15)=1
 .S:$P(^DVB(396.1,DVBA,0),U,18)']"" $P(^(0),U,18)=1
 .S:$P(^DVB(396.1,DVBA,0),U,19)']"" $P(^(0),U,19)=1
 Q

DVBAUTL2
DVBAUTL2 ;ALB/GTS-557/THM-AMIE UTILITIES ;24 AUG 89
 ;;2.7;AMIE;;Apr 10, 1995
 ;
REOPEN ;used by DVBAREG1 and DVBAREN1 only to re-log 7131s
 W *7,!!,"Are you sure you want to DELETE the existing 7131 for this date",!,"and log a NEW one" S %=2 D YN^DICN ;must be finalized to reopen
 I $D(%Y),%Y["?" W !!,"Enter Y to delete the finalized 7131 request that",!,"exists for this date and log a new one.",!!,"Enter N to leave the existing 7131 as is.",! G REOPEN
 I %'=1 S ONFILE=1 K OLDDA,%,%Y Q
 I '$D(DVBREQDT) W *7,!!,"Activity or admission date is missing !  Cannot reopen.",!! H 3 S ONFILE=1 Q
 K DIC("S"),DVBAEDT
 S OLDY=Y,OLDDA=DA,DIK="^DVB(396," D WAIT^DICD,^DIK S (DA,DINUM)=OLDDA,X=+DFN K DD,DO S DLAYGO=396,DIC(0)="EQLM",DIC="^DVB(396," D FILE^DICN ;use same IFN
 S DR="1////"_CNUM_";2////"_SSN_";3////"_DVBREQDT_";23////"_DT_";24////"_DT_";27////"_LOC_";28////"_OPER_";30////"_DVBDOC,DIE=DIC D ^DIE K DLAYGO
 W !!,*7,"You may now enter a new 7131 for this date.",!! H 2
 S Y=OLDY
 K OLDDA,%,%Y
 Q
 ;
NOPARM ;check for AMIE parameter setup
 I '$D(^DVB(396.1,1,0)) W !!,*7,"No site parameters have been setup in file 396.1.",!,"You must do this before running any reports.",!! S DVBAQUIT=1 H 3
 Q
 ;
ADTYPE W !!,"Do you want (A)&A, (P)ension, (S)ervice-connected, or AL(L) discharges ?  S// " R ADTYPE:DTIME I '$T!(ADTYPE=U) S DVBAQUIT=1 Q
 S X=ADTYPE X ^%ZOSF("UPPERCASE") S ADTYPE=Y
 S:ADTYPE="" ADTYPE="S" I ADTYPE'?1"A"&(ADTYPE'?1"S")&(ADTYPE'?1"L")&(ADTYPE'?1"P") W *7,!!,"Must be A for A&A, P for Pension, S for Service-connected, or L for All" G ADTYPE
 S HEAD=$S(ADTYPE="P":"PENSION",ADTYPE="A":"A&A",ADTYPE="S":"SERVICE-CONNECTED",ADTYPE="L":"COMPLETE",1:"UNKNOWN")_" DISCHARGE REPORT"
 Q
 ;
DELETE K OUT W !!,*7,"Are you sure you want to delete this request" S %=2 D YN^DICN I $D(DTOUT)!(%<0) Q  ;continue on timeout to set record
 I $D(%),%=1 S DIK="^DVB(396," D ^DIK S OUT=1 W "    ... deleted!",*7,!! H 2
 Q
 ;
CHKDIV ;** Check for selected Division on 7131
 K DVXST
 N ADIV
 S ADIV=$S($D(^DVB(396,D0,2)):$P(^(2),U,9),1:"""")
 S:XDIV=ADIV DVXST=""
 I '$D(DVXST) DO
 .N ADT
 .S ADT=""
 .F ADT=0:0 S ADT=$O(^DVB(396,"AF",D0,ADT)) Q:ADT=""!($D(DVXST))  DO
 ..S:($D(^DVB(396,"AF",D0,ADT,XDIV))) DVXST=""
 Q
 ;
WRDIV ;** Write Division for 7131 - Loop DA in 'AF' X-ref
 S TMP($J,"DVBA",$P(^(2),"^",9))=""
 F DVBADT=0:0 S DVBADT=$O(^DVB(396,"AF",DA,DVBADT)) Q:DVBADT=""  D LPDIV
 W !
 KILL TMP($J,"DVBA"),DVBADT,DVBADIV,DVBANAM
 Q
 ;
LPDIV ;** Loop Division in 'AF' X-ref
 S DVBADIV=0
 F  S DVBADIV=$O(^DVB(396,"AF",DA,DVBADT,DVBADIV)) Q:DVBADIV=""  DO
 .I '$D(TMP($J,"DVBA",DVBADIV)) DO
 ..S DVBANAM=$P(^DG(40.8,DVBADIV,0),"^",1)
 ..S TMP($J,"DVBA",DVBADIV)=""
 ..W !,?68,$E(DVBANAM,1,9)
 Q
 ;
DIVUPDT ;** Update 7131 Rpt Divisions & Tran Dates on new 7131
 K DR,DIE,DA
 S REQDTE=$P(^DVB(396,DVBAENTR,1),U,1),REQDIV=$P(^DVB(396,DVBAENTR,2),U,9)
 S:'$D(^DVB(396,DVBAENTR,6)) DVBANEW=""
 S:'$D(DVBANEW) NODE6=^DVB(396,DVBAENTR,6)
 F LPPCE=1:1:10 DO
 .S:LPPCE=1 FLDDIV=4.6,FLDDTE=4.7
 .S:LPPCE=2 FLDDIV=5.6,FLDDTE=5.7
 .S:LPPCE=3 FLDDIV=6.6,FLDDTE=6.7
 .S:LPPCE=4 FLDDIV=7.6,FLDDTE=7.7
 .S:LPPCE=5 FLDDIV=9.6,FLDDTE=9.7
 .S:LPPCE=6 FLDDIV=11.6,FLDDTE=11.7
 .S:LPPCE=7 FLDDIV=13.6,FLDDTE=13.7
 .S:LPPCE=8 FLDDIV=15.6,FLDDTE=15.7
 .S:LPPCE=9 FLDDIV=17.6,FLDDTE=17.7
 .S:LPPCE=10 FLDDIV=20.6,FLDDTE=20.7
 .I $P(DVBARPT(LPPCE),U,3)="P" D NEWCHK^DVBAUTL8 ;**Check for new report
 .I $P(DVBARPT(LPPCE),U,3)="" D CLRCHK^DVBAUTL8 ;**Check to clear fields 
 I $P(^DVB(396,DVBAENTR,0),U,26)="P" DO  ;**Check OPT TRT Rpt
 .S FLDDIV=18.6,FLDDTE=18.7
 .I $D(DVBANEW) D SETDR^DVBAUTL7 ;**OPT TRT Rpt included on new 7131
 .I '$D(DVBANEW),($P(NODE6,U,26)="") D SETDR^DVBAUTL7 ;**OPT Rpt Added
 I $P(^DVB(396,DVBAENTR,0),U,26)="" DO  ;**Check OPT TRT Rpt
 .I '$D(DVBANEW),($P(NODE6,U,26)'="") DO  ;**OPT Rpt deselected via edit
 ..S FLDDIV=18.6,FLDDTE=18.7
 ..D CLEARDR^DVBAUTL7
 I $D(DR) S DA=DVBAENTR,DIE="^DVB(396," D ^DIE
 K FLDDTE,FLDDIV,LPPCE,REQDTE,REQDIV,DA,DR,DIE,Y,DVBANEW,NODE6
 Q

DVBAUTL3
DVBAUTL3 ;ALB/JLU-A general utility routine ;1/28/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
DEL(DA) ;this subroutine will delete an entry from file 396
 N Z
 S DIK="^DVB(396,"
 D ^DIK
 I IOST?1"C-".E W *7,!,?10,"7131 entry deleted.",?39,"<Return to continue>"
 R Z:DTIME
 K DIK
 Q
 ;
FILE ;this subroutine files the results into 396 for DVBARQP
 N A
 S A=^DVB(396,DVBAENTR,0)
 S $P(A,U,5)=$P(DVBARPT(1),U,2)
 S $P(A,U,9)=$P(DVBARPT(1),U,3)
 S $P(A,U,6)=$P(DVBARPT(2),U,2)
 S $P(A,U,11)=$P(DVBARPT(2),U,3)
 S $P(A,U,7)=$P(DVBARPT(3),U,2)
 S $P(A,U,13)=$P(DVBARPT(3),U,3)
 S $P(A,U,8)=$P(DVBARPT(4),U,2)
 S $P(A,U,15)=$P(DVBARPT(4),U,3)
 S $P(A,U,16)=$P(DVBARPT(5),U,2)
 S $P(A,U,17)=$P(DVBARPT(5),U,3)
 S $P(A,U,18)=$P(DVBARPT(6),U,2)
 S $P(A,U,19)=$P(DVBARPT(6),U,3)
 S $P(A,U,20)=$P(DVBARPT(7),U,2)
 S $P(A,U,21)=$P(DVBARPT(7),U,3)
 S $P(A,U,22)=$P(DVBARPT(8),U,2)
 S $P(A,U,23)=$P(DVBARPT(8),U,3)
 S $P(A,U,24)=$P(DVBARPT(9),U,2)
 S $P(A,U,27)=$P(DVBARPT(10),U,2)
 S $P(A,U,28)=$P(DVBARPT(10),U,3)
 S ^DVB(396,DVBAENTR,0)=A
 S $P(^DVB(396,DVBAENTR,1),U,7)=$P(DVBARPT(9),U,3)
 D DIVUPDT^DVBAUTL2
 Q
 ;
INITRPT ;This subroutine will setup the report array.
 S DVBAO=^DVB(396,DVBAENTR,0)
 S DVBARPT(1)="Notice of discharge"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,5),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,9),1:"")
 S DVBARPT(2)="Hospital Summary"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,6),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,11),1:"")
 S DVBARPT(3)="Certificate (21-day)"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,7),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,13),1:"")
 S DVBARPT(4)="Other/Exam (Review Remarks)"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,8),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,15),1:"")
 S DVBARPT(5)="Special Report"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,16),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,17),1:"")
 S DVBARPT(6)="Competency Report"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,18),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,19),1:"")
 S DVBARPT(7)="VA Form 21-2680"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,20),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,21),1:"")
 S DVBARPT(8)="Asset Information"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,22),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,23),1:"")
 S DVBAP=^DVB(396,DVBAENTR,1)
 S DVBARPT(9)="Admission Report"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,24),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAP,U,7),1:"")
 S DVBARPT(10)="Beginning Date Care"_"^"_$S($D(DVBAEDT):$P(DVBAO,U,27),1:"NO")_"^"_$S($D(DVBAEDT):$P(DVBAO,U,28),1:"")
 Q
 ;
IFNPAR() ;
 ;This function call returns the internal entry number of the entry in
 ;the parameter file 396.1.  There are no inputs.  The outputs are either
 ;the IFN or zero.
 ;
 N X
 S X=$O(^DVB(396.1,0))
 I 'X Q 0
 Q X

DVBAUTL4
DVBAUTL4 ;ALB/JLU;UTILITY ROUTINE;9/9/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
WR(TEXT) ;
 ;this is the main entry point for the AMIE writer
 ;the following is a desciption of how to set up the text string to use
 ;this call.
 ;The first uparrow piece contians the description of what to execute
 ;on this line.  The second peice contians the actual line of text.
 ;The descriptions are defined below
 ;1st = contains a 1 or zero 1 for beep zero no beep
 ;2nd = contains the number of spaces before and/or after the text 1:1
 ;3rd = contains the number of tabs before and/or after the text 1:2
 ;4th = contains the number of lines before and/or after the text 1:4
 ;5th = contains the number of form feeds before and/or after the 
 ;      text 1:3
 ;TEXT  = contains the array that holds the text to be displayed
 ;        the array is to look like ARRAY(X,0)  local or global
 ;        The X must start at one and be in consecutive order.
 ;The data in each array element will look like. "0,1:1,1:2,1:4,1:3^text"
 ;
 F LP=1:1 S TEXTM=$G(@TEXT@(LP,0)) Q:TEXTM=""  DO
 .D SETTEXT
 .D SETVAR
 .I TEXT2="",SPACE="",TAB="",LINE="",FORM="",BEEP="" Q
 .I $D(IO),IO]"" U IO
 .I TEXT2="" D SHORT
 .I TEXT2]"" D BODY
 .Q
 D EXIT
 Q
 ;
EXIT K TEXTM,TEXT1,TEXT2,SPACE,TAB,BEEP,LINE,FORM,LP
 Q
 ;
SHORT ;no text available may want to just use curser control
 I FORM]"" D FORM(FORM,"B")
 I LINE]"" D LINE(LINE,"B")
 I TAB]"" D TAB(TAB,"B")
 I SPACE]"" D SPACE(SPACE,"B")
 I BEEP]"",BEEP>0 D BEEP
 Q
 ;
BODY ;text is available will look at all
 I BEEP]"",BEEP>0 D BEEP
 I FORM]"" D FORM(FORM,"B")
 I LINE]"" D LINE(LINE,"B")
 I TAB]"" D TAB(TAB,"B")
 I SPACE]"" D SPACE(SPACE,"B")
 D TEXT(TEXT2)
 I SPACE]"" D SPACE(SPACE,"A")
 I TAB]"" D TAB(TAB,"A")
 I LINE]"" D LINE(LINE,"A")
 I FORM]"" D FORM(FORM,"A")
 Q
 ;
FORM(A,B) ;issues the form feeds
 ;
 N VAR,LP
 S VAR=$$SET(A,B)
 Q:VAR=""
 F LP=1:1:VAR W @$S('$D(IOF):"#",IOF="":"#",1:IOF)
 Q
 ;
LINE(A,B) ;issues the line feeds
 ;
 N VAR,LP
 S VAR=$$SET(A,B)
 Q:VAR=""
 F LP=1:1:VAR W !
 Q
 ;
TAB(A,B) ;issues the tabs
 ;
 N VAR,LP
 S VAR=$$SET(A,B)
 Q:VAR=""!(VAR=0)
 S DX=0,DY=$S(IOST["C-":$S($Y>IOSL:IOSL,1:$Y),1:0)
 X ^%ZOSF("XY")
 K DX,DY
 W ?VAR
 Q
 ;
SPACE(A,B) ;issues the spaces
 ;
 N VAR,LP
 S VAR=$$SET(A,B)
 Q:VAR=""
 F LP=1:1:VAR W " "
 Q
 ;
TEXT(A) ;writes the text
 ;
 W A
 Q
 ;
SET(A,B) ;general set statement
 ;
 Q $S(B="B":+A,1:$P(A,":",2))
 ;
BEEP ;does a beep
 W *7
 Q
 ;
SETTEXT ;sets up the two parts of each string
 S TEXT1=$P(TEXTM,"^",1)
 S TEXT2=$F(TEXTM,"^")
 S TEXT2=$E(TEXTM,TEXT2,999)
 Q
 ;
SETVAR ;sets up the necessary variables for each attribute
 S BEEP=$P(TEXT1,",",1)
 S SPACE=$P(TEXT1,",",2)
 S TAB=$P(TEXT1,",",3)
 S LINE=$P(TEXT1,",",4)
 S FORM=$P(TEXT1,",",5)
 Q
 ;
CLEAR ;clears the screen
 S VAR(1,0)="0,0,0,3,1^"
 D WR^DVBAUTL4("VAR")
 K VAR
 Q

DVBAUTL5
DVBAUTL5 ;ALB/JLU;UTILITY ROUTINE;9/13/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SELECT(PAR1,PAR2) ;
 ;This function call will ask the user whether they want to select
 ;by date range or name/ssn.  It will return a "D" for date range,
 ;"N" for name/ssn or a zero otherwise.  It will accept two inputs
 ;PAR1 is the title oposite the name /ssn example Date Range
 ;PAR2 is the option using this call exampl 21 day certificate
 ;
 S DIR(0)="SOM^N:Patient Name/SSN;D:"_PAR1
 S DIR("B")="N",DIR("A")="Select "_PAR2_" by"
 D ^DIR
 I $D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT)) D SK Q 0
 D SK
 Q Y
 ;
SK ;
 K DIR,DTOUT,DUOUT,DIRUT,DIROUT
 Q
 ;
PAT(WHO) ;this entry point allows a patient lookup.
 ;the parameter WHO represents either MAS, RO OR NOONE
 ;
 S DIC="^DVB(396,",DIC(0)="AEMQZ"
 I $D(WHO) DO
 .I WHO="RO" S DIC("S")="I $D(^(4)),$P(^(4),U,4)]"""",$D(^(2)),$P(^(2),U,10)'=""L"",$D(^DPT($P(^(0),U,1),0))"
 .I WHO="MAS" S DIC("S")="I $P(^(0),U,14)]"""",$D(^(4)),$D(^(2)),$P(^(2),U,10)'=""L"",$D(^DPT($P(^(0),U,1),0))"
 .I WHO="MAS"!(WHO="RO") S DIC("W")="W ?32,""Original processing date "" N Y S Y=$S(WHO=""RO"":$P(^(4),U,4),1:$P(^(0),U,14)) D DD^%DT W Y"
 .I WHO=7131 S DIC("W")="I $D(^(1)) N Y S Y=$P(^(1),U) D DD^%DT W ""   on "",Y S Y=$G(^(2)) I Y]"""" W ""   "",$S($P(Y,U,10)=""A"":""Adm."",1:""Act.""),""  Req. by "",$P(Y,U,8)"
 .Q
 D ^DIC
 K DIC
 Q $P(Y,U,1)

DVBAUTL6
DVBAUTL6 ;ALB/JLU;UTILITY ROUTINE;9/15/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
DSCIFN(A) ;returns the IFN of the discarge type in A. from file 405.2
 ;
 N DIC,X
 S DIC="^DG(405.2,",DIC(0)="XMZ"
 S X=A
 D ^DIC
 Q +Y
 ;
DSCTIEN(A) ;returns the IEN of the discharge type in file 405.3
 N DIC,X
 S DIC="^DG(405.3,",DIC(0)="XMZ"
 S X=A
 D ^DIC
 Q +Y
 ;
CHECK(A) ;used in the lookup screen of the discharge report to check for
 ;active facility movement types for the particular MAS movement types.
 ;A is the MAS movement type
 ;
 N DVBA,DVBFOUND
 S DVBA=""
 F  S DVBA=$O(^DG(405.1,"AM",A,DVBA)) Q:'DVBA!($D(DVBFOUND))  DO
 .I '$D(^DG(405.1,DVBA,0)) Q
 .I $P(^DG(405.1,DVBA,0),U,4)=1 S DVBFOUND=1
 .Q
 I $D(DVBFOUND) Q 1
 E  Q 0
 ;
LOCK(Y) ;locks the record.
 ;called by dvbaren1, dvbarl21, dvbareg1
 L +^DVB(396,+Y):2
 I '$T DO  Q 0
 .S VAR(1,0)="1,0,0,2,0^Record is currently in use!"
 .D WR^DVBAUTL4("VAR")
 .K VAR
 .D PAUSE^DVBCUTL4
 Q 1
 ;
UNLOCK(Y) ;unlocks the global
 ;called by dvbaren1, dvbarl21, dvbareg1
 L -^DVB(396,+Y)
 Q
 ;
ERR(A) ;displays an error message to the user called from DVBAREG1
 N VAR
 S VAR(1,0)="1,0,0,2:2,0^There is no Admission or Non Admission information"_$S(A>0:" for this date range!",1:".")
 D WR^DVBAUTL4("VAR")
 K VAR
 D CONTMES^DVBCUTL4
 Q
 ;

DVBAUTL7
DVBAUTL7 ;ALB/GTS;UTILITY ROUTINE;12/6/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 16)
 ;
SEL7131() ;** Select a 7131 request
 K Y
 F  DO  Q:$D(Y)
 .S DIC="^DVB(396,",DIC(0)="AEMQ"
 .S DIC("W")="D REQDT^DVBAUTL7"
 .D ^DIC
 .D:+Y>0 CHECK
 K DIC,X
 Q +Y
 ;
CHECK ;** Check 7131 for a pending report
 K DVBAOPEN
 N DVBAX
 F DVBAX=9,11,13,15,17,19,21,23,7,28,26 DO
 .I '$D(DVBAOPEN) DO
 ..I DVBAX'=7 DO
 ...S:$P(^DVB(396,+Y,0),U,DVBAX)="P" DVBAOPEN=""
 ..I DVBAX=7 DO
 ...S:$P(^DVB(396,+Y,1),U,DVBAX)="P" DVBAOPEN=""
 I '$D(DVBAOPEN) K Y
 I '$D(DVBAOPEN) DO
 .S VAR(1,0)="1,0,0,2:2,0^You must select a 7131 with Pending reports!"
 .D WR^DVBAUTL4("VAR")
 .K VAR,PAR1,PAR2
 K DVBAOPEN
 Q
 ;
INITRPT(DVBAIEN) ;** Set nodes for division updates on 7131
 ;** Variable Descriptions
 ;      DVBARPT(RPT #)=Report name^Selected - Y/N^Status - P/C^Division #
 ;      DVBA0 and DVBA6 are the 7131 rec's 0 and 6 node respectively
 ;
 ;** Note: DVBARPT local array returned to calling rtn
 ;
 N DVBA0,DVBA6,DVBAX,SUBSCPT,RPTNME,RPTSTAT,RPTSEL,SELPCE,DVBADIV,DIVNUM
 S DVBA0=^DVB(396,DVBAIEN,0)
 S:$D(^DVB(396,DVBAIEN,6)) DVBA6=^DVB(396,DVBAIEN,6)
 S:'$D(^DVB(396,DVBAIEN,6)) DVBA6=""
 S SUBSCPT=0
 F DVBAX=9,11,13,15,17,19,21,23,7,28,26 DO  ;**Subscpt's = Status Pce's
 .S SUBSCPT=SUBSCPT+1
 .S RPTNME=$T(@DVBAX)
 .S RPTNME=$P(RPTNME,";;",2)
 .I DVBAX'=7 DO  ;**Set up Rpt Selection Pce #'s
 ..I DVBAX<17 DO
 ...S:DVBAX=9 SELPCE=5
 ...S:DVBAX=11 SELPCE=6
 ...S:DVBAX=13 SELPCE=7
 ...S:DVBAX=15 SELPCE=8
 ..S:(DVBAX>15&(DVBAX'=26)) SELPCE=DVBAX-1
 ..S RPTSTAT=$P(^DVB(396,DVBAIEN,0),U,DVBAX)
 .S:DVBAX=7 RPTSTAT=$P(^DVB(396,DVBAIEN,1),U,DVBAX),SELPCE=24
 .S:DVBAX'=26 RPTSEL=$P(^DVB(396,DVBAIEN,0),U,SELPCE)
 .I DVBAX=26 DO
 ..S SELPCE=25
 ..S:$P(^DVB(396,DVBAIEN,0),U,SELPCE)'="" RPTSEL="YES"
 ..S:$P(^DVB(396,DVBAIEN,0),U,SELPCE)="" RPTSEL="NO"
 .S DIVNUM=$P(DVBA6,U,DVBAX)
 .S:+DIVNUM>0 DVBADIV=$P(^DG(40.8,DIVNUM,0),U,1)
 .S:+DIVNUM'>0 DVBADIV=""
 .S DVBARPT(SUBSCPT)=RPTNME_"^"_RPTSEL_"^"_RPTSTAT_"^"_DVBADIV_"^"_DIVNUM_"^"_DIVNUM
 Q
 ;
SETDR ;** Set DR string for 7131 division/tran date field updates
 S:$D(DR) DR=DR_";"_FLDDIV_"///"_REQDIV_";"_FLDDTE_"///"_REQDTE
 S:'$D(DR) DR=FLDDIV_"///"_REQDIV_";"_FLDDTE_"///"_REQDTE
 Q
 ;
CLEARDR ;** Set DR string to clear 7131 division/tran date fields (7131 edit)
 S:$D(DR) DR=DR_";"_FLDDIV_"///@;"_FLDDTE_"///@"
 S:'$D(DR) DR=FLDDIV_"///@;"_FLDDTE_"///@"
 Q
 ;
REQDT ;** Output 7131 date for DIC("W")
 N DVBADTE,DVBATIME,DVBADTWK,DVBAX
 S DVBADTWK=$P(^DVB(396,+Y,0),U,4)
 S DVBATIME=$P(DVBADTWK,".",2)
 S DVBADTWK=$P(DVBADTWK,".",1)
 S DVBADTE=$E(DVBADTWK,4,5)_"-"_$E(DVBADTWK,6,7)_"-"_$E(DVBADTWK,2,3)
 I +DVBATIME>0 DO
 .F DVBAX=$L(DVBATIME):1:3 S DVBATIME=DVBATIME_"0"
 .S DVBATIME=$E(DVBATIME,1,2)_":"_$E(DVBATIME,3,4)
 .S DVBADTE=DVBADTE_" @ "_DVBATIME
 W ?35,$S($P(^(2),U,10)="L":"Activity Date:  ",$P(^(2),U,10)="A":"Admission Date: ",1:""),DVBADTE
 Q
 ;
FILE ;** Update 7131 record - Called from DVBADXFR
 N DVBAX,DVBADTWK
 S DVBADTWK=DVBATDT
 S DVBADTWK=$P(DVBATDT,"@",2)
 S REQDTE=$P(DVBATDT,"@",1)_"@"_$P(DVBADTWK,":",1)_":"_$P(DVBADTWK,":",2)
 F DVBAX=1:1:11  DO
 .I $P(DVBARPT(DVBAX),U,5)'=$P(DVBARPT(DVBAX),U,6) DO
 ..I DVBAX=1 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=4.6,FLDDTE=4.7
 ...D SETDR
 ..I DVBAX=2 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=5.6,FLDDTE=5.7
 ...D SETDR
 ..I DVBAX=3 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=6.6,FLDDTE=6.7
 ...D SETDR
 ..I DVBAX=4 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=7.6,FLDDTE=7.7
 ...D SETDR
 ..I DVBAX=5 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=9.6,FLDDTE=9.7
 ...D SETDR
 ..I DVBAX=6 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=11.6,FLDDTE=11.7
 ...D SETDR
 ..I DVBAX=7 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=13.6,FLDDTE=13.7
 ...D SETDR
 ..I DVBAX=8 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=15.6,FLDDTE=15.7
 ...D SETDR
 ..I DVBAX=9 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=17.6,FLDDTE=17.7
 ...D SETDR
 ..I DVBAX=10 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=20.6,FLDDTE=20.7
 ...D SETDR
 ..I DVBAX=11 DO
 ...S REQDIV=$P(DVBARPT(DVBAX),U,5)
 ...S FLDDIV=18.6,FLDDTE=18.7
 ...D SETDR
 I $D(DR) DO
 .S DIE="^DVB(396,"
 .S DA=REQDA
 .D ^DIE
 .K DIE,DA,DR
 Q
 ;
RPTNMS ;
9 ;;Notice of Discharge
11 ;;Hospital Summary
13 ;;Certificate (21-day)
15 ;;Other/Exam (Review Remarks)
17 ;;Special Report
19 ;;Competency Report
21 ;;VA Form 21-2680
23 ;;Asset Information
7 ;;Admission Report
28 ;;Beginning Date Care
26 ;;OPT Treatment Report (Date Range)
 Q

DVBAUTL8
DVBAUTL8 ;ALB/GTS-AMIE 7131 UTILITIES ;8 DEC 94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
NEWCHK ;** Check for the addition of a report to 7131
 ;**  This tag is called from DIVUPDT^DVBAUTL2.  It checks for a new
 ;**   report division and sets up the DR string if the reports Division
 ;**   and Transfer Date fields need to be updated.  NEWCHK is called if
 ;**   the report array status piece has a status of 'P' (Pending)
 ;
 I $D(DVBANEW) D SETDR^DVBAUTL7 ;**New 7131 - update Div/Tran Dte flds
 I '$D(DVBANEW) DO  ;**Edit 7131 - If report added, update Div/Tran Dte
 .I LPPCE=1,($P(NODE6,U,9)="") D SETDR^DVBAUTL7
 .I LPPCE=2,($P(NODE6,U,11)="") D SETDR^DVBAUTL7
 .I LPPCE=3,($P(NODE6,U,13)="") D SETDR^DVBAUTL7
 .I LPPCE=4,($P(NODE6,U,15)="") D SETDR^DVBAUTL7
 .I LPPCE=5,($P(NODE6,U,17)="") D SETDR^DVBAUTL7
 .I LPPCE=6,($P(NODE6,U,19)="") D SETDR^DVBAUTL7
 .I LPPCE=7,($P(NODE6,U,21)="") D SETDR^DVBAUTL7
 .I LPPCE=8,($P(NODE6,U,23)="") D SETDR^DVBAUTL7
 .I LPPCE=9,($P(NODE6,U,7)="") D SETDR^DVBAUTL7
 .I LPPCE=10,($P(NODE6,U,28)="") D SETDR^DVBAUTL7
 Q
 ;
CLRCHK ;** Edit 7131 - Check for deselection of report
 ;**  This tag is called from DIVUPDT^DVBAUTL2.  It checks for the
 ;**   deselection of a report on a previously entered 7131.  If a
 ;**   report has been deselected, the Division and Tran Date fields
 ;**   are cleared.
 ;
 I '$D(DVBANEW) DO
 .I LPPCE=1,($P(NODE6,U,9)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=2,($P(NODE6,U,11)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=3,($P(NODE6,U,13)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=4,($P(NODE6,U,15)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=5,($P(NODE6,U,17)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=6,($P(NODE6,U,19)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=7,($P(NODE6,U,21)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=8,($P(NODE6,U,23)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=9,($P(NODE6,U,7)'="") D CLEARDR^DVBAUTL7
 .I LPPCE=10,($P(NODE6,U,28)'="") D CLEARDR^DVBAUTL7
 Q

DVBAUTLH
DVBAUTLH ;ALB/JLU;executable help statements;10/28/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;this routine contains the executable help statements for the AMIE
 ;fields when needed.
PURGE ;
 N DVBAH
 S DVBAH(1,0)="0,0,0,1,0^This parameter can be adjusted to allow the site to keep 2507 requests"
 S DVBAH(2,0)="0,0,0,1,0^for up to 999 days.  The site can not select to retain the requests"
 S DVBAH(3,0)="0,0,0,1,0^for less than 120 days.  Selection of a number of days between"
 S DVBAH(4,0)="0,0,0,1:2,0^120 and 999 is the allowable response."
 D WR^DVBAUTL4("DVBAH")
 Q

DVBAVDPT
DVBAVDPT ;ALB/JLU,557/THM-GET VARIABLES VIA ^VADPT ; 1/23/91  8:02 AM
 ;;2.7;AMIE;;Apr 10, 1995
 W *7,!!,"NOT a stand-alone program !",!!,*7 Q
 ;
DCHGDT ;entry point for all reports that use discharge dates
 ;called by D DCHGDT^DVBAVDPT
 S DCHGDT=MA,VAINDT=$S(MA[".":MA-.000002,1:MA),VA200="" D INP^VADPT K VA200 S ADMDT=$P(VAIN(7),".") G EN
 ;
ADM ;entry point for all reports that use admission dates
 ;called by D ADM^DVBAVDPT only
 I $D(MA),MA]"" S (ADMDT,VAINDT)=MA S VA200="" D INP^VADPT K VA200 S ADMNUM=VAIN(1),DCHGDT="",DCHPTR=$S($D(^DGPM(+ADMNUM,0)):$P(^(0),U,17),1:"") G:DCHPTR="" EN I DCHPTR]"",$D(^DGPM(DCHPTR,0)) S DCHGDT=$P(^(0),U,1) G EN
 S VAINDT=$S($D(ADMDT):ADMDT,1:""),VA200="" D INP^VADPT K VA200 S ADMNUM=VAIN(1),DCHGDT="",DCHPTR=$S($D(^DGPM(+ADMNUM,0)):$P(^(0),U,17),1:"") I DCHPTR]"",$D(^DGPM(DCHPTR,0)) S DCHGDT=$P(^(0),U,1)
 Q:$D(DVBARADQ)
 ;
EN ;general entry point
 S (DVBAELIG,DVBAELST)="" I $D(^DPT(DFN,.36)),$P(^(.36),U)]"" S DVBAELIG=$S($D(^DIC(8,+^(.36),0)):$P(^(0),U,6),1:"")
 I DVBAELIG]"",$D(^DPT(DFN,.361)),^(.361)]"" S DVBAELST=$P(^(.361),U)
 S PNAM=$P(^DPT(DFN,0),U),SSN=$P(^(0),U,9),WARD=$P(VAIN(4),U),DIAG=VAIN(9),ADMNUM=VAIN(1)
 S WARD=$S($D(^DIC(42,+WARD,0)):^(0),1:""),BEDSEC=$S($P(WARD,U,2)]"":$P(WARD,U,2),1:"UNKNOWN"),WARD=$S($P(WARD,U)]"":$P(WARD,U),1:"UNKNOWN")
 K VAEL,VAERR,VADM,VAIN,VAINDT,DVBAPGM,VAMB,ADMNUM,DVBAX,DVBAY
RCV ;A&A and Pension
 ;
 ;* QUIT1 set by DVBAADRP, DVBACMRP, DVBADSNT, DVBADSRP, DVBADSRT,
 ;*  DVBARAD1, DVBASPD2
 Q:$D(QUIT1)  S RCVAA=$S($D(^DPT(DFN,.362)):^(.362),1:""),RCVPEN=$P(RCVAA,U,14),RCVAA=$P(RCVAA,U,12)
 S RCVAA=$S(RCVAA="Y":1,RCVAA="N":0,1:""),RCVPEN=$S(RCVPEN="Y":1,RCVPEN="N":0,1:"")
SC ;Service Connection
 S DVBASC=$S($D(^DPT(DFN,.3)):$P(^(.3),U),1:"")
CNUM ;Claim Number and Location
 S CNUM=$S($D(^DPT(DFN,.31)):^(.31),1:"")
 S CFLOC=+$P(CNUM,U,4)
 S CNUM=$P(CNUM,U,3)
 S:CNUM="" CNUM="UNKNOWN"
 S XCN=$E(CNUM,$L(CNUM)-1,$L(CNUM))
 S CFLOC=$S($D(^DIC(4,CFLOC,99)):$P(^(99),U,1),1:"UNKNOWN")
 Q
 ;
ELIG S ELIG=DVBAELIG,INCMP=""
 W ?6,"Eligibility data:"
 I ELIG]"" S ELIG=ELIG_" ("_$S(DVBAELST="P":"Pend Ver",DVBAELST="R":"Pend Re-verif",DVBAELST="V":"Verified",1:"Not Verified")_")"
 I $D(^DPT(DA,.29)) S INCMP=$S($P(^(.29),U,12)=1:"Incompetent",1:"")
 W ?26,ELIG_$S(ELIG]"":", ",1:"") W:$X>60 !?26 W INCMP,!
 Q
 ;
NOTES ;Supported fields for this routine
 ;.362 Disability Ret from Military
 ;.291 Date ruled incomp (VA)
 ;.292 Date ruled incomp (civil)
 ;.293 Rated incomp?
 ;.313 Claim number
 ;.312 Claim folder loc (as free text)
 ;2.101 Log-in date/time
 ;File 44 field .02 Bedsection
 ;Elig file Print name

DVBCAACK
DVBCAACK ;ALB/GTS-557/THM-ALIMENTARY APPENDAGES ; 2/6/91  6:40 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 305 Worksheet" S HD7="ALIMENTARY APPENDAGES (DIGESTIVE)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"Detailed description of chronic, active symptomatology in the",!?13,"""subjective complaints"" portion of this or the main examination is",!?13,"critical to the degree of disability assigned for the veteran.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!! D:'$D(CMBN) HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!?8,"1. Abdominal discomfort -",!!!!!!
 W ?8,"2. Food intolerance -",!!!!!!?8,"3. Nausea (frequency) -",!!!!!!?8,"4. Vomiting (frequency) -",!!!!!!?8,"5. Degree of pain -",!!!!!! D:$D(CMBN) HD2 W ?8,"6. Anorexia -",!!!!!!
 W ?8,"7. Malaise -",!!!!!! D:'$D(CMBN) HD2 W ?8,"8. Weight loss -",!!!!!!?8,"9. Generalized weakness -",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W HD8,!!!
 Q
SETIOF ;  ** Set device control variables **
 D HOME^%ZIS
 Q

DVBCADCK
DVBCADCK ;ALB/GTS-557/THM-AUDIO EXAM ; 5/10/91  9:13 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1305 Worksheet" S HD7="AUDIO",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,! I '$D(CMBN) W "Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"When only pure tone results should be used to evaluate",!?13,"hearing loss, the Chief of the Audiology Clinic should",!?13,"certify that language difficulties or other problems make",!
 W ?13,"the use of both pure tone average and speech discrimination",!?13,"inappropriate.",!! I '$D(CMBN) W "A. Audiological history:",!!!!!!!!!!
 W $S($D(CMBN):"A. ",1:"B. ") W "Pure tone thresholds at indicated frequencies (air conduction):",!!?16,"dB",?49,"dB",!," ========== RIGHT EAR ========== + ========== LEFT EAR ===========",!
 W "   A*   B    C    D    E            A*   B    C    D    E",!
 W "+------------------------------**+------------------------------**+",!
 W "| 500|1000|2000|3000|4000|Average| 500|1000|2000|3000|4000|Average|",!,"+--------------------------------+--------------------------------+",!
 W "|    |    |    |    |    |       |    |    |    |    |    |       |",!,"+----+----+----+----+----+-------+----+----+----+----+----+-------+",!!
 W "* The pure tone threshold at 500 Hz is not currently used for evaluation",!,"purposes but is used in determining whether or not a ratable hearing",!,"loss exists.",!!,"** - average of B, C, D, and E"
 W !!!!,$S($D(CMBN):"B. ",1:"C. ") W "Speech recognition score:",!!,"   1. Maryland CNC word list _______ % right ear  _______ % left ear",!!
 W "   2.         W-22 word list _______ % right ear  _______ % left ear",!!,"      (Only if specifically requested by the regional office)",!!!! I $Y>58 D HD2
 W $S($D(CMBN):"C. ",1:"D. "),"Note whether tinnitus is present and if so, indicate the following:",!!!! S X1=0
 F X="Date/circumstance of onset","Unilateral vs bilateral","Constant vs periodic (indicate frequency)","Severity and effect on daily life","Veteran account of loudness/pitch" S X1=X1+1 W ?5,X1,". ",X," -",!!!! I $Y>58 D HD2
 K X1,X
 W $S($D(CMBN):"D. ",1:"E. "),"Note whether audiologic results indicate an ear or hearing problem",!,"that requires medical follow-up or a problem, which, if treated, may",!,"cause a change in hearing threshold levels -",!!!!!!!
 W $S($D(CMBN):"E. ",1:"F. "),"Summary of audiologic test results:",!!!!!!!!
 W $S($D(CMBN):"F. ",1:"G. "),"Recommendations/remarks:",!!!!!!!!
 W ?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 W !!?22,"Adequated by: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCADE1
DVBCADE1 ;ALB/GTS-557/THM-PRINT/REPRINT WORKSHEETS ; 5/7/91  11:20 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;from DVBCADEX
 K RPRT I '$D(^TMP($J,"NEW")) W !!,"No exams selected ...",!! H 2 Q
 D COPY G EN
 ;
CK1 I $P(^DVB(396.4,EXDA,0),U,4)'="O"!($P(^(0),U,5)="Y"),'$D(RPRT) Q
 K CMBN I $P(TEMP("NEW",ZC,EXMNM),U,2)="A" S CMBN=1
 S PGM=$S($D(^DVB(396.6,JY,0)):$P(^(0),U,4),1:"")
 I PGM="" Q
 S TNAM=$P(^(0),U,1),PGM="^"_PGM D @PGM
 N DVBCEXM S DVBCEXM=EXMNM K DVBCFF
 I ZC="A" DO
 .S DVBCEXM=$O(TEMP("NEW","A",DVBCEXM))
 .I DVBCEXM'="" S DVBCFF=""
 .I '$D(DVBCFF) S DVBCEXM=$O(TEMP("NEW","Z","")) DO
 ..I DVBCEXM'="" S DVBCFF=""
 I ZC="Z" DO
 .S DVBCEXM=$O(TEMP("NEW","Z",DVBCEXM))
 .I DVBCEXM'="" S DVBCFF=""
 W:(IOST?1"P-".E)&($D(DVBCFF)) @IOF
 K DVBCFF,DVBCEXM
 S $P(^DVB(396.4,EXDA,0),U,5)="Y"
 K CMBN,TNAM,PGM Q
 ;
EN W @FF,!!,"Worksheets should be sent to a printer." S %ZIS="AEQ",%ZIS("A")="Output device: " D ^%ZIS Q:POP  K %ZIS
 ;
QUE I $D(IO("Q")) S ZTRTN=$S($D(RPRT):"GO2^DVBCADE1",1:"GO^DVBCADE1"),ZTDESC="Print C&P Work Sheets" F I="DUZ","DA*","DFN","TEMP*","REQDA","OWNDOM","RPRT","C*","SSN","PNAM" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD S:'$D(ZTSK) POP=1 W:$D(ZTSK) !!,"Request queued",!! H 1 K IO("Q"),ZTRTN,ZTIO,ZTDESC K:'$D(RPRT) ZTSK Q
 Q:$D(RPRT)
 ;
GO U IO S DA=REQDA D VARS^DVBCUTIL
 S EXMNM="" F ZC="A","Z" F JZ=0:0 S EXMNM=$O(TEMP("NEW",ZC,EXMNM)) Q:EXMNM=""  S JY=$P(TEMP("NEW",ZC,EXMNM),U,1),EXDA=$P(TEMP("NEW",ZC,EXMNM),U,3) D CK1
 D ^%ZISC D:$D(ZTQUEUED) KILL^%ZTLOAD Q
 ;
SET S EXDA=+Y,JY=$P(Y,U,2) D EXMNM I '$D(OUT) D FMT D:$D(OUT) QUES Q:$D(OUT)  I '$D(OUT) S ^TMP($J,"NEW",EXMNM)=JY_U_FMT_U_EXDA H 1 W @FF,!!,HD4,!!!
 Q
 ;
 ;print/reprint worksheets
RPRT S RPRT=1 D HOME^%ZIS S FF=IOF
 ;
EN1 K ^TMP($J),DA,EXDA,EXMNM,OUT,DIC
 W @FF,!,"Print/Reprint C&P Worksheets",!!!
 S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Select VETERAN NAME: "
 D ^DIC G:X=""!(X=U) EXIT S (REQDA,DA(1))=+Y
 S HD4="Select exam(s) to print or enter ALL to print all exams."
 W !!,HD4,!!!
 K OUT,OUT1
 F I=0:0 K DIC,Y,D S DIC("A")="Select EXAM: " W ?10,DIC("A") S DIC="^DVB(396.6,",DIC("S")="I $D(^DVB(396.4,""ARQ""_REQDA,+Y))",DIC(0)="EQ" R X:DTIME S:'$T OUT1=1 Q:$D(OUT1)!(X="")!(X=U)!(X="ALL")!(X="all")  DO
 .D ^DIC D:X["?" QUES W:+Y<0 !!
 .I +Y>0 K DIC S X=+Y,DIC="^DVB(396.4,",DIC(0)="EQ",D="ARQ"_REQDA DO
 ..D MIX^DIC1 K DIC,D
 .I +Y>0 D SET
 G:$D(OUT1) EXIT
 I $D(X),X="ALL"!(X="all") F EXDA=0:0 S EXDA=$O(^DVB(396.4,"C",REQDA,EXDA)) Q:EXDA=""  D FMT G:$D(OUT1) EXIT Q:$D(OUT)  S ^TMP($J,"NEW",EXMNM)=JY_U_FMT_U_EXDA
 I '$D(^TMP($J,"NEW")) W *7,!!,"No exams selected ..." H 2 G EN1
 D COPY,EN G:POP EXIT I $D(ZTSK) K ZTSK G EN1
 ;
GO2 U IO S DA=DA(1) D VARS^DVBCUTIL
 S OWNDOM=$P(^DVB(396.3,DA(1),0),U,22) I OWNDOM]"" D ^DVBCTRNN
 S EXMNM="" F ZC="A","Z" F JZ=0:0 S EXMNM=$O(TEMP("NEW",ZC,EXMNM)) Q:EXMNM=""  S JY=$P(TEMP("NEW",ZC,EXMNM),U,1),EXDA=$P(TEMP("NEW",ZC,EXMNM),U,3) D CK1
 D ^%ZISC G:'$D(ZTQUEUED) EN1 I $D(ZTQUEUED) G EXIT
 ;
EXMNM K OUT S JY=$P(^DVB(396.4,EXDA,0),U,3)
 S EXMNM=$S($D(^DVB(396.6,JY,0)):$P(^(0),U,1),1:"")
 I EXMNM="" S OUT=1 ;!($D(^TMP($J,"NEW",EXMNM))) S OUT=1
 Q
 ;
FMT W @IOF,! D EXMNM W !!?10,EXMNM,!
 K OUT,OUT1 I $P(^DVB(396.4,EXDA,0),U,4)'="O" W *7,!!?5,"Status is not OPEN - No worksheet will be printed.    " H 3 S OUT=1 Q
 W !,"Worksheet format type: (A)bbreviated or (F)ull:  F// "
 R FMT:DTIME I '$T S OUT1=1 Q
 I FMT[U S OUT=1 Q
 I FMT="" S FMT="F" W "Full" Q
 W $S((FMT["A")!(FMT["a"):"bbreviated",(FMT["F")!(FMT["f"):"ull",1:"") I FMT="" S FMT="F"
 I FMT["?" W !!,"Enter ALL for all, A to get a format without the medical, subjective",!," and objective findings or F for the full format.",!! H 3 G FMT
 I (FMT'?1"A"),(FMT'?1"a"),(FMT'?1"F"),(FMT'?1"f") W *7,!!,"Must be A or F.",!! H 2 G FMT
 S:(FMT["F")!(FMT["f") FMT="F" S:(FMT["A")!(FMT["a") FMT="A"
 Q
 ;
COPY K TEMP S X="" F Y=0:0 S X=$O(^TMP($J,"NEW",X)) Q:X=""  S Z=$S($P(^TMP($J,"NEW",X),U,2)="F":"A",1:"Z"),TEMP("NEW",Z,X)=^TMP($J,"NEW",X) ;full come out first, then abbreviated
 Q
 ;
QUES W !!,"Press RETURN to continue  " R ANS:DTIME
 W @FF,!!,HD4,!!!
 Q
 ;
EXIT K RPRT,FMT,OUT,OUT1 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBCUTIL

DVBCADE2
DVBCADE2 ;ALB/GTS-557/THM-ADD C&P EXAMS TO REQUESTS, PART 2 ; 4/18/91  7:23 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EXMHD W @FF,?(IOM-$L(HD2)\2),HD2,!!,"Please select the exams for ",$P(PNAM,",",2,99)," ",$P(PNAM,",",1),!,"Use ? to see a list exams available for selection.",!!
 ;
EXMSEL I $D(DVBCLCKD) Q
 S DIC("S")="I $P(^(0),U,5)'=""I""",DIC="^DVB(396.6,",DIC(0)="AEQM"
 S DIC("A")="Select EXAM: "
 K OUT D ^DIC S:$D(DTOUT) OUT=1 Q:$D(OUT)
 G:X=""!(X=U) EXMDIS ;Only out of EXMSEL
 I +Y<0 W " ??",*7 G EXMSEL
 S EXMDA=+Y,EXMNM=$P(^DVB(396.6,+Y,0),U,1)
 I $D(^TMP($J,"NEW",EXMNM)) W "    Duplicate - ignored",!,*7 G EXMSEL
 I $D(^DVB(396.4,"APS",DFN,EXMDA,"O")) W *7,"  -- already ON FILE",! G EXMSEL
 I $D(^DVB(396.4,"APS",DFN,EXMDA,"X"))!($D(^DVB(396.4,"APS",DFN,EXMDA,"RX"))) W *7,"  -- Previously cancelled,  addition allowable",!
FMT ;drop into
 S EXCNT=EXCNT+1
 I EXCNT=1 W !!,*7,"Note:  This will be generated in a FULL format",! H 2
 G:EXCNT=1 FMT1 ;Only out of FMT
 K OUT W !!,"Worksheet format type: (A)bbreviated or (F)ull:  F// " R FMT:DTIME I '$T!(FMT[U) S OUT=1 Q
 I FMT="" W "Full"
 W $S((FMT["A")!(FMT["a"):"bbreviated",(FMT["F")!(FMT["f"):"ull",1:"") I FMT="" S FMT="F"
 I FMT["?" W !!,"Enter A for a format without the medical, subjective",!," and objective findings or F for the full length format.",!! D CONTMES^DVBCUTL4 G FMT
 I (FMT'?1"A"),(FMT'?1"a"),(FMT'?1"F"),(FMT'?1"f") W *7,!!,"Must be A or F.",!! D CONTMES^DVBCUTL4 G FMT
 S:(FMT["F")!(FMT["f") FMT="F" S:(FMT["A")!(FMT["a") FMT="A"
 ;
 ;** FMT1 drops into from FMT or jumps into from FMT+3
FMT1 S ^TMP($J,"NEW",EXMNM)=+Y_U_$S(EXCNT=1:"F",1:FMT)_U_EXMDA K Y H 1 W @FF,!!! G EXMSEL ;1st exam is 'full'
 ;
EXMDIS K %,%Y,DIE,DIC G:$D(DVBCLCKD) EXMSEL
 I '$D(^TMP($J,"NEW")) W !!,*7,"You have not selected any exams.",!,"Do you want to try again" S %=1 D YN^DICN K OUT S:%=2 OUT=1 Q:$D(OUT)  G:%=1 EXMHD I $D(DTOUT) S OUT=1 Q
 I $D(%Y) I %Y["?" W !!,"Enter Y to select more exams or N to abort adding exams to this request.",!! G EXMDIS
 I $D(%),%'=1 S OUT=1 Q
 W @FF,!!,"You have selected:",!! S EXMNM=""
 F JY=0:1 S EXMNM=$O(^TMP($J,"NEW",EXMNM)) Q:EXMNM=""  W ?5,EXMNM,!
 S DIR(0)="YA"
 S DIR("A")=$S(JY'>1:"Is this exam",1:"Are these exams")_" correct? "
 S DIR("B")="NO"
 D ^DIR
 K DIR
 I Y K Y G EXMLOG
 I $D(DIRUT) K Y,DIROUT S OUT=1 Q
EXMOD ;drop into
 I Y=0 K DIC,DIR,Y S DIC(0)="AEQM",DIC("A")="Enter EXAM to delete: ",DIC="^DVB(396.6,",DIC("S")="I $D(^TMP($J,""NEW"",$P(^(0),U,1)))"
 ;
EXMOD1 W @FF,!!! K OUT D ^DIC
 S:$D(DTOUT) OUT=1 Q:$D(OUT)
 G:X=""!(X=U) EXMASK ;Only out of EXMOD1
 S EXMNM=$P(^DVB(396.6,+Y,0),U,1)
 I +Y>0&($D(^TMP($J,"NEW",EXMNM))) K ^TMP($J,"NEW",EXMNM) W:$X>50!($X<10) ! W "  Ok ..." S EXCNT=EXCNT-1 H 2 G EXMOD
 G EXMOD1
 ;
EXMASK K DIC
 W @FF,!!,"Want to add more exams"
 S %=1 D YN^DICN G:%=1 EXMHD ;add exams
 I $D(DTOUT) S OUT=1 Q
 I $D(%Y),%Y["?" W !!,"Enter Y to add more exams or N to go on and log existing selections." D CONTMES^DVBCUTL4 G EXMASK
 G EXMDIS
 ;
EXMLOG W !! S EXMNM="" K DR,OUT
 N DVBCLCKD
 F DVBCJ=0:0 S EXMNM=$O(^TMP($J,"NEW",EXMNM)) Q:EXMNM=""  S X=$$EXAM^DVBCUTL4 S:X=0 DVBCLCKD=1 Q:$D(DVBCLCKD)  D EXMLOG1^DVBCUTL4 Q:$D(OUT)
 I $D(DTOUT) S OUT=1 D ROLLBCK^DVBCUTL4
 Q:$D(OUT)
 W:$D(DVBCLCKD) !!,"   Another user adding exams now...try again later."
 R:$D(DVBCLCKD) !,"   PRESS [Return] TO CONTINUE...",DVBCCONT:DTIME
 I $D(DVBCLCKD) D ROLLBCK^DVBCUTL4 G EXMDIS
 I $P(^DVB(396.3,REQDA,0),U,2)'[DT S DR="23.3///NOW;23.4///"_DUZ,(DIC,DIE)="^DVB(396.3,",DA=REQDA D ^DIE ;no edit if requested today
 D ^DVBCBUL1 W !
 I '$D(OUT) S DIR("A")="Do you want to print worksheets ",DIR("A",1)="Worksheets should be sent to a printer.",DIR(0)="Y",DIR("?",1)="Enter Y to print worksheets for items just entered or",DIR("?")="N to skip." D ^DIR Q:Y=0!(Y=U)
 D ^DVBCADE1
 Q

DVBCADEX
DVBCADEX ;ALB/GTS-557/THM-ADD C&P EXAMS TO REQUESTS, PART 1 ; 6/28/91  9:32 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SETUP D HOME^%ZIS S FF=IOF,HD="Add a C & P Exam for",HD1="Veteran Selection",HD2="Exam selection",HD3="2507 Exam Addition"
 ;
EN K DVBCLCKD D KILL W @FF,!?(IOM-$L(HD3)\2),HD3,!!?(IOM-$L(HD1)\2),HD1,!!!
 S DIC(0)="AEQM",DIC="^DVB(396.3,",DIC("A")="Select VETERAN NAME: "
 S DIC("W")="D DICW^DVBCUTIL"
 S:$D(DVBAROUS) DIC("S")="I $P(^(0),U,10)'=""E""" ;**DVBAROUS set by menu
 D ^DIC G:X=""!(X=U) EXIT
 S:+Y>0 EXCNT=0,(DA,REQDA)=+Y,DFN=$P(Y,U,2) I +Y<0 W "   ???",*7 H 1 G EN
 S X=^DVB(396.3,REQDA,0),OWNDOM=$P(X,U,22)
 I OWNDOM]"" W *7,!!,"This request is a TRANSFER IN and exams cannot be added.",!! H 3 G EN
 S STAT=$P(X,U,18) K NCN
 F DTB="X","RX","T","C","R","CT","NT" I STAT=DTB S NCN=1 Q
 I $D(NCN) W !!,*7,"This request has been ",$S(STAT["X":"cancelled",STAT="T":"transcribed",STAT["C":"completed",STAT="R":"released",STAT="NT":"transferred in",1:"given an incorrect status"),".",!! H 3 G EN
 S DTA=^DPT(DFN,0),PNAM=$P(DTA,U,1),SSN=$P(DTA,U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") S:CNUM="" CNUM="Unknown" D HDR,^DVBCEEXM W !!,"Press RETURN     " R ANS:DTIME G:'$T EXIT
 D ^DVBCADE2,KILL G:$D(OUT)!($D(DVBCLCKD)) EXIT
 G EN
 ;
EXIT K DVBCLCKD G KILL^DVBCUTIL
 ;
HDR W @FF,?(IOM-$L(HD)\2),HD,!!,"Veteran name: ",$P(PNAM,",",2,99)," ",$P(PNAM,",",1),?55,"SSN: ",SSN,!?53,"C-NUM: ",CNUM,!
 F LINE=1:1:IOM W "="
 W ! Q
 ;
KILL K CNUM,DFN,DIK,DR,DTA,DXCOD,DXNUM,EDIT,EX,EXMNM,FMT,PNAM,SSN,PCT,SC,REQDA,CTIM,VX,JY,JJ,X,%,^TMP($J),Y,DA,DIC,DIE,ANS,%Y,%,DTOUT,DUOUT,TEMP,DVBCCONT
 K DVBAINDA
 Q

DVBCADR
DVBCADR ;ALB/JLU-editing the address ;1/28/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;driver of the program
 S DVBCSTP=0
 F  DO  Q:DVBCSTP
 .D PAT Q:DVBCSTP
 .D INIT Q:DVBCSTP
 .F  D GUTS Q:DVBCSTP1
 .I DVBCMAL D MAIL
 D EXIT
 Q
 ;
GUTS ;this is the interloop or guts of the driver
 D DISPL
 D ASK
 I 'Y S DVBCSTP1=1 Q
 D QUES^DGRPU1(DVBCDFN,"ADD1")
 I DGERR D ERROR Q
 I DGCHANGE S DVBCMAL=1
 D VDPTP
 Q
 ;
EXIT ;cleans variables
 K %H,DFN,DGCHANGE,DGERR,DIC,DIR,DVBC,DVBCDATE,DVBCDFN,DVBCLINE,DVBCMAL,DVBCPATN,DVBCSSN,DVBCSTP,DVBCSTP1,VAERR,VAPA,Y,XMTEXT,XMY,XMB,XMDUZ,XMSUB,DVBCX,DVBCML,DVBCSP,DVBCSP1,ER,J,C,PNAM,SSN,DVBCSSNO
 K DVBTMP,XMBTEXT
 Q
 ;
ERROR ;this is an erro printing subroutine
 I DGERR W !,*7
 Q
 ;
INIT ;initialize variables
 I '$D(IOF) D HOME^%ZIS
 K VAPA,DVBTMP,DVBC
 S %H=$H
 D YX^%DTC
 S DVBCDATE=$P(Y,"@",1)
 S $P(DVBCLINE,"_",80)=""
 S SSN=$P(^DPT(DVBCDFN,0),U,9)
 D SSNOUT^DVBCUTIL
 S DVBCSSN=DVBCSSNO
 D VDPTTMP
 I VAERR S DVBCSTP=1 Q
 I +VAPA(9) DO
 .D STORTMP
 .K VAPA
 .D VDPTP
 I VAERR S DVBCSTP=1 Q
 D STORE
 S (DVBCSTP1,DVBCMAL)=0
 Q
 ;
PAT ;get the patient
 S DIC="^DPT(",DIC(0)="AEMQ"
 D ^DIC
 I Y<0 S DVBCSTP=1 Q
 S DVBCDFN=+Y,(PNAM,DVBCPATN)=$P(Y,U,2)
 Q
 ;
DISPL ;the display subroutine
 W @IOF
 W "Edit Address Information",?35,$$SITE^DVBCUTL4,?67,DVBCDATE
 W !,"Name: ",DVBCPATN,?54,"SSN: ",DVBCSSN
 W !,DVBCLINE
 W !,?9,"Permanent"
 I $D(DVBTMP) DO
 .W ?40,"Temporary:  ",$P(DVBTMP(9),U,2)
 .I $P(DVBTMP(10),U,2)]"" W " to ",$P(DVBTMP(10),U,2)
 W !,"Address: ",$E(VAPA(1),1,29)
 I $D(DVBTMP) W ?40,$E(DVBTMP(1),1,29)
 W !,?9,$E(VAPA(2),1,29)
 I $D(DVBTMP) W ?40,$E(DVBTMP(2),1,29)
 W !,?9,$E(VAPA(3),1,29)
 I $D(DVBTMP) W ?40,$E(DVBTMP(3),1,29)
 W !,"City:",?9,VAPA(4)
 I $D(DVBTMP) W ?40,DVBTMP(4)
 W !,"State:",?9,$P(VAPA(5),U,2)
 I $D(DVBTMP) W ?40,$P(DVBTMP(5),U,2)
 W !,"Zip+4:",?9,$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
 I $D(DVBTMP) W ?40,DVBTMP(11)
 W !,"County:",?9,$P(VAPA(7),U,2)
 I $D(DVBTMP) W ?40,$P(DVBTMP(7),U,2)
 W !,"Phone:",?9,VAPA(8)
 I $D(DVBTMP) W ?40,DVBTMP(8)
 W !,"Office:",?9,VAPA(9999)
 W !,DVBCLINE
 Q
 ;
ASK ;ask if yes or no
 S DIR(0)="Y",DIR("A")="Do you wish to edit this address:",DIR("B")="YES"
 D ^DIR
 Q
 ;
STORE ;store original address fro possible bulletin
 S DVBC(1)=VAPA(1),DVBC(2)=VAPA(2),DVBC(3)=VAPA(3)
 S DVBC(4)=VAPA(4),DVBC(5)=$P(VAPA(5),U,2)
 S DVBC(11)=$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
 S DVBC(7)=$P(VAPA(7),U,2),DVBC(8)=VAPA(8)
 S DVBC(9999)=VAPA(9999)
 Q
 ;
VDPTP ;gets the permanent address
 S VAPA("P")=""
VDPTTMP ;gets the temporary address if one
 S DFN=DVBCDFN
 D ADD^VADPT
 S VAPA(9999)=$S($D(^DPT(DFN,.13)):$P(^(.13),U,2),1:"")
 Q
 ;
STORTMP ;saves the active temporary address
 S DVBTMP(1)=VAPA(1),DVBTMP(2)=VAPA(2),DVBTMP(3)=VAPA(3),DVBTMP(4)=VAPA(4)
 S DVBTMP(5)=VAPA(5),DVBTMP(11)=$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
 S DVBTMP(7)=VAPA(7),DVBTMP(8)=VAPA(8)
 S DVBTMP(9)=VAPA(9),DVBTMP(10)=VAPA(10)
 Q
 ;
MAIL ;to fire a bulletin if necessary
 S XMDUZ="AMIE Package",XMSUB="Edit of patient address"
 S XMB(1)=DVBCPATN_"   SSN: "_DVBCSSN,XMB(2)=DVBCDATE,XMB(3)=$P(^VA(200,DUZ,0),U,1)
 S XMB="DVBA C EDIT ADDRESS"
 D XMT
 S XMTEXT="DVBCML("
 D EN^XMB
 K XMBTEXT,XMTEXT,XMB,XMSUB
 W !!,"A bulletin has been sent to the appropriate mail group regarding this",!,"address change!"
 Q
 ;
XMT ;make the text of the bulletin
 S DVBCX=1 D LIN
 S DVBCML(1)="ADDR.:  "_DVBC(1)_DVBCSP_VAPA(1)
 S DVBCX=2 D LIN
 S DVBCML(2)="        "_DVBC(2)_DVBCSP_VAPA(2)
 S DVBCX=3 D LIN
 S DVBCML(3)="        "_DVBC(3)_DVBCSP_VAPA(3)
 S DVBCX=4 D LIN
 S DVBCML(4)="City:   "_DVBC(4)_DVBCSP_VAPA(4)
 S DVBCX=5 D LIN
 S DVBCML(5)="State:  "_DVBC(5)_DVBCSP_$P(VAPA(5),U,2)
 S DVBCX=11 D LIN
 S DVBCML(6)="Zip+4:  "_DVBC(11)_DVBCSP_$S($D(VAPA(11)):$P(VAPA(11),"^",2),1:"")
 S DVBCX=7 D LIN
 S DVBCML(7)="County: "_DVBC(7)_DVBCSP_$P(VAPA(7),U,2)
 S DVBCX=8 D LIN
 S DVBCML(8)="Phone:  "_DVBC(8)_DVBCSP_VAPA(8)
 S DVBCX=9999 D LIN
 S DVBCML(9)="Office: "_DVBC(9999)_DVBCSP_VAPA(9999)
 Q
 ;
LIN ;makes spaces
 K DVBCSP,DVBCSP1
 S DVBCSP1=37-$L(DVBC(DVBCX))
 S $P(DVBCSP," ",DVBCSP1)=""
 Q

DVBCAMC1
DVBCAMC1 ;ALB ISC/THM-CONTINUATION OF ATTACHMENT A FOR AMP STUMPS ; 12/11/90  8:01 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 W " 2. The leg.  The stump of an amputated leg will be measured from the insertion",!,"of the internal hamstring muscles to the bony end of the stump, with the",!,"subject recumbent and the leg flexed at 90 degrees.",!!
 W " 3. The arm.  The stump of an amputated arm will be measured from the ",!,"anterior axillary fold to the bony end of the stump, with the stump hanging",!,"parallel to the chest wall.  Indicate whether the amputation site is above ",!
 W "or below the insertion of the deltoid muscle.  A statement of the",!,"remaining function is the best indicator of a disability's severity.",!!," 4. The forearm.  The stump of an amputated forearm will be measured from the",!
 W "insertion of the biceps tendon to the bony end, with the elbow flexed",!,"at 90 degrees.  Indicate if the amputation site is above or below the",!,"attachment of the pronator teres.",!!
 W " 5. Parts below the wrist.  Amputations of fingers will be described as",!,"though the distal, middle, or proximal phalanx or as disarticulations through",!,"the distal interphalangeal, proximal interphalangeal, or metacarpophalangeal",!
 W "joint.  Resection of the head of the metacarpal will always be reported",!,"if shown.  Complete or partial loss or resection of bones of the hand will",!,"described in terms of the fraction of each remaining.  If surgery has",!
 W "altered the usefulness of remaining or transplanted digits, this will",!,"be described.",!!," 6. Parts below the ankle.  Complete or partial loss of toes or of",!
 W "metatarsal or tarsal bones will be described as in subparagraph five above.",!
 W "Always report loss of metatarsal head or other defects.  Indicate if",!,"amputation is through the tarsal-metatarsal joint and if any other portions",!,"of the bones of the foot remain.",!!

DVBCAMCK
DVBCAMCK ;ALB/GTS-557/THM-AMPUTATION STUMP EXAM ; 5/21/91  10:07 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1405 Worksheet" S HD7="AMPUTATION STUMPS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,! I '$D(CMBN) W "Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Amputations must be described in accordance with the following",!?13,"levels:",!!!!!!!?5,"1. ARM:",!!?8,"a. Disarticulation",!?8,"b. Amputation above insertion of deltoid muscle",!?8,"c. Amputation below insertion of deltoid muscle",!!
 W ?5,"2. FOREARM:",!!?8,"a. Above radial insertion of pronator teres (function is best indicator",!?11,"of disability)",!?8,"b. Below insertion of pronator teres",!!
 W ?5,"3. THIGH:",!!?8,"a. Disarticulation, with loss of extrinsic pelvic girdle muscles",!?8,"b. Amputation of upper, middle or lower third, always measured",!?11,"from perineum to the boney end of the stump with the claimant",!
 W ?11,"recumbent and stump lying parallel with the other lower limb",!?8,"c. State whether this level permits satisfactory prosthesis",!!
 W ?5,"4. LEG:",!!?8,"a. Give level of amputation and condition of stump",!?8,"b. State whether this level permits satisfactory prosthesis",!?8,"c. Describe any stump defects (e.g. painful neuroma or circulatory",!?11,"disturbance)",!!
 I '$D(CMBN) D HD2 W "A. Objective findings:",!!!!!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"A. ",1:"B. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!!
 W ?8,"1. Scar -",!!!!!?8,"2. Circulation -",!!!!!?8,"3. Skin -",!!!!!?8,"4. Muscles -",!!!!!?8,"5. Joint -",!!!!!
 W ?8,"6. Bone -",!!!!!?8,"7. Length of stump (see Attachment A) -",!!!!! D:'$D(CMBN) HD2 W ?8,"8. Describe any limited motion or instability in",!?11,"the joint above the amputation site -",!!!!!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
ATTACH ;attachment A
 S DVBAX="Attachment A" W @IOF,!?(IOM-$L(DVBAX)\2),DVBAX,!?(IOM-$L(HD7)\2),HD8,!!!
 W "Length of stump",!!
 W " 1. The thigh.  The stump of an amputated thigh will be measured from the",!,"perineum, at the origin of the adductor tendons, to the bony end of the stump,",!,"with the claimant recumbent and the stump lying parallel with the other",!
 W "lower limb.  It is to be kept in mind that if the limb is abducted,",!,"flexed, rotated or adducted, its length will be altered.  The effective length",!,"of a thigh stump is governed by its inside dimension.  Measure length of",!
 W "normal thigh if present and indicate whether amputation is in upper,",!,"middle, or lower third.  When amputation is bilateral, estimate the same",!,"for a person of similar height.",!! D ^DVBCAMC1
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCAMI1
DVBCAMI1 ;ALB/GTS-557/THM-AMIS REPORT/BULLETIN TEXT ; 10/4/91  8:48 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
BULLTXT S TOTRECV=TOT("RECEIVED")+TOT("INSUFF"),TOTRVTN=TOTRECV+TOT("TRANSIN")
 S ^TMP($J,1,0)="Processing date: "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
 S ^TMP($J,2,0)=" "
 S ^TMP($J,3,0)="Total pending from previous month: "_PREVMO
 S ^TMP($J,4,0)=" "
 S ^TMP($J,5,0)="Requests received for date range: "_TOT("RECEIVED")
 S ^TMP($J,5.1,0)=" "
 S ^TMP($J,5.3,0)="Exams returned as insufficient: "_TOT("INSUFF")_"  ("_$S(TOTRECV>0:$J(TOT("INSUFF")/TOTRECV*100,0,0),1:0)_"%)"
 S ^TMP($J,6,0)="Requests returned complete: "_TOT("COMPLETED")
 S ^TMP($J,7,0)="Requests returned incomplete: "_TOT("INCOMPLETE")
 S ^TMP($J,8,0)=" "
 S ^TMP($J,8.1,0)="Total processing time: "_TOT("DAYS")_$S(TOT("DAYS")=1:" day",1:" days")
 S ^TMP($J,8.2,0)=" "
 S ^TMP($J,9,0)="Pending end of month: "_TOT("PENDADJ")
 S ^TMP($J,10,0)="Average processing time: "_TOT("AVGDAYS")_$S(TOT("AVGDAYS")>1!(TOT("AVGDAYS")<1):" days",1:" day")
 S ^TMP($J,11,0)=" "
 S ^TMP($J,12,0)="Greater than 3 days to schedule: "_TOT("3DAYSCH")
 S ^TMP($J,13,0)="Greater than 30 days to examine: "_TOT("30DAYEX")
 S ^TMP($J,14,0)=" "
 S ^TMP($J,15,0)="Pending, 0-90 days: "_TOT("P90")
 S ^TMP($J,16,0)="Pending, 91-120 days: "_TOT("P121")
 S ^TMP($J,17,0)="Pending, 121-150 days: "_TOT("P151")
 S ^TMP($J,18,0)="Pending, 151-180 days: "_TOT("P181")
 S ^TMP($J,19,0)="Pending, 181-365 days: "_TOT("P365")
 S ^TMP($J,20,0)="Pending, 366 or more days: "_TOT("P366")
 S ^TMP($J,21,0)=" "
 S ^TMP($J,22,0)="Transfers in from other sites: "_TOT("TRANSIN")_"  ("_$S(TOTRVTN>0:$J(TOT("TRANSIN")/TOTRVTN*100,0,0),1:0)_"%)"
 S ^TMP($J,23,0)="Transfers returned to other sites: "_TOT("TRNRETTO")
 S ^TMP($J,24,0)="Transfers pending return to other sites: "_TOT("TRNPNDTO")
 S ^TMP($J,25,0)=" "
 S ^TMP($J,26,0)="Transfers out to other sites: "_TOT("TRANSOUT")_"  ("_$S(TOTRVTN>0:$J(TOT("TRANSOUT")/TOTRVTN*100,0,0),1:0)_"%)"
 S ^TMP($J,27,0)="Transfers returned from other sites: "_TOT("TRNRETFR")
 S ^TMP($J,28,0)="Transfers pending return from other sites: "_TOT("TRNPNDFR")
 S ^TMP($J,29,0)=" "
 S ^TMP($J,32,0)=" ** Transfer figures are for information only **"
 S ^TMP($J,33,0)="* and should not be used to balance this report *"
 K DIC,DIE,DR,DA,TOTRECV,TOTRVTN
 Q

DVBCAMI2
DVBCAMI2 ;ALB/GTS-557/THM-HOSPITAL AMIS 290 ; 7/1/91  9:48 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - GTS/Coded to adjust 35 day clock calc  (Enhc 13)
 ;
DAY30 K ^TMP("DVBC",$J)
 F FA=DTRPT-.1:0 S FA=$O(^DPT(PNAM,"S",FA)) Q:FA=""!(FA>EDATE)  I $D(^(FA,0)) S L=^(0),C=+L S YY=$P(L,U,2) I YY'="N"&(YY'="C")&(YY'="NA")&(YY'="CA")&(YY'="PC")&(YY'="PCA")&(YY'="NT") I FA'>EDATE S:$P(L,U,16)="1" ^TMP("DVBC",$J,9999999-FA,FA)=""
 Q:'$D(^TMP("DVBC",$J))  S FB=$O(^TMP("DVBC",$J,0)),FA=$O(^TMP("DVBC",$J,FB,0)) I FA]"" S X1=FA,X2=$S(DTRPT]"":DTRPT,1:DVBCNOW) D ^%DTC I X>30 S TOT("30DAYEX")=TOT("30DAYEX")+1
 Q
 ;
GO1 ;  ** TFIND=1 If any exams have not been transferred. **
 K TFIND F XI=0:0 S XI=$O(^DVB(396.4,"C",REQDA,XI)) Q:XI=""  I $P(^DVB(396.4,XI,0),U,4)'="T" S TFIND=1
 Q
 ;if $D(TFIND) at least one exam to be done locally
 ;
PENDCNT I X'<0&(X'>90) S TOT("P90")=TOT("P90")+1
 I X>90&(X'>120) S TOT("P121")=TOT("P121")+1
 I X>120&(X'>150) S TOT("P151")=TOT("P151")+1
 I X>150&(X'>180) S TOT("P181")=TOT("P181")+1
 I X>180&(X'>365) S TOT("P365")=TOT("P365")+1
 I X>365 S TOT("P366")=TOT("P366")+1
 Q
 ;
SET S DTA=^DVB(396.3,REQDA,0),DFN=$P(DTA,U,1),DTREQ=$P(DTA,U,2),DTRPT=$P(DTA,U,5),DTSCHEDC=$P(DTA,U,6),DTRQCMP=$P(DTA,U,7),PRIO=$P(DTA,U,10),DTTRANS=$P(DTA,U,12),OWNDOM=$P(DTA,U,22)
 S DTREL=$P(DTA,U,14),RQSTAT=$P(DTA,U,18),DTCAN=$P(DTA,U,19) K DTA
 S DTA=$S($D(^DVB(396.3,REQDA,4)):^(4),1:""),TROUT=$P(DTA,U,1),DTTROUT=$P(DTA,U,3),DTTRIN=$P(DTA,U,4),DTTRET=$P(DTA,U,5)
 I DTCAN]"",DTCAN<DTRPT,DTRPT]"" S DTRPT=DTCAN ;cancelled last day of month
 Q:DTRPT=""  ;never reported to MAS
 I DTTRIN'<BDATE,DTTRIN'>EDATE S TOT("TRANSIN")=TOT("TRANSIN")+1 ;transfers in
 I RQSTAT="CT",DTREL'<BDATE,DTREL'>EDATE S TOT("TRNRETTO")=TOT("TRNRETTO")+1 ;transfers returned to owners
 I "^N^NT^P^S^T^"[RQSTAT,OWNDOM]"" S TOT("TRNPNDTO")=TOT("TRNPNDTO")+1 ;transfers pending return to others
 Q:DTTRIN]""  ;** A transfer in (not counted further)
 I DTREL'<BDATE,DTREL'>EDATE D DAY30
 I DTTROUT'<BDATE,DTTROUT'>EDATE,TROUT="y" S TOT("TRANSOUT")=TOT("TRANSOUT")+1 ;transfers to other sites, not returns
 I TROUT="",DTTRET'<BDATE,DTTRET'>EDATE S TOT("TRNRETFR")=TOT("TRNRETFR")+1 ;transfers returned from other sites
 I TROUT="y",RQSTAT="P" S TOT("TRNPNDFR")=TOT("TRNPNDFR")+1 ;transfers pending return from other sites
 I DTRPT'<BDATE,DTRPT'>EDATE,PRIO'="E" S TOT("RECEIVED")=TOT("RECEIVED")+1
 I DTRPT'<BDATE,DTRPT'>EDATE,PRIO="E" S TOT("INSUFF")=TOT("INSUFF")+1
 I DTRPT'<BDATE,DTRPT'>EDATE,RQSTAT'["X" D GO1 I $D(TFIND) S X1=$S(DTSCHEDC]"":DTSCHEDC,1:DVBCNOW),X2=DTRPT D ^%DTC I X>3 S TOT("3DAYSCH")=TOT("3DAYSCH")+1
 I DTREL'<BDATE&(DTREL'>EDATE),RQSTAT="C"!(RQSTAT="R") S:PRIO'="E" DVBCPCTM=$$PROCDAY^DVBCUTL2(REQDA) S:PRIO="E" DVBCPCTM=$$INSFTME^DVBCUTA1(REQDA) S TOT("DAYS")=TOT("DAYS")+DVBCPCTM K DVBCPCTM
 I DTRPT'>EDATE,"^N^NT^P^S^T^"[RQSTAT S X1=EDATE,X2=DTRPT D ^%DTC,PENDCNT
 I DTRPT'>EDATE,"^C^CT^R^RX^X^"[RQSTAT,(+DTREL>EDATE)!(+DTCAN>EDATE) S X1=EDATE,X2=DTRPT D ^%DTC,PENDCNT
 I DTREL'<BDATE&(DTREL'>EDATE),RQSTAT="C"!(RQSTAT="R") S TOT("COMPLETED")=TOT("COMPLETED")+1
 I DTCAN'<BDATE,DTCAN'>EDATE,RQSTAT["X" S TOT("INCOMPLETE")=TOT("INCOMPLETE")+1
 K DTRPT Q
 ;
GO U IO K ^TMP($J) S PG=0,%DT="TS",X="NOW" D ^%DT S DVBCNOW=Y
 S PNAM="" F JJ=0:0 S PNAM=$O(^DVB(396.3,"B",PNAM)) Q:PNAM=""  F REQDA=0:0 S REQDA=$O(^DVB(396.3,"B",PNAM,REQDA)) Q:REQDA=""  D SET
 S TOT("AVGDAYS")=0
 I TOT("COMPLETED")>0 S TOT("AVGDAYS")=TOT("DAYS")/TOT("COMPLETED"),TOT("AVGDAYS")=$J(TOT("AVGDAYS"),5,1)
 S TOT("PENDADJ")=PREVMO+TOT("RECEIVED")+TOT("INSUFF")-TOT("COMPLETED")-TOT("INCOMPLETE")
 D BULLTXT^DVBCAMI1 G ^DVBCAMI3

DVBCAMI3
DVBCAMI3 ;ALB/GTS-557/THM-HOSPITAL AMIS 290 PRINTING, BULLETIN SEND ; 7/16/91  8:55 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
EN U IO D HDR F JI=0:0 S JI=$O(^TMP($J,JI)) Q:JI=""  W ^(JI,0),! I IOST?1"C-".E,$Y>19 D PAUSE G:$D(OUT) EXIT D HDR
 I IOST?1"P-".E D ^%ZISC
 D PAUSE I $D(OUT)!(ANS=U) W:SBULL="Y" !!,*7,"Bulletin will NOT be sent!!",*7,! H 2 G EXIT
 D ^%ZISC
 S:'$D(XMY) SBULL="N" I SBULL="Y" D SEND
 ;
EXIT K TFIND,PG,OUT,PREVMO,UPDATE,DTTRET,DTTRIN,DTTROUT,TROUT,XI
 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBCUTIL
 ;
BULL W ! S XMDUZ=DUZ,XMMG=$S($D(^VA(200,DUZ,0)):$P(^(0),U,1),1:"") D DES^XMA21
 S XMSUB="AMIS 290 report for " S Y=BDATE1 X ^DD("DD") S XMSUB=XMSUB_Y S Y=EDATE1 X ^DD("DD") S XMSUB=XMSUB_" to "_Y,XMTEXT="^TMP($J,"
 Q
 ;
SEND I IOST'?1"P-",'$D(ZTQUEUED) W !!,"Loading AMIS 290 bulletin ..." H 1
 D ^XMD K XMY,XMTEXT,XMSUB K ^TMP($J),^TMP("DVBC",$J)
 I '$D(ZTQUEUED) W !!,*7,">> Mail message transmitted <<",!! H 2
 Q
 ;
HDR S PG=PG+1 W:(IOST?1"C-".E) @IOF
 W "AMIS 290 Report for "_$$SITE^DVBCUTL4,?(IOM-9),"Page: ",PG,!
 W "For date range: " S Y=BDATE1 X ^DD("DD") W Y W " to " S Y=EDATE1 X ^DD("DD") W Y,!
 F LINE=1:1:80 W "-"
 W !!
 Q
 ;
PAUSE K OUT S ANS="" I IOST?1"C-".E W *7,!!,"Press RETURN to continue or ""^"" to exit  " R ANS:DTIME I '$T!(ANS[U) S OUT=1
 Q

DVBCAMIS
DVBCAMIS ;ALB/GTS-557/THM-2507 AMIS REPORT ;21 MAY 89@0822 ; 5/23/91  1:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
SETUP S UPDATE="N",PREVMO=$P(^DVB(396.1,1,0),U,11),HD="AMIS 290 REPORT" I '$D(DT) S X="T" D ^%DT S DT=Y
 S DVBCDT(0)=$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
 D HOME^%ZIS S FF=IOF
 F JI="3DAYSCH","30DAYEX","PENDADJ","TRANSIN","TRNRETTO","TRNPNDTO","TRANSOUT","TRNRETFR","TRNPNDFR","INSUFF" S TOT(JI)=0
 F JI="RECEIVED","INCOMPLETE","DAYS","COMPLETED" S TOT(JI)=0
 F JI="P90","P121","P151","P181","P365","P366" S TOT(JI)=0
 ;
EN W @IOF,!?(IOM-$L(HD)\2),HD,!!!
 S %DT(0)=-DT,%DT="AE",%DT("A")="Enter STARTING DATE: " D ^%DT G:Y<0 EXIT S BDATE1=Y,BDATE=Y-.1
 S %DT="AE",%DT("A")="    and ENDING DATE: " D ^%DT G:Y<0 EN S EDATE1=Y,EDATE=Y+.5
 I EDATE1<BDATE1 W *7,!!,"Invalid date sequence - ending date is before starting date.",!! H 3 G EN
ASK0 W !!,"Please enter the total pending from the previous month: " R PREVMO:DTIME G:'$T!(PREVMO[U) EXIT I PREVMO["?" W !!,"Enter the totals for the month previous to the one you are processing." G ASK0
 I PREVMO'?1.4N!(PREVMO<0) W *7,!!,"Must be a number from 0 to 9999." G ASK0
 ;
ASK K %DT S SBULL="Y"
 W !!!,"Do you want to send a bulletin when processing is done"
 S %=1 D YN^DICN G:$D(DTOUT)!(%<0) EXIT
 I %=0 W !!,"Enter Y to send a bulletin to selected recipients or N not to send it at all.",!! G ASK
 I %'=1 S SBULL="N"
 I SBULL="Y" D BULL^DVBCAMI3
 W ! S %ZIS="AEQ",%ZIS("A")="Output device: " D ^%ZIS G:POP EXIT
 I $D(IO("Q")) S ZTRTN="GO^DVBCAMI2",ZTDESC="2507 Amis Report",ZTIO=ION F I="PREVMO","RO*","BDATE*","TOT*","EDATE*","SBULL","DUZ","DVBCDT(0)","XM*" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued",!! H 1 K ZTSK G EXIT
 G GO^DVBCAMI2
 ;
EXIT K PREVMO,UPDATE G KILL^DVBCUTIL

DVBCAMR1
DVBCAMR1 ;ALB/GTS-557/THM-REGIONAL OFFICE AMIS REPORT BULLETIN TEXT ; 9/28/91  6:39 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
BULLTXT S ^TMP($J,1,0)="For regional office: "_RONAME_" ("_RONUM_")"
 S ^TMP($J,2,0)=" "
 S ^TMP($J,3,0)="Requests sent for date range: "_TOT("SENT")
 S ^TMP($J,4,0)="Exams received incomplete: "_TOT("INCOMPLETE")
 S ^TMP($J,5,0)="Exams received complete: "_TOT("COMPLETED")
 S ^TMP($J,5.3,0)="Exams returned as insufficient: "_TOT("INSUFF")_"  ("_$S(TOT("SENT")>0:$J(TOT("INSUFF")/TOT("SENT")*100,0,0),1:0)_"%)"
 S ^TMP($J,6,0)="Pending for office "_RONUM_" at end of month: "_TOT("PENDADJ")
 S ^TMP($J,7,0)="Average processing time: "_TOT("AVGDAYS")_$S(TOT("AVGDAYS")>1!(TOT("AVGDAYS")<1):" days",1:" day")
 S ^TMP($J,8,0)=" "
 S ^TMP($J,9,0)="Greater than 5 days to schedule: "_TOT("3DAYSCH")
 S ^TMP($J,10,0)="Greater than 45 days to examine: "_TOT("30DAYEX")
 S ^TMP($J,11,0)=" "
 S ^TMP($J,12,0)="Pending, 0-90 days: "_TOT("P90")
 S ^TMP($J,13,0)="Pending, 91-120 days: "_TOT("P121")
 S ^TMP($J,14,0)="Pending, 121-150 days: "_TOT("P151")
 S ^TMP($J,15,0)="Pending, 151-180 days: "_TOT("P181")
 S ^TMP($J,16,0)="Pending, 181-365 days: "_TOT("P365")
 S ^TMP($J,17,0)="Pending, 366 or more days: "_TOT("P366")
 Q

DVBCAMR2
DVBCAMR2 ;ALB/GTS-557/THM-REGIONAL OFFICE AMIS 290 REPORT, CALCULATIONS ; 9/28/91  6:43 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - GTS/Coded to adjust 35 day clock calc  (Enhc 13)
 ;
DAY30 K ^TMP("DVBC",$J)
 F FA=DTRPT-.1:0 S FA=$O(^DPT(PNAM,"S",FA)) Q:FA=""!(FA>EDATE)  I $D(^(FA,0)) S L=^(0),C=+L S YY=$P(L,U,2) I YY'="N"&(YY'="C")&(YY'="NA")&(YY'="CA")&(YY'="PC")&(YY'="PCA") I FA'>EDATE S ^TMP("DVBC",$J,9999999-FA,FA)=""
 Q:'$D(^TMP("DVBC",$J))  S FB=$O(^TMP("DVBC",$J,0)),FA=$O(^TMP("DVBC",$J,FB,0)) I FA]"" S X2=FA,X1=$S(DTSCHEDC]"":DTSCHEDC,1:DVBCNOW) D ^%DTC I X>30 S TOT("30DAYEX")=TOT("30DAYEX")+1
 Q
 ;
PENDCNT I X'<0&(X'>90) S TOT("P90")=TOT("P90")+1
 I X>90&(X'>120) S TOT("P121")=TOT("P121")+1
 I X>120&(X'>150) S TOT("P151")=TOT("P151")+1
 I X>150&(X'>180) S TOT("P181")=TOT("P181")+1
 I X>180&(X'>365) S TOT("P365")=TOT("P365")+1
 I X>365 S TOT("P366")=TOT("P366")+1
 Q
 ;
SET S DTA=^DVB(396.3,REQDA,0),DTREQ=$P(DTA,U,2),XRONUM=$P(DTA,U,3),XRONUM=$S($D(^DIC(4,+XRONUM,99)):$P(^(99),U,1),1:0) Q:XRONUM'=RONUM&(RONUM'="ALL")
 K XRONUM S DTRPT=$P(DTA,U,5),DTSCHEDC=$P(DTA,U,6),DTRQCMP=$P(DTA,U,7),DTTRANS=$P(DTA,U,12),DTREL=$P(DTA,U,14),RQSTAT=$P(DTA,U,18),DTCAN=$P(DTA,U,19),PRIO=$P(DTA,U,10) K DTA
 I DTRPT="",DTCAN]"" S DTRPT=DTCAN
 Q:DTRPT=""  ;requests never printed
 I DTREL'<BDATE,DTREL'>EDATE D DAY30
 I DTRPT'<BDATE,DTRPT'>EDATE S TOT("SENT")=TOT("SENT")+1
 I DTRPT'<BDATE,DTRPT'>EDATE,RQSTAT'["X" S X1=$S(DTSCHEDC]"":DTSCHEDC,1:DVBCNOW),X2=DTRPT D ^%DTC I X>3 S TOT("3DAYSCH")=TOT("3DAYSCH")+1
 I DTREL'<BDATE&(DTREL'>EDATE),RQSTAT="C"!(RQSTAT="R") S:PRIO'="E" DVBCPCTM=$$PROCDAY^DVBCUTL2(REQDA) S:PRIO="E" DVBCPCTM=$$INSFTME^DVBCUTA1(REQDA) S TOT("DAYS")=TOT("DAYS")+DVBCPCTM K DVBCPCTM
 I DTRPT'>EDATE,"^P^S^T"[RQSTAT S TOT("PENDADJ")=TOT("PENDADJ")+1,X1=EDATE,X2=DTRPT D ^%DTC,PENDCNT
 I DTRPT'>EDATE,"^C^CT^R^RX^X^"[RQSTAT,(+DTREL>EDATE)!(+DTCAN>EDATE) S TOT("PENDADJ")=TOT("PENDADJ")+1,X1=EDATE,X2=DTRPT D ^%DTC,PENDCNT
 I DTREL'<BDATE&(DTREL'>EDATE),RQSTAT["C"!(RQSTAT="R") S TOT("COMPLETED")=TOT("COMPLETED")+1
 I DTRPT'<BDATE,DTRPT'>EDATE,PRIO="E" S TOT("INSUFF")=TOT("INSUFF")+1
 I DTCAN'<BDATE&(DTCAN'>EDATE),RQSTAT="X"!(RQSTAT="RX") S TOT("INCOMPLETE")=TOT("INCOMPLETE")+1
 K DTRPT Q
 ;
GO S %DT="TS",X="NOW" D ^%DT S DVBCNOW=Y K ^TMP($J)
 S PNAM="" F JJ=0:0 S PNAM=$O(^DVB(396.3,"B",PNAM)) Q:PNAM=""  F REQDA=0:0 S REQDA=$O(^DVB(396.3,"B",PNAM,REQDA)) Q:REQDA=""  D SET
 S TOT("AVGDAYS")=0 I TOT("COMPLETED")>0 S TOT("AVGDAYS")=TOT("DAYS")/TOT("COMPLETED"),TOT("AVGDAYS")=$J(TOT("AVGDAYS"),5,1)
 D BULLTXT^DVBCAMR1
 U IO D HDR F JI=0:0 S JI=$O(^TMP($J,JI)) Q:JI=""  W ^(JI,0),!
 I IOST?1"C-".E W *7,!,"Press RETURN to continue   " R ANS:DTIME I '$T!(ANS=U) W:SBULL="Y" !!,*7,"Bulletin will NOT be sent!!",*7,! H 2 G EXIT
 D ^%ZISC
 S:'$D(XMY) SBULL="N" I SBULL="Y" D SEND
 ;
EXIT D:$D(ZTQUEUED) KILL^%ZTLOAD K PREVMO,UPDATE G KILL^DVBCUTIL
 ;
BULL W ! S XMDUZ=DUZ,XMMG=$S($D(^VA(200,DUZ,0)):$P(^(0),U,1),1:"") D DES^XMA21
 S XMSUB="RO AMIS 290 Report -  " S Y=BDATE1 X ^DD("DD") S XMSUB=XMSUB_Y S Y=EDATE1 X ^DD("DD") S XMSUB=XMSUB_" to "_Y,XMTEXT="^TMP($J,"
 Q
 ;
SEND D ^XMD K XMY,XMTEXT,XMSUB K ^TMP($J)
 I '$D(ZTSK) W !!,*7,">>> Mail message transmitted. <<<",!! H 2
 Q
 ;
HDR W @IOF,"Regional Office AMIS 290 Report for C&P Examinations",?(IOM-9),"Page: 1",!
 W "For date range: " S Y=BDATE1 X ^DD("DD") W Y W " to " S Y=EDATE1 X ^DD("DD") W Y,!
 F LINE=1:1:80 W "-"
 W !!
 Q

DVBCAMRO
DVBCAMRO ;ALB ISC/THM-REGIONAL OFFICE 2507 AMIS REPORT ; 9/28/91  6:39 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SETUP S UPDATE="N",PREVMO=$P(^DVB(396.1,1,0),U,11),HD="REGIONAL OFFICE 2507 AMIS REPORT" I '$D(DT) S X="T" D ^%DT S DT=Y
 S DVBCDT(0)=$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
 D HOME^%ZIS S FF=IOF
 F JI="3DAYSCH","30DAYEX","PENDADJ" S TOT(JI)=0
 F JI="INSUFF","SENT","INCOMPLETE","DAYS","COMPLETED" S TOT(JI)=0
 F JI="P90","P121","P151","P181","P365","P366" S TOT(JI)=0
 ;
EN W @IOF,!?(IOM-$L(HD)\2),HD,!!!
 S %DT(0)=-DT,%DT="AE",%DT("A")="Enter STARTING DATE: " D ^%DT G:Y<0 EXIT S BDATE1=Y,BDATE=Y-.1
 S %DT="AE",%DT("A")="    and ENDING DATE: " D ^%DT G:Y<0 EN S EDATE1=Y,EDATE=Y+.5
 I EDATE1<BDATE1 W *7,!!,"Invalid date sequence - ending date is before starting date.",!! H 3 G EN
 W !!,"When selecting regional offices you may enter individual",!,"station name or station number.",!!
 S DIC("A")="Select REGIONAL OFFICE NUMBER: ",DIC(0)="AEQM",DIC="^DIC(4," D ^DIC G:X=""!(X=U) EXIT I +Y>0 S DA=+Y,RONUM=$S($D(^DIC(4,DA,99)):$P(^(99),U,1),1:"000"),RONAME=$P(Y,U,2)
 I +Y<0 G EXIT
 ;
ASK K %DT S SBULL="Y" W !!!,"Want to send a bulletin when processing is done" S %=1 D YN^DICN G:$D(DTOUT)!(%<0) EXIT
 I $D(%Y) I %Y["?" W !!,"Enter Y to send the bulletin to selected recipients or N not to send it at all.",!! G ASK
 I %'=1 S SBULL="N"
 I SBULL="Y" D BULL^DVBCAMR2
 W ! S %ZIS="AEQ",%ZIS("B")="0;P-OTHER",%ZIS("A")="Output device: " D ^%ZIS G:POP EXIT
 I $D(IO("Q")) S ZTRTN="GO^DVBCAMR2",ZTDESC="2507 Amis Report",ZTIO=ION F I="UPDATE","RO*","PREVMO","BDATE*","TOT*","EDATE*","SBULL","DUZ","DVBCDT(0)","XM*" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued",!! H 1 K ZTSK G EXIT
 G GO^DVBCAMR2
 ;
EXIT K PREVMO,UPDATE G KILL^DVBCUTIL

DVBCAOC1
DVBCAOC1 ;ALB ISC/THM-AGENT ORANGE/RESIDUALS OF DIOXIN, CONT. ; 5/21/91  10:05 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN W ?2,"b. Describe the following:",!!?6,"1.  General appearance and mental status -",!!!?6,"2.  Head and neck -",!!!?6,"3.  Eyes -",!!!?6,"4.  Ears -",!!!?6,"5.  Nose -",!!!?6,"6.  Mouth -",!!!?6,"7.  Throat -",!!!?6,"8.  Teeth -",!!!
 W ?6,"9.  Chest -",!!!?5,"10.  Lungs -",! D HD2^DVBCAOCK W ?5,"11.  Cardiovascular -",!!!?5,"12.  Abdomen -",!!!?5,"13.  Hernia -",!!!?5,"14.  Genitalia -",!!!?5,"15.  Rectum -",!!!?5,"16.  Prostate -",!!!?5,"17.  Back -",!!!
 W ?5,"18.  Extremeties -",!!!?5,"19.  Neurological -",!!!?5,"20.  Skin -",!!!?5,"21.  Lymphatics -",!!!!,"H.  Indicate whether or not there is evidence of neoplasia in",!?4,"the veteran:",!!!
 W "I.  Indicate whether or not there is evidence of neoplasia in",!?4,"the veteran's family and specify the family member and type",!?4,"of neoplasia, if known:",! D HD2^DVBCAOCK
 W "J.  Indicate if there is evidence of infertility, spontaneous",!?4,"abortions or teratogenesis in the veteran or the veteran's spouse",!?4,"or immediate family (and describe, if present):",!!!!!
 W "K.  Indicate if the veteran's spouse or children were in Vietnam",!?4,"(and if so, give details):",!!!!!,"L.  Diagnostic/clinical test results (indicate the results of",!?4,"the following, if performed):",!!
 W ?6,"a.  Complete blood count, including differential -",!!!?6,"b.  Chest X-Ray (if no chest X-Ray within six months) -",!!!?6,"c.  Liver function profile -",!!!?6,"d.  Renal function profile -",!!!?6,"e.  Sperm count -",!!!
 W ?6,"f.  Referral to a dermatologist -",! D HD2^DVBCAOCK W "M.  Diagnosis:",!!!!!!!!!!,"N.  The veteran has been informed of the results of this examination,",!?4,"including X-Ray, blood chemistry, urinalysis, and CBC tests and the",!
 W ?4,"following abnormalities were discussed (if none, write",!?4,"'NONE'):",!! S $P(XLN,"_",75)="_" W XLN,!!,XLN,!!,"Signature of veteran: ",$E(XLN,1,35)," Date: ",$E(XLN,1,11),!
 W !,"Examiner's signature: ",$E(XLN,1,35)," Date: ",$E(XLN,1,11),!!!
 W ?9,"Reviewed by: ",$E(XLN,1,35)," Date: ",$E(XLN,1,11),!?9,"Environmental Health Physician",! K XLN,LN,LN1,LN2,LNS
 Q

DVBCAOCK
DVBCAOCK ;ALB/GTS-557/THM-AGENT ORANGE/RESIDUALS OF DIOXIN ; 5/21/91  9:56 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9="Full Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1710 Worksheet" S HD7="RESIDUALS OF DIOXIN EXPOSURE (AGENT ORANGE)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:  "
 S LNS="__________",LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["$END"  W ?13,$P(LY,";;",2),!
 W !!,"A.  Initial data base for possible exposure to toxic chemicals:",!!,"Branch of service: ",LNS,?33,"Service serial number: ",LNS,!!
 S X="month/year",Y="from __________ to __________" W "Dates of service:",!?26,X,?40,X,!!,"Last period: ",?21,Y,!!?26,X,?40,X,!!,"Next to last period: ",Y,!!
 W "Date of birth: __________",!!,"Marital status: ___ married ___ divorced ___ separated",!!!
 W "Did veteran have military service in Vietnam? ___ Yes  ___ No",!!,"If yes, list all tours of duty in Vietnam:",!!?7,X,?35,X,!,"From:",?30,"To:",! D HD2
 W "Indicate the Corps or area where veteran served in Vietnam:",!!,"I Corps ___ II Corps ___ III Corps ___ IV Corps ___ Sea duty ___",!!,"More than one ___ Don't know ___ Other (specify)",LNS,!!
 W "List military units in which veteran served (specify complete",!,"unabbreviated titles such as company, battalion, etc.):",!!!!!
 W "B.  Veteran's exposure to Agent Orange (indicate one category for",!?5,"each circumstance):",!!?36,"Definitely  Probably  Not    Definitely",!?39,"yes",?50,"yes",?58,"sure",?69,"no",!!
 W ?3,"1. Veteran was involved in",!?3,"handling or spraying A.O.",!!?3,"2. Veteran was not directly",!?3,"sprayed but was in a recently",!?3,"sprayed area.",!!
 W ?3,"3. Veteran was exposed to",!?3,"herbicides other than A.O.",!!?3,"4. Veteran was directly",!?3,"sprayed with Agent Orange.",!!?3,"5. Veteran ate food or drink",!?3,"that could have been contaminated.",!!!
 W !!,"C.  Indicate how many exposures the veteran alleges:",!!!,"D.  Indicate the nature of each exposure:",! D HD2
 W "E.  Medical history (include symptoms at time of exposure or",!?4,"later attributed by veteran to exposure):",!!!!!!!,"F.  Subjective complaints:",!!!!!!!,"G.  Objective findings:",!!
 W ?2,"a. Height _____ weight _____ pulse _____ blood pressure _______",!! G ^DVBCAOC1
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;Chloracne or other acneform disease consistant with
 ;;chloracne, non-Hodgkins lymphoma, and soft-tissue
 ;;sarcomas are presumtive Agent Orange-related
 ;;disabilities.  Veterans who served in Vietnam and
 ;;in the waters offshore are presumed to have been
 ;;exposed to Agent Orange and/or other herbicides
 ;;which may contain dioxin.  Attention should be paid
 ;;to examination of the skin, nervous system, muscular
 ;;function, liver, kidneys, lymphatic system and mental
 ;;status.  Questioning should attempt to uncover details
 ;;of exposure and any adverse affects.
 ;;$END

DVBCARC1
DVBCARC1 ;ALB ISC/THM-TEXT FOR A&A/HOUSEBOUND EXAM ; 5/17/91  9:16 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
PTXT F AW=0:1 S AX=$T(@TXT+AW) S AY=$P(AX,";;",2) D:AY["|TOP|" HD2^DVBCARCK W:AY="END" !! Q:AY="END"  I AY'["|TOP|" W AY,!
 G:TXT="TXT3" ^DVBCARC2 Q
 ;
TXT2 ;;A.  Indicate whether or not the veteran REQUIRES an attendant in reporting
 ;;    for this exam, and if so, identify the nurse or attendant and the
 ;;    mode of travel employed:
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B.  Indicate whether or not the veteran is hospitalized, and if so, state
 ;;    where and the date of admission:
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C.  Indicate whether or not the veteran is blind (best corrected vision
 ;;    is 5/200 or worse in both eyes, or central vision field is five degrees
 ;;    or less) or is permanently bedridden (if either skip items "D" through
 ;;    "I" and go directly to "J"):
 ;;END
TXT3 ;;
 ;;
 ;;
 ;;F.  Extremeties and spine:
 ;;
 ;;    1.  Upper extremities (reporting each upper extremity separately) -
 ;;
 ;;        a.  Describe functional restrictions with reference to strength
 ;;and coordination and ability for self-feeding, fastening clothing, bathing,
 ;;shaving, and attending to the needs of nature -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;        b.  Indicate level of amputation or length of stump and state
 ;;whether or not use of prothesis is feasible -
 ;;|TOP|
 ;;
 ;;
 ;;    2.  Lower extremities (reporting each lower extremity separately) -
 ;;
 ;;        a.  Describe functional restrictions with reference to extent
 ;;of limitation of motion, muscle atrophy, contractures, weakness, lack
 ;;of coordination, or other interference -
 ;;
 ;;
 ;;
 ;;        b.  Indicate any deficits of weight bearing, balance and propulsion -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;        c.  If amputated, give level or length of stump and whether use
 ;;of prosthesis is feasible -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3.  Spine, trunk, and neck -
 ;;
 ;;        a.  Describe any limitation of motion or deformity of lumbar,
 ;;thoracic, and cervical spine -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;        b.  Note if deformity of thoracic spine interferes with breathing -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;G.  Capacity to protect oneself from the hazards/dangers of daily environment:
 ;;
 ;;    1.  Describe briefly any pathological processes involving other body
 ;;parts and systems, including the effects of advancing age, such as dizziness,
 ;;loss of memory, poor balance affecting ability to ambulate, perform self-
 ;;care, or travel beyond the premises of the home or the ward or clinical
 ;;area if hospitalized -
 ;;|TOP|
 ;;    2.  Describe where the veteran goes and what he/she does during a
 ;;typical day -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;END
 ;
TXT10 ;;Once the existence of at least one permanent disability
 ;;            rated as being 100% disabling has been established, additional
 ;;            benefits are payable if the veteran is so helpless as to require
 ;;            the regular aid and attendance of another person in attending to
 ;;            the ordinary activities of daily living, or in protecting
 ;;            himself/herself from the ordinary hazards of his/her daily
 ;;            environment, or is restricted to his/her home or the immediate
 ;;            vicinity thereof, including the ward or immediate clinical area,
 ;;            if hospitalized.
 ;;
 ;;            If a general medical examination is included as a part of this
 ;;            request specific findings as to the individual body systems and
 ;;            extremeties already noted in that examination need not be repeated.
 ;;            Items "G" through "L", as the examiner deems appropriate, must be
 ;;            completed in all cases unless the veteran is blind or permanently
 ;;            bedridden (see item "C").
 ;;
 ;;END

DVBCARC2
DVBCARC2 ;ALB ISC/THM-TEXT, CONTINUED FOR A&A/HOUSEBOUND EXAM ; 1/3/91  8:24 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 F AW=0:1 S AX=$T(@TXT+AW) S AY=$P(AX,";;",2) D:AY["|TOP|" HD2^DVBCARCK W:AY="END" !! Q:AY="END"  I AY'["|TOP|" W AY,!
 Q
 ;
TXT3 ;;H.  Ambulation:
 ;;
 ;;    1.  Indicate whether the veteran is able to walk without the assistance
 ;;of another person and give the maximum distance -
 ;;
 ;;
 ;;
 ;;    2.  Indicate any mechanical aid used or recommended by the examiner
 ;;for ambulation -
 ;;
 ;;
 ;;
 ;;    3.  Indicate the frequency, and under what circumstances, the veteran
 ;;is able to leave the home or immediate premises -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;I.  Except as to amputations and other anatomical losses, indicate if any
 ;;restrictions noted in "F" through "H" are expected to be permanent:
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;J.  State whether the veteran is capable of managing benefit payments in
 ;;his/her own best interests without restriction (a physical disability
 ;;which prevents the veteran from attending to financial matters in person
 ;;is not a proper basis for a finding of incompetency unless the individual
 ;;is, by reason of that disability, incapable of directing someone else
 ;;in handling financial affairs):
 ;;END

DVBCARCK
DVBCARCK ;ALB/GTS-557/THM-REGULAR A&A/HOUSEBOUND EXAM ; 1/3/91  8:25 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K LINE S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet",$P(LINE,"-",75)="-"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1715 Worksheet" S HD7="REGULAR AID AND ATTENDANCE/HOUSEBOUND STATUS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________"
 W !!,"Type of Exam: ",HD7,!!!!,"Narrative:  "
 S TXT="TXT10" D PTXT S TXT="TXT2" D PTXT W !!!
 D HD2 W "D. Present complaints (symptoms only, NOT diagnosis):",!!!!!!!!!!!!,"E. Examination data:",!!!!,"Height:",?25,"Weight:",?45,"Max wgt past year:",!!!
 W "Build and state of nutrition:",!!!,"Posture:",?23,"Gait:",!!!,"General appearance:",!!!
 W "Pulse:",?20,"Blood pressure:",?51,"Respiration:",!
 S TXT="TXT3" D PTXT,HD2 W !!!,"K. Diagnosis:",!!!!!!!!!!!
 W "L. Additional remarks as examiner deems necessary in individual case:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2,LINE
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam "_HD8,!,"for ",NAME,!!!
 Q
 ;
PTXT D PTXT^DVBCARC1
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCATC1
DVBCATC1 ;ALB ISC/THM-TEXT FOR A&A/HOUSEBOUND EXAM ; 5/17/91  9:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
PTXT F AW=0:1 S AX=$T(@TXT+AW) S AY=$P(AX,";;",2) D:AY["|TOP|" HD2^DVBCARCK W:AY="END" !! Q:AY="END"  I AY'["|TOP|" W AY,!
 Q
 ;
TXT10 ;;A veteran who is in receipt of the highest level of basic
 ;;            special monthly compensation for multiple service-connected
 ;;            disabilitites causing need for regular aid and attendance may
 ;;            be entitled to a higher rate if, because of the service-connected
 ;;            conditions, the veteran requires the daily health-care services
 ;;            of a skilled provider, without which he/she would require hospital,
 ;;            nursing home, or other institutional care.  These services may be
 ;;            provided by a family member or other individual under the
 ;;            supervision of a physician or other health-care professional.
 ;;
 ;;            Personal health-care services include, but are not limited to,
 ;;            physical therapy, administration of injections, placement of
 ;;            indwelling catheters, and the changing of sterile dressings, or
 ;;            like functions which require professional health-care training
 ;;            or the regular supervision of a trained health-care professional
 ;;            to perform.  A licensed health-care professional includes, but
 ;;            is not limited to, a doctor of medicine or osteopathy, a
 ;;            registered nurse, a licensed practical nurse, or a licensed
 ;;            physical therapist.  Only a VA physician may certify the need
 ;;            for higher level of care.
 ;;
 ;;            Special note:  Veterans with potential entitlement to higher
 ;;            level of aid and attendance are commonly unable to travel except
 ;;            by ambulance.  Before calling a veteran in for examination, a
 ;;            physician should review treatment records, if available, and
 ;;            determine whether need can be determined by record review and
 ;;            telephone contact with the veteran and/or the skilled provider.
 ;;
 ;;
 ;;A.  Indicate if the veteran requires the daily health-care services of a
 ;;skilled provider, without which the veteran would require hospital, nursing
 ;;home, or other institutional care, specifying the services required (if
 ;;the veteran does not require daily health-care services of a skilled
 ;;provider, state "daily services not required" and go to the end of the
 ;;exam):
 ;;|TOP|
 ;;B.  Indicate if the veteran is actually receiving the required daily
 ;;skilled services and if they are being provided by a licensed health-care
 ;;professional:
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    1.  If not by a health-care professional, indicate who is providing
 ;;the daily skilled services and idendify the health-care professional under
 ;;whose supervision the services are being provided -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2.  Note how often and under what conditions the non-professional
 ;;provider is supervised by a health-care professional (Example:  weekly
 ;;visit by home health-care nurse, monthly visit and weekly telephone
 ;;contact by family physician) -
 ;;END

DVBCATCK
DVBCATCK ;ALB/GTS-557/THM-HIGHER LEVEL A&A EXAM ; 1/3/91  9:37 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K LINE S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
 S $P(LINE,"-",75)="-"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1720 Worksheet" S HD7="HIGHER LEVEL AID & ATTENDANCE",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________"
 W !!,"Type of Exam: ",HD7,!!!!,"Narrative:  "
 S TXT="TXT10" D PTXT W !!!!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2,LINE
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam "_HD8,!,"for ",NAME,!!!
 Q
 ;
PTXT D PTXT^DVBCATC1
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCBNCK
DVBCBNCK ;ALB/GTS-557/THM-BONE EXAM ; 12/10/90  1:35 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1410 Worksheet" S HD7="BONES (FRACTURES/BONE DISEASE)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,! I '$D(CMBN) W "Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam:",HD7
 W !!!!,"Narrative:",?13,"Evaluate the effect of functional impairment on gait, posture",!?13,"and specific functions of adjacent joints, muscles and nerves.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!?8,"1. Swelling -",!!!!!?8,"2. Deformity -",!!!!!
 W ?12,"a. Angulation -",!!!!!?12,"b. False motion -",!!!!!?12,"c. Shortening -",!!!!!!!!?8,"3. Intra-articular involvement",!!!!!!!! D:$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:'$D(CMBN) HD2 W !!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCBRCK
DVBCBRCK ;ALB/GTS-557/THM-TRACHEA AND BRONCHI ; 6/27/91  7:33 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1525 Worksheet" S HD7="TRACHEA AND BRONCHI",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Identify the disease present, describe clinical findings",!?13,"and provide current chest X-Ray results if no recent",!?13,"studies are available.  Report pulmonary function studies"
 W !?13,"unless medically contraindicated.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Presence of cor pulmonale -",!!!!!
 W ?8,"2. If veteran is asthmatic, report frequency of attacks",!?11,"and baseline functional status between attacks -",!!!!!!
 W ?8,"3. Report any indications of cyanosis/clubbing of extremities -",!!!!!!?8,"4. Productive cough/sputum -",!!!!!!?8,"5. Dyspnea on exertion/slight exertion/at rest -",!!!!!
 W ?8,"6. Indicate whether infectious disease is present -",!!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clincal test results:",!!!!!!!!!! D:'$D(CMBN) HD2
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCBUL1
DVBCBUL1 ;ALB/GTS-557/THM-SEND EXAM ADD MESSAGE ; 2/7/91  6:56 AM
 ;;2.7;AMIE;;Apr 10, 1995
 K ^TMP("DVBC","BUL1",$J),^TMP("DVBC","CMNT",$J) S DIC="^TMP(""DVBC"",""CMNT"",$J,99,",DWPK=1 W @IOF,!!,"Comments:",!! D EN^DIWE
 K DWPK I $O(^TMP("DVBC","CMNT",$J,99,0))]"" S ^TMP("DVBC","BUL1",$J,98,0)=" ",^TMP("DVBC","BUL1",$J,97,0)="==========================<  Additional comments  >=========================="
 F I=0:0 S I=$O(^TMP("DVBC","CMNT",$J,99,I)) Q:I=""  S ^TMP("DVBC","BUL1",$J,(I+99),0)=^TMP("DVBC","CMNT",$J,99,I,0)
 K ^TMP("DVBC","CMNT",$J) S $P(DOTS,".",45)="."
 ;
GO S L=1,^TMP("DVBC","BUL1",$J,L,0)="The following veteran had one or more 2507 exams added:",L=L+1
 S ^TMP("DVBC","BUL1",$J,L,0)="   ",L=L+1
 S ^TMP("DVBC","BUL1",$J,L,0)="   Name: "_PNAM_"   SSN: "_SSN_"   "_"C-Number: "_CNUM,L=L+1
 S ^TMP("DVBC","BUL1",$J,L,0)=" "
 S Y=$P(^DVB(396.3,REQDA,0),U,2) X ^DD("DD") S ^TMP("DVBC","BUL1",$J,L,0)="     Request date: "_Y,L=L+1
 S ^TMP("DVBC","BUL1",$J,L,0)="  ",L=L+1
 S ^TMP("DVBC","BUL1",$J,L,0)="Note:  Scheduling for this request must now be recompleted.",L=L+1,^TMP("DVBC","BUL1",$J,L,0)="       A new request copy will be printed tomorrow morning.",L=L+1
 S ^TMP("DVBC","BUL1",$J,L,0)=" ",L=L+1
 ;
SEND S $P(^DVB(396.3,REQDA,0),U,6)="" ;reset date sched completed
 S MG=$O(^XMB(3.8,"B","DVBA C EXAM ADDED",0)) I MG="" W !!,*7,"Bulletin not sent.",!,"DVBA C EXAM ADDED mail group not found.",!! H 3 Q
 F JI=0:0 S JI=$O(^XMB(3.8,MG,1,"B",JI)) Q:JI=""  S XMY(JI)=""
 S XMY(DUZ)="",XMSUB="Addition of 2507 Exams",XMTEXT="^TMP(""DVBC"",""BUL1"",$J,",XMDUZ=DUZ D ^XMD K ^TMP("DVBC","BUL1",$J),XMDUZ,DOTS,L,JI,JY,XMY,XMSUB,XMTEXT
 Q

DVBCBULL
DVBCBULL ;ALB/GTS-557/THM-SEND CANCELLATION BULLETIN ; 6/25/91  11:01 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K ^TMP("DVBC","BULL",$J),^TMP("DVBC","CMNT",$J) S DIC="^TMP(""DVBC"",""CMNT"",$J,99,",DWPK=1 W @IOF,!!,"Cancellation comments:",!! D EN^DIWE
 K DWPK I $O(^TMP("DVBC","CMNT",$J,99,0))]"" S ^TMP("DVBC","BULL",$J,98,0)=" ",^TMP("DVBC","BULL",$J,97,0)="==========================<  Additional comments  >=========================="
 F I=0:0 S I=$O(^TMP("DVBC","CMNT",$J,99,I)) Q:I=""  S ^TMP("DVBC","BULL",$J,(I+99),0)=^TMP("DVBC","CMNT",$J,99,I,0)
 K ^TMP("DVBC","CMNT",$J) S $P(DOTS,".",45)="." W !!,"A bulletin will now be sent to the 2507 Cancellation mail group.",!
 ;
GO S L=1,^TMP("DVBC","BULL",$J,L,0)="The following veteran had one or more 2507 exams cancelled:",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="   ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="   Name: "_PNAM_"   SSN: "_SSN_"   "_"C-Number: "_CNUM,L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="Exams cancelled                               Reason",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  ",L=L+1
 S EXAM="",RSTAT=$P(^DVB(396.3,REQDA,0),U,18)
 F JI=0:0 S EXAM=$O(CANC(EXAM)) Q:EXAM=""  I $P(CANC(EXAM),U,1)="X"!($P(CANC(EXAM),U,1)="RX") S REAS=+$P(CANC(EXAM),U,2) D EXAMS
 S ^TMP("DVBC","BULL",$J,L,0)=" ",L=L+1,COMP=1,CMPC=0
 S ^TMP("DVBC","BULL",$J,L,0)=" ",L=L+1 K ^TMP("DVBC","CMNT",$J)
 I RSTAT["X" S ^TMP("DVBC","BULL",$J,L,0)=" *** All exams on this request are now CANCELLED. ***",L=L+1,^TMP("DVBC","BULL",$J,L,0)=" ",L=L+1 G SEND
 S ECNT=0
 F JZ=0:0 S JZ=$O(^DVB(396.4,"C",REQDA,JZ)) Q:JZ=""  S STAT=$P(^DVB(396.4,JZ,0),U,4) S:STAT="C" CMPC=1 I STAT'="C"&(STAT'["X") S COMP=0,ECNT=ECNT+1
 ;CMPC=completed exam COMP=open exam
 ;both are toggled, depending on exam status.  Both must be 1 to put release banner on message
 I RSTAT'["X",COMP=0 S ^TMP("DVBC","BULL",$J,L,0)=" *** There "_$S(ECNT=1:"is",1:"are")_" still "_ECNT_" exam"_$S(ECNT=1:"",1:"s")_" open on this request. ***",L=L+1,^TMP("DVBC","BULL",$J,L,0)=" ",L=L+1 G SEND
 I COMP=1&(CMPC=1),RSTAT'["X" S ^TMP("DVBC","BULL",$J,L,0)=" *** This request is now COMPLETE and should be released by MAS ***",L=L+1
 I COMP=1&(CMPC=1),RSTAT'["X" S ^TMP("DVBC","BULL",$J,L,0)=" ",L=L+1 ;spacer
 ;
SEND ;remote sites get bulletins only on total cancellations
 S DIC="^XMB(3.8,",DIC(0)="QM",X="DVBA C 2507 CANCELLATION" D ^DIC S MG=+Y I +Y<0 W !!,*7,"2507 mail group NOT found!  Bulletin not sent.",!! H 3 Q
 F JI=0:0 S JI=$O(^XMB(3.8,MG,1,"B",JI)) Q:JI=""  S XMY(JI)=""
 F JI=0:0 S JI=$O(XMY(JI)) Q:JI=""!(+JI=0)  I '$D(^VA(200,JI,2,+REQRO))&'$D(^VA(200,JI,2,+REQRO))&('$D(^XUSEC("DVBA C SUPERVISOR",JI))) K XMY(JI)
 S:REQSTR="" REQSTR=.5 S XMY(REQSTR)="",XMY(DUZ)="",XMSUB="Cancellation of 2507 Exams",XMTEXT="^TMP(""DVBC"",""BULL"",$J,",XMDUZ=DUZ D ^XMD
 K ^TMP("DVBC","BULL",$J),XMDUZ,DOTS,COMP,CMPC,XEXAM,REASON,L,JI,JY,XMY,XMSUB,XMTEXT,XMDUZ,ECNT
 Q
 ;
EXAMS S REASON=$S($D(^DVB(396.5,+REAS,0)):$P(^(0),U,1),1:"Undetermined")
 S XEXAM=$E(EXAM,1,25),^TMP("DVBC","BULL",$J,L,0)="     "_XEXAM_" "_$E(DOTS,1,35-$L(XEXAM))_" "_REASON S L=L+1
 Q

DVBCCECK
DVBCCECK ;ALB/GTS-557/THM-CARDIOVASCULAR, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For CARDIOVASCULAR, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 0105 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: CARDIOVASCULAR, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized cardiovascular
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For CARDIOVASCULAR, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCCHKR
DVBCCHKR ;ALB/GTS-557/THM-CHECK C&P REQUEST FOR CRITICAL DATA ; 4/23/91  7:53 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ; 2.7 - GTS/C&P appt links report (Enhc 13)
 ;
 S DVBCMAN="" G EN
 ;
CHECK N OLDX
 S OLDX=X,DTA=^DVB(396.3,DA,0),DTB=$S($D(^DVB(396.3,DA,1)):^(1),1:"")
 Q:$P(DTA,U,18)["X"  F XI=2,3,4,10,18 I $P(^DVB(396.3,DA,0),U,XI)="" S X=X_XI_U
 I $P(DTB,U,4)="" S X=X_99_U
 I $O(^DVB(396.4,"C",DA,0))="" S X=X_98_U ;no exams selected
 S REQDA=DA,NAME=$P(^DPT(DFN,0),U,1) D:STYLEIND'="4" LINKCK
 I OLDX'=X DO
 .S:$E(X,$L(X))="^" X=$E(X,1,($L(X)-1))
 .S X=X_";"_DA_"~"
 I X]"" S ^TMP($J,NAME,DFN)=X
 Q
 ;
PRINT D HDR S NAME=""
 F XI=0:0 S NAME=$O(^TMP($J,NAME)) Q:NAME=""!($D(DVBCQUIT))  DO
 .S (DVBAPC,DVBADTA)=""
 .F DFN=0:0 S DFN=$O(^TMP($J,NAME,DFN)) Q:DFN=""!($D(DVBCQUIT))  DO
 ..I (IOST?1"C-".E),($Y>(IOSL-9)) D TERM^DVBCUTL3 S:$D(GETOUT) DVBCQUIT=""
 ..I '$D(DVBCQUIT) DO
 ...D:($Y>(IOSL-9)) HDR
 ...D NAMELN ;**Output name
 ...F DVBAPC=1:1 S DVBADTA=$P(^TMP($J,NAME,DFN),"~",DVBAPC) Q:DVBADTA=""  DO
 ....W !
 ....S DTA=$P(DVBADTA,";",1),REQDA=$P(DVBADTA,";",2) ;**DVBADTA=Prob pce
 ....F DVBCX=1:1 S DVBAY=$P(DTA,U,DVBCX) Q:DVBAY=""!($D(DVBCQUIT))  I DVBAY]"" D PRINT1
 .K DVBAPC,DVBADTA
 I '$D(DVBCQUIT)&(IOST?1"C-".E) D TERM^DVBCUTL3 S:$D(GETOUT) DVBCQUIT=""
 Q
 ;
PRINT1 I (IOST?1"C-".E),($Y>(IOSL-2)) D TERM^DVBCUTL3 S:$D(GETOUT) DVBCQUIT=""
 I '$D(DVBCQUIT) DO
 .I ($Y>(IOSL-2)) D HDR,NAMELN
 .W ?50,$S(DVBAY=2:"Request date",DVBAY=3:"Regional office number",DVBAY=4:"Requester",DVBAY=10:"Priority of exam",DVBAY=18:"Request status",DVBAY=99:"Routing location",1:"")
 .W:DVBAY=98 ?50,"** No exams selected **"
 .W:DVBAY=199 ?50,"** No C&P Appt's linked **"
 .W !
 Q
 ;
EN D HOME^%ZIS S FF=IOF
 W @FF,!!,"This report will check the 2507 REQUEST file for missing crucial data.",!!,"All requests will be checked and those found missing any of the following",!,"will be reported:",!!
 W "1)  Request date",!,"2)  Regional office number",!,"3)  Requester",!,"4)  Priority of exam",!
 W "5)  Request status",!,"6)  Routing location",!,"7)  No exams selected"
 D SETSTYLE
 W:STYLEIND=4 !
 W:STYLEIND'="4" !,"8)  Requests older than 3 days without C&P Appt links ",!
 W ! K PARAMDA
 ;
ASK W "Do you want to continue" S %=2 D YN^DICN G:$D(DTOUT) EXIT
 I $D(%Y),%Y["?" W !!,"Enter Y to print the report or N to quit.",!! H 2 G ASK
 I $D(%),%'=1 G EXIT
 ;
DEV W !! S %ZIS="AEQ" D ^%ZIS K %ZIS G:POP EXIT I $D(IO("Q")) S ZTIO=ION,ZTDESC="2507 exam integrity report",ZTRTN="GO^DVBCCHKR" F I="FF" S ZTSAVE(I)=""
 I  D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued",!! G EXIT
 ;
GO D:'$D(STYLEIND) SETSTYLE
 K ^TMP($J),LN,DVBCQUIT,GETOUT S (ITEMS,PG)=0,$P(LN,"-",80)="-",HD="C & P Exam Integrity Report",DVBCDT=$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
 U IO F DFN=0:0 S X="",DFN=$O(^DVB(396.3,"B",DFN)) Q:DFN=""  F DA=0:0 S DA=$O(^DVB(396.3,"B",DFN,DA)) Q:DA=""  D CHECK
 I '$D(^TMP($J)) D HDR W !!!!!?25,"Nothing found to report",!!
 I $D(^TMP($J)) D PRINT
 I ('$D(^TMP("DVBA",$J))&((+STYLEIND'="4")&(+$$RPTCHK=1))) DO
 .D NOW^%DTC S Y=X X ^DD("DD")
 .S TODAYDT=Y K Y,X
 .S SITE=$$SITE^DVBCUTL4
 .D RPTHD^DVBCULAP W !!!!!?25,"Nothing found to report",!!
 .I (IOST?1"C-".E) D PAUSE^DVBCUTL4
 .K TODAYDT,SITE
 I $D(^TMP("DVBA",$J)) D:(+$$RPTCHK=1) ^DVBCULAP
 ;
EXIT D ^%ZISC
 W:'$D(ZTQUEUED) @FF,!!!
 I $D(ZTQUEUED)&($D(DVBCMAN)) D KILL^%ZTLOAD
 K %,%Y,DTA,DTB,DTOUT,DVBCDT,FF,HD,NAME,PG,I,ZTSAVE,POP,X,XI,Y,ZTDESC,ZTIO,ZTRTN,ZTSK,ITEMS,PRINT,DFN,DA,LN,DVBCMAN,DVBCQUIT,GETOUT,DVBCX,HDRPRT
 K ^TMP("DVBA",$J),^TMP($J),REQDA,STYLEIND,DVBAY,DIQ,DIR,DIRUT,DUOUT
 K DR,DIC
 Q
 ;
HDR S PG=PG+1,HDRPRT="" W @IOF
 W !,DVBCDT,?(80-$L(HD)\2),HD,?69,"Page: ",PG,!,?(80-$L($$SITE^DVBCUTL4)\2),$$SITE^DVBCUTL4,!!,"Veteran name",?28,"Social Sec #",?50,"Missing items",!
 Q
 ;
LINKCK ;** Patient DFN's w/ 2507's >3 days w/out links
 ;** Called - 2507 C&P INTEG RPT'=OFF
 ;** $D(DVBAFND) - 2507 >3 days old w/out links
 N DVBAX,DVBADAYS
 S:'$D(X) X=""
 S DVBAX=X ;**Save X (prob report var)
 I +$$STYLE^DVBCUTL8(REQDA)=1 DO
 .K X,X1,X2
 .D NOW^%DTC
 .S X2=($P(^DVB(396.3,REQDA,0),U,5)\1),X1=X\1
 .K X D ^%DTC
 .S DVBADAYS=X K X
 .S X=DVBAX ;**Reset X (prob var)
 .I +DVBADAYS>3 DO  ;**2507 >3 days old, check links
 ..N APPTDA S APPTDA=""
 ..K DVBAFND
 ..I +$O(^DVB(396.95,"AR",REQDA,APPTDA))'>0 DO
 ...S:$$TRANCHK^DVBCUTA4(REQDA)=0 DVBAFND="" ;**2507 w/out links
 ..I $D(DVBAFND) DO  ;**Unlinked 2507 >3 days old
 ...S:(+$$RPTCHK=1) ^TMP("DVBA",$J,NAME,DFN)="" ;**TMP("DVBA") - unlinked 2507's
 ...S X=X_"199^"
 K DVBAFND
 Q
 ;
RPTCHK() ;**Check C&P Report Param field - 396.1
 N PARAMDA,PARAMVAL S PARAMDA=0
 S PARAMDA=$O(^DVB(396.1,PARAMDA))
 S PARAMVAL=$P(^DVB(396.1,PARAMDA,0),U,19)
 Q PARAMVAL
 ;
NAMELN W LN,!!,NAME,?28,$P(^DPT(DFN,0),U,9)
 Q
 ;
SETSTYLE ;
 S PARAMDA=0
 S PARAMDA=$O(^DVB(396.1,PARAMDA))
 S STYLEIND=$P(^DVB(396.1,PARAMDA,0),U,15)
 Q

DVBCCNC1
DVBCCNC1 ;ALB ISC/THM-CANCEL ENTIRE REQUEST ; 9/22/91  4:14 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
ALL K NONE W ! S ALLCANC=1,DIC="^DVB(396.5,",DIC(0)="AEQM",DIC("A")="Enter REASON FOR CANCELLATION: " D ^DIC G:X=""!(X=U)!(+Y'>0) EXIT^DVBCCNCL S REAS=+Y
 ;
BY W !,"Cancelled by (M)AS or (R)O?  M//  "
 R BY:DTIME
 G:'$T!(BY=U) EXIT^DVBCCNCL
 I BY=""!(BY="m") W:BY="" "M" S BY="M" ;echo selection
 S:BY="r" BY="R"
 I BY'?1"M"&(BY'?1"R") W !!,"Enter M to indicate cancellation by MAS or",!," R to indicate cancellation by the Regional Office.",!! G BY
 W $S(BY="M":"AS",BY="R":"O",1:"") ;finish echo of selection
 ;
BY1 W *7,!!,"Cancelled by ",$S(BY="":"MAS",BY="M":"MAS",BY="R":"RO",1:"Unknown source")," Ok" S %=2 D YN^DICN G:$D(DTOUT)!(%<0) EXIT^DVBCCNCL
 I $D(%Y),%Y["?" W !!,"Enter Y to verify or N to reselect",! G BY1
 I $D(%),%'=1 G BY
 S BY=$S(BY="R":"RX",BY="M":"X",1:"")
 W !!
 F JJZ=0:0 S JJZ=$O(^DVB(396.4,"C",DA(1),JJZ)) Q:JJZ=""  S STAT=$P(^DVB(396.4,JJZ,0),U,4) I STAT="O" D ALL1
 I '$D(CANC) S CANC("None - (Request only)")=BY_U_REAS ;used in case of request logging error (system)
 H 1 S DA=DA(1),(DIC,DIE)="^DVB(396.3,",DR="17////"_BY_";19///NOW;20////^S X=DUZ" D ^DIE,NOTIFY,BULL I $D(OUT) G EXIT^DVBCCNCL
 G LOOK^DVBCCNCL
 ;
ALL1 S EXMPTR=$P(^DVB(396.4,JJZ,0),U,3),EXMNM=$S($D(^DVB(396.6,+EXMPTR,0)):$P(^(0),U,1),1:"Unknown exam"_" ("_+EXMPTR_")") K EXMPTR ;show deleted exam
 S DR=".04////"_BY_";52////"_REAS_";51////^S X=DUZ;50///NOW",DA=JJZ
 S (DIC,DIE)="^DVB(396.4," D ^DIE
 I '$D(Y) W:$X>50 ! W:$L(EXMNM)>25&($X>45) ! W EXMNM," cancelled, " S CANC(EXMNM)=BY_U_REAS
 I $D(Y) W *7,!,"Cancellation error on ",EXMNM," exam !" H 2
 Q
 ;
NOTIFY S X=$P(^DVB(396.3,DA,0),U,18) I X="RX"!(X="X") W !!,"Entire exam is now CANCELLED.",!! H 1 Q
 I X'="RX"&(X'="X") W *7,!!,"Cancellation error !",!! H 3 S OUT=1
 Q
 ;
BULL Q:'$D(CANC)  S SEND=1,EXAM="" F JI=0:0 S EXAM=$O(CANC(EXAM)) Q:EXAM=""  I $P(CANC(EXAM),U,1)'="X"&($P(CANC(EXAM),U,1)'="RX") S SEND=0 Q
 I SEND=0 W *7,!!,"An error has occurred during cancellation - bulletin will not be sent!",!!,*7 H 3 Q
 K OWNDOM,XDOM,DOMAIN,DOMNUM
 I $D(ALLCANC) S OWNDOM=$P(^DVB(396.3,DA(1),0),U,22) I OWNDOM]"" S XDOM=$S($D(^DIC(4.2,OWNDOM,0)):^(0),1:"") S DOMAIN=$P(XDOM,U,1),DOMNUM=$S(+$P(XDOM,U,3)>0:+$P(XDOM,U,3),1:OWNDOM)
 I $D(ALLCANC),OWNDOM]"" I +DOMNUM>0 S XMY("G.DVBA C 2507 CANCELLATION@"_DOMAIN)=DOMNUM W !!,*7,"I am sending a copy of this cancellation to the",!,"cancellation mail group at "_DOMAIN,!,"since this was transferred in.",!! H 2
 I SEND=1 S REQDA=DA(1) D ^DVBCBULL I $D(ALLCANC),OWNDOM]"",+DOMNUM>0 S REQDA=DA(1) D EN1^DVBCXFRE
 K ALLCANC,CANC,SEND,OWNDOM,DOMNUM
 Q

DVBCCNCL
DVBCCNCL ;ALB/GTS-557/THM-2507 CANCEL REQUESTS ,EXAMS ; 9/23/91  9:25 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 G EN
LOOK1 S EXAM=$S($D(^DVB(396.6,$P(^DVB(396.4,JZ,0),U,3),0)):$P(^(0),U,1),1:"Unknown")
 S STAT=$P(^DVB(396.4,JZ,0),U,4)
 S $P(^TMP($J,EXAM),U,1)=STAT_U_JZ S:STAT="C" TCNCL=1 S:STAT="T" TCNCL=2
 Q
 ;
EN D HOME^%ZIS S FF=IOF,HD="2507 Exam Veteran Selection",HD2="2507 Test Cancellation"
 ;
LOOK D KILL W @FF,!?(IOM-$L(HD)\2),HD,!?(IOM-$L(HD2)\2),HD2,!! S DIC("W")="D DICW^DVBCUTIL" S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Select VETERAN: " D ^DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" G LOOK
 S DA(1)=+Y,DFN=$P(Y,U,2),STAT=$P(^DVB(396.3,DA(1),0),U,18) D STATCHK G:$D(NCN) LOOK S REQDT=$P(^DVB(396.3,DA(1),0),U,2)
 I '$D(^DPT(DFN,0)) W *7,!!,"Zeroth node for ^DPT record missing!",!! H 3 G LOOK
 S PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") K DICW
 S REQRO=$P(^DVB(396.3,DA(1),0),U,3),REQSTR=$P(^(0),U,4) ;used to screen bulletins
 K TCNCL F JZ=0:0 S JZ=$O(^DVB(396.4,"C",DA(1),JZ)) Q:JZ=""  D LOOK1
 ;
ASK I $D(TCNCL) W *7,!!,"This request cannot be cancelled entirely because",!," one or more exams have ",$S(TCNCL=2:"been transferred.",1:"been completed.")
 I  W !!,"However, you may cancel other individual exams.",!!,"Press RETURN " R ANS:60 G:'$T!(ANS="^") EXIT G DATA
 W !!,"Do you want to cancel the entire exam" S %=2 D YN^DICN G:$D(DTOUT)!(%<0) EXIT G:%=1 ^DVBCCNC1
 I $D(%Y),%Y["?" W !!,"Enter Y to cancel the ENTIRE exam or N to cancel ONLY selected exams",!! G ASK
 ;
DATA K EXMPTR,NCN
 D HDR^DVBCUTIL
EXMSEL S REQDA=DA(1),Y=$$EXSRH^DVBCUTL4("Select EXAM TO CANCEL: ","I $D(^DVB(396.4,""ARQ""_REQDA,+Y))") ;*Exam lookup function call
 K DIC("S"),REQDA
 G:$D(DTOUT) EXIT I X=""!(X=U)&($D(CANC)) D BULL^DVBCCNC1 G LOOK
 I $D(X),X=""!(X=U)&('$D(CANC)) G LOOK
 I ($P(^DVB(396.4,+Y,0),U,4)["X")!($P(^DVB(396.4,+Y,0),U,4)="T") W *7," ??" G EXMSEL
 S EXMPTR=+Y,EXMNM=$P(^DVB(396.4,+Y,0),U,3)
 S EXMNM=$S($D(^DVB(396.6,EXMNM,0)):$P(^(0),U,1),1:"Unknown exam")
 S STAT=$P(^TMP($J,EXMNM),U,1) D STATCHK G:$D(NCN) DATA
 D CNCLCHK G:NOFND=0 DATA G:$D(OUT) EXIT
 ;
 ;  ** If selected an exam, enter Cancellation Reason.
 S DVBCMSG=" for this "_EXMNM_" exam:",EXMCNC="" D CODE G:$D(OUT) EXIT
 S DR="52R;.04////"_CCODE_";51////^S X=DUZ;50///NOW",DIE="^DVB(396.4,"
 S DA=EXMPTR D ^DIE K DR,DIE G:($D(Y))!($D(DTOUT)) EXIT
 S STAT=$P(^DVB(396.4,DA,0),U,4),REASON=+$P(^DVB(396.4,DA,"CAN"),U,3)
 G:REASON=0 LOOK S $P(^TMP($J,EXMNM),U,1)=STAT
 S ^TMP("DVBA",$J,9999999-$P(^DVB(396.4,EXMPTR,"CAN"),U,1))=CCODE
 S CANC(EXMNM)=STAT_U_REASON D CNCLCHK I $D(OUT) G EXIT
 K %DT G DATA
 ;
EXIT D KILL K CCODE,DVBCMSG,TCNCL,^TMP($J),EXMPTR,J G KILL^DVBCUTIL
 ;
KILL K TCNCL,DIC,DA,D0,D1,DFN,X,Y,OLDEXAM,JDR,REQDT,DR,EXMNM,NCN,STAT,%,NOFND,CANC,^TMP($J),%Y,Z,JY,JZ,DA,DIC,DIE,ALLCANC
 Q
 ;
CNCLCHK S NOFND=0,Z=$P(^DVB(396.3,DA(1),0),U,18) Q:Z="X"!(Z="RX")  K Z S I="" F J=0:0 S I=$O(^TMP($J,I)) Q:I=""  I $P(^TMP($J,I),U,1)'="X"&($P(^(I),U,1)'="RX") S NOFND=1
 Q:NOFND=1  W *7,!!,"Since all exams have been cancelled",!,"the entire request will be CANCELLED.",!! H 3
 S DVBCMSG=" for this request:" D CODE
 S DR="17////"_CCODE_";19///NOW;20////^S X=DUZ"
 S DA=DA(1),DIE="^DVB(396.3," D ^DIE S DA=DA(1) D NOTIFY^DVBCCNC1
 Q
 ;
STATCHK Q:STAT="P"!(STAT="N")!(STAT="NT")!(STAT="S")!(STAT="O")
 W !!,*7,"This exam or request has been ",$S(STAT="RX":"cancelled by the RO",STAT="X":"cancelled by MAS",STAT="T":"transcribed",STAT="R":"released",STAT="C":"completed",STAT="CT":"completed, transferred out",1:"given an incorrect status"),".",!!
 S NCN=1 H 2 Q
 ;NCN=no can do
 Q
 ;
CODE S:'$D(DVBCMSG) DVBCMSG=":" W @IOF,!,"Please enter cancellation code"_DVBCMSG,! K OUT,%
 S DIR("A")="CANCELLED BY"
 S:'$D(EXMCNC) DIR(0)="SO^X:MAS CANCELLATION;RX:REGIONAL OFFICE CANCELLATION"
 S:$D(EXMCNC) DIR(0)="S^X:MAS CANCELLATION;RX:REGIONAL OFFICE CANCELLATION"
 D ^DIR S CCODE=Y
 I CCODE=U&('$D(EXMCNC)) W !!,*7,"NO '^' ALLOWED AT THIS PROMPT" D CONTMES^DVBCUTL4 G CODE
 I $D(DTOUT) D RQCODE^DVBCUTL2 S OUT=1 Q
 I (X=""&('$D(EXMCNC))) W !,*7,"This is a required response." D CONTMES^DVBCUTL4 G CODE
CNCBY W !!,*7,"CANCELLED BY ",$S(CCODE="X":"MAS",CCODE="RX":"RO",1:"???"),", OK" S %=2 D YN^DICN I %=2 G CODE
 I %=-1&('$D(EXMCNC)&('$D(DTOUT))) W !!,*7,"NO '^' ALLOWED AT THIS PROMPT" D CONTMES^DVBCUTL4 G CNCBY
 K EXMCNC
 I $D(DTOUT) D BULL^DVBCCNC1 S OUT=1 Q
 Q

DVBCCNNS
DVBCCNNS ;ALB/GTS-AMIE C&P APPT EVENT DRIVER ; 10/20/94  9:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
 ;** Variable Descriptions
 ;**    DVBAAUTO - prevents AMIE Make Event on an Auto-rebook
 ;**                NOTE: DVBAAUTO killed by ^DVBCSDEV
 ;**    DVBASTAT - Status of appointment being canceled/no showed
 ;**    DVBACURA - Appointment date/time being canceled/no showed
 ;**    DVBAAPDA - IEN of record in file 396.95
 ;**    DVBAFND  - Defined if appt canceled/no showed found in 396.95
 ;**    DVBAAPDT - New appt date on auto-rebook
 ;**    DVBAVTRQ - Defined if appt canceled by vet
 ;**    DVBACROT - External value of DVBACURA
 ;**    LNKCNT   - # of link records with current date = canceled date
 ;**    DVBAUPDT - Last dte cncl'd - cncled 396.95 recs, Cur Dte=cncl dt
 ;
EN ;**Find the respective AMIE appointment record
 S DVBASTAT=$$SDEVTSPC^DVBCUTL5(2)
 S DVBACURA=$P(SDATA,U,3) ;**Get the date being canceled
 S (DVBAAPDA,DVBALKDA)=""
 S DVBAUPDT=0
 K DVBAFND
 S LNKCNT=0
 F  S DVBAAPDA=$O(^DVB(396.95,"CD",DVBACURA,DVBAAPDA)) Q:(DVBAAPDA="")  DO
 .S DVBARQDA=$P(^DVB(396.95,DVBAAPDA,0),U,6)
 .I ($P(^DVB(396.3,DVBARQDA,0),U,1)=DFN) DO
 ..S LNKCNT=LNKCNT+1
 ..S:(+$P(^DVB(396.95,DVBAAPDA,0),U,7)=1) DVBAFND="",DVBALKDA=DVBAAPDA
 ..I '$D(DVBAFND),($P(^DVB(396.95,DVBAAPDA,0),U,8)>DVBAUPDT) DO
 ...S DVBAUPDT=$P(^DVB(396.95,DVBAAPDA,0),U,8) ;**Keep latest cancel dte
 ...S DVBALKDA=DVBAAPDA ;**Keep DA of rec last cancelled
 I (DVBASTAT="PCA")!((DVBASTAT="NA")!(DVBASTAT="CA")) S DVBAAUTO=""
 ;
 ;** Appt not linked, enhnc dilog on, not processing in background
 I (LNKCNT=0)&((+$$ENHNC^DVBCUTA4=1)&('$D(ZTQUEUED))) DO
 .N DVBACROT S Y=DVBACURA X ^DD("DD") S DVBACROT=Y K Y
 .S DIR("A",1)=" "
 .S DIR("A",2)="Appointment "_DVBACROT_" was not linked to a 2507 request or was"
 .S DIR("A",3)=" manually rebooked and linked to another appointment."
 .S DIR("A",4)=" (If the appointment was manually rebooked, you do not want to auto-rebook.)"
 .S DIR("A",5)=" "
 .S DIR("A",6)="If the appointment was not properly linked, it will need to be linked with the"
 .S DIR("A",7)=" AMIE/C&P appointment link management option."
 .S DIR("A",8)=" "
 .S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 I $D(DVBAAUTO),($D(DVBAFND)!('$D(DVBAFND)&(+LNKCNT>0))) DO  ;**Auto-rbk
 .S:(+$$SDEVTXST^DVBCUTL5=1) DVBAAPDT=$$SDEVTSPC^DVBCUTL5(10)
 .K DVBAVTRQ ;**Set if appointment canceled by vet
 .S:(DVBASTAT["P"!(DVBASTAT["N"&(DVBASTAT'="NT"))) DVBAVTRQ=""
 .D RSCHAPT^DVBCMKLK(DVBALKDA,DVBAAPDT)
 .D:((+$$ENHNC^DVBCUTA4=1)&('$D(ZTQUEUED))) CNCMSG
 I '$D(DVBAAUTO),($D(DVBAFND)) DO  ;**Appt linked, not Auto
 .D CANCEL
 .D:((+$$ENHNC^DVBCUTA4=1)&('$D(ZTQUEUED))) CNCMSG
 I +LNKCNT>1 DO
 .S DIR("A",1)=" "
 .S DIR("A",2)="This C&P appointment has multiple links with the same Current Appt Date."
 .S DIR("A",3)="Use the AMIE/C&P Appointment Link Management option to review and delete"
 .S DIR("A",4)=" any duplicate links."
 .S DIR("A",5)=" "
 .S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue." D ^DIR K DIR,X,Y
 D KVARS
 Q
 ;
CNCMSG ;** Write message indicating link updated
 N DVBAINIT,DVBACROT,DVBARBDT
 K Y S Y=$P(^DVB(396.95,+DVBALKDA,0),U,1)
 X ^DD("DD") S DVBAINIT=Y
 K Y S Y=DVBACURA
 X ^DD("DD") S DVBACROT=Y K Y
 I $D(DVBAAUTO) DO
 .S Y=DVBAAPDT
 .X ^DD("DD") S DVBARBDT=Y K Y
 S DIR("A",1)=" "
 S DIR("A",2)="AMIE C&P Appt Link update"
 S DIR("A",3)="Initial Appt Date: "_DVBAINIT
 S DIR("A",4)="Current Appt Date: "_DVBACROT
 S:'$D(DVBAAUTO) DIR("A",5)="has been cancelled!"
 S:$D(DVBAAUTO) DIR("A",5)="has been cancelled and rebooked for "_DVBARBDT_"!"
 S DIR("A",6)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue." D ^DIR K DIR,X,Y
 Q
 ;
CANCEL ;** Cancel C&P Appt
 N DVBCUPDT
 D NOW^%DTC
 S DVBCUPDT=%
 K %,X
 S DA=+DVBALKDA,DIE="^DVB(396.95,",DR=""
 I DVBASTAT["PC"!(DVBASTAT["N"&(DVBASTAT'="NT")) DO
 .S DR=".04////^S X=1;" ;** Set .04 if vet cancel
 S DR=DR_".07////^S X=0;.08////^S X=DVBCUPDT"
 D ^DIE K DA,DIE,DR
 Q
 ;
KVARS ;
 K DVBAAPDA,DVBAFND,DVBCCURA,DVBASTAT,DVBAAPDT,DVBARQDA
 K DVBAVTRQ,DVBALKDA,LNKCNT,DVBAUPDT
 Q

DVBCCRCK
DVBCCRCK ;ALB/GTS-557/THM-THE CRANIAL NERVES ; 12/27/90  1:10 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1205 Worksheet" S HD7="THE CRANIAL NERVES",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Identify the nerve and the side -",!!!!!!?5,"2.  Identify the disorder (paralysis, neuritis, neuralgia) -",!!!!!!
 W ?5,"3.  Describe in detail, quantifying as much as possible, the",!?9,"motor and sensory impairment.  Note if the entire nerve is",!?9,"affected or only that part of the distribution distal to a",!?9,"particular localized lesion -",!!!!!!
 D HD2 ;W ?5,"4.  Is tinnitus present?  If so is it constant or intermittent? -",!!!!!! D HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;The first through fourth, sixth and eighth cranial nerves are
 ;;covered under the instructions for examination of the Organs
 ;;of Special Sense.  This exam is limited to the examination of
 ;;the fifth, seventh, and ninth through twelfth cranial nerves.
 ;;END

DVBCCUCK
DVBCCUCK ;ALB/GTS-557/THM-HYPERPITUITARISM (CUSHING'S SYNDROME) ; 12/26/90  12:35 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0420 Worksheet" S HD7="HYPERPITUITARISM (CUSHING'S SYNDROME)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Muscular weakness -",!!!!!!?5,"2.  Decalcification of bones -",!!!!!!?5,"3.  Osteoporosis -",!!!!!!
 W ?5,"4.  Enlarged sella turcica, pituitary or adrenal glands -",!!!!!!?5,"5.  Nervous, cardiovascular or gastrointestinal -",!!!!!!
 W ?5,"6.  Disease in remission or demonstrably active -",!!!!!! D:$D(CMBN) HD2 W ?5,"7.  Continuous medication required -",!!!!!! D:'$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;When symptoms interfere with normal daily activities or job
 ;;efficiency, it is essential that the extent of such handicaps
 ;;be described.
 ;;END

DVBCCYCK
DVBCCYCK ;ALB/GTS-557/THM-CYSTITIS,BLADDER CALCULUS,ETC ; 2/6/91  7:59 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0605 Worksheet" S HD5="CYSTITIS, BLADDER CALCULUS, RESIDUALS OF BLADDER INJURY,",HD6="ALL DISORDERS OF THE PROSTATE, URETHRA AND SURGICAL RESIDUALS (GU)"
 S HD7="For "_HD5
 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD7)\2)),HD7,!?(40-($L(HD6)\2)),HD6,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,! I '$D(CMBN) W "Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD5,!?14,HD6
 W !!!!,"Narrative:"
 W ?13,"Complications and/or medical side effects should always be",!?13,"reported, even when not specifically requested.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Frequency of urination -",!!!!!?8,"2. Presence or absence of pyuria -",!!!!!
 W ?8,"3. Pain or tenesmus -",!!!!!?8,"4. Incontinence requiring pads or appliance -",!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!!,HD5,!,HD6,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCDACK
DVBCDACK ;ALB/GTS-557/THM-DISEASES OF THE ARTERIES/VEINS ; 12/26/90  12:23 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0105 Worksheet" S HD7="DISEASES OF THE ARTERIES AND VEINS (CARDIOVASCULAR)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"Once a diagnosis is established, details about the",!?13,"permanent medical residuals and how they affect the",!
 W ?13,"veteran's industrial capabilities are very important as",!?13,"the degree of impairment is used by the rating board to",!
 W ?13,"determine the percentage of disability and payments therefore.",!!
 I '$D(CMBN) W "A. Medical history  (if a disability is already service connected, then",!?22,"provide data since last VA rating examination):",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!?8,"1. Blood pressure -",!!!!!!
 W ?8,"2. Pulsation -",!!!!!!?8,"3. Skin appearance -",!!!!!!
 W ?8,"4. Skin temperature (to the touch) -",!!!!!!?8,"5. Paresthesias -",!!!!!!
 W ?8,"6. Cardiac involvement -",!!!!!! D:$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!! D:'$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCDBCK
DVBCDBCK ;ALB/GTS-557/THM-DISEASES/INJURIES OF THE BRAIN ; 12/28/90  9:26 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1210 Worksheet" S HD7="DISEASES/INJURIES OF THE BRAIN",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  State if a tumor is present.  If so, note type and whether ",!?9,"malignant -",!!!!!!!!
 W ?5,"2.  If a malignancy is present but is now cured or in remission,",!?9,"report the date of last surgery, radiation therapy, chemotherapy",!?9,"or other treatment -",!!!!!!!!
 W ?5,"3.  Describe in detail the motor and sensory impairment of the affected",!?9,"cranial nerves -",!!!!!!!!
 D:$D(CMBN) HD2 W ?5,"4.  Describe in detail any functional impairment of the peripheral",!?9,"and autonomic systems -",!!!!!!!!
 D:'$D(CMBN) HD2 W ?5,"5.  Describe any psychiatric manifestations in detail -",!!!!!!?5,"6.  "
 S LX="TXT1" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W:$X'=5 ?5,$P(LY,";;",2),!
 W !!!!!!!!!,$S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!! D:$D(CMBN) HD2
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;Since disorders of the brain are likely to produce psychiatric
 ;;manifestations as well as neurological, special psychiatric
 ;;examinations will often be necessary.  If special senses are
 ;;impaired, the examiner should order additional testing as
 ;;appropriate.
 ;;END
TXT1 ;
 ;;State if the veteran is capable of managing his/her benefit payments
 ;;    in the individual's own best interest without restriction (a physical
 ;;    disability which prevents the veteran from attending to financial
 ;;    matters in person is not a proper basis for a finding of incompetency
 ;;    unless the veteran is, by reason of that disability, incapable of
 ;;    directing someone else in handling the individual's financial
 ;;    affairs) -
 ;;END

DVBCDECK
DVBCDECK ;ALB/GTS-557/THM-DIGESTIVE, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For DIGESTIVE, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 0310 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: DIGESTIVE, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized digestive
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For DIGESTIVE, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCDHCK
DVBCDHCK ;ALB/GTS-557/THM-DISEASES OF THE HEART ; 3/14/91  10:12 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0110 Worksheet" S HD7="DISEASES OF THE HEART (CARDIOVASCULAR)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"In developing the diagnosis of a cardiac condition, the",!?13,"NOMENCLATURE AND CRITERIA FOR DIAGNOSIS OF DISEASE",!
 W ?13,"OF THE HEART published by the New York Heart Association",!?13,"serves as an acceptable standard.  If a stress test",!
 W ?13,"could be conducted without cardiovascular contraindications",!?13,"but physical problems preclude, please state.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Blood pressure -",!!!!!!?8,"2. Electrocardiogram -",!!!!!!?8,"3. X-Ray results -",!!!!!!
 W ?8,"4. Stress test (after EKG, if indicated) -",!!!!!! I $D(CMBN) D HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCDICK
DVBCDICK ;ALB/GTS-557/THM-DIABETES INSIPIDUS ; 12/6/90  11:48 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0405 Worksheet" S HD7="DIABETES INSIPIDUS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Frequency of urination -",!!!!!!?5,"2.  Frequency of excessive thirst -",!!!!!!?5,"3.  Frequency of syncope -",!!!!!!?5,"4.  Blood pressure readings -",!!!!!!?5,"5.  Serum osmolality (m Osm/Kg) -",!!!!!!
 W ?5,"6.  Urine osmolality (m Osm/Kg) -",!!!!!! D:$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!! D:'$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;When symptoms interfere with normal daily activities or job
 ;;efficiency, it is essential that the extent of such handicaps
 ;;be described.
 ;;END

DVBCDMCK
DVBCDMCK ;ALB/GTS-557/THM-DIABETES MELLITUS ; 12/6/90  11:48 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0410 Worksheet" S HD7="DIABETES MELLITUS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Frequency of ketoacidosis or hypoglycemic reactions -",!!!!!!?5,"2.  Restricted diet and/or regulation of activities -",!!!!!!?5,"3.  Loss of weight and strength since last exam -",!!!!!!
 W ?5,"4.  Anal pruritis -",!!!!!!?5,"5.  Vascular deficiencies -",!!!!!!
 W ?5,"6.  Diabetic ocular disturbances -",!!!!!! D:$D(CMBN) HD2 W ?5,"7.  Daily insulin requirements (type and amount) -",!!!!!!?5,"8.  Blood sugar -",!!!!!! D:'$D(CMBN) HD2 W ?5,"9.  Blood pressure -",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;When symptoms interfere with normal daily activities or job
 ;;efficiency, it is essential that the extent of such handicaps
 ;;be described.
 ;;END

DVBCDNCK
DVBCDNCK ;ALB/GTS-557/THM-DENTAL EXAM ; 12/5/90  2:16 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0205 Worksheet" S HD7="DENTAL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Disability effect on everyday activities -",!!!!!!?5,"2.  Ancillary problems as a result of the dental condition -",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!! D:$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;Regional Office action is required for all dental treatment
 ;;claims based on combat wounds, service trauma, prisoner of
 ;;war or extracted teeth under 38 CFR 17.123.
 ;;END

DVBCEDCK
DVBCEDCK ;ALB/GTS-557/THM-AUDIO-EAR DISEASE ; 6/27/91  7:21 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1306 Worksheet" S HD7="AUDIO-EAR DISEASE",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"If, in the course of audiometric testing, there is any",!?13,"indication of ear disease, the veteran should be referred to",!?13,"a physician for additional exam.  Examination should include"
 W !?13,"inspection of the auricle, the external canal, and tympanic",!?13,"membranes.  Abnormalities in size, shape, or form of the",!?13,"structure should be noted.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!?8,"1. Auricle -",!!!!!?8,"2. External canal -",!!!!!
 W ?8,"3. Tympanic membrane -",!!!!!?8,"4. The tympanum -",!!!!!?8,"5. The mastoid -",!!!!! D:$D(CMBN) HD2
 W ?8,"5. State if an active ear disease is present -",!!!!!?8,"6. State if an infectious disease of the middle or inner",!?11,"ear is present -"
 W !!!!!?8,"7. State whether ear disease is affecting any function other",!?11,"than hearing, such as balance, or is associated with any",!?11,"upper respiratory disease -",!!!!! D:'$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCEDIT
DVBCEDIT ;ALB/GTS-557/THM-EDIT 2507 DATA ; 6/19/91  1:22 PM
 ;;2.7;AMIE;;Apr 10, 1995
 I $D(DUZ)#2=0 W *7,!!,"You have no user number.",!! Q
 ;
EN D HOME^%ZIS K OUT S FF=IOF,HD="Veteran Selection",HD2="2507 Exam Data Entry"
 ;
LOOK S %DT(0)=-DT D KILL W @FF,!?(80-$L(HD)\2),HD,!?(80-$L(HD2)\2),HD2,!!! S DIC("W")="D DICW^DVBCUTIL" S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Select VETERAN: " D ^DIC G:X=""!(X=U) EXIT I +Y<0 W "  ???" H 1 G LOOK
 S STAT=$P(^DVB(396.3,+Y,0),U,18) I STAT="N" W *7,!!,"This request has not been reported to MAS and may not be transcribed.",!! H 3 G LOOK
 S (REQDA,DA(1))=+Y D STATCHK^DVBCUTL4 H:$D(NCN) 2 G:$D(NCN) LOOK
 S DFN=$P(Y,U,2),REQDT=$P(^DVB(396.3,REQDA,0),U,2),PNAM=$S($D(^DPT(DFN,0)):$P(^(0),U,1),1:"Unknown"),SSN=$S($D(^(0)):$P(^(0),U,9),1:"Not specified")
 S CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") K DICW
 F DA=0:0 S DA=$O(^DVB(396.4,"C",REQDA,DA)) Q:DA=""  S EXAM=$P(^DVB(396.4,DA,0),U,3) S EXAM=$P(^DVB(396.6,EXAM,0),U,1),STAT=$P(^DVB(396.4,DA,0),U,4),^TMP($J,EXAM)=STAT_U_DA
 ;
DATA K NCN,QUE D HDR^DVBCUTIL
 W !
 S Y=$$EXSRH^DVBCUTL4("Select Exam: ","I $D(^DVB(396.4,""ARQ""_REQDA,+Y))")
 G:$D(DTOUT) EXIT G:X=""!(X=U) LOOK
 I +Y<0 W *7,"  ???" G DATA
 S DVBCLCKD=$$XMLCK(+Y)
 I +DVBCLCKD'=1 W !!,*7,"This exam is currently being edited.   <RETURN> to continue." R DVBCTST:DTIME K DVBCTST G DATA
 S (EXMDA,DA)=+Y,EXMNM=$P(^DVB(396.4,+Y,0),U,3)
 S EXMNM=$P(^DVB(396.6,EXMNM,0),U,1)
 S STAT=$P(^TMP($J,EXMNM),U,1)
 D STATCHK^DVBCUTL4
 I STAT="C",$P(^DVB(396.4,EXMDA,0),U,10)]"" W !,*7,"These exam results have been electronically signed.",!,"No editing is allowed!" D CONTMES^DVBCUTL4 S DVBCLCKD=$$XMUNLCK(EXMDA) G DATA
 W:STAT="C" "But you may make changes until it is released.",!! H:STAT="C" 2 I $D(NCN)&("^X^RX^"[STAT) S DVBCLCKD=$$XMUNLCK(EXMDA) G DATA
 I STAT="T" W *7,!!,"This exam has been transferred to another facility.",!! H 2 S DVBCLCKD=$$XMUNLCK(EXMDA) G DATA
 K DR S (DIC,DIE)="^DVB(396.4,",DR="W @FF;70;W @FF,!!;.06R;.07R"
 S DA=EXMDA D ^DIE,COMP^DVBCUTL4
 S DVBCLCKD=$$XMUNLCK(EXMDA)
 G:$D(OUT) EXIT S STAT1=$P(^DVB(396.4,EXMDA,0),U,4),$P(^TMP($J,EXMNM),U,1)=STAT1
 S NFINAL=0
 F EXMDA=0:0 S EXMDA=$O(^DVB(396.4,"C",REQDA,EXMDA)) Q:EXMDA=""  S STAT=$P(^DVB(396.4,EXMDA,0),U,4) I STAT'="C"&(STAT'="X")&(STAT'="RX") S NFINAL=1
 I NFINAL=0,$P(^DVB(396.3,REQDA,0),U,12)="" S XMB="DVBA C 2507 EXAM READY",XMB(1)=PNAM,XMB(2)=SSN,Y=REQDT X ^DD("DD") S XREQDT=Y,XMB(3)=XREQDT D ^XMB K XMB,XREQDT
 ;
QUE K IO("Q"),%DT S QUE="N" I NFINAL=0 K DR S DIE="^DVB(396.3,",DA=REQDA,DR="11///NOW;17////T" D ^DIE S %DT(0)=-DT
 ;
QUE1 K IO("Q") W !!,"Do you want to print a review copy" S %=2 D YN^DICN G:$D(DTOUT) EXIT I %=1 S QUE="Y"
 I $D(%Y),%Y["?" W !!,"Enter Y to print a copy of the results for review",!,"or N to continue editing.",!! H 2 G QUE1
 I QUE="Y" S (DA(1),DA)=REQDA W !! S %ZIS="AEQ" D ^%ZIS K %ZIS I POP S QUE="N"
 I '$D(IO("Q")),QUE="Y" S EDPRT=1 U IO D ZTSK^DVBCPRN1 K EDPRT,AUTO,ULINE,EXMNM,XEXMNM,PGHD,DVBCSITE
 I $D(IO("Q")) S ZTRTN="ZTSK^DVBCPRN1",ZTIO=ION,ZTDESC="2507 Review Report",ZTDTH=$H F I="DVBC*","DUZ*","DA*","REQDA","EXMNM" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD I $D(ZTSK) W !!,"2507 Request queued for review to device "_ION,!! H 2 K ZTRTN,ZTIO,ZTSAVE,ZTDTH,ZTSK,IO("Q")
 D ^%ZISC
 I QUE="Y" G LOOK
 G DATA
 ;
EXIT K DVBCLCKD D:$D(ZTQUEUED) KILL^%ZTLOAD K WPTYPE,%DT G KILL^DVBCUTIL
 ;
KILL K ^TMP($J),DIC,DA,D0,D1,DFN,X,Y,OLDEXAM,REQDT,DR,EXMNM,NCN,STAT,NOFND,NFINAL,QUE,%,%Y,%ZIS,IOP
 Q
 ;
XMLCK(DA) ;  ** Lock the 396.4 exam record selected for transcription **
 L +^DVB(396.4,+DA,0):1
 Q $T
 ;
XMUNLCK(DA) ;  ** Unlock the 396.4 exam record selected for transcription **
 L -^DVB(396.4,DA,0)
 Q 0

DVBCEEXM
DVBCEEXM ;ALB/GTS-557/THM-COMPILE EXISTING 2507 EXAMS ; 5/24/91  7:07 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;only need DFN to return data
 I '$D(^DVB(396.4,"APE",DFN)) W !!,"No Requests are currently on file." Q
 ;;;I '$D(^DVB(396.4,"APE",DFN)) W !!,"Press [RETURN] to continue"
 ;;;I '$D(^DVB(396.4,"APE",DFN)) R DVBCIN:DTIME K DVBCIN Q
 W "Requested exams currently on file:",!!
 D SORT
 F JX=1:1:80 W "-"
 K DVBAEXM,DVBAEXST,DVBADA,DVBADONE,DVBAPDT,DVBAST,DVBARO,JX,DVBCX
 Q
 ;
STAT S DVBAST=$P(^DVB(396.4,DVBADA,0),U,4)
 S:$D(^DVB(396.4,DVBADA,"TRAN")) DVBCX=$P(^("TRAN"),U,3)
 S DVBAST=$S(DVBAST="C":"Completed",DVBAST="RX":"Cancelled by RO",DVBAST="X":"Cancelled by MAS",DVBAST="F":"Cancelled, failed to report",DVBAST="O":"Open",DVBAST="T":"Transferred",1:"Unknown status")
 Q
 ;
CON I $Y>12,IOST?1"C-".E W !!,"Press [RETURN] to continue or ""^"" to end display of existing exams" R ANS:DTIME W ! I '$T!(ANS=U) S DVBADONE=1
 I $Y>12,IOST?1"C-".E W:(DVBADONE'=1) @IOF,"Exams currently on file, continued --",!!!
 I ($Y>45),(IOST?1"P-".E) D HDR
 Q
 ;
HDR S PG=PG+1
 W @IOF,!,"Date: ",FDT(0),?(80-$L(PGHD)\2),PGHD,?71,"Page: ",PG,!,?(80-$L($$SITE^DVBCUTL4)\2),$$SITE^DVBCUTL4 I PG>1 W !!,"Name: ",PNAM,?44,"SSN: ",SSN,?63,"C-NUM: ",CNUM
 W ! F XLINE=1:1:80 W "="
 W !!,"Requested exams currently on file:",!
 W ! Q
 ;
SORT ;  ** Explore 396.4 file; display exams already requested **
 N DVBAEXM,DVBADA,DVBADONE,DVBAPDT,DVBAST,DVBARO,DVBARQDT
 S (DVBAEXM,DVBADA,DVBADONE,DVBAPDT,DVBAST,DVBARO,DVBARQDT)=""
 F  S DVBAEXM=$O(^DVB(396.4,"APE",DFN,DVBAEXM)) Q:DVBAEXM=""!(DVBADONE=1)  F  S DVBARQDT=$O(^DVB(396.4,"APE",DFN,DVBAEXM,DVBARQDT)) Q:DVBARQDT=""  D FLOOP Q:DVBADONE=1
 Q
 ;
FLOOP ;  **  Final loop of "APE" index **
 F  S DVBADA=$O(^DVB(396.4,"APE",DFN,DVBAEXM,DVBARQDT,DVBADA)) Q:DVBADA=""  D BLD,CON Q:DVBADONE=1  D PRINT
 Q
 ;
BLD ;  ** Set variables to be printed to screen **
 S Y=DVBARQDT X ^DD("DD") S DVBAPDT=Y
 S DVBARO=$P(^DVB(396.3,$P(^DVB(396.4,DVBADA,0),U,2),0),U,3)
 S DVBARO=$S($D(^DIC(4,+DVBARO,0)):$P(^(0),U,1),1:"Unknown RO")
 D STAT
 Q
 ;
PRINT ;  **  Print an entry from list of requested exams **
 W DVBAEXM,!,"Requested on ",DVBAPDT," by ",DVBARO," - ",DVBAST,!!
 Q

DVBCENCK
DVBCENCK ;ALB/GTS-557/THM-EPILEPSY AND NARCOLEPSY EXAM ; 7/5/91  7:34 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1220 Worksheet" S HD7="EPILEPSY AND NARCOLEPSY",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  State the frequency and type of seizures during the past",!?9,"twelve months, including any change in frequency pattern.  If",!?9,"possible, get the actual number of seizures in each calendar",!
 W ?9,"month.  If the veteran keeps a seizure diary, get dates of",!?9,"seizures -",!!!!!!
 W ?5,"2.  If a medical examiner observes any indications of psychiatric",!?9,"disease associated with epilepsy, a psychiatric consultation",!?9,"should be ordered.",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!! D:$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;If the diagnosis is NOT established or is questioned at some later
 ;;date, schedule necessary special studies, including admission
 ;;for a period of examination and observation, as appropriate to
 ;;provide a definitive diagnosis.
 ;;END

DVBCENQ
DVBCENQ ;ALB/GTS-557/THM-2507 INQUIRY ; 10/22/90  7:20 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 G EN
PRINT D VARS^DVBCUTIL,^DVBCENQ1
 I $D(ZTQUEUED) G EXIT ;entry point for TaskMan
 S (NAME,SSN,CNUM,ADR1,ADR2,ADR3,CITY,STATE,ZIP,HOMPHON,BUSPHON,OTHDIS)=""
 Q
 ;
EN K ^TMP($J) S Y=DT X ^DD("DD") S FDT(0)=Y D HOME^%ZIS S FF=IOF
 W @FF,"2507 Request Inquiry",!!!
 S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("W")="W ""    Date of request: "" S DVBCDT=$P(^(0),U,2) W $E(DVBCDT,4,5)_""/""_$E(DVBCDT,6,7)_""/""_$E(DVBCDT,2,3)",DIC("A")="Enter VETERAN NAME: " D ^DIC G:X=""!(X=U) EXIT
 I +Y<0 W "  ???",*7 G EN
 S JI=$P(Y,U,2),(DA,DA(1),REQDA)=+Y
 ;
DEVICE W ! S %ZIS="AEQ",%ZIS("B")="HOME",%ZIS("A")="Output device: " D ^%ZIS G:POP EXIT
 I $D(IO("Q")) S ZTRTN="PRINT^DVBCENQ",ZTIO=ION,ZTDESC="C&P Request Inquiry" F I="FDT(0)","DA*","REQDA","DVBC*","Y","JI","DUZ","FDT(0)" S ZTSAVE(I)=""
 I  D ^%ZTLOAD G:'$D(ZTSK) EXIT W !!,"Request queued",!! G EXIT
 U IO D PRINT D ^%ZISC G EN
 ;
EXIT K ^TMP($J),TSTA1,TSTAT,XCNP
 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBCUTIL

DVBCENQ1
DVBCENQ1 ;ALB/GTS-557/THM 2507 INQUIRY DISPLAY ; 5/25/91  1:52 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 G START
CON K OUT I IOST?1"C-".E W !,"Press [RETURN] to continue or ""^"" to stop   " R ANS:DTIME S:ANS=U!('$T) OUT=1 Q:$D(OUT)  D HDR
 I IOST?1"P-".E,$Y>45 W @IOF D HDR
 Q
 ;
START S PGHD="COMPENSATION AND PENSION EXAM INQUIRY",PG=0
 D HDR
 W !!?2,"Name: ",PNAM,?56,"SSN: ",SSN,!?51,"C-Number: ",CNUM,!?56,"DOB: " S Y=DOB X ^DD("DD") W Y,!?2,"Address: ",ADR1,! W:ADR2]"" ?11,ADR2,! W:ADR3]"" ?11,ADR3,!!
 W !?2,"City,State,Zip+4: ",?48,"Res Phone: ",HOMPHON,!?5,CITY,"  ",STATE,"  ",ZIP,?48,"Bus Phone: ",BUSPHON,!
 S EDTA=$S($D(^DPT(DFN,.32)):^(.32),1:""),EOD=$P(EDTA,U,6),RAD=$P(EDTA,U,7)
 W !,"Entered active service: " S Y=EOD X ^DD("DD") S:Y="" Y="Not specified" W Y,! S Y=RAD X ^DD("DD") S:Y="" Y="Not specified" W "Released active service: " W Y,!
 F LINE=1:1:80 W "="
 W !! D CON Q:$D(OUT)  D ^DVBCENQ2,CON Q:$D(OUT)  D ^DVBCEEXM,CON Q:$D(OUT)  S REQDT=$P(^DVB(396.3,REQDA,0),U,2)
 W !,"This request was initiated on " S Y=REQDT X ^DD("DD") W $P(Y,"@",1)," at ",$P(Y,"@",2),!!?17,"Requester: ",REQN,!,"Requesting Regional Office: ",RONAME,!
 I $D(^DVB(396.4,"C",REQDA)) W !?3,"Exams on this request: " D TST^DVBCUTL2 W !
 I '$D(^DVB(396.4,"C",REQDA)) W !?3,"(No exams have yet been entered)",!
 W !,"** Status of request: " S (XSTAT,STAT)=$P(^DVB(396.3,REQDA,0),U,18)
 S STAT=$S(XSTAT="N":"New",XSTAT="P":"Pending, reported to MAS",XSTAT="T":"Transcribed",XSTAT="S":"Scheduled",XSTAT="R":"Released, not printed",XSTAT="C":"Completed",XSTAT="CT":"Completed, transferred out",XSTAT="NT":"New, transferred in",1:"")
 I STAT]"" W STAT
 I XSTAT="R"!(XSTAT="C") W !!?9,"Released on " S Y=$P(^DVB(396.3,REQDA,0),U,14) X ^DD("DD") W Y," by " S RELBY=$P(^DVB(396.3,REQDA,0),U,15),RELBY=$S($D(^VA(200,+RELBY,0)):$P(^(0),U,1),1:"Unknown user") W RELBY,!
 I XSTAT="C" W "Printed by the RO on " S Y=$P(^DVB(396.3,REQDA,0),U,16) X ^DD("DD") W Y," by " S PRBY=$P(^DVB(396.3,REQDA,0),U,17),PRBY=$S($D(^VA(200,+PRBY,0)):$P(^(0),U,1),1:"Unknown user") W PRBY,!
 I STAT="" S STAT=$S(XSTAT="X":"Cancelled by MAS",XSTAT="RX":"Cancelled by RO",1:"Unknown") W STAT I STAT["Cancelled" W "  (Cancelled on " S CANDT=$P(^DVB(396.3,REQDA,0),U,19) W $E(CANDT,4,5)_"/"_$E(CANDT,6,7)_"/"_$E(CANDT,2,3),")"
 ;S X=$S($D(^DVB(396.3,REQDA,4)):$P(^(4),U,1),1:"") I X="y" W !,"Exam(s) transferred to another site -- see pending report.",!
 I $D(^DVB(396.3,REQDA,1)),$P(^(1),U,3)="Y" W !,"This request was faxed to the regional office.",!
 S FEXAM=$P(^DVB(396.3,REQDA,0),U,9) I FEXAM="Y" W !!,"*** Exams done on a FEE BASIS ***  ",! K FEXAM
 W ! F LINE=1:1:79 W "-"
 W ! D DDIS Q:$D(OUT)  D CON Q:$D(OUT)
 I IOST?1"P-".E,$Y>45 W @IOF D HDR
 W !!,"Other Disabilities:",!!?2,OTHDIS,! I $D(^DVB(396.3,REQDA,1)) W ?2,OTHDIS1,!?2,OTHDIS2
 W !!,"General Remarks:",!!
 K ^UTILITY($J,"W")
 F LINE=0:0 S LINE=$O(^DVB(396.3,REQDA,2,LINE)) Q:LINE=""  S X=^(LINE,0),DIWL=5,DIWR=75,DIWF="NW" D ^DIWP I IOST?1"C-".E,$Y>19 D CON W !!,"General Remarks, continued",!!!
 D ^DIWW
END K ANS I IOST?1"C-".E W !!,"Press [RETURN] to continue or ""^"" to stop   " R ANS:DTIME S:'$T!(ANS=U) OUT=1 I $D(OUT) Q:OUT=1
 Q
 ;
DDIS1 W ?2,DX,?37,$J(PCT,3,0)," %",?50,$S(SC=1:"Yes",1:"No"),?58,DXCOD,!
 I $Y>19 D CON
 Q
 ;
DDIS I $Y>12 D CON Q:$D(OUT)
 I '$D(^DPT(DFN,.372)) W !?25,"No rated disabilities on file",!! Q
 W !?2,"Rated Disability",?37,"Percent",?50,"SC ?",?58,"Dx Code",! W ?2 F LINE=1:1:63 W "-"
 W !!
 F JII=0:0 S JII=$O(^DPT(DFN,.372,JII)) Q:JII=""  S DXNUM=$P(^DPT(DFN,.372,JII,0),U,1),PCT=$P(^(0),U,2),SC=$P(^(0),U,3),DX=$S($D(^DIC(31,DXNUM)):$P(^(DXNUM,0),U,1),1:"Unknown"),DXCOD=$S($D(^DIC(31,DXNUM)):$P(^(DXNUM,0),U,3),1:"Unknown") D DDIS1
 W !!
 Q
 ;
HDR S PG=PG+1 W:(IOST?1"C-".E) @IOF
 W !,"Date: ",FDT(0),?(80-$L(PGHD)\2),PGHD,?71,"Page: ",PG W !,?(80-$L($$SITE^DVBCUTL4)\2),$$SITE^DVBCUTL4 I PG>1 W !!,"Name: ",PNAM,?44,"SSN: ",SSN,?63,"C-NUM: ",CNUM
 W ! F XLINE=1:1:80 W "="
 W ! Q

DVBCENQ2
DVBCENQ2 ;ALB ISC/THM-DISPLAY C&P APPOINTMENTS ; 8/13/90  7:02 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S DVBCLNE=" >>> Future C&P Appointments <<<" W ! D HDR
 ;
FA S CT=0 W ! I $O(^DPT(DFN,"S",DT-.1))="" W !!?23,"No future C & P appointments found.",!! G EXIT
 K PRT F FA=DT-.1:0 S FA=$O(^DPT(DFN,"S",FA)) Q:FA=""  S L=^(FA,0),C=+L S YY=$P(L,U,2) I YY'="N"&(YY'="C")&(YY'="NA")&(YY'="CA")&(YY'="PC")&(YY'="PCA") D FA1
 W:'$D(PRT) !!?23,"No future C&P appointments found.",!! G EXIT
 ;
FA1 S DVBCX=$P(^DPT(DFN,"S",FA,0),U,16) I $D(^SD(409.1,+DVBCX,0)) Q:$P(^(0),U,1)'["COMPENSATION"  ;compensation and pension exams only
 W !?0,$E(FA,4,5),"/",$E(FA,6,7),"/",$E(FA,2,3),$J(+$E(FA_"00",9,10)_":"_$E(FA_"0000",11,12),6),?16,$E($P($S($D(^SC(C,0)):^(0),1:""),"^"),1,23),"  " D CAL S PRT=1
 Q
 ;
EXIT K YY,CT,FA,L,C,DVBCX,DATE,DVBCLNE W !!! Q
 ;
CONT I IOST?1"C-".E W !!,"Press [RETURN] to continue  " R ANS:DTIME
 Q
 ;
HDR W ?(80-$L(DVBCLNE)\2),DVBCLNE,!!?0,"Date",?9,"Time",?16,"Clinic",?43,"  Lab",?56,"  X-Ray",?69,"  EKG",!?0 F I=0:1:79 W "-"
 Q
 ;
CAL F J=3:1:5 I $P(L,U,J)]"" S DATE(J)=$E($P(L,U,J),4,7),DATE(J)=$E(DATE(J),1,2)_"/"_$E(DATE(J),3,4)_" ",TIME(J)=$P($P(L,U,J),".",2) D CAL1
 Q
 ;
CAL1 S:TIME(J)=1 TIME(J)=10 S TIME(J)=$S($L(TIME(J))=2:TIME(J)_"00",$L(TIME(J))=3:TIME(J)_"0",1:TIME(J)),DATE(J)=DATE(J)_TIME(J)
 I $D(DATE(3)) S DATE(3)=$E(DATE(3),1,6)_$E(DATE(3),7,8)_":"_$E(DATE(3),9,10) W:$D(DATE(3)) ?42,DATE(3)
 I $D(DATE(4)) S DATE(4)=$E(DATE(4),1,6)_$E(DATE(4),7,8)_":"_$E(DATE(4),9,10) W:$D(DATE(4)) ?55,DATE(4)
 I $D(DATE(5)) S DATE(5)=$E(DATE(5),1,6)_$E(DATE(5),7,8)_":"_$E(DATE(5),9,10) W:$D(DATE(5)) ?68,DATE(5)
 I IOST?1"C-".E,$Y>18 D CONT,HDR
 I IOST?1"P-".E,$Y>45 D HDR
 K DATE,CONT
 Q

DVBCESCK
DVBCESCK ;ALB/GTS-557/THM-ESOPHAGUS EXAM ; 2/6/91  7:31 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0310 Worksheet" S HD7="ESOPHAGUS (DIGESTIVE)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"This area of examination is limited to conditions",!?13,"from mouth to the esophagogastric sphincter.",!!
 I '$D(CMBN) W "A. Medical history :",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Current weight -",!!!!!!?8,"2. Maximum weight, past year -",!!!!!!?8,"3. Anemia -",!!!!!!
 W ?8,"4. Disturbance of motility -",!!!!!!?8,"5. Actual partial obstruction (indicate frequency of dilatation",!,?39,"if required) -",!!!!!
 W ?8,"6. Reflux disturbances -",!!!!!! D:$D(CMBN) HD2 W ?8,"7. Presence of pain -",!!!!!!
 D:'$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCEXML
DVBCEXML ;ALB/GTS-557/THM-PRINT EXAM CHECKLIST FOR RO ; 5/16/91  1:52 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K ^TMP($J) D HOME^%ZIS S FF=IOF
 W @FF,!!,"Print Exam Checklist for the Regional Office",!!!
DEV S %ZIS="AEQ",%ZIS("A")="Output device: ",%ZIS("B")="0;P-OTHER" D ^%ZIS K %ZIS G:POP EXIT
 I IOM<132 W *7,!!,"A margin of 132 is required for this printout",!! H 2 G DEV
 I $D(IO("Q")) S ZTRTN="GO^DVBCEXML",ZTIO=ION,ZTDESC="Print Exam check list",ZTSAVE="" D ^%ZTLOAD W !!,"Request queued",!! H 2 G EXIT
 ;
GO U IO S HD="Regional Office Compensation and Pension Exam Form - "_$$SITE^DVBCUTL4,OLDEXM="",DVBCX=0 D HDR F A=0:0 S A=$O(^DVB(396.6,"C",A)) Q:A=""  F H=0:0 S H=$O(^DVB(396.6,"C",A,H)) Q:H=""  I $P(^DVB(396.6,H,0),U,5)'="I" D SORT
 S (A,NAME)="" F AA=0:0 S A=$O(^TMP($J,A)) Q:A=""  F X=0:0 S NAME=$O(^TMP($J,A,NAME)) Q:NAME=""  D PRINT
 W !!!,"** Remarks:",!
 ;
EXIT D:$D(ZTQUEUED) KILL^%ZTLOAD
 W @IOF,! K AA,NAME,ZTSK,H,DVBCX,A,OLDEXM,HD G KILL^DVBCUTIL
 ;
SORT S AA=$P(^DVB(396.7,A,0),U,1),^TMP($J,AA,$P(^DVB(396.6,H,0),U,1))=""
 Q
 ;
PRINT I OLDEXM'=A W:$Y>50 @IOF W:DVBCX=1 ! W !,"Body system: ",A,!! S DVBCX=0
 S OLDEXM=A I $Y>56 W @IOF
 I DVBCX=0 W ?0," (  )  ",$E(NAME,1,58) S DVBCX='DVBCX Q
 I DVBCX=1 W ?67," (  )  ",$E(NAME,1,58),! S DVBCX='DVBCX Q
 Q
 ;
HDR W @IOF,!?(IOM-$L(HD)\2),HD,!!!,"Veteran Name: ___________________________________________________   VAMC: _________________  C-number: ____________________",!!
 W "Date ordered: ____________   By: ________________________________________                         SSN: ____________________",!!!
 Q

DVBCFEE
DVBCFEE ;ALB/GTS-557/THM-FEE BASIS COVER SHEET ; 7/1/91  7:48 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 D HOME^%ZIS S FF=IOF
 ;
COPY W @IOF,!,"Print Cover Sheet for Fee Exam",!!!,"Number of copies: " R DVBCCOPY:DTIME G:'$T!(DVBCCOPY=U) EXIT
 I +DVBCCOPY<1!(+DVBCCOPY>10) W *7,!!,"You cannot print less than one or more than ten copies per session.",!! H 3 G COPY
 W !!,"Fee exam cover sheets should be sent to a printer." S %ZIS="AEQ",%ZIS("A")="Printing device: " D ^%ZIS K %ZIS G:POP EXIT
 I $D(IO("Q")) S ZTRTN="GO^DVBCFEE",ZTIO=ION,ZTDESC="Print C&P Fee Cover Sheet",ZTSAVE("DVBC*")="" D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! G EXIT
GO U IO F DVBCX=1:1:DVBCCOPY D GO1
 ;
EXIT D:$D(ZTQUEUED) KILL^%ZTLOAD K DVBCCOPY,DVBCX G KILL^DVBCUTIL
 ;
GO1 W:(IOST?1"C-".E) @IOF K ^UTILITY($J,"W") D ^DVBCLTR
 W !!!,?(IOM-$L($$SITE^DVBCUTL4)\2),$$SITE^DVBCUTL4,!!!!
 F ZZI=0:1 S LY=$T(TXT+ZZI) Q:LY["END"  S X=$P(LY,";;",2),DIWF="R",DIWR=80,DIWL=1 D ^DIWP
 D ^DIWW
 K LY,TXT W @IOF Q
 ;
TXT ;;Notice to the fee basis physician:
 ;;
 ;;
 ;;The nature of a Compensation and Pension examination is different from the
 ;;regular exam that you perform.  Unlike a regular examination where the
 ;;objective is to provide a diagnosis and a course of treatment, the C & P
 ;;examination is used to provide a diagnosis and assess the residual condition.
 ;;The payment of benefits, as determined by the VA Regional Office rating
 ;;board, is determined (in part) by your assessment of the Veteran's degree
 ;;of disability.
 ;;END

DVBCFSCK
DVBCFSCK ;ALB/GTS-557/THM-URETHRAL FISTULA ; 12/27/90  7:35 AM
 ;;2.7;AMIE;;Apr 10, 1995
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0630 Worksheet" S HD7="URETHRAL OR BLADDER FISTULA (GU)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Complications and/or medical side effects should always be",!?13,"reported, even when not specifically requested.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!!
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Number and location of fistulae -",!!!!!
 D:'$D(CMBN) HD2 W ?8,"2. Drainage constant or intermittent -",!!!!!?8,"3. Constant use of pad or appliance -",!!!!!?8,"4. Frequency of pad changing -",!!!!!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCFTCK
DVBCFTCK ;ALB/GTS-557/THM-FEET EXAM ; 2/4/91  7:40 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1415 Worksheet" S HD7="FEET (ORTHOPEDIC)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"The findings in each foot will be separately and carefully",!?13,"described, as this will affect the evaluation.  The nomenclature",!?13,"of toes for examination purposes will be the great toe, the second,",!
 W ?13,"third, fourth and fifth toes, named from the medial or inner side",!?13,"and which foot is being examined.  The functional loss should",!?13,"be related to the anatomical condition.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Posture (standing, squatting, supination, pronation and",!?22,"rising on toes and heels) -",!!!!!
 W ?8,"2. Appearance -",!!!!!?8,"3. Function -",!!!!!?8,"4. Deformity -",!!!!!?8,"5. Gait -",!!!!!?8,"6. Secondary skin and vascular changes -" D HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCGECK
DVBCGECK ;ALB/GTS-557/THM-GENITOURINARY, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For GENITOURINARY, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 0610 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: GENITOURINARY, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized genitourinary
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For GENITOURINARY, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCGMC1
DVBCGMC1 ;ALB ISC/THM-TEXT FOR GEN MED EXAM ; 5/21/91  9:47 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
PTXT F AW=0:1 S AX=$T(@TXT+AW) S AY=$P(AX,";;",2) W:AY="END" !! Q:AY="END"  W AY,!
 Q
 ;
TXT2 ;;(describe type, area, extent of lesions and
 ;;   report injuries, including burns in the MUSCULOSKELETAL section of this
 ;;   form):
 ;;END
 ;
TXT3 ;;(describe local or generalized adenopathy,
 ;;   enlargement, tenderness, suppuration blocking of lymphatic circulation,
 ;;   etc..):
 ;;END
 ;
TXT4 ;;(describe findings on inspection and palpation,
 ;;   enlargements, masses, tenderness or rigidity, hemorrhoids (internal/external
 ;;   fissures, bowel movements - control or lack of):
 ;;END
 ;
TXT5 ;;(describe type, location, size, whether complete, reducible, recurrent,
 ;;   supported by truss or belt, and whether operable):
 ;;END
 ;
TXT6 ;;(describe kidneys, bladder, frequency
 ;;   of urination and control or lack thereof, prostate, seminal
 ;;   vesicles, testes, cord, penis, and appendages; evidence of
 ;;   past or present venereal disease; for females report pelvic
 ;;   exam, if indicated):
 ;;END
 ;
TXT7 ;;   1. Diseases and injuries (include effect of gunshot wounds and other
 ;;      injuries on skin and underlying structures) -
 ;;
 ;;
 ;;
 ;;
 ;;   2. Scars (describe location, measurements, depression, type oftissue
 ;;      loss adherence, disfiguration and tenderness) -
 ;;
 ;;
 ;;
 ;;
 ;;   3. Functional effects (describe location, swelling, atrophy, tenderness,
 ;;      degree of limitation of flexion and extension, angle of fixation, fracture
 ;;      or disease, fibrous or bony residual and specify mechanical aid used and
 ;;      benefit) -
 ;;
 ;;
 ;;
 ;;
 ;;   4. Feet (describe objective evidence of pain at rest and on manipulation,
 ;;      rigidity, spasm, circulatory disturbance, swelling, callus, strength,
 ;;      mobility of ankles, feet, toes and limitation in degrees and indicate
 ;;      whether right or left, acquired or congenital) -
 ;;
 ;;
 ;;
 ;;
 ;;   5. Burns (indicate degree, shape and dimension, specifying inches
 ;;      or centimeters)-
 ;;
 ;;
 ;;END
TXT8 ;;   1. Neurological (describe motor status, coordination, reflexes, sensory
 ;;      status equilibrium and give level of lesion) -
 ;;
 ;;
 ;;
 ;;
 ;;   2. Psychiatric and Personality (describe behavior, comprehension,
 ;;      coherence of response, emotional reaction, orientation, memory, signs
 ;;      of tension and response as to social and industrial capacity) -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;   3. State whether the veteran is capable of managing his/her benefit payments
 ;;      in the individual's own best interests without restriction (a physicial
 ;;      disability which prevents the veteran from attending to financial
 ;;      matters in person is not proper basis for a finding of incompetency
 ;;      unless the veteran is, by reason of that disability, incapable of
 ;;      directing someone else in handling the individual's financial affairs) -
 ;;
 ;;
 ;;
 ;;
 ;;END
 ;
TXT9 ;;(describe cough, expectoration, mobility, palpation,
 ;;   percussion, and auscultation and specify the area as well as
 ;;   the veteran's tolerance for exercise, such as how far can he
 ;;   walk, how many flights of stairs can he climb, etc.):
 ;;END
 ;
TXT10 ;;In many cases, this general examination will be the only examination conducted.
 ;;Accordingly, it is vital that all significant functional deficits should
 ;;be identified and described, including, but not limited to, the body systems
 ;;and parts involved in the history and present complaints.  If the examiner deems
 ;;that additional special studies and/or examinations are necessary for proper
 ;;diagnosis and/or evaluation, specific recommendations should be made.
 ;;
 ;;Negative results may be summarized as "negative" or "normal".
 ;;END

DVBCGMCK
DVBCGMCK ;ALB/GTS-557/THM-GENERAL MEDICAL EXAM ; 5/16/91  2:20 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 K LINE S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
 S $P(LINE,"-",75)="-"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0505 Worksheet" S HD7="GENERAL MEDICAL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________"
 W !!,"Type of Exam: ",HD7,!!!!,"Narrative:",!!
 S TXT="TXT10" D PTXT W !!!,"A. Occupational history (List most current first):",!
 W LINE,!,"Name/Address of employer     Type      Monthly     Emp dates      Time lost",!,"(if unemployed, enter none)",?29,"Work      Wages       from/to        Last 12 mo",!!!
 W "1. ",$E(LINE,2,75),!!,"2. ",$E(LINE,2,75),!!,"3. ",$E(LINE,2,75),!!!,"State if time from employment was lost and give reasons.",!!!?3,$E(LINE,2,75),!!!,"B. Medical history (since last rating exam):",!
 D HD2 W "C. Present complaints (symptoms only, NOT diagnosis):",!!!!!!!!!!!!,"D. Examination data:",!!!!,"Height:",?25,"Weight:",?45,"Max wgt past year:",!!!
 W "Build and state of nutrition:",!!!,"Temperature:",?23,"Time:",?35,"AM/PM",?50,"Carriage:",!!!,"Posture:",?23,"Gait:",?45,"Right- or left-handed:",!?45,"(How determined)",!!!!!!
 W "E. Skin, including appendages " S TXT="TXT2" D PTXT,HD2 W "F. Lymphatic and hemic systems " S TXT="TXT3" D PTXT W !!!!!!!!!!,"G. Head, face and neck:",!!!!!!!!!!
 W "H. Nose, sinuses, mouth and throat (include gross dental findings):"
 W !! D HD2 W "I. Ears (describe canals, drums, perforations, discharge):",!!!!!!!!,"J. Eyes (describe external eye, pupil reaction, movements,",!
 W ?3,"field of vision, any uncorrectable refractive error or",!?3,"any retinopathy):",!!!!!!!!,"K. Cardiovascular system "
 W "(describe thrust, size, rhythm, sounds and condition",!,"   of peripheral vessels):",!!!!!!!!!!!!!!!?25,"Pulse",?39,"Blood pressure",?60,"Respiration",!,LINE,! S LNH="|            |                     |"
 W "Sitting",?21,LNH,!,LINE,!,"Recumbent",?21,LNH,!,LINE,!,"Standing",?21,LNH,!,LINE,!,"Sitting after exerc. ",LNH,!,LINE,!,"2 min after exercise ",LNH,!,LINE,! D HD2
 W "L. Varicose veins (describe location, size, extent, ulcers, scars, and",!,"   competency of deep circulation):",!
 W !!!!!!,"M. Respiratory system " S TXT="TXT9" D PTXT W !!!!!!!!!,"N. Digestive system " S TXT="TXT4" D PTXT W !!!!!!!!,"O. Hernia" S TXT="TXT5" D PTXT,HD2 W "P. Genito-urinary system " S TXT="TXT6" D PTXT W !
 W !!!!!!!!!,"Q. Musculo-skeletal system",!! S TXT="TXT7" D PTXT,HD2 W "R. Endocrine system (describe disease of thyroid, pituitary, adrenals",!?3,"gonads, other body systems affected, etc.):",!!!!!!!!
 W "S. Nervous system",!! S TXT="TXT8" D PTXT W !!!!!!!!!!,"T. Remarks:",!!!!!!!!!! D HD2 W "U. Other tests/exams recommended:",!!!!!!!!!!,"V. Diagnostic/clinical test results:",!!!!!!!!!
 W "W. Diagnosis:",!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 W !!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 W !!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 W !!!?16,"Reviewing Official: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2,LINE
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam "_HD8_" for ",!,NAME,!!!
 Q
 ;
PTXT D PTXT^DVBCGMC1
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCGNCK
DVBCGNCK ;ALB/GTS-557/THM-GYNECOLOGICAL EXAM ; 4/29/91  11:31 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs"
 S HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0705 Worksheet" S HD7="GYNECOLOGICAL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"An evaluation of the female reproductive system depends",!?13,"on a complete physical examination, a thorough medical",!
 W ?13,"history and all appropriate laboratory studies.",!!
 W:$D(CMBN) "Note: " I '$D(CMBN) W "A. Medical history "
 S TXT=$S($D(CMBN):"TXT1",1:"TXT2") F AW=0:1 S AX=$T(@TXT+AW) S AY=$P(AX,";;",2) W:AY="END" !! Q:AY="END"  W AY,!
 I '$D(CMBN) W !!!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!!!!!!!!!! D HD2
 W:$D(CMBN) !! W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):"
 W !!!?8,"1. Uterus",!!?11,"a. Removal of, complete/imcomplete (if incomplete,",!?14,"state if pregnancy is prevented) -",!!!!!!
 W ?11,"b. Prolapse of, complete through vulva/imcomplete -",!!!!!!?11,"c. Displacement of; also identify adhesions and irregular",!?14,"menstruation -",!!!!!!
 D:$D(CMBN) HD2 W ?8,"2. Ovaries",!!?11,"a. Removal of both -",!!!!!!?11,"b. Removal of one with or without partial removal",!?14,"of the other -",!!!!!!?11,"c. Atrophy of one or both ovaries, complete -",!!!!!!
 W ?8,"3. Rectal and rectovaginal; identify any surgical complications",!?11,"of pregnancy -",!!!!!! D:'$D(CMBN) HD2 W ?8,"4. If a malignant process has been present within the past year,",!
 W ?11,"give the date of the last surgical, radiation or chemical",!?11,"therapy -",!!!!!!
 W ?8,"5. If a tubercular or other mycobacterial infection has been treated",!?11,"within the past year, give the date of inactivity -",!!!!!!?8,"6. Has a voluntary sterilization procedure been performed? -",!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
TXT2 ;;(it is very important that in claims for establishing
 ;;service connection that the past medical history, menstrual history, marital
 ;;and pregnancy history and urinary history be as complete as possible):
 ;;END
 ;
TXT1 ;;In completing the medical history for the primary examination to
 ;;which this supplemental examination is attached, it is very important
 ;;that in claims for establishing service connection that the past medical
 ;;history, menstrual history, marital and pregnancy history and urinary
 ;;history be as complete as possible.
 ;;END

DVBCGOCK
DVBCGOCK ;ALB/GTS-557/THM-OTHER GENITOURINARY EXAM ; 12/7/90  8:43 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0625 Worksheet" S HD7="OTHER GENITOURINARY",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"In original claims, particularly pension cases, and in",!?13,"reopened claims in which the evidence on hand at the time",!?13,"the examination request is prepared does not establish the",!
 W ?13,"exact diagnosis, the nature of the disability will generally",!?13,"be expressed in the most general terms, usually in the veteran's",!?13,"own words (e.g. ""kidney condition"", ""bladder problem"",",!
 W ?13,"""can't hold water"", ""stones"", etc).  In such cases it is",!?13,"the responsibility of the general medical examiner to conduct",!?13,"or order to be conducted such special examinations as may be",!
 W ?13,"necessary, both to diagnose the underlying disorder, and",!?13,"to provide the information that the rating board must have to",!?13,"apply the examiner's findings to the rating schedule.  Once",!
 W ?13,"a definitive diagnosis is established, the examiner need only to",!?13,"report history, clinical findings, and laboratory tests for",!?13,"evaluation purposes.  Complications and/or medical side effects",!
 W ?13,"should always be reported, even when not specifically requested.",!!!!!!
 W "A. Medical History:  No medical history for this exam",!!!,"B. Subjective complaints:",! D HD2
 W "C. Objective findings:",!!!!!!!!!!!!!!!
 W "D. Diagnosis:",!!!!!!!!!!!!!!! D:$Y>50 HD2 W "E. Diagnostic/clinical test results:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control variables **
 D HOME^%ZIS
 Q

DVBCGSCK
DVBCGSCK ;ALB/GTS-557/THM-GYNECOLOGICAL, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For GYNECOLOGICAL, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 0710 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: GYNECOLOGICAL, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized gynecological
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For GYNECOLOGICAL, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCHACK
DVBCHACK ;ALB/GTS-557/THM-HYPERTHYROIDISM, THYROID ADENOMA ; 12/26/90  12:36 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0425 Worksheet" S HD7="HYPERTHYROIDISM, THYROID ADENOMA",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Mental assessment -",!!!!!!?5,"2.  Muscular weakness -",!!!!!!?5,"3.  Loss of weight -",!!!!!!
 W ?5,"4.  Thyroid enlargement -",!!!!!!?5,"5.  Nervous, cardiovascular or gastrointestinal symptoms -",!!!!!!
 W ?5,"6.  Elevated T4 and/or T3 readings -",!!!!!! D:$D(CMBN) HD2 W ?5,"7.  Disease in remission or demonstrably active -",!!!!!!?5,"8.  Marked disfigurement (including appearance and texture",!,?31,"of thyroidectomy scar, if present) -",!!!!!!
 D:'$D(CMBN) HD2 W ?5,"9.  Continuous medication required -",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
TXT ;
 ;;When symptoms interfere with normal daily activities or job
 ;;efficiency, it is essential that the extent of such handicaps
 ;;be described.
 ;;END

DVBCHDCK
DVBCHDCK ;ALB ISC/THM-HYPOTHYROIDISM ; 12/26/90  12:39 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0430 Worksheet" S HD7="HYPOTHYROIDISM",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Fatigability -",!!!!!!?5,"2.  Nervous, cardiovascular, or gastrointestinal symptoms -",!!!!!!?5,"3.  Decreased T4 and/or T3 readings -",!!!!!!
 W ?5,"4.  Mental assessment -",!!!!!!?5,"5.  Continuous medication required -",!!!!!!
 W ?5,"6.  Myxedema -",!!!!!! D:$D(CMBN) HD2 W ?5,"7.  Disease in remission or demonstrably active -",!!!!!! D:'$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;When symptoms interfere with normal daily activities or job
 ;;efficiency, it is essential that the extent of such handicaps
 ;;be described.
 ;;END

DVBCHECK
DVBCHECK ;ALB/GTS-557/THM-HEMATOLOGICAL, NOT ELSEWHERE CLASSIFIED ; 5/8/90  11:12 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For HEMATOLOGICAL, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 0810 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: HEMATOLOGICAL, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) Q:LY["END"  W $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized hematological
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;D. Evaluation information for the rating board:
 ;;
 ;;
 ;;    1)  State how the residual disability affects the earning capacity of the
 ;;        Veteran in job performance.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  State how the residual disability affects normal everyday activities.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  State if the disability has constant activity or give any periods
 ;;        of remission during the year.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If there are acute exacerbations, state the effect on everyday
 ;;        life.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For HEMATOLOGICAL, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCHLCK
DVBCHLCK ;ALB/GTS-557/THM-HEMATOLOGIC DISORDERS-LYMPHATIC ; 2/6/91  7:53 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0810 Worksheet" S HD7="HEMATOLOGIC DISORDERS-LYMPHATIC",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"As with other disorders, a careful history and complete",!?13,"physical examination are of first importance in hematologic",!?13,"disorders.  However, laboratory evaluation is often necessary",!?13,"for a definitive diagnosis.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. State whether the disease is currently active or in remission and",!?11,"if in remission, whether maintenance chemotherapy is required -",!!!!!?8,"2. Describe frequency and duration of acute attacks -",!!!!!
 W ?8,"3. Describe the state of general health between acute attacks -",!!!!!?8,"4. If the veteran is, or has been receiving chemotherapy, X-Ray or",!?11,"surgical treatment for Hodgkin's disease or other form of lymphoma,",!
 W ?11,"give date of last treatment -",!!!!!?8,"5. If veteran has been treated for any tuberculous adenitis (or",!
 W ?11,"adenitis due to any other mycobacterial infection) and the disease",!?11,"is currently inactive, give date the inactivity was first shown -",!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCHLOR
DVBCHLOR ;ALB/JLU-Routine to build an order message ;1/28/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
BEG(DVBCPDFN,DVBCRDFN,DVBCEXAM,DVBCOC,HLDAP) ;
 ;when entering this routine the following variables must be set.
 ;DVBCPDFN - Patient DFN
 ;DVBCRDFN - Request DFN
 ;DVBCEXAM - Exam DFN
 ;DVBCOC   - Order Control "NEW" for a new order or "CANCEL" to cancel
 ;           an order.
 ;HLDAP    - name or IFN of entry in file #771 (the DHCP application)
 ;
 N DVBCERR
 S DVBCERR=1
 D INITIAL
 I '$D(HLERR) D
 .D PID^DVBCHLUT
 .D ORC^DVBCHLUT
 .D OBR^DVBCHLUT
 .Q
 D FILE
 D EXIT
 Q DVBCERR
 ;
INITIAL ;sets up necessary variables
 ;will need HLDAP equal to name or internal entry number in file #771
 D INIT^HLTRANS Q:$D(HLERR)
 S DFN=DVBCPDFN
 D DEM^VADPT
 I VAERR!VADM(1)']"" S HLERR="Invalid Patient name or DFN"
 S DVBCSEG=1,DVBCPLCR=1
 S DVBCRQDT=$P(^DVB(396.3,DVBCRDFN,0),U,2)
 S DVBCEXTY=$P(^DVB(396.4,DVBCEXAM,0),U,3)
 S DVBCEXTY=$P(^DVB(396.6,DVBCEXTY,0),U,1)
 S DVBCOC=$S(DVBCOC="NEW":"NW",DVBCOC="CANCEL":"CA",1:"")
 Q
 ;
FILE ;builds and send the HL7 message
 I '$D(HLERR) S HLMTN="ORM" D EN^HLTRANS
 I $D(HLERR) S DVBCERR=HLERR
 Q
 ;
EXIT ;
 D KILL^HLTRANS
 K HLDA,HLDT,HLDT1,DFN,DVBC1,DVBCOC,DVBCEXTY,DVBCPDFN,DVBCPLCR,DVBCRQDT,DVBCSEG,VA,VADM,VAERR
 Q

DVBCHLQ
DVBCHLQ ;ALB/JLU-Processing HL7 Query message 1 of 2 routines ;1/28/93
 ;;2.7;AMIE;;Apr 10, 1995
BEG ;Main entry point for this routine.
 D START
 D CHKIND:'$D(DVBCERR)
 D QRD:'$D(DVBCERR)
 D ACK
 D EXIT
 Q
 ;
EXIT K DFN,DVBC,DVBC1,DVBCARY,DVBCERR,DVBCEXAM,DVBCEXTY,DVBCNT,DVBCNT1,DVBCPDFN,DVBCQRD,DVBCRDFN,DVBCRQDT,DVBCSRX,DVBCSSN,VADM,VAERR,DVBCSEG
 Q
 ;
START ;This subroutine will check the segment type for QRD
 K DVBCERR
 S DVBCSEG=4,DVBCNT=0
 S DVBCARY=^HL(772,HLDA,"IN",2,0)
 S DVBCQRD=DVBCARY ;using naked from start+3
 I $P(DVBCQRD,HLFS,1)'="QRD" S DVBCERR="Invalid Segment Type" Q
 Q
 ;
CHKIND ;Checking for the requestor's DUZ
 I $S('$D(HLDUZ):1,HLDUZ']"":1,1:0) S DVBCERR="Not a valid DHCP user number."
 Q
 ;
QRD ;This subroutine is to break apart the QRD segment of a query
 S DVBCNT1=$P($P(DVBCQRD,HLFS,8),$E(HLECH),1) ;gets the max number to return
 S:$P(DVBCQRD,HLFS,11)="PATIENT" DVBCSSN=$P(DVBCQRD,HLFS,9)
 DO
 .I '$D(DVBCSSN) S DVBCERR="Invalid Patient ID, No SSN" Q  ;undefined ssn
 .I (DVBCSSN'?9N),(DVBCSSN'?9N1A),(DVBCSSN'?1A4N) S DVBCERR="Invalid Patient ID, Wrong SSN Format" Q  ;ssn format
 .D SSN
 .Q
 Q
 ;
SSN ;Checking the existence of the patient with ssn
 S:$E(DVBCSSN)?1L DVBCSSN=$C($A($E(DVBCSSN))-32)_$E(DVBCSSN,2,5) ;lower to uppercase letter
 S DVBCSRX=$S(DVBCSSN?1U4N:"BS5",1:"SSN") ;getting correct x-ref
 I $L(DVBCSSN)=10 S:$E(DVBCSSN,10,10)?1L DVBCSSN=$E(DVBCSSN,1,9)_$C($A($E(DVBCSSN,10,10))-32) ;lowercase to uppercase
 S DVBCPDFN=$O(^DPT(DVBCSRX,DVBCSSN,0))
 DO
 .I 'DVBCPDFN S DVBCERR="Invalid Patient Identifier" Q
 .I $O(^DPT(DVBCSRX,DVBCSSN,DVBCPDFN)) S DVBCERR="Ambiguous Patient identifier" Q
 .S DVBCRDFN=$O(^DVB(396.3,"B",DVBCPDFN,0))
 .I 'DVBCRDFN S DVBCERR="No 2507 request on file for this Patient" Q
 .K VADM,VAERR S DFN=DVBCPDFN D DEM^VADPT I VAERR S DVBCERR="Invalid Patient Identifier" Q
 .I VADM(1)']"" S DVBCERR="Invalid Patient identifier" Q
 .D CHKREQ
 .Q
 Q
 ;
CHKREQ ;Checks for an open exam
 N ENTRY1,DVBCEXN,DVBCSTAT
 F DVBCEXN=0:0 S DVBCEXN=$O(^DVB(396.4,"APS",DVBCPDFN,DVBCEXN)) Q:'DVBCEXN!(DVBCNT=DVBCNT1)  D
 .S (DVBCEXAM,DVBCSTAT)=""
 .F  S DVBCSTAT=$O(^DVB(396.4,"APS",DVBCPDFN,DVBCEXN,DVBCSTAT)) Q:DVBCSTAT=""  D
 ..I DVBCSTAT="O" S DVBCEXAM=$O(^DVB(396.4,"APS",DVBCPDFN,DVBCEXN,DVBCSTAT,DVBCEXAM)) D
 ...S ENTRY1=$P(^DVB(396.4,DVBCEXAM,0),"^",2)
 ...I "PS"]$P(^DVB(396.3,ENTRY1,0),"^",18) D SET
 I 'DVBCNT S DVBCERR="No Exams or Open Exams on file for this Patient"
 Q
 ;
ACK ;builds new QRD and MSA to send back to requestor
 S:'$D(DVBCERR) $P(HLSDATA(1),HLFS,9)="ORF"
 I $D(DVBCERR) S DVBC=HLSDATA(1) K HLSDATA S HLSDATA(1)=DVBC
 S HLSDATA(2)="MSA"_HLFS_$S($D(DVBCERR):"AE",1:"AA")_HLFS_HLMID_$S($D(DVBCERR):HLFS_DVBCERR,1:"")
 S HLSDATA(3)=DVBCQRD
 S $P(HLSDATA(3),HLFS,8)=DVBCNT_$E(HLECH)_"RD"
 I $D(HLTRANS) D EN1^HLTRANS
 Q
 ;
SET ;calls the subroutines to set PID and OBR
 S DVBCRDFN=$P(^DVB(396.4,DVBCEXAM,0),U,2)
 S DVBCRQDT=$P(^DVB(396.3,DVBCRDFN,0),U,2)
 S DVBCEXTY=$P(^DVB(396.6,DVBCEXN,0),U,1) ;gets exam type
 D PID^DVBCHLUT
 K DVBCPLCR ; this is an OBR filler for the next line
 D OBR^DVBCHLUT
 S DVBCNT=DVBCNT+1
 Q

DVBCHLR
DVBCHLR ;ALB/JLU-Processes the results from the ORU ;1/28/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
BEG D INIT
 F  D @$S(DVBCX="PID"&'$D(HLERR):"PID",DVBCX="OBR"&'$D(HLERR):"OBR",DVBCX="OBX"&'$D(HLERR):"OBX",1:"ACK") Q:DVBCX="QUIT"
 D EXIT
 Q
 ;
EXIT K %,DA,DFN,DIE,DR,DVBC,HLERR,DVBCNT2,DVBCOBR,DVBCOBX,DVBCOBXV,DVBCPAT,DVBCPDFN,DVBCPID,DVBCRPDT,DVBCSAV,DVBCSSN,DVBCUEX,DVBCUEXT,DVBCUNIV,DVBCURQ,DVBCX,DVBCX1,DVBX,VADM,VAERR,DVBCEXAM,DVBCST,DVBCELCT,DVBCUEX1
 Q
 ;
INIT ;initializes and checks variables
 S DVBCX="PID",DVBC=1
 I '$D(HLESIG) S HLERR="No Electronic Signature code present, updating cannot be allowed."
 I $S('$D(HLDUZ):1,HLDUZ']"":1,1:0) S HLERR="Not a valid DHCP user number."
 Q
 ;
PID ;Brake apart the PID section
 K HLERR,DVBCPID,DVBCSSN,DVBCPDFN,DVBCPAT,DFN,VAERR,VADM
 S DVBC=$O(^HL(772,HLDA,"IN",DVBC))
 I 'DVBC S HLERR="Missing PID Segment" Q
 S DVBCPID=^(DVBC,0) ;NAKE FROM ^HL(772,HLDA,IN  PID+2
 I $P(DVBCPID,HLFS,1)'="PID" S HLERR="Incorrect PID Segment indicator" Q
 I $P(DVBCPID,HLFS,4)']"" S HLERR="Internal Patient ID Missing" Q
 I $P(DVBCPID,HLFS,6)']"" S HLERR="Patient Name Invalid" Q
 I $P(DVBCPID,HLFS,20)']"" S HLERR="Patient SSN Invalid" Q
 S DVBCSSN=$P(DVBCPID,HLFS,20)
 S DVBCPDFN=+$P(DVBCPID,HLFS,4)
 S DVBCPAT=$$FMNAME^HLFNC($P(DVBCPID,HLFS,6))
 S DFN=DVBCPDFN
 D DEM^VADPT
 I VAERR S HLERR="Incorrect Patient Identifier" Q
 I DVBCSSN'=$P(VADM(2),U,1) S HLERR="Invalid SSN" Q
 S DVBCX="OBR"
 Q
 ;
OBR ;Parsing the OBR segment.
 K DVBCOBR,DVBCUNIV
 F  S DVBC=$O(^HL(772,HLDA,"IN",DVBC)) Q:DVBC=""  S DVBCOBR=^(DVBC,0) Q:$P(DVBCOBR,HLFS,1)="OBR"
 I DVBC="" S HLERR="Missing OBR Segment" Q
 I $P(DVBCOBR,HLFS,5)']"" S HLERR="Missing Universal Identifier" Q
 I $P(DVBCOBR,HLFS,21)']"" S HLERR="Missing Exam Type" Q
 I $P(DVBCOBR,HLFS,23)']"" S HLERR="Missing Report Date" Q
 S DVBCUNIV=$P(DVBCOBR,HLFS,5)
 S DVBCUEXT=$P(DVBCOBR,HLFS,21)
 S DVBCRPDT=$$FMDATE^HLFNC($P(DVBCOBR,HLFS,23))
 S DVBCURQ=$P(DVBCUNIV,$E(HLECH),1)
 S DVBCUEX=$P(DVBCUNIV,$E(HLECH),2)
 I '$D(^DVB(396.3,DVBCURQ,0)) S HLERR="Request No longer Exists" Q
 I "PS"'[$P(^(0),U,18) S HLERR="Status of Request will not allow for down loading" Q  ;NAKED FROM LINE BEFORE
 I '$D(^DVB(396.4,DVBCUEX,0)) S HLERR="Exam No longer Exists" Q
 S DVBCUEX1=^DVB(396.4,DVBCUEX,0)
 I "RXT"[$P(DVBCUEX1,U,4) S HLERR="Exam status not open, no down loading allow* ed" Q
 D HASH^DVBCHLUT
 I '$D(DVBCELCT) S HLERR="Bad electronic signature code." Q
 I $P(DVBCUEX1,U,4)="C",$P(DVBCUEX1,U,10)'=DVBCELCT S HLERR="Electronic signature codes do not match, no down loading allowed" Q
 S DVBCX="OBX"
 Q
 ;
OBX ;looping through the OBX segment
 K DVBCSAV
 S DVBCNT2=0,DVBCSAV=DVBC
 I '$$LOCK^DVBCHLUT(DVBCURQ,DVBCUEX) Q
 D DEL
 F  S DVBC=$O(^HL(772,HLDA,"IN",DVBC)) S:DVBC="" DVBCX="ACK" Q:DVBC=""  S DVBCOBX=^(DVBC,0) D OBX1 Q:DVBCX'="OBX"  S DVBCSAV=DVBC
 S DVBC=DVBCSAV
 I 'DVBCNT2 S HLERR="Invalid OBX Segment" D UNLOCK^DVBCHLUT(DVBCURQ,DVBCUEX) Q
 I DVBCNT2 D CLOSE
 D UNLOCK^DVBCHLUT(DVBCURQ,DVBCUEX)
 Q
 ;
OBX1 ;
 S DVBCOBXV=$P(DVBCOBX,HLFS,1)
 I DVBCOBXV="NTE" Q
 I $S(DVBCOBXV="PID":1,DVBCOBXV="OBR":1,1:0) S DVBCX=DVBCOBXV Q
 I DVBCOBXV'="OBX" S DVBCX="ACK" Q
 S DVBCNT2=DVBCNT2+1
 S ^DVB(396.4,DVBCUEX,"RES",DVBCNT2,0)=$P(DVBCOBX,HLFS,6)
 Q
 ;
CLOSE ;sets exam fields and quits
 D NOW^%DTC
 S ^DVB(396.4,DVBCUEX,"RES",0)="^^"_DVBCNT2_"^"_DVBCNT2_"^"_%
 S DIE="^DVB(396.4,",DA=DVBCUEX
 S DR=".04///C;.06///"_DVBCRPDT_";.07///"_$P(^VA(200,HLDUZ,0),U,1)_";.1///"_DVBCELCT
 D ^DIE
 S DVBCEXAM=^DVB(396.4,DVBCUEX,0)
 I $P(DVBCEXAM,U,4)'="C"!($P(DVBCEXAM,U,6)']"")!$P(DVBCEXAM,U,7)']"" S HLERR="Results added but request and exam status not updated." Q
 D COMPL
 Q
 ;
ACK ;setting up the acknowledgment segment.
 I $D(HLERR) S DVBCX1=HLSDATA(1) K HLSDATA S HLSDATA(1)=DVBCX1
 S HLSDATA(2)="MSA"_HLFS_$S($D(HLERR):"AE",1:"AA")_HLFS_HLMID_HLFS_$S($D(HLERR):HLERR,1:"")
 S DVBCX="QUIT"
 I $D(HLTRANS) D EN1^HLTRANS
 Q
 ;
COMPL ;This subroutine will search the other exams and set the request's
 ;status to transcribed if able.
 ;This should become a callable subroutine because ^dvbcedit does the same
 ;
 K DVBCOPN
 F DVBC=0:0 S DVBC=$O(^DVB(396.4,"C",DVBCURQ,DVBC)) Q:'DVBC  S DVBCST=$P(^DVB(396.4,DVBC,0),U,4) I DVBCST="O"!(DVBCST="T") S DVBCOPN=1 Q
 Q:$D(DVBCOPN)
 S XMDUZ="Kurzweil"
 S XMB="DVBA C 2507 EXAM READY"
 S XMB(1)=DVBCPAT,XMB(2)=DVBCSSN
 S Y=$P(^DVB(396.3,DVBCURQ,0),U,2)
 X ^DD("DD")
 S XMB(3)=Y
 D ^XMB
 K XMDUZ,XMB,Y
 S DIE="^DVB(396.3,",DA=DVBCURQ
 S DR="11///NOW;17////T"
 D ^DIE
 I $P(^DVB(396.3,DVBCURQ,0),U,12)']""!($P(^(0),U,18)'="T") S HLERR="Results added and exam status updated but request status not updated."
 Q
 ;
DEL ;to delete the results from an exam if it is being resent.
 I $P(DVBCUEX1,U,10)]"" K ^DVB(396.4,DVBCUEX,"RES")
 Q

DVBCHLUT
DVBCHLUT ;ALB/JLU-Utility routine for the HL7 interface ;1/28/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
OBR ;sets up the OBR segment
 ;called by DVBCHLQ and DVBCHLOR
 S $P(DVBC1,HLFS,23)=""
 S $P(DVBC1,HLFS,1)="OBR"
 S $P(DVBC1,HLFS,5)=DVBCRDFN_$E(HLECH)_DVBCEXAM_$E(HLECH)_"L" ;ifn of request^ifn of exam^L
 S $P(DVBC1,HLFS,8)=$$HLDATE^HLFNC(DVBCRQDT) ;request date
 S $P(DVBC1,HLFS,9)=HLQ ;unused required
 S $P(DVBC1,HLFS,10)=HLQ ;unused required
 S $P(DVBC1,HLFS,15)=HLQ ;unused required
 S $P(DVBC1,HLFS,$S($D(DVBCPLCR):19,1:21))=DVBCEXTY ;exam type
 S $P(DVBC1,HLFS,23)=HLDT1 ;time results reported
 S HLSDATA(DVBCSEG)=DVBC1
 S DVBCSEG=DVBCSEG+1
 K DVBC1
 Q
 ;
PID ;setting up PID segment
 ;called by DVBCHLQ and DVBCHLOR
 S $P(DVBC1,HLFS,20)=""
 S $P(DVBC1,HLFS,1)="PID"
 S $P(DVBC1,HLFS,4)=$$M10^HLFNC(DVBCPDFN) ;internal patient id
 S $P(DVBC1,HLFS,6)=$$HLNAME^HLFNC(VADM(1)) ;patient name
 S $P(DVBC1,HLFS,8)=$$HLDATE^HLFNC(VADM(3)) ;dob
 S $P(DVBC1,HLFS,9)=$S(VADM(5)]"":$P(VADM(5),U,1),1:"U") ;sex
 S $P(DVBC1,HLFS,11)=$S(+VADM(8)=1!(+VADM(8)=2):"H",+VADM(8)=3:"A",+VADM(8)=4:"B",+VADM(8)=5:"R",+VADM(8)=6:"C",1:HLQ) ;setting ethnic group
 S $P(DVBC1,HLFS,20)=$P(VADM(2),U,1) ;ssn
 S HLSDATA(DVBCSEG)=DVBC1
 S DVBCSEG=DVBCSEG+1
 K DVBC1
 Q
 ;
ORC ;builds the ORC segment
 S $P(DVBC1,HLFS,10)=""
 S $P(DVBC1,HLFS,1)="ORC"
 S $P(DVBC1,HLFS,2)=DVBCOC ;control order for new orders
 S $P(DVBC1,HLFS,10)=HLDT1
 S HLSDATA(DVBCSEG)=DVBC1
 S DVBCSEG=DVBCSEG+1
 K DVBC1
 Q
 ;
LOCK(A,B) ;
 ;this function tries to lock the 396.3 and 396.4 records
 L +^DVB(396.3,A):2
 I '$T S HLERR="Record currently accessed by another user" D UNLOCK(A,B) Q 0
 L +^DVB(396.4,B):2
 I '$T S HLERR="Exam currently being accessed by another user" D UNLOCK(A,B) Q 0
 Q 1
 ;
UNLOCK(A,B) ;
 ;this subroutine unlocks the 396.3 and 396.4 records
 L -^DVB(396.3,A)
 L -^DVB(396.4,B)
 Q
 ;
HASH ;hashes the electronic signature code
 Q:'$D(HLESIG)
 N X,X1,X2
 S X=HLESIG,X1=HLDUZ,X2=DVBCUEX
 D EN^XUSHSHP
 S DVBCELCT=X
 Q
 ;

DVBCHMC1
DVBCHMC1 ;ALB ISC/THM-TEXT FOR HEMATOLOGIC DISORDERS ; 12/9/90  11:16 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
PTXT F AW=0:1 S AX=$T(@TXT+AW) S AY=$P(AX,";;",2) W:AY="END" !! Q:AY="END"  W AY,!
 Q
 ;
TXT1 ;;   1.  Note whether disease is currently active or in remission -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;   2.  Note frequency of and average duration of acute attacks or sickling
 ;;       crises -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;   3.  Note level of physical activity the veteran is capable of between acute
 ;;       attacks/sickling crises and describe the state of general health between
 ;;       episodes -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;   4.  Note whether sickling crises have produced any permanent organ or joint
 ;;       impairment (e.g., splenic infarct or aseptic neurosis of femoral head)
 ;;       and whether splenectomy or joint replacement has been necessary -
 ;;END

DVBCHMCK
DVBCHMCK ;ALB/GTS-557/THM-HEMATOLOGIC DISORDERS-BLOOD ; 12/9/90  11:26 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0805 Worksheet" S HD7=" HEMATOLOGIC DISORDERS - BLOOD",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"As with other disorders, a careful history and complete",!?13,"physical examination are of first importance in hematologic",!?13,"disorders; however, laboratory evaluation is often necessary",!?13,"for a definitive diagnosis.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 S TXT="TXT1" D PTXT^DVBCHMC1
 D HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7," for ",!,NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCHNCK
DVBCHNCK ;ALB/GTS-557/THM-HAND,THUMB, FINGER ; 12/10/90  1:39 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1420 Worksheet" S HD7="HAND, THUMB, AND FINGERS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"The hand should be evaluated as a unit intricately adapted",!?13,"for grasping, pushing, pulling, twisting, probing, writing,",!?13,"touching, and expression.  Do not designate fingers numerically;",!?13,"use thumb, index, "
 W "middle, ring and little.  Specify which hand is",!?13,"involved and state whether the individual is right or left-handed."
 W !?13,"Designate the joints as wrist, MP (metacarpophalangeal), PIP,",!?13,"(proximal interphalangeal) or DIP (distal interphalangeal).",!?13,"Designate phalanges as proximal, middle or distal.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2 W !!
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!?8,"1. Anatomical defects -",!!!!!!!
 W ?8,"2. Functional defects (motion of thumb and fingers should be described",!?11,"as to how near, in inches, the tip of thumb can approximate the",!?11,"fingers, or how near the tips of fingers can "
 W "approximate the median",!?11,"transverse fold of the palm.) -",!!!!!!!!!!?8,"3. Grasping objects (strength and dexterity) -",!!!!!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:'$D(CMBN) HD2
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCHPCK
DVBCHPCK ;ALB/GTS-557/THM-HIP EXAM ; 5/19/91  1:02 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1425 Worksheet" S HD7="HIP",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Loss of range of motion of the hip will be recorded from",!?13,"the anatomical position (0 degrees) varying from 125 degrees",!
 W ?13,"in flexion to 30 degrees in extension, from 25 degrees in",!?13,"adduction to 45 degrees "
 W "in abduction, and from 60 degrees in",!?13,"external rotation to 40 degrees in internal rotation.  To gain",!?13,"a true picure of hip flexion, i.e. movement between the pelvis",!
 W ?13,"and femur in the hip joint, the opposide thigh should be",!,?13,"extended to minimize motion between the pelvis and spine.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!! W "C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!
 W ?5,"1. Describe movements of the thigh as it may rotate",!?8,"in a circular manner about the femoral head in the "
 W !?8,"acetabulum.  Discuss any pain, tenderness, weakness",!?8,"and fatigue on standing and any unusual motions on ",!?8,"walking -",!!!!!!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCHS0
DVBCHS0 ;ALB/JRP - C & P EXTRACT FOR HEALTH SUMMARY;11-JAN-95
 ;;2.7;AMIE;;Apr 10, 1995
HSCP(PATPTR,INVBEGDT,INVENDDT,OUTCODE,ARRAY) ;MAIN ENTRY POINT
 ;INPUT  : PATPTR - Pointer to PATIENT file (#2)
 ;         INVBEGDT - Beginning date in inverse FileMan format
 ;                  - Defaults to one year before today
 ;         INVENDDT - Ending date in inverse FileMan format
 ;                  - Defaults to today
 ;         OUTCODE - Flag indicating which optional nodes to return
 ;                 0 = Do not return any optional nodes
 ;                 1 = Node 1 should also be returned
 ;                 2 = Node 2 should also be returned
 ;                 3 = Nodes 1 & 2 should also be returned (default)
 ;         ARRAY - Where to store output (full global reference)
 ;               - Defaults to ^TMP("DVBC",$J)
 ;
 ;OUTPUT : None
 ;      ARRAY(InvExDt,Type,0) = Code ^ DATE OF EXAM [.06]
 ;            ^ EXAM TYPE [.03] ^ EXAMINING PHYSICIAN [.07]
 ;            ^ PRIORITY OF EXAM [396.3;9]
 ; -->  ARRAY(InvExDt,Type,1) = ROUTING LOCATION [396.3;24]
 ;            ^ OWNER DOMAIN [396.3;28] ^ TRANSFERRED OUT TO [62]
 ; -->  ARRAY(InvExDt,Type,2) = REQUEST STATUS [396.3;17]
 ;            ^ APPROVED BY [396.3;25] ^ APPROVAL DATE/TIME [396.3;26]
 ;      ARRAY(InvExDt,Type,"RES",0) = Number of lines in EXAM RESULTS
 ;      ARRAY(InvExDt,Type,"RES",X) = Line X of EXAM RESULTS [70]
 ;
 ;   Subscripts:
 ;     InvExDt - Inverse FileMan date of DATE OF EXAM [.06]
 ;     Type - Poiner value of EXAM TYPE [.03]
 ;
 ;   Code used as follows:
 ;     1 = Exam was performed locally
 ;     2 = Exam was performed by another facility
 ;     3 = Exam was performed locally for another facility
 ;
 ;   All dates will be in the FileMan format
 ;
 ;   With the exception of dates, 'N/A' (not applicable) and 'UNKNOWN'
 ;   will be used for field values when appropriate
 ;
 ;   Optional nodes are marked by an arrow (-->)
 ;
 ;NOTES  : Output array will be initialized (KILLed)
 ;       : Information for an exam is only returned when
 ;           1. The exam status is COMPLETED
 ;           2. The status of the request containing the exam is
 ;              a) RELEASED TO RO, NOT PRINTED
 ;              b) COMPLETED, PRINTED BY RO
 ;              c) COMPLETED, TRANSFERRED OUT
 ;
 ;
 ;CHECK INPUT/SET DEFAULTS
 Q:('$D(^DPT((+$G(PATPTR)),0)))
 S INVBEGDT=+$G(INVBEGDT)
 S:('INVBEGDT) INVBEGDT=9999999-(DT-10000)
 S INVENDDT=+$G(INVENDDT)
 S:('INVENDDT) INVENDDT=9999999-DT
 S OUTCODE=$G(OUTCODE)
 S:((OUTCODE="")!(OUTCODE>3)!(OUTCODE<0)) OUTCODE=3
 S:($G(ARRAY)="") ARRAY="^TMP(""DVBC"",$J)"
 ;KILL OUTPUT ARRAY
 K @ARRAY
 ;DECLARE VARIABLES
 N BEGDATE,ENDDATE,TYPEPTR,EXAMPTR,TMP,NODE0
 ;CONVERT INVERSE DATES TO NORMAL DATES
 S BEGDATE=9999999-INVBEGDT
 S ENDDATE=9999999-INVENDDT
 ;NO EXAMS ON FILE
 Q:('$D(^DVB(396.4,"APS",PATPTR)))
 ;LOOK FOR COMPLETED EXAMS
 S TYPEPTR=0
 F  S TYPEPTR=+$O(^DVB(396.4,"APS",PATPTR,TYPEPTR)) Q:('TYPEPTR)  D
 .S EXAMPTR=0
 .F  S EXAMPTR=+$O(^DVB(396.4,"APS",PATPTR,TYPEPTR,"C",EXAMPTR)) Q:('EXAMPTR)  D
 ..;GET ZERO NODE OF EXAM
 ..S NODE0=$G(^DVB(396.4,EXAMPTR,0))
 ..;MAKE SURE EXAM IS WITHIN DATE RANGE
 ..S TMP=+$P(NODE0,"^",6)
 ..Q:(('TMP)!(TMP<BEGDATE)!(TMP>ENDDATE))
 ..;MAKE SURE REQUEST CONTAINING EXAM HAS BEEN RELEASED
 ..S TMP=+$P(NODE0,"^",2)
 ..Q:('TMP)
 ..S TMP=$P($G(^DVB(396.3,TMP,0)),"^",18)
 ..Q:((TMP'="C")&(TMP'="R")&(TMP'="CT"))
 ..;SET NODE ZERO OF OUTPUT
 ..D OUT0^DVBCHS1(EXAMPTR,ARRAY)
 ..;SET NODE 'RES' OF OUTPUT
 ..D OUTRES^DVBCHS1(EXAMPTR,ARRAY)
 ..Q:('OUTCODE)
 ..;SET NODE ONE OF OUTPUT (OPTIONAL)
 ..D:((OUTCODE=1)!(OUTCODE=3)) OUT1^DVBCHS2(EXAMPTR,ARRAY)
 ..;SET NODE TWO OF OUTPUT (OPTIONAL)
 ..D:((OUTCODE=2)!(OUTCODE=3)) OUT2^DVBCHS2(EXAMPTR,ARRAY)
 Q

DVBCHS1
DVBCHS1 ;ALB/JRP - C & P EXTRACT FOR HEALTH SUMMARY (CONT);11-JAN-95
 ;;2.7;AMIE;;Apr 10, 1995
OUT0(PTR,ARR) ;SET NODE ZERO OF OUTPUT
 ;INPUT  : PTR - Pointer to 2507 EXAM file (#396.4)
 ;         ARR - Where to place output (full global reference)
 ;OUTPUT : None
 ;         See HSCP() for format of output array
 ;NOTES  : All input is assumed to exist (no error checking)
 ;
 N CODE,FMDATE,TYPE,DOCTOR,PRIORITY
 N INVDATE,NODE,REQPTR,TYPEPTR,TMP
 ;GET ZERO NODE OF 2507 EXAM
 S NODE=$G(^DVB(396.4,PTR,0))
 ;GET INFO OFF OF NODE
 S REQPTR=+$P(NODE,"^",2)
 S TYPEPTR=+$P(NODE,"^",3)
 S FMDATE=+$P(NODE,"^",6)
 S DOCTOR=$P(NODE,"^",7)
 S:(DOCTOR="") DOCTOR="UNKNOWN"
 ;GET PRIORITY FROM ZERO NODE OF 2507 REQUEST
 S NODE=$G(^DVB(396.3,REQPTR,0))
 S TMP=$P(NODE,"^",10)
 ;CONVERT PRIORITY TO EXTERNAL FORMAT
 S PRIORITY="UNKNOWN"
 S:(TMP="T") PRIORITY="TERMINAL"
 S:(TMP="P") PRIORITY="POS"
 S:(TMP="OS") PRIORITY="ORIGINAL SC"
 S:(TMP="ON") PRIORITY="ORIGINAL NSC"
 S:(TMP="I") PRIORITY="INCREASE"
 S:(TMP="R") PRIORITY="REVIEW"
 S:(TMP="OTR") PRIORITY="OTHER"
 S:(TMP="E") PRIORITY="INSUFFICIENT EXAM"
 ;CONVERT EXAM TYPE TO EXTERNAL FORMAT
 S TYPE=$P($G(^DVB(396.6,TYPEPTR,0)),"^",1)
 S:('TYPEPTR) TYPE="UNKNOWN"
 ;DETERMINE CODE (BASED ON TRANSFER OUT/IN DATES)
 S NODE=$G(^DVB(396.4,PTR,"TRAN"))
 ;DONE AT LOCAL FACILITY
 S CODE=1
 ;DONE AT REMOTE FACILITY
 S:($P(NODE,"^",1)'="") CODE=2
 ;DONE AT LOCAL FACILITY FOR REMOTE FACILITY
 S:($P(NODE,"^",4)'="") CODE=3
 ;CALCULATE INVERSE EXAM DATE
 S INVDATE=9999999-FMDATE
 ;PUT INFO INTO GLOBAL
 S @ARR@(INVDATE,TYPEPTR,0)=CODE_"^"_FMDATE_"^"_TYPE_"^"_DOCTOR_"^"_PRIORITY
 Q
OUTRES(PTR,ARR) ;SET NODE 'RES' OF OUTPUT
 ;INPUT  : PTR - Pointer to 2507 EXAM file (#396.4)
 ;         ARR - Where to place output (full global reference)
 ;OUTPUT : None
 ;         See HSCP^DVBCHS0() for format of output array
 ;NOTES  : All input is assumed to exist (no error checking)
 ;
 N LINE,LINES,INVDATE,FMDATE,TYPEPTR,NODE
 ;GET EXAM DATE & TYPE
 S NODE=$G(^DVB(396.4,PTR,0))
 S TYPEPTR=+$P(NODE,"^",3)
 S FMDATE=+$P(NODE,"^",6)
 ;CALCULATE INVERSE EXAM DATE
 S INVDATE=9999999-FMDATE
 ;PUT RESULTS INTO GLOBAL
 S LINE=0,LINES=1
 F  S LINE=+$O(^DVB(396.4,PTR,"RES",LINE)) Q:('LINE)  D
 .S @ARR@(INVDATE,TYPEPTR,"RES",LINES)=$G(^DVB(396.4,PTR,"RES",LINE,0))
 .S LINES=LINES+1
 ;PUT NUMBER OF LINES INFO INTO GLOBAL
 S @ARR@(INVDATE,TYPEPTR,"RES",0)=LINES-1
 Q

DVBCHS2
DVBCHS2 ;ALB/JRP - C & P EXTRACT FOR HEALTH SUMMARY (CONT);11-JAN-95
 ;;2.7;AMIE;;Apr 10, 1995
OUT1(PTR,ARR) ;SET NODE ONE OF OUTPUT
 ;INPUT  : PTR - Pointer to 2507 EXAM file (#396.4)
 ;         ARR - Where to place output (full global reference)
 ;OUTPUT : None
 ;         See HSCP^DVBCHS0() for format of output array
 ;NOTES  : All input is assumed to exist (no error checking)
 ;
 N CODE,NODE,LOCPTR,LOCATION,OWNPTR,OWNER,OUTPTR
 N TYPEPTR,FMDATE,REQPTR,OUTDOM,INVDATE
 ;DETERMINE CODE (BASED ON TRANSFER OUT/IN DATES)
 S NODE=$G(^DVB(396.4,PTR,"TRAN"))
 ;DONE AT LOCAL FACILITY
 S CODE=1
 ;DONE AT REMOTE FACILITY
 S:($P(NODE,"^",1)'="") CODE=2
 ;DONE AT LOCAL FACILITY FOR REMOTE FACILITY
 S:($P(NODE,"^",4)'="") CODE=3
 ;GET ROUTING LOCATION
 S REQPTR=+$P($G(^DVB(396.4,PTR,0)),"^",2)
 S LOCPTR=+$P($G(^DVB(396.3,REQPTR,1)),"^",4)
 S LOCATION=$P($G(^DG(40.8,LOCPTR,0)),"^",1)
 S:('LOCPTR) LOCATION="UNKNOWN"
 ;DEFAULT REMOTE DOMAINS TO N/A
 S OWNER="N/A"
 S OUTDOM="N/A"
 ;EXAM DONE REMOTELY
 I (CODE=2) D
 .S OUTPTR=+$P($G(^DVB(396.4,PTR,"TRAN")),"^",3)
 .S OUTDOM=$P($G(^DIC(4.2,OUTPTR,0)),"^",1)
 .S:('OUTPTR) OUTDOM="UNKNOWN"
 ;EXAM DONE FOR REMOTE FACILITY
 I (CODE=3) D
 .S OWNPTR=+$P($G(^DVB(396.3,REQPTR,0)),"^",22)
 .S OWNER=$P($G(^DIC(4.2,OWNPTR,0)),"^",1)
 .S:('OWNPTR) OWNER="UNKNOWN"
 ;GET EXAM DATE & TYPE
 S NODE=$G(^DVB(396.4,PTR,0))
 S TYPEPTR=+$P(NODE,"^",3)
 S FMDATE=+$P(NODE,"^",6)
 ;CALCULATE INVERSE EXAM DATE
 S INVDATE=9999999-FMDATE
 ;PUT INFO INTO GLOBAL
 S @ARR@(INVDATE,TYPEPTR,1)=LOCATION_"^"_OWNER_"^"_OUTDOM
 Q
OUT2(PTR,ARR) ;SET NODE TWO OF OUTPUT
 ;INPUT  : PTR - Pointer to 2507 EXAM file (#396.4)
 ;         ARR - Where to place output (full global reference)
 ;OUTPUT : None
 ;         See HSCP^DVBCHS0() for format of output array
 ;NOTES  : All input is assumed to exist (no error checking)
 ;
 N NODE,CODE,TYPEPTR,FMDATE,INVDATE
 N STATUS,APPRVBY,APPRVDTE,REQPTR
 ;DETERMINE CODE (BASED ON TRANSFER OUT/IN DATES)
 S NODE=$G(^DVB(396.4,PTR,"TRAN"))
 ;DONE AT LOCAL FACILITY
 S CODE=1
 ;DONE AT REMOTE FACILITY
 S:($P(NODE,"^",1)'="") CODE=2
 ;DONE AT LOCAL FACILITY FOR REMOTE FACILITY
 S:($P(NODE,"^",4)'="") CODE=3
 ;GET INFO FROM REQUEST
 S REQPTR=+$P($G(^DVB(396.4,PTR,0)),"^",2)
 ;GET APPROVAL INFO
 S NODE=$G(^DVB(396.3,REQPTR,1))
 S APPRVBY=$P(NODE,"^",5)
 S APPRVDTE=+$P(NODE,"^",6)
 ;DETERMINE STATUS
 S TMP=$P($G(^DVB(396.3,REQPTR,0)),"^",18)
 S STATUS="UNKNOWN"
 S:(TMP="N") STATUS="NEW",APPRVBY="N/A"
 S:(TMP="P") STATUS="PENDING, REPORTED",APPRVBY="N/A"
 S:(TMP="S") STATUS="PENDING SCHEDULED",APPRVBY="N/A"
 S:(TMP="R") STATUS="RELEASED TO RO, NOT PRINTED"
 S:(TMP="C") STATUS="COMPLETED, PRINTED BY RO"
 S:(TMP="X") STATUS="CANCELLED BY MAS",APPRVBY="N/A"
 S:(TMP="RX") STATUS="CANCELLED BY RO",APPRVBY="N/A"
 S:(TMP="T") STATUS="TRANSCRIBED",APPRVBY="N/A"
 S:(TMP="NT") STATUS="NEW, TRANSFERRED IN",APPRVBY="N/A"
 S:(TMP="CT") STATUS="COMPLETED, TRANSFERRED OUT"
 S:(STATUS="UNKNOWN") APPRVBY="N/A"
 ;GET EXAM DATE & TYPE
 S NODE=$G(^DVB(396.4,PTR,0))
 S TYPEPTR=+$P(NODE,"^",3)
 S FMDATE=+$P(NODE,"^",6)
 ;CALCULATE INVERSE EXAM DATE
 S INVDATE=9999999-FMDATE
 ;PUT INFO INTO GLOBAL
 S @ARR@(INVDATE,TYPEPTR,2)=STATUS_"^"_APPRVBY_"^"_APPRVDTE
 Q

DVBCHTCK
DVBCHTCK ;ALB/GTS-557/THM-HYPERTENSION EXAM ; 12/5/90  2:14 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0115 Worksheet" S HD7="HYPERTENSION",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"There should be at least three blood pressure readings",!?13,"in the sitting position spaced throughout the examination.",!
 W ?13,"At times it may be necessary to recall the veteran on",!?13,"subsequent days to obtain readings which are most",!
 W ?13,"representative of the true blood pressure.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Blood pressure readings:",!!!?13,"sitting -",!!?13,"lying -",!!?13,"standing -",!!!!!!?8,"2. Medication -",!!!!!!?8,"3. Enlarged heart confirmation -",!!!!!!
 W ?8,"4. Apex beat beyond midclavicular line -",!
 D HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. ") D:$Y>50 HD2
 W "Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCHYCK
DVBCHYCK ;ALB/GTS-557/THM-HYPERPARATHYROIDISM ; 12/6/90  11:53 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0415 Worksheet" S HD7="HYPERPARATHYROIDISM",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Marked weight loss -",!!!!!!?5,"2.  Fatigability -",!!!!!!?5,"3.  Decalcification of bones -",!!!!!!
 W ?5,"4.  High blood calcium -",!!!!!!?5,"5.  High urinary calcium -",!!!!!!
 W ?5,"6.  Disease in remission or demonstrably active -",!!!!!! D HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;When symptoms interfere with normal daily activities or job
 ;;efficiency, it is essential that the extent of such handicaps
 ;;be described.
 ;;END

DVBCIRP1
DVBCIRP1 ;ALB/GTS-AMIE INSUFFICIENT 2507 RPT -CONT 1 ; 11/10/94  1:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
SUMRPT ;**Output the summary report
 W:IOST?1"C-".E @IOF
 D SUMHD
 W !?3,"Total 2507 requests received for date range:",?68,DVBARQCT
 W !?3,"Total insufficient requests received for date range:",?68,DVBAINRQ
 W:(DVBARQCT>0) !?3,"Percent of insufficient requests per total requests received:",?68,$P(((DVBAINRQ/DVBARQCT)*100),".",1)_$S($E($P(((DVBAINRQ/DVBARQCT)*100),".",2),1,1)'="":"."_$E($P(((DVBAINRQ/DVBARQCT)*100),".",2),1,1),1:"")_" %"
 W:DVBARQCT'>0 !?3,"Percent of insufficient requests per total requests received:",?68,"0   %"
 W !!?3,"Total 2507 exams received for date range:",?68,DVBAXMCT
 W !?3,"Total insufficient 2507 exams received for date range:",?68,DVBAINXM
 W:(DVBAXMCT>0) !?3,"Percent of insufficient exams per total exams received:",?68,$P(((DVBAINXM/DVBAXMCT)*100),".",1)_$S($E($P(((DVBAINXM/DVBAXMCT)*100),".",2),1,1)'="":"."_$E($P(((DVBAINXM/DVBAXMCT)*100),".",2),1,1),1:"")_" %"
 W:DVBAXMCT'>0 !?3,"Percent of insufficient exams per total exams received:",?68,"0   %"
 I IOST?1"C-".E DO
 .K DTOUT,DUOUT
 .W !!
 .D PAUSE^DVBCUTL4
 .I '$D(DTOUT),('$D(DUOUT)) DO
 ..W @IOF
 ..D SUMHD
 I '$D(DTOUT),('$D(DUOUT)) DO
 .W:IOST'?1"C-".E !!
 .W !?15,"Summary of insufficient exams per Reason",!
 .W !?3,"Reason",?53,"Num",?59,"Percent"
 .N DVBARSLP S DVBARSLP=""
 .F  S DVBARSLP=$O(DVBAINXM(DVBARSLP)) Q:DVBARSLP=""  DO  ;**Reason tot's
 ..W:+DVBARSLP>0 !?3,$P(^DVB(396.94,DVBARSLP,0),U,3),?53,DVBAINXM(DVBARSLP)
 ..I +DVBARSLP'>0,(+DVBAINXM(DVBARSLP)>0) W !?3,"Exams without insufficient reason indicated",?53,DVBAINXM(DVBARSLP)
 ..W:(+DVBAINXM(DVBARSLP)>0&(DVBAINXM>0)) ?59,($P(((DVBAINXM(DVBARSLP)/DVBAINXM)*100),".",1))_$S($E($P(((DVBAINXM(DVBARSLP)/DVBAINXM)*100),".",2),1,1)'="":"."_$E($P(((DVBAINXM(DVBARSLP)/DVBAINXM)*100),".",2),1,1),1:"")_" %"
 .I IOST?1"C-".E DO
 ..D CONTMES^DVBCUTL4
 Q
 ;
SUMHD ;** Output Summary Report heading
 N STRTDT,LSTDT
 W !?15,"Summary Insufficient Exam Report for ",$$SITE^DVBCUTL4(),!
 S Y=$P(BEGDT,".",1) X ^DD("DD") S STRTDT=Y K Y
 S Y=$P(ENDDT,".",1) X ^DD("DD") S LSTDT=Y K Y
 W !?16,"For Date Range: "_STRTDT_" to "_LSTDT,!
 Q
 ;
DETAIL ;** Output reason, exam type and exam info
 N STRTDT,LSTDT
 S Y=$P(BEGDT,".",1) X ^DD("DD") S STRTDT=Y K Y
 S Y=$P(ENDDT,".",1) X ^DD("DD") S LSTDT=Y K Y
 U IO
 S DVBADTLP=BEGDT
 S DVBAENDL=ENDDT
 I $D(ZTQUEUED) D SETTYPE
 D DETHD^DVBCIUTL
 S RSDA=""
 S DVBAPG1=""
 F  S RSDA=$O(DVBAARY("REASON",RSDA)) Q:(RSDA=""!($D(GETOUT)))  DO
 .K DVBARSPT
 .S TPDA=""
 .F  S TPDA=$O(^TMP($J,"XMTYPE",TPDA)) Q:(TPDA=""!($D(GETOUT)))  DO
 ..K DVBAXMPT
 ..S XMDA=""
 ..F  S XMDA=$O(^DVB(396.4,"AIT",RSDA,TPDA,XMDA)) Q:(XMDA=""!($D(GETOUT)))  DO
 ...I $P(^DVB(396.3,$P(^DVB(396.4,XMDA,0),U,2),0),U,5)>DVBADTLP,($P(^DVB(396.3,$P(^DVB(396.4,XMDA,0),U,2),0),U,5)<DVBAENDL) D EXMOUT^DVBCIUTL
 I '$D(GETOUT),(IOST?1"C-".E) D CONTMES^DVBCUTL4
 D KVARS ;**KILL the variables used by DETAIL
 I $D(ZTQUEUED) D KVARS^DVBCIRPT,KILL^%ZTLOAD
 Q
 ;
KVARS ;** Final Kill for Detail report
 K ^TMP($J),DVBAARY,DVBANAME,DVBASSN,DVBACNUM,RSDA,TPDA,XMDA,DVBADTLP
 K DVBAENDL,DVBARSPT,DVBAXMPT,REQDA,DFN,DVBAORXM,DVBAXMTP,DVBACMND
 K DVBAORPV,DVBAORP1,DVBADTWK,DVBADTE,DVBAORDT,DVBANAM1,GETOUT
 K DVBAARY,DVBATP1,DVBATP2,DVBAPG1
 Q
 ;
DETSEL ;** Select the details to report
 D RSEL^DVBCIUTL
 I '$D(DVBAARY("REASON")) S DVBAQTSL=""
 I $D(DVBAQTSL) DO
 .S DIR("A",1)="You have not selected Insufficient reasons to report."
 .S DIR("A",2)="This is required to print the Detailed report."
 .S DIR("A",3)=" "
 .S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 I '$D(DVBAQTSL) DO
 .D XMSEL^DVBCIUTL
 .I '$D(^TMP($J,"XMTYPE")) S DVBAQTSL=""
 .I $D(DVBAQTSL) DO
 ..S DIR("A",1)="You have not selected Exams to report."
 ..S DIR("A",2)="This is required to print the Detailed report."
 ..S DIR("A",3)=" "
 ..S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 ..K DVBAARY("REASON")
 Q
 ;
SETTYPE ;** Set the ^TMP($J,"XMTYPE") global
 N TPDA,LPCNT
 F LPCNT=1:1 S TPDA=$P(DVBATP1,U,LPCNT) Q:TPDA=""  S ^TMP($J,"XMTYPE",TPDA)=""
 F LPCNT=1:1 S TPDA=$P(DVBATP2,U,LPCNT) Q:TPDA=""  S ^TMP($J,"XMTYPE",TPDA)=""
 Q

DVBCIRPT
DVBCIRPT ;ALB/GTS-AMIE C&P INSUFF EXAM TRACKING RPT ; 11/9/94  2:00 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
MAIN ;**Select Dte Rng & Rpt Type; call report routine
 F  Q:$D(DVBAOUT)  DO
 .D HOME^%ZIS
 .S TVAR(1,0)="0,0,1,2:2,1^Insufficient 2507 Exam Report"
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 .S RPTTYPE=$$RPTTYPE^DVBCUTA1()
 .S:((RPTTYPE'="D")&(RPTTYPE'="S")) DVBAOUT=""
 .W:'$D(DVBAOUT) !!
 .D:'$D(DVBAOUT) DATE^DVBCUTL4(.BEGDT,.ENDDT)
 .I $D(ENDDT),(+ENDDT>0) DO
 ..S ENDDT=ENDDT_".2359"
 ..I RPTTYPE="S" DO
 ...D DEVSEL
 ...I POP D SUMKILL
 ...I 'POP DO
 ....I $D(IO("Q")) DO
 .....N DVBAI
 .....S ZTRTN="SUM^DVBCIRPT",ZTIO=ION
 .....S ZTDESC="Summary Insufficient Exam Report"
 .....F DVBAI="BEGDT","ENDDT" S ZTSAVE(DVBAI)=""
 .....D ^%ZTLOAD
 .....I $D(ZTSK) W !!,"Summary Report Queued",!! K ZTSK D CONTMES^DVBCUTL4
 .....D SUMKILL
 ....I '$D(IO("Q")) D SUM
 ...D ^%ZISC
 ..I RPTTYPE="D" DO
 ...D DETSEL^DVBCIRP1 ;**Select the Reasons and Exams to report
 ...I '$D(DVBAQTSL) DO
 ....D DEVSEL
 ....I POP D KVARS^DVBCIRP1
 ....I 'POP DO
 .....I $D(IO("Q")) DO
 ......D SETTPVR ;**Set DVBATP1, DVBATP2
 ......N DVBAI
 ......S ZTRTN="DETAIL^DVBCIRP1",ZTIO=ION
 ......S ZTDESC="Detailed Insufficient Exam Report"
 ......F DVBAI="BEGDT","ENDDT","DVBAARY(""REASON"",","DVBATP1","DVBATP2" S ZTSAVE(DVBAI)=""
 ......D ^%ZTLOAD
 ......I $D(ZTSK) W !!,"Detail Report Queued",!! K ZTSK D CONTMES^DVBCUTL4
 ......D KVARS^DVBCIRP1
 .....I '$D(IO("Q")) W:IOST?1"C-".E @IOF D DETAIL^DVBCIRP1
 ....D ^%ZISC
 ...K DVBAQTSL
 ..D CLEANUP
 D KVARS
 Q
 ;
SETTPVR ;** Set variables to pass to TaskMan in ZTSAVE when Que detailed rpt
 N TPDA,TPCNT
 S (DVBATP1,DVBATP2,TPDA)="",TPCNT=0
 F  S TPDA=$O(^TMP($J,"XMTYPE",TPDA)) Q:(TPDA="")!(TPCNT=40)  DO
 .S TPCNT=TPCNT+1
 .S:DVBATP1'="" DVBATP1=DVBATP1_"^"_TPDA
 .S:DVBATP1="" DVBATP1=TPDA
 S DVBATP1=DVBATP1_"^"
 I +TPDA>0 DO
 .S TPDA=TPDA-1
 .F  S TPDA=$O(^TMP($J,"XMTYPE",TPDA)) Q:(TPDA="")  DO
 ..S:DVBATP2'="" DVBATP2=DVBATP2_"^"_TPDA
 ..S:DVBATP2="" DVBATP2=TPDA
 .S DVBATP2=DVBATP2_"^"
 Q
 ;
KVARS ;** Kill the variables used in report
 K DVBAOUT,ENDDT,BEGDT,DTOUT,DUOUT,RPTTYPE
 D CLEANUP
 Q
 ;
CLEANUP ;** Kill the variables used by the device handler
 K %ZIS,POP,%IS,IOP
 K IOBS,IOHG,IOPAR,IOUPAR,IOXY,POP,%DT,%YY,%XX,ION,IOPAR
 Q
 ;
DEVSEL ;** Select the device to report to
 S %ZIS="AEQ"
 S %ZIS("A")="Output device: "
 D ^%ZIS
 Q
 ;
SUM ;** Set up reason counter array, count all 2507's received
 U IO
 S (DVBARQCT,DVBAINRQ,DVBAXMCT,DVBAINXM)=0
 S DVBAENDL=ENDDT
 ;
 ;** Initialize reason counter array
 F DVBARIFN=0:0 S DVBARIFN=$O(^DVB(396.94,DVBARIFN)) Q:+DVBARIFN'>0  DO
 .S DVBAINXM(DVBARIFN)=0
 S DVBAINXM("NO REASON")=0
 ;
 ;** Count the total and insufficient number of exams and 2507 requests
 S DVBADTLP=BEGDT-.0001
 F  S DVBADTLP=$O(^DVB(396.3,"ADP",DVBADTLP)) Q:(DVBADTLP=""!(DVBADTLP>ENDDT))  DO
 .S DVBAPRIO=""
 .F  S DVBAPRIO=$O(^DVB(396.3,"ADP",DVBADTLP,DVBAPRIO)) Q:DVBAPRIO=""  DO
 ..S DVBADALP=""
 ..F  S DVBADALP=$O(^DVB(396.3,"ADP",DVBADTLP,DVBAPRIO,DVBADALP)) Q:DVBADALP=""  DO
 ...S DVBARQCT=DVBARQCT+1
 ...K DVBAINSF
 ...I DVBAPRIO="E" DO
 ....S DVBAINRQ=DVBAINRQ+1
 ....S DVBAINSF=""
 ...S DVBAXMDA=""
 ...F  S DVBAXMDA=$O(^DVB(396.4,"C",DVBADALP,DVBAXMDA)) Q:DVBAXMDA=""  DO
 ....S DVBAXMCT=DVBAXMCT+1
 ....I $D(DVBAINSF) DO
 .....S DVBAINXM=DVBAINXM+1
 .....S DVBARIFN=$P(^DVB(396.4,DVBAXMDA,0),U,11)
 .....S:DVBARIFN="" DVBARIFN="NO REASON"
 .....S DVBAINXM(DVBARIFN)=DVBAINXM(DVBARIFN)+1
 D SUMRPT^DVBCIRP1
 I $D(ZTQUEUED) D KVARS^DVBCIRPT,KILL^%ZTLOAD
 D SUMKILL
 Q
 ;
SUMKILL ;** Kill the variables used in the summary report
 K DVBADTLP,DVBAENDL,DVBARQCT,DVBAINRQ,DVBAXMCT,DVBAINXM
 K DVBAPRIO,DVBADALP,DVBAXMDA,DVBAINSF,DVBARIFN
 Q

DVBCIUT1
DVBCIUT1 ;ALB/GTS-AMIE INSUFFICIENT UTILITY RTN 1 ; 11/14/94  3:00 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
INREAS ;** Select Insufficient Reasons
 N YSAVE
 S YSAVE=Y
 I YSAVE=-1 DO
 .S DIR(0)="YA"
 .S DIR("?",1)=" "
 .S DIR("?",2)="  Enter 'No' to print only those reasons previously"
 .S DIR("?",3)="   selected, 'Yes' to select all reasons existing"
 .S DIR("?")="   on currently entered exams."
 .S DIR("A",1)=" "
 .S DIR("A",2)=" You have selected to report all insufficient reasons."
 .S DIR("A")=" Is this correct? "
 .D ^DIR
 .I Y'=0,('$D(DUOUT)&('$D(DTOUT))) DO
 ..N DVBAXIFN
 ..F DVBAXIFN=0:0 S DVBAXIFN=$O(^DVB(396.94,DVBAXIFN)) Q:+DVBAXIFN=0  DO
 ...S DVBAARY("REASON",DVBAXIFN)=""
 .S Y=-1
 I +YSAVE>0 S DVBAARY("REASON",+YSAVE)=""
 S Y=YSAVE
 K DTOUT,DUOUT,DIR
 Q
 ;
EXMTPE ;** Select the exams to Report
 N YSAVE
 S YSAVE=Y
 I YSAVE=-1 DO
 .S DIR(0)="YA"
 .S DIR("?",1)=" "
 .S DIR("?",2)="  Enter 'No' to print only those exams previously"
 .S DIR("?")="   selected, 'Yes' to select all exams"
 .S DIR("A",1)=" "
 .S DIR("A",2)=" You have selected to report all AMIE exams."
 .S DIR("A")=" Is this correct? "
 .D ^DIR
 .I Y'=0,('$D(DUOUT)&('$D(DTOUT))) DO
 ..N DVBAXIFN
 ..F DVBAXIFN=0:0 S DVBAXIFN=$O(^DVB(396.6,DVBAXIFN)) Q:+DVBAXIFN=0  DO
 ...S:$P(^DVB(396.6,DVBAXIFN,0),U,5)="A" ^TMP($J,"XMTYPE",DVBAXIFN)=""
 .S Y=-1
 I +YSAVE>0 S ^TMP($J,"XMTYPE",+YSAVE)=""
 S Y=YSAVE
 K DTOUT,DUOUT,DIR
 Q

DVBCIUTL
DVBCIUTL ;ALB/GTS-AMIE INSUFFICIENT RPT UTILITY RTN ; 11/14/94  9:15 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
DETHD ;** Detailed Report header
 S:'$D(DVBAPG1) TVAR(1,0)="0,15,0,1,0^Detailed Insufficient Exam Report"
 S:$D(DVBAPG1) TVAR(1,0)="0,15,0,1,1^Detailed Insufficient Exam Report"
 S TVAR(2,0)="0,11,0,2,0^For Date Range: "_STRTDT_" to "_LSTDT
 D WR^DVBAUTL4("TVAR")
 K TVAR
 Q
 ;
EXMOUT ;** Output exam information for reason/type
 I $Y>(IOSL-9) DO
 .I IOST?1"C-".E D TERM^DVBCUTL3
 .I '$D(GETOUT) DO
 ..D DETHD
 ..D RESOUT
 ..W !
 ..D TYPEOUT
 ..S (DVBARSPT,DVBAXMPT)=""
 I '$D(GETOUT) DO
 .I '$D(DVBARSPT) DO
 ..D RESOUT
 ..S DVBARSPT=""
 .I '$D(DVBAXMPT) DO
 ..W !
 ..D TYPEOUT
 ..S DVBAXMPT=""
 .S REQDA=$P(^DVB(396.4,XMDA,0),U,2) ;*REQDA of PRIORITY Insuf 2507
 .I +REQDA>0 DO  ;*Get REQDA of Orig 2507
 ..S DFN=$P(^DVB(396.3,REQDA,0),U,1)
 ..I '$D(^DVB(396.3,REQDA,5)) S REQDA=""
 ..I +REQDA>0,($D(^DVB(396.3,REQDA,5))) S REQDA=$P(^DVB(396.3,REQDA,5),U,1)
 .S DVBAORXM=""
 .I +REQDA>0 DO  ;*If link to orig 2507
 ..S DVBAXMTP=$P(^DVB(396.4,XMDA,0),U,3)
 ..S DVBACMND="F  S DVBAORXM=$O(^DVB(396.4,""ARQ"_REQDA_""","_DVBAXMTP_",DVBAORXM)) Q:DVBAORXM=""""  Q:$D(^DVB(396.4,""APS"","_DFN_","_DVBAXMTP_",""C"",DVBAORXM))"
 ..X DVBACMND ;**Return DA of original, insuff exam
 .S DVBANAME=$P(^DPT(DFN,0),U,1)
 .S DVBASSN=$P(^DPT(DFN,0),U,9)
 .S DVBACNUM="" S:$D(^DPT(DFN,.31)) DVBACNUM=$P(^DPT(DFN,.31),U,3)
 .I DVBAORXM'="",($D(^DVB(396.4,DVBAORXM,0))) S DVBAORDT=$P(^DVB(396.4,DVBAORXM,0),U,6)
 .I DVBAORXM'="",('$D(^DVB(396.4,DVBAORXM,0))) S (DVBAORDT,DVBADTE)=""
 .S:DVBAORXM="" (DVBAORDT,DVBADTE)=""
 .I DVBAORDT'="" DO
 ..S DVBADTWK=$P(DVBAORDT,".",1)
 ..S DVBADTE=$E(DVBADTWK,4,5)_"/"_$E(DVBADTWK,6,7)_"/"_$E(DVBADTWK,2,3)
 .S DVBAORPV=$P(^DVB(396.4,XMDA,0),U,12)
 .S DVBAORP1=$E(DVBAORPV,1,15)
 .S DVBANAM1=$E(DVBANAME,1,15)
 .W !,DVBAORP1
 .W:$L(DVBAORPV)>$L(DVBAORP1) "**" ;**Indicate that Dr.'s Name truncated
 .W ?20,DVBADTE,?32,DVBANAM1
 .W:$L(DVBANAME)>$L(DVBANAM1) "**" ;**Indicate that Vet's Name truncated
 .W ?52,DVBASSN,?66,DVBACNUM
 Q
 ;
RESOUT ;** Output the Reason
 W !!!!!,"Reason: ",$P(^DVB(396.94,$P(^DVB(396.4,XMDA,0),U,11),0),U,3)
 Q
 ;
TYPEOUT ;** Output the Exam
 W !,"Exam: ",$P(^DVB(396.6,$P(^DVB(396.4,XMDA,0),U,3),0),U,2)
 W !,"Provider",?20,"Exam Dt",?32,"Patient Name",?52,"SSN",?66,"Claim #"
 Q
 ;
RSEL ;** Select Reasons
 ;** The selection prompt is defaulted to ALL.  If the user selects
 ;**  'All', only reasons for exams entered on requests with a
 ;**  priority of 'Insufficient' will be reported.  Not all reasons.
 ;
 W @IOF,!
 W !,"Insufficient Reason Selection"
 S DVBCYQ=""
 N RESANS,DVBAOUT S DVBAOUT="" ;**Pre-read
 K Y,DTOUT,DUOUT,DVBATSAV
 F  Q:(DVBAOUT=1!(DVBCYQ=1))  DO
 .W !!,"  Enter '^' to end Reason Selection"
 .W !,"  'Return' to select all Insufficient Reasons",!
 .K DIC,DTOUT,DUOUT,Y
 .W !,"  Enter Insufficient Reason: ALL//"
 .R RESANS:DTIME
 .S:$T DVBATSAV=""
 .I RESANS=""&($D(DVBATSAV)) S Y=-1 D INREAS^DVBCIUT1
 .S:('$D(DVBATSAV)!(RESANS["^")) DVBAOUT="1"
 .I DVBAOUT'=1,('$D(Y)) DO
 ..I RESANS["?" DO
 ...N LPDA S LPDA=0
 ...W !,"CHOOSE FROM:"
 ...F  S LPDA=$O(^DVB(396.94,LPDA)) Q:+LPDA'>0  DO
 ....W !,?3,$P(^DVB(396.94,LPDA,0),U,1)
 ...W !
 ..I RESANS'["?" DO
 ...S DIC="^DVB(396.94,"
 ...S DIC(0)="EMQ"
 ...S X=RESANS
 ...D ^DIC
 ...D:+Y>0 INREAS^DVBCIUT1
 .I RESANS="",($D(Y)&(+Y=-1)) S DVBCYQ=1
 K DTOUT,DUOUT,Y,DIC,DVBCYQ,DVBATSAV
 Q
 ;
XMSEL ;** Select Exams
 ;** The selection prompt is defaulted to ALL.  If the user selects
 ;**  'All', only exams entered on requests with a priority of 
 ;**  'Insufficient' will be reported.  Not all exams.
 ;
 W @IOF,!
 W !,"AMIE Exam Selection"
 S DVBCYQ=""
 K Y,DTOUT,DUOUT
 F  Q:($D(DTOUT)!($D(DUOUT)!(DVBCYQ=1)))  DO
 .W !!,"  Enter '^' to end Exam Selection"
 .W !,"  'Return' to select all AMIE Exams",!
 .K DIC,DTOUT,DUOUT
 .S DIC="^DVB(396.6,"
 .S DIC(0)="AEMQ"
 .S DIC("A")="  Enter Exam: ALL//"
 .S DIC("S")="I $P(^(0),U,5)=""A"""
 .D ^DIC
 .I '$D(DTOUT),('$D(DUOUT)) D EXMTPE^DVBCIUT1
 .I $D(Y),(+Y=-1) S DVBCYQ=1
 K DTOUT,DUOUT,Y,DIC,DVBCYQ
 Q

DVBCJNCK
DVBCJNCK ;ALB/GTS-557/THM-JOINT EXAM ; 5/17/91  8:47 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1430 Worksheet" S HD7="JOINTS (ORTHOPEDIC)",HD8="FOR "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Do not use negative values to indicate inability to achieve",!?13,"full extension.  The anatomical position is the reference",!?13,"position EXCEPT with the regard to rotation of the shoulder",!?13,"and pronation/supination "
 W "of the forearm (see fig. 2.1 and 2.2",!?13,"of the Physician's Guide).  To give uniformity in describing",!?13,"limitation of motion or ankylosis of a joint, THE USE OF A",!?13,"GONIOMETER IS REQUIRED.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!! W "B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Swelling -",!!!!!?8,"2. Deformity -",!!!!!
 W ?8,"3. Other impairment of knee: subluxation or lateral instability;",!?11,"non-union, with loose motion; malunion -",!!!!!
 D:$D(CMBN) HD2 W ?8,"4. Range of motion (complete chart below)-",!!?11,"Note: Enter joint names in blanks under numbers below.  If more",!
 W ?11,"than four joints are involved, please extend your dictation in the",!?11,"same format.",!!
 S LN="|============|============|============|============|",LN1="|            |            |            |            |",LN2="|------------|------------|------------|------------|"
 W ?19,"------------------ JOINT EXAMINED -------------------",!!?25,"1",?32,"|",?38,"2",?45,"|",?51,"3",?58,"|",?65,"4",?71,"|",!?19,LN,!,"Range of:",?19,LN1,!,"----- --",?19,LN,!
 F JX="Flexion","Extension","Rotation","Abduction","Adduction","Pronation","Supination","Deviation (radial)","Deviation (ulnar)","Plantar Flexion","Dorsiflexion" W JX,?19,LN1,!?19,LN2,!
 D HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for JOINTS for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCLABR
DVBCLABR ;ALB/GTS-557/THM-PRINT C&P LAB TEST RESULTS ; 9/6/91  1:40 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
LAB N XX S XX=1
 F  Q:'$D(DVBCRALC(XX))  D
 .S DVBCRALC=DVBCRALC(XX)
 .S XX=XX+1 D LAB1
 Q
LAB1 ;print lab
 S STAT=$P(^DVB(396.3,DA(1),0),U,18) Q:STAT["X"  I '$D(DVBCRALC) D SETLAB^DVBCPRNT ; ** Set variable DVBCRALC
 S LRDFN=$S($D(^DPT(DFN,"LR")):+^("LR"),1:0),DTREL=$P(^DVB(396.3,DA(1),0),U,14) Q:DTREL=""
 ; ** 'CH' X-ref is for Chemistry tests, 'MI' X-ref is for Micro tests.
 D RSET S DVBCW=1 F DVBCI=0:0 S LRIDT=$O(^LR(LRDFN,"CH",LRIDT)) Q:LRIDT=""!(LRIDT>LREDT)  D LK
 D RSET S DVBCW=2 F DVBCI=0:0 S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:LRIDT=""!(LRIDT>LREDT)  D LK
 ;
RAD ;print radiology
 Q:'$D(^RADPT(0))  ;quit if not running radiology package
 S RABDT=DVBCBDT,RAEDT=DTREL,RAHLOC=DVBCRALC D ^RAUTL3
 K DVBCW,RABDT,RAEDT,RAHLOC
 Q
 ;
REN I '$D(FF) D HOME^%ZIS S FF=IOF
 ;
REN1 W @FF,!,"Reprint Lab/X-Ray Results for C&P Exams",!!!
 S DIC="^DVB(396.3,",DIC(0)="AEQM" D ^DIC I X=""!(X=U) G KILL^DVBCUTIL
 I +Y>0 S DA(1)=+Y,DFN=$P(Y,U,2)
 W !! S %ZIS="AEQ",%ZIS("A")="Output device: " D ^%ZIS K %ZIS G:POP KILL^DVBCUTIL
 I $D(IO("Q")) S ZTRTN="REN2^DVBCLABR",ZTIO=ION,ZTDESC="C&P lab/radiology print" F I="DIC*","DA*","DFN" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued",!! H 2 G KILL^DVBCUTIL
REN2 U IO D SETLAB^DVBCPRNT,LAB S LKILL=1 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBCUTIL
 ;
RSET D:'$D(LRPARAM) DT^LRX,EN^LRPARAM S (LREND,LRSTOP)=0,LRCW=8,LRHF=1,LRFOOT=0,(LRONESPC,LRONETST)=""
 S LRLAB=1,X1=DTREL,X2=-120 D C^%DTC S (DVBCBDT,LREDT)=X,LRSDT=DTREL,LRIDT=9999999-LRSDT,LREDT=9999999-LREDT D PT^LRX
 Q
 ;
LK I DVBCW=1 S DVBCRLOC=$P(^LR(LRDFN,"CH",LRIDT,0),U,11)
 I DVBCW=2 S DVBCRLOC=$P(^LR(LRDFN,"MI",LRIDT,0),U,11)
 Q:DVBCRLOC=""  ; * Quit if DVBCRLOC is NULL.
 ;
 ; ** NOTE: DVBCRALC=^Pointer to file 44^Pointer to file 44^
 ; ** NOTE: DVBCRALC pointers come from file 396.1 C&P ROUTING LOCATION
 ; ** DVBCRLOC is the REQUESTING LOCATION in the Lab Data File multiple
 F ZJ=0:0 S ZJ=$O(^SC("C",DVBCRLOC,ZJ)) Q:ZJ=""  S DVBCXLOC=U_ZJ_U I DVBCRALC[DVBCXLOC D:DVBCW=1 CH^LRRP2 D:DVBCW=2 MI^LRRP2 Q
 K DVBCXLOC

DVBCLKT2
DVBCLKT2 ;ALB/GTS-AMIE C&P APPT LINK MNGT ROUTINE 2 ; 10/20/94  11:45 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
LNKQS ;** Question user to see if selected appt is rebook of existing link
 S DIR(0)="Y^A^"
 S DIR("A")="Was "_$P(DVBAAPT,U,1)_" scheduled to rebook a previous appointment"
 S DIR("?",1)="Enter NO to indicate this appointment is the first time the exam is scheduled."
 S DIR("?",2)="Enter YES to indicate this appointment is a rebook of an existing appointment"
 S DIR("?",3)="  for the exam."
 S DIR("?")="(If YES, you will be asked to select the appointment being rebooked.)"
 D ^DIR K DIR,X
 Q
 ;
ERRMESS ;** Error: Appointment link not selected
 S DIR("A",1)=" "
 S DIR("A",2)="You have not selected an appointment link which to modify with the selected"
 S DIR("A",3)=" appointment.  If the desired appointment was not displayed for selection,"
 S DIR("A",4)=" it must first be added as a new link to the 2507 request.  You may then "
 S DIR("A",5)=" modify the link as you have attempted here."
 S DIR("A",6)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 Q
 ;
APPTERR ;** Error if appt was not selected
 S DIR("A",1)=" "
 S DIR("A",2)="You have not selected a C&P appointment to link the request to."
 S DIR("A",3)="This is required before further processing with the AMIE link"
 S DIR("A",4)=" management option."
 S DIR("A",5)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue or '^' to STOP."
 D ^DIR
 I $D(DUOUT)!($D(DTOUT)) S DVBAOUT=""
 K DIR,X,Y,DTOUT,DUOUT
 Q
 ;
NOAPTERR ;** Veteran does not have C&P appointments
 S DIR("A",1)=" "
 S DIR("A",2)="You have selected a veteran that does not have C&P appointments"
 S DIR("A",3)=" to link to this request.  This is required before further processing with "
 S DIR("A",4)=" the AMIE link management option."
 S DIR("A",5)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 S DVBAOUT=""
 Q
 ;
DELERR ;** Error if link exists and user is not a supervisor
 S DIR("A",1)=" "
 S DIR("A",2)="You have selected a C&P appointment that is Currently Linked to the request."
 S DIR("A",3)="(NOTE: *CL) If you want to remove this link, see your supervisor."
 S DIR("A",4)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 Q
 ;
DELCK ;** Question supervisor to delete link
 D LINKINF^DVBCUTL6(DVBADA,$P(DVBAAPT,U,4))
 S DIR(0)="Y^A^"
 S DIR("A",1)=" "
 S DIR("A")="Do you want to REMOVE this link"
 S DIR("?",1)="Enter YES to remove this appointment from the 2507."
 S DIR("?",2)="Enter NO leave this appointment associated with the 2507."
 S DIR("?",3)="If you enter YES incorrectly, you will need to use this tool to relink the"
 S DIR("?")=" appointment to the request."
 D ^DIR
 I +Y>0 S DVBADEL=""
 K DIR,X,Y
 Q
 ;
DODEL ;** Delete existing link
 S DA="" S DA=$O(^DVB(396.95,"AB",DVBADA,$P(DVBAAPT,U,4),DA))
 S DIK="^DVB(396.95," D ^DIK K DIK,DA
 Q
 ;
NOLNK ;** Error that no links exist
 S DIR("A",1)=" "
 S DIR("A",2)="No appointments are currently linked to this 2507 request."
 S DIR("A",3)="You will need to create a link to the cancelled appointment"
 S DIR("A",4)=" before proceding with the link to this appointment."
 S DIR("A",5)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 Q

DVBCLKTL
DVBCLKTL ;ALB/GTS-AMIE C&P APPT LINK MNGT ROUTINE ; 10/20/94  10:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
EN ;** Main entry point
 K ^TMP("DVBC",$J)
 D HOME^%ZIS
 K DVBASUPR
 S:$D(^XUSEC("DVBA C SUPERVISOR",DUZ)) DVBASUPR=""
 ;** Select a C&P patient
 F  D HDR S DVBADFN=$$REQPAT^DVBCUTL5 D:+DVBADFN>0 MAINPROC Q:+DVBADFN'>0
 K DVBASUPR,DVBADFN
 Q
 ;
MAINPROC ;
 D CPPATARY^DVBCUTL5(DVBADFN) ;**^TMP - array of 2507's for patient
 I +DVBACNT=1 D AUTO2507 ;**S/W select the 2507 if only one exists
 I +DVBACNT>1 D USEL2507 ;**More than 1 2507 exists, user selects
 I '$D(^DVB(396.3,+DVBADA,0)) D NO2507^DVBCUTL5 ;**No 2507 sel'd, error
 ;
 ;** If 2507 selected, allow link adjustment
 I $D(^DVB(396.3,+DVBADA,0)) DO  ;**Output current appointments
 .D EXMDISP^DVBCUTL6(DVBADA) ;**Display the exams
 .S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue with appointment display."
 .S DIR("A",1)=" " D ^DIR K DIR,X,Y
 .F  Q:($D(DVBAOUT))  DO
 ..D APPTSEL^DVBCUTL6($P(^DVB(396.3,DVBADA,0),U,1),1,DVBADA,$P(^DVB(396.3,DVBADA,0),U,5))
 ..I '$D(^TMP("DVBC",$J,2)),(DVBAAPT="") DO  ;**No C&P appt's
 ...D:'$D(DVBAOUT) NOAPTERR^DVBCLKT2
 ..I '$D(DVBAAPT),($D(^TMP("DVBC",$J,2))) DO  ;**No appt selected
 ...D:'$D(DVBAOUT) APPTERR^DVBCLKT2
 ..I $D(DVBAAPT),($D(^TMP("DVBC",$J,2))&(DVBAAPT="")) DO
 ...D:'$D(DVBAOUT) APPTERR^DVBCLKT2
 ..I $D(DVBAAPT),(DVBAAPT'="") DO
 ...K DVBADEL
 ...I $D(DVBASUPR),($D(^DVB(396.95,"AB",+DVBADA,$P(DVBAAPT,U,4)))) D DELCK^DVBCLKT2 DO
 ....I $D(DVBADEL) D DODEL^DVBCLKT2
 ...I '$D(DVBASUPR),($D(^DVB(396.95,"AB",+DVBADA,$P(DVBAAPT,U,4)))) DO DELERR^DVBCLKT2
 ...I '$D(^DVB(396.95,"AB",+DVBADA,$P(DVBAAPT,U,4))),('$D(DVBADEL)) D LINKPROC
 ..K DVBAMORE,DVBALP,DVBADT,DVBAORD,DVBASEL,DVBAAPT
 ..K APPTSTAT,APPTNODE,DVBALKDA,DVBCADLK,DVBCOLAP,DVBADEL
 K ^TMP("DVBC",$J),DVBAOUT,DVBADTOT,DVBAPNAM,DVBADA
 Q
 ;
AUTO2507 ;If only 1 2507, select it
 ;**  DVBADA is the IEN of the selected 2507 request
 N DVBADT,DVBAORD
 S (DVBADT,DVBADA,DVBAORD)=""
 S DVBAORD=$O(^TMP("DVBC",$J,DVBAORD))
 S DVBADT=$O(^TMP("DVBC",$J,DVBAORD,DVBADT))
 S DVBADA=$O(^TMP("DVBC",$J,DVBAORD,DVBADT,DVBADA))
 K ^TMP("DVBC",$J)
 Q
 ;
LINKPROC ;Link appt to 2507
 D LNKQS^DVBCLKT2 ;**Add link or modify existing link
 K DVBCADLK S:+Y=0 DVBCADLK="" S DVBAYVAL=Y K Y
 N DVBAOUT S:$D(DTOUT) DVBAOUT=""
 ;
 ;** If Appt, either add to 396.95 or modify an existing link
 ;** APPTNODE and APPTSTAT from 'S' node of appt selected to link
 I $D(DVBCADLK),(DVBAYVAL'="^"),('$D(DVBAOUT)) DO  ;**Add Link
 .D STATCK^DVBCUTL7($P(DVBAAPT,U,4),DVBADFN) ;**Set APPTNODE,APPTSTAT
 .S SAVESTAT=APPTSTAT
 .I SAVESTAT["A" D ATRBCK^DVBCUTL7,ADDLK^DVBCUTL8 ;**Link lost: Auto-rbk
 .I SAVESTAT'["A" D NOAUTO^DVBCUTL7,ADDLK^DVBCUTL8 ;**Link lost: non-auto
 I '$D(DVBCADLK),(DVBAYVAL'="^"),('$D(DVBAOUT)) DO  ;**Rebook Link
 .S DVBAOLDA=$$SELLNK^DVBCUTL8(DVBADA)
 .I +DVBAOLDA'>0,('$D(DVBANOLK)) D ERRMESS^DVBCLKT2
 .I +DVBAOLDA>0 DO
 ..S OLDSTAT=$P(^DPT(DVBADFN,"S",$P(^DVB(396.95,DVBAOLDA,0),U,3),0),U,2)
 ..I OLDSTAT["P"!(OLDSTAT["N"&(OLDSTAT'="NT")) DO
 ...S ^TMP("DVBC",$J,"VETERAN CANCELLATION")=1
 ...S ^TMP("DVBC",$J,"VETERAN REQ APPT DATE")=$P(DVBAAPT,U,4)
 ..D STATCK^DVBCUTL7($P(DVBAAPT,U,4),DVBADFN) ;**Set APPTNODE,APPTSTAT
 ..S SAVESTAT=APPTSTAT ;**APPTNODE,APPTSTAT used in subroutines
 ..I SAVESTAT["A" D ATRBCK^DVBCUTL7,FIXLK^DVBCUTL8 ;**Link lost:Auto-rbk
 ..I SAVESTAT'["A" D NOAUTO^DVBCUTL7,FIXLK^DVBCUTL8 ;**Link lost:non-auto
 K SAVESTAT,OLDSTAT,DVBAYVAL,DVBANOLK
 Q
 ;
USEL2507 ;**User select 2507
 D REQSEL^DVBCUTL5 ;**Select 2507 from ^TMP
 I (+Y'>0)!($D(DVBAOUT)) S DVBADA=""
 S:+Y>0 DVBASEL=+Y ;**Y selected 2507 value returned from ^DIR
 D:+Y>0 FINDDA^DVBCUTL5 ;**Find selected 2507 DA (Return DVBADA)
 K ^TMP("DVBC",$J)
 Q
 ;
HDR ;** Veteran selection header
 W @IOF,!!,?18,"AMIE/C&P Appointment Link Management",!!
 I $D(DVBASUPR) W !,"As a Supervisor, you may remove 2507 appointment links",!!
 Q

DVBCLMHD
DVBCLMHD ;ALB/CMM HEADER FILE ;16FEB93
 ;;2.7;AMIE;;Apr 10, 1995
EN ;
 ;   perform initializations for pkg wide vars
 ;
 ;
 S VWLINE=1,VALMBG=1
 ;
 ;  where to place the results array
 S RSLTAR="^TMP(""DVBC"","_$J_")"
 ;
 ;  set initial query number 0, so 1st domain build becomes 1
 S @RSLTAR@(0)=0
 ;
 Q

DVBCLMU2
DVBCLMU2 ;ALB/CMM TEXT FOR INITIAL/REEVALUATION ;12/30/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Display of initial and reevaluation exam descriptions
 ;
WINIT ;
 ;initial exam description displayed using ^DIWP
 ;
 K ^UTILITY($J,"W")
 N JJ,DIWF,DIWL,X
 W !!
 S JJ=0,DIWF="WN",DIWL=5
 F  Q:$O(^DVBP(396.91,3,"D",JJ))=""  D
 .S JJ=$O(^DVBP(396.91,3,"D",JJ))
 .S X=$P(^DVBP(396.91,3,"D",JJ,0),"^")
 .D ^DIWP
 D ^DIWW
 Q
WREE ;
 ;reevaluation exam description displayed using ^DIWP
 ;
 K ^UTILITY($J,"W")
 N JJ,DIWF,DIWL,X
 W !!
 S JJ=0,DIWF="WN",DIWL=5
 F  Q:$O(^DVBP(396.91,4,"D",JJ))=""  D
 .S JJ=$O(^DVBP(396.91,4,"D",JJ))
 .S X=$P(^DVBP(396.91,4,"D",JJ,0),"^")
 .D ^DIWP
 D ^DIWW
 Q

DVBCLMU5
DVBCLMU5 ;ALB/CMM  LIST MANAGER PROTOCOLS ;11/12/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;Jumping to a new exam from within the view screen Protocol
 ;Super Quit Protocol
 ;Removal of previously viewed screens that have been disgarded
 ;
 ;
INIT ;
 ;JUMP PROTOCOL
 I VWQRY>5 W !,"Can't jump again until you close another screen." S VALMBCK="R" D PAUSE^VALM1 Q
 I DVBAC="O" W !,"CAN'T JUMP FROM AN OVERVIEW" S VALMBCK="R" D PAUSE^VALM1 Q
 S DVBCJMP="Y",QUIT="N"
 S DVBCCNT=DVBCCNT+1,VWQRY=VWQRY+1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 D A^DVBCPGD
 I '$D(QUIT) Q
 I $D(DVBCSPR) G EXIT3^DVBCPGD1
 I QUIT'="Y" S DVBCTEMP="Y"
 I QUIT="Y" S DVBCCNT=DVBCCNT-1
 I VWQRY>1 S VALMBCK="R"
 I VWQRY<2 S VWQRY=2,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY,DVBCCNT=1,TQUIT="Y"
 I DVBCCNT<3 K DVBCJMP
 S VALMBG=1,VWLINE=1
 Q
REMOVE(TQRY) ;
 ;REMOVES ALL REMAINING WINDOWS
 N WORD
 I '$D(^TMP("DVBCVIEW,"_$J_","_TQRY)) Q
 K ^TMP("DVBCVIEW",$J,TQRY)
 F  S WORD=$O(^TMP("DVBC",$J,"~"_TQRY)) Q:WORD=""  K ^TMP("DVBC",$J,WORD),^TMP("DVBC",$J,TQRY)
 Q
QUIT ;
 ;SUPER QUIT PROTOCOL
 N HOLD
 S DVBCSPR="Y",HOLD=VWQRY
 F  Q:HOLD=1  D
 .D REMOVE(HOLD)
 .S HOLD=HOLD-1
 S VWQRY=0
 S QUIT="Y"
 Q

DVBCLOG
DVBCLOG ;ALB/GTS-557/THM-LOG A 2507 REQUEST ; 9/21/91  9:26 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 I '$D(DUZ(2)) W *7,!!,"Your division number is missing.",!! H 3 G EXIT
 I $D(DUZ)#2=0 W !!,*7,"Your user number is invalid." H 3 G EXIT
 I +DUZ(2)<1 W !!,*7,"Invalid division",!! H 3 G EXIT
 ;
SETUP K ^TMP($J) D HOME^%ZIS S FF=IOF,HD="C & P Request Entry for",HD1="C & P Request Veteran Selection",HD2="Exam selection"
 ;
EN D KILL W @FF,?(IOM-$L(HD1)\2),HD1,!!! D ^DVBCPATA I $D(OUT) K OUT G EXIT
 S %DT="TS",X="NOW" D ^%DT S CTIM=Y K X,Y,%DT
 I $D(EDIT) K EDIT W @IOF,!,HD1," continued ---",!!!!!!
 ;
WARD S WARD=$S($D(^DPT(DFN,.1)):$P(^(.1),U,1),1:"") I WARD]"" W *7,"Vet is an INPATIENT, on ward "_WARD,!,"Want to continue" S %=2 D YN^DICN I $D(DTOUT) G EXIT
 I $D(%Y),%Y["?" W !!,"Enter Y to proceed with the request or N to go",!,"back and re-select.",!! G WARD
 I $D(%),%'=1 G EN
 K DVBCNEW,DA,DD,DO,X,Y W !!
 S DIC="^DVB(396.3,",DIE=DIC,DIC(0)="EQLM",X=DFN,DLAYGO=396.3
 K OUT D HDR,^DVBCEEXM,DDIS^DVBCUTL2 K DIC("W") S X=DFN D DR,FILE^DICN K DLAYGO I $D(DTOUT) W *7,"   ... Timed out!  " H 1 W *7 S REQDA=+Y D DEL G EN
 I +Y<0 H 2 G EN ;deletions via ^ in file^dicn
 S (DA,REQDA)=+Y
 D:$P(^DVB(396.3,REQDA,0),"^",10)="E" INSUF^DVBCLOG2
 I $D(DVBAOUT) D DEL G EN
 ;
EDIT1 K ANS W !!,"Select action:",!!," Press [RETURN] to continue, or enter E to edit or X to cancel:  Continue// " R ANS:DTIME I '$T D DEL G EXIT
 I ANS[U W *7,!!,"""^"" NOT allowed here" G EDIT1
 I ANS["?" W !!,"[RETURN] will continue to exam selection, E will allow",!,"editing of what you have entered and X will DELETE",!,"the entire request" G EDIT1
 I ANS="E" K DVBAINRQ S:$P(^DVB(396.3,REQDA,0),"^",10)="E" DVBAINRQ="" W !?20,"(Edit) " H 1 S DA=REQDA,DIE="^DVB(396.3,",DR="9;10:10.2;29;21;24" D HDR,^DIE D:$P(^DVB(396.3,REQDA,0),"^",10)'="E"&($D(DVBAINRQ)) CLINSF^DVBCLOG2
 I ANS="E"&($D(DVBAINRQ)&($P(^DVB(396.3,REQDA,0),"^",10)="E")) DO
 .S DIR(0)="Y^AO",DIR("A")="Do you want to change the request this insufficient is linked to? "
 .S DIR("?")="Enter Yes to change the link and No to keep the current link",DIR("B")="NO" D ^DIR
 .I +Y=1 K DIR,Y D CLINSF^DVBCLOG2 S DA=REQDA D INSUF^DVBCLOG2
 I ANS="E"&('$D(DVBAINRQ)&($P(^DVB(396.3,REQDA,0),"^",10)="E")) D INSUF^DVBCLOG2
 I ANS="E",($D(DVBAOUT)) D DEL G EN
 I ANS="E" K DVBAINRQ G EDIT1
 I ANS="X" W !?20,"(Cancel) " D DEL K ANS G EN
 I ANS'?1"E"&(ANS'?1"X")&(ANS'?1"") W !!,*7,"Must be the RETURN key, X, or E " G EDIT1
 K DIC,DIE,ANS D ^DVBCLOGE I $D(OUT) K OUT D DEL
 I $D(DVBCLCKD) D DEL
 H 1 D KILL G EN
 ;
EXIT G KILL^DVBCUTIL
 ;
HDR W @FF,?(IOM-$L(HD)\2),HD,!!,"Veteran name: ",$P(PNAM,",",2,99)," ",$P(PNAM,",",1),?55,"SSN: ",SSN,!?53,"C-NUM: ",CNUM,!
 F LINE=1:1:IOM W "="
 W ! Q
 ;
DEL S DIK="^DVB(396.3,",DA=REQDA D ^DIK W !!,*7,"Request DELETED.",! K DIK,REQDA,DA S OUT=1 D CONTMES^DVBCUTL4 Q
 ;
KILL K %DT,CNUM,DFN,DIK,DR,DTA,DXCOD,DXNUM,EDIT,EX,ROUTLOC,EXMNM,EXMPT,PNAM,SSN,PCT,SC,REQDA,VX,JJ,X,%,^TMP($J),DA,DO,DD
 K Y,DVBCNEW,DIC,DIE,Y,DA,%Y,ADD1,ADD2,CITY,CNTY,CTIM,D0,DX,ELIG,INCMP,PRDSV,STATE,WARD,ZIP,DUOUT,DTOUT,DVBCLCKD,DVBAOUT,DVBADTOT
 Q
 ;
DR S DIC("DR")="1////"_CTIM_";17////N"_";2////^S X=DUZ(2);3////^S X=DUZ;9;10;10.1;10.2;S %DT(0)=-DT;29;21;24" Q

DVBCLOG2
DVBCLOG2 ;ALB/GTS-LOG A 2507 REQUEST CONT; 11/17/94  1:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
CLINSF ;** Reset 2507 when priority changed from Insufficient
 S DA=REQDA,DIE="^DVB(396.3,",DR="44///@;45///@"
 D ^DIE
 K DA,DIE,DR,Y
 Q
 ;
INSUF ;** Enter Insuffient 2507 info
 W @IOF
 S DVBADFN=$P(^DVB(396.3,REQDA,0),"^",1),DVBADA="",DVBASTAT="C"
 D REQARY^DVBCUTL5 ;**Set up ^TMP of 2507's
 I $D(^TMP("DVBC",$J)) DO REQSEL^DVBCUTL5 S DVBASEL=+Y ;** Select 2507
 I '$D(^TMP("DVBC",$J)) S DVBASEL=0
 I +DVBASEL>0 DO  ;** Update ORIGINAL 2507 REQUEST
 .S DVBAORD=""
 .D FINDDA^DVBCUTL5 ;** Loop through ^TMP and get selected DA
 .K DA,DIE,DR,Y
 .S DA=REQDA,DIE="^DVB(396.3,",DR="44////"_DVBADA D ^DIE
 K DA,DIE,DR,Y,DIR,X,^TMP("DVBC",$J),DVBAORD,DVBAMORE,DVBACNT,DVBALP
 K DVBAPNAM,DVBASEL,DVBAOUT,DVBADA,DVBADFN,DVBADT,DVBADTOT
 ;
 ;** If 2507 not linked to completed 2507 and not time or '^' out
 ;**  when selecting 2507, enter 2507 PROCESSING TIME
 ;**   NOTE: I '$D(DVBAOUT) removed 2/3/95 because killed above
 I $D(^DVB(396.3,REQDA,5)),(+$P(^DVB(396.3,REQDA,5),U,1)'>0) DO
 .K DTOUT,DUOUT,Y
 .S DA=REQDA,DIE="^DVB(396.3,"
 .S DR="45"
 .D ^DIE
 .S:$D(DTOUT) DVBADTOT=""
 .I $D(DTOUT)!($D(Y)) S DVBAOUT=""
 I '$D(^DVB(396.3,REQDA,5)) DO
 .K DTOUT,DUOUT,Y
 .S DA=REQDA,DIE="^DVB(396.3,"
 .S DR="45"
 .D ^DIE
 .S:$D(DTOUT) DVBADTOT=""
 .I $D(DTOUT)!($D(Y)) S DVBAOUT=""
 K DIE,DR,DA
 S DA=REQDA
 ;
 ;**If 2507 not linked and 2507 Processing Time not entered
 I '$D(DVBADTOT) DO
 .I $D(^DVB(396.3,REQDA,5)),((+$P(^DVB(396.3,REQDA,5),U,1)'>0)&($P(^DVB(396.3,REQDA,5),U,2)="")) D PASS1
 .I '$D(^DVB(396.3,REQDA,5)) D PASS1
 K DVBADTOT
 Q
 ;
PASS1 ;** Insufficient 2507 selection error on edit of newly created 2507
 S TVAR(1,0)="0,0,0,1,0^You must either select a request to link or enter the 2507 Processing Time."
 S TVAR(2,0)="0,0,0,1,0^Enter 0 if you don't know the processing time of the original request."
 D WR^DVBAUTL4("TVAR")
 K TVAR
 S DVBAOUT=""
 Q

DVBCLOGE
DVBCLOGE ;ALB/GTS-557/THM-SET UP C&P EXAM ; 5/10/91  8:55 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;if $D(OUT), request deleted - exams must be completed
 ;
EXMHD K OUT N DVBARQDT,DVBADT,DVBADA
 W @FF,?(IOM-$L(HD2)\2),HD2
 W !!,"Please select the exams for ",$P(PNAM,",",2,99)," ",$P(PNAM,",",1)
 W !,"Use ? to see a list of exams available for selection.",!!
 I $D(^DVB(396.3,REQDA,5)),($P(^DVB(396.3,REQDA,0),"^",10)="E"&(+$P(^DVB(396.3,REQDA,5),"^",1)'>0)) DO
 .S TVAR(1,0)="0,0,0,1,0^NOTE:  This request has a priority of Insufficient without a link"
 .S TVAR(2,0)="0,8,0,1:1,0^to a completed request."
 .S TVAR(3,0)="0,0,0,1:2,0^Use care to select the proper exam(s) to return as insufficient."
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 I '$D(^DVB(396.3,REQDA,5))&($P(^DVB(396.3,REQDA,0),"^",10)="E") DO
 .S TVAR(1,0)="0,0,0,1,0^NOTE:  This request has a priority of Insufficient without a link"
 .S TVAR(2,0)="0,8,0,1:1,0^to a completed request."
 .S TVAR(3,0)="0,0,0,1:2,0^Use care to select the proper exam(s) to return as insufficient."
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 ;
EXMSEL K DIC,OUT,DVBAQT I $D(DVBCLCKD) Q
 S DVBARQDT=$P(^DVB(396.3,REQDA,0),U,2)
 I $D(^DVB(396.3,REQDA,5)),(+$P(^DVB(396.3,REQDA,5),U,1)>0) DO
 .S DVBAINDA=+$P(^DVB(396.3,REQDA,5),U,1) ;**Exam Scr for Insuff 2507'S
 .S DIC("S")="I $D(^DVB(396.4,""ARQ"_DVBAINDA_""",Y))"
 S:'$D(DIC("S")) DIC("S")="I $P(^(0),U,5)'=""I"""
 S DIC="^DVB(396.6,"
 S DIC(0)="AEQM",DIC("A")="Select EXAM: " D ^DIC
 S:$D(DTOUT) OUT=1 D:$D(OUT) KVARS Q:$D(OUT)
 G:X=""!(X=U) EXMDIS ;Only out of EXMSEL
 I +Y>0 S EXMNM=$P(^DVB(396.6,+Y,0),U,1),EXMPTR=+Y
 I +Y<0 W "  ???" G EXMSEL
 I $D(^TMP($J,"NEW",EXMNM)) W "    Duplicate - ignored",!,*7 G EXMSEL
 I $D(^DVB(396.4,"APS",DFN,EXMPTR,"O"))>0 W *7,"  -- already ON FILE",!
 I $D(^DVB(396.4,"APS",DFN,EXMPTR,"O"))>0 S DVBAQT=1
 G:$D(DVBAQT) EXMSEL
 S ^TMP($J,"NEW",EXMNM)=+Y K Y G EXMSEL
 ;
EXMDIS W @FF,!! K %,%Y,DIE,DIC G:$D(DVBCLCKD) EXMSEL
 I '$D(^TMP($J,"NEW")) W !!,*7,"You have not selected any exams.",!,"Do you want to try again" S %=1 D YN^DICN D:%=1 KVARS G:%=1 EXMHD I $D(DTOUT) S OUT=1 D KVARS Q
 I $D(%Y) I %Y["?" W !!,"Enter Y to go back and select exams or N to DELETE the entire request",!,"as well as any exams selected." D CONTMES^DVBCUTL4 G EXMDIS
 I $D(%) I %'=1 S OUT=1 D KVARS Q
 W !!,"You have selected these exams:",!! S EXMNM="" F JY=0:1 S EXMNM=$O(^TMP($J,"NEW",EXMNM)) Q:EXMNM=""  W ?5,EXMNM,!
 W !,$S(JY'>1:"Is this exam",1:"Are these exams")," correct"
 S %=2 D YN^DICN G:%=1 EXMLOG ;Only out of EXMDIS
 I $D(DTOUT) S OUT=1 D KVARS Q
 I $D(%Y),%Y["?" W !,"Enter Y to go ahead and log the selected exams or N to modify the list." D CONTMES^DVBCUTL4 G EXMDIS
 ;
EXMOD ;drop into - correct exams
 I $D(%),%=2 W @FF,!!!
 S DIC(0)="AEQM",DIC("A")="Enter EXAM to delete: "
 S DIC="^DVB(396.6,",DIC("S")="I $D(^TMP($J,""NEW"",$P(^(0),U,1)))"
 ;
EXMOD1 K OUT D ^DIC
 S:$D(DTOUT) OUT=1 D:$D(OUT) KVARS Q:$D(OUT)
 G:X=""!(X=U) EXMASK ;Only out of EXMOD1
 S EXMNM=$P(^DVB(396.6,+Y,0),U,1)
 I +Y>0&($D(^TMP($J,"NEW",EXMNM))) K ^TMP($J,"NEW",EXMNM) W "  Ok ..." H 1 G EXMOD1
 G EXMOD1
 ;
EXMASK W @FF,!!,"Want to add more exams"
 S %=1 D YN^DICN G:%=1 EXMSEL ;select more exams
 I $D(DTOUT) S OUT=1 D KVARS Q
 I $D(%Y),%Y["?" W !!,"Enter Y to add more exams or N to go on and log existing selections." D CONTMES^DVBCUTL4 G EXMASK
 G EXMDIS ;display exams
 ;
EXMLOG W !! S EXMNM="" K DR
 D STM^DVBCUTL4
 F DVBCJ=0:0 S EXMNM=$O(^TMP($J,"NEW",EXMNM)) Q:EXMNM=""  S X=$$EXAM^DVBCUTL4 S:X=0 DVBCLCKD=1 Q:$D(DVBCLCKD)  D EXMLOG1 Q:$D(OUT)
 S XRTN=$T(+0)
 D SPM^DVBCUTL4
 W:$D(DVBCLCKD) !!,"   Another user adding exams now...try again later."
 R:$D(DVBCLCKD) !,"   PRESS [Return] TO CONTINUE...",DVBCCONT:DTIME
 I $D(DVBCLCKD) D ROLLBCK^DVBCUTL4 G EXMDIS
 I $D(OUT) D KVARS Q
 H 2 K DA S DA=REQDA
 W @IOF,!,"Please enter any remarks for this request:",!!!
 S DR="23",DIE="^DVB(396.3," D ^DIE H 1
 K DIC,DIE,DR,EXMNM,DVBCDEL,Y,X,EXMPTR D KVARS
 Q
 ;
EXMLOG1 ;called by EXMLOG
 K OUT,DD,DO S (DIC,DIE)="^DVB(396.4,",DIC(0)=""
 S DIC("DR")=".02////^S X=REQDA;.03////^S X=$P(^TMP($J,""NEW"",EXMNM),U,1);.04////O"
 D FILE^DICN
 I $D(Y),+Y>0 W:$X>50 ! W:$X>40&($L(EXMNM)>30) ! W EXMNM_" -added, "
 I $D(Y),+Y<0 W *7,"Exam addition error ! " S OUT=1
 D INSXM^DVBCUTA1
 I $D(DTOUT) W *7,"Exam addition error ! " S OUT=1 D ROLLBCK^DVBCUTL4
 Q
 ;
KVARS ;Kill this routines variables
 K DVBARQDT,DVBADT,DVBADA,DVBAQT,DVBAINDA
 Q

DVBCLTR
DVBCLTR ;ALB/GTS-557/THM- PRINT BIG LETTERS ; 5/7/91  11:00 AM
 ;;2.7;AMIE;;Apr 10, 1995
 D ^DVBCLTR2 F DVBCLTR="VAMC","C/P","FEE","EXAM" D X1
Q K ^TMP("DVBCLTR",$J),DVBCLT1,DVBCLT2,DVBCLT3,DVBCLTX,DVBCLTY,DVBCLT
 Q
 ;
X1 S DVBCLTY=$E(DVBCLTR,1,6),DVBCLTX="" F DVBCLT1=1:1:$L(DVBCLTY) I $A(DVBCLTY,DVBCLT1)>32,$D(^TMP("DVBCLTR",$J,$E(DVBCLTY,DVBCLT1))) S DVBCLTX=DVBCLTX_$E(DVBCLTY,DVBCLT1)
 D X2
 Q
 ;
X2 W ! F DVBCLT1=9:-1:1 W ! F DVBCLT3=1:1:$L(DVBCLTX) S X=^TMP("DVBCLTR",$J,$E(DVBCLTX,DVBCLT3)) W "   " F DVBCLT2=1:1:5 W $S($E(X,(DVBCLT2-1*9+DVBCLT1)):"XXX",1:"   ")
 Q
 ;
X3 D ^DVBCLTR2 F DVBCLTR="NOTE","TO","THE","PHYS" D X1
 G Q

DVBCLTR2
DVBCLTR2 ;ALB/GTS-557/THM-SET-UP LETTERS ; 9/6/90  6:47 AM
 ;;2.7;AMIE;;Apr 10, 1995
 F Z=1:1 S X=$P($T(ZZ+Z),";;",2) Q:X=""  S ^TMP("DVBCLTR",$J,$E(X,1))=$P(X,"=",2)
 Q
ZZ ;;
 ;;0=00099999000909000900900900900900090900099999
 ;;1=000000000009000090009999999009
 ;;2=00990009000909000900900900900900900900900099
 ;;3=00090009000900000900900900900900900900099099
 ;;4=00009900000009090000009009000999999900009
 ;;5=000900999009000909009000909009000909000999009
 ;;6=000999900009009090009009009009009009000990009
 ;;7=000000009009990009000009009000000909000000099
 ;;8=00099099000900900900900900900900900900099099
 ;;9=00900099000900900900900900900090900900009999
 ;; =
 ;;!=000000000000000000009099999
 ;;"=000000000000000011000000000000000011
 ;;#=000010100001111111000010100001111111000010100
 ;;$=   2  2     2 2 2   2222222   2 2 2     2  2
 ;;'=000000000000000000000000999
 ;;(=000099900000900090009000009
 ;;)=0000000000000000000090000090009000900000999
 ;;+=000001000000001000000111110000001000000001
 ;;,=0000000009000000000999
 ;;-=000001000000001000000001000000001000000001
 ;;.=0000000000000000000099
 ;;/=000100000000010000000001000000000100000000010
 ;;:=0000000000000000000000909
 ;;;=0000000009000000000999009
 ;;==000010100000010100000010100000010100000010100
 ;;?=00000009000000000900909900900000090900000009
 ;;A=0099999000000900900000900090000900900099999
 ;;B=00999999900900900900900900900900900900099099
 ;;C=00099999000900000900900000900900000900090009
 ;;D=00999999900900000900900000900900000900099999
 ;;E=009999999009009009009009009009009009009000009
 ;;F=009999999000009009000009009000009009000000009
 ;;G=000999990009000009009000009009090009009990009
 ;;H=009999999000009000000009000000009000009999999
 ;;I=000000000009000009009999999009000009
 ;;J=000900000009000000009000000009000000000999999
 ;;K=009999999000009000000090900000900090009000009
 ;;L=009999999009000000009000000009000000009
 ;;M=009999999000000090000009900000000090009999999
 ;;N=009999999000000900000009000000090000009999999
 ;;O=00099999000900000900900000900900000900099999
 ;;P=00999999900000900900000900900000900900000099
 ;;Q=00099999000900000900909000900090000900909999
 ;;R=00999999900000900900009900900090900900900099
 ;;S=00090099000900900900900900900900900900099009
 ;;T=000000009000000009009999999000000009000000009
 ;;U=000999999009000000009000000009000000000999999
 ;;V=000099999000900000009000000000900000000099999
 ;;W=009999999000900000000099000000900000009999999
 ;;X=009900099000090900000009000000090900009900099
 ;;Y=000000099000000900009999000000000900000000099
 ;;Z=009900009009090009009009009009000909009000099

DVBCLURN
DVBCLURN ;ALB ISC/GTS - PRINT ROUTINE FOR MTLU LIST SEARCHES ;
 ;;2.7;AMIE;;Apr 10, 1995
 ;** ^TMP AND XTLKH ARE PASSED IN AND SHOULD NOT BE KILLED
 ;
 ;**  VARIABLE DESCRIPTIONS
 ;** XTLKH           - Entry number
 ;** ^TMP Global     - Sort array of entries found in file ^DIC(31,
 ;** DVBAREF         - Diagnostic code
 ;** DVBAREF0        - Zero node of current entry in ^DIC(31,
 ;** DVBAREF1        - One node of current entry in ^DIC(31,
 ;** DVBATEST        - Node in TMP array following one printed
 ;
WLINE ;** DISPLAY CODE AND TEXT FOR DIAGNOSIS
 S DVBAREF0="^DIC(31,"_Y_",0)"
 S DVBAREF1="^DIC(31,"_Y_",1)"
 I '$D(@(DVBAREF0))!('$D(@(DVBAREF1))) DO
 .W:XTLKH !,$J(XTLKH,4),": Bad 'ADVB' X-REF ("_Y_") on File 31...Notify IRM "
 Q:'$D(@(DVBAREF0))!('$D(@(DVBAREF1)))  ;** QUIT if a bad pointer exists
 S DVBAREF=$P(@(DVBAREF0),"^",3) ;** Indirection to 0 node, file 31
 W:((XTLKH>1)&(XTLKH#5=1)) !!
 W:XTLKH !,$J(XTLKH,4),": " ;** Write Entry number
 ;**
 ;** Write Detailed Desc. if exists, else write General Desc.
 ;** Use indirection to the 0 and 1 nodes, file 31 (DVBAREF0, DVBAREF1)
 ;**
 W $S($D(@(DVBAREF1)):@(DVBAREF1),1:$P(@(DVBAREF0),"^",1))
 W "  ("_DVBAREF_")"
 I XTLKH#5'>0 DO  ;** Output number remaining, if any
 .S DVBATEST=$O(^TMP("XTLKHITS",$J,XTLKH))
 .I +DVBATEST>0 DO
 ..W !!,"Selections "
 ..W XTLKH+1
 ..W " through "_^TMP("XTLKHITS",$J)_" follow."
 K DVBATEST,DVBAREF,DVBAREF0,DVBAREF1
 Q
 ;
ORPHAN ;the display for the orphan MTLU look up
 W:XTLKMULT !,$J(XTLKH,4),": "
 W $P(@(XTLKREF0),"^",1)
 Q

DVBCMDCK
DVBCMDCK ;ALB/GTS-557/THM-MISCELLANEOUS NEUROLOGICAL DISORDERS EXAM ; 12/10/90  8:36 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1225 Worksheet" S HD7="MISCELLANEOUS NEUROLOGICAL DISORDERS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 S LX="TXT1" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 W !!!!!!! S LX="TXT2" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 W !!!!!!!!!!!! D:$D(CMBN) HD2 S LX="TXT3" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 W !!!!!!!!!!!! D:'$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;If the diagnosis is NOT established or is questioned at some later
 ;;date, schedule necessary special studies, including admission
 ;;for a period of examination and observation, as appropriate to
 ;;provide a definitive diagnosis.
 ;;END
 ;
TXT1 ;
 ;;   1.  Migraine:  Obtain the best possible history of frequency and duration
 ;;   of attacks and description of level of activity the veteran can maintain
 ;;   during the attacks.  For example, state if the attacks are prostrating in
 ;;   nature or if ordinary activity is possible -
 ;;END
TXT2 ;
 ;;   2.  Tics and paramyoclonus complex:  Ascertain the muscle group(s)
 ;;   involved and obtain the best possible history of frequency and severity
 ;;   of attacks -
 ;;END
TXT3 ;
 ;;   3.  Chorea, choreiform disorders, etc:  Describe manifestations by
 ;;   impairment of strength, coordination, tremor, etc., with particular
 ;;   attention to the effects of the performance of ordinary activities
 ;;   of daily living -
 ;;END

DVBCMECK
DVBCMECK ;ALB/GTS-557/THM-MUSCULOSKELETAL, NOT ELSEWHERE CLASSIFIED ; 6/18/90  8:45 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For MUSCULOSKELETAL, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 1455 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: MUSCULOSKELETAL, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized musculoskeletal
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For MUSCULOSKELETAL, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCMKL2
DVBCMKL2 ;ALB/GTS-AMIE APPT EVENT DRIVER-LINK RTN 2 ; 10/20/94  9:00 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
LINKAPPT ;** Link C&P appt to 2507
 ;** Enhanced mode On - user prompted with checks
 ;** Enhanced mode Off - appointment added as new link
 I $D(^DVB(396.95,"AR",DVBADA)),(+$$ENHNC^DVBCUTA4=1) DO
 .S DIR("A",1)=" "
 .S DIR("A",2)="This 2507 already has appointments."
 .S DIR("A",3)="    Enter '?' for help"
 .S DIR("A")="Is this appointment due to a cancellation? "
 .S DIR("?",1)="Enter NO if the appointment is not a reschedule of another appointment"
 .S DIR("?",2)=" made previously.  Enter YES if the appointment is being scheduled because"
 .S DIR("?")=" an appointment has been or will be canceled."
 .S DIR(0)="YA^^"
 .S DIR("B")="NO"
 .S Y=""
 .F  Q:(Y=1!(Y=0)!($D(DTOUT)))  DO
 ..D ^DIR
 ..W:Y="^" *7,"  '^' NOT ALLOWED"
 .S DVBAYANS=+Y
 .K DIR,Y
 .I +DVBAYANS=1 DO  ;**Appt link selection
 ..S DVBALKRC=$$SELLNK^DVBCUTL8(DVBADA)
 ..I +DVBALKRC'>0 DO  ;**Appt not selected for reschedule
 ...S DIR("A",1)=" "
 ...S DIR("A",2)="You have not selected the linked appointment being rescheduled.  You may"
 ...S DIR("A",3)=" need to adjust the link to the appointment with the AMIE link"
 ...S DIR("A",4)=" management option to ensure proper processing time calculation for this 2507."
 ...S DIR("A",5)=" "
 ...S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue." D ^DIR K DIR,X,Y
 ..I +DVBALKRC>0 DO  ;**Appt selected for reschedule
 ...I +$P(^DVB(396.95,DVBALKRC,0),U,4)'=1!($P(^DVB(396.95,DVBALKRC,0),U,5)'="") DO
 ....K DIR,X,Y
 ....S DIR("?",1)="Enter Yes if the veteran requested a reschedule or 'No Showed' the appointment"
 ....S DIR("?")="Enter No if the Clinic required a reschedule."
 ....S DIR("A")="Is this appointment due to a veteran requested cancellation or 'No Show'"
 ....S DIR(0)="Y^AO" D ^DIR I $D(DTOUT)!($D(DUOUT)) S DVBAGETO=""
 ....K DIR,DTOUT,DUOUT
 ....I '$D(DVBAGETO) S:+Y=1 DVBAVTRQ="" DO
 .....D UPDTLK ;**Reschedule appt
 ....I $D(DVBAGETO) DO  ;**Time or '^' out
 .....K Y,DIR,DTOUT,DUOUT
 .....S DIR("A",1)=" "
 .....S DIR("A",2)="You have not indicated if the reschedule was due to action by the veteran."
 .....S DIR("A",3)="The new appointment will not be linked.  You will need to adjust"
 .....S DIR("A",4)="the link for this appointment with the AMIE/C&P appointment link management"
 .....S DIR("A",5)="option to ensure proper processing time calculation for this 2507."
 .....S DIR("A",6)=" "
 .....S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue."
 .....D ^DIR K DIR,X,Y
 ....K DVBAGETO
 ...I +$P(^DVB(396.95,DVBALKRC,0),U,4)=1&($P(^DVB(396.95,DVBALKRC,0),U,5)="") S DVBAVTRQ="" D UPDTLK ;**Vet cancel and no vet req date - reschd appt
 .I +DVBAYANS'=1 DO CRTREC^DVBCMKLK ;**Create new appt tracking record
 ;
 ;**No appointments exist for 2507 or enhanced dialogue Off
 I '$D(^DVB(396.95,"AR",DVBADA))!(+$$ENHNC^DVBCUTA4'=1) DO CRTREC^DVBCMKLK
 Q
 ;
UPDTLK ;** Update selected 396.95 link
 S DVBARSAP=$P(^DVB(396.95,DVBALKRC,0),U,3)
 K Y,DIR D RSCHAPT^DVBCMKLK(DVBALKRC,$P(SDATA,U,3))
 K DVBAVTRQ
 N DVBAAPST
 S DVBAAPST=$P(^DPT(DVBADFN,"S",DVBARSAP,0),U,2)
 I DVBAAPST="NT"!(DVBAAPST="I"!(DVBAAPST="")) DO
 .N DVBAAPIN S DVBAAPIN=DVBARSAP
 .S Y=DVBARSAP X ^DD("DD")
 .S DVBARSAP=Y K Y
 .S DIR("A",1)=" "
 .S DIR("A",2)="Remember to cancel the appointment for "_DVBARSAP
 .S DIR("A",3)=" and do NOT auto-rebook."
 .S DIR("A",4)=" "
 .S DIR("A")="Hit Return to continue"
 .S DIR(0)="FAO^1:1"
 .D:$P(SDATA,U,3)'=DVBAAPIN ^DIR
 .K DIR,Y,DVBARSAP
 Q
 ;
LINKHLP ;** Indentifier info for selected links
 N DVBACLNC,DVBADTE,DVBATIME,DVBADTWK,DVBAX
 S DVBACLNC=$P(^DPT(DVBADFN,"S",$P(^DVB(396.95,+Y,0),U,3),0),U,1)
 S DVBACLNC=$P(^SC(DVBACLNC,0),U,1)
 S DVBADTWK=$P(^DVB(396.95,+Y,0),U,3) ;**Get current date
 S DVBATIME=$P(DVBADTWK,".",2)
 S DVBADTWK=$P(DVBADTWK,".",1)
 S DVBADTE=$E(DVBADTWK,4,5)_"-"_$E(DVBADTWK,6,7)_"-"_$E(DVBADTWK,2,3)
 F DVBAX=$L(DVBATIME):1:3 S DVBATIME=DVBATIME_"0"
 S DVBATIME=$E(DVBATIME,1,2)_":"_$E(DVBATIME,3,4)
 S DVBADTE=DVBADTE_" @ "_DVBATIME
 W ?23,"Currently: ",DVBADTE,?59,DVBACLNC
 Q

DVBCMKLK
DVBCMKLK ;ALB/GTS-AMIE C&P APPT EVENT DRIVER-LINK RTN ; 10/20/94  4:00 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
EN ;** Link C&P appointment to 2507
 S DVBADFN=DFN,DVBASTAT="P" ;**DVBASTAT used in REQARY^DVBCUTL5
 ;
 ;**If user entered from AMIE Scheduling, only prompted if enhanced
 ;** dialogue turned on and is needed
 ;** QUIT on next line if from DVBCSCHD
 I $D(DVBASDRT) S DVBADA=REQDA D LINKAPPT^DVBCMKL2,KVARS QUIT  ;*DVBCSCHD
 S (DVBADA,DVBASDPR)=""
 D REQARY^DVBCUTL5 ;**Set up ^TMP of AMIE 2507's
 I +DVBACNT>0 DO
 .I +DVBACNT=1 DO  ;**Auto select 2507 if only one exists
 ..S (DVBADT,DVBADA,DVBAORD)=""
 ..S DVBAORD=$O(^TMP("DVBC",$J,DVBAORD))
 ..S DVBADT=$O(^TMP("DVBC",$J,DVBAORD,DVBADT))
 ..S DVBADA=$O(^TMP("DVBC",$J,DVBAORD,DVBADT,DVBADA))
 .I +DVBACNT>1 DO  ;**If more than one 2507 exists, user select
 ..D REQSEL^DVBCUTL5 ;**Select a 2507 from ^TMP
 ..I (+Y'>0)!($D(DVBAOUT)) S DVBADA=""
 ..S:+Y>0 DVBASEL=+Y ;**Y is selected 2507 val returned from ^DIR
 ..D:+Y>0 FINDDA^DVBCUTL5 ;**Find selected 2507 DA (Returned in DVBADA)
 .K ^TMP("DVBC",$J)
 .I '$D(^DVB(396.3,+DVBADA,0)),(+$$ENHNC^DVBCUTA4=1) DO  ;**Write warning
 ..S DIR("A",1)="You have not selected a 2507 request to link the C&P appointment to."
 ..S DIR("A",2)="The appointment should be linked with the AMIE/C&P Appointment Link"
 ..S DIR("A",3)=" Management Option to ensure proper processing time calculation for this 2507"
 ..S DIR("A",4)=" in the event of a veteran cancellation."
 ..S DIR("A",5)=" "
 ..S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue." D ^DIR K DIR,X,Y
 .I $D(^DVB(396.3,+DVBADA,0)) D LINKAPPT^DVBCMKL2 ;**If 2507, link appt
 I +DVBACNT'>0,(+$$ENHNC^DVBCUTA4=1) DO  ;**Write Warning
 .S DIR("A",1)="You have made a C&P appointment for a patient who has no pending 2507 request!"
 .S DIR("A",2)=" "
 .S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue." D ^DIR K DIR,X,Y
 Q
 ;
KVARS ;** Kill variables used by scheduling protocol
 K DVBAMORE,DVBALP,DVBAOUT,DVBADTOT,DVBASDPR,DVBASEL
 K DVBAPNAM,DVBADA,DVBADFN,DVBASTAT,DVBADT,DVBAORD,DVBACNT
 K ^TMP("DVBC",$J),Y,DVBAYANS,DVBALKRC,DVBARSAP
 Q
 ;
CRTREC ;** Add a record to file 396.95 (Appt Tracking)
 K DD,DO
 S DVBAADT=$P(SDATA,U,3)
 S DIC="^DVB(396.95,",X=DVBAADT,DIC(0)="LX",DLAYGO="396.95"
 S DIC("DR")=".02////^S X=DVBAADT;.03////^S X=DVBAADT;"
 S DIC("DR")=DIC("DR")_".04////^S X=0;.06////^S X=DVBADA;"
 S DIC("DR")=DIC("DR")_".07////^S X=1"
 D FILE^DICN K DIC,X,DLAYGO,DVBAADT
 I +$$ENHNC^DVBCUTA4=1 DO
 .N REQDT,SAVY
 .S:$D(Y) SAVY=Y
 .S REQDT=$$GETDTE(DVBADA) ;**Set REQDT
 .S:$D(SAVY) Y=SAVY
 .S DIR("A",1)=" "
 .S DIR("A",2)="Adding new C&P appointment link for 2507 request dated "_REQDT_"."
 .S DIR("A",3)=" "
 .S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue." D ^DIR K DIR,X,Y
 Q
 ;
GETDTE(REQDA) ;** Get the request dte
 N REQDT
 K Y S Y=$P(^DVB(396.3,REQDA,0),U,2) X ^DD("DD")
 S REQDT=Y
 K Y
 Q REQDT
 ;
RSCHAPT(LKDA,RSCHDT) ;** Update Appt record with reschedule data
 S DA=+LKDA,DIE="^DVB(396.95,",DR=".03////^S X=RSCHDT;.07////1"
 S:(+$P(^DVB(396.95,DA,0),U,4)=0&('$D(DVBAVTRQ))) DR=".02////^S X=RSCHDT;"_DR
 S:($D(DVBAVTRQ)) DR=".04////^S X=1;.05////^S X=RSCHDT;"_DR
 D ^DIE K DA,DIE,DR
 I +$$ENHNC^DVBCUTA4=1 DO
 .N REQDT,SAVY
 .S:$D(Y) SAVY=Y
 .S REQDT=$$GETDTE($P(^DVB(396.95,LKDA,0),U,6)) ;**Set REQDT
 .S:$D(SAVY) Y=SAVY
 .S DIR("A",1)=" "
 .S DIR("A",2)="Adjusting C&P appointment link for 2507 request dated "_REQDT_"."
 .S DIR("A",3)=" "
 .S DIR(0)="FAO^1:1",DIR("A")="Hit any key to continue." D ^DIR K DIR,X,Y
 Q

DVBCMLCK
DVBCMLCK ;ALB/GTS-557/THM-MALIGNANCIES OR TUBERCULOSIS EXAM ; 12/7/90  8:36 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0615 Worksheet" S HD7="MALIGNANCIES OR TUBERCULOSIS (GU)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Complications and/or medical side effects should always be",!?13,"reported, even when not specifically requested.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!?8,"1. Disease active or inactive -",!!!!!
 W ?8,"2. If inactive, date last treatment or date determined inactive -",!!!!!?8,"3. Assess clinical findings -",!!!!!?8,"4. Assess laboratory findings -",!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCMMCK
DVBCMMCK ;ALB/GTS-557/THM-MAMMARY EXAM ; 12/7/90  9:01 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0710 Worksheet" S HD7="MAMMARY",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:  NONE",!!
 I '$D(CMBN) W "A. Medical history (note history of augmentation mammoplasty with",!?20,"prosthetic implant or reduction mammoplasty):",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!! W "C. Objective findings:",!!!!!!!!!! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Axillary glands removal -",!!!!!!?8,"2. Size of scar -",!!!!!!
 W ?8,"3. Fixation of scar -",!!!!!!?8,"4. Contour of scar -",!!!!!!?8,"5. Muscle loss -",!!!!!!?8,"6. Tenderness of scar -",!!!!!! D:$D(CMBN) HD2 W ?8,"7. Nerve damage -",!!!!!! D:'$D(CMBN) HD2
 W ?8,"8. Presence of aching, pain or limited use of upper extremeties -",!!!!!!
 W ?8,"9. Note whether active malignant process is present -",!!!!!!?8,"10. If malignancy is inactive, state date of last surgical, radiation",!?12,"or chemical treatment -",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCMNCK
DVBCMNCK ;ALB/GTS-557/THM-MENTAL DISORDERS EXAM ; 2/11/91  10:44 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9="Full Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0905 Worksheet" S HD7="MENTAL DISORDERS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 D HD2 W "A. Medical and occupational history " S LX="TXT1" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),! I $Y>50 D HD2
 W !!!!!!!!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!!!!!!!!,"C. Objective findings:" D HD2
 W "D. Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 S LX="TXT2" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 W !!!!!!!!!,"E. Diagnostic tests (including psychological testing if deemed necessary):",!!!!!!!!!!!!!!,"F.  Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7," for ",!,NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;The severity of disability is based upon actual symptomatology,
 ;;as it affects social and industrial adaptability.  Two of the
 ;;most important determinants of disability are time lost from
 ;;gainful work and decrease in efficiency.  The rating board must
 ;;not underevaluate the emotionally sick veteran with a good work
 ;;record, nor must it overevaluate his or her condition on the
 ;;basis of a poor work record not supported by the psychiatric
 ;;disability picture.  It is for this reason that great emphasis
 ;;is placed upon the full report of the examiner, descriptive of
 ;;actual symptomatology.  The record of the history and complaints
 ;;is only preliminary to the examination.  The objective findings
 ;;and the examiner's analysis of the symptomatology are the
 ;;essentials.  The examiner's classification of the disease
 ;;as "mild", "moderate", or "severe" is not determinative of the
 ;;degree of disability, but the report and the analysis of the
 ;;symptomatology and full consideration of the history by the
 ;;rating agency will be.  In evaluating disability from psychotic
 ;;disorders it is necessary to consider, in addition to present
 ;;symptomatology or its absence, the frequency, severity and
 ;;duration of previous psychotic periods, and the veteran's
 ;;capacity for adjustment during periods of remission.  Repeated
 ;;psychotic periods, without long remissions, may be expected
 ;;to have a sustained effect upon employability until elapsed
 ;;time in good remission and with good capacity for adjustment
 ;;establishes the contrary.  Ratings are to be assigned which
 ;;represent the impairment of social and industrial adaptability
 ;;based on all evidence of record.
 ;;END
 ;
TXT1 ;
 ;;(since the historical data covering the
 ;;veteran's life up to the time of the last examination are generally in the
 ;;claim file, only the time between such last rating examination and the present
 ;;need be accounted for, unless the purpose of this examination is to ESTABLISH
 ;;service connection):
 ;;END
 ;
TXT2 ;
 ;;   1.  State whether the veteran is capable of managing his/her
 ;;       benefit payments in the individual's own best interests (a
 ;;       physical disability which prevents the veteran from attending
 ;;       to financial matters in person is not a proper basis for a
 ;;       finding of incompetency unless the veteran is, by reason of that
 ;;       disability, incapable of directing someone else in handling
 ;;       the individual's financial affairs) -
 ;;END

DVBCMOCK
DVBCMOCK ;ALB/GTS-557/THM-MENTAL, NOT ELSEWHERE CLASSIFIED ; 5/10/90  9:17 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For MENTAL, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 0905 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: MENTAL, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) Q:LY["END"  W $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized mental disorders
 ;;and to allow for new disorders not yet classified for V.A. compensation
 ;;evaluations.  The severity of a condition is based upon the residual
 ;;disability.  If there is a disease process that affects multiple systems or
 ;;extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;D. Evaluation information for the rating board:
 ;;
 ;;
 ;;
 ;;    1)  State how the residual disability affects the earning capacity of the
 ;;        Veteran in job performance.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  State how the residual disability affects normal everyday activities.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  State if the disability has constant activity or give any periods
 ;;        of remission during the year.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If there are acute exacerbations, state the effect on everyday
 ;;        life.
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For MENTAL, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCMSCK
DVBCMSCK ;ALB/GTS-557/THM-MUSCLE EXAM ; 5/21/91  9:35 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1435 Worksheet" S HD7="MUSCLES (ORTHOPEDIC)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 F AW=0:1 S AX=$T(TXT+AW) S AY=$P(AX,";;",2) W:AY="$END" !! Q:AY="$END"  W ?13,AY,!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!!!
 W ?8,"1. Tissue loss comparison -",!!!!!?8,"2. Muscles penetrated -",!!!!!?8,"3. Scar formation measurement (sensitiveness, tenderness) -",!!!!!
 W ?8,"4. Adhesions -",!!!!!?8,"5. Damage to tendons -",!!!!!?8,"6. Damage to bones, joints, nerves -",!!!!! D:$D(CMBN) HD2 W ?8,"7. Strength -",!!!!!?8,"8. Evidence of pain -",!!!!!?8,"9. Evidence of muscle hernia -",!!!!!
 D:'$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;;In conducting examinations of muscle damage and functional
 ;;impairment the muscles affected by tissue loss, penetrating
 ;;injuries, scar formation, adhesions, damage to tendons, or
 ;;other factors should be identified individually by the
 ;;pathological locations and by motions affected in strength
 ;;excursion, and diminished capacity for prolonged use.
 ;;
 ;;The standard muscle grading system should be used and
 ;;is as follows:
 ;;
 ;;Normal - through full range against normal resistance
 ;;  Good - full range, less than normal resistance
 ;;  Fair - full range, gravity only resistance
 ;;  Poor - full range, gravity and all resistance eliminated
 ;;$END

DVBCMTCK
DVBCMTCK ;ALB/GTS-557/THM-MOUTH/THROAT ; 6/27/91  7:24 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1310 Worksheet" S HD7="MOUTH AND THROAT",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"All pertinent data must be recorded in the history in order",!?13,"that the otolaryngological change discovered may be correlated",!?13,"with evidence of disease found in other systems of the",!?13,"body.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!?8,"1. Oral cavity -",!!!!!?8,"2. Pharynx -",!!!!!
 W ?8,"3. Nasopharynx -",!!!!!?8,"4. Hypopharynx -",!!!!!?8,"5. Pyriform fossae -",!!!!!?8,"6. Larynx -",!!!!! D HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNHCK
DVBCNHCK ;ALB/GTS-557/THM-NEPHROLOGICAL EXAM ; 12/27/90  1:07 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1110 Worksheet" S HD7="NEPHROLOGICAL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam:  NEPHROLOGICAL"
 W !!!!,"Narrative:"
 W ?13,"Complications and/or medical side effects should always be",!?13,"reported, even when not specifically requested.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!
 W !!?8,"1. Report presence or absence of calculi -",!!!!!?8,"2. If stone, presence and size if retained -",!!!!!?8,"3. Frequency of attacks of colic -",!!!!!?8,"4. Catheter drainage requirments, including frequency -",!!!!!
 W ?8,"5. Presence or absence of infection -",!!!!!?8,"6. Involvement of other kidney -",!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:'$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!
 W ?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNICK
DVBCNICK ;ALB/GTS-557/THM-INTESTINAL EXAM ; 12/26/90  12:29 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0315 Worksheet" S HD7="INTESTINE (DIGESTIVE)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"Detailed description of chronic, active symptomatology",!?13,"in the ""subjective complaints"" portion of this examination",!
 W ?13,"is critical to the degree of disability assigned for the",!?13,"veteran.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Current weight -",!!!!!!?8,"2. Maximum weight, past year -",!!!!!!?8,"3. Is the veteran anemic? -",!!!!!!
 W ?8,"4. Malnutrition -",!!!!!!?8,"5. Nausea -",!!!!!!?8,"6. Diarrhea and/or constipation -",! D HD2
 W ?8,"7. Bowel disturbance -",!!!!!!?8,"8. Abdominal disturbance -",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNKCK
DVBCNKCK ;ALB/GTS-557/THM-NECK EXAM ; 12/10/90  2:06 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1440 Worksheet" S HD7="NECK, ABNORMALITIES OF, ",HD6="NOT RESULT OF INJURY OR BONE DISEASE",HD8="For "_HD7_HD6 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7,!?14,HD6
 W !!!!,"Narrative:"
 W ?13,"The report of examination should include any abnormal position",!?13,"of the head, range of motion of the head, evidence of",!?13,"paralysis of the neck muscles, and asymmetry produced by",!?13,"abnormal swelling or masses.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Range of motion -",!!!!!?8,"2. Deformity -",!!!!!?8,"3. Weakness -",!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!?5,HD6,!?5,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNLCK
DVBCNLCK ;ALB/GTS-557/THM-NOT ELSEWHERE CLASSIFIED EXAM ; 11/9/90  1:16 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;Note:  This is a generic exam format for the
 ;       'Not Elsewhere Classified' exams.
 ;
XX S MX="EXM" F I=1:1 S MY=$T(@MX+I) Q:MY["$END"!(MY="")  S TNAM=$P(TNAM,"(NEC)",1) S X=$L(TNAM) S:$E(TNAM,X,X)=" " TNAM=$E(TNAM,1,X-1) Q:MY[TNAM
 Q:MY=""  S MY=$P(MY,";;",2),NARR=$P(MY,U,2),PREF=$P(MY,U,3),WKSNUM=$P(MY,U,4),DXCMT=$P(MY,U,5)
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# "_WKSNUM_" Worksheet" S HD7=TNAM_", NOT ELSEWHERE CLASSIFIED",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["$END"  D:LY["{}" FMT W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1)  How does the residual disability affect the earning capacity",!?9,"of the veteran in job performance?",!!!!!!?5,"2)  How does the residual disability affect normal everyday activities?",!!!!!!
 W ?5,"3)  If the disability has constant activity, are there",!?9,"any periods of remission during the year?",!!!!!!
 W ?5,"4)  If there are acute exacerbations, what effects are there on",!?9,"everyday life?",!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:" W:DXCMT]"" !!?5,DXCMT W !!!!!!!!!!!!!!
 D:'$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for",!,HD7,!!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;This exam is to handle the balance of currently recognized
 ;;{} disorders and to allow for new disorders not yet
 ;;classified for V. A. compensation evaluations.  The severity
 ;;of a condition is based upon the residual disability.  If
 ;;there is a disease process that affects multiple systems or
 ;;extremeties, please evaluate each separately.
 ;;$END
 ;
FMT S LZ=$P(LY,"{}",1),LY=$P(LY,"{}",2),LY=LZ_NARR_LY
 Q
 ;
EXM ;;$EXAMS
 ;;MENTAL^mental^None^0905^(Including psychological testing if deemed necessary)
 ;;CARDIOVASCULAR^cardiovascular^None^0105
 ;;DIGESTIVE^digestive^None^0310
 ;;ENDOCRINE DISORDERS^endocrine^None^0415
 ;;GENITOURINARY^genitourinary^None^0610
 ;;GYNECOLOGICAL^gynecological^None^0710
 ;;NEPHROLOGICAL^nephrological^None^1115
 ;;NEUROLOGICAL^neurological^Chapter 13^1230
 ;;ORGANS OF SENSE^organs of sense^None^1320
 ;;MUSCULOSKELETAL^musculoskeletal^None^1455
 ;;PULMONARY^pulmonary^None^1515
 ;;SKIN^skin^None^1610

DVBCNNCK
DVBCNNCK ;ALB/GTS-557/THM-NEUROLOGICAL, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For NEUROLOGICAL, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 1230 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: NEUROLOGICAL, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized neurological
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For NEUROLOGICAL, NOT ELSEWHERE CLASSIFIED",!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNPCK
DVBCNPCK ;ALB/GTS-557/THM-ALL FORMS OF NEPHRITIS ; 11/7/90  11:19 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1105 Worksheet" S HD7="NEPHRITIS, EXCEPT CHRONIC PYELONEPHRITIS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Complications and/or medical side effects should always be",!?13,"reported, even when not specifically requested.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Blood pressure -",!!!!!?8,"2. Presence or absence of albumin casts -",!!!!!
 W ?8,"3. Edema -",!!!!!?8,"4. Red blood cells -",!!!!!
 W ?8,"5. Retention of non-protein nitrogen, creatinine or urea nitrogen -",!!!!!?8,"6. Describe overall impairment of kidney function -",!!!!!?8,"7. Report presence or absence of any cardiac complications -",!!!!!!!
 D HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnosic/clinical test results:",!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!," for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNSCK
DVBCNSCK ;ALB/GTS-557/THM-NOSE AND SINUS ; 7/1/91  10:14 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1315 Worksheet" S HD7="NOSE AND SINUS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:",?13,"Report both functional and cosmetic impairment.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. External nose -",!!!!!?8,"2. Nasal vestibule -",!!!!!?8,"3. Right and left nasal cavities -",!!!!!
 W ?11,"a. Septum -",!!!?10," b. Floor of the nose -",!!!!?9,"  c. Inferior meatus -",!!!!
 W ?10," d. Inferior turbinates -",!!!!?10," e. The middle meati -",!!!!?10," f. The middle turbinate -",!!!! D HD2 W ?10," g. The spheno-ethmoidal recess -",!!!!?10," h. The olfactory area -",!!!!?10," i. The superior turbinates -",!!!!!!
 W ?8,"4. The paranasal sinuses- ",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNTCK
DVBCNTCK ;ALB/GTS-557/THM-NOSE AND THROAT ; 12/10/90  2:11 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1510 Worksheet" S HD7="NOSE AND THROAT",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Describe the location and nature of the injury or disease",!?13,"with particular attention to the interference with speech,",!?13,"sense of smell, and/or breathing space.  If all or part of the",!?13,"nose is missing provide"
 W " photographs.  Localize manifestations",!?13,"of chronic sinusitis, if present.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Interference with breathing space -",!!!!?8,"2. Headaches, severity, and frequency -",!!!!?8,"3. Purulent discharge -",!!!!
 W ?8,"4. Frequency of allergic attacks, baseline status in between -",!
 W !!!?8,"5. Dyspnea -",!!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7," for ",!,NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCNTSC
DVBCNTSC ;ALB ISC/THM-REQUESTS NOT SCHEDULED IN THREE DAYS ; 9/28/91  8:13 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;;
 D HOME^%ZIS S (PG,TOTAL)=0
 S Y=DT X ^DD("DD") S DVBCDT(0)=Y D NOW^%DTC S DVBCNOW=% K %
 G EN
 ;
PRINT S DTA=^DVB(396.3,DA,0),DFN=$P(DTA,U,1),DTRPT=$P(DTA,U,5),RQSTAT=$P(DTA,U,18) Q:RQSTAT["X"  ;cancelled requests
 S Y=DTRPT X ^DD("DD") S DTRPT2=Y,RO=$P(DTA,U,3),RO=$S($D(^DIC(4,+RO,0)):$P(^(0),U,1),1:"Unknown RO"),DTSCH=$P(DTA,U,6),Y=DTSCH X ^DD("DD") S DTSCH2=Y K DTA
 S DAYS=0 I DTSCH="" S X1=DVBCNOW,X2=DTRPT D ^%DTC Q:X'>3  S DAYS=X
 I DTSCH]"" S X1=DTSCH,X2=DTRPT D ^%DTC Q:X'>3  S DAYS=X
 W PNAM,?33,^TMP($J,RQDT,PNAM,DA),?45,DTRPT2,?69,DTSCH2,?93,RO,?119,DAYS,! S TOTAL=TOTAL+1 I $Y>55 D HDR
 Q
 ;
EN W @IOF,"2507 Exams Not Scheduled Within Three Days",!!!
 S %DT(0)=-DT,%DT="AE",%DT("A")="Enter STARTING DATE REPORTED TO MAS: " D ^%DT G:Y<0 EXIT S SDATE2=Y,SDATE=Y-.5
 S %DT("A")="    and ENDING DATE REPORTED TO MAS: " D ^%DT G:Y<0 EXIT S EDATE2=Y,EDATE=Y+.2359
 K %DT S HD="2507 Requests Not Scheduled in Three Days at "_$$SITE^DVBCUTL4,HD2="From " S Y=$E(SDATE2,1,7) X ^DD("DD") S HD2=HD2_Y S Y=$E(EDATE2,1,7) X ^DD("DD") S HD2=HD2_" to "_Y
 ;
DEV W !! S %ZIS="AEQ" D ^%ZIS G:POP EXIT
 I IOM<132 W *7,!!,"A right margin of 132 is required for this output!",!! G DEV
 I $D(IO("Q")) S ZTIO=ION,ZTRTN="GO^DVBCNTSC",ZTDESC="2507 exams not scheduled in 3 days" F I="TOTAL","PG","SDATE*","EDATE*","HD*","DVBC*" S ZTSAVE(I)=""
 I  D ^%ZTLOAD W:$D(ZTSK) *7,!!,"Request queued.",!! G EXIT
 ;
GO K ^TMP($J) ;S X1=SDATE,X2=-7 D C^%DTC S SDATE=X ;allow for last month since using date reported
 U IO D HDR F RQDT=SDATE:0 S RQDT=$O(^DVB(396.3,"C",RQDT)) Q:RQDT=""!(RQDT>EDATE)  F DA=0:0 S DA=$O(^DVB(396.3,"C",RQDT,DA)) Q:DA=""  S X=$P(^DVB(396.3,DA,0),U,5) I X'<SDATE,X'>EDATE D GO1
 S PNAM="" F RQDT=0:0 S RQDT=$O(^TMP($J,RQDT)) Q:RQDT=""  F ZI=0:0 S PNAM=$O(^TMP($J,RQDT,PNAM)) Q:PNAM=""  F DA=0:0 S DA=$O(^TMP($J,RQDT,PNAM,DA)) Q:DA=""  D PRINT
 W !!,"Total requests: ",TOTAL,!!
 ;
EXIT D:$D(ZTQUEUED) KILL^%ZTLOAD K DTRPT,DTRPT2 G KILL^DVBCUTIL
 ;
GO1 K TFIND
 F XI=0:0 S XI=$O(^DVB(396.4,"C",DA,XI)) Q:XI=""  I $P(^DVB(396.4,XI,0),U,4)'="T" S TFIND=1
 I $D(TFIND) S NAME=$P(^DVB(396.3,DA,0),U,1),DVBCSSN=$S($D(^DPT(NAME,0)):$P(^(0),U,9),1:"")
 I $D(TFIND) S NAME=$S($D(^DPT(NAME,0)):$P(^(0),U,1),1:"patient file record missing"),^TMP($J,$E(RQDT,1,7),NAME,DA)=DVBCSSN K DVBCSSN
 Q
 ;if $D(TFIND) then at least one exam remains to be done locally
 ;if '$D(TFIND) then all exams are transferred and do not consider for report
 ;
HDR S PG=PG+1 I (IOST?1"C-".E)!(PG>1) W @IOF
 W DVBCDT(0),?(IOM-$L(HD)\2),HD,?(IOM-9),"Page: ",PG,!?(IOM-$L(HD2)\2),HD2,!!!
 W "Veteran name",?33,"SSN",?45,"Date reported-MAS",?69,"Date scheduled",?93,"Requested by",?119,"Days",!
 F LINE=1:1:IOM W "-"
 W !! Q

DVBCNUCK
DVBCNUCK ;ALB/GTS-557/THM-NEPHROLOGICAL, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For NEPHROLOGICAL, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 1115 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: NEPHROLOGICAL, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized nephrological
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For NEPHROLOGICAL, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCOECK
DVBCOECK ;ALB/GTS-557/THM-ORGANS OF SENSE, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For ORGANS OF SENSE, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 1320 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ORGANS OF SENSE, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized organs of sense
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For ORGANS OF SENSE, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCPATA
DVBCPATA ;ALB/JLU,557/THM-ADD NEW VET TO FILE #2 ; 10/4/91  9:22 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;determine if new patient
 S OLDHD1=HD1,HD1="Additional Veteran Information"
 K DVBCNEW,OUT,EDIT
 S DIC="^DPT(",DIC(0)="AELMQ",DLAYGO=2
 D ^DIC
 K DLAYGO
 I Y<0 S OUT=1 D EXIT1 Q
 S DA=+Y
 I $P(Y,U,3) S DVBCNEW=1
 ;
ADDR I '$D(DVBCNEW) S DTA=^DPT(DA,0),PNAM=$P(DTA,U,1),SSN=$P(DTA,U,9),DFN=DA,CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") S:CNUM="" CNUM="Unknown"
 ;
ASK K %Y I '$D(DVBCNEW) D ADDR^DVBCUTIL W !,"Is this the correct Veteran" S %=2 D YN^DICN I $D(DTOUT)!(%<0) S OUT=1 G EXIT
 I $D(%Y) I %Y["?" W !!,"Enter Y if it is the correct Veteran, N to reselect",! G ASK
 K %Y I '$D(DVBCNEW),$D(%),%'=1 D CLR G EN
 ;
ASKED1 I $D(EDIT) S DIE="^DPT(",DR="W @IOF,!,""Edit Veteran Data"",!!!;.02;.09;.313;.314;.361;.525;.323;1901;.111;.112:.115;.1112;.117;.131;.132;.326;.327" D ^DIE S EDIT=1
 ;
ASKED2 I $D(EDIT) W !!,"Want to edit it again" S %=1 D YN^DICN G:%=1 ASKED1 S:$D(DTOUT)!(%<0) OUT=1 I $D(OUT) G EXIT
 I $D(%Y),%Y["?" W !!,"Enter Y to edit the information again or N to skip.",!! H 3 G ASKED2
 W !! G EXIT1:'$D(DVBCNEW)
 S DIE("NO^")="BACKOUTOK",DIE="^DPT(",DR="[DVBA C ADD 2507 PAT]" D ^DIE K DIE("NO^") S EDIT=1
 ;
EXIT S DTA=^DPT(DA,0),PNAM=$P(DTA,U,1),SSN=$P(DTA,U,9),DFN=DA,CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") S:CNUM="" CNUM="Unknown"
 I $D(DVBCNEW) S XMB="DVBA C NEW C&P VETERAN",XMB(1)=PNAM,XMB(2)=SSN,XMB(3)=$S($D(^VA(200,+DUZ,0)):$P(^(0),U),1:"Unknown user"),Y=DT X ^DD("DD") S XMB(4)=Y D ^XMB
EXIT1 S HD1=OLDHD1 K OLDHD1,DIC,DIE,DR,%,%Y,DTA,X,Y,DVBCNEW Q
 ;
CLR W @IOF,!?(IOM-$L(HD1)\2),HD1,!!
 Q

DVBCPDCK
DVBCPDCK ;ALB/GTS-557/THM-PULMONARY TB/OTHER MYCOBACTERIAL DISEASES ; 6/27/91  12:48 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1515 Worksheet" S HD7="PULMONARY TUBERCULOSIS AND MYCOBACTERIAL DISEASES",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Is pulmonary tuberculosis or other mycobacterial disease",!?13,"active?  If so, identify the organism.  In reactivated",!?13,"cases, it is necessary to know whether this is reactivation",!
 W ?13,"of the old disease or a separate and distinct new infection.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?4,"1. IN ALL CASES:",!!?8,"a. Date of inactivity -",!!!!!?8,"b. Extent of structural damage to lungs -",!!!!!!?8,"c. Provide pulmonary function studies -",!!!!!?4,"2. In PENSION CASES ONLY:",!!!
 W ?8,"a. Disease condition after six months of treatment -",!!!!!?8,"b. Disease condition after twelve months of treatment -",!!!!!
 D:$D(CMBN) HD2 W "  Additional note to the physician:",!!!,"In all claims, if the disease is inactive and if the inactivity was confirmed",!
 W "at a non-VA facility, obtain the name and mailing address of the facility",!,"from the veteran so that the "
 W "Regional Office may request the report.",!
 D:'$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!! W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",!,HD7,!!,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCPECK
DVBCPECK ;ALB/GTS-557/THM-PULMONARY, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN S DVBAX="For PULMONARY, NOT ELSEWHERE CLASSIFIED"
 S PG=1 D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?22,"Compensation and Pension Examination",!?33,"# 1515 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: PULMONARY, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized pulmonary
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For PULMONARY, NOT ELSEWHERE CLASSIFIED",!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCPG1
DVBCPG1 ;ALB/CMM  RETRIEVAL DRIVER ;25 OCT 1993
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;
SETUP(QSTR,HNUM) ;
 N ERR
 S DVBCFLG="Y",DVBCP="Y"
 I DVBAC'="O" S VWDOC=1,TCNUM=1
 I DVBAC="O" S VWDOC=2,TCNUM=2
 D EN^DVBCLMHD
 I DVBAIR'="O" S VWDOC=1,TCNUM=1
 I DVBAIR="O" S VWDOC=2,TCNUM=2
 K @RSLTAR@(VWQRY)
 S @RSLTAR@(VWQRY,"^D",VWDOC)=""
 S ERR=$$EN^DVBCPGL(QSTR,GINDEX,VWDOC,VWQRY)
 I ERR'=0 D EXIT Q ERR
 I $O(@RSLTAR@(VWQRY,VWDOC,""))="" Q "-1^No Matches Found"
 I ERR=0 W !!,"LOADING...",!
 I VWQRY>1 D EN^DVBCVW2()
 D EXIT
 Q 0
 ;
EXIT ;
 K DVBCFLG,DVBCP,DVBCTEMP
 Q
CALLIT ;
 D SETUP^DVBCPG2
 K DVBCFLG
 Q

DVBCPG2
DVBCPG2 ;ALB/CMM SETUP DISPLAY TEXT ;25 OCT 1993
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SETUP ;
 ;Set up text to be displayed
 N LAST,TEXT,TC,FIRST
 D STCM ;BEGIN LOGGING CAPACITY MANAGEMENT
 K ^TMP("DVBCVIEW",$J,VWQRY)
 S VALMCNT=1
 S VWLINE=$$GETLN()
 S LAST=$O(@GINDEX@("~TC",TCNUM,VWLINE)),TC=@GINDEX@("~TC",TCNUM,LAST)
 S LAST=LAST-2
 F  Q:(VWLINE="")!(VWLINE>LAST)  D
 .S TEXT=$P(@GBLDOC@(VWLINE,0),"^"),@VALMAR@(VALMCNT,0)=TEXT
 .S VWLINE=$O(@GBLDOC@(VWLINE)),VALMCNT=VALMCNT+1
 S VALMCNT=VALMCNT-1,VALMBG=VALMCNT,VWLINE=1
 S @VALMAR@(0)="^^^"_VALMCNT_"^"_TC
 D STPCM
 Q
GETLN() ;
 ;Gets first line number
 N LN,OABS
 S OABS=$O(@RSLTAR@(VWQRY,VWDOC,""))
 S LN=$P(@RSLTAR@(VWQRY,VWDOC,OABS),"^")
 Q LN
STCM ;
 D:$D(XRTL) T0^%ZOSV
 ;STARTS RT MEASURE
 Q
STPCM ;
 S:$D(XRT0) XRTN=$T(+0)
 D:$D(XRT0) T1^%ZOSV
 K XRTN
 ;STOPS RT MEASURE
 ;RESULTS ARE STORED IN ^%ZRTL
 Q

DVBCPGC
DVBCPGC ;ALB/CMM CHAPTER/INTRODUCTION DRIVER ; 1/4/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;
CHAPT ;
 N ERR
 S VWQRY=2
 I IR="O" S VWDOC=2,TCNUM=2
 I IR="E" S VWDOC=5,TCNUM=3
 D DISC
 I Y<0 K Y G A^DVBCPGD
 S DVBCPASS=Y K Y
 I DVBCPASS="" W !!,"Missing lookup value in global" D PAUSE^VALM1 G A^DVBCPGD
 S DVBCFLG="Y",DVBCP="Y"
 S DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 D EN^DVBCLMHD
 S VWQRY=2
 I IR="O" S VWDOC=2,TCNUM=2
 I IR="E" S VWDOC=5,TCNUM=3
 K @RSLTAR@(VWQRY)
 S @RSLTAR@(VWQRY,"^D",VWDOC)=""
 S ERR=$$EN^DVBCPGL(DVBCPASS,GINDEX,VWDOC,VWQRY)
 I (ERR'=0)!($O(@RSLTAR@(VWQRY,VWDOC,""))="") W !!,"Not Available" S DVBCHLD="DVBCVIEW,"_$J_","_VWQRY D PAUSE^VALM1
 W !!,"LOADING.....",!
 I ERR=0 D EN^DVBCVW2()
 K DVBCFLG,DVBCP,DVBCTEMP
 I $D(DVBCSPR) Q
 D LEAVE^DVBCPGD
 Q
DISC ;
 ;Collect list of possible overviews
 N VAL,NUM,LOOK,XX,YY,CNT
 S CNT=0
 K ^TMP("DVBC",$J,"DSC")
 S VAL=0,LOOK="^DVBP(396.92,"_TCNUM_",""T"")"
 F  S VAL=$O(@LOOK@(VAL)) Q:(VAL="")!(VAL="ATC")  D
 .S NUM=$P(@LOOK@(VAL,0),"^",2)
 .I $P(@LOOK@(VAL,0),"^",3)=$O(@LOOK@("ATC",NUM,0)) D
 ..S CNT=CNT+1
 ..S XX=$P(@LOOK@(VAL,0),"^")
 ..S YY=$F(XX,"INTRODUCTION")+1
 ..S ^TMP("DVBC",$J,"DSC",CNT,0)=$E(XX,YY,$L(XX))_"^"_$P(@LOOK@(VAL,99),"^") S ^TMP("DVBC",$J,"DSC","B",$E(XX,YY,$L(XX)))=CNT
 ;
SELECT ;
 K SEL,NOGO,PAUSE,TCNT
 N JJ,HLD,ANS,BB,SHOW
 W !
 S JJ=0,SEL="N",Y=-1,BB="",TCNT=0,PAUSE="N"
 F  S BB=$O(^TMP("DVBC",$J,"DSC","B",BB)) Q:(BB="")!(BB="C")!($D(NOGO))!(SEL="Y")  D
 .S PAUSE="N"
 .S JJ=^TMP("DVBC",$J,"DSC","B",BB)
 .I (JJ="")!('$D(^TMP("DVBC",$J,"DSC",JJ,0))) Q
 .S TCNT=TCNT+1
 .S ^TMP("DVBC",$J,"DSC","C",TCNT)=JJ
 .S SHOW=$P(^TMP("DVBC",$J,"DSC",JJ,0),"^")
 .S SHOW=$$SPACES^DVBCPGU(SHOW)
 .W:TCNT<10 !," "_TCNT_"     "_SHOW
 .W:TCNT>9 !,TCNT_"     "_SHOW
 .I (TCNT#16)=0 S PAUSE="Y"
 .I PAUSE="N" D
 ..S HLD=BB,BB=$O(^TMP("DVBC",$J,"DSC","B",BB))
 ..I BB="" S PAUSE="Y"
 ..S BB=HLD
 .I PAUSE="Y" S ANS=$$PROMPT(TCNT)
 .I '$D(ANS)!($D(NOGO)) Q
 .I (ANS>0)&(ANS<TCNT+1) S SEL="Y",JJ=^TMP("DVBC",$J,"DSC","C",ANS),Y=$P(^TMP("DVBC",$J,"DSC",JJ,0),"^",2)
 K ^TMP("DVBC",$J,"DSC")
 Q
PROMPT(TCNT) ;
P1 N ANS
 W !!,"Select 1- "_TCNT_" or ^ to Exit " W:TCNT<CNT " or Return for more: " R ANS:DTIME W !
 I ('$T)!(ANS["^") S NOGO="Y" Q -1
 I (TCNT=CNT)&(ANS="") S NOGO="Y",SEL="N" Q -1
 I ANS="" S SEL="N" Q -1
 I (ANS>TCNT)!(ANS<1) W !!,"Not a Valid Selection, Try Again. " G P1
 I $D(NOGO) Q -1
 Q ANS

DVBCPGD
DVBCPGD ;ALB/CMM PHYSICIANS GUIDE DRIVER ; 11/16/95
 ;;2.7;AMIE;;Apr 10, 1995
 ;
N ;
 K ^TMP("DVBC",$J)
 K ^TMP("DVBCVIEW",$J)
 D NK
 K DVBCSPR,DVBCCT,QUIT,JQUIT,DVBCPOP
 D EXIT3^DVBCPGD1
 Q
NK ;
 I $D(DVBCCNT)&($D(HSPR)) I DVBCCNT=1 G EXIT2
 I $D(DVBCSPR) Q
 K HSPR
 S VWQRY=2,DVBCCNT=1,QUIT="N",VWDOC=1,TCNUM=2,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 S GINDEX="^DVBP(396.91,""AIND"")",RSLTAR="^TMP(""DVBC"",$J)",GBLDOC="^DVBP(396.91,VWDOC,""D"")"
 D A
 I $D(DVBCPOP) G NK
 I $D(DVBCCT) G NK
 Q
 ;
A ;
 I '$D(HSPR)&($D(DVBCCNT)) I (DVBCCNT<1) S DVBCPOP="" Q
 W @IOF,!!!!!
 I $D(DVBCJMP) S IR="" D EXAM
 I $D(DVBCSPR) Q
 I $D(TQUIT)!($D(JQUIT)) K TQUIT,JQUIT Q
 I $D(EXMATCH)&($D(DVBCJMP)) I $P($P(^TMP("DVBC",$J,VWQRY-1,0),"^")," ",3)="INITIAL" S INITRE=0,DVBAIR="Reevaluation" K EXMATCH
 I $D(EXMATCH)&($D(DVBCJMP)) I $P($P(^TMP("DVBC",$J,VWQRY-1,0),"^")," ",3)="REEVALUATION" S DVBAIR="Initial",INITRE=0 K EXMATCH
 I $D(TQUIT)&('$D(DVBCSPR))&($D(DVBCJMP)) K TQUIT D ST Q
 I '$D(DVBCJMP) S INITRE=-1
 I (INITRE'=0) D
 .I $D(DVBCJMP) D
 ..S DIR(0)="SMO^I:Initial;R:Reevaluation"
 ..S DIR("?")="Enter I for Initial or R for Reevaluation Exam"
 ..S DIR("??")="^W !!,""Enter I for Initial Exam - first time examination "",!,""or R for Reevaluation Exam - has been examinated for this previously """
 .I '$D(DVBCJMP) D
 ..S DIR(0)="SMO^O:Overview - General Overviews for C&P Examinations;I:Initial - First time examination of condition;R:Reevaluation - For previously rated condition;E:Exam Introductions to specific C&P examinations"
 ..S DIR("?")="Enter O for Overview, I for Initial Exam, R for Reevaluation Exam or E for Exam Introductions"
 ..S DIR("??")="^D PREHELP^DVBCPGH"
 .D ^DIR
 .I $D(DTOUT)!($D(DUOUT))!(Y="^")!(Y="")!(Y=" ") D
 ..S QUIT="Y",VWQRY=VWQRY-1
 ..I VWQRY<3 S VWQRY=2
 ..S DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 ..I DVBCCNT=1 S HSPR="Y" Q
 .I QUIT'="Y" S DVBAIR=Y(0),IR=Y,DVBAC=IR
 K DIR,Y
 I $D(HSPR) Q
 I QUIT="Y" D EXIT D CHECK Q
 I ('$D(DVBCJMP))&(IR="I")&('$D(INT)) D WINIT^DVBCLMU2 S INT="Y"
 I ('$D(DVBCJMP))&(IR="R")&('$D(REE)) D WREE^DVBCLMU2 S REE="Y"
 I '$D(DVBCJMP)&(IR'="O")&(IR'="E") D EXAM
 I $D(DVBCSPR) Q
 I $D(JQUIT) K JQUIT S DVBCPOP="" Q
 I '$D(DVBCJMP) I (IR="E")!(IR="O") D CHAPT^DVBCPGC S DVBCPOP="" Q
 I $D(TQUIT)&('$D(DVBCSPR))&($D(DVBCJMP)) K TQUIT D ST G A
 I $D(TQUIT)&('$D(DVBCJMP)) K TQUIT G NK
 I QUIT="Y" Q
 I '$D(DVBAEX)!('$D(DVBAIR))&('$D(ORPHAN)) Q
 I '$D(ORPHAN) S DVBCPASS=DVBAEX_" WITHIN3L "_DVBAIR
 I '$D(DVBCPASS) Q
 S DVBCPASS=$TR(DVBCPASS,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
 S ERK=$$SETUP^DVBCPG1(DVBCPASS,VWQRY)
 I ERK<0 W !!,"No description available in the Physician's Guide",! D PAUSE^VALM1 S VWQRY=VWQRY-1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY,VALMBCK="R"
 I $D(DVBCSPR) Q
 I (ERK<0)&($D(DVBCJMP)) S VALMBCK="R" Q
 I $D(DVBCSPR) Q
 I (QUIT="Y")&(VWQRY>1) S QUIT="N",VALMBCK="R" Q
 Q
ST ;
 S VWQRY=VWQRY-1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 I VWQRY<3 S VWQRY=2,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY,DVBCCNT=1 K DVBCJMP
 I VWQRY>1 S VALMBCK="R"
 Q
CHECK ;
 I VWQRY>2 S VALMBCK="R"
 Q
LEAVE ;
 D REMOVE^DVBCLMU5(VWQRY)
 S DVBCCNT=DVBCCNT-1
 I '$D(DVBCSPR) S VALMBCK="R"
 I '$D(DVBCJMP) G EXIT2
 I $D(DVBCSPR) Q
 Q
 ;
EXAM ;
 N SEL
 K DUOUT
 D PREREAD^DVBCPGR
 I $D(DUOUT) S JQUIT="Y"
 I $D(JQUIT) Q
 I $D(TQUIT) Q
 I $D(ORPHAN) Q
 I '$D(Y(0)) S VALMBCK="R",QUIT="Y" Q
 I $D(Y(0)) D
 .I $D(DVBCJMP) I +$P(Y(0),"^",3)=$P($P(^TMP("DVBC",$J,VWQRY-1,0),"^")," ") S EXMATCH="Y",DVBAIR=$P($P(^TMP("DVBC",$J,VWQRY-1,0),"^")," ",3)
 I ('$D(Y))&($D(DVBCJMP)) S VWQRY=VWQRY-1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY Q
 I ('$D(TQUIT)) S DVBAEX=+$P(Y(0),"^",3)
 K DIC,Y,X
 I '$D(DVBCJMP)!$D(EXMATCH) Q
 I $D(DVBCJMP) D
 .S TVWQRY=VWQRY,VWQRY=VWQRY-1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 .S INITRE=$$ASK(DVBAEX),VWQRY=TVWQRY,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 .K TVWQRY
 Q
ASK(STRNUM) ;
 ;DOES THIS EXAM NUMBER OCCUR IN THE CURRENT EXAM?
 ;RETURN 0 -> YES, -1 -> NO
 N OABS,RET,LN,STR,TLN,TC1,TC2
 S OABS=0
 S OABS=$O(@RSLTAR@(VWQRY,VWDOC,OABS))
 S LN=$P(@RSLTAR@(VWQRY,VWDOC,OABS),"^")
 S TLN=$O(@GINDEX@("~TC",VWDOC,LN))
 S TC1=@GINDEX@("~TC",VWDOC,TLN)
 S OABS=0,STR=STRNUM_" ",RET=-1
 F  S OABS=$O(@GINDEX@(STR,VWDOC,OABS)) Q:(OABS="")!(RET=0)!($D(BAD))  D
 .S LN=$O(@GINDEX@("~L",VWDOC,OABS,""))+1
 .I LN="" W !,"Missing Line Reference in global (~L,",OABS S BAD="",RET=-1 Q
 .I $D(@GINDEX@("~TC",TCNUM,LN)) S TC2=$G(@GINDEX@("~TC",TCNUM,LN))
 .I '$D(@GINDEX@("~TC",TCNUM,LN)) S TLN=$O(@GINDEX@("~TC",TCNUM,LN)),TC2=@GINDEX@("~TC",TCNUM,TLN)
 .I (TC1=TC2) S RET=0,DVBAIR=$P($P(^TMP("DVBC",$J,VWQRY,0),"^")," ",3)
 .;YES OCCURS IN CURRENT DOC
 K BAD
 Q RET
EXIT ;
 S QUIT="N"
 Q
EXIT2 ;
 K ^TMP("DVBC",$J,VWQRY)
 Q

DVBCPGD1
DVBCPGD1 ;ALB/JLU;a continuation of DVBCPGD;11/28/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EXIT3 ;
 K ^TMP("DVBC",$J),^TMP("DVBCVIEW",$J)
 K DVBAEX,DVBAIR,VALMAR,DVBCVAR,DVBCHLD,DVBCJMP,DVBCCNT,VALMBCK
 K VWLINE,REE,INT,VWQRY,VWDOC,VALMBG,VALMCNT,HSPR,DVBCPASS,DTOUT
 K DVBCTEMP,DVBCFLG,DVBCP,DVBAC,NOTWKS,TCNUM,RES,NOGO,TCDI,DUOUT
 K ERK,GBLDOC,GINDEX,INITRE,IR,ORPHAN,RSLTAR,X,Y
 Q

DVBCPGH
DVBCPGH ;ALB/CMM HELP FOR PREREAD ;3/1/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
HELP ;
 ;Help display for diagnostic code prompt when not a jump
 ;
 N OFFSET,TEXT
 D CLEAR^VALM1
 F OFFSET=1:1 S TEXT=$P($T(HELPTXT+OFFSET),";;",2,78) Q:TEXT="$END"  D
 .I TEXT="$PAUSE" D PAUSE^VALM1 W !
 .I TEXT'="$PAUSE" W !,TEXT
 D PAUSE^VALM1
 Q
 ;
HELPTXT ;
 ;Help text for diagnostic code prompt when not a jump
 ;;Select a diagnostic code by entering:
 ;;    Diagnostic Code
 ;;    AMIE Worksheet Number
 ;;    Body System
 ;;    Synonym or Keyword
 ;;    Exam Title (exact match required)
 ;;$END
HELP2 ;
 ;
 N OFFSET,TEXT
 D CLEAR^VALM1
 F OFFSET=1:1 S TEXT=$P($T(HELPTX2+OFFSET),";;",2,78) Q:TEXT="$END"  D
 .I TEXT="$PAUSE" D PAUSE^VALM1 W !
 .I TEXT'="$PAUSE" W !,TEXT
 D PAUSE^VALM1
 Q
HELPTX2 ;
 ;Help text for diagnostic code prompt when jumping
 ;;During a jump you may only select an exam to view by entering
 ;;a specific Diagnostic Code.
 ;;$END
HELP3 ;
 ;
 N OFFSET,TEXT
 D CLEAR^VALM1
 F OFFSET=1:1 S TEXT=$P($T(HELPTXT+OFFSET),";;",2,78) Q:TEXT="$END"  D
 .I TEXT="$PAUSE" D PAUSE^VALM1 W !
 .I TEXT'="$PAUSE" W !,TEXT
 F OFFSET=1:1 S TEXT=$P($T(HELPTX3+OFFSET),";;",2,78) Q:TEXT="$END"  D
 .I TEXT="$PAUSE" D PAUSE^VALM1 W !
 .I TEXT'="$PAUSE" W !,TEXT
 D PAUSE^VALM1
 Q
HELPTX3 ;
 ;Help text for diagnostic code prompt when not jumping and 2 or more ?
 ;;See MAS User Manual Appendix B, C, and D for further information
 ;;regarding Synonyms, Keywords and Body System, AMIE Worksheet numbers
 ;;$END
 ;
PREHELP ;used to display the double question mark help from the I/R/E/O in 
 ;DVBCPGD
 W !!,"Enter: ",!,"O for Overview for General Overviews for C&P Exams"
 W !,"I for Initial Exam for veterans that have never been evaluated for this           condition (diagnostic code)"
 W !,"R for Reevaluation Exam for veterans who already have this diagnosis established  (diagnostic code)"
 W !,"E for Exam Introductions to specific C&P Examinations"
 W !
 D CONTMES^DVBCUTL4
 Q

DVBCPGL
DVBCPGL ;ALB/CMM SEARCH ROUTINE ;2/18/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN(QRSTR,DVBCSI,DVBCDNM,DVBCJOB) ;
 ;
 N TRACK,WORD1,WORD2,SN,OABS,OPER,START,LAST,OABS2,FL,LN,LN2
 S TRACK=0
 S WORD1=$P(QRSTR," "),WORD2=$P(QRSTR," ",3),OPER=$P(QRSTR," ",2)
 I WORD1?.N S WORD1=WORD1_" "
 I WORD2?.N S WORD2=WORD2_" "
 S SN=$E(OPER,7,$L(OPER)-1)
 S OABS=0
 F  S OABS=$O(@DVBCSI@(WORD1,DVBCDNM,OABS)) Q:OABS=""  D
 .S LN=$O(@DVBCSI@("~L",DVBCDNM,OABS,""))
 .S START=OABS-(80*SN+1)
 .I START<0 S START=0
 .S LAST=OABS+(80*SN+1)
 .S OABS2=START
 .S FL="N"
 .F  S OABS2=$O(@DVBCSI@(WORD2,DVBCDNM,OABS2)) Q:(OABS2>LAST)!(OABS2="")!(FL="Y")  D
 ..S LN2=$O(@DVBCSI@("~L",DVBCDNM,OABS2,""))
 ..I (LN=LN2)!((LN-SN)=LN2)!((LN+SN)=LN2) S FL="Y"
 ..I ((LN-SN)<LN2)&((LN+SN)>LN2) S FL="Y"
 ..I FL="Y" S TRACK=TRACK+1 D FOUND(OABS,WORD1,WORD2,OABS2,LN,LN2)
 I TRACK>0 S @RSLTAR@(DVBCJOB,0)=QRSTR_"^1^2"
 I TRACK=0 S @RSLTAR@(DVBCJOB,0)=QRSTR_"^0^0" Q -1
 Q 0
FOUND(OFF1,WRD1,WRD2,OFF2,LIN1,LIN2) ;
 ;
 N LEN,OFS,LEN2,OFS2
 S LEN=$P(@DVBCSI@(WRD1,DVBCDNM,OFF1),"^",2)
 S OFS=$P(@DVBCSI@(WRD1,DVBCDNM,OFF1),"^")
 S LEN2=$P(@DVBCSI@(WRD2,DVBCDNM,OFF2),"^",2)
 S OFS2=$P(@DVBCSI@(WRD2,DVBCDNM,OFF2),"^")
 S @RSLTAR@(DVBCJOB,DVBCDNM,OFF1)=LIN1_"^"_OFS_"^"_WRD1_"^"_LEN
 S @RSLTAR@(DVBCJOB,DVBCDNM,OFF2)=LIN2_"^"_OFS2_"^"_WRD2_"^"_LEN2
 Q

DVBCPGR
DVBCPGR ;ALB/CMM PREREAD AND WKSHEET SELECT ;1/24/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;;*  2/17/94 GTS - Orphan file lookup added to tags PREREAD & DISPLAY
PREREAD ;
 N LOOK,CONT,PROMPT
 S SEL="N",DVBCCT="Y",STOP="N"
 I $D(TQUIT) Q
 K NOTWKS,NOGO,ORPHAN,STOP,Y,RES,DUOUT
 S PROMPT=$S('$D(DVBCJMP):"Enter Diagnostic Code or Diagnosis? ",$D(DVBCJMP):"Enter Diagnostic Code? ")
 W !,PROMPT R RES:DTIME
 I ('$T)!(RES="^")!(RES="") D
 .S JQUIT="Y",QUIT="Y",TQUIT="Y"
 .I $D(DVBCJMP) S VWQRY=VWQRY-1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY I (VWQRY<3) K DVBCJMP S VALMBCK="R"
 I $D(TQUIT) Q
 I RES=" " W !!,"Space bar return is not acceptable. Try again." G PREREAD
 I (RES?2"?")&($D(DVBCJMP)) D HELP2^DVBCPGH G PREREAD
 I (RES?2"?"."?")&('$D(DVBCJMP)) D HELP3^DVBCPGH G PREREAD
 I (RES?."?")&('$D(DVBCJMP)) D HELP^DVBCPGH G PREREAD
 S RES=$TR(RES,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
 I (+RES>9999) W !!,"Not a valid diagnostic code." D PAUSE^VALM1 G PREREAD
 I $D(DVBCJMP)&(+RES<5000) W !!,"Must jump to a specific diagnostic code." G PREREAD
 I (+RES<5000)&(+RES>0) D
 .;Worksheet number, do look up on AMIE Exam file
 .S DIC="^DVB(396.6,",DIC(0)="EMZ",X=RES,D="D",DIC("S")="N STATUS S STATUS=$P(^DVB(396.6,Y,0),""^"",5) I STATUS'=""I"""
 .D IX^DIC
 .I (Y="")!(Y="^") K DIC,Y,X,D Q
 .I Y<0 W !!,"Not a valid worksheet number or no selection made." D PAUSE^VALM1 K DIC,Y,X,D Q
 .S LOOK=+Y
 .K DIC,DA,Y,X,D
 .D DISPLAY^DVBCPGR2(LOOK,"^DVB(396.6)")
 I $D(NOGO) G A^DVBCPGD
 I SEL="Y" Q
 I (+RES>4999) D
 .;Diagnostic code, do look up on File 31
 .S DIC="^DIC(31,",DIC(0)="MZE",X=RES,DIC("W")="I $D(^(1)) W !!,^(1)"
 .S DIC("S")="I $D(^(1)) I $P(^(1),U,1)'=""""" D ^DIC
 .I Y<0 K Y S TQUIT="Y",INITRE=0 W !!,"Not a valid diagnostic code or no selection made." D PAUSE^VALM1 I $D(DVBCJMP) S VWQRY=VWQRY-1,DVBCCNT=DVBCCNT-1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY I VWQRY<2 S VWQRY=2,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY K DIC Q
 .K DIC,DUOUT
 .I Y>0 S SEL="Y"
 I SEL="Y" Q
 I (+RES=0) D
 .;first do lookup on "orphans"
 .W !!,"EXAM EXCEPTIONS LOOKUP"
 .S (XTLKGBL,XTLKKSCH("GBL"))="^DVB(396.93,",XTLKX=RES,XTLKSAY=1,DIX(0)="EMZ"
 .S XTLKSAY=0,XTLKKSCH("DSPLY")="ORPHAN^DVBCLURN",XTLKKSCH("INDEX")="ADVB"
 .D ^XTLKKWL
 .I +Y>0 S SEL="Y",ORPHAN="",DVBCPASS=$P(^DVB(396.93,+Y,0),"^",3)
 .I SEL="Y" Q
 .I $D(DUOUT) R !!,"Do you wish to continue with Body System Lookup? YES//",CONT:DTIME I ('$T)!(CONT["N")!(CONT["n")!(CONT["^") S JQUIT="" Q
 .I SEL="N" W !!,"BODY SYSTEM LOOKUP..." K STOP D BODY
 .I (SEL="Y") Q
 .I $D(STOP) I STOP="Y" Q
 .;if no match or no selection do lookup on long descriptions
 .W !!,"EXAM TITLE LOOKUP"
 .I (SEL="Y") Q
 .I $D(STOP) I STOP="Y" Q
 .I SEL="N" K STOP D TITLE
 .I (SEL="Y") Q
 .I $D(STOP) I STOP="Y" Q
 .I SEL="N" K STOP D MTLU
 Q
MTLU ;
 W !!,"MTLU LOOKUP",!
 ;if no match or no selection do lookup using MTLU
 N XTLKGBL,XTLKKSCH,XTLKX,XTLKSAY
 S (XTLKGBL,XTLKKSCH("GBL"))="^DIC(31,",XTLKX=RES,XTLKSAY=1,DIC(0)="EMZ"
 S XTLKKSCH("DSPLY")="WLINE^DVBCLURN",XTLKKSCH("INDEX")="ADVB"
 D ^XTLKKWL
 I (Y=-1)&('$D(DUOUT))&('$D(DTOUT)) W !!,"No matches found or no selection made." D PAUSE^VALM1
 I '$D(Y(0)) S SEL="N"
 I $D(Y(0)) S SEL="Y"
 K DTOUT,DUOUT
 Q
BODY ;
 ;if no match or no selection do lookup on body system
 S DIC="^DVB(396.7,",DIC(0)="MZE",X=RES D ^DIC
 I (Y="")!(Y<0) K DIC,Y,X,DUOUT Q
 K DIC,DUOUT
 S DVBABODY="Y"
 D DISPLAY^DVBCPGR2(+Y,"^DVB(396.7)")
 K DVBABODY
 Q
TITLE ;
 ;if no match or no selection do lookup on long description
 N ANS
 S DIC="^DIC(31,",DIC(0)="XZE",D="AC",X=RES D IX^DIC
 I Y>0 W !!,Y(0,0)
 I $D(DUOUT) R !!,"Do you wish to continue to the MTLU Lookup? YES//",ANS:DTIME I ('$T)!(ANS["^")!(ANS["n")!(ANS["N") S STOP="Y",JQUIT="" K DIC,X,Y,D Q
 I (+Y="")!(+Y<0) K DIC,X,Y,D Q
 K DIC,DUOUT
 S SEL="Y"
 Q

DVBCPGR2
DVBCPGR2 ;ALB/CMM DISPLAY AND SELECT ;3/15/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
DISPLAY(LK,ARRAY) ;
 N NX,CTR,LKVAL,NAME,CODE
 S NX=0,CTR=1
 K ^TMP("DVBC",$J,"DS")
 F  S NX=$O(@ARRAY@(LK,1,NX)) Q:'NX  D
 .S LKVAL=@ARRAY@(LK,1,NX,0),NAME=$P(^DIC(31,LKVAL,0),"^",1),CODE=$P(^DIC(31,LKVAL,0),"^",3),^TMP("DVBC",$J,"DS",CTR)=NAME_"^"_CODE,CTR=CTR+1
 S CTR=CTR-1
 I CTR=0 D CHECKO(LK)
 I $D(ORPHAN) Q
 I CTR=0 W !!,"No Exams associated with this selection" D PAUSE^VALM1 Q
 I CTR>0 W !!,"THERE ARE "_CTR_" MATCHES"
SELECT ;
 K SEL
 N JJ,PAUSE,HLD,ANS,AND
 S JJ=0,SEL="N"
 F  S JJ=$O(^TMP("DVBC",$J,"DS",JJ)) Q:(JJ="")!(SEL="Y")!($D(NOGO))!($D(STOP))  D
 .S PAUSE="N"
 .F  Q:(PAUSE="Y")!(JJ="")  D
 ..W !,JJ,"  ",$P(^TMP("DVBC",$J,"DS",JJ),"^"),"  ",$P(^TMP("DVBC",$J,"DS",JJ),"^",2)
 ..S HLD=JJ,JJ=$O(^TMP("DVBC",$J,"DS",JJ))
 ..I JJ="" S PAUSE="Y",JJ=HLD
 ..I (JJ#5)=0 S PAUSE="Y",JJ=HLD
 .D SEL2
 Q
SEL2 ;
 I PAUSE="Y" W !!,"SELECT 1-"_JJ_" OR ^ TO EXIT " W:JJ<CTR " OR RETURN FOR MORE: " R ANS:DTIME
 I '$T S JJ="",SEL="N",NOGO="Y" Q
 I ANS="" Q
 I (ANS["^")&('$D(DVBABODY)) S STOP="Y",JQUIT="" Q
 I (ANS["^")&($D(DVBABODY)) R !!,"Do you wish to continue to the next lookup? YES//",AND:DTIME I ('$T)!(AND["^")!(AND["n")!(AND["N") S STOP="Y",JQUIT="" Q
 I $D(AND) I (AND["Y")!(AND["y")!(AND="") S STOP="N"
 I ($D(STOP)) Q
 I (JJ=CTR)&(ANS="") S JJ="",SEL="N",NOGO="Y" Q
 I (+ANS>JJ)!(ANS<1) W !!,"NOT A VALID SELECTION, TRY AGAIN",!! G SEL2
 I (ANS>0)&(ANS<JJ+1) S SEL="Y",$P(Y(0),"^",3)=$P(^TMP("DVBC",$J,"DS",ANS),"^",2),PAUSE="Y" K ^TMP("DVBC",$J,"DS")
 Q
CHECKO(CH) ;
 N HLD
 I $O(^DVB(396.93,"AC",CH,""))'="" D
 .;ORPHAN DISPLAY
 .S HLD="",ORPHAN=""
 .F  S HLD=$O(^DVB(396.93,"AC",CH,HLD)) Q:HLD=""  D
 ..S CTR=CTR+1
 ..S ^TMP("DVBC",$J,"DS",CTR)=$P(^DVB(396.93,HLD,0),"^")_"^"_HLD
 .S SEL="N"
 .I CTR>1 D CH2
 .I CTR<2 D ONE
 Q
 ;
ONE ;this entry point handles the case of only one to select from
 S SEL="Y"
 S DVBCPASS=$P(^DVB(396.93,$P(^TMP("DVBC",$J,"DS",1),"^",2),0),"^",3)
 Q
 ;
CH2 ;
 N HLD,AND,THLD
 S HLD=0
 W !
 F  S THLD=HLD,HLD=$O(^TMP("DVBC",$J,"DS",HLD)) Q:(HLD="")  D
 .W !,HLD,"  ",$P(^TMP("DVBC",$J,"DS",HLD),"^")
 W !!,"Select 1-"_THLD_": " R ANS:DTIME
 I ('$T)!(ANS="") S Y=-1 Q
 I ANS["^" R !!,"Do you wish to continue to the next lookup?  YES//",AND:DTIME I ('$T)!(AND["^")!(AND["N")!(AND["n") S Y=-1,JQUIT="" Q
 I $D(AND) I (AND["Y")!(AND["y")!(AND="") S STOP="N"
 I (ANS<1)!(ANS>CTR) W !,"Not a valid selection, Try again" G CH2
 I (ANS>0)&(ANS<CTR+1) S SEL="Y",DVBCPASS=$P(^DVB(396.93,$P(^TMP("DVBC",$J,"DS",ANS),"^",2),0),"^",3)
 Q

DVBCPGU
DVBCPGU ;ALB/CMM REMOVAL OF SPACES FUNCTION ;2/14/94
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;This function is used to create the "B" cross reference
 ;on file 396.92 to remove the leading/extra spaces.
 ;
SPACES(XLINE) ;REMOVES LEADING/EXTRA SPACES FROM LINE
 N XPOS,LEN
 F  Q:$F(XLINE,"  ")=0  D
 .S XPOS=$F(XLINE,"  ")
 .S LEN=$L(XLINE)
 .S XLINE=$E(XLINE,1,XPOS-2)_$E(XLINE,XPOS,LEN)
 I $E(XLINE,1)=" " S XLINE=$E(XLINE,2,$L(XLINE))
 Q XLINE

DVBCPICK
DVBCPICK ;ALB/GTS-557/THM-NON TB DISEASES/INJURIES ; 6/27/91  12:56 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1505 Worksheet" S HD7="NON-TUBERCULOUS DISEASES AND INJURIES OF THE RESPIRATORY SYSTEM",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 F I=1:1 S LY=$T(TXT+I) Q:LY["END"  W ?13,$P(LY,";;",2),! I $Y>55 D HD2
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. State if active malignant process is present.  If so, nothing",!?11,"further is needed -",!!!!!!
 W ?8,"2. If malignancy is inactive, report date/place of last",!?11,"surgery, radiation or chemical therapy -",!!!!!!
 W ?8,"3. For non-malignant diseases, injuries, residuals of inactive or",!?11,"cured malignancies  -",!!?11,"a.  Report structural changes to the lungs -",!!!!! D:$D(CMBN) HD2
 W ?11,"b.  Provide pulmonary function studies -",!!!!!
 W ?11,"c.  Schedule additional special studies as necessary to evaluate",!?15,"any extra-pulmonary manifestations that may be detected -",!!!!!!
 W ?11,"d.  State whether the disease is in remission or demonstrably",!?15,"active -",!!!!!!
 D:'$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",!,HD7,!!,"for "_NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;In reporting structural changes to the lungs for the Regional
 ;;Office disability evaluations, the residuals are critical
 ;;(e.g., fibrosis, scarring, absent or resected parts, limitation
 ;;of expansion of the chest or excursion of diaphragm, presence
 ;;of bullet or missile in lung, granuloma).
 ;;
 ;;The Rating Schedule requires a pulmonary function test (PFT) in
 ;;certain lung diseases.  In the majority of the cases, PFTs and a
 ;;thorough description of the veteran's exercise tolerance will be
 ;;sufficient for rating evaluation purposes.  If such tests are, in
 ;;the examiner's opinion, not needed or medically contraindicated,
 ;;the examiner should explain why.  Generally, PFTs need not be
 ;;repeated if recent studies (within the past six months) are of
 ;;record. If the examiner feels that an arterial blood gas test is
 ;;appropriate for diagnostic purposes, the results should be reported
 ;;in paragraph E below.
 ;;END

DVBCPNCK
DVBCPNCK ;ALB/GTS-557/THM-LOSS OF PENIS ; 5/16/91  2:23 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0610 Worksheet" S HD7="LOSS OF PENIS, ALL OR PARTIAL; IMPOTENCE (GU)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"A complete and detailed examination of the entire",!?13,"genitourinary system is needed with close correlation",!?13,"between this, the history and laboratory studies.",!?13,"Any penile deformity should be described in detail.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Extent of loss -",!!!!!?8,"2. Erectile power preserved -",!!!!!?8,"3. If impotent, state cause -",!!!!!
 W ?8,"4. State whether impotence is permanent or if erectile power",!?11,"can be restored -",!!!!!?8,"5. Describe any penile deformity in detail -",!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCPND1
DVBCPND1 ;ALB/GTS-557/THM-2507 PENDING REQUESTS, PART 2 ; 4/30/91  7:09 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
NXT F DA(1)=0:0 S DA(1)=$O(^TMP($J,JX,PNAM,DFN,DA(1))) Q:DA(1)=""  D PRINT I $D(OUT) S DA(1)="",PNAM="ZZZZ",JX=$S($A(JX)>57:PNAM,1:999999)
 Q
 ;
SORT S STAT=$P(^DVB(396.3,REQDA,0),U,18) Q:"^R^X^RX^C^CT^"[(U_STAT_U)  I DVBCSORT="S" Q:STAT'=RSTAT&(RSTAT'="A")
 S PNAM=$S($D(^DPT(DFN,0)):$P(^(0),U,1),1:"Unknown"),ROUT=$S($D(^DVB(396.3,REQDA,1)):$P(^(1),U,4),1:0),RDATE=$P(^(0),U,5)
 I DVBCSORT="V" S ^TMP($J,PNAM,DFN,REQDA)="" Q
 I DVBCSORT="S" S ^TMP($J,STAT,PNAM,DFN,REQDA)="" Q
 I DVBCSORT="R",$D(ADIVNUM),ROUT=ADIVNUM S ^TMP($J,ROUT,PNAM,DFN,REQDA)="" Q
 I DVBCSORT="A" D ELAPSED I EDAYS'<ERDAYS,EDAYS'>OLDAYS S ^TMP($J,EDAYS,PNAM,DFN,REQDA)=""
 Q
 ;
SETUP K ^TMP($J) S DVBCDT(0)=$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3),PG=0
 S HEAD="Pending 2507 Requests for "_$S($D(^DVB(396.1,1,0)):$P(^(0),U,1),1:"Unknown site"),HEAD2="",PROCDT="Processed on: "_DVBCDT(0),NODATA=0 U IO D HEADER
 ;
DATA S DFN="" F J=0:0 S DFN=$O(^DVB(396.3,"B",DFN)) Q:DFN=""  F REQDA=0:0 S REQDA=$O(^DVB(396.3,"B",DFN,REQDA)) Q:REQDA=""  D SORT
 I DVBCSORT="V" S PNAM="" F I=0:0 S PNAM=$O(^TMP($J,PNAM)) Q:PNAM=""  F DFN=0:0 S DFN=$O(^TMP($J,PNAM,DFN)) Q:DFN=""  F DA(1)=0:0 S DA(1)=$O(^TMP($J,PNAM,DFN,DA(1))) Q:DA(1)=""  D PRINT I $D(OUT) S DA(1)="",PNAM="ZZZ" Q
 I DVBCSORT="R"!(DVBCSORT="A") S PNAM="" F JX=-1:0 S JX=$O(^TMP($J,JX)) Q:JX=""  F I=0:0 S PNAM=$O(^TMP($J,JX,PNAM)) Q:PNAM=""  F DFN=0:0 S DFN=$O(^TMP($J,JX,PNAM,DFN)) Q:DFN=""  D NXT
 I DVBCSORT="S" S (PNAM,JX)="" F ZX=0:0 S JX=$O(^TMP($J,JX)) Q:JX=""  F I=0:0 S PNAM=$O(^TMP($J,JX,PNAM)) Q:PNAM=""  F DFN=0:0 S DFN=$O(^TMP($J,JX,PNAM,DFN)) Q:DFN=""  D NXT
 D:$Y>60 HEADER I DVBCCNT>0 W !!,"Total pending: ",DVBCCNT,!
 I IOST?1"C-".E W !!,"Press RETURN  " R ANS:DTIME
 ;
EXIT I NODATA=0 U IO W *7,!!!!!,"No pending requests found for selected parameters.",!! H 2
 ;
KILL D:$D(ZTQUEUED) KILL^%ZTLOAD K ANS,JX,DVBCHDR,^TMP($J) G KILL^DVBCUTIL
 ;
PRINT S ADIV=$S($D(^DVB(396.3,DA(1),1)):$P(^(1),U,4),1:"") Q:ADIV'=ADIVNUM&(DVBCSORT="R")  I ADIV]"" S ADIV=$S($D(^DG(40.8,+ADIV,0)):$P(^(0),U,1),1:"Unknown Division")
 S RDATE1=$P(^DVB(396.3,DA(1),0),U,2),RDATE=$P(^(0),U,5),SSN=$P(^DPT(DFN,0),U,9),CNUM=$S($D(^(.31)):$P(^(.31),U,3),1:"Unknown") D ELAPSED
 S STATUS="Unknown" W !?10,"Division: "_ADIV,!?12,"Status: " S XX=$P(^DVB(396.3,DA(1),0),U,18),STATUS=$S(XX="N":"New",XX="P":"Pending, reported",XX="S":"Pending, scheduled",XX="R":"Released to RO, not printed",1:"")
 I STATUS="",$D(XX) S STATUS=$S(XX="C":"Completed, printed by RO",XX="X":"Cancelled by MAS",XX="RX":"Cancelled by RO",XX="T":"Transcribed",XX="NT":"New,Transferred in",XX="CT":"Completed, Transferred out",1:"Unknown")
 W STATUS,!!,PNAM,?49,"SSN: ",SSN,!?44,"Claim no: ",CNUM,!?40,"Request date: ",$E(RDATE1,4,5),"/",$E(RDATE1,6,7),"/",$E(RDATE1,2,3),!?40,"Elapsed days: ",EDAYS,!!
 S X=$S($D(^DVB(396.3,DA(1),4)):^(4),1:"")
 S OWNDOM=$P(^DVB(396.3,DA(1),0),U,22) I OWNDOM]"" W "Transferred in from ",$S($D(^DIC(4.2,+OWNDOM,0)):$P(^(0),U,1),1:"Unknown site"),!
 W !?5,"Exams requested:",!!
 ;
ITEMS D TST^DVBCUTL2 S NODATA=1,REQSTR=+$P(^DVB(396.3,DA(1),0),U,4)
 W !!,"Requested by: ",$S($D(^VA(200,+REQSTR,0)):$P(^(0),U,1),1:" (Not specified) ")," at "
 S RONAME=$P(^DVB(396.3,DA(1),0),U,3),RONAME=$S(RONAME]"":$P(^DIC(4,+RONAME,0),U,1),1:"") W $S(RONAME]"":RONAME,1:" (Not specified) "),! F L=1:1:79 W "-"
 S DVBCCNT=DVBCCNT+1 I IOST?1"C-".E K OUT W !!!,"Press RETURN to continue or ""^"" exit  " R ANS:DTIME S:'$T!(ANS=U) OUT=1 Q:$D(OUT)  D HEADER Q
 W ! I $Y>45 D HEADER
 Q
 ;
HEADER S PG=PG+1 W @IOF,!!
 W ?(80-$L(HEAD)\2),HEAD,?71,"Page: ",PG,!?(80-$L(DVBCHDR)\2),DVBCHDR,!! I HEAD2]"" W ?(80-$L(HEAD2)\2),HEAD2,!
 W ?(80-$L(PROCDT)\2),PROCDT,!?(80-$L(HEAD3)\2),HEAD3,! F LN=1:1:80 W "="
 W !!
 Q
 ;
ELAPSED K EDAYS,X1,X2,X S X1=DT,(X2,X)=RDATE D:ELTYP="C" ^%DTC D:ELTYP="W" ^XUWORKDY S EDAYS=X

DVBCPNDR
DVBCPNDR ;ALB/GTS-557/THM-2507 PENDING REQUESTS, PART 1 ; 2/11/91  9:04 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S DVBCCNT=0 D HOME^%ZIS W @IOF,"Pending 2507 Request Report",!!! K NOASK S ADIVNUM="",ADIV="",FF=IOF
 ;
ASK W !!,"Do you want to sort by:",!!?5,"(A)ge of request",!?5,"(S)tatus",!?5,"(V)eteran name",!?5,"(R)outing location",!!?5,"Selection:   V// " R DVBCSORT:DTIME G:'$T!(DVBCSORT=U) KILL^DVBCUTIL
 S:DVBCSORT="r" DVBCSORT="R"
 S:DVBCSORT="a" DVBCSORT="A"
 S:DVBCSORT="s" DVBCSORT="S"
 S:DVBCSORT="v" DVBCSORT="V"
 I DVBCSORT'=""&("A^S^V^R"'[DVBCSORT) W !!,*7,"Answer must be A, S, V, or R.",!! H 3 W @IOF G ASK
 W $S(DVBCSORT="V":"eteran name",DVBCSORT="":"Veteran name",DVBCSORT="A":"ge of request",DVBCSORT="S":"tatus",DVBCSORT="R":"outing location",1:"") I DVBCSORT="" S DVBCSORT="V"
 S DVBCHDR=$S(DVBCSORT="V":"Veteran name",DVBCSORT="R":"Routing location",DVBCSORT="S":"Status",DVBCSORT="A":"Age of request",1:"Unknown"),DVBCHDR="Sorted by "_DVBCHDR
 ;
SSORT H 1 I DVBCSORT="S" W @IOF,"Status selection:",!!!!,"Select STATUS (enter A for all): P// " R RSTAT:DTIME G:'$T!(RSTAT=U) KILL^DVBCUTIL I RSTAT="" S RSTAT="P" W RSTAT
 I DVBCSORT="S" S:RSTAT="n" RSTAT="N" S:RSTAT="t" RSTAT="T" S:RSTAT="p" RSTAT="P" S:RSTAT="a" RSTAT="A"
 I DVBCSORT="S",RSTAT'?1"N",RSTAT'?1"P",RSTAT'?1"T",RSTAT'?1"A" W *7,!!,"Status must be N (new), P (pending), T (transcribed) or A (all)" H 3 G SSORT
 I DVBCSORT="S" W $S(RSTAT="P":"ending",RSTAT="T":"ranscribed",RSTAT="N":"ew",RSTAT="A":"ll",1:"")
 ;
ESORT I DVBCSORT="A" W @IOF,!,"Age selection:",!!!?5,"Enter EARLIEST age: " R ERDAYS:DTIME G:'$T!(ERDAYS=U) KILL^DVBCUTIL
 I DVBCSORT="A",(ERDAYS<1) W *7,!!,"Enter the shortest time span (in days) which 2507 processing has elapsed.",!,"Cannot be less than one day !",!,"If you want NEW requests (zero days), sort by status.",!! D CONTMES^DVBCUTL4 G ESORT
 ;
OSORT I DVBCSORT="A" W !?8," and OLDEST age: " R OLDAYS:DTIME G:'$T!(OLDAYS=U) KILL^DVBCUTIL
 I DVBCSORT="A",(OLDAYS<1) W *7,!!,"Enter the longest time span (in days) which 2507 processing has elapsed.",!,"Cannot be less than 1 day",!! H 4 G OSORT
 I DVBCSORT="A",ERDAYS>OLDAYS W *7,!!,"Earliest age must be less than oldest age",!! H 2 G ESORT
 G CALWRK:DVBCSORT'="R" H 1 W @IOF,!,"Routing Location Selection:",!!! S DIC="^DG(40.8,",DIC(0)="AEQM",DIC("A")="Enter MEDICAL CENTER DIVISION: " D ^DIC G:X=""!(X=U)!('$T) KILL^DVBCUTIL S ADIVNUM=+Y I ADIVNUM<0 G KILL^DVBCUTIL
 ;
CALWRK W !!,"Do you want elapsed time reported",!," in (C)alender days or (W)ork days?  C// " R ELTYP:DTIME I '$T!(ELTYP=U) G KILL^DVBCUTIL
 S:ELTYP="c" ELTYP="C"
 S:ELTYP="w" ELTYP="W"
 I ELTYP'?1"W"&(ELTYP'?1"C")&(ELTYP'="") W !!,*7,"Must be C for Calendar, W for Workdays",!,"or simply press RETURN to accept the default.",!! H 2 G CALWRK
 W $S(ELTYP="":"Calendar",ELTYP="C":"alendar",ELTYP="W":"ork",1:"Unknown")_" days" I ELTYP="" S ELTYP="C"
 S HEAD3="(Elapsed time in "_$S(ELTYP="C":"Calendar",ELTYP="W":"Work",1:"Unknown")_" days)"
 ;
DEV W !! S %ZIS="AEQ",%ZIS("A")="Printing device: " D ^%ZIS K %ZIS G:POP KILL^DVBCUTIL
 I $D(IO("Q")) S ZTRTN="SETUP^DVBCPND1",ZTIO=ION,ZTDESC="2507 PENDING REPORT",NOASK=1 F I="STAT","RSTAT","DVBC*","HEAD*","ELTYP","CMPDIV","ERDAYS","OLDAYS","ADIVNUM","ADIV","NOASK","DUZ" S ZTSAVE(I)=""
 I  D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued.",!! H 1 G KILL^DVBCUTIL
 G SETUP^DVBCPND1

DVBCPRCK
DVBCPRCK ;ALB/GTS-557/THM-THE PERIPHERAL NERVES EXAM ; 12/27/90  1:32 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1230 Worksheet" S HD7="THE PERIPHERAL NERVES",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:  None",!!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 S LX="TXT1" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 D:$D(CMBN) HD2 S LX="TXT2" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 D:'$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT1 ;
 ;;   1.  Where disability is the result of brain disease or injury, spinal cord
 ;;       disease or injury, cervical disc disease, or trauma to the nerve roots
 ;;       themselves, report sensory and motor impairment by reference to the
 ;;       distribution of the affected groups as paralysis, neuritis or
 ;;       neuralgia.  Report each affected extremity separately -
 ;;
 ;;
 ;;       a.  In the upper extremities -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;       b.  In the lower extremities -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;END
TXT2 ;
 ;;   2.  Where disability is NOT from the above, identify the specific major
 ;;       nerve involved, localize the lesion and describe specific impairment
 ;;       of motor and sensory function, fine motor control, etc..  Again
 ;;       characterization as paralysis, neuritis or neuralgia is necessary
 ;;       Indicate whether any muscle wasting or atrophy represents direct
 ;;       effect of nerve damage or merely disuse.  Report each affected
 ;;       extremity separately -
 ;;
 ;;
 ;;       a.  In the upper extremities -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;       b.  In the lower extremities -
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;END

DVBCPRN1
DVBCPRN1 ;ALB/GTS-557/THM-C&P FINAL REPORT PRINT ; 9/3/91  8:05 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
PHYS S PHYS=$S($D(^DVB(396.4,DA,0)):$P(^(0),U,7),1:"")
 Q
 ;
STEP2A S EXMNM=$S($D(^DVB(396.6,JI,0)):$P(^(0),U,1),1:"Unknown exam") I $D(AUTO),$D(XEXMNM),EXMNM'=XEXMNM Q  ;print one exam on transcription
 S EXHD="For "_EXMNM_" Exam" D HDR W "Examining provider: ",PHYS,!,"Examined on: " S Y=$P(^DVB(396.4,DA,0),U,6) X XDD W Y,! F LINE=1:1:80 W "="
 W !!?2,"Examination results:",!! K NCN S EXSTAT=$P(^DVB(396.4,DA,0),U,4) I EXSTAT="X"!(EXSTAT="RX") W !!!!!?25,"This exam was CANCELLED by ",$S(EXSTAT="RX":"the RO.",1:"MAS."),!! Q
 D STEP3
 Q
 ;
STEP2 F DA=0:0 S DA=$O(^DVB(396.4,"C",DA(1),DA)) Q:DA=""  S RO=+$P(^DVB(396.3,DA(1),0),U,3) Q:'$D(AUTO)&(DUZ(2)'=RO)  S PG=0,JI=$P(^DVB(396.4,DA,0),U,3) D PHYS,STEP2A I $D(PRINT) D BOT K PRINT
 I '$D(AUTO) S %DT="TS",X="NOW" D ^%DT S DA=DA(1),CTIM=Y,DR="6////"_CTIM_";15////"_CTIM_";16////^S X=DUZ;17////C",DIE="^DVB(396.3,",DIC=DIE D ^DIE
 Q
 ;
STEP3 K ^UTILITY($J,"W") S DIWL=1,DIWR=80,DIWF="NW" S OLDA=DA,OLDA1=DA(1)
 F LINE=0:0 S LINE=$O(^DVB(396.4,OLDA,"RES",LINE)) Q:LINE=""  S X=^DVB(396.4,OLDA,"RES",LINE,0) S:X="<" X=" <" S X=$P(X,"<",1) D ^DIWP,STEP3A
 D ^DIWW S PRINT=1 S DA=OLDA,DA(1)=OLDA1 Q
 ;
STEP3A I $Y>(IOSL-11) D UP,NEXT,HDR W:$O(^DVB(396.4,OLDA,"RES",LINE))]"" !!,"Exam Results Continued",!!
 Q
 ;
HDR S PG=PG+1 I PG>1 D HDR2^DVBCUTL2 Q
 S:ZPR'="E" TOTTIME=$$PROCDAY^DVBCUTL2(DA(1))
 S:ZPR="E" TOTTIME=$$INSFTME^DVBCUTA1(DA(1))
 S OUTTIME="Processing time: "_TOTTIME
 W @IOF
 W !,"Date: ",DVBCDT(0),?(80-$L(PGHD)\2),PGHD,?71,"Page: ",PG,!?(80-$L(DVBCSITE)\2),DVBCSITE,!
 W ?35,"** FINAL **",! W ?(80-$L(OUTTIME)\2),OUTTIME,!?(80-$L(EXHD)\2),EXHD,! F LNE=1:1:80 W "="
 K LNE S:EXHD["AGENT ORANGE" DVBCAO=1 I EXHD'["AGENT ORANGE" K DVBCAO
 D SSNOUT^DVBCUTIL
 W !!?2,"Name: ",PNAM,?56,"SSN: ",DVBCSSNO,!?51,"C-Number: ",CNUM,!?56,"DOB: " S Y=DOB X XDD W Y,!?2,"Address: ",ADR1,! W:ADR2]"" ?11,ADR2,! W:ADR3]"" ?11,ADR3,!!
 K DVBCSSNO
 W !?2,"City,State,Zip+4: ",?48,"Res Phone: ",HOMPHON,!?5,CITY,"  ",STATE,"  ",ZIP,?48,"Bus Phone: ",BUSPHON,!
 W !,"Entered active service: " S Y=EOD X XDD S:Y="" Y="Not specified" W Y,?40,"Last rating exam date: ",LREXMDT,! S Y=RAD X XDD S:Y="" Y="Not specified" W "Released active service: " W Y,!!,"Priority of exam: ",PRIO,!
 F LNE=1:1:80 W "="
 W ! Q
 ;
ZTSK S PG=0,AUTO=1 K ULINE
 ;$D(AUTO)=copy for review, Vet file after approval
 I '$D(DT) S X="T" D ^%DT S DT=Y
 S XDD=^DD("DD"),Y=DT X XDD S DVBCDT(0)=Y,PGHD="Compensation and Pension Exam Report",DVBCSITE=$S($D(^DVB(396.1,1,0)):$P(^(0),U,1),1:"Site name not in file")
 S $P(ULINE,"_",70)="_",XEXMNM=EXMNM K EXMNM D VARS^DVBCUTIL,STEP2,BOT
 I '$D(EDPRT) G KILL^DVBCUTIL
 Q
 ;
UP F XIX=$Y:1:(IOSL-8) W !
 Q
 ;
NEXT W !,"Continued on next page",!,"VA Form 2507"
 Q
 ;
BOT I '$D(AUTO),$D(PRINT) D UP W ?7,"This exam has been reviewed and approved by the examining provider" W:$D(DVBCAO) !?27,"and signed by the veteran" W ".",!!,"VA Form 2507",! ;if for RO
 I $D(AUTO),$D(PRINT) D UP W ?7," Approved by: ___________________________________     Date: _____________",!!
 I $D(AUTO),$D(PRINT) W "Provider signature: ___________________________________     Date: _____________",!!,"VA Form 2507",! ;if file copy
 Q

DVBCPRNT
DVBCPRNT ;ALB/GTS-557/THM-FINAL REPORT DRIVER ; 5/17/91  10:29 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 I '$D(DUZ(2)) W *7,!!,"You DIVISION NUMBER is incorrect.",! H 2 Q
 I DUZ(2)<1 W !,*7,"Your DIVISION NUMBER is invalid.",! H 2 Q
 ;
SETUP K EDPRT,ULINE S XDD=^DD("DD"),$P(ULINE,"_",70)="_" K AUTO
 D HOME^%ZIS S FF=IOF,HD="C & P Exam Printing" W @IOF,!?(IOM-$L(HD)\2),HD,!!!
 S Y=DT X XDD S DVBCDT(0)=Y,PGHD="Compensation and Pension Exam Report",DVBCSITE=$S($D(^DVB(396.1,1,0)):$P(^(0),U,1),1:"Not specified")
 W !!,"Note:  All reports will be produced in 'terminal-digit' order.",!! H 1
 ;
DEVICE S %ZIS="AEQ",%ZIS("B")="0;P-OTHER",%ZIS("A")="Output device: " D ^%ZIS G:POP KILL^DVBCUTIL
 I $D(IO("Q")) S ZTRTN="GO^DVBCPRNT",ZTIO=ION,ZTDESC="2507 Final Exam Report" F I="D*","XDD","ULINE","HD","FF","PGHD" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued",!! K ZTSK G KILL^DVBCUTIL
 ;
GO D STM^DVBCUTL4
 U IO K ^TMP($J) D HDA S (XCNT,XPRINT)=0
 F DA(1)=0:0 S DA(1)=$O(^DVB(396.3,"AF","R",DUZ(2),DA(1))) Q:DA(1)=""  DO
 .I $D(^DVB(396.3,DA(1),0)) D GO1 S XPRINT=1,XCNT=XCNT+1
 .I '$D(^DVB(396.3,DA(1),0)) D BADXRF
 I XPRINT=0 K XPRINT,XPG,XXLN W !!!!!?25,"Nothing to print",!! H 2 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBCUTIL
 I XCNT>0,XPRINT=1 W !!,"Total requests to be printed: ",XCNT,!
 K XCNT,XXLN,XPG,XPRINT,OUT
 D SETLAB
 S (XCN,PNAM)=""
 F DVBCN=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""  F JJ=0:0 S PNAM=$O(^TMP($J,XCN,PNAM)) Q:PNAM=""  K PRINT F DA(1)=0:0 S DA(1)=$O(^TMP($J,XCN,PNAM,DA(1))) Q:DA(1)=""  S DA=DA(1) D VARS^DVBCUTIL,STEP2^DVBCPRN1 I '$D(AUTO) D ^DVBCLABR,LKILL^DVBCUTL3
 S XRTN=$T(+0)
 D SPM^DVBCUTL4
 K DVBCN S LKILL=1 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBCUTIL
 ;
GO1 S DFN=$P(^DVB(396.3,DA(1),0),U,1),PNAM=$P(^DPT(DFN,0),U,1) W $E(PNAM,1,25),?28,$E($P(^(0),U,9),1,3)_" "_$E($P(^(0),U,9),4,5)_" "_$E($P(^(0),U,9),6,9)
 S CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Missing") W ?43,CNUM,?55 S Y=$P(^DVB(396.3,DA(1),0),U,2) X XDD W Y,! D:$Y>(IOSL-16) HDA
 S XCN=$E(CNUM,$L(CNUM)-1,$L(CNUM)),XCN=+XCN
 I PNAM]"" S ^TMP($J,XCN,PNAM,DA(1))=""
 K PNAM,XCN,CNUM
 Q
 ;
SETLAB N XX S XX=1,DVBCRALC(XX)="^",Y=0
 F  S Y=$O(^DVB(396.1,1,4,"B",Y)) Q:(Y="")  I $D(^SC(+Y,0)) S DVBCRALC(XX)=DVBCRALC(XX)_+Y_U I $L(DVBCRALC(XX))>230 S XX=XX+1,DVBCRALC(XX)="^"
 Q
 ;
HDA S:'$D(XPG) XPG=0 S XPG=XPG+1
 I (IOST?1"C-".E)!($D(DVBAON2)) W @IOF
 S:('$D(DVBAON2)) DVBAON2=""
 W !,"Final C&P Reports for print date " S Y=DT X XDD W Y,!!,"Operator: ",$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"Unknown operator"),!,"Location: ",$S($D(^DIC(4,+DUZ(2),0)):$P(^(0),U,1),1:"Unknown location"),!
 W !,"Veteran Name",?28,"SSN",?43,"C-Number",?55,"Request date",!
 F XXLN=1:1:79 W "-"
 W !!
 Q
 ;
WARN W !!,*7,"Too many locations to store!  Some locations may not be reported.",!! H 3 S OUT=1
 Q
 ;
BADXRF ; ** Display a message that a bad cross reference exists **
 W !,"A bad 'D' X-Reference exists on the 2507 Request File (#396.3) for"
 W " DA="_DA(1)_"."
 W !,"Please notify IRM at the facility where you have created"
 W " this report.",!!
 Q

DVBCPTCK
DVBCPTCK ;ALB/GTS-557/THM-POST-TRAUMATIC STRESS DISORDER ; 4/29/91  12:09 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9="Full Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0910 Worksheet" S HD7="POST-TRAUMATIC STRESS DISORDER",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:  "
 S LX="TXT2" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 W !!,"A. Medical and occupational history:",!!
 W ?8,"1. Immediate pre-military events and details of training -",!!!!!!!!!?8,"2. Events in the war zone -",!!!!!!!!!?8,"3. Post-active service events (to present) -",!!!!!!!!!
 W ?8,"4. Employment history prior to and following",!?11,"active service -" D HD2
 W "B. Subjective complaints (include the veteran's history of unusually ",!?27,"traumatic stressors)",!!!!!!!!!!!!!!!!!! W "C. Objective findings:",! D HD2
 ;W !!,"1) Describe the duration of the disturbance from the symptoms shown above.",!! D HD2
 W "D. Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 S LX="TXT1" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 W !!!!!!!!!!!!,"E. Diagnostic tests (including psychological testing if deemed necessary):",!!!!!!!!!!,"F. Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 D EN^DVBCPTS1 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT1 ;
 ;;   1.  State if the veteran is capable of managing his/her benefit
 ;;       payments in the individual's own best interests without restriction
 ;;       (a physical disability which prevents the veteran from attending
 ;;       to financial matters in person is not a proper basis for a finding
 ;;       of incompetency unless the veteran is, by reason of that disability,
 ;;       incapable of directing someone else in handling the individual's
 ;;       his financial affairs) -
 ;;END
 ;
TXT2 ;
 ;;No diagnosis of PTSD can be adequately documented or ruled
 ;;            out without obtaining a detailed military history.  This
 ;;            requirement means that interviewing of cases of PTSD will
 ;;            often require more time than for other disorders.  The
 ;;            history should be obtained for the three categories under
 ;;            the medical history.  Subjective complaints and objective
 ;;            findings should be related to the diagnosis criteria.  PTSD
 ;;            must be due to military service.
 ;;END

DVBCPTS1
DVBCPTS1 ;ALB ISC/THM-ATTACHMENT A FOR POST TRAUMATIC STRESS DISORDER ; 12/27/90  1:06 PM
 ;;2.7;AMIE;;Apr 10, 1995
EN S PG=0,DVBAX="Attachment A for Post-Traumatic Stress Disorder" W @IOF,!?(IOM-$L(DVBAX)\2),DVBAX,! S DVBAX="DSM-III-R Diagnostic Criteria for PTSD" W ?(IOM-$L(DVBAX)\2),DVBAX,!!!
 F I=0:1 S LY=$T(TXT+I) Q:LY["END"  W $P(LY,";;",2),!
 D EN1 G Q
 ;
EN1 F I=0:1 S LY=$T(SECTB+I) Q:LY["END"!(LY="")  W $P(LY,";;",2),! I $Y>55 D HD2^DVBCPTCK
Q K I,LY,DVBAX Q
 ;
TXT ;;A. The veteran has experienced an event that is outside the range of usual
 ;;human experience and that would be markedly distressing to almost anyone,
 ;;e.g., serious threat to one's life or physical integrity; serious threat
 ;;to one's children, spouse, or other close relatives and friends; sudden
 ;;destruction of one's home or community; seeing another person who has
 ;;recently been or being, seriously injured or killed as the result of an
 ;;accident or physical violence.
 ;;END
 ;;
SECTB ;;
 ;;B. The traumatic event is persistently re-experienced in at least one of the
 ;;   following ways:
 ;;
 ;;
 ;;    1. recurrent and intrusive distressing recollections of the event
 ;;
 ;;    2. recurrent distressing dreams of the event
 ;;
 ;;    3. sudden acting or feeling as if the traumatic event were recurring
 ;;       (includes a sense of reliving the experience, illusions, hallucinations
 ;;       and dissociative [flashback] episodes, even those that occur upon waking
 ;;       or when intoxicated)
 ;;
 ;;    4. intense psychological distress at exposure to events that symbolize or
 ;;       resemble an aspect of the traumatic event, including anniversaries of
 ;;       the trauma.
 ;;
 ;;C.  Persistent avoidance of stimuli associated with the trauma or numbing of
 ;;    general responsiveness (not present before the trauma), as indicated by
 ;;    at least three of the following:
 ;;
 ;;
 ;;    1. efforts to avoid thoughts or feelings associated with the trauma
 ;;
 ;;    2. efforts to avoid activities or situations that arouse recollections
 ;;       of the trauma
 ;;
 ;;    3. inability to recall an important aspect of the trauma (psychogenic
 ;;       amnesia)
 ;;
 ;;    4. markedly diminished interest in significant activities
 ;;
 ;;    5. feeling of detachment or estrangement from others
 ;;
 ;;    6. restricted range of affect, e.g., unable to have love feelings
 ;;
 ;;    7. sense of a foreshortened future, e.g., does not expect to hava a
 ;;       career, marriage, or children or a long life.
 ;;
 ;;
 ;;
 ;;
 ;;D.  Persistent symptoms of increased arousal (not present before the trauma),
 ;;    as indicated by at least two of the following:
 ;;
 ;;
 ;;    1. difficulty falling or staying asleep
 ;;
 ;;    2. irritability or outbursts of anger
 ;;
 ;;    3. difficulty concentrating
 ;;
 ;;    4. hypervigilance
 ;;
 ;;    5. exaggerated startle response
 ;;
 ;;    6. physiologic reactivity upon exposure to events that symbolize or
 ;;       resemble an aspect of the traumatic event (e.g., a woman who was
 ;;       raped in an elevator breaks out in a sweat when entering any elevator)
 ;;END

DVBCPUCK
DVBCPUCK ;ALB/GTS-557/THM-PITUITARY TUMORS/AROMEGALY, PROLACTINOMA ; 12/26/90  12:40 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0435 Worksheet" S HD7="PITUITARY TUMORS - ACROMEGALY, PROLACTINOMA",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W ?13,$P(LY,";;",2),!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  Frequency of headaches -",!!!!!!?5,"2.  Changes in vision -",!!!!!!?5,"3.  Cardiac symptoms -",!!!!!!
 W ?5,"4.  Joint pain -",!!!!!!?5,"5.  Acromegaly -",!!!!!!
 W ?5,"6.  Kyphosis of cervicodorsal spine -",!!!!!! D:$D(CMBN) HD2 W ?5,"7.  Abnormal glucose tolerance -",!!!!!!?5,"8.  Genital atrophy -",!!!!!! D:'$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;When symptoms interfere with normal daily activities or job
 ;;efficiency, it is essential that the extent of such handicaps
 ;;be described.
 ;;END

DVBCPURG
DVBCPURG ;ALB/GTS-557/THM-C&P PURGING PROGRAM ; 10/28/90  8:40 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - GTS/Coded to purge 396.95  (Enhc 13)
 ;   2.7 - JLU/Utilize the 2507 purge parameter
 ;
SETUP I '$D(DT) S X="T" D ^%DT S DT=Y
 S HIST=$$PAR()
 S X1=DT,X2=HIST,X2=-X2 D C^%DTC S PDATE=X
 ;
GO F TYP="C","CT","X","RX" F REGOFF=0:0 S REGOFF=$O(^DVB(396.3,"AF",TYP,REGOFF)) Q:REGOFF=""  F REQDA=0:0 S REQDA=$O(^DVB(396.3,"AF",TYP,REGOFF,REQDA)) Q:REQDA=""  D KILL
 ;
EXIT K DIK,X,Y,REGOFF,DA,I,J,PDATE,X1,X2,HIST,%,%DT,%H,TYP,REQDA,EXMDA
 Q
 ;
KILL I '$D(^DVB(396.3,REQDA,0)) K ^DVB(396.3,"AF",TYP,REGOFF,REQDA)
 I '$D(^DVB(396.3,REQDA,0)) Q  ;clean up bad index records
 S X1=PDATE
 S X2=$S(TYP["X":$P(^DVB(396.3,REQDA,0),U,19),1:$P(^DVB(396.3,REQDA,0),U,7))
 D ^%DTC I (+X>0),('$D(^DVB(396.3,"AORQ",REQDA))) D APPTLP,EXAMLP S DIK="^DVB(396.3,",DA=REQDA D ^DIK
 K DIK,DA
 Q
 ;
APPTLP ;  **  Loop through existing appointments  **
 N LPCNT
 S LPCNT=""
 F  S LPCNT=$O(^DVB(396.95,"AR",REQDA,LPCNT)) Q:LPCNT=""  DO
 .S DIK="^DVB(396.95,",DA=LPCNT D ^DIK K DA,DIK
 Q
 ;
EXAMLP ;  **  Loop through existing exams  **
 F EXMDA=0:0 S EXMDA=$O(^DVB(396.4,"C",REQDA,EXMDA)) Q:EXMDA=""  D KEXAMS
 Q
 ;
KEXAMS ;  ** Delete exams on the request  **
 S DA=EXMDA,DIK="^DVB(396.4," D ^DIK K DIK,DA
 Q
 ;
PAR() ;function call to get the number of days to retain the 2507 requests.
 ;
 N IFN,Y
 S IFN=$$IFNPAR^DVBAUTL3()
 I IFN DO
 .S Y=$P(^DVB(396.1,IFN,0),U,11)
 .I 'Y!(Y<120) S Y=120
 I 'IFN S Y=120
 Q Y

DVBCPWC1
DVBCPWC1 ;ALB ISC/THM-POW EXAM, CONTINUED ; 5/14/91  1:05 PM
 ;;2.7;AMIE;;Apr 10, 1995
 G EN
 ;
L I $Y>55 D HD2^DVBCPWCK
 Q
 ;
EN F I="bleeding","lumps or masses","vertigo","syncope","pruritis","rash","diabetes mellitus","thyroid disorders","cancer" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"b. Head, eye, ear, nose and throat",!! S CNT=0 F I="skull","scalp","vison/changes","diplopia","eye pain","conjunctivae","cornea","sclera","lens","pupils","fundi" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"Ears:",!! S CNT=0 F I="hearing loss","external ear","canals/drums","tinnitus" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"Nose:",!! S CNT=0 F I="external","mucosa","septum","turbinates" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"Mouth-throat:",!! S CNT=0 F I="lips","breath","teeth - dentures","bleeding gums","tongue","mucosa","tonsils","pharynx","speech","salivary glands","hoarseness" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"c. Neck:",!! S CNT=0 F I="range of motion","appearance","trachea","thyroid","masses" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"d. Breasts:",!! S CNT=0 F I="lumps","pain or tenderness","nipple discharge" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"e. Nodes:",!! S CNT=0 F I="cervical","axillary","inguinal" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"Musculoskeletal - spine,upper and lower extremeties:",!!
 S CNT=0 F I="mobility, tenderness, pain of spine","joint pain","stiffness","joint swelling","muscle weakness","edema","ambulation","coordination" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"g. Respiratory:",!! S CNT=0 F I="cough","sputum","rheumatic fever","pleurisy","pneumonia","tuberculosis","shortness of breath","wheezing","asthma","pulmonary embolus" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 F I="configuration of thorax","respiratiory movements","percussion","inspiratory breath sounds","expiratiory breath sounds" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"h. Cardiovasular:",!!
 S CNT=0 F I="heart inpulse","palpation, rhythm, auscultation","hypertension","rheumatic fever","chest pain/discomfort","shortness of breath","paroxysmal nocturnal dyspnea" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 F I="murmurs","edema","pulses","neck veins","peripheral veins","claudication","thrombophlebitis" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"i. Gastrointestinal:",!!
 S CNT=0 F I="dysphagia","heartburn","nausea and vomiting","hematemesis","melena","abdominal wall/distention/tenderness","food intolerance","bowel sounds","ventral hernia","hepatitis" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 F I="gastric/marginal/duodenal ulcer","pancreatitis" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"j. Genitourinary:",!! S CNT=0 F I="nocturia/dysuria","incontinence","dribbling","polyuria","urinary infection","stones","veneral disease","discharge","impotence","penis" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 F I="scrotum","testes","epididymis","inguinal canal" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"Female:",!! F I="external genitalia","uretha","vagina","uterus","adnexa","abnormal menses","vaginal discharge","menorrhagia","dyspareunia","menopause","contraception" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"k. Rectal:",!! S CNT=0 F I="anus and sphincter","rectum","prostate","test for occult blood" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"l. Neurological:",!!
 G ^DVBCPWC4

DVBCPWC2
DVBCPWC2 ;ALB ISC/THM-POW PROTOCOL MENTAL DISORDER EXAM ; 5/6/91  9:40 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9="Full Exam Worksheet"
EN W @IOF,!?25,HD91,!?22,"Compensation and Pension Examination",! S HD7="MENTAL DISORDERS - POW PROTOCOL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!,"Physician's Guide Reference:  Chapter 14, 17, 20",!!,"Narrative:  "
 W !!,"A. Medical and occupational history:",!!
 W ?8,"1. Immediate pre-military events -",!!!!!!!!!?8,"2. Events as a POW -",!!!!!!!!!?8,"3. Post-active service events (to present) -",!!!!!!!!!
 W ?8,"4. Employment history prior to and following",!?11,"active service -" D HD2
 W "B. Subjective complaints (include the veteran's history of unusually ",!?27,"traumatic events as a POW, if not elsewhere",!?27,"indicated) -",!!!!!!!!!!!!!!! W "C. Objective findings:",! D HD2
 W "D. Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 S LX="TXT1" F I=1:1 S LY=$T(@LX+I) Q:LY["$END"  W $P(LY,";;",2),!
 W !!!!!!!!!!!!,"E. Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 G ^DVBCPWC3
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
TXT1 ;
 ;;   1.  State if the veteran is capable of managing his/her benefit
 ;;       payments in the individual's own best interests without restriction
 ;;       (a physical disability which prevents the veteran from attending
 ;;       to financial matters in person is not a proper basis for a finding
 ;;       of incompetency unless the veteran is, by reason of that disability,
 ;;       incapable of directing someone else in handling the individual's
 ;;       his financial affairs) -
 ;;$END

DVBCPWC3
DVBCPWC3 ;ALB ISC/THM-POW PROTOCOL SOCIAL WORK SURVEY ; 5/5/91  1:40 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9="Full Exam Worksheet"
EN W @IOF,!?25,HD91,!?22,"Compensation and Pension Examination",! S HD7="SOCIAL WORK SURVEY - POW PROTOCOL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!,"Physician's Guide Reference:  Chapter 17",!!
 W !!,"A. Describe the veteran's personal appearance -",!!!!!!!!!!
 W "B. Describe the veteran's personal health -",!!!!!!!!!!,"C. Describe the veteran's family adjustment -",! D HD2
 W "D. Describe the veteran's community adjustment -",!!!!!!!!!!,"E. Describe the veteran's economic adjustment -",!!!!!!!!!!
 W "E. Evaluation:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q

DVBCPWC4
DVBCPWC4 ;ALB ISC/THM-POW PROTOCOL EXAM, PART 3 ; 5/6/91  9:39 AM
 ;;2.7;AMIE;;Apr 10, 1995
 G EN
 ;
L I $Y>55 D HD2^DVBCPWCK
 Q
 ;
EN S CNT=0 F I="cranial nerves","gait disturbance","biceps reflex","triceps reflex","patellar reflex","Achilles reflex","plantar response","peripheral nerves","sensory change" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 F I="seizures","loss of consciousness","paralysis","tremor","headaches" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W ?4,"m. Psychiatric:",!!
 S CNT=0 F I="orientation","memory change","mood","trouble with decisions","sleep disturbance","crying spells","thoughts of suicide","difficulty with work","fatigue" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 F I="loss of appetite","trouble with sex life","social withdrawal","hallucinations","improbable beliefs","anxiety","depression" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! D L
 W !!!!!,"C. Summary of findings:",!!!!!!!!!!,"D. Diagnoses:",!!!!!!!!!!,"E. Recommendations:",!!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 G ^DVBCPWC2

DVBCPWCK
DVBCPWCK ;ALB/GTS-557/THM-PRISONER OF WAR PROTOCOL EXAM  ; 5/6/91  9:38 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9="Full Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1705 Worksheet" S HD7="PRISONER OF WAR PROTOCOL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:  "
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["$END"  D:LY["|TOP|" HD2 W:LY'["|TOP|" ?13,$P(LY,";;",2),!
 W !,"A. Medical history (include childhood and adult illnesses and",!?3,"operations):",!!!!!!!!!!!!!,"B. Past history (include civilian and military occupation, military)",!
 W ?3,"history including geographic locations and dates, habits",!?3,"such as alcohol, tobacco and drugs, family history):",!!!!!!!! D HD2^DVBCPWCK
 S CNT=0 W "C. System review (comment specifically if positive symptom):",!!?4,"a. General:",!! F I="weight change","fever or chills","night sweats","polydipsia" S CNT=CNT+1 W ?($S(CNT<10:7,1:6)),CNT,". ",I,!! I $Y>55 D HD2
 G ^DVBCPWC1
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q
 ;
TXT ;
 ;;The protocol for conducting examinations on former
 ;;POWs should include the following and be faxed in
 ;;in its entirety to the regional office.
 ;;
 ;;1.  The veteran completes VAF 10-0048, Former POW
 ;;Medical History, which the examiners should review.
 ;;
 ;;2.  The examination should include an exam for all
 ;;presumptive POW disabilities, as well as any other
 ;;disabilities claimed by the veteran.  All laboratory
 ;;and diagnostic tests should be completed and reviewed
 ;;prior to completing the summary of findings.
 ;;
 ;;3.  A mental disorders examination should be conducted.
 ;;An appropriate worksheet is attached.
 ;;
 ;;4.  A social survey should be conducted.  An appropriate
 ;;worksheet is also attached.
 ;;
 ;;5.  The POW Physician Coordinator should complete
 ;;summary of findings, diagnoses, and recommendations.
 ;;The POW Physician Coordinator may express his or
 ;;her judgement about the possible epidemiological
 ;;factors and/or etiological origins of any noted
 ;;disabilities.
 ;;
 ;;6.  The following conditions are presumptive POW
 ;;disabilities:
 ;;
 ;;Avitaminosis
 ;;Beriberi (including beriberi heart disease)
 ;;Chronic dysentery
 ;;Helminthiasis
 ;;Malnutrition (including optic atrophy associated with
 ;;              malnutrition)
 ;;Pellagra
 ;;any other nutritional dificiency
 ;;Psychosis
 ;;Any of the anxiety states
 ;;Post-traumatic osteoarthritis
 ;;Organic residuals of frostbite
 ;;Peptic ulcer disease
 ;;Irritable bowel syndrome
 ;;Peripheral neuropathy
 ;;|TOP|
 ;;7.  Because the term "irritable bowel syndrome", as
 ;;applied to former POWs, includes a number of other
 ;;conditions, and because the rating schedule places
 ;;restrictions on the evaluation of co-existing gastro-
 ;;intestinal conditions, it is important that all
 ;;gastrointestinal disorders found be described in
 ;;detail.  The term "peptic ulcer" is not proper for
 ;;evaluation purposes.  You should specify "gastric",
 ;;"marginal", or "duodenal" as appropriate.
 ;;
 ;;8.  In many cases, the contemporary treatment records
 ;;for the initial manifestation of POW presumptive
 ;;diseases will no longer be available because of the
 ;;passage of time, death of the physician, etc.  Histories
 ;;of specific diseases should include whether the
 ;;veteran recalls his symptoms at the time so the
 ;;rating board can determine whether conditions now
 ;;present, but non-compensable, were of compensable degree
 ;;in the past.
 ;;$END

DVBCPYCK
DVBCPYCK ;ALB/GTS-ALB/GTS-557/THM-PYELITIS, NEPHROLITHIASIS,ETC ; 2/6/91  7:56 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0620 Worksheet" S HD6="PYELITIS, NEPHROLITHIASIS, URETEROLITHIASIS,",HD7="URETERAL STRICTURE AND HYDRONEPHROSIS (GU)",HD8="For "_HD6
 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!,?(80-$L(HD7)\2),HD7,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD6,!?14,HD7
 W !!!!,"Narrative:"
 W ?13,"Complications and/or medical side effects should always be",!?13,"reported, even when not specifically requested.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Report presence or absence of calculi -",!!!!!
 W ?8,"2. If stone, presence and size if retained -",!!!!!
 W ?8,"3. Frequency of attacks of colic -",!!!!!?8,"4. Catheter drainage requirement (frequency of need) -",!!!!!
 W ?8,"5. Presence or absence of infection -",!!!!!?8,"6. Involvement of other kidney -",!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:'$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!
 W ?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!!
 W HD8,!,HD7,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCRACK
DVBCRACK ;ALB/GTS-557/THM RECTAL/ANAL EXAM ; 12/6/90  11:43 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0320 Worksheet" S HD7="RECTUM AND ANUS (DIGESTIVE)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"Diseases of the rectum, anal canal or perineum must be",!?13,"differentiated as to type.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Bleeding -",!!!!!!?8,"2. Soiling -",!!!!!!?8,"3. Incontinence/diarrhea -",!!!!!!
 W ?8,"4. Tenesmus -",!!!!!!?8,"5. Dehydration -",!!!!!!?8,"6. Malnutrition -",! D HD2
 W ?8,"7. Anemia -",!!!!!!?8,"8. Fecal leakage -",!!!!!!?8,"9. Frequency of episodes -",!!!!!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W HD8,!!!
 Q
 ;
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCREDT
DVBCREDT ;ALB/GTS-557/THM-EDIT STATIC C&P INFO ; 11/20/90  6:29 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;**Note:  Priority E is Insufficient
 ;         Priority 'E is not insufficient
 ;
 K ^TMP("DVBCEDIT",$J) I $D(DUZ)#2=0 W !!,*7,"Your user number is invalid.",!! H 3 G EXIT
 S LN="EDIT C&P STATIC INFORMATION" D HOME^%ZIS S FF=IOF
 G EN1
 ;
COMPARE I '$D(^TMP("DVBCEDIT",$J,DA,2,I,0)) S DVBCMOD=1 Q
 I ^DVB(396.3,DA,2,I,0)'=^TMP("DVBCEDIT",$J,DA,2,I,0) S DVBCMOD=1 Q
 Q
 ;
EN1 W @IOF,!?(IOM-$L(LN)\2),LN,!!! S DIC="AE",DIC("A")="Enter VETERAN NAME: ",DIC="^DVB(396.3,",DIE=DIC,DIC(0)="AEQM" D ^DIC G:X=""!(X=U) EXIT S DA=+Y I DA<0 G EN1
 S STAT=$P(^DVB(396.3,DA,0),U,18) I STAT'="N"&(STAT'="P") W !!,"The status of this request is not NEW or PENDING, REPORTED.",!,"It cannot, therefore, be modified.",*7,!! S DVBCMOD=1 G CON
 F I=0:0 S I=$O(^DVB(396.3,DA,2,I)) Q:I=""  S ^TMP("DVBCEDIT",$J,DA,2,I,0)=^DVB(396.3,DA,2,I,0) ;save lines for compare
 ;
EDIT ;
 N DVBARQST,SAVEDA,ENTTOUT
 S DVBARQST=$P(^DVB(396.3,DA,0),U,10)
 S SAVEDA=DA
 W !! S DR="W @IOF,!!;9;10:10.2;24;29;21;W !!;23" D ^DIE
 S:$D(DTOUT) ENTTOUT=""
 ;
 ;**Priority E -> E
 I DVBARQST="E",($P(^DVB(396.3,DA,0),U,10)="E"&('$D(ENTTOUT))) DO
 .W !
 .N UPDT2507
 .K DTOUT,DUOUT
 .S DIR(0)="Y^AO",DIR("A")="Do you want to change the request this insufficient is linked to"
 .S DIR("?")="Enter Yes to change the link and No to keep the current link.",DIR("B")="NO" D ^DIR
 .S:+Y=1 UPDT2507=""
 .I $D(UPDT2507) DO
 ..K DIR,Y
 ..N REQDA S REQDA=SAVEDA
 ..S NODE5=""
 ..S:$D(^DVB(396.3,REQDA,5)) NODE5=^DVB(396.3,REQDA,5) ;**Save link node
 ..D CLINSF^DVBCLOG2 S DA=SAVEDA D INSUF^DVBCLOG2 ;*Update 2507 Link info
 ..I '$D(DVBAOUT),('$D(DUOUT)) D INSUFXM^DVBCUTA2 ;*Update exam info
 ..I $D(DVBAOUT)!($D(DUOUT)) D RESTLINK^DVBCUTA2 ;*Restore 2507 link
 ..K NODE5
 .I '$D(UPDT2507) DO  ;**Exam info update check
 ..W !
 ..N REQDA S REQDA=SAVEDA
 ..S NODE5=^DVB(396.3,REQDA,5) ;**Save the link info node
 ..D INSUFXM^DVBCUTA2 ;**Update exam info
 ..K XMEDT,NODE5
 .S DA=SAVEDA
 ;
 ;**Priority 'E -> E
 I DVBARQST'="E",($P(^DVB(396.3,DA,0),U,10)="E"&('$D(ENTTOUT))) DO
 .K DIR,Y
 .N REQDA,XMDA S REQDA=SAVEDA
 .D INSUF^DVBCLOG2 ;**Enter 2507 insuf link info
 .I '$D(DVBAOUT) DO  ;**Enter insuf info on exams
 ..N EXMNM,XMSTAT
 ..K DTOUT
 ..F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:(XMDA=""!($D(DTOUT)))  DO
 ...W @IOF
 ...D XMUPDT^DVBCUTA2 ;**Exam info
 ..S:$D(DTOUT) DVBAOUT="" K Y,^TMP($J,"NEW")
 .I $D(DVBAOUT) DO  ;**Restore priority info when time out
 ..N MSG,RESET,EXMCLR
 ..S (RESET,MSG,EXMCLR)=""
 ..D RESTORE
 .S DA=SAVEDA
 ;
 ;**Priority E -> 'E
 I DVBARQST="E",($P(^DVB(396.3,DA,0),U,10)'="E") DO
 .N REQDA,EXMCLR S REQDA=SAVEDA S EXMCLR=""
 .D RESTORE ;**Clear link and insuf info on exams
 .S DA=SAVEDA
 ;
 ;**If Timed out of information edit in DR string
 I $D(ENTTOUT) DO
 .I DVBARQST'="E",($P(^DVB(396.3,DA,0),U,10)="E") DO  ;**clear insf info
 ..N REQDA,MSG,RESET
 ..S REQDA=SAVEDA S (MSG,RESET)=""
 ..D RESTORE
 S DA=SAVEDA
 S DIE="^DVB(396.3,"
 I $P(^DVB(396.3,DA,0),U,2)[DT G CONK ;no check if entered today
 K DVBCMOD F I=0:0 S I=$O(^DVB(396.3,DA,2,I)) Q:I=""  D COMPARE Q:$D(DVBCMOD)
 I $D(DVBCMOD) S DR="23.5///NOW;23.6////^S X=DUZ" D ^DIE W @IOF,!!,*7,"Since you have modified the REMARKS section,",!,"a new copy of the request will be issued to the",!,"medical center tomorrow morning."
 ;
CON I $D(DVBCMOD) W !!,"Press RETURN to continue  " R ANS:DTIME G:'$T!(ANS=U) EXIT
CONK K I,DVBCMOD,DIC,DA,DIE,X,Y G EN1
 ;
EXIT K ^TMP("DVBCEDIT",$J) G KILL^DVBCUTIL
 ;
RESTORE ;** Remove insufficient info from 2507
 K DIE,DA,DR
 D CLINSF^DVBCLOG2 ;**Clear 2507 info
 I $D(RESET) DO  ;**Reset Priority
 .S DA=REQDA,DR="9////^S X=DVBARQST",DIE="^DVB(396.3,"
 .D ^DIE K DA,DR,DIE
 I $D(EXMCLR) DO  ;**Clear exam info
 .F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:(XMDA="")  DO
 ..K DA,DR,DIE
 ..S DA=XMDA,DR=".11////@;.12///@;80///@",DIE="^DVB(396.4,"
 ..D ^DIE
 .K DA,DR,DIE
 I $D(MSG) DO  ;**Output message
 .S TVAR(1,0)="1,3,0,2:1,0^Insufficient link info not updated!...Priority restored"
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 .D CONTMES^DVBCUTL4
 Q

DVBCRELS
DVBCRELS ;ALB/GTS-557/THM-RELEASE 2507 REQUEST TO RO ; 5/27/91  4:54 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 I $D(DUZ)#2=0 W *7,!!,"Invalid user number (DUZ)",!! H 3 Q
 I '$D(^XUSEC("DVBA C RELEASE 2507",DUZ)) W *7,!!,"You are not authorized to release 2507 requests!!",!! H 3 Q
 G EN
 ;
EXAM S EXAM=$P(^DVB(396.4,DA,0),U,3),EXAM=$P(^DVB(396.6,+EXAM,0),U,1)
 S STAT=$P(^DVB(396.4,DA,0),U,4)
 I STAT'="C"&(STAT'["X") S NFINAL=1 W !,EXAM," is not complete " W:STAT="T" " (transferred)"
 Q
 ;
EN D HOME^%ZIS S FF=IOF,HD="Veteran Selection",HD2="2507 Exam Release"
 ;
LOOK D KILL W @FF,!?(IOM-$L(HD)\2),HD,!?(IOM-$L(HD2)\2),HD2,!!! S DIC("W")="D DICW^DVBCUTIL" S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Select VETERAN: " D ^DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" G LOOK
 S STAT=$P(^DVB(396.3,+Y,0),U,18) D STATCHK G:$D(NCN) LOOK
 S REQDA=+Y,DFN=+$P(Y,U,2),REQDT=$P(^DVB(396.3,REQDA,0),U,2)
 S (PNAM,SSN)="Unknown" I $D(^DPT(DFN,0)) S PNAM=$P(^(0),U,1),SSN=$P(^(0),U,9)
 S CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") K DICW
 S STAT=$P(^DVB(396.3,REQDA,0),U,18) D STATCHK I $D(NCN) K NCN G LOOK
 W !!,"Please wait while the individual exam statuses are checked.  " H 1 W !
 ;
DATA S NFINAL=0 F DA=0:0 S DA=$O(^DVB(396.4,"C",REQDA,DA)) Q:DA=""  D EXAM
 I NFINAL=0 W !!,"All exams have been completed, please enter the following:",!!
 I NFINAL=1 W *7,!!,"Since there are still incomplete exams,",!,"  this request cannot be released to the RO.  " W !!,"Press RETURN or ""^"" to exit  " R ANS:DTIME G:'$T!(ANS=U) EXIT G LOOK
 S DVBOTH=$P(^DVB(396.3,REQDA,1),U,3),DVBABY=$P(^(1),U,5),DVBDTA=$P(^(1),U,6)
 S:DVBABY="" DVBABY="@" S:DVBDTA="" DVBDTA="@"
 I NFINAL=0 K DR S %DT="TS",X="NOW" D ^%DT S CTIM=Y,DA=REQDA,DIE="^DVB(396.3,",DR="12////"_CTIM_";13////"_CTIM_";14////^S X=DUZ;17///R;W *7;22;25R;26R" D ^DIE K CTIM
 I '$D(Y),NFINAL=0 W !!,"This request is now released.",!! H 2
 I '$D(Y),$P(^DVB(396.3,REQDA,0),U,22)]"",$P(^(0),U,22)'=$P(^XMB(1,1,0),U,1) D ^DVBCXFRE K DIC,DIE,DR,DA S FAX="Y",RSTAT="CT" G FX ;transfers
 ;set back to transcribed if error or not completed
 I $D(Y) W *7,!!,"Release NOT COMPLETED !!",!! H 2 S DR="6///@;12///@;13///@;14///@;17////T;25////"_DVBABY_";26////"_DVBDTA,DIE="^DVB(396.3,",DA=REQDA,DIC=DIE,$P(^DVB(396.3,REQDA,1),U,3)=DVBOTH D ^DIE G LOOK
 S FAX=$S($D(^DVB(396.3,REQDA,1)):$P(^(1),U,3),1:"N"),RSTAT="C"
 ;
FX ;if to be faxed or transferred out, set like RO has printed it
 I FAX="Y" S %DT="ST",X="NOW" D ^%DT S CTIM=Y,DR="6////"_CTIM_";15////"_CTIM_";16////^S X=DUZ;17////"_RSTAT S (DIE,DIC)="^DVB(396.3,",DA=REQDA D ^DIE
 G LOOK
 ;
EXIT G KILL^DVBCUTIL
 ;
KILL K CNUM,SSN,PNAM,FAX,CTIM,DIC,DA,D0,D1,DFN,X,Y,NCN,STAT,%,NOFND,NFINAL,REQDA,STAT,RSTAT,DVBDTA,DVBOTH,DVBABY
 Q
 ;
STATCHK I STAT="RX" W *7,!!,"This request has been cancelled by the RO.",!! H 2 S NCN=1 Q
 I STAT="CT" W *7,!!,"This request has been completed and transferred out.",!! H 2 S NCN=1 Q
 I STAT="X" W *7,!!,"This request has been cancelled by MAS.",!! H 2 S NCN=1 Q
 I STAT="R" W *7,!!,"This request has been released to the RO.",!! H 2 S NCN=1 Q
 I STAT="C" W *7,!!,"This request has been printed by the RO.",!! H 2 S NCN=1 Q
 I STAT="N"!(STAT="NT") W *7,!!,"This request is new and has not yet been reported to MAS.",!! H 2 S NCN=1
 Q

DVBCREQ1
DVBCREQ1 ;ALB/GTS-557/THM-NEW 2507 REQUEST PRINTING ; 5/25/91  11:36 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
START S PGHD="COMPENSATION AND PENSION EXAM REQUEST",ROHD="Requested by "_RONAME,PG=0
 D HDR
 D SSNOUT^DVBCUTIL ;** Set the value of DVBCSSNO
 W !?2,"Name: ",PNAM,?56,"SSN: ",DVBCSSNO,!?51,"C-Number: ",CNUM,!?56,"DOB: " S Y=DOB X ^DD("DD") W Y,!?2,"Address: ",ADR1,! W:ADR2]"" ?11,ADR2,! W:ADR3]"" ?11,ADR3,!!
 K DVBCSSNO
 W !?2,"City,State,Zip+4: ",?48,"Res Phone: ",HOMPHON,!?5,CITY,"  ",STATE,"  ",ZIP,?48,"Bus Phone: ",BUSPHON,! I IOST?1"C-".E D CRTBOT G:$D(GETOUT) EXIT
 W !,"Entered active service: " S Y=EOD X ^DD("DD") S:Y="" Y="Not specified" W Y,?40,"Last rating exam date: ",LREXMDT,! S Y=RAD X ^DD("DD") S:Y="" Y="Not specified" W "Released active service: " W Y,!
 F LINE=1:1:80 W "="
 S TVAR(1,0)="0,0,0,2:1,0^** Priority of exam: "_PRIO
 D WR^DVBAUTL4("TVAR")
 K TVAR
 I $D(^DVB(396.3,DA(1),5)),(+$P(^DVB(396.3,DA(1),5),U,1)>0) DO
 .I $D(DVBAINSF),($D(^DVB(396.3,$P(^DVB(396.3,DA(1),5),U,1),0))) DO
 ..S Y=$P(^DVB(396.3,$P(^DVB(396.3,DA(1),5),U,1),0),U,5) X ^DD("DD")
 ..S TVAR(1,0)="0,0,0,0,0^Date original 2507 Reported to MAS: "_Y K Y
 ..D WR^DVBAUTL4("TVAR")
 ..K TVAR
 S TVAR(1,0)="0,0,0,3:2,0^Selected exams: "
 D WR^DVBAUTL4("TVAR")
 K TVAR
 D TST^DVBCUTL3 G:($D(GETOUT)) EXIT
 W !!!!! I IOST?1"C-".E D CRTBOT G:$D(GETOUT) EXIT
 W "Current Rated disabilities:",!! D DDIS^DVBCUTL3 G:($D(GETOUT)) EXIT
 W "Other Disabilities:",!!?2,OTHDIS,!?2,OTHDIS1,!?2,OTHDIS2,!!,"General remarks:",!!
 K ^UTILITY($J,"W")
 I IOST?1"C-".E D CRTBOT G:$D(GETOUT) EXIT
 F LINE=0:0 S LINE=$O(^DVB(396.3,DA(1),2,LINE)) Q:(LINE="")!($D(GETOUT))  S X=^(LINE,0),DIWL=5,DIWR=75,DIWF="NW" D ^DIWP I $Y>(IOSL-7),$O(^DVB(396.3,DA(1),2,LINE))]"" D BOT D:'$D(GETOUT) HDR,RMRK
 D:('$D(GETOUT)) ^DIWW
 ; **  Exit TAG **
EXIT D:('$D(GETOUT)) BOT K GETOUT,LPCNT,DVBCDX,DVBCSC Q
 ;
HDR S PG=PG+1 I '$D(ONE)!(($D(ONE))&(PG>1))!(IOST?1"C-".E) W @IOF
 W !,"Date: ",DVBCDT(0),?(80-$L(PGHD)\2),PGHD,?71,"Page: ",PG,! S PRTDIV=$S($D(^DG(40.8,XDIV,0)):$P(^(0),U,1),1:"Unknown division") S PRTDIV="For "_PRTDIV_" Medical Center Division at "_$$SITE^DVBCUTL4
 W ?(80-$L(PRTDIV)\2),PRTDIV
 W !! S Y=$P(^DVB(396.3,DA(1),0),U,22) I Y]"" S Z="*** Transferred from ",Z=Z_$S($D(^DIC(4.2,+Y,0)):$P(^(0),U,1),1:"unknown site")_" ***" W ?(80-$L(Z)\2),Z,!
 W ?(80-$L(ROHD)\2),ROHD,! S RQ="Date Requested: ",Y=DTRQ X ^DD("DD") S RQ=RQ_Y W ?(80-$L(RQ)\2),RQ,! F XLN=1:1:80 W "="
 K XLN Q
 ;
CRTBOT ;  ** Write form number at bottom of CRT **
 I $P(^DVB(396.3,DA(1),0),U,23)="Y" W !?20,"** Claim folder review will be required **",!
 F LPCNT=$Y:1:(IOSL-7) W !
 W !,"VA Form 21-2507"
 D TERM^DVBCUTL3
 Q
 ;
BOT I $P(^DVB(396.3,DA(1),0),U,23)="Y" W !?20,"** Claim folder review will be required **",!
 I IOST?1"C-".E F LPCNT=$Y:1:(IOSL-6) W !
 I IOST'?1"C-".E F LPCNT=$Y:1:(IOSL-4) W !
 W !,"VA Form 21-2507"
 I IOST?1"C-".E D TERM^DVBCUTL3
 Q
 ;
RMRK W !!,"General remarks, continued",!!
 Q

DVBCREQ2
DVBCREQ2 ;557/THM-CHECK DATES TO PRINT NEW REQUESTS ; 4/17/91  8:42 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;Skips Saturday if indicated in file, skips Sunday always
 ;If Saturday is skipped, is printed on Monday
 ;Holidays queue up for T+1 at current time unless Saturday,
 ;when they queue for T+3 at current time.
 ;
EN I '$D(DT) S X="T" D ^%DT S DT=Y
 D NOW^%DTC S DVBCNOW=%H,X=DT D DW^%DTC S TODAY=X,DVBCNSKP=$P(^DVB(396.1,1,0),U,14)
 I $D(^HOLIDAY(DT)) G HOLIDAY
 I TODAY="SATURDAY"&(DVBCNSKP'="Y")!(TODAY="SUNDAY") G EXIT
 G TASK
 ;
EXIT K %,%H,Y,X,TODAY,DVBCNSKP
 Q
 ;
TASK I '$D(^DVB(396.1,1,0)) W !!,"No parameters in AMIE site parameter file!",!! Q
 I TODAY="SATURDAY"&(DVBCNSKP="Y") S X="T-1" D ^%DT S BDTRQ=Y,EDTRQ=Y+.2359 G TASK1 ;Friday's requests
 I TODAY="SATURDAY"&(DVBCNSKP'="Y") G EXIT ;don't print Friday if not Y
 I TODAY="MONDAY"&(DVBCNSKP'="Y") S X="T-3" D ^%DT S BDTRQ=Y,X="T-1" D ^%DT S EDTRQ=Y+.2359 G TASK1 ;Friday-Sunday
 I TODAY="MONDAY"&(DVBCNSKP="Y") S X="T-2" D ^%DT S BDTRQ=Y,X="T-1" D ^%DT S EDTRQ=Y+.2359 G TASK1 ;Saturday-Sunday
 S X="T-1" D ^%DT S BDTRQ=Y,EDTRQ=Y+.2359 ;Monday-Friday
 ;
TASK1 S Y=DT X ^DD("DD") S DVBCDT(0)=Y F JI=0:0 S JI=$O(^DVB(396.1,1,3,"B",JI)) Q:JI=""  F JJ=0:0 S JJ=$O(^DVB(396.1,1,3,"B",JI,JJ)) Q:JJ=""  D CLIN
 G EXIT
 ;
CLIN S XDIV=JI,ZTRTN="GO^DVBCREQP",ZTIO=$P(^DVB(396.1,1,3,JJ,0),U,2)_";80",ZTDESC="New 2507 Request Report for ",DIVNM=$S($D(^DG(40.8,XDIV,0)):$P(^(0),U,1),1:"Unknown Division"),ZTDESC=ZTDESC_DIVNM S:'$D(ZTDTH) ZTDTH=$H
 F I="BDTRQ*","EDTRQ*","DA*","DVBCDT(0)","Y","XDIV","DIVNM","JI","JJ" S ZTSAVE(I)=""
 D ^%ZTLOAD
 Q
 ;
HOLIDAY ;holidays are queued for next day at same time
 I TODAY="MONDAY",DVBCNSKP="Y" S X="T-2" D ^%DT S BDTRQ=Y,X="T-1" D ^%DT S EDTRQ=Y+.2359,ZTDTH=$P(DVBCNOW,",",1)+1_","_$P(DVBCNOW,",",2) G TASK1 ;Saturday-Sunday requests
 I TODAY="MONDAY",DVBCNSKP'="Y" S X="T-3" D ^%DT S BDTRQ=Y,X="T-1" D ^%DT S EDTRQ=Y+.2359,ZTDTH=$P(DVBCNOW,",",1)+1_","_$P(DVBCNOW,",",2) G TASK1 ;Friday-Sunday requests
 I TODAY="TUESDAY"!(TODAY="WEDNESDAY")!(TODAY="THURSDAY") S X="T-1" D ^%DT S BDTRQ=Y,EDTRQ=Y+.2359,ZTDTH=$P(DVBCNOW,",",1)+1_","_$P(DVBCNOW,",",2) G TASK1 ;Monday-Wednesday requests
 I TODAY="FRIDAY" S X="T-1" D ^%DT S BDTRQ=Y,EDTRQ=Y+.2359,ZTDTH=$P(DVBCNOW,",",1)+3_","_$P(DVBCNOW,",",2) G TASK1 ;Thursday requests

DVBCREQ3
DVBCREQ3 ;ALB/GTS-557/THM-NEW REQUESTS RECAP SHEET ; 6/18/91  1:23 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN S P1=0,PG=0,$P(PLINE,"-",75)="-" D HDR
 ;
RECAP F X="NEW","MODIFIED","ADDITIONAL" S P1=P1+1 W !!!,X,$S(P1=3:" exams",1:" requests"),":",!! S (PNAM,SSN)="" F SM=1:1 S PNAM=$O(^TMP($J,X,PNAM)) Q:PNAM=""  F SN=0:0 S SSN=$O(^TMP($J,X,PNAM,SSN)) Q:SSN=""  D RECAP1
 ;
EXIT K P1,COL,SM,SN,PNAM,SSN,CNUM,CN,PG,PLINE,X,^TMP($J),DVBCSSNO Q
 ;
RECAP1 F CN=0:0 S CNUM=$O(^TMP($J,X,PNAM,SSN,CNUM)) Q:CNUM=""  S COL=$S(SM>9:0,1:1) D SSNOUT^DVBCUTIL W ?COL,SM,". ",PNAM,?40,DVBCSSNO,?63,CNUM,! I $Y>55 W @IOF,!
 Q
 ;
HDR S PG=PG+1 W @IOF,!,"New Request Recap Sheet for Run Date ",DVBCDT(0),?69,"Page: ",PG,!!!
 W ?1,"Veteran name",?40,"S S #",?63,"C-number",!,PLINE,!!!
 Q

DVBCREQM
DVBCREQM ;ALB ISC/THM-DIAGNOSTIC TEST ORDER SHEET, GENERIC ; 6/28/91  7:08 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN K DVBCXX,DVBCDASH,DVBCBX,DVBCULN
 S DVBCXX="C&P Diagnostic Test Order Record",$P(DVBCDASH,"-",79)="-",$P(DVBCULIN,"_",70)="_",DVBCBX="        |          |            |         |       "
 S DVBCXHD="S DVBCCNTR=1 W !?35,""Order"",!?8,""Test"",?22,""Order #"",?35,""Date"",?45,""Initials"",?64,""Remarks"",!,DVBCDASH,! F DVBC=1:1:6 W ?($S(DVBCCNTR>9:0,1:1)),DVBCCNTR,""."",?12,DVBCBX,!,DVBCDASH,! S DVBCCNTR=DVBCCNTR+1"
 W @IOF,!,?(80-$L(DVBCXX)\2),DVBCXX,!!,"Name: ",PNAM,?40,RQ,!," SSN: ",SSN F DVBCYX="Laboratory:","Radiology:","Other:" W !!,DVBCYX,! X DVBCXHD
 K DVBCXX,DVBCDASH,DVBCBX,DVBCULN,DVBCCNTR
 Q

DVBCREQP
DVBCREQP ;ALB/GTS-557/THM-PRINT NEW REQUESTS ; 6/27/91  9:36 AM
 ;;2.7;AMIE;;Apr 10, 1995
 S DVBAMAN="" G EN
 ;
CK1 F JI=BDTRQ-.1:0 S JI=$O(^DVB(396.3,XD,JI)) Q:JI=""  F DA(1)=0:0 S DA(1)=$O(^DVB(396.3,XD,JI,DA(1))) Q:DA(1)=""  S DVBXD=$S($D(^DVB(396.3,DA(1),1)):$P(^(1),U,4),1:"") I DVBXD=XDIV S FIND=1
 Q
 ;
PRINT K OUT S STAT=$P(^DVB(396.3,DA(1),0),U,18) ;I STAT["X" S OUT=1 Q
 S DVBCDIV=$S($D(^DVB(396.3,DA(1),1)):$P(^(1),U,4),1:"") Q:DVBCDIV'=XDIV  S DA=DA(1) D VARS^DVBCUTIL,^DVBCREQ1 S:CNUM="" CNUM=99999999 S:SSN="" SSN=999999999 S:PNAM="" PNAM="Missing vet name"
 S DA=DA(1),DIE="^DVB(396.3,",DR="17////P" I STAT="N"!(STAT="NT") D ^DIE
SET S DA=DA(1),DR="4///NOW",(DIC,DIE)="^DVB(396.3,"
 I $P(^DVB(396.3,DA,0),U,5)="" D ^DIE
 I '$D(ONE) S ^TMP($J,DVBCTYPE,PNAM,SSN,CNUM)="" ;for last sheet
 S (PNAM,SSN,CNUM,ADR1,ADR2,ADR3,CITY,STATE,ZIP,HOMPHON,BUSPHON,OTHDIS)="",PRINT=1
 Q
 ;
EN K PRINT S Y=DT X ^DD("DD") S DVBCDT(0)=Y D HOME^%ZIS S FF=IOF W @FF,"Manual New C&P Request Printing",!!!
 ;
ASK K ONE W !,"Do you want just one request" S %=2 D YN^DICN G:$D(DTOUT) EXIT I $D(%Y),%Y["?" W !,"Enter Y for only one Vet or N for all Vets.",! G ASK
 G:%Y=U EXIT I %=1 G ONEREQ
 W ! D DIV I $D(OUT) K OUT G EXIT
 W ! S %DT(0)=-DT,%DT="AET",%DT("A")="Enter BEGINNING date of request: " D ^%DT G:Y<0 EXIT S BDTRQ=Y,%DT="AET",%DT("A")="     and ENDING date of request: " D ^%DT G:Y<0 EN S EDTRQ=Y+.2359
 I EDTRQ<BDTRQ W !!,*7,"Ending date is earlier than starting date!",!! H 2 G EN
 ;
DEVICE K %DT W !! S %ZIS="AEQ",%ZIS("A")="Output device: " D ^%ZIS K %ZIS G:POP EXIT
 I $D(IO("Q")) S ZTRTN=$S($D(ONE):"PRINT^DVBCREQP",1:"GO^DVBCREQP"),ZTIO=ION,ZTDESC="New C&P request printing" F I="ONE","BDTRQ*","EDTRQ*","DA*","Y","XDIV","DIVNM","DVBCDT(0)","DVBCMAN" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD G:'$D(ZTSK) EXIT W !!,"Request queued",!! G EXIT
 I $D(ONE) U IO D PRINT K DA G EXIT
 ;
GO D STM^DVBCUTL4
 U IO S X="New C&P Requests -- "_DIVNM
 W:(IOST?1"C-".E) @IOF
 W !!!!!!!!!!!!!!! F I=1:1:10 W ?5,X,!!
 K ^TMP($J),X S DVBCTYPE="NEW"
 F JI=BDTRQ_".0001":0 S JI=$O(^DVB(396.3,"C",JI)) Q:JI=""!(JI>EDTRQ)  F DA(1)=0:0 S DA(1)=$O(^DVB(396.3,"C",JI,DA(1))) Q:DA(1)=""  K OUT D PRINT
 K OUT I '$D(PRINT) W @IOF,!!!,"There were no new 2507 requests for " S Y=BDTRQ X ^DD("DD") W Y," to " S Y=$E(EDTRQ,1,7) X ^DD("DD") W Y,!,"for division ",DIVNM,!!
MODS K FIND S XD="AC" D CK1 I '$D(FIND) G ADDS
 K PRINT,FIND S X="C&P Request Modifications -- "_DIVNM W @IOF,!!!!!!!!!!!!!!! F I=1:1:10 W ?5,X,!!
 K X S DVBCTYPE="MODIFIED"
 F JI=BDTRQ_".0001":0 S JI=$O(^DVB(396.3,"AC",JI)) Q:JI=""!(JI>EDTRQ)  F DA(1)=0:0 S DA(1)=$O(^DVB(396.3,"AC",JI,DA(1))) Q:DA(1)=""  K OUT D PRINT
 I '$D(PRINT) W @IOF,!!!,"No modified requests to report.",!!
 ;
ADDS K FIND S XD="AD" D CK1 I '$D(FIND) G RECAP
 K PRINT,FIND S X="C&P Exams Added -- "_DIVNM W @IOF,!!!!!!!!!!!!!!! F I=1:1:10 W ?5,X,!!
 K X S DVBCTYPE="ADDITIONAL"
 F JI=BDTRQ_".0001":0 S JI=$O(^DVB(396.3,"AD",JI)) Q:JI=""!(JI>EDTRQ)  F DA(1)=0:0 S DA(1)=$O(^DVB(396.3,"AD",JI,DA(1))) Q:DA(1)=""  K OUT D PRINT
 I '$D(PRINT) W @IOF,!!!,"No added exams to report.",!!
RECAP D ^DVBCREQ3 ;recap sheet
 ;
EXIT S XRTN=$T(+0)
 D SPM^DVBCUTL4
 I $D(DVBCMAN)&($D(ZTQUEUED)) D KILL^%ZTLOAD
 K DVBCMAN,DIVNM,XDIV,DVBXD G KILL^DVBCUTIL
 ;
 ;
ONEREQ W !! S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("W")="W !?10,""Date of request: "" S:$D(Y) OLDY=Y S Y=$P(^(0),U,2) X ^DD(""DD"") W Y S:$D(OLDY) Y=OLDY",DIC("A")="Enter VETERAN NAME: " D ^DIC G:X=""!(X=U) EXIT
 S JI=$P(Y,U,2),DA(1)=+Y D DIV I $D(OUT) G EXIT
 S ONE=1 G DEVICE
 ;
TASK D ^DVBCREQ2 Q
 ;
DIV W !! K OUT S DIC("A")="Enter MED CENTER DIVISION: ",DIC(0)="AEQM",DIC="^DG(40.8," D ^DIC I X=""!(X=U) S OUT=1 Q
 I +Y<0 W *7,"  ???" G DIV
 S XDIV=+Y,DIVNM=$S($D(^DG(40.8,XDIV,0)):$P(^(0),U,1),1:"Unknown Division") Q

DVBCRLST
DVBCRLST ;ALB/GTS-557/THM-LIST C&P REQUESTS ; 1/3/91  6:20 AM
 ;;2.7;AMIE;;Apr 10, 1995
 S LN="C&P REQUESTS BY DATE RANGE" D HOME^%ZIS
 ;
 W @IOF
 W !?(IOM-$L(LN)\2),LN,!!! ;S %DT="AE",%DT("A")="Enter DATE OF REQUEST FROM: " D ^%DT S BDATE=Y-.0001
EN1 S PHYS="N" W !!,"Do you want to report by physician" S %=2 D YN^DICN G:$D(DTOUT)!(%<0) END I %=1 S PHYS="Y"
 I %=0 W !!,"Enter <Y> to report by Physician or <N> to report only by date range." G EN1
 W !!,*7,"This report uses ",$S(PHYS="Y":132,1:80)," columns.",!! D PRINT
 ;;;I $D(IOST),IOST?1"C-".E W !!,"Press [RETURN] to continue or ""^"" to exit    " R ANS:DTIME I ANS=U!('$T) G END
 ;
END K %DT,B,BDATE,EDATE,FR,TO,L,DIC,ANS,DIJ,DP,P,X,Y,LN,IOY,DA,DO,C,D,DE,DHD,DIK,DIS,I,J,K,IOP,%ZIS,BY,FLDS,PHYS
 ;;;W @IOF,!
 Q
 ;
PRINT S HDR="2507 Requests "_$S(PHYS="Y":"by Physician",1:"by Date Range")
 D NOW^%DTC S Y=% D DD^%DT
 S TME=$E(Y,1,12)_"  "_$E(Y,14,18),PGE=0,SCNWTH=$S(PHYS="Y":132,1:80)
 I PHYS="N" S DHD="W HDR S PGE=PGE+1 W ?47,TME,?69,""PAGE "",PGE,!,""    for ""_$$SITE^DVBCUTL4,?45,""REQUEST"",!,""NAME"",?32,""SSN"",?45,""DATE"",?56,""REQUESTER"",! F CNT=1:1:SCNWTH W ""-"""
 I PHYS="Y" D SETDHD
 S L=0
 I PHYS="N" S BY="[DVBA C REQUESTS BY DATE RANGE]",FLDS=BY
 I PHYS="N" S DIC="^DVB(396.3,"
 I PHYS="Y" S BY="[DVBA C REQUESTS BY PHYSICIAN]",FLDS=BY
 I PHYS="Y" S DIC="^DVB(396.4,"
 D EN1^DIP K HDR,SCNWTH,TME,PGE,CNT,%,Y,X,%H Q
 ;
SETDHD ;
 S DHD="W HDR S PGE=PGE+1 W ?99,TME,?121,""PAGE "",PGE,!,""  for ""_$$SITE^DVBCUTL4,?42,""REGIONAL OFFICE"",?91,""EXAM"",!,""NAME"",?27,""SSN"",?42,""NAME"",?59,""EXAM"",?91,""DATE"",?101,""EXAMINING PHYSICIAN"",! F CNT=1:1:SCNWTH W ""-"""
 Q

DVBCRMCK
DVBCRMCK ;ALB/GTS-557/THM-RESPIRATORY MANIF. DISEASES OTH SYS ; 6/27/91  7:31 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1520 Worksheet" S HD7="RESPIRATORY MANIFESTATIONS OF DISEASES OF OTHER SYSTEMS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"An example of this type of exam is extremely unfavorable",!?13,"ankylosis of the thoracic spine that so severely",!?13,"restricts chest excursion that the veteran is dyspneic",!
 W ?13,"on minimal exertion OR abdominal tumor interferes with",!?13,"excursion of the diaphragm to such an extent that chronic",!?13,"passive congestion of one lung results.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings :",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Clinical findings -",!!!!!!!?8,"2. Pulmonary function studies -",!!!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",!,HD7,!!,"for ",NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCROP1
DVBCROP1 ;ALB/GTS-557/THM-REOPEN REQUESTS/EXAMS, CONTINUED ; 11/16/90  7:39 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
STATUS1 W *7,!!,"Since this request has reopened, its status will",!,"be PENDING, REPORTED.",!!,"Be sure to regenerate any exam worksheets that will be needed",!,"for this request.",!!
 W "Press RETURN to continue " R ANS:DTIME ;if timeout, properly set record
 K DR S DIE="^DVB(396.3,",DR="6///@;11///@;12///@;13///@;14///@;15///@;16///@;17////P;19///@;20///@;26///@",DA=REQDA D ^DIE
 Q

DVBCROPN
DVBCROPN ;ALB/GTS-557/THM-REOPEN REQUEST/SELECTED EXAMS ; 9/22/91  4:54 PM
 ;;2.7;AMIE;;Apr 10, 1995
 I $D(DUZ)#2=0 W *7,!!,"Your user number (DUZ) is invalid !",!! H 3 G EXIT
 S SUPER=$S($D(^XUSEC("DVBA C SUPERVISOR",DUZ)):1,1:0)
 G EN
 ;
LOOK1 S EXAM=$P(^DVB(396.4,DA,0),U,3)
 S EXAM=$S($D(^DVB(396.6,+EXAM,0)):$P(^(0),U,1),1:"Unknown")
 S STAT=$P(^DVB(396.4,DA,0),U,4),^TMP($J,EXAM)=STAT_U_DA
 Q
 ;
EN D HOME^%ZIS S FF=IOF,HD="2507 Exam Veteran Selection",HD2="Re-open Exams/Requests"
 ;
LOOK D KILL W @FF,!?(IOM-$L(HD)\2),HD,!?(IOM-$L(HD2)\2),HD2,!!
 S DIC("W")="D DICW^DVBCUTIL" S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Select VETERAN: " D ^DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" G LOOK
 S (REQDA,DA(1))=+Y,STAT=$P(^DVB(396.3,DA(1),0),U,18),DFN=$P(Y,U,2)
 I STAT="C"!(STAT["X")!(STAT="R")&(SUPER=0) W !!,*7,"Status prohibits activity except by supervisors.",!! H 3 G EN
 S REQDT=$P(^DVB(396.3,DA(1),0),U,2),DATA=$S($D(^DPT(DFN,0)):^(0),1:"")
 S PNAM=$S($P(DATA,U,1)]"":$P(DATA,U,1),1:"Unknown"),SSN=$P(DATA,U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown") K DICW
 S RELDAT=$P(^DVB(396.3,DA(1),0),U,13)
 F DA=0:0 S DA=$O(^DVB(396.4,"C",DA(1),DA)) Q:DA=""  D LOOK1
 I $P(^DVB(396.3,DA(1),0),U,5)="" DO
 .S TVAR(1,0)="1,0,0,2,0^This 2507 was never reported to MAS, it can NOT be reopened."
 .D WR^DVBAUTL4("TVAR")
 .D CONTMES^DVBCUTL4
 .S NOTRPT=""
 .K TVAR
 G:$D(NOTRPT) LOOK
 S STAT=$P(^DVB(396.3,DA(1),0),U,18) D STATCHK G:$D(NCN) LOOK
 ;
ROPN W !!,"Do you want to reopen the ENTIRE request" S %=2 D YN^DICN G:$D(DTOUT)!(%<0) EXIT G:%=1 ALL
 I $D(%Y),%Y["?" W !,"Enter Y to reopen the ENTIRE request or N to reopen only selected exams.",!! H 1 G ROPN
DATA D HDR^DVBCUTIL K NOFND
 W !!
 S Y=$$EXSRH^DVBCUTL4("Select EXAM TO REOPEN: ","I $D(^DVB(396.4,""ARQ""_REQDA,+Y))") ;*Exam lookup function call
 G:$D(DTOUT) EXIT G:X=""!(X=U) UPDATE I +Y<0 W *7,"  ???" G DATA
 S EXY=+Y,EXMNM=$S($D(^DVB(396.6,+$P(^DVB(396.4,EXY,0),U,3),0)):$P(^(0),U,1),1:"")
 I EXMNM="" W *7,!!,"Exam name not found in file 396.6 !",!! H 2 G EXIT
 S STAT=$P(^TMP($J,EXMNM),U,1) I STAT="O" W *7,!!,"Already open!",!! H 2 G DATA
 D STATCHK G:$D(NCN) DATA
 S DA=EXY,DIE="^DVB(396.4,"
 S DR=".04////O;52///@;51///@;50///@"
 D ^DIE I '$D(Y) W " .. reopened" H 1
 I $D(Y) W *7,"   reopen error !" H 2 G EXIT
 S STAT=$P(^DVB(396.4,EXY,0),U,4),$P(^TMP($J,EXMNM),U,1)=STAT S EDIT=1
 G DATA
UPDATE I $D(EDIT) W @FF D STATUS1^DVBCROP1,BULL
 G LOOK
 ;
EXIT G KILL^DVBCUTIL
 ;
KILL K DIC,DA,ALLROPN,EXAM,REQDA,D0,D1,DFN,X,Y,EXY,OLDEXAM,DR,REQDT,DR,EXMNM,NCN,STAT,%,NOFND,^TMP($J),EDIT,NOTRPT,RELDAT,DATA
 Q
HDR D HDR^DVBCUTIL
 Q
STATCHK S I="",NCN=1 F J=0:0 S I=$O(^TMP($J,I)) Q:I=""  I $P(^TMP($J,I),U,1)["X"!($P(^(I),U,1)="C") K NCN Q
 I $D(NCN) W !!,*7,"There are no cancelled or completed exams remaining on this request.",!! H 3
 Q
ALL W !! D STATCHK G:$D(NCN) LOOK W ! S ALLROPN=1,EXMNM="" F JJY=0:0 S EXMNM=$O(^TMP($J,EXMNM)) Q:EXMNM=""  S STAT=$P(^TMP($J,EXMNM),U,1) I STAT["X"!(STAT="C") S X=EXMNM D ALL1
 H 2 W @FF D STATUS1^DVBCROP1,NOTIFY G EN
ALL1 K DR S DIC(0)="QM",DR=".04////O;52///@;51///@;50///@"
 S (DIC,DIE)="^DVB(396.4,",DA=$P(^TMP($J,EXMNM),U,2)
 D ^DIE I '$D(Y) W:$X>50 ! W:$L(EXMNM)>25&($X>45) ! W EXMNM," reopened, "
 I $D(Y) W *7,!,"Reopen error on ",EXMNM," exam !",! H 2
 Q
NOTIFY S X=$P(^DVB(396.3,DA(1),0),U,18) I X'["X"&(X'="")&(X'="C") W !!,"Entire exam is now REOPENED.",!! H 1
 I X["X"!(X="")!(X="C") W *7,!!,"Reopen error !",!! H 3 S OUT=1 K X Q
 D BULL K X Q
BULL W !!,"Sending a bulletin to the 2507 REOPENED mail group ...",!!
 H 1 S Y=REQDT X ^DD("DD") S XREQDT=Y
 I RELDAT'="" S Y=RELDAT X ^DD("DD") S XRELDAT=Y
 S XMB="DVBA C 2507 EXAM REOPENED",XMB(1)=PNAM,XMB(2)=SSN,XMB(3)=XREQDT,XMB(4)=$P(^VA(200,DUZ,0),U,1),XMB(5)=$S(RELDAT'="":XRELDAT,1:"This request has not been released.")
 S XMB(6)=$S(RELDAT="":"     This reopen will not affect the AMIE AMIS 290.",1:"     **THIS REOPEN WILL AFFECT THE AMIE AMIS 290**")
 S XMB(7)=$S(RELDAT'="":"/Affects AMIE AMIS 290",1:"")
 I $D(ALLROPN) S OWNDOM=$P(^DVB(396.3,DA(1),0),U,22) I OWNDOM]"" S XDOM=$S($D(^DIC(4.2,OWNDOM,0)):^(0),1:"") S DOMAIN=$P(XDOM,U,1),DOMNUM=+$P(XDOM,U,3)
 I $D(ALLROPN),OWNDOM]"" I +DOMNUM>0 S XMY("G.DVBA C 2507 EXAM REOPENED@"_DOMAIN)=DOMNUM W !!,*7,"I am sending updated information to "_DOMAIN,!,"since this was transferred in.",!! H 2
 D ^XMB
 I $D(ALLROPN),OWNDOM]"",+DOMNUM>0 S REQDA=DA(1) D EN1^DVBCXFRE
 K ALLROPN,CANC,SEND,OWNDOM,DOMNUM,XMB,XREQDT,XDOM,DOMAIN,RELDAT,XRELDAT
 Q

DVBCRPON
DVBCRPON ;ALB/GTS-557/THM-REPRINT C&P REPORTS ; 7/1/91  1:09 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SETUP D HOME^%ZIS K ULINE S FF=IOF,HD="Reprint C & P Exams"
 S XDD=^DD("DD"),$P(ULINE,"_",70)="_"
 I DUZ(2)<1 W !!,*7,"Your division code is invalid.",!! H 2 G EXIT
 S SUPER=0 I $D(^XUSEC("DVBA C SUPERVISOR",DUZ)) S SUPER=1
 ;
SETUP1 ;** Drops into if setup is ok
 W @IOF,!?(IOM-$L(HD)\2),HD,!!!
 S ONE="N",Y=DT X XDD
 S DVBCDT(0)=Y,PGHD="Compensation and Pension Exam Report",LOC=DUZ(2),PG=0,DVBCSITE=$S($D(^DVB(396.1,1,0)):$P(^(0),U,1),1:"Not specified")
 ;
RASK W !!,"Select Reprint Option - (D)ate or (V)eteran:  D// " R RTYPE:DTIME I RTYPE[U!('$T) G EXIT
 I RTYPE'=""&(RTYPE'="D"&(RTYPE'="d"&(RTYPE'="v"&(RTYPE'="V")))) S RTYPE="E"
 W:RTYPE="" "Date" W $S(RTYPE="D"!(RTYPE="d"):"ate",RTYPE="V"!(RTYPE="v"):"eteran",1:"") I RTYPE=""!(RTYPE="d") S RTYPE="D"
 I RTYPE="v" S RTYPE="V"
 I RTYPE'?1"D",RTYPE'?1"V" W !!,"Must be D or V" G RASK
 G:RTYPE="D" ADATE I RTYPE="V" S ONE="Y"
 ;
ONLYLAB ;** Dropped into if the user doesn't exit from RASK and selects to
 ;**  to reprint by veteran
 W !!,"Do you want just the Lab/X-ray results" S %=2 D YN^DICN I %=1 H 1 G REN^DVBCLABR ;** Branches to ^DVBCLABR which branches to ^DVBCPRNT
 I %=0 W !!,"Enter Y to get just the Lab/X-ray results for the Vet",!,"or N to get the entire exam results AND Lab/X-ray." H 2 G ONLYLAB
 ;
ADATE ;** Jumped into from RASK or dropped into from ONLYLAB
 I RTYPE="D" S %DT="AE",%DT("A")="Enter original printing date: ",%DT(0)=-DT D ^%DT G:+Y<0 EXIT S RUNDATE=+Y
 ;
WHO ;** Dropped into from ADATE
 W !!,"Reprinted by the RO or MAS ?   >> " R ANS:DTIME G:'$T EXIT I ANS=""!(ANS=U) G EXIT
 I ANS'="R"&(ANS'="r"&(ANS'="m"&(ANS'="M"))) S ANS="E"
 W $S(ANS="M"!(ANS="m"):"AS",ANS="R"!(ANS="r"):"O",1:"")
 S:ANS="r" ANS="R"
 S:ANS="m" ANS="M"
 I ANS'?1"R"&(ANS'?1"M") W !,"Must be R for Regional Office or M for MAS.",!!,*7 G WHO
 I ANS="R" K AUTO ;selects header type
 I ANS="M" S AUTO=1
 I ONE="Y" K OUT D ONEVET I $D(OUT) G EXIT
 ;
DEVICE ;** Dropped into from WHO
 W !! S %ZIS="AEQ",%ZIS("B")="0;P-OTHER",%ZIS("A")="Output device: " D ^%ZIS G:POP EXIT
 I $D(IO("Q")),ONE="N" S ZTRTN="GO^DVBCRPRT",ZTIO=ION,ZTDESC="2507 Final Exam Reprint" F I="XDD","D*","PGHD","RTYPE","RUNDATE","Y","AUTO","LOC","ANS","ULINE","ONE" S ZTSAVE(I)=""
 I $D(IO("Q")),ONE="Y" S ZTRTN="OV^DVBCRPON",ZTIO=ION,ZTDESC="Single 2507 Final Exam Reprint" F I="XDD","D*","PGHD","RTYPE","RUNDATE","Y","AUTO","LOC","ANS","ULINE","ONE" S ZTSAVE(I)=""
 I $D(IO("Q")) D ^%ZTLOAD W:$D(ZTSK) !!,"Request queued",!! H 1 G EXIT
 I ONE="N" G GO^DVBCRPRT
 I ONE="Y" G OV
 ;
ONEVET ;** Called from WHO when ONE=Y
 W !! S DIC("W")="D DICW^DVBCUTIL",DIC="^DVB(396.3,",DIC(0)="AEQM" D ^DIC I X=""!(X=U) S OUT=1 Q
 I +Y<0 W *7,"   ???" H 2 G ONEVET
 S DA=+Y
 S RO=$P(^DVB(396.3,DA,0),U,3) I RO'=DUZ(2)&('$D(AUTO))&(SUPER=0) W !!,*7,"Those results do not belong to your office.",!! H 3 G ONEVET
 I RO=DUZ(2)&('$D(AUTO))&("RC"'[($P(^DVB(396.3,DA,0),U,18))) W *7,!!,"This request has not been released to the Regional Office yet.",!! H 3 G ONEVET
 S PRTDATE=$P(^DVB(396.3,DA,0),U,16) I PRTDATE="" W *7,!!,"This has never been printed.",!! I SUPER=0 S OUT=1 H 3 Q
 Q
 ;
OV ;** Run as a background task or in real-time
 U IO S DA(1)=DA K DVBAON2 D SETLAB^DVBCPRNT,VARS^DVBCUTIL,STEP2^DVBCRPRT
 K AUTO D ^%ZISC I '$D(ZTQUEUED) G SETUP1
 ;
EXIT K AUTO S LKILL=1 D:$D(ZTQUEUED) KILL^%ZTLOAD G KILL^DVBCUTIL
 ;
 Q

DVBCRPR1
DVBCRPR1 ;ALBANY-ISC/GTS-REPRINT C&P REPORT CONTINUED ;4/28/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;  ** Entry points called only from DVBCRPRT **
 ;  ** All TAGS are entry points **
HDR S PG=PG+1 I PG>1 D HDR3^DVBCUTL2 Q
 S:ZPR'="E" TOTTIME=$$PROCDAY^DVBCUTL2(DA(1))
 S:ZPR="E" TOTTIME=$$INSFTME^DVBCUTA1(DA(1))
 S OUTTIME="Processing time: "_TOTTIME
 I (IOST?1"C-".E)!($D(DVBAON2)) W @IOF
 S:('$D(DVBAON2)) DVBAON2=""
 W !,"Date: ",DVBCDT(0),?(80-$L(PGHD)\2),PGHD,?71,"Page: ",PG,!?(80-$L(DVBCSITE)\2),DVBCSITE,!
 W ?29,"** REPRINT OF FINAL **",! W ?(80-$L(OUTTIME)\2),OUTTIME,!
 W ?(80-$L(EXHD)\2),EXHD,! F LNE=1:1:80 W "="
 K LNE S:EXHD["AGENT ORANGE" DVBCAO=1 I EXHD'["AGENT ORANGE" K DVBCAO
 D SSNOUT^DVBCUTIL
 W !!?2,"Name: ",PNAM,?56,"SSN: ",DVBCSSNO,!?51,"C-Number: ",CNUM,!?56,"DOB: " S Y=DOB X XDD W Y,!?2,"Address: ",ADR1,! W:ADR2]"" ?11,ADR2,! W:ADR3]"" ?11,ADR3,!!
 K DVBCSSNO
 W !?2,"City,State,Zip+4: ",?48,"Res Phone: ",HOMPHON,!?5,CITY,"  ",STATE,"  ",ZIP,?48,"Bus Phone: ",BUSPHON,!
 W !,"Entered active service: " S Y=EOD X XDD S:Y="" Y="Not specified" W Y,?40,"Last rating exam date: ",LREXMDT,! S Y=RAD X XDD S:Y="" Y="Not specified" W "Released active service: " W Y,!!,"Priority of exam: ",PRIO,!
 F LNE=1:1:80 W "="
 W !
 I IOST?1"P-".E DO  ;this resets $y when this header prints. when using
 .S DX=0,DY=24 ;by vet. there is no form feed to reset $y
 .X ^%ZOSF("XY")
 .Q
 Q
 ;
UP F XIX=$Y:1:(IOSL-6) W !
 Q
 ;
BOT I '$D(AUTO),$D(PRINT) D UP W ?7,"This exam has been reviewed and approved by the examining physician" W:$D(DVBCAO) !?27,"and signed by the veteran" W ".",!!,"VA Form 2507",! ;for RO
 I $D(AUTO),$D(PRINT) D UP W ?7,"Adequated by: ___________________________________     Date: _____________",!!
 I $D(AUTO),$D(PRINT) W "Physician signature: ___________________________________     Date: _____________",!!,"VA Form 2507",!
 Q
 ;
HDA S:'$D(XPG) XPG=0 S XPG=XPG+1
 I (IOST?1"C-".E)!($D(DVBAON2)) W @IOF
 S:('$D(DVBAON2)) DVBAON2=""
 W !,"Final C&P Reports for print date " S Y=DT X XDD W Y,!!,"Operator: ",$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"Unknown operator"),!,"Location: ",$S($D(^DIC(4,+DUZ(2),0)):$P(^(0),U,1),1:"Unknown location"),!
 W !,"Veteran Name",?28,"SSN",?43,"C-Number",?55,"Request date",!
 F XXLN=1:1:79 W "-"
 W !!
 Q

DVBCRPRT
DVBCRPRT ;ALB/GTS-557/THM-REPRINT C&P REPORT ; 5/17/91  10:28 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ; ** DVBCRPRT is called from DVBCRPON only **
PHYS S PHYS=$S($D(^DVB(396.4,DA,0)):$P(^(0),U,7),1:"")
 Q
STEP2A ;  ** Called from STEP2 only **
 S EXMNM=$S($D(^DVB(396.6,$P(^DVB(396.4,DA,0),U,3),0)):$P(^(0),U,1),1:"Unknown exam"),EXHD="For "_EXMNM_" Exam" D HDR^DVBCRPR1
 W "Examining provider: ",PHYS,!,"Examined on: " S Y=$P(^DVB(396.4,DA,0),U,6) X XDD W Y,! F LINE=1:1:80 W "="
 W !!?2,"Examination results:",!! S EXSTAT=$P(^DVB(396.4,DA,0),U,4) I EXSTAT="X"!(EXSTAT="RX") W !!!!!?25,"This exam was CANCELLED by ",$S(EXSTAT="RX":"the RO.",1:"MAS."),!! Q
 D STEP3
 Q
STEP2 ; ** An external entry point and called from GO2 **
 F DA=0:0 S DA=$O(^DVB(396.4,"C",DA(1),DA)) Q:DA=""  D GETRO Q:RO'=DUZ(2)&('$D(^XUSEC("DVBA C SUPERVISOR",DUZ)))  S PG=0 D PHYS,STEP2A I $D(PRINT) D BOT^DVBCRPR1 K PRINT
 D ^DVBCLABR Q
 K DVBAON2
 Q
STEP3 ;  ** Called from STEP2A only **
 K ^UTILITY($J,"W") S DIWL=1,DIWR=80,DIWF="NW" S OLDA=DA,OLDA1=DA(1)
 F LINE=0:0 S LINE=$O(^DVB(396.4,OLDA,"RES",LINE)) Q:LINE=""  S X=^DVB(396.4,OLDA,"RES",LINE,0) S:X="<" X=" <" S X=$P(X,"<",1) D ^DIWP,STEP3A
 D ^DIWW S PRINT=1 S DA=OLDA,DA(1)=OLDA1
 Q
STEP3A ;  ** Called from STEP3 only **
 I $Y>(IOSL-9) D UP^DVBCRPR1,NEXT,HDR^DVBCRPR1 W:$O(^DVB(396.4,OLDA,"RES",LINE))]"" !!,"Exam Results Continued",!!
 Q
GO ;  ** An external entry point called from DVBCRPON **
 U IO K ^TMP($J),DVBAON2 D HDA^DVBCRPR1 S (XCNT,XPRINT)=0
 I '$D(^XUSEC("DVBA C SUPERVISOR",DUZ)) D
 .F DA(1)=0:0 S DA(1)=$O(^DVB(396.3,"AF","C",DUZ(2),DA(1))) Q:DA(1)=""  DO
 ..I $D(^DVB(396.3,DA(1),0)) D GO1
 ..I '$D(^DVB(396.3,DA(1),0)) D BADXRF^DVBCPRNT
 I $D(^XUSEC("DVBA C SUPERVISOR",DUZ)) D
 .F LOC=0:0 S LOC=$O(^DVB(396.3,"AF","C",LOC)) Q:LOC=""  D
 ..F DA(1)=0:0 S DA(1)=$O(^DVB(396.3,"AF","C",LOC,DA(1))) Q:DA(1)=""  DO
 ...I $D(^DVB(396.3,DA(1),0)) D GO1
 ...I '$D(^DVB(396.3,DA(1),0)) D BADXRF^DVBCPRNT
 I XPRINT=0 K XPRINT,XPG,XXLN W !!!!!?25,"Nothing to print",!! H 2 G KILL^DVBCUTIL
 I XCNT>0,XPRINT=1 W !!,"Total requests to be printed: ",XCNT,!
 K XCNT,XXLN,XPG,XPRINT D SETLAB^DVBCPRNT S (XCN,PNAM)=""
 F DVBCN=0:0 S XCN=$O(^TMP($J,XCN)) Q:XCN=""  F JJ=0:0 S PNAM=$O(^TMP($J,XCN,PNAM)) Q:PNAM=""  D GO2
 G EXIT
GO2 F DA(1)=0:0 K PRINT S DA(1)=$O(^TMP($J,XCN,PNAM,DA(1))) Q:DA(1)=""  S PRTDATE=$P(^DVB(396.3,DA(1),0),U,16) I PRTDATE[RUNDATE S DA=DA(1) D VARS^DVBCUTIL Q:(LOC'=RO)&('$D(^XUSEC("DVBA C SUPERVISOR",DUZ)))&('$D(AUTO))  D STEP2
 Q
GO1 S DFN=$P(^DVB(396.3,DA(1),0),U,1),PRTDATE=$P(^(0),U,16),PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Missing")
 I RTYPE="D" Q:PRTDATE'[RUNDATE!(RUNDATE']"")
 S XCN=$E(CNUM,$L(CNUM)-1,$L(CNUM)),XCN=+XCN
 I PNAM]"" S ^TMP($J,XCN,PNAM,DA(1))="",XPRINT=1,XCNT=XCNT+1
 D SSNSHRT^DVBCUTIL
 W $E(PNAM,1,25),?28,DVBCSSNO,?43,CNUM,?55 S Y=$P(^DVB(396.3,DA(1),0),U,2) X XDD W Y,! D:$Y>(IOSL-16) HDA^DVBCRPR1
 K PNAM,XCN,CNUM,DVBCSSNO
 Q
 ;
EXIT K XDD,AUTO S LKILL=1 G KILL^DVBCUTIL ; ** GOTO will quit from this RTN
 ;
NEXT W !,"Continued on next page",!,"VA Form 2507"
 Q
 ;
GETRO S RO=$P(^DVB(396.3,DA(1),0),U,3)
 Q

DVBCSCCK
DVBCSCCK ;ALB/GTS-557/THM-SCAR EXAM ; 12/27/90  1:52 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1445 Worksheet" S HD7="SCARS, OTHER THAN BURNS (ORTHOPEDIC/DISFIGUREMENT)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"The type of injury or infection causing the wound or scar,",!?13,"its date, the treatment used and the response to such",!?13,"treatment should be described.  Point of entrance and exit of",!?13,"missiles are important "
 W "in evaluating injuries of nerves, vessels,",!?13,"and muscles.  Photographs, if indicated, (see Physician's Guide,",!?13,"Paragraph 1.19) should be submitted.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!,?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Position, shape, texture, length, width, color, depth -",!!!!!?8,"2. Keloid formation, adherance, herniation -",!!!!!?8,"3. Inflammation, swelling, depression, vascular supply, ulceration -",!!!!!
 W ?8,"4. Tender and painful on objective demonstration -",!!!!!?8,"5. Cosmetic effects (submit photographs of all facial",!?29,"and other significant scars) -",!!!!!?8,"6. Limitation of function of part affected -",!!!!! D:$D(CMBN) HD2
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:'$D(CMBN) HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",!,HD7,!!,"for "_NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCSCHD
DVBCSCHD ;ALB/GTS-557/THM-SCHEDULE C&P EXAMS ; 9/23/91  9:54 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - GTS/Set DVBADA,DVBASDRT SD Event driver  (Enhc 13)
 ;
SETUP D HOME^%ZIS S HD="SCHEDULE C&P EXAMS",FF=IOF
 I $D(DUZ)#2=0 W *7,!!,"You have no user number !",!! H 3 G EXIT
 S SUPER=0 I $D(^XUSEC("DVBA C SUPERVISOR",DUZ)) S SUPER=1
 ;
EN D ZAP W @FF,?(IOM-$L(HD)\2),HD,!!!
 S DIC="^DVB(396.3,",DIC(0)="AEQM",DIC("A")="Enter VETERAN NAME: ",DIC("W")="D DICW^DVBCUTIL"
 D ^DIC G:X=""!(X[U)!($D(DTOUT)) EXIT
 I +Y>0 S (OLDDA,REQDA)=+Y,DFN=$P(Y,U,2)
 I $O(^DVB(396.4,"C",REQDA,0))="" W !!,*7,"This request has no exams on it and should",!,"be completely cancelled.",!! H 3 G EN
 D GO1 I '$D(TFIND) W !!,*7,"This request has been completely transferred to another site.",!,"Scheduling will not be allowed.",!! H 3 G EN
 S STAT=$P(^DVB(396.3,+Y,0),U,18) D STATCHK I $D(NCN) G EN
 S DTSCHED=$P(^DVB(396.3,+Y,0),U,6) I DTSCHED]"" W !!,*7,"Scheduling has been completed for this request as of ",$E(DTSCHED,4,5)_"/"_$E(DTSCHED,6,7)_"/"_$E(DTSCHED,2,3)_".",!
 I DTSCHED]"",SUPER=0 W "Only supervisors can change it.",!! H 3 G EN
 ;
ASK K %,%Y I DTSCHED]"",SUPER=1 W "Do you want to change" S %=2 D YN^DICN G:$D(DTOUT)!(%<0) EXIT
 I $D(%Y),%Y["?" W !!,"Enter Y to be able to change the scheduling information or N to backup.",!! G ASK
 I $D(%),%'=1 G EN
 ;
ASK1 I $D(^DVB(396.3,REQDA,4)),$P(^(4),U,1)="y" W !!,"Note:  One or more exams on this request have transferred out."
 W !!,"Do you want to make an appointment for a clinic" S %=1 D YN^DICN G:$D(DTOUT)!(%<0) EXIT I %=1 W @FF,"Schedule a Clinic Appointment for 2507 Exam",!!! S ORACTION=1,DVBADA=REQDA,DVBASDRT="",ORVP=DFN D OERR^SDM
 I $D(%Y),%Y["?" W !!,"Enter Y to make an appointment via ADT/Scheduling or N to skip." G ASK1
 ;
EN1 W @FF,"Enter Scheduling Information for 2507 Exams",!!
 ;
ASK2 W !,"Has scheduling for all exams been completed" S %=2 D YN^DICN G:$D(DTOUT)!(%<0) EXIT
 I $D(%Y),%Y["?" W !!,"Enter Y if scheduling is completed, N if not.",!! G ASK2
 G:%'=1 EN
 W !!,"Ok, then please complete the following:",!!
 S:$P(^DVB(396.3,REQDA,0),U,6)="" DR="5///NOW",DIE="^DVB(396.3,",DA=REQDA D ^DIE:$P(^DVB(396.3,REQDA,0),U,6)="",EXAMS I '$D(Y) G EN
 I $D(Y) W *7,!!,"Important scheduling information is missing!",!,"2507 file NOT updated!",!! S DR="5///@",DIE="^DVB(396.3,",DA=REQDA D ^DIE H 2 G EN ;delete date if "^"
 ;
ZAP K %,%Y,NCN,DFN,EXAM,JDR,JDT,DTSCHED,REQDA,RO,RONAME,STAT,TFIND,TSTDT
 Q
 ;
EXIT K TFIND,ORACTION,ORVP,DVBAXJ,DVBASDRT G KILL^DVBCUTIL
 ;
STATCHK Q:STAT="P"!(STAT="N")!(STAT="NT")!(STAT="S")!(STAT="O")
 W !!,*7,"This request has been ",$S(STAT="RX":"cancelled by the RO",STAT="X":"cancelled by MAS",STAT="T":"transcribed",STAT="R":"released",STAT="C":"completed",STAT="CT":"completed, transferred out",1:"given an incorrect status"),".",!!
 S NCN=1 H 2 Q
 ;NCN=no can do
 Q
 ;
EXAMS H 1 S DA(1)=REQDA
 F DA=0:0 S DA=$O(^DVB(396.4,"C",DA(1),DA)) Q:DA=""!(+DA=0)  S EXNAME=+$P(^DVB(396.4,DA,0),U,3),EXST=$P(^(0),U,4),EXNAME=$S($D(^DVB(396.6,EXNAME,0)):$P(^(0),U,1),1:"") I EXST'["X",EXST'="T" D EXAMS1 ;screen cancels, transfers
 Q
 ;
EXAMS1 I EXNAME]"" S DIE="^DVB(396.4,",DR=".08//NO;.09//CLINIC" W @IOF,!!!,"Exam: ",EXNAME,!!! D ^DIE Q:$D(Y)
 Q
 ;
GO1 K TFIND F DVBAXJ=0:0 S DVBAXJ=$O(^DVB(396.4,"C",REQDA,DVBAXJ)) Q:DVBAXJ=""  I $P(^DVB(396.4,DVBAXJ,0),U,4)'="T" S TFIND=1
 Q
 ;if $D(TFIND) at least one exam to be done locally
 ;if '$D(TFIND) all exams are transferred/don't consider

DVBCSDEV
DVBCSDEV ;ALB/GTS-AMIE C&P APPT EVENT DRIVER ; 10/19/94  3:45 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
 ;** Variable Descriptions
 ;** DVBAORG = 1 Appointment event (Originating process variable)
 ;** SDAMEVT = 1 Make appointment event
 ;**           2 Cancel appointment event
 ;**           3 No Show appointment event
 ;** I DVBAAUTO exists, AMIE Make Event is not executed because
 ;**  cancel/no show part of auto-rebook updated 396.95
 ;** DVBAXST=1 - ^TMP("SDEVT",$J) exists
 ;** DVBATYPE=1 - C&P type appointment
 ;
EN ;**AMIE Scheduling event driver main entry point
 S DVBAORG=$$SDORGST^DVBCUTL5
 I +DVBAORG=1 DO
 .S DVBAXST=$$SDEVTXST^DVBCUTL5
 .I +DVBAXST=1 DO
 ..S DVBATYPE=$$SDEVTSPC^DVBCUTL5(16)
 ..I +DVBATYPE=1 DO
 ...I +SDAMEVT=1,('$D(DVBAAUTO)) D EN^DVBCMKLK ;** Original Make event
 ...I +SDAMEVT=1,($D(DVBAAUTO)) K DVBAAUTO ;** Auto-rebook Make event
 ...I +SDAMEVT=2!(+SDAMEVT=3) D EN^DVBCCNNS ;** Cancel/No show event
 ..K DVBATYPE
 .K DVBAXST
 K DVBAORG
 D KVARS^DVBCMKLK
 Q

DVBCSECK
DVBCSECK ;ALB ISC/THM-SKIN, NOT ELSEWHERE CLASSIFIED ; 6/6/90  8:18 AM
 ;;2.7;AMIE;;Apr 10, 1995
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 S DVBAX="For SKIN, NOT ELSEWHERE CLASSIFIED"
 S PG=1
 W !?22,"Compensation and Pension Examination",!?33,"# 1610 Worksheet",!,?(IOM-$L(DVBAX)\2),DVBAX,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!,?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: SKIN, NOT ELSEWHERE CLASSIFIED",!!
 W "Physician's Guide Reference:  None",!!,"Narrative:",!!
 F I=0:1 S LY=$T(TXT+I) D:LY["TOF" HD2 Q:LY["END"  W:LY'["TOF" $P(LY,";;",2),! I $Y>55 D HD2
 K I,LY,DVBAX Q
 ;
TXT ;;This exam is to handle the balance of currently recognized skin
 ;;disorders and to allow for new disorders not yet classified for V.A.
 ;;compensation evaluations.  The severity of a condition is based upon the
 ;;residual disability.  If there is a disease process that affects multiple
 ;;systems or extremeties, please evaluate each separately.
 ;;
 ;;
 ;;A. Medical history (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;B. Subjective findings (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;C. Objective findings (W/P):
 ;;TOF
 ;;
 ;;
 ;;D. Evaluation Information for the Rating Board:
 ;;
 ;;
 ;;  Residual disability effect on:
 ;;
 ;;
 ;;    1) earning capacity/job performance (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    2)  everyday activities (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    3)  Is disability constant? (YES/NO):
 ;;          
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    4)  If NO, give frequency, length of remissions (F/T):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;    5)  Acute exacerbations effect on everyday life. (F/T)
 ;;TOF
 ;;
 ;;
 ;;E. Diagnosis (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;F. Diagnostic tests (Lab,X-Ray, etc) (W/P):
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;
 ;;                         Signature: ______________________________
 ;;
 ;;                              Date: _________________________
 ;;END
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W "For SKIN, NOT ELSEWHERE CLASSIFIED",!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCSKCK
DVBCSKCK ;ALB/GTS-557/THM-SKIN, OTHER THAN SCARS ; 12/11/90  7:31 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1610 Worksheet" S HD7="SKIN, OTHER THAN SCARS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"When furnishing the history of the present skin disease",!?13,"include a description of the skin changes, when the disorder",!?13,"first appeared, and the progression of the illness since that",!?13,"time.  Note whether"
 W " remissions or exacerbations occurred",!?13,"and whether they were related to the occupation or treatment.",!?13,"Include the duration of remissions and factors that",!?13,"may have influenced the course of the disorder.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:  "
 I '$D(CMBN) W ?24,"(List the types of complaints such as itching",!,"burning, pain and anesthesia.  Note whether environmental factors such as",!,"temperature or seasonal change affect the severity of the symptoms.)",! D HD2
 I '$D(CMBN) W "C. Objective findings:",!!!!!!!!!!!!!
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Description of skin disorder -",!!!!!?8,"2. Distribution of skin disorder -",!!!!!?8,"3. Configuration and characteristics of lesions -",!!!!!!?8,"4. Nervous manifestations -",!!
 W !!!?8,"5. Attach color photograph if condition is disfiguring.",!
 D HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!
 W "(Note:  If current diagnosis differs from the skin condition",!,"for which the examination was ordered, then review prior records and",!,"express opinion whether current disease is a new problem or original ",!,"diagnosis was in error.)"
 W !!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",!,NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCSMCK
DVBCSMCK ;ALB/GTS-557/THM-SENSE OF SMELL ; 12/27/90  1:40 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1320 Worksheet" S HD7="SENSE OF SMELL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Report whether loss is partial or complete and whether it",!?13,"is on an organic or psychiatric basis.  If a psychiatric",!?13,"basis is suspected, a special psychiatric examination should",!?13,"be ordered.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?4,"Substances used for testing olfaction and results (each side of nose",!?8,"should be tested separately):"
 W !!?8,"1. Coffee -",!!!?8,"2. Benzaldehyde -",!!!?8,"3. Tar -",!!!
 W ?8,"4. Oil of lemon -",!!!?8,"5. Other (state substance) -",!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCSPCK
DVBCSPCK ;ALB/GTS-557/THM-SPINAL EXAM ; 5/17/91  9:08 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1450 Worksheet" S HD7="SPINE (ORTHOPEDIC)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Complete description of spinal orthosis, its impact on",!?13,"motion before and after application, and whether the ",!?13,"usage is constant or intermittent should be part of the",!?13,"findings.",!!?13,"To give uniformity in "
 W "describing limitation of motion or",!?13,"ankylosis, THE USE OF A GONIOMETER IS REQUIRED.  Report",!?13,"each spinal segment separately.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Postural abnormalities -",!!!!!?8,"2. Fixed deformity -",!!!!!?8,"3. Musculature of back -",!!!!!
 W ?8,"4. Range of motion:",!!?10,"a. Forward flexion -",!!!!?10,"b. Backward extension -",!!!!?10,"c. Left lateral flexion -",!!!! D:$D(CMBN) HD2
 W ?10,"d. Right lateral flexion -",!!!!?10,"e. Rotation to left -",!!!!!?10,"f. Rotation to right -",!!!!!
 W ?8,"5. Objective evidence of pain on motion -",!!!!! D:'$D(CMBN) HD2 W ?8,"6. Identify and describe any evidence of neurological involvement -",!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7," for "_NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCSRCK
DVBCSRCK ;ALB/GTS-557/THM-SCARS,BURN ; 12/27/90  2:11 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1605 Worksheet" S HD7="SCARS, BURN",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"When true third degree burn involvement is established,",!?13,"measure and describe all areas of scarring and all secondary",!?13,"functional impairments.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Shape and dimension (specify units) -",!!!?8,"2. Color -",!!!?8,"3. Extent -",!!!?8,"4. Provide photographs for all facial burns and any",!?11,"areas of especially repugnant disfigurement -",!!!!!
 W ?8,"5. Tender and painful on objective demonstration -",!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCSTCK
DVBCSTCK ;ALB/GTS-557/THM-STOMACH EXAM ; 12/6/90  11:45 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0325 Worksheet" S HD7="STOMACH (DIGESTIVE)",HD8="for "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",?14,HD7
 W !!!!,"Narrative:"
 W ?13,"The term ""peptic ulcer"" should not be used in examination",!?13,"reports.  Ulcer site should be localized as ""gastric"",",!
 W ?13,"""duodenal"", or ""marginal"" so as to conform to rating",!?13,"schedule terminology.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W:$D(CMBN) !! W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Current weight -",!!!!!!?8,"2. Maximum weight, past year -",!!!!!!?8,"3. Is the veteran anemic? -",!!!!!!
 W ?8,"4. Periodic vomiting -",!!!!!!?8,"5. Recurrent hematemesis or melena -",!!!!!! D:$D(CMBN) HD2 W ?8,"6. Area of pain -",!!!!!! D:'$D(CMBN) HD2
 W ?8,"7. Number of days of duration per episode -",!!!!!!?8,"8. Frequency of episodes per year -",!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!,$S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!
 W HD8,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCSYCK
DVBCSYCK ;ALB/GTS-557/THM-SYSTEMIC CONDITIONS ; 12/28/90  10:08 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1805 Worksheet" S HD7="SYSTEMIC CONDITIONS",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !!,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Many systemic conditions have stormy acute phases during",!?13,"onset and recurrences but leave little or no residual",!?13,"disability after they are cured or arrested.  Others have slow",!?13,"progression with disabling "
 W "residuals, after relatively mild",!?13,"or transient earlier phases.  The examiner must search for and",!?13,"describe the residual disabilities upon which adjudication",!?13,"of the claim can be determined.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Renal impairment -",!!!?8,"2. Mental changes -",!!!?8,"3. Anemia -",!!!?8,"4. Neurological -",!!!?8,"5. Musculoskeletal -",!!!?8,"6. Skin -",!!!?8,"7. Cardiac -",!!!!!
 D:$D(CMBN) HD2 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis (if malaria, tuberculosis, or other mycobacterial",!,?14,"disease, specify organism):"
 W !!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCTRN
DVBCTRN ;ALB/JLU;This is an integration routine;5/18/92
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN2(DVBCROT,DVBCPAK,DVBCSFT,DVBCPHY,DVBCDTE) ;
 ;This entry point will first check to see if the soft link is valid
 ;if so then it will down load the information to AMIE.
 ;DVBCROT -  This is the variable root (local or global) that is 
 ;           currently holding the information to be down loaded.
 ;           It should not contain any parenthesis. Ex. JJ OR ^JJ
 ;DVBCPAK -  This is the name of the package that is using this entry
 ;           point.
 ;DVBCSFT -  This is the soft link
 ;DVBCPHY -  This is a pointer to the New Person file of the physican who
 ;           performed the exam.
 ;DVBCDTE -  This is the date the exam was performed.  It must be in
 ;           FM format.
 ;
 ;all must be defined in order for this entry except DVBCDTE and DVBCPHY
 ;point to be used.
 ;** Even though this entry point checks to see if the request and exam
 ;can still receive data, it should not be used in place of EN1 for this
 ;type of checking.
 ;
 N DVBCAGL1,DVBCAGL,DVBCFN2,DVBCFN3,DVBCX,DVBCNNUM,DVBEST,DVBAGL,DVBCST,DVBCST1,DVBX,DVBCST2,DVBCHK,DVBC,DVBCFN1,DVBCDT,DVBCRT1,DVBCRT2
 I $S('$D(DVBCROT):1,DVBCROT']"":1,1:0) Q "-1^Global root not defined or is null"
 I $S('$D(DVBCPAK):1,DVBCPAK']"":1,1:0) Q "-2^Sending package name not defined or is null"
 I $S('$D(DVBCSFT):1,DVBCSFT']"":1,1:0) Q "-3^Soft link not defined or is null"
 ;I $S('$D(DVBCDTE):1,DVBCDTE']"":1,1:0) Q "-3^Date of exam not defined."
 ;I $S('$D(DVBCPHY):1,DVBCPHY']"":1,1:0) Q "-3^Physician is not defined."
 ;I $D(DVBCPHY),($S(DVBCPHY']"":1,'$D(^VA(200,DVBCPHY,0)):1,1:0)) Q "-9^Check New Person file pointer value."
 S DVBCPHY=$S('$D(DVBCPHY):"",DVBCPHY']"":"",$D(^VA(200,DVBCPHY,0)):$P(^(0),U,1),1:"")
 I $D(DVBCDTE),(DVBCDTE'?7N0.1".".N) Q "-10^Check exam date."
 I '$D(DVBCDTE) S DVBCDTE=""
 ;
 D SFT
 I $P(DVBCHK,"^",1)<0 Q DVBCHK
 S DVBCAGL=DVBCFN3_DVBEST_",""RES"")"
 I '$D(@DVBCAGL@(0)) S ^(0)="^^0^0^"_DT_"^^^^"
 S DVBCST=$P(^(0),"^",3)+1 ;naked references the I '$D above.
 S DVBCST1=0
 S Y=DT D DD^%DT S DVBCDT=Y
 K Y
 F DVBX=1:1:3 S @DVBCAGL@(DVBCST,0)=$S(DVBX=2:"** "_DVBCPAK_" / "_DVBCDT_" **",1:" "),DVBCST=DVBCST+1,DVBCST1=DVBCST1+1
 S DVBCST2=""
 F DVBCST=DVBCST:1 S DVBCST2=$O(@DVBCROT@(DVBCST2)) Q:DVBCST2=""  S @DVBCAGL@(DVBCST,0)=@DVBCROT@(DVBCST2),DVBCST1=DVBCST1+1
 S DVBCST=DVBCST-1
 S DVBCST1=DVBCST1+$P(@DVBCAGL@(0),"^",4)
 S $P(@DVBCAGL@(0),"^",1,5)="^^"_DVBCST_"^"_DVBCST1_"^"_DT
 ;setting physican and date
 S DIE="^DVB(396.4,",DA=DVBEST
 S DR=".04///C;.06////"_DVBCDTE_";.07////"_DVBCPHY
 D ^DIE
 K DA,DIE,DR
 Q "1^Down load of transcription complete"
 ;
 ;
EN1(DVBCDFN,DVBCXM,DVBCSFT) ;
 ;This entry point is used to 1) acquire the soft link information and
 ;2) verify the availability of the soft link's request at a latter date.
 ;DVBCDFN -  This is the DFN of the Patient the exam was or is to be
 ;performed on.
 ;DVBCXM -  This is the name of the exam.  A search of file 396.6 will
 ;be done to see if this exam exists.
 ;DVBCSFT -  This is the soft link that the calling program wants
 ;verified.  DVBCSFT need only be defined if a soft link is known and
 ;someone wishes to verify its availability.
 ;
 N DVBC,DVBCDFN1,DVBEST,DVBCFN1,DVBCFN2,DVBCFN3,DVBCHK,DVBCORQ,DVBCOXM,DVBCROT,DVBCST,DVBCST1,DVBCST2,DVBCX,DVBCXM1,DVBCRT1,DVBCRT2,DVBJ
 I $D(DVBCSFT) D SFT
 I '$D(DVBCSFT) D NSFT^DVBCTRN1
 Q DVBCHK
 ;
SFT S DVBC=$P(DVBCSFT,";",1)
 S DVBCFN1=$P(DVBC,":",1)
 I 'DVBCFN1!('$D(^DIC(DVBCFN1,0,"GL"))) S DVBCHK="-1^File number of soft link is bad" Q
 I DVBCFN1'=396.3 S DVBCHK="-1.5^File number of soft link is incorrect." Q
 ;naked references ^dic(dvbcfn1,0,"gl") on line before
 S DVBCFN2=^("GL")
 S DVBCX=$P(DVBC,":",2)
 I DVBCX'?1.9N S DVBCHK="-2^Entry number in soft link is bad" Q
 S DVBCFN3=$P(DVBC,":",3)
 I 'DVBCFN3!('$D(^DIC(DVBCFN3,0,"GL"))) S DVBCHK="-3^Second file number in soft link is bad" Q
 I DVBCFN3'=396.4 S DVBCHK="-3.5^Second file number in soft link is incorrect." Q
 ;naked reference from ^dic(dvbcfn3,0,"gl")
 S DVBCFN3=^("GL")
 S DVBEST=$P(DVBC,":",4)
 I DVBEST'?1.9N S DVBCHK="-4^2507 Exam entry number in soft link is bad" Q
 S DVBCRT1=DVBCFN2_DVBCX_")"
 I '$D(@DVBCRT1@(0)) S DVBCHK="-5^This request nolonger exists" Q
 ;naked references indirected gloabal on line before
 I '$$OREQ^DVBCTRN1($P(^(0),"^",18)) S DVBCHK="-6^This request is nolonger open" Q
 S DVBCRT2=DVBCFN3_DVBEST_")"
 I '$D(@DVBCRT2@(0)) S DVBCHK="-7^Exam nolonger exists." Q
 ;naked references indirected global on line before
 I "OC"'[$P(^(0),"^",4) S DVBCHK="-8^Exam can nolonger accept data" Q
 I $P(^(0),"^",2)'=DVBCX S DVBCHK="-9^This exam does not belong to the proper request." Q
 S DVBCHK="1^Entry can still receive data"
 Q

DVBCTRN1
DVBCTRN1 ;ALB/JLU;AMIE link routine;12/21/92
 ;;2.7;AMIE;;Apr 10, 1995
NSFT I $S('$D(DVBCDFN):1,DVBCDFN']"":1,1:0) S DVBCHK="-1^Patient's DFN not defined OR is null" Q
 I $S('$D(DVBCXM):1,DVBCXM']"":1,1:0) S DVBCHK="-2^Exam not defined OR is null" Q
 S DVBCDFN1=$O(^DVB(396.3,"B",DVBCDFN,0))
 I 'DVBCDFN1 S DVBCHK="-3^NO 2507 request for this patient" Q
 S DVBCXM1=$O(^DVB(396.6,"B",DVBCXM,0))
 I 'DVBCXM1 S DVBCHK="-4^NO Exam by that name in the 2507 Exam file" Q
 ;
 S DVBCOXM=$O(^DVB(396.4,"APS",DVBCDFN,DVBCXM1,"O",0))
 I 'DVBCOXM S DVBCHK="-6^No open Exam for data given" Q
 I '$D(^DVB(396.4,DVBCOXM,0)) S DVBCHK="-7^Exam cross reference is bad" Q
 S DVBCX=$P(^DVB(396.4,DVBCOXM,0),U,2)
 I '$$OREQ($P(^DVB(396.3,DVBCX,0),"^",18)) S DVBCHK="-5^NO open requests for data given" Q
 S DVBCHK="396.3:"_DVBCX_":"_396.4_":"_DVBCOXM_";^Soft Link entry"
 Q
 ;
OREQ(DVBX) ;
 ;This function will check to see if there is an open request.
 ;DVBCX should contain the REQUEST STATUS.
 ;
 I $S(DVBX'="P"&(DVBX'="S")&(DVBX'="T")&(DVBX'="NT"):1,1:0) Q 0
 Q 1

DVBCTRNN
DVBCTRNN ;ALB ISC/THM-NOTIFY DOC OF REQUIRED TRANSFER DICTATION ; 5/23/91  11:04 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EXIT D GO1 K DVBCCOPY,DVBCX Q
 ;
GO1 W:(IOST?1"C-".E) @IOF K ^UTILITY($J,"W") D X3^DVBCLTR W !!!!!!!
 F ZZI=0:1 S LY=$T(TXT+ZZI) Q:LY["END"  S X=$P(LY,";;",2),DIWF="R",DIWR=75,DIWL=5 D ^DIWP
 D ^DIWW
 K LY,TXT W @IOF Q
 ;
TXT ;;Notice to the physician: |BLANK(1)|
 ;;The attached examination(s) have been transferred to this medical center
 ;;from another center.  It will be required, therefore, that all laboratory
 ;;and X-Ray results be dictated for transcription and return to the
 ;;originating medical center.
 ;;
 ;;END

DVBCTSCK
DVBCTSCK ;ALB/GTS-557/THM-SENSE OF TASTE ; 12/27/90  1:41 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1325 Worksheet" S HD7="SENSE OF TASTE",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"The recommended test substances are sugar, diluted acetic",!?13,"acid, quinine, and common salt.  If electrogustrometry",!?13,"is available, it should be used as the preferred test for",!
 W ?13,"this exam.  Report whether loss is partial or complete",!?13,"and whether it is on an organic basis.  If a psychiatric",!?13,"basis is suspected, a special psychiatric examination",!?13,"should be ordered.",!!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",! D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"Substances used for testing and results:",!!?13,"1. Sweet -",!!!?13,"2. Sour -",!!!?13,"3. Bitter -",!!!
 W ?13,"4. Salt -",!!!,$S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!! D:$Y>50 HD2 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!
 W ?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for "_NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCTTCK
DVBCTTCK ;ALB/GTS-557/THM-TESTES, TRAUMA, OR DISEASE ; 12/7/90  8:41 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 0625 Worksheet" S HD7="TESTIS, TRAUMA, OR DISEASE (GU)",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:"
 W ?13,"Loss of use of a testis when based upon its small size or soft",!?13,"consistency must be described by a board of at least three",!?13,"physicians including at least one urologist.  The board of",!
 W ?13,"physicians should review the physician's guide for special",!?13,"instructions.",!!
 I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:",!
 D:'$D(CMBN) HD2 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?8,"1. Atrophy or absence of one or both testis -",!!!!!?8,"2. Measurements -",!!!!!?8,"3. Consistency -",!!!!!
 W ?8,"4. Comparison -",!!!!!,$S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!!!!!
 I $Y>50 D HD2
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for "_NAME,!,HD8,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCULAP
DVBCULAP ;ALB/GTS-AMIE UNLINKED APPT REPORT ; 10/19/94  3:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
 ;** DVBCULAP run if 2507 Integrity Report Status parameter not OFF,
 ;**   ^TMP("DVBA",$J) global is defined, C&P Report Parameter is ON
 ;
 ;** Variable Descriptions
 ;** ^TMP("DVBA",$J,NAME,DFN) must be defined for vets to be reported
 ;**    prior to executing this routine.  Global KILLed by calling rtn
 ;** ^TMP("DVBC",$J,NAME,DFN) will be equal to:
 ;**    ^ exam date (ext) ^ date appt made ^ clerk ^ Appt Status (ext)
 ;
EN N TMPDA,STRTDT,PARAMDA,BEGDT,TODAYDT,SITE,LPCNT,SSN
 N DVBAPNAM,DVBADFN
 S SITE=$$SITE^DVBCUTL4
 S (DVBAPNAM,DVBADFN)=""
 S PARAMDA=0
 S PARAMDA=$O(^DVB(396.1,PARAMDA))
 D NOW^%DTC
 S Y=X X ^DD("DD") S TODAYDT=Y K Y
 ;
 ;**Only appts for date previous to report date by number of days in
 ;** AMIE Site Parameter File - Days to Keep 2507 History
 S X2=-(+$P(^DVB(396.1,PARAMDA,0),U,11)) S X1=X K X
 D C^%DTC
 S BEGDT=X-.0001,TMPDA=0 K X,X1,X2,STATUS,STATVAR
 ;
 ;**  Create ^TMP("DVBC",$J) global entry for C&P appt in date range
 F  S DVBAPNAM=$O(^TMP("DVBA",$J,DVBAPNAM)) Q:DVBAPNAM=""  DO
 .F  S DVBADFN=$O(^TMP("DVBA",$J,DVBAPNAM,DVBADFN)) Q:DVBADFN=""  DO
 ..S STRTDT=BEGDT
 ..F  S STRTDT=$O(^DPT(DVBADFN,"S",STRTDT)) Q:STRTDT=""  DO
 ...I $P(^DPT(DVBADFN,"S",STRTDT,0),U,16)=1 DO  ;**Appt is type C&P
 ....S TMPDA=TMPDA+1
 ....S DA=DVBADFN,DA(2.98)=STRTDT,DR="1900",DR(2.98)="19;20",DIC=2
 ....S DIQ="DVBAARY"
 ....K ^UTILITY("DIQ1",$J)
 ....D EN^DIQ1
 ....K ^UTILITY("DIQ1",$J)
 ....S Y=STRTDT X ^DD("DD")
 ....S OUTDT=Y
 ....S STATVAR=$$STATUS^SDAM1(DVBADFN,STRTDT,$P(^DPT(DVBADFN,"S",STRTDT,0),U,1),^DPT(DVBADFN,"S",STRTDT,0))
 ....S STATUS=$P(STATVAR,";",3)
 ....I DVBAARY(2.98,STRTDT,20)="" DO  ;**If info in Hosp Loc file (#44)
 .....K DA,DR,DIC,Y
 .....S DIC="^SC("_$P(^DPT(DVBADFN,"S",STRTDT,0),U,1)_",""S"","_STRTDT_",1,"
 .....S DIC(0)="MQ",X=DVBADFN
 .....D ^DIC S SCIEN=+Y
 .....K Y,DA,DR,DIC,DIQ,^UTILITY("DIQ1",$J)
 .....S DA=$P(^DPT(DVBADFN,"S",STRTDT,0),U,1),DIC="^SC("
 .....S DA(44.001)=STRTDT,DA(44.003)=SCIEN
 .....S DR="1900",DR(44.001)="2",DR(44.003)="7;8"
 .....S DIQ="DVBAARY"
 .....D EN^DIQ1
 .....K ^UTILITY("DIQ1",$J)
 .....S ^TMP("DVBC",$J,DVBAPNAM,DVBADFN,TMPDA)=OUTDT_"^"_$S($D(DVBAARY(44.003,SCIEN,7)):DVBAARY(44.003,SCIEN,8)_"^"_DVBAARY(44.003,SCIEN,7)_"^"_STATUS,'$D(DVBAARY(44.003,SCIEN,7)):"BAD Hospital Location record - Contact IRM")
 .....K SCIEN
 ....I DVBAARY(2.98,STRTDT,20)'="" DO  ;**If info in DPT "S" node
 .....S ^TMP("DVBC",$J,DVBAPNAM,DVBADFN,TMPDA)=OUTDT_"^"_DVBAARY(2.98,STRTDT,20)_"^"_DVBAARY(2.98,STRTDT,19)_"^"_STATUS
 ....K DVBAARY(2.98),Y,STATUS,STATVAR
 ..K DVBAARY(44.003)
 I '$D(DVBCQUIT) D:$D(^TMP("DVBC",$J)) RPTHD
 S (DVBADFN,DVBAPNAM,DVBANPGE)=""
 K DVBCOUT
 S:$D(DVBCQUIT) DVBCOUT=""
 F  S DVBAPNAM=$O(^TMP("DVBC",$J,DVBAPNAM)) Q:(DVBAPNAM=""!($D(DVBCOUT)))  DO
 .I $Y>(IOSL-13) DO
 ..I IOST?1"C-".E DO
 ...D PAUSE^DVBCUTL4
 ...S:+Y=0 DVBCOUT=""
 ..D:'$D(DVBCOUT) RPTHD
 ..S DVBANPGE=""
 .I '$D(DVBCOUT) DO
 ..S DVBADFN=""
 ..F  S DVBADFN=$O(^TMP("DVBC",$J,DVBAPNAM,DVBADFN)) Q:DVBADFN=""!($D(DVBCOUT))  DO
 ...I $Y>(IOSL-7) DO
 ....I IOST?1"C-".E DO
 .....D PAUSE^DVBCUTL4
 .....S:+Y=0 DVBCOUT=""
 ....D:'$D(DVBCOUT) RPTHD
 ....S DVBANPGE=""
 ...I '$D(DVBCOUT) DO
 ....S SSN=$P(^DPT(DVBADFN,0),U,9)
 ....K DVBCSSNO
 ....D SSNSHRT^DVBCUTIL
 ....D RPTSUBHD
 ....S TMPDA=""
 ....F  S TMPDA=$O(^TMP("DVBC",$J,DVBAPNAM,DVBADFN,TMPDA)) Q:TMPDA=""!($D(DVBCOUT))  DO
 .....I $Y>(IOSL-4) DO
 ......I IOST?1"C-".E DO
 .......D PAUSE^DVBCUTL4
 .......S:+Y=0 DVBCOUT=""
 ......S DVBANPGE=""
 ......D:'$D(DVBCOUT) RPTHD,RPTSUBHD
 .....I '$D(DVBCOUT) DO
 ......W !,$P(^TMP("DVBC",$J,DVBAPNAM,DVBADFN,TMPDA),U,1)
 ......W ?25,$P(^TMP("DVBC",$J,DVBAPNAM,DVBADFN,TMPDA),U,2)
 ......W ?50,$P(^TMP("DVBC",$J,DVBAPNAM,DVBADFN,TMPDA),U,3)
 I (IOST?1"C-".E),('$D(DVBCOUT)&($D(^TMP("DVBC",$J)))) D PAUSE^DVBCUTL4
 KILL ^TMP("DVBC",$J),DVBCSSNO,DVBCOUT,OUTDT,DVBANPGE,DVBAARY(44.003)
 Q
 ;
RPTHD ;
 W @IOF
 N DVBALN
 W !,?(80-$L(SITE)\2),SITE
 W !!,"AMIE appointment integrity report"
 W !,"Date: ",TODAYDT
 S $P(DVBALN,"-",80)=""
 W !,DVBALN
 Q
 ;
RPTSUBHD ;
 W:'$D(DVBANPGE) !!
 W !,"Veteran: ",DVBAPNAM,?50,"SSN: ",DVBCSSNO
 W !!,"Appt Date",?25,"Date Appt Made",?50,"Clerk"
 W !
 K DVBANPGE
 Q

DVBCUTA1
DVBCUTA1 ;ALB/GTS-AMIE C&P UTILITY ROUTINE A-1 ; 11/9/94  11:15 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
INSXM ;**Update Insuf exam info
 ;
 ;** Variable Descriptions
 ;    DVBAXMDA - 396.4 IEN - new Exam Rec
 ;    DVBAXMTP - 396.6 IEN - new exam
 ;    DVBAPROV - Provider on insufficiently completed exam
 ;    DVBAORXM - 396.4 IEN - insufficiently completed exam
 ;    DVBACMND - Local var containing Mumps code
 ;                X DVBACMND returns DVBAORXM
 ;    DVBCADEX - Indicates exam being added to 2507
 ;
 I '$D(OUT)&($P(^DVB(396.3,REQDA,0),"^",10)="E") DO
 .S TVAR(1,0)="0,0,0,2,0^Enter the following information for the "_EXMNM
 .S TVAR(2,0)="0,0,0,1:1,0^ exam being returned as insufficient."
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 .N DVBAXMDA,REASON
 .S DVBAXMDA=+Y
 .K DIC,Y,DA
 .S REASON=+$$INRSLK^DVBCUTA3
 .S:+REASON'>0 DTOUT=""
 .I +REASON>0 DO
 ..K DIE,Y,DA,DR
 ..S DIE="^DVB(396.4,",DR=".11////^S X=REASON;80;S:+$P(^DVB(396.3,REQDA,5),""^"",1)>0 Y="""";.12"
 ..S DA=DVBAXMDA S DIE("NO^")="" D ^DIE K DIE,DA,DR W !!
 .I '$D(DTOUT),(+$P(^DVB(396.3,REQDA,5),"^",1)>0) DO
 ..K DIE,Y,DR,DA ;**2507 Linked
 ..N DVBAXMTP,DVBAPROV,DVBAORXM,DVBACMND ;**S/W update Original Provider
 ..S DVBAXMTP=$P(^TMP($J,"NEW",EXMNM),U,1),DVBAORXM="",DVBAPROV=""
 ..S DVBACMND="S DVBAORXM=$O(^DVB(396.4,""ARQ"_DVBAINDA_""","_DVBAXMTP_",DVBAORXM))"
 ..N XREF S XREF="ARQ"_DVBAINDA
 ..I $D(^DVB(396.4,XREF,DVBAXMTP)) X DVBACMND ;**Return insuff exam IEN
 ..S:+DVBAORXM>0 DVBAPROV=$P(^DVB(396.4,DVBAORXM,0),U,7)
 ..I '$D(DVBCADEX)&(DVBAPROV="") DO
 ...S DVBAPROV="Unknown" ;**Bad 'ARQ' X-Ref
 ..K DVBADMNM
 ..I +DVBAORXM>0 DO
 ...I $D(^DVB(396.4,DVBAORXM,"TRAN")),(+$P(^DVB(396.4,DVBAORXM,"TRAN"),U,3)>0) DO
 ....S DVBADMNM=$P(^DIC(4.2,+$P(^DVB(396.4,DVBAORXM,"TRAN"),U,3),0),U,1)
 ....S DVBADMNM=$P(DVBADMNM,".",1)
 ..S:$D(DVBADMNM) DVBAPROV=DVBAPROV_" at "_DVBADMNM
 ..I $D(DVBCADEX)&(+DVBAORXM'>0) DO
 ...S DIR(0)="FAO^1:30"
 ...S DIR("A")="ORIGINAL PROVIDER: "
 ...S DIR("?",1)="Enter the Original Provider who performed the examination,"
 ...S DIR("?",2)="if the exam was performed on the original 2507 request."
 ...S DIR("?")="Include the facility name if the exam was performed at another site." D ^DIR S DVBAPROV=X K DIR,X,Y
 ..S DIE="^DVB(396.4,",DR=".12////^S X=DVBAPROV",DA=DVBAXMDA
 ..D ^DIE K DVBADMNM
 Q
 ;
RPTTYPE() ;** Report type - Detailed/Summary
 ;**RPTTYPE requires an entry.  Up-arrow exit allowed.
 ;**  All variables KILLed, EXCEPT DTOUT,DUOUT when user times
 ;**    or Up-Arrows out.  DTOUT,DUOUT KILLed by calling rtn.
 N TYPE
 S DIR(0)="SO^D:Detailed;S:Summary"
 S DIR("A",1)=" "
 S DIR("A")="Report Type"
 D ^DIR
 S TYPE=Y
 K X,Y,DIR
 Q TYPE
 ;
INSFTME(CURIEN) ;** Calc Insuff 2507 total process time
 ;** Variables
 ;**   CURIEN - 396.3 IEN for 2507 in process
 ;**   PROCTM - Processing time running total
 ;**   LPQUIT - Exit loop indicator
 ;
 N PROCTM,LPQUIT
 S PROCTM=+$$PROCDAY^DVBCUTL2(CURIEN)
 F  Q:$D(LPQUIT)  DO
 .S:'$D(^DVB(396.3,CURIEN,5)) LPQUIT=""
 .I $D(^DVB(396.3,CURIEN,5)) DO
 ..I +$P(^DVB(396.3,CURIEN,5),U,1)'>0 DO
 ...S PROCTM=PROCTM+$P(^DVB(396.3,CURIEN,5),U,2)
 ...S LPQUIT=""
 ..I +$P(^DVB(396.3,CURIEN,5),U,1)>0 DO
 ...S CURIEN=+$P(^DVB(396.3,CURIEN,5),U,1)
 ...S PROCTM=PROCTM+$$PROCDAY^DVBCUTL2(CURIEN)
 Q PROCTM
 ;
LINKDISP ;** Display Appt Links
 W @IOF
 N DVBAMORE
 W !,"Examination Appointment Links"
 W !!,"   Which Current Appt is "_$P(DVBAAPT,U,1)_" a reschedule of?",!
 W !,?4,"Initial Appt",?23,"Clock Stop Appt",?42,"Current Appt",?61,"Clinic"
 S ARYDA=""
 F ARYDA=1:1 Q:'$D(TMP("DVBC LINK",ARYDA))  DO
 .S SELDA=""
 .S SELDA=$O(TMP("DVBC LINK",ARYDA,SELDA))
 .W !,?1,ARYDA,?4,$P(TMP("DVBC LINK",ARYDA,SELDA),U,1)
 .W ?23,$P(TMP("DVBC LINK",ARYDA,SELDA),U,2),?42,$P(TMP("DVBC LINK",ARYDA,SELDA),U,3)
 .W ?61,$E($P(TMP("DVBC LINK",ARYDA,SELDA),U,4),1,18)
 .S DVBAMORE=$O(TMP("DVBC LINK",ARYDA))
 .I +DVBAMORE'>0 D SELLNK W !
 .I +DVBAMORE>0,(ARYDA#5=0) D SELLNK W !
 S SELDA=""
 I $D(Y) S SELDA=$O(TMP("DVBC LINK",Y,SELDA))
 K TMP("DVBC LINK")
 Q
 ;
SELLNK ;** Select link to modify
 W !
 S DIR("A",1)="ENTER '^' TO STOP OR"
 S DIR("A")="CHOOSE 1-"_ARYDA_": "
 S DIR(0)="NOA^1:"_ARYDA_"^I X["".""!('$D(TMP(""DVBC LINK"",+Y))) K X"
 S DIR("?",1)="Select a link by entering its associated number."
 S DIR("?",2)="  'Initial Appt' is the first appointment made to complete the exam."
 S DIR("?",3)="  'Clock Stop Appt' is the date the processing clock will be stopped for the"
 S DIR("?",4)="    series of linked appointments, if the veteran reschedules or no shows."
 S DIR("?",5)="  'Current Appt' is the appointment the link shows as currently scheduled"
 S DIR("?",6)="    to complete the examination."
 S DIR("?")="Select from the numbers listed."
 D ^DIR
 I $D(DTOUT)!($D(DUOUT)) S ARYDA=9999
 S:+Y>0 ARYDA=9999
 I +Y'>0 K Y
 K DIR,DTOUT,DUOUT
 Q

DVBCUTA2
DVBCUTA2 ;ALB/GTS-AMIE C&P UTILITY ROUTINE A-2 ; 2/8/95  11:15 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
INSUFXM ;** Insufficient exam information entry (Called from DVBCREDT)
 K DIR,Y
 N EXMNM,XMSTAT,XMDA,REQDA
 S REQDA=SAVEDA
 I $D(^DVB(396.3,REQDA,5)),NODE5=^DVB(396.3,REQDA,5) DO
 .W !
 .D XMQS
 .I +Y=1 DO
 ..K DIR,Y
 ..K DTOUT,DUOUT
 ..F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:(XMDA=""!($D(DTOUT)))  D XMUPDT
 .K DIR,Y
 I $D(^DVB(396.3,REQDA,5)),(NODE5'=^DVB(396.3,REQDA,5)) DO
 .D EXMEDIT
 .I $D(XMEDT) DO
 ..K DTOUT
 ..D SAVEXAM ;**Save exam info in case time out
 ..F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:(XMDA=""!($D(DTOUT)))  D XMUPDT
 ..I $D(DTOUT) D RESTLINK,RESTXAMS ;**Restore link and exam info
 .I '$D(XMEDT) DO  ;**Update original provider automatically
 ..F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:XMDA=""  D PROVUP
 K Y,^TMP($J,"NEW"),XMEDT,^TMP("DVBC",$J,396.4)
 Q
 ;
XMUPDT ;** Update exam insuf info
 W @IOF
 S EXMNM=$P(^DVB(396.6,$P(^DVB(396.4,XMDA,0),U,3),0),U,1)
 S ^TMP($J,"NEW",EXMNM)=$P(^DVB(396.4,XMDA,0),U,3)
 S XMSTAT=$P(^DVB(396.4,XMDA,0),U,4),Y=XMDA ;**Set var's for INSXM
 N DVBAINDA S DVBAINDA=$P(^DVB(396.3,REQDA,5),U,1)
 D:(XMSTAT'["X"&(XMSTAT'="T")) INSXM^DVBCUTA1 ;**Update exam info
 Q
 ;
PROVUP ;** Auto update original provider
 K DIE,Y,DR,DA
 N DVBAXMTP,DVBAPROV,DVBAORXM,DVBACMND,DVBAINDA
 S DVBAINDA=+$P(^DVB(396.3,REQDA,5),U,1)
 S DVBAXMTP=$P(^DVB(396.4,XMDA,0),U,3),DVBAORXM="",DVBAPROV=""
 S DVBACMND="S DVBAORXM=$O(^DVB(396.4,""ARQ"_DVBAINDA_""","_DVBAXMTP_",DVBAORXM))"
 N XREF S XREF="ARQ"_DVBAINDA
 I $D(^DVB(396.4,XREF,DVBAXMTP)) X DVBACMND ;**Return insuff exam IEN
 S:+DVBAORXM>0 DVBAPROV=$P(^DVB(396.4,DVBAORXM,0),U,7)
 I DVBAPROV="" DO
 .S DVBAPROV="Unknown" ;**Bad 'ARQ' X-Ref
 K DVBADMNM
 I +DVBAORXM>0,($D(^DVB(396.4,DVBAORXM,"TRAN"))) DO
 .S DVBADMNM=$P(^DIC(4.2,+$P(^DVB(396.4,DVBAORXM,"TRAN"),U,3),0),U,1)
 .S DVBADMNM=$P(DVBADMNM,".",1)
 S:$D(DVBADMNM) DVBAPROV=DVBAPROV_" at "_DVBADMNM
 S DIE="^DVB(396.4,",DR=".12////^S X=DVBAPROV",DA=XMDA
 D ^DIE K DIE,DR,DA
 Q
 ;
RESTLINK ;** Restore 2507 link info (Called from ^DVBCREDT & INSUFXM)
 N LINKDA,DAYS
 S LINKDA=$P(NODE5,U,1)
 S DAYS=$P(NODE5,U,2)
 S:LINKDA="" LINKDA="@"
 S:DAYS="" DAYS="@"
 K DA,DR,DIE
 S DIE="^DVB(396.3,"
 S DA=REQDA,DR="44////^S X=LINKDA;45////^S X=DAYS"
 D ^DIE
 K DA,DR,DIE
 S TVAR(1,0)="1,3,0,2:1,0^All exams must be reviewed....Insufficient link and info not updated!"
 D WR^DVBAUTL4("TVAR")
 K TVAR
 D CONTMES^DVBCUTL4
 Q
 ;
EXMEDIT ;** Ask user to edit exams
 I '$D(UPDT2507)!((+$P(^DVB(396.3,REQDA,5),U,1)>0)&($D(UPDT2507))) DO
 .D XMQS
 .S:+Y=1 XMEDT=""
 I (+$P(^DVB(396.3,REQDA,5),U,1)'>0)&($D(UPDT2507)) DO
 .S TVAR(1,0)="1,3,0,2:1,0^Review exam info for a new Original Provider."
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 .S XMEDT=""
 .D CONTMES^DVBCUTL4
 Q
 ;
XMQS ;** Edit exams?
 S DIR(0)="Y^AO",DIR("A")="Do you want to edit the insufficient information for the exams"
 S DIR("?",1)="Enter Yes to edit Remarks, Insufficient Reason and Original Providor (when"
 S DIR("?")=" appropriate).  Enter No to keep the current information."
 S DIR("B")="NO" D ^DIR
 Q
 ;
SAVEXAM ;** Save exam info prior to edit
 N REMDA,XMDA
 F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:XMDA=""  DO
 .S ^TMP("DVBC",$J,396.4,XMDA,0)=$P(^DVB(396.4,XMDA,0),U,11)_"^"_$P(^DVB(396.4,XMDA,0),U,12)
 .F REMDA=0:0 S REMDA=$O(^DVB(396.4,XMDA,"INREM",REMDA)) Q:REMDA=""  DO
 ..S ^TMP("DVBC",$J,396.4,XMDA,"INREM",REMDA,0)=^DVB(396.4,XMDA,"INREM",REMDA,0)
 Q
 ;
RESTXAMS ;** Restore exam information  (Called from INSUFXM)
 N REMDA,XMDA,REASDA,PROV,REMARK,LNCNT,XMSTAT
 F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:XMDA=""  DO
 .S XMSTAT=$P(^DVB(396.4,XMDA,0),U,4)
 .I (XMSTAT'["X")&(XMSTAT'["T") DO
 ..S REASDA=$P(^TMP("DVBC",$J,396.4,XMDA,0),U,1)
 ..S PROV=$P(^TMP("DVBC",$J,396.4,XMDA,0),U,2)
 ..K DIE,DR,DA
 ..S DIE="^DVB(396.4,",DR=".11////^S X=REASDA;.12////^S X=PROV;80////@",DA=XMDA
 ..D ^DIE
 ..S LNCNT=0
 ..S:'$D(^DVB(396.4,XMDA,"INREM",0)) ^DVB(396.4,XMDA,"INREM",0)="^^0^0^"_DT_"^"
 ..F REMDA=0:0 S REMDA=$O(^TMP("DVBC",$J,396.4,XMDA,"INREM",REMDA)) Q:REMDA=""  DO
 ...S REMARK=^TMP("DVBC",$J,396.4,XMDA,"INREM",REMDA,0)
 ...S LNCNT=LNCNT+1
 ...S ^DVB(396.4,XMDA,"INREM",REMDA,0)=REMARK
 ..S ^DVB(396.4,XMDA,"INREM",0)="^^"_LNCNT_"^"_LNCNT_"^"_DT_"^"
 Q

DVBCUTA3
DVBCUTA3 ;ALB/GTS-AMIE C&P UTILITY ROUTINE A-3 ; 2/10/95  11:15 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
INRSLK() ;** Lookup insufficient reason
 N REASVAR,DVBAOUT,REASIN
 S REASVAR=-1,REASIN=""
 K DTOUT,DUOUT
 F  Q:($D(DTOUT)!(+REASVAR>0)!($D(DVBAOUT)))  DO
 .I '$D(DVBAXMDA) DO
 ..R !,"INSUFFICIENT REASON: ",REASIN:DTIME
 ..S:'$T DVBAOUT=""
 .I $D(DVBAXMDA),(+DVBAXMDA'>0) DO
 ..R !,"INSUFFICIENT REASON: ",REASIN:DTIME
 ..S:'$T DVBAOUT=""
 .I $D(DVBAXMDA),(+DVBAXMDA>0&(+$P(^DVB(396.4,DVBAXMDA,0),U,11)'>0)) DO
 ..R !,"INSUFFICIENT REASON: ",REASIN:DTIME
 ..S:'$T DVBAOUT=""
 .I $D(DVBAXMDA),(+DVBAXMDA>0&(+$P(^DVB(396.4,DVBAXMDA,0),U,11)>0)) DO
 ..W !,"INSUFFICIENT REASON: "
 ..S:'$T DVBAOUT=""
 ..I +$P(^DVB(396.4,DVBAXMDA,0),U,11)>0 DO
 ...W $P(^DVB(396.94,$P(^DVB(396.4,DVBAXMDA,0),U,11),0),U,1)_"//"
 ..R REASIN:DTIME
 ..S:'$T DVBAOUT=""
 ..I '$D(DVBAOUT),(REASIN="") S REASIN=$P(^DVB(396.94,$P(^DVB(396.4,DVBAXMDA,0),U,11),0),U,1)
 .I REASIN="^" DO
 ..S TVAR(1,0)="0,0,0,0,0^NOT ALLOWED"
 ..D WR^DVBAUTL4("TVAR")
 ..K TVAR
 .I '$D(DVBAOUT),(REASIN="") S REASIN="^"
 .I REASIN="^" DO
 ..S TVAR(1,0)="0,0,0,0,0^??"
 ..S TVAR(2,0)="0,5,0,1,0^Enter the insufficient reason this exam is being returned."
 ..S TVAR(3,0)="0,1,0,1,0^ANSWER WITH 2507 INSUFFICIENT REASONS INSUFFICIENT CODE"
 ..D WR^DVBAUTL4("TVAR")
 ..K TVAR
 .I REASIN="?" DO
 ..K DIR S DIR(0)="YAO"
 ..S DIR("A",1)="     Enter the insufficient reason this exam is being returned. "
 ..S DIR("A",2)=" ANSWER WITH 2507 INSUFFICIENT REASONS INSUFFICIENT CODE"
 ..S DIR("A")=" DO YOU WANT THE ENTIRE 13-ENTRY 2507 INSUFFICIENT REASONS LIST? "
 ..D ^DIR
 ..D:+Y=1 RESHELP
 ..K Y,DIR
 .I REASIN["??" DO
 ..S TVAR(1,0)="0,0,0,1,0^This field contains a pointer to the Insufficient Reason file (396.94)."
 ..D WR^DVBAUTL4("TVAR")
 ..K TVAR
 ..D RESHELP
 .I REASIN'="^",(REASIN'["?") DO
 ..S DIC="^DVB(396.94,",X=REASIN,DIC(0)="MQE"
 ..D ^DIC
 ..S REASVAR=Y
 ..K DIC,X,Y
 S:($D(DTOUT)!($D(DVBAOUT))) REASVAR=-1
 Q REASVAR
 ;
RESHELP ;** Help for insufficient reasons
 N LPVAR
 S TVAR(1,0)="0,0,0,2,0^CHOOSE FROM:"
 D WR^DVBAUTL4("TVAR")
 K TVAR
 F LPVAR=0:0  S LPVAR=$O(^DVB(396.94,LPVAR)) Q:+LPVAR=0  DO
 .S TVAR(1,0)="0,3:0,0,1,0^"_$P(^DVB(396.94,LPVAR,0),U,1)
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 W !
 Q
 ;
LNKLIST ;** List links for user
 I '$D(TMP("DVBC LINK")) DO
 .S TVAR(1,0)="0,0,0,1,0^There are no links to this 2507 request."
 .D WR^DVBAUTL4("TVAR")
 .K TVAR
 .D CONTMES^DVBCUTL4
 I $D(TMP("DVBC LINK")) DO
 .N DVBAMORE
 .W !,?2,"Current Appointment Links",!
 .W !,?1,"Initial Appt",?21,"Clock Stop Appt",?41,"Current Appt",?61,"Clinic"
 .S ARYDA=""
 .N GETOUT
 .F ARYDA=1:1 Q:('$D(TMP("DVBC LINK",ARYDA))!($D(GETOUT)))  DO
 ..S SELDA=""
 ..S SELDA=$O(TMP("DVBC LINK",ARYDA,SELDA))
 ..W !,?1,$P(TMP("DVBC LINK",ARYDA,SELDA),U,1)
 ..W ?21,$P(TMP("DVBC LINK",ARYDA,SELDA),U,2),?41,$P(TMP("DVBC LINK",ARYDA,SELDA),U,3)
 ..W ?61,$E($P(TMP("DVBC LINK",ARYDA,SELDA),U,4),1,18)
 ..S DVBAMORE=$O(TMP("DVBC LINK",ARYDA))
 ..I (+DVBAMORE'>0)!(+DVBAMORE>0&(ARYDA#5=0)) DO
 ...K DIR
 ...S DIR(0)="F,O^^",DIR("A")="Enter [Return] to continue or ""^"" to exit"
 ...K GETOUT D ^DIR S:$D(DTOUT)!($D(DUOUT)) GETOUT=1
 ...I '$D(GETOUT) W ! K DIR,DIRUT,X
 .K TMP("DVBC LINK"),ARYDA,SELDA,DIR,X
 Q
 ;
LNKARY(REQDA,DVBADFN) ;** Set up the link array (In TMP local)
 N LKDA,ARYDA
 S LKDA="",ARYDA=0
 F  S LKDA=$O(^DVB(396.95,"AR",REQDA,LKDA)) Q:+LKDA=0  DO
 .S ARYDA=ARYDA+1
 .S Y=$P(^DVB(396.95,LKDA,0),U,1) X ^DD("DD")
 .S TMP("DVBC LINK",ARYDA,LKDA)=Y K Y
 .S Y=$P(^DVB(396.95,LKDA,0),U,2) X ^DD("DD")
 .S TMP("DVBC LINK",ARYDA,LKDA)=TMP("DVBC LINK",ARYDA,LKDA)_"^"_Y K Y
 .S Y=$P(^DVB(396.95,LKDA,0),U,3) X ^DD("DD")
 .S TMP("DVBC LINK",ARYDA,LKDA)=TMP("DVBC LINK",ARYDA,LKDA)_"^"_Y K Y
 .S DA=DVBADFN,DA(2.98)=$P(^DVB(396.95,LKDA,0),U,3),DR="1900",DR(2.98)=".01",DIC=2
 .S DIQ="DVBACLIN" K ^UTILITY("DIQ",$J)
 .D EN^DIQ1 K ^UTILITY("DIQ",$J)
 .S TMP("DVBC LINK",ARYDA,LKDA)=TMP("DVBC LINK",ARYDA,LKDA)_"^"_DVBACLIN(2.98,$P(^DVB(396.95,LKDA,0),U,3),.01)
 .K DVBACLIN
 Q

DVBCUTA4
DVBCUTA4 ;ALB/GTS-AMIE C&P UTILITY ROUTINE A-4 ; 2/13/95  11:30 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
REFRSH(TMPDA) ;** Refresh the screen with the current appt's
 W @IOF
 N LPDA
 W !!!,"Select an appointment to link to the 2507 request",!
 W !,?1,"1",?4,"Display Current C&P Appointment Links"
 F LPDA=2:1:TMPDA Q:'$D(^TMP("DVBC",$J,LPDA))  DO
 .W !,?1,LPDA,?4,$P(^TMP("DVBC",$J,LPDA),U,1)
 .W ?23,$E($P(^TMP("DVBC",$J,LPDA),U,2),1,22)
 .W:$D(^DVB(396.95,"AB",REQDA,$P(^TMP("DVBC",$J,LPDA),U,4))) ?47,"*CL"
 .W ?51,$E($P(^TMP("DVBC",$J,LPDA),U,3),1,27)
 Q
 ;
ENHNC() ;**Return event drvr dialogue mode
 N ENHCMODE,PARAMDA
 S PARAMDA=0
 S PARAMDA=$O(^DVB(396.1,PARAMDA))
 S ENHCMODE=$P(^DVB(396.1,PARAMDA,0),U,18)
 Q ENHCMODE
 ;
EXAMLST(EXAMDA,EXAMSTAT) ;** Output exam
 I $Y>(IOSL-5) DO
 .S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue."
 .S DIR("A",1)=" " D ^DIR K DIR,X,Y
 .D:'$D(DTOUT)&('$D(DUOUT)) EXMHD^DVBCUTL6
 I '$D(DTOUT),('$D(DUOUT)) DO
 .S:EXAMSTAT="C" EXAMSTAT="Completed"
 .S:EXAMSTAT="O" EXAMSTAT="Open"
 .S:EXAMSTAT="X" EXAMSTAT="Canceled by MAS"
 .S:EXAMSTAT="RX" EXAMSTAT="Canceled by RO"
 .S:EXAMSTAT="T" EXAMSTAT="Transferred Out"
 .W !,?1,$P(^DVB(396.6,$P(^DVB(396.4,EXAMDA,0),U,3),0),U,2),?41,EXAMSTAT
 Q
 ;
TRANCHK(REQDA) ;**Check for 2507 completly x-fered
 N TRANVAL,XFRD
 S TRANVAL=0
 I $D(^DVB(396.3,REQDA,4)),($P(^DVB(396.3,REQDA,4),U,1)="y") DO
 .S XFRD=""
 .N XMDA
 .F XMDA=0:0 S XMDA=$O(^DVB(396.4,"C",REQDA,XMDA)) Q:(XMDA=""!'$D(XFRD))  DO
 ..I $P(^DVB(396.4,XMDA,0),U,4)'="T" K XFRD
 S:$D(XFRD) TRANVAL=1
 Q TRANVAL

DVBCUTIL
DVBCUTIL ;ALB/GTS-557/THM;C&P UTILITY ROUTINE ; 4/26/91  11:16 AM
 ;;2.7;AMIE;;Apr 10, 1995
KILL ;common exit
 D ^%ZISC I $D(FF),'$D(ZTQUEUED) W @FF,!!
 K %DT,ADR1,ADR2,ADR3,BDTRQ,BUSPHON,CITY,CNDCT,CNUM,DFN,DIW,DIWF,DIWL,DIWR,DIWT,DN,DOB,DTA,DTRQ,DX,DXCOD,DXNUM,EDTRQ,HOMPHON,I,LINE,MDTRM,NAME,OTHDIS,PCT,PG,PGHD,POP,PRINT,REQN,RO,ROHD,RONAME,RQ,SC,D,DIE,ONE,DVBCNEW,LN,FEXM,PRIO,DTB
 K SEX,SSN,STATE,TST,X,Y,Z,JI,JII,ZIP,JJ,KJX,D0,D1,DA,DI,DIC,DIPGM,DLAYGO,DQ,DWLW,HD,HD1,HD2,J,ONFILE,CTIM,JJ,C,DIZ,DPTSZ,STAT,JDT,JY,TSTDT,DIYS,EXAM,DR,REQDT,ELIG,INCMP,PRDSV,WARD,ADD1,ADD2,CNTY,PG,OLDDA,DIRUT,DUOUT
 K DVBCCNT,TNAM,DIR,TEMP,SWITCH,EDTA,RAD,EOD,%T,STATUS,XX,XDD,OLDA,OLDA1
 K DTTRNSC,ZIP4,DVBAINSF
 G KILL^DVBCUTL2
 ;
DICW ;used on ^DIC lookups only
 W ! S TSTDT=$P(^(0),U,2),RO=$P(^(0),U,3),STAT=$P(^(0),U,18),RONAME=$S($D(^DIC(4,+RO,0)):$P(^(0),U,1),1:"Unknown RO") D DICW1
 W ! Q
 ;
DICW1 F JY=0:0 S JY=$O(^DVB(396.4,"C",+Y,JY)) Q:JY=""  S EXAM=$P(^DVB(396.4,+JY,0),U,3),EXAM=$S($D(^DVB(396.6,EXAM,0)):$P(^(0),U,1),1:"Unknown exam") D DICW2
 Q
 ;
DICW2 W ?3,EXAM," (",$E(TSTDT,4,5)_"/"_$E(TSTDT,6,7)_"/"_$E(TSTDT,2,3)," by ",RONAME,")",!
 Q
 ;
VARS S DTA=^DVB(396.3,DA,0),DFN=$P(DTA,U,1),(NAME,PNAM)=$P(^DPT(DFN,0),U,1),DOB=$P(^(0),U,3),SEX=$P(^(0),U,2),SSN=$P(^(0),U,9),CNUM=$S($D(^DPT(DFN,.31)):$P(^(.31),U,3),1:"Unknown"),DTRQ=$P(DTA,U,2)
 S RO=$P(DTA,U,3),FEXM=$P(DTA,U,9) S:RO="" RO=0 S RONAME=$S($D(^DIC(4,RO,0)):$P(^(0),U,1),1:"Unknown")
 S REQN=$P(DTA,U,4),REQN=$S($D(^VA(200,+REQN,0)):$P(^(0),U,1),1:"Unknown"),OTHDIS=$P(DTA,U,11) I $D(^DVB(396.3,DA,1)) S OTHDIS1=$P(^(1),U,9),OTHDIS2=$P(^(1),U,10)
 S ZPR=$P(DTA,U,10),PRIO=$S(ZPR="T":"Terminal",ZPR="P":"Prisoner of war",ZPR="OS":"Original SC",ZPR="ON":"Original NSC",ZPR="I":"Increase",ZPR="R":"Review",ZPR="OTR":"Other",ZPR="E":"Inadequate exam",1:"Unknown")
 K DVBAINSF S:ZPR="E" DVBAINSF=""
 S (ADR1,ADR2,ADR3,CITY,STATE,ZIP)=""
 I $D(^DPT(DFN,.11)) S DTA=^DPT(DFN,.11),ADR1=$P(DTA,U,1),ADR2=$P(DTA,U,2),ADR3=$P(DTA,U,3),CITY=$P(DTA,U,4),ZIP=$P(DTA,U,12) S:ZIP'="" ZIP=$S($L(ZIP)>5:$E(ZIP,1,5)_"-"_$E(ZIP,6,9),1:ZIP) I ZIP="" S ZIP="No Zip"
 S CITY=$S(CITY]"":CITY,1:"Unknown") S STATE=$P(DTA,U,5) I STATE]"" S STATE=$S($D(^DIC(5,STATE,0)):$P(^(0),U,1),1:"Unknown")
 S (HOMPHON,BUSPHON)="Unknown" I $D(^DPT(DFN,.13)) S HOMPHON=$P(^(.13),U,1),BUSPHON=$P(^(.13),U,2)
 S EDTA=$S($D(^DPT(DFN,.32)):^(.32),1:""),EOD=$P(EDTA,U,6),RAD=$P(EDTA,U,7),Y=$S($D(^DVB(396.3,DA,1)):$P(^(1),U,7),1:"") X ^DD("DD") S LREXMDT=Y
 Q
 ;
HDR W @FF,?(IOM-$L(HD2)\2),HD2,!!!?5,"Veteran name: ",PNAM,?45,"SSN: ",SSN,!?40,"C-NUMBER: ",CNUM,!!,"Exams on this request:",!!
 S JII=""
 F JIJ=0:0 S JII=$O(^TMP($J,JII)) Q:JII=""  S XST=$P(^TMP($J,JII),U,1) W JII,", ",$S(XST="C":"Completed",XST="RX":"Cancelled by RO",XST="X":"Cancelled by MAS",XST="T":"Transferred",1:"Open"),", " I $X>30 W !
 Q
 ;
ADDR S (ADD1,ADD2,CITY,CNTY,STATE,ZIP)=""
 I $D(^DPT(DFN,.11)) S DTA=^(.11),ADD1=$P(DTA,U,1),ADD2=$P(DTA,U,2),CITY=$P(DTA,U,4),STATE=$P(DTA,U,5),ZIP=$P(DTA,U,12),CNTY=$P(DTA,U,7)
 S:ZIP'="" ZIP=$S($L(ZIP)>5:$E(ZIP,1,5)_"-"_$E(ZIP,6,9),1:ZIP)
 S CNTY=$S($D(^DIC(5,+STATE,1,+CNTY,0)):$P(^(0),U,1),1:"Unknown")
 S STATE=$S($D(^DIC(5,+STATE,0)):$P(^(0),U,1),1:"Unknown")
 W !!?0,"Address: ",?9,ADD1,! W:ADD2]"" ?9,ADD2,! W ?0,"City:",?9,CITY,"  ",STATE,"  ",ZIP,!?0,"County:",?9,CNTY,!!
 S PRDSV=$S($D(^DPT(DFN,.32)):$P(^(.32),U,3),1:"") I PRDSV]"" S PRDSV=$P(^DIC(21,PRDSV,0),U,1)
 W "Period of service: ",PRDSV,!
 S ELIG="",INCMP=0
 W ?0,"Eligibility data:" I $D(^DPT(DFN,.36)),$P(^(.36),U,1)]"" S ELIG=$S($D(^DIC(8,+^(.36),0)):$P(^(0),U,6),1:"")
 I ELIG]"",$D(^DPT(DFN,.361)),^(.361)]"" S ELIG=ELIG_" ("_$S($P(^(.361),U,1)="P":"Pend ver",$P(^(.361),U,1)="R":"Pend re-verif",$P(^(.361),U,1)="V":"Verified",1:"Not verified")_")"
 I $D(^DPT(DFN,.29)),$P(^(.29),U,1)]"" S INCMP=1
 I $D(^DPT(DA,.293)),$P(^(.293),U,1)=1 S INCMP=1
 W ?19,ELIG_$S(ELIG]"":", ",1:"")_$S(INCMP=1:"Incompetent",1:""),!
 Q
 ;
SSNSHRT ;  ** Set SSN in the Format '***********' **
 K DVBCSSNO
 S DVBCSSNO=$E(SSN,1,3)_" "_$E(SSN,4,5)_" "_$E(SSN,6,9)
 Q
 ;
SSNOUT ;  ** Set SSN in the Format '*********** (Z6789) **
 D SSNSHRT
 S DVBCSSNO=DVBCSSNO_" ("_$E(PNAM)_$E(SSN,6,9)_")"
 Q

DVBCUTL2
DVBCUTL2 ;ALB/GTS-557/THM-DVBCUTIL, CONTINUED ; 3/4/91  12:54 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
KILL K %ZIS,BY,COLUMN,DVBCDT(0),EXAM,EXAMNM,HIST,FF,LABEL,LEVEL,LOC,MA,MB,NFINAL,NODE,OLDEXAM,OUT,PDATE,PDTA,PIECE,REAS,STAT1,TYPE,X1,X2,XDR,XST,JIJ,ZTDESC,ZTIO,ZTRTN,ZTSAVE,ZTSK,ZW,JJY,VX,ADIV,ADIVNUM,DVBCDD,EDAYS,HEAD,HEAD2,ULINE,IO("Q")
 K EXHD,XMTEXT,ZTDTH,OUT,CANC,DOTS,L,MG,REASON,SEND,XEXAM,XMDUZ,XMSUB,XMY,%X,%Y,JFLD,JX,JDR,DTREL,DTREQ,DTRQCMP,DTSCHEDC,DTTRANS,EDATE,ER,EXDATE,EXSTAT,RQSTAT,SBULL,TOT,XDT,XMDISPI,XMKK,XMLOC,XMLOCK,XMQF,XMR,XMT,XMTYP,XMZ,%H,K,NODATA,PNAM
 K ANS,BDATE,PROCDT,QQ,RDATE,REQSTR,SADIV,OLDY,RQDT,RQDT2,PGM,SDATE,SDATE1,SDATE2,EDATE,EDATE1,EDATE2,CMPDIV,BY1,DAYS,FAX,PRTDIV,XMMG,ADEQ,EXMNM,PRTDATE,RUNDATE,RPTSITE,FEXAM,XSTAT,JZ,ZPR,REQDA,DVBCDT,FDT,RN,XIX,DVBCZ,EXDT,AGE
 K COMP,DTOUT,DTSCH,DTSCH2,LNE,PG,PHYS,EXDA,DVBCDIV,%W,PRTNM,DIVNM,AW,AX,AY,BDATE1,CANDT,COL,DVBCJ,DVBCSEQ,DVBCSITE,ELTYP,EXPTR,EXSTAT,HD3,HEAD3,JJZ,JK,LVL,LX,NAME,OLDDA1,ORVP,PG,PRBY,RELBY,SEQNUM,TOTAL,TXT,TYP,DVBCXJI,PNM,PREF,NARR
 G KILL^DVBCUTL3
 ;
DDIS1 ;display rated disabilities
 W ?2,DX,?37,$J(PCT,3,0)," %",?50,$S(SC=1:"Yes",1:"No"),?58,DXCOD,!
 Q
 ;
DDIS I '$D(^DPT(DFN,.372)) W !!,"No rated disabilities on file",!! Q
 W !?2,"Rated Disability",?37,"Percent",?50,"SC ?",?58,"Dx Code",! W ?2 F LINE=1:1:63 W "-"
 W !! F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:I=""  S DXNUM=$P(^DPT(DFN,.372,I,0),U,1),PCT=$P(^(0),U,2),SC=$P(^(0),U,3),DX=$S($D(^DIC(31,DXNUM)):$P(^(DXNUM,0),U,1),1:"Unknown"),DXCOD=$S($D(^DIC(31,DXNUM)):$P(^(DXNUM,0),U,3),1:"Unknown") D DDIS1
 W !! Q
 ;
HDR2 W @IOF,!,"C&P Final Report",?71,"Page: ",PG,!!,"Name: ",PNAM,?38,"SSN: ",SSN,?60,"C-number: ",CNUM,!,EXHD,!
 F ZI=1:1:80 W "="
 W !
 Q
 ;
HDR3 W @IOF,!,"C&P Reprint of Final Report",?71,"Page: ",PG,!!,"Name: ",PNAM,?38,"SSN: ",SSN,?60,"C-number: ",CNUM,!,EXHD,!
 F ZI=1:1:80 W "="
 W !
 Q
 ;
DUZ2 ;select station number
 S DVBCD2=$S($D(^DIC(4,DUZ(2),99)):$P(^(99),U,1),1:0)
 Q
 ;
TST W ?3
 F DA=0:0 S DA=$O(^DVB(396.4,"C",DA(1),DA)) Q:DA=""  K PRINT S TSTAT=$P(^DVB(396.4,DA,0),U,4),TST=$P(^DVB(396.4,DA,0),U,3),PRTNM=$S($D(^DVB(396.6,TST,0)):$P(^(0),U,2),1:"") D TST1
 Q
TST1 S TSTA1=""
 I $D(^DVB(396.4,DA,"CAN")) S TSTA1=$P(^DVB(396.4,DA,"CAN"),U,3)
 I $D(^DVB(396.4,DA,"TRAN")) S X=$P(^DVB(396.4,DA,"TRAN"),U,3)
 S:TSTA1]"" TSTA1=$P(^DVB(396.5,TSTA1,0),U,1) ;tsta1=cancellation reason
 W:($L(PRTNM)+$L(TSTA1)+$X)>55 !?3 W $S(PRTNM]"":PRTNM,1:"Missing exam name")_$S(TSTA1]"":" - cancelled ("_TSTA1_")",TSTAT="T":" - Transferred",TSTAT="":" (Unknown status)",1:"")
 I TSTAT="T" S X=$S($D(^DIC(4.2,+X,0)):$P(^(0),U,1),1:"unknown site") W " to ",$P(X,".",1)
 W "; "
 Q
 ;
RQCODE ; ** Cancel an entire 2507 request after cancellation of last exam **
 N LASTTME
 S LASTTME=$O(^TMP("DVBA",$J,""))
 S CCODE=^TMP("DVBA",$J,LASTTME)
 D BULL^DVBCCNC1
 Q
 ;
PROCDAY(REQDA) ; ** Calculate processing time for REQDA (v2.7 - Enhc 13)
 ;** NOTICE: This tag is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;**  PROCDAY receives the variable REQDA as the IEN of the 2507
 ;**   request to calculate the processing time for
 ;**  Processing time returned to calling routine via PROCTME
 ;
 N STOPDT,STARTDT,LSORVTRS,PRESTRT,DAY30CUT,PROCTME,ADJTME
 N LPDT,LPDA,FSDTVTRS,LINKNODE
 S (STOPDT,STARTDT,LSORVTRS,PRESTRT,FSDTVTRS)=0
 ;
 ;** FSDTVTRS is earliest date on 396.95 rec of
 ;**  Current and Vet Resch dates
 ;** Find FSDTVTRS for each 396.95 rec, PRESTRT is latest FSDTVTRS of
 ;**  all 396.95 recs for request
 S LPDT=""
 F  S LPDT=$O(^DVB(396.95,"ARO",REQDA,LPDT)) Q:LPDT=""  DO
 .F LPDA=0:0 S LPDA=$O(^DVB(396.95,"ARO",REQDA,LPDT,LPDA)) Q:LPDA=""  DO
 ..S STOPDT=LPDT ;**Find the last original appt date (equals Stop Date)
 ..S LINKNODE=^DVB(396.95,LPDA,0)
 ..I +$P(LINKNODE,U,4)=1 DO  ;**FSDTVTRS=earliest of fields .03 and .05
 ...S LSORVTRS=$P(LINKNODE,U,2) ;**'ARO' - Original; Vet rsch date latest
 ...I $P(LINKNODE,U,3)<$P(LINKNODE,U,5) S FSDTVTRS=$P(LINKNODE,U,3)
 ...I $P(LINKNODE,U,3)'<$P(LINKNODE,U,5) S FSDTVTRS=$P(LINKNODE,U,5)
 ...S:FSDTVTRS>PRESTRT PRESTRT=FSDTVTRS ;**PRESTRT=latest FSDTVTRS
 ;
 ;** Calculate the Start Date
 S PRESTRT=PRESTRT\1
 S LSORVTRS=LSORVTRS\1
 S STOPDT=STOPDT\1
 S X1=LSORVTRS S X2=30 D C^%DTC S DAY30CUT=X K X,X1,X2 ;**30 day cut off
 ;
 ;** Find clock start date
 ;** (Start can't be >30 days from latest original date on an
 ;     appt reschd by vet)
 S:DAY30CUT<PRESTRT STARTDT=DAY30CUT
 S:DAY30CUT'<PRESTRT STARTDT=PRESTRT
 S:STARTDT>$P(^DVB(396.3,REQDA,0),U,14)\1 STARTDT=$P(^DVB(396.3,REQDA,0),U,14)\1
 S X1=STARTDT,X2=STOPDT D ^%DTC S ADJTME=X K X,X1,X2 ;**Days to subtract
 S X2=($P(^DVB(396.3,REQDA,0),U,5)\1)
 S X1=($P(^DVB(396.3,REQDA,0),U,14)\1)
 D ^%DTC S PROCTME=X S:+ADJTME>0 PROCTME=PROCTME-ADJTME
 K X,X1,X2
 Q PROCTME

DVBCUTL3
DVBCUTL3 ;ALB/GTS-557/THM-DVBCUTL2, CONTINUED ; 5/17/91  11:35 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
KILL I $D(LKILL) K LKILL D LKILL
 K C0,DVBCLTR,DVBCNOW,DVBCSORT,LI,LREXMDT,LV,PGRN,ROUT,RT,TSTAT,XMB,XT,EXNAME,OTHDIS1,OTHDIS2,PG,REQRO,RSTAT,TIME,ZI,ZZI,DAYEX,DINUM,DTCAN,ERDAYS,EXMDA,FB,OLDAYS,^TMP("DVBC",$J),^TMP("DVBCLAB",$J),DVBCBDT,DVBCLOC,DVBCN,DVBCRLOC
 K HD4,RONUM,TPRT,DG,LRPARAM,RARPT,SUPER,^TMP($J),^TMP("DVBC","BULL",$J),EXCNT,RTYPE,XD,XLINE,ZC,LY,LZ,MX,MY,WKSNUM,HD7,HD8,HD9,LN1,LN2,DXCMT,CANBY,CANDT,CANREM,CFLOC,CFREQ,CMBN,DVBCI,ELIGCOD,ELIGSDT,ELIGST,DVBCD2
 K EXM,EXMDT,EXMPL,EXPHYS,FREAS,HD5,HD6,HD7,HD8,HD9,LNH,NREQDA,OLREQDA,OTHDOC,OWNER,PDSRV,PFAX,POWSTAT,SITE,SITE1,SRVCON,SRVEDT,SRVPCT,SRVSDT,SUB,TIME,TOT,USER,USERNM,USR,VETST,WRKSHT,XFERDT,XFERSITE,XMER,XMREC,XMRG,ZJ,ZK
 K HD91,CNUM,DFN,DX,DXCOD,DXNUM,I,LINE,DVBCRALC,PCT,SC,SSN,CANCBY,CANCDT,CANCREM,DATRETN,EXST,FA,OWNDOM,REMK,TSTA1,XMFG,YY,ZG,ZH,DVBCAO,XCN,MANUAL
 K DVBCTYPE,HD7,HD8,HD9,HD91,RDATE1,TPRT,XJ,RONAM,PNAM,^TMP($J)
 Q
 ;
LKILL K LRO,LR0,LRAA,LRAAO,LRCDT,LRCMNT,LRNIDT,LRCW,LRDATA,LRDFN,LRDN,LRDOC,LRDPF,LREDT,LREND,LRFFLG,LRFOOT,LRHF,LRHI,LRIDT,LRLAB,LRLO,LRMNIDT,LROC,LRONESPC,LRONETST,LRORN,LRPC,LRPO,LRSDT,LRSPEC,LRSS,LRSTOP,LRSUB,LRTC,LRCNIDT
 K LRTHER,LRTSTS,LRWRD,RACNI,RAST,RPTR,OK,LRBLOOD,LRPARAM,LRPLASMA,LRSERUM,LRUNKNOW,LRURINE,LRPANEL,LRTM60,LRDT0,LRLABKY
 Q
 ;  **The following routines are called by DVBCREQ1 **
DDIS1 S DXNUM=$P(^DPT(DFN,.372,DVBCXJI,0),U,1),PCT=$P(^(0),U,2)
 S DVBCSC=$P(^(0),U,3)
 S DVBCDX=$S($D(^DIC(31,DXNUM)):$P(^(DXNUM,0),U,1),1:"Unknown")
 S DXCOD=$S($D(^DIC(31,DXNUM)):$P(^(DXNUM,0),U,3),1:"Unknown")
 W ?2,DVBCDX,?37,$J(PCT,3,0)," %",?50,$S(DVBCSC=1:"Yes",1:"No")
 W ?58,DXCOD,!
 I IOST?1"C-".E W !,"VA Form 21-2507" D TERM
 Q
 ;
DDIS ;display rated disabilities
 I '$D(^DPT(DFN,.372)) W !?25,"No rated disabilities on file",!! Q
 W !?2,"Rated Disability",?37,"Percent",?50,"SC ?",?58,"Dx Code",! W ?2 F LINE=1:1:63 W "-"
 W !!
 F DVBCXJI=0:0 S DVBCXJI=$O(^DPT(DFN,.372,DVBCXJI)) Q:DVBCXJI=""  D DDIS1  Q:($D(GETOUT))
 W !!
 Q
 ;
TST W ?3
 F DA=0:0 S DA=$O(^DVB(396.4,"C",DA(1),DA)) Q:(DA="")!($D(GETOUT))  D CONTST
 Q
 ;
CONTST K PRINT S TSTAT=$P(^DVB(396.4,DA,0),U,4)
 S TST=$P(^DVB(396.4,DA,0),U,3)
 S PRTNM=$S($D(^DVB(396.6,TST,0)):$P(^(0),U,2),1:"")
 D TST1
 Q
 ;
TST1 I $Y>(IOSL-3) W !,"VA Form 21-2507" I IOST?1"C-".E D TERM Q:($D(GETOUT))
 S TSTA1=""
 I $D(^DVB(396.4,DA,"CAN")) S TSTA1=$P(^DVB(396.4,DA,"CAN"),U,3)
 I $D(^DVB(396.4,DA,"TRAN")) S X=$P(^DVB(396.4,DA,"TRAN"),U,3)
 S:TSTA1]"" TSTA1=$P(^DVB(396.5,TSTA1,0),U,1) ;tsta1=cancellation reason
 W:(($L(PRTNM)+$L(TSTA1)+$X)>55!($D(DVBAINSF))) !?1 W $S(PRTNM]"":PRTNM,1:"Missing exam name")_$S(TSTA1]"":" - cancelled ("_TSTA1_")",TSTAT="T":" - Transferred",TSTAT="":" (Unknown status)",1:"")
 I TSTAT="T" S X=$S($D(^DIC(4.2,+X,0)):$P(^(0),U,1),1:"unknown site") W " to ",$P(X,".",1)
 W "; "
 I $D(DVBAINSF) DO
 .I +$P(^DVB(396.4,DA,0),U,11)>0 DO
 ..I $Y>(IOSL-7) D BOT D:'$D(GETOUT) HDR^DVBCREQ1
 ..I '$D(GETOUT) DO
 ...S TVAR(1,0)="0,3,0,2,0^Insufficient Reason: "_$P(^DVB(396.94,$P(^DVB(396.4,DA,0),U,11),0),U,1)
 ...S TVAR(2,0)="0,3,0,2:1,0^Insufficient Remarks: "
 ...D WR^DVBAUTL4("TVAR")
 ...K TVAR
 ...I $D(^DVB(396.4,DA,"INREM")) DO
 ....K ^UTILITY($J,"W")
 ....S DIWL=5,DIWF="NW"
 ....F LPCNT=0:0 S LPCNT=$O(^DVB(396.4,DA,"INREM",LPCNT)) Q:LPCNT=""!($D(GETOUT))  DO  ;**Loop Insufficient Remarks
 .....S X=^DVB(396.4,DA,"INREM",LPCNT,0)
 .....S:X="<" X=" <"
 .....S X=$P(X,"<",1)
 .....D ^DIWP ;**Print Insufficient Remarks
 .....I $Y>(IOSL-8),$O(^DVB(396.4,DA,"INREM",LPCNT))]"" DO
 ......D BOT D:'$D(GETOUT) HDR^DVBCREQ1,RMRK
 ....D:'$D(GETOUT)&($O(^DVB(396.4,DA,"INREM",0))>0) ^DIWW
 ...W !!
 Q
 ;
TERM ;  ** If output to CRT, display 'Continue' prompt **
 S DIR(0)="F,O^^",DIR("A")="Enter [Return] to continue or ""^"" to exit"
 K GETOUT D ^DIR S:$D(DTOUT)!($D(DUOUT)) GETOUT=1
 I '$D(GETOUT) W @IOF K DIR,DIRUT
 Q
 ;
BOT ;**Write form # at bottom
 I IOST?1"C-".E F LPCNT1=$Y:1:(IOSL-6) W !
 I IOST'?1"C-".E F LPCNT1=$Y:1:(IOSL-4) W !
 W !,"VA Form 21-2507"
 I IOST?1"C-".E D TERM
 Q
 ;
RMRK ;** Write remarks continued at top of page
 W !!?3,"Insufficient remarks, continued",!!
 Q

DVBCUTL4
DVBCUTL4 ;ALB-ISC/JLU/GTS-A utility routine ;2/22/93
 ;;2.7;AMIE;;Apr 10, 1995
 ;
SITE() ;returns the site's name from the amie parameter file (396.1)
 N DVBCX
 S DVBCX=$O(^DVB(396.1,0))
 I 'DVBCX Q "UNKNOWN"
 Q $P(^(DVBCX,0),U,1) ;nake on SITE+2
 ;
EXAM() ;returns the next exam .01 number in the 396.4 Exam file
 N DVBA,DVBA1
 L +^DVB(396.1,1,5):3
 I '$T Q 0 ;unable to lock parameter file node
 S DVBA=$P(^DVB(396.1,1,5),U,1)
 F DVBA1=0:0 S DVBA=DVBA+1 I '$D(^DVB(396.4,"B",DVBA)) Q
 S $P(^DVB(396.1,1,5),U,1)=DVBA
 L -^DVB(396.1,1,5)
 Q DVBA ;contains new .01 value
 ;
EXSRH(A,B,C) ;searches for the exam for a specific request.
 ;A ==> The DIC("A") prompt for 396.6
 ;B ==> An optional screen on 396.6
 ;C ==> An optional screen on 396.4
 ;
 N ERR
 DO
 .I $D(A),A]"" S DIC("A")=A
 .I $D(B),B]"" S DIC("S")=B
 .S DIC="^DVB(396.6,",DIC(0)="AEQM"
 .D ^DIC K DIC
 .I +Y<0!($D(DTOUT))!(X="")!(X=U) S ERR=-1 Q
 .I $D(C),C]"" S DIC("S")=C
 .S X=+Y,DIC="^DVB(396.4,",DIC(0)="EQ"
 .S D="ARQ"_REQDA
 .D IX^DIC K DIC,D
 I $D(ERR),ERR<0 S Y=-1
 Q Y
 ;
ROLLBCK ;  ** Sort the ^TMP global to find added exams **
 S DIK="^DVB(396.4,"
 N DVBADA,DVBAEXNM,DVBARQDT
 S (DVBADA,DVBAEXNM,DVBARQDT)=""
 S DVBARQDT=$P(^DVB(396.3,REQDA,0),U,2)
 F DVBACNT=0:0 S DVBAEXNM=$O(^TMP($J,"NEW",DVBAEXNM)) Q:DVBAEXNM=""  D LOOP2
 K DVBACNT,DVBADA,DVBAEXNM,DVBARQDT,DIK,DA
 Q
 ;
LOOP2 ;  ** Loop through 'PE' X-Ref:delete exams just added **
 F DVBADA=0:0 S DVBADA=$O(^DVB(396.4,"APE",DFN,DVBAEXNM,DVBARQDT,DVBADA)) Q:DVBADA=""  S DA=DVBADA D ^DIK
 Q
 ;
CONTMES ;  ** Continue Message to replace HANG statements **
 W !!,"   Press RETURN to continue..." R DVBCCONT:DTIME K DVBCCONT
 Q
 ;
EXMLOG1 ; ** Add exam (Called from DVBCADE2) **
 S (DIC,DIE)="^DVB(396.4,",DIC(0)=""
 K DD,DO
 S DIC("DR")=".02////^S X=REQDA;.03////^S X=$P(^TMP($J,""NEW"",EXMNM),U,1);.04////O"
 D FILE^DICN I $D(Y),(+Y>0) W:$X>40&($L(EXMNM)>30) !
 W EXMNM_" -added, " W:$X>50 !
 I $D(Y),+Y<0 W *7,"Exam addition error ! " S OUT=1 H 3 Q
 S $P(^TMP($J,"NEW",EXMNM),U,3)=+Y
 I $P(^DVB(396.3,REQDA,0),U,10)="E" DO
 .I $D(^DVB(396.3,REQDA,5)) DO  ;**Insuf 2507 entered after 2.7
 ..K DTOUT
 ..S DVBAINDA=+$P(^DVB(396.3,REQDA,5),U,1),DVBCADEX=""
 ..D INSXM^DVBCUTA1 K DVBCADEX
 .I '$D(^DVB(396.3,REQDA,5)) DO  ;**Insuf 2507 entered prior to 2.7
 ..N REASON
 ..S REASON=+$$INRSLK^DVBCUTA3
 ..I +REASON>0 DO
 ...K DIE,Y,DA,DR
 ...S DIE="^DVB(396.4,",DR=".11////^S X=REASON;80;.12"
 ...S DA=+$P(^TMP($J,"NEW",EXMNM),U,3)
 ...S DIE("NO^")="" D ^DIE K DIE,DA,DR,Y W !!
 Q  ;Quit to EXMLOG^DVBCADE2
 ;
STATCHK ; ** Check Statuses (Called from ^DVBCEDIT) **
 Q:STAT="O"  I STAT="RX" W *7,!!,"This exam has been cancelled by the RO.",!! H 2 S NCN=1 Q
 I STAT="CT" W *7,!!,"This request has been completed and transferred out.",!! H 2 S NCN=1 Q
 I STAT="C" W *7,!!,"This exam has been completed.",! S NCN=1 Q
 I STAT="X" W *7,!!,"This exam has been cancelled by MAS.",!! H 2 S NCN=1 Q
 I STAT="R" W *7,!!,"This exam has been released to the RO.",!! H 2 S NCN=1 Q
 Q
 ;
COMP ; ** Check to see if transcription completed (Called from ^DVBCEDIT) **
 K OUT Q:$P(^DVB(396.4,EXMDA,0),U,4)="C"  W !!,"Is transcription completed for this exam" S %=2 D YN^DICN I $D(DTOUT) S OUT=1 Q
 I $D(%Y),(%Y["?") W !!,"Enter Y if all information has been entered and transcription is finished",!,"or N if more information will be entered later",!! G COMP
 Q:%'=1
 K DIE,DA,DR
 S DIE="^DVB(396.4,",DA=EXMDA,DR=".04///C"
 D ^DIE
 Q
 ;
PAUSE ;this is a pause, only looking for a return or up arrow
 S DIR(0)="E"
 D ^DIR
 K DIR
 Q
 ;
STM ;start response clock
 I $D(XRTL) D T0^%ZOSV
 Q
 ;
SPM ;stop monitor clock
 I $D(XRT0) D T1^%ZOSV
 K XRTN
 Q
 ;
DELSER ;this subroutine will delete the server message
 S XMZ=XQMSG
 S XMSER="S."_XQSOP
 D REMSBMSG^XMA1C
 Q
 ;
PHYS(A) ; ** Question user for access to Physicians Guide **
 S DIC(0)="AEMQ^^"
 S DIC("A")="Select exam: "
 ;S DIR("?")="Enter Yes to access the Physician's Guide using Text Retreival."
 D ^DIC
 ;I +Y=1 D PHYS^A1BBTR ;Access Physician's Guide
 ;I +Y=1 D PHYS^DRSTR ;** Access Physician's Guide
 S:'$D(Y) Y=""
 K DIR,X,Y(0)
 Q Y
 ;
DATE(PAR1,PAR2) ;gets the beginning and ending dates from the users
 ;PAR1 is the beginning date
 ;PAR2 is the ending date
 ;
DATE1 S %DT("A")="Enter the beginning date: "
 S %DT="AET"
 D ^%DT
 I X="^"!($D(DTOUT)) S (PAR1,PAR2)=0 Q
 I X="" S (PAR1,PAR2)=-1 Q
 S PAR1=Y
 K %DT,Y,X,DTOUT
 S %DT("A")="Enter the ending date: "
 S %DT="AET"
 D ^%DT
 I X="^"!($D(DTOUT)) S (PAR1,PAR2)=0 Q
 I X="" S (PAR1,PAR2)=-1 Q
 S PAR2=Y
 K %DT,X,Y,DTOUT
 I PAR2<PAR1 DO  G DATE1
 .S VAR(1,0)="1,0,0,2:2,0^Beginning date must be before ending date!"
 .D WR^DVBAUTL4("VAR")
 .K VAR,PAR1,PAR2
 .Q
 Q

DVBCUTL5
DVBCUTL5 ;ALB/GTS-AMIE C&P APPT LINK USER SEL RTNS ; 10/20/94  1:00 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
REQARY ;** Create Array of 2507's for veteran
 ;
 ;** If 2507 status=DVBASTAT, set node in ^TMP("DVBC",$J)
 ;**  ^TMP("DVBC",$J) ordered from newest to oldest 2507
 ;**  The following variables must be KILLed by the calling routine:
 ;**   DVBAMORE, DVBALP, DVBAOUT, DVBADTOT, DVBAPNAM,DVBADA,DVBADFN
 ;**   DVBADT,DVBAORD
 ;**  NOTE: DVBASTAT must be defined before REQARY entry
 S DVBACNT=0
 ;
 ;**  If entered from INSUF^DVBCLOG or DVBCMKLK and open
 ;**   exam on current 2507, Set ^TMP
 F  S DVBADA=$O(^DVB(396.3,"B",DVBADFN,DVBADA)) Q:DVBADA=""  DO
 .I $P(^DVB(396.3,DVBADA,0),U,18)=DVBASTAT DO
 ..S DVBAOPEN=$$OPENCHK(DVBADA) I +DVBAOPEN'>0 K DVBAOPEN
 ..I '$D(DVBASDPR)!($D(DVBASDPR)&($D(DVBAOPEN))) DO
 ...K DVBAOPEN
 ...S DVBADT=$P(^DVB(396.3,DVBADA,0),"^",2),DVBACNT=DVBACNT+1
 ...S ^TMP("DVBC",$J,9999999.999999-DVBADT,DVBADT,DVBADA)=""
 Q
 ;
REQSEL ;** Select 2507
 ;
 ;**  Loop ^TMP array, display 2507's in groups of 5
 ;**  ^TMP subscripts:
 ;**    ^TMP("DVBC",$J,9999999.999999-2507 Request date int,
 ;**         Request date int, Request DA)
 W !!,"Select a 2507 request",!
 S DVBAORD=""
 S DVBAPNAM=$P(^DPT(DVBADFN,0),"^",1)
 F DVBALP=1:1 S DVBAORD=$O(^TMP("DVBC",$J,DVBAORD)) Q:DVBAORD=""  DO
 .S (DVBADT,DVBADA)=""
 .S DVBADT=$O(^TMP("DVBC",$J,DVBAORD,DVBADT))
 .S DVBADA=$O(^TMP("DVBC",$J,DVBAORD,DVBADT,DVBADA))
 .K Y S Y=DVBADT X ^DD("DD")
 .W !,?5,DVBALP,?8," ",DVBAPNAM,?40,"  Request date: ",Y
 .S DVBAMORE=$O(^TMP("DVBC",$J,DVBAORD))
 .I +DVBAMORE'>0 D SELREQ ;**No more entries
 .I (+DVBAMORE>0)&(DVBALP#5=0) DO  ;**More entries exist, 5 displayed
 ..W !,"ENTER '^' TO STOP, OR"
 ..D SELREQ
 Q
 ;
FINDDA ;** Loop ^TMP, get 396.3 DA
 F DVBALP=1:1:DVBASEL S DVBAORD=$O(^TMP("DVBC",$J,DVBAORD)) DO
 .S (DVBADT,DVBADA)=""
 .S DVBADT=$O(^TMP("DVBC",$J,DVBAORD,DVBADT))
 .S DVBADA=$O(^TMP("DVBC",$J,DVBAORD,DVBADT,DVBADA))
 Q
 ;
SELREQ ;** Select 2507 from ^TMP
 K DVBAOUT
 S DIR(0)="NOA^1:"_DVBALP_"^K:X[""."" X"
 S DIR("?")="Select a 2507 request by entering it's associated number"
 S DIR("A")="CHOOSE 1-"_DVBALP_": " D ^DIR
 I $D(DTOUT)!($D(DUOUT)) S DVBAORD="9999999.999999",DVBAOUT=""
 I '$D(DTOUT)&('$D(DUOUT)) S:+Y>0 DVBAORD="9999999.999999"
 S:$D(DTOUT) DVBADTOT=""
 W !
 K DTOUT,DUOUT,DIR
 Q
 ;
OPENCHK(REQDA) ;** Check for open exam on 2507
 N LPDA,QVAR
 S LPDA=""
 F  S LPDA=$O(^DVB(396.4,"C",REQDA,LPDA)) Q:'LPDA!($D(QVAR))  DO
 .I $P(^DVB(396.4,LPDA,0),U,4)="O" DO
 ..S:'$D(QVAR) QVAR=LPDA
 S:'$D(QVAR) QVAR=""
 Q +QVAR
 ;
REQPAT() ;** Select patient who has 2507's
 S DIC(0)="AEMQ",DIC("A")="Select C&P Veteran Name: ",DIC="^DPT("
 S DIC("S")="I $D(^DVB(396.3,""B"",+Y))" D ^DIC K DIC
 Q +Y
 ;
CPPATARY(DVBADFN) ;** Set ^TMP of 2507's for vet
 ;
 ;**  ^TMP array ordered newest to oldest
 ;**  DVBACNT to be killed by calling routine
 N REQDA,REQDT
 S DVBACNT=0
 S REQDA=""
 F  S REQDA=$O(^DVB(396.3,"B",DVBADFN,REQDA)) Q:REQDA=""  DO
 .I +$P(^DVB(396.3,REQDA,0),U,2)>0,($P(^DVB(396.3,REQDA,0),U,18)'="N") DO
 ..I $P(^DVB(396.3,REQDA,0),U,18)'="" DO
 ...S REQDT=$P(^DVB(396.3,REQDA,0),"^",2),DVBACNT=DVBACNT+1
 ...S ^TMP("DVBC",$J,9999999.999999-REQDT,REQDT,REQDA)=""
 Q
 ;
NO2507 ;** 2507 not selected, error
 S DIR("A",1)="You have not selected a 2507 request to link a C&P appointment to."
 S DIR("A",2)="This is required to continue processing with the AMIE link management option."
 S DIR("A",3)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 Q
 ;
SDEVTSPC(DVBAPCE) ;**Return piece of 'S' node in Sched event
 N DVBASPCV
 S DVBASPCV=""
 S:($D(^TMP("SDEVT",$J,SDHDL,1,"DPT",0,"AFTER"))) DVBASPCV=$P(^TMP("SDEVT",$J,SDHDL,1,"DPT",0,"AFTER"),U,DVBAPCE)
 Q DVBASPCV
 ;
SDEVTXST() ;** Check ^TMP("SDEVT",$J) existence
 Q $D(^TMP("SDEVT",$J,SDHDL,1,"DPT",0,"AFTER"))
 ;
SDORGST() ;** Return value of SD Event originating process
 N DVBAVAR
 S DVBAVAR=""
 Q $O(^TMP("SDEVT",$J,SDHDL,DVBAVAR))
 ;

DVBCUTL6
DVBCUTL6 ;ALB/GTS-AMIE C&P APPT LINK DISPLAY SUBRTNS ; 10/20/94  1:45 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
LKHDOUT ;** Link MGNT screen hdr
 W @IOF
 W "AMIE/C&P Appointment Link Management",!!,"Current appointment links"
 W !,"Clinic",?32,"Date/Time",?51,"Status",!
 Q
 ;
EXMOUT(LPDA) ;** Output exam
 W !!,"Exam: ",$P(^DVB(396.6,$P(^DVB(396.4,LPDA,0),U,3),0),U,2)
 W !,"Clinic",?32,"Date/Time",?49,"Status"
 Q
 ;
EXMDISP(REQDA) ;** Output Open/Completed exams
 D EXMHD
 N DVBADA,DVBASTAT
 S DVBADA=""
 F  S DVBADA=$O(^DVB(396.4,"C",REQDA,DVBADA)) Q:(DVBADA=""!($D(DTOUT)!$D(DUOUT)))  DO
 .I $D(^DVB(396.4,DVBADA,0)) DO
 ..S DVBASTAT=$P(^DVB(396.4,DVBADA,0),U,4)
 ..D EXAMLST^DVBCUTA4(DVBADA,DVBASTAT)
 Q
 ;
EXMHD ;** Exam header
 W @IOF
 N DVBALN
 S Y=$P(^DVB(396.3,REQDA,0),U,5)
 X ^DD("DD")
 W !!,"AMIE exams on 2507 request for: ",$P(^DPT($P(^DVB(396.3,REQDA,0),U,1),0),U,1)
 W !,"2507 Request Date Reported to MAS: ",Y
 S $P(DVBALN,"-",80)=""
 W !,DVBALN
 W !!,"Exam:",?40,"Status:"
 K Y
 Q
 ;
APPTSEL(DVBADFN,APPTTYPE,REQDA,STRTDT,ENDDT) ;Select appt
 ;** APPTTYPE = appt type to select
 ;** STRTDT,ENDDT = selected date range
 ;
 ;** APPTSEL creates ^TMP = appt's of APPTTYPE in date range
 ;** ^TMP=appt dte-ext ^ Clinic-ext ^ Status-ext ^ appt dte-int
 W @IOF
 N TMPDA
 S STRTDT=STRTDT-.1,TMPDA=1
 S:+STRTDT<0 STRTDT=0
 S:'$D(ENDDT) ENDDT=""
 S:ENDDT="" ENDDT=9999999
 K STATUS,STATVAR
 I $D(^DPT(DVBADFN,"S")) DO
 .F  S STRTDT=$O(^DPT(DVBADFN,"S",STRTDT)) Q:(STRTDT=""!(STRTDT>ENDDT))  DO
 ..I $P(^DPT(DVBADFN,"S",STRTDT,0),U,16)=APPTTYPE DO
 ...S TMPDA=TMPDA+1
 ...S DA=DVBADFN,DA(2.98)=STRTDT,DR="1900",DR(2.98)=".01",DIC=2
 ...S DIQ="DVBAARY" K ^UTILITY("DIQ",$J)
 ...D EN^DIQ1 K ^UTILITY("DIQ",$J)
 ...S Y=STRTDT X ^DD("DD")
 ...S STATVAR=$$STATUS^SDAM1(DVBADFN,STRTDT,$P(^DPT(DVBADFN,"S",STRTDT,0),U,1),^DPT(DVBADFN,"S",STRTDT,0))
 ...S STATUS=$P(STATVAR,";",3)
 ...S ^TMP("DVBC",$J,TMPDA)=Y_"^"_DVBAARY(2.98,STRTDT,.01)_"^"_STATUS_"^"_STRTDT
 ...K DVBAARY(2.98),Y,STATUS,STATVAR
 D ARYDISP
 Q
 ;
ARYDISP ;** Display appts for selection
 ;** run APPTSEL before ARYDISP
 ;
 ;** DVBAAPT returned (= selected ^TMP node)
 ;
 K DA,DR,DIC,DIQ
 I '$D(DVBAMORE) N DVBAMORE
 I '$D(TMPDA) N TMPDA
 W !!!,"Select an appointment to link to the 2507 request",!
 W !,?1,"1",?4,"Display Current C&P Appointment Links"
 S ^TMP("DVBC",$J,1)=""
 F TMPDA=2:1 Q:'$D(^TMP("DVBC",$J,TMPDA))  DO
 .W !,?1,TMPDA,?4,$P(^TMP("DVBC",$J,TMPDA),U,1)
 .W ?23,$E($P(^TMP("DVBC",$J,TMPDA),U,2),1,22)
 .W:$D(^DVB(396.95,"AB",REQDA,$P(^TMP("DVBC",$J,TMPDA),U,4))) ?47,"*CL"
 .W ?51,$E($P(^TMP("DVBC",$J,TMPDA),U,3),1,27)
 .S DVBAMORE=$O(^TMP("DVBC",$J,TMPDA))
 .I +DVBAMORE'>0 D SELAPT
 .I (+DVBAMORE>0)&(TMPDA#5=0) D SELAPT
 S DVBAAPT=""
 I $D(Y) DO
 .S DVBAAPT=^TMP("DVBC",$J,+Y)
 .K ^TMP("DVBC",$J,+Y)
 Q
 ;
SELAPT ;** Select Appt
 W !
 S DIR("A",1)="ENTER '^' TO STOP, OR"
 S DIR("A")="CHOOSE 1-"_TMPDA_": "
 S DIR(0)="NOA^1:"_TMPDA_"^I X["".""!('$D(^TMP(""DVBC"",$J,+Y))) K X"
 S DIR("?",1)="Select an appointment by entering its associated number."
 S DIR("?",2)=" *CL following Status means the appointment date is the"
 S DIR("?",2)=DIR("?",2)_" Current Date for"
 S DIR("?",3)=" an existing link."
 S DIR("?",4)="Enter '1' to see the current links to this 2507."
 S DIR("?")="Select from the numbers listed."
 D ^DIR
 I $D(DTOUT)!($D(DUOUT)) S TMPDA=9999,DVBAOUT=""
 S:+Y>1 TMPDA=9999
 W:+Y'>0 !
 I +Y=1 DO
 .W @IOF
 .D LNKARY^DVBCUTA3(REQDA,DVBADFN)
 .D LNKLIST^DVBCUTA3
 .S:TMPDA'>5 TMPDA=TMPDA-1
 .S:(TMPDA>5&(TMPDA#5=0)) TMPDA=TMPDA-5
 .S:(TMPDA>5&(TMPDA#5'=0)) TMPDA=TMPDA-1
 .D REFRSH^DVBCUTA4(TMPDA)
 .K Y
 I $D(Y),(+Y'>0) K Y
 K DIR,DTOUT,DUOUT
 Q
 ;
LINKINF(REQDA,CURRAPT) ;** Display Link info
 N LINKNODE,LINKDA,INITDTE,ORIGDTE,VETDTE
 S LINKDA=""
 S LINKDA=$O(^DVB(396.95,"AB",REQDA,CURRAPT,LINKDA))
 S LINKNODE=^DVB(396.95,LINKDA,0)
 S INITDTE=$P(LINKNODE,U,1)
 S ORIGDTE=$P(LINKNODE,U,2)
 S VETDTE=$P(LINKNODE,U,5)
 I INITDTE'=CURRAPT DO
 .K Y
 .S Y=INITDTE
 .X ^DD("DD")
 .W !,"Initial Appt: ",?36,Y
 I ORIGDTE'=CURRAPT DO
 .K Y
 .S Y=ORIGDTE
 .X ^DD("DD")
 .W !,"Clock Stop Appt: ",?36,Y
 I VETDTE'=""&(VETDTE'=CURRAPT) DO
 .K Y
 .S Y=VETDTE
 .X ^DD("DD")
 .W !,"Last Veteran requested Appointment: ",?36,Y
 K Y
 S Y=CURRAPT
 X ^DD("DD")
 W !,"Current Appt: ",?36,Y
 K Y
 Q

DVBCUTL7
DVBCUTL7 ;ALB/GTS-AMIE C&P APPT LINK FILE MAINT RTNS ; 10/20/94  2:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
ATRBCK ;** Trace Auto-rbkd appt, result: temporary link record based on trace
 ;
 ;** APPTSTAT,APPTNODE must be defined for appt to link before ATRBCK
 ;** APPTNODE is ^DPT(,'S' node (current appt to be linked)
 ;** ^TMP("DVBC",$J,'field name') created - temp link record
 ;** DVBAAPT set by ARYDISP^DVBCUTL6
 ;**  DVBAAPT = appt dte-ext ^ Clinic-ext ^ Status-ext ^ appt dte-int
 ;
 N DVBANEWA,NODEDT
 S ^TMP("DVBC",$J,"INITIAL APPT DATE")=$P(DVBAAPT,U,4)
 S ^TMP("DVBC",$J,"ORIGINAL APPT DATE")=$P(DVBAAPT,U,4)
 S:'$D(^TMP("DVBC",$J,"VETERAN CANCELLATION")) ^TMP("DVBC",$J,"VETERAN CANCELLATION")=0
 S ^TMP("DVBC",$J,"APPOINTMENT STATUS")=1
 S ^TMP("DVBC",$J,"CURRENT APPT DATE")=$P(APPTNODE,U,10) ;**bullet-proof
 I APPTSTAT'="NT",(APPTSTAT["N"!(APPTSTAT["P")) DO  ;**Vet canceled
 .S ^TMP("DVBC",$J,"VETERAN CANCELLATION")=1
 .S ^TMP("DVBC",$J,"VETERAN REQ APPT DATE")=$P(APPTNODE,U,10)
 ;
 ;** First run auto-rbk, FOR  SET returns DVBANEW'=""
 F  S DVBANEWA=$P(APPTNODE,U,10) Q:DVBANEWA=""  DO
 .I $D(^DPT(DVBADFN,"S",DVBANEWA,0)) DO
 ..D STATCK(DVBANEWA,DVBADFN) ;**Set APPTNODE,APPTSTAT - DVBANEWA node
 ..I ^TMP("DVBC",$J,"VETERAN CANCELLATION")'=1 S ^TMP("DVBC",$J,"ORIGINAL APPT DATE")=DVBANEWA
 ..I APPTSTAT'="NT",(APPTSTAT["N"!(APPTSTAT["P")) DO  ;**Vet canc
 ...S ^TMP("DVBC",$J,"VETERAN CANCELLATION")=1
 ...I APPTSTAT["A" DO  ;**Vet canc,Auto-rbk -O get pce 10
 ....S ^TMP("DVBC",$J,"VETERAN REQ APPT DATE")=$P(APPTNODE,U,10)
 ..I APPTSTAT["A" DO  ;**Current=auto-rbk appt
 ...S ^TMP("DVBC",$J,"CURRENT APPT DATE")=$P(APPTNODE,U,10)
 ..I APPTSTAT["A"!(APPTSTAT="I"!(APPTSTAT=""!(APPTSTAT="NT"))) DO
 ...S ^TMP("DVBC",$J,"APPOINTMENT STATUS")=1
 ..I APPTSTAT'["A"&(APPTSTAT'="I"&(APPTSTAT'=""&(APPTSTAT'="NT"))) DO
 ...S ^TMP("DVBC",$J,"APPOINTMENT STATUS")=0
 Q
 ;
NOAUTO ;** ^TMP("DVBA",$J) prepared for FIXLK/ADDLK, no auto-rbk
 ;
 ;** ^TMP("DVBA",$J) KILLed by calling rtn
 ;** DVBAAPT defined before calling NOAUTO
 ;** ^TMP is temp link record
 ;
 S ^TMP("DVBC",$J,"INITIAL APPT DATE")=$P(DVBAAPT,U,4)
 S ^TMP("DVBC",$J,"ORIGINAL APPT DATE")=$P(DVBAAPT,U,4)
 S ^TMP("DVBC",$J,"CURRENT APPT DATE")=$P(DVBAAPT,U,4)
 S:'$D(^TMP("DVBC",$J,"VETERAN CANCELLATION")) ^TMP("DVBC",$J,"VETERAN CANCELLATION")=0
 S:(APPTSTAT="N"!(APPTSTAT="PC")) ^TMP("DVBC",$J,"VETERAN CANCELLATION")=1
 S:'$D(^TMP("DVBC",$J,"VETERAN REQ APPT DATE")) ^TMP("DVBC",$J,"VETERAN REQ APPT DATE")=""
 S ^TMP("DVBC",$J,"APPOINTMENT STATUS")=0
 S:APPTSTAT="I"!(APPTSTAT="NT"!(APPTSTAT="")) ^TMP("DVBC",$J,"APPOINTMENT STATUS")=1
 Q
 ;
STATCK(APPTDTIN,DVBADFN) ;** Check current appt status
 ;** APPTNODE,APPTSTAT KILLed by calling rtn
 S APPTNODE=^DPT(DVBADFN,"S",APPTDTIN,0)
 S APPTSTAT=$P(APPTNODE,U,2)
 Q

DVBCUTL8
DVBCUTL8 ;ALB/GTS-AMIE C&P APPT LINK FILE MNT RTNS 2 ; 10/20/94  3:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** NOTICE: This routine is part of an implementation of a Nationally
 ;**         Controlled Procedure.  Local modifications to this routine
 ;**         are prohibited per VHA Directive 10-93-142
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 13)
 ;
FIXLK ;** Re-attach unlinked appt to new appt
 ;
 ;** ^TMP("DVBC",$J,) must have nodes:
 ;**    ORIGINAL APPT DATE, CURRENT APPT DATE, VETERAN CANCELLATION,
 ;**    VETERAN REQ APPT DATE, APPOINTMENT STATUS = appt to be linked
 ;
 N REQDT,SAVY
 S:$D(Y) SAVY=Y
 S REQDT=$$GETDTE^DVBCMKLK(DVBADA) ;**Set REQDT
 S:$D(SAVY) Y=SAVY
 S DIR("A",1)="Adjusting C&P appointment link for 2507 request dated "_REQDT_"."
 S DIR("A",2)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 N ORIGAPPT,CURRAPPT,VETCANC,APPTSTAT,APPTNODE,VETDTE,INITAPPT
 S VETDTE=""
 S ORIGAPPT=^TMP("DVBC",$J,"ORIGINAL APPT DATE")
 S CURRAPPT=^TMP("DVBC",$J,"CURRENT APPT DATE")
 S VETCANC=^TMP("DVBC",$J,"VETERAN CANCELLATION")
 S:$D(^TMP("DVBC",$J,"VETERAN REQ APPT DATE")) VETDTE=^TMP("DVBC",$J,"VETERAN REQ APPT DATE")
 S APPTSTAT=^TMP("DVBC",$J,"APPOINTMENT STATUS")
 K DA,DIE,DR
 ;
 ;** Only one current appt date/time for vet can exist in 396.95
 S DA="" S DA=DVBAOLDA
 S APPTNODE=^DVB(396.95,DA,0) ;**APPTNODE 396.95 rec before mods
 S DIE="^DVB(396.95,",DR=""
 ;
 ;** If 396.95 initial appt lost, set to original appt
 I $P(APPTNODE,U,1)="",($P(APPTNODE,U,2)'="") S INITAPPT=$P(APPTNODE,U,2)
 I $P(APPTNODE,U,1)="" S DR=".01////^S X=INITAPPT;"
 I $P(APPTNODE,U,4)'=1 S DR=DR_".02////^S X=ORIGAPPT;"
 S DR=DR_".03////^S X=CURRAPPT;"
 I $P(APPTNODE,U,4)'=1 S DR=DR_".04////^S X=VETCANC;"
 I VETCANC=1 S DR=DR_".05////^S X=VETDTE;" ;**Update last vet req date
 S DR=DR_".07////^S X=APPTSTAT"
 D ^DIE K DIE,DA,DR
 Q
 ;
ADDLK ;** Add link from 2507 to appt
 ;
 ;** ^TMP("DVBC",$J,) nodes:
 ;**    ORIGINAL APPT DATE, CURRENT APPT DATE, VETERAN CANCELLATION,
 ;**    VETERAN REQ APPT DATE, APPOINTMENT STATUS = appt to be linked
 ;
 N REQDT,SAVY
 S:$D(Y) SAVY=Y
 S REQDT=$$GETDTE^DVBCMKLK(DVBADA) ;**Set REQDT
 S:$D(SAVY) Y=SAVY
 S DIR("A",1)="Adding new C&P appointment link for 2507 request dated "_REQDT_"."
 S DIR("A",2)=" "
 S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 N ORIGAPPT,CURRAPPT,VETCANC,APPTSTAT,APPTNODE,VETDTE
 S VETDTE=""
 S ORIGAPPT=^TMP("DVBC",$J,"ORIGINAL APPT DATE")
 S CURRAPPT=^TMP("DVBC",$J,"CURRENT APPT DATE")
 S VETCANC=^TMP("DVBC",$J,"VETERAN CANCELLATION")
 S:$D(^TMP("DVBC",$J,"VETERAN REQ APPT DATE")) VETDTE=^TMP("DVBC",$J,"VETERAN REQ APPT DATE")
 S APPTSTAT=^TMP("DVBC",$J,"APPOINTMENT STATUS")
 K DA,DIC,X,DD,DO
 S X=^TMP("DVBC",$J,"INITIAL APPT DATE")
 S DIC="^DVB(396.95,",DIC(0)="L",DIC("DR")=""
 S DIC("DR")=DIC("DR")_".02////^S X=ORIGAPPT;.03////^S X=CURRAPPT;"
 S DIC("DR")=DIC("DR")_".04////^S X=VETCANC;.05////^S X=VETDTE;"
 S DIC("DR")=DIC("DR")_".06////^S X=DVBADA;.07////^S X=APPTSTAT"
 D FILE^DICN
 I +Y'>0 DO
 .S DIR("A",1)="The C&P appointment link was not properly added.  Please investigate the"
 .S DIR("A",2)="appointment scheduled for "_ORIGAPPT_" for "_$P(^DPT(DVBADFN,0),U,1)
 .S DIR("A",3)=" "
 .S DIR(0)="FAO^1:1",DIR("A")="Hit Return to continue." D ^DIR K DIR,X,Y
 K DIC,DA,X,Y
 Q
 ;
STYLE(REQDA) ;** Return indication of 2507 status matching integ report type
 N STATIND,REQSTAT,STYLEIND,PARAMDA
 S STATIND=0 ;**Leave set to zero if STYLEIND=4
 S REQSTAT=$P(^DVB(396.3,REQDA,0),U,18)
 S PARAMDA=0
 S PARAMDA=$O(^DVB(396.1,PARAMDA))
 S STYLEIND=$P(^DVB(396.1,PARAMDA,0),U,15)
 I STYLEIND="1" S:"P^S"[REQSTAT STATIND=1
 I STYLEIND="2" S:"R^C"[REQSTAT STATIND=1
 I STYLEIND="3" S STATIND=1
 Q +STATIND
 ;
SELLNK(REQDA) ;** Return IEN from 396.95 for link to modify
 N SELDA
 D LNKARY^DVBCUTA3(REQDA,DVBADFN) ;**Set up link array
 I '$D(TMP("DVBC LINK")) DO
 .S SELDA=0,DVBANOLK=""
 .D NOLNK^DVBCLKT2
 I $D(TMP("DVBC LINK")) DO
 .I '$D(DVBAAPT) DO
 ..S Y=$P(SDATA,U,3)
 ..X ^DD("DD")
 ..S DVBAAPT=Y
 ..S DVBAAPST=""
 .D LINKDISP^DVBCUTA1
 .I $D(DVBAAPST) K DVBAAPT,DVBAAPST
 K Y
 Q +SELDA

DVBCVSC1
DVBCVSC1 ;ALB ISC/THM-MISC TEXT FOR VISUAL EXAM ; 7/1/91  10:15 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 F I=1:1 S LY=$T(@LX+I) Q:LY["END"  D:LY["|TOP|" HD2^DVBCVSCK W:LY'["|TOP|" $P(LY,";;",2),!
 Q
 ;
TXT ;
 ;;C. Diplopia - (The measurement of muscle function will be performed using a
 ;;   Goldmann Perimeter Chart.  The examiner will chart the areas in which
 ;;   diplopia exists.  This plotted chart will be made a part of the examination
 ;;   report and the entire report is to be mailed to the regional office.):
 ;;
 ;;      Yes     No     (circle one)
 ;;
 ;;
 ;;   1. If diplopia is present, state whether it is constant or intermittent,
 ;;      whether it is present at all distances or only for near or distant vision,
 ;;      and whether it is correctable by use of lenses or prisms.
 ;;
 ;;   2. If diplopia is constant and not correctable, indicate which sectors
 ;;      of the visual field are affected and provide the Goldmann perimeter chart
 ;;      showing actual areas of diplopia.  Diplopia outside these areas is not
 ;;      considered disabling but can be used in evaluation of the underlying
 ;;      disease or injury.
 ;;
 ;;       a.  Central 20 degrees
 ;;
 ;;       b.  21 to 30 degrees
 ;;
 ;;                    down
 ;;
 ;;            right lateral
 ;;
 ;;             left lateral
 ;;
 ;;                       up
 ;;
 ;;       c.  31 to 40 degrees
 ;;
 ;;                     down
 ;;
 ;;            right lateral
 ;;
 ;;             left lateral
 ;;
 ;;                       up
 ;;
 ;;D. Visual field deficit:  Yes    No  (circle one)
 ;;
 ;;   If Yes, chart fields per the following instructions and provide visual
 ;;   field charts (see attachment).
 ;;
 ;;   1. For aphakic eye which cannot be fitted with contact lens or intra-ocular
 ;;      implant, use the IV/4e test object.
 ;;
 ;;   2. In all other cases, use the III/4e test object.
 ;;
 ;;   3. Visual field charts submitted for evaluation purposes should contain
 ;;      only one field chart with only the III/4e or IV/4e object as above.
 ;;      If the examiner feels that charting with other objects is necessary,
 ;;      for confirmation of test results, they should be reported on a
 ;;      separate chart along with an explanation of the need and the significance
 ;;      of any discrepancies noted.
 ;;|TOP|
 ;;
 ;;   4. All scotomas should be plotted carefully so that the rating board
 ;;      can make appropriate allowances in calculating the extent of the
 ;;      effective visual field in each eye.
 ;;
 ;;
 ;;E. Indicate the presence or absence of disease or damage to the retina
 ;;   cornea, iris, or other part of the eye -- detached retina, glaucoma,
 ;;   cataract, iritis, etc.  Describe any episodes of incapaciting pain or
 ;;   other need for bed rest.  If keratoconus is present, state whether
 ;;   contact lenses are required or adequate correction is possible by other
 ;;   means.  Include any other remarks or comments as deemed appropriate.
 ;;END

DVBCVSC2
DVBCVSC2 ;ALB ISC/THM-FIELD CHART FOR VISUAL EXAM ; 6/27/91  2:10 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;**This program is temporarily not used -- thm 6/27/91
 ;
 F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 Q
 ;
TXT ;
 ;;Visual Fields in Degrees
 ;;
 ;;Meridian                  Right Eye                 Left Eye
 ;;________                  _________                 ________
 ;;
 ;;
 ;;Up                        _________                 _________
 ;
 ;;  Up+                     (_______)                 (_______)
 ;;
 ;;Up nasal                  _________                 _________
 ;;
 ;;  Up nasal+               (_______)                 (_______)
 ;;
 ;;Nasal                     _________                 _________
 ;;
 ;;  Nasal+                  (_______)                 (_______)
 ;;
 ;;Down nasal                _________                 _________
 ;;
 ;;  Down nasal+             (_______)                 (_______)
 ;;
 ;;Down                      _________                 _________
 ;;
 ;;  Down+                   (_______)                 (_______)
 ;;
 ;;Down temporal             _________                 _________
 ;;
 ;;  Down temporal+          (_______)                 (_______)
 ;;
 ;;Temporal                  _________                 _________
 ;;
 ;;  Temporal+               (_______)                 (_______)
 ;;
 ;;Up temporal               _________                 _________
 ;;
 ;;  Up temporal+            (_______)                 (_______)
 ;;
 ;;
 ;;"Up+" indicates a meridian about halfway between "Up" and "Up nasal",
 ;;"Nasal+" a meridian intermediate between "Nasal" and "Down nasal".  These
 ;;intermediate meridians are not used for evaluation purposes but are required
 ;;for smoothing the curves of the charted field(s).
 ;;END

DVBCVSCK
DVBCVSCK ;ALB/GTS-557/THM-VISUAL EXAM ; 6/27/91  2:11 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1330 Worksheet" S HD7="VISUAL",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W "Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:  "
 S LX="TXT" F I=1:1 S LY=$T(@LX+I) Q:LY["END"  W $P(LY,";;",2),!
 W !!,"A. Medical history:",!!!!!!!!!
 W !!,"B. Visual Acuity:",!!?44,"Near",?55,"Far",!?43,"______",?54,"______",!
 W ?13,"Right Eye",?28,"Uncorrected",?42,"|______",?49,"|",?53,"|______",?60,"|",!!?43,"______",?54,"______",!?30,"Corrected",?42,"|______",?49,"|",?53,"|______",?60,"|",!!!
 W ?44,"Near",?55,"Far",!?43,"______",?54,"______",!?13," Left Eye",?28,"Uncorrected",?42,"|______",?49,"|",?53,"|______",?60,"|",!!?43,"______",?54,"______",!?30,"Corrected",?42,"|______",?49,"|",?53,"|______",?60,"|",!!!
 D HD2 S LX="TXT" D ^DVBCVSC1 W !!!!!
 W "F. Diagnostic/clinical test results (other than visual acuity,visual fields",!,?4,"or diplopia):",!!!!!!!!!!,"G. Diagnosis:",!!!!!!!!!!
 W ?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 ;S LN22="Attachment - Visual Exam" W @IOF,!!?(80-$L(LN22)\2),LN22,!!! D ^DVBCVSC2 W !
 K LN,LN1,LN22
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Examination",!,HD8," for ",NAME,!!!
 Q
 ;
TXT ;
 ;;For visual acuity worse than 5/200 in either or both eyes, report
 ;;            the distance in feet/inches (or meters/centimeters) from the face
 ;;            at which the veteran can count fingers/detect hand motion/read the
 ;;            largest line on the chart.  If the veteran cannot detect hand motion
 ;;            or count fingers at any distance, state whether he/she has light
 ;;            perception.
 ;;END
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCVW2
DVBCVW2 ;ALB/CMM LIST MANAGER PROTOCOL DRIVER ;17FEB92
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;List Manager -display for exams and chapter/introductions
EN() ;
 I VWQRY<2 Q
 I '$D(QUIT)!(QUIT="Y") Q
 I $D(DVBCSPR) G LEAVE^DVBCPGD
 S VALMBG=1
 ;
 ;vwqry     reference query number
 ;vwdoc     reference doc number
 ;vwline    reference line, default=1
 ;
 I $D(QUIT) D EN^VALM("DVBA C VIEW EXAMS")
 Q
 ;
INIT ;   set up the doc to be viewed based on parameters
 I '$D(QUIT)!(VWQRY<2) Q
 I QUIT="Y" Q
 S DVBCVAR="^TMP"
 S VALMAR=VALMAR_"(""DVBCVIEW"",$J,"_VWQRY_","_VWDOC_")"
 I $D(DVBCFLG) D CALLIT^DVBCPG1
 ;
 S VWLINE=1,VALMBG=VWLINE
 ;
 ; get number of lines in doc from 0 node
 S VALMCNT=$P($G(@VALMAR@(0)),"^",4)
 I VALMCNT<1 Q
 ;
 Q
 ;
HEADER ; HEADER FOR LIST MANAGER DISPLAY 
 Q
 ;
EXIT ;CLEAN UP
 ;   set line to NULL so if user reopens doc it will be recalc'ed
 I $D(DVBCSPR) Q
 S VWLINE="",VALMBG=1
 ; if normal exit, then leave dvbcvw2
 S VALMBCK="R"
 I '$D(QUIT) Q
 I $D(QUIT) D REMOVE^DVBCLMU5(VWQRY)
 K ^TMP("DVBC,",$J,VWQRY),^TMP("DVBCVIEW",$J,VWQRY)
 S VWQRY=VWQRY-1,DVBCHLD="DVBCVIEW,"_$J_","_VWQRY
 I VWQRY>1 S VALMCNT=$P(^TMP("DVBCVIEW",$J,VWQRY,VWDOC,0),"^",4)
 I VWQRY<3 K DVBCJMP,DVBCTEMP
 S QUIT="Y"
 S DVBCCT="Y"
 Q
 ;
EXPAND ;EXPAND ACTION
 Q
HELP ;DISPLAY HELP
 N OFFSET,TEXT
 D CLEAR^VALM1
 W !,"***  The function keys F9 for 'Print List' and F12 for 'Super Quit' ***"
 W !,"***  are available.  ***"
 F OFFSET=1:1 S TEXT=$P($T(HELPTXT+OFFSET),";;",2,78) Q:TEXT="$END"  D
 .I (TEXT="$PAUSE") D PAUSE^VALM1 Q:('Y)  W !
 .W:'(TEXT="$PAUSE") !,TEXT
 D PAUSE^VALM1
 S VALMBCK="R"
 K Y
 Q
HELPTXT ;TEXT FOR HELP
 ;;
 ;;Available Options Are:
 ;;
 ;;  NX - Next Screen            - Scroll down one screen
 ;;  BU - Previous Screen        - Scroll up one screen
 ;;  UP - Up a Line              - Scroll up one line
 ;;  DN - Down a Line            - Scroll down one line
 ;;  FS - First Screen           - Go to top of list
 ;;  LS - Last Screen            - Go to bottom of list
 ;;  RE - Refresh Screen         - Repaint the screen
 ;;  PS - Print Screen           - Print the current screen
 ;;  PL - Print List             - Print Exam or Chapter/Introduction displayed
 ;;  AD - Auto Display(On/Off)   - Turn on/off displaying of available actions
 ;;  QU - Quit                   - Exit display screen
 ;;  SQ - Super Quit             - Exit Completely to Menu Option
 ;; JMP - Jump to New Exam       - Select a New Exam to View
 ;;$END
 ;
 ;
KEYSET ;this sets up the print and super quit function keys
 S XQORM("XLATE","F12")="SQ"
 S XQORM("XLATE","F9")="PL"
 Q

DVBCXFRA
DVBCXFRA ;ALB/GTS-557/THM-TRANSFER C&P REQUESTS ; 4/18/91  2:14 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 D HOME^%ZIS K CORR S FF=IOF G EN
 ;
CORSEL I SEL=1 G EN
 I SEL=2 G DOMAIN
 I SEL=3 G EXAMS
 I SEL=4 K CORR,EXAMS,X,Y,REQDA G EN
 I SEL[U G EXIT
 ;
SET ;** EXAMS - Xfr all
 S EXMNM=$P(^DVB(396.6,$P(^DVB(396.4,JJ,0),U,3),0),U,1)
 I $P(^DVB(396.4,JJ,0),U,4)["X" W EXMNM," is CANCELED and cannot be transferred.",!,*7 Q
 I $P(^DVB(396.4,JJ,0),U,4)="C" W EXMNM," is COMPLETED and cannot be transferred.",!,*7 Q
 I $P(^DVB(396.4,JJ,0),U,4)="T" W EXMNM," has been TRANSFERRED and cannot be selected.",!,*7 Q
 W !,EXMNM," is OK to transfer.",!!
 S EXAMS=EXAMS_$P(^DVB(396.4,JJ,0),U,3)_U,XEXAMS(JJ)="",XMCNT=XMCNT+1
 ;
 ;** Set XMVAR(XMCNT)=$EXAM AMIE EXAM IFN^INSUFF REASON IFN
 S XMVAR(XMCNT)="$EXAM "_$P(^DVB(396.4,JJ,0),U,3)_U_$S(+$P(^DVB(396.4,JJ,0),U,11)>0:$P(^DVB(396.94,$P(^DVB(396.4,JJ,0),U,11),0),U,1),1:"")
 ;EXAMS for MailMan msg, XEXAMS sets exam status
 ;XMVAR() add one exam/line to bulletin - Future
 Q
 ;
EN W @FF,!,"Transfer C&P Exams",!!!!
 K DVBAINSF S DIC="^DVB(396.3,",DIC(0)="AEQMZ",DIC("A")="Select VETERAN NAME: " D ^DIC K DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" H 2 G EN
 I $P(Y(0),U,18)'="P" W !!,*7,"This request does not have a PENDING status and may not be transferred.",!! H 3 G EN
 I $P(Y(0),U,22)]"" W !!,*7,"This request was transferred in and CANNOT be transferred to any other site !",!! H 3 G EN
 ;
ENQUEST W !!!,"Is this the correct request" S %=2 D YN^DICN G:%<0 EXIT I %=2 H 1 G EN
 I %=0 W !!,"Enter Y if the correct Veteran or N if not.",!! DO
 .D CONTMES^DVBCUTL4
 I %=0 G ENQUEST
 K DVBAINSF
 S REQDA=+Y,DFN=$P(Y,U,2),PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9)
 S:$P(^DVB(396.3,REQDA,0),U,10)="E" DVBAINSF=""
 I $D(CORR) G DISPLAY
 ;
DOMAIN W @FF,!,"Selection of transfer domain:",!!!!
 S DIC("A")="Send to domain: ",DIC="^DIC(4.2,",DIC(0)="AEQM" D ^DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" H 2 G EN
 ;
DOMQST W !!!,"Is this the correct domain" S %=2 D YN^DICN G:%<0 EXIT I %=2 H 1 G DOMAIN
 I %=0 W !!,"Enter Y if the domain is correct or N to reselect." D CONTMES^DVBCUTL4 G DOMQST
 S DOMNUM=$S($P(^DIC(4.2,+Y,0),U,3)]"":$P(^(0),U,3),1:+Y),DOMNAM=$P(^(0),U,1),DOMNUM1=+Y
 I $D(CORR) G DISPLAY
 ;
EXAMS K XEXAMS W @FF,!,"Exam selection",!!!! S EXAMS="",XMCNT=0
 F LPCNT=0:0 S LPCNT=$O(XMVAR(LPCNT)) Q:LPCNT=""  K XMVAR(LPCNT)
 W !!,"Do you want to transfer ALL exams" S %=2 D YN^DICN G:%<0 EXIT
 I %=2 W !! G PART
 I %=0 W !!,"Enter Y if you want to transfer all exams or N if not.",!! D CONTMES^DVBCUTL4 G EXAMS
 W !!! F JJ=0:0 S JJ=$O(^DVB(396.4,"C",REQDA,JJ)) Q:JJ=""  D SET
 D PAUSE^DVBCUTL4
 G @$S(EXAM]""&(Y):"DISPLAY",1:"EN")
 ;
PART W @FF,!,"Individual exam selection",!!!!
 S Y=$$EXSRH^DVBCUTL4("Select EXAM TO TRANSFER: ","I $D(^DVB(396.4,""ARQ""_REQDA,+Y))") ;*Exam lookup function call
 K DIC G:X=""&(EXAMS]"") DISPLAY G:X=U EXIT
 I +Y<0 W *7,!!,"No exams have been selected for transfer." D CONTMES^DVBCUTL4 G EN
 I $P(^DVB(396.4,+Y,0),U,4)["X" W !!,"This exam is CANCELED and cannot be transferred.",*7,!! D CONTMES^DVBCUTL4 G PART
 I $P(^DVB(396.4,+Y,0),U,4)="C" W !!,"This exam has been COMPLETED and cannot be transferred.",!!,*7 D CONTMES^DVBCUTL4 G PART
 I $P(^DVB(396.4,+Y,0),U,4)="T" W !!,"This exam has been TRANSFERRED and cannot be selected.",!!,*7 D CONTMES^DVBCUTL4 G PART
PART1 W !!!,"Is this the correct exam" S %=2 D YN^DICN G:%<0 EXIT I %=2 G EXAMS
 I %=0 W !!,"Enter Y if all is correct or N to reselect another exam." D CONTMES^DVBCUTL4 G PART1
 I EXAMS[$P(^DVB(396.4,+Y,0),U,3)_U DO
 .W !!,*7,"You have already selected this exam for transfer."
 .D CONTMES^DVBCUTL4
 I EXAMS[$P(^DVB(396.4,+Y,0),U,3)_U G PART
 S EXAMS=EXAMS_$P(^DVB(396.4,+Y,0),U,3)_U,XEXAMS(+Y)="",XMCNT=XMCNT+1
 D SETXMVR^DVBCXUTL ;** Set XMVAR(XMCNT)
 W !! G PART
 ;
DISPLAY I EXAMS="" W @FF,!!!,"No exams have been selected for transfer.",!! D PAUSE^DVBCUTL4 G EN
 W @FF,!!,"You have selected the following:",!!!,"Veteran name: ",PNAM,?50,"SSN: ",SSN,!,"Request date: " S Y=$P(^DVB(396.3,REQDA,0),U,2) X ^DD("DD") W Y,!!!,"Exams selected for transfer:",!!
 F I=1:1 S X=$P(EXAMS,U,I) Q:X=""  W $P(^DVB(396.6,X,0),U,1),"; " I $X>45 W !?2
 ;
YN K DA(1) W !!!,"Is this information correct" S %=2 D YN^DICN I %<0 K EXAMS,REQDA,X,DIC,DA,Y,DVBAINSF,XMCNT F LPCNT=0:0 S LPCNT=$O(XMVAR(LPCNT)) Q:LPCNT=""  K XMVAR(LPCNT)
 I %<0 K LPCNT G EN
 I %=0 W !!,"Answer YES if correct and NO if not" G YN
 I %=1 W !!,"One moment please ...   "
 ;
DISPLAY1 ;
 K CORR I %=2 S CORR=1 W @FF,!!,"Select part to correct:",!!!,"1. Veteran name",!,"2. Domain",!,"3. Exams",!,"4. All parts",!!,"Selection: " R SEL:DTIME G:'$T!(SEL[U) EXIT
 I $D(CORR) I (SEL'?1N)!(+SEL'>0)!(+SEL'<5)!(SEL["?") W *7,!!,"Must be a number from 1 to 4.   " D CONTMES^DVBCUTL4 G DISPLAY1
 I $D(CORR) G CORSEL
 D INREAS^DVBCXUTL
 G ^DVBCXFRB
 ;
EXIT D CLRVAR^DVBCXUTL
 D KILLVRS^DVBCXUTL G KILL^DVBCUTIL

DVBCXFRB
DVBCXFRB ;ALB/GTS-557/THM-LOAD TRANSFER MAIL MESSAGE ; 4/29/91  8:09 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN ;file 2
 K ^TMP("DVBCXFR",$J),L S X=^DVB(396.3,REQDA,0),DFN=$P(X,U,1)
 S X=^DPT(DFN,0),PNAM=$P(X,U,1),DOB=$P(X,U,3),SEX=$P(X,U,2),SSN=$P(X,U,9)
 S X=$S($D(^DPT(DFN,.11)):^(.11),1:""),ADR1=$P(X,U,1),ADR2=$P(X,U,2),ADR3=$P(X,U,3),CITY=$P(X,U,4),STATE=$P(X,U,5),ZIP=$P(X,U,6),CNTY=$P(X,U,7),ZIP4=$P(X,U,12)
 S CNTY=$S($D(^DIC(5,+STATE,1,+CNTY,0)):$P(^(0),U,1),1:""),STATE=$S($D(^DIC(5,+STATE,0)):$P(^(0),U,1),1:"")
 S X=$S($D(^DPT(DFN,.13)):^(.13),1:"") S HOMPHON=$P(X,U,1),BUSPHON=$P(X,U,2)
 S X=$S($D(^DPT(DFN,.3)):^(.3),1:""),SRVCON=$P(X,U,1),SRVPCT=$P(X,U,2)
 S X=$S($D(^DPT(DFN,.31)):^(.31),1:""),CNUM=$P(X,U,3)
 S CFLOC=$$STATION^DVBAUTL1(DFN)
 S:CFLOC=-1 CFLOC=""
 S X=$S($D(^DPT(DFN,.32)):^(.32),1:""),PDSRV=$P(X,U,3),SRVEDT=$P(X,U,6),SRVSDT=$P(X,U,7),PDSRV=$S($D(^DIC(21,+PDSRV,0)):$P(^(0),U,3),1:"")
 S X=$S($D(^DPT(DFN,.36)):^(.36),1:""),ELIGCOD=$P(X,U,1),ELIGCOD=$S($D(^DIC(8,+ELIGCOD,0)):$P(^(0),U,9),1:"")
 S X=$S($D(^DPT(DFN,.361)):^(.361),1:""),ELIGST=$P(X,U,1),ELIGSDT=$P(X,U,2)
 S X=$S($D(^DPT(DFN,.52)):^(.52),1:""),POWSTAT=$P(X,U,5)
 S X=$S($D(^DPT(DFN,"VET")):^("VET"),1:""),VETST=$P(X,U,1)
 S X=$S($D(^DPT(DFN,"TYPE")):^("TYPE"),1:"") S TYPE=$S(X]"":$P(^DG(391,X,0),U,1),1:"")
 S LINE(1)="$DEM0 "_PNAM_U_DOB_U_SEX_U_SSN
 S LINE(2)="$DEM1 "_ADR1_U_ADR2_U_ADR3_U_CITY_U_STATE_U_CNTY_U_ZIP_U_HOMPHON_U_BUSPHON_U_ZIP4
 S LINE(3)="$ELIG "_SRVCON_U_SRVPCT_U_CFLOC_U_CNUM_U_PDSRV_U_SRVEDT_U_SRVSDT_U_ELIGCOD_U_ELIGST_U_ELIGSDT_U_POWSTAT_U_VETST_U_TYPE
 ;
 ;file 396.3
EN1 S X=^DVB(396.3,REQDA,0),RO=$P(X,U,3),RONAM=$P($G(^DIC(4,+RO,99)),U,1),REQDT=$P(X,U,2),FEXM=$P(X,U,9),PRIO=$P(X,U,10),OTHDIS=$P(X,U,11),LREXMDT=$P(X,U,20)
 S X=$S($D(^DVB(396.3,REQDA,1)):^(1),1:""),CFREQ=$P(X,U,2),OTHDOC=$P(X,U,3),LREXMDT=$P(X,U,7),OTHDIS1=$P(X,U,9),OTHDIS2=$P(X,U,10)
 S LINE(4)="$REQ0 "_REQDA_U_RO_U_PRIO_U_CFLOC_U_LREXMDT_U_CFREQ_U_LREXMDT_U_RONAM
 S LINE(5)="$ODIS "_OTHDIS_U_OTHDIS1_U_OTHDIS2
 S EXAMS="$EXAM "_EXAMS,LINE(6)=EXAMS
 ;**NOTE: RONAM is now RO NUMBER
LOAD S L=1,^TMP("DVBCXFR",$J,L,0)="$TRANSFER IN",L=L+1
 F X=1:1 Q:'$D(LINE(X))  S ^TMP("DVBCXFR",$J,L,0)=LINE(X),L=L+1
 F JI=0:0 S JI=$O(^DVB(396.3,REQDA,2,JI)) Q:JI=""  S ^TMP("DVBCXFR",$J,L,0)="$REMK "_^DVB(396.3,REQDA,2,JI,0),L=L+1
 S SITE=$P(^XMB(1,1,0),U,1),SITE1=$P(^DIC(4.2,SITE,0),U,1)
 S USERNM=$P(^VA(200,DUZ,0),U,1),^TMP("DVBCXFR",$J,L,0)="$USER "_USERNM_U_SITE_U_SITE1,L=L+1
 S ^TMP("DVBCXFR",$J,L,0)="$END "
 N XMNODE
 S XMNODE=0
 F X=(L+1):1:(L+XMCNT) DO
 .S XMNODE=XMNODE+1
 .S ^TMP("DVBCXFR",$J,X,0)=XMVAR(XMNODE)
 S ^TMP("DVBCXFR",$J,X+1,0)="$END1 "
 ;
SEND K XMZ
 ;S XMY("POSTMASTER@"_DOMNAM)=DOMNUM
 S XMY(DUZ)="",XMY("S.DVBA C PROCESS MAIL MESSAGE@"_DOMNAM)=DOMNUM,XMSUB="Transfer of C&P Exams",XMTEXT="^TMP(""DVBCXFR"",$J,",XMDUZ=DUZ D ^XMD
 I $D(XMZ) W !!,"Transmitted as message # "_XMZ_" from this site to "_DOMNAM,! H 3
 I '$D(XMZ) W !!,*7,"Message transmission error!",!,"Request WILL NOT be transferred!",!!,"Press RETURN  " R ANS:DTIME S OUT=1 G KILL^DVBCUTIL
 ;if all ok, update main, sub-file
 F III=0:0 S III=$O(XEXAMS(III)) Q:III=""  S DIE="^DVB(396.4,",DA=III,DR=".04///T;62///"_DOMNAM_";60////"_DT_";61///"_USERNM D ^DIE
 K DIE,DA,DR S DIE="^DVB(396.3,",DA=REQDA,DR="31///y;32///N"
 D ^DIE ;set transfer items
 K LINE,DOMNUM,DOMNUM1,^TMP("DVBCXFR",$J),XMDUZ,III,L,JI,JY,XMY,XMZ,XMSUB,XMTEXT,XMDUZ,DIE,DA,DR,TYPE
 G KILL^DVBCUTIL

DVBCXFRC
DVBCXFRC ;ALB/GTS-557/THM-PROCESS TRANSFER-IN MAIL MESSAGE ; 10/4/91  9:26 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN1 N XMB K OUT,CNT S CNTA=0 X XMREC I XMRG["TRANSFER OUT" G EN1^DVBCXFRS
 F DVBCI=0:0 X XMREC Q:XMER<0!(XMRG["$END")  S XLN=XMRG,SUB=$E(XLN,2,5),XLN=$E(XLN,7,245) D @SUB
 K XLN,CNTA I XMRG["$END" D PATEDIT I '$D(OUT) D REQEDIT
 I $D(DVBCNEW) S XMB="DVBA C NEW C&P VETERAN",XMB(1)=PNAM,XMB(2)=SSN,XMB(3)=$S($D(^VA(200,+DUZ,0)):$P(^(0),U),1:"Unknown user"),Y=DT X ^DD("DD") S XMB(4)=Y D ^XMB
 ;
EXIT D DELSER^DVBCUTL4 ;deletes the server message
 K DGMSGF,TYPE,REASONS,DVBADMNM,EXMRS,XMORPV
 G KILL^DVBCUTIL
 ;
DEM0 S PNAM=$E($P(XLN,U,1),1,28),DOB=$P(XLN,U,2),SEX=$P(XLN,U,3),SSN=$P(XLN,U,4)
 Q
 ;
USER S USER=$P(XLN,U,1),SITE=$P(XLN,U,2),SITE1=$P(XLN,U,3)
 Q
 ;
DEM1 S ADR1=$P(XLN,U,1),ADR2=$P(XLN,U,2),ADR3=$P(XLN,U,3),CITY=$P(XLN,U,4),STATE=$P(XLN,U,5),CNTY=$P(XLN,U,6),ZIP=$P(XLN,U,7),HOMPHON=$P(XLN,U,8),BUSPHON=$P(XLN,U,9),ZIP4=$P(XLN,U,10)
 I STATE?.E1A.E S STATE=$O(^DIC(5,"B",STATE,0)) DO
 .I CNTY?.E1A.E S CNTY=$O(^DIC(5,+STATE,1,"B",CNTY,0)) Q
 I 'STATE S STATE=""
 I 'CNTY S CNTY=""
 Q
 ;
ELIG S SRVCON=$P(XLN,U,1),SRVPCT=$P(XLN,U,2),CFLOC=$P(XLN,U,3),CNUM=$P(XLN,U,4),PDSRV=$P(XLN,U,5),SRVEDT=$P(XLN,U,6),SRVSDT=$P(XLN,U,7),ELIGCOD=$P(XLN,U,8),ELIGST=$P(XLN,U,9),ELIGSDT=$P(XLN,U,10),POWSTAT=$P(XLN,U,11),VETST=$P(XLN,U,12)
 S TYPE=$P(XLN,U,13),TYPEPTR=""
 S:TYPE]"" TYPEPTR=$O(^DG(391,"B",TYPE,TYPEPTR))
 S ELIGCOD=$O(^DIC(8,"D",+ELIGCOD,0))
 S ELIGCOD=$S(ELIGCOD="":"",$D(^DIC(8,"D",+ELIGCOD)):$O(^DIC(8,"D",+ELIGCOD,0)),1:"")
 S PDSRV=$S(PDSRV="":"",$D(^DIC(21,"D",PDSRV)):$O(^DIC(21,"D",PDSRV,0)),1:"")
 Q
 ;
REQ0 S OLREQDA=$P(XLN,U,1),RO=$P(XLN,U,2),RONAM=$P(XLN,U,8),PRIO=$P(XLN,U,3),CFLOC=$P(XLN,U,4),LREXMDT=$P(XLN,U,5),CFREQ=$P(XLN,U,6),LREXMDT=$P(XLN,U,7)
 Q
 ;
ODIS S OTHDIS=$P(XLN,U,1),OTHDIS1=$P(XLN,U,2),OTHDIS2=$P(XLN,U,3)
 Q
 ;
EXAM S EXAMS=$P(XLN,"^^",1),REASONS=$P(XLN,"^^",2)
 Q
 ;
REMK S:'$D(CNT) CNT=0 S CNT=CNT+1,REMK(CNT)=XLN
 Q
 ;
REQEDIT K DD,DO,OUT,DR,DIC S (DIC,DIE)="^DVB(396.3,",DLAYGO=396.3,DIC(0)="LM",X=DFN,DIC("DR")="1///NOW;2///"_RONAM_";3////.5;9////"_PRIO_";28///"_SITE1_";30////"_OLREQDA_";33////"_DT D FILE^DICN K DLAYGO
 S (DA,REQDA)=+Y I DA<0 D BULL1^DVBCXFRD S OUT=1 Q
 ;Give Med Center Primary Division as routing location (DVBCDIV)
 S DVBCDIV=$$PRIM^VASITE I DVBCDIV="" D BULL1^DVBCXFRD S OUT=1 Q
 S DR="10////"_OTHDIS_";10.1////"_OTHDIS1_";10.2////"_OTHDIS2_";17////NT" D ^DIE I $D(Y) D BULL1^DVBCXFRD S OUT=1 Q
 K DR S DR="21////"_CFREQ_";23.3////"_LREXMDT_";24////"_DVBCDIV D ^DIE I $D(Y) D BULL1^DVBCXFRD S OUT=1 Q
 K DIC,DD,DO S X=""
 S DVBADMNM=$P(SITE1,".",1)
 F I=1:1 S EXM=$P(EXAMS,U,I) Q:EXM=""!($D(OUT))  D SETVARS,STATCK:'X Q:'X  D FILE^DICN I $D(Y),+Y<0 D BULL2^DVBCXFRD S OUT=1 Q
 S CNT=0 I '$D(^DVB(396.3,REQDA,2,0)) S ^(0)="^^0^0^"_DT_"^^^^"
 F ZI=0:0 S ZI=$O(REMK(ZI)) Q:ZI=""  S X=REMK(ZI) S CNT=CNT+1,^DVB(396.3,REQDA,2,CNT,0)=X F Y=3,4 S $P(^DVB(396.3,REQDA,2,0),U,Y)=CNT
 Q
 ;
PATEDIT K DVBCNEW,OUT S DIC="^DPT(",DLAYGO=2,DIC(0)="LM",X=SSN D ^DIC K DLAYGO
 I +Y>0 S DFN=+Y D ADDEDIT Q
 I +Y<0 S DVBCNEW=1
 K OUT,DA,DR,DIC S DLAYGO=2,(DIC,DIE)="^DPT(",DIC(0)="LM",X=""""_PNAM_"""",DIC("DR")=".02////"_SEX_";.03////"_DOB_";.09////"_SSN D ^DIC K DLAYGO S (DFN,DA)=+Y I DA<0 D BULL3^DVBCXFRD S OUT=1 Q
 S DGMSGF=1
 D ADDEDIT Q:$D(OUT)
 S DIE="^DPT(",DA=DFN
 S DR(1,2,1)=".301////"_SRVCON_";.302////"_SRVPCT_";.314///"_CFLOC_";.313////"_CNUM_";.323////"_PDSRV_";.326////"_SRVEDT_";.327////"_SRVSDT_";.361////"_ELIGCOD
 S DR(1,2,2)=".3611////"_ELIGST_";.3612////"_ELIGSDT_";.525////"_POWSTAT_";1901////"_VETST
 S:TYPEPTR]"" DR(1,2,3)="391////"_TYPEPTR
 D ^DIE I $D(Y),+Y<0 D BULL3^DVBCXFRD S OUT=1 Q
 Q
 ;
STATCK ;  ** Check success of finding .01 for file 396.4 **
 D BULL2^DVBCXFRD S OUT=1
 Q
 ;
SETVARS ;  ** Set variables in FOR loop **
 I REASONS'="" DO
 .S EXMRS=$P(REASONS,U,I) ;**Stuff Insufficient Reason
 .S XMORPV="Transferred from "_DVBADMNM ;**Stuff Original Provider
 S DIC="^DVB(396.4,"
 S DIE=DIC,DIC(0)="LM",DLAYGO=396.4
 S DIC("DR")=".02////"_REQDA_";.03////"_EXM_";.04////O;63////"_DT
 S:REASONS'="" DIC("DR")=DIC("DR")_";.11///"_EXMRS_";.12///"_XMORPV
 S X=$$EXAM^DVBCUTL4
 K DLAYGO
 Q
 ;
ADDEDIT ;  ** Edit Patient address (Always!) **
 S:ADR1="" ADR1="@" S:ADR2="" ADR2="@" S:ADR3="" ADR3="@"
 S:CITY="" CITY="@" S:STATE="" STATE="@" S:ZIP="" ZIP="@"
 S:CNTY="" CNTY="@" S:HOMPHON="" HOMPHON="@" S:BUSPHON="" BUSPHON="@"
 S DR=".111////"_ADR1_";.112////"_ADR2_";.113////"_ADR3_";.114////"_CITY_";.115////"_STATE_$S(ZIP4]"":";.1112////"_ZIP4,1:";.116////"_ZIP)_";.117////"_CNTY_";.131////"_HOMPHON_";.132////"_BUSPHON
 S DA=+Y,DIE="^DPT("
 D ^DIE K DIC,DIE,DA
 I $D(Y)#2 D BULL7^DVBCXFRD S OUT=1
 Q

DVBCXFRD
DVBCXFRD ;ALB/GTS-557/THM-MISCELLANOUS TRANSFER BULLETINS ; 4/17/91  10:59 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
BULL1 S FREAS="Addition of C&P request record at target site failed" K MCP D PAR,DEL Q
 ;
BULL2 S FREAS="Addition of C&P exams to request record at target site failed" K MCP D PAR,DEL Q
 ;
BULL3 S FREAS="Addition of veteran in Patient file at target site failed" K MCP,DVBCNEW D PAR,DELP Q
 ;
BULL4 S FREAS="Missing C&P request for transfer in - pointer="_REQDA,MCP=1 D PAR Q
 ;
BULL5 S FREAS="Missing C&P exams for transfer in",MCP=1 D PAR Q
 ;
BULL6 S FREAS="Local unload of MailMan message failed" K MCP D PAR Q
 ;
BULL7 ;  **  Bulletin for failed address edit  **
 S FREAS="Edit of veteran address in patient file at target site failed"
 K MCP D PAR
 Q
 ;
PAR K ^TMP("DVBC","BULL",$J) S XMSUB="C&P Request Transfer Failure",XMDUZ=.5,XMTEXT="^TMP(""DVBC"",""BULL"",$J,",L=0 I $D(MCP) S USR=$S($D(^DVB(396.3,REQDA,4)):$P(^(4),U,2),1:0) I USR>0 S XMY(USR)="" G PAR1
 S XMY(USER_"@"_SITE1)=SITE
 ;
PAR1 S XMY(XMDUZ)="",L=1,^TMP("DVBC","BULL",$J,L,0)="The transfer of a C&P request "_$S($D(MCP):"from ",1:"to ")_$P(^DVB(396.1,1,0),U,1),L=L+1
 K MCP S ^TMP("DVBC","BULL",$J,L,0)="for the following veteran has failed:",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="   ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="   Name: "_PNAM_"   SSN: "_SSN_"   "_"C-Number: "_CNUM,L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="Reason for failure: ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  "_FREAS,L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  ",L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="Original sender: "_USER_" at "_SITE1,L=L+1
 S ^TMP("DVBC","BULL",$J,L,0)="  ",L=L+1
 D ^XMD Q
 ;
DEL ;delete failed request file entry
 S DA=REQDA,DIK="^DVB(396.3," D ^DIK
 Q
 ;
DELP ;delete failed Patient file entry
 S DA=DFN,DIK="^DPT(" D ^DIK
 Q

DVBCXFRE
DVBCXFRE ;ALB/GTS-557/THM-SEND BACK TRANSFERS WHEN RELEASED ; 5/30/91  9:42 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN W !!,*7,"This request was transferred in.",!,"Please wait while I return it.",!! H 2
 ;
EN1 W @FF,!! S SITE=$P(^DVB(396.3,REQDA,0),U,22),DTTRNSC=$P(^(0),U,12),SITE1=$S($D(^DIC(4.2,+SITE,0)):$P(^(0),U,1),1:""),SITE=$S($P(^(0),U,3)]"":$P(^(0),U,3),1:SITE)
 I SITE="" W !!,*7,"There is no home domain indicated.",!,"This request was not transferred in.",!! H 3 Q
 S NREQDA=$S($D(^DVB(396.3,REQDA,1)):$P(^(1),U,8),1:"") I +NREQDA=0 W !!,*7,"The original request indicator is missing!",!,"I have no way to match it back at "_SITE1,!! H 3 Q
 W !!,"Setting up return mail message ...",!! H 1
 S L=3,^TMP("DVBCXFR",$J,1,0)="$TRANSFER OUT FROM V"_$$VERSION^XPDUTL("DVBA"),^TMP("DVBCXFR",$J,2,0)="$RQDA "_NREQDA_U_DTTRNSC_U_$P(^DVB(396.3,REQDA,0),U,18) W ".."
 I $D(ALLROPN) S ^TMP("DVBCXFR",$J,L,0)="$ROPN 1^",L=L+1 W "."
 F JJ=0:0 S JJ=$O(^DVB(396.4,"C",REQDA,JJ)) Q:JJ=""  S DIE="^DVB(396.4,",DA=JJ,DR="64///N" D ^DIE K DA,DIE,DR D RSLT,RSLT1
 S ^TMP("DVBCXFR",$J,L,0)="$USER "_$S($D(^VA(200,+DUZ,0)):$P(^(0),U,1),1:"POSTMASTER")_U_SITE_U_SITE1,L=L+1 W "."
 S ^TMP("DVBCXFR",$J,L,0)="$END ",L=L+1 W "."
 S ^TMP("DVBCXFR",$J,L,0)=" ",L=L+1 W "."
 S ^TMP("DVBCXFR",$J,L,0)="Veteran name: "_$P(^DPT(DFN,0),U,1),L=L+1 W "."
 S ^TMP("DVBCXFR",$J,L,0)="         SSN: "_SSN,L=L+1 W "."
 S ^TMP("DVBCXFR",$J,L,0)=" " W "." H 1 W !!,"Message is now ready to send back ...",!! H 2
 ;
SEND ;set status now for manual return if auto send fails; skip reopens
 I '$D(ALLROPN) S DIC(0)="QM",(DIC,DIE)="^DVB(396.3,",DA=REQDA,DR="17////CT" D ^DIE
 K XMZ S XMY(DUZ)="",XMSUB="Return of Transferred C&P Exams",XMTEXT="^TMP(""DVBCXFR"",$J,",XMY("S.DVBA C PROCESS MAIL MESSAGE@"_SITE1)=SITE D ^XMD
 I $D(XMZ) W !!,"Transmitted as message # "_XMZ_" from this site to "_SITE1,! H 3
 I '$D(XMZ) W !!,*7,"Message transmission error!",!,"Request WILL NOT be transferred!",!!,"Press RETURN  " R ANS:DTIME S OUT=1 Q:'$D(MANUAL)  I $D(MANUAL) K MANUAL G KILL^DVBCUTIL
 K DIC,DIE,DR,DA,LN,^TMP("DVBCXFR",$J),XMZ,ANS,L,JY,XMY,XMSUB,XMTEXT,XMDUZ
 I $D(MANUAL) K MANUAL G KILL^DVBCUTIL
 Q
 ;
RSLT1 F LN=0:0 S LN=$O(^DVB(396.4,JJ,"RES",LN)) Q:LN=""  S ^TMP("DVBCXFR",$J,L,0)="$RSLT "_^(LN,0),L=L+1 W "."
 Q
 ;
MANUAL S MANUAL=1 D HOME^%ZIS S FF=IOF
 ;
MANUAL1 W @FF,!,"Manual Return of C&P Transfers",!!!!
 K DIC S DIC="^DVB(396.3,",DIC(0)="AEQMZ",DIC("A")="Select VETERAN NAME: " D ^DIC G:X=""!(X=U) EXIT I +Y<0 W *7,"  ???" H 3 G MANUAL1
 I '$P(^DVB(396.3,+Y,0),U,22) W *7,!!,"This request was not transferred in to this site and",!,"it is not possible to select it for return." K OUT D PAUSE G:$D(OUT) KILL^DVBCUTIL G MANUAL1
 I $P(^DVB(396.3,+Y,0),U,18)'="CT" W !!,*7,"This request is not in the proper status to manually return it.",!,"The status must be COMPLETED/TRANSFERRED OUT (CT)." K OUT D PAUSE G:$D(OUT) KILL^DVBCUTIL G MANUAL1
 ;
ASK S REQDA=+Y W !!!,"Is this the correct request" S %=2 D YN^DICN G:%<0!($D(DTOUT)) EXIT I %=2 G MANUAL1
 I %=0 W !!,"Enter Y if this is the correct request or N to re-select.",!! H 3 G ASK
 S DFN=$P(^DVB(396.3,REQDA,0),U,1),SSN=$P(^DPT(DFN,0),U,9)
 G EN1
 ;
EXIT K MANUAL,DIC,X,Y,REQDA,%,%Y,DTTRNSC,J,TSTDT,POP,STAT,RONAME,RO,JY,EXAM,C Q
 ;
RSLT S X=^DVB(396.4,JJ,0),WRKSHT=$P(X,U,5),EXSTAT=$P(X,U,4)
 S CANCNODE=$S($D(^DVB(396.4,JJ,"CAN")):^DVB(396.4,JJ,"CAN"),1:""),CANCREM=$P(CANCNODE,U,3)
 S CANCBY=$P(CANCNODE,U,2) S:CANCBY]"" CANCBY=.5
 S CANCDT=$P(CANCNODE,U,1)
 S EXMDT=$P(X,U,6),EXPHYS=$P(X,U,7),FEXM=$P(X,U,8),EXMPL=$P(X,U,9)
 S ^TMP("DVBCXFR",$J,L,0)="$EXAM "_$P(^DVB(396.4,JJ,0),U,3)_U_WRKSHT_U_EXSTAT_U_CANCREM_U_CANCBY_U_CANCDT_U_EXMDT_U_EXPHYS_U_FEXM_U_EXMPL,L=L+1
 K CANCNODE
 Q
 ;
PAUSE W !!,"Press RETURN to continue or ""^"" to exit  " R ANS:DTIME I ANS[U S OUT=1
 Q

DVBCXFRS
DVBCXFRS ;ALB/GTS-557/THM-STUFF C&P TRANSFER RESULTS ; 5/30/91  9:59 AM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
EN1 S (CNT,CNTA)=0 K OUT,FINISH
 F DVBCI=0:0 X XMREC S:XMRG["$END" FINISH=1 Q:XMER<0!(XMRG["$END")  S XLN=XMRG,SUB=$E(XLN,2,5),XLN=$E(XLN,7,245) K OUT D @SUB Q:$D(OUT)
 K DFN,REQDT,EXMNM
 I '$D(FINISH) D BULL6^DVBCXFRD G EXIT ;sent to sender at orig site
 ;check to see if complete, if so send bulletins
 S NFINAL=0
 F EXMDA=0:0 S EXMDA=$O(^DVB(396.4,"C",REQDA,EXMDA)) Q:EXMDA=""  S STAT=$P($G(^DVB(396.4,EXMDA,0)),U,4) I STAT'="C"&(STAT'["X") S NFINAL=1
 S CURSTAT=$S(CURSTAT]""&(CURSTAT["X"):CURSTAT,1:"T")
 I '$D(ALLROPN),NFINAL=0 S (DIC,DIE)="^DVB(396.3,",DA=REQDA,DR="17///"_CURSTAT D ^DIE
 I NFINAL=0 S DFN=$P(^DVB(396.3,REQDA,0),U,1),REQDT=$P(^(0),U,2),PNAM=$P(^DPT(DFN,0),U,1),SSN=$P(^(0),U,9)
 I NFINAL=0 S XMB="DVBA C 2507 EXAM READY",XMB(1)=PNAM,XMB(2)=SSN,Y=REQDT X ^DD("DD") S XREQDT=Y,XMB(3)=XREQDT D ^XMB K XMB,XREQDT
EXIT D DELSER^DVBCUTL4
 K FINISH,ALLROPN,CURSTAT G KILL^DVBCUTIL
 ;
USER S USER=$P(XLN,U,1),SITE=$P(XLN,U,2),SITE1=$P(XLN,U,3)
 Q
 ;
RQDA S REQDA=+XLN,DTTRNSC=$P(XLN,U,2),CURSTAT=$P(XLN,U,3)
 I '$D(^DVB(396.3,REQDA,0)) D BULL4^DVBCXFRD K DIC,DIE,DA,REQDA S OUT=1
 S (DIC,DIE)="^DVB(396.3,",DR="11////"_DTTRNSC,DA=REQDA D ^DIE K DIC,DIE,DR
 Q
 ;
EXAM N DFN,REQDT,EXMNM S DFN=$P(^DVB(396.3,REQDA,0),U,1),REQDT=$P(^(0),U,2)
 S EXM=$P(XLN,U,1),WRKSHT=$P(XLN,U,2),EXSTAT=$P(XLN,U,3)
 S EXMNM=$P(^DVB(396.6,EXM,0),U,1),CNT=0
 S CANCREM=$P(XLN,U,4),CANCBY=$P(XLN,U,5),CANCDT=$P(XLN,U,6)
 S EXMDT=$P(XLN,U,7),EXPHYS=$P(XLN,U,8),FEXM=$P(XLN,U,9)
 S EXMPL=$P(XLN,U,10),DATRETN=$P(XLN,U,11)
 S DA=$O(^DVB(396.4,"APE",DFN,EXMNM,REQDT,0))
 I DA="" D BULL5^DVBCXFRD S OUT=1 Q
 S (DIC,DIE)="^DVB(396.4,"
 S DR=".05////"_WRKSHT_";.04////"_EXSTAT_";52////"_CANCREM_";51////"_CANCBY_";50////"_CANCDT_";.06////"_EXMDT_";.07////"_EXPHYS_";.08////"_FEXM_";.09////"_EXMPL_";63////"_DATRETN
 D ^DIE
 I $D(ALLROPN) K DR S DR="52///@;51///@;50///@" D ^DIE ;can't stuff nulls
 S NCN=0 F ZH=0:0 S ZH=$O(^DVB(396.4,"C",REQDA,ZH)) Q:ZH=""  I $P(^DVB(396.4,ZH,0),U,4)="T" S NCN=1
 I NCN=0 S (DIC,DIE)="^DVB(396.3,",DA=REQDA,DR="31///@;34////"_DT D ^DIE
 K NCN,ZZ Q
 ;
ROPN S ALLROPN=1,(DIC,DIE)="^DVB(396.3,",DA=REQDA
 S DR="11///@;31////y;34///@;17////P"
 D ^DIE ;transfers cancelled in error
 Q
 ;
RSLT S DFN=$P(^DVB(396.3,REQDA,0),U,1)
 S DA=$O(^DVB(396.4,"APS",DFN,EXM,"C",0))
 I '$D(^DVB(396.4,DA,"RES",0)) S ^(0)="^^0^0^"_DT_"^^^^"
 I DA="" D BULL5^DVBCXFRD S OUT=1 Q
 S CNT=CNT+1,^DVB(396.4,DA,"RES",CNT,0)=XLN
 F X=3,4 S $P(^DVB(396.4,DA,"RES",0),U,X)=CNT
 Q

DVBCXSCK
DVBCXSCK ;ALB/GTS-557/THM-DISEASES/INJURIES OF THE SPINAL CORD ; 12/27/90  1:26 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 S PG=1,HD91="Department of Veterans Affairs",HD9=$S($D(CMBN):"Abbreviated",1:"Full")_" Exam Worksheet"
EN D:'$D(IOF) SETIOF W:(IOST?1"C-".E) @IOF
 W !?25,HD91,!?22,"Compensation and Pension Examination",! W ?33,"# 1215 Worksheet" S HD7="DISEASES/INJURIES OF THE SPINAL CORD",HD8="For "_HD7 W !?(40-($L(HD9)\2)),HD9,!?(40-($L(HD8)\2)),HD8,!!
 W !,"Name: ",NAME,?45,"SSN: ",SSN,!?45,"C-number: ",CNUM,!,"Date of exam: ____________________",!!,"Place of exam: ___________________",!!,"Type of Exam: ",HD7
 W !!!!,"Narrative:  None",!!
 W !! I '$D(CMBN) W "A. Medical history:",!!!!!!!!!!,"B. Subjective complaints:",!!!!!!!!!!,"C. Objective findings:" D HD2
 W $S($D(CMBN):"A. ",1:"D. "),"Specific evaluation information required by the rating board",!?4,"(if the information requested is included elsewhere, do not",!?4,"repeat here):",!!!
 W ?5,"1.  State whether a tumor is present.  If so, note type and whether",!?9,"malignant -",!!!!!!!!
 W ?5,"2.  If a malignancy is present but is now cured or in remission,",!?9,"report the date of last surgery, radiation therapy, chemotherapy",!?9,"or other treatment -",!!!!!!!!
 W ?5,"3.  Identify the level of the lesion -",!!!!!!!!
 D:$D(CMBN) HD2 W ?5,"4.  State if the impairment is total or partial -",!!!!!!!!
 W ?5,"5.  State if the veteran is incontinent of bladder and/or bowels -",!!!!!!!! D:'$D(CMBN) HD2 W ?5,"6.  If the lesion is partial, describe the impairment of function at",!?9,"the level of each affected radicular group -",!!!!!!!!!
 W $S($D(CMBN):"B. ",1:"E. "),"Diagnostic/clinical test results:",!!!!!!! W:$D(CMBN) !!!!! W:'$D(CMBN) !!!!!!!!!! ;D:$D(CMBN) HD2
 W $S($D(CMBN):"C. ",1:"F. "),"Diagnosis:",!!!!!!!!!!!!?25,"Signature: ______________________________",!!?30,"Date: _________________________",!
 K LN,LN1,LN2
 Q
 ;
HD2 S PG=PG+1 W @IOF,!,"Page: ",PG,!!,"Compensation and Pension Exam for ",HD7,!,"for ",NAME,!!!
 Q
SETIOF ;  ** Set device control var's
 D HOME^%ZIS
 Q

DVBCXUTL
DVBCXUTL ;ALB/GTS-AMIE Transfer utility routines ; 11/28/94  2:30 PM
 ;;2.7;AMIE;;Apr 10, 1995
 ;
 ;** Version Changes
 ;   2.7 - New routine (Enhc 15)
 ;
INREAS ;** Add insufficient reason to server msg
 S EXAMS=EXAMS_"^"
 I $D(DVBAINSF) DO
 .N DVBAXMDA S DVBAXMDA=""
 .F  S DVBAXMDA=$O(XEXAMS(DVBAXMDA)) Q:(DVBAXMDA="")  DO
 ..S EXAMS=EXAMS_$P(^DVB(396.94,$P(^DVB(396.4,DVBAXMDA,0),U,11),0),U,2)_"^"
 Q
 ;
CLRVAR ;** Clear the XMVAR local array
 F LPCNT=0:0 S LPCNT=$O(XMVAR(LPCNT)) Q:LPCNT=""  K XMVAR(LPCNT)
 Q
 ;
SETXMVR ;** XMVAR(XMCNT)=$EXAM AMIE EXAM IFN^INSUF REASON IFN
 S XMVAR(XMCNT)="$EXAM "_$P(^DVB(396.4,+Y,0),U,3)
 S:$D(DVBAINSF) XMVAR(XMCNT)=XMVAR(XMCNT)_U_$P(^DVB(396.94,$P(^DVB(396.4,+Y,0),U,11),0),U,1)
 Q
 ;
KILLVRS ;** Kill variables used by DVBCXFRA
 K DIC,%,%Y,I,J,JJ,EXMNM,SEL,CORR,DOMNUM,DOMNUM1,DOMNAM,EXAMS,DVBAINSF,XMCNT,LPCNT
 Q



