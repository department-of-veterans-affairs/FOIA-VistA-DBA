Released OR*3*192 SEQ #196
Extracted from mail message
**KIDS**:OR*3.0*192^

**INSTALL NAME**
OR*3.0*192
"BLD",4604,0)
OR*3.0*192^ORDER ENTRY/RESULTS REPORTING^0^3031104^y
"BLD",4604,1,0)
^^1^1^3021029^^^^
"BLD",4604,1,1,0)
Refer to the patch description on the patch message.
"BLD",4604,4,0)
^9.64PA^^0
"BLD",4604,"ABNS",0)
^9.66A^^
"BLD",4604,"ABPKG")
n^y^G.LABTEST@ISC-SLC.VA.GOV
"BLD",4604,"INI")
PRE^ORY192
"BLD",4604,"INIT")
POST^ORY192
"BLD",4604,"KRN",0)
^9.67PA^8989.52^20
"BLD",4604,"KRN",.4,0)
.4
"BLD",4604,"KRN",.401,0)
.401
"BLD",4604,"KRN",.402,0)
.402
"BLD",4604,"KRN",.403,0)
.403
"BLD",4604,"KRN",.5,0)
.5
"BLD",4604,"KRN",.84,0)
.84
"BLD",4604,"KRN",3.6,0)
3.6
"BLD",4604,"KRN",3.8,0)
3.8
"BLD",4604,"KRN",9.2,0)
9.2
"BLD",4604,"KRN",9.8,0)
9.8
"BLD",4604,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",4604,"KRN",9.8,"NM",1,0)
ORWRPP^^0^B42317280
"BLD",4604,"KRN",9.8,"NM",2,0)
ORWRPP1^^0^B22861977
"BLD",4604,"KRN",9.8,"NM","B","ORWRPP",1)

"BLD",4604,"KRN",9.8,"NM","B","ORWRPP1",2)

"BLD",4604,"KRN",19,0)
19
"BLD",4604,"KRN",19,"NM",0)
^9.68A^^
"BLD",4604,"KRN",19.1,0)
19.1
"BLD",4604,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4604,"KRN",101,0)
101
"BLD",4604,"KRN",101,"NM",0)
^9.68A^^0
"BLD",4604,"KRN",409.61,0)
409.61
"BLD",4604,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",4604,"KRN",771,0)
771
"BLD",4604,"KRN",869.2,0)
869.2
"BLD",4604,"KRN",870,0)
870
"BLD",4604,"KRN",8989.51,0)
8989.51
"BLD",4604,"KRN",8989.52,0)
8989.52
"BLD",4604,"KRN",8994,0)
8994
"BLD",4604,"KRN","B",.4,.4)

"BLD",4604,"KRN","B",.401,.401)

"BLD",4604,"KRN","B",.402,.402)

"BLD",4604,"KRN","B",.403,.403)

"BLD",4604,"KRN","B",.5,.5)

"BLD",4604,"KRN","B",.84,.84)

"BLD",4604,"KRN","B",3.6,3.6)

"BLD",4604,"KRN","B",3.8,3.8)

"BLD",4604,"KRN","B",9.2,9.2)

"BLD",4604,"KRN","B",9.8,9.8)

"BLD",4604,"KRN","B",19,19)

"BLD",4604,"KRN","B",19.1,19.1)

"BLD",4604,"KRN","B",101,101)

"BLD",4604,"KRN","B",409.61,409.61)

"BLD",4604,"KRN","B",771,771)

"BLD",4604,"KRN","B",869.2,869.2)

"BLD",4604,"KRN","B",870,870)

"BLD",4604,"KRN","B",8989.51,8989.51)

"BLD",4604,"KRN","B",8989.52,8989.52)

"BLD",4604,"KRN","B",8994,8994)

"BLD",4604,"QUES",0)
^9.62^^
"BLD",4604,"REQB",0)
^9.611^1^1
"BLD",4604,"REQB",1,0)
OR*3.0*160^2
"BLD",4604,"REQB","B","OR*3.0*160",1)

"INI")
PRE^ORY192
"INIT")
POST^ORY192
"MBREQ")
0
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
192^3031104
"PKG",110,22,1,"PAH",1,1,0)
^^1^1^3031104
"PKG",110,22,1,"PAH",1,1,1,0)
Refer to the patch description on the patch message.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ORWRPP")
0^1^B42317280
"RTN","ORWRPP",1,0)
ORWRPP ; ALB/MJK - Background Report Print Driver ; 08 Feb 2001  09:02AM
"RTN","ORWRPP",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,109,192**;Dec 17, 1997
"RTN","ORWRPP",3,0)
PRINT(ORY,ORIO,ORDFN,ORRPTID,ORHSTYPE,ORDTRNG,OREXAMID,ORCOMP,ORALPHA,OROMEGA)        ; -- print report entry point
"RTN","ORWRPP",4,0)
 ;  RPC: ORWRP PRINT REPORT
"RTN","ORWRPP",5,0)
 ;  See RPC definition for details on input and output parameters
"RTN","ORWRPP",6,0)
 N ORHSTAG
"RTN","ORWRPP",7,0)
 S ORHSTAG=$P($G(ORRPTID),"~",2),ORRPTID=$P($G(ORRPTID),"~"),ORRPTID=$P($P(ORRPTID,";"),":")
"RTN","ORWRPP",8,0)
 IF '$$CHK() G PRINTQ
"RTN","ORWRPP",9,0)
 N ZTDTH,ZTRTN,ZTSK,ZTDESC,ZTSAVE,I,ZTIO
"RTN","ORWRPP",10,0)
 S ZTIO=ORIO,ZTDTH=$H
"RTN","ORWRPP",11,0)
 S ZTDESC="Report Print"
"RTN","ORWRPP",12,0)
 S ZTRTN="DEQUE^ORWRPP"
"RTN","ORWRPP",13,0)
 F I="ORDFN","ORRPTID","ORHSTYPE","ORDTRNG","OREXAMID","DUZ(","ORCOMP(","ORALPHA","OROMEGA","ORHSTAG" S ZTSAVE(I)=""
"RTN","ORWRPP",14,0)
 D ^%ZTLOAD
"RTN","ORWRPP",15,0)
 I $D(ZTSK) D
"RTN","ORWRPP",16,0)
 . S ORY="0^Report queued. (Task #"_ZTSK_")"
"RTN","ORWRPP",17,0)
 E  D
"RTN","ORWRPP",18,0)
 . S ORY="99^Task Rejected."
"RTN","ORWRPP",19,0)
PRINTQ Q
"RTN","ORWRPP",20,0)
REMOTE(ORY,ORIO,ORDFN,ORRPTID,ORHANDS) ;Print data for remote sites
"RTN","ORWRPP",21,0)
 ;  RPC: ORWRP PRINT REMOTE REPORT
"RTN","ORWRPP",22,0)
 N ZTDTH,ZTRTN,ZTSK,ZTDESC,ZTSAVE,I,ORHSTAG,ZTIO
"RTN","ORWRPP",23,0)
 S ORHSTAG=$P($G(ORRPTID),"~",2),ORRPTID=$P($G(ORRPTID),"~"),ORRPTID=$P($P(ORRPTID,";"),":")
"RTN","ORWRPP",24,0)
 S ZTIO=ORIO,ZTDTH=$H
"RTN","ORWRPP",25,0)
 S ZTDESC="Remote Report Print"
"RTN","ORWRPP",26,0)
 S ZTRTN="DEQUE^ORWRPP"
"RTN","ORWRPP",27,0)
 F I="ORDFN","ORRPTID","ORHANDS(","ORHSTAG" S ZTSAVE(I)=""
"RTN","ORWRPP",28,0)
 D ^%ZTLOAD
"RTN","ORWRPP",29,0)
 I $D(ZTSK) D
"RTN","ORWRPP",30,0)
 . S ORY="0^Report queued. (Task #"_ZTSK_")"
"RTN","ORWRPP",31,0)
 E  D
"RTN","ORWRPP",32,0)
 . S ORY="99^Task Rejected."
"RTN","ORWRPP",33,0)
 Q
"RTN","ORWRPP",34,0)
PRINTW(ORTEXT,ORDFN,ORRPTID,ORHSTYPE,ORDTRNG,OREXAMID,ORCOMP,ORALPHA,OROMEGA) ;Windows device print
"RTN","ORWRPP",35,0)
 N ZTQUEUED,ORHFS,ORSUB,ROOT,ORIO,ORHANDLE,ORWINDEV
"RTN","ORWRPP",36,0)
 N IOM,IOSL,IOST,IOF,IOT,IOS,ORHSTAG,POP
"RTN","ORWRPP",37,0)
 S ORHSTAG=$P($G(ORRPTID),"~",2),ORRPTID=$P($G(ORRPTID),"~"),ORRPTID=$P($P(ORRPTID,";"),":")
"RTN","ORWRPP",38,0)
 S (ORSUB,ROOT)="ORDATA",ORIO="OR WINDOWS HFS",ORTEXT=$NA(^TMP(ORSUB,$J,1)),ORHANDLE="ORWRP"
"RTN","ORWRPP",39,0)
 I '$$CHK() S @ORTEXT@(0)=ORY G PRINTWQ
"RTN","ORWRPP",40,0)
 S ORHFS=$$HFS^ORWRP(),ORWINDEV=1 ;Flag for printing to windows device
"RTN","ORWRPP",41,0)
 D HFSOPEN^ORWRP(ORHANDLE,ORHFS,"W")
"RTN","ORWRPP",42,0)
 I POP D  Q
"RTN","ORWRPP",43,0)
 . I $D(ROOT) D SETITEM^ORWRP(.ROOT,"ERROR: Unable to open HFS file")
"RTN","ORWRPP",44,0)
 D IOVAR^ORWRP(.ORIO,,,"P-WINHFS80")
"RTN","ORWRPP",45,0)
 N $ETRAP,$ESTACK
"RTN","ORWRPP",46,0)
 S $ETRAP="D ERR^ORWRP Q"
"RTN","ORWRPP",47,0)
 U IO
"RTN","ORWRPP",48,0)
 D DEQUE
"RTN","ORWRPP",49,0)
 D HFSCLOSE^ORWRP(ORHANDLE,ORHFS)
"RTN","ORWRPP",50,0)
PRINTWQ Q
"RTN","ORWRPP",51,0)
PRINTWR(ORTEXT,ORDFN,ORRPTID,ORHANDS) ;Windows Remote device print
"RTN","ORWRPP",52,0)
 N ZTQUEUED,ORHFS,ORSUB,ROOT,ORIO,ORHANDLE,ORWINDEV
"RTN","ORWRPP",53,0)
 N IOM,IOSL,IOST,IOF,IOT,IOS,ORHSTAG,POP
"RTN","ORWRPP",54,0)
 S ORHSTAG=$P($G(ORRPTID),"~",2),ORRPTID=$P($G(ORRPTID),"~"),ORRPTID=$P($P(ORRPTID,";"),":")
"RTN","ORWRPP",55,0)
 S (ORSUB,ROOT)="ORDATA",ORIO="OR WINDOWS HFS",ORTEXT=$NA(^TMP(ORSUB,$J,1)),ORHANDLE="ORWRP"
"RTN","ORWRPP",56,0)
 S ORHFS=$$HFS^ORWRP(),ORWINDEV=1 ;Flag for printing to windows device
"RTN","ORWRPP",57,0)
 D HFSOPEN^ORWRP(ORHANDLE,ORHFS,"W")
"RTN","ORWRPP",58,0)
 I POP D  Q
"RTN","ORWRPP",59,0)
 . I $D(ROOT) D SETITEM^ORWRP(.ROOT,"ERROR: Unable to open HFS file")
"RTN","ORWRPP",60,0)
 D IOVAR^ORWRP(.ORIO,,,"P-WINHFS80")
"RTN","ORWRPP",61,0)
 N $ETRAP,$ESTACK
"RTN","ORWRPP",62,0)
 S $ETRAP="D ERR^ORWRP Q"
"RTN","ORWRPP",63,0)
 U IO
"RTN","ORWRPP",64,0)
 D DEQUE
"RTN","ORWRPP",65,0)
 D HFSCLOSE^ORWRP(ORHANDLE,ORHFS)
"RTN","ORWRPP",66,0)
 Q
"RTN","ORWRPP",67,0)
CHK() ; -- do checks for required data
"RTN","ORWRPP",68,0)
 N OROK,FALSE,TRUE,ORRPT,TXT,I,J,REPORT
"RTN","ORWRPP",69,0)
 S FALSE=0,TRUE=1,I="",REPORT=""
"RTN","ORWRPP",70,0)
 IF $G(ORIO)']"" S OROK=FALSE,ORY="1^No device selected." G CHKQ
"RTN","ORWRPP",71,0)
 IF '$L($G(ORRPTID)) S OROK=FALSE,ORY="2^No report specified." G CHKQ
"RTN","ORWRPP",72,0)
 ; -- get report definition
"RTN","ORWRPP",73,0)
 F  S I=$O(^ORD(101.24,"AC",I)) Q:I=""  S J=0 F  S J=$O(^ORD(101.24,"AC",I,J)) Q:'J  D
"RTN","ORWRPP",74,0)
 . I $P($G(^ORD(101.24,J,0)),"^",2)=ORRPTID,$P(^(0),"^",8)="R" S REPORT=^(0)
"RTN","ORWRPP",75,0)
 I '$L(REPORT) S OROK=FALSE,ORY="2^Report not available." G CHKQ
"RTN","ORWRPP",76,0)
 S (TXT,ORRPT)=""
"RTN","ORWRPP",77,0)
 IF $P(REPORT,U,7)=1!($P(REPORT,U,7)=3),'$L($G(ORDTRNG)),'$G(ORALPHA) S OROK=FALSE,ORY="4^No date range specified." G CHKQ
"RTN","ORWRPP",78,0)
 IF $P(REPORT,U,4)=1,$G(ORHSTYPE)=0,'$O(ORCOMP(0)) S OROK=FALSE,ORY="10^No Adhoc components specified." G CHKQ
"RTN","ORWRPP",79,0)
 IF $P(REPORT,U,4)=1,'$G(ORHSTYPE),$P($G(ORHSTYPE),":")'=0 S OROK=FALSE,ORY="5^No health summary type specified." G CHKQ
"RTN","ORWRPP",80,0)
 IF $P(REPORT,U,4)=3,'$G(OREXAMID) S OROK=FALSE,ORY="7^No exam identified" G CHKQ
"RTN","ORWRPP",81,0)
 IF $P(REPORT,U,4)=4,'$L($G(OREXAMID)) S OROK=FALSE,ORY="9^No assessment identified" G CHKQ
"RTN","ORWRPP",82,0)
 IF $P(REPORT,U,4)=19,'$L($G(OREXAMID)) S OROK=FALSE,ORY="8^No procedure date identified" G CHKQ
"RTN","ORWRPP",83,0)
 IF '$D(^DPT(+$G(ORDFN),0)) S OROK=FALSE,ORY="6^Patient specified is not valid." G CHKQ
"RTN","ORWRPP",84,0)
 S OROK=TRUE
"RTN","ORWRPP",85,0)
CHKQ Q OROK
"RTN","ORWRPP",86,0)
 ;
"RTN","ORWRPP",87,0)
DEQUE ; -- logic to print queued report
"RTN","ORWRPP",88,0)
 ; -- call build report logic
"RTN","ORWRPP",89,0)
 N I,J,X0,X1,X2,X4,SITE,RTN,ENT,ID,ORID,ORHEADER,ORI,ORX,ORVP,OUT,PENT,POUT,PRTN,ROOT,MAX
"RTN","ORWRPP",90,0)
 S ORVP=ORDFN_";DPT(",ROOT="ORDATA",POUT=""
"RTN","ORWRPP",91,0)
 S I=0,(X1,X2,ORID,REPORT)="",SITE=$$SITE^VASITE,SITE=$P(SITE,"^",2)_";"_$P(SITE,"^",3)
"RTN","ORWRPP",92,0)
 F  S I=$O(^ORD(101.24,"AC",I)) Q:I=""  S J=0 F  S J=$O(^ORD(101.24,"AC",I,J)) Q:'J  D
"RTN","ORWRPP",93,0)
 . I $P($G(^ORD(101.24,J,0)),"^",2)=ORRPTID,$P(^(0),"^",8)="R" S X0=^(0),X2=$G(^(2)),ORID=$P(X2,"^",3),ORFHIE=$G(^(4)),X4=$P(ORFHIE,"^",2),ORFHIE=$P(ORFHIE,"^",3)
"RTN","ORWRPP",94,0)
 I '$L(X0) D NOTYET(.ROOT) Q
"RTN","ORWRPP",95,0)
 S RTN=$P(X0,"^",5),ENT=$P(X0,"^",6)
"RTN","ORWRPP",96,0)
 I '$L(RTN)!'$L(ENT) D NOTYET(.ROOT) Q
"RTN","ORWRPP",97,0)
 I '$L($T(@(ENT_"^"_RTN))) D NOTYET(.ROOT) Q
"RTN","ORWRPP",98,0)
 S PRTN=$P(X2,"^",7),PENT=$P(X2,"^",6)
"RTN","ORWRPP",99,0)
 I $G(ORALPHA) S X=ORALPHA-$G(OROMEGA) D
"RTN","ORWRPP",100,0)
 . I X<0 S X=X*(-1)
"RTN","ORWRPP",101,0)
 . I X4,X>X4 S:ORALPHA>OROMEGA OROMEGA=$$FMADD^XLFDT(ORALPHA,-X4) S:ORALPHA'>OROMEGA ORALPHA=$$FMADD^XLFDT(OROMEGA,-X4) S ORDTRNG=""
"RTN","ORWRPP",102,0)
 I X4,$G(ORDTRNG)>X4 S ORDTRNG=X4,ORALPHA=""
"RTN","ORWRPP",103,0)
 I $L($G(ORDTRNG)),'$G(ORALPHA) S ORALPHA=$$FMADD^XLFDT(DT,-ORDTRNG),OROMEGA=DT_".235959"
"RTN","ORWRPP",104,0)
 I $G(OROMEGA),$E(OROMEGA,8)'="." S OROMEGA=OROMEGA_".235959"
"RTN","ORWRPP",105,0)
 S ID=$G(ORHSTAG),$P(ID,";",5,8)=SITE_";"_$P(X2,"^",8)_";"_$P(X2,"^",9)
"RTN","ORWRPP",106,0)
 I $L($P($G(ORHSTAG),";",4)) S MAX=$P(ORHSTAG,";",4)
"RTN","ORWRPP",107,0)
 I $L($G(ORHSTYPE)) M ID=ORHSTYPE
"RTN","ORWRPP",108,0)
 I $L($G(OREXAMID)) M ID=OREXAMID
"RTN","ORWRPP",109,0)
 I $L(PRTN),$L(PENT),$L($T(@(PENT_"^"_PRTN))) S POUT=PENT_"^"_PRTN_"(.ROOT,ORDFN,.ID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.MAX,.ORFHIE)"
"RTN","ORWRPP",110,0)
 S OUT=ENT_"^"_RTN_"(.ROOT,ORDFN,.ID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.MAX,.ORFHIE)"
"RTN","ORWRPP",111,0)
 I '$O(ORHANDS(0)) D  G OUT
"RTN","ORWRPP",112,0)
 . N ORY,PAGE
"RTN","ORWRPP",113,0)
 . I $L(POUT) D @POUT Q  ;Go to non-standard print routine
"RTN","ORWRPP",114,0)
 . D @OUT
"RTN","ORWRPP",115,0)
 . Q:'$L(ROOT)
"RTN","ORWRPP",116,0)
 . S PAGE=1
"RTN","ORWRPP",117,0)
 . D HEAD^ORWRPP1(ORDFN,PAGE,ORID,$G(STATION))
"RTN","ORWRPP",118,0)
 . D HURL^ORWRPP1(.ROOT,ORDFN,ORID)
"RTN","ORWRPP",119,0)
 S ORI=0
"RTN","ORWRPP",120,0)
 F  S ORI=$O(ORHANDS(ORI)) Q:'ORI  S ORX=ORHANDS(ORI) D
"RTN","ORWRPP",121,0)
 . N ORY,PAGE,ORALPHA,OROMEGA
"RTN","ORWRPP",122,0)
 . D RTNDATA^XWBDRPC(.ORY,$P(ORX,"^",2))
"RTN","ORWRPP",123,0)
 . S:ORY="" ORY="ORY"
"RTN","ORWRPP",124,0)
 . S PAGE=1,ORALPHA=$P(ORX,"^",3),OROMEGA=$P(ORX,"^",4)
"RTN","ORWRPP",125,0)
 . D HEAD^ORWRPP1(ORDFN,PAGE,ORID,$P(ORX,"^"))
"RTN","ORWRPP",126,0)
 . D HURL^ORWRPP1(.ORY,ORDFN,ORID,1,$P(ORX,"^"))
"RTN","ORWRPP",127,0)
OUT I $L($G(ROOT)) K @ROOT
"RTN","ORWRPP",128,0)
 Q
"RTN","ORWRPP",129,0)
SITE(ORSTA)   ;Print Station info
"RTN","ORWRPP",130,0)
 N X
"RTN","ORWRPP",131,0)
 I $G(ORSTA) S ORSTA=$$IEN^XUAF4(ORSTA)
"RTN","ORWRPP",132,0)
 S:'$L($G(ORSTA)) ORSTA=$G(DUZ(2))
"RTN","ORWRPP",133,0)
 S X="Report from: "_$$GET1^DIQ(4,+ORSTA,.01,"E")_"    Station #"_$$GET1^DIQ(4,+ORSTA,99,"E")
"RTN","ORWRPP",134,0)
 W !?(IOM/2-($L(X)/2)),X
"RTN","ORWRPP",135,0)
 Q
"RTN","ORWRPP",136,0)
NOTYET(ROOT) ; -- standard not available display text
"RTN","ORWRPP",137,0)
 D SETITEM(.ROOT,"Report not available at this time.")
"RTN","ORWRPP",138,0)
 Q
"RTN","ORWRPP",139,0)
SETITEM(ROOT,X) ; -- set item in list
"RTN","ORWRPP",140,0)
 S @ROOT@($O(@ROOT@(9999),-1)+1)=X
"RTN","ORWRPP",141,0)
 Q
"RTN","ORWRPP1")
0^2^B22861977
"RTN","ORWRPP1",1,0)
ORWRPP1 ; slc/dcm - Background Report Prints (cont.) ; 12/05/02  11:02
"RTN","ORWRPP1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**109,160,192**;Dec 17, 1997
"RTN","ORWRPP1",3,0)
MEDB(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)  ;Print Medicine report
"RTN","ORWRPP1",4,0)
 K ^TMP("MCAR",$J)
"RTN","ORWRPP1",5,0)
 I '$D(^MCAR(690,"AC",ORDFN)) Q
"RTN","ORWRPP1",6,0)
 N ORHFS,%,%I,DA,DILCT,DISTP,S1,S2,S4,S6,TY,WH
"RTN","ORWRPP1",7,0)
 S ORHFS=1
"RTN","ORWRPP1",8,0)
 D EN^MCARPS2(ORDFN)
"RTN","ORWRPP1",9,0)
 D MEDB^ORWRP1(.ROOT,.ORDFN,.OREXAMID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",10,0)
 K ^TMP("MCAR",$J)
"RTN","ORWRPP1",11,0)
 Q
"RTN","ORWRPP1",12,0)
HSB(ROOT,ORDFN,ORHSTYPE,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)   ;Print Health Summary report
"RTN","ORWRPP1",13,0)
 IF $O(ORCOMP(0)) D SITE^ORWRPP($G(STATION)),PREPORT^ORWRP2(.ROOT,.ORCOMP,.ORDFN) Q
"RTN","ORWRPP1",14,0)
 D SITE^ORWRPP($G(STATION)),HSB^ORWRP1(.ROOT,.ORDFN,.ORHSTYPE,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",15,0)
 Q
"RTN","ORWRPP1",16,0)
HSTYPEB(ROOT,ORDFN,ORHSTYPE,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)       ;Print Health Summary type report
"RTN","ORWRPP1",17,0)
 D HSTYPEB^ORWRP1(.ROOT,.ORDFN,$P(ORHSTYPE,";",3),.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",18,0)
 Q
"RTN","ORWRPP1",19,0)
LSB(ROOT,ORDFN,ORHSTYPE,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)   ;Print Lab Status Report        
"RTN","ORWRPP1",20,0)
 N ORY,PAGE,ORVP,TEXT
"RTN","ORWRPP1",21,0)
 S ORVP=ORDFN_";DPT("
"RTN","ORWRPP1",22,0)
 D EN1^LR7OSOS1(.ORY,ORVP,.ORALPHA,.OROMEGA,.ORDTRNG)
"RTN","ORWRPP1",23,0)
 Q:'$L(ORY)
"RTN","ORWRPP1",24,0)
 S PAGE=1,TEXT="PATIENT LAB ORDER STATUS REPORT ("_$$FMTE^XLFDT(ORALPHA)_" - "_$$FMTE^XLFDT(OROMEGA)_")"
"RTN","ORWRPP1",25,0)
 D HEAD(ORDFN,PAGE,TEXT)
"RTN","ORWRPP1",26,0)
 D HURL(.ORY,ORDFN,TEXT)
"RTN","ORWRPP1",27,0)
 Q
"RTN","ORWRPP1",28,0)
BCMA2B(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)        ;Print BCMA Med Hist
"RTN","ORWRPP1",29,0)
 N ORY,PAGE,TEXT
"RTN","ORWRPP1",30,0)
 D
"RTN","ORWRPP1",31,0)
 . N IO
"RTN","ORWRPP1",32,0)
 . D BCMA2^ORWRP1A(.ORY,.ORDFN,.OREXAMID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",33,0)
 U IO
"RTN","ORWRPP1",34,0)
 Q:'$L(ORY)
"RTN","ORWRPP1",35,0)
 S PAGE=1,TEXT="PATIENT BCMA MEDICATION HISTORY BCMA ("_$$FMTE^XLFDT(ORALPHA)_" - "_$$FMTE^XLFDT(OROMEGA)_")"
"RTN","ORWRPP1",36,0)
 D HEAD(ORDFN,PAGE,TEXT,$G(STATION))
"RTN","ORWRPP1",37,0)
 D HURL(.ORY,ORDFN,TEXT,1)
"RTN","ORWRPP1",38,0)
 I $L($G(ORY)) K @ORY
"RTN","ORWRPP1",39,0)
 Q
"RTN","ORWRPP1",40,0)
BCMA1B(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)        ;Print BCMA Med Log
"RTN","ORWRPP1",41,0)
 N ORY,PAGE,TEXT
"RTN","ORWRPP1",42,0)
 D
"RTN","ORWRPP1",43,0)
 . N IO
"RTN","ORWRPP1",44,0)
 . D BCMA1^ORWRP1A(.ORY,.ORDFN,.OREXAMID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",45,0)
 U IO
"RTN","ORWRPP1",46,0)
 Q:'$L(ORY)
"RTN","ORWRPP1",47,0)
 S PAGE=1,TEXT="PATIENT MEDICATION LOG BCMA ("_$$FMTE^XLFDT(ORALPHA)_" - "_$$FMTE^XLFDT(OROMEGA)_")"
"RTN","ORWRPP1",48,0)
 D HEAD(ORDFN,PAGE,TEXT,$G(STATION))
"RTN","ORWRPP1",49,0)
 D HURL(.ORY,ORDFN,TEXT,1)
"RTN","ORWRPP1",50,0)
 I $L($G(ORY)) K @ORY
"RTN","ORWRPP1",51,0)
 Q
"RTN","ORWRPP1",52,0)
PROBB(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE) ;Print Problem List (Problem Tab)
"RTN","ORWRPP1",53,0)
 D SITE^ORWRPP($G(STATION)),PROBB^ORWRP1(.ORY,.ORDFN,.ID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",54,0)
 Q
"RTN","ORWRPP1",55,0)
GETVTYPE        ;Print V Type reports
"RTN","ORWRPP1",56,0)
 S PAGE=1,ORY="ORRPT"
"RTN","ORWRPP1",57,0)
 D HEAD(ORDFN,PAGE,ORHEAD,$G(STATION))
"RTN","ORWRPP1",58,0)
 D HURL(.ORY,ORDFN,ORHEAD,1)
"RTN","ORWRPP1",59,0)
 Q
"RTN","ORWRPP1",60,0)
PRINTV(ORY,ORIO,ORDFN,ORHEAD,ORRPT) ;Print data for remote sites
"RTN","ORWRPP1",61,0)
 ;  RPC: ORWRP PRINT V REPORT
"RTN","ORWRPP1",62,0)
 N ZTDTH,ZTRTN,ZTSK,ZTDESC,ZTSAVE,I,ORHSTAG
"RTN","ORWRPP1",63,0)
 ;S ORHSTAG=$P($G(ORRPTID),"~",2),ORRPTID=$P($G(ORRPTID),"~"),ORRPTID=$P($P(ORRPTID,";"),":")
"RTN","ORWRPP1",64,0)
 S ZTIO=ORIO,ZTDTH=$H
"RTN","ORWRPP1",65,0)
 S ZTDESC="Remote V Report Print"
"RTN","ORWRPP1",66,0)
 S ZTRTN="GETVTYPE^ORWRPP1"
"RTN","ORWRPP1",67,0)
 F I="ORDFN","ORHEAD","ORRPT(" S ZTSAVE(I)=""
"RTN","ORWRPP1",68,0)
 D ^%ZTLOAD
"RTN","ORWRPP1",69,0)
 I $D(ZTSK) D
"RTN","ORWRPP1",70,0)
 . S ORY="0^Report queued. (Task #"_ZTSK_")"
"RTN","ORWRPP1",71,0)
 E  D
"RTN","ORWRPP1",72,0)
 . S ORY="99^Task Rejected."
"RTN","ORWRPP1",73,0)
 Q
"RTN","ORWRPP1",74,0)
HEAD(ORDFN,PAGE,TITLE,STATION) ;Print a patient header
"RTN","ORWRPP1",75,0)
 Q:'$G(ORDFN)
"RTN","ORWRPP1",76,0)
 N %,%H,%I,DISYS,ORAGE,ORDOB,ORHLINE,ORL,ORNP,ORPNM,ORPV,ORSEX,ORSSN,ORTS,ORWARD,VA,X,ORI
"RTN","ORWRPP1",77,0)
 S:'$L($G(TITLE)) TITLE="PATIENT REPORT"
"RTN","ORWRPP1",78,0)
 D PAT^ORPR03(ORDFN)
"RTN","ORWRPP1",79,0)
 D SITE^ORWRPP($G(STATION))
"RTN","ORWRPP1",80,0)
 W !,TITLE,?(IOM-$L("Page "_PAGE)),"Page "_PAGE
"RTN","ORWRPP1",81,0)
 S X=ORDOB_" ("_ORAGE_")"
"RTN","ORWRPP1",82,0)
 W !,ORPNM_"   "_ORSSN,?39,$G(ORL(0))_$S($L($G(ORL(1))):"/"_ORL(1),1:""),?(79-$L(X)),X
"RTN","ORWRPP1",83,0)
 S $P(ORHLINE,"=",IOM+1)=""
"RTN","ORWRPP1",84,0)
 W !,ORHLINE
"RTN","ORWRPP1",85,0)
 S X="Printed: "_$$DATE^ORU($$NOW^XLFDT,"MM/DD/CCYY HR:MIN")
"RTN","ORWRPP1",86,0)
 W !?27,"*** WORK COPY ONLY ***",?(IOM-($L(X))-1),X
"RTN","ORWRPP1",87,0)
 Q
"RTN","ORWRPP1",88,0)
HURL(Y,ORDFN,TITLE,FORMAT,STATION,READ) ;Write out the file
"RTN","ORWRPP1",89,0)
 ;FORMAT tells me which node to go after
"RTN","ORWRPP1",90,0)
 N L,NOHURL,A,OUT
"RTN","ORWRPP1",91,0)
 S OUT=0,L="",NOHURL=0
"RTN","ORWRPP1",92,0)
 F  S L=$O(@Y@(L)) Q:L=""  Q:OUT  D
"RTN","ORWRPP1",93,0)
 . I $Y+4>IOSL D
"RTN","ORWRPP1",94,0)
 .. S PAGE=PAGE+1
"RTN","ORWRPP1",95,0)
 .. W !?27,"*** WORK COPY ONLY ***     (continued...)"
"RTN","ORWRPP1",96,0)
 .. I $G(READ),$G(IOT)'["HFS" R !,"^ TO STOP: ",A:DTIME I A["^" S OUT=1 Q
"RTN","ORWRPP1",97,0)
 .. W @IOF
"RTN","ORWRPP1",98,0)
 .. I $G(IOT)["HFS" S $Y=0
"RTN","ORWRPP1",99,0)
 .. D HEAD(ORDFN,PAGE,$G(TITLE),$G(STATION))
"RTN","ORWRPP1",100,0)
 .. W !,"(...continued)"
"RTN","ORWRPP1",101,0)
 . I $G(FORMAT) D  Q
"RTN","ORWRPP1",102,0)
 .. Q:'$D(@Y@(L))
"RTN","ORWRPP1",103,0)
 .. I NOHURL,$P(@Y@(L),"^")'="[REPORT TEXT]" Q
"RTN","ORWRPP1",104,0)
 .. I NOHURL,$P(@Y@(L),"^")="[REPORT TEXT]" S NOHURL=0 Q
"RTN","ORWRPP1",105,0)
 .. I $P(@Y@(L),"^")="[HIDDEN TEXT]" S NOHURL=1 Q
"RTN","ORWRPP1",106,0)
 .. I @Y@(L)["**PAGE BREAK**" Q
"RTN","ORWRPP1",107,0)
 .. W !,@Y@(L)
"RTN","ORWRPP1",108,0)
 . Q:'$D(@Y@(L,0))
"RTN","ORWRPP1",109,0)
 . I NOHURL,$P(@Y@(L,0),"^")'="[REPORT TEXT]" Q
"RTN","ORWRPP1",110,0)
 . I NOHURL,$P(@Y@(L,0),"^")="[REPORT TEXT]" S NOHURL=0 Q
"RTN","ORWRPP1",111,0)
 . I $P(@Y@(L,0),"^")="[HIDDEN TEXT]" S NOHURL=1 Q
"RTN","ORWRPP1",112,0)
 . I @Y@(L,0)["**PAGE BREAK**" Q
"RTN","ORWRPP1",113,0)
 . W !,@Y@(L,0)
"RTN","ORWRPP1",114,0)
 W !?27,"*** WORK COPY ONLY ***"
"RTN","ORWRPP1",115,0)
 Q
"RTN","ORY192")
0^^B22684
"RTN","ORY192",1,0)
ORY192 ; slc/dcm - postinit for OR*3*191 ;06/25/03  12:17
"RTN","ORY192",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**192**;Dec 17, 1997
"RTN","ORY192",3,0)
 ;
"RTN","ORY192",4,0)
 Q
"RTN","ORY192",5,0)
 ;
"RTN","ORY192",6,0)
PRE ; -- preinit
"RTN","ORY192",7,0)
 K ^TMP("PSBO")
"RTN","ORY192",8,0)
POST ; -- postinit
"RTN","ORY192",9,0)
 Q
"VER")
8.0^22.0
**END**
**END**
