Released EAS*1*28 SEQ #31
Extracted from mail message
**KIDS**:EAS*1.0*28^

**INSTALL NAME**
EAS*1.0*28
"BLD",4845,0)
EAS*1.0*28^ENROLLMENT APPLICATION SYSTEM^0^3030710^y
"BLD",4845,4,0)
^9.64PA^^
"BLD",4845,"KRN",0)
^9.67PA^8989.52^19
"BLD",4845,"KRN",.4,0)
.4
"BLD",4845,"KRN",.401,0)
.401
"BLD",4845,"KRN",.402,0)
.402
"BLD",4845,"KRN",.403,0)
.403
"BLD",4845,"KRN",.5,0)
.5
"BLD",4845,"KRN",.84,0)
.84
"BLD",4845,"KRN",3.6,0)
3.6
"BLD",4845,"KRN",3.8,0)
3.8
"BLD",4845,"KRN",9.2,0)
9.2
"BLD",4845,"KRN",9.8,0)
9.8
"BLD",4845,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",4845,"KRN",9.8,"NM",1,0)
EASMTL6A^^0^B21479527
"BLD",4845,"KRN",9.8,"NM",2,0)
EASMTL10^^0^B72083307
"BLD",4845,"KRN",9.8,"NM",3,0)
EASSIGOV^^0^B18251406
"BLD",4845,"KRN",9.8,"NM","B","EASMTL10",2)

"BLD",4845,"KRN",9.8,"NM","B","EASMTL6A",1)

"BLD",4845,"KRN",9.8,"NM","B","EASSIGOV",3)

"BLD",4845,"KRN",19,0)
19
"BLD",4845,"KRN",19.1,0)
19.1
"BLD",4845,"KRN",101,0)
101
"BLD",4845,"KRN",409.61,0)
409.61
"BLD",4845,"KRN",771,0)
771
"BLD",4845,"KRN",870,0)
870
"BLD",4845,"KRN",8989.51,0)
8989.51
"BLD",4845,"KRN",8989.52,0)
8989.52
"BLD",4845,"KRN",8994,0)
8994
"BLD",4845,"KRN","B",.4,.4)

"BLD",4845,"KRN","B",.401,.401)

"BLD",4845,"KRN","B",.402,.402)

"BLD",4845,"KRN","B",.403,.403)

"BLD",4845,"KRN","B",.5,.5)

"BLD",4845,"KRN","B",.84,.84)

"BLD",4845,"KRN","B",3.6,3.6)

"BLD",4845,"KRN","B",3.8,3.8)

"BLD",4845,"KRN","B",9.2,9.2)

"BLD",4845,"KRN","B",9.8,9.8)

"BLD",4845,"KRN","B",19,19)

"BLD",4845,"KRN","B",19.1,19.1)

"BLD",4845,"KRN","B",101,101)

"BLD",4845,"KRN","B",409.61,409.61)

"BLD",4845,"KRN","B",771,771)

"BLD",4845,"KRN","B",870,870)

"BLD",4845,"KRN","B",8989.51,8989.51)

"BLD",4845,"KRN","B",8989.52,8989.52)

"BLD",4845,"KRN","B",8994,8994)

"BLD",4845,"QUES",0)
^9.62^^
"BLD",4845,"REQB",0)
^9.611^3^2
"BLD",4845,"REQB",2,0)
EAS*1.0*13^1
"BLD",4845,"REQB",3,0)
EAS*1.0*29^1
"BLD",4845,"REQB","B","EAS*1.0*13",2)

"BLD",4845,"REQB","B","EAS*1.0*29",3)

"MBREQ")
0
"PKG",552,-1)
1^1
"PKG",552,0)
ENROLLMENT APPLICATION SYSTEM^EAS^ENROLLMENT
"PKG",552,20,0)
^9.402P^2^1
"PKG",552,20,2,0)
2^^EASXDR
"PKG",552,20,2,1)
 
"PKG",552,20,"B",2,2)

"PKG",552,22,0)
^9.49I^1^1
"PKG",552,22,1,0)
1.0^3010315^3010419^66481
"PKG",552,22,1,"PAH",1,0)
28^3030710
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","EASMTL10")
0^2^B72083307
"RTN","EASMTL10",1,0)
EASMTL10 ;MIN/TCM ALB/SCK - AUTOMATED MEANS TEST LETTERS - RERUN LETTERS ; 7/17/01
"RTN","EASMTL10",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**3,15,28**;Mar 15, 2001
"RTN","EASMTL10",3,0)
 ;
"RTN","EASMTL10",4,0)
RERUN ;  Main entry point to rerun a processing date
"RTN","EASMTL10",5,0)
 N EASDDD,EASLOC,EATYP,XX
"RTN","EASMTL10",6,0)
 ;
"RTN","EASMTL10",7,0)
 D:'$G(IOF) HOME^%ZIS
"RTN","EASMTL10",8,0)
 W @IOF
"RTN","EASMTL10",9,0)
 F XX=1:1:7 W !?2,$P($T(NOTICE+XX),";;",2)
"RTN","EASMTL10",10,0)
 ;
"RTN","EASMTL10",11,0)
 Q:'$$FILTER(.EASLOC)  ; Select Filter action, quit on uparrow
"RTN","EASMTL10",12,0)
 Q:'$$LTRTYPE(.EATYP)  ; Select type of letter to reprint, quit on uparrow
"RTN","EASMTL10",13,0)
 Q:'$$ASKDT(EATYP,.EASDDD)  ; Select date to reprint letters from, quit on uparrow
"RTN","EASMTL10",14,0)
 D QUE1
"RTN","EASMTL10",15,0)
 Q
"RTN","EASMTL10",16,0)
 ;
"RTN","EASMTL10",17,0)
FILTER(EASLOC) ; Filter by Patient Preferred Location
"RTN","EASMTL10",18,0)
 ; Input:  None
"RTN","EASMTL10",19,0)
 ;
"RTN","EASMTL10",20,0)
 ; Output: EASLOC  -1 if an error occurred
"RTN","EASMTL10",21,0)
 ;                  0 if not filtering by location
"RTN","EASMTL10",22,0)
 ;                nnn IEN of filtered facility in the INSTITUTION File
"RTN","EASMTL10",23,0)
 ;
"RTN","EASMTL10",24,0)
 ;         RESULT   1 if result of function Ok
"RTN","EASMTL10",25,0)
 ;                  0 if user enters "^" or exits
"RTN","EASMTL10",26,0)
 ; 
"RTN","EASMTL10",27,0)
 N DIR,DIRUT
"RTN","EASMTL10",28,0)
 ;
"RTN","EASMTL10",29,0)
 S EASLOC=-1
"RTN","EASMTL10",30,0)
 I $$GET1^DIQ(713,1,8,"I") D  Q:$D(DIRUT) 0
"RTN","EASMTL10",31,0)
 . S DIR(0)="YAO",DIR("A")="Filter letters by Preferred Facility? "
"RTN","EASMTL10",32,0)
 . S DIR("B")="NO"
"RTN","EASMTL10",33,0)
 . S DIR("?")="Enter 'YES' to limit letters to a specific Facility or 'NO' to print all letters"
"RTN","EASMTL10",34,0)
 . D ^DIR K DIR
"RTN","EASMTL10",35,0)
 . Q:$D(DIRUT)
"RTN","EASMTL10",36,0)
 . I 'Y S EASLOC=0 Q
"RTN","EASMTL10",37,0)
 . S DIR(0)="P^EAS(713,1,2,:QEM"
"RTN","EASMTL10",38,0)
 . S EASLOC=$$FACNUM^EASMTL6
"RTN","EASMTL10",39,0)
 E  D
"RTN","EASMTL10",40,0)
 . S EASLOC=0
"RTN","EASMTL10",41,0)
 Q 1
"RTN","EASMTL10",42,0)
 ;
"RTN","EASMTL10",43,0)
ASKDT(EATYP,EASDDD) ; Ask for processing date to look for letters
"RTN","EASMTL10",44,0)
 ; Input   EATYP    Type of letter to be reprinted 
"RTN","EASMTL10",45,0)
 ;
"RTN","EASMTL10",46,0)
 ; Output  EASDDD   Selected processing date for type of letter 
"RTN","EASMTL10",47,0)
 ;                  to be reprinted
"RTN","EASMTL10",48,0)
 ;
"RTN","EASMTL10",49,0)
 ;         RESULT   1 if result of function Ok
"RTN","EASMTL10",50,0)
 ;                  0 if user enters "^" or exits
"RTN","EASMTL10",51,0)
 ;
"RTN","EASMTL10",52,0)
 N EASDT,RSLT,EAX,EASOFST
"RTN","EASMTL10",53,0)
 ;
"RTN","EASMTL10",54,0)
 S RSLT=0
"RTN","EASMTL10",55,0)
AGN S EASDT=$$GETDT
"RTN","EASMTL10",56,0)
 G:EASDT<0 ASKQ
"RTN","EASMTL10",57,0)
 ;
"RTN","EASMTL10",58,0)
 S EASOFST=$S(EATYP=2:30,EATYP=4:60,1:0)
"RTN","EASMTL10",59,0)
 S EAX=$$FMADD^XLFDT(EASDT,-EASOFST,0,0,-1)
"RTN","EASMTL10",60,0)
 S EAX=$O(^EAS(713.2,"AD",EAX))
"RTN","EASMTL10",61,0)
 I 'EAX D  G AGN
"RTN","EASMTL10",62,0)
 . W !!,"No valid processing date could be found for ",$S(EATYP=2:30,EATYP=4:0,1:60),"-day letters for ",$$FMTE^XLFDT(EASDT),"."
"RTN","EASMTL10",63,0)
 . W !,"Please select another date."
"RTN","EASMTL10",64,0)
 ;
"RTN","EASMTL10",65,0)
 W !!,"To re-print "_$S(EATYP=2:30,EATYP=4:0,1:60)_"-day letters for "_$$FMTE^XLFDT(EASDT)
"RTN","EASMTL10",66,0)
 W !,"the Search/Processing date of "_$$FMTE^XLFDT(EAX)_" will be used."
"RTN","EASMTL10",67,0)
 W !,"Please note: ALL "_$S(EATYP=2:30,EATYP=4:0,1:60)_"-day letters for this processing date will print"
"RTN","EASMTL10",68,0)
 ;
"RTN","EASMTL10",69,0)
 S DIR(0)="YAO"
"RTN","EASMTL10",70,0)
 S DIR("?")="Enter 'YES' to use the "_$$FMTE^XLFDT(EAX)_" date.  Enter 'NO' to select a different date."
"RTN","EASMTL10",71,0)
 S DIR("A")="Do you wish to use this date? "
"RTN","EASMTL10",72,0)
 S DIR("B")="YES"
"RTN","EASMTL10",73,0)
 D ^DIR K DIR
"RTN","EASMTL10",74,0)
 I $D(DIRUT) G ASKQ
"RTN","EASMTL10",75,0)
 I 'Y G AGN
"RTN","EASMTL10",76,0)
 ;
"RTN","EASMTL10",77,0)
 S EASDDD=EAX
"RTN","EASMTL10",78,0)
 S RSLT=1
"RTN","EASMTL10",79,0)
ASKQ Q RSLT
"RTN","EASMTL10",80,0)
 ;
"RTN","EASMTL10",81,0)
GETDT() ;
"RTN","EASMTL10",82,0)
 N DIR,DIRUT
"RTN","EASMTL10",83,0)
 ;
"RTN","EASMTL10",84,0)
 S DIR(0)="DAO^:DT:EP"
"RTN","EASMTL10",85,0)
 S DIR("?")="Select the date for the letters you wish to re-print."
"RTN","EASMTL10",86,0)
 S DIR("A")="Enter re-print date: "
"RTN","EASMTL10",87,0)
 D ^DIR K DIR
"RTN","EASMTL10",88,0)
 S:$D(DIRUT) Y=-1
"RTN","EASMTL10",89,0)
 Q +Y
"RTN","EASMTL10",90,0)
 ;
"RTN","EASMTL10",91,0)
LTRTYPE(EATYP) ;  Ask for a specific type of letter to print
"RTN","EASMTL10",92,0)
 ; Input           None
"RTN","EASMTL10",93,0)
 ;
"RTN","EASMTL10",94,0)
 ; Output  EATYP    Type of letter to reprint
"RTN","EASMTL10",95,0)
 ;                  1 - 60-day letter
"RTN","EASMTL10",96,0)
 ;                  2 - 30-day letter
"RTN","EASMTL10",97,0)
 ;                  4 - 0-day letter
"RTN","EASMTL10",98,0)
 ;
"RTN","EASMTL10",99,0)
 ;         RESULT   1 if result of function Ok
"RTN","EASMTL10",100,0)
 ;                  0 if user enters "^" or exits
"RTN","EASMTL10",101,0)
 ;
"RTN","EASMTL10",102,0)
 N DIR,DIRUT
"RTN","EASMTL10",103,0)
 ;
"RTN","EASMTL10",104,0)
 S DIR(0)="SO^1:60-Day;2:30-Day;4:0-Day"
"RTN","EASMTL10",105,0)
 S DIR("A")="Select letter type",DIR("A",1)=""
"RTN","EASMTL10",106,0)
 S DIR("?")="Select the type of letter to re-print "
"RTN","EASMTL10",107,0)
 D ^DIR K DIR
"RTN","EASMTL10",108,0)
 Q:$D(DIRUT) 0
"RTN","EASMTL10",109,0)
 S EATYP=+Y
"RTN","EASMTL10",110,0)
 Q 1
"RTN","EASMTL10",111,0)
 ;
"RTN","EASMTL10",112,0)
QUE1 ;  Queue off the print job
"RTN","EASMTL10",113,0)
 K IOP,IO("Q")
"RTN","EASMTL10",114,0)
 ;
"RTN","EASMTL10",115,0)
 S %ZIS="QP",%ZIS("B")=$$GET1^DIQ(713,1,5)
"RTN","EASMTL10",116,0)
 D ^%ZIS K %ZIS
"RTN","EASMTL10",117,0)
 Q:POP
"RTN","EASMTL10",118,0)
 I $D(IO("Q")) D QUEIT Q
"RTN","EASMTL10",119,0)
 D EN1
"RTN","EASMTL10",120,0)
 D ^%ZISC
"RTN","EASMTL10",121,0)
 Q
"RTN","EASMTL10",122,0)
 ;
"RTN","EASMTL10",123,0)
QUEIT ;
"RTN","EASMTL10",124,0)
 N ZTRTN,ZTDESC,ZTSAVE,TSK,ZTDTH,ZTQUEUED
"RTN","EASMTL10",125,0)
 ;
"RTN","EASMTL10",126,0)
 S ZTRTN="EN1^EASMTL10"
"RTN","EASMTL10",127,0)
 S ZTDESC="EAS MT LETTERS REPRINT"
"RTN","EASMTL10",128,0)
 F EASX="EASDDD","EATYP","EASLOC" S ZTSAVE(EASX)=""
"RTN","EASMTL10",129,0)
 S ZTDTH="NOW"
"RTN","EASMTL10",130,0)
 ;
"RTN","EASMTL10",131,0)
 D ^%ZTLOAD
"RTN","EASMTL10",132,0)
 I $D(ZTSK)[0 W !!?5,"Reprint canceled"
"RTN","EASMTL10",133,0)
 E  W !!?5,"Letters queued, [",ZTSK,"]"
"RTN","EASMTL10",134,0)
 D HOME^%ZIS
"RTN","EASMTL10",135,0)
 Q
"RTN","EASMTL10",136,0)
 ;
"RTN","EASMTL10",137,0)
EN1 ;  Queued entry point for letter rerun
"RTN","EASMTL10",138,0)
 N EASIEN,EASABRT,EASTMP
"RTN","EASMTL10",139,0)
 ;
"RTN","EASMTL10",140,0)
 S EASTMP="^TMP(""EASRP"",$J)"
"RTN","EASMTL10",141,0)
 K @EASTMP
"RTN","EASMTL10",142,0)
 ;
"RTN","EASMTL10",143,0)
 I '$D(ZTQUEUED) W !,"...Gathering letters to re-print..."
"RTN","EASMTL10",144,0)
 D BLD(EATYP,EASLOC,EASDDD,EASTMP)
"RTN","EASMTL10",145,0)
 I '$D(ZTQUEUED),'$D(@EASTMP) D  Q
"RTN","EASMTL10",146,0)
 . W !?3,$CHAR(7),">> No letters found to reprint for these parameters.",!
"RTN","EASMTL10",147,0)
 D PRINT(EASTMP,EATYP)
"RTN","EASMTL10",148,0)
 K @EASTMP
"RTN","EASMTL10",149,0)
 Q
"RTN","EASMTL10",150,0)
 ;
"RTN","EASMTL10",151,0)
PRINT(EASTMP,EATYP) ;
"RTN","EASMTL10",152,0)
 N EASIEN,EASABRT
"RTN","EASMTL10",153,0)
 ;
"RTN","EASMTL10",154,0)
 U IO
"RTN","EASMTL10",155,0)
 S EASIEN=0
"RTN","EASMTL10",156,0)
 F  S EASIEN=$O(@EASTMP@(EASIEN)) Q:'EASIEN  D  Q:$G(EASABRT)
"RTN","EASMTL10",157,0)
 . D LETTER^EASMTL6A(EASIEN,EATYP)
"RTN","EASMTL10",158,0)
 . I '$D(IO("Q")),$E(IOST,1,2)="C-" D
"RTN","EASMTL10",159,0)
 . . S DIR(0)="E"
"RTN","EASMTL10",160,0)
 . . D ^DIR K DIR
"RTN","EASMTL10",161,0)
 . . S:'Y EASABRT=1
"RTN","EASMTL10",162,0)
 Q
"RTN","EASMTL10",163,0)
 ;
"RTN","EASMTL10",164,0)
BLD(EATYP,EASLOC,EASDDD,EASTMP) ;  Sort letters for processing date in groups by type
"RTN","EASMTL10",165,0)
 N EASIEN,EASPTR,DFN,EASLTR
"RTN","EASMTL10",166,0)
 ;
"RTN","EASMTL10",167,0)
 S EASIEN=0
"RTN","EASMTL10",168,0)
 F  S EASIEN=$O(^EAS(713.2,"AD",EASDDD,EASIEN)) Q:'EASIEN  D
"RTN","EASMTL10",169,0)
 . ; Begin Checks
"RTN","EASMTL10",170,0)
 . S EASPTR=$$GET1^DIQ(713.2,EASIEN,2,"I")
"RTN","EASMTL10",171,0)
 . S DFN=$$GET1^DIQ(713.1,EASPTR,.01,"I")
"RTN","EASMTL10",172,0)
 . ;; Filter by site, Quit if filter not met
"RTN","EASMTL10",173,0)
 . I +$G(EASLOC)>0 Q:$$GET1^DIQ(2,DFN,27.02,"I")'=+EASLOC
"RTN","EASMTL10",174,0)
 . Q:'$$THRSHLD^EASMTL6(EATYP,EASIEN)  ; Quit if letter threshold not met
"RTN","EASMTL10",175,0)
 . Q:$D(^EAS(713.2,"AC",1,EASIEN))  ; Quit if MT has been returned
"RTN","EASMTL10",176,0)
 . Q:$D(^EAS(713.1,"AP",1,EASPTR))  ; Quit if prohibit flag set
"RTN","EASMTL10",177,0)
 . Q:$$CHECKMT^EASMTUTL(EASPTR,EASIEN)  ; Quit if MT no longer required
"RTN","EASMTL10",178,0)
 . Q:$$FUTMT^EASMTUTL(EASIEN)  ; Quit if future MT on file
"RTN","EASMTL10",179,0)
 . Q:$$DECEASED^EASMTUTL(EASIEN)  ; Quit if patient deceased
"RTN","EASMTL10",180,0)
 . I $$CHKADR^EASMTL6A(EASPTR),EATYP'=3 Q
"RTN","EASMTL10",181,0)
 . S @EASTMP@(EASIEN)=EATYP
"RTN","EASMTL10",182,0)
 Q
"RTN","EASMTL10",183,0)
 ;
"RTN","EASMTL10",184,0)
SINGLE ;  Rerun a single letter
"RTN","EASMTL10",185,0)
 N Y,DIR,DIRUT,EASPTR,DFN,EASIEN,ZTSAVE,EASLOC,IOP,EAX,PRNOVRD
"RTN","EASMTL10",186,0)
 ;
"RTN","EASMTL10",187,0)
ASKPAT ;  Select patient to reprint a letter for
"RTN","EASMTL10",188,0)
 S DIR(0)="PAO^713.1:EMZ"
"RTN","EASMTL10",189,0)
 S DIR("A")="Select PATIENT: "
"RTN","EASMTL10",190,0)
 S DIR("?")="Select Patient Letter status entry to reprint"
"RTN","EASMTL10",191,0)
 D ^DIR K DIR
"RTN","EASMTL10",192,0)
 Q:$D(DIRUT)
"RTN","EASMTL10",193,0)
 S EASPTR=+Y ; Ptr to file 713.1
"RTN","EASMTL10",194,0)
 S DFN=+Y(0)
"RTN","EASMTL10",195,0)
 Q:'DFN
"RTN","EASMTL10",196,0)
 ;
"RTN","EASMTL10",197,0)
 I $D(^EAS(713.1,"AP",1,EASPTR)) D  Q
"RTN","EASMTL10",198,0)
 . W !!?4,$CHAR(7),"The Prohibit flag is set for this patient"
"RTN","EASMTL10",199,0)
 I $$DECEASED^EASMTUTL("",DFN) D  Q
"RTN","EASMTL10",200,0)
 . W !!?4,$CHAR(7),"Patient is deceased"
"RTN","EASMTL10",201,0)
 ;
"RTN","EASMTL10",202,0)
ASKLTR ;  Select LETTER STATUS file entry
"RTN","EASMTL10",203,0)
 S DIR(0)="P^713.2:EMZ"
"RTN","EASMTL10",204,0)
 S DIR("?",1)="Select Processing Date: "
"RTN","EASMTL10",205,0)
 S DIR("A")="Select the letter processing date for this patient"
"RTN","EASMTL10",206,0)
 S DIR("S")="I $P(^(0),U,2)=EASPTR" ; Set screen for selected patient
"RTN","EASMTL10",207,0)
 D ^DIR K DIR
"RTN","EASMTL10",208,0)
 Q:$D(DIRUT)
"RTN","EASMTL10",209,0)
 S EASIEN=+Y
"RTN","EASMTL10",210,0)
 ;
"RTN","EASMTL10",211,0)
 I $$GET1^DIQ(713.2,EASIEN,4,"I") D  Q
"RTN","EASMTL10",212,0)
 . W !!?4,$CHAR(7),"A Means Test has already been returned by this patient"
"RTN","EASMTL10",213,0)
 ;
"RTN","EASMTL10",214,0)
 I $$CHECKMT^EASMTUTL(EASPTR,EASIEN) D  Q
"RTN","EASMTL10",215,0)
 . W !!?4,$CHAR(7),"Patient's Means Test is no longer required"
"RTN","EASMTL10",216,0)
 ;
"RTN","EASMTL10",217,0)
ASKTYP ; Allow only letters already sent to be reprinted
"RTN","EASMTL10",218,0)
 N EASSC,EAX
"RTN","EASMTL10",219,0)
 ;
"RTN","EASMTL10",220,0)
 F EAX=6,4,"Z" D
"RTN","EASMTL10",221,0)
 . I $P(^EAS(713.2,EASIEN,EAX),U,3) D
"RTN","EASMTL10",222,0)
 . . I EAX=6 S EASSC=$G(EASSC)_"1:60-Day;"
"RTN","EASMTL10",223,0)
 . . I EAX=4 S EASSC=$G(EASSC)_"2:30-Day;"
"RTN","EASMTL10",224,0)
 . . I EAX="Z" S EASSC=$G(EASSC)_"4:0-Day"
"RTN","EASMTL10",225,0)
 I $G(EASSC)']""  D  Q
"RTN","EASMTL10",226,0)
 . W !!?4,$CHAR(7),"There are no letters to re-print for this patient"
"RTN","EASMTL10",227,0)
 ;
"RTN","EASMTL10",228,0)
 S DIR(0)="SO^"_EASSC,DIR("A")="Select letter type"
"RTN","EASMTL10",229,0)
 S DIR("?")="Select letter type to re-print"
"RTN","EASMTL10",230,0)
 D ^DIR K DIR
"RTN","EASMTL10",231,0)
 Q:$D(DIRUT)
"RTN","EASMTL10",232,0)
 S EATYP=+Y
"RTN","EASMTL10",233,0)
 ;
"RTN","EASMTL10",234,0)
QUE2 ;  Que off print letter
"RTN","EASMTL10",235,0)
 S ZTSAVE("EASIEN")="",ZTSAVE("EASPTR")="",ZTSAVE("EATYP")="",ZTSAVE("EASLOC")=""
"RTN","EASMTL10",236,0)
 D EN^XUTMDEVQ("EN2^EASMTL10","EAS MT RERUN SINGLE LETTER",.ZTSAVE)
"RTN","EASMTL10",237,0)
 Q
"RTN","EASMTL10",238,0)
 ;
"RTN","EASMTL10",239,0)
EN2 ;  Queued entry point to re-run a single letter
"RTN","EASMTL10",240,0)
 ;
"RTN","EASMTL10",241,0)
 D LETTER^EASMTL6A(EASIEN,EATYP)
"RTN","EASMTL10",242,0)
 Q
"RTN","EASMTL10",243,0)
 ;
"RTN","EASMTL10",244,0)
LIST ;  List last processing dates for the Letter Status file
"RTN","EASMTL10",245,0)
 N EAX
"RTN","EASMTL10",246,0)
 ;
"RTN","EASMTL10",247,0)
 W !!,"Available Processing Dates:"
"RTN","EASMTL10",248,0)
 S EAX=0
"RTN","EASMTL10",249,0)
 F  S EAX=$O(^EAS(713.2,"AD",EAX)) Q:'EAX  D
"RTN","EASMTL10",250,0)
 . W !?6,$$FMTE^XLFDT(EAX,"2D")
"RTN","EASMTL10",251,0)
 Q
"RTN","EASMTL10",252,0)
 ;
"RTN","EASMTL10",253,0)
NOTICE ;
"RTN","EASMTL10",254,0)
 ;;Means Test Letters are indexed by the date on which the MT Letter search 
"RTN","EASMTL10",255,0)
 ;;occurred and is dependent on the frequency the search job is run at your 
"RTN","EASMTL10",256,0)
 ;;site.  When you select the reprint date for a letter, the software will
"RTN","EASMTL10",257,0)
 ;;try to determine the appropriate search (processing) date required to print
"RTN","EASMTL10",258,0)
 ;;the desired letters.  If the letters printed are not the desired letters,
"RTN","EASMTL10",259,0)
 ;;you may need to try a later date.  
"RTN","EASMTL10",260,0)
 ;;
"RTN","EASMTL6A")
0^1^B21479527
"RTN","EASMTL6A",1,0)
EASMTL6A ; MIN/TCM ALB/SCK - AUTOMATED MEANS TEST LETTER-PRINT LETTERS CONT ; 3/10/03 4:07pm
"RTN","EASMTL6A",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**3,14,15,29,28**;MAR 15,2001
"RTN","EASMTL6A",3,0)
 ;
"RTN","EASMTL6A",4,0)
LETTER(EASN,TYPE) ;Print letter
"RTN","EASMTL6A",5,0)
 ; Input
"RTN","EASMTL6A",6,0)
 ;     EASN    - File #713.2 IEN
"RTN","EASMTL6A",7,0)
 ;     TYPE    - Letter type
"RTN","EASMTL6A",8,0)
 ;
"RTN","EASMTL6A",9,0)
 N DFN,EASADD,EASIN,EASNME,EALNE,EASFAC,MSG,TAB,EAFIEN,EAX,LINE,EASANV,EASX,VADM,VAROOT,OFFSET,EASPTR,EASLIEN,EASITE,EASRTE,EASDEM,POP
"RTN","EASMTL6A",10,0)
 ;
"RTN","EASMTL6A",11,0)
 S TAB=3 ; Tab spacing for letters
"RTN","EASMTL6A",12,0)
 S OFFSET=+$$GET1^DIQ(713,1,10) ; Get print offset for address
"RTN","EASMTL6A",13,0)
 ;
"RTN","EASMTL6A",14,0)
 ;  Get patient data for letter
"RTN","EASMTL6A",15,0)
 S EASPTR=$$GET1^DIQ(713.2,EASN,2,"I")
"RTN","EASMTL6A",16,0)
 I EASPTR]"" S DFN=$$GET1^DIQ(713.1,EASPTR,.01,"I")
"RTN","EASMTL6A",17,0)
 E  S DFN=-1
"RTN","EASMTL6A",18,0)
 ; Get patient mailing information
"RTN","EASMTL6A",19,0)
 D GETPAT(DFN,.EASDEM,.EASADD)
"RTN","EASMTL6A",20,0)
 ;  Get return address info
"RTN","EASMTL6A",21,0)
 D GETFAC^EASMTL6(DFN,.EASFAC)
"RTN","EASMTL6A",22,0)
 ;
"RTN","EASMTL6A",23,0)
 W @IOF
"RTN","EASMTL6A",24,0)
 I EASFAC(100)]"" D
"RTN","EASMTL6A",25,0)
 . W !!?TAB+OFFSET,EASFAC(100)
"RTN","EASMTL6A",26,0)
 E  D
"RTN","EASMTL6A",27,0)
 . W !!?TAB+OFFSET,"VA MEDICAL CENTER"
"RTN","EASMTL6A",28,0)
 W ?(IOM-10),$E(EASDEM(1),1,1),EASDEM(2)
"RTN","EASMTL6A",29,0)
 ;
"RTN","EASMTL6A",30,0)
 W !?TAB+OFFSET,EASFAC(1.01)
"RTN","EASMTL6A",31,0)
 I EASFAC(1.02)]"" W !?TAB+OFFSET,EASFAC(1.02)
"RTN","EASMTL6A",32,0)
 W !?TAB+OFFSET,EASFAC(1.03)_" "_$P(EASFAC(.02),U,2)_" "_EASFAC(1.04)
"RTN","EASMTL6A",33,0)
 W !!!?TAB+OFFSET,$$FMTE^XLFDT(DT,1)
"RTN","EASMTL6A",34,0)
 ;
"RTN","EASMTL6A",35,0)
 ;; generic test letter setup
"RTN","EASMTL6A",36,0)
 I DFN>0 D
"RTN","EASMTL6A",37,0)
 . S EASNME("FILE")=2,EASNME("IENS")=DFN,EASNME("FIELD")=.01
"RTN","EASMTL6A",38,0)
 . W !!!!?TAB+OFFSET,$$NAMEFMT^XLFNAME(.EASNME,"G")
"RTN","EASMTL6A",39,0)
 E  D
"RTN","EASMTL6A",40,0)
 . W !!!!?TAB+OFFSET,EASDEM(1)
"RTN","EASMTL6A",41,0)
 ;;
"RTN","EASMTL6A",42,0)
 W !?TAB+OFFSET,EASADD(1)
"RTN","EASMTL6A",43,0)
 ;
"RTN","EASMTL6A",44,0)
 I EASADD(2)]"" W !?TAB+OFFSET,EASADD(2)
"RTN","EASMTL6A",45,0)
 W !?TAB+OFFSET,EASADD(4)
"RTN","EASMTL6A",46,0)
 I +EASADD(5) W " ",$$GET1^DIQ(5,$P(EASADD(5),U),1)
"RTN","EASMTL6A",47,0)
 W " ",$P(EASADD(11),U,2)
"RTN","EASMTL6A",48,0)
 ;
"RTN","EASMTL6A",49,0)
 S EASANV=$$GET1^DIQ(713.2,EASN,3,"I")
"RTN","EASMTL6A",50,0)
 W !!!!,?TAB,"MEANS TEST ANNIVERSARY DATE: ",$$FMTE^XLFDT($$FMADD^XLFDT(EASANV,365))
"RTN","EASMTL6A",51,0)
 ;
"RTN","EASMTL6A",52,0)
 S EASX=$P(EASDEM(5),U)
"RTN","EASMTL6A",53,0)
 ;; Patch 15
"RTN","EASMTL6A",54,0)
 W !!,?TAB,"Dear ",$S(EASX="M":"Mr. ",EASX="F":"Ms. ",1:"Mr./Ms. ")
"RTN","EASMTL6A",55,0)
 W $S(DFN>0:$$NAMEFMT^XLFNAME(.EASNME,"O","M"),1:"TEST"),":"
"RTN","EASMTL6A",56,0)
 ;;
"RTN","EASMTL6A",57,0)
 ;  Print letter body
"RTN","EASMTL6A",58,0)
 S EASLIEN=$O(^EAS(713.3,"C",TYPE,0))
"RTN","EASMTL6A",59,0)
 Q:'EASLIEN
"RTN","EASMTL6A",60,0)
 S EALNE=0
"RTN","EASMTL6A",61,0)
 ;
"RTN","EASMTL6A",62,0)
 W !
"RTN","EASMTL6A",63,0)
 F  S EALNE=$O(^EAS(713.3,EASLIEN,1,EALNE)) Q:'EALNE  D
"RTN","EASMTL6A",64,0)
 . S LINE=^EAS(713.3,EASLIEN,1,EALNE,0)
"RTN","EASMTL6A",65,0)
 . I LINE["|ANNVDT|" W !?TAB,$P(LINE,"|ANNVDT|",1),$$FMTE^XLFDT($$FMADD^XLFDT(EASANV,365)),$P(LINE,"|ANNVDT|",2) Q
"RTN","EASMTL6A",66,0)
 . W !?TAB,LINE
"RTN","EASMTL6A",67,0)
 ;
"RTN","EASMTL6A",68,0)
 ; Retrieve division section of letter
"RTN","EASMTL6A",69,0)
 S EAFIEN=$O(^EAS(713.3,EASLIEN,2,"B",+EASFAC("FACNUM"),0))
"RTN","EASMTL6A",70,0)
 ;
"RTN","EASMTL6A",71,0)
 I 'EAFIEN D  ; Print default signature block
"RTN","EASMTL6A",72,0)
 . N EAX,LINE
"RTN","EASMTL6A",73,0)
 . F EAX=1:1:9  D
"RTN","EASMTL6A",74,0)
 . . S LINE=$P($T(DEFSIG+EAX),";;",2)
"RTN","EASMTL6A",75,0)
 . . I LINE["|FAC|" W !?TAB,$P(LINE,"|FAC|",1),$S(EASFAC(100)]"":EASFAC(100),1:"VA Medical Center"),$P(LINE,"|FAC|",2) Q
"RTN","EASMTL6A",76,0)
 . . W !?TAB,LINE
"RTN","EASMTL6A",77,0)
 ;
"RTN","EASMTL6A",78,0)
 I EAFIEN D  ; Print division/facility signature block
"RTN","EASMTL6A",79,0)
 . S EALNE=0
"RTN","EASMTL6A",80,0)
 . F  S EALNE=$O(^EAS(713.3,EASLIEN,2,EAFIEN,1,EALNE)) Q:'EALNE  D
"RTN","EASMTL6A",81,0)
 . . W !?TAB,^EAS(713.3,EASLIEN,2,EAFIEN,1,EALNE,0)
"RTN","EASMTL6A",82,0)
 ;
"RTN","EASMTL6A",83,0)
 W !!?TAB,"Enclosure"
"RTN","EASMTL6A",84,0)
 Q
"RTN","EASMTL6A",85,0)
 ;
"RTN","EASMTL6A",86,0)
GETPAT(DFN,EASDEM,EASADD) ; Get patient information
"RTN","EASMTL6A",87,0)
 N VAROOT,VA
"RTN","EASMTL6A",88,0)
 ;
"RTN","EASMTL6A",89,0)
 ;; Patch 15, Generic test letter
"RTN","EASMTL6A",90,0)
 I DFN<0 D  Q
"RTN","EASMTL6A",91,0)
 . S EASDEM(1)="TEST LETTER (DO NOT MAIL!)"
"RTN","EASMTL6A",92,0)
 . S EASDEM(2)="6789"
"RTN","EASMTL6A",93,0)
 . S EASDEM(5)="M"
"RTN","EASMTL6A",94,0)
 . S EASADD(1)="THIS IS A TEST LETTER STREET ADDRESS"
"RTN","EASMTL6A",95,0)
 . S EASADD(2)=""
"RTN","EASMTL6A",96,0)
 . S EASADD(4)="ANYTOWN"
"RTN","EASMTL6A",97,0)
 . S EASADD(5)="36^NEW YORK"
"RTN","EASMTL6A",98,0)
 . S EASADD(11)="111110000^11111-0000"
"RTN","EASMTL6A",99,0)
 ;; End patch 15
"RTN","EASMTL6A",100,0)
 ;
"RTN","EASMTL6A",101,0)
 S VAROOT="EASADD"
"RTN","EASMTL6A",102,0)
 D ADD^VADPT
"RTN","EASMTL6A",103,0)
 ;
"RTN","EASMTL6A",104,0)
 S VAROOT="EASDEM"
"RTN","EASMTL6A",105,0)
 D DEM^VADPT
"RTN","EASMTL6A",106,0)
 ;
"RTN","EASMTL6A",107,0)
 D PID^VADPT6
"RTN","EASMTL6A",108,0)
 S EASDEM(2)=VA("BID")
"RTN","EASMTL6A",109,0)
 Q
"RTN","EASMTL6A",110,0)
 ;
"RTN","EASMTL6A",111,0)
CHKADR(EASPTR) ; Check for valid address
"RTN","EASMTL6A",112,0)
 N EASADD,RSLT,DFN,VAROOT
"RTN","EASMTL6A",113,0)
 ;
"RTN","EASMTL6A",114,0)
 S DFN=$$GET1^DIQ(713.1,EASPTR,.01,"I")
"RTN","EASMTL6A",115,0)
 S RSLT=1
"RTN","EASMTL6A",116,0)
 S VAROOT="EASADD"
"RTN","EASMTL6A",117,0)
 D ADD^VADPT
"RTN","EASMTL6A",118,0)
 ;; Check for valid mailing address
"RTN","EASMTL6A",119,0)
 I EASADD(1)]"",EASADD(4)]"",EASADD(5)]"",EASADD(11)]"" S RSLT=0
"RTN","EASMTL6A",120,0)
 ;; Check for Bad Address Indicator
"RTN","EASMTL6A",121,0)
 S EASADD("BAI")=$$BADADR^DGUTL3(DFN),$P(EASADD("BAI"),U,2)=$$EXTERNAL^DILFD(2,.121,"",+EASADD("BAI"))
"RTN","EASMTL6A",122,0)
 S:'RSLT&(EASADD("BAI")) RSLT=1
"RTN","EASMTL6A",123,0)
 D:RSLT ADRERR^EASMTUTL(.EASADD,DFN)
"RTN","EASMTL6A",124,0)
 Q $G(RSLT)
"RTN","EASMTL6A",125,0)
 ;
"RTN","EASMTL6A",126,0)
DEFSIG ; Default closing and signature block
"RTN","EASMTL6A",127,0)
 ;;Thank you for your assistance and cooperation.  If you have any
"RTN","EASMTL6A",128,0)
 ;;questions or need assistance in the completion of the information
"RTN","EASMTL6A",129,0)
 ;;requested, please contact the |FAC| Business 
"RTN","EASMTL6A",130,0)
 ;;Office between 8:00am and 4:00pm Monday through Friday.
"RTN","EASMTL6A",131,0)
 ;;
"RTN","EASMTL6A",132,0)
 ;;Sincerely,
"RTN","EASMTL6A",133,0)
 ;;
"RTN","EASMTL6A",134,0)
 ;;
"RTN","EASMTL6A",135,0)
 ;;
"RTN","EASSIGOV")
0^3^B18251406
"RTN","EASSIGOV",1,0)
EASSIGOV ; ALB/RTK - Means Test Signature summary report ; 1/29/02 11:33am ; 07/22/02 9:40am
"RTN","EASSIGOV",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**4,8,13,28**;Mar 15, 2001
"RTN","EASSIGOV",3,0)
 ;
"RTN","EASSIGOV",4,0)
 N YRSEL,SIGYES,SIGNO,SIGDEL,SIGNUL,CHKDT,MTIEN,MTSIG,NOW,SITE,CATA,CATC,PENDA,GMT
"RTN","EASSIGOV",5,0)
 S NOW=$P($$NOW^XLFDT,"."),SITE=$P($$SITE^VASITE,"^",3)
"RTN","EASSIGOV",6,0)
 S (SIGYES,SIGNO,SIGDEL,SIGNUL)=0
"RTN","EASSIGOV",7,0)
 N DIR S DIR("A")="Please select income year",DIR(0)="SM^A:PREVIOUS INCOME YEAR;B:CURRENT INCOME YEAR;C:NEXT INCOME YEAR",DIR("B")="B"
"RTN","EASSIGOV",8,0)
 D ^DIR S YRSEL=Y G END:$D(DTOUT)!($D(DUOUT))
"RTN","EASSIGOV",9,0)
 D DEVSEL
"RTN","EASSIGOV",10,0)
END Q
"RTN","EASSIGOV",11,0)
EN W:$E(IOST,1)="C" @IOF
"RTN","EASSIGOV",12,0)
 S (CATA,CATC,PENDA,GMT)=""
"RTN","EASSIGOV",13,0)
 S CATA=$O(^DG(408.32,"B","MT COPAY EXEMPT",CATA))
"RTN","EASSIGOV",14,0)
 S CATC=$O(^DG(408.32,"B","MT COPAY REQUIRED",CATC))
"RTN","EASSIGOV",15,0)
 S PENDA=$O(^DG(408.32,"B","PENDING ADJUDICATION",PENDA))
"RTN","EASSIGOV",16,0)
 S GMT=$O(^DG(408.32,"B","GMT COPAY REQUIRED",GMT))
"RTN","EASSIGOV",17,0)
 ;Set start date:
"RTN","EASSIGOV",18,0)
 S CHKDT=$S(YRSEL="A":($E(NOW,1,3)-1)_"0100",YRSEL="B":$E(NOW,1,3)_"1232",YRSEL="C":($E(NOW,1,3)+1)_"1232",1:""),DISPDT=CHKDT
"RTN","EASSIGOV",19,0)
 I YRSEL="A" D PASTYR
"RTN","EASSIGOV",20,0)
 I YRSEL'="A" D OTHERYR
"RTN","EASSIGOV",21,0)
 Q
"RTN","EASSIGOV",22,0)
PASTYR F  S CHKDT=$O(^DGMT(408.31,"B",CHKDT)) Q:$E(CHKDT,1,3)=($E(DISPDT,1,3)+1)  D
"RTN","EASSIGOV",23,0)
 .S MTIEN="" F  S MTIEN=$O(^DGMT(408.31,"B",CHKDT,MTIEN)) Q:+MTIEN=0  D
"RTN","EASSIGOV",24,0)
 ..;Is test primary?
"RTN","EASSIGOV",25,0)
 ..I $G(^DGMT(408.31,MTIEN,"PRIM"))'=1 Q
"RTN","EASSIGOV",26,0)
 ..;Is test from this site?
"RTN","EASSIGOV",27,0)
 ..I +$P($G(^DGMT(408.31,MTIEN,2)),"^",5)'=SITE Q
"RTN","EASSIGOV",28,0)
 ..;If not a Means Test, ignore
"RTN","EASSIGOV",29,0)
 ..I $P($G(^DGMT(408.31,MTIEN,0)),"^",19)'=1 Q
"RTN","EASSIGOV",30,0)
 ..;Check category
"RTN","EASSIGOV",31,0)
 ..S CAT=$P(^DGMT(408.31,MTIEN,0),"^",3) I CAT'=CATA,CAT'=CATC,CAT'=PENDA,CAT'=GMT Q
"RTN","EASSIGOV",32,0)
 ..S MTSIG=$P(^DGMT(408.31,MTIEN,0),"^",29)
"RTN","EASSIGOV",33,0)
 ..;Set counters
"RTN","EASSIGOV",34,0)
 ..I MTSIG=1 S SIGYES=SIGYES+1 Q
"RTN","EASSIGOV",35,0)
 ..I MTSIG=0 S SIGNO=SIGNO+1 Q
"RTN","EASSIGOV",36,0)
 ..I MTSIG=9 S SIGDEL=SIGDEL+1 Q
"RTN","EASSIGOV",37,0)
 ..I MTSIG="" S SIGNUL=SIGNUL+1
"RTN","EASSIGOV",38,0)
 D PRINT
"RTN","EASSIGOV",39,0)
 Q
"RTN","EASSIGOV",40,0)
OTHERYR F  S CHKDT=$O(^DGMT(408.31,"B",CHKDT),-1) Q:$E(CHKDT,1,3)=($E(DISPDT,1,3)-1)  D
"RTN","EASSIGOV",41,0)
 .S MTIEN="" F  S MTIEN=$O(^DGMT(408.31,"B",CHKDT,MTIEN)) Q:+MTIEN=0  D
"RTN","EASSIGOV",42,0)
 ..;Is test primary?
"RTN","EASSIGOV",43,0)
 ..I $G(^DGMT(408.31,MTIEN,"PRIM"))'=1 Q
"RTN","EASSIGOV",44,0)
 ..;Is test from this site?
"RTN","EASSIGOV",45,0)
 ..I +$P($G(^DGMT(408.31,MTIEN,2)),"^",5)'=SITE Q
"RTN","EASSIGOV",46,0)
 ..;If not a Means Test, ignore
"RTN","EASSIGOV",47,0)
 ..I $P($G(^DGMT(408.31,MTIEN,0)),"^",19)'=1 Q
"RTN","EASSIGOV",48,0)
 ..;Check category
"RTN","EASSIGOV",49,0)
 ..S CAT=$P(^DGMT(408.31,MTIEN,0),"^",3) I CAT'=CATA,CAT'=CATC,CAT'=PENDA,CAT'=GMT Q
"RTN","EASSIGOV",50,0)
 ..S MTSIG=$P(^DGMT(408.31,MTIEN,0),"^",29)
"RTN","EASSIGOV",51,0)
 ..;Set counters
"RTN","EASSIGOV",52,0)
 ..I MTSIG=1 S SIGYES=SIGYES+1 Q
"RTN","EASSIGOV",53,0)
 ..I MTSIG=0 S SIGNO=SIGNO+1 Q
"RTN","EASSIGOV",54,0)
 ..I MTSIG=9 S SIGDEL=SIGDEL+1 Q
"RTN","EASSIGOV",55,0)
 ..I MTSIG="" S SIGNUL=SIGNUL+1
"RTN","EASSIGOV",56,0)
 D PRINT
"RTN","EASSIGOV",57,0)
 Q
"RTN","EASSIGOV",58,0)
PRINT ;
"RTN","EASSIGOV",59,0)
 U IO
"RTN","EASSIGOV",60,0)
 W !,?2,"The purpose of this report is to help sites monitor the Means Test images"
"RTN","EASSIGOV",61,0)
 W !?2,"returned to them by the HEC.  The report only shows signature indicators"
"RTN","EASSIGOV",62,0)
 W !?2,"for MTs that were submitted by the local site (which may or may not be"
"RTN","EASSIGOV",63,0)
 W !?2,"designated as the primary site).  It does NOT take into account that the"
"RTN","EASSIGOV",64,0)
 W !?2,"HEC may already have a signature on file for the vet as sent from a"
"RTN","EASSIGOV",65,0)
 W !?2,"different, primary site."
"RTN","EASSIGOV",66,0)
 W !!,?2,"Means Test Signature Data for Income Year ",$E(DISPDT,1,3)+1699,":",!
"RTN","EASSIGOV",67,0)
 W !,?2,"Local Site Means Test with Signature Indicator = YES",?60,SIGYES
"RTN","EASSIGOV",68,0)
 W !,?2,"Local Site Means Test with Signature Indicator = NO",?60,SIGNO
"RTN","EASSIGOV",69,0)
 W !,?2,"Local Site Means Test with Signature Indicator = DELETED",?60,SIGDEL
"RTN","EASSIGOV",70,0)
 W !,?2,"Local Site Means Test with Signature Indicator = NULL",?60,SIGNUL
"RTN","EASSIGOV",71,0)
 W ! F I=1:1:80 W "_"
"RTN","EASSIGOV",72,0)
 W !,?50,"Total",?60,(SIGYES+SIGNO+SIGDEL+SIGNUL)
"RTN","EASSIGOV",73,0)
 D ^%ZISC
"RTN","EASSIGOV",74,0)
 Q
"RTN","EASSIGOV",75,0)
DEVSEL ;Select IO Device
"RTN","EASSIGOV",76,0)
 K DIRUT
"RTN","EASSIGOV",77,0)
 S %ZIS="Q" D ^%ZIS
"RTN","EASSIGOV",78,0)
 I POP W !!?5,"Report cancelled!" D ^%ZISC Q
"RTN","EASSIGOV",79,0)
 I $D(IO("Q")) D QUEUE Q
"RTN","EASSIGOV",80,0)
 D EN
"RTN","EASSIGOV",81,0)
 Q
"RTN","EASSIGOV",82,0)
QUEUE ;
"RTN","EASSIGOV",83,0)
 S ZTRTN="EN^EASSIGOV",ZTDESC="MT Signature Summary Rpt"
"RTN","EASSIGOV",84,0)
 S (ZTSAVE("YRSEL"),ZTSAVE("NOW"),ZTSAVE("SIGNO"),ZTSAVE("SIGNUL"),ZTSAVE("SIGYES"),ZTSAVE("SIGDEL"),ZTSAVE("SITE"))=""
"RTN","EASSIGOV",85,0)
 D ^%ZTLOAD
"RTN","EASSIGOV",86,0)
 I $D(ZTSK)[0 W !!?5,"Report cancelled!"
"RTN","EASSIGOV",87,0)
 E  W !!?5,"Report queued!"
"RTN","EASSIGOV",88,0)
 D HOME^%ZIS Q
"VER")
8.0^22
**END**
**END**
