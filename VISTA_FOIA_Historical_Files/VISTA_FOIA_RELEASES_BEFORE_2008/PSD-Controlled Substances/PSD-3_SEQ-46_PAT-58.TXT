$TXT Created by SMITH,ROBERT J at INPCACHE.FO-BIRM.MED.VA.GOV  (KIDS) on Thursday, 05/12/05 at 13:54
=============================================================================
Run Date: JUL 07, 2005                     Designation: PSD*3*58
Package : PSD - CONTROLLED SUBSTANCES         Priority: Mandatory
Version : 3        SEQ #46                      Status: Released
                  Compliance Date: AUG 07, 2005
=============================================================================


Subject: INACTIVE NAOU FLAG FOR CONTROLLED SUBSTANCE ORDERS NOT OBSERVED

Category: 
  - Routine

Description:
============

 This patch will correct the problem of allowing users to select an
 inactive NAOU if the user does not hold the PSJ RNURSE key when using 
 CS Order Entry For Ward [PSD ORDER ENTRY] option and 
 Infusion or PCA Syringe Order Entry For Patient [PSD NURSE INFUSION] 
 Option.
  
 ASSOCIATED NOIS:
 ================
 HD68941 - SPO-0205-51381   How to stop ordering cs drugs for inactivated NAOU
  
 ASSOCIATED E3RS:
 ================
 N/A
  
 PARTICIPATING TEST SITES
 ========================
 CENTRAL TEXAS HCS
 PITTSBURGH HCS
 VA GREATER LOS ANGELES HCS
 Spokane, WA
  
 NOIS OVERVIEW:
 ==============
 1) HD68941 - SPO-0205-51381  How to stop ordering cs drugs for inactivated NAOU
  
 Problem:
 --------
 The site is reporting that users are allowed to select inactive NAOU's.
 If the user holds the PSJ RPHARM or PSJ PHARM TECH keys, then the PSDORP
 routine is called.  PSDORP does NOT do the same filtering for inactive
 NAOU's or Drugs as PSDORN uses.  When the user holds the PSJ RNURSE key,
 processing remains in PSDORN routine and the screening for inactive NAOU's
 works properly.
  
 Resolution:
 -----------
 To correct this problem, the lookup screening logic within PSDORN routine
 will be added to PSDORP routine.
  
 Technical:
 ----------
  Routine: PSDORP
 * OLD *   ;;3.0; CONTROLLED SUBSTANCES ;;13 Feb 97
 * NEW *   ;;3.0; CONTROLLED SUBSTANCES ;**58**;13 Feb 97
 * ADD *   ;; RJS - PSD*3.0*58
 * OLD *   K DA,DIC S DIC=58.8,DIC(0)="QEA",DIC("A")="Select Ordering NAOU: ",DIC("S")="I $P(^(0),""^"",3)=+PSDSITE,$P(^(0),""^"",2)=""N"""
 * NEW *   K DA,DIC S DIC=58.8,DIC(0)="QEA",DIC("A")="Select Ordering NAOU: "
 * ADD *   S DIC("S")="I $P(^(0),""^"",3)=+PSDSITE,$S('$D(^(""I"")):1,'^(""I""):1,+^(""I"")>DT:1,1:0),$P(^(0),""^"",2)=""N"",'$P(^(0),""^"",7)"
 * ADD *   S DIC("S")="I '$P($G(^(7)),U,2),$S('$P(^(0),""^"",14):1,+$P(^(0),""^"",14)>DT:1,1:0)"
  
 ROUTINE SUMMARY:
 ================
 The following is a list of the routine(s) included in this patch.  The
 second line of each of these routine(s) will look like:
  
           ;;3.0; CONTROLLED SUBSTANCES ;**[Patch List]**;13 Feb 97
  
                             CHECK^XTSUMBLD results
 Routine name      Before Patch          After Patch         Patch List
 ============      ============          ===========         ==========
 PSDORP                13916576             14239224         58
  
 INSTALLATION INSTRUCTIONS
 =========================
 This patch should be installed during non-peak times, and users should not be
 on the Controlled Substances package. Installation will take less than 2 
 minutes.
  
  1.  Choose the PackMan message containing this patch and invoke the
      INSTALL/CHECK MESSAGE PackMan option.
  
  2.  (DSM for Open VMS sites only) Disable routine mapping on all systems
      for the routines listed in the Routine Summary.
  
      NOTE:  If the routines included in this patch are not currently
      in your mapped routine set, please skip this step.
  
  3.  Start up the Kernel Installation and Distribution System Menu
      [XPD MAIN]:
  
           Edits and Distribution ...
           Utilities ...
           Installation ...
  
     Select Kernel Installation & Distribution System Option: INStallation
           Load a Distribution
           Print Transport Global
           Compare Transport Global to Current System
           Verify Checksums in Transport Global
           Install Package(s)
           Restart Install of Package(s)
           Unload a Distribution
           Backup a Transport Global
  
  4.  From this menu, you may elect to use the following options
      (when prompted for the INSTALL NAME, enter PSD*3.0*58):
  
      a.  Backup a Transport Global - This option will create a backup
          message of any routines exported with this patch. It will not
          backup any other changes such as DD's or templates.
      b.  Compare Transport Global to Current System - This option will
          allow you to view all changes that will be made when this patch
          is installed.  It compares all components of this patch
          (routines, DD's, templates, etc.).
      c.  Verify Checksums in Transport Global - This option will allow
          you to ensure the integrity of the routines that are in the
          transport global.
  
  5.  Use the Install Package(s) option and select the package PSD*3.0*58.
  
    a.  When prompted 'Want KIDS to INHIBIT LOGONs during the install?
        YES//', answer NO.
    b.  When prompted 'Want to DISABLE Scheduled Options, Menu Options,
        and Protocols? YES//', answer NO.
 
  6.  (DSM for Open VMS sites only) Optional - Include the routines
      distributed with this patch in the mapped routine set.
  
      NOTE: This step is only necessary if you performed step 2 or if
      you wish to include the routines in your mapped set.
 
 INSTALLATION EXAMPLE:
 ====================
 Enter the Device you want to print the Install messages.
 You can queue the install by enter a 'Q' at the device prompt.
 Enter a '^' to abort the install.
 
 DEVICE: HOME//   TCP
 
 
 
                                    PSD*3.0*58                                   
 --------------------------------------------------------------------------------
  
  Install Started for PSD*3.0*58 : 
                Jul 06, 2005@13:51:46
  
 Build Distribution Date: May 12, 2005
  
  Installing Routines:
                Jul 06, 2005@13:51:46
  
  Updating Routine file...
  
  Updating KIDS files...
  
  PSD*3.0*58 Installed. 
                Jul 06, 2005@13:51:46
  
  Install Message sent #46968
 
 --------------------------------------------------------------------------------
           +------------------------------------------------------------+
   100%    |             25             50             75               |
 Complete  +------------------------------------------------------------+
 

Routine Information:
====================

Routine Name:
  - PSDORP


Routine Checksum:

=============================================================================
User Information:
Entered By  : SMITH,ROBERT J                Date Entered  : MAR 28, 2005
Completed By: ANDERSON,MAXINE               Date Completed: JUL 06, 2005
Released By : VECE,VIRGINIA                 Date Released : JUL 07, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
