Released DG*5.3*493 SEQ #430
Extracted from mail message
**KIDS**:DG*5.3*493^

**INSTALL NAME**
DG*5.3*493
"BLD",3806,0)
DG*5.3*493^REGISTRATION^0^3030113^y
"BLD",3806,4,0)
^9.64PA^^
"BLD",3806,"ABPKG")
n
"BLD",3806,"KRN",0)
^9.67PA^8989.52^19
"BLD",3806,"KRN",.4,0)
.4
"BLD",3806,"KRN",.401,0)
.401
"BLD",3806,"KRN",.402,0)
.402
"BLD",3806,"KRN",.403,0)
.403
"BLD",3806,"KRN",.5,0)
.5
"BLD",3806,"KRN",.84,0)
.84
"BLD",3806,"KRN",3.6,0)
3.6
"BLD",3806,"KRN",3.8,0)
3.8
"BLD",3806,"KRN",9.2,0)
9.2
"BLD",3806,"KRN",9.8,0)
9.8
"BLD",3806,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",3806,"KRN",9.8,"NM",1,0)
DGPTFVC1^^0^B34531738
"BLD",3806,"KRN",9.8,"NM","B","DGPTFVC1",1)

"BLD",3806,"KRN",19,0)
19
"BLD",3806,"KRN",19.1,0)
19.1
"BLD",3806,"KRN",101,0)
101
"BLD",3806,"KRN",409.61,0)
409.61
"BLD",3806,"KRN",771,0)
771
"BLD",3806,"KRN",870,0)
870
"BLD",3806,"KRN",8989.51,0)
8989.51
"BLD",3806,"KRN",8989.52,0)
8989.52
"BLD",3806,"KRN",8994,0)
8994
"BLD",3806,"KRN","B",.4,.4)

"BLD",3806,"KRN","B",.401,.401)

"BLD",3806,"KRN","B",.402,.402)

"BLD",3806,"KRN","B",.403,.403)

"BLD",3806,"KRN","B",.5,.5)

"BLD",3806,"KRN","B",.84,.84)

"BLD",3806,"KRN","B",3.6,3.6)

"BLD",3806,"KRN","B",3.8,3.8)

"BLD",3806,"KRN","B",9.2,9.2)

"BLD",3806,"KRN","B",9.8,9.8)

"BLD",3806,"KRN","B",19,19)

"BLD",3806,"KRN","B",19.1,19.1)

"BLD",3806,"KRN","B",101,101)

"BLD",3806,"KRN","B",409.61,409.61)

"BLD",3806,"KRN","B",771,771)

"BLD",3806,"KRN","B",870,870)

"BLD",3806,"KRN","B",8989.51,8989.51)

"BLD",3806,"KRN","B",8989.52,8989.52)

"BLD",3806,"KRN","B",8994,8994)

"BLD",3806,"QUES",0)
^9.62^^
"BLD",3806,"REQB",0)
^9.611^1^1
"BLD",3806,"REQB",1,0)
DG*5.3*415^2
"BLD",3806,"REQB","B","DG*5.3*415",1)

"MBREQ")
0
"PKG",114,-1)
1^1
"PKG",114,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",114,20,0)
^9.402P^^
"PKG",114,22,0)
^9.49I^1^1
"PKG",114,22,1,0)
5.3^2930813^2930821
"PKG",114,22,1,"PAH",1,0)
493^3030113
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGPTFVC1")
0^1^B34531738
"RTN","DGPTFVC1",1,0)
DGPTFVC1 ;ALB/AS - Expanded PTF Close-Out Edits ; Jul 20 88 @ 0900
"RTN","DGPTFVC1",2,0)
 ;;5.3;Registration;**52,58,79,114,164,400,342,466,415,493**;Aug 13, 1993
"RTN","DGPTFVC1",3,0)
 ;Called from Q+2^DGPTFTR. Variable must be passed in: PTF
"RTN","DGPTFVC1",4,0)
 ;Variable returned: DGERR.   DGERR <-- 1 if record fails to pass a check; DGERR <-- "" if record passes all checks
"RTN","DGPTFVC1",5,0)
 ;
"RTN","DGPTFVC1",6,0)
 Q:'$D(PTF)
"RTN","DGPTFVC1",7,0)
 S DGERR="",DGV(701)=$S($D(^DGPT(PTF,70)):^(70),1:""),DGV(101)=^(0),DGSUFFIX=$P(DGV(101),"^",5),DGV("FEE")=$P(DGV(101),"^",4),DFN=$P(DGV(101),"^",1)
"RTN","DGPTFVC1",8,0)
 ;
"RTN","DGPTFVC1",9,0)
 I $P(DGV(101),"^",2)>2820700 D AO
"RTN","DGPTFVC1",10,0)
 ;
"RTN","DGPTFVC1",11,0)
 I DGRTY=1,DGV("FEE") D MT
"RTN","DGPTFVC1",12,0)
 ;
"RTN","DGPTFVC1",13,0)
 I 'DGV("FEE"),$P(DGV(101),"^",10)="U",'DGV(701)!(+DGV(701)>2890700) S DGERR=1 W !,"101 MEANS TEST",?23," value 'U' - not valid for discharges as of 7/1/1989",!?42,"per MAS VACO policy"
"RTN","DGPTFVC1",14,0)
 ;
"RTN","DGPTFVC1",15,0)
 I $D(^DPT(DFN,57)),$P(^(57),"^",4)>0 S S0=$P(^(57),"^",4),DGDX=$S(S0=1!(S0=3):"344.1",1:"344.0"),DGSCI="" F DGX=0:0 S DGX=$O(^DGPT(PTF,"M",DGX)) Q:DGX'>0  S DGNODE=^(DGX,0),DGSCI="" D SCI
"RTN","DGPTFVC1",16,0)
 ;
"RTN","DGPTFVC1",17,0)
 S DGDP="",DGDISPO=$P(DGV(701),"^",6),DGRECSUF=$P(DGV(701),"^",13)
"RTN","DGPTFVC1",18,0)
 I DGRTY=1 D
"RTN","DGPTFVC1",19,0)
 .S DGSTATYP=$S(DGDISPO=12!(DGDISPO=13):30,DGDISPO=10:42,DGDISPO=8:40,1:"")
"RTN","DGPTFVC1",20,0)
 .I DGSTATYP]"" D
"RTN","DGPTFVC1",21,0)
 ..D NUMACT^DGPTSUF(DGSTATYP)
"RTN","DGPTFVC1",22,0)
 ..I DGANUM>0 F I=1:1:DGANUM I DGSUFFIX=DGSUFNAM(I) D
"RTN","DGPTFVC1",23,0)
 ...I DGDISPO'=8 I DGRECSUF=DGSUFNAM(DGANUM) S DGDP=5 D DP
"RTN","DGPTFVC1",24,0)
 ...I DGDISPO=8 N DGANUM,DGSUFNAM D NUMACT^DGPTSUF(42) I DGRECSUF=DGSUFNAM(DGANUM) S DGDP=5 D DP
"RTN","DGPTFVC1",25,0)
 .K DGANUM,DGSTATYP,DGSUFNAM,I
"RTN","DGPTFVC1",26,0)
 ;
"RTN","DGPTFVC1",27,0)
 I DGRTY=1 S %=$P(DGV(701),"^",3) I %=4!(%=6)!(%=7) S DGDP="" D OP I $P(DGV(701),"^",5)=1 S DGERR=1 W !,"701 VA AUSPICES",?23," value inconsistent for discharge"
"RTN","DGPTFVC1",28,0)
 ;
"RTN","DGPTFVC1",29,0)
 ;I 'DGV("FEE") S %=$P(^DPT(DFN,0),"^",6),%=$S($D(^DIC(10,+%,0)):$P(^(0),"^",2),1:"") I '%!(%>7) S DGERR=1 W !,"701 RACE",?23," value " W:%']"" "blank" I %]"" W %," (invalid code)"
"RTN","DGPTFVC1",30,0)
 ;
"RTN","DGPTFVC1",31,0)
 ;If PRRTP treating specialty, must have valid PRRTP suffix
"RTN","DGPTFVC1",32,0)
 ;Fee records would not contain PRRTP specialties
"RTN","DGPTFVC1",33,0)
 I 'DGV("FEE"),"^25^26^27^28^29^38^39^"[(U_$P(DGV(701),U,2)_U) D
"RTN","DGPTFVC1",34,0)
 .I DGSUFFIX'="PA",(DGSUFFIX'="PB"),(DGSUFFIX'="PC"),(DGSUFFIX'="PD") D
"RTN","DGPTFVC1",35,0)
 ..S DGERR=1
"RTN","DGPTFVC1",36,0)
 ..W !,"101 SUFFIX",?23,"value must be set to a valid PRRTP suffix."
"RTN","DGPTFVC1",37,0)
 ;
"RTN","DGPTFVC1",38,0)
 D RACETHNC
"RTN","DGPTFVC1",39,0)
 K DGDISPO,DGRECSUF,DGV,DGDP,DGDX,DGSCI,DGSUFFIX,DGNODE,DGX,%,S0,I,X
"RTN","DGPTFVC1",40,0)
 I DGERR H 4
"RTN","DGPTFVC1",41,0)
 Q
"RTN","DGPTFVC1",42,0)
 ;
"RTN","DGPTFVC1",43,0)
SCI F X=5:1:15 I X#10 S:$E($P($G(^ICD9(+$P(DGNODE,"^",X),0)),"^"),1,5)=DGDX DGSCI=1 Q:DGSCI
"RTN","DGPTFVC1",44,0)
 I 'DGSCI S DGERR=1,%=$P(DGNODE,"^",10),X=$TR($$FMTE^XLFDT(%,"5DF")," ","0") W !,"501 ",X," SCI of ",S0,?23," requires an ICD Diagnosis code beginning with",!?12," or equal to ",DGDX
"RTN","DGPTFVC1",45,0)
 Q
"RTN","DGPTFVC1",46,0)
 ;
"RTN","DGPTFVC1",47,0)
MT S DGVMT=$P(DGV(101),"^",10),DGX=999 G DGX:DGVMT']"" I +$P(DGV(101),"^",2)<2860700!(DGSUFFIX="BU") S DGX="X" G DGX
"RTN","DGPTFVC1",48,0)
 ;S DGZEC=$S($D(^DPT(DFN,.36)):$P(^(.36),U,1),1:""),DGZEC=$S($D(^DIC(8,+DGZEC,0)):^(0),1:"") I $P(DGZEC,U,5)="N" S DGX="N" G DGX
"RTN","DGPTFVC1",49,0)
 S DGZEC=$P($G(^DGPT(PTF,101)),U,8),DGZEC=$S($D(^DIC(8,+DGZEC,0)):^(0),1:"") I $P(DGZEC,U,5)="N" S DGX="N" G DGX
"RTN","DGPTFVC1",50,0)
 S DGT=$P(DGV(701),".") G AS:'$O(^DGMT(408.31,"AD",1,DFN,0)) S DGZ1=$$LST^DGMTU(DFN,DGT) K:DGZ1']"" DGZ1
"RTN","DGPTFVC1",51,0)
 I DGVMT="X" K DGX,DGVMT Q
"RTN","DGPTFVC1",52,0)
 S DGX=$S('$D(DGZ1):"U",1:$P(DGZ1,U,4))
"RTN","DGPTFVC1",53,0)
 ; Determine if the Pending Adjudication is for MT(C) or GMT(G)
"RTN","DGPTFVC1",54,0)
 I DGX="P" D  G DGX
"RTN","DGPTFVC1",55,0)
 . I '+$P($G(DGZ1),U) S DGX="U" Q
"RTN","DGPTFVC1",56,0)
 . S DGX=$$PA^DGMTUTL($P(DGZ1,U)),DGX=$S('$D(DGX):"U",DGX="MT":"C",DGX="GMT":"G",1:"U")
"RTN","DGPTFVC1",57,0)
 S DGX=$S(DGX="A":"AN","BCGN"[DGX:DGX,1:"U") G DGX:DGX'="N"
"RTN","DGPTFVC1",58,0)
AS S DGZ=$S($D(^DPT(DFN,.321)):^(.321),1:0) I $P(DGZ,U,2)="Y"!($P(DGZ,U,3)="Y") S DGX="AS" G DGX
"RTN","DGPTFVC1",59,0)
 S DGZ=$S($D(^DPT(DFN,.322)):^(.322),1:0) I $P(DGZ,U,13)="Y" S DGX="AS" G DGX
"RTN","DGPTFVC1",60,0)
 N DGNTARR S DGZ=$S($$GETCUR^DGNTAPI(DFN,"DGNTARR")>0:DGNTARR("NTR"),1:"") I $P(DGZ,U)="Y" S DGX="AS" G DGX
"RTN","DGPTFVC1",61,0)
 S DGZ=$$GETSTAT^DGMSTAPI(DFN) I $P(DGZ,U,2)="Y" S DGX="AS" G DGX
"RTN","DGPTFVC1",62,0)
 I $P(DGZEC,U,5)="Y",$P(DGZEC,U,4)<4,"^2^15^"'[(U_$P(DGZEC,U,9)_U) S DGX="AS" G DGX
"RTN","DGPTFVC1",63,0)
 S DGX="AN"
"RTN","DGPTFVC1",64,0)
DGX I DGVMT'=DGX S DGERR=1 W !,"101 ","MEANS TEST",?23," value ",DGVMT,$S(DGVMT']"":"blank",DGVMT="X":" only for admissions prior to 7/1/86 or domicilliary use",1:" inconsistent with eligibility data")
"RTN","DGPTFVC1",65,0)
 K DGZEC,DGZ,DGZ1,DGT,DGX,DGVMT Q
"RTN","DGPTFVC1",66,0)
 ;
"RTN","DGPTFVC1",67,0)
DP I $P(DGV(701),"^",3)'=5 S DGERR=1 W !,"701 ",$E("TYPE OF DISPOSITION",1,18),?23," value inconsistent for discharge"
"RTN","DGPTFVC1",68,0)
OP I $P(DGV(701),"^",4)=1 S DGERR=1 W !,"701 ",$E("OUTPATIENT TREATMENT",1,18),?23," value inconsistent for discharge" Q:DGDP=""
"RTN","DGPTFVC1",69,0)
 I $P(DGV(701),"^",5)=2 S DGERR=1 W !,"701 VA AUSPICES",?23," value inconsistent for discharge"
"RTN","DGPTFVC1",70,0)
 Q
"RTN","DGPTFVC1",71,0)
 ;
"RTN","DGPTFVC1",72,0)
AO I DGPTFMT<2 D  Q
"RTN","DGPTFVC1",73,0)
 .S %=$S($D(^DGPT(PTF,101)):$P(^(101),"^",4),1:"")
"RTN","DGPTFVC1",74,0)
 .S %=$S($D(^DIC(45.82,+%,0)):$P(^(0),"^",1),1:"")
"RTN","DGPTFVC1",75,0)
 .S I=$S($D(^DPT(DFN,.321)):^(.321),1:"")
"RTN","DGPTFVC1",76,0)
 .S:$P(I,"^",2)="Y"&(%'=6) DGERR=1,DGV("E")=1
"RTN","DGPTFVC1",77,0)
 .W:$D(DGV("E")) !,"101 AGENT ORANGE",?23," value ",$S(DGV("E"):"can only be used with COB of '6'",1:"is inconsistent with Vietnam Service and/or COB")
"RTN","DGPTFVC1",78,0)
 ;
"RTN","DGPTFVC1",79,0)
 N AO,AOL,TMP
"RTN","DGPTFVC1",80,0)
 S TMP=$G(^DPT(DFN,.321))
"RTN","DGPTFVC1",81,0)
 S AO=$S($P(TMP,"^",2)="Y":1,1:0)
"RTN","DGPTFVC1",82,0)
 S AOL=$P(TMP,"^",13)
"RTN","DGPTFVC1",83,0)
 Q:('AO)
"RTN","DGPTFVC1",84,0)
 Q:(AOL'="")
"RTN","DGPTFVC1",85,0)
 S DGERR=1,DGV("E")=1
"RTN","DGPTFVC1",86,0)
 W !,"101 AGENT ORANGE LOCATION",?23,"value required if exposure to Agent Orange claimed"
"RTN","DGPTFVC1",87,0)
 Q
"RTN","DGPTFVC1",88,0)
RACETHNC        ;Race and ethnicity check
"RTN","DGPTFVC1",89,0)
 ;Ensure that a value for ethnicity and at least one race is on file.
"RTN","DGPTFVC1",90,0)
 ;Ensure all active race/ethnicity values have a valid PTF value and an
"RTN","DGPTFVC1",91,0)
 ;associated collection method.  Ensure all collection methods have a
"RTN","DGPTFVC1",92,0)
 ;valid PTF value.  Ignore race/ethicity entries that are inactive or
"RTN","DGPTFVC1",93,0)
 ;invalid pointers.  Note: PTF sends first active ethnicity and first
"RTN","DGPTFVC1",94,0)
 ;six active races.
"RTN","DGPTFVC1",95,0)
 N REF,IEN,TYPE,TEXT,PTRVAL,PTRMTHD,NUM,MAX
"RTN","DGPTFVC1",96,0)
 N VALIDVAL,VALIDMTH,VALUE,VADM
"RTN","DGPTFVC1",97,0)
 D DEM^VADPT
"RTN","DGPTFVC1",98,0)
 F REF=11,12 D
"RTN","DGPTFVC1",99,0)
 .I REF=12 D
"RTN","DGPTFVC1",100,0)
 ..S MAX=6
"RTN","DGPTFVC1",101,0)
 ..S TYPE=1
"RTN","DGPTFVC1",102,0)
 ..S VALIDVAL=",3,8,9,A,B,C,D,"
"RTN","DGPTFVC1",103,0)
 ..S VALIDMTH=",S,P,O,U,"
"RTN","DGPTFVC1",104,0)
 ..S TEXT="RACE"
"RTN","DGPTFVC1",105,0)
 .I REF=11 D
"RTN","DGPTFVC1",106,0)
 ..S MAX=1
"RTN","DGPTFVC1",107,0)
 ..S TYPE=2
"RTN","DGPTFVC1",108,0)
 ..S TEXT="ETHNICITY"
"RTN","DGPTFVC1",109,0)
 ..S VALIDVAL=",H,N,D,U,"
"RTN","DGPTFVC1",110,0)
 ..S VALIDMTH=",S,P,O,U,"
"RTN","DGPTFVC1",111,0)
 .S NUM=1
"RTN","DGPTFVC1",112,0)
 .S IEN=0
"RTN","DGPTFVC1",113,0)
 .F  S IEN=+$O(VADM(REF,IEN)) Q:'IEN  D  Q:NUM>MAX
"RTN","DGPTFVC1",114,0)
 ..S PTRVAL=+VADM(REF,IEN)
"RTN","DGPTFVC1",115,0)
 ..S PTRMTHD=+$G(VADM(REF,IEN,1))
"RTN","DGPTFVC1",116,0)
 ..Q:'PTRVAL
"RTN","DGPTFVC1",117,0)
 ..Q:$$INACTIVE^DGUTL4(PTRVAL,TYPE)
"RTN","DGPTFVC1",118,0)
 ..S NUM=NUM+1
"RTN","DGPTFVC1",119,0)
 ..S VALUE=$$PTR2CODE^DGUTL4(PTRVAL,TYPE,4)
"RTN","DGPTFVC1",120,0)
 ..I (VALUE="")!(VALIDVAL'[VALUE) D  Q
"RTN","DGPTFVC1",121,0)
 ...W !,"701 ",TEXT,?23,"missing/invalid xmit value"
"RTN","DGPTFVC1",122,0)
 ...S DGERR=1
"RTN","DGPTFVC1",123,0)
 ..I ('PTRMTHD) D  Q
"RTN","DGPTFVC1",124,0)
 ...W !,"701 ",TEXT,?23,"method of collection missing/invalid"
"RTN","DGPTFVC1",125,0)
 ...S DGERR=1
"RTN","DGPTFVC1",126,0)
 ..S VALUE=$$PTR2CODE^DGUTL4(PTRMTHD,3,4)
"RTN","DGPTFVC1",127,0)
 ..I (VALUE="")!(VALIDMTH'[VALUE) D  Q
"RTN","DGPTFVC1",128,0)
 ...W !,"701 ",TEXT,?23,"missing/invalid xmit value for method of collection"
"RTN","DGPTFVC1",129,0)
 ...S DGERR=1
"RTN","DGPTFVC1",130,0)
 Q
"VER")
8.0^22.0
**END**
**END**
