Released PRCA*4.5*231 SEQ #213
Extracted from mail message
**KIDS**:PRCA*4.5*231^

**INSTALL NAME**
PRCA*4.5*231
"BLD",6238,0)
PRCA*4.5*231^ACCOUNTS RECEIVABLE^0^3060131^y
"BLD",6238,1,0)
^^4^4^3060131^
"BLD",6238,1,1,0)
This patch addresses 1 issue. This change will allow the Revenue Source 
"BLD",6238,1,2,0)
code to contain alphanumeric characters as well as numbers in any of the
"BLD",6238,1,3,0)
four positions.  The code is entered using the Enter/Edit Revenue Source
"BLD",6238,1,4,0)
Code [PRCA FMS RSC ENTER/EDIT] option.
"BLD",6238,4,0)
^9.64PA^430^2
"BLD",6238,4,347.3,0)
347.3
"BLD",6238,4,347.3,2,0)
^9.641^347.3^1
"BLD",6238,4,347.3,2,347.3,0)
REVENUE SOURCE CODE  (File-top level)
"BLD",6238,4,347.3,2,347.3,1,0)
^9.6411^.01^1
"BLD",6238,4,347.3,2,347.3,1,.01,0)
SOURCE CODE
"BLD",6238,4,347.3,222)
y^n^p^^^^n^^n
"BLD",6238,4,347.3,224)

"BLD",6238,4,430,0)
430
"BLD",6238,4,430,2,0)
^9.641^430^1
"BLD",6238,4,430,2,430,0)
ACCOUNTS RECEIVABLE  (File-top level)
"BLD",6238,4,430,2,430,1,0)
^9.6411^255^1
"BLD",6238,4,430,2,430,1,255,0)
REVENUE SOURCE
"BLD",6238,4,430,222)
y^n^p^^^^n^^n
"BLD",6238,4,430,224)

"BLD",6238,4,"APDD",347.3,347.3)

"BLD",6238,4,"APDD",347.3,347.3,.01)

"BLD",6238,4,"APDD",430,430)

"BLD",6238,4,"APDD",430,430,255)

"BLD",6238,4,"B",347.3,347.3)

"BLD",6238,4,"B",430,430)

"BLD",6238,"KRN",0)
^9.67PA^8989.52^19
"BLD",6238,"KRN",.4,0)
.4
"BLD",6238,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",6238,"KRN",.4,"NM",1,0)
PRCA DISP AUDIT2    FILE #430^430^0
"BLD",6238,"KRN",.4,"NM","B","PRCA DISP AUDIT2    FILE #430",1)

"BLD",6238,"KRN",.401,0)
.401
"BLD",6238,"KRN",.402,0)
.402
"BLD",6238,"KRN",.403,0)
.403
"BLD",6238,"KRN",.5,0)
.5
"BLD",6238,"KRN",.84,0)
.84
"BLD",6238,"KRN",3.6,0)
3.6
"BLD",6238,"KRN",3.8,0)
3.8
"BLD",6238,"KRN",9.2,0)
9.2
"BLD",6238,"KRN",9.8,0)
9.8
"BLD",6238,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",6238,"KRN",9.8,"NM",1,0)
PRCAFUT^^0^B40349439
"BLD",6238,"KRN",9.8,"NM",2,0)
RCXFMSUR^^0^B53268142
"BLD",6238,"KRN",9.8,"NM","B","PRCAFUT",1)

"BLD",6238,"KRN",9.8,"NM","B","RCXFMSUR",2)

"BLD",6238,"KRN",19,0)
19
"BLD",6238,"KRN",19.1,0)
19.1
"BLD",6238,"KRN",101,0)
101
"BLD",6238,"KRN",409.61,0)
409.61
"BLD",6238,"KRN",771,0)
771
"BLD",6238,"KRN",870,0)
870
"BLD",6238,"KRN",8989.51,0)
8989.51
"BLD",6238,"KRN",8989.52,0)
8989.52
"BLD",6238,"KRN",8994,0)
8994
"BLD",6238,"KRN","B",.4,.4)

"BLD",6238,"KRN","B",.401,.401)

"BLD",6238,"KRN","B",.402,.402)

"BLD",6238,"KRN","B",.403,.403)

"BLD",6238,"KRN","B",.5,.5)

"BLD",6238,"KRN","B",.84,.84)

"BLD",6238,"KRN","B",3.6,3.6)

"BLD",6238,"KRN","B",3.8,3.8)

"BLD",6238,"KRN","B",9.2,9.2)

"BLD",6238,"KRN","B",9.8,9.8)

"BLD",6238,"KRN","B",19,19)

"BLD",6238,"KRN","B",19.1,19.1)

"BLD",6238,"KRN","B",101,101)

"BLD",6238,"KRN","B",409.61,409.61)

"BLD",6238,"KRN","B",771,771)

"BLD",6238,"KRN","B",870,870)

"BLD",6238,"KRN","B",8989.51,8989.51)

"BLD",6238,"KRN","B",8989.52,8989.52)

"BLD",6238,"KRN","B",8994,8994)

"BLD",6238,"QUES",0)
^9.62^^
"BLD",6238,"REQB",0)
^9.611^1^1
"BLD",6238,"REQB",1,0)
PRCA*4.5*220^2
"BLD",6238,"REQB","B","PRCA*4.5*220",1)

"FIA",347.3)
REVENUE SOURCE CODE
"FIA",347.3,0)
^RC(347.3,
"FIA",347.3,0,0)
347.3I
"FIA",347.3,0,1)
y^n^p^^^^n^^n
"FIA",347.3,0,10)

"FIA",347.3,0,11)

"FIA",347.3,0,"RLRO")

"FIA",347.3,0,"VR")
4.5^PRCA
"FIA",347.3,347.3)
1
"FIA",347.3,347.3,.01)

"FIA",430)
ACCOUNTS RECEIVABLE
"FIA",430,0)
^PRCA(430,
"FIA",430,0,0)
430I
"FIA",430,0,1)
y^n^p^^^^n^^n
"FIA",430,0,10)

"FIA",430,0,11)

"FIA",430,0,"RLRO")

"FIA",430,0,"VR")
4.5^PRCA
"FIA",430,430)
1
"FIA",430,430,255)

"KRN",.4,1472,-1)
0^1
"KRN",.4,1472,0)
PRCA DISP AUDIT2^3051110.1651^^430^^^3060130
"KRN",.4,1472,"DXS",1,9.2)
S I(0,0)=$G(D0),DIP(2)=$S($D(^PRCA(430,D0,0)):^(0),1:"") S X="DEBTOR : ",DIP(1)=$G(X),DIP(3)=$G(X),D0=$P(DIP(2),U,9) S:'D0!'$D(^RCD(340,+D0,0)) D0=-1
"KRN",.4,1472,"DXS",2,9.2)
S I(0,0)=$G(D0),DIP(1)=$S($D(^PRCA(430,D0,0)):^(0),1:""),D0=$P(DIP(1),U,9) S:'D0!'$D(^RCD(340,+D0,0)) D0=-1 S DIP(102)=$C(59)_$P($G(^DD(340,.05,0)),U,3)
"KRN",.4,1472,"F",1)
S X="=",DIP(1)=$G(X) S X=80,X1=DIP(1) S %=X,X="" S:X1]"" $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("=",80)"~
"KRN",.4,1472,"F",2)
S DIP(2)=$S($D(^PRCA(430,D0,0)):^(0),1:"") S X="BILL # : ",DIP(1)=$G(X) S X=$P(DIP(2),U,1),Y=X,X=DIP(1),X=X_Y W X K DIP;C10;Z;""BILL # : "_(BILL NO.)"~
"KRN",.4,1472,"F",3)
X DXS(1,9.2) S DIP(101)=$S($D(^RCD(340,D0,0)):^(0),1:"") S X=$$EXTERNAL^DIDU(340,.01,"",$P(DIP(101),U,1)),Y=X,X=DIP(1),X=X_Y S D0=I(0,0) W X K DIP;C45;Z;""DEBTOR : "_(DEBTOR)"~
"KRN",.4,1472,"F",4)
"RECEIVABLE CODE : ";C36~
"KRN",.4,1472,"F",5)
X DXS(2,9.2) S DIP(101)=$S($D(^RCD(340,D0,0)):^(0),1:"") S X=$P($P(DIP(102),$C(59)_$P(DIP(101),U,5)_":",2),$C(59)) S D0=I(0,0) W X K DIP;Z;"9:.05"~
"KRN",.4,1472,"F",6)
"FISCAL YEAR";S1;C1~"FUND (APPROPRIATION)";C27~"ORIGINAL AMOUNT";C66~1,.01~
"KRN",.4,1472,"F",7)
1,S DIP(1)=$S($D(^PRCA(430,D0,11)):^(11),1:"") S X=$P(DIP(1),U,17) W X K DIP;C32;Z;"FUND"~1,7;C68;R9~
"KRN",.4,1472,"F",8)
S X="=",DIP(1)=$G(X) S X=80,X1=DIP(1) S %=X,X="" S:X1]"" $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("=",80)"~W !," ";Z;"W !," ""~
"KRN",.4,1472,"F",9)
"***  REFUND  ***";C32~"CONTROL POINT : ";S1;C1~250;X~"BUDGET OBJECT : ";S1;C1~253;X~"COST CENTER  : ";C44~251;X~"          SUB : ";C1~254;X~
"KRN",.4,1472,"F",10)
"              SUB : ";C39~252;X~
"KRN",.4,1472,"F",11)
S X="=",DIP(1)=$G(X) S X=80,X1=DIP(1) S %=X,X="" S:X1]"" $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("=",80)"~W !," ";Z;"W !," ""~
"KRN",.4,1472,"F",12)
"***  REIMBURSEMENT  ***";C28~"REVENUE SOURCE :";C1;S1~W $P($G(^PRCA(430,D0,11)),U,6);Z;"W $P($G(^PRCA(430,D0,11)),U,6)"~"SUB : ";C53~256;X~
"KRN",.4,1472,"H")
@
"KRN",.4,1472,"SUB")
1
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
231^3060131
"PKG",142,22,1,"PAH",1,1,0)
^^4^4^3060131
"PKG",142,22,1,"PAH",1,1,1,0)
This patch addresses 1 issue. This change will allow the Revenue Source 
"PKG",142,22,1,"PAH",1,1,2,0)
code to contain alphanumeric characters as well as numbers in any of the
"PKG",142,22,1,"PAH",1,1,3,0)
four positions.  The code is entered using the Enter/Edit Revenue Source
"PKG",142,22,1,"PAH",1,1,4,0)
Code [PRCA FMS RSC ENTER/EDIT] option.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PRCAFUT")
0^1^B40349439^B30486823
"RTN","PRCAFUT",1,0)
PRCAFUT ;WASH-ISC@ALTOONA/CLH-FMS Utilities ;10/8/96  10:50 AM
"RTN","PRCAFUT",2,0)
V ;;4.5;Accounts Receivable;**5,39,64,92,104,169,188,194,220,231**;Mar 20, 1995
"RTN","PRCAFUT",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCAFUT",4,0)
CPLK(PRCABN) ;get control point from file 430 and set DR string to edit CP data
"RTN","PRCAFUT",5,0)
 N DR,X,Y,QUIT,FUND,FTBL,CAT,CATTYP,CATTYPE,CP,BBFY,EBFY,DIC,BGFY,CPTBL,CC,SCC,EXIT,FYERROR
"RTN","PRCAFUT",6,0)
 K PRCA("EXIT")
"RTN","PRCAFUT",7,0)
 S PRCA("SITE")=$S($G(PRCABN):$P($P($G(^PRCA(430,PRCABN,0)),"^"),"-"),1:$$SITE^RCMSITE)
"RTN","PRCAFUT",8,0)
 S CP=$P($G(^PRCA(430,PRCABN,11)),U)
"RTN","PRCAFUT",9,0)
 S CAT=+$P($G(^PRCA(430,PRCABN,0)),U,2),CATTYP=$P($G(^PRCA(430.2,CAT,0)),U,13)
"RTN","PRCAFUT",10,0)
 I CAT>39,CAT<45 D  G END
"RTN","PRCAFUT",11,0)
    .S TYPE="09" D CHKELEM,REV Q:$G(PRCA("EXIT"))
"RTN","PRCAFUT",12,0)
    .S DR="257///^S X=$G(PRCA(""SITE""))"
"RTN","PRCAFUT",13,0)
    .;I CAT'=42 S DR=DR_";258////1"
"RTN","PRCAFUT",14,0)
    .D DIE
"RTN","PRCAFUT",15,0)
    .Q
"RTN","PRCAFUT",16,0)
 D TYPE Q:$D(PRCA("EXIT"))
"RTN","PRCAFUT",17,0)
 I CATTYP=2 K PRCA("EXIT") D  G END
"RTN","PRCAFUT",18,0)
  . ;reibursement logic (if there is such a thing)
"RTN","PRCAFUT",19,0)
  . S DR="203" D DIE K DR I $D(Y) Q
"RTN","PRCAFUT",20,0)
  . I '$D(FUND) S FUND=$P($G(^PRCA(430,PRCABN,11)),U,17) D  I FUND=-1 S PRCA("EXIT")="" Q
"RTN","PRCAFUT",21,0)
  .. N X,Y,DIC
"RTN","PRCAFUT",22,0)
  .. S X=FUND,DIC="^PRCD(420.14,",DIC(0)="XMNZ",DIC("B")=FUND D ^DIC
"RTN","PRCAFUT",23,0)
  .. I +Y<0 D FUND^PRCAFBDU D  Q:FUND=-1
"RTN","PRCAFUT",24,0)
  ... S DIC="^PRCD(420.14,",DIC(0)="AEMNQZ",DIC("A")="FUND: ",DIC("B")=FUND
"RTN","PRCAFUT",25,0)
  ... D ^DIC
"RTN","PRCAFUT",26,0)
  ... S:+Y<0 FUND=-1 Q
"RTN","PRCAFUT",27,0)
  .. S FUND=Y
"RTN","PRCAFUT",28,0)
  .. S BBFY=$E($P(Y(0),U,3),3,4),EBFY=$E($P(Y(0),U,4),3,4)
"RTN","PRCAFUT",29,0)
  ..Q
"RTN","PRCAFUT",30,0)
  .S PRCABN(1)=$O(^PRCA(430,+PRCABN,2,0))
"RTN","PRCAFUT",31,0)
  .S PRCABN(2)=$G(^PRCA(430,+PRCABN,2,PRCABN(1),0))
"RTN","PRCAFUT",32,0)
  .S PRCABN(4)=+$G(PRCABN(2))
"RTN","PRCAFUT",33,0)
  .S X=BBFY D ^%DT S PRCABN(3)=$E(Y,1,3)
"RTN","PRCAFUT",34,0)
  .K ^PRCA(430,PRCABN,2,PRCABN(1),0)
"RTN","PRCAFUT",35,0)
  .K ^PRCA(430,PRCABN,2,"B",PRCABN(4),PRCABN(1))
"RTN","PRCAFUT",36,0)
  .S ^PRCA(430,PRCABN,2,PRCABN(3),0)=PRCABN(2)
"RTN","PRCAFUT",37,0)
  .S $P(^PRCA(430,PRCABN,2,PRCABN(3),0),"^")=BBFY
"RTN","PRCAFUT",38,0)
  .S ^PRCA(430,PRCABN,2,"B",BBFY,PRCABN(3))=""
"RTN","PRCAFUT",39,0)
  .D DOCREQ^PRC0C(+FUND,"REV","FTBL")
"RTN","PRCAFUT",40,0)
  . I '$D(FTBL) S PRCA("EXIT")=1 D  Q
"RTN","PRCAFUT",41,0)
  .. W !,*7,"FMS REQUIRED FIELDS missing.  Edit the IFCAP REQUIRED FIELDS table",!,"for FUND/FY combination."
"RTN","PRCAFUT",42,0)
  .. Q
"RTN","PRCAFUT",43,0)
  . S DR="259////^S X=CAT;257////^S X=$G(PRCA(""SITE""));201////^S X=BBFY;202////^S X=$S($G(EBFY)'=BBFY:EBFY,1:"""")"
"RTN","PRCAFUT",44,0)
  . D DR
"RTN","PRCAFUT",45,0)
  . Q
"RTN","PRCAFUT",46,0)
 ;Ask Beginning/end budget fiscal year
"RTN","PRCAFUT",47,0)
 D FY^PRCAFUT1
"RTN","PRCAFUT",48,0)
 I $D(FYERROR) S PRCA("EXIT")=1 Q
"RTN","PRCAFUT",49,0)
 ;S BGFY=$P(^PRCA(430,PRCABN,0),U,10),BGFY=$$FY^RCFN01(BGFY)
"RTN","PRCAFUT",50,0)
 S DR="250;I '$D(CPTBL) D CPTBL^PRCAFUT;259////^S X=CAT;204////^S X=$P(CPTBL,U);206////^S X=$P(CPTBL,U,3)"
"RTN","PRCAFUT",51,0)
 S DR=DR_";203////^S X=$P(CPTBL,U,5);201////^S X=$E($P(CPTBL,U,6),3,4)"
"RTN","PRCAFUT",52,0)
 S DR(1,430,1)="202////^S X=$S($P(CPTBL,U,7)'=$P(CPTBL,U,6):$E($P(CPTBL,U,7),3,4),1:"""")"
"RTN","PRCAFUT",53,0)
 S DR(1,430,2)="261////^S X=$P(CPTBL,U,10)"
"RTN","PRCAFUT",54,0)
 S DA=PRCABN D ^DIE K DR
"RTN","PRCAFUT",55,0)
 I $D(Y) S PRCA("EXIT")=1 Q
"RTN","PRCAFUT",56,0)
 K DR
"RTN","PRCAFUT",57,0)
 D FTBL Q:'$D(FTBL)
"RTN","PRCAFUT",58,0)
 S (X,PRCABN(1))=$E($P(CPTBL,U,6),3,4)
"RTN","PRCAFUT",59,0)
 D ^%DT S PRCABN(2)=$E(Y,1,3)
"RTN","PRCAFUT",60,0)
 S PRCABN(3)=$O(^PRCA(430,+PRCABN,2,0))
"RTN","PRCAFUT",61,0)
 S PRCABN(4)=$G(^PRCA(430,+PRCABN,2,PRCABN(3),0))
"RTN","PRCAFUT",62,0)
 S PRCABN(5)=$E(PRCABN(4),1,2)
"RTN","PRCAFUT",63,0)
 K ^PRCA(430,PRCABN,2,PRCABN(3),0)
"RTN","PRCAFUT",64,0)
 K ^PRCA(430,PRCABN,2,"B",PRCABN(5),PRCABN(3))
"RTN","PRCAFUT",65,0)
 S ^PRCA(430,PRCABN,2,PRCABN(2),0)=PRCABN(4)
"RTN","PRCAFUT",66,0)
 S $P(^PRCA(430,PRCABN,2,PRCABN(2),0),"^")=PRCABN(1)
"RTN","PRCAFUT",67,0)
 S ^PRCA(430,PRCABN,2,"B",PRCABN(1),PRCABN(2))=""
"RTN","PRCAFUT",68,0)
 S $P(^PRCA(430,PRCABN,2,0),"^",3)=PRCABN(2)
"RTN","PRCAFUT",69,0)
 Q
"RTN","PRCAFUT",70,0)
FTBL S FUND=$$FUND^PRC0C($P(CPTBL,U,5),$P(CPTBL,U,6))
"RTN","PRCAFUT",71,0)
 D DOCREQ^PRC0C(+FUND,"SPE","FTBL")
"RTN","PRCAFUT",72,0)
 I '$D(FTBL) W !!,*7,"UNABLE TO GET FMS-LINE FUND ACCOUNTING INFORMATION.  CHECK CONTROL POINT." H 5 S PRCA("EXIT")=1 Q
"RTN","PRCAFUT",73,0)
 S DR="257////^S X=$G(PRCA(""SITE""))"
"RTN","PRCAFUT",74,0)
DR I $$INTEG^RCFN01($G(PRCA("SITE"))) S DR=DR_";260"
"RTN","PRCAFUT",75,0)
 I $G(FTBL("AO"))="Y" S DR=DR_";204"
"RTN","PRCAFUT",76,0)
 I $G(FTBL("FCPRJ"))="Y" S DR=DR_";I '$D(CPTBL) D CPTBL^PRCAFUT;206////^S X=$P(CPTBL,U,3)"
"RTN","PRCAFUT",77,0)
 I $G(FTBL("CC"))="Y"            S DR=DR_";251;252////^S X=$G(SCC)"
"RTN","PRCAFUT",78,0)
 I $G(FTBL("BOC"))="Y"           S DR=DR_";253"
"RTN","PRCAFUT",79,0)
 I $G(FTBL("SBOC"))="Y"!(CAT=20) S DR=DR_";254"
"RTN","PRCAFUT",80,0)
 I $G(FTBL("JOB"))="Y"           S DR=DR_";261"
"RTN","PRCAFUT",81,0)
 I $G(FTBL("RC"))="Y"            S DR=DR_";263"
"RTN","PRCAFUT",82,0)
 I $G(FTBL("REV"))="Y"           D DIE Q:$G(PRCA("EXIT"))  D REV Q:$G(PRCA("EXIT"))
"RTN","PRCAFUT",83,0)
 I $G(FTBL("SREV"))="Y"          S DR=$S(DR="":"256",1:DR_";256")
"RTN","PRCAFUT",84,0)
 I $G(FTBL("OC"))="Y"            S DR=$S(DR="":"205",1:DR_";205")
"RTN","PRCAFUT",85,0)
 I DR'="" D DIE
"RTN","PRCAFUT",86,0)
 Q
"RTN","PRCAFUT",87,0)
DIE S DA=PRCABN,DIE="^PRCA(430," D ^DIE
"RTN","PRCAFUT",88,0)
END I $D(Y) S PRCA("EXIT")=1
"RTN","PRCAFUT",89,0)
 K DR Q
"RTN","PRCAFUT",90,0)
 ;
"RTN","PRCAFUT",91,0)
RECTYP(BN) ;Refund or reimbursement
"RTN","PRCAFUT",92,0)
 I '$D(BN),'$D(^PRCA(430,BN,0)) Q -1
"RTN","PRCAFUT",93,0)
 Q $P($G(^PRCA(430,BN,11)),U,10)
"RTN","PRCAFUT",94,0)
 ;
"RTN","PRCAFUT",95,0)
REV ;lookup revenue by calling "C" xref
"RTN","PRCAFUT",96,0)
 N DS,DIC,DIBTDH,HELP,I,IAT,OUT,RV,X,Y
"RTN","PRCAFUT",97,0)
 S OUT=0,RV=$P($G(^PRCA(430,PRCABN,11)),U,6)
"RTN","PRCAFUT",98,0)
 F  D  Q:OUT
"RTN","PRCAFUT",99,0)
 .W !,"REVENUE SOURCE: "_$S(RV'="":RV_"// ",1:"") R X:DTIME
"RTN","PRCAFUT",100,0)
 .I $E(X)="?",X?."?" D @($S($L(X)=1:"REVH1",1:"REVH2")) S DIC=347.3,DIC(0)="QE" D ^DIC Q:Y<1  Q
"RTN","PRCAFUT",101,0)
 .I $E(X)="^",X?."^" S OUT=1,PRCA("EXIT")=1 Q
"RTN","PRCAFUT",102,0)
 .I X="@" W "??  Required" Q
"RTN","PRCAFUT",103,0)
 .I X="",RV'="" S OUT=1 Q
"RTN","PRCAFUT",104,0)
 .I X="",RV="" W "??" D REVH1 Q
"RTN","PRCAFUT",105,0)
 .I $D(^RC(347.3,"B",X)) D  Q
"RTN","PRCAFUT",106,0)
 ..S DS=$P($G(^RC(347.3,+$O(^RC(347.3,"B",X,0)),0)),U,2),IAT=$P(^(0),U,3)
"RTN","PRCAFUT",107,0)
 ..W "       "_DS W:IAT "         INACTIVE" D REVDIE
"RTN","PRCAFUT",108,0)
 .S DIC="^RC(347.3,",DIC(0)="QE",D="C" D IX^DIC I Y<1 D REVH1 Q
"RTN","PRCAFUT",109,0)
 .S X=$P(Y,U,2) D REVDIE
"RTN","PRCAFUT",110,0)
 S DR=""
"RTN","PRCAFUT",111,0)
 Q
"RTN","PRCAFUT",112,0)
REVDIE S DA=PRCABN,DIE="^PRCA(430,",DR="255///"_X D ^DIE I $G(X)'="" S OUT=1 Q
"RTN","PRCAFUT",113,0)
 D REVH1 Q
"RTN","PRCAFUT",114,0)
REVH1 S HELP("DIHELP",1)=$G(^DD(430,255,3)) D MSG^DIALOG("WH","",70,5,"HELP") Q
"RTN","PRCAFUT",115,0)
REVH2 D HELP^DIE(430,"",255,"D","HELP"),MSG^DIALOG("WH","",70,8,"HELP") Q
"RTN","PRCAFUT",116,0)
 ;
"RTN","PRCAFUT",117,0)
FUND ;get fund
"RTN","PRCAFUT",118,0)
 N DIC,Y
"RTN","PRCAFUT",119,0)
 S DIC="^PRCD(420.14,",DIC(0)="EMNQZ"
"RTN","PRCAFUT",120,0)
 D ^DIC
"RTN","PRCAFUT",121,0)
 I $D(DUOUT)!$D(DTOUT) S PRCA("EXIT")=1 Q
"RTN","PRCAFUT",122,0)
 Q:+Y<0
"RTN","PRCAFUT",123,0)
 S FUND=Y
"RTN","PRCAFUT",124,0)
 S BBFY=$E($P(Y(0),U,3),3,4),EBFY=$E($P(Y(0),U,4),3,4)
"RTN","PRCAFUT",125,0)
 Q
"RTN","PRCAFUT",126,0)
 ;
"RTN","PRCAFUT",127,0)
DISPLACC ;display account information
"RTN","PRCAFUT",128,0)
 Q:'$D(PRCABN)  NEW DIC,L,FR,TO,FLDS,IOP,X
"RTN","PRCAFUT",129,0)
 R !!,"Press <RETURN> to continue: ",X:60
"RTN","PRCAFUT",130,0)
 I X["^" S PRCA("EXIT")="" Q
"RTN","PRCAFUT",131,0)
 S IOP=IO(0),DIC="^PRCA(430,",FLDS="[PRCA DISP AUDIT2]",(FR,TO)=PRCABN,L=0,BY="@NUMBER" D EN1^DIP
"RTN","PRCAFUT",132,0)
 Q
"RTN","PRCAFUT",133,0)
 ;
"RTN","PRCAFUT",134,0)
CP ;lookup control point
"RTN","PRCAFUT",135,0)
 N DIC
"RTN","PRCAFUT",136,0)
 S DIC="^PRC(420,"_$S($D(PRCA("SITE")):PRCA("SITE"),1:$$SITE^RCMSITE)_",1,",DIC(0)="EMNQ",X=CP
"RTN","PRCAFUT",137,0)
 D ^DIC
"RTN","PRCAFUT",138,0)
 I +Y<0 K X,CP Q
"RTN","PRCAFUT",139,0)
 S CP=+Y
"RTN","PRCAFUT",140,0)
 Q
"RTN","PRCAFUT",141,0)
 ;
"RTN","PRCAFUT",142,0)
CC ;cost center
"RTN","PRCAFUT",143,0)
 G CC^PRCAFBDU
"RTN","PRCAFUT",144,0)
 ;
"RTN","PRCAFUT",145,0)
BOC ;budget object code
"RTN","PRCAFUT",146,0)
 G BOC^PRCAFBDU
"RTN","PRCAFUT",147,0)
 ;
"RTN","PRCAFUT",148,0)
TYPE ;ask if bill is a refund or reimbursement
"RTN","PRCAFUT",149,0)
 W !!,"Building FMS Accounting Elements...",!
"RTN","PRCAFUT",150,0)
 N DIR,Y,TYPE
"RTN","PRCAFUT",151,0)
 I +$G(CAT)=1 S CAT="02",CATTYPE=2 D CHKELEM Q
"RTN","PRCAFUT",152,0)
 I +$G(CAT)=10 S CAT=50,CATTYPE=2 D CHKELEM Q
"RTN","PRCAFUT",153,0)
 D BDTRANS^PRCAFBDU
"RTN","PRCAFUT",154,0)
 Q:$D(PRCA("EXIT"))
"RTN","PRCAFUT",155,0)
 S CATTYP=$S(TYPE="01":"1",TYPE="20":"1",1:"2")
"RTN","PRCAFUT",156,0)
 S CAT=TYPE ; I CAT>2 S CAT=$S(CAT=4:"20",1:"9")
"RTN","PRCAFUT",157,0)
 D CHKELEM
"RTN","PRCAFUT",158,0)
 Q
"RTN","PRCAFUT",159,0)
 ;
"RTN","PRCAFUT",160,0)
CHKELEM ;check for correct accounting line data
"RTN","PRCAFUT",161,0)
 N I
"RTN","PRCAFUT",162,0)
 Q:'$D(^PRCA(430,PRCABN,11))
"RTN","PRCAFUT",163,0)
 I $G(CATTYP)=1 D  Q
"RTN","PRCAFUT",164,0)
  . F I=6,7 S $P(^PRCA(430,PRCABN,11),U,I)=""
"RTN","PRCAFUT",165,0)
  . Q
"RTN","PRCAFUT",166,0)
 Q:$G(TYPE)=10
"RTN","PRCAFUT",167,0)
 F I=1:1:5,11:1:16,18:1:21 S $P(^PRCA(430,PRCABN,11),U,I)=""
"RTN","PRCAFUT",168,0)
 S $P(^PRCA(430,PRCABN,11),U,15)="05"
"RTN","PRCAFUT",169,0)
 Q
"RTN","PRCAFUT",170,0)
CPTBL ;build CP table
"RTN","PRCAFUT",171,0)
 S:'$D(BGFY) BGFY=$$FY^RCFN01(DT)
"RTN","PRCAFUT",172,0)
 S BGFY(1)=$S(BGFY>50:19,1:20)
"RTN","PRCAFUT",173,0)
 S CPTBL=$$ACC^PRC0C($G(PRCA("SITE")),+CP_U_BGFY_U_BGFY(1)_BGFY)
"RTN","PRCAFUT",174,0)
 I '$D(CPTBL) S CPTBL=""
"RTN","PRCAFUT",175,0)
 Q
"RTN","PRCAFUT",176,0)
 ;
"RTN","PRCAFUT",177,0)
CPHLP ;executable help for cp prompt
"RTN","PRCAFUT",178,0)
 N DIC,X,Y
"RTN","PRCAFUT",179,0)
 S DIC="^PRC(420,"_$S($D(PRCA("SITE")):PRCA("SITE"),1:$$SITE^RCMSITE)_",1,",DIC(0)="EMQ",X="?" D ^DIC
"RTN","PRCAFUT",180,0)
 Q
"RTN","PRCAFUT",181,0)
 ;
"RTN","PRCAFUT",182,0)
FND(BILL) ;Get fund for a bill
"RTN","PRCAFUT",183,0)
 I '$D(^PRCA(430,BILL,0)) Q -1
"RTN","PRCAFUT",184,0)
 I $D(^PRCA(430,BILL,11)),$P(^(11),"^",17)'="" Q $P(^(11),"^",17)
"RTN","PRCAFUT",185,0)
 I $P(^PRCA(430,BILL,0),"^",18)'="" Q $E($P(^(0),"^",18),4,9)
"RTN","PRCAFUT",186,0)
 Q -1
"RTN","PRCAFUT",187,0)
 ;
"RTN","RCXFMSUR")
0^2^B53268142^B46524145
"RTN","RCXFMSUR",1,0)
RCXFMSUR ;WISC/RFJ-revenue source codes ;1 Oct 97
"RTN","RCXFMSUR",2,0)
 ;;4.5;Accounts Receivable;**90,101,170,203,173,220,231**;Mar 20, 1995
"RTN","RCXFMSUR",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCXFMSUR",4,0)
 Q
"RTN","RCXFMSUR",5,0)
 ;
"RTN","RCXFMSUR",6,0)
 ;
"RTN","RCXFMSUR",7,0)
CALCRSC(BILLDA,RCEFT) ;  calculate the revenue source code for a bill
"RTN","RCXFMSUR",8,0)
 ;  rceft = 1 if processing an EFT deposit
"RTN","RCXFMSUR",9,0)
 ;  returns the 4 column (character) rsc
"RTN","RCXFMSUR",10,0)
 N CATEGDA,COLUMN1,COLUMN2,COLUMN3,COLUMN4,RSC
"RTN","RCXFMSUR",11,0)
 ;  if rsc already calculated, return it
"RTN","RCXFMSUR",12,0)
 I $G(RCEFT)=1 S RSC="8NZZ" Q RSC
"RTN","RCXFMSUR",13,0)
 S RSC=$P($G(^PRCA(430,BILLDA,11)),"^",23)
"RTN","RCXFMSUR",14,0)
 I $L(RSC)=4,RSC'="ARRV" Q RSC
"RTN","RCXFMSUR",15,0)
 ;
"RTN","RCXFMSUR",16,0)
 ;  calculate it and store it
"RTN","RCXFMSUR",17,0)
 S CATEGDA=+$P($G(^PRCA(430,BILLDA,0)),"^",2)
"RTN","RCXFMSUR",18,0)
 ;
"RTN","RCXFMSUR",19,0)
 ;  if prepayment, send ARRV
"RTN","RCXFMSUR",20,0)
 I CATEGDA=26 D STORE(BILLDA,"ARRV") Q "ARRV"
"RTN","RCXFMSUR",21,0)
 ;
"RTN","RCXFMSUR",22,0)
 S COLUMN1=$$COLUMN1
"RTN","RCXFMSUR",23,0)
 S COLUMN2=$$COLUMN2
"RTN","RCXFMSUR",24,0)
 ;
"RTN","RCXFMSUR",25,0)
 ;  if column2 cannot be determined, return the rsc of ARRV
"RTN","RCXFMSUR",26,0)
 I COLUMN2="" D STORE(BILLDA,"ARRV") Q "ARRV"
"RTN","RCXFMSUR",27,0)
 ;
"RTN","RCXFMSUR",28,0)
 ;  if column2 is not a 5 for reimbursable health insurance,
"RTN","RCXFMSUR",29,0)
 ;  return ZZ in columns 3 and 4
"RTN","RCXFMSUR",30,0)
 I COLUMN2'=5 D STORE(BILLDA,COLUMN1_COLUMN2_"ZZ") Q COLUMN1_COLUMN2_"ZZ"
"RTN","RCXFMSUR",31,0)
 ;
"RTN","RCXFMSUR",32,0)
 ;  for reimbursable health insurance, compute columns 3 and 4
"RTN","RCXFMSUR",33,0)
 S COLUMN3=$$COLUMN3
"RTN","RCXFMSUR",34,0)
 S COLUMN4=$$COLUMN4
"RTN","RCXFMSUR",35,0)
 ;
"RTN","RCXFMSUR",36,0)
 D STORE(BILLDA,COLUMN1_COLUMN2_COLUMN3_COLUMN4)
"RTN","RCXFMSUR",37,0)
 Q COLUMN1_COLUMN2_COLUMN3_COLUMN4
"RTN","RCXFMSUR",38,0)
 ;
"RTN","RCXFMSUR",39,0)
 ;
"RTN","RCXFMSUR",40,0)
STORE(DA,RSC,FUND) ;  store the revenue source code  or fund in the file
"RTN","RCXFMSUR",41,0)
 I $G(^PRCA(430,DA,0))="" Q
"RTN","RCXFMSUR",42,0)
 N D,D0,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RCXFMSUR",43,0)
 S DR=""
"RTN","RCXFMSUR",44,0)
 I $G(RSC)'="" S DR="255.1////"_RSC_";"
"RTN","RCXFMSUR",45,0)
 I $G(FUND)'="" S DR=DR_"203////"_FUND_";"
"RTN","RCXFMSUR",46,0)
 S (DIC,DIE)="^PRCA(430,"
"RTN","RCXFMSUR",47,0)
 D ^DIE
"RTN","RCXFMSUR",48,0)
 Q
"RTN","RCXFMSUR",49,0)
 ;
"RTN","RCXFMSUR",50,0)
 ;
"RTN","RCXFMSUR",51,0)
COLUMN1() ;  return column 1 number
"RTN","RCXFMSUR",52,0)
 Q 8
"RTN","RCXFMSUR",53,0)
 ;
"RTN","RCXFMSUR",54,0)
 ;
"RTN","RCXFMSUR",55,0)
COLUMN2() ;  return column 2 number
"RTN","RCXFMSUR",56,0)
 I CATEGDA=5 Q 1     ; hospital care (nsc)
"RTN","RCXFMSUR",57,0)
 I CATEGDA=4 Q 2     ; outpatient care (nsc)
"RTN","RCXFMSUR",58,0)
 I CATEGDA=3 Q 3     ; nursing home care (nsc)
"RTN","RCXFMSUR",59,0)
 I CATEGDA=1 Q 4     ; ineligible hospital
"RTN","RCXFMSUR",60,0)
 I CATEGDA=9 Q 5     ; reimbursable health insurance
"RTN","RCXFMSUR",61,0)
 I CATEGDA=10 Q 6    ; tort fesor
"RTN","RCXFMSUR",62,0)
 I CATEGDA=6 Q 7     ; workmans comp
"RTN","RCXFMSUR",63,0)
 I CATEGDA=18 Q 8    ; c (means test)
"RTN","RCXFMSUR",64,0)
 I CATEGDA=2 Q 9     ; emergency/humanitarian
"RTN","RCXFMSUR",65,0)
 I CATEGDA=7 Q "A"   ; no fault auto accident
"RTN","RCXFMSUR",66,0)
 I CATEGDA=22 Q "B"  ; rx copay/sc vet
"RTN","RCXFMSUR",67,0)
 I CATEGDA=23 Q "C"  ; rx copay/nsc vet
"RTN","RCXFMSUR",68,0)
 I CATEGDA=24 Q "D"  ; nursing home care per diem
"RTN","RCXFMSUR",69,0)
 I CATEGDA=25 Q "E"  ; hospital care per diem
"RTN","RCXFMSUR",70,0)
 I CATEGDA=21 Q "F"  ; medicare
"RTN","RCXFMSUR",71,0)
 I CATEGDA=33 Q "G"  ; adult day health care
"RTN","RCXFMSUR",72,0)
 I CATEGDA=34 Q "H"  ; domiciliary
"RTN","RCXFMSUR",73,0)
 I CATEGDA=35 Q "I"  ; respite care - institutional
"RTN","RCXFMSUR",74,0)
 I CATEGDA=36 Q "J"  ; respite care - non-institutional
"RTN","RCXFMSUR",75,0)
 I CATEGDA=37 Q "K"  ; geriatric evaluation - institutional
"RTN","RCXFMSUR",76,0)
 I CATEGDA=38 Q "L"  ; geriatric evaluation - non-institutional
"RTN","RCXFMSUR",77,0)
 I CATEGDA=39 Q "M"  ; nursing home care - ltc
"RTN","RCXFMSUR",78,0)
 Q ""
"RTN","RCXFMSUR",79,0)
 ;
"RTN","RCXFMSUR",80,0)
 ;
"RTN","RCXFMSUR",81,0)
COLUMN3() ;  return the column 3 number
"RTN","RCXFMSUR",82,0)
 N AGE,DECIMAL,DFN,IBCNDATA,TYPEAGE,TYPECARE,TYPEMEAN,TYPESERV,VA,VADM,VAERR
"RTN","RCXFMSUR",83,0)
 D DIQ399(BILLDA)
"RTN","RCXFMSUR",84,0)
 ;
"RTN","RCXFMSUR",85,0)
 D TYPECARE
"RTN","RCXFMSUR",86,0)
 ;
"RTN","RCXFMSUR",87,0)
 ;  compute service connected at time of care (1 digit binary)
"RTN","RCXFMSUR",88,0)
 ;  type of service connected is set as follows:
"RTN","RCXFMSUR",89,0)
 ;        0 = SC Vet                   1 = NSC Vet
"RTN","RCXFMSUR",90,0)
 S TYPESERV=1
"RTN","RCXFMSUR",91,0)
 ;  service connected at time of care (.18) = yes (1)
"RTN","RCXFMSUR",92,0)
 I $G(IBCNDATA(399,BILLDA,.18,"I"))=1 S TYPESERV=0
"RTN","RCXFMSUR",93,0)
 ;
"RTN","RCXFMSUR",94,0)
 S DFN=$P($G(^PRCA(430,BILLDA,0)),"^",7)
"RTN","RCXFMSUR",95,0)
 D DEM^VADPT
"RTN","RCXFMSUR",96,0)
 ;
"RTN","RCXFMSUR",97,0)
 ;  compute means test at time of care (1 digit binary)
"RTN","RCXFMSUR",98,0)
 ;  type of means test is set as follows:
"RTN","RCXFMSUR",99,0)
 ;        0 = Cat A                    1 = Cat C
"RTN","RCXFMSUR",100,0)
 S TYPEMEAN=0
"RTN","RCXFMSUR",101,0)
 I $$BIL^DGMTUB(DFN,$G(IBCNDATA(399,BILLDA,151,"I")))=1 S TYPEMEAN=1
"RTN","RCXFMSUR",102,0)
 ;
"RTN","RCXFMSUR",103,0)
 ;  compute patient age at time of care (1 digit binary)
"RTN","RCXFMSUR",104,0)
 ;  type of age is set as follows:
"RTN","RCXFMSUR",105,0)
 ;        0 = under 65                 1 = 65 and older
"RTN","RCXFMSUR",106,0)
 S AGE=$$FMDIFF^XLFDT($G(IBCNDATA(399,BILLDA,151,"I")),$P($G(VADM(3)),"^"))\365.25
"RTN","RCXFMSUR",107,0)
 S TYPEAGE=1
"RTN","RCXFMSUR",108,0)
 I AGE<65 S TYPEAGE=0
"RTN","RCXFMSUR",109,0)
 ;
"RTN","RCXFMSUR",110,0)
 ;  convert to decimal  typecare  typeserv  typemean  typeage
"RTN","RCXFMSUR",111,0)
 ;             binary=  1   1         1         1         1
"RTN","RCXFMSUR",112,0)
 ;            decimal= 16 + 8     +   4     +   2     +   1
"RTN","RCXFMSUR",113,0)
 S DECIMAL=$S(TYPECARE="11":24,TYPECARE="10":16,TYPECARE="01":8,1:0)
"RTN","RCXFMSUR",114,0)
 I TYPESERV S DECIMAL=DECIMAL+4
"RTN","RCXFMSUR",115,0)
 I TYPEMEAN S DECIMAL=DECIMAL+2
"RTN","RCXFMSUR",116,0)
 I TYPEAGE S DECIMAL=DECIMAL+1
"RTN","RCXFMSUR",117,0)
 I DECIMAL<10 Q DECIMAL
"RTN","RCXFMSUR",118,0)
 Q $C(65+DECIMAL-10)
"RTN","RCXFMSUR",119,0)
 ;
"RTN","RCXFMSUR",120,0)
 ;
"RTN","RCXFMSUR",121,0)
COLUMN4() ;  return the column 4 number (reserved for future expansion)
"RTN","RCXFMSUR",122,0)
 Q "Z"
"RTN","RCXFMSUR",123,0)
 ;
"RTN","RCXFMSUR",124,0)
 ;
"RTN","RCXFMSUR",125,0)
DIQ399(DA)  ;  get data from file 399
"RTN","RCXFMSUR",126,0)
 N D0,DIC,DIQ,DIQ2,DR
"RTN","RCXFMSUR",127,0)
 K IBCNDATA
"RTN","RCXFMSUR",128,0)
 S DIQ(0)="IE",DIC="^DGCR(399,",DIQ="IBCNDATA",DR=".04;.05;.18;151;" D EN^DIQ1
"RTN","RCXFMSUR",129,0)
 Q
"RTN","RCXFMSUR",130,0)
 ;
"RTN","RCXFMSUR",131,0)
 ;
"RTN","RCXFMSUR",132,0)
TYPECARE ;  compute type of care (2 digit binary)
"RTN","RCXFMSUR",133,0)
 ;  type of care is set as follows:
"RTN","RCXFMSUR",134,0)
 ;      00 = inpatient (hospital)    01 = outpatient
"RTN","RCXFMSUR",135,0)
 ;      10 = nursing home            11 = other
"RTN","RCXFMSUR",136,0)
 ;  default is other if it cannot be computed
"RTN","RCXFMSUR",137,0)
 S TYPECARE="11"
"RTN","RCXFMSUR",138,0)
 ;  bill classification (.05) = outpatient (3) or human.emerg(opt) (4)
"RTN","RCXFMSUR",139,0)
 I $G(IBCNDATA(399,BILLDA,.05,"I"))=3!($G(IBCNDATA(399,BILLDA,.05,"I"))=4) S TYPECARE="01" Q
"RTN","RCXFMSUR",140,0)
 ;  location of care (.04) = hospital inpt or outpt (1)
"RTN","RCXFMSUR",141,0)
 I $G(IBCNDATA(399,BILLDA,.04,"I"))=1 S TYPECARE="00" Q
"RTN","RCXFMSUR",142,0)
 ;  location of care (.04) = skilled nursing (nhcu) (2)
"RTN","RCXFMSUR",143,0)
 I $G(IBCNDATA(399,BILLDA,.04,"I"))=2 S TYPECARE="10"
"RTN","RCXFMSUR",144,0)
 Q
"RTN","RCXFMSUR",145,0)
 ;
"RTN","RCXFMSUR",146,0)
 ;
"RTN","RCXFMSUR",147,0)
ADDEDIT ;  enter/edit revenue source codes for fund 0160A1 bills.  These
"RTN","RCXFMSUR",148,0)
 ;  bills have the rsc entered by the user.  The user can select
"RTN","RCXFMSUR",149,0)
 ;  from rscs in file 347.3
"RTN","RCXFMSUR",150,0)
 W !!,"This option should be used with CAUTION.  This option will allow the"
"RTN","RCXFMSUR",151,0)
 W !,"user owning the PRCASVC supervisor security key, to add or edit the"
"RTN","RCXFMSUR",152,0)
 W !,"Revenue Source Codes selectable for non MCCF bills.  If an invalid"
"RTN","RCXFMSUR",153,0)
 W !,"Revenue Source Code is entered or changed, all code sheets sent to"
"RTN","RCXFMSUR",154,0)
 W !,"FMS referencing the invalid Revenue Source Code will reject.  Be"
"RTN","RCXFMSUR",155,0)
 W !,"cautious when entering new Revenue Source Codes or editing existing"
"RTN","RCXFMSUR",156,0)
 W !,"Revenue Source Codes.  New Revenue Source Codes should only be added"
"RTN","RCXFMSUR",157,0)
 W !,"after they have been added in FMS."
"RTN","RCXFMSUR",158,0)
 ;
"RTN","RCXFMSUR",159,0)
 I '$D(^XUSEC("PRCASVC",DUZ)) W !!,"You are not an owner of the PRCASVC security key." Q
"RTN","RCXFMSUR",160,0)
 ;
"RTN","RCXFMSUR",161,0)
 N %,%Y,C,D,D0,DA,DI,DIC,DIE,DLAYGO,DQ,DR,RCRJFLAG,X,X1,X2,X3,Y
"RTN","RCXFMSUR",162,0)
 ;
"RTN","RCXFMSUR",163,0)
 F  D  Q:$G(RCRJFLAG)
"RTN","RCXFMSUR",164,0)
 . S (DIC,DIE)="^RC(347.3,",DIC(0)="QEL",DLAYGO=347.3
"RTN","RCXFMSUR",165,0)
 . R !!,"Select REVENUE SOURCE CODE: ",X:DTIME
"RTN","RCXFMSUR",166,0)
 . S X1=X,X=$$UPPER^VALM1(X)
"RTN","RCXFMSUR",167,0)
 . I $E(X)="?",X?."?" D ^DIC Q:Y<1
"RTN","RCXFMSUR",168,0)
 . I X=""!($E(X)=U) S RCRJFLAG=1 Q
"RTN","RCXFMSUR",169,0)
 . I $D(^RC(347.3,"B",X)) S Y=+$O(^(X,0)) W "   ",X,"  ",$P($G(^RC(347.3,Y,0)),U,2) W:$P(^(0),U,3) "  INACTIVE" D UPD Q 
"RTN","RCXFMSUR",170,0)
 . S X2=$L(X1),X3=$C($A($E(X1,X2))-1),X3=$E(X1,1,X2-1)_X3,X3=$O(^RC(347.3,"C",X3)) I $E(X3,1,X2)=X1 S X=X1
"RTN","RCXFMSUR",171,0)
 . S D="C" D IX^DIC Q:Y<1  D UPD Q
"RTN","RCXFMSUR",172,0)
 Q
"RTN","RCXFMSUR",173,0)
UPD S DIE="^RC(347.3,",DA=+Y,DR=".02;.03" D ^DIE
"RTN","RCXFMSUR",174,0)
 Q
"RTN","RCXFMSUR",175,0)
 ;
"RTN","RCXFMSUR",176,0)
 ;
"RTN","RCXFMSUR",177,0)
RSC ;revenue code (#430/255)
"RTN","RCXFMSUR",178,0)
 I $P($G(^RC(347.3,X,0)),"^",3) D EN^DDIOL("THIS REVENUE SOURCE CODE IS INACTIVE.") K X Q
"RTN","RCXFMSUR",179,0)
 S X=$P(^RC(347.3,X,0),"^")
"RTN","RCXFMSUR",180,0)
 Q
"RTN","RCXFMSUR",181,0)
 ;
"RTN","RCXFMSUR",182,0)
SHOW ;  show/calculate revenue source code for a selected bill
"RTN","RCXFMSUR",183,0)
 W !!,"This option will show the calculated Revenue Source Code for a selected"
"RTN","RCXFMSUR",184,0)
 W !,"bill.  The Revenue Source Code is only calculated for accrued bills in"
"RTN","RCXFMSUR",185,0)
 I DT'<$$ADDPTEDT^PRCAACC() W !,"funds 528701,528703,528704,528709/4032"
"RTN","RCXFMSUR",186,0)
 I DT<$$ADDPTEDT^PRCAACC() W !,"funds 5287.1,5287.3,5287.4,4032"
"RTN","RCXFMSUR",187,0)
 ;
"RTN","RCXFMSUR",188,0)
 N %,%Y,BILLDA,C,DIC,FUND,I,RCRJFLAG,RSC,X,Y
"RTN","RCXFMSUR",189,0)
 ;
"RTN","RCXFMSUR",190,0)
 F  D  Q:$G(RCRJFLAG)
"RTN","RCXFMSUR",191,0)
 .   S DIC="^PRCA(430,",DIC(0)="QEAM"
"RTN","RCXFMSUR",192,0)
 .   W ! D ^DIC
"RTN","RCXFMSUR",193,0)
 .   I Y<1 S RCRJFLAG=1 Q
"RTN","RCXFMSUR",194,0)
 .   S BILLDA=+Y
"RTN","RCXFMSUR",195,0)
 .   S FUND=$$GETFUNDB^RCXFMSUF(BILLDA,1)
"RTN","RCXFMSUR",196,0)
 .   W !!,"        Bill Number: ",$P($G(^PRCA(430,BILLDA,0)),"^")
"RTN","RCXFMSUR",197,0)
 .   W !,"               Fund: ",FUND
"RTN","RCXFMSUR",198,0)
 .   I '$$PTACCT^PRCAACC(FUND),FUND'=4032 D  Q
"RTN","RCXFMSUR",199,0)
 .   .   W !,"  The Revenue Source Code cannot be calculated for non-accrued bills."
"RTN","RCXFMSUR",200,0)
 .   .   W !,"  The Revenue Source Code for non-accrued bills are input by the user."
"RTN","RCXFMSUR",201,0)
 .   .   W !,"  The Revenue Source Code is currently entered as: "
"RTN","RCXFMSUR",202,0)
 .   .   S RSC=$P($G(^PRCA(430,BILLDA,11)),"^",6)
"RTN","RCXFMSUR",203,0)
 .   .   W $S(RSC="":"<not entered>",1:RSC)
"RTN","RCXFMSUR",204,0)
 .   ;
"RTN","RCXFMSUR",205,0)
 .   S RSC=$$CALCRSC(BILLDA)
"RTN","RCXFMSUR",206,0)
 .   W !,"Revenue Source Code: ",RSC
"RTN","RCXFMSUR",207,0)
 Q
"VER")
8.0^22.0
"^DD",347.3,347.3,.01,0)
SOURCE CODE^RFX^^0;1^I $D(X) K:$L(X)>4!($L(X)<1)!'(X'?1P.E) X
"^DD",347.3,347.3,.01,1,0)
^.1
"^DD",347.3,347.3,.01,1,1,0)
347.3^B
"^DD",347.3,347.3,.01,1,1,1)
S ^RC(347.3,"B",$E(X,1,30),DA)=""
"^DD",347.3,347.3,.01,1,1,2)
K ^RC(347.3,"B",$E(X,1,30),DA)
"^DD",347.3,347.3,.01,3)
Enter the revenue source code to be sent to FMS.
"^DD",347.3,347.3,.01,21,0)
^.001^1^1^3060130^^^^
"^DD",347.3,347.3,.01,21,1,0)
This field is used to identify the revenue source code to be sent to FMS.
"^DD",347.3,347.3,.01,"DEL",1,0)
W !,"REVENUE SOURCE CODES CANNOT BE DELETED.  THEY MUST BE INACTIVATED." I 1
"^DD",347.3,347.3,.01,"DT")
3060130
"^DD",430,430,255,0)
REVENUE SOURCE^RP347.3'X^RC(347.3,^11;6^D RSC^RCXFMSUR
"^DD",430,430,255,3)
Enter the revenue source code to be sent to FMS for this bill.  Only active Revenue Source Codes can be selected.
"^DD",430,430,255,21,0)
^.001^3^3^3050328^^
"^DD",430,430,255,21,1,0)
This code is required for revenue transactions.  It is used to group
"^DD",430,430,255,21,2,0)
collected revenue and to determine whether the revenue will credit
"^DD",430,430,255,21,3,0)
actual reimbursement receivables for the associated fund.
"^DD",430,430,255,"DT")
3050831
"BLD",6238,6)
^213
**END**
**END**
