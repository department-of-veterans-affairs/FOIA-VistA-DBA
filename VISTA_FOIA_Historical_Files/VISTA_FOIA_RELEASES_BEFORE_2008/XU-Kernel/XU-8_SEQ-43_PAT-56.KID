Released XU*8*56 SEQ #43
Extracted from mail message
**KIDS**:XU*8.0*56^

**INSTALL NAME**
XU*8.0*56
"BLD",309,0)
XU*8.0*56^KERNEL^0^2970107^n
"BLD",309,1,0)
^^8^8^2970107^
"BLD",309,1,1,0)
This patch adds changes and  enhancements to the Unwinder (XQOR*) in support 
"BLD",309,1,2,0)
of the Text Integration Utilities (TIU) package.  These changes include:
"BLD",309,1,3,0)

"BLD",309,1,4,0)
  1)  the ability to programmatically change the menu passed to XQOR
"BLD",309,1,5,0)
  2)  some modifications to the response time monitoring calls
"BLD",309,1,6,0)
  3)  the suppression of linefeeds when XQORM is called non-interactively
"BLD",309,1,7,0)
  4)  the ability to map numeric input to a protocol that should be run
"BLD",309,1,8,0)
  5)  the storage of HL7 messages in ^TMP to free up partition space
"BLD",309,4,0)
^9.64PA^^
"BLD",309,"KRN",0)
^9.67PA^19^18
"BLD",309,"KRN",.4,0)
.4
"BLD",309,"KRN",.401,0)
.401
"BLD",309,"KRN",.402,0)
.402
"BLD",309,"KRN",.403,0)
.403
"BLD",309,"KRN",.5,0)
.5
"BLD",309,"KRN",.84,0)
.84
"BLD",309,"KRN",3.6,0)
3.6
"BLD",309,"KRN",3.8,0)
3.8
"BLD",309,"KRN",9.2,0)
9.2
"BLD",309,"KRN",9.8,0)
9.8
"BLD",309,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",309,"KRN",9.8,"NM",1,0)
XQOR^^0^B12590953
"BLD",309,"KRN",9.8,"NM",2,0)
XQOR1^^0^B14154345
"BLD",309,"KRN",9.8,"NM",3,0)
XQOR4^^0^B7415060
"BLD",309,"KRN",9.8,"NM",4,0)
XQORM^^0^B4277813
"BLD",309,"KRN",9.8,"NM",5,0)
XQORM2^^0^B11577798
"BLD",309,"KRN",9.8,"NM",6,0)
XQORM3^^0^B8955231
"BLD",309,"KRN",9.8,"NM",7,0)
XQORO^^0^B16587336
"BLD",309,"KRN",9.8,"NM","B","XQOR",1)

"BLD",309,"KRN",9.8,"NM","B","XQOR1",2)

"BLD",309,"KRN",9.8,"NM","B","XQOR4",3)

"BLD",309,"KRN",9.8,"NM","B","XQORM",4)

"BLD",309,"KRN",9.8,"NM","B","XQORM2",5)

"BLD",309,"KRN",9.8,"NM","B","XQORM3",6)

"BLD",309,"KRN",9.8,"NM","B","XQORO",7)

"BLD",309,"KRN",19,0)
19
"BLD",309,"KRN",19.1,0)
19.1
"BLD",309,"KRN",101,0)
101
"BLD",309,"KRN",409.61,0)
409.61
"BLD",309,"KRN",771,0)
771
"BLD",309,"KRN",869.2,0)
869.2
"BLD",309,"KRN",870,0)
870
"BLD",309,"KRN",8994,0)
8994
"BLD",309,"KRN","B",.4,.4)

"BLD",309,"KRN","B",.401,.401)

"BLD",309,"KRN","B",.402,.402)

"BLD",309,"KRN","B",.403,.403)

"BLD",309,"KRN","B",.5,.5)

"BLD",309,"KRN","B",.84,.84)

"BLD",309,"KRN","B",3.6,3.6)

"BLD",309,"KRN","B",3.8,3.8)

"BLD",309,"KRN","B",9.2,9.2)

"BLD",309,"KRN","B",9.8,9.8)

"BLD",309,"KRN","B",19,19)

"BLD",309,"KRN","B",19.1,19.1)

"BLD",309,"KRN","B",101,101)

"BLD",309,"KRN","B",409.61,409.61)

"BLD",309,"KRN","B",771,771)

"BLD",309,"KRN","B",869.2,869.2)

"BLD",309,"KRN","B",870,870)

"BLD",309,"KRN","B",8994,8994)

"BLD",309,"QUES",0)
^9.62^^
"BLD",309,"REQB",0)
^9.611^^
"PKG",1,-1)
1^1
"PKG",1,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^XUDOCV7 NEW FEATURES
"PKG",1,22,0)
^9.49I^1^1
"PKG",1,22,1,0)
8.0^2950703^2950906^10
"PKG",1,22,1,"PAH",1,0)
56^2970107
"PKG",1,22,1,"PAH",1,1,0)
^^8^8^2970107
"PKG",1,22,1,"PAH",1,1,1,0)
This patch adds changes and  enhancements to the Unwinder (XQOR*) in support 
"PKG",1,22,1,"PAH",1,1,2,0)
of the Text Integration Utilities (TIU) package.  These changes include:
"PKG",1,22,1,"PAH",1,1,3,0)

"PKG",1,22,1,"PAH",1,1,4,0)
  1)  the ability to programmatically change the menu passed to XQOR
"PKG",1,22,1,"PAH",1,1,5,0)
  2)  some modifications to the response time monitoring calls
"PKG",1,22,1,"PAH",1,1,6,0)
  3)  the suppression of linefeeds when XQORM is called non-interactively
"PKG",1,22,1,"PAH",1,1,7,0)
  4)  the ability to map numeric input to a protocol that should be run
"PKG",1,22,1,"PAH",1,1,8,0)
  5)  the storage of HL7 messages in ^TMP to free up partition space
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","XQOR")
0^1^B12590953
"RTN","XQOR",1,0)
XQOR ; SLC/KCM - Prepare to Unwind Options ;5/24/94  17:58 ;
"RTN","XQOR",2,0)
 ;;8.0;KERNEL;**48,56**;Jul 10, 1995
"RTN","XQOR",3,0)
 S DIC=19,DIC(0)="AEMQ" D ^DIC K DIC Q:Y<0  S X=+Y_";DIC(19,"
"RTN","XQOR",4,0)
EN ;Process options/protocols from top
"RTN","XQOR",5,0)
 ;From: Anywhere  Entry: X,{DIC,XQORFLG}  Exit: none
"RTN","XQOR",6,0)
 Q:$D(X)[0  K XQORPOP,XQORQUIT
"RTN","XQOR",7,0)
 I '$D(XQORS) S XQORS=0 K ^TMP("XQORS",$J)
"RTN","XQOR",8,0)
 S XQORS=XQORS+1 ;push
"RTN","XQOR",9,0)
 I $D(XQOR("HIJACK")) S X=XQOR("HIJACK"),DIC=101 K XQOR("HIJACK")
"RTN","XQOR",10,0)
 I X?1.N1";ORD(101,"!(X?1.N1";DIC(19,") S ^TMP("XQORS",$J,XQORS,"REF")="^"_$P(X,";",2)_+X_",",^TMP("XQORS",$J,XQORS,"VPT")=X
"RTN","XQOR",11,0)
 E  S:$D(DIC)[0 DIC=19 S DIC(0)="N" D ^DIC S:Y>0 ^TMP("XQORS",$J,XQORS,"REF")=DIC_+Y_",",^TMP("XQORS",$J,XQORS,"VPT")=+Y_";"_$P(DIC,"^",2) K DIC G:Y<0 EX
"RTN","XQOR",12,0)
 S XQORNEST(XQORS)=^TMP("XQORS",$J,XQORS,"VPT"),XQORNEST=XQORS
"RTN","XQOR",13,0)
 G:'$D(@(^TMP("XQORS",$J,XQORS,"REF")_"0)")) EX S ^TMP("XQORS",$J,XQORS,"FLG")=$P(^(0),"^",4)_"^^" G:$P(^TMP("XQORS",$J,XQORS,"FLG"),"^")'?1A EX
"RTN","XQOR",14,0)
 I $L($P(@(^TMP("XQORS",$J,XQORS,"REF")_"0)"),"^",3)) W !!,$P(^(0),"^",3),! D READ^XQOR4 G EX
"RTN","XQOR",15,0)
 D C19^XQOR4 G:Y<0 EX
"RTN","XQOR",16,0)
 S ^TMP("XQORS",$J,0,"FILE")=";"_$P(^TMP("XQORS",$J,XQORS,"VPT"),";",2),^TMP("XQORS",$J,XQORS,"INP")=""
"RTN","XQOR",17,0)
 I XQORS>1,$D(^TMP("XQORS",$J,XQORS-1,"ITM")),$D(^TMP("XQORS",$J,XQORS-1,"ITM",^TMP("XQORS",$J,XQORS-1,"ITM"),"IN")) S ^TMP("XQORS",$J,XQORS,"INP")=^TMP("XQORS",$J,XQORS-1,"ITM",^TMP("XQORS",$J,XQORS-1,"ITM"),"IN")
"RTN","XQOR",18,0)
 I XQORS>1,$D(XQORFLG("PI")) K XQORFLG("PI") S ^TMP("XQORS",$J,XQORS,"INP")=^TMP("XQORS",$J,XQORS-1,"INP")
"RTN","XQOR",19,0)
 S XQORNOD=^TMP("XQORS",$J,XQORS,"VPT"),XQORNOD(0)=^TMP("XQORS",$J,XQORS,"INP")
"RTN","XQOR",20,0)
 I XQORS>1,$D(^TMP("XQORS",$J,XQORS-1,"FLG")) S X=^TMP("XQORS",$J,XQORS-1,"FLG"),$P(^TMP("XQORS",$J,XQORS,"FLG"),"^",3)=$S($L($P(X,"^",5)):$P(X,"^",5),1:$P(X,"^",3))
"RTN","XQOR",21,0)
 I ^TMP("XQORS",$J,0,"FILE")=";ORD(101,",$D(@(^TMP("XQORS",$J,XQORS,"REF")_"4)")) S:$P(^(4),"^",3)="Y" $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",2)=1
"RTN","XQOR",22,0)
 I ^TMP("XQORS",$J,0,"FILE")=";DIC(19,",$P(^TMP("XQORS",$J,XQORS,"FLG"),"^")="M" S $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",2)=1
"RTN","XQOR",23,0)
 I $D(XQORFLG) S:$D(XQORFLG("PS")) $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",2)=+XQORFLG("PS") S:$D(XQORFLG("SH")) $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",3)=+XQORFLG("SH") K XQORFLG
"RTN","XQOR",24,0)
 I $D(ORITMO) S $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",6)=1 K ORITMO G REDO^XQOR1
"RTN","XQOR",25,0)
 I $P(^TMP("XQORS",$J,XQORS,"FLG"),"^")="D" N XQORDLG
"RTN","XQOR",26,0)
 G LOOP^XQOR1
"RTN","XQOR",27,0)
EX K XQORNEST(XQORS),XQORFLG,XQORNOD,XQORY,^TMP("XQORS",$J,XQORS) S XQORS=XQORS-1,XQORNEST=XQORS ;pop
"RTN","XQOR",28,0)
 I XQORS=0 K XQORNEST,XQORS,^TMP("XQORS",$J),XQORSPEW
"RTN","XQOR",29,0)
 Q
"RTN","XQOR",30,0)
EN1 ;Process items on option/protocol only (i.e., skip initial actions)
"RTN","XQOR",31,0)
 ;From: Anywhere  Entry: X,DIC  Exit: none
"RTN","XQOR",32,0)
 S ORITMO=1 G EN
"RTN","XQOR",33,0)
 Q
"RTN","XQOR",34,0)
XQ ;From: Menuman  Entry: XQOR  Exit: XQOR
"RTN","XQOR",35,0)
 S X=+XQOR_";DIC(19," I $D(^DD(19,0,"VR")),^("VR")<5.9 G EN
"RTN","XQOR",36,0)
 G EN1
"RTN","XQOR",37,0)
MSG(X,XQORMSG) ;Event point for HL7 messages
"RTN","XQOR",38,0)
 N DIC S DIC=101
"RTN","XQOR",39,0)
 I '$D(XQORHSTK) N XQORHSTK S XQORHSTK=-1 K ^TMP("XQORHSTK",$J)
"RTN","XQOR",40,0)
 S XQORHSTK=XQORHSTK+1
"RTN","XQOR",41,0)
 K ^TMP("XQORHSTK",$J,XQORHSTK) M ^TMP("XQORHSTK",$J,XQORHSTK)=XQORMSG
"RTN","XQOR",42,0)
 D EN^XQOR
"RTN","XQOR",43,0)
 S XQORHSTK=XQORHSTK-1
"RTN","XQOR",44,0)
 I XQORHSTK>-1 K XQORMSG M XQORMSG=^TMP("XQORHSTK",$J,XQORHSTK)
"RTN","XQOR",45,0)
 I XQORHSTK=-1 K ^TMP("XQORHSTK",$J)
"RTN","XQOR",46,0)
 Q
"RTN","XQOR1")
0^2^B14154345
"RTN","XQOR1",1,0)
XQOR1 ; SLC/KCM - Main Unwinding Loop ;3/23/92  08:34 ;
"RTN","XQOR1",2,0)
 ;;8.0;KERNEL;**48,56**;Jul 10, 1995
"RTN","XQOR1",3,0)
LOOP ;From: EN^XQOR
"RTN","XQOR1",4,0)
 I "QOLD"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^"),'$D(^TMP("XQORS",$J,0,"CTXT","ADD")) D ENTRY^XQORO G:$D(XQORQUIT)!$D(XQORPOP)!$D(DIROUT)!$D(DTOUT) EXCT
"RTN","XQOR1",5,0)
 D EACH G:$D(XQORQUIT)!$D(XQORPOP)!$D(DIROUT)!$D(DTOUT) EXCT
"RTN","XQOR1",6,0)
 I $D(@(^TMP("XQORS",$J,XQORS,"REF")_"20)"))'[0 S Y=^(20) I $L(Y) D  N X X Y S:$D(X)'[0 ^TMP("XQORS",$J,XQORS,"X")=X
"RTN","XQOR1",7,0)
 . ; start resource monitoring log
"RTN","XQOR1",8,0)
 . I $L($T(LOGRSRC^%ZOSV)),$G(^TMP("XQORS",$J,XQORS,"REF"))["ORD(101,",$P(@(^("REF")_"0)"),"^",4)'="M",$P(^(0),"^",4)'="Q" N ORX S ORX=$P(^(0),"^") D:'$D(XQXFLG) ABT^XQ12 D:$P(XQXFLG,"^",2)=1 LOGRSRC^%ZOSV("*"_ORX)
"RTN","XQOR1",9,0)
 I $D(XQORQUIT)!$D(XQORPOP)!$D(DIROUT)!$D(DTOUT) G EXAT
"RTN","XQOR1",10,0)
 I $D(XQORFLG) S:$D(XQORFLG("PS")) $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",2)=+XQORFLG("PS") S:$D(XQORFLG("SH")) $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",5)=+XQORFLG("SH") K XQORFLG
"RTN","XQOR1",11,0)
REDO D @$S("QM"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^"):"MENU^XQOR3","DOX"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^"):"ACT^XQOR2","T"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^"):"EN^XQORD",1:"NUL^XQOR2")
"RTN","XQOR1",12,0)
 G:'^TMP("XQORS",$J,XQORS,"ITM") EXAT S ^TMP("XQORS",$J,XQORS,"TOT")=^TMP("XQORS",$J,XQORS,"ITM"),^TMP("XQORS",$J,XQORS,"ITM")=0
"RTN","XQOR1",13,0)
STAK S ^TMP("XQORS",$J,XQORS,"ITM")=^TMP("XQORS",$J,XQORS,"ITM")+1 G:^TMP("XQORS",$J,XQORS,"ITM")>^TMP("XQORS",$J,XQORS,"TOT") EXST
"RTN","XQOR1",14,0)
 I '^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM")) S $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",4)=1 D DJMP^XQOR4 K XQORPOP,XQORQUIT G NXT
"RTN","XQOR1",15,0)
 I $D(^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM"),"MA")) S X=^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM"),"MA") D EN^XQOR G:$D(XQORQUIT)!$D(XQORPOP)!$D(DIROUT)!$D(DTOUT) NXT
"RTN","XQOR1",16,0)
 S X=^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM")) D EN^XQOR
"RTN","XQOR1",17,0)
NXT K XQORQUIT I '$D(XQORPOP),'$D(DIROUT),'$D(DTOUT) G STAK
"RTN","XQOR1",18,0)
EXST S ^TMP("XQORS",$J,0,"FILE")=";"_$P(^TMP("XQORS",$J,XQORS,"VPT"),";",2) S:$D(^TMP("XQORS",$J,XQORS,"INP")) $P(^TMP("XQORS",$J,XQORS,"INP"),"^",4)="" K XQORPOP
"RTN","XQOR1",19,0)
 S XQORNOD=^TMP("XQORS",$J,XQORS,"VPT"),XQORNOD(0)=^TMP("XQORS",$J,XQORS,"INP")
"RTN","XQOR1",20,0)
 I $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",2)!$P(^TMP("XQORS",$J,XQORS,"FLG"),"^",4) S $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",4)=""
"RTN","XQOR1",21,0)
 I  I '$D(DIROUT),'$D(DTOUT) D EACH I '$D(XQORQUIT),'$D(XQORPOP),'$D(DIROUT),'$D(DTOUT) K ^TMP("XQORS",$J,XQORS,"ITM") G REDO
"RTN","XQOR1",22,0)
EXAT I $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",6) G EX^XQOR
"RTN","XQOR1",23,0)
 I $D(@(^TMP("XQORS",$J,XQORS,"REF")_"15)"))'[0 S X=^(15) I $L(X) X X
"RTN","XQOR1",24,0)
EXCT I $D(^TMP("XQORS",$J,XQORS,"CTX","AD")) D EXIT^XQORO
"RTN","XQOR1",25,0)
 G EX^XQOR
"RTN","XQOR1",26,0)
EACH I $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",3),"AXLOD"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^") D SHDR^XQOR4
"RTN","XQOR1",27,0)
 D:$D(OROLD) RSTR^XQORO ;OE/RR Context
"RTN","XQOR1",28,0)
 I $D(XQORHSTK),$D(^TMP("XQORHSTK",$J,XQORHSTK)) K XQORMSG M XQORMSG=^TMP("XQORHSTK",$J,XQORHSTK)
"RTN","XQOR1",29,0)
 I "QOLD"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^"),$D(^TMP("XQORS",$J,0,"CTXT","ADD")) D EVERY^XQORO
"RTN","XQOR1",30,0)
 Q
"RTN","XQOR4")
0^3^B7415060
"RTN","XQOR4",1,0)
XQOR4 ; SLC/KCM - Process "^^" jump ;11/18/92  09:53 ;
"RTN","XQOR4",2,0)
 ;;8.0;KERNEL;**56**;Jul 10, 1995
"RTN","XQOR4",3,0)
DJMP ;From: STAK^XQOR1
"RTN","XQOR4",4,0)
 Q:'$D(^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM"),"IN"))
"RTN","XQOR4",5,0)
 S X=^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM"),"IN")
"RTN","XQOR4",6,0)
 I '$L($P(X,"^",3)) W !!,"For entry ""^^",$P(X,"^",4),""" -"
"RTN","XQOR4",7,0)
 S X=$P(X,"^",4,99) D EAT^XQORM1 ;Q:$E(X,1,2)'="^^"
"RTN","XQOR4",8,0)
 S X=$P(X,"=",1),D="K.ORWARD",DIC="^ORD(101,",DIC(0)="SE" D IX^DIC K DIC,D
"RTN","XQOR4",9,0)
 I Y<0!('$D(^ORD(101,+Y,0))) W:(X'["^")&(X'["?") !!,">>>  ",X," not found or selected.  No action taken." D:(X'["^")&(X'["?") READ S X="" Q
"RTN","XQOR4",10,0)
 S ORNSV=+Y
"RTN","XQOR4",11,0)
 K X F I=1:1:XQORS I $P(^TMP("XQORS",$J,XQORS,"VPT"),";",2)="ORD(101,",$D(^ORD(101,+^TMP("XQORS",$J,XQORS,"VPT"),21)) D DJMP1
"RTN","XQOR4",12,0)
 S X="" F I=0:0 S X=$O(X(X)) Q:X=""  N @X
"RTN","XQOR4",13,0)
 I $D(VALMCC) N XQORLMGR S XQORLMGR="" D FULL^VALM1 ; List Mgr Running?
"RTN","XQOR4",14,0)
 S X=ORNSV_";ORD(101," K ORNSV
"RTN","XQOR4",15,0)
 D EN^XQOR
"RTN","XQOR4",16,0)
 I $D(XQORLMGR) S VALMBCK="R"                       ; Refresh List Mgr
"RTN","XQOR4",17,0)
 Q
"RTN","XQOR4",18,0)
DJMP1 F J=0:0 S J=$O(^ORD(101,+^TMP("XQORS",$J,XQORS,"VPT"),21,J)) Q:J'>0  I $D(^ORD(101,+^TMP("XQORS",$J,XQORS,"VPT"),21,J,0)) S X=^(0) I X?1A.ANP!(X?1"%".ANP) S X(X)=""
"RTN","XQOR4",19,0)
 Q
"RTN","XQOR4",20,0)
SHDR ;Display sub-header
"RTN","XQOR4",21,0)
 Q:'$D(@(^TMP("XQORS",$J,XQORS,"REF")_"0)"))  S X=$P(^(0),"^",2) W:X'?1." " !!?(36-($L(X)\2)),"--- "_X_" ---"
"RTN","XQOR4",22,0)
 Q
"RTN","XQOR4",23,0)
READ W !,"Press RETURN to continue: " R X:$S($D(DTIME):DTIME,1:300)
"RTN","XQOR4",24,0)
 Q
"RTN","XQOR4",25,0)
C19 N X0 S X0=@(^TMP("XQORS",$J,XQORS,"REF")_"0)"),X=$P(X0,"^",6) I $L(X),'$D(^XUSEC(X,DUZ)) W !!,"This option "_$P(X0,"^")_" is locked.",! D READ S Y=-1 Q
"RTN","XQOR4",26,0)
 S ORNSV=$P(X0,"^",9),X="NOW",%DT="T" D ^%DT S X=$P(Y,".",2) I X>$P(ORNSV,"-"),X<$P(ORNSV,"-",2) W !!,"Not Available: ",ORNSV,! K ORNSV D READ S Y=-1 Q
"RTN","XQOR4",27,0)
 K ORNSV I "QMOXALDT"'[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^") W !!,"This option type not supported by 'unwinder' routines.",! D READ S Y=-1 Q
"RTN","XQOR4",28,0)
 S Y=1 Q
"RTN","XQORM")
0^4^B4277813
"RTN","XQORM",1,0)
XQORM ; SLC/KCM - Menu Utility ;2/25/92  16:42
"RTN","XQORM",2,0)
 ;;8.0;KERNEL;**56**;Jul 10, 1995
"RTN","XQORM",3,0)
 ;From: XQOR  Entry: XQORM,{X}  Exit: X,Y,XQORM,{DIROUT}
"RTN","XQORM",4,0)
EN I $D(XQORM("HIJACK")) S XQORM=XQORM("HIJACK") K XQORM("HIJACK")
"RTN","XQORM",5,0)
 K Y S Y=-1 Q:$D(XQORM)'=11  Q:$D(XQORM(0))[0  Q:XQORM'[";"  ;Q:'$D(@("^"_$P(XQORM,";",2)_+XQORM_",99)"))
"RTN","XQORM",6,0)
 I XQORM(0)'["h",$D(^XUTL("XQORM",XQORM,0)),$P(^(0),"^",1)'=$P(@("^"_$P(XQORM,";",2)_+XQORM_",99)"),"^",1) D XREF
"RTN","XQORM",7,0)
 I XQORM(0)'["h",'$D(^XUTL("XQORM",XQORM,0)) D XREF Q:Y<0
"RTN","XQORM",8,0)
 L +^XUTL("XQORM",XQORM,"XQORM PROTECT",$J):30 E  W !,"Can't access menu at this time - try again later." S Y=-1 Q
"RTN","XQORM",9,0)
 S:$D(XQORM("X")) X=XQORM("X") S:$D(X)[0 X="" S ORUSV=X
"RTN","XQORM",10,0)
 I $S('$D(IOM):1,'$D(IOF):1,'$D(IOST):1,'IOM:1,1:0) S IOP=$S($D(ORIO):ORIO,1:"HOME") D ^%ZIS S X=ORUSV
"RTN","XQORM",11,0)
 S (DX,DY)=0 X ^%ZOSF("XY") I $D(XQORM("H")),$L(XQORM("H")) X XQORM("H")
"RTN","XQORM",12,0)
 S X=ORUSV D:XQORM(0)["D" DISP^XQORM1 I (XQORM(0)["A")!(XQORM(0)["D") W !
"RTN","XQORM",13,0)
 F ORU=0:0 D:XQORM(0)["A" PRMT^XQORM1 S Y=-1 Q:'$L(X)!(X="^")!(X="^^")  D EN^XQORM2 Q:Y'<0!(XQORM(0)'["A")
"RTN","XQORM",14,0)
 L -^XUTL("XQORM",XQORM,"XQORM PROTECT",$J)
"RTN","XQORM",15,0)
 K DX,DY,J,ORU,ORULT,ORUSV Q
"RTN","XQORM",16,0)
XREF N X,DIC,DIE,DA,DR
"RTN","XQORM",17,0)
 S Y=-1 S:'$D(ORULT) ORULT=2
"RTN","XQORM",18,0)
 I $P(XQORM,";",2)="DIC(19," D X19 Q
"RTN","XQORM",19,0)
 S DIE="^"_$P(XQORM,";",2),DA=+XQORM,DR="99///"_$H
"RTN","XQORM",20,0)
 L +(^XUTL("XQORM",XQORM),@(DIE_+XQORM_")")):ORULT E  S Y=-1 Q
"RTN","XQORM",21,0)
 D ^DIE S Y=1 K D,D0,DI,DQ
"RTN","XQORM",22,0)
 L -(^XUTL("XQORM",XQORM),@(DIE_+XQORM_")"))
"RTN","XQORM",23,0)
 Q
"RTN","XQORM",24,0)
X19 L +(^XUTL("XQORM",XQORM),^DIC(19,+XQORM)):ORULT E  S Y=-1 Q
"RTN","XQORM",25,0)
 S DA=+XQORM D SET^XQORMX K DA S Y=1
"RTN","XQORM",26,0)
 L -(^XUTL("XQORM",XQORM),^DIC(19,+XQORM))
"RTN","XQORM",27,0)
 Q
"RTN","XQORM2")
0^5^B11577798
"RTN","XQORM2",1,0)
XQORM2 ; SLC/KCM - Lookup for Menu Utility ;11/18/92  15:23
"RTN","XQORM2",2,0)
 ;;8.0;KERNEL;**56**;Jul 10, 1995
"RTN","XQORM2",3,0)
EN ;From: XQORM  Entry: X,XQORM  Exit: X,Y,XQORM
"RTN","XQORM2",4,0)
 N K K Y,OROTHER I X=" " S XQORM(0)=XQORM(0)_"X" D LAST^XQORM4 I '$L(X) S Y=-1 W:XQORM(0)["A" "??" W:XQORM(0)["A"&(XQORM(0)["\") ! Q
"RTN","XQORM2",5,0)
 D UP^XQORM1 K ORUX S ORUX=X,(ORUT,ORUER,Y)=0,XQORMSF=""
"RTN","XQORM2",6,0)
 F J=1:1:$L(ORUX,",") S X=$P(ORUX,",",J) D EAT,SET D:X["-" RNG^XQORM3 Q:ORUER  F K=1:1:$L(X,",") I $L($P(X,",",K)) S ORUT=ORUT+1,ORUX(ORUT)=$P(X,",",K) S:$L(ORUFG) ORUX(ORUT,"=")=ORUFG S:ORUSB ORUX(ORUT,"'")=""
"RTN","XQORM2",7,0)
 I 'ORUER S (ORUSQ,ORUT)=0 F I=0:0 S ORUT=$O(ORUX(ORUT)) Q:ORUT=""  S X=ORUX(ORUT) D SPCL I $L(X) D LOOK^XQORM3,CHAL Q:ORUER
"RTN","XQORM2",8,0)
 I +XQORM(0),+Y>XQORM(0) D:XQORM(0)["A" NE^XQORM4 S ORUER=1,Y=-1
"RTN","XQORM2",9,0)
 I 'ORUER S ORUB=0 F I=0:0 S ORUB=$O(Y(ORUB)) Q:ORUB'>0  D SCRN I 'ORUFG D:ORUX["ALL" SUB I ORUX'["ALL" D:XQORM(0)["A" NS^XQORM4 S ORUER=1
"RTN","XQORM2",10,0)
 I 'ORUER,Y>0 W:XQORM(0)["A" "   " S ORUFG=$S($X>(IOM-30):9,1:$X) K:XQORM(0)'["F" ^DISV(DUZ,"XQORM",XQORM) F I=0:0 S I=$O(Y(I)) Q:I'>0  D:XQORM(0)["A" ECHO D:XQORM(0)'["F" DISV
"RTN","XQORM2",11,0)
 S X=ORUX I ORUER K Y S Y=-1
"RTN","XQORM2",12,0)
KILL K ORUX,ORUFG,ORUSB,ORUT,ORUER,ORUFD,ORUB,ORUDA,ORUW,ORUSQ,XQORMSF,J,Y("B"),Y("#") Q
"RTN","XQORM2",13,0)
SCRN S ORUFG=1 I $D(XQORM("S"))'[0,$L(XQORM("S")) N DA S DA(1)=+XQORM,DA=+Y(ORUB) I DA N Y X XQORM("S") S ORUFG=$T
"RTN","XQORM2",14,0)
 Q
"RTN","XQORM2",15,0)
SET S ORUSB=0 I $E(X)="-",$L(X)>1 S ORUSB=1,X=$P(X,"-",2,99)
"RTN","XQORM2",16,0)
 S ORUFG="" I $E(X)'="=" S ORUFG=$P(X,"=",2,99),X=$P(X,"=",1)
"RTN","XQORM2",17,0)
 Q
"RTN","XQORM2",18,0)
SPCL S:'$D(XQORSPEW) XQORSPEW=0 I $E(X)="*" S XQORSPEW=$S(XQORSPEW:0,1:1),X=$E(X,2,255) W $S(XQORSPEW:" -RAPID MODE-",1:" -NORMAL MODE-")
"RTN","XQORM2",19,0)
 ;I $D(XQORM("KEY",$P(X," "))) S ORUX(ORUT,"=")=$P(X," ",2,99)_"="_$G(ORUX(ORUT,"=")),X="^^`"_XQORM("KEY",$P(X," "))
"RTN","XQORM2",20,0)
 I '$D(XQORM("NO^^")),$E(X,1,2)="^^" S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)="^"_X,X="" S:$D(ORUX(ORUT,"=")) $P(Y(ORUSQ),"=",2)=ORUX(ORUT,"=") Q
"RTN","XQORM2",21,0)
 I XQORM(0)["+","+-"[X S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)=X,X="" Q
"RTN","XQORM2",22,0)
 I $E(X)=";" D SC^XQORM4 S X="",ORUER=1 Q
"RTN","XQORM2",23,0)
 S X=$P(X,";",1) D EAT
"RTN","XQORM2",24,0)
 Q
"RTN","XQORM2",25,0)
CHAL ; Q:ORUER  I ORUDA,'$D(ORUDA("KEY")),'$D(XQORM("#")) D UPD^XQORM3 Q
"RTN","XQORM2",26,0)
 Q:ORUER  I ORUDA?1.N1"."1.N D UPD^XQORM3 Q
"RTN","XQORM2",27,0)
 I $D(XQORM("KEY",$P(ORUDA," "))) D  Q
"RTN","XQORM2",28,0)
 . S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)="^^"_ORUDA_"^`"_+XQORM("KEY",$P(ORUDA," "))_"="_$P(ORUDA," ",2,99)_"="_$G(ORUX(ORUT,"="))
"RTN","XQORM2",29,0)
 . I $P(XQORM("KEY",$P(ORUDA," ")),"^",2) S $P(Y(ORUSQ),"^",2)=+XQORM("KEY",$P(ORUDA," "))
"RTN","XQORM2",30,0)
 . K ORUDA("KEY")
"RTN","XQORM2",31,0)
 . Q
"RTN","XQORM2",32,0)
 I $D(XQORM("#")),ORUDA?1.N,ORUDA D  Q
"RTN","XQORM2",33,0)
 . I '$D(Y("#")) S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)="^"_+XQORM("#")_"^^=",Y("#")=ORUSQ
"RTN","XQORM2",34,0)
 . S Y(Y("#"))=Y(Y("#"))_ORUDA_","
"RTN","XQORM2",35,0)
 . Q
"RTN","XQORM2",36,0)
 I ORUDA="ALL" S X="ALL",ORUER=0 D ALL^XQORM4 Q
"RTN","XQORM2",37,0)
 Q
"RTN","XQORM2",38,0)
EAT F I=0:0 Q:$E(X)]" "  Q:'$L(X)  S X=$E(X,2,999)
"RTN","XQORM2",39,0)
 F I=0:0 Q:$E(X,$L(X))]" "  Q:'$L(X)  S X=$E(X,1,$L(X)-1)
"RTN","XQORM2",40,0)
 Q
"RTN","XQORM2",41,0)
ECHO W:($X+$L($P(Y(I),"^",3))+4)>IOM !,?ORUFG W $P(Y(I),"^",3),"  " Q
"RTN","XQORM2",42,0)
DISV I +Y(I) S ^DISV(DUZ,"XQORM",XQORM,I)=$P(Y(I),"^",3) Q
"RTN","XQORM2",43,0)
 I XQORM(0)["R",$L($P(Y(I),"^",3)) S ^DISV(DUZ,"XQORM",XQORM,I)=$P(Y(I),"^",3) Q
"RTN","XQORM2",44,0)
 I XQORM(0)["r",'$L($P(Y(I),"^",3)) S ^DISV(DUZ,"XQORM",XQORM,I)="^^"_$P(Y(I),"^",4)
"RTN","XQORM2",45,0)
 Q
"RTN","XQORM2",46,0)
SUB K Y(ORUB) S Y=Y-1 Q
"RTN","XQORM3")
0^6^B8955231
"RTN","XQORM3",1,0)
XQORM3 ; SLC/KCM - Lookup (cont.) ;11/12/92  11:28
"RTN","XQORM3",2,0)
 ;;8.0;KERNEL;**56**;Jul 10, 1995
"RTN","XQORM3",3,0)
LOOK ;From: XQORM2
"RTN","XQORM3",4,0)
 K ORUFD,ORUDA S ORUFD=0,ORUW=X
"RTN","XQORM3",5,0)
 I $D(^XUTL("XQORM",XQORM,"B",X)) S ORUDA=0 F I=0:0 S ORUDA=$O(^XUTL("XQORM",XQORM,"B",X,ORUDA)) Q:ORUDA=""  I '$D(ORUDA(ORUDA)) D LOOK1 Q:ORUER
"RTN","XQORM3",6,0)
 S:$E(X,$L(X),1)'=" " X=$E(X,1,$L(X)-1)_$C($A($E(X,$L(X)))-1)_"~"
"RTN","XQORM3",7,0)
 F I=0:0 S X=$O(^XUTL("XQORM",XQORM,"B",X)) Q:X=""!($E(X,1,$L(ORUW))'=ORUW)!(XQORM(0)["X"&(X'=ORUW))  S ORUDA=0 F I=0:0 S ORUDA=$O(^XUTL("XQORM",XQORM,"B",X,ORUDA)) Q:ORUDA=""  I '$D(ORUDA(ORUDA)) D LOOK1
"RTN","XQORM3",8,0)
 S ORUDA=0 Q:ORUER  I ORUFD=1 S ORUDA=ORUFD(1) Q
"RTN","XQORM3",9,0)
 I 'ORUFD,$D(XQORM("#")),ORUW?1.N D  Q:ORUDA
"RTN","XQORM3",10,0)
 . N X S X=$P(XQORM("#"),"^",2)
"RTN","XQORM3",11,0)
 . I X[":" Q:(ORUW<X)!(ORUW>$P(X,":",2))
"RTN","XQORM3",12,0)
 . I $L(X),X'[":" Q:(","_X_",")'[(","_ORUW_",")
"RTN","XQORM3",13,0)
 . S ORUDA=ORUW
"RTN","XQORM3",14,0)
 I 'ORUFD,$L($P(ORUW," ")),(($D(XQORM("KEY",$P(ORUW," ")))&('$D(XQORM("NO^^"))))!(ORUW="ALL")) S ORUDA=ORUW,ORUDA("KEY")="" Q
"RTN","XQORM3",15,0)
 I 'ORUFD,XQORM(0)["A" S ORUER=1 D NF^XQORM4 I (ORUX[",")!(ORUX["-") S ORUER=0 D PICK
"RTN","XQORM3",16,0)
 D:ORUFD>1 PICK ;S:'ORUFD ORUER=1
"RTN","XQORM3",17,0)
 Q
"RTN","XQORM3",18,0)
LOOK1 S ORUFD=ORUFD+1,ORUFD(ORUFD)=ORUDA,ORUDA(ORUDA)=""
"RTN","XQORM3",19,0)
 Q
"RTN","XQORM3",20,0)
PICK I XQORM(0)'["A" S ORUFD=0 Q
"RTN","XQORM3",21,0)
 I ORUFD F J=1:1:ORUFD W:$D(^XUTL("XQORM",XQORM,ORUFD(J),0)) !,$J(J,6),?9,$P(^(0),"^",3)
"RTN","XQORM3",22,0)
 F I=0:0 D PICK1 I $L(X)'>80,X?.ANP S:'$T X="^" Q:X'["?"  D HELP3^XQORM5
"RTN","XQORM3",23,0)
 I X="",'((ORUX[",")!(ORUX["-")) S X="^" ;reprompt if only 1 selection
"RTN","XQORM3",24,0)
 S:X="^" ORUER=1 S:X="^^" (ORUER,DIROUT)=1 S ORUFD=0 Q:ORUER
"RTN","XQORM3",25,0)
 I $L(X),$D(ORUFD(X)) S ORUDA=ORUFD(X),ORUFD=1 Q
"RTN","XQORM3",26,0)
 D:$L(X)&(X'["^") LOOK
"RTN","XQORM3",27,0)
 Q
"RTN","XQORM3",28,0)
PICK1 W !,$S(ORUX[","!(ORUX["-"):"For entry """_ORUW_""" ",1:""),$S(ORUFD:"CHOOSE 1-"_ORUFD_": ",1:"re-enter: ")
"RTN","XQORM3",29,0)
 R X:$S($D(DTIME):DTIME,1:"") D:X'?.ANP CC^XQORM4 D:$L(X)>80 LL^XQORM4 D UP^XQORM1
"RTN","XQORM3",30,0)
 Q
"RTN","XQORM3",31,0)
UPD ;from XQORM2
"RTN","XQORM3",32,0)
 S X="",ORUSQ=ORUSQ+1 S:$D(^XUTL("XQORM",XQORM,ORUDA,0)) X=^(0) I '$L(X) S ORUER=1 Q
"RTN","XQORM3",33,0)
 I $D(ORUX(ORUT,"'")) S X=$O(Y("B",ORUDA,"")) K:$L(X) Y(X),Y("B",ORUDA,X) S:$L(X) Y=Y-1 Q
"RTN","XQORM3",34,0)
 S Y=Y+1,Y(ORUSQ)=$P(X,"^",1,3),Y("B",ORUDA,ORUSQ)="",$P(Y(ORUSQ),"^",4)=ORUX(ORUT) S:$D(ORUX(ORUT,"=")) Y(ORUSQ)=Y(ORUSQ)_"="_ORUX(ORUT,"=")
"RTN","XQORM3",35,0)
 Q
"RTN","XQORM3",36,0)
RNG ;From: XQORM2
"RTN","XQORM3",37,0)
 N K Q:X'?1.N1"-"1.N
"RTN","XQORM3",38,0)
 I $P(X,"-",1)'<$P(X,"-",2) D:XQORM(0)["A" IR^XQORM4 S ORUER=1 Q
"RTN","XQORM3",39,0)
 S ORUB="" F K=$P(X,"-",1):1:$P(X,"-",2) S ORUB=ORUB_K_"," I $L(ORUB)>225 D:XQORM(0)["A" LR^XQORM4 S ORUER=1 Q
"RTN","XQORM3",40,0)
 S X=ORUB
"RTN","XQORM3",41,0)
 Q
"RTN","XQORO")
0^7^B16587336
"RTN","XQORO",1,0)
XQORO ; SLC/KCM - Order Entry Calls ;6/30/94  10:53
"RTN","XQORO",2,0)
 ;;8.0;KERNEL;**48,56**;Jul 10, 1995
"RTN","XQORO",3,0)
ENTRY ;Setup initial 'add orders' context
"RTN","XQORO",4,0)
 Q:$D(ORNOAD)  ;Flag for MAS protocols  Phase out by 11/90
"RTN","XQORO",5,0)
 I $S($D(^DD(100,0,"VR")):^("VR")<1.89,1:1) D WARN Q
"RTN","XQORO",6,0)
 I $D(^ORD(100.99,1,0)),$P(^(0),"^",16) S DIROUT="^^" W !!,$C(7),"OE/RR Software is currently being updated. Access temporarily denied.",! Q
"RTN","XQORO",7,0)
 ; I $D(XRTL) D T0^%ZOSV ; Start RT Log
"RTN","XQORO",8,0)
 I XQORNOD["ORD(101,",$P(^ORD(101,+XQORNOD,0),"^",4)'="M",$P(^(0),"^",4)'="Q" D:'$D(XQXFLG) ABT^XQ12 I $P(XQXFLG,"^",2)=1 S ORPRFRM="*"_$P(^ORD(101,+XQORNOD,0),"^") D LOGRSRC^%ZOSV("*"_ORPRFRM_" IN")
"RTN","XQORO",9,0)
 S XQORQUIT=1 Q:'$D(ORACTION)  Q:ORACTION  S (ORGY,ORACTION,OREND)=0
"RTN","XQORO",10,0)
 D ADD^OR1 I OREND!$D(ORPTLK) D:OREND PT1^ORX2 S OREND=0 Q
"RTN","XQORO",11,0)
 S ^TMP("XQORS",$J,0,"CTXT","ADD")=XQORS,^TMP("XQORS",$J,XQORS,"CTX","AD")=""
"RTN","XQORO",12,0)
 K XQORQUIT Q
"RTN","XQORO",13,0)
EVERY ;Setup for every new node in 'add orders' context
"RTN","XQORO",14,0)
 I $D(^TMP("ORPAT",$J)),^($J)'=ORVP S XQORPOP=1 W !!,"Unable to process orders for "_$P(^DPT(+ORVP,0),"^")_" until",!,"the ordering session for "_$P(^DPT(+^TMP("ORPAT",$J),0),"^"),!,"has been completed." D READ^ORUTL Q
"RTN","XQORO",15,0)
 Q:$D(ORNOAD)  ;Flag for MAS protocols  Phase out by 11/90
"RTN","XQORO",16,0)
 I $S($D(^DD(100,0,"VR")):^("VR")<1.89,1:1) D WARN Q
"RTN","XQORO",17,0)
 I $D(^ORD(100.99,1,0)),$P(^(0),"^",16) S DIROUT="^^" W !!,$C(7),"OE/RR Software is currently being updated. Access temporarily denied.",! Q
"RTN","XQORO",18,0)
 K ORIFN,ORCOST,ORIT,ORSTRT,ORSTOP,ORTO,ORPURG,ORTX,ORSTS,ORPK,ORLOG,ORPCL,OR,ORZ,ORNS
"RTN","XQORO",19,0)
 D RSTR I $P(^TMP("XQORS",$J,XQORS,"FLG"),"^")="Q",($G(^ORD(101,+XQORNOD,26))'["^OR") S XQORM("H")="S ORUIEN=XQORNOD D OE^ORUHDR K ORUIEN" D:$L($T(^ORGKEY)) SET^ORGKEY
"RTN","XQORO",20,0)
 ;I "OL"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^") S X="(for "_ORPNM_")" W !?(40-($L(X)\2)),X
"RTN","XQORO",21,0)
 I $P(^TMP("XQORS",$J,XQORS,"FLG"),"^",3),"OL"[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^"),$P(^ORD(100.99,1,0),"^",11) W !!,"<Orders for ",ORPNM,">"
"RTN","XQORO",22,0)
 S:$D(@(^TMP("XQORS",$J,XQORS,"REF")_"0)")) ORNS=$P(^(0),"^",12),ORTX=$P(^(0),"^",2)
"RTN","XQORO",23,0)
 I $S(ORNS:$S($D(^ORD(100.99,1,20,ORNS,0)):$S($P(^(0),"^",2):0,1:1),$D(^ORD(100.99,1,5,ORNS,0)):$S($P(^(0),"^",3):0,1:1),1:1),1:1) W $C(7),!,"This item is not setup to order from OE/RR",!,"(Package not setup)" S XQORQUIT=1 D READ^ORUTL Q
"RTN","XQORO",24,0)
 I ORNS,'$D(ORUP(ORNS)) S ORUP(ORNS)="" I $D(^ORD(100.99,1,5,ORNS,3)),$L(^(3)) X ^(3)
"RTN","XQORO",25,0)
 S OREND=0 K ORNS
"RTN","XQORO",26,0)
 Q
"RTN","XQORO",27,0)
EXIT ;When done adding, accept orders and transact them
"RTN","XQORO",28,0)
 N XRTN
"RTN","XQORO",29,0)
 I $S($D(^DD(100,0,"VR")):^("VR")<1.89,1:1) D WARN Q
"RTN","XQORO",30,0)
 D RSTR,AFT^OR1,RSTR K ^TMP("XQORS",$J,0,"CTXT","ADD"),^TMP("XQORS",$J,XQORS,"CTX","AD"),^TMP("ORPAT",$J) S (ORGY,ORACTION)=""
"RTN","XQORO",31,0)
 D PT1^ORX2
"RTN","XQORO",32,0)
 ; I $D(XRT0) S XRTN="ADD ORDERS" D T1^%ZOSV ; Stop RT Log
"RTN","XQORO",33,0)
 I $D(ORPRFRM) D:'$D(XQXFLG) ABT^XQ12 D:$P(XQXFLG,"^",2)=1 LOGRSRC^%ZOSV("*"_ORPRFRM_" OUT") K ORPRFRM
"RTN","XQORO",34,0)
 Q
"RTN","XQORO",35,0)
RSTR S ORVP=$P(OROLD,"^"),ORPV=$P(OROLD,"^",2),ORL=$P(OROLD,"^",3),ORTS=$P(OROLD,"^",4),ORL(0)=$P(OROLD,"^",5),ORL(1)=$P(OROLD,"^",6),ORDUZ=$P(OROLD,"^",7),ORNP=$P(OROLD,"^",8),ORL(2)=$P(OROLD,"^",9),OROLOC=$P(OROLD,"^",10)
"RTN","XQORO",36,0)
 S OROLOC=$S($L($P(OROLD,"^",10)):$P(OROLD,"^",10),1:ORL),DFN=$P(OROLD,"^",11) S:$D(^TMP("XQORS",$J,0,"CTXT","ADD")) (ORGY,ORACTION)=0
"RTN","XQORO",37,0)
 Q
"RTN","XQORO",38,0)
WARN W !,$C(7),"OE/RR is not installed.  Options of this type should not be used.",$C(7),!
"RTN","XQORO",39,0)
 Q
"VER")
8.0^21.0
**END**
**END**
