Released PX*1*182 SEQ #139
Extracted from mail message
**KIDS**:PX*1.0*182^

**INSTALL NAME**
PX*1.0*182
"BLD",6992,0)
PX*1.0*182^PCE PATIENT CARE ENCOUNTER^0^3070111^y
"BLD",6992,1,0)
^^3^3^3061102^
"BLD",6992,1,1,0)
Default DX during Appt Check Out.  Also, invalid code when entering 
"BLD",6992,1,2,0)
diagnosis for PCE procedures.  Also, if no procedure, only option is to 
"BLD",6992,1,3,0)
delete encounter.
"BLD",6992,4,0)
^9.64PA^^
"BLD",6992,6.3)
3
"BLD",6992,"ABPKG")
n
"BLD",6992,"KRN",0)
^9.67PA^8989.52^19
"BLD",6992,"KRN",.4,0)
.4
"BLD",6992,"KRN",.401,0)
.401
"BLD",6992,"KRN",.402,0)
.402
"BLD",6992,"KRN",.403,0)
.403
"BLD",6992,"KRN",.5,0)
.5
"BLD",6992,"KRN",.84,0)
.84
"BLD",6992,"KRN",3.6,0)
3.6
"BLD",6992,"KRN",3.8,0)
3.8
"BLD",6992,"KRN",9.2,0)
9.2
"BLD",6992,"KRN",9.8,0)
9.8
"BLD",6992,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",6992,"KRN",9.8,"NM",1,0)
PXBAPI1^^0^B57032482
"BLD",6992,"KRN",9.8,"NM",2,0)
PXBPPOV^^0^B22074119
"BLD",6992,"KRN",9.8,"NM",3,0)
PXCECPT^^0^B65495033
"BLD",6992,"KRN",9.8,"NM","B","PXBAPI1",1)

"BLD",6992,"KRN",9.8,"NM","B","PXBPPOV",2)

"BLD",6992,"KRN",9.8,"NM","B","PXCECPT",3)

"BLD",6992,"KRN",19,0)
19
"BLD",6992,"KRN",19.1,0)
19.1
"BLD",6992,"KRN",101,0)
101
"BLD",6992,"KRN",409.61,0)
409.61
"BLD",6992,"KRN",771,0)
771
"BLD",6992,"KRN",870,0)
870
"BLD",6992,"KRN",8989.51,0)
8989.51
"BLD",6992,"KRN",8989.52,0)
8989.52
"BLD",6992,"KRN",8994,0)
8994
"BLD",6992,"KRN","B",.4,.4)

"BLD",6992,"KRN","B",.401,.401)

"BLD",6992,"KRN","B",.402,.402)

"BLD",6992,"KRN","B",.403,.403)

"BLD",6992,"KRN","B",.5,.5)

"BLD",6992,"KRN","B",.84,.84)

"BLD",6992,"KRN","B",3.6,3.6)

"BLD",6992,"KRN","B",3.8,3.8)

"BLD",6992,"KRN","B",9.2,9.2)

"BLD",6992,"KRN","B",9.8,9.8)

"BLD",6992,"KRN","B",19,19)

"BLD",6992,"KRN","B",19.1,19.1)

"BLD",6992,"KRN","B",101,101)

"BLD",6992,"KRN","B",409.61,409.61)

"BLD",6992,"KRN","B",771,771)

"BLD",6992,"KRN","B",870,870)

"BLD",6992,"KRN","B",8989.51,8989.51)

"BLD",6992,"KRN","B",8989.52,8989.52)

"BLD",6992,"KRN","B",8994,8994)

"BLD",6992,"QUES",0)
^9.62^^
"BLD",6992,"REQB",0)
^9.611^2^2
"BLD",6992,"REQB",1,0)
PX*1.0*164^1
"BLD",6992,"REQB",2,0)
PX*1.0*170^1
"BLD",6992,"REQB","B","PX*1.0*164",1)

"BLD",6992,"REQB","B","PX*1.0*170",2)

"MBREQ")
0
"PKG",413,-1)
1^1
"PKG",413,0)
PCE PATIENT CARE ENCOUNTER^PX^Patient Care Encounter (VA Parent package)^
"PKG",413,20,0)
^9.402P^^
"PKG",413,22,0)
^9.49I^1^1
"PKG",413,22,1,0)
1.0^2960812^2960913^12537
"PKG",413,22,1,"PAH",1,0)
182^3070111
"PKG",413,22,1,"PAH",1,1,0)
^^3^3^3070111
"PKG",413,22,1,"PAH",1,1,1,0)
Default DX during Appt Check Out.  Also, invalid code when entering 
"PKG",413,22,1,"PAH",1,1,2,0)
diagnosis for PCE procedures.  Also, if no procedure, only option is to 
"PKG",413,22,1,"PAH",1,1,3,0)
delete encounter.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PXBAPI1")
0^1^B57032482^B50290247
"RTN","PXBAPI1",1,0)
PXBAPI1 ;ISL/JVS,dee - PCE's API - interview questions ;5/6/05 2:59pm
"RTN","PXBAPI1",2,0)
 ;;1.0;PCE PATIENT CARE ENCOUNTER;**1,9,23,56,104,111,113,122,116,130,147,151,124,164,182**;Aug 12, 1996;Build 3
"RTN","PXBAPI1",3,0)
 ;;
"RTN","PXBAPI1",4,0)
 Q
"RTN","PXBAPI1",5,0)
 ;
"RTN","PXBAPI1",6,0)
PROCESS(PXBEXIT) ;
"RTN","PXBAPI1",7,0)
 N PXBREQ
"RTN","PXBAPI1",8,0)
 I WHAT="INTV" D
"RTN","PXBAPI1",9,0)
 . ;-- Interview is all of the questions
"RTN","PXBAPI1",10,0)
 . D ADQ(.PXBEXIT) I PXBEXIT<1 Q 
"RTN","PXBAPI1",11,0)
1 . D PRV(.PXBEXIT) I PXBEXIT<1 Q
"RTN","PXBAPI1",12,0)
3 . D POV(.PXBEXIT) I PXBEXIT<1 Q
"RTN","PXBAPI1",13,0)
2 . D CPT(.PXBEXIT) I PXBEXIT<1 Q
"RTN","PXBAPI1",14,0)
 . I $P($G(^AUPNVSIT($G(PXBVST),150)),"^",3)="O" S PXBEXIT=0 Q
"RTN","PXBAPI1",15,0)
 . I '$$DISPOSIT^PXUTL1($G(PXBPAT),$P($G(^AUPNVSIT(PXBVST,0)),"^",1),$G(PXBVST)) D STP(.PXBEXIT) I PXBEXIT<1 Q
"RTN","PXBAPI1",16,0)
 E  I WHAT="ADDEDIT" D
"RTN","PXBAPI1",17,0)
 . D ADDEDIT
"RTN","PXBAPI1",18,0)
 E  I WHAT="ADQ" D
"RTN","PXBAPI1",19,0)
 . ;-- Adminstrative questions
"RTN","PXBAPI1",20,0)
 . D ADQ(.PXBEXIT)
"RTN","PXBAPI1",21,0)
 E  I WHAT="CODT" D
"RTN","PXBAPI1",22,0)
 . ;-- Check out Date/Time
"RTN","PXBAPI1",23,0)
 . D CODT(.PXBEXIT)
"RTN","PXBAPI1",24,0)
 . Q:PXBEXIT<1
"RTN","PXBAPI1",25,0)
 . D VISIT(.PXBEXIT)
"RTN","PXBAPI1",26,0)
 . I PXBVST'>0 S PXBEXIT=-2 Q
"RTN","PXBAPI1",27,0)
 E  I WHAT="SCC" D
"RTN","PXBAPI1",28,0)
 . ;-- Service connected conditions
"RTN","PXBAPI1",29,0)
 . S PXCECAT="VST" D SCC(.PXBEXIT) K PXCECAT
"RTN","PXBAPI1",30,0)
 . Q:PXBEXIT<1
"RTN","PXBAPI1",31,0)
 . D VISIT(.PXBEXIT)
"RTN","PXBAPI1",32,0)
 . I PXBVST'>0 S PXBEXIT=-2 Q
"RTN","PXBAPI1",33,0)
 E  I WHAT="PRV" D
"RTN","PXBAPI1",34,0)
 . ;-- Providers
"RTN","PXBAPI1",35,0)
 . D PRV(.PXBEXIT)
"RTN","PXBAPI1",36,0)
 E  I WHAT="CPT" D
"RTN","PXBAPI1",37,0)
 . ;-- Providers and CPT codes
"RTN","PXBAPI1",38,0)
 . D CPT(.PXBEXIT)
"RTN","PXBAPI1",39,0)
 E  I WHAT="POV" D
"RTN","PXBAPI1",40,0)
 . ;-- Diagnoses
"RTN","PXBAPI1",41,0)
 . D POV(.PXBEXIT)
"RTN","PXBAPI1",42,0)
 E  I WHAT="STP" D
"RTN","PXBAPI1",43,0)
 . ;-- Stop Codes
"RTN","PXBAPI1",44,0)
 . D STP(.PXBEXIT)
"RTN","PXBAPI1",45,0)
 E  S PXBEXIT=-3 W !,"Procedure ""INTV^PXAPI"" was called incorrectly, contact IRM."
"RTN","PXBAPI1",46,0)
 Q
"RTN","PXBAPI1",47,0)
 ;
"RTN","PXBAPI1",48,0)
ADDEDIT ;
"RTN","PXBAPI1",49,0)
 N PXANS
"RTN","PXBAPI1",50,0)
ADDEDIT1 ;
"RTN","PXBAPI1",51,0)
 D ADQ(.PXBEXIT)
"RTN","PXBAPI1",52,0)
 G:PXBEXIT<1 ADDEDIT2
"RTN","PXBAPI1",53,0)
 D PRV(.PXBEXIT)
"RTN","PXBAPI1",54,0)
 G:PXBEXIT<1 ADDEDIT2
"RTN","PXBAPI1",55,0)
 D POV(.PXBEXIT)
"RTN","PXBAPI1",56,0)
 G:PXBEXIT<1 ADDEDIT2
"RTN","PXBAPI1",57,0)
 ;
"RTN","PXBAPI1",58,0)
 ;Call to CPT is not determined by a credit stop code any more
"RTN","PXBAPI1",59,0)
 ;
"RTN","PXBAPI1",60,0)
 D CPT(.PXBEXIT)
"RTN","PXBAPI1",61,0)
 G:PXBEXIT<1 ADDEDIT2
"RTN","PXBAPI1",62,0)
 I PXBVST>0,'$D(^AUPNVCPT("AD",PXBVST)) D ADDEDIT3   ;PX*1.0*182
"RTN","PXBAPI1",63,0)
 Q   ; PX*1.0*182 added quit, otherwise user is forced to delete enc.
"RTN","PXBAPI1",64,0)
 ;
"RTN","PXBAPI1",65,0)
ADDEDIT2 ;
"RTN","PXBAPI1",66,0)
 I PXBVST>0,'$D(^AUPNVCPT("AD",PXBVST)),'$D(^AUPNVSIT("AD",PXBVST)) D  I PXANS'=1 S PXBEXIT=1 G ADDEDIT1
"RTN","PXBAPI1",67,0)
 . N DIR,X,Y
"RTN","PXBAPI1",68,0)
 . W !!
"RTN","PXBAPI1",69,0)
 . S DIR(0)="Y"
"RTN","PXBAPI1",70,0)
 . S DIR("A",1)="Must have a STOP CODE or a PROCEDURE to complete this action."
"RTN","PXBAPI1",71,0)
 . S DIR("A")="Do you want to delete this encounter"
"RTN","PXBAPI1",72,0)
 . S DIR("B")="NO"
"RTN","PXBAPI1",73,0)
 . D ^DIR
"RTN","PXBAPI1",74,0)
 . S PXANS=Y
"RTN","PXBAPI1",75,0)
 . Q:PXANS'=1
"RTN","PXBAPI1",76,0)
 . I $$DELVFILE^PXAPIDEL("ALL",PXBVST,"","","","","")=1 S PXBEXIT=-1
"RTN","PXBAPI1",77,0)
 I PXBVST>0,'$D(^AUPNVSIT(PXBVST,0)) S PXBVST=""
"RTN","PXBAPI1",78,0)
 Q
"RTN","PXBAPI1",79,0)
 ;
"RTN","PXBAPI1",80,0)
ADDEDIT3 ;added PX*1.0*182
"RTN","PXBAPI1",81,0)
 N DIR,X,Y
"RTN","PXBAPI1",82,0)
 W !!
"RTN","PXBAPI1",83,0)
 S DIR(0)="Y"
"RTN","PXBAPI1",84,0)
 S DIR("A",1)="Must have a STOP CODE or a PROCEDURE to complete this action."
"RTN","PXBAPI1",85,0)
 S DIR("A")="Do you want to delete this encounter"
"RTN","PXBAPI1",86,0)
 S DIR("B")="NO"
"RTN","PXBAPI1",87,0)
 D ^DIR
"RTN","PXBAPI1",88,0)
 Q:Y'=1
"RTN","PXBAPI1",89,0)
 I $$DELVFILE^PXAPIDEL("ALL",PXBVST,"","","","","")=1 S PXBVST=""
"RTN","PXBAPI1",90,0)
 Q
"RTN","PXBAPI1",91,0)
 ;
"RTN","PXBAPI1",92,0)
ADQ(PXBEXIT) ;Ask the Administration questions
"RTN","PXBAPI1",93,0)
 I PXBVST'>0 D
"RTN","PXBAPI1",94,0)
 . ;This is only done for new visits
"RTN","PXBAPI1",95,0)
 . I PXBPAT'>0 S PXBPAT=$$ASKPAT I PXBPAT'>0 S PXBEXIT=-1 Q
"RTN","PXBAPI1",96,0)
 . S DFN=PXBPAT
"RTN","PXBAPI1",97,0)
 . I PXBHLOC'>0 S PXBHLOC=$$ASKHL I PXBHLOC'>0 S PXBEXIT=-1 Q
"RTN","PXBAPI1",98,0)
 . S PXBVSTDT=$S(PXBAPPT>0:PXBAPPT,1:$$ASKDT) I PXBVSTDT'>0 S PXBEXIT=-1 Q
"RTN","PXBAPI1",99,0)
 . I PXBAPPT'>0&PXBHLOC'=+$G(^DPT(PXBPAT,"S",PXBVSTDT,0)) D
"RTN","PXBAPI1",100,0)
 .. ;This is only done if there is no appointment.
"RTN","PXBAPI1",101,0)
 .. S PXELAP=$$ELAP^SDPCE(PXBPAT,PXBHLOC)
"RTN","PXBAPI1",102,0)
 I PXBEXIT'<1,PXBHLOC'>0 S PXBHLOC=$$ASKHL I PXBHLOC'>0 S PXBEXIT=-1 Q
"RTN","PXBAPI1",103,0)
 I PXBEXIT'<1 D CODT(.PXBEXIT)
"RTN","PXBAPI1",104,0)
 I PXBEXIT'<1,WHAT'="INTV" S PXCECAT="VST" D SCC(.PXBEXIT) K PXCECAT
"RTN","PXBAPI1",105,0)
 I PXBEXIT'<1 D
"RTN","PXBAPI1",106,0)
 . D VISIT(.PXBEXIT)
"RTN","PXBAPI1",107,0)
 . I PXBVST'>0 S PXBEXIT=-2 Q
"RTN","PXBAPI1",108,0)
 Q
"RTN","PXBAPI1",109,0)
 ;
"RTN","PXBAPI1",110,0)
ASKPAT() ;Ask user for a patient
"RTN","PXBAPI1",111,0)
 ;DIC on file 9000001
"RTN","PXBAPI1",112,0)
 N DIR,DIC,Y,X,DA
"RTN","PXBAPI1",113,0)
 S DIR(0)="P^9000001:AEMQ"
"RTN","PXBAPI1",114,0)
 S DIR("A")="Patient Name"
"RTN","PXBAPI1",115,0)
 D ^DIR
"RTN","PXBAPI1",116,0)
 Q $S(+Y>0:+Y,1:-1)
"RTN","PXBAPI1",117,0)
 ;
"RTN","PXBAPI1",118,0)
ASKHL() ;Ask user for a Hospital Location
"RTN","PXBAPI1",119,0)
ASKHL2 ;DIC on file 44
"RTN","PXBAPI1",120,0)
 N DIR,DIC,Y,X,DA,PXRES
"RTN","PXBAPI1",121,0)
 S DIR(0)="PA^44:AEMQ"
"RTN","PXBAPI1",122,0)
 S DIR("A")="Clinic: "
"RTN","PXBAPI1",123,0)
 ; not occasion of service and not dispositioning
"RTN","PXBAPI1",124,0)
 ;I PXALHLOC S DIR("S")="I '+$G(^(""OOS""))&'$O(^PX(815,1,""DHL"",""B"",Y,0))"
"RTN","PXBAPI1",125,0)
 ; not occasion of service only   ;PX*1.0*116
"RTN","PXBAPI1",126,0)
 I PXALHLOC S DIR("S")="I '+$G(^(""OOS""))"   ;PX*1.0*116
"RTN","PXBAPI1",127,0)
 ; only clinic that are not occasion of service and not dispositioning
"RTN","PXBAPI1",128,0)
 ;E  S DIR("S")="I $P(^(0),U,3)=""C""&'+$G(^(""OOS""))&'$O(^PX(815,1,""DHL"",""B"",Y,0))"
"RTN","PXBAPI1",129,0)
 E  S DIR("S")="I $P(^(0),U,3)=""C""&'+$G(^(""OOS""))"   ;PX*1.0*116
"RTN","PXBAPI1",130,0)
 D ^DIR
"RTN","PXBAPI1",131,0)
 ;enable to select a disposition clinic   ;PX*1.0*116
"RTN","PXBAPI1",132,0)
 ;I $D(^PX(815,1,"DHL","B",+Y)) D HELPDISP^PXCEVSIT W !,$C(7) G ASKHL2
"RTN","PXBAPI1",133,0)
 ; disallow selection of clinics with non conforming stop codes
"RTN","PXBAPI1",134,0)
 I +Y>0 S PXRES=$$CLNCK^SDUTL2(+Y,1) I 'PXRES D  G ASKHL2
"RTN","PXBAPI1",135,0)
 .W !,?5,"Clinic MUST be corrected before continuing."
"RTN","PXBAPI1",136,0)
 Q $S(+Y>0:+Y,1:-1)
"RTN","PXBAPI1",137,0)
 ;
"RTN","PXBAPI1",138,0)
ASKDT() ;Ask user for the encounter Date/Time
"RTN","PXBAPI1",139,0)
 N DIR,Y,X,DA
"RTN","PXBAPI1",140,0)
 S DIR(0)="D^"_$S(PXLIMDT>2960000:PXLIMDT,1:"")_":"_(DT+.24)_":AEPRSX"
"RTN","PXBAPI1",141,0)
 S DIR("A")="Encounter Date and Time"
"RTN","PXBAPI1",142,0)
 S DIR("?")="Enter the Date and Time of this encounter"
"RTN","PXBAPI1",143,0)
 D ^DIR
"RTN","PXBAPI1",144,0)
 Q $S(+Y>0:+Y,1:-1)
"RTN","PXBAPI1",145,0)
 ;
"RTN","PXBAPI1",146,0)
CODT(PXBEXIT) ;Ask the user the Check out Date/Time
"RTN","PXBAPI1",147,0)
 N PXCHKOUT
"RTN","PXBAPI1",148,0)
 D CHIKOUT^PXBAPI2("",PXBPAT,PXBHLOC,PXBVSTDT)
"RTN","PXBAPI1",149,0)
 S PXBCODT=PXCHKOUT
"RTN","PXBAPI1",150,0)
 S:PXCHKOUT=-1 PXBCODT=""
"RTN","PXBAPI1",151,0)
 ;; PX*1*113 - Change for EAS*1*3 Appointment processing removed
"RTN","PXBAPI1",152,0)
 ;S X="EASMTCHK" X ^%ZOSF("TEST") I $T D  Q:PXBEXIT<1
"RTN","PXBAPI1",153,0)
 ;. S:$G(EASACT)'="W" EASACT="C"
"RTN","PXBAPI1",154,0)
 ;. I $$MT^EASMTCHK(PXBPAT,"",EASACT,PXBVSTDT) D  S PXBEXIT=-1
"RTN","PXBAPI1",155,0)
 ;. . D PAUSE^VALM1
"RTN","PXBAPI1",156,0)
 I WHAT'["ADDEDIT",PXCHKOUT=-1 S PXBEXIT=-1
"RTN","PXBAPI1",157,0)
 I $G(PXBVST),$$DISPOSIT^PXUTL1(DFN,$P($G(^AUPNVSIT(PXBVST,0)),"^",1),PXBVST) S PXBEXIT=1
"RTN","PXBAPI1",158,0)
 Q
"RTN","PXBAPI1",159,0)
 ;
"RTN","PXBAPI1",160,0)
SCC(PXBEXIT) ;Ask the user the Service connected conditions
"RTN","PXBAPI1",161,0)
 N PXBDATA,PXBCLASS,PXBOUTEN,PXDOD
"RTN","PXBAPI1",162,0)
 S (PXBOUTEN,PXDOD)=""
"RTN","PXBAPI1",163,0)
 ;I $$APPOINT^PXUTL1(PXBPAT,PXBVSTDT,PXBHLOC) D
"RTN","PXBAPI1",164,0)
 ;. S PXBOUTEN=$P($G(^DPT(+PXBPAT,"S",+PXBVSTDT,0)),"^",20)
"RTN","PXBAPI1",165,0)
 ;E  I $$DISPOSIT^PXUTL1(PXBPAT,PXBVSTDT,PXBVST) D
"RTN","PXBAPI1",166,0)
 ;. S PXBOUTEN=+$P($G(^DPT(+PXBPAT,"DIS",9999999-PXBVSTDT,0)),"^",18)
"RTN","PXBAPI1",167,0)
 ;I 'PXBOUTEN,$G(PXBVST)>0 S PXBOUTEN=$O(^SCE("AVSIT",PXBVST,0))
"RTN","PXBAPI1",168,0)
 ;D CLASS^PXBAPI21(PXBOUTEN,PXBPAT,PXBVSTDT,PXBHLOC)
"RTN","PXBAPI1",169,0)
 D CLASS^PXBAPI21(PXBOUTEN,PXBPAT,PXBVSTDT,PXBHLOC,PXBVST)
"RTN","PXBAPI1",170,0)
 ;PX*1*111 - Add HNC
"RTN","PXBAPI1",171,0)
 F PXBCLASS=1:1:7 I $G(PXBDATA("ERR",PXBCLASS))=4 S PXBEXIT=-1 Q  ; changed 6/17/98 for MST enhancement
"RTN","PXBAPI1",172,0)
 Q:PXBEXIT<1
"RTN","PXBAPI1",173,0)
 I $G(PXDOD) S PXBEXIT=-1 Q
"RTN","PXBAPI1",174,0)
 S PXB800(1)=$P($G(PXBDATA(3)),"^",2)
"RTN","PXBAPI1",175,0)
 S PXB800(2)=$P($G(PXBDATA(1)),"^",2)
"RTN","PXBAPI1",176,0)
 S PXB800(3)=$P($G(PXBDATA(2)),"^",2)
"RTN","PXBAPI1",177,0)
 S PXB800(4)=$P($G(PXBDATA(4)),"^",2)
"RTN","PXBAPI1",178,0)
 S PXB800(5)=$P($G(PXBDATA(5)),"^",2) ;added 6/17/98 for MST enhancement
"RTN","PXBAPI1",179,0)
 ;PX*1*111 - Add HNC
"RTN","PXBAPI1",180,0)
 S PXB800(6)=$P($G(PXBDATA(6)),"^",2)
"RTN","PXBAPI1",181,0)
 S PXB800(7)=$P($G(PXBDATA(7)),"^",2)
"RTN","PXBAPI1",182,0)
 Q
"RTN","PXBAPI1",183,0)
 ;
"RTN","PXBAPI1",184,0)
VISIT(PXBEXIT) ;Creat or edit the Visit
"RTN","PXBAPI1",185,0)
 ;Set up ^TMP("PXK",$J and call PXK
"RTN","PXBAPI1",186,0)
 I PXBVST>0 L +^AUPNVSIT(PXBVST):10 E  W !!,$C(7),"Cannot edit at this time, try again later." D WAIT^PXCEHELP S PXBEXIT=-2 Q
"RTN","PXBAPI1",187,0)
 K ^TMP("PXK",$J)
"RTN","PXBAPI1",188,0)
 N PXBNODE,PXBAFTER,PXKERROR
"RTN","PXBAPI1",189,0)
 F PXBNODE=0,21,150,800,811,812 D
"RTN","PXBAPI1",190,0)
 . S PXBAFTER(PXBNODE)=$S(PXBVST>0:$G(^AUPNVSIT(PXBVST,PXBNODE)),1:"")
"RTN","PXBAPI1",191,0)
 . S ^TMP("PXK",$J,"VST",1,PXBNODE,"BEFORE")=PXBAFTER(PXBNODE)
"RTN","PXBAPI1",192,0)
 I PXBVST'>0 D
"RTN","PXBAPI1",193,0)
 . S $P(PXBAFTER(0),"^",1)=PXBVSTDT
"RTN","PXBAPI1",194,0)
 . S $P(PXBAFTER(0),"^",5)=PXBPAT
"RTN","PXBAPI1",195,0)
 . S $P(PXBAFTER(0),"^",8)=$P(^SC(PXBHLOC,0),"^",7)
"RTN","PXBAPI1",196,0)
 . S:PXBAPPT>0 $P(PXBAFTER(0),"^",7)="A" ;PX*1*124
"RTN","PXBAPI1",197,0)
 . S $P(PXBAFTER(150),"^",3)="P"
"RTN","PXBAPI1",198,0)
 . S $P(PXBAFTER(812),"^",2)=PXBPKG
"RTN","PXBAPI1",199,0)
 . S $P(PXBAFTER(812),"^",3)=PXBSOURC
"RTN","PXBAPI1",200,0)
 S $P(PXBAFTER(0),"^",18)=$G(PXBCODT)
"RTN","PXBAPI1",201,0)
 S:$P(PXBAFTER(0),"^",22)="" $P(PXBAFTER(0),"^",22)=PXBHLOC
"RTN","PXBAPI1",202,0)
 S $P(PXBAFTER(800),"^",1)=$G(PXB800(1))
"RTN","PXBAPI1",203,0)
 S $P(PXBAFTER(800),"^",2)=$G(PXB800(2))
"RTN","PXBAPI1",204,0)
 S $P(PXBAFTER(800),"^",3)=$G(PXB800(3))
"RTN","PXBAPI1",205,0)
 S $P(PXBAFTER(800),"^",4)=$G(PXB800(4))
"RTN","PXBAPI1",206,0)
 S $P(PXBAFTER(800),"^",5)=$G(PXB800(5)) ;added 6/17/98 for MST emhancement
"RTN","PXBAPI1",207,0)
 ;PX*1*111 - Add HNC
"RTN","PXBAPI1",208,0)
 S $P(PXBAFTER(800),"^",6)=$G(PXB800(6))
"RTN","PXBAPI1",209,0)
 S $P(PXBAFTER(800),"^",7)=$G(PXB800(7))
"RTN","PXBAPI1",210,0)
 I $D(PXELAP)#2 D
"RTN","PXBAPI1",211,0)
 . S $P(PXBAFTER(0),"^",21)=+PXELAP
"RTN","PXBAPI1",212,0)
 F PXBNODE=0,21,150,800,811,812 D
"RTN","PXBAPI1",213,0)
 . S ^TMP("PXK",$J,"VST",1,PXBNODE,"AFTER")=PXBAFTER(PXBNODE)
"RTN","PXBAPI1",214,0)
 S ^TMP("PXK",$J,"VST",1,"IEN")=$S(PXBVST>0:PXBVST,1:"")
"RTN","PXBAPI1",215,0)
 S ^TMP("PXK",$J,"SOR")=PXBSOURC
"RTN","PXBAPI1",216,0)
 D EN1^PXKMAIN
"RTN","PXBAPI1",217,0)
 I PXBVST>0 L -^AUPNVSIT(PXBVST):5
"RTN","PXBAPI1",218,0)
 S PXBVST=$G(^TMP("PXK",$J,"VST",1,"IEN"))
"RTN","PXBAPI1",219,0)
 Q
"RTN","PXBAPI1",220,0)
 ;
"RTN","PXBAPI1",221,0)
CPT(PXBEXIT) ;Ask the user Providers and CTPs
"RTN","PXBAPI1",222,0)
 D CPT^PXBMCPT(PXBVST) K PRVDR
"RTN","PXBAPI1",223,0)
 Q
"RTN","PXBAPI1",224,0)
 ;
"RTN","PXBAPI1",225,0)
POV(PXBEXIT) ;Ask the user Diagnoses
"RTN","PXBAPI1",226,0)
 D POV^PXBMPOV(PXBVST) K PRVDR
"RTN","PXBAPI1",227,0)
 Q
"RTN","PXBAPI1",228,0)
 ;
"RTN","PXBAPI1",229,0)
PRV(PXBEXIT) ;Ask the user Providers
"RTN","PXBAPI1",230,0)
 D PRV^PXBMPRV(PXBVST,"PRV") K PRVDR
"RTN","PXBAPI1",231,0)
 Q
"RTN","PXBAPI1",232,0)
 ;
"RTN","PXBAPI1",233,0)
STP(PXBEXIT) ;Ask the user Stop Codes
"RTN","PXBAPI1",234,0)
 I $L($T(DATE^SCDXUTL)),$$DATE^SCDXUTL(+$G(^AUPNVSIT(PXBVST,0))) Q
"RTN","PXBAPI1",235,0)
 D STP^PXBMSTP(PXBVST) K PRVDR
"RTN","PXBAPI1",236,0)
 Q
"RTN","PXBAPI1",237,0)
 ;
"RTN","PXBPPOV")
0^2^B22074119^B22000180
"RTN","PXBPPOV",1,0)
PXBPPOV ;ISL/JVS - PROMPT POV ;8/31/05
"RTN","PXBPPOV",2,0)
 ;;1.0;PCE PATIENT CARE ENCOUNTER;**11,28,92,121,149,124,170,182**;Aug 12, 1996;Build 3
"RTN","PXBPPOV",3,0)
 ;
"RTN","PXBPPOV",4,0)
 ; VARIABLE LIST
"RTN","PXBPPOV",5,0)
 ; SELINE= Line number of selected item
"RTN","PXBPPOV",6,0)
 ;
"RTN","PXBPPOV",7,0)
POV ;--DIAGNOSIS
"RTN","PXBPPOV",8,0)
 I $D(PXBNPOVL) D LOC^PXBCC(2,0) W IOUON,"Previous Entry:   ",$G(PXBNPOVL(1)) F I=1:1:10 W " "
"RTN","PXBPPOV",9,0)
 W IOUOFF
"RTN","PXBPPOV",10,0)
 N TIMED,EDATA,DIC,LINE,XFLAG,SELINE,PXBEDIS,FPL,CNT
"RTN","PXBPPOV",11,0)
 I '$D(^DISV(DUZ,"PXBPOV-3")) S ^DISV(DUZ,"PXBPOV-3")="   "
"RTN","PXBPPOV",12,0)
 I '$D(IOSC) D TERM^PXBCC
"RTN","PXBPPOV",13,0)
 S DOUBLEQQ=0
"RTN","PXBPPOV",14,0)
 S TIMED="I '$T!(DATA=""^"")"
"RTN","PXBPPOV",15,0)
 S DIC("S")="I $P($$ICDDX^ICDCODE(Y,IDATE),U,10)"
"RTN","PXBPPOV",16,0)
P ;--Second Entry point
"RTN","PXBPPOV",17,0)
 W IOSC K FPL,EDATA,DATA
"RTN","PXBPPOV",18,0)
 ;---DYNAMIC HEADER---
"RTN","PXBPPOV",19,0)
 I '$D(CYCL) D
"RTN","PXBPPOV",20,0)
 .S CNT=$G(PXBCNT)\2
"RTN","PXBPPOV",21,0)
 .I CNT=0,DOUBLEQQ=0 D LOC^PXBCC(1,10) W "...There are "_CNT_" ICD CODES associated with this encounter."
"RTN","PXBPPOV",22,0)
 .I CNT=1,DOUBLEQQ=0 D LOC^PXBCC(1,10) W "...There is "_CNT_" ICD CODE associated with this encounter."
"RTN","PXBPPOV",23,0)
 .I CNT>1,DOUBLEQQ=0 D LOC^PXBCC(1,10) W "...There are "_CNT_" ICD CODES associated with this encounter."
"RTN","PXBPPOV",24,0)
 D LOC^PXBCC(15,0)
"RTN","PXBPPOV",25,0)
 I PXBCNT>10&('$G(DOUBLEQQ)) W !,"Enter '+' for next page, '-' for previous page."
"RTN","PXBPPOV",26,0)
 I '$D(^TMP("PXK",$J,"POV")) W !,"Enter Diagnosis : "_$G(PXBDPOV) W:$D(PXBDPOV) " //" W IOELEOL
"RTN","PXBPPOV",27,0)
 I $D(^TMP("PXK",$J,"POV")) W !,"Enter ",IOINHI,"NEXT",IOINLOW," Diagnosis : "_$G(PXBDPOV) W:$D(PXBDPOV) " //" W IOELEOL
"RTN","PXBPPOV",28,0)
 R DATA:DTIME S EDATA=DATA
"RTN","PXBPPOV",29,0)
P1 ;--Third entry point
"RTN","PXBPPOV",30,0)
 X TIMED I  S PXBUT=1,LEAVE=1,DATA="^" G POVX
"RTN","PXBPPOV",31,0)
 I DATA?1.N1"E".NAP S DATA=" "_DATA
"RTN","PXBPPOV",32,0)
 I DATA?24.N S (DATA,EDATA)=$E(DATA,1,24)
"RTN","PXBPPOV",33,0)
 I $L(DATA)>200 S (DATA,EDATA)=$E(DATA,1,199)
"RTN","PXBPPOV",34,0)
 D CASE^PXBUTL
"RTN","PXBPPOV",35,0)
 ;----SPACE BAR---
"RTN","PXBPPOV",36,0)
 I DATA=" ",$D(^DISV(DUZ,"PXBPOV-3")) S DATA=^DISV(DUZ,"PXBPOV-3") W DATA
"RTN","PXBPPOV",37,0)
 ;-----------------
"RTN","PXBPPOV",38,0)
 I DATA="^^" S PXBEXIT=0 G POVX
"RTN","PXBPPOV",39,0)
 ;---I Prompt can jump to others put symbols in here
"RTN","PXBPPOV",40,0)
 I DATA["^P" G POVX
"RTN","PXBPPOV",41,0)
 ;------PXBDPOV=DEFAULT POV---PX*1.0*182 - added variable EDATA
"RTN","PXBPPOV",42,0)
 I DATA="",$D(PXBDPOV) S DATA=$P($G(PXBDPOV),"--",1),EDATA=DATA
"RTN","PXBPPOV",43,0)
 I DATA="",'$D(PXBDPOV) S PXBUT=1,PXBSPL="",LEAVE=1 G POVX
"RTN","PXBPPOV",44,0)
 I PXBCNT>10&((DATA="+")!(DATA="-")) D DPOV4^PXBDPOV(DATA) G P
"RTN","PXBPPOV",45,0)
 ;
"RTN","PXBPPOV",46,0)
M ;--------IF Multiple entries have been entered
"RTN","PXBPPOV",47,0)
 D ADDM^PXBPPOV1
"RTN","PXBPPOV",48,0)
 I $G(NF) G P1
"RTN","PXBPPOV",49,0)
 ;
"RTN","PXBPPOV",50,0)
 ;--------IF Multiple deleting of entries
"RTN","PXBPPOV",51,0)
 D DELM^PXBPPOV1
"RTN","PXBPPOV",52,0)
 I $G(NF) G P1
"RTN","PXBPPOV",53,0)
 ;
"RTN","PXBPPOV",54,0)
LI ;--------If picked a line number
"RTN","PXBPPOV",55,0)
 I (DATA>0)&(DATA<(PXBCNT+1))&($L(DATA)'>$L(PXBCNT)) S XFLAG=1 D REVPOV^PXBCC(DATA) S SELINE=DATA D
"RTN","PXBPPOV",56,0)
 .F I=1:1:$L(DATA) W IOCUB,IOECH
"RTN","PXBPPOV",57,0)
 .S PRISEC=$P($G(PXBSAM(DATA)),"^",4) S:PRISEC["PRI" FPRI=0
"RTN","PXBPPOV",58,0)
 .S DATA=$P($G(PXBSAM(DATA)),"^",1)
"RTN","PXBPPOV",59,0)
 I $D(XFLAG),XFLAG=1 S (Y,EDATA)=DATA G PFIN
"RTN","PXBPPOV",60,0)
LI1 ;
"RTN","PXBPPOV",61,0)
 ;--------If POV is already in the file
"RTN","PXBPPOV",62,0)
 I '$G(DOUBLEQQ),$D(PXBKY(DATA)) D
"RTN","PXBPPOV",63,0)
 .I PXBCNT>10 D DPOV4^PXBDPOV($O(PXBKY(DATA,0)))
"RTN","PXBPPOV",64,0)
 .K Q D TIMES^PXBUTL(DATA)
"RTN","PXBPPOV",65,0)
 .I Q=1 S LINE=$O(PXBKY(DATA,0)) S XFLAG=1 D REVPOV^PXBCC(LINE) S PRISEC=$P($G(PXBSAM(LINE)),"^",2) S:PRISEC["PRI" FPRI=0
"RTN","PXBPPOV",66,0)
 .I Q>1 S NLINE=0 F  S NLINE=$O(Q(NLINE)) Q:NLINE=""  D REVPOV^PXBCC(NLINE)
"RTN","PXBPPOV",67,0)
 I $D(Q),Q>1 D WHICH^PXBPWCH G LI
"RTN","PXBPPOV",68,0)
 I $D(XFLAG),XFLAG=1 S Y=DATA G PFIN
"RTN","PXBPPOV",69,0)
 ;
"RTN","PXBPPOV",70,0)
 ;--------Need to do a DIC lookup on data
"RTN","PXBPPOV",71,0)
 I DATA'="??" D:DATA="?" EN1^PXBHLP0("PXB","POV",1,"",1) G:DATA="^P" P1 I DATA="?" G P
"RTN","PXBPPOV",72,0)
 I DATA="??" S DOUBLEQQ=1 D EN1^PXBHLP0("PXB","POV","",1,2) S:$L(DATA,"^")>1 (Y,DATA,EDATA)=$P($P(DATA,"^",2),"--",1) G:Y>1 PFIN G:Y?1A1.NP PFIN I DATA<1 S DATA="^P" G P1
"RTN","PXBPPOV",73,0)
 ;
"RTN","PXBPPOV",74,0)
 ;--If a "?" is NOT entered during lookup
"RTN","PXBPPOV",75,0)
 K X,DIC
"RTN","PXBPPOV",76,0)
 S X=EDATA
"RTN","PXBPPOV",77,0)
 D CONFIG^LEXSET("ICD",,IDATE)
"RTN","PXBPPOV",78,0)
 S DIC("A")="Select Diagnosis:"
"RTN","PXBPPOV",79,0)
 S DIC="^LEX(757.01,",DIC(0)=$S('$L($G(X)):"A",1:"")_"EQM"
"RTN","PXBPPOV",80,0)
 D ^DIC
"RTN","PXBPPOV",81,0)
 I X="@" Q
"RTN","PXBPPOV",82,0)
 I Y=-1 S DATA="^P" G P1
"RTN","PXBPPOV",83,0)
 S WHAT=$G(Y(1))
"RTN","PXBPPOV",84,0)
 S X="`"_+$$CODEN^ICDCODE(WHAT,80)
"RTN","PXBPPOV",85,0)
 S (DATA,EDATA)=WHAT K Y
"RTN","PXBPPOV",86,0)
 S DIC=80,DIC(0)="MZ",DIC("S")="I $P($$ICDDX^ICDCODE(Y,IDATE),U,10)" D ^DIC
"RTN","PXBPPOV",87,0)
 ;
"RTN","PXBPPOV",88,0)
 ;--If Y is good and already in file...
"RTN","PXBPPOV",89,0)
 I '$G(DOUBLEQQ),$D(Y),$D(PXBKY($P(Y,"^",2))) D
"RTN","PXBPPOV",90,0)
 .S LINE=$O(PXBKY($P(Y,"^",2),0)) ;---D REVPOV^PXBCC(LINE)
"RTN","PXBPPOV",91,0)
 .S PRISEC=$P($G(PXBSAM(LINE)),"^",4) S:PRISEC["PRI" FPRI=0
"RTN","PXBPPOV",92,0)
 S POV=Y(0)
"RTN","PXBPPOV",93,0)
 ;
"RTN","PXBPPOV",94,0)
PFIN ;--Finish the DIAGNOSIS
"RTN","PXBPPOV",95,0)
 I $L(Y,"^")'>1 S X=Y,DIC=80,DIC(0)="IZM",DIC("S")="I $P($$ICDDX^ICDCODE(Y,IDATE),U,10)" D ^DIC
"RTN","PXBPPOV",96,0)
 I +Y<0 D HELP1^PXBUTL1("POV") G P
"RTN","PXBPPOV",97,0)
 S POV=Y(0)
"RTN","PXBPPOV",98,0)
 ;get the correct diagnosis descriptor
"RTN","PXBPPOV",99,0)
 N DXINF S DXINF=$$ICDDX^ICDCODE(+Y,IDATE),$P(POV,U,3)=$P(DXINF,U,4)
"RTN","PXBPPOV",100,0)
 S PXBNPOV($P(POV,"^",1))=""
"RTN","PXBPPOV",101,0)
 S PXBNPOVL(1)=$P(POV,"^",1) S ^DISV(DUZ,"PXBPOV-3")=DATA
"RTN","PXBPPOV",102,0)
 I $D(PXBKY($P(Y(0),"^"))),$G(SELINE) S $P(REQI,"^",9)=$O(PXBSKY(SELINE,0))
"RTN","PXBPPOV",103,0)
 I $D(PXBKY($P(Y(0),"^"))),'$G(SELINE) S $P(REQI,"^",9)=$O(PXBSKY($O(PXBKY($P(Y(0),"^"),0)),0))
"RTN","PXBPPOV",104,0)
 I +Y>0 S PXBEDIS=$P(DXINF,U,4)
"RTN","PXBPPOV",105,0)
 S $P(REQI,"^",5)=+Y,$P(REQI,"^",6)="S"
"RTN","PXBPPOV",106,0)
 S $P(REQE,"^",5)=$P(POV,"^",1)_" --"_$G(PXBEDIS),$P(REQE,"^",6)="SECONDARY"
"RTN","PXBPPOV",107,0)
POVX ;--EXIT AND CLEAN UP
"RTN","PXBPPOV",108,0)
 I $G(WHAT)="INTV",DATA="^" S PXBEXIT="^^"
"RTN","PXBPPOV",109,0)
 I '$D(REQE) S REQE=""
"RTN","PXBPPOV",110,0)
 I $P(REQE,"^",5)="" S $P(REQE,"^",5)="...No Diagnosis Selected..."
"RTN","PXBPPOV",111,0)
 Q
"RTN","PXCECPT")
0^3^B65495033^B65152198
"RTN","PXCECPT",1,0)
PXCECPT ;ISL/dee,ISA/Zoltan,esw - Used to edit and display V CPT ;6/22/04 3:27pm
"RTN","PXCECPT",2,0)
 ;;1.0;PCE PATIENT CARE ENCOUNTER;**14,27,73,89,112,121,136,124,170,164,182**;Aug 12, 1996;Build 3
"RTN","PXCECPT",3,0)
 ;; ;
"RTN","PXCECPT",4,0)
 Q
"RTN","PXCECPT",5,0)
 ;
"RTN","PXCECPT",6,0)
 ;+Structure of Line with the line label "FORMAT"
"RTN","PXCECPT",7,0)
 ;+;;Long name~File Number~Node Subscripts~Allow Duplicate entries (1=yes, 0=no)~File global name
"RTN","PXCECPT",8,0)
 ;+      1         2             3                   4                                   5
"RTN","PXCECPT",9,0)
 ;+
"RTN","PXCECPT",10,0)
 ;+Structure of Following lines:
"RTN","PXCECPT",11,0)
 ;+;;Node~Piece~,Field Number~Edit Label~Display Label~Display Routine~Edit Routine~Help Text for DIR("?")~Set of PXCEKEYS that can Edit~D if Detail Display Only~
"RTN","PXCECPT",12,0)
 ;+   1  ~  2  ~      3      ~     4    ~        5    ~        6      ~     7      ~       8              ~          9                  ~         10
"RTN","PXCECPT",13,0)
 ;+The Display & Edit routines are for special cases.
"RTN","PXCECPT",14,0)
 ;+  (The .01 fields cannot have a special edit.)
"RTN","PXCECPT",15,0)
 ;
"RTN","PXCECPT",16,0)
FORMAT ;;CPT~9000010.18~0,1,12,802,811,812~1~^AUPNVCPT
"RTN","PXCECPT",17,0)
 ;;0~1~.01~CPT Code:  ~CPT Code:  ~$$DISPLY01^PXCECPT~ECPTCODE^PXCECPT~^D HELP^PXCEHELP~~B
"RTN","PXCECPT",18,0)
 ;;0~19~.19~Department Code:  ~Department Code:  ~~DEPART^PXCECPT1~~~D
"RTN","PXCECPT",19,0)
 ;;0~17~.17~Order Reference:  ~Order Reference:  ~~SKIP^PXCECPT~~~D
"RTN","PXCECPT",20,0)
 ;;1~0~1~CPT Modifier:  ~CPT Modifier:  ~$$DISPMOD^PXCECPT~ECPTMOD^PXCECPT~Select a Modifier that is valid for the CPT code.~~B
"RTN","PXCECPT",21,0)
 ;;0~4~.04~Provider Narrative:  ~Provider Narrative:  ~$$DNARRAT^PXCECPT~ENARRAT^PXCEPOV1(1,1,1,81,2)~~~B
"RTN","PXCECPT",22,0)
 ;;0~16~.16~Quantity:  ~Quantity:  ~~EQUAN^PXCECPT~~~D
"RTN","PXCECPT",23,0)
 ;;0~7~.07~Principal Procedure:  ~Principal Procedure:  ~~~~~D
"RTN","PXCECPT",24,0)
 ;;12~2~1202~Ordering Provider:  ~Ordering Provider:  ~~EPROV12^PXCEPRV~~~D
"RTN","PXCECPT",25,0)
 ;;12~4~1204~Encounter Provider:  ~Encounter Provider:  ~~EPROV12^PXCEPRV~~~D
"RTN","PXCECPT",26,0)
 ;;802~1~80201~Provider Narrative Category:  ~Provider Narrative Category:  ~$$DNARRAT^PXCECPT~ENARRAT^PXCEPOV1(0,2,0,81,3)~~C~D
"RTN","PXCECPT",27,0)
 ;;811~1~81101~Comments:  ~Comments:  ~~~~~D
"RTN","PXCECPT",28,0)
 ;;0~5~.05~Primary Diagnosis:  ~Primary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",29,0)
 ;;0~9~.09~1st Secondary Diagnosis:  ~1st Secondary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",30,0)
 ;;0~10~.1~2nd Secondary Diagnosis:  ~2nd Secondary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",31,0)
 ;;0~11~.11~3rd Secondary Diagnosis:  ~3rd Secondary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",32,0)
 ;;0~12~.12~4th Secondary Diagnosis:  ~4th Secondary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",33,0)
 ;;0~13~.13~5th Secondary Diagnosis:  ~5th Secondary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",34,0)
 ;;0~14~.14~6th Secondary Diagnosis:  ~6th Secondary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",35,0)
 ;;0~15~.15~7th Secondary Diagnosis:  ~7th Secondary Diagnosis:  ~$$DISPLY01^PXCEPOV~EPOV^PXCECPT~~~
"RTN","PXCECPT",36,0)
 ;;
"RTN","PXCECPT",37,0)
 ;
"RTN","PXCECPT",38,0)
 ;The interface for AICS to get list on form for help.
"RTN","PXCECPT",39,0)
INTRFACE ;;DG SELECT CPT PROCEDURE CODES
"RTN","PXCECPT",40,0)
 ;+
"RTN","PXCECPT",41,0)
 ;+********************************
"RTN","PXCECPT",42,0)
 ;+Special cases for display.
"RTN","PXCECPT",43,0)
 ;
"RTN","PXCECPT",44,0)
DISPMOD(PXCECPT) ;
"RTN","PXCECPT",45,0)
 ;+Display the modifiers associated with this V CPT entry.
"RTN","PXCECPT",46,0)
 ;+PXCECPT = IEN in V CPT file.
"RTN","PXCECPT",47,0)
 N MODS,SIEN,MODIEN,SCRATCH,MODSTR,MODNAME,OUTSTR
"RTN","PXCECPT",48,0)
 I $G(PXCECPT)="" S PXCECPT=IEN
"RTN","PXCECPT",49,0)
 S OUTSTR=""
"RTN","PXCECPT",50,0)
 I PXCECPT="" Q OUTSTR
"RTN","PXCECPT",51,0)
 S SIEN=0
"RTN","PXCECPT",52,0)
 F MODS=1:1 S SIEN=$O(^AUPNVCPT(PXCECPT,1,SIEN)) Q:'SIEN  D
"RTN","PXCECPT",53,0)
 . S MODIEN=$P($G(^AUPNVCPT(PXCECPT,1,SIEN,0)),"^")
"RTN","PXCECPT",54,0)
 . S $P(OUTSTR,U,MODS)=$$MODTEXT(MODIEN)
"RTN","PXCECPT",55,0)
 Q OUTSTR
"RTN","PXCECPT",56,0)
DNARRAT(PNAR) ;+Display Provider Narrative for procedure in V CPT file.
"RTN","PXCECPT",57,0)
 I PNAR="" Q ""
"RTN","PXCECPT",58,0)
 N PXCEPNAR
"RTN","PXCECPT",59,0)
 S PXCEPNAR=$P(^AUTNPOV(PNAR,0),"^")
"RTN","PXCECPT",60,0)
 I $G(VIEW)="B",$D(ENTRY)>0 D
"RTN","PXCECPT",61,0)
 . ;N DIC,DR,DA,DIQ,PXCEDIQ1
"RTN","PXCECPT",62,0)
 . ;S DIC=81
"RTN","PXCECPT",63,0)
 . ;S DR="2"
"RTN","PXCECPT",64,0)
 . ;S DA=$P(ENTRY(0),"^",1)
"RTN","PXCECPT",65,0)
 . ;S DIQ="PXCEDIQ1("
"RTN","PXCECPT",66,0)
 . ;S DIQ(0)="E"
"RTN","PXCECPT",67,0)
 . ;D EN^DIQ1
"RTN","PXCECPT",68,0)
 . ;S:PXCEDIQ1(81,DA,2,"E")=PXCEPNAR PXCEPNAR=""
"RTN","PXCECPT",69,0)
 . N CPTSTR
"RTN","PXCECPT",70,0)
 . S CPTSTR=$$CPT^ICPTCOD($P(ENTRY(0),U),$P(^AUPNVSIT(PXCEVIEN,0),U))
"RTN","PXCECPT",71,0)
 . S:$P(CPTSTR,U,3)=PXCEPNAR PXCEPNAR=""
"RTN","PXCECPT",72,0)
 Q PXCEPNAR
"RTN","PXCECPT",73,0)
 ;+
"RTN","PXCECPT",74,0)
 ;+********************************
"RTN","PXCECPT",75,0)
 ;+Special cases for edit.
"RTN","PXCECPT",76,0)
 ;+
"RTN","PXCECPT",77,0)
ECPTCODE ;+Code to edit CPT Code in V CPT file.
"RTN","PXCECPT",78,0)
 K DIRUT
"RTN","PXCECPT",79,0)
 N DIC,DA,PXCPTDT,PXDFLT
"RTN","PXCECPT",80,0)
 S PXCPTDT=+^TMP("PXK",$J,"VST",1,0,"AFTER")
"RTN","PXCECPT",81,0)
 S (X,PXDFLT)=""
"RTN","PXCECPT",82,0)
 I $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))'="" D
"RTN","PXCECPT",83,0)
 . N DIERR,PXCEDILF,PXCEINT,PXCEEXT
"RTN","PXCECPT",84,0)
 . S PXCEINT=$P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))
"RTN","PXCECPT",85,0)
 . S PXCEEXT=$$EXTERNAL^DILFD(PXCEFILE,$P(PXCETEXT,"~",3),"",PXCEINT,"PXCEDILF")
"RTN","PXCECPT",86,0)
 . S PXDFLT=$S('$D(DIERR):PXCEEXT,1:PXCEINT)
"RTN","PXCECPT",87,0)
 S Y=$$GETCODE^PXCPTAPI(PXDFLT,PXCPTDT)
"RTN","PXCECPT",88,0)
 I Y="@" S X="@" Q
"RTN","PXCECPT",89,0)
 I Y<0 S DIRUT=1 Q
"RTN","PXCECPT",90,0)
 S PXCEMOD=$P(Y,"-",2)
"RTN","PXCECPT",91,0)
 S Y=$P(Y,"-"),X=+Y
"RTN","PXCECPT",92,0)
 I PXCEDIRB="" Q
"RTN","PXCECPT",93,0)
 I $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))=X Q
"RTN","PXCECPT",94,0)
 Q:$$CHGCPT()
"RTN","PXCECPT",95,0)
 G ECPTCODE
"RTN","PXCECPT",96,0)
 ;
"RTN","PXCECPT",97,0)
ECPTMOD ;+Prompt for CPT Modifier in V CPT file.
"RTN","PXCECPT",98,0)
 ;
"RTN","PXCECPT",99,0)
 ;--If there are no modifiers for CPT code do not prompt
"RTN","PXCECPT",100,0)
 Q:PXMDCNT'>0
"RTN","PXCECPT",101,0)
 N DTOUT,DUOUT,DIROUT,DIR,PXSUB,PXSEQ,PXSTR,PXARR
"RTN","PXCECPT",102,0)
 N DA,DIC,PXLINE,SUBIEN,PXFILE,PXMOD,PXI
"RTN","PXCECPT",103,0)
 S PXSUB=1,PXSTR=""
"RTN","PXCECPT",104,0)
 S DA=^TMP("PXK",$J,PXCECATS,1,"IEN")
"RTN","PXCECPT",105,0)
 S DR=1
"RTN","PXCECPT",106,0)
 S DIE="^AUPNVCPT("
"RTN","PXCECPT",107,0)
 S DIC(0)="AELMQ"
"RTN","PXCECPT",108,0)
 L +@(DIE_"DA)"):10
"RTN","PXCECPT",109,0)
 I $G(PXCEMOD)]"" D
"RTN","PXCECPT",110,0)
 . I $L(PXCEMOD,",")=1 S DR="1//"_PXCEMOD Q
"RTN","PXCECPT",111,0)
 . S PXMOD=""
"RTN","PXCECPT",112,0)
 . F PXI=1:1 S PXMOD=$P(PXCEMOD,",",PXI) Q:PXMOD=""  D
"RTN","PXCECPT",113,0)
 .. K PXERR
"RTN","PXCECPT",114,0)
 .. D VAL^DIE(9000010.181,DA,.01,"",PXMOD,.PXERR)
"RTN","PXCECPT",115,0)
 .. Q:PXERR="^"
"RTN","PXCECPT",116,0)
 .. S DR="1///^S X=PXMOD"
"RTN","PXCECPT",117,0)
 .. D ^DIE
"RTN","PXCECPT",118,0)
 . S DR=1
"RTN","PXCECPT",119,0)
 D ^DIE
"RTN","PXCECPT",120,0)
 L -@(DIE_"DA)")
"RTN","PXCECPT",121,0)
 ; SET NEWLY FILED CPT MODIFIERS INTO LOCAL ARRAY
"RTN","PXCECPT",122,0)
 K PXCEAFTR(1)
"RTN","PXCECPT",123,0)
 D GETS^DIQ(9000010.18,^TMP("PXK",$J,PXCECATS,1,"IEN"),"1*","I","PXARR")
"RTN","PXCECPT",124,0)
 S PXFILE=9000010.181
"RTN","PXCECPT",125,0)
 S PXSUB=""
"RTN","PXCECPT",126,0)
 F  S PXSUB=$O(PXARR(PXFILE,PXSUB)) Q:PXSUB=""  D
"RTN","PXCECPT",127,0)
 . S PXCEAFTR(1,$P(PXSUB,","))=PXARR(PXFILE,PXSUB,.01,"I")
"RTN","PXCECPT",128,0)
 I $D(DTOUT)!$D(Y) S (PXCEEND,PXCEQUIT)=1 Q
"RTN","PXCECPT",129,0)
 Q
"RTN","PXCECPT",130,0)
 ;
"RTN","PXCECPT",131,0)
EQUAN ;+Code to edit Quantity in V CPT file.
"RTN","PXCECPT",132,0)
 I $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))'="" D
"RTN","PXCECPT",133,0)
 . N DIERR,PXCEDILF,PXCEINT,PXCEEXT
"RTN","PXCECPT",134,0)
 . S PXCEINT=$P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))
"RTN","PXCECPT",135,0)
 . S PXCEEXT=$$EXTERNAL^DILFD(PXCEFILE,$P(PXCETEXT,"~",3),"",PXCEINT,"PXCEDILF")
"RTN","PXCECPT",136,0)
 . S DIR("B")=$S('$D(DIERR):PXCEEXT,1:PXCEINT)
"RTN","PXCECPT",137,0)
 E  S DIR("B")=1
"RTN","PXCECPT",138,0)
 S DIR(0)=PXCEFILE_","_$P(PXCETEXT,"~",3)_"A"
"RTN","PXCECPT",139,0)
 S DIR("A")=$P(PXCETEXT,"~",4)
"RTN","PXCECPT",140,0)
 S:$P(PXCETEXT,"~",8)]"" DIR("?")=$P(PXCETEXT,"~",8)
"RTN","PXCECPT",141,0)
 D ^DIR
"RTN","PXCECPT",142,0)
 K DIR,DA
"RTN","PXCECPT",143,0)
 I $D(DTOUT)!$D(DUOUT) S (PXCEEND,PXCEQUIT)=1 Q
"RTN","PXCECPT",144,0)
 I +Y<1 W !,$C(7),"Quantity is required.",! G EQUAN
"RTN","PXCECPT",145,0)
 N PXTMPCPT S PXTMPCPT=$P(PXCEAFTR($P(PXCETEXT,"~")),"^")
"RTN","PXCECPT",146,0)
 I +Y>1,$$GET1^DIQ(357.69,$G(PXCEIN01),.01)>0,$$GET1^DIQ(357.69,$G(PXCEIN01),.06,"I")'="Y" D
"RTN","PXCECPT",147,0)
 .W !,"E&M code, quantity changed to 1."
"RTN","PXCECPT",148,0)
 .S $P(Y,"^")=1
"RTN","PXCECPT",149,0)
 S:$P(Y,"^")="" Y=1
"RTN","PXCECPT",150,0)
 S $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))=$P(Y,"^")
"RTN","PXCECPT",151,0)
 Q
"RTN","PXCECPT",152,0)
EPOV ;Edit the Associated DX
"RTN","PXCECPT",153,0)
 I $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))'="" D
"RTN","PXCECPT",154,0)
 .N DIERR,PXCEDILF,PXCEINT,PXCEEXT
"RTN","PXCECPT",155,0)
 .S PXCEINT=$P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))
"RTN","PXCECPT",156,0)
 .S PXCEEXT=$$EXTERNAL^DILFD(PXCEFILE,$P(PXCETEXT,"~",3),"",PXCEINT,"PXCEDILF")
"RTN","PXCECPT",157,0)
 .S DIR("B")=$S('$D(DIERR):PXCEEXT,1:PXCEINT)
"RTN","PXCECPT",158,0)
 S DIR(0)=PXCEFILE_","_$P(PXCETEXT,"~",3)_"A"
"RTN","PXCECPT",159,0)
 S DIR("A")=$P(PXCETEXT,"~",4)
"RTN","PXCECPT",160,0)
 S:$P(PXCETEXT,"~",8)]"" DIR("?")=$P(PXCETEXT,"~",8)
"RTN","PXCECPT",161,0)
 D ^DIR
"RTN","PXCECPT",162,0)
 K DIR,DA
"RTN","PXCECPT",163,0)
 I X="@" S Y="@" S $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))=$P(Y,"^") Q
"RTN","PXCECPT",164,0)
 I $D(DTOUT)!$D(DUOUT) S PXCEEND=1,PXCEQUIT=1 Q
"RTN","PXCECPT",165,0)
 ;I '+Y S PXCEEND=1 Q  ;S:$P(PXCETEXT,"~",3)=".05" PXCEQUIT=1 Q
"RTN","PXCECPT",166,0)
 I +Y'>0 S PXCEEND=1 Q  ;PX*1.0*182 for "^" or null entry from list
"RTN","PXCECPT",167,0)
 ;See if this diagnosis is in the PXCEAFTR(0)
"RTN","PXCECPT",168,0)
 I $P(PXCETEXT,"~",2)'=5,(+Y=$P($G(PXCEAFTR(0)),"^",5)) S PXCEEND=1
"RTN","PXCECPT",169,0)
 I $P(PXCETEXT,"~",2)'=9,(+Y=$P($G(PXCEAFTR(0)),"^",9)) S PXCEEND=1
"RTN","PXCECPT",170,0)
 I $P(PXCETEXT,"~",2)'=10,(+Y=$P($G(PXCEAFTR(0)),"^",10)) S PXCEEND=1
"RTN","PXCECPT",171,0)
 I $P(PXCETEXT,"~",2)'=11,(+Y=$P($G(PXCEAFTR(0)),"^",11)) S PXCEEND=1
"RTN","PXCECPT",172,0)
 I $P(PXCETEXT,"~",2)'=12,(+Y=$P($G(PXCEAFTR(0)),"^",12)) S PXCEEND=1
"RTN","PXCECPT",173,0)
 I $P(PXCETEXT,"~",2)'=13,(+Y=$P($G(PXCEAFTR(0)),"^",13)) S PXCEEND=1
"RTN","PXCECPT",174,0)
 I $P(PXCETEXT,"~",2)'=14,(+Y=$P($G(PXCEAFTR(0)),"^",14)) S PXCEEND=1
"RTN","PXCECPT",175,0)
 I $P(PXCETEXT,"~",2)'=15,(+Y=$P($G(PXCEAFTR(0)),"^",15)) S PXCEEND=1
"RTN","PXCECPT",176,0)
 I PXCEEND=1 W !,$C(7),"Duplicate Diagnosis on this CPT code is not allowed." D WAIT^PXCEHELP Q
"RTN","PXCECPT",177,0)
 S $P(PXCEAFTR($P(PXCETEXT,"~",1)),"^",$P(PXCETEXT,"~",2))=$P(Y,"^")
"RTN","PXCECPT",178,0)
 D:+Y>0 DIAGNOS^PXCEVFI4(+Y)
"RTN","PXCECPT",179,0)
 Q
"RTN","PXCECPT",180,0)
 ;+
"RTN","PXCECPT",181,0)
 ;+********************************
"RTN","PXCECPT",182,0)
 ;+Special Reusable Functionality
"RTN","PXCECPT",183,0)
DISPLY01(PXCECPT) ;
"RTN","PXCECPT",184,0)
 ;Display text for the .01 field which is a pointer to ^ICPT.
"RTN","PXCECPT",185,0)
 ;Also called with the Evaluation and Management Code from the visit
"RTN","PXCECPT",186,0)
 ;  in the parameter.
"RTN","PXCECPT",187,0)
 ;(Must have is called by ASK^PXCEVFI2 and DEL^PXCEVFI2.)
"RTN","PXCECPT",188,0)
 ;N DIC,DR,DA,DIQ,PXCEFNUM,PXCEDIQ1
"RTN","PXCECPT",189,0)
 ;S (DIC,PXCEFNUM)=81
"RTN","PXCECPT",190,0)
 ;S DR=".01;2"
"RTN","PXCECPT",191,0)
 ;S DA=+$P(PXCECPT,"^",1)
"RTN","PXCECPT",192,0)
 ;S DIQ="PXCEDIQ1("
"RTN","PXCECPT",193,0)
 ;S DIQ(0)="E"
"RTN","PXCECPT",194,0)
 ;D EN^DIQ1
"RTN","PXCECPT",195,0)
 ;Q PXCEDIQ1(PXCEFNUM,DA,.01,"E")_"     "_PXCEDIQ1(PXCEFNUM,DA,2,"E")
"RTN","PXCECPT",196,0)
 N CPTSTR
"RTN","PXCECPT",197,0)
 S CPTSTR=$$CPT^ICPTCOD($P(PXCECPT,U),$P(^AUPNVSIT(PXCEVIEN,0),U))
"RTN","PXCECPT",198,0)
 Q $P(CPTSTR,U,2)_"     "_$P(CPTSTR,U,3)
"RTN","PXCECPT",199,0)
EDMOD(MODS,CPT) ;+Edit the Modifiers for a CPT code entry.
"RTN","PXCECPT",200,0)
 N MNUM S MNUM=0 ; Modifier number.
"RTN","PXCECPT",201,0)
 N MIEN,MTEXT
"RTN","PXCECPT",202,0)
 Q
"RTN","PXCECPT",203,0)
MODNAME(MODIEN) ;+Return #.02 NAME for this CPT MODIFIER (#81.3)
"RTN","PXCECPT",204,0)
 Q
"RTN","PXCECPT",205,0)
MODTEXT(MODIEN) ;+Return string of text describing modifier.
"RTN","PXCECPT",206,0)
 ;+MODIEN = IEN in CPT MODIFIER file (#81.3).
"RTN","PXCECPT",207,0)
 ;+Returns:  MODIFIER (#.01) followed by NAME(#.02).
"RTN","PXCECPT",208,0)
 N MOD,DESC,TEXT,RVAL
"RTN","PXCECPT",209,0)
 S RVAL=$$MOD^ICPTMOD(MODIEN,"I",$P(^AUPNVSIT(PXCEVIEN,0),U))
"RTN","PXCECPT",210,0)
 S MOD=$P(RVAL,"^",2)
"RTN","PXCECPT",211,0)
 S DESC=$P(RVAL,"^",3)
"RTN","PXCECPT",212,0)
 S TEXT=MOD_"  "_DESC
"RTN","PXCECPT",213,0)
 Q TEXT
"RTN","PXCECPT",214,0)
CHGCPT() ;Verify CPT code should be modified
"RTN","PXCECPT",215,0)
 ;If response is yes remove modifiers on file for CPT code
"RTN","PXCECPT",216,0)
 N DIR,DA,X,Y,PXIEN
"RTN","PXCECPT",217,0)
 W !!,$C(7),"WARNING!  THIS WILL ALSO DELETE ANY MODIFIERS ASSOCIATED WITH CPT CODE "_PXCEDIRB
"RTN","PXCECPT",218,0)
 S DIR(0)="Y"
"RTN","PXCECPT",219,0)
 S DIR("A")="SURE YOU WANT TO CHANGE THE CPT CODE?"
"RTN","PXCECPT",220,0)
 S DIR("B")="YES"
"RTN","PXCECPT",221,0)
 D ^DIR
"RTN","PXCECPT",222,0)
 ;Delete CPT Modifiers from V CPT file for current IEN
"RTN","PXCECPT",223,0)
 I 'Y Q +Y
"RTN","PXCECPT",224,0)
 S DA(1)=PXCEFIEN
"RTN","PXCECPT",225,0)
 S DIK="^AUPNVCPT("_DA(1)_","_1_","
"RTN","PXCECPT",226,0)
 S PXIEN=""
"RTN","PXCECPT",227,0)
 F  S PXIEN=$O(PXCEAFTR(1,PXIEN)) Q:PXIEN=""  D
"RTN","PXCECPT",228,0)
 . S DA=PXIEN
"RTN","PXCECPT",229,0)
 . D ^DIK
"RTN","PXCECPT",230,0)
 Q 1
"RTN","PXCECPT",231,0)
 ;
"RTN","PXCECPT",232,0)
NEWCODE ;
"RTN","PXCECPT",233,0)
 K DD,DO
"RTN","PXCECPT",234,0)
 N DIC,X,Y
"RTN","PXCECPT",235,0)
 S DIC="^AUPNVCPT("
"RTN","PXCECPT",236,0)
 S DIC(0)=""
"RTN","PXCECPT",237,0)
 S DIC("DR")=".02////^S X=$P(PXCEAFTR(0),""^"",2);"
"RTN","PXCECPT",238,0)
 S DIC("DR")=DIC("DR")_".03////^S X=$P(PXCEAFTR(0),""^"",3);"
"RTN","PXCECPT",239,0)
 S X=PXCEIN01
"RTN","PXCECPT",240,0)
 D FILE^DICN
"RTN","PXCECPT",241,0)
 S PXCEFIEN=+Y
"RTN","PXCECPT",242,0)
 Q
"RTN","PXCECPT",243,0)
 ;
"RTN","PXCECPT",244,0)
SKIP ;
"RTN","PXCECPT",245,0)
 Q
"VER")
8.0^22.0
"BLD",6992,6)
^139
**END**
**END**
