Released GMTS*2.7*34 SEQ #35
Extracted from mail message
**KIDS**:GMTS*2.7*34^

**INSTALL NAME**
GMTS*2.7*34
"BLD",2339,0)
GMTS*2.7*34^HEALTH SUMMARY^0^3000509^y
"BLD",2339,1,0)
^^2^2^3000427^^^
"BLD",2339,1,1,0)
Patch 34 GMTS*2.7*34, change format of Clinical Reminder output. See the
"BLD",2339,1,2,0)
National Patch Module for a complete description of this patch.
"BLD",2339,4,0)
^9.64PA^^0
"BLD",2339,"ABPKG")
n
"BLD",2339,"INIT")
POST^GMTSP34
"BLD",2339,"KRN",0)
^9.67PA^19^18
"BLD",2339,"KRN",.4,0)
.4
"BLD",2339,"KRN",.401,0)
.401
"BLD",2339,"KRN",.402,0)
.402
"BLD",2339,"KRN",.403,0)
.403
"BLD",2339,"KRN",.5,0)
.5
"BLD",2339,"KRN",.84,0)
.84
"BLD",2339,"KRN",3.6,0)
3.6
"BLD",2339,"KRN",3.8,0)
3.8
"BLD",2339,"KRN",9.2,0)
9.2
"BLD",2339,"KRN",9.8,0)
9.8
"BLD",2339,"KRN",9.8,"NM",0)
^9.68A^4^3
"BLD",2339,"KRN",9.8,"NM",1,0)
GMTSPXHR^^0^B8798208
"BLD",2339,"KRN",9.8,"NM",2,0)
GMTSXPS1^^0^B62858080
"BLD",2339,"KRN",9.8,"NM",4,0)
GMTSXPS3^^0^B35064039
"BLD",2339,"KRN",9.8,"NM","B","GMTSPXHR",1)

"BLD",2339,"KRN",9.8,"NM","B","GMTSXPS1",2)

"BLD",2339,"KRN",9.8,"NM","B","GMTSXPS3",4)

"BLD",2339,"KRN",19,0)
19
"BLD",2339,"KRN",19.1,0)
19.1
"BLD",2339,"KRN",101,0)
101
"BLD",2339,"KRN",409.61,0)
409.61
"BLD",2339,"KRN",771,0)
771
"BLD",2339,"KRN",869.2,0)
869.2
"BLD",2339,"KRN",870,0)
870
"BLD",2339,"KRN",8994,0)
8994
"BLD",2339,"KRN","B",.4,.4)

"BLD",2339,"KRN","B",.401,.401)

"BLD",2339,"KRN","B",.402,.402)

"BLD",2339,"KRN","B",.403,.403)

"BLD",2339,"KRN","B",.5,.5)

"BLD",2339,"KRN","B",.84,.84)

"BLD",2339,"KRN","B",3.6,3.6)

"BLD",2339,"KRN","B",3.8,3.8)

"BLD",2339,"KRN","B",9.2,9.2)

"BLD",2339,"KRN","B",9.8,9.8)

"BLD",2339,"KRN","B",19,19)

"BLD",2339,"KRN","B",19.1,19.1)

"BLD",2339,"KRN","B",101,101)

"BLD",2339,"KRN","B",409.61,409.61)

"BLD",2339,"KRN","B",771,771)

"BLD",2339,"KRN","B",869.2,869.2)

"BLD",2339,"KRN","B",870,870)

"BLD",2339,"KRN","B",8994,8994)

"BLD",2339,"PRE")
GMTSE34
"BLD",2339,"QUES",0)
^9.62^^
"BLD",2339,"REQB",0)
^9.611^2^2
"BLD",2339,"REQB",1,0)
GMTS*2.7*28^2
"BLD",2339,"REQB",2,0)
GMTS*2.7*35^2
"BLD",2339,"REQB","B","GMTS*2.7*28",1)

"BLD",2339,"REQB","B","GMTS*2.7*35",2)

"INIT")
POST^GMTSP34
"MBREQ")
0
"PKG",126,-1)
1^1
"PKG",126,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools
"PKG",126,20,0)
^9.402P^^
"PKG",126,22,0)
^9.49I^1^1
"PKG",126,22,1,0)
2.7^2951020^2951020^11
"PKG",126,22,1,"PAH",1,0)
34^3000509^1118
"PKG",126,22,1,"PAH",1,1,0)
^^2^2^3000509
"PKG",126,22,1,"PAH",1,1,1,0)
Patch 34 GMTS*2.7*34, change format of Clinical Reminder output. See the
"PKG",126,22,1,"PAH",1,1,2,0)
National Patch Module for a complete description of this patch.
"PRE")
GMTSE34
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","GMTSE34")
0^^B3531186
"RTN","GMTSE34",1,0)
GMTSE34 ; CIO/SLC - Environment Check GMTS*2.7*34    ; 05/01/2000
"RTN","GMTSE34",2,0)
 ;;2.7;Health Summary;**34**;Oct 20, 1995
"RTN","GMTSE34",3,0)
 ;
"RTN","GMTSE34",4,0)
ENV ; Environment Check
"RTN","GMTSE34",5,0)
 ;   Not version 1.5
"RTN","GMTSE34",6,0)
 I +($$VERSION^XPDUTL("PXRM"))'=1.5 W !," >>  Clinical Reminders version 1.5 not found.  Please install Clinical",!,"     Reminders (PXRM) v 1.5" G EXIT
"RTN","GMTSE34",7,0)
 ;   Missing Install Routines
"RTN","GMTSE34",8,0)
 I +($$ROK("GMTSXPD5"))'>0 W !," >>  Can not find component install routines GMTSXPD*.  Please install",!,"     GMTS*2.7*35 first" G EXIT
"RTN","GMTSE34",9,0)
 ;   Missing Patch 35
"RTN","GMTSE34",10,0)
 I +($$PROK("GMTSXPD5",35))'>0 W !," >>  Can not find GMTS*2.7*35 install.  Please install GMTS*2.7*35 first" G EXIT
"RTN","GMTSE34",11,0)
 ;
"RTN","GMTSE34",12,0)
QUIT ;     Quit   Passed Environment Check
"RTN","GMTSE34",13,0)
 W !!," Environment is ok",!
"RTN","GMTSE34",14,0)
 Q
"RTN","GMTSE34",15,0)
EXIT ;     Exit   Failed Environment Check
"RTN","GMTSE34",16,0)
 S XPDQUIT=2 Q
"RTN","GMTSE34",17,0)
ABRT ;     Abort  Failed Environment Check, KILL the distribution
"RTN","GMTSE34",18,0)
 S XPDQUIT=1 Q
"RTN","GMTSE34",19,0)
PROK(X,Y) ; Routine and Patch # OK (in UCI)
"RTN","GMTSE34",20,0)
 N GMTS,GMTSI,GMTSO S X=$G(X),Y=$G(Y) Q:'$L(X) 0 Q:Y'=""&(+Y=0)
"RTN","GMTSE34",21,0)
 S Y=+Y,GMTS=$$ROK(X) Q:'GMTS 0 Q:+Y=0 1 S GMTSO=0,GMTS=$T(@("+2^"_X)),GMTS=$P($P(GMTS,"**",2),"**",1)
"RTN","GMTSE34",22,0)
 F GMTSI=1:1:$L(GMTS,",") S:+($P(GMTS,",",GMTSI))=Y GMTSO=1 Q:GMTSO=1
"RTN","GMTSE34",23,0)
 S X=GMTSO Q X
"RTN","GMTSE34",24,0)
ROK(X) ; Routine OK (in UCI) (NDBI)
"RTN","GMTSE34",25,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSP34")
0^^B9560531
"RTN","GMTSP34",1,0)
GMTSP34 ; CIO/SLC - Post Install GMTS*2.7*34    ; 05/01/2000
"RTN","GMTSP34",2,0)
 ;;2.7;Health Summary;**34**;Oct 20, 1995
"RTN","GMTSP34",3,0)
 Q
"RTN","GMTSP34",4,0)
POST ; Post Install
"RTN","GMTSP34",5,0)
 N GMTSIN,GMTSINST,GMTSTL,GMTSGAF,GMTSVSD,GMTSIENS,GMTSINST,GMTSBLD D CI
"RTN","GMTSP34",6,0)
 I +$$ROK("GMTSXPS1")>0 S GMTSINST="",GMTSBLD="GMTS*2.7*34" D SEND^GMTSXPS1
"RTN","GMTSP34",7,0)
 Q
"RTN","GMTSP34",8,0)
CI ; Component Install
"RTN","GMTSP34",9,0)
 N GMTSOK,GMTSIN,GMTSINST,GMTSTL,GMTSINST,GMTSTOT,GMTSBLD,GMTSCPS,GMTSCP,GMTSCI
"RTN","GMTSP34",10,0)
 S GMTSCPS="CMB",GMTSIENS=""
"RTN","GMTSP34",11,0)
 S GMTSOK=0,GMTSOK=GMTSOK+$$ROK("GMTSXPD1"),GMTSOK=GMTSOK+$$ROK("GMTSXPD3")
"RTN","GMTSP34",12,0)
 I GMTSOK'=2 W !!," >> Can not install component CMB",!,"    Could not find install routines GMTSXPD*" Q
"RTN","GMTSP34",13,0)
 F GMTSCI=1:1 Q:'$L($P(GMTSCPS,";",GMTSCI))  D
"RTN","GMTSP34",14,0)
 . S GMTSCP=$P(GMTSCPS,";",GMTSCI)
"RTN","GMTSP34",15,0)
 . D ARRAY Q:'$D(GMTSIN)  S GMTSINST=$$ADD^GMTSXPD1(.GMTSIN),GMTSTOT=+($G(GMTSTOT))+GMTSINST
"RTN","GMTSP34",16,0)
 . S GMTSIENS=GMTSIENS_";"_+($G(GMTSIN(0)))
"RTN","GMTSP34",17,0)
 F  Q:$E(GMTSIENS,1)'=";"  S GMTSIENS=$E(GMTSIENS,2,$L(GMTSIENS))
"RTN","GMTSP34",18,0)
 ; Rebuild Ad Hoc Health Summary Type
"RTN","GMTSP34",19,0)
 D:+($G(GMTSTOT))>0 BUILD^GMTSXPD3
"RTN","GMTSP34",20,0)
 Q
"RTN","GMTSP34",21,0)
ROK(X) ; Routine OK
"RTN","GMTSP34",22,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSP34",23,0)
ARRAY ; Build Array
"RTN","GMTSP34",24,0)
 K GMTSIN N GMTSI,GMTSTXT,GMTSEX,GMTSFLD,GMTSV,GMTSPDX,GMTSDD,GMTSFLDS
"RTN","GMTSP34",25,0)
 S GMTSPDX=0,GMTSCP=$G(GMTSCP) Q:'$L(GMTSCP)
"RTN","GMTSP34",26,0)
 S GMTSDD(0)="1;.01^2;1^3;2^4;3^5;4^6;5^7;6^8;8^9;9^10;10^11;11^12;12^13;13"
"RTN","GMTSP34",27,0)
 S GMTSDD(.1)="1.1",GMTSDD(.1,0)="1;.01",GMTSDD(1)="7",GMTSDD(1,0)="1;.01^2;1",GMTSDD(3.5)="3.5",GMTSDD(3.5,0)="1;.01"
"RTN","GMTSP34",28,0)
 S GMTSFLDS=".01;1;2;3;4;5;6;8;9;10;11;12;13^1.1;7;3.5"
"RTN","GMTSP34",29,0)
 N GMTSND,GMTSNS,GMTSNI,GMTSNP,GMTSNV,GMTSV,GMTSTR
"RTN","GMTSP34",30,0)
 F GMTSI=1:1 D  Q:'$L(GMTSTXT)
"RTN","GMTSP34",31,0)
 . S GMTSTXT="",GMTSEX="S GMTSTXT=$T("_GMTSCP_"+"_GMTSI_")"
"RTN","GMTSP34",32,0)
 . X GMTSEX S:$L(GMTSTXT,";")'>3 GMTSTXT="" Q:'$L(GMTSTXT)
"RTN","GMTSP34",33,0)
 . S GMTSND=$P(GMTSTXT,";",2),GMTSNS=$P(GMTSTXT,";",3)
"RTN","GMTSP34",34,0)
 . S GMTSNI=$P(GMTSTXT,";",4),GMTSNV=$P(GMTSTXT,";",5,299)
"RTN","GMTSP34",35,0)
 . S:GMTSND="PDX"&(GMTSNV=1) GMTSPDX=1 Q:GMTSND="PDX"
"RTN","GMTSP34",36,0)
 . S:GMTSND="IEN"&(+($G(GMTSNV))>0) GMTSIN(0)=+($G(GMTSNV)) Q:GMTSND="IEN"
"RTN","GMTSP34",37,0)
 . F GMTSNP=1:1:$L(GMTSNV,"^") D
"RTN","GMTSP34",38,0)
 . . S GMTSV=$P(GMTSNV,"^",GMTSNP) Q:'$L(GMTSV)
"RTN","GMTSP34",39,0)
 . . S GMTSTR=$P($G(GMTSDD(GMTSND)),"^",GMTSNP),GMTSFLD=$P(GMTSTR,";",2)
"RTN","GMTSP34",40,0)
 . . S:$L(GMTSNS) GMTSTR=$P($G(GMTSDD(GMTSND,GMTSNS)),"^",GMTSNP),GMTSFLD=$G(GMTSDD(GMTSND))
"RTN","GMTSP34",41,0)
 . . S:GMTSNI'>0 GMTSIN(GMTSFLD)=GMTSV
"RTN","GMTSP34",42,0)
 . . S:GMTSNI>0 GMTSIN(GMTSFLD,GMTSNI)=GMTSV,GMTSIN(GMTSFLD)=+($G(GMTSIN(GMTSFLD)))+1
"RTN","GMTSP34",43,0)
 S:GMTSPDX GMTSIN("PDX")=1 F GMTSI=1:1 Q:'$L($P($P(GMTSFLDS,"^",1),";",GMTSI))  D
"RTN","GMTSP34",44,0)
 . S GMTSFLD=$P($P(GMTSFLDS,"^",1),";",GMTSI) S:$L(GMTSFLD)&('$D(GMTSIN(GMTSFLD))) GMTSIN(GMTSFLD)=""
"RTN","GMTSP34",45,0)
 F GMTSI=1:1 Q:'$L($P($P(GMTSFLDS,"^",2),";",GMTSI))  D
"RTN","GMTSP34",46,0)
 . S GMTSFLD=$P($P(GMTSFLDS,"^",2),";",GMTSI) S:$L(GMTSFLD)&('$D(GMTSIN(GMTSFLD))) GMTSIN(GMTSFLD)=0
"RTN","GMTSP34",47,0)
 Q
"RTN","GMTSP34",48,0)
 ;
"RTN","GMTSP34",49,0)
CMB ; Reminder Brief
"RTN","GMTSP34",50,0)
 ;IEN;;;239
"RTN","GMTSP34",51,0)
 ;0;;;CLINICAL REMINDERS BRIEF^MAIN;GMTSPXHR^^CMB^^^^^Reminder Brief
"RTN","GMTSP34",52,0)
 ;.1;0;1;MAIN;PXRM(DFN,SEG,FLG)
"RTN","GMTSP34",53,0)
 ;1;0;1;811.9
"RTN","GMTSP34",54,0)
 ;3.5;0;1;This is a brief version of the CLINICAL REMINDERS MAINTENANCE component.
"RTN","GMTSP34",55,0)
 ;
"RTN","GMTSPXHR")
0^1^B8798208
"RTN","GMTSPXHR",1,0)
GMTSPXHR ; SLC/SBW,KER - PCE Clinical Reminders/Maint ; 05/01/2000
"RTN","GMTSPXHR",2,0)
 ;;2.7;Health Summary;**8,22,23,28,34**;Oct 20, 1995
"RTN","GMTSPXHR",3,0)
 ; Main driver for Clinical Reminder Components
"RTN","GMTSPXHR",4,0)
 ;
"RTN","GMTSPXHR",5,0)
MAIN ;Entry Point for Clinical Reminders
"RTN","GMTSPXHR",6,0)
 N CM,GMFLAG
"RTN","GMTSPXHR",7,0)
 S CM=0
"RTN","GMTSPXHR",8,0)
 I GMTSEGH["CR" S GMFLAG=0
"RTN","GMTSPXHR",9,0)
 I GMTSEGH["CRS" S GMFLAG=1
"RTN","GMTSPXHR",10,0)
 I GMTSEGH["CM" S GMFLAG=5,CM=1
"RTN","GMTSPXHR",11,0)
 I GMTSEGH["CMB" S GMFLAG=4,CM=1
"RTN","GMTSPXHR",12,0)
 Q:+$G(GMTSAGE)'>0!($G(SEX)="")!($G(DFN)'>0)
"RTN","GMTSPXHR",13,0)
 Q:$O(GMTSEG(GMTSEGN,811.9,0))'>0
"RTN","GMTSPXHR",14,0)
 N GMCR,GMFIRST,CRSEG,GMDISP
"RTN","GMTSPXHR",15,0)
 S GMCR=0,GMFIRST=1
"RTN","GMTSPXHR",16,0)
 F  S GMCR=$O(GMTSEG(GMTSEGN,811.9,GMCR)) Q:'GMCR  D  Q:$D(GMTSQIT)
"RTN","GMTSPXHR",17,0)
 . S CRSEG=GMTSEG(GMTSEGN,811.9,GMCR)
"RTN","GMTSPXHR",18,0)
 . K ^TMP("PXRHM",$J),^TMP("PXRM",$J)
"RTN","GMTSPXHR",19,0)
 . D MAIN^PXRM(DFN,CRSEG,+$G(GMFLAG))
"RTN","GMTSPXHR",20,0)
 . D:+$D(^TMP("PXRHM",$J)) GETCR
"RTN","GMTSPXHR",21,0)
 I +$G(GMDISP)'>0 D CKP^GMTSUP Q:$D(GMTSQIT)  W "Selected Clinical Reminders not due.",!
"RTN","GMTSPXHR",22,0)
 K ^TMP("PXRHM",$J),^TMP("PXRM",$J)
"RTN","GMTSPXHR",23,0)
 Q
"RTN","GMTSPXHR",24,0)
GETCR ;Get reminders that were returned
"RTN","GMTSPXHR",25,0)
 N ITEM,GMDT,GMN0,X,GMTSDAT,GMTSDUE,GMREM
"RTN","GMTSPXHR",26,0)
 S ITEM=0
"RTN","GMTSPXHR",27,0)
 F  S ITEM=$O(^TMP("PXRHM",$J,ITEM)) Q:ITEM'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXHR",28,0)
 . S GMREM=""
"RTN","GMTSPXHR",29,0)
 . F  S GMREM=$O(^TMP("PXRHM",$J,ITEM,GMREM)) Q:GMREM=""  D CRDISP Q:$D(GMTSQIT)
"RTN","GMTSPXHR",30,0)
 Q
"RTN","GMTSPXHR",31,0)
CRDISP ; Display reminder data
"RTN","GMTSPXHR",32,0)
 N DUECOL,HIST,LASTCOL,STATUS,STATCOL,TYPE
"RTN","GMTSPXHR",33,0)
 S GMN0=$G(^TMP("PXRHM",$J,ITEM,GMREM))
"RTN","GMTSPXHR",34,0)
 Q:GMN0']""
"RTN","GMTSPXHR",35,0)
 S STATUS=$P(GMN0,U,1)
"RTN","GMTSPXHR",36,0)
 S X=$P(GMN0,U,2) D REGDT4^GMTSU S GMTSDUE=X
"RTN","GMTSPXHR",37,0)
 S X=$P(GMN0,U,3) D REGDT4^GMTSU S GMTSDAT=X
"RTN","GMTSPXHR",38,0)
 S TYPE=$P(GMN0,U,4)
"RTN","GMTSPXHR",39,0)
 I TYPE["E" S HIST="(hist)"
"RTN","GMTSPXHR",40,0)
 I TYPE["X" S HIST="(exp)"
"RTN","GMTSPXHR",41,0)
 S GMDISP=1
"RTN","GMTSPXHR",42,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXHR",43,0)
 I GMTSNPG D HDR,CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXHR",44,0)
 I GMTSNPG D HDR
"RTN","GMTSPXHR",45,0)
 S STATCOL=41-($L(STATUS)/2)
"RTN","GMTSPXHR",46,0)
 S DUECOL=53-($L(GMTSDUE)/2)
"RTN","GMTSPXHR",47,0)
 S LASTCOL=67-($L(GMTSDAT)/2)
"RTN","GMTSPXHR",48,0)
 W GMREM,?STATCOL,STATUS,?DUECOL,GMTSDUE,?LASTCOL,GMTSDAT,?73,$G(HIST),!
"RTN","GMTSPXHR",49,0)
 I 'CM Q
"RTN","GMTSPXHR",50,0)
 ; Display activity data on reminder
"RTN","GMTSPXHR",51,0)
 S GMDT=0
"RTN","GMTSPXHR",52,0)
 F  S GMDT=$O(^TMP("PXRHM",$J,ITEM,GMREM,GMDT)) Q:+GMDT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXHR",53,0)
 . S GMN0=$G(^TMP("PXRHM",$J,ITEM,GMREM,GMDT))
"RTN","GMTSPXHR",54,0)
 . Q:GMN0']""
"RTN","GMTSPXHR",55,0)
 . I $P(GMN0,U,2) S X=$P(GMN0,U,2) D REGDT4^GMTSU S GMTSDAT=X
"RTN","GMTSPXHR",56,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXHR",57,0)
 . I GMTSNPG D HDR
"RTN","GMTSPXHR",58,0)
 . W ?5,$P(GMN0,U)," on record - ",$G(GMTSDAT),", ",$P(GMN0,U,3),!
"RTN","GMTSPXHR",59,0)
 ; Display maintenance criteria for reminder
"RTN","GMTSPXHR",60,0)
 S GMDT=0
"RTN","GMTSPXHR",61,0)
 F  S GMDT=$O(^TMP("PXRHM",$J,ITEM,GMREM,"TXT",GMDT)) Q:+GMDT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXHR",62,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXHR",63,0)
 . I GMTSNPG D HDR
"RTN","GMTSPXHR",64,0)
 . W ?5,$G(^TMP("PXRHM",$J,ITEM,GMREM,"TXT",GMDT)),!
"RTN","GMTSPXHR",65,0)
 W !
"RTN","GMTSPXHR",66,0)
 Q
"RTN","GMTSPXHR",67,0)
HDR ;Header
"RTN","GMTSPXHR",68,0)
 I GMFIRST D FIRST Q:$D(GMTSQIT)  S GMFIRST=0
"RTN","GMTSPXHR",69,0)
 W ?36,"--STATUS--",?47,"--DUE DATE--",?61,"--LAST DONE--",!
"RTN","GMTSPXHR",70,0)
 Q
"RTN","GMTSPXHR",71,0)
 ;
"RTN","GMTSPXHR",72,0)
FIRST ;Display Disclaimer
"RTN","GMTSPXHR",73,0)
 N GMREC
"RTN","GMTSPXHR",74,0)
 S GMREC=0
"RTN","GMTSPXHR",75,0)
 F  S GMREC=$O(^TMP("PXRM",$J,"DISC",GMREC)) Q:+GMREC'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXHR",76,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXHR",77,0)
 . W ?1,$G(^TMP("PXRM",$J,"DISC",GMREC)),!
"RTN","GMTSPXHR",78,0)
 W !
"RTN","GMTSPXHR",79,0)
 Q
"RTN","GMTSXPS1")
0^2^B62858080
"RTN","GMTSXPS1",1,0)
GMTSXPS1 ; SLC/KER - Health Summary Status       ; 05/01/2000
"RTN","GMTSXPS1",2,0)
 ;;2.7;Health Summary;**35,34**;Oct 20, 1995
"RTN","GMTSXPS1",3,0)
 ;
"RTN","GMTSXPS1",4,0)
EN ; Display status only
"RTN","GMTSXPS1",5,0)
 N POP,GMTSENV S GMTSENV=$$ENV Q:'GMTSENV
"RTN","GMTSXPS1",6,0)
 K ^TMP($J,"GMTSINFO"),GMTSMAIL N X,Y,ZTSAVE D HDR,FI,INS^GMTSXPS2,OUTPUT Q
"RTN","GMTSXPS1",7,0)
SEND ; Send status to G.GMTS@ISC-SLC.VA.GOV
"RTN","GMTSXPS1",8,0)
 N POP,GMTSENV S GMTSENV=$$ENV2 Q:'GMTSENV
"RTN","GMTSXPS1",9,0)
 S GMTSIENS=$G(GMTSIENS) S:$L(GMTSIENS) GMTSIENS=";"_GMTSIENS_";"
"RTN","GMTSXPS1",10,0)
 S GMTSENV=$$ROK("XMD") Q:'GMTSENV
"RTN","GMTSXPS1",11,0)
 K ^TMP($J,"GMTSINFO") N X,Y,ZTSAVE,ZTQUEUED,ZTREQ,ZTRTN
"RTN","GMTSXPS1",12,0)
 S:$L($G(GMTSBLD)) ZTSAVE("GMTSBLD")="" S:$D(GMTSINST) ZTSAVE("GMTSINST")="" S:$L($G(GMTSIENS)) ZTSAVE("GMTSIENS")=""
"RTN","GMTSXPS1",13,0)
 S ZTRTN="SENDTO^GMTSXPS1",ZTDESC="Health Symmary Status Report Msg",ZTIO="",ZTDTH=$H D ^%ZTLOAD,HOME^%ZIS K Y,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN Q
"RTN","GMTSXPS1",14,0)
SENDTO ;   Send (Tasked)
"RTN","GMTSXPS1",15,0)
 N GMTSMAIL S GMTSMAIL="" S:$D(ZTQUEUED) ZTREQ="@"
"RTN","GMTSXPS1",16,0)
 N X,Y D HDR,FI,INS^GMTSXPS2,OUTPUT Q
"RTN","GMTSXPS1",17,0)
 ;                           
"RTN","GMTSXPS1",18,0)
HDR ; Report Header
"RTN","GMTSXPS1",19,0)
 N X D TITLE,ASOF D:$D(GMTSINST) MTBY D INAC,BLD D BL
"RTN","GMTSXPS1",20,0)
 Q
"RTN","GMTSXPS1",21,0)
TITLE ;   As of date
"RTN","GMTSXPS1",22,0)
 N X S X=$S($D(GMTSINST)&('$L($G(GMTSBLD))):"Health Summary Installation",$D(GMTSINST)&($L($G(GMTSBLD))):($G(GMTSBLD)_" Installation"),1:"Health Summary Status") D TT(X),BL Q
"RTN","GMTSXPS1",23,0)
ASOF ;   As of date
"RTN","GMTSXPS1",24,0)
 N X S X=$$NOW S:$L(X) X=$$TB($S($D(GMTSINST):"  Installed on:",1:"  As of:"))_X D:$L(X) TL(X) Q
"RTN","GMTSXPS1",25,0)
INAC ;   In Account
"RTN","GMTSXPS1",26,0)
 N X S X=$$UCI($$U) S:$L(X) X=$$TB("  Install Account:")_X D:$L(X) TL(X) Q
"RTN","GMTSXPS1",27,0)
MTBY ;   Maintained by
"RTN","GMTSXPS1",28,0)
 N X,Y S X=$$P,Y=$P(X,"^",2),X=$P(X,"^",1) S:$L(X) X=$$TB($S($D(GMTSINST):"  Installed by:",1:"  Maintained by:"))_X S:$L(X)&($L(Y)) X=X_"    "_Y D:$L(X) TL(X) Q
"RTN","GMTSXPS1",29,0)
BLD ;   Install Build
"RTN","GMTSXPS1",30,0)
 Q:$D(GMTSINST)&($L($G(GMTSBLD)))  N X S X=$G(GMTSBLD) Q:'$L(X)  S:$L(X) X=$$TB("  Build:")_X D:$L(X) TL(X) Q
"RTN","GMTSXPS1",31,0)
 ;                          
"RTN","GMTSXPS1",32,0)
FI ; Health Summary Files
"RTN","GMTSXPS1",33,0)
 N X S X="",X=X_$J("",37-$L(X))_" Total",X=X_$J("",48-$L(X))_"Last" D TL(X)
"RTN","GMTSXPS1",34,0)
 S X="  File",X=X_$J("",37-$L(X))_"Entries",X=X_$J("",48-$L(X))_"Entry" D TL(X)
"RTN","GMTSXPS1",35,0)
 S X="",$P(X,"-",51)="-",X="  "_X D TL(X)
"RTN","GMTSXPS1",36,0)
 D F142,F1421,F14299,BL
"RTN","GMTSXPS1",37,0)
 Q
"RTN","GMTSXPS1",38,0)
F142 ;   Health Summary Type file 142
"RTN","GMTSXPS1",39,0)
 N X,GMTSA,GMTSAT,GMTSAP,GMTSL,GMTST,GMTSI S X="  Health Summary Type",(GMTSL,GMTST,GMTSI)=0
"RTN","GMTSXPS1",40,0)
 F  S GMTSI=$O(^GMT(142,GMTSI)) Q:+GMTSI=0  S GMTSL=GMTSI,GMTST=GMTST+1
"RTN","GMTSXPS1",41,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) D TL(X)
"RTN","GMTSXPS1",42,0)
 S GMTSA=$O(^GMT(142,"B","GMTS HS ADHOC OPTION",0))
"RTN","GMTSXPS1",43,0)
 S X="    Ad Hoc Health Summary Type",(GMTSL,GMTST,GMTSI)=0
"RTN","GMTSXPS1",44,0)
 I GMTSA=0 S X=X_$J("",37-$L(X))_"Missing Ad Hoc Health Summary Type" D TL(X) Q
"RTN","GMTSXPS1",45,0)
 F  S GMTSI=$O(^GMT(142,GMTSA,1,GMTSI)) Q:+GMTSI=0  S GMTSL=GMTSI,GMTST=GMTST+1
"RTN","GMTSXPS1",46,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) S:GMTSA'=12 X=X_$J("",57-$L(X))_"Invalid IEN" D TL(X)
"RTN","GMTSXPS1",47,0)
 Q
"RTN","GMTSXPS1",48,0)
F1421 ;   Health Summary Component file 142.1
"RTN","GMTSXPS1",49,0)
 N X,GMTSA,GMTSAC,GMTSAT,GMTSAP,GMTSL,GMTST,GMTSE,GMTSI
"RTN","GMTSXPS1",50,0)
 S X="  Health Summary Component",(GMTSAT,GMTSAP,GMTSAC,GMTSL,GMTST,GMTSI,GMTSE)=0
"RTN","GMTSXPS1",51,0)
 F  S GMTSI=$O(^GMT(142.1,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXPS1",52,0)
 . S GMTSL=GMTSI,GMTST=GMTST+1 S:GMTSI<501 GMTSE=GMTSE+1
"RTN","GMTSXPS1",53,0)
 . S GMTSA=$P($G(^GMT(142.1,GMTSI,0)),"^",6) S:GMTSA="T" GMTSAT=+($G(GMTSAT))+1 S:GMTSA="P" GMTSAP=+($G(GMTSAP))+1 S:GMTSA="" GMTSAC=+($G(GMTSAC))+1
"RTN","GMTSXPS1",54,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) D TL(X)
"RTN","GMTSXPS1",55,0)
 I +($G(GMTSE))>0 S X="    Exported",X=X_$J("",32-$L(X))_$J(GMTSE,10) D TL(X)
"RTN","GMTSXPS1",56,0)
 I +($G(GMTSAT))>0 S X="    Temporarily Disabled",X=X_$J("",32-$L(X))_$J(GMTSAT,10) D TL(X)
"RTN","GMTSXPS1",57,0)
 I +($G(GMTSAP))>0 S X="    Permanently Disabled",X=X_$J("",32-$L(X))_$J(GMTSAP,10) D TL(X)
"RTN","GMTSXPS1",58,0)
 I +($G(GMTSAC))>0&(+($G(GMTSAC))'=+($G(GMTST))) S X="    Active Components",X=X_$J("",32-$L(X))_$J(GMTSAC,10) D TL(X)
"RTN","GMTSXPS1",59,0)
 D STA^GMTSXPS3
"RTN","GMTSXPS1",60,0)
 Q
"RTN","GMTSXPS1",61,0)
F14299 ;   Health Summary Parameter file 142.9
"RTN","GMTSXPS1",62,0)
 N X,GMTSA,GMTSL,GMTST,GMTSI S X="  Health Summary Parameters",(GMTSL,GMTST,GMTSI)=0
"RTN","GMTSXPS1",63,0)
 F  S GMTSI=$O(^GMT(142.99,GMTSI)) Q:+GMTSI=0  S GMTSL=GMTSI,GMTST=GMTST+1
"RTN","GMTSXPS1",64,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) D TL(X)
"RTN","GMTSXPS1",65,0)
 Q
"RTN","GMTSXPS1",66,0)
 ;                            
"RTN","GMTSXPS1",67,0)
 ; Retrieve Data
"RTN","GMTSXPS1",68,0)
U(X) ;   UCI where Health Summary is installed
"RTN","GMTSXPS1",69,0)
 N GMTSU,GMTSP,GMTST S GMTST=$G(X) X ^%ZOSF("UCI") S GMTSU=Y
"RTN","GMTSXPS1",70,0)
 S:Y=^%ZOSF("PROD") GMTSP=" (Production)" S:Y'=^%ZOSF("PROD") GMTSP=" (Test)" S:GMTSU["DEM" GMTSP=" (Demo)"
"RTN","GMTSXPS1",71,0)
 S X="",$P(X,"^",1)=GMTSU,$P(X,"^",2)=GMTSP Q X
"RTN","GMTSXPS1",72,0)
UCI(X) ;   UCI Format
"RTN","GMTSXPS1",73,0)
 S X=$G(X) N GMTSA,GMTST S GMTSA=$P(X,"^",1),GMTST=$P(X,"^",2) S:$L(GMTST) GMTST=$$MX($$TRIM($$PA(GMTST)))
"RTN","GMTSXPS1",74,0)
 S:$L($P(GMTSA,",",1))=3&($L($P(GMTSA,",",2))=3) GMTSA="["_GMTSA_"]" S:$L(GMTSA)&($L(GMTST)) GMTST="("_GMTST_")"
"RTN","GMTSXPS1",75,0)
 S X="" S:$L(GMTSA) X=GMTSA S:$L(X)&($L(GMTST)) X=X_"  "_GMTST S:'$L(X)&($L(GMTST)) X=GMTST
"RTN","GMTSXPS1",76,0)
 Q X
"RTN","GMTSXPS1",77,0)
P(X) ;   Person
"RTN","GMTSXPS1",78,0)
 S X=+($G(DUZ)) Q:'$L($P($G(^VA(200,+($G(X)),0)),"^",1)) "UNKNOWN^"
"RTN","GMTSXPS1",79,0)
 N GMTSDUZ,GMTSPH S GMTSDUZ=+($G(DUZ))
"RTN","GMTSXPS1",80,0)
 S GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",2) S:GMTSPH="" GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",1) S:GMTSPH="" GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",3) S:GMTSPH="" GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",4)
"RTN","GMTSXPS1",81,0)
 S GMTSDUZ=$P(^VA(200,GMTSDUZ,0),"^",1),X=GMTSDUZ_"^"_GMTSPH Q X
"RTN","GMTSXPS1",82,0)
INST(X) ;   Institution
"RTN","GMTSXPS1",83,0)
 S X=$G(^XMB("NETNAME")) I $L(X) S:X[".VA.GOV" X=$P(X,".VA.GOV",1) S:X["." X=$P(X,".",$L(X,".")) Q X
"RTN","GMTSXPS1",84,0)
 S X=$P($G(^XMB(1,1,"XUS")),"^",17) I +X>0 S X=$$GET1^DIQ(4,+X,.01,"E") Q:$L(X) X
"RTN","GMTSXPS1",85,0)
 S X="" Q X
"RTN","GMTSXPS1",86,0)
 ;                     
"RTN","GMTSXPS1",87,0)
OUTPUT ; Show global array (display or mail)
"RTN","GMTSXPS1",88,0)
 D:$D(GMTSMAIL) MAIL,CLR D:'$D(GMTSMAIL) DSP,CLR Q
"RTN","GMTSXPS1",89,0)
DISPLAY ;   Display global array
"RTN","GMTSXPS1",90,0)
 N GMTSI S GMTSI=0 F  S GMTSI=$O(^TMP($J,"GMTSINFO",GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXPS1",91,0)
 . W !,^TMP($J,"GMTSINFO",GMTSI)
"RTN","GMTSXPS1",92,0)
 Q
"RTN","GMTSXPS1",93,0)
MAIL ;   Mail global array in message
"RTN","GMTSXPS1",94,0)
 N DIFROM S U="^",XMSUB="Health Summary Info"
"RTN","GMTSXPS1",95,0)
 S:$D(GMTSINST)&($L($G(GMTSBLD))) XMSUB="Health Summary "_GMTSBLD_" Install"
"RTN","GMTSXPS1",96,0)
 S XMY("G.GMTS@ISC-SLC.VA.GOV")=""
"RTN","GMTSXPS1",97,0)
 S XMTEXT="^TMP($J,""GMTSINFO"",",XMDUZ=.5 D ^XMD
"RTN","GMTSXPS1",98,0)
 K ^TMP($J,"GMTSINFO"),%Z,XCNP,XMSCR,XMDUZ,XMY("G.GMTS@ISC-SLC.VA.GOV"),XMZ,XMSUB,XMY,XMTEXT,XMDUZ Q
"RTN","GMTSXPS1",99,0)
 Q
"RTN","GMTSXPS1",100,0)
 ;                            
"RTN","GMTSXPS1",101,0)
 ; Temporary Global
"RTN","GMTSXPS1",102,0)
BL ;   Blank Line
"RTN","GMTSXPS1",103,0)
 N GMTSNX S GMTSNX=+($$NX),^TMP($J,"GMTSINFO",GMTSNX)="" Q
"RTN","GMTSXPS1",104,0)
TT(X) ;   Title Line
"RTN","GMTSXPS1",105,0)
 Q:'$L($G(X))  D TL(X) N GMTSBK S GMTSBK="===============================================================================",GMTSBK=$E(GMTSBK,1,$L($G(X))) D:$L(GMTSBK) TL(GMTSBK) Q
"RTN","GMTSXPS1",106,0)
TL(X) ;   Text Line
"RTN","GMTSXPS1",107,0)
 N GMTSNX S GMTSNX=+($$NX),^TMP($J,"GMTSINFO",GMTSNX)=$G(X) Q
"RTN","GMTSXPS1",108,0)
BK1 ;   Break Line
"RTN","GMTSXPS1",109,0)
 N GMTSNX S GMTSNX=+($$NX),^TMP($J,"GMTSINFO",GMTSNX)="-------------------------------------------------------------------------------" Q
"RTN","GMTSXPS1",110,0)
NX(X) ;   Next Line #
"RTN","GMTSXPS1",111,0)
 S (X,^TMP($J,"GMTSINFO",0))=+($G(^TMP($J,"GMTSINFO",0)))+1 Q X
"RTN","GMTSXPS1",112,0)
ST ;   Show ^TMP($J,"GMTSINFO")
"RTN","GMTSXPS1",113,0)
 N GMTSNN,GMTSNC S GMTSNN="^TMP("_$J_",""GMTSINFO"")",GMTSNC="^TMP("_$J_",""GMTSINFO"","
"RTN","GMTSXPS1",114,0)
 F  S GMTSNN=$Q(@GMTSNN) Q:GMTSNN=""!(GMTSNN'[GMTSNC)  W:GMTSNN'[",0)" !,@GMTSNN
"RTN","GMTSXPS1",115,0)
 Q
"RTN","GMTSXPS1",116,0)
 ;                            
"RTN","GMTSXPS1",117,0)
DSP ; Display ^TMP($J,"GMTSINFO")
"RTN","GMTSXPS1",118,0)
 D DEV Q
"RTN","GMTSXPS1",119,0)
DEV ;   Select a device
"RTN","GMTSXPS1",120,0)
 N %,%ZIS,IOP,ZTRTN,ZTSAVE,ZTDESC,ZTDTH,ZTIO,ZTSK
"RTN","GMTSXPS1",121,0)
 S ZTRTN="DSPI^GMTSXPS1",ZTDESC="printing Health Summary install information"
"RTN","GMTSXPS1",122,0)
 S ZTIO=ION,ZTDTH=$H,%ZIS="PQ",ZTSAVE("^TMP($J,""GMTSINFO"",")=""
"RTN","GMTSXPS1",123,0)
 D ^%ZIS Q:POP  S ZTIO=ION I $D(IO("Q")) D QUE,^%ZISC Q
"RTN","GMTSXPS1",124,0)
 D NOQUE Q
"RTN","GMTSXPS1",125,0)
NOQUE ;   Do not que task
"RTN","GMTSXPS1",126,0)
 W @IOF W:IOST["P-" !,"< Not queued, printing Health Summary Info >",! H 2 U:IOST["P-" IO D @ZTRTN,^%ZISC Q
"RTN","GMTSXPS1",127,0)
QUE ;   Task queued to print user defaults
"RTN","GMTSXPS1",128,0)
 K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued",1:"Request Cancelled"),! H 2 Q
"RTN","GMTSXPS1",129,0)
 Q
"RTN","GMTSXPS1",130,0)
DSPI ;   Display installation information
"RTN","GMTSXPS1",131,0)
 I '$D(ZTQUEUED),$G(IOST)'["P-" I '$D(^TMP($J,"GMTSINFO")) W !,"Health Summary Installation not found"
"RTN","GMTSXPS1",132,0)
 I IOST["P-" U IO
"RTN","GMTSXPS1",133,0)
 G:'$D(^TMP($J,"GMTSINFO")) DSPQ
"RTN","GMTSXPS1",134,0)
 N GMTSCONT,GMTSI,GMTSLC,GMTSEOP S GMTSCONT="",(GMTSLC,GMTSI)=0,GMTSEOP=+($G(IOSL)) S:GMTSEOP=0 GMTSEOP=24
"RTN","GMTSXPS1",135,0)
 F  S GMTSI=$O(^TMP($J,"GMTSINFO",GMTSI)) Q:+GMTSI=0!(GMTSCONT["^")  D
"RTN","GMTSXPS1",136,0)
 . W !,^TMP($J,"GMTSINFO",GMTSI) D LF Q:GMTSCONT["^"
"RTN","GMTSXPS1",137,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","GMTSXPS1",138,0)
 W:$G(IOST)["P-" @IOF
"RTN","GMTSXPS1",139,0)
DSPQ ;   Quit Display
"RTN","GMTSXPS1",140,0)
 Q
"RTN","GMTSXPS1",141,0)
LF ;   Line Feed
"RTN","GMTSXPS1",142,0)
 S GMTSLC=GMTSLC+1 D:IOST["P-"&(GMTSLC>(GMTSEOP-7)) CONT D:IOST'["P-"&(GMTSLC>(GMTSEOP-4)) CONT
"RTN","GMTSXPS1",143,0)
 Q
"RTN","GMTSXPS1",144,0)
CONT ;   Page/Form Feed
"RTN","GMTSXPS1",145,0)
 S GMTSLC=0 W:IOST["P-" @IOF Q:IOST["P-"  W !!,"Press <Return> to continue  " R GMTSCONT:300 S:'$T GMTSCONT="^" S:GMTSCONT'["^" GMTSCONT=""
"RTN","GMTSXPS1",146,0)
 Q
"RTN","GMTSXPS1",147,0)
 ;                       
"RTN","GMTSXPS1",148,0)
 ; Miscellaneous
"RTN","GMTSXPS1",149,0)
TB(X) ;   Tab
"RTN","GMTSXPS1",150,0)
 S X=X F  Q:$L(X)>19  S X=X_" "
"RTN","GMTSXPS1",151,0)
 Q X
"RTN","GMTSXPS1",152,0)
PA(X) ;   Remove Parenthesis
"RTN","GMTSXPS1",153,0)
 Q $TR(X,"()","")
"RTN","GMTSXPS1",154,0)
LO(X) ;   Lowercase
"RTN","GMTSXPS1",155,0)
 Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSXPS1",156,0)
UP(X) ;   Uppercase
"RTN","GMTSXPS1",157,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSXPS1",158,0)
MX(X) ;   Mixed Case
"RTN","GMTSXPS1",159,0)
 Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSXPS1",160,0)
TRIM(X) ;   Trim Space Characters
"RTN","GMTSXPS1",161,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSXPS1",162,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSXPS1",163,0)
 Q X
"RTN","GMTSXPS1",164,0)
CLR ;   Clean up
"RTN","GMTSXPS1",165,0)
 K ^TMP($J,"GMTSINFO") Q
"RTN","GMTSXPS1",166,0)
NOW(X) ;   Today's Date
"RTN","GMTSXPS1",167,0)
 S X=$$EDT($$NOW^XLFDT) Q X
"RTN","GMTSXPS1",168,0)
EDT(X) ;   External Date Foramt
"RTN","GMTSXPS1",169,0)
 S X=+($G(X)) Q:X=0 "" S X=$$FMTE^XLFDT(+X,"5Z") S:X["@" X=$P(X,"@",1)_"  "_$P(X,"@",2) Q X
"RTN","GMTSXPS1",170,0)
ROK(X) ;   Routine OK (in UCI) (NDBI)
"RTN","GMTSXPS1",171,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSXPS1",172,0)
ENV(X) ;   Environment check
"RTN","GMTSXPS1",173,0)
 D HOME^%ZIS I '$D(^VA(200,+($G(DUZ)),0)) W !!,"    User (DUZ) not defined",! Q 0
"RTN","GMTSXPS1",174,0)
 Q 1
"RTN","GMTSXPS1",175,0)
ENV2(X) ;   Environment check
"RTN","GMTSXPS1",176,0)
 D HOME^%ZIS I '$D(^VA(200,+($G(DUZ)),0)) Q 0
"RTN","GMTSXPS1",177,0)
 Q 1
"RTN","GMTSXPS3")
0^4^B35064039
"RTN","GMTSXPS3",1,0)
GMTSXPS3 ; SLC/KER - Health Summary Status                      ; 05/01/2000
"RTN","GMTSXPS3",2,0)
 ;;2.7;Health Summary;**35,34**;Oct 20, 1995
"RTN","GMTSXPS3",3,0)
 ;
"RTN","GMTSXPS3",4,0)
 Q
"RTN","GMTSXPS3",5,0)
STA ; Status of Components
"RTN","GMTSXPS3",6,0)
 D CLR,EXP,CHK,CLR Q
"RTN","GMTSXPS3",7,0)
CHK ;   Check Health Summary Components
"RTN","GMTSXPS3",8,0)
 N GMTSI,GMTSSNM,GMTSSAB,GMTSSDF,GMTSENM,GMTSEAB,GMTSEDF,GMTSCNT,GMTSDUP,X
"RTN","GMTSXPS3",9,0)
 S (GMTSCNT,GMTSI)=0 F  S GMTSI=$O(^GMT(142.1,GMTSI)) Q:+GMTSI=0  D IE
"RTN","GMTSXPS3",10,0)
 S GMTSI=0 F  S GMTSI=$O(^TMP($J,"GMTSST",GMTSI)) Q:+GMTSI=0  D EI
"RTN","GMTSXPS3",11,0)
 Q
"RTN","GMTSXPS3",12,0)
IE ;     Compare Installed to Exported
"RTN","GMTSXPS3",13,0)
 S GMTSSNM=$P($G(^GMT(142.1,GMTSI,0)),"^",1),GMTSSAB=$P($G(^GMT(142.1,GMTSI,0)),"^",4),GMTSSDF=$P($G(^GMT(142.1,GMTSI,0)),"^",6)
"RTN","GMTSXPS3",14,0)
 S GMTSENM=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",1),GMTSEAB=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",2),GMTSEDF=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",3)
"RTN","GMTSXPS3",15,0)
 I $G(GMTSIENS)[(";"_GMTSI_";"),$L(GMTSSNM),$D(^GMT(142.1,"B",GMTSSNM)) S X="      "_GMTSSNM_" installed" S:$L($G(GMTSBLD)) X=X_" in build "_$G(GMTSBLD) D CL(X) Q
"RTN","GMTSXPS3",16,0)
 I GMTSI<501,$L(GMTSSNM),GMTSENM="",'$D(^GMT(142.1,"B",GMTSSNM)) S X="      "_GMTSSNM_" not exported" D CL(X) Q
"RTN","GMTSXPS3",17,0)
 I GMTSI<501,$L(GMTSSNM),GMTSENM="",$D(^GMT(142.1,"B",GMTSSNM)) S GMTSDUP=0 D DP Q:+GMTSDUP>1
"RTN","GMTSXPS3",18,0)
 I GMTSI<501,$L(GMTSSNM),GMTSENM="",$D(^GMT(142.1,"B",GMTSSNM)) S X="      "_GMTSSNM_" w/wrong IEN ("_GMTSI_")" D CL(X) Q
"RTN","GMTSXPS3",19,0)
 I GMTSI<501,GMTSSNM'=GMTSENM S X="      "_"Not exported as "_GMTSSNM D CL(X) Q
"RTN","GMTSXPS3",20,0)
 I GMTSI<501,GMTSSDF="P",GMTSEDF'="P" S X="      "_GMTSSNM_" disabled at site" D CL(X) Q
"RTN","GMTSXPS3",21,0)
 I GMTSI<501,GMTSSDF="",GMTSEDF="P" S X="      Disable component "_GMTSSNM_" in use" D CL(X) Q
"RTN","GMTSXPS3",22,0)
 I GMTSI>500,GMTSENM="" S X="      "_GMTSSNM_" (local component)" D CL(X) Q
"RTN","GMTSXPS3",23,0)
 Q
"RTN","GMTSXPS3",24,0)
EI ;     Compare Exported to Installed
"RTN","GMTSXPS3",25,0)
 S GMTSSNM=$P($G(^GMT(142.1,GMTSI,0)),"^",1),GMTSSAB=$P($G(^GMT(142.1,GMTSI,0)),"^",4),GMTSSDF=$P($G(^GMT(142.1,GMTSI,0)),"^",6)
"RTN","GMTSXPS3",26,0)
 S GMTSENM=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",1),GMTSEAB=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",2),GMTSEDF=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",3)
"RTN","GMTSXPS3",27,0)
 I GMTSI<501,GMTSSNM="" S X="      "_GMTSENM_" exported/not found" D CL(X) Q
"RTN","GMTSXPS3",28,0)
 I GMTSI<501,GMTSSNM'=GMTSENM S X="      "_GMTSSNM_" exported/modified" D CL(X) Q
"RTN","GMTSXPS3",29,0)
 Q
"RTN","GMTSXPS3",30,0)
DP ;     Duplicate Components
"RTN","GMTSXPS3",31,0)
 N X,GMTSI,GMTSIS Q:'$L($G(GMTSSNM))
"RTN","GMTSXPS3",32,0)
 S GMTSIS="",GMTSI=0 F  S GMTSI=$O(^GMT(142.1,"B",GMTSSNM,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXPS3",33,0)
 . S GMTSDUP=+($G(GMTSDUP))+1,GMTSIS=GMTSIS_"/"_GMTSI
"RTN","GMTSXPS3",34,0)
 S:$E(GMTSIS,1)="/" GMTSIS=$E(GMTSIS,2,$L(GMTSIS)) S:GMTSIS'["/" GMTSDUP=1
"RTN","GMTSXPS3",35,0)
 I +($G(GMTSDUP))>1 S X="      "_GMTSSNM_" duplicated ("_GMTSIS_")" D CL(X)
"RTN","GMTSXPS3",36,0)
 Q
"RTN","GMTSXPS3",37,0)
 ;                            
"RTN","GMTSXPS3",38,0)
 ; Miscellaneous
"RTN","GMTSXPS3",39,0)
EXP ;   Retrieve Exported Components
"RTN","GMTSXPS3",40,0)
 N GMTSEX,GMTSTXT,GMTSI,GMTSCI,GMTSNM,GMTSAB,GMTSDF S GMTSTXT="" F GMTSI=1:1 D  Q:'$L(GMTSTXT)
"RTN","GMTSXPS3",41,0)
 . S GMTSTXT="" S GMTSEX="S GMTSTXT=$T(COMP+"_GMTSI_")" X GMTSEX S GMTSTXT=$P(GMTSTXT,";",3,299) Q:GMTSTXT=""  S GMTSCI=+($P(GMTSTXT,";",1)) Q:GMTSCI=0  S GMTSNM=$P(GMTSTXT,";",2) Q:GMTSNM=""
"RTN","GMTSXPS3",42,0)
 . S GMTSAB=$P(GMTSTXT,";",3) Q:GMTSAB=""  S GMTSDF=$P(GMTSTXT,";",4),^TMP($J,"GMTSST",GMTSCI)=GMTSNM_"^"_GMTSAB_"^"_GMTSDF
"RTN","GMTSXPS3",43,0)
 Q
"RTN","GMTSXPS3",44,0)
CLR ;   Clean up
"RTN","GMTSXPS3",45,0)
 K ^TMP($J,"GMTSST") Q
"RTN","GMTSXPS3",46,0)
CL(X) ;   Component Status Line
"RTN","GMTSXPS3",47,0)
 S X=$G(X) S:$L(X) GMTSCNT=+($G(GMTSCNT))+1 D:GMTSCNT=1 TL^GMTSXPS1("    Component Status:")
"RTN","GMTSXPS3",48,0)
 D TL^GMTSXPS1(X) Q
"RTN","GMTSXPS3",49,0)
COMP ;   Components List (exported)
"RTN","GMTSXPS3",50,0)
 ;;1;ADVERSE REACTIONS/ALLERGIES;ADR
"RTN","GMTSXPS3",51,0)
 ;;2;MAS DEMOGRAPHICS BRIEF;BDEM
"RTN","GMTSXPS3",52,0)
 ;;3;LAB CHEMISTRY & HEMATOLOGY;CH
"RTN","GMTSXPS3",53,0)
 ;;4;CLINICAL WARNINGS;CW
"RTN","GMTSXPS3",54,0)
 ;;5;CRISIS NOTES;CN
"RTN","GMTSXPS3",55,0)
 ;;6;MAS DEMOGRAPHICS;DEM
"RTN","GMTSXPS3",56,0)
 ;;7;DIETETICS;DI
"RTN","GMTSXPS3",57,0)
 ;;8;MAS DISCHARGES;DC
"RTN","GMTSXPS3",58,0)
 ;;9;MAS CLINIC VISITS FUTURE;CVF
"RTN","GMTSXPS3",59,0)
 ;;10;MAS ADMISSIONS/DISCHARGES;ADC
"RTN","GMTSXPS3",60,0)
 ;;11;MAS DISCHARGE DIAGNOSIS;DD
"RTN","GMTSXPS3",61,0)
 ;;12;MAS SURGERIES ICD CODES;OPC
"RTN","GMTSXPS3",62,0)
 ;;14;MAS CLINIC VISITS PAST;CVP
"RTN","GMTSXPS3",63,0)
 ;;15;PROGRESS NOTES;PN
"RTN","GMTSXPS3",64,0)
 ;;16;MAS TRANSFERS;TR
"RTN","GMTSXPS3",65,0)
 ;;17;MAS TREATING SPECIALTY;TS
"RTN","GMTSXPS3",66,0)
 ;;18;LAB CUMULATIVE SELECTED 1;SCL1
"RTN","GMTSXPS3",67,0)
 ;;19;LAB CUMULATIVE SELECTED 2;SCL2
"RTN","GMTSXPS3",68,0)
 ;;20;LAB CUMULATIVE SELECTED 3;SCL3
"RTN","GMTSXPS3",69,0)
 ;;21;LAB CUMULATIVE SELECTED 4;SCL4
"RTN","GMTSXPS3",70,0)
 ;;23;SURGERY REPORTS;SR
"RTN","GMTSXPS3",71,0)
 ;;24;MAS DISABILITIES;DS
"RTN","GMTSXPS3",72,0)
 ;;25;ADVANCE DIRECTIVE;CD
"RTN","GMTSXPS3",73,0)
 ;;26;PROGRESS NOTES BRIEF;BPN
"RTN","GMTSXPS3",74,0)
 ;;27;SURGERY REPORTS BRIEF;BSR
"RTN","GMTSXPS3",75,0)
 ;;28;PHARMACY OUTPATIENT;RXOP
"RTN","GMTSXPS3",76,0)
 ;;29;PHARMACY UNIT DOSE;RXUD
"RTN","GMTSXPS3",77,0)
 ;;30;PHARMACY INTRAVENOUS;RXIV
"RTN","GMTSXPS3",78,0)
 ;;31;LAB ORDERS BRIEF;BLO
"RTN","GMTSXPS3",79,0)
 ;;32;LAB ORDERS;LO
"RTN","GMTSXPS3",80,0)
 ;;33;LAB TESTS SELECTED;SLT
"RTN","GMTSXPS3",81,0)
 ;;34;RADIOLOGY STATUS;RS
"RTN","GMTSXPS3",82,0)
 ;;35;RADIOLOGY PROFILE;RP
"RTN","GMTSXPS3",83,0)
 ;;36;LAB BLOOD TRANSFUSIONS;BT
"RTN","GMTSXPS3",84,0)
 ;;37;LAB MICROBIOLOGY BRIEF;BMIC
"RTN","GMTSXPS3",85,0)
 ;;38;LAB MICROBIOLOGY;MIC
"RTN","GMTSXPS3",86,0)
 ;;43;LAB CUMULATIVE SELECTED;SCLU
"RTN","GMTSXPS3",87,0)
 ;;45;LAB BLOOD AVAILABILITY;BA
"RTN","GMTSXPS3",88,0)
 ;;46;LAB SURGICAL PATHOLOGY;SP
"RTN","GMTSXPS3",89,0)
 ;;47;VITAL SIGNS;VS
"RTN","GMTSXPS3",90,0)
 ;;48;LAB CYTOPATHOLOGY;CY
"RTN","GMTSXPS3",91,0)
 ;;49;VITAL SIGNS SELECTED;SVS
"RTN","GMTSXPS3",92,0)
 ;;50;MAS PROCEDURES ICD CODES;PRC
"RTN","GMTSXPS3",93,0)
 ;;51;MEDICINE SUMMARY;MEDS
"RTN","GMTSXPS3",94,0)
 ;;52;RADIOLOGY IMPRESSION;RI
"RTN","GMTSXPS3",95,0)
 ;;54;ORDERS CURRENT;ORC
"RTN","GMTSXPS3",96,0)
 ;;55;MAS ADT HISTORY;ADT
"RTN","GMTSXPS3",97,0)
 ;;56;RADIOLOGY IMPRESSION SELECTED;SRI
"RTN","GMTSXPS3",98,0)
 ;;57;DISCHARGE SUMMARY;DCS
"RTN","GMTSXPS3",99,0)
 ;;58;DISCHARGE SUMMARY BRIEF;BDS
"RTN","GMTSXPS3",100,0)
 ;;59;PROBLEM LIST ACTIVE;PLA
"RTN","GMTSXPS3",101,0)
 ;;60;PROBLEM LIST INACTIVE;PLI
"RTN","GMTSXPS3",102,0)
 ;;61;PROBLEM LIST ALL;PLL
"RTN","GMTSXPS3",103,0)
 ;;62;SOCIAL WORK;SW
"RTN","GMTSXPS3",104,0)
 ;;64;MAS ADT HISTORY EXPANDED;EADT
"RTN","GMTSXPS3",105,0)
 ;;65;COMPENSATION AND PENSION EXAMS;CP
"RTN","GMTSXPS3",106,0)
 ;;66;MEDICINE ABNORMAL BRIEF;MEDA
"RTN","GMTSXPS3",107,0)
 ;;67;MEDICINE BRIEF REPORT;MEDB
"RTN","GMTSXPS3",108,0)
 ;;68;MEDICINE FULL CAPTIONED;MEDC
"RTN","GMTSXPS3",109,0)
 ;;69;MEDICINE FULL REPORT;MEDF
"RTN","GMTSXPS3",110,0)
 ;;71;MENTAL HEALTH PHYSICAL EXAM;MHPE
"RTN","GMTSXPS3",111,0)
 ;;72;LAB ELECTRON MICROSCOPY;EM
"RTN","GMTSXPS3",112,0)
 ;;73;ADVERSE REACTIONS/ALLERG BRIEF;BADR
"RTN","GMTSXPS3",113,0)
 ;;74;SPINAL CORD DYSFUNCTION;SCD
"RTN","GMTSXPS3",114,0)
 ;;75;VITAL SIGNS OUTPATIENT;VSO
"RTN","GMTSXPS3",115,0)
 ;;76;VITAL SIGNS SELECTED OUTPAT.;SVSO
"RTN","GMTSXPS3",116,0)
 ;;77;SURGERY ONLY REPORTS;SRO
"RTN","GMTSXPS3",117,0)
 ;;78;SURGERY NON OR PROCEDURES;NSR
"RTN","GMTSXPS3",118,0)
 ;;79;SURGERY SEL NON OR PROCEDURES;SNSR
"RTN","GMTSXPS3",119,0)
 ;;201;PCE LOCATION OF HOME;LH;P
"RTN","GMTSXPS3",120,0)
 ;;202;CLINICAL REMINDERS DUE;CR
"RTN","GMTSXPS3",121,0)
 ;;203;PCE HEALTH FACTORS SELECTED;SHF;P
"RTN","GMTSXPS3",122,0)
 ;;204;PCE HEALTH FACTORS ALL;HF;P
"RTN","GMTSXPS3",123,0)
 ;;205;PCE OUTPATIENT ENCOUNTERS;OE
"RTN","GMTSXPS3",124,0)
 ;;206;PCE MEASUREMENTS NON-TABULAR;NTM;P
"RTN","GMTSXPS3",125,0)
 ;;207;PCE IMMUNIZATIONS;IM;P
"RTN","GMTSXPS3",126,0)
 ;;208;PCE SKIN TESTS;ST;P
"RTN","GMTSXPS3",127,0)
 ;;209;PCE MEASUREMENTS SELECTED;MEAS;P
"RTN","GMTSXPS3",128,0)
 ;;212;PCE EDUCATION;ED
"RTN","GMTSXPS3",129,0)
 ;;213;PCE EDUCATION LATEST;EDL
"RTN","GMTSXPS3",130,0)
 ;;220;PCE OUTPATIENT DIAGNOSIS;OD;P
"RTN","GMTSXPS3",131,0)
 ;;230;PCE EXAMS LATEST;EXAM;P
"RTN","GMTSXPS3",132,0)
 ;;231;PCE TREATMENTS PROVIDED;TP;P
"RTN","GMTSXPS3",133,0)
 ;;232;CLINICAL REMINDERS MAINTENANCE;CM
"RTN","GMTSXPS3",134,0)
 ;;233;PROGRESS NOTES SELECTED;SPN
"RTN","GMTSXPS3",135,0)
 ;;234;CLINICAL REMINDERS SUMMARY;CRS
"RTN","GMTSXPS3",136,0)
 ;;235;MAG IMAGING;MAGI
"RTN","GMTSXPS3",137,0)
 ;;236;ONCOLOGY;ONC
"RTN","GMTSXPS3",138,0)
 ;;237;VITAL SIGNS DETAILED DISPLAY;VSD
"RTN","GMTSXPS3",139,0)
 ;;238;GLOBAL ASSESSMENT FUNCTIONING;GAF
"RTN","GMTSXPS3",140,0)
 ;;239;CLINICAL REMINDERS BRIEF;CMB
"VER")
8.0^22.0
**END**
**END**
