Released ICPT*6*16 SEQ #16
Extracted from mail message
**KIDS**:ICPT*6.0*16^

**INSTALL NAME**
ICPT*6.0*16
"BLD",3613,0)
ICPT*6.0*16^CPT/HCPCS CODES^0^3031202^y
"BLD",3613,1,0)
^^2^2^3031022^
"BLD",3613,1,1,0)
Please see the National Patch Module for details
"BLD",3613,1,2,0)
of the enhancements included in this patch.
"BLD",3613,4,0)
^9.64PA^^
"BLD",3613,"ABPKG")
n
"BLD",3613,"INIT")
POST^ICPT616
"BLD",3613,"KRN",0)
^9.67PA^8989.52^19
"BLD",3613,"KRN",.4,0)
.4
"BLD",3613,"KRN",.401,0)
.401
"BLD",3613,"KRN",.402,0)
.402
"BLD",3613,"KRN",.403,0)
.403
"BLD",3613,"KRN",.5,0)
.5
"BLD",3613,"KRN",.84,0)
.84
"BLD",3613,"KRN",3.6,0)
3.6
"BLD",3613,"KRN",3.8,0)
3.8
"BLD",3613,"KRN",9.2,0)
9.2
"BLD",3613,"KRN",9.8,0)
9.8
"BLD",3613,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",3613,"KRN",9.8,"NM",1,0)
ICPTAPIU^^0^B35752762
"BLD",3613,"KRN",9.8,"NM",2,0)
ICPTAU^^0^B195926
"BLD",3613,"KRN",9.8,"NM",3,0)
ICPT616^^0^B849218
"BLD",3613,"KRN",9.8,"NM",4,0)
ICPTCOD^^0^B27712594
"BLD",3613,"KRN",9.8,"NM","B","ICPT616",3)

"BLD",3613,"KRN",9.8,"NM","B","ICPTAPIU",1)

"BLD",3613,"KRN",9.8,"NM","B","ICPTAU",2)

"BLD",3613,"KRN",9.8,"NM","B","ICPTCOD",4)

"BLD",3613,"KRN",19,0)
19
"BLD",3613,"KRN",19.1,0)
19.1
"BLD",3613,"KRN",101,0)
101
"BLD",3613,"KRN",101,"NM",0)
^9.68A^2^2
"BLD",3613,"KRN",101,"NM",1,0)
ICPT CODE UPDATE EVENT^^4^
"BLD",3613,"KRN",101,"NM",2,0)
LEXICAL SERVICES UPDATE^^2
"BLD",3613,"KRN",101,"NM","B","ICPT CODE UPDATE EVENT",1)

"BLD",3613,"KRN",101,"NM","B","LEXICAL SERVICES UPDATE",2)

"BLD",3613,"KRN",409.61,0)
409.61
"BLD",3613,"KRN",771,0)
771
"BLD",3613,"KRN",870,0)
870
"BLD",3613,"KRN",870,"NM",0)
^9.68A^^
"BLD",3613,"KRN",8989.51,0)
8989.51
"BLD",3613,"KRN",8989.52,0)
8989.52
"BLD",3613,"KRN",8994,0)
8994
"BLD",3613,"KRN","B",.4,.4)

"BLD",3613,"KRN","B",.401,.401)

"BLD",3613,"KRN","B",.402,.402)

"BLD",3613,"KRN","B",.403,.403)

"BLD",3613,"KRN","B",.5,.5)

"BLD",3613,"KRN","B",.84,.84)

"BLD",3613,"KRN","B",3.6,3.6)

"BLD",3613,"KRN","B",3.8,3.8)

"BLD",3613,"KRN","B",9.2,9.2)

"BLD",3613,"KRN","B",9.8,9.8)

"BLD",3613,"KRN","B",19,19)

"BLD",3613,"KRN","B",19.1,19.1)

"BLD",3613,"KRN","B",101,101)

"BLD",3613,"KRN","B",409.61,409.61)

"BLD",3613,"KRN","B",771,771)

"BLD",3613,"KRN","B",870,870)

"BLD",3613,"KRN","B",8989.51,8989.51)

"BLD",3613,"KRN","B",8989.52,8989.52)

"BLD",3613,"KRN","B",8994,8994)

"BLD",3613,"QUES",0)
^9.62^^
"BLD",3613,"REQB",0)
^9.611^1^1
"BLD",3613,"REQB",1,0)
ICPT*6.0*14^2
"BLD",3613,"REQB","B","ICPT*6.0*14",1)

"INIT")
POST^ICPT616
"KRN",101,4401,-1)
4^1
"KRN",101,4401,0)
ICPT CODE UPDATE EVENT
"KRN",101,4475,-1)
2^2
"KRN",101,4475,0)
LEXICAL SERVICES UPDATE^Lexical Services Update^^X^100988^^^^^^^512
"KRN",101,4475,10,0)
^101.01PA^2^2
"KRN",101,4475,10,1,0)
4401^CPT^^
"KRN",101,4475,10,1,"^")
ICPT CODE UPDATE EVENT
"MBREQ")
0
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"PKG",517,-1)
1^1
"PKG",517,0)
CPT/HCPCS CODES^ICPT^ICPT/HCPCS CODES
"PKG",517,20,0)
^9.402P^^
"PKG",517,22,0)
^9.49I^1^1
"PKG",517,22,1,0)
6.0^2970519^2970523^11714
"PKG",517,22,1,"PAH",1,0)
16^3031202
"PKG",517,22,1,"PAH",1,1,0)
^^2^2^3031202
"PKG",517,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details
"PKG",517,22,1,"PAH",1,1,2,0)
of the enhancements included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","ICPT616")
0^3^B849218
"RTN","ICPT616",1,0)
ICPT616 ;DLS/DEK- ICPT Patch Driver; 10/27/03 3:03pm
"RTN","ICPT616",2,0)
 ;;6.0;CPT/HCPCS;**16**;May 19, 1997
"RTN","ICPT616",3,0)
 ;
"RTN","ICPT616",4,0)
 ; Addresses NOIS: BAY-1003-31889
"RTN","ICPT616",5,0)
 ;
"RTN","ICPT616",6,0)
 ; External References
"RTN","ICPT616",7,0)
 ;   DBIA  1995  CODEN^ICPTCOD
"RTN","ICPT616",8,0)
 ;   DBIA  2053  FILE^DIE
"RTN","ICPT616",9,0)
 ;   DBIA 10141  BMES^XPDUTL
"RTN","ICPT616",10,0)
 ;
"RTN","ICPT616",11,0)
POST ;- Post-Init
"RTN","ICPT616",12,0)
 N I,ICPTX,FDA,FLAG,CODE,DESC
"RTN","ICPT616",13,0)
 S CODE="G0121",ICPTX=$$CODEN^ICPTCOD(CODE),FLAG=1
"RTN","ICPT616",14,0)
 I ICPTX<0 D BMES^XPDUTL("INVALID HCPCS Code: "_CODE) Q
"RTN","ICPT616",15,0)
 S DESC="Colon ca scrn not hi rsk ind",FDA(81,ICPTX_",",2)=DESC
"RTN","ICPT616",16,0)
 F I=1:1:5 Q:'FLAG  D
"RTN","ICPT616",17,0)
 . K ^TMP("DIERR",$J)
"RTN","ICPT616",18,0)
 . D FILE^DIE("K","FDA")
"RTN","ICPT616",19,0)
 . S FLAG=$D(^TMP("DIERR",$J))
"RTN","ICPT616",20,0)
 I FLAG S $P(^ICPT(ICPTX,0),"U",2)=DESC
"RTN","ICPT616",21,0)
 K ^TMP("DIERR",$J)
"RTN","ICPT616",22,0)
 Q
"RTN","ICPT616",23,0)
 ;
"RTN","ICPTAPIU")
0^1^B35752762
"RTN","ICPTAPIU",1,0)
ICPTAPIU ;ALB/ABR/DEK - CPT UTILITIES FOR APIS ; 04/28/2003
"RTN","ICPTAPIU",2,0)
 ;;6.0;CPT/HCPCS;**1,6,12,14,16**;May 19, 1997
"RTN","ICPTAPIU",3,0)
 ;
"RTN","ICPTAPIU",4,0)
 ; External References
"RTN","ICPTAPIU",5,0)
 ;   DBIA 10011  ^DIWP
"RTN","ICPTAPIU",6,0)
 ;   DBIA 10029  ^DIWW
"RTN","ICPTAPIU",7,0)
 ;   DBIA 10103  $$DT^XLFDT 
"RTN","ICPTAPIU",8,0)
 ;                          
"RTN","ICPTAPIU",9,0)
CPTDIST() ; Distribution Date
"RTN","ICPTAPIU",10,0)
 ;  Input:  none (extrinsic variable)
"RTN","ICPTAPIU",11,0)
 ; Output:  returns DISTRIBUTION DATE, date codes effective in Austin
"RTN","ICPTAPIU",12,0)
 Q $P($G(^DIC(81.2,1,0)),"^",2)
"RTN","ICPTAPIU",13,0)
 ;
"RTN","ICPTAPIU",14,0)
CAT(CAT,DFN) ; Return CATEGORY NAME given IEN
"RTN","ICPTAPIU",15,0)
 ;   Input:  CAT = category ien REQUIRED
"RTN","ICPTAPIU",16,0)
 ;           DFN - not in use but included in anticipation of future need
"RTN","ICPTAPIU",17,0)
 ;
"RTN","ICPTAPIU",18,0)
 ;  Output:  STR = CATEGORY NAME^SOURCE (C or H)^MAJOR CATEGORY IEN^MAJOR CATEGORY NAME  
"RTN","ICPTAPIU",19,0)
 ;           STR = -1^error message, if error condition occurred
"RTN","ICPTAPIU",20,0)
 ;
"RTN","ICPTAPIU",21,0)
 N CATN,STR,MCATIEN,MCATNM
"RTN","ICPTAPIU",22,0)
 S (MCATIEN,MCATNM)=""
"RTN","ICPTAPIU",23,0)
 I $G(CAT)="" S STR="-1^NO CATEGORY SELECTED" G CATQ
"RTN","ICPTAPIU",24,0)
 I '$G(CAT) S STR="-1^INVALID CATEGORY FORMAT" G CATQ
"RTN","ICPTAPIU",25,0)
 S STR=$G(^DIC(81.1,+CAT,0))
"RTN","ICPTAPIU",26,0)
 I '$L(STR) S STR="-1^NO SUCH CATEGORY" G CATQ
"RTN","ICPTAPIU",27,0)
 I $P(STR,"^",2)="" S STR="-1^TYPE OF CATEGORY UNSPECIFIED" G CATQ
"RTN","ICPTAPIU",28,0)
 S CATN=$P(STR,"^")
"RTN","ICPTAPIU",29,0)
 I $P(STR,"^",2)="m" S MCATNM=CATN,MCATIEN=+CAT
"RTN","ICPTAPIU",30,0)
 I $P(STR,"^",2)="s" D
"RTN","ICPTAPIU",31,0)
 . S MCATIEN=$P(STR,"^",3)
"RTN","ICPTAPIU",32,0)
 . I MCATIEN S MCATNM=$P($G(^DIC(81.1,MCATIEN,0)),"^")
"RTN","ICPTAPIU",33,0)
 S STR=CATN_"^"_$P(STR,"^",6)_"^"_MCATIEN_"^"_MCATNM
"RTN","ICPTAPIU",34,0)
CATQ Q STR
"RTN","ICPTAPIU",35,0)
 ;
"RTN","ICPTAPIU",36,0)
NUM(Y) ; Convert CPT/HCPCS Code to Numeric
"RTN","ICPTAPIU",37,0)
 ;    Convert HCPCS to $A() of Alpha _ Numeric Portion
"RTN","ICPTAPIU",38,0)
 ;
"RTN","ICPTAPIU",39,0)
 ;   Input:  Y - CPT or HCPCS code
"RTN","ICPTAPIU",40,0)
 ;
"RTN","ICPTAPIU",41,0)
 ;  Output:  'plussed' value for CPT code,
"RTN","ICPTAPIU",42,0)
 ;         numeric for HCPCS based on $A of 1st character (alpha)
"RTN","ICPTAPIU",43,0)
 ;          concatenated with the 4-digit portion of code
"RTN","ICPTAPIU",44,0)
 ;
"RTN","ICPTAPIU",45,0)
 ;  **This does not convert to ien**
"RTN","ICPTAPIU",46,0)
 ;  This converts to a numeric that may be used for range sorting
"RTN","ICPTAPIU",47,0)
 ;
"RTN","ICPTAPIU",48,0)
 ;Q $S(Y:+Y,1:$A(Y)_$E(Y,2,5))
"RTN","ICPTAPIU",49,0)
 ; modified in 2002 to handle few CPT codes that end with "T"
"RTN","ICPTAPIU",50,0)
 ; needed to add multiplier to create higher and unique number
"RTN","ICPTAPIU",51,0)
 ; e.g. "Z9999"=909999 and "0001T"=8400001
"RTN","ICPTAPIU",52,0)
 Q $S(Y?1.N:+Y,Y?4N1A:$A($E(Y,5))*10_$E(Y,1,4),1:$A(Y)_$E(Y,2,5))
"RTN","ICPTAPIU",53,0)
 ;
"RTN","ICPTAPIU",54,0)
COPY ; API to Print Copyright Information
"RTN","ICPTAPIU",55,0)
 ;
"RTN","ICPTAPIU",56,0)
 N DIR,DIWL,DIWR,DIWF,VARR,VAXX,X
"RTN","ICPTAPIU",57,0)
 Q:'$D(^DIC(81.2,1))  K ^UTILITY($J,"W")
"RTN","ICPTAPIU",58,0)
 W !!! S DIWL=1,DIWR=80,DIWF="W"
"RTN","ICPTAPIU",59,0)
 F VARR=0:0 S VARR=$O(^DIC(81.2,1,1,VARR)) Q:VARR'>0  S VAXX=^(VARR,0),X=VAXX D ^DIWP
"RTN","ICPTAPIU",60,0)
 D:$D(VAXX) ^DIWW
"RTN","ICPTAPIU",61,0)
 Q
"RTN","ICPTAPIU",62,0)
 ;                   
"RTN","ICPTAPIU",63,0)
STATCHK(CODE,CDT) ; Check Status of CPT Code or Modifier
"RTN","ICPTAPIU",64,0)
 ; Input:
"RTN","ICPTAPIU",65,0)
 ;    CODE - CPT Code/Modifier    REQUIRED
"RTN","ICPTAPIU",66,0)
 ;    CDT - Date to screen against (FileMan format, default = today)
"RTN","ICPTAPIU",67,0)
 ;
"RTN","ICPTAPIU",68,0)
 ; Output:
"RTN","ICPTAPIU",69,0)
 ;    2-Piece String containing the status of the code/modifier
"RTN","ICPTAPIU",70,0)
 ;    and the IEN if the code/modifier exists, else -1.
"RTN","ICPTAPIU",71,0)
 ;    The following are possible outputs:
"RTN","ICPTAPIU",72,0)
 ;        1 ^ IEN    Active Code/Modifier
"RTN","ICPTAPIU",73,0)
 ;        0 ^ IEN    Inactive Code/Modifier
"RTN","ICPTAPIU",74,0)
 ;        0 ^ -1     Code/Modifier not Found
"RTN","ICPTAPIU",75,0)
 ;
"RTN","ICPTAPIU",76,0)
 ; This API requires the ACT Cross-Reference
"RTN","ICPTAPIU",77,0)
 ;    ^ICPT("ACT",<code>,<status>,<date>,<ien>)
"RTN","ICPTAPIU",78,0)
 ;    ^DIC(81.3,"ACT",<code>,<status>,<date>,<ien>)
"RTN","ICPTAPIU",79,0)
 ;
"RTN","ICPTAPIU",80,0)
 N ICPTC,ICPTD,ICPTIEN,ICPTA,ICPTI,X,ICPTG,ICPTR
"RTN","ICPTAPIU",81,0)
 S ICPTC=$G(CODE) Q:'$L(ICPTC) "0^-1"
"RTN","ICPTAPIU",82,0)
 ;    Case 1:  Not Valid                           0^-1
"RTN","ICPTAPIU",83,0)
 ;             Fails Pattern Match for Code
"RTN","ICPTAPIU",84,0)
 S ICPTG=$$GBL^ICPTSUPT(ICPTC) Q:ICPTG="" "0^-1"
"RTN","ICPTAPIU",85,0)
 ;    Case 2:  Never Active                        0^IEN
"RTN","ICPTAPIU",86,0)
 ;             No In/Active Date
"RTN","ICPTAPIU",87,0)
 S CDT=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR^ICPTSUPT(CDT)),ICPTD=CDT+.001
"RTN","ICPTAPIU",88,0)
 S ICPTR=$$ACT(ICPTG,ICPTC,1,ICPTD),ICPTA=$O(@(ICPTR_")"),-1)
"RTN","ICPTAPIU",89,0)
 I '$L(ICPTA) D  Q X
"RTN","ICPTAPIU",90,0)
 . S ICPTA=$O(@(ICPTR_")")),X="0^-1" Q:'$L(ICPTA)
"RTN","ICPTAPIU",91,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,1,ICPTA)
"RTN","ICPTAPIU",92,0)
 . S ICPTIEN=$O(@(ICPTR_",0)")) S:+ICPTIEN<1 ICPTIEN=-1
"RTN","ICPTAPIU",93,0)
 . S X="0^"_ICPTIEN
"RTN","ICPTAPIU",94,0)
 ;    Case 3:  Active, Never Inactive              1^IEN
"RTN","ICPTAPIU",95,0)
 ;             Has an Activation Date
"RTN","ICPTAPIU",96,0)
 ;             No Inactivation Date
"RTN","ICPTAPIU",97,0)
 S ICPTR=$$ACT(ICPTG,ICPTC,0,ICPTD),ICPTI=$O(@(ICPTR_")"),-1)
"RTN","ICPTAPIU",98,0)
 I $L(ICPTA),'$L(ICPTI) D  Q X
"RTN","ICPTAPIU",99,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,1,ICPTA),ICPTIEN=$O(@(ICPTR_",0)"))
"RTN","ICPTAPIU",100,0)
 . S X=$S(+ICPTIEN=0:"0^-1",1:"1^"_ICPTIEN)
"RTN","ICPTAPIU",101,0)
 ;    Case 4:  Active, but later Inactivated       0^IEN
"RTN","ICPTAPIU",102,0)
 ;             Has an In/Activation Date
"RTN","ICPTAPIU",103,0)
 I $L(ICPTA),$L(ICPTI),ICPTI>ICPTA,ICPTI<ICPTD D  Q X
"RTN","ICPTAPIU",104,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,0,ICPTI),ICPTIEN=$O(@(ICPTR_",0)"))
"RTN","ICPTAPIU",105,0)
 . S X=$S(+ICPTIEN=0:"0^-1",1:"0^"_ICPTIEN)
"RTN","ICPTAPIU",106,0)
 ;    Case 5:  Active, and not later Inactivated   1^IEN
"RTN","ICPTAPIU",107,0)
 ;             Has an In/Activation Date
"RTN","ICPTAPIU",108,0)
 ;             Has a Newer Activation Date
"RTN","ICPTAPIU",109,0)
 I $L(ICPTA),$L(ICPTI),ICPTI'>ICPTA D  Q X
"RTN","ICPTAPIU",110,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,0,ICPTI),ICPTIEN=$O(@(ICPTR_",1)"))
"RTN","ICPTAPIU",111,0)
 . S X=$S(+$O(@(ICPTR_",0)"))=0:"0^-1",1:"1^"_ICPTIEN)
"RTN","ICPTAPIU",112,0)
 ;    Case 6:  Fails Time Test                     0^-1
"RTN","ICPTAPIU",113,0)
 Q ("0^"_$S(+($G(ICPTIEN))>0:+($G(ICPTIEN)),1:"-1"))
"RTN","ICPTAPIU",114,0)
 ;
"RTN","ICPTAPIU",115,0)
NEXT(CODE) ; Next CPT Code or Modifier (active or inactive)
"RTN","ICPTAPIU",116,0)
 ; Input:
"RTN","ICPTAPIU",117,0)
 ;    CODE = CPT Code/Modifier   REQUIRED
"RTN","ICPTAPIU",118,0)
 ;
"RTN","ICPTAPIU",119,0)
 ; Output:
"RTN","ICPTAPIU",120,0)
 ;    The Next CPT Code/Modifier, Null if none
"RTN","ICPTAPIU",121,0)
 ;
"RTN","ICPTAPIU",122,0)
 N ICPTC,ICPTG
"RTN","ICPTAPIU",123,0)
 S ICPTC=$G(CODE) Q:'$L(ICPTC) ""
"RTN","ICPTAPIU",124,0)
 S ICPTG=$$GBL^ICPTSUPT(ICPTC) Q:'$L(ICPTG) ""
"RTN","ICPTAPIU",125,0)
 S ICPTC=$O(@(ICPTG_"""BA"","""_ICPTC_" "")"))
"RTN","ICPTAPIU",126,0)
 Q $S(ICPTC="":"",1:$E(ICPTC,1,$L(ICPTC)-1))
"RTN","ICPTAPIU",127,0)
 ;
"RTN","ICPTAPIU",128,0)
PREV(CODE) ; Previous CPT Code or Modifier (active or inactive)
"RTN","ICPTAPIU",129,0)
 ; Input:
"RTN","ICPTAPIU",130,0)
 ;    CODE = CPT Code/Modifier   REQUIRED
"RTN","ICPTAPIU",131,0)
 ;
"RTN","ICPTAPIU",132,0)
 ; Output:
"RTN","ICPTAPIU",133,0)
 ;    The Previous CPT Code/Modifier, Null if none
"RTN","ICPTAPIU",134,0)
 ;
"RTN","ICPTAPIU",135,0)
 N ICPTC,ICPTG
"RTN","ICPTAPIU",136,0)
 S ICPTC=$G(CODE) Q:'$L(ICPTC) ""
"RTN","ICPTAPIU",137,0)
 S ICPTG=$$GBL^ICPTSUPT(ICPTC) Q:'$L(ICPTG) ""
"RTN","ICPTAPIU",138,0)
 S ICPTC=$O(@(ICPTG_"""BA"","""_ICPTC_" "")"),-1)
"RTN","ICPTAPIU",139,0)
 Q $S(ICPTC="":"",1:$E(ICPTC,1,$L(ICPTC)-1))
"RTN","ICPTAPIU",140,0)
 ;
"RTN","ICPTAPIU",141,0)
HIST(CODE,ARY) ; Activation History
"RTN","ICPTAPIU",142,0)
 ; Input:
"RTN","ICPTAPIU",143,0)
 ;    CODE - CPT Code or Modifier          REQUIRED
"RTN","ICPTAPIU",144,0)
 ;    .ARY - Array, passed by Reference    REQUIRED
"RTN","ICPTAPIU",145,0)
 ;
"RTN","ICPTAPIU",146,0)
 ; Output:    Mirrors ARY(0) (or, -1 on error)
"RTN","ICPTAPIU",147,0)
 ;    ARY(0) = Number of Activation History Entries
"RTN","ICPTAPIU",148,0)
 ;    ARY(<date>) = status    where: 1 is Active
"RTN","ICPTAPIU",149,0)
 ;    ARY("IEN") = <ien>
"RTN","ICPTAPIU",150,0)
 ;
"RTN","ICPTAPIU",151,0)
 Q:$G(CODE)="" -1
"RTN","ICPTAPIU",152,0)
 N ICPTC,ICPTI,ICPTN,ICPTD,ICPTG,ICPTF,ICPTO
"RTN","ICPTAPIU",153,0)
 S ICPTG=$$GBL^ICPTSUPT(CODE) Q:'$L(ICPTG) -1
"RTN","ICPTAPIU",154,0)
 S ICPTI=$O(@(ICPTG_"""BA"","""_CODE_" "",0)")) Q:'$L(ICPTI) -1
"RTN","ICPTAPIU",155,0)
 S ARY("IEN")=ICPTI,ICPTO="" M ICPTO=@(ICPTG_ICPTI_",60)")
"RTN","ICPTAPIU",156,0)
 K ICPT0("B") S ARY(0)=+($P($G(ICPTO(0)),"^",4))
"RTN","ICPTAPIU",157,0)
 S:+ARY(0)=0 ARY(0)=-1 K:ARY(0)=-1 ARY("IEN")
"RTN","ICPTAPIU",158,0)
 S (ICPTI,ICPTC)=0 F  S ICPTI=$O(ICPTO(ICPTI)) Q:+ICPTI=0  D
"RTN","ICPTAPIU",159,0)
 . S ICPTD=$P($G(ICPTO(ICPTI,0)),"^",1) Q:+ICPTD=0
"RTN","ICPTAPIU",160,0)
 . S ICPTF=$P($G(ICPTO(ICPTI,0)),"^",2) Q:'$L(ICPTF)
"RTN","ICPTAPIU",161,0)
 . S ICPTC=ICPTC+1,ARY(0)=ICPTC,ARY(ICPTD)=ICPTF
"RTN","ICPTAPIU",162,0)
 Q ARY(0)
"RTN","ICPTAPIU",163,0)
 ;
"RTN","ICPTAPIU",164,0)
PERIOD(CODE,ARY) ; return Activation/Inactivation Period in ARY
"RTN","ICPTAPIU",165,0)
 ; Input:
"RTN","ICPTAPIU",166,0)
 ;    CODE - CPT  Code or Modifier        REQUIRED
"RTN","ICPTAPIU",167,0)
 ;    .ARY - Array, passed by Reference   REQUIRED
"RTN","ICPTAPIU",168,0)
 ; Output:
"RTN","ICPTAPIU",169,0)
 ;    ARY(0) = IEN^Selectable
"RTN","ICPTAPIU",170,0)
 ;       Where IEN = -1 if error
"RTN","ICPTAPIU",171,0)
 ;             Selectable = 0 for VA Only codes
"RTN","ICPTAPIU",172,0)
 ;    ARY(Act_date) = Inactivation Date^Short Name Text
"RTN","ICPTAPIU",173,0)
 ;
"RTN","ICPTAPIU",174,0)
 I $G(CODE)="" S ARY(0)="-1^0" Q
"RTN","ICPTAPIU",175,0)
 N ICPTC,ICPTI,ICPTA,ICPTG,ICPTF,ICPTBA,ICPTBI,ICPTST,ICPTS,ICPTZ
"RTN","ICPTAPIU",176,0)
 S ICPTG=$$GBL^ICPTSUPT(CODE) I ICPTG="" S ARY(0)="-1^0" Q
"RTN","ICPTAPIU",177,0)
 S ICPTC=$O(@(ICPTG_"""BA"","""_CODE_" "",0)")) I ICPTC="" S ARY(0)="-1^0" Q
"RTN","ICPTAPIU",178,0)
 S (ARY(0),ICPTC)=+ICPTC,ICPTZ=$G(@(ICPTG_ICPTC_",0)")),ICPTS=$P(ICPTZ,"^",2)
"RTN","ICPTAPIU",179,0)
 S $P(ARY(0),"^",2)=$S(ICPTG="^ICPT(":$P(ICPTZ,"^",6)'="L",1:$P(ICPTZ,"^",4)'="V")
"RTN","ICPTAPIU",180,0)
 S (ICPTA,ICPTBA)=0,ICPTG=ICPTG_ICPTC_",60,"
"RTN","ICPTAPIU",181,0)
 F  Q:ICPTBA  D
"RTN","ICPTAPIU",182,0)
 . S ICPTA=$O(@(ICPTG_"""B"","_ICPTA_")"))
"RTN","ICPTAPIU",183,0)
 . I ICPTA="" S ICPTBA=1 Q
"RTN","ICPTAPIU",184,0)
 . S ICPTF=$O(@(ICPTG_"""B"","_ICPTA_",0)"))
"RTN","ICPTAPIU",185,0)
 . I '+ICPTF S ICPTBA=1 Q
"RTN","ICPTAPIU",186,0)
 . S ICPTST=$P($G(@(ICPTG_ICPTF_",0)")),"^",2)
"RTN","ICPTAPIU",187,0)
 . Q:'ICPTST  ;outer loop looks for active
"RTN","ICPTAPIU",188,0)
 . S ARY(ICPTA)="^"_ICPTS,ICPTBI=0,ICPTI=ICPTA
"RTN","ICPTAPIU",189,0)
 . F  Q:ICPTBI  D
"RTN","ICPTAPIU",190,0)
 . . S ICPTI=$O(@(ICPTG_"""B"","_ICPTI_")"))
"RTN","ICPTAPIU",191,0)
 . . I ICPTI="" S (ICPTBI,ICPTBA)=1 Q
"RTN","ICPTAPIU",192,0)
 . . S ICPTF=$O(@(ICPTG_"""B"","_ICPTI_",0)"))
"RTN","ICPTAPIU",193,0)
 . . I '+ICPTF S (ICPTBI,ICPTBA)=1 Q
"RTN","ICPTAPIU",194,0)
 . . S ICPTST=$P($G(@(ICPTG_ICPTF_",0)")),"^",2)
"RTN","ICPTAPIU",195,0)
 . . I ICPTST S ICPTBI=1 Q  ;inner loop looks for inactive
"RTN","ICPTAPIU",196,0)
 . . S $P(ARY(ICPTA),"^")=ICPTI,ICPTBI=1,ICPTA=ICPTI
"RTN","ICPTAPIU",197,0)
 Q
"RTN","ICPTAPIU",198,0)
 ;
"RTN","ICPTAPIU",199,0)
ACT(ICPTG,ICPTC,ICPTS,ICPTD) ; return "ACT" root
"RTN","ICPTAPIU",200,0)
 Q ICPTG_"""ACT"","""_ICPTC_" "","_ICPTS_","_ICPTD
"RTN","ICPTAU")
0^2^B195926
"RTN","ICPTAU",1,0)
ICPTAU ;DLS/DEK/KER - CPT Annual Update Protocol for CPT Codes ; 10/22/2003
"RTN","ICPTAU",2,0)
 ;;6.0;CPT/HCPCS;**14,16**;May 19, 1997
"RTN","ICPTAU",3,0)
 ;
"RTN","ICPTAU",4,0)
 ; Quit Update if NOT CPT Procedure Related 
"RTN","ICPTAU",5,0)
 ;
"RTN","ICPTAU",6,0)
 ;   XQORQUIT  Signals the Unwinder to not process 
"RTN","ICPTAU",7,0)
 ;             any protocols that are subordinate to 
"RTN","ICPTAU",8,0)
 ;             the current protocol.  Control is passed
"RTN","ICPTAU",9,0)
 ;             to the next sibling protocol.
"RTN","ICPTAU",10,0)
 ;
"RTN","ICPTAU",11,0)
 S:'$D(LEXSCHG(757.9,"B",81))&('$D(LEXSCHG(757.9,"B",81.3))) XQORQUIT=1
"RTN","ICPTAU",12,0)
 Q
"RTN","ICPTCOD")
0^4^B27712594
"RTN","ICPTCOD",1,0)
ICPTCOD ;ALB/ABR/DEK - CPT CODE APIS ; 04/28/2003
"RTN","ICPTCOD",2,0)
 ;;6.0;CPT/HCPCS;**6,12,13,14,16**;May 19, 1997
"RTN","ICPTCOD",3,0)
 ;
"RTN","ICPTCOD",4,0)
 ; External References
"RTN","ICPTCOD",5,0)
 ;   DBIA  10103  $$DT^XLFDT
"RTN","ICPTCOD",6,0)
 ;                         
"RTN","ICPTCOD",7,0)
CPT(CODE,CDT,SRC,DFN) ; returns basic info on CPT/HCPCS code
"RTN","ICPTCOD",8,0)
 ; Input:
"RTN","ICPTCOD",9,0)
 ;    CODE - CPT or HCPCS code, ien or .01 format, REQUIRED
"RTN","ICPTCOD",10,0)
 ;    CDT - active as of date, default = today (FileMan format)
"RTN","ICPTCOD",11,0)
 ;          If CDT < 2890101, use 2890101
"RTN","ICPTCOD",12,0)
 ;          If CDT > DT, validate with newest In/Activation Dates
"RTN","ICPTCOD",13,0)
 ;          If CDT is year only, use first of the year
"RTN","ICPTCOD",14,0)
 ;          If CDT is year and month only, use first of the month
"RTN","ICPTCOD",15,0)
 ;    SRC - SCREEN SOURCE
"RTN","ICPTCOD",16,0)
 ;          If '$G(SRC), level 1, Level 2 only.
"RTN","ICPTCOD",17,0)
 ;          If $G(SRC), include level 3.
"RTN","ICPTCOD",18,0)
 ;    DFN - not in use but included in anticipation of future need
"RTN","ICPTCOD",19,0)
 ;
"RTN","ICPTCOD",20,0)
 ;  Output:  string:
"RTN","ICPTCOD",21,0)
 ;      ien^CPT CODE^SHORT NAME^CATEGORY ien^SOURCE^EFFECTIVE DATE^STATUS^Inactivation Date^Activation Date^MSG
"RTN","ICPTCOD",22,0)
 ;             where STATUS = 0 - inactive
"RTN","ICPTCOD",23,0)
 ;                          = 1 - active
"RTN","ICPTCOD",24,0)
 ;           EFFECTIVE DATE = date status became effective
"RTN","ICPTCOD",25,0)
 ;           Activation Date = date code became active
"RTN","ICPTCOD",26,0)
 ;           Inactivation Date = date code became inactive
"RTN","ICPTCOD",27,0)
 ;           MSG = User Alert
"RTN","ICPTCOD",28,0)
 ;  -or-
"RTN","ICPTCOD",29,0)
 ;         -1^error description
"RTN","ICPTCOD",30,0)
 ;
"RTN","ICPTCOD",31,0)
 ; Variables:
"RTN","ICPTCOD",32,0)
 ;     DATA = 0-node for CPT code
"RTN","ICPTCOD",33,0)
 ;     EFF = effective date
"RTN","ICPTCOD",34,0)
 ;     STR = output
"RTN","ICPTCOD",35,0)
 ;
"RTN","ICPTCOD",36,0)
 N DATA,EFF,STR
"RTN","ICPTCOD",37,0)
 I $G(CODE)="" S STR="-1^NO CODE SELECTED" G CPTQ
"RTN","ICPTCOD",38,0)
 S CODE=$G(CODE),CODE=$S(CODE?1.N:+CODE,1:$$CODEN(CODE)) ; find ien for code
"RTN","ICPTCOD",39,0)
 I CODE<1!'$D(^ICPT(CODE)) S STR="-1^NO SUCH ENTRY" G CPTQ ; if no code, return error
"RTN","ICPTCOD",40,0)
 I '$G(SRC),$P(^ICPT(CODE,0),"^",6)="L" S STR="-1^VA LOCAL CODE SELECTED" G CPTQ
"RTN","ICPTCOD",41,0)
 ;
"RTN","ICPTCOD",42,0)
 S DATA=$G(^ICPT(CODE,0)) ;  store 0-node data
"RTN","ICPTCOD",43,0)
 I '$L(DATA) S STR="-1^NO DATA" G CPTQ
"RTN","ICPTCOD",44,0)
 ;I $G(CDT)="" S CDT=DT  ;if no date selected, picks today.
"RTN","ICPTCOD",45,0)
 S CDT=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR^ICPTSUPT(CDT))
"RTN","ICPTCOD",46,0)
 S STR=CODE_"^"_DATA,$P(STR,"^",5)=$P(STR,"^",7),STR=$P(STR,"^",1,5)
"RTN","ICPTCOD",47,0)
 S EFF=$$EFF^ICPTSUPT(81,CODE,CDT)
"RTN","ICPTCOD",48,0)
 I EFF<1 S $P(EFF,"^",2)=0
"RTN","ICPTCOD",49,0)
 S STR=STR_"^"_EFF_"^"_$$MSG^ICPTSUPT(CDT)
"RTN","ICPTCOD",50,0)
CPTQ Q STR
"RTN","ICPTCOD",51,0)
 ;
"RTN","ICPTCOD",52,0)
CPTD(CODE,OUTARR,DFN,CDT) ; returns CPT description in array
"RTN","ICPTCOD",53,0)
 ; Input:
"RTN","ICPTCOD",54,0)
 ;    CODE - CPT/HCPCS code  REQUIRED
"RTN","ICPTCOD",55,0)
 ;    OUTARR - array to store description
"RTN","ICPTCOD",56,0)
 ;               name of array - e.g. "ABC" or "ABC("TEST")" 
"RTN","ICPTCOD",57,0)
 ;               or temp array.  Default = ^TMP("ICPTD",$J)
"RTN","ICPTCOD",58,0)
 ;    DFN - not in use but included in anticipation of future need
"RTN","ICPTCOD",59,0)
 ;    CDT - active as of date, default = today (FileMan format)
"RTN","ICPTCOD",60,0)
 ;             If CDT < 2890101, use 2890101
"RTN","ICPTCOD",61,0)
 ;             If CDT > DT, validate with newest In/Activation Dates
"RTN","ICPTCOD",62,0)
 ;             If CDT is year only, use first of the year
"RTN","ICPTCOD",63,0)
 ;             If CDT is year and month only, use first of the month
"RTN","ICPTCOD",64,0)
 ;
"RTN","ICPTCOD",65,0)
 ;  Output:  # of lines
"RTN","ICPTCOD",66,0)
 ;           @OUTARR(1-n)  lines of description
"RTN","ICPTCOD",67,0)
 ;           @OUTARR(n) = User Alert
"RTN","ICPTCOD",68,0)
 ;        -or-
"RTN","ICPTCOD",69,0)
 ;           -1^error message
"RTN","ICPTCOD",70,0)
 ;
"RTN","ICPTCOD",71,0)
 ; **NOTE - USER MUST INITIALIZE ^TMP("ICPTD",$J), IF USED**
"RTN","ICPTCOD",72,0)
 ;
"RTN","ICPTCOD",73,0)
 N ARR,END,I,N
"RTN","ICPTCOD",74,0)
 I $G(CODE)="" S N="-1^NO CODE SELECTED" G CPTDQ
"RTN","ICPTCOD",75,0)
 I $G(OUTARR)="" S OUTARR="^TMP(""ICPTD"",$J,"
"RTN","ICPTCOD",76,0)
 ;
"RTN","ICPTCOD",77,0)
 ; check to make sure OUTARR is in proper format
"RTN","ICPTCOD",78,0)
 I OUTARR'["(" S OUTARR=OUTARR_"("
"RTN","ICPTCOD",79,0)
 I OUTARR[")" S OUTARR=$P(OUTARR,")")
"RTN","ICPTCOD",80,0)
 S END=$E(OUTARR,$L(OUTARR)) I END'="("&(END'=",") S OUTARR=OUTARR_","
"RTN","ICPTCOD",81,0)
 ;
"RTN","ICPTCOD",82,0)
 ; If ^TMP("ICPTD",$J, used, clear before using
"RTN","ICPTCOD",83,0)
 I OUTARR="^TMP(""ICPTD"",$J," K ^TMP("ICPTD",$J)
"RTN","ICPTCOD",84,0)
 S CODE=$S(CODE?1.N:+CODE,1:$$CODEN(CODE)),I=0,N=0
"RTN","ICPTCOD",85,0)
 I CODE<1!'$D(^ICPT(CODE)) S N="-1^NO SUCH CODE" G CPTDQ ; if no code, return error
"RTN","ICPTCOD",86,0)
 S CDT=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR^ICPTSUPT(CDT)) ;date business rules
"RTN","ICPTCOD",87,0)
 F  S I=$O(^ICPT(CODE,"D",I)) Q:'I  S N=N+1,ARR=OUTARR_N_")",@ARR=$G(^(I,0))
"RTN","ICPTCOD",88,0)
 S N=N+1,ARR=OUTARR_N_")",@ARR=" "
"RTN","ICPTCOD",89,0)
 S N=N+1,ARR=OUTARR_N_")",@ARR=$$MSG^ICPTSUPT(CDT)
"RTN","ICPTCOD",90,0)
CPTDQ Q N
"RTN","ICPTCOD",91,0)
 ;
"RTN","ICPTCOD",92,0)
CODM(CODE,OUTARR,SRC,CDT,DFN) ; returns list of modifiers for a code
"RTN","ICPTCOD",93,0)
 ; Input:
"RTN","ICPTCOD",94,0)
 ;       CODE = CPT/HCPCS code (Internal or external format)
"RTN","ICPTCOD",95,0)
 ;       OUTARR = array name for list returned
"RTN","ICPTCOD",96,0)
 ;               name of array - e.g. "ABC" or "ABC("TEST")"
"RTN","ICPTCOD",97,0)
 ;               or temp array.  Default = ^TMP("ICPTM",$J)
"RTN","ICPTCOD",98,0)
 ;       SRC = Source Screen.
"RTN","ICPTCOD",99,0)
 ;               If 0 or Null, use national(level 1,level 2)mods only
"RTN","ICPTCOD",100,0)
 ;               If SRC>0, use all mods, locals (level 3) included.
"RTN","ICPTCOD",101,0)
 ;       CDT = date in Fileman format to check modifier status.
"RTN","ICPTCOD",102,0)
 ;             If 0 or Null, return all the modifiers for a code.
"RTN","ICPTCOD",103,0)
 ;             Else return only modifiers active on the date of CDT
"RTN","ICPTCOD",104,0)
 ;             If CDT < 2890101, use 2890101
"RTN","ICPTCOD",105,0)
 ;             If CDT > DT, validate with newest In/Activation Dates
"RTN","ICPTCOD",106,0)
 ;             If CDT is year only, use first of the year
"RTN","ICPTCOD",107,0)
 ;             If CDT is year and month only, use first of the month
"RTN","ICPTCOD",108,0)
 ;       DFN = not in use. Included in anticipation of future need.
"RTN","ICPTCOD",109,0)
 ;
"RTN","ICPTCOD",110,0)
 ; Output:    STR = # of modifiers that apply
"RTN","ICPTCOD",111,0)
 ;          OUTARR array in the format:
"RTN","ICPTCOD",112,0)
 ;            OUTARR(mod) = name^mod ien
"RTN","ICPTCOD",113,0)
 ;                (mod is the .01 field)
"RTN","ICPTCOD",114,0)
 ;             -1^error description
"RTN","ICPTCOD",115,0)
 ;
"RTN","ICPTCOD",116,0)
 ;**NOTE - USER MUST INITIALIZE ^TMP("ICPTM",$J) ARRAY**
"RTN","ICPTCOD",117,0)
 ;
"RTN","ICPTCOD",118,0)
 N ARR,CODI,CODA,BR,END,ER,MD,MDST,MI,MN,STR,CODEC,ACTMD
"RTN","ICPTCOD",119,0)
 I $G(CODE)="" S STR="-1^NO CPT SELECTED" G CODMQ
"RTN","ICPTCOD",120,0)
 I $G(OUTARR)="" S OUTARR="^TMP(""ICPTM"",$J,"
"RTN","ICPTCOD",121,0)
 S STR=0,CODI=$S(CODE?1.N:+CODE,1:$$CODEN(CODE))
"RTN","ICPTCOD",122,0)
 I CODI<1!'$D(^ICPT(CODI,0)) S STR="-1^NO SUCH CODE" G CODMQ
"RTN","ICPTCOD",123,0)
 I '$G(SRC),$P(^ICPT(CODI,0),"^",6)="L" S STR="-1^VA LOCAL CODE SELECTED" G CODMQ
"RTN","ICPTCOD",124,0)
 S CODEC=$$CODEC(CODI),CODA=$$NUM^ICPTAPIU(CODEC)
"RTN","ICPTCOD",125,0)
 ;
"RTN","ICPTCOD",126,0)
 ; check to make sure OUTARR is in proper format
"RTN","ICPTCOD",127,0)
 I OUTARR'["(" S OUTARR=OUTARR_"("
"RTN","ICPTCOD",128,0)
 I OUTARR[")" S OUTARR=$P(OUTARR,")")
"RTN","ICPTCOD",129,0)
 S END=$E(OUTARR,$L(OUTARR)) I END'="("&(END'=",") S OUTARR=OUTARR_","
"RTN","ICPTCOD",130,0)
 ;
"RTN","ICPTCOD",131,0)
 ; If ^TMP("ICPTM",$J, used, clear before using
"RTN","ICPTCOD",132,0)
 I OUTARR="^TMP(""ICPTM"",$J," K ^TMP("ICPTM",$J)
"RTN","ICPTCOD",133,0)
 ;find first begin range
"RTN","ICPTCOD",134,0)
 ;  BR = Begin Range; ER = End Range
"RTN","ICPTCOD",135,0)
 S:$G(CDT)]"" CDT=$$DTBR^ICPTSUPT(CDT) ;date business rules
"RTN","ICPTCOD",136,0)
 S BR="" F  S BR=$O(^DIC(81.3,"M",BR)) Q:BR>CODA!'BR  D  ; find begin range
"RTN","ICPTCOD",137,0)
 .S ER="" F  S ER=$O(^DIC(81.3,"M",BR,ER)) Q:'ER  I CODA'>ER D
"RTN","ICPTCOD",138,0)
 ..S MI=0 F  S MI=$O(^DIC(81.3,"M",BR,ER,MI)) Q:'MI  D
"RTN","ICPTCOD",139,0)
 ...S MDST=$G(^DIC(81.3,MI,0)) Q:'$L(MDST)  ; quits if no data node
"RTN","ICPTCOD",140,0)
 ...I '$G(SRC) Q:$P(MDST,"^",4)="V"  ; screens out local (VA) modifiers
"RTN","ICPTCOD",141,0)
 ...I $G(CDT) S ACTMD="",ACTMD=$$MOD^ICPTMOD(MI,"I",CDT,$G(SRC)) Q:($P(ACTMD,"^")=-1)!($P(ACTMD,"^",7)=0)  ;screens out inactive modifiers if asked to.
"RTN","ICPTCOD",142,0)
 ...S MD=$P(MDST,"^",1,2),MN=$P(MD,"^")
"RTN","ICPTCOD",143,0)
 ...I $L(MN)'=2 Q  ; checks for valid modifier format
"RTN","ICPTCOD",144,0)
 ...S ARR=OUTARR_""""_MN_""")",@ARR=$P(MD,"^",2)_"^"_MI,STR=STR+1
"RTN","ICPTCOD",145,0)
 I 'STR S STR=0
"RTN","ICPTCOD",146,0)
CODMQ Q STR
"RTN","ICPTCOD",147,0)
 ;
"RTN","ICPTCOD",148,0)
CODEN(CODE) ; return the ien of a CPT or HCPCS code
"RTN","ICPTCOD",149,0)
 ;   Input:  CPT/HCPCS code
"RTN","ICPTCOD",150,0)
 ;  Output:  ien of code
"RTN","ICPTCOD",151,0)
 ;
"RTN","ICPTCOD",152,0)
 I $G(CODE)="" Q -1
"RTN","ICPTCOD",153,0)
 N COD
"RTN","ICPTCOD",154,0)
 S COD=+$O(^ICPT("B",CODE,0))
"RTN","ICPTCOD",155,0)
 Q $S(COD>0:COD,1:-1)
"RTN","ICPTCOD",156,0)
 ;
"RTN","ICPTCOD",157,0)
CODEC(CODE) ; return the CPT or HCPCS code of an ien.
"RTN","ICPTCOD",158,0)
 ;  Input: ien of CPT/HCPCS code
"RTN","ICPTCOD",159,0)
 ; Output: CPT/HCPCS code
"RTN","ICPTCOD",160,0)
 ;
"RTN","ICPTCOD",161,0)
 I $G(CODE)="" Q -1
"RTN","ICPTCOD",162,0)
 N Y
"RTN","ICPTCOD",163,0)
 S Y=$P($G(^ICPT(CODE,0)),"^")
"RTN","ICPTCOD",164,0)
 Q $S(Y="":-1,1:Y)
"RTN","ICPTCOD",165,0)
 ;
"RTN","ICPTCOD",166,0)
VALCPT(CODE,CDT,SRC,DFN) ;check if CPT code is valid for selection
"RTN","ICPTCOD",167,0)
 ; Input:
"RTN","ICPTCOD",168,0)
 ;    CODE - CPT or HCPCS code, ien or .01 format, REQUIRED
"RTN","ICPTCOD",169,0)
 ;    CDT - active as of date, default = today (FileMan format)
"RTN","ICPTCOD",170,0)
 ;          If CDT < 2890101, use 2890101
"RTN","ICPTCOD",171,0)
 ;          If CDT > DT, validate with newest In/Activation Dates
"RTN","ICPTCOD",172,0)
 ;          If CDT is year only, use first of the year
"RTN","ICPTCOD",173,0)
 ;          If CDT is year and month only, use first of the month
"RTN","ICPTCOD",174,0)
 ;    SRC - SCREEN SOURCE '$G(SRC) level 1, Level 2 only, $G(SRC) include level 3
"RTN","ICPTCOD",175,0)
 ;    DFN - not in use but included in anticipation of future need
"RTN","ICPTCOD",176,0)
 ;
"RTN","ICPTCOD",177,0)
 ; Output: STR:  1 if valid code for selection
"RTN","ICPTCOD",178,0)
 ;               -1^error message    if not selectable
"RTN","ICPTCOD",179,0)
 ;
"RTN","ICPTCOD",180,0)
 N STR
"RTN","ICPTCOD",181,0)
 S CODE=$G(CODE),SRC=$G(SRC),DFN=$G(DFN)
"RTN","ICPTCOD",182,0)
 S CDT=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR^ICPTSUPT(CDT)) ;date business rules
"RTN","ICPTCOD",183,0)
 S STR=$$CPT(CODE,CDT,SRC,DFN)
"RTN","ICPTCOD",184,0)
 I STR<0 G VALCPTQ
"RTN","ICPTCOD",185,0)
 I '$P(STR,"^",7) S STR="-1^INACTIVE CODE"
"RTN","ICPTCOD",186,0)
 I STR>0 S STR=1
"RTN","ICPTCOD",187,0)
VALCPTQ Q STR
"VER")
8.0^22.0
**END**
**END**
