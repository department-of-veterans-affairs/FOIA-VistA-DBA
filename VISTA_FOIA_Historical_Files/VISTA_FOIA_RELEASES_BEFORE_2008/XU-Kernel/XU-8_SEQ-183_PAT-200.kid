Released XU*8*200 SEQ #183
Extracted from mail message
**KIDS**:XU*8.0*200^

**INSTALL NAME**
XU*8.0*200
"BLD",427,0)
XU*8.0*200^KERNEL^0^3010511^y
"BLD",427,4,0)
^9.64PA^^
"BLD",427,"KRN",0)
^9.67PA^8994.2^18
"BLD",427,"KRN",.4,0)
.4
"BLD",427,"KRN",.401,0)
.401
"BLD",427,"KRN",.402,0)
.402
"BLD",427,"KRN",.403,0)
.403
"BLD",427,"KRN",.5,0)
.5
"BLD",427,"KRN",.84,0)
.84
"BLD",427,"KRN",3.6,0)
3.6
"BLD",427,"KRN",3.8,0)
3.8
"BLD",427,"KRN",9.2,0)
9.2
"BLD",427,"KRN",9.8,0)
9.8
"BLD",427,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",427,"KRN",9.8,"NM",1,0)
XPDIJ1^^0^B30144798
"BLD",427,"KRN",9.8,"NM","B","XPDIJ1",1)

"BLD",427,"KRN",19,0)
19
"BLD",427,"KRN",19.1,0)
19.1
"BLD",427,"KRN",101,0)
101
"BLD",427,"KRN",409.61,0)
409.61
"BLD",427,"KRN",771,0)
771
"BLD",427,"KRN",870,0)
870
"BLD",427,"KRN",8994,0)
8994
"BLD",427,"KRN",8994.2,0)
8994.2
"BLD",427,"KRN","B",.4,.4)

"BLD",427,"KRN","B",.401,.401)

"BLD",427,"KRN","B",.402,.402)

"BLD",427,"KRN","B",.403,.403)

"BLD",427,"KRN","B",.5,.5)

"BLD",427,"KRN","B",.84,.84)

"BLD",427,"KRN","B",3.6,3.6)

"BLD",427,"KRN","B",3.8,3.8)

"BLD",427,"KRN","B",9.2,9.2)

"BLD",427,"KRN","B",9.8,9.8)

"BLD",427,"KRN","B",19,19)

"BLD",427,"KRN","B",19.1,19.1)

"BLD",427,"KRN","B",101,101)

"BLD",427,"KRN","B",409.61,409.61)

"BLD",427,"KRN","B",771,771)

"BLD",427,"KRN","B",870,870)

"BLD",427,"KRN","B",8994,8994)

"BLD",427,"KRN","B",8994.2,8994.2)

"BLD",427,"QUES",0)
^9.62^^
"MBREQ")
0
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^0
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2970507^.5
"PKG",3,22,1,"PAH",1,0)
200^3010511
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XPDIJ1")
0^1^B30144798
"RTN","XPDIJ1",1,0)
XPDIJ1 ;SFISC/RSD - Cont. of Install Job ;05/11/2001  09:07
"RTN","XPDIJ1",2,0)
 ;;8.0;KERNEL;**41,68,108,200**;Jul 10, 1995
"RTN","XPDIJ1",3,0)
IN ;install XPDA
"RTN","XPDIJ1",4,0)
 ;XPDA=ien of file 9.7, XPDNM=package name
"RTN","XPDIJ1",5,0)
 Q:'$D(^XTMP("XPDI",XPDA))!'$D(^XPD(9.7,XPDA,0))
"RTN","XPDIJ1",6,0)
 ;check if already installed
"RTN","XPDIJ1",7,0)
 I $P($G(^XPD(9.7,XPDA,1)),U,3) D BMES^XPDUTL(" "_XPDNM_" Already Installed ") Q
"RTN","XPDIJ1",8,0)
 N DIFROM,XPD,XPD0,XPDBLD,XPDCHECK,XPDCP,XPDI,XPDGREF,XPDIST,XPDIDTOT,XPDIDCNT,XPDIDMOD,XPDRTN
"RTN","XPDIJ1",9,0)
 ;XPDBLD subscript for build entry i.e. ^XTMP("XPDI",XPDA,"BLD",XPDBLD
"RTN","XPDIJ1",10,0)
 S DIFROM=$$VER^XPDUTL(XPDNM),XPDBLD=$O(^XTMP("XPDI",XPDA,"BLD",0)),XPDGREF="^XTMP(""XPDI"","_XPDA_",""TEMP"")"
"RTN","XPDIJ1",11,0)
 D TITLE^XPDID(XPDNM)
"RTN","XPDIJ1",12,0)
 ;the $T is there only for installing patch 41 to prevent a noline error
"RTN","XPDIJ1",13,0)
 ;check that Package file has entry
"RTN","XPDIJ1",14,0)
 I $T(PKGADD^XPDIP)]"" S Y=$$PKGADD^XPDIP
"RTN","XPDIJ1",15,0)
 S XPD0=^XTMP("XPDI",XPDA,"BLD",XPDBLD,0)
"RTN","XPDIJ1",16,0)
 I '$$CHK(11) D
"RTN","XPDIJ1",17,0)
 .D BMES^XPDUTL(" Install Started for "_XPDNM_" : "),STMP(11)
"RTN","XPDIJ1",18,0)
 .;update status, installed by fields and distribution date
"RTN","XPDIJ1",19,0)
 .S XPD(9.7,XPDA_",",.02)=2,XPD(9.7,XPDA_",",9)=DUZ,XPD(9.7,XPDA_",",51)=$P(XPD0,U,4)
"RTN","XPDIJ1",20,0)
 .D FILE^DIE("","XPD")
"RTN","XPDIJ1",21,0)
 E  D BMES^XPDUTL(" Install Restarted for "_XPDNM_" at "_$$HTE^XLFDT($H))
"RTN","XPDIJ1",22,0)
 D BMES^XPDUTL("Build Distribution Date: "_$$FMTE^XLFDT($P(XPD0,U,4)))
"RTN","XPDIJ1",23,0)
 D RTN Q:$D(XPDABORT)
"RTN","XPDIJ1",24,0)
 D PRE Q:$D(XPDABORT)
"RTN","XPDIJ1",25,0)
 D FMDATA Q:$D(XPDABORT)
"RTN","XPDIJ1",26,0)
 D COMP Q:$D(XPDABORT)
"RTN","XPDIJ1",27,0)
 D POST:$G(XPDT("MASTER"))'=XPDA
"RTN","XPDIJ1",28,0)
 Q  ;Finshed
"RTN","XPDIJ1",29,0)
 ;
"RTN","XPDIJ1",30,0)
RTN I '$$CHK(12) D
"RTN","XPDIJ1",31,0)
 .D BMES^XPDUTL(" Installing Routines:"),SETTOT^XPDID(9.8),RTN^XPDIJ(XPDA),STMP(12)
"RTN","XPDIJ1",32,0)
 E  D BMES^XPDUTL(" Routines already installed.")
"RTN","XPDIJ1",33,0)
 Q
"RTN","XPDIJ1",34,0)
 ;
"RTN","XPDIJ1",35,0)
PRE S XPDCP="INI"
"RTN","XPDIJ1",36,0)
 ;check if pre-install has completed
"RTN","XPDIJ1",37,0)
 I '$$VERCP^XPDUTL("XPD PREINSTALL COMPLETED") D  Q:$D(XPDABORT)
"RTN","XPDIJ1",38,0)
 .;setup XPDQUES array with pre-install questions/answers
"RTN","XPDIJ1",39,0)
 .D QUES^XPDIQ("PRE")
"RTN","XPDIJ1",40,0)
 .;XPDCHECK=ien of current checkpoint, (0)=name of checkpoint
"RTN","XPDIJ1",41,0)
 .;XPDCP="INI"-pre install or "INIT"-post install
"RTN","XPDIJ1",42,0)
 .;loop thru check points starting with INSTALL STARTED
"RTN","XPDIJ1",43,0)
 .S XPDCHECK=1
"RTN","XPDIJ1",44,0)
 .F  S XPDCHECK=$O(^XPD(9.7,XPDA,"INI",XPDCHECK)) Q:'XPDCHECK  S XPD=^(XPDCHECK,0) D  Q:$D(XPDABORT)
"RTN","XPDIJ1",45,0)
 ..;if there is no call back, quit
"RTN","XPDIJ1",46,0)
 ..Q:$G(^XPD(9.7,XPDA,"INI",XPDCHECK,1))=""  S XPDRTN=^(1)
"RTN","XPDIJ1",47,0)
 ..;check if checkpoint has been completed
"RTN","XPDIJ1",48,0)
 ..Q:$P(XPD,U,2)
"RTN","XPDIJ1",49,0)
 ..I XPDCHECK=2 D BMES^XPDUTL(" Running Pre-Install Routine: "_XPDRTN)
"RTN","XPDIJ1",50,0)
 ..;zero the progress bar
"RTN","XPDIJ1",51,0)
 ..I $D(XPDIDVT) S XPDIDTOT=0 D UPDATE^XPDID(0)
"RTN","XPDIJ1",52,0)
 ..D @XPDRTN
"RTN","XPDIJ1",53,0)
 ..;write message and abort if developer wants
"RTN","XPDIJ1",54,0)
 ..I $D(XPDABORT) D BMES^XPDUTL("Install ** ABORTED ** in Pre-Install program") Q
"RTN","XPDIJ1",55,0)
 ..S %=$$COMCP^XPDUTL(XPDCHECK)
"RTN","XPDIJ1",56,0)
 .Q:$D(XPDABORT)
"RTN","XPDIJ1",57,0)
 .;complete pre-init check point
"RTN","XPDIJ1",58,0)
 .S %=$$COMCP^XPDUTL("XPD PREINSTALL COMPLETED")
"RTN","XPDIJ1",59,0)
 E  D BMES^XPDUTL(" Pre-Install already finished.")
"RTN","XPDIJ1",60,0)
 Q
"RTN","XPDIJ1",61,0)
 ;
"RTN","XPDIJ1",62,0)
FMDATA ;build XPDQUES arrays for all of the FM Files
"RTN","XPDIJ1",63,0)
 D QUES^XPDIQ("XPF")
"RTN","XPDIJ1",64,0)
 ;check the last file and see if it's already installed
"RTN","XPDIJ1",65,0)
 S XPD=$G(^(+$O(^XPD(9.7,XPDA,4,"A"),-1),0))
"RTN","XPDIJ1",66,0)
 I '$P(XPD,U,2) D:$D(^XTMP("XPDI",XPDA,"FIA"))
"RTN","XPDIJ1",67,0)
 .D BMES^XPDUTL(" Installing Data Dictionaries: "),SETTOT^XPDID(4),FIA^XPDIK,MES^XPDUTL("               "_$$HTE^XLFDT($H))
"RTN","XPDIJ1",68,0)
 E  D BMES^XPDUTL(" Data Dictionaries already installed.")
"RTN","XPDIJ1",69,0)
 S %=+$O(^XTMP("XPDI",XPDA,"DATA",""),-1),XPD=$G(^XPD(9.7,XPDA,4,%,0))
"RTN","XPDIJ1",70,0)
 I '$P(XPD,U,3) D:%
"RTN","XPDIJ1",71,0)
 .D BMES^XPDUTL(" Installing Data: "),DAT^XPDIK,MES^XPDUTL("               "_$$HTE^XLFDT($H))
"RTN","XPDIJ1",72,0)
 E  D BMES^XPDUTL(" Data already installed.")
"RTN","XPDIJ1",73,0)
 Q
"RTN","XPDIJ1",74,0)
 ;
"RTN","XPDIJ1",75,0)
COMP S (%,XPD)=""
"RTN","XPDIJ1",76,0)
 F  S %=+$O(^XPD(9.7,XPDA,"KRN",%)) Q:'%  S XPD=$G(^(%,0)) Q:'$P(XPD,U,2)
"RTN","XPDIJ1",77,0)
 I '$P(XPD,U,2) D:$D(^XTMP("XPDI",XPDA,"KRN"))
"RTN","XPDIJ1",78,0)
 .D BMES^XPDUTL(" Installing PACKAGE COMPONENTS: "),KRN^XPDIK,MES^XPDUTL("               "_$$HTE^XLFDT($H))
"RTN","XPDIJ1",79,0)
 E  D BMES^XPDUTL(" PACKAGE COMPONENTS already installed.")
"RTN","XPDIJ1",80,0)
 Q
"RTN","XPDIJ1",81,0)
 ;
"RTN","XPDIJ1",82,0)
POST S XPDCP="INIT"
"RTN","XPDIJ1",83,0)
 ;check if post-install has completed
"RTN","XPDIJ1",84,0)
 I '$$VERCP^XPDUTL("XPD POSTINSTALL COMPLETED") D  Q:$D(XPDABORT)
"RTN","XPDIJ1",85,0)
 .;setup XPDQUES array with post-install questions/answers
"RTN","XPDIJ1",86,0)
 .D QUES^XPDIQ("POS")
"RTN","XPDIJ1",87,0)
 .;loop thru check points starting with INSTALL STARTED
"RTN","XPDIJ1",88,0)
 .S XPDCHECK=1
"RTN","XPDIJ1",89,0)
 .F  S XPDCHECK=$O(^XPD(9.7,XPDA,"INIT",XPDCHECK)) Q:'XPDCHECK  S XPD=^(XPDCHECK,0) D  Q:$D(XPDABORT)
"RTN","XPDIJ1",90,0)
 ..;if there is no call back, quit
"RTN","XPDIJ1",91,0)
 ..Q:$G(^XPD(9.7,XPDA,"INIT",XPDCHECK,1))=""  S XPDRTN=^(1)
"RTN","XPDIJ1",92,0)
 ..;quit if checkpoint has completed time
"RTN","XPDIJ1",93,0)
 ..Q:$P(XPD,U,2)
"RTN","XPDIJ1",94,0)
 ..I XPDCHECK=2 D BMES^XPDUTL(" Running Post-Install Routine: "_XPDRTN)
"RTN","XPDIJ1",95,0)
 ..;zero the progress bar
"RTN","XPDIJ1",96,0)
 ..I $D(XPDIDVT) S XPDIDTOT=0 D UPDATE^XPDID(0)
"RTN","XPDIJ1",97,0)
 ..D @XPDRTN
"RTN","XPDIJ1",98,0)
 ..;write message and abort if developer wants
"RTN","XPDIJ1",99,0)
 ..I $D(XPDABORT) D BMES^XPDUTL("Install ** ABORTED ** in Post-Install program") Q
"RTN","XPDIJ1",100,0)
 ..S %=$$COMCP^XPDUTL(XPDCHECK)
"RTN","XPDIJ1",101,0)
 .Q:$D(XPDABORT)
"RTN","XPDIJ1",102,0)
 .;complete post-init check point
"RTN","XPDIJ1",103,0)
 .S %=$$COMCP^XPDUTL("XPD POSTINSTALL COMPLETED")
"RTN","XPDIJ1",104,0)
 E  D BMES^XPDUTL(" Post-Install already finished.")
"RTN","XPDIJ1",105,0)
 ;move routines to install file & Routine file
"RTN","XPDIJ1",106,0)
 D BMES^XPDUTL(" Updating Routine file..."),SETTOT^XPDID(9.8),RTN^XPDIP
"RTN","XPDIJ1",107,0)
 ;XPDIST is flag for site tracking^A/B install message, it is set in PKG^XPDIP
"RTN","XPDIJ1",108,0)
 ;install Package file, OERR parameter multiple, and Build file
"RTN","XPDIJ1",109,0)
 S XPDIST="" D BMES^XPDUTL(" Updating KIDS files..."),PKG^XPDIP
"RTN","XPDIJ1",110,0)
 D BMES^XPDUTL(" "_XPDNM_" Installed. "),STMP(17)
"RTN","XPDIJ1",111,0)
 ;sends install messages local/forum
"RTN","XPDIJ1",112,0)
 S %=$$EN^XPDIST(XPDA,XPDIST) D BMES^XPDUTL(" "_$P("NO ",U,'$P(%,"#",2))_"Install Message sent "_%)
"RTN","XPDIJ1",113,0)
 Q
"RTN","XPDIJ1",114,0)
CHK(X) ;check checkpoints in file 9.7, X=field #, returns 1=completed, 0=not completed
"RTN","XPDIJ1",115,0)
 Q $$GET1^DIQ(9.7,XPDA_",",X,"I")]""
"RTN","XPDIJ1",116,0)
 ;
"RTN","XPDIJ1",117,0)
STMP(X) ;timestamp checkpoints in file 9.7, X=field #
"RTN","XPDIJ1",118,0)
 N XPD,%
"RTN","XPDIJ1",119,0)
 S %=$$NOW^XLFDT,XPD(9.7,XPDA_",",X)=%
"RTN","XPDIJ1",120,0)
 D MES^XPDUTL("               "_$$FMTE^XLFDT(%)),FILE^DIE("","XPD")
"RTN","XPDIJ1",121,0)
 Q
"RTN","XPDIJ1",122,0)
 ;
"RTN","XPDIJ1",123,0)
INHIBIT(SET) ;Set/Clear the Inhibit logon field.
"RTN","XPDIJ1",124,0)
 N VOL,IEN
"RTN","XPDIJ1",125,0)
 F IEN=0:0 S IEN=$O(^%ZIS(14.5,IEN)) Q:IEN'>0  D
"RTN","XPDIJ1",126,0)
 . I $P(^%ZIS(14.5,IEN,0),U,11)=1 S VOL(14.5,IEN_",",1)=SET
"RTN","XPDIJ1",127,0)
 . Q
"RTN","XPDIJ1",128,0)
 D FILE^DIE("","VOL")
"RTN","XPDIJ1",129,0)
 Q
"VER")
8.0^22.0
**END**
**END**
