Released OR*3*175 SEQ #164
Extracted from mail message
**KIDS**:OR*3.0*175^

**INSTALL NAME**
OR*3.0*175
"BLD",4352,0)
OR*3.0*175^ORDER ENTRY/RESULTS REPORTING^0^3030212^y
"BLD",4352,1,0)
^^1^1^3021212^^^^
"BLD",4352,1,1,0)
Refer to the patch description on the patch message.
"BLD",4352,4,0)
^9.64PA^^0
"BLD",4352,"ABNS",0)
^9.66A^^
"BLD",4352,"ABPKG")
n^y^G.LABTEST@ISC-SLC.VA.GOV
"BLD",4352,"INI")

"BLD",4352,"INIT")

"BLD",4352,"KRN",0)
^9.67PA^8989.52^20
"BLD",4352,"KRN",.4,0)
.4
"BLD",4352,"KRN",.401,0)
.401
"BLD",4352,"KRN",.402,0)
.402
"BLD",4352,"KRN",.403,0)
.403
"BLD",4352,"KRN",.5,0)
.5
"BLD",4352,"KRN",.84,0)
.84
"BLD",4352,"KRN",3.6,0)
3.6
"BLD",4352,"KRN",3.8,0)
3.8
"BLD",4352,"KRN",9.2,0)
9.2
"BLD",4352,"KRN",9.8,0)
9.8
"BLD",4352,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4352,"KRN",9.8,"NM",1,0)
ORCDLR^^0^B52064255
"BLD",4352,"KRN",9.8,"NM","B","ORCDLR",1)

"BLD",4352,"KRN",19,0)
19
"BLD",4352,"KRN",19,"NM",0)
^9.68A^^
"BLD",4352,"KRN",19.1,0)
19.1
"BLD",4352,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4352,"KRN",101,0)
101
"BLD",4352,"KRN",101,"NM",0)
^9.68A^^0
"BLD",4352,"KRN",409.61,0)
409.61
"BLD",4352,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",4352,"KRN",771,0)
771
"BLD",4352,"KRN",869.2,0)
869.2
"BLD",4352,"KRN",870,0)
870
"BLD",4352,"KRN",8989.51,0)
8989.51
"BLD",4352,"KRN",8989.52,0)
8989.52
"BLD",4352,"KRN",8994,0)
8994
"BLD",4352,"KRN","B",.4,.4)

"BLD",4352,"KRN","B",.401,.401)

"BLD",4352,"KRN","B",.402,.402)

"BLD",4352,"KRN","B",.403,.403)

"BLD",4352,"KRN","B",.5,.5)

"BLD",4352,"KRN","B",.84,.84)

"BLD",4352,"KRN","B",3.6,3.6)

"BLD",4352,"KRN","B",3.8,3.8)

"BLD",4352,"KRN","B",9.2,9.2)

"BLD",4352,"KRN","B",9.8,9.8)

"BLD",4352,"KRN","B",19,19)

"BLD",4352,"KRN","B",19.1,19.1)

"BLD",4352,"KRN","B",101,101)

"BLD",4352,"KRN","B",409.61,409.61)

"BLD",4352,"KRN","B",771,771)

"BLD",4352,"KRN","B",869.2,869.2)

"BLD",4352,"KRN","B",870,870)

"BLD",4352,"KRN","B",8989.51,8989.51)

"BLD",4352,"KRN","B",8989.52,8989.52)

"BLD",4352,"KRN","B",8994,8994)

"BLD",4352,"QUES",0)
^9.62^^
"BLD",4352,"REQB",0)
^9.611^1^1
"BLD",4352,"REQB",1,0)
OR*3.0*79^2
"BLD",4352,"REQB","B","OR*3.0*79",1)

"MBREQ")
0
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
175^3030212
"PKG",110,22,1,"PAH",1,1,0)
^^1^1^3030212
"PKG",110,22,1,"PAH",1,1,1,0)
Refer to the patch description on the patch message.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ORCDLR")
0^1^B52064255
"RTN","ORCDLR",1,0)
ORCDLR ;SLC/MKB-Utility functions for LR dialogs ;6/11/97  11:47
"RTN","ORCDLR",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**4,29,49,61,71,79,175**;Dec 17, 1997
"RTN","ORCDLR",3,0)
TEST ; -- Setup ORTEST() array of ordering parameters
"RTN","ORCDLR",4,0)
 N OI,TST,WRD,I,DG
"RTN","ORCDLR",5,0)
 S OI=+$G(ORDIALOG(PROMPT,INST)) Q:'OI
"RTN","ORCDLR",6,0)
 I '$D(ORTEST) S TST=+$P($G(^ORD(101.43,OI,0)),U,2) D TEST^LR7OR3(TST,.ORTEST) S ORTEST=TST
"RTN","ORCDLR",7,0)
 S WRD="GenWardInstructions" I $O(ORTEST(WRD,0)) D  W !
"RTN","ORCDLR",8,0)
 . W ! S I=0 F  S I=$O(ORTEST(WRD,I)) Q:I'>0  W !,ORTEST(WRD,I,0)
"RTN","ORCDLR",9,0)
 S DG=$P($G(^ORD(101.43,+OI,"LR")),U,6) S:'$L(DG) DG="LAB"
"RTN","ORCDLR",10,0)
 S DG=$O(^ORD(100.98,"B",DG,0)) S:DG ORDG=DG
"RTN","ORCDLR",11,0)
 Q
"RTN","ORCDLR",12,0)
 ;
"RTN","ORCDLR",13,0)
CKTYP ; -- ck type of test [Exit Action]
"RTN","ORCDLR",14,0)
 N X,Y S X=$G(ORDIALOG(PROMPT,INST)) Q:'X
"RTN","ORCDLR",15,0)
 S Y=$P($G(^ORD(101.43,+X,"LR")),U,7)
"RTN","ORCDLR",16,0)
 I (Y="O")!(Y="N") W $C(7),!,"This test may not be ordered anymore.  Please select another test." S ORQUIT=1 D WAIT Q
"RTN","ORCDLR",17,0)
 Q
"RTN","ORCDLR",18,0)
 ;
"RTN","ORCDLR",19,0)
WAIT ; -- Wait for user
"RTN","ORCDLR",20,0)
 N X W !,"Press <return> to continue ..." R X:DTIME
"RTN","ORCDLR",21,0)
 Q
"RTN","ORCDLR",22,0)
 ;
"RTN","ORCDLR",23,0)
SHOWMAX ; -- Setup max days allowed for cont orders
"RTN","ORCDLR",24,0)
 I $S('$G(ORSCH):1,"CD"'[$P($G(^PS(51.1,+ORSCH,0)),U,5):1,1:0) K ORDIALOG(PROMPT,INST) Q  ;just in case
"RTN","ORCDLR",25,0)
 N Y,OK S ORSMAX=$P($G(^PS(51.1,ORSCH,0)),U,7),ORSTMS=$P($G(^(0)),U,3)
"RTN","ORCDLR",26,0)
 S ORSMAX=$S('$G(ORSMAX):ORMAX,$G(ORTYPE)="Z":ORSMAX,ORMAX<ORSMAX:ORMAX,1:ORSMAX),ORSTMS=$S(ORSMAX&ORSTMS:ORSMAX*1440\ORSTMS,1:"") ;set max days, times
"RTN","ORCDLR",27,0)
 I FIRST,$G(ORTYPE)="Q" S Y=$G(ORDIALOG(PROMPT,INST)) I $L(Y) S OK=$$CKMAX(Y) Q:OK  K ORDIALOG(PROMPT,INST) ;Q if valid, else fall thru and prompt
"RTN","ORCDLR",28,0)
 W !!,"Maximum number of days for continuous orders is "_ORSMAX_"; enter a duration",!,"as either a number of days (3) or Xnumber of times (X3).",!
"RTN","ORCDLR",29,0)
 Q
"RTN","ORCDLR",30,0)
 ;
"RTN","ORCDLR",31,0)
CKMAX(X) ; -- Ck duration X against max allowed
"RTN","ORCDLR",32,0)
 N Y S Y=1
"RTN","ORCDLR",33,0)
 I +X=X S Y=$S(X<0:"0^Cannot order in the past.",'ORSMAX:1,X'>ORSMAX:1,1:"0^Cannot order more than "_ORSMAX_" days in advance.") G CKQ
"RTN","ORCDLR",34,0)
 I (X'?1"X"1.N),(X'?1"x"1.N) S Y="0^Enter either a number of days or X_number of times." G CKQ
"RTN","ORCDLR",35,0)
 I ORSTMS,+$E(X,2,9)>ORSTMS S Y="0^Cannot order more than "_ORSTMS_" time* s." G CKQ
"RTN","ORCDLR",36,0)
 I 'ORSTMS,+$E(X,2,9)>ORSMAX S Y="0^Cannot order for more than "_ORSMAX_" days." G CKQ ; day of week schedule
"RTN","ORCDLR",37,0)
 S Y=1
"RTN","ORCDLR",38,0)
CKQ Q Y
"RTN","ORCDLR",39,0)
 ;
"RTN","ORCDLR",40,0)
SAMPLE() ; -- Get default sample from Test for INST
"RTN","ORCDLR",41,0)
 N X,Y I $L($G(LRFSAMP)) Q LRFSAMP
"RTN","ORCDLR",42,0)
 I (ORCOLLCT="LC")!(ORCOLLCT="I") S X=$G(ORTEST("Lab CollSamp")) G SAMPQ
"RTN","ORCDLR",43,0)
 S X=$G(ORTEST("Unique CollSamp")) G:X SAMPQ
"RTN","ORCDLR",44,0)
 S X=$G(ORTEST("Default CollSamp"))
"RTN","ORCDLR",45,0)
SAMPQ S Y=+$G(ORTEST("CollSamp",+X))
"RTN","ORCDLR",46,0)
 Q Y
"RTN","ORCDLR",47,0)
 ;
"RTN","ORCDLR",48,0)
ENSAMP ; -- Get list of samples to pick from
"RTN","ORCDLR",49,0)
 Q:$G(ORDIALOG(PROMPT,"LIST"))  N I,CNT,X,Y S (I,CNT)=0
"RTN","ORCDLR",50,0)
 F  S I=$O(ORTEST("CollSamp",I)) Q:I'>0  S X=$G(ORTEST("CollSamp",I)) D
"RTN","ORCDLR",51,0)
 . S Y=$P(X,U,1,2)_"   "_$$GET1^DIQ(61,+$P(X,U,3)_",",.01)_"  "_$P(X,U,4)
"RTN","ORCDLR",52,0)
 . S CNT=CNT+1,ORDIALOG(PROMPT,"LIST",CNT)=Y
"RTN","ORCDLR",53,0)
 . S ORDIALOG(PROMPT,"LIST","B",$P(X,U,2))=+X
"RTN","ORCDLR",54,0)
 S:CNT ORDIALOG(PROMPT,"LIST")=CNT_$S($$SECTION'="MI":"^1",1:"")
"RTN","ORCDLR",55,0)
 Q
"RTN","ORCDLR",56,0)
 ;
"RTN","ORCDLR",57,0)
ASKSAMP() ; -- Ask for Collection Sample?
"RTN","ORCDLR",58,0)
 N X,Y,DIR,DEFSAMP,SAMP0
"RTN","ORCDLR",59,0)
 S DEFSAMP=$G(ORDIALOG(PROMPT,INST)),SAMP0=$G(^LAB(62,+DEFSAMP,0))
"RTN","ORCDLR",60,0)
 I $G(ORTYPE)="Z",DEFSAMP Q 1
"RTN","ORCDLR",61,0)
 I (ORCOLLCT="LC")!(ORCOLLCT="I"),$G(ORTEST("Lab CollSamp")) W !!,"Lab will collect "_$P(SAMP0,U)_" "_$P(SAMP0,U,3)_".",! Q 0
"RTN","ORCDLR",62,0)
 I $G(ORTEST("Unique CollSamp")),DEFSAMP Q 0 ; unique -> don't ask
"RTN","ORCDLR",63,0)
 I 'DEFSAMP!('FIRST) Q 1 ; no default or edit -> ask
"RTN","ORCDLR",64,0)
 I $G(ORDIALOG(PROMPT,"LIST"))="1^1" Q 0 ; only one choice
"RTN","ORCDLR",65,0)
 S DIR(0)="YA",DIR("A")="Is "_$P(SAMP0,U)_" "_$P(SAMP0,U,3)_" the correct sample to collect? ",DIR("B")="Yes"
"RTN","ORCDLR",66,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT) S ORQUIT=1 Q 0
"RTN","ORCDLR",67,0)
 D:'Y LIST^ORCD
"RTN","ORCDLR",68,0)
 Q 'Y
"RTN","ORCDLR",69,0)
 ;
"RTN","ORCDLR",70,0)
SECTION() ; -- Returns Lab section of Orderable Item
"RTN","ORCDLR",71,0)
 N PTR,X
"RTN","ORCDLR",72,0)
 S PTR=$O(^ORD(101.41,"AB","OR GTX ORDERABLE ITEM",0))
"RTN","ORCDLR",73,0)
 S X=$P($G(^ORD(101.43,+$G(ORDIALOG(PTR,1)),"LR")),U,6)
"RTN","ORCDLR",74,0)
 Q X
"RTN","ORCDLR",75,0)
 ;
"RTN","ORCDLR",76,0)
SHOWCOMM(SAMP) ; -- Show comments for sample
"RTN","ORCDLR",77,0)
 Q:'$G(SAMP)  Q:'$G(ORTEST)  N ORCOMM,I
"RTN","ORCDLR",78,0)
 D SCOM^LR7OR3(+ORTEST,SAMP,.ORCOMM)
"RTN","ORCDLR",79,0)
 S I=0 F  S I=$O(ORCOMM(I)) Q:I'>0  W !,ORCOMM(I,0)
"RTN","ORCDLR",80,0)
 Q
"RTN","ORCDLR",81,0)
 ;
"RTN","ORCDLR",82,0)
SPECIMEN() ; -- Get default specimen from Sample for INST
"RTN","ORCDLR",83,0)
 N X,Y I $L($G(LRFSPEC)) S Y=LRFSPEC
"RTN","ORCDLR",84,0)
 E  S X=$$VAL^ORCD("COLLECTION SAMPLE"),Y=+$P($G(^LAB(62,+X,0)),U,2)
"RTN","ORCDLR",85,0)
 Q Y
"RTN","ORCDLR",86,0)
 ;
"RTN","ORCDLR",87,0)
SPECHELP ; -- Xecutable help for Specimen prompt
"RTN","ORCDLR",88,0)
 I '$D(^LAB(61,"E")) D P^ORCDLGH Q
"RTN","ORCDLR",89,0)
 W !,"Choose from: "
"RTN","ORCDLR",90,0)
 N SP,I,DONE,CNT S (CNT,DONE)=0,SP=""
"RTN","ORCDLR",91,0)
 F  S SP=$O(^LAB(61,"E",SP)) Q:SP=""  S I=+$O(^(SP,0)) I I D
"RTN","ORCDLR",92,0)
 . S CNT=CNT+1 I CNT>(IOSL-2) S CNT=0 I '$$MORE^ORCD S DONE=1 Q
"RTN","ORCDLR",93,0)
 . W !,"     "_$P($G(^LAB(61,I,0)),U)
"RTN","ORCDLR",94,0)
 Q
"RTN","ORCDLR",95,0)
 ;
"RTN","ORCDLR",96,0)
URGENCY ; -- Get list of urgencies to pick from
"RTN","ORCDLR",97,0)
 Q:$D(ORDIALOG(PROMPT,"LIST"))  N I,J,X
"RTN","ORCDLR",98,0)
 I $G(ORTEST("Default Urgency")) S ORDIALOG(PROMPT,"LIST")="1^1",ORDIALOG(PROMPT,"LIST",1)=ORTEST("Default Urgency") Q  ; Forced Urgency
"RTN","ORCDLR",99,0)
 I '$D(ORTEST("Urgencies")) S ORDIALOG(PROMPT,"LIST")="0^1" Q
"RTN","ORCDLR",100,0)
 S (I,J)=0 F  S I=$O(ORTEST("Urgencies",I)) Q:I'>0  D
"RTN","ORCDLR",101,0)
 . S X=ORTEST("Urgencies",I) I $G(ORCOLLCT)="LC",'$P($G(^LAB(62.05,+X,0)),U,2) Q  ; Lab cannot collect
"RTN","ORCDLR",102,0)
 . S J=J+1,ORDIALOG(PROMPT,"LIST",J)=X,ORDIALOG(PROMPT,"LIST","B",$P(X,U,2))=+X
"RTN","ORCDLR",103,0)
 S ORDIALOG(PROMPT,"LIST")=J_"^1"
"RTN","ORCDLR",104,0)
 Q
"RTN","ORCDLR",105,0)
 ;
"RTN","ORCDLR",106,0)
ASKURG() ; -- Ask urgency prompt?
"RTN","ORCDLR",107,0)
 I $G(ORTEST("Default Urgency")) Q 0 ; Forced Urgency
"RTN","ORCDLR",108,0)
 I FIRST,$G(ORL) Q $$GET^XPAR("ALL^"_ORL,"LR ASK URGENCY")
"RTN","ORCDLR",109,0)
 Q (+$G(ORDIALOG(PROMPT,"LIST"))>1)
"RTN","ORCDLR",110,0)
 ;
"RTN","ORCDLR",111,0)
REQDCOMM() ; -- Process required comments
"RTN","ORCDLR",112,0)
 I $O(^TMP("ORWORD",$J,PROMPT,INST,0)) Q 0 ;edit as WP
"RTN","ORCDLR",113,0)
 N LRTEST,LRSAMP,LRSPEC,LRTSTN,LRTCOM,LRCCOM,DA,CNT,I,REQDCOMM
"RTN","ORCDLR",114,0)
 S LRSAMP=$$VAL^ORCD("COLLECTION SAMPLE"),LRSPEC=$$VAL^ORCD("SPECIMEN")
"RTN","ORCDLR",115,0)
 S LRTSTN=1,LRTEST(1)=+ORTEST,DA=$O(^LAB(60,LRTEST(1),3,"B",+LRSAMP,0))
"RTN","ORCDLR",116,0)
 S REQDCOMM=$P($G(^LAB(60,LRTEST(1),3,+DA,0)),U,6)
"RTN","ORCDLR",117,0)
 S:'REQDCOMM REQDCOMM=+$P($G(^LAB(60,LRTEST(1),0)),U,19) Q:'REQDCOMM 1
"RTN","ORCDLR",118,0)
 I $G(ORTYPE)="Z",$P($G(^LAB(62.07,+REQDCOMM,0)),U)'="ORDER COMMENT" Q 1
"RTN","ORCDLR",119,0)
 X:$D(^LAB(62.07,REQDCOMM,.1)) ^(.1)
"RTN","ORCDLR",120,0)
 S (CNT,I)=0 K REQDCOMM
"RTN","ORCDLR",121,0)
 F  S I=$O(LRTCOM(LRTEST(1),I)) Q:I'>0  S CNT=CNT+1,REQDCOMM(CNT,0)=LRTCOM(LRTEST(1),I)
"RTN","ORCDLR",122,0)
 S:$L($G(LRCCOM)) CNT=CNT+1,REQDCOMM(CNT,0)=LRCCOM
"RTN","ORCDLR",123,0)
 I CNT S REQDCOMM(0)="^^"_CNT_U_CNT_U_DT_U_U,ORDIALOG(PROMPT,INST)="^TMP(""ORWORD"",$J,"_PROMPT_","_INST_")" M ^TMP("ORWORD",$J,PROMPT,INST)=REQDCOMM
"RTN","ORCDLR",124,0)
RQ Q 1
"RTN","ORCDLR",125,0)
 ;
"RTN","ORCDLR",126,0)
XHELP(PTR) ; -- Xecutable help
"RTN","ORCDLR",127,0)
 I $D(ORDIALOG(PTR,"LIST")),X="?"!$P(ORDIALOG(PTR,"LIST"),U,2) D LIST^ORCD Q
"RTN","ORCDLR",128,0)
 D P^ORCDLGH ; ??-help
"RTN","ORCDLR",129,0)
 Q
"RTN","ORCDLR",130,0)
 ;
"RTN","ORCDLR",131,0)
CHANGED(FLD) ; -- Kill dependent values when FLD changes
"RTN","ORCDLR",132,0)
 N PROMPTS,P,NAME,PTR K ORCOLLCT
"RTN","ORCDLR",133,0)
 S PROMPTS="COLLECTION SAMPLE^SPECIMEN^WORD PROCESSING 1^START DATE/TIME"
"RTN","ORCDLR",134,0)
 S:FLD="OI" PROMPTS="COLLECTION TYPE^"_PROMPTS_"^LAB URGENCY"
"RTN","ORCDLR",135,0)
 F P=1:1:$L(PROMPTS,U) S NAME=$P(PROMPTS,U,P),PTR=$O(^ORD(101.41,"AB","OR GTX "_NAME,0)) I PTR K ORDIALOG(PTR,ORI),ORDIALOG(PTR,"LIST")
"RTN","ORCDLR",136,0)
 Q
"RTN","ORCDLR",137,0)
 ;
"RTN","ORCDLR",138,0)
LB(ORDER) ; -- Returns 1 or 0, if "LB #" is already in text
"RTN","ORCDLR",139,0)
 N I,Y S I=0,Y=0
"RTN","ORCDLR",140,0)
 F  S I=$O(^OR(100,+ORDER,1,I)) Q:I'>0  I $G(^(I,0))["LB #" S Y=1 Q
"RTN","ORCDLR",141,0)
 Q Y
"RTN","ORCDLR",142,0)
 ;
"RTN","ORCDLR",143,0)
DATE(X) ; Free text input to FM time
"RTN","ORCDLR",144,0)
 N %DT,Y
"RTN","ORCDLR",145,0)
 D ^%DT
"RTN","ORCDLR",146,0)
 Q Y
"RTN","ORCDLR",147,0)
 ;
"RTN","ORCDLR",148,0)
XSCH ; -- xecutable help for schedule prompt
"RTN","ORCDLR",149,0)
 N X,IFN,CNT,Z,DONE
"RTN","ORCDLR",150,0)
 W !!,"Choose from:" S CNT=1
"RTN","ORCDLR",151,0)
 S X="" F  S X=$O(^PS(51.1,"APLR",X)) Q:X=""  S IFN=0 D  Q:$G(DONE)
"RTN","ORCDLR",152,0)
 . F  S IFN=$O(^PS(51.1,"APLR",X,IFN)) Q:IFN'>0  D  Q:$G(DONE)
"RTN","ORCDLR",153,0)
 .. W !,"   "_X S CNT=CNT+1 Q:CNT'>(IOSL-5)  S CNT=0
"RTN","ORCDLR",154,0)
 .. W !,"   '^' TO STOP: " R Z:DTIME S:'$T!(Z["^") DONE=1
"RTN","ORCDLR",155,0)
 W !
"RTN","ORCDLR",156,0)
 Q
"RTN","ORCDLR",157,0)
 ;
"RTN","ORCDLR",158,0)
MULT(ORIFN,CTYPE,CDATE) ;check multiple orders from VALID^ORCDLR1
"RTN","ORCDLR",159,0)
 N KID,OREVENT,ORSTRT,OK,X,Y,%DT
"RTN","ORCDLR",160,0)
 I '$D(CTYPE) S CTYPE=$$VALUE^ORCSAVE2(ORIFN,"COLLECT")
"RTN","ORCDLR",161,0)
 Q:"SPWC"[CTYPE 0  ; only check LC and I
"RTN","ORCDLR",162,0)
 I '$D(CDATE) S CDATE=$$VALUE^ORCSAVE2(ORIFN,"START")
"RTN","ORCDLR",163,0)
 D AM^ORCSAVE2:CDATE="AM",NEXT^ORCSAVE2:CDATE="NEXT" ; returns X
"RTN","ORCDLR",164,0)
 S %DT="T" S:'$D(X) X=CDATE  D ^%DT I Y<1 Q 0
"RTN","ORCDLR",165,0)
 D SCHEDULE^ORCSEND1(ORIFN,"LR",.ORSTRT,Y) Q:ORSTRT'>1 0 ; get all starts
"RTN","ORCDLR",166,0)
 S KID=0,OK=1 F  S KID=$O(ORSTRT(KID)) Q:'KID!('OK)  D
"RTN","ORCDLR",167,0)
 . I CTYPE="LC" S OK=$$LABCOLL^ORCDLR1(KID) Q
"RTN","ORCDLR",168,0)
 . S OK=$$IMMCOLL^ORCDLR1(KID)
"RTN","ORCDLR",169,0)
 I OK Q 0
"RTN","ORCDLR",170,0)
 Q "1^One or more of the multiple orders will be changed to Ward Collect"
"VER")
8.0^22.0
**END**
**END**
