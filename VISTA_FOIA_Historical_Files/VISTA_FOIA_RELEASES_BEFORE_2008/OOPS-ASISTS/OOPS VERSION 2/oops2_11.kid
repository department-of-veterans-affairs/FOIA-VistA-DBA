KIDS Distribution saved on Sep 21, 2005@14:47:57
ASSIST Production Release created 9/21/05
**KIDS**:OOPS*2.0*11^

**INSTALL NAME**
OOPS*2.0*11
"BLD",6269,0)
OOPS*2.0*11^ASISTS^0^3050921^y
"BLD",6269,1,0)
^9.61A^7^7^3050808^^
"BLD",6269,1,1,0)
The purpose of this patch is to provide minor enhancements to the Occupational Safety and Health
"BLD",6269,1,2,0)
 Administration (OSHA) 300 Log which was
"BLD",6269,1,3,0)
 implemented in OOPS*2.0*7. This patch
"BLD",6269,1,4,0)
 will also address other miscellaneous
"BLD",6269,1,5,0)
 minor enhancements, reported and
"BLD",6269,1,6,0)
 unreported bug fixes.
"BLD",6269,1,7,0)

"BLD",6269,4,0)
^9.64PA^2261.4^3
"BLD",6269,4,2260,0)
2260
"BLD",6269,4,2260,2,0)
^9.641^2260^1
"BLD",6269,4,2260,2,2260,0)
ASISTS ACCIDENT REPORTING  (File-top level)
"BLD",6269,4,2260,2,2260,1,0)
^9.6411^353^7
"BLD",6269,4,2260,2,2260,1,347,0)
REASON FOR DISPUTE CODE
"BLD",6269,4,2260,2,2260,1,348,0)
LOCATION DETAIL
"BLD",6269,4,2260,2,2260,1,349,0)
LOSS OF CONSCIOUSNESS
"BLD",6269,4,2260,2,2260,1,350,0)
PRESCRIPTION STRGTH MEDS GIVEN
"BLD",6269,4,2260,2,2260,1,351,0)
NON-SCRIPT MEDS AT SCRIPT DOSE
"BLD",6269,4,2260,2,2260,1,352,0)
INITIAL RETURN TO WORK STATUS
"BLD",6269,4,2260,2,2260,1,353,0)
DUAL REFUSED
"BLD",6269,4,2260,222)
y^n^p^^^^n^^n
"BLD",6269,4,2260,224)

"BLD",6269,4,2261.4,0)
2261.4
"BLD",6269,4,2261.4,222)
y^n^f^^^^n^^n
"BLD",6269,4,2261.4,224)

"BLD",6269,4,2262.8,0)
2262.8
"BLD",6269,4,2262.8,222)
y^n^f^^n^^y^o^n
"BLD",6269,4,"APDD",2260,2260)

"BLD",6269,4,"APDD",2260,2260,347)

"BLD",6269,4,"APDD",2260,2260,348)

"BLD",6269,4,"APDD",2260,2260,349)

"BLD",6269,4,"APDD",2260,2260,350)

"BLD",6269,4,"APDD",2260,2260,351)

"BLD",6269,4,"APDD",2260,2260,352)

"BLD",6269,4,"APDD",2260,2260,353)

"BLD",6269,4,"B",2260,2260)

"BLD",6269,4,"B",2261.4,2261.4)

"BLD",6269,4,"B",2262.8,2262.8)

"BLD",6269,"ABPKG")
n
"BLD",6269,"KRN",0)
^9.67PA^8989.52^19
"BLD",6269,"KRN",.4,0)
.4
"BLD",6269,"KRN",.401,0)
.401
"BLD",6269,"KRN",.402,0)
.402
"BLD",6269,"KRN",.403,0)
.403
"BLD",6269,"KRN",.5,0)
.5
"BLD",6269,"KRN",.84,0)
.84
"BLD",6269,"KRN",3.6,0)
3.6
"BLD",6269,"KRN",3.6,"NM",0)
^9.68A^1^1
"BLD",6269,"KRN",3.6,"NM",1,0)
OOPS EMPSIGNCA7^^0
"BLD",6269,"KRN",3.6,"NM","B","OOPS EMPSIGNCA7",1)

"BLD",6269,"KRN",3.8,0)
3.8
"BLD",6269,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",6269,"KRN",9.2,0)
9.2
"BLD",6269,"KRN",9.8,0)
9.8
"BLD",6269,"KRN",9.8,"NM",0)
^9.68A^17^10
"BLD",6269,"KRN",9.8,"NM",3,0)
OOPSGUI8^^0^B46205454
"BLD",6269,"KRN",9.8,"NM",5,0)
OOPSGUI4^^0^B55460170
"BLD",6269,"KRN",9.8,"NM",6,0)
OOPSGUI5^^0^B70896751
"BLD",6269,"KRN",9.8,"NM",9,0)
OOPSGUI1^^0^B34207574
"BLD",6269,"KRN",9.8,"NM",11,0)
OOPSGUIF^^0^B31912751
"BLD",6269,"KRN",9.8,"NM",12,0)
OOPSGUIT^^0^B78632335
"BLD",6269,"KRN",9.8,"NM",14,0)
OOPSGUIR^^0^B67650815
"BLD",6269,"KRN",9.8,"NM",15,0)
OOPSGUIS^^0^B29381071
"BLD",6269,"KRN",9.8,"NM",16,0)
OOPSDOLX^^0^B20702638
"BLD",6269,"KRN",9.8,"NM",17,0)
OOPSGUIU^^0^B4223753
"BLD",6269,"KRN",9.8,"NM","B","OOPSDOLX",16)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUI1",9)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUI4",5)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUI5",6)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUI8",3)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUIF",11)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUIR",14)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUIS",15)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUIT",12)

"BLD",6269,"KRN",9.8,"NM","B","OOPSGUIU",17)

"BLD",6269,"KRN",19,0)
19
"BLD",6269,"KRN",19,"NM",0)
^9.68A^17^1
"BLD",6269,"KRN",19,"NM",17,0)
OOPS GUI EMPLOYEE^^0
"BLD",6269,"KRN",19,"NM","B","OOPS GUI EMPLOYEE",17)

"BLD",6269,"KRN",19.1,0)
19.1
"BLD",6269,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",6269,"KRN",101,0)
101
"BLD",6269,"KRN",409.61,0)
409.61
"BLD",6269,"KRN",771,0)
771
"BLD",6269,"KRN",870,0)
870
"BLD",6269,"KRN",8989.51,0)
8989.51
"BLD",6269,"KRN",8989.52,0)
8989.52
"BLD",6269,"KRN",8994,0)
8994
"BLD",6269,"KRN",8994,"NM",0)
^9.68A^2^2
"BLD",6269,"KRN",8994,"NM",1,0)
OOPS GET DETAIL LOCATION^^0
"BLD",6269,"KRN",8994,"NM",2,0)
OOPS SET DETAIL LOCATION^^0
"BLD",6269,"KRN",8994,"NM","B","OOPS GET DETAIL LOCATION",1)

"BLD",6269,"KRN",8994,"NM","B","OOPS SET DETAIL LOCATION",2)

"BLD",6269,"KRN","B",.4,.4)

"BLD",6269,"KRN","B",.401,.401)

"BLD",6269,"KRN","B",.402,.402)

"BLD",6269,"KRN","B",.403,.403)

"BLD",6269,"KRN","B",.5,.5)

"BLD",6269,"KRN","B",.84,.84)

"BLD",6269,"KRN","B",3.6,3.6)

"BLD",6269,"KRN","B",3.8,3.8)

"BLD",6269,"KRN","B",9.2,9.2)

"BLD",6269,"KRN","B",9.8,9.8)

"BLD",6269,"KRN","B",19,19)

"BLD",6269,"KRN","B",19.1,19.1)

"BLD",6269,"KRN","B",101,101)

"BLD",6269,"KRN","B",409.61,409.61)

"BLD",6269,"KRN","B",771,771)

"BLD",6269,"KRN","B",870,870)

"BLD",6269,"KRN","B",8989.51,8989.51)

"BLD",6269,"KRN","B",8989.52,8989.52)

"BLD",6269,"KRN","B",8994,8994)

"BLD",6269,"QUES",0)
^9.62^^
"BLD",6269,"REQB",0)
^9.611^1^1
"BLD",6269,"REQB",1,0)
OOPS*2.0*7^2
"BLD",6269,"REQB","B","OOPS*2.0*7",1)

"DATA",2262.8,1,0)
Injury was not work related^1
"DATA",2262.8,2,0)
Different stories about what happened^2
"DATA",2262.8,3,0)
No medical evidence to support work related injury^3
"DATA",2262.8,4,0)
Employee did not follow facility policies/procedures^4
"DATA",2262.8,5,0)
Investigation of incident does not support employee's statement^5
"DATA",2262.8,6,0)
Different medical opinions about injury; weight of evidence^6
"DATA",2262.8,7,0)
Inappropriate medical provider^7
"DATA",2262.8,8,0)
Medical diagnosis/treatment not related to claimed condition^8
"DATA",2262.8,9,0)
A personal, emotional, reaction to administrative activities^9
"DATA",2262.8,10,0)
Timeliness of reporting incident^10
"FIA",2260)
ASISTS ACCIDENT REPORTING
"FIA",2260,0)
^OOPS(2260,
"FIA",2260,0,0)
2260I
"FIA",2260,0,1)
y^n^p^^^^n^^n
"FIA",2260,0,10)

"FIA",2260,0,11)

"FIA",2260,0,"RLRO")

"FIA",2260,0,"VR")
2.0^OOPS
"FIA",2260,2260)
1
"FIA",2260,2260,347)

"FIA",2260,2260,348)

"FIA",2260,2260,349)

"FIA",2260,2260,350)

"FIA",2260,2260,351)

"FIA",2260,2260,352)

"FIA",2260,2260,353)

"FIA",2261.4)
ASISTS SETTING OF INJURY
"FIA",2261.4,0)
^OOPS(2261.4,
"FIA",2261.4,0,0)
2261.4
"FIA",2261.4,0,1)
y^n^f^^^^n^^n
"FIA",2261.4,0,10)

"FIA",2261.4,0,11)

"FIA",2261.4,0,"RLRO")

"FIA",2261.4,0,"VR")
2.0^OOPS
"FIA",2261.4,2261.4)
0
"FIA",2261.4,2261.43)
0
"FIA",2261.4,2261.431)
0
"FIA",2262.8)
ASISTS REASON FOR DISPUTE CODES
"FIA",2262.8,0)
^OOPS(2262.8,
"FIA",2262.8,0,0)
2262.8
"FIA",2262.8,0,1)
y^n^f^^n^^y^o^n
"FIA",2262.8,0,10)

"FIA",2262.8,0,11)

"FIA",2262.8,0,"RLRO")

"FIA",2262.8,0,"VR")
2.0^OOPS
"FIA",2262.8,2262.8)
0
"IX",2261.4,2261.4,"E",0)
2261.4^E^Index on detail location^R^^F^IR^W^2261.43^^^^^LS
"IX",2261.4,2261.4,"E",1)
S ^OOPS(2261.4,"E",$E(X,1,35),DA(1),DA)=""
"IX",2261.4,2261.4,"E",2)
K ^OOPS(2261.4,"E",$E(X,1,35),DA(1),DA)
"IX",2261.4,2261.4,"E",2.5)
K ^OOPS(2261.4,"E")
"IX",2261.4,2261.4,"E",11.1,0)
^.114IA^1^1
"IX",2261.4,2261.4,"E",11.1,1,0)
1^F^2261.43^.01^35^1^F
"IX",2261.4,2261.4,"E",11.1,1,3)

"KRN",3.6,275,-1)
0^1
"KRN",3.6,275,0)
OOPS EMPSIGNCA7^Employee signed CA7
"KRN",3.6,275,1,0)
8^3.61A^8^8^3050411^
"KRN",3.6,275,1,1,0)
A CA7 has been signed by the employee.
"KRN",3.6,275,1,2,0)

"KRN",3.6,275,1,3,0)
Date of Injury/Illness:  |1|
"KRN",3.6,275,1,4,0)
           Case Number:  |2|
"KRN",3.6,275,1,5,0)
 
"KRN",3.6,275,1,6,0)
This is a reminder to the Workers' Compensation Staff that all CA-7s
"KRN",3.6,275,1,7,0)
are to be submitted to the OWCP within 5 calendar days from the date 
"KRN",3.6,275,1,8,0)
the employee signed the form.
"KRN",3.6,275,3,0)
^3.63^2^2^3050411^^^
"KRN",3.6,275,3,1,0)
This bulletin is sent to the WC mail group when the employee has successfully
"KRN",3.6,275,3,2,0)
signed the CA7.
"KRN",3.6,275,4,0)
^3.64A^2^2
"KRN",3.6,275,4,1,0)
1
"KRN",3.6,275,4,1,1,0)
^^1^1^3050331^
"KRN",3.6,275,4,1,1,1,0)
Date of Incident.
"KRN",3.6,275,4,2,0)
2
"KRN",3.6,275,4,2,1,0)
^3.65^1^1^3050411^^
"KRN",3.6,275,4,2,1,1,0)
Case number.
"KRN",19,11205,-1)
0^17
"KRN",19,11205,0)
OOPS GUI EMPLOYEE^ASISTS GUI Employee Menu (Context)^^B^^^^^^^^ASISTS
"KRN",19,11205,1,0)
^19.06^6^6^3050711^^^^
"KRN",19,11205,1,1,0)
This Option is the required menu option for any Employee to be able to 
"KRN",19,11205,1,2,0)
access their menu using ASISTS GUI.
"KRN",19,11205,1,3,0)
 
"KRN",19,11205,1,4,0)
Additionally, this option is used to provide access to the majority of RPC
"KRN",19,11205,1,5,0)
Broker Calls as every user of the ASISTS GUI package should have this menu
"KRN",19,11205,1,6,0)
option assigned to them.
"KRN",19,11205,99.1)
60094,56353
"KRN",19,11205,"RPC",0)
^19.05P^65^65
"KRN",19,11205,"RPC",1,0)
OOPS GET BODY PART
"KRN",19,11205,"RPC",2,0)
OOPS GET POINTED TO
"KRN",19,11205,"RPC",3,0)
OOPS REMOTE GET USER OPTIONS
"KRN",19,11205,"RPC",4,0)
OOPS GET CASE NUMBERS
"KRN",19,11205,"RPC",5,0)
OOPS LOAD OOPS
"KRN",19,11205,"RPC",6,0)
OOPS GET DUPLICATES
"KRN",19,11205,"RPC",7,0)
OOPS NEW PERSON DATA
"KRN",19,11205,"RPC",8,0)
OOPS EMPLOYEE DATA
"KRN",19,11205,"RPC",9,0)
OOPS REPLACE DATE/TIME
"KRN",19,11205,"RPC",10,0)
OOPS GET CKRANGE
"KRN",19,11205,"RPC",11,0)
OOPS GET 2260 DATA
"KRN",19,11205,"RPC",12,0)
OOPS GET WITNESSES
"KRN",19,11205,"RPC",13,0)
OOPS REPLACE WP
"KRN",19,11205,"RPC",14,0)
OOPS DELETE WITNESS
"KRN",19,11205,"RPC",15,0)
OOPS WITNESS CREATE
"KRN",19,11205,"RPC",16,0)
OOPS WITNESS DELETE
"KRN",19,11205,"RPC",17,0)
OOPS WITNESS EDIT
"KRN",19,11205,"RPC",18,0)
OOPS APPROVE SIGN FOR EMPLOYEE
"KRN",19,11205,"RPC",19,0)
OOPS CHANGE CASE STATUS
"KRN",19,11205,"RPC",20,0)
OOPS CREATE AMENDMENT
"KRN",19,11205,"RPC",21,0)
OOPS DELETE SITEP STATION
"KRN",19,11205,"RPC",22,0)
OOPS DELETE SITEPAR STATION
"KRN",19,11205,"RPC",23,0)
OOPS DELETE UNION
"KRN",19,11205,"RPC",24,0)
OOPS EDIT 2260
"KRN",19,11205,"RPC",25,0)
OOPS EDIT SITE PARAMETER
"KRN",19,11205,"RPC",26,0)
OOPS EDIT SITEPAR STATION
"KRN",19,11205,"RPC",27,0)
OOPS GET DATA
"KRN",19,11205,"RPC",28,0)
OOPS GET DEFAULT MD
"KRN",19,11205,"RPC",29,0)
OOPS GET SITE PARAMETER
"KRN",19,11205,"RPC",30,0)
OOPS GET STATION INFORMATION
"KRN",19,11205,"RPC",31,0)
OOPS GET SUPERVISOR
"KRN",19,11205,"RPC",32,0)
OOPS GET UNION
"KRN",19,11205,"RPC",33,0)
OOPS INCIDENT REPORT
"KRN",19,11205,"RPC",34,0)
OOPS MANUAL XMIT DATA
"KRN",19,11205,"RPC",35,0)
OOPS PUT UNION
"KRN",19,11205,"RPC",36,0)
OOPS REPLACE MULTIPLE
"KRN",19,11205,"RPC",37,0)
OOPS SET FIELD
"KRN",19,11205,"RPC",38,0)
OOPS UNION CONSENT
"KRN",19,11205,"RPC",39,0)
OOPS VALIDATE AND SIGN
"KRN",19,11205,"RPC",40,0)
OOPS VALIDATE TIME
"KRN",19,11205,"RPC",41,0)
OOPS WCEDIT
"KRN",19,11205,"RPC",42,0)
OOPS CLEAR SIGNATURE
"KRN",19,11205,"RPC",43,0)
OOPS GET OSHA DATA
"KRN",19,11205,"RPC",44,0)
OOPS GET PRT ACC STATUS RPT
"KRN",19,11205,"RPC",45,0)
OOPS NEEDLESTICK LOG
"KRN",19,11205,"RPC",46,0)
OOPS GET NOI CODE
"KRN",19,11205,"RPC",47,0)
OOPS GET ASISTS CASE
"KRN",19,11205,"RPC",48,0)
OOPS CHECK PAID EMP DATA
"KRN",19,11205,"RPC",49,0)
OOPS RELEASE RECORD LOCK
"KRN",19,11205,"RPC",50,0)
OOPS SET RECORD LOCK
"KRN",19,11205,"RPC",51,0)
OOPS GET SINGLE FIELD
"KRN",19,11205,"RPC",52,0)
OOPS GET INSTITUTIONS
"KRN",19,11205,"RPC",53,0)
OOPS SENSITIVE DATA
"KRN",19,11205,"RPC",54,0)
OOPS GET MISC REPORT DATA
"KRN",19,11205,"RPC",55,0)
OOPS GET FAC SHORT LIST
"KRN",19,11205,"RPC",56,0)
OOPS SELECT CA7
"KRN",19,11205,"RPC",57,0)
OOPS LIST CAS
"KRN",19,11205,"RPC",58,0)
OOPS MULTIPLE DATA
"KRN",19,11205,"RPC",59,0)
OOPS SET DUAL BENEFITS DATA
"KRN",19,11205,"RPC",60,0)
OOPS SIGN CA7
"KRN",19,11205,"RPC",61,0)
OOPS SIGNATURE VALIDATION
"KRN",19,11205,"RPC",62,0)
OOPS ZIP CODE MISMATCH CHECK
"KRN",19,11205,"RPC",63,0)
OOPS SET OSHA300A
"KRN",19,11205,"RPC",64,0)
OOPS GET DETAIL LOCATION
"KRN",19,11205,"RPC",65,0)
OOPS SET DETAIL LOCATION
"KRN",19,11205,"U")
ASISTS GUI EMPLOYEE MENU (CONT
"KRN",8994,1896,-1)
0^1
"KRN",8994,1896,0)
OOPS GET DETAIL LOCATION^GETDLOC^OOPSGUIS^4^^^^1
"KRN",8994,1896,1,0)
^8994.01^2^2^3050425^^
"KRN",8994,1896,1,1,0)
This broker call returns the entries in the Detail Location sub file in
"KRN",8994,1896,1,2,0)
the ASISTS SETTING OF INJURY File (#2261.4).
"KRN",8994,1896,2,0)
^8994.02A^1^1
"KRN",8994,1896,2,1,0)
INPUT^1^30^1^1
"KRN",8994,1896,2,1,1,0)
^8994.021^2^2^3050425^^
"KRN",8994,1896,2,1,1,1,0)
This parameter consists of the File, Station, and IEN of the data element to be
"KRN",8994,1896,2,1,1,2,0)
returned in the results.
"KRN",8994,1896,2,"B","INPUT",1)

"KRN",8994,1896,2,"PARAMSEQ",1,1)

"KRN",8994,1896,3,0)
^8994.03^3^3^3050425^^
"KRN",8994,1896,3,1,0)
The return value is a listing of all entries in the sub file for the 
"KRN",8994,1896,3,2,0)
station passed in the input parameter.  The return format is:
"KRN",8994,1896,3,3,0)
  Data Name_"^"_Data IEN.
"KRN",8994,1898,-1)
0^2
"KRN",8994,1898,0)
OOPS SET DETAIL LOCATION^SETDLOC^OOPSGUI8^2
"KRN",8994,1898,1,0)
^^2^2^3050527^
"KRN",8994,1898,1,1,0)
This broker call files sub record level data in the Detail Location sub record
"KRN",8994,1898,1,2,0)
in the ASISTS SETTING OF INJURY File (#2261.4).
"KRN",8994,1898,2,0)
^8994.02A^2^2
"KRN",8994,1898,2,1,0)
PARM1^1^30^1^1
"KRN",8994,1898,2,2,0)
DATA^2^40^1^2
"KRN",8994,1898,2,2,1,0)
^^2^2^3050527^
"KRN",8994,1898,2,2,1,1,0)
This parameter contains a list of detail locations for a specific
"KRN",8994,1898,2,2,1,2,0)
location and station (from the Site Parameter file).
"KRN",8994,1898,2,"B","DATA",2)

"KRN",8994,1898,2,"B","PARM1",1)

"KRN",8994,1898,2,"PARAMSEQ",1,1)

"KRN",8994,1898,2,"PARAMSEQ",2,2)

"KRN",8994,1898,3,0)
^^1^1^3050527^
"KRN",8994,1898,3,1,0)
The return parameter will indicate the success of filing the data.
"MBREQ")
0
"ORD",2,3.6)
3.6;2;1;;BUL^XPDTA1;;BULE1^XPDIA1;;;BULDEL^XPDIA1
"ORD",2,3.6,0)
BULLETIN
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",472,-1)
1^1
"PKG",472,0)
ASISTS^OOPS^Automated Safety Incident Surveillance Tracking System
"PKG",472,20,0)
^9.402P^^
"PKG",472,22,0)
^9.49I^1^1
"PKG",472,22,1,0)
2.0^3020709^3030401^66481
"PKG",472,22,1,"PAH",1,0)
11^3050921
"PKG",472,22,1,"PAH",1,1,0)
^^7^7^3050921
"PKG",472,22,1,"PAH",1,1,1,0)
The purpose of this patch is to provide minor enhancements to the Occupational Safety and Health
"PKG",472,22,1,"PAH",1,1,2,0)
 Administration (OSHA) 300 Log which was
"PKG",472,22,1,"PAH",1,1,3,0)
 implemented in OOPS*2.0*7. This patch
"PKG",472,22,1,"PAH",1,1,4,0)
 will also address other miscellaneous
"PKG",472,22,1,"PAH",1,1,5,0)
 minor enhancements, reported and
"PKG",472,22,1,"PAH",1,1,6,0)
 unreported bug fixes.
"PKG",472,22,1,"PAH",1,1,7,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
10
"RTN","OOPSDOLX")
0^16^B20702638
"RTN","OOPSDOLX",1,0)
OOPSDOLX ;WIOFO/CAH-Extract data for DOL XMIT ;3/15/00
"RTN","OOPSDOLX",2,0)
 ;;2.0;ASISTS;**8,11**;Jun 03, 2002
"RTN","OOPSDOLX",3,0)
 ;
"RTN","OOPSDOLX",4,0)
 ; Note:  have changed this routine to strip the spaces out of the 
"RTN","OOPSDOLX",5,0)
 ;        last name.  This is for ASISTS GUI but needs to be implemented
"RTN","OOPSDOLX",6,0)
 ;        for roll and scroll also.
"RTN","OOPSDOLX",7,0)
 ;
"RTN","OOPSDOLX",8,0)
 ;Retrieves data from ^OOPS(2260, for CA1/CA2
"RTN","OOPSDOLX",9,0)
 ;Variables used
"RTN","OOPSDOLX",10,0)
 ;  OOPDA-----IEN of Case
"RTN","OOPSDOLX",11,0)
 ;  OOPSAR----Array holding data
"RTN","OOPSDOLX",12,0)
 ;  OPL-------Last line number written in message text
"RTN","OOPSDOLX",13,0)
 ;  XMZ-------Message Number
"RTN","OOPSDOLX",14,0)
 ; Entry
"RTN","OOPSDOLX",15,0)
 N ARR,KK,FN,FORM,MESS,NAME,OPC,OPSAR,OPT,OPX,SEG,OOPSAR,FYM,MON
"RTN","OOPSDOLX",16,0)
 S RSIZE=0,ARR=0
"RTN","OOPSDOLX",17,0)
 S OOPSAR(0)=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,0)))
"RTN","OOPSDOLX",18,0)
 S OOPSAR("2162A")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162A")))
"RTN","OOPSDOLX",19,0)
 S OOPSAR("2162B")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162B")))
"RTN","OOPSDOLX",20,0)
 S OOPSAR("2162D")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162D")))
"RTN","OOPSDOLX",21,0)
 S OOPSAR("2162ES")=$$UP^OOPSUTL4($G(^OOPS(2260,OOPDA,"2162ES")))
"RTN","OOPSDOLX",22,0)
OP02 ; Seg OP01
"RTN","OOPSDOLX",23,0)
 K OPX,DTINJ
"RTN","OOPSDOLX",24,0)
 S OPX="OP01^"_$TR($P(OOPSAR(0),U),"-")_U_$P(OOPSAR(0),U,2)
"RTN","OOPSDOLX",25,0)
 S OPX=OPX_U_$P(OOPSAR(0),U,7)_U_$TR($P(OOPSAR("2162A"),U),"-")
"RTN","OOPSDOLX",26,0)
 ; patch 11 - send field 109 if CA1, field 214 if CA2
"RTN","OOPSDOLX",27,0)
 ;            left old code, commented below
"RTN","OOPSDOLX",28,0)
 S FORM=$$GET1^DIQ(2260,OOPDA,52,"I")
"RTN","OOPSDOLX",29,0)
 I FORM=1 D
"RTN","OOPSDOLX",30,0)
 . S DTINJ=$$GET1^DIQ(2260,OOPDA,109,"I")
"RTN","OOPSDOLX",31,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(DTINJ,"."))
"RTN","OOPSDOLX",32,0)
 . S Y=DTINJ D DD^%DT S Y=$P($TR(Y,":",""),"@",2),OPX=OPX_U_Y
"RTN","OOPSDOLX",33,0)
 I FORM=2 D
"RTN","OOPSDOLX",34,0)
 . S DTINJ=$$GET1^DIQ(2260,OOPDA,214,"I")
"RTN","OOPSDOLX",35,0)
 . S OPX=OPX_U_$$DC^OOPSUTL3($P(DTINJ,"."))_U
"RTN","OOPSDOLX",36,0)
 K DTINJ
"RTN","OOPSDOLX",37,0)
 ;
"RTN","OOPSDOLX",38,0)
 ; S OPX=OPX_U_$$DC^OOPSUTL3($P($P(OOPSAR(0),U,5),"."))
"RTN","OOPSDOLX",39,0)
 ; I $$GET1^DIQ(2260,OOPDA,52,"I")=1 D
"RTN","OOPSDOLX",40,0)
 ; .S Y=$P(OOPSAR(0),U,5) D DD^%DT S Y=$P($TR(Y,":",""),"@",2)
"RTN","OOPSDOLX",41,0)
 ; .S OPX=OPX_U_Y
"RTN","OOPSDOLX",42,0)
 ; I $$GET1^DIQ(2260,OOPDA,52,"I")=2 S OPX=OPX_U
"RTN","OOPSDOLX",43,0)
 S MON=$E($P(OOPSAR(0),U,5),4,5)
"RTN","OOPSDOLX",44,0)
 S FYM=$S(MON=10:1,MON=11:2,MON=12:3,MON="01":4,MON="02":5,MON="03":6,MON="04":7,MON="05":8,MON="06":9,MON="07":10,MON="08":11,MON="09":12,1:0)
"RTN","OOPSDOLX",45,0)
 S OPX=OPX_U_$E($P(OOPSAR(0),U),1,4)_U_$E("00",$L(FYM)+1,2)_FYM
"RTN","OOPSDOLX",46,0)
 S NAME=$P(OOPSAR(0),U,2),FN=$P(NAME,",",2)
"RTN","OOPSDOLX",47,0)
 F KK=1:0:1 Q:$E(FN,KK)'=" "  S FN=$E(FN,KK+1,$L(FN))
"RTN","OOPSDOLX",48,0)
 ; added $TR below to strip spaces out of name
"RTN","OOPSDOLX",49,0)
 S OPX=OPX_U_$P($TR(NAME," ",""),",")_U_$P(FN," ")_U_$E($P(FN," ",2))
"RTN","OOPSDOLX",50,0)
 S OPX=OPX_"^^"_$P(OOPSAR("2162A"),U,4)_U_$P(OOPSAR("2162A"),U,5)_U_$$GET1^DIQ(2260,OOPDA,"10:1")_U_$E($P(OOPSAR("2162A"),U,7),1,5)
"RTN","OOPSDOLX",51,0)
 S OPX=OPX_U_$TR($P(OOPSAR("2162A"),U,8),"(,)-^*/# ")
"RTN","OOPSDOLX",52,0)
 S OPX=OPX_U_$E($$GET1^DIQ(2260,OOPDA,7,"E"))_U_$$DC^OOPSUTL3($P(OOPSAR("2162A"),U,2))
"RTN","OOPSDOLX",53,0)
 ; Patch 5 llh - changed next line from "70:.01" to 331
"RTN","OOPSDOLX",54,0)
 S OPX=OPX_U_$$GET1^DIQ(2260,OOPDA,331)
"RTN","OOPSDOLX",55,0)
 S OPX=OPX_"^^"_$P(OOPSAR("2162A"),U,10)_"^|"
"RTN","OOPSDOLX",56,0)
 D STORE
"RTN","OOPSDOLX",57,0)
 I $P(OOPSAR(0),U,7)=1 D ^OOPSDOL1
"RTN","OOPSDOLX",58,0)
 I $P(OOPSAR(0),U,7)=2 D ^OOPSDOL2
"RTN","OOPSDOLX",59,0)
EXIT ; Loads the message and Quits the routine
"RTN","OOPSDOLX",60,0)
 I RSIZE+MSIZE>30000 D
"RTN","OOPSDOLX",61,0)
 .S END=$P($P(^OOPS(2260,OPAST,0),U),"-",2)
"RTN","OOPSDOLX",62,0)
 .D SEND^OOPSDOL,CREATE^OOPSDOL
"RTN","OOPSDOLX",63,0)
 .S (START,END)=""
"RTN","OOPSDOLX",64,0)
 F I=1:1:ARR I $G(MESS(I))'="" D
"RTN","OOPSDOLX",65,0)
 .S OPL=OPL+1,^XMB(3.9,XMZ,2,OPL,0)=MESS(I)
"RTN","OOPSDOLX",66,0)
 .I START="" S START=$P($P(OOPSAR(0),U),"-",2)
"RTN","OOPSDOLX",67,0)
 S MSIZE=MSIZE+RSIZE
"RTN","OOPSDOLX",68,0)
 K ARR,MESS,OPDT,RSIZE
"RTN","OOPSDOLX",69,0)
 Q
"RTN","OOPSDOLX",70,0)
STORE ;
"RTN","OOPSDOLX",71,0)
 S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSDOLX",72,0)
 S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSDOLX",73,0)
 Q
"RTN","OOPSDOLX",74,0)
WP ; Word Processing Fields
"RTN","OOPSDOLX",75,0)
 K OPX
"RTN","OOPSDOLX",76,0)
 N DIWL,DIWR,DIWF,OPGLB,OPNODE,X,OPI,NUM,WPAR,F332,F347
"RTN","OOPSDOLX",77,0)
 S NUM=0,OPI=0
"RTN","OOPSDOLX",78,0)
 K ^UTILITY($J,"W")
"RTN","OOPSDOLX",79,0)
 S DIWL=1,DIWR="",DIWF="|C132"
"RTN","OOPSDOLX",80,0)
 ; Patch 5 llh - added logic to concatenate field 332 to WP field (165)
"RTN","OOPSDOLX",81,0)
 I OPFLD=165 D
"RTN","OOPSDOLX",82,0)
 .S F332=$$GET1^DIQ(2260,OOPDA,"332:1")
"RTN","OOPSDOLX",83,0)
 .I $G(F332)'="" S X=F332 D ^DIWP
"RTN","OOPSDOLX",84,0)
 .;v2 p11 - concatenate Reason for Dispute to fld 165 in block 36
"RTN","OOPSDOLX",85,0)
 .S F347=$$GET1^DIQ(2260,OOPDA,"347:.01")
"RTN","OOPSDOLX",86,0)
 .I $G(F347)'="" S X=F347 D ^DIWP
"RTN","OOPSDOLX",87,0)
 S OPNODE=$P($$GET1^DID(2260,OPFLD,"","GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","OOPSDOLX",88,0)
 S OPI=0 F  S OPI=$O(^OOPS(2260,OOPDA,OPNODE,OPI)) Q:'OPI  S X=$G(^OOPS(2260,OOPDA,OPNODE,OPI,0)) D
"RTN","OOPSDOLX",89,0)
 . I $TR(X," ","")="" Q
"RTN","OOPSDOLX",90,0)
 . I X]"" D ^DIWP
"RTN","OOPSDOLX",91,0)
 S OPT=$G(^UTILITY($J,"W",1))+0
"RTN","OOPSDOLX",92,0)
 ; If OPT=0 then no data in ^UTILITY($J,"W") so quit
"RTN","OOPSDOLX",93,0)
 I 'OPT Q
"RTN","OOPSDOLX",94,0)
 ; Need to set up an array to see if max segments exceeded
"RTN","OOPSDOLX",95,0)
 I OPT S OPI=0 F OPC=1:1:OPT S OPI=$O(^UTILITY($J,"W",1,OPI)) Q:'OPI  D
"RTN","OOPSDOLX",96,0)
 . S NUM=NUM+1
"RTN","OOPSDOLX",97,0)
 . S WPAR(NUM)=SEG_U_OPC_U_OPT_U_$$UP^OOPSUTL4($E(^UTILITY($J,"W",1,OPI,0),1,132))_"^|"
"RTN","OOPSDOLX",98,0)
 ; Fileman puts spaces at end of last node - need to strip off.
"RTN","OOPSDOLX",99,0)
 S STRP=$P(WPAR(NUM),U,4)
"RTN","OOPSDOLX",100,0)
 F K=$L(STRP):-1:1 Q:$E(STRP,K)'=" "  S STRP=$E(STRP,1,(K-1))
"RTN","OOPSDOLX",101,0)
 S $P(WPAR(NUM),U,4)=STRP
"RTN","OOPSDOLX",102,0)
 K STRP
"RTN","OOPSDOLX",103,0)
 I NUM>4 D  ; if max segments exceeded fix here
"RTN","OOPSDOLX",104,0)
 . N BEG,END,STR,TMP
"RTN","OOPSDOLX",105,0)
 . F I=1:1:NUM S STR(I)=$P(WPAR(I),U,4)
"RTN","OOPSDOLX",106,0)
 . F I=1:1:(NUM-1) S TMP=132-$L(STR(I)) I TMP D
"RTN","OOPSDOLX",107,0)
 .. S END=$E(STR(I),$L(STR(I))),BEG=$E(STR(I+1))
"RTN","OOPSDOLX",108,0)
 .. ; put a blank in if needed
"RTN","OOPSDOLX",109,0)
 .. I $A(END)'=32,$A(BEG)'=32 S STR(I)=STR(I)_" ",TMP=TMP-1
"RTN","OOPSDOLX",110,0)
 .. S STR(I)=STR(I)_$E(STR(I+1),1,TMP)
"RTN","OOPSDOLX",111,0)
 .. S STR(I+1)=$E(STR(I+1),(TMP+1),$L(STR(I+1)))
"RTN","OOPSDOLX",112,0)
 .. I $L(STR(I)) S $P(WPAR(I),U,4)=STR(I)
"RTN","OOPSDOLX",113,0)
 .. I '$L(STR(I)) K WPAR(I)
"RTN","OOPSDOLX",114,0)
 . I '$L(STR(NUM)) K WPAR(NUM)
"RTN","OOPSDOLX",115,0)
 ; load temporary array into MESS array to load into Mailman message
"RTN","OOPSDOLX",116,0)
 S NSEG=$O(WPAR(""),-1)
"RTN","OOPSDOLX",117,0)
 S NUM=0 F  S NUM=$O(WPAR(NUM)) Q:NUM=""  D
"RTN","OOPSDOLX",118,0)
 . S OPX=WPAR(NUM),$P(OPX,U,3)=NSEG
"RTN","OOPSDOLX",119,0)
 . S ARR=ARR+1,MESS(ARR)=OPX
"RTN","OOPSDOLX",120,0)
 . S RSIZE=RSIZE+$L(OPX)+2
"RTN","OOPSDOLX",121,0)
 K ^UTILITY($J,"W"),X,OPFLD,NSEG
"RTN","OOPSDOLX",122,0)
 Q
"RTN","OOPSGUI1")
0^9^B34207574
"RTN","OOPSGUI1",1,0)
OOPSGUI1 ;WIOFO/LLH-RPC routines ;9/3/01
"RTN","OOPSGUI1",2,0)
 ;;2.0;ASISTS;**4,8,7,11**;Jun 03, 2002
"RTN","OOPSGUI1",3,0)
 ;
"RTN","OOPSGUI1",4,0)
OPT(RESULTS,INP) ; Returns the ASISTS GUI Menus user has access to
"RTN","OOPSGUI1",5,0)
 ;      INP      - Input String containing the version of GUI making call
"RTN","OOPSGUI1",6,0)
 ;  RESUTLS      - return value for broker call
"RTN","OOPSGUI1",7,0)
 ;                 P1 = 1 DUZ defined
"RTN","OOPSGUI1",8,0)
 ;                 P2 = 1 Emp Health menu accessible
"RTN","OOPSGUI1",9,0)
 ;                 P3 = 1 Employee menu accessible
"RTN","OOPSGUI1",10,0)
 ;                 P4 = 1 Supervisor menu accessible
"RTN","OOPSGUI1",11,0)
 ;                 P5 = 1 Safety Officer menu accessible
"RTN","OOPSGUI1",12,0)
 ;                 P6 = 1 Union menu accessible
"RTN","OOPSGUI1",13,0)
 ;                 P7 = 1 Workers' Comp menu accessible
"RTN","OOPSGUI1",14,0)
 ;                 P8 = SSN from New Person file for user
"RTN","OOPSGUI1",15,0)
 ;                 P9 = server version #
"RTN","OOPSGUI1",16,0)
 ;
"RTN","OOPSGUI1",17,0)
 N CNT,MENU,OPT,PRIM,SM,VER
"RTN","OOPSGUI1",18,0)
 S CNT=1
"RTN","OOPSGUI1",19,0)
 I 'DUZ S RESULTS="0^^^^^^^" Q
"RTN","OOPSGUI1",20,0)
 S RESULTS=DUZ_"^0^0^0^0^0^0^"
"RTN","OOPSGUI1",21,0)
 S VER="2.11.1.0"        ;Define version check patch #4
"RTN","OOPSGUI1",22,0)
 I $G(INP)=""!($G(INP)'=VER) Q
"RTN","OOPSGUI1",23,0)
 S PRIM=$$GET1^DIQ(200,DUZ,201)     ; get primary menu
"RTN","OOPSGUI1",24,0)
 I $G(PRIM)'="" S MENU(PRIM)=""
"RTN","OOPSGUI1",25,0)
 S SM=0
"RTN","OOPSGUI1",26,0)
 F  S SM=$O(^VA(200,DUZ,203,SM))  Q:SM'>0  D
"RTN","OOPSGUI1",27,0)
 . S OPT=$$GET1^DIQ(19,$P($G(^VA(200,DUZ,203,SM,0)),U),.01)
"RTN","OOPSGUI1",28,0)
 . I $G(OPT)'="" S MENU(OPT)=""
"RTN","OOPSGUI1",29,0)
 I $D(MENU("OOPS GUI EMPLOYEE HEALTH MENU")) S $P(RESULTS,U,2)=1
"RTN","OOPSGUI1",30,0)
 I $D(MENU("OOPS GUI EMPLOYEE")) S $P(RESULTS,U,3)=1
"RTN","OOPSGUI1",31,0)
 I $D(MENU("OOPS GUI SUPERVISOR MENU")) S $P(RESULTS,U,4)=1
"RTN","OOPSGUI1",32,0)
 I $D(MENU("OOPS GUI SAFETY OFFICER MENU")) S $P(RESULTS,U,5)=1
"RTN","OOPSGUI1",33,0)
 I $D(MENU("OOPS GUI UNION MENU")) S $P(RESULTS,U,6)=1
"RTN","OOPSGUI1",34,0)
 I $D(MENU("OOPS GUI WORKERS' COMP MENU")) S $P(RESULTS,U,7)=1
"RTN","OOPSGUI1",35,0)
 I +$$ACCESS^XQCHK(DUZ,"OOPS GUI EMPLOYEE") S $P(RESULTS,U,3)=1
"RTN","OOPSGUI1",36,0)
 S $P(RESULTS,U,8)=$$GET1^DIQ(200,DUZ,9)
"RTN","OOPSGUI1",37,0)
 S $P(RESULTS,U,9)=VER              ;return the version defined above.
"RTN","OOPSGUI1",38,0)
 Q
"RTN","OOPSGUI1",39,0)
SETSIGN(RESULTS,INPUT,SIGN) ; This subroutine validates that the signature
"RTN","OOPSGUI1",40,0)
 ;                         can be entered and is valid
"RTN","OOPSGUI1",41,0)
 ;  Input:   INPUT - Contains the IEN of the ASISTS case, the form type,
"RTN","OOPSGUI1",42,0)
 ;                   and the field number.  The field number is used
"RTN","OOPSGUI1",43,0)
 ;                   to trigger what validation should be preformed on
"RTN","OOPSGUI1",44,0)
 ;                   the fields in the form so that the signature can
"RTN","OOPSGUI1",45,0)
 ;                   be applied. The fourth parameter is a special flag
"RTN","OOPSGUI1",46,0)
 ;                   indicating the Workers Comp is signing for employee
"RTN","OOPSGUI1",47,0)
 ;                   Format is IEN^FORM^FIELD^WCFLAG
"RTN","OOPSGUI1",48,0)
 ;            SIGN - contains the signature test to be encrypted.
"RTN","OOPSGUI1",49,0)
 ; Output: RESULTS - is an array containing a list of fields that did
"RTN","OOPSGUI1",50,0)
 ;                   not pass the data validation and must be corrected
"RTN","OOPSGUI1",51,0)
 ;                   prior to applying a signature.
"RTN","OOPSGUI1",52,0)
 N CALL,DTIME,FDUZ,FDT,FLD,IEN,INC,FORM,ESIG,VALID,CALLER,WOK
"RTN","OOPSGUI1",53,0)
 N DR,DA,DIE,WCFLG
"RTN","OOPSGUI1",54,0)
 S IEN=$P($G(INPUT),U),FORM=$P($G(INPUT),U,2),FLD=$P($G(INPUT),U,3)
"RTN","OOPSGUI1",55,0)
 I '$G(IEN)!('$G(FLD)) S RESULTS(1)="User not Authorized to sign form" Q
"RTN","OOPSGUI1",56,0)
 I FLD=45!(FLD=170)!(FLD=266) S CALL="S"
"RTN","OOPSGUI1",57,0)
 I FLD=49!(FLD=77) S CALL="O"
"RTN","OOPSGUI1",58,0)
 ; Patch 5 ll - added !(FLD=313)!(FLD=320)
"RTN","OOPSGUI1",59,0)
 I FLD=68!(FLD=313)!(FLD=320) S CALL="W"
"RTN","OOPSGUI1",60,0)
 I FLD=80 S CALL="H"
"RTN","OOPSGUI1",61,0)
 ; Patch 5 llh - added !(FLD=310)
"RTN","OOPSGUI1",62,0)
 I FLD=120!(FLD=222)!(FLD=310) S CALL="E"
"RTN","OOPSGUI1",63,0)
 S WCFLG=$P($G(INPUT),U,4)
"RTN","OOPSGUI1",64,0)
 I WCFLG'="W" D
"RTN","OOPSGUI1",65,0)
 .; Patch 5 llh - moved non fld check logic to separate line
"RTN","OOPSGUI1",66,0)
 .; added stuff to check if dual benefits have been signed
"RTN","OOPSGUI1",67,0)
 .I (FLD=120!(FLD=222)) D
"RTN","OOPSGUI1",68,0)
 ..I ($$GET1^DIQ(2260,IEN,71,"I")'="Y") D  Q
"RTN","OOPSGUI1",69,0)
 ...S RESULTS(1)="Claim cannot be signed until the Bill of Rights Statement is understood."
"RTN","OOPSGUI1",70,0)
 ...D WCPBOR^OOPSMBUL(IEN)
"RTN","OOPSGUI1",71,0)
 ;..Commented out Patch 11 cvw
"RTN","OOPSGUI1",72,0)
 ;..I $$GET1^DIQ(2260,IEN,310)="" D  Q
"RTN","OOPSGUI1",73,0)
 ;...S RESULTS(1)="Claim cannot be signed until the Dual Benefits form has been signed."
"RTN","OOPSGUI1",74,0)
 ; check to make sure PAID fields (also Service) not "", if "" get data
"RTN","OOPSGUI1",75,0)
 D CHKPAID
"RTN","OOPSGUI1",76,0)
 S VALID=0
"RTN","OOPSGUI1",77,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSGUI1",78,0)
 ; Patch 5 llh - added ,(FLD'>300)
"RTN","OOPSGUI1",79,0)
 I (FLD'=77),(FLD'=80),(FLD'>300) D  I 'VALID Q
"RTN","OOPSGUI1",80,0)
 .D VALIDATE^OOPSGUI9(IEN,FORM,CALL,.VALID)
"RTN","OOPSGUI1",81,0)
 I $G(SIGN)="" S RESULTS(1)="No Signature Entered" Q
"RTN","OOPSGUI1",82,0)
 S VALID=$$VALIDATE($$DECRYP^XUSRB1(SIGN))
"RTN","OOPSGUI1",83,0)
 I 'VALID D  Q
"RTN","OOPSGUI1",84,0)
 .I $P($G(^VA(200,DUZ,20)),"^",4)="" S RESULTS(1)="No Electronic Signature on File" Q
"RTN","OOPSGUI1",85,0)
 .S RESULTS(1)="Invalid Signature Entered."
"RTN","OOPSGUI1",86,0)
SIGN ; All field validated, file signature
"RTN","OOPSGUI1",87,0)
 I FLD=77 S FDUZ=76,FDT=78             ; Safety approve WC sign
"RTN","OOPSGUI1",88,0)
 I FLD=80 S FDUZ=79,FDT=81             ; EH approve WC sign
"RTN","OOPSGUI1",89,0)
 I FLD=120 S FDUZ=119,FDT=121          ; Employee sign CA1
"RTN","OOPSGUI1",90,0)
 I FLD=222 S FDUZ=221,FDT=223          ; Employee sign CA2
"RTN","OOPSGUI1",91,0)
 I FLD=170 S FDUZ=169,FDT=171          ; Super sign CA1
"RTN","OOPSGUI1",92,0)
 I FLD=266 S FDUZ=265,FDT=267          ; Super sign CA2
"RTN","OOPSGUI1",93,0)
 I FLD=45 S FDUZ=44,FDT=46             ; Super sign 2162
"RTN","OOPSGUI1",94,0)
 I FLD=49 S FDUZ=48,FDT=50             ; Safety sign 2162
"RTN","OOPSGUI1",95,0)
 I FLD=68 S FDUZ=67,FDT=69,WOK=1       ; WC approve to DOL
"RTN","OOPSGUI1",96,0)
 ; patch 5 llh - added next 2 lines (may need more)
"RTN","OOPSGUI1",97,0)
 I FLD=310 S FDUZ=309,FDT=311          ; Emp sign Dual Benefits
"RTN","OOPSGUI1",98,0)
 I FLD=313 S FDUZ=312,FDT=314          ; WC sign Dual Benefits
"RTN","OOPSGUI1",99,0)
 D NOW^%DTC S DTIME=%
"RTN","OOPSGUI1",100,0)
 K DR S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSGUI1",101,0)
 S DR=FDUZ_"////^S X=+DUZ;"_FLD_"////^S X=ESIG;"_FDT_"////^S X=DTIME"
"RTN","OOPSGUI1",102,0)
 D ^DIE
"RTN","OOPSGUI1",103,0)
 I $G(Y)'="" Q
"RTN","OOPSGUI1",104,0)
 I FLD=68 D WCP^OOPSMBUL(IEN,"S")
"RTN","OOPSGUI1",105,0)
 I FLD=120!(FLD=222) S CALLER=CALL D EMP^OOPSVAL1
"RTN","OOPSGUI1",106,0)
 I FLD=45 D SAFETY^OOPSMBUL(IEN)
"RTN","OOPSGUI1",107,0)
 I (FLD=170)!(FLD=266) D SUPS^OOPSMBUL(IEN),UNION^OOPSMBUL(IEN)
"RTN","OOPSGUI1",108,0)
 Q
"RTN","OOPSGUI1",109,0)
VALIDATE(X) ; Validate Electronic Sign code
"RTN","OOPSGUI1",110,0)
 ;  Input:  X - contains the signature to be validated
"RTN","OOPSGUI1",111,0)
 ; Output: VSIGN - contains a 1 if a valid e-signature, a 0 if not valid
"RTN","OOPSGUI1",112,0)
 N VSIGN
"RTN","OOPSGUI1",113,0)
 S VSIGN=0
"RTN","OOPSGUI1",114,0)
 D HASH^XUSHSHP
"RTN","OOPSGUI1",115,0)
 I X'="",(X=$P($G(^VA(200,DUZ,20)),"^",4)) S VSIGN=1,ESIG=X
"RTN","OOPSGUI1",116,0)
 Q VSIGN
"RTN","OOPSGUI1",117,0)
CHKPAID ; check to make sure PAID fields have data, if not populate
"RTN","OOPSGUI1",118,0)
 ; this subroutine can be removed when go completely to GUI
"RTN","OOPSGUI1",119,0)
 N DA,DIE,DR,CAT,FLD,IEN200,OCCD,PAY,PAYP,RET,SAL,SERV,SSN
"RTN","OOPSGUI1",120,0)
 I $$GET1^DIQ(2260,IEN,60)="" D
"RTN","OOPSGUI1",121,0)
 .S FLD=26,RET="",RET=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSGUI1",122,0)
 .S RET=$S(RET="FULL CSRS":"CSRS",RET="FERS":"FERS",1:"OTHER")
"RTN","OOPSGUI1",123,0)
 .S DIE="^OOPS(2260,",DA=IEN,DR="60///^S X=RET" D ^DIE
"RTN","OOPSGUI1",124,0)
 I $$GET1^DIQ(2260,IEN,86)="" D
"RTN","OOPSGUI1",125,0)
 .S SERV="",SSN=$$GET1^DIQ(2260,IEN,5,"I")
"RTN","OOPSGUI1",126,0)
 .I $G(SSN) S IEN200=$O(^VA(200,"SSN",SSN,""))
"RTN","OOPSGUI1",127,0)
 .I $G(IEN200) S SERV=$$GET1^DIQ(200,IEN200,29)
"RTN","OOPSGUI1",128,0)
 .S DIE="^OOPS(2260,",DA=IEN,DR="86///^S X=SERV" D ^DIE
"RTN","OOPSGUI1",129,0)
 I $$GET1^DIQ(2260,IEN,166)="" D
"RTN","OOPSGUI1",130,0)
 .S FLD=28,SAL="",SAL=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSGUI1",131,0)
 .S DIE="^OOPS(2260,",DA=IEN,DR="166///^S X=SAL" D ^DIE
"RTN","OOPSGUI1",132,0)
 I $$GET1^DIQ(2260,IEN,167)="" D
"RTN","OOPSGUI1",133,0)
 .S FLD=19,PAY="",PAY=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSGUI1",134,0)
 .S PAY=$S(PAY="PER ANNUM":"ANNUAL",PAY="PER HOUR":"HOURLY","PER DIEM":"DAILY","BIWEEKLY":"BI-WEEKLY",1:"")
"RTN","OOPSGUI1",135,0)
 .S DIE="^OOPS(2260,",DA=IEN,DR="167///^S X=PAY" D ^DIE
"RTN","OOPSGUI1",136,0)
 I $$GET1^DIQ(2260,IEN,63)="",($$GET1^DIQ(2260,IEN,2,"I")<3) D
"RTN","OOPSGUI1",137,0)
 .S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSGUI1",138,0)
 .I CAT=1 S PAYP=$$PAID^OOPSUTL1(IEN,20) I $G(PAYP)'="" S PAYP=$$PAYP^OOPSUTL1(PAYP)
"RTN","OOPSGUI1",139,0)
 .I CAT=2 S PAYP="VO"
"RTN","OOPSGUI1",140,0)
 .S DIE="^OOPS(2260,",DA=IEN,DR="63///^S X=PAYP" D ^DIE
"RTN","OOPSGUI1",141,0)
 I $$GET1^DIQ(2260,IEN,111)="" D
"RTN","OOPSGUI1",142,0)
 .S FLD=16,OCCD="",OCCD=$$PAID^OOPSUTL1(IEN,FLD)
"RTN","OOPSGUI1",143,0)
 .S DIE="^OOPS(2260,",DA=IEN,DR="111///^S X=OCCD" D ^DIE
"RTN","OOPSGUI1",144,0)
 Q
"RTN","OOPSGUI1",145,0)
VALEMP(RESULTS,INPUT) ; This broker call should be used if the Pay
"RTN","OOPSGUI1",146,0)
 ;                 Plan = "OT" (other) to determine if the claim
"RTN","OOPSGUI1",147,0)
 ;                 can be successfully submitted to DOL.  The PERSONNEL
"RTN","OOPSGUI1",148,0)
 ;                 STATUS is assumed to equal 1 (employee)
"RTN","OOPSGUI1",149,0)
 S IEN=$P($G(INPUT),U,2),FORM=$P($G(INPUT),U)
"RTN","OOPSGUI1",150,0)
 I '$G(IEN)!($G(FORM)="") S RESULTS="Invalid Input, cannot continue." Q
"RTN","OOPSGUI1",151,0)
 I $$VALEMP^OOPSUTL6 S RESULTS="Valid" Q
"RTN","OOPSGUI1",152,0)
 S RESULTS="Invalid data on claim"
"RTN","OOPSGUI1",153,0)
 Q
"RTN","OOPSGUI4")
0^5^B55460170
"RTN","OOPSGUI4",1,0)
OOPSGUI4 ;WIOFO/LLH-RPC BROKER CALLS ;10/02/01
"RTN","OOPSGUI4",2,0)
 ;;2.0;ASISTS;**4,8,7,11**;Jun 03, 2002
"RTN","OOPSGUI4",3,0)
 ;
"RTN","OOPSGUI4",4,0)
PAID(RESULTS,NAME) ; retrieves PAID employee and data from file 450
"RTN","OOPSGUI4",5,0)
 ;  Input:    NAME - the Employee Name or partial name Passed in
"RTN","OOPSGUI4",6,0)
 ; Output: RESULTS - array containing PAID fields in the order returned
"RTN","OOPSGUI4",7,0)
 ;                   from FIND^DIC
"RTN","OOPSGUI4",8,0)
 ;
"RTN","OOPSGUI4",9,0)
 N IEN200,LP,PAY,PAYP,PHONE,OCCDESC,RET,SAL,SSN,X,STATE,SERV,SAMEFLG
"RTN","OOPSGUI4",10,0)
 N IEN450
"RTN","OOPSGUI4",11,0)
 I NAME="" S RESULTS(1)="^NO SSN OR NAME PROVIDED" Q
"RTN","OOPSGUI4",12,0)
 S X=NAME,SAMEFLG=0
"RTN","OOPSGUI4",13,0)
 D FIND^DIC(450,,"@;.01;6;8;10;13;16EI;31;32;38;186.1;186.2;186;186.4;458I;30","MPS",X,500)
"RTN","OOPSGUI4",14,0)
 I $G(DIERR) D CLEAN^DILF Q
"RTN","OOPSGUI4",15,0)
 I $P(^TMP("DILIST",$J,0),U)=0 S RESULTS(0)="^NO PAID EMPLOYEE FOUND" Q
"RTN","OOPSGUI4",16,0)
 F LP=0:0 S LP=$O(^TMP("DILIST",$J,LP)) Q:LP=""  D
"RTN","OOPSGUI4",17,0)
 .; cannot pick yourself if selecting case,use SSN to see if DUZ matches
"RTN","OOPSGUI4",18,0)
 .S SSN=$TR($P($G(^TMP("DILIST",$J,LP,0)),U,4),"-","")
"RTN","OOPSGUI4",19,0)
 .I $G(SSN) S IEN200=$O(^VA(200,"SSN",SSN,""))
"RTN","OOPSGUI4",20,0)
 .; 12/29/03 llh - also cannot pick a person from the PAID file with
"RTN","OOPSGUI4",21,0)
 .;                a pseudo SSN (one that begins with 000)
"RTN","OOPSGUI4",22,0)
 .I $E(SSN,1,3)="000" Q
"RTN","OOPSGUI4",23,0)
 .I DUZ=IEN200 S SAMEFLG=1 Q
"RTN","OOPSGUI4",24,0)
 .S RESULTS(LP)=^TMP("DILIST",$J,LP,0)
"RTN","OOPSGUI4",25,0)
 .S $P(RESULTS(LP),U,5)=$E($P(RESULTS(LP),U,5),1,45)
"RTN","OOPSGUI4",26,0)
 .S $P(RESULTS(LP),U,8)=$E($P($G(RESULTS(LP)),U,8),1,4)
"RTN","OOPSGUI4",27,0)
 .S PHONE=""  ; ,SSN=$TR($P($G(RESULTS(LP)),U,4),"-","")
"RTN","OOPSGUI4",28,0)
 .I $G(IEN200) S PHONE=$P($G(^VA(200,IEN200,.13)),U)
"RTN","OOPSGUI4",29,0)
 .I $TR(PHONE,"(,)-^*/# &%@!","")'?10N S PHONE=""  ;Must be 10 char
"RTN","OOPSGUI4",30,0)
 .S RESULTS(LP)=RESULTS(LP)_U_PHONE
"RTN","OOPSGUI4",31,0)
 .S IEN450=$P(RESULTS(LP),U)
"RTN","OOPSGUI4",32,0)
 .I $G(IEN450) D
"RTN","OOPSGUI4",33,0)
 ..S PAYP=$$GET1^DIQ(450,IEN450,20) I $G(PAYP)'="" S PAYP=$$PAYP^OOPSUTL1(PAYP)
"RTN","OOPSGUI4",34,0)
 ..S SAL=$$GET1^DIQ(450,IEN450,28)
"RTN","OOPSGUI4",35,0)
 ..S RET=$$GET1^DIQ(450,IEN450,26) I $G(RET)'="" S RET=$S(RET="FULL CSRS":"CSRS",RET="FERS":"FERS",1:"OTHER")
"RTN","OOPSGUI4",36,0)
 ..S PAY=$$GET1^DIQ(450,IEN450,19) I $G(PAY)'="" S PAY=$S(PAY="PER ANNUM":"ANNUAL",PAY="PER HOUR":"HOURLY","PER DIEM":"DAILY","BIWEEKLY":"BI-WEEKLY",1:"")
"RTN","OOPSGUI4",37,0)
 ..S OCCDESC=$E($$GET1^DIQ(450,IEN450,16),1,30)
"RTN","OOPSGUI4",38,0)
 .S SERV="" I $G(IEN200) S SERV=$$GET1^DIQ(200,IEN200,29)
"RTN","OOPSGUI4",39,0)
 .S RESULTS(LP)=RESULTS(LP)_U_PAY_U_SAL_U_RET_U_PAYP_U_OCCDESC_U_SERV
"RTN","OOPSGUI4",40,0)
 I SAMEFLG,'$D(RESULTS) S RESULTS(0)="^CANNOT CREATE CASE FOR YOURSELF"
"RTN","OOPSGUI4",41,0)
 KILL DIERR,^TMP("DILIST",$J)
"RTN","OOPSGUI4",42,0)
 Q
"RTN","OOPSGUI4",43,0)
 ;
"RTN","OOPSGUI4",44,0)
ASISTS(RESULTS,NAME) ; Lookup on ASISTS Accident Reporting file_2260
"RTN","OOPSGUI4",45,0)
 ;  Input:  - Name or partial name of person to lookup on
"RTN","OOPSGUI4",46,0)
 ; Output:  - array with name of person, sex, DOB, and SSN
"RTN","OOPSGUI4",47,0)
 ;
"RTN","OOPSGUI4",48,0)
 N ARR,I,X,SAMEFLG
"RTN","OOPSGUI4",49,0)
 K ^TMP("DILIST",$J)
"RTN","OOPSGUI4",50,0)
 I NAME="" S RESULTS(0)="^NO SSN OR NAME PROVIDED" Q
"RTN","OOPSGUI4",51,0)
 S X=NAME,SAMEFLG=0
"RTN","OOPSGUI4",52,0)
 ; patch 5 llh - added the 3 indices
"RTN","OOPSGUI4",53,0)
 D FIND^DIC(2260,,"@;1;7;6;5","PSMC",X,500,"C^SSN^BS5")
"RTN","OOPSGUI4",54,0)
 I $G(DIERR) D CLEAN^DILF Q
"RTN","OOPSGUI4",55,0)
 I $P(^TMP("DILIST",$J,0),"^")=0 S RESULTS(1)="^NO ASISTS CASE FOUND" Q
"RTN","OOPSGUI4",56,0)
 F I=0:0 S I=$O(^TMP("DILIST",$J,I)) Q:I=""  D
"RTN","OOPSGUI4",57,0)
 . I DUZ=$P(^TMP("DILIST",$J,I,0),U) S SAMEFLG=1 Q
"RTN","OOPSGUI4",58,0)
 . I $D(ARR($P(^TMP("DILIST",$J,I,0),U,2))) Q
"RTN","OOPSGUI4",59,0)
 . S ARR($P(^TMP("DILIST",$J,I,0),U,2))=""
"RTN","OOPSGUI4",60,0)
 . S RESULTS(I)=^TMP("DILIST",$J,I,0)
"RTN","OOPSGUI4",61,0)
 I SAMEFLG,'$D(RESULTS) S RESULTS(0)="^CANNOT CREATE CASE FOR YOURSELF"
"RTN","OOPSGUI4",62,0)
 I '$D(RESULTS) S RESULTS(0)="^NO SELECTABLE CASES FOUND"
"RTN","OOPSGUI4",63,0)
 K DIERR,^TMP("DILIST",$J)
"RTN","OOPSGUI4",64,0)
 Q
"RTN","OOPSGUI4",65,0)
PER(RESULTS,NAME) ; Lookup for Non-Paid Employee (New Person file_
"RTN","OOPSGUI4",66,0)
 ;  Input:  - Name or partial name of person to lookup on
"RTN","OOPSGUI4",67,0)
 ; Output:  - array with name of new person, sex, DOB, and SSN
"RTN","OOPSGUI4",68,0)
 ;
"RTN","OOPSGUI4",69,0)
 N I,SSN,X,SAMEFLG
"RTN","OOPSGUI4",70,0)
 K ^TMP("DILIST",$J)
"RTN","OOPSGUI4",71,0)
 I NAME="" S RESULTS(0)="^NO SSN OR NAME PROVIDED" Q
"RTN","OOPSGUI4",72,0)
 S X=NAME,SAMEFLG=0
"RTN","OOPSGUI4",73,0)
 D FIND^DIC(200,,"@;.01;4;5;9;29","PSMC",X,500)
"RTN","OOPSGUI4",74,0)
 I $G(DIERR) D CLEAN^DILF Q
"RTN","OOPSGUI4",75,0)
 I $P(^TMP("DILIST",$J,0),"^")=0 S RESULTS(1)="^NO NEW PERSON FOUND" Q
"RTN","OOPSGUI4",76,0)
 F I=0:0 S I=$O(^TMP("DILIST",$J,I)) Q:I=""  D
"RTN","OOPSGUI4",77,0)
 . ; make sure not a PAID Employee
"RTN","OOPSGUI4",78,0)
 . S SSN=$P(^TMP("DILIST",$J,I,0),U,5)
"RTN","OOPSGUI4",79,0)
 . I $G(SSN),$$FIND1^DIC(450,"","MX",SSN) Q
"RTN","OOPSGUI4",80,0)
 . I DUZ=$P(^TMP("DILIST",$J,I,0),U) S SAMEFLG=1 Q
"RTN","OOPSGUI4",81,0)
 . S RESULTS(I)=^TMP("DILIST",$J,I,0)
"RTN","OOPSGUI4",82,0)
 I SAMEFLG,'$D(RESULTS) S RESULTS(0)="^CANNOT CREATE CASE FOR YOURSELF"
"RTN","OOPSGUI4",83,0)
 I '$D(RESULTS) S RESULTS(0)="^NO SELECTABLE CASES FOUND"
"RTN","OOPSGUI4",84,0)
 K DIERR,^TMP("DILIST",$J)
"RTN","OOPSGUI4",85,0)
 Q
"RTN","OOPSGUI4",86,0)
SUPER(RESULTS,NAME,EMPSSN) ; Lookup for Supervisors or anyone from the New 
"RTN","OOPSGUI4",87,0)
 ;                 Person file.  This broker call will also be used to
"RTN","OOPSGUI4",88,0)
 ;                 lookup Union representatives for the Enter/Edit
"RTN","OOPSGUI4",89,0)
 ;                 Union Information.
"RTN","OOPSGUI4",90,0)
 ;  Input:    NAME - Name or partial name of person to lookup on
"RTN","OOPSGUI4",91,0)
 ;             SSN - SSN of the Person Involved if called from 2162
"RTN","OOPSGUI4",92,0)
 ; Output: RESULTS - array with name of new person, sex, DOB, and SSN
"RTN","OOPSGUI4",93,0)
 ;
"RTN","OOPSGUI4",94,0)
 N I,SSN,SAME,X
"RTN","OOPSGUI4",95,0)
 K ^TMP("DILIST",$J)
"RTN","OOPSGUI4",96,0)
 I NAME="" S RESULTS(1)="^NO SSN OR NAME PROVIDED" Q
"RTN","OOPSGUI4",97,0)
 S X=NAME,SAME=0
"RTN","OOPSGUI4",98,0)
 D FIND^DIC(200,,".01;9","PSCM",X,500)
"RTN","OOPSGUI4",99,0)
 I $G(DIERR) D CLEAN^DILF Q
"RTN","OOPSGUI4",100,0)
 I $P(^TMP("DILIST",$J,0),"^")=0 S RESULTS(1)="^NO NEW PERSON FOUND" Q
"RTN","OOPSGUI4",101,0)
 F I=0:0 S I=$O(^TMP("DILIST",$J,I)) Q:I=""  D
"RTN","OOPSGUI4",102,0)
 . I $G(EMPSSN)'="",($P(^TMP("DILIST",$J,I,0),U,3)=$G(EMPSSN)) S SAME=1 Q
"RTN","OOPSGUI4",103,0)
 . S RESULTS(I)=^TMP("DILIST",$J,I,0)
"RTN","OOPSGUI4",104,0)
 I SAME,'$D(RESULTS) S RESULTS(1)="^CANNOT BE SUPERVISOR FOR YOUR CLAIM"
"RTN","OOPSGUI4",105,0)
 I '$D(RESULTS) S RESULTS(1)="^NO VALID SELECTION"
"RTN","OOPSGUI4",106,0)
 K DIERR,^TMP("DILIST",$J)
"RTN","OOPSGUI4",107,0)
 Q
"RTN","OOPSGUI4",108,0)
 ;
"RTN","OOPSGUI4",109,0)
LOAD(RESULTS,ARR) ; Create new OOPS record
"RTN","OOPSGUI4",110,0)
 ;  Input:     ARR  - contains data entered from the Create Accident/
"RTN","OOPSGUI4",111,0)
 ;                    Illness Report Option
"RTN","OOPSGUI4",112,0)
 ; Output:  RESULTS - status message
"RTN","OOPSGUI4",113,0)
 ;
"RTN","OOPSGUI4",114,0)
 N ASUB,CAT,DA,DATE,DIC,DR,ERROR,FLDS,FNUM,FYEAR,IEN2260,LP,NUM,PCE,SSN,X
"RTN","OOPSGUI4",115,0)
 N LIST,CNT,DLAYGO
"RTN","OOPSGUI4",116,0)
 S CAT=""
"RTN","OOPSGUI4",117,0)
 I $G(ARR(2)) S CAT=ARR(2)
"RTN","OOPSGUI4",118,0)
 I $G(ARR(5)) S SSN=ARR(5)
"RTN","OOPSGUI4",119,0)
 D NOW^%DTC
"RTN","OOPSGUI4",120,0)
 S DATE=X
"RTN","OOPSGUI4",121,0)
 S FYEAR=""
"RTN","OOPSGUI4",122,0)
 S FYEAR=$$FYEAR^OOPSCSN(X)
"RTN","OOPSGUI4",123,0)
 S NUM=$$NEWR^OOPSCSN(FYEAR)
"RTN","OOPSGUI4",124,0)
 K DD,DO
"RTN","OOPSGUI4",125,0)
 S DLAYGO=2260,DIC="^OOPS(2260,"
"RTN","OOPSGUI4",126,0)
 S DIC(0)="QLZ"
"RTN","OOPSGUI4",127,0)
 S X=NUM
"RTN","OOPSGUI4",128,0)
 D FILE^DICN
"RTN","OOPSGUI4",129,0)
 I Y<0 S (RESULTS,RESULTS(0))="UNABLE TO CREATE RECORD" Q
"RTN","OOPSGUI4",130,0)
 S IEN2260=+Y
"RTN","OOPSGUI4",131,0)
 S DIE="^OOPS(2260,"
"RTN","OOPSGUI4",132,0)
 S DA=IEN2260
"RTN","OOPSGUI4",133,0)
 ;
"RTN","OOPSGUI4",134,0)
 S LIST="1,2,3,4,5,6,7,8,9,10,11,12,14,15,16,17,18,52,60,63,86,90,335,"
"RTN","OOPSGUI4",135,0)
 S LIST=LIST_"336,338,339,349,350,351,352,"
"RTN","OOPSGUI4",136,0)
 I ARR(52)="Injury" S LIST=LIST_",111,166,167"
"RTN","OOPSGUI4",137,0)
 I ARR(52)="Illness/Disease" S LIST=LIST_",208,334"
"RTN","OOPSGUI4",138,0)
 F CNT=1:1 S FNUM=$P(LIST,",",CNT) Q:FNUM=""  I $G(ARR(FNUM))'="" D VAL(DA,FNUM,ARR(FNUM))
"RTN","OOPSGUI4",139,0)
 K DR S DIE="^OOPS(2260,",DA=IEN2260,DR=""
"RTN","OOPSGUI4",140,0)
 S DR(1,2260,1)="1///^S X=ARR(1)"
"RTN","OOPSGUI4",141,0)
 S DR(1,2260,2)="2///^S X=ARR(2)"
"RTN","OOPSGUI4",142,0)
 S DR(1,2260,3)="3///^S X=ARR(3)"
"RTN","OOPSGUI4",143,0)
 S DR(1,2260,4)="4///^S X=ARR(4)"
"RTN","OOPSGUI4",144,0)
 S DR(1,2260,5)="5///^S X=ARR(5)"
"RTN","OOPSGUI4",145,0)
 S DR(1,2260,6)="6///^S X=ARR(6)"
"RTN","OOPSGUI4",146,0)
 S DR(1,2260,7)="7///^S X=ARR(7)"
"RTN","OOPSGUI4",147,0)
 S DR(1,2260,8)="8///^S X=ARR(8)"
"RTN","OOPSGUI4",148,0)
 S DR(1,2260,9)="9///^S X=ARR(9)"
"RTN","OOPSGUI4",149,0)
 S DR(1,2260,10)="10///^S X=ARR(10)"
"RTN","OOPSGUI4",150,0)
 S DR(1,2260,12)="11///^S X=ARR(11)"
"RTN","OOPSGUI4",151,0)
 S DR(1,2260,15)="12///^S X=ARR(12)"
"RTN","OOPSGUI4",152,0)
 S DR(1,2260,18)="13////^S X=ARR(13)"     ; sending pointer
"RTN","OOPSGUI4",153,0)
 S DR(1,2260,21)="14///^S X=ARR(14)"
"RTN","OOPSGUI4",154,0)
 S DR(1,2260,24)="15///^S X=ARR(15)"
"RTN","OOPSGUI4",155,0)
 S DR(1,2260,27)="16///^S X=ARR(16)"
"RTN","OOPSGUI4",156,0)
 S DR(1,2260,30)="17///^S X=ARR(17)"
"RTN","OOPSGUI4",157,0)
 S DR(1,2260,33)="18///^S X=ARR(18)"
"RTN","OOPSGUI4",158,0)
 S DR(1,2260,36)="52///^S X=ARR(52)"
"RTN","OOPSGUI4",159,0)
 S DR(1,2260,39)="53////^S X=ARR(53)"     ; send pointer
"RTN","OOPSGUI4",160,0)
 S DR(1,2260,42)="53.1////^S X=ARR(22)"   ; send pointer
"RTN","OOPSGUI4",161,0)
 S DR(1,2260,45)="56////^S X=ARR(48)"     ; send pointer
"RTN","OOPSGUI4",162,0)
 S DR(1,2260,48)="60///^S X=ARR(60)"
"RTN","OOPSGUI4",163,0)
 S DR(1,2260,51)="63///^S X=ARR(63)"
"RTN","OOPSGUI4",164,0)
 S DR(1,2260,54)="86///^S X=ARR(86)"
"RTN","OOPSGUI4",165,0)
 S DR(1,2260,57)="90///^S X=ARR(90)"
"RTN","OOPSGUI4",166,0)
 S DR(1,2260,58)="335///^S X=ARR(169)"
"RTN","OOPSGUI4",167,0)
 S DR(1,2260,59)="336///^S X=ARR(170)"
"RTN","OOPSGUI4",168,0)
 I ARR(52)="Injury" D
"RTN","OOPSGUI4",169,0)
 . S DR(1,2260,60)="111///^S X=ARR(19)"
"RTN","OOPSGUI4",170,0)
 . S DR(1,2260,63)="166///^S X=ARR(166)"
"RTN","OOPSGUI4",171,0)
 . S DR(1,2260,67)="167///^S X=ARR(167)"
"RTN","OOPSGUI4",172,0)
 I ARR(52)="Illness/Disease" D
"RTN","OOPSGUI4",173,0)
 . S DR(1,2260,60)="208///^S X=ARR(19)"
"RTN","OOPSGUI4",174,0)
 . S DR(1,2260,61)="334///^S X=ARR(168)"
"RTN","OOPSGUI4",175,0)
 ; patch 11 - new OSHA 300 questions
"RTN","OOPSGUI4",176,0)
 S DR(1,2260,70)="349///^S X=ARR(171)"
"RTN","OOPSGUI4",177,0)
 S DR(1,2260,71)="339///^S X=ARR(172)"
"RTN","OOPSGUI4",178,0)
 S DR(1,2260,72)="338///^S X=ARR(173)"
"RTN","OOPSGUI4",179,0)
 S DR(1,2260,73)="350///^S X=ARR(174)"
"RTN","OOPSGUI4",180,0)
 S DR(1,2260,74)="351///^S X=ARR(175)"
"RTN","OOPSGUI4",181,0)
 S DR(1,2260,75)="352///^S X=ARR(176)"
"RTN","OOPSGUI4",182,0)
 D ^DIE
"RTN","OOPSGUI4",183,0)
 D CASE^OOPSMBUL(IEN2260) D:(CAT=1)!(CAT=6) BOR^OOPSMBUL(IEN2260):$D(^VA(200,"SSN",SSN))
"RTN","OOPSGUI4",184,0)
 K DR S DIE="^OOPS(2260,",DA=IEN2260,DR="51///0" D ^DIE
"RTN","OOPSGUI4",185,0)
 K DIE,DR,DA
"RTN","OOPSGUI4",186,0)
 S (RESULTS,RESULTS(1))="OK" S:$G(ERROR)]"" (RESULTS,RESULTS(1))=ERROR
"RTN","OOPSGUI4",187,0)
 S RESULTS(2)=$P(^OOPS(2260,IEN2260,0),"^")
"RTN","OOPSGUI4",188,0)
 Q
"RTN","OOPSGUI4",189,0)
 ;
"RTN","OOPSGUI4",190,0)
DELETE ;Delete incomplete case
"RTN","OOPSGUI4",191,0)
 N DIK,DA
"RTN","OOPSGUI4",192,0)
 S DIK="^OOPS(2260,",DA=IEN2260
"RTN","OOPSGUI4",193,0)
 D ^DIK
"RTN","OOPSGUI4",194,0)
 Q
"RTN","OOPSGUI4",195,0)
 ;
"RTN","OOPSGUI4",196,0)
VAL(DA,FIELD,VALUE) ;Validate Input
"RTN","OOPSGUI4",197,0)
 ;  Input:   DA  - IEN of the ASISTS record
"RTN","OOPSGUI4",198,0)
 ;        FIELD  - field number for data to be validated
"RTN","OOPSGUI4",199,0)
 ;        VALUE  - data to be validated
"RTN","OOPSGUI4",200,0)
 ; Output:
"RTN","OOPSGUI4",201,0)
 ;        none
"RTN","OOPSGUI4",202,0)
 N X
"RTN","OOPSGUI4",203,0)
 D VAL^DIE(2260,DA,FIELD,"",VALUE,.X)
"RTN","OOPSGUI4",204,0)
 I X=U D
"RTN","OOPSGUI4",205,0)
 .S:$G(ERROR)]"" ERROR=ERROR_","
"RTN","OOPSGUI4",206,0)
 .S ERROR=$G(ERROR)_$$GET1^DID(2260,FIELD,"","LABEL")_U_VALUE
"RTN","OOPSGUI4",207,0)
 .; set the data to nil so filing will not bomb
"RTN","OOPSGUI4",208,0)
 .S ARR(FIELD)=""
"RTN","OOPSGUI4",209,0)
 Q
"RTN","OOPSGUI4",210,0)
DUP(RESULTS,SSN) ; Duplicate Case error checking broker call
"RTN","OOPSGUI4",211,0)
 ;  Input:    INPUT - SSN of current ASISTS case number
"RTN","OOPSGUI4",212,0)
 ; Output:  RESULTS - return array with case information
"RTN","OOPSGUI4",213,0)
 ;
"RTN","OOPSGUI4",214,0)
 N CN,DT,IEN,NM,TYPE
"RTN","OOPSGUI4",215,0)
 S IEN="",CN=0
"RTN","OOPSGUI4",216,0)
 S RESULTS(CN)="NO MATCHES FOUND"
"RTN","OOPSGUI4",217,0)
 F  S IEN=$O(^OOPS(2260,"SSN",SSN,IEN)) Q:IEN=""  D
"RTN","OOPSGUI4",218,0)
 . I $$GET1^DIQ(2260,IEN,51,"I") Q        ;case not open, don't include
"RTN","OOPSGUI4",219,0)
 . S NM=$$GET1^DIQ(2260,IEN,1)
"RTN","OOPSGUI4",220,0)
 . S TYPE=$$GET1^DIQ(2260,IEN,"3:.01")
"RTN","OOPSGUI4",221,0)
 . S DT=$$GET1^DIQ(2260,IEN,4)
"RTN","OOPSGUI4",222,0)
 . S RESULTS(CN)=NM_"  "_DT_"  "_TYPE
"RTN","OOPSGUI4",223,0)
 . S CN=CN+1,(NM,TYPE,DT)=""
"RTN","OOPSGUI4",224,0)
 Q
"RTN","OOPSGUI5")
0^6^B70896751
"RTN","OOPSGUI5",1,0)
OOPSGUI5 ;WIOFO/CVW-RPC routines ;10/11/01
"RTN","OOPSGUI5",2,0)
 ;;2.0;ASISTS;**2,8,7,11**;Jun 03, 2002
"RTN","OOPSGUI5",3,0)
EDIT(RESULTS,INPUT,ARR) ;
"RTN","OOPSGUI5",4,0)
 ;  Input: INPUT - IEN^FORM where IEN = ASISTS IEN or "NEW" if user
"RTN","OOPSGUI5",5,0)
 ;                 creating a new CA7. FORM="CA1","CA2","2162" or "CA7"
"RTN","OOPSGUI5",6,0)
 ;      SENDPARM - Array with data from client, saved into File 2260. 
"RTN","OOPSGUI5",7,0)
 ; Output:  RESULTS - Array containing the results of the store/save.
"RTN","OOPSGUI5",8,0)
 ;   NOTE:  Patch 5 llh - added FILE variable based on form being
"RTN","OOPSGUI5",9,0)
 ;                        passed in so that a CA7 could also be handled.
"RTN","OOPSGUI5",10,0)
 N IEN,FILE,FORM,DIE,DA,DR
"RTN","OOPSGUI5",11,0)
 S IEN=$P($G(INPUT),U,1),FORM=$P($G(INPUT),U,2)
"RTN","OOPSGUI5",12,0)
 I $G(FORM)="" S (RESULTS,RESULTS(1))="-2^No form type" Q
"RTN","OOPSGUI5",13,0)
 S FILE=2260 I FORM="CA7" S FILE=2264
"RTN","OOPSGUI5",14,0)
 I '$D(^OOPS(FILE,$G(IEN),0))&($G(IEN)'="NEW") D  Q
"RTN","OOPSGUI5",15,0)
 . S (RESULTS,RESULTS(1))="-1^IEN:"_IEN_" not found in file "_FILE
"RTN","OOPSGUI5",16,0)
 I "CA1^CA2^CA7^2162"'[FORM D  Q
"RTN","OOPSGUI5",17,0)
 . S (RESULTS,RESULTS(1))="-2^FORM:"_FORM_" not valid, must be CA1,CA2, or 2162"
"RTN","OOPSGUI5",18,0)
 S RESULTS(1)="UPDATE FAILED"
"RTN","OOPSGUI5",19,0)
 I FORM="CA1" D SAVECA1
"RTN","OOPSGUI5",20,0)
 I FORM="CA2" D SAVECA2
"RTN","OOPSGUI5",21,0)
 I FORM="2162" D SAVE2162
"RTN","OOPSGUI5",22,0)
 I FORM="CA7" D SAVECA7^OOPSGUID
"RTN","OOPSGUI5",23,0)
 Q
"RTN","OOPSGUI5",24,0)
SAVECA1 ;
"RTN","OOPSGUI5",25,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",26,0)
 S DR(1,2260,1)="53////^S X=ARR(7)"
"RTN","OOPSGUI5",27,0)
 S DR(1,2260,2)="53.1////^S X=ARR(8)"
"RTN","OOPSGUI5",28,0)
 S DR(1,2260,3)="60///^S X=ARR(14)"
"RTN","OOPSGUI5",29,0)
 S DR(1,2260,4)="61///^S X=ARR(15)"
"RTN","OOPSGUI5",30,0)
 S DR(1,2260,5)="62////^S X=ARR(16)"
"RTN","OOPSGUI5",31,0)
 S DR(1,2260,6)="70///^S X=ARR(22)"
"RTN","OOPSGUI5",32,0)
 S DR(1,2260,7)="73///^S X=ARR(25)"
"RTN","OOPSGUI5",33,0)
 S DR(1,2260,8)="12///^S X=ARR(36)"
"RTN","OOPSGUI5",34,0)
 S DR(1,2260,11)="8///^S X=ARR(39)"
"RTN","OOPSGUI5",35,0)
 S DR(1,2260,12)="9///^S X=ARR(40)"
"RTN","OOPSGUI5",36,0)
 S DR(1,2260,13)="10///^S X=ARR(41)"
"RTN","OOPSGUI5",37,0)
 S DR(1,2260,14)="11///^S X=ARR(42)"
"RTN","OOPSGUI5",38,0)
 S DR(1,2260,15)="107///^S X=ARR(43)"
"RTN","OOPSGUI5",39,0)
 S DR(1,2260,16)="108///^S X=ARR(44)"
"RTN","OOPSGUI5",40,0)
 S DR(1,2260,17)="109///^S X=ARR(45)"
"RTN","OOPSGUI5",41,0)
 S DR(1,2260,18)="110///^S X=ARR(46)"
"RTN","OOPSGUI5",42,0)
 S DR(1,2260,19)="111///^S X=ARR(47)"
"RTN","OOPSGUI5",43,0)
 S DR(1,2260,20)="112///^S X=ARR(48)"
"RTN","OOPSGUI5",44,0)
 S DR(1,2260,21)="113///^S X=ARR(49)"
"RTN","OOPSGUI5",45,0)
 S DR(1,2260,22)="114///^S X=ARR(50)"
"RTN","OOPSGUI5",46,0)
 S DR(1,2260,24)="123///^S X=ARR(60)"
"RTN","OOPSGUI5",47,0)
 S DR(1,2260,25)="124///^S X=ARR(61)"
"RTN","OOPSGUI5",48,0)
 S DR(1,2260,26)="126///^S X=ARR(62)"
"RTN","OOPSGUI5",49,0)
 S DR(1,2260,27)="130///^S X=ARR(63)"
"RTN","OOPSGUI5",50,0)
 S DR(1,2260,28)="131///^S X=ARR(64)"
"RTN","OOPSGUI5",51,0)
 S DR(1,2260,29)="132///^S X=ARR(65)"
"RTN","OOPSGUI5",52,0)
 S DR(1,2260,30)="133///^S X=ARR(66)"
"RTN","OOPSGUI5",53,0)
 S DR(1,2260,31)="134///^S X=ARR(67)"
"RTN","OOPSGUI5",54,0)
 S DR(1,2260,32)="138///^S X=ARR(70)"
"RTN","OOPSGUI5",55,0)
 S DR(1,2260,33)="139///^S X=ARR(71)"
"RTN","OOPSGUI5",56,0)
 S DR(1,2260,34)="140///^S X=ARR(72)"
"RTN","OOPSGUI5",57,0)
 S DR(1,2260,35)="141///^S X=ARR(73)"
"RTN","OOPSGUI5",58,0)
 S DR(1,2260,36)="142///^S X=ARR(74)"
"RTN","OOPSGUI5",59,0)
 D ^DIE I '($D(Y)=0) Q
"RTN","OOPSGUI5",60,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",61,0)
 S DR(1,2260,37)="143///^S X=ARR(75)"
"RTN","OOPSGUI5",62,0)
 S DR(1,2260,38)="144///^S X=ARR(76)"
"RTN","OOPSGUI5",63,0)
 S DR(1,2260,39)="145///^S X=ARR(77)"
"RTN","OOPSGUI5",64,0)
 S DR(1,2260,40)="146///^S X=ARR(78)"
"RTN","OOPSGUI5",65,0)
 S DR(1,2260,41)="147///^S X=ARR(79)"
"RTN","OOPSGUI5",66,0)
 S DR(1,2260,42)="148///^S X=ARR(80)"
"RTN","OOPSGUI5",67,0)
 S DR(1,2260,43)="149///^S X=ARR(81)"
"RTN","OOPSGUI5",68,0)
 S DR(1,2260,44)="150///^S X=ARR(82)"
"RTN","OOPSGUI5",69,0)
 S DR(1,2260,45)="151///^S X=ARR(83)"
"RTN","OOPSGUI5",70,0)
 S DR(1,2260,46)="152///^S X=ARR(84)"
"RTN","OOPSGUI5",71,0)
 S DR(1,2260,47)="153///^S X=ARR(85)"
"RTN","OOPSGUI5",72,0)
 S DR(1,2260,48)="154///^S X=ARR(86)"
"RTN","OOPSGUI5",73,0)
 S DR(1,2260,49)="155///^S X=ARR(87)"
"RTN","OOPSGUI5",74,0)
 S DR(1,2260,50)="156///^S X=ARR(88)"
"RTN","OOPSGUI5",75,0)
 S DR(1,2260,51)="157///^S X=ARR(89)"
"RTN","OOPSGUI5",76,0)
 S DR(1,2260,52)="158///^S X=ARR(90)"
"RTN","OOPSGUI5",77,0)
 S DR(1,2260,53)="159///^S X=ARR(91)"
"RTN","OOPSGUI5",78,0)
 S DR(1,2260,54)="160///^S X=ARR(92)"
"RTN","OOPSGUI5",79,0)
 S DR(1,2260,55)="161///^S X=ARR(93)"
"RTN","OOPSGUI5",80,0)
 S DR(1,2260,56)="162///^S X=ARR(94)"
"RTN","OOPSGUI5",81,0)
 S DR(1,2260,57)="163///^S X=ARR(95)"
"RTN","OOPSGUI5",82,0)
 S DR(1,2260,58)="165.1///^S X=ARR(96)"
"RTN","OOPSGUI5",83,0)
 S DR(1,2260,59)="165.2///^S X=ARR(97)"
"RTN","OOPSGUI5",84,0)
 S DR(1,2260,60)="166///^S X=ARR(98)"
"RTN","OOPSGUI5",85,0)
 S DR(1,2260,61)="167///^S X=ARR(99)"
"RTN","OOPSGUI5",86,0)
 S DR(1,2260,62)="168///^S X=ARR(100)"
"RTN","OOPSGUI5",87,0)
 S DR(1,2260,63)="172///^S X=ARR(104)"
"RTN","OOPSGUI5",88,0)
 S DR(1,2260,64)="173///^S X=ARR(105)"
"RTN","OOPSGUI5",89,0)
 S DR(1,2260,65)="173.1///^S X=ARR(106)"
"RTN","OOPSGUI5",90,0)
 S DR(1,2260,66)="174///^S X=ARR(107)"
"RTN","OOPSGUI5",91,0)
 S DR(1,2260,67)="175///^S X=ARR(108)"
"RTN","OOPSGUI5",92,0)
 S DR(1,2260,68)="176///^S X=ARR(109)"
"RTN","OOPSGUI5",93,0)
 S DR(1,2260,69)="177///^S X=ARR(110)"
"RTN","OOPSGUI5",94,0)
 S DR(1,2260,70)="178///^S X=ARR(111)"
"RTN","OOPSGUI5",95,0)
 S DR(1,2260,71)="179///^S X=ARR(112)"
"RTN","OOPSGUI5",96,0)
 S DR(1,2260,72)="180///^S X=ARR(113)"
"RTN","OOPSGUI5",97,0)
 S DR(1,2260,73)="181///^S X=ARR(114)"
"RTN","OOPSGUI5",98,0)
 S DR(1,2260,74)="182///^S X=ARR(115)"
"RTN","OOPSGUI5",99,0)
 S DR(1,2260,75)="183///^S X=ARR(116)"
"RTN","OOPSGUI5",100,0)
 S DR(1,2260,76)="184///^S X=ARR(117)"
"RTN","OOPSGUI5",101,0)
 S DR(1,2260,77)="185///^S X=ARR(118)"
"RTN","OOPSGUI5",102,0)
 S DR(1,2260,78)="330///^S X=ARR(119)"
"RTN","OOPSGUI5",103,0)
 S DR(1,2260,79)="331///^S X=ARR(120)"
"RTN","OOPSGUI5",104,0)
 S DR(1,2260,80)="332///^S X=ARR(121)"
"RTN","OOPSGUI5",105,0)
 ; patch 11 - added REASON FOR DISPUTE CODE
"RTN","OOPSGUI5",106,0)
 S DR(1,2260,81)="347///^S X=ARR(122)"
"RTN","OOPSGUI5",107,0)
 D ^DIE I $D(Y)=0 S RESULTS(1)="UPDATE COMPLETED"
"RTN","OOPSGUI5",108,0)
 Q
"RTN","OOPSGUI5",109,0)
SAVECA2 ;
"RTN","OOPSGUI5",110,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",111,0)
 S DR(1,2260,1)="60///^S X=ARR(14)"
"RTN","OOPSGUI5",112,0)
 S DR(1,2260,5)="61///^S X=ARR(15)"
"RTN","OOPSGUI5",113,0)
 S DR(1,2260,7)="62////^S X=ARR(16)"
"RTN","OOPSGUI5",114,0)
 S DR(1,2260,10)="70///^S X=ARR(22)"
"RTN","OOPSGUI5",115,0)
 S DR(1,2260,15)="73///^S X=ARR(25)"
"RTN","OOPSGUI5",116,0)
 S DR(1,2260,20)="12///^S X=ARR(38)"
"RTN","OOPSGUI5",117,0)
 S DR(1,2260,25)="8///^S X=ARR(41)"
"RTN","OOPSGUI5",118,0)
 S DR(1,2260,30)="9///^S X=ARR(42)"
"RTN","OOPSGUI5",119,0)
 S DR(1,2260,35)="10///^S X=ARR(43)"
"RTN","OOPSGUI5",120,0)
 S DR(1,2260,40)="11///^S X=ARR(44)"
"RTN","OOPSGUI5",121,0)
 S DR(1,2260,41)="126///^S X=ARR(36)"
"RTN","OOPSGUI5",122,0)
 S DR(1,2260,45)="207///^S X=ARR(45)"
"RTN","OOPSGUI5",123,0)
 S DR(1,2260,50)="208///^S X=ARR(46)"
"RTN","OOPSGUI5",124,0)
 S DR(1,2260,55)="209///^S X=ARR(47)"
"RTN","OOPSGUI5",125,0)
 S DR(1,2260,60)="210///^S X=ARR(48)"
"RTN","OOPSGUI5",126,0)
 S DR(1,2260,65)="211///^S X=ARR(49)"
"RTN","OOPSGUI5",127,0)
 S DR(1,2260,70)="212///^S X=ARR(50)"
"RTN","OOPSGUI5",128,0)
 S DR(1,2260,75)="213///^S X=ARR(51)"
"RTN","OOPSGUI5",129,0)
 S DR(1,2260,80)="214///^S X=ARR(52)"
"RTN","OOPSGUI5",130,0)
 D ^DIE I '($D(Y)=0) Q
"RTN","OOPSGUI5",131,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",132,0)
 S DR(1,2260,85)="215///^S X=ARR(53)"
"RTN","OOPSGUI5",133,0)
 S DR(1,2260,90)="225///^S X=ARR(57)"
"RTN","OOPSGUI5",134,0)
 S DR(1,2260,95)="226///^S X=ARR(58)"
"RTN","OOPSGUI5",135,0)
 S DR(1,2260,100)="227///^S X=ARR(59)"
"RTN","OOPSGUI5",136,0)
 S DR(1,2260,105)="230///^S X=ARR(60)"
"RTN","OOPSGUI5",137,0)
 S DR(1,2260,110)="231///^S X=ARR(61)"
"RTN","OOPSGUI5",138,0)
 S DR(1,2260,115)="232///^S X=ARR(62)"
"RTN","OOPSGUI5",139,0)
 S DR(1,2260,120)="233///^S X=ARR(63)"
"RTN","OOPSGUI5",140,0)
 S DR(1,2260,125)="234///^S X=ARR(64)"
"RTN","OOPSGUI5",141,0)
 S DR(1,2260,130)="237///^S X=ARR(67)"
"RTN","OOPSGUI5",142,0)
 S DR(1,2260,135)="238///^S X=ARR(68)"
"RTN","OOPSGUI5",143,0)
 S DR(1,2260,140)="239///^S X=ARR(69)"
"RTN","OOPSGUI5",144,0)
 S DR(1,2260,145)="240///^S X=ARR(70)"
"RTN","OOPSGUI5",145,0)
 S DR(1,2260,150)="241///^S X=ARR(71)"
"RTN","OOPSGUI5",146,0)
 S DR(1,2260,155)="242///^S X=ARR(72)"
"RTN","OOPSGUI5",147,0)
 S DR(1,2260,160)="243///^S X=ARR(73)"
"RTN","OOPSGUI5",148,0)
 S DR(1,2260,165)="244///^S X=ARR(74)"
"RTN","OOPSGUI5",149,0)
 S DR(1,2260,170)="245///^S X=ARR(75)"
"RTN","OOPSGUI5",150,0)
 S DR(1,2260,175)="246///^S X=ARR(76)"
"RTN","OOPSGUI5",151,0)
 S DR(1,2260,180)="247///^S X=ARR(77)"
"RTN","OOPSGUI5",152,0)
 S DR(1,2260,185)="248///^S X=ARR(78)"
"RTN","OOPSGUI5",153,0)
 S DR(1,2260,190)="249///^S X=ARR(79)"
"RTN","OOPSGUI5",154,0)
 S DR(1,2260,192)="250///^S X=ARR(80)"
"RTN","OOPSGUI5",155,0)
 S DR(1,2260,195)="251///^S X=ARR(81)"
"RTN","OOPSGUI5",156,0)
 S DR(1,2260,200)="252///^S X=ARR(82)"
"RTN","OOPSGUI5",157,0)
 S DR(1,2260,205)="253///^S X=ARR(83)"
"RTN","OOPSGUI5",158,0)
 D ^DIE I '($D(Y)=0) Q
"RTN","OOPSGUI5",159,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",160,0)
 S DR(1,2260,210)="254///^S X=ARR(84)"
"RTN","OOPSGUI5",161,0)
 S DR(1,2260,215)="255///^S X=ARR(85)"
"RTN","OOPSGUI5",162,0)
 S DR(1,2260,220)="256///^S X=ARR(86)"
"RTN","OOPSGUI5",163,0)
 S DR(1,2260,225)="258///^S X=ARR(87)"
"RTN","OOPSGUI5",164,0)
 S DR(1,2260,230)="259///^S X=ARR(88)"
"RTN","OOPSGUI5",165,0)
 S DR(1,2260,235)="260///^S X=ARR(89)"
"RTN","OOPSGUI5",166,0)
 S DR(1,2260,240)="261///^S X=ARR(90)"
"RTN","OOPSGUI5",167,0)
 S DR(1,2260,245)="262///^S X=ARR(91)"
"RTN","OOPSGUI5",168,0)
 S DR(1,2260,250)="263///^S X=ARR(92)"
"RTN","OOPSGUI5",169,0)
 S DR(1,2260,255)="264///^S X=ARR(93)"
"RTN","OOPSGUI5",170,0)
 S DR(1,2260,260)="268///^S X=ARR(97)"
"RTN","OOPSGUI5",171,0)
 S DR(1,2260,265)="269///^S X=ARR(98)"
"RTN","OOPSGUI5",172,0)
 S DR(1,2260,270)="269.1///^S X=ARR(99)"
"RTN","OOPSGUI5",173,0)
 S DR(1,2260,275)="270///^S X=ARR(100)"
"RTN","OOPSGUI5",174,0)
 ; Patch 5 llh - added new fields
"RTN","OOPSGUI5",175,0)
 S DR(1,2260,276)="330///^S X=ARR(101)"
"RTN","OOPSGUI5",176,0)
 S DR(1,2260,277)="331///^S X=ARR(102)"
"RTN","OOPSGUI5",177,0)
 D ^DIE I $D(Y)=0 S RESULTS(1)="UPDATE COMPLETED"
"RTN","OOPSGUI5",178,0)
 Q
"RTN","OOPSGUI5",179,0)
SAVE2162 ;
"RTN","OOPSGUI5",180,0)
 K DR S DIE="^OOPS(2260,",DA=IEN,DR=""
"RTN","OOPSGUI5",181,0)
 S DR(1,2260,1)="3///^S X=ARR(3)"
"RTN","OOPSGUI5",182,0)
 S DR(1,2260,2)="5///^S X=ARR(5)"
"RTN","OOPSGUI5",183,0)
 S DR(1,2260,3)="6///^S X=ARR(6)"
"RTN","OOPSGUI5",184,0)
 S DR(1,2260,4)="7///^S X=ARR(7)"
"RTN","OOPSGUI5",185,0)
 S DR(1,2260,5)="8///^S X=ARR(8)"
"RTN","OOPSGUI5",186,0)
 S DR(1,2260,7)="9///^S X=ARR(9)"
"RTN","OOPSGUI5",187,0)
 S DR(1,2260,9)="10///^S X=ARR(10)"
"RTN","OOPSGUI5",188,0)
 S DR(1,2260,12)="11///^S X=ARR(11)"
"RTN","OOPSGUI5",189,0)
 S DR(1,2260,15)="12///^S X=ARR(12)"
"RTN","OOPSGUI5",190,0)
 S DR(1,2260,18)="13////^S X=ARR(13)"
"RTN","OOPSGUI5",191,0)
 S DR(1,2260,21)="14///^S X=ARR(14)"
"RTN","OOPSGUI5",192,0)
 S DR(1,2260,24)="15///^S X=ARR(15)"
"RTN","OOPSGUI5",193,0)
 S DR(1,2260,27)="16///^S X=ARR(16)"
"RTN","OOPSGUI5",194,0)
 S DR(1,2260,30)="17///^S X=ARR(17)"
"RTN","OOPSGUI5",195,0)
 S DR(1,2260,33)="18///^S X=ARR(18)"
"RTN","OOPSGUI5",196,0)
 S DR(1,2260,36)="26///^S X=ARR(19)"
"RTN","OOPSGUI5",197,0)
 S DR(1,2260,39)="27////^S X=ARR(20)"
"RTN","OOPSGUI5",198,0)
 S DR(1,2260,42)="29///^S X=ARR(21)"
"RTN","OOPSGUI5",199,0)
 S DR(1,2260,45)="29.5///^S X=ARR(22)"
"RTN","OOPSGUI5",200,0)
 S DR(1,2260,48)="30///^S X=ARR(23)"
"RTN","OOPSGUI5",201,0)
 S DR(1,2260,51)="30.1///^S X=ARR(24)"
"RTN","OOPSGUI5",202,0)
 S DR(1,2260,54)="31///^S X=ARR(25)"
"RTN","OOPSGUI5",203,0)
 S DR(1,2260,57)="32///^S X=ARR(26)"
"RTN","OOPSGUI5",204,0)
 S DR(1,2260,60)="33///^S X=ARR(27)"
"RTN","OOPSGUI5",205,0)
 S DR(1,2260,63)="34///^S X=ARR(28)"
"RTN","OOPSGUI5",206,0)
 S DR(1,2260,66)="35///^S X=ARR(29)"
"RTN","OOPSGUI5",207,0)
 S DR(1,2260,69)="36///^S X=ARR(30)"
"RTN","OOPSGUI5",208,0)
 S DR(1,2260,72)="37///^S X=ARR(31)"
"RTN","OOPSGUI5",209,0)
 S DR(1,2260,75)="38///^S X=ARR(32)"
"RTN","OOPSGUI5",210,0)
 S DR(1,2260,78)="41///^S X=ARR(33)"
"RTN","OOPSGUI5",211,0)
 S DR(1,2260,81)="42///^S X=ARR(34)"
"RTN","OOPSGUI5",212,0)
 S DR(1,2260,84)="42.5///^S X=ARR(35)"
"RTN","OOPSGUI5",213,0)
 S DR(1,2260,87)="43///^S X=ARR(36)"
"RTN","OOPSGUI5",214,0)
 S DR(1,2260,90)="53////^S X=ARR(45)"
"RTN","OOPSGUI5",215,0)
 S DR(1,2260,93)="53.1////^S X=ARR(46)"
"RTN","OOPSGUI5",216,0)
 S DR(1,2260,96)="60///^S X=ARR(52)"
"RTN","OOPSGUI5",217,0)
 S DR(1,2260,99)="61///^S X=ARR(53)"
"RTN","OOPSGUI5",218,0)
 S DR(1,2260,102)="62///^S X=ARR(54)"
"RTN","OOPSGUI5",219,0)
 S DR(1,2260,105)="63///^S X=ARR(55)"
"RTN","OOPSGUI5",220,0)
 S DR(1,2260,108)="70///^S X=ARR(60)"
"RTN","OOPSGUI5",221,0)
 S DR(1,2260,111)="73///^S X=ARR(63)"
"RTN","OOPSGUI5",222,0)
 S DR(1,2260,114)="82///^S X=ARR(72)"
"RTN","OOPSGUI5",223,0)
 S DR(1,2260,117)="83////^S X=ARR(73)"
"RTN","OOPSGUI5",224,0)
 S DR(1,2260,120)="84///^S X=ARR(74)"
"RTN","OOPSGUI5",225,0)
 S DR(1,2260,123)="85///^S X=ARR(75)"
"RTN","OOPSGUI5",226,0)
 S DR(1,2260,126)="86///^S X=ARR(76)"
"RTN","OOPSGUI5",227,0)
 S DR(1,2260,129)="87///^S X=ARR(77)"
"RTN","OOPSGUI5",228,0)
 S DR(1,2260,132)="88///^S X=ARR(78)"
"RTN","OOPSGUI5",229,0)
 S DR(1,2260,135)="89///^S X=ARR(79)"
"RTN","OOPSGUI5",230,0)
 S DR(1,2260,136)="335///^S X=ARR(85)"
"RTN","OOPSGUI5",231,0)
 S DR(1,2260,138)="336///^S X=ARR(86)"
"RTN","OOPSGUI5",232,0)
 S DR(1,2260,140)="337///^S X=ARR(87)"
"RTN","OOPSGUI5",233,0)
 S DR(1,2260,142)="338///^S X=ARR(88)"
"RTN","OOPSGUI5",234,0)
 S DR(1,2260,144)="339///^S X=ARR(89)"
"RTN","OOPSGUI5",235,0)
 S DR(1,2260,146)="340///^S X=ARR(90)"
"RTN","OOPSGUI5",236,0)
 S DR(1,2260,148)="341///^S X=ARR(91)"
"RTN","OOPSGUI5",237,0)
 S DR(1,2260,150)="342///^S X=ARR(92)"
"RTN","OOPSGUI5",238,0)
 S DR(1,2260,152)="343///^S X=ARR(93)"
"RTN","OOPSGUI5",239,0)
 S DR(1,2260,154)="344///^S X=ARR(94)"
"RTN","OOPSGUI5",240,0)
 S DR(1,2260,156)="345///^S X=ARR(95)"
"RTN","OOPSGUI5",241,0)
 S DR(1,2260,158)="346///^S X=ARR(96)"
"RTN","OOPSGUI5",242,0)
 S DR(1,2260,159)="334///^S X=ARR(97)"
"RTN","OOPSGUI5",243,0)
 S DR(1,2260,160)="348///^S X=ARR(98)"
"RTN","OOPSGUI5",244,0)
 S DR(1,2260,161)="349///^S X=ARR(99)"
"RTN","OOPSGUI5",245,0)
 S DR(1,2260,162)="350///^S X=ARR(100)"
"RTN","OOPSGUI5",246,0)
 S DR(1,2260,163)="351///^S X=ARR(101)"
"RTN","OOPSGUI5",247,0)
 S DR(1,2260,164)="352///^S X=ARR(102)"
"RTN","OOPSGUI5",248,0)
 D ^DIE I $D(Y)=0 S RESULTS(1)="UPDATE COMPLETED"
"RTN","OOPSGUI5",249,0)
 Q
"RTN","OOPSGUI8")
0^3^B46205454
"RTN","OOPSGUI8",1,0)
OOPSGUI8 ;WIOFO/LLH-RPC Broker calls for GUI ;10/23/01
"RTN","OOPSGUI8",2,0)
 ;;2.0;ASISTS;**8,7,11**;Jun 03, 2002
"RTN","OOPSGUI8",3,0)
 ;
"RTN","OOPSGUI8",4,0)
EN1(RESULTS,INPUT) ; Entry point for routine
"RTN","OOPSGUI8",5,0)
 ;  Input:  INPUT contains the IEN of the ASISTS record and the 
"RTN","OOPSGUI8",6,0)
 ;          calling menu, in the format IEN^CALLING MENU
"RTN","OOPSGUI8",7,0)
 ; Output:  RESULTS contains status messages back to the client. 
"RTN","OOPSGUI8",8,0)
 ;          RESULTS(0) will = either 1 or 0.  1 if ok for form to be
"RTN","OOPSGUI8",9,0)
 ;          signed by calling menu option, 0 if not ok.  The RESULTS
"RTN","OOPSGUI8",10,0)
 ;          array with status message will start at 1.
"RTN","OOPSGUI8",11,0)
 ;
"RTN","OOPSGUI8",12,0)
 N CALL,CN,DIC,IEN,FORM,PRM1,PRM2,SIGN,Y
"RTN","OOPSGUI8",13,0)
 S CN=1
"RTN","OOPSGUI8",14,0)
 S IEN=$P($G(INPUT),U),CALL=$P($G(INPUT),U,2)
"RTN","OOPSGUI8",15,0)
 S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSGUI8",16,0)
 S FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSGUI8",17,0)
 S PRM1=$S(CALL="O":"Safety Officer",CALL="H":"Occupational Health",1:0)
"RTN","OOPSGUI8",18,0)
 S PRM2=PRM1_" approves the WCP signing for the Employee: "
"RTN","OOPSGUI8",19,0)
 S SIGN=""
"RTN","OOPSGUI8",20,0)
 I '$G(IEN)!($G(FORM)="")!($G(CALL)="") D  Q
"RTN","OOPSGUI8",21,0)
 . S RESULTS(0)=0
"RTN","OOPSGUI8",22,0)
 . S RESULTS(1)="Missing Information, Cannot Continue"
"RTN","OOPSGUI8",23,0)
 I CALL="W" G WCPS4E
"RTN","OOPSGUI8",24,0)
 S RESULTS(0)=$$VALID()
"RTN","OOPSGUI8",25,0)
 I RESULTS(0) S RESULTS(CN)=PRM2,CN=CN+1
"RTN","OOPSGUI8",26,0)
 G EXIT
"RTN","OOPSGUI8",27,0)
WCPS4E ; allow WCP to sign for employee if all approvals given
"RTN","OOPSGUI8",28,0)
 N CONT,EHS,SIGN,SOS,VALID,VIEW
"RTN","OOPSGUI8",29,0)
 S SIGN=0,VALID=0,VIEW=1
"RTN","OOPSGUI8",30,0)
 S SOS=$$GET1^DIQ(2260,IEN,76,"I")
"RTN","OOPSGUI8",31,0)
 S EHS=$$GET1^DIQ(2260,IEN,79,"I")
"RTN","OOPSGUI8",32,0)
 S CONT=$S(DUZ=SOS:"S",DUZ=EHS:"H",1:"")
"RTN","OOPSGUI8",33,0)
 I (CONT="S")!(CONT="H") D
"RTN","OOPSGUI8",34,0)
 . S RESULTS(CN)="You have approved as "_$S(CONT="S":"Safety Officer",CONT="H":"Occ Health Rep",1:"")
"RTN","OOPSGUI8",35,0)
 . S RESULTS(CN)=RESULTS(0)_" and cannot sign as Employee.",CN=CN+1
"RTN","OOPSGUI8",36,0)
 . S RESULTS(CN)="Three different individuals must be involved."
"RTN","OOPSGUI8",37,0)
 . S VIEW=0
"RTN","OOPSGUI8",38,0)
 I '$G(SOS) S VIEW=0 D
"RTN","OOPSGUI8",39,0)
 . S RESULTS(CN)="Safety Officer has not approved WCP signing for employee.",CN=CN+1
"RTN","OOPSGUI8",40,0)
 I '$G(EHS) S VIEW=0 D
"RTN","OOPSGUI8",41,0)
 . S RESULTS(CN)="Occupational Health has not approved WCP signing for employee.",CN=CN+1
"RTN","OOPSGUI8",42,0)
 I VIEW D
"RTN","OOPSGUI8",43,0)
 . ; Allow clearing WCP signature, employee may be able to sign
"RTN","OOPSGUI8",44,0)
 . I $$GET1^DIQ(2260,IEN,119,"I") D CLRES^OOPSUTL1(IEN,"E",FORM)
"RTN","OOPSGUI8",45,0)
 . D VALIDATE^OOPSUTL4(IEN,FORM,"E",.VALID)
"RTN","OOPSGUI8",46,0)
 . I 'VALID S RESULTS(CN)="All required fields not completed",CN=CN+1 Q
"RTN","OOPSGUI8",47,0)
 . D EMP^OOPSVAL1
"RTN","OOPSGUI8",48,0)
EXIT ;
"RTN","OOPSGUI8",49,0)
 Q
"RTN","OOPSGUI8",50,0)
VALID() ; make sure same person is not signing for both safety and EH and if
"RTN","OOPSGUI8",51,0)
 ; signed from menu option being called not needed again - so quit
"RTN","OOPSGUI8",52,0)
 N CONT,EHAPP,ERR,SOAPP,VALID
"RTN","OOPSGUI8",53,0)
 S VALID=1,ERR=0
"RTN","OOPSGUI8",54,0)
 S SOAPP=$P($G(^OOPS(2260,IEN,"WCSE")),U)
"RTN","OOPSGUI8",55,0)
 S EHAPP=$P($G(^OOPS(2260,IEN,"WCSE")),U,4)
"RTN","OOPSGUI8",56,0)
 S CONT=$S(DUZ=SOAPP:"S",DUZ=EHAPP:"H",1:"")
"RTN","OOPSGUI8",57,0)
 I CALL="O" D
"RTN","OOPSGUI8",58,0)
 . I CONT="S" S ERR=1
"RTN","OOPSGUI8",59,0)
 . I $G(EHAPP)=DUZ S ERR=2
"RTN","OOPSGUI8",60,0)
 . I $G(SOAPP)&($G(CONT)="") S ERR=3
"RTN","OOPSGUI8",61,0)
 I CALL="H" D
"RTN","OOPSGUI8",62,0)
 . I CONT="H" S ERR=1
"RTN","OOPSGUI8",63,0)
 . I $G(SOAPP)=DUZ S ERR=2
"RTN","OOPSGUI8",64,0)
 . I $G(EHAPP)&($G(CONT)="") S ERR=3
"RTN","OOPSGUI8",65,0)
 I ERR=1 D
"RTN","OOPSGUI8",66,0)
 . S RESULTS(CN)="You have signed as "
"RTN","OOPSGUI8",67,0)
 . S RESULTS(CN)=RESULTS(CN)_PRM1
"RTN","OOPSGUI8",68,0)
 . S RESULTS(CN)=RESULTS(CN)_", Cannot sign."
"RTN","OOPSGUI8",69,0)
 . S CN=CN+1,VALID=0
"RTN","OOPSGUI8",70,0)
 I ERR=2 D
"RTN","OOPSGUI8",71,0)
 . S RESULTS(CN)="You have already signed as "
"RTN","OOPSGUI8",72,0)
 . S RESULTS(CN)=RESULTS(CN)_$S(CALL="O":"Occupational Health",CALL="H":"Safety Officer",1:0)_".",CN=CN+1
"RTN","OOPSGUI8",73,0)
 . S RESULTS(CN)="Both signatures cannot be made by the same person."
"RTN","OOPSGUI8",74,0)
 . S CN=CN+1,VALID=0
"RTN","OOPSGUI8",75,0)
 I ERR=3 D
"RTN","OOPSGUI8",76,0)
 . S RESULTS(CN)=PRM1_" has already signed, re-signing is not required."
"RTN","OOPSGUI8",77,0)
 . S CN=CN+1,VALID=0
"RTN","OOPSGUI8",78,0)
 Q VALID
"RTN","OOPSGUI8",79,0)
CSIGN(RESULTS,IEN,FORM,CALL) ; Clears Signature from form
"RTN","OOPSGUI8",80,0)
 ;
"RTN","OOPSGUI8",81,0)
 ;   Input:     IEN - IEN of the ASISTS case to have the
"RTN","OOPSGUI8",82,0)
 ;                    signature cleared from
"RTN","OOPSGUI8",83,0)
 ;             FORM - the Form to clear the signature from, 2162,
"RTN","OOPSGUI8",84,0)
 ;                    CA1 or CA2 or CA7 (CA7 added V2 patch 5)
"RTN","OOPSGUI8",85,0)
 ;             CALL - the calling menu
"RTN","OOPSGUI8",86,0)
 ;  Output: RESULTS - single value with status message
"RTN","OOPSGUI8",87,0)
 ;
"RTN","OOPSGUI8",88,0)
 S RESULTS="Clearing Signatures"
"RTN","OOPSGUI8",89,0)
 I ('$G(IEN))!($G(FORM)="")!($G(CALL)="") S RESULTS="FAILED"
"RTN","OOPSGUI8",90,0)
 ; V2 Patch 5 llh - added logic for CA7
"RTN","OOPSGUI8",91,0)
 I FORM'="CA7" D CLRES^OOPSUTL1(IEN,CALL,FORM)
"RTN","OOPSGUI8",92,0)
 I FORM="CA7" D CLRES^OOPSGUIS(IEN,CALL,FORM)
"RTN","OOPSGUI8",93,0)
 S RESULTS="CLEARED"
"RTN","OOPSGUI8",94,0)
 Q
"RTN","OOPSGUI8",95,0)
DTFC(RESULTS,DATE,FLAG) ; Reformat Date/Time
"RTN","OOPSGUI8",96,0)
 ;  Input  - Date to be reformatted
"RTN","OOPSGUI8",97,0)
 ;         - Flag to be used
"RTN","OOPSGUI8",98,0)
 ; Output  - RESULTS contains the reformatted date
"RTN","OOPSGUI8",99,0)
 ;
"RTN","OOPSGUI8",100,0)
 N X,%DT            ; patch 11 - added %DT
"RTN","OOPSGUI8",101,0)
 S FLAG=+$G(FLAG)
"RTN","OOPSGUI8",102,0)
 I DATE=""!(FLAG="") S (RESULTS,RESULTS(1))="" Q
"RTN","OOPSGUI8",103,0)
 S X=DATE,%DT="T" D ^%DT
"RTN","OOPSGUI8",104,0)
 S DATE=Y,X="NOW"
"RTN","OOPSGUI8",105,0)
 D ^%DT
"RTN","OOPSGUI8",106,0)
 I $S(DATE=-1:1,FLAG<0:Y<DATE,FLAG>0:DATE>Y,1:0) S DATE=-1
"RTN","OOPSGUI8",107,0)
 I DATE=-1 S (RESULTS,RESULTS(1))="DATE ERROR" Q
"RTN","OOPSGUI8",108,0)
 S (RESULTS,RESULTS(1))=$$FMTE^XLFDT(DATE,5)
"RTN","OOPSGUI8",109,0)
 Q
"RTN","OOPSGUI8",110,0)
GETNOI(RESULTS,OPT) ; Broker Call to retrieve NOI Codes
"RTN","OOPSGUI8",111,0)
 ;  Input:     OPT - Either CA1 or CA2 to indicate which codes should be
"RTN","OOPSGUI8",112,0)
 ;                   retrieved.  If CA1 must start with T, otherwise CA2
"RTN","OOPSGUI8",113,0)
 ; Output: RESULTS - NOI Description and Code
"RTN","OOPSGUI8",114,0)
 N NOI,DES,CODE,CN
"RTN","OOPSGUI8",115,0)
 S DES="",CN=0
"RTN","OOPSGUI8",116,0)
 F  S DES=$O(^OOPS(2263.3,"B",DES)) Q:DES=""  S NOI="" F  S NOI=$O(^OOPS(2263.3,"B",DES,NOI)) Q:NOI=""  D
"RTN","OOPSGUI8",117,0)
 . S CODE=$P(^OOPS(2263.3,NOI,0),U,2)
"RTN","OOPSGUI8",118,0)
 . I OPT="CA1",($E(CODE,1)="T") S RESULTS(CN)=NOI_":"_DES_" - "_CODE
"RTN","OOPSGUI8",119,0)
 . I OPT="CA2",($E(CODE,1)'="T") S RESULTS(CN)=NOI_":"_DES_" - "_CODE
"RTN","OOPSGUI8",120,0)
 . S CN=CN+1
"RTN","OOPSGUI8",121,0)
 Q
"RTN","OOPSGUI8",122,0)
ZIPCHK(RESULTS,DATA) ; patch 5 - validate zip code against file 5.12
"RTN","OOPSGUI8",123,0)
 ;                 to ensure zip in file and has correct state.
"RTN","OOPSGUI8",124,0)
 ;
"RTN","OOPSGUI8",125,0)
 ;  Input:    DATA - contains ZIP CODE^STATE NAME
"RTN","OOPSGUI8",126,0)
 ; Output: RESULTS - returns message with validation results
"RTN","OOPSGUI8",127,0)
 ;
"RTN","OOPSGUI8",128,0)
 N STATE,VALSTATE,VALZIP,ZIP,ZZIP
"RTN","OOPSGUI8",129,0)
 S ZIP=$P($G(DATA),U,1),STATE=$P($G(DATA),U,2)
"RTN","OOPSGUI8",130,0)
 S RESULTS=""
"RTN","OOPSGUI8",131,0)
 I '$G(ZIP)!($G(STATE)="") S RESULTS="MISSING PARAMETERS" Q
"RTN","OOPSGUI8",132,0)
 D POSTAL^XIPUTIL(ZIP,.ZZIP)
"RTN","OOPSGUI8",133,0)
 I $G(ZZIP("ERROR"))'="" S RESULTS="ZIP CODE NOT FOUND" Q
"RTN","OOPSGUI8",134,0)
 I STATE'=ZZIP("STATE") S RESULTS="STATE MISMATCH ON ZIP" Q
"RTN","OOPSGUI8",135,0)
 S RESULTS="VALID ZIP/STATE"
"RTN","OOPSGUI8",136,0)
 Q
"RTN","OOPSGUI8",137,0)
AMEND(RESULTS,OLDIEN) ; File new Amended Case
"RTN","OOPSGUI8",138,0)
 ;  Input:  OLDIEN - The ASISTS IEN for the case to have an
"RTN","OOPSGUI8",139,0)
 ;                   amendment created for.
"RTN","OOPSGUI8",140,0)
 ; Output: RESULTS - Single value with the new case number
"RTN","OOPSGUI8",141,0)
 ;
"RTN","OOPSGUI8",142,0)
 N DLAYGO
"RTN","OOPSGUI8",143,0)
 Q:$P(^OOPS(2260,OLDIEN,0),"^",6)'=0   ;defensive code, should not occur
"RTN","OOPSGUI8",144,0)
 S NUM=$P(^OOPS(2260,OLDIEN,0),U,1),SUF=$E(NUM,11)
"RTN","OOPSGUI8",145,0)
 S $P(^OOPS(2260,OLDIEN,0),U,6)=3
"RTN","OOPSGUI8",146,0)
 S NUM=$E(NUM,1,10)_$S(SUF="":"A",1:$CHAR($ASCII(SUF)+1))
"RTN","OOPSGUI8",147,0)
 K DD,DO
"RTN","OOPSGUI8",148,0)
 S DLAYGO=2260,DIC="^OOPS(2260,",DIC(0)="QLZ",X=NUM
"RTN","OOPSGUI8",149,0)
 D FILE^DICN G:Y=-1 DONE
"RTN","OOPSGUI8",150,0)
 S NEWIEN=+Y
"RTN","OOPSGUI8",151,0)
 MERGE ^OOPS(2260,NEWIEN)=^OOPS(2260,OLDIEN)
"RTN","OOPSGUI8",152,0)
 S OOP=^OOPS(2260,NEWIEN,0)
"RTN","OOPSGUI8",153,0)
 S $P(OOP,U,1)=NUM,$P(OOP,U,6)=0,$P(OOP,U,11)="",$P(OOP,U,19)=""
"RTN","OOPSGUI8",154,0)
 S ^OOPS(2260,NEWIEN,0)=OOP,$P(^OOPS(2260,NEWIEN,"CA"),U,6)=""
"RTN","OOPSGUI8",155,0)
 S DIK="^OOPS(2260,",DA=NEWIEN D IX^DIK
"RTN","OOPSGUI8",156,0)
 K ^OOPS(2260,NEWIEN,"2162ES")
"RTN","OOPSGUI8",157,0)
 K ^OOPS(2260,NEWIEN,"CA1ES")
"RTN","OOPSGUI8",158,0)
 K ^OOPS(2260,NEWIEN,"CA2ES")
"RTN","OOPSGUI8",159,0)
 N IEN,X,WCPDUZ,WOK
"RTN","OOPSGUI8",160,0)
 S WCPDUZ=$P($G(^OOPS(2260,NEWIEN,"WCES")),U)
"RTN","OOPSGUI8",161,0)
 I $G(WCPDUZ) S WOK=1,X=WCPDUZ,IEN=OLDIEN D WK^OOPSUTL1
"RTN","OOPSGUI8",162,0)
 K ^OOPS(2260,NEWIEN,"WCES")
"RTN","OOPSGUI8",163,0)
 S RESULTS=NUM
"RTN","OOPSGUI8",164,0)
DONE K DA,DIC,OLDIEN,NEWIEN,NUM,SUF,X,Y,DIK,OOP
"RTN","OOPSGUI8",165,0)
 Q
"RTN","OOPSGUI8",166,0)
SETDLOC(RESULTS,P1,DATA) ; files the detail location records
"RTN","OOPSGUI8",167,0)
 ;  Input - P1 is the Location record IEN concatenated with the station
"RTN","OOPSGUI8",168,0)
 ;              subrecord IEN. EX.  38^600  
"RTN","OOPSGUI8",169,0)
 ;          DATA is a # subscripted array containing the detail loc data
"RTN","OOPSGUI8",170,0)
 ;          in the format - detail location description^Detail Loc IEN  
"RTN","OOPSGUI8",171,0)
 ; Output - RESULTS indicating the success of the filing.
"RTN","OOPSGUI8",172,0)
 N CNT,IENS,FILE,LV1,LV2,LOC,MSG,REC,RECNO,STAFDA,STR
"RTN","OOPSGUI8",173,0)
 S BAD=0,FILE=2261.4,LOC=$P(P1,U),STA=$P(P1,U,2),RESULTS=""
"RTN","OOPSGUI8",174,0)
 I $D(DATA)<10 S RESULTS="NO DATA TO FILE, CANNOT CONTINUE" Q
"RTN","OOPSGUI8",175,0)
 I '$G(STA) S RESULTS="NO STATION SENT, COULDN'T FILE" Q
"RTN","OOPSGUI8",176,0)
 I '$G(LOC) S RESULTS="NO LOCATION SENT, COULDN'T FILE" Q
"RTN","OOPSGUI8",177,0)
 I '$D(^OOPS(FILE,LOC,1,"B",STA)) D  I BAD Q
"RTN","OOPSGUI8",178,0)
 .S IENS="+1,"_LOC_",",STAFDA(2261.43,IENS,.01)=STA
"RTN","OOPSGUI8",179,0)
 .D UPDATE^DIE("","STAFDA","IENS","MSG")
"RTN","OOPSGUI8",180,0)
 .I $D(MSG("DIERR")) D
"RTN","OOPSGUI8",181,0)
 ..S RESULTS="PROBLEM FILING NEW STATION SUBRECORD",BAD=1
"RTN","OOPSGUI8",182,0)
 ;KILL THE DETAIL LOCATION REC FOR STATION AND LOCATION PASSED IN
"RTN","OOPSGUI8",183,0)
 S DIENS=$O(^OOPS(FILE,"E",STA,LOC,"")),LV1=$O(^OOPS(FILE,LOC,0))
"RTN","OOPSGUI8",184,0)
 I $G(DIENS) D
"RTN","OOPSGUI8",185,0)
 .S LV2=$O(^OOPS(FILE,LOC,LV1,DIENS,0))
"RTN","OOPSGUI8",186,0)
 .I $G(LV2) K ^OOPS(FILE,LOC,LV1,DIENS,LV2)
"RTN","OOPSGUI8",187,0)
 .I $D(^OOPS(FILE,"F",DIENS,LOC)) K ^OOPS(FILE,"F",DIENS,LOC)
"RTN","OOPSGUI8",188,0)
 ;RE-FILE THE DETAIL LOCATION LEVEL RECORD
"RTN","OOPSGUI8",189,0)
 K STAFDA S CNT=0,RECNO=0,REC=""
"RTN","OOPSGUI8",190,0)
 F  S REC=$O(DATA(REC)) Q:REC=""  D
"RTN","OOPSGUI8",191,0)
 .S STR=DATA(REC),RECNO=$P(STR,U,2),CNT=CNT+1
"RTN","OOPSGUI8",192,0)
 .I RECNO="" S RECNO=CNT
"RTN","OOPSGUI8",193,0)
 .S IENS="+"_RECNO_","_DIENS_","_LOC_","
"RTN","OOPSGUI8",194,0)
 .S STAFDA(2261.431,IENS,.01)=$P(STR,U,1)
"RTN","OOPSGUI8",195,0)
 D UPDATE^DIE("E","STAFDA","IENS","MSG")
"RTN","OOPSGUI8",196,0)
 I '$D(MSG) S RESULTS="Filing Successful"
"RTN","OOPSGUI8",197,0)
 K MSG,STR,Y,X,%DT
"RTN","OOPSGUI8",198,0)
 Q
"RTN","OOPSGUIF")
0^11^B31912751
"RTN","OOPSGUIF",1,0)
OOPSGUIF ;WIOFO/LLH-RPC routine for OSHA Log ;11/5/01
"RTN","OOPSGUIF",2,0)
 ;;2.0;ASISTS;**6,7,11**;Jun 03, 2002
"RTN","OOPSGUIF",3,0)
 ;
"RTN","OOPSGUIF",4,0)
OSHA(RESULTS,INPUT,CALL) ; get the data
"RTN","OOPSGUIF",5,0)
 ;   Input:  INPUT - contains 4 values, the START AND END DATE, 
"RTN","OOPSGUIF",6,0)
 ;                   STATION, and INCLUDE NAME ON REPORT.  The Date of
"RTN","OOPSGUIF",7,0)
 ;                   Occ (fld #4) is used to in/exclude claims from the
"RTN","OOPSGUIF",8,0)
 ;                   report.  If Include name = Y, then names are
"RTN","OOPSGUIF",9,0)
 ;                   printed, else they will not,and if Station='ALL'
"RTN","OOPSGUIF",10,0)
 ;                   then all claims are included, if not 'All', then
"RTN","OOPSGUIF",11,0)
 ;                   only 1 station is included.
"RTN","OOPSGUIF",12,0)
 ;            CALL - Contains the calling menu.  If caller = "U"nion
"RTN","OOPSGUIF",13,0)
 ;                   name is excluded from printing.
"RTN","OOPSGUIF",14,0)
 ; Output: RESULTS - the results array passes data back to the client.
"RTN","OOPSGUIF",15,0)
 N CN,DA,IEN,INCNA,OCC,OOPS,PERSON,SDATE,STDT,STA,ENDDT,EDATE,X,Y
"RTN","OOPSGUIF",16,0)
 N GONE,LOST,DOI,CAX,FILL,TYPE
"RTN","OOPSGUIF",17,0)
 K ^TMP($J,"OSHA")
"RTN","OOPSGUIF",18,0)
 S CN=1,RESULTS(0)="Processing..."
"RTN","OOPSGUIF",19,0)
 S STDT=$P($G(INPUT),U),ENDDT=$P($G(INPUT),U,2)
"RTN","OOPSGUIF",20,0)
 S STA=$P($G(INPUT),U,3)
"RTN","OOPSGUIF",21,0)
 S INCNA=$P($G(INPUT),U,4)
"RTN","OOPSGUIF",22,0)
 I (STDT="")!(ENDDT="")!(STA="")!(INCNA="") D  Q
"RTN","OOPSGUIF",23,0)
 . S RESULTS(0)="Input parameters missing, cannot run report." Q
"RTN","OOPSGUIF",24,0)
 S (SDATE,EDATE)=""
"RTN","OOPSGUIF",25,0)
 S X=STDT D ^%DT S SDATE=Y
"RTN","OOPSGUIF",26,0)
 S X=ENDDT D ^%DT S EDATE=Y
"RTN","OOPSGUIF",27,0)
 ; SDATE made last time in day prior so start date correct
"RTN","OOPSGUIF",28,0)
 S SDATE=(SDATE-1)_".9999",EDATE=EDATE_".9999"
"RTN","OOPSGUIF",29,0)
 S LP="",IEN=""
"RTN","OOPSGUIF",30,0)
 F LP=SDATE:0 S LP=$O(^OOPS(2260,"AD",LP)) Q:(LP'>0)!(LP>EDATE)  D
"RTN","OOPSGUIF",31,0)
 . F  S IEN=$O(^OOPS(2260,"AD",LP,IEN)) Q:IEN'>0  D
"RTN","OOPSGUIF",32,0)
 .. I $$GET1^DIQ(2260,IEN,88,"I")'="Y" Q
"RTN","OOPSGUIF",33,0)
 .. I $$GET1^DIQ(2260,IEN,51,"I")>1 Q
"RTN","OOPSGUIF",34,0)
 .. S STATION=$P(^OOPS(2260,IEN,"2162A"),U,9)
"RTN","OOPSGUIF",35,0)
 .. I $G(STA)'="A",(STATION'=STA) Q
"RTN","OOPSGUIF",36,0)
 .. K OOPS,ARR S DIC="^OOPS(2260,"
"RTN","OOPSGUIF",37,0)
 .. S DR=".01;1;3;4;15;30;33;52;63;86;89"
"RTN","OOPSGUIF",38,0)
 .. S DA=IEN,DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSGUIF",39,0)
 .. S CAX=OOPS(2260,IEN,52,"I")
"RTN","OOPSGUIF",40,0)
 .. S DOI=OOPS(2260,IEN,4,"I"),DOI=$P($$FMTE^XLFDT(DOI,2),"@")
"RTN","OOPSGUIF",41,0)
 .. ; PER A. BIERENBAUM, GET OCC DESC 5/13/02
"RTN","OOPSGUIF",42,0)
 .. S OCC=$$OCCDESC(IEN)
"RTN","OOPSGUIF",43,0)
 .. ; S OCC=OOPS(2260,IEN,63,"E")_$E(OOPS(2260,IEN,15,"E"),1,4)
"RTN","OOPSGUIF",44,0)
 .. S GONE=OOPS(2260,IEN,89,"I"),GONE=$S(GONE="Y":"X",1:"")
"RTN","OOPSGUIF",45,0)
 .. S LOST=OOPS(2260,IEN,33,"I")
"RTN","OOPSGUIF",46,0)
 .. S LOST=$S(LOST="Y":"X^",LOST="N":"^X",1:"^X")
"RTN","OOPSGUIF",47,0)
 .. S TYPE=OOPS(2260,IEN,3,"I")
"RTN","OOPSGUIF",48,0)
 .. I TYPE>10&(TYPE<15) S PERSON="Privacy Case"
"RTN","OOPSGUIF",49,0)
 .. S PERSON=OOPS(2260,IEN,1,"E") I CALL="Union"!(INCNA="N") S PERSON=""
"RTN","OOPSGUIF",50,0)
 .. S ARR=OOPS(2260,IEN,.01,"E")_U_DOI_U
"RTN","OOPSGUIF",51,0)
 .. S ARR=ARR_PERSON_U_OCC_U_$E(OOPS(2260,IEN,86,"E"),1,35)_U
"RTN","OOPSGUIF",52,0)
 .. S ARR=ARR_OOPS(2260,IEN,3,"E")_U_OOPS(2260,IEN,30,"E")_U
"RTN","OOPSGUIF",53,0)
 .. S FILL="" I CAX=2 S FILL="^^^"
"RTN","OOPSGUIF",54,0)
 .. S ARR=ARR_FILL_GONE_U_LOST
"RTN","OOPSGUIF",55,0)
 .. S ^TMP($J,"OSHA",CN)=ARR,CN=CN+1
"RTN","OOPSGUIF",56,0)
 S RESULTS=$NA(^TMP($J,"OSHA"))
"RTN","OOPSGUIF",57,0)
 Q
"RTN","OOPSGUIF",58,0)
NSTICK(RESULTS,INPUT,CALL) ; NeedleStick Log get data logic
"RTN","OOPSGUIF",59,0)
 ;   Input:  INPUT - contains 4 values, the START DATE, END DATE, 
"RTN","OOPSGUIF",60,0)
 ;                   STATION, and INCLUDE NAME ON REPORT.  The Date of
"RTN","OOPSGUIF",61,0)
 ;                   Occurrence (field #4) will be used to include/
"RTN","OOPSGUIF",62,0)
 ;                   exclude claims from the report.  If the Include
"RTN","OOPSGUIF",63,0)
 ;                   name is = Y then the names will be printed, if no
"RTN","OOPSGUIF",64,0)
 ;                   they will not, and if the Station = 'ALL' then any
"RTN","OOPSGUIF",65,0)
 ;                   claim will be include, if not 'All', but the
"RTN","OOPSGUIF",66,0)
 ;                   station number then only 1 station is included.
"RTN","OOPSGUIF",67,0)
 ;            CALL - Contains the calling menu.  This will be used
"RTN","OOPSGUIF",68,0)
 ;                   to exclude the name from printing if the caller
"RTN","OOPSGUIF",69,0)
 ;                   is 'U'nion.
"RTN","OOPSGUIF",70,0)
 ; Output: RESULTS - the results array passes the data back to the
"RTN","OOPSGUIF",71,0)
 ;                   client.
"RTN","OOPSGUIF",72,0)
 N CN,DA,IEN,INCNA,OCC,PERSON,SDATE,STDT,STA,ENDDT,EDATE,X,Y
"RTN","OOPSGUIF",73,0)
 N LOST,DOI,OOPS,TYPE
"RTN","OOPSGUIF",74,0)
 K ^TMP($J,"NS")
"RTN","OOPSGUIF",75,0)
 S CN=1,RESULTS(0)="Processing..."
"RTN","OOPSGUIF",76,0)
 S STDT=$P($G(INPUT),U),ENDDT=$P($G(INPUT),U,2)
"RTN","OOPSGUIF",77,0)
 S STA=$P($G(INPUT),U,3)
"RTN","OOPSGUIF",78,0)
 S INCNA=$P($G(INPUT),U,4)
"RTN","OOPSGUIF",79,0)
 I (STDT="")!(ENDDT="")!(STA="")!(INCNA="") D  Q
"RTN","OOPSGUIF",80,0)
 . S RESULTS(0)="Input parameters missing, cannot run report." Q
"RTN","OOPSGUIF",81,0)
 S (SDATE,EDATE)=""
"RTN","OOPSGUIF",82,0)
 S X=STDT D ^%DT S SDATE=Y
"RTN","OOPSGUIF",83,0)
 S X=ENDDT D ^%DT S EDATE=Y
"RTN","OOPSGUIF",84,0)
 ; SDATE made last time in day prior so start date correct
"RTN","OOPSGUIF",85,0)
 S SDATE=(SDATE-1)_".9999",EDATE=EDATE_".9999"
"RTN","OOPSGUIF",86,0)
 S LP="",IEN=""
"RTN","OOPSGUIF",87,0)
 F LP=SDATE:0 S LP=$O(^OOPS(2260,"AD",LP)) Q:(LP'>0)!(LP>EDATE)  D
"RTN","OOPSGUIF",88,0)
 . F  S IEN=$O(^OOPS(2260,"AD",LP,IEN)) Q:IEN'>0  D
"RTN","OOPSGUIF",89,0)
 .. ; exclude deleted, replaced by amendment cases
"RTN","OOPSGUIF",90,0)
 .. I $$GET1^DIQ(2260,IEN,51,"I")>1 Q
"RTN","OOPSGUIF",91,0)
 .. S STATION=$P(^OOPS(2260,IEN,"2162A"),U,9)
"RTN","OOPSGUIF",92,0)
 .. I $G(STA)'="A",(STATION'=STA) Q
"RTN","OOPSGUIF",93,0)
 .. ; if Type Incident not = Hollow Bore Needlestick, Sharps Exposure,
"RTN","OOPSGUIF",94,0)
 .. ; Exposure to Body Fluids/Splash, Suture Needlestick don't include
"RTN","OOPSGUIF",95,0)
 .. S TYPE=$$GET1^DIQ(2260,IEN,3,"I")
"RTN","OOPSGUIF",96,0)
 .. I TYPE<11!(TYPE>14) Q
"RTN","OOPSGUIF",97,0)
 .. ; now get the data and put in array.
"RTN","OOPSGUIF",98,0)
 .. K OOPS,ARR S DIC="^OOPS(2260,"
"RTN","OOPSGUIF",99,0)
 .. S DR=".01;1;3;4;15;14;29;30;33;37;38;51;52;82;86;108"
"RTN","OOPSGUIF",100,0)
 .. S DA=IEN,DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSGUIF",101,0)
 .. S DOI=OOPS(2260,IEN,4,"E")
"RTN","OOPSGUIF",102,0)
 .. ; PER A. BIERENBAUM, USE OCC DESC 5/13/02
"RTN","OOPSGUIF",103,0)
 .. S OCC=$$OCCDESC(IEN)
"RTN","OOPSGUIF",104,0)
 .. ; S OCC=$E(OOPS(2260,IEN,15,"E"),1,4)
"RTN","OOPSGUIF",105,0)
 .. ; patch 7 remove lost time
"RTN","OOPSGUIF",106,0)
 .. ; S LOST=OOPS(2260,IEN,33,"E")
"RTN","OOPSGUIF",107,0)
 .. S INJILL=OOPS(2260,IEN,52,"I")
"RTN","OOPSGUIF",108,0)
 .. S INJILL=$S(INJILL=1:"Injury",INJILL=2:"Illness",1:"")
"RTN","OOPSGUIF",109,0)
 .. ; patch 7 - only print privacy case in name field - all cases
"RTN","OOPSGUIF",110,0)
 .. S PERSON="Privacy Case"
"RTN","OOPSGUIF",111,0)
 .. ; S PERSON=OOPS(2260,IEN,1,"E")
"RTN","OOPSGUIF",112,0)
 .. I CALL="Union"!(INCNA="N") S PERSON=""
"RTN","OOPSGUIF",113,0)
 .. S ARR=IEN_U_OOPS(2260,IEN,.01,"E")_U_DOI_U_PERSON_U_INJILL_U
"RTN","OOPSGUIF",114,0)
 .. S ARR=ARR_OOPS(2260,IEN,51,"E")_U_OCC_U_$E(OOPS(2260,DA,14,"E"),1,4)
"RTN","OOPSGUIF",115,0)
 .. S ARR=ARR_U_OOPS(2260,IEN,86,"E")_U
"RTN","OOPSGUIF",116,0)
 .. S ARR=ARR_OOPS(2260,IEN,3,"E")_U_OOPS(2260,IEN,108,"E")
"RTN","OOPSGUIF",117,0)
 .. S ARR=ARR_U_OOPS(2260,IEN,30,"E")_U_$E(OOPS(2260,IEN,29,"E"),1,45)_U
"RTN","OOPSGUIF",118,0)
 .. S ARR=ARR_$E(OOPS(2260,IEN,37,"E"),1,50)_U
"RTN","OOPSGUIF",119,0)
 .. S ARR=ARR_$E(OOPS(2260,IEN,38,"E"),1,50)_U_OOPS(2260,IEN,82,"E")
"RTN","OOPSGUIF",120,0)
 .. S ^TMP($J,"NS",CN)=ARR K ARR
"RTN","OOPSGUIF",121,0)
 .. S CN=CN+1
"RTN","OOPSGUIF",122,0)
 S RESULTS=$NA(^TMP($J,"NS"))
"RTN","OOPSGUIF",123,0)
 Q
"RTN","OOPSGUIF",124,0)
OCCDESC(IEN) ;Get Occupation Description
"RTN","OOPSGUIF",125,0)
 ;
"RTN","OOPSGUIF",126,0)
 ;  Input:  IEN - IEN of the ASISTS Case number to get the Occ Desc
"RTN","OOPSGUIF",127,0)
 ; Output:      - will be the Occupation description
"RTN","OOPSGUIF",128,0)
 ;
"RTN","OOPSGUIF",129,0)
 N INC,FLD
"RTN","OOPSGUIF",130,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSGUIF",131,0)
 S FLD=$S(INC=1:111,INC=2:208,1:"")
"RTN","OOPSGUIF",132,0)
 I 'FLD Q ""
"RTN","OOPSGUIF",133,0)
 Q $$GET1^DIQ(2260,IEN,FLD)
"RTN","OOPSGUIF",134,0)
DSPUTE ; Reason for Dispute Report - called from DSPUTE^OOPSGUIR
"RTN","OOPSGUIF",135,0)
 ; code in DSPUTE^OOPSGUIF requires case to be a CA1
"RTN","OOPSGUIF",136,0)
 N BLK36,DIS,DSPCD,F174
"RTN","OOPSGUIF",137,0)
 S F174=$$GET1^DIQ(2260,IEN,174,"I")      ; determines lost time or not
"RTN","OOPSGUIF",138,0)
 S F174=$S(F174=3:"LT",1:"NLT")
"RTN","OOPSGUIF",139,0)
 S DIS=$$GET1^DIQ(2260,IEN,165.2,"I"),DSPCD=$$GET1^DIQ(2260,IEN,347)
"RTN","OOPSGUIF",140,0)
 I $G(DIS)="" S DIS="N"
"RTN","OOPSGUIF",141,0)
 I DIS="N" S DSPCD="zCase not disputed, no dispute code expected"
"RTN","OOPSGUIF",142,0)
 I (DIS="Y"),DSPCD="" S DSPCD="zCase disputed, no dispute code entered"
"RTN","OOPSGUIF",143,0)
 ;if data in State the reason in detail question and case controverted
"RTN","OOPSGUIF",144,0)
 ;don't count, otherwise report number of entries in free text field
"RTN","OOPSGUIF",145,0)
 S BLK36=""
"RTN","OOPSGUIF",146,0)
 I DIS="Y",($P($G(^OOPS(2260,IEN,"CA1K",0)),U,3)) D
"RTN","OOPSGUIF",147,0)
 .I $$GET1^DIQ(2260,IEN,165.1,"I")="Y" Q
"RTN","OOPSGUIF",148,0)
 .S BLK36="zBlk 36 also has text entered"
"RTN","OOPSGUIF",149,0)
 S:'$D(ARR(DSPCD,F174)) ARR(DSPCD,F174)=0
"RTN","OOPSGUIF",150,0)
 S ARR(DSPCD,F174)=ARR(DSPCD,F174)+1
"RTN","OOPSGUIF",151,0)
 I BLK36'="" D
"RTN","OOPSGUIF",152,0)
 .S:'$D(ARR(BLK36,F174)) ARR(BLK36,F174)=0
"RTN","OOPSGUIF",153,0)
 .S ARR(BLK36,F174)=ARR(BLK36,F174)+1
"RTN","OOPSGUIF",154,0)
 Q
"RTN","OOPSGUIR")
0^14^B67650815
"RTN","OOPSGUIR",1,0)
OOPSGUIR ;WIOFO/LLH-RPC routine for misc reports ;03/16/04
"RTN","OOPSGUIR",2,0)
 ;;2.0;ASISTS;**8,7,11**;Jun 03, 2002
"RTN","OOPSGUIR",3,0)
 ;
"RTN","OOPSGUIR",4,0)
ENT(RESULTS,INPUT,CALL) ; get the data for the report
"RTN","OOPSGUIR",5,0)
 ;   Input:  INPUT - contains 3 values, the START AND END DATE, 
"RTN","OOPSGUIR",6,0)
 ;                   STATION. The Date of Occ (fld #4) is used to 
"RTN","OOPSGUIR",7,0)
 ;                   in/exclude claims from the report. If Station='ALL'
"RTN","OOPSGUIR",8,0)
 ;                   then all claims are included, if not 'All', then
"RTN","OOPSGUIR",9,0)
 ;                   only 1 station is included.
"RTN","OOPSGUIR",10,0)
 ;            CALL - contains the report call which will invoke
"RTN","OOPSGUIR",11,0)
 ;                   the appropriate M call 
"RTN","OOPSGUIR",12,0)
 ; Output: RESULTS - the results array passes data back to the client.
"RTN","OOPSGUIR",13,0)
 N CAX,FI,LP,MENU,SDATE,STDT,STA,STATION,ENDDT,EDATE,TAG,X,Y,%DT
"RTN","OOPSGUIR",14,0)
 S RESULTS(0)="Processing..."
"RTN","OOPSGUIR",15,0)
 S STDT=$P($G(INPUT),U),ENDDT=$P($G(INPUT),U,2)
"RTN","OOPSGUIR",16,0)
 S STA=$P($G(INPUT),U,3),TAG=CALL
"RTN","OOPSGUIR",17,0)
 I (STDT="")!(ENDDT="")!(STA="")!(TAG="") D  Q
"RTN","OOPSGUIR",18,0)
 . S RESULTS(0)="Input parameters missing, cannot run report." Q
"RTN","OOPSGUIR",19,0)
 K ^TMP($J,TAG)
"RTN","OOPSGUIR",20,0)
 S (SDATE,EDATE,MENU)=""
"RTN","OOPSGUIR",21,0)
 S X=STDT D ^%DT S SDATE=Y
"RTN","OOPSGUIR",22,0)
 S X=ENDDT D ^%DT S EDATE=Y
"RTN","OOPSGUIR",23,0)
 ; SDATE made last time in day prior so start date correct
"RTN","OOPSGUIR",24,0)
 I TAG="LOG300U" S TAG="LOG300",MENU="U"
"RTN","OOPSGUIR",25,0)
 S SDATE=(SDATE-1)+.9999,EDATE=EDATE_".9999"
"RTN","OOPSGUIR",26,0)
 D @TAG
"RTN","OOPSGUIR",27,0)
 Q
"RTN","OOPSGUIR",28,0)
SERVICE ; Service/Detail Location report - patch 11
"RTN","OOPSGUIR",29,0)
DSPUTE ; Reason for Dispute report. Patch 11
"RTN","OOPSGUIR",30,0)
FLD174 ; Report compiles filing instruction result counts
"RTN","OOPSGUIR",31,0)
FLD332 ; Use this tag for Reason for Controvert report. Patch 11
"RTN","OOPSGUIR",32,0)
 N ARR,CODE,CN,LP,IEN,I,GOON,P2,TX
"RTN","OOPSGUIR",33,0)
 S LP="",IEN="",CN=0
"RTN","OOPSGUIR",34,0)
 I TAG="FLD174" D
"RTN","OOPSGUIR",35,0)
 .S CODE=$P($G(^DD(2260,174,0)),U,3)
"RTN","OOPSGUIR",36,0)
 .F I=1:1 S LP=$P(CODE,";",I) Q:$G(LP)=""  I $P(LP,":",2)'="" S ARR(LP)=0
"RTN","OOPSGUIR",37,0)
 .S ARR(I_":No Data Entered")=0
"RTN","OOPSGUIR",38,0)
 I TAG="FLD332" D
"RTN","OOPSGUIR",39,0)
 .F I=1:1 Q:'$D(^OOPS(2262.4,I))  S ARR(I_":"_$P(^OOPS(2262.4,I,0),U))=0
"RTN","OOPSGUIR",40,0)
 .S ARR(98_":Blk 36 also has text entered")=0
"RTN","OOPSGUIR",41,0)
 .S ARR(99_":Controvert question checked Yes, but no Controvert Code entered")=0
"RTN","OOPSGUIR",42,0)
 F LP=SDATE:0 S LP=$O(^OOPS(2260,"AD",LP)) Q:(LP'>0)!(LP>EDATE)  D
"RTN","OOPSGUIR",43,0)
 .F  S IEN=$O(^OOPS(2260,"AD",LP,IEN)) Q:IEN'>0  D
"RTN","OOPSGUIR",44,0)
 ..I $$GET1^DIQ(2260,IEN,51,"I")>1 Q      ;only allow open/closed cases
"RTN","OOPSGUIR",45,0)
 ..S CAX=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSGUIR",46,0)
 ..I TAG'="SERVICE"&(CAX=2) Q                       ;only allow CA1's
"RTN","OOPSGUIR",47,0)
 ..S STATION=$P(^OOPS(2260,IEN,"2162A"),U,9)
"RTN","OOPSGUIR",48,0)
 ..I ($G(STA)'="A"),(STATION'=STA) Q        ;get correct station
"RTN","OOPSGUIR",49,0)
 ..;patch 11 - sent to OOPSGUIF due to size this routine
"RTN","OOPSGUIR",50,0)
 ..I TAG="DSPUTE" D DSPUTE^OOPSGUIF
"RTN","OOPSGUIR",51,0)
 ..I TAG="SERVICE" D SERVICE^OOPSGUIU
"RTN","OOPSGUIR",52,0)
 ..; Filing instructions report
"RTN","OOPSGUIR",53,0)
 ..I TAG="FLD174" D
"RTN","OOPSGUIR",54,0)
 ...S FI=$$GET1^DIQ(2260,IEN,174,"I")_":"_$$GET1^DIQ(2260,IEN,174)
"RTN","OOPSGUIR",55,0)
 ...I $$GET1^DIQ(2260,IEN,174)="" S FI=I_":No Data Entered"
"RTN","OOPSGUIR",56,0)
 ...S ARR(FI)=ARR(FI)+1
"RTN","OOPSGUIR",57,0)
 ...;patch 11 - Reason for controvert report
"RTN","OOPSGUIR",58,0)
 ..I TAG="FLD332" D
"RTN","OOPSGUIR",59,0)
 ...;first Agency Controvert must = "Y" to be counted
"RTN","OOPSGUIR",60,0)
 ...S GOON=$$GET1^DIQ(2260,IEN,165.1,"I") I $G(GOON)'="Y" D  Q
"RTN","OOPSGUIR",61,0)
 ....S:'$D(ARR("999:Case not controverted, no controvert code expected")) ARR("999:Case not controverted, no controvert code expected")=0
"RTN","OOPSGUIR",62,0)
 ....S ARR("999:Case not controverted, no controvert code expected")=ARR("999:Case not controverted, no controvert code expected")+1
"RTN","OOPSGUIR",63,0)
 ...S FI=$$GET1^DIQ(2260,IEN,332,"I")_":"_$$GET1^DIQ(2260,IEN,332)
"RTN","OOPSGUIR",64,0)
 ...I $$GET1^DIQ(2260,IEN,332)="" S FI=99_":Controvert question checked Yes, but no Controvert Code entered"
"RTN","OOPSGUIR",65,0)
 ...S ARR(FI)=ARR(FI)+1
"RTN","OOPSGUIR",66,0)
 ...I $G(^OOPS(2260,IEN,"CA1K",1,0))'="" D
"RTN","OOPSGUIR",67,0)
 ....;if case is diputed, don't count in Controvert rpt - quit
"RTN","OOPSGUIR",68,0)
 ....S GOON=$$GET1^DIQ(2260,IEN,165.2,"I") I $G(GOON)="Y" Q
"RTN","OOPSGUIR",69,0)
 ....S ARR(98_":Blk 36 also has text entered")=ARR(98_":Blk 36 also has text entered")+1
"RTN","OOPSGUIR",70,0)
 I TAG'="DSPUTE",(TAG'="SERVICE") D
"RTN","OOPSGUIR",71,0)
 .S CN=0,FI="",P2=""
"RTN","OOPSGUIR",72,0)
 .F  S FI=$O(ARR(FI)) Q:FI=""  D
"RTN","OOPSGUIR",73,0)
 ..S CN=$P(FI,":"),P2=$P(FI,":",2),CODE=0
"RTN","OOPSGUIR",74,0)
 ..I TAG="FLD332" S TX=$O(^OOPS(2262.4,"B",P2,"")) I $G(TX) S CODE=$P(^OOPS(2262.4,TX,0),U,2)
"RTN","OOPSGUIR",75,0)
 ..S ^TMP($J,TAG,CN)=P2_U_CODE_U_ARR(FI)
"RTN","OOPSGUIR",76,0)
 ..; rearrange 'bogus' Controvert Codes for report formating
"RTN","OOPSGUIR",77,0)
 ..I TAG="FLD332",(CN>97) S ^TMP($J,TAG,CN)=U_P2_U_ARR(FI)
"RTN","OOPSGUIR",78,0)
 I TAG="SERVICE" D CMPLSRV^OOPSGUIU
"RTN","OOPSGUIR",79,0)
 I TAG="DSPUTE" D DSPUTE^OOPSGUIU
"RTN","OOPSGUIR",80,0)
 S RESULTS=$NA(^TMP($J,TAG))
"RTN","OOPSGUIR",81,0)
 Q
"RTN","OOPSGUIR",82,0)
SUM300A ; Summary of Work-related injuries and illness report
"RTN","OOPSGUIR",83,0)
 N CN,EMP,FAC,HRS,STATE,STR
"RTN","OOPSGUIR",84,0)
 N COLG,COLH,COLI,COLJ,COLK,COLL,COLM
"RTN","OOPSGUIR",85,0)
 S (COLG,COLH,COLI,COLJ,COLK,COLL)=0
"RTN","OOPSGUIR",86,0)
 S (COLM(1),COLM(2),COLM(3),COLM(4),COLM(5),COLM(6))=0
"RTN","OOPSGUIR",87,0)
 S ^TMP($J,TAG,0)="No worksheet data for this station."
"RTN","OOPSGUIR",88,0)
 S FAC=$$GET1^DIQ(4,STA,.01,"E")
"RTN","OOPSGUIR",89,0)
 K ARR D STATINFO^OOPSGUI3(.ARR,STA) I $D(ARR) D
"RTN","OOPSGUIR",90,0)
 .S STATE=$P($G(ARR(0)),U,3)
"RTN","OOPSGUIR",91,0)
 .I $G(STATE)'="" D
"RTN","OOPSGUIR",92,0)
 ..S STATE=$O(^DIC(5,"B",STATE,""))
"RTN","OOPSGUIR",93,0)
 ..S $P(ARR(0),U,3)=$P(^DIC(5,STATE,0),U,2)
"RTN","OOPSGUIR",94,0)
 .S ^TMP($J,TAG,0)=FAC_U_ARR(0)
"RTN","OOPSGUIR",95,0)
 K ARR D SITEPGET^OOPSGUI6(.ARR,"OSHA300") I $D(ARR) D 
"RTN","OOPSGUIR",96,0)
 .S CN=0 F  S CN=$O(ARR(CN)) Q:CN=""  D
"RTN","OOPSGUIR",97,0)
 ..I $P(ARR(CN),U,11)'=STA Q
"RTN","OOPSGUIR",98,0)
 ..S STR=$P($P(ARR(CN),U,1)," = ",2)
"RTN","OOPSGUIR",99,0)
 ..S STR=$P(ARR(CN),U,3)_U_$P(ARR(CN),U,4)_U_$P(ARR(CN),U,6)_U
"RTN","OOPSGUIR",100,0)
 ..S STR=STR_$P(ARR(CN),U,7)_U_$P(ARR(CN),U,8)
"RTN","OOPSGUIR",101,0)
 ..S ^TMP($J,TAG,0)=^TMP($J,TAG,0)_U_STR
"RTN","OOPSGUIR",102,0)
 K ARR,DATA S DATA=""
"RTN","OOPSGUIR",103,0)
 D EMPHRS,DETAIL
"RTN","OOPSGUIR",104,0)
 Q
"RTN","OOPSGUIR",105,0)
IRWSHT ; Incidence Rates Worksheet Report
"RTN","OOPSGUIR",106,0)
 N COLHI,EMP,HRS
"RTN","OOPSGUIR",107,0)
 S ^TMP($J,TAG,1)="No Worksheet Data for this Station"
"RTN","OOPSGUIR",108,0)
 S COLHI=0
"RTN","OOPSGUIR",109,0)
 K ARR,DATA S DATA=""
"RTN","OOPSGUIR",110,0)
 D EMPHRS,DETAIL
"RTN","OOPSGUIR",111,0)
 Q
"RTN","OOPSGUIR",112,0)
DETAIL ; now get employee information
"RTN","OOPSGUIR",113,0)
LOG300 ; entry point for the OSHA 300 LOG
"RTN","OOPSGUIR",114,0)
 N CN,CASES,DOI,FLD,IEN,INC,STATION,TYPE
"RTN","OOPSGUIR",115,0)
 S DOI=SDATE,CASES=0,CN=1
"RTN","OOPSGUIR",116,0)
 F  S DOI=$O(^OOPS(2260,"AF",DOI)) Q:(DOI>EDATE)!(DOI="")  S IEN=0 D
"RTN","OOPSGUIR",117,0)
 .F  S IEN=$O(^OOPS(2260,"AF",DOI,"Y",IEN)) Q:IEN=""  D
"RTN","OOPSGUIR",118,0)
 ..S STATION=$P(^OOPS(2260,IEN,"2162A"),U,9) I $G(STATION)'=STA Q
"RTN","OOPSGUIR",119,0)
 ..I $P(^OOPS(2260,IEN,0),U,6)>1 Q
"RTN","OOPSGUIR",120,0)
 ..S CASES=CASES+1
"RTN","OOPSGUIR",121,0)
 ..I TAG="IRWSHT" D
"RTN","OOPSGUIR",122,0)
 ...I $D(^OOPS(2260,IEN,"OUTC","AC","A","J"))!$D(^OOPS(2260,IEN,"OUTC","AC","A","A")) S COLHI=COLHI+1
"RTN","OOPSGUIR",123,0)
 ..I TAG="SUM300A" D FLD95
"RTN","OOPSGUIR",124,0)
 ..I TAG="LOG300" D FLD95 D
"RTN","OOPSGUIR",125,0)
 ...S ARR(1)=$$GET1^DIQ(2260,IEN,.01),ARR(2)=$$GET1^DIQ(2260,IEN,1)
"RTN","OOPSGUIR",126,0)
 ...I $$GET1^DIQ(2260,IEN,337,"I")="Y" S ARR(2)="Privacy Case"
"RTN","OOPSGUIR",127,0)
 ...S TYPE=$$GET1^DIQ(2260,IEN,3,"I")
"RTN","OOPSGUIR",128,0)
 ...I TYPE>10&(TYPE<15) S ARR(2)="Privacy Case"
"RTN","OOPSGUIR",129,0)
 ...I MENU="U" S ARR(2)=""
"RTN","OOPSGUIR",130,0)
 ...S INC=$$GET1^DIQ(2260,IEN,52,"I"),FLD=$S(INC=1:111,INC=2:208,1:"")
"RTN","OOPSGUIR",131,0)
 ...S ARR(3)=$$GET1^DIQ(2260,IEN,FLD)
"RTN","OOPSGUIR",132,0)
 ...S ARR(4)=$P($$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,4,"I")),2),"@")
"RTN","OOPSGUIR",133,0)
 ...S ARR(5)=$$GET1^DIQ(2260,IEN,27,"E")
"RTN","OOPSGUIR",134,0)
 ...S ARR(6)=$$GET1^DIQ(2260,IEN,3)_";"_$$GET1^DIQ(2260,IEN,30)
"RTN","OOPSGUIR",135,0)
 ...S DATA=ARR(1)_U_ARR(2)_U_ARR(3)_U_ARR(4)_U_ARR(5)_U_ARR(6)_U_ARR(7)_U
"RTN","OOPSGUIR",136,0)
 ...S DATA=DATA_ARR(8)_U_ARR(9)_U_ARR(10)
"RTN","OOPSGUIR",137,0)
 ...S ^TMP($J,TAG,CN)=DATA,CN=CN+1
"RTN","OOPSGUIR",138,0)
 I TAG="IRWSHT" S ^TMP($J,TAG,1)=CASES_U_COLHI_U_HRS
"RTN","OOPSGUIR",139,0)
 I TAG="SUM300A" D
"RTN","OOPSGUIR",140,0)
 .S DATA=CASES_U_EMP_U_HRS_U_COLG_U_COLH_U_COLI_U_COLJ_U_COLK_U_COLL_U
"RTN","OOPSGUIR",141,0)
 .S DATA=DATA_COLM(1)_U_COLM(2)_U_COLM(3)_U_COLM(4)_U_COLM(5)_U_COLM(6)
"RTN","OOPSGUIR",142,0)
 .S ^TMP($J,TAG,1)=DATA
"RTN","OOPSGUIR",143,0)
 S RESULTS=$NA(^TMP($J,TAG))
"RTN","OOPSGUIR",144,0)
 K ARR,DATA
"RTN","OOPSGUIR",145,0)
 Q
"RTN","OOPSGUIR",146,0)
FLD95 ; use OUTC subrecord to retrieve data
"RTN","OOPSGUIR",147,0)
 N AVAIL,ED,SD,S0,INC,ILL,DAYA,DAYJ,DAYS,IEN95,OC,OUTC,S95,TDAY
"RTN","OOPSGUIR",148,0)
 S S0=$G(^OOPS(2260,IEN,0)),INC=$P(S0,U,7)
"RTN","OOPSGUIR",149,0)
 S ILL=$P($G(^OOPS(2260,IEN,"2162B")),U,15)
"RTN","OOPSGUIR",150,0)
 S TDAY=$$HTFM^XLFDT(+$H)
"RTN","OOPSGUIR",151,0)
 ; add days away & job transfer up only to 180 for log, 4 300A get all
"RTN","OOPSGUIR",152,0)
 S (DAYA,DAYJ,TAWAY)=0,IEN95=0
"RTN","OOPSGUIR",153,0)
 F  S IEN95=$O(^OOPS(2260,IEN,"OUTC",IEN95)) Q:IEN95'>0  D
"RTN","OOPSGUIR",154,0)
 .S S95=$G(^OOPS(2260,IEN,"OUTC",IEN95,0))
"RTN","OOPSGUIR",155,0)
 .S SD=$P(S95,U,1),ED=$P(S95,U,2),OC=$P(S95,U,3),DAYS=0
"RTN","OOPSGUIR",156,0)
 .I $P(S95,U,11)="D" Q      ; entry is deleted
"RTN","OOPSGUIR",157,0)
 .;patch 11 - added logic that if TAG=LOG300 include all incident days
"RTN","OOPSGUIR",158,0)
 .;           up to 180, else 300A, only include date range incidents
"RTN","OOPSGUIR",159,0)
 .I (TAG="SUM300A"),(EDATE<SD) Q
"RTN","OOPSGUIR",160,0)
 .I $G(OC)'="" S OUTC(OC)=""
"RTN","OOPSGUIR",161,0)
 .I TAG="SUM300A" D
"RTN","OOPSGUIR",162,0)
 ..I $G(ED)=""!($G(ED)>EDATE) S DAYS=$$FMDIFF^XLFDT(EDATE,SD,1)+1
"RTN","OOPSGUIR",163,0)
 .I TAG="LOG300",($G(ED)="") S DAYS=$$FMDIFF^XLFDT(TDAY,SD,1)+1
"RTN","OOPSGUIR",164,0)
 .I '$G(DAYS) S DAYS=$S(OC="A":$P(S95,U,4),OC="J":$P(S95,U,5),1:0)
"RTN","OOPSGUIR",165,0)
 .I DAYA+DAYJ>180 Q
"RTN","OOPSGUIR",166,0)
 .S AVAIL=0
"RTN","OOPSGUIR",167,0)
 .I DAYS>180 S AVAIL=180
"RTN","OOPSGUIR",168,0)
 .I (DAYS<180) D
"RTN","OOPSGUIR",169,0)
 ..I (DAYS+DAYA+DAYJ)<180 S AVAIL=DAYS
"RTN","OOPSGUIR",170,0)
 ..I (DAYS+DAYA+DAYJ)>180 S AVAIL=(180-(DAYA+DAYJ))
"RTN","OOPSGUIR",171,0)
 .I $G(OC)="A" S DAYA=DAYA+AVAIL
"RTN","OOPSGUIR",172,0)
 .I $G(OC)="J" S DAYJ=DAYJ+AVAIL
"RTN","OOPSGUIR",173,0)
 I TAG="SUM300A" D
"RTN","OOPSGUIR",174,0)
 .S:$G(INC)=1 COLM(1)=COLM(1)+1
"RTN","OOPSGUIR",175,0)
 .I INC=2 D
"RTN","OOPSGUIR",176,0)
 ..I $G(ILL) S COLM(ILL)=COLM(ILL)+1
"RTN","OOPSGUIR",177,0)
 ..I '$G(ILL) S COLM(6)=COLM(6)+1
"RTN","OOPSGUIR",178,0)
 .S COLK=COLK+DAYA,COLL=COLL+DAYJ
"RTN","OOPSGUIR",179,0)
 .I $D(OUTC("D")) S COLG=COLG+1 Q
"RTN","OOPSGUIR",180,0)
 .I $D(OUTC("A")) S COLH=COLH+1 Q
"RTN","OOPSGUIR",181,0)
 .I $D(OUTC("J")) S COLI=COLI+1 Q
"RTN","OOPSGUIR",182,0)
 .I $D(OUTC("O")) S COLJ=COLJ+1 Q
"RTN","OOPSGUIR",183,0)
 I TAG="LOG300" D
"RTN","OOPSGUIR",184,0)
 .S ARR(7)="",ARR(10)="",(ARR(8),ARR(9))=0
"RTN","OOPSGUIR",185,0)
 .I INC=1 S ARR(10)=1
"RTN","OOPSGUIR",186,0)
 .I INC=2 S:$G(ILL) ARR(10)=ILL S:'$G(ILL) ARR(10)=6
"RTN","OOPSGUIR",187,0)
 .S ARR(8)=DAYA,ARR(9)=DAYJ
"RTN","OOPSGUIR",188,0)
 .I $D(OUTC("D")) S ARR(7)="D" S (ARR(8),ARR(9))=0 Q
"RTN","OOPSGUIR",189,0)
 .I $D(OUTC("A")) S ARR(7)="A" Q
"RTN","OOPSGUIR",190,0)
 .I $D(OUTC("J")) S ARR(7)="J" Q
"RTN","OOPSGUIR",191,0)
 .I $D(OUTC("O")) S ARR(7)="O" Q
"RTN","OOPSGUIR",192,0)
 Q
"RTN","OOPSGUIR",193,0)
EMPHRS ; get Total Num Employees and Hours worked
"RTN","OOPSGUIR",194,0)
 N CASES,ED,LV1,LV2,MON,OK,PAR,SD,SIEN,STR,WS,X,X1,X2
"RTN","OOPSGUIR",195,0)
 S (EMP,HRS,WS)=0
"RTN","OOPSGUIR",196,0)
 S PAR="^OOPS(2262,0)",PAR=$Q(@PAR),PAR=$Q(@PAR)
"RTN","OOPSGUIR",197,0)
 S LV1=$P(PAR,",",2),LV2=$P(PAR,",",3)
"RTN","OOPSGUIR",198,0)
 S SIEN=$O(^OOPS(2262,LV1,LV2,"B",STA,-1)) Q:SIEN=""
"RTN","OOPSGUIR",199,0)
 ; get month range to make sure all emp numbers and hours are entered
"RTN","OOPSGUIR",200,0)
 S SDATE=SDATE\1
"RTN","OOPSGUIR",201,0)
 S SD=$E(SDATE,1,5)_"00"_$E(SDATE,8,$L(SDATE))
"RTN","OOPSGUIR",202,0)
 S ED=$E(EDATE,1,5)_"00"_$E(EDATE,8,$L(EDATE))
"RTN","OOPSGUIR",203,0)
 S X1=$E(ED,1,3),X2=$E(SD,1,3)
"RTN","OOPSGUIR",204,0)
 I X1>X2 D
"RTN","OOPSGUIR",205,0)
 .S OK=0,X=(X1-X2) S:X>1 OK=(X-1)*12
"RTN","OOPSGUIR",206,0)
 .S OK=OK+(($E(ED,4,5)-$E(SD,4,5))+1)+$E(SD,4,5)
"RTN","OOPSGUIR",207,0)
 I X1=X2 S OK=($E(ED,4,5)-$E(SD,4,5))+1
"RTN","OOPSGUIR",208,0)
 S MON=OK
"RTN","OOPSGUIR",209,0)
 F  S WS=$O(^OOPS(2262,LV1,LV2,SIEN,2,WS)) Q:(WS'>0)  D
"RTN","OOPSGUIR",210,0)
 .S STR=^OOPS(2262,LV1,LV2,SIEN,2,WS,0)
"RTN","OOPSGUIR",211,0)
 .I ($P(STR,U)'<SD)&($P(STR,U)'>ED) D
"RTN","OOPSGUIR",212,0)
 ..I ($P(STR,U,2)="")!($P(STR,U,3)="") Q
"RTN","OOPSGUIR",213,0)
 ..S EMP=EMP+$P(STR,U,2),HRS=HRS+$P(STR,U,3),OK=OK-1
"RTN","OOPSGUIR",214,0)
 I '$G(OK) S EMP=EMP/MON
"RTN","OOPSGUIR",215,0)
 I $G(OK) S (EMP,HRS)="INCOMPLETE DATA"
"RTN","OOPSGUIR",216,0)
 Q
"RTN","OOPSGUIS")
0^15^B29381071
"RTN","OOPSGUIS",1,0)
OOPSGUIS ;WIOFO/LLH-RPC Broker calls for GUI ;03/25/04
"RTN","OOPSGUIS",2,0)
 ;;2.0;ASISTS;**8,11**;Jun 03, 2002
"RTN","OOPSGUIS",3,0)
 ;
"RTN","OOPSGUIS",4,0)
STA(RESULTS) ; Get listing of Stations from Edit Site Parameter
"RTN","OOPSGUIS",5,0)
 ;
"RTN","OOPSGUIS",6,0)
 ; Output:  RESULTS contains a listing or all stations listed in the
"RTN","OOPSGUIS",7,0)
 ;          Edit Site Parameter file.  This list will be used for
"RTN","OOPSGUIS",8,0)
 ;          selecting a station from any field that expects an entry
"RTN","OOPSGUIS",9,0)
 ;          from the Institution file.  If no stations exist, then
"RTN","OOPSGUIS",10,0)
 ;          a call will automatically be made to GETINST^OOPSGUI7
"RTN","OOPSGUIS",11,0)
 ;          to use the rpc to get all the stations.
"RTN","OOPSGUIS",12,0)
 ;
"RTN","OOPSGUIS",13,0)
 N ARR,CN,FAC,IFLAG,SNAME,SNUM,SP,STA,VAL
"RTN","OOPSGUIS",14,0)
 K ^TMP("OOPSINST",$J)
"RTN","OOPSGUIS",15,0)
 S (CN,SP)=0
"RTN","OOPSGUIS",16,0)
 F  S SP=$O(^OOPS(2262,SP)) Q:SP=""  S STA=0 D
"RTN","OOPSGUIS",17,0)
 .F  S STA=$O(^OOPS(2262,SP,STA)) Q:STA'>0  S IEN=0 D
"RTN","OOPSGUIS",18,0)
 ..F  S IEN=$O(^OOPS(2262,SP,STA,IEN)) Q:IEN'>0  D
"RTN","OOPSGUIS",19,0)
 ...S FAC=$P($G(^OOPS(2262,SP,STA,IEN,0)),U,1)
"RTN","OOPSGUIS",20,0)
 ...I '$G(FAC) Q
"RTN","OOPSGUIS",21,0)
 ...; have station #, now go to the institution file and get the info
"RTN","OOPSGUIS",22,0)
 ...I $$GET1^DIQ(4,FAC,101)=1 Q           ; FAC inactive, don't get
"RTN","OOPSGUIS",23,0)
 ...S SNAME=$$GET1^DIQ(4,FAC,.01) I $G(SNAME)="" Q
"RTN","OOPSGUIS",24,0)
 ...S SNUM=$$GET1^DIQ(4,FAC,99)
"RTN","OOPSGUIS",25,0)
 ...S VAL=SNAME_" = "_SNUM
"RTN","OOPSGUIS",26,0)
 ...S CN=CN+1,^TMP("OOPSINST",$J,CN)=FAC_":"_VAL_$C(10)
"RTN","OOPSGUIS",27,0)
 S CN=CN+1,^TMP("OOPSINST",$J,CN)="999999:All Stations"
"RTN","OOPSGUIS",28,0)
 I CN=1 D GETINST^OOPSGUI7(.ARR) Q   ; if only entry = all get all
"RTN","OOPSGUIS",29,0)
 S RESULTS=$NA(^TMP("OOPSINST",$J))
"RTN","OOPSGUIS",30,0)
 Q
"RTN","OOPSGUIS",31,0)
 ;
"RTN","OOPSGUIS",32,0)
SIGNCA7(RESULTS,INPUT,SIGN) ; Validates Electronic Signature and creates
"RTN","OOPSGUIS",33,0)
 ;                         validation code to ensure data not changed
"RTN","OOPSGUIS",34,0)
 ;  Input:   INPUT - FILE^FIELD^IEN where File and Field are the file 
"RTN","OOPSGUIS",35,0)
 ;                   and field the data is being filed into and IEN
"RTN","OOPSGUIS",36,0)
 ;                   is the internal record number.
"RTN","OOPSGUIS",37,0)
 ;            SIGN - the electronic signature to be encrypted
"RTN","OOPSGUIS",38,0)
 ; Output: RESULTS - is an array containing a list of fields that did
"RTN","OOPSGUIS",39,0)
 ;                   not pass data validation prior to applying the ES.
"RTN","OOPSGUIS",40,0)
 ;
"RTN","OOPSGUIS",41,0)
 N CALL,CHKSUM,IEN,ESIG,FILE,FLD,FLD48,FLD84,FLD95,FLD96,FLD97,REC,REC1
"RTN","OOPSGUIS",42,0)
 N SIGNBLK,VALID,VER,DR,DA,DIE
"RTN","OOPSGUIS",43,0)
 S RESULTS="SIGNED"
"RTN","OOPSGUIS",44,0)
 S FILE=$P($G(INPUT),U),FLD=$P($G(INPUT),U,2),IEN=$P($G(INPUT),U,3)
"RTN","OOPSGUIS",45,0)
 I '$G(IEN)!('$G(FILE))!('$G(FLD)) S RESULTS(1)="Invalid Parameters" Q
"RTN","OOPSGUIS",46,0)
 I $G(SIGN)="" S RESULTS="No signature passed in" Q
"RTN","OOPSGUIS",47,0)
 S CALL=$S(FLD=48:"E",FLD=84:"W",1:"")
"RTN","OOPSGUIS",48,0)
 I CALL="" S RESULTS="Invalid field number" Q
"RTN","OOPSGUIS",49,0)
 ; S VALID=0 D CHKFLD(IEN,CALL.VALID) I 'VALID Q
"RTN","OOPSGUIS",50,0)
 S ESIG=$$HASH($$DECRYP^XUSRB1(SIGN))
"RTN","OOPSGUIS",51,0)
 I $G(ESIG)=""!(ESIG'=$P($G(^VA(200,DUZ,20)),U,4)="") D  Q
"RTN","OOPSGUIS",52,0)
 . S RESULTS="Invalid Electronic Signature"
"RTN","OOPSGUIS",53,0)
 S SIGNBLK=$P($G(^VA(200,DUZ,20)),U,2)
"RTN","OOPSGUIS",54,0)
 I SIGNBLK="" S RESULTS="No signature block on file" Q
"RTN","OOPSGUIS",55,0)
 K DR S DIE="^OOPS("_FILE_",",DA=IEN
"RTN","OOPSGUIS",56,0)
 D NOW^%DTC S DTIME=%
"RTN","OOPSGUIS",57,0)
 I CALL="E" D
"RTN","OOPSGUIS",58,0)
 .S REC=$G(^OOPS(FILE,IEN,0)),REC1=$G(^OOPS(FILE,IEN,"CA7S2"))
"RTN","OOPSGUIS",59,0)
 .S CHKSUM=$$SUM(IEN_U_REC_U_REC1)
"RTN","OOPSGUIS",60,0)
 .S FLD48=$$ENCODE(SIGNBLK,DUZ,CHKSUM),FLD96=1
"RTN","OOPSGUIS",61,0)
 .S FLD95=$$SUM(SIGNBLK)
"RTN","OOPSGUIS",62,0)
 .S DR="47////^S X=+DUZ;48////^S X=FLD48;49////^S X=DTIME"
"RTN","OOPSGUIS",63,0)
 .S DR=DR_";95////^S X=FLD95;96////^S X=FLD96"
"RTN","OOPSGUIS",64,0)
 I CALL="W" D
"RTN","OOPSGUIS",65,0)
 .S REC=$G(^OOPS(FILE,IEN,"CA7S10")),REC1=$G(^OOPS(FILE,IEN,"CA7S13"))
"RTN","OOPSGUIS",66,0)
 .S CHKSUM=$$SUM(IEN_U_REC_U_REC1)
"RTN","OOPSGUIS",67,0)
 .S FLD84=$$ENCODE(SIGNBLK,DUZ,CHKSUM)
"RTN","OOPSGUIS",68,0)
 .S FLD97=$$SUM(SIGNBLK)
"RTN","OOPSGUIS",69,0)
 .S DR="83////^S X=+DUZ;84////^S X=FLD84;85////^S X=DTIME"
"RTN","OOPSGUIS",70,0)
 .S DR=DR_";97////^S X=FLD97"
"RTN","OOPSGUIS",71,0)
 D ^DIE
"RTN","OOPSGUIS",72,0)
 I $G(Y)'="" S RESULTS="Problem filing E-Signature" Q
"RTN","OOPSGUIS",73,0)
 ; patch 11 - send bulletin when employee signs CA7
"RTN","OOPSGUIS",74,0)
 I CALL="E" D
"RTN","OOPSGUIS",75,0)
 .N GRP,X0,STR
"RTN","OOPSGUIS",76,0)
 .S X0=$P($G(^OOPS(2264,IEN,0)),U,5)
"RTN","OOPSGUIS",77,0)
 .S STR=$G(^OOPS(2260,X0,0)) K XMY
"RTN","OOPSGUIS",78,0)
 .S XMB(1)=$$GET1^DIQ(2260,X0,4)
"RTN","OOPSGUIS",79,0)
 .S XMB(2)=$P(STR,U,1)
"RTN","OOPSGUIS",80,0)
 .S XMB="OOPS EMPSIGNCA7"
"RTN","OOPSGUIS",81,0)
 .S GRP="OOPS WCP"
"RTN","OOPSGUIS",82,0)
 .D MFAC^OOPSMBUL
"RTN","OOPSGUIS",83,0)
 .D ^XMB K XMB,XMY,XMM,XMDT
"RTN","OOPSGUIS",84,0)
 Q
"RTN","OOPSGUIS",85,0)
HASH(X) ;
"RTN","OOPSGUIS",86,0)
 D HASH^XUSHSHP
"RTN","OOPSGUIS",87,0)
 Q X
"RTN","OOPSGUIS",88,0)
ENCODE(X,X1,X2) ; X=SIGN BLK, X1=DUZ, X2=CHKSUM CRITICAL FIELDS
"RTN","OOPSGUIS",89,0)
 D EN^XUSHSHP
"RTN","OOPSGUIS",90,0)
 Q X
"RTN","OOPSGUIS",91,0)
DECODE(RESULTS,IEN,CALL,FORM) ;
"RTN","OOPSGUIS",92,0)
 ; Call to return electronic signature to readable form
"RTN","OOPSGUIS",93,0)
 ;  Input:  IEN    - internal record number of CA7 case
"RTN","OOPSGUIS",94,0)
 ;         CALL    - call menu - either E (Employee) or W (Workers Comp)
"RTN","OOPSGUIS",95,0)
 ;         FORM    - form - right now only expects CA7
"RTN","OOPSGUIS",96,0)
 ; Output: RESULTS - readable electronic signature
"RTN","OOPSGUIS",97,0)
 ;
"RTN","OOPSGUIS",98,0)
 N FILE,NODE,REC,REC1,VAL,VALID,VER,X,X1,X2
"RTN","OOPSGUIS",99,0)
 S RESULTS="",VALID=1
"RTN","OOPSGUIS",100,0)
 I '$G(IEN)!($G(CALL)="")!($G(FORM)="") Q
"RTN","OOPSGUIS",101,0)
 S (NODE,FILE,VER)=""
"RTN","OOPSGUIS",102,0)
 I FORM="CA7" S FILE=2264
"RTN","OOPSGUIS",103,0)
 S NODE=$S(CALL="E":"CA7S7",CALL="W":"CA7S15",1:"")
"RTN","OOPSGUIS",104,0)
 I FILE=""!(NODE="") Q
"RTN","OOPSGUIS",105,0)
 S VER=$P($G(^OOPS(FILE,IEN,"CA7S7")),U,5) I VER'=1 Q
"RTN","OOPSGUIS",106,0)
 I CALL="E" D
"RTN","OOPSGUIS",107,0)
 .S VAL=$P($G(^OOPS(FILE,IEN,"CA7S7")),U,4) I VAL="" S VALID=0
"RTN","OOPSGUIS",108,0)
 .S REC=$G(^OOPS(FILE,IEN,0)),REC1=$G(^OOPS(FILE,IEN,"CA7S2"))
"RTN","OOPSGUIS",109,0)
 I CALL="W" D
"RTN","OOPSGUIS",110,0)
 .S VAL=$P($G(^OOPS(FILE,IEN,"CA7S15")),U,11) I VAL="" S VALID=0
"RTN","OOPSGUIS",111,0)
 .S REC=$G(^OOPS(FILE,IEN,"CA7S10")),REC1=$G(^OOPS(FILE,IEN,"CA7S13"))
"RTN","OOPSGUIS",112,0)
 ;
"RTN","OOPSGUIS",113,0)
 I 'VALID Q
"RTN","OOPSGUIS",114,0)
 S X=$P($G(^OOPS(FILE,IEN,NODE)),U,2) I X="" Q       ; ES VALIDATION #
"RTN","OOPSGUIS",115,0)
 S X1=$P($G(^OOPS(FILE,IEN,NODE)),U,1)               ; USER NUMBER
"RTN","OOPSGUIS",116,0)
 S X2=$$SUM(IEN_U_REC_U_REC1)                        ; CHECKSUM
"RTN","OOPSGUIS",117,0)
 D DE^XUSHSHP
"RTN","OOPSGUIS",118,0)
 ; I $$SUM(X)'=VAL S X="DECODING FAILED"
"RTN","OOPSGUIS",119,0)
 S RESULTS=X
"RTN","OOPSGUIS",120,0)
 Q
"RTN","OOPSGUIS",121,0)
 ;
"RTN","OOPSGUIS",122,0)
SUM(X) ;CALCULATE CHECKSUM VALUE FOR STRING
"RTN","OOPSGUIS",123,0)
 N I,Y
"RTN","OOPSGUIS",124,0)
 S Y=0 F I=1:1:$L(X) S Y=$A(X,I)*I+Y
"RTN","OOPSGUIS",125,0)
 Q Y
"RTN","OOPSGUIS",126,0)
CLRES(IEN,CALL,FORM) ; Clear signature from CA7, if necessary
"RTN","OOPSGUIS",127,0)
 ;   Input:  IEN - record IEN for CA7
"RTN","OOPSGUIS",128,0)
 ;          CALL - calling menu - either E (EMP) or W (Workers comp)
"RTN","OOPSGUIS",129,0)
 ;          FORM - form where ES should be removed (now only CA7)
"RTN","OOPSGUIS",130,0)
 N FILE,SIG,NODE,FIELD
"RTN","OOPSGUIS",131,0)
 S (FILE,SIG,NODE,FIELD)="",RESULTS="FAILED"
"RTN","OOPSGUIS",132,0)
 I ('$G(IEN)),($G(CALL)=""),($G(FORM)="") Q
"RTN","OOPSGUIS",133,0)
 I FORM="CA7" S FILE=2264
"RTN","OOPSGUIS",134,0)
 I FILE=2264 D
"RTN","OOPSGUIS",135,0)
 .I CALL="E" S SIG="CA7S7;1,5"
"RTN","OOPSGUIS",136,0)
 .I CALL="W" S SIG="CA7S15;1,3"
"RTN","OOPSGUIS",137,0)
 S NODE=$P(SIG,";") Q:NODE="" 
"RTN","OOPSGUIS",138,0)
 S FIELD=$P(SIG,";",2)
"RTN","OOPSGUIS",139,0)
 I '$D(^OOPS(FILE,IEN,NODE)) Q
"RTN","OOPSGUIS",140,0)
 F I=$P(FIELD,","):1:$P(FIELD,",",2) S $P(^OOPS(FILE,IEN,NODE),U,I)=""
"RTN","OOPSGUIS",141,0)
 Q
"RTN","OOPSGUIS",142,0)
GETDLOC(RESULTS,INPUT) ; Get Detail Loc for specific incident setting
"RTN","OOPSGUIS",143,0)
 ;  Input:  INPUT - File _"^"_Station IEN from a station in the 
"RTN","OOPSGUIS",144,0)
 ;                  site par file_"^"_rec ien from file to retrieve
"RTN","OOPSGUIS",145,0)
 ;                  subfile information for.
"RTN","OOPSGUIS",146,0)
 ; Output: RESULTS - listing of valid sub file data
"RTN","OOPSGUIS",147,0)
 ;
"RTN","OOPSGUIS",148,0)
 N CN,FIEN,FILE,I,REC,STA
"RTN","OOPSGUIS",149,0)
 S CN=0
"RTN","OOPSGUIS",150,0)
 S FILE=$P($G(INPUT),U,1),STA=$P($G(INPUT),U,2),FIEN=$P($G(INPUT),U,3)
"RTN","OOPSGUIS",151,0)
 I FILE=""!(STA="")!(FIEN="") D  Q
"RTN","OOPSGUIS",152,0)
 . S ^TMP($J,"DLOC",CN)="MISSING PARAMETERS",RESULTS=$NA(^TMP($J,"DLOC"))
"RTN","OOPSGUIS",153,0)
 S REC=$O(^OOPS(FILE,FIEN,1,"B",STA,""))
"RTN","OOPSGUIS",154,0)
 I '$G(REC) S ^TMP($J,"DLOC",CN)="NO DETAIL LOCATIONS LOADED",RESULTS=$NA(^TMP($J,"DLOC")) Q
"RTN","OOPSGUIS",155,0)
 I '$D(^OOPS(FILE,"F",REC,FIEN)) D  Q
"RTN","OOPSGUIS",156,0)
 .S ^TMP($J,"DLOC",CN)="NO DETAIL LOCATIONS LOADED",RESULTS=$NA(^TMP($J,"DLOC"))
"RTN","OOPSGUIS",157,0)
 S DATA=""
"RTN","OOPSGUIS",158,0)
 F  S DATA=$O(^OOPS(FILE,"F",REC,FIEN,DATA)) Q:DATA=""  S DATAIEN=0 D
"RTN","OOPSGUIS",159,0)
 .S DATAIEN=$O(^OOPS(FILE,"F",REC,FIEN,DATA,DATAIEN))
"RTN","OOPSGUIS",160,0)
 .S ^TMP($J,"DLOC",CN)=DATA_U_DATAIEN,CN=CN+1
"RTN","OOPSGUIS",161,0)
 S RESULTS=$NA(^TMP($J,"DLOC"))
"RTN","OOPSGUIS",162,0)
 Q
"RTN","OOPSGUIT")
0^12^B78632335
"RTN","OOPSGUIT",1,0)
OOPSGUIT ;WIOFO/LLH-RPC Rtn for Type of Incident rpt ;11/5/01 
"RTN","OOPSGUIT",2,0)
 ;;2.0;ASISTS;**4,7,11**;Jun 03, 2002
"RTN","OOPSGUIT",3,0)
 ;
"RTN","OOPSGUIT",4,0)
ENT(RESULTS,TRPT,CSTAT,STDT,ENDDT,LTNTT,STAT,PSTAT) ;
"RTN","OOPSGUIT",5,0)
 N DATA,CNT,CS,CS1,EDATE,OOPS,LOST,LP,SDATE,TOT,RPTTY
"RTN","OOPSGUIT",6,0)
 N STATION,LOSTTIME,NODE,OOPDA,PER,X,Y
"RTN","OOPSGUIT",7,0)
 S RPTTY=$$REPORT(),CS=$S(CSTAT="O":0,CSTAT="C":1,1:"")
"RTN","OOPSGUIT",8,0)
 S LOST=$S(LTNTT="L":"Y",1:""),(SDATE,EDATE)=""
"RTN","OOPSGUIT",9,0)
 S X=STDT D ^%DT S SDATE=Y,X=ENDDT D ^%DT S EDATE=Y
"RTN","OOPSGUIT",10,0)
 S SDATE=(SDATE-1)_".9999",EDATE=EDATE_".9999",LP="",OOPDA=""
"RTN","OOPSGUIT",11,0)
 F LP=SDATE:0 S LP=$O(^OOPS(2260,"AD",LP)) Q:(LP'>0)!(LP>EDATE)  D
"RTN","OOPSGUIT",12,0)
 .F  S OOPDA=$O(^OOPS(2260,"AD",LP,OOPDA)) Q:OOPDA'>0  D
"RTN","OOPSGUIT",13,0)
 ..S OOPS(0)=$G(^OOPS(2260,OOPDA,0))
"RTN","OOPSGUIT",14,0)
 ..S CS1=$P(OOPS(0),U,6)
"RTN","OOPSGUIT",15,0)
 ..I $G(CS1)>1 Q               ; only open & closed cases
"RTN","OOPSGUIT",16,0)
 ..I (CS'=""),(CS'=CS1) Q      ; if 'All cases, case status must match
"RTN","OOPSGUIT",17,0)
 ..S PER=$$GET1^DIQ(2260,OOPDA,2,"I")
"RTN","OOPSGUIT",18,0)
 ..I (+PSTAT)&(PSTAT'[(PER_"^")) Q
"RTN","OOPSGUIT",19,0)
 ..S STATION=$$GET1^DIQ(2260,OOPDA,13,"I")
"RTN","OOPSGUIT",20,0)
 ..I STAT'="A",(STATION'=STAT) Q
"RTN","OOPSGUIT",21,0)
 ..S LOSTTIME=""
"RTN","OOPSGUIT",22,0)
 ..I $O(^OOPS(2260,OOPDA,"OUTC","AC","A","A","")) S LOSTTIME="Y"
"RTN","OOPSGUIT",23,0)
 ..I LOST="Y",(LOSTTIME'="Y") Q
"RTN","OOPSGUIT",24,0)
 ..I RPTTY=3 D
"RTN","OOPSGUIT",25,0)
 ...N INC S INC=$$GET1^DIQ(2260,OOPDA,RPTTY_":.01")
"RTN","OOPSGUIT",26,0)
 ...I $G(INC)="" S INC="Unknown"
"RTN","OOPSGUIT",27,0)
 ...S:$D(DATA(INC))=0 DATA(INC)=0 S DATA(INC)=DATA(INC)+1
"RTN","OOPSGUIT",28,0)
 ..I RPTTY=15 D
"RTN","OOPSGUIT",29,0)
 ...N DIC,DR,DA,DIQ,FLD,NAME,OCC,IEN450,X,Y
"RTN","OOPSGUIT",30,0)
 ...S NAME=$$GET1^DIQ(2260,OOPDA,1),FLD=16
"RTN","OOPSGUIT",31,0)
 ...S DIC="^PRSPC(",DIC(0)="Z",X=NAME D ^DIC
"RTN","OOPSGUIT",32,0)
 ...I Y>0 D
"RTN","OOPSGUIT",33,0)
 ....K DIQ S DR=FLD,DA=+Y,IEN450=+Y,DIQ="OOPS",DIQ(0)="IE"
"RTN","OOPSGUIT",34,0)
 ....D EN^DIQ1 K DIQ
"RTN","OOPSGUIT",35,0)
 ...S OCC=$$GET1^DIQ(2260,OOPDA,15,"I")
"RTN","OOPSGUIT",36,0)
 ...I $G(IEN450),$G(OCC)'="",(OCC=$E($G(OOPS(450,IEN450,FLD,"I")),1,4)) D
"RTN","OOPSGUIT",37,0)
 ....S OCC=OCC_" - "_OOPS(450,IEN450,FLD,"E")
"RTN","OOPSGUIT",38,0)
 ...I $G(OCC)="" S OCC="Unknown"
"RTN","OOPSGUIT",39,0)
 ...S:$D(DATA(OCC))=0 DATA(OCC)=0 S DATA(OCC)=DATA(OCC)+1
"RTN","OOPSGUIT",40,0)
 ..I RPTTY=29 D
"RTN","OOPSGUIT",41,0)
 ...N CHAR S CHAR=$$GET1^DIQ(2260,OOPDA,RPTTY_":.01")
"RTN","OOPSGUIT",42,0)
 ...I $G(CHAR)="" S CHAR="Unknown"
"RTN","OOPSGUIT",43,0)
 ...S:$D(DATA(CHAR))=0 DATA(CHAR)=0 S DATA(CHAR)=DATA(CHAR)+1
"RTN","OOPSGUIT",44,0)
 ..I RPTTY=86 D
"RTN","OOPSGUIT",45,0)
 ...N SERV S SERV=$$GET1^DIQ(2260,OOPDA,RPTTY_":.01")
"RTN","OOPSGUIT",46,0)
 ...I $G(SERV)="" S SERV="Unknown"
"RTN","OOPSGUIT",47,0)
 ...S:$D(DATA(SERV))=0 DATA(SERV)=0 S DATA(SERV)=DATA(SERV)+1
"RTN","OOPSGUIT",48,0)
 ..I RPTTY=30 D
"RTN","OOPSGUIT",49,0)
 ...N BODY S BODY=$$GET1^DIQ(2260,OOPDA,RPTTY_":1")
"RTN","OOPSGUIT",50,0)
 ...F I=1:1 Q:$P($T(BODY+I),";",3)="Q"  I $P($T(BODY+I),";",4)[(U_BODY_U) S BODY=$P($T(BODY+I),";",3) Q
"RTN","OOPSGUIT",51,0)
 ...I $G(BODY)="" S BODY="Unknown"
"RTN","OOPSGUIT",52,0)
 ...S:$D(DATA(BODY))=0 DATA(BODY)=0 S DATA(BODY)=DATA(BODY)+1
"RTN","OOPSGUIT",53,0)
 ..I RPTTY=999 D
"RTN","OOPSGUIT",54,0)
 ...N DOI,DOW
"RTN","OOPSGUIT",55,0)
 ...S DOI=$$GET1^DIQ(2260,OOPDA,4,"I"),DOW=$$DOW^XLFDT(DOI)
"RTN","OOPSGUIT",56,0)
 ...S DOW=$S(DOW="Friday":"6Friday",DOW="Monday":"2Monday",DOW="Saturday":"7Saturday",DOW="Sunday":"1Sunday",DOW="Thursday":"5Thursday",DOW="Tuesday":"3Tuesday",DOW="Wednesday":"4Wednesday",1:"Unk")
"RTN","OOPSGUIT",57,0)
 ...I $G(DOI)="" S DOI="Unknown"
"RTN","OOPSGUIT",58,0)
 ...S:$D(DATA(DOW))=0 DATA(DOW)=0 S DATA(DOW)=DATA(DOW)+1
"RTN","OOPSGUIT",59,0)
 ..I RPTTY=9999 D
"RTN","OOPSGUIT",60,0)
 ...N LABEL,TDOI,TIME S TDOI=$P($$GET1^DIQ(2260,OOPDA,4),"@",2)
"RTN","OOPSGUIT",61,0)
 ...I $G(TDOI)="" S TDOI="Unknown"
"RTN","OOPSGUIT",62,0)
 ...I TDOI'="Unknown" D
"RTN","OOPSGUIT",63,0)
 ....I +$P(TDOI,":")&($P(TDOI,":")'=24) S TIME=$P(TDOI,":")
"RTN","OOPSGUIT",64,0)
 ....E  S TIME=24
"RTN","OOPSGUIT",65,0)
 ....S LABEL=TIME_":"_"00 - "_TIME_":59"
"RTN","OOPSGUIT",66,0)
 ...I TDOI="Unknown" S LABEL="Unknown"
"RTN","OOPSGUIT",67,0)
 ...S:$D(DATA(LABEL))=0 DATA(LABEL)=0 S DATA(LABEL)=DATA(LABEL)+1
"RTN","OOPSGUIT",68,0)
 S TOT=1,NODE="",CNT=0
"RTN","OOPSGUIT",69,0)
 F  S NODE=$O(DATA(NODE)) Q:NODE=""  S RESULTS(TOT)=NODE_"^"_DATA(NODE),CNT=CNT+$P(RESULTS(TOT),U,2),TOT=TOT+1
"RTN","OOPSGUIT",70,0)
 I CNT S RESULTS(0)=CNT
"RTN","OOPSGUIT",71,0)
 Q
"RTN","OOPSGUIT",72,0)
REPORT() ; Get Fld # to sort on
"RTN","OOPSGUIT",73,0)
 I TRPT="Type of Incidents" S RPTTY=3
"RTN","OOPSGUIT",74,0)
 I TRPT="Occupation Code" S RPTTY=15
"RTN","OOPSGUIT",75,0)
 I TRPT="Characterization of Injury" S RPTTY=29
"RTN","OOPSGUIT",76,0)
 I TRPT="Service" S RPTTY=86
"RTN","OOPSGUIT",77,0)
 I TRPT="Body Parts" S RPTTY=30
"RTN","OOPSGUIT",78,0)
 I TRPT="Day of Week" S RPTTY=999
"RTN","OOPSGUIT",79,0)
 I TRPT="Time of Day" S RPTTY=9999
"RTN","OOPSGUIT",80,0)
 Q RPTTY
"RTN","OOPSGUIT",81,0)
BODY ; group the body parts to min # of columns
"RTN","OOPSGUIT",82,0)
 ;;Abdomen;^BA^V5^VI^V4^V3^VL^VM^VS^
"RTN","OOPSGUIT",83,0)
 ;;Arm(s) Lower;^AS^AB^A4^A6^A3^A5^
"RTN","OOPSGUIT",84,0)
 ;;Arm(s) Upper;^AX^AZ^A2^A1^
"RTN","OOPSGUIT",85,0)
 ;;Back (Lumbar Region);^BL^
"RTN","OOPSGUIT",86,0)
 ;;Back (Upper);^BU^
"RTN","OOPSGUIT",87,0)
 ;;Chest;^BC^RS^
"RTN","OOPSGUIT",88,0)
 ;;Ear(s);^H4^C2^H3^C1^
"RTN","OOPSGUIT",89,0)
 ;;Elbow;^EB^ES^
"RTN","OOPSGUIT",90,0)
 ;;Eye(s);^H2^C4^H1^C3^
"RTN","OOPSGUIT",91,0)
 ;;Face;^CK^HC^HF^CJ^HM^CM^HN^CN^CD^CT^
"RTN","OOPSGUIT",92,0)
 ;;Foot,Includes Toes;^PB^G2^G3^G4^PS^G1^
"RTN","OOPSGUIT",93,0)
 ;;Hand(s),Includes fingers;^F2^F8^MB^F4^F6^TB^FB^FS^F1^F7^MS^F3^F5^TS^
"RTN","OOPSGUIT",94,0)
 ;;Knees;^KB^KS^
"RTN","OOPSGUIT",95,0)
 ;;Leg(s), lower;^L4^L3^
"RTN","OOPSGUIT",96,0)
 ;;Leg(s), upper;^LX^LZ^
"RTN","OOPSGUIT",97,0)
 ;;Neck;^HK^CL^CR^
"RTN","OOPSGUIT",98,0)
 ;;Not Elsewhere Classified;^XZ^L2^LB^BZ^XX^VN^RP^LS^L1^
"RTN","OOPSGUIT",99,0)
 ;;Reproductive Organs;^B2^B4^BP^VR^B1^B3^B5^
"RTN","OOPSGUIT",100,0)
 ;;Ribs;^RB^RC^
"RTN","OOPSGUIT",101,0)
 ;;Shoulder;^R2^R4^SB^R1^R3^SS^
"RTN","OOPSGUIT",102,0)
 ;;Skull/Head;^CB^HX^HZ^CX^CZ^HS^CC^CS^
"RTN","OOPSGUIT",103,0)
 ;;Spinal Cord;^VC^RV^
"RTN","OOPSGUIT",104,0)
 ;;Thorax;^VH^V2^V1^
"RTN","OOPSGUIT",105,0)
 ;;Trunk;^BS^RZ^BX^VX^VZ^RX^BW^
"RTN","OOPSGUIT",106,0)
 ;;Q
"RTN","OOPSGUIT",107,0)
 Q
"RTN","OOPSGUIT",108,0)
ACCID(RESULTS,INPUT,CALL) ; Print Accident Report Status report - get data
"RTN","OOPSGUIT",109,0)
 ;  Input: INPUT - START,END DATE, & STATION. Format is STARTDATE^ 
"RTN","OOPSGUIT",110,0)
 ;           ENDDATE^STA^CASESTATUS.  STA is A or IEN of station,
"RTN","OOPSGUIT",111,0)
 ;           case status = open 'O', closed 'C', or both 'A'.
"RTN","OOPSGUIT",112,0)
 ;         CALL - calling menu. Excludes name if called from Union menu
"RTN","OOPSGUIT",113,0)
 ; Output:  - RESULTS contains the data to be displayed in the report
"RTN","OOPSGUIT",114,0)
 N ARR,CN,IEN,SDATE,SIGN,SIGSTR,STDT,STA,ENDDT,EDATE,X,Y,SUPSTR,EMPSTR
"RTN","OOPSGUIT",115,0)
 N CASE,CAT,DOI,EMP,INC,ISEMP,PERSON,SAF,SSN,SSN1,SP,SUP,WCP,PCE
"RTN","OOPSGUIT",116,0)
 ; patch 4 llh - select by case status ; patch 11, get super's name
"RTN","OOPSGUIT",117,0)
 N CS,STATUS,SUPER,S48,S6,S20,S12
"RTN","OOPSGUIT",118,0)
 S S48="                                                "
"RTN","OOPSGUIT",119,0)
 S S6="      ",S12="            ",S20="                    "
"RTN","OOPSGUIT",120,0)
 K ^TMP($J,"ACCID")
"RTN","OOPSGUIT",121,0)
 S CN=1,RESULTS(0)="Processing..."
"RTN","OOPSGUIT",122,0)
 S STDT=$P($G(INPUT),U),ENDDT=$P($G(INPUT),U,2)
"RTN","OOPSGUIT",123,0)
 S STA=$P($G(INPUT),U,3),STATUS=$P($G(INPUT),U,4)
"RTN","OOPSGUIT",124,0)
 I (STDT="")!(ENDDT="")!(STA="")!(STATUS="") D  Q
"RTN","OOPSGUIT",125,0)
 .S RESULTS(0)="Input parameters missing, cannot run report." Q
"RTN","OOPSGUIT",126,0)
 S STATUS=$S(STATUS="O":0,STATUS="C":1,1:"")
"RTN","OOPSGUIT",127,0)
 S (SDATE,EDATE)=""
"RTN","OOPSGUIT",128,0)
 S X=STDT D ^%DT S SDATE=Y
"RTN","OOPSGUIT",129,0)
 S X=ENDDT D ^%DT S EDATE=Y
"RTN","OOPSGUIT",130,0)
 S SDATE=(SDATE-1)_".9999",EDATE=EDATE_".9999"
"RTN","OOPSGUIT",131,0)
 S SSN="" I CALL="Employee" S SSN=$$GET1^DIQ(200,DUZ,9)
"RTN","OOPSGUIT",132,0)
 S LP="",IEN=""
"RTN","OOPSGUIT",133,0)
 F LP=SDATE:0 S LP=$O(^OOPS(2260,"AD",LP)) Q:(LP'>0)!(LP>EDATE)  D
"RTN","OOPSGUIT",134,0)
 .F  S IEN=$O(^OOPS(2260,"AD",LP,IEN)) Q:IEN'>0  D
"RTN","OOPSGUIT",135,0)
 ..S CS=$$GET1^DIQ(2260,IEN,51,"I")
"RTN","OOPSGUIT",136,0)
 ..I $G(CS)>1 Q               ; exclude deleted, amended cases
"RTN","OOPSGUIT",137,0)
 ..I (STATUS'=""),(CS'=STATUS) Q  ; if 'All cases, status must match
"RTN","OOPSGUIT",138,0)
 ..S STATION=$P(^OOPS(2260,IEN,"2162A"),U,9)
"RTN","OOPSGUIT",139,0)
 ..I $G(STA)'="A",STATION'=STA Q
"RTN","OOPSGUIT",140,0)
 ..I (CALL="Supervisor"),($$GET1^DIQ(2260,IEN,53,"I")'=DUZ&($$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ)) Q
"RTN","OOPSGUIT",141,0)
 ..S (ARR,CASE,PERSON,SSN1,DOI,INC,CAT,WCP,EMP,SUP,SUPER,SAF,SP)=""
"RTN","OOPSGUIT",142,0)
 ..S CASE=$$GET1^DIQ(2260,IEN,.01),SUPER=$$GET1^DIQ(2260,IEN,53)
"RTN","OOPSGUIT",143,0)
 ..S (PERSON,SSN1)=""
"RTN","OOPSGUIT",144,0)
 ..I CALL'="Union" S PERSON=$E($$GET1^DIQ(2260,IEN,1),1,30),SSN1=$$GET1^DIQ(2260,IEN,5)
"RTN","OOPSGUIT",145,0)
 ..S INC=$$GET1^DIQ(2260,IEN,52,"I"),DOI=$$GET1^DIQ(2260,IEN,4)
"RTN","OOPSGUIT",146,0)
 ..S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSGUIT",147,0)
 ..; patch 4 llh - get case status title
"RTN","OOPSGUIT",148,0)
 ..S CS=$S(CS=0:"Open",CS=1:"Closed",1:"") I SSN1="" S SSN1="           "
"RTN","OOPSGUIT",149,0)
 ..S ARR=" ",^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",150,0)
 ..S ARR="Case Number   Name                                 SSN              Case Status    Date/Time of Incident"
"RTN","OOPSGUIT",151,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",152,0)
 ..S PERSON=PERSON_"                            ",PERSON=$E(PERSON,1,37)
"RTN","OOPSGUIT",153,0)
 ..I $L(CASE)=10 S CASE=CASE_" "
"RTN","OOPSGUIT",154,0)
 ..;patch 4 llh - pad case status title if needed for alignment
"RTN","OOPSGUIT",155,0)
 ..I $L(CS)=4 S CS=CS_"  "
"RTN","OOPSGUIT",156,0)
 ..S ARR=CASE_"   "_PERSON_SSN1_"      "_CS_"         "_DOI
"RTN","OOPSGUIT",157,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",158,0)
 ..I CALL="Employee" Q:SSN'=SSN1
"RTN","OOPSGUIT",159,0)
 ..S ISEMP=$$ISEMP^OOPSUTL4(IEN)
"RTN","OOPSGUIT",160,0)
 ..I 'ISEMP S ISEMP="N/A("_$E($$GET1^DIQ(2260,IEN,2,"E"),1,10)_")"
"RTN","OOPSGUIT",161,0)
 ..S SIGN="",SIGSTR="^^^^^^"
"RTN","OOPSGUIT",162,0)
 ..S SIGN=$P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC)
"RTN","OOPSGUIT",163,0)
 ..S $P(SIGSTR,U,INC)=$S('SIGN:"Un-Signed",SIGN:"Signed",1:"")
"RTN","OOPSGUIT",164,0)
 ..I 'ISEMP S $P(SIGSTR,U,INC)=ISEMP
"RTN","OOPSGUIT",165,0)
 ..S (SIGN,PCE,SUPSTR)=""
"RTN","OOPSGUIT",166,0)
 ..S SIGN=$$EDSTA^OOPSUTL1(IEN,"S"),PCE=INC+2
"RTN","OOPSGUIT",167,0)
 ..I ISEMP S $P(SIGSTR,U,PCE)=$S('$P(SIGN,U,INC):"Un-Signed",$P(SIGN,U,INC):"Signed",1:"")
"RTN","OOPSGUIT",168,0)
 ..S $P(SIGSTR,U,5)=$S($P(SIGN,U,3):"Signed",1:"Un-Signed")
"RTN","OOPSGUIT",169,0)
 ..S SIGN="",SIGN=$$EDSTA^OOPSUTL1(IEN,"O")
"RTN","OOPSGUIT",170,0)
 ..S $P(SIGSTR,U,6)=$S($P(SIGN,U):"Signed",1:"Un-Signed")
"RTN","OOPSGUIT",171,0)
 ..S SIGN="",SIGN=$$GET1^DIQ(2260,IEN,68)
"RTN","OOPSGUIT",172,0)
 ..S $P(SIGSTR,U,7)=$S((($P(SIGN,U)="")&ISEMP):"Un-Signed",($P(SIGN,U)'=""):"Signed",1:"")
"RTN","OOPSGUIT",173,0)
 ..F I=1:1:7 I $P(SIGSTR,U,I)="Signed" D
"RTN","OOPSGUIT",174,0)
 ...I I=1 S $P(SIGSTR,U,1)=$$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,121,"I")),"2DZ")
"RTN","OOPSGUIT",175,0)
 ...I I=2 S $P(SIGSTR,U,2)=$$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,223,"I")),"2DZ")
"RTN","OOPSGUIT",176,0)
 ...I I=3 S $P(SIGSTR,U,3)=$$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,171,"I")),"2DZ")_" "
"RTN","OOPSGUIT",177,0)
 ...I I=4 S $P(SIGSTR,U,4)=$$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,267,"I")),"2DZ")_" "
"RTN","OOPSGUIT",178,0)
 ...I I=5 S $P(SIGSTR,U,5)=$$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,46,"I")),"2DZ")
"RTN","OOPSGUIT",179,0)
 ...I I=6 S $P(SIGSTR,U,6)=$$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,50,"I")),"2DZ")
"RTN","OOPSGUIT",180,0)
 ...I I=7 S $P(SIGSTR,U,7)=$$FMTE^XLFDT(($$GET1^DIQ(2260,IEN,69,"I")),"2DZ")
"RTN","OOPSGUIT",181,0)
 ..S ARR=S48_"          "_"CA1"_S12_"CA2"_S12_"2162"_S12_"WCP"
"RTN","OOPSGUIT",182,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",183,0)
 ..S ARR=S48_"          "_"---"_S12_"---"_S12_"----"_S12_"---"
"RTN","OOPSGUIT",184,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",185,0)
 ..S EMPSTR=S20_S20_"     Employee:    "
"RTN","OOPSGUIT",186,0)
 ..I INC=1 S ARR=EMPSTR_$P(SIGSTR,U,1)
"RTN","OOPSGUIT",187,0)
 ..I INC=2 S ARR=EMPSTR_S12_"   "_$P(SIGSTR,U,2)
"RTN","OOPSGUIT",188,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",189,0)
 ..; patch 11 - add supervisors name
"RTN","OOPSGUIT",190,0)
 ..I $G(SUPER)'="" S SUPSTR=SUPER_", Supervisor:    " F I=1:1:58 Q:$L(SUPSTR)>57  S SUPSTR=" "_SUPSTR
"RTN","OOPSGUIT",191,0)
 ..E  S SUPSTR=S20_S20_"   Supervisor:    "
"RTN","OOPSGUIT",192,0)
 ..I 'ISEMP S SUPSTR=SUPSTR_"         "
"RTN","OOPSGUIT",193,0)
 ..I INC=1 D
"RTN","OOPSGUIT",194,0)
 ...I $P(SIGSTR,U,3)="Signed" S ARR=SUPSTR_$P(SIGSTR,U,3)_S6_S12_$P(SIGSTR,U,5)
"RTN","OOPSGUIT",195,0)
 ...E  S ARR=SUPSTR_$P(SIGSTR,U,3)_S20_" "_$P(SIGSTR,U,5)
"RTN","OOPSGUIT",196,0)
 ..I INC=2 D
"RTN","OOPSGUIT",197,0)
 ...I $P(SIGSTR,U,4)="Signed" S ARR=SUPSTR_S12_"   "_$P(SIGSTR,U,4)_"   "_$P(SIGSTR,U,5)
"RTN","OOPSGUIT",198,0)
 ...E  S ARR=SUPSTR_S12_"   "_$P(SIGSTR,U,4)_S6_$P(SIGSTR,U,5)
"RTN","OOPSGUIT",199,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",200,0)
 ..S ARR=S20_S12_"       Safety Officer:"_S20_S12_"  "_$P(SIGSTR,U,6)
"RTN","OOPSGUIT",201,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",202,0)
 ..S ARR=S20_S12_"        Workers' Comp:"_S48_"  "_$P(SIGSTR,U,7)
"RTN","OOPSGUIT",203,0)
 ..S ^TMP($J,"ACCID",CN)=ARR,CN=CN+1,ARR=""
"RTN","OOPSGUIT",204,0)
 S RESULTS=$NA(^TMP($J,"ACCID"))
"RTN","OOPSGUIT",205,0)
 Q
"RTN","OOPSGUIU")
0^17^B4223753
"RTN","OOPSGUIU",1,0)
OOPSGUIU ;WIOFO/LLH-RPC Broker calls for GUI ;03/25/04
"RTN","OOPSGUIU",2,0)
 ;;2.0;ASISTS;**11**;Jun 03, 2002
"RTN","OOPSGUIU",3,0)
 ;
"RTN","OOPSGUIU",4,0)
SERVICE ; calling this Service report but it really is Location
"RTN","OOPSGUIU",5,0)
 ; of injury and detail location of injury report
"RTN","OOPSGUIU",6,0)
 ; Note: to sort this report by station, add DSTXT as the first
"RTN","OOPSGUIU",7,0)
 ;       subscript in ARR
"RTN","OOPSGUIU",8,0)
 N DLOC,DLSTAIEN,DLOCTX,DS,DSTXT,LOC,LOCTX,TI
"RTN","OOPSGUIU",9,0)
 S LOC=$$GET1^DIQ(2260,IEN,27,"I"),LOCTX=$$GET1^DIQ(2260,IEN,27)
"RTN","OOPSGUIU",10,0)
 S DLOC=$$GET1^DIQ(2260,IEN,348),DS=$$GET1^DIQ(2260,IEN,13,"I")
"RTN","OOPSGUIU",11,0)
 S DSTXT=$$GET1^DIQ(2260,IEN,13)
"RTN","OOPSGUIU",12,0)
 S TI=$$GET1^DIQ(2260,IEN,3)
"RTN","OOPSGUIU",13,0)
 I ($G(TI)="") Q
"RTN","OOPSGUIU",14,0)
 I $G(LOCTX)="" S LOCTX="No Location Text,Loc Code ="_LOC
"RTN","OOPSGUIU",15,0)
 I LOC="" S ARR(TI,"NO LOC ENTERED"," - ")=$G(ARR(TI,"NO LOC ENTERED"," - "),0)+1 Q
"RTN","OOPSGUIU",16,0)
 I DLOC="" S ARR(TI,LOCTX,"NO DETAIL ENTERED")=$G(ARR(TI,LOCTX,"NO DETAIL ENTERED"),0)+1 Q
"RTN","OOPSGUIU",17,0)
 I DLOC'="" D
"RTN","OOPSGUIU",18,0)
 .S DLSTAIEN=$O(^OOPS(2261.4,LOC,1,"B",DS,""))
"RTN","OOPSGUIU",19,0)
 .I DLSTAIEN="" S ARR(TI,LOCTX,"STADET NO ENT")=$G(ARR(TI,LOCTX,"STADET NO ENT"),0)+1
"RTN","OOPSGUIU",20,0)
 .S DLOCTX=$G(^OOPS(2261.4,LOC,1,DLSTAIEN,1,DLOC,0),"BAD DATA")
"RTN","OOPSGUIU",21,0)
 .S ARR(TI,LOCTX,DLOCTX)=$G(ARR(TI,LOCTX,DLOCTX),0)+1
"RTN","OOPSGUIU",22,0)
 Q
"RTN","OOPSGUIU",23,0)
CMPLSRV ; move data from ARR to ^TMP($J,"SERVICE"
"RTN","OOPSGUIU",24,0)
 N N1,N2,N3,N4,CN
"RTN","OOPSGUIU",25,0)
 S CN=0,N1=""
"RTN","OOPSGUIU",26,0)
 F  S N1=$O(ARR(N1)) Q:N1=""  S N2="" D
"RTN","OOPSGUIU",27,0)
 .F  S N2=$O(ARR(N1,N2)) Q:N2=""  S N3="" D
"RTN","OOPSGUIU",28,0)
 ..F  S N3=$O(ARR(N1,N2,N3)) Q:N3=""  S N4="" D
"RTN","OOPSGUIU",29,0)
 ...;add line below back in if sorting by station
"RTN","OOPSGUIU",30,0)
 ...;F  S N4=$O(ARR(N1,N2,N3,N4)) Q:N4=""  D
"RTN","OOPSGUIU",31,0)
 ...S ^TMP($J,TAG,CN)=N1_U_N2_U_N3_U_N4_U_ARR(N1,N2,N3),CN=CN+1
"RTN","OOPSGUIU",32,0)
 Q
"RTN","OOPSGUIU",33,0)
DSPUTE ; from OOPSGUIR, set temp global from compiled data
"RTN","OOPSGUIU",34,0)
 ; this should only be called from DSPUTE^OOPSGUIR
"RTN","OOPSGUIU",35,0)
 N IEN,CN,FI,LT,NLT
"RTN","OOPSGUIU",36,0)
 S IEN=0 F  S IEN=$O(^OOPS(2262.8,IEN)) Q:(IEN'>0)  D
"RTN","OOPSGUIU",37,0)
 .S FI=$P($G(^OOPS(2262.8,IEN,0)),U) I '$D(ARR(FI)) S ARR(FI,"NLT")=0
"RTN","OOPSGUIU",38,0)
 S FI="",CN=1
"RTN","OOPSGUIU",39,0)
 F  S FI=$O(ARR(FI)) Q:FI=""  D
"RTN","OOPSGUIU",40,0)
 .S LT=$G(ARR(FI,"LT"),0),NLT=$G(ARR(FI,"NLT"),0)
"RTN","OOPSGUIU",41,0)
 .S ^TMP($J,TAG,CN)=FI_U_LT_U_NLT,CN=CN+1
"RTN","OOPSGUIU",42,0)
 Q
"VER")
8.0^22.0
"^DD",2260,2260,347,0)
REASON FOR DISPUTE CODE^P2262.8'^OOPS(2262.8,^CA1I;13^Q
"^DD",2260,2260,347,3)
Enter the reason the agency is disputing the CA-1 claim.
"^DD",2260,2260,347,21,0)
^^1^1^3050412^
"^DD",2260,2260,347,21,1,0)
This is the high level reason that the agency is disputing the CA-1.
"^DD",2260,2260,347,"DT")
3050412
"^DD",2260,2260,348,0)
LOCATION DETAIL^F^^2162B;16^K:$L(X)>30!($L(X)<1) X
"^DD",2260,2260,348,3)
Answer must be 1-30 characters in length.
"^DD",2260,2260,348,21,0)
^.001^1^1^3050804^^^^
"^DD",2260,2260,348,21,1,0)
This field contains the optional location detail where the injury occurred.
"^DD",2260,2260,348,"DT")
3050628
"^DD",2260,2260,349,0)
LOSS OF CONSCIOUSNESS^RS^Y:Yes;N:No;^2162L;7^Q
"^DD",2260,2260,349,3)
Indicate whether the individual lost consciousness as a result of the incident.
"^DD",2260,2260,349,21,0)
^^2^2^3050506^
"^DD",2260,2260,349,21,1,0)
This field indicates whether the individual lost consciousness as
"^DD",2260,2260,349,21,2,0)
a result of the incident or not.
"^DD",2260,2260,349,"DT")
3050506
"^DD",2260,2260,350,0)
PRESCRIPTION STRGTH MEDS GIVEN^RS^Y:Yes;N:No;U:Unknown;^2162L;8^Q
"^DD",2260,2260,350,3)
Indicate whether prescription strength medications were ordered/given.
"^DD",2260,2260,350,21,0)
^^2^2^3050506^
"^DD",2260,2260,350,21,1,0)
This field indicates if the individual involved in the incident
"^DD",2260,2260,350,21,2,0)
was given or ordered prescription strength medication.
"^DD",2260,2260,350,"DT")
3050506
"^DD",2260,2260,351,0)
NON-SCRIPT MEDS AT SCRIPT DOSE^RS^Y:Yes;N:No;U:Unknown;^2162L;9^Q
"^DD",2260,2260,351,3)
Indicate whether the individual was ordered/given non-prescription medication at prescription strength.
"^DD",2260,2260,351,21,0)
^^3^3^3050506^
"^DD",2260,2260,351,21,1,0)
This field will indicate whether the individual involved in the incident
"^DD",2260,2260,351,21,2,0)
was given or ordered non-prescription medication as prescription strength.
"^DD",2260,2260,351,21,3,0)
(such as Motrin).
"^DD",2260,2260,351,"DT")
3050506
"^DD",2260,2260,352,0)
INITIAL RETURN TO WORK STATUS^S^F:FULL DUTY;A:DAYS AWAY WORK;J:Job Transfer/Restriction;^2162L;10^Q
"^DD",2260,2260,352,3)
Indicate the individual's initial return to work assessment.
"^DD",2260,2260,352,21,0)
^.001^2^2^3050830^^^^
"^DD",2260,2260,352,21,1,0)
This field will indicate the initial return to work status of the 
"^DD",2260,2260,352,21,2,0)
individual involved in the incident.  This work status may change.
"^DD",2260,2260,352,"DT")
3050830
"^DD",2260,2260,353,0)
DUAL REFUSED^S^Y:YES;N:NO;^DUAL;5^Q
"^DD",2260,2260,353,3)
EMPLOYEE WILL ANSWER YES OR NO TO REFUSAL TO ANSWER DUAL BENEFITS QUESTION
"^DD",2260,2260,353,"DT")
3050511
"^DD",2261.4,2261.4,0)
FIELD^^3^4
"^DD",2261.4,2261.4,0,"DDA")
N
"^DD",2261.4,2261.4,0,"DT")
3050427
"^DD",2261.4,2261.4,0,"IX","B",2261.4,.01)

"^DD",2261.4,2261.4,0,"IX","C",2261.4,1)

"^DD",2261.4,2261.4,0,"IX","D",2261.4,.01)

"^DD",2261.4,2261.4,0,"IX","F",2261.431,.01)

"^DD",2261.4,2261.4,0,"NM","ASISTS SETTING OF INJURY")

"^DD",2261.4,2261.4,0,"PT",2260,27)

"^DD",2261.4,2261.4,0,"PT",2261.451,.01)

"^DD",2261.4,2261.4,0,"VRPK")
OOPS
"^DD",2261.4,2261.4,.01,0)
NAME^RF^^0;1^K:$L(X)>35!($L(X)<3)!'(X'?1P.E) X
"^DD",2261.4,2261.4,.01,1,0)
^.1
"^DD",2261.4,2261.4,.01,1,1,0)
2261.4^B
"^DD",2261.4,2261.4,.01,1,1,1)
S ^OOPS(2261.4,"B",$E(X,1,30),DA)=""
"^DD",2261.4,2261.4,.01,1,1,2)
K ^OOPS(2261.4,"B",$E(X,1,30),DA)
"^DD",2261.4,2261.4,.01,1,2,0)
2261.4^D^MUMPS
"^DD",2261.4,2261.4,.01,1,2,1)
S ^OOPS(2261.4,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)=""
"^DD",2261.4,2261.4,.01,1,2,2)
K ^OOPS(2261.4,"D",$$UP^OOPSUTL4($E(X,1,30)),DA)
"^DD",2261.4,2261.4,.01,1,2,"%D",0)
^^2^2^2980505^^
"^DD",2261.4,2261.4,.01,1,2,"%D",1,0)
This cross-reference allows selection of entries by upper-case
"^DD",2261.4,2261.4,.01,1,2,"%D",2,0)
values.
"^DD",2261.4,2261.4,.01,1,2,"DT")
2980505
"^DD",2261.4,2261.4,.01,3)
Answer must be 3-35 characters in length.
"^DD",2261.4,2261.4,.01,21,0)
^^3^3^2980316^^^
"^DD",2261.4,2261.4,.01,21,1,0)
Enter a general setting of injury.
"^DD",2261.4,2261.4,.01,21,2,0)
This entry must describe a setting for an injury
"^DD",2261.4,2261.4,.01,21,3,0)
for patient or non-patient areas.
"^DD",2261.4,2261.4,.01,"DT")
2980505
"^DD",2261.4,2261.4,1,0)
CODE^NJ3,0^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",2261.4,2261.4,1,1,0)
^.1
"^DD",2261.4,2261.4,1,1,1,0)
2261.4^C
"^DD",2261.4,2261.4,1,1,1,1)
S ^OOPS(2261.4,"C",$E(X,1,30),DA)=""
"^DD",2261.4,2261.4,1,1,1,2)
K ^OOPS(2261.4,"C",$E(X,1,30),DA)
"^DD",2261.4,2261.4,1,1,1,"DT")
2980311
"^DD",2261.4,2261.4,1,3)
Type a Number between 0 and 999, 0 Decimal Digits
"^DD",2261.4,2261.4,1,21,0)
^.001^1^1^3050414^^^^
"^DD",2261.4,2261.4,1,21,1,0)
Enter a code that will identify a general setting of injury.
"^DD",2261.4,2261.4,1,"DT")
3050414
"^DD",2261.4,2261.4,2,0)
TYPE OF AREA^RS^P:PATIENT CARE;N:NON-PATIENT;^0;3^Q
"^DD",2261.4,2261.4,2,21,0)
^^2^2^2980401^
"^DD",2261.4,2261.4,2,21,1,0)
This field contains the patient/non-patient categorization
"^DD",2261.4,2261.4,2,21,2,0)
of the setting.
"^DD",2261.4,2261.4,2,"DT")
2980401
"^DD",2261.4,2261.4,3,0)
STATION^2261.43PA^^1;0
"^DD",2261.4,2261.4,3,21,0)
^^1^1^3050628^
"^DD",2261.4,2261.4,3,21,1,0)
This is the station where the location details are applicable.
"^DD",2261.4,2261.43,0)
STATION SUB-FIELD^^1^2
"^DD",2261.4,2261.43,0,"DT")
3050427
"^DD",2261.4,2261.43,0,"IX","B",2261.43,.01)

"^DD",2261.4,2261.43,0,"NM","STATION")

"^DD",2261.4,2261.43,0,"UP")
2261.4
"^DD",2261.4,2261.43,.01,0)
STATION^MR*P4'^DIC(4,^0;1^S DIC("S")="I $$VALSTA^OOPSUTL6(Y)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",2261.4,2261.43,.01,1,0)
^.1
"^DD",2261.4,2261.43,.01,1,1,0)
2261.43^B
"^DD",2261.4,2261.43,.01,1,1,1)
S ^OOPS(2261.4,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",2261.4,2261.43,.01,1,1,2)
K ^OOPS(2261.4,DA(1),1,"B",$E(X,1,30),DA)
"^DD",2261.4,2261.43,.01,12)
Only allow Stations in the Site Parameter file to be selected.
"^DD",2261.4,2261.43,.01,12.1)
S DIC("S")="I $$VALSTA^OOPSUTL6(Y)"
"^DD",2261.4,2261.43,.01,"DT")
3050425
"^DD",2261.4,2261.43,1,0)
LOCATION OF INJURY DETAIL^2261.431A^^1;0
"^DD",2261.4,2261.43,1,21,0)
^.001^2^2^3050628^^
"^DD",2261.4,2261.43,1,21,1,0)
This field contains the location of injury detail which can be
"^DD",2261.4,2261.43,1,21,2,0)
thought of as the sub-location where the incident occurred.
"^DD",2261.4,2261.43,1,"DT")
3050628
"^DD",2261.4,2261.431,0)
LOCATION OF INJURY DETAIL SUB-FIELD^^.01^1
"^DD",2261.4,2261.431,0,"DT")
3050427
"^DD",2261.4,2261.431,0,"IX","B",2261.431,.01)

"^DD",2261.4,2261.431,0,"NM","LOCATION OF INJURY DETAIL")

"^DD",2261.4,2261.431,0,"UP")
2261.43
"^DD",2261.4,2261.431,.01,0)
LOCATION OF INJURY DETAIL^MRF^^0;1^K:$L(X)>30!($L(X)<3) X
"^DD",2261.4,2261.431,.01,1,0)
^.1
"^DD",2261.4,2261.431,.01,1,1,0)
2261.431^B
"^DD",2261.4,2261.431,.01,1,1,1)
S ^OOPS(2261.4,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",2261.4,2261.431,.01,1,1,2)
K ^OOPS(2261.4,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",2261.4,2261.431,.01,1,2,0)
2261.4^F^MUMPS
"^DD",2261.4,2261.431,.01,1,2,1)
S ^OOPS(2261.4,"F",DA(1),DA(2),$E(X,1,30),DA)=""
"^DD",2261.4,2261.431,.01,1,2,2)
K ^OOPS(2261.4,"F",DA(1),DA(2),$E(X,1,30),DA)
"^DD",2261.4,2261.431,.01,1,2,"DT")
3050425
"^DD",2261.4,2261.431,.01,3)
Answer must be 3-30 characters in length.
"^DD",2261.4,2261.431,.01,21,0)
^^2^2^3050628^
"^DD",2261.4,2261.431,.01,21,1,0)
This field contains the location of injury detail which can be 
"^DD",2261.4,2261.431,.01,21,2,0)
thought of as the sub-location where the incident occurred.
"^DD",2261.4,2261.431,.01,"DT")
3050628
"^DD",2262.8,2262.8,0)
FIELD^^1^2
"^DD",2262.8,2262.8,0,"DDA")
N
"^DD",2262.8,2262.8,0,"DT")
3050412
"^DD",2262.8,2262.8,0,"IX","B",2262.8,.01)

"^DD",2262.8,2262.8,0,"NM","ASISTS REASON FOR DISPUTE CODES")

"^DD",2262.8,2262.8,0,"PT",2260,347)

"^DD",2262.8,2262.8,.01,0)
NAME^RF^^0;1^K:$L(X)>70!($L(X)<3)!'(X'?1P.E) X
"^DD",2262.8,2262.8,.01,1,0)
^.1
"^DD",2262.8,2262.8,.01,1,1,0)
2262.8^B
"^DD",2262.8,2262.8,.01,1,1,1)
S ^OOPS(2262.8,"B",$E(X,1,30),DA)=""
"^DD",2262.8,2262.8,.01,1,1,2)
K ^OOPS(2262.8,"B",$E(X,1,30),DA)
"^DD",2262.8,2262.8,.01,3)
Answer must be 3-70 characters in length.
"^DD",2262.8,2262.8,.01,21,0)
^^2^2^3050412^
"^DD",2262.8,2262.8,.01,21,1,0)
This is the Reason for Dispute Code that must be entered if the 
"^DD",2262.8,2262.8,.01,21,2,0)
agency is disputing the CA-1 case.
"^DD",2262.8,2262.8,.01,"DT")
3050412
"^DD",2262.8,2262.8,1,0)
REASON FOR DISPUTE CODE^RNJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",2262.8,2262.8,1,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",2262.8,2262.8,1,21,0)
^^1^1^3050412^
"^DD",2262.8,2262.8,1,21,1,0)
This is the code assigned to this reason for dispute description.
"^DD",2262.8,2262.8,1,"DT")
3050412
"^DIC",2261.4,2261.4,0)
ASISTS SETTING OF INJURY^2261.4
"^DIC",2261.4,2261.4,0,"GL")
^OOPS(2261.4,
"^DIC",2261.4,2261.4,"%D",0)
^^3^3^2980414^
"^DIC",2261.4,2261.4,"%D",1,0)
This file contains a list of patient care areas and other locations where
"^DIC",2261.4,2261.4,"%D",2,0)
accidents occur.  Each location is associated with a code.  File data is
"^DIC",2261.4,2261.4,"%D",3,0)
exported with the package and should not be edited by the site.
"^DIC",2261.4,"B","ASISTS SETTING OF INJURY",2261.4)

"^DIC",2262.8,2262.8,0)
ASISTS REASON FOR DISPUTE CODES^2262.8
"^DIC",2262.8,2262.8,0,"GL")
^OOPS(2262.8,
"^DIC",2262.8,2262.8,"%",0)
^1.005^^
"^DIC",2262.8,2262.8,"%D",0)
^1.001^4^4^3050412^^
"^DIC",2262.8,2262.8,"%D",1,0)
This file contains the basic reason a CA-1 case is disputed by the agency.
"^DIC",2262.8,2262.8,"%D",2,0)
Once a dispute code is selected the user add additional text in the 
"^DIC",2262.8,2262.8,"%D",3,0)
Reason for Dispute comment field to further explain the reason for 
"^DIC",2262.8,2262.8,"%D",4,0)
disputing the claim.
"^DIC",2262.8,"B","ASISTS REASON FOR DISPUTE CODES",2262.8)

**END**
**END**
