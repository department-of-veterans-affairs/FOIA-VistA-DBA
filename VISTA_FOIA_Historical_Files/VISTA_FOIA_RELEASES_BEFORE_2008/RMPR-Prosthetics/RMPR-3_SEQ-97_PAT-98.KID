Released RMPR*3*98 SEQ #97
Extracted from mail message
**KIDS**:RMPR*3.0*98^

**INSTALL NAME**
RMPR*3.0*98
"BLD",6029,0)
RMPR*3.0*98^PROSTHETICS^0^3060403^y
"BLD",6029,1,0)
^^1^1^3050901^^
"BLD",6029,1,1,0)
Prosthetics PFSS
"BLD",6029,4,0)
^9.64PA^665.72^3
"BLD",6029,4,660,0)
660
"BLD",6029,4,660,2,0)
^9.641^660^1
"BLD",6029,4,660,2,660,0)
RECORD OF PROS APPLIANCE/REPAIR  (File-top level)
"BLD",6029,4,660,2,660,1,0)
^9.6411^107^13
"BLD",6029,4,660,2,660,1,.01,0)
ENTRY DATE
"BLD",6029,4,660,2,660,1,4.5,0)
PSAS HCPCS
"BLD",6029,4,660,2,660,1,5,0)
QTY
"BLD",6029,4,660,2,660,1,8.6,0)
SUSPENSE REQUESTOR
"BLD",6029,4,660,2,660,1,14,0)
TOTAL COST
"BLD",6029,4,660,2,660,1,100,0)
PFSS ACCOUNT REFERENCE
"BLD",6029,4,660,2,660,1,101,0)
PFSS CHARGE ID
"BLD",6029,4,660,2,660,1,102,0)
LATEST PSAS HCPCS
"BLD",6029,4,660,2,660,1,103,0)
LATEST QTY
"BLD",6029,4,660,2,660,1,104,0)
LATEST TOTAL COST
"BLD",6029,4,660,2,660,1,105,0)
LATEST ORDERING PROVIDER
"BLD",6029,4,660,2,660,1,106,0)
PFSS ACCOUNT FLAG
"BLD",6029,4,660,2,660,1,107,0)
PFSS CHARGE FLAG
"BLD",6029,4,660,222)
y^y^p^^^^n^^n
"BLD",6029,4,660,224)

"BLD",6029,4,665,0)
665
"BLD",6029,4,665,2,0)
^9.641^665.194^2
"BLD",6029,4,665,2,665.193,0)
HOME OXYGEN PRESCRIPTION  (sub-file)
"BLD",6029,4,665,2,665.193,1,0)
^9.6411^^
"BLD",6029,4,665,2,665.193,1,.01,0)
DATE
"BLD",6029,4,665,2,665.193,1,30,0)
PRIMARY ICD DIAGNOSIS CODE
"BLD",6029,4,665,2,665.193,1,30.1,0)
PRIMARY AGENT ORANGE
"BLD",6029,4,665,2,665.193,1,30.2,0)
PRIMARY IONIZED RADIATION
"BLD",6029,4,665,2,665.193,1,30.3,0)
PRIMARY SERVICE CONNECTED
"BLD",6029,4,665,2,665.193,1,30.4,0)
PRIMARY ENVIRONMENTAL CONT.
"BLD",6029,4,665,2,665.193,1,30.5,0)
PRIMARY MST
"BLD",6029,4,665,2,665.193,1,30.6,0)
PRIMARY HEAD/NECK CANCER
"BLD",6029,4,665,2,665.193,1,30.7,0)
PRIMARY COMBAT VET
"BLD",6029,4,665,2,665.193,1,31,0)
SECONDARY ICD DIAGNOSIS CODE 1
"BLD",6029,4,665,2,665.193,1,31.1,0)
SECONDARY AGENT ORANGE 1
"BLD",6029,4,665,2,665.193,1,31.2,0)
SECONDARY IONIZED RADIATION 1
"BLD",6029,4,665,2,665.193,1,31.3,0)
SECONDARY SERVICE CONNECTED 1
"BLD",6029,4,665,2,665.193,1,31.4,0)
SECONDARY ENVIRONMENTAL CONT 1
"BLD",6029,4,665,2,665.193,1,31.5,0)
SECONDARY MST 1
"BLD",6029,4,665,2,665.193,1,31.6,0)
SECONDARY HEAD/NECK CANCER 1
"BLD",6029,4,665,2,665.193,1,31.7,0)
SECONDARY COMBAT VET 1
"BLD",6029,4,665,2,665.193,1,32,0)
SECONDARY ICD DIAGNOSIS CODE 2
"BLD",6029,4,665,2,665.193,1,32.1,0)
SECONDARY AGENT ORANGE 2
"BLD",6029,4,665,2,665.193,1,32.2,0)
SECONDARY IONIZED RADIATION 2
"BLD",6029,4,665,2,665.193,1,32.3,0)
SECONDARY SERVICE CONNECTED 2
"BLD",6029,4,665,2,665.193,1,32.4,0)
SECONDARY ENVIRONMENTAL CONT 2
"BLD",6029,4,665,2,665.193,1,32.5,0)
SECONDARY MST 2
"BLD",6029,4,665,2,665.193,1,32.6,0)
SECONDARY HEAD/NECK CANCER 2
"BLD",6029,4,665,2,665.193,1,32.7,0)
SECONDARY COMBAT VET 2
"BLD",6029,4,665,2,665.193,1,33,0)
SECONDARY ICD DIAGNOSIS CODE 3
"BLD",6029,4,665,2,665.193,1,33.1,0)
SECONDARY AGENT ORANGE 3
"BLD",6029,4,665,2,665.193,1,33.2,0)
SECONDARY IONIZED RADIATION 3
"BLD",6029,4,665,2,665.193,1,33.3,0)
SECONDARY SERVICE CONNECTED 3
"BLD",6029,4,665,2,665.193,1,33.4,0)
SECONDARY ENVIRONMENTAL CONT 3
"BLD",6029,4,665,2,665.193,1,33.5,0)
SECONDARY MST 3
"BLD",6029,4,665,2,665.193,1,33.6,0)
SECONDARY HEAD/NECK CANCER 3
"BLD",6029,4,665,2,665.193,1,33.7,0)
SECONDARY COMBAT VET 3
"BLD",6029,4,665,2,665.193,1,100,0)
PFSS NEW PRESCRIPTION FLAG
"BLD",6029,4,665,2,665.193,1,101,0)
REQUESTOR
"BLD",6029,4,665,2,665.194,0)
HOME OXYGEN ITEM  (sub-file)
"BLD",6029,4,665,2,665.194,1,0)
^9.6411^^
"BLD",6029,4,665,2,665.194,1,.01,0)
ITEM
"BLD",6029,4,665,2,665.194,1,100,0)
PFSS ACCOUNT FLAG
"BLD",6029,4,665,2,665.194,1,101,0)
PFSS ACCOUNT REFERENCE
"BLD",6029,4,665,222)
y^n^p^^^^n^^n
"BLD",6029,4,665,224)

"BLD",6029,4,665.72,0)
665.72
"BLD",6029,4,665.72,2,0)
^9.641^665.723191^1
"BLD",6029,4,665.72,2,665.723191,0)
ITEM  (sub-file)
"BLD",6029,4,665.72,2,665.723191,1,0)
^9.6411^102^4
"BLD",6029,4,665.72,2,665.723191,1,.01,0)
ITEM
"BLD",6029,4,665.72,2,665.723191,1,100,0)
PFSS ACCOUNT REFERENCE
"BLD",6029,4,665.72,2,665.723191,1,101,0)
PFSS UNIQUE CHARGE ID
"BLD",6029,4,665.72,2,665.723191,1,102,0)
REQUESTOR
"BLD",6029,4,665.72,222)
y^n^p^^^^n^^n
"BLD",6029,4,665.72,224)

"BLD",6029,4,"APDD",660,660)

"BLD",6029,4,"APDD",660,660,.01)

"BLD",6029,4,"APDD",660,660,4.5)

"BLD",6029,4,"APDD",660,660,5)

"BLD",6029,4,"APDD",660,660,8.6)

"BLD",6029,4,"APDD",660,660,14)

"BLD",6029,4,"APDD",660,660,100)

"BLD",6029,4,"APDD",660,660,101)

"BLD",6029,4,"APDD",660,660,102)

"BLD",6029,4,"APDD",660,660,103)

"BLD",6029,4,"APDD",660,660,104)

"BLD",6029,4,"APDD",660,660,105)

"BLD",6029,4,"APDD",660,660,106)

"BLD",6029,4,"APDD",660,660,107)

"BLD",6029,4,"APDD",665,665.193)

"BLD",6029,4,"APDD",665,665.193,.01)

"BLD",6029,4,"APDD",665,665.193,30)

"BLD",6029,4,"APDD",665,665.193,30.1)

"BLD",6029,4,"APDD",665,665.193,30.2)

"BLD",6029,4,"APDD",665,665.193,30.3)

"BLD",6029,4,"APDD",665,665.193,30.4)

"BLD",6029,4,"APDD",665,665.193,30.5)

"BLD",6029,4,"APDD",665,665.193,30.6)

"BLD",6029,4,"APDD",665,665.193,30.7)

"BLD",6029,4,"APDD",665,665.193,31)

"BLD",6029,4,"APDD",665,665.193,31.1)

"BLD",6029,4,"APDD",665,665.193,31.2)

"BLD",6029,4,"APDD",665,665.193,31.3)

"BLD",6029,4,"APDD",665,665.193,31.4)

"BLD",6029,4,"APDD",665,665.193,31.5)

"BLD",6029,4,"APDD",665,665.193,31.6)

"BLD",6029,4,"APDD",665,665.193,31.7)

"BLD",6029,4,"APDD",665,665.193,32)

"BLD",6029,4,"APDD",665,665.193,32.1)

"BLD",6029,4,"APDD",665,665.193,32.2)

"BLD",6029,4,"APDD",665,665.193,32.3)

"BLD",6029,4,"APDD",665,665.193,32.4)

"BLD",6029,4,"APDD",665,665.193,32.5)

"BLD",6029,4,"APDD",665,665.193,32.6)

"BLD",6029,4,"APDD",665,665.193,32.7)

"BLD",6029,4,"APDD",665,665.193,33)

"BLD",6029,4,"APDD",665,665.193,33.1)

"BLD",6029,4,"APDD",665,665.193,33.2)

"BLD",6029,4,"APDD",665,665.193,33.3)

"BLD",6029,4,"APDD",665,665.193,33.4)

"BLD",6029,4,"APDD",665,665.193,33.5)

"BLD",6029,4,"APDD",665,665.193,33.6)

"BLD",6029,4,"APDD",665,665.193,33.7)

"BLD",6029,4,"APDD",665,665.193,100)

"BLD",6029,4,"APDD",665,665.193,101)

"BLD",6029,4,"APDD",665,665.194)

"BLD",6029,4,"APDD",665,665.194,.01)

"BLD",6029,4,"APDD",665,665.194,100)

"BLD",6029,4,"APDD",665,665.194,101)

"BLD",6029,4,"APDD",665.72,665.723191)

"BLD",6029,4,"APDD",665.72,665.723191,.01)

"BLD",6029,4,"APDD",665.72,665.723191,100)

"BLD",6029,4,"APDD",665.72,665.723191,101)

"BLD",6029,4,"APDD",665.72,665.723191,102)

"BLD",6029,4,"B",660,660)

"BLD",6029,4,"B",665,665)

"BLD",6029,4,"B",665.72,665.72)

"BLD",6029,6)
2^
"BLD",6029,"ABPKG")
n
"BLD",6029,"INID")
^n
"BLD",6029,"INIT")
POST^RMPRPF
"BLD",6029,"KRN",0)
^9.67PA^8989.52^19
"BLD",6029,"KRN",.4,0)
.4
"BLD",6029,"KRN",.401,0)
.401
"BLD",6029,"KRN",.402,0)
.402
"BLD",6029,"KRN",.403,0)
.403
"BLD",6029,"KRN",.5,0)
.5
"BLD",6029,"KRN",.84,0)
.84
"BLD",6029,"KRN",3.6,0)
3.6
"BLD",6029,"KRN",3.8,0)
3.8
"BLD",6029,"KRN",9.2,0)
9.2
"BLD",6029,"KRN",9.8,0)
9.8
"BLD",6029,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",6029,"KRN",9.8,"NM",1,0)
RMPOPF^^0^B49044325
"BLD",6029,"KRN",9.8,"NM",2,0)
RMPOPF1^^0^B9887538
"BLD",6029,"KRN",9.8,"NM",3,0)
RMPOPST3^^0^B24093511
"BLD",6029,"KRN",9.8,"NM",4,0)
RMPRPF^^0^B4839309
"BLD",6029,"KRN",9.8,"NM",5,0)
RMPRPF1^^0^B17743335
"BLD",6029,"KRN",9.8,"NM",6,0)
RMPRPF2^^0^B28817815
"BLD",6029,"KRN",9.8,"NM",7,0)
RMPRPF3^^0^B8566306
"BLD",6029,"KRN",9.8,"NM","B","RMPOPF",1)

"BLD",6029,"KRN",9.8,"NM","B","RMPOPF1",2)

"BLD",6029,"KRN",9.8,"NM","B","RMPOPST3",3)

"BLD",6029,"KRN",9.8,"NM","B","RMPRPF",4)

"BLD",6029,"KRN",9.8,"NM","B","RMPRPF1",5)

"BLD",6029,"KRN",9.8,"NM","B","RMPRPF2",6)

"BLD",6029,"KRN",9.8,"NM","B","RMPRPF3",7)

"BLD",6029,"KRN",19,0)
19
"BLD",6029,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",6029,"KRN",19,"NM",1,0)
RMPR PFSS BACKGROUND^^0
"BLD",6029,"KRN",19,"NM","B","RMPR PFSS BACKGROUND",1)

"BLD",6029,"KRN",19.1,0)
19.1
"BLD",6029,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6029,"KRN",101,0)
101
"BLD",6029,"KRN",409.61,0)
409.61
"BLD",6029,"KRN",771,0)
771
"BLD",6029,"KRN",870,0)
870
"BLD",6029,"KRN",8989.51,0)
8989.51
"BLD",6029,"KRN",8989.52,0)
8989.52
"BLD",6029,"KRN",8994,0)
8994
"BLD",6029,"KRN","B",.4,.4)

"BLD",6029,"KRN","B",.401,.401)

"BLD",6029,"KRN","B",.402,.402)

"BLD",6029,"KRN","B",.403,.403)

"BLD",6029,"KRN","B",.5,.5)

"BLD",6029,"KRN","B",.84,.84)

"BLD",6029,"KRN","B",3.6,3.6)

"BLD",6029,"KRN","B",3.8,3.8)

"BLD",6029,"KRN","B",9.2,9.2)

"BLD",6029,"KRN","B",9.8,9.8)

"BLD",6029,"KRN","B",19,19)

"BLD",6029,"KRN","B",19.1,19.1)

"BLD",6029,"KRN","B",101,101)

"BLD",6029,"KRN","B",409.61,409.61)

"BLD",6029,"KRN","B",771,771)

"BLD",6029,"KRN","B",870,870)

"BLD",6029,"KRN","B",8989.51,8989.51)

"BLD",6029,"KRN","B",8989.52,8989.52)

"BLD",6029,"KRN","B",8994,8994)

"BLD",6029,"QUES",0)
^9.62^^
"BLD",6029,"REQB",0)
^9.611^4^4
"BLD",6029,"REQB",1,0)
RMPR*3.0*61^2
"BLD",6029,"REQB",2,0)
RMPR*3.0*78^2
"BLD",6029,"REQB",3,0)
RMPR*3.0*41^2
"BLD",6029,"REQB",4,0)
IB*2.0*286^2
"BLD",6029,"REQB","B","IB*2.0*286",4)

"BLD",6029,"REQB","B","RMPR*3.0*41",3)

"BLD",6029,"REQB","B","RMPR*3.0*61",1)

"BLD",6029,"REQB","B","RMPR*3.0*78",2)

"FIA",660)
RECORD OF PROS APPLIANCE/REPAIR
"FIA",660,0)
^RMPR(660,
"FIA",660,0,0)
660OID
"FIA",660,0,1)
y^y^p^^^^n^^n
"FIA",660,0,10)

"FIA",660,0,11)

"FIA",660,0,"RLRO")

"FIA",660,0,"VR")
3.0^RMPR
"FIA",660,660)
1
"FIA",660,660,.01)

"FIA",660,660,4.5)

"FIA",660,660,5)

"FIA",660,660,8.6)

"FIA",660,660,14)

"FIA",660,660,100)

"FIA",660,660,101)

"FIA",660,660,102)

"FIA",660,660,103)

"FIA",660,660,104)

"FIA",660,660,105)

"FIA",660,660,106)

"FIA",660,660,107)

"FIA",665)
PROSTHETICS PATIENT
"FIA",665,0)
^RMPR(665,
"FIA",665,0,0)
665IP
"FIA",665,0,1)
y^n^p^^^^n^^n
"FIA",665,0,10)

"FIA",665,0,11)

"FIA",665,0,"RLRO")

"FIA",665,0,"VR")
3.0^RMPR
"FIA",665,665)
1
"FIA",665,665,19.3)

"FIA",665,665,19.4)

"FIA",665,665.193)
1
"FIA",665,665.193,.01)

"FIA",665,665.193,30)

"FIA",665,665.193,30.1)

"FIA",665,665.193,30.2)

"FIA",665,665.193,30.3)

"FIA",665,665.193,30.4)

"FIA",665,665.193,30.5)

"FIA",665,665.193,30.6)

"FIA",665,665.193,30.7)

"FIA",665,665.193,31)

"FIA",665,665.193,31.1)

"FIA",665,665.193,31.2)

"FIA",665,665.193,31.3)

"FIA",665,665.193,31.4)

"FIA",665,665.193,31.5)

"FIA",665,665.193,31.6)

"FIA",665,665.193,31.7)

"FIA",665,665.193,32)

"FIA",665,665.193,32.1)

"FIA",665,665.193,32.2)

"FIA",665,665.193,32.3)

"FIA",665,665.193,32.4)

"FIA",665,665.193,32.5)

"FIA",665,665.193,32.6)

"FIA",665,665.193,32.7)

"FIA",665,665.193,33)

"FIA",665,665.193,33.1)

"FIA",665,665.193,33.2)

"FIA",665,665.193,33.3)

"FIA",665,665.193,33.4)

"FIA",665,665.193,33.5)

"FIA",665,665.193,33.6)

"FIA",665,665.193,33.7)

"FIA",665,665.193,100)

"FIA",665,665.193,101)

"FIA",665,665.194)
1
"FIA",665,665.194,.01)

"FIA",665,665.194,100)

"FIA",665,665.194,101)

"FIA",665.72)
HOME OXYGEN TRANSACTIONS FILE
"FIA",665.72,0)
^RMPO(665.72,
"FIA",665.72,0,0)
665.72P
"FIA",665.72,0,1)
y^n^p^^^^n^^n
"FIA",665.72,0,10)

"FIA",665.72,0,11)

"FIA",665.72,0,"RLRO")

"FIA",665.72,0,"VR")
3.0^RMPR
"FIA",665.72,665.72)
1
"FIA",665.72,665.72319)
1
"FIA",665.72,665.72319,1)

"FIA",665.72,665.723191)
1
"FIA",665.72,665.723191,.01)

"FIA",665.72,665.723191,100)

"FIA",665.72,665.723191,101)

"FIA",665.72,665.723191,102)

"INIT")
POST^RMPRPF
"KRN",19,12523,-1)
0^1
"KRN",19,12523,0)
RMPR PFSS BACKGROUND^Prosthetics PFSS Background Task^^R^^^^^^^^PROSTHETICS
"KRN",19,12523,1,0)
^19.06^1^1^3051017^^
"KRN",19,12523,1,1,0)
Scheduled task that monitors Prosthetics for PFSS billing events.
"KRN",19,12523,25)
EN^RMPRPF
"KRN",19,12523,200.9)
y
"KRN",19,12523,"U")
PROSTHETICS PFSS BACKGROUND TA
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",280,-1)
1^1
"PKG",280,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",280,20,0)
^9.402P^^0
"PKG",280,22,0)
^9.49I^1^1
"PKG",280,22,1,0)
3.0^2960209^2970624
"PKG",280,22,1,"PAH",1,0)
98^3060403^14
"PKG",280,22,1,"PAH",1,1,0)
^^1^1^3060403
"PKG",280,22,1,"PAH",1,1,1,0)
Prosthetics PFSS
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","RMPOPF")
0^1^B49044325
"RTN","RMPOPF",1,0)
RMPOPF ;HINES-FO/DDA - MAIN INTERFACE ROUTINE FOR PFSS AND HOME OXYGEN ;8/18/05
"RTN","RMPOPF",2,0)
 ;;3.0;PROSTHETICS;**98**;Feb 09, 1996
"RTN","RMPOPF",3,0)
EN ; ENTRY POINT FOR HOME OXYGEN BACKGROUND PROCESSING
"RTN","RMPOPF",4,0)
 ; Loop on APNEW and APO cross-references.
"RTN","RMPOPF",5,0)
 D APNEW,APO
"RTN","RMPOPF",6,0)
 K RMPR6699,RMPRACCT,RMPRAPLR,RMPRDFN,RMPRDG1,RMPRDRG,RMPREVNT,RMPRHCPC,RMPRHCPT,RMPRIEN,RMPRITEM,RMPRPAR,RMPRPR1,RMPRPV1,RMPRPV2,RMPRRX,RMPRRXDT,RMPRRXEX,RMPRRXI,RMPRRXLP,RMPRSITE,RMPRSTAT,RMPRZCL
"RTN","RMPOPF",7,0)
 Q
"RTN","RMPOPF",8,0)
APNEW ;Loop on file #665 APNEW cross-reference.
"RTN","RMPOPF",9,0)
 ; Delete ITEM'S PFSS ACCOUNT REFERENCE associated with previous prescription date.
"RTN","RMPOPF",10,0)
 ; Set PFSS ACCOUNT FLAG.  This will trigger the background process to obtain a new
"RTN","RMPOPF",11,0)
 ;  PFSS ACCOUNT REFERENCE for the new prescription date.
"RTN","RMPOPF",12,0)
 S RMPRIEN=0
"RTN","RMPOPF",13,0)
 F  S RMPRIEN=$O(^RMPR(665,"APNEW",1,RMPRIEN)) Q:RMPRIEN'>0  D
"RTN","RMPOPF",14,0)
 .; Check for valid prescription
"RTN","RMPOPF",15,0)
 .D VALIDRX
"RTN","RMPOPF",16,0)
 .I RMPRRXDT=0 D EXITNEW Q
"RTN","RMPOPF",17,0)
 .S RMPRITEM=0
"RTN","RMPOPF",18,0)
 .F  S RMPRITEM=$O(^RMPR(665,RMPRIEN,"RMPOC",RMPRITEM)) Q:RMPRITEM'>0  D
"RTN","RMPOPF",19,0)
 ..S DIE="^RMPR(665,"_RMPRIEN_",""RMPOC"","
"RTN","RMPOPF",20,0)
 ..S DA(1)=RMPRIEN,DA=RMPRITEM
"RTN","RMPOPF",21,0)
 ..S DR="101///@;100///1"
"RTN","RMPOPF",22,0)
 ..D ^DIE
"RTN","RMPOPF",23,0)
 ..K DIE,DA,DR
"RTN","RMPOPF",24,0)
 ..Q
"RTN","RMPOPF",25,0)
 .D EXITNEW
"RTN","RMPOPF",26,0)
 Q
"RTN","RMPOPF",27,0)
EXITNEW ; Remove the APNEW flag
"RTN","RMPOPF",28,0)
 S RMPRRX=0
"RTN","RMPOPF",29,0)
 F  S RMPRRX=$O(^RMPR(665,"APNEW",1,RMPRIEN,RMPRRX)) Q:RMPRRX'>0  D
"RTN","RMPOPF",30,0)
 .S DIE="^RMPR(665,"_RMPRIEN_",""RMPOB"","
"RTN","RMPOPF",31,0)
 .S DA(1)=RMPRIEN,DA=RMPRRX
"RTN","RMPOPF",32,0)
 .S DR="100///@"
"RTN","RMPOPF",33,0)
 .D ^DIE
"RTN","RMPOPF",34,0)
 .K DIE,DA,DR
"RTN","RMPOPF",35,0)
 .Q
"RTN","RMPOPF",36,0)
 Q
"RTN","RMPOPF",37,0)
APO ;Loop on file #665 APO cross-reference and gather data for GETACCT api.
"RTN","RMPOPF",38,0)
 S RMPRIEN=0
"RTN","RMPOPF",39,0)
 F  S RMPRIEN=$O(^RMPR(665,"APO",1,RMPRIEN)) Q:RMPRIEN'>0  D GETACCT
"RTN","RMPOPF",40,0)
 Q
"RTN","RMPOPF",41,0)
GETACCT ; ENTRY POINT TO SEND HOME OXYGEN ACCOUNT CREATION, PRE-CERTIFICATION
"RTN","RMPOPF",42,0)
 ;OR UPDATE DATA TO OBTAIN A PFSS ACCOUNT REFERENCE.     
"RTN","RMPOPF",43,0)
 ; QUIT IF ALL VALID PRESCRIPTIONS HAVE EXPIRED.
"RTN","RMPOPF",44,0)
 D VALIDRX       ; LOOP ON EACH ITEM
"RTN","RMPOPF",45,0)
 S RMPRITEM=0
"RTN","RMPOPF",46,0)
 F  S RMPRITEM=$O(^RMPR(665,"APO",1,RMPRIEN,RMPRITEM)) Q:RMPRITEM'>0  D
"RTN","RMPOPF",47,0)
 .I RMPRRXDT=0 D  Q
"RTN","RMPOPF",48,0)
 ..; Remove APO Flag
"RTN","RMPOPF",49,0)
 ..S DIE="^RMPR(665,"_RMPRIEN_",""RMPOC"","
"RTN","RMPOPF",50,0)
 ..S DA(1)=RMPRIEN,DA=RMPRITEM
"RTN","RMPOPF",51,0)
 ..S DR="100///@"
"RTN","RMPOPF",52,0)
 ..D ^DIE
"RTN","RMPOPF",53,0)
 ..K DIE,DA,DR
"RTN","RMPOPF",54,0)
 ..Q
"RTN","RMPOPF",55,0)
 .S RMPRDFN=RMPRIEN
"RTN","RMPOPF",56,0)
 .S RMPRPAR=$P($G(^RMPR(665,RMPRIEN,"RMPOC",RMPRITEM,"PFSS")),"^",2)
"RTN","RMPOPF",57,0)
 .S:RMPRPAR="" RMPREVNT="A05"
"RTN","RMPOPF",58,0)
 .S:RMPRPAR'="" RMPREVNT="A08"
"RTN","RMPOPF",59,0)
 .S RMPRAPLR="GETACCT;RMPOPF"
"RTN","RMPOPF",60,0)
 .S RMPRPV1(2)="O"
"RTN","RMPOPF",61,0)
 .S RMPRSTA=$P($G(^RMPR(665,RMPRIEN,0)),"^",2)
"RTN","RMPOPF",62,0)
 .D GETSITE^RMPRPF1
"RTN","RMPOPF",63,0)
 .S RMPRPV1(3)=RMPRHLOC
"RTN","RMPOPF",64,0)
 .S RMPRPV1(7)=$P($G(^RMPR(665,RMPRIEN,"RMPOB",RMPRRXI,"PFSS")),"^",2)
"RTN","RMPOPF",65,0)
 .S RMPRPV1(44)=RMPRRXDT
"RTN","RMPOPF",66,0)
 .S RMPRPV2(8)=RMPRRXDT
"RTN","RMPOPF",67,0)
 .; INSURE HCPCS IS CODE SET VERSIONED
"RTN","RMPOPF",68,0)
 .S RMPRHCPC=$P($G(^RMPR(665,RMPRIEN,"RMPOC",RMPRITEM,0)),"^",7),RMPRHCDT=RMPRRXDT
"RTN","RMPOPF",69,0)
 .D PSASHCPC
"RTN","RMPOPF",70,0)
 .; If HCPCS version check fails then quit, but leave APO Flag intact for future processing.
"RTN","RMPOPF",71,0)
 .; The HCPCS should eventually be corrected.
"RTN","RMPOPF",72,0)
 .Q:RMPRVHC=0
"RTN","RMPOPF",73,0)
 .S RMPRPR1(3)=RMPRVHC
"RTN","RMPOPF",74,0)
 .S RMPRPR1(4)=RMPRTHC
"RTN","RMPOPF",75,0)
 .S RMPRPR1(6)="O"
"RTN","RMPOPF",76,0)
 .; INSURE ICD9 IS CODE SET VERSIONED
"RTN","RMPOPF",77,0)
 .S RMPRDRG=$P($G(^RMPR(665,RMPRIEN,"RMPOC",RMPRITEM,0)),"^",8)
"RTN","RMPOPF",78,0)
 .S:RMPRDRG'="" RMPRDRG=$$STATCHK^ICDAPIU($P($G(^ICD9(RMPRDRG,0)),"^"),RMPRRXDT)
"RTN","RMPOPF",79,0)
 .S RMPRDG1(1,3)=""
"RTN","RMPOPF",80,0)
 .S:$P(RMPRDRG,"^")=1 RMPRDG1(1,3)=$P(RMPRDRG,"^",2),RMPRDG1(1,6)="F"
"RTN","RMPOPF",81,0)
 .;ZCL SEGMENT TO GO HERE
"RTN","RMPOPF",82,0)
 .S RMPRZCL=""
"RTN","RMPOPF",83,0)
 .; FIELDS NOT YET ENTERED.
"RTN","RMPOPF",84,0)
 .; Call GETACCT api
"RTN","RMPOPF",85,0)
 .S RMPRACCT=$$GETACCT^IBBAPI(RMPRDFN,RMPRPAR,RMPREVNT,RMPRAPLR,.RMPRPV1,.RMPRPV2,.RMPRPR1,.RMPRDG1,.RMPRZCL)
"RTN","RMPOPF",86,0)
 .; Store PFSS ACCOUNT REFERENCE data and Delete the APO flag.
"RTN","RMPOPF",87,0)
 .S DIE="^RMPR(665,"_RMPRIEN_",""RMPOC"","
"RTN","RMPOPF",88,0)
 .S DA(1)=RMPRIEN,DA=RMPRITEM
"RTN","RMPOPF",89,0)
 .S DR="100///@;101///`"_RMPRACCT
"RTN","RMPOPF",90,0)
 .D ^DIE
"RTN","RMPOPF",91,0)
 .K DIE,DA,DR
"RTN","RMPOPF",92,0)
 .K RMPRDFN,RMPRPAR,RMPREVNT,RMPRAPLR,RMPRPV1,RMPRPV2,RMPRSTA,RMPRHLOC,RMPRHCPC,RMPRPR1,RMPRDRG,RMPRDG1,RMPRZCL,RMPRACCT,RMPRSTAT,RMPRCHDT,RMPRVHC,RMPRTHC,RMPREHC
"RTN","RMPOPF",93,0)
 .Q
"RTN","RMPOPF",94,0)
EXITGET ;
"RTN","RMPOPF",95,0)
 K RMPRRXDT,RMPRRXI,RMPRITEM
"RTN","RMPOPF",96,0)
 Q
"RTN","RMPOPF",97,0)
PSASHCPC ; determine correct HCPCS code to send based on PSAS HCPCS.
"RTN","RMPOPF",98,0)
 ; UPON ENTRY RMPRHCPC = POINTER TO 661.1 AND  RMPRHCDT = FILEMAN DATE
"RTN","RMPOPF",99,0)
 ; Returns with RMPRVHC having the correct value to pass to IBB.
"RTN","RMPOPF",100,0)
 I RMPRHCPC="" S RMPREHC="A9900",RMPRTHC="HCPCS DELETED" G CHK
"RTN","RMPOPF",101,0)
 S RMPREHC=$P($G(^RMPR(661.1,RMPRHCPC,0)),"^")
"RTN","RMPOPF",102,0)
 S RMPRTHC=$P($G(^RMPR(661.1,RMPRHCPC,0)),"^",2)
"RTN","RMPOPF",103,0)
CHK S RMPRSTAT=$$STATCHK^ICPTAPIU(RMPREHC,RMPRHCDT)
"RTN","RMPOPF",104,0)
 I ($A($E(RMPREHC,2,2))>64)!($P(RMPRSTAT,"^")=0) D
"RTN","RMPOPF",105,0)
 .S RMPREHC="A9900"
"RTN","RMPOPF",106,0)
 .S RMPRSTAT=$$STATCHK^ICPTAPIU(RMPREHC,RMPRHCDT)
"RTN","RMPOPF",107,0)
 .Q
"RTN","RMPOPF",108,0)
 I $P(RMPRSTAT,"^")=1 S RMPRVHC=$P(RMPRSTAT,"^",2) Q
"RTN","RMPOPF",109,0)
 S RMPRVHC=0
"RTN","RMPOPF",110,0)
 Q
"RTN","RMPOPF",111,0)
VALIDRX ; GET ASSOCIATED RX MAKE SURE IT HAS NOT EXPIRED.
"RTN","RMPOPF",112,0)
 S (RMPRRXLP,RMPRRX,RMPRRXI,RMPRRXEX,RMPRRXDT)=0
"RTN","RMPOPF",113,0)
 F  S RMPRRXLP=$O(^RMPR(665,RMPRIEN,"RMPOB","B",RMPRRXLP)) Q:RMPRRXLP'>0  D
"RTN","RMPOPF",114,0)
 .F  S RMPRRX=$O(^RMPR(665,RMPRIEN,"RMPOB","B",RMPRRXLP,RMPRRX)) Q:RMPRRX'>0  D
"RTN","RMPOPF",115,0)
 ..S:$P($G(^RMPR(665,RMPRIEN,"RMPOB",RMPRRX,0)),"^",3)'<DT RMPRRXEX=$P($G(^RMPR(665,RMPRIEN,"RMPOB",RMPRRX,0)),"^",3),RMPRRXDT=RMPRRXLP,RMPRRXI=RMPRRX
"RTN","RMPOPF",116,0)
 ..Q
"RTN","RMPOPF",117,0)
 .Q
"RTN","RMPOPF",118,0)
 K RMPRRXLP,RMPRRX,RMPRRXEX
"RTN","RMPOPF",119,0)
 Q
"RTN","RMPOPF",120,0)
ACCTCNCL ; ENTRY POINT TO SEND HOME OXYGEN ACCOUNT CANCELLATION DATA.
"RTN","RMPOPF",121,0)
 ;  THIS TAG IS CALLED AS A ONE-TIME TASKMAN TASK LOADED FROM ACCTTASK^PMPOPF.
"RTN","RMPOPF",122,0)
 ;  Input variables from TaskMan-
"RTN","RMPOPF",123,0)
 ;    RMPRDFN = DA (also DFN)
"RTN","RMPOPF",124,0)
 ;    RMPRRXDT = Home Oxygen Prescription date
"RTN","RMPOPF",125,0)
 ;    RMPRRXEN = Home Oxygen Prescription IEN
"RTN","RMPOPF",126,0)
 ;  
"RTN","RMPOPF",127,0)
 ;CHECK IF HOME OXYGEN PRESCRIPTION SUB RECORD HAS BEEN DELETED.
"RTN","RMPOPF",128,0)
 ; EXIT IF IT STILL EXISTS
"RTN","RMPOPF",129,0)
 G:$D(^RMPR(665,RMPRDFN,"RMPOB","B",RMPRRXDT,RMPRRXEN)) EXITCNCL
"RTN","RMPOPF",130,0)
 ; THE RECORD WAS DELETED
"RTN","RMPOPF",131,0)
 ; LOOP ON PATIENT'S ITEMS.
"RTN","RMPOPF",132,0)
 S RMPRITEM=0
"RTN","RMPOPF",133,0)
 F  S RMPRITEM=$O(^RMPR(665,RMPRDFN,"RMPOC",RMPRITEM)) Q:RMPRITEM'>0  D CANCEL
"RTN","RMPOPF",134,0)
EXITCNCL ;
"RTN","RMPOPF",135,0)
 K RMPRDFN,RMPRRXDT,RMPRRXEN,RMPRITEM
"RTN","RMPOPF",136,0)
 Q
"RTN","RMPOPF",137,0)
CANCEL ; ENTRY POINT TO SEND HOME OXYGEN ACCOUNT CANCELLATION DATA.
"RTN","RMPOPF",138,0)
 ;  THIS TAG IS CALLED AS A ONE-TIME TASKMAN TASK LOADED FROM ITEMTASK^PMPOPF.
"RTN","RMPOPF",139,0)
 ;  Input variables from TaskMan-
"RTN","RMPOPF",140,0)
 ;    RMPRDFN = DA (also DFN)
"RTN","RMPOPF",141,0)
 ;    RMPRITEM = Home Oxygen Item IEN
"RTN","RMPOPF",142,0)
 ;  
"RTN","RMPOPF",143,0)
 ;CHECK IF HOME OXYGEN PRESCRIPTION SUB RECORD HAS BEEN DELETED.
"RTN","RMPOPF",144,0)
 ; EXIT IF IT STILL EXISTS
"RTN","RMPOPF",145,0)
 ;   SET FROM: 
"RTN","RMPOPF",146,0)
 ;    RMPRDFN = DFN SENT WITHIN TASKMAN
"RTN","RMPOPF",147,0)
 ;    RMPRPAR = HOME OXYGEN ITEM (19.4); PFSS Account Reference (101)
"RTN","RMPOPF",148,0)
 ;    RMPREVNT = "A38"
"RTN","RMPOPF",149,0)
 ;    RMPRAPLR = "CANCEL1;RMPOPF"
"RTN","RMPOPF",150,0)
 ;    RMPRPV1(2) = "O"
"RTN","RMPOPF",151,0)
 ;    RMPRPV1(3) = FILE 669.9, FIELD 52
"RTN","RMPOPF",152,0)
 ;    RMPRPV1(44) = THE HOME OXYGEN PRESCRIPTION DATE SENT WITHIN TASKMAN
"RTN","RMPOPF",153,0)
 S RMPRPAR=$P($G(^RMPR(665,RMPRDFN,"RMPOC",RMPRITEM,"PFSS")),"^",2)
"RTN","RMPOPF",154,0)
CANCEL1 ; ENTRY POINT FOR SINGLE ITEM DELETE (ITEMTASK)
"RTN","RMPOPF",155,0)
 S RMPREVNT="A38"
"RTN","RMPOPF",156,0)
 S RMPRAPLR="CANCEL1;RMPOPF"
"RTN","RMPOPF",157,0)
 S RMPRPV1(2)="O"
"RTN","RMPOPF",158,0)
 S RMPRSTA=$P($G(^RMPR(665,RMPRDFN,0)),"^",2)
"RTN","RMPOPF",159,0)
 D GETSITE^RMPRPF1
"RTN","RMPOPF",160,0)
 S RMPRPV1(3)=RMPRHLOC
"RTN","RMPOPF",161,0)
 S RMPRIEN=RMPRDFN D VALIDRX
"RTN","RMPOPF",162,0)
 S:RMPRRXDT'=0 RMPRPV1(44)=RMPRRXDT
"RTN","RMPOPF",163,0)
 ;   SEND A38 GETACCT FOR THE ITEM
"RTN","RMPOPF",164,0)
 S RMPRCNCL=$$GETACCT^IBBAPI(RMPRDFN,RMPRPAR,RMPREVNT,RMPRAPLR,.RMPRPV1)
"RTN","RMPOPF",165,0)
 K RMPRPAR,RMPREVNT,RMPRAPLR,RMPRPV1,RMPRSTA,RMPRHLOC,RMPRCNCL
"RTN","RMPOPF",166,0)
 Q
"RTN","RMPOPF",167,0)
ACCTTASK ; FILE #665, HOME OXYGEN PRESCRITION; DATE FIELD MUMPS XREF KILL LOGIC.
"RTN","RMPOPF",168,0)
 ; TASKMAN LOAD A ONE TIME TASKMAN TASK.
"RTN","RMPOPF",169,0)
 Q:'+$$SWSTAT^IBBAPI()
"RTN","RMPOPF",170,0)
 N ZTRTN,ZTDESC,ZTDTH,ZTIO,ZTUCI,ZTCPU,ZTPRI,ZTSAVE,ZTKIL,ZTSYNC
"RTN","RMPOPF",171,0)
 S ZTIO="",ZTRTN="ACCTCNCL^RMPOPF",ZTDESC="Prosthetics Home Oxygen PFSS Account Cancel",ZTDTH=$H
"RTN","RMPOPF",172,0)
 S ZTSAVE("RMPRDFN")=DA(1),ZTSAVE("RMPRRXEN")=DA,ZTSAVE("RMPRRXDT")=X
"RTN","RMPOPF",173,0)
 D ^%ZTLOAD
"RTN","RMPOPF",174,0)
 Q
"RTN","RMPOPF",175,0)
ITEMTASK ; FILE #665, HOME OXYGEN ITEM; ITEM FIELD MUMPS XREF
"RTN","RMPOPF",176,0)
 ;KILL LOGIC.
"RTN","RMPOPF",177,0)
 ; TASKMAN LOAD A ONE TIME TASKMAN TASK.
"RTN","RMPOPF",178,0)
 Q:'+$$SWSTAT^IBBAPI()
"RTN","RMPOPF",179,0)
 S RMPRPAR=$P($G(^RMPR(665,DA(1),"RMPOC",DA,"PFSS")),"^",2)
"RTN","RMPOPF",180,0)
 N ZTRTN,ZTDESC,ZTDTH,ZTIO,ZTUCI,ZTCPU,ZTPRI,ZTSAVE,ZTKIL,ZTSYNC
"RTN","RMPOPF",181,0)
 S ZTIO="",ZTRTN="CANCEL1^RMPOPF",ZTDESC="Prosthetics Home Oxygen PFSS Item Cancel",ZTDTH=$H
"RTN","RMPOPF",182,0)
 S ZTSAVE("RMPRDFN")=DA(1),ZTSAVE("RMPRITEM")=DA,ZTSAVE("RMPRPAR")=RMPRPAR
"RTN","RMPOPF",183,0)
 D ^%ZTLOAD
"RTN","RMPOPF",184,0)
 K RMPRPAR
"RTN","RMPOPF",185,0)
 Q
"RTN","RMPOPF",186,0)
CHRGTASK ; FILE #665.72, BILLING MONTH; VENDOR; PATIENT; ITEM FIELD MUMPS XREF
"RTN","RMPOPF",187,0)
 ;KILL LOGIC.
"RTN","RMPOPF",188,0)
 ; TASKMAN LOAD A ONE TIME TASKMAN TASK.
"RTN","RMPOPF",189,0)
 Q:'+$$SWSTAT^IBBAPI()
"RTN","RMPOPF",190,0)
 S RMPRPFSS=^RMPO(665.72,DA(4),1,DA(3),1,DA(2),"V",DA(1),1,DA,"PFSS")
"RTN","RMPOPF",191,0)
 N ZTRTN,ZTDESC,ZTDTH,ZTIO,ZTUCI,ZTCPU,ZTPRI,ZTSAVE,ZTKIL,ZTSYNC
"RTN","RMPOPF",192,0)
 S ZTIO="",ZTRTN="CHRGCRED^RMPOPF1",ZTDESC="Prosthetics Home Oxygen PFSS Charge Credit",ZTDTH=$H
"RTN","RMPOPF",193,0)
 S ZTSAVE("RMPRDFN")=DA(1),ZTSAVE("RMPRITEM")=DA,ZTSAVE("RMPRVDR")=DA(2),ZTSAVE("RMPRBLDT")=DA(3),ZTSAVE("RMPRSITE")=DA(4)
"RTN","RMPOPF",194,0)
 S ZTSAVE("RMPRPFSS")=^RMPO(665.72,DA(4),1,DA(3),1,DA(2),"V",DA(1),1,DA,"PFSS")
"RTN","RMPOPF",195,0)
 D ^%ZTLOAD
"RTN","RMPOPF",196,0)
 Q
"RTN","RMPOPF",197,0)
CHARGE ; Called from RMPOPST3.
"RTN","RMPOPF",198,0)
 ;IMPORTANT VARIBLES PASSED IN FROM RMPOPST3.
"RTN","RMPOPF",199,0)
 ; D6I= FILE 660 IEN
"RTN","RMPOPF",200,0)
 ; RMPOXITE= FILE 665.72 SITE (IEN)
"RTN","RMPOPF",201,0)
 ; RMPODATE= FILE 665.72 BILLING MONTH mult IEN
"RTN","RMPOPF",202,0)
 ; RMPOVDR= FILE 665.72 VENDOR mult IEN (DINUM to 440)
"RTN","RMPOPF",203,0)
 ; DFN= FILE 665.72 PATIENT mult IEN (DINUM to 2)
"RTN","RMPOPF",204,0)
 ; ITM= FILE 665.72 ITEM mult IEN
"RTN","RMPOPF",205,0)
 ; TRXDT= Date TRX Built
"RTN","RMPOPF",206,0)
 ; ITMD= Item multiple zero node
"RTN","RMPOPF",207,0)
 ;
"RTN","RMPOPF",208,0)
 Q:'+$$SWSTAT^IBBAPI()
"RTN","RMPOPF",209,0)
 D CHARGE^RMPOPF1
"RTN","RMPOPF",210,0)
 Q
"RTN","RMPOPF1")
0^2^B9887538
"RTN","RMPOPF1",1,0)
RMPOPF1 ;HINES-FO/DDA - (CONT.)MAIN INTERFACE ROUTINE FOR PFSS AND HOME OXYGEN ;8/18/05
"RTN","RMPOPF1",2,0)
 ;;3.0;PROSTHETICS;**98**;Feb 09, 1996
"RTN","RMPOPF1",3,0)
 Q
"RTN","RMPOPF1",4,0)
CHARGE ; Called from RMPOPST3 via CHARGE^RMPOPF
"RTN","RMPOPF1",5,0)
 ;IMPORTANT VARIBLES PASSED IN FROM RMPOPST3
"RTN","RMPOPF1",6,0)
 ; D6I= FILE 660 IEN
"RTN","RMPOPF1",7,0)
 ; RMPOXITE= FILE 665.72 SITE (IEN)
"RTN","RMPOPF1",8,0)
 ; RMPODATE= FILE 665.72 BILLING MONTH mult IEN
"RTN","RMPOPF1",9,0)
 ; RMPOVDR= FILE 665.72 VENDOR mult IEN (DINUM to 440)
"RTN","RMPOPF1",10,0)
 ; DFN= FILE 665.72 PATIENT mult IEN (DINUM to 2)
"RTN","RMPOPF1",11,0)
 ; ITM= FILE 665.72 ITEM mult IEN
"RTN","RMPOPF1",12,0)
 ; TRXDT= Date TRX Built
"RTN","RMPOPF1",13,0)
 ; ITMD= Item multiple zero node
"RTN","RMPOPF1",14,0)
 ; 
"RTN","RMPOPF1",15,0)
 ;Set variables
"RTN","RMPOPF1",16,0)
 S RMPRDFN=DFN
"RTN","RMPOPF1",17,0)
 S RMPRITEM=0
"RTN","RMPOPF1",18,0)
 S RMPRITEM=$O(^RMPR(665,DFN,"RMPOC","B",$P(ITMD,"^"),RMPRITEM))
"RTN","RMPOPF1",19,0)
 S RMPRPAR=$P($G(^RMPR(665,RMPRDFN,"RMPOC",RMPRITEM,"PFSS")),"^",2)
"RTN","RMPOPF1",20,0)
 S RMPRTYPE="CG"
"RTN","RMPOPF1",21,0)
 S RMPRFT1(4)=TRXDT
"RTN","RMPOPF1",22,0)
 S RMPRFT1(10)=$P(ITMD,"^",7)
"RTN","RMPOPF1",23,0)
 S RMPRFT1(13)=423
"RTN","RMPOPF1",24,0)
 S RMPRSTA=RMPOXITE
"RTN","RMPOPF1",25,0)
 D GETSITE^RMPRPF1
"RTN","RMPOPF1",26,0)
 S RMPRFT1(16)=RMPRHLOC
"RTN","RMPOPF1",27,0)
 S RMPRIEN=DFN D VALIDRX^RMPOPF K RMPRIEN
"RTN","RMPOPF1",28,0)
 S RMPRFT1(21)=$P($G(^RMPR(665,DFN,"RMPOB",RMPRRXI,"PFSS")),"^",2)
"RTN","RMPOPF1",29,0)
 S RMPRFT1(22)=$P(ITMD,"^",5)
"RTN","RMPOPF1",30,0)
 S RMPRHCPC=$P(ITMD,"^",2)
"RTN","RMPOPF1",31,0)
 S RMPRHCDT=TRXDT
"RTN","RMPOPF1",32,0)
 ; INSURE HCPCS IS CODE SET VERSIONED
"RTN","RMPOPF1",33,0)
 D PSASHCPC^RMPOPF
"RTN","RMPOPF1",34,0)
 S RMPRPR1(3)=RMPRVHC
"RTN","RMPOPF1",35,0)
 S RMPRPR1(4)=RMPRTHC
"RTN","RMPOPF1",36,0)
 S RMPRPR1(6)="O"
"RTN","RMPOPF1",37,0)
 ; INSURE ICD9 IS CODE SET VERSIONED
"RTN","RMPOPF1",38,0)
 S RMPRDRG=$P(ITMD,"^",9)
"RTN","RMPOPF1",39,0)
 S:RMPRDRG'="" RMPRDRG=$$STATCHK^ICDAPIU($P($G(^ICD9(RMPRDRG,0)),"^"),TRXDT)
"RTN","RMPOPF1",40,0)
 S:$P(RMPRDRG,"^")=1 RMPRDG1(1,3)=$P(RMPRDRG,"^",2),RMPRDG1(1,6)="F"
"RTN","RMPOPF1",41,0)
 S RMPRZCL=""
"RTN","RMPOPF1",42,0)
 S RMPRPROS(1)=RMPOVDR
"RTN","RMPOPF1",43,0)
 S RMPRUCID=$P($G(^RMPO(665.72,RMPOXITE,1,RMPODATE,1,RMPOVDR,"V",DFN,1,ITM,"PFSS")),"^",2)
"RTN","RMPOPF1",44,0)
 S:RMPRUCID'>0 RMPRUCID=$$GETCHGID^IBBAPI()
"RTN","RMPOPF1",45,0)
 S RMPRFLAG=$$CHARGE^IBBAPI(RMPRDFN,RMPRPAR,RMPRTYPE,RMPRUCID,.RMPRFT1,.RMPRPR1,.RMPRDG1,.RMPRZCL,"","",.RMPRPROS)
"RTN","RMPOPF1",46,0)
 Q:RMPRFLAG=0
"RTN","RMPOPF1",47,0)
 ;STORE RETURN INFO INTO 665.72
"RTN","RMPOPF1",48,0)
 S DA=ITM,DA(1)=DFN,DA(2)=RMPOVDR,DA(3)=RMPODATE,DA(4)=RMPOXITE
"RTN","RMPOPF1",49,0)
 S DIE="^RMPO(665.72,"_DA(4)_",1,"_DA(3)_",1,"_DA(2)_",""V"","_DA(1)_",1,"
"RTN","RMPOPF1",50,0)
 S DR="100///"_RMPRPAR_";101///"_RMPRUCID_";102///"_RMPRFT1(21)
"RTN","RMPOPF1",51,0)
 D ^DIE
"RTN","RMPOPF1",52,0)
 K DA,DIE,DR
"RTN","RMPOPF1",53,0)
 ;STORE RETURN INFO INTO 660
"RTN","RMPOPF1",54,0)
 S DA=D6I
"RTN","RMPOPF1",55,0)
 S DIE="^RMPR(660,"
"RTN","RMPOPF1",56,0)
 S DR="100///"_RMPRPAR_";101///"_RMPRUCID_";102///"_$P($G(^RMPR(660,D6I,1)),"^",4)_";103///"_$P($G(^RMPR(660,D6I,0)),"^",7)_";104///"_$P($G(^RMPR(660,D6I,0)),"^",16)_";106///@;107///@"
"RTN","RMPOPF1",57,0)
 D ^DIE
"RTN","RMPOPF1",58,0)
 K DA,DIE,DR
"RTN","RMPOPF1",59,0)
 ;
"RTN","RMPOPF1",60,0)
 K RMPRDFN,RMPRDG1,RMPRDRG,RMPRFLAG,RMPRFT1,RMPRHCPC,RMPRHLOC,RMPRITEM,RMPRPAR,RMPRPR1,RMPRPROS,RMPRRXDT,RMPRRXI,RMPRSTA,RMPRSTAT,RMPRTYPE,RMPRUCID
"RTN","RMPOPF1",61,0)
 Q
"RTN","RMPOPF1",62,0)
CHRGCRED ; Called when an previously charged item is deleted from 665.72
"RTN","RMPOPF1",63,0)
 ; Variables passed in via TaskMan
"RTN","RMPOPF1",64,0)
 ; RMPRSITE = 665.72 IEN - SITE
"RTN","RMPOPF1",65,0)
 ; RMPRBLDT = 665.723;1 - BILLING MONTH IEN
"RTN","RMPOPF1",66,0)
 ; RMPRVDR = 665.7231;1 - VENDOR IEN (DINUM 440)
"RTN","RMPOPF1",67,0)
 ; RMPRDFN = 665.72319;9 - PATIENT IEN (DINUM 200)
"RTN","RMPOPF1",68,0)
 ; RMPRITEM = 665.723191 - ITEM IEN
"RTN","RMPOPF1",69,0)
 ; RMPRPFSS = DATA FROM THE ITEM'S "PFSS" NODE
"RTN","RMPOPF1",70,0)
 ; 
"RTN","RMPOPF1",71,0)
 ;Quit if item data still exists
"RTN","RMPOPF1",72,0)
 Q:$D(^RMPO(665.72,RMPRSITE,1,RMPRBLDT,1,RMPRVDR,"V",RMPRDFN,1,RMPRITEM,0))
"RTN","RMPOPF1",73,0)
 S RMPRFLAG=$$CHARGE^IBBAPI(RMPRDFN,$P(RMPRPFSS,"^",1),"CD",$P(RMPRPFSS,"^",2))
"RTN","RMPOPF1",74,0)
 K RMPRBLDT,RMPRDFN,RMPRFLAG,RMPRITEM,RMPRPFSS,RMPRSITE,RMPRVDR
"RTN","RMPOPF1",75,0)
 Q
"RTN","RMPOPST3")
0^3^B24093511^B23371087
"RTN","RMPOPST3",1,0)
RMPOPST3 ;EDS/JAM,HinesIO/DDA - HOME OXYGEN BILLING TRANSACTIONS/ACCEPT FOR POST ;7/24/98
"RTN","RMPOPST3",2,0)
 ;;3.0;PROSTHETICS;**29,44,41,98**;Feb 09, 1996
"RTN","RMPOPST3",3,0)
 ;This subroutine is part of the billing module. Check file 665.72
"RTN","RMPOPST3",4,0)
 ;for accepted transactions not yet posted.
"RTN","RMPOPST3",5,0)
 Q
"RTN","RMPOPST3",6,0)
ACCEPT ; Check for accepted entries and post if user indicates
"RTN","RMPOPST3",7,0)
 N DFNS
"RTN","RMPOPST3",8,0)
 D FNDACC I $O(DFNS(""))="" Q
"RTN","RMPOPST3",9,0)
 D PSTACC
"RTN","RMPOPST3",10,0)
 Q  ;ACCEPT
"RTN","RMPOPST3",11,0)
 ;
"RTN","RMPOPST3",12,0)
TEST ;set test data
"RTN","RMPOPST3",13,0)
 N RMPOXITE,RMPOVDR,RMPODATE,DFNS
"RTN","RMPOPST3",14,0)
 S RMPOXITE=1,RMPOVDR=10,RMPODATE=2981200,DFNS(47)=""
"RTN","RMPOPST3",15,0)
 S RMPO("STA")=521
"RTN","RMPOPST3",16,0)
 D FNDACC I $O(DFNS(""))="" Q
"RTN","RMPOPST3",17,0)
 D PSTACC
"RTN","RMPOPST3",18,0)
 Q  ;TEST
"RTN","RMPOPST3",19,0)
 ;
"RTN","RMPOPST3",20,0)
FNDACC ;Check records to ensure all accepted transactions are posted.
"RTN","RMPOPST3",21,0)
 N DFN,BILDT,SITE,FIL,VDR,I
"RTN","RMPOPST3",22,0)
 S FIL=665.72,SITE=RMPOXITE,BILDT=RMPODATE,VDR=RMPOVDR
"RTN","RMPOPST3",23,0)
 S DFN=0
"RTN","RMPOPST3",24,0)
 F I=1:1 S DFN=$O(^RMPO(FIL,SITE,1,BILDT,1,VDR,"V",DFN)) Q:'DFN  D
"RTN","RMPOPST3",25,0)
 . ;check if patient transaction posted
"RTN","RMPOPST3",26,0)
 . I $P(^RMPO(FIL,SITE,1,BILDT,1,VDR,"V",DFN,0),U,3)="Y" Q
"RTN","RMPOPST3",27,0)
 . ;check if patient transaction accepted
"RTN","RMPOPST3",28,0)
 . I $P(^RMPO(FIL,SITE,1,BILDT,1,VDR,"V",DFN,0),U,2)'="Y" Q
"RTN","RMPOPST3",29,0)
 . I I=10 D
"RTN","RMPOPST3",30,0)
 . . W !!,"Verifying all accepted transactions posted. Please be patient"
"RTN","RMPOPST3",31,0)
 . S DFNS(DFN)=""
"RTN","RMPOPST3",32,0)
 Q  ;FNDACC
"RTN","RMPOPST3",33,0)
 ;
"RTN","RMPOPST3",34,0)
PSTACC ;Post accepted transactions if so indicated by user
"RTN","RMPOPST3",35,0)
 N MES K DIR
"RTN","RMPOPST3",36,0)
 S DIR(0)="Y",DIR("B")="NO"
"RTN","RMPOPST3",37,0)
 S MES="There are patients whose billing transactions have been accepted"
"RTN","RMPOPST3",38,0)
 S DIR("A",1)=MES,DIR("A",2)=" and not yet posted"
"RTN","RMPOPST3",39,0)
 S DIR("A")="Would you like to post them now"
"RTN","RMPOPST3",40,0)
 S DIR("?")="YES will Post accepted transaction and NO will not post"
"RTN","RMPOPST3",41,0)
 D ^DIR
"RTN","RMPOPST3",42,0)
 I 'Y!($D(DIRUT))!($D(DIROUT)) Q
"RTN","RMPOPST3",43,0)
 ;Call post module to post transactions
"RTN","RMPOPST3",44,0)
 D POST^RMPOPST0
"RTN","RMPOPST3",45,0)
 K DIR,DIRUT,DIROUT,Y
"RTN","RMPOPST3",46,0)
 Q  ;PSTACC
"RTN","RMPOPST3",47,0)
F660 ;Post to file ^RMPR(660 for form 2319
"RTN","RMPOPST3",48,0)
 N ITM,ITMD,D665A,SUSDES,TRXDT,D660,D6I,D6X,RMPOG,ERR
"RTN","RMPOPST3",49,0)
 S D665A=$G(^RMPR(665,DFN,"RMPOA")) I D665A="" Q
"RTN","RMPOPST3",50,0)
 D  ;AMIS grouper number
"RTN","RMPOPST3",51,0)
 . L +^RMPR(669.9,RMPOXITE,0):9999 I $T=0 S RMPOG=DT_$P(DT,2,3) Q
"RTN","RMPOPST3",52,0)
 . S RMPOG=$P(^RMPR(669.9,RMPOXITE,0),U,7),RMPOG=RMPOG-1
"RTN","RMPOPST3",53,0)
 . S $P(^RMPR(669.9,RMPOXITE,0),U,7)=RMPOG
"RTN","RMPOPST3",54,0)
 . L -^RMPR(669.9,RMPOXITE,0)
"RTN","RMPOPST3",55,0)
 S TRXDT=$P(^RMPO(665.72,RMPOXITE,1,RMPODATE,1,RMPOVDR,0),U,2)
"RTN","RMPOPST3",56,0)
 S ITM="" F  S ITM=$O(^TMP($J,FCP,DFN,ITM)) Q:ITM=""  D
"RTN","RMPOPST3",57,0)
 . S ITMD=$G(^RMPO(665.72,RMPOXITE,1,RMPODATE,1,RMPOVDR,"V",DFN,1,ITM,0))
"RTN","RMPOPST3",58,0)
 . I ITMD="" Q
"RTN","RMPOPST3",59,0)
 .; I $P(ITMD,U,6)'>0 Q       ;nothing posted to IFCAP
"RTN","RMPOPST3",60,0)
 . S RMCPHC=$P(ITMD,U,2),RMCPT="",RMCPRENT=$P(ITMD,U,18),RMCPSO="C"
"RTN","RMPOPST3",61,0)
 . S RMCPTY=$P(ITMD,U,14),RMCPQH=$P(ITMD,U,19)
"RTN","RMPOPST3",62,0)
 . S RMCPT1=$G(^RMPR(661.1,RMCPHC,4))
"RTN","RMPOPST3",63,0)
 . I RMCPT1["RP",((RMCPTY="R")!(RMCPTY="X")) S RMCPT=RMCPT_"RP,"
"RTN","RMPOPST3",64,0)
 . I RMCPT1["QH",($G(RMCPQH)) S RMCPT=RMCPT_"QH,"
"RTN","RMPOPST3",65,0)
 . I (RMCPRENT=1),(RMCPT1["RR") S RMCPT=RMCPT_"RR,"
"RTN","RMPOPST3",66,0)
 . I RMCPT1["NU",(RMCPT'["RR") S RMCPT=RMCPT_"NU,"
"RTN","RMPOPST3",67,0)
 . I $L(RMCPT)>2 S RMCLEN=$L(RMCPT),RMCPT=$E(RMCPT,1,RMCLEN-1)
"RTN","RMPOPST3",68,0)
 . S DIC="^RMPR(660,",DIC(0)="L",X=DT
"RTN","RMPOPST3",69,0)
 . K DD,DO D FILE^DICN I +Y<0 Q
"RTN","RMPOPST3",70,0)
 . S D6I=+Y,D6X=D6I_","
"RTN","RMPOPST3",71,0)
 . K DIE,DA,DR S DA(4)=RMPOXITE,DA(3)=RMPODATE,DA(2)=RMPOVDR,DA(1)=DFN
"RTN","RMPOPST3",72,0)
 . S DIE="^RMPO(665.72,"_DA(4)_",1,"_DA(3)_",1,"_DA(2)_",""V"","_DA(1)
"RTN","RMPOPST3",73,0)
 . S DIE=DIE_",1,",DA=ITM,DR="15///"_D6I D ^DIE
"RTN","RMPOPST3",74,0)
 . S D660(660,D6X,.02)=DFN                 ;Patient name pointer
"RTN","RMPOPST3",75,0)
 . S D660(660,D6X,1)=TRXDT                 ;Request date
"RTN","RMPOPST3",76,0)
 . S D660(660,D6X,2)=$P(ITMD,U,14)         ;Type of transaction
"RTN","RMPOPST3",77,0)
 . S D660(660,D6X,4)=$P(ITMD,U)            ;item
"RTN","RMPOPST3",78,0)
 . S D660(660,D6X,4.1)=$P(^RMPR(661.1,$P(ITMD,U,2),0),U,4) ;HCPCS
"RTN","RMPOPST3",79,0)
 . S D660(660,D6X,4.5)=$P(ITMD,U,2)        ;PSAS HCPCS
"RTN","RMPOPST3",80,0)
 . S D660(660,D6X,4.7)=RMCPT               ;CPT MODIFIER
"RTN","RMPOPST3",81,0)
 . S D660(660,D6X,5)=$P(ITMD,U,7)-$P(ITMD,U,17)          ;quantity
"RTN","RMPOPST3",82,0)
 . S D660(660,D6X,7)=RMPOVDR               ;vendor
"RTN","RMPOPST3",83,0)
 . S D660(660,D6X,8)=RMPO("STA")           ;station
"RTN","RMPOPST3",84,0)
 . S D660(660,D6X,10)=CURDT                ;Delivery date
"RTN","RMPOPST3",85,0)
 . D
"RTN","RMPOPST3",86,0)
 . . I $P(PAYINF,U) D  Q
"RTN","RMPOPST3",87,0)
 . . . S D660(660,D6X,11)=9                ;form requested on(1358)
"RTN","RMPOPST3",88,0)
 . . . ;IFCAP transaction number - from file 424
"RTN","RMPOPST3",89,0)
 . . . I $G(IEN424)'="" S D660(660,D6X,23)=$P($G(^PRC(424,IEN424,0)),U)
"RTN","RMPOPST3",90,0)
 . . S D660(660,D6X,11)=14                 ;form requested on (visa)
"RTN","RMPOPST3",91,0)
 . . S D660(660,D6X,23)=SRVORD             ;IFCAP transaction number
"RTN","RMPOPST3",92,0)
 . S D660(660,D6X,12)="C"                  ;Source
"RTN","RMPOPST3",93,0)
 . S D660(660,D6X,14)=$P(ITMD,U,6)         ;total cost
"RTN","RMPOPST3",94,0)
 . S D660(660,D6X,16)=$P(ITMD,U,4)         ;remarks
"RTN","RMPOPST3",95,0)
 . S SUSDES=$S($P(ITMD,U,11)'="":"Suspended Amt "_$P(ITMD,U,11)_" ",1:"")
"RTN","RMPOPST3",96,0)
 . S D660(660,D6X,24)=SUSDES_$P(ITMD,U,12) ;description
"RTN","RMPOPST3",97,0)
 . S D660(660,D6X,27)=DUZ                  ;initiator
"RTN","RMPOPST3",98,0)
 . S D660(660,D6X,62)=$P(D665A,U)          ;patient category
"RTN","RMPOPST3",99,0)
 . S D660(660,D6X,63)=$P(D665A,U,5)        ;special category
"RTN","RMPOPST3",100,0)
 . S D660(660,D6X,68)=RMPOG
"RTN","RMPOPST3",101,0)
 . S D660(660,D6X,78)=$P(ITMD,U,15)        ;unit of issue
"RTN","RMPOPST3",102,0)
 . D FILE^DIE("K","D660","ERR")
"RTN","RMPOPST3",103,0)
 . I $D(ERR) D
"RTN","RMPOPST3",104,0)
 . . W !!,"Posting to 2319 for item ",ITM," patient ",DFN," failed."
"RTN","RMPOPST3",105,0)
 . . W "Posting will be done later"
"RTN","RMPOPST3",106,0)
 . . Q
"RTN","RMPOPST3",107,0)
 . ; RMPR*3*98
"RTN","RMPOPST3",108,0)
 . ; CALL TO PROCESS PFSS CHARGE MESSAGE
"RTN","RMPOPST3",109,0)
 . I '$D(ERR) D CHARGE^RMPOPF
"RTN","RMPOPST3",110,0)
 . Q
"RTN","RMPOPST3",111,0)
 K DIC,X,Y
"RTN","RMPOPST3",112,0)
 Q
"RTN","RMPRPF")
0^4^B4839309
"RTN","RMPRPF",1,0)
RMPRPF ;HOIFO/TH,DDA - Patient Financial Services System (PFSS) Support Main ;8/18/05
"RTN","RMPRPF",2,0)
 ;;3.0;PROSTHETICS;**98**;Feb 09, 1996
"RTN","RMPRPF",3,0)
 ;
"RTN","RMPRPF",4,0)
 ; This routine is the main entry point for the RMPR PFSS BACGROUND process.
"RTN","RMPRPF",5,0)
 ; Entry point EN will check the current setting of the PFSS Master Switch,
"RTN","RMPRPF",6,0)
 ; process Account Creation, Charges, and Updates for Purchasing,
"RTN","RMPRPF",7,0)
 ; Stock Issue, and Home Oxygen.
"RTN","RMPRPF",8,0)
 ; 
"RTN","RMPRPF",9,0)
 ; Entry point SEED is a one time subroutine that is to be run at implementation
"RTN","RMPRPF",10,0)
 ; to seed Home Oxygen with PFSS ACCOUNT REFERENCE numbers for all those Home
"RTN","RMPRPF",11,0)
 ; Oxygen prescriptions that are valid at the date the PFSS Master Switch was
"RTN","RMPRPF",12,0)
 ; turned on.  SEED should only be run at implementation (or re-implementation)
"RTN","RMPRPF",13,0)
 ; of PFSS, as directed by the implementation team.
"RTN","RMPRPF",14,0)
 ; 
"RTN","RMPRPF",15,0)
 ; DBIA # 4663 for SWSTAT^IBBAPI
"RTN","RMPRPF",16,0)
 ;
"RTN","RMPRPF",17,0)
 Q
"RTN","RMPRPF",18,0)
 ;
"RTN","RMPRPF",19,0)
EN ; Entry Point
"RTN","RMPRPF",20,0)
 ; Check PFSS Master Switch
"RTN","RMPRPF",21,0)
 Q:'+$$SWSTAT^IBBAPI()
"RTN","RMPRPF",22,0)
 ;
"RTN","RMPRPF",23,0)
 ; Loop thru APH x-ref
"RTN","RMPRPF",24,0)
 S RMPRDA="" F  S RMPRDA=$O(^RMPR(660,"APH",1,RMPRDA)) Q:RMPRDA=""  D
"RTN","RMPRPF",25,0)
 . D EN^RMPRPF1
"RTN","RMPRPF",26,0)
 ;
"RTN","RMPRPF",27,0)
 ; Loop thru APD x-ref
"RTN","RMPRPF",28,0)
 S RMPRDA="" F  S RMPRDA=$O(^RMPR(660,"APD",1,RMPRDA)) Q:RMPRDA=""  D
"RTN","RMPRPF",29,0)
 . D EN^RMPRPF2
"RTN","RMPRPF",30,0)
 ; Call Home Oxygen
"RTN","RMPRPF",31,0)
 D EN^RMPOPF
"RTN","RMPRPF",32,0)
 D EXIT
"RTN","RMPRPF",33,0)
 Q
"RTN","RMPRPF",34,0)
 ;
"RTN","RMPRPF",35,0)
EXIT ; Common exit point
"RTN","RMPRPF",36,0)
 D KILL^XUSCLEAN
"RTN","RMPRPF",37,0)
 Q
"RTN","RMPRPF",38,0)
 ;
"RTN","RMPRPF",39,0)
 ;  The following code is to be run at implementation time only.
"RTN","RMPRPF",40,0)
SEED ;  Seed Home Oxygen Prescription items with initial PFSS ACCOUNT REFERENCE numbers.
"RTN","RMPRPF",41,0)
 ; If this is a re-implementation, previous account references will be replaced.
"RTN","RMPRPF",42,0)
 ;
"RTN","RMPRPF",43,0)
 S RMPRSW=$$SWSTAT^IBBAPI()
"RTN","RMPRPF",44,0)
 G:'+RMPRSW EXSEED
"RTN","RMPRPF",45,0)
 S RMPRSWDT=$P(RMPRSW,"^",2)
"RTN","RMPRPF",46,0)
 S RMPRIEN=0
"RTN","RMPRPF",47,0)
 F  S RMPRIEN=$O(^RMPR(665,RMPRIEN)) Q:RMPRIEN'>0  D
"RTN","RMPRPF",48,0)
 .S RMPRRX=0
"RTN","RMPRPF",49,0)
 .F  S RMPRRX=$O(^RMPR(665,RMPRIEN,"RMPOB",RMPRRX)) Q:RMPRRX'>0  D
"RTN","RMPRPF",50,0)
 ..;QUIT IF RX EXPRIRATION DATE IS LESS THAN (BEFORE) PFSS SWITCH ON DATE
"RTN","RMPRPF",51,0)
 ..Q:$P($G(^RMPR(665,RMPRIEN,"RMPOB",RMPRRX,0)),"^",3)<RMPRSWDT
"RTN","RMPRPF",52,0)
 ..;SET THE "APNEW" FLAG FOR THE PRESCRIPTION
"RTN","RMPRPF",53,0)
 ..S DIE="^RMPR(665,"_RMPRIEN_",""RMPOB"","
"RTN","RMPRPF",54,0)
 ..S DA(1)=RMPRIEN,DA=RMPRRX
"RTN","RMPRPF",55,0)
 ..S DR="100///1"
"RTN","RMPRPF",56,0)
 ..D ^DIE
"RTN","RMPRPF",57,0)
 ..K DIE,DA,DR
"RTN","RMPRPF",58,0)
 ..Q
"RTN","RMPRPF",59,0)
 .Q
"RTN","RMPRPF",60,0)
 ; DIRECT CALL TO THE BACKGROUND PROCESS CODE FOR HOME OXYGEN TO PROCESS THE APNEW FLAG
"RTN","RMPRPF",61,0)
 ; AND OBTAIN PFSS ACCOUNT REFERENCE NUMBERS.
"RTN","RMPRPF",62,0)
 D EN^RMPOPF
"RTN","RMPRPF",63,0)
 ;
"RTN","RMPRPF",64,0)
EXSEED ;
"RTN","RMPRPF",65,0)
 K RMPRIEN,RMPRRX,RMPRSW,RMPRSWDT
"RTN","RMPRPF",66,0)
 Q
"RTN","RMPRPF",67,0)
 ;
"RTN","RMPRPF",68,0)
POST ; The following code is only to be run during patch installation as the post-init
"RTN","RMPRPF",69,0)
 ; This code tasks the running of the routine RMPR112P which contains the fix for the
"RTN","RMPRPF",70,0)
 ;  partial patient merge data-KIDS build issue.
"RTN","RMPRPF",71,0)
 N ZTRTN,ZTDESC,ZTDTH,ZTIO,ZTUCI,ZTCPU,ZTPRI,ZTSAVE,ZTKIL,ZTSYNC
"RTN","RMPRPF",72,0)
 S ZTIO="",ZTRTN="RMPR112P",ZTDESC="Prosthetics Post-INIT for patch RMPR*3*98.",ZTDTH=$H
"RTN","RMPRPF",73,0)
 D ^%ZTLOAD
"RTN","RMPRPF",74,0)
 Q
"RTN","RMPRPF1")
0^5^B17743335
"RTN","RMPRPF1",1,0)
RMPRPF1 ;HOIFO/TH,DDA - PFSS Account Creation ;8/18/05
"RTN","RMPRPF1",2,0)
 ;;3.0;PROSTHETICS;**98**;Feb 09, 1996
"RTN","RMPRPF1",3,0)
 ;
"RTN","RMPRPF1",4,0)
 ; This routine collects PFSS Account Creation required data elements,
"RTN","RMPRPF1",5,0)
 ; sends pre-cert or update message to IBB; obtains and stores a PFSS
"RTN","RMPRPF1",6,0)
 ; Account Reference in file 660.
"RTN","RMPRPF1",7,0)
 ;
"RTN","RMPRPF1",8,0)
 ; DBIA #4664 for GETACCT^IBBAPI
"RTN","RMPRPF1",9,0)
 ; DBIA #1997 for STATCHK^ICPTAPIU
"RTN","RMPRPF1",10,0)
 Q
"RTN","RMPRPF1",11,0)
 ;
"RTN","RMPRPF1",12,0)
EN ; Entry Point
"RTN","RMPRPF1",13,0)
 S OK=1
"RTN","RMPRPF1",14,0)
 S RMPRSWDT=$P($$SWSTAT^IBBAPI(),"^",2)
"RTN","RMPRPF1",15,0)
 ; Quit if Entry Date is before PFSS Switch on date
"RTN","RMPRPF1",16,0)
 I $P(^RMPR(660,RMPRDA,0),"^")<RMPRSWDT D DELAPH Q
"RTN","RMPRPF1",17,0)
EN2 ; Entry to be used if Delivery Date is greater than PFSS Switch on date
"RTN","RMPRPF1",18,0)
 ; Quit if PFSS Charge ID exists
"RTN","RMPRPF1",19,0)
 I $P(^RMPR(660,RMPRDA,"PFSS"),U,2)'="" D DELAPH Q
"RTN","RMPRPF1",20,0)
 ; Quit if Historical Data
"RTN","RMPRPF1",21,0)
 I $P(^RMPR(660,RMPRDA,0),U,13)=13 D DELAPH Q
"RTN","RMPRPF1",22,0)
 ; Quit if Shipping Charge exists
"RTN","RMPRPF1",23,0)
 I $P(^RMPR(660,RMPRDA,0),U,17)>0 D DELAPH Q
"RTN","RMPRPF1",24,0)
 S RMPREVNT="A05"        ; Pre-cert 
"RTN","RMPRPF1",25,0)
 ; Check if PFSS Account Ref exists
"RTN","RMPRPF1",26,0)
 S OK=1
"RTN","RMPRPF1",27,0)
 I $P(^RMPR(660,RMPRDA,"PFSS"),U,1)'="" D
"RTN","RMPRPF1",28,0)
 . ; Quit if PSAS HCPCS did not get updated
"RTN","RMPRPF1",29,0)
 . I $P(^RMPR(660,RMPRDA,1),U,4)=$P(^RMPR(660,RMPRDA,"PFSS"),U,3) D DELAPH S OK=0 Q
"RTN","RMPRPF1",30,0)
 . S RMPREVNT="A08"      ; Update Patient Info
"RTN","RMPRPF1",31,0)
 I OK D
"RTN","RMPRPF1",32,0)
 . D GETDATA
"RTN","RMPRPF1",33,0)
 . D GETACCT
"RTN","RMPRPF1",34,0)
 . ; If msg was sent successfully, store data and kill x-ref
"RTN","RMPRPF1",35,0)
 . I RMPRARFN'=0 D
"RTN","RMPRPF1",36,0)
 . . D STORE
"RTN","RMPRPF1",37,0)
 . . D DELAPH
"RTN","RMPRPF1",38,0)
 D EXIT
"RTN","RMPRPF1",39,0)
 Q
"RTN","RMPRPF1",40,0)
 ;
"RTN","RMPRPF1",41,0)
GETDATA ; Get pre-cert data
"RTN","RMPRPF1",42,0)
 S (RMPRDFN,RMPRARFN,RMPRAPLR)=""
"RTN","RMPRPF1",43,0)
 S RMPRDFN=$P(^RMPR(660,RMPRDA,0),U,2)   ; Patient ID
"RTN","RMPRPF1",44,0)
 S RMPRAPLR="GETACCT;RMPRPF1"
"RTN","RMPRPF1",45,0)
 I RMPREVNT="A08",($P(^RMPR(660,RMPRDA,"PFSS"),U,1)'="") D
"RTN","RMPRPF1",46,0)
 . S RMPRARFN=$P(^RMPR(660,RMPRDA,"PFSS"),U,1)   ; Acct Ref
"RTN","RMPRPF1",47,0)
 ;
"RTN","RMPRPF1",48,0)
 ; PV1
"RTN","RMPRPF1",49,0)
 S RMPRPV1(2)="O"        ; Patient Class
"RTN","RMPRPF1",50,0)
 S RMPRSTA=$P(^RMPR(660,RMPRDA,0),U,10)
"RTN","RMPRPF1",51,0)
 D GETSITE
"RTN","RMPRPF1",52,0)
 S RMPRPV1(3)=RMPRHLOC   ; Patient Location
"RTN","RMPRPF1",53,0)
 S (RMPRORD,RMPRADDT)=""
"RTN","RMPRPF1",54,0)
 S RMPRORD=$P($G(^RMPR(660,RMPRDA,10)),U,6)
"RTN","RMPRPF1",55,0)
 S RMPRPV1(7)=RMPRORD    ; Attending Physician
"RTN","RMPRPF1",56,0)
 S RMPRADDT=$P(^RMPR(660,RMPRDA,0),U,1)
"RTN","RMPRPF1",57,0)
 S RMPRPV1(44)=RMPRADDT  ; Admit Date/Time
"RTN","RMPRPF1",58,0)
 ;
"RTN","RMPRPF1",59,0)
 ; PV2
"RTN","RMPRPF1",60,0)
 S RMPRPV2(8)=RMPRADDT   ; Expected Admit Date/Time
"RTN","RMPRPF1",61,0)
 S RMPREXDT=""
"RTN","RMPRPF1",62,0)
 S RMPREXDT=$P($G(^RMPR(660,RMPRDA,10)),U,1)
"RTN","RMPRPF1",63,0)
 S RMPRPV2(46)=$P(RMPREXDT,".",1) ; Patient Status Effective Date
"RTN","RMPRPF1",64,0)
 ;
"RTN","RMPRPF1",65,0)
 ; PR1
"RTN","RMPRPF1",66,0)
 S RMPRHCPC=$P(^RMPR(660,RMPRDA,1),U,4)    ; PSAS HCPCS
"RTN","RMPRPF1",67,0)
 S RMPRHCDT=RMPRADDT    ;Event date
"RTN","RMPRPF1",68,0)
 D PSASHCPC^RMPOPF    ;CSV check; return RMPRVHC and RMPRTHC.
"RTN","RMPRPF1",69,0)
 S RMPRPR1(3)=RMPRVHC    ; Procedure code
"RTN","RMPRPF1",70,0)
 S RMPRPR1(4)=RMPRTHC    ; PSAS HCPCS text
"RTN","RMPRPF1",71,0)
 ; Procedure Functional Type - I:Stock Issue; P:Purchasing
"RTN","RMPRPF1",72,0)
 S RMPRPR1(6)=$S($P(^RMPR(660,RMPRDA,0),U,13)=11:"I",1:"P")
"RTN","RMPRPF1",73,0)
 ;
"RTN","RMPRPF1",74,0)
 ; DG1 AND ZCL
"RTN","RMPRPF1",75,0)
 D DG1ZCL^RMPRPF2
"RTN","RMPRPF1",76,0)
 Q
"RTN","RMPRPF1",77,0)
 ;
"RTN","RMPRPF1",78,0)
GETSITE ; Get Patient Location
"RTN","RMPRPF1",79,0)
 ; requires RMPRSTA=file 4 pointer
"RTN","RMPRPF1",80,0)
 ; return RMPRHLOC= hospital location or NULL if there is none.
"RTN","RMPRPF1",81,0)
 S RMPRHLOC="",RMPRSIEN=""
"RTN","RMPRPF1",82,0)
 F  S RMPRSIEN=$O(^RMPR(669.9,"C",RMPRSTA,RMPRSIEN)) Q:RMPRSIEN'>0  D
"RTN","RMPRPF1",83,0)
 .S RMPRHLOC=$P(^RMPR(669.9,RMPRSIEN,"PCE"),U,3)
"RTN","RMPRPF1",84,0)
 .Q
"RTN","RMPRPF1",85,0)
 I RMPRHLOC="" D
"RTN","RMPRPF1",86,0)
 .S RMPRSIEN=0
"RTN","RMPRPF1",87,0)
 .F  S RMPRSIEN=$O(^RMPR(669.9,RMPRSIEN)) Q:(RMPRSIEN'>0)!(+RMPRHLOC)  D
"RTN","RMPRPF1",88,0)
 ..S RMPRHLOC=$P(^RMPR(669.9,RMPRSIEN,"PCE"),U,3)
"RTN","RMPRPF1",89,0)
 ..Q
"RTN","RMPRPF1",90,0)
 .Q
"RTN","RMPRPF1",91,0)
 Q
"RTN","RMPRPF1",92,0)
 ;
"RTN","RMPRPF1",93,0)
GETACCT ; Call GETACCT^IBBAPI to send data and get PFSS Account Reference
"RTN","RMPRPF1",94,0)
 S RMPRARFN=$$GETACCT^IBBAPI(RMPRDFN,RMPRARFN,RMPREVNT,RMPRAPLR,.RMPRPV1,.RMPRPV2,.RMPRPR1,.RMPRDG1,.RMPRZCL,"","")
"RTN","RMPRPF1",95,0)
 Q
"RTN","RMPRPF1",96,0)
 ;
"RTN","RMPRPF1",97,0)
STORE ; Store data
"RTN","RMPRPF1",98,0)
 S (RMPRQTY,RMPRTC)=""
"RTN","RMPRPF1",99,0)
 S RMPRQTY=$P(^RMPR(660,RMPRDA,0),U,7)   ; QTY
"RTN","RMPRPF1",100,0)
 S RMPRTC=$P(^RMPR(660,RMPRDA,0),U,16)    ; Total Cost
"RTN","RMPRPF1",101,0)
 ;
"RTN","RMPRPF1",102,0)
 L +^RMPR(660,RMPRDA)
"RTN","RMPRPF1",103,0)
 ; Store 100-PFSS Account Reference; 102-latest PSAS HCPCS; 103-latest QTY; 104-latest Total Cost; 
"RTN","RMPRPF1",104,0)
 ; 105-latest Ordering Provider
"RTN","RMPRPF1",105,0)
 S DIE="^RMPR(660,",DA=RMPRDA
"RTN","RMPRPF1",106,0)
 S DR="100////^S X=RMPRARFN;102////^S X=RMPRHCPC;"
"RTN","RMPRPF1",107,0)
 S DR=DR_"103////^S X=RMPRQTY;104////^S X=RMPRTC;105////^S X=RMPRORD"
"RTN","RMPRPF1",108,0)
 D ^DIE
"RTN","RMPRPF1",109,0)
 L -^RMPR(660,RMPRDA)
"RTN","RMPRPF1",110,0)
 K DA,DIE,DR
"RTN","RMPRPF1",111,0)
 Q
"RTN","RMPRPF1",112,0)
 ;
"RTN","RMPRPF1",113,0)
DELAPD ; Delete the "APD" Flag
"RTN","RMPRPF1",114,0)
 S DIE="^RMPR(660,"
"RTN","RMPRPF1",115,0)
 S DA=RMPRDA
"RTN","RMPRPF1",116,0)
 S DR="107///@"
"RTN","RMPRPF1",117,0)
 D ^DIE
"RTN","RMPRPF1",118,0)
 K DIE,DA,DR
"RTN","RMPRPF1",119,0)
 Q
"RTN","RMPRPF1",120,0)
 ;
"RTN","RMPRPF1",121,0)
DELAPH ; Delete the "APH" Flag
"RTN","RMPRPF1",122,0)
 S DIE="^RMPR(660,"
"RTN","RMPRPF1",123,0)
 S DA=RMPRDA
"RTN","RMPRPF1",124,0)
 S DR="106///@"
"RTN","RMPRPF1",125,0)
 D ^DIE
"RTN","RMPRPF1",126,0)
 K DIE,DA,DR
"RTN","RMPRPF1",127,0)
 Q
"RTN","RMPRPF1",128,0)
EXIT ; Exit
"RTN","RMPRPF1",129,0)
 K OK,RMPREVNT,RMPRARFN,RMPRDFN,RMPRAPLR,RMPRPR1,RMPRSTA
"RTN","RMPRPF1",130,0)
 K RMPRPV1,RMPRHLOC,RMPRORD,RMPRADDT,RMPRSIEN,RMPRHCPC
"RTN","RMPRPF1",131,0)
 K RMPRPV2,RMPREXDT,RMPRDG1,RMPRDIAG,RMPRRICP,RMRICPP
"RTN","RMPRPF1",132,0)
 K RMPRZCL,RMPRNODE,RMPRQTY,RMPRTC,RMPRCPT,RMPRSWDT
"RTN","RMPRPF1",133,0)
 Q
"RTN","RMPRPF2")
0^6^B28817815
"RTN","RMPRPF2",1,0)
RMPRPF2 ;HOIFO/TH,DDA - PFSS CHARGE ;8/18/05
"RTN","RMPRPF2",2,0)
 ;;3.0;PROSTHETICS;**98**;Feb 09, 1996
"RTN","RMPRPF2",3,0)
 ;
"RTN","RMPRPF2",4,0)
 ; This routine gets and stores a PFSS Charge ID, send charge message 
"RTN","RMPRPF2",5,0)
 ; and updated charge to IBB.
"RTN","RMPRPF2",6,0)
 ;
"RTN","RMPRPF2",7,0)
 ;  DBIA # 4665 for GETCHGID^IBBAPI and CHARGE^IBBAPI
"RTN","RMPRPF2",8,0)
 Q
"RTN","RMPRPF2",9,0)
 ;
"RTN","RMPRPF2",10,0)
EN ; Entry Point
"RTN","RMPRPF2",11,0)
 ; Quit if no Delivery Date
"RTN","RMPRPF2",12,0)
 I $P(^RMPR(660,RMPRDA,0),U,12)="" D DELAPD^RMPRPF1 Q
"RTN","RMPRPF2",13,0)
 ; If no PFSS Account Reference, then attempt to get one
"RTN","RMPRPF2",14,0)
 I $P(^RMPR(660,RMPRDA,"PFSS"),U,1)="" D
"RTN","RMPRPF2",15,0)
 . S RMPRSWDT=$P($$SWSTAT^IBBAPI(),"^",2)
"RTN","RMPRPF2",16,0)
 . ; quit if Delivery Date is not after PFSS Switch On date.
"RTN","RMPRPF2",17,0)
 . Q:$P(^RMPR(660,RMPRDA,0),"^",12)<RMPRSWDT
"RTN","RMPRPF2",18,0)
 . D EN2^RMPRPF1
"RTN","RMPRPF2",19,0)
 . Q
"RTN","RMPRPF2",20,0)
 ; If still no PFSS Account Reference, then record is not valid for PFSS- QUIT
"RTN","RMPRPF2",21,0)
 I $P(^RMPR(660,RMPRDA,"PFSS"),U,1)="" D DELAPD^RMPRPF1 Q
"RTN","RMPRPF2",22,0)
 ;
"RTN","RMPRPF2",23,0)
 S RMPRFLAG=1
"RTN","RMPRPF2",24,0)
 ; After Charge Msg sent (Charge ID exists); kill APD x-ref 
"RTN","RMPRPF2",25,0)
 ;     if PSAS HCPCS did not get updated AND
"RTN","RMPRPF2",26,0)
 ;     if QTY did not get updated AND 
"RTN","RMPRPF2",27,0)
 ;     if Total Cost did not get updated AND
"RTN","RMPRPF2",28,0)
 ;     if Ordering Provider did not get updated.
"RTN","RMPRPF2",29,0)
 I $P(^RMPR(660,RMPRDA,"PFSS"),U,2)'="" D
"RTN","RMPRPF2",30,0)
 . I $P($G(^RMPR(660,RMPRDA,1)),U,4)=$P($G(^RMPR(660,RMPRDA,"PFSS")),U,3) S RMPRFLAG=0   ; PSAS HCPCS
"RTN","RMPRPF2",31,0)
 . E  S RMPRFLAG=1 Q
"RTN","RMPRPF2",32,0)
 . I $P(^RMPR(660,RMPRDA,0),U,7)=$P($G(^RMPR(660,RMPRDA,"PFSS")),U,4) S RMPRFLAG=0   ; QTY
"RTN","RMPRPF2",33,0)
 . E  S RMPRFLAG=1 Q
"RTN","RMPRPF2",34,0)
 . I $P(^RMPR(660,RMPRDA,0),U,16)=$P($G(^RMPR(660,RMPRDA,"PFSS")),U,5) S RMPRFLAG=0  ; Total Cost
"RTN","RMPRPF2",35,0)
 . E  S RMPRFLAG=1 Q
"RTN","RMPRPF2",36,0)
 . I $P($G(^RMPR(660,RMPRDA,10)),U,6)=$P($G(^RMPR(660,RMPRDA,"PFSS")),U,6) S RMPRFLAG=0  ; Ordering Provider
"RTN","RMPRPF2",37,0)
 . E  S RMPRFLAG=1 Q
"RTN","RMPRPF2",38,0)
 I RMPRFLAG=0 D DELAPD^RMPRPF1
"RTN","RMPRPF2",39,0)
 ; 
"RTN","RMPRPF2",40,0)
 ; Quit if QTY=0 or null
"RTN","RMPRPF2",41,0)
 S (RMPRQTY,RMPRTC)=0
"RTN","RMPRPF2",42,0)
 S RMPRQTY=$P(^RMPR(660,RMPRDA,0),U,7)
"RTN","RMPRPF2",43,0)
 I RMPRQTY=0!(RMPRQTY="") D DELAPD^RMPRPF1 Q
"RTN","RMPRPF2",44,0)
 ; Quit if Total Cost=0 or null
"RTN","RMPRPF2",45,0)
 S RMPRTC=$P(^RMPR(660,RMPRDA,0),U,16)
"RTN","RMPRPF2",46,0)
 I RMPRTC=0!(RMPRTC="") D DELAPD^RMPRPF1 Q
"RTN","RMPRPF2",47,0)
 ;
"RTN","RMPRPF2",48,0)
 I RMPRFLAG=1 D
"RTN","RMPRPF2",49,0)
 . ; Check if PFSS Charge ID exists
"RTN","RMPRPF2",50,0)
 . I $P($G(^RMPR(660,RMPRDA,"PFSS")),U,2)="" D GETUCID,STORE
"RTN","RMPRPF2",51,0)
 . ; Get charge data
"RTN","RMPRPF2",52,0)
 . D GETDATA
"RTN","RMPRPF2",53,0)
 . ; Send charge data to IBB
"RTN","RMPRPF2",54,0)
 . D SENDCHRG
"RTN","RMPRPF2",55,0)
 . ; If charge msg was sent successfully, 
"RTN","RMPRPF2",56,0)
 . ; Update latest PSAS HCPCS, QTY, Total Cost, and Ordering Provider
"RTN","RMPRPF2",57,0)
 . ; then kill the x-ref
"RTN","RMPRPF2",58,0)
 . I RMPRCHRG'=0 D UPDATE D DELAPD^RMPRPF1
"RTN","RMPRPF2",59,0)
 D EXIT
"RTN","RMPRPF2",60,0)
 Q
"RTN","RMPRPF2",61,0)
 ;
"RTN","RMPRPF2",62,0)
GETUCID ; Obtain PFSS Charge ID
"RTN","RMPRPF2",63,0)
 S RMPRUCID=""
"RTN","RMPRPF2",64,0)
 S RMPRUCID=$$GETCHGID^IBBAPI()
"RTN","RMPRPF2",65,0)
 Q
"RTN","RMPRPF2",66,0)
 ;
"RTN","RMPRPF2",67,0)
STORE ; Store PFSS Charge ID
"RTN","RMPRPF2",68,0)
 L +^RMPR(660,RMPRDA)
"RTN","RMPRPF2",69,0)
 S DIE="^RMPR(660,",DA=RMPRDA
"RTN","RMPRPF2",70,0)
 S DR="101////^S X=RMPRUCID" D ^DIE
"RTN","RMPRPF2",71,0)
 L -^RMPR(660,RMPRDA)
"RTN","RMPRPF2",72,0)
 K DA,DIE,DR
"RTN","RMPRPF2",73,0)
 Q
"RTN","RMPRPF2",74,0)
 ;
"RTN","RMPRPF2",75,0)
GETDATA ; Get Charge Data
"RTN","RMPRPF2",76,0)
 S RMPRDFN=$P(^RMPR(660,RMPRDA,0),U,2)           ; Patient ID
"RTN","RMPRPF2",77,0)
 S RMPRARFN=$P($G(^RMPR(660,RMPRDA,"PFSS")),U,1)     ; PFSS Acct Ref
"RTN","RMPRPF2",78,0)
 S RMPRTYPE="CG" ; Charge Type = Debit
"RTN","RMPRPF2",79,0)
 S RMPRUCID=$P($G(^RMPR(660,RMPRDA,"PFSS")),U,2)     ; PFSS Charge ID
"RTN","RMPRPF2",80,0)
 ;
"RTN","RMPRPF2",81,0)
 ; FT1
"RTN","RMPRPF2",82,0)
 S RMPRDEL=$P(^RMPR(660,RMPRDA,0),U,12)
"RTN","RMPRPF2",83,0)
 S RMPRFT1(4)=RMPRDEL      ; Delivery Date
"RTN","RMPRPF2",84,0)
 S RMPRFT1(10)=RMPRQTY    ; Transaction Quantity
"RTN","RMPRPF2",85,0)
 S RMPRFT1(13)=423               ; Department Code
"RTN","RMPRPF2",86,0)
 ; Ordering Provider/Ordered by Code
"RTN","RMPRPF2",87,0)
 S RMPRORD=$P($G(^RMPR(660,RMPRDA,10)),U,6)
"RTN","RMPRPF2",88,0)
 S RMPRFT1(21)=RMPRORD
"RTN","RMPRPF2",89,0)
 ; Unit Cost = Total Cost/QTY
"RTN","RMPRPF2",90,0)
 S RMPRFT1(22)=RMPRTC/RMPRQTY
"RTN","RMPRPF2",91,0)
 ;
"RTN","RMPRPF2",92,0)
 ; PR1
"RTN","RMPRPF2",93,0)
 S RMPRHCPC=$P($G(^RMPR(660,RMPRDA,1)),"^",4)
"RTN","RMPRPF2",94,0)
 S RMPRHCDT=$P(^RMPR(660,RMPRDA,0),"^")
"RTN","RMPRPF2",95,0)
 D PSASHCPC^RMPOPF
"RTN","RMPRPF2",96,0)
 S RMPRPR1(3)=RMPRVHC   ; Procedure Code
"RTN","RMPRPF2",97,0)
 S RMPRPR1(4)=RMPRTHC   ; PSAS HCPCS text
"RTN","RMPRPF2",98,0)
 ; Procedure Functional Type - I:Stock Issue;P:Purchasing
"RTN","RMPRPF2",99,0)
 S RMPRPFT="",RMPRPFT=$S($P(^RMPR(660,RMPRDA,0),U,13)=11:"I",1:"P")
"RTN","RMPRPF2",100,0)
 S RMPRPR1(6)=RMPRPFT
"RTN","RMPRPF2",101,0)
 ;
"RTN","RMPRPF2",102,0)
 ; PROS
"RTN","RMPRPF2",103,0)
 S (RMPRVNDR,RMPROBL)=""
"RTN","RMPRPF2",104,0)
 S RMPRVNDR=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPF2",105,0)
 S RMPRPROS(1)=RMPRVNDR       ; Vendor
"RTN","RMPRPF2",106,0)
 S RMPROBL=$E($P($G(^RMPR(660,RMPRDA,1)),U,1),1,30)
"RTN","RMPRPF2",107,0)
 S RMPRPROS(2)=RMPROBL         ; OBL#
"RTN","RMPRPF2",108,0)
 ;
"RTN","RMPRPF2",109,0)
DG1ZCL ; SET UP DATA FOR DG1 AND ZCL
"RTN","RMPRPF2",110,0)
 S RMPRBA1=$G(^RMPR(660,RMPRDA,"BA1"))
"RTN","RMPRPF2",111,0)
 S RMPRBA2=$G(^RMPR(660,RMPRDA,"BA2"))
"RTN","RMPRPF2",112,0)
 S RMPRBA3=$G(^RMPR(660,RMPRDA,"BA3"))
"RTN","RMPRPF2",113,0)
 S RMPRBA4=$G(^RMPR(660,RMPRDA,"BA4"))
"RTN","RMPRPF2",114,0)
 S RMPRDIAG=$P($G(^RMPR(660,RMPRDA,10)),"^",8)
"RTN","RMPRPF2",115,0)
 S RMPRICDT=$P(^RMPR(660,RMPRDA,0),"^")
"RTN","RMPRPF2",116,0)
 F I=1:1:4 D
"RTN","RMPRPF2",117,0)
 .; DG1
"RTN","RMPRPF2",118,0)
 .;CSV CHECK
"RTN","RMPRPF2",119,0)
 .S RMPRDRG=$P(@("RMPRBA"_I),"^")
"RTN","RMPRPF2",120,0)
 .S:+RMPRDRG RMPRDRG=$$STATCHK^ICDAPIU($P($G(^ICD9(RMPRDRG,0)),"^"),RMPRICDT)
"RTN","RMPRPF2",121,0)
 .Q:+RMPRDRG=0
"RTN","RMPRPF2",122,0)
 .S RMPRDG1(I,3)=$P(RMPRDRG,"^",2) ; Diagnosis Code
"RTN","RMPRPF2",123,0)
 .S RMPRDG1(I,6)="F"      ; Diagnosis Type
"RTN","RMPRPF2",124,0)
 .;
"RTN","RMPRPF2",125,0)
 .; ZCL
"RTN","RMPRPF2",126,0)
 .F J=2:1:8 I $P(@("RMPRBA"_I),"^",J)'="" D
"RTN","RMPRPF2",127,0)
 ..; Set type and value.  Overwrite null and zero values
"RTN","RMPRPF2",128,0)
 ..S:+$G(RMPRZCL(J-1,3))=0 RMPRZCL(J-1,2)=J-1,RMPRZCL(J-1,3)=$P(@("RMPRBA"_I),"^",J)
"RTN","RMPRPF2",129,0)
 ..Q
"RTN","RMPRPF2",130,0)
 .Q
"RTN","RMPRPF2",131,0)
 ; IF NO CONSULT DIAG, USE PROSTHETICS ONE
"RTN","RMPRPF2",132,0)
 I $G(RMPRDG1(1,3))="" D
"RTN","RMPRPF2",133,0)
 .S RMPRDRG=$$STATCHK^ICDAPIU($P($G(^ICD9(RMPRDIAG,0)),"^"),RMPRICDT)
"RTN","RMPRPF2",134,0)
 .Q:+RMPRDRG=0
"RTN","RMPRPF2",135,0)
 .S RMPRDG1(1,3)=$P(RMPRDRG,"^",2),RMPRDG1(1,6)="F"
"RTN","RMPRPF2",136,0)
 .Q
"RTN","RMPRPF2",137,0)
 Q
"RTN","RMPRPF2",138,0)
 ;
"RTN","RMPRPF2",139,0)
SENDCHRG ; Send Charge Data
"RTN","RMPRPF2",140,0)
 S RMPRCHRG=""
"RTN","RMPRPF2",141,0)
 S RMPRCHRG=$$CHARGE^IBBAPI(RMPRDFN,RMPRARFN,RMPRTYPE,RMPRUCID,.RMPRFT1,.RMPRPR1,.RMPRDG1,.RMPRZCL,"","",.RMPRPROS)
"RTN","RMPRPF2",142,0)
 Q
"RTN","RMPRPF2",143,0)
 ;
"RTN","RMPRPF2",144,0)
UPDATE ; Update latest fields
"RTN","RMPRPF2",145,0)
 L +^RMPR(660,RMPRDA)
"RTN","RMPRPF2",146,0)
 ; Store updates 102-latest PSAS HCPCS; 103-latest QTY; 104-latest Total Cost; 
"RTN","RMPRPF2",147,0)
 ; 105-latest Ordering Provider
"RTN","RMPRPF2",148,0)
 S DIE="^RMPR(660,",DA=RMPRDA
"RTN","RMPRPF2",149,0)
 S DR="102////^S X=RMPRHCPC;103////^S X=RMPRQTY;104////^S X=RMPRTC;"
"RTN","RMPRPF2",150,0)
 S DR=DR_"105////^S X=RMPRORD"
"RTN","RMPRPF2",151,0)
 D ^DIE
"RTN","RMPRPF2",152,0)
 L -^RMPR(660,RMPRDA)
"RTN","RMPRPF2",153,0)
 K DA,DIE,DR
"RTN","RMPRPF2",154,0)
 Q
"RTN","RMPRPF2",155,0)
 ;
"RTN","RMPRPF2",156,0)
EXIT ; Common exit point
"RTN","RMPRPF2",157,0)
 K RMPRFLAG,RMPRQTY,RMPRTC,RMPRCHRG,RMPRUCID,RMPRDFN
"RTN","RMPRPF2",158,0)
 K RMPRARFN,RMPRTYPE,RMPRFT1,RMPRPR1,RMPRCPT,RMPRRICP
"RTN","RMPRPF2",159,0)
 K RMPRDG1,RMPRDIAG,RMPRZCL,RMPRNODE,RMPRPROS,RMPRHCPC
"RTN","RMPRPF2",160,0)
 K RMRICPP,RMPRCPT
"RTN","RMPRPF2",161,0)
 Q
"RTN","RMPRPF3")
0^7^B8566306
"RTN","RMPRPF3",1,0)
RMPRPF3 ;HOIFO/TH,DDA - PFSS Charge Cancel (credit) ;8/18/05
"RTN","RMPRPF3",2,0)
 ;;3.0;PROSTHETICS;**98**;Feb 09, 1996
"RTN","RMPRPF3",3,0)
 ;
"RTN","RMPRPF3",4,0)
 ; This routine sends "Credit" Charge Message to IBB if .01 field got deleted in file 660
"RTN","RMPRPF3",5,0)
 ;  or if the PSAS HCPCS code is deleted (equals null after user edit).
"RTN","RMPRPF3",6,0)
 ; 
"RTN","RMPRPF3",7,0)
 ; DBIA # 4663 for SWSTAT^IBBAPI
"RTN","RMPRPF3",8,0)
 ; DBIA # 4665 for CHARGE^IBBAPI
"RTN","RMPRPF3",9,0)
 Q
"RTN","RMPRPF3",10,0)
 ;
"RTN","RMPRPF3",11,0)
CHRGTASK ; FILE #660, ENTRY DATE AND PSAS HCPCS FIELDS MUMPS XREF
"RTN","RMPRPF3",12,0)
 ;KILL LOGIC.
"RTN","RMPRPF3",13,0)
 ; TASKMAN LOAD A ONE TIME TASKMAN TASK.
"RTN","RMPRPF3",14,0)
 ; QUIT IF PFSS SWITCH IS OFF OR IF THERE IS NO CHARGE TO REVERSE
"RTN","RMPRPF3",15,0)
 Q:'+$$SWSTAT^IBBAPI()
"RTN","RMPRPF3",16,0)
 S RMPRPFSS=$G(^RMPR(660,DA,"PFSS"))
"RTN","RMPRPF3",17,0)
 Q:$P(RMPRPFSS,"^",2)=""
"RTN","RMPRPF3",18,0)
 S RMPRZERO=^RMPR(660,DA,0)
"RTN","RMPRPF3",19,0)
 N ZTRTN,ZTDESC,ZTDTH,ZTIO,ZTUCI,ZTCPU,ZTPRI,ZTSAVE,ZTKIL,ZTSYNC
"RTN","RMPRPF3",20,0)
 S ZTIO="",ZTRTN="CHRGCRED^RMPRPF3",ZTDESC="Prosthetics file #660 PFSS Charge Credit",ZTDTH=$H
"RTN","RMPRPF3",21,0)
 S ZTSAVE("RMPRIEN")=DA
"RTN","RMPRPF3",22,0)
 S ZTSAVE("RMPRZERO")=RMPRZERO
"RTN","RMPRPF3",23,0)
 S ZTSAVE("RMPRONE")=$G(^RMPR(660,DA,1))
"RTN","RMPRPF3",24,0)
 S ZTSAVE("RMPRTEN")=$G(^RMPR(660,DA,10))
"RTN","RMPRPF3",25,0)
 S ZTSAVE("RMPRPFSS")=RMPRPFSS
"RTN","RMPRPF3",26,0)
 D ^%ZTLOAD
"RTN","RMPRPF3",27,0)
 Q
"RTN","RMPRPF3",28,0)
 ;
"RTN","RMPRPF3",29,0)
CHRGCRED ; Process account deletion/cancellation
"RTN","RMPRPF3",30,0)
 ;
"RTN","RMPRPF3",31,0)
 ; Check if already processing this record.
"RTN","RMPRPF3",32,0)
 Q:$G(^TMP("RMPRPF3",RMPRIEN))=RMPRIEN
"RTN","RMPRPF3",33,0)
 S ^TMP("RMPRPF3",RMPRIEN)=RMPRIEN
"RTN","RMPRPF3",34,0)
 ; Check if this is just a Date edit or a PSAS HCPCS edit, set x-ref AND QUIT.
"RTN","RMPRPF3",35,0)
 S RMPRCDFL=0
"RTN","RMPRPF3",36,0)
 S:'$D(^RMPR(660,RMPRIEN,0)) RMPRCDFL=1
"RTN","RMPRPF3",37,0)
 S:$P($G(RMPRONE),"^",4)="" RMPRCDFL=1
"RTN","RMPRPF3",38,0)
 I RMPRCDFL=0 D SETAPD G EXIT
"RTN","RMPRPF3",39,0)
 ; RECORD HAS EITHER BEEN DELETED OR PSAS HCPCS HAS BEEN DELETED.  SEND A CREDIT (CD).
"RTN","RMPRPF3",40,0)
 S RMPRUCID=$P(RMPRPFSS,U,2)
"RTN","RMPRPF3",41,0)
 S RMPRTYPE="CD"
"RTN","RMPRPF3",42,0)
 S RMPRDFN=$P(RMPRZERO,"^",2)
"RTN","RMPRPF3",43,0)
 S RMPRARFN=$P(RMPRPFSS,"^")
"RTN","RMPRPF3",44,0)
 ;
"RTN","RMPRPF3",45,0)
 ; FT1
"RTN","RMPRPF3",46,0)
 S RMPRFT1(4)=$P(RMPRZERO,"^",12)  ; Delivery Date
"RTN","RMPRPF3",47,0)
 S RMPRFT1(10)=$P(RMPRZERO,"^",7)  ; Transaction Quantity
"RTN","RMPRPF3",48,0)
 S RMPRFT1(13)=423  ; Department Code
"RTN","RMPRPF3",49,0)
 S RMPRFT1(21)=$P($G(RMPRTEN),"^",6)  ; Ordering Provider/Ordered by Code
"RTN","RMPRPF3",50,0)
 S RMPRTC=$P(RMPRZERO,"^",16)
"RTN","RMPRPF3",51,0)
 S RMPRFT1(22)=RMPRTC/RMPRFT1(10)    ; Unit Cost = Total Cost/QTY
"RTN","RMPRPF3",52,0)
 ; PR1
"RTN","RMPRPF3",53,0)
 S RMPRHCPC=$P(RMPRONE,"^",4)
"RTN","RMPRPF3",54,0)
 S RMPRHCDT=$P(RMPRONE,"^")
"RTN","RMPRPF3",55,0)
 D PSASHCPC^RMPOPF
"RTN","RMPRPF3",56,0)
 S RMPRPR1(3)=RMPRVHC   ; Procedure Code
"RTN","RMPRPF3",57,0)
 S RMPRPR1(4)=RMPRTHC   ; PSAS HCPCS text
"RTN","RMPRPF3",58,0)
 ; Procedure Functional Type - I:Stock Issue;P:Purchasing
"RTN","RMPRPF3",59,0)
 S RMPRPR1(6)=$S($P(RMPRZERO,"^",13)=11:"I",1:"P")
"RTN","RMPRPF3",60,0)
 ;
"RTN","RMPRPF3",61,0)
SENDDATA ; Send charge data
"RTN","RMPRPF3",62,0)
 S RMPRCHRG=$$CHARGE^IBBAPI(RMPRDFN,RMPRARFN,RMPRTYPE,RMPRUCID,.RMPRFT1,.RMPRPR1,"","","","","")
"RTN","RMPRPF3",63,0)
 Q
"RTN","RMPRPF3",64,0)
 ;
"RTN","RMPRPF3",65,0)
SETAPD ; Set the APD cross-reference because the activity was only an edit, not a delete.
"RTN","RMPRPF3",66,0)
 S DIE="^RMPR(660,"
"RTN","RMPRPF3",67,0)
 S DA=RMPRIEN
"RTN","RMPRPF3",68,0)
 S DR="107///^S X=1"
"RTN","RMPRPF3",69,0)
 D ^DIE
"RTN","RMPRPF3",70,0)
 K DIE,DA,DR
"RTN","RMPRPF3",71,0)
 Q
"RTN","RMPRPF3",72,0)
EXIT ; Common exit point
"RTN","RMPRPF3",73,0)
 K ^TMP("RMPRPF3",RMPRIEN)
"RTN","RMPRPF3",74,0)
 K RMPRQTY,RMPRTC,RMPRCHRG,RMPRUCID,RMPRDFN,RMRICPP,RMPRCPT
"RTN","RMPRPF3",75,0)
 K RMPRARFN,RMPRTYPE,RMPRFT1,RMPRPR1,RMPRCPT,RMPRRICP
"RTN","RMPRPF3",76,0)
 K RMPRDG1,RMPRDIAG,RMPRZCL,RMPRNODE,RMPRPROS,RMPRHCPC,RMPRHCDT,RMPRVHC,RMPRTHC
"RTN","RMPRPF3",77,0)
 K ZTRTN,ZTDESC,ZTDTH,ZTIO,ZTUCI,ZTCPU,ZTPRI,ZTSAVE,ZTKIL,ZTSYNC
"RTN","RMPRPF3",78,0)
 Q
"SEC","^DD",660,660,106,9)

"UP",665,665.193,-1)
665^RMPOB
"UP",665,665.193,0)
665.193
"UP",665,665.194,-1)
665^RMPOC
"UP",665,665.194,0)
665.194
"UP",665.72,665.723191,-4)
665.72^1
"UP",665.72,665.723191,-3)
665.723^1
"UP",665.72,665.723191,-2)
665.7231^V
"UP",665.72,665.723191,-1)
665.72319^1
"UP",665.72,665.723191,0)
665.723191
"VER")
8.0^22.0
"^DD",660,660,.01,0)
ENTRY DATE^RD^^0;1^S %DT="ET" D ^%DT S X=Y K:Y<1 X
"^DD",660,660,.01,1,0)
^.1
"^DD",660,660,.01,1,1,0)
660^B
"^DD",660,660,.01,1,1,1)
S ^RMPR(660,"B",$E(X,1,30),DA)=""
"^DD",660,660,.01,1,1,2)
K ^RMPR(660,"B",$E(X,1,30),DA)
"^DD",660,660,.01,1,2,0)
660^F^MUMPS
"^DD",660,660,.01,1,2,1)
I +$P(^RMPR(660,DA,0),U,2) S ^RMPR(660,"F",$E(X,1,30),+$P(^RMPR(660,DA,0),U,2),DA)=""
"^DD",660,660,.01,1,2,2)
I +$P(^RMPR(660,DA,0),U,2) K ^RMPR(660,"F",$E(X,1,30),+$P(^RMPR(660,DA,0),U,2),DA)
"^DD",660,660,.01,1,2,"%D",0)
^^2^2^2930306^
"^DD",660,660,.01,1,2,"%D",1,0)
This x-ref allows lookups on the "F" x-ref by Appliance and Repair date and
"^DD",660,660,.01,1,2,"%D",2,0)
Patient IEN.
"^DD",660,660,.01,1,2,"DT")
2920127
"^DD",660,660,.01,1,3,0)
^^TRIGGER^660^106
"^DD",660,660,.01,1,3,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(660,.01,1,3,1.4)
"^DD",660,660,.01,1,3,1.4)
S DIH=$G(^RMPR(660,DIV(0),"PFSS")),DIV=X S $P(^("PFSS"),U,7)=DIV,DIH=660,DIG=106 D ^DICR
"^DD",660,660,.01,1,3,2)
Q
"^DD",660,660,.01,1,3,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",660,660,.01,1,3,"DELETE VALUE")
NO EFFECT
"^DD",660,660,.01,1,3,"DT")
3051101
"^DD",660,660,.01,1,3,"FIELD")
PFSS ACCOUNT FLAG
"^DD",660,660,.01,1,4,0)
660^APTASK01^MUMPS
"^DD",660,660,.01,1,4,1)
Q
"^DD",660,660,.01,1,4,2)
D CHRGTASK^RMPRPF3
"^DD",660,660,.01,1,4,"DT")
3051101
"^DD",660,660,.01,3)
Please enter a valid date.
"^DD",660,660,.01,21,0)
^^1^1^2950417^^^^
"^DD",660,660,.01,21,1,0)
This is the date that the transaction was entered into the system.  It may or may not be the same as the request date.
"^DD",660,660,.01,"DEL",.01,0)
I 1 W "  CANNOT DELETE ENTRY THIS WAY."
"^DD",660,660,.01,"DT")
3051101
"^DD",660,660,4.5,0)
PSAS HCPCS^P661.1'X^RMPR(661.1,^1;4^K:$P(^RMPR(661.1,X,0),U,5)'=1 X
"^DD",660,660,4.5,1,0)
^.1
"^DD",660,660,4.5,1,1,0)
^^TRIGGER^660^4.1
"^DD",660,660,4.5,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,0)):^(0),1:"") S X=$P(Y(1),U,22),X=X S DIU=X K Y X ^DD(660,4.5,1,1,1.1) X ^DD(660,4.5,1,1,1.4)
"^DD",660,660,4.5,1,1,1.1)
S X=DIV S RMXX=$P(^RMPR(661.1,DIV,0),U,4),$P(^RMPR(660,DA,0),U,22)=RMXX
"^DD",660,660,4.5,1,1,1.4)
S DIH=$S($D(^RMPR(660,DIV(0),0)):^(0),1:""),DIV=RMXX S $P(^(0),U,22)=DIV,DIH=660,DIG=4.1 K RMXX D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",660,660,4.5,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,0)):^(0),1:"") S X=$P(Y(1),U,22),X=X S DIU=X K Y S X="" X ^DD(660,4.5,1,1,2.4)
"^DD",660,660,4.5,1,1,2.4)
S DIH=$S($D(^RMPR(660,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,22)=DIV,DIH=660,DIG=4.1 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",660,660,4.5,1,1,"CREATE VALUE")
S RMXX=$P(^RMPR(661.1,DIV,0),U,4),$P(^RMPR(660,DA,0),U,22)=RMXX K RMXX
"^DD",660,660,4.5,1,1,"DELETE VALUE")
@
"^DD",660,660,4.5,1,1,"DT")
2980611
"^DD",660,660,4.5,1,1,"FIELD")
HCPCS
"^DD",660,660,4.5,1,2,0)
660^H
"^DD",660,660,4.5,1,2,1)
S ^RMPR(660,"H",$E(X,1,30),DA)=""
"^DD",660,660,4.5,1,2,2)
K ^RMPR(660,"H",$E(X,1,30),DA)
"^DD",660,660,4.5,1,2,"DT")
2990608
"^DD",660,660,4.5,1,3,0)
^^TRIGGER^660^106
"^DD",660,660,4.5,1,3,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(660,4.5,1,3,1.4)
"^DD",660,660,4.5,1,3,1.4)
S DIH=$G(^RMPR(660,DIV(0),"PFSS")),DIV=X S $P(^("PFSS"),U,7)=DIV,DIH=660,DIG=106 D ^DICR
"^DD",660,660,4.5,1,3,2)
Q
"^DD",660,660,4.5,1,3,3)
This cross-reference will be never deleted by the user.
"^DD",660,660,4.5,1,3,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",660,660,4.5,1,3,"DELETE VALUE")
NO EFFECT
"^DD",660,660,4.5,1,3,"DT")
3051028
"^DD",660,660,4.5,1,3,"FIELD")
PFSS ACCOUNT FLAG
"^DD",660,660,4.5,1,4,0)
^^TRIGGER^660^107
"^DD",660,660,4.5,1,4,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(660,4.5,1,4,1.4)
"^DD",660,660,4.5,1,4,1.4)
S DIH=$G(^RMPR(660,DIV(0),"PFSS")),DIV=X S $P(^("PFSS"),U,8)=DIV,DIH=660,DIG=107 D ^DICR
"^DD",660,660,4.5,1,4,2)
Q
"^DD",660,660,4.5,1,4,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",660,660,4.5,1,4,"DELETE VALUE")
NO EFFECT
"^DD",660,660,4.5,1,4,"DT")
3051028
"^DD",660,660,4.5,1,4,"FIELD")
PFSS CHARGE FLAG
"^DD",660,660,4.5,1,5,0)
660^APTASK45^MUMPS
"^DD",660,660,4.5,1,5,1)
Q
"^DD",660,660,4.5,1,5,2)
D CHRGTASK^RMPRPF3
"^DD",660,660,4.5,1,5,"DT")
3051101
"^DD",660,660,4.5,3)
Enter standardized Prosthetics HCPCS
"^DD",660,660,4.5,8.5)
@
"^DD",660,660,4.5,21,0)
^.001^1^1^3050725^^^^
"^DD",660,660,4.5,21,1,0)
Standardized Prosthetics HCPCS that points to file 661.1.
"^DD",660,660,4.5,"DT")
3051101
"^DD",660,660,5,0)
QTY^RNJ4,0^^0;7^K:+X'=X!(X>1000)!(X<1)!(X?.E1"."1N.N) X
"^DD",660,660,5,1,0)
^.1
"^DD",660,660,5,1,1,0)
^^TRIGGER^660^107
"^DD",660,660,5,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(660,5,1,1,1.4)
"^DD",660,660,5,1,1,1.4)
S DIH=$G(^RMPR(660,DIV(0),"PFSS")),DIV=X S $P(^("PFSS"),U,8)=DIV,DIH=660,DIG=107 D ^DICR
"^DD",660,660,5,1,1,2)
Q
"^DD",660,660,5,1,1,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",660,660,5,1,1,"DELETE VALUE")
NO EFFECT
"^DD",660,660,5,1,1,"DT")
3051028
"^DD",660,660,5,1,1,"FIELD")
PFSS CHARGE FLAG
"^DD",660,660,5,3)
Type a Number between 1 and 1000, 0 Decimal Digits
"^DD",660,660,5,21,0)
^^2^2^2950413^^^^
"^DD",660,660,5,21,1,0)
This is the number of units that was issued or repaired for
"^DD",660,660,5,21,2,0)
this transaction.
"^DD",660,660,5,"DT")
3051028
"^DD",660,660,8.6,0)
SUSPENSE REQUESTOR^P200'^VA(200,^10;6^Q
"^DD",660,660,8.6,1,0)
^.1
"^DD",660,660,8.6,1,1,0)
^^TRIGGER^660^107
"^DD",660,660,8.6,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(660,8.6,1,1,1.4)
"^DD",660,660,8.6,1,1,1.4)
S DIH=$G(^RMPR(660,DIV(0),"PFSS")),DIV=X S $P(^("PFSS"),U,8)=DIV,DIH=660,DIG=107 D ^DICR
"^DD",660,660,8.6,1,1,2)
Q
"^DD",660,660,8.6,1,1,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",660,660,8.6,1,1,"DELETE VALUE")
NO EFFECT
"^DD",660,660,8.6,1,1,"DT")
3051028
"^DD",660,660,8.6,1,1,"FIELD")
PFSS CHARGE FLAG
"^DD",660,660,8.6,21,0)
^^2^2^3010924^
"^DD",660,660,8.6,21,1,0)
This is a pointer to file #200, the person requesting the suspense as it 
"^DD",660,660,8.6,21,2,0)
appears in file #668.
"^DD",660,660,8.6,"DT")
3051028
"^DD",660,660,14,0)
TOTAL COST^RNJ9,2^^0;16^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999.99)!(X<0) X
"^DD",660,660,14,1,0)
^.1
"^DD",660,660,14,1,1,0)
^^TRIGGER^660^107
"^DD",660,660,14,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RMPR(660,D0,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(660,14,1,1,1.4)
"^DD",660,660,14,1,1,1.4)
S DIH=$G(^RMPR(660,DIV(0),"PFSS")),DIV=X S $P(^("PFSS"),U,8)=DIV,DIH=660,DIG=107 D ^DICR
"^DD",660,660,14,1,1,2)
Q
"^DD",660,660,14,1,1,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",660,660,14,1,1,"DELETE VALUE")
NO EFFECT
"^DD",660,660,14,1,1,"DT")
3051028
"^DD",660,660,14,1,1,"FIELD")
PFSS CHARGE FLAG
"^DD",660,660,14,3)
Type a Dollar Amount between 0 and 999999.99, 2 Decimal Digits
"^DD",660,660,14,21,0)
^^1^1^2950417^^^^
"^DD",660,660,14,21,1,0)
This field contains the total cost of the transaction.
"^DD",660,660,14,"DT")
3051028
"^DD",660,660,100,0)
PFSS ACCOUNT REFERENCE^P375'^IBBAA(375,^PFSS;1^Q
"^DD",660,660,100,21,0)
^.001^3^3^3050822^^^
"^DD",660,660,100,21,1,0)
This refers to the reference number passed back to Prosthetics application
"^DD",660,660,100,21,2,0)
from the PFSS IBB get account process. This field points to PFSS ACCOUNT 
"^DD",660,660,100,21,3,0)
file (#375).
"^DD",660,660,100,"DT")
3050630
"^DD",660,660,101,0)
PFSS CHARGE ID^NJ8,0^^PFSS;2^K:+X'=X!(X>99999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",660,660,101,3)
Type a Number between 1 and 99999999, 0 Decimal Digits
"^DD",660,660,101,21,0)
^^2^2^3050630^
"^DD",660,660,101,21,1,0)
A unique charge identifier for each charge entity. Prosthetics calls
"^DD",660,660,101,21,2,0)
$$GETCHGID^IBBAPI() to obtain a Unique Charge Identifier.
"^DD",660,660,101,"DT")
3050630
"^DD",660,660,102,0)
LATEST PSAS HCPCS^P661.1'^RMPR(661.1,^PFSS;3^Q
"^DD",660,660,102,21,0)
^^2^2^3050630^
"^DD",660,660,102,21,1,0)
This is the latest PSAS HCPCS code that is held and stored for comparison 
"^DD",660,660,102,21,2,0)
during the account updates for the PFSS project.
"^DD",660,660,102,"DT")
3050630
"^DD",660,660,103,0)
LATEST QTY^NJ4,0^^PFSS;4^K:+X'=X!(X>1000)!(X<1)!(X?.E1"."1N.N) X
"^DD",660,660,103,3)
Type a Number between 1 and 1000, 0 Decimal Digits
"^DD",660,660,103,21,0)
^^2^2^3050630^
"^DD",660,660,103,21,1,0)
This is the latest QTY that is held and stored for comparison during the 
"^DD",660,660,103,21,2,0)
account updates for the PFSS project.
"^DD",660,660,103,"DT")
3050630
"^DD",660,660,104,0)
LATEST TOTAL COST^NJ9,2^^PFSS;5^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999.99)!(X<0) X
"^DD",660,660,104,3)
Type a Dollar Amount between 0 and 999999.99, 2 Decimal Digits
"^DD",660,660,104,21,0)
^^2^2^3050630^
"^DD",660,660,104,21,1,0)
This is the latest Total Cost that is held and stored for comparison 
"^DD",660,660,104,21,2,0)
during the account updates for the PFSS project.
"^DD",660,660,104,"DT")
3050630
"^DD",660,660,105,0)
LATEST ORDERING PROVIDER^P200'^VA(200,^PFSS;6^Q
"^DD",660,660,105,21,0)
^^2^2^3050630^
"^DD",660,660,105,21,1,0)
This is the latest attending physician (ordering provider) that is held 
"^DD",660,660,105,21,2,0)
and stored for comparison during the account updates for the PFSS project.
"^DD",660,660,105,"DT")
3050630
"^DD",660,660,106,0)
PFSS ACCOUNT FLAG^S^1:READY TO PROCESS;^PFSS;7^Q
"^DD",660,660,106,1,0)
^.1^^-1
"^DD",660,660,106,1,1,0)
660^APH
"^DD",660,660,106,1,1,1)
S ^RMPR(660,"APH",$E(X,1,30),DA)=""
"^DD",660,660,106,1,1,2)
K ^RMPR(660,"APH",$E(X,1,30),DA)
"^DD",660,660,106,1,1,"DT")
3050701
"^DD",660,660,106,5,1,0)
660^4.5^3
"^DD",660,660,106,5,2,0)
660^.01^3
"^DD",660,660,106,21,0)
^.001^2^2^3050713^^^
"^DD",660,660,106,21,1,0)
Flag for ready to process PFSS Account Creation/Pre-Certification. 
"^DD",660,660,106,21,2,0)
1 = Ready to process
"^DD",660,660,106,"DT")
3051027
"^DD",660,660,107,0)
PFSS CHARGE FLAG^S^1:READY TO PROCESS;^PFSS;8^Q
"^DD",660,660,107,1,0)
^.1
"^DD",660,660,107,1,1,0)
660^APD
"^DD",660,660,107,1,1,1)
S ^RMPR(660,"APD",$E(X,1,30),DA)=""
"^DD",660,660,107,1,1,2)
K ^RMPR(660,"APD",$E(X,1,30),DA)
"^DD",660,660,107,1,1,"DT")
3050713
"^DD",660,660,107,5,1,0)
660^4.5^4
"^DD",660,660,107,5,2,0)
660^5^1
"^DD",660,660,107,5,3,0)
660^14^1
"^DD",660,660,107,5,4,0)
660^8.6^1
"^DD",660,660,107,5,5,0)
660^10^2
"^DD",660,660,107,21,0)
^^1^1^3050713^
"^DD",660,660,107,21,1,0)
Flag for ready to process PFSS Charge message. 1 = Ready to process
"^DD",660,660,107,"DT")
3050713
"^DD",665,665,19.3,0)
HOME OXYGEN PRESCRIPTION^665.193DA^^RMPOB;0
"^DD",665,665,19.3,21,0)
^.001^2^2^3051219^^^^
"^DD",665,665,19.3,21,1,0)
Contains data specific to this prescription such as the dates, items,
"^DD",665,665,19.3,21,2,0)
services, vendors, quantity, cost, etc.
"^DD",665,665,19.3,"DT")
2981109
"^DD",665,665,19.4,0)
HOME OXYGEN ITEM^665.194IP^^RMPOC;0^^^
"^DD",665,665,19.4,"DT")
2981109
"^DD",665,665.193,0)
HOME OXYGEN PRESCRIPTION SUB-FIELD^^101^38
"^DD",665,665.193,0,"NM","HOME OXYGEN PRESCRIPTION")

"^DD",665,665.193,.01,0)
DATE^D^^0;1^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",665,665.193,.01,1,0)
^.1
"^DD",665,665.193,.01,1,1,0)
665.193^B
"^DD",665,665.193,.01,1,1,1)
S ^RMPR(665,DA(1),"RMPOB","B",$E(X,1,30),DA)=""
"^DD",665,665.193,.01,1,1,2)
K ^RMPR(665,DA(1),"RMPOB","B",$E(X,1,30),DA)
"^DD",665,665.193,.01,1,2,0)
665.193^APTASK^MUMPS
"^DD",665,665.193,.01,1,2,1)
Q
"^DD",665,665.193,.01,1,2,2)
D ACCTTASK^RMPOPF
"^DD",665,665.193,.01,1,2,"DT")
3050726
"^DD",665,665.193,.01,1,3,0)
^^TRIGGER^665.193^100
"^DD",665,665.193,.01,1,3,1)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(1)=$S($D(^RMPR(665,D0,"RMPOB",D1,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,1),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(665.193,.01,1,3,1.4)
"^DD",665,665.193,.01,1,3,1.4)
S DIH=$G(^RMPR(665,DIV(0),"RMPOB",DIV(1),"PFSS")),DIV=X S $P(^("PFSS"),U,1)=DIV,DIH=665.193,DIG=100 D ^DICR
"^DD",665,665.193,.01,1,3,2)
Q
"^DD",665,665.193,.01,1,3,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",665,665.193,.01,1,3,"DELETE VALUE")
NO EFFECT
"^DD",665,665.193,.01,1,3,"DT")
3051028
"^DD",665,665.193,.01,1,3,"FIELD")
PFSS NEW PRESCRIPTION FLAG
"^DD",665,665.193,.01,3)
Enter the date that the prescription was written or received.
"^DD",665,665.193,.01,21,0)
^.001^1^1^3051025^^^
"^DD",665,665.193,.01,21,1,0)
Enter the date the prescription was written.
"^DD",665,665.193,.01,23,0)
2^.001^2^2^3051025^^^^
"^DD",665,665.193,.01,23,1,0)
This field is match to the "Days to Expiration" field in the Prosthetics
"^DD",665,665.193,.01,23,2,0)
Site Parameters file.
"^DD",665,665.193,.01,"DT")
3051028
"^DD",665,665.193,30,0)
PRIMARY ICD DIAGNOSIS CODE^P80'^ICD9(^BA1;1^Q
"^DD",665,665.193,30,3)
Enter pointer to ICD DIAGNOSIS FILE (#80)
"^DD",665,665.193,30,21,0)
^.001^1^1^3051129^^^
"^DD",665,665.193,30,21,1,0)
Primary ICD from the consult.  Associated with the prescription.
"^DD",665,665.193,30,"DT")
3051129
"^DD",665,665.193,30.1,0)
PRIMARY AGENT ORANGE^S^0:NO;1:YES;^BA1;2^Q
"^DD",665,665.193,30.1,3)
Enter 'Y'es if Primary diagnosis is related to Agent Orange exposure.
"^DD",665,665.193,30.1,21,0)
^^1^1^3051129^^
"^DD",665,665.193,30.1,21,1,0)
Primary diagnosis is related to Agent Orange exposure.
"^DD",665,665.193,30.1,"DT")
3051129
"^DD",665,665.193,30.2,0)
PRIMARY IONIZED RADIATION^S^0:NO;1:YES;^BA1;3^Q
"^DD",665,665.193,30.2,3)
Enter 'Y'es if primary diagnosis is related to Ionized Radiation exposure.
"^DD",665,665.193,30.2,21,0)
^^1^1^3051129^^
"^DD",665,665.193,30.2,21,1,0)
Primary diagnosis is related to Ionized Radiation exposure.
"^DD",665,665.193,30.2,"DT")
3051129
"^DD",665,665.193,30.3,0)
PRIMARY SERVICE CONNECTED^S^0:NO;1:YES;^BA1;4^Q
"^DD",665,665.193,30.3,3)
Enter 'Y'es if primary diagnosis is related to a Service Connected condition.
"^DD",665,665.193,30.3,21,0)
^^1^1^3051129^
"^DD",665,665.193,30.3,21,1,0)
Primary diagnosis is related to a Service Connected condition.
"^DD",665,665.193,30.3,"DT")
3051129
"^DD",665,665.193,30.4,0)
PRIMARY ENVIRONMENTAL CONT.^S^0:NO;1:YES;^BA1;5^Q
"^DD",665,665.193,30.4,3)
Enter 'Y'es if primary diagnosis is related to Environmental Contaminants exposure.
"^DD",665,665.193,30.4,21,0)
^^1^1^3051129^
"^DD",665,665.193,30.4,21,1,0)
Primary diagnosis is related to Environmental Contaminants exposure.
"^DD",665,665.193,30.4,"DT")
3051129
"^DD",665,665.193,30.5,0)
PRIMARY MST^S^0:NO;1:YES;^BA1;6^Q
"^DD",665,665.193,30.5,3)
Enter 'Y'es if primary diagnosis is related to Military Sexual Trauma.
"^DD",665,665.193,30.5,21,0)
^^1^1^3051129^
"^DD",665,665.193,30.5,21,1,0)
Primary diagnosis is related to Military Sexual Trauma.
"^DD",665,665.193,30.5,"DT")
3051129
"^DD",665,665.193,30.6,0)
PRIMARY HEAD/NECK CANCER^S^0:NO;1:YES;^BA1;7^Q
"^DD",665,665.193,30.6,3)
Enter 'Y'es if primary diagnosis is related to Head/Neck Cancer.
"^DD",665,665.193,30.6,21,0)
^^1^1^3051129^
"^DD",665,665.193,30.6,21,1,0)
Primary diagnosis is related to Head/Neck Cancer.
"^DD",665,665.193,30.6,"DT")
3051129
"^DD",665,665.193,30.7,0)
PRIMARY COMBAT VET^S^0:NO;1:YES;^BA1;8^Q
"^DD",665,665.193,30.7,3)
Enter 'Y'es if primary diagnosis is related to Combat.
"^DD",665,665.193,30.7,21,0)
^^1^1^3051129^
"^DD",665,665.193,30.7,21,1,0)
Primary diagnosis is related to Combat.
"^DD",665,665.193,30.7,"DT")
3051129
"^DD",665,665.193,31,0)
SECONDARY ICD DIAGNOSIS CODE 1^P80'^ICD9(^BA2;1^Q
"^DD",665,665.193,31,3)
Enter the pointer to the ICD Diagnosis file (#80) for the Secondary Diagnosis code 1.
"^DD",665,665.193,31,21,0)
^.001^1^1^3051129^^^
"^DD",665,665.193,31,21,1,0)
A secondary ICD from the consult. Associated with the prescription.
"^DD",665,665.193,31,"DT")
3051129
"^DD",665,665.193,31.1,0)
SECONDARY AGENT ORANGE 1^S^0:NO;1:YES;^BA2;2^Q
"^DD",665,665.193,31.1,3)
Enter 'Y'es if Secondary diagnosis 1 is related to Agent Orange exposure.
"^DD",665,665.193,31.1,21,0)
^.001^1^1^3051129^^^
"^DD",665,665.193,31.1,21,1,0)
A secondary agent orange from the consult.
"^DD",665,665.193,31.1,"DT")
3051129
"^DD",665,665.193,31.2,0)
SECONDARY IONIZED RADIATION 1^S^0:NO;1:YES;^BA2;3^Q
"^DD",665,665.193,31.2,3)
Enter 'Y'es if Secondary diagnosis 1 is related to Ionized Radiation exposure.
"^DD",665,665.193,31.2,21,0)
^^1^1^3051129^
"^DD",665,665.193,31.2,21,1,0)
Secondary diagnosis 1 is related to Ionized Radiation exposure.
"^DD",665,665.193,31.2,"DT")
3051129
"^DD",665,665.193,31.3,0)
SECONDARY SERVICE CONNECTED 1^S^0:NO;1:YES;^BA2;4^Q
"^DD",665,665.193,31.3,3)
Enter 'Y'es if Secondary diagnosis 1 is related to a Service Connected condition.
"^DD",665,665.193,31.3,21,0)
^.001^1^1^3051213^^
"^DD",665,665.193,31.3,21,1,0)
Secondary diagnosis 1 is related to a Service Connected condition.
"^DD",665,665.193,31.3,"DT")
3051129
"^DD",665,665.193,31.4,0)
SECONDARY ENVIRONMENTAL CONT 1^S^0:NO;1:YES;^BA2;5^Q
"^DD",665,665.193,31.4,3)
Enter 'Y'es if Secondary diagnosis 1 is related to Environmental Contaminants exposure.
"^DD",665,665.193,31.4,21,0)
^.001^1^1^3051216^^
"^DD",665,665.193,31.4,21,1,0)
Secondary diagnosis 1 is related to Environmental Contaminants exposure.
"^DD",665,665.193,31.4,"DT")
3050819
"^DD",665,665.193,31.5,0)
SECONDARY MST 1^S^0:NO;1:YES;^BA2;6^Q
"^DD",665,665.193,31.5,3)
Enter 'Y'es if Secondary diagnosis 1 is related to Miltary Sexual Trauma.
"^DD",665,665.193,31.5,21,0)
^.001^1^1^3051216^^
"^DD",665,665.193,31.5,21,1,0)
Secondary diagnosis 1 is related to Military Sexual Trauma.
"^DD",665,665.193,31.5,"DT")
3050819
"^DD",665,665.193,31.6,0)
SECONDARY HEAD/NECK CANCER 1^S^0:NO;1:YES;^BA2;7^Q
"^DD",665,665.193,31.6,3)
Enter 'Y'es if Secondary diagnosis 1 is related to Head/Neck Cancer.
"^DD",665,665.193,31.6,21,0)
^^1^1^3051216^
"^DD",665,665.193,31.6,21,1,0)
Secondary diagnosis 1 is related to Head/Neck Cancer.
"^DD",665,665.193,31.6,"DT")
3050819
"^DD",665,665.193,31.7,0)
SECONDARY COMBAT VET 1^S^0:NO;1:YES;^BA2;8^Q
"^DD",665,665.193,31.7,3)
Enter 'Y'es if Secondary diagnosis 1 is related to Combat.
"^DD",665,665.193,31.7,21,0)
^^1^1^3051216^
"^DD",665,665.193,31.7,21,1,0)
Secondary diagnosis 1 is related to Combat.
"^DD",665,665.193,31.7,"DT")
3050819
"^DD",665,665.193,32,0)
SECONDARY ICD DIAGNOSIS CODE 2^P80'^ICD9(^BA3;1^Q
"^DD",665,665.193,32,3)
Enter pointer to ICD Diagnosis file (#80) for Secondary diagnosis code 2.
"^DD",665,665.193,32,21,0)
^.001^1^1^3051216^^
"^DD",665,665.193,32,21,1,0)
A secondary ICD from the consult.  Associated with the prescription.
"^DD",665,665.193,32,"DT")
3050818
"^DD",665,665.193,32.1,0)
SECONDARY AGENT ORANGE 2^S^0:NO;1:YES;^BA3;2^Q
"^DD",665,665.193,32.1,3)
Enter 'Y'es if Secondary diagnosis 2 is related to Agent Orange exposure.
"^DD",665,665.193,32.1,21,0)
^^1^1^3051216^
"^DD",665,665.193,32.1,21,1,0)
Secondary diagnosis 2 is related to Agent Orange exposure.
"^DD",665,665.193,32.1,"DT")
3050819
"^DD",665,665.193,32.2,0)
SECONDARY IONIZED RADIATION 2^S^0:NO;1:YES;^BA3;3^Q
"^DD",665,665.193,32.2,3)
Enter 'Y'es if Secondary diagnosis 2 is related to Ionized Radiation exposure.
"^DD",665,665.193,32.2,21,0)
^^1^1^3051219^
"^DD",665,665.193,32.2,21,1,0)
Secondary diagnosis 2 is related to Ionized Radiation exposure.
"^DD",665,665.193,32.2,"DT")
3051219
"^DD",665,665.193,32.3,0)
SECONDARY SERVICE CONNECTED 2^S^0:NO;1:YES;^BA3;4^Q
"^DD",665,665.193,32.3,3)
Enter 'Y'es if Secondary diagnosis 2 is related to a Service Connected condition.
"^DD",665,665.193,32.3,21,0)
^^1^1^3051219^
"^DD",665,665.193,32.3,21,1,0)
Secondary diagnosis 2 is related to a Service Connected condition.
"^DD",665,665.193,32.3,"DT")
3051219
"^DD",665,665.193,32.4,0)
SECONDARY ENVIRONMENTAL CONT 2^S^0:NO;1:YES;^BA3;5^Q
"^DD",665,665.193,32.4,3)
Enter 'Y'es if Secondary diagnosis 2 is related to Environmental Contaminants exposure.
"^DD",665,665.193,32.4,21,0)
^^1^1^3051219^
"^DD",665,665.193,32.4,21,1,0)
Secondary diagnosis 2 is related to Environmental Contaminants exposure.
"^DD",665,665.193,32.4,"DT")
3051219
"^DD",665,665.193,32.5,0)
SECONDARY MST 2^S^0:NO;1:YES;^BA3;6^Q
"^DD",665,665.193,32.5,3)
Enter 'Y'es if Secondary diagnosis 2 is related to Military Sexual Trauma.
"^DD",665,665.193,32.5,21,0)
^^1^1^3051220^
"^DD",665,665.193,32.5,21,1,0)
Secondary diagnosis 2 is related to Military Sexual Trauma.
"^DD",665,665.193,32.5,"DT")
3051220
"^DD",665,665.193,32.6,0)
SECONDARY HEAD/NECK CANCER 2^S^0:NO;1:YES;^BA3;7^Q
"^DD",665,665.193,32.6,3)
Enter 'Y'es if Secondary diagnosis 2 is related to Head/Neck Cancer.
"^DD",665,665.193,32.6,21,0)
^^1^1^3051220^
"^DD",665,665.193,32.6,21,1,0)
Secondary diagnosis 2 is related to Head/Neck Cancer.
"^DD",665,665.193,32.6,"DT")
3051220
"^DD",665,665.193,32.7,0)
SECONDARY COMBAT VET 2^S^0:NO;1:YES;^BA3;8^Q
"^DD",665,665.193,32.7,3)
Enter 'Y'es if Secondary diagnosis 2 is related to Combat.
"^DD",665,665.193,32.7,21,0)
^^1^1^3051220^
"^DD",665,665.193,32.7,21,1,0)
Secondary diagnosis 2 is related to Combat.
"^DD",665,665.193,32.7,"DT")
3051220
"^DD",665,665.193,33,0)
SECONDARY ICD DIAGNOSIS CODE 3^P80'^ICD9(^BA4;1^Q
"^DD",665,665.193,33,3)
Enter an ICD Diagnosis for the secondary diagnosis code 3.
"^DD",665,665.193,33,21,0)
^^1^1^3051220^^
"^DD",665,665.193,33,21,1,0)
A secondary ICD from the consult.  Associated with the prescription.
"^DD",665,665.193,33,"DT")
3051220
"^DD",665,665.193,33.1,0)
SECONDARY AGENT ORANGE 3^S^0:NO;1:YES;^BA4;2^Q
"^DD",665,665.193,33.1,3)
Enter 'Y'es if Secondary diagnosis 3 is related to Agent Orange exposure.
"^DD",665,665.193,33.1,21,0)
^^1^1^3051220^
"^DD",665,665.193,33.1,21,1,0)
Secondary diagnosis 3 is related to Agent Orange exposure.
"^DD",665,665.193,33.1,"DT")
3051220
"^DD",665,665.193,33.2,0)
SECONDARY IONIZED RADIATION 3^S^0:NO;1:YES;^BA4;3^Q
"^DD",665,665.193,33.2,3)
Enter 'Y'es if Secondary diagnosis 3 is related to Ionized Radiation exposure.
"^DD",665,665.193,33.2,21,0)
^^1^1^3051220^
"^DD",665,665.193,33.2,21,1,0)
Secondary diagnosis 3 is related to Ionized Radiation exposure.
"^DD",665,665.193,33.2,"DT")
3051220
"^DD",665,665.193,33.3,0)
SECONDARY SERVICE CONNECTED 3^S^0:NO;1:YES;^BA4;4^Q
"^DD",665,665.193,33.3,3)
Enter 'Y'es if Secondary diagnosis 3 is related to a Service Connected condition.
"^DD",665,665.193,33.3,21,0)
^^1^1^3051220^
"^DD",665,665.193,33.3,21,1,0)
Secondary diagnosis 3 is related to a Service Connected condition.
"^DD",665,665.193,33.3,"DT")
3051220
"^DD",665,665.193,33.4,0)
SECONDARY ENVIRONMENTAL CONT 3^S^0:NO;1:YES;^BA4;5^Q
"^DD",665,665.193,33.4,3)
Enter 'Y'es if Secondary diagnosis 3 is related to Environmental Contaminants exposure.
"^DD",665,665.193,33.4,21,0)
^^1^1^3051220^
"^DD",665,665.193,33.4,21,1,0)
Secondary diagnosis 3 is related to Environmental Contaminants exposure.
"^DD",665,665.193,33.4,"DT")
3051220
"^DD",665,665.193,33.5,0)
SECONDARY MST 3^S^0:NO;1:YES;^BA4;6^Q
"^DD",665,665.193,33.5,3)
Enter 'Y'es if Secondary diagnosis 3 is related to Military Sexual Trauma.
"^DD",665,665.193,33.5,21,0)
^^1^1^3051220^
"^DD",665,665.193,33.5,21,1,0)
Secondary diagnosis 3 is related to Military Sexual Trauma.
"^DD",665,665.193,33.5,"DT")
3051220
"^DD",665,665.193,33.6,0)
SECONDARY HEAD/NECK CANCER 3^S^0:NO;1:YES;^BA4;7^Q
"^DD",665,665.193,33.6,3)
Enter 'Y'es if Secondary diagnosis 3 is related to Head/Neck Cancer.
"^DD",665,665.193,33.6,21,0)
^^1^1^3051220^
"^DD",665,665.193,33.6,21,1,0)
Secondary diagnosis 3 is related to Head/Neck Cancer.
"^DD",665,665.193,33.6,"DT")
3051220
"^DD",665,665.193,33.7,0)
SECONDARY COMBAT VET 3^S^0:NO;1:YES;^BA4;8^Q
"^DD",665,665.193,33.7,3)
Enter 'Y'es if Secondary diagnosis 3 is related to Combat.
"^DD",665,665.193,33.7,21,0)
^^1^1^3051220^
"^DD",665,665.193,33.7,21,1,0)
Secondary diagnosis 3 is related to Combat.
"^DD",665,665.193,33.7,"DT")
3051220
"^DD",665,665.193,100,0)
PFSS NEW PRESCRIPTION FLAG^SX^1:READY TO PROCESS;^PFSS;1^Q
"^DD",665,665.193,100,1,0)
^.1
"^DD",665,665.193,100,1,1,0)
665^APNEW
"^DD",665,665.193,100,1,1,1)
S ^RMPR(665,"APNEW",$E(X,1,30),DA(1),DA)=""
"^DD",665,665.193,100,1,1,2)
K ^RMPR(665,"APNEW",$E(X,1,30),DA(1),DA)
"^DD",665,665.193,100,1,1,"DT")
3050726
"^DD",665,665.193,100,3)
Enter "1" if this is a new prescription ready for PFSS processing.
"^DD",665,665.193,100,5,1,0)
665.193^.01^3
"^DD",665,665.193,100,21,0)
^.001^2^2^3051220^^^
"^DD",665,665.193,100,21,1,0)
This flag indicates that a new Home Oxygen prescription has been entered 
"^DD",665,665.193,100,21,2,0)
and that pre-certification processing for this patient should begin.
"^DD",665,665.193,100,"DT")
3051220
"^DD",665,665.193,101,0)
REQUESTOR^P200'I^VA(200,^PFSS;2^Q
"^DD",665,665.193,101,3)
Enter the person that initiated the consult for this prescription.
"^DD",665,665.193,101,21,0)
^^2^2^3051220^^
"^DD",665,665.193,101,21,1,0)
Person that performed the initial consult request. Pointer to file #200.  
"^DD",665,665.193,101,21,2,0)
Associated with the prescription.
"^DD",665,665.193,101,"DT")
3051220
"^DD",665,665.194,0)
HOME OXYGEN ITEM SUB-FIELD^^101^15
"^DD",665,665.194,0,"NM","HOME OXYGEN ITEM")

"^DD",665,665.194,.01,0)
ITEM^MRP661'O^RMPR(661,^0;1^Q
"^DD",665,665.194,.01,1,0)
^.1
"^DD",665,665.194,.01,1,1,0)
665.194^B
"^DD",665,665.194,.01,1,1,1)
S ^RMPR(665,DA(1),"RMPOC","B",$E(X,1,30),DA)=""
"^DD",665,665.194,.01,1,1,2)
K ^RMPR(665,DA(1),"RMPOC","B",$E(X,1,30),DA)
"^DD",665,665.194,.01,1,2,0)
665.194^APTASK^MUMPS
"^DD",665,665.194,.01,1,2,1)
Q
"^DD",665,665.194,.01,1,2,2)
D ITEMTASK^RMPOPF
"^DD",665,665.194,.01,1,2,"DT")
3050818
"^DD",665,665.194,.01,1,3,0)
^^TRIGGER^665.194^100
"^DD",665,665.194,.01,1,3,1)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(1)=$S($D(^RMPR(665,D0,"RMPOC",D1,"PFSS")):^("PFSS"),1:"") S X=$P(Y(1),U,1),X=X S DIU=X K Y S X=DIV S X=$S(+$$SWSTAT^IBBAPI():1,1:"") X ^DD(665.194,.01,1,3,1.4)
"^DD",665,665.194,.01,1,3,1.4)
S DIH=$G(^RMPR(665,DIV(0),"RMPOC",DIV(1),"PFSS")),DIV=X S $P(^("PFSS"),U,1)=DIV,DIH=665.194,DIG=100 D ^DICR
"^DD",665,665.194,.01,1,3,2)
Q
"^DD",665,665.194,.01,1,3,"CREATE VALUE")
S X=$S(+$$SWSTAT^IBBAPI():1,1:"")
"^DD",665,665.194,.01,1,3,"DELETE VALUE")
NO EFFECT
"^DD",665,665.194,.01,1,3,"DT")
3051028
"^DD",665,665.194,.01,1,3,"FIELD")
PFSS ACCOUNT FLAG
"^DD",665,665.194,.01,2)
S Y(0)=Y S Y=$P(^RMPR(661,Y,0),U),Y=$P(^PRC(441,Y,0),U,2)
"^DD",665,665.194,.01,2.1)
S Y=$P(^RMPR(661,Y,0),U),Y=$P(^PRC(441,Y,0),U,2)
"^DD",665,665.194,.01,3)
Enter the equipment item. Enter 'primary' item first.
"^DD",665,665.194,.01,4)

"^DD",665,665.194,.01,21,0)
^^3^3^2980615^^^^
"^DD",665,665.194,.01,21,1,0)
This is a multiple field and will contain all the items dispensed
"^DD",665,665.194,.01,21,2,0)
to the patient. NOTE: The first entry must be the primary equipment
"^DD",665,665.194,.01,21,3,0)
item.
"^DD",665,665.194,.01,"DEL",.01,0)
I 1 W "USE DELETE OPTION!"
"^DD",665,665.194,.01,"DT")
3051028
"^DD",665,665.194,100,0)
PFSS ACCOUNT FLAG^S^1:READY TO PROCESS;^PFSS;1^Q
"^DD",665,665.194,100,1,0)
^.1
"^DD",665,665.194,100,1,1,0)
665^APO
"^DD",665,665.194,100,1,1,1)
S ^RMPR(665,"APO",$E(X,1,30),DA(1),DA)=""
"^DD",665,665.194,100,1,1,2)
K ^RMPR(665,"APO",$E(X,1,30),DA(1),DA)
"^DD",665,665.194,100,1,1,"%D",0)
^^1^1^3050726^
"^DD",665,665.194,100,1,1,"%D",1,0)
Regular file wide cross reference in support of PFSS IBB interface.
"^DD",665,665.194,100,1,1,"DT")
3050726
"^DD",665,665.194,100,3)
Enter "1" if this record is ready to process PFSS data.
"^DD",665,665.194,100,5,1,0)
665.194^.01^3
"^DD",665,665.194,100,21,0)
^^1^1^3051220^^
"^DD",665,665.194,100,21,1,0)
Flag field that indicates this record is ready for PFSS Processing.
"^DD",665,665.194,100,"DT")
3051220
"^DD",665,665.194,101,0)
PFSS ACCOUNT REFERENCE^P375'^IBBAA(375,^PFSS;2^Q
"^DD",665,665.194,101,3)
Enter the PFSS ACCOUNT REFERENCE returned by the PFSS process.
"^DD",665,665.194,101,21,0)
^^2^2^3051220^^
"^DD",665,665.194,101,21,1,0)
The account reference number passed back to Prosthetics from the get 
"^DD",665,665.194,101,21,2,0)
account ID process.  It is associated with the item.
"^DD",665,665.194,101,"DT")
3051220
"^DD",665.72,665.72319,1,0)
ITEM^665.723191P^^1;0
"^DD",665.72,665.72319,1,21,0)
^^2^2^2990223^^^^
"^DD",665.72,665.72319,1,21,1,0)
This is a multiple field consisting of items for a patient in a billing  
"^DD",665.72,665.72319,1,21,2,0)
month.
"^DD",665.72,665.723191,0)
ITEM SUB-FIELD^^102^22
"^DD",665.72,665.723191,0,"NM","ITEM")

"^DD",665.72,665.723191,.01,0)
ITEM^MRP661'^RMPR(661,^0;1^Q
"^DD",665.72,665.723191,.01,1,0)
^.1
"^DD",665.72,665.723191,.01,1,1,0)
665.723191^B
"^DD",665.72,665.723191,.01,1,1,1)
S ^RMPO(665.72,DA(4),1,DA(3),1,DA(2),"V",DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",665.72,665.723191,.01,1,1,2)
K ^RMPO(665.72,DA(4),1,DA(3),1,DA(2),"V",DA(1),1,"B",$E(X,1,30),DA)
"^DD",665.72,665.723191,.01,1,2,0)
665.723191^APTASK^MUMPS
"^DD",665.72,665.723191,.01,1,2,1)
Q
"^DD",665.72,665.723191,.01,1,2,2)
D CHRGTASK^RMPOPF
"^DD",665.72,665.723191,.01,1,2,"DT")
3050726
"^DD",665.72,665.723191,.01,3)
Enter the item that the patient has received from the Vendor.
"^DD",665.72,665.723191,.01,21,0)
^^3^3^2990114^^^^
"^DD",665.72,665.723191,.01,21,1,0)
Vendors supply billable items to patients and bill the VAMC for rentals of
"^DD",665.72,665.723191,.01,21,2,0)
equipment and supplies. This field is a pointer to the master item list
"^DD",665.72,665.723191,.01,21,3,0)
of possible items.
"^DD",665.72,665.723191,.01,23,0)
^^1^1^2990114^^
"^DD",665.72,665.723191,.01,23,1,0)
This field is a pointer to PROS ITEM MASTER FILE (#661).
"^DD",665.72,665.723191,.01,"DEL",.01,0)
I 1 W "USE DELETE OPTION!"
"^DD",665.72,665.723191,.01,"DT")
3050726
"^DD",665.72,665.723191,100,0)
PFSS ACCOUNT REFERENCE^P375'I^IBBAA(375,^PFSS;1^Q
"^DD",665.72,665.723191,100,3)
Enter the PFSS Account Reference number for this item.
"^DD",665.72,665.723191,100,21,0)
^^2^2^3051220^^
"^DD",665.72,665.723191,100,21,1,0)
This is the account reference number associated with the prescription for 
"^DD",665.72,665.723191,100,21,2,0)
this item.
"^DD",665.72,665.723191,100,"DT")
3051220
"^DD",665.72,665.723191,101,0)
PFSS UNIQUE CHARGE ID^NJ8,0I^^PFSS;2^K:+X'=X!(X>99999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",665.72,665.723191,101,3)
Type a Number between 1 and 99999999, 0 Decimal Digits
"^DD",665.72,665.723191,101,21,0)
^^1^1^3051220^^
"^DD",665.72,665.723191,101,21,1,0)
This is the unique charge ID associated with this item.
"^DD",665.72,665.723191,101,"DT")
3051220
"^DD",665.72,665.723191,102,0)
REQUESTOR^P200'I^VA(200,^PFSS;3^Q
"^DD",665.72,665.723191,102,3)
Enter the person that initiated the consult for this item's prescription.
"^DD",665.72,665.723191,102,21,0)
^^1^1^3051220^^
"^DD",665.72,665.723191,102,21,1,0)
This is the person that made the consult request for this item.
"^DD",665.72,665.723191,102,"DT")
3051220
"BLD",6029,6)
^97
**END**
**END**
