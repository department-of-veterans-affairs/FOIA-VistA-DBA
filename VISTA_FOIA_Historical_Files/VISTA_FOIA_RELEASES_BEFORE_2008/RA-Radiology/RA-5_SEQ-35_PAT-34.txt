$TXT Created by MO,SELINA at DEV.DEV.FO-HINES.MED.VA.GOV  (KIDS) on Thursday, 04/17/03 at 11:44
=============================================================================
Run Date: MAY 22, 2003                     Designation: RA*5*34
Package : RA - RADIOLOGY/NUCLEAR MEDICINE     Priority: Mandatory
Version : 5        SEQ #35                      Status: Released
                  Compliance Date: JUN 22, 2003
=============================================================================

Associated patches: (v)RA*5*19     <<= must be installed BEFORE `RA*5*34'
                    (v)RA*5*27     <<= must be installed BEFORE `RA*5*34'
                    (v)RA*5*31     <<= must be installed BEFORE `RA*5*34'
                    (v)RA*5*35     <<= must be installed BEFORE `RA*5*34'

Subject: PROCEDURE UPDATES AND MISC. FIXES

Category: 
  - Routine
  - Input Template
  - Data Dictionary

Description: 
============

 This patch includes corrections to various problems reported via the NOIS 
 and E3R systems.
  
 There is a post installation routine, RA34PST, which will be tasked off 
 automatically to check file 71, RAD/NUC MED PROCEDURES.  It will make 
 sure that the procedure names in this file do not contain a ";" by
 replacing any ";" with ",".  This check relates to item 4 below.
  
 1.  Routines RAPURGE and RAPURGE1 have been changed to enhance the data
     purge function.  The 'Purge Data Function' [RA PURGE] option will
     allow the user to choose which record types to purge: exam, report,
     order, both exams and reports, all three.  It will also increase the
     cut-off days from 4 digits (27 years) to 5 digits (273 years).
  
     Routines RARECOV and RARESTOR have been added to allow IRM to
     recover data from a backup volume and to restore the recovered
     data into the exam/report globals in production.  There are no
     options assigned to these routines.  The instructions for
     recovering purged data are displayed when routine RARECOV is
     run.
  
     Previously, the 'Purge Data Function' [RA PURGE] option did not
     give a choice of record types to purge; it would purge all record
     types.  Also, it could not retain data for more than 9999 days.
  
     NOIS: LAH-1101-62122 
     E3R:  14839 
  
 2.  Input templates RA ORDER EXAM and RA QUICK EXAM ORDER from file
     RAD/NUC MED ORDERS (#75.1) have been corrected to default to the
     only imaging location of a specific imaging type, regardless of the 
     value of file RAD/NUC MED DIVISION (#79)'s field ASK 'IMAGING
     LOCATION' (#.121).
  
     Previously, if the division's ASK 'IMAGING LOCATION' field is set
     to "n" or null, and there is only one imaging location with the same
     imaging type as the ordered procedure's imaging type, the above
     input templates did not put anything into file RAD/NUC MED ORDERS
     (#75.1)'s field IMAGING LOCATION (#20), so that the ordered procedure
     is displayed in the UNKNOWN section of the 'Detailed Request Display' 
     [RA ORDERDISPLAY] option.
  
     NOIS: BUT-0802-21479
  
 3.  The Field length for file DIAGNOSTIC CODES (#78.3) field DIAGNOSTIC
     CODE (#.01) has been lengthened from 40 to 60 characters.
  
     Previously, the 40 character limit for this field prevented users
     from entering longer names for local diagnostic codes.
  
     NOIS: OKL-0902-71681
     VISN Policy Memorandum No. 38
  
 4.  Routine RAUTL14 has been changed to disallow ";" from being entered
     for the field .01, NAME, in file 71, RAD/NUC MED PROCEDURES. This 
     affects the 'Procedure Enter/Edit' [RA PROCEDURE] option.  Even
     though Fileman automatically screens out "^", routine RAUTL14 has
     been changed to also disallow "^", in order to match the screening
     logic from CPRS.
  
     Previously, ";" could be included in a Radiology procedure name; 
     however, this name could not be updated in file 101.43, ORDERABLE
     ITEMS, because CPRS disallows ";".
  
     Nois: CON-1201-12094     Connecticut HCS
  
 5.  Routine RAMAINP has been changed to prevent a line of output from
     from being printed beyond the right margin.  This affects the
     'Procedure Message List' [RA PROCMSGPRINT] option.
  
     Previously, when the list from this option was sent to a printer,
     the text did not wrap to the next line when it reached the right
     margin, thus truncating all text beyond the margin.
  
     NOIS: DAY-0702-40963     Dayton, OH
  
 6.  Routine RAPRINT1 has been changed to group all cases for a printset
     to represent one alert for the same patient and exam date/time.
     This affects the 'Abnormal Exam Report' [RA ABNORMAL] option.
  
     Previously, all cases of a printset were printed separately for
     the same patient and exam date/time.  This made one abnormal
     alert appeared to be several alerts.
  
     E3R: 17373                Houston, TX
  
 7.  Routines RART1, RARTE, and RAUTL11 have been changed to prevent
     "|" from causing an error during text editing of reports.  This 
     affects the following options:
  
           'Report Entry/Edit' [RA RPTENTRY] 
           'Display a Rad/Nuc Med Report' [RA RPTDISP]
  
     Previously, if the report text or tech comment contained a "|", the
     session would abnormally end with one of the following errors:
       TRY^DICOMPX:1
       SS1+2^RARTE:1
  
     NOIS: OKL-0999-71259      Oklahoma City, OK
           SAJ-1102-71391      San Juan, Puerto Rico
           CHS-0802-42406      Chicago, IL
  
 8.  The edit template RA OUTSIDE EDIT for file #70, RAD NUC/MED PATIENT, 
     has been changed to allow lower case "y".  This affects the 'Edit
     Registry' [RA OUTEDIT] option.
  
     Previously, the use of this option would not accept "y" to mean "YES" 
     for the following prompt:
       Do you want to specify a 'RETURNED DATE' even though...
                                    ...patient is an inpatient? No//
  
     NOIS: BIG-0302-71255       Big Springs, TX
  
 9.  Routine RAUTL20 was changed to allow "+" and "." to be displayed for a
     group of cases that share the same report (printset), even when one of
     the cases has been cancelled and had no report.
  
     Previously, if one of the cases of a printset was cancelled, and later
     a report was entered for the remaining cases of the printset, and this
     report did not include the cancelled case, the "+" and "." disappeared
     from the display of cases from various view and edit options.
  
     No NOIS,                   OIFO, Silver Springs, MD
  
 10. Routines RAEDCN and RASTREQ1 were changed to correctly warn of 
     cancelling exams with images.
     
     Routine RAEDCN was changed to add another question, if the exam to be
     cancelled is associated with an image:
  
                     ----------------------------------
                     DOE,JOHN's Case No. 020730-1519
                     This exam has associated images.
                     ----------------------------------
  
           Do you really want to cancel this exam with images? NO//
  
     It was also changed to check if the user has the "RA MGR" key.
     If the user does not have this key, then the following messages will 
     be displayed:
  
    ** You do not have the  RA MGR  key to cancel an exam with images. **
  
           Press RETURN to continue.
  
  
     Routine RASTREQ1 was changed to NOT display "A report has been filed 
     for this case.  Therefore cancellation is not allowed." when an exam
     with images (but no real report) was actually cancelled.
       
  
     Previously, when the 'Cancel an Exam' [RA CANCEL] was used, the option
     allowed exams with images (but no real report) to be cancelled; 
     however, it displayed the "A report has been filed for this case.  
     Therefore cancellation is not allowed."  Also, the option did not warn
     the user that the selected exam has images associated, even though
     there was no real report.
  
     NOIS: FGH-0103-31387       North Florida/South Georgia
  
  
 ---------------
 Data Dictionary
 ---------------
 (Item 1 above)
     File IMAGING TYPE (#79.2) 
                Field Name           Field Number
            ACTIVITY LOG CUT-OFF         .11
            REPORT CUT-OFF               .12
            CLINICAL HISTORY CUT-OFF     .13
            TRACKING TIME CUT-OFF        .14
            ORDER DATA CUT-OFF           .16
  
     The above fields' numeric length has been increased from 4 to 5
     digits.
  
  
 (Item 3 above)
     File DIAGNOSTIC CODES (#78.3)
                Field Name           Field Number
            DIAGNOSTIC CODE              .01
  
     The above field's text length has been increased from 40 to 60
     characters.
  
 (Item 4 above)
      File RAD/NUC MED PROCEDURES (#71)
                Field Name           Field Number
                  NAME                   .01
  
      The Help-Prompt and Description for this field has been changed
      to display 'Also, ";" and "^" are not allowed as characters.'
  
 ---------------
 Input Templates
 ---------------
 (Item 2 above)
    The following input templates have been corrected to use the only
    imaging location of a specific type of imaging as the default
    imaging location for an order, even if the division's ASK 'IMAGING
    LOCATION' parameter is "n" or null.
  
     File RAD/NUC MED ORDERS (#75.1) 
      Input Template Name:
        RA EXAM ORDER
        RA QUICK EXAM ORDER
  
 (Item 8 above)
    The following input template has been corrected to accept a lowercase
    "y" as a valid response.
  
     File RAD/NUC MED PATIENT (#70)
      Input Template Name:
        RA OUTSIDE EDIT
  
    
  
 -- Documentation --
    
      There are several documentation changes associated with this patch:
      ADPAC Guide (ra5_0ag.pdf)
      Technical Manual (ra5_0tm.pdf)
      User Manual (ra5_0um.pdf)
   
      They can be found in the following [ANONYMOUS.SOFTWARE]
      directories:
  
                                  PREFERRED ADDRESS
                                  -------------------------
     First available ftp server   download.vista.med.va.gov
  
     SPECIFIC FIELD OFFICE        FTP ADDRESS
     ---------------------        ------------------------
     Albany                       ftp.fo-albany.med.va.gov
     Hines                        ftp.fo-hines.med.va.gov
     Salt Lake City               ftp.fo-slc.med.va.gov
  
  
 -- Test Sites --
  
    1. Butler, PA
    2. Oklahoma City, OK
    3. Houston, TX
    4. Central Texas, TX 
  
 The second lines of the routines now look like:
 ;5.0;Radiology/Nuclear Medicine;**[patch number]**;Mar 16, 1998
  
                        CHECK^XTSUMBLD results
 Name          Before Patch       After Patch       Patch List
 ----------------------------------------------------------------
 RA34PST          N/A               6163668         34 
 RAEDCN        26151834            28242867         5,13,10,18,28,31,34
 RAMAINP       12382306            12405133         3,19,34
 RAPRINT1       9621066             8920500         34
 RAPURGE        8546767            13590622         34
 RAPURGE1      14760438            15354705         34
 RARECOV          N/A              16589991         34
 RARESTOR         N/A               8082680         34
 RART1         18397786            18561635         8,16,15,21,23,27,34
 RARTE         13326366            12455147         18,34   
 RASTREQ1       3208638             3425507         34
 RAUTL11       11348534            11352621         18,35,34
 RAUTL14        5339257             5712592         34
 RAUTL20       10637494            10684888         5,34
  
 INSTALLATION INSTRUCTIONS
 =========================
  The install time for this patch is less than two minutes.  Since there
  are data dictionary changes, this patch should be installed when all 
  Rad/Nuc Med users are off the system.
   
  NOTE:  MailMan and Kernel patches must be current on the target system to
         avoid problems loading and installing this patch.
   
  1. If the above routines are mapped, disable mapping for them.
  
  2. Use the 'INSTALL/CHECK MESSAGE' option of your PackMan menu to load
     the KIDS distribution onto your system.
   
  3. On the 'Kernel Installation & Distribution System' Menu (KIDS), select
     the 'Installation' menu.
   
     From this menu you may choose the following options prior to
     installing this patch:
   
      a. Backup a Transport Global - this option will create a backup
         message of any routines exported with the patch.  It will NOT
         backup any other changes such as data dictionaries or templates.
  
      b. Compare Transport Global to Current System - this option will
         allow you to view all changes that will be made when the patch is 
         installed.  It compares all components of the patch (routines,
         DDs, templates, etc.)
   
      c. Verify Checksums in Transport Global - this option will allow you
         to ensure the integrity of the routine that is in the transport
         global.
   
  4. Use the 'Install Package(s)' option under the 'Installation' menu.
        When prompted for INSTALL NAME, enter: RA*5.0*34.
   
        When prompted "Want KIDS to INHIBIT LOGONs during the install?
        YES//", respond NO.
   
        When prompted "Want to DISABLE Scheduled Options and Menu Options?
        YES//", respond YES.      
  
        When prompted "Enter options you wish to mark
        as 'Out of Order':", enter the following to disable all Rad/Nuc Med
        options:
      
           RA*
   
        When prompted "Enter protocols you wish to mark as 'Out of
        Order':", enter the following to disable all Rad/Nuc Med protocols:
   
           RA*
   
     5. Verify that the patch installation completed correctly by using the
        KIDS 'Utilities...' [XPD UTILITY] option 'Install File Print' [XPD
        PRINT INSTALL FILE] and selecting this patch (RA*5.0*34).
  
     6. On a mapped system, rebuild your map set.
  
     7. If the post installation task job finished successfully, it should 
        send a mail message "Results from routine RA34PST" to the patch
        installer, and routine RA34PST may be deleted.  Otherwise, you
        should manually run the post install routine to check all the
        procedure names in file #71, RAD/NUC MED PROCEDURES, via:
                                     
                      D MANUAL^RA34PST

Routine Information:
====================

Routine Name:
  - RAPURGE


Routine Checksum:

Routine Name:
  - RAPURGE1


Routine Checksum:

Routine Name:
  - RARECOV


Routine Checksum:

Routine Name:
  - RARESTOR


Routine Checksum:

Routine Name:
  - RA34PST


Routine Checksum:

Routine Name:
  - RAEDCN


Routine Checksum:

Routine Name:
  - RAMAINP


Routine Checksum:

Routine Name:
  - RAPRINT1


Routine Checksum:

Routine Name:
  - RART1


Routine Checksum:

Routine Name:
  - RARTE


Routine Checksum:

Routine Name:
  - RASTREQ1


Routine Checksum:

Routine Name:
  - RAUTL11


Routine Checksum:

Routine Name:
  - RAUTL14


Routine Checksum:

Routine Name:
  - RAUTL20


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : MO,SELINA                      Date Entered : DEC 26, 2001
Completed By: PATRICK,PAT                   Date Completed: MAY 16, 2003
Released By : LECLAIR,RAY                   Date Released : MAY 22, 2003
=============================================================================


Packman Mail Message:
=====================

$END TXT
