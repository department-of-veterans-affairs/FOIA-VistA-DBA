Released RG*1*21 SEQ #21
Extracted from mail message
**KIDS**:RG*1.0*21^

**INSTALL NAME**
RG*1.0*21
"BLD",1358,0)
RG*1.0*21^CLINICAL INFO RESOURCE NETWORK^0^3011108^y
"BLD",1358,1,0)
^^3^3^3011108^
"BLD",1358,1,1,0)
ADD/EDIT POINT OF CONTACT & MPI/PD HL7 DIAGNOSTIC MENU
"BLD",1358,1,2,0)
Refer to patch RG*1*21 in the FORUM Patch Module for a complete
"BLD",1358,1,3,0)
description.
"BLD",1358,4,0)
^9.64PA^991.8^1
"BLD",1358,4,991.8,0)
991.8
"BLD",1358,4,991.8,2,0)
^9.641^991.8^1
"BLD",1358,4,991.8,2,991.8,0)
CIRN SITE PARAMETER  (File-top level)
"BLD",1358,4,991.8,2,991.8,1,0)
^9.6411^55^6
"BLD",1358,4,991.8,2,991.8,1,50,0)
ADMIN POINT OF CONTACT
"BLD",1358,4,991.8,2,991.8,1,51,0)
IRM POINT OF CONTACT
"BLD",1358,4,991.8,2,991.8,1,52,0)
HL7 POINT OF CONTACT
"BLD",1358,4,991.8,2,991.8,1,53,0)
ALT ADMIN POINT OF CONTACT
"BLD",1358,4,991.8,2,991.8,1,54,0)
ALT IRM POINT OF CONTACT
"BLD",1358,4,991.8,2,991.8,1,55,0)
ALT HL7 POINT OF CONTACT
"BLD",1358,4,991.8,222)
y^n^p^^^^n
"BLD",1358,4,"APDD",991.8,991.8)

"BLD",1358,4,"APDD",991.8,991.8,50)

"BLD",1358,4,"APDD",991.8,991.8,51)

"BLD",1358,4,"APDD",991.8,991.8,52)

"BLD",1358,4,"APDD",991.8,991.8,53)

"BLD",1358,4,"APDD",991.8,991.8,54)

"BLD",1358,4,"APDD",991.8,991.8,55)

"BLD",1358,4,"B",991.8,991.8)

"BLD",1358,"ABNS",0)
^9.66A^^
"BLD",1358,"ABPKG")
^^
"BLD",1358,"KRN",0)
^9.67PA^19^17
"BLD",1358,"KRN",.4,0)
.4
"BLD",1358,"KRN",.401,0)
.401
"BLD",1358,"KRN",.402,0)
.402
"BLD",1358,"KRN",.403,0)
.403
"BLD",1358,"KRN",.5,0)
.5
"BLD",1358,"KRN",.84,0)
.84
"BLD",1358,"KRN",3.6,0)
3.6
"BLD",1358,"KRN",3.8,0)
3.8
"BLD",1358,"KRN",9.2,0)
9.2
"BLD",1358,"KRN",9.8,0)
9.8
"BLD",1358,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",1358,"KRN",9.8,"NM",1,0)
RGPOC^^0^B35170559
"BLD",1358,"KRN",9.8,"NM",2,0)
RGMTHL2^^0^B26930868
"BLD",1358,"KRN",9.8,"NM",3,0)
RGMTHLDB^^0^B35168043
"BLD",1358,"KRN",9.8,"NM",4,0)
RGMTHLDP^^0^B34124264
"BLD",1358,"KRN",9.8,"NM",5,0)
RGMTHLP^^0^B17520048
"BLD",1358,"KRN",9.8,"NM",6,0)
RGMTHLPD^^0^B27315485
"BLD",1358,"KRN",9.8,"NM",7,0)
RGPOC1^^0^B28161535
"BLD",1358,"KRN",9.8,"NM","B","RGMTHL2",2)

"BLD",1358,"KRN",9.8,"NM","B","RGMTHLDB",3)

"BLD",1358,"KRN",9.8,"NM","B","RGMTHLDP",4)

"BLD",1358,"KRN",9.8,"NM","B","RGMTHLP",5)

"BLD",1358,"KRN",9.8,"NM","B","RGMTHLPD",6)

"BLD",1358,"KRN",9.8,"NM","B","RGPOC",1)

"BLD",1358,"KRN",9.8,"NM","B","RGPOC1",7)

"BLD",1358,"KRN",19,0)
19
"BLD",1358,"KRN",19,"NM",0)
^9.68A^7^7
"BLD",1358,"KRN",19,"NM",1,0)
RG UPDATE POINT OF CONTACT^^0
"BLD",1358,"KRN",19,"NM",2,0)
RG ADMIN COORD MENU^^2
"BLD",1358,"KRN",19,"NM",3,0)
RGMT DIAG MGR^^0
"BLD",1358,"KRN",19,"NM",4,0)
RGMT DIAG COMPILE HL7 DATA^^0
"BLD",1358,"KRN",19,"NM",5,0)
RGMT DIAG STATUS REPORT^^0
"BLD",1358,"KRN",19,"NM",6,0)
RGMT DIAG SINGLE PROTOCOL^^0
"BLD",1358,"KRN",19,"NM",7,0)
RGMT DIAG ALL PROTOCOLS^^0
"BLD",1358,"KRN",19,"NM","B","RG ADMIN COORD MENU",2)

"BLD",1358,"KRN",19,"NM","B","RG UPDATE POINT OF CONTACT",1)

"BLD",1358,"KRN",19,"NM","B","RGMT DIAG ALL PROTOCOLS",7)

"BLD",1358,"KRN",19,"NM","B","RGMT DIAG COMPILE HL7 DATA",4)

"BLD",1358,"KRN",19,"NM","B","RGMT DIAG MGR",3)

"BLD",1358,"KRN",19,"NM","B","RGMT DIAG SINGLE PROTOCOL",6)

"BLD",1358,"KRN",19,"NM","B","RGMT DIAG STATUS REPORT",5)

"BLD",1358,"KRN",19.1,0)
19.1
"BLD",1358,"KRN",101,0)
101
"BLD",1358,"KRN",409.61,0)
409.61
"BLD",1358,"KRN",771,0)
771
"BLD",1358,"KRN",870,0)
870
"BLD",1358,"KRN",8994,0)
8994
"BLD",1358,"KRN","B",.4,.4)

"BLD",1358,"KRN","B",.401,.401)

"BLD",1358,"KRN","B",.402,.402)

"BLD",1358,"KRN","B",.403,.403)

"BLD",1358,"KRN","B",.5,.5)

"BLD",1358,"KRN","B",.84,.84)

"BLD",1358,"KRN","B",3.6,3.6)

"BLD",1358,"KRN","B",3.8,3.8)

"BLD",1358,"KRN","B",9.2,9.2)

"BLD",1358,"KRN","B",9.8,9.8)

"BLD",1358,"KRN","B",19,19)

"BLD",1358,"KRN","B",19.1,19.1)

"BLD",1358,"KRN","B",101,101)

"BLD",1358,"KRN","B",409.61,409.61)

"BLD",1358,"KRN","B",771,771)

"BLD",1358,"KRN","B",870,870)

"BLD",1358,"KRN","B",8994,8994)

"BLD",1358,"QUES",0)
^9.62^^
"BLD",1358,"REQB",0)
^9.611^1^1
"BLD",1358,"REQB",1,0)
RG*1.0*19^2
"BLD",1358,"REQB","B","RG*1.0*19",1)

"FIA",991.8)
CIRN SITE PARAMETER
"FIA",991.8,0)
^RGSITE(991.8,
"FIA",991.8,0,0)
991.8
"FIA",991.8,0,1)
y^n^p^^^^n
"FIA",991.8,0,10)

"FIA",991.8,0,11)

"FIA",991.8,0,"RLRO")

"FIA",991.8,0,"VR")
1.0^RG
"FIA",991.8,991.8)
1
"FIA",991.8,991.8,50)

"FIA",991.8,991.8,51)

"FIA",991.8,991.8,52)

"FIA",991.8,991.8,53)

"FIA",991.8,991.8,54)

"FIA",991.8,991.8,55)

"KRN",19,5663,-1)
2^2
"KRN",19,5663,0)
RG ADMIN COORD MENU^MPI/PD Patient Admin Coordinator Menu^^M^^^^^^^^272^^^
"KRN",19,5663,10,0)
^19.01IP^41^8
"KRN",19,5663,10,41,0)
6747^POC^80
"KRN",19,5663,10,41,"^")
RG UPDATE POINT OF CONTACT
"KRN",19,5663,"U")
MPI/PD PATIENT ADMIN COORDINAT
"KRN",19,5785,-1)
0^3
"KRN",19,5785,0)
RGMT DIAG MGR^MPI/PD HL7 Diagnostic Menu^^M^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",19,5785,1,0)
^19.06^2^2^3011004^^^^
"KRN",19,5785,1,1,0)
This menu contains a diagnostic tool and reports to assist with problem
"KRN",19,5785,1,2,0)
resolution for MPI/PD HL7 messaging.
"KRN",19,5785,10,0)
^19.01IP^4^4
"KRN",19,5785,10,1,0)
5786^CMP^10
"KRN",19,5785,10,1,"^")
RGMT DIAG COMPILE HL7 DATA
"KRN",19,5785,10,2,0)
5787^RPT^20
"KRN",19,5785,10,2,"^")
RGMT DIAG STATUS REPORT
"KRN",19,5785,10,3,0)
5788^SNG^30
"KRN",19,5785,10,3,"^")
RGMT DIAG SINGLE PROTOCOL
"KRN",19,5785,10,4,0)
5789^ALL^40
"KRN",19,5785,10,4,"^")
RGMT DIAG ALL PROTOCOLS
"KRN",19,5785,99)
58716,55203
"KRN",19,5785,"U")
MPI/PD HL7 DIAGNOSTIC MENU
"KRN",19,5786,-1)
0^4
"KRN",19,5786,0)
RGMT DIAG COMPILE HL7 DATA^Compile MPI/PD HL7 Data^^R^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",19,5786,1,0)
^19.06^8^8^3011004^^^
"KRN",19,5786,1,1,0)
This option searches the HL7 MESSAGE ADMINISTRATION (#773) file
"KRN",19,5786,1,2,0)
for a selected date range.  For each message in the date range,
"KRN",19,5786,1,3,0)
the HL7 MESSAGE TEXT (#772) file is examined.  If the RELATED EVENT
"KRN",19,5786,1,4,0)
PROTOCOL (#10) field contains the MPI/PD protocols (e.g., "VAF" "RG"
"KRN",19,5786,1,5,0)
or "MPIF"), information is compiled into the ^XTMP("RGMT","HL" array.
"KRN",19,5786,1,6,0)
The data elements include the protocol name, date, transmission type
"KRN",19,5786,1,7,0)
(i.e., incoming or outgoing), status, and internal entry number (IEN)
"KRN",19,5786,1,8,0)
of the HL7 MESSAGE TEXT entry.
"KRN",19,5786,25)
RGMTHL2
"KRN",19,5786,"U")
COMPILE MPI/PD HL7 DATA
"KRN",19,5787,-1)
0^5
"KRN",19,5787,0)
RGMT DIAG STATUS REPORT^MPI/PD HL7 Message Status Report^^R^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",19,5787,1,0)
^19.06^17^17^3011004^^^^
"KRN",19,5787,1,1,0)
This option prints information found during the Compile MPI/PD HL7
"KRN",19,5787,1,2,0)
Data compilation.  The MPI/PD HL7 Message Status Report is generated
"KRN",19,5787,1,3,0)
from the ^XTMP("RGMT","HL" array.  The report is sorted by RELATED 
"KRN",19,5787,1,4,0)
EVENT PROTOCOL, date, transmission type, and status.
"KRN",19,5787,1,5,0)
   
"KRN",19,5787,1,6,0)
Either a detailed or summary report can be printed for a selected
"KRN",19,5787,1,7,0)
date range.  The summary report displays the total number of messages
"KRN",19,5787,1,8,0)
for each date, transmission type, and status. The right margin for this
"KRN",19,5787,1,9,0)
report is 80.
"KRN",19,5787,1,10,0)
   
"KRN",19,5787,1,11,0)
The detailed report can be printed for a single or all protocols 
"KRN",19,5787,1,12,0)
and includes information from each HL7 message.  The detailed report
"KRN",19,5787,1,13,0)
displays the related event protocol date, transmission type, status,
"KRN",19,5787,1,14,0)
message header date, date processed, internal entry number (IEN) from
"KRN",19,5787,1,15,0)
the HL7 MESSAGE TEXT (#772) file, message identification number, and
"KRN",19,5787,1,16,0)
whether or not the message has been purged.  The right margin for this
"KRN",19,5787,1,17,0)
report is 132.
"KRN",19,5787,25)
RGMTHLP
"KRN",19,5787,"U")
MPI/PD HL7 MESSAGE STATUS REPO
"KRN",19,5788,-1)
0^6
"KRN",19,5788,0)
RGMT DIAG SINGLE PROTOCOL^MPI/PD HL7 Activity by Patient/Single Protocol^^R^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",19,5788,1,0)
^19.06^10^10^3011004^^^^
"KRN",19,5788,1,1,0)
This option prints information found during the Compile MPI/PD
"KRN",19,5788,1,2,0)
HL7 Data compilation for activity related to a specific protocol.
"KRN",19,5788,1,3,0)
The ^XTMP("RGMT","HL" array is searched for a user selected
"KRN",19,5788,1,4,0)
protocol, date range, transmission type and patient.
"KRN",19,5788,1,5,0)
   
"KRN",19,5788,1,6,0)
The report prints the patient's name, protocol, date range,
"KRN",19,5788,1,7,0)
transmission type, internal entry number (IEN) from the HL7 
"KRN",19,5788,1,8,0)
MESSAGE TEXT (#772) file, the date and status.  The HL7 message
"KRN",19,5788,1,9,0)
data found in the MESSAGE TEXT field is displayed.  The right
"KRN",19,5788,1,10,0)
margin for this report is 80.
"KRN",19,5788,25)
RGMTHLDB
"KRN",19,5788,"U")
MPI/PD HL7 ACTIVITY BY PATIENT
"KRN",19,5789,-1)
0^7
"KRN",19,5789,0)
RGMT DIAG ALL PROTOCOLS^MPI/PD HL7 Activity by Patient/All Protocols^^R^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",19,5789,1,0)
^19.06^10^10^3011004^^^^
"KRN",19,5789,1,1,0)
This option prints information found during the Compile MPI/PD
"KRN",19,5789,1,2,0)
HL7 Data compilation for activity related to ALL protocols.  The
"KRN",19,5789,1,3,0)
^XTMP("RGMT","HL" array is searched for a user selected patient 
"KRN",19,5789,1,4,0)
and date range.
"KRN",19,5789,1,5,0)
   
"KRN",19,5789,1,6,0)
The report prints the patient's name, date range, protocol,
"KRN",19,5789,1,7,0)
transmission type, internal entry number (IEN) from the HL7 MESSAGE
"KRN",19,5789,1,8,0)
TEXT (#772) file, the date and status.  The HL7 message data found
"KRN",19,5789,1,9,0)
in the MESSAGE TEXT field is displayed.  The right margin for this
"KRN",19,5789,1,10,0)
report is 80.
"KRN",19,5789,25)
RGMTHLDP
"KRN",19,5789,"U")
MPI/PD HL7 ACTIVITY BY PATIENT
"KRN",19,6747,-1)
0^1
"KRN",19,6747,0)
RG UPDATE POINT OF CONTACT^Add/Edit Point of Contact^^R^^^^^^^^CLINICAL INFO RESOURCE NETWORK
"KRN",19,6747,1,0)
^19.06^7^7^3011106^^^^
"KRN",19,6747,1,1,0)
This option allows a facility to update their point of contact
"KRN",19,6747,1,2,0)
information for Master Patient Index/Patient Demographics (MPI/PD).
"KRN",19,6747,1,3,0)
Names and phone numbers can be edited for the administrative, IRM,
"KRN",19,6747,1,4,0)
HL7, and alternate contacts.  At the conclusion of the edit process,
"KRN",19,6747,1,5,0)
the information is transmitted to a remote mail group on the Austin
"KRN",19,6747,1,6,0)
MPI system.  The Data Management staff will use this information to
"KRN",19,6747,1,7,0)
update the website.
"KRN",19,6747,25)
RGPOC
"KRN",19,6747,"U")
ADD/EDIT POINT OF CONTACT
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",272,-1)
1^1
"PKG",272,0)
CLINICAL INFO RESOURCE NETWORK^RG^CIRN
"PKG",272,20,0)
^9.402P^^0
"PKG",272,22,0)
^9.49I^1^1
"PKG",272,22,1,0)
1.0^2990430^2990601^12555
"PKG",272,22,1,"PAH",1,0)
21^3011108
"PKG",272,22,1,"PAH",1,1,0)
^^3^3^3011108
"PKG",272,22,1,"PAH",1,1,1,0)
ADD/EDIT POINT OF CONTACT & MPI/PD HL7 DIAGNOSTIC MENU
"PKG",272,22,1,"PAH",1,1,2,0)
Refer to patch RG*1*21 in the FORUM Patch Module for a complete
"PKG",272,22,1,"PAH",1,1,3,0)
description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","RGMTHL2")
0^2^B26930868
"RTN","RGMTHL2",1,0)
RGMTHL2 ;BIR/CML-COMPILE MPI/PD HL7 DATA FOR BI-DIRECTIONAL TCP ;12/12/00
"RTN","RGMTHL2",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**21**;30 Apr 99
"RTN","RGMTHL2",3,0)
 ;
"RTN","RGMTHL2",4,0)
 ;Reference to ^ORD(101 supported by IA #2596
"RTN","RGMTHL2",5,0)
 ;Reference to ^HL(772 supported by IA #3464
"RTN","RGMTHL2",6,0)
 ;Reference to ^HL(771.6 supported by IA #2507
"RTN","RGMTHL2",7,0)
 ;
"RTN","RGMTHL2",8,0)
 ;Check to see if the ^XTMP global is present and/or complete
"RTN","RGMTHL2",9,0)
 W @IOF
"RTN","RGMTHL2",10,0)
 W !,"This utility searches the HL7 MESSAGE TEXT (#772) file for a selected"
"RTN","RGMTHL2",11,0)
 W !,"date range.  Each HL7 message in the date range is examined.  If the"
"RTN","RGMTHL2",12,0)
 W !,"RELATED EVENT PROTOCOL field contains the MPI/PD protocols (e.g., ""VAF"","
"RTN","RGMTHL2",13,0)
 W !,"""RG"", or ""MPI"") data is compiled into the ^XTMP(""RGMT"",""HL"" array."
"RTN","RGMTHL2",14,0)
 W !!,"A cross-reference is built on patient ICN and DFN for faster data retrieval"
"RTN","RGMTHL2",15,0)
 W !,"for the associated reports."
"RTN","RGMTHL2",16,0)
 ;
"RTN","RGMTHL2",17,0)
 G:'$D(^XTMP("RGMT","HL")) BEGIN
"RTN","RGMTHL2",18,0)
 I '$D(^XTMP("RGMT","HL","@@@@","STOPPED")) D
"RTN","RGMTHL2",19,0)
 .W !!,$C(7),"The Compile MPI/PD HL7 Data compilation is already running!" G QUIT
"RTN","RGMTHL2",20,0)
 S CDT=$$FMTE^XLFDT($E(+^XTMP("RGMT","HL","@@@@","STOPPED"),1,12))
"RTN","RGMTHL2",21,0)
 W !!,"=> ""Compile MPI/PD HL7 Data"" last ran to completion on "_CDT_".",!
"RTN","RGMTHL2",22,0)
 I $D(^XTMP("RGMT","HL","@@@@","RANGE")) D
"RTN","RGMTHL2",23,0)
 .W !,"=> Data has been compiled for ",^XTMP("RGMT","HL","@@@@","RANGE"),"."
"RTN","RGMTHL2",24,0)
 W ! K DIR S DIR(0)="SMB^D:DELETE;A:APPEND"
"RTN","RGMTHL2",25,0)
 S DIR("A",1)="Do you want to:"
"RTN","RGMTHL2",26,0)
 S DIR("A",2)="(D)elete existing data and recompile."
"RTN","RGMTHL2",27,0)
 S DIR("A")="(A)ppend new data after last date of existing data"
"RTN","RGMTHL2",28,0)
 S DIR("B")="A"
"RTN","RGMTHL2",29,0)
 S DIR("?",1)="Enter:",DIR("?",2)="D if you want to delete exiting data and recompile."
"RTN","RGMTHL2",30,0)
 S DIR("?",3)="A or <RET> to append new data after last date of existing data."
"RTN","RGMTHL2",31,0)
 S DIR("?")="""^"" to HALT."
"RTN","RGMTHL2",32,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S ACT=Y
"RTN","RGMTHL2",33,0)
 ;
"RTN","RGMTHL2",34,0)
BEGIN ;
"RTN","RGMTHL2",35,0)
 S RGNOW=$$NOW^XLFDT()
"RTN","RGMTHL2",36,0)
 S:'$D(ACT) ACT="D"
"RTN","RGMTHL2",37,0)
 W !!,"Enter date range for data to be compiled."
"RTN","RGMTHL2",38,0)
 I ACT="A" D
"RTN","RGMTHL2",39,0)
 .S X1=^XTMP("RGMT","HL","@@@@","COMPENDDATE"),X2=1 D C^%DTC
"RTN","RGMTHL2",40,0)
 .S RGBDT=X W !,"Beginning Date for Report: ",$$FMTE^XLFDT(X)
"RTN","RGMTHL2",41,0)
 I ACT="D" D  G:$D(DIRUT) QUIT
"RTN","RGMTHL2",42,0)
 .K DIR,DIRUT,DTOUT,DUOUT
"RTN","RGMTHL2",43,0)
 .S DIR(0)="DAO^:"_RGNOW_":EPXT",DIR("A")="Beginning Date for Report:  "
"RTN","RGMTHL2",44,0)
 .D ^DIR K DIR Q:$D(DIRUT)  S RGBDT=Y
"RTN","RGMTHL2",45,0)
 K DIR,DIRUT,DTOUT,DUOUT
"RTN","RGMTHL2",46,0)
 S DIR(0)="DAO^"_RGBDT_":"_RGNOW_":EPXT",DIR("A")="Ending Date for Report:  "
"RTN","RGMTHL2",47,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S RGEDT=Y
"RTN","RGMTHL2",48,0)
 ;
"RTN","RGMTHL2",49,0)
QUE ;Queue the task.
"RTN","RGMTHL2",50,0)
 S ZTSAVE("RGBDT")="",ZTSAVE("RGEDT")="",ZTSAVE("ACT")=""
"RTN","RGMTHL2",51,0)
 S ZTIO="",ZTRTN="START^RGMTHL2",ZTDESC="Compile MPI/PD HL7 Data (bi-directional)" D ^%ZTLOAD
"RTN","RGMTHL2",52,0)
 G QUIT
"RTN","RGMTHL2",53,0)
START ;
"RTN","RGMTHL2",54,0)
 K ^XTMP("RGMT","HL","@@@@","STOPPED")
"RTN","RGMTHL2",55,0)
 I ACT="D" K ^XTMP("RGMT","HL"),^XTMP("RGMT","HLICN"),^XTMP("RGMT","HLDFN")
"RTN","RGMTHL2",56,0)
 S U="^" D NOW^%DTC
"RTN","RGMTHL2",57,0)
 S ^XTMP("RGMT","HL","@@@@","STARTED")=%
"RTN","RGMTHL2",58,0)
 S ^XTMP("RGMT",0)=$$FMADD^XLFDT(DT,30)_"^"_%_"^MPI/PD Maintenance Data"
"RTN","RGMTHL2",59,0)
 I ACT="D" S ^XTMP("RGMT","HL","@@@@","COMPBEGINDATE")=RGBDT
"RTN","RGMTHL2",60,0)
 S ^XTMP("RGMT","HL","@@@@","COMPENDDATE")=RGEDT
"RTN","RGMTHL2",61,0)
 S PRGBDT=$$FMTE^XLFDT(^XTMP("RGMT","HL","@@@@","COMPBEGINDATE"))
"RTN","RGMTHL2",62,0)
 S PRGEDT=$$FMTE^XLFDT(RGEDT)
"RTN","RGMTHL2",63,0)
 S ^XTMP("RGMT","HL","@@@@","RANGE")=PRGBDT_" to "_PRGEDT
"RTN","RGMTHL2",64,0)
 ;
"RTN","RGMTHL2",65,0)
LOOP ;Loop on ^HL(772 date xref
"RTN","RGMTHL2",66,0)
 S STOPDT=$S($L(RGEDT)=7:RGEDT+.2359,1:RGEDT+.0001)
"RTN","RGMTHL2",67,0)
 S RGDT=RGBDT-.0001 F  S RGDT=$O(^HL(772,"B",RGDT)) Q:'RGDT  Q:RGDT>STOPDT  D
"RTN","RGMTHL2",68,0)
 .S ^XTMP("RGMT","HL","@@@@","NOW PROCESSING DATE")=RGDT
"RTN","RGMTHL2",69,0)
 .S IEN=0
"RTN","RGMTHL2",70,0)
 .F  S IEN=$O(^HL(772,"B",RGDT,IEN)) Q:'IEN  S IEN0=$G(^HL(772,IEN,0)) Q:'IEN0  D
"RTN","RGMTHL2",71,0)
 ..S REP=$P(IEN0,U,10)
"RTN","RGMTHL2",72,0)
 ..I REP D
"RTN","RGMTHL2",73,0)
 ...I '$D(^ORD(101,REP,0)) Q
"RTN","RGMTHL2",74,0)
 ...S REPNM=$P(^ORD(101,REP,0),U),RPNM=$E(REPNM,1,4)
"RTN","RGMTHL2",75,0)
 ...I RPNM["VAF"!(RPNM["RG")!(RPNM["MPIF") D
"RTN","RGMTHL2",76,0)
 ....S TYPE=$P(IEN0,U,4),STAT=$P($G(^HL(772,IEN,"P")),U)
"RTN","RGMTHL2",77,0)
 ....I STAT S STATNM=$P(^HL(771.6,STAT,0),U)
"RTN","RGMTHL2",78,0)
 ....I STAT="" S STATNM="NO STATUS"
"RTN","RGMTHL2",79,0)
 ....S ^XTMP("RGMT","HL",REPNM,$P(RGDT,"."),TYPE,STATNM,IEN)=""
"RTN","RGMTHL2",80,0)
PAT ....S TXT=0 F  S TXT=$O(^HL(772,IEN,"IN",TXT)) Q:'TXT  D
"RTN","RGMTHL2",81,0)
 .....I $P(^HL(772,IEN,"IN",TXT,0),U)="PID" S GOT=0 D  Q:GOT
"RTN","RGMTHL2",82,0)
 ......I +$P(^(0),U,3) S ICN=+$P(^(0),U,3) D SET Q
"RTN","RGMTHL2",83,0)
 ......I +$P(^(0),U,4) S DFN=+$P(^(0),U,4) S ^XTMP("RGMT","HLDFN",DFN,RGDT,REPNM,TYPE,STATNM,IEN)="",GOT=1
"RTN","RGMTHL2",84,0)
 .....I $P(^HL(772,IEN,"IN",TXT,0),U)="QAK" S GOT=0 D  Q:GOT
"RTN","RGMTHL2",85,0)
 ......I +$P(^(0),U,2) S DFN=+$P(^(0),U,2) S ^XTMP("RGMT","HLDFN",DFN,RGDT,REPNM,TYPE,STATNM,IEN)="",GOT=1
"RTN","RGMTHL2",86,0)
 .....I $P(^HL(772,IEN,"IN",TXT,0),U)="RDT" S ICN=+$P($P(^(0),U,6),"V") I ICN D  Q
"RTN","RGMTHL2",87,0)
 ......S ^XTMP("RGMT","HLICN",ICN,RGDT,REPNM,TYPE,STATNM,IEN)="(Look at ^HL(772,"_IEN_",""IN"","_TXT_",0)",GOT=1
"RTN","RGMTHL2",88,0)
 .....I $P(^HL(772,IEN,"IN",TXT,0),U)="VTQ" S GOT=0 D  Q:GOT
"RTN","RGMTHL2",89,0)
 ......S SSN=$P($P(^HL(772,IEN,"IN",TXT,0),"@00122",2),"~",3) I SSN D
"RTN","RGMTHL2",90,0)
 .......S DFN=$O(^DPT("SSN",SSN,0)) I DFN D
"RTN","RGMTHL2",91,0)
 ........S ^XTMP("RGMT","HLDFN",DFN,RGDT,REPNM,TYPE,STATNM,IEN)="(Look at ^HL(772,"_IEN_",""IN"","_TXT_",0)",GOT=1
"RTN","RGMTHL2",92,0)
 .....I $P(^HL(772,IEN,"IN",TXT,0),U)="MFE",$P(^(0),U,2)="MAD" S ICN=+$P($P(^(0),U,5),"~",4) D SET Q
"RTN","RGMTHL2",93,0)
 .....I $P(^HL(772,IEN,"IN",TXT,0),U)="MFE",$P(^(0),U,2)="MUP" S ICN=+$P(^(0),U,5) D SET Q
"RTN","RGMTHL2",94,0)
 D NOW^%DTC S ^XTMP("RGMT","HL","@@@@","STOPPED")=%
"RTN","RGMTHL2",95,0)
 K ^XTMP("RGMT","HL","@@@@","NOW PROCESSING DATE")
"RTN","RGMTHL2",96,0)
QUIT ;
"RTN","RGMTHL2",97,0)
 K %,ACT,CDT,DFN,GOT,ICN,IEN,IEN0,PRGBDT,PRGEDT,REP,REPNM,RGBDT,RGDT
"RTN","RGMTHL2",98,0)
 K RGEDT,RGNOW,RPNM,SSN,STAT,STATNM,STOPDT,TYPE,TXT,X,X1,X2,Y,ZTSK
"RTN","RGMTHL2",99,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RGMTHL2",100,0)
 Q
"RTN","RGMTHL2",101,0)
 ;
"RTN","RGMTHL2",102,0)
SET ;
"RTN","RGMTHL2",103,0)
 S ^XTMP("RGMT","HLICN",ICN,RGDT,REPNM,TYPE,STATNM,IEN)="" S GOT=1
"RTN","RGMTHL2",104,0)
 Q
"RTN","RGMTHLDB")
0^3^B35168043
"RTN","RGMTHLDB",1,0)
RGMTHLDB ;BIR/CML-MPI/PD HL7 ACTIVITY BY PATIENT/SINGLE PROTOCOL ;11/05/01
"RTN","RGMTHLDB",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**21**;30 Apr 99
"RTN","RGMTHLDB",3,0)
 ;
"RTN","RGMTHLDB",4,0)
 ;Reference to ^ORD(101 supported by IA #2596
"RTN","RGMTHLDB",5,0)
 ;Reference to ^HL(772 supported by IA #3464
"RTN","RGMTHLDB",6,0)
 ;Reference to ^DPT(DFN,"MPI" supported by IA #2070
"RTN","RGMTHLDB",7,0)
 ;
"RTN","RGMTHLDB",8,0)
 S QFLG=1
"RTN","RGMTHLDB",9,0)
CHK ;
"RTN","RGMTHLDB",10,0)
 I '$D(^XTMP("RGMT","HL")) D  G QUIT
"RTN","RGMTHLDB",11,0)
 .W !!,$C(7),"The option ""Compile MPI/PD HL7 Data"" must have"
"RTN","RGMTHLDB",12,0)
 .W !,"run to completion before this report can be printed!"
"RTN","RGMTHLDB",13,0)
 ;
"RTN","RGMTHLDB",14,0)
 I '$D(^XTMP("RGMT","HL","@@@@","STOPPED")) D  G QUIT
"RTN","RGMTHLDB",15,0)
 .W !!,$C(7),"The option ""Compile MPI/PD HL7 Data"" is currently running."
"RTN","RGMTHLDB",16,0)
 .W !,"This report cannot be generated until the compile has run to completion."
"RTN","RGMTHLDB",17,0)
 .W !!,"Please try again later.",!
"RTN","RGMTHLDB",18,0)
 ;
"RTN","RGMTHLDB",19,0)
 W @IOF
"RTN","RGMTHLDB",20,0)
 I $D(^XTMP("RGMT","HL","@@@@","RANGE")) D
"RTN","RGMTHLDB",21,0)
 .W !!,"Data has been compiled for ",^XTMP("RGMT","HL","@@@@","RANGE"),"."
"RTN","RGMTHLDB",22,0)
 .W !,"Use the ""Compile MPI/PD HL7 Data"" option if this range is not sufficient."
"RTN","RGMTHLDB",23,0)
 ;
"RTN","RGMTHLDB",24,0)
BEGIN ;
"RTN","RGMTHLDB",25,0)
 W !!,"This option allows you to search for activity related to a specific protocol in"
"RTN","RGMTHLDB",26,0)
 W !,"the HL7 MESSAGE TEXT (#772) file for a patient during a selected period of time."
"RTN","RGMTHLDB",27,0)
 W !,"This search is accomplished using data set into a temporary global built by the"
"RTN","RGMTHLDB",28,0)
 W !,"option ""Compile MPI/PD HL7 Data""."
"RTN","RGMTHLDB",29,0)
 ;
"RTN","RGMTHLDB",30,0)
ASK1 ;Ask for Protocol
"RTN","RGMTHLDB",31,0)
 W !
"RTN","RGMTHLDB",32,0)
 S DIC="^ORD(101,",DIC(0)="QEAM"
"RTN","RGMTHLDB",33,0)
 S DIC("S")="S ORD=$P(^(0),""^"") I $D(^XTMP(""RGMT"",""HL"",ORD))"
"RTN","RGMTHLDB",34,0)
 D ^DIC K DIC G:Y<0 QUIT S PROT=$P(Y,"^",2)
"RTN","RGMTHLDB",35,0)
 ;
"RTN","RGMTHLDB",36,0)
ASK2 ;Ask for Date Range
"RTN","RGMTHLDB",37,0)
 W !
"RTN","RGMTHLDB",38,0)
 K DIR,DIRUT,DTOUT,DUOUT
"RTN","RGMTHLDB",39,0)
 S DIR(0)="DAO^:DT:EPX",DIR("A")="Beginning Date:  "
"RTN","RGMTHLDB",40,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT
"RTN","RGMTHLDB",41,0)
 ;
"RTN","RGMTHLDB",42,0)
 S RGBDT=Y,DIR(0)="DAO^"_RGBDT_":DT:EPX",DIR("A")="Ending Date:  "
"RTN","RGMTHLDB",43,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S RGEDT=Y
"RTN","RGMTHLDB",44,0)
 ;
"RTN","RGMTHLDB",45,0)
ASK3 ;Ask for TYPE
"RTN","RGMTHLDB",46,0)
 W !
"RTN","RGMTHLDB",47,0)
 S DIR(0)="SB^I:INCOMING;O:OUTGOING",DIR("A")="Select TYPE"
"RTN","RGMTHLDB",48,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S TYPE=Y
"RTN","RGMTHLDB",49,0)
 ;
"RTN","RGMTHLDB",50,0)
ASK4 ;Ask for PATIENT
"RTN","RGMTHLDB",51,0)
 W !!!,"Patient lookup can be done by (P)atient Name/SSN or by (I)CN.",!
"RTN","RGMTHLDB",52,0)
 S DIR(0)="SB^I:ICN;P:PATIENT NAME/SSN",DIR("A")="Select LOOKUP",DIR("B")="P"
"RTN","RGMTHLDB",53,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S LOOKUP=Y
"RTN","RGMTHLDB",54,0)
 I LOOKUP="P" D LOOKUP1 G:'$D(DFN) ASK4
"RTN","RGMTHLDB",55,0)
 I LOOKUP="I" D LOOKUP2 G:'$D(DFN) ASK4
"RTN","RGMTHLDB",56,0)
 ;
"RTN","RGMTHLDB",57,0)
DEV ;
"RTN","RGMTHLDB",58,0)
 W !!,"The right margin for this print is 80.",!!
"RTN","RGMTHLDB",59,0)
 S ZTSAVE("RGBDT")="",ZTSAVE("RGEDT")="",ZTSAVE("PROT")=""
"RTN","RGMTHLDB",60,0)
 S ZTSAVE("TYPE")="",ZTSAVE("DFN")="",ZTSAVE("ICN")=""
"RTN","RGMTHLDB",61,0)
 D EN^XUTMDEVQ("START^RGMTHLDB","MPI/PD - Print HL7 Message Data for Patient/Single Protocol") I 'POP Q
"RTN","RGMTHLDB",62,0)
 W !,"NO DEVICE SELECTED OR REPORT PRINTED!!"
"RTN","RGMTHLDB",63,0)
 G QUIT
"RTN","RGMTHLDB",64,0)
START ;
"RTN","RGMTHLDB",65,0)
 G:'$D(^XTMP("RGMT","HL")) QUIT
"RTN","RGMTHLDB",66,0)
 S (PG,QFLG,GOTDATA)=0,U="^",$P(LN,"-",81)="",SITE=$P($$SITE^VASITE(),U,2)
"RTN","RGMTHLDB",67,0)
 S PRGBDT=$$FMTE^XLFDT(RGBDT),PRGEDT=$$FMTE^XLFDT(RGEDT)
"RTN","RGMTHLDB",68,0)
 D NOW^%DTC S HDT=$$FMTE^XLFDT($E(%,1,12))
"RTN","RGMTHLDB",69,0)
 D HDR
"RTN","RGMTHLDB",70,0)
 ;
"RTN","RGMTHLDB",71,0)
LOOP ;Loop on ^XTMP("RGMT","HLICN" & ^XTMP("RGMT","HLDFN"
"RTN","RGMTHLDB",72,0)
 I '$D(^XTMP("RGMT","HLICN"))&'($D(^XTMP("RGMT","HLDFN"))) G QUIT
"RTN","RGMTHLDB",73,0)
 S STOPDT=RGEDT_".9"
"RTN","RGMTHLDB",74,0)
 F SUB1="HLICN","HLDFN" S SUB2=$S(SUB1="HLICN":ICN,1:DFN) Q:QFLG  D
"RTN","RGMTHLDB",75,0)
 .S RGDT=RGBDT-.1
"RTN","RGMTHLDB",76,0)
 .F  S RGDT=$O(^XTMP("RGMT",SUB1,SUB2,RGDT)) Q:'RGDT  Q:RGDT>STOPDT  Q:QFLG  D
"RTN","RGMTHLDB",77,0)
 ..S STAT="" F  S STAT=$O(^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE,STAT)) Q:STAT=""  Q:QFLG  D
"RTN","RGMTHLDB",78,0)
 ...S IEN=0 F  S IEN=$O(^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE,STAT,IEN))  Q:'IEN  Q:QFLG  D
"RTN","RGMTHLDB",79,0)
 ....I ^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE,STAT,IEN)]"" D BATCHPRT Q
"RTN","RGMTHLDB",80,0)
 ....I $O(^HL(772,IEN,"IN",0)) S GOT=0 D  Q:QFLG
"RTN","RGMTHLDB",81,0)
 .....S TXT=0 F  S TXT=$O(^HL(772,IEN,"IN",TXT)) Q:'TXT  Q:QFLG  D  Q:GOT  Q:QFLG
"RTN","RGMTHLDB",82,0)
 ......I $P(^HL(772,IEN,"IN",TXT,0),U)="PID",+$P(^(0),U,3)=ICN D PROC Q
"RTN","RGMTHLDB",83,0)
 ......I $P(^HL(772,IEN,"IN",TXT,0),U)="MFE",$P(^(0),U,2)="MAD",+$P($P(^(0),U,5),"~",4)=ICN D PROC Q
"RTN","RGMTHLDB",84,0)
 ......I $P(^HL(772,IEN,"IN",TXT,0),U)="MFE",$P(^(0),U,2)="MUP",+$P(^(0),U,5)=ICN D PROC Q
"RTN","RGMTHLDB",85,0)
 ......I $P(^HL(772,IEN,"IN",TXT,0),U)="QAK",+$P(^(0),U,2)=DFN D PROC
"RTN","RGMTHLDB",86,0)
 I 'GOTDATA W !,"No data found for this patient."
"RTN","RGMTHLDB",87,0)
 ;
"RTN","RGMTHLDB",88,0)
QUIT ;
"RTN","RGMTHLDB",89,0)
 I $E(IOST)="C"&('QFLG) S DIR(0)="E" D  D ^DIR K DIR
"RTN","RGMTHLDB",90,0)
 .S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLDB",91,0)
 K %,BATCHIEN,CNT,DFN,GOT,GOTDATA,HDT,ICN,IEN,JJ,LIM,LINE,LN,LOOKUP,NODE,NUM,PG,PRGBDT
"RTN","RGMTHLDB",92,0)
 K PRGEDT,PROT,QFLG,RGBDT,RGDT,RGEDT,SITE,SS,STAT,STOPDT,SUB1,SUB2,TXT,TYPE,Y,ZTSK
"RTN","RGMTHLDB",93,0)
 W:$E(IOST)'="C" @IOF D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@" Q
"RTN","RGMTHLDB",94,0)
 ;
"RTN","RGMTHLDB",95,0)
HDR ;HEADER
"RTN","RGMTHLDB",96,0)
 I $E(IOST)="C" S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLDB",97,0)
 I $E(IOST)="C",PG>0 S DIR(0)="E" W ! D ^DIR K DIR I 'Y S QFLG=1 Q
"RTN","RGMTHLDB",98,0)
 S PG=PG+1 W:$Y!($E(IOST)="C") @IOF I $E(IOST)'="C"!($E(IOST)="C"&(PG=1)) D
"RTN","RGMTHLDB",99,0)
 .W !,"HL7 TRANSMISSION DATA at ",SITE," on ",HDT,?72,"Page: ",PG
"RTN","RGMTHLDB",100,0)
 .W !!,"Patient: ",$P(^DPT(DFN,0),U)
"RTN","RGMTHLDB",101,0)
 .W !,"Protocol: ",PROT
"RTN","RGMTHLDB",102,0)
 .W !,"Date Range: ",PRGBDT," to ",PRGEDT,?45,"Type: ",$S(TYPE="I":"INCOMING",1:"OUTGOING"),!
"RTN","RGMTHLDB",103,0)
 W !,"File #772 IEN",?19,"Date",?39,"Status",!?4,"""IN"" Subfield",!,LN
"RTN","RGMTHLDB",104,0)
 Q
"RTN","RGMTHLDB",105,0)
 ;
"RTN","RGMTHLDB",106,0)
BATCHPRT ;
"RTN","RGMTHLDB",107,0)
 S GOTDATA=1
"RTN","RGMTHLDB",108,0)
 D:$Y+4>IOSL HDR Q:QFLG
"RTN","RGMTHLDB",109,0)
 S BATCHIEN=+$P(^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE,STAT,IEN),",""IN"",",2)
"RTN","RGMTHLDB",110,0)
 W !,"Batch Msg #",IEN," - Line #",BATCHIEN
"RTN","RGMTHLDB",111,0)
 W !?19,$$FMTE^XLFDT($E(RGDT,1,12)),?39,STAT,!
"RTN","RGMTHLDB",112,0)
 S NODE=^HL(772,IEN,"IN",BATCHIEN,0)
"RTN","RGMTHLDB",113,0)
 I $L(NODE)>75 D BREAK Q
"RTN","RGMTHLDB",114,0)
 W !?4,NODE
"RTN","RGMTHLDB",115,0)
 Q
"RTN","RGMTHLDB",116,0)
 ;
"RTN","RGMTHLDB",117,0)
PROC ;Print data
"RTN","RGMTHLDB",118,0)
 S GOT=1,GOTDATA=1
"RTN","RGMTHLDB",119,0)
 W !,IEN,?19,$$FMTE^XLFDT($E(RGDT,1,12)),?39,STAT,!
"RTN","RGMTHLDB",120,0)
 S NUM=0 F  S NUM=$O(^HL(772,IEN,"IN",NUM)) Q:'NUM  Q:QFLG  S NODE=^HL(772,IEN,"IN",NUM,0) D
"RTN","RGMTHLDB",121,0)
 .I $L(NODE)>75 D BREAK Q
"RTN","RGMTHLDB",122,0)
 .D:$Y+3>IOSL HDR Q:QFLG  W !?4,NODE
"RTN","RGMTHLDB",123,0)
 Q
"RTN","RGMTHLDB",124,0)
 ;
"RTN","RGMTHLDB",125,0)
BREAK ;Break up text lines greater than 75
"RTN","RGMTHLDB",126,0)
 S CNT=1,LIM=$L(NODE)/75 I LIM["." S LIM=$P(LIM,".")+1
"RTN","RGMTHLDB",127,0)
 F LINE=1:1:LIM D:$Y+3>IOSL HDR Q:QFLG  W !?4,$E(NODE,CNT,CNT+74) S CNT=CNT+75
"RTN","RGMTHLDB",128,0)
 Q
"RTN","RGMTHLDB",129,0)
 ;
"RTN","RGMTHLDB",130,0)
LOOKUP1 ;Lookup by patient name/ssn
"RTN","RGMTHLDB",131,0)
 W ! K DFN,ICN
"RTN","RGMTHLDB",132,0)
 S DIC="^DPT(",DIC(0)="QEAM",DIC("A")="Select PATIENT: " D ^DIC K DIC
"RTN","RGMTHLDB",133,0)
 Q:Y<0
"RTN","RGMTHLDB",134,0)
 S DFN=+Y
"RTN","RGMTHLDB",135,0)
 S ICN=+$P($G(^DPT(DFN,"MPI")),U) I 'ICN W !!,"This patient does not have an ICN!" K DFN,ICN
"RTN","RGMTHLDB",136,0)
 Q
"RTN","RGMTHLDB",137,0)
 ;
"RTN","RGMTHLDB",138,0)
LOOKUP2 ;Lookup by ICN
"RTN","RGMTHLDB",139,0)
 W ! K DFN,ICN
"RTN","RGMTHLDB",140,0)
 S DIR(0)="N:1:999999999999:0",DIR("A")="Select ICN" D ^DIR K DIR Q:$D(DIRUT)
"RTN","RGMTHLDB",141,0)
 S ICN=Y S DFN=$$GETDFN^MPIF001(ICN)
"RTN","RGMTHLDB",142,0)
 I +DFN<0 W !!,"No patient match can be found for this ICN!" K DFN,ICN Q
"RTN","RGMTHLDB",143,0)
 W "  ",$P(^DPT(DFN,0),"^")
"RTN","RGMTHLDB",144,0)
 Q
"RTN","RGMTHLDP")
0^4^B34124264
"RTN","RGMTHLDP",1,0)
RGMTHLDP ;BIR/CML-MPI/PD HL7 ACTIVITY BY PATIENT/ALL PROTOCOLS ;11/05/01
"RTN","RGMTHLDP",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**21**;30 Apr 99
"RTN","RGMTHLDP",3,0)
 ;
"RTN","RGMTHLDP",4,0)
 ;Reference to ^ORD(101 supported by IA #2596
"RTN","RGMTHLDP",5,0)
 ;Reference to ^HL(771.6 supported by IA #2507
"RTN","RGMTHLDP",6,0)
 ;Reference to ^HLMA( supported by IA #3273
"RTN","RGMTHLDP",7,0)
 ;Reference to ^HLCS(870 supported by IA #2525
"RTN","RGMTHLDP",8,0)
 ;Reference to ^DPT(DFN,"MPI" supported by IA #2070
"RTN","RGMTHLDP",9,0)
 ;
"RTN","RGMTHLDP",10,0)
 S QFLG=1
"RTN","RGMTHLDP",11,0)
CHK ;
"RTN","RGMTHLDP",12,0)
 I '$D(^XTMP("RGMT","HL")) D  G QUIT
"RTN","RGMTHLDP",13,0)
 .W !!,$C(7),"The option ""Compile MPI/PD HL7 Data"" must have"
"RTN","RGMTHLDP",14,0)
 .W !,"run to completion before this report can be printed!"
"RTN","RGMTHLDP",15,0)
 I '$D(^XTMP("RGMT","HL","@@@@","STOPPED")) D  G QUIT
"RTN","RGMTHLDP",16,0)
 .W !!,$C(7),"The option ""Compile MPI/PD HL7 Data"" is currently running."
"RTN","RGMTHLDP",17,0)
 .W !,"This report cannot be generated until the compile has run to completion."
"RTN","RGMTHLDP",18,0)
 .W !!,"Please try again later.",!
"RTN","RGMTHLDP",19,0)
 W @IOF
"RTN","RGMTHLDP",20,0)
 I $D(^XTMP("RGMT","HL","@@@@","RANGE")) D
"RTN","RGMTHLDP",21,0)
 .W !!,"Data has been compiled for ",^XTMP("RGMT","HL","@@@@","RANGE"),"."
"RTN","RGMTHLDP",22,0)
 .W !,"Use the ""Compile MPI/PD HL7 Data"" option if this range is not sufficient."
"RTN","RGMTHLDP",23,0)
 ;
"RTN","RGMTHLDP",24,0)
BEGIN ;
"RTN","RGMTHLDP",25,0)
 W !!,"This option allows you to search for ALL activity in the HL7 MESSAGE TEXT"
"RTN","RGMTHLDP",26,0)
 W !,"(#772) file for a specific patient during a selected period of time.  This"
"RTN","RGMTHLDP",27,0)
 W !,"search is accomplished using data set into a temporary global built by the"
"RTN","RGMTHLDP",28,0)
 W !,"option ""Compile MPI/PD HL7 Data""."
"RTN","RGMTHLDP",29,0)
 ;
"RTN","RGMTHLDP",30,0)
ASK1 ;Ask for PATIENT
"RTN","RGMTHLDP",31,0)
 W !!!,"Patient lookup can be done by (P)atient Name/SSN or by (I)CN.",!
"RTN","RGMTHLDP",32,0)
 S DIR(0)="SB^I:ICN;P:PATIENT NAME/SSN",DIR("A")="Select LOOKUP",DIR("B")="P"
"RTN","RGMTHLDP",33,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S TYPE=Y
"RTN","RGMTHLDP",34,0)
 I TYPE="P" D LOOKUP1 G:'$D(ICN) ASK1 G ASK2
"RTN","RGMTHLDP",35,0)
 I TYPE="I" D LOOKUP2 G:'$D(ICN) ASK1
"RTN","RGMTHLDP",36,0)
 ;check if selected patient had activity in compiled data
"RTN","RGMTHLDP",37,0)
 I 'ICN,'$D(^XTMP("RGMT","HLDFN",DFN)) D MSG G QUIT
"RTN","RGMTHLDP",38,0)
 I '$D(^XTMP("RGMT","HLICN",ICN)) D MSG G QUIT
"RTN","RGMTHLDP",39,0)
 ;
"RTN","RGMTHLDP",40,0)
ASK2 ;Ask for Date Range
"RTN","RGMTHLDP",41,0)
 W !!,"Enter date range for data to be included in report."
"RTN","RGMTHLDP",42,0)
 K DIR,DIRUT,DTOUT,DUOUT
"RTN","RGMTHLDP",43,0)
 S DIR(0)="DAO^:DT:EPX",DIR("A")="Beginning Date:  "
"RTN","RGMTHLDP",44,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S RGBDT=Y
"RTN","RGMTHLDP",45,0)
 S DIR(0)="DAO^"_RGBDT_":DT:EPX",DIR("A")="Ending Date:  "
"RTN","RGMTHLDP",46,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S RGEDT=Y
"RTN","RGMTHLDP",47,0)
 ;
"RTN","RGMTHLDP",48,0)
DEV ;
"RTN","RGMTHLDP",49,0)
 W !!,"The right margin for this report is 80.",!!
"RTN","RGMTHLDP",50,0)
 S ZTSAVE("RGBDT")="",ZTSAVE("RGEDT")="",ZTSAVE("DFN")="",ZTSAVE("ICN")=""
"RTN","RGMTHLDP",51,0)
 D EN^XUTMDEVQ("START^RGMTHLDP","MPI/PD - Print HL7 Message Data for Patient/All Protocols") I 'POP Q
"RTN","RGMTHLDP",52,0)
 W !,"NO DEVICE SELECTED OR REPORT PRINTED!!"
"RTN","RGMTHLDP",53,0)
 G QUIT
"RTN","RGMTHLDP",54,0)
 ;
"RTN","RGMTHLDP",55,0)
START ;
"RTN","RGMTHLDP",56,0)
 K ^TMP("RGMTHLDP",$J) S U="^"
"RTN","RGMTHLDP",57,0)
 ;
"RTN","RGMTHLDP",58,0)
LOOP ;Loop on ^XTMP("RGMT","HLICN" & ^XTMP("RGMT","HLDFN"
"RTN","RGMTHLDP",59,0)
 I '$D(^XTMP("RGMT","HLICN"))&'($D(^XTMP("RGMT","HLDFN"))) G QUIT
"RTN","RGMTHLDP",60,0)
 S STOPDT=RGEDT_".9"
"RTN","RGMTHLDP",61,0)
 F SUB1="HLICN","HLDFN" S SUB2=$S(SUB1="HLICN":ICN,1:DFN) D
"RTN","RGMTHLDP",62,0)
 .S RGDT=RGBDT-.1
"RTN","RGMTHLDP",63,0)
 .F  S RGDT=$O(^XTMP("RGMT",SUB1,SUB2,RGDT)) Q:'RGDT  Q:RGDT>STOPDT  D
"RTN","RGMTHLDP",64,0)
 ..S PROT="" F  S PROT=$O(^XTMP("RGMT",SUB1,SUB2,RGDT,PROT)) Q:PROT=""  D
"RTN","RGMTHLDP",65,0)
 ...S TYPE="" F  S TYPE=$O(^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE)) Q:TYPE=""  D
"RTN","RGMTHLDP",66,0)
 ....S STAT="" F  S STAT=$O(^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE,STAT)) Q:STAT=""  D
"RTN","RGMTHLDP",67,0)
 .....S IEN=0 F  S IEN=$O(^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE,STAT,IEN))  Q:'IEN  D
"RTN","RGMTHLDP",68,0)
 ......S ^TMP("RGMTHLDP",$J,PROT,RGDT,TYPE,STAT,IEN)=^XTMP("RGMT",SUB1,SUB2,RGDT,PROT,TYPE,STAT,IEN)
"RTN","RGMTHLDP",69,0)
 ;
"RTN","RGMTHLDP",70,0)
PRT ;Print report
"RTN","RGMTHLDP",71,0)
 S (PG,QFLG)=0,U="^",$P(LN,"-",81)="",SITE=$P($$SITE^VASITE(),U,2)
"RTN","RGMTHLDP",72,0)
 S PRGBDT=$$FMTE^XLFDT(RGBDT),PRGEDT=$$FMTE^XLFDT(RGEDT)
"RTN","RGMTHLDP",73,0)
 D NOW^%DTC S HDT=$$FMTE^XLFDT($E(%,1,12))
"RTN","RGMTHLDP",74,0)
 D HDR
"RTN","RGMTHLDP",75,0)
 S PROT="" F  S PROT=$O(^TMP("RGMTHLDP",$J,PROT)) Q:PROT=""  Q:QFLG  W !!,PROT,":" D
"RTN","RGMTHLDP",76,0)
 .S RGDT=0
"RTN","RGMTHLDP",77,0)
 .F  S RGDT=$O(^TMP("RGMTHLDP",$J,PROT,RGDT)) Q:'RGDT  Q:QFLG  D
"RTN","RGMTHLDP",78,0)
 ..S TYPE=""
"RTN","RGMTHLDP",79,0)
 ..F  S TYPE=$O(^TMP("RGMTHLDP",$J,PROT,RGDT,TYPE)) Q:TYPE=""  Q:QFLG  D
"RTN","RGMTHLDP",80,0)
 ...S STAT=""
"RTN","RGMTHLDP",81,0)
 ...F  S STAT=$O(^TMP("RGMTHLDP",$J,PROT,RGDT,TYPE,STAT)) Q:STAT=""  Q:QFLG  D
"RTN","RGMTHLDP",82,0)
 ....S IEN=0
"RTN","RGMTHLDP",83,0)
 ....F  S IEN=$O(^TMP("RGMTHLDP",$J,PROT,RGDT,TYPE,STAT,IEN)) Q:'IEN  Q:QFLG  D
"RTN","RGMTHLDP",84,0)
 .....D:$Y+3>IOSL HDR Q:QFLG
"RTN","RGMTHLDP",85,0)
 .....W !!?4,$$FMTE^XLFDT($E(RGDT,1,12))
"RTN","RGMTHLDP",86,0)
 .....W ?25,$S(TYPE="O":"OUTGOING",1:"INCOMING"),?41,STAT,?69,IEN
"RTN","RGMTHLDP",87,0)
 .....I ^TMP("RGMTHLDP",$J,PROT,RGDT,TYPE,STAT,IEN)]"" D  Q
"RTN","RGMTHLDP",88,0)
 ......W !?35,^TMP("RGMTHLDP",$J,PROT,RGDT,TYPE,STAT,IEN)
"RTN","RGMTHLDP",89,0)
 .....S HLMAIEN=0
"RTN","RGMTHLDP",90,0)
 .....F  S HLMAIEN=$O(^HLMA("B",IEN,HLMAIEN)) Q:'HLMAIEN  Q:QFLG  D
"RTN","RGMTHLDP",91,0)
 ......S HLMASTAT=$P(^HL(771.6,($P(^HLMA(HLMAIEN,"P"),"^")),0),"^")
"RTN","RGMTHLDP",92,0)
 ......S HLMAPROT=$P(^ORD(101,$P(^HLMA(HLMAIEN,0),"^",8),0),"^")
"RTN","RGMTHLDP",93,0)
 ......S HLMALINK=$P(^HLCS(870,$P(^HLMA(HLMAIEN,0),"^",7),0),"^")
"RTN","RGMTHLDP",94,0)
 ......D:$Y+3>IOSL HDR Q:QFLG
"RTN","RGMTHLDP",95,0)
 ......W !?4,"=>^HLMA(",HLMAIEN,?24,$E(HLMAPROT,1,25),?50,$E(HLMASTAT,1,22),?74,HLMALINK
"RTN","RGMTHLDP",96,0)
 I '$D(^TMP("RGMTHLDP",$J)) W !!,"No data found for this patient."
"RTN","RGMTHLDP",97,0)
QUIT ;
"RTN","RGMTHLDP",98,0)
 I $E(IOST)="C"&('QFLG) S DIR(0)="E" D  D ^DIR K DIR
"RTN","RGMTHLDP",99,0)
 .S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLDP",100,0)
 K ^TMP("RGMTHLDP",$J)
"RTN","RGMTHLDP",101,0)
 K %,DFN,GOT,HDT,ICN,IEN,JJ,LL,LN,PG,PRGBDT,PRGEDT,PROT,QFLG,RGBDT
"RTN","RGMTHLDP",102,0)
 K HLMAIEN,HLMASTAT,HLMAPROT,HLMALINK
"RTN","RGMTHLDP",103,0)
 K RGDT,RGEDT,SITE,SS,STAT,STOPDT,SUB1,SUB2,TXT,TYPE,X,Y,ZTSK
"RTN","RGMTHLDP",104,0)
 W:$E(IOST)'="C" @IOF D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RGMTHLDP",105,0)
 Q
"RTN","RGMTHLDP",106,0)
 ;
"RTN","RGMTHLDP",107,0)
HDR ;HEADER
"RTN","RGMTHLDP",108,0)
 I $E(IOST)="C" S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLDP",109,0)
 I $E(IOST)="C",PG>0 S DIR(0)="E" W ! D ^DIR K DIR I 'Y S QFLG=1 Q
"RTN","RGMTHLDP",110,0)
 S PG=PG+1 W:$Y!($E(IOST)="C") @IOF
"RTN","RGMTHLDP",111,0)
 W !,"HL7 TRANSMISSION PATIENT DATA at ",SITE," on ",HDT,?72,"Page: ",PG
"RTN","RGMTHLDP",112,0)
 W !!,"Patient: ",$P(^DPT(DFN,0),U)
"RTN","RGMTHLDP",113,0)
 W !,"Date Range: ",PRGBDT," to ",PRGEDT
"RTN","RGMTHLDP",114,0)
 W !!,"Related Event Protocol"
"RTN","RGMTHLDP",115,0)
 W !?4,"Date",?26,"Type",?42,"Status",?69,"^HL(772,IEN"
"RTN","RGMTHLDP",116,0)
 W !?4,"=>^HLMA(IEN",?24,"Protocol",?50,"Status",?74,"Link",!,LN
"RTN","RGMTHLDP",117,0)
 Q
"RTN","RGMTHLDP",118,0)
 ;
"RTN","RGMTHLDP",119,0)
LOOKUP1 ;Lookup by patient name/ssn
"RTN","RGMTHLDP",120,0)
 W ! K DFN,ICN
"RTN","RGMTHLDP",121,0)
 S DIC="^DPT(",DIC(0)="QEAM",DIC("A")="Select PATIENT: " D ^DIC K DIC
"RTN","RGMTHLDP",122,0)
 Q:Y<0
"RTN","RGMTHLDP",123,0)
 S DFN=+Y
"RTN","RGMTHLDP",124,0)
 S ICN=+$P($G(^DPT(DFN,"MPI")),U)
"RTN","RGMTHLDP",125,0)
 Q
"RTN","RGMTHLDP",126,0)
 ;
"RTN","RGMTHLDP",127,0)
LOOKUP2 ;Lookup by ICN
"RTN","RGMTHLDP",128,0)
 W ! K DFN,ICN
"RTN","RGMTHLDP",129,0)
 S DIR(0)="N:1:999999999999:0",DIR("A")="Select ICN" D ^DIR K DIR Q:$D(DIRUT)
"RTN","RGMTHLDP",130,0)
 S ICN=Y S DFN=$$GETDFN^MPIF001(ICN)
"RTN","RGMTHLDP",131,0)
 I +DFN<0 W !!,"No patient DFN match can be found for this ICN!" K DFN,ICN Q
"RTN","RGMTHLDP",132,0)
 W "  ",$P(^DPT(DFN,0),"^")
"RTN","RGMTHLDP",133,0)
 Q
"RTN","RGMTHLDP",134,0)
 ;
"RTN","RGMTHLDP",135,0)
MSG ;
"RTN","RGMTHLDP",136,0)
 W !!,"This patient has no HL7 messaging activity in the current compiled data set."
"RTN","RGMTHLDP",137,0)
 Q
"RTN","RGMTHLP")
0^5^B17520048
"RTN","RGMTHLP",1,0)
RGMTHLP ;BIR/CML-MPI/PD HL7 MESSAGE STATUS REPORT ;12/12/00
"RTN","RGMTHLP",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**21**;30 Apr 99
"RTN","RGMTHLP",3,0)
 S QFLG=1
"RTN","RGMTHLP",4,0)
CHK ;
"RTN","RGMTHLP",5,0)
 I '$D(^XTMP("RGMT","HL")) D  G QUIT
"RTN","RGMTHLP",6,0)
 .W !!,$C(7),"The option ""Compile MPI/PD HL7 Data"" must have"
"RTN","RGMTHLP",7,0)
 .W !,"run to completion before this report can be printed!"
"RTN","RGMTHLP",8,0)
 I '$D(^XTMP("RGMT","HL","@@@@","STOPPED")) D  G QUIT
"RTN","RGMTHLP",9,0)
 .W !!,$C(7),"The option ""Compile MPI/PD HL7 Data"" is currently running."
"RTN","RGMTHLP",10,0)
 .W !,"This report cannot be generated until the compile has run to completion."
"RTN","RGMTHLP",11,0)
 .W !!,"Please try again later.",!
"RTN","RGMTHLP",12,0)
 W @IOF
"RTN","RGMTHLP",13,0)
 I $D(^XTMP("RGMT","HL","@@@@","RANGE")) D
"RTN","RGMTHLP",14,0)
 .W !!,"Data has been compiled for ",^XTMP("RGMT","HL","@@@@","RANGE"),"."
"RTN","RGMTHLP",15,0)
 .W !,"Use the ""Compile MPI/PD HL7 Data"" option if this range is not sufficient."
"RTN","RGMTHLP",16,0)
 ;
"RTN","RGMTHLP",17,0)
REP ;Ask for type of report
"RTN","RGMTHLP",18,0)
 K DIR,DIRUT,DTOUT,DUOUT
"RTN","RGMTHLP",19,0)
 W !!
"RTN","RGMTHLP",20,0)
 S DIR(0)="SAM^D:Detailed;S:Summary;"
"RTN","RGMTHLP",21,0)
 S DIR("A")="Select TYPE of Report - (D)etailed or (S)ummary:  "
"RTN","RGMTHLP",22,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT
"RTN","RGMTHLP",23,0)
 G:Y="D" ^RGMTHLPD
"RTN","RGMTHLP",24,0)
 ;
"RTN","RGMTHLP",25,0)
BEGIN ; Produce SUMMARY Report
"RTN","RGMTHLP",26,0)
 W !!,"This option allows you to print information found during the ""Compile MPI/PD"
"RTN","RGMTHLP",27,0)
 W !,"HL7 Data"" compilation. The report is sorted by RELATED EVENT PROTOCOL, date,"
"RTN","RGMTHLP",28,0)
 W !,"transmission type, and status. The total number of messages for each date,"
"RTN","RGMTHLP",29,0)
 W !,"transmission type, and status are displayed."
"RTN","RGMTHLP",30,0)
 ;
"RTN","RGMTHLP",31,0)
ASK1 ;Ask for Date Range
"RTN","RGMTHLP",32,0)
 W !!,"Enter date range for data to be included in report."
"RTN","RGMTHLP",33,0)
 K DIR,DIRUT,DTOUT,DUOUT
"RTN","RGMTHLP",34,0)
 S DIR(0)="DAO^:DT:EPX",DIR("A")="Beginning Date for Report:  "
"RTN","RGMTHLP",35,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S RGBDT=Y
"RTN","RGMTHLP",36,0)
 S DIR(0)="DAO^"_RGBDT_":DT:EPX"
"RTN","RGMTHLP",37,0)
 S DIR("A")="Ending Date for Report:  "
"RTN","RGMTHLP",38,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S RGEDT=Y
"RTN","RGMTHLP",39,0)
 ;
"RTN","RGMTHLP",40,0)
DEV ;
"RTN","RGMTHLP",41,0)
 W !!,"The right margin for this report is 80.",!!
"RTN","RGMTHLP",42,0)
 S ZTSAVE("RGBDT")="",ZTSAVE("RGEDT")=""
"RTN","RGMTHLP",43,0)
 D EN^XUTMDEVQ("START^RGMTHLP","MPI/PD - Print HL7 Message Status (SUMMARY)") I 'POP Q
"RTN","RGMTHLP",44,0)
 W !,"NO DEVICE SELECTED OR REPORT PRINTED!!"
"RTN","RGMTHLP",45,0)
 G QUIT
"RTN","RGMTHLP",46,0)
 ;
"RTN","RGMTHLP",47,0)
START ;Print report
"RTN","RGMTHLP",48,0)
 S (PG,QFLG)=0,U="^",$P(LN,"-",81)="",SITE=$P($$SITE^VASITE(),U,2)
"RTN","RGMTHLP",49,0)
 S PRGBDT=$$FMTE^XLFDT(RGBDT),PRGEDT=$$FMTE^XLFDT(RGEDT)
"RTN","RGMTHLP",50,0)
 D NOW^%DTC S HDT=$$FMTE^XLFDT($E(%,1,12))
"RTN","RGMTHLP",51,0)
 D HDR
"RTN","RGMTHLP",52,0)
 S STOPDT=RGEDT_".9"
"RTN","RGMTHLP",53,0)
 S REPNM="@@@@"
"RTN","RGMTHLP",54,0)
 F  S REPNM=$O(^XTMP("RGMT","HL",REPNM)) Q:REPNM=""  Q:QFLG  D
"RTN","RGMTHLP",55,0)
 .D:$Y+3>IOSL HDR Q:QFLG
"RTN","RGMTHLP",56,0)
 .W !!,REPNM,":" D
"RTN","RGMTHLP",57,0)
 ..S RGDT=RGBDT-.1
"RTN","RGMTHLP",58,0)
 ..F  S RGDT=$O(^XTMP("RGMT","HL",REPNM,RGDT)) Q:'RGDT  Q:RGDT>STOPDT  Q:QFLG  D
"RTN","RGMTHLP",59,0)
 ...D:$Y+4>IOSL HDR Q:QFLG
"RTN","RGMTHLP",60,0)
 ...W !!?4,$$FMTE^XLFDT(RGDT) D
"RTN","RGMTHLP",61,0)
 ....S TYPE="",TYPECNT=0
"RTN","RGMTHLP",62,0)
 ....F  S TYPE=$O(^XTMP("RGMT","HL",REPNM,RGDT,TYPE)) Q:TYPE=""  Q:QFLG  D
"RTN","RGMTHLP",63,0)
 .....S TYPECNT=TYPECNT+1
"RTN","RGMTHLP",64,0)
 .....W:TYPE="O"&(TYPECNT>1) !
"RTN","RGMTHLP",65,0)
 .....W ?25,$S(TYPE="O":"OUTGOING",1:"INCOMING") S TOTCNT=0 D
"RTN","RGMTHLP",66,0)
 ......S STATCNT=0,STAT=""
"RTN","RGMTHLP",67,0)
 ......F  S STAT=$O(^XTMP("RGMT","HL",REPNM,RGDT,TYPE,STAT)) Q:STAT=""  Q:QFLG  D
"RTN","RGMTHLP",68,0)
 .......W:STATCNT>0 !
"RTN","RGMTHLP",69,0)
 .......S STATCNT=STATCNT+1
"RTN","RGMTHLP",70,0)
 .......W ?41,STAT S CNT=0 D  W ?69,$J(CNT,6) S TOTCNT=TOTCNT+CNT
"RTN","RGMTHLP",71,0)
 ........S IEN=0
"RTN","RGMTHLP",72,0)
 ........F  S IEN=$O(^XTMP("RGMT","HL",REPNM,RGDT,TYPE,STAT,IEN)) Q:'IEN  Q:QFLG  S CNT=CNT+1
"RTN","RGMTHLP",73,0)
 ......I STATCNT>1 W !?69,"-------",!?59,"TOTAL",?69,$J(TOTCNT,6),!
"RTN","RGMTHLP",74,0)
 ;
"RTN","RGMTHLP",75,0)
QUIT ;
"RTN","RGMTHLP",76,0)
 I $E(IOST)="C"&('QFLG) S DIR(0)="E" D  D ^DIR K DIR
"RTN","RGMTHLP",77,0)
 .S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLP",78,0)
 K %,CNT,HDT,IEN,IEN0,JJ,LN,MSGID,PG,PRGBDT,PRGEDT,QFLG,REP,REPNM,RGBDT
"RTN","RGMTHLP",79,0)
 K RGDT,RGEDT,SITE,SS,STAT,STATCNT,STATNM,STOPDT,TOTCNT,TYPE,TYPECNT,X,Y,ZTSK
"RTN","RGMTHLP",80,0)
 W:$E(IOST)'="C" @IOF D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RGMTHLP",81,0)
 Q
"RTN","RGMTHLP",82,0)
 ;
"RTN","RGMTHLP",83,0)
HDR ;HEADER
"RTN","RGMTHLP",84,0)
 I $E(IOST)="C" S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLP",85,0)
 I $E(IOST)="C",PG>0 S DIR(0)="E" W ! D ^DIR K DIR I 'Y S QFLG=1 Q
"RTN","RGMTHLP",86,0)
 S PG=PG+1 W:$Y!($E(IOST)="C") @IOF
"RTN","RGMTHLP",87,0)
 W !,"MPI/PD HL7 MESSAGE STATUS REPORT - SUMMARY (",PRGBDT," to ",PRGEDT,")"
"RTN","RGMTHLP",88,0)
 W ?72,"Page: ",PG,!,"Printed at ",SITE," on ",HDT
"RTN","RGMTHLP",89,0)
 W !!,"RELATED EVENT PROTOCOL",!?23,"TRANSMISSION",!?4,"DATE",?27,"TYPE"
"RTN","RGMTHLP",90,0)
 W ?41,"STATUS",?69,"TOTAL",!,LN
"RTN","RGMTHLP",91,0)
 Q
"RTN","RGMTHLPD")
0^6^B27315485
"RTN","RGMTHLPD",1,0)
RGMTHLPD ;BIR/CML-MPI/PD HL7 MESSAGE STATUS REPORT (DETAILED) ;12/12/00
"RTN","RGMTHLPD",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**21**;30 Apr 99
"RTN","RGMTHLPD",3,0)
 ;
"RTN","RGMTHLPD",4,0)
 ;Reference to ^HL(771.6 supported by IA #2507
"RTN","RGMTHLPD",5,0)
 ;Reference to ^HL(772 supported by IA #3464
"RTN","RGMTHLPD",6,0)
 ;Reference to ^HLCS(870 supported by IA #2525
"RTN","RGMTHLPD",7,0)
 ;Reference to ^HLMA( supported by IA #3273
"RTN","RGMTHLPD",8,0)
 ;Reference to ^ORD(101 supported by IA #2596
"RTN","RGMTHLPD",9,0)
 ;
"RTN","RGMTHLPD",10,0)
BEGIN ; Produce DETAILED Report
"RTN","RGMTHLPD",11,0)
 W !!,"This option allows you to print information found during the ""Compile MPI/PD"
"RTN","RGMTHLPD",12,0)
 W !,"HL7 Data"" compilation. The report is sorted by RELATED EVENT PROTOCOL, date,"
"RTN","RGMTHLPD",13,0)
 W !,"transmission type, and status. Detailed information for each HL7 message is"
"RTN","RGMTHLPD",14,0)
 W !,"displayed."
"RTN","RGMTHLPD",15,0)
 ;
"RTN","RGMTHLPD",16,0)
PROT ;Ask for all or single PROTCOL
"RTN","RGMTHLPD",17,0)
 K DIR,DIRUT,DTOUT,DUOUT,REPNM
"RTN","RGMTHLPD",18,0)
 W !! S DIR(0)="SAM^A:ALL Protocols;S:Single Protocol;"
"RTN","RGMTHLPD",19,0)
 S DIR("A")="Do you want (A)ll or a (S)ingle Protocol:  "
"RTN","RGMTHLPD",20,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT I Y="A" G ASK1
"RTN","RGMTHLPD",21,0)
 S DIC="^ORD(101,",DIC(0)="QEAM"
"RTN","RGMTHLPD",22,0)
 S DIC("S")="S ORD=$P(^(0),""^"") I $D(^XTMP(""RGMT"",""HL"",ORD))"
"RTN","RGMTHLPD",23,0)
 D ^DIC K DIC G:Y<0 QUIT
"RTN","RGMTHLPD",24,0)
 S PROT=+Y,REPNM=$P(Y,"^",2)
"RTN","RGMTHLPD",25,0)
 ;
"RTN","RGMTHLPD",26,0)
ASK1 ;Ask for Date Range
"RTN","RGMTHLPD",27,0)
 W !!,"Enter date range for data to be included in report."
"RTN","RGMTHLPD",28,0)
 K DIR,DIRUT,DTOUT,DUOUT
"RTN","RGMTHLPD",29,0)
 S DIR(0)="DAO^:DT:EPX",DIR("A")="Beginning Date for Report:  "
"RTN","RGMTHLPD",30,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT
"RTN","RGMTHLPD",31,0)
 S RGBDT=Y,DIR(0)="DAO^"_RGBDT_":DT:EPX"
"RTN","RGMTHLPD",32,0)
 S DIR("A")="Ending Date for Report:  "
"RTN","RGMTHLPD",33,0)
 D ^DIR K DIR G:$D(DIRUT) QUIT S RGEDT=Y
"RTN","RGMTHLPD",34,0)
 ;
"RTN","RGMTHLPD",35,0)
DEV ;
"RTN","RGMTHLPD",36,0)
 W !!,"The right margin for this report is 132.",!!
"RTN","RGMTHLPD",37,0)
 S ZTSAVE("RGBDT")="",ZTSAVE("RGEDT")="",ZTSAVE("REPNM")=""
"RTN","RGMTHLPD",38,0)
 D EN^XUTMDEVQ("START^RGMTHLPD","MPI/PD - Print HL7 Message Status (DETAILED)") I 'POP Q
"RTN","RGMTHLPD",39,0)
 W !,"NO DEVICE SELECTED OR REPORT PRINTED!!"
"RTN","RGMTHLPD",40,0)
 G QUIT
"RTN","RGMTHLPD",41,0)
 ;
"RTN","RGMTHLPD",42,0)
START ;Print report
"RTN","RGMTHLPD",43,0)
 S (PG,QFLG)=0,U="^",$P(LN,"-",132)="",SITE=$P($$SITE^VASITE(),U,2)
"RTN","RGMTHLPD",44,0)
 S PRGBDT=$$FMTE^XLFDT(RGBDT),PRGEDT=$$FMTE^XLFDT(RGEDT)
"RTN","RGMTHLPD",45,0)
 D NOW^%DTC S HDT=$$FMTE^XLFDT($E(%,1,12))
"RTN","RGMTHLPD",46,0)
 D HDR
"RTN","RGMTHLPD",47,0)
 I $D(REPNM) W !!,REPNM,":" D LOOP G QUIT
"RTN","RGMTHLPD",48,0)
 S REPNM="@@@@"
"RTN","RGMTHLPD",49,0)
 F  S REPNM=$O(^XTMP("RGMT","HL",REPNM)) Q:REPNM=""  Q:QFLG  D
"RTN","RGMTHLPD",50,0)
 .D:$Y+3>IOSL HDR Q:QFLG
"RTN","RGMTHLPD",51,0)
 .W !!,REPNM,":" D LOOP
"RTN","RGMTHLPD",52,0)
 ;
"RTN","RGMTHLPD",53,0)
QUIT ;
"RTN","RGMTHLPD",54,0)
 I $E(IOST)="C"&('QFLG) S DIR(0)="E" D  D ^DIR K DIR
"RTN","RGMTHLPD",55,0)
 .S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLPD",56,0)
 K %,CNT,DFN,DIC,DIR,DIRUT,DTOUT,DUOUT,HDT,HLMADTPR,HLMAICN,HLMALINK,HLMALL,HLMAPROT,HLMASTAT,ICN,IEN
"RTN","RGMTHLPD",57,0)
 K IEN0,JJ,LN,PG,PRGBDT,PRGEDT,PROCDT,PROT,PTNM,QFLG,REP,REPNM,RGBDT,RGDT,RGEDT,SITE,SS,STAT
"RTN","RGMTHLPD",58,0)
 K STATNM,STOPDT,TXT,TYPE,X,Y,ZTSK
"RTN","RGMTHLPD",59,0)
 W:$E(IOST)'="C" @IOF D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@" Q
"RTN","RGMTHLPD",60,0)
 ;
"RTN","RGMTHLPD",61,0)
LOOP ;
"RTN","RGMTHLPD",62,0)
 S STOPDT=RGEDT_".9",CNT=0
"RTN","RGMTHLPD",63,0)
 S RGDT=RGBDT-.1
"RTN","RGMTHLPD",64,0)
 F  S RGDT=$O(^XTMP("RGMT","HL",REPNM,RGDT)) Q:'RGDT  Q:RGDT>STOPDT  Q:QFLG  D
"RTN","RGMTHLPD",65,0)
 .D:$Y+4>IOSL HDR Q:QFLG
"RTN","RGMTHLPD",66,0)
 .S TYPE=""
"RTN","RGMTHLPD",67,0)
 .F  S TYPE=$O(^XTMP("RGMT","HL",REPNM,RGDT,TYPE)) Q:TYPE=""  Q:QFLG  D
"RTN","RGMTHLPD",68,0)
 ..S STAT=""
"RTN","RGMTHLPD",69,0)
 ..F  S STAT=$O(^XTMP("RGMT","HL",REPNM,RGDT,TYPE,STAT)) Q:STAT=""  Q:QFLG  D
"RTN","RGMTHLPD",70,0)
 ...S IEN=0
"RTN","RGMTHLPD",71,0)
 ...F  S IEN=$O(^XTMP("RGMT","HL",REPNM,RGDT,TYPE,STAT,IEN)) Q:'IEN  Q:QFLG  D
"RTN","RGMTHLPD",72,0)
 ....D:$Y+3>IOSL HDR Q:QFLG  S CNT=CNT+1
"RTN","RGMTHLPD",73,0)
 ....W !!?3,$$FMTE^XLFDT($E(RGDT,1,12)),?18,$S(TYPE="O":"OUTGOING",1:"INCOMING"),?29,STAT
"RTN","RGMTHLPD",74,0)
 ....I '$D(^HL(772,IEN,0)) W ?96,"<<PURGED>>" Q
"RTN","RGMTHLPD",75,0)
 ....S PROCDT=$P($G(^HL(772,IEN,"P")),U,2),PROCDT=$$FMTE^XLFDT($E(PROCDT,1,12))
"RTN","RGMTHLPD",76,0)
 ....W ?61,PROCDT,?83,"^HL(772,",IEN
"RTN","RGMTHLPD",77,0)
 ....I REPNM="MPIF CMOR RESULT SERVER"&(TYPE="O") I $D(^HL(772,IEN,"IN",1,0)) D
"RTN","RGMTHLPD",78,0)
 .....S ICN=+$P(^HL(772,IEN,"IN",1,0),"^",3)
"RTN","RGMTHLPD",79,0)
 .....S DFN=$$GETDFN^MPIF001(ICN)
"RTN","RGMTHLPD",80,0)
 .....S PTNM="NO DFN" I DFN S PTNM=$P(^DPT(DFN,0),"^")
"RTN","RGMTHLPD",81,0)
 .....W !?6,"ICN: ",ICN,"   NAME: ",PTNM
"RTN","RGMTHLPD",82,0)
 ....S HLMAIEN=0
"RTN","RGMTHLPD",83,0)
 ....F  S HLMAIEN=$O(^HLMA("B",IEN,HLMAIEN)) Q:'HLMAIEN  Q:QFLG  D
"RTN","RGMTHLPD",84,0)
 .....S HLMASTAT=$P(^HL(771.6,($P(^HLMA(HLMAIEN,"P"),"^")),0),"^")
"RTN","RGMTHLPD",85,0)
 .....S HLMADTPR="" I $D(^HLMA(HLMAIEN,"S")) S HLMADTPR=$$FMTE^XLFDT($E($P(^HLMA(HLMAIEN,"S"),"^"),1,12))
"RTN","RGMTHLPD",86,0)
 .....S HLMAPROT=$P(^ORD(101,$P(^HLMA(HLMAIEN,0),"^",8),0),"^")
"RTN","RGMTHLPD",87,0)
 .....S HLMALL=$P(^HLMA(HLMAIEN,0),"^",7)
"RTN","RGMTHLPD",88,0)
 .....S HLMALINK=$P(^HLCS(870,HLMALL,0),"^")
"RTN","RGMTHLPD",89,0)
 .....D:$Y+3>IOSL HDR Q:QFLG
"RTN","RGMTHLPD",90,0)
 .....W !?6,"=>^HLMA(",HLMAIEN,?29,HLMASTAT,?61,HLMADTPR,?83,HLMAPROT,?116,HLMALINK
"RTN","RGMTHLPD",91,0)
 W !!?110,"TOTAL: ",CNT
"RTN","RGMTHLPD",92,0)
 Q
"RTN","RGMTHLPD",93,0)
 ;
"RTN","RGMTHLPD",94,0)
HDR ;HEADER
"RTN","RGMTHLPD",95,0)
 I $E(IOST)="C" S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTHLPD",96,0)
 I $E(IOST)="C",PG>0 S DIR(0)="E" W ! D ^DIR K DIR I 'Y S QFLG=1 Q
"RTN","RGMTHLPD",97,0)
 S PG=PG+1 W:$Y!($E(IOST)="C") @IOF
"RTN","RGMTHLPD",98,0)
 W !,"MPI/PD HL7 MESSAGE STATUS REPORT - DETAILED (",PRGBDT," to ",PRGEDT,")"
"RTN","RGMTHLPD",99,0)
 W ?117,"Page: ",PG,!,"Printed at ",SITE," on ",HDT
"RTN","RGMTHLPD",100,0)
 W !!,"RELATED EVENT PROTOCOL",!?3,"DATE",?18,"TYPE",?29,"STATUS IN FILE #772"
"RTN","RGMTHLPD",101,0)
 W ?61,"DATE PROCESSED",?83,"FILE #772 IEN"
"RTN","RGMTHLPD",102,0)
 W !?6,"=>FILE #773 ENTRY",?29,"STATUS IN FILE #773",?61,"DATE PROCESSED"
"RTN","RGMTHLPD",103,0)
 W ?83,"PROTOCOL",?116,"LOGICAL LINK",!,LN
"RTN","RGMTHLPD",104,0)
 Q
"RTN","RGMTHLPD",105,0)
 ;
"RTN","RGMTHLPD",106,0)
REPROC ;reprocess entries in xtmp global ^XTMP("REPROC"
"RTN","RGMTHLPD",107,0)
 S CNT=0
"RTN","RGMTHLPD",108,0)
 S HLMALINK=""
"RTN","RGMTHLPD",109,0)
 F  S HLMALINK=$O(^XTMP("REPROC",HLMALINK)) Q:HLMALINK=""  D
"RTN","RGMTHLPD",110,0)
 .S HLMAIEN=0
"RTN","RGMTHLPD",111,0)
 .F  S HLMAIEN=$O(^XTMP("REPROC",HLMALINK,HLMAIEN)) Q:'HLMAIEN  D
"RTN","RGMTHLPD",112,0)
 ..S CNT=CNT+1
"RTN","RGMTHLPD",113,0)
 W !!,CNT," messages to attempt to process."
"RTN","RGMTHLPD",114,0)
 ;
"RTN","RGMTHLPD",115,0)
 S CNT=0
"RTN","RGMTHLPD",116,0)
 S HLMALINK=""
"RTN","RGMTHLPD",117,0)
 F  S HLMALINK=$O(^XTMP("REPROC",HLMALINK)) Q:HLMALINK=""  D
"RTN","RGMTHLPD",118,0)
 .S HLMAIEN=0
"RTN","RGMTHLPD",119,0)
 .F  S HLMAIEN=$O(^XTMP("REPROC",HLMALINK,HLMAIEN)) Q:'HLMAIEN  D
"RTN","RGMTHLPD",120,0)
 ..S RGRTN=$G(^ORD(101,PROT,771))
"RTN","RGMTHLPD",121,0)
 ..I '$$REPROC^HLUTIL(HLMAIEN,RGRTN) S CNT=CNT+1
"RTN","RGMTHLPD",122,0)
 W !!,CNT," messages successfully processed."
"RTN","RGMTHLPD",123,0)
 K CNT,HLMALINK,HLMAIEN,RGRTN
"RTN","RGMTHLPD",124,0)
 Q
"RTN","RGPOC")
0^1^B35170559
"RTN","RGPOC",1,0)
RGPOC ;BIR/PTD-ADD/EDIT POINT OF CONTACT OPTION ;8/22/01
"RTN","RGPOC",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**21**;30 Apr 99
"RTN","RGPOC",3,0)
 ;Reference to ^VA(200, supported by IA #2589
"RTN","RGPOC",4,0)
 ;Reference to LINK^HLUTIL3 and $$GET1^DIQ(870 supported by IA #3335
"RTN","RGPOC",5,0)
 ;
"RTN","RGPOC",6,0)
INTRO ;Introduction to Option
"RTN","RGPOC",7,0)
 W @IOF,!,"This option allows you to transmit information to the MPI/PD Data"
"RTN","RGPOC",8,0)
 W !,"Management team so that the Point of Contact website can be updated."
"RTN","RGPOC",9,0)
 W !!,"To obtain a list of MPI/PD Points of Contact for each facility,"
"RTN","RGPOC",10,0)
 W !,"look for the POC web link on the MPI/PD Home Page."
"RTN","RGPOC",11,0)
 W !!,"The COMMERCIAL PHONE (#.135) field in the NEW PERSON (#200) file"
"RTN","RGPOC",12,0)
 W !,"will only accept numbers and punctuation, 4-20 characters."
"RTN","RGPOC",13,0)
 W !!,"Please include the entire phone number:",!,"area code, 7 digit number and extension (e.g., AAA NNN NNNN XXXX)"
"RTN","RGPOC",14,0)
 W !!,"A contact name without a phone number will NOT be transmitted."
"RTN","RGPOC",15,0)
 W !,"                                           ==="
"RTN","RGPOC",16,0)
 ;
"RTN","RGPOC",17,0)
ASK ;Select POC to add/edit.
"RTN","RGPOC",18,0)
 W ! K DIR S DIR(0)="LA^1:7"
"RTN","RGPOC",19,0)
 S DIR("A")="Which Point of Contact information do you wish to update? "
"RTN","RGPOC",20,0)
 S DIR("A",1)="Select one or more of the following:"
"RTN","RGPOC",21,0)
 S DIR("A",2)="(A list or range of numbers can be entered, e.g., 1,3 or 2-4,6.)"
"RTN","RGPOC",22,0)
 S DIR("A",3)=""
"RTN","RGPOC",23,0)
 S DIR("A",4)="    1 - Admin POC     2 - Alt Admin POC     3 - IRM POC     4 - Alt IRM POC"
"RTN","RGPOC",24,0)
 S DIR("A",5)="    5 - HL7 POC       6 - Alt HL7 POC       7 - ALL POCs"
"RTN","RGPOC",25,0)
 S DIR("A",6)=""
"RTN","RGPOC",26,0)
 S DIR("B")="7"
"RTN","RGPOC",27,0)
 S DIR("?",1)="Enter:"
"RTN","RGPOC",28,0)
 S DIR("?",2)=" ""1"" to add/edit Administrative Point of Contact."
"RTN","RGPOC",29,0)
 S DIR("?",3)=" ""2"" to add/edit Alternate Administrative Point of Contact."
"RTN","RGPOC",30,0)
 S DIR("?",4)=" ""3"" to add/edit IRM Point of Contact."
"RTN","RGPOC",31,0)
 S DIR("?",5)=" ""4"" to add/edit Alternate IRM Point of Contact."
"RTN","RGPOC",32,0)
 S DIR("?",6)=" ""5"" to add/edit Health Level Seven Point of Contact."
"RTN","RGPOC",33,0)
 S DIR("?",7)=" ""6"" to add/edit Alternate Health Level Seven Point of Contact."
"RTN","RGPOC",34,0)
 S DIR("?",8)=" ""7"" to add/edit ALL Points of Contact."
"RTN","RGPOC",35,0)
 S DIR("?")=" You can enter a list or range of numbers, e.g., 1,3,5 or 1-3,6."
"RTN","RGPOC",36,0)
 D ^DIR G:$D(DIRUT) END S RGANS=$S(Y[7:7,1:Y)
"RTN","RGPOC",37,0)
 ;
"RTN","RGPOC",38,0)
MAIN ;Direct flow based on variable RGANS.
"RTN","RGPOC",39,0)
 S RGQUIT=0
"RTN","RGPOC",40,0)
 I RGANS["1" D POC1^RGPOC1
"RTN","RGPOC",41,0)
 I RGANS["2" D POC2^RGPOC1
"RTN","RGPOC",42,0)
 I RGANS["3" D POC3^RGPOC1
"RTN","RGPOC",43,0)
 I RGANS["4" D POC4^RGPOC1
"RTN","RGPOC",44,0)
 I RGANS["5" D POC5^RGPOC1
"RTN","RGPOC",45,0)
 I RGANS["6" D POC6^RGPOC1
"RTN","RGPOC",46,0)
 I RGANS="7" S (RGADMOFN,RGAD2OFN,RGIRMOFN,RGIR2OFN,RGHL7OFN)="" D
"RTN","RGPOC",47,0)
 .D POC1^RGPOC1 Q:RGADMONM=-1  Q:RGADMOFN=-1
"RTN","RGPOC",48,0)
 .D POC2^RGPOC1 Q:RGAD2ONM=-1  Q:RGAD2OFN=-1
"RTN","RGPOC",49,0)
 .D POC3^RGPOC1 Q:RGIRMONM=-1  Q:RGIRMOFN=-1
"RTN","RGPOC",50,0)
 .D POC4^RGPOC1 Q:RGIR2ONM=-1  Q:RGIR2OFN=-1
"RTN","RGPOC",51,0)
 .D POC5^RGPOC1 Q:RGHL7ONM=-1  Q:RGHL7OFN=-1
"RTN","RGPOC",52,0)
 .D POC6^RGPOC1
"RTN","RGPOC",53,0)
 D SEND
"RTN","RGPOC",54,0)
AGAIN ;Return to selection prompt?
"RTN","RGPOC",55,0)
 I RGQUIT=1 D END Q
"RTN","RGPOC",56,0)
 W ! K DIR S DIR(0)="Y",DIR("B")="NO",DIR("A")="Do you want to add/edit another contact"
"RTN","RGPOC",57,0)
 D ^DIR I +Y=1 D END W @IOF G ASK
"RTN","RGPOC",58,0)
 D END
"RTN","RGPOC",59,0)
 Q
"RTN","RGPOC",60,0)
 ;
"RTN","RGPOC",61,0)
SEND ;Send message to Data Management Team
"RTN","RGPOC",62,0)
 Q:'$O(RGARRAY(0))
"RTN","RGPOC",63,0)
 ;Display changed fields.
"RTN","RGPOC",64,0)
 W @IOF,!,"The following data will be transmitted to the MPI/PD Data Management team.",!
"RTN","RGPOC",65,0)
 S RGNUM=0
"RTN","RGPOC",66,0)
 F  S RGNUM=$O(RGARRAY(RGNUM)) Q:'RGNUM  W !,RGARRAY(RGNUM)
"RTN","RGPOC",67,0)
 ;
"RTN","RGPOC",68,0)
DOMAIN ;Determine test or production account (production must have
"RTN","RGPOC",69,0)
 ;"MPI-AUSTIN.VA.GOV" domain for logical link "MPIVA").
"RTN","RGPOC",70,0)
 ;Get logical link IEN for "MPIVA".
"RTN","RGPOC",71,0)
 ;Get domain for "MPIVA" logical link in HL LOGICAL LINK (#870) file.
"RTN","RGPOC",72,0)
 N RGDOMAIN S RGDOMAIN=""
"RTN","RGPOC",73,0)
 D LINK^HLUTIL3("200M",.HLL,"I")
"RTN","RGPOC",74,0)
 S IEN=$O(HLL(0)) I +IEN>0 S RGDOMAIN=$$GET1^DIQ(870,+IEN_",",.03)
"RTN","RGPOC",75,0)
 I RGDOMAIN="" Q
"RTN","RGPOC",76,0)
 I RGDOMAIN'="MPI-AUSTIN.VA.GOV" W !!,"No data will be transmitted from a TEST account." Q  ;Not production; quit SEND.
"RTN","RGPOC",77,0)
 I RGDOMAIN="MPI-AUSTIN.VA.GOV" S XMY("G.MPI/PD POC UPDATE@MPI-AUSTIN.VA.GOV")=""
"RTN","RGPOC",78,0)
 ;
"RTN","RGPOC",79,0)
 ;Transmit e-mail message.
"RTN","RGPOC",80,0)
 S XMSUB="POINT OF CONTACT CHANGE - SITE "_$P($$SITE^VASITE(),"^",3)
"RTN","RGPOC",81,0)
 S XMDUZ=DUZ ;name of person editing the option
"RTN","RGPOC",82,0)
 S XMTEXT="RGARRAY("
"RTN","RGPOC",83,0)
 ;
"RTN","RGPOC",84,0)
 S RGARRAY(1)="There has been a change in the point of contact information from"
"RTN","RGPOC",85,0)
 S RGARRAY(2)=$P($$SITE^VASITE(),"^",2)_" (station number "_$P($$SITE^VASITE(),"^",3)_")."
"RTN","RGPOC",86,0)
 S RGARRAY(3)=""
"RTN","RGPOC",87,0)
 D ^XMD
"RTN","RGPOC",88,0)
 W !!,"Sending information to the MPI/PD Data Management team now.",!
"RTN","RGPOC",89,0)
 Q
"RTN","RGPOC",90,0)
 ;
"RTN","RGPOC",91,0)
END ;Kill variables 
"RTN","RGPOC",92,0)
 K DA,DIC,DIE,DIR,DIRUT,DR,DTOUT,HLL,IEN,RGAD2NFN,RGAD2NNM,RGAD2OFN,RGAD2ONM,RGADMNFN
"RTN","RGPOC",93,0)
 K RGADMNNM,RGADMOFN,RGADMONM,RGANS,RGARRAY,RGDATA,RGDOMAIN,RGHL2NFN,RGHL2NNM,RGHL2OFN
"RTN","RGPOC",94,0)
 K RGHL2ONM,RGHL7NFN,RGHL7NNM,RGHL7OFN,RGHL7ONM,RGIR2NFN,RGIR2NNM,RGIR2OFN,RGIR2ONM
"RTN","RGPOC",95,0)
 K RGIRMNFN,RGIRMNNM,RGIRMOFN,RGIRMONM,RGNUM,RGQUIT,X,XMDUZ,XMSUB,XMTEXT,XMY,Y
"RTN","RGPOC",96,0)
 Q
"RTN","RGPOC",97,0)
 ;
"RTN","RGPOC",98,0)
NAME(RGPC,RGFLD) ;Edit IEN of POC from CIRN SITE PARAMETER (#991.8) file.
"RTN","RGPOC",99,0)
 ;RGPC -  piece number of POC on the ^RGSITE(991.8,1,"POC" node
"RTN","RGPOC",100,0)
 ;RGFLD - field number of POC to be used in the DR string
"RTN","RGPOC",101,0)
 ;Returns POC IEN before edit^POC IEN after edit OR -1^error message
"RTN","RGPOC",102,0)
 ;
"RTN","RGPOC",103,0)
 N RGOLDNAM,RGNEWNAM
"RTN","RGPOC",104,0)
 S RGOLDNAM=$P($G(^RGSITE(991.8,1,"POC")),"^",RGPC)
"RTN","RGPOC",105,0)
 L +^RGSITE(991.8):10
"RTN","RGPOC",106,0)
 S DIE="^RGSITE(991.8,",DA=1,DR=RGFLD
"RTN","RGPOC",107,0)
 D ^DIE K DA,DIE,DR
"RTN","RGPOC",108,0)
 L -^RGSITE(991.8)
"RTN","RGPOC",109,0)
 I $D(DTOUT)&(RGOLDNAM="") Q "-1^USER TIMED OUT"
"RTN","RGPOC",110,0)
 I $D(Y) Q "-1^USER UP-ARROWED OUT"
"RTN","RGPOC",111,0)
 S RGNEWNAM=$P($G(^RGSITE(991.8,1,"POC")),"^",RGPC)
"RTN","RGPOC",112,0)
 Q RGOLDNAM_"^"_RGNEWNAM
"RTN","RGPOC",113,0)
 ;
"RTN","RGPOC",114,0)
PHONE(RGIEN) ;Edit POC COMMERCIAL PHONE (#.135) from NEW PERSON (#200) file.
"RTN","RGPOC",115,0)
 ;Supported IA #10060 allows read/FileMan for all fields in ^VA(200
"RTN","RGPOC",116,0)
 ;RGIEN - IEN for NEW PERSON for whom phone number is needed
"RTN","RGPOC",117,0)
 ;Returns POC COMMERCIAL PHONE before edit^POC COMMERCIAL PHONE after edit
"RTN","RGPOC",118,0)
 ;
"RTN","RGPOC",119,0)
 N RGOLDFON,RGNEWFON
"RTN","RGPOC",120,0)
 S RGOLDFON=$$GET1^DIQ(200,RGIEN,.135)
"RTN","RGPOC",121,0)
 S RGOLDFON=$TR(RGOLDFON,",./<>?;:'[]\{}|`~!@#$%^&*-_=+","                              ")
"RTN","RGPOC",122,0)
 S RGOLDFON=$TR(RGOLDFON,"()","")
"RTN","RGPOC",123,0)
 ;Edit COMMERCIAL PHONE (#.135), NEW PERSON (#200) file
"RTN","RGPOC",124,0)
 ;IA #2589 allows write/FileMan to field .135 in ^VA(200,
"RTN","RGPOC",125,0)
 L +^VA(200,RGIEN):10
"RTN","RGPOC",126,0)
 S DIE="^VA(200,",DA=RGIEN,DR=.135
"RTN","RGPOC",127,0)
 D ^DIE K DA,DIE,DR
"RTN","RGPOC",128,0)
 L -^VA(200,RGIEN)
"RTN","RGPOC",129,0)
 I $D(DTOUT)&(RGOLDFON="") Q "-1^USER TIMED OUT"
"RTN","RGPOC",130,0)
 I $D(Y) Q "-1^USER UP-ARROWED OUT"
"RTN","RGPOC",131,0)
 S RGNEWFON=$$GET1^DIQ(200,RGIEN,.135)
"RTN","RGPOC",132,0)
 S RGNEWFON=$TR(RGNEWFON,",./<>?;:'[]\{}|`~!@#$%^&*-_=+","                             ")
"RTN","RGPOC",133,0)
 S RGNEWFON=$TR(RGNEWFON,"()","")
"RTN","RGPOC",134,0)
 Q RGOLDFON_"^"_RGNEWFON
"RTN","RGPOC",135,0)
 ;
"RTN","RGPOC",136,0)
CNVRTNM(NAME) ;Convert IEN from NEW PERSON (#200) to printable name
"RTN","RGPOC",137,0)
 ;NAME - ien for POC
"RTN","RGPOC",138,0)
 N RGNAME
"RTN","RGPOC",139,0)
 I NAME="" Q "<NULL>"
"RTN","RGPOC",140,0)
 S RGNAME=$$GET1^DIQ(200,NAME,.01)
"RTN","RGPOC",141,0)
 Q RGNAME
"RTN","RGPOC",142,0)
 ;
"RTN","RGPOC",143,0)
ERROR1(RGPOC) ;Write error message 1 for type POC.
"RTN","RGPOC",144,0)
 W !!,"No "_RGPOC_" Point of Contact identified."
"RTN","RGPOC",145,0)
 Q
"RTN","RGPOC",146,0)
 ;
"RTN","RGPOC",147,0)
ERROR2(RGPOC,RGFLD,RGOLDNAM,RGNEWNAM) ;Write error message 2 for type POC.
"RTN","RGPOC",148,0)
 W !!,"No "_RGPOC_" Point of Contact phone number identified."
"RTN","RGPOC",149,0)
 ;User timed out or up-arrowed out on phone number.
"RTN","RGPOC",150,0)
 ;Restore name value to original value, if value changed.
"RTN","RGPOC",151,0)
 I RGOLDNAM=RGNEWNAM K RGFLD,RGOLDNAM,RGNEWNAM,RGPOC Q
"RTN","RGPOC",152,0)
 L +^RGSITE(991.8):10
"RTN","RGPOC",153,0)
 S DIE="^RGSITE(991.8,",DA=1,DR=RGFLD_"///^S X=$S(RGOLDNAM="""":""@"",1:RGOLDNAM)"
"RTN","RGPOC",154,0)
 D ^DIE
"RTN","RGPOC",155,0)
 L -^RGSITE(991.8)
"RTN","RGPOC",156,0)
 K DA,DIE,DR,RGFLD,RGOLDNAM
"RTN","RGPOC",157,0)
 W !,RGPOC_" Point of Contact restored to original value."
"RTN","RGPOC",158,0)
 Q
"RTN","RGPOC",159,0)
 ;
"RTN","RGPOC1")
0^7^B28161535
"RTN","RGPOC1",1,0)
RGPOC1 ;BIR/PTD-ADD/EDIT POINT OF CONTACT OPTION - CONTINUED ;8/22/01
"RTN","RGPOC1",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**21**;30 Apr 99
"RTN","RGPOC1",3,0)
 ;
"RTN","RGPOC1",4,0)
POC1 ;ADMIN POINT OF CONTACT from CIRN SITE PARAMETER (#991.8) file.
"RTN","RGPOC1",5,0)
 W ! K RGDATA S RGDATA=$$NAME^RGPOC(1,50)
"RTN","RGPOC1",6,0)
 S RGADMONM=$P($G(RGDATA),"^") I RGADMONM=-1 D ERROR1^RGPOC("ADM") S RGQUIT=1 Q
"RTN","RGPOC1",7,0)
 S RGADMNNM=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",8,0)
 I RGADMONM'="",RGADMNNM="" S RGARRAY(10)="Admin Point of Contact Name: <DELETE EXISTING DATA>",RGARRAY(11)="" Q
"RTN","RGPOC1",9,0)
 I RGADMNNM="" D ERROR1^RGPOC("ADM") Q
"RTN","RGPOC1",10,0)
 S RGARRAY(10)="Admin Point of Contact Name: "_$$CNVRTNM^RGPOC(RGADMNNM)
"RTN","RGPOC1",11,0)
 K RGDATA S RGDATA=$$PHONE^RGPOC(+RGADMNNM)
"RTN","RGPOC1",12,0)
 S RGADMOFN=$P($G(RGDATA),"^") I RGADMOFN=-1 D ERROR2^RGPOC("ADM",50,RGADMONM,RGADMNNM) K RGARRAY(10) S RGQUIT=1 Q
"RTN","RGPOC1",13,0)
 S RGADMNFN=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",14,0)
 I RGADMNFN="" D ERROR2^RGPOC("ADM",50,RGADMONM,RGADMNNM) K RGARRAY(10) Q
"RTN","RGPOC1",15,0)
 I ($TR(RGADMNFN," ","")=$TR(RGADMOFN," ",""))&(RGADMNNM=RGADMONM) K RGARRAY(10) Q
"RTN","RGPOC1",16,0)
 S RGARRAY(11)="Admin Point of Contact Phone #: "_RGADMNFN
"RTN","RGPOC1",17,0)
 S RGARRAY(12)=""
"RTN","RGPOC1",18,0)
 Q
"RTN","RGPOC1",19,0)
 ;
"RTN","RGPOC1",20,0)
POC2 ;ALTERNATE ADMIN POINT OF CONTACT from CIRN SITE PARAMETER (#991.8) file.
"RTN","RGPOC1",21,0)
 W ! K RGDATA S RGDATA=$$NAME^RGPOC(4,53)
"RTN","RGPOC1",22,0)
 S RGAD2ONM=$P($G(RGDATA),"^") I RGAD2ONM=-1 D ERROR1^RGPOC("ALT ADM") S RGQUIT=1 Q
"RTN","RGPOC1",23,0)
 S RGAD2NNM=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",24,0)
 I RGAD2ONM'="",RGAD2NNM="" S RGARRAY(20)="Alt Admin Point of Contact Name: <DELETE EXISTING DATA>",RGARRAY(21)="" Q
"RTN","RGPOC1",25,0)
 I RGAD2NNM="" D ERROR1^RGPOC("ALT ADM") Q
"RTN","RGPOC1",26,0)
 S RGARRAY(20)="Alt Admin Point of Contact Name: "_$$CNVRTNM^RGPOC(RGAD2NNM)
"RTN","RGPOC1",27,0)
 K RGDATA S RGDATA=$$PHONE^RGPOC(+RGAD2NNM)
"RTN","RGPOC1",28,0)
 S RGAD2OFN=$P($G(RGDATA),"^") I RGAD2OFN=-1 D ERROR2^RGPOC("ADM",53,RGAD2ONM,RGAD2NNM) K RGARRAY(20) S RGQUIT=1 Q
"RTN","RGPOC1",29,0)
 S RGAD2NFN=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",30,0)
 I RGAD2NFN="" D ERROR2^RGPOC("ADM",53,RGAD2ONM,RGAD2NNM) K RGARRAY(20) Q
"RTN","RGPOC1",31,0)
 I ($TR(RGAD2NFN," ","")=$TR(RGAD2OFN," ",""))&(RGAD2NNM=RGAD2ONM) K RGARRAY(20) Q
"RTN","RGPOC1",32,0)
 S RGARRAY(21)="Alt Admin Point of Contact Phone #: "_RGAD2NFN
"RTN","RGPOC1",33,0)
 S RGARRAY(22)=""
"RTN","RGPOC1",34,0)
 Q
"RTN","RGPOC1",35,0)
 ;
"RTN","RGPOC1",36,0)
POC3 ;IRM POINT OF CONTACT from CIRN SITE PARAMETER (#991.8) file.
"RTN","RGPOC1",37,0)
 W ! K RGDATA S RGDATA=$$NAME^RGPOC(2,51)
"RTN","RGPOC1",38,0)
 S RGIRMONM=$P($G(RGDATA),"^") I RGIRMONM=-1 D ERROR1^RGPOC("IRM") S RGQUIT=1 Q
"RTN","RGPOC1",39,0)
 S RGIRMNNM=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",40,0)
 I RGIRMONM'="",RGIRMNNM="" S RGARRAY(30)="IRM Point of Contact Name: <DELETE EXISTING DATA>",RGARRAY(31)="" Q
"RTN","RGPOC1",41,0)
 I RGIRMNNM="" D ERROR1^RGPOC("IRM") Q
"RTN","RGPOC1",42,0)
 S RGARRAY(30)="IRM Point of Contact Name: "_$$CNVRTNM^RGPOC(RGIRMNNM)
"RTN","RGPOC1",43,0)
 K RGDATA S RGDATA=$$PHONE^RGPOC(+RGIRMNNM)
"RTN","RGPOC1",44,0)
 S RGIRMOFN=$P($G(RGDATA),"^") I RGIRMOFN=-1 D ERROR2^RGPOC("IRM",51,RGIRMONM,RGIRMNNM) K RGARRAY(30) S RGQUIT=1 Q
"RTN","RGPOC1",45,0)
 S RGIRMNFN=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",46,0)
 I RGIRMNFN="" D ERROR2^RGPOC("IRM",51,RGIRMONM,RGIRMNNM) K RGARRAY(30) Q
"RTN","RGPOC1",47,0)
 I ($TR(RGIRMNFN," ","")=$TR(RGIRMOFN," ",""))&(RGIRMNNM=RGIRMONM) K RGARRAY(30) Q
"RTN","RGPOC1",48,0)
 S RGARRAY(31)="IRM Point of Contact Phone #: "_RGIRMNFN
"RTN","RGPOC1",49,0)
 S RGARRAY(32)=""
"RTN","RGPOC1",50,0)
 Q
"RTN","RGPOC1",51,0)
 ;
"RTN","RGPOC1",52,0)
POC4 ;ALTERNATE IRM POINT OF CONTACT from CIRN SITE PARAMETER (#991.8) file.
"RTN","RGPOC1",53,0)
 W ! K RGDATA S RGDATA=$$NAME^RGPOC(5,54)
"RTN","RGPOC1",54,0)
 S RGIR2ONM=$P($G(RGDATA),"^") I RGIR2ONM=-1 D ERROR1^RGPOC("ALT IRM") S RGQUIT=1 Q
"RTN","RGPOC1",55,0)
 S RGIR2NNM=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",56,0)
 I RGIR2ONM'="",RGIR2NNM="" S RGARRAY(40)="Alt IRM Point of Contact Name: <DELETE EXISTING DATA>",RGARRAY(41)="" Q
"RTN","RGPOC1",57,0)
 I RGIR2NNM="" D ERROR1^RGPOC("ALT IRM") Q
"RTN","RGPOC1",58,0)
 S RGARRAY(40)="Alt IRM Point of Contact Name: "_$$CNVRTNM^RGPOC(RGIR2NNM)
"RTN","RGPOC1",59,0)
 K RGDATA S RGDATA=$$PHONE^RGPOC(+RGIR2NNM)
"RTN","RGPOC1",60,0)
 S RGIR2OFN=$P($G(RGDATA),"^") I RGIR2OFN=-1 D ERROR2^RGPOC("ALT IRM",54,RGIR2ONM,RGIR2NNM) K RGARRAY(40) S RGQUIT=1 Q
"RTN","RGPOC1",61,0)
 S RGIR2NFN=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",62,0)
 I RGIR2NFN="" D ERROR2^RGPOC("ALT IRM",54,RGIR2ONM,RGIR2NNM) K RGARRAY(40) Q
"RTN","RGPOC1",63,0)
 I ($TR(RGIR2NFN," ","")=$TR(RGIR2OFN," ",""))&(RGIR2NNM=RGIR2ONM) K RGARRAY(40) Q
"RTN","RGPOC1",64,0)
 S RGARRAY(41)="Alt IRM Point of Contact Phone #: "_RGIR2NFN
"RTN","RGPOC1",65,0)
 S RGARRAY(42)=""
"RTN","RGPOC1",66,0)
 Q
"RTN","RGPOC1",67,0)
 ;
"RTN","RGPOC1",68,0)
POC5 ;HL7 POINT OF CONTACT from CIRN SITE PARAMETER (#991.8) file.
"RTN","RGPOC1",69,0)
 W ! K RGDATA S RGDATA=$$NAME^RGPOC(3,52)
"RTN","RGPOC1",70,0)
 S RGHL7ONM=$P($G(RGDATA),"^") I RGHL7ONM=-1 D ERROR1^RGPOC("HL7") S RGQUIT=1 Q
"RTN","RGPOC1",71,0)
 S RGHL7NNM=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",72,0)
 I RGHL7ONM'="",RGHL7NNM="" S RGARRAY(50)="HL7 Point of Contact Name: <DELETE EXISTING DATA>",RGARRAY(51)="" Q
"RTN","RGPOC1",73,0)
 I RGHL7NNM="" D ERROR1^RGPOC("HL7") Q
"RTN","RGPOC1",74,0)
 S RGARRAY(50)="HL7 Point of Contact Name: "_$$CNVRTNM^RGPOC(RGHL7NNM)
"RTN","RGPOC1",75,0)
 K RGDATA S RGDATA=$$PHONE^RGPOC(+RGHL7NNM)
"RTN","RGPOC1",76,0)
 S RGHL7OFN=$P($G(RGDATA),"^") I RGHL7OFN=-1 D ERROR2^RGPOC("HL7",52,RGHL7ONM,RGHL7NNM) K RGARRAY(50) S RGQUIT=1 Q
"RTN","RGPOC1",77,0)
 S RGHL7NFN=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",78,0)
 I RGHL7NFN="" D ERROR2^RGPOC("HL7",52,RGHL7ONM,RGHL7NNM) K RGARRAY(50) Q
"RTN","RGPOC1",79,0)
 I ($TR(RGHL7NFN," ","")=$TR(RGHL7OFN," ",""))&(RGHL7NNM=RGHL7ONM) K RGARRAY(50) Q
"RTN","RGPOC1",80,0)
 S RGARRAY(51)="HL7 Point of Contact Phone #: "_RGHL7NFN
"RTN","RGPOC1",81,0)
 S RGARRAY(52)=""
"RTN","RGPOC1",82,0)
 Q
"RTN","RGPOC1",83,0)
 ;
"RTN","RGPOC1",84,0)
POC6 ;ALTERNATE HL7 POINT OF CONTACT from CIRN SITE PARAMETER (#991.8) file.
"RTN","RGPOC1",85,0)
 W ! K RGDATA S RGDATA=$$NAME^RGPOC(6,55)
"RTN","RGPOC1",86,0)
 S RGHL2ONM=$P($G(RGDATA),"^") I RGHL2ONM=-1 D ERROR1^RGPOC("ALT HL7") S RGQUIT=1 Q
"RTN","RGPOC1",87,0)
 S RGHL2NNM=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",88,0)
 I RGHL2ONM'="",RGHL2NNM="" S RGARRAY(60)="Alt HL7 Point of Contact Name: <DELETE EXISTING DATA>",RGARRAY(61)="" Q
"RTN","RGPOC1",89,0)
 I RGHL2NNM="" D ERROR1^RGPOC("ALT HL7") Q
"RTN","RGPOC1",90,0)
 S RGARRAY(60)="Alt HL7 Point of Contact Name: "_$$CNVRTNM^RGPOC(RGHL2NNM)
"RTN","RGPOC1",91,0)
 K RGDATA S RGDATA=$$PHONE^RGPOC(+RGHL2NNM)
"RTN","RGPOC1",92,0)
 S RGHL2OFN=$P($G(RGDATA),"^") I RGHL2OFN=-1 D ERROR2^RGPOC("ALT HL7",55,RGHL2ONM,RGHL2NNM) K RGARRAY(60) S RGQUIT=1 Q
"RTN","RGPOC1",93,0)
 S RGHL2NFN=$P($G(RGDATA),"^",2)
"RTN","RGPOC1",94,0)
 I RGHL2NFN="" D ERROR2^RGPOC("ALT HL7",55,RGHL2ONM,RGHL2NNM) K RGARRAY(60) Q
"RTN","RGPOC1",95,0)
 I ($TR(RGHL2NFN," ","")=$TR(RGHL2OFN," ",""))&(RGHL2NNM=RGHL2ONM) K RGARRAY(60) Q
"RTN","RGPOC1",96,0)
 S RGARRAY(61)="Alt HL7 Point of Contact Phone #: "_RGHL2NFN
"RTN","RGPOC1",97,0)
 Q
"RTN","RGPOC1",98,0)
 ;
"VER")
8.0^22.0
"^DD",991.8,991.8,50,0)
ADMIN POINT OF CONTACT^P200'^VA(200,^POC;1^Q
"^DD",991.8,991.8,50,.1)
Administrative Point of Contact
"^DD",991.8,991.8,50,3)
Enter the administrative point of contact name for MPI/PD.
"^DD",991.8,991.8,50,21,0)
^^7^7^3011010^
"^DD",991.8,991.8,50,21,1,0)
The ADMIN POINT OF CONTACT field contains the name of the individual
"^DD",991.8,991.8,50,21,2,0)
at the facility who is in a position to resolve patient issues for
"^DD",991.8,991.8,50,21,3,0)
Master Patient Index/Patient Demographics.  
"^DD",991.8,991.8,50,21,4,0)
  
"^DD",991.8,991.8,50,21,5,0)
This field is populated using the Add/Edit Point of Contact [RG UPDATE
"^DD",991.8,991.8,50,21,6,0)
POINT OF CONTACT] option.  The information is sent to a remote mail 
"^DD",991.8,991.8,50,21,7,0)
group whose members maintain the point of contact list on the website.
"^DD",991.8,991.8,50,"DT")
3011010
"^DD",991.8,991.8,51,0)
IRM POINT OF CONTACT^P200'^VA(200,^POC;2^Q
"^DD",991.8,991.8,51,.1)
IRM Point of Contact
"^DD",991.8,991.8,51,3)
Enter the IRM point of contact name for MPI/PD.
"^DD",991.8,991.8,51,21,0)
^^7^7^3011010^
"^DD",991.8,991.8,51,21,1,0)
The IRM POINT OF CONTACT field contains the name of the individual
"^DD",991.8,991.8,51,21,2,0)
at the facility who supports the VistA Master Patient Index/Patient
"^DD",991.8,991.8,51,21,3,0)
Demographics application.
"^DD",991.8,991.8,51,21,4,0)
  
"^DD",991.8,991.8,51,21,5,0)
This field is populated using the Add/Edit Point of Contact [RG UPDATE
"^DD",991.8,991.8,51,21,6,0)
POINT OF CONTACT] option.  The information is sent to a remote mail 
"^DD",991.8,991.8,51,21,7,0)
group whose members maintain the point of contact list on the website.
"^DD",991.8,991.8,51,"DT")
3011010
"^DD",991.8,991.8,52,0)
HL7 POINT OF CONTACT^P200'^VA(200,^POC;3^Q
"^DD",991.8,991.8,52,.1)
HL7 Point of Contact
"^DD",991.8,991.8,52,3)
Enter the HL7 point of contact name for MPI/PD.
"^DD",991.8,991.8,52,21,0)
^^9^9^3011010^
"^DD",991.8,991.8,52,21,1,0)
The HL7 POINT OF CONTACT field contains the name of the individual
"^DD",991.8,991.8,52,21,2,0)
at the facility who supports the VistA Health Level Seven (HL7)
"^DD",991.8,991.8,52,21,3,0)
application.  Master Patient Index/Patient Demographics uses HL7
"^DD",991.8,991.8,52,21,4,0)
for message transmission and frequently needs to contact the HL7
"^DD",991.8,991.8,52,21,5,0)
point of contact.
"^DD",991.8,991.8,52,21,6,0)
  
"^DD",991.8,991.8,52,21,7,0)
This field is populated using the Add/Edit Point of Contact [RG UPDATE
"^DD",991.8,991.8,52,21,8,0)
POINT OF CONTACT] option.  The information is sent to a remote mail 
"^DD",991.8,991.8,52,21,9,0)
group whose members maintain the point of contact list on the website.
"^DD",991.8,991.8,52,"DT")
3011010
"^DD",991.8,991.8,53,0)
ALT ADMIN POINT OF CONTACT^P200'^VA(200,^POC;4^Q
"^DD",991.8,991.8,53,.1)
Alternate Administrative Point of Contact
"^DD",991.8,991.8,53,3)
Enter the alternate administrative point of contact name for MPI/PD.
"^DD",991.8,991.8,53,21,0)
^^7^7^3011015^
"^DD",991.8,991.8,53,21,1,0)
The ALT ADMIN POINT OF CONTACT field contains the name of a second
"^DD",991.8,991.8,53,21,2,0)
individual at the facility who is in a position to resolve patient
"^DD",991.8,991.8,53,21,3,0)
issues for Master Patient Index/Patient Demographics.
"^DD",991.8,991.8,53,21,4,0)
   
"^DD",991.8,991.8,53,21,5,0)
This field is populated using the Add/Edit Point of Contact [RG UPDATE
"^DD",991.8,991.8,53,21,6,0)
POINT OF CONTACT] option.  The information is sent to a remote mail
"^DD",991.8,991.8,53,21,7,0)
group whose members maintain the point of contact list on the website.
"^DD",991.8,991.8,53,"DT")
3011015
"^DD",991.8,991.8,54,0)
ALT IRM POINT OF CONTACT^P200'^VA(200,^POC;5^Q
"^DD",991.8,991.8,54,.1)
Alternate IRM Point of Contact
"^DD",991.8,991.8,54,3)
Enter the alternate IRM point of contact name for MPI/PD.
"^DD",991.8,991.8,54,21,0)
^^7^7^3011015^
"^DD",991.8,991.8,54,21,1,0)
The ALT IRM POINT OF CONTACT field contains the name of a second
"^DD",991.8,991.8,54,21,2,0)
individual at the facility who supports the VistA Master Patient
"^DD",991.8,991.8,54,21,3,0)
Index/Patient Demographics application.
"^DD",991.8,991.8,54,21,4,0)
   
"^DD",991.8,991.8,54,21,5,0)
This field is populated using the Add/Edit Point of Contact [RG UPDATE
"^DD",991.8,991.8,54,21,6,0)
POINT OF CONTACT] option.  The information is sent to a remote mail
"^DD",991.8,991.8,54,21,7,0)
group whose members maintain the point of contact list on the website.
"^DD",991.8,991.8,54,"DT")
3011015
"^DD",991.8,991.8,55,0)
ALT HL7 POINT OF CONTACT^P200'^VA(200,^POC;6^Q
"^DD",991.8,991.8,55,.1)
Alternate HL7 Point of Contact
"^DD",991.8,991.8,55,3)
Enter the alternate HL7 point of contact name for MPI/PD.
"^DD",991.8,991.8,55,21,0)
^^9^9^3011015^
"^DD",991.8,991.8,55,21,1,0)
The ALT HL7 POINT OF CONTACT field contains the name of a second
"^DD",991.8,991.8,55,21,2,0)
individual at the facility who supports the VistA Health Level Seven
"^DD",991.8,991.8,55,21,3,0)
(HL7) application.  Master Patient Index/Patient Demographics uses HL7
"^DD",991.8,991.8,55,21,4,0)
for message transmission and frequently needs to contact the HL7 point
"^DD",991.8,991.8,55,21,5,0)
of contact.
"^DD",991.8,991.8,55,21,6,0)
  
"^DD",991.8,991.8,55,21,7,0)
This field is populated using the Add/Edit Point of Contact [RG UPDATE
"^DD",991.8,991.8,55,21,8,0)
POINT OF CONTACT] option.  The information is sent to a remote mail
"^DD",991.8,991.8,55,21,9,0)
group whose members maintain the point of contact list on the website.
"^DD",991.8,991.8,55,"DT")
3011015
**END**
**END**
