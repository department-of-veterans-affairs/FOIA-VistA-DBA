Released RA*5*63 SEQ #53
Extracted from mail message
**KIDS**:RA*5.0*63^

**INSTALL NAME**
RA*5.0*63
"BLD",5734,0)
RA*5.0*63^RADIOLOGY/NUCLEAR MEDICINE^0^3050810^y
"BLD",5734,1,0)
^^1^1^3050808^
"BLD",5734,1,1,0)
Please see NPM patch for a description of this patch.
"BLD",5734,4,0)
^9.64PA^79^1
"BLD",5734,4,79,0)
79
"BLD",5734,4,79,2,0)
^9.641^79.0175^1
"BLD",5734,4,79,2,79.0175,0)
PERF INDIC SMTP E-MAIL ADDRESS  (sub-file)
"BLD",5734,4,79,2,79.0175,1,0)
^9.6411^1^1
"BLD",5734,4,79,2,79.0175,1,1,0)
OQP PERFORMANCE MGMT?
"BLD",5734,4,79,222)
y^n^p^^^^n^^n
"BLD",5734,4,79,224)

"BLD",5734,4,"APDD",79,79.0175)

"BLD",5734,4,"APDD",79,79.0175,1)

"BLD",5734,4,"B",79,79)

"BLD",5734,"INIT")
RA63PST
"BLD",5734,"KRN",0)
^9.67PA^8989.52^19
"BLD",5734,"KRN",.4,0)
.4
"BLD",5734,"KRN",.401,0)
.401
"BLD",5734,"KRN",.402,0)
.402
"BLD",5734,"KRN",.403,0)
.403
"BLD",5734,"KRN",.5,0)
.5
"BLD",5734,"KRN",.84,0)
.84
"BLD",5734,"KRN",3.6,0)
3.6
"BLD",5734,"KRN",3.8,0)
3.8
"BLD",5734,"KRN",9.2,0)
9.2
"BLD",5734,"KRN",9.8,0)
9.8
"BLD",5734,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5734,"KRN",9.8,"NM",1,0)
RAPM2^^0^B84935283
"BLD",5734,"KRN",9.8,"NM",2,0)
RAPM3^^0^B83282213
"BLD",5734,"KRN",9.8,"NM",3,0)
RAPM4^^0^B2800303
"BLD",5734,"KRN",9.8,"NM",4,0)
RA63PST^^0^B2199556
"BLD",5734,"KRN",9.8,"NM","B","RA63PST",4)

"BLD",5734,"KRN",9.8,"NM","B","RAPM2",1)

"BLD",5734,"KRN",9.8,"NM","B","RAPM3",2)

"BLD",5734,"KRN",9.8,"NM","B","RAPM4",3)

"BLD",5734,"KRN",19,0)
19
"BLD",5734,"KRN",19.1,0)
19.1
"BLD",5734,"KRN",101,0)
101
"BLD",5734,"KRN",409.61,0)
409.61
"BLD",5734,"KRN",771,0)
771
"BLD",5734,"KRN",870,0)
870
"BLD",5734,"KRN",8989.51,0)
8989.51
"BLD",5734,"KRN",8989.52,0)
8989.52
"BLD",5734,"KRN",8994,0)
8994
"BLD",5734,"KRN","B",.4,.4)

"BLD",5734,"KRN","B",.401,.401)

"BLD",5734,"KRN","B",.402,.402)

"BLD",5734,"KRN","B",.403,.403)

"BLD",5734,"KRN","B",.5,.5)

"BLD",5734,"KRN","B",.84,.84)

"BLD",5734,"KRN","B",3.6,3.6)

"BLD",5734,"KRN","B",3.8,3.8)

"BLD",5734,"KRN","B",9.2,9.2)

"BLD",5734,"KRN","B",9.8,9.8)

"BLD",5734,"KRN","B",19,19)

"BLD",5734,"KRN","B",19.1,19.1)

"BLD",5734,"KRN","B",101,101)

"BLD",5734,"KRN","B",409.61,409.61)

"BLD",5734,"KRN","B",771,771)

"BLD",5734,"KRN","B",870,870)

"BLD",5734,"KRN","B",8989.51,8989.51)

"BLD",5734,"KRN","B",8989.52,8989.52)

"BLD",5734,"KRN","B",8994,8994)

"BLD",5734,"QUES",0)
^9.62^^
"BLD",5734,"REQB",0)
^9.611^1^1
"BLD",5734,"REQB",1,0)
RA*5.0*48^2
"BLD",5734,"REQB","B","RA*5.0*48",1)

"FIA",79)
RAD/NUC MED DIVISION
"FIA",79,0)
^RA(79,
"FIA",79,0,0)
79P
"FIA",79,0,1)
y^n^p^^^^n^^n
"FIA",79,0,10)

"FIA",79,0,11)

"FIA",79,0,"RLRO")

"FIA",79,0,"VR")
5.0^RA
"FIA",79,79)
1
"FIA",79,79.0175)
1
"FIA",79,79.0175,1)

"INIT")
RA63PST
"MBREQ")
0
"PKG",18,-1)
1^1
"PKG",18,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",18,20,0)
^9.402P^^
"PKG",18,22,0)
^9.49I^1^1
"PKG",18,22,1,0)
5.0^3011017^2980407^50
"PKG",18,22,1,"PAH",1,0)
63^3050810
"PKG",18,22,1,"PAH",1,1,0)
^^1^1^3050810
"PKG",18,22,1,"PAH",1,1,1,0)
Please see NPM patch for a description of this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","RA63PST")
0^4^B2199556
"RTN","RA63PST",1,0)
RA63PST ;HIOFO/SWM-Post install
"RTN","RA63PST",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**63**;Mar 16, 1998
"RTN","RA63PST",3,0)
 ; This is the post-install routine for patch RA*5.0*63
"RTN","RA63PST",4,0)
 ; It will loop thru the first record in file 79
"RTN","RA63PST",5,0)
 ; and insert "Y" for the new field, "IS THIS FOR HQ?" only if
"RTN","RA63PST",6,0)
 ; the SMTP address is "VHARADIOLOGYREPORTS@HQ.MED.VA.GOV"
"RTN","RA63PST",7,0)
 ;
"RTN","RA63PST",8,0)
 ; This routine may be deleted after RA*5.0*63 is installed.
"RTN","RA63PST",9,0)
 ;
"RTN","RA63PST",10,0)
 N RA1,RA2,RASTR,RAVAL,RAFDA,RAIEN
"RTN","RA63PST",11,0)
 S RATXT(1)=""
"RTN","RA63PST",12,0)
 S RATXT(2)="** File 79, RAD/NUC MED DIVISION,"
"RTN","RA63PST",13,0)
 S RATXT(3)="   new field ""OQP PERFORMANCE MGMT?"" "
"RTN","RA63PST",14,0)
 S RATXT(4)="   has been updated with data. **"
"RTN","RA63PST",15,0)
 S RA1=$O(^RA(79,0)),RA2=0,RAC=0
"RTN","RA63PST",16,0)
 F  S RA2=$O(^RA(79,RA1,1,RA2)) Q:'RA2  D
"RTN","RA63PST",17,0)
 . S RAC=RAC+1 ;counter
"RTN","RA63PST",18,0)
 . S RASTR=$G(^RA(79,RA1,1,RA2,0)) Q:RASTR=""
"RTN","RA63PST",19,0)
 . S RAIEN=RA2_","_RA1_","
"RTN","RA63PST",20,0)
 . S RAVAL=$P(RASTR,"^"),RAVAL=$$UP^XLFSTR(RAVAL) ;smtp address all caps
"RTN","RA63PST",21,0)
 . I RAVAL="VHARADIOLOGYREPORTS@HQ.MED.VA.GOV" S RAFDA(79.0175,RAIEN,1)="Y"
"RTN","RA63PST",22,0)
 . E  S RAFDA(79.0175,RAIEN,1)="N"
"RTN","RA63PST",23,0)
 . D FILE^DIE("","RAFDA") K RAFDA,RAIEN
"RTN","RA63PST",24,0)
 . Q
"RTN","RA63PST",25,0)
 I RAC=0 S RATXT(4)="   has NO data because there are NO Outlook mail groups in this file."
"RTN","RA63PST",26,0)
 D MES^XPDUTL(.RATXT)
"RTN","RA63PST",27,0)
 Q
"RTN","RAPM2")
0^1^B84935283
"RTN","RAPM2",1,0)
RAPM2 ;HOIFO/TH-Radiology Performance Monitors/Indicator; ;2/26/04  12:41
"RTN","RAPM2",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**37,44,48,63**;Mar 16, 1998
"RTN","RAPM2",3,0)
 ; IA 10090 allows Read w/Fileman for entire file 4
"RTN","RAPM2",4,0)
 ; Print Detail report
"RTN","RAPM2",5,0)
DETAIL ; Print Detail report
"RTN","RAPM2",6,0)
 I ($Y+5)>IOSL!(RARPT="B") D
"RTN","RAPM2",7,0)
 . I IO=IO(0),($E(IOST,1,2)="C-") D
"RTN","RAPM2",8,0)
 . . R !,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM2",9,0)
 D HDR("D")
"RTN","RAPM2",10,0)
 D PRTTOT
"RTN","RAPM2",11,0)
 D DHDR
"RTN","RAPM2",12,0)
 D DRPT
"RTN","RAPM2",13,0)
 D DFOOT
"RTN","RAPM2",14,0)
 Q
"RTN","RAPM2",15,0)
 ;
"RTN","RAPM2",16,0)
PRTTOT ; Print total number of reports
"RTN","RAPM2",17,0)
 S RATOTCNT=+$G(^TMP($J,"RAPM","TOTAL"))
"RTN","RAPM2",18,0)
 W !,"Total number of reports expected for procedures performed during specified date range: ",$J(RATOTCNT,$L(RATOTCNT))
"RTN","RAPM2",19,0)
 Q
"RTN","RAPM2",20,0)
 ;
"RTN","RAPM2",21,0)
DHDR ; Header
"RTN","RAPM2",22,0)
 I ($Y+5)>IOSL D
"RTN","RAPM2",23,0)
 . S RAPG=RAPG+1,RAHD(0)="Detail Performance Indicator Report"
"RTN","RAPM2",24,0)
 . W @IOF,!?(RAIOM-$L(RAHD(0))\2),RAHD(0),?(RAIOM-10),"Page: ",$G(RAPG)
"RTN","RAPM2",25,0)
 W !!,?32,"Date/Time",?48,"Date/Time",?68,"Date/Time",?102,"Cat"
"RTN","RAPM2",26,0)
 W ?106,"Rpt",?110,"Img",?116,"Procedure"
"RTN","RAPM2",27,0)
 W !,"Patient Name",?18,"Case #",?32,"Registered",?48,"Transcribed",?62,"Hrs"
"RTN","RAPM2",28,0)
 W ?68,"Verified",?82,"Hrs",?87,"Radiologist",?102,"Exm",?106,"Sts"
"RTN","RAPM2",29,0)
 W ?110,"Typ",?119,"Name",!
"RTN","RAPM2",30,0)
 Q
"RTN","RAPM2",31,0)
 ;
"RTN","RAPM2",32,0)
DRPT ; Read records
"RTN","RAPM2",33,0)
 I '$D(^TMP($J,"RAPM2")) W !!?30,"No data to print...",!!!!! Q
"RTN","RAPM2",34,0)
 S D1="" F  S D1=$O(^TMP($J,"RAPM2",D1)) Q:D1=""  D
"RTN","RAPM2",35,0)
 . S D2="" F  S D2=$O(^TMP($J,"RAPM2",D1,D2)) Q:D2=""  D
"RTN","RAPM2",36,0)
 . . S D3="" F  S D3=$O(^TMP($J,"RAPM2",D1,D2,D3)) Q:D3=""  D
"RTN","RAPM2",37,0)
 . . . D SRT
"RTN","RAPM2",38,0)
 Q
"RTN","RAPM2",39,0)
 ;
"RTN","RAPM2",40,0)
SRT ; Read records
"RTN","RAPM2",41,0)
 I RASORT="C"!(RASORT="P") S RAREC=$G(^TMP($J,"RAPM2",D1,D2,D3)) D DET Q
"RTN","RAPM2",42,0)
 S D4="" F  S D4=$O(^TMP($J,"RAPM2",D1,D2,D3,D4)) Q:D4=""  D
"RTN","RAPM2",43,0)
 . S RAREC=$G(^TMP($J,"RAPM2",D1,D2,D3,D4)) D DET
"RTN","RAPM2",44,0)
 Q
"RTN","RAPM2",45,0)
 ;
"RTN","RAPM2",46,0)
DET ; Print detail records
"RTN","RAPM2",47,0)
 ; use Transcription elasped hr for all sorts, except if sort by Verif.
"RTN","RAPM2",48,0)
 S RAVAL=$S(RASORT="V":$P(RAREC,U,13),1:$P(RAREC,U,12))
"RTN","RAPM2",49,0)
 ; remove symbols before comparison
"RTN","RAPM2",50,0)
 S:$E(RAVAL)="<" RAVAL=.5 S:$E(RAVAL)=">" RAVAL=999
"RTN","RAPM2",51,0)
 ; include PENDING and those with hours > RASINCE
"RTN","RAPM2",52,0)
 I RAVAL'="",RAVAL<RASINCE Q
"RTN","RAPM2",53,0)
 I ($Y+5)>IOSL D
"RTN","RAPM2",54,0)
 . I IO=IO(0) D
"RTN","RAPM2",55,0)
 . . I $E(IOST,1,2)="C-" R !,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM2",56,0)
 . D DHDR
"RTN","RAPM2",57,0)
 W !,$E($P(RAREC,U,2),1,15)
"RTN","RAPM2",58,0)
 W ?17,$P(RAREC,U,1)
"RTN","RAPM2",59,0)
 W ?31,$P($$FMTE^XLFDT($P(RAREC,U,3),"2FS"),":",1,2)
"RTN","RAPM2",60,0)
 W ?46,$P($$FMTE^XLFDT($P(RAREC,U,4),"2FS"),":",1,2),?61,$J($P(RAREC,U,12),4)
"RTN","RAPM2",61,0)
 W ?66,$P($$FMTE^XLFDT($P(RAREC,U,5),"2FS"),":",1,2),?81,$J($P(RAREC,U,13),4)
"RTN","RAPM2",62,0)
 I $P(RAREC,U,6)'="" W ?86,$E($P(RAREC,U,6),1,16)
"RTN","RAPM2",63,0)
 W ?104,$P(RAREC,U,7),?107,$P(RAREC,U,8)
"RTN","RAPM2",64,0)
 W ?110,$E($P(RAREC,U,9),1,3),?114,$E($P(RAREC,U,14),1,15)
"RTN","RAPM2",65,0)
 W:$P(RAREC,U,11)="" ?130,"*D"
"RTN","RAPM2",66,0)
 Q
"RTN","RAPM2",67,0)
 ;
"RTN","RAPM2",68,0)
DFOOT ; Footer for Detail report
"RTN","RAPM2",69,0)
 I ($Y+5)>IOSL D
"RTN","RAPM2",70,0)
 . I IO=IO(0) D
"RTN","RAPM2",71,0)
 . . I $E(IOST,1,2)="C-" R !,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM2",72,0)
 . D DHDR
"RTN","RAPM2",73,0)
 W !!,"Note: Category of Exam: 'I' for Inpatient; 'O' for Outpatient; "
"RTN","RAPM2",74,0)
 W "'C' for Contract; 'S' for Sharing; 'E' for Employee; 'R' for Research"
"RTN","RAPM2",75,0)
 W !,"      Report Status:    'V' for Verififed; 'R' for Released/Not "
"RTN","RAPM2",76,0)
 W "Verified; 'PD' for Problem Draft; 'D' for Draft"
"RTN","RAPM2",77,0)
 W:RANODIV !," *D = Division is missing"
"RTN","RAPM2",78,0)
 W !!?5,"* A printset, i.e., a set of multiple exams that share the same report, will be expected to have 1 report."
"RTN","RAPM2",79,0)
 Q
"RTN","RAPM2",80,0)
 ;
"RTN","RAPM2",81,0)
STORE ; Store detail information
"RTN","RAPM2",82,0)
 Q:RARPT="S"
"RTN","RAPM2",83,0)
 ; for storage subscript: if no rpt dt, set to neg
"RTN","RAPM2",84,0)
 S RADHT=$S(RARPTDT="":-1,1:RATDFHR)
"RTN","RAPM2",85,0)
 S RADHV=$S(RAVERDT="":-1,1:RAVDFHR)
"RTN","RAPM2",86,0)
 ; for display: round off and remove decimal portion of hours
"RTN","RAPM2",87,0)
 S:RATDFHR'="" RATDFHR=(RATDFHR+.5)\1
"RTN","RAPM2",88,0)
 S:RAVDFHR'="" RAVDFHR=(RAVDFHR+.5)\1
"RTN","RAPM2",89,0)
 S RATDFHR=$S(RATDFHR="":"",RATDFHR<1:"<1",RATDFHR>999:">999",1:RATDFHR)
"RTN","RAPM2",90,0)
 S RAVDFHR=$S(RAVDFHR="":"",RAVDFHR<1:"<1",RAVDFHR>999:">999",1:RAVDFHR)
"RTN","RAPM2",91,0)
 ;
"RTN","RAPM2",92,0)
 S RAREC1=RACN_U_RAPATNM_U_RADTE_U_RARPTDT_U
"RTN","RAPM2",93,0)
 S RAREC1=RAREC1_RAVERDT_U_RAPRIMNM_U_RACAT_U_RARPTST_U_RAIMGTYP_U
"RTN","RAPM2",94,0)
 S RAREC1=RAREC1_RADFN_U_RACHKDIV_U_RATDFHR_U_RAVDFHR_U_RAPRCN
"RTN","RAPM2",95,0)
 ;
"RTN","RAPM2",96,0)
 I RASORT="C" S ^TMP($J,"RAPM2",$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",97,0)
 I RASORT="P" S ^TMP($J,"RAPM2",RAPATNM,$P(RADTE,"."),RACN)=RAREC1
"RTN","RAPM2",98,0)
 I RASORT="I" S ^TMP($J,"RAPM2",RAIMGTYP,$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",99,0)
 I RASORT="E" S ^TMP($J,"RAPM2",RACAT,$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",100,0)
 I RASORT="R" S ^TMP($J,"RAPM2",RAPRIMNM,$P(RADTE,"."),RACN,RAPATNM)=RAREC1
"RTN","RAPM2",101,0)
 I RASORT="T" S ^TMP($J,"RAPM2",RADHT,RADTE,RACN,RAPATNM)=RAREC1
"RTN","RAPM2",102,0)
 I RASORT="V" S ^TMP($J,"RAPM2",RADHV,RADTE,RACN,RAPATNM)=RAREC1
"RTN","RAPM2",103,0)
 Q
"RTN","RAPM2",104,0)
EMAIL ; Ask if ready to email the summary report
"RTN","RAPM2",105,0)
 N RA1
"RTN","RAPM2",106,0)
 W ! S DIR(0)="Y"
"RTN","RAPM2",107,0)
 S DIR("A")="Send summary report to local mail group ""G.RAD PERFORMANCE INDICATOR"""
"RTN","RAPM2",108,0)
 S DIR("B")="Yes"
"RTN","RAPM2",109,0)
 D ^DIR
"RTN","RAPM2",110,0)
 Q:$D(DIRUT)
"RTN","RAPM2",111,0)
 S RAANS=Y
"RTN","RAPM2",112,0)
 S RA1=$O(^RA(79,0)) Q:'RA1
"RTN","RAPM2",113,0)
 I '$O(^RA(79,RA1,1,0)) D  Q
"RTN","RAPM2",114,0)
 . W !!,?5,"No OUTLOOK mail group(s) have been entered yet."
"RTN","RAPM2",115,0)
 . Q
"RTN","RAPM2",116,0)
 W ! S DIR(0)="Y"
"RTN","RAPM2",117,0)
 S DIR("A")="Send summary report to OUTLOOK mail group(s)"
"RTN","RAPM2",118,0)
 S DIR("B")="Yes"
"RTN","RAPM2",119,0)
 D ^DIR
"RTN","RAPM2",120,0)
 S RAANS2=Y
"RTN","RAPM2",121,0)
 I RAANS2 D CKMONTH^RAPM4
"RTN","RAPM2",122,0)
 Q
"RTN","RAPM2",123,0)
SEND ; Send summary report to mail group
"RTN","RAPM2",124,0)
 I RAANS=0,RAANS2=0 Q
"RTN","RAPM2",125,0)
 N RA1,RA2,RASVSUB,RASVTEXT,RASTR
"RTN","RAPM2",126,0)
 S XMSUB="Radiology Summary Performance Indicator"
"RTN","RAPM2",127,0)
 S XMDUZ=DUZ
"RTN","RAPM2",128,0)
 S XMTEXT="^TMP($J,""RAPM"","
"RTN","RAPM2",129,0)
 S RASVSUB=XMSUB,RASVTEXT=XMTEXT
"RTN","RAPM2",130,0)
 I RAANS=1 D
"RTN","RAPM2",131,0)
 . S XMY("G.RAD PERFORMANCE INDICATOR")=""
"RTN","RAPM2",132,0)
 . D ^XMD
"RTN","RAPM2",133,0)
 . K XMY
"RTN","RAPM2",134,0)
 . Q
"RTN","RAPM2",135,0)
 I RAANS2=1 D
"RTN","RAPM2",136,0)
 . S RA1=$O(^RA(79,0)) Q:'RA1
"RTN","RAPM2",137,0)
 . S XMSUB=RASVSUB,XMTEXT=RASVTEXT
"RTN","RAPM2",138,0)
 . S RA2=0
"RTN","RAPM2",139,0)
 .; Outlook mailgroup flagged for HQ should always get automatic mid-
"RTN","RAPM2",140,0)
 .; mid-month rpt, but only get user-initiated rpt if user specifies so
"RTN","RAPM2",141,0)
 .;   
"RTN","RAPM2",142,0)
 .; All non-HQ outlook mailgroups get all reports, including autom rpt
"RTN","RAPM2",143,0)
 .;
"RTN","RAPM2",144,0)
 . F  S RA2=$O(^RA(79,RA1,1,RA2)) Q:'RA2  S RASTR=$G(^(RA2,0)) D
"RTN","RAPM2",145,0)
 .. I $P(RASTR,U,2)="Y",$G(RAUTOM) S XMY($P(RASTR,U))=""
"RTN","RAPM2",146,0)
 .. I $P(RASTR,U,2)'="Y" S XMY($P(RASTR,U))=""
"RTN","RAPM2",147,0)
 .. Q
"RTN","RAPM2",148,0)
 . Q:'$D(XMY)
"RTN","RAPM2",149,0)
 . D ^XMD
"RTN","RAPM2",150,0)
 . K XMY
"RTN","RAPM2",151,0)
 . Q
"RTN","RAPM2",152,0)
 K XMDUZ
"RTN","RAPM2",153,0)
 Q
"RTN","RAPM2",154,0)
HDR(RATYP) ; Print appropriate header
"RTN","RAPM2",155,0)
 U:RAIO IO S RAPG=$G(RAPG)+1
"RTN","RAPM2",156,0)
 I $G(RAPG)!($E(IOST,1,2)="C-") W:RAIO @IOF
"RTN","RAPM2",157,0)
 I $E(IOST,1,2)="P-",(RAPG>1) W:RAIO @IOF
"RTN","RAPM2",158,0)
 S RAHD(0)=$S(RATYP="S":"Summary",RATYP="D":"Detail",1:"")
"RTN","RAPM2",159,0)
 S RAHD(0)=RAHD(0)_" Performance Indicator Report"
"RTN","RAPM2",160,0)
 S RAIOM=$S(RATYP="S":80,1:IOM)
"RTN","RAPM2",161,0)
 W:RAIO !?(RAIOM-$L(RAHD(0))\2),RAHD(0),?(RAIOM-10),"Page: ",$G(RAPG),!
"RTN","RAPM2",162,0)
 I RATYP="S" S RAN=1 D
"RTN","RAPM2",163,0)
 . S ^TMP($J,"RAPM",RAN)="                     Summary Performance Indicator Report          Page: "_$G(RAPG) S RAN=RAN+1
"RTN","RAPM2",164,0)
 . S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM2",165,0)
 ;
"RTN","RAPM2",166,0)
 D GETS^DIQ(4,DUZ(2),".01;14*;99","E","RAR","RAMSG")
"RTN","RAPM2",167,0)
 K X
"RTN","RAPM2",168,0)
 S X(1)=RAR(4,DUZ(2)_",",.01,"E") ; Name of facility
"RTN","RAPM2",169,0)
 S X(2)=RAR(4,DUZ(2)_",",99,"E") ;  Station Number
"RTN","RAPM2",170,0)
 I $D(RAR(4.014)) D
"RTN","RAPM2",171,0)
 . S X(3)=RAR(4.014,"1,"_DUZ(2)_",",.01,"E") ; Association
"RTN","RAPM2",172,0)
 . S X(4)=RAR(4.014,"1,"_DUZ(2)_",",1,"E") ; Parent of Association
"RTN","RAPM2",173,0)
 . S X(5)=$S(X(3)="VISN":X(4),1:"") ; should be VISN number
"RTN","RAPM2",174,0)
 E  S X(5)=""
"RTN","RAPM2",175,0)
 ;
"RTN","RAPM2",176,0)
 W:RAIO !,"Facility: ",X(1),?41,"Station: ",X(2),?60,"VISN: ",X(5)
"RTN","RAPM2",177,0)
 I RATYP="S" D
"RTN","RAPM2",178,0)
 . S $P(X(6)," ",79)=""
"RTN","RAPM2",179,0)
 . S $E(X(6),1,(10+$L(X(1))))="Facility: "_X(1)
"RTN","RAPM2",180,0)
 . S $E(X(6),41,(50+$L(X(2))))="Station: "_X(2)
"RTN","RAPM2",181,0)
 . S $E(X(6),60,(66+$L(X(5))))="VISN: "_X(5)
"RTN","RAPM2",182,0)
 . S ^TMP($J,"RAPM",RAN)=X(6)
"RTN","RAPM2",183,0)
 . S RAN=RAN+1
"RTN","RAPM2",184,0)
 . Q
"RTN","RAPM2",185,0)
 W !,"Division: "
"RTN","RAPM2",186,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Division: "
"RTN","RAPM2",187,0)
 D DIV
"RTN","RAPM2",188,0)
 S:(RATYP="S") RAN=RAN+1
"RTN","RAPM2",189,0)
 ;
"RTN","RAPM2",190,0)
 W:RAIO !,"Exam Date Range: "
"RTN","RAPM2",191,0)
 W:RAIO $$FMTE^XLFDT(RABDATE,"2D")," - ",$$FMTE^XLFDT(RAEDATE,"2D")
"RTN","RAPM2",192,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Exam Date Range: "_$$FMTE^XLFDT(RABDATE,"2D")_" - "_$$FMTE^XLFDT(RAEDATE,"2D") S RAN=RAN+1
"RTN","RAPM2",193,0)
 ;
"RTN","RAPM2",194,0)
 W:RAIO !,"Imaging Type(s): "
"RTN","RAPM2",195,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Imaging Type(s): "
"RTN","RAPM2",196,0)
 D IMG
"RTN","RAPM2",197,0)
 S:RATYP="S" RAN=RAN+1
"RTN","RAPM2",198,0)
 ;
"RTN","RAPM2",199,0)
 ; Run date and time
"RTN","RAPM2",200,0)
 S NOW=$$NOW^XLFDT,NOW=$P(NOW,".",1)_"."_$E($P(NOW,".",2),1,4)
"RTN","RAPM2",201,0)
 W:RAIO !,"Run Date/Time: ",$$FMTE^XLFDT(NOW,"2P"),!
"RTN","RAPM2",202,0)
 I RATYP="S" S ^TMP($J,"RAPM",RAN)="Run Date/Time: "_$$FMTE^XLFDT(NOW,"2P"),RAN=RAN+1
"RTN","RAPM2",203,0)
 I RARAD D
"RTN","RAPM2",204,0)
 . W:RAIO !,"Primary Interpreting Staff Physician: ",$$GET1^DIQ(200,RARAD,.01),!
"RTN","RAPM2",205,0)
 . I RATYP="S" D
"RTN","RAPM2",206,0)
 .. S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM2",207,0)
 .. S ^TMP($J,"RAPM",RAN)="Primary Interpreting Staff Physician: "_$$GET1^DIQ(200,RARAD,.01),RAN=RAN+1
"RTN","RAPM2",208,0)
 .. Q
"RTN","RAPM2",209,0)
 . Q
"RTN","RAPM2",210,0)
 I (RARPT="D"!(RARPT="B")),(RATYP'="S") D
"RTN","RAPM2",211,0)
 . S RASRT=$S(RASORT="C":"Case Number",RASORT="E":"Cateory of Exam",RASORT="I":"Imaging Type",RASORT="P":"Patient Name",RASORT="R":"Radiologist",RASORT="T":"Hrs to Transcription",RASORT="V":"Hrs to Verification",1:"")
"RTN","RAPM2",212,0)
 . W:RAIO !,"Sorted by: ",RASRT,?45,"Min. hours elasped to "_$S(RASORT="V":"Verification",1:"Transcription")_": "_RASINCE
"RTN","RAPM2",213,0)
 Q
"RTN","RAPM2",214,0)
DIV ; List selected Division
"RTN","RAPM2",215,0)
 Q:'$D(^TMP($J,"RA D-TYPE"))
"RTN","RAPM2",216,0)
 S RADIV="" F I=1:1 S RADIV=$O(^TMP($J,"RA D-TYPE",RADIV)) Q:RADIV=""  D
"RTN","RAPM2",217,0)
 . I $X'>(RAIOM-$L("Division(s): ")) D
"RTN","RAPM2",218,0)
 . . W:RAIO RADIV_$S($O(^TMP($J,"RA D-TYPE",RADIV))]"":", ",1:"")
"RTN","RAPM2",219,0)
 . . I RATYP="S" S ^TMP($J,"RAPM",RAN)=^TMP($J,"RAPM",RAN)_RADIV_$S($O(^TMP($J,"RA D-TYPE",RADIV))]"":", ",1:"")
"RTN","RAPM2",220,0)
 . I $X>(RAIOM-$L("Division(s): ")) D
"RTN","RAPM2",221,0)
 . . W:RAIO !?($X+$L("Division(s): "))
"RTN","RAPM2",222,0)
 . . I RATYP="S" S RAN=RAN+1,^TMP($J,"RAPM",RAN)="         "
"RTN","RAPM2",223,0)
 Q
"RTN","RAPM2",224,0)
IMG ; List selected Imaging Type(s)
"RTN","RAPM2",225,0)
 Q:'$D(^TMP($J,"RA I-TYPE"))
"RTN","RAPM2",226,0)
 ;N RALMAX,RALUSED,RATAIL,RALDENT
"RTN","RAPM2",227,0)
 S RALDENT=$L("Imaging Type(s): ")
"RTN","RAPM2",228,0)
 S RALMAX=RAIOM-RALDENT
"RTN","RAPM2",229,0)
 S RALUSED=0
"RTN","RAPM2",230,0)
 S RAIMG="" F J=1:1 S RAIMG=$O(^TMP($J,"RA I-TYPE",RAIMG)) Q:RAIMG=""  D
"RTN","RAPM2",231,0)
 . S RATAIL=$S($O(^TMP($J,"RA I-TYPE",RAIMG))]"":", ",1:"")
"RTN","RAPM2",232,0)
 . I (RALUSED+$L(RAIMG)+$L(RATAIL))>RALMAX D
"RTN","RAPM2",233,0)
 .. W:RAIO !?RALDENT
"RTN","RAPM2",234,0)
 .. I RATYP="S" S RAN=RAN+1,^TMP($J,"RAPM",RAN)="                 "
"RTN","RAPM2",235,0)
 .. S RALUSED=0
"RTN","RAPM2",236,0)
 .. Q
"RTN","RAPM2",237,0)
 . W:RAIO RAIMG_RATAIL
"RTN","RAPM2",238,0)
 . I RATYP="S" S ^TMP($J,"RAPM",RAN)=^TMP($J,"RAPM",RAN)_RAIMG_RATAIL
"RTN","RAPM2",239,0)
 . S RALUSED=RALUSED+$L(RAIMG)+$L(RATAIL)
"RTN","RAPM2",240,0)
 Q
"RTN","RAPM3")
0^2^B83282213
"RTN","RAPM3",1,0)
RAPM3 ;HOIFO/SM-Radiology Performance Monitors/Indicator ;1/5/04  11:11
"RTN","RAPM3",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**37,44,63**;Mar 16, 1998
"RTN","RAPM3",3,0)
 ;; IA #11090 allows Fileman read of Entire file 4
"RTN","RAPM3",4,0)
 Q
"RTN","RAPM3",5,0)
EN1 ;entry/edit OUTLOOK mail groups
"RTN","RAPM3",6,0)
 N RA1,RA2
"RTN","RAPM3",7,0)
 S RA1=$O(^RA(79,0)) Q:'RA1
"RTN","RAPM3",8,0)
 I $O(^RA(79,RA1,1,0)) D
"RTN","RAPM3",9,0)
 . W !?5,"OUTLOOK mail groups previously entered:",!?56,"OQP Perf. Mgmt?",!?56,"--------------"
"RTN","RAPM3",10,0)
 . S RA2=0
"RTN","RAPM3",11,0)
 . F  S RA2=$O(^RA(79,RA1,1,RA2)) Q:'RA2  W !?8,$P(^(RA2,0),U),?63,$P(^(0),U,2)
"RTN","RAPM3",12,0)
 . Q
"RTN","RAPM3",13,0)
 W !!?5,"You may add another mail group."
"RTN","RAPM3",14,0)
 W !,?5,"To edit or replace a mail group, you must delete the old one first.",!
"RTN","RAPM3",15,0)
 L +^RA(79,RA1,1):1 I '$T W !,$C(7),"Can't lock ^RA,",RA1,",1) now, try again later." Q
"RTN","RAPM3",16,0)
 S DIE="^RA(79,",DA=RA1,DR="175"
"RTN","RAPM3",17,0)
 D ^DIE
"RTN","RAPM3",18,0)
 L -^RA(79,RA1,1)
"RTN","RAPM3",19,0)
 Q
"RTN","RAPM3",20,0)
TASKLM ; task off last month's Perf. Indic. Summary Report [RA PERFORMIN TASKLM]
"RTN","RAPM3",21,0)
 ; define report type as summary
"RTN","RAPM3",22,0)
 N RA1,RA2,RA3,RABDATE,RAEDATE,RADAYS,RAENDDT,RABEGDT,RAUTOM,RALASTM
"RTN","RAPM3",23,0)
 N M1,M2,X1,X2,Y1,Y2
"RTN","RAPM3",24,0)
 ; RALASTM flags this option RA PERFORMIN TASKLM, queued or interactive
"RTN","RAPM3",25,0)
 S RALASTM=1
"RTN","RAPM3",26,0)
 ; if tasked here, set RAUTOM to flag automatic queued mid-month report
"RTN","RAPM3",27,0)
 I $D(ZTQUEUED) S RAUTOM=1
"RTN","RAPM3",28,0)
 ; if interactive, display Outlook mail groups and ask if continue
"RTN","RAPM3",29,0)
 I '$D(ZTQUEUED) D  I 'RA3 W !!?5,"** Nothing Done **" Q
"RTN","RAPM3",30,0)
 . W !!?5,"The Summary Report of Last Month's data will be sent to the"
"RTN","RAPM3",31,0)
 . W !?5,"Outlook mail group(s) in File 79's PERF INDC SMPT E-MAIL ADDRESS"
"RTN","RAPM3",32,0)
 . W !?5,"with ""N"" defined for OQP Performance Management."
"RTN","RAPM3",33,0)
 . S RA1=$O(^RA(79,0))
"RTN","RAPM3",34,0)
 . I '$O(^RA(79,RA1,1,0)) S RA3=0 W !?5,"** There is no Outlook mail group defined in File 79's",!?8,"PERF INDC SMTP E-MAIL ADDRESS. **",! Q
"RTN","RAPM3",35,0)
 . S RA2=0
"RTN","RAPM3",36,0)
 . W !?56,"OQP Perf. Mgmt?",!?56,"---------------"
"RTN","RAPM3",37,0)
 . F  S RA2=$O(^RA(79,RA1,1,RA2)) Q:'RA2  W !?3,$P(^(RA2,0),U),?63,$P(^(0),U,2)
"RTN","RAPM3",38,0)
 . W !
"RTN","RAPM3",39,0)
 . D HQASK^RAPM4
"RTN","RAPM3",40,0)
 . S DIR(0)="Y"
"RTN","RAPM3",41,0)
 . S DIR("A",1)=""
"RTN","RAPM3",42,0)
 . S DIR("A")="  Do you want to continue"
"RTN","RAPM3",43,0)
 . D ^DIR S RA3=Y
"RTN","RAPM3",44,0)
 . Q:'RA3
"RTN","RAPM3",45,0)
 . ; ask Task Start Time
"RTN","RAPM3",46,0)
 . W !!?5,"The requested start time must be within day 10 through the last",!?5,"day of the current month.",!
"RTN","RAPM3",47,0)
 . ; find end day of current month
"RTN","RAPM3",48,0)
 . S Y1=$E(DT,1,3),M1=$E(DT,4,5)
"RTN","RAPM3",49,0)
 . S Y2=$S(M1="12":Y1+1,1:Y1),M2=$S(M1="12":"01",1:M1+1)
"RTN","RAPM3",50,0)
 . S:$L(M2)=1 M2="0"_M2
"RTN","RAPM3",51,0)
 . S RA1=Y1_M1_"10"
"RTN","RAPM3",52,0)
 . S RA2=Y2_M2_"01"
"RTN","RAPM3",53,0)
 . S X2=RA1,X1=RA2 D ^%DTC
"RTN","RAPM3",54,0)
 . S X2=X-1,X1=RA1 D C^%DTC S RA2=X
"RTN","RAPM3",55,0)
 . S DIR(0)="D^"_RA1_":"_RA2_":AE"
"RTN","RAPM3",56,0)
 . S DIR("A",1)="  Enter date to start this Task"
"RTN","RAPM3",57,0)
 . S DIR("A")="  (time will be the same hh:mm as now.)"
"RTN","RAPM3",58,0)
 . S DIR("?",1)="   The Task date must be at least 10 days from the"
"RTN","RAPM3",59,0)
 . S DIR("?")="   beginning of this month through the end of this month."
"RTN","RAPM3",60,0)
 . D ^DIR
"RTN","RAPM3",61,0)
 . S:$D(DIRUT) RA3=0
"RTN","RAPM3",62,0)
 . S ZTDTH=Y_"."_$P(($$NOW^XLFDT),".",2)
"RTN","RAPM3",63,0)
 . Q
"RTN","RAPM3",64,0)
 K ^TMP($J)
"RTN","RAPM3",65,0)
 S RARAD="" ; all radiologists
"RTN","RAPM3",66,0)
 S RARPT="S",RAANS=0,RAANS2=1 ; summary, no local mail, send Outlook mail
"RTN","RAPM3",67,0)
 ; define LAST MONTH'S begin and end dates
"RTN","RAPM3",68,0)
 S Y1=$E(DT,1,3),M1=$E(DT,4,5) ; current month
"RTN","RAPM3",69,0)
 S Y2=$S(M1="01":Y1-1,1:Y1),M2=$S(M1="01":12,1:M1-1) ; last month
"RTN","RAPM3",70,0)
 S:$L(M2)=1 M2="0"_M2
"RTN","RAPM3",71,0)
 S RA1=Y1_M1_"01" ; Current year and month, 1st day of month
"RTN","RAPM3",72,0)
 S RABDATE=Y2_M2_"01" ; Begin date for last month
"RTN","RAPM3",73,0)
 S X1=RA1,X2=RABDATE D ^%DTC S RADAYS=X ; No. days in last month
"RTN","RAPM3",74,0)
 S X2=(RADAYS-1),X1=RABDATE D C^%DTC S RAEDATE=X ; End date last month
"RTN","RAPM3",75,0)
 S RAENDDT=RAEDATE_.9999 ; convert for search loop
"RTN","RAPM3",76,0)
 S RABEGDT=(RABDATE-1)_.9999 ; convert for search loop
"RTN","RAPM3",77,0)
 ; define divisions that have at least 1 active img loc
"RTN","RAPM3",78,0)
 S RA1=0
"RTN","RAPM3",79,0)
 F  S RA1=$O(^RA(79,RA1)) Q:'RA1  D
"RTN","RAPM3",80,0)
 . S RA2=0
"RTN","RAPM3",81,0)
 . ;if div has at least 1 active img loc, then store div in ^tmp
"RTN","RAPM3",82,0)
 . F  S RA2=$O(^RA(79,RA1,"L",RA2)) Q:'RA2  I $D(^(RA2,0)),$P($G(^RA(79.1,+^(0),0)),U,19)="" S RA3=$$GET1^DIQ(4,RA1,.01),^TMP($J,"RA D-TYPE",RA3,RA1)="" Q
"RTN","RAPM3",83,0)
 ; define imaging types if not vascular lab but has file 79.1 BIMG xref
"RTN","RAPM3",84,0)
 S RA1=0
"RTN","RAPM3",85,0)
 F  S RA1=$O(^RA(79.2,RA1)) Q:'RA1  D
"RTN","RAPM3",86,0)
 . I $D(^RA(79.2,RA1,0)) S RA2=$P(^(0),U) I RA2'["VASCULAR LAB",$D(^RA(79.1,"BIMG",RA1)) S ^TMP($J,"RA I-TYPE",RA2,RA1)=""
"RTN","RAPM3",87,0)
 ; task job
"RTN","RAPM3",88,0)
 S ZTIO=""
"RTN","RAPM3",89,0)
 D TASK^RAPM
"RTN","RAPM3",90,0)
 S X1=ZTDESC,X2=ZTDTH ; save taskman vars
"RTN","RAPM3",91,0)
 D ^%ZTLOAD
"RTN","RAPM3",92,0)
 I +$G(ZTSK("D"))>0,$D(ZTSK) D
"RTN","RAPM3",93,0)
 . W !?5,*7,"Request queued: ",X1
"RTN","RAPM3",94,0)
 . W !?5,"to start on: ",$$FMTE^XLFDT(X2)
"RTN","RAPM3",95,0)
 . W !?5,"Task #: "_$G(ZTSK)
"RTN","RAPM3",96,0)
 K ^TMP($J)
"RTN","RAPM3",97,0)
 Q
"RTN","RAPM3",98,0)
RESCH ; reschedule option that is in file 19.2
"RTN","RAPM3",99,0)
 N RABY,RADT,RAERR,RAWHEN,RAFLAG
"RTN","RAPM3",100,0)
 N D1,M1,Y1,M2,Y2,X
"RTN","RAPM3",101,0)
 ; RAFLAG="" determines if allow LAYGO to file 19.2, if the option "RA 
"RTN","RAPM3",102,0)
 ; PERFORMIN TASKLM" was installed in file 19.2, RAFLAG = "",
"RTN","RAPM3",103,0)
 ; if not installed, then RAFLAG = "L"
"RTN","RAPM3",104,0)
 S RAFLAG=""
"RTN","RAPM3",105,0)
 ; get task status of option
"RTN","RAPM3",106,0)
 D OPTSTAT^XUTMOPT("RA PERFORMIN TASKLM",.RAR)
"RTN","RAPM3",107,0)
 I $P($G(RAR(1)),U) D EN^DDIOL("** Option RA PERFORMIN TASKLM is already scheduled, so nothing done. **",,"!!?5") D PRESS Q
"RTN","RAPM3",108,0)
 I '$D(RAR(1)) D
"RTN","RAPM3",109,0)
 . D EN^DDIOL("** Option RA PERFORMIN TASKLM has not been installed into file 19.2 **",,"!!?5")
"RTN","RAPM3",110,0)
 . D EN^DDIOL("** will install it into file 19.2 now. **",,"!!?5")
"RTN","RAPM3",111,0)
 . S RAFLAG="L"
"RTN","RAPM3",112,0)
 . Q
"RTN","RAPM3",113,0)
 ; task the option that seems to be lost from the task queue
"RTN","RAPM3",114,0)
 D SET15
"RTN","RAPM3",115,0)
 D EN^DDIOL("Now scheduling RA PERFORMIN TASKLM to run on: ",,"!!?5")
"RTN","RAPM3",116,0)
 D RESCH^XUTMOPT("RA PERFORMIN TASKLM",RAWHEN,,RABY,RAFLAG,.RAERR)
"RTN","RAPM3",117,0)
 D OPTSTAT^XUTMOPT("RA PERFORMIN TASKLM",.RAR)
"RTN","RAPM3",118,0)
 I $D(RAR(1))#2 D EN^DDIOL("Task number :   "_+RAR(1),,"!!?37")
"RTN","RAPM3",119,0)
 D PRESS
"RTN","RAPM3",120,0)
 Q
"RTN","RAPM3",121,0)
PRESS R !!?5,"Press RETURN to continue. ",X:DTIME
"RTN","RAPM3",122,0)
 Q
"RTN","RAPM3",123,0)
SET15 ; set some variables for scheduling task
"RTN","RAPM3",124,0)
 S Y1=$E(DT,1,3),M1=$E(DT,4,5),D1=$E(DT,6,7)
"RTN","RAPM3",125,0)
 S Y2=$S(M1="12":Y1+1,1:1),M2=$S(M1="12":"01",1:M1+1)
"RTN","RAPM3",126,0)
 S:$L(M2)=1 M2="0"_M2
"RTN","RAPM3",127,0)
 D:D1=15 TODAY D:D1<15 THISM D:D1>15 NEXTM
"RTN","RAPM3",128,0)
 S RAWHEN=$$FMADD^XLFDT(RADT,,,5) ; add 5 mins to scheduled date
"RTN","RAPM3",129,0)
 S RABY="1M(15)" ; every month on the 15th day
"RTN","RAPM3",130,0)
 Q
"RTN","RAPM3",131,0)
TODAY ; today is the 15th
"RTN","RAPM3",132,0)
 S RADT=$$NOW^XLFDT
"RTN","RAPM3",133,0)
 Q
"RTN","RAPM3",134,0)
THISM ; this month on the 15th
"RTN","RAPM3",135,0)
 S RADT=Y1_M1_"15."_$P(($$NOW^XLFDT),".",2)
"RTN","RAPM3",136,0)
 Q
"RTN","RAPM3",137,0)
NEXTM ; next month on the 15th
"RTN","RAPM3",138,0)
 S RADT=Y2_M2_"15."_$P(($$NOW^XLFDT),".",2)
"RTN","RAPM3",139,0)
 Q
"RTN","RAPM3",140,0)
SFOOT ; Footer for Summary Report
"RTN","RAPM3",141,0)
 G:'RAIO SFOOT2
"RTN","RAPM3",142,0)
 I ($Y+5)>IOSL,IO=IO(0) D
"RTN","RAPM3",143,0)
 . I $E(IOST,1,2)="C-" R !,"Press RETURN to continue.",X:DTIME
"RTN","RAPM3",144,0)
 . S RAPG=RAPG+1,RAHDR="Summary Performance Indicator Report"
"RTN","RAPM3",145,0)
 . W @IOF,!?(RAIOM-$L(RAHDR)\2),RAHDR,?(RAIOM-10),"Page: ",$G(RAPG)
"RTN","RAPM3",146,0)
 W !!?5,"* Columns represent # of hours elapsed from exam date/time through",!?7,"date/time report entered or date/time report was verified."
"RTN","RAPM3",147,0)
 W !?7,"e.g. "">0-24 Hrs"" column represents those exams that had a report"
"RTN","RAPM3",148,0)
 W !?7,"transcribed and/or verified within 0-24 hours from the exam date/time."
"RTN","RAPM3",149,0)
 W !!?5,"* Columns following the initial elapsed time column "">0-24 Hrs"" begin"
"RTN","RAPM3",150,0)
 W !?7,"at .0001 after the starting hour (e.g. "">24-48 Hrs"" = starts at 24.001",!?7,"through the 48th hour.)",!
"RTN","RAPM3",151,0)
 W !?5,"* PENDING means there's no data for DATE REPORT ENTERED or VERIFIED DATE."
"RTN","RAPM3",152,0)
 W !?7,"So, if the expected report is missing one of these fields, or is missing"
"RTN","RAPM3",153,0)
 W !?7,"data for fields .01 through 17 from file #74, RAD/NUC MED REPORTS, or"
"RTN","RAPM3",154,0)
 W !?7,"is a Stub Report that was entered by the Imaging package when images"
"RTN","RAPM3",155,0)
 W !?7,"were captured before a report was entered, then the expected report"
"RTN","RAPM3",156,0)
 W !?7,"would be counted in the PENDING column."
"RTN","RAPM3",157,0)
 ;
"RTN","RAPM3",158,0)
SFOOT2 ; store in tmp
"RTN","RAPM3",159,0)
 S (^TMP($J,"RAPM",RAN),^TMP($J,"RAPM",RAN+1))="",RAN=RAN+1
"RTN","RAPM3",160,0)
 ;
"RTN","RAPM3",161,0)
 S ^TMP($J,"RAPM",RAN)="    * Columns represent # of hours elapsed from exam date/time through",RAN=RAN+1
"RTN","RAPM3",162,0)
 S ^TMP($J,"RAPM",RAN)="      date/time report entered or date/time report was verified.",RAN=RAN+1
"RTN","RAPM3",163,0)
 S ^TMP($J,"RAPM",RAN)="      e.g. "">0-24 Hrs"" column represents those exams that had a report",RAN=RAN+1
"RTN","RAPM3",164,0)
 S ^TMP($J,"RAPM",RAN)="      transcribed and/or verified within 0-24 hours from the exam date/time.",RAN=RAN+1
"RTN","RAPM3",165,0)
 S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM3",166,0)
 S ^TMP($J,"RAPM",RAN)="    * Columns following the initial elapsed time column (0-24 Hrs) begin",RAN=RAN+1
"RTN","RAPM3",167,0)
 S ^TMP($J,"RAPM",RAN)="      at .0001 after the starting hour (e.g. "">24-48 Hrs"" = starts at 24.001",RAN=RAN+1
"RTN","RAPM3",168,0)
 S ^TMP($J,"RAPM",RAN)="      through the 48th hour.)",RAN=RAN+1
"RTN","RAPM3",169,0)
 S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM3",170,0)
 S ^TMP($J,"RAPM",RAN)="    * PENDING means there's no data for DATE REPORT ENTERED or VERIFIED DATE.",RAN=RAN+1
"RTN","RAPM3",171,0)
 S ^TMP($J,"RAPM",RAN)="      So, if the expected report is missing one of these fields, or is missing",RAN=RAN+1
"RTN","RAPM3",172,0)
 S ^TMP($J,"RAPM",RAN)="      data for fields .01 through 17 from file #74, RAD/NUC MED REPORTS, or",RAN=RAN+1
"RTN","RAPM3",173,0)
 S ^TMP($J,"RAPM",RAN)="      is a Stub Report that was entered by the Imaging package when images",RAN=RAN+1
"RTN","RAPM3",174,0)
 S ^TMP($J,"RAPM",RAN)="      were captured before a report was entered, then the expected report",RAN=RAN+1
"RTN","RAPM3",175,0)
 S ^TMP($J,"RAPM",RAN)="      would be counted in the PENDING column."
"RTN","RAPM3",176,0)
 D BFOOT
"RTN","RAPM3",177,0)
 Q
"RTN","RAPM3",178,0)
BFOOT ;footer for both
"RTN","RAPM3",179,0)
 G:'RAIO BFOOT2
"RTN","RAPM3",180,0)
 W !!?5,"* A printset, i.e., a set of multiple exams that share the same report,",!?7,"will be expected to have 1 report."
"RTN","RAPM3",181,0)
BFOOT2 ; used in summary
"RTN","RAPM3",182,0)
 Q:'$G(RAN)
"RTN","RAPM3",183,0)
 S RAN=RAN+1
"RTN","RAPM3",184,0)
 S ^TMP($J,"RAPM",RAN)="",RAN=RAN+1
"RTN","RAPM3",185,0)
 S ^TMP($J,"RAPM",RAN)="    * A printset, i.e., a set of multiple exams that share the same report,",RAN=RAN+1
"RTN","RAPM3",186,0)
 S ^TMP($J,"RAPM",RAN)="      will be expected to have 1 report."
"RTN","RAPM3",187,0)
 Q
"RTN","RAPM3",188,0)
RADIOL ; select Radiologist for Summary Report
"RTN","RAPM3",189,0)
 W !
"RTN","RAPM3",190,0)
 S DIC("S")="I $D(^VA(200,""ARC"",""R"",Y))!($D(^VA(200,""ARC"",""S"",Y)))",DIC("A")="Select Primary Interpreting Staff Physician (Optional): ",DIC="^VA(200,",DIC(0)="AEMQ" D ^DIC K DIC Q:Y<0  S RARAD=+Y
"RTN","RAPM3",191,0)
 Q
"RTN","RAPM4")
0^3^B2800303
"RTN","RAPM4",1,0)
RAPM4 ;HOIFO/TH-Radiology Performance Monitors/Indicator; ;8/05/05  14:06
"RTN","RAPM4",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**63**;Mar 16, 1998
"RTN","RAPM4",3,0)
CKMONTH ; If requested an entire month's data, ask if output goes to OQP
"RTN","RAPM4",4,0)
 N RAM,RAMINT
"RTN","RAPM4",5,0)
 S RAM=$E(RABDATE,4,5)
"RTN","RAPM4",6,0)
 Q:RAM'=$E(RAEDATE,4,5)  ;diff months
"RTN","RAPM4",7,0)
 ; find min total days for the requested month
"RTN","RAPM4",8,0)
 S RAMINT=31 S:RAM="02" RAMINT=28 I "04^06^09^11"[RAM S RAMINT=30
"RTN","RAPM4",9,0)
 S X1=RAEDATE,X2=RABDATE D ^%DTC
"RTN","RAPM4",10,0)
 I (X+1)'<RAMINT D HQASK
"RTN","RAPM4",11,0)
 Q
"RTN","RAPM4",12,0)
HQASK ;
"RTN","RAPM4",13,0)
 N DIR
"RTN","RAPM4",14,0)
 S DIR("A",1)=" "
"RTN","RAPM4",15,0)
 S:'$D(RALASTM) DIR("A",2)="  You have requested an entire month's data."
"RTN","RAPM4",16,0)
 S DIR("A",3)="  Do you want to include the OQP Performance Management staff"
"RTN","RAPM4",17,0)
 S DIR("A")="  as a recipient of this output"
"RTN","RAPM4",18,0)
 S DIR(0)="Y",DIR("B")="NO"
"RTN","RAPM4",19,0)
 S DIR("?",1)="   Normally, the OQP Performance Management (Headquarters) only receive"
"RTN","RAPM4",20,0)
 S DIR("?",2)="   the automatic mid-month report.  However, if they missed the report"
"RTN","RAPM4",21,0)
 S DIR("?",3)="   for the month specified above, and you want them to receive it,"
"RTN","RAPM4",22,0)
 S DIR("?")="   answer ""Y""."
"RTN","RAPM4",23,0)
 D ^DIR I Y S RAUTOM=1
"RTN","RAPM4",24,0)
 Q
"UP",79,79.0175,-1)
79^1
"UP",79,79.0175,0)
79.0175
"VER")
8.0^22.0
"^DD",79,79.0175,1,0)
OQP PERFORMANCE MGMT?^S^Y:YES;N:NO;^0;2^Q
"^DD",79,79.0175,1,3)
Enter  Y  if this address is for Headquarters, so that it will not receive manually initiated reports, but will only receive the automatic mid-month report.
"^DD",79,79.0175,1,21,0)
^^14^14^3050808^
"^DD",79,79.0175,1,21,1,0)
This field is used to flag the Outlook SMTP address for Headquarters.
"^DD",79,79.0175,1,21,2,0)
 
"^DD",79,79.0175,1,21,3,0)
The performance indicator options will check this field to determine 
"^DD",79,79.0175,1,21,4,0)
if a report should be sent to the corresponding SMTP address.
"^DD",79,79.0175,1,21,5,0)
 
"^DD",79,79.0175,1,21,6,0)
If this field is "Y", then the corresponding SMTP address would 
"^DD",79,79.0175,1,21,7,0)
receive the automatic mid-month report.  But it will only receive
"^DD",79,79.0175,1,21,8,0)
manually initiated reports if that report was requested for 
"^DD",79,79.0175,1,21,9,0)
(1) a full month's data (any full month in the past), and 
"^DD",79,79.0175,1,21,10,0)
(2) the user replies "Y" to the question about sending the output 
"^DD",79,79.0175,1,21,11,0)
to "OQP Performance Mgmt".
"^DD",79,79.0175,1,21,12,0)
 
"^DD",79,79.0175,1,21,13,0)
If this field is "N", then the corresponding SMTP address would
"^DD",79,79.0175,1,21,14,0)
receive all reports, whether automatic or manually initiated.
"^DD",79,79.0175,1,"DT")
3050805
"BLD",5734,6)
^SEQ #53
**END**
**END**
