Released GMTS*2.7*46 SEQ #43
Extracted from mail message
**KIDS**:GMTS*2.7*46^

**INSTALL NAME**
GMTS*2.7*46
"BLD",2252,0)
GMTS*2.7*46^HEALTH SUMMARY^0^3010625^y
"BLD",2252,1,0)
^^2^2^3010313^^
"BLD",2252,1,1,0)
The description of this patch may be found on the National Patch Module 
"BLD",2252,1,2,0)
under GMTS*2.7*46.
"BLD",2252,4,0)
^9.64PA^^
"BLD",2252,"ABPKG")
n
"BLD",2252,"INID")
^y
"BLD",2252,"INIT")
POST^GMTSP46
"BLD",2252,"KRN",0)
^9.67PA^19^17
"BLD",2252,"KRN",.4,0)
.4
"BLD",2252,"KRN",.401,0)
.401
"BLD",2252,"KRN",.402,0)
.402
"BLD",2252,"KRN",.403,0)
.403
"BLD",2252,"KRN",.5,0)
.5
"BLD",2252,"KRN",.84,0)
.84
"BLD",2252,"KRN",3.6,0)
3.6
"BLD",2252,"KRN",3.8,0)
3.8
"BLD",2252,"KRN",9.2,0)
9.2
"BLD",2252,"KRN",9.8,0)
9.8
"BLD",2252,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",2252,"KRN",9.8,"NM",1,0)
GMTSCNB^^0^B43668567
"BLD",2252,"KRN",9.8,"NM",2,0)
GMTSXPS1^^0^B63829359
"BLD",2252,"KRN",9.8,"NM","B","GMTSCNB",1)

"BLD",2252,"KRN",9.8,"NM","B","GMTSXPS1",2)

"BLD",2252,"KRN",19,0)
19
"BLD",2252,"KRN",19.1,0)
19.1
"BLD",2252,"KRN",101,0)
101
"BLD",2252,"KRN",409.61,0)
409.61
"BLD",2252,"KRN",771,0)
771
"BLD",2252,"KRN",870,0)
870
"BLD",2252,"KRN",8994,0)
8994
"BLD",2252,"KRN","B",.4,.4)

"BLD",2252,"KRN","B",.401,.401)

"BLD",2252,"KRN","B",.402,.402)

"BLD",2252,"KRN","B",.403,.403)

"BLD",2252,"KRN","B",.5,.5)

"BLD",2252,"KRN","B",.84,.84)

"BLD",2252,"KRN","B",3.6,3.6)

"BLD",2252,"KRN","B",3.8,3.8)

"BLD",2252,"KRN","B",9.2,9.2)

"BLD",2252,"KRN","B",9.8,9.8)

"BLD",2252,"KRN","B",19,19)

"BLD",2252,"KRN","B",19.1,19.1)

"BLD",2252,"KRN","B",101,101)

"BLD",2252,"KRN","B",409.61,409.61)

"BLD",2252,"KRN","B",771,771)

"BLD",2252,"KRN","B",870,870)

"BLD",2252,"KRN","B",8994,8994)

"BLD",2252,"QUES",0)
^9.62^^
"BLD",2252,"REQB",0)
^9.611^1^1
"BLD",2252,"REQB",1,0)
GMTS*2.7*34^2
"BLD",2252,"REQB","B","GMTS*2.7*34",1)

"INIT")
POST^GMTSP46
"MBREQ")
0
"PKG",126,-1)
1^1
"PKG",126,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools^^^3010208
"PKG",126,20,0)
^9.402P^^
"PKG",126,22,0)
^9.49I^1^1
"PKG",126,22,1,0)
2.7^2951020^2951020^11
"PKG",126,22,1,"PAH",1,0)
46^3010625
"PKG",126,22,1,"PAH",1,1,0)
^^2^2^3010625
"PKG",126,22,1,"PAH",1,1,1,0)
The description of this patch may be found on the National Patch Module 
"PKG",126,22,1,"PAH",1,1,2,0)
under GMTS*2.7*46.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","GMTSCNB")
0^1^B43668567
"RTN","GMTSCNB",1,0)
GMTSCNB ; SLC/KER - Consults Components Brief          ; 03/14/2001
"RTN","GMTSCNB",2,0)
 ;;2.7;Health Summary;**46**;Oct 20, 1995
"RTN","GMTSCNB",3,0)
 Q
"RTN","GMTSCNB",4,0)
MAIN ; Consults - Brief
"RTN","GMTSCNB",5,0)
 K ^TMP("GMTSCN")
"RTN","GMTSCNB",6,0)
 N GMTSNMC,GMTSI,GMTSDFN S GMTSDFN=+($G(DFN))
"RTN","GMTSCNB",7,0)
 S:'$L($G(GMTS1)) GMTS1=6666666 S:'$L($G(GMTS2)) GMTS2=9999999
"RTN","GMTSCNB",8,0)
 S GMTS1=+($G(GMTS1)),GMTS2=+($G(GMTS2)),GMTSNDM=+($G(GMTSNDM)) S:GMTSNDM=0 GMTSNDM=999999999
"RTN","GMTSCNB",9,0)
 S GMTSDFN=+($G(GMTSDFN)) Q:GMTSDFN=0  Q:'$D(^GMR(123,"AD",GMTSDFN))
"RTN","GMTSCNB",10,0)
 S:GMTS2>GMTS1 GMTSI=GMTS1,GMTS1=GMTS2,GMTS2=GMTSI S GMTSI=GMTS2-.00000001
"RTN","GMTSCNB",11,0)
 F  S GMTSI=$O(^GMR(123,"AD",GMTSDFN,GMTSI)) Q:+GMTSI=0!(GMTSI>GMTS1)  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",12,0)
 . S GMTSIEN=0 F  S GMTSIEN=$O(^GMR(123,"AD",GMTSDFN,GMTSI,GMTSIEN)) Q:+GMTSIEN=0  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",13,0)
 . . Q:+($G(GMTSNMC))>+($G(GMTSNDM))  K ^TMP("GMTSCN",$J)
"RTN","GMTSCNB",14,0)
 . . D EXT(GMTSIEN,GMTSI) Q:$D(GMTSQIT)  D BCD Q:$D(GMTSQIT)
"RTN","GMTSCNB",15,0)
 Q
"RTN","GMTSCNB",16,0)
BCD ;   Brief Consults Display
"RTN","GMTSCNB",17,0)
 Q:'$D(^TMP("GMTSCN",$J))  S GMTSNMC=+($G(GMTSNMC))+1
"RTN","GMTSCNB",18,0)
 D:GMTSNMC=1 BHDR Q:$D(GMTSQIT)
"RTN","GMTSCNB",19,0)
 N GMTSID,GMTSFI,GMTSIE S GMTSID=0
"RTN","GMTSCNB",20,0)
 F  S GMTSID=$O(^TMP("GMTSCN",$J,GMTSID)) Q:+GMTSID=0  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",21,0)
 . S GMTSFI=123,GMTSIE="" F  S GMTSIE=$O(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE)) Q:GMTSIE=""  D  Q:$D(GMTSQIT)
"RTN","GMTSCNB",22,0)
 . . N GMTSNB,GMTSRD,GMTSTO,GMTSVC,GMTSFM,GMTSLA,GMTSAD
"RTN","GMTSCNB",23,0)
 . . S GMTSNB=+($G(GMTSIE)) S:+GMTSNB=0 GMTSNB="?"
"RTN","GMTSCNB",24,0)
 . . S GMTSRD=$G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,3,"I"))
"RTN","GMTSCNB",25,0)
 . . S GMTSRD=$$UP^XLFSTR($S(+GMTSRD>0:$$ED^GMTSU(+GMTSRD),1:"UNKNOWN"))
"RTN","GMTSCNB",26,0)
 . . S GMTSFM=$$UP^XLFSTR($G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,2,"E")))
"RTN","GMTSCNB",27,0)
 . . S GMTSTO=$$UP^XLFSTR($G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,1,"E")))
"RTN","GMTSCNB",28,0)
 . . S GMTSLA=$$UP^XLFSTR($G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,40,1,1,"E")))
"RTN","GMTSCNB",29,0)
 . . S GMTSLD=$G(^TMP("GMTSCN",$J,GMTSID,GMTSFI,GMTSIE,40,1,2,"I"))
"RTN","GMTSCNB",30,0)
 . . S GMTSLD=$$UP^XLFSTR($S(+GMTSLD>0:$$ED^GMTSU(+GMTSLD),1:"UNKNOWN"))
"RTN","GMTSCNB",31,0)
 . . D WRT
"RTN","GMTSCNB",32,0)
 Q
"RTN","GMTSCNB",33,0)
BHDR ;   Brief Header
"RTN","GMTSCNB",34,0)
 N GMTSL S $P(GMTSL,"-",79)=""
"RTN","GMTSCNB",35,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Request Date/",?15,"Request From"
"RTN","GMTSCNB",36,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Number",?15,"Request To",?52,"Last Action",?67,"Action Date"
"RTN","GMTSCNB",37,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,GMTSL
"RTN","GMTSCNB",38,0)
 Q
"RTN","GMTSCNB",39,0)
WRT ;   Write Brief Consult
"RTN","GMTSCNB",40,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,$E(GMTSRD,1,10),?15,GMTSFM,?52,GMTSLA,?67,GMTSLD
"RTN","GMTSCNB",41,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,GMTSNB,?15,GMTSTO
"RTN","GMTSCNB",42,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSCNB",43,0)
 Q
"RTN","GMTSCNB",44,0)
EXT(X,Y) ; Extract Consults
"RTN","GMTSCNB",45,0)
 K ^TMP("GMTSCN",$J),^UTILITY("DIQ1",$J) N DIC,DIQ,DR,GMTSFM,GMTSI
"RTN","GMTSCNB",46,0)
 N GMTSIEN,GMTSIENS,GMTSLA,GMTSRT,GMTSTY,GMTSVC
"RTN","GMTSCNB",47,0)
 S GMTSIEN=+($G(X)) Q:GMTSIEN=0  S GMTSI=+($G(Y))
"RTN","GMTSCNB",48,0)
 S DIC=123,GMTSIENS=+($G(GMTSIEN))_","
"RTN","GMTSCNB",49,0)
 S GMTSRT="^TMP(""GMTSCN"","_$J_","_GMTSI_")"
"RTN","GMTSCNB",50,0)
 S DIQ(0)="IE",DR=".01;1;2;3;9" D GETS^DIQ(123,GMTSIENS,DR,"EI",GMTSRT,"MSG")
"RTN","GMTSCNB",51,0)
 S GMTSFM=+($G(^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"I"))) S:+GMTSFM=0 GMTSFM=""
"RTN","GMTSCNB",52,0)
 S GMTSVC="" S:+GMTSFM>0 GMTSVC=$$GET1^DIQ(44,GMTSFM,9,"E") S:$G(GMTSVC)="NONE" GMTSVC=""
"RTN","GMTSCNB",53,0)
 S:$L(GMTSVC) ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"SVC")=GMTSVC
"RTN","GMTSCNB",54,0)
 S GMTSTY="" S:+GMTSFM>0 GMTSTY=$$GET1^DIQ(44,GMTSFM,2,"E")
"RTN","GMTSCNB",55,0)
 S GMTSFM=$$FM(($G(^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"E"))_"^"_GMTSTY_"^"_GMTSVC))
"RTN","GMTSCNB",56,0)
 S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,2,"E")=GMTSFM
"RTN","GMTSCNB",57,0)
 S GMTSLA=+($G(^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,9,"I")))
"RTN","GMTSCNB",58,0)
 S:+GMTSLA'>9 ^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,9,"E")=""
"RTN","GMTSCNB",59,0)
 I +GMTSLA>0 D
"RTN","GMTSCNB",60,0)
 . S GMTSLA=$$GET1^DIQ(123.1,GMTSLA,7,"E")
"RTN","GMTSCNB",61,0)
 . S ^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,9,"E")=GMTSLA
"RTN","GMTSCNB",62,0)
 S ^TMP("GMTSCN",$J,GMTSI,DIC,GMTSIENS,0)=(9999999-GMTSI)_"^"_$S(GMTSI>0:$$EDT^GMTSU((9999999-GMTSI)),1:"")
"RTN","GMTSCNB",63,0)
 D ACT
"RTN","GMTSCNB",64,0)
 Q
"RTN","GMTSCNB",65,0)
FM(X) ; From Service/Ward
"RTN","GMTSCNB",66,0)
 S X=$G(X) N GMTSTY,GMTSV S GMTSTY=$P(X,"^",2),GMTSV=$P(X,"^",3),X=$P(X,"^",1)
"RTN","GMTSCNB",67,0)
 I $L(X) S:+X>0&(GMTSTY="WARD")&(X'["WARD") X="WARD "_X S:+X'>0&(GMTSTY="WARD")&(X'["WARD") X=X_" WARD"
"RTN","GMTSCNB",68,0)
 S:($L(X)+$L(GMTSV)+3)'>30&($L(GMTSV))&(X'[GMTSV) X=X_" ("_GMTSV_")"
"RTN","GMTSCNB",69,0)
 S X=$$UP^XLFSTR(X)
"RTN","GMTSCNB",70,0)
 Q X
"RTN","GMTSCNB",71,0)
ACT ; Activity
"RTN","GMTSCNB",72,0)
 N GMTSL,GMTSFL,GMTSFLA,GMTSFLD,GMTSLA,GMTSLD,GMTSLR,GMTSAM,GMTSLM,GMTSLP,GMTSC,GMTSDI,Y,DR,GMTSIENL,GMTSIENS,GMTSMSG K ^TMP("DILIST",$J)
"RTN","GMTSCNB",73,0)
 S GMTSIENS=+GMTSIEN_",",GMTSIENL=","_GMTSIENS
"RTN","GMTSCNB",74,0)
 S DR="1I;2I;8;9;10"
"RTN","GMTSCNB",75,0)
 D LIST^DIC(123.02,GMTSIENL,DR,,"*",,,,,,.GMTSDI,.GMTSMSG)
"RTN","GMTSCNB",76,0)
 K:+($G(^TMP("DILIST",$J,0)))=0 ^TMP("DILIST",$J) Q:+($G(^TMP("DILIST",$J,0)))=0
"RTN","GMTSCNB",77,0)
 S GMTSLA="",GMTSLD=0,GMTSLR="",GMTSAM="",GMTSLP="",GMTSC=0
"RTN","GMTSCNB",78,0)
 S GMTSL=0
"RTN","GMTSCNB",79,0)
 F  S GMTSL=$O(^TMP("DILIST",$J,"ID",GMTSL)) Q:+GMTSL=0  D
"RTN","GMTSCNB",80,0)
 . I +($G(^TMP("DILIST",$J,"ID",GMTSL,2)))'<GMTSLD,+($G(^TMP("DILIST",$J,"ID",GMTSL,2)))>0 D
"RTN","GMTSCNB",81,0)
 . . S GMTSLP=$G(^TMP("DILIST",$J,"ID",GMTSL,8))
"RTN","GMTSCNB",82,0)
 . . S GMTSLA=+($G(^TMP("DILIST",$J,"ID",GMTSL,1)))
"RTN","GMTSCNB",83,0)
 . . S GMTSLD=+($G(^TMP("DILIST",$J,"ID",GMTSL,2)))
"RTN","GMTSCNB",84,0)
 . . S GMTSLR=$G(^TMP("DILIST",$J,"ID",GMTSL,9))
"RTN","GMTSCNB",85,0)
 . . S GMTSLM=$G(^TMP("DILIST",$J,"ID",GMTSL,10))
"RTN","GMTSCNB",86,0)
 I +($G(GMTSFLA))>0,+($G(GMTSFLD))>0,+($G(GMTSFL))>0,GMTSR'>0 S GMTSC=0,GMTSLA=GMTSFLA,GMTSLD=GMTSFLA D AAC
"RTN","GMTSCNB",87,0)
 I GMTSLA>0,GMTSLD>0 S GMTSC=1 D AAC
"RTN","GMTSCNB",88,0)
 K ^TMP("DILIST",$J)
"RTN","GMTSCNB",89,0)
 Q
"RTN","GMTSCNB",90,0)
AAC ;   Add Activity
"RTN","GMTSCNB",91,0)
 N GMTSEA,GMTSEP,GMTSEL,GMTSOR,GMTSW,I S GMTSC=+($G(GMTSC))
"RTN","GMTSCNB",92,0)
 S GMTSOR=$$UP^XLFSTR($$GET1^DIQ(123.1,GMTSLA,1,"I"))
"RTN","GMTSCNB",93,0)
 S GMTSEP=$$UP^XLFSTR($$GET1^DIQ(123.1,GMTSLA,7,"E"))
"RTN","GMTSCNB",94,0)
 S GMTSEA=$$UP^XLFSTR($$GET1^DIQ(123.1,GMTSLA,.01,"E"))
"RTN","GMTSCNB",95,0)
 S GMTSEL=$$AL(GMTSEA,GMTSEP) Q:'$L(GMTSEL)
"RTN","GMTSCNB",96,0)
 S GMTSEA=$$AN(GMTSEA,GMTSEP) Q:'$L(GMTSEA)
"RTN","GMTSCNB",97,0)
 I GMTSC>0 D
"RTN","GMTSCNB",98,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,1,"I")=GMTSLA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,1,"E")=GMTSEA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,1,"L")=GMTSEL
"RTN","GMTSCNB",99,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,2,"I")=GMTSLD,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,GMTSC,2,"E")=$$EDT^GMTSU(GMTSLD)
"RTN","GMTSCNB",100,0)
 I GMTSC'>0 D
"RTN","GMTSCNB",101,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LA","I")=GMTSLA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LA","E")=GMTSEA,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LA","L")=GMTSEL
"RTN","GMTSCNB",102,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LD","I")=GMTSLD,^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"LD","E")=$$EDT^GMTSU(GMTSLD)
"RTN","GMTSCNB",103,0)
 . S ^TMP("GMTSCN",$J,GMTSI,123,GMTSIENS,40,"WR","E")=$G(^TMP("DILIST",$J,"ID",GMTSFL,3))
"RTN","GMTSCNB",104,0)
 Q
"RTN","GMTSCNB",105,0)
AN(X,Y) ;   Activity Name
"RTN","GMTSCNB",106,0)
 N GMTSW,GMTSP,GMTSA S GMTSA=$G(X),GMTSP=$G(Y) S X=$$SN((GMTSA_" "_GMTSP)) S X=$E(X,1,11) Q X
"RTN","GMTSCNB",107,0)
AL(X,Y) ;   Activity Name
"RTN","GMTSCNB",108,0)
 N GMTSP,GMTSA S GMTSA=$G(X),GMTSP=$G(Y) S:GMTSA["RECEIVE" (GMTSA,GMTSP)="RECEIVED"
"RTN","GMTSCNB",109,0)
 S:GMTSA="ENTERED IN CPRS"!(GMTSA["CPRS RELEASED") (GMTSA,GMTSP)="DATA ENTRY" S:GMTSA="EDIT BEFORE RELEASE" (GMTSA,GMTSP)="EDITITED"
"RTN","GMTSCNB",110,0)
 S X="" S:$L(GMTSA)&($L(GMTSP)) X=$S($L(GMTSP)>$L(GMTSA):GMTSP,1:GMTSA) S:'$L(GMTSA)!('$L(GMTSP)) X=$S('$L(GMTSP)&($L(GMTSA)):GMTSA,$L(GMTSP)&('$L(GMTSA)):GMTSP,1:"")
"RTN","GMTSCNB",111,0)
 Q X
"RTN","GMTSCNB",112,0)
SN(X) ;
"RTN","GMTSCNB",113,0)
 S X=$G(X) Q:X="" "UNKNOWN" Q:X["ENTERED"!(X["RELEASED") "ENTERED" Q:X["STATUS" "STAT CHG"
"RTN","GMTSCNB",114,0)
 Q:X["SIGNIF" "SIG FIND" Q:X["DISCONT" "DISCONT'D" Q:X["SCHEDUL" "SCHEDULED" Q:X["INCOMPL" "INCOMPLETE" Q:X["COMPLET" "COMPLETE"
"RTN","GMTSCNB",115,0)
 Q:X["EDIT" "EDITED" Q:X["DISASSO" "DISASSOC'D" Q:X["ADDENDUM" "ADDENDUM" Q:X["NEW NOTE" "NEW NOTE"
"RTN","GMTSCNB",116,0)
 Q:X["SERVICE" "SVC ENTER" Q:X["FORWARD" "FORWARDED" Q:X["CANCELLED" "CANCELLED" Q:X["COMMENT" "COMMENT" Q:X["RECEIVED" "RECEIVED" Q:X["PRINTED" "OUTPUT"
"RTN","GMTSCNB",117,0)
 Q "UNKNOWN"
"RTN","GMTSP46")
0^^B9630919
"RTN","GMTSP46",1,0)
GMTSP46 ; CIO/SLC - Post Install GMTS*2.7*46    ; 03/14/2001
"RTN","GMTSP46",2,0)
 ;;2.7;Health Summary;**46**;Oct 20, 1995
"RTN","GMTSP46",3,0)
 Q
"RTN","GMTSP46",4,0)
POST ; Post Install
"RTN","GMTSP46",5,0)
 N GMTSIN,GMTSINST,GMTSTL,GMTSGAF,GMTSVSD,GMTSINST,GMTSBLD,GMTSHORT
"RTN","GMTSP46",6,0)
 D CI I +$$ROK("GMTSXPS1")>0 S GMTSHORT=1,GMTSINST="",GMTSBLD="GMTS*2.7*46" D SEND^GMTSXPS1
"RTN","GMTSP46",7,0)
 Q
"RTN","GMTSP46",8,0)
CI ; Component Install
"RTN","GMTSP46",9,0)
 N GMTSOK,GMTSIN,GMTSINST,GMTSTL,GMTSINST,GMTSTOT,GMTSBLD,GMTSCPS,GMTSCP,GMTSCI
"RTN","GMTSP46",10,0)
 S GMTSCPS="CNB"
"RTN","GMTSP46",11,0)
 S GMTSOK=0,GMTSOK=GMTSOK+$$ROK("GMTSXPD1"),GMTSOK=GMTSOK+$$ROK("GMTSXPD3")
"RTN","GMTSP46",12,0)
 I GMTSOK'=2 W !!," >> Can not install component CNB",!,"    Could not find install routines GMTSXPD*" Q
"RTN","GMTSP46",13,0)
 F GMTSCI=1:1 Q:'$L($P(GMTSCPS,";",GMTSCI))  D
"RTN","GMTSP46",14,0)
 . S GMTSCP=$P(GMTSCPS,";",GMTSCI)
"RTN","GMTSP46",15,0)
 . D ARRAY Q:'$D(GMTSIN)  S GMTSINST=$$ADD^GMTSXPD1(.GMTSIN),GMTSTOT=+($G(GMTSTOT))+GMTSINST
"RTN","GMTSP46",16,0)
 ; Rebuild Ad Hoc Health Summary Type
"RTN","GMTSP46",17,0)
 D:+($G(GMTSTOT))>0 BUILD^GMTSXPD3
"RTN","GMTSP46",18,0)
 Q
"RTN","GMTSP46",19,0)
ROK(X) ; Routine OK
"RTN","GMTSP46",20,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSP46",21,0)
ARRAY ; Build Array
"RTN","GMTSP46",22,0)
 K GMTSIN N GMTSI,GMTSTXT,GMTSEX,GMTSFLD,GMTSV,GMTSPDX,GMTSDD,GMTSFLDS
"RTN","GMTSP46",23,0)
 S GMTSPDX=0,GMTSCP=$G(GMTSCP) Q:'$L(GMTSCP)
"RTN","GMTSP46",24,0)
 S GMTSDD(0)="1;.01^2;1^3;2^4;3^5;4^6;5^7;6^8;8^9;9^10;10^11;11^12;12^13;13^14;14"
"RTN","GMTSP46",25,0)
 S GMTSDD(.1)="1.1",GMTSDD(.1,0)="1;.01",GMTSDD(1)="7",GMTSDD(1,0)="1;.01^2;1",GMTSDD(3.5)="3.5",GMTSDD(3.5,0)="1;.01",GMTSDD("VA")="1;15^2;16^3;17^4;18"
"RTN","GMTSP46",26,0)
 S GMTSFLDS=".01;1;2;3;4;5;6;8;9;10;11;12;13;14;15;16;17;18^1.1;7;3.5"
"RTN","GMTSP46",27,0)
 N GMTSND,GMTSNS,GMTSNI,GMTSNP,GMTSNV,GMTSV,GMTSTR
"RTN","GMTSP46",28,0)
 F GMTSI=1:1 D  Q:'$L(GMTSTXT)
"RTN","GMTSP46",29,0)
 . S GMTSTXT="",GMTSEX="S GMTSTXT=$T("_GMTSCP_"+"_GMTSI_")"
"RTN","GMTSP46",30,0)
 . X GMTSEX S:$L(GMTSTXT,";")'>3 GMTSTXT="" Q:'$L(GMTSTXT)
"RTN","GMTSP46",31,0)
 . S GMTSND=$P(GMTSTXT,";",2),GMTSNS=$P(GMTSTXT,";",3)
"RTN","GMTSP46",32,0)
 . S GMTSNI=$P(GMTSTXT,";",4),GMTSNV=$P(GMTSTXT,";",5,299)
"RTN","GMTSP46",33,0)
 . S:GMTSND="PDX"&(GMTSNV=1) GMTSPDX=1,GMTSTXT="" Q:GMTSND="PDX"
"RTN","GMTSP46",34,0)
 . S:GMTSND="IEN"&(+($G(GMTSNV))>0) GMTSIN(0)=+($G(GMTSNV)) Q:GMTSND="IEN"
"RTN","GMTSP46",35,0)
 . F GMTSNP=1:1:$L(GMTSNV,"^") D
"RTN","GMTSP46",36,0)
 . . S GMTSV=$P(GMTSNV,"^",GMTSNP) Q:'$L(GMTSV)
"RTN","GMTSP46",37,0)
 . . S GMTSTR=$P($G(GMTSDD(GMTSND)),"^",GMTSNP),GMTSFLD=$P(GMTSTR,";",2)
"RTN","GMTSP46",38,0)
 . . S:$L(GMTSNS) GMTSTR=$P($G(GMTSDD(GMTSND,GMTSNS)),"^",GMTSNP),GMTSFLD=$G(GMTSDD(GMTSND))
"RTN","GMTSP46",39,0)
 . . S:GMTSNI'>0 GMTSIN(GMTSFLD)=GMTSV
"RTN","GMTSP46",40,0)
 . . S:GMTSNI>0 GMTSIN(GMTSFLD,GMTSNI)=GMTSV,GMTSIN(GMTSFLD,0)=+($G(GMTSIN(GMTSFLD,0)))+1
"RTN","GMTSP46",41,0)
 S:GMTSPDX GMTSIN("PDX")=1 F GMTSI=1:1 Q:'$L($P($P(GMTSFLDS,"^",1),";",GMTSI))  D
"RTN","GMTSP46",42,0)
 . S GMTSFLD=$P($P(GMTSFLDS,"^",1),";",GMTSI) S:$L(GMTSFLD)&('$D(GMTSIN(GMTSFLD))) GMTSIN(GMTSFLD)=""
"RTN","GMTSP46",43,0)
 F GMTSI=1:1 Q:'$L($P($P(GMTSFLDS,"^",2),";",GMTSI))  D
"RTN","GMTSP46",44,0)
 . S GMTSFLD=$P($P(GMTSFLDS,"^",2),";",GMTSI) S:$L(GMTSFLD)&('$D(GMTSIN(GMTSFLD))) GMTSIN(GMTSFLD)=0
"RTN","GMTSP46",45,0)
 Q
"RTN","GMTSP46",46,0)
 ;
"RTN","GMTSP46",47,0)
CNB ; Brief Consults
"RTN","GMTSP46",48,0)
 ;IEN;;;240
"RTN","GMTSP46",49,0)
 ;0;;;CONSULTS BRIEF^MAIN;GMTSCNB^Y^CNB^Y^^^^Brief Consults^^^^GMRC
"RTN","GMTSP46",50,0)
 ;.1;0;1;MAIN;GMTSCNB
"RTN","GMTSP46",51,0)
 ;3.5;0;1;This component displays Consults in a brief format, to include the consult 
"RTN","GMTSP46",52,0)
 ;3.5;0;2;number, request date, requesting service, last action, last action date, and 
"RTN","GMTSP46",53,0)
 ;3.5;0;3;the consult "TO" service.
"RTN","GMTSP46",54,0)
 ;PDX;;;1
"RTN","GMTSP46",55,0)
 ;
"RTN","GMTSXPS1")
0^2^B63829359
"RTN","GMTSXPS1",1,0)
GMTSXPS1 ; SLC/KER - Health Summary Status       ; 03/14/2001
"RTN","GMTSXPS1",2,0)
 ;;2.7;Health Summary;**35,34,46**;Oct 20, 1995
"RTN","GMTSXPS1",3,0)
 ;
"RTN","GMTSXPS1",4,0)
EN ; Display status only
"RTN","GMTSXPS1",5,0)
 N POP,GMTSENV S GMTSENV=$$ENV Q:'GMTSENV
"RTN","GMTSXPS1",6,0)
 K ^TMP($J,"GMTSINFO"),GMTSMAIL N X,Y,ZTSAVE D HDR
"RTN","GMTSXPS1",7,0)
 D:'$D(GMTSHORT) FI,INS^GMTSXPS2 D OUTPUT Q
"RTN","GMTSXPS1",8,0)
SEND ; Send status to G.GMTS@ISC-SLC.VA.GOV
"RTN","GMTSXPS1",9,0)
 N POP,GMTSENV S GMTSENV=$$ENV2 Q:'GMTSENV
"RTN","GMTSXPS1",10,0)
 S GMTSIENS=$G(GMTSIENS) S:$L(GMTSIENS) GMTSIENS=";"_GMTSIENS_";"
"RTN","GMTSXPS1",11,0)
 S GMTSENV=$$ROK("XMD") Q:'GMTSENV  K ^TMP($J,"GMTSINFO") N X,Y,ZTSAVE,ZTQUEUED,ZTREQ,ZTRTN
"RTN","GMTSXPS1",12,0)
 S:$D(GMTSHORT) ZTSAVE("GMTSHORT")="" S:$L($G(GMTSBLD)) ZTSAVE("GMTSBLD")="" S:$D(GMTSINST) ZTSAVE("GMTSINST")="" S:$L($G(GMTSIENS)) ZTSAVE("GMTSIENS")=""
"RTN","GMTSXPS1",13,0)
 S ZTRTN="SENDTO^GMTSXPS1",ZTDESC="Health Summary Status Report Msg",ZTIO="",ZTDTH=$H D ^%ZTLOAD,HOME^%ZIS K Y,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN Q
"RTN","GMTSXPS1",14,0)
SENDTO ;   Send (Tasked)
"RTN","GMTSXPS1",15,0)
 N GMTSMAIL S GMTSMAIL="" S:$D(ZTQUEUED) ZTREQ="@"
"RTN","GMTSXPS1",16,0)
 N X,Y D HDR D:'$D(GMTSHORT) FI,INS^GMTSXPS2 D OUTPUT Q
"RTN","GMTSXPS1",17,0)
 ;                           
"RTN","GMTSXPS1",18,0)
HDR ; Report Header
"RTN","GMTSXPS1",19,0)
 N X D TITLE,ASOF D:$D(GMTSINST) MTBY D INAC,BLD D BL
"RTN","GMTSXPS1",20,0)
 Q
"RTN","GMTSXPS1",21,0)
TITLE ;   As of date
"RTN","GMTSXPS1",22,0)
 N X S X=$S($D(GMTSINST)&('$L($G(GMTSBLD))):"Health Summary Installation",$D(GMTSINST)&($L($G(GMTSBLD))):($G(GMTSBLD)_" Installation"),1:"Health Summary Status") D TT(X),BL Q
"RTN","GMTSXPS1",23,0)
ASOF ;   As of date
"RTN","GMTSXPS1",24,0)
 N X S X=$$NOW S:$L(X) X=$$TB($S($D(GMTSINST):"  Installed on:",1:"  As of:"))_X D:$L(X) TL(X) Q
"RTN","GMTSXPS1",25,0)
INAC ;   In Account
"RTN","GMTSXPS1",26,0)
 N X S X=$$UCI($$U) S:$L(X) X=$$TB("  Install Account:")_X D:$L(X) TL(X) Q
"RTN","GMTSXPS1",27,0)
MTBY ;   Maintained by
"RTN","GMTSXPS1",28,0)
 N X,Y S X=$$P,Y=$P(X,"^",2),X=$P(X,"^",1) S:$L(X) X=$$TB($S($D(GMTSINST):"  Installed by:",1:"  Maintained by:"))_X S:$L(X)&($L(Y)) X=X_"    "_Y D:$L(X) TL(X) Q
"RTN","GMTSXPS1",29,0)
BLD ;   Install Build
"RTN","GMTSXPS1",30,0)
 Q:$D(GMTSINST)&($L($G(GMTSBLD)))  N X S X=$G(GMTSBLD) Q:'$L(X)  S:$L(X) X=$$TB("  Build:")_X D:$L(X) TL(X) Q
"RTN","GMTSXPS1",31,0)
 ;                          
"RTN","GMTSXPS1",32,0)
FI ; Health Summary Files
"RTN","GMTSXPS1",33,0)
 Q:$D(GMTSHORT)
"RTN","GMTSXPS1",34,0)
 N X S X="",X=X_$J("",37-$L(X))_" Total",X=X_$J("",48-$L(X))_"Last" D TL(X)
"RTN","GMTSXPS1",35,0)
 S X="  File",X=X_$J("",37-$L(X))_"Entries",X=X_$J("",48-$L(X))_"Entry" D TL(X)
"RTN","GMTSXPS1",36,0)
 S X="",$P(X,"-",51)="-",X="  "_X D TL(X)
"RTN","GMTSXPS1",37,0)
 D F142,F1421,F14299,BL
"RTN","GMTSXPS1",38,0)
 Q
"RTN","GMTSXPS1",39,0)
F142 ;   Health Summary Type file 142
"RTN","GMTSXPS1",40,0)
 N X,GMTSA,GMTSAT,GMTSAP,GMTSL,GMTST,GMTSI S X="  Health Summary Type",(GMTSL,GMTST,GMTSI)=0
"RTN","GMTSXPS1",41,0)
 F  S GMTSI=$O(^GMT(142,GMTSI)) Q:+GMTSI=0  S GMTSL=GMTSI,GMTST=GMTST+1
"RTN","GMTSXPS1",42,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) D TL(X)
"RTN","GMTSXPS1",43,0)
 S GMTSA=$O(^GMT(142,"B","GMTS HS ADHOC OPTION",0))
"RTN","GMTSXPS1",44,0)
 S X="    Ad Hoc Health Summary Type",(GMTSL,GMTST,GMTSI)=0
"RTN","GMTSXPS1",45,0)
 I GMTSA=0 S X=X_$J("",37-$L(X))_"Missing Ad Hoc Health Summary Type" D TL(X) Q
"RTN","GMTSXPS1",46,0)
 F  S GMTSI=$O(^GMT(142,GMTSA,1,GMTSI)) Q:+GMTSI=0  S GMTSL=GMTSI,GMTST=GMTST+1
"RTN","GMTSXPS1",47,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) S:GMTSA'=12 X=X_$J("",57-$L(X))_"Invalid IEN" D TL(X)
"RTN","GMTSXPS1",48,0)
 Q
"RTN","GMTSXPS1",49,0)
F1421 ;   Health Summary Component file 142.1
"RTN","GMTSXPS1",50,0)
 N X,GMTSA,GMTSAC,GMTSAT,GMTSAP,GMTSL,GMTST,GMTSE,GMTSI
"RTN","GMTSXPS1",51,0)
 S X="  Health Summary Component",(GMTSAT,GMTSAP,GMTSAC,GMTSL,GMTST,GMTSI,GMTSE)=0
"RTN","GMTSXPS1",52,0)
 F  S GMTSI=$O(^GMT(142.1,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXPS1",53,0)
 . S GMTSL=GMTSI,GMTST=GMTST+1 S:GMTSI<501 GMTSE=GMTSE+1
"RTN","GMTSXPS1",54,0)
 . S GMTSA=$P($G(^GMT(142.1,GMTSI,0)),"^",6) S:GMTSA="T" GMTSAT=+($G(GMTSAT))+1 S:GMTSA="P" GMTSAP=+($G(GMTSAP))+1 S:GMTSA="" GMTSAC=+($G(GMTSAC))+1
"RTN","GMTSXPS1",55,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) D TL(X)
"RTN","GMTSXPS1",56,0)
 I +($G(GMTSE))>0 S X="    Exported",X=X_$J("",32-$L(X))_$J(GMTSE,10) D TL(X)
"RTN","GMTSXPS1",57,0)
 I +($G(GMTSAT))>0 S X="    Temporarily Disabled",X=X_$J("",32-$L(X))_$J(GMTSAT,10) D TL(X)
"RTN","GMTSXPS1",58,0)
 I +($G(GMTSAP))>0 S X="    Permanently Disabled",X=X_$J("",32-$L(X))_$J(GMTSAP,10) D TL(X)
"RTN","GMTSXPS1",59,0)
 I +($G(GMTSAC))>0&(+($G(GMTSAC))'=+($G(GMTST))) S X="    Active Components",X=X_$J("",32-$L(X))_$J(GMTSAC,10) D TL(X)
"RTN","GMTSXPS1",60,0)
 D STA^GMTSXPS3
"RTN","GMTSXPS1",61,0)
 Q
"RTN","GMTSXPS1",62,0)
F14299 ;   Health Summary Parameter file 142.9
"RTN","GMTSXPS1",63,0)
 N X,GMTSA,GMTSL,GMTST,GMTSI S X="  Health Summary Parameters",(GMTSL,GMTST,GMTSI)=0
"RTN","GMTSXPS1",64,0)
 F  S GMTSI=$O(^GMT(142.99,GMTSI)) Q:+GMTSI=0  S GMTSL=GMTSI,GMTST=GMTST+1
"RTN","GMTSXPS1",65,0)
 S X=X_$J("",32-$L(X))_$J(GMTST,10),X=X_$J("",42-$L(X))_$J(GMTSL,10) D TL(X)
"RTN","GMTSXPS1",66,0)
 Q
"RTN","GMTSXPS1",67,0)
 ;                            
"RTN","GMTSXPS1",68,0)
 ; Retrieve Data
"RTN","GMTSXPS1",69,0)
U(X) ;   UCI where Health Summary is installed
"RTN","GMTSXPS1",70,0)
 N GMTSU,GMTSP,GMTST S GMTST=$G(X) X ^%ZOSF("UCI") S GMTSU=Y
"RTN","GMTSXPS1",71,0)
 S:Y=^%ZOSF("PROD") GMTSP=" (Production)" S:Y'=^%ZOSF("PROD") GMTSP=" (Test)" S:GMTSU["DEM" GMTSP=" (Demo)"
"RTN","GMTSXPS1",72,0)
 S X="",$P(X,"^",1)=GMTSU,$P(X,"^",2)=GMTSP Q X
"RTN","GMTSXPS1",73,0)
UCI(X) ;   UCI Format
"RTN","GMTSXPS1",74,0)
 S X=$G(X) N GMTSA,GMTST S GMTSA=$P(X,"^",1),GMTST=$P(X,"^",2) S:$L(GMTST) GMTST=$$MX($$TRIM($$PA(GMTST)))
"RTN","GMTSXPS1",75,0)
 S:$L($P(GMTSA,",",1))=3&($L($P(GMTSA,",",2))=3) GMTSA="["_GMTSA_"]" S:$L(GMTSA)&($L(GMTST)) GMTST="("_GMTST_")"
"RTN","GMTSXPS1",76,0)
 S X="" S:$L(GMTSA) X=GMTSA S:$L(X)&($L(GMTST)) X=X_"  "_GMTST S:'$L(X)&($L(GMTST)) X=GMTST
"RTN","GMTSXPS1",77,0)
 Q X
"RTN","GMTSXPS1",78,0)
P(X) ;   Person
"RTN","GMTSXPS1",79,0)
 S X=+($G(DUZ)) Q:'$L($P($G(^VA(200,+($G(X)),0)),"^",1)) "UNKNOWN^"
"RTN","GMTSXPS1",80,0)
 N GMTSDUZ,GMTSPH S GMTSDUZ=+($G(DUZ))
"RTN","GMTSXPS1",81,0)
 S GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",2) S:GMTSPH="" GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",1) S:GMTSPH="" GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",3) S:GMTSPH="" GMTSPH=$P($G(^VA(200,GMTSDUZ,.13)),"^",4)
"RTN","GMTSXPS1",82,0)
 S GMTSDUZ=$P(^VA(200,GMTSDUZ,0),"^",1),X=GMTSDUZ_"^"_GMTSPH Q X
"RTN","GMTSXPS1",83,0)
INST(X) ;   Institution
"RTN","GMTSXPS1",84,0)
 S X=$G(^XMB("NETNAME")) I $L(X) S:X[".VA.GOV" X=$P(X,".VA.GOV",1) S:X["." X=$P(X,".",$L(X,".")) Q X
"RTN","GMTSXPS1",85,0)
 S X=$P($G(^XMB(1,1,"XUS")),"^",17) I +X>0 S X=$$GET1^DIQ(4,+X,.01,"E") Q:$L(X) X
"RTN","GMTSXPS1",86,0)
 S X="" Q X
"RTN","GMTSXPS1",87,0)
 ;                     
"RTN","GMTSXPS1",88,0)
OUTPUT ; Show global array (display or mail)
"RTN","GMTSXPS1",89,0)
 D:$D(GMTSMAIL) MAIL,CLR D:'$D(GMTSMAIL) DSP,CLR Q
"RTN","GMTSXPS1",90,0)
DISPLAY ;   Display global array
"RTN","GMTSXPS1",91,0)
 N GMTSI S GMTSI=0 F  S GMTSI=$O(^TMP($J,"GMTSINFO",GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXPS1",92,0)
 . W !,^TMP($J,"GMTSINFO",GMTSI)
"RTN","GMTSXPS1",93,0)
 Q
"RTN","GMTSXPS1",94,0)
MAIL ;   Mail global array in message
"RTN","GMTSXPS1",95,0)
 N DIFROM S U="^",XMSUB="Health Summary Info"
"RTN","GMTSXPS1",96,0)
 S:$D(GMTSINST)&($L($G(GMTSBLD))) XMSUB="Health Summary "_GMTSBLD_" Install"
"RTN","GMTSXPS1",97,0)
 S XMY("G.GMTS@ISC-SLC.VA.GOV")=""
"RTN","GMTSXPS1",98,0)
 S XMTEXT="^TMP($J,""GMTSINFO"",",XMDUZ=.5 D ^XMD
"RTN","GMTSXPS1",99,0)
 K ^TMP($J,"GMTSINFO"),%Z,XCNP,XMSCR,XMDUZ,XMY("G.GMTS@ISC-SLC.VA.GOV"),XMZ,XMSUB,XMY,XMTEXT,XMDUZ Q
"RTN","GMTSXPS1",100,0)
 Q
"RTN","GMTSXPS1",101,0)
 ;                            
"RTN","GMTSXPS1",102,0)
 ; Temporary Global
"RTN","GMTSXPS1",103,0)
BL ;   Blank Line
"RTN","GMTSXPS1",104,0)
 N GMTSNX S GMTSNX=+($$NX),^TMP($J,"GMTSINFO",GMTSNX)="" Q
"RTN","GMTSXPS1",105,0)
TT(X) ;   Title Line
"RTN","GMTSXPS1",106,0)
 Q:'$L($G(X))  D TL(X) N GMTSBK S GMTSBK="===============================================================================",GMTSBK=$E(GMTSBK,1,$L($G(X))) D:$L(GMTSBK) TL(GMTSBK) Q
"RTN","GMTSXPS1",107,0)
TL(X) ;   Text Line
"RTN","GMTSXPS1",108,0)
 N GMTSNX S GMTSNX=+($$NX),^TMP($J,"GMTSINFO",GMTSNX)=$G(X) Q
"RTN","GMTSXPS1",109,0)
BK1 ;   Break Line
"RTN","GMTSXPS1",110,0)
 N GMTSNX S GMTSNX=+($$NX),^TMP($J,"GMTSINFO",GMTSNX)="-------------------------------------------------------------------------------" Q
"RTN","GMTSXPS1",111,0)
NX(X) ;   Next Line #
"RTN","GMTSXPS1",112,0)
 S (X,^TMP($J,"GMTSINFO",0))=+($G(^TMP($J,"GMTSINFO",0)))+1 Q X
"RTN","GMTSXPS1",113,0)
ST ;   Show ^TMP($J,"GMTSINFO")
"RTN","GMTSXPS1",114,0)
 N GMTSNN,GMTSNC S GMTSNN="^TMP("_$J_",""GMTSINFO"")",GMTSNC="^TMP("_$J_",""GMTSINFO"","
"RTN","GMTSXPS1",115,0)
 F  S GMTSNN=$Q(@GMTSNN) Q:GMTSNN=""!(GMTSNN'[GMTSNC)  W:GMTSNN'[",0)" !,@GMTSNN
"RTN","GMTSXPS1",116,0)
 Q
"RTN","GMTSXPS1",117,0)
 ;                            
"RTN","GMTSXPS1",118,0)
DSP ; Display ^TMP($J,"GMTSINFO")
"RTN","GMTSXPS1",119,0)
 D DEV Q
"RTN","GMTSXPS1",120,0)
DEV ;   Select a device
"RTN","GMTSXPS1",121,0)
 N %,%ZIS,IOP,ZTRTN,ZTSAVE,ZTDESC,ZTDTH,ZTIO,ZTSK
"RTN","GMTSXPS1",122,0)
 S ZTRTN="DSPI^GMTSXPS1",ZTDESC="printing Health Summary install information"
"RTN","GMTSXPS1",123,0)
 S ZTIO=ION,ZTDTH=$H,%ZIS="PQ",ZTSAVE("^TMP($J,""GMTSINFO"",")=""
"RTN","GMTSXPS1",124,0)
 D ^%ZIS Q:POP  S ZTIO=ION I $D(IO("Q")) D QUE,^%ZISC Q
"RTN","GMTSXPS1",125,0)
 D NOQUE Q
"RTN","GMTSXPS1",126,0)
NOQUE ;   Do not que task
"RTN","GMTSXPS1",127,0)
 W @IOF W:IOST["P-" !,"< Not queued, printing Health Summary Info >",! H 2 U:IOST["P-" IO D @ZTRTN,^%ZISC Q
"RTN","GMTSXPS1",128,0)
QUE ;   Task queued to print user defaults
"RTN","GMTSXPS1",129,0)
 K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued",1:"Request Cancelled"),! H 2 Q
"RTN","GMTSXPS1",130,0)
 Q
"RTN","GMTSXPS1",131,0)
DSPI ;   Display installation information
"RTN","GMTSXPS1",132,0)
 I '$D(ZTQUEUED),$G(IOST)'["P-" I '$D(^TMP($J,"GMTSINFO")) W !,"Health Summary Installation not found"
"RTN","GMTSXPS1",133,0)
 I IOST["P-" U IO
"RTN","GMTSXPS1",134,0)
 G:'$D(^TMP($J,"GMTSINFO")) DSPQ
"RTN","GMTSXPS1",135,0)
 N GMTSCONT,GMTSI,GMTSLC,GMTSEOP S GMTSCONT="",(GMTSLC,GMTSI)=0,GMTSEOP=+($G(IOSL)) S:GMTSEOP=0 GMTSEOP=24
"RTN","GMTSXPS1",136,0)
 F  S GMTSI=$O(^TMP($J,"GMTSINFO",GMTSI)) Q:+GMTSI=0!(GMTSCONT["^")  D
"RTN","GMTSXPS1",137,0)
 . W !,^TMP($J,"GMTSINFO",GMTSI) D LF Q:GMTSCONT["^"
"RTN","GMTSXPS1",138,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","GMTSXPS1",139,0)
 W:$G(IOST)["P-" @IOF
"RTN","GMTSXPS1",140,0)
DSPQ ;   Quit Display
"RTN","GMTSXPS1",141,0)
 Q
"RTN","GMTSXPS1",142,0)
LF ;   Line Feed
"RTN","GMTSXPS1",143,0)
 S GMTSLC=GMTSLC+1 D:IOST["P-"&(GMTSLC>(GMTSEOP-7)) CONT D:IOST'["P-"&(GMTSLC>(GMTSEOP-4)) CONT
"RTN","GMTSXPS1",144,0)
 Q
"RTN","GMTSXPS1",145,0)
CONT ;   Page/Form Feed
"RTN","GMTSXPS1",146,0)
 S GMTSLC=0 W:IOST["P-" @IOF Q:IOST["P-"  W !!,"Press <Return> to continue  " R GMTSCONT:300 S:'$T GMTSCONT="^" S:GMTSCONT'["^" GMTSCONT=""
"RTN","GMTSXPS1",147,0)
 Q
"RTN","GMTSXPS1",148,0)
 ;                       
"RTN","GMTSXPS1",149,0)
 ; Miscellaneous
"RTN","GMTSXPS1",150,0)
TB(X) ;   Tab
"RTN","GMTSXPS1",151,0)
 S X=X F  Q:$L(X)>19  S X=X_" "
"RTN","GMTSXPS1",152,0)
 Q X
"RTN","GMTSXPS1",153,0)
PA(X) ;   Remove Parenthesis
"RTN","GMTSXPS1",154,0)
 Q $TR(X,"()","")
"RTN","GMTSXPS1",155,0)
LO(X) ;   Lowercase
"RTN","GMTSXPS1",156,0)
 Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSXPS1",157,0)
UP(X) ;   Uppercase
"RTN","GMTSXPS1",158,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSXPS1",159,0)
MX(X) ;   Mixed Case
"RTN","GMTSXPS1",160,0)
 Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSXPS1",161,0)
TRIM(X) ;   Trim Space Characters
"RTN","GMTSXPS1",162,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSXPS1",163,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSXPS1",164,0)
 Q X
"RTN","GMTSXPS1",165,0)
CLR ;   Clean up
"RTN","GMTSXPS1",166,0)
 K ^TMP($J,"GMTSINFO") Q
"RTN","GMTSXPS1",167,0)
NOW(X) ;   Today's Date
"RTN","GMTSXPS1",168,0)
 S X=$$EDT($$NOW^XLFDT) Q X
"RTN","GMTSXPS1",169,0)
EDT(X) ;   External Date Foramt
"RTN","GMTSXPS1",170,0)
 S X=+($G(X)) Q:X=0 "" S X=$$FMTE^XLFDT(+X,"5Z") S:X["@" X=$P(X,"@",1)_"  "_$P(X,"@",2) Q X
"RTN","GMTSXPS1",171,0)
ROK(X) ;   Routine OK (in UCI) (NDBI)
"RTN","GMTSXPS1",172,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSXPS1",173,0)
ENV(X) ;   Environment check
"RTN","GMTSXPS1",174,0)
 D HOME^%ZIS I '$D(^VA(200,+($G(DUZ)),0)) W !!,"    User (DUZ) not defined",! Q 0
"RTN","GMTSXPS1",175,0)
 Q 1
"RTN","GMTSXPS1",176,0)
ENV2(X) ;   Environment check
"RTN","GMTSXPS1",177,0)
 D HOME^%ZIS I '$D(^VA(200,+($G(DUZ)),0)) Q 0
"RTN","GMTSXPS1",178,0)
 Q 1
"VER")
8.0^22.0
**END**
**END**
