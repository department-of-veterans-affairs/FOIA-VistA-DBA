$TXT Created by ANWER,MOHAMED at CMNT.FO-BIRM.MED.VA.GOV  (KIDS) on Wednesday, 04/25/07 at 10:13
=============================================================================
Run Date: MAY 31, 2007                     Designation: PSO*7*261
Package : PSO - OUTPATIENT PHARMACY           Priority: Mandatory
Version : 7       SEQ #233                      Status: Released
                  Compliance Date: JUL 01, 2007
=============================================================================

Associated patches: (v)PSO*7*200   <<= must be installed BEFORE `PSO*7*261'
                    (v)PSO*7*243   <<= must be installed BEFORE `PSO*7*261'

Subject: ADDING 13 NEW FIELDS TO VDEF MESSAGE & MISC. FIXES

Category: 
  - Enhancement (Mandatory)
  - Routine

Description:
============

 This patch is part of the third quarter enhancements release for
 the Outpatient Pharmacy V. 7.0 package.
  
 As per the Health Data Repository (HDR) request, thirteen new data fields
 were added to the current Outpatient Pharmacy Vista Data Extraction
 Framework (VDEF) HEALTH LEVEL SEVEN (HL7) message that sends prescription
 information to the HDR.
  
 This patch affects the background HL7 processing only; users will not see
 any functional changes.
  
 For more information on the addition of the thirteen new data fields,
 please refer to Appendix D of the Outpatient Pharmacy V. 7.0 Technical
 Manual / Security Guide that is being updated with this patch.
  
 This patch also corrects the problem of a VDEF message not being sent to
 the HDR when a refill is deleted from a prescription as a result of the
 refill being returned to stock.
  
 **** VERY IMPORTANT ****
  
 You must suspend the VDEF Request Queue before installing this patch and
 then re-enable it after installation of the patch. Keep in mind that the
 suspension of the VDEF Request Queue will not prevent any new requests in
 Outpatient Pharmacy VDEF Domain application from being added to the VDEF
 Request Queue, it will only delay the building of these VDEF HL7 messages
 until the VDEF Request Queue is enabled again. The steps for doing that
 are outlined in the Installation Instructions section.
  
  
 MISCELLANEOUS FIXES:
 --------------------
  
 1. The hidden action "RS" for Reprint Signature log that was sent in
 patch PSO*7*200, was overwriting the action "OTH" for Other OP Actions,
 making the OTH action unavailable. The post-install routine PSOP261
 included in this patch (PSO*7*261) fixes this.
  
 2. An undefined error was identified by a site that went live with Remote
 Data Interoperability (RDI) patches. A common variable was being killed by
 another package. The fix is to save the value of the variable before 
 making the call to retrieve remote allergy data and to restore the 
 variable to the saved value once control is returned to the calling 
 routine.
  
  
 Associated New Service Request (NSR):
 =====================================
 N/A
  
  
 Associated Remedy Ticket(s):
 ============================
 HD187657 
 HD187697 
  
  
 Associated E3Rs:
 ================
 N/A
  
  
 TEST SITES:
 ===========
 DURHAM, NC
 IRON MOUNTAIN, MI
 LOUISVILLE, KY
 NEW YORK HARBOR HCS
 OKLAHOMA CITY, OK 
 DUBLIN, GA
 COLUMBIA, SC
  
  
 Documentation Retrieval:
 ========================
  
 The documentation is available on the ANONYMOUS.SOFTWARE directory at one
 of the following Office of Information (OI) Field Offices:
  
    Albany
    Hines
    Salt Lake City
  
 Sites may retrieve documentation in one of the following ways:
  
 (1) The preferred method is to FTP the files from
     download.vista.med.va.gov, which will transmit the files from the
     first available FTP server.
  
 (2) Sites may also elect to retrieve documentation directly from a
     specific server as follows:
  
     Albany              ftp.fo-albany.med.va.gov
     Hines               ftp.fo-hines.med.va.gov
     Salt Lake City      ftp.fo-slc.med.va.gov 
  
 The documentation distribution includes:
  
    FILE NAME                DESCRIPTION
  
  PSO_7_TM_R0507.PDF            Outpatient Pharmacy V. 7.0 Technical
                                  Manual / Security Guide
  PSO_7_P261_TM_CP.PDF         Outpatient Pharmacy V. 7.0 Technical
                                  Manual / Security Guide Change Pages
  
  
 (3) Documentation can also be retrieved from VistA Documentation Library
 (VDL) on the Internet at the following address, http://www.va.gov/vdl.
  
  
 Installation Instructions:
 ==========================
  
 Before installing this patch, use the List Tasks [XUTM INQ] option on the
 Taskman Management [XUTM MGR] menu to list currently running tasks.  
 Because this patch modifies routines involved in the exchange of messages
 between Computerized Patient Record System (CPRS) and Outpatient Pharmacy,
 this patch should be installed when there are no Outpatient Pharmacy users
 on the system, and also when Outpatient Pharmacy orders are not being
 acted upon through CPRS. There are also various tasked jobs that generate
 message exchanges between CPRS and Outpatient Pharmacy, and this patch
 should be installed at a time when these jobs are not running. These jobs
 include PSO AUTOCANCEL, PSO EXPIRE PRESCRIPTIONS, and ORMTIME RUN, and 
 PRINT LABELS FROM SUSPENSE. There is also a one-time tasked job,
 PSO MANUAL AUTO EXPIRE, that should not be running during installation. 
 Additionally, CMOP transmissions should not be taking place during 
 installation.
  
 Installation of this patch should take no longer than 3 minutes.
  
 1. Stop the VDEF Request Queue by following these steps: 
  
    Select OPTION NAME: VDEF CONFIGURATION MENU       VDEF Configuration 
    and Status
  
    Select VDEF Configuration and Status Option: SUS  Suspend/Run Request 
    Queue
  
    Select Request Queue: MAINTENANCE  
    SUSPENDED FLAG: RUNNING// S  SUSPENDED
  
    Select Request Queue: 
    
  
 2. Use the INSTALL/CHECK MESSAGE option on the PackMan menu.  
  
 3. From the Kernel Installation & Distribution System menu, select 
    the Installation menu.  
  
 4. From this menu, you may select to use the following options: 
    (when prompted for INSTALL NAME, enter PSO*7.0*261) 
  
   a. Backup a Transport Global - this option will create a backup 
      message of any routines exported with the patch. It will NOT 
      backup any other changes such as DDs or templates.  
  
   b. Compare Transport Global to Current System - this option will 
      allow you to view all changes that will be made when the patch 
      is installed. It compares all components of the patch (routines, 
      DDs, templates, etc.).  
  
   c. Verify Checksums in Transport Global - this option will ensure 
      the integrity of the routines that are in the transport global.  
  
 5. Use the Install Package(s) option and select the package PSO*7.0*261.  
  
 6. When Prompted "Want KIDS to INHIBIT LOGONs during the install? YES//" 
    respond NO.  
  
 7. When Prompted "Want to DISABLE Scheduled Options, Menu Options, and 
    Protocols? YES//" respond NO.  
  
 8. After the patch is installed, enable the VDEF Request Queue by    
    following these steps:
  
     Select OPTION NAME: VDEF CONFIGURATION MENU       VDEF Configuration 
     and Status
  
     Select VDEF Configuration and Status Option: SUS  Suspend/Run Request 
     Queue
  
     Select Request Queue: MAINTENANCE  
     SUSPENDED FLAG: SUSPENDED// RU  RUNNING
  
     Select Request Queue: 
  
  
 Routine Summary:
 ================
 The second line now reads as follows:
  
   <TAB>;;7.0;OUTPATIENT PHARMACY;**[patch list]**;DEC 1997
  
  CHECK^XTSUMBLD results:
  
  Routine   Before Patch  After Patch    Patch List
  ==================================================================
  PSOORUT2      17946239   18136103      11,146,132,182,233,243,261
  PSOP261          N/A      1784763      261
  PSORESK       30426666   30575233      15,9,27,40,47,55,85,130,185,
                                         184,196,148,201,259,261
  PSOVDF1       15544810   15793056      190,205,220,235,261
  PSOVDF2       20638162   19360981      190,205,220,235,261
  PSOVDF3       7794857    13216243      205,235,261
  
  Total number of routines modified: 6
  Total number of deleted routines: 1
  
  Note: The routine PSOP261 is a post-installation routine that is
        automatically deleted from your system upon completion of the
        installation.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PSOORUT2
    Before: B32770288  After: B33163050  **11,146,132,182,233,243,261**
Routine Name: PSOP261
    Before:       n/a  After:  B2413203  **261**
Routine Name: PSORESK
    Before: B66758202  After: B67129775  **15,9,27,40,47,55,85,130,185,
                                          184,196,148,201,259,261**
Routine Name: PSOVDF1
    Before: B87117915  After: B89552983  **190,205,220,235,261**
Routine Name: PSOVDF2
    Before: B85283768  After: B86097500  **190,205,220,235,261**
Routine Name: PSOVDF3
    Before: B24142157  After: B66789111  **205,235,261**

=============================================================================
User Information:
Entered By  : ANWER,MOHAMED                 Date Entered  : OCT 25, 2006
Completed By: GREER,MIKE                    Date Completed: MAY 22, 2007
Released By : BARRON,LUANNE                 Date Released : MAY 31, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
