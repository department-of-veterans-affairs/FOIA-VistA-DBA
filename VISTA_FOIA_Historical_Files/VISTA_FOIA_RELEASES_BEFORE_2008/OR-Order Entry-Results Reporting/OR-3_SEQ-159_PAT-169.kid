Released OR*3*169 SEQ #159
Extracted from mail message
**KIDS**:OR*3.0*169^

**INSTALL NAME**
OR*3.0*169
"BLD",3983,0)
OR*3.0*169^ORDER ENTRY/RESULTS REPORTING^0^3030115^y
"BLD",3983,1,0)
^^1^1^3021212^^^^
"BLD",3983,1,1,0)
Refer to the patch description on the patch message.
"BLD",3983,4,0)
^9.64PA^^0
"BLD",3983,"ABNS",0)
^9.66A^^
"BLD",3983,"ABPKG")
n^y^G.LABTEST@ISC-SLC.VA.GOV
"BLD",3983,"INI")

"BLD",3983,"INIT")

"BLD",3983,"KRN",0)
^9.67PA^8989.52^20
"BLD",3983,"KRN",.4,0)
.4
"BLD",3983,"KRN",.401,0)
.401
"BLD",3983,"KRN",.402,0)
.402
"BLD",3983,"KRN",.403,0)
.403
"BLD",3983,"KRN",.5,0)
.5
"BLD",3983,"KRN",.84,0)
.84
"BLD",3983,"KRN",3.6,0)
3.6
"BLD",3983,"KRN",3.8,0)
3.8
"BLD",3983,"KRN",9.2,0)
9.2
"BLD",3983,"KRN",9.8,0)
9.8
"BLD",3983,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",3983,"KRN",9.8,"NM",1,0)
ORELR3^^0^B8196693
"BLD",3983,"KRN",9.8,"NM",2,0)
ORELR2^^0^B32255054
"BLD",3983,"KRN",9.8,"NM","B","ORELR2",2)

"BLD",3983,"KRN",9.8,"NM","B","ORELR3",1)

"BLD",3983,"KRN",19,0)
19
"BLD",3983,"KRN",19,"NM",0)
^9.68A^^
"BLD",3983,"KRN",19.1,0)
19.1
"BLD",3983,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",3983,"KRN",101,0)
101
"BLD",3983,"KRN",101,"NM",0)
^9.68A^^0
"BLD",3983,"KRN",409.61,0)
409.61
"BLD",3983,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",3983,"KRN",771,0)
771
"BLD",3983,"KRN",869.2,0)
869.2
"BLD",3983,"KRN",870,0)
870
"BLD",3983,"KRN",8989.51,0)
8989.51
"BLD",3983,"KRN",8989.52,0)
8989.52
"BLD",3983,"KRN",8994,0)
8994
"BLD",3983,"KRN","B",.4,.4)

"BLD",3983,"KRN","B",.401,.401)

"BLD",3983,"KRN","B",.402,.402)

"BLD",3983,"KRN","B",.403,.403)

"BLD",3983,"KRN","B",.5,.5)

"BLD",3983,"KRN","B",.84,.84)

"BLD",3983,"KRN","B",3.6,3.6)

"BLD",3983,"KRN","B",3.8,3.8)

"BLD",3983,"KRN","B",9.2,9.2)

"BLD",3983,"KRN","B",9.8,9.8)

"BLD",3983,"KRN","B",19,19)

"BLD",3983,"KRN","B",19.1,19.1)

"BLD",3983,"KRN","B",101,101)

"BLD",3983,"KRN","B",409.61,409.61)

"BLD",3983,"KRN","B",771,771)

"BLD",3983,"KRN","B",869.2,869.2)

"BLD",3983,"KRN","B",870,870)

"BLD",3983,"KRN","B",8989.51,8989.51)

"BLD",3983,"KRN","B",8989.52,8989.52)

"BLD",3983,"KRN","B",8994,8994)

"BLD",3983,"QUES",0)
^9.62^^
"BLD",3983,"REQB",0)
^9.611^1^1
"BLD",3983,"REQB",1,0)
OR*3.0*42^2
"BLD",3983,"REQB","B","OR*3.0*42",1)

"MBREQ")
0
"PKG",110,-1)
1^1
"PKG",110,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",110,20,0)
^9.402P^^
"PKG",110,22,0)
^9.49I^1^1
"PKG",110,22,1,0)
3.0^2971217
"PKG",110,22,1,"PAH",1,0)
169^3030115
"PKG",110,22,1,"PAH",1,1,0)
^^1^1^3030115
"PKG",110,22,1,"PAH",1,1,1,0)
Refer to the patch description on the patch message.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","ORELR2")
0^2^B32255054
"RTN","ORELR2",1,0)
ORELR2 ; slc/dcm - Cross check file 100 with file 69 ;2/21/96  13:30 ;
"RTN","ORELR2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**20,42,169**;Dec 17, 1997
"RTN","ORELR2",3,0)
A ;Enter here
"RTN","ORELR2",4,0)
 N X,ORENT,ORSTS,ORX1,ORX,ORX3,ORSDT,ORITEM,ORX4,ORX6,ORDAD,ORX1,ORDFN,ORPCL,ORSTS,ORSTRT,ORENT,ORWHO,ORSIB,ORPSTS,LRDFN,LRODT,LRORD,LRSN,LRSTS
"RTN","ORELR2",5,0)
 S (ORENT,ORSTS,ORX1)=""
"RTN","ORELR2",6,0)
 I '$D(^OR(100,ORIFN,0)) D WRT(ORIFN,"No ^OR(100,ORIFN,0)") K:ORAFIX ^OR(100,ORIFN) Q
"RTN","ORELR2",7,0)
 I '$D(^OR(100,ORIFN,3)) D WRT(ORIFN,"No ^OR(100,ORIFN,3)") D:ORAFIX PURG^ORELR3(ORIFN) Q
"RTN","ORELR2",8,0)
 S ORX=^OR(100,ORIFN,0),ORX3=$G(^(3)),ORSDT=$P(ORX3,"^",6),ORITEM=$P(ORX3,"^",7),ORX4=$G(^(4)),ORX6=$G(^(6)),ORDAD=$O(^(2,0)),ORX1=$O(^OR(100,ORIFN,1,0)),ORX1=$E($G(^(+ORX1,0)),1,15),ORDFN=$P(ORX,"^",2)
"RTN","ORELR2",9,0)
 I '$P(ORX,"^",14) D WRT(ORIFN,"No package defined") D:ORAFIX PURG^ORELR3(ORIFN) Q
"RTN","ORELR2",10,0)
 Q:$P(ORX,"^",14)'=PKG
"RTN","ORELR2",11,0)
 Q:ORDFN'[";DPT("
"RTN","ORELR2",12,0)
 S ORPCL=$P(ORX3,"^",4),ORSTS=$P(ORX3,"^",3),ORSTRT=$P(ORX,"^",8),ORENT=$P(ORX,"^",7),ORWHO=$P(ORX,"^",6),ORSIB=$P(ORX3,"^",9)
"RTN","ORELR2",13,0)
 D NOW^%DTC
"RTN","ORELR2",14,0)
 I ORENT>+($E(%,1,10)-.01) Q
"RTN","ORELR2",15,0)
 I ORSTS=99 D WRT(ORIFN,"No Status",1) S NCNT=NCNT+1 Q
"RTN","ORELR2",16,0)
 I ORPCL,ORPCL[";ORD(101,",$D(^ORD(101,+ORPCL,0)),$P(^(0),"^")["ORGY " Q
"RTN","ORELR2",17,0)
 I $P(ORX3,"^",8),DT>$P(ORENT,".") D
"RTN","ORELR2",18,0)
 . I ORSTS=2,ORAFIX S $P(^OR(100,ORIFN,3),"^",8)="" Q  ;Unveil completed order
"RTN","ORELR2",19,0)
 . S VCNT=VCNT+1
"RTN","ORELR2",20,0)
 . D WRT(ORIFN,"Old Veiled order: ORPK="_ORX4)
"RTN","ORELR2",21,0)
 . D:ORAFIX PURG^ORELR3(ORIFN)
"RTN","ORELR2",22,0)
 I ORDAD S ORPSTS=ORSTS D DAD^ORELR3(ORIFN) Q
"RTN","ORELR2",23,0)
 I ORSIB D
"RTN","ORELR2",24,0)
 . I '$D(^OR(100,ORSIB)) S SIBCNT=SIBCNT+1 D WRT(ORIFN,"Child order with no parent") S:ORAFIX $P(^OR(100,ORIFN,3),"^",9)="" Q
"RTN","ORELR2",25,0)
 . I '$D(^OR(100,ORSIB,2,ORIFN)) S SIBPCNT=SIBPCNT+1 D WRT(ORIFN,"Child order with missing parent pointer") I ORAFIX S ^OR(100,ORSIB,2,ORIFN,0)=ORIFN
"RTN","ORELR2",26,0)
 I ORSTS=11,ORPENDT,ORSTRT<ORPENDT D DC^ORELR3 Q
"RTN","ORELR2",27,0)
 Q:$P(ORX3,"^",3)=11
"RTN","ORELR2",28,0)
 Q:$P(ORX3,"^",3)=10
"RTN","ORELR2",29,0)
 I $L($P(ORX4,"^",4,99)) Q:$P(ORX3,"^",3)=1  D  Q
"RTN","ORELR2",30,0)
 . I 'ORSTS S BSCNT=BSCNT+1 D WRT(ORIFN,"Bad package link, null status:"_ORX4) I '$P(ORX4,"^",4) D:ORAFIX PURG^ORELR3(ORIFN) Q
"RTN","ORELR2",31,0)
 . I ORSTS'=1 S UCCNT=UCCNT+1 D WRT(ORIFN,"Unrecognized package link:"_ORX4) D:ORAFIX STATUS^ORCSAVE2(ORIFN,1)
"RTN","ORELR2",32,0)
 I '$D(^OR(100,ORIFN,4)) D  Q
"RTN","ORELR2",33,0)
 . I ORSTS'=1,ORSTS'=2,'(ORSTS>8&(ORSTS<15)),$P(ORX3,"^",13)'=2 D WRT(ORIFN,"No package node") S UCCNT=UCCNT+1 D:ORAFIX STATUS^ORCSAVE2(ORIFN,1)
"RTN","ORELR2",34,0)
 I '$L(^OR(100,ORIFN,4)) D  Q
"RTN","ORELR2",35,0)
 . I ORSTS'=1,ORSTS'=2,'(ORSTS>8&(ORSTS<15)) D WRT(ORIFN,"Empty package node") S UCCNT=UCCNT+1 D:ORAFIX STATUS^ORCSAVE2(ORIFN,1)
"RTN","ORELR2",36,0)
 I ORX4["^" D  Q
"RTN","ORELR2",37,0)
 . I ORSTS=""!(ORSTS=1)!(ORSTS=2)!(ORSTS=14)!(ORSTS=12) Q
"RTN","ORELR2",38,0)
 . S UNCNT=UNCNT+1
"RTN","ORELR2",39,0)
 . I ORLRO,'$D(^LRO(69,+ORX4,1,$P(ORX4,"^",2),2,$P(ORX4,"^",3))) D WRT(ORIFN,"Didn't get converted, NOT IN 69") D:ORAFIX STATUS^ORCSAVE2(ORIFN,14) Q
"RTN","ORELR2",40,0)
 . I '$D(^LRO(69,+ORX4,1,+$P(ORX4,"^",2))) D WRT(ORIFN,"Didn't get converted") D:ORAFIX STATUS^ORCSAVE2(ORIFN,14) Q
"RTN","ORELR2",41,0)
 . S UNCNT=UNCNT-1
"RTN","ORELR2",42,0)
 I ORX4'[";" D  Q
"RTN","ORELR2",43,0)
 . I ORLRO,'$D(^LRO(69,"C",+ORX4)),ORSTS'=14,ORSTS'=1,ORSTS'=2 S NOCNT=NOCNT+1 D WRT(ORIFN,"ORD# not in 69:"_ORX4) D:ORAFIX STATUS^ORCSAVE2(ORIFN,14)
"RTN","ORELR2",44,0)
 S LRORD=+ORX4,LRODT=$P(ORX4,";",2),LRSN=$P(ORX4,";",3),LRSTS=""
"RTN","ORELR2",45,0)
 I 'LRORD!('LRODT)!('LRSN),ORSTS'=1,ORSTS'=14,ORSTS'=2 D WRT(ORIFN,"Invalid ORPK:"_LRORD_";"_LRODT_";"_LRSN) S IVCNT=IVCNT+1 D:ORAFIX STATUS^ORCSAVE2(ORIFN,14) Q
"RTN","ORELR2",46,0)
 I ORLRO,ORSTS'=1,ORSTS'=14,ORSTS'=2,LRODT,LRSN,'$D(^LRO(69,LRODT,1,LRSN,0)) S LCNT=LCNT+1 D WRT(ORIFN,"No entry in 69:"_LRODT_";"_LRSN) D:ORAFIX STATUS^ORCSAVE2(ORIFN,14) Q
"RTN","ORELR2",47,0)
 I ORDFN[";DPT(",LRODT,LRSN S LRDFN=+$G(^DPT(+ORDFN,"LR")),X=+$G(^LRO(69,LRODT,1,LRSN,0)) I X,X'=LRDFN S X="Wrong patient! OR:"_LRDFN_" LR:"_X_" ORPK:"_LRODT_";"_LRSN,DCNT=DCNT+1 D WRT(ORIFN,X,1) Q
"RTN","ORELR2",48,0)
 I 'ORWHO D WRT(ORIFN,"No 'Entered by'",1) S WICNT=WICNT+1
"RTN","ORELR2",49,0)
 I '$P(ORX,"^",4),LRODT,LRSN S PHCNT=PHCNT+1 D
"RTN","ORELR2",50,0)
 . S X=$P($G(^LRO(69,LRODT,1,LRSN,0)),"^",6)
"RTN","ORELR2",51,0)
 . D WRT(ORIFN,"No Physician in 100"_$S('X:" or 69",1:""),$S(X:"",1:1))
"RTN","ORELR2",52,0)
 . I X,ORAFIX S $P(^OR(100,ORIFN,0),"^",4)=X S:'$P(^(3),"^",7) $P(^(3),"^",7)=X
"RTN","ORELR2",53,0)
 I $D(^LRO(69,+LRODT,1,+LRSN,1)) S LRSTS=$P(^(1),"^",4)
"RTN","ORELR2",54,0)
 S I=0
"RTN","ORELR2",55,0)
 I LRSTS="",$D(^LRO(69,+LRODT,1,+LRSN,6)) S J=0 F  S J=$O(^LRO(69,LRODT,1,LRSN,6,J)) Q:J<1  I ^(J,0)["NO DRAW for test" S I=1 Q
"RTN","ORELR2",56,0)
 I I,ORSTS'=2,ORSTS'=1,ORSTS'=9 D WRT(ORIFN,"Active canceled order") S ACNT=ACNT+1 D:ORAFIX STATUS^ORCSAVE2(ORIFN,1)
"RTN","ORELR2",57,0)
 I ORSTS=9 S ICCNT=ICCNT+1 D WRT(ORIFN,"Incomplete should be Complete") D:ORAFIX STATUS^ORCSAVE2(ORIFN,2)
"RTN","ORELR2",58,0)
 I ORSTS'=1,ORSTS'=2,ORSTS'=9,$D(^LRO(69,+LRODT,1,+LRSN,3)),$P(^(3),"^",2) N LRTN S LRTN=0 F  S LRTN=$O(^LRO(69,LRODT,1,LRSN,2,LRTN)) Q:'LRTN  S X=^(LRTN,0) I $P(X,"^",7)=ORIFN,$P(X,"^",3),$P(X,"^",4),$P(X,"^",5) D
"RTN","ORELR2",59,0)
 . S X1=$G(^LRO(68,$P(X,"^",4),1,$P(X,"^",3),1,$P(X,"^",5),4,+X,0))
"RTN","ORELR2",60,0)
 . I $P(X1,"^",5) D WRT(ORIFN,"Status should be Complete") S STCNT=STCNT+1 D:ORAFIX STATUS^ORCSAVE2(ORIFN,2)
"RTN","ORELR2",61,0)
 I ORSTS'=1,ORSTS'=2,ORSTS'=13,ORSTS'=14 N ORI,ORX S ORI=0 F  S ORI=$O(^OR(100,ORIFN,4.5,"ID","ORDERABLE",ORI)) Q:ORI<1  I $D(^OR(100,ORIFN,4.5,ORI,1)) S ORX=^(1) I $D(^ORD(101.43,+ORX,0)) S ORX=+$P(^(0),"^",2) I ORX D
"RTN","ORELR2",62,0)
 . I $D(^LRO(69,LRODT,1,LRSN,2,"B",ORX)) S ORX=$O(^(ORX,0)) I '$L($P(^LRO(69,LRODT,1,LRSN,2,ORX,0),"^",7)) D WRT(ORIFN,"Missing pointer to 100") S OCNT=OCNT+1 I ORAFIX S $P(^LRO(69,LRODT,1,LRSN,2,ORX,0),"^",7)=ORIFN
"RTN","ORELR2",63,0)
 D DC^ORELR3
"RTN","ORELR2",64,0)
 Q
"RTN","ORELR2",65,0)
WRT(ORIFN,TEXT,FIX) ;Disp
"RTN","ORELR2",66,0)
 S CNT=CNT+1,TTCNT=TTCNT+1
"RTN","ORELR2",67,0)
 Q:$E(IOST,1,2)="P-"
"RTN","ORELR2",68,0)
 ;I CNT>100 W !!,"Continue" S %=1 D YN^DICN S CNT=0 I %=2 S END=1
"RTN","ORELR2",69,0)
 ;W !,ORIFN_"=>"_ORX1_"<"_$G(ORENT)_">"_$G(ORSTS)_"<"_TEXT_$S($G(FIX):">Not fixed",1:"")
"RTN","ORELR2",70,0)
 W "."
"RTN","ORELR2",71,0)
 Q
"RTN","ORELR3")
0^1^B8196693
"RTN","ORELR3",1,0)
ORELR3 ; slc/dcm - Cross check file 100 with file 69 ;2/21/96  13:30 ;
"RTN","ORELR3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**20,42,169**;Dec 17, 1997
"RTN","ORELR3",3,0)
PURG(ORIFN) ;
"RTN","ORELR3",4,0)
 N ORX,X,ORPK,X3,X,DA,DIK
"RTN","ORELR3",5,0)
 Q:'$D(ORIFN)
"RTN","ORELR3",6,0)
 Q:'$D(^OR(100,ORIFN,0))
"RTN","ORELR3",7,0)
 I $D(^OR(100,ORIFN,3)),$P(^(3),"^",9) S X=$P(^(3),"^",9) I $O(^OR(100,X,2,0)) S $P(^(0),"^",4)=$P(^(0),"^",4)-1 K ^(ORIFN) I '$O(^(0)) D:ORIFN'=X PURG(X)
"RTN","ORELR3",8,0)
 S (ORX,X)=^OR(100,ORIFN,0),ORPK=$G(^(4)),X3=$G(^(3))
"RTN","ORELR3",9,0)
 D P(ORPK)
"RTN","ORELR3",10,0)
 S DA=ORIFN,DIK="^OR(100," D ^DIK
"RTN","ORELR3",11,0)
 Q
"RTN","ORELR3",12,0)
P(ORPK) ;Purge
"RTN","ORELR3",13,0)
 N LRXODT,LRXSN
"RTN","ORELR3",14,0)
 I ORPK'[";",ORPK D  Q
"RTN","ORELR3",15,0)
 . S LRXODT=0 F  S LRXODT=$O(^LRO(69,"C",+ORPK,LRXODT)) Q:LRXODT<1  D
"RTN","ORELR3",16,0)
 .. S LRXSN=0 F  S LRXSN=$O(^LRO(69,"C",+ORPK,LRXODT,LRXSN)) Q:LRXSN<1  D
"RTN","ORELR3",17,0)
 ... D TST
"RTN","ORELR3",18,0)
 S LRXODT=$P(ORPK,";",2),LRXSN=$P(ORPK,";",3)
"RTN","ORELR3",19,0)
 I LRXODT,LRXSN,$D(^LRO(69,LRXODT,1,LRXSN,2,0)) D TST
"RTN","ORELR3",20,0)
 Q
"RTN","ORELR3",21,0)
TST ;Get the test level
"RTN","ORELR3",22,0)
 N I,X
"RTN","ORELR3",23,0)
 S I=0 F  S I=$O(^OR(100,ORIFN,4.5,"ID","ORDERABLE",I)) Q:I<1  I $D(^OR(100,ORIFN,4.5,I,1)) S X=^(1) I $D(^ORD(101.43,+X,0)) S X=+$P(^(0),"^",2) I X D
"RTN","ORELR3",24,0)
 . I $D(^LRO(69,LRXODT,1,LRXSN,2,"B",X)) S X=$O(^(X,0)),$P(^LRO(69,LRXODT,1,LRXSN,2,X,0),"^",7)="P"
"RTN","ORELR3",25,0)
 Q
"RTN","ORELR3",26,0)
DC ;Lapse old pending/active/unrel orders
"RTN","ORELR3",27,0)
 Q:'$D(^OR(100,ORIFN,3))
"RTN","ORELR3",28,0)
 Q:$P(^OR(100,ORIFN,3),"^",3)'=5&($P(^(3),"^",3)'=11)&($P(^(3),"^",3)'=6)  N X3 S X3=$P(^(3),"^",3)
"RTN","ORELR3",29,0)
 I ORPENDT,ORSTRT<ORPENDT D
"RTN","ORELR3",30,0)
 . I ORSTRT="",ORENT'<ORPENDT Q
"RTN","ORELR3",31,0)
 . I X3=5 S PCNT=PCNT+1,TTCNT=TTCNT+1 W "p"
"RTN","ORELR3",32,0)
 . I X3=6 Q:$D(^LRO(69,LRODT,1,LRSN,0))  S APCNT=APCNT+1,TTCNT=TTCNT+1 W "a"
"RTN","ORELR3",33,0)
 . I X3=11 S UCNT=UCNT+1,TTCNT=TTCNT+1 W "u"
"RTN","ORELR3",34,0)
 . I ORAFIX,ORPEND D:ORSTS=11 PURG(ORIFN) D:ORSTS'=11 STATUS^ORCSAVE2(ORIFN,14)
"RTN","ORELR3",35,0)
 Q
"RTN","ORELR3",36,0)
DAD(ORIFN) ;Check mult ord status
"RTN","ORELR3",37,0)
 Q:'$O(^OR(100,ORIFN,2,0))
"RTN","ORELR3",38,0)
 N SAME,J,X,D
"RTN","ORELR3",39,0)
 S SAME=1,J=0
"RTN","ORELR3",40,0)
 F  S J=$O(^OR(100,ORIFN,2,J)) Q:'J  I $D(^OR(100,J,3)),$P(^(3),"^",3)'=ORPSTS S SAME=0 Q
"RTN","ORELR3",41,0)
 Q:SAME
"RTN","ORELR3",42,0)
 S (J,X,D)=0 F  S J=$O(^OR(100,ORIFN,2,J)) Q:J<1  D  Q:X
"RTN","ORELR3",43,0)
 . I '$D(^OR(100,J)) S HCNT=HCNT+1 D WRT^ORELR2(ORIFN,"Bad Child ptr:"_J) D  Q
"RTN","ORELR3",44,0)
 .. I ORAFIX K ^OR(100,ORIFN,2,J) I '$O(^(0)) D PURG(ORIFN)
"RTN","ORELR3",45,0)
 . I $D(^OR(100,J)) S K=$P($G(^(J,3)),"^",3),X=$S(K=1:"",K=2:"",K=7:"",K=14:"",1:1) Q:X  S:K'=1 D=1
"RTN","ORELR3",46,0)
 I 'X,ORSTS'=$S(D:2,1:1) S PTCNT=PTCNT+1 D WRT^ORELR2(ORIFN,"Parent status update") I ORAFIX S ORSTS=$S(D:2,1:1) I ORSTS'=ORPSTS D STATUS^ORCSAVE2(ORIFN,ORSTS)
"RTN","ORELR3",47,0)
 Q
"VER")
8.0^22.0
**END**
**END**
