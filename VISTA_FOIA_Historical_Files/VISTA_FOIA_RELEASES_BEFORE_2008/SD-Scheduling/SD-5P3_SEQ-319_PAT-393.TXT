$TXT Created by CURTIS,RICHARD L at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Monday, 11/15/04 at 14:00
=============================================================================
Run Date: JAN 31, 2005                     Designation: SD*5.3*393
Package : SD - SCHEDULING                     Priority: Mandatory
Version : 5.3       SEQ #319                    Status: Released
                  Compliance Date: MAR 03, 2005
=============================================================================

Associated patches: (v)SD*5.3*247  <<= must be installed BEFORE `SD*5.3*393'

Subject: NO TRANSMISSION OF DATA MESSAGE

Category: 
  - Routine

Description:
============

 The transmission of data to NPCDB (National Patient Care Database) 
 Completed Bulletin, which is generated by the Ambulatory Care Nightly 
 Transmission to NPCDB [SCDX AMBCAR NIGHTLY XMIT], is sometimes 
 received without any text.  This is a problem which only occurs 
 sporadically; however, the changes introduced by this patch will 
 prevent this problem from resurfacing in the future.
    
 ASSOCIATED NOIS:
 ================
 1. STL-0300-41008             No Transmission of Data Message
    duplicates:  
            CON-0300-11088  No Transmission of Data Message
            ALN-0400-11191  No Transmission of Data Message
            FAV-0201-71195  No Transmission of Data Message
            SDC-0501-61699  No Transmission of Data Message
            SDC-0701-62796  No Transmission of Data Message
            CTX-1001-70920  No Transmission of Data Message
            OKL-1001-73292  No Transmission of Data Message
            REN-1201-60601  No Transmission of Data Message
            BRX-0403-10556  No Transmission of Data Message
            OKL-0403-72241  No Transmission of Data Message
            WBP-0903-21420  No Transmission of Data Message
            BRX-0504-11353  No Transmission of Data Message
            BRX-1004-11125  Transmission of data to NPCDB empty message
    
 ASSOCIATED E3R(s):
 ==================
 N/A
    
 PARTICIPATING TEST SITES:
 =========================
 Oklahoma City
 Wilkes-Barre               
 Heartland East
 Central Texas
    
 NOIS OVERVIEW:
 ==============
 1. STL-0300-41008             No Transmission of Data Message
    
    Problem:
    --------
    Periodically, the Transmission of data to NPCDB Complete Bulletin
    which is generated by the Ambulatory Care Nightly Transmission is
    received by users with the correct Subject, but no text.
    
    Resolution:
    -----------
    Prior to completion, the Ambulatory Care Nightly Transmission job
    calls routine SCDXMSG2 at linetag CMPLBULL, passing in parameters
    for the number of encounters successfully sent to NPCDB and for the
    number of encounter errors.
    
    This subroutine then builds bulletin SCDX AMBCARE TO NPCDB 
    SUMMARY, storing the text of the message in temporary 
    global ^TMP("SCDX-XMIT- BLD",$J,"BULLETIN").  It then calls Mailman 
    which, in turn, calls Taskman to run the job in the background.
    
    Rather than build the text of the bulletin in the routine, the text
    will be added to the word processing field (10 - Message) in file
    3.6 (Bulletin) for bulletin - SCDX AMBCARE TO NPCDB SUMMARY.  
    Two new parameters will also be added to this bulletin in 
    BULLETIN (#3.6) file, one for the number of encounters successfully 
    sent to NPCDB and the other for the number of encounter errors.  
    The code in subroutine CMPLBULL^SCDXMSG2 will be changed as 
    follows:
    
    FROM:
    
    S SENT=+$G(SENT)
    S ERRCNT=+$G(ERRCNT)
    ;Declare variables
    N MSGTXT,XMB,XMTEXT,XMY,XMDUZ,XMDT,XMZ,XMITPTR,LINE
    N ENCPTR,DELPTR,ENCDATE,ENCLOC,NAME,TMP,ENCZERO,SSN,PATZERO
    S MSGTXT="^TMP(""SCDX-XMIT-BLD"","_$J_",""BULLETIN"")"
    K @MSGTXT
    ;Put number of encounters transmitted into message text
    S @MSGTXT@(1)="Transmission of data to the National Patient Care 
 Database has completed."
    S @MSGTXT@(2)=""
    S @MSGTXT@(3)="A total of "_SENT_" Outpatient Encounters were sent."
    ;Put number of nontransmitted encounters into message text
    S @MSGTXT@(4)="A total of "_ERRCNT_" Outpatient Encounters were not
 sent."
    S @MSGTXT@(5)=""
    S @MSGTXT@(6)="Please review the IEMM Error listing for further 
 detail."
    ;Set bulletin subject
    S XMB(1)="Transmission of data to NPCDB completed"
    ;Deliver bulletin
    S XMB="SCDX AMBCARE TO NPCDB SUMMARY"
    S XMTEXT=$P(MSGTXT,")",1)_","
    D ^XMB
    ;Done - clean up and quit
    K @MSGTXT
    Q
    
    TO:
    
    N XMB,XMTEXT,XMY,XMDUZ,XMDT,XMZ,XMITPTR,LINE
    N ENCPTR,DELPTR,ENCDATE,ENCLOC,NAME,TMP,ENCZERO,SSN,PATZERO
    S XMB="SCDX AMBCARE TO NPCDB SUMMARY"
    S XMB(1)=+$G(SENT)
    S XMB(2)=+$G(ERRCNT)
    D ^XMB
    Q
    
    Finally, bulletin SCDX AMBCARE TO NPCDB SUMMARY will be edited via
    Fileman to add the message text and two new parameters for the
    number of encounters that were sent and the number of encounters
    that were not sent.  As follows:
    
    FROM:
    
    NAME: SCDX AMBCARE TO NPCDB SUMMARY
    SUBJECT: |1|//
    Select MAIL GROUP:
    RETENTION DAYS:
    DESCRIPTION:
      1>Bulletin sent at the [un]successful completion of generating
      2>workload information to be transmitted to the National Patient
      3>Care Database via HL7.
    EDIT option:
    MESSAGE:
      1>
    EDIT option:
    Select PARAMETER: 1//
    DESCRIPTION:
      1>Subject of message - allows use of one bulletin for success and
      2>unsuccessful completion.
    EDIT option:
    Select PARAMETER:
    PRIORITY?:
    
    TO:
    
    SUBJECT: Transmission of data to NPCDB completed
    Select MAIL GROUP:
    RETENTION DAYS:
    DESCRIPTION:
      1>Bulletin sent at the [un]successful completion of generating
      2>workload information to be transmitted to the National Patient
      3>Care Database via HL7.
    EDIT option:
    MESSAGE:
      1>Transmission of data to the National Patient Care Database has
      2>completed.
      3>
      4>A total of |1| Outpatient Encounters were sent.
      5>A total of |2| Outpatient Encounters were not sent.
      6>
      7>Please review the IEMM Error listing for further details.
    EDIT option:
    Select PARAMETER: 1//
    DESCRIPTION:
      1>Number of encounters that were successfully sent to NPCDB.
    EDIT option:
    Select PARAMETER: 2//
    DESCRIPTION:
      1>Number of encounters that were not sent to NPCDB.
    EDIT option:
    Select PARAMETER:
    PRIORITY?:
    
 ROUTINE SUMMARY:
 ================
 The following is a list of the routine(s) included in this patch.  The
 second line of each of these routine(s) will look like:
     
     <tab>;;5.3;Scheduling;**[patch list]**;AUG 13, 1993
     
                            CHECK^XTSUMBLD results
 Routine name      Before Patch          After Patch         Patch List
 ============      ============          ===========         ==========
 SCDXMSG2               9384923              8047071       44,121,128,66,
                                                            132,247,393
    
     
 INSTALLATION INSTRUCTIONS:
 ==========================
 This patch can be loaded with users on the system. This patch should
 not be installed at a time when the SCDX AMBCAR NIGHTLY XMIT job is
 running.
  
 Installation will take less than 2 minutes.
    
 1. Choose the PackMan message containing this patch and invoke the
     INSTALL/CHECK MESSAGE PackMan option.
    
 2. (DSM for Open VMS only) Disable routine mapping on all systems for 
     the routines listed in the routine summary.
    
     NOTE:  If the routine(s) included in this patch are not currently in
     your mapped routine set, please skip this step.
    
 3. From the Kernel Installation & Distribution System (KIDS) [XPD MAIN] 
     menu, select the Installation menu.
    
 4.  From this menu, you may elect to use the following options
     (when prompted for INSTALL NAME, enter SD*5.3*393):
    
     a.  Backup a Transport Global - This option will create a backup
         message of any routines exported with the patch.  It will NOT
         backup any other changes such as DDs and templates.
    
     b.  Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when the patch
         is installed.  It compares all components of the patch
         (routines, DDs, templates, etc.).
    
     c.  Verify Checksums in Transport Global - This option will ensure
         the integrity of the routines that are in the transport global.
    
 5.  Use the Install Package(s) option and select the package SD*5.3*393.
    
 6.  When prompted "Want KIDS to INHIBIT LOGINS during
     install? YES//" respond NO.
    
 7.  When prompted "Want to DISABLE Scheduled Options, Menu Options,
     and Protocols? YES//" respond NO.
    
 8.  (DSM for Open VMS only) Optional - Include the routines distributed 
     with this patch in the mapped routine set.
    
     NOTE:  This step is only necessary if you performed step 2 or if
     you wish to include the routine(s) in your mapped set.

Routine Information:
====================

Routine Name:
  - SCDXMSG2


Routine Checksum:

=============================================================================
User Information:
Entered By  : CURTIS,RICHARD                Date Entered  : AUG 31, 2004
Completed By: DAWSON,TIM                    Date Completed: JAN 31, 2005
Released By : HEUER,CINDY                   Date Released : JAN 31, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
