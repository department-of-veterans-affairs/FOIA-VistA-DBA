Released PSS*1*87 SEQ #85
Extracted from mail message
**KIDS**:PSS*1.0*87^

**INSTALL NAME**
PSS*1.0*87
"BLD",4854,0)
PSS*1.0*87^PHARMACY DATA MANAGEMENT^0^3050211^y
"BLD",4854,1,0)
^^57^57^3050211^
"BLD",4854,1,1,0)
As part of the Outpatient Pharmacy V. 7.0 Laser Labels Phase II project, 
"BLD",4854,1,2,0)
a new commercial data source will be utilized to provide warning label
"BLD",4854,1,3,0)
information. 
"BLD",4854,1,4,0)
 
"BLD",4854,1,5,0)
This patch is required by PSO*7*161 which does the printing of the 
"BLD",4854,1,6,0)
warning labels on the laser labels form.
"BLD",4854,1,7,0)
 
"BLD",4854,1,8,0)
The following changes are included in this patch:
"BLD",4854,1,9,0)
 
"BLD",4854,1,10,0)
Data dictionary changes:
"BLD",4854,1,11,0)
===========================
"BLD",4854,1,12,0)
New fields:
"BLD",4854,1,13,0)
1. PHARMACY SYSTEM file (#59.7), WARNING LABEL SOURCE field (#16)
"BLD",4854,1,14,0)
The new warning label processing is not fully functional until this field
"BLD",4854,1,15,0)
is set to "N" for "New" in the Pharmacy System Parameters Edit [PSS SYS 
"BLD",4854,1,16,0)
EDIT] option.
"BLD",4854,1,17,0)
2. DRUG file (#50), NEW WARNING LABEL LIST field (#8.1)
"BLD",4854,1,18,0)
If the default warnings for a drug are not sufficient, a custom list of 
"BLD",4854,1,19,0)
warning numbers can be created and stored in this field.
"BLD",4854,1,20,0)
3. DRUG file (#50), GENDER SPECIFIC LBLS ON ALL RX field (#8.2)
"BLD",4854,1,21,0)
If the commercial data source has indicated that a particular warning 
"BLD",4854,1,22,0)
only applies to one gender, then if this flag is null or "Y", the warning 
"BLD",4854,1,23,0)
will print for all patients. If this field is "N", the warning will only
"BLD",4854,1,24,0)
print for this drug when the patient is that specific gender.
"BLD",4854,1,25,0)
4. RX CONSULT file (#54), WARNING MAPPING field (#2)
"BLD",4854,1,26,0)
5. RX CONSULT file (#54), SPANISH TRANSLATION field (#3)
"BLD",4854,1,27,0)
 
"BLD",4854,1,28,0)
The last 2 fields in the above list will have some entries populated
"BLD",4854,1,29,0)
automatically in a post-install routine with this patch. The mapping is
"BLD",4854,1,30,0)
used for matching entries in the old RX CONSULT file (#54) with the
"BLD",4854,1,31,0)
equivalent entry in the new WARNING LABEL-ENGLISH file (#50.625).
"BLD",4854,1,32,0)
 
"BLD",4854,1,33,0)
New options under the PSS Manager [PSS MGR] option:
"BLD",4854,1,34,0)
==================================================
"BLD",4854,1,35,0)
1. Warning Builder [PSS WARNING BUILDER] option allows the user to print a
"BLD",4854,1,36,0)
copy of the old and new warning file entries and to choose various ways to
"BLD",4854,1,37,0)
select drugs to review which warnings will print when the flag is turned
"BLD",4854,1,38,0)
to use the new warning label source. It also allows the user to override
"BLD",4854,1,39,0)
the default warning labels to create a custom warning label list for the
"BLD",4854,1,40,0)
selected drug. This is done by specifying a list of warning numbers from
"BLD",4854,1,41,0)
the old RX CONSULT file (#54) and/or the new commercial data source
"BLD",4854,1,42,0)
warning file.
"BLD",4854,1,43,0)
2. Warning Mapping [PSS WARNING MAPPING] option can be used to match an
"BLD",4854,1,44,0)
entry from the old RX CONSULT file (#54) to the WARNING LABEL-ENGLISH 
"BLD",4854,1,45,0)
file (#50.625) to aid in using the Warning Builder (to identify local
"BLD",4854,1,46,0)
warnings that do not have an equivalent entry in the new commercial data
"BLD",4854,1,47,0)
source). The user can also enter a Spanish translation for an RX CONSULT
"BLD",4854,1,48,0)
file (#54) entry, if desired, but whenever possible, the new commercial
"BLD",4854,1,49,0)
data source's warnings should be used.
"BLD",4854,1,50,0)
 
"BLD",4854,1,51,0)
Template changes:
"BLD",4854,1,52,0)
=================
"BLD",4854,1,53,0)
This patch modifies the DRUG file (#50) INPUT template [PSSCOMMON] to 
"BLD",4854,1,54,0)
allow the user to view the new warning labels for a drug and edit the NEW 
"BLD",4854,1,55,0)
WARNING LABEL LIST field (#8.1), if desired. For drugs that have a 
"BLD",4854,1,56,0)
gender-specific warning associated with them, the new GENDER SPECIFIC 
"BLD",4854,1,57,0)
LBLS ON ALL RX field (#8.2) will also be prompted.
"BLD",4854,4,0)
^9.64PA^59.7^3
"BLD",4854,4,50,0)
50
"BLD",4854,4,50,2,0)
^9.641^50^1
"BLD",4854,4,50,2,50,0)
DRUG  (File-top level)
"BLD",4854,4,50,2,50,1,0)
^9.6411^8.2^2
"BLD",4854,4,50,2,50,1,8.1,0)
NEW WARNING LABEL LIST
"BLD",4854,4,50,2,50,1,8.2,0)
HONOR SPECIFIC TO GENDER FLAG?
"BLD",4854,4,50,222)
y^n^p^^^^n^^n
"BLD",4854,4,50,224)

"BLD",4854,4,54,0)
54
"BLD",4854,4,54,2,0)
^9.641^54^1
"BLD",4854,4,54,2,54,0)
RX CONSULT  (File-top level)
"BLD",4854,4,54,2,54,1,0)
^9.6411^3^2
"BLD",4854,4,54,2,54,1,2,0)
WARNING MAPPING
"BLD",4854,4,54,2,54,1,3,0)
SPANISH TRANSLATION
"BLD",4854,4,54,222)
y^n^p^^^^n^^n
"BLD",4854,4,54,224)

"BLD",4854,4,59.7,0)
59.7
"BLD",4854,4,59.7,2,0)
^9.641^59.7^1
"BLD",4854,4,59.7,2,59.7,0)
PHARMACY SYSTEM  (File-top level)
"BLD",4854,4,59.7,2,59.7,1,0)
^9.6411^16^1
"BLD",4854,4,59.7,2,59.7,1,16,0)
WARNING LABEL SOURCE
"BLD",4854,4,59.7,222)
y^n^p^^^^n^^n
"BLD",4854,4,59.7,224)

"BLD",4854,4,"APDD",50,50)

"BLD",4854,4,"APDD",50,50,8.1)

"BLD",4854,4,"APDD",50,50,8.2)

"BLD",4854,4,"APDD",54,54)

"BLD",4854,4,"APDD",54,54,2)

"BLD",4854,4,"APDD",54,54,3)

"BLD",4854,4,"APDD",59.7,59.7)

"BLD",4854,4,"APDD",59.7,59.7,16)

"BLD",4854,4,"B",50,50)

"BLD",4854,4,"B",54,54)

"BLD",4854,4,"B",59.7,59.7)

"BLD",4854,"INID")
^n
"BLD",4854,"INIT")
FILL^PSSWMAP
"BLD",4854,"KRN",0)
^9.67PA^8989.52^19
"BLD",4854,"KRN",.4,0)
.4
"BLD",4854,"KRN",.401,0)
.401
"BLD",4854,"KRN",.402,0)
.402
"BLD",4854,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",4854,"KRN",.402,"NM",1,0)
PSSCOMMON    FILE #50^50^0
"BLD",4854,"KRN",.402,"NM","B","PSSCOMMON    FILE #50",1)

"BLD",4854,"KRN",.403,0)
.403
"BLD",4854,"KRN",.5,0)
.5
"BLD",4854,"KRN",.84,0)
.84
"BLD",4854,"KRN",3.6,0)
3.6
"BLD",4854,"KRN",3.8,0)
3.8
"BLD",4854,"KRN",9.2,0)
9.2
"BLD",4854,"KRN",9.8,0)
9.8
"BLD",4854,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",4854,"KRN",9.8,"NM",1,0)
PSSWMAP^^0^B14049630
"BLD",4854,"KRN",9.8,"NM",2,0)
PSSWRNA^^0^B14855355
"BLD",4854,"KRN",9.8,"NM",3,0)
PSSWRNB^^0^B87809916
"BLD",4854,"KRN",9.8,"NM",4,0)
PSSWRNE^^0^B30090017
"BLD",4854,"KRN",9.8,"NM",5,0)
PSSYSP^^0^B100178
"BLD",4854,"KRN",9.8,"NM",6,0)
PSSLOOK^^0^B75247379
"BLD",4854,"KRN",9.8,"NM","B","PSSLOOK",6)

"BLD",4854,"KRN",9.8,"NM","B","PSSWMAP",1)

"BLD",4854,"KRN",9.8,"NM","B","PSSWRNA",2)

"BLD",4854,"KRN",9.8,"NM","B","PSSWRNB",3)

"BLD",4854,"KRN",9.8,"NM","B","PSSWRNE",4)

"BLD",4854,"KRN",9.8,"NM","B","PSSYSP",5)

"BLD",4854,"KRN",19,0)
19
"BLD",4854,"KRN",19,"NM",0)
^9.68A^4^3
"BLD",4854,"KRN",19,"NM",1,0)
PSS WARNING BUILDER^^0
"BLD",4854,"KRN",19,"NM",3,0)
PSS WARNING MAPPING^^0
"BLD",4854,"KRN",19,"NM",4,0)
PSS MGR^^2
"BLD",4854,"KRN",19,"NM","B","PSS MGR",4)

"BLD",4854,"KRN",19,"NM","B","PSS WARNING BUILDER",1)

"BLD",4854,"KRN",19,"NM","B","PSS WARNING MAPPING",3)

"BLD",4854,"KRN",19.1,0)
19.1
"BLD",4854,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4854,"KRN",101,0)
101
"BLD",4854,"KRN",101,"NM",0)
^9.68A^^
"BLD",4854,"KRN",409.61,0)
409.61
"BLD",4854,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",4854,"KRN",771,0)
771
"BLD",4854,"KRN",870,0)
870
"BLD",4854,"KRN",8989.51,0)
8989.51
"BLD",4854,"KRN",8989.52,0)
8989.52
"BLD",4854,"KRN",8994,0)
8994
"BLD",4854,"KRN","B",.4,.4)

"BLD",4854,"KRN","B",.401,.401)

"BLD",4854,"KRN","B",.402,.402)

"BLD",4854,"KRN","B",.403,.403)

"BLD",4854,"KRN","B",.5,.5)

"BLD",4854,"KRN","B",.84,.84)

"BLD",4854,"KRN","B",3.6,3.6)

"BLD",4854,"KRN","B",3.8,3.8)

"BLD",4854,"KRN","B",9.2,9.2)

"BLD",4854,"KRN","B",9.8,9.8)

"BLD",4854,"KRN","B",19,19)

"BLD",4854,"KRN","B",19.1,19.1)

"BLD",4854,"KRN","B",101,101)

"BLD",4854,"KRN","B",409.61,409.61)

"BLD",4854,"KRN","B",771,771)

"BLD",4854,"KRN","B",870,870)

"BLD",4854,"KRN","B",8989.51,8989.51)

"BLD",4854,"KRN","B",8989.52,8989.52)

"BLD",4854,"KRN","B",8994,8994)

"BLD",4854,"QUES",0)
^9.62^^
"BLD",4854,"REQB",0)
^9.611^3^3
"BLD",4854,"REQB",1,0)
PSS*1.0*61^2
"BLD",4854,"REQB",2,0)
PSN*4.0*86^2
"BLD",4854,"REQB",3,0)
PSN*4.0*88^2
"BLD",4854,"REQB","B","PSN*4.0*86",2)

"BLD",4854,"REQB","B","PSN*4.0*88",3)

"BLD",4854,"REQB","B","PSS*1.0*61",1)

"FIA",50)
DRUG
"FIA",50,0)
^PSDRUG(
"FIA",50,0,0)
50I
"FIA",50,0,1)
y^n^p^^^^n^^n
"FIA",50,0,10)

"FIA",50,0,11)

"FIA",50,0,"RLRO")

"FIA",50,0,"VR")
1.0^PSS
"FIA",50,50)
1
"FIA",50,50,8.1)

"FIA",50,50,8.2)

"FIA",54)
RX CONSULT
"FIA",54,0)
^PS(54,
"FIA",54,0,0)
54N
"FIA",54,0,1)
y^n^p^^^^n^^n
"FIA",54,0,10)

"FIA",54,0,11)

"FIA",54,0,"RLRO")

"FIA",54,0,"VR")
1.0^PSS
"FIA",54,54)
1
"FIA",54,54,2)

"FIA",54,54,3)

"FIA",59.7)
PHARMACY SYSTEM
"FIA",59.7,0)
^PS(59.7,
"FIA",59.7,0,0)
59.7
"FIA",59.7,0,1)
y^n^p^^^^n^^n
"FIA",59.7,0,10)

"FIA",59.7,0,11)

"FIA",59.7,0,"RLRO")

"FIA",59.7,0,"VR")
1.0^PSS
"FIA",59.7,59.7)
1
"FIA",59.7,59.7,16)

"INIT")
FILL^PSSWMAP
"KRN",.402,1998,-1)
0^1
"KRN",.402,1998,0)
PSSCOMMON^3040903.1041^@^50^^@^3050211
"KRN",.402,1998,"DIAB",1,1,50.037,0)
ALL
"KRN",.402,1998,"DIAB",1,1,50.065,0)
ALL
"KRN",.402,1998,"DR",1,50)
.01;2;D PKIND^PSSDDUT2;3;D PKIND^PSSDDUT2;W !!,"NATIONAL FORMULARY INDICATOR: " W:$P($G(^PSDRUG(DA,"ND")),"^",11)=1 "YES" W:$P($G(^PSDRUG(DA,"ND")),"^",11)="" "Not Matched To NDF" W:$P($G(^PSDRUG(DA,"ND")),"^",11)=0 "NO";51;52;37;
"KRN",.402,1998,"DR",1,50,1)
65;9;101;102;6;31;100;S PSONEWW=$S($P($G(^PS(59.7,1,10)),"^",9)="N":1,1:0) W !!,"WARNING LABEL SOURCE is "_$S(PSONEWW:"'NEW'.",1:"not 'NEW'.");
"KRN",.402,1998,"DR",1,50,2)
I PSONEWW W !,"The following WARNING LABEL may continue to be used for a limited time for some external interfaces.";I 'PSONEWW W !,"WARNING LABEL will be used until the WARNING LABEL SOURCE is set to 'NEW'.";8;@5;
"KRN",.402,1998,"DR",1,50,3)
D WARN^PSSWRNB S:$G(WARNEDIT) Y="@10" I '$G(WARNEDIT) S Y="@15";@10;8.1;S Y="@5";@15;D GENDER2^PSSWRNA I GENDER="" S Y="@20";8.2;@20;12;13;14.5;15;
"KRN",.402,1998,"DR",2,50.037)
.01
"KRN",.402,1998,"DR",2,50.065)
.01
"KRN",.402,1998,"DR",2,50.1)
.01;1;2;
"KRN",19,10551,-1)
2^4
"KRN",19,10551,0)
PSS MGR^Pharmacy Data Management^^M^11847^^^^^^^517^y
"KRN",19,10551,10,0)
^19.01IP^49^49
"KRN",19,10551,10,46,0)
12556
"KRN",19,10551,10,46,"^")
PSS WARNING BUILDER
"KRN",19,10551,10,48,0)
12559
"KRN",19,10551,10,48,"^")
PSS WARNING MAPPING
"KRN",19,10551,"U")
PHARMACY DATA MANAGEMENT
"KRN",19,12556,-1)
0^1
"KRN",19,12556,0)
PSS WARNING BUILDER^Warning Builder^^R^^^^^^^^PHARMACY DATA MANAGEMENT
"KRN",19,12556,1,0)
^19.06^3^3^3040521^^^
"KRN",19,12556,1,1,0)
This option will allow you to define a custom warning label list 
"KRN",19,12556,1,2,0)
containing entries from both the new warning label source and the old Rx 
"KRN",19,12556,1,3,0)
Consult file entries.
"KRN",19,12556,25)
PSSWRNB
"KRN",19,12556,"U")
WARNING BUILDER
"KRN",19,12559,-1)
0^3
"KRN",19,12559,0)
PSS WARNING MAPPING^Warning Mapping^^R^^^^^^^^PHARMACY DATA MANAGEMENT
"KRN",19,12559,1,0)
^^9^9^3040521^
"KRN",19,12559,1,1,0)
This option is used to match an entry from the old Rx Consult file to the
"KRN",19,12559,1,2,0)
new commercial data source warning file to aid in using the Warning 
"KRN",19,12559,1,3,0)
Builder (to identify local warnings that do not have an equivalent entry 
"KRN",19,12559,1,4,0)
in the new commercial data source).
"KRN",19,12559,1,5,0)
 
"KRN",19,12559,1,6,0)
The user can also enter a Spanish translation for an Rx Consult file 
"KRN",19,12559,1,7,0)
entry, if desired, but whenever possible, the new commercial data source's
"KRN",19,12559,1,8,0)
warnings (English or Spanish depending on the patient setting) should be
"KRN",19,12559,1,9,0)
used.
"KRN",19,12559,25)
EDIT^PSSWMAP
"KRN",19,12559,"U")
WARNING MAPPING
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",517,-1)
1^1
"PKG",517,0)
PHARMACY DATA MANAGEMENT^PSS^Maintenance of Pharmacy files.
"PKG",517,20,0)
^9.402P^^
"PKG",517,22,0)
^9.49I^1^1
"PKG",517,22,1,0)
1.0^2970930^2971014^11595
"PKG",517,22,1,"PAH",1,0)
87^3050211
"PKG",517,22,1,"PAH",1,1,0)
^^57^57^3050211
"PKG",517,22,1,"PAH",1,1,1,0)
As part of the Outpatient Pharmacy V. 7.0 Laser Labels Phase II project, 
"PKG",517,22,1,"PAH",1,1,2,0)
a new commercial data source will be utilized to provide warning label
"PKG",517,22,1,"PAH",1,1,3,0)
information. 
"PKG",517,22,1,"PAH",1,1,4,0)
 
"PKG",517,22,1,"PAH",1,1,5,0)
This patch is required by PSO*7*161 which does the printing of the 
"PKG",517,22,1,"PAH",1,1,6,0)
warning labels on the laser labels form.
"PKG",517,22,1,"PAH",1,1,7,0)
 
"PKG",517,22,1,"PAH",1,1,8,0)
The following changes are included in this patch:
"PKG",517,22,1,"PAH",1,1,9,0)
 
"PKG",517,22,1,"PAH",1,1,10,0)
Data dictionary changes:
"PKG",517,22,1,"PAH",1,1,11,0)
===========================
"PKG",517,22,1,"PAH",1,1,12,0)
New fields:
"PKG",517,22,1,"PAH",1,1,13,0)
1. PHARMACY SYSTEM file (#59.7), WARNING LABEL SOURCE field (#16)
"PKG",517,22,1,"PAH",1,1,14,0)
The new warning label processing is not fully functional until this field
"PKG",517,22,1,"PAH",1,1,15,0)
is set to "N" for "New" in the Pharmacy System Parameters Edit [PSS SYS 
"PKG",517,22,1,"PAH",1,1,16,0)
EDIT] option.
"PKG",517,22,1,"PAH",1,1,17,0)
2. DRUG file (#50), NEW WARNING LABEL LIST field (#8.1)
"PKG",517,22,1,"PAH",1,1,18,0)
If the default warnings for a drug are not sufficient, a custom list of 
"PKG",517,22,1,"PAH",1,1,19,0)
warning numbers can be created and stored in this field.
"PKG",517,22,1,"PAH",1,1,20,0)
3. DRUG file (#50), GENDER SPECIFIC LBLS ON ALL RX field (#8.2)
"PKG",517,22,1,"PAH",1,1,21,0)
If the commercial data source has indicated that a particular warning 
"PKG",517,22,1,"PAH",1,1,22,0)
only applies to one gender, then if this flag is null or "Y", the warning 
"PKG",517,22,1,"PAH",1,1,23,0)
will print for all patients. If this field is "N", the warning will only
"PKG",517,22,1,"PAH",1,1,24,0)
print for this drug when the patient is that specific gender.
"PKG",517,22,1,"PAH",1,1,25,0)
4. RX CONSULT file (#54), WARNING MAPPING field (#2)
"PKG",517,22,1,"PAH",1,1,26,0)
5. RX CONSULT file (#54), SPANISH TRANSLATION field (#3)
"PKG",517,22,1,"PAH",1,1,27,0)
 
"PKG",517,22,1,"PAH",1,1,28,0)
The last 2 fields in the above list will have some entries populated
"PKG",517,22,1,"PAH",1,1,29,0)
automatically in a post-install routine with this patch. The mapping is
"PKG",517,22,1,"PAH",1,1,30,0)
used for matching entries in the old RX CONSULT file (#54) with the
"PKG",517,22,1,"PAH",1,1,31,0)
equivalent entry in the new WARNING LABEL-ENGLISH file (#50.625).
"PKG",517,22,1,"PAH",1,1,32,0)
 
"PKG",517,22,1,"PAH",1,1,33,0)
New options under the PSS Manager [PSS MGR] option:
"PKG",517,22,1,"PAH",1,1,34,0)
==================================================
"PKG",517,22,1,"PAH",1,1,35,0)
1. Warning Builder [PSS WARNING BUILDER] option allows the user to print a
"PKG",517,22,1,"PAH",1,1,36,0)
copy of the old and new warning file entries and to choose various ways to
"PKG",517,22,1,"PAH",1,1,37,0)
select drugs to review which warnings will print when the flag is turned
"PKG",517,22,1,"PAH",1,1,38,0)
to use the new warning label source. It also allows the user to override
"PKG",517,22,1,"PAH",1,1,39,0)
the default warning labels to create a custom warning label list for the
"PKG",517,22,1,"PAH",1,1,40,0)
selected drug. This is done by specifying a list of warning numbers from
"PKG",517,22,1,"PAH",1,1,41,0)
the old RX CONSULT file (#54) and/or the new commercial data source
"PKG",517,22,1,"PAH",1,1,42,0)
warning file.
"PKG",517,22,1,"PAH",1,1,43,0)
2. Warning Mapping [PSS WARNING MAPPING] option can be used to match an
"PKG",517,22,1,"PAH",1,1,44,0)
entry from the old RX CONSULT file (#54) to the WARNING LABEL-ENGLISH 
"PKG",517,22,1,"PAH",1,1,45,0)
file (#50.625) to aid in using the Warning Builder (to identify local
"PKG",517,22,1,"PAH",1,1,46,0)
warnings that do not have an equivalent entry in the new commercial data
"PKG",517,22,1,"PAH",1,1,47,0)
source). The user can also enter a Spanish translation for an RX CONSULT
"PKG",517,22,1,"PAH",1,1,48,0)
file (#54) entry, if desired, but whenever possible, the new commercial
"PKG",517,22,1,"PAH",1,1,49,0)
data source's warnings should be used.
"PKG",517,22,1,"PAH",1,1,50,0)
 
"PKG",517,22,1,"PAH",1,1,51,0)
Template changes:
"PKG",517,22,1,"PAH",1,1,52,0)
=================
"PKG",517,22,1,"PAH",1,1,53,0)
This patch modifies the DRUG file (#50) INPUT template [PSSCOMMON] to 
"PKG",517,22,1,"PAH",1,1,54,0)
allow the user to view the new warning labels for a drug and edit the NEW 
"PKG",517,22,1,"PAH",1,1,55,0)
WARNING LABEL LIST field (#8.1), if desired. For drugs that have a 
"PKG",517,22,1,"PAH",1,1,56,0)
gender-specific warning associated with them, the new GENDER SPECIFIC 
"PKG",517,22,1,"PAH",1,1,57,0)
LBLS ON ALL RX field (#8.2) will also be prompted.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","PSSLOOK")
0^6^B75247379
"RTN","PSSLOOK",1,0)
PSSLOOK ;BIR/WRT-Drug file lookup ;02/03/00
"RTN","PSSLOOK",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**3,7,15,16,20,24,29,38,68,61,87**;9/30/97
"RTN","PSSLOOK",3,0)
 ;
"RTN","PSSLOOK",4,0)
 ;Reference to ^PS(50.605 supported by DBIA #2138
"RTN","PSSLOOK",5,0)
 ;Reference to ^PS(50.608 supported by DBIA #2136
"RTN","PSSLOOK",6,0)
 ;Reference to ^PS(50.609 supported by DBIA #2137
"RTN","PSSLOOK",7,0)
 ;Reference to ^PS(50.607 supported by DBIA #2221
"RTN","PSSLOOK",8,0)
 ;Reference to $$FORMRX^PSNAPIS(DA,K,.LIST) supported by DBIA #2574
"RTN","PSSLOOK",9,0)
 ;Reference to $$FORMI^PSNAPIS(P1,P3) supported by DBIA #2574
"RTN","PSSLOOK",10,0)
 ;Reference to $$PSJDF^PSNAPIS(P1,P3) supported by DBIA #2531
"RTN","PSSLOOK",11,0)
 ;Reference to $$PROD2^PSNAPIS(P1,P3) supported by DBIA #2531
"RTN","PSSLOOK",12,0)
 ;Reference to $$VAGN^PSNAPIS(P1) supported by DBIA #2531
"RTN","PSSLOOK",13,0)
 ;Reference to ^PSNDF(50.68 supported by DBIA 3735
"RTN","PSSLOOK",14,0)
 ;
"RTN","PSSLOOK",15,0)
START S QUIT=0,PSSFG=0 D KILL F PSSXX=1:1 D PICK Q:PSSFG
"RTN","PSSLOOK",16,0)
DONE D KILL K PSSFG,PSSXX,QUIT,FM,FMS,Y2K
"RTN","PSSLOOK",17,0)
 Q
"RTN","PSSLOOK",18,0)
PICK W ! K DIC S DIC="^PSDRUG(",DIC(0)="QEAMN" D ^DIC K DIC I Y<0 S PSSFG=1 Q
"RTN","PSSLOOK",19,0)
 S IFN=+Y D NDDATA,GETDATA,INACT,NOD66,FORMAT,KILL
"RTN","PSSLOOK",20,0)
 Q
"RTN","PSSLOOK",21,0)
NDDATA I $D(^PSDRUG(IFN,"ND")) S CLPTR=$P(^PSDRUG(IFN,"ND"),"^",6) I $P(^PSDRUG(IFN,"ND"),"^",2)]"" S NDNODE=^PSDRUG(IFN,"ND"),VAGNPTR=$P(NDNODE,"^",1),VAPN=$P(NDNODE,"^",2),SZPTR=$P(NDNODE,"^",4),TYPTR=$P(NDNODE,"^",5) D NDF,NDF1
"RTN","PSSLOOK",22,0)
 Q
"RTN","PSSLOOK",23,0)
NDF S DA=VAGNPTR,X=$$VAGN^PSNAPIS(DA),VAGN=X,PS=$P(^PS(50.609,SZPTR,0),"^",1),PT=$P(^PS(50.608,TYPTR,0),"^",1),P3=$P(NDNODE,"^",3)
"RTN","PSSLOOK",24,0)
 K X S DA=VAGNPTR,K=P3,X=$$PROD2^PSNAPIS(DA,K) I X]"",$P(X,"^")]"" S VAPRN=$P(X,"^"),VADU=$P(X,"^",4),CMOPID=$P(X,"^",2)
"RTN","PSSLOOK",25,0)
 S CSF="" I $P(NDNODE,"^",3) S CSF=$$GET1^DIQ(50.68,$P(NDNODE,"^",3),19,"I")
"RTN","PSSLOOK",26,0)
 Q
"RTN","PSSLOOK",27,0)
IT S CMOPID=$P(X,"^",2)
"RTN","PSSLOOK",28,0)
 Q
"RTN","PSSLOOK",29,0)
NDF1 S X=$$PSJDF^PSNAPIS(DA,K),VADF=$P(X,"^",2)
"RTN","PSSLOOK",30,0)
 Q
"RTN","PSSLOOK",31,0)
INACT S ACT="" I $D(^PSDRUG(IFN,"I")) S Y=$P(^PSDRUG(IFN,"I"),"^",1) X ^DD("DD") S ACT=Y
"RTN","PSSLOOK",32,0)
 Q
"RTN","PSSLOOK",33,0)
GETDATA S NODE0=^PSDRUG(IFN,0),GN=$P(NODE0,"^",1),CL=$P(NODE0,"^",2),DEA=$P(NODE0,"^",3),WRN=$P(NODE0,"^",8),NF=$P(NODE0,"^",9),MESS=$P(NODE0,"^",10),VNF=$P(NODE0,"^",11),CLASS="",WARN="" S:NF=1 NF="N/F" S:VNF=1 VNF="V-N/F"
"RTN","PSSLOOK",34,0)
 S PSSNODE=$G(^PSDRUG(IFN,"DOS"))
"RTN","PSSLOOK",35,0)
 I CL]"" S CLASS=CL_"  "_$P(^PS(50.605,CLPTR,0),"^",2)
"RTN","PSSLOOK",36,0)
 I $D(^PSDRUG(IFN,3)) S:$P(^PSDRUG(IFN,3),"^")=0 CMOP="NO" S:$P(^PSDRUG(IFN,3),"^")=1 CMOP="YES"
"RTN","PSSLOOK",37,0)
 I $D(^PSDRUG(IFN,5)) S QDM=^PSDRUG(IFN,5)
"RTN","PSSLOOK",38,0)
 S OINM="" S NDC="" I $D(^PSDRUG(IFN,2)) S NODE2=^PSDRUG(IFN,2) S:$P(NODE2,"^",1)]"" OIPTR=$P(NODE2,"^",1) S NDC=$P(NODE2,"^",4) S:$P(NODE2,"^",6)]"" PDPTR=$P(NODE2,"^",6) S APP=$P(NODE2,"^",3),FM="" D TWOA
"RTN","PSSLOOK",39,0)
 Q
"RTN","PSSLOOK",40,0)
TWOA I $D(OIPTR) S OI=$P(^PS(50.7,OIPTR,0),"^",1),DFPTR=$P(^PS(50.7,OIPTR,0),"^",2),DF=$P(^PS(50.606,DFPTR,0),"^",1),FMS=$P(^PS(50.7,OIPTR,0),"^",12) S:FMS]"" FM=" (N/F)" S OINM=OI_" "_DF_FM
"RTN","PSSLOOK",41,0)
 ;I $D(PDPTR) S PD=$P(^PS(50.3,PDPTR,0),"^",1)
"RTN","PSSLOOK",42,0)
 Q
"RTN","PSSLOOK",43,0)
NOD66 S (DUPOU,PPDU,PPOU,DU,SS)="" I $D(^PSDRUG(IFN,660)) S NDE=^PSDRUG(IFN,660),OUPTR=$P(NDE,"^",2),PPOU=$P(NDE,"^",3),DUPOU=$P(NDE,"^",5),PPDU=$P(NDE,"^",6),SS=$P(NDE,"^",7),DU=$P(NDE,"^",8) I OUPTR]"" S OU=$P(^DIC(51.5,OUPTR,0),"^")
"RTN","PSSLOOK",44,0)
 Q
"RTN","PSSLOOK",45,0)
SYN I $D(^PSDRUG(IFN,1,0)) F ZZZ=0:0 S ZZZ=$O(^PSDRUG(IFN,1,ZZZ)) Q:'ZZZ  S SYNM=$P(^PSDRUG(IFN,1,ZZZ,0),"^",1),INT=$P(^PSDRUG(IFN,1,ZZZ,0),"^",3) D SYN1
"RTN","PSSLOOK",46,0)
 Q
"RTN","PSSLOOK",47,0)
SYN1 S INT=$S(INT=0:"Trade Name",INT=1:"Quick Code",INT="C":"Ctrl Substances",INT="D":"Drug Accountability",1:"") D FULL Q:$G(QUIT)  W ?14,SYNM,?55,INT,!
"RTN","PSSLOOK",48,0)
 Q
"RTN","PSSLOOK",49,0)
SYN2 S:INT=0 INT="Trade" S:INT=1 INT="Quick" S:INT="C" INT="Ctrl Subs" S:INT="D" INT="Drug Acct" W ?16,SYNM,?57,INT,!
"RTN","PSSLOOK",50,0)
 Q
"RTN","PSSLOOK",51,0)
IFCAP I $D(^PSDRUG(IFN,441,0)) F QQQ=0:0 S QQQ=$O(^PSDRUG(IFN,441,QQQ)) Q:'QQQ  S IFCAPNM=$P(^PSDRUG(IFN,441,QQQ,0),"^",1)
"RTN","PSSLOOK",52,0)
 Q
"RTN","PSSLOOK",53,0)
FORMAT ; BEGIN WRITING
"RTN","PSSLOOK",54,0)
 W @IOF,?21,GN,!
"RTN","PSSLOOK",55,0)
 F XX=1:1:77 W "="
"RTN","PSSLOOK",56,0)
 W !
"RTN","PSSLOOK",57,0)
 W:$D(VAPRN) "VA PRINT NAME: ",?17,VAPRN W:$D(CMOPID) ?60,"CMOP ID#: ",CMOPID W:$D(VAPN) !,"VA PRODUCT NAME: ",?17,VAPN W:$D(CMOP) ?60,"CMOP DISPENSE: ",CMOP
"RTN","PSSLOOK",58,0)
 W:$D(OINM) !,"ORDERABLE ITEM: ",?17,OINM W:$D(VAPN) ?60,"NDF DF: ",VADF
"RTN","PSSLOOK",59,0)
 I $D(OIPTR),OIPTR]"" W !,"ORDERABLE ITEM TEXT: ",! D OITXT
"RTN","PSSLOOK",60,0)
 W:$D(PD) !,"PRIMARY DRUG: ",?17,PD
"RTN","PSSLOOK",61,0)
 W !,"SYNONYM(S): " D SYN D FULL Q:$G(QUIT)  W !,"MESSAGE: ",MESS,!
"RTN","PSSLOOK",62,0)
 D FULL Q:$G(QUIT)  F XX=1:1:77 W "-"
"RTN","PSSLOOK",63,0)
 W !
"RTN","PSSLOOK",64,0)
 D FULL Q:$G(QUIT)  W "DEA, SPECIAL HDLG: ",DEA,?48,"NDC: ",?63,NDC
"RTN","PSSLOOK",65,0)
 D FULL Q:$G(QUIT)  W !,"CS FEDERAL SCHEDULE: ",$G(CSF)
"RTN","PSSLOOK",66,0)
 D FULL Q:$G(QUIT)  W !,"INACTIVE DATE: ",ACT
"RTN","PSSLOOK",67,0)
 D FULL Q:$G(QUIT)  W:$D(QDM) !,"QUANTITY DISPENSE MESSAGE: ",QDM,!
"RTN","PSSLOOK",68,0)
 D FULL Q:$G(QUIT)  I WRN]"" W !,"WARNING LABEL: " S X=WRN F Z0=1:1 Q:$P(X,",",Z0,99)=""  S Z1=$P(X,",",Z0) W:$D(^PS(54,Z1,0)) ?19,$P(^(0),"^",1),! I '$D(^(0)) W ?19,"NO SUCH WARNING LABEL" K X Q
"RTN","PSSLOOK",69,0)
 D FULL Q:$G(QUIT)  S PSSLOOK=1 D
"RTN","PSSLOOK",70,0)
 .N DRUG
"RTN","PSSLOOK",71,0)
 .I $P($G(^PSDRUG(IFN,0)),"^")="" K PSSLOOK Q
"RTN","PSSLOOK",72,0)
 .S PSSWSITE=+$O(^PS(59.7,0)) W !,"WARNING LABEL SOURCE is " D
"RTN","PSSLOOK",73,0)
 ..I $P($G(^PS(59.7,PSSWSITE,10)),"^",9)="N" W "set to 'NEW'" Q
"RTN","PSSLOOK",74,0)
 ..W "not set to 'NEW'"
"RTN","PSSLOOK",75,0)
 .K PSSWRN
"RTN","PSSLOOK",76,0)
 .D FULL Q:$G(QUIT)  W !,"NEW WARNING LABEL:"
"RTN","PSSLOOK",77,0)
 .S ^TMP("PSSWRNB",$J,$P(^PSDRUG(IFN,0),"^"))="" D ^PSSWRNE
"RTN","PSSLOOK",78,0)
 .K PSSLOOK,^TMP("PSSWRNB",$J),PSSWRN
"RTN","PSSLOOK",79,0)
 D FULL Q:$G(QUIT)  W:'$D(QDM) ! F XX=1:1:77 W "-"
"RTN","PSSLOOK",80,0)
 D FULL Q:$G(QUIT)  W !
"RTN","PSSLOOK",81,0)
 W "ORDER UNIT: ",?27 W:$D(OU) OU W ?40,"PRICE/ORDER UNIT: ",?67,PPOU
"RTN","PSSLOOK",82,0)
 D FULL Q:$G(QUIT)  W !,"DISPENSE UNIT: ",?27,DU W:$D(VADU) ?40,"VA DISPENSE UNIT: ",?67,VADU
"RTN","PSSLOOK",83,0)
 D FULL Q:$G(QUIT)  W !,"DISPENSE UNITS/ORDER UNIT: ",?21,DUPOU,?40,"PRICE/DISPENSE UNIT: ",?67,PPDU
"RTN","PSSLOOK",84,0)
 D FULL Q:$G(QUIT)  W !,"APPL PKG USE:" D PACK
"RTN","PSSLOOK",85,0)
 Q
"RTN","PSSLOOK",86,0)
PACK S APPL="" S:'$D(APP) APPL="  NONE"
"RTN","PSSLOOK",87,0)
 I $D(APP) D
"RTN","PSSLOOK",88,0)
 . S:APP["O" APPL=APPL_"  Outpatient" S:APP["U" APPL=APPL_"  Unit Dose"
"RTN","PSSLOOK",89,0)
 . S:APP["I" APPL=APPL_"  IV" S:APP["W" APPL=APPL_"  Ward Stock"
"RTN","PSSLOOK",90,0)
 . S:APP["N" APPL=APPL_"  Control Subs" S:APP["X" APPL=APPL_"  Non-VA Med"
"RTN","PSSLOOK",91,0)
 . S:APPL="" APPL="  NONE"
"RTN","PSSLOOK",92,0)
 W ?13,APPL
"RTN","PSSLOOK",93,0)
 I $P(PSSNODE,"^",2) S (PSSCALC,PSSUNIT)=$P($G(^PS(50.607,+$P(PSSNODE,U,2),0)),U),PSSSTR=$P(PSSNODE,"^")
"RTN","PSSLOOK",94,0)
 I $G(PSSUNIT)'="",$G(PSSUNIT)["/" D UNCALC
"RTN","PSSLOOK",95,0)
 D FULL Q:$G(QUIT)  W !,"STRENGTH: ",$P(PSSNODE,U),?35,"UNIT: ",$G(PSSCALC)
"RTN","PSSLOOK",96,0)
 D FULL Q:$G(QUIT)  W !,"POSSIBLE DOSAGES:"
"RTN","PSSLOOK",97,0)
 I $D(^PSDRUG(IFN,"DOS1",0)) F PDS=0:0 S PDS=$O(^PSDRUG(IFN,"DOS1",PDS)) Q:'PDS  D
"RTN","PSSLOOK",98,0)
 .S POSDOS=^PSDRUG(IFN,"DOS1",PDS,0)
"RTN","PSSLOOK",99,0)
 .D FULL Q:$G(QUIT)  W !,"   DISPENSE UNITS PER DOSE: ",$P(POSDOS,U),?40,"DOSE: ",$P(POSDOS,U,2),?55,"PACKAGE: ",$P(POSDOS,U,3)
"RTN","PSSLOOK",100,0)
 .D FULL Q:$G(QUIT)  W !,"       BCMA UNITS PER DOSE: ",$P(POSDOS,U,4)
"RTN","PSSLOOK",101,0)
 D FULL Q:$G(QUIT)  W !,"LOCAL POSSIBLE DOSAGES:"
"RTN","PSSLOOK",102,0)
 I $D(^PSDRUG(IFN,"DOS2",0)) F PDS=0:0 S PDS=$O(^PSDRUG(IFN,"DOS2",PDS)) Q:'PDS  D
"RTN","PSSLOOK",103,0)
 .S LPDOS=^PSDRUG(IFN,"DOS2",PDS,0)
"RTN","PSSLOOK",104,0)
 .D FULL Q:$G(QUIT)  W !,"   LOCAL POSSIBLE DOSAGE: " D
"RTN","PSSLOOK",105,0)
 ..I $L($P(LPDOS,U))'>27 W $P(LPDOS,U),?55,"PACKAGE: ",$P(LPDOS,U,2)
"RTN","PSSLOOK",106,0)
 ..E   W !,?10,$P(LPDOS,U),!,?55,"PACKAGE: ",$P(LPDOS,U,2)
"RTN","PSSLOOK",107,0)
 ..D FULL Q:$G(QUIT)  W !,"     BCMA UNITS PER DOSE: ",$P(LPDOS,U,3)
"RTN","PSSLOOK",108,0)
 D FULL Q:$G(QUIT)  W ! F XX=1:1:77 W "-"
"RTN","PSSLOOK",109,0)
 D FULL Q:$G(QUIT)  W !,"VA CLASS: ",$G(CLASS)
"RTN","PSSLOOK",110,0)
 D FULL Q:$G(QUIT)  W !,"LOCAL NON-FORMULARY: ",$G(NF),"          ","VISN NON-FORMULARY: ",$G(VNF)
"RTN","PSSLOOK",111,0)
 N DA,K,LIST,PSXDN,PSXGN,PSXVP,X,XX1,XX2
"RTN","PSSLOOK",112,0)
 K PSXGN,PSXVP I $D(^PSDRUG(IFN,"ND")) S PSXDN=$G(^PSDRUG(IFN,"ND")),PSXGN=$P(PSXDN,"^"),PSXVP=$P(PSXDN,"^",3)
"RTN","PSSLOOK",113,0)
 I $G(PSXGN),$G(PSXVP) S X=$$PROD2^PSNAPIS(PSXGN,PSXVP),XX1=$$FORMI^PSNAPIS(PSXGN,PSXVP)
"RTN","PSSLOOK",114,0)
 D FULL Q:$G(QUIT)  W !,"National Formulary Indicator: "_$S($G(XX1)=1:"YES",$G(XX1)=0:"NO",1:"Not Matched to NDF")
"RTN","PSSLOOK",115,0)
 I $D(^PSDRUG(IFN,65,0)) D FULL Q:$G(QUIT)  W !,"FORMULARY ALTERNATIVES: ",! F FA=0:0 S FA=$O(^PSDRUG(IFN,65,FA)) Q:'FA  S LDFPTR=$P($G(^PSDRUG(IFN,65,FA,0)),"^") I LDFPTR D FULL Q:$G(QUIT)  W ?26,$P($G(^PSDRUG(LDFPTR,0)),"^"),!
"RTN","PSSLOOK",116,0)
 D FULL Q:$G(QUIT)  I $G(PSXGN),$G(PSXVP) W !,"National Restriction: " S XX2=$$FORMRX^PSNAPIS(PSXGN,PSXVP,.LIST) I $G(XX2)=1,$D(LIST) F XX2=0:0 S XX2=$O(LIST(XX2)) Q:'XX2  D FULL Q:$G(QUIT)  W !,LIST(XX2,0)
"RTN","PSSLOOK",117,0)
 W !,"Local Drug Text: ",! I $D(^PSDRUG(IFN,9,0)) D LDT
"RTN","PSSLOOK",118,0)
 Q
"RTN","PSSLOOK",119,0)
LDT F TXT1=0:0 S TXT1=$O(^PSDRUG(IFN,9,TXT1)) Q:'TXT1  S TEXPTR=^PSDRUG(IFN,9,TXT1,0) F PPP=0:0 S PPP=$O(^PS(51.7,TEXPTR,2,PPP)) Q:'PPP  S PST=$P($G(^PS(51.7,TEXPTR,0)),"^",2) I 'PST S WPT=^PS(51.7,TEXPTR,2,PPP,0) D FULL Q:$G(QUIT)  W WPT,!
"RTN","PSSLOOK",120,0)
 ;
"RTN","PSSLOOK",121,0)
 ;
"RTN","PSSLOOK",122,0)
KILL K IFN,APP,INT,VADU,VAGN,VAPN,VAPRN,P3,VAGNPTR,MESS,CLASS,DEA,ACT,CL,CLPTR,CMOP,DF,DFPTR,DU,DUPOUGN,IFCAPNM,NDC,NDE,NDNODE,NF,NODE0,NODE2,OI,OINM,OIPTR,OU,PD,PDPTR,PPDU,PPOU,PS,PT,NOD66,SYNM,SZPTR,TYPTR,WARN,WRN,XX,ZZZ,SS,OUPTR,CMOPID
"RTN","PSSLOOK",123,0)
 K DUPOU,QQQ,GN,QDM,APPL,VADF,DFP,DFRM,Y,Z0,Z1,DDD,PPP,TEXT,TXTPTR,TXT,TXT1,TEXPTR,VNF,WPT,FA,LDFPTR,TEXTPTR,QUIT,PST,D0,DA,K,DIR
"RTN","PSSLOOK",124,0)
 K PSSNODE,PSDOSUN,PDS,POSDOS,LPDOS,CSF
"RTN","PSSLOOK",125,0)
 Q
"RTN","PSSLOOK",126,0)
OITXT I $D(^PS(50.7,OIPTR,1,0)) F TXT=0:0 S TXT=$O(^PS(50.7,OIPTR,1,TXT)) Q:'TXT  S TEXTPTR=^PS(50.7,OIPTR,1,TXT,0) F DDD=0:0 S DDD=$O(^PS(51.7,TEXTPTR,2,DDD)) Q:'DDD  D IDATE I 'Y2K S TEXT=^PS(51.7,TEXTPTR,2,DDD,0) D FULL Q:$G(QUIT)  W TEXT,!
"RTN","PSSLOOK",127,0)
 Q
"RTN","PSSLOOK",128,0)
FULL D:($Y+5)>IOSL&('$G(QUIT)) FSCRN
"RTN","PSSLOOK",129,0)
 Q
"RTN","PSSLOOK",130,0)
FSCRN Q:$G(QUIT)  W ! K DIR S DIR(0)="E",DIR("A")="Press Return to continue,'^' to exit" D ^DIR W @IOF S:Y'=1 QUIT=1
"RTN","PSSLOOK",131,0)
 Q
"RTN","PSSLOOK",132,0)
IDATE S Y2K=$P($G(^PS(51.7,TEXTPTR,0)),"^",2)
"RTN","PSSLOOK",133,0)
 Q
"RTN","PSSLOOK",134,0)
UNCALC ;
"RTN","PSSLOOK",135,0)
 N PSSVA,PSSVA1,PSSVB,PSSVB1,PSSDASH,PSSNDFS,PSSDASH2,PSSDASH3,PSSDASH5 K PSSCALC
"RTN","PSSLOOK",136,0)
 S PSSDASH=0 S PSSNDFS=$$PSJST^PSNAPIS(+$P($G(^PSDRUG(IFN,"ND")),"^"),+$P($G(^PSDRUG(IFN,"ND")),"^",3)) S PSSNDFS=+$P($G(PSSNDFS),"^",2)
"RTN","PSSLOOK",137,0)
 I $G(PSSNDFS),$G(PSSSTR),+$G(PSSSTR)'=+$G(PSSNDFS) S PSSDASH=1
"RTN","PSSLOOK",138,0)
 S PSSVA=$P(PSSUNIT,"/"),PSSVB=$P(PSSUNIT,"/",2),PSSVA1=+$G(PSSVA),PSSVB1=+$G(PSSVB)
"RTN","PSSLOOK",139,0)
 I $G(PSSDASH) S PSSDASH2=PSSSTR/PSSNDFS,PSSDASH3=PSSDASH2*$S($G(PSSVB1):PSSVB1,1:1) S PSSDASH5=$S('$G(PSSVB1):PSSDASH3_$G(PSSVB),1:PSSDASH3_$P(PSSVB,PSSVB1,2))
"RTN","PSSLOOK",140,0)
 S PSSCALC=$S($G(PSSDASH):$S('$G(PSSVA1):PSSVA,1:$P(PSSVA1,PSSVA1,2))_"/"_$G(PSSDASH5),1:PSSUNIT)
"RTN","PSSLOOK",141,0)
 Q
"RTN","PSSWMAP")
0^1^B14049630
"RTN","PSSWMAP",1,0)
PSSWMAP ;BIR/EJW-MAP WARNINGS FROM RX CONSULT FILE TO FDB ;05/21/04
"RTN","PSSWMAP",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**87**;9/30/97
"RTN","PSSWMAP",3,0)
 ;
"RTN","PSSWMAP",4,0)
 ;Reference to ^PS(50.625 supported by DBIA 4445
"RTN","PSSWMAP",5,0)
 ; This routine provides the ability to map entries from the RX CONSULT file (#54)
"RTN","PSSWMAP",6,0)
 ; to the new warning data source - First Data Bank's WARNING LABEL-ENGLISH file (#50.625)
"RTN","PSSWMAP",7,0)
 ; USERS CAN ENTER THEIR OWN MAPPING TO BE USED WITH THE WARNING LABEL BUILDER
"RTN","PSSWMAP",8,0)
 ;
"RTN","PSSWMAP",9,0)
 Q
"RTN","PSSWMAP",10,0)
FILL ;
"RTN","PSSWMAP",11,0)
 D BMES^XPDUTL("Populating the warning mapping from RX CONSULT file entries 1-6,8-11,12,13")
"RTN","PSSWMAP",12,0)
 D BMES^XPDUTL("and 15 to the equivalent WARNING LABEL-ENGLISH file entries.")
"RTN","PSSWMAP",13,0)
 N JJ
"RTN","PSSWMAP",14,0)
 F JJ=1:1:6,8:1:11 S DIE="^PS(54,",DA=JJ,DR="2///"_JJ D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",15,0)
 S DIE="^PS(54,",DA=12,DR="2///19" D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",16,0)
 S DIE="^PS(54,",DA=13,DR="2///20" D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",17,0)
 S DIE="^PS(54,",DA=15,DR="2///30" D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",18,0)
 S DIE="^PS(54,",DA=20,DR="3///PRECAUCION: La ley federal prohibe la transferencia de este medicamento a otro paciente para el que no fue recetado." D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",19,0)
 D BMES^XPDUTL("Mapping complete and Spanish translation for warning number 20 populated.")
"RTN","PSSWMAP",20,0)
 Q
"RTN","PSSWMAP",21,0)
EDIT ; ADD WARNING MAPPING AND/OR SPANISH TRANSLATION TO RX CONSULT FILE ENTRY
"RTN","PSSWMAP",22,0)
 N MAP,NEW,RXNUM,PSSTXT
"RTN","PSSWMAP",23,0)
 W !!," Note: Warning mapping is only used as an aid when using the warning builder."
"RTN","PSSWMAP",24,0)
 W !," If a DRUG WARNING is defined with a warning mapping of 0, that entry will be"
"RTN","PSSWMAP",25,0)
 W !," skipped when choosing option 6 Drug has WARNING LABEL that does not map to"
"RTN","PSSWMAP",26,0)
 W !," new data source."
"RTN","PSSWMAP",27,0)
 D HDR
"RTN","PSSWMAP",28,0)
 S RXNUM=0 F  S RXNUM=$O(^PS(54,RXNUM)) Q:'RXNUM  D
"RTN","PSSWMAP",29,0)
 .D FULL I '$G(PSSOUT) W !,RXNUM,?8,$P($G(^PS(54,RXNUM,0)),"^"),?40," ",$G(^PS(54,RXNUM,2))
"RTN","PSSWMAP",30,0)
EDIT1 W ! S DIC=54,DIC(0)="AEMQ",DIC("A")="Enter a valid Rx Consult file number: " D ^DIC K DIC I Y<1 Q
"RTN","PSSWMAP",31,0)
 S RXNUM=+Y
"RTN","PSSWMAP",32,0)
 S PSSTXT=0 F  S PSSTXT=$O(^PS(54,RXNUM,1,PSSTXT)) Q:'PSSTXT  W !,?3,^PS(54,RXNUM,1,PSSTXT,0)
"RTN","PSSWMAP",33,0)
 W !
"RTN","PSSWMAP",34,0)
 S MAP=$P($G(^PS(54,RXNUM,2)),"^") I MAP'="" W !,"Rx Consult file number "_RXNUM_" is mapped to WARNING LABEL-ENGLISH number "_MAP D  G ASK
"RTN","PSSWMAP",35,0)
 .S PSSTXT=0 F  S PSSTXT=$O(^PS(50.625,MAP,1,PSSTXT)) Q:'PSSTXT  W !,?3,^PS(50.625,MAP,1,PSSTXT,0)
"RTN","PSSWMAP",36,0)
 K DIR W ! S DIR(0)="N0",DIR("B")=$S(MAP'="":MAP,1:""),DIR("A")="Enter a number from WARNING LABEL-ENGLISH file to map to: " D ^DIR K DIR
"RTN","PSSWMAP",37,0)
 I Y<0!($E(Y)="^") G SPANISH
"RTN","PSSWMAP",38,0)
 S NEW=+Y
"RTN","PSSWMAP",39,0)
 S DIE="^PS(54,",DA=RXNUM,DR="2///"_NEW D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",40,0)
 S PSSTXT=0 F  S PSSTXT=$O(^PS(50.625,NEW,1,PSSTXT)) Q:'PSSTXT  W !,?3,^PS(50.625,NEW,1,PSSTXT,0)
"RTN","PSSWMAP",41,0)
 G SPANISH
"RTN","PSSWMAP",42,0)
ASK K DIR W ! S DIR(0)="Y",DIR("B")="N",DIR("A")="Do you want to change the mapping" D ^DIR K DIR
"RTN","PSSWMAP",43,0)
 I 'Y G SPANISH
"RTN","PSSWMAP",44,0)
 S DIE="^PS(54,",DA=RXNUM,DR="2" D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",45,0)
 I X>0 S PSSTXT=0 F  S PSSTXT=$O(^PS(50.625,X,1,PSSTXT)) Q:'PSSTXT  W !,?3,^PS(50.625,X,1,PSSTXT,0)
"RTN","PSSWMAP",46,0)
SPANISH ;
"RTN","PSSWMAP",47,0)
 K DIR W ! S DIR(0)="Y",DIR("B")="N",DIR("A")="Do you want to enter/edit a Spanish translation for this entry" D ^DIR K DIR
"RTN","PSSWMAP",48,0)
 I 'Y W ! G EDIT1
"RTN","PSSWMAP",49,0)
 S DIE="^PS(54,",DA=RXNUM,DR=3 D ^DIE K DIE,DA,DR
"RTN","PSSWMAP",50,0)
 W ! G EDIT1
"RTN","PSSWMAP",51,0)
 Q
"RTN","PSSWMAP",52,0)
 ;
"RTN","PSSWMAP",53,0)
FULL ;
"RTN","PSSWMAP",54,0)
 I ($Y+3)>IOSL&('$G(PSSOUT)) D HDR
"RTN","PSSWMAP",55,0)
 Q
"RTN","PSSWMAP",56,0)
HDR ;
"RTN","PSSWMAP",57,0)
 K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1,QUIT=1 Q
"RTN","PSSWMAP",58,0)
 W @IOF
"RTN","PSSWMAP",59,0)
 W !!,"     CURRENT WARNING MAPPING",!!
"RTN","PSSWMAP",60,0)
 W "DRUG WARNING",?30,"Mapped to New data source number"
"RTN","PSSWMAP",61,0)
 Q
"RTN","PSSWRNA")
0^2^B14855355
"RTN","PSSWRNA",1,0)
PSSWRNA ;BIR/EJW-API TO RETRIEVE WARNING LABEL LIST ;04/09/04
"RTN","PSSWRNA",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**87**;9/30/97
"RTN","PSSWRNA",3,0)
 ;
"RTN","PSSWRNA",4,0)
 ;Reference to ^PSNDF(50.68 supported by DBIA 3735
"RTN","PSSWRNA",5,0)
 ;Reference to ^PS(50.625 supported by DBIA 4445
"RTN","PSSWRNA",6,0)
 ;Reference to ^PS(50.626 supported by DBIA 4446
"RTN","PSSWRNA",7,0)
 ;Reference to ^PS(50.627 supported by DBIA 4448
"RTN","PSSWRNA",8,0)
DRUG(XX,DFN) ; Return warning labels numbers associated with this drug
"RTN","PSSWRNA",9,0)
 ;
"RTN","PSSWRNA",10,0)
 ; entry point from Outpatient Pharmacy and Consolidated Mail Outpatient Pharmacy
"RTN","PSSWRNA",11,0)
 ; Calling method: S WARN=$$DRUG^PSSWRNA(DRUG,DFN)
"RTN","PSSWRNA",12,0)
 ;
"RTN","PSSWRNA",13,0)
 ; Input: DRUG = IEN from the DRUG file (50)  ** REQUIRED **
"RTN","PSSWRNA",14,0)
 ; Input: DFN = IEN from the PATIENT file (2)  ** OPTIONAL **
"RTN","PSSWRNA",15,0)
 ;
"RTN","PSSWRNA",16,0)
 ; Output: WARN = List of warning numbers, separated by commas, associated with this drug. Warning numbers from the new data source will be followed by an "N".
"RTN","PSSWRNA",17,0)
 ;
"RTN","PSSWRNA",18,0)
 N I,PSSWSITE
"RTN","PSSWRNA",19,0)
 S PSSWRN=""
"RTN","PSSWRNA",20,0)
 S PSSWSITE=+$O(^PS(59.7,0)) I $P($G(^PS(59.7,PSSWSITE,10)),"^",9)="N" D WARNLST
"RTN","PSSWRNA",21,0)
 I PSSWRN="" S PSSWRN=$P($G(^PSDRUG(XX,0)),"^",8)
"RTN","PSSWRNA",22,0)
 D CHECKLST
"RTN","PSSWRNA",23,0)
 D CHECK20
"RTN","PSSWRNA",24,0)
 Q PSSWRN
"RTN","PSSWRNA",25,0)
 ;
"RTN","PSSWRNA",26,0)
CHECK20 ; WARNING LABEL 20 - 'DO NOT TRANSFER' REQUIRED FOR CONTROLLED SUBSTANCES
"RTN","PSSWRNA",27,0)
 N I
"RTN","PSSWRNA",28,0)
 S DEA=$P($G(^PSDRUG(XX,0)),"^",3)
"RTN","PSSWRNA",29,0)
 I DEA="" Q
"RTN","PSSWRNA",30,0)
 I "12345"'[$E(DEA) Q
"RTN","PSSWRNA",31,0)
 I ","_$P(PSSWRN,",",1,5)_","[",20," Q
"RTN","PSSWRNA",32,0)
 I $L(PSSWRN,",")<5 S PSSWRN=$S(PSSWRN="":20,1:PSSWRN_",20") Q
"RTN","PSSWRNA",33,0)
 S PSSWRN=$P(PSSWRN,",",1,4)_",20,"_$P(PSSWRN,",",5,99)
"RTN","PSSWRNA",34,0)
 F I=6:1:$L(PSSWRN,",") I $P(PSSWRN,",",I)=20 S PSSWRN=$P(PSSWRN,",",1,I-1) I $P(PSSWRN,",",I+1,99)'="" S PSSWRN=PSSWRN_","_$P(PSSWRN,",",I+1,99)_$P(PSSWRN,",",I+1,99) Q
"RTN","PSSWRNA",35,0)
 Q
"RTN","PSSWRNA",36,0)
 ;
"RTN","PSSWRNA",37,0)
WARNLST ; GET WARNING LIST FROM NEW DATA SOURCE OR USER-DEFINED NEW WARNING LABEL LIST
"RTN","PSSWRNA",38,0)
 S PSSWRN=$P($G(^PSDRUG(XX,"WARN")),"^") I PSSWRN'="" Q
"RTN","PSSWRNA",39,0)
 ; GET WARNINGS FROM NEW COMMERCIAL SOURCE
"RTN","PSSWRNA",40,0)
 N PSOPROD,GCNSEQNO,SEQ,NEWWARN,I
"RTN","PSSWRNA",41,0)
 S PSOPROD=$P($G(^PSDRUG(XX,"ND")),"^",3) I PSOPROD="" Q
"RTN","PSSWRNA",42,0)
 S GCNSEQNO=$$GET1^DIQ(50.68,PSOPROD,11,"I")
"RTN","PSSWRNA",43,0)
 I GCNSEQNO="" Q
"RTN","PSSWRNA",44,0)
GCN S I="" F  S I=$O(^PS(50.627,"B",GCNSEQNO,I)) Q:'I  I I D
"RTN","PSSWRNA",45,0)
 .S NEWWARN=$G(^PS(50.627,I,0)) I $P(NEWWARN,"^")=GCNSEQNO S SEQ=+$P(NEWWARN,"^",3) I SEQ>0 S NEWWARN(SEQ)=+$P(NEWWARN,"^",2)
"RTN","PSSWRNA",46,0)
 S SEQ=0 F  S SEQ=$O(NEWWARN(SEQ)) Q:'SEQ  S PSSWRN=$S(PSSWRN'="":PSSWRN_",",1:"")_NEWWARN(SEQ)_"N"
"RTN","PSSWRNA",47,0)
 Q
"RTN","PSSWRNA",48,0)
WARN54 ; VERIFY ENTRY EXISTS. IF NOT, REMOVE FROM WARNING LIST
"RTN","PSSWRNA",49,0)
 I '$D(^PS(54,WARN,1)) S PSSWRN=$P(PSSWRN,",",1,I-1)_$S(I=1:"",1:",")_$P(PSSWRN,",",I+1,99),I=I-1
"RTN","PSSWRNA",50,0)
 Q
"RTN","PSSWRNA",51,0)
NEWWARN ;
"RTN","PSSWRNA",52,0)
 I '$D(^PS(50.625,WARN,1)) S PSSWRN=$P(PSSWRN,",",1,I-1)_$S(I=1:"",1:",")_$P(PSSWRN,",",I+1,99),I=I-1
"RTN","PSSWRNA",53,0)
 Q
"RTN","PSSWRNA",54,0)
CHECKLST ;
"RTN","PSSWRNA",55,0)
 N WARN
"RTN","PSSWRNA",56,0)
 F I=1:1:$L(PSSWRN,",") S WARN=$P(PSSWRN,",",I) I WARN'="" D
"RTN","PSSWRNA",57,0)
 .I WARN'["N" D WARN54 Q
"RTN","PSSWRNA",58,0)
 .S WARN=+WARN D GENDER I WARN'="" D NEWWARN
"RTN","PSSWRNA",59,0)
 I $E(PSSWRN,$L(PSSWRN))="," S PSSWRN=$E(PSSWRN,1,($L(PSSWRN)-1))
"RTN","PSSWRNA",60,0)
 Q
"RTN","PSSWRNA",61,0)
GENDER ;
"RTN","PSSWRNA",62,0)
 I $G(DFN)="" Q
"RTN","PSSWRNA",63,0)
 N SEX,GENDER
"RTN","PSSWRNA",64,0)
 S GENDER=$$GET1^DIQ(50.625,WARN,2,"I") I GENDER="" Q
"RTN","PSSWRNA",65,0)
 I GENDER'="F",GENDER'="M" Q
"RTN","PSSWRNA",66,0)
 S SEX=$$GET1^DIQ(2,DFN,.02,"I")
"RTN","PSSWRNA",67,0)
 I $G(SEX)="" Q
"RTN","PSSWRNA",68,0)
 I SEX'="F",SEX'="M" Q
"RTN","PSSWRNA",69,0)
 I SEX'=GENDER,$$GET1^DIQ(50,XX,8.2,"I")="N" D
"RTN","PSSWRNA",70,0)
 .S PSSWRN=$P(PSSWRN,",",1,I-1)_$S(I=1:"",1:",")_$P(PSSWRN,",",I+1,99),I=I-1
"RTN","PSSWRNA",71,0)
 Q
"RTN","PSSWRNA",72,0)
WTEXT(WARN,LAN) ;
"RTN","PSSWRNA",73,0)
 ;
"RTN","PSSWRNA",74,0)
 ; entry point from Outpatient Pharmacy and Consolidated Mail Outpatient Pharmacy
"RTN","PSSWRNA",75,0)
 ; Calling method: S TEXT=$$WTEXT^PSSWRNA(WARN,LAN)
"RTN","PSSWRNA",76,0)
 ;
"RTN","PSSWRNA",77,0)
 ; Input: WARN = A warning label number from the old RX Consult file (#54) or the new WARNING LABEL-ENGLISH file (#50.625) followed by an "N".  ** REQUIRED **
"RTN","PSSWRNA",78,0)
 ; Note: there is a one-to-one correspondence for entries in the WARNING LABEL-ENGLISH file (#50.625) and the WARNING LABEL-SPANISH file (#50.626).
"RTN","PSSWRNA",79,0)
 ;
"RTN","PSSWRNA",80,0)
 ; LAN = Patient's PMI language preference. 2=Spanish. Anything less than 2 is English  ** OPTIONAL **
"RTN","PSSWRNA",81,0)
 ;
"RTN","PSSWRNA",82,0)
 ; Output: TEXT = Warning label text for the warning number. If LAN=2 the text will be returned in Spanish if a translation is available, otherwise the text will be returned in English.
"RTN","PSSWRNA",83,0)
 ;
"RTN","PSSWRNA",84,0)
 S TEXT=""
"RTN","PSSWRNA",85,0)
 I WARN'["N" D
"RTN","PSSWRNA",86,0)
 . I $G(LAN)=2 D
"RTN","PSSWRNA",87,0)
 .. I $D(^PS(54,WARN,3)) S TEXT=^(3)
"RTN","PSSWRNA",88,0)
 . I TEXT="" S JJJ=0 F  S JJJ=$O(^PS(54,WARN,1,JJJ)) Q:('JJJ)  D
"RTN","PSSWRNA",89,0)
 .. I $D(^PS(54,WARN,1,JJJ,0)) S TEXT=TEXT_$S(TEXT="":"",1:" ")_^(0)
"RTN","PSSWRNA",90,0)
 I WARN["N" D
"RTN","PSSWRNA",91,0)
 .I $G(LAN)'=2 D  Q 
"RTN","PSSWRNA",92,0)
 .. S PSOWRNN=+WARN I $D(^PS(50.625,PSOWRNN)) D
"RTN","PSSWRNA",93,0)
 ... S TEXT="",JJJ=0
"RTN","PSSWRNA",94,0)
 ... F  S JJJ=$O(^PS(50.625,PSOWRNN,1,JJJ)) Q:('JJJ)  D
"RTN","PSSWRNA",95,0)
 .... I $D(^PS(50.625,PSOWRNN,1,JJJ,0)) S TEXT=TEXT_$S(TEXT="":"",1:" ")_^(0)
"RTN","PSSWRNA",96,0)
 . S PSOWRNN=+WARN I $D(^PS(50.626,PSOWRNN)) D
"RTN","PSSWRNA",97,0)
 .. S TEXT="",JJJ=0
"RTN","PSSWRNA",98,0)
 .. F  S JJJ=$O(^PS(50.626,PSOWRNN,1,JJJ)) Q:('JJJ)  D
"RTN","PSSWRNA",99,0)
 ... I $D(^PS(50.626,PSOWRNN,1,JJJ,0)) S TEXT=TEXT_$S(TEXT="":"",1:" ")_^(0)
"RTN","PSSWRNA",100,0)
 Q TEXT
"RTN","PSSWRNA",101,0)
 ;
"RTN","PSSWRNA",102,0)
GENDER2 ;
"RTN","PSSWRNA",103,0)
 N I,WARN
"RTN","PSSWRNA",104,0)
 S GENDER=""
"RTN","PSSWRNA",105,0)
 I $G(PSSWRN)'["N" Q
"RTN","PSSWRNA",106,0)
 F I=1:1 S WARN=$P(PSSWRN,",",I) Q:WARN=""  D  Q:GENDER'=""
"RTN","PSSWRNA",107,0)
 .I WARN'["N" Q
"RTN","PSSWRNA",108,0)
 .S WARN=+WARN,GENDER=$$GET1^DIQ(50.625,WARN,2,"I")
"RTN","PSSWRNA",109,0)
 Q
"RTN","PSSWRNA",110,0)
 ;
"RTN","PSSWRNB")
0^3^B87809916
"RTN","PSSWRNB",1,0)
PSSWRNB ;BIR/EJW-NEW WARNING SOURCE CUSTOM WARNING LIST BUILDER ;05/19/04
"RTN","PSSWRNB",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**87**;9/30/97
"RTN","PSSWRNB",3,0)
 ;
"RTN","PSSWRNB",4,0)
 ;IA: 3735 ^PSNDF(50.68
"RTN","PSSWRNB",5,0)
 ;IA: 4445 ^PS(50.625
"RTN","PSSWRNB",6,0)
 ;IA: 4446 ^PS(50.626
"RTN","PSSWRNB",7,0)
 ;IA: 4448 ^PS(50.627
"RTN","PSSWRNB",8,0)
 D NOTE^PSSWRNE
"RTN","PSSWRNB",9,0)
 D NOTE2^PSSWRNE
"RTN","PSSWRNB",10,0)
 W ! K DIR S DIR(0)="Y",DIR("B")="N",DIR("A")=" Would you like to print a list of the entries in these files" D ^DIR K DIR I Y["^"!($D(DTOUT)) W !!?3,"Nothing queued to print." G SEL
"RTN","PSSWRNB",11,0)
 I 'Y G SEL
"RTN","PSSWRNB",12,0)
 S SPANISH=0
"RTN","PSSWRNB",13,0)
 W ! K DIR S DIR(0)="Y",DIR("B")="N",DIR("A")=" Would you like to include the Spanish translations" D ^DIR K DIR I Y["^"!($D(DTOUT)) W !!?3,"Nothing queued to print." G SEL
"RTN","PSSWRNB",14,0)
 I Y S SPANISH=1
"RTN","PSSWRNB",15,0)
 D RPT
"RTN","PSSWRNB",16,0)
SEL ;
"RTN","PSSWRNB",17,0)
 W @IOF
"RTN","PSSWRNB",18,0)
 D NOTE^PSSWRNE
"RTN","PSSWRNB",19,0)
 W !!,?2,"Select one of the following to display drugs that match that criteria to"
"RTN","PSSWRNB",20,0)
 W !,?2,"examine or edit their drug warnings:"
"RTN","PSSWRNB",21,0)
 K DIR
"RTN","PSSWRNB",22,0)
 S DIR("B")=""
"RTN","PSSWRNB",23,0)
 S DIR("A")="Enter selection: "
"RTN","PSSWRNB",24,0)
 S DIR("A",1)="1. Drug has WARNING LABEL filled in but there are no FDB warnings for the drug"
"RTN","PSSWRNB",25,0)
 S DIR("A",2)="2. Drug has WARNING LABEL numbers higher than 20"
"RTN","PSSWRNB",26,0)
 S DIR("A",3)="3. Select by range of drug names"
"RTN","PSSWRNB",27,0)
 S DIR("A",4)="4. Drug has more than 5 warning labels"
"RTN","PSSWRNB",28,0)
 S DIR("A",5)="5. Drugs containing specific WARNING LABEL number"
"RTN","PSSWRNB",29,0)
 S DIR("A",6)="6. Drug has WARNING LABEL that does not map to new data source"
"RTN","PSSWRNB",30,0)
 S DIR("A",7)="7. Drugs containing specific new data source warning number"
"RTN","PSSWRNB",31,0)
 S DIR("A",8)="8. Drugs containing gender-specific warnings"
"RTN","PSSWRNB",32,0)
 S DIR("A",9)="9. Drugs with warning mapping, but drug doesn't contain ""mapped to"" number"
"RTN","PSSWRNB",33,0)
 S DIR(0)="SA^1:DRUGS WITH NO FDB WARNINGS;2:LOCAL WARNING (>20);3:RANGE OF DRUG NAMES;4:GREATER THAN 5 WARNINGS;5:SPECIFIC WARNING LABEL NUMBER;6:NO MAPPING;7:SPECIFIC NEW WARNING;8:GENDER-SPECIFIC WARNING;9:NO MAPPED TO"
"RTN","PSSWRNB",34,0)
 D ^DIR K DIR S SEL=Y
"RTN","PSSWRNB",35,0)
 I 'SEL G KILL
"RTN","PSSWRNB",36,0)
 N DR,ACTIVE,SKIP,QUIT,PSO9
"RTN","PSSWRNB",37,0)
 S SKIP=1,QUIT=0
"RTN","PSSWRNB",38,0)
 K ^TMP("PSSWRNB",$J)
"RTN","PSSWRNB",39,0)
ASK K DIR W ! S DIR(0)="Y",DIR("B")="Y",DIR("A")="Exclude drugs with NEW WARNING LABEL LIST filled in" D ^DIR K DIR
"RTN","PSSWRNB",40,0)
 I 'Y S SKIP=0
"RTN","PSSWRNB",41,0)
 W !!,$C(7),"NOTE: Only the first 5 warnings will print on the yellow auxillary labels."
"RTN","PSSWRNB",42,0)
  K DIR S DIR(0)="Y",DIR("B")="Y",DIR("A")="Do you want to see the warning text for all warnings" D ^DIR K DIR
"RTN","PSSWRNB",43,0)
 S ENDWARN=5
"RTN","PSSWRNB",44,0)
 I Y S ENDWARN=99 D
"RTN","PSSWRNB",45,0)
 .W !,"  Warnings (>5) that won't print and won't be sent to CMOP"
"RTN","PSSWRNB",46,0)
 .W !,"  will be marked with a ""*"" on the following screens."
"RTN","PSSWRNB",47,0)
 W ! K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1 Q
"RTN","PSSWRNB",48,0)
 I SEL=1 D
"RTN","PSSWRNB",49,0)
 .S DR=0 F  S DR=$O(^PSDRUG(DR)) Q:'DR  D
"RTN","PSSWRNB",50,0)
 ..I '$D(^PSDRUG(DR,0)) Q
"RTN","PSSWRNB",51,0)
 ..S WARN54=$P(^PSDRUG(DR,0),"^",8) I WARN54="" Q
"RTN","PSSWRNB",52,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",53,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",54,0)
 ..D DRUG I PSSWRN="" S ^TMP("PSSWRNB",$J,$P(^PSDRUG(DR,0),"^"))=WARN54_"^"_NDF
"RTN","PSSWRNB",55,0)
 ;
"RTN","PSSWRNB",56,0)
 I SEL=2 D
"RTN","PSSWRNB",57,0)
 .S DR=0 F  S DR=$O(^PSDRUG(DR)) Q:'DR  D
"RTN","PSSWRNB",58,0)
 ..I '$D(^PSDRUG(DR,0)) Q
"RTN","PSSWRNB",59,0)
 ..S WARN54=$P(^PSDRUG(DR,0),"^",8) I WARN54="" Q
"RTN","PSSWRNB",60,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",61,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",62,0)
 ..F I=1:1:$L(WARN54,",") S WARN=$P(WARN54,",",I) I WARN>20 D
"RTN","PSSWRNB",63,0)
 ...I '$D(^PS(54,WARN)) Q
"RTN","PSSWRNB",64,0)
 ...S ^TMP("PSSWRNB",$J,$P(^PSDRUG(DR,0),"^"))=WARN54
"RTN","PSSWRNB",65,0)
 ;
"RTN","PSSWRNB",66,0)
 I SEL=3 D
"RTN","PSSWRNB",67,0)
 .W ! K DIR S DIR(0)="FO^1:30",DIR("A")="Enter starting drug name" D ^DIR K DIR I Y["^"!(Y="") S QUIT=1 Q
"RTN","PSSWRNB",68,0)
 .S X=$$ENLU^PSSGMI(Y)
"RTN","PSSWRNB",69,0)
 .S DRUG=X
"RTN","PSSWRNB",70,0)
 .W ! K DIR S DIR(0)="FO^1:30",DIR("A")="Enter ending drug name" D ^DIR K DIR I Y["^"!(Y="") S QUIT=1 Q
"RTN","PSSWRNB",71,0)
 .S EDRUG=Y
"RTN","PSSWRNB",72,0)
 .W !!,"WARNINGS FOR DRUGS FROM "_DRUG_" TO "_EDRUG
"RTN","PSSWRNB",73,0)
 .W ! K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1,QUIT=1 Q
"RTN","PSSWRNB",74,0)
 .I $D(^PSDRUG("B",DRUG)) S I=$L(DRUG),DRUG=$E(DRUG,1,I-1)
"RTN","PSSWRNB",75,0)
 .F  S DRUG=$O(^PSDRUG("B",DRUG)) Q:DRUG=""  Q:DRUG]EDRUG  D
"RTN","PSSWRNB",76,0)
 ..S DR=$O(^PSDRUG("B",DRUG,0)) I DR="" Q
"RTN","PSSWRNB",77,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",78,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",79,0)
 ..S ^TMP("PSSWRNB",$J,DRUG)=""
"RTN","PSSWRNB",80,0)
 ;
"RTN","PSSWRNB",81,0)
 I SEL=4 D
"RTN","PSSWRNB",82,0)
 .S DR=0 F  S DR=$O(^PSDRUG(DR)) Q:'DR  D
"RTN","PSSWRNB",83,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",84,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",85,0)
 ..D DRUG I PSSWRN="" Q
"RTN","PSSWRNB",86,0)
 ..N XX S XX=DR D CHECK20^PSSWRNA
"RTN","PSSWRNB",87,0)
 ..I $L(PSSWRN,",")>5 S ^TMP("PSSWRNB",$J,$P(^PSDRUG(DR,0),"^"))=PSSWRN
"RTN","PSSWRNB",88,0)
 ;
"RTN","PSSWRNB",89,0)
 I SEL=5!(SEL=9) D
"RTN","PSSWRNB",90,0)
 .S DIC=54,DIC(0)="AEQM",DIC("A")="Select drugs containing RX Consult number:" D ^DIC K DIC I Y<0 Q
"RTN","PSSWRNB",91,0)
 .S RXNUM=$P(Y,"^")
"RTN","PSSWRNB",92,0)
 .I '$D(^PS(54,RXNUM)) W !,RXNUM_" is not in the RX Consult file.",! K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1 Q
"RTN","PSSWRNB",93,0)
 .I SEL=9,'$G(^PS(54,RXNUM,2)) W !,RXNUM," is not mapped to a new data source warning",! K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1 Q
"RTN","PSSWRNB",94,0)
 .I SEL=9 S PSO9=$G(^PS(54,RXNUM,2))_"N" W "  ",RXNUM," is mapped to ",PSO9 H 1
"RTN","PSSWRNB",95,0)
 .S DR=0 F  S DR=$O(^PSDRUG(DR)) Q:'DR  D
"RTN","PSSWRNB",96,0)
 ..I '$D(^PSDRUG(DR,0)) Q
"RTN","PSSWRNB",97,0)
 ..S WARN54=$P(^PSDRUG(DR,0),"^",8) I WARN54="" Q
"RTN","PSSWRNB",98,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",99,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",100,0)
 ..I ","_WARN54_","[(","_RXNUM_",") D
"RTN","PSSWRNB",101,0)
 ...I SEL=9 D DRUG I PSSWRN="" Q
"RTN","PSSWRNB",102,0)
 ...I SEL=9,","_PSSWRN_","[(","_PSO9_",") Q
"RTN","PSSWRNB",103,0)
 ...S ^TMP("PSSWRNB",$J,$P(^PSDRUG(DR,0),"^"))=WARN54
"RTN","PSSWRNB",104,0)
 ;
"RTN","PSSWRNB",105,0)
 I SEL=6 D
"RTN","PSSWRNB",106,0)
 .S DR=0 F  S DR=$O(^PSDRUG(DR)) Q:'DR  D
"RTN","PSSWRNB",107,0)
 ..I '$D(^PSDRUG(DR,0)) Q
"RTN","PSSWRNB",108,0)
 ..S WARN54=$P(^PSDRUG(DR,0),"^",8) I WARN54="" Q
"RTN","PSSWRNB",109,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",110,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",111,0)
 ..F I=1:1:$L(WARN54,",") S WARN=$P(WARN54,",",I) I WARN,$D(^PS(54,WARN,1)),$G(^PS(54,WARN,2))="" D
"RTN","PSSWRNB",112,0)
 ...S ^TMP("PSSWRNB",$J,$P(^PSDRUG(DR,0),"^"))=WARN54
"RTN","PSSWRNB",113,0)
 I SEL=7 D
"RTN","PSSWRNB",114,0)
 .W !!,"Select drugs containing New warning number:" R RXNUM:$S($D(DTIME):DTIME,1:300) I '$T Q
"RTN","PSSWRNB",115,0)
 .I RXNUM["N" S RXNUM=$P(RXNUM,"N")
"RTN","PSSWRNB",116,0)
 .I '$D(^PS(50.625,RXNUM)) W !,$C(7),RXNUM_" is not in the New warning file" H 1 S QUIT=1 Q
"RTN","PSSWRNB",117,0)
 .W @IOF
"RTN","PSSWRNB",118,0)
 .W "Searching for drugs that contain new warning number "_RXNUM
"RTN","PSSWRNB",119,0)
 .S PSOWARN=RXNUM_"N",STAR="" D NEWWARN^PSSWRNE
"RTN","PSSWRNB",120,0)
 .K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1 Q
"RTN","PSSWRNB",121,0)
 .S DR=0 F  S DR=$O(^PSDRUG(DR)) Q:'DR  D
"RTN","PSSWRNB",122,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",123,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",124,0)
 ..D DRUG I PSSWRN="" Q
"RTN","PSSWRNB",125,0)
 ..I ","_PSSWRN_","[(","_RXNUM_"N,") S ^TMP("PSSWRNB",$J,$P(^PSDRUG(DR,0),"^"))=PSSWRN
"RTN","PSSWRNB",126,0)
 I SEL=8 D
"RTN","PSSWRNB",127,0)
 .N WARN,GEND
"RTN","PSSWRNB",128,0)
 .S WARN=0 F  S WARN=$O(^PS(50.625,WARN)) Q:'WARN  I $G(^PS(50.625,WARN,2))'="" S GEND(WARN_"N")=""
"RTN","PSSWRNB",129,0)
 .I $O(GEND(""))="" Q
"RTN","PSSWRNB",130,0)
 .S DR=0 F  S DR=$O(^PSDRUG(DR)) Q:'DR  D
"RTN","PSSWRNB",131,0)
 ..I SKIP,$P($G(^PSDRUG(DR,"WARN")),"^")'="" Q
"RTN","PSSWRNB",132,0)
 ..D ACTIVE I 'ACTIVE Q
"RTN","PSSWRNB",133,0)
 ..D DRUG I PSSWRN="" Q
"RTN","PSSWRNB",134,0)
 ..S WARN=0 F  S WARN=$O(GEND(WARN)) Q:'WARN  I ","_PSSWRN_","[(","_WARN_",") D
"RTN","PSSWRNB",135,0)
 ...S ^TMP("PSSWRNB",$J,$P(^PSDRUG(DR,0),"^"))=PSSWRN
"RTN","PSSWRNB",136,0)
 I 'QUIT I '$D(^TMP("PSSWRNB",$J)) W !,"Nothing meets selection criteria" H 2 S QUIT=1
"RTN","PSSWRNB",137,0)
 I 'QUIT D EDIT^PSSWRNE
"RTN","PSSWRNB",138,0)
 G SEL
"RTN","PSSWRNB",139,0)
RPT ;
"RTN","PSSWRNB",140,0)
RPTQ W !!,"You may queue the report to print, if you wish.",!
"RTN","PSSWRNB",141,0)
 ;
"RTN","PSSWRNB",142,0)
DVC K %ZIS,POP,IOP S %ZIS="QM" D ^%ZIS I $G(POP) W !,"Nothing queued to print.",! G DONE
"RTN","PSSWRNB",143,0)
 S ZTSAVE("*")=""
"RTN","PSSWRNB",144,0)
 I $D(IO("Q")) S ZTRTN="PRT54^PSSWRNB",ZTDESC="WARNING LABEL TEXT REPORTS" D ^%ZTLOAD K %ZIS W !,"Report queued to print.",! G DONE
"RTN","PSSWRNB",145,0)
PRT54 ;
"RTN","PSSWRNB",146,0)
 U IO
"RTN","PSSWRNB",147,0)
 S PSSOUT=0,PSSDV=$S($E(IOST,1,2)="C-":"C",1:"P")
"RTN","PSSWRNB",148,0)
 S PSSPGCT=0,PSSPGLN=IOSL-7,PSSPGCT=1
"RTN","PSSWRNB",149,0)
 S TITLE="RX CONSULT file - WARNING LABEL TEXT"
"RTN","PSSWRNB",150,0)
 D TITLE
"RTN","PSSWRNB",151,0)
 ;
"RTN","PSSWRNB",152,0)
 S SEQ=0 F  S SEQ=$O(^PS(54,SEQ)) Q:'SEQ  D PRTRPT
"RTN","PSSWRNB",153,0)
 G END
"RTN","PSSWRNB",154,0)
PRTRPT ;
"RTN","PSSWRNB",155,0)
 I $G(^PS(54,SEQ,0))'="" D RXCON D FULL I $G(PSSOUT) Q
"RTN","PSSWRNB",156,0)
 D FULL I $G(PSSOUT) Q
"RTN","PSSWRNB",157,0)
 W ! F MJT=1:1:70 W "-"
"RTN","PSSWRNB",158,0)
 Q
"RTN","PSSWRNB",159,0)
RXCON D FULL Q:$G(PSSOUT)  W !,"RX CONSULT NUMBER:  ",SEQ
"RTN","PSSWRNB",160,0)
 N PSSTXT
"RTN","PSSWRNB",161,0)
 D FULL I $G(PSSOUT) Q
"RTN","PSSWRNB",162,0)
 W !
"RTN","PSSWRNB",163,0)
 S PSSTXT=0 F  S PSSTXT=$O(^PS(54,SEQ,1,PSSTXT)) Q:'PSSTXT  D FULL Q:$G(PSSOUT)  W !,?3,^PS(54,SEQ,1,PSSTXT,0)
"RTN","PSSWRNB",164,0)
 I $G(SPANISH),$D(^PS(54,SEQ,3)) W !!,"Spanish translation:" D
"RTN","PSSWRNB",165,0)
 .S PSSTXT=^PS(54,SEQ,3) Q:PSSTXT=""  D FULL Q:$G(PSSOUT)  W !,?3 D
"RTN","PSSWRNB",166,0)
 ..N LEN,I,STR
"RTN","PSSWRNB",167,0)
 ..S LEN=0
"RTN","PSSWRNB",168,0)
 ..F I=1:1:$L(PSSTXT," ") S STR=$P(PSSTXT," ",I),LEN=LEN+$L(STR) W:LEN>62 !,?3 S:LEN>62 LEN=0 W STR," "
"RTN","PSSWRNB",169,0)
 Q
"RTN","PSSWRNB",170,0)
 ;
"RTN","PSSWRNB",171,0)
FULL ;
"RTN","PSSWRNB",172,0)
 I ($Y+5)>IOSL&('$G(PSSOUT)) D TITLE
"RTN","PSSWRNB",173,0)
 Q
"RTN","PSSWRNB",174,0)
 ;
"RTN","PSSWRNB",175,0)
TITLE ;
"RTN","PSSWRNB",176,0)
 I $E($G(PSSDV))="C",$G(PSSPGCT)'=1 W ! K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1 Q
"RTN","PSSWRNB",177,0)
 ;
"RTN","PSSWRNB",178,0)
 W @IOF
"RTN","PSSWRNB",179,0)
 W !,?16,TITLE,!
"RTN","PSSWRNB",180,0)
 S Y=DT X ^DD("DD") W !,"Date printed: ",Y,?70,"Page: ",PSSPGCT,!
"RTN","PSSWRNB",181,0)
 F MJT=1:1:79 W "="
"RTN","PSSWRNB",182,0)
 W !
"RTN","PSSWRNB",183,0)
 S PSSPGCT=PSSPGCT+1
"RTN","PSSWRNB",184,0)
 Q
"RTN","PSSWRNB",185,0)
END ;
"RTN","PSSWRNB",186,0)
 I '$G(PSSOUT),$E($G(PSSDV))="C" W !!,"End of Rx Consult file Report." K DIR S DIR(0)="E",DIR("A")="Press Return to continue" D ^DIR K DIR
"RTN","PSSWRNB",187,0)
 I $E($G(PSSDV))="C" W !
"RTN","PSSWRNB",188,0)
 E  W @IOF
"RTN","PSSWRNB",189,0)
 G PRTNEW
"RTN","PSSWRNB",190,0)
END2 ;
"RTN","PSSWRNB",191,0)
 I '$G(PSSOUT),$E($G(PSSDV))="C" W !!,"End of Report." K DIR S DIR(0)="E",DIR("A")="Press Return to continue" D ^DIR K DIR
"RTN","PSSWRNB",192,0)
 I $E($G(PSSDV))="C" W !
"RTN","PSSWRNB",193,0)
 E  W @IOF
"RTN","PSSWRNB",194,0)
DONE ;
"RTN","PSSWRNB",195,0)
 K SEQ,MJT,PSSPGCT,PSSPGLN,Y,DIR,INDT,PSSXX,X,OITM,IOP,POP,IO("Q"),DIRUT,DUOUT,DTOUT
"RTN","PSSWRNB",196,0)
 K PSSDV,PSSOUT D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","PSSWRNB",197,0)
 Q
"RTN","PSSWRNB",198,0)
 ;
"RTN","PSSWRNB",199,0)
PRTNEW ;
"RTN","PSSWRNB",200,0)
 U IO
"RTN","PSSWRNB",201,0)
 S PSSOUT=0,PSSDV=$S($E(IOST)="C":"C",1:"P")
"RTN","PSSWRNB",202,0)
 S PSSPGCT=0,PSSPGLN=IOSL-7,PSSPGCT=1
"RTN","PSSWRNB",203,0)
 S TITLE="WARNING LABEL-ENGLISH file - WARNING LABEL TEXT"
"RTN","PSSWRNB",204,0)
 D TITLE
"RTN","PSSWRNB",205,0)
 ; REPORT FROM NEW WARNING LABEL SOURCE
"RTN","PSSWRNB",206,0)
 S SEQ=0 F  S SEQ=$O(^PS(50.625,SEQ)) Q:'SEQ  D RPTNEW
"RTN","PSSWRNB",207,0)
 G END2
"RTN","PSSWRNB",208,0)
RPTNEW ;
"RTN","PSSWRNB",209,0)
 I $G(^PS(50.625,SEQ,0))'="" D FDBWARN D FULL I $G(PSSOUT) Q
"RTN","PSSWRNB",210,0)
 D FULL I $G(PSSOUT) Q
"RTN","PSSWRNB",211,0)
 W ! F MJT=1:1:70 W "-"
"RTN","PSSWRNB",212,0)
 Q
"RTN","PSSWRNB",213,0)
FDBWARN D FULL Q:$G(PSSOUT)  W !,"WARNING LABEL-ENGLISH NUMBER:  ",+SEQ
"RTN","PSSWRNB",214,0)
 N PSSTXT
"RTN","PSSWRNB",215,0)
 D FULL I $G(PSSOUT) Q
"RTN","PSSWRNB",216,0)
 W !
"RTN","PSSWRNB",217,0)
 S PSSTXT=0 F  S PSSTXT=$O(^PS(50.625,SEQ,1,PSSTXT)) Q:'PSSTXT  D FULL Q:$G(PSSOUT)  W !,?3,^PS(50.625,SEQ,1,PSSTXT,0)
"RTN","PSSWRNB",218,0)
 I $G(SPANISH) W !!,"Spanish translation:" D
"RTN","PSSWRNB",219,0)
 .S PSSTXT=0 F  S PSSTXT=$O(^PS(50.626,SEQ,1,PSSTXT)) Q:'PSSTXT  D FULL Q:$G(PSSOUT)  W !,?3,^PS(50.626,SEQ,1,PSSTXT,0)
"RTN","PSSWRNB",220,0)
 Q
"RTN","PSSWRNB",221,0)
 ;
"RTN","PSSWRNB",222,0)
KILL ;
"RTN","PSSWRNB",223,0)
 K ^TMP("PSSWRNB",$J),NDF,PSSWRN,SEL,SPANISH,WARN54,RXNUM,WARN,WARN20,STR,PSOWARN,JJJ,TEXT,WWW,DRUGN,DRUG,DEA,TITLE
"RTN","PSSWRNB",224,0)
 Q
"RTN","PSSWRNB",225,0)
DRUG ;
"RTN","PSSWRNB",226,0)
 S NDF=0
"RTN","PSSWRNB",227,0)
 N PSOPROD,GCNSEQNO,I,NEWWARN
"RTN","PSSWRNB",228,0)
 S PSSWRN=""
"RTN","PSSWRNB",229,0)
 S PSOPROD=$P($G(^PSDRUG(DR,"ND")),"^",3) I PSOPROD="" Q
"RTN","PSSWRNB",230,0)
 S NDF=1
"RTN","PSSWRNB",231,0)
 S GCNSEQNO=$$GET1^DIQ(50.68,PSOPROD,11,"I")
"RTN","PSSWRNB",232,0)
 I GCNSEQNO="" Q
"RTN","PSSWRNB",233,0)
 D GCN^PSSWRNA
"RTN","PSSWRNB",234,0)
 Q
"RTN","PSSWRNB",235,0)
WARN ; ENTRY POINT DRUG ENTER/EDIT OPTION
"RTN","PSSWRNB",236,0)
 S DRUGENT=1
"RTN","PSSWRNB",237,0)
 S DRUG=$P($G(^PSDRUG(DA,0)),"^") I DRUG="" Q
"RTN","PSSWRNB",238,0)
 S ^TMP("PSSWRNB",$J,DRUG)=""
"RTN","PSSWRNB",239,0)
 D EDIT^PSSWRNE
"RTN","PSSWRNB",240,0)
 Q
"RTN","PSSWRNB",241,0)
ACTIVE ;
"RTN","PSSWRNB",242,0)
 S ACTIVE=1
"RTN","PSSWRNB",243,0)
 I $P($G(^PSDRUG(DR,"I")),"^"),$P($G(^("I")),"^")<DT S ACTIVE=0 Q
"RTN","PSSWRNB",244,0)
 Q
"RTN","PSSWRNE")
0^4^B30090017
"RTN","PSSWRNE",1,0)
PSSWRNE ;BIR/EJW-NEW WARNING SOURCE NEW WARNING LABEL LIST EDITOR ;05/24/04
"RTN","PSSWRNE",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**87**;9/30/97
"RTN","PSSWRNE",3,0)
 ;
"RTN","PSSWRNE",4,0)
 ;Reference to ^PS(50.625 supported by DBIA 4445
"RTN","PSSWRNE",5,0)
EDIT ;
"RTN","PSSWRNE",6,0)
 N STAR,QUIT,PSSOUT
"RTN","PSSWRNE",7,0)
 S QUIT=0,STAR="",PSSOUT=0
"RTN","PSSWRNE",8,0)
 S DRUG="" F  S DRUG=$O(^TMP("PSSWRNB",$J,DRUG)) Q:DRUG=""  D  I QUIT Q
"RTN","PSSWRNE",9,0)
 .S DRUGN=$O(^PSDRUG("B",DRUG,0)) Q:'DRUGN  D DEA,PRINT
"RTN","PSSWRNE",10,0)
 Q
"RTN","PSSWRNE",11,0)
 ;
"RTN","PSSWRNE",12,0)
PRINT ;
"RTN","PSSWRNE",13,0)
 N NEWLIST,STAR
"RTN","PSSWRNE",14,0)
 I '$G(PSSLOOK) D
"RTN","PSSWRNE",15,0)
 .W @IOF
"RTN","PSSWRNE",16,0)
 .W "Current Warning labels for ",DRUG
"RTN","PSSWRNE",17,0)
 .I $G(NEWLIST)="",PSSWRN'["N" W !,"No warnings from the new data source exist for this drug." D
"RTN","PSSWRNE",18,0)
 ..W !,"Verify that the drug is matched to the National Drug File."
"RTN","PSSWRNE",19,0)
 I PSSWRN'="" D
"RTN","PSSWRNE",20,0)
 .I '$G(PSSLOOK) W !,"Labels will print in the order in which they appear for local and CMOP fills:"
"RTN","PSSWRNE",21,0)
 .I '$G(ENDWARN) S ENDWARN=5
"RTN","PSSWRNE",22,0)
 .S STAR=""
"RTN","PSSWRNE",23,0)
 .F WWW=1:1:ENDWARN S PSOWARN=$P(PSSWRN,",",WWW) Q:PSOWARN=""  D
"RTN","PSSWRNE",24,0)
 ..I WWW>5 S STAR="*"
"RTN","PSSWRNE",25,0)
 ..I PSOWARN["N" D NEWWARN Q
"RTN","PSSWRNE",26,0)
 ..D WARN54
"RTN","PSSWRNE",27,0)
 .D FULL Q:$G(PSSOUT)  W !!,"Pharmacy fill card display: DRUG WARNING ",PSSWRN
"RTN","PSSWRNE",28,0)
 .I $G(PSSLOOK) Q
"RTN","PSSWRNE",29,0)
 .I $G(SEL)=6 D
"RTN","PSSWRNE",30,0)
 ..S WARN54=$G(^TMP("PSSWRNB",$J,DRUG))
"RTN","PSSWRNE",31,0)
 ..D FULL W !,"  RX CONSULT file Drug Warning="_WARN54
"RTN","PSSWRNE",32,0)
 ..N I,WARN F I=1:1:$L(WARN54,",") S WARN=$P(WARN54,",",I) I WARN'="",$G(^PS(54,WARN,2))="" D FULL W !,"  ",WARN_" "_$G(^PS(54,WARN,0))_" is not mapped to the new data source"
"RTN","PSSWRNE",33,0)
 .I $G(SEL)=8 D
"RTN","PSSWRNE",34,0)
 ..W !
"RTN","PSSWRNE",35,0)
 ..S DIE="^PSDRUG(",DA=DRUGN,DR=8.2 D ^DIE K DIE,DA,DR
"RTN","PSSWRNE",36,0)
 .S NEWLIST=$P($G(^PSDRUG(DRUGN,"WARN")),"^") I NEWLIST="" D
"RTN","PSSWRNE",37,0)
 ..I PSSWRN'["N" Q
"RTN","PSSWRNE",38,0)
 ..D FULL Q:$G(PSSOUT)  W !,"NOTE: Because the NEW WARNING LABEL LIST field is empty, the warnings above"
"RTN","PSSWRNE",39,0)
 ..D FULL Q:$G(PSSOUT)  W !,"are the warnings that our national data source distributes for this drug."
"RTN","PSSWRNE",40,0)
 I $G(PSSLOOK) Q
"RTN","PSSWRNE",41,0)
 I $G(NEWLIST)'="" D FULL Q:$G(PSSOUT)  W !,"NEW WARNING LABEL LIST: ",NEWLIST
"RTN","PSSWRNE",42,0)
 D FULL Q:$G(PSSOUT)  W ! K DIR S DIR(0)="Y",DIR("B")="N",DIR("A")="Would you like to edit this list of warnings" D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S QUIT=1
"RTN","PSSWRNE",43,0)
 I 'Y D  Q
"RTN","PSSWRNE",44,0)
 .I $G(DRUGENT) S WARNEDIT=0 K ^TMP("PSSWRNB",$J)
"RTN","PSSWRNE",45,0)
 I $G(DRUGENT) S WARNEDIT=1 K ^TMP("PSSWRNB",$J) Q
"RTN","PSSWRNE",46,0)
 S OLDWARN=PSSWRN
"RTN","PSSWRNE",47,0)
 S DIE="^PSDRUG(",DA=DRUGN,DR=8.1 D ^DIE K DIE,DA,DR
"RTN","PSSWRNE",48,0)
 S PSSWRN=$P($G(^PSDRUG(DRUGN,"WARN")),"^") I PSSWRN'="" D CHECK20^PSSWRNA G PRINT
"RTN","PSSWRNE",49,0)
 I $G(OLDWARN)'="",PSSWRN="" D DEA G PRINT
"RTN","PSSWRNE",50,0)
 Q
"RTN","PSSWRNE",51,0)
FULL ;
"RTN","PSSWRNE",52,0)
 I ($Y+3)>IOSL&('$G(PSSOUT)) D HDR
"RTN","PSSWRNE",53,0)
 Q
"RTN","PSSWRNE",54,0)
NEWWARN ;
"RTN","PSSWRNE",55,0)
 N PSOWRNN,JJJ,STR
"RTN","PSSWRNE",56,0)
 S TEXT=""
"RTN","PSSWRNE",57,0)
 S PSOWRNN=+PSOWARN I $D(^PS(50.625,PSOWRNN)) D
"RTN","PSSWRNE",58,0)
 .I '$G(PSSLOOK) W !
"RTN","PSSWRNE",59,0)
 .S TEXT=STAR_PSOWARN_" "
"RTN","PSSWRNE",60,0)
 .S JJJ=0 F  S JJJ=$O(^PS(50.625,PSOWRNN,1,JJJ)) Q:'JJJ  S STR=$G(^PS(50.625,PSOWRNN,1,JJJ,0)) S TEXT=TEXT_" "_STR
"RTN","PSSWRNE",61,0)
 I TEXT'="" D FORMAT I $G(PSSLOOK) D FULL^PSSLOOK
"RTN","PSSWRNE",62,0)
 Q
"RTN","PSSWRNE",63,0)
WARN54 ;
"RTN","PSSWRNE",64,0)
 S TEXT=""
"RTN","PSSWRNE",65,0)
 I $D(^PS(54,PSOWARN,1)) D
"RTN","PSSWRNE",66,0)
 .I '$G(PSSLOOK) W !
"RTN","PSSWRNE",67,0)
 .S TEXT=STAR_PSOWARN_" "
"RTN","PSSWRNE",68,0)
 .S JJJ=0 F  S JJJ=$O(^PS(54,PSOWARN,1,JJJ)) Q:'JJJ  S TEXT=TEXT_" "_$G(^PS(54,PSOWARN,1,JJJ,0))
"RTN","PSSWRNE",69,0)
 I TEXT'="" D FORMAT I $G(PSSLOOK) D FULL^PSSLOOK
"RTN","PSSWRNE",70,0)
 Q
"RTN","PSSWRNE",71,0)
VALID ; VALIDATE NEW WARNING LABEL LIST
"RTN","PSSWRNE",72,0)
 N BAD
"RTN","PSSWRNE",73,0)
 S BAD=0
"RTN","PSSWRNE",74,0)
 I $G(X)="" W !,"TOO MANY WARNINGS. LIMIT ANSWER STRING TO 30 CHARACTERS OR LESS" K Y Q
"RTN","PSSWRNE",75,0)
 F I=1:1:$L(X,",") S PSOWARN=$P(X,",",I) I PSOWARN'="" D
"RTN","PSSWRNE",76,0)
 .I PSOWARN["N" S PSOWRNN=+PSOWARN D  Q
"RTN","PSSWRNE",77,0)
 ..I '$D(^PS(50.625,PSOWRNN)) W !,PSOWARN," does not exist in the WARNING LABEL-ENGLISH file" S BAD=1
"RTN","PSSWRNE",78,0)
 .I '$D(^PS(54,PSOWARN)) W !,PSOWARN," does not exist in the RX CONSULT file" S BAD=1
"RTN","PSSWRNE",79,0)
 I BAD K X
"RTN","PSSWRNE",80,0)
 Q
"RTN","PSSWRNE",81,0)
FORMAT ;
"RTN","PSSWRNE",82,0)
 N I,LEN,PTEXT
"RTN","PSSWRNE",83,0)
 S LEN=0,PTEXT=""
"RTN","PSSWRNE",84,0)
 F I=1:1:$L(TEXT," ") S STR=$P(TEXT," ",I)_" " D
"RTN","PSSWRNE",85,0)
 .I LEN+$L(STR)<80 S PTEXT=PTEXT_STR,LEN=LEN+$L(STR) Q
"RTN","PSSWRNE",86,0)
 .S LEN=0,I=I-1 D FULL Q:$G(PSSOUT)  W !,PTEXT S PTEXT=""
"RTN","PSSWRNE",87,0)
 I PTEXT'="" D FULL Q:$G(PSSOUT)  W !,PTEXT S PTEXT=""
"RTN","PSSWRNE",88,0)
 Q
"RTN","PSSWRNE",89,0)
 ;
"RTN","PSSWRNE",90,0)
NOTE ;
"RTN","PSSWRNE",91,0)
 N PSSWSITE
"RTN","PSSWRNE",92,0)
 S PSSWSITE=+$O(^PS(59.7,0)) I $P($G(^PS(59.7,PSSWSITE,10)),"^",9)'="N" D
"RTN","PSSWRNE",93,0)
 .W !,?2,"NOTE: You must edit the WARNING LABEL SOURCE field using the option"
"RTN","PSSWRNE",94,0)
 .W !,?2,"Pharmacy System Parameters Edit to enable national warning labels."
"RTN","PSSWRNE",95,0)
 Q
"RTN","PSSWRNE",96,0)
 ;
"RTN","PSSWRNE",97,0)
DEA ;
"RTN","PSSWRNE",98,0)
 S DEA=$P($G(^PSDRUG(DRUGN,0)),"^",3)
"RTN","PSSWRNE",99,0)
 S XX=DRUGN D WARNLST^PSSWRNA S:PSSWRN="" PSSWRN=$P($G(^PSDRUG(DRUGN,0)),"^",8)
"RTN","PSSWRNE",100,0)
 D CHECK20^PSSWRNA,CHECKLST^PSSWRNA
"RTN","PSSWRNE",101,0)
 Q
"RTN","PSSWRNE",102,0)
 ;
"RTN","PSSWRNE",103,0)
HDR ;
"RTN","PSSWRNE",104,0)
 K DIR S DIR(0)="E" D ^DIR K DIR I 'Y S PSSOUT=1,QUIT=1 Q
"RTN","PSSWRNE",105,0)
 W @IOF
"RTN","PSSWRNE",106,0)
 W "Current Warning labels for ",DRUG,"  (continued)"
"RTN","PSSWRNE",107,0)
 Q
"RTN","PSSWRNE",108,0)
 ;
"RTN","PSSWRNE",109,0)
NOTE2 W !!,?5,"The RX CONSULT File (#54) contains local label expansions."
"RTN","PSSWRNE",110,0)
 W !,?5,"The WARNING LABEL-ENGLISH file (#50.625) contains national label"
"RTN","PSSWRNE",111,0)
 W !,?5,"expansions in English."
"RTN","PSSWRNE",112,0)
 W !,?5,"The WARNING LABEL-SPANISH file (#50.626) contains national label"
"RTN","PSSWRNE",113,0)
 W !,?5,"expansions in Spanish."
"RTN","PSSWRNE",114,0)
 W !,?5,"It is important to note that RX Consult entry numbers do not"
"RTN","PSSWRNE",115,0)
 W !,?5,"correlate with the other files (i.e. Number 7 in file 54 is not"
"RTN","PSSWRNE",116,0)
 W !,?5,"included in file 50.625)."
"RTN","PSSWRNE",117,0)
 W !!,?5,"You should print a list of the current RX CONSULT file entries"
"RTN","PSSWRNE",118,0)
 W !,?5,"and the current WARNING LABEL-ENGLISH file entries."
"RTN","PSSWRNE",119,0)
 W !
"RTN","PSSWRNE",120,0)
 Q
"RTN","PSSYSP")
0^5^B100178
"RTN","PSSYSP",1,0)
PSSYSP ;BIR/WRT-Pharmacy system site parameters routine ;09/02/97
"RTN","PSSYSP",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**20,38,87**;9/30/97
"RTN","PSSYSP",3,0)
 ; IV IDENTIFIER
"RTN","PSSYSP",4,0)
 ;D ENIVID^PSSHL1
"RTN","PSSYSP",5,0)
 ; CHANGE TYPE OF ORDER (FINISH) FROM OERR
"RTN","PSSYSP",6,0)
 W ! S DIE="^PS(59.7,",DR="13;14;16",DA=1 D ^DIE
"RTN","PSSYSP",7,0)
 K DIE,DA,DR W !
"RTN","PSSYSP",8,0)
 Q
"VER")
8.0^22.0
"^DD",50,50,8.1,0)
NEW WARNING LABEL LIST^FX^^WARN;1^K:$L(X)>30!($L(X)<1) X D VALID^PSSWRNE
"^DD",50,50,8.1,3)
Enter comma-delimited list of warnings from old and new files, following new file entries with an "N".
"^DD",50,50,8.1,21,0)
^^2^2^3040409^
"^DD",50,50,8.1,21,1,0)
Enter a comma-delimited list of warning numbers from old and new warning 
"^DD",50,50,8.1,21,2,0)
files, following new file entries with an "N".
"^DD",50,50,8.1,23,0)
^^8^8^3040409^
"^DD",50,50,8.1,23,1,0)
If it is desired to use some warning labels from both the old RX CONSULT 
"^DD",50,50,8.1,23,2,0)
file (#54) and the new WARNING LABEL-ENGLISH (#50.625) or WARNING 
"^DD",50,50,8.1,23,3,0)
LABEL-SPANISH (#50.626) file, a comma delimited list with entries from 
"^DD",50,50,8.1,23,4,0)
both files can be entered. Entries from the new warning label file must 
"^DD",50,50,8.1,23,5,0)
be followed with an "N".  e.g. 22,5N,128N will print local warning number 
"^DD",50,50,8.1,23,6,0)
22 from the RX CONSULT file (#54) followed by warnings 5 and 128 from the 
"^DD",50,50,8.1,23,7,0)
new warning file (English or Spanish) when the PHARMACY SYSTEM file 
"^DD",50,50,8.1,23,8,0)
(#59.7) WARNING LABEL SOURCE field (#16) is set to "N" for new.
"^DD",50,50,8.1,"DT")
3040524
"^DD",50,50,8.2,0)
GENDER SPECIFIC LBLS ON ALL RX^S^Y:YES;N:NO;^WARN;2^Q
"^DD",50,50,8.2,3)
If a new warning is specific to one gender, set this field to "N" to print the warning only for patients of that gender.
"^DD",50,50,8.2,21,0)
^^4^4^3041118^
"^DD",50,50,8.2,21,1,0)
If this field contains "N", warning labels that are marked with a SPECIFIC
"^DD",50,50,8.2,21,2,0)
TO GENDER value of "M" for Male or "F" for Female will only print for this
"^DD",50,50,8.2,21,3,0)
drug when the patient is that specific gender. If this field is null or 
"^DD",50,50,8.2,21,4,0)
contains a "Y", then the warning will print for both genders.
"^DD",50,50,8.2,23,0)
^^5^5^3041118^
"^DD",50,50,8.2,23,1,0)
If this field is answered "N", the SPECIFIC TO GENDER FIELD (#2) of the
"^DD",50,50,8.2,23,2,0)
WARNING LABEL-ENGLISH file (#50.625) or the WARNING LABEL-SPANISH file
"^DD",50,50,8.2,23,3,0)
(#50.626) will be examined and this warning will not print if the gender
"^DD",50,50,8.2,23,4,0)
is not the same as what the warning is specific for. If this field
"^DD",50,50,8.2,23,5,0)
contains a "Y" or is null, then the warning will print for both genders.
"^DD",50,50,8.2,"DT")
3041118
"^DD",54,54,2,0)
WARNING MAPPING^NJ6,0^^2;1^K:+X'=X!(X>999999)!(X<0)!(X?.E1"."1.N) X
"^DD",54,54,2,3)
Type a number between 0 and 999999, 0 Decimal Digits
"^DD",54,54,2,21,0)
^^2^2^3040512^^
"^DD",54,54,2,21,1,0)
This field contains the warning number from the new data source which 
"^DD",54,54,2,21,2,0)
corresponds with this warning information.
"^DD",54,54,2,23,0)
^^6^6^3040512^
"^DD",54,54,2,23,1,0)
This field contains the warning label number from the new WARNING 
"^DD",54,54,2,23,2,0)
LABEL-ENGLISH file (#50.625) or WARNING LABEL-SPANISH file (#50.626) which
"^DD",54,54,2,23,3,0)
corresponds to the current RX CONSULT file (#54) entry.  Zero in this
"^DD",54,54,2,23,4,0)
field indicates the site does not wish to map this RX CONSULT file (#54)
"^DD",54,54,2,23,5,0)
entry to a new warning label. A null value in this field indicates there
"^DD",54,54,2,23,6,0)
is no corresponding warning with the new warning labels. 
"^DD",54,54,2,"DT")
3040527
"^DD",54,54,3,0)
SPANISH TRANSLATION^F^^3;1^K:$L(X)>250!($L(X)<1) X
"^DD",54,54,3,3)
Answer must be 1-250 characters in length
"^DD",54,54,3,21,0)
^^3^3^3040522^
"^DD",54,54,3,21,1,0)
This field contains the Spanish translation for the old RX CONSULT file
"^DD",54,54,3,21,2,0)
warning label. When possible, warnings from the new WARNING LABEL-SPANISH
"^DD",54,54,3,21,3,0)
file should be used instead of adding new entries to this file.
"^DD",54,54,3,23,0)
^^8^8^3040522^
"^DD",54,54,3,23,1,0)
This field contains the Spanish translation for the old RX CONSULT file
"^DD",54,54,3,23,2,0)
(#54) warning label. It will be initially populated only for the "Do not
"^DD",54,54,3,23,3,0)
transfer" warning label number 20. When possible, the new warning label
"^DD",54,54,3,23,4,0)
source should be used and the Spanish translation is available from the
"^DD",54,54,3,23,5,0)
WARNING LABEL-SPANISH file (#50.626). This file will be used when a
"^DD",54,54,3,23,6,0)
patient has a PMI language preference of Spanish and when the PHARMACY
"^DD",54,54,3,23,7,0)
SYSTEM file (#59.7) WARNING LABEL SOURCE field (#16) is set to "N" for
"^DD",54,54,3,23,8,0)
"NEW".  
"^DD",54,54,3,"DT")
3040527
"^DD",59.7,59.7,16,0)
WARNING LABEL SOURCE^S^N:NEW;^10;9^Q
"^DD",59.7,59.7,16,3)
Enter "N" for NEW to use commercial data source for warning labels.
"^DD",59.7,59.7,16,21,0)
^^2^2^3040409^
"^DD",59.7,59.7,16,21,1,0)
An "N" in this field indicates that the new commercial source for warning 
"^DD",59.7,59.7,16,21,2,0)
labels will be used.
"^DD",59.7,59.7,16,23,0)
^^4^4^3040409^
"^DD",59.7,59.7,16,23,1,0)
If there is an "N" for "New" in this field, the commercial data source for
"^DD",59.7,59.7,16,23,2,0)
warning labels from the WARNING LABEL-ENGLISH (#50.625) or WARNING 
"^DD",59.7,59.7,16,23,3,0)
LABEL-SPANISH (#50.626) will be used to print the warning labels.
"^DD",59.7,59.7,16,23,4,0)
Otherwise, the old RX CONSULT file (#54) warning labels will be used.
"^DD",59.7,59.7,16,"DT")
3040409
**END**
**END**
