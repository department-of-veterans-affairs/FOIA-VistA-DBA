Released PRCA*4.5*159 SEQ #200
Extracted from mail message
**KIDS**:PRCA*4.5*159^

**INSTALL NAME**
PRCA*4.5*159
"BLD",2646,0)
PRCA*4.5*159^ACCOUNTS RECEIVABLE^0^3041028^y
"BLD",2646,1,0)
^^7^7^3041028^^^^
"BLD",2646,1,1,0)
 
"BLD",2646,1,2,0)
This patch will allow integrated sites to have multiple domains for
"BLD",2646,1,3,0)
regional counsels.
"BLD",2646,1,4,0)
This redirects Vista transmissions to Regional Counsel to new RC addresses
"BLD",2646,1,5,0)
for regular transmissions and Death Notifications.
"BLD",2646,1,6,0)
 
"BLD",2646,1,7,0)
This patch also fixes and undefined error in routine RCRCREC.
"BLD",2646,4,0)
^9.64PA^349.1^1
"BLD",2646,4,349.1,0)
349.1
"BLD",2646,4,349.1,2,0)
^9.641^349.161^2
"BLD",2646,4,349.1,2,349.1,0)
AR TRANSMISSION TYPE  (File-top level)
"BLD",2646,4,349.1,2,349.1,1,0)
^9.6411^^
"BLD",2646,4,349.1,2,349.161,0)
DIVISION OF CARE  (sub-file)
"BLD",2646,4,349.1,2,349.161,1,0)
^9.6411^.04^4
"BLD",2646,4,349.1,2,349.161,1,.01,0)
DIVISION OF CARE
"BLD",2646,4,349.1,2,349.161,1,.02,0)
REMOTE DOMAIN
"BLD",2646,4,349.1,2,349.161,1,.03,0)
RC MAIL ADDRESS
"BLD",2646,4,349.1,2,349.161,1,.04,0)
RC DEATH NOTIFICATION ADDRESS
"BLD",2646,4,349.1,222)
y^n^p^^^^n^^n
"BLD",2646,4,349.1,224)

"BLD",2646,4,"APDD",349.1,349.1)

"BLD",2646,4,"APDD",349.1,349.161)

"BLD",2646,4,"APDD",349.1,349.161,.01)

"BLD",2646,4,"APDD",349.1,349.161,.02)

"BLD",2646,4,"APDD",349.1,349.161,.03)

"BLD",2646,4,"APDD",349.1,349.161,.04)

"BLD",2646,4,"B",349.1,349.1)

"BLD",2646,"INI")

"BLD",2646,"INIT")
RCY159PO
"BLD",2646,"KRN",0)
^9.67PA^19^17
"BLD",2646,"KRN",.4,0)
.4
"BLD",2646,"KRN",.4,"NM",0)
^9.68A^^
"BLD",2646,"KRN",.401,0)
.401
"BLD",2646,"KRN",.401,"NM",0)
^9.68A^^
"BLD",2646,"KRN",.402,0)
.402
"BLD",2646,"KRN",.403,0)
.403
"BLD",2646,"KRN",.5,0)
.5
"BLD",2646,"KRN",.84,0)
.84
"BLD",2646,"KRN",3.6,0)
3.6
"BLD",2646,"KRN",3.8,0)
3.8
"BLD",2646,"KRN",9.2,0)
9.2
"BLD",2646,"KRN",9.8,0)
9.8
"BLD",2646,"KRN",9.8,"NM",0)
^9.68A^22^22
"BLD",2646,"KRN",9.8,"NM",1,0)
RCRCXMS^^0^B63503495
"BLD",2646,"KRN",9.8,"NM",2,0)
RCRCALB^^0^B22361743
"BLD",2646,"KRN",9.8,"NM",3,0)
RCRCAL2^^0^B3928110
"BLD",2646,"KRN",9.8,"NM",4,0)
RCRCBL1^^0^B7541597
"BLD",2646,"KRN",9.8,"NM",5,0)
RCRCUTL^^0^B29191013
"BLD",2646,"KRN",9.8,"NM",6,0)
RCRCVLB^^0^B38508597
"BLD",2646,"KRN",9.8,"NM",7,0)
RCRCDIV^^0^B8436765
"BLD",2646,"KRN",9.8,"NM",8,0)
RCRCVL2^^0^B5268143
"BLD",2646,"KRN",9.8,"NM",9,0)
RCRCRR^^0^B18602808
"BLD",2646,"KRN",9.8,"NM",10,0)
RCRCSRV^^0^B19936486
"BLD",2646,"KRN",9.8,"NM",11,0)
RCRCVXM^^0^B15265021
"BLD",2646,"KRN",9.8,"NM",12,0)
RCRCAT^^0^B26616041
"BLD",2646,"KRN",9.8,"NM",13,0)
RCRCACP^^0^B41762718
"BLD",2646,"KRN",9.8,"NM",14,0)
RCRCREC^^0^B18541881
"BLD",2646,"KRN",9.8,"NM",15,0)
RCRCREC2^^0^B15806701
"BLD",2646,"KRN",9.8,"NM",16,0)
RCDPBPLM^^0^B50396509
"BLD",2646,"KRN",9.8,"NM",17,0)
RCRCVL^^0^B3902459
"BLD",2646,"KRN",9.8,"NM",18,0)
RCAMDTH^^0^B14195214
"BLD",2646,"KRN",9.8,"NM",19,0)
RCAEOB^^0^B3616052
"BLD",2646,"KRN",9.8,"NM",20,0)
RCRCRT^^0^B58210816
"BLD",2646,"KRN",9.8,"NM",21,0)
RCY159PO^^0^B49534614
"BLD",2646,"KRN",9.8,"NM",22,0)
RCY159EN^^0^B12737298
"BLD",2646,"KRN",9.8,"NM","B","RCAEOB",19)

"BLD",2646,"KRN",9.8,"NM","B","RCAMDTH",18)

"BLD",2646,"KRN",9.8,"NM","B","RCDPBPLM",16)

"BLD",2646,"KRN",9.8,"NM","B","RCRCACP",13)

"BLD",2646,"KRN",9.8,"NM","B","RCRCAL2",3)

"BLD",2646,"KRN",9.8,"NM","B","RCRCALB",2)

"BLD",2646,"KRN",9.8,"NM","B","RCRCAT",12)

"BLD",2646,"KRN",9.8,"NM","B","RCRCBL1",4)

"BLD",2646,"KRN",9.8,"NM","B","RCRCDIV",7)

"BLD",2646,"KRN",9.8,"NM","B","RCRCREC",14)

"BLD",2646,"KRN",9.8,"NM","B","RCRCREC2",15)

"BLD",2646,"KRN",9.8,"NM","B","RCRCRR",9)

"BLD",2646,"KRN",9.8,"NM","B","RCRCRT",20)

"BLD",2646,"KRN",9.8,"NM","B","RCRCSRV",10)

"BLD",2646,"KRN",9.8,"NM","B","RCRCUTL",5)

"BLD",2646,"KRN",9.8,"NM","B","RCRCVL",17)

"BLD",2646,"KRN",9.8,"NM","B","RCRCVL2",8)

"BLD",2646,"KRN",9.8,"NM","B","RCRCVLB",6)

"BLD",2646,"KRN",9.8,"NM","B","RCRCVXM",11)

"BLD",2646,"KRN",9.8,"NM","B","RCRCXMS",1)

"BLD",2646,"KRN",9.8,"NM","B","RCY159EN",22)

"BLD",2646,"KRN",9.8,"NM","B","RCY159PO",21)

"BLD",2646,"KRN",19,0)
19
"BLD",2646,"KRN",19,"NM",0)
^9.68A^^
"BLD",2646,"KRN",19.1,0)
19.1
"BLD",2646,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",2646,"KRN",101,0)
101
"BLD",2646,"KRN",409.61,0)
409.61
"BLD",2646,"KRN",771,0)
771
"BLD",2646,"KRN",870,0)
870
"BLD",2646,"KRN",8994,0)
8994
"BLD",2646,"KRN","B",.4,.4)

"BLD",2646,"KRN","B",.401,.401)

"BLD",2646,"KRN","B",.402,.402)

"BLD",2646,"KRN","B",.403,.403)

"BLD",2646,"KRN","B",.5,.5)

"BLD",2646,"KRN","B",.84,.84)

"BLD",2646,"KRN","B",3.6,3.6)

"BLD",2646,"KRN","B",3.8,3.8)

"BLD",2646,"KRN","B",9.2,9.2)

"BLD",2646,"KRN","B",9.8,9.8)

"BLD",2646,"KRN","B",19,19)

"BLD",2646,"KRN","B",19.1,19.1)

"BLD",2646,"KRN","B",101,101)

"BLD",2646,"KRN","B",409.61,409.61)

"BLD",2646,"KRN","B",771,771)

"BLD",2646,"KRN","B",870,870)

"BLD",2646,"KRN","B",8994,8994)

"BLD",2646,"PRE")
RCY159EN
"BLD",2646,"QUES",0)
^9.62^^
"BLD",2646,"REQB",0)
^9.611^8^5
"BLD",2646,"REQB",1,0)
PRCA*4.5*63^1
"BLD",2646,"REQB",4,0)
PRCA*4.5*189^1
"BLD",2646,"REQB",5,0)
PRCA*4.5*127^1
"BLD",2646,"REQB",6,0)
PRCA*4.5*147^1
"BLD",2646,"REQB",8,0)
PRCA*4.5*153^1
"BLD",2646,"REQB","B","PRCA*4.5*127",5)

"BLD",2646,"REQB","B","PRCA*4.5*147",6)

"BLD",2646,"REQB","B","PRCA*4.5*153",8)

"BLD",2646,"REQB","B","PRCA*4.5*189",4)

"BLD",2646,"REQB","B","PRCA*4.5*63",1)

"FIA",349.1)
AR TRANSMISSION TYPE
"FIA",349.1,0)
^RCT(349.1,
"FIA",349.1,0,0)
349.1I
"FIA",349.1,0,1)
y^n^f^^^^n^^n
"FIA",349.1,0,10)

"FIA",349.1,0,11)

"FIA",349.1,0,"RLRO")

"FIA",349.1,0,"VR")
4.5^PRCA
"FIA",349.1,349.1)
0
"FIA",349.1,349.11)
0
"FIA",349.1,349.12)
0
"FIA",349.1,349.151)
0
"FIA",349.1,349.161)
0
"FIA",349.1,349.161,.01)

"FIA",349.1,349.161,.02)

"FIA",349.1,349.161,.03)

"FIA",349.1,349.161,.04)

"INIT")
RCY159PO
"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
159^3041028
"PKG",142,22,1,"PAH",1,1,0)
^^7^7^3041028
"PKG",142,22,1,"PAH",1,1,1,0)
 
"PKG",142,22,1,"PAH",1,1,2,0)
This patch will allow integrated sites to have multiple domains for
"PKG",142,22,1,"PAH",1,1,3,0)
regional counsels.
"PKG",142,22,1,"PAH",1,1,4,0)
This redirects Vista transmissions to Regional Counsel to new RC addresses
"PKG",142,22,1,"PAH",1,1,5,0)
for regular transmissions and Death Notifications.
"PKG",142,22,1,"PAH",1,1,6,0)
 
"PKG",142,22,1,"PAH",1,1,7,0)
This patch also fixes and undefined error in routine RCRCREC.
"PRE")
RCY159EN
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
22
"RTN","RCAEOB")
0^19^B3616052
"RTN","RCAEOB",1,0)
RCAEOB ;ALB/CMS - AEOB FILE 433 CROSS-REF ROUTINE ; 16-JUN-00
"RTN","RCAEOB",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCAEOB",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCAEOB",4,0)
 Q
"RTN","RCAEOB",5,0)
 ;
"RTN","RCAEOB",6,0)
AEOB ;File 433 Cross-Ref on Transaction Type AEOB
"RTN","RCAEOB",7,0)
 ;     -used to alert pending EOB processing when Payment in Part
"RTN","RCAEOB",8,0)
 ;      transaction is created for referred TP bills
"RTN","RCAEOB",9,0)
 ;     -used to send MM to RC when Payment if Full is made
"RTN","RCAEOB",10,0)
 N PRCABN,PRCAEN,RCAT
"RTN","RCAEOB",11,0)
 I (X'=2)!($G(DA)<1) G AEOBQ
"RTN","RCAEOB",12,0)
 S PRCABN=+$P($G(^PRCA(433,DA,0)),U,2) I 'PRCABN G AEOBQ
"RTN","RCAEOB",13,0)
 D RCCAT^RCRCUTL(.RCAT)
"RTN","RCAEOB",14,0)
 I '$G(RCAT(+$P($G(^PRCA(430,PRCABN,0)),U,2))) G AEOBQ
"RTN","RCAEOB",15,0)
 I '$$REFST^RCRCUTL(PRCABN) G AEOBQ
"RTN","RCAEOB",16,0)
 S ^PRCA(433,"AEOB",PRCABN,DA)=""
"RTN","RCAEOB",17,0)
AEOBQ Q
"RTN","RCAEOB",18,0)
 ;
"RTN","RCAEOB",19,0)
SND ;Send RC a mail message about Payment in Full
"RTN","RCAEOB",20,0)
 N PRCA,RCBDIV,RCWHO,RCXMB,X,XNDUZ,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,Y
"RTN","RCAEOB",21,0)
 N RCCOM,RCDOM,RCSITE,RCSUB
"RTN","RCAEOB",22,0)
 I $P($G(RCCAT(+$P(^PRCA(430,PRCABN,0),U,2))),U,1)'=1 Q
"RTN","RCAEOB",23,0)
 D BNVAR^RCRCUTL(PRCABN)
"RTN","RCAEOB",24,0)
 S Y=$G(^PRCA(433,PRCAEN,1))
"RTN","RCAEOB",25,0)
 S RCXMB(2,0)=$G(PRCA("BNAME"),"UNK")_U_PRCAEN_U_+$P(Y,U,1)_U_+$P(Y,U,5)
"RTN","RCAEOB",26,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCAEOB",27,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCAEOB",28,0)
 I $G(RCDIV(0)) S RCBDIV=$$DIV^RCRCDIV(PRCABN)
"RTN","RCAEOB",29,0)
 S X=0 F X=$O(RCDIV(X)) Q:'X  D
"RTN","RCAEOB",30,0)
 .I X=+RCBDIV S RCDOM=$P(RCDIV(X),"^",6)
"RTN","RCAEOB",31,0)
 .Q
"RTN","RCAEOB",32,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCAEOB",33,0)
 S XMDUZ=DUZ,(RCSUB,XMSUB)="AR/RC - "_$G(RCSITE,"UNK")_" FULL PAYMENT"
"RTN","RCAEOB",34,0)
 S RCWHO=RCDOM,XMY(RCWHO)="",XMY(DUZ)=""
"RTN","RCAEOB",35,0)
 S RCXMB(1,0)="$$RC$$FP$"_RCSITE_"$S.RC RC SERV"
"RTN","RCAEOB",36,0)
 S RCXMB(3,0)="$$END$1$"
"RTN","RCAEOB",37,0)
 S XMTEXT="RCXMB(" D ^XMD
"RTN","RCAEOB",38,0)
 S RCCOM="Sent a Payment in Full Information to RC in MM# "_$G(XMZ)
"RTN","RCAEOB",39,0)
 I $G(XMZ) D ENT^RCRCXMS(XMZ,RCSUB,RCWHO,RCCOM)
"RTN","RCAEOB",40,0)
SNDQ Q
"RTN","RCAEOB",41,0)
 ;RCAEOB
"RTN","RCAMDTH")
0^18^B14195214
"RTN","RCAMDTH",1,0)
RCAMDTH ;WASH-ISC@ALTOONA,PA/LDB-DEATH NOTIFICATION FOR ACCOUNTS RECEIVABLE ;8/30/93  4:05 PM
"RTN","RCAMDTH",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCAMDTH",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCAMDTH",4,0)
 ;
"RTN","RCAMDTH",5,0)
SET ;SET RCLOGIC FOR PATIENT FILE (2) FIELD .351 DATE OF DEATH ENTERED
"RTN","RCAMDTH",6,0)
 N DFN,RCLOGIC,VADM S RCLOGIC=1
"RTN","RCAMDTH",7,0)
 S DFN=+DA D DEM^VADPT
"RTN","RCAMDTH",8,0)
 I '+VADM(6) Q
"RTN","RCAMDTH",9,0)
 ;
"RTN","RCAMDTH",10,0)
MAIL N RCCB,RCBDIV,RCBN,RCDB,RCD,RCDIV,RCDOM,RCHD,RCHDM,RCLN,RCRF,RCSITE,RCST,RCY,VA,VAERR,X,XMCHAN,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,Y
"RTN","RCAMDTH",11,0)
 K ^TMP($J,"RCAMDTH")
"RTN","RCAMDTH",12,0)
 I '$G(DA) Q
"RTN","RCAMDTH",13,0)
 I ('$D(^PRCA(430,"E",+DA)))&('$D(^RCD(340,"B",+DA_";DPT("))) Q
"RTN","RCAMDTH",14,0)
 S RCDB=+$O(^RCD(340,"B",+DA_";DPT(",0))
"RTN","RCAMDTH",15,0)
 F RCST=102,112,240 S RCST(RCST)=$O(^PRCA(430.3,"AC",RCST,0)) S $P(RCST(RCST),U,2)=$P($G(^PRCA(430.3,+RCST(RCST),0)),U,1)
"RTN","RCAMDTH",16,0)
 Q:'$O(RCST(0))
"RTN","RCAMDTH",17,0)
 S ^TMP($J,"RCAMDTH",1)="  "
"RTN","RCAMDTH",18,0)
 S ^TMP($J,"RCAMDTH",2)=" PATIENT NAME: "_$P(VADM(1),"^")
"RTN","RCAMDTH",19,0)
 S ^TMP($J,"RCAMDTH",3)="          SSN: "_$P(VADM(2),"^",2)
"RTN","RCAMDTH",20,0)
 S ^TMP($J,"RCAMDTH",4)="  "
"RTN","RCAMDTH",21,0)
 S ^TMP($J,"RCAMDTH",5)="DATE OF DEATH: "_$S(RCLOGIC=1:$P(VADM(6),"^",2),2:"DELETED")
"RTN","RCAMDTH",22,0)
 S ^TMP($J,"RCAMDTH",6)="  "
"RTN","RCAMDTH",23,0)
 S ^TMP($J,"RCAMDTH",7)="  "
"RTN","RCAMDTH",24,0)
 S ^TMP($J,"RCAMDTH",8)="==============================================================================="
"RTN","RCAMDTH",25,0)
 S ^TMP($J,"RCAMDTH",9)="Please note that MAS has "_$S(RCLOGIC=1:"entered a ",1:"DELETED the ")_"DATE OF DEATH for the above patient."
"RTN","RCAMDTH",26,0)
 S ^TMP($J,"RCAMDTH",10)="A review of the patient's account may be necessary for follow-up action."
"RTN","RCAMDTH",27,0)
 S ^TMP($J,"RCAMDTH",11)="The following bills are either Active, Open or Suspended for this patient:"
"RTN","RCAMDTH",28,0)
 S ^TMP($J,"RCAMDTH",12)="  "
"RTN","RCAMDTH",29,0)
 S ^TMP($J,"RCAMDTH",13)="  BILL NO.            AMOUNT   STATUS"
"RTN","RCAMDTH",30,0)
 S ^TMP($J,"RCAMDTH",14)="  ---------           ------   ------"
"RTN","RCAMDTH",31,0)
 S ^TMP($J,"RCAMDTH",15)="  "
"RTN","RCAMDTH",32,0)
 S RCLN=15
"RTN","RCAMDTH",33,0)
 ;
"RTN","RCAMDTH",34,0)
 ;  -Check for bills Open Active or Suspended
"RTN","RCAMDTH",35,0)
 I RCDB F RCST=102,112,240 D
"RTN","RCAMDTH",36,0)
 .S RCBN=0 F  S RCBN=$O(^PRCA(430,"AS",RCDB,+RCST(RCST),RCBN)) Q:'RCBN  D
"RTN","RCAMDTH",37,0)
 ..S RCCB=0 F RCY=1:1:5 S RCCB=$P($G(^PRCA(430,+RCBN,7)),"^",RCY)+RCCB
"RTN","RCAMDTH",38,0)
 ..S RCLN=RCLN+1
"RTN","RCAMDTH",39,0)
 ..S RCHD=" " I $$HD^RCRCUIB(RCBN) S (RCHDM,RCHD)="*"
"RTN","RCAMDTH",40,0)
 ..S ^TMP($J,"RCAMDTH",RCLN)="  "_$P($G(^PRCA(430,+RCBN,0)),U,1)_RCHD_$J(RCCB,14,2)_"    "_$P(RCST(RCST),U,2)
"RTN","RCAMDTH",41,0)
 ;
"RTN","RCAMDTH",42,0)
 I $G(RCHDM)="*" D
"RTN","RCAMDTH",43,0)
 .F RCY=1:1:2 S RCLN=RCLN+1,^TMP($J,"RCAMDTH",RCLN)="  "
"RTN","RCAMDTH",44,0)
 .S RCLN=RCLN+1,^TMP($J,"RCAMDTH",RCLN)="  * - Indicates Cat C Charges on Hold"
"RTN","RCAMDTH",45,0)
 ;
"RTN","RCAMDTH",46,0)
 ;  -Check for Referred bills to RC
"RTN","RCAMDTH",47,0)
 S RCBN=0 F  S RCBN=$O(^PRCA(430,"E",+DFN,RCBN)) Q:('RCBN)!($G(RCRF)=1)  D
"RTN","RCAMDTH",48,0)
 .I '$$REFST^RCRCUTL(RCBN) Q
"RTN","RCAMDTH",49,0)
 .;Set up information for the Divisions of care.
"RTN","RCAMDTH",50,0)
 .  S RCSITE=$$SITE^RCMSITE
"RTN","RCAMDTH",51,0)
 .  D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCAMDTH",52,0)
 .;S RCRF=1 S RCDOM=$$RCDOM^RCRCUTL()
"RTN","RCAMDTH",53,0)
 .  S RCRF=1
"RTN","RCAMDTH",54,0)
 .  I $O(RCDIV(0)) S RCBDIV=$$DIV^IBJDF2(RCBN) S X=0 F  S X=$O(RCDIV(X)) Q:'X  D
"RTN","RCAMDTH",55,0)
 ..I X=+RCBDIV S RCDOM=$P(RCDIV(X),U,7)
"RTN","RCAMDTH",56,0)
 ..Q
"RTN","RCAMDTH",57,0)
 .I $G(RCDOM)="" D
"RTN","RCAMDTH",58,0)
 ..S X=$O(^RCT(349.1,"B","RC",0))
"RTN","RCAMDTH",59,0)
 ..S RCDOM=$P($G(^RCT(349.1,+X,3)),U,5)
"RTN","RCAMDTH",60,0)
 ..Q
"RTN","RCAMDTH",61,0)
 .F RCY=1:1:2 S RCLN=RCLN+1,^TMP($J,"RCAMDTH",RCLN)="  "
"RTN","RCAMDTH",62,0)
 .S RCLN=RCLN+1,^TMP($J,"RCAMDTH",RCLN)="  (Patient has referred Third Party bills.  Notification forwarded to RC.)"
"RTN","RCAMDTH",63,0)
 ;
"RTN","RCAMDTH",64,0)
 ;  -If no bills found Quit
"RTN","RCAMDTH",65,0)
 I RCLN=15 G MAILQ
"RTN","RCAMDTH",66,0)
 ;
"RTN","RCAMDTH",67,0)
 S XMY("G.PRCA ADJUSTMENT TRANS")="",XMCHAN=1
"RTN","RCAMDTH",68,0)
 I $G(RCRF),$G(RCDOM)]"" S RCD=RCDOM S XMY(RCD)=""
"RTN","RCAMDTH",69,0)
 S XMSUB=$S(RCLOGIC=1:"NOTIFICATION OF DEATH ENTRY",1:"DATE OF DEATH DELETED")
"RTN","RCAMDTH",70,0)
 S XMTEXT="^TMP($J,""RCAMDTH"",",XMDUZ="AR Package"
"RTN","RCAMDTH",71,0)
 D ^XMD
"RTN","RCAMDTH",72,0)
MAILQ K ^TMP($J,"RCAMDTH")
"RTN","RCAMDTH",73,0)
 Q
"RTN","RCAMDTH",74,0)
 ;
"RTN","RCAMDTH",75,0)
ERR ;Called from the DATE OF DEATH field (.351) in the PATIENT FILE (#2)
"RTN","RCAMDTH",76,0)
 ;Date of Death Deleted
"RTN","RCAMDTH",77,0)
 N DFN,RCLOGIC,VADM
"RTN","RCAMDTH",78,0)
 S DFN=+DA D DEM^VADPT
"RTN","RCAMDTH",79,0)
 I '+VADM(6) S RCLOGIC=2 D MAIL
"RTN","RCAMDTH",80,0)
 Q
"RTN","RCDPBPLM")
0^16^B50396509
"RTN","RCDPBPLM",1,0)
RCDPBPLM ;WISC/RFJ - bill profile ;1 Jun 99
"RTN","RCDPBPLM",2,0)
 ;;4.5;Accounts Receivable;**114,153,159**;Mar 20, 1995
"RTN","RCDPBPLM",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCDPBPLM",4,0)
 ;
"RTN","RCDPBPLM",5,0)
 ;
"RTN","RCDPBPLM",6,0)
 ;  called from menu option (19)
"RTN","RCDPBPLM",7,0)
 ;
"RTN","RCDPBPLM",8,0)
 N RCBILLDA,RCDPFXIT
"RTN","RCDPBPLM",9,0)
 ;
"RTN","RCDPBPLM",10,0)
 F  D  Q:'RCBILLDA
"RTN","RCDPBPLM",11,0)
 .   W !! S RCBILLDA=$$SELBILL^RCDPBTLM
"RTN","RCDPBPLM",12,0)
 .   I RCBILLDA<1 S RCBILLDA=0 Q
"RTN","RCDPBPLM",13,0)
 .   D EN^VALM("RCDP BILL PROFILE")
"RTN","RCDPBPLM",14,0)
 .   ;  fast exit
"RTN","RCDPBPLM",15,0)
 .   I $G(RCDPFXIT) S RCBILLDA=0
"RTN","RCDPBPLM",16,0)
 Q
"RTN","RCDPBPLM",17,0)
 ;
"RTN","RCDPBPLM",18,0)
 ;
"RTN","RCDPBPLM",19,0)
INIT ;  initialization for list manager list
"RTN","RCDPBPLM",20,0)
 ;  requires rcbillda
"RTN","RCDPBPLM",21,0)
 N BILLED,COMMDA,DATA,PAID,RCDPDATA,RCFYDA,RCLINE,REPTYPE,X1,X2
"RTN","RCDPBPLM",22,0)
 K ^TMP("RCDPBPLM",$J),^TMP("VALM VIDEO",$J)
"RTN","RCDPBPLM",23,0)
 ;
"RTN","RCDPBPLM",24,0)
 ;  fast exit
"RTN","RCDPBPLM",25,0)
 I $G(RCDPFXIT) S VALMQUIT=1 Q
"RTN","RCDPBPLM",26,0)
 ;
"RTN","RCDPBPLM",27,0)
 D DIQ430(RCBILLDA,".01:300")
"RTN","RCDPBPLM",28,0)
 ;
"RTN","RCDPBPLM",29,0)
 ;  set the listmanager line number
"RTN","RCDPBPLM",30,0)
 S RCLINE=0
"RTN","RCDPBPLM",31,0)
 ;
"RTN","RCDPBPLM",32,0)
 S DATA=$$ACCNTHDR^RCDPAPLM(RCDPDATA(430,RCBILLDA,9,"I"))
"RTN","RCDPBPLM",33,0)
 S RCLINE=RCLINE+1 D SET("Account: "_$P(DATA,"^")_" "_$P(DATA,"^",2),RCLINE,1,80)
"RTN","RCDPBPLM",34,0)
 D SET($P(DATA,"^",3),RCLINE,60,80)
"RTN","RCDPBPLM",35,0)
 S %="" I $TR($P(DATA,"^",4,9),"^")'="" S %=$P(DATA,"^",4)_", "_$P(DATA,"^",7)_", "_$P(DATA,"^",8)_"  "_$P(DATA,"^",9)
"RTN","RCDPBPLM",36,0)
 S RCLINE=RCLINE+1 D SET("   Addr: "_%,RCLINE,1,80)
"RTN","RCDPBPLM",37,0)
 S RCLINE=RCLINE+1 D SET("  Phone: "_$P(DATA,"^",10),RCLINE,1,80)
"RTN","RCDPBPLM",38,0)
 ;
"RTN","RCDPBPLM",39,0)
 ;  bill descriptive data
"RTN","RCDPBPLM",40,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",41,0)
 S RCLINE=RCLINE+1 D SET("Bill Number",RCLINE,1,80,.01,IOUON,IOUOFF)
"RTN","RCDPBPLM",42,0)
 D SET("Category",RCLINE,40,80,2)
"RTN","RCDPBPLM",43,0)
 S RCLINE=RCLINE+1 D SET("Date  Prepared",RCLINE,1,80,10)
"RTN","RCDPBPLM",44,0)
 D SET("Status",RCLINE,42,80,8)
"RTN","RCDPBPLM",45,0)
 S RCLINE=RCLINE+1 D SET("Date Activated",RCLINE,1,80,60)
"RTN","RCDPBPLM",46,0)
 S RCLINE=RCLINE+1 D SET("Date Status Up",RCLINE,1,80,14)
"RTN","RCDPBPLM",47,0)
 D SET("By",RCLINE,46,80,17)
"RTN","RCDPBPLM",48,0)
 ;display TP bills Division of Care
"RTN","RCDPBPLM",49,0)
 I "T"=$P($G(^PRCA(430.2,+RCDPDATA(430,RCBILLDA,2,"I"),0)),"^",6) D
"RTN","RCDPBPLM",50,0)
 .S RCDIV=$$DIV^IBJDF2(RCBILLDA) I +RCDIV D
"RTN","RCDPBPLM",51,0)
 ..S RCDIV=$P($G(^DG(40.8,RCDIV,0)),U,1) I RCDIV="" Q
"RTN","RCDPBPLM",52,0)
 ..S RCLINE=RCLINE+1 D SET("Division of Care: "_RCDIV,RCLINE,1,80)
"RTN","RCDPBPLM",53,0)
 S RCLINE=RCLINE+1 D SET("Resulting From",RCLINE,1,80,4.5)
"RTN","RCDPBPLM",54,0)
 I RCDPDATA(430,RCBILLDA,15.1,"E")'="" D
"RTN","RCDPBPLM",55,0)
 .   S RCLINE=RCLINE+1 D SET("  Type of Care",RCLINE,1,80,15.1)
"RTN","RCDPBPLM",56,0)
 S RCLINE=RCLINE+1 D SET("        Remark",RCLINE,1,80,15)
"RTN","RCDPBPLM",57,0)
 ;  display comments if there
"RTN","RCDPBPLM",58,0)
 I $O(^PRCA(430,RCBILLDA,10,0)) D
"RTN","RCDPBPLM",59,0)
 .   S RCLINE=RCLINE+1 D SET("Comments:",RCLINE,1,80)
"RTN","RCDPBPLM",60,0)
 .   S COMMDA=0 F  S COMMDA=$O(^PRCA(430,RCBILLDA,10,COMMDA)) Q:'COMMDA  D
"RTN","RCDPBPLM",61,0)
 .   .   S RCLINE=RCLINE+1 D SET("  "_$G(^PRCA(430,RCBILLDA,10,COMMDA,0)),RCLINE,1,80)
"RTN","RCDPBPLM",62,0)
 ;
"RTN","RCDPBPLM",63,0)
 ;  int/adm rate and date
"RTN","RCDPBPLM",64,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",65,0)
 S DATA=$$INT^RCMSFN01(RCDPDATA(430,RCBILLDA,10,"I"))
"RTN","RCDPBPLM",66,0)
 S Y=$P(DATA,"^",2) I Y D DD^%DT
"RTN","RCDPBPLM",67,0)
 S RCLINE=RCLINE+1 D SET("Interest Effective Rate Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLM",68,0)
 D SET(" Annual Rate: "_$P(DATA,"^"),RCLINE,55,80)
"RTN","RCDPBPLM",69,0)
 S DATA=$$ADM^RCMSFN01(RCDPDATA(430,RCBILLDA,10,"I"))
"RTN","RCDPBPLM",70,0)
 S Y=$P(DATA,"^",2) I Y D DD^%DT
"RTN","RCDPBPLM",71,0)
 S RCLINE=RCLINE+1 D SET("   Admin Effective Rate Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLM",72,0)
 D SET("Monthly Rate: "_$P(DATA,"^"),RCLINE,55,80)
"RTN","RCDPBPLM",73,0)
 S RCLINE=RCLINE+1 D SET("  Last Int/Admin Charge Date",RCLINE,1,80,67)
"RTN","RCDPBPLM",74,0)
 ;
"RTN","RCDPBPLM",75,0)
 ;  put bill balances on first line of second screen
"RTN","RCDPBPLM",76,0)
 F RCLINE=RCLINE+1:1:16 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",77,0)
 ;
"RTN","RCDPBPLM",78,0)
 ;  bill dollars
"RTN","RCDPBPLM",79,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",80,0)
 S RCLINE=RCLINE+1 D SET("Bill Balances           Billed          Paid",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",81,0)
 S RCLINE=RCLINE+1 D SET("     Principal: "_$J(RCDPDATA(430,RCBILLDA,71,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,77,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",82,0)
 D SET("       Original Amt: "_$J(RCDPDATA(430,RCBILLDA,3,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",83,0)
 S RCLINE=RCLINE+1 D SET("      Interest: "_$J(RCDPDATA(430,RCBILLDA,72,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,78,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",84,0)
 I $G(RCDPDATA(430,RCBILLDA,131,"E")) D SET("Medicare Contr  Adj: "_$J(RCDPDATA(430,RCBILLDA,131,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",85,0)
 I RCDPDATA(430,RCBILLDA,74,"E") D
"RTN","RCDPBPLM",86,0)
 .   S RCLINE=RCLINE+1 D SET("  Marshall Fee: "_$J(RCDPDATA(430,RCBILLDA,74,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,79.1,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",87,0)
 I RCDPDATA(430,RCBILLDA,75,"E") D
"RTN","RCDPBPLM",88,0)
 .   S RCLINE=RCLINE+1 D SET("    Court Cost: "_$J(RCDPDATA(430,RCBILLDA,75,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",89,0)
 S RCLINE=RCLINE+1 D SET("Administrative: "_$J(RCDPDATA(430,RCBILLDA,73,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,79,"E"),14,2),RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",90,0)
 I $G(RCDPDATA(430,RCBILLDA,132,"E")) D SET("Medicare Unreim Exp: "_$J(RCDPDATA(430,RCBILLDA,132,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",91,0)
 ;  compute totals
"RTN","RCDPBPLM",92,0)
 S BILLED=0 F %=71,72,73,74,75 S BILLED=BILLED+RCDPDATA(430,RCBILLDA,%,"E")
"RTN","RCDPBPLM",93,0)
 S PAID=0 F %=77,78,79,79.1 S PAID=PAID+RCDPDATA(430,RCBILLDA,%,"E")
"RTN","RCDPBPLM",94,0)
 S RCLINE=RCLINE+1 D SET("       Current: "_$J(BILLED,14,2)_$J(PAID,14,2),RCLINE,1,80)
"RTN","RCDPBPLM",95,0)
 ;
"RTN","RCDPBPLM",96,0)
 ;  show refund if there
"RTN","RCDPBPLM",97,0)
 I RCDPDATA(430,RCBILLDA,79.18,"E") D
"RTN","RCDPBPLM",98,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",99,0)
 .   S RCLINE=RCLINE+1 D SET("Refunded Amount",RCLINE,1,80,79.18)
"RTN","RCDPBPLM",100,0)
 .   D SET("Date",RCLINE,27,80,79.19)
"RTN","RCDPBPLM",101,0)
 .   D SET("By",RCLINE,50,80,79.21)
"RTN","RCDPBPLM",102,0)
 ;
"RTN","RCDPBPLM",103,0)
 ;  accounting data
"RTN","RCDPBPLM",104,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",105,0)
 S RCLINE=RCLINE+1 D SET("Accounting Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",106,0)
 ;  fiscal year multiple
"RTN","RCDPBPLM",107,0)
 D SET("Fiscal Year",RCLINE,20,32,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",108,0)
 D SET("Approp Code",RCLINE,34,46,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",109,0)
 D SET("Amount",RCLINE,50,60,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",110,0)
 S RCFYDA=0 F  S RCFYDA=$O(^PRCA(430,RCBILLDA,2,RCFYDA)) Q:'RCFYDA  D
"RTN","RCDPBPLM",111,0)
 .   S DATA=$G(^PRCA(430,RCBILLDA,2,RCFYDA,0))
"RTN","RCDPBPLM",112,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPBPLM",113,0)
 .   D SET($J($P(DATA,"^"),30),RCLINE,1,80)     ;fiscal year
"RTN","RCDPBPLM",114,0)
 .   D SET($J(RCDPDATA(430,RCBILLDA,203,"E"),6),RCLINE,39,45) ;fund
"RTN","RCDPBPLM",115,0)
 .   D SET($J($P(DATA,"^",2),8,2),RCLINE,48,80)   ;amount
"RTN","RCDPBPLM",116,0)
 ;  determine which rsc to display
"RTN","RCDPBPLM",117,0)
 S %=RCDPDATA(430,RCBILLDA,255.1,"E") I %="" S %=RCDPDATA(430,RCBILLDA,255,"E")
"RTN","RCDPBPLM",118,0)
 S RCLINE=RCLINE+1 D SET("Rev Srce Code: "_%,RCLINE,1,80)
"RTN","RCDPBPLM",119,0)
 ;
"RTN","RCDPBPLM",120,0)
 ;  collection data
"RTN","RCDPBPLM",121,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",122,0)
 S RCLINE=RCLINE+1 D SET("Collection Follow up Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",123,0)
 S RCLINE=RCLINE+1 D SET("        Letter1",RCLINE,1,80,61)
"RTN","RCDPBPLM",124,0)
 S RCLINE=RCLINE+1 D SET("        Letter2",RCLINE,1,80,62)
"RTN","RCDPBPLM",125,0)
 S RCLINE=RCLINE+1 D SET("        Letter3",RCLINE,1,80,63)
"RTN","RCDPBPLM",126,0)
 S RCLINE=RCLINE+1 D SET("        Letter4",RCLINE,1,80,68)
"RTN","RCDPBPLM",127,0)
 I RCDPDATA(430,RCBILLDA,68.6,"I") D
"RTN","RCDPBPLM",128,0)
 .   S RCLINE=RCLINE+1 D SET("     IRS Letter",RCLINE,1,80,68.6)
"RTN","RCDPBPLM",129,0)
 .   D SET("Amount",RCLINE,65,80,68.93)
"RTN","RCDPBPLM",130,0)
 I RCDPDATA(430,RCBILLDA,64,"I") D
"RTN","RCDPBPLM",131,0)
 .   S RCLINE=RCLINE+1 D SET("DC/DOJ Ref Date",RCLINE,1,80,64)
"RTN","RCDPBPLM",132,0)
 .   D SET("To",RCLINE,40,80,65)
"RTN","RCDPBPLM",133,0)
 .   D SET("Amount",RCLINE,65,80,66)
"RTN","RCDPBPLM",134,0)
 ;
"RTN","RCDPBPLM",135,0)
 ;  repayment plan (show only if there)
"RTN","RCDPBPLM",136,0)
 I RCDPDATA(430,RCBILLDA,41,"I") D REPAY^RCDPBPLI
"RTN","RCDPBPLM",137,0)
 ;
"RTN","RCDPBPLM",138,0)
 ;  irs data (show only if there)
"RTN","RCDPBPLM",139,0)
 I RCDPDATA(430,RCBILLDA,68.7,"I") D IRS^RCDPBPLI
"RTN","RCDPBPLM",140,0)
 ;
"RTN","RCDPBPLM",141,0)
 ;  dmc data (show only if there)
"RTN","RCDPBPLM",142,0)
 I RCDPDATA(430,RCBILLDA,121,"I") D DMC^RCDPBPLI
"RTN","RCDPBPLM",143,0)
 ;
"RTN","RCDPBPLM",144,0)
 ;  top data (show only if there)
"RTN","RCDPBPLM",145,0)
 I $G(RCDPDATA(430,RCBILLDA,141,"I")) D TOP^RCDPBPLI
"RTN","RCDPBPLM",146,0)
 ;
"RTN","RCDPBPLM",147,0)
 ;  get the report type based on category.  if third party show
"RTN","RCDPBPLM",148,0)
 ;  insurance data
"RTN","RCDPBPLM",149,0)
 S REPTYPE=$P($G(^PRCA(430.2,+RCDPDATA(430,RCBILLDA,2,"I"),0)),"^",6)
"RTN","RCDPBPLM",150,0)
 I REPTYPE="T" D INSUR^RCDPBPLI
"RTN","RCDPBPLM",151,0)
 ;
"RTN","RCDPBPLM",152,0)
 ;  report type for employee or vendor, show description field 106
"RTN","RCDPBPLM",153,0)
 I REPTYPE="O"!(REPTYPE="V") D INIT^RCDPBPLI
"RTN","RCDPBPLM",154,0)
 ;
"RTN","RCDPBPLM",155,0)
 ;  show transactions and reasons
"RTN","RCDPBPLM",156,0)
 D TRANINIT^RCDPBPLI
"RTN","RCDPBPLM",157,0)
 ;
"RTN","RCDPBPLM",158,0)
 ;  set valmcnt to number of lines in the list
"RTN","RCDPBPLM",159,0)
 S VALMCNT=RCLINE
"RTN","RCDPBPLM",160,0)
 D HDR
"RTN","RCDPBPLM",161,0)
 Q
"RTN","RCDPBPLM",162,0)
 ;
"RTN","RCDPBPLM",163,0)
 ;
"RTN","RCDPBPLM",164,0)
HDR ;  header code for list manager display
"RTN","RCDPBPLM",165,0)
 ;  requires rcbillda
"RTN","RCDPBPLM",166,0)
 S VALMHDR(1)="***** ACCOUNTS RECEIVABLE BILL PROFILE FOR "_$P($G(^PRCA(430,RCBILLDA,0)),"^")_" *****"
"RTN","RCDPBPLM",167,0)
 Q
"RTN","RCDPBPLM",168,0)
 ;
"RTN","RCDPBPLM",169,0)
 ;
"RTN","RCDPBPLM",170,0)
EXIT ;  exit list manager option and clean up
"RTN","RCDPBPLM",171,0)
 K ^TMP("RCDPBPLM",$J)
"RTN","RCDPBPLM",172,0)
 Q
"RTN","RCDPBPLM",173,0)
 ;
"RTN","RCDPBPLM",174,0)
 ;
"RTN","RCDPBPLM",175,0)
SET(STRING,LINE,COLBEG,COLEND,FIELD,ON,OFF) ;  set array
"RTN","RCDPBPLM",176,0)
 I $G(FIELD) S STRING=STRING_$S(STRING="":"",1:": ")_$G(RCDPDATA(430,RCBILLDA,FIELD,"E"))
"RTN","RCDPBPLM",177,0)
 I STRING="",'$G(FIELD) Q
"RTN","RCDPBPLM",178,0)
 I '$D(@VALMAR@(LINE,0)) D SET^VALM10(LINE,$J("",80))
"RTN","RCDPBPLM",179,0)
 D SET^VALM10(LINE,$$SETSTR^VALM1(STRING,@VALMAR@(LINE,0),COLBEG,COLEND-COLBEG+1))
"RTN","RCDPBPLM",180,0)
 I $G(ON)]""!($G(OFF)]"") D CNTRL^VALM10(LINE,COLBEG,$L(STRING),ON,OFF)
"RTN","RCDPBPLM",181,0)
 Q
"RTN","RCDPBPLM",182,0)
 ;
"RTN","RCDPBPLM",183,0)
 ;
"RTN","RCDPBPLM",184,0)
DIQ430(DA,DR) ;  diq call to retrieve data for dr fields in file 430
"RTN","RCDPBPLM",185,0)
 N D0,DIC,DIQ,DIQ2
"RTN","RCDPBPLM",186,0)
 K RCDPDATA(430,DA)
"RTN","RCDPBPLM",187,0)
 S DIQ(0)="IE",DIC="^PRCA(430,",DIQ="RCDPDATA" D EN^DIQ1
"RTN","RCDPBPLM",188,0)
 Q
"RTN","RCRCACP")
0^13^B41762718
"RTN","RCRCACP",1,0)
RCRCACP ;ALB/CMS - RC THIRD PARTY REFERRAL ACTION CODE LIST ; 06-JUN-00
"RTN","RCRCACP",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCACP",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCACP",4,0)
 Q
"RTN","RCRCACP",5,0)
 ;
"RTN","RCRCACP",6,0)
TCD ;view of TRANSACTION CODE list
"RTN","RCRCACP",7,0)
 NEW RCDA,RCY,RC0,X S (VALMCNT,X)=""
"RTN","RCRCACP",8,0)
 K ^TMP("RCRCAC",$J)
"RTN","RCRCACP",9,0)
 S RCDA=0 F  S RCDA=$O(^RCT(349.4,RCDA)) Q:'RCDA  D
"RTN","RCRCACP",10,0)
 .S RC0=^RCT(349.4,RCDA,0)
"RTN","RCRCACP",11,0)
 .I $P(RC0,U,1)="PP" Q
"RTN","RCRCACP",12,0)
 .S VALMCNT=+$G(VALMCNT)+1
"RTN","RCRCACP",13,0)
 .S RCY=VALMCNT,X=$$SETFLD^VALM1(RCY,X,"NUMBER")
"RTN","RCRCACP",14,0)
 .S RCY=$P(RC0,U,1),X=$$SETFLD^VALM1(RCY,X,"CODE")
"RTN","RCRCACP",15,0)
 .S RCY=$P(RC0,U,2),X=$$SETFLD^VALM1(RCY,X,"NAME")
"RTN","RCRCACP",16,0)
 .S ^TMP("RCRCAC",$J,VALMCNT,0)=X
"RTN","RCRCACP",17,0)
 .S ^TMP("RCRCAC",$J,"IDX",VALMCNT,VALMCNT)=RCDA
"RTN","RCRCACP",18,0)
 .Q
"RTN","RCRCACP",19,0)
 I VALMCNT=0 S VALMSG="NOTHING TO REPORT"
"RTN","RCRCACP",20,0)
TCDQ Q
"RTN","RCRCACP",21,0)
 ;
"RTN","RCRCACP",22,0)
TRD(D0) ;Display Transaction Profile
"RTN","RCRCACP",23,0)
 N DXS,J,I,PRCAIO,PRCAIO,PRCATYP,X,Y,Z
"RTN","RCRCACP",24,0)
 S PRCAIO=IO,PRCAIO(0)=IO(0)
"RTN","RCRCACP",25,0)
 W @IOF,!,?12,"TRANSACTION PROFILE",!
"RTN","RCRCACP",26,0)
 D ^PRCATR3,ENF^IBOLK
"RTN","RCRCACP",27,0)
 W !!
"RTN","RCRCACP",28,0)
TRDQ Q
"RTN","RCRCACP",29,0)
 ;
"RTN","RCRCACP",30,0)
EOB ;Process the EOB Codes
"RTN","RCRCACP",31,0)
 N CNT,D,DA,DIC,DIE,DR,PRCA,PRCABN,PRCABN0,PRCAEN,PRCATN,RCCAT,RCCOM,RCCNT,RCOUT,RCSEL,RCXMB,RCY,X,XMZ,Y
"RTN","RCRCACP",32,0)
 N DIR,DIRUT,DIROUT,DTOUT,DUOUT S RCOUT=0
"RTN","RCRCACP",33,0)
 D FULL^VALM1
"RTN","RCRCACP",34,0)
 I '$O(^TMP("RCRCBL",$J,"SEL",0)) W !!,"NO PAYMENT TRANSACTION SELECTED !!",! G EOBQ
"RTN","RCRCACP",35,0)
 I '$O(^PRCA(433,"AEOB",0)) W !!,"ALL TP BILLS ARE PROCESSED !!" G EOBQ
"RTN","RCRCACP",36,0)
 D RCCAT^RCRCUTL(.RCCAT) K DIR
"RTN","RCRCACP",37,0)
 S RCSEL=0 F  S RCSEL=$O(^TMP("RCRCBL",$J,"SEL",RCSEL)) Q:('RCSEL)!(RCOUT=1)  S RCCNT=$G(^(RCSEL)) D
"RTN","RCRCACP",38,0)
 .S PRCATN=+$P($G(^TMP("RCRCBLX",$J,RCSEL)),U,2),RCCNT=+RCCNT
"RTN","RCRCACP",39,0)
 .S PRCABN=$P($G(^PRCA(433,PRCATN,0)),U,2)
"RTN","RCRCACP",40,0)
 .I '$D(^PRCA(433,"AEOB",PRCABN,PRCATN)) W !!," Item ",RCSEL,".  Transaction Number ",PRCATN,"  is processed.",! D PAUSE^VALM1 Q
"RTN","RCRCACP",41,0)
 .D BNVAR^RCRCUTL(PRCABN)
"RTN","RCRCACP",42,0)
 .D TRD(PRCATN)
"RTN","RCRCACP",43,0)
 .S DA=PRCATN,DIE(0)="AQEZ",DIE="^PRCA(433,",DR="54" D ^DIE
"RTN","RCRCACP",44,0)
 .K DIR W ! S DIR("A")="Ready to process payment information"
"RTN","RCRCACP",45,0)
 .S DIR("?")="Enter 'Yes' to transmit the payment to RC and update the referral amount."
"RTN","RCRCACP",46,0)
 .D ASK K DIR I $G(Y)="^" S RCOUT=1
"RTN","RCRCACP",47,0)
 .I ($G(Y)'=1)!(RCOUT=1) S ^PRCA(433,"AEOB",+PRCABN,+PRCATN)="" Q
"RTN","RCRCACP",48,0)
 .S RCCOM=$P($G(^PRCA(433,PRCATN,5)),U,4)
"RTN","RCRCACP",49,0)
 .I RCCOM]"" S RCCOM="Payment EOB CODE: "_RCCOM D COM^RCRCRT(PRCATN,RCCOM)
"RTN","RCRCACP",50,0)
 .S DA=PRCABN,DIE="^PRCA(430,",DR="66///^S X="_+$G(^PRCA(430,PRCABN,7)) D ^DIE
"RTN","RCRCACP",51,0)
 .K ^PRCA(433,"AEOB",PRCABN,PRCATN)
"RTN","RCRCACP",52,0)
 .D FLDTEXT^VALM10(RCSEL,"DEBTOR","Processed      ")
"RTN","RCRCACP",53,0)
 .I $P($G(RCCAT(+$P(^PRCA(430,PRCABN,0),U,2))),U,1)'=1 Q
"RTN","RCRCACP",54,0)
 .S Y=$G(^PRCA(433,PRCATN,1))
"RTN","RCRCACP",55,0)
 .S RCXMB(2,0)=$G(PRCA("BNAME"),"UNK")_U_PRCATN_U_$P($P(Y,U,9),".",1)_U_+$P(Y,U,5)
"RTN","RCRCACP",56,0)
 .S RCXMB(3,0)="EOB^"_$P($G(^PRCA(433,PRCATN,5)),U,4)
"RTN","RCRCACP",57,0)
 .D EOBS
"RTN","RCRCACP",58,0)
 .S RCCOM="Payment information sent to RC in MM# "_$G(XMZ) D COM^RCRCRT(PRCATN,RCCOM)
"RTN","RCRCACP",59,0)
 .Q
"RTN","RCRCACP",60,0)
EOBQ I $G(RCOUT)=1,$O(^PRCA(433,"AEOB",0)) D
"RTN","RCRCACP",61,0)
 .W !!," NOTICE: All bills pending EOB processing should be processed inorder"
"RTN","RCRCACP",62,0)
 .W !,?9,"to electronically send Partial Payment information to Regional Counsel"
"RTN","RCRCACP",63,0)
 .W !,?9,"and update the bill referral amount.  Not processing may cause the"
"RTN","RCRCACP",64,0)
 .W !,?9,"referral amount to be out-of-balance with Regional Counsel.",!
"RTN","RCRCACP",65,0)
 D PAUSE^VALM1 S VALMBCK="R"
"RTN","RCRCACP",66,0)
 Q
"RTN","RCRCACP",67,0)
 ;
"RTN","RCRCACP",68,0)
EOBS ;Send Partial Payment data to RC
"RTN","RCRCACP",69,0)
 N RCBDIV,RCCOM,RCDIV,RCDOM,RCSITE,RCSUB,XMCHAN,XMDUZ,XMSUB,XMTEXT,XMY,X,Y
"RTN","RCRCACP",70,0)
 I '$O(RCXMB(0)) G EOBSQ
"RTN","RCRCACP",71,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCACP",72,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCACP",73,0)
 I $O(RCDIV(0)) S RCBDIV=$$DIV^IBJDF2(PRCABN) S X=0 F  S X=$O(RCDIV(X)) Q:'X  D
"RTN","RCRCACP",74,0)
 .I X=+RCBDIV S RCDOM=$P(RCDIV(X),U,6)
"RTN","RCRCACP",75,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCRCACP",76,0)
 S XMDUZ=DUZ,(RCSUB,XMSUB)="AR/RC - "_$G(RCSITE,"UNK")_" PARTIAL PAYMENT"
"RTN","RCRCACP",77,0)
 S RCWHO=RCDOM,XMY(RCWHO)="",XMY(DUZ)=""
"RTN","RCRCACP",78,0)
 S RCXMB(1,0)="$$RC$PP$$"_RCSITE_"$S.RC RC SERV"
"RTN","RCRCACP",79,0)
 S RCXMB(4,0)="$END$1$"
"RTN","RCRCACP",80,0)
 S XMTEXT="RCXMB(",XMCHAN=1 D ^XMD
"RTN","RCRCACP",81,0)
 S RCCOM="Sent Payment Transaction to RC in MM# "_$G(XMZ)
"RTN","RCRCACP",82,0)
 I $G(XMZ) D ENT^RCRCXMS(XMZ,RCSUB,RCWHO,RCCOM)
"RTN","RCRCACP",83,0)
 W !!,?10,RCCOM,!
"RTN","RCRCACP",84,0)
EOBSQ Q
"RTN","RCRCACP",85,0)
 ;
"RTN","RCRCACP",86,0)
ASK ;Ask Yes or No Caller send DIR("A"),DIR("?")
"RTN","RCRCACP",87,0)
 N DIROUT,DUOUT,DTOUT,DIRUT
"RTN","RCRCACP",88,0)
 S DIR(0)="Y",DIR("B")="Yes" D ^DIR
"RTN","RCRCACP",89,0)
ASKQ Q
"RTN","RCRCACP",90,0)
 ;
"RTN","RCRCACP",91,0)
REQ ;Transmit a Action Request to RC
"RTN","RCRCACP",92,0)
 N DIR,PRCABN,RCCOM,RCY,VALMCNT,VALMY,X,Y
"RTN","RCRCACP",93,0)
 I '$O(^TMP("RCRCAL",$J,"SEL",0)) W !,"NO BILLS SELECTED!",!,"No selected items from Bill List" G REQQ
"RTN","RCRCACP",94,0)
 D EN^VALM2($G(XQORNOD(0)),"SO") I '$O(VALMY(0)) G REQQ
"RTN","RCRCACP",95,0)
 D FULL^VALM1
"RTN","RCRCACP",96,0)
 S RCCOM=$G(^TMP("RCRCAC",$J,+$O(VALMY(0)),0))
"RTN","RCRCACP",97,0)
 W !!,"You Selected: "_RCCOM
"RTN","RCRCACP",98,0)
 W !!,"This action creates an AR Comment Transaction requesting that a "_RCCOM
"RTN","RCRCACP",99,0)
 W !,"action be applied by Regional Counsel to the bills on the highlighted"
"RTN","RCRCACP",100,0)
 W !,"selection list. You can then edit the Comment Transaction request"
"RTN","RCRCACP",101,0)
 W !,"and transmit the request to RC.",!
"RTN","RCRCACP",102,0)
 ;
"RTN","RCRCACP",103,0)
 S RCCOM=^TMP("RCRCAC",$J,"IDX",+RCCOM,+RCCOM),RCCOM=$P($G(^RCT(349.4,+RCCOM,0)),U,1)
"RTN","RCRCACP",104,0)
 S RCCOM="I am requesting that a "_RCCOM_" be applied to this bill."
"RTN","RCRCACP",105,0)
 K DIR S DIR("A")="Okay to Create a Comment Transaction "
"RTN","RCRCACP",106,0)
 S DIR("?")="Enter Yes to create a Comment Transaction or No to exit."
"RTN","RCRCACP",107,0)
 D ASK K DIR I $G(Y)'=1 G REQQ
"RTN","RCRCACP",108,0)
 K ^TMP("RCRCAC",$J,"XM")
"RTN","RCRCACP",109,0)
 S RCY=0 F  S RCY=$O(^TMP("RCRCAL",$J,"SEL",RCY)) Q:'RCY  D
"RTN","RCRCACP",110,0)
 .S PRCABN=+$P($G(^TMP("RCRCALX",$J,RCY)),U,2),PRCAEN=0
"RTN","RCRCACP",111,0)
 .D CCOM
"RTN","RCRCACP",112,0)
 .Q
"RTN","RCRCACP",113,0)
 I '$O(^TMP("RCRCAC",$J,"XM",0)) G REQQ
"RTN","RCRCACP",114,0)
 K DIR S DIR("A")="Send Request to RC now ",DIR("?")="Enter Yes if to transmit the created Comment entries"
"RTN","RCRCACP",115,0)
 D ASK I $G(Y)=1 D SND
"RTN","RCRCACP",116,0)
 ;
"RTN","RCRCACP",117,0)
REQQ K ^TMP("RCRCAC",$J,"XM")
"RTN","RCRCACP",118,0)
 K DIR D PAUSE^VALM1 S XQORM("B")="Quit",VALMBCK="R"
"RTN","RCRCACP",119,0)
 Q
"RTN","RCRCACP",120,0)
 ;
"RTN","RCRCACP",121,0)
CCOM ;Create Comment Transaction
"RTN","RCRCACP",122,0)
 ;Input: PRCABN
"RTN","RCRCACP",123,0)
 N DA,DIC,DIE,DR,D0,PRCA,PRCABN0,PRCAD,PRCAEN,PRCAMT,X,Y
"RTN","RCRCACP",124,0)
 S PRCABN0=$G(^PRCA(430,+$G(PRCABN),0))
"RTN","RCRCACP",125,0)
 I 'PRCABN0 W !,PRCABN_" NOT A VALID AR BILL!",! G CCOMQ
"RTN","RCRCACP",126,0)
 W !!,"Bill No. # "_$P(PRCABN0,U,1)
"RTN","RCRCACP",127,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL
"RTN","RCRCACP",128,0)
 I '$D(PRCAEN) W "COULD NOT CREATE A TRANSACTION AT THIS TIME!",!,"Try again later." G CCOMQ
"RTN","RCRCACP",129,0)
 I $G(RCCOM)]"" D COM^RCRCRT(PRCAEN,RCCOM)
"RTN","RCRCACP",130,0)
 S DIE="^PRCA(433,",DA=PRCAEN,DR="[PRCA COMMENT]" D ^DIE
"RTN","RCRCACP",131,0)
 S DR="4////^S X=2" D ^DIE
"RTN","RCRCACP",132,0)
 S ^TMP("RCRCAC",$J,"XM",PRCABN,PRCAEN)=""
"RTN","RCRCACP",133,0)
CCOMQ Q
"RTN","RCRCACP",134,0)
 ;
"RTN","RCRCACP",135,0)
SND ;Send data to RC
"RTN","RCRCACP",136,0)
 N PRCABN,PRCAEN,PRCA,RCXCNT,X,Y,RCSITE,RCDIV,RCDOM,RCBDIV
"RTN","RCRCACP",137,0)
 K ^TMP("RCRCAT",$J,"XM") S RCXCNT=0
"RTN","RCRCACP",138,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCACP",139,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCACP",140,0)
 S PRCABN=0 F  S PRCABN=$O(^TMP("RCRCAC",$J,"XM",PRCABN)) Q:'PRCABN  D
"RTN","RCRCACP",141,0)
 .D BNVAR^RCRCUTL(PRCABN)
"RTN","RCRCACP",142,0)
 .D DEBT^RCRCUTL(PRCABN)
"RTN","RCRCACP",143,0)
 .S PRCAEN=0 F  S PRCAEN=$O(^TMP("RCRCAC",$J,"XM",PRCABN,PRCAEN)) Q:'PRCAEN  D
"RTN","RCRCACP",144,0)
 ..D SET^RCRCAT1
"RTN","RCRCACP",145,0)
 ..I $G(RCDIV(0)) S RCBDIV=$$DIV^IBJDF2(PRCABN) S X=0 F  S X=$O(RCDIV(X)) Q:'X  D
"RTN","RCRCACP",146,0)
 ...I X=+RCBDIV S RCDOM=$P(RCDIV(X),"^",6)
"RTN","RCRCACP",147,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCRCACP",148,0)
 D SEND^RCRCAT
"RTN","RCRCACP",149,0)
 K ^TMP("RCRCAT",$J,"XM")
"RTN","RCRCACP",150,0)
SNDQ Q
"RTN","RCRCACP",151,0)
 ;RCRCACP
"RTN","RCRCAL2")
0^3^B3928110
"RTN","RCRCAL2",1,0)
RCRCAL2 ;ALB/CMS - RC ACTION BILL LIST SORT BUILD ; 16-JUN-00
"RTN","RCRCAL2",2,0)
V ;;4.5;Accounts Receivable;**63,159**;MAR 20, 1995
"RTN","RCRCAL2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCAL2",4,0)
 Q
"RTN","RCRCAL2",5,0)
BLDL ; - find data required for the report
"RTN","RCRCAL2",6,0)
 N DFN,PRCABN,PRCABN0,RCAGE,RCAMT,RCCNT,RCCUR,RCRDT,RCY
"RTN","RCRCAL2",7,0)
 I $O(RCSPT(0)) D BLDPT G BLDLQ Q
"RTN","RCRCAL2",8,0)
 S (RCCNT,RCRDT)=0 W !,"Searching Referred Bills for match "
"RTN","RCRCAL2",9,0)
 F  S RCRDT=$O(^PRCA(430,"AD",RCRDT)) Q:'RCRDT  D
"RTN","RCRCAL2",10,0)
 .S PRCABN=0 F  S PRCABN=$O(^PRCA(430,"AD",RCRDT,PRCABN)) Q:'PRCABN  D GET
"RTN","RCRCAL2",11,0)
BLDLQ K RCSBN,RCCAT,RCCNT,RCSI,RCSIA,RCSIF,RCSPT,RCSIL
"RTN","RCRCAL2",12,0)
 Q
"RTN","RCRCAL2",13,0)
 ;
"RTN","RCRCAL2",14,0)
BLDPT ;If pt. selection use E cross-ref
"RTN","RCRCAL2",15,0)
 N DFN,PRCABN S (RCCNT,DFN)=0
"RTN","RCRCAL2",16,0)
 W !,"Searching TP bills for match "
"RTN","RCRCAL2",17,0)
 F  S DFN=$O(RCSPT(DFN)) Q:'DFN  S PRCABN=0 D
"RTN","RCRCAL2",18,0)
 .F  S PRCABN=$O(^PRCA(430,"E",DFN,PRCABN)) Q:'PRCABN  D GET
"RTN","RCRCAL2",19,0)
 Q
"RTN","RCRCAL2",20,0)
 ;
"RTN","RCRCAL2",21,0)
GET ;
"RTN","RCRCAL2",22,0)
 S PRCABN0=$G(^PRCA(430,PRCABN,0))
"RTN","RCRCAL2",23,0)
 ;  - check status must be active
"RTN","RCRCAL2",24,0)
 I $P(PRCABN0,U,8)'=16 Q
"RTN","RCRCAL2",25,0)
 ;  - check referral category
"RTN","RCRCAL2",26,0)
 S RCCAT="" D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCAL2",27,0)
 I '$D(RCCAT(+$P(PRCABN0,U,2))) Q
"RTN","RCRCAL2",28,0)
 ;  - check division
"RTN","RCRCAL2",29,0)
 I +$G(RCDIV(0)),'$$DIV^RCRCDIV(PRCABN) Q
"RTN","RCRCAL2",30,0)
 ;  - check debtor insurance carrier
"RTN","RCRCAL2",31,0)
 I $D(RCSI),'$$INS Q
"RTN","RCRCAL2",32,0)
 S RCCNT=$G(RCCNT)+1 W "."
"RTN","RCRCAL2",33,0)
 D SCRN^RCRCAL1(PRCABN)
"RTN","RCRCAL2",34,0)
 Q
"RTN","RCRCAL2",35,0)
 ;
"RTN","RCRCAL2",36,0)
INS() ; Get the Insurance company and check to include
"RTN","RCRCAL2",37,0)
 ;
"RTN","RCRCAL2",38,0)
 N PRCA,RCIN
"RTN","RCRCAL2",39,0)
 I $G(RCSIA)="ALL" S Y=1 G INSQ
"RTN","RCRCAL2",40,0)
 I $G(RCSIA)="NULL",$P(PRCABN0,U,9)="" S Y=1 G INSQ
"RTN","RCRCAL2",41,0)
 I $G(RCSIA)="NULL",+$P(PRCABN0,U,9) S Y=0 G INSQ
"RTN","RCRCAL2",42,0)
 I $O(RCSI(0)),$D(RCSI(+$P(PRCABN0,U,9))) S Y=1 G INSQ
"RTN","RCRCAL2",43,0)
 I $O(RCSI(0)),'$D(RCSI(+$P(PRCABN0,U,9))) S Y=0 G INSQ
"RTN","RCRCAL2",44,0)
 D DEBT^RCRCUTL(PRCABN)
"RTN","RCRCAL2",45,0)
 I $G(PRCA("DEBTNM"))="",$G(RCSIF)='"@" S Y=0 G INSQ
"RTN","RCRCAL2",46,0)
 I PRCA("DEBTNM")]$G(RCSIL) S Y=0 G INSQ
"RTN","RCRCAL2",47,0)
 I $G(RCSIF)="" S Y=1 G INSQ
"RTN","RCRCAL2",48,0)
 I $G(RCSIF)]PRCA("DEBTNM") S Y=0 G INSQ
"RTN","RCRCAL2",49,0)
 S Y=1
"RTN","RCRCAL2",50,0)
INSQ Q Y
"RTN","RCRCAL2",51,0)
 ;RCRCAL2
"RTN","RCRCALB")
0^2^B22361743
"RTN","RCRCALB",1,0)
RCRCALB ;ALB/CMS - RC FOLLOW-UP ACTION LIST BUILD ; 09-AUG-97
"RTN","RCRCALB",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCALB",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCALB",4,0)
 Q
"RTN","RCRCALB",5,0)
EN ; entry point from RCRCAL
"RTN","RCRCALB",6,0)
 ; Returns: RCSBN,RCSBN(CNT,PRCABN)
"RTN","RCRCALB",7,0)
 ;      or: RCCAT(catname),RCSI(dbt#),RCSPT,RCSIA,RCSIF,RCSIL,RCSAGN,RCSAGX,RCSAMT,RCSRC,RCDIV(0),RCDIV(40.8#IEN)
"RTN","RCRCALB",8,0)
 ;      or: RCOUT
"RTN","RCRCALB",9,0)
 N CNT,DA,DIC,PRCA,PRCABN,RCLQ,RCLQA,RCY,TCNT,T,X,Y
"RTN","RCRCALB",10,0)
 N RCCNT,RCDIV,RCSD,RCRN,RCSN,RCSNF,RCLCNT,RCSNL,RCSNA,RCSAR,RCSH
"RTN","RCRCALB",11,0)
 N DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCALB",12,0)
 K RCSBN,RCCAT,RCDIV,RCSI,RCSIF,RCSIL,RCSAGN,RCSAGX,RCSAMT,RCSPT,RCSRC,RCOUT
"RTN","RCRCALB",13,0)
 ;
"RTN","RCRCALB",14,0)
 ;Get Divisions
"RTN","RCRCALB",15,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCALB",16,0)
 ;Select one division if multiple
"RTN","RCRCALB",17,0)
 I $O(RCDIV(0)) D DIVS^RCRCDIV I $G(RCOUT)=1 G ENQ
"RTN","RCRCALB",18,0)
 ;
"RTN","RCRCALB",19,0)
 W !!,"Build List of Third Party RC Referrals"
"RTN","RCRCALB",20,0)
 W !!!
"RTN","RCRCALB",21,0)
 S DIR("A",1)="Build a list by"
"RTN","RCRCALB",22,0)
 S DIR("A",2)="1.  Selected AR Third Party Bill(s)"
"RTN","RCRCALB",23,0)
 S DIR("A",3)="2.  Selected Patient(s)"
"RTN","RCRCALB",24,0)
 S DIR("A",4)="3.  Selected AR Insurance Debtor(s) or Range"
"RTN","RCRCALB",25,0)
 S DIR("A",5)="4.  EOB Processing"
"RTN","RCRCALB",26,0)
 S DIR("A",6)="   "
"RTN","RCRCALB",27,0)
 S DIR("A")=" Select number: "
"RTN","RCRCALB",28,0)
 S DIR(0)="SAXB^1:Third Party Bills;2:Patients;3:Insurance Debtors;4:EOB Processing"
"RTN","RCRCALB",29,0)
 S DIR("B")=1
"RTN","RCRCALB",30,0)
 D ^DIR
"RTN","RCRCALB",31,0)
 I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) S RCOUT=1 G ENQ
"RTN","RCRCALB",32,0)
 I $E(Y)="^" S RCOUT=1 G ENQ
"RTN","RCRCALB",33,0)
 S RCRN=Y
"RTN","RCRCALB",34,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCALB",35,0)
 ;
"RTN","RCRCALB",36,0)
 I RCRN=1 D BILL G ENQ
"RTN","RCRCALB",37,0)
 I RCRN=2 D PT I '$G(RCOUT) D ASK
"RTN","RCRCALB",38,0)
 I RCRN=3 D INS I '$G(RCOUT) D ASK
"RTN","RCRCALB",39,0)
 I RCRN=4 D EN^RCRCBL S RCOUT=1
"RTN","RCRCALB",40,0)
ENQ W !
"RTN","RCRCALB",41,0)
 I $G(RCOUT)=1 K RCSBN,RCCAT,RCDIV,RCSI,RCSIA,RCSIF,RCSIL,RCSAGN,RCSAGX,RCSPT,RCSAMT,RCSRC
"RTN","RCRCALB",42,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCALB",43,0)
 Q
"RTN","RCRCALB",44,0)
 ;
"RTN","RCRCALB",45,0)
 ;
"RTN","RCRCALB",46,0)
BILL ; - issue prompt for AR Bill Selection(s)
"RTN","RCRCALB",47,0)
 ; - also called from Modify List Protocol
"RTN","RCRCALB",48,0)
 N CNT,DIC,DA,RCI,RC1,X,Y,%Y W !
"RTN","RCRCALB",49,0)
 S DIC("A")="Select Active TP Accounts Receivable Bill No.: "
"RTN","RCRCALB",50,0)
 S DIC="^PRCA(430,",DIC(0)="AQEMZ"
"RTN","RCRCALB",51,0)
 S DIC("S")="I $P(^(0),U,8)=16,$P($G(^PRCA(430.2,+$P(^(0),U,2),0)),U,6)=""T"""
"RTN","RCRCALB",52,0)
 S CNT=0 F  D  Q:($G(PRCABN)<0)!($G(RCOUT))
"RTN","RCRCALB",53,0)
 .D ^DIC S PRCABN=Y
"RTN","RCRCALB",54,0)
 .I $G(PRCABN)<0 Q
"RTN","RCRCALB",55,0)
 .I $G(PRCABN)="^" S RCOUT=1 Q
"RTN","RCRCALB",56,0)
 .I +$G(RCDIV(0)),'$$DIV^RCRCDIV(PRCABN) W !!,"     <<Bill not in selected division.>>",! Q
"RTN","RCRCALB",57,0)
 .S CNT=CNT+1,RCSBN=CNT
"RTN","RCRCALB",58,0)
 .S RCSBN(+PRCABN)=CNT
"RTN","RCRCALB",59,0)
 .S DIC("A")="Select another Active TP Accounts Receivable Bill No.: "
"RTN","RCRCALB",60,0)
 .QUIT
"RTN","RCRCALB",61,0)
 I '$O(RCSBN(0)) S RCOUT=1
"RTN","RCRCALB",62,0)
 K PRCABN,DIC,DA,X,Y,%Y
"RTN","RCRCALB",63,0)
BILLQ Q
"RTN","RCRCALB",64,0)
 ;
"RTN","RCRCALB",65,0)
PT ;  - Issue prompt for Patients
"RTN","RCRCALB",66,0)
 N DIC,X,Y
"RTN","RCRCALB",67,0)
 I $O(RCSPT(0)) S DIC("A")="Select another PATIENT: "
"RTN","RCRCALB",68,0)
 S DIC="^DPT(",DIC(0)="QMEAZ"
"RTN","RCRCALB",69,0)
 W ! D ^DIC K DIC I $E(Y)="^" S RCOUT=1 G PTQ
"RTN","RCRCALB",70,0)
 I Y<0,'$O(RCSPT(0)) S RCOUT=1
"RTN","RCRCALB",71,0)
 I Y<0 G PTQ
"RTN","RCRCALB",72,0)
 S RCSPT(+Y)=Y G PT
"RTN","RCRCALB",73,0)
PTQ Q
"RTN","RCRCALB",74,0)
 ;
"RTN","RCRCALB",75,0)
INS ; - determine range of carriers
"RTN","RCRCALB",76,0)
 R !!,"Build List for (S)elected Third Party Debtor(s) or a (R)ange: Range// ",X:DTIME
"RTN","RCRCALB",77,0)
 I ('$T)!(X["^") S RCOUT=1 G INSQ
"RTN","RCRCALB",78,0)
 S:X="" X="R" S X=$E(X)
"RTN","RCRCALB",79,0)
 I "SRsr"'[X W !!,?15,"Enter 'S' or 'R' or '^' to exit." G INS
"RTN","RCRCALB",80,0)
 W $S("sS"[X:"  Selected",1:"  Range") S RCSI=X
"RTN","RCRCALB",81,0)
 I "Rr"[RCSI G INS1
"RTN","RCRCALB",82,0)
 ;
"RTN","RCRCALB",83,0)
 S DIC("A")="Select THIRD PARTY AR DEBTOR: "
"RTN","RCRCALB",84,0)
INSA S DIC="^RCD(340,",DIC(0)="QEAZ",DIC("S")="I $P(^(0),U,1)[""DIC(36,"""
"RTN","RCRCALB",85,0)
 W ! D ^DIC K DIC I $E(Y)="^" S RCOUT=1 G INSQ
"RTN","RCRCALB",86,0)
 I Y<0,$O(RCSI(0)) G INSQ
"RTN","RCRCALB",87,0)
 I Y<0,'$O(RCSI(0)) G INS
"RTN","RCRCALB",88,0)
 S RCSI(+Y)=Y
"RTN","RCRCALB",89,0)
 S DIC("A")="Select another THIRD PARTY AR DEBTOR: "
"RTN","RCRCALB",90,0)
 G INSA
"RTN","RCRCALB",91,0)
 ;
"RTN","RCRCALB",92,0)
INS1 W !!!,"   START WITH DEBTOR: FIRST// " R X:DTIME
"RTN","RCRCALB",93,0)
 I ('$T)!(X["^") S RCOUT=1 G INSQ
"RTN","RCRCALB",94,0)
 I $E(X)="?" W !,?5,"Enter the name of the Insurance Company to start with." G INS1
"RTN","RCRCALB",95,0)
 S RCSIF=X
"RTN","RCRCALB",96,0)
INS2 W !,"   GO TO DEBTOR: LAST// " R X:DTIME
"RTN","RCRCALB",97,0)
 I ('$T)!(X["^") S RCOUT=1 G INSQ
"RTN","RCRCALB",98,0)
 I $E(X)="?" W !,?5,"Enter the name of the Insurance Company to end with." G INS2
"RTN","RCRCALB",99,0)
 I X="" S RCSIL="zzzzz" S:RCSIF="" RCSIA="ALL" G INSQ
"RTN","RCRCALB",100,0)
 I X="@",RCSIF="@" S RCSIL="@",RCSIA="NULL" G INSQ
"RTN","RCRCALB",101,0)
 I RCSIF'="@",RCSIF]X W *7,!!,"    The LAST value must follow the FIRST.",! G INS1
"RTN","RCRCALB",102,0)
 S RCSIL=X
"RTN","RCRCALB",103,0)
INSQ Q
"RTN","RCRCALB",104,0)
 ;
"RTN","RCRCALB",105,0)
ASK ;Ask optional questions
"RTN","RCRCALB",106,0)
 ;
"RTN","RCRCALB",107,0)
 ; - Build list for Selected Categories
"RTN","RCRCALB",108,0)
 N CNT,I,RCCAT,X,Y
"RTN","RCRCALB",109,0)
 S RCCAT="" D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCALB",110,0)
 S (CNT,X)=0 K DIR
"RTN","RCRCALB",111,0)
 F  S X=$O(RCCAT(X)) Q:'X  D
"RTN","RCRCALB",112,0)
 .S CNT=CNT+1 S DIR("A",CNT)=CNT_"  "_$P(RCCAT(X),U,2)
"RTN","RCRCALB",113,0)
 S TCNT=CNT,CNT=CNT+1,DIR("A",CNT)=" "
"RTN","RCRCALB",114,0)
 S CNT=CNT+1,DIR("A",CNT)=" "
"RTN","RCRCALB",115,0)
 S CNT=CNT+1,DIR("A",CNT)=" "
"RTN","RCRCALB",116,0)
 S DIR("A")=" Enter response: "
"RTN","RCRCALB",117,0)
 W !!,"AR Categories to Include in Build List"
"RTN","RCRCALB",118,0)
 W !," Select from the following:",!
"RTN","RCRCALB",119,0)
 S DIR(0)="L^1:"_TCNT
"RTN","RCRCALB",120,0)
 D ^DIR I $E(Y)="^" S RCOUT=1 G ASKQ
"RTN","RCRCALB",121,0)
 K RCCAT F I=1:1:TCNT I $P(Y,",",I) S RCCAT($P(DIR("A",$P(Y,",",I)),"  ",2))=""
"RTN","RCRCALB",122,0)
 I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) G ASKQ
"RTN","RCRCALB",123,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCALB",124,0)
 ;
"RTN","RCRCALB",125,0)
ASKQ Q
"RTN","RCRCALB",126,0)
 ;RCRCALB
"RTN","RCRCAT")
0^12^B26616041
"RTN","RCRCAT",1,0)
RCRCAT ;ALB/CMS - AR/RC AR TRANSACTION TRANSMISSION ;16-JUN-00
"RTN","RCRCAT",2,0)
V ;;4.5;Accounts Receivable;**63,127,159**;Mar 20, 1995
"RTN","RCRCAT",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCAT",4,0)
 ;
"RTN","RCRCAT",5,0)
 Q
"RTN","RCRCAT",6,0)
EN ;Entry from Protocol to Transmit AR Transaction(s) to RC
"RTN","RCRCAT",7,0)
 N LN,PRCABN,RCA,RCCAT,RCCNT,RCCOM,RCDATA,RCDOM,RCMSG,RCOUT,RCSITE,RCXCNT,RCY,X,Y S RCCNT=0,LN=4
"RTN","RCRCAT",8,0)
 D FULL^VALM1
"RTN","RCRCAT",9,0)
 I '$O(^TMP("RCRCAL",$J,"SEL",0)) W !!,"NOTHING TO REFER!",!,"No selected items from list." G ENQ
"RTN","RCRCAT",10,0)
 ;D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCAT",11,0)
 W !! S DIR("A",1)="Referring transactions for bill(s) on highlighted Selection List "
"RTN","RCRCAT",12,0)
 S DIR("A")="Okay to Continue ",DIR("?")="Enter Yes to Continue"
"RTN","RCRCAT",13,0)
 D ASK^RCRCACP I $G(Y)'=1 G ENQ
"RTN","RCRCAT",14,0)
 K ^TMP("RCRCAT",$J,"XM") S RCXCNT=0
"RTN","RCRCAT",15,0)
 S RCY=0 F  S RCY=$O(^TMP("RCRCAL",$J,"SEL",RCY)) Q:('RCY)!($G(RCOUT))  D
"RTN","RCRCAT",16,0)
 .S PRCABN=$P($G(^TMP("RCRCALX",$J,RCY)),U,2)
"RTN","RCRCAT",17,0)
 .S PRCABN0=$G(^PRCA(430,+PRCABN,0)) Q:'PRCABN0
"RTN","RCRCAT",18,0)
 .;I $P($G(RCCAT(+$P(PRCABN0,U,2))),U,1)'=1 Q
"RTN","RCRCAT",19,0)
 .D EN^RCRCAT1
"RTN","RCRCAT",20,0)
 .Q
"RTN","RCRCAT",21,0)
 I $G(RCOUT) G ENQ
"RTN","RCRCAT",22,0)
 ; - If nothing to send go write message on screen
"RTN","RCRCAT",23,0)
 I '$O(^TMP("RCRCAT",$J,"XM",0)) W !,"Nothing to transmit!" G ENQ
"RTN","RCRCAT",24,0)
 ;
"RTN","RCRCAT",25,0)
 ; - create E-Mail and send off
"RTN","RCRCAT",26,0)
 D SEND
"RTN","RCRCAT",27,0)
 ;
"RTN","RCRCAT",28,0)
ENQ K DIR D PAUSE^VALM1 S VALMBCK="R"
"RTN","RCRCAT",29,0)
 Q
"RTN","RCRCAT",30,0)
 ;
"RTN","RCRCAT",31,0)
SEND ;Send bills in mail message
"RTN","RCRCAT",32,0)
 N II,LN,LNCNT,PRCABN,RCDATA,RCI,RCSUB,RCWHO,RETRY,TRCNT
"RTN","RCRCAT",33,0)
 N XNDUZ,XMSUB,XMTEXT,XMY,XMZ,X,Y
"RTN","RCRCAT",34,0)
 S RETRY=0,RCCOM=""
"RTN","RCRCAT",35,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCAT",36,0)
 I '$D(RCDOM)&($O(RCDIV(0))) S RCDOM=$P($G(RCDIV(+$P($G(RCDIV(0)),U,3))),U,6)
"RTN","RCRCAT",37,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCRCAT",38,0)
 N PRCABN
"RTN","RCRCAT",39,0)
SNDA ;Come back here if didn't go to mail man
"RTN","RCRCAT",40,0)
 S (XMDUN,XMDUZ)=$S(+$G(DUZ):DUZ,1:.5)
"RTN","RCRCAT",41,0)
 S (RCSUB,XMSUB)="AR/RC - "_$G(RCSITE,"UNK")_" AR "_$S($G(RCTYP)="CL":"COMMENT LOG",$G(RCTYP)="TR":"TRANSACTION HISTORY",1:"REQUEST FOR ACTION")
"RTN","RCRCAT",42,0)
 D XMZ^XMA2 I $G(XMZ)<1 S RETRY=RETRY+1 I RETRY<100 G SNDA
"RTN","RCRCAT",43,0)
 I $G(XMZ)<1 G SENDQ
"RTN","RCRCAT",44,0)
 S RCWHO=RCDOM
"RTN","RCRCAT",45,0)
 S XMY(RCWHO)="",TRCNT=0
"RTN","RCRCAT",46,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92^1^1^"_DT
"RTN","RCRCAT",47,0)
 S ^XMB(3.9,XMZ,2,1,0)="$$RC$"_$G(RCTYP,"TR")_"$$"_RCSITE_"$S.RC RC SERV"
"RTN","RCRCAT",48,0)
 S PRCABN=0,LN=1 F  S PRCABN=$O(^TMP("RCRCAT",$J,"XM",PRCABN)) Q:'PRCABN  D
"RTN","RCRCAT",49,0)
 .S II=0 F  S II=$O(^TMP("RCRCAT",$J,"XM",PRCABN,II)) Q:'II  D
"RTN","RCRCAT",50,0)
 ..S RCI=0,TRCNT=TRCNT+1 F  S RCI=$O(^TMP("RCRCAT",$J,"XM",PRCABN,II,RCI)) Q:'RCI  D
"RTN","RCRCAT",51,0)
 ...S RCDATA=$G(^TMP("RCRCAT",$J,"XM",PRCABN,II,RCI))
"RTN","RCRCAT",52,0)
 ...I RCDATA="" Q
"RTN","RCRCAT",53,0)
 ...S LN=LN+1,^XMB(3.9,XMZ,2,LN,0)=RCDATA
"RTN","RCRCAT",54,0)
 ;
"RTN","RCRCAT",55,0)
 S LNCNT=LN-1
"RTN","RCRCAT",56,0)
 S LN=LN+1,^XMB(3.9,XMZ,2,LN,0)="$END$"_TRCNT_"$"_LNCNT
"RTN","RCRCAT",57,0)
 S $P(^XMB(3.9,XMZ,2,0),U,3,4)=LN_U_LN
"RTN","RCRCAT",58,0)
 ;
"RTN","RCRCAT",59,0)
 D ENT1^XMD
"RTN","RCRCAT",60,0)
 I $E($G(IOST),1,2)="C-" W !!,"Message #",XMZ," Transmitted ",$G(TRCNT,0)," Transaction(s)."
"RTN","RCRCAT",61,0)
 S RCCOM="Message contains AR Transactions."
"RTN","RCRCAT",62,0)
 D ENT^RCRCXMS(XMZ,RCSUB,RCWHO,.RCCOM)
"RTN","RCRCAT",63,0)
SENDQ Q
"RTN","RCRCAT",64,0)
 ;
"RTN","RCRCAT",65,0)
DISP ;Display Bill and Transactions Select Items
"RTN","RCRCAT",66,0)
 ;Input: PRCABN
"RTN","RCRCAT",67,0)
 N DIR,CNT,RCY,PRCA,PRCAEN,X,Y S RCOUT=0
"RTN","RCRCAT",68,0)
 I '$D(^PRCA(430,PRCABN,0)) G DISPQ
"RTN","RCRCAT",69,0)
 D BNVAR^RCRCUTL(PRCABN)
"RTN","RCRCAT",70,0)
 D DEBT^RCRCUTL(PRCABN)
"RTN","RCRCAT",71,0)
 D HD
"RTN","RCRCAT",72,0)
 S (PRCAEN,CNT)=0 F  S PRCAEN=$O(^PRCA(433,"C",PRCABN,PRCAEN)) Q:'PRCAEN  D
"RTN","RCRCAT",73,0)
 .S CNT=CNT+1
"RTN","RCRCAT",74,0)
 .S RCEN1=$G(^PRCA(433,PRCAEN,1)),RCTY=+$P(RCEN1,U,2)
"RTN","RCRCAT",75,0)
 .S RCTY=$P($G(^PRCA(430.3,RCTY,0)),U,1)
"RTN","RCRCAT",76,0)
 .I RCTY="COMMENT" S RCTY=$P($G(^PRCA(433,PRCAEN,5)),U,2)
"RTN","RCRCAT",77,0)
 .S Y=+RCEN1 D D^DIQ S RCDT=Y
"RTN","RCRCAT",78,0)
 .S DIR("L",CNT)=CNT_"  "_PRCAEN_"  "_RCTY_"  "_RCDT_"  "_+$P(RCEN1,U,5)
"RTN","RCRCAT",79,0)
 .S ^TMP("RCRCAL",$J,"XM",PRCA("DEBTNM"),0)=PRCA("DEBTNM")
"RTN","RCRCAT",80,0)
 .S ^TMP("RCRCAL",$J,"XM",PRCA("DEBTNM"),PRCA("BNAME"),PRCAEN,0)=PRCA("BNAME")_"   Transaction # "_PRCAEN_" Transaction Date "_DT
"RTN","RCRCAT",81,0)
DISPQ Q
"RTN","RCRCAT",82,0)
 ;
"RTN","RCRCAT",83,0)
HD ;Write Heading
"RTN","RCRCAT",84,0)
 W @IOF,!,PRCA("DEBTNM"),!,PRCA("DEBTAD1")
"RTN","RCRCAT",85,0)
 W:$G(PRCA("DEBTAD2"))]"" !,PRCA("DEBTAD2")
"RTN","RCRCAT",86,0)
 W !,PRCA("DEBTCT"),", ",PRCA("DEBTST"),"  ",PRCA("DEBTZIP")
"RTN","RCRCAT",87,0)
 W !,"PHONE #: ",$P(PRCA("DEBTADD"),U,7)
"RTN","RCRCAT",88,0)
 W !!," BILL #: ",PRCA("BNAME")
"RTN","RCRCAT",89,0)
 W !!,"Item",?8,"TR #",?20,"Tran. Type",?45,"Date",?55,"Amount"
"RTN","RCRCAT",90,0)
 W ! F I=1:1:(IOM-1) W "="
"RTN","RCRCAT",91,0)
HDQ Q
"RTN","RCRCAT",92,0)
 ;
"RTN","RCRCAT",93,0)
PF(RCT) ;Input: PRCAEN, PRCABN Called from PRCAPAY1 and INC^RCRCRT
"RTN","RCRCAT",94,0)
 ;Send RC a mail message about Payment in Full or Increase
"RTN","RCRCAT",95,0)
 N PRCA,RCWHO,RCXMB,X,XNDUZ,XMCHAN,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,Y
"RTN","RCRCAT",96,0)
 N RCBDIV,RCCAT,RCCOM,RCD,RCDOM,RCDIV,RCSITE,RCSUB,RC1 S XMCHAN=""
"RTN","RCRCAT",97,0)
 D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCAT",98,0)
 I $P($G(RCCAT(+$P(^PRCA(430,+PRCABN,0),U,2))),U,1)'=1 G PFQ
"RTN","RCRCAT",99,0)
 I '$$REFST^RCRCUTL(PRCABN),(RCT="I") G PFQ
"RTN","RCRCAT",100,0)
 I RCT="P" S X=$P($G(^PRCA(430,PRCABN,6)),U,4,6) I 'X G PFQ
"RTN","RCRCAT",101,0)
 D BNVAR^RCRCUTL(+PRCABN)
"RTN","RCRCAT",102,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCAT",103,0)
 I $O(RCDIV(0)) S RCBDIV=$$DIV^IBJDF2(PRCABN) S X=0 F  S X=$O(RCDIV(X)) Q:'X  D
"RTN","RCRCAT",104,0)
 .;I $P(RCDIV(X),U,3)=+RCBDIV S RCDOM=$P(RCDIV(X),U,2)
"RTN","RCRCAT",105,0)
 .I X=+RCBDIV S RCDOM=$P(RCDIV(X),U,6)
"RTN","RCRCAT",106,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCAT",107,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCRCAT",108,0)
 S XMDUZ=DUZ,(RCSUB,XMSUB)="AR/RC - "_$G(RCSITE,"UNK")_$S(RCT="I":" INCREASE TO CURRENT BALANCE",1:" FULL PAYMENT FOR BILL")
"RTN","RCRCAT",109,0)
 S RCWHO=RCDOM,XMY(RCWHO)=""
"RTN","RCRCAT",110,0)
 S RCXMB(1,0)="$$RC$"_$S(RCT="I":"IN",1:"FP")_"$$"_RCSITE_"$S.RC RC SERV"
"RTN","RCRCAT",111,0)
 S RC1=$G(^PRCA(433,+PRCAEN,1))
"RTN","RCRCAT",112,0)
 S RCXMB(2,0)=$G(PRCA("BNAME"),"UNK")_U_PRCAEN_U_+$P(RC1,U,1)_U_+$P(RC1,U,5)
"RTN","RCRCAT",113,0)
 S RCXMB(3,0)="$END$1$"
"RTN","RCRCAT",114,0)
 S XMTEXT="RCXMB(" D ^XMD
"RTN","RCRCAT",115,0)
 S RCCOM="Sent "_$S(RCT="I":"Increase Adjustment",1:"Payment in Full")_" information to RC in MM# "_$G(XMZ)
"RTN","RCRCAT",116,0)
 I RCT="I" W !!,RCCOM
"RTN","RCRCAT",117,0)
 I $G(XMZ) D ENT^RCRCXMS(XMZ,RCSUB,RCWHO,RCCOM)
"RTN","RCRCAT",118,0)
PFQ Q
"RTN","RCRCAT",119,0)
 ;RCRCAT
"RTN","RCRCBL1")
0^4^B7541597
"RTN","RCRCBL1",1,0)
RCRCBL1 ;ALB/CMS - EOB PROCESSING LIST BUILD ; 09/02/97
"RTN","RCRCBL1",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCBL1",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCBL1",4,0)
 ;
"RTN","RCRCBL1",5,0)
BLDL ; build active list for EOB processing list
"RTN","RCRCBL1",6,0)
 ; Returns: TMP("RCRCBL", TMP("RCRCBLBX" and VALMCNT
"RTN","RCRCBL1",7,0)
 ;
"RTN","RCRCBL1",8,0)
 K ^TMP("RCRCBL",$J,"B")
"RTN","RCRCBL1",9,0)
 ;
"RTN","RCRCBL1",10,0)
 N CNT,PRCABN,PRCATN,RCCNT,RCY
"RTN","RCRCBL1",11,0)
 S (RCCNT,CNT,PRCABN,PRCATN)=0
"RTN","RCRCBL1",12,0)
 F  S PRCABN=$O(^PRCA(433,"AEOB",PRCABN)) Q:'PRCABN  D
"RTN","RCRCBL1",13,0)
 .I +$G(RCDIV(0)),'$$DIV^RCRCDIV(PRCABN) Q
"RTN","RCRCBL1",14,0)
 .S PRCATN=0 F  S PRCATN=$O(^PRCA(433,"AEOB",PRCABN,PRCATN)) Q:'PRCATN  D
"RTN","RCRCBL1",15,0)
 ..S RCCNT=$G(RCCNT)+1
"RTN","RCRCBL1",16,0)
 ..D SCRN(PRCATN,RCCNT,PRCABN)
"RTN","RCRCBL1",17,0)
 ..QUIT
"RTN","RCRCBL1",18,0)
 ;
"RTN","RCRCBL1",19,0)
 ;Add findings to list sorted by Pt. Name then Activation date
"RTN","RCRCBL1",20,0)
 D RESL
"RTN","RCRCBL1",21,0)
 ;
"RTN","RCRCBL1",22,0)
BLDLQ K RCSTN,RCSI,RCSIF,RCSIL,RCRCI Q
"RTN","RCRCBL1",23,0)
 ;
"RTN","RCRCBL1",24,0)
SCRN(PRCATN,RCCNT,PRCABN) ;
"RTN","RCRCBL1",25,0)
 ; add bill to screen list "B" sort (must Re Sequence List after)
"RTN","RCRCBL1",26,0)
 ; Send: PRCATN,RCCNT,PRCABN
"RTN","RCRCBL1",27,0)
 I '$G(^PRCA(433,+$G(PRCATN),0)) G SCRNQ
"RTN","RCRCBL1",28,0)
 N PRCA,RCY,RCBN0,RCTN0,RCTN1,X,Y S X=""
"RTN","RCRCBL1",29,0)
 S RCTN0=$G(^PRCA(433,+PRCATN,0))
"RTN","RCRCBL1",30,0)
 S RCTN1=$G(^PRCA(433,+PRCATN,1))
"RTN","RCRCBL1",31,0)
 S RCBN0=$G(^PRCA(430,+PRCABN,0))
"RTN","RCRCBL1",32,0)
 D BNVAR^RCRCUTL(PRCABN),DEBT^RCRCUTL(PRCABN)
"RTN","RCRCBL1",33,0)
 S RCY=$G(RCCNT),X=$$SETFLD^VALM1(RCY,X,"NUMBER")
"RTN","RCRCBL1",34,0)
 S RCY=$P($G(^DPT(+$P(RCBN0,U,7),0),"UNK"),U,1),X=$$SETFLD^VALM1(RCY,X,"PATIENT")
"RTN","RCRCBL1",35,0)
 S RCY=$P($P(RCBN0,U,1),"-",2),X=$$SETFLD^VALM1(RCY,X,"BILL")
"RTN","RCRCBL1",36,0)
 S RCY=+$P(RCTN0,U,1),X=$$SETFLD^VALM1(RCY,X,"TRAN")
"RTN","RCRCBL1",37,0)
 S RCY=$G(PRCA("DEBTNM")),X=$$SETFLD^VALM1(RCY,X,"DEBTOR")
"RTN","RCRCBL1",38,0)
 S RCY=$$DATE(+$P(RCTN1,U,9)),X=$$SETFLD^VALM1(RCY,X,"DATE")
"RTN","RCRCBL1",39,0)
 S RCY=+$P(RCTN1,U,5),X=$$SETFLD^VALM1($J(+RCY,9,2),X,"AMOUNT")
"RTN","RCRCBL1",40,0)
 S ^TMP("RCRCBL",$J,"B",$G(PRCA("DEBTNM"),"UNK"),$P($G(^DPT(+$P(RCBN0,U,7),0),"UNK"),U,1),+PRCATN)=X
"RTN","RCRCBL1",41,0)
SCRNQ Q
"RTN","RCRCBL1",42,0)
 ;
"RTN","RCRCBL1",43,0)
DATE(X) ; date in external format
"RTN","RCRCBL1",44,0)
 N Y S Y="" I X?7N.E S Y=$$FMTE^XLFDT(X,"5ZD")
"RTN","RCRCBL1",45,0)
 Q Y
"RTN","RCRCBL1",46,0)
 ;
"RTN","RCRCBL1",47,0)
RESL ;Build or Rebuild and sequence List with added or subtracted bill
"RTN","RCRCBL1",48,0)
 N PRCATN,RCDBT,RCPT,X,Y
"RTN","RCRCBL1",49,0)
 I '$D(^TMP("RCRCBL",$J,"B")) G RESLQ
"RTN","RCRCBL1",50,0)
 S VALMCNT=0
"RTN","RCRCBL1",51,0)
 S RCDBT="" F  S RCDBT=$O(^TMP("RCRCBL",$J,"B",RCDBT)) Q:RCDBT=""  S RCPT="" F  S RCPT=$O(^TMP("RCRCBL",$J,"B",RCDBT,RCPT)) Q:RCPT=""  D
"RTN","RCRCBL1",52,0)
 .S PRCATN=0 F  S PRCATN=$O(^TMP("RCRCBL",$J,"B",RCDBT,RCPT,PRCATN)) Q:'PRCATN  D
"RTN","RCRCBL1",53,0)
 ..S VALMCNT=VALMCNT+1
"RTN","RCRCBL1",54,0)
 ..S X=^TMP("RCRCBL",$J,"B",RCDBT,RCPT,PRCATN)
"RTN","RCRCBL1",55,0)
 ..S RCY=VALMCNT,X=$$SETFLD^VALM1(RCY,X,"NUMBER")
"RTN","RCRCBL1",56,0)
 ..S ^TMP("RCRCBL",$J,VALMCNT,0)=X
"RTN","RCRCBL1",57,0)
 ..S ^TMP("RCRCBL",$J,"IDX",VALMCNT,VALMCNT)=""
"RTN","RCRCBL1",58,0)
 ..S ^TMP("RCRCBLX",$J,VALMCNT)=VALMCNT_U_PRCATN
"RTN","RCRCBL1",59,0)
 ..D FLDCTRL^VALM10(VALMCNT)
"RTN","RCRCBL1",60,0)
RESLQ Q
"RTN","RCRCBL1",61,0)
 ;RCRCBL1
"RTN","RCRCDIV")
0^7^B8436765
"RTN","RCRCDIV",1,0)
RCRCDIV ;ALB/CMS-RC REFERRAL DIVISION UTILITY PROGRAM ; 16-JUN-00
"RTN","RCRCDIV",2,0)
V ;;4.5;Accounts Receivable;**159**;Mar 20, 1995
"RTN","RCRCDIV",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCDIV",4,0)
 Q
"RTN","RCRCDIV",5,0)
 ;
"RTN","RCRCDIV",6,0)
RCDIV(ARRAY) ;Get array of divisions and Remote Address
"RTN","RCRCDIV",7,0)
 ;Returns ARRAY(0)=Number of divisions^Primary 40.8 ien
"RTN","RCRCDIV",8,0)
 ;        ARRAY(40.8#IEN)="P" for Primary (default) or null^Domain Name
"RTN","RCRCDIV",9,0)
 ;                       =^Inst. file#^Inst. name^Station #
"RTN","RCRCDIV",10,0)
 ;        or:  ARRAY(0) Not Definded
"RTN","RCRCDIV",11,0)
 ;
"RTN","RCRCDIV",12,0)
 N CNT,RCA,RCS,RCX,RCY
"RTN","RCRCDIV",13,0)
 S CNT=0,RCX=$O(^RCT(349.1,"B","RC",0))
"RTN","RCRCDIV",14,0)
 I ('RCX)!('$O(^RCT(349.1,+RCX,6,0))) G RCDIVQ
"RTN","RCRCDIV",15,0)
 ;S RCS=$$SITE^VASITE,RCY=$P(RCS,U,2),RCY=$O(^DG(40.8,"B",RCY,0))
"RTN","RCRCDIV",16,0)
 ;S RCS=$$SITE^VASITE S RCY=$P(RCS,U,2) S RCY=$O(^DG(40.8,"B",RCY,0))
"RTN","RCRCDIV",17,0)
 S RCS=$$SITE^VASITE S RCY=$P(RCS,U,1) S RCY=$O(^DG(40.8,"AD",RCY,0))
"RTN","RCRCDIV",18,0)
 I 'RCY G RCDIVQ
"RTN","RCRCDIV",19,0)
 ;S ARRAY(RCY)="P^"_$P($G(^RCT(349.1,+RCX,3)),U,3)_"^"_RCS
"RTN","RCRCDIV",20,0)
 S ARRAY(RCY)="P^"_$P($G(^RCT(349.1,+RCX,3)),U,3)_"^"_RCS_"^"_$P($G(^RCT(349.1,+RCX,3)),U,4)_"^"_$P($G(^RCT(349.1,+RCX,3)),U,5)
"RTN","RCRCDIV",21,0)
 S $P(ARRAY(0),U,2)=RCY,CNT=CNT+1
"RTN","RCRCDIV",22,0)
 S RCY=0 F  S RCY=$O(^RCT(349.1,+RCX,6,RCY)) Q:'RCY  D
"RTN","RCRCDIV",23,0)
 .S RCA=$G(^RCT(349.1,+RCX,6,RCY,0))
"RTN","RCRCDIV",24,0)
 .I $D(ARRAY(+RCA)) Q
"RTN","RCRCDIV",25,0)
 .;S ARRAY(+RCA)="^"_$P($G(^DIC(4.2,+$P(RCA,U,2),0)),U,1)_"^"_$$SITE^VASITE(,+RCA)
"RTN","RCRCDIV",26,0)
 .S ARRAY(+RCA)="^"_$P($G(^DIC(4.2,+$P(RCA,U,2),0)),U,1)_"^"_$$SITE^VASITE(,+RCA)_"^"_$P(RCA,"^",3)_"^"_$P(RCA,"^",4)
"RTN","RCRCDIV",27,0)
 .I $P(ARRAY(+RCA),"^",3)=-1 K ARRAY(+RCA)
"RTN","RCRCDIV",28,0)
 .S CNT=CNT+1
"RTN","RCRCDIV",29,0)
 S $P(ARRAY(0),U,1)=CNT
"RTN","RCRCDIV",30,0)
 ; If only site in multiple is same as primary kill RCDIV
"RTN","RCRCDIV",31,0)
 I CNT=1 K RCDIV
"RTN","RCRCDIV",32,0)
RCDIVQ Q
"RTN","RCRCDIV",33,0)
 ; 
"RTN","RCRCDIV",34,0)
DIVS ;Select division if multi-site
"RTN","RCRCDIV",35,0)
 ; - Use RCDIV^RCRCDIV(.RCDIV) to set RCDIV(0)
"RTN","RCRCDIV",36,0)
 ;
"RTN","RCRCDIV",37,0)
 K ^TMP("RCDOMAIN",$J)
"RTN","RCRCDIV",38,0)
 N CNT,DIR,RCDOMAIN,RCI,RCS,RCX,TCNT,X,Y
"RTN","RCRCDIV",39,0)
 I '$O(RCDIV(0)) G DIVSQ
"RTN","RCRCDIV",40,0)
 S (CNT,RCX)=0,RCS="" K DIR
"RTN","RCRCDIV",41,0)
 F  S RCX=$O(RCDIV(RCX)) Q:'RCX  D
"RTN","RCRCDIV",42,0)
 .S CNT=CNT+1
"RTN","RCRCDIV",43,0)
 .S DIR("A",CNT)=CNT_".   "_$P(RCDIV(RCX),U,5)_"  "_$P(RCDIV(RCX),U,4)
"RTN","RCRCDIV",44,0)
 .;S RCS=RCS_CNT_":"_RCX_"  "_$P(RCDIV(RCX),U,4)_"  "_$P(RCDIV(RCX),U,2)_";"
"RTN","RCRCDIV",45,0)
 .;S RCS(CNT)=CNT_":"_RCX_"  "_$P(RCDIV(RCX),U,4)_"  "_$P(RCDIV(RCX),U,2)
"RTN","RCRCDIV",46,0)
 .S RCDIV(RCX)=RCDIV(RCX)_"^"_CNT
"RTN","RCRCDIV",47,0)
 .I $P(RCDIV(RCX),U,1)="P" S DIR("B")=CNT
"RTN","RCRCDIV",48,0)
 S TCNT=CNT,CNT=CNT+1,DIR("A",CNT)=" "
"RTN","RCRCDIV",49,0)
 S CNT=CNT+1,DIR("A",CNT)=" "
"RTN","RCRCDIV",50,0)
 S DIR("A")=" Enter a number: "
"RTN","RCRCDIV",51,0)
 W !!,"Medical Center Division to include in Build List"
"RTN","RCRCDIV",52,0)
 W !," Select one of the following:         (Required)",!
"RTN","RCRCDIV",53,0)
 S DIR(0)="NO^1:"_TCNT
"RTN","RCRCDIV",54,0)
 ;S DIR(0)="SAXB^"_RCS
"RTN","RCRCDIV",55,0)
 D ^DIR W !
"RTN","RCRCDIV",56,0)
 I $E(Y)="^" S RCOUT=1 G DIVSQ
"RTN","RCRCDIV",57,0)
 S RCI=0 F  S RCI=$O(RCDIV(RCI)) Q:'RCI  I $P(RCDIV(+RCI),"^",8)'=Y K RCDIV(RCI)
"RTN","RCRCDIV",58,0)
 S $P(RCDIV(0),U,3)=$O(RCDIV(0))
"RTN","RCRCDIV",59,0)
 S $P(^TMP("RCDOMAIN",$J,0),U,3)=$O(RCDIV(0))
"RTN","RCRCDIV",60,0)
 S ^TMP("RCDOMAIN",$J,$P(RCDIV(0),U,3))=RCDIV($P(RCDIV(0),U,3))
"RTN","RCRCDIV",61,0)
 I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) G DIVSQ
"RTN","RCRCDIV",62,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCDIV",63,0)
DIVSQ Q
"RTN","RCRCDIV",64,0)
 ;
"RTN","RCRCDIV",65,0)
DIV(PRCABN) ;Check bill # to see if same as selected division
"RTN","RCRCDIV",66,0)
 ;  Returns 1 if same as selected divison 0 if not
"RTN","RCRCDIV",67,0)
 ;  RCDIV(0) must be defined before calling
"RTN","RCRCDIV",68,0)
 N RCX S RCX=0
"RTN","RCRCDIV",69,0)
 I '$G(RCDIV(0)) G DIVQ
"RTN","RCRCDIV",70,0)
 I $P($G(RCDIV(0)),U,3)=$$DIV^IBJDF2(PRCABN) S RCX=1
"RTN","RCRCDIV",71,0)
DIVQ Q RCX
"RTN","RCRCDIV",72,0)
 ;
"RTN","RCRCDIV",73,0)
 ;RCRCDIV
"RTN","RCRCREC")
0^14^B18541881
"RTN","RCRCREC",1,0)
RCRCREC ;ALB/CMS - RC AND DHCP RECONCILIATION REPORTS ; 16-JUN-00
"RTN","RCRCREC",2,0)
V ;;4.5;Accounts Receivable;**61,63,147,159**;Mar 20, 1995
"RTN","RCRCREC",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCREC",4,0)
 ;
"RTN","RCRCREC",5,0)
 ;Tasked from the RC RC SERV routine
"RTN","RCRCREC",6,0)
 ; INPUT: RCJOB,RCSITE,RCVAR,RCXTYP,RCXMY,RCBDT,RCEDT,RCXMZ
"RTN","RCRCREC",7,0)
 ;OUTPUT: Four mail messages to G.RC RC REFERRALS
"RTN","RCRCREC",8,0)
 ;
"RTN","RCRCREC",9,0)
 N OUT,RCDIV,RCDOMNM
"RTN","RCRCREC",10,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCREC",11,0)
 ;
"RTN","RCRCREC",12,0)
 ; - if only one RC division of care, run process and quit
"RTN","RCRCREC",13,0)
 I '$O(RCDIV(0)) D EN G MAINQ
"RTN","RCRCREC",14,0)
 ;
"RTN","RCRCREC",15,0)
 ; - build new array by the RC domain and division, i.e.
"RTN","RCRCREC",16,0)
 ;     rcdiv("rcdomain",rc domain name,division)=""
"RTN","RCRCREC",17,0)
 I $O(RCDIV(0)) S RCDIV=0 F  S RCDIV=$O(RCDIV(RCDIV)) Q:'RCDIV  D 
"RTN","RCRCREC",18,0)
 .S RCDIV("RCDOMAIN",$P(RCDIV(RCDIV),"^",2),RCDIV)=""
"RTN","RCRCREC",19,0)
 ;
"RTN","RCRCREC",20,0)
 ; - run process for each RC domain/office
"RTN","RCRCREC",21,0)
 S RCDOMNM="" F  S RCDOMNM=$O(RCDIV("RCDOMAIN",RCDOMNM)) Q:RCDOMNM=""  D EN
"RTN","RCRCREC",22,0)
 ;
"RTN","RCRCREC",23,0)
MAINQ I '$D(OUT) K ^XTMP(RCXTYP,RCXMZ)
"RTN","RCRCREC",24,0)
 K RCJOB,RCSITE,RCVAR,RCXTYP,RCXMY,RCXMZ
"RTN","RCRCREC",25,0)
 Q
"RTN","RCRCREC",26,0)
 ;
"RTN","RCRCREC",27,0)
 ;
"RTN","RCRCREC",28,0)
EN ; Process bills for each specific RC Office
"RTN","RCRCREC",29,0)
 D INIT
"RTN","RCRCREC",30,0)
 D ^RCRCREC2
"RTN","RCRCREC",31,0)
 D SEND ; Create the four messages and send them to RCXMY
"RTN","RCRCREC",32,0)
 K ^TMP("PRCA",$J)
"RTN","RCRCREC",33,0)
 Q
"RTN","RCRCREC",34,0)
 ;
"RTN","RCRCREC",35,0)
 ;
"RTN","RCRCREC",36,0)
INIT ;Initialize variables and arrays
"RTN","RCRCREC",37,0)
 N I,LN,MTYP,RCREG
"RTN","RCRCREC",38,0)
 K ^TMP("PRCA",$J)
"RTN","RCRCREC",39,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCREC",40,0)
 ;
"RTN","RCRCREC",41,0)
 ; - set RC reference name for message
"RTN","RCRCREC",42,0)
 S RCREG=$S($G(RCDOMNM)]"":RCDOMNM,1:"REGIONAL COUNSEL SYSTEM")
"RTN","RCRCREC",43,0)
 ;
"RTN","RCRCREC",44,0)
 F I=1:1:4 D
"RTN","RCRCREC",45,0)
 .S ^TMP("PRCA",$J,"MR"_I,0)=5
"RTN","RCRCREC",46,0)
 .S ^TMP("PRCA",$J,"MR"_I,3)="               VAMC: "_RCSITE_" - "_$P($G(^DIC(4,RCSITE,0)),U,1)
"RTN","RCRCREC",47,0)
 .S ^TMP("PRCA",$J,"MR"_I,4)="   "
"RTN","RCRCREC",48,0)
 .S ^TMP("PRCA",$J,"MR"_I,5)="============================================================================="
"RTN","RCRCREC",49,0)
 S ^TMP("PRCA",$J,"MR1",1)="   BILLS ACTIVE/REFERRED IN ACCOUNTS RECEIVABLE SYSTEM"
"RTN","RCRCREC",50,0)
 S ^TMP("PRCA",$J,"MR1",2)="   BUT NOT PENDING IN "_RCREG
"RTN","RCRCREC",51,0)
 S ^TMP("PRCA",$J,"MR2",1)="   BILLS PENDING IN "_RCREG
"RTN","RCRCREC",52,0)
 S ^TMP("PRCA",$J,"MR2",2)="   BUT NOT ACTIVE/REFERRED IN ACCOUNTS RECEIVABLE SYSTEM"
"RTN","RCRCREC",53,0)
 S ^TMP("PRCA",$J,"MR3",1)="   BILLS IN REGIONAL COUNSEL SYSTEM AND ACCOUNTS RECEIVABLE SYSTEM"
"RTN","RCRCREC",54,0)
 S ^TMP("PRCA",$J,"MR3",2)="       WITH DIFFERENT DOLLAR AMOUNTS OR PATIENT SSN NUMBER"
"RTN","RCRCREC",55,0)
 S ^TMP("PRCA",$J,"MR4",1)="   BILLS IN REGIONAL COUNSEL SYSTEM AND ACCOUNTS RECEIVABLE SYSTEM"
"RTN","RCRCREC",56,0)
 S ^TMP("PRCA",$J,"MR4",2)="   WITH A DECREASE ADJUSTMENT BEFORE BILL REF.DT "
"RTN","RCRCREC",57,0)
 I RCEDT,RCBDT D
"RTN","RCRCREC",58,0)
 .S Y=RCBDT D D^DIQ
"RTN","RCRCREC",59,0)
 .S ^TMP("PRCA",$J,"MR4",2)=^TMP("PRCA",$J,"MR4",2)_" ("_Y_" to "
"RTN","RCRCREC",60,0)
 .S Y=RCEDT D D^DIQ
"RTN","RCRCREC",61,0)
 .S ^TMP("PRCA",$J,"MR4",2)=^TMP("PRCA",$J,"MR4",2)_Y_")"
"RTN","RCRCREC",62,0)
 ;  
"RTN","RCRCREC",63,0)
INITQ Q
"RTN","RCRCREC",64,0)
 ;
"RTN","RCRCREC",65,0)
SEND ;Send reports to Mailman
"RTN","RCRCREC",66,0)
 ;Loop for MR1 to MR4
"RTN","RCRCREC",67,0)
 N MREP
"RTN","RCRCREC",68,0)
 F MREP="MR1","MR2","MR3","MR4" D  ;
"RTN","RCRCREC",69,0)
 .N LN S MTYP=$E(MREP,3)
"RTN","RCRCREC",70,0)
 .I +$G(^TMP("PRCA",$J,MREP,0))=5 D  Q
"RTN","RCRCREC",71,0)
 ..S ^TMP("PRCA",$J,MREP,6)="      NO RECORDS FOUND"
"RTN","RCRCREC",72,0)
 ..M LN=^TMP("PRCA",$J,MREP) D XMB
"RTN","RCRCREC",73,0)
 .D SBIG Q
"RTN","RCRCREC",74,0)
SENDQ Q
"RTN","RCRCREC",75,0)
 ;
"RTN","RCRCREC",76,0)
SBIG ;Send the four large reports in a mail message to site and RC
"RTN","RCRCREC",77,0)
 N DATA,II,LN,RETRY,XMCHAN,XMDUZ,XMSUB,XMY,XMZ S RETRY=0
"RTN","RCRCREC",78,0)
 S XMCHAN=1,XMSUB="AR/RC - SITE: "_$G(RCSITE,"UNK")_" ("_+MTYP_" of 4) RECONCILIATION REPORT"
"RTN","RCRCREC",79,0)
 S (XMDUN,XMDUZ)="ACCOUNTS RECEIVABLE RC SERVER"
"RTN","RCRCREC",80,0)
 D XMZ^XMA2 I XMZ<1 S RETRY=RETRY+1 I RETRY<100 G SBIG
"RTN","RCRCREC",81,0)
 I RETRY>99 D  D XMB S OUT=1 G SBIGQ
"RTN","RCRCREC",82,0)
 .S MTYP=0
"RTN","RCRCREC",83,0)
 .S LN(1)=" The AR/RC Reconciliation Report is having trouble creating"
"RTN","RCRCREC",84,0)
 .S LN(2)="the four mail messages. Please contact an IRM support person."
"RTN","RCRCREC",85,0)
 S II=0,LN=0 F  S II=$O(^TMP("PRCA",$J,MREP,II)) Q:'II  D
"RTN","RCRCREC",86,0)
 .S DATA=^TMP("PRCA",$J,MREP,II)
"RTN","RCRCREC",87,0)
 .I $L(DATA) S LN=LN+1 S ^XMB(3.9,XMZ,2,LN,0)=DATA
"RTN","RCRCREC",88,0)
 I $D(^XMB(3.9,XMZ,2)) S ^XMB(3.9,XMZ,2,0)="^3.92^"_LN_U_LN_U_DT
"RTN","RCRCREC",89,0)
 S XMY("G.RC RC REFERRALS")=""
"RTN","RCRCREC",90,0)
 I $G(RCXMY)]"" S XMY(RCXMY)=""
"RTN","RCRCREC",91,0)
 D ENT1^XMD I XMZ<1 S RETRY=RETRY+1 I RETRY<100 G XMB
"RTN","RCRCREC",92,0)
SBIGQ Q
"RTN","RCRCREC",93,0)
 ;
"RTN","RCRCREC",94,0)
XMB ;Call to mailman
"RTN","RCRCREC",95,0)
 ;INPUT: LN( for message text array
"RTN","RCRCREC",96,0)
 ;       MTYP for message type (1 of 4) or 0 for (1 of 1)
"RTN","RCRCREC",97,0)
 ;       RCSITE
"RTN","RCRCREC",98,0)
 N RETRY,XMCHAN,XMDUZ,XMSUB,XMTEXT,XMY,XMZ S RETRY=0
"RTN","RCRCREC",99,0)
 S XMCHAN=1,XMSUB="AR/RC - SITE: "_$G(RCSITE,"UNK")_" ("_$S(MTYP=0:1,1:+MTYP)_" of "_$S(MTYP=0:1,1:4)_") RECONCILIATION REPORT"
"RTN","RCRCREC",100,0)
 S XMTEXT="LN(",XMDUZ="ACCOUNTS RECEIVABLE RC SERVER"
"RTN","RCRCREC",101,0)
 S XMY("G.RC RC REFERRALS")=""
"RTN","RCRCREC",102,0)
 I $G(RCXMY)]"" S XMY(RCXMY)=""
"RTN","RCRCREC",103,0)
 D ^XMD I XMZ<1 S RETRY=RETRY+1 I RETRY<100 G XMB
"RTN","RCRCREC",104,0)
XMBQ Q
"RTN","RCRCREC",105,0)
 ;RCRCREC
"RTN","RCRCREC2")
0^15^B15806701
"RTN","RCRCREC2",1,0)
RCRCREC2 ;ALB/CMS - RC AND DHCP RECONCILIATION REP LOOP ; 16-JUN-00
"RTN","RCRCREC2",2,0)
V ;;4.5;Accounts Receivable;**61,82,63,147,159**;Mar 20, 1995
"RTN","RCRCREC2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCREC2",4,0)
 ;
"RTN","RCRCREC2",5,0)
 ;Called from RCRCREC to loop through the XTMP(RCXTYP) global
"RTN","RCRCREC2",6,0)
 ;and the ^PRCA(430,"AD" cross-ref and compare the two. The
"RTN","RCRCREC2",7,0)
 ;task execution time is set by the RC RC SERV menu option Server
"RTN","RCRCREC2",8,0)
 ;Action. This job may be killed by IRM but notify the MCCR Referral Cord
"RTN","RCRCREC2",9,0)
 ;
"RTN","RCRCREC2",10,0)
 ;INPUT : RCJOB,RCXTYP,RCVAR,RCSITE,RCXMY
"RTN","RCRCREC2",11,0)
 ;OUTPUT: ^TMP("PRCA",$J,MESSAGE TYPE for each message type
"RTN","RCRCREC2",12,0)
 ;     
"RTN","RCRCREC2",13,0)
 D ARLOOP
"RTN","RCRCREC2",14,0)
 D RCLOOP
"RTN","RCRCREC2",15,0)
END Q
"RTN","RCRCREC2",16,0)
 ;
"RTN","RCRCREC2",17,0)
ARLOOP ;LOOP THROUGH AR CROSS-REF DATE "AD" OF 430
"RTN","RCRCREC2",18,0)
 N RCBN,RCBN0,RCCAT,REF,RFDT
"RTN","RCRCREC2",19,0)
 S RCCAT="" D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCREC2",20,0)
 S RFDT=0 F  S RFDT=$O(^PRCA(430,"AD",RFDT)) Q:'RFDT  D RCBN
"RTN","RCRCREC2",21,0)
 Q
"RTN","RCRCREC2",22,0)
RCBN ;GET BN AND CHK FOR BAD CROSS-REF, IF TP SET
"RTN","RCRCREC2",23,0)
 N RCS1,RCS2,RCS3
"RTN","RCRCREC2",24,0)
 S RCBN=0 F  S RCBN=$O(^PRCA(430,"AD",RFDT,RCBN)) Q:'RCBN  D
"RTN","RCRCREC2",25,0)
 .S REF=$P($G(^PRCA(430,RCBN,6)),U,4,6)
"RTN","RCRCREC2",26,0)
 .I REF="" K ^PRCA(430,"AD",RFDT,RCBN) Q
"RTN","RCRCREC2",27,0)
 .I $P(REF,U,1)="",$P(REF,U,3)="" K ^PRCA(430,"AD",RFDT,RCBN) Q
"RTN","RCRCREC2",28,0)
 .I $P(REF,U,1)="",$P(REF,U,3)]"" S $P(^PRCA(430,RCBN,6),U,4)=RFDT S $P(REF,U,1)=RFDT
"RTN","RCRCREC2",29,0)
 .I $P(REF,U,1)'=RFDT S ^PRCA(430,"AD",$P(REF,U,1),RCBN)="" K ^PRCA(430,"AD",RFDT,RCBN)
"RTN","RCRCREC2",30,0)
 .S RCBN0=$G(^PRCA(430,RCBN,0))
"RTN","RCRCREC2",31,0)
 .I $P(RCBN0,U,8)'=16 Q
"RTN","RCRCREC2",32,0)
 .I RCXTYP="PRCADR1",+$P(RCBN0,U,2)'=9 Q
"RTN","RCRCREC2",33,0)
 .S RCS1=$G(RCCAT(+$P(RCBN0,U,2))) I RCS1="" Q
"RTN","RCRCREC2",34,0)
 .I $O(RCDIV(0)),('$D(RCDIV("RCDOMAIN",RCDOMNM,$$DIV^IBJDF2(RCBN0)))) Q
"RTN","RCRCREC2",35,0)
 .S RCS2=$$NAM^RCFN01(+$P(RCBN0,U,9))
"RTN","RCRCREC2",36,0)
 .;
"RTN","RCRCREC2",37,0)
 .S RCS3=$P($G(^DPT(+$P(RCBN0,U,7),0)),U,1)
"RTN","RCRCREC2",38,0)
 .;
"RTN","RCRCREC2",39,0)
 .;
"RTN","RCRCREC2",40,0)
 .S ^TMP("PRCA",$J,$P(RCBN0,U,1),RCBN)=$P(RCBN0,U,1)_U_RCS2_U_$P(REF,U,1)_U_$P(REF,U,2)_U_RCS3_U_$P(REF,U,3)_U_$P($G(^DPT(+$P(RCBN0,U,7),0)),U,9)_U_$P(RCS1,U,2)
"RTN","RCRCREC2",41,0)
 Q
"RTN","RCRCREC2",42,0)
 ;
"RTN","RCRCREC2",43,0)
 ;
"RTN","RCRCREC2",44,0)
RCLOOP ;LOOP THRU THE XTMP GLOBAL SET FROM RC
"RTN","RCRCREC2",45,0)
 ;MR1- Bill referred by medical Center, but not in Regional Counsel
"RTN","RCRCREC2",46,0)
 ;MR2- Regional Counsel has bill but, Medical does not show bill as referred
"RTN","RCRCREC2",47,0)
 ;MR3- Bill in both RC and VAMC but, dollar amount does not agree
"RTN","RCRCREC2",48,0)
 ;MR4- Bill in both RC and VAMC but, a contract/decrease adjustment was made before referred
"RTN","RCRCREC2",49,0)
 ;
"RTN","RCRCREC2",50,0)
 N ERR,I,RCI,RCLN
"RTN","RCRCREC2",51,0)
 S RCI=0 F  S RCI=$O(^XTMP(RCXTYP,RCXMZ,RCI)) Q:'RCI  D
"RTN","RCRCREC2",52,0)
 .S RCLN=^XTMP(RCXTYP,RCXMZ,RCI) K ERR
"RTN","RCRCREC2",53,0)
 .I RCLN["$$RC$" Q
"RTN","RCRCREC2",54,0)
 .I RCLN'["^" Q
"RTN","RCRCREC2",55,0)
 .I $P(RCLN,U,1)="" D MR2 Q
"RTN","RCRCREC2",56,0)
 .I $D(^TMP("PRCA",$J,$P(RCLN,U,1))) D MR34 Q
"RTN","RCRCREC2",57,0)
 .I '$D(^TMP("PRCA",$J,$P(RCLN,U,1))) D MR2
"RTN","RCRCREC2",58,0)
 D MR1
"RTN","RCRCREC2",59,0)
 D SORT^RCRCREC3
"RTN","RCRCREC2",60,0)
 Q
"RTN","RCRCREC2",61,0)
 ;
"RTN","RCRCREC2",62,0)
MR34 ;BILL IS IN BOTH SYSTEMS AS REFERRED
"RTN","RCRCREC2",63,0)
 ;MR3.  SEE IF DOLLAR AMT IS THE SAME 
"RTN","RCRCREC2",64,0)
 ;MR4.  SEE IF DECREASE/CONTRACT DONE BEFORE REFERRED
"RTN","RCRCREC2",65,0)
 N ARLN,ARBAL,BN,CURBAL,MTYP,X S MTYP="MR3" K ERR
"RTN","RCRCREC2",66,0)
 S BN=$O(^TMP("PRCA",$J,$P(RCLN,U,1),0)) G MR34Q:BN=""
"RTN","RCRCREC2",67,0)
 S ARLN=^TMP("PRCA",$J,$P(RCLN,U,1),BN)
"RTN","RCRCREC2",68,0)
 I +$P(ARLN,U,6)'=$P(+$P(RCLN,U,6),".00",1) S ERR("MR3",3)=""
"RTN","RCRCREC2",69,0)
 S ARBAL=$G(^PRCA(430,BN,7)),CURBAL=0
"RTN","RCRCREC2",70,0)
 I ARBAL]"" F X=1:1:5 S CURBAL=CURBAL+$P(ARBAL,U,X)
"RTN","RCRCREC2",71,0)
 I +CURBAL'=+$P(ARLN,U,6) S ERR("MR3",7)=CURBAL
"RTN","RCRCREC2",72,0)
 I $P(RCLN,U,7)]"",$P(ARLN,U,7)'=$P(RCLN,U,7) S ERR("MR3",9)=""
"RTN","RCRCREC2",73,0)
 I $O(ERR("MR3",0)) S MTYP="MR3" G MR34A
"RTN","RCRCREC2",74,0)
 S MTYP="MR4" D L433^RCRCREC3 I $O(ERR("MR4",0)) S RCLN=""
"RTN","RCRCREC2",75,0)
 I '$O(ERR("MR4",0)) G MR34B
"RTN","RCRCREC2",76,0)
MR34A K ERR("MR3",3) D SET^RCRCREC3
"RTN","RCRCREC2",77,0)
MR34B K ^TMP("PRCA",$J,$P(ARLN,U,1)),^XTMP(RCXTYP,RCXMZ,RCI)
"RTN","RCRCREC2",78,0)
MR34Q Q
"RTN","RCRCREC2",79,0)
 ;
"RTN","RCRCREC2",80,0)
MR2 ;MR2 BILL IS AT RC AS REFERRED BUT NOT IN AR AS REFERRED
"RTN","RCRCREC2",81,0)
 N BN,MTYP,REFDT,RCBN0,RFDT S MTYP="MR2"
"RTN","RCRCREC2",82,0)
 I $P(RCLN,U,1)="" S ERR("MR2",1)="" G MR2A
"RTN","RCRCREC2",83,0)
 I '$D(^PRCA(430,"B",$P(RCLN,U,1))) S ERR("MR2",1)="" G MR2A
"RTN","RCRCREC2",84,0)
 S BN=$O(^PRCA(430,"B",$P(RCLN,U,1),0)) S RCBN0=^PRCA(430,BN,0)
"RTN","RCRCREC2",85,0)
 I $P(RCBN0,U,8)'=16 S ERR("MR2",2)=$P($G(^PRCA(430.3,+$P(RCBN0,U,8),0)),"^",1) G MR2A
"RTN","RCRCREC2",86,0)
 I RCXTYP="PRCADR1",$P(RCBN0,U,2)'=9 S ERR("MR2",6)=$P($G(^PRCA(430.2,+$P(RCBN0,U,2),0)),"^",1) G MR2A
"RTN","RCRCREC2",87,0)
 ;I '$G(RCCAT(+$P(RCBN0,U,2))) S ERR("MR2",6)=$P($G(^PRCA(430.2,+$P(RCBN0,U,2),0)),U,1) G MR2A
"RTN","RCRCREC2",88,0)
 S RFDT=$P($G(^PRCA(430,BN,6)),U,4) I RFDT="" S ERR("MR2",5)="" G MR2A
"RTN","RCRCREC2",89,0)
 I '$D(^PRCA(430,"AD",RFDT,BN)) S ^PRCA(430,"AD",RFDT,BN)="" G MR2B
"RTN","RCRCREC2",90,0)
 G MR2B
"RTN","RCRCREC2",91,0)
MR2A D SET^RCRCREC3
"RTN","RCRCREC2",92,0)
MR2B K ^XTMP(RCXTYP,RCXMZ,RCI)
"RTN","RCRCREC2",93,0)
MR2Q Q
"RTN","RCRCREC2",94,0)
 ;
"RTN","RCRCREC2",95,0)
MR1 ;BILLS REFERRED IN AR NOT IN RC
"RTN","RCRCREC2",96,0)
 N ARBAL,BN,CURBAL,ERR,I,MTYP,RCBNAM,REFDT,X
"RTN","RCRCREC2",97,0)
 S RCLN="",RCI="",MTYP="MR1"
"RTN","RCRCREC2",98,0)
 S RCBNAM="" F I=1:1 S RCBNAM=$O(^TMP("PRCA",$J,RCBNAM)) Q:'RCBNAM  D
"RTN","RCRCREC2",99,0)
 .S BN=$O(^TMP("PRCA",$J,RCBNAM,0))
"RTN","RCRCREC2",100,0)
 .I $O(RCDIV(0)),('$D(RCDIV("RCDOMAIN",RCDOMNM,$$DIV^IBJDF2(+BN)))) Q
"RTN","RCRCREC2",101,0)
 .S ARLN=^TMP("PRCA",$J,RCBNAM,BN)
"RTN","RCRCREC2",102,0)
MR1A .D SET^RCRCREC3
"RTN","RCRCREC2",103,0)
 .K ^TMP("PRCA",$J,RCBNAM)
"RTN","RCRCREC2",104,0)
MR1Q Q
"RTN","RCRCREC2",105,0)
 ;
"RTN","RCRCREC2",106,0)
 ;
"RTN","RCRCREC2",107,0)
 ;
"RTN","RCRCREC2",108,0)
 ;
"RTN","RCRCREC2",109,0)
 ;RCRCREC2
"RTN","RCRCRR")
0^9^B18602808
"RTN","RCRCRR",1,0)
RCRCRR ;ALB/CMS - RC RECONCILIATION DRIVER ; 16-JUN-00
"RTN","RCRCRR",2,0)
V ;;4.5;Accounts Receivable;**61,63,147,159**;Mar 20, 1995
"RTN","RCRCRR",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCRR",4,0)
 Q
"RTN","RCRCRR",5,0)
RRR ;Request Reconciliation Rollup from RC option entry point
"RTN","RCRCRR",6,0)
 N DIR,DTOUT,DUOUT,DIRUT,DIROUT,RCBDT,RCCAT,RCDIV,RCDOM,RCEDT,RCI,RCJOB,RCSITE,RCSUB,RCWHO,X,X1,XMDUZ,XMSUB,XMTEXT,XMZ,X,Y
"RTN","RCRCRR",7,0)
 W !!!,"  This option will send a Reconciliation Roll-up mail message request to your"
"RTN","RCRCRR",8,0)
 W !,"  supporting Regional Counsel office.  Using this option is not CPU intensive."
"RTN","RCRCRR",9,0)
 W !,"  Four mail messages each containing a different report will be sent"
"RTN","RCRCRR",10,0)
 W !,"  to the RC RC REFERRALS mail group at this site and the RC office"
"RTN","RCRCRR",11,0)
 W !,"  containing the outcome of the referral comparison. The messages may"
"RTN","RCRCRR",12,0)
 W !,"  take up to a day to be delivered since it relies on Mailman delivery"
"RTN","RCRCRR",13,0)
 W !,"  system response time at your Medical Center and your supporting RC office."
"RTN","RCRCRR",14,0)
 W !!
"RTN","RCRCRR",15,0)
 S DIR("A")="Continue with Request",DIR(0)="Y",DIR("B")="NO" D ^DIR
"RTN","RCRCRR",16,0)
 I ($D(DIRUT))!($D(DIROUT)) G RRRQ
"RTN","RCRCRR",17,0)
 I Y'=1 G RRRQ
"RTN","RCRCRR",18,0)
 ;
"RTN","RCRCRR",19,0)
CAT W !! S RCCAT="RR1"
"RTN","RCRCRR",20,0)
 ;W !!,"AR Category to include in Roll-up Request"
"RTN","RCRCRR",21,0)
 ;W !,"1.  Reimbursable Health",!,"2.  Worker's Comp, Tort Feasor and No-Fault Auto."
"RTN","RCRCRR",22,0)
 ;R !!,"Select 1 or 2 : 1//",X:DTIME I ('$T)!(X["^") G RRRQ
"RTN","RCRCRR",23,0)
 ;I X=2 S RCCAT="RR2" G DT
"RTN","RCRCRR",24,0)
 ;I (X="")!(X=1) S RCCAT="RR1" G DT
"RTN","RCRCRR",25,0)
 ;W !!,"You must select a Category or enter '^' to exit." G CAT
"RTN","RCRCRR",26,0)
 ;
"RTN","RCRCRR",27,0)
DT ;  Get date range for Report 4 of 4
"RTN","RCRCRR",28,0)
 W !!,"Report (4 of 4) Bills in AR and RC with same Dollar amount HOWEVER,"
"RTN","RCRCRR",29,0)
 W !," a Contract/Decrease adjustment was made before the Referral Date."
"RTN","RCRCRR",30,0)
 W !!,"This report is for you to review and determine the validity of the adjustment."
"RTN","RCRCRR",31,0)
 W !,"Select the Referral Date range for referred bills that have a decrease"
"RTN","RCRCRR",32,0)
 W !,"adjustment made prior to the bill referral date."
"RTN","RCRCRR",33,0)
 W !!,"  Adjusted bills or bills with valid decreases will continue to"
"RTN","RCRCRR",34,0)
 W !,"  display in the same selected Referral Date time frame."
"RTN","RCRCRR",35,0)
BDT W ! S %DT="AEPX",%DT(0)=-DT,%DT("A")="Start with Referral Date: " D ^%DT K %DT
"RTN","RCRCRR",36,0)
 G RRRQ:Y<0 S RCBDT=Y
"RTN","RCRCRR",37,0)
 W ! S %DT="AEPX",%DT(0)=RCBDT,%DT("A")="End with Referral Date: " D ^%DT K %DT
"RTN","RCRCRR",38,0)
 G RRRQ:Y<0 S RCEDT=Y
"RTN","RCRCRR",39,0)
 ;
"RTN","RCRCRR",40,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCRR",41,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCRR",42,0)
 I $O(RCDIV(0)) S RCI=0 F  S RCI=$O(RCDIV(RCI)) Q:'RCI  D
"RTN","RCRCRR",43,0)
 .S RCDOM=$P(RCDIV(RCI),U,6)
"RTN","RCRCRR",44,0)
 .D SEND
"RTN","RCRCRR",45,0)
 E  S RCDOM=$$RCDOM^RCRCUTL D SEND
"RTN","RCRCRR",46,0)
RRRQ Q
"RTN","RCRCRR",47,0)
 ;
"RTN","RCRCRR",48,0)
SEND ;Called with user supplied date range
"RTN","RCRCRR",49,0)
 S (RCSUB,XMSUB)="AR/RC -"_RCSITE_" Reconciliation Roll-up Request ("_$S(RCCAT="RR1":"RI)",1:"WC,TF,NA)")
"RTN","RCRCRR",50,0)
 S X1(1)="$$RC$"_RCCAT_"$$"_RCSITE_"$S.RC RC SERV"
"RTN","RCRCRR",51,0)
 S X1(2)="$END$1$"_RCBDT_"$"_RCEDT
"RTN","RCRCRR",52,0)
 S XMTEXT="X1("
"RTN","RCRCRR",53,0)
 S RCWHO=RCDOM
"RTN","RCRCRR",54,0)
 S XMY(RCWHO)="",XMY(DUZ)=""
"RTN","RCRCRR",55,0)
 D ^XMD I XMZ<1 W !!,"** Mail message not created. Please Try Again. **" G RRRQ
"RTN","RCRCRR",56,0)
 W !!,"Request sent to "_RCDOM_" in Mail Message #("_XMZ_").",!
"RTN","RCRCRR",57,0)
 D ENT^RCRCXMS(XMZ,RCSUB,RCWHO)
"RTN","RCRCRR",58,0)
SENDQ Q
"RTN","RCRCRR",59,0)
 ;
"RTN","RCRCRR",60,0)
TASK ;Task the RC background job from the RC Server
"RTN","RCRCRR",61,0)
 ;Called from RCRCSVR
"RTN","RCRCRR",62,0)
 N I,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSK,ZTSAVE,%,%I,%H,X,Y
"RTN","RCRCRR",63,0)
 I $P($G(RCVAR),U,6)="" G TASKQ
"RTN","RCRCRR",64,0)
 D NOW^%DTC S ZTDTH=%
"RTN","RCRCRR",65,0)
 S ZTRTN=$P(RCVAR,U,6),ZTDESC=$P(RCVAR,U,4),ZTIO=""
"RTN","RCRCRR",66,0)
 F I="RCSITE","RCBDT","RCEDT","RCJOB","RCXTYP","RCVAR","RCXMY","RCXMZ" S ZTSAVE(I)=""
"RTN","RCRCRR",67,0)
 D ^%ZTLOAD
"RTN","RCRCRR",68,0)
TASKQ Q
"RTN","RCRCRR",69,0)
 ;
"RTN","RCRCRR",70,0)
BKTSK(RCCAT) ;This entry point is called from the scheduled options
"RTN","RCRCRR",71,0)
 ;to send a Reconciliation request to RC
"RTN","RCRCRR",72,0)
 ;Input: RR1=Reimburs.Health  RR2=NON-Reimburs.Health
"RTN","RCRCRR",73,0)
 N RCSITE,RCSUB,RCDOM,RCDIV,RCWHO,RCI,X1,XMCHAN,XMDUZ,XMSUB,XMTEXT,XMY,XMZ,X,Y
"RTN","RCRCRR",74,0)
 I ($G(RCCAT)'="RR1")&($G(RCCAT)'="RR2") G BKTSKQ
"RTN","RCRCRR",75,0)
 ;Line below should be removed when RC is ready to Reconcile Worker's Comp., Torts and No Fault AUTO
"RTN","RCRCRR",76,0)
 I $G(RCCAT)="RR2" G BKTSKQ
"RTN","RCRCRR",77,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCRR",78,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCRR",79,0)
 I $O(RCDIV(0)) S RCI=0 F  S RCI=$O(RCDIV(RCI)) Q:'RCI  D
"RTN","RCRCRR",80,0)
 .S RCDOM=$P(RCDIV(RCI),U,6)
"RTN","RCRCRR",81,0)
 .D BSND
"RTN","RCRCRR",82,0)
 E  S RCDOM=$$RCDOM^RCRCUTL D BSND
"RTN","RCRCRR",83,0)
 D PRG
"RTN","RCRCRR",84,0)
BKTSKQ Q
"RTN","RCRCRR",85,0)
 ;
"RTN","RCRCRR",86,0)
BSND ;Send with date values set to T-30
"RTN","RCRCRR",87,0)
 S XMCHAN=1
"RTN","RCRCRR",88,0)
BKTA S (RCSUB,XMSUB)="AR/RC -"_RCSITE_" Reconciliation Roll-up Request ("_$S(RCCAT="RR1":"RI)",1:"TF,WC,NA)")
"RTN","RCRCRR",89,0)
 S X1(1)="$$RC$"_RCCAT_"$$"_RCSITE_"$S.RC RC SERV"
"RTN","RCRCRR",90,0)
 S X1(2)="$END$1$"_$$FMADD^XLFDT(DT,-30)_"$"_DT
"RTN","RCRCRR",91,0)
 S XMTEXT="X1("
"RTN","RCRCRR",92,0)
 S RCWHO=RCDOM,XMY(RCWHO)="",XMY(DUZ)=""
"RTN","RCRCRR",93,0)
 D ^XMD I XMZ<1 G BKTA
"RTN","RCRCRR",94,0)
 D ENT^RCRCXMS(XMZ,RCSUB,RCWHO)
"RTN","RCRCRR",95,0)
BSNDQ Q
"RTN","RCRCRR",96,0)
 ;
"RTN","RCRCRR",97,0)
PRG ;Purge old entries in the File 349.3
"RTN","RCRCRR",98,0)
 N DA,DIK,RCI,X,Y
"RTN","RCRCRR",99,0)
 S DIK="^RCT(349.3,"
"RTN","RCRCRR",100,0)
 S RCI=0 F  S RCI=$O(^RCT(349.3,"AD",RCI)) Q:'RCI  D
"RTN","RCRCRR",101,0)
 .I RCI>DT Q
"RTN","RCRCRR",102,0)
 .S DA=0 F  S DA=$O(^RCT(349.3,"AD",RCI,DA)) Q:'DA  D ^DIK
"RTN","RCRCRR",103,0)
PRGQ Q
"RTN","RCRCRR",104,0)
 ;RCRCRR
"RTN","RCRCRT")
0^20^B58210816
"RTN","RCRCRT",1,0)
RCRCRT ;ALB/CMS - RC TRANSACTION PROC OVER INTERFACE ;8/27/97  11:01 AM
"RTN","RCRCRT",2,0)
V ;;4.5;Accounts Receivable;**63,147,168,169,189,159**;Mar 20, 1995
"RTN","RCRCRT",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCRT",4,0)
EN ;Enter at top with the Transaction Type from RC Server via Taskman
"RTN","RCRCRT",5,0)
 ;Create the AR Transaction or send Transaction/Comment LOG to RC.
"RTN","RCRCRT",6,0)
 ;Input: RCSITE,RCBDT,RCEDT,RCJOB,RCXTYP,RCVAR,RCXMY
"RTN","RCRCRT",7,0)
 ;Input: XTMP(RCXTYP,RCJOB,  
"RTN","RCRCRT",8,0)
 ;RCXTYP:
"RTN","RCRCRT",9,0)
 ;    CL   - Comment Log send all Comments to RC
"RTN","RCRCRT",10,0)
 ;    TR   - Send all Transactions to RC
"RTN","RCRCRT",11,0)
 ;    DA-1 - DA-3 Decrease Adj.,Bill Status Collected/Close,Contractual Adjustment Yes, Tran. Comment 
"RTN","RCRCRT",12,0)
 ;    DA-4 - Decrease Adj.,Bill Status Cancellation,Contractual Adjustment Yes, Tran. Comment 
"RTN","RCRCRT",13,0)
 ;    DA-5 - DA-10 Decrease Adj.,Bill Status Cancellation,Notify IB of Cancelation, Tran. Comment 
"RTN","RCRCRT",14,0)
 ;    TJ-1 - TJ-5 Termination by RC,Bill Status Write-off, Tran. Comment 
"RTN","RCRCRT",15,0)
 ;    RT   - Returned by RC/DOJ,Delete Referral Date in 430
"RTN","RCRCRT",16,0)
 ; 
"RTN","RCRCRT",17,0)
 N PRCABN,PRCABN0,RCAMT,RCCAT,RCBNAM,RCD,RCERR,RCFL,RCL,RCCMSG,RCTR,RCTYP,XMZ
"RTN","RCRCRT",18,0)
 K ^TMP("RCRCAT",$J,"XM") S RCCMSG=""
"RTN","RCRCRT",19,0)
 S RCXMZ=$P($G(^XTMP($G(RCXTYP,"UNK"),+$G(RCXMZ),0)),U,4) I 'RCXMZ G ENQ
"RTN","RCRCRT",20,0)
 S RCL=0 F  S RCL=$O(^XTMP(RCXTYP,RCXMZ,RCL)) Q:'RCL  S RCD=^(RCL) D
"RTN","RCRCRT",21,0)
 .I RCD["$$RC$" S RCTYP=$P(RCD,"$",4) Q
"RTN","RCRCRT",22,0)
 .I RCD["$END$" Q
"RTN","RCRCRT",23,0)
 .S RCBNAM=$P(RCD,U,1),RCAMT=+$P(RCD,U,2)
"RTN","RCRCRT",24,0)
 .S PRCABN=$O(^PRCA(430,"B",RCBNAM,0))
"RTN","RCRCRT",25,0)
 .I 'PRCABN S RCCMSG="E;Bill "_RCBNAM_" does not exist at this medical center" Q
"RTN","RCRCRT",26,0)
 .S RCD=$$REFST^RCRCUTL(PRCABN)
"RTN","RCRCRT",27,0)
 .I ('RCD)!("RCDCDOJ"'[$P(RCD,U,2)) S RCCMSG="E;Bill "_RCBNAM_" is not currently referred to RC." Q
"RTN","RCRCRT",28,0)
 .I (RCTYP="CL")!(RCTYP="TR") Q
"RTN","RCRCRT",29,0)
 .S PRCABN0=$G(^PRCA(430,PRCABN,0))
"RTN","RCRCRT",30,0)
 .I $P(PRCABN0,U,8)'=16 S RCCMSG="E;Bill "_RCBNAM_" is no longer Active at medical center." Q
"RTN","RCRCRT",31,0)
 .D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCRT",32,0)
 .I +$G(RCCAT(+$P(PRCABN0,U,2)))'=1 S RCCMSG="E;Bill "_RCBNAM_" Category is not electronically referred." Q
"RTN","RCRCRT",33,0)
 .I "TJDA"[$E(RCTYP,1,2) D
"RTN","RCRCRT",34,0)
 ..I RCAMT'=+$P(RCD,U,3) S RCCMSG="E;Bill "_RCBNAM_" for $"_RCAMT_" does not equal AR Referred Amount of $"_+$P(RCD,U,3)_". AR Site Problem!" Q
"RTN","RCRCRT",35,0)
 ..S RCD=+$P($$BILL^RCJIBFN2(PRCABN),U,3)
"RTN","RCRCRT",36,0)
 ..I RCAMT'=RCD S RCCMSG="E;Bill "_RCBNAM_" for $"_RCD_" does not equal the AR Current Balance. RC may need to Return Bill!" Q
"RTN","RCRCRT",37,0)
 ;
"RTN","RCRCRT",38,0)
 I RCCMSG]"" S XMZ=+RCXMZ D SEND^RCRCSRV G ENQ
"RTN","RCRCRT",39,0)
 ;
"RTN","RCRCRT",40,0)
 I (RCTYP="CL")!(RCTYP="TR") D TR G ENQ
"RTN","RCRCRT",41,0)
 ;
"RTN","RCRCRT",42,0)
 S RCTR=$S(RCTYP="RT":6,$E(RCTYP,1,2)="DA":35,$E(RCTYP,1,2)="TJ":29,1:0)
"RTN","RCRCRT",43,0)
 I RCTR D TRAN
"RTN","RCRCRT",44,0)
 ;
"RTN","RCRCRT",45,0)
ENQ K ^XTMP(RCXTYP,RCXMZ)
"RTN","RCRCRT",46,0)
 K RCSITE,RCBDT,RCEDT,RCJOB,RCXTYP,RCVAR,RCXMY,RCXMZ
"RTN","RCRCRT",47,0)
 Q
"RTN","RCRCRT",48,0)
 ;
"RTN","RCRCRT",49,0)
REF ;Entry point from Review/Refer Protocol
"RTN","RCRCRT",50,0)
 ;Refer to RC (3) or  Re-Establish to RC/DOJ (5) send to RC
"RTN","RCRCRT",51,0)
 ;Input: PRCABN, RCCOM (Optional)
"RTN","RCRCRT",52,0)
 N DA,DIE,DR,PRCAEN,RCBAL,RCI,RCTYP,RC7,X,Y,RCCOM1
"RTN","RCRCRT",53,0)
 S DA=PRCABN,DIC="^PRCA(430," D LCK^PRCAUPD
"RTN","RCRCRT",54,0)
 S RCCODE="RC"
"RTN","RCRCRT",55,0)
 S RCTYP=$S($P($G(^PRCA(430,PRCABN,6)),U,4):5,1:3)
"RTN","RCRCRT",56,0)
 S RCCOM1=$P($G(^PRCA(430,PRCABN,6)),U,22,23)
"RTN","RCRCRT",57,0)
 S:RCCOM1 RCCOM1=$$EXTERNAL^DILFD(430,68.94,"",$P(RCCOM1,"^"))_$S($L($P(RCCOM1,"^",2)):" - "_$P(RCCOM1,"^",2),1:"")
"RTN","RCRCRT",58,0)
 S RCBAL=0,RC7=$G(^PRCA(430,PRCABN,7))
"RTN","RCRCRT",59,0)
 F RCI=1:1:5 S RCBAL=RCBAL+$P(RC7,U,RCI)
"RTN","RCRCRT",60,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL I '$D(PRCAEN) G REFQ
"RTN","RCRCRT",61,0)
 S DA=PRCAEN,DIE="^PRCA(433,",DR="[PRCAC RC REFER]" D ^DIE
"RTN","RCRCRT",62,0)
 I $G(RCCOM)]"" D COM(PRCAEN,RCCOM)
"RTN","RCRCRT",63,0)
 S DR=$S(RCTYP=5:"68.2////"_DT_";",1:"")_"64////"_DT_";65////^S X=""RC"";66////"_RCBAL
"RTN","RCRCRT",64,0)
 S DA=PRCABN,DIE="^PRCA(430," D ^DIE
"RTN","RCRCRT",65,0)
REFQ L -^PRCA(430,PRCABN)
"RTN","RCRCRT",66,0)
 Q
"RTN","RCRCRT",67,0)
 ;
"RTN","RCRCRT",68,0)
COM(PRCAEN,RCCOM,ERR) ;Update AR Transaction Comments
"RTN","RCRCRT",69,0)
 N X,Y
"RTN","RCRCRT",70,0)
 I '$D(^PRCA(433,+$G(PRCAEN),0)) G COMQ
"RTN","RCRCRT",71,0)
 S COM(1,1)=RCCOM
"RTN","RCRCRT",72,0)
 S:$L($G(RCCOM1)) COM(1,2)=RCCOM1
"RTN","RCRCRT",73,0)
 D WP^DIE(433,PRCAEN_",",41,"A","COM(1)","ERR(0)")
"RTN","RCRCRT",74,0)
COMQ Q
"RTN","RCRCRT",75,0)
 ;
"RTN","RCRCRT",76,0)
INC ;Increase Referred TP Bill called by Protocol
"RTN","RCRCRT",77,0)
 N DA,DIE,DIR,DR,DTOUT,DUOUT,PRCA,PRCABN,PRCAEN,RCBAL,RCBN,RCEN,RCOUT,RCSP,RCY,X,Y
"RTN","RCRCRT",78,0)
 D FULL^VALM1
"RTN","RCRCRT",79,0)
 I '$O(^TMP("RCRCAL",$J,"SEL",0)) W !!,"NO SELECTED ITEMS FROM LIST!" G INCQ
"RTN","RCRCRT",80,0)
 W !! S DIR("A",1)="Increasing bill(s) on highlighted Selection List "
"RTN","RCRCRT",81,0)
 S DIR("A")="Okay to continue ",DIR("?")="Enter Yes to Continue"
"RTN","RCRCRT",82,0)
 D ASK^RCRCACP K DIR I $G(Y)'=1 G INCQ
"RTN","RCRCRT",83,0)
 S RCY=0 F  S RCY=$O(^TMP("RCRCAL",$J,"SEL",RCY)) Q:('RCY)!($G(RCOUT))  D
"RTN","RCRCRT",84,0)
 .   S PRCABN=+$P($G(^TMP("RCRCALX",$J,RCY)),U,2)
"RTN","RCRCRT",85,0)
 .   I '$D(^PRCA(430,PRCABN,0)) Q
"RTN","RCRCRT",86,0)
 .   W !!,?5,"Patient",?22,"Bill #",?33,"Cat.",?62,"Orig Amt",?72,"Cur Bal"
"RTN","RCRCRT",87,0)
 .   W !,$G(^TMP("RCRCAL",$J,RCY,0))
"RTN","RCRCRT",88,0)
 .   ;  get the balance before the adjustment
"RTN","RCRCRT",89,0)
 .   S RCBAL=+$P($$BILL^RCJIBFN2(PRCABN),U,3)
"RTN","RCRCRT",90,0)
 .   ;  create increase adjustment
"RTN","RCRCRT",91,0)
 .   D ADJBILL^RCBEADJ("INCREASE",PRCABN)
"RTN","RCRCRT",92,0)
 .   ;  get the balance after the adjustment
"RTN","RCRCRT",93,0)
 .   S X=+$P($$BILL^RCJIBFN2(PRCABN),U,3)
"RTN","RCRCRT",94,0)
 .   I RCBAL=X W !!,"** Bill not Increased **",! G INCX
"RTN","RCRCRT",95,0)
 .   S RCBAL=X,DA=PRCABN,DIE="^PRCA(430,",DR="66///^S X="_RCBAL D ^DIE
"RTN","RCRCRT",96,0)
 .   S RCSP="",RCBAL=$J(RCBAL,".",2),$E(RCSP,10-$L($E(RCBAL,1,10)))=" ",RCBAL=RCSP_RCBAL
"RTN","RCRCRT",97,0)
 .   D FLDTEXT^VALM10(RCY,"CURAMT",RCBAL)
"RTN","RCRCRT",98,0)
 .   I '$G(PRCAEN) S PRCAEN=$O(^PRCA(433,"C",PRCABN,9999999),-1)
"RTN","RCRCRT",99,0)
 .   D PF^RCRCAT("I")
"RTN","RCRCRT",100,0)
INCX .   K DIR,PRCA,PRCAEN
"RTN","RCRCRT",101,0)
 .   I '$O(^TMP("RCRCAL",$J,"SEL",RCY)) Q
"RTN","RCRCRT",102,0)
 .   W !! S DIR("A")="Continue Increasing Selected Bills ",DIR("?")="Enter Yes to Continue to next bill"
"RTN","RCRCRT",103,0)
 .   D ASK^RCRCACP K DIR I $G(Y)'=1 S RCOUT=1
"RTN","RCRCRT",104,0)
 ;
"RTN","RCRCRT",105,0)
INCQ K DIR D PAUSE^VALM1 S VALMBCK="R"
"RTN","RCRCRT",106,0)
 Q
"RTN","RCRCRT",107,0)
 ;
"RTN","RCRCRT",108,0)
TR ;Send Transactions or Comment Log to RC for bill
"RTN","RCRCRT",109,0)
 N PRCA,PRCAEN,RCI,RCXCNT,X,Y,RCSITE,RCDOM,RCBDIV,RCDIV S RCXCNT=0
"RTN","RCRCRT",110,0)
 D BNVAR^RCRCUTL(PRCABN)
"RTN","RCRCRT",111,0)
 D DEBT^RCRCUTL(PRCABN)
"RTN","RCRCRT",112,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCRT",113,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCRT",114,0)
 S PRCAEN=0 F  S PRCAEN=$O(^PRCA(433,"C",PRCABN,PRCAEN)) Q:'PRCAEN  D
"RTN","RCRCRT",115,0)
 .I RCTYP="CL",$P($G(^PRCA(433,PRCAEN,1)),U,2)'=45 Q
"RTN","RCRCRT",116,0)
 .D SET^RCRCAT1
"RTN","RCRCRT",117,0)
 ;
"RTN","RCRCRT",118,0)
 I '$O(^TMP("RCRCAT",$J,"XM",PRCABN,0)) D
"RTN","RCRCRT",119,0)
 .S ^TMP("RCRCAT",$J,"XM",PRCABN,1,1)="BN1^"_PRCA("BNAME")_U_PRCA("DEBTNM")
"RTN","RCRCRT",120,0)
 .S ^TMP("RCRCAT",$J,"XM",PRCABN,1,2)="TR1^0^0"
"RTN","RCRCRT",121,0)
 .S ^TMP("RCRCAT",$J,"XM",PRCABN,1,3)="COMMENT: No "_$S(RCTYP="CL":"Comment ",1:"")_"Transactions at site for Bill "_PRCA("BNAME")_"."
"RTN","RCRCRT",122,0)
 I $G(RCDIV(0)) S RCBDIV=$$DIV^IBJDF2(PRCABN) S X=0 F  S X=$O(RCDIV(X)) Q:'X  D
"RTN","RCRCRT",123,0)
 .I X=+RCBDIV S RCDOM=$P(RCDIV(X),"^",6)
"RTN","RCRCRT",124,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCRCRT",125,0)
 D SEND^RCRCAT
"RTN","RCRCRT",126,0)
 K ^TMP("RCRCAT",$J,"XM")
"RTN","RCRCRT",127,0)
TRQ Q
"RTN","RCRCRT",128,0)
 ;
"RTN","RCRCRT",129,0)
TRAN ;Process Termination, Returned and Decrease Transactions from RC
"RTN","RCRCRT",130,0)
 ;Input: PRCABN,PRCABN0,RCTYP,RCBNAM,RCAMT,RCTR=6,29 or 35
"RTN","RCRCRT",131,0)
 ;  
"RTN","RCRCRT",132,0)
 N DA,DIC,DIE,DR,LN,PRCA,PRCAA2,PRCAEN,PRCAQNM,X,XMCHAN,XMZ,XMY,XMDUZ,XMSUB,XMTEXT,Y
"RTN","RCRCRT",133,0)
 N RCAMT,RCAD,RCCA,RCCC,RCCOM,RCDT,RCERR,RCI,RCIB,RCMF,RCO,RCPB
"RTN","RCRCRT",134,0)
 S DA=PRCABN,DIC="^PRCA(430,",XMCHAN=1 D LCK^PRCAUPD
"RTN","RCRCRT",135,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL I '$D(PRCAEN) Q
"RTN","RCRCRT",136,0)
 S RCI=$O(^RCT(349.4,"B",RCTYP,0)),RCI=$G(^RCT(349.4,+RCI,0))
"RTN","RCRCRT",137,0)
 S PRCA("STATUS")=$P(RCI,U,3),RCCA=$P(RCI,U,4),RCDT=DT
"RTN","RCRCRT",138,0)
 S RCAMT=0,RCI=$G(^PRCA(430,PRCABN,7))
"RTN","RCRCRT",139,0)
 F X=1:1:5 S RCAMT=RCAMT+$P(RCI,U,X)
"RTN","RCRCRT",140,0)
 S RCPB=$P(RCI,U,1),RCIB=$P(RCI,U,2),RCAD=$P(RCI,U,3),RCMF=$P(RCI,U,4),RCCC=$P(RCI,U,5)
"RTN","RCRCRT",141,0)
 I RCTR=35 S RCAMT=-RCAMT
"RTN","RCRCRT",142,0)
 S DA=PRCAEN,DIE="^PRCA(433,",DR="[PRCAC RC TRAN]" D ^DIE
"RTN","RCRCRT",143,0)
 S RCCOM=RCTYP_" Transaction created electronically by local Regional Counsel Office"
"RTN","RCRCRT",144,0)
 D COM(PRCAEN,RCCOM)
"RTN","RCRCRT",145,0)
 S DA=PRCAEN,DR="7///^S X=""RC""",DIE="^PRCA(433," D ^DIE
"RTN","RCRCRT",146,0)
 ;
"RTN","RCRCRT",147,0)
 ;If action is not a Returned by RC/DOJ
"RTN","RCRCRT",148,0)
 I RCTR'=6 D
"RTN","RCRCRT",149,0)
 .S RCI=$P($G(^PRCA(430,PRCABN,6)),U,5)
"RTN","RCRCRT",150,0)
 .I RCI="DC" S $P(^PRCA(430,PRCABN,6),U,5)="RC"
"RTN","RCRCRT",151,0)
 .D UPSTATS^PRCAUT2
"RTN","RCRCRT",152,0)
 .S PRCAA2=$G(^PRCA(433,PRCAEN,4,0))
"RTN","RCRCRT",153,0)
 .I $P(PRCAA2,U,4) D
"RTN","RCRCRT",154,0)
 ..S PRCAA2=$P(PRCAA2,U,3)
"RTN","RCRCRT",155,0)
 ..S $P(^PRCA(433,PRCAEN,4,PRCAA2,0),U,2,5)=RCAMT_"^^1^"_RCAMT
"RTN","RCRCRT",156,0)
 ;
"RTN","RCRCRT",157,0)
 ;If action is a Decrease
"RTN","RCRCRT",158,0)
 I RCTR=35 D  G TRANQ
"RTN","RCRCRT",159,0)
 .S DA=PRCABN,DIE="^PRCA(430,"
"RTN","RCRCRT",160,0)
 .S DR="71///^S X=0;72///^S X=0;73///^S X=0;74///^S X=0;75///^S X=0" D ^DIE
"RTN","RCRCRT",161,0)
 .S PRCAQNM=1 D EN1^PRCADJ
"RTN","RCRCRT",162,0)
 .S DA=PRCAEN,DIE="^PRCA(433,",DR="14////^S X="_+PRCAQNM
"RTN","RCRCRT",163,0)
 .I RCCA S DR=DR_";88////1"
"RTN","RCRCRT",164,0)
 .D ^DIE
"RTN","RCRCRT",165,0)
 .I RCCA=1 D
"RTN","RCRCRT",166,0)
 ..S RCO=$P(^PRCA(430,PRCABN,0),U,3),RCAMT=RCO+RCAMT
"RTN","RCRCRT",167,0)
 ..D BULL^IBCNSBL2(PRCABN,RCO,$$PAID^PRCAFN1(+PRCABN))
"RTN","RCRCRT",168,0)
 .I '$$ACCK^PRCAACC(PRCABN),'($P($G(^PRCA(433,+PRCAEN,8)),U,8)) D
"RTN","RCRCRT",169,0)
 ..D EN^PRCAFBDM(PRCABN,RCAMT,RCTR,RCDT,PRCAEN,.RCERR)
"RTN","RCRCRT",170,0)
 .L -^PRCA(430,PRCABN)
"RTN","RCRCRT",171,0)
 ;
"RTN","RCRCRT",172,0)
 ;If action is a Returned by RC/DOJ
"RTN","RCRCRT",173,0)
RT I RCTR=6 D  G TRANQ
"RTN","RCRCRT",174,0)
 .S DA=PRCABN,DIE="^PRCA(430,"
"RTN","RCRCRT",175,0)
 .S DR="64///@;65///@;66///@;68.3///^S X="_RCDT D ^DIE
"RTN","RCRCRT",176,0)
 .S DA=PRCAEN,DIE="^PRCA(433,",DR="81///^S X="_RCAMT D ^DIE
"RTN","RCRCRT",177,0)
 .L -^PRCA(430,PRCABN)
"RTN","RCRCRT",178,0)
 .S XMDUZ="ACCOUNTS RECEIVABLE RC SERVER",XMSUB="AR/RC - REFERRED AR BILL RETURNED BY RC"
"RTN","RCRCRT",179,0)
 .S XMY("G.RC RC REFERRALS")=""
"RTN","RCRCRT",180,0)
 .S LN(1)="  Referred TP Bill "_$P(^PRCA(430,PRCABN,0),U,1)_" was returned"
"RTN","RCRCRT",181,0)
 .S LN(2)="  by Regional Counsel.  Return MAY be because"
"RTN","RCRCRT",182,0)
 .S LN(3)="  of a reconciliation issue."
"RTN","RCRCRT",183,0)
 .S XMTEXT="LN(" D ^XMD
"RTN","RCRCRT",184,0)
 ;
"RTN","RCRCRT",185,0)
 ;If action is Termination by RC/DOJ
"RTN","RCRCRT",186,0)
 I RCTR=29 D  G TRANQ
"RTN","RCRCRT",187,0)
 .S DA=PRCAEN,DIE="^PRCA(433,",DR="17///9;81///^S X="_RCAMT D ^DIE
"RTN","RCRCRT",188,0)
 .I '$$ACCK^PRCAACC(PRCABN) D FMSDOC^RCWROFF(PRCAEN)
"RTN","RCRCRT",189,0)
 .L -^PRCA(430,PRCABN)
"RTN","RCRCRT",190,0)
 ;
"RTN","RCRCRT",191,0)
TRANQ Q
"RTN","RCRCRT",192,0)
 ;RCRCRT
"RTN","RCRCSRV")
0^10^B19936486
"RTN","RCRCSRV",1,0)
RCRCSRV ;ALB/CMS - RC SERVER DRIVER ; 16-JUN-00
"RTN","RCRCSRV",2,0)
V ;;4.5;Accounts Receivable;**61,87,63,147,159**;Mar 20, 1995
"RTN","RCRCSRV",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCSRV",4,0)
SERVER ;RC RC SERV SERVER OPTION MAIN ENTRY POINT
"RTN","RCRCSRV",5,0)
 ;INPUT  : Mailman variables
"RTN","RCRCSRV",6,0)
 ;OUTPUT : Sets the XTMP global for certain types of message
"RTN","RCRCSRV",7,0)
 ;       : Sets the task job in the background if appropriate
"RTN","RCRCSRV",8,0)
 ;       : Adds Confirmation or Error to AR Transmission File
"RTN","RCRCSRV",9,0)
 ;
"RTN","RCRCSRV",10,0)
 Q:$G(XMZ)=""  Q:'$D(^XMB(3.9,XMZ))
"RTN","RCRCSRV",11,0)
 S XMXX="S.RC RC SERV",XMCHAN=1
"RTN","RCRCSRV",12,0)
 D SETSB^XMA1C ;Save message in postmaster server basket
"RTN","RCRCSRV",13,0)
 N RCBDT,RCCMSG,RCDOM,RCEDT,RCJOB,RCSCE,RCSTA,RCTYP,RCVAR,RCSITE,RCXMY,RCXMZ,RCXTYP
"RTN","RCRCSRV",14,0)
 S RCXMZ=XMZ,RCJOB=$J
"RTN","RCRCSRV",15,0)
 D READ
"RTN","RCRCSRV",16,0)
 D SEND
"RTN","RCRCSRV",17,0)
 D TASK
"RTN","RCRCSRV",18,0)
 S XMZ=RCXMZ,XMSER="S.RC RC SERV" D REMSBMSG^XMA1C
"RTN","RCRCSRV",19,0)
 K XMCHAN,XMDUZ,XMDUN,XMFROM,XMREC,XMSER,XMXX,XMY,XMZ
"RTN","RCRCSRV",20,0)
Q Q
"RTN","RCRCSRV",21,0)
 ;
"RTN","RCRCSRV",22,0)
READ ;READ TRANSMISSION CHK FIRST LINE PUT MESSAGE IN XTMP
"RTN","RCRCSRV",23,0)
 N II,RCEND,RCNT,XMRG,XMER,X2
"RTN","RCRCSRV",24,0)
 S RCNT=0,RCCMSG="",RCSITE=$$SITE^RCMSITE,RCDOM=$G(XMFROM)
"RTN","RCRCSRV",25,0)
 F II=0:0 D  Q:$G(RCCMSG)]""
"RTN","RCRCSRV",26,0)
 .X XMREC S RCNT=RCNT+1
"RTN","RCRCSRV",27,0)
 .I $G(XMER)<0 D  Q
"RTN","RCRCSRV",28,0)
 ..I $G(RCEND)="" S RCCMSG="E;Incomplete message from Regional Counsel"
"RTN","RCRCSRV",29,0)
 ..E  S RCCMSG="C;AR accepted "_RCNT_" lines successfully."
"RTN","RCRCSRV",30,0)
 ..S RCBDT=$P($G(RCEND),"$",4),RCEDT=$P($G(RCEND),"$",5)
"RTN","RCRCSRV",31,0)
 ..; I +$P(RCVAR,U,5),$D(^XTMP(RCXTYP,RCJOB,0)) S $P(^XTMP(RCXTYP,RCJOB,0),"^",5)=RCNT
"RTN","RCRCSRV",32,0)
 .I RCNT=1 D CHK1 I $G(RCCMSG)]"" Q
"RTN","RCRCSRV",33,0)
 .I ($P(XMRG,"$",2)="END")!($P(XMRG,"$",3)="END") S RCEND=XMRG S RCNT=RCNT-1 Q
"RTN","RCRCSRV",34,0)
 .I '$L(XMRG) S RCNT=RCNT-1 Q
"RTN","RCRCSRV",35,0)
 .I +$P(RCVAR,U,5) S ^XTMP(RCXTYP,RCXMZ,RCNT)=XMRG
"RTN","RCRCSRV",36,0)
 Q
"RTN","RCRCSRV",37,0)
 ;
"RTN","RCRCSRV",38,0)
SEND ;CONFIRMATION, ERROR, ORIGINAL MESSAGE TRANSPORT
"RTN","RCRCSRV",39,0)
 ;I message is the original send confirmation or error to RC
"RTN","RCRCSRV",40,0)
 ;INPUT: RCCMSG from Read module always set
"RTN","RCRCSRV",41,0)
 ;       RCVAR if exists
"RTN","RCRCSRV",42,0)
 ;I message is a Confirmation or Error from RC to site quit
"RTN","RCRCSRV",43,0)
 I $P(RCCMSG,";",1)="Q" G SENDQ
"RTN","RCRCSRV",44,0)
 S RETRY=0
"RTN","RCRCSRV",45,0)
 ;
"RTN","RCRCSRV",46,0)
XMB N LN,RCCOM,RCSUB,RCWHO,RETRY,XMDUZ,XMSUB,XMTEXT,XMY,X,Y
"RTN","RCRCSRV",47,0)
 ;Line below may not be needed
"RTN","RCRCSRV",48,0)
 ;I confirmation don't send to anyone.
"RTN","RCRCSRV",49,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCRCSRV",50,0)
 S:$G(XMFROM)]"" XMY(XMFROM)=""
"RTN","RCRCSRV",51,0)
 ;S RCWHO="S.RC RC SERV@"_RCDOM,XMY(RCWHO)=""
"RTN","RCRCSRV",52,0)
 S RCWHO=RCDOM,XMY(RCWHO)=""
"RTN","RCRCSRV",53,0)
 S Y=DT D D^DIQ
"RTN","RCRCSRV",54,0)
 S LN(1)="$$RC$"_$G(RCTYP,"UNK")_"$"_$E(RCCMSG,1)_"$"_$G(RCSITE,"UNK")_"$"
"RTN","RCRCSRV",55,0)
 S LN(2)="Status: Mail Message #("_XMZ_") received at the VAMC "_$G(RCSITE,"UNK")_" system on "_Y
"RTN","RCRCSRV",56,0)
 S LN(3)=$S($E(RCCMSG,1)="E":"Error ",1:"")_"Message: "_$P(RCCMSG,";",2)
"RTN","RCRCSRV",57,0)
 S LN(4)="Desc.: "_$P($G(RCVAR),U,4)
"RTN","RCRCSRV",58,0)
 S (RCSUB,XMSUB)="AR/RC - "_$G(RCSITE,"UNK")_" "_$S($E(RCCMSG,1)="C":"CONFIRMATION ("_$G(RCTYP,"UNK")_")",1:"TRANSMISSION ("_$G(RCTYP,"UNK")_") ERROR")_" MESSAGE"
"RTN","RCRCSRV",59,0)
 S XMTEXT="LN(",XMDUZ="ACCOUNTS RECEIVABLE RC SERVER"
"RTN","RCRCSRV",60,0)
 D ^XMD I XMZ<1 S RETRY=RETRY+1 I RETRY<100 G XMB
"RTN","RCRCSRV",61,0)
 S RCCOM=LN(3)
"RTN","RCRCSRV",62,0)
 D ENT^RCRCXMS(XMZ,RCSUB,RCWHO,RCCOM)
"RTN","RCRCSRV",63,0)
SENDQ Q
"RTN","RCRCSRV",64,0)
 ;
"RTN","RCRCSRV",65,0)
CHK1 ;CHECK FIRST LINE OF TRANSMISSION
"RTN","RCRCSRV",66,0)
 ;First Line Syntax: 
"RTN","RCRCSRV",67,0)
 ;$$RC$S1$$sta#prefix$RC Address
"RTN","RCRCSRV",68,0)
 ;  o first four characters must be $$RC$
"RTN","RCRCSRV",69,0)
 ;  o $ piece 4 required must be a server code in routine RCRCVAR
"RTN","RCRCSRV",70,0)
 ;  o $ piece 5 will be "C" for a confirmation message or
"RTN","RCRCSRV",71,0)
 ;                      "E" for error receiving the message
"RTN","RCRCSRV",72,0)
 ;                       "" for the original transmission of a message 
"RTN","RCRCSRV",73,0)
 ;  o $ piece 6 station number 
"RTN","RCRCSRV",74,0)
 ;  o $ piece 7 is the RC address to send back to at RCDOM
"RTN","RCRCSRV",75,0)
 ;Last Line Syntax: $END$#oflines$
"RTN","RCRCSRV",76,0)
 ;                  $END$#oflines$Beg.Ref.DT$End.Ref.DT (Rec Rept. 4 of 4)
"RTN","RCRCSRV",77,0)
 ; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
"RTN","RCRCSRV",78,0)
 ;INPUT:  XMRG - First line of mail message
"RTN","RCRCSRV",79,0)
 ;OUTPUT: RCVAR - Server Code^(C,E,O)^Recipient^desc.^0or1^taskroutine
"RTN","RCRCSRV",80,0)
 ;        or Killed
"RTN","RCRCSRV",81,0)
 ;        RCCMSG - Error message
"RTN","RCRCSRV",82,0)
 ;        RCSTA - Station Number
"RTN","RCRCSRV",83,0)
 ;        RCXMY - send message to
"RTN","RCRCSRV",84,0)
 ;        RCJOB - $J
"RTN","RCRCSRV",85,0)
 ;        
"RTN","RCRCSRV",86,0)
 I $E(XMRG,1,5)'="$$RC$" S RCCMSG="E;RC Server at site is unable to interpret the first line of this message." G CHK1Q
"RTN","RCRCSRV",87,0)
 S RCSCE=$P(XMRG,"$",5) S RCSCE=$S(RCSCE="C":RCSCE,RCSCE="E":RCSCE,RCSCE="":"O",1:"UNK")
"RTN","RCRCSRV",88,0)
 S RCTYP=$P(XMRG,"$",4),RCVAR=$$CHK^RCRCVAR(RCTYP,RCSCE)
"RTN","RCRCSRV",89,0)
 I $P(RCVAR,";",1)="E" S RCCMSG=RCVAR K RCVAR G CHK1Q
"RTN","RCRCSRV",90,0)
 S RCSTA=$P(XMRG,"$",6)
"RTN","RCRCSRV",91,0)
 S RCXMY=$P(XMRG,"$",7)
"RTN","RCRCSRV",92,0)
 S RCDOM=$G(XMFROM)
"RTN","RCRCSRV",93,0)
 ; If original message needs an XTMP global initialize it 
"RTN","RCRCSRV",94,0)
 I +$P(RCVAR,U,5) D XTMP(RCTYP,$P(RCVAR,U,4))
"RTN","RCRCSRV",95,0)
 D FILE
"RTN","RCRCSRV",96,0)
 I "CE"[RCSCE S RCCMSG="Q;"
"RTN","RCRCSRV",97,0)
CHK1Q Q
"RTN","RCRCSRV",98,0)
 ;
"RTN","RCRCSRV",99,0)
TASK ;If message is original fire off the background job
"RTN","RCRCSRV",100,0)
 ;fire off the background task now. (The time the server is run.)
"RTN","RCRCSRV",101,0)
 I $G(RCSCE)="O",$E($G(RCCMSG),1)'="E" D TASK^RCRCRR
"RTN","RCRCSRV",102,0)
TASKQ Q
"RTN","RCRCSRV",103,0)
 ;
"RTN","RCRCSRV",104,0)
FILE ;Update AR Transmission File
"RTN","RCRCSRV",105,0)
 N DA,DIE,DR,RCCOM,RCX,X,Y
"RTN","RCRCSRV",106,0)
 I RCSCE="O" D  G FILEQ
"RTN","RCRCSRV",107,0)
   . S RCSUB=$$SUBGET^XMGAPI0(RCXMZ)
"RTN","RCRCSRV",108,0)
   . S RCCOM="RC sent Request Action ("_RCTYP_")."
"RTN","RCRCSRV",109,0)
   . D ENT^RCRCXMS(RCXMZ,$G(RCSUB),"RC SERVER AT "_RCSTA,RCCOM)
"RTN","RCRCSRV",110,0)
 ;If Message is a Confirm or Error from RC
"RTN","RCRCSRV",111,0)
 X XMREC S RCNT=RCNT+1 I XMRG'["STATUS:" G FILEQ
"RTN","RCRCSRV",112,0)
 S RCX=+$P(XMRG,"Message ",2)
"RTN","RCRCSRV",113,0)
 S DA=$O(^RCT(349.3,"B",RCX,0))
"RTN","RCRCSRV",114,0)
 I DA S DIE="^RCT(349.3,",DR=$S(RCSCE="E":6,1:5)_"////^S X="_RCXMZ D ^DIE
"RTN","RCRCSRV",115,0)
 I 'DA,RCSCE="E" D
"RTN","RCRCSRV",116,0)
   . S RCSUB=$$SUBGET^XMGAPI0(RCXMZ)
"RTN","RCRCSRV",117,0)
   . S RCCOM="RC sent Error message ("_RCTYP_")."
"RTN","RCRCSRV",118,0)
   . D ENT^RCRCXMS(RCXMZ,$G(RCSUB),"RC SERVER AT "_RCSTA,RCCOM)
"RTN","RCRCSRV",119,0)
FILEQ Q
"RTN","RCRCSRV",120,0)
 ;
"RTN","RCRCSRV",121,0)
XTMP(RCTYP,RCDSC) ;INITIALIZE TOP XTMP Global for Server Type
"RTN","RCRCSRV",122,0)
 ;INPUT : Type of server message  must be passed
"RTN","RCRCSRV",123,0)
 ;OUTPUT: XTMP global gets created for this server type
"RTN","RCRCSRV",124,0)
 ;      : RCXTYP gets set to PRCA_rctype(MR1,RR1,TR,CL...)
"RTN","RCRCSRV",125,0)
 ;      : RCJOB Job Number
"RTN","RCRCSRV",126,0)
 ;XTMP purge data will be 30 days past the create date
"RTN","RCRCSRV",127,0)
 N RCDT,X,X1,X2,Y,%,%H,%I
"RTN","RCRCSRV",128,0)
 D NOW^%DTC S (X1,RCDT)=X,X2=30 D C^%DTC
"RTN","RCRCSRV",129,0)
 S RCXTYP="PRCA"_RCTYP K ^XTMP(RCXTYP,RCXMZ)
"RTN","RCRCSRV",130,0)
 S ^XTMP(RCXTYP,RCXMZ,0)=X_"^"_RCDT_"^"_RCDSC_U_RCXMZ
"RTN","RCRCSRV",131,0)
 Q
"RTN","RCRCSRV",132,0)
 ;RCRCSRV
"RTN","RCRCUTL")
0^5^B29191013
"RTN","RCRCUTL",1,0)
RCRCUTL ;ALB/CMS - RC REFERRAL UTILITY PROGRAM ; 16-JUN-00
"RTN","RCRCUTL",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCUTL",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCUTL",4,0)
 Q
"RTN","RCRCUTL",5,0)
 ;
"RTN","RCRCUTL",6,0)
BN ;User Select an AR Bill No.
"RTN","RCRCUTL",7,0)
 ;Returns PRCABN if exists
"RTN","RCRCUTL",8,0)
 N DIC,DA,X,Y,%Y
"RTN","RCRCUTL",9,0)
BNA S DIC="^PRCA(430,",DIC(0)="AEQMZ"
"RTN","RCRCUTL",10,0)
 S DIC("S")="I $P(^(0),U,8)=16,$P($G(^PRCA(430.2,+$P(^(0),U,2),0)),U,6)=""T"""
"RTN","RCRCUTL",11,0)
 D ^DIC S PRCABN=+Y
"RTN","RCRCUTL",12,0)
 I $G(PRCABN)<0 K PRCABN
"RTN","RCRCUTL",13,0)
BNQ Q
"RTN","RCRCUTL",14,0)
 ;
"RTN","RCRCUTL",15,0)
BNVAR(PRCABN) ;Set PRCA( array with bill information
"RTN","RCRCUTL",16,0)
 ;Returns PRCA(
"RTN","RCRCUTL",17,0)
 N PRCABN0
"RTN","RCRCUTL",18,0)
 I '$G(PRCABN) G BNVARQ
"RTN","RCRCUTL",19,0)
 S PRCABN0=$G(^PRCA(430,PRCABN,0))
"RTN","RCRCUTL",20,0)
 S PRCA("BNAME")=$P(PRCABN0,U,1)
"RTN","RCRCUTL",21,0)
 S PRCA("CAT")=$P(PRCABN0,U,2)_"^"_$P($G(^PRCA(430.2,+$P(PRCABN0,U,2),0)),U,1,2)
"RTN","RCRCUTL",22,0)
 S PRCA("STATUS")=$P(PRCABN0,U,8)_"^"_$P($G(^PRCA(430.3,+$P(PRCABN0,U,8),0)),U,1,2)
"RTN","RCRCUTL",23,0)
BNVARQ Q
"RTN","RCRCUTL",24,0)
 ;
"RTN","RCRCUTL",25,0)
DEBT(PRCABN) ;Get Debtor Name and Address
"RTN","RCRCUTL",26,0)
 ;Send Bill Number
"RTN","RCRCUTL",27,0)
 ;Return PRCA( array nodes: DEBTNM, DEBTOR, DEBTCT, DEBTZIP, DEBTST,
"RTN","RCRCUTL",28,0)
 ;                          DEBTAD1, DEBTAD2, DEBTADD
"RTN","RCRCUTL",29,0)
 N PRCACT,PRCAKP,PRCAST,PRCAST1,PRCAST2,X,Y,%Y
"RTN","RCRCUTL",30,0)
 K PRCA("DEBTNM"),PRCA("DEBTOR"),PRCA("DEBTCT"),PRCA("DEBTZIP")
"RTN","RCRCUTL",31,0)
 K PRCA("DEBTST"),PRCA("DEBTAD1"),PRCA("DEBTAD2"),PRCA("DEBTADD")
"RTN","RCRCUTL",32,0)
 I '$G(PRCABN) G DEBTQ
"RTN","RCRCUTL",33,0)
 D DEBTOR^PRCAUTL
"RTN","RCRCUTL",34,0)
 I $G(PRCA("DEBTNM"))="" G DEBTQ
"RTN","RCRCUTL",35,0)
 S PRCA("DEBTCT")=$G(PRCACT,"UNK")
"RTN","RCRCUTL",36,0)
 S PRCA("DEBTZIP")=$G(PRCAKP,"UNK")
"RTN","RCRCUTL",37,0)
 S PRCA("DEBTST")=$G(PRCAST,"UNK")
"RTN","RCRCUTL",38,0)
 S PRCA("DEBTAD1")=$G(PRCAST1)
"RTN","RCRCUTL",39,0)
 S PRCA("DEBTAD2")=$G(PRCAST2)
"RTN","RCRCUTL",40,0)
 S PRCA("DEBTADD")=$G(X)
"RTN","RCRCUTL",41,0)
DEBTQ Q
"RTN","RCRCUTL",42,0)
 ;
"RTN","RCRCUTL",43,0)
PT(DFN) ;Get Patient information
"RTN","RCRCUTL",44,0)
 ;Return values in arrays: VA(, VADM(, VAPD(
"RTN","RCRCUTL",45,0)
 K VA,VADM,VAPD
"RTN","RCRCUTL",46,0)
 I '$D(^DPT(+$G(DFN),0)) G PTQ
"RTN","RCRCUTL",47,0)
 D DEM^VADPT,ADD^VADPT
"RTN","RCRCUTL",48,0)
PTQ Q
"RTN","RCRCUTL",49,0)
 ;
"RTN","RCRCUTL",50,0)
RCDOM() ;Get supporting RC Domain
"RTN","RCRCUTL",51,0)
 ;Returns Domain Name
"RTN","RCRCUTL",52,0)
 N X
"RTN","RCRCUTL",53,0)
 ;S X=$O(RCDIV(0))
"RTN","RCRCUTL",54,0)
 ;I +X S X=$P($G(RCDIV(+X)),U,6)
"RTN","RCRCUTL",55,0)
 ;I X]"" G RCDOMQ
"RTN","RCRCUTL",56,0)
 S X=$O(^RCT(349.1,"B","RC",0))
"RTN","RCRCUTL",57,0)
 S X=$P($G(^RCT(349.1,+X,3)),U,4)
"RTN","RCRCUTL",58,0)
RCDOMQ Q X
"RTN","RCRCUTL",59,0)
 ;
"RTN","RCRCUTL",60,0)
RCCAT(ARRAY) ;Get array of valid AR/RC Bill Categories
"RTN","RCRCUTL",61,0)
 ;Send back ARRAY(IEN)=x^AR Category Name
"RTN","RCRCUTL",62,0)
 ; x = 1 = Reconciliation, Referral and Follow-up
"RTN","RCRCUTL",63,0)
 ; x = 2 = Reconciliation Only
"RTN","RCRCUTL",64,0)
 S ARRAY(6)="2^"_$P(^PRCA(430.2,6,0),U,1)
"RTN","RCRCUTL",65,0)
 S ARRAY(7)="2^"_$P(^PRCA(430.2,7,0),U,1)
"RTN","RCRCUTL",66,0)
 S ARRAY(9)="1^"_$P(^PRCA(430.2,9,0),U,1)
"RTN","RCRCUTL",67,0)
 S ARRAY(10)="2^"_$P(^PRCA(430.2,10,0),U,1)
"RTN","RCRCUTL",68,0)
RCCATQ Q
"RTN","RCRCUTL",69,0)
 ;
"RTN","RCRCUTL",70,0)
REFST(PRCABN) ;Referral Status
"RTN","RCRCUTL",71,0)
 ;Return: If Referred date^code^amount
"RTN","RCRCUTL",72,0)
 ;        If not Referred 0
"RTN","RCRCUTL",73,0)
 N X S X=0
"RTN","RCRCUTL",74,0)
 I $P($G(^PRCA(430,PRCABN,0)),U,8)'=16 G REFSTQ
"RTN","RCRCUTL",75,0)
 S X=$P($G(^PRCA(430,PRCABN,6)),U,4,6)
"RTN","RCRCUTL",76,0)
 I 'X S X=0
"RTN","RCRCUTL",77,0)
REFSTQ Q X
"RTN","RCRCUTL",78,0)
 ;
"RTN","RCRCUTL",79,0)
RETN(PRCABN) ;Returned from RC/DOJ
"RTN","RCRCUTL",80,0)
 ;Return: If Return Date send Date
"RTN","RCRCUTL",81,0)
 ;        If not send 0
"RTN","RCRCUTL",82,0)
 N X S X=+$P($G(^PRCA(430,PRCABN,6)),U,11)
"RTN","RCRCUTL",83,0)
 Q X
"RTN","RCRCUTL",84,0)
 ;
"RTN","RCRCUTL",85,0)
ACTDT(PRCABN) ;Date account activated
"RTN","RCRCUTL",86,0)
 ;Return: Date account activated
"RTN","RCRCUTL",87,0)
 N X S X=0
"RTN","RCRCUTL",88,0)
 I '$G(PRCABN) G ACTDTQ
"RTN","RCRCUTL",89,0)
 S X=+$P($G(^PRCA(430,PRCABN,6)),"^",21) I X G ACTDTQ
"RTN","RCRCUTL",90,0)
 S X=+$P($G(^PRCA(430,PRCABN,9)),"^",3) I X G ACTDTQ
"RTN","RCRCUTL",91,0)
 S X=+$P($G(^PRCA(430,PRCABN,0)),"^",10)
"RTN","RCRCUTL",92,0)
ACTDTQ Q X
"RTN","RCRCUTL",93,0)
 ;
"RTN","RCRCUTL",94,0)
AEOB ;File 433 Cross-Ref on Transaction Type
"RTN","RCRCUTL",95,0)
 ;     -used to alert pending EOB processing when Payment in Part
"RTN","RCRCUTL",96,0)
 ;      transaction is created
"RTN","RCRCUTL",97,0)
 N PRCABN,RCAT
"RTN","RCRCUTL",98,0)
 I (X'=2)!(+$G(DA)<1) G AEOBQ
"RTN","RCRCUTL",99,0)
 S PRCABN=+$P($G(^PRCA(433,DA,0)),U,2) I 'PRCABN G AEOBQ
"RTN","RCRCUTL",100,0)
 I +$P($G(^PRCA(430,PRCABN,0)),U,2)'=9 G AEOBQ
"RTN","RCRCUTL",101,0)
 I $$REFST(PRCABN)=0 G AEOBQ
"RTN","RCRCUTL",102,0)
 S ^PRCA(433,"AEOB",PRCABN,DA)=""
"RTN","RCRCUTL",103,0)
AEOBQ Q
"RTN","RCRCUTL",104,0)
 ;
"RTN","RCRCUTL",105,0)
ECHK ;Check to see if pending EOB Code Processing exists
"RTN","RCRCUTL",106,0)
 I $O(^PRCA(433,"AEOB",0)) W !!,*7,"*** You have Referred TP Bills pending EOB Code processing ***"
"RTN","RCRCUTL",107,0)
ECHKQ Q
"RTN","RCRCUTL",108,0)
 ;
"RTN","RCRCUTL",109,0)
ADDR ;Regional Counsel Addresses and Death Notification addresses.
"RTN","RCRCUTL",110,0)
 ;;OGCBOSRI@MAIL.VA.GOV^OGCRegion1DeathNotification@mail.va.gov
"RTN","RCRCUTL",111,0)
 ;;OGCNYNRI@MAIL.VA.GOV^OGCRegion2DeathNotification@mail.va.gov
"RTN","RCRCUTL",112,0)
 ;;OGCBALRI@MAIL.VA.GOV^OGCRegion3DeathNotification@mail.va.gov
"RTN","RCRCUTL",113,0)
 ;;OGCPHIRI@MAIL.VA.GOV^OGCRegion4DeathNotification@mail.va.gov
"RTN","RCRCUTL",114,0)
 ;;OGCATLRI@MAIL.VA.GOV^OGCRegion5DeathNotification@mail.va.gov
"RTN","RCRCUTL",115,0)
 ;;OGCBAYRI@MAIL.VA.GOV^OGCRegion6DeathNotification@mail.va.gov
"RTN","RCRCUTL",116,0)
 ;;OGCCLERI@MAIL.VA.GOV^OGCRegion7DeathNotification@mail.va.gov
"RTN","RCRCUTL",117,0)
 ;;OGCNASRI@MAIL.VA.GOV^OGCRegion8DeathNotification@mail.va.gov
"RTN","RCRCUTL",118,0)
 ;;OGCJACRI@MAIL.VA.GOV^OGCRegion9DeathNotification@mail.va.gov
"RTN","RCRCUTL",119,0)
 ;;OGCCHIRI@MAIL.VA.GOV^OGCRegion10DeathNotification@mail.va.gov
"RTN","RCRCUTL",120,0)
 ;;OGCDETRI@MAIL.VA.GOV^OGCRegion11DeathNotification@mail.va.gov
"RTN","RCRCUTL",121,0)
 ;;OGCSTLRI@MAIL.VA.GOV^OGCRegion12DeathNotification@mail.va.gov
"RTN","RCRCUTL",122,0)
 ;;OGCWACRI@MAIL.VA.GOV^OGCRegion13DeathNotification@mail.va.gov
"RTN","RCRCUTL",123,0)
 ;;OGCHOURI@MAIL.VA.GOV^OGCRegion14DeathNotification@mail.va.gov
"RTN","RCRCUTL",124,0)
 ;;OGCMINRI@MAIL.VA.GOV^OGCRegion15DeathNotification@mail.va.gov
"RTN","RCRCUTL",125,0)
 ;;OGCDENRI@MAIL.VA.GOV^OGCRegion16DeathNotification@mail.va.gov
"RTN","RCRCUTL",126,0)
 ;;OGCLOSRI@MAIL.VA.GOV^OGCRegion17DeathNotification@mail.va.gov
"RTN","RCRCUTL",127,0)
 ;;OGCSFCRI@MAIL.VA.GOV^OGCRegion18DeathNotification@mail.va.gov
"RTN","RCRCUTL",128,0)
 ;;OGCPHORI@MAIL.VA.GOV^OGCRegion19DeathNotification@mail.va.gov
"RTN","RCRCUTL",129,0)
 ;;OGCPORRI@MAIL.VA.GOV^OGCRegion20DeathNotification@mail.va.gov
"RTN","RCRCUTL",130,0)
 ;;OGCBUFRI@MAIL.VA.GOV^OGCRegion21DeathNotification@mail.va.gov
"RTN","RCRCUTL",131,0)
 ;;OGCINDRI@MAIL.VA.GOV^OGCRegion22DeathNotification@mail.va.gov
"RTN","RCRCUTL",132,0)
 ;;OGCWINRI@MAIL.VA.GOV^OGCRegion23DeathNotification@mail.va.gov
"RTN","RCRCUTL",133,0)
 ;;END
"RTN","RCRCUTL",134,0)
 ;RCRCUTL
"RTN","RCRCVL")
0^17^B3902459
"RTN","RCRCVL",1,0)
RCRCVL ;ALB/CMS - RC VIEW BILL LIST ; 27-AUG-1997
"RTN","RCRCVL",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCVL",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCVL",4,0)
 ;
"RTN","RCRCVL",5,0)
EN ; -- main entry point for RCRC VIEW BILL LIST
"RTN","RCRCVL",6,0)
 D EN^VALM("RCRC VIEW BILL LIST")
"RTN","RCRCVL",7,0)
 Q
"RTN","RCRCVL",8,0)
 ;
"RTN","RCRCVL",9,0)
HDR ; -- header code
"RTN","RCRCVL",10,0)
 S VALMHDR(1)=""
"RTN","RCRCVL",11,0)
 S VALMHDR(2)="Third Party Possible Referrals"
"RTN","RCRCVL",12,0)
 S VALMSG=$S(+$G(VALMCNT)=0:"NO RECORDS FOUND",1:"|r Ref RC|* Cat C/Hold|+ Multi Ins|x Ret by RC|")
"RTN","RCRCVL",13,0)
 Q
"RTN","RCRCVL",14,0)
 ;
"RTN","RCRCVL",15,0)
INIT ; -- init variables and list array
"RTN","RCRCVL",16,0)
 K ^TMP("RCRCVL",$J),^TMP("RCRCVLX",$J),^TMP("RCRCVLPT",$J)
"RTN","RCRCVL",17,0)
 K ^TMP("IBJTLA",$J),^TMP("IBJTLAX",$J)
"RTN","RCRCVL",18,0)
 S VALMCNT=0 D BLDL^RCRCVL1
"RTN","RCRCVL",19,0)
 ;
"RTN","RCRCVL",20,0)
INITQ Q
"RTN","RCRCVL",21,0)
 ;
"RTN","RCRCVL",22,0)
IB ;Create IB global
"RTN","RCRCVL",23,0)
 N RCL,RCLNM,RCT,RCY,VALMY,RCSELN,IBIFN,VALMCNT S (RCT,RCY)=0
"RTN","RCRCVL",24,0)
 S RCLNM="IBJT ACTIVE LIST"
"RTN","RCRCVL",25,0)
 D EN^VALM2($G(XQORNOD(0)))
"RTN","RCRCVL",26,0)
 I $D(VALMY) S RCSELN=0 F  S RCSELN=$O(VALMY(RCSELN)) Q:'RCSELN  D
"RTN","RCRCVL",27,0)
 . S DFN=+$P($G(^TMP("RCRCVLPT",$J,RCSELN)),U,1)
"RTN","RCRCVL",28,0)
 . I +DFN S RCT=RCT+1 I '$D(RCL("B",DFN)) S RCL(RCT)=DFN,RCL("B",DFN)=""
"RTN","RCRCVL",29,0)
 S RCY=0 F  S RCY=$O(RCL(RCY)) Q:'RCY  D
"RTN","RCRCVL",30,0)
 .S DFN=RCL(RCY)
"RTN","RCRCVL",31,0)
 .W !,"Getting bill information " D EN^IBJTLA
"RTN","RCRCVL",32,0)
 S VALMBCK="R"
"RTN","RCRCVL",33,0)
 Q 
"RTN","RCRCVL",34,0)
HELP ; -- help code
"RTN","RCRCVL",35,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","RCRCVL",36,0)
 Q
"RTN","RCRCVL",37,0)
 ;
"RTN","RCRCVL",38,0)
EXIT ; -- exit code
"RTN","RCRCVL",39,0)
 K ^TMP("RCRCVL",$J),^TMP("RCRCVLX",$J),^TMP("RCRCVLPT",$J)
"RTN","RCRCVL",40,0)
 K ^TMP("IBJTLA",$J),^TMP("IBJTLAX",$J),^TMP("VALM DATA",$J)
"RTN","RCRCVL",41,0)
 K ^TMP("RCDOMAIN",$J)
"RTN","RCRCVL",42,0)
 K DFN,PRCABN,RCOUT,VALMCNT,VALMBCK
"RTN","RCRCVL",43,0)
 D CLEAR^VALM1,CLEAN^VALM10
"RTN","RCRCVL",44,0)
 Q
"RTN","RCRCVL",45,0)
 ;
"RTN","RCRCVL",46,0)
OPT ; Entry Point for Third Party Review/Referral
"RTN","RCRCVL",47,0)
 D EN^RCRCVLB
"RTN","RCRCVL",48,0)
 I $G(RCOUT) G OPTQ
"RTN","RCRCVL",49,0)
 D EN^RCRCVL
"RTN","RCRCVL",50,0)
OPTQ K DFN,RCOUT,VALMBCK
"RTN","RCRCVL",51,0)
 Q
"RTN","RCRCVL",52,0)
 ;RCRCVL
"RTN","RCRCVL2")
0^8^B5268143
"RTN","RCRCVL2",1,0)
RCRCVL2 ;ALB/CMS - RC VIEW BILL LIST SORT BUILD ; 09-SEP-97
"RTN","RCRCVL2",2,0)
V ;;4.5;Accounts Receivable;**63,159**;MAR 20, 1995
"RTN","RCRCVL2",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCVL2",4,0)
 Q
"RTN","RCRCVL2",5,0)
BLDL ; - find data required for the report
"RTN","RCRCVL2",6,0)
 N DFN,PRCABN,PRCABN0,RCAGE,RCAMT,RCCNT,RCCUR,RCY
"RTN","RCRCVL2",7,0)
 I $O(RCSPT(0)) D BLDPT G BLDLQ Q
"RTN","RCRCVL2",8,0)
 S (RCCNT,PRCABN)=0 W !,"Searching Active Bills for match "
"RTN","RCRCVL2",9,0)
 F  S PRCABN=$O(^PRCA(430,"AC",16,PRCABN)) Q:'PRCABN  D GET
"RTN","RCRCVL2",10,0)
BLDLQ K RCSBN,RCCAT,RCCNT,RCSI,RCSIA,RCSIF,RCSPT,RCSIL,RCSAGN,RCSAGX,RCSAMT,RCSRC
"RTN","RCRCVL2",11,0)
 Q
"RTN","RCRCVL2",12,0)
 ;
"RTN","RCRCVL2",13,0)
BLDPT ;If pt. selection use E cross-ref
"RTN","RCRCVL2",14,0)
 N DFN,PRCABN S (RCCNT,DFN)=0
"RTN","RCRCVL2",15,0)
 W !,"Searching TP bills for match "
"RTN","RCRCVL2",16,0)
 F  S DFN=$O(RCSPT(DFN)) Q:'DFN  S PRCABN=0 D
"RTN","RCRCVL2",17,0)
 .F  S PRCABN=$O(^PRCA(430,"E",DFN,PRCABN)) Q:'PRCABN  D GET
"RTN","RCRCVL2",18,0)
 Q
"RTN","RCRCVL2",19,0)
 ;
"RTN","RCRCVL2",20,0)
GET ;
"RTN","RCRCVL2",21,0)
 N RCPDIV,RCDIV,RCX
"RTN","RCRCVL2",22,0)
 S PRCABN0=$G(^PRCA(430,PRCABN,0))
"RTN","RCRCVL2",23,0)
 ;  - check status must be active
"RTN","RCRCVL2",24,0)
 I $P(PRCABN0,U,8)'=16 Q
"RTN","RCRCVL2",25,0)
 ;  - check referral category
"RTN","RCRCVL2",26,0)
 S RCCAT="" D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCVL2",27,0)
 I '$D(RCCAT(+$P(PRCABN0,U,2))) Q
"RTN","RCRCVL2",28,0)
 ;  - check division if necessary
"RTN","RCRCVL2",29,0)
 I +$G(RCDIV(0)),'$$DIV^RCRCDIV(PRCABN) Q
"RTN","RCRCVL2",30,0)
 ;  - check the receivable age if necessary
"RTN","RCRCVL2",31,0)
 I +$G(RCSAGN)=0,+$G(RCSAGX)=0 G AMT
"RTN","RCRCVL2",32,0)
 S RCAGE=$$ACTDT^RCRCUTL(PRCABN) Q:'RCAGE
"RTN","RCRCVL2",33,0)
 S RCAGE=$$FMDIFF^XLFDT(DT,RCAGE)
"RTN","RCRCVL2",34,0)
 I $G(RCSAGN),RCAGE<RCSAGN Q
"RTN","RCRCVL2",35,0)
 I $G(RCSAGX),RCAGE>RCSAGX Q
"RTN","RCRCVL2",36,0)
AMT ;  - check the cur bal of bill if necessary
"RTN","RCRCVL2",37,0)
 I $G(RCSAMT) S RCAMT=$$BILL^RCJIBFN2(PRCABN) I $P(RCAMT,U,3)<RCSAMT Q
"RTN","RCRCVL2",38,0)
 ;  - exclude receivables referred to Regional Counsel if necessary
"RTN","RCRCVL2",39,0)
 I '$G(RCSRC) I $P($G(^PRCA(430,PRCABN,6)),"^",4) Q
"RTN","RCRCVL2",40,0)
 ;  - check debtor insurance carrier
"RTN","RCRCVL2",41,0)
 I $D(RCSI),'$$INS Q
"RTN","RCRCVL2",42,0)
 S RCCNT=$G(RCCNT)+1 W "."
"RTN","RCRCVL2",43,0)
 D SCRN^RCRCVL1(PRCABN)
"RTN","RCRCVL2",44,0)
 Q
"RTN","RCRCVL2",45,0)
 ;
"RTN","RCRCVL2",46,0)
INS() ; Get the Insurance company and check to include
"RTN","RCRCVL2",47,0)
 ;
"RTN","RCRCVL2",48,0)
 N PRCA,RCIN
"RTN","RCRCVL2",49,0)
 I $G(RCSIA)="ALL" S Y=1 G INSQ
"RTN","RCRCVL2",50,0)
 I $G(RCSIA)="NULL",$P(PRCABN0,U,9)="" S Y=1 G INSQ
"RTN","RCRCVL2",51,0)
 I $G(RCSIA)="NULL",+$P(PRCABN0,U,9) S Y=0 G INSQ
"RTN","RCRCVL2",52,0)
 I $O(RCSI(0)),$D(RCSI(+$P(PRCABN0,U,9))) S Y=1 G INSQ
"RTN","RCRCVL2",53,0)
 I $O(RCSI(0)),'$D(RCSI(+$P(PRCABN0,U,9))) S Y=0 G INSQ
"RTN","RCRCVL2",54,0)
 D DEBT^RCRCUTL(PRCABN)
"RTN","RCRCVL2",55,0)
 I $G(PRCA("DEBTNM"))="",$G(RCSIF)='"@" S Y=0 G INSQ
"RTN","RCRCVL2",56,0)
 I PRCA("DEBTNM")]$G(RCSIL) S Y=0 G INSQ
"RTN","RCRCVL2",57,0)
 I $G(RCSIF)="" S Y=1 G INSQ
"RTN","RCRCVL2",58,0)
 I $G(RCSIF)]PRCA("DEBTNM") S Y=0 G INSQ
"RTN","RCRCVL2",59,0)
 S Y=1
"RTN","RCRCVL2",60,0)
INSQ Q Y
"RTN","RCRCVL2",61,0)
 ;RCRCVL2
"RTN","RCRCVLB")
0^6^B38508597
"RTN","RCRCVLB",1,0)
RCRCVLB ;ALB/CMS - RC VIEW ACTIVE LIST BUILD ; 09-AUG-97
"RTN","RCRCVLB",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCVLB",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCVLB",4,0)
 Q
"RTN","RCRCVLB",5,0)
EN ; entry point from RCRCVL
"RTN","RCRCVLB",6,0)
 ; Returns: RCSBN,RCSBN(CNT,PRCABN)
"RTN","RCRCVLB",7,0)
 ;      or: RCCAT(catname),RCSI(dbt#),RCSPT,RCSIA,RCSIF,RCSIL,RCSAGN,RCSAGX,RCSAMT,RCSRC
"RTN","RCRCVLB",8,0)
 ;      or: if muti-divisions RCDIV(0),RCDIV(selected 40.8IEN)
"RTN","RCRCVLB",9,0)
 ;      or: RCOUT
"RTN","RCRCVLB",10,0)
 N CNT,DA,DIC,PRCA,PRCABN,RCLQ,RCLQA,RCY,RCS,TCNT,T,X,Y
"RTN","RCRCVLB",11,0)
 N RCDIV,RCCNT,RCSD,RCRN,RCSN,RCSNF,RCLCNT,RCSNL,RCSNA,RCSAR,RCSH
"RTN","RCRCVLB",12,0)
 N DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",13,0)
 K RCSBN,RCCAT,RCSI,RCSIF,RCSIL,RCSAGN,RCSAGX,RCSAMT,RCSPT,RCSRC,RCOUT
"RTN","RCRCVLB",14,0)
 ;
"RTN","RCRCVLB",15,0)
 ;Get Divisions
"RTN","RCRCVLB",16,0)
 D RCDIV^RCRCDIV(.RCDIV)
"RTN","RCRCVLB",17,0)
 ;Select one division if multiple
"RTN","RCRCVLB",18,0)
 I $O(RCDIV(0)) D DIVS^RCRCDIV I $G(RCOUT)=1 G ENQ
"RTN","RCRCVLB",19,0)
 ;
"RTN","RCRCVLB",20,0)
 W !!,"Build List of Possible Third Party Referrals"
"RTN","RCRCVLB",21,0)
 S DIR("A",1)="Build a list by"
"RTN","RCRCVLB",22,0)
 S DIR("A",2)="1.  Selected AR Third Party Bill(s)"
"RTN","RCRCVLB",23,0)
 S DIR("A",3)="2.  Selected Patient(s)"
"RTN","RCRCVLB",24,0)
 S DIR("A",4)="3.  Selected AR Insurance Debtor(s) or"
"RTN","RCRCVLB",25,0)
 S DIR("A",5)="               Insurance Range"
"RTN","RCRCVLB",26,0)
 S DIR("A",6)=" "
"RTN","RCRCVLB",27,0)
 S DIR("A")=" Select Number: "
"RTN","RCRCVLB",28,0)
 S DIR(0)="SAXB^1:Third Party Bills;2:Patients;3:Insurance Debtors"
"RTN","RCRCVLB",29,0)
 S DIR("B")=1
"RTN","RCRCVLB",30,0)
 D ^DIR I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) S RCOUT=1 G ENQ
"RTN","RCRCVLB",31,0)
 I $E(Y)="^" S RCOUT=1 G ENQ
"RTN","RCRCVLB",32,0)
 S RCRN=Y
"RTN","RCRCVLB",33,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",34,0)
 ;
"RTN","RCRCVLB",35,0)
 I RCRN=1 D BILL G ENQ
"RTN","RCRCVLB",36,0)
 I RCRN=2 D PT I '$G(RCOUT) D ASK
"RTN","RCRCVLB",37,0)
 I RCRN=3 D INS I '$G(RCOUT) D ASK
"RTN","RCRCVLB",38,0)
ENQ W !
"RTN","RCRCVLB",39,0)
 I $G(RCOUT)=1 K RCSBN,RCCAT,RCDIV,RCSI,RCSIA,RCSIF,RCSIL,RCSAGN,RCSAGX,RCSPT,RCSAMT,RCSRC
"RTN","RCRCVLB",40,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",41,0)
 Q
"RTN","RCRCVLB",42,0)
 ;
"RTN","RCRCVLB",43,0)
 ;
"RTN","RCRCVLB",44,0)
BILL ; - issue prompt for AR Bill Selection(s)
"RTN","RCRCVLB",45,0)
 ; - also called from Modify List Protocol
"RTN","RCRCVLB",46,0)
 K DIC,DA,X,Y,%Y W !
"RTN","RCRCVLB",47,0)
 S DIC("A")="Select Active TP Accounts Receivable Bill No.: "
"RTN","RCRCVLB",48,0)
 S DIC="^PRCA(430,",DIC(0)="AQMEZ"
"RTN","RCRCVLB",49,0)
 S DIC("S")="I $P(^(0),U,8)=16,$P($G(^PRCA(430.2,+$P(^(0),U,2),0)),U,6)=""T"""
"RTN","RCRCVLB",50,0)
 S CNT=0 F  D  Q:($G(PRCABN)<0)!($G(RCOUT))
"RTN","RCRCVLB",51,0)
 .D ^DIC S PRCABN=Y
"RTN","RCRCVLB",52,0)
 .I $G(PRCABN)<0 Q
"RTN","RCRCVLB",53,0)
 .I $G(PRCABN)="^" S RCOUT=1 Q
"RTN","RCRCVLB",54,0)
 .I +$G(RCDIV(0)),'$$DIV^RCRCDIV(PRCABN) W !,"     <<Bill is not in selected division.>>",!
"RTN","RCRCVLB",55,0)
 .S CNT=CNT+1,RCSBN=CNT
"RTN","RCRCVLB",56,0)
 .S RCSBN(+PRCABN)=CNT
"RTN","RCRCVLB",57,0)
 .S DIC("A")="Select another Active TP Accounts Receivable Bill No.: "
"RTN","RCRCVLB",58,0)
 .QUIT
"RTN","RCRCVLB",59,0)
 I '$O(RCSBN(0)) S RCOUT=1
"RTN","RCRCVLB",60,0)
 K PRCABN,DIC,DA,X,Y,%Y
"RTN","RCRCVLB",61,0)
BILLQ Q
"RTN","RCRCVLB",62,0)
 ;
"RTN","RCRCVLB",63,0)
PT ;  - Issue prompt for Patients
"RTN","RCRCVLB",64,0)
 N DIC,X,Y
"RTN","RCRCVLB",65,0)
 I $O(RCSPT(0)) S DIC("A")="Select another PATIENT: "
"RTN","RCRCVLB",66,0)
 S DIC="^DPT(",DIC(0)="QMEAZ"
"RTN","RCRCVLB",67,0)
 W ! D ^DIC K DIC I $E(Y)="^" S RCOUT=1 G PTQ
"RTN","RCRCVLB",68,0)
 I Y<0,'$O(RCSPT(0)) S RCOUT=1
"RTN","RCRCVLB",69,0)
 I Y<0 G PTQ
"RTN","RCRCVLB",70,0)
 S RCSPT(+Y)=Y G PT
"RTN","RCRCVLB",71,0)
PTQ Q
"RTN","RCRCVLB",72,0)
 ;
"RTN","RCRCVLB",73,0)
INS ; - determine range of carriers
"RTN","RCRCVLB",74,0)
 R !!,"Build List for (S)elected Third Party Debtor(s) or a (R)ange: Range// ",X:DTIME
"RTN","RCRCVLB",75,0)
 I ('$T)!(X["^") S RCOUT=1 G INSQ
"RTN","RCRCVLB",76,0)
 S:X="" X="R" S X=$E(X)
"RTN","RCRCVLB",77,0)
 I "SRsr"'[X W !!,?15,"Enter 'S' or 'R' or '^' to exit." G INS
"RTN","RCRCVLB",78,0)
 W $S("sS"[X:"  Selected",1:"  Range") S RCSI=X
"RTN","RCRCVLB",79,0)
 I "Rr"[RCSI G INS1
"RTN","RCRCVLB",80,0)
 ;
"RTN","RCRCVLB",81,0)
 S DIC("A")="Select THIRD PARTY AR DEBTOR: "
"RTN","RCRCVLB",82,0)
INSA S DIC="^RCD(340,",DIC(0)="QEAZ",DIC("S")="I $P(^(0),U,1)[""DIC(36,"""
"RTN","RCRCVLB",83,0)
 W ! D ^DIC K DIC I $E(Y)="^" S RCOUT=1 G INSQ
"RTN","RCRCVLB",84,0)
 I Y<0,$O(RCSI(0)) G INSQ
"RTN","RCRCVLB",85,0)
 I Y<0,'$O(RCSI(0)) G INS
"RTN","RCRCVLB",86,0)
 S RCSI(+Y)=Y
"RTN","RCRCVLB",87,0)
 S DIC("A")="Select another THIRD PARTY AR DEBTOR: "
"RTN","RCRCVLB",88,0)
 G INSA
"RTN","RCRCVLB",89,0)
 ;
"RTN","RCRCVLB",90,0)
INS1 W !!!,"   START WITH DEBTOR: FIRST// " R X:DTIME
"RTN","RCRCVLB",91,0)
 I ('$T)!(X["^") S RCOUT=1 G INSQ
"RTN","RCRCVLB",92,0)
 I $E(X)="?" W !,?5,"Enter the name of the Insurance Company to start with." G INS1
"RTN","RCRCVLB",93,0)
 S RCSIF=X
"RTN","RCRCVLB",94,0)
INS2 W !,"   GO TO DEBTOR: LAST// " R X:DTIME
"RTN","RCRCVLB",95,0)
 I ('$T)!(X["^") S RCOUT=1 G INSQ
"RTN","RCRCVLB",96,0)
 I $E(X)="?" W !,?5,"Enter the name of the Insurance Company to end with." G INS2
"RTN","RCRCVLB",97,0)
 I X="" S RCSIL="zzzzz" S:RCSIF="" RCSIA="ALL" G INSQ
"RTN","RCRCVLB",98,0)
 I X="@",RCSIF="@" S RCSIL="@",RCSIA="NULL" G INSQ
"RTN","RCRCVLB",99,0)
 I RCSIF'="@",RCSIF]X W *7,!!,"  The LAST value must follow the FIRST.",! G INS1
"RTN","RCRCVLB",100,0)
 S RCSIL=X
"RTN","RCRCVLB",101,0)
INSQ Q
"RTN","RCRCVLB",102,0)
 ;
"RTN","RCRCVLB",103,0)
ASK ;Ask optional questions
"RTN","RCRCVLB",104,0)
 ;
"RTN","RCRCVLB",105,0)
 ; - Build list for Selected Categories
"RTN","RCRCVLB",106,0)
 S RCCAT="" D RCCAT^RCRCUTL(.RCCAT)
"RTN","RCRCVLB",107,0)
 S (CNT,X)=0 K DIR
"RTN","RCRCVLB",108,0)
 F  S X=$O(RCCAT(X)) Q:'X  D
"RTN","RCRCVLB",109,0)
 .S CNT=CNT+1 S DIR("A",CNT)=CNT_"  "_$P(RCCAT(X),U,2)
"RTN","RCRCVLB",110,0)
 S TCNT=CNT,CNT=CNT+1,DIR("A",CNT)=" "
"RTN","RCRCVLB",111,0)
 S CNT=CNT+1,DIR("A",CNT)="  *Only Reimburs.Health Bills can be electronically referred at this time."
"RTN","RCRCVLB",112,0)
 S CNT=CNT+1,DIR("A",CNT)=" "
"RTN","RCRCVLB",113,0)
 S DIR("A")=" Enter response"
"RTN","RCRCVLB",114,0)
 W !!,"AR Categories to Include in Build List"
"RTN","RCRCVLB",115,0)
 W !," Select from the following:",!
"RTN","RCRCVLB",116,0)
 S DIR(0)="L^1:"_TCNT
"RTN","RCRCVLB",117,0)
 D ^DIR I $E(Y)="^" S RCOUT=1 G ASKQ
"RTN","RCRCVLB",118,0)
 K RCCAT F I=1:1:TCNT I $P(Y,",",I) S RCCAT($P(DIR("A",$P(Y,",",I)),"  ",2))=""
"RTN","RCRCVLB",119,0)
 I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) G ASKQ
"RTN","RCRCVLB",120,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",121,0)
 ;
"RTN","RCRCVLB",122,0)
AGE ; - determine the active receivable min age
"RTN","RCRCVLB",123,0)
 S DIR(0)="NOA^1:99999",DIR("?")="Enter a number between (1-99999) or press return"
"RTN","RCRCVLB",124,0)
 S DIR("A")="  (Optional) Enter the minimum age of the receivables: "
"RTN","RCRCVLB",125,0)
 W !! D ^DIR S RCSAGN=+Y I $D(DTOUT)!$D(DUOUT)!$D(DIROUT) S RCOUT=1 G ASKQ
"RTN","RCRCVLB",126,0)
 W:+RCSAGN !,"  -Bill age over ",RCSAGN," days."
"RTN","RCRCVLB",127,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",128,0)
 ;
"RTN","RCRCVLB",129,0)
 ; - determine the active receivable max age
"RTN","RCRCVLB",130,0)
 S DIR(0)="NOA^1:99999",DIR("?")="Enter a number between (1-99999) or press return"
"RTN","RCRCVLB",131,0)
 S DIR("A")="  (Optional) Enter the maximum age of the receivables: "
"RTN","RCRCVLB",132,0)
 W !! D ^DIR S RCSAGX=+Y I $D(DTOUT)!$D(DUOUT)!$D(DIROUT) S RCOUT=1 G ASKQ
"RTN","RCRCVLB",133,0)
 W:+RCSAGX !,"  -Bill age under ",RCSAGX," days."
"RTN","RCRCVLB",134,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",135,0)
 ;
"RTN","RCRCVLB",136,0)
 I $G(RCSAGX),+$G(RCSAGN)>+$G(RCSAGX) W !!,"Minimum age should be less than the Max. age.",!! G AGE
"RTN","RCRCVLB",137,0)
 ;
"RTN","RCRCVLB",138,0)
 ; - determine the active receivable minimum Amount
"RTN","RCRCVLB",139,0)
 S DIR(0)="NOA^1:99999:2",DIR("?")="Enter a number between (1-99999) or press return"
"RTN","RCRCVLB",140,0)
 S DIR("A")="  (Optional) Enter the minimum amount of the receivables: "
"RTN","RCRCVLB",141,0)
 W !! D ^DIR S RCSAMT=+Y I $D(DTOUT)!$D(DUOUT)!$D(DIROUT) S RCOUT=1 G ASKQ
"RTN","RCRCVLB",142,0)
 W:RCSAMT !,"  -Current Balance Over $",RCSAMT
"RTN","RCRCVLB",143,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",144,0)
 ;
"RTN","RCRCVLB",145,0)
 ; - exclude receivables currently referred to Regional Counsel?
"RTN","RCRCVLB",146,0)
 S DIR(0)="Y",DIR("B")="Yes"
"RTN","RCRCVLB",147,0)
 S DIR("?")="Include receivables with a Referral Date in List"
"RTN","RCRCVLB",148,0)
 S DIR("A")="Include currently referred receivables"
"RTN","RCRCVLB",149,0)
 W !! D ^DIR S RCSRC=+Y
"RTN","RCRCVLB",150,0)
 I $D(DIRUT)!$D(DTOUT)!$D(DUOUT)!$D(DIROUT) S RCOUT=1 G ASKQ
"RTN","RCRCVLB",151,0)
 K DIR,DIROUT,DTOUT,DUOUT,DIRUT
"RTN","RCRCVLB",152,0)
 ;
"RTN","RCRCVLB",153,0)
ASKQ Q
"RTN","RCRCVLB",154,0)
 ;
"RTN","RCRCVLB",155,0)
 ;RCRCVLB
"RTN","RCRCVXM")
0^11^B15265021
"RTN","RCRCVXM",1,0)
RCRCVXM ;ALB/CMS - AR/RC ORIG BILL TRANSMISSION ; 16-JUN-00
"RTN","RCRCVXM",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCVXM",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCVXM",4,0)
 ;ORIGINAL BILL TRANSPORT
"RTN","RCRCVXM",5,0)
 ;
"RTN","RCRCVXM",6,0)
 Q
"RTN","RCRCVXM",7,0)
EN ;Entry from Protocol to Refer bills to RC
"RTN","RCRCVXM",8,0)
 N DIR,LN,PRCABN,RCA,RCCNT,RCCOM,RCDOM,RCMSG,RCSITE,RCY,X,Y S RCCNT=0,LN=4
"RTN","RCRCVXM",9,0)
 D FULL^VALM1
"RTN","RCRCVXM",10,0)
 I '$O(^TMP("RCRCVL",$J,"SEL",0)) W !!,"NOTHING TO REFER!",!,"No selected items from list." G ENQ
"RTN","RCRCVXM",11,0)
 W !! S DIR("A",1)="Referring all bill(s) on highlighted Selection List "
"RTN","RCRCVXM",12,0)
 S DIR("A",2)=" ",DIR("A",3)="This action will:"
"RTN","RCRCVXM",13,0)
 S DIR("A",4)="Create a 'Refer to RC' or 'Re-establish Referral' AR Transaction,"
"RTN","RCRCVXM",14,0)
 S DIR("A",5)="electronically transmit transferable bills to RC,"
"RTN","RCRCVXM",15,0)
 S DIR("A",6)="list bills that did not pass the validation check and did not transmit,"
"RTN","RCRCVXM",16,0)
 S DIR("A",7)="then mark the highlighted bills as referred."
"RTN","RCRCVXM",17,0)
 S DIR("A",8)="  "
"RTN","RCRCVXM",18,0)
 S DIR("A")="Okay to Continue: "
"RTN","RCRCVXM",19,0)
 D ASK^RCRCACP I Y'=1 G ENQ
"RTN","RCRCVXM",20,0)
 S RCY=0 F  S RCY=$O(^TMP("RCRCVL",$J,"SEL",RCY)) Q:'RCY  D
"RTN","RCRCVXM",21,0)
 .S PRCABN=$P($G(^TMP("RCRCVLX",$J,RCY)),U,2) W "."
"RTN","RCRCVXM",22,0)
 .I 'PRCABN Q
"RTN","RCRCVXM",23,0)
 .K ^TMP("RCRCVL",$J,"XM",PRCABN)
"RTN","RCRCVXM",24,0)
 .;  - Validate bill and save variables
"RTN","RCRCVXM",25,0)
 .S RCMSG="" D CHK^RCRCVCK(PRCABN,.RCMSG,1)
"RTN","RCRCVXM",26,0)
 .I RCMSG]"" S RCA(PRCABN,RCY)=RCMSG Q
"RTN","RCRCVXM",27,0)
 .D IBS^RCRCXM1
"RTN","RCRCVXM",28,0)
 .Q
"RTN","RCRCVXM",29,0)
 ;
"RTN","RCRCVXM",30,0)
 ; - If nothing to send go write message on screen
"RTN","RCRCVXM",31,0)
 I '$O(^TMP("RCRCVL",$J,"XM",0)) G ENW
"RTN","RCRCVXM",32,0)
 ;
"RTN","RCRCVXM",33,0)
 ; - create E-Mail and send off S RCCOM
"RTN","RCRCVXM",34,0)
 D SEND
"RTN","RCRCVXM",35,0)
 ;
"RTN","RCRCVXM",36,0)
 ; - update AR Transaction,430 Referral Date and LM Screen
"RTN","RCRCVXM",37,0)
 D ARUP
"RTN","RCRCVXM",38,0)
 ;
"RTN","RCRCVXM",39,0)
 ; - list bills that did not go
"RTN","RCRCVXM",40,0)
ENW I $O(RCA(0)) W !!,"Did not Refer the following bills",! D
"RTN","RCRCVXM",41,0)
 .S PRCABN=0 F  S PRCABN=$O(RCA(PRCABN)) Q:'PRCABN  D
"RTN","RCRCVXM",42,0)
 ..S RCY=0 F  S RCY=$O(RCA(PRCABN,RCY)) Q:'RCY  D
"RTN","RCRCVXM",43,0)
 ...W !,"Item ",RCY,".  ",RCA(PRCABN,RCY)
"RTN","RCRCVXM",44,0)
 ...;I $Y>(IOSL+3) D PAUSE^VALM1 W @IOF
"RTN","RCRCVXM",45,0)
 ;
"RTN","RCRCVXM",46,0)
ENQ K DIR D PAUSE^VALM1 S VALMBCK="R"
"RTN","RCRCVXM",47,0)
 Q
"RTN","RCRCVXM",48,0)
 ;
"RTN","RCRCVXM",49,0)
SEND ;Send bills in mail message
"RTN","RCRCVXM",50,0)
 N DATA,II,LN,PRCABN,RCCNT,RCBDIV,RCI,RCSUB,RCWHO,RETRY
"RTN","RCRCVXM",51,0)
 N XNDUZ,XMSUB,XMTEXT,XMY,XMZ,X,Y
"RTN","RCRCVXM",52,0)
 S (RCCNT,PRCABN)=0 F  S PRCABN=$O(^TMP("RCRCVL",$J,"XM",PRCABN)) Q:(RCCNT)!('PRCABN)  D
"RTN","RCRCVXM",53,0)
 .S II=0 F  S II=$O(^TMP("RCRCVL",$J,"XM",PRCABN,II)) Q:(RCCNT)!('II)  D
"RTN","RCRCVXM",54,0)
 ..S RCCNT=RCCNT+1
"RTN","RCRCVXM",55,0)
 I RCCNT=0 G SENDQ
"RTN","RCRCVXM",56,0)
 S (RCCNT,RETRY)=0,RCCOM=""
"RTN","RCRCVXM",57,0)
 S RCSITE=$$SITE^RCMSITE
"RTN","RCRCVXM",58,0)
 I $O(RCDIV(0)) S RCDOM=$P($G(RCDIV(+$P($G(RCDIV(0)),U,3))),U,6)
"RTN","RCRCVXM",59,0)
 I $O(^TMP("RCDOMAIN",$J,0)) S RCDOM=$P(^TMP("RCDOMAIN",$J,+$P($G(^TMP("RCDOMAIN",$J,0)),U,3)),U,6)
"RTN","RCRCVXM",60,0)
 I $G(RCDOM)="" S RCDOM=$$RCDOM^RCRCUTL
"RTN","RCRCVXM",61,0)
SNDA ;Come back here if didn't go to mail man
"RTN","RCRCVXM",62,0)
 S (XMDUN,XMDUZ)=DUZ
"RTN","RCRCVXM",63,0)
 S (RCSUB,XMSUB)="AR/RC - "_$G(RCSITE,"UNK")_" ORIGINAL BILL TRANSMISSION"
"RTN","RCRCVXM",64,0)
 D XMZ^XMA2 I $G(XMZ)<1 S RETRY=RETRY+1 I RETRY<100 G SNDA
"RTN","RCRCVXM",65,0)
 I $G(XMZ)<1 G SENDQ
"RTN","RCRCVXM",66,0)
 S RCWHO=RCDOM
"RTN","RCRCVXM",67,0)
 S XMY(RCWHO)="",XMY(DUZ)=""
"RTN","RCRCVXM",68,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92^1^1^"_DT
"RTN","RCRCVXM",69,0)
 S ^XMB(3.9,XMZ,2,1,0)="$$RC$OB$$"_RCSITE_"$S.RC RC SERV"
"RTN","RCRCVXM",70,0)
 S PRCABN=0,LN=1 F  S PRCABN=$O(^TMP("RCRCVL",$J,"XM",PRCABN)) Q:'PRCABN  D
"RTN","RCRCVXM",71,0)
 .I $O(^TMP("RCRCVL",$J,"XM",PRCABN,0)) S RCCNT=RCCNT+1
"RTN","RCRCVXM",72,0)
 .S II=0 F  S II=$O(^TMP("RCRCVL",$J,"XM",PRCABN,II)) Q:'II  D
"RTN","RCRCVXM",73,0)
 ..S RCI=0 F  S RCI=$O(^TMP("RCRCVL",$J,"XM",PRCABN,II,RCI)) Q:'RCI  D
"RTN","RCRCVXM",74,0)
 ...S DATA=$G(^TMP("RCRCVL",$J,"XM",PRCABN,II,RCI))
"RTN","RCRCVXM",75,0)
 ...I DATA="" Q
"RTN","RCRCVXM",76,0)
 ...S LN=LN+1
"RTN","RCRCVXM",77,0)
 ...S ^XMB(3.9,XMZ,2,LN,0)=DATA
"RTN","RCRCVXM",78,0)
 ;
"RTN","RCRCVXM",79,0)
 S ^XMB(3.9,XMZ,2,LN+1,0)="$END$"_LN_"$"_RCCNT_"$"
"RTN","RCRCVXM",80,0)
 D ENT1^XMD
"RTN","RCRCVXM",81,0)
 W !!,"Message #",XMZ," Transmitted ",$G(RCCNT,0)," bill(s)."
"RTN","RCRCVXM",82,0)
 S RCCOM="Message contains "_+$G(RCCNT)_" bill(s)."
"RTN","RCRCVXM",83,0)
 D ENT^RCRCXMS(XMZ,RCSUB,RCWHO,.RCCOM)
"RTN","RCRCVXM",84,0)
SENDQ Q
"RTN","RCRCVXM",85,0)
 ;
"RTN","RCRCVXM",86,0)
ARUP ;Update AR with information
"RTN","RCRCVXM",87,0)
 N PRCABN,RCY
"RTN","RCRCVXM",88,0)
 S PRCABN=0 F  S PRCABN=$O(^TMP("RCRCVL",$J,"XM",PRCABN)) Q:'PRCABN  D
"RTN","RCRCVXM",89,0)
 .D REF^RCRCRT
"RTN","RCRCVXM",90,0)
 .; - Reset field in List Template
"RTN","RCRCVXM",91,0)
 .S RCY=^TMP("RCRCVL",$J,"XM",PRCABN,0)
"RTN","RCRCVXM",92,0)
 .D FLDTEXT^VALM10(RCY,"REFER","r")
"RTN","RCRCVXM",93,0)
 .Q
"RTN","RCRCVXM",94,0)
ARUPQ Q
"RTN","RCRCVXM",95,0)
 ;
"RTN","RCRCVXM",96,0)
 ;RCRCVXM
"RTN","RCRCXMS")
0^1^B63503495
"RTN","RCRCXMS",1,0)
RCRCXMS ;ALB/CMS - RC TRANSMISSION MESSAGE HANDLER ; 16-JUN-00
"RTN","RCRCXMS",2,0)
V ;;4.5;Accounts Receivable;**63,159**;Mar 20, 1995
"RTN","RCRCXMS",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCRCXMS",4,0)
 Q
"RTN","RCRCXMS",5,0)
 ;
"RTN","RCRCXMS",6,0)
ENT(RCDA,RCSUB,RCWHO,RCCOM) ;RC Transmission information
"RTN","RCRCXMS",7,0)
 ;add RC TRANSMISSION TO FILE 349.3
"RTN","RCRCXMS",8,0)
 N DA,DIC,DIE,DLAYGO,DR,RCPDT,RCSND,X,Y
"RTN","RCRCXMS",9,0)
 K DD,DO
"RTN","RCRCXMS",10,0)
 I 'RCDA G ENTQ
"RTN","RCRCXMS",11,0)
 S RCD=$O(^RCT(349.3,"B",RCDA,0)) I RCD G ENTE
"RTN","RCRCXMS",12,0)
 S X=RCDA,DIC="^RCT(349.3,",DIC(0)="L",DLAYGO=349.3
"RTN","RCRCXMS",13,0)
 D FILE^DICN S RCD=+Y K DD,DO I RCD<1 G ENTQ
"RTN","RCRCXMS",14,0)
ENTE S DA=RCD S DIE="^RCT(349.3,"
"RTN","RCRCXMS",15,0)
 S RCSND=$E($P($G(^VA(200,+DUZ,0)),U,1),1,45)
"RTN","RCRCXMS",16,0)
 S RCSND=$S(RCSND]"":RCSND,1:"POSTMASTER")
"RTN","RCRCXMS",17,0)
 D PURG
"RTN","RCRCXMS",18,0)
 ;if entry is from RC via the RC Server
"RTN","RCRCXMS",19,0)
 I $G(RCSCE)="O" S RCSND=$G(XMFROM)
"RTN","RCRCXMS",20,0)
 S DR="1////"_$E(RCSUB,1,45)_";2////"_RCSND_";4////"_DT
"RTN","RCRCXMS",21,0)
 S DR=DR_";8////"_+$G(RCPDT)_";3////"_$E(RCWHO,1,45)_";7///"_$G(RCCOM)
"RTN","RCRCXMS",22,0)
 D ^DIE
"RTN","RCRCXMS",23,0)
 S RCCOM="Transmitted to RC in MM #["_RCDA_"] containing "_+$G(RCCNT)_" bill(s)."
"RTN","RCRCXMS",24,0)
ENTQ Q
"RTN","RCRCXMS",25,0)
 ;
"RTN","RCRCXMS",26,0)
PURG ;Get Purge Date
"RTN","RCRCXMS",27,0)
 N X1
"RTN","RCRCXMS",28,0)
 S X1=$O(^RCT(349.1,"B","RC",0))
"RTN","RCRCXMS",29,0)
 I 'X1 G PURGQ
"RTN","RCRCXMS",30,0)
 S X1=+$P(^RCT(349.1,X1,0),U,4)
"RTN","RCRCXMS",31,0)
 S RCPDT=$$FMADD^XLFDT(DT,$S($G(X1):X1,1:30))
"RTN","RCRCXMS",32,0)
PURGQ Q
"RTN","RCRCXMS",33,0)
 ;
"RTN","RCRCXMS",34,0)
SITE ;RC Site Parameter Edit
"RTN","RCRCXMS",35,0)
 N D1,DA,DIC,DIE,DIK,DTOUT,DR,RCDA,RCSITE,X,Y
"RTN","RCRCXMS",36,0)
 S (RCDA,DA)=$O(^RCT(349.1,"B","RC",0)),DIE="^RCT(349.1,"
"RTN","RCRCXMS",37,0)
 S RCSITE=$P($$SITE^RCMSITE,U,2)
"RTN","RCRCXMS",38,0)
 I 'DA G SITEQ
"RTN","RCRCXMS",39,0)
 ;S DR=".04;W !!,""Primary Division: "",$P($G(^DIC(4,$$SITE^RCMSITE,0)),U,1);32R~PRIMARY RC REMOTE DOMAIN"_";I $E($G(^DIC(4.2,X,0)),1,3)'=""RC-"" W !,""   <<RC DOMAIN MUST START WITH 'RC-'>>"" S Y=32" D ^DIE
"RTN","RCRCXMS",40,0)
 S DR=".04;W !!,""Primary Division: "",$P($G(^DIC(4,$$SITE^RCMSITE,0)),U,1);34R~RC MAIL ADDRESS"_";I $E($G(X),1,3)'=""OGC""!($E($G(X),7,20)'=""RI@MAIL.VA.GOV"") D MAILADD^RCRCXMS S Y=34"
"RTN","RCRCXMS",41,0)
 S DR=DR_";35R~RC DEATH NOTIFICATION ADDRESS"_";I $E($G(X),1,9)'=""OGCRegion"" D DEATHADD^RCRCXMS S Y=35" D ^DIE
"RTN","RCRCXMS",42,0)
 I ($D(DTOUT))!($D(Y)) G SITEQ
"RTN","RCRCXMS",43,0)
 ;
"RTN","RCRCXMS",44,0)
DR61 W !!,"Enter Division(s) of care if domain is different then primary RC Mail Address.",!
"RTN","RCRCXMS",45,0)
 S DR=61
"RTN","RCRCXMS",46,0)
 ;S DR(2,349.161)=".01;.02R~RC MAIL ADDRESS"_";I $E($G(^DIC(4.2,X,0)),1,3)'=""RC-"" W !,"" <<RC DOMAIN MUST START WITH 'RC-'>>"" S Y=.02" D ^DIE
"RTN","RCRCXMS",47,0)
 S DR(2,349.161)=".01;.03R~RC MAIL ADDRESS"_";I $E($G(X),1,3)'=""OGC""!($E($G(X),7,20)'=""RI@MAIL.VA.GOV"") D MAILADD^RCRCXMS S Y=.03"_";N RCFLAG D DIK^RCRCXMS I $G(RCFLAG) S Y=.01"
"RTN","RCRCXMS",48,0)
 S DR(2,349.161)=DR(2,349.161)_";.04R~RC DEATH NOTIFICATION ADDRESS"_";I $E($G(X),1,9)'=""OGCRegion"" D DEATHADD^RCRCXMS S Y=.04" D ^DIE
"RTN","RCRCXMS",49,0)
 ;S DR(2,349.161)=".04R~RC DEATH NOTIFICATION ADDRESS"_";I $E($G(X),1,3)'=""OGC""!($E($G(X),7,20)'=""RI@MAIL.VA.GOV"") D DEATHADD^RCRCXMS S Y=.04" D ^DIE
"RTN","RCRCXMS",50,0)
 ;
"RTN","RCRCXMS",51,0)
SITEQ Q
"RTN","RCRCXMS",52,0)
 ;
"RTN","RCRCXMS",53,0)
DIK ;If the RC address is the same as the primary,the entry will be deleted.
"RTN","RCRCXMS",54,0)
 I X=$P($G(^RCT(349.1,RCDA,3)),U,4) W !!,"<< DELETING ENTRY.  Domain same as Primary RC Remote Domain.>>",!! D
"RTN","RCRCXMS",55,0)
 .S DA(1)=RCDA,DIK="^RCT(349.1,"_RCDA_",6,",DA=D1 D ^DIK
"RTN","RCRCXMS",56,0)
 .S RCFLAG=1
"RTN","RCRCXMS",57,0)
 .Q
"RTN","RCRCXMS",58,0)
 Q
"RTN","RCRCXMS",59,0)
MAILADD ;MAIL ADDRESS FOR REGIONAL COUNSEL
"RTN","RCRCXMS",60,0)
 W !!,"Please enter an Regional Counsel mail address that adheres to the"
"RTN","RCRCXMS",61,0)
 W !,"following format:"
"RTN","RCRCXMS",62,0)
 W !!," The first three characters must be 'OGC'"
"RTN","RCRCXMS",63,0)
 W !," Characters 7 through 20 should be 'RI@MAIL.VA.GOV'"
"RTN","RCRCXMS",64,0)
 W !!,"Choose one of the following RC addresses:",!
"RTN","RCRCXMS",65,0)
 N RCCT,RCMAIL,RCUP
"RTN","RCRCXMS",66,0)
 F RCCT=1:1 S RCMAIL=$P($T(ADDR+RCCT),";;",2) Q:RCMAIL="END"!(+$G(RCUP))  D
"RTN","RCRCXMS",67,0)
 .I RCCT=15 R !,"""^"" TO QUIT: ",X:DTIME S:X="^" RCUP=1 Q:X="^"  W $C(13),$J("",15),$C(13)
"RTN","RCRCXMS",68,0)
 .W !,$P(RCMAIL,"^",1)
"RTN","RCRCXMS",69,0)
 .Q
"RTN","RCRCXMS",70,0)
 Q
"RTN","RCRCXMS",71,0)
DEATHADD ;DEATH ADDRESSES FOR REGIONAL COUNSEL
"RTN","RCRCXMS",72,0)
 W !!,"Please enter the Death Notification mail address adhering to"
"RTN","RCRCXMS",73,0)
 W !,"the following format:"
"RTN","RCRCXMS",74,0)
 W !!," The first nine characters must be 'OGCRegion'"
"RTN","RCRCXMS",75,0)
 W !," followed by a number from 1-23"
"RTN","RCRCXMS",76,0)
 W !," followed by 'DeathNotification@mail.va.gov'"
"RTN","RCRCXMS",77,0)
 W !!," Choose from one of the following:",!
"RTN","RCRCXMS",78,0)
 N RCCT,RCMAIL,RCUP
"RTN","RCRCXMS",79,0)
 F RCCT=1:1 S RCMAIL=$P($T(ADDR+RCCT),";;",2) Q:RCMAIL="END"!(+$G(RCUP))  D
"RTN","RCRCXMS",80,0)
 .I RCCT=15 R !,"""^"" TO QUIT: ",X:DTIME S:X="^" RCUP=1 Q:X="^"  W $C(13),$J("",15),$C(13)
"RTN","RCRCXMS",81,0)
 .W !,$P(RCMAIL,"^",2)
"RTN","RCRCXMS",82,0)
 .Q
"RTN","RCRCXMS",83,0)
 Q
"RTN","RCRCXMS",84,0)
ADDR ;
"RTN","RCRCXMS",85,0)
 ;;OGCBOSRI@MAIL.VA.GOV^OGCRegion1DeathNotification@mail.va.gov
"RTN","RCRCXMS",86,0)
 ;;OGCNYNRI@MAIL.VA.GOV^OGCRegion2DeathNotification@mail.va.gov
"RTN","RCRCXMS",87,0)
 ;;OGCBALRI@MAIL.VA.GOV^OGCRegion3DeathNotification@mail.va.gov
"RTN","RCRCXMS",88,0)
 ;;OGCPHIRI@MAIL.VA.GOV^OGCRegion4DeathNotification@mail.va.gov
"RTN","RCRCXMS",89,0)
 ;;OGCATLRI@MAIL.VA.GOV^OGCRegion5DeathNotification@mail.va.gov
"RTN","RCRCXMS",90,0)
 ;;OGCBAYRI@MAIL.VA.GOV^OGCRegion6DeathNotification@mail.va.gov
"RTN","RCRCXMS",91,0)
 ;;OGCCLERI@MAIL.VA.GOV^OGCRegion7DeathNotification@mail.va.gov
"RTN","RCRCXMS",92,0)
 ;;OGCNASRI@MAIL.VA.GOV^OGCRegion8DeathNotification@mail.va.gov
"RTN","RCRCXMS",93,0)
 ;;OGCJACRI@MAIL.VA.GOV^OGCRegion9DeathNotification@mail.va.gov
"RTN","RCRCXMS",94,0)
 ;;OGCCHIRI@MAIL.VA.GOV^OGCRegion10DeathNotification@mail.va.gov
"RTN","RCRCXMS",95,0)
 ;;OGCDETRI@MAIL.VA.GOV^OGCRegion11DeathNotification@mail.va.gov
"RTN","RCRCXMS",96,0)
 ;;OGCSTLRI@MAIL.VA.GOV^OGCRegion12DeathNotification@mail.va.gov
"RTN","RCRCXMS",97,0)
 ;;OGCWACRI@MAIL.VA.GOV^OGCRegion13DeathNotification@mail.va.gov
"RTN","RCRCXMS",98,0)
 ;;OGCHOURI@MAIL.VA.GOV^OGCRegion14DeathNotification@mail.va.gov
"RTN","RCRCXMS",99,0)
 ;;OGCMINRI@MAIL.VA.GOV^OGCRegion15DeathNotification@mail.va.gov
"RTN","RCRCXMS",100,0)
 ;;OGCDENRI@MAIL.VA.GOV^OGCRegion16DeathNotification@mail.va.gov
"RTN","RCRCXMS",101,0)
 ;;OGCLOSRI@MAIL.VA.GOV^OGCRegion17DeathNotification@mail.va.gov
"RTN","RCRCXMS",102,0)
 ;;OGCSFCRI@MAIL.VA.GOV^OGCRegion18DeathNotification@mail.va.gov
"RTN","RCRCXMS",103,0)
 ;;OGCPHORI@MAIL.VA.GOV^OGCRegion19DeathNotification@mail.va.gov
"RTN","RCRCXMS",104,0)
 ;;OGCPORRI@MAIL.VA.GOV^OGCRegion20DeathNotification@mail.va.gov
"RTN","RCRCXMS",105,0)
 ;;OGCBUFRI@MAIL.VA.GOV^OGCRegion21DeathNotification@mail.va.gov
"RTN","RCRCXMS",106,0)
 ;;OGCINDRI@MAIL.VA.GOV^OGCRegion22DeathNotification@mail.va.gov
"RTN","RCRCXMS",107,0)
 ;;OGCWINRI@MAIL.VA.GOV^OGCRegion23DeathNotification@mail.va.gov
"RTN","RCRCXMS",108,0)
 ;;END
"RTN","RCRCXMS",109,0)
EN(RCTAG) ;
"RTN","RCRCXMS",110,0)
 ;ENTRY POINT FROM RC TRANSMISSIONS LIST TEMPLATE
"RTN","RCRCXMS",111,0)
 N DA,DIC,DIQ,DIR,DR,RC,RCCNT,RCY,RCDA,RCOUT,RCT,RCTE,X,Y
"RTN","RCRCXMS",112,0)
 D FULL^VALM1
"RTN","RCRCXMS",113,0)
 I '$O(^RCT(349.3,0)) W !!,"  **  TRANSMISSION LOG EMPTY  **" G ENQ
"RTN","RCRCXMS",114,0)
 I '$O(^TMP("RCRCE",$J,"SEL",0)) W !!,"  **  NO ITEMS SELECTED FROM LIST  **" G ENQ
"RTN","RCRCXMS",115,0)
 D @$S(RCTAG="COM":"COM",RCTAG="DEL":"DEL",RCTAG="VEW":"VEW",RCTAG="FRW":"VEW",1:"ENQ")
"RTN","RCRCXMS",116,0)
ENQ K DIR D:$G(RCOUT)'["^" PAUSE^VALM1 Q
"RTN","RCRCXMS",117,0)
 ;
"RTN","RCRCXMS",118,0)
COM ;Append Comments to File 349.3
"RTN","RCRCXMS",119,0)
 N DA,DR,DIC,DIE,DIR,DIROUT,DUOUT,RCX,RCY,X,Y S RCOUT=""
"RTN","RCRCXMS",120,0)
 ;S DIC="^RCT(349.3,",DWLW=75,DIWEPSE="" D EN^DIWE
"RTN","RCRCXMS",121,0)
 ;Enter Comments for each or all?
"RTN","RCRCXMS",122,0)
 S RCX=0 F  S RCX=$O(^TMP("RCRCE",$J,"SEL",RCX)) Q:('RCX)!(RCOUT["^")  D
"RTN","RCRCXMS",123,0)
 .S DA=$G(^TMP("RCRCEX",$J,RCX)),RCLN=+DA,DA=$P(DA,U,2)
"RTN","RCRCXMS",124,0)
 .I '$D(^RCT(349.3,DA,0)) W !,"Item ",RCX,". Transmission Entry no longer exists.",!!
"RTN","RCRCXMS",125,0)
 .I $D(^RCT(349.3,DA,0)) D
"RTN","RCRCXMS",126,0)
 ..W @IOF,!!,"Item ",RCX,"." S (DIC,DIE)="^RCT(349.3," D EN^DIQ W ! S DR="7" D ^DIE K DR
"RTN","RCRCXMS",127,0)
 .W ! S DIR(0)="E" D ^DIR K DIR I $D(DIROUT)!$D(DUOUT) S RCOUT="^" Q
"RTN","RCRCXMS",128,0)
 .W @IOF
"RTN","RCRCXMS",129,0)
 S RCOUT="" W !!,"REMEMBER: Resequence List to see Appended Comments.",!
"RTN","RCRCXMS",130,0)
COMQ Q
"RTN","RCRCXMS",131,0)
 ;
"RTN","RCRCXMS",132,0)
DEL ;Delete entries in File 349.3
"RTN","RCRCXMS",133,0)
 N DA,DIK,DIR,RCLN,RCX,RCY,X,Y
"RTN","RCRCXMS",134,0)
 S RCY="...deleted...       "
"RTN","RCRCXMS",135,0)
 W @IOF W !,"Selected Items ..."
"RTN","RCRCXMS",136,0)
 S RCX=0 F  S RCX=$O(^TMP("RCRCE",$J,"SEL",RCX)) Q:'RCX  D
"RTN","RCRCXMS",137,0)
 .S RCLN=+$G(^TMP("RCRCEX",$J,RCX))
"RTN","RCRCXMS",138,0)
 .W !,$G(^TMP("RCRCE",$J,RCLN,0))
"RTN","RCRCXMS",139,0)
 W !!!,?8,"ALL ITEMS SELECTED WILL BE DELETED FROM"
"RTN","RCRCXMS",140,0)
 W !,?5,"TRANSMISSION LOG FILE WITHOUT FURTHER WARNING!",!!
"RTN","RCRCXMS",141,0)
 S DIR("A")="Okay to Continue Deletion(s) ",DIR("?")="Enter Yes to Continue with deletions"
"RTN","RCRCXMS",142,0)
 D ASK^RCRCACP K DIR I $G(Y)'=1 W !,"Okay nothing deleted." G DELQ
"RTN","RCRCXMS",143,0)
 W !!,"Deleting ..."
"RTN","RCRCXMS",144,0)
 S RCX=0 F  S RCX=$O(^TMP("RCRCE",$J,"SEL",RCX)) Q:'RCX  D
"RTN","RCRCXMS",145,0)
 .S DA=$G(^TMP("RCRCEX",$J,RCX)),RCLN=+DA,DA=$P(DA,U,2)
"RTN","RCRCXMS",146,0)
 .I $D(^RCT(349.3,DA,0)) D
"RTN","RCRCXMS",147,0)
 ..S DIK="^RCT(349.3," D ^DIK
"RTN","RCRCXMS",148,0)
 ..W !,$G(^TMP("RCRCE",$J,RCLN,0))
"RTN","RCRCXMS",149,0)
 ..D FLDTEXT^VALM10(RCLN,"SUBJECT",RCY)
"RTN","RCRCXMS",150,0)
 S RCOUT="" W !!,"REMEMBER: Resequence List to remove Deleted Items from list.",!
"RTN","RCRCXMS",151,0)
DELQ Q
"RTN","RCRCXMS",152,0)
 ;
"RTN","RCRCXMS",153,0)
VEW ;View/Forward  XM Message
"RTN","RCRCXMS",154,0)
 N DA,DIR,DIROUT,DUOUT,RCLN,RCX,X,Y
"RTN","RCRCXMS",155,0)
 S RCOUT="",RCX=0 F  S RCX=$O(^TMP("RCRCE",$J,"SEL",RCX)) Q:('RCX)!(RCOUT["^")  D
"RTN","RCRCXMS",156,0)
 .S DA=$G(^TMP("RCRCEX",$J,RCX)),RCLN=+DA,DA=$P(DA,U,2)
"RTN","RCRCXMS",157,0)
 .I '$D(^RCT(349.3,+DA,0)) W !!,"Item ",RCX,".",?5," Transmission Entry no longer exists.",!!
"RTN","RCRCXMS",158,0)
 .I $D(^RCT(349.3,+DA,0)) D VEWD I RCOUT="^" Q
"RTN","RCRCXMS",159,0)
 .W ! S DIR(0)="E" D ^DIR I $D(DIROUT)!$D(DUOUT) S RCOUT="^" Q
"RTN","RCRCXMS",160,0)
 .W @IOF
"RTN","RCRCXMS",161,0)
VEWQ Q
"RTN","RCRCXMS",162,0)
VEWD ;Display message
"RTN","RCRCXMS",163,0)
 N DIR,DIROUT,DUOUT,RCI,RCY,X,XMER,XMPOS,XMRG,XMZ,X,Y W @IOF
"RTN","RCRCXMS",164,0)
 S RCI=$G(^RCT(349.3,+DA,0)),XMZ=+RCI
"RTN","RCRCXMS",165,0)
 S RCY=$$NET^XMRENT(XMZ)
"RTN","RCRCXMS",166,0)
 I RCY="" W !!,RCX,".",?5," Mail Message #["_XMZ_"] no longer exists on this system.",! S XMZ=0 G VEWDQ
"RTN","RCRCXMS",167,0)
 W !,RCX,"."
"RTN","RCRCXMS",168,0)
 W !,"Subj: "_$P(RCY,U,6)_"  [#"_XMZ_"]  "_$P(RCY,U,1)
"RTN","RCRCXMS",169,0)
 W !,"From: "_$P(RCY,U,3)
"RTN","RCRCXMS",170,0)
 W !,"Message ID: "_$P(RCY,U,4)
"RTN","RCRCXMS",171,0)
 W !,"Recipient: "_$P(RCI,U,4)
"RTN","RCRCXMS",172,0)
 W !! F X=1:1:(IOM-1) W "="
"RTN","RCRCXMS",173,0)
 W !
"RTN","RCRCXMS",174,0)
 F  W !,$$READ^XMGAPI1() Q:(XMER=-1)!(RCOUT="^")  I ($Y+3)>IOSL D
"RTN","RCRCXMS",175,0)
 .W ! S DIR(0)="E" D ^DIR I $D(DIROUT)!$D(DUOUT) S RCOUT="^" Q
"RTN","RCRCXMS",176,0)
 .W @IOF
"RTN","RCRCXMS",177,0)
 I RCTAG="FRW" W !! I XMZ D ENT2^XMD
"RTN","RCRCXMS",178,0)
VEWDQ Q
"RTN","RCRCXMS",179,0)
 ;
"RTN","RCRCXMS",180,0)
 ;RCRCXMS
"RTN","RCY159EN")
0^22^B12737298
"RTN","RCY159EN",1,0)
RCY159EN ;MAF/ALB - ENVIRONMENT CHECK FOR PATCH PRCA*159 AR/RCI ;APR 2,2004
"RTN","RCY159EN",2,0)
 ;;4.5;Accounts Receivable;**159**;Mar 20, 1995
"RTN","RCY159EN",3,0)
 D BMES^XPDUTL("This Environment check checks to see if field (32) REMOTE DOMAIN ")
"RTN","RCY159EN",4,0)
 D MES^XPDUTL("in file (349.1) AR TRANSMISSIONS TYPE is populated.")
"RTN","RCY159EN",5,0)
 D MES^XPDUTL("This field must be populated to complete the install.")
"RTN","RCY159EN",6,0)
 D MES^XPDUTL("")
"RTN","RCY159EN",7,0)
 D BMES^XPDUTL("...Checking Regional Counsel REMOTE DOMAIN field 32.")
"RTN","RCY159EN",8,0)
 ; find the primary RC mail address from file 349.1 field 33
"RTN","RCY159EN",9,0)
 N RCDOM,RCIFN,RCFLAG
"RTN","RCY159EN",10,0)
 S RCFLAG=0
"RTN","RCY159EN",11,0)
 ;I $D(^RCT(349.1,"B","RC")) S RCIFN=$O(^RCT(349.1,"B","RC",0)) I RCIFN]"" D  Q:RCFLAG
"RTN","RCY159EN",12,0)
 I $D(^RCT(349.1,"B","RC")) S RCIFN=$O(^RCT(349.1,"B","RC",0)) I RCIFN]"" D
"RTN","RCY159EN",13,0)
 .S RCDOM=$P($G(^RCT(349.1,RCIFN,3)),"^",3)
"RTN","RCY159EN",14,0)
 .I RCDOM]""&($E(RCDOM,1,3)="RC-") D BMES^XPDUTL("...REMOTE DOMAIN populated... ") Q
"RTN","RCY159EN",15,0)
 .I RCDOM]"" D MES1
"RTN","RCY159EN",16,0)
 .I RCDOM="" D BMES^XPDUTL("...There is no Regional Counsel REMOTE DOMAIN entry.") D
"RTN","RCY159EN",17,0)
 ..D BMES^XPDUTL("...Please update field (32) REMOTE DOMAIN in AR TRANSMISSION TYPE file (349.1)") D MES^XPDUTL("   for the Regional Counsel (RC) type of transmission.")
"RTN","RCY159EN",18,0)
 .D MES
"RTN","RCY159EN",19,0)
 .Q
"RTN","RCY159EN",20,0)
 ;CHECKING THE DIVISION OF CARE FIELD (61) SUBFIELD (.02) REMOTE DOMAIN
"RTN","RCY159EN",21,0)
 I $D(^RCT(349.1,RCIFN,6,0)),$O(^RCT(349.1,RCIFN,6,0)) D
"RTN","RCY159EN",22,0)
 .D BMES^XPDUTL(" ") D BMES^XPDUTL("Checking field (61) DIVISION OF CARE subfield (.02) REMOTE DOMAIN") D MES^XPDUTL("This field must be populated to complete the install")
"RTN","RCY159EN",23,0)
 .N RCNEW,RCNODE,RCDETH,RCDIVC,RCDVADD,RCDVIFN,X
"RTN","RCY159EN",24,0)
 .S RCDVIFN=0,RCFLAG=0
"RTN","RCY159EN",25,0)
 .F RCDIVC=0:0 S RCDVIFN=$O(^RCT(349.1,RCIFN,6,RCDVIFN)) Q:'RCDVIFN!(RCFLAG)  S RCDVADD=$P($G(^RCT(349.1,RCIFN,6,RCDVIFN,0)),"^",2) D
"RTN","RCY159EN",26,0)
 ..I $G(RCDVADD)="" D BMES^XPDUTL("...Check/update subfield (.02) REMOTE DOMAIN in field (61) DIVISION OF CARE") D  Q 
"RTN","RCY159EN",27,0)
 ...D MES^XPDUTL("   in file 349.1 AR TRANSMISSION TYPE for all your divisions of care...") D BMES^XPDUTL(" ") D MES^XPDUTL("***The REMOTE DOMAIN must be populated with an address that starts with 'RC-'") D MES
"RTN","RCY159EN",28,0)
 ..I $G(RCDVADD)]""&($E($P($G(^DIC(4.2,RCDVADD,0)),U,1),1,3)="RC-") Q
"RTN","RCY159EN",29,0)
 ..I $G(RCDVADD)]"" D MES1,MES
"RTN","RCY159EN",30,0)
 I 'RCFLAG D BMES^XPDUTL(" Environment Check completed successfully... ")
"RTN","RCY159EN",31,0)
 Q
"RTN","RCY159EN",32,0)
MES ;D BMES^XPDUTL("...After file update, run 'Restart Install of Package(s)' under the Installation")
"RTN","RCY159EN",33,0)
 ;D MES^XPDUTL("   option of the Kernel Installation and Distributions System.") S XPDABORT=1,RCFLAG=1
"RTN","RCY159EN",34,0)
 D MES^XPDUTL("   Use option RC PARAMETERS EDIT  [PRCA RC PARAMETERS] to update this field.")
"RTN","RCY159EN",35,0)
 S XPDABORT=1,RCFLAG=1
"RTN","RCY159EN",36,0)
 Q
"RTN","RCY159EN",37,0)
MES1 D BMES^XPDUTL("...The REMOTE DOMAIN field is incorrectly populated and will not be properly") D MES^XPDUTL("   converted to the new Regional Counsel mail address.")
"RTN","RCY159EN",38,0)
 D BMES^XPDUTL("***The REMOTE DOMAIN must be populated with an address that starts with 'RC-'")
"RTN","RCY159EN",39,0)
 Q
"RTN","RCY159PO")
0^21^B49534614
"RTN","RCY159PO",1,0)
RCY159PO ;MAF/ALB - POST-INIT FOR PATCH PRCA*159 AR/RCI ;FEB 19,2004
"RTN","RCY159PO",2,0)
 ;;4.5;Accounts Receivable;**159**;Mar 20, 1995
"RTN","RCY159PO",3,0)
 D BMES^XPDUTL("This Post-Installation populates new fields (34) RC MAIL ADDRESS and ")
"RTN","RCY159PO",4,0)
 D MES^XPDUTL("(35) RC DEATH NOTIFICATION ADDRESS in file 349.1 AR TRANSMISSIONS TYPE")
"RTN","RCY159PO",5,0)
 D MES^XPDUTL("with the new Regional Counsel Mail Address and Death Notification addresses.")
"RTN","RCY159PO",6,0)
 I $D(^RCT(349.1,"B","RC")) S RCIFN=$O(^RCT(349.1,"B","RC",0)) I RCIFN]"",$D(^RCT(349.1,RCIFN,6,0)),$O(^RCT(349.1,RCIFN,6,0)) D
"RTN","RCY159PO",7,0)
 .D BMES^XPDUTL("If sites are currently testing the software for patch IB*2.0*159 and have")
"RTN","RCY159PO",8,0)
 .D MES^XPDUTL("information in the new DIVISION OF CARE field (61), this information will be")
"RTN","RCY159PO",9,0)
 .D MES^XPDUTL("updated with the new RC mail address and death notification address that")
"RTN","RCY159PO",10,0)
 .D MES^XPDUTL("corresponds with the division.")
"RTN","RCY159PO",11,0)
 .D BMES^XPDUTL("New fields (.03) RC MAIL ADDRESS and (.04) RC DEATH NOTIFICATION ADDRESS")
"RTN","RCY159PO",12,0)
 .D MES^XPDUTL("are updated in the DIVISION OF CARE multiple in file 349.1")
"RTN","RCY159PO",13,0)
 ;
"RTN","RCY159PO",14,0)
ARRAY ;This will update two new fields in file 349.1:
"RTN","RCY159PO",15,0)
 ;field RC MAIL ADDRESS #34
"RTN","RCY159PO",16,0)
 ;field RC DEATH NOTIFICATION ADDRESS #35 
"RTN","RCY159PO",17,0)
 ;with the new Regional Counsel addresses
"RTN","RCY159PO",18,0)
 ;D BMES^XPDUTL("...Updating field (34) RC MAIL ADDRESS ") 
"RTN","RCY159PO",19,0)
 ;D MES^XPDUTL("...Updating field (35) RC DEATH NOTIFICATIONS ADDRESS for file 349.1 ")
"RTN","RCY159PO",20,0)
 K ADDR
"RTN","RCY159PO",21,0)
 N ADDR,RCCT,RCSITE,RCRC,RCDOM,RCDETH,RCNEW,RCIFN,RCNODE,X
"RTN","RCY159PO",22,0)
 ;
"RTN","RCY159PO",23,0)
 ; find the primary RC mail address from file 349.1 field 33
"RTN","RCY159PO",24,0)
 I $D(^RCT(349.1,"B","RC")) S RCIFN=$O(^RCT(349.1,"B","RC",0)) I RCIFN]"" D
"RTN","RCY159PO",25,0)
 .S RCDOM=$P($G(^RCT(349.1,RCIFN,3)),"^",3)
"RTN","RCY159PO",26,0)
 .Q
"RTN","RCY159PO",27,0)
 I $G(RCDOM)="" D  G EXIT
"RTN","RCY159PO",28,0)
 .D BMES^XPDUTL("...There is no primary REMOTE DOMAIN.") D BMES^XPDUTL("...Please update field (32) REMOTE DOMAIN in AR TRANSMISSION TYPE file (349.1)") D MES^XPDUTL("   for the Regional Counsel (RC) type of transmission.")
"RTN","RCY159PO",29,0)
 .D BMES^XPDUTL("...After file update, run 'Restart Install of Package(s) under the Installation")
"RTN","RCY159PO",30,0)
 .D MES^XPDUTL("   option of the Kernel Installation and Distributions System.") S XPDABORT=1
"RTN","RCY159PO",31,0)
 .Q
"RTN","RCY159PO",32,0)
 D BMES^XPDUTL("...Updating field (34) RC MAIL ADDRESS ")
"RTN","RCY159PO",33,0)
 D MES^XPDUTL("...Updating field (35) RC DEATH NOTIFICATIONS ADDRESS for file 349.1 ")
"RTN","RCY159PO",34,0)
 D SETARR
"RTN","RCY159PO",35,0)
 I $D(ADDR(RCDOM)) D
"RTN","RCY159PO",36,0)
 .S RCNODE=ADDR(RCDOM),RCNEW=$P(RCNODE,"^",2),RCDETH=$P(RCNODE,"^",4)
"RTN","RCY159PO",37,0)
 .S DIE="^RCT(349.1,",DA=RCIFN,DR="34////^S X="""_RCNEW_""""_";35////^S X="""_RCDETH_""""
"RTN","RCY159PO",38,0)
 .D ^DIE K DIE,DA,DR
"RTN","RCY159PO",39,0)
 D BMES^XPDUTL("...Fields 34 and 35 have been updated for the primary site.")
"RTN","RCY159PO",40,0)
 ;I $D(^RCT(349.1,RCIFN,6,0)) D
"RTN","RCY159PO",41,0)
 I $D(^RCT(349.1,RCIFN,6,0)),$O(^RCT(349.1,RCIFN,6,0)) D
"RTN","RCY159PO",42,0)
 .D BMES^XPDUTL("...Updating DIVISION OF CARE MULTIPLE fields:") D MES^XPDUTL("   (.03) RC MAIL ADDRESS and (.04) RC DEATH NOTIFICATION ADDRESS")
"RTN","RCY159PO",43,0)
 .N RCNEW,RCNODE,RCDETH,RCDIVC,RCDVADD,RCDVIFN,X,RCDVSION
"RTN","RCY159PO",44,0)
 .S RCDVIFN=0
"RTN","RCY159PO",45,0)
 .F RCDIVC=0:0 S RCDVIFN=$O(^RCT(349.1,RCIFN,6,RCDVIFN)) Q:'RCDVIFN  S RCDVADD=$P($G(^RCT(349.1,RCIFN,6,RCDVIFN,0)),"^",2) I RCDVADD]"" D
"RTN","RCY159PO",46,0)
 ..S RCDOM=$P($G(^DIC(4.2,RCDVADD,0)),"^",1)
"RTN","RCY159PO",47,0)
 ..S RCDVSION=$P($G(^RCT(349.1,RCIFN,6,RCDVIFN,0)),"^",1)
"RTN","RCY159PO",48,0)
 ..I RCDOM]""&($D(ADDR(RCDOM))) S RCNODE=ADDR(RCDOM),RCNEW=$P(ADDR(RCDOM),"^",2),RCDETH=$P(ADDR(RCDOM),"^",4)
"RTN","RCY159PO",49,0)
 ..S DIE="^RCT(349.1,"_RCIFN_",6,",DA(1)=RCIFN,DA=RCDVIFN,DR=".03////^S X="""_RCNEW_""""_";.04////^S X="""_RCDETH_""""
"RTN","RCY159PO",50,0)
 ..;S DIE="^RCT(349.1,",DA=RCDVIFN,DR="61",DR(2,349.161)=".03////^S X="""_RCNEW_""""_";.04////^S X="""_RCDETH_""""
"RTN","RCY159PO",51,0)
 ..D ^DIE  K DIE,DA,DA(1),DR
"RTN","RCY159PO",52,0)
 ..D BMES^XPDUTL("...Fields (.03) and (.04) have been updated for "_$P($G(^DG(40.8,RCDVSION,0)),U,1))
"RTN","RCY159PO",53,0)
 D BMES^XPDUTL("Post-Installation Updates Complete.")
"RTN","RCY159PO",54,0)
 Q
"RTN","RCY159PO",55,0)
SETARR ;Set up the ADDR array with all of the addresses and information
"RTN","RCY159PO",56,0)
 F RCCT=1:1 S RCSITE=$P($T(ADDR+RCCT),";;",2) Q:RCSITE="END"  S ADDR($P(RCSITE,"^",1))=RCSITE
"RTN","RCY159PO",57,0)
 Q
"RTN","RCY159PO",58,0)
EXIT ;EXIT 
"RTN","RCY159PO",59,0)
 Q
"RTN","RCY159PO",60,0)
 Q
"RTN","RCY159PO",61,0)
 ;Regional Counsel Addresses old and new
"RTN","RCY159PO",62,0)
 ;piece 1 old address to RC 
"RTN","RCY159PO",63,0)
 ;piece 2 new RC address
"RTN","RCY159PO",64,0)
 ;piece 3 old RC death notification address
"RTN","RCY159PO",65,0)
 ;piece 4 new RC death notification address
"RTN","RCY159PO",66,0)
ADDR ;
"RTN","RCY159PO",67,0)
 ;;RC-BOSTON.GC.VA.GOV^OGCBOSRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-BOSTON.GC.VA.GOV^OGCRegion1DeathNotification@mail.va.gov
"RTN","RCY159PO",68,0)
 ;;RC-NEWYORK.GC.VA.GOV^OGCNYNRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-NEWYORK.GC.VA.GOV^OGCRegion2DeathNotification@mail.va.gov
"RTN","RCY159PO",69,0)
 ;;RC-BALTIMORE.GC.VA.GOV^OGCBALRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-BALTIMORE.GC.VA.GOV^OGCRegion3DeathNotification@mail.va.gov
"RTN","RCY159PO",70,0)
 ;;RC-PHILADELP.GC.VA.GOV^OGCPHIRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-PHILADELP.GC.VA.GOV^OGCRegion4DeathNotification@mail.va.gov
"RTN","RCY159PO",71,0)
 ;;RC-ATLANTA.GC.VA.GOV^OGCATLRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-ATLANTA.GC.VA.GOV^OGCRegion5DeathNotification@mail.va.gov
"RTN","RCY159PO",72,0)
 ;;RC-BAY-PINES.GC.VA.GOV^OGCBAYRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-BAY-PINES.GC.VA.GOV^OGCRegion6DeathNotification@mail.va.gov
"RTN","RCY159PO",73,0)
 ;;RC-CLEVELAND.GC.VA.GOV^OGCCLERI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-CLEVELAND.GC.VA.GOV^OGCRegion7DeathNotification@mail.va.gov
"RTN","RCY159PO",74,0)
 ;;RC-NASHVILLE.GC.VA.GOV^OGCNASRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-NASHVILLE.GC.VA.GOV^OGCRegion8DeathNotification@mail.va.gov
"RTN","RCY159PO",75,0)
 ;;RC-JACKSON.GC.VA.GOV^OGCJACRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-JACKSON.GC.VA.GOV^OGCRegion9DeathNotification@mail.va.gov
"RTN","RCY159PO",76,0)
 ;;RC-CHICAGO.GC.VA.GOV^OGCCHIRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-CHICAGO.GC.VA.GOV^OGCRegion10DeathNotification@mail.va.gov
"RTN","RCY159PO",77,0)
 ;;RC-DETROIT.GC.VA.GOV^OGCDETRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-DETROIT.GC.VA.GOV^OGCRegion11DeathNotification@mail.va.gov
"RTN","RCY159PO",78,0)
 ;;RC-STLOUIS.GC.VA.GOV^OGCSTLRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-STLOUIS.GC.VA.GOV^OGCRegion12DeathNotification@mail.va.gov
"RTN","RCY159PO",79,0)
 ;;RC-WACO.GC.VA.GOV^OGCWACRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-WACO.GC.VA.GOV^OGCRegion13DeathNotification@mail.va.gov
"RTN","RCY159PO",80,0)
 ;;RC-HOUSTON.GC.VA.GOV^OGCHOURI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-HOUSTON.GC.VA.GOV^OGCRegion14DeathNotification@mail.va.gov
"RTN","RCY159PO",81,0)
 ;;RC-MINNEAPO.GC.VA.GOV^OGCMINRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-MINNEAPO.GC.VA.GOV^OGCRegion15DeathNotification@mail.va.gov
"RTN","RCY159PO",82,0)
 ;;RC-DENVER.GC.VA.GOV^OGCDENRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-DENVER.GC.VA.GOV^OGCRegion16DeathNotification@mail.va.gov
"RTN","RCY159PO",83,0)
 ;;RC-LOSANG.GC.VA.GOV^OGCLOSRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-LOSANG.GC.VA.GOV^OGCRegion17DeathNotification@mail.va.gov
"RTN","RCY159PO",84,0)
 ;;RC-SANFRAN.GC.VA.GOV^OGCSFCRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-SANFRAN.GC.VA.GOV^OGCRegion18DeathNotification@mail.va.gov
"RTN","RCY159PO",85,0)
 ;;RC-PHOENIX.GC.VA.GOV^OGCPHORI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-PHOENIX.GC.VA.GOV^OGCRegion19DeathNotification@mail.va.gov
"RTN","RCY159PO",86,0)
 ;;RC-PORTLAND.GC.VA.GOV^OGCPORRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-PORTLAND.GC.VA.GOV^OGCRegion20DeathNotification@mail.va.gov
"RTN","RCY159PO",87,0)
 ;;RC-BUFFALO.GC.VA.GOV^OGCBUFRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-BUFFALO.GC.VA.GOV^OGCRegion21DeathNotification@mail.va.gov
"RTN","RCY159PO",88,0)
 ;;RC-INDIANAPO.GC.VA.GOV^OGCINDRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-INDIANAPO.GC.VA.GOV^OGCRegion22DeathNotification@mail.va.gov
"RTN","RCY159PO",89,0)
 ;;RC-WINSTON.GC.VA.GOV^OGCWINRI@MAIL.VA.GOV^G.RC RC REFERRALS@RC-WINSTON.GC.VA.GOV^OGCRegion23DeathNotification@mail.va.gov
"RTN","RCY159PO",90,0)
 ;;END
"VER")
8.0^22
"^DD",349.1,349.1,0)
FIELD^^35^16
"^DD",349.1,349.1,0,"DDA")
N
"^DD",349.1,349.1,0,"DT")
3040429
"^DD",349.1,349.1,0,"IX","B",349.1,.01)

"^DD",349.1,349.1,0,"NM","AR TRANSMISSION TYPE")

"^DD",349.1,349.1,0,"PT",349.9,.01)

"^DD",349.1,349.1,0,"VRPK")
PRCA
"^DD",349.1,349.1,.01,0)
CODE^RF^^0;1^K:$L(X)>10!($L(X)<2)!'(X'?1P.E) X
"^DD",349.1,349.1,.01,1,0)
^.1
"^DD",349.1,349.1,.01,1,1,0)
349.1^B
"^DD",349.1,349.1,.01,1,1,1)
S ^RCT(349.1,"B",$E(X,1,30),DA)=""
"^DD",349.1,349.1,.01,1,1,2)
K ^RCT(349.1,"B",$E(X,1,30),DA)
"^DD",349.1,349.1,.01,3)
Answer must be 2-10 characters in length.
"^DD",349.1,349.1,.01,21,0)
^.001^1^1^3040601^^^
"^DD",349.1,349.1,.01,21,1,0)
This field will hold the unique codes for the transmission types.
"^DD",349.1,349.1,.01,23,0)
^^1^1^3040601^
"^DD",349.1,349.1,.01,23,1,0)
 
"^DD",349.1,349.1,.01,"DT")
2960216
"^DD",349.1,349.1,.02,0)
EXPANDED NAME^F^^0;2^K:$L(X)>30!($L(X)<3) X
"^DD",349.1,349.1,.02,3)
Answer must be 3-30 characters in length.
"^DD",349.1,349.1,.02,21,0)
^^1^1^2960216^^
"^DD",349.1,349.1,.02,21,1,0)
This is the expanded name of the transmission type.
"^DD",349.1,349.1,.02,"DT")
2960216
"^DD",349.1,349.1,.03,0)
ACTIVE^S^0:NO;1:YES;^0;3^Q
"^DD",349.1,349.1,.03,21,0)
^^1^1^2960216^
"^DD",349.1,349.1,.03,21,1,0)
This field will indicate if the transmission type is being used.
"^DD",349.1,349.1,.03,"DT")
2960216
"^DD",349.1,349.1,.04,0)
PURGE FREQUENCY^NJ4,0^^0;4^K:+X'=X!(X>3650)!(X<30)!(X?.E1"."1N.N) X
"^DD",349.1,349.1,.04,3)
Type a Number between 30 and 3650, 0 Decimal Digits
"^DD",349.1,349.1,.04,21,0)
^^2^2^2960216^^
"^DD",349.1,349.1,.04,21,1,0)
This field indicates if and when a purge of the entries will take
"^DD",349.1,349.1,.04,21,2,0)
place.
"^DD",349.1,349.1,.04,23,0)
^^2^2^2960216^
"^DD",349.1,349.1,.04,23,1,0)
Number of days that transmission records are on-line before
"^DD",349.1,349.1,.04,23,2,0)
purging occurs.
"^DD",349.1,349.1,.04,"DT")
2960216
"^DD",349.1,349.1,1,0)
LOCAL ADDRESSEE^349.11P^^1;0
"^DD",349.1,349.1,2,0)
LOCAL MAILGROUP^349.12P^^2;0
"^DD",349.1,349.1,31,0)
REMOTE ADDRESSEE^F^^3;1^K:$L(X)>30!($L(X)<1)!'(X?.A) X
"^DD",349.1,349.1,31,3)
Answer must be 1-30 characters in length.
"^DD",349.1,349.1,31,21,0)
^^1^1^2960430^^^
"^DD",349.1,349.1,31,21,1,0)
This is the addressee name at the remote domain.
"^DD",349.1,349.1,31,"DT")
2960430
"^DD",349.1,349.1,32,0)
REMOTE DOMAIN^P4.2'^DIC(4.2,^3;2^Q
"^DD",349.1,349.1,32,1,0)
^.1
"^DD",349.1,349.1,32,1,1,0)
^^TRIGGER^349.1^33
"^DD",349.1,349.1,32,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RCT(349.1,D0,3)):^(3),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y X ^DD(349.1,32,1,1,1.1) X ^DD(349.1,32,1,1,1.4)
"^DD",349.1,349.1,32,1,1,1.1)
S X=DIV S I(0,0)=$S($D(D0):D0,1:""),D0=DIV S:'$D(^DIC(4.2,+D0,0)) D0=-1 S Y(101)=$S($D(^DIC(4.2,D0,0)):^(0),1:"") S X=$P(Y(101),U,1) S D0=I(0,0)
"^DD",349.1,349.1,32,1,1,1.4)
S DIH=$S($D(^RCT(349.1,DIV(0),3)):^(3),1:""),DIV=X S $P(^(3),U,3)=DIV,DIH=349.1,DIG=33 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",349.1,349.1,32,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^RCT(349.1,D0,3)):^(3),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" X ^DD(349.1,32,1,1,2.4)
"^DD",349.1,349.1,32,1,1,2.4)
S DIH=$S($D(^RCT(349.1,DIV(0),3)):^(3),1:""),DIV=X S $P(^(3),U,3)=DIV,DIH=349.1,DIG=33 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",349.1,349.1,32,1,1,"CREATE VALUE")
REMOTE DOMAIN:.01
"^DD",349.1,349.1,32,1,1,"DELETE VALUE")
@
"^DD",349.1,349.1,32,1,1,"FIELD")
DOMAIN NAME
"^DD",349.1,349.1,32,21,0)
^.001^2^2^3000524^^^
"^DD",349.1,349.1,32,21,1,0)
This is the remote domain where the transmission record is being
"^DD",349.1,349.1,32,21,2,0)
sent.
"^DD",349.1,349.1,32,"DT")
2960902
"^DD",349.1,349.1,33,0)
DOMAIN NAME^F^^3;3^K:$L(X)>30!($L(X)<3) X
"^DD",349.1,349.1,33,3)
Answer must be 3-30 characters in length.
"^DD",349.1,349.1,33,5,1,0)
349.1^32^1
"^DD",349.1,349.1,33,9)
^
"^DD",349.1,349.1,33,21,0)
^^1^1^2960902^
"^DD",349.1,349.1,33,21,1,0)
This is the name of the DOMAIN from file 4.2 DOMAIN.
"^DD",349.1,349.1,33,"DT")
2960902
"^DD",349.1,349.1,34,0)
RC MAIL ADDRESS^RFX^^3;4^K:$L(X)>30!($L(X)<3) X
"^DD",349.1,349.1,34,3)
Answer must be 3-30 characters in length.
"^DD",349.1,349.1,34,4)
D MAILADD^RCRCXMS
"^DD",349.1,349.1,34,21,0)
^.001^2^2^3040429^^^^
"^DD",349.1,349.1,34,21,1,0)
This field will contain the Regional Counsel mail address for the
"^DD",349.1,349.1,34,21,2,0)
primary site.  It will be the default mail address.
"^DD",349.1,349.1,34,23,0)
^.001^1^1^3040429^^^^
"^DD",349.1,349.1,34,23,1,0)
 
"^DD",349.1,349.1,34,"DT")
3040407
"^DD",349.1,349.1,35,0)
RC DEATH NOTIFICATION ADDRESS^RF^^3;5^K:$L(X)>40!($L(X)<2) X
"^DD",349.1,349.1,35,3)
Answer must be 2-40 characters in length.
"^DD",349.1,349.1,35,4)
D DEATHADD^RCRCXMS
"^DD",349.1,349.1,35,21,0)
^.001^3^3^3040429^^^^
"^DD",349.1,349.1,35,21,1,0)
This field contains the Regional Counsel mail address for death
"^DD",349.1,349.1,35,21,2,0)
notifications for the primary site.  This will be the default for death
"^DD",349.1,349.1,35,21,3,0)
notifications.
"^DD",349.1,349.1,35,23,0)
^.001^1^1^3040429^^^^
"^DD",349.1,349.1,35,23,1,0)
 
"^DD",349.1,349.1,35,"DT")
3040428
"^DD",349.1,349.1,41,0)
LAST MESSAGE ACK^NJ3,0^^4;1^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",349.1,349.1,41,3)
Type a Number between 1 and 999, 0 Decimal Digits
"^DD",349.1,349.1,41,21,0)
^^1^1^2960828^
"^DD",349.1,349.1,41,21,1,0)
Number of last message type sent from CCPC.
"^DD",349.1,349.1,41,"DT")
2960828
"^DD",349.1,349.1,42,0)
FINAL MESSAGE ACK^NJ3,0^^4;2^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",349.1,349.1,42,3)
Type a Number between 1 and 999, 0 Decimal Digits
"^DD",349.1,349.1,42,21,0)
^^1^1^2960828^
"^DD",349.1,349.1,42,21,1,0)
Final message number of this type from CCPC.
"^DD",349.1,349.1,42,"DT")
2960828
"^DD",349.1,349.1,43,0)
LAST MESSAGE NUMBER^NJ8,0^^4;3^K:+X'=X!(X>99999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",349.1,349.1,43,3)
Type a Number between 1 and 99999999, 0 Decimal Digits
"^DD",349.1,349.1,43,21,0)
^^2^2^2961205^^
"^DD",349.1,349.1,43,21,1,0)
This is the last message number of this type for the transmission from
"^DD",349.1,349.1,43,21,2,0)
CCPC.
"^DD",349.1,349.1,43,"DT")
2960828
"^DD",349.1,349.1,51,0)
ACK MESSAGES^349.151A^^5;0
"^DD",349.1,349.1,61,0)
DIVISION OF CARE^349.161PA^^6;0
"^DD",349.1,349.1,61,21,0)
^.001^4^4^3040517^^^^
"^DD",349.1,349.1,61,21,1,0)
This field is a multiple that allows divisions to be entered if their
"^DD",349.1,349.1,61,21,2,0)
Regional Counsel mail addresses and death notification addresses are 
"^DD",349.1,349.1,61,21,3,0)
different from the primary addresses.
"^DD",349.1,349.1,61,21,4,0)
 
"^DD",349.1,349.1,61,23,0)
^.001^1^1^3040517^^^^
"^DD",349.1,349.1,61,23,1,0)
 
"^DD",349.1,349.1,61,"DT")
3040514
"^DD",349.1,349.11,0)
LOCAL ADDRESSEE SUB-FIELD^^.01^1
"^DD",349.1,349.11,0,"DT")
2960216
"^DD",349.1,349.11,0,"IX","B",349.11,.01)

"^DD",349.1,349.11,0,"NM","LOCAL ADDRESSEE")

"^DD",349.1,349.11,0,"UP")
349.1
"^DD",349.1,349.11,.01,0)
LOCAL ADDRESSEE^MP200'^VA(200,^0;1^Q
"^DD",349.1,349.11,.01,1,0)
^.1
"^DD",349.1,349.11,.01,1,1,0)
349.11^B
"^DD",349.1,349.11,.01,1,1,1)
S ^RCT(349.1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",349.1,349.11,.01,1,1,2)
K ^RCT(349.1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",349.1,349.11,.01,21,0)
^^2^2^2960216^
"^DD",349.1,349.11,.01,21,1,0)
The local users who wish to be recepients of the transmission messages
"^DD",349.1,349.11,.01,21,2,0)
will named in this field.
"^DD",349.1,349.11,.01,"DT")
2960216
"^DD",349.1,349.12,0)
LOCAL MAILGROUP SUB-FIELD^^.01^1
"^DD",349.1,349.12,0,"DT")
2960216
"^DD",349.1,349.12,0,"IX","B",349.12,.01)

"^DD",349.1,349.12,0,"NM","LOCAL MAILGROUP")

"^DD",349.1,349.12,0,"UP")
349.1
"^DD",349.1,349.12,.01,0)
LOCAL MAILGROUP^MP3.8'^XMB(3.8,^0;1^Q
"^DD",349.1,349.12,.01,1,0)
^.1
"^DD",349.1,349.12,.01,1,1,0)
349.12^B
"^DD",349.1,349.12,.01,1,1,1)
S ^RCT(349.1,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",349.1,349.12,.01,1,1,2)
K ^RCT(349.1,DA(1),2,"B",$E(X,1,30),DA)
"^DD",349.1,349.12,.01,21,0)
^^2^2^2960216^
"^DD",349.1,349.12,.01,21,1,0)
This field is used to define any mailgroups which should receive the
"^DD",349.1,349.12,.01,21,2,0)
transmission messages.
"^DD",349.1,349.12,.01,"DT")
2960216
"^DD",349.1,349.151,0)
ACK MESSAGES SUB-FIELD^^.03^3
"^DD",349.1,349.151,0,"DT")
2961205
"^DD",349.1,349.151,0,"NM","ACK MESSAGES")

"^DD",349.1,349.151,0,"UP")
349.1
"^DD",349.1,349.151,.01,0)
ACK MESSAGES^F^^0;1^K:$L(X)>80!($L(X)<3) X
"^DD",349.1,349.151,.01,1,0)
^.1^^0
"^DD",349.1,349.151,.01,3)
Answer must be 3-80 characters in length.
"^DD",349.1,349.151,.01,21,0)
^^1^1^2970106^^
"^DD",349.1,349.151,.01,21,1,0)
This multiple will store the Acknowlegment messages from Austin.
"^DD",349.1,349.151,.01,"DT")
2961114
"^DD",349.1,349.151,.02,0)
ACCOUNT/SEG ID^F^^0;2^K:$L(X)>25!($L(X)<3) X
"^DD",349.1,349.151,.02,3)
Answer must be 3-25 characters in length.
"^DD",349.1,349.151,.02,21,0)
^^1^1^2961114^
"^DD",349.1,349.151,.02,21,1,0)
This field stores the account id for the record.
"^DD",349.1,349.151,.02,"DT")
2961205
"^DD",349.1,349.151,.03,0)
ACCOUNT/SEG INFO^F^^0;3^K:$L(X)>40!($L(X)<3) X
"^DD",349.1,349.151,.03,3)
Answer must be 3-40 characters in length.
"^DD",349.1,349.151,.03,21,0)
^^1^1^2961114^
"^DD",349.1,349.151,.03,21,1,0)
This field will store the detailed information about the record if any.
"^DD",349.1,349.151,.03,"DT")
2961205
"^DD",349.1,349.161,0)
DIVISION OF CARE SUB-FIELD^^.04^4
"^DD",349.1,349.161,0,"DT")
3040429
"^DD",349.1,349.161,0,"IX","B",349.161,.01)

"^DD",349.1,349.161,0,"NM","DIVISION OF CARE")

"^DD",349.1,349.161,0,"UP")
349.1
"^DD",349.1,349.161,.01,0)
DIVISION OF CARE^P40.8'^DG(40.8,^0;1^Q
"^DD",349.1,349.161,.01,1,0)
^.1
"^DD",349.1,349.161,.01,1,1,0)
349.161^B
"^DD",349.1,349.161,.01,1,1,1)
S ^RCT(349.1,DA(1),6,"B",$E(X,1,30),DA)=""
"^DD",349.1,349.161,.01,1,1,2)
K ^RCT(349.1,DA(1),6,"B",$E(X,1,30),DA)
"^DD",349.1,349.161,.01,21,0)
^.001^1^1^3040517^^^^
"^DD",349.1,349.161,.01,21,1,0)
Enter divisions of care where bill charges originate for this site.
"^DD",349.1,349.161,.01,"DT")
3000524
"^DD",349.1,349.161,.02,0)
REMOTE DOMAIN^P4.2'^DIC(4.2,^0;2^Q
"^DD",349.1,349.161,.02,3)

"^DD",349.1,349.161,.02,21,0)
^.001^1^1^3000524^^
"^DD",349.1,349.161,.02,21,1,0)
This is the Remote Domain address where transmissions will be sent for this division.
"^DD",349.1,349.161,.02,"DT")
3000524
"^DD",349.1,349.161,.03,0)
RC MAIL ADDRESS^F^^0;3^K:$L(X)>30!($L(X)<3) X
"^DD",349.1,349.161,.03,3)
Answer must be 3-30 characters in length.
"^DD",349.1,349.161,.03,4)
D MAILADD^RCRCXMS
"^DD",349.1,349.161,.03,21,0)
^.001^4^4^3040429^^
"^DD",349.1,349.161,.03,21,1,0)
This field will contain the name of the Regional Counsel mail address
"^DD",349.1,349.161,.03,21,2,0)
that transactions from the associated Division of Care will be sent.
"^DD",349.1,349.161,.03,21,3,0)
This fields address will be different from the primary division's
"^DD",349.1,349.161,.03,21,4,0)
RC mail address.
"^DD",349.1,349.161,.03,23,0)
^^1^1^3040429^
"^DD",349.1,349.161,.03,23,1,0)
 
"^DD",349.1,349.161,.03,"DT")
3040325
"^DD",349.1,349.161,.04,0)
RC DEATH NOTIFICATION ADDRESS^F^^0;4^K:$L(X)>40!($L(X)<3) X
"^DD",349.1,349.161,.04,3)
Answer must be 3-40 characters in length.
"^DD",349.1,349.161,.04,4)
D DEATHADD^RCRCXMS
"^DD",349.1,349.161,.04,21,0)
^.001^4^4^3040429^^^
"^DD",349.1,349.161,.04,21,1,0)
This field will contain the name of the RC death notifications address
"^DD",349.1,349.161,.04,21,2,0)
that death notices from the associated Division of Care will be sent.
"^DD",349.1,349.161,.04,21,3,0)
This fields address will be different from the primary division's
"^DD",349.1,349.161,.04,21,4,0)
RC death notification address.
"^DD",349.1,349.161,.04,23,0)
^.001^1^1^3040429^^
"^DD",349.1,349.161,.04,23,1,0)
 
"^DD",349.1,349.161,.04,"DT")
3040429
"^DIC",349.1,349.1,0)
AR TRANSMISSION TYPE^349.1
"^DIC",349.1,349.1,0,"GL")
^RCT(349.1,
"^DIC",349.1,349.1,"%D",0)
^^2^2^2960215^^^
"^DIC",349.1,349.1,"%D",1,0)
This file stores the transmission types used in file 349
"^DIC",349.1,349.1,"%D",2,0)
AR TRANSMISSION RECORDS.
"^DIC",349.1,"B","AR TRANSMISSION TYPE",349.1)

**END**
**END**
