Released DG*5.3*645 SEQ #574
Extracted from mail message
**KIDS**:DG*5.3*645^

**INSTALL NAME**
DG*5.3*645
"BLD",5997,0)
DG*5.3*645^REGISTRATION^0^3050131^y
"BLD",5997,1,0)
^^2^2^3050131^
"BLD",5997,1,1,0)
The patch will modify the PTF transmission message to 
"BLD",5997,1,2,0)
  include up to 13 diagnoses from the PTF.
"BLD",5997,4,0)
^9.64PA^^
"BLD",5997,"KRN",0)
^9.67PA^8989.52^19
"BLD",5997,"KRN",.4,0)
.4
"BLD",5997,"KRN",.401,0)
.401
"BLD",5997,"KRN",.402,0)
.402
"BLD",5997,"KRN",.403,0)
.403
"BLD",5997,"KRN",.5,0)
.5
"BLD",5997,"KRN",.84,0)
.84
"BLD",5997,"KRN",3.6,0)
3.6
"BLD",5997,"KRN",3.8,0)
3.8
"BLD",5997,"KRN",9.2,0)
9.2
"BLD",5997,"KRN",9.8,0)
9.8
"BLD",5997,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5997,"KRN",9.8,"NM",1,0)
DGPTFTR^^0^B19046836
"BLD",5997,"KRN",9.8,"NM",2,0)
DGPTR4^^0^B16197486
"BLD",5997,"KRN",9.8,"NM","B","DGPTFTR",1)
 
"BLD",5997,"KRN",9.8,"NM","B","DGPTR4",2)
 
"BLD",5997,"KRN",19,0)
19
"BLD",5997,"KRN",19.1,0)
19.1
"BLD",5997,"KRN",101,0)
101
"BLD",5997,"KRN",409.61,0)
409.61
"BLD",5997,"KRN",771,0)
771
"BLD",5997,"KRN",870,0)
870
"BLD",5997,"KRN",8989.51,0)
8989.51
"BLD",5997,"KRN",8989.52,0)
8989.52
"BLD",5997,"KRN",8994,0)
8994
"BLD",5997,"KRN","B",.4,.4)
 
"BLD",5997,"KRN","B",.401,.401)
 
"BLD",5997,"KRN","B",.402,.402)
 
"BLD",5997,"KRN","B",.403,.403)
 
"BLD",5997,"KRN","B",.5,.5)
 
"BLD",5997,"KRN","B",.84,.84)
 
"BLD",5997,"KRN","B",3.6,3.6)
 
"BLD",5997,"KRN","B",3.8,3.8)
 
"BLD",5997,"KRN","B",9.2,9.2)
 
"BLD",5997,"KRN","B",9.8,9.8)
 
"BLD",5997,"KRN","B",19,19)
 
"BLD",5997,"KRN","B",19.1,19.1)
 
"BLD",5997,"KRN","B",101,101)
 
"BLD",5997,"KRN","B",409.61,409.61)
 
"BLD",5997,"KRN","B",771,771)
 
"BLD",5997,"KRN","B",870,870)
 
"BLD",5997,"KRN","B",8989.51,8989.51)
 
"BLD",5997,"KRN","B",8989.52,8989.52)
 
"BLD",5997,"KRN","B",8994,8994)
 
"BLD",5997,"QUES",0)
^9.62^^
"BLD",5997,"REQB",0)
^9.611^2^2
"BLD",5997,"REQB",1,0)
DG*5.3*614^1
"BLD",5997,"REQB",2,0)
DG*5.3*565^1
"BLD",5997,"REQB","B","DG*5.3*565",2)
 
"BLD",5997,"REQB","B","DG*5.3*614",1)
 
"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
645^3050131
"PKG",5,22,1,"PAH",1,1,0)
^^2^2^3050131
"PKG",5,22,1,"PAH",1,1,1,0)
The patch will modify the PTF transmission message to 
"PKG",5,22,1,"PAH",1,1,2,0)
  include up to 13 diagnoses from the PTF.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")
 
"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","DGPTFTR")
0^1^B19046836
"RTN","DGPTFTR",1,0)
DGPTFTR ;ALB/JDS - TRANSMISSION OF PTF ; 1/31/05 11:53am
"RTN","DGPTFTR",2,0)
 ;;5.3;Registration;**37,415,530,601,614,645**;Aug 13, 1993
"RTN","DGPTFTR",3,0)
 ;
"RTN","DGPTFTR",4,0)
ENN L ^DGP(45.83):5 I '$T W !,"Already transmitting" Q
"RTN","DGPTFTR",5,0)
 D CEN^DGPTUTL
"RTN","DGPTFTR",6,0)
 I '$D(DGRTY) S Y=1 D RTY^DGPTUTL
"RTN","DGPTFTR",7,0)
 D FDT^DGPTUTL S DGFMTDT=Y
"RTN","DGPTFTR",8,0)
 ;
"RTN","DGPTFTR",9,0)
EN5 K DIC S DIC=45.83,DIC(0)="AMZEQ",DIC("A")="Enter Start Date: "
"RTN","DGPTFTR",10,0)
 S DIC("S")="I $O(^DGP(45.83,+Y,""P"",0)) F DGX=0:0 S DGX=$O(^DGP(45.83,+Y,""P"",DGX)) Q:'DGX  I '$P(^DGP(45.83,+Y,""P"",DGX,0),U,2),$D(^DGPT(DGX,0)),$D(^(70)),+^(70)>2901000,$P(^(0),U,11)=+DGRTY Q"
"RTN","DGPTFTR",11,0)
 S D="ANT" D IX^DIC G ENQ1:X["^"!(X=""),EN5:Y'>0
"RTN","DGPTFTR",12,0)
 S DGSD=+Y(0),DIC(0)="EAMZQ",DIC("S")="I Y'<DGSD"_" "_DIC("S"),DIC("A")="Enter Through Date: TODAY//  ",D="ANT" D IX^DIC K DIC,D
"RTN","DGPTFTR",13,0)
 ;
"RTN","DGPTFTR",14,0)
 G ENQ1:X["^" S DGED=$S(Y>0:+Y(0),1:DT)
"RTN","DGPTFTR",15,0)
 ; -- 125 cols
"RTN","DGPTFTR",16,0)
 S VATNAME="PTF125" D ^VATRAN I VATERR K VATNAME,VATERR,VAT L  G ENQ
"RTN","DGPTFTR",17,0)
 S DGFMT=2 D SCAN G:DGOUTX ENQ1
"RTN","DGPTFTR",18,0)
ENQ D SCAN^DGPTFTR3
"RTN","DGPTFTR",19,0)
ENQ1 L  K DGACNT,DGXM,XMDUN,XMY,DGOUTX,DGSTCNT,DIC,DGX,DGRTY,DGRTY0,DGCN,DGCN0,DGPTFMT,DGFMT,DGFMTDT,DGLOGIC,VAT,VATERR,VATNAME,DGSD,DGED
"RTN","DGPTFTR",20,0)
 Q
"RTN","DGPTFTR",21,0)
 ;
"RTN","DGPTFTR",22,0)
SCAN K DGERR S DGPTFMT=2 D LOG S DGCNT=1,DGD=DGSD-.01,DGTR=0,DGID=1
"RTN","DGPTFTR",23,0)
 ; DG*5.3*614 - DGFIRST identifies first record in a batch
"RTN","DGPTFTR",24,0)
 N DGFIRST S DGFIRST=1
"RTN","DGPTFTR",25,0)
 W !!,"Now transmitting 125 column ",$P(DGRTY0,U)," records..."
"RTN","DGPTFTR",26,0)
 W !,"Includes records of "
"RTN","DGPTFTR",27,0)
 ;
"RTN","DGPTFTR",28,0)
DAT D:DGCNT>1 XMIT S DGD=$O(^DGP(45.83,DGD))
"RTN","DGPTFTR",29,0)
 I DGD>0,DGD'>DGED D SETTRAN^DGPTUTL1 Q:DGOUTX
"RTN","DGPTFTR",30,0)
 I DGD'>0!(DGD>DGED) D BULL^DGPTFTR3 G DATQ
"RTN","DGPTFTR",31,0)
 S J=0 G PWR
"RTN","DGPTFTR",32,0)
DATQ Q
"RTN","DGPTFTR",33,0)
 ;
"RTN","DGPTFTR",34,0)
PWR S P=J,J=$O(^DGP(45.83,DGD,"P",J)) G DAT:J'>0,PWR:$P(^(J,0),U,2)
"RTN","DGPTFTR",35,0)
 I $D(^DGPT(J,0)),$P(^(0),U,11)'=+DGRTY G PWR
"RTN","DGPTFTR",36,0)
 I $P(DGCN0,U,3)>DT,DGRTY=1 D CEN^DGPTFTR3 G PWR:'Y
"RTN","DGPTFTR",37,0)
 S Y=$S($D(^DGPT(J,70)):+^(70),1:0) D FMT^DGPTUTL G PWR:DGPTFMT'=DGFMT
"RTN","DGPTFTR",38,0)
 S T1=0,T2=9999999,Y=J,X=0 S:DGRTY=2 T2=+DGCN0_".9",T1=+$P(DGCN0,U,5) D LINES^DGPTFVC2 I (DGCNT+X)>VAT("F"),'$G(DGFIRST) S J=P G XMIT
"RTN","DGPTFTR",39,0)
 I $G(DGFIRST)=1 S DGFIRST=0
"RTN","DGPTFTR",40,0)
 K DICR S DGERR=0,DGSTCNT("P",J)=DGCNT
"RTN","DGPTFTR",41,0)
 W !,$E($P(^DPT(+^DGPT(J,0),0),U),1,25),?27,"(#",J,")" S X=^DGPT(J,0) D WR^DGPTF
"RTN","DGPTFTR",42,0)
 K ^TMP("AEDIT",$J),^TMP("AERROR",$J) S DGACNT=0
"RTN","DGPTFTR",43,0)
 I DGRTY=1 D COM
"RTN","DGPTFTR",44,0)
 I DGRTY=2 S T2=+DGCN0_".9",T1=+$P(DGCN0,U,5),(PTF,DGCI)=J D COM1
"RTN","DGPTFTR",45,0)
 I DGERR D OPEN^DGPTFTR3
"RTN","DGPTFTR",46,0)
 K ^TMP("AEDIT",$J)
"RTN","DGPTFTR",47,0)
 I 'DGERR W ?70," Okay" S DGTR=DGTR+1 G XMIT:DGCNT>VAT("F")
"RTN","DGPTFTR",48,0)
 G PWR
"RTN","DGPTFTR",49,0)
 Q
"RTN","DGPTFTR",50,0)
 ;
"RTN","DGPTFTR",51,0)
XMIT K XMY D ROUTER
"RTN","DGPTFTR",52,0)
 S XMZ=DGXMZ,^XMB(3.9,XMZ,2,0)="^3.92A^"_(DGCNT-1)_"^"_(DGCNT-1)_"^"_DT,DGJ=J
"RTN","DGPTFTR",53,0)
 S XMDUZ=.5,XMDUN=$P(^VA(200,DUZ,0),U) D ENT1^XMD
"RTN","DGPTFTR",54,0)
 W !,"Transmission Queued" S DGIDN(DGID)=XMZ
"RTN","DGPTFTR",55,0)
 F DGK=0:0 S DGK=$O(DGSTCNT("P",DGK)) Q:DGK'>0  D REC
"RTN","DGPTFTR",56,0)
 S DGFIRST=1
"RTN","DGPTFTR",57,0)
 K DGK S DGCNT=1,DGID=DGID+1,J=DGJ Q:J'>0  D SETTRAN^DGPTUTL1 G:'DGOUTX PWR
"RTN","DGPTFTR",58,0)
 Q
"RTN","DGPTFTR",59,0)
 ;
"RTN","DGPTFTR",60,0)
REC ;
"RTN","DGPTFTR",61,0)
 S DGSENFLG=""
"RTN","DGPTFTR",62,0)
 S DIE="^DGP(45.83,",DA=DGD,DR="10///"_DGK,DR(2,45.831)="1///TODAY;2///"_XMZ D ^DIE K DA,DR,DIE
"RTN","DGPTFTR",63,0)
 S DIE="^DGPT(",DR="6///3",DA=DGK D ^DIE K DA,DR,DIE
"RTN","DGPTFTR",64,0)
 K DGSENFLG
"RTN","DGPTFTR",65,0)
 Q
"RTN","DGPTFTR",66,0)
 ;
"RTN","DGPTFTR",67,0)
COM S T1=0,T2=9999999 S:'$D(PTF) PTF=J S:PTF'=J PTF=J
"RTN","DGPTFTR",68,0)
COM1 F K=0,70,71,101,"401P" S @("DG"_K)=$S($D(^DGPT(J,K)):^(K),1:"")
"RTN","DGPTFTR",69,0)
 F K=10,.11,.3,.32,.321,.52,57 S @("DG"_$S(K[".":$E(K,2,99),1:K))=$S($D(^DGP(45.84,J,K)):^(K),$D(^DPT(+^DGPT(J,0),$S(K'=10:K,1:0))):$S(K'=10:^(K),1:^(0)),1:"")
"RTN","DGPTFTR",70,0)
 F K=.02,.06 M @("DG"_$S(K[".":$E(K,2,99),1:K))=^DPT(+^DGPT(J,0),K)
"RTN","DGPTFTR",71,0)
 D ^DGPTFTR0:DGPTFMT=1,^DGPTR0:DGPTFMT=2
"RTN","DGPTFTR",72,0)
 ;
"RTN","DGPTFTR",73,0)
Q L  F K=0,10,701,"401P",101,11,3,32,41,52,57,70,321,502,702,"02","06" K @("DG"_K)
"RTN","DGPTFTR",74,0)
 K DGCDR,DGT,DIC,DGADM,DGAO,DGDOB,DGHEAD,DGJ,DGK,DGL,DGM,DGNAM,DGNT,DGO,DGSSN,DGSUD,DGSUR,DGTD,DGX,DGXLS,E,ERR,F,G,H,I,K,L,T,W,Z,DGPROC,DGPROCD ;** NOTE: do not kill variables needed by PTF load/edit option!!!
"RTN","DGPTFTR",75,0)
 I $D(DGERR),DGERR<1 D ^DGPTFVC1 D:'T1 ^DGPTFVC3
"RTN","DGPTFTR",76,0)
 I $D(DGERR),DGERR<1 D EN^DGPTFVC2
"RTN","DGPTFTR",77,0)
 Q
"RTN","DGPTFTR",78,0)
 ;
"RTN","DGPTFTR",79,0)
LOG ;called from PRINT+1^DGPTF2,CLS+1^DGPTF2,EN^DGPTFVC
"RTN","DGPTFTR",80,0)
 D LOG^DGPTFTR1:DGPTFMT=1,LOG^DGPTR1:DGPTFMT=2,COM:$D(DGERR)
"RTN","DGPTFTR",81,0)
 Q
"RTN","DGPTFTR",82,0)
 ;
"RTN","DGPTFTR",83,0)
 ;-- check for real queue if census should be removed for national rel
"RTN","DGPTFTR",84,0)
ROUTER S XMDUZ=.5 F DGSDI=0:0 S DGSDI=$O(VAT(DGSDI)) Q:'DGSDI  S X=VAT(DGSDI),XMN=0,XMDF="" D INST^XMA21 K XMN,XMDF
"RTN","DGPTFTR",85,0)
 S XMY(DUZ)=""
"RTN","DGPTFTR",86,0)
 Q
"RTN","DGPTR4")
0^2^B16197486
"RTN","DGPTR4",1,0)
DGPTR4 ;ALB/JDS/MJK/MTC/ADL - ALB/BOK  PTF TRANSMISSION ; 1/31/05 11:54am
"RTN","DGPTR4",2,0)
 ;;5.3;Registration;**338,423,415,510,565,645**;Aug 13, 1993
"RTN","DGPTR4",3,0)
701 ; -- setup 701 transaction
"RTN","DGPTR4",4,0)
 S Y=$S(T1:"C",1:"N")_"701"_DGHEAD,DGDDX=$P(+DG70,".")_"       ",Y=Y_$E(DGDDX,4,5)_$E(DGDDX,6,7)_$E(DGDDX,2,3)_$E($P(+DG70,".",2)_"0000",1,4)
"RTN","DGPTR4",5,0)
 S X=DG70,(L,Z)=2 D ENTER0 K DGDDX
"RTN","DGPTR4",6,0)
 S X=DG70 I "467"[($P(X,U,3)\1) S Y=Y_$P(X,U,3)_"         " G J
"RTN","DGPTR4",7,0)
 S L=1 F Z=3:1:5 D ENTER
"RTN","DGPTR4",8,0)
 S Y=Y_$S($D(^DIC(45.6,+$P(X,U,6),0)):$P(^(0),U,2),1:" "),L=3,Z=12 D ENTER S Y=Y_$E($P(X,U,13)_"   ",1,3)
"RTN","DGPTR4",9,0)
J S L=3,Z=8 D ENTER0
"RTN","DGPTR4",10,0)
 S Y=Y_"X"_$J($P(DG70,U,9),1)
"RTN","DGPTR4",11,0)
 S DGPTDAT=$$GETDATE^ICDGTDRG(J)
"RTN","DGPTR4",12,0)
 S DGPTTMP=$$ICDDX^ICDCODE(+$P(DG70,U,10),DGPTDAT) S DGXLS=$S(+DGPTTMP>0&($P(DGPTTMP,U,10)):$P(DGPTTMP,U,2),1:""),Y=Y_$S(DGXLS[".":$J($P(DGXLS,".",1),3)_$E($P(DGXLS,".",2)_"   ",1,3),1:$J(DGXLS,6))_" "
"RTN","DGPTR4",13,0)
 S L=$P(DG70,U,16,24)_U_DG71 S DG702=""
"RTN","DGPTR4",14,0)
 F K=1:1:12 S DGPTTMP=$$ICDDX^ICDCODE(+$P(L,U,K),DGPTDAT) I +DGPTTMP>0&($P(DGPTTMP,U,10)) S DG702=DG702_$P(DGPTTMP,U,2)_U
"RTN","DGPTR4",15,0)
 S Y=Y_$S(DG702']"":"X",1:" ")
"RTN","DGPTR4",16,0)
 ; -- get phy cdr @ d/c
"RTN","DGPTR4",17,0)
 S X="",Z=+$O(^DGPT(J,535,"AM",DG70-.0000001)) I $D(^DGPT(J,535,+$O(^(Z,0)),0)) S X=^(0)
"RTN","DGPTR4",18,0)
 ; -- set phy cdr
"RTN","DGPTR4",19,0)
 S Z=$P(X,U,16) D CDR
"RTN","DGPTR4",20,0)
 ; -- set phy spec
"RTN","DGPTR4",21,0)
 S L=2,Z=2 D ENTER0
"RTN","DGPTR4",22,0)
 S X=$S($P(DG3,U)="Y":$$RTEN($P(DG3,U,2)),1:"0"),L=3,Z=1 D ENTER0
"RTN","DGPTR4",23,0)
 ;-- additional ptf questions
"RTN","DGPTR4",24,0)
 S DGAUX=$S($D(^DGPT(J,300)):^(300),1:"")
"RTN","DGPTR4",25,0)
 D ADDQUES
"RTN","DGPTR4",26,0)
 K DGAUX,DGDRUG
"RTN","DGPTR4",27,0)
 ;-- sc,ao,ir,ec questions
"RTN","DGPTR4",28,0)
 S X=DG70
"RTN","DGPTR4",29,0)
 ;-- sc
"RTN","DGPTR4",30,0)
 S Y=Y_$E($P(DG70,U,25)_" ")
"RTN","DGPTR4",31,0)
 ;-- ao
"RTN","DGPTR4",32,0)
 S Y=Y_$E($P(DG70,U,26)_" ")
"RTN","DGPTR4",33,0)
 ;-- ir
"RTN","DGPTR4",34,0)
 S Y=Y_$E($P(DG70,U,27)_" ")
"RTN","DGPTR4",35,0)
 ;-- ec
"RTN","DGPTR4",36,0)
 S Y=Y_$E($P(DG70,U,28)_" ")
"RTN","DGPTR4",37,0)
 ;-- mst
"RTN","DGPTR4",38,0)
 S Y=Y_$E($P(DG70,U,29)_" ")
"RTN","DGPTR4",39,0)
 ;-- Head/Neck CA
"RTN","DGPTR4",40,0)
 S Y=Y_$E($P(DG70,U,30)_" ")
"RTN","DGPTR4",41,0)
 D ETHNIC
"RTN","DGPTR4",42,0)
 D RACE
"RTN","DGPTR4",43,0)
 ;Combat vet
"RTN","DGPTR4",44,0)
 S Y=Y_$E($P(DG70,U,31)_" ")
"RTN","DGPTR4",45,0)
 D FILL
"RTN","DGPTR4",46,0)
 I T1 F K=41:1:55,65:1:73 S Y=$E(Y,1,K-1)_" "_$E(Y,K+1,125)
"RTN","DGPTR4",47,0)
 I T1 D CEN^DGPTR1 S:'DGERR ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1 Q
"RTN","DGPTR4",48,0)
 I 'T1 D SAVE
"RTN","DGPTR4",49,0)
702 ;
"RTN","DGPTR4",50,0)
 Q:DG702']""
"RTN","DGPTR4",51,0)
 S Y="N702"_$E(Y,5,40)
"RTN","DGPTR4",52,0)
 F K=1:1:12 S F=$P(DG702,U,K),F=$P(F,".",1)_$E($P(F,".",2)_"   ",1,3),F=F_$E("      ",1,7-$L(F)),Y=Y_F
"RTN","DGPTR4",53,0)
 D FILL
"RTN","DGPTR4",54,0)
 I 'DGERR S ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTR4",55,0)
 I DGERR'>0 S DGACNT=DGACNT+1,^TMP("AEDIT",$J,$E(Y,1,4),DGACNT)=Y
"RTN","DGPTR4",56,0)
 S DG702=$P(DG702,U,6,9)
"RTN","DGPTR4",57,0)
 Q
"RTN","DGPTR4",58,0)
 ;
"RTN","DGPTR4",59,0)
ENTER S Y=Y_$J($P(X,U,Z),L)
"RTN","DGPTR4",60,0)
 Q
"RTN","DGPTR4",61,0)
 ;
"RTN","DGPTR4",62,0)
ENTER0 S Y=Y_$S($P(X,U,Z)]"":$E("00000",$L($P(X,U,Z))+1,L)_$P(X,U,Z),1:$J($P(X,U,Z),L))
"RTN","DGPTR4",63,0)
 Q
"RTN","DGPTR4",64,0)
 ;
"RTN","DGPTR4",65,0)
SAVE D START^DGPTR1 S:'DGERR ^XMB(3.9,DGXMZ,2,DGCNT,0)=Y,DGCNT=DGCNT+1
"RTN","DGPTR4",66,0)
 I DGERR'>0 S DGACNT=DGACNT+1,^TMP("AEDIT",$J,$E(Y,1,4),DGACNT)=Y
"RTN","DGPTR4",67,0)
Q Q
"RTN","DGPTR4",68,0)
 ;
"RTN","DGPTR4",69,0)
FILL F K=$L(Y):1:124 S Y=Y_" "
"RTN","DGPTR4",70,0)
 Q
"RTN","DGPTR4",71,0)
 ;
"RTN","DGPTR4",72,0)
CDR S Y=Y_$E($P(Z,".")_"0000",1,4)_$E($P(Z,".",2)_"00",1,2)
"RTN","DGPTR4",73,0)
 Q
"RTN","DGPTR4",74,0)
ADDQUES ;-- additional PTF questions load records for trans 501/701
"RTN","DGPTR4",75,0)
 S DGDRUG=$S($D(^DIC(45.61,+$P(DGAUX,U,4),0)):$P(^(0),U,2),1:"    ")
"RTN","DGPTR4",76,0)
 S Y=Y_$E($P(DGAUX,U,3)_" ")_$E($P(DGAUX,U,2)_" ")_$J($P(DGDRUG,U),4)
"RTN","DGPTR4",77,0)
 S Y=Y_$E($P(DGAUX,U,5)_" ")
"RTN","DGPTR4",78,0)
 S DGT=0,X=$P(DGAUX,U,6) I X]"" S DGT=1,Z=1,L=2 D ENTER0
"RTN","DGPTR4",79,0)
 I 'DGT S Y=Y_"  "
"RTN","DGPTR4",80,0)
 S DGT=0,X=$P(DGAUX,U,7) I X]"" S DGT=1,Z=1,L=2 D ENTER0
"RTN","DGPTR4",81,0)
 I 'DGT S Y=Y_"  "
"RTN","DGPTR4",82,0)
 Q
"RTN","DGPTR4",83,0)
RTEN(X) ; This function will round X to the nearest mulitple of ten.
"RTN","DGPTR4",84,0)
 ; 0-4 ->DOWN; 5-9->UP
"RTN","DGPTR4",85,0)
 Q (X\10)*10+$S(X#10>4:10,1:0)
"RTN","DGPTR4",86,0)
ETHNIC ;-- Ethnicity (use first active value)
"RTN","DGPTR4",87,0)
 N NODE,NUM,ETHNIC,I,X
"RTN","DGPTR4",88,0)
 S ETHNIC=""
"RTN","DGPTR4",89,0)
 S I=0
"RTN","DGPTR4",90,0)
 S NUM=1
"RTN","DGPTR4",91,0)
 F  S I=+$O(DG06(I)) Q:'I  D  Q:NUM>1
"RTN","DGPTR4",92,0)
 .S NODE=$G(DG06(I,0))
"RTN","DGPTR4",93,0)
 .Q:('NODE)!('$D(^DIC(10.2,+NODE,0)))
"RTN","DGPTR4",94,0)
 .Q:$$INACTIVE^DGUTL4(+NODE)
"RTN","DGPTR4",95,0)
 .S X=$$PTR2CODE^DGUTL4(+NODE,2,4)
"RTN","DGPTR4",96,0)
 .S ETHNIC=$S(X="":" ",1:X)
"RTN","DGPTR4",97,0)
 .S X=$$PTR2CODE^DGUTL4(+$P(NODE,"^",2),3,4)
"RTN","DGPTR4",98,0)
 .S ETHNIC=ETHNIC_$S(X="":" ",1:X)
"RTN","DGPTR4",99,0)
 .S NUM=NUM+1
"RTN","DGPTR4",100,0)
 S Y=Y_$S(ETHNIC="":"  ",1:ETHNIC)
"RTN","DGPTR4",101,0)
 Q
"RTN","DGPTR4",102,0)
RACE ;-- Race (use first 6 active values)
"RTN","DGPTR4",103,0)
 N NODE,NUM,RACE,I,X
"RTN","DGPTR4",104,0)
 S RACE=""
"RTN","DGPTR4",105,0)
 S I=0
"RTN","DGPTR4",106,0)
 S NUM=1
"RTN","DGPTR4",107,0)
 F  S I=+$O(DG02(I)) Q:'I  D  Q:NUM>6
"RTN","DGPTR4",108,0)
 .S NODE=$G(DG02(I,0))
"RTN","DGPTR4",109,0)
 .Q:('NODE)!('$D(^DIC(10,+NODE,0)))
"RTN","DGPTR4",110,0)
 .Q:$$INACTIVE^DGUTL4(+NODE)
"RTN","DGPTR4",111,0)
 .S X=$$PTR2CODE^DGUTL4(+NODE,1,4)
"RTN","DGPTR4",112,0)
 .S RACE=RACE_$S(X="":" ",1:X)
"RTN","DGPTR4",113,0)
 .S X=$$PTR2CODE^DGUTL4(+$P(NODE,"^",2),3,4)
"RTN","DGPTR4",114,0)
 .S RACE=RACE_$S(X="":" ",1:X)
"RTN","DGPTR4",115,0)
 .S NUM=NUM+1
"RTN","DGPTR4",116,0)
 S X="" S $P(X," ",12)=""
"RTN","DGPTR4",117,0)
 S RACE=$S(RACE="":"  ",1:RACE)_X
"RTN","DGPTR4",118,0)
 S Y=Y_$E(RACE,1,12)
"RTN","DGPTR4",119,0)
 Q
"VER")
8.0^22.0
"BLD",5997,6)
^SEQ #574
**END**
**END**
