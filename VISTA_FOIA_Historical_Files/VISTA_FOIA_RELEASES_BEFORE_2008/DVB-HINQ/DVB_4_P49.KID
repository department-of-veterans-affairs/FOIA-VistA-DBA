KIDS Distribution saved on Nov 02, 2005@08:58:07
HINQ Replacement - Interim Solution
**KIDS**:DVB*4.0*49^DG*5.3*631^DGBT*1.0*11^

**INSTALL NAME**
DVB*4.0*49
"BLD",5641,0)
DVB*4.0*49^HINQ^0^3051102^y
"BLD",5641,4,0)
^9.64PA^395^1
"BLD",5641,4,395,0)
395
"BLD",5641,4,395,2,0)
^9.641^395^1
"BLD",5641,4,395,2,395,0)
DVB PARAMETERS  (File-top level)
"BLD",5641,4,395,2,395,1,0)
^9.6411^23^2
"BLD",5641,4,395,2,395,1,22,0)
RDPC IP ADDRESS
"BLD",5641,4,395,2,395,1,23,0)
AAC PORT DESIGNATOR
"BLD",5641,4,395,222)
y^n^p^^^^n^^n
"BLD",5641,4,395,224)

"BLD",5641,4,"APDD",395,395)

"BLD",5641,4,"APDD",395,395,22)

"BLD",5641,4,"APDD",395,395,23)

"BLD",5641,4,"B",395,395)

"BLD",5641,6)
25^
"BLD",5641,"ABNS",0)
^9.66A^1^1
"BLD",5641,"ABNS",1,0)
DVB
"BLD",5641,"ABNS",1,1,0)
^9.661A^^
"BLD",5641,"ABNS","B","DVB",1)

"BLD",5641,"ABPKG")
y^n
"BLD",5641,"INIT")
DVB4049P
"BLD",5641,"KRN",0)
^9.67PA^8989.52^19
"BLD",5641,"KRN",.4,0)
.4
"BLD",5641,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",5641,"KRN",.4,"NM",1,0)
DVBHINQ PAT-HINQ COMP    FILE #2^2^0
"BLD",5641,"KRN",.4,"NM","B","DVBHINQ PAT-HINQ COMP    FILE #2",1)

"BLD",5641,"KRN",.401,0)
.401
"BLD",5641,"KRN",.402,0)
.402
"BLD",5641,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",5641,"KRN",.402,"NM",1,0)
DVBHINQ UPDATE    FILE #2^2^0
"BLD",5641,"KRN",.402,"NM","B","DVBHINQ UPDATE    FILE #2",1)

"BLD",5641,"KRN",.403,0)
.403
"BLD",5641,"KRN",.5,0)
.5
"BLD",5641,"KRN",.84,0)
.84
"BLD",5641,"KRN",3.6,0)
3.6
"BLD",5641,"KRN",3.8,0)
3.8
"BLD",5641,"KRN",9.2,0)
9.2
"BLD",5641,"KRN",9.8,0)
9.8
"BLD",5641,"KRN",9.8,"NM",0)
^9.68A^32^30
"BLD",5641,"KRN",9.8,"NM",1,0)
DVBHQD2^^0^B7105918
"BLD",5641,"KRN",9.8,"NM",2,0)
DVBHQDL^^0^B25179847
"BLD",5641,"KRN",9.8,"NM",3,0)
DVBHQDX^^0^B10801689
"BLD",5641,"KRN",9.8,"NM",4,0)
DVBHQM1^^0^B34394004
"BLD",5641,"KRN",9.8,"NM",5,0)
DVBHQM11^^0^B14847772
"BLD",5641,"KRN",9.8,"NM",6,0)
DVBHQM12^^0^B29859559
"BLD",5641,"KRN",9.8,"NM",7,0)
DVBHQM2^^0^B32012478
"BLD",5641,"KRN",9.8,"NM",8,0)
DVBHQM3^^0^B14185157
"BLD",5641,"KRN",9.8,"NM",9,0)
DVBHQM31^^0^B10293051
"BLD",5641,"KRN",9.8,"NM",11,0)
DVBHQR2^^0^B32886616
"BLD",5641,"KRN",9.8,"NM",12,0)
DVBHS2^^0^B10155550
"BLD",5641,"KRN",9.8,"NM",13,0)
DVBHS3^^0^B13169365
"BLD",5641,"KRN",9.8,"NM",14,0)
DVBHS5^^0^B9648917
"BLD",5641,"KRN",9.8,"NM",15,0)
DVBHS6^^0^B6250521
"BLD",5641,"KRN",9.8,"NM",16,0)
DVBHSVER^^0^B16299638
"BLD",5641,"KRN",9.8,"NM",17,0)
DVBHT1^^0^B22369866
"BLD",5641,"KRN",9.8,"NM",19,0)
DVBHIQM^^0^B24310188
"BLD",5641,"KRN",9.8,"NM",20,0)
DVBHIQR^^0^B12027646
"BLD",5641,"KRN",9.8,"NM",21,0)
DVBHQR1^^0^B21400838
"BLD",5641,"KRN",9.8,"NM",22,0)
DVBHQR11^^0^B30529777
"BLD",5641,"KRN",9.8,"NM",23,0)
DVBHQR12^^0^B15500000
"BLD",5641,"KRN",9.8,"NM",24,0)
DVBHQR13^^0^B27069661
"BLD",5641,"KRN",9.8,"NM",25,0)
DVBHQEDT^^0^B21705515
"BLD",5641,"KRN",9.8,"NM",26,0)
DVBHS4^^0^B10613271
"BLD",5641,"KRN",9.8,"NM",27,0)
DVBHQM13^^0^B9419232
"BLD",5641,"KRN",9.8,"NM",28,0)
DVBHQZ6^^0^B23438540
"BLD",5641,"KRN",9.8,"NM",29,0)
DVBHQD1^^0^B24115868
"BLD",5641,"KRN",9.8,"NM",30,0)
DVBHQDE^^0^B20242382
"BLD",5641,"KRN",9.8,"NM",31,0)
DVBHQUP^^0^B32139458
"BLD",5641,"KRN",9.8,"NM",32,0)
DVBHQAT^^0^B8405451
"BLD",5641,"KRN",9.8,"NM","B","DVBHIQM",19)

"BLD",5641,"KRN",9.8,"NM","B","DVBHIQR",20)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQAT",32)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQD1",29)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQD2",1)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQDE",30)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQDL",2)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQDX",3)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQEDT",25)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQM1",4)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQM11",5)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQM12",6)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQM13",27)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQM2",7)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQM3",8)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQM31",9)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQR1",21)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQR11",22)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQR12",23)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQR13",24)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQR2",11)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQUP",31)

"BLD",5641,"KRN",9.8,"NM","B","DVBHQZ6",28)

"BLD",5641,"KRN",9.8,"NM","B","DVBHS2",12)

"BLD",5641,"KRN",9.8,"NM","B","DVBHS3",13)

"BLD",5641,"KRN",9.8,"NM","B","DVBHS4",26)

"BLD",5641,"KRN",9.8,"NM","B","DVBHS5",14)

"BLD",5641,"KRN",9.8,"NM","B","DVBHS6",15)

"BLD",5641,"KRN",9.8,"NM","B","DVBHSVER",16)

"BLD",5641,"KRN",9.8,"NM","B","DVBHT1",17)

"BLD",5641,"KRN",19,0)
19
"BLD",5641,"KRN",19.1,0)
19.1
"BLD",5641,"KRN",101,0)
101
"BLD",5641,"KRN",409.61,0)
409.61
"BLD",5641,"KRN",771,0)
771
"BLD",5641,"KRN",870,0)
870
"BLD",5641,"KRN",8989.51,0)
8989.51
"BLD",5641,"KRN",8989.52,0)
8989.52
"BLD",5641,"KRN",8994,0)
8994
"BLD",5641,"KRN","B",.4,.4)

"BLD",5641,"KRN","B",.401,.401)

"BLD",5641,"KRN","B",.402,.402)

"BLD",5641,"KRN","B",.403,.403)

"BLD",5641,"KRN","B",.5,.5)

"BLD",5641,"KRN","B",.84,.84)

"BLD",5641,"KRN","B",3.6,3.6)

"BLD",5641,"KRN","B",3.8,3.8)

"BLD",5641,"KRN","B",9.2,9.2)

"BLD",5641,"KRN","B",9.8,9.8)

"BLD",5641,"KRN","B",19,19)

"BLD",5641,"KRN","B",19.1,19.1)

"BLD",5641,"KRN","B",101,101)

"BLD",5641,"KRN","B",409.61,409.61)

"BLD",5641,"KRN","B",771,771)

"BLD",5641,"KRN","B",870,870)

"BLD",5641,"KRN","B",8989.51,8989.51)

"BLD",5641,"KRN","B",8989.52,8989.52)

"BLD",5641,"KRN","B",8994,8994)

"BLD",5641,"QUES",0)
^9.62^^
"BLD",5641,"REQB",0)
^9.611^10^10
"BLD",5641,"REQB",1,0)
DVB*4.0*32^2
"BLD",5641,"REQB",2,0)
DVB*4.0*35^2
"BLD",5641,"REQB",3,0)
DVB*4.0*37^2
"BLD",5641,"REQB",4,0)
DVB*4.0*38^2
"BLD",5641,"REQB",5,0)
DVB*4.0*43^2
"BLD",5641,"REQB",6,0)
DVB*4.0*28^2
"BLD",5641,"REQB",7,0)
DVB*4.0*46^2
"BLD",5641,"REQB",8,0)
DVB*4.0*36^2
"BLD",5641,"REQB",9,0)
DVB*4.0*52^2
"BLD",5641,"REQB",10,0)
DVB*4.0*53^2
"BLD",5641,"REQB","B","DVB*4.0*28",6)

"BLD",5641,"REQB","B","DVB*4.0*32",1)

"BLD",5641,"REQB","B","DVB*4.0*35",2)

"BLD",5641,"REQB","B","DVB*4.0*36",8)

"BLD",5641,"REQB","B","DVB*4.0*37",3)

"BLD",5641,"REQB","B","DVB*4.0*38",4)

"BLD",5641,"REQB","B","DVB*4.0*43",5)

"BLD",5641,"REQB","B","DVB*4.0*46",7)

"BLD",5641,"REQB","B","DVB*4.0*52",9)

"BLD",5641,"REQB","B","DVB*4.0*53",10)

"FIA",395)
DVB PARAMETERS
"FIA",395,0)
^DVB(395,
"FIA",395,0,0)
395
"FIA",395,0,1)
y^n^p^^^^n^^n
"FIA",395,0,10)

"FIA",395,0,11)

"FIA",395,0,"RLRO")

"FIA",395,0,"VR")
4.0^DVB
"FIA",395,395)
1
"FIA",395,395,22)

"FIA",395,395,23)

"INIT")
DVB4049P
"KRN",.4,608,-1)
0^1
"KRN",.4,608,0)
DVBHINQ PAT-HINQ COMP^3050811.0724^^2^^^3050908
"KRN",.4,608,"DXS",1,9)
W ?30,"Patient File vs. HINQ",!,?17,"Patient",?55,"HINQ",!,"--------------------------------------------------------------------------------"
"KRN",.4,608,"DXS",2,9)
I $D(DVBDOB),DVBDOB S M=$E(DVBDOB,1,2) D MM^DVBHQM11 W ?50,M_" "_$E(DVBDOB,3,4)_", "_$E(DVBDOB,5,8) K M
"KRN",.4,608,"DXS",3,9)
I $D(DVBP(6)),(+$P(DVBP(6),U)) S M=$E(DVBP(6),1,2) D MM^DVBHQM11 W ?50,M_" "_$E(DVBP(6),3,4)_", "_$E(DVBP(6),5,8) K M
"KRN",.4,608,"DXS",4,9)
I $P(DVBP(6),U,7)'[" " W ?50 W:$P(DVBP(6),U,7)="Y" "YES" W:$P(DVBP(6),U,7)="N" "NO" W:$P(DVBP(6),U,7)="I" "YES"
"KRN",.4,608,"DXS",5,9)
I $D(DVBPOW) W ?50,$S(DVBPOW=0:"No period of rec.",DVBPOW=1:"Less than 30 days",DVBPOW=2:"30 days or more",DVBPOW=" ":"Not applicable",1:DVBPOW)
"KRN",.4,608,"DXS",6,9)
I '$D(ZTSK),(IO=IO(0)) W !!,?35,"** Pausing **" H 3 W @$S('$D(IOF):"#",IOF="":"#",1:IOF)
"KRN",.4,608,"DXS",7,9)
W !,?1,"Rated Disab. (HINQ) - Comb. SC%: ",+$G(DVBDXPCT),"  Eff. Date Comb. Eval.: ",$G(DVBEDT)
"KRN",.4,608,"DXS",8,9)
I $D(DVBEOD(1)),DVBEOD(1)?8N S M=$E(DVBEOD(1),1,2) D MM^DVBHQM11 W M," ",$E(DVBEOD(1),3,4),",",$E(DVBEOD(1),5,8)
"KRN",.4,608,"DXS",9,9)
I $D(DVBRAD(1)),DVBRAD(1)?8N S M=$E(DVBRAD(1),1,2) D MM^DVBHQM11 W ?15,M," ",$E(DVBRAD(1),3,4),",",$E(DVBRAD(1),5,8)
"KRN",.4,608,"DXS",10,0)
NO
"KRN",.4,608,"DXS",10,1)
YES
"KRN",.4,608,"DXS",11,"N")
NO
"KRN",.4,608,"DXS",11,"U")
UNKNOWN
"KRN",.4,608,"DXS",11,"Y")
YES
"KRN",.4,608,"DXS",12,"N")
NO
"KRN",.4,608,"DXS",12,"U")
UNKNOWN
"KRN",.4,608,"DXS",12,"Y")
YES
"KRN",.4,608,"F",1)
W @$S('$D(IOF):"#",IOF="":"#",1:IOF);Z;"W @$S('$D(IOF):"#",IOF="":"#",1:IOF)"~
"KRN",.4,608,"F",2)
X DXS(1,9);X;Z;"W ?30,"Patient File vs. HINQ",!,?17,"Patient",?55,"HINQ",!,"--------------------------------------------------------------------------------""~
"KRN",.4,608,"F",3)
"Name:";C1~.01;C20~I $D(DVBADR(1)) W ?56,DVBADR(1);Z;"I $D(DVBADR(1)) W ?56,DVBADR(1)"~
"KRN",.4,608,"F",4)
I '$D(DVBADR(1)),$D(DVBNAME) W ?56,DVBNAME;Z;"I '$D(DVBADR(1)),$D(DVBNAME) W ?56,DVBNAME"~"Address:";C1~.111;C20~
"KRN",.4,608,"F",5)
I $D(DVBADR(1)) W ?56,DVBADR(1);Z;"I $D(DVBADR(1)) W ?56,DVBADR(1)"~.112;C20~I $D(DVBADR(2)) W ?56,DVBADR(2);Z;"I $D(DVBADR(2)) W ?56,DVBADR(2)"~
"KRN",.4,608,"F",6)
.113;C20~I $D(DVBADR(3)) W ?56,DVBADR(3);Z;"I $D(DVBADR(3)) W ?56,DVBADR(3)"~"SSN:";C1~.09;C20~I $D(DVBSSN) W ?50,DVBSSN;Z;"I $D(DVBSSN) W ?50,DVBSSN"~
"KRN",.4,608,"F",7)
"Claim number:";C1~.313;C20;L9;X~I $D(DVBCN),DVBCN>0 W ?50,DVBCN;X;Z;"I $D(DVBCN),DVBCN>0 W ?50,DVBCN"~"Date of Birth:";C1~.03;C20;X~
"KRN",.4,608,"F",8)
X DXS(2,9);Z;"I $D(DVBDOB),DVBDOB S M=$E(DVBDOB,1,2) D MM^DVBHQM11 W ?50,M_" "_$E(DVBDOB,3,4)_", "_$E(DVBDOB,5,8) K M"~"Date of Death:";C1~.351;C20;X~
"KRN",.4,608,"F",9)
X DXS(3,9);Z;"I $D(DVBP(6)),(+$P(DVBP(6),U)) S M=$E(DVBP(6),1,2) D MM^DVBHQM11 W ?50,M_" "_$E(DVBP(6),3,4)_", "_$E(DVBP(6),5,8) K M"~
"KRN",.4,608,"F",10)
"Rated Incompetent:";C1~.293;C20;X~
"KRN",.4,608,"F",11)
X DXS(4,9);Z;"I $P(DVBP(6),U,7)'[" " W ?50 W:$P(DVBP(6),U,7)="Y" "YES" W:$P(DVBP(6),U,7)="N" "NO" W:$P(DVBP(6),U,7)="I" "YES""~"POW";C1~.525;C20;X~
"KRN",.4,608,"F",12)
X DXS(5,9);Z;"I $D(DVBPOW) W ?50,$S(DVBPOW=0:"No period of rec.",DVBPOW=1:"Less than 30 days",DVBPOW=2:"30 days or more",DVBPOW=" ":"Not applicable",1:DVBPOW)"~
"KRN",.4,608,"F",13)
"Folder Location:";C1~.314;C20;L27;X~I $D(DVBFL) W ?50,$E(DVBFL,1,27);Z;"I $D(DVBFL) W ?50,$E(DVBFL,1,27)"~"Verified SVC:";C1~.322;C20;X~
"KRN",.4,608,"F",14)
I $P(DVBP(6),U,8)'[" " W ?50 W:$P(DVBP(6),U,8)="Y" "YES" W:$P(DVBP(6),U,8)="N" "NO";Z;"I $P(DVBP(6),U,8)'[" " W ?50 W:$P(DVBP(6),U,8)="Y" "YES" W:$P(DVBP(6),U,8)="N" "NO""~
"KRN",.4,608,"F",15)
"Vietnam Service:";C1~.32101;C20;X~
"KRN",.4,608,"F",16)
I $P(DVBP(6),U,4)'[" " W ?50 W:$P(DVBP(6),U,4)="Y" "YES" W:$P(DVBP(6),U,4)="N" "NO";Z;"I $P(DVBP(6),U,4)'[" " W ?50 W:$P(DVBP(6),U,4)="Y" "YES" W:$P(DVBP(6),U,4)="N" "NO""~
"KRN",.4,608,"F",17)
X DXS(6,9);Z;"I '$D(ZTSK),(IO=IO(0)) W !!,?35,"** Pausing **" H 3 W @$S('$D(IOF):"#",IOF="":"#",1:IOF)"~"Rated Disab. (Patient file)";S1;C1~
"KRN",.4,608,"F",18)
D LSTR^DVBHQUP;Z;"D LSTR^DVBHQUP"~X DXS(7,9);Z;"W !,?1,"Rated Disab. (HINQ) - Comb. SC%: ",+$G(DVBDXPCT),"  Eff. Date Comb. Eval.: ",$G(DVBEDT)"~
"KRN",.4,608,"F",19)
I $D(DVBDXNO),DVBDXNO'=0 D S1^DVBHQZ6;Z;"I $D(DVBDXNO),DVBDXNO'=0 D S1^DVBHQZ6"~W !,?34,"HINQ Data";X;Z;"W !,?34,"HINQ Data""~
"KRN",.4,608,"F",20)
W !,?6,"EOD",?20,"RAD",?34,"Bran. Ser.",?48,"Char. Ser.",?62,"Ser Num.";X;Z;"W !,?6,"EOD",?20,"RAD",?34,"Bran. Ser.",?48,"Char. Ser.",?62,"Ser Num.""~
"KRN",.4,608,"F",21)
W !,"--------------------------------------------------------------------------------";Z;"W !,"--------------------------------------------------------------------------------""~
"KRN",.4,608,"F",22)
I +$G(DVBEOD(2))>0 K DVBEOD(1);Z;"I +$G(DVBEOD(2))>0 K DVBEOD(1)"~I +$G(DVBRAD(2))>0 K DVBRAD(1);Z;"I +$G(DVBRAD(2))>0 K DVBRAD(1)"~
"KRN",.4,608,"F",23)
I $G(DVBCSVC(2))]"" K DVBCSVC(1);Z;"I $G(DVBCSVC(2))]"" K DVBCSVC(1)"~I $G(DVBSN(2))]"" K DVBSN(1);Z;"I $G(DVBSN(2))]"" K DVBSN(1)"~
"KRN",.4,608,"F",24)
I $G(DVBBOS(2))]"" K DVBBOS(1);Z;"I $G(DVBBOS(2))]"" K DVBBOS(1)"~
"KRN",.4,608,"F",25)
X DXS(8,9);X;Z;"I $D(DVBEOD(1)),DVBEOD(1)?8N S M=$E(DVBEOD(1),1,2) D MM^DVBHQM11 W M," ",$E(DVBEOD(1),3,4),",",$E(DVBEOD(1),5,8)"~
"KRN",.4,608,"F",26)
X DXS(9,9);X;Z;"I $D(DVBRAD(1)),DVBRAD(1)?8N S M=$E(DVBRAD(1),1,2) D MM^DVBHQM11 W ?15,M," ",$E(DVBRAD(1),3,4),",",$E(DVBRAD(1),5,8)"~
"KRN",.4,608,"F",27)
I $D(DVBBOS(1)) S Y=DVBBOS(1) D XBOS^DVBHQM12 W ?34,$E(Y,1,16) K Y;X;Z;"I $D(DVBBOS(1)) S Y=DVBBOS(1) D XBOS^DVBHQM12 W ?34,$E(Y,1,16) K Y"~
"KRN",.4,608,"F",28)
I $D(DVBCSVC(1)) S I=1,Y=DVBCSVC(1) D DISCHG^DVBHQM1 W ?48,Y K Y;X;Z;"I $D(DVBCSVC(1)) S I=1,Y=DVBCSVC(1) D DISCHG^DVBHQM1 W ?48,Y K Y"~
"KRN",.4,608,"F",29)
I $D(DVBSN(1)) W ?62,DVBSN(1);X;Z;"I $D(DVBSN(1)) W ?62,DVBSN(1)"~
"KRN",.4,608,"F",30)
W ! I $D(DVBEOD(2)),DVBEOD(2)?7N S Y=DVBEOD(2) X ^DD("DD") W ?1,Y K Y;X;Z;"W ! I $D(DVBEOD(2)),DVBEOD(2)?7N S Y=DVBEOD(2) X ^DD("DD") W ?1,Y K Y"~
"KRN",.4,608,"F",31)
I $D(DVBRAD(2)),DVBRAD(2)?7N S Y=DVBRAD(2) X ^DD("DD") W ?15,Y K Y;X;Z;"I $D(DVBRAD(2)),DVBRAD(2)?7N S Y=DVBRAD(2) X ^DD("DD") W ?15,Y K Y"~
"KRN",.4,608,"F",32)
I $D(DVBBOS(2)) W ?34,DVBBOS(2);X;Z;"I $D(DVBBOS(2)) W ?34,DVBBOS(2)"~I $D(DVBCSVC(2)) W ?48,DVBCSVC(2);X;Z;"I $D(DVBCSVC(2)) W ?48,DVBCSVC(2)"~
"KRN",.4,608,"F",33)
I $D(DVBSN(2)) W ?62,DVBSN(2);X;Z;"I $D(DVBSN(2)) W ?62,DVBSN(2)"~
"KRN",.4,608,"F",34)
W ! I $D(DVBEOD(3)),DVBEOD(3)?7N S Y=DVBEOD(3) X ^DD("DD") W ?1,Y K Y;X;Z;"W ! I $D(DVBEOD(3)),DVBEOD(3)?7N S Y=DVBEOD(3) X ^DD("DD") W ?1,Y K Y"~
"KRN",.4,608,"F",35)
I $D(DVBRAD(3)),DVBRAD(3)?7N S Y=DVBRAD(3) X ^DD("DD") W ?15,Y K Y;X;Z;"I $D(DVBRAD(3)),DVBRAD(3)?7N S Y=DVBRAD(3) X ^DD("DD") W ?15,Y K Y"~
"KRN",.4,608,"F",36)
I $D(DVBBOS(3)) W ?34,DVBBOS(3);X;Z;"I $D(DVBBOS(3)) W ?34,DVBBOS(3)"~I $D(DVBCSVC(3)) W ?48,DVBCSVC(3);X;Z;"I $D(DVBCSVC(3)) W ?48,DVBCSVC(3)"~
"KRN",.4,608,"F",37)
I $D(DVBSN(3)) W ?62,DVBSN(3);X;Z;"I $D(DVBSN(3)) W ?62,DVBSN(3)"~
"KRN",.4,608,"F",38)
W ! I $D(DVBEOD(4)),DVBEOD(4)?7N S Y=DVBEOD(4) X ^DD("DD") W ?1,Y K Y;X;Z;"W ! I $D(DVBEOD(4)),DVBEOD(4)?7N S Y=DVBEOD(4) X ^DD("DD") W ?1,Y K Y"~
"KRN",.4,608,"F",39)
I $D(DVBRAD(4)),DVBRAD(4)?7N S Y=DVBRAD(4) X ^DD("DD") W ?15,Y K Y;X;Z;"I $D(DVBRAD(4)),DVBRAD(4)?7N S Y=DVBRAD(4) X ^DD("DD") W ?15,Y K Y"~
"KRN",.4,608,"F",40)
I $D(DVBBOS(4)) W ?34,DVBBOS(4);X;Z;"I $D(DVBBOS(4)) W ?34,DVBBOS(4)"~I $D(DVBCSVC(4)) W ?48,DVBCSVC(4);X;Z;"I $D(DVBCSVC(4)) W ?48,DVBCSVC(4)"~
"KRN",.4,608,"F",41)
I $D(DVBSN(4)) W ?62,DVBSN(4);X;Z;"I $D(DVBSN(4)) W ?62,DVBSN(4)"~W !!,?34,"Patient File";X;Z;"W !!,?34,"Patient File""~
"KRN",.4,608,"F",42)
W !,"-------------------------------------------------------------------------------";Z;"W !,"-------------------------------------------------------------------------------""~
"KRN",.4,608,"F",43)
W !," Last episode";X;Z;"W !," Last episode""~.326;C1~.327;C15~.325;C34~.324;C48~.328;C62;X~W !," NTL episode";X;Z;"W !," NTL episode""~.3292;C1~
"KRN",.4,608,"F",44)
.3293;C15~.3291;C34~.329;C48~.3294;C62~W !," NNTL episode";Z;"W !," NNTL episode""~.3297;C1~.3298;C15~.3296;C34~.3295;C48~.3299;C62;X~
"KRN",.4,608,"H")
@
"KRN",.4,608,"IOM")
80
"KRN",.4,608,"LAST")

"KRN",.4,608,"ROU")
^DVBHCG
"KRN",.4,608,"ROUOLD")
DVBHCG
"KRN",.4,608,"SUB")
1
"KRN",.402,651,-1)
0^1
"KRN",.402,651,0)
DVBHINQ UPDATE^3050825.1615^^2^^^3050923
"KRN",.402,651,"AR",2,303)
1^DVBHCE35
"KRN",.402,651,"DIAB",1,0,2,7)
.32945;Service NNTL Episode
"KRN",.402,651,"DIAB",1,0,2,9)
.306//"TODAY"
"KRN",.402,651,"DIAB",2,0,2,4)
SERVICE ENTRY DATE [NTL];"NTL-EOD"
"KRN",.402,651,"DIAB",3,0,2,1)
SERVICE ENTRY DATE [LAST];"L-EOD"
"KRN",.402,651,"DIAB",3,0,2,3)
.3285;Service NTL Episode
"KRN",.402,651,"DIAB",3,0,2,4)
SERVICE SEPARATION DATE [NTL];"NTL-RAD"
"KRN",.402,651,"DIAB",3,0,2,7)
SERVICE ENTRY DATE [NNTL];"NNTL-EOD"
"KRN",.402,651,"DIAB",4,0,2,1)
SERVICE SEPARATION DATE [LAST];"L-RAD";C15
"KRN",.402,651,"DIAB",4,0,2,4)
SERVICE BRANCH [NTL];"NTL-Bran. Ser."
"KRN",.402,651,"DIAB",4,0,2,7)
SERVICE SEPARATION DATE [NNTL];"NNTL-RAD"
"KRN",.402,651,"DIAB",5,0,2,1)
SERVICE BRANCH [LAST];L-Bran.. Ser.
"KRN",.402,651,"DIAB",5,0,2,4)
SERVICE DISCHARGE TYPE [NTL];"NTL-Char. Ser."
"KRN",.402,651,"DIAB",5,0,2,7)
SERVICE BRANCH [NNTL];"NNTL-Bran. Ser."
"KRN",.402,651,"DIAB",6,0,2,4)
SERVICE NUMBER [NTL];"NTL-Ser. Num."
"KRN",.402,651,"DIAB",6,0,2,7)
SERVICE DISCHARGE TYPE [NNTL];"NNTL-Char. Ser."
"KRN",.402,651,"DIAB",7,0,2,1)
SERVICE DISCHARGE TYPE [LAST];L-Char. Ser.
"KRN",.402,651,"DIAB",7,0,2,7)
SERVICE NUMBER [NNTL];"NNTL-Ser. Num."
"KRN",.402,651,"DIAB",8,0,2,1)
SERVICE NUMBER [LAST];L-Ser. Num.
"KRN",.402,651,"DIAB",13,0,2,8)
.3612//"TODAY"
"KRN",.402,651,"DR",1,2)
@101;W @$S('$D(IOF):"#",IOF="":"#",1:IOF),! K ^UTILITY($J) D ^DVBHSVER;@7;D Q^DVBHUTIL;S DIE("NO^")="";@1001;D ^DVBHS1 S Y="@5";@1;D ^DVBHS2 S Y="@5" W !;@2;D ^DVBHS3 S Y="@5";@3;D ^DVBHS4 S Y="@5";@1006;@30;I Z2'[1 S Y="@32";
"KRN",.402,651,"DR",1,2,1)
S DVBSCR=1 D ^DVBHS4 W !,?34,DVBON,"[LAST]",DVBOFF X DVBLIT1;S DVBJC=$S('$D(^DPT(DFN,.32)):"",1:$P(^(0),U,5));.326L-EOD~;.327C15~L-RAD~;.325L-Bran.. Ser.~;I X'=DVBJC S DVBJ2=1;.324L-Char. Ser.~;.328L-Ser. Num.~;@32;
"KRN",.402,651,"DR",1,2,2)
I Z2'[2 S Y="@31";I '$D(^DPT(D0,.32)) W !!,*7,?17,DVBON,"No Last episode can't edit NTLast   <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";
"KRN",.402,651,"DR",1,2,3)
I $P(^DPT(D0,.32),U,6)="" W !!,*7,?17,DVBON,"No last episode can't edit NTLast   <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";S DVBSCR=1 D ^DVBHS4 W !,?34,DVBON,"[NTLAST]",DVBOFF X DVBLIT1;.3285Service NTL Episode~;
"KRN",.402,651,"DR",1,2,4)
I $P(^DPT(D0,.32),U,19)'="Y" S Y="@31";.3292NTL-EOD~;.3293NTL-RAD~;.3291NTL-Bran. Ser.~;.329NTL-Char. Ser.~;.3294NTL-Ser. Num.~;@31;I Z2'[3 S Y="@33";
"KRN",.402,651,"DR",1,2,5)
I '$D(^DPT(D0,.32)) W !!,*7,?17,DVBON,"No NTLast episode can't edit NNTLast   <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";
"KRN",.402,651,"DR",1,2,6)
I $P(^DPT(D0,.32),U,19)'="Y" W !!,*7,?17,DVBON,"No NTLast episode can't edit NNTLast   <RET>.",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S Y="@33";S DVBSCR=1 D ^DVBHS4 W !,?34,DVBON,"[NNTLAST]",DVBOFF X DVBLIT1;
"KRN",.402,651,"DR",1,2,7)
.32945Service NNTL Episode~;I $P(^DPT(D0,.32),U,20)'="Y" S Y="@33";.3297NNTL-EOD~;.3298NNTL-RAD~;.3296NNTL-Bran. Ser.~;.3295NNTL-Char. Ser.~;.3299NNTL-Ser. Num.~;@33;I Z2'[4 S Y="@3";S DVBSCR=1 D ^DVBHS4;
"KRN",.402,651,"DR",1,2,8)
S DVBJC2=$S($D(^DPT(D0,.32)):$P(^(.32),U,3),1:"");.323;I X'=DVBJC2 S DVBJ2=1;K DVBJC2;S Y="@3";@104;D ^DVBHS5 S Y="@5" K DXS;@204;I Z2'[1 S Y="@205";S DVBSCR=1 D ^DVBHS5 S DVBJ2=1;.3611;Q;.3612//^S X="TODAY";.3615//^S X="HINQ";Q;
"KRN",.402,651,"DR",1,2,9)
.306//^S X="TODAY";361;@205;I Z2'[2 S Y="@206";S DVBSCR=1 D ^DVBHS5 S DVBJ2=1;391;1901;.301;I X="N" S Y="@2063";@2063;.361;@206;I Z2'[3 S Y="@104";S DVBSCR=1 D ^DVBHS5 S DVBJ2=1;.36205;.36215;.36235;.3025;.36295;@2062;S Y="@104";
"KRN",.402,651,"DR",1,2,10)
@11;S DVBJ2=1;.111;.112;.113;.114;.115;.1112;.117;S Y="@1001";@5;D SCRQ^DVBHUTIL;@6;D B^DVBHQEDT R AA:DTIME K AA S Y=$S(DVBJS=11:"@1001",DVBJS=28:"@1",DVBJS=35:"@2",DVBJS=44:"@3",DVBJS=53:"@104",1:"@10");@8;
"KRN",.402,651,"DR",1,2,11)
S Y=$S(ANS="^0":"@101",ANS="^1":"@1001",ANS="^2":"@1",ANS="^3":"@2",ANS="^4":"@3",ANS="^5":"@104",1:Y) I Y["@" W @$S('$D(IOF):"#",IOF="":"#",1:IOF);
"KRN",.402,651,"DR",1,2,12)
D A^DVBHQEDT S Z2=Z I ERROR K ERROR S Y=$S(DVBJS=11:"@1001",DVBJS=28:"@1",DVBJS=35:"@2",DVBJS=44:"@3",DVBJS=53:"@104",1:"@10");@20;S JP=1,Y=$S(DVBJS=11:"@11",DVBJS=35:"@40",DVBJS=44:"@30",DVBJS=53:"@204",1:Y);@21;
"KRN",.402,651,"DR",1,2,13)
I $P(Z2,U,JP)'=1 S Y="@22";I '$D(DVBCN) S Y="@22",JP=JP+1;I 'DVBCN S Y="@22",JP=JP+1;S DVBCN=$TR(DVBCN," ");
"KRN",.402,651,"DR",1,2,14)
I $L(DVBCN)=9,(DVBCN?9N),(DVBCN'=$P(^DPT(D0,0),U,9)) W !!,*7,"HINQ claim # is a SSN, does not match patient file SSN  NO UPDATING claim #" R !,?25,"<RET to continue>",DVBQ:DTIME K DVBQ S Y="@22",JP=JP+1;.313///^S X=DVBCN;
"KRN",.402,651,"DR",1,2,15)
W "." S JP=JP+1,DVBJ2=1;@22;I $P(Z2,U,JP)'=2 S Y="@225";I '$D(DVBDOB) S Y="@225",JP=JP+1;I 'DVBDOB!(DVBDOB'>170) S Y="@225",JP=JP+1;
"KRN",.402,651,"DR",1,2,16)
I $E(DVBDOB,3,4)="00" W !!,*7,"HINQ Date of Birth does not contain a day, NO updating of Date of Birth allowed." R !,?25,"<RET to continue>",DVBQ:DTIME K DVBQ S Y="@225",JP=JP+1;
"KRN",.402,651,"DR",1,2,17)
S Z1=+$E(DVBDOB,1,2)_" "_+$E(DVBDOB,3,4)_" "_+$E(DVBDOB,5,8);.03///^S X=Z1;W "." S JP=JP+1,DVBJ2=1;@225;I $P(Z2,U,JP)'=3 S Y="@23";I $D(DVBBIR) S DVBSEX=$P(DVBBIR,U,25);I $D(DVBVET),$P(DVBVET,U,1)'="C" S DVBSEX=$P(DVBVET,U,3);
"KRN",.402,651,"DR",1,2,18)
I '$D(DVBSEX) S Y="@23",JP=JP+1;I DVBSEX'="M",DVBSEX'="F" S Y="@23",JP=JP+1;.02///^S X=DVBSEX;W "." S JP=JP+1,DVBJ2=1;@23;I $P(Z2,U,JP)'=4 S Y="@24";
"KRN",.402,651,"DR",1,2,19)
K Z1 I $D(DVBP(6)),+$P(DVBP(6),U) S Z1=$P(DVBP(6),U),Z1=$E(Z1,1,2)_" "_$E(Z1,3,4)_" "_$E(Z1,5,8);I $D(DVBVET),$P(DVBVET,U,1)="B",+$P(DVBVET,U,12) S Z1=$P(DVBVET,U,12),Z1=$E(Z1,5,6)_" "_$E(Z1,7,8)_" "_$E(Z1,1,4);
"KRN",.402,651,"DR",1,2,20)
I '$D(Z1) S Y="@24",JP=JP+1;I 'Z1 S Y="@24",JP=JP+1;I $D(^DPT(D0,.105)) W !!,"Patient is currently in-house." W !,"Discharge patient with a discharge type of DEATH." R !,?25,"<RET to continue>",DVBQ:DTIME K DVBQ S Y="@24",JP=JP+1;
"KRN",.402,651,"DR",1,2,21)
.351///^S X=Z1;W "." S JP=JP+1,DVBJ2=1;@24;I $P(Z2,U,JP)'=5 S Y="@25";K DVBSICK I $D(DVBP(6)) S DVBSICK=$P(DVBP(6),U,7);I $D(DVBCI) S DVBSICK=DVBCI;I '$D(DVBSICK) S Y="@25",JP=JP+1;.293///^S X=$S((DVBSICK="I")!(DVBSICK="Y"):1,1:0);
"KRN",.402,651,"DR",1,2,22)
W "." S JP=JP+1,DVBJ2=1 K DVBSICK;@25;I $P(Z2,U,JP)'=6 S Y="@26";I '$D(DVBPOW),'$D(DVBPOWD) S Y="@26",JP=JP+1;
"KRN",.402,651,"DR",1,2,23)
I '$D(DVBPOW),$D(DVBPOWD),+DVBPOWD W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";I '$D(DVBPOW),'+DVBPOWD S Y="@26",JP=JP+1;
"KRN",.402,651,"DR",1,2,24)
I '$D(DVBPOWD),$D(DVBPOW),DVBPOW>0 W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";
"KRN",.402,651,"DR",1,2,25)
I $D(DVBPOWD),$D(DVBPOW),DVBPOWD=0,DVBPOW>0 W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";
"KRN",.402,651,"DR",1,2,26)
I $D(DVBPOWD),$D(DVBPOW),+DVBPOW<1,+DVBPOWD W !!,*7,?17,DVBON,"POW Indicator Discrepancy!  <RET>",DVBOFF X DVBLIT1 R DVBZ:DTIME K DVBZ S JP=JP+1,Y="@26";D POW^DVBHUTIL;.525///^S X=DVBPOW1;K DVBPOW1 W "." S JP=JP+1,DVBJ2=1;@26;
"KRN",.402,651,"DR",1,2,27)
I $P(Z2,U,JP)'=7 S Y="@27";I '$D(DVBFL) S Y="@27",JP=JP+1;I DVBFL']"" S Y="@27",JP=JP+1;I DVBFL'?3N1" - "1U.E S Y="@27",JP=JP+1;.314///^S X=+DVBFL;W "." S JP=JP+1,DVBJ2=1;@27;I $P(Z2,U,JP)'=8 S Y="@50";
"KRN",.402,651,"DR",1,2,28)
I '$D(DVBEI) S Y="@50",JP=JP+1;.305///^S X=$S(DVBEI="Y":"Y",1:"N");W "." S JP=JP+1,DVBJ2=1;S Y="@50";@40;I $P(Z2,U,JP)'=1 S Y="@42";I '$D(DVBP(6)) S Y="@42",JP=JP+1;
"KRN",.402,651,"DR",1,2,29)
I $S($P(DVBP(6),U,8)'="Y":1,'$D(^DPT(DFN,.32)):1,+$P(^(0),U,2):1,1:0) S Y="@42",JP=JP+1;.322///^S X="T";W "." S JP=JP+1,DVBJ2=1;@42;I $P(Z2,U,JP)'=2 S Y="@45";I '$D(DVBP(6)) S Y="@45",JP=JP+1;
"KRN",.402,651,"DR",1,2,30)
I $P(DVBP(6),U,4)[" " S Y="@45",JP=JP+1;.32101///^S X=$P(DVBP(6),U,4);W "." S JP=JP+1,DVBJ2=1;@45;I $P(Z2,U,JP)'=3!('$D(DVBDX(1))) S Y="@50";S:'$D(DVBFL) DVBFL="UNKNOWN";
"KRN",.402,651,"DR",1,2,31)
I $D(DVBCAP),DVBCAP["No C&P",$P(DVBBIR,U,5)'="Y" D CHK^DVBHUTIL;@47;
"KRN",.402,651,"DR",1,2,32)
S DVB4=$S($D(^DPT(DFN,.3))>0:$P(^(.3),U),1:0),DVB5=$S($D(^DPT(DFN,.36))>0:$P(^(.36),U),1:0),DVB6=$S($D(^DPT(DFN,"VET"))>0:^("VET"),1:0),DVB7=$S($D(^DPT(DFN,"TYPE"))>0:^("TYPE"),1:0);
"KRN",.402,651,"DR",1,2,33)
S DVB8=$O(^DIC(8,"B","SERVICE CONNECTED 50% to 100%",0)),DVB9=$O(^DIC(8,"B","SC LESS THAN 50%",0));I DVBDXNO I ((DVB8'=DVB5&(DVB9'=DVB5))!(DVB4'="Y")!(DVB6'="Y")!(DVB7'=1)) S Y="@70";
"KRN",.402,651,"DR",1,2,34)
W ! K ^DPT(DFN,.372),JP4,JP6 S ^DPT(DFN,.372,0)="^2.04P^^0",JP=0;S $P(^DPT(DFN,.3),U,2)="",$P(^DPT(DFN,.3),U,14)="";.302///^S X=+$G(DVBDXPCT);.3014///^S X=$G(DVBEFF);@46;S JP=$O(DVBDX(JP)) I 'JP S Y="@50";
"KRN",.402,651,"DR",1,2,35)
S JPP=+$P(DVBDX(JP),U,2) I JPP'>0 S Y="@46";I '$D(^DIC(31,JPP)) D CHKDIS^DVBHS3 S Y="@46";.3721///^S X="""`"_$P(DVBDX(JP),U,2)_"""";W "." S DVBJ2=1;S Y="@46";@61;S Y="@4";I Z2'[1 S Y="@62";I '$D(DVBSSA) S Y="@62",JP=JP+1;
"KRN",.402,651,"DR",1,2,36)
I DVBSSA S DVBYN="Y",DVBXYN=DVBSSA;I 'DVBSSA S DVBYN="N",DVBXYN="";.36225///^S X=DVBYN;W "." S JP=JP+1,DVBJ2=1 K DVBYN,DVBXYN;@62;I Z2'[2 S Y="@63";I '$D(DVBRETT) S Y="@63",JP=JP+1;
"KRN",.402,651,"DR",1,2,37)
I DVBRETT=""!("BMCROX"'[DVBRETT) S Y="@63",JP=JP+1;.36285///^S X=DVBRETT;W "." S JP=JP+1,DVBJ2=1;@63;I Z2'[3 S Y="@64";I '$D(DVBRETO) S Y="@64",JP=JP+1;S X=DVBRETO I X=""!(X=0) S X="@";.3628///^S X=X;W "." S JP=JP+1,DVBJ2=1;@64;
"KRN",.402,651,"DR",1,2,38)
I Z2'[4 S Y="@1006";I '$D(DVBOINC) S Y="@1006",JP=JP+1;S X=DVBOINC I X=""!(X=0) S X="@";.3629///^S X=X;W "." S JP=JP+1,DVBJ2=1,Y="@1006";@4;S Y=$S(DVBJS=11:"@1",DVBJS=28:"@2",DVBJS=35:"@3",DVBJS=44:"@104",1:"@10");@70;
"KRN",.402,651,"DR",1,2,39)
W !!,*7,"HINQ contains SC disabilities, Patient is NSC no updating allowed.  Check       patient's SERVICE CONNECTION, ELIGIBILITY CODE, VET STATUS, or PATIENT TYPE.     Screen 5 contains this.";
"KRN",.402,651,"DR",1,2,40)
R !!,?25,"<RET> to continue.",ZZ:DTIME K ZZ,JP3,JP4;@50;K DVBJX,JP,JPP S Y=$S(DVBJS=28:"@1",DVBJS=35:"@2",1:"@10");@10;I $G(DVBRADL)]"" D DX^DVBHQEDT(DVBRADL);K DVBRADL;
"KRN",.402,651,"DR",2,2.0361)
.01;
"KRN",.402,651,"DR",2,2.04)
2///^S X=$S($P(DVBDX(JP),U,3)="X0":100,1:+$P(DVBDX(JP),U,3));3///^S X=1;4///^S X=$P($G(DVBDX(JP)),U,4);5///^S X=$P($G(DVBDX(JP)),U,5);6///^S X=$P($G(DVBDX(JP)),U,6);
"KRN",.402,651,"ROU")
^DVBHCE
"KRN",.402,651,"ROUOLD")
DVBHCE
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",119,-1)
1^1
"PKG",119,0)
HINQ^DVB^HINQ(Hospital Inquiry)
"PKG",119,22,0)
^9.49I^1^1
"PKG",119,22,1,0)
4.0^2920325^3030902
"PKG",119,22,1,"PAH",1,0)
49^3051102^83
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
31
"RTN","DVB4049P")
0^^B12922854
"RTN","DVB4049P",1,0)
DVB4049P ;ALB/ERC - CHANGE IP ADDR FOR HINQ TO VBA CORPORATE ; 9/1/05 1:46pm
"RTN","DVB4049P",2,0)
 ;;4.0;HINQ;**49**;03/25/92
"RTN","DVB4049P",3,0)
 ;
"RTN","DVB4049P",4,0)
 ;this routine will change the IP address for the HINQ inquiries
"RTN","DVB4049P",5,0)
 ;to the address for the AAC interface engine, which will communicate
"RTN","DVB4049P",6,0)
 ;with the new VBA corporate database in addition to the C&P and BIRLS
"RTN","DVB4049P",7,0)
 ;databases.  There will be only one address for all sites.  This is 
"RTN","DVB4049P",8,0)
 ;being done for the HINQ replacement, interim solution.
"RTN","DVB4049P",9,0)
 ;this routine will also add three entries into the Anatomical - Loss 
"RTN","DVB4049P",10,0)
 ;Code file (#395.2) in the POST subroutine
"RTN","DVB4049P",11,0)
 ;
"RTN","DVB4049P",12,0)
 D ADDR
"RTN","DVB4049P",13,0)
 D POST
"RTN","DVB4049P",14,0)
 Q
"RTN","DVB4049P",15,0)
 ;
"RTN","DVB4049P",16,0)
ADDR ;
"RTN","DVB4049P",17,0)
 N DVBADD,DVBFDA,DVBMSG,DVBNEW,DVBOLDAD,DVBSTA,X,X1,X2
"RTN","DVB4049P",18,0)
 K ^XTMP("DVBBACK")
"RTN","DVB4049P",19,0)
 S DVBSTA=$O(^DVB(395,0))
"RTN","DVB4049P",20,0)
 I '$D(DVBSTA)!($G(DVBSTA)']"") S DVBMSG="HINQ Parameter file (#395) not set properly." G MSG
"RTN","DVB4049P",21,0)
 I '$D(^DVB(395,DVBSTA,0)) S DVBMSG="HINQ Parameter file (#395) not set properly." G MSG
"RTN","DVB4049P",22,0)
 ;new AAC server address DVB*4*49
"RTN","DVB4049P",23,0)
 S X1=DT,X2=30 D C^%DTC
"RTN","DVB4049P",24,0)
 S ^XTMP("DVBBACK",0)=X_"^"_$$NOW^XLFDT_"^DVB*4*49 - HINQ REPLACEMENT PATCH"
"RTN","DVB4049P",25,0)
 S DVBOLDAD=$$GET1^DIQ(395,1,22)
"RTN","DVB4049P",26,0)
 I $G(DVBOLDAD)']"" S DVBOLDAD="Not populated."
"RTN","DVB4049P",27,0)
 S ^XTMP("DVBBACK","OLDIP")=DVBOLDAD
"RTN","DVB4049P",28,0)
 S DVBADD="10.224.132.143"
"RTN","DVB4049P",29,0)
 S DVBFDA(395,"1,",22)=DVBADD
"RTN","DVB4049P",30,0)
 D FILE^DIE("E","DVBFDA")
"RTN","DVB4049P",31,0)
 S DVBNEW=$G(^DVB(395,DVBSTA,"HQIP"))
"RTN","DVB4049P",32,0)
 I $G(DVBNEW)'=DVBADD S DVBMSG="Address change not successful - update manually." G MSG
"RTN","DVB4049P",33,0)
 S DVBMSG="IP address successfully updated to "_DVBADD_"." D MSG
"RTN","DVB4049P",34,0)
 S DVBMSG="Previous IP address was "_DVBOLDAD_"." D MSG
"RTN","DVB4049P",35,0)
 Q
"RTN","DVB4049P",36,0)
MSG ;add message to the KIDS build
"RTN","DVB4049P",37,0)
 D BMES^XPDUTL(.DVBMSG)
"RTN","DVB4049P",38,0)
 Q
"RTN","DVB4049P",39,0)
 ;
"RTN","DVB4049P",40,0)
 ;need to add three entries into file 395.2 (Anat-Loss Code file)
"RTN","DVB4049P",41,0)
 ;this is patterned after DVB448PT
"RTN","DVB4049P",42,0)
POST ;entry point for post-install, setting up checkpoints
"RTN","DVB4049P",43,0)
 N %
"RTN","DVB4049P",44,0)
 S %=$$NEWCP^XPDUTL("DVBLINE","EN^DVB4049P",1)
"RTN","DVB4049P",45,0)
 Q
"RTN","DVB4049P",46,0)
 ;
"RTN","DVB4049P",47,0)
EN ;begin processing
"RTN","DVB4049P",48,0)
 ;
"RTN","DVB4049P",49,0)
 N DVBLINE
"RTN","DVB4049P",50,0)
 ;
"RTN","DVB4049P",51,0)
 D BMES^XPDUTL("  >> *** Updating ANATOMICAL-LOSS CODE file (#395.2)")
"RTN","DVB4049P",52,0)
 D MES^XPDUTL("  ")
"RTN","DVB4049P",53,0)
 ;
"RTN","DVB4049P",54,0)
 ;get value from checkpoints, previous run
"RTN","DVB4049P",55,0)
 S DVBLINE=+$$PARCP^XPDUTL("DVBLINE")
"RTN","DVB4049P",56,0)
 ;
"RTN","DVB4049P",57,0)
DVBNEW ;add new codes or modify name if code is in use
"RTN","DVB4049P",58,0)
 ;
"RTN","DVB4049P",59,0)
 F DVBI=DVBLINE:1 S DVBJ=$P($T(NEWCODE+DVBI),";;",2) Q:DVBJ["$EXIT"  D
"RTN","DVB4049P",60,0)
 .S DVBCODE=+DVBJ,DVBLINE=DVBI
"RTN","DVB4049P",61,0)
 .S DVBDESC=$E($P(DVBJ,"^",2),1,30)
"RTN","DVB4049P",62,0)
 .;
"RTN","DVB4049P",63,0)
 .;add new code
"RTN","DVB4049P",64,0)
 .I '$D(^DVB(395.2,"B",DVBCODE)) D  G UPDATECH
"RTN","DVB4049P",65,0)
 ..K DD,DO
"RTN","DVB4049P",66,0)
 ..S DIC="^DVB(395.2,",DIC(0)="L",DIC("DR")="1////"_DVBDESC
"RTN","DVB4049P",67,0)
 ..S X=$P(DVBJ,U),DLAYGO=31
"RTN","DVB4049P",68,0)
 ..D FILE^DICN
"RTN","DVB4049P",69,0)
 ..D MES^XPDUTL("adding new code - "_X)
"RTN","DVB4049P",70,0)
 ..K DLAYGO,DIC,X
"RTN","DVB4049P",71,0)
 ..Q
"RTN","DVB4049P",72,0)
 .;
"RTN","DVB4049P",73,0)
 .;modify name
"RTN","DVB4049P",74,0)
 .S DVBIEN=+$O(^DVB(395.2,"B",DVBCODE,0))
"RTN","DVB4049P",75,0)
 .S DVBREC=$G(^DVB(395.2,DVBIEN,0)),DVBOLDSC=$P(DVBREC,U,2) I DVBREC']"" D  G UPDATECH
"RTN","DVB4049P",76,0)
 ..D MES^XPDUTL("  >>>> error "_DVBCODE_" in B x-reference and not in file 395.2")
"RTN","DVB4049P",77,0)
 ..Q
"RTN","DVB4049P",78,0)
 .S DVBOLDC=$P(DVBREC,"^") I DVBOLDC=DVBCODE,(DVBOLDSC=DVBDESC) G UPDATECH
"RTN","DVB4049P",79,0)
 .I DVBOLDC'=DVBCODE D
"RTN","DVB4049P",80,0)
 ..S DA=DVBIEN,DIE="^DVB(395.2,",DR=".01////"_DVBCODE_";1////"_DVBDESC
"RTN","DVB4049P",81,0)
 ..D ^DIE
"RTN","DVB4049P",82,0)
 ..K DR,DA,DIE
"RTN","DVB4049P",83,0)
 .I DVBOLDSC'=DVBDESC D
"RTN","DVB4049P",84,0)
 ..S DA=DVBIEN,DIE="^DVB(395.2,",DR="1////"_DVBDESC
"RTN","DVB4049P",85,0)
 ..D ^DIE
"RTN","DVB4049P",86,0)
 ..K DA,DIE,DR
"RTN","DVB4049P",87,0)
 ..D MES^XPDUTL(DVBCODE_": changing description...")
"RTN","DVB4049P",88,0)
 ..D MES^XPDUTL("          from:  "_DVBOLDSC)
"RTN","DVB4049P",89,0)
 ..D MES^XPDUTL("            to:  "_DVBDESC)
"RTN","DVB4049P",90,0)
 .;
"RTN","DVB4049P",91,0)
UPDATECH .;update checkpoint
"RTN","DVB4049P",92,0)
 .S %=$$UPCP^XPDUTL("DVBLINE",DVBLINE)
"RTN","DVB4049P",93,0)
 .Q
"RTN","DVB4049P",94,0)
 K DVBCODE,DVBI,DVBIEN,DVBJ,DVBNAME,DVBOLDC,DVBOLDN,DVBREC,DVBDESC,DVBOLDSC
"RTN","DVB4049P",95,0)
 Q
"RTN","DVB4049P",96,0)
 ;
"RTN","DVB4049P",97,0)
NEWCODE ;codes to be added or changed
"RTN","DVB4049P",98,0)
 ;;16^Deafness, Total
"RTN","DVB4049P",99,0)
 ;;17^Aphonia
"RTN","DVB4049P",100,0)
 ;;29^Deafnessand Aphonia
"RTN","DVB4049P",101,0)
 ;;$EXIT
"RTN","DVB4049P",102,0)
 Q
"RTN","DVBHIQM")
0^19^B24310188
"RTN","DVBHIQM",1,0)
DVBHIQM ;ISC-ALBANY/PKE,DLM/WASH-MAIL DELIVERY PROGRAM ;8/20/87  18:33
"RTN","DVBHIQM",2,0)
 ;;4.0;HINQ;**49**;03/25/92 
"RTN","DVBHIQM",3,0)
 G EN
"RTN","DVBHIQM",4,0)
LIN Q:CT>50  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHIQM",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") Q
"RTN","DVBHIQM",6,0)
 ;
"RTN","DVBHIQM",7,0)
EN I $D(X(1)),$E(X(1),1,5)'="ERROR" S DFN=$E(X(1),8,21),XMDUZ=.5,XMSUB="HINQ response for " I DFN?14"0" S DFN=0,XMSUB="HINQ Transaction Test "
"RTN","DVBHIQM",8,0)
 I DFN'?14" " K DVBREQST
"RTN","DVBHIQM",9,0)
 S DFN=+DFN I $D(DUZ) S XMORIG=DUZ
"RTN","DVBHIQM",10,0)
 E  QUIT
"RTN","DVBHIQM",11,0)
 I '+XMORIG QUIT
"RTN","DVBHIQM",12,0)
 ;
"RTN","DVBHIQM",13,0)
 S (DVBASK,DVBASKER)=0
"RTN","DVBHIQM",14,0)
 I DFN=0 G SUBJ
"RTN","DVBHIQM",15,0)
 ;
"RTN","DVBHIQM",16,0)
MAILGP K XMY,DVBXMY
"RTN","DVBHIQM",17,0)
 I $D(^XMB(3.8,"B","DVBHINQ")) S N=0,N=$O(^("DVBHINQ",N)) Q:'N  F DVBU=0:0 S DVBU=$O(^XMB(3.8,N,1,"B",DVBU)) Q:'DVBU  S XMY(DVBU)=""
"RTN","DVBHIQM",18,0)
REQ ;
"RTN","DVBHIQM",19,0)
 ;replace direct global lookup of div with GETS^DIQ - DVB*4*49
"RTN","DVBHIQM",20,0)
 I $D(^DVB(395.5,DFN,0)) D
"RTN","DVBHIQM",21,0)
 . N DVBARR,DVBERR
"RTN","DVBHIQM",22,0)
 . D GETS^DIQ(395.5,DFN_",",9,"E","DVBARR","DVBERR")
"RTN","DVBHIQM",23,0)
 . S DVBDIV=$G(DVBARR(395.5,DFN_",",9,"E"))
"RTN","DVBHIQM",24,0)
 F DVBU=0:0 S DVBU=$O(^DVB(395.5,DFN,1,DVBU)) Q:'DVBU  S:$D(^(DVBU,0)) DVBXMY(DVBU)=$P(^(0),U,2) ;for latest requestor dvbasker
"RTN","DVBHIQM",25,0)
 I '$D(DVBDIV) K DVBDIV
"RTN","DVBHIQM",26,0)
 ;
"RTN","DVBHIQM",27,0)
 F DVBU=0:0 S DVBU=$O(DVBXMY(DVBU)) Q:'DVBU  I $D(^XUSEC("DVBHINQ",DVBU)) S XMY(DVBU)="" I DVBXMY(DVBU)>DVBASK S DVBASK=DVBXMY(DVBU),DVBASKER=DVBU
"RTN","DVBHIQM",28,0)
 ;
"RTN","DVBHIQM",29,0)
SUBJ S U="^",XMY(XMORIG)="",XMSUB=XMSUB_$S($D(^DPT(DFN,0)):$P(^(0),"^",1),1:" ")_" /requested by "_$S(DVBASKER:$S($D(^VA(200,DVBASKER,0)):$P(^(0),U),1:""),1:"")_$S('DVBASKER:$S($D(^VA(200,DUZ,0)):$P(^(0),U),1:""),1:"")
"RTN","DVBHIQM",30,0)
 ;
"RTN","DVBHIQM",31,0)
 K ^TMP($J) S CT=0,(A,XMTEXT)="^TMP($J,",BL="",$P(BL," ",36)=" "
"RTN","DVBHIQM",32,0)
 ;
"RTN","DVBHIQM",33,0)
 I $D(DVBREQST) S Y=DVBREQST D DATA,LIN,SEGM S T1="" D LIN
"RTN","DVBHIQM",34,0)
 ;
"RTN","DVBHIQM",35,0)
 I $D(^DPT(DFN,0)) D DPT,LIN,WARN,SEGM
"RTN","DVBHIQM",36,0)
 ;
"RTN","DVBHIQM",37,0)
 K DVBDIV,DVBREQST,DVBASK,DVBASKER,T9,L1,F1,F2,F3,F3,F4,F5,Y,S,S1,C,DVBXMY,DVBU,N
"RTN","DVBHIQM",38,0)
 ;exit point for errors
"RTN","DVBHIQM",39,0)
 I $D(DVBERR) S T1="       HINQ Error = "_DVBERR D LIN
"RTN","DVBHIQM",40,0)
 I $D(DVBERR) D ERR1
"RTN","DVBHIQM",41,0)
 I $D(DVBERR1) S T1="       Inquiry Data Submitted = "_DVBERR1 D LIN G ERR^DVBHQM3
"RTN","DVBHIQM",42,0)
 I $D(DVBOTM),$D(DVBNETER) S Y=DVBOTM D DD S T1=" Message out Time => "_Y D LIN
"RTN","DVBHIQM",43,0)
 I $D(DVBNETER) S T1=" IDCU Network Error" D LIN S T1=" "_DVBNETER D LIN I $D(DVBREQUE) S Y=DVBREQUE D DD S T1=" "_"Request has been retransmitted"_$S($L(DVBREQUE):" at "_Y,1:"") D LIN G ERR^DVBHQM3
"RTN","DVBHIQM",44,0)
 I $D(DVBNETER),'$D(DVBREQUE) S T1=" Request NOT retransmitted" D LIN G ERR^DVBHQM3
"RTN","DVBHIQM",45,0)
 S:X(1)["HINQ" X(1)=$E(X(1),1,6) S:$D(X(2)) X(2)=$E(X(2),1,6)
"RTN","DVBHIQM",46,0)
 ;
"RTN","DVBHIQM",47,0)
 G:$D(DVBABREV) EN^DVBHQM4
"RTN","DVBHIQM",48,0)
 G EN^DVBHQM1
"RTN","DVBHIQM",49,0)
 ;
"RTN","DVBHIQM",50,0)
DPT S (S,C,T9)=""
"RTN","DVBHIQM",51,0)
 S T1=$P(^DPT(DFN,0),U),Y=$P(^(0),U,3),T9=$P(^(0),U,9) D DD S T1=T1_" "_Y_" SSN:"_T9 S:$D(^(.31)) C=$P(^(.31),U,3) S:$D(^(.32)) S=$P(^(.32),U,8) S T1=T1_$S($L(C):" C-#:"_C,1:"")_$S($L(S):" S-#:"_S,1:"")_$S($D(DVBDIV):" Div:"_DVBDIV,1:"") Q
"RTN","DVBHIQM",52,0)
 ;
"RTN","DVBHIQM",53,0)
WARN Q:$D(DVBABREV)  ;don't compare multiple values for abrev return
"RTN","DVBHIQM",54,0)
 I $L(T9),$D(DVBSSN),DVBSSN?9N,+DVBSSN'=+T9 S T1="***  SSN from patient file does not match SSN from VBA  ***" D LIN
"RTN","DVBHIQM",55,0)
 I $L(C),$D(DVBCN),+DVBCN'=+C S T1="***  C-# from patient file does not match C-# from VBA  ***" D LIN
"RTN","DVBHIQM",56,0)
 I $L(S),$D(DVBSN)>9 S S1=1 F N=0:0 S N=$O(DVBSN(N)) Q:'N  I +DVBSN(N)=+S K S1 Q
"RTN","DVBHIQM",57,0)
 I $D(S1) S T1="***  S-# from Patient file does not match a S-# from VBA  ***" D LIN
"RTN","DVBHIQM",58,0)
 Q
"RTN","DVBHIQM",59,0)
 ;
"RTN","DVBHIQM",60,0)
SEGM Q:'$D(DVBBAS(2))
"RTN","DVBHIQM",61,0)
 I '$P(DVBBAS(2),U,35),'$P(DVBBAS(2),U,36),'$P(DVBBAS(2),U,37),'$P(DVBBAS(2),U,38) Q
"RTN","DVBHIQM",62,0)
 S T1="   WARNING: Error Indicators for " F N=38:-1:35 I $P(DVBBAS(2),U,N) S T1=T1_" "_$S(N=38:"BASIC",N=37:"STATISTICAL",N=36:"DIAGNOSTIC",N=35:"FUTURE",1:"")_","
"RTN","DVBHIQM",63,0)
 S T1=$E(T1,1,$L(T1)-1) D LIN
"RTN","DVBHIQM",64,0)
 Q
"RTN","DVBHIQM",65,0)
 ;
"RTN","DVBHIQM",66,0)
DATA S F1=$F(Y,"NM"),F2=$F(Y,"/",F1),F3=$F(Y,"SS",F2),F4=$F(Y,"CN",F2),F5=$F(Y,"SN",F2),T1=" Data Requested:"_$S(F1:" "_$E(Y,3,F2-2),1:"")_$S(F3:"  SS# "_$E(Y,F3,F3+8),1:"")_$S(F4:"  C# "_$E(Y,F4,F4+8),1:"")_$S(F5:"  S# "_$E(Y,F5,F5+8),1:"") Q
"RTN","DVBHIQM",67,0)
ERR1 ;set inquiry info into error text
"RTN","DVBHIQM",68,0)
 N DVBZZ,DVBZZZ
"RTN","DVBHIQM",69,0)
 S DVBZZZ=""
"RTN","DVBHIQM",70,0)
 S DVBZZ=$S($G(DVBZ)]"":DVBZ,$G(DVBZ0)]"":DVBZ0,$G(DVBZ1)]"":DVBZ1,1:"")
"RTN","DVBHIQM",71,0)
 I DVBZZ["SS" S DVBZZZ="SS"_$E($P(DVBZZ,"SS",2),1,9)
"RTN","DVBHIQM",72,0)
 I DVBZZ["CN" S DVBZZZ=DVBZZZ_"  CN"_$E($P(DVBZZ,"CN",2),1,9)
"RTN","DVBHIQM",73,0)
 I DVBZZ["SN" S DVBZZZ=DVBZZZ_"  SN"_$E($P(DVBZZ,"SN",2),1,9)
"RTN","DVBHIQM",74,0)
 I $G(DVBZZZ)]"" S DVBERR1=DVBZZZ
"RTN","DVBHIQM",75,0)
 Q
"RTN","DVBHIQR")
0^20^B12027646
"RTN","DVBHIQR",1,0)
DVBHIQR ;ISC-ALBANY/PKE-Process HINQ response ; 8/25/05 9:23pm
"RTN","DVBHIQR",2,0)
 ;;4.0;HINQ;**32,49**;03/25/92 
"RTN","DVBHIQR",3,0)
TEM ;ENTER FROM PRINT TEMPLATE.
"RTN","DVBHIQR",4,0)
 S DVBCS=0,DVBECS=1 K DVBERCS
"RTN","DVBHIQR",5,0)
 F DVBSZ=0:0 S DVBSZ=$O(^DVB(395.5,DFN,"RS",DVBSZ)) S:DVBSZ X(DVBSZ)=^(DVBSZ,0) D SC^DVBHQST Q:$G(DVBERCS)  Q:'DVBSZ!$D(DVBCSE)
"RTN","DVBHIQR",6,0)
 K M,DVBCS,DVBSZ,DVBECS Q:'$D(X(1))!($D(DVBERCS))
"RTN","DVBHIQR",7,0)
A D:'$D(DT) DT^DICRW I $D(X(1)),$E(X(1),1,4)'="HINQ" G NETERR
"RTN","DVBHIQR",8,0)
 ;
"RTN","DVBHIQR",9,0)
 I $D(X)#2,$E(X,1,4)="HINQ" S DVBREQST=$E(X,24,$L(X)-8) K:'$L(DVBREQST) DVBREQST
"RTN","DVBHIQR",10,0)
 ;
"RTN","DVBHIQR",11,0)
 D CHK ;if 5th char is 2 but no name, claim #, change 5th char to "C"
"RTN","DVBHIQR",12,0)
 ;I $A($E(X(1),26,34))'>$A(" "),($A($E(X(1),44,50))'>$A(" ")) D CHK
"RTN","DVBHIQR",13,0)
 ;
"RTN","DVBHIQR",14,0)
 G Q:'$D(X(1)) I "456789ABCDUVW"'[$E(X(1),5) G ^DVBHQR1:$E(X(1),5)=2,EN^DVBHQR3:$E(X(1),5)="N",EN^DVBHQR3:$E(X(1),5)="M",Q:$E(X(1),1,4)'="HINQ"
"RTN","DVBHIQR",15,0)
 ;
"RTN","DVBHIQR",16,0)
 S Y=$E(X(1),5) D ERR S DVBERR=Y,Y=$F(X(1),"NNNN"),DVBERR1=$S(Y:$E(X(1),1,Y-2),1:X(1))
"RTN","DVBHIQR",17,0)
 ;
"RTN","DVBHIQR",18,0)
HINQ S DFN=+$E(X(1),8,21) I $D(DUZ) S XMDUZ=DUZ
"RTN","DVBHIQR",19,0)
 E  S XMDUZ=0
"RTN","DVBHIQR",20,0)
 G Q
"RTN","DVBHIQR",21,0)
ERR ;
"RTN","DVBHIQR",22,0)
 I Y=" " S Y="No VBA response available - please try again later."
"RTN","DVBHIQR",23,0)
 I "B"[Y S Y="Network/Database Problem" Q
"RTN","DVBHIQR",24,0)
 I "C"[Y D RETRY Q
"RTN","DVBHIQR",25,0)
 I Y=6 S Y="Invalid Employee number Not AUTHORIZED" Q
"RTN","DVBHIQR",26,0)
 I Y=9 S Y="PASSWORD missing or invalid" Q
"RTN","DVBHIQR",27,0)
 I Y="X" S Y="Station # does not match Station # of password " Q
"RTN","DVBHIQR",28,0)
 I Y="Y" S Y="Employee Number in New Person file doesn't match the # in VBA security record" Q
"RTN","DVBHIQR",29,0)
 ;
"RTN","DVBHIQR",30,0)
 S Y=$S(Y=4:"File in alert, NOT available",Y=5:"NO C&P record found ",Y=7:"SS # missing or invalid.",Y=8:"NAME missing or invalid.",1:Y) Q:Y'?1U
"RTN","DVBHIQR",31,0)
 ;
"RTN","DVBHIQR",32,0)
 S Y=$S(Y="A":"File NOT available",Y="D":"SENSITIVE File no access authorized",Y="U":"Unsuccessful read of password or sensitive file",Y="V":"Invalid CLAIM NUMBER",Y="W":"Invalid SERVICE NUMBER",1:Y)
"RTN","DVBHIQR",33,0)
 Q
"RTN","DVBHIQR",34,0)
Q K DVBOTM,DVBV,DVBOXMZ,DVBIXMZ,XMORIG QUIT
"RTN","DVBHIQR",35,0)
 ;
"RTN","DVBHIQR",36,0)
NETERR ;
"RTN","DVBHIQR",37,0)
 S:'$D(DVBZ) DVBZ=^DVB(395.5,DFN,"HQ") S XMORIG=DUZ,XMDUZ=.5,XMSUB="IDCU Response for ",DVBREQUE="",DFN=+$E(DVBZ,10,21),DVBNETER=X(1) Q
"RTN","DVBHIQR",38,0)
 G Q
"RTN","DVBHIQR",39,0)
RETRY S Y="                                 "
"RTN","DVBHIQR",40,0)
 I $P(X(1),"[TRY]",2) Q
"RTN","DVBHIQR",41,0)
 N DVBZZ
"RTN","DVBHIQR",42,0)
 S DVBZZ=$S($G(DVBZ0)]"":DVBZ0,$G(DVBZ1)]"":DVBZ1,1:"")
"RTN","DVBHIQR",43,0)
 I DVBZZ["SS",(DVBZZ["CN") S Y="No record matches input.  Check data and try again                       via 'Individual HINQ'." Q
"RTN","DVBHIQR",44,0)
 I DVBZZ'["SS" S Y="SSN."
"RTN","DVBHIQR",45,0)
 I DVBZZ'["CN" S Y="CN."
"RTN","DVBHIQR",46,0)
 I DVBZZ["SN" S Y="CN OR SSN."
"RTN","DVBHIQR",47,0)
 S X(1)=$P(X(1),"[TRY]")
"RTN","DVBHIQR",48,0)
 I $E(X(1),5)="C" S Y="No Record matches data requested, Retry using                      "_Y
"RTN","DVBHIQR",49,0)
 E  S Y="Can NOT identify with this data,  Retry using "_Y
"RTN","DVBHIQR",50,0)
 S Y=Y_" via 'Individual HINQ'." Q
"RTN","DVBHIQR",51,0)
 ;
"RTN","DVBHIQR",52,0)
CHK ;if a response has 2 for the 5th char but no name or CN, change
"RTN","DVBHIQR",53,0)
 ;the 5th char to "C"
"RTN","DVBHIQR",54,0)
 I $E(X(1),5)=2,($A($E(X(1),26,34))'>$A(" ")),($A($E(X(1),44,50))'>$A(" ")) S $E(X(1),5)="C"
"RTN","DVBHIQR",55,0)
 Q
"RTN","DVBHQAT")
0^32^B8405451
"RTN","DVBHQAT",1,0)
DVBHQAT ;ISC-ALbany/JLU HINQ packing routine  [ 09/21/94  1:23 PM ]
"RTN","DVBHQAT",2,0)
 ;;4.0;HINQ;**22,32,36,49**;03/25/92 
"RTN","DVBHQAT",3,0)
 ;
"RTN","DVBHQAT",4,0)
KIL K J,LF,D,K,N,T,Y0,Z1,LP,L2,L3,DVBLEN,DVBIO,DVBNUM,F1,F2,X1,G,I,T1,DVBTIME,Z,L,DVBDEV,DVBDSCH,DVBECHO,DVBEND,DVBLOG,DVBPRGM,DVBTIM,DVBTMX,DVBXM,DVBZ,DVBABORT,DVBVDI,DVBTSK,DVBCN,DVBP,DVBSN,DFN,DIC,X,Y,R,DVBDXSC,DVBIXMZ,DVBUSER,DVBCS
"RTN","DVBHQAT",5,0)
 K DVBI,DVBFUE,DVBFUF,DVBBAS,DVBBIR,DVBINC,DVBP,DVBV1
"RTN","DVBHQAT",6,0)
 K DVBID,DVBIDCU,DVBPU,DVBPW,DVBS,DVBV2,LP2,LX,LY,NXL,SPN
"RTN","DVBHQAT",7,0)
 K DVBTRY,DVBRTC,DVBNRT
"RTN","DVBHQAT",8,0)
 Q
"RTN","DVBHQAT",9,0)
 ;
"RTN","DVBHQAT",10,0)
HP W !!," Input from the 'P'atient File only requires you to select a Patient Name.",!," 'D'irect input will prompt for Social Security Number, Claim Number or Service Number.",!," You may enter Patients not in the Patient file."
"RTN","DVBHQAT",11,0)
 W !," Direct input will not enter Patients in the Patient File."
"RTN","DVBHQAT",12,0)
 Q
"RTN","DVBHQAT",13,0)
 ;
"RTN","DVBHQAT",14,0)
E S DVB12=1
"RTN","DVBHQAT",15,0)
 F A=0:0 S A=$O(X(A)) Q:'A  D S
"RTN","DVBHQAT",16,0)
 K X
"RTN","DVBHQAT",17,0)
 Q:'$D(XY(1))
"RTN","DVBHQAT",18,0)
 F A=0:0 S A=$O(XY(A)) Q:'A  S X(A)=XY(A) K XY(A)
"RTN","DVBHQAT",19,0)
 ;
"RTN","DVBHQAT",20,0)
EX K DVB12,A,XY,B,L
"RTN","DVBHQAT",21,0)
 Q
"RTN","DVBHQAT",22,0)
 ;
"RTN","DVBHQAT",23,0)
S I $L(X(A))=245 S XY(DVB12)=X(A),DVB12=DVB12+1 K X(A) Q
"RTN","DVBHQAT",24,0)
 I $L(X(A))<245 D S1 Q
"RTN","DVBHQAT",25,0)
 I $L(X(A))>245 D S2 Q
"RTN","DVBHQAT",26,0)
 Q
"RTN","DVBHQAT",27,0)
 ;
"RTN","DVBHQAT",28,0)
S1 S XY(DVB12)=X(A) K X(A) F B=0:0 S B=$O(X(B)) Q:'B  S L=245-$L(XY(DVB12)),XY(DVB12)=XY(DVB12)_$E(X(B),1,L),X(B)=$E(X(B),L+1,999) K:'$L(X(B)) X(B) I $L(XY(DVB12))=245 S DVB12=DVB12+1 Q
"RTN","DVBHQAT",29,0)
 Q
"RTN","DVBHQAT",30,0)
 ;
"RTN","DVBHQAT",31,0)
S2 F B=0:0 S XY(DVB12)=$E(X(A),1,245),X(A)=$E(X(A),246,999),DVB12=DVB12+1 I $L(X(A))<245 S A=0 Q
"RTN","DVBHQAT",32,0)
 Q
"RTN","DVBHQAT",33,0)
 ;
"RTN","DVBHQAT",34,0)
CNLKUP S CN=$S($D(^DPT(DFN,.31)):$P(^(.31),"^",3),1:"")
"RTN","DVBHQAT",35,0)
 I 'CN Q
"RTN","DVBHQAT",36,0)
 I CN["P" S CN="" Q
"RTN","DVBHQAT",37,0)
 S CN=$E(" 00000000",1,9-$L(CN))_CN
"RTN","DVBHQAT",38,0)
 S DVBZ=$E(DVBZ,1,$L(DVBZ)-8)_"CN"_CN_$E(DVBZ,$L(DVBZ)-7,99)
"RTN","DVBHQAT",39,0)
 S CN=$F(DVBZ,"/CN",24) Q
"RTN","DVBHQAT",40,0)
 ;
"RTN","DVBHQAT",41,0)
STUFF Q:'DFN
"RTN","DVBHQAT",42,0)
 S DVBNOWRT="",DVBZSAV=DVBZ,DVBZ=$E(DVBZ,1,$L(DVBZ)-4)
"RTN","DVBHQAT",43,0)
 D DIV^DVBHQZ4,EN1^DVBHQUT
"RTN","DVBHQAT",44,0)
 S DVBZ=DVBZSAV K DVBZSAV Q
"RTN","DVBHQD1")
0^29^B24115868
"RTN","DVBHQD1",1,0)
DVBHQD1 ;ISC-ALBANY/PKE- HINQ receiver ; 10/28/05 7:33am
"RTN","DVBHQD1",2,0)
 ;;4.0;HINQ;**3,12,16,22,23,32,34,40,46,49**; 03/25/92 
"RTN","DVBHQD1",3,0)
 ;
"RTN","DVBHQD1",4,0)
 S:'$D(DTIME) DTIME=300 S DVBTIME=DTIME
"RTN","DVBHQD1",5,0)
EN S:$G(IO(0))="" IO(0)=$I S (C,DVBTSK,DVBABORT)=0,DVBXM=1,DTIME=30 U IO(0)
"RTN","DVBHQD1",6,0)
 ;
"RTN","DVBHQD1",7,0)
SEL S (DVBRTC,DVBTRY)=1,DVBNRT="Y"
"RTN","DVBHQD1",8,0)
 R !!," Select Input: (P)atient File, or (D)irect  P//",X:DTIME I '$T!(X["^") G HINQ
"RTN","DVBHQD1",9,0)
 I "Pp"[$E(X) S DVBPRGM="TM^DVBHIQD" G ASK
"RTN","DVBHQD1",10,0)
 I "Dd"[$E(X_1) S DVBPRGM="EN^DVBHQDE" G ASK
"RTN","DVBHQD1",11,0)
 I X["?" D HP^DVBHQAT G SEL
"RTN","DVBHQD1",12,0)
 G SEL
"RTN","DVBHQD1",13,0)
ASK S:$G(IO(0))="" IO(0)=$I W ! S Y=0,DVBIO=IO D @DVBPRGM
"RTN","DVBHQD1",14,0)
ASK1 I Y'<0,$D(DVBP),$L(DVBP)=4 S IO=DVBIO D STUFF^DVBHQAT:$D(DFN),MES
"RTN","DVBHQD1",15,0)
 I $D(DVBMISS) K DVBMISS D:DVBTRY>3 RETRY^DVBHQD2 G:DVBNRT="N" LOAD2^DVBHQD2 I DVBTRY<4&(DVBRTC<4) S DVBTRY=DVBTRY+1 U IO(0) W ?35,"Retrying Request." G ASK1
"RTN","DVBHQD1",16,0)
 S IO=DVBIO U IO(0) K DVBP S DVBABORT=0
"RTN","DVBHQD1",17,0)
 I '$D(Y) G ASK
"RTN","DVBHQD1",18,0)
 I Y>0 G ASK
"RTN","DVBHQD1",19,0)
 ;
"RTN","DVBHQD1",20,0)
HINQ U IO(0) W !!,"Do you wish to continue" S %=2 D YN^DICN G:'% HINQ I %=1 W ! G EN
"RTN","DVBHQD1",21,0)
EX S DTIME=$S($D(DVBTIME):DVBTIME,1:300)
"RTN","DVBHQD1",22,0)
 Q
"RTN","DVBHQD1",23,0)
MES ;
"RTN","DVBHQD1",24,0)
 S:$G(IO(0))="" IO(0)=$I S E=$L(DVBZ) I '$D(DVBDXX),($E(DVBZ,E-7,E-4)'=DVBNUM) S DVBZ=$E(DVBZ,1,E-4)_DVBNUM_$E(DVBZ,E-3,999)
"RTN","DVBHQD1",25,0)
 K E H 1 S DVBEND="NNNN" S:'$D(DVBXM) DVBXM=0 S:'$D(C) C=0
"RTN","DVBHQD1",26,0)
 ;
"RTN","DVBHQD1",27,0)
TOTIMS S TRY=0,CN=$F(DVBZ,"/CN",24),DVBZ0=DVBZ
"RTN","DVBHQD1",28,0)
 I $S('$D(DFN):1,DFN:0,1:1) S CN=0 D SEND^DVBHQD2,KTO^DVBHQD2 Q
"RTN","DVBHQD1",29,0)
 I 'CN D CNLKUP^DVBHQAT
"RTN","DVBHQD1",30,0)
 DO  D SEND^DVBHQD2 I TRY DO  I TRY H 1 D SEND^DVBHQD2
"RTN","DVBHQD1",31,0)
 .I CN,'TRY S DVBZ0=$E(DVBZ,1,23)_$E(DVBZ,24,CN-3)_$E(DVBZ,CN+9,999) Q
"RTN","DVBHQD1",32,0)
 .I CN,TRY S DVBZ1=$E(DVBZ,1,23)_$E(DVBZ,CN-2,999) Q
"RTN","DVBHQD1",33,0)
 .I 'CN S DVBZ0=DVBZ,TRY=0 Q
"RTN","DVBHQD1",34,0)
 I $D(DVBMISS)&($D(DVBPRGM)) I (DVBPRGM["TM") K DVBMISS D:DVBTRY>3 RETRY^DVBHQD2 G:DVBNRT="N" LOAD^DVBHQD2 I DVBTRY<4&(DVBRTC<4) S DVBTRY=DVBTRY+1 U IO(0) W ?35,"Retrying Request." G MES
"RTN","DVBHQD1",35,0)
 G KTO^DVBHQD2
"RTN","DVBHQD1",36,0)
 ;
"RTN","DVBHQD1",37,0)
 ;z1 is first x(),z9 is last x()
"RTN","DVBHQD1",38,0)
OK ;I 'DVBTSK DO
"RTN","DVBHQD1",39,0)
 ;. U IO(0) W !!?3 S Z1=0 F  S Z1=$O(X(Z1)) Q:'Z1  S LX=$G(LX)+$L(X(Z1)) W Z1," ",$L(X(Z1)),"   "
"RTN","DVBHQD1",40,0)
 ;. W !?9,LX,! K LX H 3 U IO
"RTN","DVBHQD1",41,0)
 S:$G(IO(0))="" IO(0)=$I S Z1=$O(X(0)) F  Q:$E(X(Z1))'=$C(10)  S X(Z1)=$E(X(Z1),2,999)
"RTN","DVBHQD1",42,0)
 I $G(X(Z1))["HINQ" S X(Z1)="HINQ"_$P(X(Z1),"HINQ",2)
"RTN","DVBHQD1",43,0)
 E  K X(Z1) DO
"RTN","DVBHQD1",44,0)
 . S Z1=$O(X(0)) I Z1="" S Z1=0,X(0)=""
"RTN","DVBHQD1",45,0)
 . I $G(X(Z1))["HINQ" S X(Z1)="HINQ"_$P(X(Z1),"HINQ",2)
"RTN","DVBHQD1",46,0)
 I $L(X(Z1))>25 S DVBLEN=+$E(X(Z1),22,25)
"RTN","DVBHQD1",47,0)
 I $L(X(Z1))'>25 D
"RTN","DVBHQD1",48,0)
 . I $D(X(Z1+1)) DO
"RTN","DVBHQD1",49,0)
 . . S DVBLEN=+$E($E(X(Z1),1,99)_$E(X(Z1+1),1,30),22,25)
"RTN","DVBHQD1",50,0)
 . I '$D(X(Z1+1)) D
"RTN","DVBHQD1",51,0)
 . S DVBLEN=$L(X(Z1)) ;DVB*4*49 - error response may be < 25 chars
"RTN","DVBHQD1",52,0)
 I '$D(DVBLEN) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing string" U IO Q
"RTN","DVBHQD1",53,0)
 ;
"RTN","DVBHQD1",54,0)
 I $D(F3) S DVBLEN=DVBLEN-F3 K F3
"RTN","DVBHQD1",55,0)
 I "456789ABCDUVWNMXY"'[$E(X(Z1),5) S DVBLEN=DVBLEN-2
"RTN","DVBHQD1",56,0)
 ;
"RTN","DVBHQD1",57,0)
 S (Z,Z9,F2)=0 F  S Z=$O(X(Z)) Q:'Z  S Z9=Z,F2=F2+$L(X(Z))
"RTN","DVBHQD1",58,0)
 ;
"RTN","DVBHQD1",59,0)
 I DVBLEN'=F2,X(Z9)[$C(10) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing character" S DVBMISS="" Q
"RTN","DVBHQD1",60,0)
 I $E(X(Z1),5)'=2 S F2=F2+1
"RTN","DVBHQD1",61,0)
 ;
"RTN","DVBHQD1",62,0)
 I DVBLEN'=F2-1,X(Z9)'[$C(10),$S('$D(X(Z9-1)):1,1:$S(X(Z9-1)'[$C(10):1,1:0)) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing character" S DVBMISS="" Q
"RTN","DVBHQD1",63,0)
 ;trim,e will pack back to x(1)
"RTN","DVBHQD1",64,0)
 I Z9 S:$D(X) DVBSOX=X D TRIM,E^DVBHQAT S:$D(DVBSOX) X=DVBSOX K DVBSOX I $E(X(1),1,4)["HINQ","AXY69"'[$E($E(X(1),5)_1) D ALLM Q
"RTN","DVBHQD1",65,0)
 ;
"RTN","DVBHQD1",66,0)
 S DVBABORT=DVBABORT+1 Q:$E(X(1),1,4)'="HINQ"
"RTN","DVBHQD1",67,0)
 I $E(X(1),5)="A" U IO(0) W:'DVBTSK !,"VBA File not Available" U IO H 2 D ALL QUIT
"RTN","DVBHQD1",68,0)
 ;
"RTN","DVBHQD1",69,0)
 I DVBTSK,"69XY"[$E($E(X(1),5)_1) S DVBBADP="" D ALL QUIT
"RTN","DVBHQD1",70,0)
 I 'Z9 Q
"RTN","DVBHQD1",71,0)
 ;
"RTN","DVBHQD1",72,0)
ALL I 'DVBXM,$D(DFN),+DFN K:C ^TMP("DVBHINQ",$J,DFN) S Z=0 F  S Z=$O(X(Z)) Q:'Z  S ^TMP("DVBHINQ",$J,DFN,Z)=X(Z)
"RTN","DVBHQD1",73,0)
 E  I DVBXM D RS,RECMAL^DVBHQD2,A^DVBHIQR,IALERT^DVBHT2,EN^DVBHIQM H 1 D WRT K DVBTX Q
"RTN","DVBHQD1",74,0)
 I DVBABORT=3!($D(DVBBADP)) S DFN=0
"RTN","DVBHQD1",75,0)
 Q
"RTN","DVBHQD1",76,0)
 ; do all if no error or retrying
"RTN","DVBHQD1",77,0)
ALLM I "BC"'[$E($E(X(1),5)_1) D ALL Q
"RTN","DVBHQD1",78,0)
 I CN,'TRY S TRY=1 D:DVBXM DCN Q
"RTN","DVBHQD1",79,0)
 I 'CN D ALL Q
"RTN","DVBHQD1",80,0)
 S X(1)=X(1)_"[TRY]1" D ALL Q
"RTN","DVBHQD1",81,0)
 ;
"RTN","DVBHQD1",82,0)
DCN S:$G(IO(0))="" IO(0)=$I U IO(0) W !,"..Name, SSN didn't work ....retrying using Claim Number",! U IO Q
"RTN","DVBHQD1",83,0)
 ;
"RTN","DVBHQD1",84,0)
RS Q:'$D(DFN)  Q:'DFN  Q:'$D(^DVB(395.5,DFN,0))  S DVBDFN=DFN,DVBCS=0
"RTN","DVBHQD1",85,0)
 F DVBSZ=0:0 S DVBSZ=$O(X(DVBSZ)) D SC^DVBHQST Q:'DVBSZ  D ST^DVBHQDB
"RTN","DVBHQD1",86,0)
 K DVBSZ,DVBDFN Q
"RTN","DVBHQD1",87,0)
 ;
"RTN","DVBHQD1",88,0)
TRIM Q:F1=999
"RTN","DVBHQD1",89,0)
 I '$D(F1) S F1=$F(X(Z9),DVBEND)
"RTN","DVBHQD1",90,0)
 I $E(X(Z9),F1-F4)=$C(10) S F1=F1-1
"RTN","DVBHQD1",91,0)
 S X(Z9)=$E(X(Z9),1,F1-F4)
"RTN","DVBHQD1",92,0)
 K F1 Q
"RTN","DVBHQD1",93,0)
 ;
"RTN","DVBHQD1",94,0)
WRT S:$G(IO(0))="" IO(0)=$I S DVBJIO=IO(0)
"RTN","DVBHQD1",95,0)
WRT1 S:$G(DVBJIO)="" DVBJIO=$I S:'$D(DVBIOSL) DVBIOSL=IOSL S:'$D(DVBIOST) DVBIOST=IOST S:'$D(DVBIOF) DVBIOF=IOF
"RTN","DVBHQD1",96,0)
 S X="" U DVBJIO W !!! D CODE^DVBHQUS W !! S Y0=$Y F Z=0:0 S Z=$O(^TMP($J,Z)) Q:'Z  I $D(^(Z,0)) W ^(0),! D:$Y-Y0>(DVBIOSL-4) SROLL^DVBHQD2 Q:X="^"  D:$Y<Y0 ABS^DVBHQD2
"RTN","DVBHQD1",97,0)
 Q:X="^"  K DVBJIO D SROLL^DVBHQD2 Q
"RTN","DVBHQD1",98,0)
 ;
"RTN","DVBHQD1",99,0)
CH S F1=0
"RTN","DVBHQD1",100,0)
 I X(W)=$C(10)_"NNNN" K X(W) S F1=999 Q
"RTN","DVBHQD1",101,0)
 I $L(X(W))>4!($L(X(W))<1) Q
"RTN","DVBHQD1",102,0)
 F A=$L(X(W)):-1:1 Q:$E(X(W),A)'="N"
"RTN","DVBHQD1",103,0)
 I A=1,$E(X(W),A)="N" S F1=$L(X(W-1))+1,F3=$L(X(W)),F4=5-$L(X(W)) K X(W)
"RTN","DVBHQD1",104,0)
 Q
"RTN","DVBHQD2")
0^1^B7105918
"RTN","DVBHQD2",1,0)
DVBHQD2 ;ALB/CMM - INDIVIDUAL HINQ ; 7/7/05 11:15am
"RTN","DVBHQD2",2,0)
 ;;4.0;HINQ;**22,33,34,43,49**;03/25/92 
"RTN","DVBHQD2",3,0)
 ;
"RTN","DVBHQD2",4,0)
KTO K TRY,CN,DVBZ0,DVBZ1 Q
"RTN","DVBHQD2",5,0)
 ;
"RTN","DVBHQD2",6,0)
DOT U IO(0) W "." U IO Q
"RTN","DVBHQD2",7,0)
 ;
"RTN","DVBHQD2",8,0)
ABS S Y0=255-Y0 Q:($Y+Y0)<(DVBIOSL-4)
"RTN","DVBHQD2",9,0)
 ;
"RTN","DVBHQD2",10,0)
SROLL Q:DVBIOST'["C-"!($D(DVBJDX))  U IO(0) W !,$C(7),"Press Enter to continue or '^' to quit" R X:DTIME S:'$T X="^" W @DVBIOF S Y0=$Y Q
"RTN","DVBHQD2",11,0)
 ;
"RTN","DVBHQD2",12,0)
REQENT U IO(0) W !,"Request being processed " U IO Q
"RTN","DVBHQD2",13,0)
 ;
"RTN","DVBHQD2",14,0)
RECMAL U IO(0) W !,"Response received and mailed" Q
"RTN","DVBHQD2",15,0)
 ;
"RTN","DVBHQD2",16,0)
LOAD2 ;
"RTN","DVBHQD2",17,0)
 U IO(0) W !!
"RTN","DVBHQD2",18,0)
 I $D(DVBRTC) W $S(DVBRTC>3:"Received 'Missing Character' more than 9 times.",1:"")
"RTN","DVBHQD2",19,0)
 W !,"Try again later."
"RTN","DVBHQD2",20,0)
 S IO=DVBIO U IO(0) K DVBP,DVBMISS S DVBABORT=0
"RTN","DVBHQD2",21,0)
 G ASK^DVBHQD1
"RTN","DVBHQD2",22,0)
 Q
"RTN","DVBHQD2",23,0)
LOAD ;
"RTN","DVBHQD2",24,0)
 U IO(0) W !!
"RTN","DVBHQD2",25,0)
 I $D(DVBRTC) W $S(DVBRTC>3:"Received 'Missing Character' more than 9 times.",1:"")
"RTN","DVBHQD2",26,0)
 U IO(0) W !," Request loaded into the HINQ Suspense file with a status of Pending."
"RTN","DVBHQD2",27,0)
 Q 
"RTN","DVBHQD2",28,0)
RETRY ;
"RTN","DVBHQD2",29,0)
 N ANS
"RTN","DVBHQD2",30,0)
 S DVBRTC=DVBRTC+1 I DVBRTC>3 S DVBNRT="N" Q
"RTN","DVBHQD2",31,0)
 U IO(0) R !!,"Received 'Missing Character' 3 times,",!,"Would you like to try again (Y/N)? Y//",ANS:DTIME
"RTN","DVBHQD2",32,0)
 I ('$T)!(ANS["^")!("N"=$E(ANS))!("n"=$E(ANS)) S DVBNRT="N" Q
"RTN","DVBHQD2",33,0)
 I ANS["?" W !!,"Enter Y to try again or N to Quit",!! G RETRY
"RTN","DVBHQD2",34,0)
 I (ANS="")!("Yy"[$E(ANS)) S DVBNRT="Y",DVBTRY=1 W !! Q
"RTN","DVBHQD2",35,0)
 G RETRY
"RTN","DVBHQD2",36,0)
 ;
"RTN","DVBHQD2",37,0)
SEND K X U IO F Z=1:1:1000 R *X:0 Q:'$T
"RTN","DVBHQD2",38,0)
 W $S('TRY:DVBZ0,1:DVBZ1),$C(13),! S DVBECHO=$P($H,",",2)
"RTN","DVBHQD2",39,0)
 ;
"RTN","DVBHQD2",40,0)
REC ;;;U IO R X:10 S DVBECHO=$P($H,",",2)-DVBECHO I 'DVBTSK D REQENT^DVBHQD2
"RTN","DVBHQD2",41,0)
 ;;;I '$L(X) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK "No response" H 1 Q
"RTN","DVBHQD2",42,0)
 ;
"RTN","DVBHQD2",43,0)
 S F4=5
"RTN","DVBHQD2",44,0)
 F Z=1:1:10 R X(1)#512:33 Q:$L(X(1))&(X(1)'=$C(10))  D:DVBXM DOT
"RTN","DVBHQD2",45,0)
 S F1=$F(X(1),DVBEND) G:F1 OK^DVBHQD1
"RTN","DVBHQD2",46,0)
 ;
"RTN","DVBHQD2",47,0)
 ;added with DVB*4*49 to make loops more robust and to add more 
"RTN","DVBHQD2",48,0)
 ;iterations of the loop if needed
"RTN","DVBHQD2",49,0)
 N DVBC,DVBCT
"RTN","DVBHQD2",50,0)
 S DVBCT=0
"RTN","DVBHQD2",51,0)
 F DVBC=2:1:30 D LOOP Q:DVBCT=1
"RTN","DVBHQD2",52,0)
 I DVBCT=0 S DVBABORT=DVBABORT+1
"RTN","DVBHQD2",53,0)
 Q
"RTN","DVBHQD2",54,0)
LOOP ;
"RTN","DVBHQD2",55,0)
 F Z=1:1:4 R X(DVBC)#512:5 Q:$L(X(DVBC))!DVBCT=1  D:DVBXM DOT
"RTN","DVBHQD2",56,0)
 S F1=$F(X(DVBC),DVBEND) I F1 S DVBCT=1 G OK^DVBHQD1
"RTN","DVBHQD2",57,0)
 S W=DVBC D CH^DVBHQD1 I F1 S DVBCT=1 G OK^DVBHQD1
"RTN","DVBHQD2",58,0)
 Q
"RTN","DVBHQDE")
0^30^B20242382
"RTN","DVBHQDE",1,0)
DVBHQDE ;ISC-ALBANY/PKE-generate HINQ direct ; 7/19/05 9:43pm
"RTN","DVBHQDE",2,0)
 ;;4.0;HINQ;**52,49**;03/25/92 
"RTN","DVBHQDE",3,0)
 G EN
"RTN","DVBHQDE",4,0)
RD R Y:DTIME IF  I Y'="^",Y'["?" S:Y'="" X1(N)=Y S:Y="@" X1(N)="" S:Y="SS"&(N>2) X1(N)=X1(2) Q
"RTN","DVBHQDE",5,0)
 S N=0 Q
"RTN","DVBHQDE",6,0)
 ;
"RTN","DVBHQDE",7,0)
EN ;D EN^DVBHQTM I $D(DVBSTOP) K DVBSTOP Q
"RTN","DVBHQDE",8,0)
 F Z=1:1:4 S X1(Z)=""
"RTN","DVBHQDE",9,0)
 S Y=-1 K Y(0)
"RTN","DVBHQDE",10,0)
NAM ;DVB*4*49 - name queries no longer accepted
"RTN","DVBHQDE",11,0)
 S X1(1)=""
"RTN","DVBHQDE",12,0)
 ;
"RTN","DVBHQDE",13,0)
 ;with DVB*4*49 only one number can be entered - first choice CN, 
"RTN","DVBHQDE",14,0)
 ;then SSN, then SN
"RTN","DVBHQDE",15,0)
TXT W !,"Enter one of the following numbers - Social Security Number, Claim Number",!,"or Service Number."
"RTN","DVBHQDE",16,0)
 W !
"RTN","DVBHQDE",17,0)
 D SS
"RTN","DVBHQDE",18,0)
 I Y?9N G EDIT
"RTN","DVBHQDE",19,0)
 I Y="^" Q
"RTN","DVBHQDE",20,0)
 D CNUM
"RTN","DVBHQDE",21,0)
 I Y?8.9N G EDIT
"RTN","DVBHQDE",22,0)
 I Y="^" Q
"RTN","DVBHQDE",23,0)
 D SNUM
"RTN","DVBHQDE",24,0)
 G EDIT
"RTN","DVBHQDE",25,0)
 Q
"RTN","DVBHQDE",26,0)
SS W !,"Social Security: ",X1(2)_$S($L(X1(2)):"// ",1:"") S N=2 D RD G SS:Y="@" I Y["?" S H=3 D HELP G SS
"RTN","DVBHQDE",27,0)
 Q:'N
"RTN","DVBHQDE",28,0)
 I X1(2)'="",X1(2)'?9N S X1(2)="" W $C(7) S H=4 D HELP S H=3 D HELP G SS G SS
"RTN","DVBHQDE",29,0)
 Q
"RTN","DVBHQDE",30,0)
 ;
"RTN","DVBHQDE",31,0)
CNUM W !,"Claim Number: ",X1(3)_$S($L(X1(3)):"// ",1:"") S N=3 D RD G CNUM:Y="@" I Y["?" S H=10 D HELP G CNUM
"RTN","DVBHQDE",32,0)
 Q:'N
"RTN","DVBHQDE",33,0)
 I X1(3)'="",(X1(3)'?1N.N!($L(X1(3))<1)!($L(X1(3))>9)) S X1(3)="" S H=6 D HELP S H=7 D HELP G CNUM
"RTN","DVBHQDE",34,0)
 Q
"RTN","DVBHQDE",35,0)
 ;
"RTN","DVBHQDE",36,0)
SNUM W !,"Service Number : ",X1(4)_$S($L(X1(4)):"// ",1:"") S N=4 D RD G SNUM:Y="@" S T=$L(X1(4)) I Y["?" S H=7 D HELP G SNUM
"RTN","DVBHQDE",37,0)
 Q:'N
"RTN","DVBHQDE",38,0)
 I X1(4)'="",(X1(4)'?1N.N!($L(X1(4))<4)!($L(X1(4))>9)) S X1(4)="" W $C(7) S H=8 D HELP S H=7 D HELP G SNUM
"RTN","DVBHQDE",39,0)
 Q
"RTN","DVBHQDE",40,0)
 ;
"RTN","DVBHQDE",41,0)
EDIT W !,?4," OK  " S %=1 D YN^DICN
"RTN","DVBHQDE",42,0)
 Q:%Y="^"  G:"Yy"[%Y CHK
"RTN","DVBHQDE",43,0)
 G:"Nn"[$E(%Y_1) NAM
"RTN","DVBHQDE",44,0)
 I %Y["?" W ?17 S H=9 D HELP G EDIT
"RTN","DVBHQDE",45,0)
 Q
"RTN","DVBHQDE",46,0)
 ;
"RTN","DVBHQDE",47,0)
CHK I X1(1)="",X1(2)="",X1(3)="",X1(4)="" Q
"RTN","DVBHQDE",48,0)
 S $P(Y(0),U,1)=X1(1)
"RTN","DVBHQDE",49,0)
 S $P(Y(0),U,9)=X1(2)
"RTN","DVBHQDE",50,0)
 S DVBCN=X1(3)
"RTN","DVBHQDE",51,0)
 S DVBSN=X1(4)
"RTN","DVBHQDE",52,0)
 ;
"RTN","DVBHQDE",53,0)
PASS X ^%ZOSF("EOFF") R !,"Enter HINQ PASSWORD: ",DVBP:DTIME X ^%ZOSF("EON") S:'$T DVBP="^" Q:'$T!("^."[DVBP)  S X=DVBP X ^DD("FUNC",13,1) S DVBP=X I DVBP'?4U W !,*7,"Please enter 4 characters, only letters." G PASS
"RTN","DVBHQDE",54,0)
 ;
"RTN","DVBHQDE",55,0)
BYPASS S DFN="XXXZ"
"RTN","DVBHQDE",56,0)
 N I,I1,I2,I3,I4,I5
"RTN","DVBHQDE",57,0)
 I '$D(Y(0)) S Y=-1 Q
"RTN","DVBHQDE",58,0)
 S DVBNAM=$P(Y(0),"^",1),I=$P(DVBNAM,","),I2=$P(DVBNAM,",",2)
"RTN","DVBHQDE",59,0)
 F J=$L(I):-1:0 Q:$E(I,J)?1A  S I=$E(I,1,J-1)
"RTN","DVBHQDE",60,0)
 F J=1:1 Q:$F(I," ")=0  S K=$F(I," "),I4=$E(I,K,99),I=$E(I,1,K-2)
"RTN","DVBHQDE",61,0)
 I $D(I4),$L(I4)<4 S I5=""
"RTN","DVBHQDE",62,0)
 E  I $D(I4),$L(I4)>3 I "SRJRIII"[$P(I4," ",2) S:"SRJRIII"'[$P(I4," ") I5=$P(I4," ") S I4=$P(I4," ",2)
"RTN","DVBHQDE",63,0)
 I $D(I4),I4=" " K I4
"RTN","DVBHQDE",64,0)
 I $D(I4) F J=$L(I4):-1:0 Q:$E(I4,J)'=" "  S I4=$E(I4,1,J-1)
"RTN","DVBHQDE",65,0)
 I '$D(I5),$D(I4) S I5=I4 K I4
"RTN","DVBHQDE",66,0)
 F J=0:0 Q:$E(I2)'=" "  S I2=$E(I2,2,99)
"RTN","DVBHQDE",67,0)
 F J=$L(I2):-1:0 Q:$E(I2,J)'=" "  S I2=$E(I2,1,J-1)
"RTN","DVBHQDE",68,0)
 I I2[" " S I3=$P(I2," ",2,99),I2=$P(I2," ") F J=0:0 Q:$E(I3)'=" "  S I3=$E(I3,2,99)
"RTN","DVBHQDE",69,0)
 I '$D(I4),$D(I3) S I4=$P(I3," ",2),I3=$P(I3," ",1)
"RTN","DVBHQDE",70,0)
 S DVBNAM=I_$S($D(I5):I5,1:"")_","_I2_$S($D(I3):","_I3,1:"")_$S($D(I4):","_I4,1:"")
"RTN","DVBHQDE",71,0)
 I DVBNAM["'" S DVBNAM=$P(DVBNAM,"'")_$P(DVBNAM,"'",2)
"RTN","DVBHQDE",72,0)
 I DVBNAM["." S DVBNAM=$P(DVBNAM,".")_$P(DVBNAM,".",2)
"RTN","DVBHQDE",73,0)
 I DVBNAM["(" S DVBNAM=$P(DVBNAM,"(")
"RTN","DVBHQDE",74,0)
 I DVBNAM?1"," S DVBNAM=""
"RTN","DVBHQDE",75,0)
 S:DVBNAM]"" DVBNAM="NM"_$E(DVBNAM,1,30)_"/"
"RTN","DVBHQDE",76,0)
 I $D(^DVB(395,1,0)) S DVBSTN=$P(^DVB(395,1,0),U,2) Q:'DVBSTN
"RTN","DVBHQDE",77,0)
 E  W !,*7,"Station number not defined in HINQ Parameters file." Q
"RTN","DVBHQDE",78,0)
ST ;;;CHANGED P TO E FOR TESTING NEW STRING
"RTN","DVBHQDE",79,0)
 S DVBZ="HINQ"_DVBSTN_" "_"E"_$S($P(Y(0),"^",9)]""&($P(Y(0),"^",9)'["P"):"SS"_$P(Y(0),"^",9),1:"")_DVBNAM
"RTN","DVBHQDE",80,0)
CN S I=DVBCN G SN:I="" F J=1:1 Q:$L(I)'<8  S I=0_I
"RTN","DVBHQDE",81,0)
 S:$L(I)=8 I=" "_I S DVBZ=DVBZ_"CN"_I
"RTN","DVBHQDE",82,0)
SN S I=DVBSN G VDI:I="" F J=1:1 Q:$L(I)'<8  S I=0_I
"RTN","DVBHQDE",83,0)
 S:$L(I)=8 I=" "_I S DVBZ=DVBZ_"SN"_I
"RTN","DVBHQDE",84,0)
 ;
"RTN","DVBHQDE",85,0)
VDI S DVBZ=DVBZ_DVBNUM_DVBP,DVBZ=$E(DVBZ,1,9)_"              "_$E(DVBZ,10,999)
"RTN","DVBHQDE",86,0)
 ;
"RTN","DVBHQDE",87,0)
 S Y=0 K %Y,I,I1,I2,I3,I4,I5,DVBNAM,DVBSTN,DVBTGT,Y(0) QUIT
"RTN","DVBHQDE",88,0)
 ;
"RTN","DVBHQDE",89,0)
HELP W "  ",$P($T(HELP+H),";;",2) K H Q
"RTN","DVBHQDE",90,0)
 ;;Enter last name,first name  up to 30 characters
"RTN","DVBHQDE",91,0)
 ;;At the last prompt ' OK ? YES// ' you may enter No to edit
"RTN","DVBHQDE",92,0)
 ;;Enter 9 digits only
"RTN","DVBHQDE",93,0)
 ;;Bad SSN
"RTN","DVBHQDE",94,0)
 ;;Enter 1-9 digits or SS for Social Security
"RTN","DVBHQDE",95,0)
 ;;Bad Claim #
"RTN","DVBHQDE",96,0)
 ;;Enter 4-9 digits or SS for Social Security
"RTN","DVBHQDE",97,0)
 ;;Bad Service #
"RTN","DVBHQDE",98,0)
 ;;Enter No to edit data   Return to continue
"RTN","DVBHQDE",99,0)
 ;;Identifying Number must be 1 - 9 digits
"RTN","DVBHQDL")
0^2^B25179847
"RTN","DVBHQDL",1,0)
DVBHQDL ;ISC-ALBANY/PKE-HINQ IDCU,RDPC LOGON ; 10/27/05 4:12pm
"RTN","DVBHQDL",2,0)
 ;;4.0;HINQ;**9,12,32,33,34,38,49**;03/25/92
"RTN","DVBHQDL",3,0)
 S X="A" X ^%ZOSF("LPC") K X S U="^" I $D(IO)<11 S IOP="HOME" D ^%ZIS K IOP S:'$D(DTIME) DTIME=300
"RTN","DVBHQDL",4,0)
 I $D(DUZ)#2'=1 W !,"DUZ not defined",! Q
"RTN","DVBHQDL",5,0)
 I $D(^VA(200,DUZ,.1)) S DVBNUM=$P(^(.1),U,9) I DVBNUM
"RTN","DVBHQDL",6,0)
 E  W !,"  HINQ Employee Number not in New Person file",!,"  Notify System manager",! Q
"RTN","DVBHQDL",7,0)
 ;
"RTN","DVBHQDL",8,0)
EN W !,"This option will take 30 seconds to activate - using IP Addressing"
"RTN","DVBHQDL",9,0)
 U IO(0) W !!,"Do you wish to continue" S %=1 D YN^DICN
"RTN","DVBHQDL",10,0)
 I %'>0 G:%<0 EX1 W !,"    Enter YES to select option" G EN
"RTN","DVBHQDL",11,0)
 I %>1 G EX1
"RTN","DVBHQDL",12,0)
 S DVBTSK=0
"RTN","DVBHQDL",13,0)
 S DVBIOSL=IOSL,DVBIOST=IOST,DVBIOF=IOF
"RTN","DVBHQDL",14,0)
ENTSK ;entry from taskman
"RTN","DVBHQDL",15,0)
 D SILENT^DVBHQTM I $D(DVBSTOP) S DVBABORT=1 K DVBSTOP D:'DVBTSK MESS G EX
"RTN","DVBHQDL",16,0)
 S DVBIDCU=^DVB(395,1,"HQVD")_"^"_$P(^("HQ"),"^",11)
"RTN","DVBHQDL",17,0)
 S DVBLOG=$P(DVBIDCU,U),DVBPU=$P(DVBIDCU,U,2),DVBID=$P(DVBPU,"-"),DVBPW=$P(DVBPU,"-",2)
"RTN","DVBHQDL",18,0)
 I DVBLOG'?3U1"."4U W:'DVBTSK !,"IDCU ADDRESS not correct in HINQ Parameter file #395" H 3 S DVBABORT=1 G END
"RTN","DVBHQDL",19,0)
 I $P(DVBIDCU,"^",6) S DVBLOG="VHA"_$P(DVBLOG,"DMS",2)
"RTN","DVBHQDL",20,0)
 I 'DVBTSK U IO(0) W !!,"Connecting to VBA database"
"RTN","DVBHQDL",21,0)
 ;
"RTN","DVBHQDL",22,0)
 ;Set up the error trap for cache
"RTN","DVBHQDL",23,0)
 I 'DVBTSK,$$NEWERR^%ZTER N $ETRAP,$ESTACK S $ETRAP="D ERR^DVBHQDL"
"RTN","DVBHQDL",24,0)
 I 'DVBTSK,'$$NEWERR^%ZTER S X="ERR^DVBHQDL",@^%ZOSF("TRAP")
"RTN","DVBHQDL",25,0)
 ;
"RTN","DVBHQDL",26,0)
 S DVBIP=$P($G(^DVB(395,1,"HQIP")),"^",1)
"RTN","DVBHQDL",27,0)
 I DVBIP,DVBIP?1.3N1P1.3N1P1.3N1P1.3N
"RTN","DVBHQDL",28,0)
 E  W:'DVBTSK !?3,"RDPC IP Address not defined or invalid in DVB parameter file #395" H 3 G EX1
"RTN","DVBHQDL",29,0)
 ;
"RTN","DVBHQDL",30,0)
 S DVBSTN=$P(^DVB(395,1,0),U,2)
"RTN","DVBHQDL",31,0)
 ;
"RTN","DVBHQDL",32,0)
 ;with patch DVB*4*49 new routing and interface engines have been
"RTN","DVBHQDL",33,0)
 ;established for the HINQ process.  It was decided that multiple
"RTN","DVBHQDL",34,0)
 ;ports would be added to handle the volume of HINQs.  Three ports
"RTN","DVBHQDL",35,0)
 ;be used exclusively for the HEC, six for the VAMCs.  A new field
"RTN","DVBHQDL",36,0)
 ;(#23 - AAC PORT DESIGNATOR) has been added to act as a counter for
"RTN","DVBHQDL",37,0)
 ;the HINQ connections that have been requested. #3 or #6 + this field
"RTN","DVBHQDL",38,0)
 ;yeilds a code that is then interpreted into a port number depending
"RTN","DVBHQDL",39,0)
 ;on the station number.
"RTN","DVBHQDL",40,0)
 S DVBPORT=$$PORT(DVBSTN)
"RTN","DVBHQDL",41,0)
 ;
"RTN","DVBHQDL",42,0)
 D CALL^%ZISTCP(DVBIP,DVBPORT,"33")
"RTN","DVBHQDL",43,0)
 I POP G BUSY
"RTN","DVBHQDL",44,0)
 S X=0
"RTN","DVBHQDL",45,0)
 U IO X ^%ZOSF("EOFF"),^%ZOSF("TYPE-AHEAD"),^%ZOSF("RM") H 3
"RTN","DVBHQDL",46,0)
 S C=0 ;leave this off of next line
"RTN","DVBHQDL",47,0)
NAM ;
"RTN","DVBHQDL",48,0)
HEL ;
"RTN","DVBHQDL",49,0)
 N DVBFLG,DVBHEL,DVBQUIT
"RTN","DVBHQDL",50,0)
 I DVBTSK D
"RTN","DVBHQDL",51,0)
 . K X U IO F Z=1:1:50 R X(Z):3 D  Q:$G(DVBQUIT)=1
"RTN","DVBHQDL",52,0)
 . . I X(Z)["**HELLO**" K X S DVBABORT=0,DVBQUIT=1 Q
"RTN","DVBHQDL",53,0)
 . . I '$L(X(Z)) Q
"RTN","DVBHQDL",54,0)
 . . I $G(DVBFLG)>0 D HELLO2(Z)
"RTN","DVBHQDL",55,0)
 . . I $G(DVBHEL)["**HELLO**" K X S DVBABORT=0,DVBQUIT=1 Q
"RTN","DVBHQDL",56,0)
 . . S DVBFLG=0
"RTN","DVBHQDL",57,0)
 . . I X(Z)["**H" D HELLO(Z)
"RTN","DVBHQDL",58,0)
 . . I $E(X(Z),$L(X(Z)))="*" D HELLO(Z)
"RTN","DVBHQDL",59,0)
 . I Z'<50 S DVBVBA="NO"
"RTN","DVBHQDL",60,0)
 I 'DVBTSK D
"RTN","DVBHQDL",61,0)
 . U IO(0) W !!,"One moment, please...",!! U IO
"RTN","DVBHQDL",62,0)
 . K X F Z2=1:1:50 U IO R X(Z2):3 U IO(0) W "." D  Q:$G(DVBQUIT)=1
"RTN","DVBHQDL",63,0)
 . . I X(Z2)["**HELLO**" D CONT S DVBQUIT=1 Q
"RTN","DVBHQDL",64,0)
 . . I '$L(X(Z2)) Q
"RTN","DVBHQDL",65,0)
 . . I $G(DVBFLG)>0 D HELLO2(Z2)
"RTN","DVBHQDL",66,0)
 . . I $G(DVBHEL)["**HELLO**" D CONT S DVBQUIT=1 Q
"RTN","DVBHQDL",67,0)
 . . S DVBFLG=0
"RTN","DVBHQDL",68,0)
 . . I X(Z2)["**H" D HELLO(Z2)
"RTN","DVBHQDL",69,0)
 . . I $E(X(Z2),$L(X(Z2)))="*" D HELLO(Z2)
"RTN","DVBHQDL",70,0)
 . I Z2'<50 U IO(0) W !,"HINQ not allowed at this time" D MESS U IO
"RTN","DVBHQDL",71,0)
END ;
"RTN","DVBHQDL",72,0)
 I DVBTSK Q
"RTN","DVBHQDL",73,0)
 I DVBLOG["VHA" U IO W "$%$DIS",$C(13),!
"RTN","DVBHQDL",74,0)
 I DVBLOG'["VHA" U IO W "$$$BYEF",$C(13)
"RTN","DVBHQDL",75,0)
 U IO(0) W !!,"Terminating VBA session...",! U IO
"RTN","DVBHQDL",76,0)
 U IO F Z=1:1:6 R X(Z):1 Q:'$T  I X(Z)["0900 BYE" U IO(0) W !,"VBA DISCONNECTED",! Q  ;U IO Q
"RTN","DVBHQDL",77,0)
 ;I '$D(DVBIO) Q
"RTN","DVBHQDL",78,0)
 ;
"RTN","DVBHQDL",79,0)
EX I DVBTSK S DVBABORT=1 Q
"RTN","DVBHQDL",80,0)
EX1 K %,DVBNUM,DVBTSK,DVBLOG,DVBDEV,DVBVDI,DVBABORT,X,Y,Z,C,G,DVBIP,DVBIOSL,DVBIOST,DVBIOF
"RTN","DVBHQDL",81,0)
 D CLOSE^%ZISTCP Q
"RTN","DVBHQDL",82,0)
 Q
"RTN","DVBHQDL",83,0)
XXX I 'DVBTSK U IO(0) W !,X U IO
"RTN","DVBHQDL",84,0)
RESET S C=C+1 I C>2 G END
"RTN","DVBHQDL",85,0)
 H 5 G NAM
"RTN","DVBHQDL",86,0)
 ;
"RTN","DVBHQDL",87,0)
BUSY I 'DVBTSK W !," ",IO,"   Device is busy" D SUS H 1 G EX
"RTN","DVBHQDL",88,0)
YYY I 'DVBTSK U IO(0) W !,"Bad Network User ID/Password notify Site Manager " H 1 G EX
"RTN","DVBHQDL",89,0)
 Q
"RTN","DVBHQDL",90,0)
SUS I 'DVBTSK U IO(0) W !,"Enter requests in the Suspense file" Q
"RTN","DVBHQDL",91,0)
 Q
"RTN","DVBHQDL",92,0)
ERR ;Come here on error, screen with error screens 
"RTN","DVBHQDL",93,0)
 S DVBHERR=$$EC^%ZOSV
"RTN","DVBHQDL",94,0)
 I DVBHERR["READ"!(DVBHERR["ENDOFFIL") DO
"RTN","DVBHQDL",95,0)
 . U IO(0) W !,"Disconnect trapped..."
"RTN","DVBHQDL",96,0)
 D ^%ZTER
"RTN","DVBHQDL",97,0)
 D CLOSE^%ZISTCP
"RTN","DVBHQDL",98,0)
 G UNWIND^%ZTER
"RTN","DVBHQDL",99,0)
 Q
"RTN","DVBHQDL",100,0)
MESS ;DVB*38 HINQ UNAVAILABLE MESSAGE  MLR 5.10.01
"RTN","DVBHQDL",101,0)
 I $G(DVBTSK)>0 Q
"RTN","DVBHQDL",102,0)
 U IO(0)
"RTN","DVBHQDL",103,0)
 W !!
"RTN","DVBHQDL",104,0)
 W $$CJ^XLFSTR("ATTENTION:  HINQ IS CURRENTLY UNAVAILABLE!",80,".")
"RTN","DVBHQDL",105,0)
 W !!,$$CJ^XLFSTR("Please enter HINQ request in Suspense File",80)
"RTN","DVBHQDL",106,0)
 W !,$$CJ^XLFSTR("or try again later.",80)
"RTN","DVBHQDL",107,0)
 W !!
"RTN","DVBHQDL",108,0)
 Q  ;MESS
"RTN","DVBHQDL",109,0)
 ;
"RTN","DVBHQDL",110,0)
CONT ;display messages and continue with HINQ
"RTN","DVBHQDL",111,0)
 U IO(0) W !!,"You may continue with your HINQ request...",!!
"RTN","DVBHQDL",112,0)
 U IO S DVBIO=IO D ^DVBHQD1 U IO(0) W ! S IO=DVBIO
"RTN","DVBHQDL",113,0)
 Q
"RTN","DVBHQDL",114,0)
 ;
"RTN","DVBHQDL",115,0)
HELLO(IND) ;if **HELLO** string was broken up, save it to a var to combine
"RTN","DVBHQDL",116,0)
 ;with next read
"RTN","DVBHQDL",117,0)
 ;input parameter indicates whether called from task or direct
"RTN","DVBHQDL",118,0)
 S DVBFLG=1
"RTN","DVBHQDL",119,0)
 I X(IND)["**H" S DVBHEL="**H"_$P(X(IND),"**H",2) Q
"RTN","DVBHQDL",120,0)
 I $E(X(IND),$L(X(IND))-1)="*" S DVBHEL="**" Q
"RTN","DVBHQDL",121,0)
 S DVBHEL="*"
"RTN","DVBHQDL",122,0)
 Q
"RTN","DVBHQDL",123,0)
HELLO2(IND) ;add string from next read to string in HELLO
"RTN","DVBHQDL",124,0)
 I $G(DVBHEL)["" S DVBHEL=DVBHEL_$E(X(IND),1,9-$L(DVBHEL))
"RTN","DVBHQDL",125,0)
 Q
"RTN","DVBHQDL",126,0)
 ;
"RTN","DVBHQDL",127,0)
PORT(DVBSTN) ;
"RTN","DVBHQDL",128,0)
 K DVBERR
"RTN","DVBHQDL",129,0)
 S DVBPORT=50010
"RTN","DVBHQDL",130,0)
 S DVBPT=$$GET1^DIQ(395,"1,",23,,,"DVBERR")
"RTN","DVBHQDL",131,0)
 I $D(DVBERR) D  Q DVBPORT
"RTN","DVBHQDL",132,0)
 . S DVBFDA(395,"1,",23)=0
"RTN","DVBHQDL",133,0)
 . D FILE^DIE(,"DVBFDA","DVBERR")
"RTN","DVBHQDL",134,0)
 S DVBFDA(395,"1,",23)=DVBPT+1
"RTN","DVBHQDL",135,0)
 D FILE^DIE("E","DVBFDA","DVBERR")
"RTN","DVBHQDL",136,0)
 I $G(DVBSTN)=742 D
"RTN","DVBHQDL",137,0)
 . ;station 742 is the HEC - these 3 ports are reserved for the HEC
"RTN","DVBHQDL",138,0)
 . S DVBPORT=$G(DVBPT)#3 ;50000 - 50002
"RTN","DVBHQDL",139,0)
 . S DVBPORT=50000+DVBPORT
"RTN","DVBHQDL",140,0)
 I $G(DVBSTN)'=742 D
"RTN","DVBHQDL",141,0)
 . ;these 6 ports are for the use of VAMCs
"RTN","DVBHQDL",142,0)
 . S DVBPORT=$G(DVBPT)#6
"RTN","DVBHQDL",143,0)
 . S DVBPORT=50010+DVBPORT ;50010 - 50015
"RTN","DVBHQDL",144,0)
 Q DVBPORT
"RTN","DVBHQDX")
0^3^B10801689
"RTN","DVBHQDX",1,0)
DVBHQDX ;ISC-ALBANY/PKE-HINQ IDCU,VBA diagnostic ;8/17/87  08:50
"RTN","DVBHQDX",2,0)
 ;;4.0;HINQ;**9,12,33,34,49**;03/25/92 
"RTN","DVBHQDX",3,0)
EN S X="A" X ^%ZOSF("LPC") K X S U="^",DVBTSK=0 S:'$D(DTIME) DTIME=300 I $D(IO)<11 S IOP="HOME" D ^%ZIS K IOP
"RTN","DVBHQDX",4,0)
 S:'$D(DVBSTN) DVBSTN=$P(^DVB(395,1,0),U,2) I 'DVBSTN W !!,"Station number not defined in HINQ Parameters file. " D EX1 Q
"RTN","DVBHQDX",5,0)
 S DVBDXX=""
"RTN","DVBHQDX",6,0)
 S DVBZ="HINQ"_DVBSTN_" "_"E00000000000000SS12345678NMTEST,HINQ/ABCD1234"
"RTN","DVBHQDX",7,0)
 W !,"This test will take 30 seconds.  No input is required or allowed.",!,"Responses are from the Frame Relay Network, or remote VBA computer."
"RTN","DVBHQDX",8,0)
 W !,"Success in this test will return a message to the user"
"RTN","DVBHQDX",9,0)
AGN U IO(0) W !!,"Do you wish to continue" S %=1 D YN^DICN
"RTN","DVBHQDX",10,0)
 I %Y["?" G AGN
"RTN","DVBHQDX",11,0)
 I %'=1 D EX1 Q
"RTN","DVBHQDX",12,0)
 W !!
"RTN","DVBHQDX",13,0)
 S DVBIDCU=^DVB(395,1,"HQVD")_"^"_$P(^("HQ"),"^",11)
"RTN","DVBHQDX",14,0)
 S DVBLOG=$P(DVBIDCU,U),(DVBDEV,ION)=$P(DVBIDCU,U,4),DVBPU=$P(DVBIDCU,U,2),DVBID=$P(DVBPU,"-"),DVBPW=$P(DVBPU,"-",2)
"RTN","DVBHQDX",15,0)
 I DVBLOG'?3U1"."4U W !,"IDCU ADDRESS not correct in HINQ Parameter file #395" H 2 G END
"RTN","DVBHQDX",16,0)
 ;I '$L(DVBDEV) W !!,"DEVICE NAME not defined in HINQ DEVICE NAME of DVB #395" H 2 G END
"RTN","DVBHQDX",17,0)
 ;I '$L(DVBID) W !,"HINQ IDCU User ID not defined in IDCU USERNAME-PASSWORD parameter." H 2 G END
"RTN","DVBHQDX",18,0)
 ;I '$L(DVBPW) W !,"HINQ IDCU Password not defined in IDCU USERNAME-PASSWORD parameter." H 2 G END
"RTN","DVBHQDX",19,0)
 I $P(DVBIDCU,"^",6) S DVBLOG="VHA"_$P(DVBLOG,"DMS",2)
"RTN","DVBHQDX",20,0)
 ;U IO(0) W !,"HINQ device defined as ",DVBDEV,!!
"RTN","DVBHQDX",21,0)
 ;with DVB*4*49 there will be only one server - message will be 
"RTN","DVBHQDX",22,0)
 ;"Connecting to VBA"
"RTN","DVBHQDX",23,0)
 U IO(0) W !,"Connecting to VBA"
"RTN","DVBHQDX",24,0)
 ;
"RTN","DVBHQDX",25,0)
 S DVBIP=$P($G(^DVB(395,1,"HQIP")),"^")
"RTN","DVBHQDX",26,0)
 I DVBIP,DVBIP?1.3N1P1.3N1P1.3N1P1.3N
"RTN","DVBHQDX",27,0)
 E  W:'DVBTSK !?3,"RDPC IP Address not defined or invalid in DVB parameter file #395" H 3 G EX
"RTN","DVBHQDX",28,0)
 ;
"RTN","DVBHQDX",29,0)
 D CALL^%ZISTCP(DVBIP,"6000","33")
"RTN","DVBHQDX",30,0)
 I POP G BUSY
"RTN","DVBHQDX",31,0)
 ; 
"RTN","DVBHQDX",32,0)
 S X=0 U IO X ^%ZOSF("EOFF"),^%ZOSF("TYPE-AHEAD"),^%ZOSF("RM") H 1 ;;;F Z=0:0 R *X:1 Q:'$T  U IO(0) W $C(X) U IO
"RTN","DVBHQDX",33,0)
 S C=0
"RTN","DVBHQDX",34,0)
NAM ;;;U IO W $C(13)
"RTN","DVBHQDX",35,0)
 ;
"RTN","DVBHQDX",36,0)
HEL F Z2=1:1:50 U IO R X(Z2):1 U IO(0) W "." U IO H 1 I X(Z2)["**HELLO**" S DVBXM=1,DVBTSK=0,DVBABORT=0 U IO S DVBIO=IO,DVBJDX=1 D MES^DVBHQD1 S IO=DVBIO Q
"RTN","DVBHQDX",37,0)
 I DVBLOG'["VHA" U IO W "$$$BYEF",$C(13) D DISP G EX
"RTN","DVBHQDX",38,0)
 I DVBLOG["VHA" U IO W "$%$DIS",$C(13),! D DISP G EX
"RTN","DVBHQDX",39,0)
 D DISP
"RTN","DVBHQDX",40,0)
END F Z=1:1:30 I $D(X(Z)),X(Z)["???" U IO I DVBLOG'["VHA" W "BYEF",$C(13) Q
"RTN","DVBHQDX",41,0)
 F Z=1:1:30 I $D(X(Z)),X(Z)["$%$" U IO I DVBLOG["VHA" W "DIS",$C(13) Q
"RTN","DVBHQDX",42,0)
 ;
"RTN","DVBHQDX",43,0)
EX ;U IO F Z=1:1 R *X:4 Q:'$T  U IO(0) W $C(X) U IO
"RTN","DVBHQDX",44,0)
EX1 K R,DVBJDX,%Y,%,I,K,Y0,Z2,DVBDXX,DVBLEN,D,DVBIO,X,Z,H,DVBSTN,DVBABORT
"RTN","DVBHQDX",45,0)
 K DVBLOG,DVBDEV,DVBECHO,DVBEND,DVBTMX,DVBTSK,DVBTX,DVBXM,DVBZ,Y,C,G
"RTN","DVBHQDX",46,0)
 K DVBID,DVBIDCU,DVBPU,DVBPW,^TMP($J),DVBIP
"RTN","DVBHQDX",47,0)
 D CLOSE^%ZISTCP
"RTN","DVBHQDX",48,0)
 Q
"RTN","DVBHQDX",49,0)
XXX U IO(0) W:$D(X(Z)) !,X(Z) U IO
"RTN","DVBHQDX",50,0)
 S C=C+1 I C>2 G END
"RTN","DVBHQDX",51,0)
 H 5 G NAM
"RTN","DVBHQDX",52,0)
BUSY U IO(0) W !," ",IO,"   Device is busy" H 1 K DVBLOG,DVBDEV,DVBSTN,DVBDXX,DVBTSK,DVBZ Q
"RTN","DVBHQDX",53,0)
YYY U IO(0) W !,"Bad Network Password notify Site Manager" D EX Q
"RTN","DVBHQDX",54,0)
DISP U IO(0) F G=1:1:Z2 I $D(X(G)) D TRIM W:$L(X(G)) !,X(G) I X(G)["0900 BYE" Q
"RTN","DVBHQDX",55,0)
 U IO Q
"RTN","DVBHQDX",56,0)
TRIM F H=0:0 Q:$E(X(G))'=$C(10)  S X(G)=$E(X(G),2,999)
"RTN","DVBHQDX",57,0)
 F I=$L(X(G)),-1,1 Q:$E(X(G),I)'=$C(10)  S X(G)=$E(X(G),1,I-1)
"RTN","DVBHQDX",58,0)
 Q
"RTN","DVBHQEDT")
0^25^B21705515
"RTN","DVBHQEDT",1,0)
DVBHQEDT ;ALB/JLU -THIS ROUTINE CHECKS THE ONE MANY ALL INPUT FOR HINQ SCREENS. ;3/19/90
"RTN","DVBHQEDT",2,0)
 ;;4.0;HINQ;**6,49**;03/25/92 
"RTN","DVBHQEDT",3,0)
A ;ENTRY POINT FROM TEMPLATE DVBHINQEDT
"RTN","DVBHQEDT",4,0)
 S ERROR=0,Z="" K Z2,Z3
"RTN","DVBHQEDT",5,0)
 I "Aa"[ANS D L3 Q
"RTN","DVBHQEDT",6,0)
 I ANS'?.NP S ERROR=1 D ERR Q
"RTN","DVBHQEDT",7,0)
 I +ANS>$E(DVBJS,2) S ERROR=1 D ERR Q
"RTN","DVBHQEDT",8,0)
 I (ANS?1N)!(ANS?1N1",") S Z=$P(ANS,",")_"^" D EX Q
"RTN","DVBHQEDT",9,0)
 I ANS?1N1"-"1N D L0,EX:'ERROR,ERR:ERROR Q
"RTN","DVBHQEDT",10,0)
 F Z0=1:2:$L(ANS) S Z1=$E(ANS,Z0,Z0),Z2=$E(ANS,Z0+1,Z0+1) D L1 Q:ERROR!(Z2="")
"RTN","DVBHQEDT",11,0)
 I 'ERROR F Z4=0:0 S Z4=$O(Z3(Z4)) Q:'Z4  S Z=Z_Z4_"^"
"RTN","DVBHQEDT",12,0)
 I ANS=0 F Z1=1:1:$E(DVBJS,2) S Z=Z_Z1_"^" W Z
"RTN","DVBHQEDT",13,0)
 D ERR:ERROR Q
"RTN","DVBHQEDT",14,0)
EX I $E(Z,$L(Z)-1,$L(Z)-1)>$E(DVBJS,2) W !,"Number too large for selectable numbers." S ERROR=1 D ERR Q
"RTN","DVBHQEDT",15,0)
 Q
"RTN","DVBHQEDT",16,0)
ERR W !!,*7,?9,"Check boundaries and/or syntax and try again.",!,?9,"Use '?' if still having problems OK!!   <RET>" R DVBZ:DTIME K DVBZ Q
"RTN","DVBHQEDT",17,0)
 ;
"RTN","DVBHQEDT",18,0)
L0 I $P(ANS,"-",2)>$P(ANS,"-") F Z1=$P(ANS,"-"):1:$P(ANS,"-",2) S Z=Z_Z1_"^"
"RTN","DVBHQEDT",19,0)
 E  S ERROR=1 Q
"RTN","DVBHQEDT",20,0)
 D ERR:ERROR K Z1 Q
"RTN","DVBHQEDT",21,0)
L1 I Z1'?1N,Z0=1 S ERROR=1 Q
"RTN","DVBHQEDT",22,0)
 I (Z1?1N),((Z2=",")!(Z2="")) S Z3(Z1)="" Q
"RTN","DVBHQEDT",23,0)
 I Z1?1N,Z2="-" D L2 Q
"RTN","DVBHQEDT",24,0)
 Q
"RTN","DVBHQEDT",25,0)
L2 I Z1>$E(ANS,Z0+2,Z0+2) S ERROR=1 Q
"RTN","DVBHQEDT",26,0)
 I $E(ANS,Z0+3,Z0+3)'=",",($E(ANS,Z0+3,Z0+3)'="") S ERROR=1 Q
"RTN","DVBHQEDT",27,0)
 F Z4=Z1:1:$E(ANS,Z0+2,Z0+2) S Z3(Z4)=""
"RTN","DVBHQEDT",28,0)
 S Z0=Z0+2
"RTN","DVBHQEDT",29,0)
 Q
"RTN","DVBHQEDT",30,0)
L3 F Z1=1:1:$E(DVBJS,2) S Z=Z_Z1_"^"
"RTN","DVBHQEDT",31,0)
 Q
"RTN","DVBHQEDT",32,0)
 ;
"RTN","DVBHQEDT",33,0)
B ;THIS IS THE ENTRY POINT FOR THE HELP SCREEN IN THE HINQ UPLOAD.
"RTN","DVBHQEDT",34,0)
 W @$S('$D(IOF):"#",IOF="":"#",1:IOF)
"RTN","DVBHQEDT",35,0)
 W !,?25,DVBON,"HINQ Help Screen",DVBOFF
"RTN","DVBHQEDT",36,0)
 W !!,?5,DVBON,"<RET>",DVBOFF,"  press return to continue on to the next display screen.",!!,?6,DVBON,"'^'",DVBOFF,"   use the up arrow to get out of the upload mode."
"RTN","DVBHQEDT",37,0)
 W !!,?14,"To upload you have a choice of ONE, MANY, or ALL."
"RTN","DVBHQEDT",38,0)
 W !!,?27,DVBON,"N",DVBOFF,"     for a single selection.",!,?27,DVBON,"N,N,N",DVBOFF," for specific fields.",!,?27,DVBON,"N-N",DVBOFF,"   for a range of fields."
"RTN","DVBHQEDT",39,0)
 W !,?27,DVBON,"A",DVBOFF,"     for the entire screen."
"RTN","DVBHQEDT",40,0)
 W !!,?8,"Except for the first screen which is the verification screen,"
"RTN","DVBHQEDT",41,0)
 W !,?8,"highlighted numbers in ",DVBON,"[]",DVBOFF," can be uploaded where as highlighted"
"RTN","DVBHQEDT",42,0)
 W !,?8,"numbers in ",DVBON,"<>",DVBOFF," can not."
"RTN","DVBHQEDT",43,0)
 W !!,?8,"Screen jumping is also allowed to some extent.  You are able"
"RTN","DVBHQEDT",44,0)
 W !,?8,"to jump from any one of the three screens except from 3 to any"
"RTN","DVBHQEDT",45,0)
 W !,?8,"of the others.  1->2  1->3    2->1  2->3  but not 3->N"
"RTN","DVBHQEDT",46,0)
 W !,?8,"The correct format is ^N (Ex. to go from 2 to 1   ^1)"
"RTN","DVBHQEDT",47,0)
 W !!,?20,"<Press return to continue.>"
"RTN","DVBHQEDT",48,0)
 Q
"RTN","DVBHQEDT",49,0)
KA1 K JU,J,JZ,K1,K2,L,L1,X,XX,Y,Z,DFN,DGEDCN,DI,DVBJ2,DVBOFF,DVBON,DVBOUT,I,D0,DVBJA,DVB8,DVB9,ERROR,Y1,DVBY,DVBJ1,ZTSK,DVBLIT,DVBENT,DVBLP,DVBMM,DVBUQ,DVBLIT1,DVBLIT2,DVBS,DVBBLF,DVBBLO,DVBDIQ,DVBX,DVBSCRN
"RTN","DVBHQEDT",50,0)
 K DVBI,DVBUSER,N,O,R,R1,Y0,ANS
"RTN","DVBHQEDT",51,0)
KA K DVBERR,DVBERR1,DVBIXMZ,DVBNETER,DVBOTM,DVBOXMZ,DVBREQST,DVBREQUE,DVBV,DVBAAHB,DVBADR,DVBADRLN,DVBASVC,DVBBOS,DVBCHDOB,DVBCHECK,DVBCHILD,DVBCHNO,DVBCI,DVBCN,DVBCPS,DVBCSVC,DVBDOB,DVBDX,DVBDXNO,DVBDXPCT,DVBDXSC,DVBDXX,DVBENT
"RTN","DVBHQEDT",52,0)
 K DVBEI,DVBEINC,DVBEOD,DVBFIDUC,DVBFL,DVBINC,DVBEOD,DVBLEN,DVBNAME,DVBOINC,DVBP,DVBPOW,DVBPTI,DVBRAD,DVBRETO,DVBRETT,DVBRTYP,DVBRTYPE,DVBSPDOB,DVBSPENC,DVBSPETO,DVBSPINC,DVBSPNAM,DVBSPRET,DVBSPSSA,DVBSSA,DVBZIP,DVBSN
"RTN","DVBHQEDT",53,0)
 K DVBPOA,DVBPAT,DVBCAP,DVBBOSRC,DVBCSVC,DVBCSVCN,DVBEODN,DVBNMREC,DVBPNAM,DVBPOWD,DVBRADN,DVBSNREC,DVBSSN,DVBTOTAS,DXS,DVBJS,JL,JU,DIC,DIE,DR,DVB,DVB1,ZTRTN,ZTDESC,ZTIO,POP,DIR,ZTSAVE,DVBJC,JP,Z1,Z2,DVB4,DVB5,DVB6,DVB7,DVBOH
"RTN","DVBHQEDT",54,0)
 K DIQ,DIQ2,DVBADD,DVBBAS,DVBBIR,DVBCHI,DVBDBE,DVBSSAJ,DVBDBF,DVBDIA,DVBFUE,DVBFUF,DVBMM2,DVBMON,DVBREF,DVBV1,DVBV2,DVBVET,DVBWIT,LP,LX,LY,LP1,LP2,DVBSEX
"RTN","DVBHQEDT",55,0)
 Q
"RTN","DVBHQEDT",56,0)
DX ;left to ensure no error
"RTN","DVBHQEDT",57,0)
 Q
"RTN","DVBHQM1")
0^4^B34394004
"RTN","DVBHQM1",1,0)
DVBHQM1 ;ISC-ALBANY/PKE/JLU-create mail message ; 8/27/05 4:18pm
"RTN","DVBHQM1",2,0)
 ;;4.0;HINQ;**49**;03/25/92 
"RTN","DVBHQM1",3,0)
 G EN
"RTN","DVBHQM1",4,0)
LIN Q:CT>200  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM1",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") S:$L(Y)=10 Y=Y_" " Q
"RTN","DVBHQM1",6,0)
 ;
"RTN","DVBHQM1",7,0)
EN S DVBCTN=CT+1
"RTN","DVBHQM1",8,0)
 I $D(DVBNAME),DVBNAME'?7" " S T1="    VBA name = "_DVBNAME D LIN
"RTN","DVBHQM1",9,0)
 I $D(DVBPNAM) S T1=" Prior names =" D LIN S T1="" F I=0:0 S I=$O(DVBPNAM(I)) Q:I=""  D
"RTN","DVBHQM1",10,0)
 . S T1="       "_DVBPNAM(I)
"RTN","DVBHQM1",11,0)
 . D LIN
"RTN","DVBHQM1",12,0)
 ;I $D(DVBPNAM) D LIN
"RTN","DVBHQM1",13,0)
 I $D(DVBADRLN),+DVBADRLN F G=1:1:$S(DVBADRLN<7:DVBADRLN,1:0) I $D(DVBADR(G)) S CT=CT+1,A1=A_CT_",0)",@A1="     "_$S(G=1:"   Name",1:"Address")_" = "_DVBADR(G)
"RTN","DVBHQM1",14,0)
 I $D(DVBZIP),DVBZIP'?9" " S T1="         ZIP = "_DVBZIP D LIN
"RTN","DVBHQM1",15,0)
2 ;
"RTN","DVBHQM1",16,0)
 I $D(DVBVET),$P(DVBVET,U,1)'="C" S T1="          Sex = "_$S($P(DVBVET,U,3)="M":"MALE",$P(DVBVET,U,3)="F":"FEMALE",1:"")_$E(BL,1,29)_$S($P(DVBVET,U,2)=" ":"",1:"BLIND Ind.") D LIN I 1
"RTN","DVBHQM1",17,0)
 E  I $D(DVBBIR) S T1="          Sex = "_$S($P(DVBBIR,U,25)="M":"MALE",$P(DVBBIR,U,25)="F":"FEMALE",1:"") D LIN
"RTN","DVBHQM1",18,0)
 ;
"RTN","DVBHQM1",19,0)
 I $D(DVBDOB),DVBDOB?8N S M=$E(DVBDOB,1,2) D MM^DVBHQM11 S T1="Date of Birth = "_M_" "_$S(+$E(DVBDOB,3,4)>0:$E(DVBDOB,3,4)_", ",1:" ")_$E(DVBDOB,5,8) D LIN
"RTN","DVBHQM1",20,0)
 I $D(DVBP(6)),$P(DVBP(6),U) S M=$E(DVBP(6),1,2) D MM^DVBHQM11 S T1="Date of Death = "_M_" "_$S(+$E(DVBP(6),3,4)>0:$E(DVBP(6),3,4)_", ",1:" ")_$E(DVBP(6),5,8) D LIN
"RTN","DVBHQM1",21,0)
 ;;;I $D(DVBP(6)),$P(DVBP(6),U) S Y=$P(DVBP(6),U) D DD S T1="Date of Death = "_Y D LIN
"RTN","DVBHQM1",22,0)
P6 I $P($G(DVBREF),U)'?9N I $D(DVBSSN),+DVBSSN S T1="    VBA SSN = "_DVBSSN D VSS,LIN
"RTN","DVBHQM1",23,0)
P61 D P4^DVBHQM11
"RTN","DVBHQM1",24,0)
 ;
"RTN","DVBHQM1",25,0)
 D BLOCK^DVBHQM12
"RTN","DVBHQM1",26,0)
 ;
"RTN","DVBHQM1",27,0)
10 ;if DVBCSVC(2) is populated, kill DVBCSVC(1) - DVB*4*49
"RTN","DVBHQM1",28,0)
 I $G(DVBCSVC(2))]"" K DVBCSVC(1)
"RTN","DVBHQM1",29,0)
 I $D(DVBCSVC) S T1=" Char of Svc: " F I=0:0 S I=$O(DVBCSVC(I)) D:I="" LIN Q:I=""  S Y=DVBCSVC(I) D DISCHG:I=1 S:I>1 Y=$$DISCH2(DVBCSVC(I)) S T1=T1_Y
"RTN","DVBHQM1",30,0)
 ;
"RTN","DVBHQM1",31,0)
 ;Additional Service is no longer being sent, DVB*4*49
"RTN","DVBHQM1",32,0)
 ;
"RTN","DVBHQM1",33,0)
 D P1^DVBHQM11,P5^DVBHQM11,P3^DVBHQM11
"RTN","DVBHQM1",34,0)
 ;
"RTN","DVBHQM1",35,0)
11 K DVBNMREC,DVBBOSRC,DVBCSVCN,DVBEODN,DVBRADN,DVBSNREC,DVBPNAM,DVBSN,DVBCSVC,DVBPOA,DVBRAD,DVBEOD,DVBPOWD,DVBTOTAS,DVBASVC,DVBNM,DVBNSVC,DVBPOW,DVBSN,DVBBOS,DVBCN,DVBDOB,DVBADRLN,DVBZIP,DVBNAM,DVBADR,DVBSSN
"RTN","DVBHQM1",36,0)
 ;
"RTN","DVBHQM1",37,0)
 ;I $D(DVBDXPCT) S T1="    Combined % Disability = "_+DVBDXPCT D LIN
"RTN","DVBHQM1",38,0)
 ;I $D(DVBDXNO),+DVBDXNO S T1="         Disabilities = "_DVBDXNO D LIN
"RTN","DVBHQM1",39,0)
 ;I $D(DVBDXX) S T1="  Additional Disabilities = "_DVBDXX D LIN
"RTN","DVBHQM1",40,0)
 ;
"RTN","DVBHQM1",41,0)
 S T1="DISABILITIES" D LIN
"RTN","DVBHQM1",42,0)
 S T1="Combined %="_$S($D(DVBDXPCT):+DVBDXPCT,1:"  ")_"     "
"RTN","DVBHQM1",43,0)
 S T1=T1_"Disab. in Record="_$S($D(DVBDXNO):DVBDXNO,1:"   ")
"RTN","DVBHQM1",44,0)
 I $G(DVBEFF)]"",DVBEFF'="        " S M=$E(DVBEFF,1,2) D MM^DVBHQM11 S DVBEFF=M_" "_$E(DVBEFF,3,4)_","_$E(DVBEFF,5,8)
"RTN","DVBHQM1",45,0)
 S T1=T1_"     Eff. Date of Comb. Eval.="_$G(DVBEFF)
"RTN","DVBHQM1",46,0)
 D LIN S T1="" D LIN
"RTN","DVBHQM1",47,0)
 I $D(DVBDX)>9 D
"RTN","DVBHQM1",48,0)
 . S T1="                                                     "
"RTN","DVBHQM1",49,0)
 . S T1=T1_"       Orig       Curr" D LIN
"RTN","DVBHQM1",50,0)
 . S T1="     SC Disability                       "
"RTN","DVBHQM1",51,0)
 . S T1=T1_"         %  Extr   Eff Dt     Eff Dt"
"RTN","DVBHQM1",52,0)
 . D LIN
"RTN","DVBHQM1",53,0)
 ;
"RTN","DVBHQM1",54,0)
DX I $D(DVBDX)>9 F I=0:0 S I=$O(DVBDX(I)) Q:'I!(I>DVBDXNO)  S Y=DVBDX(I) D DX1 I +Y S T1=Y D LIN
"RTN","DVBHQM1",55,0)
 ;
"RTN","DVBHQM1",56,0)
BBIRLS I $G(DVBDXVER)="N" D ERR
"RTN","DVBHQM1",57,0)
 S T1=" " D LIN
"RTN","DVBHQM1",58,0)
 K DVBFL,DVBDXX,DVBDXNO,DVBDX,DVBDXPCT
"RTN","DVBHQM1",59,0)
 G EN^DVBHQM2
"RTN","DVBHQM1",60,0)
 ;
"RTN","DVBHQM1",61,0)
SVC ;
"RTN","DVBHQM1",62,0)
 ;
"RTN","DVBHQM1",63,0)
DISCHG S DVBV1=Y,Y=$S(Y=1:"HONORABLE ",Y=2:"OTHER THAN HONORABLE ",Y=3:"DISHONORABLE ",Y=4:"HON VA PUR. ",Y=5:"DISHON VA PUR. ",Y=0!(Y=" "):"UNVERIFIED  ",1:"            ")
"RTN","DVBHQM1",64,0)
 Q
"RTN","DVBHQM1",65,0)
DISCH2(DVBD) ;this will handle codes from Corporate
"RTN","DVBHQM1",66,0)
 ;DVBD is the code for character of discharge
"RTN","DVBHQM1",67,0)
 N DVBDD
"RTN","DVBHQM1",68,0)
 S DVBD=$$UP^XLFSTR(DVBD)
"RTN","DVBHQM1",69,0)
 S DVBDD=$S(DVBD="HON":"Honorable",DVBD="BAD":"Bad Conduct",DVBD="DIS":"Dishonorable",DVBD="DVA":"Dis for VA Pur",DVBD="GEN":"General",DVBD="HVA":"Hon for VA Pur",DVBD="OTH":"Other than Hon",1:"")
"RTN","DVBHQM1",70,0)
 I $G(DVBDD)="" S DVBDD=$S(DVBD="UNC":"Unchar",DVBD="UEL":"Unchar-Entry Lev",DVBD="UHC":"Under Hon Cond",DVBD="UNK":"Unknown",DVBD="UNS":"Unsuitable",DVBD="UNV":"Unverified",1:DVBD)
"RTN","DVBHQM1",71,0)
 S DVBD="                     "
"RTN","DVBHQM1",72,0)
 S DVBD=DVBDD_$E(DVBD,$L(DVBDD)+1,22) ;longest str=21 chars, pad w/1 char
"RTN","DVBHQM1",73,0)
 Q DVBD
"RTN","DVBHQM1",74,0)
 ;
"RTN","DVBHQM1",75,0)
ASVC S Z=$S(Z=0:"None",Z=1:"Wartime and/or Peacetime",Z=2:"Peacetime",Z=3:"Less than 90 days wartime, has SC disability",Z=4:"18-29 months continuous service (CH34)",Z=" ":"Not an issue",1:Z) Q
"RTN","DVBHQM1",76,0)
 ;
"RTN","DVBHQM1",77,0)
DX1 I '+Y!(Y["-") S Y=0 Q
"RTN","DVBHQM1",78,0)
 ;I '+$P(Y,U,2) S DVBDX(I)=+Y_" - "_$E(BL,1,32)
"RTN","DVBHQM1",79,0)
 I '+$P(Y,U,2) S DVBDX(I)=+Y_" - Code not in local file-see ADPAC"
"RTN","DVBHQM1",80,0)
 E  S DVBDX(I)=+Y_"-"_$E($P(^DIC(31,$P(Y,U,2),0),U),1,43)_$E(BL,1,43-$L($P(^(0),U)))
"RTN","DVBHQM1",81,0)
 N DVBCURR,DVBORIG
"RTN","DVBHQM1",82,0)
 S DVBORIG=$S($P(Y,U,5)]"":$P(Y,U,5),1:"")
"RTN","DVBHQM1",83,0)
 S DVBCURR=$S($P(Y,U,6)]"":$P(Y,U,6),1:"")
"RTN","DVBHQM1",84,0)
 I $G(DVBORIG)'="        ",$G(DVBORIG)]"" S M=$E(DVBORIG,1,2) D MM^DVBHQM11 S DVBORIG=M_" "_$E(DVBORIG,3,4)_","_$E(DVBORIG,5,8)
"RTN","DVBHQM1",85,0)
 I $G(DVBCURR)'="        ",$G(DVBCURR)]"" S M=$E(DVBCURR,1,2) D MM^DVBHQM11 S DVBCURR=M_" "_$E(DVBCURR,3,4)_","_$E(DVBCURR,5,8)
"RTN","DVBHQM1",86,0)
 S DVBDX(I)=DVBDX(I)_"-"_$S($P(Y,U,3)'["X":$P(Y,U,3),$P(Y,U,3)="X0":"100",1:"..")_"%-"_$S($P(Y,U,4)]"":$P(Y,U,4),1:"  ")_"-"
"RTN","DVBHQM1",87,0)
 S DVBDX(I)=DVBDX(I)_$S($G(DVBORIG)]"":DVBORIG,1:$E(BL,1,11))_"-"_$G(DVBCURR)
"RTN","DVBHQM1",88,0)
 S Y=DVBDX(I)
"RTN","DVBHQM1",89,0)
 Q
"RTN","DVBHQM1",90,0)
 ;
"RTN","DVBHQM1",91,0)
VSS I $D(DVBP(6)) S C=$P(DVBP(6),U,3) I C S T1=T1_$S(C=1:" Verified SSA",C=2:" Verified VBA",C=4:" Verified by BIRLS",C=9:" SSA Verified No Number Exists",C=0:" Un verified",C=3:" Not Required, Child Under 2",1:" "_C) K C
"RTN","DVBHQM1",92,0)
 Q
"RTN","DVBHQM1",93,0)
 ;
"RTN","DVBHQM1",94,0)
ERR ;These are the error messages for the BIRLS only equivalent record
"RTN","DVBHQM1",95,0)
 ;which is possibly not verified (DVB*4*49) 
"RTN","DVBHQM1",96,0)
 ;
"RTN","DVBHQM1",97,0)
 S T1=" " D LIN
"RTN","DVBHQM1",98,0)
 S T1="             Diagnostic Verified Indicator is NO." D LIN
"RTN","DVBHQM1",99,0)
 S T1="      Verify Service Connections "_$S($D(DVBFL):"at "_DVBFL,1:"with VBA") D LIN
"RTN","DVBHQM1",100,0)
 S T1=" " D LIN
"RTN","DVBHQM1",101,0)
 Q
"RTN","DVBHQM11")
0^5^B14847772
"RTN","DVBHQM11",1,0)
DVBHQM11 ;ISC-ALBANY/JLU/PKE-create mail message ;10/27/87  10:50
"RTN","DVBHQM11",2,0)
 ;;4.0;HINQ;**7,20,49**;03/25/92
"RTN","DVBHQM11",3,0)
 ;
"RTN","DVBHQM11",4,0)
LIN Q:CT>100  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM11",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") S:$L(Y)=10 Y=Y_" " Q
"RTN","DVBHQM11",6,0)
 ;
"RTN","DVBHQM11",7,0)
MM S M=$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",M) Q
"RTN","DVBHQM11",8,0)
 ;
"RTN","DVBHQM11",9,0)
P1 Q:'$D(DVBP(1))
"RTN","DVBHQM11",10,0)
 S T1=$P(DVBP(1),U,4)
"RTN","DVBHQM11",11,0)
 I T1'="" D
"RTN","DVBHQM11",12,0)
 . ;VBA is no longer sending entitlement code, but AAC is computing a
"RTN","DVBHQM11",13,0)
 . ;type of benefit code from the information sent. DVB*4*49  
"RTN","DVBHQM11",14,0)
 . S T1="Type Benefit: "_$S($P(DVBP(1),U,4)="01":"Compensation",$P(DVBP(1),U,4)="0L":"Pension",1:" ")
"RTN","DVBHQM11",15,0)
 . D LIN
"RTN","DVBHQM11",16,0)
 ;VBA will be sending all records as Type "A" records, so Record Type
"RTN","DVBHQM11",17,0)
 ;will no longer display
"RTN","DVBHQM11",18,0)
 Q
"RTN","DVBHQM11",19,0)
 ;
"RTN","DVBHQM11",20,0)
P2 Q:'$D(DVBP(2))
"RTN","DVBHQM11",21,0)
 S T1=" " D LIN S T1=$P(DVBP(2),U) I T1'="  " S Z=$O(^DVB(395.2,"B",T1,"")) I Z S S="   Anatomical loss = ",ST=$P(^DVB(395.2,Z,0),U,2)_" - "_T1 D WRAP
"RTN","DVBHQM11",22,0)
 S T1=$P(DVBP(2),U,3) I T1'="  " S Z=$O(^DVB(395.2,"B",T1,"")) I Z S T1="       Loss of use = "_$P(^DVB(395.2,Z,0),U,2)_" - "_T1 D LIN
"RTN","DVBHQM11",23,0)
 S T1=$P(DVBP(2),U,4) I T1'=" " D OLC^DVBHQM13 I Z'="" S T1="        Other loss = "_Z_" - "_T1 D LIN
"RTN","DVBHQM11",24,0)
 S T1=$P(DVBP(2),U,5) D VMV^DVBHQM13 I Z'="" S S="   Vet married Vet = ",ST=Z D WRAP
"RTN","DVBHQM11",25,0)
 ;Special Monthly Comp. will no longer be sent by VBA - DVB*4*49
"RTN","DVBHQM11",26,0)
 ;Special Provision will no longer be sent by VBA - DVB*4*49
"RTN","DVBHQM11",27,0)
 Q
"RTN","DVBHQM11",28,0)
 ;
"RTN","DVBHQM11",29,0)
P3 Q  ;P3 concerns future data - after DVB*4*49 there will be none
"RTN","DVBHQM11",30,0)
 Q:'$D(DVBP(3))
"RTN","DVBHQM11",31,0)
 I $P(DVBP(3),U,3)="RR" S T1="Future data present - contact RO !!" D LIN Q
"RTN","DVBHQM11",32,0)
 I $P(DVBFUE,U,22) S T1="Amount PFOP Deduction = "_"$"_$E($P(DVBFUE,U,22),1,4)_"."_$E($P(DVBFUE,U,22),5,6) D LIN Q
"RTN","DVBHQM11",33,0)
 I $P(DVBP(3),U)="A" D T4 F XX=1:1:T4 S T3=$P(DVBP(3),U,XX+2) I T3?7N1E S M=$E(T3,5,6) D MM,T5,EMP,HD S ST="  "_M_", "_$E(T3,1,4)_"  "_$S(Z:$P(^DVB(395.4,Z,0),U,2),1:"")_" - "_DVBV1,S=" " D WRAP
"RTN","DVBHQM11",34,0)
 D EMP Q
"RTN","DVBHQM11",35,0)
 ;
"RTN","DVBHQM11",36,0)
P4 Q:'$D(DVBREF)
"RTN","DVBHQM11",37,0)
 I $P(DVBREF,U,3)?9N S T1="Cross Reference number = "_$P(DVBREF,U,3) D LIN
"RTN","DVBHQM11",38,0)
 I $P(DVBREF,U)?9N S T1="     VBA SSN = "_$P(DVBREF,U) D VSS,LIN
"RTN","DVBHQM11",39,0)
 S T1=" " D LIN
"RTN","DVBHQM11",40,0)
 Q
"RTN","DVBHQM11",41,0)
 ;
"RTN","DVBHQM11",42,0)
P5 Q:'$D(DVBP(5))  S T1=$P(DVBP(5),U) I T1 S T1="PFOP Balance : "_" $"_+$E(T1,1,6)_"."_$E(T1,7,8) D LIN Q
"RTN","DVBHQM11",43,0)
 ;
"RTN","DVBHQM11",44,0)
 Q
"RTN","DVBHQM11",45,0)
EMP S T1=" " D LIN Q
"RTN","DVBHQM11",46,0)
 ;
"RTN","DVBHQM11",47,0)
HD S T1="Diary data:" D LIN Q
"RTN","DVBHQM11",48,0)
T4 S T4=$P(DVBP(3),U,2) Q
"RTN","DVBHQM11",49,0)
 ;
"RTN","DVBHQM11",50,0)
T5 S DVBV1=$E(T3,7,8)
"RTN","DVBHQM11",51,0)
 I DVBV1?1N1A!(DVBV1["{") S DVBV2=2 D SIGN^DVBHUTIL
"RTN","DVBHQM11",52,0)
 S Z=$O(^DVB(395.4,"B",DVBV1,""))
"RTN","DVBHQM11",53,0)
 Q
"RTN","DVBHQM11",54,0)
 ;
"RTN","DVBHQM11",55,0)
WRAP S B=$L(S),GL=$P((($L(ST)+B/78)+.9),"."),SP=1,V=78-B,$P(T," ",B+1)=""
"RTN","DVBHQM11",56,0)
 F LP=1:1:GL S Z=$E(ST,V*LP) D:Z=" "!(Z="") SET D:Z'=" "&(Z'="") PAR
"RTN","DVBHQM11",57,0)
 K GL,LP,LP1,Z,Z1,EP,SP,ST,B,V,T,S Q
"RTN","DVBHQM11",58,0)
SET S T1=$E(ST,SP,V*LP) S:SP=1 T1=S_T1 S:SP'=1 T1=T_T1 S SP=V*LP+1 D LIN Q
"RTN","DVBHQM11",59,0)
PAR F LP1=1:1 S EP=(V*LP)-LP1,Z1=$E(ST,EP) Q:Z1=" "
"RTN","DVBHQM11",60,0)
 S T1=$E(ST,SP,EP) S:SP=1 T1=S_T1 S:SP'=1 T1=T_T1 S SP=EP+1 D LIN Q
"RTN","DVBHQM11",61,0)
 ;
"RTN","DVBHQM11",62,0)
VSS I $D(DVBP(1)) S C=$P(DVBP(1),U,8) I C]"" S T1=T1_$S(C=1:" Verified SSA",C=2:" Verified VBA",C=4:" Verified by BIRLS",C=9:" SSA Verified No Number Exists",C=0:" Unverified",C=3:" Not Required, Child Under 2",1:" "_C) K C
"RTN","DVBHQM11",63,0)
 Q
"RTN","DVBHQM12")
0^6^B29859559
"RTN","DVBHQM12",1,0)
DVBHQM12 ;ISC-ALBANY/PKE/JLU-create mail message ;9/28/88@0800
"RTN","DVBHQM12",2,0)
 ;;4.0;HINQ;**4,49**;03/25/92 
"RTN","DVBHQM12",3,0)
 ;
"RTN","DVBHQM12",4,0)
LIN Q:CT>100  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM12",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") S:$L(Y)=10 Y=Y_" " Q
"RTN","DVBHQM12",6,0)
 ;
"RTN","DVBHQM12",7,0)
BLOCK I $D(DVBCN) S T1="      Claim Number = "_DVBCN D LIN
"RTN","DVBHQM12",8,0)
B I $D(DVBSN) S T1="    Service Number = " F I=2:1 Q:'$D(DVBSN(I))  S T1=T1_DVBSN(I)_"  "
"RTN","DVBHQM12",9,0)
 I $D(DVBSN) D LIN
"RTN","DVBHQM12",10,0)
 I $D(DVBFL) S T1="   Folder Location = "_DVBFL D LIN
"RTN","DVBHQM12",11,0)
 I $D(DVBBIR),$P(DVBBIR,U,18) S T1=$P(DVBBIR,U,18) D CHR S T1="C.H.Record Location = "_$S(Y:Y,1:T1) D LIN
"RTN","DVBHQM12",12,0)
 I $D(DVBPOA) S T1=" Power of Attorney = "_$G(DVBPOA) D LIN
"RTN","DVBHQM12",13,0)
 S T1=1
"RTN","DVBHQM12",14,0)
 I $D(DVBPOW) S T1=$E(BL,1,9)_"      POW = "_$S(DVBPOW=0:"No period of rec.",DVBPOW=1:"30 days or fewer",DVBPOW=2:"more than 30 days",DVBPOW=" ":"Not applicable",1:DVBPOW)
"RTN","DVBHQM12",15,0)
 I $D(DVBPOWD) S T1=$S('+T1:T1_"  "_DVBPOWD,1:"POW  "_DVBPOWD)
"RTN","DVBHQM12",16,0)
 I 'T1 D LIN K T1
"RTN","DVBHQM12",17,0)
 I $D(DVBTOTAS) S T1="  Total Active Svc = "_DVBTOTAS D LIN
"RTN","DVBHQM12",18,0)
 ;
"RTN","DVBHQM12",19,0)
 ;DVB*4*49 - Disability Indicator no longer being sent
"RTN","DVBHQM12",20,0)
 I $D(DVBBIR) S T1="INDICATORS( Active Duty Training "_$S($P(DVBBIR,U,24)["Y":"YES",1:"NO ")
"RTN","DVBHQM12",21,0)
 S T1=T1_"   Homeless Veteran "_$S($P(DVBBIR,U,30)["Y":"YES",$P(DVBBIR,U,30)="H":"YES",1:"NO ")_")" D LIN
"RTN","DVBHQM12",22,0)
 ;
"RTN","DVBHQM12",23,0)
 S T1="" D LIN
"RTN","DVBHQM12",24,0)
 S T1=" Service data - VBA" D LIN
"RTN","DVBHQM12",25,0)
 S T1="--------------------------------------------------------------" D LIN
"RTN","DVBHQM12",26,0)
 ;
"RTN","DVBHQM12",27,0)
 ;DVB*4*49 - all military service data should be in the BIRLS portion of
"RTN","DVBHQM12",28,0)
 ;the response message, since that is where up to three episodes of
"RTN","DVBHQM12",29,0)
 ;service can be stored, and the statistical segment information
"RTN","DVBHQM12",30,0)
 ;would just duplicate the BIRLs segment info, due to there being no
"RTN","DVBHQM12",31,0)
 ;indication of which database is being used.  So, if there is data
"RTN","DVBHQM12",32,0)
 ;in DVBBOS(2), DVBEOD(2), or DVBRAD(2), kill the 1st node of these arrs.
"RTN","DVBHQM12",33,0)
 I $G(DVBBOS(2))]"" K DVBBOS(1)
"RTN","DVBHQM12",34,0)
 I +$G(DVBEOD(2))>0 K DVBEOD(1)
"RTN","DVBHQM12",35,0)
 I +$G(DVBRAD(2))>0 K DVBRAD(1)
"RTN","DVBHQM12",36,0)
 ;
"RTN","DVBHQM12",37,0)
 I $D(DVBBOS) D BOS F I=2:1 Q:'$D(DVBBOS(I))  S Y=DVBBOS(I) D XBOS S T1=T1_Y
"RTN","DVBHQM12",38,0)
 I $D(DVBBOS) D LIN
"RTN","DVBHQM12",39,0)
 ;
"RTN","DVBHQM12",40,0)
 I $D(DVBEOD) S T1="         EOD: " F I=0:0 S I=$O(DVBEOD(I)) D:I="" LIN Q:I=""  D CEOD S T1=T1_Y_"          "
"RTN","DVBHQM12",41,0)
 I $D(DVBRAD) S T1="         RAD: " F I=0:0 S I=$O(DVBRAD(I)) D:I="" LIN Q:I=""  D CRAD S T1=T1_Y_"          "
"RTN","DVBHQM12",42,0)
 S T1="" D LIN
"RTN","DVBHQM12",43,0)
 ;
"RTN","DVBHQM12",44,0)
 Q
"RTN","DVBHQM12",45,0)
 ;
"RTN","DVBHQM12",46,0)
BOS S T1="  Svc Branch: " I $D(DVBBOS(1)) S Y=DVBBOS(1) D XBOS S T1=T1_Y
"RTN","DVBHQM12",47,0)
 Q
"RTN","DVBHQM12",48,0)
XBOS ;DVB*4*49 - BOS codes have changed
"RTN","DVBHQM12",49,0)
 N DVBY
"RTN","DVBHQM12",50,0)
 Q:Y']""
"RTN","DVBHQM12",51,0)
 S Y=$TR(Y," ")
"RTN","DVBHQM12",52,0)
 S Y=$$UPPER^VALM1(Y)
"RTN","DVBHQM12",53,0)
 N YY
"RTN","DVBHQM12",54,0)
 S YY=Y
"RTN","DVBHQM12",55,0)
 S Y=$S(Y="ARMY":"Army",Y="NAVY":"Navy",Y="AF":"Air Force",Y="AFA":"Air Force Acad",Y="AFC":"Air Force Civilian",Y="AFR":"Air Force Res",Y="ANG":"Air Nat Guard",Y="AAC":"Army Air Corps/Army Air Force",1:Y)
"RTN","DVBHQM12",56,0)
 I YY=Y S Y=$S(Y="AACV":"Amer. Airlines Civilian",Y="ANC":"Army Nurse Corps",Y="ANCF":"ANC Fem Civ-Bataan/Correg.",Y="AFS":"Civilians AFS/WWII Overseas",Y="ARNG":"Army Nat Guard",1:Y)
"RTN","DVBHQM12",57,0)
 I YY=Y S Y=$S(Y="CG":"Coast Guard",Y="CGA":"CG Acad",Y="CGR":"CG Res",Y="CGS":"Coast & Geodetic Survey",Y="CPDW":"Civilians PNAB Wake/WWII",Y="ESSA":"Envir Science Svcs Admin",Y="GCS":"Guer Combination Svc",1:Y)
"RTN","DVBHQM12",58,0)
 I YY=Y S Y=$S(Y="HDAV":"Hon Disch Members Amer Vol Guard",Y="MC":"Marine Corps",Y="MCR":"MC Res",Y="MM":"Merchant Marine",1:Y)
"RTN","DVBHQM12",59,0)
 I YY=Y S Y=$S(Y="NA":"Naval Acad",Y="NNC":"Navy Nurse Corps",Y="NOAA":"Nat Ocean & Atmospher Admin",Y="NR":"Navy Res",Y="O":"Other",Y="OTH":"Other",Y="OSSC":"Civ OSS Secret Intel",1:Y)
"RTN","DVBHQM12",60,0)
 I YY=Y S Y=$S(Y="PACC":"Pan Am Civ contract Overseas WWII",Y="POUS":"Phil Army ordered US Arm Forces",Y="PCA":"Phillip Comn Army",Y="PG":"Phillip Guerilla",Y="PGCS":"Phil Guer & Comb Svc",1:Y)
"RTN","DVBHQM12",61,0)
 I YY=Y S Y=$S(Y="PRS":"Phillip Reg Scout & Comb Svc",Y="PHS":"Public Health Scv",Y="QC":"Quartermaster Corps Keswick/Correg/WWII",1:Y)
"RTN","DVBHQM12",62,0)
 I YY=Y S Y=$S(Y="RPS":"Reg Phillip Scout",Y="SPS":"Spec Phillip Scout",Y="USAR":"US Army Res",Y="USCV":"US Civ Vol Act Defense Bataan",1:Y)
"RTN","DVBHQM12",63,0)
 S Y=$S(Y="USMA":"US Mil Acad",Y="USMS":"US Merch Seamen Blockship Op Mulberry",Y="WASP":"Womens AF Svc Pilots",Y="WAAC":"Womens Army Aux Corps",Y="WAC":"Womens Army Corps",Y="WRM":"Womens Res of Marines",1:Y)
"RTN","DVBHQM12",64,0)
 S DVBY="                     " ;sized to match widest char service value
"RTN","DVBHQM12",65,0)
 S Y=Y_$E(DVBY,$L(Y)+1,22)
"RTN","DVBHQM12",66,0)
 Q
"RTN","DVBHQM12",67,0)
 ;
"RTN","DVBHQM12",68,0)
CEOD I I=1 S M=$E(DVBEOD(1),1,2) D MM^DVBHQM11 S Y=M_" "_$E(DVBEOD(1),3,4)_","_$E(DVBEOD(1),5,8) Q
"RTN","DVBHQM12",69,0)
 I DVBEOD(I)?7N S Y=DVBEOD(I) D DD
"RTN","DVBHQM12",70,0)
 E  S Y=""
"RTN","DVBHQM12",71,0)
 Q
"RTN","DVBHQM12",72,0)
 ;
"RTN","DVBHQM12",73,0)
CRAD I I=1 S M=$E(DVBRAD(1),1,2) D MM^DVBHQM11 S Y=M_" "_$E(DVBRAD(1),3,4)_","_$E(DVBRAD(1),5,8) Q
"RTN","DVBHQM12",74,0)
 I DVBRAD(I)?7N S Y=DVBRAD(I) D DD
"RTN","DVBHQM12",75,0)
 E  S Y=""
"RTN","DVBHQM12",76,0)
 Q
"RTN","DVBHQM12",77,0)
CHR S Y=0,Y=$O(^DIC(4,"D",+$P(DVBBIR,U,18),Y)) I Y S Y=$S($D(^DIC(4,Y,0)):$P(^DIC(4,Y,99),U,1)_" - "_$P(^(0),U),1:"")
"RTN","DVBHQM12",78,0)
 Q
"RTN","DVBHQM13")
0^27^B9419232
"RTN","DVBHQM13",1,0)
DVBHQM13 ;ISC-ALBANY/JLU ; This routine is general for space saving ;10/6/88@08:00
"RTN","DVBHQM13",2,0)
 ;;4.0;HINQ;**49**;03/25/92 
"RTN","DVBHQM13",3,0)
 ;
"RTN","DVBHQM13",4,0)
MRT S Z=$S(T="A":"Veterans Master Record",T="B":"Death Payee",T="C":"Apportioned Payee-Live",T="D":"Accounts Receivable or Deposit Fund",1:"")
"RTN","DVBHQM13",5,0)
 I Z="" S Z=$S(T="E":"Terminated Pending Purge",T="F":"Apportioned Payee-death",T="G":"PFOP Recurring Payment",T="N":"Notice of Death Record",1:"")
"RTN","DVBHQM13",6,0)
 Q
"RTN","DVBHQM13",7,0)
OLC S Z=$S(T1=0:"No losses in this group",T1=1:"Loss or loss of use of creative organ.",T1=2:"Loss or loss of use of both buttocks.",T1=3:"Loss of buttocks & loss of creative organ",1:"")
"RTN","DVBHQM13",8,0)
 I Z="" S Z=$S(T1=4:"Regular aid and attendance or permanently bedridden",T1=5:"Loss of creative organ & Regular A&A or bedridden",T1=6:"Loss of buttocks,creative organ Regular A&A,bedridden",1:"")
"RTN","DVBHQM13",9,0)
 I Z="" S Z=$S(T1=7:"Loss creative organ,buttocks Regular A&A,bedridden",1:"")
"RTN","DVBHQM13",10,0)
 Q
"RTN","DVBHQM13",11,0)
VMV S Z=$S(T1=" "!(T1=0):"No spouse or not eligible",T1=1:"Spouse WWI, MBP, included in award.",T1=2:"Spouse veteran, not of WWI or MBP, included in award.",T1="Y":"Yes",1:"")
"RTN","DVBHQM13",12,0)
 I Z="" S Z=$S(T1=3:"Spouse veteran WWI or MBP, paid separately. Another file number.",T1=4:"Spouse not veteran WWI or MBP, paid separately. Another file number.",1:"")
"RTN","DVBHQM13",13,0)
 Q
"RTN","DVBHQM13",14,0)
SPC S Z=$S(T1=1:"Paragraph 29",T1=2:"Paragraph 30",T1=3:"VA Regulation 1321(B)",T1=4:"VA Regulation 1322(A)",T1=5:"Analogous Ratings",T1=6:"Other or Combination",1:"")
"RTN","DVBHQM13",15,0)
 Q
"RTN","DVBHQM2")
0^7^B32012478
"RTN","DVBHQM2",1,0)
DVBHQM2 ;ISC-ALBANY/PKE-MAIL DELIVERY PROGRAM ;8/19/87  05:43
"RTN","DVBHQM2",2,0)
 ;;4.0;HINQ;**49**;03/25/92 
"RTN","DVBHQM2",3,0)
 G EN
"RTN","DVBHQM2",4,0)
LIN S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM2",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") Q
"RTN","DVBHQM2",6,0)
 ;
"RTN","DVBHQM2",7,0)
EN ;P&T now sent by VBA, 2=no, 3=yes, else null
"RTN","DVBHQM2",8,0)
 I $D(DVBPTI),((DVBPTI=2)!(DVBPTI=3)) S DVBPTI=$S(DVBPTI=2:"No",DVBPTI=3:"Yes",1:""),T1="    Perm.,Total Disability = "_DVBPTI D LIN
"RTN","DVBHQM2",9,0)
 I $D(DVBAAHB),((DVBAAHB="A")!(DVBAAHB="H")) S Y=DVBAAHB S Y=$S(Y="A":"A&A Paid",Y="H":"Housebound Paid",1:"") S T1="             AID & ATTEND = "_Y D LIN
"RTN","DVBHQM2",10,0)
 I $D(DVBFIDUC),(DVBFIDUC>0) S T1="Chief Attorney, fiduciary = "_DVBFIDUC D LIN
"RTN","DVBHQM2",11,0)
 ;;;I $D(DVBFIDUC),DVBFIDUC,$D(^DIC(4,DVBFIDUC,0)) S DVBFIDUC=$P(^(0),U),T1="Chief Attorney, fiduciary = "_DVBFIDUC D LIN
"RTN","DVBHQM2",12,0)
 ;VBA field is Unemployable, codes will Y=Unemploy, N=Employ DVB*4*49 
"RTN","DVBHQM2",13,0)
 I $D(DVBEI),((DVBEI="N")!(DVBEI="Y")) S DVBEI=$S(DVBEI="N":"Employable or not an issue",DVBEI="Y":"Unemployable",1:""),T1="     Employable indicator = "_DVBEI D LIN
"RTN","DVBHQM2",14,0)
 ;new VBA codes, I=incompetent or C=competent DVB*4*49
"RTN","DVBHQM2",15,0)
 I $D(DVBCI),((DVBCI'=" ")) S DVBCI=$S(DVBCI=1!(DVBCI="C"):"Competent, or not an issue",DVBCI="I"!(DVBCI="2"):"Incompetent",1:DVBCI),T1="     Competency indicator = "_DVBCI D LIN
"RTN","DVBHQM2",16,0)
 ;Severence Recoup, PFOP, Competency Pay Status  and Consol Payment will
"RTN","DVBHQM2",17,0)
 ;no longer be sent by VBA - DVB*4*49
"RTN","DVBHQM2",18,0)
 ;
"RTN","DVBHQM2",19,0)
 I $D(DVBP(2)) D P2^DVBHQM11
"RTN","DVBHQM2",20,0)
PNX I $D(DVBSPNAM),DVBSPNAM'?10" " S T1=" " D LIN S T1="Spouse name = "_DVBSPNAM D SDB,LIN
"RTN","DVBHQM2",21,0)
 S T1="" D LIN
"RTN","DVBHQM2",22,0)
 S T1="          "
"RTN","DVBHQM2",23,0)
 ;CHAMPVA no longer sent by VBA - DVB*4*49
"RTN","DVBHQM2",24,0)
 K C I $D(DVBBAS(1)) F N=32:1:35 I $P(DVBBAS(1),U,N) D SHDR Q
"RTN","DVBHQM2",25,0)
 I $D(C) D COUNT ;DVB*4*49 - some fields for C not sent by VBA any more
"RTN","DVBHQM2",26,0)
 ;so calculate from Child Status field
"RTN","DVBHQM2",27,0)
 I $D(C) D LIN S T1="",$P(T1,"-",80)="" D LIN S T1="School = "_$P(C,U,3)_"   Helpless School = "_$P(C,U,4)_"   Depend. total = "_$$DEP($P(C,U,1))_"   This Award = "_$$DEP($P(C,U,2)) D LIN
"RTN","DVBHQM2",28,0)
 I '$D(C),T1'["Not" S T1=$E(T1,1,23) D LIN
"RTN","DVBHQM2",29,0)
 K C
"RTN","DVBHQM2",30,0)
 I $D(DVBCHILD) S T1="" D LIN S T1="Child name        DOB       Child Status" D LIN
"RTN","DVBHQM2",31,0)
 I $D(DVBCHILD) F DVBDOB=0:0 S DVBDOB=$O(DVBCHILD(DVBDOB)) Q:'DVBDOB  S Y=DVBDOB,V=$P(DVBCHILD(Y),U),T1=$P(DVBCHILD(Y),U,2) D CDATE,CHILD D
"RTN","DVBHQM2",32,0)
 . F DVBB=$L(T1):1:10 S T1=T1_" "
"RTN","DVBHQM2",33,0)
 . S T1=T1_"   "_$E(Y_" ",1,11)_"   "_V D LIN
"RTN","DVBHQM2",34,0)
 K DVBPSNAM,DVBSPDOB,DVBCHILD,DVBDOB,V
"RTN","DVBHQM2",35,0)
 ;
"RTN","DVBHQM2",36,0)
 ;-8
"RTN","DVBHQM2",37,0)
 ;with DVB*4*49 Hardship Exp no longer sent by VBA, so removed from line
"RTN","DVBHQM2",38,0)
 S T1=" " D LIN
"RTN","DVBHQM2",39,0)
 S T1="Check Amount= '''                Net Award= '''"
"RTN","DVBHQM2",40,0)
 I $D(DVBBAS(1)) S $P(T1,"'",5,6)="$"_$P(DVBBAS(1),U,20)
"RTN","DVBHQM2",41,0)
 I $D(DVBCHECK) S $P(T1,"'",2,3)="$"_DVBCHECK
"RTN","DVBHQM2",42,0)
 ;I $P(^DIC(8,$P(^DPT(DFN,.36),U),0),U)'="NSC" D LIN
"RTN","DVBHQM2",43,0)
 D LIN
"RTN","DVBHQM2",44,0)
 K DVBCAP
"RTN","DVBHQM2",45,0)
 ;
"RTN","DVBHQM2",46,0)
RINC ;
"RTN","DVBHQM2",47,0)
 I $G(DVBINC)]"" I +$P(DVBINC,U,15)>0 S T1="                Income for VA Purposes= '$"_$P(DVBINC,U,15)_".00'" D LIN
"RTN","DVBHQM2",48,0)
 ;
"RTN","DVBHQM2",49,0)
EX ;
"RTN","DVBHQM2",50,0)
 K C,T2,T1,DVBDXPCT,DVBPT,DVBPTI,DVBAAHB,DVBFIDUC,DVBEI,DVBCI,DVBCPS,DVBSPNAM,DVBSPDOB,DVBCHILD,DVBDOB,V,DVBCHECK,Y
"RTN","DVBHQM2",51,0)
 D ADD^DVBHQM31
"RTN","DVBHQM2",52,0)
 G ERR^DVBHQM3 ;with DVB*4*49 no call made to EN^DVBHQM3
"RTN","DVBHQM2",53,0)
 ;
"RTN","DVBHQM2",54,0)
SHDR S T1=T1_"             Number of CHILDREN"
"RTN","DVBHQM2",55,0)
 I N>31 S C=$P(DVBBAS(1),U,32,35) Q
"RTN","DVBHQM2",56,0)
 ;
"RTN","DVBHQM2",57,0)
RHDR S T1="" D LIN
"RTN","DVBHQM2",58,0)
 S T1="last date    previously    INCOME REPORTED              amount, type" D LIN
"RTN","DVBHQM2",59,0)
 S T1="Reported     Reported    This Year   For VA purposes   Medical or Last Expense" D LIN
"RTN","DVBHQM2",60,0)
 S T1="",$P(T1,"-",80)="" D LIN Q
"RTN","DVBHQM2",61,0)
 ;
"RTN","DVBHQM2",62,0)
FILLER S T1="" F N=14,12,13,15,16,17 I N'=16 S T2=$S(N'=14:"$",1:"")_+$P(DVBINC,U,N),T1=T1_$J(T2,6) S:N<16 T1=T1_"       " I N=17 S T2=$P(DVBINC,U,16) D RTYP S T1=T1_" "_T2 D LIN S T1="" D LIN
"RTN","DVBHQM2",63,0)
 Q
"RTN","DVBHQM2",64,0)
 ;
"RTN","DVBHQM2",65,0)
RTYP S T2=$S(T2=" ":T2,T2="B":"SS/Other",T2="C":"Unusual Med.Exp.",T2="O":"Other",T2="R":"10%Ret.Pay excl.",T2="S":"Social Security",1:"") Q
"RTN","DVBHQM2",66,0)
 ;
"RTN","DVBHQM2",67,0)
AAA S V=Y S:Y>3&(Y<8) V=Y-4 S V=$S(V=0:"HB and/or A&A TERM",V=1:"HOSPITALIZED, HB,A&A PAY",V=2:"PAY A&A",V=3:"HB ONLY ",V=" ":"HB and/or A&A NOT GRANTED",1:"") I +Y,Y>3&(Y<8) S Y=V_", INCREMENT FOR SPOUSE" Q
"RTN","DVBHQM2",68,0)
 S Y=V Q
"RTN","DVBHQM2",69,0)
 ;
"RTN","DVBHQM2",70,0)
CHILD Q:$G(V)'?1U  S V=$S(V="H":"Helpless Child",V="M":"Minor Child",V="N":"Not an award dep.",V="S":"School Child",V="U":"Unclaimed DIC Child",1:"")
"RTN","DVBHQM2",71,0)
 Q
"RTN","DVBHQM2",72,0)
 ;
"RTN","DVBHQM2",73,0)
CPS S Y=$S(Y=1:"Competent,or not an issue,Pay direct",Y=2:"Incompetent by VA, Court .. pay fiduciary",Y=3:"Incompetent by Court, .. pay fiduciary",Y=4:"Competent by Court, Incompetent by VA .. pay direct",Y=5:"Supervised direct pay",1:Y) Q
"RTN","DVBHQM2",74,0)
 ;
"RTN","DVBHQM2",75,0)
SDB I $D(DVBSPDOB),DVBSPDOB I DVBSPDOB?8N S M=$E(DVBSPDOB,1,2) D MM^DVBHQM11 S T1=T1_"    DOB = "_M_" "_$S(+$E(DVBSPDOB,3,4)>0:$E(DVBSPDOB,3,4)_", ",1:" ")_$E(DVBSPDOB,5,8) K M
"RTN","DVBHQM2",76,0)
 Q
"RTN","DVBHQM2",77,0)
 ;
"RTN","DVBHQM2",78,0)
CDATE I DVBDOB'?9.10N S Y="" Q
"RTN","DVBHQM2",79,0)
 ;change CDATE to receive date as MMDDYYYY - DVB*4*49
"RTN","DVBHQM2",80,0)
 ;if there are more than 10 children then the characters are thrown
"RTN","DVBHQM2",81,0)
 ;off 1 place
"RTN","DVBHQM2",82,0)
 I $L(DVBDOB)=10 S $E(DVBDOB,2,9)=$E(DVBDOB,3,10)
"RTN","DVBHQM2",83,0)
 S M=$E(DVBDOB,2,3) D MM^DVBHQM11
"RTN","DVBHQM2",84,0)
 S Y=M_" "_$S(+$E(DVBDOB,4,5)>0:$E(DVBDOB,4,5)_",",1:" ")_$E(DVBDOB,6,9)
"RTN","DVBHQM2",85,0)
 Q
"RTN","DVBHQM2",86,0)
DEP(X) ;;V-S^V-S-F^V-S-M^V-S-2P^V-F^V-M^V-2P^V^
"RTN","DVBHQM2",87,0)
 ;Dependency codes
"RTN","DVBHQM2",88,0)
 Q:X>89 X Q:X'?2N X
"RTN","DVBHQM2",89,0)
 I X="00" S X="V" Q X
"RTN","DVBHQM2",90,0)
 I X="80" S X="V-C" Q X
"RTN","DVBHQM2",91,0)
 I $E(X,2)=0 S X=$P($P($T(DEP),";;",2),"^",$E(X,1)) Q X
"RTN","DVBHQM2",92,0)
 I X?2N S X=$P($P($T(DEP),";;",2),"^",$E(X,1))_"-"_$E(X,2)_"C" Q X
"RTN","DVBHQM2",93,0)
 Q X
"RTN","DVBHQM2",94,0)
COUNT ;loop through the DVBCHILD array and count the total, helpless and 
"RTN","DVBHQM2",95,0)
 ;school children
"RTN","DVBHQM2",96,0)
 N DVBC,DVBH,DVBS,DVBT
"RTN","DVBHQM2",97,0)
 S (DVBC,DVBH,DVBS,DVBT)=0
"RTN","DVBHQM2",98,0)
 F  S DVBC=$O(DVBCHILD(DVBC)) Q:DVBC'>0  D
"RTN","DVBHQM2",99,0)
 . I $P(DVBCHILD(DVBC),U)="H" S DVBH=DVBH+1
"RTN","DVBHQM2",100,0)
 . I $P(DVBCHILD(DVBC),U)="S" S DVBS=DVBS+1
"RTN","DVBHQM2",101,0)
 . S DVBT=DVBT+1
"RTN","DVBHQM2",102,0)
 S C=DVBT_"^"_+$P(C,U,2)_"^"_DVBS_"^"_DVBH
"RTN","DVBHQM2",103,0)
 Q
"RTN","DVBHQM3")
0^8^B14185157
"RTN","DVBHQM3",1,0)
DVBHQM3 ;ISC-ALBANY/PKE,JLU-MAIL DELIVERY PROGRAM ;8/19/87  07:16
"RTN","DVBHQM3",2,0)
 ;;4.0;HINQ;**49**;03/25/92 
"RTN","DVBHQM3",3,0)
 G EN
"RTN","DVBHQM3",4,0)
LIN Q:CT>300  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHQM3",5,0)
 ;
"RTN","DVBHQM3",6,0)
EN ;this code will not be used after DVB*4*49, as the individual income
"RTN","DVBHQM3",7,0)
 ;fields will no longer be sent from the VBA
"RTN","DVBHQM3",8,0)
 Q
"RTN","DVBHQM3",9,0)
 I $D(DVBINC) S DVBHOLD=$P(DVBINC,U,13)
"RTN","DVBHQM3",10,0)
 S T=0 F B="DVBHOLD","DVBEINC","DVBSSA","DVBRETT","DVBRETO","DVBOINC" S T=T+1 I $D(@B),+@B S CT=CT+1 D:B="DVBRETT" TR S A1=A_CT_",0)",TX=$P($T(T0+T),"=",2),@A1=$E(BL,1,26-$L(TX))_TX_" = "_$E(BL,1,5-$L(@B))_+@B
"RTN","DVBHQM3",11,0)
 K DVBHOLD,DVBEINC,DVBSSA,DVBRETT,DVBRETO,DVBOINC
"RTN","DVBHQM3",12,0)
LOOP1 F B="DVBSPENC","DVBSPSSA","DVBSPRET","DVBSPETO","DVBSPINC" S T=T+1 I $D(@B),+@B S CT=CT+1 D:B="DVBSPRET" TR S A1=A_CT_",0)",TX=$P($T(T0+T),"=",2),@A1=$E(BL,1,26-$L(TX))_TX_" = "_$E(BL,1,6-$L(@B))_@B
"RTN","DVBHQM3",13,0)
 K B,DVBSPENC,DVBSPSSA,DVBSPRET,DVBSPETO,DVBSPINC
"RTN","DVBHQM3",14,0)
 ;
"RTN","DVBHQM3",15,0)
RETIR I $D(DVBRTYPE) S T1=" " D LIN S T1="Type of Retirement Income   Verified  Reported" D LIN
"RTN","DVBHQM3",16,0)
 I $D(DVBRTYPE) F DVBRTYP=0:0 S DVBRTYP=$O(DVBRTYPE(DVBRTYP)) Q:'DVBRTYP  S Y=DVBRTYP D RTYPE S T1=Y_$E(BL,1,30-$L(Y))_DVBVMA_$E(BL,1,9-$L(DVBVMA))_DVBRMA D LIN
"RTN","DVBHQM3",17,0)
 K DVBCHECK,DVBRTYPE,DVBRTYP,DVBVMA,DVBRMA,Y,Y1,T,TX,BL
"RTN","DVBHQM3",18,0)
 ;
"RTN","DVBHQM3",19,0)
 D ADD^DVBHQM31
"RTN","DVBHQM3",20,0)
ERR D:'$D(DVBMM) ^XMD
"RTN","DVBHQM3",21,0)
 G:$D(DVBMM2) KLL
"RTN","DVBHQM3",22,0)
 S DVBSTATS=$S($D(DVBABREV):"A",$D(DVBERR):"E",$D(DVBNETER):"V",1:"N") S:$D(XMZ) DVBIXMZ=XMZ
"RTN","DVBHQM3",23,0)
 D SET^DVBHQUT
"RTN","DVBHQM3",24,0)
KLL K XMSUB,XMTEXT,XMDUZ,XMORIG,XMY,ER,DVBSSN,DVBSN,DVBCN,DVBABREV,T1,T2,T3,T4,M,DVBP(1),DVBP(2),DVBP(3),DVBP(4),DVBP(5),DVBP(6),Z,ZZ,A,A1,BL,CT,DVBREQUE,DVBNETER,DVBOTM,DVBERR,DVBERR1,DVBSTATS,DVBIXMZ,DVBNAME,L,C,DVBCTN,DVBCHNO
"RTN","DVBHQM3",25,0)
 K DVBBAS,DVBVET,DVBDIA,DVBCHI,DVBWIT,DVBADD,DVBDBF,DVBDBE,DVBREF,DVBFUT,DVBINC,DVBMON,DVBBIR
"RTN","DVBHQM3",26,0)
 QUIT
"RTN","DVBHQM3",27,0)
 ;
"RTN","DVBHQM3",28,0)
TR S V=@B,V=$S(V="B":"BLACKLUNG",V="M":"MILITARY",V="C":"CIVIL SERVICE",V="R":"RAILROAD",V="O":"OTHER",V="X":"COMBINATION",1:V),@B=V Q
"RTN","DVBHQM3",29,0)
 ;
"RTN","DVBHQM3",30,0)
RTYPE S Y1="" S:Y>7 Y1="-spouse",Y=Y-100 S Y=$S(Y=1:"Social Security",Y=2:"Civil Service",Y=3:"Military Retirement",Y=4:"Black Lung",Y=5:"Railroad Retirement",Y=6:"Other Retirement",Y=7:"Medicare Benefits",1:Y) S Y=Y_Y1 K Y1
"RTN","DVBHQM3",31,0)
 S DVBVMA=$P(DVBRTYPE(DVBRTYP),U),DVBRMA=$P(DVBRTYPE(DVBRTYP),U,2) F Z=1:1:4 S:$L(DVBVMA)<6 DVBVMA=" "_DVBVMA S:$L(DVBRMA)<6 DVBRMA=" "_DVBRMA
"RTN","DVBHQM3",32,0)
 Q
"RTN","DVBHQM3",33,0)
 ;
"RTN","DVBHQM3",34,0)
T0 ;;
"RTN","DVBHQM3",35,0)
 ;;DVBHOLD=Income reported
"RTN","DVBHQM3",36,0)
 ;;DVBEINC=Earned annual Income
"RTN","DVBHQM3",37,0)
 ;;DVBSSA=Annual Soc. Sec.
"RTN","DVBHQM3",38,0)
 ;;DVBRETT=Type of other Retirement
"RTN","DVBHQM3",39,0)
 ;;DVBRETO=Amount of other Retirement
"RTN","DVBHQM3",40,0)
 ;;DVBOINC=Other annual Income
"RTN","DVBHQM3",41,0)
 ;;DVBSPENC=Spouse earned annual income
"RTN","DVBHQM3",42,0)
 ;;DVBSPSSA=Spouse annual Soc. Sec.
"RTN","DVBHQM3",43,0)
 ;;DVBSPRET=Spouse type of other Retirement
"RTN","DVBHQM3",44,0)
 ;;DVBSPETO=Spouse other Retirement
"RTN","DVBHQM3",45,0)
 ;;DVBSPINC=Spouse other annual Income
"RTN","DVBHQM31")
0^9^B10293051
"RTN","DVBHQM31",1,0)
DVBHQM31 ;ISC-ALBANY/JLU-creates second column HINQ data ;9/28/88@0800
"RTN","DVBHQM31",2,0)
 ;;4.0;HINQ;**49**;03/25/92 
"RTN","DVBHQM31",3,0)
 ;
"RTN","DVBHQM31",4,0)
ADD G:'$D(DVBP(6)) P1
"RTN","DVBHQM31",5,0)
 I $P(DVBP(6),U,2)="Y" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"VA Employee",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",6,0)
 I $P(DVBP(6),U,4)="Y" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Vietnam Service",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",7,0)
 I $P(DVBP(6),U,5)="Y" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Medal of Honor",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",8,0)
 I $D(DVBFIDUC) D
"RTN","DVBHQM31",9,0)
 . I +$P($G(DVBP(6)),U,6)>1,(+$P($G(DVBP(6)),U,6)<5) S $P(DVBP(6),U,6)="Y"
"RTN","DVBHQM31",10,0)
 I $P(DVBP(6),U,6)="Y" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Guardianship",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",11,0)
 I $P(DVBP(6),U,7)="Y" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Incompetent",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",12,0)
 I $P(DVBP(6),U,8)="Y" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Verified Svc-Data",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",13,0)
 I $P(DVBP(6),U,8)="N" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"NOT verified Svc-Data",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",14,0)
 I $P(DVBP(6),U,8)="U" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Unknown Svc-Data",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",15,0)
 ;
"RTN","DVBHQM31",16,0)
P1 G:'$D(DVBP(1)) P5
"RTN","DVBHQM31",17,0)
 N DVBADAP
"RTN","DVBHQM31",18,0)
 S DVBADAP=$S($P(DVBP(1),U)="E":"Equip. only",$P(DVBP(1),U)="A":"Auto & Equip.",$P(DVBP(1),U)="N":"None",1:"")
"RTN","DVBHQM31",19,0)
 I $G(DVBADAP)]"" D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Adaptive equipment = "_DVBADAP,DVBCTN=DVBCTN+1
"RTN","DVBHQM31",20,0)
 I $P(DVBP(1),U,2)=1!($P(DVBP(1),U,2)="A") D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Auto allowance = paid.",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",21,0)
 S T1=$P(DVBP(1),U,3) I T1?8N S M=$E(T1,5,6) D MM,SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Original Award = "_M_" "_$E(T1,7,8)_", "_$E(T1,1,4),DVBCTN=DVBCTN+1
"RTN","DVBHQM31",22,0)
 S T1=$P(DVBP(1),U,5) I T1?1.2N D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Networth = "_$S(T1'="00":"$"_(T1-1*1000)_"-"_"$"_(T1*1000),T1="00":"Zero Networth"),DVBCTN=DVBCTN+1
"RTN","DVBHQM31",23,0)
 I $D(DVBBAS(1)) S T1=$P(DVBBAS(1),U,42) I T1?1.2N D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"(Cust/Spouse) = "_$S(T1'="00":"$"_(T1-1*1000)_"-"_"$"_(T1*1000),T1="00":"Zero Networth"),DVBCTN=DVBCTN+1
"RTN","DVBHQM31",24,0)
 ;Nursing Home Indicator no longer coming from VBA - DVB*4*49
"RTN","DVBHQM31",25,0)
 I $P(DVBP(1),U,7)=1 D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"Adaptive housing = PAID",DVBCTN=DVBCTN+1
"RTN","DVBHQM31",26,0)
 ;SSI, Combat Disability no longer coming from VBA - DVB*4*49
"RTN","DVBHQM31",27,0)
 ;
"RTN","DVBHQM31",28,0)
P5 Q:'$D(DVBP(5))  S T1=$P(DVBP(5),U) I T1 D SPAC S ^(0)=^TMP($J,DVBCTN,0)_Z_"PFOP Balance = "_" $"_+$E(T1,1,6)_"."_$E(T1,7,8),DVBCTN=DVBCTN+1
"RTN","DVBHQM31",29,0)
 Q
"RTN","DVBHQM31",30,0)
 ;
"RTN","DVBHQM31",31,0)
SPAC K Z I $L(^TMP($J,DVBCTN,0))<48 S $P(Z," ",48-$L(^TMP($J,DVBCTN,0)))=" " Q
"RTN","DVBHQM31",32,0)
 S DVBCTN=DVBCTN+1 G SPAC
"RTN","DVBHQM31",33,0)
 ;
"RTN","DVBHQM31",34,0)
MM S M=$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",M) Q
"RTN","DVBHQR1")
0^21^B21400838
"RTN","DVBHQR1",1,0)
DVBHQR1 ;ISC-ALBANY/PKE/JLU-parse HINQ response ;27 SEP 85  10:56 am
"RTN","DVBHQR1",2,0)
 ;;4.0;HINQ;**5,32,53,49**;03/25/92 
"RTN","DVBHQR1",3,0)
 ; PROCESSING THE C&P RECORD AND THEN THE BIRLS RECORD
"RTN","DVBHQR1",4,0)
BASIC S DFN=+$E(X(1),8,21),DVBLEN=$E(X(1),22,25),X=$E(X(1),26,999),DVBCN=$E(X,1,9)
"RTN","DVBHQR1",5,0)
 ;
"RTN","DVBHQR1",6,0)
 ;DVB*4*49 - claim # no longer coming as last 2 chars first
"RTN","DVBHQR1",7,0)
 S $P(DVBBAS(1),U,3)=$E(X,10),$P(DVBBAS(1),U,4)=$E(X,11,12)
"RTN","DVBHQR1",8,0)
 S $P(DVBBAS(1),U,5)=$E(X,13,17),$P(DVBBAS(1),U,6)="A"
"RTN","DVBHQR1",9,0)
 ;all records after DVB*4*49 will be sent as type "A"
"RTN","DVBHQR1",10,0)
 ;beginning of basic seg A,B,C,E,F
"RTN","DVBHQR1",11,0)
 S DVBNAME=$E(X,19,25)
"RTN","DVBHQR1",12,0)
 S $P(DVBBAS(1),U,8)=$E(X,26,27)
"RTN","DVBHQR1",13,0)
 S $P(DVBBAS(1),U,9)=$E(X,28),$P(DVBBAS(1),U,10)=$E(X,29,33)
"RTN","DVBHQR1",14,0)
 S DVBFL=$E(X,34,35)
"RTN","DVBHQR1",15,0)
 I +DVBFL S Y=$S($D(^DIC(4,"D",3_DVBFL)):$O(^(3_DVBFL,"")),$D(^DIC(4,"D",4_DVBFL)):$O(^(4_DVBFL,"")),1:"") I Y S Y=$S($D(^DIC(4,Y,0)):$P(^DIC(4,Y,99),U,1)_" - "_$P(^(0),U),1:""),DVBFL=Y
"RTN","DVBHQR1",16,0)
 I DVBFL="" S DVBFL="UNABLE TO DETERMINE"
"RTN","DVBHQR1",17,0)
 S $P(DVBBAS(1),U,12)=$E(X,36),$P(DVBBAS(1),U,13)=$E(X,37)
"RTN","DVBHQR1",18,0)
 S $P(DVBBAS(1),U,14)=$E(X,38),$P(DVBBAS(1),U,15)=$E(X,39)
"RTN","DVBHQR1",19,0)
 S $P(DVBBAS(1),U,16)=$E(X,40)
"RTN","DVBHQR1",20,0)
 S DVBV1=$E(X,41)
"RTN","DVBHQR1",21,0)
 ;I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL
"RTN","DVBHQR1",22,0)
 S $P(DVBBAS(1),U,17)=DVBV1
"RTN","DVBHQR1",23,0)
 S $P(DVBBAS(1),U,18)=$E(X,42)
"RTN","DVBHQR1",24,0)
 I $P(DVBBAS(1),U,6)="D" S $P(DVBBAS(1),U,19)=$E(X,43),$P(DVBBAS(1),U,20)=$E(X,44,45) S L=161 D RON G STAT^DVBHQR11 ;end of  BASIC D segment
"RTN","DVBHQR1",25,0)
 S $P(DVBBAS(1),U,19)=$E(X,43,45)
"RTN","DVBHQR1",26,0)
 S DVBV1=+$E(X,46,51)
"RTN","DVBHQR1",27,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",28,0)
 S $P(DVBBAS(1),U,20)=+$E(DVBV1,1,$L(DVBV1)-2)_"."_$E(DVBV1,$L(DVBV1)-1,$L(DVBV1))
"RTN","DVBHQR1",29,0)
 S L=52 D RON
"RTN","DVBHQR1",30,0)
 S $P(DVBBAS(1),U,21)=$E(X,1,8)
"RTN","DVBHQR1",31,0)
 S DVBV1=+$E(X,9,14)
"RTN","DVBHQR1",32,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",33,0)
 S DVBCHECK=+$E(DVBV1,1,$L(DVBV1)-2)_"."_$E(DVBV1,$L(DVBV1)-1,$L(DVBV1))
"RTN","DVBHQR1",34,0)
 S $P(DVBBAS(1),U,23)=$E(X,15)
"RTN","DVBHQR1",35,0)
 S $P(DVBP(1),U,4)=$E(X,16,17)
"RTN","DVBHQR1",36,0)
 S DVBV1=$E(X,18)
"RTN","DVBHQR1",37,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",38,0)
 S DVBADRLN=DVBV1
"RTN","DVBHQR1",39,0)
 S DVBV1=$E(X,19)
"RTN","DVBHQR1",40,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",41,0)
 S $P(DVBBAS(1),U,26)=DVBV1
"RTN","DVBHQR1",42,0)
 S $P(DVBBAS(1),U,27)=$E(X,20)
"RTN","DVBHQR1",43,0)
 S DVBFIDUC=$E(X,21,22)
"RTN","DVBHQR1",44,0)
 I +DVBFIDUC S Y=$S($D(^DIC(4,"D",3_DVBFIDUC)):$O(^(3_DVBFIDUC,"")),$D(^DIC(4,"D",4_DVBFIDUC)):$O(^(4_DVBFIDUC,"")),1:"") I Y S Y=$S($D(^DIC(4,Y,0)):$P(^DIC(4,Y,99),U,1)_" - "_$P(^(0),U),1:""),DVBFIDUC=Y
"RTN","DVBHQR1",45,0)
 I DVBFIDUC=99 S DVBFIDUC=""
"RTN","DVBHQR1",46,0)
 S $P(DVBBAS(1),U,29)=$E(X,23,24),$P(DVBBAS(1),U,30)=$E(X,25)
"RTN","DVBHQR1",47,0)
 S $P(DVBBAS(1),U,31)=$E(X,26),$P(DVBBAS(1),U,32)=$E(X,27,28)
"RTN","DVBHQR1",48,0)
 S $P(DVBBAS(1),U,33)=$E(X,29,30),$P(DVBBAS(1),U,34)=$E(X,31)
"RTN","DVBHQR1",49,0)
 S $P(DVBBAS(1),U,35)=$E(X,32)
"RTN","DVBHQR1",50,0)
 ;need to calculate power of attorney from C&P
"RTN","DVBHQR1",51,0)
 S DVBPOA="0"_$E(X,33,34) D POA^DVBHQR2
"RTN","DVBHQR1",52,0)
 S $P(DVBBAS(1),U,37)=$E(X,35)
"RTN","DVBHQR1",53,0)
 S DVBV1=$E(X,36)
"RTN","DVBHQR1",54,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR1",55,0)
 S $P(DVBBAS(1),U,38)=DVBV1
"RTN","DVBHQR1",56,0)
 S $P(DVBBAS(1),U,39)=$E(X,37,41),$P(DVBBAS(1),U,40)=$E(X,42,43)
"RTN","DVBHQR1",57,0)
 S $P(DVBP(1),U,5)=$E(X,44,45)
"RTN","DVBHQR1",58,0)
 S $P(DVBBAS(1),U,42)=$E(X,46,47)
"RTN","DVBHQR1",59,0)
 S DVBAAHB=$E(X,48)
"RTN","DVBHQR1",60,0)
 S L=49 D RON
"RTN","DVBHQR1",61,0)
 S $P(DVBBAS(2),U,1)=$E(X,1),$P(DVBBAS(2),U,2)=$E(X,2)
"RTN","DVBHQR1",62,0)
 S $P(DVBP(1),U,8)=$E(X,3)
"RTN","DVBHQR1",63,0)
 S $P(DVBBAS(2),U,4)=$E(X,4)
"RTN","DVBHQR1",64,0)
 S $P(DVBBAS(2),U,5)=$E(X,5),$P(DVBBAS(2),U,6)=$E(X,6)
"RTN","DVBHQR1",65,0)
 S $P(DVBBAS(2),U,7)=$E(X,7),$P(DVBBAS(2),U,8)=$E(X,8)
"RTN","DVBHQR1",66,0)
 S $P(DVBBAS(2),U,9)=$E(X,9),$P(DVBBAS(2),U,10)=$E(X,10)
"RTN","DVBHQR1",67,0)
 S $P(DVBP(1),U,2)=$E(X,11),$P(DVBP(1),U,1)=$E(X,12)
"RTN","DVBHQR1",68,0)
 S $P(DVBP(1),U,7)=$E(X,13),$P(DVBP(1),U,6)=$E(X,14)
"RTN","DVBHQR1",69,0)
 S DVBCSVC(1)=$E(X,15)
"RTN","DVBHQR1",70,0)
 ;;;S DVBCSVC(1)=5
"RTN","DVBHQR1",71,0)
 S $P(DVBP(1),U,3)=$E(X,16,23)
"RTN","DVBHQR1",72,0)
 S $P(DVBBAS(2),U,17)=$E(X,24)
"RTN","DVBHQR1",73,0)
 S $P(DVBBAS(2),U,18)=$E(X,25),$P(DVBBAS(2),U,19)=$E(X,26)
"RTN","DVBHQR1",74,0)
 S DVBPOW=$E(X,27)
"RTN","DVBHQR1",75,0)
 S $P(DVBBAS(2),U,21)=$E(X,28),$P(DVBBAS(2),U,22)=$E(X,29)
"RTN","DVBHQR1",76,0)
 S $P(DVBBAS(2),U,23)=$E(X,30),$P(DVBBAS(2),U,24)=$E(X,31)
"RTN","DVBHQR1",77,0)
 S $P(DVBBAS(2),U,25)=$E(X,32),$P(DVBBAS(2),U,26)=$E(X,33)
"RTN","DVBHQR1",78,0)
 S $P(DVBBAS(2),U,27)=$E(X,34),$P(DVBBAS(2),U,28)=$E(X,35)
"RTN","DVBHQR1",79,0)
 S $P(DVBBAS(2),U,29)=$E(X,36),$P(DVBBAS(2),U,30)=$E(X,37)
"RTN","DVBHQR1",80,0)
 S $P(DVBBAS(2),U,31)=$E(X,38),$P(DVBBAS(2),U,32)=$E(X,39)
"RTN","DVBHQR1",81,0)
 S $P(DVBBAS(2),U,33)=$E(X,40),$P(DVBBAS(2),U,34)=$E(X,41)
"RTN","DVBHQR1",82,0)
 S $P(DVBBAS(2),U,35)=$E(X,42),$P(DVBBAS(2),U,36)=$E(X,43)
"RTN","DVBHQR1",83,0)
 S $P(DVBBAS(2),U,37)=$E(X,44),$P(DVBBAS(2),U,38)=$E(X,45)
"RTN","DVBHQR1",84,0)
 S $P(DVBBAS(2),U,39)=$E(X,46),$P(DVBBAS(2),U,40)=$E(X,47)
"RTN","DVBHQR1",85,0)
 S $P(DVBBAS(2),U,41)=$E(X,48),$P(DVBBAS(2),U,42)=$E(X,49)
"RTN","DVBHQR1",86,0)
 S $P(DVBBAS(2),U,43)=$E(X,50),$P(DVBBAS(2),U,44)=$E(X,51)
"RTN","DVBHQR1",87,0)
 S $P(DVBBAS(2),U,45)=$E(X,52),$P(DVBBAS(2),U,46)=$E(X,53)
"RTN","DVBHQR1",88,0)
 S $P(DVBBAS(2),U,47)=$E(X,54),$P(DVBBAS(2),U,48)=$E(X,55,57)
"RTN","DVBHQR1",89,0)
 S $P(DVBBAS(2),U,49)=$E(X,58),$P(DVBBAS(2),U,50)=$E(X,59,61)
"RTN","DVBHQR1",90,0)
 S L=62 D RON
"RTN","DVBHQR1",91,0)
 ;end of basic segment A,B,C,E,F
"RTN","DVBHQR1",92,0)
 ;
"RTN","DVBHQR1",93,0)
 G STAT^DVBHQR11
"RTN","DVBHQR1",94,0)
 ;
"RTN","DVBHQR1",95,0)
RON S X=$E(X,L,999),LX=$L(X),LY=254-LX I $D(X(2)),(LX+$L(X(2)))<256 S X=X_X(2) K X(2) D RON1 Q
"RTN","DVBHQR1",96,0)
 I $D(X(2)) S X=X_$E(X(2),1,LY),X(2)=$E(X(2),LY+1,999) Q
"RTN","DVBHQR1",97,0)
 Q
"RTN","DVBHQR1",98,0)
 ;
"RTN","DVBHQR1",99,0)
RON1 F Z1=3:1:99 I $D(X(Z1)),'$D(X(Z1-1)) S X(Z1-1)=X(Z1) K X(Z1) Q:'$O(X(Z1))
"RTN","DVBHQR1",100,0)
 ;;;I $D(X(3)),'$D(X(2)) S X(2)=X(3) K X(3) I $D(X(4)),'$D(X(3)) S X(3)=X(4) K X(4) I $D(X(5)),'$D(X(4)) S X(4)=X(5) K X(5)
"RTN","DVBHQR1",101,0)
 QUIT
"RTN","DVBHQR1",102,0)
END K NAM,NUM Q
"RTN","DVBHQR1",103,0)
 Q
"RTN","DVBHQR11")
0^22^B30529777
"RTN","DVBHQR11",1,0)
DVBHQR11 ;ISC-ALBANY/PKE-parse HINQ response ; 8/29/05 8:49am
"RTN","DVBHQR11",2,0)
 ;;4.0;HINQ;**32,35,49**;03/25/92 
"RTN","DVBHQR11",3,0)
 ;
"RTN","DVBHQR11",4,0)
 ;
"RTN","DVBHQR11",5,0)
STAT ;Parse Statistics Segment for the records that have it.
"RTN","DVBHQR11",6,0)
 I ($P(DVBBAS(1),U,6)="A"!($P(DVBBAS(1),U,6)="E")),$P(DVBBAS(1),U,4)="00" D ASTAT
"RTN","DVBHQR11",7,0)
 I $P(DVBBAS(1),U,6)="B"!($P(DVBBAS(1),U,6)="F") D BSTAT
"RTN","DVBHQR11",8,0)
 I $P(DVBBAS(1),U,6)="E",$P(DVBBAS(1),U,4)'="00" D BSTAT
"RTN","DVBHQR11",9,0)
 I $P(DVBBAS(1),U,6)="C",$P(DVBBAS(1),U,4)=10 D CSTAT
"RTN","DVBHQR11",10,0)
 I $P(DVBBAS(1),U,6)="C",$P(DVBBAS(1),U,4)'=10 S DVBVET="C^^^^"
"RTN","DVBHQR11",11,0)
 ;
"RTN","DVBHQR11",12,0)
 G CHILD ;changing the order of the response message - diag will
"RTN","DVBHQR11",13,0)
 ;come at the very end to accommodate variable length records
"RTN","DVBHQR11",14,0)
 ;
"RTN","DVBHQR11",15,0)
DIAG ;Diagnostics Segment.
"RTN","DVBHQR11",16,0)
 K DXP,DX,DVBDX,DVBEFF
"RTN","DVBHQR11",17,0)
 N DVBCUR,DVBEXT,DVBORIG
"RTN","DVBHQR11",18,0)
 ;with the HINQ replacement, interim solution (DVB*4*49) there are 
"RTN","DVBHQR11",19,0)
 ;several changes to the diagnostic segment.  Total # codes, Add'l
"RTN","DVBHQR11",20,0)
 ;codes, length of segment are not longer being sent.  # SC Codes is
"RTN","DVBHQR11",21,0)
 ;being stored in DVBDXNO.  The for loop at DIAG+15 will terminate
"RTN","DVBHQR11",22,0)
 ;after DVBDXNO, the 6 code limit from VBA has been increased to 150.
"RTN","DVBHQR11",23,0)
 ;Total # of SC Diagnostic Codes.
"RTN","DVBHQR11",24,0)
 S DVBV1=$E(X,1,3)
"RTN","DVBHQR11",25,0)
 I DVBV1["{" S DVBV2=2 D SIGN^DVBHUTIL Q:$G(DVBERCS)  ;????
"RTN","DVBHQR11",26,0)
 S DVBDXNO=+DVBV1
"RTN","DVBHQR11",27,0)
 ;Combined Degree of Disability, Effective Date of Combined SC% Eval
"RTN","DVBHQR11",28,0)
 S DVBDXPCT=$E(X,4,6)
"RTN","DVBHQR11",29,0)
 S DVBDXPCT=$TR(DVBDXPCT," ")
"RTN","DVBHQR11",30,0)
 S DVBEFF=$E(X,7,14)
"RTN","DVBHQR11",31,0)
 S DVBEFF=$TR(DVBEFF," ")
"RTN","DVBHQR11",32,0)
 S L=15 D RON S L=1
"RTN","DVBHQR11",33,0)
 ;Y=Diagnostic Codes; DXP(I)=Percent of Disability:
"RTN","DVBHQR11",34,0)
 F I=1:1:DVBDXNO D
"RTN","DVBHQR11",35,0)
 . D RON S L=1
"RTN","DVBHQR11",36,0)
 . I $E(X,L,L+3)["    "!($E(X,L,L+3)']"") S L=L+25 Q
"RTN","DVBHQR11",37,0)
 . S Y=$E(X,L,L+3),DXP(I)=$E(X,L+4,L+6)
"RTN","DVBHQR11",38,0)
 . S DVBEXT(I)=$E(X,L+7,L+8)
"RTN","DVBHQR11",39,0)
 . S DVBEXT(I)=$TR(DVBEXT(I)," ")
"RTN","DVBHQR11",40,0)
 . S DVBORIG(I)=$E(X,L+9,L+16)
"RTN","DVBHQR11",41,0)
 . S DVBORIG(I)=$TR(DVBORIG(I)," ")
"RTN","DVBHQR11",42,0)
 . S DVBCUR(I)=$E(X,L+17,L+24)
"RTN","DVBHQR11",43,0)
 . S DVBCUR(I)=$TR(DVBCUR(I)," ")
"RTN","DVBHQR11",44,0)
 . S L=L+25 I DXP(I)'="   " S DX(I)="" F J=1:1:4 S Z=$E(Y,J) S:Z'?1N Z=$A(Z)-64 S:Z>9 Z=0 S DX(I)=DX(I)_Z
"RTN","DVBHQR11",45,0)
 F I=0:0 S I=$O(DX(I)) Q:'I  S Y=DX(I),DX(I)=$S($O(^DIC(31,"C",+DX(I),0)):$O(^(0)),1:"") S DVBDX(I)=Y_"^"_DX(I)_"^"_DXP(I)_"^"_$G(DVBEXT(I))_"^"_$G(DVBORIG(I))_"^"_$G(DVBCUR(I))
"RTN","DVBHQR11",46,0)
 ;
"RTN","DVBHQR11",47,0)
 ;sorting by SC% so that they will be saved and displayed that way
"RTN","DVBHQR11",48,0)
 N DVBCT,DVBDD,DVBE,DVBEE
"RTN","DVBHQR11",49,0)
 F DVBE=0:0 S DVBE=$O(DVBDX(DVBE)) Q:DVBE'>0  S DVBDD(+$P(DVBDX(DVBE),U,3),DVBE)=DVBDX(DVBE)
"RTN","DVBHQR11",50,0)
 S DVBE="",DVBCT=1
"RTN","DVBHQR11",51,0)
 F  S DVBE=$O(DVBDD(DVBE),-1) Q:DVBE']""  D
"RTN","DVBHQR11",52,0)
 . F DVBEE=0:0 S DVBEE=$O(DVBDD(DVBE,DVBEE)) Q:DVBEE'>0  D
"RTN","DVBHQR11",53,0)
 . . S DVBDX(DVBCT)=DVBDD(DVBE,DVBEE) S DVBCT=DVBCT+1
"RTN","DVBHQR11",54,0)
 K DVBDD,DX,DXP
"RTN","DVBHQR11",55,0)
 Q
"RTN","DVBHQR11",56,0)
 S L=L+1 D RON
"RTN","DVBHQR11",57,0)
 ;
"RTN","DVBHQR11",58,0)
CHILD ;Child-Birth-Data.
"RTN","DVBHQR11",59,0)
 S $P(DVBCHI,U,1)=$E(X,1,2)
"RTN","DVBHQR11",60,0)
 S DVBV1=$E(X,3,4)
"RTN","DVBHQR11",61,0)
 I DVBV1?1N1A!(DVBV1["{") S DVBV2=2 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",62,0)
 S DVBCHNO=DVBV1,L=5,J1=0 D RON
"RTN","DVBHQR11",63,0)
 I 'DVBCHNO S DVBCHNO=0 F DVBV=1:1:20 S L=20 D RON
"RTN","DVBHQR11",64,0)
 E  F DVBV=1:1:20 S DVBV1=$E(X,1,19),L=20 D RON I DVBV'>DVBCHNO S DVBCHDOB=$E(DVBV1,1,8) S:DVBCHDOB?8N J1=J1+1,DVBCHILD(J1_DVBCHDOB)=$E(DVBV1,9)_U_$E(DVBV1,10,19)
"RTN","DVBHQR11",65,0)
 K DVBCHDOB,J1,DVBV1,DVBV
"RTN","DVBHQR11",66,0)
 ;
"RTN","DVBHQR11",67,0)
WITH ;WITHHOLDING-APPORTIONED-SEGMENT.
"RTN","DVBHQR11",68,0)
 S $P(DVBWIT,U,1)=$E(X,1),DVBV1=$E(X,2,7)
"RTN","DVBHQR11",69,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",70,0)
 S $P(DVBWIT,U,2)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6)
"RTN","DVBHQR11",71,0)
 S DVBV1=$E(X,8,13)
"RTN","DVBHQR11",72,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",73,0)
 S $P(DVBWIT,U,3)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6)
"RTN","DVBHQR11",74,0)
 S DVBV1=$E(X,14,19)
"RTN","DVBHQR11",75,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",76,0)
 S $P(DVBWIT,U,4)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6),$P(DVBWIT,U,5)=$E(X,20)
"RTN","DVBHQR11",77,0)
 S L=21 D RON
"RTN","DVBHQR11",78,0)
 ;
"RTN","DVBHQR11",79,0)
NMADR ;ADDRESS-SEGMENT.
"RTN","DVBHQR11",80,0)
 S M("+")=7 F I=65:1:70 S M($C(I))=71-I
"RTN","DVBHQR11",81,0)
 S M("-")=15 F I=74:1:80 S M($C(I))=88-I
"RTN","DVBHQR11",82,0)
 F I=84:1:88 S M($C(I))=104-I
"RTN","DVBHQR11",83,0)
 S M("&")=7
"RTN","DVBHQR11",84,0)
 ;Blank & Length of Segment:
"RTN","DVBHQR11",85,0)
 S $P(DVBADD,U,1)=$E(X,1),DVBV1=$E(X,2,4)
"RTN","DVBHQR11",86,0)
 I DVBV1?2N1A!(DVBV1["{") S DVBV2=3 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR11",87,0)
 S $P(DVBADD,U,2)=DVBV1
"RTN","DVBHQR11",88,0)
 ;Sequence Control:
"RTN","DVBHQR11",89,0)
 S $P(DVBADD,U,3)=$E(X,5)
"RTN","DVBHQR11",90,0)
 ;Name Line Indicator:
"RTN","DVBHQR11",91,0)
 S $P(DVBADD,U,4)=$E(X,6)
"RTN","DVBHQR11",92,0)
 ;Zip Code:
"RTN","DVBHQR11",93,0)
 S DVBZIP=$E(X,7,15)
"RTN","DVBHQR11",94,0)
 S DVBZIP=$E(DVBZIP,1,5) ;use only 1st 5 digits - DVB*4*49
"RTN","DVBHQR11",95,0)
 S L=16,L1=15
"RTN","DVBHQR11",96,0)
 F I=1:1:DVBADRLN Q:$E(X,L)=" "!($E(X,L)="")  Q:'$G(M($E(X,L)))  S M=M($E(X,L)),DVBADR(I)=$E(X,L+1,L+M),L=L+M+1,L1=L1+M+1 D RON S L=1
"RTN","DVBHQR11",97,0)
 S $P(DVBADD,U,18)=145-L1
"RTN","DVBHQR11",98,0)
 S L=$P(DVBADD,U,18)+1 D RON
"RTN","DVBHQR11",99,0)
 K M,L1
"RTN","DVBHQR11",100,0)
 ;instead of calling DEDBL^DVBHQR12 call REF^DVBHQR12, since the DED/BAL
"RTN","DVBHQR11",101,0)
 ;segments will no longer be included in the VBA resp message, DVB*4*49
"RTN","DVBHQR11",102,0)
 G REF^DVBHQR12
"RTN","DVBHQR11",103,0)
 ;
"RTN","DVBHQR11",104,0)
RON S X=$E(X,L,999),LX=$L(X),LY=254-LX I $D(X(2)),(LX+$L(X(2)))<256 S X=X_X(2) K X(2) D RON1 Q
"RTN","DVBHQR11",105,0)
 I $D(X(2)) S X=X_$E(X(2),1,LY),X(2)=$E(X(2),LY+1,999) Q
"RTN","DVBHQR11",106,0)
 Q
"RTN","DVBHQR11",107,0)
 ;
"RTN","DVBHQR11",108,0)
RON1 F Z1=3:1:99 I $D(X(Z1)),'$D(X(Z1-1)) S X(Z1-1)=X(Z1) K X(Z1) Q:'$O(X(Z1))
"RTN","DVBHQR11",109,0)
 QUIT
"RTN","DVBHQR11",110,0)
 ;
"RTN","DVBHQR11",111,0)
ASTAT ;Statistics Segment of Type A Record.
"RTN","DVBHQR11",112,0)
 S $P(DVBVET,U,1)="A",$P(DVBVET,U,2)=$E(X,1)
"RTN","DVBHQR11",113,0)
 S $P(DVBVET,U,3)=$E(X,2)
"RTN","DVBHQR11",114,0)
 S DVBBOS(1)=$E(X,3),DVBEOD(1)=$E(X,4,11),DVBRAD(1)=$E(X,12,19),DVBASVC=$E(X,20),DVBDOB=$E(X,21,28)
"RTN","DVBHQR11",115,0)
 S $P(DVBVET,U,9)=$E(X,29,30),$P(DVBVET,U,10)=$E(X,31)
"RTN","DVBHQR11",116,0)
 S $P(DVBP(2),U,2)=$E(X,32)
"RTN","DVBHQR11",117,0)
 S DVBEI=$E(X,33),DVBCI=$E(X,34)
"RTN","DVBHQR11",118,0)
 S $P(DVBVET,U,14)=$E(X,35)
"RTN","DVBHQR11",119,0)
 S DVBCPS=$E(X,36)
"RTN","DVBHQR11",120,0)
 S DVBPTI=$E(X,37)
"RTN","DVBHQR11",121,0)
 S $P(DVBP(2),U,6)=$E(X,38,39),$P(DVBP(2),U,3)=$E(X,40,41),$P(DVBP(2),U,1)=$E(X,42,43),$P(DVBP(2),U,4)=$E(X,44),$P(DVBP(2),U,5)=$E(X,45)
"RTN","DVBHQR11",122,0)
 S L=46 D RON
"RTN","DVBHQR11",123,0)
 S DVBSPDOB=$E(X,1,8)
"RTN","DVBHQR11",124,0)
 ;leave spouse DOB in format MMDDYYYY
"RTN","DVBHQR11",125,0)
 S DVBSPNAM=$E(X,9,18) ;;;DVBPTI=$E(X,40)
"RTN","DVBHQR11",126,0)
 ;Hospitalized SMC code:
"RTN","DVBHQR11",127,0)
 S $P(DVBVET,U,24)=$E(X,19,20)
"RTN","DVBHQR11",128,0)
 ;DOB of Father:
"RTN","DVBHQR11",129,0)
 S $P(DVBVET,U,25)=$E(X,21,28)
"RTN","DVBHQR11",130,0)
 ;DOB of Mother:
"RTN","DVBHQR11",131,0)
 S $P(DVBVET,U,26)=$E(X,29,36)
"RTN","DVBHQR11",132,0)
 ;Blanks:
"RTN","DVBHQR11",133,0)
 S $P(DVBVET,U,27)=$E(X,37,40)
"RTN","DVBHQR11",134,0)
 S L=41 D RON
"RTN","DVBHQR11",135,0)
 Q
"RTN","DVBHQR11",136,0)
 ;
"RTN","DVBHQR11",137,0)
BSTAT ;Statistics Segment of Type B Record.
"RTN","DVBHQR11",138,0)
 S $P(DVBVET,U,1)="B",$P(DVBVET,U,2)=$E(X,1)
"RTN","DVBHQR11",139,0)
 S $P(DVBVET,U,3)=$E(X,2)
"RTN","DVBHQR11",140,0)
 S DVBBOS(1)=$E(X,3),DVBEOD(1)=$E(X,4,11),DVBRAD(1)=$E(X,12,19),DVBASVC=$E(X,20),DVBDOB=$E(X,21,28)
"RTN","DVBHQR11",141,0)
 S DVBDOB=$E(DVBDOB,5,8)_$E(DVBDOB,1,4)
"RTN","DVBHQR11",142,0)
 S $P(DVBVET,U,9)=$E(X,29,30),$P(DVBVET,U,10)=$E(X,31,37)
"RTN","DVBHQR11",143,0)
 ;Age at Death & Death Date:
"RTN","DVBHQR11",144,0)
 S $P(DVBVET,U,11)=$E(X,38,39),$P(DVBVET,U,12)=$E(X,40,47)
"RTN","DVBHQR11",145,0)
 ;Blank & Pay Grade
"RTN","DVBHQR11",146,0)
 S $P(DVBVET,U,13)=$E(X,48),$P(DVBVET,U,14)=$E(X,49,50)
"RTN","DVBHQR11",147,0)
 ;DOB of Payee & DOB of 3rd Party:
"RTN","DVBHQR11",148,0)
 S $P(DVBVET,U,15)=$E(X,51,58),$P(DVBVET,U,16)=$E(X,59,66)
"RTN","DVBHQR11",149,0)
 ;Name of 3rd Party & Filler
"RTN","DVBHQR11",150,0)
 S $P(DVBVET,U,17)=$E(X,67,73),$P(DVBVET,U,18)=$E(74,85)
"RTN","DVBHQR11",151,0)
 S L=86 D RON
"RTN","DVBHQR11",152,0)
 Q
"RTN","DVBHQR11",153,0)
 ;
"RTN","DVBHQR11",154,0)
CSTAT ;Statistics Segment of Type C Record.
"RTN","DVBHQR11",155,0)
 S $P(DVBVET,U,1)="C",$P(DVBVET,U,2)=$E(X,1)
"RTN","DVBHQR11",156,0)
 ;CP-APPORT-SPOUSE NAME & DOB
"RTN","DVBHQR11",157,0)
 S $P(DVBVET,U,3)=$E(X,2,11),$P(DVBVET,U,4)=$E(X,12,19)
"RTN","DVBHQR11",158,0)
 S $P(DVBVET,U,5)=$E(X,20,25)
"RTN","DVBHQR11",159,0)
 S L=86 D RON
"RTN","DVBHQR11",160,0)
 Q
"RTN","DVBHQR12")
0^23^B15500000
"RTN","DVBHQR12",1,0)
DVBHQR12 ;ALB/JLU;ROUTINE FOR C&P AND BIRLS ;8/28/91
"RTN","DVBHQR12",2,0)
 ;;4.0;HINQ;**32,35,49**;03/25/92 
"RTN","DVBHQR12",3,0)
 ; PROCESSING THE C&P RECORD AND THEN THE BIRLS RECORD
"RTN","DVBHQR12",4,0)
 ;
"RTN","DVBHQR12",5,0)
DEDBL ; The deduction balance segment "E" and "F"
"RTN","DVBHQR12",6,0)
EDEDBL S $P(DVBDBE,U,1)=$E(X,1),$P(DVBDBE,U,2)=$E(X,2,3)
"RTN","DVBHQR12",7,0)
 S $P(DVBDBE,U,3)=$E(X,4)
"RTN","DVBHQR12",8,0)
 S DVBV1=$E(X,5,10) I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",9,0)
 S $P(DVBDBE,U,4)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6)
"RTN","DVBHQR12",10,0)
 S DVBV1=$E(X,11,18) I DVBV1?7N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",11,0)
 S DVBP(5)=+$E(DVBV1,1,6)_"."_$E(DVBV1,7,8)_U
"RTN","DVBHQR12",12,0)
 S DVBV1=$E(X,19,25) I DVBV1?6N1A!(DVBV1["{") S DVBV2=7 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",13,0)
 S $P(DVBDBE,U,6)=+$E(DVBV1,1,5)_"."_$E(DVBV1,6,7),$P(DVBDBE,U,7)=$E(X,26,27)
"RTN","DVBHQR12",14,0)
 S $P(DVBDBE,U,8)=$E(X,28,29),$P(DVBDBE,U,9)=$E(X,30)
"RTN","DVBHQR12",15,0)
 S L=31 D RON
"RTN","DVBHQR12",16,0)
 ;
"RTN","DVBHQR12",17,0)
FDEDBL S $P(DVBDBF,U,1)=$E(X,1),$P(DVBDBF,U,2)=$E(X,2,3)
"RTN","DVBHQR12",18,0)
 S $P(DVBDBF,U,3)=$E(X,4)
"RTN","DVBHQR12",19,0)
 S DVBV1=$E(X,5,12) I DVBV1?7N1A!(DVBV1["{") S DVBV2=8 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",20,0)
 S $P(DVBDBF,U,4)=+$E(DVBV1,1,6)_"."_$E(DVBV1,7,8),$P(DVBDBF,U,5)=$E(X,13,14)
"RTN","DVBHQR12",21,0)
 S $P(DVBDBF,U,6)=$E(X,15)
"RTN","DVBHQR12",22,0)
 S L=16 D RON
"RTN","DVBHQR12",23,0)
 ;
"RTN","DVBHQR12",24,0)
REF ;REFERENCE-NUMBER-DATA.
"RTN","DVBHQR12",25,0)
 S $P(DVBREF,U,1)=$E(X,1,9),$P(DVBREF,U,2)=$E(X,10,18)
"RTN","DVBHQR12",26,0)
 S $P(DVBREF,U,3)=$E(X,19,27)
"RTN","DVBHQR12",27,0)
 S L=28 D RON
"RTN","DVBHQR12",28,0)
 ;make a call to INC^DVBHQR13, as the future segments will no longer be
"RTN","DVBHQR12",29,0)
 ;included in the VBA response message after DVB*4*49
"RTN","DVBHQR12",30,0)
 G INC^DVBHQR13
"RTN","DVBHQR12",31,0)
 ;
"RTN","DVBHQR12",32,0)
FUT ;DVB*4*49 - the call to G INC^DVBHQR13 is made in REF, and this code 
"RTN","DVBHQR12",33,0)
 ;will be skipped
"RTN","DVBHQR12",34,0)
 ;FUTURE DATA.
"RTN","DVBHQR12",35,0)
 ;A-TYPE-FUTURE-DATA:
"RTN","DVBHQR12",36,0)
 S DVBP(3)="A"_"^"_9_"^"
"RTN","DVBHQR12",37,0)
 F XX=1:8:65 S DVBP(3)=DVBP(3)_$E(X,XX,XX+7)_"^"
"RTN","DVBHQR12",38,0)
 S L=XX+8 D RON
"RTN","DVBHQR12",39,0)
 ;E/F-TYPE-FUTURE-DATA:
"RTN","DVBHQR12",40,0)
 D FUTE,FUTF
"RTN","DVBHQR12",41,0)
 ;
"RTN","DVBHQR12",42,0)
RON S X=$E(X,L,999),LX=$L(X),LY=254-LX I $D(X(2)),(LX+$L(X(2)))<256 S X=X_X(2) K X(2) D RON1 Q
"RTN","DVBHQR12",43,0)
 I $D(X(2)) S X=X_$E(X(2),1,LY),X(2)=$E(X(2),LY+1,999) Q
"RTN","DVBHQR12",44,0)
 Q
"RTN","DVBHQR12",45,0)
 ;
"RTN","DVBHQR12",46,0)
RON1 F Z1=3:1:99 I $D(X(Z1)),'$D(X(Z1-1)) S X(Z1-1)=X(Z1) K X(Z1) Q:'$O(X(Z1))
"RTN","DVBHQR12",47,0)
 QUIT
"RTN","DVBHQR12",48,0)
 ;
"RTN","DVBHQR12",49,0)
FUTE ;future segment type E
"RTN","DVBHQR12",50,0)
 S $P(DVBFUE,U)=$E(X,1)
"RTN","DVBHQR12",51,0)
 S $P(DVBFUE,U,2)=$E(X,2,9),$P(DVBFUE,U,3)=$E(X,10)
"RTN","DVBHQR12",52,0)
 S DVBV1=$E(X,11,16)
"RTN","DVBHQR12",53,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",54,0)
 S $P(DVBFUE,U,4)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6),$P(DVBFUE,U,5)=$E(X,17)
"RTN","DVBHQR12",55,0)
 S $P(DVBFUE,U,6)=$E(X,18,19),$P(DVBFUE,U,7)=$E(X,20,21)
"RTN","DVBHQR12",56,0)
 S $P(DVBFUE,U,8)=$E(X,22,23),$P(DVBFUE,U,9)=$E(24,25)
"RTN","DVBHQR12",57,0)
 S $P(DVBFUE,U,10)=$E(X,26),$P(DVBFUE,U,11)=$E(X,27)
"RTN","DVBHQR12",58,0)
 S $P(DVBFUE,U,12)=$E(X,28,32),$P(DVBFUE,U,13)=$E(X,33,34)
"RTN","DVBHQR12",59,0)
 S $P(DVBFUE,U,14)=$E(X,35),$P(DVBFUE,U,15)=$E(X,36)
"RTN","DVBHQR12",60,0)
 S $P(DVBFUE,U,16)=$E(X,37),$P(DVBFUE,U,17)=$E(X,38,40)
"RTN","DVBHQR12",61,0)
 S L=41 D RON
"RTN","DVBHQR12",62,0)
 I $P(DVBFUE,U,3) D LONGE
"RTN","DVBHQR12",63,0)
 E  S L=31 D RON
"RTN","DVBHQR12",64,0)
 Q
"RTN","DVBHQR12",65,0)
 ;
"RTN","DVBHQR12",66,0)
LONGE S LP1=18
"RTN","DVBHQR12",67,0)
 F LP=1:6:25 S DVBV1=$E(X,LP,LP+5) D LONCH S $P(DVBFUE,U,LP1)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6),LP1=LP1+1
"RTN","DVBHQR12",68,0)
 S L=31 D RON
"RTN","DVBHQR12",69,0)
 Q
"RTN","DVBHQR12",70,0)
 ;
"RTN","DVBHQR12",71,0)
LONCH I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",72,0)
 Q
"RTN","DVBHQR12",73,0)
 ;
"RTN","DVBHQR12",74,0)
FUTF ;F subsegment of the future segment.
"RTN","DVBHQR12",75,0)
 S $P(DVBFUF,U)=$E(X,1)
"RTN","DVBHQR12",76,0)
 S $P(DVBFUF,U,2)=$E(X,2,9),$P(DVBFUF,U,3)=$E(X,10)
"RTN","DVBHQR12",77,0)
 S $P(DVBFUF,U,4)=$E(X,11,18),$P(DVBFUF,U,5)=$E(X,19,26)
"RTN","DVBHQR12",78,0)
 S $P(DVBFUF,U,6)=$E(X,27),$P(DVBFUF,U,7)=$E(X,28)
"RTN","DVBHQR12",79,0)
 S $P(DVBFUF,U,8)=$E(X,29),$P(DVBFUF,U,9)=$E(X,30,31)
"RTN","DVBHQR12",80,0)
 S $P(DVBFUF,U,10)=$E(X,32),$P(DVBFUF,U,11)=$E(X,33)
"RTN","DVBHQR12",81,0)
 S DVBV1=$E(X,34)
"RTN","DVBHQR12",82,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",83,0)
 S $P(DVBFUF,U,12)=DVBV1
"RTN","DVBHQR12",84,0)
 S DVBV1=$E(X,35)
"RTN","DVBHQR12",85,0)
 I DVBV1?1A!(DVBV1["{") S DVBV2=1 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",86,0)
 S $P(DVBFUF,U,13)=DVBV1
"RTN","DVBHQR12",87,0)
 S $P(DVBFUF,U,14)=$E(X,36)
"RTN","DVBHQR12",88,0)
 S L=37 D RON
"RTN","DVBHQR12",89,0)
 S DVBV1=$E(X,1,2)
"RTN","DVBHQR12",90,0)
 I DVBV1?1N1A!(DVBV1["{") S DVBV2=2 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR12",91,0)
 S $P(DVBFUF,U,15)=DVBV1
"RTN","DVBHQR12",92,0)
 S $P(DVBFUF,U,16)=$E(X,3,5),$P(DVBFUF,U,17)=$E(X,6,9)
"RTN","DVBHQR12",93,0)
 S $P(DVBFUF,U,18)=$E(X,10,11),$P(DVBFUF,U,19)=$E(X,12,15)
"RTN","DVBHQR12",94,0)
 S $P(DVBFUF,U,20)=$E(X,16,17),$P(DVBFUF,U,21)=$E(X,18,21)
"RTN","DVBHQR12",95,0)
 S $P(DVBFUF,U,22)=$E(X,22,23),$P(DVBFUF,U,23)=$E(X,24,27)
"RTN","DVBHQR12",96,0)
 S $P(DVBFUF,U,24)=$E(X,28,29),$P(DVBFUF,U,25)=$E(X,30,33)
"RTN","DVBHQR12",97,0)
 S $P(DVBFUF,U,26)=$E(X,34,35),$P(DVBFUF,U,27)=$E(X,36,39)
"RTN","DVBHQR12",98,0)
 S $P(DVBFUF,U,28)=$E(X,40,41),$P(DVBFUF,U,29)=$E(X,42,44)
"RTN","DVBHQR12",99,0)
 S L=45 D RON
"RTN","DVBHQR12",100,0)
 Q
"RTN","DVBHQR13")
0^24^B27069661
"RTN","DVBHQR13",1,0)
DVBHQR13 ;ALB/JLU;part of the c&p/birls striper routines ; 7/11/05 12:45pm
"RTN","DVBHQR13",2,0)
 ;;4.0;HINQ;**15,32,35,49**;03/25/92
"RTN","DVBHQR13",3,0)
 ;
"RTN","DVBHQR13",4,0)
INC ;INCOME-SEGMENT.
"RTN","DVBHQR13",5,0)
 S $P(DVBINC,U,1)=$E(X,1),$P(DVBINC,U,2)=$E(X,2)
"RTN","DVBHQR13",6,0)
 S $P(DVBINC,U,3)=$E(X,3),$P(DVBINC,U,4)=$E(X,4)
"RTN","DVBHQR13",7,0)
 S $P(DVBINC,U,5)=$E(X,5),$P(DVBINC,U,6)=$E(X,6)
"RTN","DVBHQR13",8,0)
 S $P(DVBINC,U,7)=$E(X,7),$P(DVBINC,U,8)=$E(X,8)
"RTN","DVBHQR13",9,0)
 S $P(DVBINC,U,9)=$E(X,9),$P(DVBINC,U,10)=$E(X,10)
"RTN","DVBHQR13",10,0)
 S $P(DVBINC,U,11)=$E(X,11),$P(DVBINC,U,12)=$E(X,12,16)
"RTN","DVBHQR13",11,0)
 S $P(DVBINC,U,13)=$E(X,17,21),$P(DVBINC,U,14)=$E(X,22,25)
"RTN","DVBHQR13",12,0)
 S DVBV1=$E(X,26,30)
"RTN","DVBHQR13",13,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",14,0)
 S $P(DVBINC,U,15)=+DVBV1,$P(DVBINC,U,16)=$E(X,31)
"RTN","DVBHQR13",15,0)
 S DVBV1=$E(X,32,36)
"RTN","DVBHQR13",16,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",17,0)
 S $P(DVBINC,U,17)=DVBV1,$P(DVBINC,U,18)=$E(X,37)
"RTN","DVBHQR13",18,0)
 S $P(DVBINC,U,19)=$E(X,38,39),$P(DVBINC,U,20)=$E(X,40)
"RTN","DVBHQR13",19,0)
 S $P(DVBINC,U,21)=$E(X,41),$P(DVBINC,U,22)=$E(X,42)
"RTN","DVBHQR13",20,0)
 S $P(DVBINC,U,23)=$E(X,43),$P(DVBINC,U,24)=$E(X,44,45)
"RTN","DVBHQR13",21,0)
 S $P(DVBINC,U,25)=$E(X,46),$P(DVBINC,U,26)=$E(X,47)
"RTN","DVBHQR13",22,0)
 S $P(DVBINC,U,27)=$E(X,48),$P(DVBINC,U,28)=$E(X,49)
"RTN","DVBHQR13",23,0)
 S DVBV1=$E(X,50,54)
"RTN","DVBHQR13",24,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",25,0)
 S $P(DVBINC,U,29)=DVBV1,$P(DVBINC,U,30)=$E(X,55)
"RTN","DVBHQR13",26,0)
 S L=56 D RON
"RTN","DVBHQR13",27,0)
 ;all records now "A" ;I $P(DVBINC,U,1)="A" S L=51 D RON
"RTN","DVBHQR13",28,0)
 ;E  D BINC
"RTN","DVBHQR13",29,0)
 ;
"RTN","DVBHQR13",30,0)
MONRET ;MONTHLY-RETIREMENT-SEGMENT.
"RTN","DVBHQR13",31,0)
 S DVBV1=$E(X,1,2)
"RTN","DVBHQR13",32,0)
 I DVBV1?1N1A!(DVBV1["{") S DVBV2=2 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",33,0)
 S $P(DVBMON,U,1)=DVBV1,$P(DVBMON,U,2)=$E(X,3,5)
"RTN","DVBHQR13",34,0)
 S L=6 D RON
"RTN","DVBHQR13",35,0)
 F LP=1:1:10 D RET1 S L=16 D RON
"RTN","DVBHQR13",36,0)
 ;
"RTN","DVBHQR13",37,0)
BIRL ;BIRLS DATA.
"RTN","DVBHQR13",38,0)
 S DVBSSN=$E(X,1,9),X=$E(X,10,999)
"RTN","DVBHQR13",39,0)
 S J=-8 F I=2:1:4 S J=J+9,DVBSN(I)=$E(X,J,J+8)
"RTN","DVBHQR13",40,0)
 S L=J+9 D RON
"RTN","DVBHQR13",41,0)
 ;
"RTN","DVBHQR13",42,0)
NAM S J=-62 F I=1:1:3 S J=J+63 I $E(X,J,J+62)'="                                                               " S DVBPNAM(I)=$E(X,J,J+62)
"RTN","DVBHQR13",43,0)
 S L=J+63 D RON
"RTN","DVBHQR13",44,0)
 ;
"RTN","DVBHQR13",45,0)
DOD S $P(DVBP(6),U,1)=$E(X,1,8),X=$E(X,9,999)
"RTN","DVBHQR13",46,0)
 ;
"RTN","DVBHQR13",47,0)
BOS S J=-3 F I=2:1:4 S J=J+4 S DVBBOS(I)=$E(X,J,J+3)
"RTN","DVBHQR13",48,0)
 S X=$E(X,J+4,999)
"RTN","DVBHQR13",49,0)
 ;
"RTN","DVBHQR13",50,0)
EOD ;Get EODs. Assuming dates sent in as MMDDCCYY.
"RTN","DVBHQR13",51,0)
 S J=-7 F I=2:1:4 S J=J+8,DVBEOD(I)=($E(X,J+4,J+5)-17)_$E(X,J+6,J+7)_$E(X,J,J+3)
"RTN","DVBHQR13",52,0)
 S L=J+8 D RON
"RTN","DVBHQR13",53,0)
 ;
"RTN","DVBHQR13",54,0)
RAD ;Get RADs. Assuming dates sent in as MMDDCCYY.
"RTN","DVBHQR13",55,0)
 S J=-7 F I=2:1:4 D
"RTN","DVBHQR13",56,0)
 . S J=J+8,DVBRAD(I)=($E(X,J+4,J+5)-17)_$E(X,J+6,J+7)_$E(X,J,J+3)
"RTN","DVBHQR13",57,0)
 S L=J+8 D RON
"RTN","DVBHQR13",58,0)
 ;
"RTN","DVBHQR13",59,0)
SVC S J=-2 F I=2:1:4 S J=J+3,DVBCSVC(I)=$E(X,J,J+2)
"RTN","DVBHQR13",60,0)
 S L=J+3 D RON
"RTN","DVBHQR13",61,0)
 ;
"RTN","DVBHQR13",62,0)
POW D POW^DVBHUTL1
"RTN","DVBHQR13",63,0)
 ;
"RTN","DVBHQR13",64,0)
 I +Y S Y=$S($E(Y,1,2):+$E(Y,1,2)_" yr ",1:"")_$S($E(Y,3,4):+$E(Y,3,4)_" mo ",1:"")_$S($E(Y,5,6):+$E(Y,5,6)_" days ",1:""),DVBTOTAS=Y
"RTN","DVBHQR13",65,0)
 S L=11 D RON
"RTN","DVBHQR13",66,0)
 ;
"RTN","DVBHQR13",67,0)
 S $P(DVBBIR,U,18)=$E(X,1,3),X=$E(X,4,999)
"RTN","DVBHQR13",68,0)
 S $P(DVBP(6),U,3)=$E(X,1),$P(DVBP(6),U,2)=$E(X,2)
"RTN","DVBHQR13",69,0)
 S $P(DVBP(6),U,4)=$E(X,3),$P(DVBBIR,U,22)=$E(X,4)
"RTN","DVBHQR13",70,0)
 S $P(DVBP(6),U,5)=$E(X,5),$P(DVBBIR,U,24)=$E(X,6)
"RTN","DVBHQR13",71,0)
 S $P(DVBBIR,U,25)=$E(X,7),$P(DVBP(6),U,6)=$E(X,8)
"RTN","DVBHQR13",72,0)
 S $P(DVBP(6),U,7)=$E(X,9),$P(DVBBIR,U,28)=$E(X,10)
"RTN","DVBHQR13",73,0)
 S $P(DVBP(6),U,8)=$E(X,11),$P(DVBBIR,U,30)=$E(X,12)
"RTN","DVBHQR13",74,0)
 ;order of response string has been changed DVB*5.3*49
"RTN","DVBHQR13",75,0)
 S L=13 D RON
"RTN","DVBHQR13",76,0)
 D DIAG^DVBHQR11
"RTN","DVBHQR13",77,0)
 Q
"RTN","DVBHQR13",78,0)
 ;quitting here, DVB*4*49 obviates the necessity for the ADJ subroutine
"RTN","DVBHQR13",79,0)
 ;End of BIRLS segment.
"RTN","DVBHQR13",80,0)
 ;
"RTN","DVBHQR13",81,0)
ADJ ;
"RTN","DVBHQR13",82,0)
 Q  ;DVB*4*49
"RTN","DVBHQR13",83,0)
 Q:'$D(DVBRETT)  Q:'$D(DVBRETO)
"RTN","DVBHQR13",84,0)
 I $D(DVBSSA),+DVBSSA Q
"RTN","DVBHQR13",85,0)
 I DVBRETT="S" S DVBSSA=DVBRETO,DVBRETO=0
"RTN","DVBHQR13",86,0)
 ;This section is to determine the Permanent and total Indicator.
"RTN","DVBHQR13",87,0)
 S DVBPTI=" "
"RTN","DVBHQR13",88,0)
 I $D(DVBFUF),$P(DVBFUF,U,1)'=" " D SPTI Q
"RTN","DVBHQR13",89,0)
 I $D(DVBVET),$P(DVBVET,U,1)="A",$P(DVBP(2),U,7)>0,$P(DVBP(2),U,7)<4 D SPTI Q
"RTN","DVBHQR13",90,0)
 F LP1=1:1:9 S LP2=$P(DVBP(3),U,2+LP1) I $E(LP2,7,8)="01" D SPTI Q
"RTN","DVBHQR13",91,0)
 Q  ;END OF THE C&P/BIRLS STRING
"RTN","DVBHQR13",92,0)
 ;
"RTN","DVBHQR13",93,0)
SPTI ;Sets the Permanent and total indicator.
"RTN","DVBHQR13",94,0)
 S DVBPTI="N"
"RTN","DVBHQR13",95,0)
 ;
"RTN","DVBHQR13",96,0)
BINC ;B type of income segment
"RTN","DVBHQR13",97,0)
 S DVBV1=$E(X,1,5)
"RTN","DVBHQR13",98,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",99,0)
 S DVBEINC=+DVBV1
"RTN","DVBHQR13",100,0)
 S DVBV1=$E(X,6,10)
"RTN","DVBHQR13",101,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",102,0)
 S DVBSSA=+DVBV1,DVBRETT=$E(X,11)
"RTN","DVBHQR13",103,0)
 S DVBV1=$E(X,12,16)
"RTN","DVBHQR13",104,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",105,0)
 S DVBRETO=+DVBV1
"RTN","DVBHQR13",106,0)
 S DVBV1=$E(X,17,21)
"RTN","DVBHQR13",107,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",108,0)
 S DVBOINC=+DVBV1,$P(DVBINC,U,36)=$E(X,22,25)
"RTN","DVBHQR13",109,0)
 S L=26 D RON
"RTN","DVBHQR13",110,0)
 I $P(DVBINC,U,1)="B" S L=26 D RON Q
"RTN","DVBHQR13",111,0)
 E  D CINC
"RTN","DVBHQR13",112,0)
 Q
"RTN","DVBHQR13",113,0)
 ;
"RTN","DVBHQR13",114,0)
CINC ;C type of the income segment
"RTN","DVBHQR13",115,0)
 S DVBV1=$E(X,1,5)
"RTN","DVBHQR13",116,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",117,0)
 S DVBSPENC=+DVBV1
"RTN","DVBHQR13",118,0)
 S DVBV1=$E(X,6,10)
"RTN","DVBHQR13",119,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",120,0)
 S DVBSPSSA=+DVBV1,DVBSPRET=$E(X,11)
"RTN","DVBHQR13",121,0)
 S DVBV1=$E(X,12,16)
"RTN","DVBHQR13",122,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",123,0)
 S DVBSPETO=+DVBV1
"RTN","DVBHQR13",124,0)
 S DVBV1=$E(X,17,21)
"RTN","DVBHQR13",125,0)
 I DVBV1?4N1A!(DVBV1["{") S DVBV2=5 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",126,0)
 S DVBSPINC=+DVBV1
"RTN","DVBHQR13",127,0)
 S $P(DVBINC,U,42)=$E(X,22,25)
"RTN","DVBHQR13",128,0)
 S L=26 D RON
"RTN","DVBHQR13",129,0)
 Q
"RTN","DVBHQR13",130,0)
 ;
"RTN","DVBHQR13",131,0)
RET1 S DVBRTYP=$E(X,1,3) Q:DVBRTYP'?3N
"RTN","DVBHQR13",132,0)
 S DVBV1=$E(X,4,9)
"RTN","DVBHQR13",133,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",134,0)
 S DVBRTYPE(+DVBRTYP)=+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6)
"RTN","DVBHQR13",135,0)
 S DVBV1=$E(X,10,15)
"RTN","DVBHQR13",136,0)
 I DVBV1?5N1A!(DVBV1["{") S DVBV2=6 D SIGN^DVBHUTIL Q:$G(DVBERCS)
"RTN","DVBHQR13",137,0)
 S DVBRTYPE(+DVBRTYP)=DVBRTYPE(+DVBRTYP)_U_+$E(DVBV1,1,4)_"."_$E(DVBV1,5,6)
"RTN","DVBHQR13",138,0)
 Q
"RTN","DVBHQR13",139,0)
 ;
"RTN","DVBHQR13",140,0)
RON S X=$E(X,L,999),LX=$L(X),LY=254-LX I $D(X(2)),(LX+$L(X(2)))<256 S X=X_X(2) K X(2) D RON1 Q
"RTN","DVBHQR13",141,0)
 I $D(X(2)) S X=X_$E(X(2),1,LY),X(2)=$E(X(2),LY+1,999) Q
"RTN","DVBHQR13",142,0)
 Q
"RTN","DVBHQR13",143,0)
 ;
"RTN","DVBHQR13",144,0)
RON1 F Z1=3:1:99 I $D(X(Z1)),'$D(X(Z1-1)) S X(Z1-1)=X(Z1) K X(Z1) Q:'$O(X(Z1))
"RTN","DVBHQR13",145,0)
 ;;;I $D(X(3)),'$D(X(2)) S X(2)=X(3) K X(3) I $D(X(4)),'$D(X(3)) S X(3)=X(4) K X(4) I $D(X(5)),'$D(X(4)) S X(4)=X(5) K X(5)
"RTN","DVBHQR13",146,0)
 QUIT
"RTN","DVBHQR2")
0^11^B32886616
"RTN","DVBHQR2",1,0)
DVBHQR2 ;ISC-ALBANY/PKE/JLU-parse Birls response ;1/26/88  19:49
"RTN","DVBHQR2",2,0)
 ;;4.0;HINQ;**53,49**;03/25/92 
"RTN","DVBHQR2",3,0)
 S DFN=+$E(X(1),8,21),XMDUZ=DUZ,DVBLEN=+$E(X(1),22,25),X=$E(X(1),26,999)
"RTN","DVBHQR2",4,0)
 ;
"RTN","DVBHQR2",5,0)
 S DVBCAP="BIRLS Response only - No C&P Record Found",DVBCN=$E(X,1,9)
"RTN","DVBHQR2",6,0)
 I $E(DVBCN,9)=" " S DVBCN=$E(DVBCN,1,8)
"RTN","DVBHQR2",7,0)
 Q:'$L(X)
"RTN","DVBHQR2",8,0)
 S DVBNAME=$E(X,10,72)
"RTN","DVBHQR2",9,0)
 S L=73 D RON
"RTN","DVBHQR2",10,0)
 ;
"RTN","DVBHQR2",11,0)
 S DVBDOB=$E(X,1,8),DVBFL=$E(X,9,11)
"RTN","DVBHQR2",12,0)
FOLDER I +DVBFL S Y=0,Y=$O(^DIC(4,"D",+DVBFL,Y)) I Y S Y=$S($D(^DIC(4,Y,0)):$P(^DIC(4,Y,99),U,1)_" - "_$P(^(0),U),1:""),DVBFL=Y
"RTN","DVBHQR2",13,0)
 I DVBFL="   " K DVBFL
"RTN","DVBHQR2",14,0)
 ;
"RTN","DVBHQR2",15,0)
 S $P(DVBBIR,U,5)=$E(X,12),DVBPOA=$E(X,13,15)
"RTN","DVBHQR2",16,0)
 ;
"RTN","DVBHQR2",17,0)
 D POA
"RTN","DVBHQR2",18,0)
 ;
"RTN","DVBHQR2",19,0)
 S $P(DVBBIR,U,7)=$E(X,16) ;clothing allowance indicator
"RTN","DVBHQR2",20,0)
 S L=17 D RON
"RTN","DVBHQR2",21,0)
 ;
"RTN","DVBHQR2",22,0)
MOR S (DVBDXNO,DVBDXSC)=0
"RTN","DVBHQR2",23,0)
 F I=1:1:9 S Y=$E(X,1,4),DXP(I)=$E(X,5,7),DXP1(I)=$S($E(X,9)="Y":1,1:0)_U_$E(X,8),DX(I)="",L=10 S:$E(X,9)="Y" DVBDXSC=DVBDXSC+1 D RON F L=1:1:4 S Z=$E(Y,L) Q:Z=" "  S:Z'?1N Z=$A(Z)-64 S:Z>9 Z=0 S DX(I)=DX(I)_Z
"RTN","DVBHQR2",24,0)
 ;
"RTN","DVBHQR2",25,0)
 F I=0:0 S I=$O(DX(I)) Q:'I  S Y=DX(I),DX(I)=$S($O(^DIC(31,"C",+DX(I),0)):$O(^(0)),1:"") S DVBDX(I)=Y_"^"_DX(I)_"^"_DXP(I)_"^"_1 S:+Y>0 DVBDXNO=DVBDXNO+1
"RTN","DVBHQR2",26,0)
 ;
"RTN","DVBHQR2",27,0)
 ;DVB*4*49 - sort by SC%
"RTN","DVBHQR2",28,0)
 N DVBCT,DVBDD,DVBE,DVBEE
"RTN","DVBHQR2",29,0)
 F DVBE=0:0 S DVBE=$O(DVBDX(DVBE)) Q:DVBE'>0  S DVBDD(+$P(DVBDX(DVBE),U,3),DVBE)=DVBDX(DVBE)
"RTN","DVBHQR2",30,0)
 S DVBE="",DVBCT=1
"RTN","DVBHQR2",31,0)
 F  S DVBE=$O(DVBDD(DVBE),-1) Q:DVBE']""  D
"RTN","DVBHQR2",32,0)
 . F DVBEE=0:0 S DVBEE=$O(DVBDD(DVBE,DVBEE)) Q:DVBEE'>0  D
"RTN","DVBHQR2",33,0)
 . . S DVBDX(DVBCT)=DVBDD(DVBE,DVBEE) S DVBCT=DVBCT+1
"RTN","DVBHQR2",34,0)
 K DVBDD,DX,DXP
"RTN","DVBHQR2",35,0)
 S $P(DVBBIR,U,8)=$E(X,1),$P(DVBBIR,U,9)=$E(X,2)
"RTN","DVBHQR2",36,0)
 S $P(DVBBIR,U,10)=$E(X,3),DVBDXPCT=$E(X,4,6),$P(DVBBIR,U,11)=$E(X,4,6)
"RTN","DVBHQR2",37,0)
 S L=7 D RON
"RTN","DVBHQR2",38,0)
 D BIRL^DVBHQR13
"RTN","DVBHQR2",39,0)
 Q
"RTN","DVBHQR2",40,0)
 ;
"RTN","DVBHQR2",41,0)
RON S X=$E(X,L,999),LX=$L(X),LY=254-LX I $D(X(2)),(LX+$L(X(2)))<256 S X=X_X(2) K X(2) D RON1 Q
"RTN","DVBHQR2",42,0)
 I $D(X(2)) S X=X_$E(X(2),1,LY),X(2)=$E(X(2),LY+1,999) Q
"RTN","DVBHQR2",43,0)
 Q
"RTN","DVBHQR2",44,0)
 ;
"RTN","DVBHQR2",45,0)
RON1 I $D(X(3)),'$D(X(2)) S X(2)=X(3) K X(3) I $D(X(4)),'$D(X(3)) S X(3)=X(4) K X(4) I $D(X(5)),'$D(X(4)) S X(4)=X(5) K X(5)
"RTN","DVBHQR2",46,0)
 QUIT
"RTN","DVBHQR2",47,0)
 ;
"RTN","DVBHQR2",48,0)
POA ;DVB*4*49 - new Power of Attorney codes
"RTN","DVBHQR2",49,0)
 I DVBPOA'?1.3N D POA3 Q
"RTN","DVBHQR2",50,0)
 I +DVBPOA>99 Q
"RTN","DVBHQR2",51,0)
 I '+DVBPOA K DVBPOA Q
"RTN","DVBHQR2",52,0)
 I $L(DVBPOA)=3 S DVBPOA=+$E(DVBPOA,2,3)
"RTN","DVBHQR2",53,0)
 I DVBPOA>73,DVBPOA<100 S Y=DVBPOA D POA2 S DVBPOA=Y_" - "_DVBPOA Q
"RTN","DVBHQR2",54,0)
 ;
"RTN","DVBHQR2",55,0)
EEE ;
"RTN","DVBHQR2",56,0)
 S Y=0 F I=3,7,12,24,29,32,43,53,55,56,61,62,63,64,65,66,67,68,70,71 S Y=Y+1 IF I=+DVBPOA D POA1 S DVBPOA=Y_" - "_DVBPOA Q
"RTN","DVBHQR2",57,0)
 ;
"RTN","DVBHQR2",58,0)
 S Y=DVBPOA,Y=$S(+Y=2:402,Y=+5:405,Y=36:436,Y=37:437,Y=38:438,Y=42:442,Y=52:452,Y=55:455,Y=60:460,Y>9:3_Y,1:30_Y)
"RTN","DVBHQR2",59,0)
 S Z=0,Z=$O(^DIC(4,"D",Y,Z)) I Z,$D(^DIC(4,Z,0)) S Y=+$P(^(0),U,2) I $D(^DIC(5,Y,0)) S DVBPOA="State of "_$P(^(0),U)_" Department of Veterans - "_DVBPOA Q
"RTN","DVBHQR2",60,0)
 Q
"RTN","DVBHQR2",61,0)
POA1 S Y=$P($T(POA1+Y),";;",2) Q
"RTN","DVBHQR2",62,0)
3 ;;Polish Legion of Amer. Veterans, USA
"RTN","DVBHQR2",63,0)
7 ;;The Retired Enlisted Association
"RTN","DVBHQR2",64,0)
12 ;;Gold Star Wives of America Inc.
"RTN","DVBHQR2",65,0)
24 ;;National Amputation Foundation, Inc.
"RTN","DVBHQR2",66,0)
29 ;;Vietnam Era Veterans Association
"RTN","DVBHQR2",67,0)
32 ;;Virgin Islands Office of Veterans Affairs
"RTN","DVBHQR2",68,0)
43 ;;Swords to Plowshares
"RTN","DVBHQR2",69,0)
53 ;;Northern Mariana Islands Dept VA
"RTN","DVBHQR2",70,0)
55 ;;Puerto Rico Public Advocate for Veterans Affairs
"RTN","DVBHQR2",71,0)
56 ;;Guam Office of Veterans Affairs
"RTN","DVBHQR2",72,0)
61 ;;American Defenders of Bataan & Corregidor, Inc.
"RTN","DVBHQR2",73,0)
62 ;;Noncommissioned Officers Assoc., USA
"RTN","DVBHQR2",74,0)
63 ;;Veteran Assistance Foundation, Inc.
"RTN","DVBHQR2",75,0)
64 ;;Nat. Assn. of County Veterans Affairs Office
"RTN","DVBHQR2",76,0)
65 ;;American Ex-Prisoners of War, Inc.
"RTN","DVBHQR2",77,0)
66 ;;Private Attorney with Exclusive Contact
"RTN","DVBHQR2",78,0)
67 ;;American Samoa Veterans Affirs Office
"RTN","DVBHQR2",79,0)
68 ;;American GI Forum, National Veterans' Outreach Program
"RTN","DVBHQR2",80,0)
70 ;;Vietnam Veterans of America
"RTN","DVBHQR2",81,0)
71 ;;Paralyzed Veterans of America
"RTN","DVBHQR2",82,0)
 ;
"RTN","DVBHQR2",83,0)
POA2 S Y=Y-73,Y=$P($T(POA2+Y),";;",2) Q
"RTN","DVBHQR2",84,0)
74 ;;The American Legion
"RTN","DVBHQR2",85,0)
 ;;American National Red Cross
"RTN","DVBHQR2",86,0)
 ;;American Veterans Committee
"RTN","DVBHQR2",87,0)
 ;;AMVETS
"RTN","DVBHQR2",88,0)
 ;;Army and Air Force Mutual Aid Assoc.
"RTN","DVBHQR2",89,0)
 ;;Army and Navy Union, USA
"RTN","DVBHQR2",90,0)
8 ;;Blinded Veterans Assoc.
"RTN","DVBHQR2",91,0)
 ;;Catholic War Veterans, USA
"RTN","DVBHQR2",92,0)
 ;;National Veterans Legal Services Program
"RTN","DVBHQR2",93,0)
 ;;Disabled American Veterans
"RTN","DVBHQR2",94,0)
 ;;National Association for Black Veterans, Inc.
"RTN","DVBHQR2",95,0)
 ;;Fleet  Reserve Assoc.
"RTN","DVBHQR2",96,0)
 ;;Jewish War Veterans
"RTN","DVBHQR2",97,0)
 ;;Legion of Valor, USA
"RTN","DVBHQR2",98,0)
 ;;Marine Corps League
"RTN","DVBHQR2",99,0)
 ;;Military Order of the Purple Heart
"RTN","DVBHQR2",100,0)
9 ;;Eastern Paralyzed Veterans Association
"RTN","DVBHQR2",101,0)
 ;;African American PTSD Association
"RTN","DVBHQR2",102,0)
 ;;Veterans of the Vietnam War, Inc.
"RTN","DVBHQR2",103,0)
 ;;Navy Mutual Aid Assoc.
"RTN","DVBHQR2",104,0)
 ;;National Veterans Organization of America, Inc.
"RTN","DVBHQR2",105,0)
 ;;Italian American War Veterans
"RTN","DVBHQR2",106,0)
 ;;United Spanish War Veterans
"RTN","DVBHQR2",107,0)
 ;;Veterans of Foreign Wars of the United States
"RTN","DVBHQR2",108,0)
 ;;Veterans of WWI of the USA, Inc
"RTN","DVBHQR2",109,0)
 ;;Agent
"RTN","DVBHQR2",110,0)
 Q
"RTN","DVBHQR2",111,0)
POA3 ;DVB*4*49 - Power of Att. codes with alpha characters
"RTN","DVBHQR2",112,0)
 I $L(DVBPOA)=3 S DVBPOA=$E(DVBPOA,2,3)
"RTN","DVBHQR2",113,0)
 N DVBX,DVBXX
"RTN","DVBHQR2",114,0)
 I $E(DVBPOA)="0" D
"RTN","DVBHQR2",115,0)
 . F DVBX=65:1:82 S DVBXX=$C(DVBX) I DVBXX=$E(DVBPOA,2) S Y=DVBX D POA33 S DVBPOA=Y_" - "_DVBPOA Q
"RTN","DVBHQR2",116,0)
 Q
"RTN","DVBHQR2",117,0)
POA33 S Y=Y-64,Y=$P($T(POA33+Y),";;",2) Q
"RTN","DVBHQR2",118,0)
 ;;Mark R. Caldwell
"RTN","DVBHQR2",119,0)
 ;;Kenneth M. Carpenter
"RTN","DVBHQR2",120,0)
 ;;Stephen L. DeVita
"RTN","DVBHQR2",121,0)
 ;;William G. Smith
"RTN","DVBHQR2",122,0)
 ;;Legal Aid Society of Cincinatti
"RTN","DVBHQR2",123,0)
 ;;Irving M. Solotoff
"RTN","DVBHQR2",124,0)
 ;;Leroy A. St. John
"RTN","DVBHQR2",125,0)
 ;;Rashid L. Malik
"RTN","DVBHQR2",126,0)
 ;;Berry, Kelley & Reiman
"RTN","DVBHQR2",127,0)
 ;;Nancy E Killeen
"RTN","DVBHQR2",128,0)
 ;;Hill & Ponton Professional Assoc.
"RTN","DVBHQR2",129,0)
 ;;Richard A laPointe
"RTN","DVBHQR2",130,0)
 ;;Lisa Ann Lee
"RTN","DVBHQR2",131,0)
 ;;Betty L. G. Jones
"RTN","DVBHQR2",132,0)
 ;;
"RTN","DVBHQR2",133,0)
 ;;Barbara J. Cook
"RTN","DVBHQR2",134,0)
 ;;Law Offices of Theodore Jarvi
"RTN","DVBHQR2",135,0)
 ;;Chisholm, Chisholm & Kilpatrick LLP
"RTN","DVBHQR2",136,0)
 Q
"RTN","DVBHQUP")
0^31^B32139458
"RTN","DVBHQUP",1,0)
DVBHQUP ;ALB/JLU  This routine is used for the upload option. ; 8/11/05 6:52am
"RTN","DVBHQUP",2,0)
 ;;4.0;HINQ;**12,49**;03/25/92 
"RTN","DVBHQUP",3,0)
A D A^DVBHUTIL
"RTN","DVBHQUP",4,0)
B W !
"RTN","DVBHQUP",5,0)
B1 R !,"Do you want to examine the Suspense file by 'P'atient or 'A'll  P// ",K1:DTIME G:'$T KA1 D P:"Pp"[K1!(K1=""),L:"Aa"[$E(K1_1)
"RTN","DVBHQUP",6,0)
 G:DVBOUT="^" KA1
"RTN","DVBHQUP",7,0)
 I K1="?"!(K1'="^") W !!,*7,?15,"Answer with capital A or P <RET> also for P",!! G B1
"RTN","DVBHQUP",8,0)
KA1 D KA1^DVBHQEDT Q
"RTN","DVBHQUP",9,0)
KA D KA^DVBHQEDT
"RTN","DVBHQUP",10,0)
 Q
"RTN","DVBHQUP",11,0)
P S K1="^" K DVBDIQ D P1 I Y<0 S DVBOUT="^" Q
"RTN","DVBHQUP",12,0)
 S DIE="^DPT(",(DA,DFN)=+Y,DR="[DVBHINQ UPDATE]",DVBJ2=0 D TEM^DVBHIQR,^DIE:'$D(DVBERCS) K DIE,DR,DA
"RTN","DVBHQUP",13,0)
 D C I DVBOUT'="^" G P
"RTN","DVBHQUP",14,0)
 Q
"RTN","DVBHQUP",15,0)
L S ANS="",K1="^"
"RTN","DVBHQUP",16,0)
 I '$D(^DVB(395.5,"AC","N")) W !!,"No patients to be updated." H 3 Q
"RTN","DVBHQUP",17,0)
 F K2=0:0 S K2=$O(^DVB(395.5,"AC","N",K2)) Q:'K2  I $D(^DVB(395.5,K2,"RS",0)),$P(^DVB(395.5,K2,0),U,5)'="Y",$P(^(0),U,5)'="I" S DIE="^DPT(",(DA,DFN)=K2,DR="[DVBHINQ UPDATE]",DVBJ2=0 D TEM^DVBHIQR,^DIE:'$D(DVBERCS) D C,KA Q:DVBOUT="^"
"RTN","DVBHQUP",18,0)
 Q
"RTN","DVBHQUP",19,0)
C ;SETS UPDATED? FIELD, RUNS INCONSIS. CHECKER.
"RTN","DVBHQUP",20,0)
 Q:DVBOUT["^"  S DVB=DFN,DVBLP=2,DVBMM=1,DVBMM2=1 D QB^DVBHQZ6
"RTN","DVBHQUP",21,0)
 Q:'DVBJ2  I DVBJ2 S $P(^DVB(395.5,DFN,0),U,5)="Y" S DGEDCN=1 D ^DGRPC I 1
"RTN","DVBHQUP",22,0)
 E  S $P(^DVB(395.5,DFN,0),U,5)="N"
"RTN","DVBHQUP",23,0)
 D FILE K DVBDIQ Q
"RTN","DVBHQUP",24,0)
 ;
"RTN","DVBHQUP",25,0)
 ;I '$D(^DVB(395.7,DFN,0)) K DIC,DD,DO S DIC(0)="LQ",DIC="^DVB(395.7,",DIC("DR")="1////"_DUZ_";2///"_"N",(X,DINUM)=DFN D FILE^DICN I 1
"RTN","DVBHQUP",26,0)
 ;E  S DIE="^DVB(395.7,",DA=DFN,DR="1////"_DUZ_";2///"_"N" D ^DIE
"RTN","DVBHQUP",27,0)
 ;
"RTN","DVBHQUP",28,0)
FILE I '$D(^DVB(395.7,DFN,0)) DO
"RTN","DVBHQUP",29,0)
 .K DIC,DD,DO S DIC(0)="LQ",DIC="^DVB(395.7,"
"RTN","DVBHQUP",30,0)
 .S DIC("DR")="1////"_DUZ_";2///"_"N"_$S($D(DVBNOALR):DVBNOALR,1:"")
"RTN","DVBHQUP",31,0)
 .S (X,DINUM)=DFN D FILE^DICN
"RTN","DVBHQUP",32,0)
 E  DO
"RTN","DVBHQUP",33,0)
 .K DIC S (DIC,DIE)="^DVB(395.7,",DA=DFN
"RTN","DVBHQUP",34,0)
 .S DR="1////"_DUZ_";2///"_"N"_$S($D(DVBNOALR):DVBNOALR,1:"")
"RTN","DVBHQUP",35,0)
 .I 'DVBJ2,$D(DVBNOALR),DVBNOALR]"" S DR=$E(DVBNOALR,2,99)
"RTN","DVBHQUP",36,0)
 .L +^DVB(395.7,DFN):3 I $T D ^DIE
"RTN","DVBHQUP",37,0)
 .L -^DVB(395.7,DFN)
"RTN","DVBHQUP",38,0)
 K DIC,DIE,DA,DR Q
"RTN","DVBHQUP",39,0)
 ;
"RTN","DVBHQUP",40,0)
 ;ENRTY PT FOR PRINT OPTION
"RTN","DVBHQUP",41,0)
PT W @$S('$D(IOF):"#",IOF="":"#",1:IOF),!!!!!!!!!!
"RTN","DVBHQUP",42,0)
PT1 R "Do you want a print out of a (S)ingle patient or (A)ll of the patients?  S// ",DVBJA:DTIME G:'$T KA1 D S:DVBJA="S"!(DVBJA=""),T:DVBJA="A"
"RTN","DVBHQUP",43,0)
 I DVBJA="?"!(DVBJA'="^") W !!,*7,?15,"Answer with a capital A or S or <RET> for S",!! G PT1
"RTN","DVBHQUP",44,0)
 D KA1 Q
"RTN","DVBHQUP",45,0)
S D P1 I Y<0 S DVBJA="^" Q
"RTN","DVBHQUP",46,0)
 S (DFN,D0,ZTSAVE("D0"),ZTSAVE("DFN"))=+Y,ZTRTN="S1^DVBHQUP" D RP I $D(IO("Q"))!POP S DVBJA="^" Q
"RTN","DVBHQUP",47,0)
S1 U IO D TEM^DVBHIQR,^DVBHCG:'$D(DVBERCS) I '$D(ZTSK) X ^%ZIS("C")
"RTN","DVBHQUP",48,0)
 S DVBJA="^" Q
"RTN","DVBHQUP",49,0)
T S DVBJA="^",ZTRTN="RP1^DVBHQUP"
"RTN","DVBHQUP",50,0)
 W !!,?6,"Select one of the following:",!!,?11,"1   Updated",!,?11,"2   NOT  Updated",!,?11,"3   Both",!,"How would you like your print sorted?  Updated//"
"RTN","DVBHQUP",51,0)
 R Y:DTIME Q:Y="^"!('$T)
"RTN","DVBHQUP",52,0)
 S (ZTSAVE("DVBY"),DVBY)=$S(Y=1!(Y="")!(Y["U"):1,Y=2!(Y["N"):2,Y=3!(Y["B"):3,1:"")
"RTN","DVBHQUP",53,0)
 I DVBY="" W !!,*7,"Answer with a code from the list." G T
"RTN","DVBHQUP",54,0)
 D CT Q
"RTN","DVBHQUP",55,0)
 ;
"RTN","DVBHQUP",56,0)
AU ;ENTRY POINT FOR DISPLAY OF AUDIT.
"RTN","DVBHQUP",57,0)
 W @$S('$D(IOF):"#",IOF="":"#",1:IOF),!!!!!
"RTN","DVBHQUP",58,0)
AU1 W !!,?6,"Select one of the following:",!!,?11,"1   Patient",!,?11,"2   User",!,?11,"3   Date/Time",!,"By which would you like the sort to begin? : Patient//"
"RTN","DVBHQUP",59,0)
 R Y:DTIME Q:Y="^"!('$T)
"RTN","DVBHQUP",60,0)
 S (FLDS,BY)=$S(Y=1!(Y="")!(Y["P"):"[DVBHINQ AUDIT/PAT]",Y=2!(Y["U"):"[DVBHINQ AUDIT/USER]",Y=3!(Y["D"):"[DVBHINQ AUDIT/DT]",1:"")
"RTN","DVBHQUP",61,0)
 I BY="" W !!,*7,"Answer with a code from the above list." G AU1
"RTN","DVBHQUP",62,0)
 S L=0,DIC="^DVB(395.7,",(FR,TO)="" D EN1^DIP Q
"RTN","DVBHQUP",63,0)
 ;
"RTN","DVBHQUP",64,0)
P1 W ! D KA S DIC="^DVB(395.5,",DIC(0)="AEMZQ",DIC("S")="I ($P(^(0),U,4)=""N""),($D(^(""RS"",0)))",DIC("A")="Select Patient from ""HINQ Suspense file"":" D ^DIC K DIC Q
"RTN","DVBHQUP",65,0)
 ;
"RTN","DVBHQUP",66,0)
RP S %IS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) S ZTDESC="This is a job for the HINQ report.",ZTIO=ION D ^%ZTLOAD X ^%ZIS("C") Q
"RTN","DVBHQUP",67,0)
 Q:DVBJA=""!(DVBJA="S")
"RTN","DVBHQUP",68,0)
RP1 S DVB8="" U IO F D0=0:0 S (D0,DFN)=$O(^DVB(395.5,"AC","N",D0)) Q:'D0  S DVBJ1=$S((DVBY=1)&($P(^DVB(395.5,D0,0),U,5)="Y"):1,(DVBY=2)&($P(^(0),U,5)'="Y"):1,DVBY=3:1,1:0) D:DVBJ1 TEM^DVBHIQR,^DVBHCG:'$D(DVBERCS) Q:DVB8["^"  D KA
"RTN","DVBHQUP",69,0)
 I '$D(ZTSK) X ^%ZIS("C")
"RTN","DVBHQUP",70,0)
 Q
"RTN","DVBHQUP",71,0)
 ;
"RTN","DVBHQUP",72,0)
CT S DVB1=0 F DVB=0:0 S DVB1=$O(^DVB(395.5,"AC","N",DVB1)) Q:'DVB1  S DVB=$S(DVBY=1&($P(^DVB(395.5,DVB1,0),U,5)="Y"):DVB+1,DVBY=2&($P(^(0),U,5)'="Y"):DVB+1,DVBY=3:DVB+1,1:DVB)
"RTN","DVBHQUP",73,0)
 I 'DVB W !,"There are no patients at this time for this print." Q
"RTN","DVBHQUP",74,0)
CT1 W !!,"There are ",DVB," patients for this report, do you wish to continue" S %=1 D YN^DICN Q:%=2!(%<0)  I '% W !,"A YES answer will continue on with the report, answer with Y or N" G CT1
"RTN","DVBHQUP",75,0)
 D RP Q
"RTN","DVBHQUP",76,0)
LSTR ;lists the SC disabilities in the ReviewPatient vs. HINQ data 
"RTN","DVBHQUP",77,0)
 ;option, [DVB HUPLOAD-PRINT]
"RTN","DVBHQUP",78,0)
 ;called from print template [DVBHINQ PAT-HINQ COMP]
"RTN","DVBHQUP",79,0)
 N DVBIEN
"RTN","DVBHQUP",80,0)
 K DVBERR
"RTN","DVBHQUP",81,0)
 D GETS^DIQ(2,DFN_",",".302;.3014;.3721*","EI","DVBDIQ","DVBERR")
"RTN","DVBHQUP",82,0)
 W "-Comb. SC%: "_+DVBDIQ(2,DFN_",",.302,"E")_"  "
"RTN","DVBHQUP",83,0)
 W "Eff. Date Comb. Eval.: "_DVBDIQ(2,DFN_",",.3014,"E")
"RTN","DVBHQUP",84,0)
 I $P($G(^DPT(DFN,.372,0)),U,3)>0 D LABELS^DVBHS3
"RTN","DVBHQUP",85,0)
 S LP=""
"RTN","DVBHQUP",86,0)
 I $D(DVBDIQ(2.04)) F  S LP=$O(DVBDIQ(2.04,LP)) Q:'LP  D
"RTN","DVBHQUP",87,0)
 . I ($Y+5)>IOSL,$E(IOST,1,2)="C-" D PAUSE^DVBHS3
"RTN","DVBHQUP",88,0)
 . W !,$E(DVBDIQ(2.04,LP,.01,"E"),1,40),?42,DVBDIQ(2.04,LP,2,"E")
"RTN","DVBHQUP",89,0)
 . W ?50,$G(DVBDIQ(2.04,LP,4,"I")),?55,$G(DVBDIQ(2.04,LP,5,"E"))
"RTN","DVBHQUP",90,0)
 . W ?68,$G(DVBDIQ(2.04,LP,6,"E"))
"RTN","DVBHQUP",91,0)
 Q
"RTN","DVBHQUP",92,0)
 N DVBFR,DVBLAST,DVBX,QUIT
"RTN","DVBHQUP",93,0)
 S DVBFR=""
"RTN","DVBHQUP",94,0)
 S DVBLAST=$O(^DPT(DFN,.372,""),-1)
"RTN","DVBHQUP",95,0)
 I $G(DVBLAST)']"" Q
"RTN","DVBHQUP",96,0)
 F DVBX=0:0 D LOOP I $G(QUIT)=1!(DVBFR(2)>DVBLAST) K QUIT Q
"RTN","DVBHQUP",97,0)
 Q
"RTN","DVBHQUP",98,0)
LOOP ;
"RTN","DVBHQUP",99,0)
 D LIST
"RTN","DVBHQUP",100,0)
 N DVBCT
"RTN","DVBHQUP",101,0)
 F DVBCT=0:0  S DVBCT=$O(DVBARR("DILIST",DVBCT)) Q:'DVBCT!(DVBCT>19)  D
"RTN","DVBHQUP",102,0)
 . W !?36,$P(DVBARR("DILIST",DVBCT,0),U,2),?68,$P(DVBARR("DILIST",DVBCT,0),U,4),?74,$P(DVBARR("DILIST",DVBCT,0),U,5)
"RTN","DVBHQUP",103,0)
 D PAUSE^DVBHS3
"RTN","DVBHQUP",104,0)
 Q
"RTN","DVBHQUP",105,0)
LIST ;
"RTN","DVBHQUP",106,0)
 D LIST^DIC(2.04,","_DFN_",",".01;2;3","P",20,.DVBFR,,,,,"DVBARR",)
"RTN","DVBHQUP",107,0)
 I $G(DVBFR(2))'>0 S QUIT=1
"RTN","DVBHQUP",108,0)
 Q 
"RTN","DVBHQZ6")
0^28^B23438540
"RTN","DVBHQZ6",1,0)
DVBHQZ6 ;ISC-ALBANY/JLU-print message ; 8/10/05 11:16am
"RTN","DVBHQZ6",2,0)
 ;;4.0;HINQ;**28,49**;03/25/92 
"RTN","DVBHQZ6",3,0)
1 W @$S('$D(IOF):"#",IOF="":"#",1:IOF),!!!
"RTN","DVBHQZ6",4,0)
2 D 2^DVBHUTIL
"RTN","DVBHQZ6",5,0)
3 W !!!,?5,"Printout by (M)ultiple patients, (R)equestor, (D)ate/time?   Multiple//"
"RTN","DVBHQZ6",6,0)
 R DVBA:DTIME G:DVBA="^"!('$T) K S:DVBA="" DVBA="M"
"RTN","DVBHQZ6",7,0)
 S (DVBMM2,DVBMM)=1 D M:"Mm"[DVBA,R:"Rr"[DVBA,D:"Dd"[DVBA
"RTN","DVBHQZ6",8,0)
 I "MRDmrd"'[DVBA W !!,*7,?10,"Answer with an 'M', 'R', 'D', <RET> for 'M', or '^' to quit." G 3
"RTN","DVBHQZ6",9,0)
K K DVBI,R1,DVBLEN,DVBMM2,X,POP,DVBMM1,DVBA,DVBLP,DVB,DVBMM,DVBLP1,DIC,%,DFN,ZTRTN,ZTSAVE,ZTDESC,ZTIO,DVBJIO,POP,Y,ZTSK,DVBDXSC,DVBIXMZ,DVBUSER,R,DVBCS,%DT,DVBTO,DVBFR
"RTN","DVBHQZ6",10,0)
K1 K DVBAL,DVBLP2,DVBIO,DVBLP1,DVBLP1,DVB,DVBMM,DVBJIO I '$D(ZTSK) X ^%ZIS("C")
"RTN","DVBHQZ6",11,0)
 Q
"RTN","DVBHQZ6",12,0)
M S DVB="",DIC="^DVB(395.5,",DIC(0)="AEMZQ"
"RTN","DVBHQZ6",13,0)
 S DIC("S")="I $D(^(""RS"",0))",DIC("A")="Select patient from ""HINQ Suspense file"":"
"RTN","DVBHQZ6",14,0)
 F DVBLP=1:1 D ^DIC Q:Y'>0  S DVB=DVB_+Y_"^"
"RTN","DVBHQZ6",15,0)
 K DIC I Y'>0,DVB="" Q
"RTN","DVBHQZ6",16,0)
 W ! S ZTRTN="M1^DVBHQZ6",ZTSAVE("DVB")=DVB,ZTSAVE("DVBLP")=DVBLP S:$D(DVBMM2) ZTSAVE("DVBMM2")=DVBMM2 S:$D(DVBMM) ZTSAVE("DVBMM")=DVBMM D LD:'$D(DVBMM1) Q:$D(IO("Q"))!(POP)
"RTN","DVBHQZ6",17,0)
M1 F DVBLP1=1:1:DVBLP-1 S DFN=$P(DVB,U,DVBLP1),DVBJIO=$S(IO'=IO(0):IO,1:IO(0)) I $D(^DVB(395.5,DFN,0)),($D(^("RS"))) D TEM^DVBHIQR D:'$D(DVBERCS) EN^DVBHIQM,WRT1^DVBHQD1:'$D(DVBMM1) W:$D(DVBMM1) "." Q:X="^"
"RTN","DVBHQZ6",18,0)
 Q
"RTN","DVBHQZ6",19,0)
 ;
"RTN","DVBHQZ6",20,0)
DT S %DT="TAEP",%DT("A")="From:" D ^%DT Q:Y<0  S DVBFR=Y,%DT("A")="To:" D ^%DT Q:Y<0  I DVBFR>Y W !,*7,*7,"TO date cannot be earlier than FROM date." G DT
"RTN","DVBHQZ6",21,0)
 S DVBTO=9999999-(Y+.2400),DVBFR=9999999-(DVBFR-.000001) K %DT Q
"RTN","DVBHQZ6",22,0)
 ;
"RTN","DVBHQZ6",23,0)
R S DIC(0)="AQME",DIC=200 D ^DIC Q:Y<0  S DVBAL=+Y
"RTN","DVBHQZ6",24,0)
 D DT Q:'$D(DVBFR)!('$D(DVBTO))
"RTN","DVBHQZ6",25,0)
 S ZTSAVE("DVBMM2")=DVBMM2,ZTSAVE("DVBMM")=DVBMM,ZTSAVE("DVBAL")=DVBAL,ZTSAVE("DVBFR")=DVBFR,ZTSAVE("DVBTO")=DVBTO,ZTRTN="R1^DVBHQZ6" D LD Q:$D(IO("Q"))!(POP)
"RTN","DVBHQZ6",26,0)
R1 S X="" F DVBLP=DVBTO:0:9999999 S DVBLP=$O(^DVB(395.5,"C",DVBLP)) Q:DVBLP>DVBFR!(X="^")!('DVBLP)  F DFN=0:0 S DFN=$O(^DVB(395.5,"C",DVBLP,DFN)) Q:'DFN!(X="^")  I $D(^DVB(395.5,"D",DVBAL,DFN,DVBAL)),$D(^DVB(395.5,DFN,0)),$D(^("RS")) D R3
"RTN","DVBHQZ6",27,0)
 Q
"RTN","DVBHQZ6",28,0)
 ;
"RTN","DVBHQZ6",29,0)
R3 S DVBJIO=$S(IO'=IO(0):IO,1:IO(0)) D TEM^DVBHIQR D:'$D(DVBERCS) EN^DVBHIQM,WRT1^DVBHQD1 Q
"RTN","DVBHQZ6",30,0)
 ;
"RTN","DVBHQZ6",31,0)
D D DT Q:'$D(DVBFR)!('$D(DVBTO))
"RTN","DVBHQZ6",32,0)
 S ZTSAVE("DVBMM2")=DVBMM2,ZTSAVE("DVBMM")=DVBMM,ZTSAVE("DVBFR")=DVBFR,ZTSAVE("DVBTO")=DVBTO,ZTRTN="D1^DVBHQZ6" D LD Q:$D(IO("Q"))!(POP)
"RTN","DVBHQZ6",33,0)
D1 S X="" F DVBLP=DVBTO:0:9999999 S DVBLP=$O(^DVB(395.5,"C",DVBLP)) Q:DVBLP>DVBFR!(X="^")!('DVBLP)  F DFN=0:0 S DFN=$O(^DVB(395.5,"C",DVBLP,DFN)) Q:'DFN!(X="^")  I $D(^DVB(395.5,DFN,0)),$D(^("RS")) D R3
"RTN","DVBHQZ6",34,0)
 Q
"RTN","DVBHQZ6",35,0)
 ;
"RTN","DVBHQZ6",36,0)
EM W !!,"Do you wish to create a mail message, to be sent to the requestors" S %=2 D YN^DICN I %=0 W *7,!,"'YES' to create a mail message  'NO' will not" G EM
"RTN","DVBHQZ6",37,0)
 I %=1 S DVBMM1=1,POP=0 D M W:$D(DVBLP1) !,"Mail Sent."
"RTN","DVBHQZ6",38,0)
 D K Q
"RTN","DVBHQZ6",39,0)
 ;
"RTN","DVBHQZ6",40,0)
LD S %IS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) S ZTDESC="This is the HINQ Print/Mail option.",ZTIO=ION D ^%ZTLOAD X ^%ZIS("C")
"RTN","DVBHQZ6",41,0)
 Q
"RTN","DVBHQZ6",42,0)
 ;
"RTN","DVBHQZ6",43,0)
S1 ;
"RTN","DVBHQZ6",44,0)
 I $D(DVBDX) D LABELS^DVBHS3
"RTN","DVBHQZ6",45,0)
 F JU=0:0 S JU=$O(DVBDX(JU)) Q:'JU  I +DVBDX(JU),DVBDX(JU)'["-" D S2
"RTN","DVBHQZ6",46,0)
 Q
"RTN","DVBHQZ6",47,0)
S2 I ($Y+5)>IOSL,$E(IOST,1,2)="C-" D PAUSE^DVBHS3
"RTN","DVBHQZ6",48,0)
 I $G(QUIT)=1 Q
"RTN","DVBHQZ6",49,0)
 W !,$S($P(DVBDX(JU),U,2)="":$P(DVBDX(JU),U),$D(^DIC(31,$P(DVBDX(JU),U,2),0)):$E($P(^(0),U),1,40),1:"")
"RTN","DVBHQZ6",50,0)
 W ?42,$S($P(DVBDX(JU),U,3)="X0":100,1:+$P(DVBDX(JU),U,3))
"RTN","DVBHQZ6",51,0)
 W ?50,$P($G(DVBDX(JU)),U,4),?55,$P($G(DVBDX(JU)),U,5),?68,$P($G(DVBDX(JU)),U,6)
"RTN","DVBHQZ6",52,0)
 K QUIT
"RTN","DVBHQZ6",53,0)
 Q
"RTN","DVBHQZ6",54,0)
 ;
"RTN","DVBHQZ6",55,0)
QB S %=2 W !!,"Would you like a HINQ message printed out " D YN^DICN I %<0!(%=2) Q
"RTN","DVBHQZ6",56,0)
 I '% W !!,"A YES will result in a HINQ printout queued to the device you select." G QB
"RTN","DVBHQZ6",57,0)
 W !,"I will queue all messages!"
"RTN","DVBHQZ6",58,0)
 K IOP S %IS="NMQ",%IS("B")="" D ^%ZIS K %IS I POP W !,"No printout queued!" G EX
"RTN","DVBHQZ6",59,0)
 S IOP=ION_";"_IOST_$S($D(IO("DOC")):";"_IO("DOC"),1:";"_IOM_";"_IOSL)
"RTN","DVBHQZ6",60,0)
 I IO=IO(0) W !,"Can not queue to your HOME device." G QB
"RTN","DVBHQZ6",61,0)
 I IO'=IO(0),'$D(IO("Q")) W !,"I am QUEUEING this report to run now." S IO("Q")=1,ZTDTH=$H
"RTN","DVBHQZ6",62,0)
 S DVBMM2=1,ZTRTN="M1^DVBHQZ6",ZTIO=IOP,ZTSAVE("DVB")=DVB,ZTSAVE("DVBLP")=DVBLP,ZTSAVE("DVBMM")=DVBMM,ZTSAVE("DVBMM2")=DVBMM2,ZTDESC="This is the HINQ report." K IO("Q") D ^%ZTLOAD
"RTN","DVBHQZ6",63,0)
EX S IOP="HOME" D ^%ZIS K DVB,DVBLP,DVBMM,DVBMM2,ZTRTN,ZTIO,ZTSAVE,ZTDESC,IOP Q
"RTN","DVBHS2")
0^12^B10155550
"RTN","DVBHS2",1,0)
DVBHS2 ;ALB/JLU;This is the display for screen 2 ;10/7/91
"RTN","DVBHS2",2,0)
 ;;4.0;HINQ;**11,17,49**;03/25/92 
"RTN","DVBHS2",3,0)
 ;
"RTN","DVBHS2",4,0)
 N Y
"RTN","DVBHS2",5,0)
 K DVBX(1)
"RTN","DVBHS2",6,0)
 F LP2=.02,.03,.293,.314,.351,.525,.313,.305 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHS2",7,0)
 I $D(X(1)) S DVBX(1)=X(1)
"RTN","DVBHS2",8,0)
 S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHS2",9,0)
 S DR=".02;.03;.293;.313;.314;.351;.525;.305"
"RTN","DVBHS2",10,0)
 D EN^DIQ1
"RTN","DVBHS2",11,0)
 I $D(DVBX(1)) S X(1)=DVBX(1) K DVBX(1)
"RTN","DVBHS2",12,0)
 ;
"RTN","DVBHS2",13,0)
 S DVBSCRN=2 D SCRHD^DVBHUTIL
"RTN","DVBHS2",14,0)
 S DVBJS=28
"RTN","DVBHS2",15,0)
 ;
"RTN","DVBHS2",16,0)
 W !,DVBON,"[1]",DVBOFF X DVBLIT1
"RTN","DVBHS2",17,0)
 W ?4,"Claim Num. :"
"RTN","DVBHS2",18,0)
 W ?19,DVBDIQ(2,DFN,.313,"E")
"RTN","DVBHS2",19,0)
 I $D(DVBCN),DVBCN W ?49,DVBCN
"RTN","DVBHS2",20,0)
 ;
"RTN","DVBHS2",21,0)
 W !,DVBON,"[2]",DVBOFF X DVBLIT1
"RTN","DVBHS2",22,0)
 W ?4,"Date of Birth:"
"RTN","DVBHS2",23,0)
 W ?19,DVBDIQ(2,DFN,.03,"E")
"RTN","DVBHS2",24,0)
 I $D(DVBDOB),DVBDOB I DVBDOB?8N S M=$E(DVBDOB,1,2) D MM^DVBHQM11 W ?49,M_" "_$S(+$E(DVBDOB,3,4)>0:$E(DVBDOB,3,4)_", ",1:" ")_$E(DVBDOB,5,8) K M
"RTN","DVBHS2",25,0)
 ;
"RTN","DVBHS2",26,0)
 W !,DVBON,"[3]",DVBOFF X DVBLIT1
"RTN","DVBHS2",27,0)
 W ?4,"Sex:"
"RTN","DVBHS2",28,0)
 W ?19,DVBDIQ(2,DFN,.02,"E")
"RTN","DVBHS2",29,0)
 I $D(DVBVET),$P(DVBVET,U,1)'="C" W ?49,$S($P(DVBVET,U,3)="M":"MALE",$P(DVBVET,U,3)="F":"FEMALE",1:"")
"RTN","DVBHS2",30,0)
 E  I $D(DVBBIR) W ?49,$S($P(DVBBIR,U,25)="M":"MALE",$P(DVBBIR,U,25)="F":"FEMALE",1:"")
"RTN","DVBHS2",31,0)
 ;
"RTN","DVBHS2",32,0)
 W !,DVBON,"[4]",DVBOFF X DVBLIT1
"RTN","DVBHS2",33,0)
 W ?4,"Date of Death:"
"RTN","DVBHS2",34,0)
 W ?19,DVBDIQ(2,DFN,.351,"E")
"RTN","DVBHS2",35,0)
 I $D(DVBVET),$P(DVBVET,U,1)="B",+$P(DVBVET,U,12),$P(DVBVET,U,12)?8N S M2=$P(DVBVET,U,12),M=$E(M2,5,6) D MM^DVBHQM11 W ?49,M_" "_$E(M2,7,8)_", "_$E(M2,1,4) K M,M2 I 1
"RTN","DVBHS2",36,0)
 E  I $D(DVBP(6)),(+$P(DVBP(6),U)),$P(DVBP(6),U)?8N S M=$E(DVBP(6),1,2) D MM^DVBHQM11 W ?49,M_" "_$S(+$E(DVBP(6),3,4)>0:$E(DVBP(6),3,4)_", ",1:" ")_$E(DVBP(6),5,8) K M
"RTN","DVBHS2",37,0)
 ;
"RTN","DVBHS2",38,0)
 W !,DVBON,"[5]",DVBOFF X DVBLIT1
"RTN","DVBHS2",39,0)
 W ?4,"Rated Incomp.:"
"RTN","DVBHS2",40,0)
 W ?19,DVBDIQ(2,DFN,.293,"E")
"RTN","DVBHS2",41,0)
 I $D(DVBCI) W ?49,$S("1"[DVBCI!(DVBCI="C"):"Competent, or not an issue",DVBCI="I"!(DVBCI=2):"Incompetent",1:DVBCI)
"RTN","DVBHS2",42,0)
 ;
"RTN","DVBHS2",43,0)
 W !,DVBON,"[6]",DVBOFF X DVBLIT1
"RTN","DVBHS2",44,0)
 W ?4,"POW:"
"RTN","DVBHS2",45,0)
 W ?19,DVBDIQ(2,DFN,.525,"E")
"RTN","DVBHS2",46,0)
 W ?49
"RTN","DVBHS2",47,0)
 W $S('$D(DVBPOW):"No POW Ind.",DVBPOW=0:"No Prisoner of war",DVBPOW=1:"30 days or fewer",DVBPOW=2:"more than 30 days",DVBPOW=" ":"Not applicable",1:DVBPOW),"/"
"RTN","DVBHS2",48,0)
 W $S('$D(DVBPOWD):"No POW Days Ind.",1:DVBPOWD)
"RTN","DVBHS2",49,0)
 ;
"RTN","DVBHS2",50,0)
 ;
"RTN","DVBHS2",51,0)
 W !,DVBON,"[7]",DVBOFF X DVBLIT1
"RTN","DVBHS2",52,0)
 W ?4,"Folder Loc. :"
"RTN","DVBHS2",53,0)
 W ?19,DVBDIQ(2,DFN,.314,"E")
"RTN","DVBHS2",54,0)
 I $D(DVBFL) W ?49,DVBFL
"RTN","DVBHS2",55,0)
 ;
"RTN","DVBHS2",56,0)
 W !,DVBON,"[8]",DVBOFF X DVBLIT1
"RTN","DVBHS2",57,0)
 W ?4,"Unemployable:"
"RTN","DVBHS2",58,0)
 I $D(DVBDIQ(2,DFN,.305,"E")) W ?19,DVBDIQ(2,DFN,.305,"E")
"RTN","DVBHS2",59,0)
 I $D(DVBEI) W ?49,$S(DVBEI=1!(DVBEI="N"):"Employable",DVBEI=2!(DVBEI="Y"):"Unemployable",1:DVBEI)
"RTN","DVBHS2",60,0)
 K Y
"RTN","DVBHS2",61,0)
 Q
"RTN","DVBHS3")
0^13^B13169365
"RTN","DVBHS3",1,0)
DVBHS3 ; ALB/JLU;Routine for HINQ screen 3 ; 8/22/05 9:46pm
"RTN","DVBHS3",2,0)
 ;;4.0;HINQ;**49**;03/25/92 
"RTN","DVBHS3",3,0)
 ;
"RTN","DVBHS3",4,0)
 K DVBX(1)
"RTN","DVBHS3",5,0)
 F LP2=.322,.32101 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHS3",6,0)
 K DVBDIQ(2.04)
"RTN","DVBHS3",7,0)
 I $D(X(1)) S DVBX(1)=X(1)
"RTN","DVBHS3",8,0)
 S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHS3",9,0)
 S DR=".302;.3014;.322;.32101;.361"
"RTN","DVBHS3",10,0)
 D EN^DIQ1
"RTN","DVBHS3",11,0)
 S DR=".3721",DR(2.04)=".01;2:6",DIQ(0)="IE"
"RTN","DVBHS3",12,0)
 F LP=0:0 S LP=$O(^DPT(DFN,.372,LP)) Q:'LP  S DA(2.04)=LP D EN^DIQ1
"RTN","DVBHS3",13,0)
 I $D(DVBX(1)) S X(1)=DVBX(1) K DVBX(1)
"RTN","DVBHS3",14,0)
 S DVBSCRN=3 D SCRHD^DVBHUTIL
"RTN","DVBHS3",15,0)
 S DVBJS=35
"RTN","DVBHS3",16,0)
 ;
"RTN","DVBHS3",17,0)
 ;DVB*4*49 - Combat Disability removed - Combined % Disability okay
"RTN","DVBHS3",18,0)
 ;W !?11,"Comb. % Disab.: "
"RTN","DVBHS3",19,0)
 ;I $D(DVBDXPCT) W +DVBDXPCT
"RTN","DVBHS3",20,0)
 W !,"Act. Duty Training: "
"RTN","DVBHS3",21,0)
 I $D(DVBBIR) W $S($P(DVBBIR,U,24)["Y":"YES",$P(DVBBIR,U,24)["N":"NO",1:"")
"RTN","DVBHS3",22,0)
 ;as of DVB*4*49 Additional Service is no longer being sent by VBA
"RTN","DVBHS3",23,0)
 ;
"RTN","DVBHS3",24,0)
 W ?24,"Tot. Act. Ser.: "
"RTN","DVBHS3",25,0)
 I $D(DVBTOTAS) W ?40,DVBTOTAS
"RTN","DVBHS3",26,0)
 ;
"RTN","DVBHS3",27,0)
 W ?63,"Perm. & Tot.: "
"RTN","DVBHS3",28,0)
 ;DVB*4*49 - P&T now being sent by VBA. 3=yes,2=no, else null
"RTN","DVBHS3",29,0)
 I $D(DVBPTI) W ?56,$S(DVBPTI=2:"No",DVBPTI=3:"Yes",1:"")
"RTN","DVBHS3",30,0)
 ;
"RTN","DVBHS3",31,0)
 W !,DVBON,"[1]",DVBOFF X DVBLIT1
"RTN","DVBHS3",32,0)
 W ?4,"Ver. SVC data: "
"RTN","DVBHS3",33,0)
 W ?21,DVBDIQ(2,DFN,.322,"E")
"RTN","DVBHS3",34,0)
 I $D(DVBP(6)) W ?49,$S($P(DVBP(6),U,8)["Y":"YES",$P(DVBP(6),U,8)["N":"NO",1:"")
"RTN","DVBHS3",35,0)
 ;
"RTN","DVBHS3",36,0)
 W !,DVBON,"[2]",DVBOFF X DVBLIT1
"RTN","DVBHS3",37,0)
 W ?4,"Vietnam Ser.:"
"RTN","DVBHS3",38,0)
 W ?21,DVBDIQ(2,DFN,.32101,"E")
"RTN","DVBHS3",39,0)
 I $D(DVBP(6)) W ?49,$S($P(DVBP(6),U,4)["Y":"YES",$P(DVBP(6),U,4)["N":"NO",1:"")
"RTN","DVBHS3",40,0)
 ;
"RTN","DVBHS3",41,0)
 W !,DVBON,"[3]",DVBOFF X DVBLIT1
"RTN","DVBHS3",42,0)
 W ?4,"Rated Disab.(Pat. File)-Comb. SC%: "
"RTN","DVBHS3",43,0)
 I DVBDIQ(2,DFN,.361,"E")'="NSC" W ?37,$S(DVBDIQ(2,DFN,.302,"E")]"":+DVBDIQ(2,DFN,.302,"E"),1:"")
"RTN","DVBHS3",44,0)
 ;W ?37,+DVBDIQ(2,DFN,.302,"E")
"RTN","DVBHS3",45,0)
 W ?42,"Eff. Date Comb. Eval.: "_DVBDIQ(2,DFN,.3014,"E")
"RTN","DVBHS3",46,0)
 I $P($G(^DPT(DFN,.372,0)),U,3)>0 D LABELS
"RTN","DVBHS3",47,0)
 I $D(DVBDIQ(2.04)) F LP=0:0 S LP=$O(DVBDIQ(2.04,LP)) Q:'LP  D
"RTN","DVBHS3",48,0)
 . I ($Y+5)>IOSL,$E(IOST,1,2)="C-" D PAUSE
"RTN","DVBHS3",49,0)
 . W !,$E(DVBDIQ(2.04,LP,.01,"E"),1,40),?42,DVBDIQ(2.04,LP,2,"E")
"RTN","DVBHS3",50,0)
 . W ?50,$G(DVBDIQ(2.04,LP,4,"I")),?55,$G(DVBDIQ(2.04,LP,5,"E"))
"RTN","DVBHS3",51,0)
 . W ?68,$G(DVBDIQ(2.04,LP,6,"E"))
"RTN","DVBHS3",52,0)
 N DVBEDT
"RTN","DVBHS3",53,0)
 I +$G(DVBEFF)>0 S M=$E(DVBEFF,1,2) D MM^DVBHQM11 S DVBEDT=M_" "_$E(DVBEFF,3,4)_","_$E(DVBEFF,5,8)
"RTN","DVBHS3",54,0)
 W !,?4,"Rated Disab. (HINQ)-     Comb. SC%: "
"RTN","DVBHS3",55,0)
 W ?39,$S($G(DVBDXPCT)]"":+DVBDXPCT,1:"")
"RTN","DVBHS3",56,0)
 W ?44,"Eff. Date Comb. Eval.: "_$G(DVBEDT)
"RTN","DVBHS3",57,0)
 I $D(DVBDX)>9 D S1^DVBHQZ6
"RTN","DVBHS3",58,0)
 Q
"RTN","DVBHS3",59,0)
PAUSE ;
"RTN","DVBHS3",60,0)
 N DIR
"RTN","DVBHS3",61,0)
 S DIR(0)="E" D ^DIR
"RTN","DVBHS3",62,0)
 I ('(+Y))!$D(DIRUT) S QUIT=1
"RTN","DVBHS3",63,0)
 W @IOF,!
"RTN","DVBHS3",64,0)
 Q
"RTN","DVBHS3",65,0)
CHKDIS ;check to see if any of the disabilities comng from VBA are absent
"RTN","DVBHS3",66,0)
 ;from the VistA DISABILITY CONDITION file (#31)
"RTN","DVBHS3",67,0)
 Q
"RTN","DVBHS3",68,0)
 N DVBC,DVBERR
"RTN","DVBHS3",69,0)
 S (DVBC,DVBERR)=0
"RTN","DVBHS3",70,0)
 F  S DVBC=$O(DVBDX(DVBC)) Q:DVBC'>0  D
"RTN","DVBHS3",71,0)
 . N DVBDIS,DVBDISAB
"RTN","DVBHS3",72,0)
 . S DVBDISAB=$P(DVBDX(DVBC),U)
"RTN","DVBHS3",73,0)
 . S DVBDIS=$O(^DIC(31,"C",DVBDISAB,""))
"RTN","DVBHS3",74,0)
 . I $G(DVBDIS)']"" W !,"Disability code "_DVBDISAB_" is missing from this site's DISABILITY",!,"CONDITIONS file (#13).  "_DVBDISAB_" not updated to VistA.  Check with ADPAC." S DVBERR=1
"RTN","DVBHS3",75,0)
 I $G(DVBERR)=0 Q
"RTN","DVBHS3",76,0)
 N DVBANS
"RTN","DVBHS3",77,0)
 R !,"Hit any key to continue: ",DVBANS:DTIME
"RTN","DVBHS3",78,0)
 Q 
"RTN","DVBHS3",79,0)
CHKEFF(DVBDT) ;
"RTN","DVBHS3",80,0)
 Q:$G(DVBDT)']""
"RTN","DVBHS3",81,0)
 F DVBE=1:1:4 I $E(DVBDT,1)=" " S DVBDT=$E(DVBDT,2,8)
"RTN","DVBHS3",82,0)
 I DVBDT'?1.8N S DVBDT="" Q
"RTN","DVBHS3",83,0)
 D
"RTN","DVBHS3",84,0)
 . S DVBOFFST="00000000"
"RTN","DVBHS3",85,0)
 . S DVBDT=$E(DVBOFFST,1,8-$L(DVBDT))_DVBDT
"RTN","DVBHS3",86,0)
 . I +DVBDT?5.6N S DVBDT=$E(DVBDT,3,4)_"00"_$E(DVBDT,5,8)
"RTN","DVBHS3",87,0)
 S DVBDT=($E(DVBDT,5,8)-1700)_$E(DVBDT,1,2)_$E(DVBDT,3,4)
"RTN","DVBHS3",88,0)
 Q
"RTN","DVBHS3",89,0)
LABELS ;
"RTN","DVBHS3",90,0)
 W !?55,"Original",?68,"Current"
"RTN","DVBHS3",91,0)
 W !?3,"Disability",?43,"%",?49,"Extr.",?54,"Eff. Date",?67,"Eff. Date"
"RTN","DVBHS3",92,0)
 Q
"RTN","DVBHS4")
0^26^B10613271
"RTN","DVBHS4",1,0)
DVBHS4 ; ALB/JLU;Routine for HINQ screen 4 ;10/04/91
"RTN","DVBHS4",2,0)
 ;;4.0;HINQ;**4,49**;03/25/92 
"RTN","DVBHS4",3,0)
 ;
"RTN","DVBHS4",4,0)
 N Y
"RTN","DVBHS4",5,0)
 K DVBX(1)
"RTN","DVBHS4",6,0)
 F LP2=.323,.324,.328,.329,.3291,.3299 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHS4",7,0)
 I $D(X(1)) S DVBX(1)=X(1)
"RTN","DVBHS4",8,0)
 S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHS4",9,0)
 S DR=".323;.324:.328;.329;.3291:.3299"
"RTN","DVBHS4",10,0)
 D EN^DIQ1
"RTN","DVBHS4",11,0)
 I $D(DVBX(1)) S X(1)=DVBX(1) K DVBX(1)
"RTN","DVBHS4",12,0)
 ;
"RTN","DVBHS4",13,0)
 S DVBSCRN=4 D SCRHD^DVBHUTIL
"RTN","DVBHS4",14,0)
 S DVBJS=44
"RTN","DVBHS4",15,0)
 W ?325,DVBON,"HINQ Data",DVBOFF
"RTN","DVBHS4",16,0)
 W !,?5,"EOD",?17,"RAD",?27,"Bran. Ser.",?44,"Char. Ser.",?69,"Ser. Num."
"RTN","DVBHS4",17,0)
 D LINE
"RTN","DVBHS4",18,0)
 ;
"RTN","DVBHS4",19,0)
 ;DVB*4*49 - all MS data should be in the BIRLS segment, so if second 
"RTN","DVBHS4",20,0)
 ;node of all these arrays is populated, kill the first node
"RTN","DVBHS4",21,0)
 I +$G(DVBEOD(2))>0 K DVBEOD(1)
"RTN","DVBHS4",22,0)
 I +$G(DVBRAD(2))>0 K DVBRAD(1)
"RTN","DVBHS4",23,0)
 I $G(DVBBOS(2))]"" K DVBBOS(1)
"RTN","DVBHS4",24,0)
 I $G(DVBCSVC(2))]"" K DVBCSVC(1)
"RTN","DVBHS4",25,0)
 I $G(DVBSN(2))]"" K DVBSN(1)
"RTN","DVBHS4",26,0)
 W ! I $D(DVBEOD(1)),DVBEOD(1)?8N S M=$E(DVBEOD(1),1,2) D MM^DVBHQM11 W M," ",$E(DVBEOD(1),3,4),",",$E(DVBEOD(1),5,8)
"RTN","DVBHS4",27,0)
 I $D(DVBRAD(1)),DVBRAD(1)?8N S M=$E(DVBRAD(1),1,2) D MM^DVBHQM11 W ?14,M," ",$E(DVBRAD(1),3,4),",",$E(DVBRAD(1),5,8)
"RTN","DVBHS4",28,0)
 I $D(DVBBOS(1)) S Y=DVBBOS(1) D XBOS^DVBHQM12 S Y=$E(Y,1,16) W ?27,Y
"RTN","DVBHS4",29,0)
 I $D(DVBCSVC(1)) S I=1,Y=DVBCSVC(1) D DISCHG^DVBHQM1 W ?44,Y K Y
"RTN","DVBHS4",30,0)
 I $D(DVBSN(1)) W ?69,DVBSN(1)
"RTN","DVBHS4",31,0)
 W ! I $D(DVBEOD(2)),DVBEOD(2)?7N S Y=DVBEOD(2) X ^DD("DD") W ?1,Y K Y
"RTN","DVBHS4",32,0)
 I $D(DVBRAD(2)),DVBRAD(2)?7N S Y=DVBRAD(2) X ^DD("DD") W ?14,Y K Y
"RTN","DVBHS4",33,0)
 I $D(DVBBOS(2)) S Y=DVBBOS(2) D XBOS^DVBHQM12 S Y=$E(Y,1,16) W ?27,Y
"RTN","DVBHS4",34,0)
 I $D(DVBCSVC(2)) S Y=$$DISCH2^DVBHQM1(DVBCSVC(2)) W ?44,Y K Y
"RTN","DVBHS4",35,0)
 I $D(DVBSN(2)) W ?69,DVBSN(2)
"RTN","DVBHS4",36,0)
 W ! I $D(DVBEOD(3)),DVBEOD(3)?7N S Y=DVBEOD(3) X ^DD("DD") W ?1,Y K Y
"RTN","DVBHS4",37,0)
 I $D(DVBRAD(3)),DVBRAD(3)?7N S Y=DVBRAD(3) X ^DD("DD") W ?14,Y K Y
"RTN","DVBHS4",38,0)
 I $D(DVBBOS(3)) S Y=DVBBOS(3) D XBOS^DVBHQM12 S Y=$E(Y,1,16) W ?27,Y
"RTN","DVBHS4",39,0)
 I $D(DVBCSVC(3)) S Y=$$DISCH2^DVBHQM1(DVBCSVC(3)) W ?44,Y K Y
"RTN","DVBHS4",40,0)
 I $D(DVBSN(3)) W ?69,DVBSN(3)
"RTN","DVBHS4",41,0)
 W ! I $D(DVBEOD(4)),DVBEOD(4)?7N S Y=DVBEOD(4) X ^DD("DD") W ?1,Y K Y
"RTN","DVBHS4",42,0)
 I $D(DVBRAD(4)),DVBRAD(4)?7N S Y=DVBRAD(4) X ^DD("DD") W ?14,Y K Y
"RTN","DVBHS4",43,0)
 I $D(DVBBOS(4)) S Y=DVBBOS(4) D XBOS^DVBHQM12 S Y=$E(Y,1,16) W ?27,Y
"RTN","DVBHS4",44,0)
 I $D(DVBCSVC(4)) S Y=$$DISCH2^DVBHQM1(DVBCSVC(4)) W ?44,Y K Y
"RTN","DVBHS4",45,0)
 I $D(DVBSN(4)) W ?69,DVBSN(4)
"RTN","DVBHS4",46,0)
 I $D(DVBSCR) K DVBSCR D LINE W ! Q
"RTN","DVBHS4",47,0)
 W !,?34,DVBON,"Patient File",DVBOFF
"RTN","DVBHS4",48,0)
 D LINE
"RTN","DVBHS4",49,0)
 W !,DVBON,"(1)",DVBOFF," Last episode"
"RTN","DVBHS4",50,0)
 W !,DVBDIQ(2,DFN,.326,"E")
"RTN","DVBHS4",51,0)
 W ?15,DVBDIQ(2,DFN,.327,"E")
"RTN","DVBHS4",52,0)
 W ?34,$E(DVBDIQ(2,DFN,.325,"E"),1,30)
"RTN","DVBHS4",53,0)
 W ?51,$E(DVBDIQ(2,DFN,.324,"E"),1,14)
"RTN","DVBHS4",54,0)
 W ?67,$E(DVBDIQ(2,DFN,.328,"E"),1,10)
"RTN","DVBHS4",55,0)
 W !,DVBON,"(2)",DVBOFF," NTL episode"
"RTN","DVBHS4",56,0)
 W !,DVBDIQ(2,DFN,.3292,"E")
"RTN","DVBHS4",57,0)
 W ?15,DVBDIQ(2,DFN,.3293,"E")
"RTN","DVBHS4",58,0)
 W ?34,$E(DVBDIQ(2,DFN,.3291,"E"),1,30)
"RTN","DVBHS4",59,0)
 W ?51,$E(DVBDIQ(2,DFN,.329,"E"),1,14)
"RTN","DVBHS4",60,0)
 W ?67,$E(DVBDIQ(2,DFN,.3294,"E"),1,10)
"RTN","DVBHS4",61,0)
 W !,DVBON,"(3)",DVBOFF," NNTL episode"
"RTN","DVBHS4",62,0)
 W !,DVBDIQ(2,DFN,.3297,"E")
"RTN","DVBHS4",63,0)
 W ?15,DVBDIQ(2,DFN,.3298,"E")
"RTN","DVBHS4",64,0)
 W ?34,$E(DVBDIQ(2,DFN,.3296,"E"),1,30)
"RTN","DVBHS4",65,0)
 W ?51,$E(DVBDIQ(2,DFN,.3295,"E"),1,14)
"RTN","DVBHS4",66,0)
 W ?67,$E(DVBDIQ(2,DFN,.3299,"E"),1,10)
"RTN","DVBHS4",67,0)
 W !,DVBON,"(4)",DVBOFF X DVBLIT1
"RTN","DVBHS4",68,0)
 W ?4,"Per. of Ser.:",?18,$E(DVBDIQ(2,DFN,.323,"E"),1,25)
"RTN","DVBHS4",69,0)
 Q
"RTN","DVBHS4",70,0)
LINE W !,"-------------------------------------------------------------------------------"
"RTN","DVBHS4",71,0)
 Q
"RTN","DVBHS5")
0^14^B9648917
"RTN","DVBHS5",1,0)
DVBHS5 ; ALB/JLU;Routine for HINQ screen 5 ; 7/13/05 12:58pm
"RTN","DVBHS5",2,0)
 ;;4.0;HINQ;**12,11,20,49**;03/25/92
"RTN","DVBHS5",3,0)
 N Y
"RTN","DVBHS5",4,0)
 K DVBX(1)
"RTN","DVBHS5",5,0)
 K DVBDIQ ;F LP2=.3611,.3616,.3612,.306,.3615,391,1901,.301,.302,.361,.36205,.3621,.36235,.3624,.36215,.3622,.36295,.3025,.303 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHS5",6,0)
 I $D(X(1)) S DVBX(1)=X(1)
"RTN","DVBHS5",7,0)
 S DIC="^DPT(",DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHS5",8,0)
 ;S DR=".01;.09;.3611;.3616;.3612;.306;.3615;391;1901;.301;.302;.361;.36205;.3621;.36235;.3624;.36215;.3622;.36295;.3025;.303"
"RTN","DVBHS5",9,0)
 S DR=".01;.09;.3611;.3616;.3612;.306;.3615;391;1901;.301;.302;.361;.36205;.36235;.36215;.36295;.3025"
"RTN","DVBHS5",10,0)
 D EN^DIQ1
"RTN","DVBHS5",11,0)
 I $D(DVBX(1)) S X(1)=DVBX(1) K DVBX(1)
"RTN","DVBHS5",12,0)
 ;
"RTN","DVBHS5",13,0)
 S DVBSCRN=5 D SCRHD^DVBHUTIL
"RTN","DVBHS5",14,0)
 S DVBJS=53
"RTN","DVBHS5",15,0)
 W !,"Check Amt.: ",$S($D(DVBCHECK):"$"_DVBCHECK,1:"")
"RTN","DVBHS5",16,0)
 W ?28,"Combined %: ",$S($D(DVBDXPCT):+DVBDXPCT_"%",1:"")
"RTN","DVBHS5",17,0)
 W ?48,"Net Award Amt.: ",$S($D(DVBBAS(1)):"$"_$P(DVBBAS(1),U,20),1:"")
"RTN","DVBHS5",18,0)
 I $D(DVBP(1)) S T1=$P(DVBP(1),U,4)
"RTN","DVBHS5",19,0)
 ;with DVB*4*49, VBA no longer sending entitlement code, so a type
"RTN","DVBHS5",20,0)
 ;benefit is being calculated and displayed where entitlement code was
"RTN","DVBHS5",21,0)
 S DVBENT=$S($G(T1)="01":"Compensation",$G(T1)="0L":"Pension",1:"")
"RTN","DVBHS5",22,0)
 K T1,T2 W !,"Benefit Type:",?15,$S($D(DVBENT):DVBENT,1:"")
"RTN","DVBHS5",23,0)
 W ?40,"Income for VA Purposes: $"_$S($P($G(DVBINC),U,15)>0:$P(DVBINC,U,15)_".00",1:"0.00")
"RTN","DVBHS5",24,0)
 W !,"Aid & Attendance: " I $D(DVBAAHB) S Y=DVBAAHB D AAA^DVBHQM2 W Y
"RTN","DVBHS5",25,0)
 ;;;W !,"Rated (HINQ) Disabilities:" I $D(DVBDXNO),DVBDXNO'=0 D S1^DVBHQZ6
"RTN","DVBHS5",26,0)
 I $D(DVBSCR) K DVBSCR D LINE Q
"RTN","DVBHS5",27,0)
 ;
"RTN","DVBHS5",28,0)
 W !!,"--- ",DVBON,"Patient Data",DVBOFF," ---"
"RTN","DVBHS5",29,0)
 W !,DVBON,"(1)",DVBOFF," Elig. Stat.: ",$E(DVBDIQ(2,DFN,.3611,"E"),1,20) X DVBLIT1
"RTN","DVBHS5",30,0)
 W ?38,"Elig. Stat. ent. by: ",$E(DVBDIQ(2,DFN,.3616,"E"),1,18)
"RTN","DVBHS5",31,0)
 W !,?5,"Stat. date: ",DVBDIQ(2,DFN,.3612,"E")
"RTN","DVBHS5",32,0)
 W ?37,"Monetary Ben. Verif.: ",DVBDIQ(2,DFN,.306,"E")
"RTN","DVBHS5",33,0)
 W !,?3,"Verif. Meth.: ",$E(DVBDIQ(2,DFN,.3615,"E"),1,50)
"RTN","DVBHS5",34,0)
 W ?44,"Patient Elig.: "
"RTN","DVBHS5",35,0)
 I $D(^DPT(DFN,"E",0)),+$P(^(0),U,3) D
"RTN","DVBHS5",36,0)
 . N DVBE1,DVBELIG,DVBER2,DVBQ
"RTN","DVBHS5",37,0)
 . D GETS^DIQ(2,DFN_",","361*","EI","DVBELIG","DVBER2")
"RTN","DVBHS5",38,0)
 . N DVBCT
"RTN","DVBHS5",39,0)
 . S (DVBCT,DVBE1)=""
"RTN","DVBHS5",40,0)
 . S DVBQ=0
"RTN","DVBHS5",41,0)
 . F  S DVBE1=$O(DVBELIG(2.0361,DVBE1)) Q:'DVBE1!(DVBQ=1)  D
"RTN","DVBHS5",42,0)
 . . I DVBELIG(2.0361,DVBE1,.01,"I")'=+^DPT(DFN,"E",0) S DVBOH=DVBELIG(2.0361,DVBE1,.01,"E") S DVBQ=1
"RTN","DVBHS5",43,0)
 W $S($G(DVBOH)]"":$E(DVBOH,1,18),1:"")
"RTN","DVBHS5",44,0)
 W !!,DVBON,"(2)",DVBOFF," Pat. Type: ",$E(DVBDIQ(2,DFN,391,"E"),1,20) X DVBLIT1
"RTN","DVBHS5",45,0)
 W ?36,"Vet.(Y/N)?: ",DVBDIQ(2,DFN,1901,"E")
"RTN","DVBHS5",46,0)
 W !,?4,"Ser. Con.: ",DVBDIQ(2,DFN,.301,"E")
"RTN","DVBHS5",47,0)
 ;W ?40,"Ser. Con. %: ",DVBDIQ(2,DFN,.302,"E")
"RTN","DVBHS5",48,0)
 W ?36,"Elig. Code: ",$E(DVBDIQ(2,DFN,.361,"E"),1,30)
"RTN","DVBHS5",49,0)
 W !!,DVBON,"(3)",DVBOFF,"     A&A: ",DVBDIQ(2,DFN,.36205,"E") X DVBLIT1
"RTN","DVBHS5",50,0)
 ;W ?18,"Amt.: $",$E(DVBDIQ(2,DFN,.3621,"E"),1,11)
"RTN","DVBHS5",51,0)
 W ?41,"VA Pension: ",DVBDIQ(2,DFN,.36235,"E")
"RTN","DVBHS5",52,0)
 ;W ?58,"Amt.: $",$E(DVBDIQ(2,DFN,.3624,"E"),1,11)
"RTN","DVBHS5",53,0)
 W !,"House Bound: ",DVBDIQ(2,DFN,.36215,"E")
"RTN","DVBHS5",54,0)
 ;W ?18,"Amt.: $",$E(DVBDIQ(2,DFN,.3622,"E"),1,11)
"RTN","DVBHS5",55,0)
 W ?38,"VA Disability: ",DVBDIQ(2,DFN,.3025,"E")
"RTN","DVBHS5",56,0)
 ;W ?58,"Amt.: $",$E(DVBDIQ(2,DFN,.303,"E"),1,11)
"RTN","DVBHS5",57,0)
 W !,"Tot.Ann. VA Check Amt.: $",DVBDIQ(2,DFN,.36295,"E")
"RTN","DVBHS5",58,0)
 S NEW=DVBDIQ(2,DFN,.01,"E"),NEW2=DVBDIQ(2,DFN,.09,"E") K DVBDIQ
"RTN","DVBHS5",59,0)
 S DVBDIQ(2,DFN,.01,"E")=NEW,DVBDIQ(2,DFN,.09,"E")=NEW2 K NEW,NEW2 Q
"RTN","DVBHS5",60,0)
LINE W !,"------------------------------------------------------------------------------"
"RTN","DVBHS6")
0^15^B6250521
"RTN","DVBHS6",1,0)
DVBHS6 ;ALB/JLU;Screen six of the HINQ screens ;10/4/91
"RTN","DVBHS6",2,0)
 ;;4.0;HINQ;**11,49**;03/25/92 
"RTN","DVBHS6",3,0)
EN ;Entry point from the edit template.
"RTN","DVBHS6",4,0)
 ;with patch DVB*4*49 the income information will no longer be displayed
"RTN","DVBHS6",5,0)
 ;this code is left here for historical purposes
"RTN","DVBHS6",6,0)
 Q 
"RTN","DVBHS6",7,0)
 N Y
"RTN","DVBHS6",8,0)
 K DVBX(1)
"RTN","DVBHS6",9,0)
 F LP2=.3623,.3628,.36285,.3629 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHS6",10,0)
 I $D(X(1)) S DVBX(1)=X(1)
"RTN","DVBHS6",11,0)
 S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHS6",12,0)
 S DR=".36225;.3628;.36285;.3629"
"RTN","DVBHS6",13,0)
 D EN^DIQ1
"RTN","DVBHS6",14,0)
 I $D(DVBX(1)) S X(1)=DVBX(1) K DVBX(1)
"RTN","DVBHS6",15,0)
 S DVBSCRN=6 D SCRHD^DVBHUTIL
"RTN","DVBHS6",16,0)
 S DVBJS=64
"RTN","DVBHS6",17,0)
 ;
"RTN","DVBHS6",18,0)
 W !,?6,"Amount Earned Annual Income (SPOUSE): "
"RTN","DVBHS6",19,0)
 W $S($D(DVBSPENC):"$"_DVBSPENC,1:"")
"RTN","DVBHS6",20,0)
 W !,?1,"Amount of Annual Social Security (SPOUSE): "
"RTN","DVBHS6",21,0)
 W $S($D(DVBSPSSA):"$"_DVBSPSSA,1:"")
"RTN","DVBHS6",22,0)
 W !,?2,"Type of other Annual Retirement (SPOUSE): "
"RTN","DVBHS6",23,0)
 I $D(DVBSPRET) S V=DVBSPRET D TR W V
"RTN","DVBHS6",24,0)
 W !,"Amount of other Annual Retirement (SPOUSE): "
"RTN","DVBHS6",25,0)
 W $S($D(DVBSPETO):"$"_DVBSPETO,1:"")
"RTN","DVBHS6",26,0)
 W !,?4,"Amount of other Annual Income (SPOUSE): "
"RTN","DVBHS6",27,0)
 W $S($D(DVBSPINC):"$"_DVBSPINC,1:"")
"RTN","DVBHS6",28,0)
 W !!,?4,"Amount of Earned Annual Income (PAYEE): "
"RTN","DVBHS6",29,0)
 W $S($D(DVBEINC):"$"_DVBEINC,1:"")
"RTN","DVBHS6",30,0)
 ;
"RTN","DVBHS6",31,0)
 ;W !!!,DVBON,"[1]",DVBOFF X DVBLIT1
"RTN","DVBHS6",32,0)
 ;W ?4,"Amount Annual"
"RTN","DVBHS6",33,0)
 ;W !,?6,"Soc. Sec. (PAYEE):"
"RTN","DVBHS6",34,0)
 ;W ?26,"$",$S(+DVBDIQ(2,DFN,.3623,"E"):DVBDIQ(2,DFN,.3623,"E"),1:0)
"RTN","DVBHS6",35,0)
 ;W ?48,$S($D(DVBSSA):"$"_DVBSSA,1:"")
"RTN","DVBHS6",36,0)
 ;
"RTN","DVBHS6",37,0)
 W !!!,DVBON,"[1]",DVBOFF X DVBLIT1
"RTN","DVBHS6",38,0)
 W ?4,"Receiving Soc. Sec. (PAYEE):"
"RTN","DVBHS6",39,0)
 ;W !,?6,"Soc. Sec. (PAYEE):"
"RTN","DVBHS6",40,0)
 W ?33,DVBDIQ(2,DFN,.36225,"E")
"RTN","DVBHS6",41,0)
 W ?48,$S($D(DVBSSA):$S(DVBSSA:"YES",1:"NO"),1:"NO")
"RTN","DVBHS6",42,0)
 ;
"RTN","DVBHS6",43,0)
 W !,DVBON,"[2]",DVBOFF X DVBLIT1
"RTN","DVBHS6",44,0)
 W ?4,"Other Annual"
"RTN","DVBHS6",45,0)
 W !,?13,"Retirement (PAYEE):"
"RTN","DVBHS6",46,0)
 W ?26,DVBDIQ(2,DFN,.36285,"E")
"RTN","DVBHS6",47,0)
 I $D(DVBRETT) S V=DVBRETT D TR W ?48,V
"RTN","DVBHS6",48,0)
 ;
"RTN","DVBHS6",49,0)
 W !,DVBON,"[3]",DVBOFF X DVBLIT1
"RTN","DVBHS6",50,0)
 W ?4,"Amount Other Annual"
"RTN","DVBHS6",51,0)
 W !,?13,"Retirement (PAYEE):"
"RTN","DVBHS6",52,0)
 W ?26,"$",$S(+DVBDIQ(2,DFN,.3628,"E"):DVBDIQ(2,DFN,.3628,"E"),1:0)
"RTN","DVBHS6",53,0)
 W ?48,$S($D(DVBRETO):"$"_DVBRETO,1:"")
"RTN","DVBHS6",54,0)
 ;
"RTN","DVBHS6",55,0)
 W !,DVBON,"[4]",DVBOFF X DVBLIT1
"RTN","DVBHS6",56,0)
 W ?4,"Amount Other Annual"
"RTN","DVBHS6",57,0)
 W !,?17,"Income (PAYEE):"
"RTN","DVBHS6",58,0)
 W ?26,"$",$S(+DVBDIQ(2,DFN,.3629,"E"):DVBDIQ(2,DFN,.3629,"E"),1:0)
"RTN","DVBHS6",59,0)
 W ?48,$S($D(DVBOINC):"$"_DVBOINC,1:"")
"RTN","DVBHS6",60,0)
 Q
"RTN","DVBHS6",61,0)
TR S V=$S(V="B":"BLACKLUNG",V="M":"MILITARY",V="C":"CIVIL SERVICE",V="R":"RAILROAD",V="O":"OTHER",V="X":"COMBINATION",1:V) Q
"RTN","DVBHSVER")
0^16^B16299638
"RTN","DVBHSVER",1,0)
DVBHSVER ;ALB/JLU;This is the print for the verification screen ; 8/23/05 11:04am
"RTN","DVBHSVER",2,0)
 ;;4.0;HINQ;**7,21,23,49**;03/25/92 
"RTN","DVBHSVER",3,0)
 N Y
"RTN","DVBHSVER",4,0)
 ;Gets info from patient file.
"RTN","DVBHSVER",5,0)
 K DVBDIQ,DVBX(1)
"RTN","DVBHSVER",6,0)
 S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ("
"RTN","DVBHSVER",7,0)
 I $D(X(1)) S DVBX(1)=X(1)
"RTN","DVBHSVER",8,0)
 S DR=".01;.02;.09;.111:.113;.301:.303;.3014;.313;.361;.3611;.3612;.3615;391;1901"
"RTN","DVBHSVER",9,0)
 D EN^DIQ1
"RTN","DVBHSVER",10,0)
 I $D(DVBX(1)) S X(1)=DVBX(1) K DVBX(1)
"RTN","DVBHSVER",11,0)
 ;
"RTN","DVBHSVER",12,0)
 W ?23 W "****** HINQ Upload/edit ******"
"RTN","DVBHSVER",13,0)
 W !,?35,DVBON,"<<0>>",DVBOFF
"RTN","DVBHSVER",14,0)
 W !,?26,"Verification screen only"
"RTN","DVBHSVER",15,0)
 W !!,?9,"Patient file"
"RTN","DVBHSVER",16,0)
 ;with DVB*4*49 the value of DVBCAP will no longer be checked
"RTN","DVBHSVER",17,0)
 W DVBON,"            VBA ",$S($P(^DVB(395.5,DFN,0),U,5)="Y":"UPDATED",1:"NOT UPDATED"),DVBOFF,"   " X DVBLIT1
"RTN","DVBHSVER",18,0)
 W ?50,"HINQ Response"
"RTN","DVBHSVER",19,0)
 W !,"--------------------------------------------------------------------------------"
"RTN","DVBHSVER",20,0)
 I $D(DVBBAS(2)) I $P(DVBBAS(2),U,35)!($P(DVBBAS(2),U,36))!($P(DVBBAS(2),U,37))!($P(DVBBAS(2),U,38)) D BAD
"RTN","DVBHSVER",21,0)
 I $D(DVBP(6)),$P(DVBP(6),U) S M=$E(DVBP(6),1,2) D MM^DVBHQM11 W !,?11,$C(7),$C(7),DVBON,"** VBA indicates Patient is deceased.  ",M_" "_$S(+$E(DVBP(6),3,4)>0:$E(DVBP(6),3,4)_", ",1:" ")_$E(DVBP(6),5,8)," **",DVBOFF
"RTN","DVBHSVER",22,0)
 ;all records are type "A" after DVB*4*49, so instead of checking
"RTN","DVBHSVER",23,0)
 ;record type check if there are SC disabilities, but no VA check
"RTN","DVBHSVER",24,0)
 I $G(DVBCHECK)'>0,($G(DVBDXNO)'>0) W:$D(M) ! W ?8,$C(7),DVBON,"** NO Monetary Benefits - Means Test Required **",DVBOFF
"RTN","DVBHSVER",25,0)
 W !,?3,DVBON,"Name: ",DVBOFF,DVBDIQ(2,DFN,.01,"E") X DVBLIT1 W ?49,$S($D(DVBADR(1)):DVBADR(1),$D(DVBNAME):$E(DVBNAME,1,30),1:"")
"RTN","DVBHSVER",26,0)
 ;
"RTN","DVBHSVER",27,0)
 W !,?4,DVBON,"Sex: ",DVBOFF,DVBDIQ(2,DFN,.02,"E") X DVBLIT1
"RTN","DVBHSVER",28,0)
 I $D(DVBVET),$P(DVBVET,U,1)'="C" W ?49,$S($P(DVBVET,U,3)="M":"MALE",$P(DVBVET,U,3)="F":"FEMALE",1:"")
"RTN","DVBHSVER",29,0)
 E  I $D(DVBBIR) W ?49,$S($P(DVBBIR,U,25)="M":"MALE",$P(DVBBIR,U,25)="F":"FEMALE",1:"")
"RTN","DVBHSVER",30,0)
 W !,?4,DVBON,"SSN: ",DVBOFF,DVBDIQ(2,DFN,.09,"E") X DVBLIT1
"RTN","DVBHSVER",31,0)
 S (B,C)=0
"RTN","DVBHSVER",32,0)
 I $D(DVBP(6)) S C=$P(DVBP(6),U,3),B=1
"RTN","DVBHSVER",33,0)
 I $D(DVBP(1)) S C=$P(DVBP(1),U,8)
"RTN","DVBHSVER",34,0)
 I C S C=$S(C=1:" Verified SSA",C=2:" Verified VBA",C=4:" Verified by BIRLS",C=9:" SSA Verified No Number Exists",C=0:" Unverified",C=3:" Not Required, Child Under 2",1:" "_C)
"RTN","DVBHSVER",35,0)
 I $D(DVBREF),$P(DVBREF,U,1)?9N D:$P(DVBREF,U,1)'=$P(^DPT(D0,0),U,9) SS W ?49,$P(DVBREF,U,1) W:C]"" ?60,DVBON,$E(C,2,99),DVBOFF X DVBLIT1 K C
"RTN","DVBHSVER",36,0)
 I $P($G(DVBREF),U)'?9N I $D(DVBSSN),DVBSSN?9N W ! D:DVBSSN'=$P(^DPT(D0,0),U,9) SS W ?49,DVBSSN W:B ?60,DVBON,$E(C,2,99),DVBOFF X DVBLIT1 K C
"RTN","DVBHSVER",37,0)
 W !,DVBON,"Claim #: ",DVBOFF,DVBDIQ(2,DFN,.313,"E") X DVBLIT1
"RTN","DVBHSVER",38,0)
 I $D(DVBCN),DVBCN W ?49,DVBCN
"RTN","DVBHSVER",39,0)
 W !,DVBON,"Address: ",DVBOFF,DVBDIQ(2,DFN,.111,"E") X DVBLIT1 I $D(DVBADR(1)) W ?49,DVBADR(1)
"RTN","DVBHSVER",40,0)
 W !,?9,DVBDIQ(2,DFN,.112,"E") I $D(DVBADR(2)) W ?49,DVBADR(2)
"RTN","DVBHSVER",41,0)
 W !,?9,DVBDIQ(2,DFN,.113,"E") I $D(DVBADR(3)) W ?49,DVBADR(3)
"RTN","DVBHSVER",42,0)
 W !!,?2,DVBON,"Pat. Type: ",DVBOFF,DVBDIQ(2,DFN,391,"E") X DVBLIT1
"RTN","DVBHSVER",43,0)
 W ?45,DVBON,"Elig. Stat.: ",DVBOFF,$E(DVBDIQ(2,DFN,.3611,"E"),1,20)
"RTN","DVBHSVER",44,0)
 W !,?3,DVBON,"Vet. Y/N: ",DVBOFF,DVBDIQ(2,DFN,1901,"E") X DVBLIT1
"RTN","DVBHSVER",45,0)
 W ?46,DVBON,"Stat. Date: ",DVBOFF,DVBDIQ(2,DFN,.3612,"E")
"RTN","DVBHSVER",46,0)
 W !,?2,DVBON,"Ser. Con.: ",DVBOFF,DVBDIQ(2,DFN,.301,"E") X DVBLIT1
"RTN","DVBHSVER",47,0)
 W ?44,DVBON,"Verif. Meth.: ",DVBOFF,DVBDIQ(2,DFN,.3615,"E")
"RTN","DVBHSVER",48,0)
 W !,DVBON,"Ser. Con. %: ",DVBOFF,DVBDIQ(2,DFN,.302,"E") X DVBLIT1
"RTN","DVBHSVER",49,0)
 W ?35,DVBON,"Eff. Date Comb. Eval.:",DVBOFF,DVBDIQ(2,DFN,.3014,"E")
"RTN","DVBHSVER",50,0)
 W !,?1,DVBON,"Elig. code: ",DVBOFF,DVBDIQ(2,DFN,.361,"E")
"RTN","DVBHSVER",51,0)
 Q
"RTN","DVBHSVER",52,0)
 ;
"RTN","DVBHSVER",53,0)
 ;
"RTN","DVBHSVER",54,0)
SS W ?46,DVBON,DVBBLO,"-->",DVBBLF,DVBOFF X DVBLIT2,DVBLIT1
"RTN","DVBHSVER",55,0)
 Q
"RTN","DVBHSVER",56,0)
 ;
"RTN","DVBHSVER",57,0)
BAD S T1="WARNING: Error Indicators for " F N=38:-1:35 I $P(DVBBAS(2),U,N) S T1=T1_" "_$S(N=38:"BASIC",N=37:"STATISTICAL",N=36:"DIAGNOSTIC",N=35:"FUTURE",1:"")_","
"RTN","DVBHSVER",58,0)
 W !,DVBON,DVBBLO,"  ***",DVBOFF,DVBBLF,$E(T1,1,$L(T1)-1),DVBON,DVBBLO,"***",DVBOFF,DVBBLF
"RTN","DVBHSVER",59,0)
 Q
"RTN","DVBHT1")
0^17^B22369866
"RTN","DVBHT1",1,0)
DVBHT1 ;ISC-ALBANY/PKE - HINQ alert parser ; 8/29/05 8:49am
"RTN","DVBHT1",2,0)
 ;;4.0;HINQ;**12,15,20,43,49**;03/25/92
"RTN","DVBHT1",3,0)
 ;
"RTN","DVBHT1",4,0)
 ;  cn  foldloc   sc diag   comb%   chk   a&a     hb  pension disablity
"RTN","DVBHT1",5,0)
 ; .313,.312/.314,.3731/2.05,.302,.36295,.36205,.36215,.36235,.3025
"RTN","DVBHT1",6,0)
 Q
"RTN","DVBHT1",7,0)
 ;S DVBDATAT(+Y)="",DVBDATA=DVBDATA_"^"_Y
"RTN","DVBHT1",8,0)
MSG S DVBDATA(+Y)="",DVBDATA=$S($L(DVBDATA)>100:DVBDATA,$P(DVBDATA,"^",16):DVBDATA,1:DVBDATA_"^"_Y) Q
"RTN","DVBHT1",9,0)
 ;
"RTN","DVBHT1",10,0)
 ;check on return from HINQUP processing
"RTN","DVBHT1",11,0)
ACHK S DVBNOALR=""
"RTN","DVBHT1",12,0)
 ;called from batch or direct
"RTN","DVBHT1",13,0)
EN Q:'$D(DFN)  Q:'DFN
"RTN","DVBHT1",14,0)
 N X,Y,I,M,N,P
"RTN","DVBHT1",15,0)
 S DVBDATA="^^^^^^^^^"
"RTN","DVBHT1",16,0)
EDT ; DX,DIQ,AA,ENTIT,COMB,CN,FOLD,CHECK
"RTN","DVBHT1",17,0)
 ;
"RTN","DVBHT1",18,0)
 D DX,DIQ,AA,ENTIT,COMB,CN,FOLD,CHECK
"RTN","DVBHT1",19,0)
 I DVBDATA'="^^^^^^^^^" DO
"RTN","DVBHT1",20,0)
 .I '$D(DVBNOALR) D ALERT^DVBHT Q
"RTN","DVBHT1",21,0)
 .S (I,Y)=0 F  S Y=$O(DVBDATA(Y)) Q:'Y  DO
"RTN","DVBHT1",22,0)
 ..S $P(DVBDATA,"^",I+1)=Y,I=I+1
"RTN","DVBHT1",23,0)
 .K DVBNOALR
"RTN","DVBHT1",24,0)
 K DVBENT,DVBSCONN
"RTN","DVBHT1",25,0)
 Q
"RTN","DVBHT1",26,0)
 ;
"RTN","DVBHT1",27,0)
DX Q:'$D(DVBDX)  Q:'$D(DVBDXNO)
"RTN","DVBHT1",28,0)
 S (DVBDXNO,I)=0 F  S I=$O(DVBDX(I)) Q:I=""  S DVBDXNO=DVBDXNO+1
"RTN","DVBHT1",29,0)
 K M F I=1:1:DVBDXNO D
"RTN","DVBHT1",30,0)
 .S M(I)=$P(DVBDX(I),U,2,3)
"RTN","DVBHT1",31,0)
 .I M(I)["X0" S $P(M(I),U,2)="100"
"RTN","DVBHT1",32,0)
 .S $P(M(I),U,2)=+$P(M(I),U,2)
"RTN","DVBHT1",33,0)
 .S $P(M(I),U,3)=1
"RTN","DVBHT1",34,0)
 .I $P(DVBDX(I),U,4)]"" S $P(M(I),U,4)=$P(DVBDX(I),U,4)
"RTN","DVBHT1",35,0)
 .I $P(DVBDX(I),U,5)]"" S $P(M(I),U,5)=$P(DVBDX(I),U,5)
"RTN","DVBHT1",36,0)
 .I $P(DVBDX(I),U,6)]"" S $P(M(I),U,6)=$P(DVBDX(I),U,6)
"RTN","DVBHT1",37,0)
 .I '$D(DVBSCONN) S DVBSCONN=$P(M(I),"^",2) Q
"RTN","DVBHT1",38,0)
 .I DVBSCONN<$P(M(I),U,2) S DVBSCONN=$P(M(I),U,2)
"RTN","DVBHT1",39,0)
 S (N,P)=0
"RTN","DVBHT1",40,0)
 F  S N=$O(^DPT(DFN,.372,N)) Q:'N  I $D(^(N,0)) DO
"RTN","DVBHT1",41,0)
 .S M=0
"RTN","DVBHT1",42,0)
 .F  S M=$O(M(M)) Q:'M  I M(M)=^(0) K M(M) Q  ;tag dx+6
"RTN","DVBHT1",43,0)
 .I M Q  ;sc match
"RTN","DVBHT1",44,0)
 .I $P(^(0),U,3) S P=P+1 ;  tag dx+6,naked ref to ^dpt(dfn,.372,n,0)
"RTN","DVBHT1",45,0)
 I P S Y="3-SC Disabilities" D VER
"RTN","DVBHT1",46,0)
 I $D(M)>9 S Y="3+SC Disabilities" D VER
"RTN","DVBHT1",47,0)
 K I,M,N,P Q
"RTN","DVBHT1",48,0)
 ;
"RTN","DVBHT1",49,0)
VER ;with DVB*4*49 no BIRLS only records & Dx, Verified not sent
"RTN","DVBHT1",50,0)
 D MSG Q
"RTN","DVBHT1",51,0)
 ;
"RTN","DVBHT1",52,0)
DIQ ;K DVBDIQ(2)
"RTN","DVBHT1",53,0)
 F LP2=.361,.302,.3025,.312,.313,.314,.36205,.36215,.36235,.36295 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHT1",54,0)
 S DR=".302;.3025;.312;.313;.314;.361;.36205;.36215;.36235;.36295"
"RTN","DVBHT1",55,0)
DIQDR S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ(" D EN^DIQ1 Q
"RTN","DVBHT1",56,0)
 ;
"RTN","DVBHT1",57,0)
 ; I V=0 HBa/oA&A term    V=1 Hospitlize pay HB, A&A entitled
"RTN","DVBHT1",58,0)
 ; I V=2 A&A    V=3 HB    V=" " HB a/o A&A not granted
"RTN","DVBHT1",59,0)
AA I $D(DVBAAHB) S V1=DVBAAHB S V=V1 S:V1>3&(V1<8) V=V1-4
"RTN","DVBHT1",60,0)
 I '$D(DVBAAHB) S V=9
"RTN","DVBHT1",61,0)
 I $D(DVBBAS(1)),$P(DVBBAS(1),"^",6)="E" S V=0 ;terminated pending purge
"RTN","DVBHT1",62,0)
 I DVBDIQ(2,DFN,.36205,"E")="YES","0 9"[V S Y="5-A&A" D MSG
"RTN","DVBHT1",63,0)
 I DVBDIQ(2,DFN,.36205,"E")'="YES","12"[V S Y="5+A&A" D MSG
"RTN","DVBHT1",64,0)
 ;
"RTN","DVBHT1",65,0)
 I DVBDIQ(2,DFN,.36215,"E")="YES","0 9"[V S Y="5-HB" D MSG
"RTN","DVBHT1",66,0)
 I DVBDIQ(2,DFN,.36215,"E")'="YES","13"[V S Y="5+HB" D MSG
"RTN","DVBHT1",67,0)
 Q
"RTN","DVBHT1",68,0)
 ;
"RTN","DVBHT1",69,0)
 ;compensation, pension
"RTN","DVBHT1",70,0)
ENTIT S DVBENT=" " I $D(DVBP(1)) S T1=$P(DVBP(1),U,4) D
"RTN","DVBHT1",71,0)
 . I T1'="" S DVBENT=$S(T1="01":"Compensation",T1="0L":"Pension",1:" ")
"RTN","DVBHT1",72,0)
 S Y=0
"RTN","DVBHT1",73,0)
 I DVBDIQ(2,DFN,.36235,"E")="YES" DO
"RTN","DVBHT1",74,0)
 .;terminated pending purge
"RTN","DVBHT1",75,0)
 .I $G(DVBCHECK)'>0,$G(DVBDXNO)>0 S DVBENT=" "
"RTN","DVBHT1",76,0)
 .;all record types now "A", so had to check if no VA Check and has 
"RTN","DVBHT1",77,0)
 .;SC disabilities instead of checking for type "E" record - DVB*4*49
"RTN","DVBHT1",78,0)
 .I DVBENT["Pension" Q
"RTN","DVBHT1",79,0)
 .S Y="5-Pension"
"RTN","DVBHT1",80,0)
 E  I DVBENT["Pension" S Y="5+Pension"
"RTN","DVBHT1",81,0)
 I Y D MSG
"RTN","DVBHT1",82,0)
 ;
"RTN","DVBHT1",83,0)
 S Y=0
"RTN","DVBHT1",84,0)
 I DVBDIQ(2,DFN,.3025,"E")="YES" DO
"RTN","DVBHT1",85,0)
 .I DVBENT["ompensation" Q
"RTN","DVBHT1",86,0)
 .I DVBENT["Disability" Q
"RTN","DVBHT1",87,0)
 .S Y="5-Compensation"
"RTN","DVBHT1",88,0)
 E  I DVBENT'=" " DO
"RTN","DVBHT1",89,0)
 .I DVBENT["ompensation"!(DVBENT["Disability") S Y="5+Compensation"
"RTN","DVBHT1",90,0)
 I Y D MSG
"RTN","DVBHT1",91,0)
 Q
"RTN","DVBHT1",92,0)
 ;DVBSCONN is biggest SC disability
"RTN","DVBHT1",93,0)
COMB I '$D(DVBSCONN) S Y=""
"RTN","DVBHT1",94,0)
 E  DO
"RTN","DVBHT1",95,0)
 .S Y=DVBSCONN
"RTN","DVBHT1",96,0)
 .I $D(DVBCAP) Q  ;birls
"RTN","DVBHT1",97,0)
 .I DVBENT["Pension" Q
"RTN","DVBHT1",98,0)
 .S Y=$S($D(DVBDXPCT):$S(+DVBDXPCT?1N.N:+DVBDXPCT,1:DVBSCONN))
"RTN","DVBHT1",99,0)
 .S DVBSCONN=Y
"RTN","DVBHT1",100,0)
 I +DVBDIQ(2,DFN,.302,"E")=+Y S Y=0
"RTN","DVBHT1",101,0)
 E  DO
"RTN","DVBHT1",102,0)
 .S Y=0
"RTN","DVBHT1",103,0)
 .;c&p
"RTN","DVBHT1",104,0)
 .I '$D(DVBSCONN)!(DVBENT["ompensation")!(DVBENT["Disability") DO  Q
"RTN","DVBHT1",105,0)
 . .S Y="5?SC Combined %"
"RTN","DVBHT1",106,0)
 .;birls,pension
"RTN","DVBHT1",107,0)
 .I DVBDIQ(2,DFN,.361,"E")["SERVICE CONNECTED",DVBSCONN>49 Q
"RTN","DVBHT1",108,0)
 .I DVBDIQ(2,DFN,.361,"E")["SC LESS THAN",DVBSCONN<50 Q
"RTN","DVBHT1",109,0)
 .S Y="5?SC Combined %"
"RTN","DVBHT1",110,0)
 I Y D MSG
"RTN","DVBHT1",111,0)
 K DVBALERT,DVBSCONN
"RTN","DVBHT1",112,0)
 Q
"RTN","DVBHT1",113,0)
 ;
"RTN","DVBHT1",114,0)
CN I +DVBDIQ(2,DFN,.313,"E")=$S($D(DVBCN):+DVBCN,1:0)
"RTN","DVBHT1",115,0)
 E  S Y="2?Claim #" D MSG
"RTN","DVBHT1",116,0)
 Q
"RTN","DVBHT1",117,0)
 ;  --check in xman
"RTN","DVBHT1",118,0)
FOLD Q:'$D(DVBFL)  S Y=0
"RTN","DVBHT1",119,0)
 I $G(DVBFL)="  " S DVBFL=""
"RTN","DVBHT1",120,0)
 I '$D(DVBDIQ(2,DFN,.314,"E")) DO
"RTN","DVBHT1",121,0)
 .I +DVBDIQ(2,DFN,.312,"E")=$S($D(DVBFL):+DVBFL,1:0) Q
"RTN","DVBHT1",122,0)
 .S Y="2?Folder Location"
"RTN","DVBHT1",123,0)
 E  DO  ;pims v5.3  y => abc_ro, 323, or ""
"RTN","DVBHT1",124,0)
 .S Y=$S($D(DVBFL):$S($P(DVBFL,"- ",2)]"":$P(DVBFL,"- ",2),1:DVBFL),1:"")
"RTN","DVBHT1",125,0)
 .I DVBDIQ(2,DFN,.314,"E")=Y Q
"RTN","DVBHT1",126,0)
 .S Y="2?Folder Location"
"RTN","DVBHT1",127,0)
 I Y D MSG
"RTN","DVBHT1",128,0)
 Q
"RTN","DVBHT1",129,0)
 ;
"RTN","DVBHT1",130,0)
CHECK S Y=0
"RTN","DVBHT1",131,0)
 I $D(DVBDIQ(2,DFN,.36295,"E")) DO  ;pims v5.3
"RTN","DVBHT1",132,0)
 .I $D(DVBBAS(1)),$L($P(DVBBAS(1),"^",20)) S Y=$P(DVBBAS(1),"^",20)
"RTN","DVBHT1",133,0)
 .I +DVBDIQ(2,DFN,.36295,"E")=+$S(Y:Y*12,$D(DVBCHECK):DVBCHECK*12,1:"") S Y=0 Q
"RTN","DVBHT1",134,0)
 .S Y="5?VA Check/Net Award"
"RTN","DVBHT1",135,0)
 I Y D MSG
"RTN","DVBHT1",136,0)
 Q
"VER")
8.0^22.0
"^DD",395,395,22,0)
RDPC IP ADDRESS^FX^^HQIP;1^K:$L(X)>15!($L(X)<12)!'(X?1.3N1P1.3N1P1.3N1P1.3N) X
"^DD",395,395,22,3)
Answer must be 14-15 characters in length.
"^DD",395,395,22,10)
ADT COORDINATOR OR SITE MANAGER
"^DD",395,395,22,21,0)
^.001^2^2^3040907^^^
"^DD",395,395,22,21,1,0)
This parameter contains the IP Address of the VBA Remote Data Processing
"^DD",395,395,22,21,2,0)
Center.  Users at a site will have HINQ passwords only valid at this RDPC.
"^DD",395,395,22,"DT")
3050916
"^DD",395,395,23,0)
AAC PORT DESIGNATOR^NJ5,0X^^HQIP;2^K:+X'=X!(X>99999)!(X<0)!(X?.E1"."1N.N) X I X=99999 S X=1
"^DD",395,395,23,3)
Type a Number between 0 and 99999, 0 Decimal Digits
"^DD",395,395,23,21,0)
^^4^4^3050916^
"^DD",395,395,23,21,1,0)
This field is a counter for the number of HINQ connections used at a 
"^DD",395,395,23,21,2,0)
site.   The remainder of this number, divided by the number of available 
"^DD",395,395,23,21,3,0)
ports at the AAC, will determine which port to use for this HINQ 
"^DD",395,395,23,21,4,0)
session.  The number will automatically reset after #99999.
"^DD",395,395,23,"DT")
3050916
**INSTALL NAME**
DG*5.3*631
"BLD",5642,0)
DG*5.3*631^REGISTRATION^0^3051102^y
"BLD",5642,4,0)
^9.64PA^2^1
"BLD",5642,4,2,0)
2
"BLD",5642,4,2,2,0)
^9.641^2.04^2
"BLD",5642,4,2,2,2,0)
PATIENT  (File-top level)
"BLD",5642,4,2,2,2,1,0)
^9.6411^.3014^1
"BLD",5642,4,2,2,2,1,.3014,0)
EFF. DATE COMBINED SC% EVAL.
"BLD",5642,4,2,2,2.04,0)
RATED DISABILITIES (VA)  (sub-file)
"BLD",5642,4,2,2,2.04,1,0)
^9.6411^6^3
"BLD",5642,4,2,2,2.04,1,4,0)
EXTREMITY AFFECTED
"BLD",5642,4,2,2,2.04,1,5,0)
ORIGINAL EFFECTIVE DATE
"BLD",5642,4,2,2,2.04,1,6,0)
CURRENT EFFECTIVE DATE
"BLD",5642,4,2,222)
y^n^p^^^^n^^n
"BLD",5642,4,2,224)

"BLD",5642,4,"APDD",2,2)

"BLD",5642,4,"APDD",2,2,.3014)

"BLD",5642,4,"APDD",2,2.04)

"BLD",5642,4,"APDD",2,2.04,4)

"BLD",5642,4,"APDD",2,2.04,5)

"BLD",5642,4,"APDD",2,2.04,6)

"BLD",5642,4,"B",2,2)

"BLD",5642,6)
3^
"BLD",5642,"ABNS",0)
^9.66A^^
"BLD",5642,"ABPKG")
y^n
"BLD",5642,"KRN",0)
^9.67PA^8989.52^19
"BLD",5642,"KRN",.4,0)
.4
"BLD",5642,"KRN",.401,0)
.401
"BLD",5642,"KRN",.402,0)
.402
"BLD",5642,"KRN",.403,0)
.403
"BLD",5642,"KRN",.5,0)
.5
"BLD",5642,"KRN",.84,0)
.84
"BLD",5642,"KRN",3.6,0)
3.6
"BLD",5642,"KRN",3.8,0)
3.8
"BLD",5642,"KRN",9.2,0)
9.2
"BLD",5642,"KRN",9.8,0)
9.8
"BLD",5642,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",5642,"KRN",9.8,"NM",1,0)
DGRP11^^0^B10177307
"BLD",5642,"KRN",9.8,"NM",2,0)
DGRPDB^^0^B20522498
"BLD",5642,"KRN",9.8,"NM",3,0)
DGENELA^^0^B23513647
"BLD",5642,"KRN",9.8,"NM",4,0)
DGENELA1^^0^B76190265
"BLD",5642,"KRN",9.8,"NM",5,0)
DGRPE1^^0^B8637355
"BLD",5642,"KRN",9.8,"NM",6,0)
DGENUPL2^^0^B53254236
"BLD",5642,"KRN",9.8,"NM","B","DGENELA",3)

"BLD",5642,"KRN",9.8,"NM","B","DGENELA1",4)

"BLD",5642,"KRN",9.8,"NM","B","DGENUPL2",6)

"BLD",5642,"KRN",9.8,"NM","B","DGRP11",1)

"BLD",5642,"KRN",9.8,"NM","B","DGRPDB",2)

"BLD",5642,"KRN",9.8,"NM","B","DGRPE1",5)

"BLD",5642,"KRN",19,0)
19
"BLD",5642,"KRN",19,"NM",0)
^9.68A^^
"BLD",5642,"KRN",19.1,0)
19.1
"BLD",5642,"KRN",101,0)
101
"BLD",5642,"KRN",409.61,0)
409.61
"BLD",5642,"KRN",771,0)
771
"BLD",5642,"KRN",870,0)
870
"BLD",5642,"KRN",8989.51,0)
8989.51
"BLD",5642,"KRN",8989.52,0)
8989.52
"BLD",5642,"KRN",8994,0)
8994
"BLD",5642,"KRN","B",.4,.4)

"BLD",5642,"KRN","B",.401,.401)

"BLD",5642,"KRN","B",.402,.402)

"BLD",5642,"KRN","B",.403,.403)

"BLD",5642,"KRN","B",.5,.5)

"BLD",5642,"KRN","B",.84,.84)

"BLD",5642,"KRN","B",3.6,3.6)

"BLD",5642,"KRN","B",3.8,3.8)

"BLD",5642,"KRN","B",9.2,9.2)

"BLD",5642,"KRN","B",9.8,9.8)

"BLD",5642,"KRN","B",19,19)

"BLD",5642,"KRN","B",19.1,19.1)

"BLD",5642,"KRN","B",101,101)

"BLD",5642,"KRN","B",409.61,409.61)

"BLD",5642,"KRN","B",771,771)

"BLD",5642,"KRN","B",870,870)

"BLD",5642,"KRN","B",8989.51,8989.51)

"BLD",5642,"KRN","B",8989.52,8989.52)

"BLD",5642,"KRN","B",8994,8994)

"BLD",5642,"QUES",0)
^9.62^^
"BLD",5642,"REQB",0)
^9.611^6^6
"BLD",5642,"REQB",1,0)
DG*5.3*327^2
"BLD",5642,"REQB",2,0)
DG*5.3*570^2
"BLD",5642,"REQB",3,0)
DG*5.3*564^2
"BLD",5642,"REQB",4,0)
DG*5.3*397^2
"BLD",5642,"REQB",5,0)
DG*5.3*451^2
"BLD",5642,"REQB",6,0)
DG*5.3*677^1
"BLD",5642,"REQB","B","DG*5.3*327",1)

"BLD",5642,"REQB","B","DG*5.3*397",4)

"BLD",5642,"REQB","B","DG*5.3*451",5)

"BLD",5642,"REQB","B","DG*5.3*564",3)

"BLD",5642,"REQB","B","DG*5.3*570",2)

"BLD",5642,"REQB","B","DG*5.3*677",6)

"FIA",2)
PATIENT
"FIA",2,0)
^DPT(
"FIA",2,0,0)
2I
"FIA",2,0,1)
y^n^p^^^^n^^n
"FIA",2,0,10)

"FIA",2,0,11)

"FIA",2,0,"RLRO")

"FIA",2,0,"VR")
5.3^DG
"FIA",2,2)
1
"FIA",2,2,.3014)

"FIA",2,2.04)
1
"FIA",2,2.04,4)

"FIA",2,2.04,5)

"FIA",2,2.04,6)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2941102^2941102
"PKG",5,22,1,"PAH",1,0)
631^3051102^83
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","DGENELA")
0^3^B23513647
"RTN","DGENELA",1,0)
DGENELA ;ALB/CJM,KCL,Zoltan/PJR,RGL,LBD - Patient Eligibility API ; 8/18/05 11:52am
"RTN","DGENELA",2,0)
 ;;5.3;Registration;**121,147,232,314,451,564,631**;Aug 13,1993
"RTN","DGENELA",3,0)
 ;
"RTN","DGENELA",4,0)
GET(DFN,DGELG) ;
"RTN","DGENELA",5,0)
 ;Description: Used to obtain the patient eligibility data.
"RTN","DGENELA",6,0)
 ;  The data is placed in the local DGELG array.
"RTN","DGENELA",7,0)
 ;Input:
"RTN","DGENELA",8,0)
 ;  DFN - internal entry number of a record in the PATIENT file
"RTN","DGENELA",9,0)
 ;Output:
"RTN","DGENELA",10,0)
 ;  Function Value - returns 1 on success, 0 on failure
"RTN","DGENELA",11,0)
 ;  DGELG - this is  a local array that will be used to return patient eligibility data. The array subscripts and the fields mapped to are defined below. (pass by reference)
"RTN","DGENELA",12,0)
 ;
"RTN","DGENELA",13,0)
 ;subscript             field name
"RTN","DGENELA",14,0)
 ;"DFN"                ien Patient record
"RTN","DGENELA",15,0)
 ;"ELIG","CODE"        Primary Eligibility Code
"RTN","DGENELA",16,0)
 ;"ELIG","CODE",<ien>  Patient Eligibilities
"RTN","DGENELA",17,0)
 ;"SC"                 Service Connected
"RTN","DGENELA",18,0)
 ;"SCPER"              Service Connected Percentage
"RTN","DGENELA",19,0)
 ;"EFFDT"              SC Combined Effective Date
"RTN","DGENELA",20,0)
 ;"POW"                POW Status Indicated
"RTN","DGENELA",21,0)
 ;"A&A"                Receiving A&A Benefits
"RTN","DGENELA",22,0)
 ;"HB"                 Receiving Housebound Benefits
"RTN","DGENELA",23,0)
 ;"VAPEN"              Receiving a VA Pension
"RTN","DGENELA",24,0)
 ;"VACKAMT"            Total Annual VA Check Amount
"RTN","DGENELA",25,0)
 ;"DISRET"             Disability Ret. From Military
"RTN","DGENELA",26,0)
 ;"MEDICAID"           Medicaid
"RTN","DGENELA",27,0)
 ;"AO"                 Exposed to Agent Orange
"RTN","DGENELA",28,0)
 ;"IR"                 Radiation Exposure Indicated
"RTN","DGENELA",29,0)
 ;"EC"                 Environmental Contaminants
"RTN","DGENELA",30,0)
 ;"MTSTA"              Means Test Status
"RTN","DGENELA",31,0)
 ;P&T                  P&T
"RTN","DGENELA",32,0)
 ;POS                  PERIOD OF SERVICE
"RTN","DGENELA",33,0)
 ;UNEMPLOY             UNEMPLOYABLE
"RTN","DGENELA",34,0)
 ;SCAWDATE             SC AWARD DATE
"RTN","DGENELA",35,0)
 ;RATEINC              RATED INCOMPETENT
"RTN","DGENELA",36,0)
 ;CLAIMNUM             CLAIM NUMBER
"RTN","DGENELA",37,0)
 ;** removed ***     CLAIMLOC             *CLAIM FOLDER LOCATION
"RTN","DGENELA",38,0)
 ;VADISAB              RECEIVING VA DISABILITY?
"RTN","DGENELA",39,0)
 ;ELIGSTA              ELIGIBILITY STATUS
"RTN","DGENELA",40,0)
 ;ELIGSTADATE          ELIGIBILITY STATUS DATE
"RTN","DGENELA",41,0)
 ;ELIGVERIF            ELIGIBILITY VERIF. METHOD
"RTN","DGENELA",42,0)
 ;ELIGVSITE            ELIGIBILITY VERIFICATION SITE
"RTN","DGENELA",43,0)
 ;ELIGENTBY            ELIGIBILITY STATUS ENTERED BY
"RTN","DGENELA",44,0)
 ;RATEDIS
"RTN","DGENELA",45,0)
 ;  <COUNT>,"RD"      RATED DISABILITY
"RTN","DGENELA",46,0)
 ;  <COUNT>,"PER"      DISABILITY %
"RTN","DGENELA",47,0)
 ;  <COUNT>,"RDSC"     SERVICE CONNECTED
"RTN","DGENELA",48,0)
 ;  <COUNT>,"RDEXT"    EXTREMITY
"RTN","DGENELA",49,0)
 ;  <COUNT>,"RDORIG"   ORIGINAL RD EFFECTIVE DATE
"RTN","DGENELA",50,0)
 ;  <COUNT>."RDCURR"   CURRENT RD EFFECTIVE DATE
"RTN","DGENELA",51,0)
 ;"VCD"               Veteran Catastrophically Disabled? (#.39)
"RTN","DGENELA",52,0)
 ;"PH"                PURPLE HEART INDICATED
"RTN","DGENELA",53,0)
 ;"AOEXPLOC"          AGENT ORANGE EXPOSURE LOCATION
"RTN","DGENELA",54,0)
 ;"CVELEDT"           COMBAT VETERAN END DATE
"RTN","DGENELA",55,0)
 ;
"RTN","DGENELA",56,0)
 K DGELG
"RTN","DGENELA",57,0)
 S DGELG=""
"RTN","DGENELA",58,0)
 Q:'$D(^DPT(DFN)) 0
"RTN","DGENELA",59,0)
 N NODE,SUBREC,COUNT,CODE,IEN
"RTN","DGENELA",60,0)
 ;
"RTN","DGENELA",61,0)
 S DGELG("DFN")=DFN
"RTN","DGENELA",62,0)
 S DGELG("VCD")=$$VCD^DGENA5(DFN)
"RTN","DGENELA",63,0)
 ;
"RTN","DGENELA",64,0)
 ;
"RTN","DGENELA",65,0)
 S NODE=$G(^DPT(DFN,.29))
"RTN","DGENELA",66,0)
 S DGELG("RATEINC")=$P(NODE,"^",12)
"RTN","DGENELA",67,0)
 ;
"RTN","DGENELA",68,0)
 S NODE=$G(^DPT(DFN,.3))
"RTN","DGENELA",69,0)
 S DGELG("SC")=$P(NODE,"^")
"RTN","DGENELA",70,0)
 S DGELG("SCPER")=$P(NODE,"^",2)
"RTN","DGENELA",71,0)
 S DGELG("P&T")=$P(NODE,"^",4)
"RTN","DGENELA",72,0)
 S DGELG("UNEMPLOY")=$P(NODE,"^",5)
"RTN","DGENELA",73,0)
 S DGELG("SCAWDATE")=$P(NODE,"^",12)
"RTN","DGENELA",74,0)
 S DGELG("VADISAB")=$P(NODE,"^",11)
"RTN","DGENELA",75,0)
 S DGELG("EFFDT")=$P(NODE,"^",14)
"RTN","DGENELA",76,0)
 ;
"RTN","DGENELA",77,0)
 S NODE=$G(^DPT(DFN,.31))
"RTN","DGENELA",78,0)
 S DGELG("CLAIMNUM")=$P(NODE,"^",3)
"RTN","DGENELA",79,0)
 ;S DGELG("CLAIMLOC")=$P(NODE,"^",2) ;removed
"RTN","DGENELA",80,0)
 ;
"RTN","DGENELA",81,0)
 S NODE=$G(^DPT(DFN,.32))
"RTN","DGENELA",82,0)
 S DGELG("POS")=$P(NODE,"^",3)
"RTN","DGENELA",83,0)
 ;
"RTN","DGENELA",84,0)
 S NODE=$G(^DPT(DFN,.36))
"RTN","DGENELA",85,0)
 S DGELG("ELIG","CODE")=$P(NODE,"^") ;primary eligibility
"RTN","DGENELA",86,0)
 S DGELG("DISRET")=$P(NODE,"^",2)
"RTN","DGENELA",87,0)
 ;
"RTN","DGENELA",88,0)
 S NODE=$G(^DPT(DFN,.38))
"RTN","DGENELA",89,0)
 S DGELG("MEDICAID")=$P(NODE,"^")
"RTN","DGENELA",90,0)
 ;
"RTN","DGENELA",91,0)
 S NODE=$G(^DPT(DFN,.361))
"RTN","DGENELA",92,0)
 S DGELG("ELIGSTA")=$P(NODE,"^")
"RTN","DGENELA",93,0)
 S DGELG("ELIGSTADATE")=$P(NODE,"^",2)
"RTN","DGENELA",94,0)
 S DGELG("ELIGVERIF")=$P(NODE,"^",5)
"RTN","DGENELA",95,0)
 S DGELG("ELIGENTBY")=$P(NODE,"^",6)
"RTN","DGENELA",96,0)
 ;
"RTN","DGENELA",97,0)
 S NODE=$G(^DPT(DFN,.362))
"RTN","DGENELA",98,0)
 S DGELG("VACKAMT")=$P(NODE,"^",20)
"RTN","DGENELA",99,0)
 S DGELG("VAPEN")=$P(NODE,"^",14)
"RTN","DGENELA",100,0)
 S DGELG("A&A")=$P(NODE,"^",12)
"RTN","DGENELA",101,0)
 S DGELG("HB")=$P(NODE,"^",13)
"RTN","DGENELA",102,0)
 ;
"RTN","DGENELA",103,0)
 ;
"RTN","DGENELA",104,0)
 S NODE=$G(^DPT(DFN,.321))
"RTN","DGENELA",105,0)
 S DGELG("AO")=$P(NODE,"^",2)
"RTN","DGENELA",106,0)
 S DGELG("IR")=$P(NODE,"^",3)
"RTN","DGENELA",107,0)
 S DGELG("AOEXPLOC")=$P(NODE,"^",13)
"RTN","DGENELA",108,0)
 ;
"RTN","DGENELA",109,0)
 S NODE=$G(^DPT(DFN,.322))
"RTN","DGENELA",110,0)
 S DGELG("EC")=$P(NODE,"^",13)
"RTN","DGENELA",111,0)
 ;
"RTN","DGENELA",112,0)
 S NODE=$G(^DPT(DFN,.52))
"RTN","DGENELA",113,0)
 S DGELG("POW")=$P(NODE,"^",5)
"RTN","DGENELA",114,0)
 S DGELG("CVELEDT")=$P(NODE,"^",15)
"RTN","DGENELA",115,0)
 ;
"RTN","DGENELA",116,0)
 ; Purple Heart Indicator
"RTN","DGENELA",117,0)
 S NODE=$G(^DPT(DFN,.53))
"RTN","DGENELA",118,0)
 S DGELG("PH")=$P(NODE,"^")
"RTN","DGENELA",119,0)
 ;
"RTN","DGENELA",120,0)
 ;means test category
"RTN","DGENELA",121,0)
 S DGELG("MTSTA")=""
"RTN","DGENELA",122,0)
 S IEN=$P($$LST^DGMTU(DFN),"^")
"RTN","DGENELA",123,0)
 I IEN S DGELG("MTSTA")=$P($G(^DGMT(408.31,IEN,0)),"^",3)
"RTN","DGENELA",124,0)
 ;
"RTN","DGENELA",125,0)
 ;get the other eligibilities multiple
"RTN","DGENELA",126,0)
 S SUBREC=0
"RTN","DGENELA",127,0)
 F  S SUBREC=$O(^DPT(DFN,"E",SUBREC)) Q:'SUBREC  D
"RTN","DGENELA",128,0)
 .S CODE=+$G(^DPT(DFN,"E",SUBREC,0))
"RTN","DGENELA",129,0)
 .;
"RTN","DGENELA",130,0)
 .;need to check the "B" x-ref, because when a code is deleted from the multiple, the kill logic is executed BEFORE the data is actually removed - but the "B" x-ref has been deleted at this point
"RTN","DGENELA",131,0)
 .I CODE,$D(^DPT(DFN,"E","B",CODE)) S DGELG("ELIG","CODE",CODE)=SUBREC
"RTN","DGENELA",132,0)
 ;
"RTN","DGENELA",133,0)
 ;rated disability multiple
"RTN","DGENELA",134,0)
 S SUBREC=0,COUNT=0
"RTN","DGENELA",135,0)
 F  S SUBREC=$O(^DPT(DFN,.372,SUBREC)) Q:'SUBREC  D
"RTN","DGENELA",136,0)
 .S NODE=$G(^DPT(DFN,.372,SUBREC,0))
"RTN","DGENELA",137,0)
 .Q:'$P(NODE,"^")
"RTN","DGENELA",138,0)
 .S COUNT=COUNT+1
"RTN","DGENELA",139,0)
 .S DGELG("RATEDIS",COUNT,"RD")=$P(NODE,"^")
"RTN","DGENELA",140,0)
 .S DGELG("RATEDIS",COUNT,"PER")=$P(NODE,"^",2)
"RTN","DGENELA",141,0)
 .S DGELG("RATEDIS",COUNT,"RDSC")=$P(NODE,"^",3)
"RTN","DGENELA",142,0)
 .S DGELG("RATEDIS",COUNT,"RDEXT")=$P(NODE,"^",4)
"RTN","DGENELA",143,0)
 .S DGELG("RATEDIS",COUNT,"RDORIG")=$P(NODE,"^",5)
"RTN","DGENELA",144,0)
 .S DGELG("RATEDIS",COUNT,"RDCURR")=$P(NODE,"^",6)
"RTN","DGENELA",145,0)
 ;
"RTN","DGENELA",146,0)
 Q 1
"RTN","DGENELA",147,0)
 ;
"RTN","DGENELA",148,0)
NATNAME(CODE) ;
"RTN","DGENELA",149,0)
 ;Description: Given an entry in file #8, Eligibility Code file,
"RTN","DGENELA",150,0)
 ;  finds the corresponding entry in file 8.1, MAS Eligbility Code file,
"RTN","DGENELA",151,0)
 ;  and returns the name
"RTN","DGENELA",152,0)
 ;Input:
"RTN","DGENELA",153,0)
 ;  CODE - pointer to file #8
"RTN","DGENELA",154,0)
 ;Output:
"RTN","DGENELA",155,0)
 ;  Function Value - name of corresponding code in file #8.1
"RTN","DGENELA",156,0)
 ;
"RTN","DGENELA",157,0)
 Q:'$G(CODE) ""
"RTN","DGENELA",158,0)
 Q $$CODENAME($P($G(^DIC(8,CODE,0)),"^",9))
"RTN","DGENELA",159,0)
 ;
"RTN","DGENELA",160,0)
NATCODE(CODE) ;
"RTN","DGENELA",161,0)
 ;Description: Given an entry in file #8, Eligibility Code file,
"RTN","DGENELA",162,0)
 ;  finds the corresponding entry in file 8.1, MAS Eligbility Code file
"RTN","DGENELA",163,0)
 ;Input:
"RTN","DGENELA",164,0)
 ;  CODE - pointer to file #8
"RTN","DGENELA",165,0)
 ;Output:
"RTN","DGENELA",166,0)
 ;  Function Value - pointer to file #8.1
"RTN","DGENELA",167,0)
 ;
"RTN","DGENELA",168,0)
 Q:'$G(CODE) ""
"RTN","DGENELA",169,0)
 Q $P($G(^DIC(8,CODE,0)),"^",9)
"RTN","DGENELA",170,0)
 ;
"RTN","DGENELA",171,0)
CODENAME(CODE) ;
"RTN","DGENELA",172,0)
 ;Description: Given a pointer to file #8.1, MAS Eligibility Code file,
"RTN","DGENELA",173,0)
 ;  it returns the name of the code 
"RTN","DGENELA",174,0)
 ;Input:
"RTN","DGENELA",175,0)
 ;  CODE - pointer to file #8.1
"RTN","DGENELA",176,0)
 ;Output:
"RTN","DGENELA",177,0)
 ;  Function Value - name of the code pointed to
"RTN","DGENELA",178,0)
 ;
"RTN","DGENELA",179,0)
 Q:'$G(CODE) ""
"RTN","DGENELA",180,0)
 Q $P($G(^DIC(8.1,CODE,0)),"^")
"RTN","DGENELA",181,0)
 ;
"RTN","DGENELA",182,0)
ELIGSTAT(DFN,DGELG) ;
"RTN","DGENELA",183,0)
 ;Description: Used to get the ELIGIBILITY STATUS and the 
"RTN","DGENELA",184,0)
 ;ELIGIBILITY STATUS DATE of the patient.
"RTN","DGENELA",185,0)
 ;
"RTN","DGENELA",186,0)
 ;Input:
"RTN","DGENELA",187,0)
 ;  DFN - ien of patient record
"RTN","DGENELA",188,0)
 ;
"RTN","DGENELA",189,0)
 ;Ouput:
"RTN","DGENELA",190,0)
 ;  Function Value - 1 on success, 0 on failure
"RTN","DGENELA",191,0)
 ;  DGELG array (pass by reference)
"RTN","DGENELA",192,0)
 ;    "ELIGSTA" - ELIGIBILITY STATUS
"RTN","DGENELA",193,0)
 ;    "ELIGSTADATE" - ELIGIBILITY STATUS DATE
"RTN","DGENELA",194,0)
 ;
"RTN","DGENELA",195,0)
 N NODE,SUCCESS
"RTN","DGENELA",196,0)
 D
"RTN","DGENELA",197,0)
 .S SUCCESS=1
"RTN","DGENELA",198,0)
 .I '$G(DFN) S SUCCESS=0 Q
"RTN","DGENELA",199,0)
 .S NODE=$G(^DPT(DFN,.361))
"RTN","DGENELA",200,0)
 .S DGELG("ELIGSTA")=$P(NODE,"^")
"RTN","DGENELA",201,0)
 .S DGELG("ELIGSTADATE")=$P(NODE,"^",2)
"RTN","DGENELA",202,0)
 Q SUCCESS
"RTN","DGENELA1")
0^4^B76190265
"RTN","DGENELA1",1,0)
DGENELA1 ;ALB/CJM,RTK,TDM,PJR,RGL,LBD - Patient Eligibility API ; 9/7/05 1:57pm
"RTN","DGENELA1",2,0)
 ;;5.3;Registration;**147,327,314,367,497,451,564,631**;Aug 13,1993
"RTN","DGENELA1",3,0)
 ;
"RTN","DGENELA1",4,0)
CHECK(DGELG,DGPAT,DGCDIS,ERRMSG) ;
"RTN","DGENELA1",5,0)
 ;Does validation checks on the eligibility contained in the DGELG array.
"RTN","DGENELA1",6,0)
 ;
"RTN","DGENELA1",7,0)
 ;Input:
"RTN","DGENELA1",8,0)
 ;  DGELG - array containing eligibility data (pass by reference)
"RTN","DGENELA1",9,0)
 ;  DGPAT - array containing patient data (pass by reference)
"RTN","DGENELA1",10,0)
 ;  DGCDIS - array containing catastrophic disability determination (pass by reference)
"RTN","DGENELA1",11,0)
 ;
"RTN","DGENELA1",12,0)
 ;Output:
"RTN","DGENELA1",13,0)
 ;  Function Value - returns 1 if all validation checks passed, 0 otherwise
"RTN","DGENELA1",14,0)
 ;  ERRMSG - returns a message if validations fail (pass by reference)
"RTN","DGENELA1",15,0)
 ;
"RTN","DGENELA1",16,0)
 N SUCCESS,NATCODE,BAD,SUB,CODE,DGONV,DGTEXT,INELDATE
"RTN","DGENELA1",17,0)
 S SUCCESS=0
"RTN","DGENELA1",18,0)
 S ERRMSG=""
"RTN","DGENELA1",19,0)
 ;
"RTN","DGENELA1",20,0)
 D  ;drops out of block on failure
"RTN","DGENELA1",21,0)
 .;
"RTN","DGENELA1",22,0)
 .;get optional arrays if not there
"RTN","DGENELA1",23,0)
 .I '$D(DGPAT),'$$GET^DGENPTA(DGELG("DFN"),.DGPAT) S ERRMSG="PATIENT NOT FOUND" Q
"RTN","DGENELA1",24,0)
 .I '$D(DGCDIS),'$$GET^DGENCDA(DGELG("DFN"),.DGCDIS) S ERRMSG="PATIENT NOT FOUND" Q
"RTN","DGENELA1",25,0)
 .;
"RTN","DGENELA1",26,0)
 .;do field level checks
"RTN","DGENELA1",27,0)
 .S SUB="" F  S SUB=$O(DGELG(SUB)) Q:(SUB="")  I SUB'="ELIG",SUB'="RATEDIS",'$$CHKFIELD(SUB,DGELG(SUB)) S ERRMSG="BAD VALUE, FIELD = "_$$GET1^DID(2,$$FIELD(SUB),"","LABEL") Q
"RTN","DGENELA1",28,0)
 .;
"RTN","DGENELA1",29,0)
 .Q:(SUB'="")  ;didn't finish the loop
"RTN","DGENELA1",30,0)
 .;
"RTN","DGENELA1",31,0)
 .;also check SC % field of Rated Disabilities
"RTN","DGENELA1",32,0)
 .S SUB="" F  S SUB=$O(DGELG("RATEDIS",SUB)) Q:(SUB="")  I '$$CHKFIELD("PER",DGELG("RATEDIS",SUB,"PER")) S ERRMSG="BAD VALUE, FIELD = DISABILITY % OF THE RATED DISABILITIES MULTIPLE" Q
"RTN","DGENELA1",33,0)
 .Q:(SUB'="")  ;didn't finish the loop
"RTN","DGENELA1",34,0)
 .;
"RTN","DGENELA1",35,0)
 .I DGELG("SC")="Y",DGELG("SCPER")="" S ERRMSG="SC% UNSPECIFIED FOR SC VET" Q
"RTN","DGENELA1",36,0)
 .;
"RTN","DGENELA1",37,0)
 .;!! put this check back when POS is added to the Z11 message
"RTN","DGENELA1",38,0)
 .;I DGPAT("VETERAN")="Y",'DGELG("POS") S ERRMSG="POS UNSPECIFIED" Q 
"RTN","DGENELA1",39,0)
 .;
"RTN","DGENELA1",40,0)
 .I 'DGELG("ELIG","CODE") S ERRMSG="PRIMARY ELIGIBILITY IS UNSPECIFIED" Q
"RTN","DGENELA1",41,0)
 .;
"RTN","DGENELA1",42,0)
 .I (DGELG("VACKAMT")>0),(DGELG("A&A")_DGELG("HB")_DGELG("VAPEN")_DGELG("VADISAB")'["Y") S ERRMSG="VA CHECK AMOUNT > 0 BUT INCOME INDICATORS ALL SHOW 'NO'" Q
"RTN","DGENELA1",43,0)
 .;
"RTN","DGENELA1",44,0)
 .;
"RTN","DGENELA1",45,0)
 .;
"RTN","DGENELA1",46,0)
 .I (DGELG("SC")="N"),(DGELG("VADISAB")="Y") S ERRMSG="NSC VETERANS CAN NOT BE RECEIVING VA DISABILITY BENEFITS" Q
"RTN","DGENELA1",47,0)
 .;
"RTN","DGENELA1",48,0)
 .S BAD=1 D  Q:BAD  ;check primary eligibility
"RTN","DGENELA1",49,0)
 ..S NATCODE=$$NATCODE^DGENELA(DGELG("ELIG","CODE"))
"RTN","DGENELA1",50,0)
 ..Q:'NATCODE
"RTN","DGENELA1",51,0)
 ..;
"RTN","DGENELA1",52,0)
 ..I NATCODE=21 S ERRMSG="CATASTROPHICALLY DISABLED NOT ALLOWED AS PRIMARY ELIGIBILITY" Q
"RTN","DGENELA1",53,0)
 ..;
"RTN","DGENELA1",54,0)
 ..I (DGPAT("VETERAN")="Y"),(DGELG("SC")="Y"),(DGELG("SCPER")<50),(NATCODE'=3) S ERRMSG="PRIMARY ELIGIBILITY CODE INCONSISTENT WITH SERVICE CONNECTED PERCENTAGE" Q
"RTN","DGENELA1",55,0)
 ..;
"RTN","DGENELA1",56,0)
 ..I (DGPAT("VETERAN")="Y"),(DGELG("SC")="Y"),(DGELG("SCPER")>49),(NATCODE'=1) S ERRMSG="PRIMARY ELIGIBILITY CODE INCONSISTENT WITH SERVICE CONNECTED PERCENTAGE" Q
"RTN","DGENELA1",57,0)
 ..;
"RTN","DGENELA1",58,0)
 ..S DGONV=$O(^DIC(21,"B","OTHER NON-VETERANS","")),INELDATE=$P($G(^DPT(DFN,.15)),"^",2)
"RTN","DGENELA1",59,0)
 ..I INELDATE'="",DGPAT("INELDATE")'>0,DGELG("POS"),DGELG("POS")=DGONV,'$D(^DIC(21,DGELG("POS"),"E",DGELG("ELIG","CODE"))) D
"RTN","DGENELA1",60,0)
 ...S DGTEXT="Patient was previously determined to be ineligible for VA health care.  Upon review, the individual is now determined to be eligible for "
"RTN","DGENELA1",61,0)
 ...S DGTEXT=DGTEXT_"VA care.  Please update period of service and complete a new application for enrollment in VistA."
"RTN","DGENELA1",62,0)
 ...D ADDMSG^DGENUPL3(.MSGS,DGTEXT,0)
"RTN","DGENELA1",63,0)
 ..;
"RTN","DGENELA1",64,0)
 ..I (DGPAT("VETERAN")="Y"),(DGELG("SC")="Y"),(NATCODE=1)!(NATCODE=3) S BAD=0 Q  ;primary eligibility OK
"RTN","DGENELA1",65,0)
 ..;
"RTN","DGENELA1",66,0)
 ..I (DGPAT("VETERAN")="Y"),(DGELG("POW")="Y"),NATCODE'=18 S ERRMSG="PRIMARY ELIGIBILITY SHOULD BE PRISONER OF WAR" Q
"RTN","DGENELA1",67,0)
 ..;
"RTN","DGENELA1",68,0)
 ..I (DGPAT("VETERAN")="Y"),(DGELG("POW")="Y"),NATCODE=18 S BAD=0 Q
"RTN","DGENELA1",69,0)
 ..;
"RTN","DGENELA1",70,0)
 ..I (DGPAT("VETERAN")="Y"),(DGELG("PH")="Y"),NATCODE'=22 S ERRMSG="PRIMARY ELIGIBILITY SHOULD BE PURPLE HEART RECIPIENT" Q
"RTN","DGENELA1",71,0)
 ..;
"RTN","DGENELA1",72,0)
 ..I (DGPAT("VETERAN")="Y"),(DGELG("PH")="Y"),NATCODE=22 S BAD=0 Q
"RTN","DGENELA1",73,0)
 ..;
"RTN","DGENELA1",74,0)
 ..; disabled DG*5.3*367, for Inel
"RTN","DGENELA1",75,0)
 ..;I (DGPAT("VETERAN")'=$P($G(^DIC(8.1,NATCODE,0)),"^",5)) S ERRMSG="PRIMARY ELIGIBILTY NOT CONSISTENT WITH VETERAN STATUS" Q
"RTN","DGENELA1",76,0)
 ..;
"RTN","DGENELA1",77,0)
 ..I DGELG("A&A")'="Y",NATCODE=2 S ERRMSG="PRIMARY ELIGIBILITY INCONSISTENT WITH A&A INDICATOR" Q
"RTN","DGENELA1",78,0)
 ..;
"RTN","DGENELA1",79,0)
 ..I DGELG("HB")'="Y",NATCODE=15 S ERRMSG="PRIMARY ELIGIBILITY INCONSISTENT WITH HOUSEBOUND INDICATOR" Q
"RTN","DGENELA1",80,0)
 ..;
"RTN","DGENELA1",81,0)
 ..I DGELG("VAPEN")'="Y",NATCODE=4 S ERRMSG="PRIMARY ELIGIBILITY INCONSISTENT WITH VA PENSION INDICATOR" Q
"RTN","DGENELA1",82,0)
 ..;
"RTN","DGENELA1",83,0)
 ..I DGELG("SC")="Y",((NATCODE=4)!(NATCODE=5)) S ERRMSG="NSC ELIGIBILITY CODE INCONSISTENT WITH SERVICE CONNECTION INDICATOR" Q
"RTN","DGENELA1",84,0)
 ..;
"RTN","DGENELA1",85,0)
 ..I (DGPAT("DOB")>2061231),(NATCODE=16) S ERRMSG="DOB IS INCONSISTENT WITH ELIGIBILITY OF MEXICAN BORDER WAR" Q
"RTN","DGENELA1",86,0)
 ..;
"RTN","DGENELA1",87,0)
 ..I (DGPAT("DOB")>2071231),(NATCODE=17) S ERRMSG="DOB IS INCONSISTENT WITH ELIGIBILITY OF WORLD WAR I" Q
"RTN","DGENELA1",88,0)
 ..;
"RTN","DGENELA1",89,0)
 ..;primary eligibility is good
"RTN","DGENELA1",90,0)
 ..S BAD=0
"RTN","DGENELA1",91,0)
 .;
"RTN","DGENELA1",92,0)
 .S SUCCESS=1
"RTN","DGENELA1",93,0)
 .;check eligibilities multiple
"RTN","DGENELA1",94,0)
 .S CODE=0 F  S CODE=$O(DGELG("ELIG","CODE",CODE)) Q:'CODE  D  Q:('SUCCESS)
"RTN","DGENELA1",95,0)
 ..S NATCODE=$$NATCODE^DGENELA(CODE)
"RTN","DGENELA1",96,0)
 ..Q:'NATCODE
"RTN","DGENELA1",97,0)
 ..I NATCODE=21,'DGCDIS("DATE") S SUCCESS=0,ERRMSG="CATASTROPHICALLY DISABLED ELIGIBILITY REQUIRES CATASTROPHICALLY DISABLED DETERMINATION DATE" Q
"RTN","DGENELA1",98,0)
 .;
"RTN","DGENELA1",99,0)
 Q SUCCESS
"RTN","DGENELA1",100,0)
 ;
"RTN","DGENELA1",101,0)
STORE(DGELG,DGPAT,DGCDIS,ERROR,SKIPCHK) ;
"RTN","DGENELA1",102,0)
 ;Stores an eligibility record for a patient. The patient record must
"RTN","DGENELA1",103,0)
 ;already exist. A lock on the Patient record is required, and is
"RTN","DGENELA1",104,0)
 ;released upon completion.
"RTN","DGENELA1",105,0)
 ;
"RTN","DGENELA1",106,0)
 ;Input:
"RTN","DGENELA1",107,0)
 ;  DGELG - eligibility array (pass by reference)
"RTN","DGENELA1",108,0)
 ;  DGPAT - patient array (optional, pass by reference)
"RTN","DGENELA1",109,0)
 ;  DGCDIS - array containing the catastrophic disability determination (optional, pass by reference)
"RTN","DGENELA1",110,0)
 ;  SKIPCHK - flag, set to 1 means that the consistency checks
"RTN","DGENELA1",111,0)
 ;            were already done & should be skipped
"RTN","DGENELA1",112,0)
 ;
"RTN","DGENELA1",113,0)
 ;Output:
"RTN","DGENELA1",114,0)
 ;  Function Value - returns 1 if successful, otherwise 0
"RTN","DGENELA1",115,0)
 ;  ERROR - in event of failure returns an error message (pass by reference, optional)
"RTN","DGENELA1",116,0)
 ;
"RTN","DGENELA1",117,0)
 N SUCCESS,DATA,FIELD,DA,DFN,COUNT
"RTN","DGENELA1",118,0)
 S DFN=$G(DGELG("DFN"))
"RTN","DGENELA1",119,0)
 S SUCCESS=0
"RTN","DGENELA1",120,0)
 S ERROR=""
"RTN","DGENELA1",121,0)
 ;
"RTN","DGENELA1",122,0)
 D  ;drops out of block on failure
"RTN","DGENELA1",123,0)
 .I '$$LOCK^DGENPTA1(DFN) S ERROR="UNABLE TO LOCK PATIENT RECORD" Q
"RTN","DGENELA1",124,0)
 .I $G(SKIPCHK)'=1,'$$CHECK(.DGELG,.DGPAT,.DGCDIS,.ERROR) Q
"RTN","DGENELA1",125,0)
 .S SUB="" F  S SUB=$O(DGELG(SUB)) Q:SUB=""  D
"RTN","DGENELA1",126,0)
 ..I SUB'="ELIG",SUB'="RATEDIS",SUB'="DFN" S FIELD=$$FIELD(SUB) I FIELD S DATA(FIELD)=DGELG(SUB)
"RTN","DGENELA1",127,0)
 .;
"RTN","DGENELA1",128,0)
 .;don't add the Primary Eligibility unless different, so as to not
"RTN","DGENELA1",129,0)
 .;fire off x-refs unless necessary
"RTN","DGENELA1",130,0)
 .I $P($G(^DPT(DFN,.36)),"^")'=DGELG("ELIG","CODE") S DATA(.361)=DGELG("ELIG","CODE")
"RTN","DGENELA1",131,0)
 .;
"RTN","DGENELA1",132,0)
 .; Only update User Enrollee fields if the incoming UE status is
"RTN","DGENELA1",133,0)
 .; greater than the USER ENROLLEE VALID THROUGH on file.
"RTN","DGENELA1",134,0)
 .I $G(DATA(.3617))<$P($G(^DPT(DFN,.361)),"^",7) K DATA(.3617),DATA(.3618)
"RTN","DGENELA1",135,0)
 .;
"RTN","DGENELA1",136,0)
 .I '$$UPD^DGENDBS(2,DFN,.DATA) S ERROR="FILEMAN FAILED TO UPDATE THE PATIENT RECORD" Q
"RTN","DGENELA1",137,0)
 .;
"RTN","DGENELA1",138,0)
 .;
"RTN","DGENELA1",139,0)
 .;delete eligibilities that do not belong
"RTN","DGENELA1",140,0)
 .D DELELIG^DGENELA2(DFN,.DGELG)
"RTN","DGENELA1",141,0)
 .;
"RTN","DGENELA1",142,0)
 .;overlay Rated Disabilities
"RTN","DGENELA1",143,0)
 .Q:'$$OVERLAY()
"RTN","DGENELA1",144,0)
 .;
"RTN","DGENELA1",145,0)
 .;Add the new Patient Eligibilities
"RTN","DGENELA1",146,0)
 .;Don't add the an eligibility unless different - so as to not
"RTN","DGENELA1",147,0)
 .;fire off the x-refs unless necessary.
"RTN","DGENELA1",148,0)
 .;Also, try to assign ien = the code (see input tranform of the field).
"RTN","DGENELA1",149,0)
 .K DA,DATA
"RTN","DGENELA1",150,0)
 .S DA(1)=DFN
"RTN","DGENELA1",151,0)
 .S DATA(.01)=0
"RTN","DGENELA1",152,0)
 .F  S DATA(.01)=$O(DGELG("ELIG","CODE",DATA(.01))) Q:'DATA(.01)  I '$D(^DPT(DFN,"E","B",DATA(.01))) I '$$ADD^DGENDBS(2.0361,.DA,.DATA,,$S($D(^DPT(DFN,"E",DATA(.01))):0,1:DATA(.01))) S ERROR="FILEMAN FAILED TO ADD PATIENT ELIGIBILITY" Q
"RTN","DGENELA1",153,0)
 .;
"RTN","DGENELA1",154,0)
 .S SUCCESS=1
"RTN","DGENELA1",155,0)
 ;
"RTN","DGENELA1",156,0)
 D UNLOCK^DGENPTA1(DFN)
"RTN","DGENELA1",157,0)
 Q SUCCESS
"RTN","DGENELA1",158,0)
 ;
"RTN","DGENELA1",159,0)
FIELD(SUB) ;
"RTN","DGENELA1",160,0)
 ;given a subscript from the ELIGIBILITY array, returns the field number
"RTN","DGENELA1",161,0)
 ;
"RTN","DGENELA1",162,0)
 Q:SUB="CODE" .361
"RTN","DGENELA1",163,0)
 Q:SUB="SC" .301
"RTN","DGENELA1",164,0)
 Q:SUB="SCPER" .302
"RTN","DGENELA1",165,0)
 Q:SUB="EFFDT" .3014
"RTN","DGENELA1",166,0)
 Q:SUB="POW" .525
"RTN","DGENELA1",167,0)
 Q:SUB="PH" .531
"RTN","DGENELA1",168,0)
 Q:SUB="A&A" .36205
"RTN","DGENELA1",169,0)
 Q:SUB="HB" .36215
"RTN","DGENELA1",170,0)
 Q:SUB="VAPEN" .36235
"RTN","DGENELA1",171,0)
 Q:SUB="VACKAMT" .36295
"RTN","DGENELA1",172,0)
 Q:SUB="DISRET" .362
"RTN","DGENELA1",173,0)
 Q:SUB="MEDICAID" .381
"RTN","DGENELA1",174,0)
 Q:SUB="AO" .32102
"RTN","DGENELA1",175,0)
 Q:SUB="IR" .32103
"RTN","DGENELA1",176,0)
 Q:SUB="EC" .322013
"RTN","DGENELA1",177,0)
 Q:SUB="MTSTA" ""  ;don't map Means Test Category
"RTN","DGENELA1",178,0)
 Q:SUB="P&T" .304
"RTN","DGENELA1",179,0)
 Q:SUB="POS" .323
"RTN","DGENELA1",180,0)
 Q:SUB="UNEMPLOY" .305
"RTN","DGENELA1",181,0)
 Q:SUB="SCAWDATE" .3012
"RTN","DGENELA1",182,0)
 Q:SUB="RATEINC" .293
"RTN","DGENELA1",183,0)
 Q:SUB="CLAIMNUM" .313
"RTN","DGENELA1",184,0)
 ;Q:SUB="CLAIMLOC" .312 ; ** removed **
"RTN","DGENELA1",185,0)
 Q:SUB="VADISAB" .3025
"RTN","DGENELA1",186,0)
 Q:SUB="ELIGSTA" .3611
"RTN","DGENELA1",187,0)
 Q:SUB="ELIGSTADATE" .3612
"RTN","DGENELA1",188,0)
 Q:SUB="ELIGVERIF" .3615
"RTN","DGENELA1",189,0)
 Q:SUB="ELIGENTBY" .3616
"RTN","DGENELA1",190,0)
 Q:SUB="RD" .01
"RTN","DGENELA1",191,0)
 Q:SUB="PER" 2
"RTN","DGENELA1",192,0)
 Q:SUB="RDSC" 3
"RTN","DGENELA1",193,0)
 Q:SUB="RDEXT" 4
"RTN","DGENELA1",194,0)
 Q:SUB="RDORIG" 5
"RTN","DGENELA1",195,0)
 Q:SUB="RDCURR" 6
"RTN","DGENELA1",196,0)
 Q:SUB="UEYEAR" .3617
"RTN","DGENELA1",197,0)
 Q:SUB="UESITE" .3618
"RTN","DGENELA1",198,0)
 Q:SUB="AOEXPLOC" .3213
"RTN","DGENELA1",199,0)
 Q:SUB="CVELEDT" .5295
"RTN","DGENELA1",200,0)
 ;
"RTN","DGENELA1",201,0)
 Q ""
"RTN","DGENELA1",202,0)
 ;
"RTN","DGENELA1",203,0)
CHKFIELD(SUB,VAL) ;
"RTN","DGENELA1",204,0)
 ;Description: Does field level validation of the value. Returns 1
"RTN","DGENELA1",205,0)
 ;if the value is good, 0 otherwise.
"RTN","DGENELA1",206,0)
 ;
"RTN","DGENELA1",207,0)
 Q:($G(VAL)="") 1  ;for now, all NULL values assumed okay
"RTN","DGENELA1",208,0)
 ;
"RTN","DGENELA1",209,0)
 N BAD S BAD=0
"RTN","DGENELA1",210,0)
 I (SUB="SCPER")!(SUB="PER"),(+VAL'=VAL)!(VAL>100)!(VAL<0)!(VAL?.E1"."1N.N) S BAD=1
"RTN","DGENELA1",211,0)
 I SUB="VACKAMT",+VAL'=VAL&(VAL'?.N1"."2N)!(VAL>99999)!(VAL<0) S BAD=1
"RTN","DGENELA1",212,0)
 I SUB="DISRET",VAL'=0,VAL'=1,VAL'=2,VAL'=3 S BAD=1
"RTN","DGENELA1",213,0)
 I SUB="MEDICAID",VAL'=0,VAL'=1 S BAD=1
"RTN","DGENELA1",214,0)
 I SUB="RATEINC",VAL'=0,VAL'=1 S BAD=1
"RTN","DGENELA1",215,0)
 I SUB="CLAIMLOC",(VAL["""")!($A(VAL)=45)!($L(VAL)>40)!($L(VAL)<2) S BAD=1
"RTN","DGENELA1",216,0)
 I SUB="ELIGSTA",VAL'="P",VAL'="R",VAL'="V" S BAD=1
"RTN","DGENELA1",217,0)
 I SUB="POW",VAL'="Y",VAL'="N",VAL'="U" S BAD=1
"RTN","DGENELA1",218,0)
 Q 'BAD
"RTN","DGENELA1",219,0)
 ;
"RTN","DGENELA1",220,0)
 ;
"RTN","DGENELA1",221,0)
OVERLAY() ;
"RTN","DGENELA1",222,0)
 ;Description: Overlay the local Rated Disabilities with whatever HEC
"RTN","DGENELA1",223,0)
 ;sent.
"RTN","DGENELA1",224,0)
 ;
"RTN","DGENELA1",225,0)
 N SUCCESS S SUCCESS=1
"RTN","DGENELA1",226,0)
 ;
"RTN","DGENELA1",227,0)
 ;delete the rated disabilties multiple
"RTN","DGENELA1",228,0)
 D DELRDIS^DGENELA2(DFN)
"RTN","DGENELA1",229,0)
 ;
"RTN","DGENELA1",230,0)
 ;add the rated disabilities
"RTN","DGENELA1",231,0)
 K DATA,DA
"RTN","DGENELA1",232,0)
 S DA(1)=DFN
"RTN","DGENELA1",233,0)
 S COUNT=0
"RTN","DGENELA1",234,0)
 F  S COUNT=$O(DGELG("RATEDIS",COUNT)) Q:'COUNT  D
"RTN","DGENELA1",235,0)
 .S DATA(.01)=DGELG("RATEDIS",COUNT,"RD")
"RTN","DGENELA1",236,0)
 .I DATA(.01) D
"RTN","DGENELA1",237,0)
 ..S DATA(2)=DGELG("RATEDIS",COUNT,"PER")
"RTN","DGENELA1",238,0)
 ..S DATA(3)=DGELG("RATEDIS",COUNT,"RDSC")
"RTN","DGENELA1",239,0)
 ..S DATA(4)=DGELG("RATEDIS",COUNT,"RDEXT")
"RTN","DGENELA1",240,0)
 ..S DATA(5)=DGELG("RATEDIS",COUNT,"RDORIG")
"RTN","DGENELA1",241,0)
 ..S DATA(6)=DGELG("RATEDIS",COUNT,"RDCURR")
"RTN","DGENELA1",242,0)
 ..I '$$ADD^DGENDBS(2.04,.DA,.DATA) S ERROR="FILEMAN FAILED TO ADD RATED DISABILTIES",SUCCESS=0
"RTN","DGENELA1",243,0)
 Q SUCCESS
"RTN","DGENUPL2")
0^6^B53254236
"RTN","DGENUPL2",1,0)
DGENUPL2 ;ALB/CJM,RTK,ISA/KWP/RMM/CKN - PROCESS INCOMING (Z11 EVENT TYPE) HL7 MESSAGES ; 9/26/05 3:09pm
"RTN","DGENUPL2",2,0)
 ;;5.3;REGISTRATION;**147,222,232,310,314,367,397,677,631**;Aug 13,1993
"RTN","DGENUPL2",3,0)
 ;
"RTN","DGENUPL2",4,0)
 ;
"RTN","DGENUPL2",5,0)
 ;***************************************************************
"RTN","DGENUPL2",6,0)
 ;The following procedures parse particular segment types.
"RTN","DGENUPL2",7,0)
 ;Input:SEG(),MSGID
"RTN","DGENUPL2",8,0)
 ;Output:DGPAT(),DGELG(),DGENR(),DGCDIS(),DGNTR(),ERROR
"RTN","DGENUPL2",9,0)
 ;***************************************************************
"RTN","DGENUPL2",10,0)
 ;
"RTN","DGENUPL2",11,0)
PID ;
"RTN","DGENUPL2",12,0)
 S DGPAT("SSN")=SEG(19)
"RTN","DGENUPL2",13,0)
 Q
"RTN","DGENUPL2",14,0)
 ;
"RTN","DGENUPL2",15,0)
ZPD ;
"RTN","DGENUPL2",16,0)
 S DGELG("RATEINC")=$$CONVERT^DGENUPL1(SEG(8))
"RTN","DGENUPL2",17,0)
 S DGPAT("DEATH")=$$CONVERT^DGENUPL1(SEG(9),"TS",.ERROR)
"RTN","DGENUPL2",18,0)
 I ERROR D  Q
"RTN","DGENUPL2",19,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZPD SEGMENT, SEQ 9",.ERRCOUNT)
"RTN","DGENUPL2",20,0)
 S DGELG("MEDICAID")=$$CONVERT^DGENUPL1(SEG(12))
"RTN","DGENUPL2",21,0)
 S DGELG("POW")=$$CONVERT^DGENUPL1(SEG(17))
"RTN","DGENUPL2",22,0)
 S DGPAT("EMGRES")=$$CONVERT^DGENUPL1(SEG(40))   ;DG*5.3*677
"RTN","DGENUPL2",23,0)
 Q
"RTN","DGENUPL2",24,0)
 ;
"RTN","DGENUPL2",25,0)
ZIE ;
"RTN","DGENUPL2",26,0)
 S DGPAT("INELDATE")=$$CONVERT^DGENUPL1(SEG(2),"DATE",.ERROR)
"RTN","DGENUPL2",27,0)
 I ERROR D  Q
"RTN","DGENUPL2",28,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZIE SEGMENT, SEQ 2",.ERRCOUNT)
"RTN","DGENUPL2",29,0)
 S DGPAT("INELREA")=$$CONVERT^DGENUPL1(SEG(3))
"RTN","DGENUPL2",30,0)
 S DGPAT("INELDEC")=$$CONVERT^DGENUPL1(SEG(4))
"RTN","DGENUPL2",31,0)
 Q
"RTN","DGENUPL2",32,0)
 ;
"RTN","DGENUPL2",33,0)
ZEL(COUNT) ;
"RTN","DGENUPL2",34,0)
 D ZEL^DGENUPLA(COUNT)  ;code for ZEL segment has moved to DGENUPLA
"RTN","DGENUPL2",35,0)
 Q
"RTN","DGENUPL2",36,0)
 ;
"RTN","DGENUPL2",37,0)
ZEN ;
"RTN","DGENUPL2",38,0)
 N SUB
"RTN","DGENUPL2",39,0)
 S DGENR("DATE")=$$CONVERT^DGENUPL1(SEG(2),"DATE",.ERROR)
"RTN","DGENUPL2",40,0)
 I ERROR D  Q
"RTN","DGENUPL2",41,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZEN SEGMENT, SEQ 2",.ERRCOUNT)
"RTN","DGENUPL2",42,0)
 S DGENR("SOURCE")=$$CONVERT^DGENUPL1(SEG(3))
"RTN","DGENUPL2",43,0)
 S DGENR("STATUS")=$$CONVERT^DGENUPL1(SEG(4))
"RTN","DGENUPL2",44,0)
 S DGENR("REASON")=$$CONVERT^DGENUPL1(SEG(5))
"RTN","DGENUPL2",45,0)
 S DGENR("REMARKS")=$$CONVERT^DGENUPL1(SEG(6))
"RTN","DGENUPL2",46,0)
 S DGENR("FACREC")=$$CONVERT^DGENUPL1(SEG(7),"INSTITUTION",.ERROR)
"RTN","DGENUPL2",47,0)
 I ERROR D  Q
"RTN","DGENUPL2",48,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"FACILITY RECEIVED "_SEG(7)_" NOT FOUND IN THE INSTITUTION FILE",.ERRCOUNT)
"RTN","DGENUPL2",49,0)
 S DGPAT("PREFAC")=$$CONVERT^DGENUPL1(SEG(8),"INSTITUTION",.ERROR)
"RTN","DGENUPL2",50,0)
 I ERROR D  Q
"RTN","DGENUPL2",51,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"PREFERRED FACILITY "_SEG(8)_" NOT FOUND IN THE INSTITUTION FILE",.ERRCOUNT)
"RTN","DGENUPL2",52,0)
 ;
"RTN","DGENUPL2",53,0)
 S DGENR("PRIORITY")=$$CONVERT^DGENUPL1(SEG(9))
"RTN","DGENUPL2",54,0)
 S DGENR("EFFDATE")=$$CONVERT^DGENUPL1(SEG(10),"DATE",.ERROR)
"RTN","DGENUPL2",55,0)
 I ERROR D  Q
"RTN","DGENUPL2",56,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZEN SEGMENT, SEQ 10",.ERRCOUNT)
"RTN","DGENUPL2",57,0)
 S DGENR("APP")=$$CONVERT^DGENUPL1(SEG(11),"DATE",.ERROR)
"RTN","DGENUPL2",58,0)
 I ERROR D  Q
"RTN","DGENUPL2",59,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZEN SEGMENT, SEQ 11",.ERRCOUNT)
"RTN","DGENUPL2",60,0)
 ;
"RTN","DGENUPL2",61,0)
 ;!!!!!!!!! take this next line out when HEC begins transmitting the applicatizon date
"RTN","DGENUPL2",62,0)
 I DGENR("APP")="" S DGENR("APP")=DGENR("DATE")
"RTN","DGENUPL2",63,0)
 I DGENR("APP")="" S DGENR("APP")=DGENR("EFFDATE")
"RTN","DGENUPL2",64,0)
 ;
"RTN","DGENUPL2",65,0)
 S DGENR("END")=$$CONVERT^DGENUPL1(SEG(12),"DATE",.ERROR)
"RTN","DGENUPL2",66,0)
 I ERROR D  Q
"RTN","DGENUPL2",67,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZEN SEGMENT, SEQ 12",.ERRCOUNT)
"RTN","DGENUPL2",68,0)
 ;Phase II Parse out Sub-Group (SRS 6.4)
"RTN","DGENUPL2",69,0)
 S DGENR("SUBGRP")=$$CONVERT^DGENUPL1(SEG(13))
"RTN","DGENUPL2",70,0)
 ;
"RTN","DGENUPL2",71,0)
 ;want to ignore double quotes sent for enrollment fields
"RTN","DGENUPL2",72,0)
 S SUB=""
"RTN","DGENUPL2",73,0)
 F  S SUB=$O(DGENR(SUB)) Q:SUB=""  I DGENR(SUB)="@" S DGENR(SUB)=""
"RTN","DGENUPL2",74,0)
 ;
"RTN","DGENUPL2",75,0)
 Q
"RTN","DGENUPL2",76,0)
 ;
"RTN","DGENUPL2",77,0)
ZMT ;
"RTN","DGENUPL2",78,0)
 I SEG(1)>1 D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"ZMT SEGMENT, SEQ 1, SHOULD SPECIFY MEANS TEST",.ERRCOUNT) S ERROR=1 Q
"RTN","DGENUPL2",79,0)
 S DGELG("MTSTA")=$$CONVERT^DGENUPL1(SEG(3),"MT",.ERROR)
"RTN","DGENUPL2",80,0)
 I ERROR D  Q
"RTN","DGENUPL2",81,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZMT SEGMENT, SEQ 3",.ERRCOUNT)
"RTN","DGENUPL2",82,0)
 Q
"RTN","DGENUPL2",83,0)
 ;
"RTN","DGENUPL2",84,0)
ZCD ;
"RTN","DGENUPL2",85,0)
 ;Phase II for multiple ZCD's
"RTN","DGENUPL2",86,0)
 I SEG(1)>1 G SKIP
"RTN","DGENUPL2",87,0)
 S DGCDIS("BY")=$$CONVERT^DGENUPL1(SEG(3))
"RTN","DGENUPL2",88,0)
 S DGCDIS("DATE")=$$CONVERT^DGENUPL1(SEG(5),"DATE",.ERROR)
"RTN","DGENUPL2",89,0)
 I ERROR D  Q
"RTN","DGENUPL2",90,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZCD SEGMENT, SEQ 5",.ERRCOUNT)
"RTN","DGENUPL2",91,0)
 S DGCDIS("FACDET")=$$CONVERT^DGENUPL1(SEG(4),"INSTITUTION",.ERROR)
"RTN","DGENUPL2",92,0)
 I ERROR D  Q
"RTN","DGENUPL2",93,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"FACILITY "_SEG(4)_" MAKING CATASTROPHIC DISABILITY DETERMINATION NOT FOUND IN THE INSTITUTION FILE",.ERRCOUNT)
"RTN","DGENUPL2",94,0)
 S DGCDIS("REVDTE")=$$CONVERT^DGENUPL1(SEG(2),"DATE",.ERROR)
"RTN","DGENUPL2",95,0)
 I ERROR D  Q
"RTN","DGENUPL2",96,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZCD SEGMENT, SEQ 2",.ERRCOUNT)
"RTN","DGENUPL2",97,0)
 S DGCDIS("METDET")=$$CONVERT^DGENUPL1($P(SEG(6),$E(HLECH)))
"RTN","DGENUPL2",98,0)
 S DGCDIS("VCD")=$$CONVERT^DGENUPL1(SEG(12))
"RTN","DGENUPL2",99,0)
SKIP ;
"RTN","DGENUPL2",100,0)
 ;Phase II Parse out additional fields.  CONVERT type of RSN converts the code to IEN for diagnosis,procedure and condition (HL7TORSN^DGENA5).
"RTN","DGENUPL2",101,0)
 S DGCDIS("DIAG",SEG(1))=$$CONVERT^DGENUPL1(SEG(7),"CDRSN")
"RTN","DGENUPL2",102,0)
 S DGCDIS("PROC",SEG(1))=$$CONVERT^DGENUPL1(SEG(8),"CDRSN")
"RTN","DGENUPL2",103,0)
 S DGCDIS("EXT",SEG(1))=$$CONVERT^DGENUPL1($P(SEG(9),$E(HLECH)),"EXT")
"RTN","DGENUPL2",104,0)
 S DGCDIS("COND",SEG(1))=$$CONVERT^DGENUPL1(SEG(10),"CDRSN")
"RTN","DGENUPL2",105,0)
 S DGCDIS("SCORE",SEG(1))=$$CONVERT^DGENUPL1($P(SEG(11),$E(HLECH)))
"RTN","DGENUPL2",106,0)
 S DGCDIS("PERM",SEG(1))=$$CONVERT^DGENUPL1($P(SEG(13),$E(HLECH)))
"RTN","DGENUPL2",107,0)
 I DGCDIS("VCD")="Y",'DGCDIS("DIAG",SEG(1)),'DGCDIS("PROC",SEG(1)),'DGCDIS("COND",SEG(1)) D  Q
"RTN","DGENUPL2",108,0)
 .S ERROR=1 D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"NO VALID DIAGNOSIS,PROCEDURE, OR CONDITION IN THE ZCD SEGMENT",.ERRCOUNT)
"RTN","DGENUPL2",109,0)
 Q
"RTN","DGENUPL2",110,0)
 ;
"RTN","DGENUPL2",111,0)
ZSP ;
"RTN","DGENUPL2",112,0)
 S DGELG("SC")=$$CONVERT^DGENUPL1(SEG(2),"Y/N",.ERROR)
"RTN","DGENUPL2",113,0)
 I ERROR D  Q
"RTN","DGENUPL2",114,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZSP SEGMENT, SEQ 2",.ERRCOUNT)
"RTN","DGENUPL2",115,0)
 S DGELG("SCPER")=$$CONVERT^DGENUPL1(SEG(3))
"RTN","DGENUPL2",116,0)
 S DGELG("EFFDT")=$$CONVERT^DGENUPL1(SEG(11),"DATE",.ERROR)
"RTN","DGENUPL2",117,0)
 I ERROR D  Q
"RTN","DGENUPL2",118,0)
 . D ADDERROR^DGENUPL(MSGID,$G(DGELG("EFFDT")),"BAD VALUE, ZSP SEGMENT, SEQ 11",.ERRCOUNT)
"RTN","DGENUPL2",119,0)
 ;if effective date is null, set update value to "@" (delete)
"RTN","DGENUPL2",120,0)
 I DGELG("EFFDT")="" S DGELG("EFFDT")="@"
"RTN","DGENUPL2",121,0)
 ;
"RTN","DGENUPL2",122,0)
 ;added 8/3/98 to reduce #rejects
"RTN","DGENUPL2",123,0)
 ;if HEC sends SC=NO, SC% not sent, and site has value for SC% then delete it
"RTN","DGENUPL2",124,0)
 I DGELG("SC")="N",DGELG("SCPER")="" S DGELG("SCPER")="@"
"RTN","DGENUPL2",125,0)
 ;
"RTN","DGENUPL2",126,0)
 S DGELG("P&T")=$$CONVERT^DGENUPL1(SEG(6),"Y/N",.ERROR)
"RTN","DGENUPL2",127,0)
 I ERROR D  Q
"RTN","DGENUPL2",128,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZSP SEGMENT, SEQ 6",.ERRCOUNT)
"RTN","DGENUPL2",129,0)
 S DGELG("UNEMPLOY")=$$CONVERT^DGENUPL1(SEG(7),"Y/N",.ERROR)
"RTN","DGENUPL2",130,0)
 I ERROR D  Q
"RTN","DGENUPL2",131,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZSP SEGMENT, SEQ 7",.ERRCOUNT)
"RTN","DGENUPL2",132,0)
 S DGELG("SCAWDATE")=$$CONVERT^DGENUPL1(SEG(8),"DATE",.ERROR)
"RTN","DGENUPL2",133,0)
 I ERROR D  Q
"RTN","DGENUPL2",134,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZSP SEGMENT, SEQ 8",.ERRCOUNT)
"RTN","DGENUPL2",135,0)
 Q
"RTN","DGENUPL2",136,0)
 ;
"RTN","DGENUPL2",137,0)
ZMH ; Purple Heart
"RTN","DGENUPL2",138,0)
 Q:SEG(2)'="PH"      ;ONLY PROCESS PURPLE HEART FROM ZMH
"RTN","DGENUPL2",139,0)
 S DGPAT("PHI")=$P(SEG(3),$E(HLECH))
"RTN","DGENUPL2",140,0)
 S DGELG("PH")=$$CONVERT^DGENUPL1($P(SEG(3),$E(HLECH)))
"RTN","DGENUPL2",141,0)
 S DGPAT("PHST")=$P(SEG(3),$E(HLECH),2)
"RTN","DGENUPL2",142,0)
 S DGPAT("PHRR")=$P(SEG(3),$E(HLECH),3)
"RTN","DGENUPL2",143,0)
 Q
"RTN","DGENUPL2",144,0)
 ;
"RTN","DGENUPL2",145,0)
ZRD ;
"RTN","DGENUPL2",146,0)
 N COUNT,DXCODE,NAME,COND
"RTN","DGENUPL2",147,0)
 S DXCODE=$P(SEG(2),$E(HLECH))
"RTN","DGENUPL2",148,0)
 I DXCODE="""""" S DXCODE=""
"RTN","DGENUPL2",149,0)
 S NAME=$P(SEG(2),$E(HLECH),2)
"RTN","DGENUPL2",150,0)
 Q:DXCODE=""  ;segment does not contain a disability condition
"RTN","DGENUPL2",151,0)
 ;
"RTN","DGENUPL2",152,0)
 S COUNT=1+(+$G(DGELG("RATEDIS")))
"RTN","DGENUPL2",153,0)
 S (COND,DGELG("RATEDIS",COUNT,"RD"))=$$DCLOOKUP(DXCODE,NAME)
"RTN","DGENUPL2",154,0)
 S DGELG("RATEDIS",COUNT,"PER")=SEG(3),DGELG("RATEDIS")=COUNT
"RTN","DGENUPL2",155,0)
 S DGELG("RATEDIS",COUNT,"RDEXT")=SEG(12)
"RTN","DGENUPL2",156,0)
 S DGELG("RATEDIS",COUNT,"RDORIG")=$$CONVERT^DGENUPL1(SEG(13),"DATE",.ERROR)
"RTN","DGENUPL2",157,0)
 I ERROR D  Q
"RTN","DGENUPL2",158,0)
 . D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZRD SEGMENT, S 13",.ERRCOUNT)
"RTN","DGENUPL2",159,0)
 S DGELG("RATEDIS",COUNT,"RDCURR")=$$CONVERT^DGENUPL1(SEG(14),"DATE",.ERROR)
"RTN","DGENUPL2",160,0)
 I ERROR D  Q
"RTN","DGENUPL2",161,0)
 . D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZRD SEGMENT, S 14",.ERRCOUNT)
"RTN","DGENUPL2",162,0)
 I 'COND D  Q
"RTN","DGENUPL2",163,0)
 .D ADDERROR^DGENUPL(MSGID,$G(DGPAT("SSN")),"BAD VALUE, ZRD SEGMENT, SEQ 2 - DISABILTY CONDITION LOOKUP FAILED",.ERRCOUNT)
"RTN","DGENUPL2",164,0)
 .S ERROR=1
"RTN","DGENUPL2",165,0)
 Q
"RTN","DGENUPL2",166,0)
OBX ;
"RTN","DGENUPL2",167,0)
 D OBX^DGENUPLA  ;code for OBX segment has moved to DGENUPLA
"RTN","DGENUPL2",168,0)
 Q
"RTN","DGENUPL2",169,0)
 ;
"RTN","DGENUPL2",170,0)
 ;******************end of segment parsers*********************
"RTN","DGENUPL2",171,0)
 ;
"RTN","DGENUPL2",172,0)
DCLOOKUP(DGCODE,DGNAME) ;
"RTN","DGENUPL2",173,0)
 ;Description: Returns the ien of an Disability Condition (file #31) based on the DXCODE and NAME
"RTN","DGENUPL2",174,0)
 ;
"RTN","DGENUPL2",175,0)
 ;Input:
"RTN","DGENUPL2",176,0)
 ;  DXCODE - the DX Code of the Disability Condition
"RTN","DGENUPL2",177,0)
 ;  NAME - the name of the Disability Condition
"RTN","DGENUPL2",178,0)
 ;Output:
"RTN","DGENUPL2",179,0)
 ;  Function Value: the ien of the entry found, or 0 otherwise
"RTN","DGENUPL2",180,0)
 ;
"RTN","DGENUPL2",181,0)
 Q:(DXCODE="") 0
"RTN","DGENUPL2",182,0)
 N NODE,IEN,FOUND
"RTN","DGENUPL2",183,0)
 S (FOUND,IEN)=0
"RTN","DGENUPL2",184,0)
 F  S IEN=$O(^DIC(31,"C",DXCODE,IEN)) Q:'IEN  D  Q:FOUND
"RTN","DGENUPL2",185,0)
 .S NODE=$G(^DIC(31,IEN,0))
"RTN","DGENUPL2",186,0)
 .I NAME=$P(NODE,"^"),DXCODE=$P(NODE,"^",3) S FOUND=1
"RTN","DGENUPL2",187,0)
 I 'FOUND S IEN=$O(^DIC(31,"C",DXCODE,0))
"RTN","DGENUPL2",188,0)
 Q +IEN
"RTN","DGENUPL2",189,0)
 ;
"RTN","DGENUPL2",190,0)
REGCHECK(DFN) ;
"RTN","DGENUPL2",191,0)
 ;Description: passes patient through the registration consistency checker
"RTN","DGENUPL2",192,0)
 ;Input -
"RTN","DGENUPL2",193,0)
 ;  DFN is a pointer to the Patient File
"RTN","DGENUPL2",194,0)
 ;
"RTN","DGENUPL2",195,0)
 N DGCD,DGCHK,DGDAY,DGEDCN,DGER,DGLST,DGNCK,DGRPCOLD,DGSC,DGTYPE,DGVT,VA,X
"RTN","DGENUPL2",196,0)
 ;
"RTN","DGENUPL2",197,0)
 S DGEDCN=0
"RTN","DGENUPL2",198,0)
 D ^DGRPC
"RTN","DGENUPL2",199,0)
 Q
"RTN","DGRP11")
0^1^B10177307
"RTN","DGRP11",1,0)
DGRP11 ;ALB/MRL,RTK - REGISTRATION SCREEN 11/VERIFICATION INFORMATION ; 8/24/05 11:31pm
"RTN","DGRP11",2,0)
 ;;5.3;Registration;**327,631**;Aug 13, 1993
"RTN","DGRP11",3,0)
 S DGRPS=11 D H^DGRPU F I=.3,.32,.36,.361,"TYPE","VET" S DGRP(I)=$S($D(^DPT(DFN,I)):^(I),1:"")
"RTN","DGRP11",4,0)
 S (DGRPW,Z)=1 D WW^DGRPV W " Eligibility Status: " S DGRPX=DGRP(.361),X=$P(DGRPX,"^",1),Z=$S(X']"":"NOT VERIFIED",X="V":"VERIFIED",X="R":"PENDING RE-VERIFICATION",1:"PENDING VERIFICATION"),Z1=28 D WW1^DGRPV S DGRPVR=$S(X]"":1,1:0)
"RTN","DGRP11",5,0)
 W "Status Date: " S Y=$P(DGRPX,"^",2) X:Y]"" ^DD("DD") W $S(Y]"":Y,DGRPVR:DGRPU,1:DGRPNA),!?5,"Status Entered By: ",$S($D(^VA(200,+$P(DGRPX,"^",6),0)):$P(^(0),"^",1)_" (#"_+$P(DGRPX,"^",6)_")",DGRPVR:DGRPU,1:DGRPNA)
"RTN","DGRP11",6,0)
 W !?6,"Interim Response: " S Y=$P(DGRPX,"^",4) X:Y]"" ^DD("DD") W $S(Y]"":Y,1:DGRPU_" (NOT REQUIRED)"),!?9,"Verif. Method: ",$S($P(DGRPX,"^",5)]"":$P(DGRPX,"^",5),DGRPVR:DGRPU,1:DGRPNA)
"RTN","DGRP11",7,0)
 ;Added display of ELIGIBILITY VERIF. SOURCE for Ineligible Project:
"RTN","DGRP11",8,0)
 W !?9,"Verif. Source: ",$S($P(DGRPX,"^",3)="H":"HEC",$P(DGRPX,"^",3)="V":"VISTA",1:"NOT AVAILABLE")
"RTN","DGRP11",9,0)
 S Z=2 D WW^DGRPV W "     Money Verified: " S Y=$P(DGRP(.3),"^",6) X:Y]"" ^DD("DD") W $S(Y]"":Y,1:"NOT VERIFIED") S Z=3 D WW^DGRPV W "   Service Verified: " S Y=$P(DGRP(.32),"^",2) X:Y]"" ^DD("DD") W $S(Y]"":Y,1:"NOT VERIFIED")
"RTN","DGRP11",10,0)
 S Z=4 D WW^DGRPV W " Rated Disabilities: " I $P(DGRP("VET"),"^",1)'="Y",$S('$D(^DG(391,+DGRP("TYPE"),0)):1,$P(^(0),"^",2):0,1:1) W DGRPNA," - NOT A VETERAN" G Q
"RTN","DGRP11",11,0)
 N DGEC,DGEFF
"RTN","DGRP11",12,0)
 S DGEC=$P($G(DGRP(.36)),U)
"RTN","DGRP11",13,0)
 I $G(DGEC) I $D(^DIC(8,DGEC)) S DGEC=$P(^DIC(8,DGEC,0),U)
"RTN","DGRP11",14,0)
 W " SC%: ",$S($G(DGEC)="NSC":"",$P($G(DGRP(.3)),U,2)="":"",1:$P($G(DGRP(.3)),U,2))
"RTN","DGRP11",15,0)
 S DGEFF=$P($G(DGRP(.3)),U,14)
"RTN","DGRP11",16,0)
 I $G(DGEFF)]"" S Y=DGEFF D DD^%DT S DGEFF=Y
"RTN","DGRP11",17,0)
 W "    EFF. DATE OF COMBINED SC%: "_$G(DGEFF),!
"RTN","DGRP11",18,0)
 N DGQUIT
"RTN","DGRP11",19,0)
 W ?49,"Orig",?64,"Curr"
"RTN","DGRP11",20,0)
 W !?3,"Rated Disability",?42,"Extr",?49,"Eff Dt",?64,"Eff Dt"
"RTN","DGRP11",21,0)
 S I3=0 F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:'I!($G(DGQUIT)=1)  D
"RTN","DGRP11",22,0)
 . S I3=I3+1
"RTN","DGRP11",23,0)
 . S I1=^(I,0),I2=$S($D(^DIC(31,+I1,0)):$E($P(^DIC(31,+I1,0),U),1,35),1:"")
"RTN","DGRP11",24,0)
 . S I2=I2_"("_$S($P(I1,U,3)=1:$P(I1,U,2)_"% SC",$P(I1,U,2)]"":"NSC",1:"unspec.")_")"
"RTN","DGRP11",25,0)
 . S I4=$P($G(I1),U,4),I5=$P($G(I1),U,5),I6=$P($G(I1),U,6)
"RTN","DGRP11",26,0)
 . I $Y>(IOSL-3) D PAUSE^DGRPDB I $G(DGQUIT)=0 W @IOF
"RTN","DGRP11",27,0)
 . I $G(DGQUIT)=1 Q
"RTN","DGRP11",28,0)
 . W !,I2,?42,$G(I4),?45," - ",?49,$G(I5),?61," - ",?64,$G(I6)
"RTN","DGRP11",29,0)
 . ;W:I3>1 !?24 W I2
"RTN","DGRP11",30,0)
 W:'I3 !,"NONE STATED"
"RTN","DGRP11",31,0)
Q G ^DGRPP
"RTN","DGRPDB")
0^2^B20522498
"RTN","DGRPDB",1,0)
DGRPDB ;ALB/AAS,JAN,ERC - VIEW ONLY SCREEN TO DETERMINE BILLING ELIGIBILITY ; 9/29/05 4:36pm
"RTN","DGRPDB",2,0)
 ;;5.3;Registration;**26,50,358,570,631**;Aug 13, 1993
"RTN","DGRPDB",3,0)
 ;
"RTN","DGRPDB",4,0)
% S:'$D(DGQUIT) DGQUIT=0
"RTN","DGRPDB",5,0)
 G:DGQUIT END S DIC="^DPT(",DIC(0)="AEQMN" D ^DIC G:+Y<1 END S DFN=+Y D EN
"RTN","DGRPDB",6,0)
 G %
"RTN","DGRPDB",7,0)
 ;
"RTN","DGRPDB",8,0)
EN ;entry with DFN defined.
"RTN","DGRPDB",9,0)
 Q:'$D(DFN)  D HOME^%ZIS,2^VADPT,HDR
"RTN","DGRPDB",10,0)
 D MT,AOIR,ELIG,DIS
"RTN","DGRPDB",11,0)
 N DGINS
"RTN","DGRPDB",12,0)
 I $$INSUR^IBBAPI(DFN,"","AR",.DGINS,1)
"RTN","DGRPDB",13,0)
 S C="",C=$O(DGINS("IBBAPI","INSUR",C),-1),C=+C+6
"RTN","DGRPDB",14,0)
 D:($Y>(IOSL-C)) PAUSE,HDR:'DGQUIT Q:DGQUIT  D INS,PAUSE
"RTN","DGRPDB",15,0)
 Q
"RTN","DGRPDB",16,0)
 ;
"RTN","DGRPDB",17,0)
ELIG ;eligibility code(s)
"RTN","DGRPDB",18,0)
 W !!," Primary Elig. Code: ",$P(VAEL(1),"^",2),"  --  ",$S(VAEL(8)']"":"NOT VERIFIED",1:$P(VAEL(8),"^",2))
"RTN","DGRPDB",19,0)
 I VAEL(8)]"" S Y=$S($D(^DPT(DFN,.361)):$P(^(.361),"^",2),1:"") W "  " D DT^DIQ
"RTN","DGRPDB",20,0)
 W !,"Other Elig. Code(s): " I $D(VAEL(1))>9 S I1=0 F I=0:0 S I=$O(VAEL(1,I)) Q:'I  S I1=I1+1 W:I1>1 !?21 W $P(VAEL(1,I),"^",2)
"RTN","DGRPDB",21,0)
 E  W "NO ADDITIONAL ELIGIBILITIES IDENTIFIED"
"RTN","DGRPDB",22,0)
 Q
"RTN","DGRPDB",23,0)
 ;
"RTN","DGRPDB",24,0)
DIS ;rated disabilities - Integration Agreement #700
"RTN","DGRPDB",25,0)
 ;
"RTN","DGRPDB",26,0)
 ;  This is called from the FEE and MCCR package!!!
"RTN","DGRPDB",27,0)
 ;
"RTN","DGRPDB",28,0)
 ;  Input:  DFN as IEN of PATIENT file
"RTN","DGRPDB",29,0)
 ;          VAEL array (if no passed, it is set) of eligibility info
"RTN","DGRPDB",30,0)
 ;
"RTN","DGRPDB",31,0)
 I '$D(VAEL) D ELIG^VADPT S DGKVAR=1
"RTN","DGRPDB",32,0)
 W:'+VAEL(3) !!,"  Service Connected: NO" W:+VAEL(3) !!,"         SC Percent: ",$P(VAEL(3),"^",2)_"%"
"RTN","DGRPDB",33,0)
 N DGQUIT
"RTN","DGRPDB",34,0)
 W !," Rated Disabilities: " I 'VAEL(4),$S('$D(^DG(391,+VAEL(6),0)):1,$P(^(0),"^",2):0,1:1) W "NOT A VETERAN" G DISQ
"RTN","DGRPDB",35,0)
 S I3=0 F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:'I!($G(DGQUIT)=1)  D
"RTN","DGRPDB",36,0)
 . S I1=^(I,0),I2=$S($D(^DIC(31,+I1,0)):$P(^(0),"^",1)_" ("_+$P(I1,"^",2)_"%-"_$S($P(I1,"^",3):"SC",$P(I1,"^",3)']"":"not specified",1:"NSC")_")",1:""),I3=I3+1
"RTN","DGRPDB",37,0)
 . I $Y>(IOSL-3) D PAUSE I $G(DGQUIT)=0 W @IOF
"RTN","DGRPDB",38,0)
 . I $G(DGQUIT)=1 Q
"RTN","DGRPDB",39,0)
 . W:I3>1 !?21 W I2
"RTN","DGRPDB",40,0)
 W:'I3 "NONE STATED"
"RTN","DGRPDB",41,0)
DISQ I $D(DGKVAR) D KVAR^VADPT K DGKVAR
"RTN","DGRPDB",42,0)
 K I,I1,I2,I3
"RTN","DGRPDB",43,0)
 Q
"RTN","DGRPDB",44,0)
 ;
"RTN","DGRPDB",45,0)
INS ;insurance information
"RTN","DGRPDB",46,0)
 ;
"RTN","DGRPDB",47,0)
 ;  This is called form the FEE package!!!
"RTN","DGRPDB",48,0)
 ;
"RTN","DGRPDB",49,0)
 ;  Input:  DFN as IEN of PATIENT file
"RTN","DGRPDB",50,0)
 ;          DGINSDT as date to compute insurance flag as of (default DT)
"RTN","DGRPDB",51,0)
 ;
"RTN","DGRPDB",52,0)
 Q:'$D(DFN)
"RTN","DGRPDB",53,0)
 W !!,"    Health Insurance: "
"RTN","DGRPDB",54,0)
 S Z=$$INSUR^IBBAPI(DFN,$S($D(DGINSDT):DGINSDT,1:DT))
"RTN","DGRPDB",55,0)
 W $S(Z:"YES",1:"NO")
"RTN","DGRPDB",56,0)
 D DISP^DGIBDSP
"RTN","DGRPDB",57,0)
INSQ K I,I1,DGX,Z
"RTN","DGRPDB",58,0)
 Q
"RTN","DGRPDB",59,0)
 ;
"RTN","DGRPDB",60,0)
IN ; Old code
"RTN","DGRPDB",61,0)
 Q
"RTN","DGRPDB",62,0)
 ;
"RTN","DGRPDB",63,0)
AOIR ;Agent Orange/ionizing radiation
"RTN","DGRPDB",64,0)
 S DGX=$S($D(^DPT(DFN,.321)):^(.321),1:"")
"RTN","DGRPDB",65,0)
 F I=2,3 S X=$P(DGX,"^",I) W:I=2 !,"           A/O Exp.: " W:I=3 "ION Rad.: " W $S(X="Y":"YES",X="N":"NO",X="U":"UNKNOWN",1:"NOT ANSWERED"),"   "
"RTN","DGRPDB",66,0)
 S X=$G(^DPT(DFN,.38)),X1=$P(X,"^",1) W "Medicaid Elig: ",$S(X1="":"NOT ANSWERED",'X1:"NO",1:"YES") I ($X+15)'>IOM W " - " S Y=$P(X,"^",2) D D^DIQ W $P(Y,"@")
"RTN","DGRPDB",67,0)
 Q
"RTN","DGRPDB",68,0)
 ;
"RTN","DGRPDB",69,0)
PAUSE F J=1:1 Q:($Y>(IOSL-3))  W !
"RTN","DGRPDB",70,0)
 S DGX1="" I $E(IOST,1,2)["C-" N DIR S DIR(0)="E" D ^DIR S DGQUIT='Y
"RTN","DGRPDB",71,0)
 Q
"RTN","DGRPDB",72,0)
 ;
"RTN","DGRPDB",73,0)
HDR ;Screen Header
"RTN","DGRPDB",74,0)
 W @IOF I $P(VAEL(6),"^",2)]"" S DGTYPE=$P(VAEL(6),"^",2)
"RTN","DGRPDB",75,0)
 W $P(VADM(1),"^",1),?32,VA("PID"),?47,$P(VADM(3),"^",2) S X=$S($D(DGTYPE):$P(DGTYPE,"^",1),1:"PATIENT TYPE UNKNOWN"),X1=79-$L(X) W ?X1,X
"RTN","DGRPDB",76,0)
 S X="",$P(X,"=",80)="" W !,X Q
"RTN","DGRPDB",77,0)
 Q
"RTN","DGRPDB",78,0)
 ;
"RTN","DGRPDB",79,0)
MT I '$O(^DGMT(408.31,"AD",1,DFN,0)) W !,"  Means Test Status:  NOT IN MEANS TEST FILE" Q
"RTN","DGRPDB",80,0)
 ;if patient is on a DOM ward, don't display Means Test required message
"RTN","DGRPDB",81,0)
 D DOM^DGMTR D:'$G(DGDOM) DIS^DGMTU(DFN) K DGDOM
"RTN","DGRPDB",82,0)
 Q
"RTN","DGRPDB",83,0)
 ;
"RTN","DGRPDB",84,0)
END D KVAR^VADPT
"RTN","DGRPDB",85,0)
 K A,C,I,I1,I2,I3,J,DIC,DIR,DFN,DGA1,DGMT,DGMTL,DGMTLA,DGX,DGX1,DGT,DGTYPE,DGQUIT,DGMTLL,X,X1,VAROOT,VA,Y,Z
"RTN","DGRPDB",86,0)
 Q
"RTN","DGRPDB",87,0)
 ;
"RTN","DGRPDB",88,0)
RDIS(DGDFN,DGARR) ;API will reutrn all Rated Disabilities from the 
"RTN","DGRPDB",89,0)
 ;
"RTN","DGRPDB",90,0)
 ;Integration Agreement - #????
"RTN","DGRPDB",91,0)
 ;
"RTN","DGRPDB",92,0)
 ;Patient file for a patient and put them into the array sent in.
"RTN","DGRPDB",93,0)
 ;Input  DGDFN - IEN of patient file (required)
"RTN","DGRPDB",94,0)
 ;       DGARR - name of array for returned disability info (required)
"RTN","DGRPDB",95,0)
 ;               piece 1 - Disability IEN (in file 31)
"RTN","DGRPDB",96,0)
 ;               piece 2 - SC%
"RTN","DGRPDB",97,0)
 ;               piece 3 - SC? (1,0)
"RTN","DGRPDB",98,0)
 ;               piece 4 - extremity
"RTN","DGRPDB",99,0)
 ;               piece 5 - original award date
"RTN","DGRPDB",100,0)
 ;               piece 6 - current award date
"RTN","DGRPDB",101,0)
 ;Output  DGOK - success or failure, 1=success, 0=failure
"RTN","DGRPDB",102,0)
 N DGARR1,DGC,DGCC,DGERR,DGNODE ;,DGOK
"RTN","DGRPDB",103,0)
 K DGARR,DGOK
"RTN","DGRPDB",104,0)
 I $G(DGDFN)']"" S DGOK=0 Q DGOK
"RTN","DGRPDB",105,0)
 I '$D(^DPT(DGDFN,0)) S DGOK=0 Q DGOK
"RTN","DGRPDB",106,0)
 D GETS^DIQ(2,DGDFN,".3721*","I","DGARR1","DGERR")
"RTN","DGRPDB",107,0)
 I $D(DGERR) S DGOK=0 Q DGOK
"RTN","DGRPDB",108,0)
 S DGOK=1
"RTN","DGRPDB",109,0)
 S DGCC=$P($G(^DPT(DGDFN,.372,0)),U,3)
"RTN","DGRPDB",110,0)
 I $G(DGCC)'>0 S DGOK=0 Q DGOK
"RTN","DGRPDB",111,0)
 F DGC=1:1:DGCC I $D(DGARR1(2.04,DGC_","_DGDFN_",")) D
"RTN","DGRPDB",112,0)
 . S DGNODE=DGC_","_DGDFN_","
"RTN","DGRPDB",113,0)
 . S DGARR(DGC)=DGARR1(2.04,DGNODE,.01,"I")_"^"_DGARR1(2.04,DGNODE,2,"I")_"^"_DGARR1(2.04,DGNODE,3,"I")_"^"_DGARR1(2.04,DGNODE,4,"I")_"^"_DGARR1(2.04,DGNODE,5,"I")_"^"_DGARR1(2.04,DGNODE,6,"I")
"RTN","DGRPDB",114,0)
 K DGW
"RTN","DGRPDB",115,0)
 N DGCT,DGE,DGEE
"RTN","DGRPDB",116,0)
 F DGE=0:0 S DGE=$O(DGARR(DGE)) Q:'DGE  S DGW($P(DGARR(DGE),U,2),DGE)=DGARR(DGE)
"RTN","DGRPDB",117,0)
 S DGE="",DGCT=1
"RTN","DGRPDB",118,0)
 F  S DGE=$O(DGW(DGE),-1) Q:DGE']""  D
"RTN","DGRPDB",119,0)
 . F DGEE=0:0 S DGEE=$O(DGW(DGE,DGEE)) Q:DGEE'>0  D
"RTN","DGRPDB",120,0)
 . . S DGARR(DGCT)=DGW(DGE,DGEE) S DGCT=DGCT+1
"RTN","DGRPDB",121,0)
 K DGW
"RTN","DGRPDB",122,0)
 Q DGOK
"RTN","DGRPE1")
0^5^B8637355
"RTN","DGRPE1",1,0)
DGRPE1 ;ALB/MRL,RTK,BRM,RGL - REGISTRATIONS EDITS (CONTINUED) ; 8/29/05 3:02pm
"RTN","DGRPE1",2,0)
 ;;5.3;Registration;**114,327,451,631**;Aug 13, 1993
"RTN","DGRPE1",3,0)
 ;
"RTN","DGRPE1",4,0)
 ;***CONTAINS ISM SPECIFIC CODE TO AVOID STORE ERRORS WITH ELIG.***
"RTN","DGRPE1",5,0)
 ;
"RTN","DGRPE1",6,0)
 I DGRPS'=7 F I=1:1 S J=$P(DGDR,",",I) Q:J=""  F J1=J,J*1000 Q:'$T(@J1)  S DGDRD=$P($T(@J1),";;",2) D S
"RTN","DGRPE1",7,0)
 I DGRPS=7 S DR="[DG LOAD EDIT SCREEN 7]"
"RTN","DGRPE1",8,0)
 ;S DR(2,2.0361)=".01"
"RTN","DGRPE1",9,0)
 D ^DIE K DIE,DR,DGCT,DGDR,DGDRD,DGDRS,I,J,J1
"RTN","DGRPE1",10,0)
 ;update/set ELIGIBILITY VERIF. SOURCE field (327/Ineligible Project)
"RTN","DGRPE1",11,0)
 I $D(^DPT(DFN,.361)) S DGELG=^DPT(DFN,.361) D
"RTN","DGRPE1",12,0)
 .I $P(DGELG,U,5)["VIVA",$P(DGELG,U,6)=.5 S DATA(.3613)="H"
"RTN","DGRPE1",13,0)
 .E  S DATA(.3613)="V"
"RTN","DGRPE1",14,0)
 .I '$$UPD^DGENDBS(2,DFN,.DATA)
"RTN","DGRPE1",15,0)
 Q
"RTN","DGRPE1",16,0)
S I $L(@DGDRS)+$L(DGDRD)<241 S @DGDRS=@DGDRS_DGDRD Q
"RTN","DGRPE1",17,0)
 S DGCT=DGCT+1,DGDRS="DR(1,2,"_DGCT_")",@DGDRS=DGDRD Q
"RTN","DGRPE1",18,0)
701 ;;391;D SC7^DGRPV;1901;.301;S:X'="Y" Y=.313;.302;.313;.312;
"RTN","DGRPE1",19,0)
702 ;;.361;D AAC1^DGLOCK2 S:DGAAC(1)']"" Y=361;.309;361;.323;D ^DGYZODS;S:'DGODS Y=.36265;11500.02;11500.03;.36265;S:X='"Y" Y="@72";.3626;@72;
"RTN","DGRPE1",20,0)
703 ;;.3731;
"RTN","DGRPE1",21,0)
1001 ;;.152;S:X="" Y="@101";.1651;.1653;.1654;.307;.1656;@101;
"RTN","DGRPE1",22,0)
1002 ;;.153;S:X="" Y="@102";.1657:.1659;.16;@102;
"RTN","DGRPE1",23,0)
1101 ;;.3611;.3612;.3614;.3615;
"RTN","DGRPE1",24,0)
1102 ;;.306;
"RTN","DGRPE1",25,0)
1103 ;;.322;
"RTN","DGRPE1",26,0)
1104 ;;D VETTYPE^DGRPE1;D MSG^DGRPE1 S Y=0;@114;K DGRDCHG;D DR^DGRPE1;.302;.3721;D EFF^DGRPE1;D:$G(DGRDCHG) BULL^DGRPE1;K DGRDCHG
"RTN","DGRPE1",27,0)
MSG W !,"Patient is not a veteran.  Can't enter rated disabilities",! Q
"RTN","DGRPE1",28,0)
 ;
"RTN","DGRPE1",29,0)
BULL ; Rated Disabilities update bulletin
"RTN","DGRPE1",30,0)
 N DGBULL,DGLINE,DGMGRP,DGNAME,DIFROM,VA,VAERR,XMTEXT,XMSUB,XMDUZ
"RTN","DGRPE1",31,0)
 S DGMGRP=$O(^XMB(3.8,"B","DGEN ELIGIBILITY ALERT",""))
"RTN","DGRPE1",32,0)
 Q:'DGMGRP
"RTN","DGRPE1",33,0)
 D XMY^DGMTUTL(DGMGRP,0,1)
"RTN","DGRPE1",34,0)
 S DGNAME=$P($G(^DPT(DFN,0)),"^"),DGSSN=$P($G(^DPT(DFN,0)),"^",9)
"RTN","DGRPE1",35,0)
 S XMTEXT="DGBULL("
"RTN","DGRPE1",36,0)
 S XMSUB="RATED DISABILITY UPDATED"
"RTN","DGRPE1",37,0)
 S DGLINE=0
"RTN","DGRPE1",38,0)
 D LINE^DGEN("Patient: "_DGNAME,.DGLINE)
"RTN","DGRPE1",39,0)
 D LINE^DGEN("SSN: "_DGSSN,.DGLINE)
"RTN","DGRPE1",40,0)
 D LINE^DGEN("",.DGLINE)
"RTN","DGRPE1",41,0)
 D LINE^DGEN("Send updates to SC Disabilities to HEC via fax or HECAlert",.DGLINE)
"RTN","DGRPE1",42,0)
 D LINE^DGEN("Outlook mail group so that they can be entered into VHA's",.DGLINE)
"RTN","DGRPE1",43,0)
 D LINE^DGEN("Authoritative Database.  SC Disability information entered directly",.DGLINE)
"RTN","DGRPE1",44,0)
 D LINE^DGEN("into VistA may be overlaid.",.DGLINE)
"RTN","DGRPE1",45,0)
 D ^XMD
"RTN","DGRPE1",46,0)
 Q
"RTN","DGRPE1",47,0)
DR ;
"RTN","DGRPE1",48,0)
 K DGSCPC
"RTN","DGRPE1",49,0)
 S DGSCPC=$P($G(^DPT(DFN,.3)),U,2)
"RTN","DGRPE1",50,0)
 S DR(2,2.04)=".01;2;3"
"RTN","DGRPE1",51,0)
 Q
"RTN","DGRPE1",52,0)
EFF ;
"RTN","DGRPE1",53,0)
 I $G(DGSCPC)=$P($G(^DPT(DFN,.3)),U,2) Q
"RTN","DGRPE1",54,0)
 S DGFDA(2,DFN_",",.3014)="@"
"RTN","DGRPE1",55,0)
 D FILE^DIE("","DGFDA","DGERR")
"RTN","DGRPE1",56,0)
 K DGFDA,DGSCPC
"RTN","DGRPE1",57,0)
 Q
"RTN","DGRPE1",58,0)
VETTYPE ;
"RTN","DGRPE1",59,0)
 S:$S('$D(^DPT(DFN,"VET")):0,^("VET")="Y":1,1:0) Y="@114" Q
"RTN","DGRPE1",60,0)
 S:'$S('$D(^("TYPE")):1,'$D(^DG(391,+^("TYPE"),0)):1,$P(^(0),"^",2):0,1:1) Y="@114"
"RTN","DGRPE1",61,0)
 Q
"UP",2,2.04,-1)
2^.372
"UP",2,2.04,0)
2.04
"VER")
8.0^22.0
"^DD",2,2,.3014,0)
EFF. DATE COMBINED SC% EVAL.^DX^^.3;14^S %DT="EP" D ^%DT S X=Y K:Y<1!(Y>DT) X
"^DD",2,2,.3014,21,0)
^.001^2^2^3050714^^
"^DD",2,2,.3014,21,1,0)
Data will be filed automatically from HL7 message from the HEC.  This is 
"^DD",2,2,.3014,21,2,0)
the date that the combined Service Connected Disability % was awarded.
"^DD",2,2,.3014,"DT")
3050714
"^DD",2,2.04,4,0)
EXTREMITY AFFECTED^S^BL:BOTH LOWER;BU:BOTH LOWER;RL:RIGHT LOWER;RU:RIGHT UPPER;LL:LEFT LOWER;LU:LEFT UPPER;^0;4^Q
"^DD",2,2.04,4,21,0)
^^2^2^3050712^
"^DD",2,2.04,4,21,1,0)
Data will be stuffed from messages from the HEC.  This field indicates 
"^DD",2,2.04,4,21,2,0)
which extremity is affected.
"^DD",2,2.04,4,"DT")
3050712
"^DD",2,2.04,5,0)
ORIGINAL EFFECTIVE DATE^DX^^0;5^S %DT="E" D ^%DT S X=Y K:Y<1!(Y>DT) X
"^DD",2,2.04,5,21,0)
^^2^2^3050712^
"^DD",2,2.04,5,21,1,0)
Data will be stuffed from messages from the HEC.  This field indicates 
"^DD",2,2.04,5,21,2,0)
the first date that this disability was evaluated.
"^DD",2,2.04,5,"DT")
3050714
"^DD",2,2.04,6,0)
CURRENT EFFECTIVE DATE^DX^^0;6^S %DT="E" D ^%DT S X=Y K:Y<1!(Y>DT) X
"^DD",2,2.04,6,21,0)
^.001^2^2^3050727^^^^
"^DD",2,2.04,6,21,1,0)
Data will be stuffed from messages from the HEC.  This field indicates 
"^DD",2,2.04,6,21,2,0)
the most recent date that this disability was evaluated.
"^DD",2,2.04,6,"DT")
3050728
**INSTALL NAME**
DGBT*1.0*11
"BLD",5640,0)
DGBT*1.0*11^BENEFICIARY TRAVEL^0^3051102^y
"BLD",5640,4,0)
^9.64PA^^
"BLD",5640,"ABNS",0)
^9.66A^^
"BLD",5640,"ABPKG")
y^n
"BLD",5640,"KRN",0)
^9.67PA^8989.52^19
"BLD",5640,"KRN",.4,0)
.4
"BLD",5640,"KRN",.401,0)
.401
"BLD",5640,"KRN",.402,0)
.402
"BLD",5640,"KRN",.403,0)
.403
"BLD",5640,"KRN",.5,0)
.5
"BLD",5640,"KRN",.84,0)
.84
"BLD",5640,"KRN",3.6,0)
3.6
"BLD",5640,"KRN",3.8,0)
3.8
"BLD",5640,"KRN",9.2,0)
9.2
"BLD",5640,"KRN",9.8,0)
9.8
"BLD",5640,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5640,"KRN",9.8,"NM",1,0)
DGBT1^^0^B10865004
"BLD",5640,"KRN",9.8,"NM","B","DGBT1",1)

"BLD",5640,"KRN",19,0)
19
"BLD",5640,"KRN",19,"NM",0)
^9.68A^^
"BLD",5640,"KRN",19.1,0)
19.1
"BLD",5640,"KRN",101,0)
101
"BLD",5640,"KRN",409.61,0)
409.61
"BLD",5640,"KRN",771,0)
771
"BLD",5640,"KRN",870,0)
870
"BLD",5640,"KRN",8989.51,0)
8989.51
"BLD",5640,"KRN",8989.52,0)
8989.52
"BLD",5640,"KRN",8994,0)
8994
"BLD",5640,"KRN","B",.4,.4)

"BLD",5640,"KRN","B",.401,.401)

"BLD",5640,"KRN","B",.402,.402)

"BLD",5640,"KRN","B",.403,.403)

"BLD",5640,"KRN","B",.5,.5)

"BLD",5640,"KRN","B",.84,.84)

"BLD",5640,"KRN","B",3.6,3.6)

"BLD",5640,"KRN","B",3.8,3.8)

"BLD",5640,"KRN","B",9.2,9.2)

"BLD",5640,"KRN","B",9.8,9.8)

"BLD",5640,"KRN","B",19,19)

"BLD",5640,"KRN","B",19.1,19.1)

"BLD",5640,"KRN","B",101,101)

"BLD",5640,"KRN","B",409.61,409.61)

"BLD",5640,"KRN","B",771,771)

"BLD",5640,"KRN","B",870,870)

"BLD",5640,"KRN","B",8989.51,8989.51)

"BLD",5640,"KRN","B",8989.52,8989.52)

"BLD",5640,"KRN","B",8994,8994)

"BLD",5640,"QUES",0)
^9.62^^
"BLD",5640,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",154,-1)
1^1
"PKG",154,0)
BENEFICIARY TRAVEL^DGBT^Beneficiary Travel
"PKG",154,22,0)
^9.49I^1^1
"PKG",154,22,1,0)
1.0^3020319^3020408^66476
"PKG",154,22,1,"PAH",1,0)
11^3051102^83
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGBT1")
0^1^B10865004
"RTN","DGBT1",1,0)
DGBT1 ;ALB/SCK - BENEFICIARY TRAVEL DISPLAY SCREEN 1; 12/15/92  1/8/93 4/1/93 ; 10/31/05 1:11pm
"RTN","DGBT1",2,0)
 ;;1.0;Beneficiary Travel;**11**;September 25, 2001
"RTN","DGBT1",3,0)
 Q
"RTN","DGBT1",4,0)
SCREEN ;  clear screen and write headers
"RTN","DGBT1",5,0)
 W @IOF
"RTN","DGBT1",6,0)
 W !?18,"Beneficiary Travel Claim Information <Screen 1>"
"RTN","DGBT1",7,0)
 W !!?2,"Claim Date: ",DGBTDTE
"RTN","DGBT1",8,0)
 D PID^VADPT6 W !!?8,"Name: ",VADM(1),?40,"PT ID: ",VA("PID"),?64,"DOB: ",$P(VADM(3),"^",2)
"RTN","DGBT1",9,0)
 W !!?5,"Address: ",VAPA(1) W:VAPA(2)]"" !?14,VAPA(2) W:VAPA(3)]"" !?14,VAPA(3) W !?14,VAPA(4),$S(VAPA(4)]"":", "_$P(VAPA(5),"^",2)_"  "_$P(VAPA(11),U,2),1:"UNSPECIFIED")
"RTN","DGBT1",10,0)
SETVAR  ;  if new claim, move in current info for elig, sc%
"RTN","DGBT1",11,0)
 I 'CHZFLG S DGBTELG=VAEL(1),DGBTCSC=VAEL(3)
"RTN","DGBT1",12,0)
 I +DGBTELG=3,'$E(DGBTCSC)=1 S DGBTCSC=1
"RTN","DGBT1",13,0)
 W !!," Eligibility: ",$P(DGBTELG,"^",2) W:DGBTCSC ?45,"SC%: ",$P(DGBTCSC,"^",2)
"RTN","DGBT1",14,0)
 I $O(VAEL(1,0))'="" W !," Other Elig.: " F I=0:0 S I=$O(VAEL(1,I)) Q:'I  W ?14,$P(VAEL(1,I),"^",2),!
"RTN","DGBT1",15,0)
SC ;  service connected status/information
"RTN","DGBT1",16,0)
 I DGBTCSC&($P(DGBTCSC,"^",2)'>29) W !!,"Disabilities:" S I3=""
"RTN","DGBT1",17,0)
 N DGQUIT
"RTN","DGBT1",18,0)
 F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:'I!($G(DGQUIT)=1)  D
"RTN","DGBT1",19,0)
 . S I1=^(I,0),I2=$S($D(^DIC(31,+I1,0)):$P(^(0),"^",1)_" ("_+$P(I1,"^",2)_"%-"_$S($P(I1,"^",3):"SC",1:"NSC")_")",1:""),I3=I1
"RTN","DGBT1",20,0)
 . I $Y>(IOSL-3) D PAUSE I DGQUIT=0 W @IOF
"RTN","DGBT1",21,0)
 . I $G(DGQUIT)=1 Q
"RTN","DGBT1",22,0)
 . W !?14 W I2
"RTN","DGBT1",23,0)
 ;
"RTN","DGBT1",24,0)
INCOME ;  income and eligibility information
"RTN","DGBT1",25,0)
 N DGBTIFL S DGBTIFL=$P(DGBTINC,U,2)
"RTN","DGBT1",26,0)
 W !!?2,"Income: ",$P(DGBTINC,U),?40,"Source of Income:  ",$S(DGBTIFL="M":"MEANS TEST",DGBTIFL="C":"COPAY TEST",DGBTIFL="I":"INCOME SCREENING",DGBTIFL="V":"VA CHECK",1:"")
"RTN","DGBT1",27,0)
 W !?2,"No. of Dependents: ",DGBTDEP
"RTN","DGBT1",28,0)
 I DGBTMTS]"" W:$P(DGBTMTS,"^")'="N" ?40,"MT Status: ",$S($P(DGBTMTS,"^")="R":"REQUIRED",$P(DGBTMTS,"^")="P":$P($P(DGBTMTS,"^",2)," "),DGBTMTS=U:" NOT APPLICABLE",1:$P(DGBTMTS,"^",2))
"RTN","DGBT1",29,0)
 W:$P(DGBTMTS,"^")="P" !?68,$P($P(DGBTMTS,"^",2)," ",2)
"RTN","DGBT1",30,0)
 I $P(DGBTMTS,"^")="N" W !!?20,"MEANS TEST ",$P(DGBTMTS,"^",2)
"RTN","DGBT1",31,0)
 ;
"RTN","DGBT1",32,0)
 W !!?2,"BT Income: ",$S($D(DGBTCA):DGBTCA,1:"NOT RECORDED") W:$D(DGBTCE) ?25,"Certified Eligible: ",$S(DGBTCE:"YES",1:"NO"),?53,"Date Certified: ",$S($D(DGBTCD):DGBTCD,1:"NOT RECORDED")
"RTN","DGBT1",33,0)
 I $D(DGBTCE) I DGBTCE'=1 W *7,*7,!!?8,"* * * NOTE * * PATIENT HAS BEEN CERTIFIED INELIGIBLE BASED ON INCOME"
"RTN","DGBT1",34,0)
 S DGBTINFL="" I $D(DGBTINC),$D(DGBTCA),$P(DGBTINC,U)'=DGBTCA,$P(DGBTMTS,"^")'="N" S DGBTINFL=" * * * * Discrepancy exists in incomes reported, please verify * * * *" W !!?5,DGBTINFL
"RTN","DGBT1",35,0)
 F I=$Y:1:20 W !
"RTN","DGBT1",36,0)
QUIT ;
"RTN","DGBT1",37,0)
 K I1,I2,I3
"RTN","DGBT1",38,0)
 Q
"RTN","DGBT1",39,0)
 ;
"RTN","DGBT1",40,0)
PAUSE   ;added with DGBT*1*11
"RTN","DGBT1",41,0)
 I $E(IOST,1,2)["C-" N DIR S DIR(0)="E" D ^DIR S DGQUIT='Y
"RTN","DGBT1",42,0)
 Q
"VER")
8.0^22.0
**END**
**END**
