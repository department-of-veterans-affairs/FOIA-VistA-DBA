Released EAS*1*79 SEQ #67
Extracted from mail message
**KIDS**:EAS*1.0*79^

**INSTALL NAME**
EAS*1.0*79
"BLD",6509,0)
EAS*1.0*79^ENROLLMENT APPLICATION SYSTEM^0^3070529^y
"BLD",6509,1,0)
^^1^1^3061127^
"BLD",6509,1,1,0)
USE ADMISSION DATE IN CALCULATED LTC COPAYMENTS REPORT
"BLD",6509,4,0)
^9.64PA^^
"BLD",6509,6)
3^
"BLD",6509,6.3)
3
"BLD",6509,"KRN",0)
^9.67PA^8989.52^19
"BLD",6509,"KRN",.4,0)
.4
"BLD",6509,"KRN",.401,0)
.401
"BLD",6509,"KRN",.402,0)
.402
"BLD",6509,"KRN",.403,0)
.403
"BLD",6509,"KRN",.5,0)
.5
"BLD",6509,"KRN",.84,0)
.84
"BLD",6509,"KRN",3.6,0)
3.6
"BLD",6509,"KRN",3.8,0)
3.8
"BLD",6509,"KRN",9.2,0)
9.2
"BLD",6509,"KRN",9.8,0)
9.8
"BLD",6509,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",6509,"KRN",9.8,"NM",1,0)
EASECU^^0^B11675837
"BLD",6509,"KRN",9.8,"NM",2,0)
EASECPC^^0^B16405138
"BLD",6509,"KRN",9.8,"NM","B","EASECPC",2)

"BLD",6509,"KRN",9.8,"NM","B","EASECU",1)

"BLD",6509,"KRN",19,0)
19
"BLD",6509,"KRN",19.1,0)
19.1
"BLD",6509,"KRN",101,0)
101
"BLD",6509,"KRN",409.61,0)
409.61
"BLD",6509,"KRN",771,0)
771
"BLD",6509,"KRN",870,0)
870
"BLD",6509,"KRN",8989.51,0)
8989.51
"BLD",6509,"KRN",8989.52,0)
8989.52
"BLD",6509,"KRN",8994,0)
8994
"BLD",6509,"KRN","B",.4,.4)

"BLD",6509,"KRN","B",.401,.401)

"BLD",6509,"KRN","B",.402,.402)

"BLD",6509,"KRN","B",.403,.403)

"BLD",6509,"KRN","B",.5,.5)

"BLD",6509,"KRN","B",.84,.84)

"BLD",6509,"KRN","B",3.6,3.6)

"BLD",6509,"KRN","B",3.8,3.8)

"BLD",6509,"KRN","B",9.2,9.2)

"BLD",6509,"KRN","B",9.8,9.8)

"BLD",6509,"KRN","B",19,19)

"BLD",6509,"KRN","B",19.1,19.1)

"BLD",6509,"KRN","B",101,101)

"BLD",6509,"KRN","B",409.61,409.61)

"BLD",6509,"KRN","B",771,771)

"BLD",6509,"KRN","B",870,870)

"BLD",6509,"KRN","B",8989.51,8989.51)

"BLD",6509,"KRN","B",8989.52,8989.52)

"BLD",6509,"KRN","B",8994,8994)

"BLD",6509,"QUES",0)
^9.62^^
"BLD",6509,"REQB",0)
^9.611^1^1
"BLD",6509,"REQB",1,0)
EAS*1.0*40^2
"BLD",6509,"REQB","B","EAS*1.0*40",1)

"MBREQ")
0
"PKG",552,-1)
1^1
"PKG",552,0)
ENROLLMENT APPLICATION SYSTEM^EAS^ENROLLMENT
"PKG",552,20,0)
^9.402P^1^1
"PKG",552,20,1,0)
2^^EASXDR
"PKG",552,20,1,1)
 
"PKG",552,20,"B",2,1)

"PKG",552,22,0)
^9.49I^1^1
"PKG",552,22,1,0)
1.0^3010315^3010410^66481
"PKG",552,22,1,"PAH",1,0)
79^3070529^1255
"PKG",552,22,1,"PAH",1,1,0)
^^1^1^3070529
"PKG",552,22,1,"PAH",1,1,1,0)
USE ADMISSION DATE IN CALCULATED LTC COPAYMENTS REPORT
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","EASECPC")
0^2^B16405138^B14573671
"RTN","EASECPC",1,0)
EASECPC ;ALB/PHH,CKN,LBD,AMA,SCK - LTC Copayment Report; 29-AUG-2001
"RTN","EASECPC",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**5,7,19,24,34,40,79**;Mar 15, 2001;Build 3
"RTN","EASECPC",3,0)
 ;
"RTN","EASECPC",4,0)
 ; This routine prints a report of calculated LTC copayments for a veteran.
"RTN","EASECPC",5,0)
 ; It is called by menu option EASEC LTC COPAY PRINT
"RTN","EASECPC",6,0)
 ;
"RTN","EASECPC",7,0)
EN N DFN,EASRPT,EASADM,EASRDT,MAXRT,DGMTI,DGMTDT
"RTN","EASECPC",8,0)
 ; Select which report to print (1=Institutional (IP); 2=Non-Institutional (OP))
"RTN","EASECPC",9,0)
 S EASRPT=$$RPT Q:'EASRPT
"RTN","EASECPC",10,0)
 ; Select Patient
"RTN","EASECPC",11,0)
 S DFN=$$GETDFN Q:'DFN
"RTN","EASECPC",12,0)
 S EASADM=""
"RTN","EASECPC",13,0)
 ; Get the LTC admission date (if EASRPT=1)
"RTN","EASECPC",14,0)
 I EASRPT=1 S EASADM=$$ADMDT Q:'EASADM
"RTN","EASECPC",15,0)
 ;E  S EASADM=""   ;EAS*1.0*79
"RTN","EASECPC",16,0)
 ; Get start date for report
"RTN","EASECPC",17,0)
 S EASRDT=$$RPTDT Q:'EASRDT
"RTN","EASECPC",18,0)
 ;EAS*1.0*79 - moved from 4 lines up, and added EASADM as a parameter
"RTN","EASECPC",19,0)
 ;Set EASADM to the report date for Non-Institutional (OP) reports
"RTN","EASECPC",20,0)
 I EASRPT=2 S EASADM=EASRDT
"RTN","EASECPC",21,0)
 ; Get most recent LTC Copay Test for patient and set up LTC variables
"RTN","EASECPC",22,0)
 I '$$GETLTC(DFN,EASADM) Q
"RTN","EASECPC",23,0)
 ; Run the report
"RTN","EASECPC",24,0)
 D QUE
"RTN","EASECPC",25,0)
 Q
"RTN","EASECPC",26,0)
RPT() ; Select which report to print
"RTN","EASECPC",27,0)
 ; Input:   None
"RTN","EASECPC",28,0)
 ; Output:  Y - Report Type (1=Institutional (IP); 2=Non-Institutional (OP); 0=Quit)
"RTN","EASECPC",29,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","EASECPC",30,0)
 W !!,"Report of Calculated Long Term Care Copayments"
"RTN","EASECPC",31,0)
 W !,"=============================================="
"RTN","EASECPC",32,0)
 S DIR(0)="S^1:Institutional (Inpatient);2:Non-Institutional (Outpatient)"
"RTN","EASECPC",33,0)
 S DIR("A")="Enter 1 or 2"
"RTN","EASECPC",34,0)
 D ^DIR I 'Y!($D(DTOUT))!($D(DUOUT)) Q 0
"RTN","EASECPC",35,0)
 Q Y
"RTN","EASECPC",36,0)
GETDFN() ; Get the veteran's DFN
"RTN","EASECPC",37,0)
 N DIC,DTOUT,DUOUT,X,Y
"RTN","EASECPC",38,0)
 W !
"RTN","EASECPC",39,0)
 S DIC="^DPT(",DIC(0)="AEMZQ",DIC("S")="I $D(^DGMT(408.31,""AID"",3,+Y))"
"RTN","EASECPC",40,0)
 D ^DIC
"RTN","EASECPC",41,0)
 Q:$D(DTOUT)!($D(DUOUT)) 0
"RTN","EASECPC",42,0)
 Q:Y<0 0
"RTN","EASECPC",43,0)
 Q +Y
"RTN","EASECPC",44,0)
 ;EAS*1.0*79 - added EASADM as a parameter
"RTN","EASECPC",45,0)
GETLTC(DFN,EASADM) ; Get the most recent LTC copay test.  If no completed test on
"RTN","EASECPC",46,0)
 ; file, test status is exempt or LTC copay rates not defined, quit 0
"RTN","EASECPC",47,0)
 ; Input:   DFN - Patient file IEN
"RTN","EASECPC",48,0)
 ;          EASADM - LTC Admission Date
"RTN","EASECPC",49,0)
 ; Output:  DGMTI - LTC Copay Test IEN (file #408.31)
"RTN","EASECPC",50,0)
 ;          DGMTDT - LTC Copay Test Date
"RTN","EASECPC",51,0)
 ;          MAXRT - Maximum daily copay rates for OP and IP LTC
"RTN","EASECPC",52,0)
 ;          1=OK to continue; 0=Not OK to continue
"RTN","EASECPC",53,0)
 N LTC,STAT
"RTN","EASECPC",54,0)
 ;EAS*1.0*79 - added EASADM to $$LST call, and text in WRITE line following
"RTN","EASECPC",55,0)
 S LTC=$$LST^EASECU(DFN,EASADM),DGMTI=+LTC
"RTN","EASECPC",56,0)
 I 'DGMTI W !!,"No LTC Copayment Test on file for this veteran for that LTC admission date!" Q 0
"RTN","EASECPC",57,0)
 S DGMTDT=$P(LTC,U,2),STAT=$P(LTC,U,3)
"RTN","EASECPC",58,0)
 ; Get the maximum daily copay rate for outpatient and inpatient LTC
"RTN","EASECPC",59,0)
 ; DBIA #3717
"RTN","EASECPC",60,0)
 S MAXRT=$$MAXRATE^IBAECU(DGMTDT)
"RTN","EASECPC",61,0)
 I '$P(MAXRT,U)!('$P(MAXRT,U,2)) W !!,"Copayment rates for LTC are not available at this time.",!! Q 0
"RTN","EASECPC",62,0)
 ; Check test status, if anything other than Non-Exempt don't continue
"RTN","EASECPC",63,0)
 D DISDT^EASECU(DFN,EASADM)   ;EAS*1.0*79
"RTN","EASECPC",64,0)
 I STAT="NON-EXEMPT" Q 1
"RTN","EASECPC",65,0)
 I STAT="" W !!,"The LTC Copayment Test is incomplete!" Q 0
"RTN","EASECPC",66,0)
 I STAT="EXEMPT" W !!,"This veteran is Exempt from LTC copayments!" Q 0
"RTN","EASECPC",67,0)
 W !!,"This LTC Copayment Test contains an invalid status!"
"RTN","EASECPC",68,0)
 Q 0
"RTN","EASECPC",69,0)
ADMDT() ; Get the LTC admission date (for IP report only)
"RTN","EASECPC",70,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","EASECPC",71,0)
 W !
"RTN","EASECPC",72,0)
 S DIR(0)="D^::EX"
"RTN","EASECPC",73,0)
 S DIR("A")="Enter the LTC Admission Date"
"RTN","EASECPC",74,0)
 S DIR("?",1)="Enter the admission date for the current institutional"
"RTN","EASECPC",75,0)
 S DIR("?")="Long Term Care episode."
"RTN","EASECPC",76,0)
 D ^DIR I 'Y!($D(DTOUT))!($D(DUOUT)) Q 0
"RTN","EASECPC",77,0)
 Q Y
"RTN","EASECPC",78,0)
RPTDT() ; Get the start date for the report
"RTN","EASECPC",79,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,DAYS
"RTN","EASECPC",80,0)
RD W !
"RTN","EASECPC",81,0)
 S DIR(0)="D^::EMX"
"RTN","EASECPC",82,0)
 S DIR("A")="Enter the Report Start Date (Month/Year)"
"RTN","EASECPC",83,0)
 S DIR("?",1)="Enter the starting date for the report in the format month/year (e.g. 9/03)."
"RTN","EASECPC",84,0)
 S DIR("?",2)="The report will print 12 months of copayments starting with the"
"RTN","EASECPC",85,0)
 S DIR("?")="month and year entered."
"RTN","EASECPC",86,0)
 D ^DIR I 'Y!($D(DTOUT))!($D(DUOUT)) Q 0
"RTN","EASECPC",87,0)
 S DAYS=$$DOM^EASECPC1(Y)
"RTN","EASECPC",88,0)
 I (Y+DAYS)<$G(EASADM) W !!,*7,"Report Start Date cannot be before LTC Admission Date!" G RD
"RTN","EASECPC",89,0)
 Q Y+DAYS
"RTN","EASECPC",90,0)
 ;
"RTN","EASECPC",91,0)
QUE ; Get report device. Queue report if requested.
"RTN","EASECPC",92,0)
 N POP,ZTRTN,ZTDESC,ZTSAVE
"RTN","EASECPC",93,0)
 K IOP,%ZIS
"RTN","EASECPC",94,0)
 S %ZIS="MQ"
"RTN","EASECPC",95,0)
 W !
"RTN","EASECPC",96,0)
 D ^%ZIS I POP W !!,"Report Cancelled!" Q
"RTN","EASECPC",97,0)
 I $D(IO("Q")) D  Q
"RTN","EASECPC",98,0)
 . S ZTRTN="START^EASECPC1"
"RTN","EASECPC",99,0)
 . S ZTDESC="LTC Copay Calculation Report"
"RTN","EASECPC",100,0)
 . S (ZTSAVE("DFN"),ZTSAVE("DGMTI"),ZTSAVE("DGMTDT"),ZTSAVE("MAXRT"))=""
"RTN","EASECPC",101,0)
 . S (ZTSAVE("EASRPT"),ZTSAVE("EASRDT"))="",ZTSAVE("EASADM")=$G(EASADM)
"RTN","EASECPC",102,0)
 . D ^%ZTLOAD
"RTN","EASECPC",103,0)
 . W !!,"Report "_$S($D(ZTSK):"Queued!",1:"Cancelled!")
"RTN","EASECPC",104,0)
 . D HOME^%ZIS
"RTN","EASECPC",105,0)
 D START^EASECPC1,^%ZISC
"RTN","EASECPC",106,0)
 Q
"RTN","EASECU")
0^1^B11675837^B7172309
"RTN","EASECU",1,0)
EASECU ;ALB/PHH,LBD,AMA - LTC Co-Pay Test Utilities ; 22 AUG 2001
"RTN","EASECU",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**5,7,34,40,79**;Mar 15, 2001;Build 3
"RTN","EASECU",3,0)
 ;
"RTN","EASECU",4,0)
LST(DFN,DGDT,DGMTYPT) ;Last LTC Co-Pay test for a patient
"RTN","EASECU",5,0)
 ;         Input  -- DFN   Patient IEN
"RTN","EASECU",6,0)
 ;                   DGDT  Date/Time  (Optional- default today@2359)
"RTN","EASECU",7,0)
 ;                DGMTYPT  Type of Test (Optional - if not defined 
"RTN","EASECU",8,0)
 ;                                       LTC Co-Pay will be assumed)
"RTN","EASECU",9,0)
 ;         Output -- LTC Co-Pay Test IEN^Date of Test
"RTN","EASECU",10,0)
 ;                   ^Status Name^Status Code^Source of Test
"RTN","EASECU",11,0)
 N DGIDT,DGMTFL1,DGMTI,DGNOD,Y I '$D(DGMTYPT) S DGMTYPT=3
"RTN","EASECU",12,0)
 S DGIDT=$S($G(DGDT)>0:-DGDT,1:-DT) S:'$P(DGIDT,".",2) DGIDT=DGIDT_.2359
"RTN","EASECU",13,0)
 F  S DGIDT=+$O(^DGMT(408.31,"AID",DGMTYPT,DFN,DGIDT)) Q:'DGIDT!$G(DGMTFL1)  D
"RTN","EASECU",14,0)
 . F DGMTI=0:0 S DGMTI=+$O(^DGMT(408.31,"AID",DGMTYPT,DFN,DGIDT,DGMTI)) Q:'DGMTI!$G(DGMTFL1)  D
"RTN","EASECU",15,0)
 . . S DGNOD=$G(^DGMT(408.31,DGMTI,0)) I DGNOD S DGMTFL1=1,Y=DGMTI_"^"_$P(^(0),"^")_"^"_$$MTS(+$P(^(0),"^",3))_"^"_$P(DGNOD,"^",23)
"RTN","EASECU",16,0)
 Q $G(Y)
"RTN","EASECU",17,0)
 ;
"RTN","EASECU",18,0)
MTS(DGMTS) ;LTC Co-Pay test status -- default current
"RTN","EASECU",19,0)
 ;         Input  -- DGMTS  LTC Co-Pay Test Status IEN
"RTN","EASECU",20,0)
 ;         Output -- Status Name^Status Code
"RTN","EASECU",21,0)
 N Y
"RTN","EASECU",22,0)
 I $G(DGMTS) S Y=$P($G(^DG(408.32,DGMTS,0)),"^",1,2)
"RTN","EASECU",23,0)
 Q $G(Y)
"RTN","EASECU",24,0)
 ;
"RTN","EASECU",25,0)
EXMPT(DFN) ;Check if veteran is exempt from LTC co-payments:
"RTN","EASECU",26,0)
 ; If the veteran has a compensable SC disability, OR
"RTN","EASECU",27,0)
 ; If the veteran is a single, NSC pensioner not in receipt of A&A
"RTN","EASECU",28,0)
 ; and HB benefits
"RTN","EASECU",29,0)
 ;   Input   -- DFN  Patient IEN
"RTN","EASECU",30,0)
 ;   Output  -- 0 = veteran not exempt
"RTN","EASECU",31,0)
 ;              1 = veteran has compensable SC disability
"RTN","EASECU",32,0)
 ;              2 = veteran is single NSC pensioner (no A&A, HB)
"RTN","EASECU",33,0)
 N X,Y,ELG
"RTN","EASECU",34,0)
 S Y=0
"RTN","EASECU",35,0)
 ; if service connected percentage is greater than 10% OR service
"RTN","EASECU",36,0)
 ; connected percentage is less than 10% and annual VA
"RTN","EASECU",37,0)
 ; check amount is greater than 0, then exempt type 1
"RTN","EASECU",38,0)
 S X=$G(^DPT(DFN,.36)),ELG=$P($G(^DIC(8,+X,0)),U,9)
"RTN","EASECU",39,0)
 I ELG=1!($P($G(^DPT(DFN,.3)),U,2)'<10) S Y=1 G EXMPTQ
"RTN","EASECU",40,0)
 I ELG=3,$P($G(^DPT(DFN,.3)),U,2)<10,$P($G(^DPT(DFN,.362)),U,20)>0 S Y=1 G EXMPTQ
"RTN","EASECU",41,0)
 ; if Service Connected quit
"RTN","EASECU",42,0)
 I $P($G(^DPT(DFN,.3)),U)="Y" G EXMPTQ
"RTN","EASECU",43,0)
 ; if Marital Status = 'Married' or 'Separated' quit
"RTN","EASECU",44,0)
 S X=$P($G(^DIC(11,+$P($G(^DPT(DFN,0)),U,5),0)),U,3)
"RTN","EASECU",45,0)
 I "^M^S^"[("^"_X_"^") G EXMPTQ
"RTN","EASECU",46,0)
 ; if not receiving VA pension quit
"RTN","EASECU",47,0)
 S X=$G(^DPT(DFN,.362)) I $P(X,U,14)'="Y" G EXMPTQ
"RTN","EASECU",48,0)
 ; if receiving A&A or HP benefits quit
"RTN","EASECU",49,0)
 I $P(X,U,12)="Y"!($P(X,U,13)="Y") G EXMPTQ
"RTN","EASECU",50,0)
 S Y=2
"RTN","EASECU",51,0)
EXMPTQ Q Y
"RTN","EASECU",52,0)
 ;
"RTN","EASECU",53,0)
DIS(DFN) ;Display patient's current LTC Copay Test status and test date
"RTN","EASECU",54,0)
 ; Input --  DFN   IEN of Patient file
"RTN","EASECU",55,0)
 ; Output -- None
"RTN","EASECU",56,0)
 N DGX,DGMTI,DGMTDT,DGMTS
"RTN","EASECU",57,0)
 Q:'$G(DFN)
"RTN","EASECU",58,0)
 S DGX=$$LST(DFN) Q:'DGX
"RTN","EASECU",59,0)
 S DGMTI=+DGX,DGMTDT=$P(DGX,U,2),DGMTS=$P(DGX,U,3) S:DGMTS="" DGMTS="UNKNOWN"
"RTN","EASECU",60,0)
 W !,"LTC Copayment Status: ",DGMTS,"   Last Test: " S Y=DGMTDT X ^DD("DD") W Y
"RTN","EASECU",61,0)
 ; If last test is over a year old and patient is not deceased or not
"RTN","EASECU",62,0)
 ; exempt due to eligibility (compensable SC) or LTC before 11/30/99
"RTN","EASECU",63,0)
 ; display message that a new test is required
"RTN","EASECU",64,0)
 I $$FMDIFF^XLFDT(DT,DGMTDT)>364 D
"RTN","EASECU",65,0)
 . I $P($G(^DPT(DFN,.35)),U) Q
"RTN","EASECU",66,0)
 . I "^1^4^"[(U_$P($G(^DGMT(408.31,DGMTI,2)),U,7)_U) Q
"RTN","EASECU",67,0)
 . W " **NEW TEST REQUIRED**"
"RTN","EASECU",68,0)
 I $P($G(^DGMT(408.31,DGMTI,0)),U,11)=0 W !,"Patient INELIGIBLE to Receive LTC Services -- Did Not Agree to Pay Copayments"
"RTN","EASECU",69,0)
 Q
"RTN","EASECU",70,0)
 ;
"RTN","EASECU",71,0)
FORM(DGMTI) ; Return the version of the 10-10EC form used to complete
"RTN","EASECU",72,0)
 ; the LTC Copay Test passed in DGMTI
"RTN","EASECU",73,0)
 ;     Input:  DGMTI - LTC Copay Test (IEN file #408.31)
"RTN","EASECU",74,0)
 ;     Output: 0 = Original format
"RTN","EASECU",75,0)
 ;             1 = Revised format
"RTN","EASECU",76,0)
 I '$G(DGMTI) Q 0
"RTN","EASECU",77,0)
 Q $P($G(^DGMT(408.31,DGMTI,2)),U,10)
"RTN","EASECU",78,0)
 ;
"RTN","EASECU",79,0)
 ;EAS*1.0*79 - Instead of changing DIS (in case another routine
"RTN","EASECU",80,0)
 ;             calls it), copied it but also used LTC Admission Date
"RTN","EASECU",81,0)
DISDT(DFN,EASADM) ;Display patient's LTC Copay Test status for a given LTC Admission Date
"RTN","EASECU",82,0)
 ; Input -- DFN - IEN of Patient file
"RTN","EASECU",83,0)
 ;          EASADM - LTC Admission Date
"RTN","EASECU",84,0)
 ; Output -- None
"RTN","EASECU",85,0)
 N DGX,DGMTI,DGMTDT,DGMTS
"RTN","EASECU",86,0)
 Q:'$G(DFN)  Q:'$G(EASADM)
"RTN","EASECU",87,0)
 S DGX=$$LST(DFN,EASADM) Q:'DGX
"RTN","EASECU",88,0)
 S DGMTI=+DGX,DGMTDT=$P(DGX,U,2),DGMTS=$P(DGX,U,3) S:DGMTS="" DGMTS="UNKNOWN"
"RTN","EASECU",89,0)
 W !,"LTC Copayment Status: ",DGMTS,"   Last Test: " S Y=DGMTDT X ^DD("DD") W Y
"RTN","EASECU",90,0)
 ; If last test is over a year old and patient is not deceased or not
"RTN","EASECU",91,0)
 ; exempt due to eligibility (compensable SC) or LTC before 11/30/99
"RTN","EASECU",92,0)
 ; display message that a new test is required
"RTN","EASECU",93,0)
 I $$FMDIFF^XLFDT(DT,DGMTDT)>364 D
"RTN","EASECU",94,0)
 . I $P($G(^DPT(DFN,.35)),U) Q
"RTN","EASECU",95,0)
 . I "^1^4^"[(U_$P($G(^DGMT(408.31,DGMTI,2)),U,7)_U) Q
"RTN","EASECU",96,0)
 . W " **NEW TEST REQUIRED**"
"RTN","EASECU",97,0)
 I $P($G(^DGMT(408.31,DGMTI,0)),U,11)=0 W !,"Patient INELIGIBLE to Receive LTC Services -- Did Not Agree to Pay Copayments"
"RTN","EASECU",98,0)
 Q
"VER")
8.0^22.0
"BLD",6509,6)
^67
**END**
**END**
