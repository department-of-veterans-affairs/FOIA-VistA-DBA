Released QAC*2*9 SEQ #9
Extracted from mail message
**KIDS**:QAC*2.0*9^

**INSTALL NAME**
QAC*2.0*9
"BLD",1717,0)
QAC*2.0*9^PATIENT REPRESENTATIVE^0^^y
"BLD",1717,4,0)
^9.64PA^^
"BLD",1717,"ABNS",0)
^9.66A^1^1
"BLD",1717,"ABNS",1,0)
QAC
"BLD",1717,"ABNS",1,1,0)
^9.661A^^
"BLD",1717,"ABNS","B","QAC",1)

"BLD",1717,"ABPKG")
y^n
"BLD",1717,"KRN",0)
^9.67PA^19^18
"BLD",1717,"KRN",.4,0)
.4
"BLD",1717,"KRN",.4,"NM",0)
^9.68A^8^7
"BLD",1717,"KRN",.4,"NM",1,0)
QAC DISC RPT HEADER    FILE #745.1^745.1^0
"BLD",1717,"KRN",.4,"NM",2,0)
QAC DISC SERV RPT HEADER    FILE #745.1^745.1^0
"BLD",1717,"KRN",.4,"NM",3,0)
QAC EMP CONTACT HEADER    FILE #745.1^745.1^0
"BLD",1717,"KRN",.4,"NM",5,0)
QAC DAILY HEADER    FILE #745.1^745.1^0
"BLD",1717,"KRN",.4,"NM",6,0)
QAC RESP DUE HEADER    FILE #745.1^745.1^0
"BLD",1717,"KRN",.4,"NM",7,0)
QAC NOPAT HEADER    FILE #745.1^745.1^0
"BLD",1717,"KRN",.4,"NM",8,0)
QAC STATUS HEADER    FILE #745.1^745.1^0
"BLD",1717,"KRN",.4,"NM","B","QAC DAILY HEADER    FILE #745.1",5)

"BLD",1717,"KRN",.4,"NM","B","QAC DISC RPT HEADER    FILE #745.1",1)

"BLD",1717,"KRN",.4,"NM","B","QAC DISC SERV RPT HEADER    FILE #745.1",2)

"BLD",1717,"KRN",.4,"NM","B","QAC EMP CONTACT HEADER    FILE #745.1",3)

"BLD",1717,"KRN",.4,"NM","B","QAC NOPAT HEADER    FILE #745.1",7)

"BLD",1717,"KRN",.4,"NM","B","QAC RESP DUE HEADER    FILE #745.1",6)

"BLD",1717,"KRN",.4,"NM","B","QAC STATUS HEADER    FILE #745.1",8)

"BLD",1717,"KRN",.401,0)
.401
"BLD",1717,"KRN",.401,"NM",0)
^9.68A^6^6
"BLD",1717,"KRN",.401,"NM",1)
^^^
"BLD",1717,"KRN",.401,"NM",1,0)
QAC DAILY    FILE #745.1^745.1^1
"BLD",1717,"KRN",.401,"NM",2)
^^^
"BLD",1717,"KRN",.401,"NM",2,0)
QAC DISC RPT    FILE #745.1^745.1^1
"BLD",1717,"KRN",.401,"NM",3)
^^^
"BLD",1717,"KRN",.401,"NM",3,0)
QAC EMP TOT    FILE #745.1^745.1^1
"BLD",1717,"KRN",.401,"NM",4)
^^^
"BLD",1717,"KRN",.401,"NM",4,0)
QAC EMPLOYEE    FILE #745.1^745.1^1
"BLD",1717,"KRN",.401,"NM",5)
^^^
"BLD",1717,"KRN",.401,"NM",5,0)
QAC RESP DUE    FILE #745.1^745.1^1
"BLD",1717,"KRN",.401,"NM",6)
^^^
"BLD",1717,"KRN",.401,"NM",6,0)
QAC STATUS    FILE #745.1^745.1^1
"BLD",1717,"KRN",.401,"NM","B","QAC DAILY    FILE #745.1",1)

"BLD",1717,"KRN",.401,"NM","B","QAC DISC RPT    FILE #745.1",2)

"BLD",1717,"KRN",.401,"NM","B","QAC EMP TOT    FILE #745.1",3)

"BLD",1717,"KRN",.401,"NM","B","QAC EMPLOYEE    FILE #745.1",4)

"BLD",1717,"KRN",.401,"NM","B","QAC RESP DUE    FILE #745.1",5)

"BLD",1717,"KRN",.401,"NM","B","QAC STATUS    FILE #745.1",6)

"BLD",1717,"KRN",.402,0)
.402
"BLD",1717,"KRN",.403,0)
.403
"BLD",1717,"KRN",.5,0)
.5
"BLD",1717,"KRN",.84,0)
.84
"BLD",1717,"KRN",3.6,0)
3.6
"BLD",1717,"KRN",3.8,0)
3.8
"BLD",1717,"KRN",3.8,"NM",0)
^9.68A^^0
"BLD",1717,"KRN",9.2,0)
9.2
"BLD",1717,"KRN",9.8,0)
9.8
"BLD",1717,"KRN",9.8,"NM",0)
^9.68A^22^22
"BLD",1717,"KRN",9.8,"NM",1,0)
QACALRT1^^0^B26794321
"BLD",1717,"KRN",9.8,"NM",2,0)
QACALRT2^^0^B5816729
"BLD",1717,"KRN",9.8,"NM",3,0)
QACARCH^^0^B2312448
"BLD",1717,"KRN",9.8,"NM",4,0)
QACCSSTD^^0^B31980527
"BLD",1717,"KRN",9.8,"NM",5,0)
QACDAILY^^0^B1169256
"BLD",1717,"KRN",9.8,"NM",6,0)
QACDISC^^0^B48610907
"BLD",1717,"KRN",9.8,"NM",7,0)
QACDISPC^^0^B1270819
"BLD",1717,"KRN",9.8,"NM",8,0)
QACDISPS^^0^B1165536
"BLD",1717,"KRN",9.8,"NM",9,0)
QACEMPC^^0^B1195841
"BLD",1717,"KRN",9.8,"NM",10,0)
QACEMPE^^0^B74825901
"BLD",1717,"KRN",9.8,"NM",11,0)
QACGEN^^0^B42303671
"BLD",1717,"KRN",9.8,"NM",12,0)
QACNOPTS^^0^B1165577
"BLD",1717,"KRN",9.8,"NM",13,0)
QACOPEN^^0^B1193071
"BLD",1717,"KRN",9.8,"NM",14,0)
QACRESP^^0^B1229122
"BLD",1717,"KRN",9.8,"NM",15,0)
QACSPRD^^0^B8490851
"BLD",1717,"KRN",9.8,"NM",16,0)
QACSPRD1^^0^B25998059
"BLD",1717,"KRN",9.8,"NM",17,0)
QACSPRD2^^0^B34035187
"BLD",1717,"KRN",9.8,"NM",18,0)
QACSPRD3^^0^B27226725
"BLD",1717,"KRN",9.8,"NM",19,0)
QACSRV^^0^B1023295
"BLD",1717,"KRN",9.8,"NM",20,0)
QACRPT^^0^B24419566
"BLD",1717,"KRN",9.8,"NM",21,0)
QACBYLOC^^0^B20132612
"BLD",1717,"KRN",9.8,"NM",22,0)
QACUTL0^^0^B4109337
"BLD",1717,"KRN",9.8,"NM","B","QACALRT1",1)

"BLD",1717,"KRN",9.8,"NM","B","QACALRT2",2)

"BLD",1717,"KRN",9.8,"NM","B","QACARCH",3)

"BLD",1717,"KRN",9.8,"NM","B","QACBYLOC",21)

"BLD",1717,"KRN",9.8,"NM","B","QACCSSTD",4)

"BLD",1717,"KRN",9.8,"NM","B","QACDAILY",5)

"BLD",1717,"KRN",9.8,"NM","B","QACDISC",6)

"BLD",1717,"KRN",9.8,"NM","B","QACDISPC",7)

"BLD",1717,"KRN",9.8,"NM","B","QACDISPS",8)

"BLD",1717,"KRN",9.8,"NM","B","QACEMPC",9)

"BLD",1717,"KRN",9.8,"NM","B","QACEMPE",10)

"BLD",1717,"KRN",9.8,"NM","B","QACGEN",11)

"BLD",1717,"KRN",9.8,"NM","B","QACNOPTS",12)

"BLD",1717,"KRN",9.8,"NM","B","QACOPEN",13)

"BLD",1717,"KRN",9.8,"NM","B","QACRESP",14)

"BLD",1717,"KRN",9.8,"NM","B","QACRPT",20)

"BLD",1717,"KRN",9.8,"NM","B","QACSPRD",15)

"BLD",1717,"KRN",9.8,"NM","B","QACSPRD1",16)

"BLD",1717,"KRN",9.8,"NM","B","QACSPRD2",17)

"BLD",1717,"KRN",9.8,"NM","B","QACSPRD3",18)

"BLD",1717,"KRN",9.8,"NM","B","QACSRV",19)

"BLD",1717,"KRN",9.8,"NM","B","QACUTL0",22)

"BLD",1717,"KRN",19,0)
19
"BLD",1717,"KRN",19,"NM",0)
^9.68A^12^12
"BLD",1717,"KRN",19,"NM",1,0)
QAC DAILY CONTACTS^^0
"BLD",1717,"KRN",19,"NM",2,0)
QAC OPEN STATUS^^0
"BLD",1717,"KRN",19,"NM",3,0)
QAC EMPLOYEE^^0
"BLD",1717,"KRN",19,"NM",4,0)
QAC DISCIPLINE TOTALS^^0
"BLD",1717,"KRN",19,"NM",5,0)
QAC SERV/DISC CONTACT TOT^^0
"BLD",1717,"KRN",19,"NM",6,0)
QAC EMP TOTALS^^0
"BLD",1717,"KRN",19,"NM",7,0)
QAC RESP DUE^^0
"BLD",1717,"KRN",19,"NM",8,0)
QAC NOPATIENT^^0
"BLD",1717,"KRN",19,"NM",9,0)
QAC USER^^2
"BLD",1717,"KRN",19,"NM",10,0)
QAC STATISTICAL RPTS^^2
"BLD",1717,"KRN",19,"NM",11,0)
QAC LOCATION^^0
"BLD",1717,"KRN",19,"NM",12,0)
QAC RPT^^0
"BLD",1717,"KRN",19,"NM","B","QAC DAILY CONTACTS",1)

"BLD",1717,"KRN",19,"NM","B","QAC DISCIPLINE TOTALS",4)

"BLD",1717,"KRN",19,"NM","B","QAC EMP TOTALS",6)

"BLD",1717,"KRN",19,"NM","B","QAC EMPLOYEE",3)

"BLD",1717,"KRN",19,"NM","B","QAC LOCATION",11)

"BLD",1717,"KRN",19,"NM","B","QAC NOPATIENT",8)

"BLD",1717,"KRN",19,"NM","B","QAC OPEN STATUS",2)

"BLD",1717,"KRN",19,"NM","B","QAC RESP DUE",7)

"BLD",1717,"KRN",19,"NM","B","QAC RPT",12)

"BLD",1717,"KRN",19,"NM","B","QAC SERV/DISC CONTACT TOT",5)

"BLD",1717,"KRN",19,"NM","B","QAC STATISTICAL RPTS",10)

"BLD",1717,"KRN",19,"NM","B","QAC USER",9)

"BLD",1717,"KRN",19.1,0)
19.1
"BLD",1717,"KRN",101,0)
101
"BLD",1717,"KRN",409.61,0)
409.61
"BLD",1717,"KRN",771,0)
771
"BLD",1717,"KRN",869.2,0)
869.2
"BLD",1717,"KRN",870,0)
870
"BLD",1717,"KRN",8994,0)
8994
"BLD",1717,"KRN","B",.4,.4)

"BLD",1717,"KRN","B",.401,.401)

"BLD",1717,"KRN","B",.402,.402)

"BLD",1717,"KRN","B",.403,.403)

"BLD",1717,"KRN","B",.5,.5)

"BLD",1717,"KRN","B",.84,.84)

"BLD",1717,"KRN","B",3.6,3.6)

"BLD",1717,"KRN","B",3.8,3.8)

"BLD",1717,"KRN","B",9.2,9.2)

"BLD",1717,"KRN","B",9.8,9.8)

"BLD",1717,"KRN","B",19,19)

"BLD",1717,"KRN","B",19.1,19.1)

"BLD",1717,"KRN","B",101,101)

"BLD",1717,"KRN","B",409.61,409.61)

"BLD",1717,"KRN","B",771,771)

"BLD",1717,"KRN","B",869.2,869.2)

"BLD",1717,"KRN","B",870,870)

"BLD",1717,"KRN","B",8994,8994)

"BLD",1717,"QUES",0)
^9.62^^
"BLD",1717,"REQB",0)
^9.611^3^3
"BLD",1717,"REQB",1,0)
QAC*2.0*7^1
"BLD",1717,"REQB",2,0)
QAC*2.0*6^1
"BLD",1717,"REQB",3,0)
QAC*2.0*10^1
"BLD",1717,"REQB","B","QAC*2.0*10",3)

"BLD",1717,"REQB","B","QAC*2.0*6",2)

"BLD",1717,"REQB","B","QAC*2.0*7",1)

"KRN",.4,1783,-1)
0^5
"KRN",.4,1783,0)
QAC DAILY HEADER^2990201.1605^@^745.1^^@^2990408
"KRN",.4,1783,"F",1)
"Daily Listing of Patient Contacts"~S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~"PAGE ";C70~
"KRN",.4,1783,"F",2)
S X=$S($D(DC)#2:DC,1:"") W X K DIP;X;Z;"PAGE"~"Date Range Selected: ";C15~S Y=QAQNBEG D DD^%DT W Y;X;Z;"S Y=QAQNBEG D DD^%DT W Y"~" to ";X~
"KRN",.4,1783,"F",3)
S Y=QAQNEND D DD^%DT W Y;X;Z;"S Y=QAQNEND D DD^%DT W Y"~"Contact #";C5~"Patient Name";C25~"SSN";C60~"Issue Code";C1~"(*Customer Service Standard)";C50~
"KRN",.4,1783,"F",4)
"Serv/ Sect or Discipline";C5~
"KRN",.4,1783,"F",5)
S X="-",DIP(1)=X,DIP(2)=X,X=$S($D(IOM):IOM,1:80) S X=X,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",IOM)"~
"KRN",.4,1783,"H")
CONSUMER CONTACT LIST
"KRN",.4,2125,-1)
0^8
"KRN",.4,2125,0)
QAC STATUS HEADER^2981218.1322^@^745.1^^@^2990408
"KRN",.4,2125,"F",1)
"List of Open Cases"~S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~"PAGE ";C70~
"KRN",.4,2125,"F",2)
S X=$S($D(DC)#2:DC,1:"") W X K DIP;X;Z;"PAGE"~"Date Range Selected: ";C15~S Y=QAQNBEG D DD^%DT W Y;X;Z;"S Y=QAQNBEG D DD^%DT W Y"~" to ";X~
"KRN",.4,2125,"F",3)
S Y=QAQNEND D DD^%DT W Y;X;Z;"S Y=QAQNEND D DD^%DT W Y"~"Date of";C1~"Contact";C1~"Patient Name";C14~"SSN";C46~"Contact #";C57~
"KRN",.4,2125,"F",4)
S X="-",DIP(1)=X,DIP(2)=X,X=$S($D(IOM):IOM,1:80) S X=X,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",IOM)"~
"KRN",.4,2125,"H")
LIST OF OPEN CASES
"KRN",.4,2126,-1)
0^3
"KRN",.4,2126,0)
QAC EMP CONTACT HEADER^2981223.111^@^745.1^^@^2990408
"KRN",.4,2126,"F",1)
"Employee Contact Totals"~S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~"PAGE";C70~
"KRN",.4,2126,"F",2)
S X=$S($D(DC)#2:DC,1:"") W X K DIP;X;Z;"PAGE"~"Date Range Selected: ";C15~S Y=QAQNBEG D DD^%DT W Y;X;Z;"S Y=QAQNBEG D DD^%DT W Y"~" to ";X~
"KRN",.4,2126,"F",3)
S Y=QAQNEND D DD^%DT W Y;X;Z;"S Y=QAQNEND D DD^%DT W Y"~"Contact";C35~"Patient";C2~"Date";C35~
"KRN",.4,2126,"F",4)
S X="-",DIP(1)=X,DIP(2)=X,X=$S($D(IOM):IOM,1:80) S X=X,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",IOM)"~
"KRN",.4,2126,"H")
EMPLOYEE CONTACT TOTALS
"KRN",.4,2127,-1)
0^1
"KRN",.4,2127,0)
QAC DISC RPT HEADER^2990111.1544^@^745.1^^@^2990413
"KRN",.4,2127,"F",1)
"Discipline Contact Totals"~S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~"PAGE ";C70~
"KRN",.4,2127,"F",2)
S X=$S($D(DC)#2:DC,1:"") W X K DIP;X;Z;"PAGE"~"Date Range Selected: ";C15~S Y=QAQNBEG D DD^%DT W Y;X;Z;"S Y=QAQNBEG D DD^%DT W Y"~" to ";X~
"KRN",.4,2127,"F",3)
S Y=QAQNEND D DD^%DT W Y;X;Z;"S Y=QAQNEND D DD^%DT W Y"~"Contact";C1~"Date";C1~"Patient";C15~"SSN";C45~"Contact #";C65~"Issue Text";C3~
"KRN",.4,2127,"F",4)
S X="-",DIP(1)=X,DIP(2)=X,X=$S($D(IOM):IOM,1:80) S X=X,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",IOM)"~
"KRN",.4,2127,"H")
DISCIPLINE CONTACT TOTALS
"KRN",.4,2128,-1)
0^7
"KRN",.4,2128,0)
QAC NOPAT HEADER^2981223.1112^@^745.1^^@^2990408
"KRN",.4,2128,"F",1)
"Contacts with No Patient Identified"~S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~"PAGE ";C70~
"KRN",.4,2128,"F",2)
S X=$S($D(DC)#2:DC,1:"") W X K DIP;X;Z;"PAGE"~"Date Range Selected: ";C15~S Y=QAQNBEG D DD^%DT W Y;X;Z;"S Y=QAQNBEG D DD^%DT W Y"~" to ";X~
"KRN",.4,2128,"F",3)
S Y=QAQNEND D DD^%DT W Y;X;Z;"S Y=QAQNEND D DD^%DT W Y"~"Contact";C1~"Date Of";C17~"Number";C1~"Contact";C17~
"KRN",.4,2128,"F",4)
S X="-",DIP(1)=X,DIP(2)=X,X=$S($D(IOM):IOM,1:80) S X=X,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",IOM)"~
"KRN",.4,2128,"H")
CONTACTS WITH NO PATIENT IDENTIFIED
"KRN",.4,2256,-1)
0^6
"KRN",.4,2256,0)
QAC RESP DUE HEADER^2990107.103^@^745.1^^@^2990408
"KRN",.4,2256,"F",1)
"Responses Due"~S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~"PAGE ";C70~
"KRN",.4,2256,"F",2)
S X=$S($D(DC)#2:DC,1:"") W X K DIP;X;Z;"PAGE"~"Date Range Selected: ";C15~S Y=QAQNBEG D DD^%DT W Y;X;Z;"S Y=QAQNBEG D DD^%DT W Y"~" to ";X~
"KRN",.4,2256,"F",3)
S Y=QAQNEND D DD^%DT W Y;X;Z;"S Y=QAQNEND D DD^%DT W Y"~"Contact #";C1~"Patient Name";C15~"SSN";C44~"Refer To";C57~"Issue Codes";C1~
"KRN",.4,2256,"F",4)
S X="-",DIP(1)=X,DIP(2)=X,X=$S($D(IOM):IOM,1:80) S X=X,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",IOM)"~
"KRN",.4,2256,"H")
RESPONSES DUE
"KRN",.4,2262,-1)
0^2
"KRN",.4,2262,0)
QAC DISC SERV RPT HEADER^2990111.154^@^745.1^^@^2990413
"KRN",.4,2262,"F",1)
"Service/Discipline Contact Totals"~S %=$P($H,",",2),X=DT_(%\60#60/100+(%\3600)+(%#60/10000)/100) S Y=X D DT K DIP;C48;L18;Z;"NOW"~"PAGE ";C70~
"KRN",.4,2262,"F",2)
S X=$S($D(DC)#2:DC,1:"") W X K DIP;X;Z;"PAGE"~"Date Range Selected: ";C15~S Y=QAQNBEG D DD^%DT W Y;X;Z;"S Y=QAQNBEG D DD^%DT W Y"~" to ";X~
"KRN",.4,2262,"F",3)
S Y=QAQNEND D DD^%DT W Y;X;Z;"S Y=QAQNEND D DD^%DT W Y"~"Contact";C1~"Date";C1~"Patient";C15~"SSN";C45~"Contact #";C65~"Issue Text";C3~
"KRN",.4,2262,"F",4)
S X="-",DIP(1)=X,DIP(2)=X,X=$S($D(IOM):IOM,1:80) S X=X,X1=DIP(1) S %=X,X="" Q:X1=""  S $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("-",IOM)"~
"KRN",.4,2262,"H")
SERVICE/DISCIPLINE CONTACT TOTALS
"KRN",.401,1696,-1)
1^1
"KRN",.401,1696,0)
QAC DAILY    FILE #745.1
"KRN",.401,1697,-1)
1^2
"KRN",.401,1697,0)
QAC DISC RPT    FILE #745.1
"KRN",.401,1698,-1)
1^3
"KRN",.401,1698,0)
QAC EMP TOT    FILE #745.1
"KRN",.401,1699,-1)
1^4
"KRN",.401,1699,0)
QAC EMPLOYEE    FILE #745.1
"KRN",.401,1700,-1)
1^5
"KRN",.401,1700,0)
QAC RESP DUE    FILE #745.1
"KRN",.401,1701,-1)
1^6
"KRN",.401,1701,0)
QAC STATUS    FILE #745.1
"KRN",19,5427,-1)
0^12
"KRN",19,5427,0)
QAC RPT^Report of Contact^^R^^^^^^^^
"KRN",19,5427,1,0)
^^2^2^2970806^^^^
"KRN",19,5427,1,1,0)
This option allows you to print a Report of Contact to a printer
"KRN",19,5427,1,2,0)
or screen.
"KRN",19,5427,25)
QACRPT
"KRN",19,5427,"U")
REPORT OF CONTACT
"KRN",19,5438,-1)
2^9
"KRN",19,5438,0)
QAC USER^User Menu^^M^.5^^^^^^^
"KRN",19,5438,10,0)
^19.01IP^4^4
"KRN",19,5438,10,4,0)
5427
"KRN",19,5438,10,4,"^")
QAC RPT
"KRN",19,5438,"U")
USER MENU
"KRN",19,5439,-1)
0^8
"KRN",19,5439,0)
QAC NOPATIENT^Contacts with No Patient Identified^^R^^^^^^^y^PATIENT REPRESENTATIVE
"KRN",19,5439,1,0)
^^2^2^2990113^^^^
"KRN",19,5439,1,1,0)
This option prints a list of contact records that do not have a patient
"KRN",19,5439,1,2,0)
name associated with the contact.
"KRN",19,5439,25)
QACNOPTS
"KRN",19,5439,99)
56235,40489
"KRN",19,5439,"U")
CONTACTS WITH NO PATIENT IDENT
"KRN",19,5441,-1)
0^1
"KRN",19,5441,0)
QAC DAILY CONTACTS^Daily List of Patient Contacts^^R^^^^^^^^PATIENT REPRESENTATIVE
"KRN",19,5441,1,0)
^^1^1^2970816^^^^
"KRN",19,5441,1,1,0)
This report prints a listing of all contacts for a selected date range.
"KRN",19,5441,25)
QACDAILY
"KRN",19,5441,60)

"KRN",19,5441,62)

"KRN",19,5441,63)

"KRN",19,5441,64)

"KRN",19,5441,67)

"KRN",19,5441,73)

"KRN",19,5441,"U")
DAILY LIST OF PATIENT CONTACTS
"KRN",19,5442,-1)
0^7
"KRN",19,5442,0)
QAC RESP DUE^Responses Due^^R^^^^^^^^PATIENT REPRESENTATIVE
"KRN",19,5442,1,0)
^^2^2^2990113^^^^
"KRN",19,5442,1,1,0)
This option checks the Date Due field of all Open records for dates
"KRN",19,5442,1,2,0)
previous to Today.
"KRN",19,5442,25)
QACRESP
"KRN",19,5442,60)

"KRN",19,5442,62)

"KRN",19,5442,63)

"KRN",19,5442,64)

"KRN",19,5442,65)

"KRN",19,5442,66)

"KRN",19,5442,"U")
RESPONSES DUE
"KRN",19,5443,-1)
0^3
"KRN",19,5443,0)
QAC EMPLOYEE^Report by Employee^^R^^^^^^^y^PATIENT REPRESENTATIVE
"KRN",19,5443,1,0)
^^2^2^2981211^^^^
"KRN",19,5443,1,1,0)
This option prints a report by employee name that contains the contact
"KRN",19,5443,1,2,0)
record number, date of the contact, patient, location and issue text.
"KRN",19,5443,25)
QACEMPE
"KRN",19,5443,31)
 
"KRN",19,5443,32)
 
"KRN",19,5443,60)

"KRN",19,5443,62)

"KRN",19,5443,63)

"KRN",19,5443,64)

"KRN",19,5443,65)

"KRN",19,5443,66)

"KRN",19,5443,"U")
REPORT BY EMPLOYEE
"KRN",19,5444,-1)
0^2
"KRN",19,5444,0)
QAC OPEN STATUS^List of Open Cases^^R^^^^^^^y^PATIENT REPRESENTATIVE^^
"KRN",19,5444,1,0)
^^2^2^2990113^^^^
"KRN",19,5444,1,1,0)
This report provides the date of contact, patient name, SSN and contact
"KRN",19,5444,1,2,0)
number for all open cases.
"KRN",19,5444,20)

"KRN",19,5444,25)
QACOPEN
"KRN",19,5444,60)

"KRN",19,5444,62)

"KRN",19,5444,63)

"KRN",19,5444,64)

"KRN",19,5444,65)

"KRN",19,5444,66)

"KRN",19,5444,"U")
LIST OF OPEN CASES
"KRN",19,5445,-1)
2^10
"KRN",19,5445,0)
QAC STATISTICAL RPTS^Statistical Reports Menu^^M^.5^^^^^^^380
"KRN",19,5445,10,0)
^19.01IP^14^11
"KRN",19,5445,10,5,0)
5447^
"KRN",19,5445,10,5,"^")
QAC EMP TOTALS
"KRN",19,5445,10,9,0)
7127^DC
"KRN",19,5445,10,9,"^")
QAC DISCIPLINE TOTALS
"KRN",19,5445,10,12,0)
7140^SC
"KRN",19,5445,10,12,"^")
QAC SERV/DISC CONTACT TOT
"KRN",19,5445,10,14,0)
9953
"KRN",19,5445,10,14,"^")
QAC LOCATION
"KRN",19,5445,"U")
STATISTICAL REPORTS MENU
"KRN",19,5447,-1)
0^6
"KRN",19,5447,0)
QAC EMP TOTALS^Employee Contact Totals^^R^^^^^^^y^PATIENT REPRESENTATIVE
"KRN",19,5447,1,0)
^^2^2^2990120^^^^
"KRN",19,5447,1,1,0)
This option prints total contacts for employees, including the patient
"KRN",19,5447,1,2,0)
name, contact date, and contact number.
"KRN",19,5447,25)
QACEMPC
"KRN",19,5447,60)

"KRN",19,5447,62)

"KRN",19,5447,63)

"KRN",19,5447,64)

"KRN",19,5447,65)

"KRN",19,5447,66)

"KRN",19,5447,"U")
EMPLOYEE CONTACT TOTALS
"KRN",19,7127,-1)
0^4
"KRN",19,7127,0)
QAC DISCIPLINE TOTALS^Discipline Contact Totals^^R^^^^^^^y^PATIENT REPRESENTATIVE
"KRN",19,7127,1,0)
^^2^2^2990113^^^^
"KRN",19,7127,1,1,0)
This option prints the total contacts for each discipline and includes
"KRN",19,7127,1,2,0)
the Contact Date, Patient, SSN, Contact Number and Issue Text.
"KRN",19,7127,25)
QACDISPC
"KRN",19,7127,60)

"KRN",19,7127,62)

"KRN",19,7127,63)

"KRN",19,7127,64)

"KRN",19,7127,"U")
DISCIPLINE CONTACT TOTALS
"KRN",19,7140,-1)
0^5
"KRN",19,7140,0)
QAC SERV/DISC CONTACT TOT^Service/Discipline Contact Totals^^R^^^^^^^^PATIENT REPRESENTATIVE
"KRN",19,7140,1,0)
^^1^1^2990113^^^^
"KRN",19,7140,1,1,0)
This report totals contacts by Service/Discipline
"KRN",19,7140,25)
QACDISPS
"KRN",19,7140,60)

"KRN",19,7140,62)

"KRN",19,7140,63)

"KRN",19,7140,64)

"KRN",19,7140,67)

"KRN",19,7140,"U")
SERVICE/DISCIPLINE CONTACT TOT
"KRN",19,9953,-1)
0^11
"KRN",19,9953,0)
QAC LOCATION^Location Issue Totals^^R^^^^^^^^PATIENT REPRESENTATIVE
"KRN",19,9953,1,0)
^^3^3^2990326^
"KRN",19,9953,1,1,0)
This report lists Issue Codes with the Issue Code names sorted by 
"KRN",19,9953,1,2,0)
hospital location.  Each hospital location will appear on a separate 
"KRN",19,9953,1,3,0)
page.
"KRN",19,9953,25)
QACBYLOC
"KRN",19,9953,"U")
LOCATION ISSUE TOTALS
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",6,.401)
.401;6;;;EDEOUT^DIFROMSO(.401,DA,"",XPDA);FPRE^DIFROMSI(.401,"",XPDA);EPRE^DIFROMSI(.401,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.401,DA,"",XPDA);DEL^DIFROMSK(.401,"",%)
"ORD",6,.401,0)
SORT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",380,-1)
1^1
"PKG",380,0)
PATIENT REPRESENTATIVE^QAC^PATIENT REPRESENTATIVE PACKAGE
"PKG",380,20,0)
^9.402P^^
"PKG",380,22,0)
^9.49I^1^1
"PKG",380,22,1,0)
2.0^2950725^2950914
"PKG",380,22,1,"PAH",1,0)
9
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
22
"RTN","QACALRT1")
0^1^B26794321
"RTN","QACALRT1",1,0)
QACALRT1 ;HISC/DAD-PROCESS AN ALERT ;3/23/95  10:22
"RTN","QACALRT1",2,0)
 ;;2.0;Patient Representative;**3,7,6,9**;07/25/1995
"RTN","QACALRT1",3,0)
EN ;
"RTN","QACALRT1",4,0)
 N QACDATE
"RTN","QACALRT1",5,0)
 K QACDELET
"RTN","QACALRT1",6,0)
 S QACX=$P(XQADATA,U),QACD0=$P(XQADATA,U,2),QACDUZ=$P(XQADATA,U,3)
"RTN","QACALRT1",7,0)
 S QACXQAID=$P(XQAID,";")
"RTN","QACALRT1",8,0)
 ;
"RTN","QACALRT1",9,0)
 ; Display contact information when alert processed.
"RTN","QACALRT1",10,0)
 S QAC=QACD0,QACRES=0 D START1^QACRPT
"RTN","QACALRT1",11,0)
 ;
"RTN","QACALRT1",12,0)
 S QAC=$S($D(^QA(745.1,QACD0,0))[0:1,$P($G(^(7)),U,2)="C":2,1:0)
"RTN","QACALRT1",13,0)
 I QAC D  G EXIT
"RTN","QACALRT1",14,0)
 . W !!?5,"*** The Patient Rep record associated with this alert"
"RTN","QACALRT1",15,0)
 . W ?63,"***",!?5,"*** has been ",$P("deleted^closed",U,QAC)
"RTN","QACALRT1",16,0)
 . W ".  No response needed, killing alert.",?63,"***",$C(7)
"RTN","QACALRT1",17,0)
 . D KILLALRT
"RTN","QACALRT1",18,0)
 . Q
"RTN","QACALRT1",19,0)
 ;
"RTN","QACALRT1",20,0)
 I $O(^XTMP(QACXQAID,"TXT",0)) D
"RTN","QACALRT1",21,0)
 . W !!?5,"*** You have an unsent response to this alert. ***",$C(7)
"RTN","QACALRT1",22,0)
 . Q
"RTN","QACALRT1",23,0)
 ;
"RTN","QACALRT1",24,0)
 ; Alert action (Respond / Ignore / Delete / Print)
"RTN","QACALRT1",25,0)
 K DIR S QACACTN=""
"RTN","QACALRT1",26,0)
 F  D  Q:QACACTN]""
"RTN","QACALRT1",27,0)
 . S DIR(0)="SOM^R:Respond;I:Ignore;D:Delete;P:Print"
"RTN","QACALRT1",28,0)
 . S DIR("A")="Alert action"
"RTN","QACALRT1",29,0)
 . S DIR("?",1)="  Enter (R)espond to enter your response to this alert."
"RTN","QACALRT1",30,0)
 . S DIR("?",2)="  Enter (I)gnore to save this alert for a later response."
"RTN","QACALRT1",31,0)
 . S DIR("?",3)="  Enter (D)elete to delete this alert without a response."
"RTN","QACALRT1",32,0)
 . S DIR("?",4)="  Enter (P)rint to print the report of contact."
"RTN","QACALRT1",33,0)
 . S DIR("?")="  Enter one of the codes listed above."
"RTN","QACALRT1",34,0)
 . W ! D ^DIR S QACACTN=$S($D(DIRUT):U,1:Y)
"RTN","QACALRT1",35,0)
 . I QACACTN="P" D
"RTN","QACALRT1",36,0)
 .. S QAC=QACD0,QACRES=0
"RTN","QACALRT1",37,0)
 .. N QACD0,QACX,QACXQAID
"RTN","QACALRT1",38,0)
 .. D EN^QACRPT
"RTN","QACALRT1",39,0)
 .. S QACACTN="",DIR("B")="Ignore"
"RTN","QACALRT1",40,0)
 .. Q
"RTN","QACALRT1",41,0)
 . Q
"RTN","QACALRT1",42,0)
 I (QACACTN="I")!(QACACTN=U) D SAVEALRT
"RTN","QACALRT1",43,0)
 I QACACTN="D" S QACDELET=1 D RESPOND,KILLALRT
"RTN","QACALRT1",44,0)
 I QACACTN="R" D RESPOND
"RTN","QACALRT1",45,0)
 G EXIT
"RTN","QACALRT1",46,0)
 ;
"RTN","QACALRT1",47,0)
RESPOND ; Get user's response
"RTN","QACALRT1",48,0)
 I $O(^XTMP(QACXQAID,"TXT",0))'>0 K ^XTMP(QACXQAID)
"RTN","QACALRT1",49,0)
 K DIC,DIWEPSE,DTOUT,DWLW,DWPK
"RTN","QACALRT1",50,0)
 S ^XTMP(QACXQAID,0)=$$FMADD^XLFDT(DT,14)_U_DT
"RTN","QACALRT1",51,0)
 I $G(QACDELET)<1 D
"RTN","QACALRT1",52,0)
 . S DIC="^XTMP("""_QACXQAID_""",""TXT"","
"RTN","QACALRT1",53,0)
 . D EN^DIWE
"RTN","QACALRT1",54,0)
 I $G(QACDELET)=1 D DELMSG
"RTN","QACALRT1",55,0)
 I $O(^XTMP(QACXQAID,"TXT",0))'>0 K ^XTMP(QACXQAID) D SAVEALRT Q
"RTN","QACALRT1",56,0)
 I $D(DTOUT) D  Q
"RTN","QACALRT1",57,0)
 . W $C(7),!
"RTN","QACALRT1",58,0)
 . W !?5,"***     You have timed out while entering a response.     ***"
"RTN","QACALRT1",59,0)
 . W !?5,"*** The text can be recovered if you re-enter the alert.  ***"
"RTN","QACALRT1",60,0)
 . W !?5,"*** If not, it will be automatically purged in two weeks. ***"
"RTN","QACALRT1",61,0)
 . D SAVEALRT
"RTN","QACALRT1",62,0)
 . Q
"RTN","QACALRT1",63,0)
 S QACX(0)=$P($G(^VA(200,QACX,0)),U) I QACX(0)="" S QACX(0)="UNKNOWN"
"RTN","QACALRT1",64,0)
 S QACHDR="***  "_$$FMTE^XLFDT($$NOW^XLFDT,"2PS")_"  "_QACX(0)_"  ***"
"RTN","QACALRT1",65,0)
 S ^XTMP(QACXQAID,"TXT",.1,0)=""
"RTN","QACALRT1",66,0)
 S ^XTMP(QACXQAID,"TXT",.2,0)=QACHDR
"RTN","QACALRT1",67,0)
 S ^XTMP(QACXQAID,"TXT",.3,0)=""
"RTN","QACALRT1",68,0)
 ; Save user's response
"RTN","QACALRT1",69,0)
 W !!,"Saving your response, please wait . . . "
"RTN","QACALRT1",70,0)
 K ^TMP("QACALRT1",$J)
"RTN","QACALRT1",71,0)
 S %X="^XTMP("""_QACXQAID_""",""TXT"","
"RTN","QACALRT1",72,0)
 S %Y="^TMP(""QACALRT1"",$J,"
"RTN","QACALRT1",73,0)
 D %XY^%RCR
"RTN","QACALRT1",74,0)
 S ZTRTN="TASK^QACALRT1",ZTDESC="Patient Rep resolution comments update"
"RTN","QACALRT1",75,0)
 S (ZTSAVE("QACD0"),ZTSAVE("^TMP(""QACALRT1"",$J,"),ZTIO)="",ZTDTH=$H
"RTN","QACALRT1",76,0)
 S (ZTSAVE("QACX"),ZTSAVE("QACDUZ"))=""
"RTN","QACALRT1",77,0)
 S ZTSAVE("QACDELET")=""
"RTN","QACALRT1",78,0)
 D ^%ZTLOAD
"RTN","QACALRT1",79,0)
 W "Done"
"RTN","QACALRT1",80,0)
KILLALRT ; Kill this alert
"RTN","QACALRT1",81,0)
 K ^XTMP(QACXQAID)
"RTN","QACALRT1",82,0)
 S XQAKILL=1
"RTN","QACALRT1",83,0)
 Q
"RTN","QACALRT1",84,0)
SAVEALRT ; Do not kill this alert
"RTN","QACALRT1",85,0)
 K XQAKILL
"RTN","QACALRT1",86,0)
 Q
"RTN","QACALRT1",87,0)
 ;
"RTN","QACALRT1",88,0)
TASK ; Tasked entry point
"RTN","QACALRT1",89,0)
 F  L +^QA(745.1,QACD0):5 Q:$T  H 5
"RTN","QACALRT1",90,0)
 I $D(^QA(745.1,QACD0,0))[0 L -^QA(745.1,QACD0) G EXIT
"RTN","QACALRT1",91,0)
 S (QACD1,QACD1(0))=0
"RTN","QACALRT1",92,0)
 F  S QACD1=$O(^QA(745.1,QACD0,6,QACD1)) Q:QACD1'>0  S QACD1(0)=QACD1
"RTN","QACALRT1",93,0)
 S (QACTMP,QACOUNT)=0
"RTN","QACALRT1",94,0)
 F  S QACTMP=$O(^TMP("QACALRT1",$J,QACTMP)) Q:QACTMP'>0  D
"RTN","QACALRT1",95,0)
 . S QACOUNT=QACOUNT+1
"RTN","QACALRT1",96,0)
 . S ^QA(745.1,QACD0,6,QACD1(0)+QACOUNT,0)=^TMP("QACALRT1",$J,QACTMP,0)
"RTN","QACALRT1",97,0)
 . Q
"RTN","QACALRT1",98,0)
 S QACOUNT=QACOUNT+1
"RTN","QACALRT1",99,0)
 S ^QA(745.1,QACD0,6,QACD1(0)+QACOUNT,0)=""
"RTN","QACALRT1",100,0)
 S QACOUNT=QACOUNT+1
"RTN","QACALRT1",101,0)
 S ^QA(745.1,QACD0,6,QACD1(0)+QACOUNT,0)="***  End of response  ***"
"RTN","QACALRT1",102,0)
 S QACWPHDR=$G(^QA(745.1,QACD0,6,0))
"RTN","QACALRT1",103,0)
 S $P(QACWPHDR,U,3)=($P(QACWPHDR,U,3)+QACOUNT)
"RTN","QACALRT1",104,0)
 S $P(QACWPHDR,U,4)=($P(QACWPHDR,U,4)+QACOUNT)
"RTN","QACALRT1",105,0)
 S $P(QACWPHDR,U,5)=DT
"RTN","QACALRT1",106,0)
 S ^QA(745.1,QACD0,6,0)=QACWPHDR
"RTN","QACALRT1",107,0)
 L -^QA(745.1,QACD0)
"RTN","QACALRT1",108,0)
 S QACX(0)=$P($G(^VA(200,+QACX,0)),U) S:QACX(0)="" QACX(0)="UNKNOWN"
"RTN","QACALRT1",109,0)
 S QACCASE=$P($G(^QA(745.1,+QACD0,0)),U) S:QACCASE="" QACCASE="UNKNOWN"
"RTN","QACALRT1",110,0)
 S XQA(+QACDUZ)=""
"RTN","QACALRT1",111,0)
 S XQAMSG="Patient Rep response by "_QACX(0)_" to "_QACCASE_"."
"RTN","QACALRT1",112,0)
 I $G(QACDELET)=1 S XQAMSG="Patient Rep Alert "_QACCASE_" deleted by "_QACX(0)_"."
"RTN","QACALRT1",113,0)
 D SETUP^XQALERT
"RTN","QACALRT1",114,0)
 ;D SET^QACALRT0(+QACDUZ,QACD0)
"RTN","QACALRT1",115,0)
EXIT ;
"RTN","QACALRT1",116,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACALRT1",117,0)
 K DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,QAC,QACACTN,QACCASE,QACD0,QACD1
"RTN","QACALRT1",118,0)
 K QACDUZ,QACEE,QACHDR,QACOUNT,QACRES,QACTMP,QACWPHDR,QACX,QACXQAID,X,Y
"RTN","QACALRT1",119,0)
 K ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,^TMP("QACALRT1",$J),%X,%Y
"RTN","QACALRT1",120,0)
 Q
"RTN","QACALRT1",121,0)
DELMSG ;If user deletes an alert on a report of contact a message is sent
"RTN","QACALRT1",122,0)
 ;as if it were a response to the alert.  It will be stored in the 
"RTN","QACALRT1",123,0)
 ;Resolution Comments field.
"RTN","QACALRT1",124,0)
 S $P(^XTMP(QACXQAID,"TXT",0),U,5)=DT
"RTN","QACALRT1",125,0)
 F QACEE=3,4  S $P(^XTMP(QACXQAID,"TXT",0),U,QACEE)=$P(^XTMP(QACXQAID,"TXT",0),U,QACEE)+1
"RTN","QACALRT1",126,0)
 S Y=DT D DD^%DT S QACDATE=Y
"RTN","QACALRT1",127,0)
 S QACNAME=$P($P(^VA(200,QACDUZ,0),U),",",2)_" "_$P($P(^VA(200,QACDUZ,0),U),",")
"RTN","QACALRT1",128,0)
 S ^XTMP(QACXQAID,"TXT",1,0)="VA Alert on Report of Contact "_$P(QACXQAID,"-",2)_" deleted by "_QACNAME_" on "_QACDATE
"RTN","QACALRT1",129,0)
 Q
"RTN","QACALRT2")
0^2^B5816729
"RTN","QACALRT2",1,0)
QACALRT2 ;HISC/DAD-RESEND/KILL ALERT ;7/12/95  15:20
"RTN","QACALRT2",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACALRT2",3,0)
 ;
"RTN","QACALRT2",4,0)
 F  D  Q:QACD0'>0
"RTN","QACALRT2",5,0)
 . K DIC S DIC="^QA(745.1,",DIC(0)="AEMNQZ"
"RTN","QACALRT2",6,0)
 . S DIC("A")="Select CONTACT NUMBER: "
"RTN","QACALRT2",7,0)
 . S DIC("S")="I ($P(^QA(745.1,+Y,7),""^"",2)=""O""),(($D(^XUSEC(""QAC EDIT"",DUZ))#2)!(DUZ=$P(^QA(745.1,+Y,0),U,7)))"
"RTN","QACALRT2",8,0)
 . W ! D ^DIC S QACD0=+Y
"RTN","QACALRT2",9,0)
 . I QACD0'>0 Q
"RTN","QACALRT2",10,0)
 . F  D  Q:QACVA200'>0
"RTN","QACALRT2",11,0)
 .. K DIR S DIR(0)="POA^200:AEMNQZ",DIR("A")="Select REFER CONTACT TO: "
"RTN","QACALRT2",12,0)
 .. S DIR("?")="^D HELP^QACALRT2"
"RTN","QACALRT2",13,0)
 .. W ! D ^DIR S QACVA200=+$G(Y),QACVA200(0)=$G(Y(0,0))
"RTN","QACALRT2",14,0)
 .. I $D(DIRUT) Q
"RTN","QACALRT2",15,0)
 .. D ALERT
"RTN","QACALRT2",16,0)
 .. Q
"RTN","QACALRT2",17,0)
 . Q
"RTN","QACALRT2",18,0)
EXIT ;
"RTN","QACALRT2",19,0)
 K D0,D1,DA,DD,DIC,DIK,DINUM,DIR,DIRUT,DLAYGO,DO,DTOUT,DUOUT,QACACTN
"RTN","QACALRT2",20,0)
 K QACD0,QACD1,QACLINE,QACQUIT,QACREMOV,QACVA200,X,Y
"RTN","QACALRT2",21,0)
 Q
"RTN","QACALRT2",22,0)
 ;
"RTN","QACALRT2",23,0)
ALERT ;
"RTN","QACALRT2",24,0)
 K DIR S DIR(0)="SOM^S:Send alert;K:Kill alert;"
"RTN","QACALRT2",25,0)
 S DIR("A")="Alert action"
"RTN","QACALRT2",26,0)
 S DIR("?",1)="  Enter (S)end to generate a new alert."
"RTN","QACALRT2",27,0)
 S DIR("?",2)="  Enter (K)ill to kill a pre-existing alert."
"RTN","QACALRT2",28,0)
 S DIR("?")="  Enter a code from the list above."
"RTN","QACALRT2",29,0)
 W ! D ^DIR S QACACTN=$G(Y)
"RTN","QACALRT2",30,0)
 I $D(DIRUT) Q
"RTN","QACALRT2",31,0)
 I QACACTN="S" D SET^QACALRT0(QACVA200,QACD0) Q
"RTN","QACALRT2",32,0)
 I QACACTN="K" D KILL^QACALRT0(QACVA200,QACD0) Q
"RTN","QACALRT2",33,0)
HELP ;
"RTN","QACALRT2",34,0)
 W !!,"Entries in the REFER CONTACT TO field:"
"RTN","QACALRT2",35,0)
 I $O(^QA(745.1,QACD0,11,0))'>0 W !?3,"None" Q
"RTN","QACALRT2",36,0)
 S QACD1=0 K ^TMP("QACALRT2",$J)
"RTN","QACALRT2",37,0)
 F  S QACD1=$O(^QA(745.1,QACD0,11,QACD1)) Q:QACD1'>0  D
"RTN","QACALRT2",38,0)
 . S QACVA200=+$P($G(^QA(745.1,QACD0,11,QACD1,0)),U)
"RTN","QACALRT2",39,0)
 . S QACVA200(0)=$P($G(^VA(200,QACVA200,0)),U)
"RTN","QACALRT2",40,0)
 . I QACVA200(0)]"" S ^TMP("QACALRT2",$J,QACVA200)=QACVA200(0)
"RTN","QACALRT2",41,0)
 . Q
"RTN","QACALRT2",42,0)
 S (QACVA200,QACQUIT)=0,QACLINE=$Y
"RTN","QACALRT2",43,0)
 F  S QACVA200=$O(^TMP("QACALRT2",$J,QACVA200)) Q:QACVA200'>0!QACQUIT  D
"RTN","QACALRT2",44,0)
 . W !?3,QACVA200,?19,^TMP("QACALRT2",$J,QACVA200)
"RTN","QACALRT2",45,0)
 . I $Y>(IOSL+QACLINE-3) D
"RTN","QACALRT2",46,0)
 .. W !,"Press RETURN to continue or '^' to exit: "
"RTN","QACALRT2",47,0)
 .. R QACQUIT:DTIME S:'$T QACQUIT=U S QACQUIT=$S($E(QACQUIT)=U:1,1:0)
"RTN","QACALRT2",48,0)
 .. S QACLINE=$Y
"RTN","QACALRT2",49,0)
 .. Q
"RTN","QACALRT2",50,0)
 . Q
"RTN","QACALRT2",51,0)
 K ^TMP("QACALRT2",$J)
"RTN","QACALRT2",52,0)
 Q
"RTN","QACARCH")
0^3^B2312448
"RTN","QACARCH",1,0)
QACARCH ;HISC/CEW - Routine to archive selected records ;1/17/95  11:19
"RTN","QACARCH",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACARCH",3,0)
INFO ;
"RTN","QACARCH",4,0)
 W !!?5,"Using this option does not purge the records archived."
"RTN","QACARCH",5,0)
 W !?5,"At the device prompt, save the output to a file,"
"RTN","QACARCH",6,0)
 W !?5,"capture the output for a word processing package,"
"RTN","QACARCH",7,0)
 W !?5,"or send it to a printer for a hard copy report."
"RTN","QACARCH",8,0)
 ;
"RTN","QACARCH",9,0)
MAIN ;
"RTN","QACARCH",10,0)
 S QAQPOP=0
"RTN","QACARCH",11,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACARCH",12,0)
 K DIC,FLDS,L,BY,FR,TO,DHD
"RTN","QACARCH",13,0)
 S L=0,DIC="^QA(745.1,"
"RTN","QACARCH",14,0)
 S FLDS="1;S2,.01,2,3,22;C1,21,.01;L65,,25;C1",DHD="@@"
"RTN","QACARCH",15,0)
 S DIOBEG="W !!,""Archived Patient Rep Contact Records"",!,QAQ2HED"
"RTN","QACARCH",16,0)
 ;
"RTN","QACARCH",17,0)
 ; report is not by division
"RTN","QACARCH",18,0)
 I +$G(QACDV)'=1 D
"RTN","QACARCH",19,0)
 . S BY="1"
"RTN","QACARCH",20,0)
 . S FR(1)=QAQNBEG,TO(1)=QAQNEND
"RTN","QACARCH",21,0)
 ;
"RTN","QACARCH",22,0)
 ; report is by division
"RTN","QACARCH",23,0)
 I +$G(QACDV)=1 D
"RTN","QACARCH",24,0)
 . S BY="37;S3;C25,1"
"RTN","QACARCH",25,0)
 . S FR(1)="@",TO(1)=""
"RTN","QACARCH",26,0)
 . I +$G(QAC1DIV) D
"RTN","QACARCH",27,0)
 . . S QACDVNAM="" D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACARCH",28,0)
 . . S (FR(1),TO(1))=QACDVNAM
"RTN","QACARCH",29,0)
 . S FR(2)=QAQNBEG,TO(2)=QAQNEND
"RTN","QACARCH",30,0)
 D EN1^DIP
"RTN","QACARCH",31,0)
EXIT ;
"RTN","QACARCH",32,0)
 K DIC,FLDS,L,BY,FR,TO,DHD,DIP,DIOBEG,QACDV,QAC1DIV,QAQPOP,QACDVNAM
"RTN","QACARCH",33,0)
 K QAQNBEG,QAQNEND
"RTN","QACARCH",34,0)
 D K^QAQDATE
"RTN","QACARCH",35,0)
 Q
"RTN","QACBYLOC")
0^21^B20132612
"RTN","QACBYLOC",1,0)
QACBYLOC ;WCIOFO/ERC - Report by Location ;03/23/99
"RTN","QACBYLOC",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACBYLOC",3,0)
 ;
"RTN","QACBYLOC",4,0)
 N QACDV,QACDIV,QAC1DIV,QACDVFLG
"RTN","QACBYLOC",5,0)
 S QACRTN="QACBYLOC"
"RTN","QACBYLOC",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACBYLOC",7,0)
 I QACDV=0!(QACDV']"") S QACDVFLG=1
"RTN","QACBYLOC",8,0)
 ;if just for 1 division, get name of division
"RTN","QACBYLOC",9,0)
 I +$G(QAC1DIV) D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACBYLOC",10,0)
 ;
"RTN","QACBYLOC",11,0)
 S QACDESC="Issue Totals by Location"
"RTN","QACBYLOC",12,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS I POP D EXIT Q
"RTN","QACBYLOC",13,0)
 I $D(IO("Q")) D  Q
"RTN","QACBYLOC",14,0)
 . S ZTDESC=QACDESC
"RTN","QACBYLOC",15,0)
 . S ZTRTN="START^QACBYLOC"
"RTN","QACBYLOC",16,0)
 . S ZTSAVE("QAQRANG")=""
"RTN","QACBYLOC",17,0)
 . S ZTSAVE("QACRTN")=""
"RTN","QACBYLOC",18,0)
 . D TASK^QACUTL0
"RTN","QACBYLOC",19,0)
 ;
"RTN","QACBYLOC",20,0)
START ;
"RTN","QACBYLOC",21,0)
 D SETUP^QACEMPE
"RTN","QACBYLOC",22,0)
 S QACROU="SET^QACBYLOC"
"RTN","QACBYLOC",23,0)
 ;loop through "D" crossreference (date range)
"RTN","QACBYLOC",24,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACBYLOC",25,0)
 D REPORT
"RTN","QACBYLOC",26,0)
 D EXIT
"RTN","QACBYLOC",27,0)
 Q
"RTN","QACBYLOC",28,0)
SET ;set array variables for each ROC in date range
"RTN","QACBYLOC",29,0)
 K QACDATA,QACDIV,QACIC,QACISS,QACLOC
"RTN","QACBYLOC",30,0)
 D ISSLOOP
"RTN","QACBYLOC",31,0)
 I '$D(QACIC) Q
"RTN","QACBYLOC",32,0)
 D GETS^DIQ(745.1,QACD0,"14;37","NIE","QACDATA")
"RTN","QACBYLOC",33,0)
 S QACD0X=QACD0_","
"RTN","QACBYLOC",34,0)
 ;if not integrated, division set to 0 for sorting purposes in ^TMP
"RTN","QACBYLOC",35,0)
 S QACDIV=$S('$G(QACDVFLG):$G(QACDATA(745.1,QACD0X,37,"E"),"Unknown"),1:0)
"RTN","QACBYLOC",36,0)
 S QACLOC=$G(QACDATA(745.1,QACD0X,14,"E"),"Unknown")
"RTN","QACBYLOC",37,0)
 D SETMP
"RTN","QACBYLOC",38,0)
 Q
"RTN","QACBYLOC",39,0)
ISSLOOP ;loop through issue codes for the ROC
"RTN","QACBYLOC",40,0)
 S QACEE=0
"RTN","QACBYLOC",41,0)
 F  S QACEE=$O(^QA(745.1,QACD0,3,QACEE)) Q:QACEE'>0  D
"RTN","QACBYLOC",42,0)
 . S QACIC(QACEE)=^QA(745.1,QACD0,3,QACEE,0)
"RTN","QACBYLOC",43,0)
 Q
"RTN","QACBYLOC",44,0)
SETMP ;set ^TMP global for report
"RTN","QACBYLOC",45,0)
 S QACEE=""
"RTN","QACBYLOC",46,0)
 F  S QACEE=$O(QACIC(QACEE)) Q:QACEE']""  D
"RTN","QACBYLOC",47,0)
 . S QACISS=QACIC(QACEE)
"RTN","QACBYLOC",48,0)
 . D GETS^DIQ(745.2,QACISS,".01;2","E","QACICEXT")
"RTN","QACBYLOC",49,0)
 . S QACISSX=QACISS_","
"RTN","QACBYLOC",50,0)
 . S QACISSC=$G(QACICEXT(745.2,QACISSX,.01,"E"))
"RTN","QACBYLOC",51,0)
 . I $G(QACISSC)']"" Q
"RTN","QACBYLOC",52,0)
 . S QACICHDR=$E($G(QACICEXT(745.2,QACISSX,.01,"E")),1,2)
"RTN","QACBYLOC",53,0)
 . S QACNAME=$G(QACICEXT(745.2,QACISSX,2,"E"))
"RTN","QACBYLOC",54,0)
 . S ^TMP(QACRTN,$J,"ROC",QACDIV,QACLOC,QACICHDR,QACISS)=$G(^TMP(QACRTN,$J,"ROC",QACDIV,QACLOC,QACICHDR,QACISS))+1
"RTN","QACBYLOC",55,0)
 . S ^TMP(QACRTN,$J,"COUNT","TOT")=$G(^TMP(QACRTN,$J,"COUNT","TOT"))+1
"RTN","QACBYLOC",56,0)
 . S ^TMP(QACRTN,$J,"COUNT",QACDIV)=$G(^TMP(QACRTN,$J,"COUNT",QACDIV))+1
"RTN","QACBYLOC",57,0)
 . S ^TMP(QACRTN,$J,"COUNT",QACDIV,QACLOC)=$G(^TMP(QACRTN,$J,"COUNT",QACDIV,QACLOC))+1
"RTN","QACBYLOC",58,0)
 . S QACICHDR=$E($G(QACICEXT(745.2,QACISSX,.01,"E")),1,2)
"RTN","QACBYLOC",59,0)
 . S QACNAME=$G(QACICEXT(745.2,QACISSX,2,"E"))
"RTN","QACBYLOC",60,0)
 . S ^TMP(QACRTN,$J,"ISS",QACISS)=QACISSC_"  "_QACNAME
"RTN","QACBYLOC",61,0)
 . S ^TMP(QACRTN,$J,"COUNT",QACDIV,QACLOC,QACICHDR)=$G(^TMP(QACRTN,$J,"COUNT",QACDIV,QACLOC,QACICHDR))+1
"RTN","QACBYLOC",62,0)
 Q
"RTN","QACBYLOC",63,0)
REPORT ;
"RTN","QACBYLOC",64,0)
 U IO
"RTN","QACBYLOC",65,0)
 S QACAA=""
"RTN","QACBYLOC",66,0)
 F  S QACAA=$O(^TMP(QACRTN,$J,"ROC",QACAA)) Q:QACAA']""  D  Q:QACQUIT
"RTN","QACBYLOC",67,0)
 . S QACBB=""
"RTN","QACBYLOC",68,0)
 . F  S QACBB=$O(^TMP(QACRTN,$J,"ROC",QACAA,QACBB)) Q:QACBB']""  D  Q:QACQUIT
"RTN","QACBYLOC",69,0)
 . . D HEADER Q:QACQUIT
"RTN","QACBYLOC",70,0)
 . . ;if not integrated this next line will not print
"RTN","QACBYLOC",71,0)
 . . I $G(QACAA)'=0 W !?15,"Total Issues for Division: "_QACAA_"    "_^TMP(QACRTN,$J,"COUNT",QACAA)
"RTN","QACBYLOC",72,0)
 . . W !?10,"Total Issues for Location: "_QACBB_"    "_^TMP(QACRTN,$J,"COUNT",QACAA,QACBB)
"RTN","QACBYLOC",73,0)
 . . S QACCC=""
"RTN","QACBYLOC",74,0)
 . . F  S QACCC=$O(^TMP(QACRTN,$J,"ROC",QACAA,QACBB,QACCC)) Q:QACCC']""  D  Q:QACQUIT
"RTN","QACBYLOC",75,0)
 . . . I $Y>(IOSL-6) D HEADER Q:QACQUIT
"RTN","QACBYLOC",76,0)
 . . . W !?5,QACCC_"    "_$P(^QA(745.2,$O(^QA(745.2,"B",QACCC,0)),0),U,3)
"RTN","QACBYLOC",77,0)
 . . . W ?72,^TMP(QACRTN,$J,"COUNT",QACAA,QACBB,QACCC)
"RTN","QACBYLOC",78,0)
 . . . S QACDD=0
"RTN","QACBYLOC",79,0)
 . . . F  S QACDD=$O(^TMP(QACRTN,$J,"ROC",QACAA,QACBB,QACCC,QACDD)) Q:QACDD'>0  D  Q:QACQUIT
"RTN","QACBYLOC",80,0)
 . . . . I $Y>(IOSL-6) D HEADER Q:QACQUIT
"RTN","QACBYLOC",81,0)
 . . . . W !,^TMP(QACRTN,$J,"ISS",QACDD),?72,^TMP(QACRTN,$J,"ROC",QACAA,QACBB,QACCC,QACDD)
"RTN","QACBYLOC",82,0)
 I '$D(^TMP(QACRTN,$J,"ROC")) D
"RTN","QACBYLOC",83,0)
 . D HEADER
"RTN","QACBYLOC",84,0)
 . W !!!?25,"No data to report."
"RTN","QACBYLOC",85,0)
 Q
"RTN","QACBYLOC",86,0)
HEADER ;
"RTN","QACBYLOC",87,0)
 S QACPAGE=$G(QACPAGE)+1
"RTN","QACBYLOC",88,0)
 I QACPAGE>1 D  Q:QACQUIT
"RTN","QACBYLOC",89,0)
 . W $C(7)
"RTN","QACBYLOC",90,0)
 . I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR S QACQUIT=$S(Y'>0:1,1:0)
"RTN","QACBYLOC",91,0)
 W:$E(IOST)="C"!(QACPAGE>1) @IOF
"RTN","QACBYLOC",92,0)
 W !,QACDESC,?48,QACTODAY,?70,"PAGE ",QACPAGE
"RTN","QACBYLOC",93,0)
 W !?(80-$L(QACHDR2))/2,QACHDR2
"RTN","QACBYLOC",94,0)
 W !,"Issue Code",?25,"Issue Code Name",?70,"Total"
"RTN","QACBYLOC",95,0)
 W !,QACUNDL,!
"RTN","QACBYLOC",96,0)
 Q
"RTN","QACBYLOC",97,0)
EXIT ;
"RTN","QACBYLOC",98,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACBYLOC",99,0)
 D K^QAQDATE
"RTN","QACBYLOC",100,0)
 K ^TMP(QACRTN,$J)
"RTN","QACBYLOC",101,0)
 K DIQ,DIR,IOSL,POP
"RTN","QACBYLOC",102,0)
 K QAC1DIV,QACAA,QACBB,QACCC,QACD0,QACD0X,QACDATA,QACDESC,QACDD,QACDIV
"RTN","QACBYLOC",103,0)
 K QACDV,QACDVNAM,QACDVFLG,QACHDR2,QACIC,QACICEXT,QACICHDR
"RTN","QACBYLOC",104,0)
 K QACEE,QACISS,QACISSC,QACISSX,QACLOC,QACNAME
"RTN","QACBYLOC",105,0)
 K QACPAGE,QACQUIT,QACROU,QACRTN,QACTIME,QACTODAY,QACUNDL
"RTN","QACBYLOC",106,0)
 K QAQNBEG,QAQNEND,QAQPOP,QAQRANG
"RTN","QACBYLOC",107,0)
 K X,Y,ZTDESC,ZTRTN,ZTSAVE
"RTN","QACBYLOC",108,0)
 Q
"RTN","QACCSSTD")
0^4^B31980527
"RTN","QACCSSTD",1,0)
QACCSSTD  ;WCIOFO/ERC - Routine for CSS totals ;8/16/97
"RTN","QACCSSTD",2,0)
 ;;2.0;Patient Representative;**3,5,7,9**;07/25/1995
"RTN","QACCSSTD",3,0)
DATE ; Establish date range
"RTN","QACCSSTD",4,0)
 K QACDVTOT
"RTN","QACCSSTD",5,0)
 N QACCSS,QACDC,QACDFLG,QACISS,QACNODIV,QACSFLG,QACSRV,QACSV,QACYES
"RTN","QACCSSTD",6,0)
 S QACRTN="QACCSSTD"
"RTN","QACCSSTD",7,0)
 S QACDESC="Customer Service Standards Totals"
"RTN","QACCSSTD",8,0)
 S QACYES=0
"RTN","QACCSSTD",9,0)
 D DATDIV^QACUTL0 Q:$G(QAQPOP)=1
"RTN","QACCSSTD",10,0)
 I $G(QACDV)=0!($G(QACDV))']"" S QACNODIV=1
"RTN","QACCSSTD",11,0)
 S DIR(0)="YOA"
"RTN","QACCSSTD",12,0)
 S DIR("A")="Do you want to print this report for just one Discipline? "
"RTN","QACCSSTD",13,0)
 S DIR("B")="No"
"RTN","QACCSSTD",14,0)
 S DIR("?")="Enter 'YES' if you prefer to print this report for one specific Discipline."
"RTN","QACCSSTD",15,0)
 D ^DIR Q:$D(DIRUT)  I Y=1 D DISC
"RTN","QACCSSTD",16,0)
 I QACYES=0 D
"RTN","QACCSSTD",17,0)
 . S DIR("A")="Do you want to print this report for just one Service/Discipline? "
"RTN","QACCSSTD",18,0)
 . S DIR("B")="No"
"RTN","QACCSSTD",19,0)
 . S DIR("?")="Enter 'Yes' if you prefer to print this report for one Service/Discipline."
"RTN","QACCSSTD",20,0)
 . D ^DIR Q:$D(DIRUT)
"RTN","QACCSSTD",21,0)
 . I Y=1 D SERV
"RTN","QACCSSTD",22,0)
 Q:$D(DIRUT)
"RTN","QACCSSTD",23,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS G:POP EXIT
"RTN","QACCSSTD",24,0)
 I $D(IO("Q")) D  G EXIT
"RTN","QACCSSTD",25,0)
 . S (ZTSAVE("QACD0"),ZTSAVE("QAISS"),ZTSAVE("QACISSC"))=""
"RTN","QACCSSTD",26,0)
 . S ZTSAVE("QACSTD")=""
"RTN","QACCSSTD",27,0)
 . S (ZTSAVE("QACSFLG"),ZTSAVE("QACDFLG"))=""
"RTN","QACCSSTD",28,0)
 . S (ZTSAVE("QACDIS"),ZTSAVE("QACSVD"))=""
"RTN","QACCSSTD",29,0)
 . S ZTDESC=QACDESC
"RTN","QACCSSTD",30,0)
 . S ZTSAVE("QACCSS")=""
"RTN","QACCSSTD",31,0)
 . S ZTSAVE("QACRTN")=""
"RTN","QACCSSTD",32,0)
 . S ZTSAVE("QAQRANG")=""
"RTN","QACCSSTD",33,0)
 . S ZTSAVE("QACEE")=""
"RTN","QACCSSTD",34,0)
 . S ZTRTN="TSK^QACCSSTD"
"RTN","QACCSSTD",35,0)
 . D TASK^QACUTL0
"RTN","QACCSSTD",36,0)
 . Q
"RTN","QACCSSTD",37,0)
TSK ; Get data for totaling
"RTN","QACCSSTD",38,0)
 U IO
"RTN","QACCSSTD",39,0)
INIT ; set up counters for each CSS, discipline and for the total count
"RTN","QACCSSTD",40,0)
 D SETUP^QACEMPE
"RTN","QACCSSTD",41,0)
 S QACROU="SET^QACCSSTD"
"RTN","QACCSSTD",42,0)
 ;loop through "D" cross-reference (date)
"RTN","QACCSSTD",43,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACCSSTD",44,0)
 D PRINT
"RTN","QACCSSTD",45,0)
 D EXIT
"RTN","QACCSSTD",46,0)
 Q
"RTN","QACCSSTD",47,0)
SET ;
"RTN","QACCSSTD",48,0)
 S QACDDV=$P(^QA(745.1,QACD0,0),U,16)
"RTN","QACCSSTD",49,0)
 D INST^QACUTL0(QACDDV,.QACDDD)
"RTN","QACCSSTD",50,0)
 I $G(QAC1DIV)]"" I $G(QAC1DIV)'=$G(QACDDV) Q
"RTN","QACCSSTD",51,0)
 S QACDDV=QACDDD
"RTN","QACCSSTD",52,0)
 ;if not integrated division set to 0 for sorting purposes in ^TMP
"RTN","QACCSSTD",53,0)
 S QACDDV=$S($G(QACNODIV)'=1:$G(QACDDV,"Unknown"),1:0)
"RTN","QACCSSTD",54,0)
 ;loops through the issue code multiple
"RTN","QACCSSTD",55,0)
 K QACIC
"RTN","QACCSSTD",56,0)
 D ISSLOOP^QACBYLOC
"RTN","QACCSSTD",57,0)
 I '$D(QACIC) Q
"RTN","QACCSSTD",58,0)
 S QACAA=0
"RTN","QACCSSTD",59,0)
 F  S QACAA=$O(QACIC(QACAA)) Q:QACAA'>0  D
"RTN","QACCSSTD",60,0)
 . Q:'$D(^QA(745.2,QACIC(QACAA),0))
"RTN","QACCSSTD",61,0)
 . S QACCSS=$P(^QA(745.2,QACIC(QACAA),0),U,7) Q:QACCSS']""
"RTN","QACCSSTD",62,0)
 . S QACCSS=$P(^QA(745.6,QACCSS,0),U,2)
"RTN","QACCSSTD",63,0)
 . S QACBB=0,QACQUT=""
"RTN","QACCSSTD",64,0)
 . F  S QACBB=$O(^QA(745.1,QACD0,3,QACAA,3,QACBB)) Q:(QACBB'>0)&(QACBB]"")  Q:$G(QACQUT)  D
"RTN","QACCSSTD",65,0)
 . . I $G(QACBB)'>0 I ($G(QACDFLG)=1!$G(QACSFLG)=1) S QACQUT=1 Q
"RTN","QACCSSTD",66,0)
 . . I $G(QACBB)'>0 S (QACSVD,QACDIS)="Unknown",QACQUT=1 G COUNT
"RTN","QACCSSTD",67,0)
 . . S QACNODE=^QA(745.1,QACD0,3,QACAA,3,QACBB,0)
"RTN","QACCSSTD",68,0)
 . . S QACSVD=$P(^QA(745.55,$P(QACNODE,U),0),U) Q:$G(QACSVD)']""
"RTN","QACCSSTD",69,0)
 . . I $G(QACSFLG)=1 I $G(QACSRV)'=$P(QACNODE,U) Q
"RTN","QACCSSTD",70,0)
 . . S QACDIS=$P(^QA(745.5,$P(QACNODE,U,2),0),U,2) Q:$G(QACDIS)']""
"RTN","QACCSSTD",71,0)
 . . I $G(QACDFLG)=1 I $G(QACDISC)'=$P(^QA(745.5,$P(QACNODE,U,2),0),U) Q
"RTN","QACCSSTD",72,0)
 . . ;S QACCSS=$P(^QA(745.2,QACIC(QACAA),0),U,7) Q:QACCSS']""
"RTN","QACCSSTD",73,0)
 . . ;S QACCSS=$P(^QA(745.6,QACCSS,0),U,2)
"RTN","QACCSSTD",74,0)
COUNT . . S QACTOT=$G(QACTOT)+1
"RTN","QACCSSTD",75,0)
 . . I $G(QACDDV)]"" S QACDVTOT(QACDDV)=$G(QACDVTOT(QACDDV))+1
"RTN","QACCSSTD",76,0)
 . . S ^TMP(QACRTN,$J,QACDDV,QACSVD,QACDIS,QACCSS)=$G(^TMP(QACRTN,$J,QACDDV,QACSVD,QACDIS,QACCSS))+1
"RTN","QACCSSTD",77,0)
 . . S ^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD)=$G(^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD))+1
"RTN","QACCSSTD",78,0)
 . .S ^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD,QACDIS)=$G(^TMP(QACRTN,$J,"COUNT",QACDDV,QACSVD,QACDIS))+1
"RTN","QACCSSTD",79,0)
 Q
"RTN","QACCSSTD",80,0)
PRINT ;
"RTN","QACCSSTD",81,0)
 U IO
"RTN","QACCSSTD",82,0)
 S QACEE=""
"RTN","QACCSSTD",83,0)
 F  S QACEE=$O(^TMP(QACRTN,$J,QACEE)) Q:QACEE']""  D  Q:QACQUIT
"RTN","QACCSSTD",84,0)
 . I QACEE="COUNT" Q
"RTN","QACCSSTD",85,0)
 . S QACFF=""
"RTN","QACCSSTD",86,0)
 . F  S QACFF=$O(^TMP(QACRTN,$J,QACEE,QACFF)) Q:QACFF']""  D  Q:QACQUIT
"RTN","QACCSSTD",87,0)
 . . D HEAD
"RTN","QACCSSTD",88,0)
 . . I $G(QACEE)'=0 W !?5,"Total for Division: "_QACEE_"    "_QACDVTOT(QACEE)
"RTN","QACCSSTD",89,0)
 . . I $G(QACFF)'=0 W !?5,"Total for Service/Discipline: "_QACFF_"    "_^TMP(QACRTN,$J,"COUNT",QACEE,QACFF)
"RTN","QACCSSTD",90,0)
 . . S QACGG=""
"RTN","QACCSSTD",91,0)
 . . F  S QACGG=$O(^TMP(QACRTN,$J,QACEE,QACFF,QACGG)) Q:QACGG']""  D  Q:QACQUIT
"RTN","QACCSSTD",92,0)
 . . . I $G(QACGG)'=0 W !?5,"Total for Discipline: "_QACGG_"    "_^TMP(QACRTN,$J,"COUNT",QACEE,QACFF,QACGG),!
"RTN","QACCSSTD",93,0)
 . . . S QACHH=""
"RTN","QACCSSTD",94,0)
 . . . F  S QACHH=$O(^TMP(QACRTN,$J,QACEE,QACFF,QACGG,QACHH)) Q:QACHH']""  D  Q:QACQUIT
"RTN","QACCSSTD",95,0)
 . . . . I $Y>(IOSL-6) D HEAD Q:QACQUIT
"RTN","QACCSSTD",96,0)
 . . . . W !?10,QACHH,?50,^TMP(QACRTN,$J,QACEE,QACFF,QACGG,QACHH)
"RTN","QACCSSTD",97,0)
 I '$D(^TMP(QACRTN,$J)) D
"RTN","QACCSSTD",98,0)
 . D HEAD
"RTN","QACCSSTD",99,0)
 . W !!!?25,"No data to report."
"RTN","QACCSSTD",100,0)
 Q
"RTN","QACCSSTD",101,0)
HEAD ;
"RTN","QACCSSTD",102,0)
 S QACPAGE=$G(QACPAGE)+1
"RTN","QACCSSTD",103,0)
 I QACPAGE>1 D  Q:QACQUIT
"RTN","QACCSSTD",104,0)
 . W $C(7)
"RTN","QACCSSTD",105,0)
 . I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR S QACQUIT=$S(Y'>0:1,1:0)
"RTN","QACCSSTD",106,0)
 W:$E(IOST)="C"!(QACPAGE>1) @IOF
"RTN","QACCSSTD",107,0)
 W !,QACDESC,?48,QACTODAY,?70,"PAGE ",QACPAGE
"RTN","QACCSSTD",108,0)
 W !!?51,"NUMBER OF"
"RTN","QACCSSTD",109,0)
 W !?10,"CUSTOMER SERVICE STANDARD",?50,"OCCURRENCES"
"RTN","QACCSSTD",110,0)
 W !,QACUNDL,!
"RTN","QACCSSTD",111,0)
 Q
"RTN","QACCSSTD",112,0)
EXIT ;
"RTN","QACCSSTD",113,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACCSSTD",114,0)
 K ^TMP(QACRTN,$J)
"RTN","QACCSSTD",115,0)
 K QAC1DIV,QACIC,QACCSS,QACDESC,QACDDD,QACDDV,QACDFLG,QACDV
"RTN","QACCSSTD",116,0)
 K QACDVTOT,QACDIS,QACDISC,QACD0,QACNODE,QACPAGE,QACQUIT,QACQUT
"RTN","QACCSSTD",117,0)
 K QACROU,QACRTN,QACSFLG,QACSVD,QACTODAY,QACTOT,QACUNDL
"RTN","QACCSSTD",118,0)
 K QACAA,QACBB,QACDD,QACEE,QACFF,QACGG,QACHH
"RTN","QACCSSTD",119,0)
 K QAQNBEG,QAQNEND,QAQPOP
"RTN","QACCSSTD",120,0)
 K DIR,DIRUT,POP,ZTSAVE,ZTDESC,ZTRTN
"RTN","QACCSSTD",121,0)
 D K^QAQDATE
"RTN","QACCSSTD",122,0)
 Q
"RTN","QACCSSTD",123,0)
DISC ; Select one discipline for this report
"RTN","QACCSSTD",124,0)
 K DIR
"RTN","QACCSSTD",125,0)
 S DIR(0)="FAO^^K:X'?2U X"
"RTN","QACCSSTD",126,0)
 S DIR("A")="Enter the Discipline as a two letter abbreviation: "
"RTN","QACCSSTD",127,0)
 D ^DIR K DIR Q:$D(DIRUT)!($D(DIROUT))
"RTN","QACCSSTD",128,0)
 I $O(^QA(745.5,"B",Y,0)) S QACDISC=Y,QACDFLG=1,QACYES=1
"RTN","QACCSSTD",129,0)
 E  D  G DISC
"RTN","QACCSSTD",130,0)
 . W !!,"Not a valid Discipline, choose from:"
"RTN","QACCSSTD",131,0)
 . S QACEE=0
"RTN","QACCSSTD",132,0)
 . F  S QACEE=$O(^QA(745.5,QACEE)) Q:QACEE'>0  D
"RTN","QACCSSTD",133,0)
 . . W !?5,$P(^QA(745.5,QACEE,0),U),"   (",$P(^QA(745.5,QACEE,0),U,2),")"
"RTN","QACCSSTD",134,0)
 Q
"RTN","QACCSSTD",135,0)
SERV ; Select one Service/Discipline for this report
"RTN","QACCSSTD",136,0)
 K DIR
"RTN","QACCSSTD",137,0)
 S DIR(0)="POA^745.55:EMZ"
"RTN","QACCSSTD",138,0)
 S DIR("A")="Enter the Service/Discipline: "
"RTN","QACCSSTD",139,0)
 D ^DIR K DIR Q:$D(DIRUT)!($D(DIROUT))
"RTN","QACCSSTD",140,0)
 I $G(^QA(745.55,+Y,0))]"" S QACSRV=+Y,QACSFLG=1
"RTN","QACCSSTD",141,0)
 E  D  G SERV
"RTN","QACCSSTD",142,0)
 . W !!,"Not a valid service/discipline.  Try again."
"RTN","QACCSSTD",143,0)
 Q 
"RTN","QACDAILY")
0^5^B1169256
"RTN","QACDAILY",1,0)
QACDAILY ;HISC/CEW - Daily Contact Tracking Report ;1/31/95  09:44
"RTN","QACDAILY",2,0)
 ;;2.0;Patient Representative;**3,9**;07/25/1995
"RTN","QACDAILY",3,0)
DATE ;
"RTN","QACDAILY",4,0)
 S QAQPOP=0
"RTN","QACDAILY",5,0)
 D DATE^QACUTL0 Q:QAQPOP
"RTN","QACDAILY",6,0)
 K DIC,FLDS,L,BY,FR,TO
"RTN","QACDAILY",7,0)
 N QACDIV
"RTN","QACDAILY",8,0)
 ;S L=0,DIC="^QA(745.1,",DHD="[QAC DAILY HEADER]"
"RTN","QACDAILY",9,0)
 S FLDS="[QAC DAILY]"
"RTN","QACDAILY",10,0)
 S QACDIV=$P($G(^QA(740,1,"QAC")),U,3)
"RTN","QACDAILY",11,0)
 I $G(QACDIV)'=1 D
"RTN","QACDAILY",12,0)
 . S BY="1;C30;"""""
"RTN","QACDAILY",13,0)
 . S FR=QAQNBEG,TO=QAQNEND
"RTN","QACDAILY",14,0)
 I $G(QACDIV)=1 D
"RTN","QACDAILY",15,0)
 . D DIV^QACUTL0 Q:$G(QAQPOP)=1
"RTN","QACDAILY",16,0)
 . S BY="37;S2;C1,1;C30;S;"""""
"RTN","QACDAILY",17,0)
 . S FR(2)=QAQNBEG
"RTN","QACDAILY",18,0)
 . S TO(2)=QAQNEND
"RTN","QACDAILY",19,0)
 . I $G(QAC1DIV)>1 D
"RTN","QACDAILY",20,0)
 . . D INST^QACUTL0(QAC1DIV,.QACDV)
"RTN","QACDAILY",21,0)
 . . S (FR(1),TO(1))=$G(QACDV)
"RTN","QACDAILY",22,0)
 . I $G(QAC1DIV)'>1 D
"RTN","QACDAILY",23,0)
 . . S FR(1)="@"
"RTN","QACDAILY",24,0)
 . . S TO(1)=""
"RTN","QACDAILY",25,0)
 Q:$G(QAQPOP)=1
"RTN","QACDAILY",26,0)
 S L=0,DIC="^QA(745.1,",DHD="[QAC DAILY HEADER]"
"RTN","QACDAILY",27,0)
 D EN1^DIP
"RTN","QACDAILY",28,0)
EXIT ;
"RTN","QACDAILY",29,0)
 K DHD,BY,FLDS,FR,TO,DIP,DIC,L
"RTN","QACDAILY",30,0)
 K QAC1DIV,QACDV
"RTN","QACDAILY",31,0)
 K QAQNBEG,QAQNEND,QAQPOP
"RTN","QACDAILY",32,0)
 D K^QAQDATE
"RTN","QACDAILY",33,0)
 Q
"RTN","QACDISC")
0^6^B48610907
"RTN","QACDISC",1,0)
QACDISC ;WCIOFO/ERC - Report of Discipline Contacts ;8/15/97
"RTN","QACDISC",2,0)
 ;;2.0;Patient Representative;**3,5,6,9**;07/25/1995
"RTN","QACDISC",3,0)
DATE ;
"RTN","QACDISC",4,0)
 N QACFLG S QACFLG=0
"RTN","QACDISC",5,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACDISC",6,0)
 S QACTEXT="Discipline "
"RTN","QACDISC",7,0)
 S DIC="^QA(745.5,"
"RTN","QACDISC",8,0)
 D DIR(QACTEXT,DIC,.Y)
"RTN","QACDISC",9,0)
 I $G(QACFLG)=1 S QACDSC=$P(^QA(745.5,+Y,0),U,2),QACDSP=+Y
"RTN","QACDISC",10,0)
 I $G(QACDSC)]"" S QACDSC=$TR(QACDSC,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","QACDISC",11,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS G:POP EXIT
"RTN","QACDISC",12,0)
 I $D(IO("Q")) D  G EXIT
"RTN","QACDISC",13,0)
 . S ZTDESC="Patient Rep "_QACTEXT_"Report"
"RTN","QACDISC",14,0)
 . S ZTSAVE("QASDIS")="",ZTSAVE("QACDSC")=""
"RTN","QACDISC",15,0)
 . S (ZTSAVE("QACSRPT0"),ZTSAVE("QACSRPT1"),ZTSAVE("QACSRPT2"))=""
"RTN","QACDISC",16,0)
 . S (ZTSAVE("QACPIECE"),ZTSAVE("QACSUB"))=""
"RTN","QACDISC",17,0)
 . S ZTRTN="TSK^QACDISC"
"RTN","QACDISC",18,0)
 . D TASK^QACUTL0
"RTN","QACDISC",19,0)
 . Q
"RTN","QACDISC",20,0)
TSK ;
"RTN","QACDISC",21,0)
 S QACPIECE=2
"RTN","QACDISC",22,0)
 S QACSUB=1
"RTN","QACDISC",23,0)
 D TSK1(QACPIECE,QACSUB)
"RTN","QACDISC",24,0)
 Q
"RTN","QACDISC",25,0)
TSK1(QACPIECE,QACSUB) ;
"RTN","QACDISC",26,0)
 K ^TMP("QACSRPT0",$J),^TMP("QACSRPT1",$J),^TMP("QACSRPT2",$J)
"RTN","QACDISC",27,0)
 I '$D(QAC1DIV) S (^TMP("QACSRPT0",$J),^TMP("QACSRPT1",$J),^TMP("QACSRPT2",$J))=0
"RTN","QACDISC",28,0)
 I $D(QAC1DIV) I $G(QAC1DIV)]"" S (^TMP("QACSRPT0",$J,QAC1DIV),^TMP("QACSRPT1",$J,QAC1DIV),^TMP("QACSRPT2",$J,QAC1DIV))=0
"RTN","QACDISC",29,0)
 I $D(QAC1DIV) I $G(QAC1DIV)']"" D
"RTN","QACDISC",30,0)
 . S QACDIV(0)=0
"RTN","QACDISC",31,0)
 . S (^TMP("QACSRPT0",$J,QACDIV(0)),^TMP("QACSRPT1",$J,QACDIV(0)),^TMP("QACSRPT2",$J,QACDIV(0)))=0
"RTN","QACDISC",32,0)
 . S QACEE=0
"RTN","QACDISC",33,0)
 . F  S QACEE=$O(^QA(740,1,"QAC2",QACEE)) Q:QACEE'>0  D
"RTN","QACDISC",34,0)
 . . S QACDIV(QACEE)=^QA(740,1,"QAC2",QACEE,0)
"RTN","QACDISC",35,0)
 . . S (^TMP("QACSRPT0",$J,QACDIV(QACEE)),^TMP("QACSRPT1",$J,QACDIV(QACEE)),^TMP("QACSRPT2",$J,QACDIV(QACEE)))=0
"RTN","QACDISC",36,0)
 U IO
"RTN","QACDISC",37,0)
 K QACDT,QACD0,QACCN,QACDIEN,QACCIEN,QACINM,QACHDNM,QACHDIEN
"RTN","QACDISC",38,0)
 S QACDT=QAQNBEG-.0000001 F  S QACDT=$O(^QA(745.1,"D",QACDT)) Q:(QACDT'>0)!(QACDT>QAQNEND)!(QACDT\1'?7N)  D
"RTN","QACDISC",39,0)
 . S QACD0=0 F  S QACD0=$O(^QA(745.1,"D",QACDT,QACD0)) Q:QACD0'>0  D
"RTN","QACDISC",40,0)
 . . S QACDIV=$P(^QA(745.1,QACD0,0),U,16)
"RTN","QACDISC",41,0)
 . . I $G(QACDIV)']"" S QACDIV=0
"RTN","QACDISC",42,0)
 . . I $G(QAC1DIV)]"" Q:$G(QAC1DIV)'=$G(QACDIV)
"RTN","QACDISC",43,0)
 . . S QACCN=0 F  S QACCN=$O(^QA(745.1,QACD0,3,QACCN)) Q:QACCN'>0  D
"RTN","QACDISC",44,0)
 . . . S QACDN=0 F  S QACDN=$O(^QA(745.1,QACD0,3,QACCN,3,QACDN)) Q:QACDN'>0  D
"RTN","QACDISC",45,0)
 . . . . S QACDIEN=$P($G(^QA(745.1,QACD0,3,QACCN,3,QACDN,0)),U,QACPIECE) Q:QACDIEN=""
"RTN","QACDISC",46,0)
 . . . . I $G(QACFLG)=1 I $G(QACDSP)'=QACDIEN Q
"RTN","QACDISC",47,0)
 . . . . I QACSUB=1 S QACDIS=$$EN7^QACUTIL(QACDIEN)
"RTN","QACDISC",48,0)
 . . . . I QACSUB=2 S QACDIS=$$EN8^QACUTIL(QACDIEN)
"RTN","QACDISC",49,0)
 . . . . S QACDIS=$TR(QACDIS,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","QACDISC",50,0)
 . . . . S QACCIEN=$P($G(^QA(745.1,QACD0,3,QACCN,0)),U,1) Q:QACCIEN=""
"RTN","QACDISC",51,0)
 . . . . S QACICODE=$P($G(^QA(745.2,QACCIEN,0)),U,1) Q:QACICODE=""
"RTN","QACDISC",52,0)
 . . . . I $E(QACICODE,1,2)?2A S QACHD=$E(QACICODE,1,2)
"RTN","QACDISC",53,0)
 . . . . E  S QACHD=$E(QACICODE,1)
"RTN","QACDISC",54,0)
 . . . . S QACHDIEN=0 F  S QACHDIEN=$O(^QA(745.2,"B",QACHD,QACHDIEN)) Q:QACHDIEN'>0  D SET
"RTN","QACDISC",55,0)
 . . . . Q
"RTN","QACDISC",56,0)
 . . . Q
"RTN","QACDISC",57,0)
 . . Q
"RTN","QACDISC",58,0)
 . Q
"RTN","QACDISC",59,0)
PRINT ;
"RTN","QACDISC",60,0)
 ;This is the header information on each page and the data by service.
"RTN","QACDISC",61,0)
 K QACUNDL S $P(QACUNDL,"-",81)="",QACQUIT=0,QACPG=1
"RTN","QACDISC",62,0)
 I $O(^TMP("QACSRPT0",$J,""))="" S QACDSC="" D HEAD W !!,"No data found for the date range selected!" Q
"RTN","QACDISC",63,0)
 K QACDIS,QACHDIEN,QACHD,QACCIEN,QACICODE,QACSTOT,QACCTOT,QACHDTOT
"RTN","QACDISC",64,0)
 I '$D(QAC1DIV) D
"RTN","QACDISC",65,0)
 . I $G(QACFLG)<1 D PRT2 Q
"RTN","QACDISC",66,0)
 . D PRT3
"RTN","QACDISC",67,0)
 I $D(QAC1DIV) D PRT1
"RTN","QACDISC",68,0)
 D ^%ZISC
"RTN","QACDISC",69,0)
 D EXIT
"RTN","QACDISC",70,0)
 Q
"RTN","QACDISC",71,0)
PRT1 ;print report for all disciplines for integrated sites
"RTN","QACDISC",72,0)
 S QACDD=""
"RTN","QACDISC",73,0)
 F  S QACDD=$O(^TMP("QACSRPT0",$J,QACDD)) Q:(QACDD']"")!(QACQUIT)  D 
"RTN","QACDISC",74,0)
 . S QACDSC=""
"RTN","QACDISC",75,0)
 . F  S QACDSC=$O(^TMP("QACSRPT0",$J,QACDD,QACDSC)) Q:(QACDSC']"")!($G(QACQUIT))  D PRT4
"RTN","QACDISC",76,0)
 Q
"RTN","QACDISC",77,0)
PRT2 ;print report for all disciplines
"RTN","QACDISC",78,0)
 S QACDSC="" F  S QACDSC=$O(^TMP("QACSRPT0",$J,QACDSC)) Q:(QACDSC="")!(QACQUIT)  D PRT3
"RTN","QACDISC",79,0)
 D ^%ZISC
"RTN","QACDISC",80,0)
 Q
"RTN","QACDISC",81,0)
PRT3 ;print the report for each discipline
"RTN","QACDISC",82,0)
 S QACSTOT=$P($G(^TMP("QACSRPT0",$J,QACDSC)),U,1) Q:QACSTOT=""
"RTN","QACDISC",83,0)
 D HEAD
"RTN","QACDISC",84,0)
 W !!?15,"Total Issues for ",QACDSC," = ",QACSTOT
"RTN","QACDISC",85,0)
 S QACHD="" F  S QACHD=$O(^TMP("QACSRPT1",$J,QACDSC,QACHD)) Q:(QACHD="")!(QACQUIT)  D
"RTN","QACDISC",86,0)
 . S QACHDIEN=$P(QACHD,"^",2)
"RTN","QACDISC",87,0)
 . S QACHDNM=$$EN6^QACUTIL(QACHDIEN)
"RTN","QACDISC",88,0)
 . S QACHDTOT=$G(^TMP("QACSRPT1",$J,QACDSC,QACHD)) Q:(QACHDTOT="")!(QACQUIT)
"RTN","QACDISC",89,0)
 . W !!?5,QACHDNM,?77,QACHDTOT
"RTN","QACDISC",90,0)
 . S QACICODE="" F  S QACICODE=$O(^TMP("QACSRPT2",$J,QACDSC,QACHD,QACICODE)) Q:(QACICODE="")!(QACQUIT)  D
"RTN","QACDISC",91,0)
 . . S QACCIEN=$P(QACICODE,"^",2)
"RTN","QACDISC",92,0)
 . . S QACCNM=$$EN5^QACUTIL(QACCIEN)
"RTN","QACDISC",93,0)
 . . S QACCTOT=$G(^TMP("QACSRPT2",$J,QACDSC,QACHD,QACICODE)) Q:(QACCTOT="")!(QACQUIT)
"RTN","QACDISC",94,0)
 . . W !,QACCNM,?77,QACCTOT
"RTN","QACDISC",95,0)
 . . I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE Q:QACQUIT  D HEAD
"RTN","QACDISC",96,0)
 . . Q
"RTN","QACDISC",97,0)
 . Q
"RTN","QACDISC",98,0)
 W ! D PAUSE
"RTN","QACDISC",99,0)
 Q
"RTN","QACDISC",100,0)
PRT4 ;print report for each discipline for integrated sites
"RTN","QACDISC",101,0)
 S QACSTOT=$G(^TMP("QACSRPT0",$J,QACDD,QACDSC)) Q:QACSTOT=""
"RTN","QACDISC",102,0)
 D HEAD
"RTN","QACDISC",103,0)
 I $G(QACDD)=0 S QACDV="Unknown"
"RTN","QACDISC",104,0)
 I $G(QACDD)>0 D INST^QACUTL0(QACDD,.QACDV)
"RTN","QACDISC",105,0)
 W !!?25,"Issues for Division: ",QACDV
"RTN","QACDISC",106,0)
 W !?15,"Total Issues for ",QACDSC," = ",QACSTOT
"RTN","QACDISC",107,0)
 S QACHD="" F  S QACHD=$O(^TMP("QACSRPT1",$J,QACDD,QACDSC,QACHD)) Q:(QACHD="")!(QACQUIT)  D
"RTN","QACDISC",108,0)
 . S QACHDIEN=$P(QACHD,"^",2)
"RTN","QACDISC",109,0)
 . S QACHDNM=$$EN6^QACUTIL(QACHDIEN)
"RTN","QACDISC",110,0)
 . S QACHDTOT=$G(^TMP("QACSRPT1",$J,QACDD,QACDSC,QACHD)) Q:(QACHDTOT="")!(QACQUIT)
"RTN","QACDISC",111,0)
 . W !!?5,QACHDNM,?77,QACHDTOT
"RTN","QACDISC",112,0)
 . S QACICODE="" F  S QACICODE=$O(^TMP("QACSRPT2",$J,QACDD,QACDSC,QACHD,QACICODE)) Q:(QACICODE="")!(QACQUIT)  D
"RTN","QACDISC",113,0)
 . . S QACCIEN=$P(QACICODE,"^",2)
"RTN","QACDISC",114,0)
 . . S QACCNM=$$EN5^QACUTIL(QACCIEN)
"RTN","QACDISC",115,0)
 . . S QACCTOT=$P($G(^TMP("QACSRPT2",$J,QACDD,QACDSC,QACHD,QACICODE)),U,1) Q:(QACCTOT="")!(QACQUIT)
"RTN","QACDISC",116,0)
 . . W !,QACCNM,?77,QACCTOT
"RTN","QACDISC",117,0)
 . . I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE Q:QACQUIT  D HEAD
"RTN","QACDISC",118,0)
 . . Q
"RTN","QACDISC",119,0)
 . Q
"RTN","QACDISC",120,0)
 W ! D PAUSE
"RTN","QACDISC",121,0)
 Q
"RTN","QACDISC",122,0)
EXIT ;
"RTN","QACDISC",123,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACDISC",124,0)
 K DIR,DIROUT,DIRUT,DTOUT
"RTN","QACDISC",125,0)
 K IOP,POP,%ZIS,ZTSAVE,ZTDESC,ZTRTN,ZTSK
"RTN","QACDISC",126,0)
 K QAC1DIV,QACCIEN,QACCN,QACCTOT,QACD0,QACDT,QACICODE,QACDIEN,QACDIS
"RTN","QACDISC",127,0)
 K QACDIV,QACDSC,QACDSP,QACDV,QACGDREC,QACHD
"RTN","QACDISC",128,0)
 K QACHEAD,QACHDIEN,QACHDNM,QACHDTOT,QACINAME,QACCNM,QACDN
"RTN","QACDISC",129,0)
 K QACPG,QACQUIT,QACRED,QACHTOT,QACTOT,QACUNDL
"RTN","QACDISC",130,0)
 K ^TMP("QACSRPT0",$J),^TMP("QACSRPT1",$J),^TMP("QACSRPT2",$J)
"RTN","QACDISC",131,0)
 K QACDD,QACEE
"RTN","QACDISC",132,0)
 K QAQ2HED,QAQNBEG,QAQNEND,QAQPOP
"RTN","QACDISC",133,0)
 D K^QAQDATE
"RTN","QACDISC",134,0)
 Q
"RTN","QACDISC",135,0)
HEAD ;
"RTN","QACDISC",136,0)
 W:($E(IOST)="C")!(QACPG>1) @IOF
"RTN","QACDISC",137,0)
 W !,QACTEXT_"Issue Report for ",QACDSC S Y=DT D DD^%DT W ?60,"Date: ",Y,!
"RTN","QACDISC",138,0)
 W QAQ2HED,?60,"Page: ",QACPG
"RTN","QACDISC",139,0)
 W !,QACUNDL,! S QACPG=QACPG+1
"RTN","QACDISC",140,0)
 Q
"RTN","QACDISC",141,0)
PAUSE ;
"RTN","QACDISC",142,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR S QACQUIT=$S(Y'>0:1,1:0)
"RTN","QACDISC",143,0)
 Q
"RTN","QACDISC",144,0)
SET ;Counts the records.
"RTN","QACDISC",145,0)
 I '$D(QAC1DIV) D
"RTN","QACDISC",146,0)
 . S ^TMP("QACSRPT0",$J,QACDIS)=$G(^TMP("QACSRPT0",$J,QACDIS))+1
"RTN","QACDISC",147,0)
 . S ^TMP("QACSRPT1",$J,QACDIS,QACHD_"^"_QACHDIEN)=$G(^TMP("QACSRPT1",$J,QACDIS,QACHD_"^"_QACHDIEN))+1
"RTN","QACDISC",148,0)
 . S ^TMP("QACSRPT2",$J,QACDIS,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN)=$G(^TMP("QACSRPT2",$J,QACDIS,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN))+1
"RTN","QACDISC",149,0)
 . Q
"RTN","QACDISC",150,0)
 I $D(QAC1DIV) D
"RTN","QACDISC",151,0)
 . S ^TMP("QACSRPT0",$J,QACDIV,QACDIS)=$G(^TMP("QACSRPT0",$J,QACDIV,QACDIS))+1
"RTN","QACDISC",152,0)
 . S ^TMP("QACSRPT1",$J,QACDIV,QACDIS,QACHD_"^"_QACHDIEN)=$G(^TMP("QACSRPT1",$J,QACDIV,QACDIS,QACHD_"^"_QACHDIEN))+1
"RTN","QACDISC",153,0)
 . S ^TMP("QACSRPT2",$J,QACDIV,QACDIS,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN)=$G(^TMP("QACSRPT2",$J,QACDIV,QACDIS,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN))+1
"RTN","QACDISC",154,0)
 . Q
"RTN","QACDISC",155,0)
 Q
"RTN","QACDISC",156,0)
DIR(QACTEXT,DIC,Y) ;
"RTN","QACDISC",157,0)
 S DIR(0)="YOA"
"RTN","QACDISC",158,0)
 S DIR("A")="Would you like this report for one "_QACTEXT_"only? "
"RTN","QACDISC",159,0)
 S DIR("B")="NO"
"RTN","QACDISC",160,0)
 S DIR("?")="Enter 'Y' if you want only one "_QACTEXT_"."
"RTN","QACDISC",161,0)
 D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) K DTOUT,DUOUT G DATE
"RTN","QACDISC",162,0)
 I Y=1 S QACFLG=1
"RTN","QACDISC",163,0)
 I $G(QACFLG)=1 S DIC(0)="AEMNZQ" D ^DIC K DIC Q:+Y<1  ; S QACDSC=$P(^QA(745.5,+Y,0),U,2)
"RTN","QACDISC",164,0)
 Q
"RTN","QACDISPC")
0^7^B1270819
"RTN","QACDISPC",1,0)
QACDISPC ;WCIOFO/VAD-Discipline Contact Totals ;12/08/98
"RTN","QACDISPC",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACDISPC",3,0)
 ;
"RTN","QACDISPC",4,0)
MAIN ;
"RTN","QACDISPC",5,0)
 S QAQPOP=0
"RTN","QACDISPC",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACDISPC",7,0)
 K DIC,FLDS,L,BY,FR,TO,DHD
"RTN","QACDISPC",8,0)
 S L=0,DIC="^QA(745.1,"
"RTN","QACDISPC",9,0)
 S FLDS="[QAC DISC RPT]",DHD="[QAC DISC RPT HEADER]"
"RTN","QACDISPC",10,0)
 ;
"RTN","QACDISPC",11,0)
 ; report is not by division
"RTN","QACDISPC",12,0)
 I +$G(QACDV)'=1 D
"RTN","QACDISPC",13,0)
 . S BY="'1,21,3,+1:,1;S;""DISCIPLINE: """
"RTN","QACDISPC",14,0)
 . S FR(1)=QAQNBEG,TO(1)=QAQNEND
"RTN","QACDISPC",15,0)
 ;
"RTN","QACDISPC",16,0)
 ; report is by division
"RTN","QACDISPC",17,0)
 I +$G(QACDV)=1 D
"RTN","QACDISPC",18,0)
 . S BY="37;S3;C25,'1,21,3,+1:,1;S;""DISCIPLINE: """
"RTN","QACDISPC",19,0)
 . S FR(1)="@",TO(1)=""
"RTN","QACDISPC",20,0)
 . I +$G(QAC1DIV) D
"RTN","QACDISPC",21,0)
 . . S QACDVNAM="" D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACDISPC",22,0)
 . . S (FR(1),TO(1))=QACDVNAM
"RTN","QACDISPC",23,0)
 . S FR(2)=QAQNBEG,TO(2)=QAQNEND
"RTN","QACDISPC",24,0)
 D EN1^DIP
"RTN","QACDISPC",25,0)
EXIT ;
"RTN","QACDISPC",26,0)
 K DIC,FLDS,L,BY,FR,TO,DHD,DIP,QACDV,QAC1DIV,QAQPOP,QACDVNAM
"RTN","QACDISPC",27,0)
 K QAQNBEG,QAQNEND
"RTN","QACDISPC",28,0)
 D K^QAQDATE
"RTN","QACDISPC",29,0)
 Q
"RTN","QACDISPS")
0^8^B1165536
"RTN","QACDISPS",1,0)
QACDISPS ;WCIOFO/VAD-Service/Discipline Contact Totals ;12/08/98
"RTN","QACDISPS",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACDISPS",3,0)
 ;
"RTN","QACDISPS",4,0)
MAIN ;
"RTN","QACDISPS",5,0)
 S QAQPOP=0
"RTN","QACDISPS",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACDISPS",7,0)
 K DIC,FLDS,L,BY,FR,TO,DHD
"RTN","QACDISPS",8,0)
 S L=0,DIC="^QA(745.1,"
"RTN","QACDISPS",9,0)
 S FLDS="[QAC DISC RPT]",DHD="[QAC DISC SERV RPT HEADER]"
"RTN","QACDISPS",10,0)
 ;
"RTN","QACDISPS",11,0)
 ; report is not by division
"RTN","QACDISPS",12,0)
 I +$G(QACDV)'=1 D
"RTN","QACDISPS",13,0)
 . S BY="'1,21,3,+.01"
"RTN","QACDISPS",14,0)
 . S FR(1)=QAQNBEG,TO(1)=QAQNEND
"RTN","QACDISPS",15,0)
 ;
"RTN","QACDISPS",16,0)
 ; report is by division
"RTN","QACDISPS",17,0)
 I +$G(QACDV)=1 D
"RTN","QACDISPS",18,0)
 . S BY="37;S3;C25,'1,21,3,+.01"
"RTN","QACDISPS",19,0)
 . S FR(1)="@",TO(1)=""
"RTN","QACDISPS",20,0)
 . I +$G(QAC1DIV) D
"RTN","QACDISPS",21,0)
 . . S QACDVNAM="" D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACDISPS",22,0)
 . . S (FR(1),TO(1))=QACDVNAM
"RTN","QACDISPS",23,0)
 . S FR(2)=QAQNBEG,TO(2)=QAQNEND
"RTN","QACDISPS",24,0)
 D EN1^DIP
"RTN","QACDISPS",25,0)
EXIT ;
"RTN","QACDISPS",26,0)
 K DIC,FLDS,L,BY,FR,TO,DHD,DIP,QACDV,QAC1DIV,QAQPOP,QACDVNAM
"RTN","QACDISPS",27,0)
 K QAQNBEG,QAQNEND
"RTN","QACDISPS",28,0)
 D K^QAQDATE
"RTN","QACDISPS",29,0)
 Q
"RTN","QACEMPC")
0^9^B1195841
"RTN","QACEMPC",1,0)
QACEMPC ;WCIOFO/VAD-Employee Contact Totals ;12/08/98
"RTN","QACEMPC",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACEMPC",3,0)
 ;
"RTN","QACEMPC",4,0)
MAIN ;
"RTN","QACEMPC",5,0)
 S QAQPOP=0
"RTN","QACEMPC",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACEMPC",7,0)
 K DIC,FLDS,L,BY,FR,TO,DHD
"RTN","QACEMPC",8,0)
 S L=0,DIC="^QA(745.1,"
"RTN","QACEMPC",9,0)
 S FLDS="[QAC EMP TOT]",DHD="[QAC EMP CONTACT HEADER]"
"RTN","QACEMPC",10,0)
 ;
"RTN","QACEMPC",11,0)
 ; report is not by division
"RTN","QACEMPC",12,0)
 I +$G(QACDV)'=1 D
"RTN","QACEMPC",13,0)
 . S BY="'1,17,+.01;S,21,3,.01"
"RTN","QACEMPC",14,0)
 . S FR(1)=QAQNBEG,TO(1)=QAQNEND
"RTN","QACEMPC",15,0)
 ;
"RTN","QACEMPC",16,0)
 ; report is by division
"RTN","QACEMPC",17,0)
 I +$G(QACDV)=1 D
"RTN","QACEMPC",18,0)
 . S BY="37;S3;C25,'1,17,+.01;S,21,3,.01"
"RTN","QACEMPC",19,0)
 . S FR(1)="@",TO(1)=""
"RTN","QACEMPC",20,0)
 . I +$G(QAC1DIV) D
"RTN","QACEMPC",21,0)
 . . S QACDVNAM="" D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACEMPC",22,0)
 . . S (FR(1),TO(1))=QACDVNAM
"RTN","QACEMPC",23,0)
 . S FR(2)=QAQNBEG,TO(2)=QAQNEND
"RTN","QACEMPC",24,0)
 D EN1^DIP
"RTN","QACEMPC",25,0)
EXIT ;
"RTN","QACEMPC",26,0)
 K DIC,FLDS,L,BY,FR,TO,DHD,DIP,QACDV,QAC1DIV,QAQPOP,QACDVNAM
"RTN","QACEMPC",27,0)
 K QAQNBEG,QAQNEND
"RTN","QACEMPC",28,0)
 D K^QAQDATE
"RTN","QACEMPC",29,0)
 Q
"RTN","QACEMPE")
0^10^B74825901
"RTN","QACEMPE",1,0)
QACEMPE ;WCIOFO/VAD-Report By Employee ;02/10/1999
"RTN","QACEMPE",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACEMPE",3,0)
 ;
"RTN","QACEMPE",4,0)
MAIN ;
"RTN","QACEMPE",5,0)
 D INIT
"RTN","QACEMPE",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACEMPE",7,0)
 I +$G(QAC1DIV) D INST^QACUTL0(QAC1DIV,.QACDVNAM)  ; If reporting for one division get the division name to be reported.
"RTN","QACEMPE",8,0)
 ;
"RTN","QACEMPE",9,0)
 D GTEMP G:QAQPOP EXIT
"RTN","QACEMPE",10,0)
 ;
"RTN","QACEMPE",11,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS I POP D EXIT Q
"RTN","QACEMPE",12,0)
 ;
"RTN","QACEMPE",13,0)
 I $D(IO("Q")) D  Q 
"RTN","QACEMPE",14,0)
 . S ZTDESC=QACDESC
"RTN","QACEMPE",15,0)
 . S ZTRTN="PROCESS^QACEMPE"
"RTN","QACEMPE",16,0)
 . S ZTSAVE("QACALL")="",ZTSAVE("QACDESC")=""
"RTN","QACEMPE",17,0)
 . S ZTSAVE("QAC1DIV")="",ZTSAVE("QACDVNAM")=""
"RTN","QACEMPE",18,0)
 . S ZTSAVE("QACESEL")="",ZTSAVE("QACINFO")="",ZTSAVE("QACRTN")=""
"RTN","QACEMPE",19,0)
 . S ZTSAVE("QAQRANG")=""
"RTN","QACEMPE",20,0)
 . D TASK^QACUTL0
"RTN","QACEMPE",21,0)
 ;
"RTN","QACEMPE",22,0)
 D PROCESS
"RTN","QACEMPE",23,0)
 Q
"RTN","QACEMPE",24,0)
 ;
"RTN","QACEMPE",25,0)
INIT ;
"RTN","QACEMPE",26,0)
 S (QACINFO,QAQPOP)=0,QACDVNAM=""
"RTN","QACEMPE",27,0)
 S QACRTN="QACEMPE"
"RTN","QACEMPE",28,0)
 S QACDESC="Report by Employee"
"RTN","QACEMPE",29,0)
 Q
"RTN","QACEMPE",30,0)
 ;
"RTN","QACEMPE",31,0)
GTEMP ; Get the Employee Selection.
"RTN","QACEMPE",32,0)
 S QACESEL="",QACALL=0
"RTN","QACEMPE",33,0)
 W !!,"Enter an Employee Name or <CR> for ALL: " R QACESEL:DTIME
"RTN","QACEMPE",34,0)
 I QACESEL="^" S QAQPOP=1 Q
"RTN","QACEMPE",35,0)
 I QACESEL="" S QACALL=1 Q
"RTN","QACEMPE",36,0)
 I QACESEL'?.AP W !,$C(7),"INVALID NAME...RE-ENTER NAME!" G GTEMP
"RTN","QACEMPE",37,0)
 S QACESEL=$$TRANS(QACESEL)
"RTN","QACEMPE",38,0)
 ;
"RTN","QACEMPE",39,0)
 ; Select one Employee.
"RTN","QACEMPE",40,0)
 S QACFIL=200,QACFLDS=.01,QACFLGS="O",QACDATA="^TMP(QACRTN,$J,""DATA"")",QACERR="^TMP(QACRTN,$J,""ERR"")"
"RTN","QACEMPE",41,0)
 D FIND^DIC(QACFIL,,.QACFLDS,QACFLGS,QACESEL,,,,,QACDATA,QACERR)
"RTN","QACEMPE",42,0)
 S QACFOUND=+$G(^TMP(QACRTN,$J,"DATA","DILIST",0))
"RTN","QACEMPE",43,0)
 I 'QACFOUND D  G GTEMP
"RTN","QACEMPE",44,0)
 . W !!,$C(7),"EMPLOYEE SELECTION NOT FOUND...<CR> to Continue" R R:DTIME
"RTN","QACEMPE",45,0)
 ;
"RTN","QACEMPE",46,0)
 S QACOK=0
"RTN","QACEMPE",47,0)
 I QACFOUND=1 D GTEMP1 Q:QACOK  G GTEMP
"RTN","QACEMPE",48,0)
 D GTEMP2 Q:QACOK  G GTEMP
"RTN","QACEMPE",49,0)
 Q
"RTN","QACEMPE",50,0)
 ;
"RTN","QACEMPE",51,0)
GTEMP1 ;
"RTN","QACEMPE",52,0)
 S QACREC=^TMP(QACRTN,$J,"DATA","DILIST",1,1)
"RTN","QACEMPE",53,0)
 W !!?5,QACREC
"RTN","QACEMPE",54,0)
 W !!?5,"Is the above Employee the correct one? <Y> " R R:DTIME
"RTN","QACEMPE",55,0)
 S R=$$TRANS(R)
"RTN","QACEMPE",56,0)
 I R="" S R="Y"
"RTN","QACEMPE",57,0)
 I R="Y" S QACESEL=QACREC,QACOK=1 Q
"RTN","QACEMPE",58,0)
 I R'="N" D  G GTEMP1
"RTN","QACEMPE",59,0)
 . W !!,"PLEASE ENTER 'Y' or 'N'...<CR> to Continue" R R:DTIME
"RTN","QACEMPE",60,0)
 Q
"RTN","QACEMPE",61,0)
 ;
"RTN","QACEMPE",62,0)
GTEMP2 ;
"RTN","QACEMPE",63,0)
 F I=1:1:QACFOUND D
"RTN","QACEMPE",64,0)
 . S QACREC=^TMP(QACRTN,$J,"DATA","DILIST",1,I)
"RTN","QACEMPE",65,0)
 . W !?5,I,".)  ",QACREC
"RTN","QACEMPE",66,0)
 ;
"RTN","QACEMPE",67,0)
 W !!?5,"Select one of the above: " R QACNUM:DTIME
"RTN","QACEMPE",68,0)
 I '$L(QACNUM) Q
"RTN","QACEMPE",69,0)
 I QACNUM>QACFOUND D  G GTEMP2
"RTN","QACEMPE",70,0)
 . W !!,"MUST SELECT A NUMBER FROM 1-",QACFOUND,"...<CR> to Continue" R R:DTIME
"RTN","QACEMPE",71,0)
 S QACESEL=^TMP(QACRTN,$J,"DATA","DILIST",1,QACNUM)
"RTN","QACEMPE",72,0)
 S QACOK=1
"RTN","QACEMPE",73,0)
 Q
"RTN","QACEMPE",74,0)
 ;
"RTN","QACEMPE",75,0)
PROCESS ;
"RTN","QACEMPE",76,0)
 D SETUP,SORT,RPT
"RTN","QACEMPE",77,0)
 I 'QACINFO D HEADER W !!?26,"* * * NO DATA TO PRINT * * *",!!
"RTN","QACEMPE",78,0)
 D EXIT
"RTN","QACEMPE",79,0)
 Q
"RTN","QACEMPE",80,0)
 ;
"RTN","QACEMPE",81,0)
SETUP ;
"RTN","QACEMPE",82,0)
 K ^TMP(QACRTN,$J)
"RTN","QACEMPE",83,0)
 K QACEMPNM
"RTN","QACEMPE",84,0)
 S (QACQUIT,QACPAGE)=0
"RTN","QACEMPE",85,0)
 S QACHDR2="Date "_QAQRANG
"RTN","QACEMPE",86,0)
 S $P(QACUNDL,"-",78)="-"
"RTN","QACEMPE",87,0)
 S QACDTIM=$$HTE^XLFDT($H,1)
"RTN","QACEMPE",88,0)
 S QACTIME=$P(QACDTIM,"@",2)
"RTN","QACEMPE",89,0)
 S QACTODAY=$P(QACDTIM,"@")_"  "_$E(QACTIME,1,5)
"RTN","QACEMPE",90,0)
 Q
"RTN","QACEMPE",91,0)
 ;
"RTN","QACEMPE",92,0)
SORT ; Sort thru the data to accumulate results based upon selection criteria
"RTN","QACEMPE",93,0)
 S QACDATE1=QAQNBEG-1  ; Initialize the starting point for the Date of Contacts.
"RTN","QACEMPE",94,0)
 I '$D(QAC1DIV) S QACDVNAM="NON-DIVISIONAL"
"RTN","QACEMPE",95,0)
 ;
"RTN","QACEMPE",96,0)
 ; Loop thru ROCs by "Date of Contact"
"RTN","QACEMPE",97,0)
 F  S QACDATE1=$O(^QA(745.1,"D",QACDATE1)) Q:(QACDATE1>QAQNEND)!('$L(QACDATE1))  D
"RTN","QACEMPE",98,0)
 . S QACD0=""
"RTN","QACEMPE",99,0)
 . F  S QACD0=$O(^QA(745.1,"D",QACDATE1,QACD0)) Q:'$L(QACD0)  D
"RTN","QACEMPE",100,0)
 . . K QACOUT
"RTN","QACEMPE",101,0)
 . . D GETS^DIQ(745.1,QACD0,".01;1;2;37","NIE","QACOUT")
"RTN","QACEMPE",102,0)
 . . S QACD0X=QACD0_","
"RTN","QACEMPE",103,0)
 . . S QACROCNO=$G(QACOUT(745.1,QACD0X,.01,"E"))  ; Contact Number
"RTN","QACEMPE",104,0)
 . . S QACROCDT=$G(QACOUT(745.1,QACD0X,1,"E"))  ; Date of Contact - External
"RTN","QACEMPE",105,0)
 . . S QACPTNO=$G(QACOUT(745.1,QACD0X,2,"I"))  ; Patient #
"RTN","QACEMPE",106,0)
 . . S QACPTNAM=$G(QACOUT(745.1,QACD0X,2,"E"))  ; Patient Name
"RTN","QACEMPE",107,0)
 . . S QACDOK=1
"RTN","QACEMPE",108,0)
 . . ;
"RTN","QACEMPE",109,0)
 . . ; If site is Multi-divisional set up for the division name.
"RTN","QACEMPE",110,0)
 . . I $D(QAC1DIV) D  Q:'QACDOK
"RTN","QACEMPE",111,0)
 . . . S QACDVNO=$G(QACOUT(745.1,QACD0X,37,"I"))  ; Division #
"RTN","QACEMPE",112,0)
 . . . I +QAC1DIV,+QAC1DIV'=+QACDVNO S QACDOK=0 Q  ; Not the selected Division
"RTN","QACEMPE",113,0)
 . . . S QACDVNAM=$G(QACOUT(745.1,QACD0X,37,"E"))  ; Division Name
"RTN","QACEMPE",114,0)
 . . . I '$L(QACDVNAM) S QACDVNAM="  EMPTY"
"RTN","QACEMPE",115,0)
 . . ;
"RTN","QACEMPE",116,0)
 . . ; Get array of Service/Disciplines for an ROC.
"RTN","QACEMPE",117,0)
 . . K QAC3ARAY
"RTN","QACEMPE",118,0)
 . . S QACD1=0
"RTN","QACEMPE",119,0)
 . . F  S QACD1=$O(^QA(745.1,QACD0,3,QACD1)) Q:'$L(QACD1)  D
"RTN","QACEMPE",120,0)
 . . . I '$D(^QA(745.1,QACD0,3,QACD1,3,"B")) Q
"RTN","QACEMPE",121,0)
 . . . S QACD2=""
"RTN","QACEMPE",122,0)
 . . . F  S QACD2=$O(^QA(745.1,QACD0,3,QACD1,3,"B",QACD2)) Q:'$L(QACD2)  D
"RTN","QACEMPE",123,0)
 . . . . S QACSVDP=$P($G(^QA(745.55,QACD2,0)),U,1)  ; Serv/Disp Name
"RTN","QACEMPE",124,0)
 . . . . S QACD3=""
"RTN","QACEMPE",125,0)
 . . . . F  S QACD3=$O(^QA(745.1,QACD0,3,QACD1,3,"B",QACD2,QACD3)) Q:'$L(QACD3)  D
"RTN","QACEMPE",126,0)
 . . . . . S QACSEQ=0 F QACSEQ=QACSEQ:1 I '$D(QAC3ARAY(QACSVDP,QACSEQ)) Q
"RTN","QACEMPE",127,0)
 . . . . . S QAC3ARAY(QACSVDP,QACSEQ)=""
"RTN","QACEMPE",128,0)
 . . ;
"RTN","QACEMPE",129,0)
 . . ; Get each Employee for an ROC.
"RTN","QACEMPE",130,0)
 . . S QACD1=0
"RTN","QACEMPE",131,0)
 . . F  S QACD1=$O(^QA(745.1,QACD0,8,QACD1)) Q:'$L(QACD1)!(QACD1'?.N)  D
"RTN","QACEMPE",132,0)
 . . . S QACENO=$G(^QA(745.1,QACD0,8,QACD1,0))  ; Employee Internal #
"RTN","QACEMPE",133,0)
 . . . S QACENOX=QACENO_","
"RTN","QACEMPE",134,0)
 . . . I '$D(QACEMPNM(200,QACENOX)) D  ; If Employee Name not previously accessed get the name.
"RTN","QACEMPE",135,0)
 . . . . D GETS^DIQ(200,QACENO,".01","NE","QACEMPNM")
"RTN","QACEMPE",136,0)
 . . . . I $G(QACEMPNM(200,QACENOX,.01,"E"))="" S ^("E")="Unknown Employee"
"RTN","QACEMPE",137,0)
 . . . S QACENAM=QACEMPNM(200,QACENOX,.01,"E")  ; Employee Name
"RTN","QACEMPE",138,0)
 . . . D STORIT
"RTN","QACEMPE",139,0)
 Q
"RTN","QACEMPE",140,0)
 ;
"RTN","QACEMPE",141,0)
STORIT ; Store sorted ROC data in the ^TMP global for reporting purposes.
"RTN","QACEMPE",142,0)
 I 'QACALL,(QACENAM'=QACESEL) Q  ; Not selected Employee.
"RTN","QACEMPE",143,0)
 I '$D(^TMP(QACRTN,$J,"ROC",QACROCNO)) D
"RTN","QACEMPE",144,0)
 . S ^TMP(QACRTN,$J,"ROC",QACROCNO)=QACD0_U_QACROCDT_U_QACPTNAM
"RTN","QACEMPE",145,0)
 ; Store record for reporting purposes
"RTN","QACEMPE",146,0)
 S (QACSVDP,QACSEQ)=""
"RTN","QACEMPE",147,0)
 F  S QACSVDP=$O(QAC3ARAY(QACSVDP)) Q:'$L(QACSVDP)  D
"RTN","QACEMPE",148,0)
 . F  S QACSEQ=$O(QAC3ARAY(QACSVDP,QACSEQ)) Q:'$L(QACSEQ)  D
"RTN","QACEMPE",149,0)
 . . S ^TMP(QACRTN,$J,"RPT",QACDVNAM,QACENAM,QACSVDP,QACROCNO,QACSEQ)=""
"RTN","QACEMPE",150,0)
 Q
"RTN","QACEMPE",151,0)
 ;
"RTN","QACEMPE",152,0)
RPT ; Print the report
"RTN","QACEMPE",153,0)
 U IO
"RTN","QACEMPE",154,0)
 ;
"RTN","QACEMPE",155,0)
 ; Loop through the Sorted data.
"RTN","QACEMPE",156,0)
 S (QACDVNAM,QACEMPNM,QACSVDP,QACROCNO,QACSEQ)=""
"RTN","QACEMPE",157,0)
 F  S QACDVNAM=$O(^TMP(QACRTN,$J,"RPT",QACDVNAM)) Q:QACDVNAM=""  D  Q:QACQUIT
"RTN","QACEMPE",158,0)
 . F  S QACEMPNM=$O(^TMP(QACRTN,$J,"RPT",QACDVNAM,QACEMPNM)) Q:QACEMPNM=""  D  Q:QACQUIT
"RTN","QACEMPE",159,0)
 . . ;
"RTN","QACEMPE",160,0)
 . . ; New Employee
"RTN","QACEMPE",161,0)
 . . D HEADER Q:QACQUIT
"RTN","QACEMPE",162,0)
 . . F  S QACSVDP=$O(^TMP(QACRTN,$J,"RPT",QACDVNAM,QACEMPNM,QACSVDP)) Q:QACSVDP=""  D  Q:QACQUIT
"RTN","QACEMPE",163,0)
 . . . F  S QACROCNO=$O(^TMP(QACRTN,$J,"RPT",QACDVNAM,QACEMPNM,QACSVDP,QACROCNO)) Q:QACROCNO=""  D  Q:QACQUIT
"RTN","QACEMPE",164,0)
 . . . . ;
"RTN","QACEMPE",165,0)
 . . . . ; Get an array of Issue Text for an ROC.
"RTN","QACEMPE",166,0)
 . . . . K QACITXT
"RTN","QACEMPE",167,0)
 . . . . S QACREC=^TMP(QACRTN,$J,"ROC",QACROCNO)
"RTN","QACEMPE",168,0)
 . . . . S QACD0=$P(QACREC,U),QACROCDT=$P(QACREC,U,2),QACPTNAM=$P(QACREC,U,3)
"RTN","QACEMPE",169,0)
 . . . . I $D(^QA(745.1,QACD0,4,0)) D
"RTN","QACEMPE",170,0)
 . . . . . S DIC=745.1,DA=QACD0,DR=22,DIQ="QACITXT"
"RTN","QACEMPE",171,0)
 . . . . . D EN^DIQ1
"RTN","QACEMPE",172,0)
 . . . . ;
"RTN","QACEMPE",173,0)
 . . . . ; Print the Contact #, Date of Contact and Patient Name
"RTN","QACEMPE",174,0)
 . . . . I $Y>(IOSL-6) D HEADER Q:QACQUIT
"RTN","QACEMPE",175,0)
 . . . . W !!,QACROCNO,?25,QACROCDT,?45,QACPTNAM
"RTN","QACEMPE",176,0)
 . . . . ;
"RTN","QACEMPE",177,0)
 . . . . ; Print the Issue Text if there is any.
"RTN","QACEMPE",178,0)
 . . . . I $D(QACITXT) D  Q:QACQUIT
"RTN","QACEMPE",179,0)
 . . . . . S QACD1=""
"RTN","QACEMPE",180,0)
 . . . . . F  S QACD1=$O(QACITXT(745.1,QACD0,DR,QACD1)) Q:'$L(QACD1)  D  Q:QACQUIT
"RTN","QACEMPE",181,0)
 . . . . . . I $Y>(IOSL-6) D HEADER Q:QACQUIT
"RTN","QACEMPE",182,0)
 . . . . . . W !?3,QACITXT(745.1,QACD0,DR,QACD1)
"RTN","QACEMPE",183,0)
 . . . . ;
"RTN","QACEMPE",184,0)
 . . . . F  S QACSEQ=$O(^TMP(QACRTN,$J,"RPT",QACDVNAM,QACEMPNM,QACSVDP,QACROCNO,QACSEQ)) Q:QACSEQ=""  D  Q:QACQUIT
"RTN","QACEMPE",185,0)
 . . . . . ;
"RTN","QACEMPE",186,0)
 . . . . . ; Print a Serv/Sect or Discipline line.
"RTN","QACEMPE",187,0)
 . . . . . I $Y>(IOSL-6) D HEADER Q:QACQUIT
"RTN","QACEMPE",188,0)
 . . . . . W !?6,QACSVDP
"RTN","QACEMPE",189,0)
 Q
"RTN","QACEMPE",190,0)
 ;
"RTN","QACEMPE",191,0)
HEADER ;
"RTN","QACEMPE",192,0)
 S QACPAGE=QACPAGE+1
"RTN","QACEMPE",193,0)
 I QACPAGE>1 D  Q:QACQUIT
"RTN","QACEMPE",194,0)
 . W $C(7)
"RTN","QACEMPE",195,0)
 . I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR S QACQUIT=$S(Y'>0:1,1:0)
"RTN","QACEMPE",196,0)
 ;
"RTN","QACEMPE",197,0)
 W:$E(IOST)="C"!(QACPAGE>1) @IOF
"RTN","QACEMPE",198,0)
 W !,QACDESC,?48,QACTODAY,?70,"PAGE ",QACPAGE
"RTN","QACEMPE",199,0)
 W !?(80-$L(QACHDR2))/2,QACHDR2
"RTN","QACEMPE",200,0)
 W !,"Contact #",?25,"Date of Contact",?45,"Patient Name"
"RTN","QACEMPE",201,0)
 W !?3,"Issue Text",!?6,"Serv/Sect or Discipline"
"RTN","QACEMPE",202,0)
 W !,QACUNDL
"RTN","QACEMPE",203,0)
 ;
"RTN","QACEMPE",204,0)
 I $D(QAC1DIV) D    ; Print the division if site is Multi-divisional.
"RTN","QACEMPE",205,0)
 . S QACDVTXT="Division: "_$S(QACDVNAM="  EMPTY":"EMPTY",1:QACDVNAM)
"RTN","QACEMPE",206,0)
 . I $L(QACDVNAM) W !?(80-$L(QACDVTXT))/2,QACDVTXT S QACINFO=1
"RTN","QACEMPE",207,0)
 ;
"RTN","QACEMPE",208,0)
 S QACEMTXT="Employee: "_QACEMPNM
"RTN","QACEMPE",209,0)
 I $L(QACEMPNM) W !?(80-$L(QACEMTXT))/2,QACEMTXT,! S QACINFO=1
"RTN","QACEMPE",210,0)
 Q
"RTN","QACEMPE",211,0)
 ;
"RTN","QACEMPE",212,0)
TRANS(X) ; Module to transform lower-case into uppercase.
"RTN","QACEMPE",213,0)
 S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","QACEMPE",214,0)
 Q X
"RTN","QACEMPE",215,0)
 ;
"RTN","QACEMPE",216,0)
EXIT ;
"RTN","QACEMPE",217,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACEMPE",218,0)
 D K^QAQDATE
"RTN","QACEMPE",219,0)
 K ^TMP(QACRTN,$J)
"RTN","QACEMPE",220,0)
 K DA,DIC,DIQ,DIR,DR
"RTN","QACEMPE",221,0)
 K QAC1DIV,QAC3ARAY,QAC4ARAY,QACALL,QACCONT,QACCREC0,QACD0,QACD0X
"RTN","QACEMPE",222,0)
 K QACD1,QACD2,QACD3,QACDATA,QACDATE1,QACDESC,QACDOK,QACDTIM,QACDV
"RTN","QACEMPE",223,0)
 K QACDVNAM,QACDVNO,QACDVTXT,QACEMPNM,QACEMTXT,QACENAM,QACENO,QACENOX
"RTN","QACEMPE",224,0)
 K QACERR,QACESEL,QACFIL,QACFLDS,QACFLGS,QACFOUND,QACHDR2,QACINFO,QACITXT
"RTN","QACEMPE",225,0)
 K QACNUM,QACOK,QACOUT,QACPAGE,QACPTNAM,QACPTNO,QACQUIT,QACREC
"RTN","QACEMPE",226,0)
 K QACROCNO,QACROCDT,QACRTN,QACSEQ,QACSNO,QACSVDP,QACTIME,QACTODAY
"RTN","QACEMPE",227,0)
 K QACUNDL,QAQDTOUT,QAQNBEG,QAQNEND,QAQPOP,QAQRANG
"RTN","QACEMPE",228,0)
 K I,POP,R,X,Y,ZTDESC,ZTRTN,ZTSAVE
"RTN","QACEMPE",229,0)
 Q
"RTN","QACGEN")
0^11^B42303671
"RTN","QACGEN",1,0)
QACGEN ;HISC/CEW,DAD - Issue Totals for All or by Gender ;5/30/95  15:32
"RTN","QACGEN",2,0)
 ;;2.0;Patient Representative;**3,9**;07/25/1995
"RTN","QACGEN",3,0)
DATE ;
"RTN","QACGEN",4,0)
 N QACDVFLG
"RTN","QACGEN",5,0)
 S QAQPOP=0
"RTN","QACGEN",6,0)
 D DATE^QACUTL0 Q:QAQPOP
"RTN","QACGEN",7,0)
 K DIR S DIR(0)="SMO^A:All;M:Male;F:Female"
"RTN","QACGEN",8,0)
 S DIR("A")="     Selection"
"RTN","QACGEN",9,0)
 S DIR("?")="Select A, M, or F"
"RTN","QACGEN",10,0)
 S DIR("??")="Enter A for All Issues, M for all issues for Male patients, or F for all issues for Female patients."
"RTN","QACGEN",11,0)
 ;Set QACGEN= to A, M, or F, and QACGENX= All, Male, or Female
"RTN","QACGEN",12,0)
 D ^DIR K DIR G EXIT:$D(DIRUT)!($D(DIROUT)) S QACGEN=Y,QACGENX=Y(0)
"RTN","QACGEN",13,0)
 I $P($G(^QA(740,1,"QAC")),U,3)=1 S QACDVFLG=1
"RTN","QACGEN",14,0)
 I $G(QACDVFLG)=1 D DIV^QACUTL0 Q:$G(QAQPOP)=1
"RTN","QACGEN",15,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS G:POP EXIT
"RTN","QACGEN",16,0)
 I $D(IO("Q")) D  G EXIT
"RTN","QACGEN",17,0)
 . S ZTDESC="Patient Rep Issue Totals"
"RTN","QACGEN",18,0)
 . S (ZTSAVE("QACGEN"),ZTSAVE("QACGENX"))=""
"RTN","QACGEN",19,0)
 . ;S (ZTSAVE("QACDIV"),ZTSAVE("QAC1DIV"))=""
"RTN","QACGEN",20,0)
 . S ZTSAVE("QACDVFLG")=""
"RTN","QACGEN",21,0)
 . S ZTRTN="GENTSK^QACGEN"
"RTN","QACGEN",22,0)
 . D TASK^QACUTL0
"RTN","QACGEN",23,0)
 . Q
"RTN","QACGEN",24,0)
GENTSK ; Gets the data to build the TMP global
"RTN","QACGEN",25,0)
 K ^TMP("QACGEN",$J)
"RTN","QACGEN",26,0)
 S ^TMP("QACGEN",$J)=0
"RTN","QACGEN",27,0)
 U IO
"RTN","QACGEN",28,0)
 N QACDT,QACD0,QACCN,QACPIEN,QACCIEN,QACCNM,QACHDNM,QACHDIEN
"RTN","QACGEN",29,0)
 N QACHD,QACICODE,QACDIV,QACGENDR
"RTN","QACGEN",30,0)
 ; Get each record in the date range
"RTN","QACGEN",31,0)
 S QACDT=QAQNBEG-.0000001 F  S QACDT=$O(^QA(745.1,"D",QACDT)) Q:(QACDT'>0)!(QACDT>QAQNEND)!(QACDT\1'?7N)  D
"RTN","QACGEN",32,0)
 . S QACD0=0 F  S QACD0=$O(^QA(745.1,"D",QACDT,QACD0)) Q:QACD0'>0  D
"RTN","QACGEN",33,0)
 .. ; For each record if there is a patient get the IEN and the gender
"RTN","QACGEN",34,0)
 .. S QAC74510=^QA(745.1,QACD0,0)
"RTN","QACGEN",35,0)
 .. S QACPIEN=+$P($G(QAC74510),U,3)
"RTN","QACGEN",36,0)
 .. I $G(QACDVFLG) S QACDIV=$P($G(QAC74510),U,16)
"RTN","QACGEN",37,0)
 .. I $G(QACDIV)']"" S QACDIV=0
"RTN","QACGEN",38,0)
 .. S QACEE=0
"RTN","QACGEN",39,0)
 .. I $O(^QA(740,1,"QAC2","B",QACDIV,QACEE))']"" S QACDIV=0
"RTN","QACGEN",40,0)
 .. I $G(QAC1DIV)>0,QAC1DIV'=$G(QACDIV) Q
"RTN","QACGEN",41,0)
 .. S QACGENDR=$P($G(^DPT(QACPIEN,0)),U,2)
"RTN","QACGEN",42,0)
 .. I $S(QACGEN=QACGENDR:1,QACGEN="A":1,1:0) D
"RTN","QACGEN",43,0)
 ... ; For each code in record, get IEN and set QACICODE=code,
"RTN","QACGEN",44,0)
 ... ; QACHD=header for code, and QACHDIEN=header IEN.
"RTN","QACGEN",45,0)
 ... S QACCN=0 F  S QACCN=$O(^QA(745.1,QACD0,3,QACCN)) Q:QACCN'>0  D
"RTN","QACGEN",46,0)
 .... S QACCIEN=$P($G(^QA(745.1,QACD0,3,QACCN,0)),U,1) Q:QACCIEN=""
"RTN","QACGEN",47,0)
 .... S QACINDT=$P($G(^QA(745.2,QACCIEN,0)),U,6)
"RTN","QACGEN",48,0)
 .... Q:(QACINDT)&(QACINDT<QAQNBEG)
"RTN","QACGEN",49,0)
 .... S QACICODE=$P($G(^QA(745.2,QACCIEN,0)),U,1) Q:QACICODE=""
"RTN","QACGEN",50,0)
 .... I $E(QACICODE,1,2)?2A S QACHD=$E(QACICODE,1,2)
"RTN","QACGEN",51,0)
 .... E  S QACHD=$E(QACICODE,1)
"RTN","QACGEN",52,0)
 .... S QACHDIEN=0 F  S QACHDIEN=$O(^QA(745.2,"B",QACHD,QACHDIEN)) Q:QACHDIEN'>0  D SET
"RTN","QACGEN",53,0)
 .... Q
"RTN","QACGEN",54,0)
 ... Q
"RTN","QACGEN",55,0)
 .. Q
"RTN","QACGEN",56,0)
 . Q
"RTN","QACGEN",57,0)
INIT ;initialize ^TMP("QACGEN",$J nodes to zero if no count, yet
"RTN","QACGEN",58,0)
 S QACCIEN=0
"RTN","QACGEN",59,0)
 F  S QACCIEN=$O(^QA(745.2,QACCIEN)) Q:QACCIEN'>0  D
"RTN","QACGEN",60,0)
 . S QACINDT=$P($G(^QA(745.2,QACCIEN,0)),U,6)
"RTN","QACGEN",61,0)
 . Q:(QACINDT)&(QACINDT<QAQNBEG)
"RTN","QACGEN",62,0)
 . S QACICODE=$P($G(^QA(745.2,QACCIEN,0)),U) Q:QACICODE=""
"RTN","QACGEN",63,0)
 . S QACHD=$S($E(QACICODE,1,2)?2A:$E(QACICODE,1,2),1:$E(QACICODE))
"RTN","QACGEN",64,0)
 . S QACHDIEN=0
"RTN","QACGEN",65,0)
 . F  S QACHDIEN=$O(^QA(745.2,"B",QACHD,QACHDIEN)) Q:QACHDIEN'>0  D
"RTN","QACGEN",66,0)
 .. I QACHD'=$P($G(^QA(745.2,QACHDIEN,0)),U) Q
"RTN","QACGEN",67,0)
 .. S X=QACHD_U_QACHDIEN,Y=QACICODE_U_QACCIEN
"RTN","QACGEN",68,0)
 .. ;if not integrated, initialization unchanged
"RTN","QACGEN",69,0)
 .. I $G(QACDVFLG)'=1 D
"RTN","QACGEN",70,0)
 ... I $G(^TMP("QACGEN",$J,X))="" S ^TMP("QACGEN",$J,X)=0
"RTN","QACGEN",71,0)
 ... I $G(^TMP("QACGEN",$J,X,Y))="" S ^TMP("QACGEN",$J,X,Y)=0
"RTN","QACGEN",72,0)
 ... Q
"RTN","QACGEN",73,0)
 .. ;if integrated nodes initialized by division
"RTN","QACGEN",74,0)
 .. I $G(QACDVFLG)=1 D
"RTN","QACGEN",75,0)
 ... S QACC="" F  S QACC=$O(^TMP("QACGEN",$J,QACC)) Q:QACC']""  D
"RTN","QACGEN",76,0)
 .... I $G(^TMP("QACGEN",$J,QACC,X))="" S ^TMP("QACGEN",$J,QACC,X)=0
"RTN","QACGEN",77,0)
 .... I $G(^TMP("QACGEN",$J,QACC,X,Y))="" S ^TMP("QACGEN",$J,QACC,X,Y)=0
"RTN","QACGEN",78,0)
 . Q
"RTN","QACGEN",79,0)
PRINT ;
"RTN","QACGEN",80,0)
 K QACUNDL S $P(QACUNDL,"-",81)="",QACQUIT=0,QACPG=1
"RTN","QACGEN",81,0)
 I $O(^TMP("QACGEN",$J,""))="" S QACGENX="" D HEAD W !!,"No data found for the date range selected!" Q
"RTN","QACGEN",82,0)
 K QACHDIEN,QACHD,QACCIEN,QACICODE
"RTN","QACGEN",83,0)
 D HEAD S QACTOT=$P($G(^TMP("QACGEN",$J)),U,1)
"RTN","QACGEN",84,0)
 W !!?15,"Total Issues for ",QACGENX," = ",QACTOT,! ;Write total issues
"RTN","QACGEN",85,0)
 I $G(QACDVFLG)=1 D BYDIV G EXIT
"RTN","QACGEN",86,0)
BYHEAD ;prints those records for each header.  If by division this is called
"RTN","QACGEN",87,0)
 ;from BYDIV.  In each reference to ^TMP a $S is used to determine if
"RTN","QACGEN",88,0)
 ;it's being sorted by division.
"RTN","QACGEN",89,0)
 S QACHD="" F  S QACHD=$S($G(QACDVFLG):$O(^TMP("QACGEN",$J,QACEE,QACHD)),1:$O(^TMP("QACGEN",$J,QACHD))) Q:(QACHD="")!($G(QACQUIT))  D
"RTN","QACGEN",90,0)
 . S QACHDIEN=$P(QACHD,"^",2)
"RTN","QACGEN",91,0)
 . S QACHDNM=$$EN6^QACUTIL(QACHDIEN)
"RTN","QACGEN",92,0)
 . S QACHDTOT=$S($G(QACDVFLG):$P($G(^TMP("QACGEN",$J,QACEE,QACHD)),U,1),1:$P($G(^TMP("QACGEN",$J,QACHD)),U,1)) Q:(QACHDTOT="")!($G(QACQUIT))
"RTN","QACGEN",93,0)
 . W !!?5,QACHDNM,?77,QACHDTOT ;Write total for header code
"RTN","QACGEN",94,0)
 . S QACICODE="" F  S QACICODE=$S($G(QACDVFLG):$O(^TMP("QACGEN",$J,QACEE,QACHD,QACICODE)),1:$O(^TMP("QACGEN",$J,QACHD,QACICODE))) Q:(QACICODE="")!($G(QACQUIT))  D
"RTN","QACGEN",95,0)
 .. S QACCIEN=$P(QACICODE,"^",2) ;Get Issue IEN
"RTN","QACGEN",96,0)
 .. S QACCNM=$$EN5^QACUTIL(QACCIEN) ;Get Issue name
"RTN","QACGEN",97,0)
 .. S QACCTOT=$S($G(QACDVFLG):$P($G(^TMP("QACGEN",$J,QACEE,QACHD,QACICODE)),U,1),1:$P($G(^TMP("QACGEN",$J,QACHD,QACICODE)),U,1)) Q:(QACCTOT="")!($G(QACQUIT))
"RTN","QACGEN",98,0)
 .. W !,QACCNM
"RTN","QACGEN",99,0)
 .. W ?77,QACCTOT ;Write total for the issue
"RTN","QACGEN",100,0)
 .. I '$G(QACQUIT),$Y>(IOSL-5) D:$E(IOST)="C" PAUSE Q:$G(QACQUIT)  D HEAD
"RTN","QACGEN",101,0)
 .. Q
"RTN","QACGEN",102,0)
 . Q
"RTN","QACGEN",103,0)
 I $G(QACDVFLG)=1 Q
"RTN","QACGEN",104,0)
 W ! D PAUSE
"RTN","QACGEN",105,0)
EXIT ;
"RTN","QACGEN",106,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACGEN",107,0)
 K IOP,POP,%ZIS,ZTSAVE,ZTDESC,ZTRTN,ZTSK
"RTN","QACGEN",108,0)
 K QAC1DIV,QAC74510,QACC,QACCN,QACCNM,QACCIEN,QACCSS,QACCTOT
"RTN","QACGEN",109,0)
 K QACD,QACDIV,QACDT,QACDV,QACEE,QACGEN,QACGENDR,QACGENX
"RTN","QACGEN",110,0)
 K QACHD,QACHDIEN,QACHDNM,QACHDTOT,QACEE
"RTN","QACGEN",111,0)
 K QACICODE,QACINDT,QACQUIT,QACPG,QACPIEN,QACTOT,QACUNDL
"RTN","QACGEN",112,0)
 K DIR,DIRUT,DIROUT
"RTN","QACGEN",113,0)
 K QAQ2HED,QAQNBEG,QAQNEND,QAQPOP
"RTN","QACGEN",114,0)
 K ^TMP("QACGEN",$J)
"RTN","QACGEN",115,0)
 D K^QAQDATE
"RTN","QACGEN",116,0)
 Q
"RTN","QACGEN",117,0)
HEAD ;
"RTN","QACGEN",118,0)
 W:($E(IOST)="C")!(QACPG>1) @IOF
"RTN","QACGEN",119,0)
 W !,"Issue Report for ",QACGENX S Y=DT D DD^%DT W ?60,"Date: ",Y,!
"RTN","QACGEN",120,0)
 W QAQ2HED,?60,"Page: ",QACPG
"RTN","QACGEN",121,0)
 W !,QACUNDL,! S QACPG=QACPG+1
"RTN","QACGEN",122,0)
 Q
"RTN","QACGEN",123,0)
PAUSE ;
"RTN","QACGEN",124,0)
 I '$G(QACQUIT),$E(IOST)="C" K DIR S DIR(0)="E" D ^DIR S QACQUIT=$S(Y'>0:1,1:0)
"RTN","QACGEN",125,0)
 Q
"RTN","QACGEN",126,0)
SET ;Counts the records.
"RTN","QACGEN",127,0)
 S ^TMP("QACGEN",$J)=$G(^TMP("QACGEN",$J))+1
"RTN","QACGEN",128,0)
 I $G(QACDVFLG)'=1 D NODIV
"RTN","QACGEN",129,0)
 I $G(QACDVFLG)=1 D YESDIV
"RTN","QACGEN",130,0)
 Q
"RTN","QACGEN",131,0)
BYDIV ;for multi-div sites, need to loop through each div
"RTN","QACGEN",132,0)
 N QACCOUNT
"RTN","QACGEN",133,0)
 S QACCOUNT=1
"RTN","QACGEN",134,0)
 S QACEE="" F  S QACEE=$O(^TMP("QACGEN",$J,QACEE)) Q:(QACEE']"")!($G(QACQUIT))  D
"RTN","QACGEN",135,0)
 . I $G(QACCOUNT)>1 D HEAD
"RTN","QACGEN",136,0)
 . I $G(QACEE)>0 D INST^QACUTL0(QACEE,.QACDV)
"RTN","QACGEN",137,0)
 . I $G(QACEE)=0 S QACDV="Unknown"
"RTN","QACGEN",138,0)
 . W !!,"Total Issues by Division: ",QACDV
"RTN","QACGEN",139,0)
 . W !,?5,"Total Issues for ",QACGENX,"  ",$G(^TMP("QACGEN",$J,QACEE))
"RTN","QACGEN",140,0)
 . D BYHEAD
"RTN","QACGEN",141,0)
 . S QACCOUNT=QACCOUNT+1
"RTN","QACGEN",142,0)
 Q
"RTN","QACGEN",143,0)
NODIV ;set counts for sites that are not integrated
"RTN","QACGEN",144,0)
 S ^TMP("QACGEN",$J,QACHD_"^"_QACHDIEN)=$G(^TMP("QACGEN",$J,QACHD_"^"_QACHDIEN))+1
"RTN","QACGEN",145,0)
 S ^TMP("QACGEN",$J,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN)=$G(^TMP("QACGEN",$J,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN))+1
"RTN","QACGEN",146,0)
 Q
"RTN","QACGEN",147,0)
YESDIV ;set counts for sites that have integrated
"RTN","QACGEN",148,0)
 S ^TMP("QACGEN",$J,QACDIV,QACHD_"^"_QACHDIEN)=$G(^TMP("QACGEN",$J,QACDIV,QACHD_"^"_QACHDIEN))+1
"RTN","QACGEN",149,0)
 S ^TMP("QACGEN",$J,QACDIV,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN)=$G(^TMP("QACGEN",$J,QACDIV,QACHD_"^"_QACHDIEN,QACICODE_"^"_QACCIEN))+1
"RTN","QACGEN",150,0)
 S ^TMP("QACGEN",$J,QACDIV)=$G(^TMP("QACGEN",$J,QACDIV))+1
"RTN","QACGEN",151,0)
 Q
"RTN","QACNOPTS")
0^12^B1165577
"RTN","QACNOPTS",1,0)
QACNOPTS ;HISC/VAD -Contact records without patients ;12/29/98  09:41
"RTN","QACNOPTS",2,0)
 ;;2.0;Patient Representative;**9**;11/17/1998
"RTN","QACNOPTS",3,0)
MAIN ;
"RTN","QACNOPTS",4,0)
 S QAQPOP=0
"RTN","QACNOPTS",5,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACNOPTS",6,0)
 K DIC,FLDS,L,BY,FR,TO,DHD
"RTN","QACNOPTS",7,0)
 S L=0,DIC="^QA(745.1,"
"RTN","QACNOPTS",8,0)
 S FLDS=".01,1",DHD="[QAC NOPAT HEADER]"
"RTN","QACNOPTS",9,0)
 ;
"RTN","QACNOPTS",10,0)
 ; report is not by division
"RTN","QACNOPTS",11,0)
 I +$G(QACDV)'=1 D
"RTN","QACNOPTS",12,0)
 . S BY="'2,1"
"RTN","QACNOPTS",13,0)
 . S FR(1)="@",TO(1)="@"
"RTN","QACNOPTS",14,0)
 . S FR(2)=QAQNBEG,TO(2)=QAQNEND
"RTN","QACNOPTS",15,0)
 ;
"RTN","QACNOPTS",16,0)
 ; report is by division
"RTN","QACNOPTS",17,0)
 I +$G(QACDV)=1 D
"RTN","QACNOPTS",18,0)
 . S BY="37;S3;C25,'2,1"
"RTN","QACNOPTS",19,0)
 . S FR(1)="@",TO(1)=""
"RTN","QACNOPTS",20,0)
 . I +$G(QAC1DIV) D
"RTN","QACNOPTS",21,0)
 . . S QACDVNAM="" D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACNOPTS",22,0)
 . . S (FR(1),TO(1))=QACDVNAM
"RTN","QACNOPTS",23,0)
 . S FR(2)="@",TO(2)="@"
"RTN","QACNOPTS",24,0)
 . S FR(3)=QAQNBEG,TO(3)=QAQNEND
"RTN","QACNOPTS",25,0)
 D EN1^DIP
"RTN","QACNOPTS",26,0)
EXIT ;
"RTN","QACNOPTS",27,0)
 K DIC,FLDS,L,BY,FR,TO,DHD,DIP,QACPOP,QACDV,QAC1DIV,QACDVNAM
"RTN","QACNOPTS",28,0)
 K QAQNBEG,QAQNEND,QAQPOP
"RTN","QACNOPTS",29,0)
 D K^QAQDATE
"RTN","QACNOPTS",30,0)
 Q
"RTN","QACOPEN")
0^13^B1193071
"RTN","QACOPEN",1,0)
QACOPEN ;WCIOFO/VAD-Open Status ;12/08/98
"RTN","QACOPEN",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACOPEN",3,0)
 ;
"RTN","QACOPEN",4,0)
MAIN ;
"RTN","QACOPEN",5,0)
 S QAQPOP=0
"RTN","QACOPEN",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACOPEN",7,0)
 K DIC,FLDS,L,BY,FR,TO,DHD
"RTN","QACOPEN",8,0)
 S L=0,DIC="^QA(745.1,"
"RTN","QACOPEN",9,0)
 S FLDS="[QAC STATUS]",DHD="[QAC STATUS HEADER]"
"RTN","QACOPEN",10,0)
 ;
"RTN","QACOPEN",11,0)
 ; report is not by division
"RTN","QACOPEN",12,0)
 I +$G(QACDV)'=1 D
"RTN","QACOPEN",13,0)
 . S BY="'1,@27"
"RTN","QACOPEN",14,0)
 . S FR(1)=QAQNBEG,TO(1)=QAQNEND
"RTN","QACOPEN",15,0)
 . S (FR(2),TO(2))="O"
"RTN","QACOPEN",16,0)
 ;
"RTN","QACOPEN",17,0)
 ; report is by division
"RTN","QACOPEN",18,0)
 I +$G(QACDV)=1 D
"RTN","QACOPEN",19,0)
 . S BY="37;S3;C25,'1,@27"
"RTN","QACOPEN",20,0)
 . S FR(1)="@",TO(1)=""
"RTN","QACOPEN",21,0)
 . I +$G(QAC1DIV) D
"RTN","QACOPEN",22,0)
 . . S QACDVNAM=""
"RTN","QACOPEN",23,0)
 . . D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACOPEN",24,0)
 . . S (FR(1),TO(1))=QACDVNAM
"RTN","QACOPEN",25,0)
 . S FR(2)=QAQNBEG,TO(2)=QAQNEND
"RTN","QACOPEN",26,0)
 . S (FR(3),TO(3))="O"
"RTN","QACOPEN",27,0)
 D EN1^DIP
"RTN","QACOPEN",28,0)
EXIT ;
"RTN","QACOPEN",29,0)
 K DIC,FLDS,L,BY,FR,TO,DHD,DIP,QACDV,QAC1DIV,QAQPOP,QACDVNAM
"RTN","QACOPEN",30,0)
 K QAQNBEG,QAQNEND
"RTN","QACOPEN",31,0)
 D K^QAQDATE
"RTN","QACOPEN",32,0)
 Q
"RTN","QACRESP")
0^14^B1229122
"RTN","QACRESP",1,0)
QACRESP ;WCIOFO/ERC-Responses Due Report ;11/10/98
"RTN","QACRESP",2,0)
 ;;2.0;Patient Representative;**9**;07/25/1995
"RTN","QACRESP",3,0)
 ;
"RTN","QACRESP",4,0)
MAIN ;
"RTN","QACRESP",5,0)
 S QAQPOP=0
"RTN","QACRESP",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACRESP",7,0)
 K DIC,FLDS,L,BY,FR,TO,DHD
"RTN","QACRESP",8,0)
 S L=0,DIC="^QA(745.1,"
"RTN","QACRESP",9,0)
 S FLDS="[QAC RESP DUE]",DHD="[QAC RESP DUE HEADER]"
"RTN","QACRESP",10,0)
 ;
"RTN","QACRESP",11,0)
 ; report is not by division
"RTN","QACRESP",12,0)
 I +$G(QACDV)'=1 D
"RTN","QACRESP",13,0)
 . S BY="20.1;C30;S3,@27"
"RTN","QACRESP",14,0)
 . S FR(1)=QAQNBEG,TO(1)=QAQNEND
"RTN","QACRESP",15,0)
 . S (FR(2),TO(2))="O"
"RTN","QACRESP",16,0)
 ;
"RTN","QACRESP",17,0)
 ; report is by division
"RTN","QACRESP",18,0)
 I +$G(QACDV)=1 D
"RTN","QACRESP",19,0)
 . S BY="37;S3;C25,20.1;C30,@27"
"RTN","QACRESP",20,0)
 . S FR(1)="@",TO(1)=""
"RTN","QACRESP",21,0)
 . I +$G(QAC1DIV) D
"RTN","QACRESP",22,0)
 . . S QACDVNAM="" D INST^QACUTL0(QAC1DIV,.QACDVNAM)
"RTN","QACRESP",23,0)
 . . S (FR(1),TO(1))=QACDVNAM
"RTN","QACRESP",24,0)
 . S FR(2)=QAQNBEG,TO(2)=QAQNEND
"RTN","QACRESP",25,0)
 . S (FR(3),TO(3))="O"
"RTN","QACRESP",26,0)
 D EN1^DIP
"RTN","QACRESP",27,0)
EXIT ;
"RTN","QACRESP",28,0)
 K DIC,FLDS,L,BY,FR,TO,DHD,QACDV,QAC1DIV,QAQPOP,QACDVNAM
"RTN","QACRESP",29,0)
 K QAQNBEG,QAQNEND
"RTN","QACRESP",30,0)
 D K^QAQDATE
"RTN","QACRESP",31,0)
 Q
"RTN","QACRPT")
0^20^B24419566
"RTN","QACRPT",1,0)
QACRPT ;HISC/RS,CEW - Print report of contact ;1/17/95  13:06
"RTN","QACRPT",2,0)
 ;;2.0;Patient Representative;**3,5,6,9**;07/25/1995
"RTN","QACRPT",3,0)
 K DIC
"RTN","QACRPT",4,0)
 N QACAUTH S QACAUTH=0
"RTN","QACRPT",5,0)
 S DIC="^QA(745.1,",DIC(0)="AEMQZ",DIC("A")="Enter the Contact you wish to generate: "
"RTN","QACRPT",6,0)
 ;see if user has QAC EDIT security key, or initially entered the ROC
"RTN","QACRPT",7,0)
 I $D(^XUSEC("QAC EDIT",DUZ))#2 S QACAUTH=1
"RTN","QACRPT",8,0)
 S DIC("S")="I $G(QACAUTH)!(DUZ=$P(^QA(745.1,+Y,0),U,7))"
"RTN","QACRPT",9,0)
 D ^DIC K DIC Q:Y<0  S QAC=+Y
"RTN","QACRPT",10,0)
 ;only holders of QAC EDIT security key may see Resolution Comments
"RTN","QACRPT",11,0)
 I $G(QACAUTH)=1 K DIR S DIR(0)="Y",DIR("B")="NO",DIR("A")="Do you want the Resolution Text included " D ^DIR K DIR Q:$D(DIRUT)  S QACRES=+Y D EN G QACRPT
"RTN","QACRPT",12,0)
EN K %ZIS,IOP S %ZIS="MQ"
"RTN","QACRPT",13,0)
 W ! D ^%ZIS G:POP QUIT
"RTN","QACRPT",14,0)
 I $D(IO("Q")) D  G QUIT
"RTN","QACRPT",15,0)
 . K IO("Q")
"RTN","QACRPT",16,0)
 . S ZTDESC="Report of Contact"
"RTN","QACRPT",17,0)
 . S ZTRTN="START^QACRPT"
"RTN","QACRPT",18,0)
 . S (ZTSAVE("QAC"),ZTSAVE("QACRES"))=""
"RTN","QACRPT",19,0)
 . D ^%ZTLOAD
"RTN","QACRPT",20,0)
START U IO
"RTN","QACRPT",21,0)
START1 ;called from QACALRT1 for screen display of ROC for alert
"RTN","QACRPT",22,0)
 S QACDA0=$G(^QA(745.1,QAC,0)),QACDA2=$G(^QA(745.1,QAC,2)),QACO=0
"RTN","QACRPT",23,0)
 S QACSTR="1,2,3,12,0,10,0,7,8,0,9,6,0,0",QACQUIT=0
"RTN","QACRPT",24,0)
 F J=1,2,3,12,8,9,6,4 S QACO($P(QACSTR,",",J))=$P(QACDA0,"^",J)
"RTN","QACRPT",25,0)
 I QACO(3)'="" S QACO(4)=$P($G(^DPT(QACO(3),0)),"^",9),QACO(3)=$P($G(^DPT(QACO(3),0)),"^",1)
"RTN","QACRPT",26,0)
 E  S QACO(4)=""
"RTN","QACRPT",27,0)
 S QACO(5)=$P(QACDA2,"^",2)
"RTN","QACRPT",28,0)
 S X1=$P(QACDA2,"^",4),X2=+$P(QACDA2,"^",5) I X1 D C^%DTC I X S Y=X X ^DD("DD") S QACO(9)=Y
"RTN","QACRPT",29,0)
 I $G(QACO(9))']"" S QACO(9)="    "
"RTN","QACRPT",30,0)
HEADING ;This is for the display of data
"RTN","QACRPT",31,0)
 W:$E(IOST)="C" @IOF
"RTN","QACRPT",32,0)
 W !!,"** This information is not for the Patient Record **"
"RTN","QACRPT",33,0)
 W !!,?28,"Report of Contact" S Y=DT D DD^%DT W ?60,"Date: ",Y,!
"RTN","QACRPT",34,0)
 S N1=0 F  S N1=$O(QACO(N1)) Q:N1=""  S QACDATA=QACO(N1) D
"RTN","QACRPT",35,0)
 .S FLD=N1*10\1,TEXT=$P($T(@FLD),";;",2),TAB=$P(TEXT,"^"),LINE=$P(TEXT,"^",2),CODE=$P(TEXT,"^",3,99)
"RTN","QACRPT",36,0)
 .W:TAB=0 !
"RTN","QACRPT",37,0)
 .W ?TAB,LINE
"RTN","QACRPT",38,0)
 .X CODE
"RTN","QACRPT",39,0)
 .Q
"RTN","QACRPT",40,0)
 I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE G QUIT:QACQUIT
"RTN","QACRPT",41,0)
SOURCE ; Display either old Source of Contact field or new Sources(s) of
"RTN","QACRPT",42,0)
 ; Contact multiple field.
"RTN","QACRPT",43,0)
 N JJ,QACSOUR,QACSOURC
"RTN","QACRPT",44,0)
 W ?45,"Source of Contact:"
"RTN","QACRPT",45,0)
 S QACSOUR=$P($G(^QA(745.1,QAC,0)),U,11)
"RTN","QACRPT",46,0)
 I $G(QACSOUR)]"" D
"RTN","QACRPT",47,0)
 . W $S(QACSOUR="L":"Letter",QACSOUR="W":"Ward Visit",QACSOUR="V":"Visit",QACSOUR="P":"Phone",1:"")
"RTN","QACRPT",48,0)
 I $D(^QA(745.1,QAC,12,0)) D
"RTN","QACRPT",49,0)
 . S JJ=0
"RTN","QACRPT",50,0)
 . F  S JJ=$O(^QA(745.1,QAC,12,JJ)) Q:JJ'>0  D
"RTN","QACRPT",51,0)
 . . S QACSOURC=^QA(745.1,QAC,12,JJ,0)
"RTN","QACRPT",52,0)
 . . W ?63,$S(QACSOURC="L":"Letter",QACSOURC="W":"Ward Visit",QACSOURC="V":"Visit",QACSOURC="P":"Phone",QACSOURC="I":"Internet",1:""),!
"RTN","QACRPT",53,0)
REFER S QACO(12)=0
"RTN","QACRPT",54,0)
 W !,"Refer To:" F  S QACO(12)=$O(^QA(745.1,QAC,11,QACO(12))) Q:QACO(12)'>0  D
"RTN","QACRPT",55,0)
 . S QACREFER=$P($G(^QA(745.1,QAC,11,QACO(12),0)),U,1)
"RTN","QACRPT",56,0)
 . W ?19,$P($G(^VA(200,QACREFER,0)),U,1),!
"RTN","QACRPT",57,0)
WORDP1 G WORDP2:'$D(^QA(745.1,QAC,4,0))!(QACQUIT)
"RTN","QACRPT",58,0)
 W !!,"Issue Text:" K ^UTILITY($J,"W") S DIWL=4,DIWR=75,DIWF=""
"RTN","QACRPT",59,0)
 F N1=0:0 S N1=$O(^QA(745.1,QAC,4,N1)) Q:N1'>0  S X=^QA(745.1,QAC,4,N1,0) D ^DIWP
"RTN","QACRPT",60,0)
 F N1=0:0 S N1=$O(^UTILITY($J,"W",DIWL,N1)) Q:N1'>0!QACQUIT  D
"RTN","QACRPT",61,0)
 .W !,?3,^UTILITY($J,"W",DIWL,N1,0) I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE Q:QACQUIT  D HEAD
"RTN","QACRPT",62,0)
WORDP2 G QUIT:'$D(^QA(745.1,QAC,6,0))!(QACQUIT)!($G(QACRES)'=1)
"RTN","QACRPT",63,0)
 W !!,"Resolution:" K ^UTILITY($J,"W") S DIWL=4,DIWR=75,DIWF=""
"RTN","QACRPT",64,0)
 F N1=0:0 S N1=$O(^QA(745.1,QAC,6,N1)) Q:N1'>0  S X=^QA(745.1,QAC,6,N1,0) D ^DIWP
"RTN","QACRPT",65,0)
 F N1=0:0 S N1=$O(^UTILITY($J,"W",DIWL,N1)) Q:N1'>0!QACQUIT  D
"RTN","QACRPT",66,0)
 .W !,?3,^UTILITY($J,"W",DIWL,N1,0) I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE Q:QACQUIT  D HEAD
"RTN","QACRPT",67,0)
QUIT W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACRPT",68,0)
 K ^UTILITY($J),DIR,DIC,DIWF,DIWL,DIWR,CODE,N1,POP,QAC,QACO,QACDA0
"RTN","QACRPT",69,0)
 K QACDA2,QACDATA,QACSTR,QACIS,QACQUIT,TEXT,TAB,LINE,FLD,N1,N2,J,X,Y
"RTN","QACRPT",70,0)
 K ZTDESC,ZTRTN,ZTSAVE,%ZIS,%,C,QACRES,%DTC,X1,Y1,X2,QACREFER,DIRUT
"RTN","QACRPT",71,0)
 Q
"RTN","QACRPT",72,0)
PAUSE ;
"RTN","QACRPT",73,0)
 W !! K DIR S DIR(0)="E" D ^DIR S QACQUIT=$S(Y'>0:1,1:0)
"RTN","QACRPT",74,0)
 Q
"RTN","QACRPT",75,0)
HEAD ;
"RTN","QACRPT",76,0)
 W @IOF,!!,"** This information is not for the Patient Record **"
"RTN","QACRPT",77,0)
 W !!,?20,"Report of Contact continued" S Y=DT D DD^%DT W ?60,"Date: ",Y,!
"RTN","QACRPT",78,0)
 F N2=1:1:4 S:$D(QACO(N2)) QACDATA=QACO(N2) D
"RTN","QACRPT",79,0)
 .I QACDATA="" W !! Q
"RTN","QACRPT",80,0)
 .S FLD=N2*10\1,TEXT=$P($T(@FLD),";;",2),TAB=$P(TEXT,"^"),LINE=$P(TEXT,"^",2),CODE=$P(TEXT,"^",3,99)
"RTN","QACRPT",81,0)
 .W:TAB=0 !
"RTN","QACRPT",82,0)
 .W ?TAB,LINE
"RTN","QACRPT",83,0)
 .X CODE
"RTN","QACRPT",84,0)
 .Q
"RTN","QACRPT",85,0)
 W !! Q
"RTN","QACRPT",86,0)
TEXT ;
"RTN","QACRPT",87,0)
10 ;;0^Contact Number:^W ?19,QACDATA
"RTN","QACRPT",88,0)
20 ;;45^Date of Contact:^S Y=QACDATA D DD^%DT S QACDATA=Y W ?63,QACDATA
"RTN","QACRPT",89,0)
30 ;;0^Patient Name:^W ?19,QACDATA
"RTN","QACRPT",90,0)
40 ;;45^Patient SSN:^W ?63,QACDATA
"RTN","QACRPT",91,0)
50 ;;0^Treatment Status:^W ?19,$S(QACDATA="I":"Inpatient",QACDATA="O":"Outpatient",QACDATA="D":"Domiciliary",QACDATA="N":"NHCU",QACDATA="L":"Long Term Psych",QACDATA="E":"Extended/Intermediate Care",QACDATA="H":"HBHC",1:"")
"RTN","QACRPT",92,0)
60 ;;45^Location of Event:^W ?63,$P($G(^SC(+QACDATA,0)),"^",1)
"RTN","QACRPT",93,0)
70 ;;0^Name of Contact:^W ?19,QACDATA
"RTN","QACRPT",94,0)
80 ;;45^Phone of Contact:^W ?63,QACDATA
"RTN","QACRPT",95,0)
90 ;;0^Date Due:^W ?19,QACDATA
"RTN","QACRPT",96,0)
100 ;;45^Info taken by:^W ?63,$P($G(^VA(200,+QACDATA,0)),"^",1)
"RTN","QACRPT",97,0)
120 ;;0^Elig. Status:^W ?19,$G(QACDATA)
"RTN","QACSPRD")
0^15^B8490851
"RTN","QACSPRD",1,0)
QACSPRD ;HISC/CEW - Spreadsheet reports ;7/17/95  11:04
"RTN","QACSPRD",2,0)
 ;;2.0;Patient Representative;**3,9**;07/25/1995
"RTN","QACSPRD",3,0)
DATE ;
"RTN","QACSPRD",4,0)
 N QACIFLG,QACXFLG
"RTN","QACSPRD",5,0)
 S QAQPOP=0
"RTN","QACSPRD",6,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT
"RTN","QACSPRD",7,0)
BEGIN ;
"RTN","QACSPRD",8,0)
 K DIR
"RTN","QACSPRD",9,0)
 S DIR(0)="NA^1:13"
"RTN","QACSPRD",10,0)
 W !!?5,"1   Contact made by (#C)",!?5,"2   Issue Headers (#I)",!?5,"3   Issues"
"RTN","QACSPRD",11,0)
 W !?5,"4   Location (#I)"
"RTN","QACSPRD",12,0)
 W !?5,"5   Service (Old field - Service field de-activated 10/97 - #I)"
"RTN","QACSPRD",13,0)
 W !?5,"6   Service/Discipline (#I)",!?5,"7   Sex (#I)"
"RTN","QACSPRD",14,0)
 W !?5,"8   Contact Source (#C)",!?5,"9   Treatment Status (#C)"
"RTN","QACSPRD",15,0)
 W !?5,"10  Treatment Status (#I)",!?5,"11  Discipline (#I)"
"RTN","QACSPRD",16,0)
 W !?5,"12  Division (#C)",!?5,"13  Division (#I)",!!
"RTN","QACSPRD",17,0)
 S DIR("A")="Print Spreadsheet Totals for: "
"RTN","QACSPRD",18,0)
 S DIR("?")="     Select the number or item you want totalled."
"RTN","QACSPRD",19,0)
 S DIR("?",1)="     #I means total is by Issues. #C means total is by Contacts."
"RTN","QACSPRD",20,0)
 S DIR("?",2)="     Enter ""^"" or <RET> to exit."
"RTN","QACSPRD",21,0)
 D ^DIR K DIR G:$D(DIRUT)!$D(DIROUT) EXIT S QACITEM=Y
"RTN","QACSPRD",22,0)
 K COUNT,QACPCE,QACLABEL,QACDIV
"RTN","QACSPRD",23,0)
 N QACRTN
"RTN","QACSPRD",24,0)
 I QACITEM=1 D CONTACT^QACSPRD1
"RTN","QACSPRD",25,0)
 I QACITEM=2 D HEAD^QACSPRD3
"RTN","QACSPRD",26,0)
 I QACITEM=3 D CODE^QACSPRD2
"RTN","QACSPRD",27,0)
 I QACITEM=4 D LOC^QACSPRD2
"RTN","QACSPRD",28,0)
 I QACITEM=5 D SERVICE^QACSPRD2
"RTN","QACSPRD",29,0)
 I QACITEM=6 D SRVDS^QACSPRD3
"RTN","QACSPRD",30,0)
 I QACITEM=7 D SEX^QACSPRD3
"RTN","QACSPRD",31,0)
 I QACITEM=8 D SOURCE^QACSPRD1
"RTN","QACSPRD",32,0)
 I QACITEM=9 D TREATC^QACSPRD1
"RTN","QACSPRD",33,0)
 I QACITEM=10 D TREATI^QACSPRD1
"RTN","QACSPRD",34,0)
 I QACITEM=11 D DISC^QACSPRD2
"RTN","QACSPRD",35,0)
 I QACITEM=12 D DIVC^QACSPRD3
"RTN","QACSPRD",36,0)
 I QACITEM=13 D DIVI^QACSPRD3
"RTN","QACSPRD",37,0)
 K DIR S DIR(0)="E" D ^DIR G EXIT:$D(DIRUT),DATE
"RTN","QACSPRD",38,0)
EXIT ;
"RTN","QACSPRD",39,0)
 K DIR,DIROUT,DIRUT,POP,Y
"RTN","QACSPRD",40,0)
 K QAC1DIV,QACDT,QACITEM,QACNUM,QACPOP,QAQPOP,QACWW
"RTN","QACSPRD",41,0)
 D K^QAQDATE
"RTN","QACSPRD",42,0)
 Q
"RTN","QACSPRD",43,0)
LOOP1(ROU,NBEG,NEND,QACD0) ;loop through #745.1 within the date range
"RTN","QACSPRD",44,0)
 S QACDT=NBEG-.0000001 F  S QACDT=$O(^QA(745.1,"D",QACDT)) Q:(QACDT'>0)!(QACDT>NEND)!(QACDT\1'?7N)  D
"RTN","QACSPRD",45,0)
 . S QACD0=0 F  S QACD0=$O(^QA(745.1,"D",QACDT,QACD0)) Q:QACD0'>0  D
"RTN","QACSPRD",46,0)
 . . S QACDIV=$P(^QA(745.1,QACD0,0),U,16)
"RTN","QACSPRD",47,0)
 . . I $G(QACDIV)']"" S QACDIV=0
"RTN","QACSPRD",48,0)
 . . S QACWW=""
"RTN","QACSPRD",49,0)
 . . I $O(^QA(740,1,"QAC2","B",QACDIV,QACWW))']"" S QACDIV=0
"RTN","QACSPRD",50,0)
 . . I $G(QAC1DIV)]"" I $G(QACDIV)=$G(QAC1DIV) D @ROU
"RTN","QACSPRD",51,0)
 . . I $G(QAC1DIV)']"" D @ROU
"RTN","QACSPRD",52,0)
 Q
"RTN","QACSPRD",53,0)
ZIS1(ZTRTN,DESC,XFLG) ;subroutine sets up and calls ^%ZIS and ^%ZTLOAD
"RTN","QACSPRD",54,0)
 K QACXFLG
"RTN","QACSPRD",55,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS I POP S QACPOP=1 Q
"RTN","QACSPRD",56,0)
 I $D(IO("Q")) D
"RTN","QACSPRD",57,0)
 . S (ZTSAVE("QAQNBEG"),ZTSAVE("QAQNEND"))=""
"RTN","QACSPRD",58,0)
 . S (ZTSAVE("QAC1DIV"),ZTSAVE("QACDIV"),ZTSAVE("QAQPOP"))=""
"RTN","QACSPRD",59,0)
 . S ZTSAVE("QACTITLE")=""
"RTN","QACSPRD",60,0)
 . I $G(QACIFLG)=1 K ^TMP("QACSPRD2",$J)
"RTN","QACSPRD",61,0)
 . I $G(QACIFLG)=1 S (ZTSAVE("^TMP(""QACSPRD2"",$J,"),ZTSAVE("QACODE"))=""
"RTN","QACSPRD",62,0)
 . S ZTDESC="Patient Rep "_DESC_"Spreadsheet Report"
"RTN","QACSPRD",63,0)
 . D ^%ZTLOAD S QACXFLG=1
"RTN","QACSPRD",64,0)
 Q
"RTN","QACSPRD1")
0^16^B25998059
"RTN","QACSPRD1",1,0)
QACSPRD1 ;HINES/CEW - Spreadsheet report selections ;1/12/99
"RTN","QACSPRD1",2,0)
 ;;2.0;Patient Representative;**3,9**;07/25/1995
"RTN","QACSPRD1",3,0)
CONTACT ;
"RTN","QACSPRD1",4,0)
 ;Sub-routine to count total number of contacts for Contact Made By
"RTN","QACSPRD1",5,0)
 S QACRTN="CONTSK^QACSPRD1",QACTITLE="Contact Made by "
"RTN","QACSPRD1",6,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD1",7,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD1",8,0)
CONTSK ;
"RTN","QACSPRD1",9,0)
 S QACROU="CONTSK1^QACSPRD1"
"RTN","QACSPRD1",10,0)
 S QACFLD=12
"RTN","QACSPRD1",11,0)
 D TSK
"RTN","QACSPRD1",12,0)
 Q
"RTN","QACSPRD1",13,0)
CONTSK1 ;
"RTN","QACSPRD1",14,0)
 K QACENTRY
"RTN","QACSPRD1",15,0)
 S QACENTRY=$P(^QA(745.1,QACD0,0),U,10) Q:$G(QACENTRY)']""
"RTN","QACSPRD1",16,0)
 D TALL(QACENTRY)
"RTN","QACSPRD1",17,0)
 Q
"RTN","QACSPRD1",18,0)
SOURCE ;
"RTN","QACSPRD1",19,0)
 ;Sub-routine to count total number of contacts for Source
"RTN","QACSPRD1",20,0)
 S QACRTN="SOURTSK^QACSPRD1",QACTITLE="Source of Contact "
"RTN","QACSPRD1",21,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD1",22,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD1",23,0)
SOURTSK ;
"RTN","QACSPRD1",24,0)
 S QACROU="SOURTSK1^QACSPRD1"
"RTN","QACSPRD1",25,0)
 S QACFLD=13 D QACSET(QACFLD)
"RTN","QACSPRD1",26,0)
 D TSK
"RTN","QACSPRD1",27,0)
 Q
"RTN","QACSPRD1",28,0)
SOURTSK1 ;
"RTN","QACSPRD1",29,0)
 K QACENTRY
"RTN","QACSPRD1",30,0)
 S QACENTRY=$P(^QA(745.1,QACD0,0),U,11)
"RTN","QACSPRD1",31,0)
 I $G(QACENTRY)]"" D TALL(QACENTRY)
"RTN","QACSPRD1",32,0)
 I $G(QACENTRY)']"" D
"RTN","QACSPRD1",33,0)
 . S QACEE=0
"RTN","QACSPRD1",34,0)
 . F  S QACEE=$O(^QA(745.1,QACD0,12,QACEE)) Q:QACEE'>0  D
"RTN","QACSPRD1",35,0)
 . . S QACENTRY=$G(^QA(745.1,QACD0,12,QACEE,0))
"RTN","QACSPRD1",36,0)
 . . I $G(QACENTRY)]"" D TALL(QACENTRY)
"RTN","QACSPRD1",37,0)
 Q
"RTN","QACSPRD1",38,0)
TREATC ;
"RTN","QACSPRD1",39,0)
 ;Sub-routine to count total number of contacts for Treatment Status
"RTN","QACSPRD1",40,0)
 S QACRTN="TRTCTSK^QACSPRD1",QACTITLE="Contact Numbers by Treatment Status "
"RTN","QACSPRD1",41,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD1",42,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD1",43,0)
TRTCTSK ;
"RTN","QACSPRD1",44,0)
 S QACROU="TRTCTSK1^QACSPRD1"
"RTN","QACSPRD1",45,0)
 S QACFLD=16.5
"RTN","QACSPRD1",46,0)
 D TSK
"RTN","QACSPRD1",47,0)
 Q
"RTN","QACSPRD1",48,0)
TRTCTSK1 ;
"RTN","QACSPRD1",49,0)
 K QACENTRY
"RTN","QACSPRD1",50,0)
 I $G(^QA(745.1,QACD0,2))]"" S QACENTRY=$P(^QA(745.1,QACD0,2),U,2) Q:$G(QACENTRY)']""
"RTN","QACSPRD1",51,0)
 I $G(QACENTRY)]"" D TALL(QACENTRY)
"RTN","QACSPRD1",52,0)
 Q
"RTN","QACSPRD1",53,0)
TREATI ;
"RTN","QACSPRD1",54,0)
 ;Sub-routine to count total number of issues for Treatment Status
"RTN","QACSPRD1",55,0)
 S QACRTN="TRTITSK^QACSPRD1",QACTITLE="Issue Code by Treatment Status "
"RTN","QACSPRD1",56,0)
 S ZTSAVE("QACENTRY")=""
"RTN","QACSPRD1",57,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACD0) G:$G(QACPOP) EXIT
"RTN","QACSPRD1",58,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD1",59,0)
TRTITSK ;
"RTN","QACSPRD1",60,0)
 S QACROU="TRTITSK1^QACSPRD1"
"RTN","QACSPRD1",61,0)
 S QACFLD=16.5
"RTN","QACSPRD1",62,0)
 D TSK
"RTN","QACSPRD1",63,0)
 Q
"RTN","QACSPRD1",64,0)
TRTITSK1 ;
"RTN","QACSPRD1",65,0)
 K QACENTRY
"RTN","QACSPRD1",66,0)
 I $G(^QA(745.1,QACD0,2))]"" S QACENTRY=$P(^QA(745.1,QACD0,2),U,2) Q:$G(QACENTRY)']""
"RTN","QACSPRD1",67,0)
 S QACEE=0
"RTN","QACSPRD1",68,0)
 F  S QACEE=$O(^QA(745.1,QACD0,3,QACEE)) Q:QACEE'>0  D
"RTN","QACSPRD1",69,0)
 . I $G(QACENTRY)]"" D TALL(QACENTRY)
"RTN","QACSPRD1",70,0)
 Q
"RTN","QACSPRD1",71,0)
EXIT ;
"RTN","QACSPRD1",72,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACSPRD1",73,0)
 K %ZIS,IOP,POP,ZTSAVE,ZTDESC,ZTRTN,ZTSK,QACSOUR
"RTN","QACSPRD1",74,0)
 K BB,COUNT,DDD,EE,MM,RR
"RTN","QACSPRD1",75,0)
 K QAC1DIV,QAC,QACAA,QACBEG,QACCMB,QACCNT,QACD0,QACDT,QACDIV,QACDV
"RTN","QACSPRD1",76,0)
 K QACEE,QACEND,QACIFLG,QACISSUE,QACLABEL,QACNODE,QACPCE,QACPOP,QACROU
"RTN","QACSPRD1",77,0)
 K QACRTN,QACTR,QACXFLG,QACY7E,QACYES
"RTN","QACSPRD1",78,0)
 K QAQNBEG,QAQNEND
"RTN","QACSPRD1",79,0)
 Q
"RTN","QACSPRD1",80,0)
QACSET(QACFLD,QACENTRY,QACTITLE) ;subroutines to set up counters for 
"RTN","QACSPRD1",81,0)
 ; fields that are sets of codes
"RTN","QACSPRD1",82,0)
 S QACCNT=0
"RTN","QACSPRD1",83,0)
 S QACNODE=$P(^DD(745.1,QACFLD,0),U,3)
"RTN","QACSPRD1",84,0)
 F QACEE=1:1  S QACPCE(QACEE)=$P(QACNODE,";",QACEE) Q:$G(QACPCE(QACEE))']""  S QACCNT=QACCNT+1
"RTN","QACSPRD1",85,0)
 F QACEE=1:1:QACCNT  D
"RTN","QACSPRD1",86,0)
 . S QACLABEL(QACEE)=$P(QACPCE(QACEE),":",2)
"RTN","QACSPRD1",87,0)
 . S QACPCE(QACEE)=$P(QACPCE(QACEE),":",1)
"RTN","QACSPRD1",88,0)
 I '$D(QAC1DIV) D SET2 Q
"RTN","QACSPRD1",89,0)
SET1 ;multidivisional
"RTN","QACSPRD1",90,0)
 I $D(QAC1DIV) D
"RTN","QACSPRD1",91,0)
 . I $G(QAC1DIV)']"" D
"RTN","QACSPRD1",92,0)
 . . S RR=0 F  S RR=$O(^QA(740,1,"QAC2",RR)) Q:RR'>0  D
"RTN","QACSPRD1",93,0)
 . . . S QACDIV(RR)=^QA(740,1,"QAC2",RR,0)
"RTN","QACSPRD1",94,0)
 . . . D SET2
"RTN","QACSPRD1",95,0)
 . I $G(QAC1DIV)]"" D
"RTN","QACSPRD1",96,0)
 . . S RR=1,QACDIV(RR)=QAC1DIV
"RTN","QACSPRD1",97,0)
 . . D SET2
"RTN","QACSPRD1",98,0)
 Q
"RTN","QACSPRD1",99,0)
SET2 ;for each division or not multi-divisional, initialize counts
"RTN","QACSPRD1",100,0)
 S EE=0 F  S EE=$O(QACPCE(EE)) Q:$G(QACPCE(EE))']""  D
"RTN","QACSPRD1",101,0)
 . S QAC=QACPCE(EE)
"RTN","QACSPRD1",102,0)
 . I '$D(QAC1DIV) S COUNT(QAC)=0
"RTN","QACSPRD1",103,0)
 . I $D(QAC1DIV) S COUNT(QACDIV(RR),QACPCE(EE))=0
"RTN","QACSPRD1",104,0)
 Q
"RTN","QACSPRD1",105,0)
SET3 ;muti-divisional, but entry has no division, initialize counts
"RTN","QACSPRD1",106,0)
 S MM="" I $O(QACDIV(MM))>0 D
"RTN","QACSPRD1",107,0)
 . S QACDIV(0)=0
"RTN","QACSPRD1",108,0)
 . S BB=0 F  S BB=$O(QACPCE(BB)) Q:BB>QACCNT  D
"RTN","QACSPRD1",109,0)
 . . S COUNT(0,QACPCE(BB))=0
"RTN","QACSPRD1",110,0)
 S EE=0 F  S EE=$O(QACPCE(EE)) Q:$G(QACPCE(EE))']""  I QACENTRY=QACPCE(EE) D
"RTN","QACSPRD1",111,0)
 . ;S COUNT(QACDIV,QACPCE(EE))=$G(COUNT(QACDIV,QACPCE(EE)))+1
"RTN","QACSPRD1",112,0)
 . S EE=QACCNT
"RTN","QACSPRD1",113,0)
 Q
"RTN","QACSPRD1",114,0)
TALL(QACENTRY) ;tally the entry
"RTN","QACSPRD1",115,0)
 S (QACAA,QACYES)=0
"RTN","QACSPRD1",116,0)
 F  S QACAA=$O(QACDIV(QACAA)) Q:QACAA'>0  D
"RTN","QACSPRD1",117,0)
 . I QACDIV=QACDIV(QACAA) S QACYES=1
"RTN","QACSPRD1",118,0)
 I $G(QACYES)'=1 S QACDIV=0
"RTN","QACSPRD1",119,0)
 I $G(QACDIV)=0 S RR=0 D SET3
"RTN","QACSPRD1",120,0)
 S EE=0 F  S EE=$O(QACPCE(EE)) Q:EE>QACCNT  I QACENTRY=QACPCE(EE) D
"RTN","QACSPRD1",121,0)
 . I '$D(QAC1DIV) S COUNT(QACPCE(EE))=COUNT(QACPCE(EE))+1
"RTN","QACSPRD1",122,0)
 . I $D(QAC1DIV) S COUNT(QACDIV,QACPCE(EE))=COUNT(QACDIV,QACPCE(EE))+1
"RTN","QACSPRD1",123,0)
 . S EE=QACCNT
"RTN","QACSPRD1",124,0)
 Q
"RTN","QACSPRD1",125,0)
WRIT ;output
"RTN","QACSPRD1",126,0)
 W:($E(IOST)="C")!($G(QACPFLG)=1) @IOF
"RTN","QACSPRD1",127,0)
 W !!?15,$G(QACTITLE)_"Spreadsheet Report"
"RTN","QACSPRD1",128,0)
 S Y=QAQNBEG D DD^%DT S QACBEG=Y
"RTN","QACSPRD1",129,0)
 S Y=QAQNEND D DD^%DT S QACEND=Y
"RTN","QACSPRD1",130,0)
 W !?20,"Date Range: "_QACBEG_" to "_QACEND
"RTN","QACSPRD1",131,0)
 W !
"RTN","QACSPRD1",132,0)
 I $G(QACIFLG)=1!($G(QACPFLG)=1) Q
"RTN","QACSPRD1",133,0)
 I '$D(QAC1DIV) D WRIT2 Q
"RTN","QACSPRD1",134,0)
 I $D(QAC1DIV) D
"RTN","QACSPRD1",135,0)
 . S DDD=""
"RTN","QACSPRD1",136,0)
 . F  S DDD=$O(QACDIV(DDD)) Q:DDD']""  D
"RTN","QACSPRD1",137,0)
 . . I $G(DDD)>0 D INST^QACUTL0(QACDIV(DDD),.QACDV)
"RTN","QACSPRD1",138,0)
 . . W !!,"Division: "_$S(DDD=0:"Unknown",1:QACDV)
"RTN","QACSPRD1",139,0)
 . . D WRIT2
"RTN","QACSPRD1",140,0)
 Q
"RTN","QACSPRD1",141,0)
WRIT2 ;
"RTN","QACSPRD1",142,0)
 F EE=1:1:QACCNT D
"RTN","QACSPRD1",143,0)
 . W !,QACLABEL(EE)_", "_$S($D(QAC1DIV):COUNT(QACDIV(DDD),QACPCE(EE)),1:COUNT(QACPCE(EE)))
"RTN","QACSPRD1",144,0)
 . I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE^QACGEN S QACPFLG=1 D WRIT
"RTN","QACSPRD1",145,0)
 . K QACPFLG
"RTN","QACSPRD1",146,0)
 W !!
"RTN","QACSPRD1",147,0)
 Q
"RTN","QACSPRD1",148,0)
TSK ;
"RTN","QACSPRD1",149,0)
 U IO
"RTN","QACSPRD1",150,0)
 D QACSET(QACFLD)
"RTN","QACSPRD1",151,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACSPRD1",152,0)
 D WRIT
"RTN","QACSPRD1",153,0)
 D EXIT
"RTN","QACSPRD1",154,0)
 Q
"RTN","QACSPRD2")
0^17^B34035187
"RTN","QACSPRD2",1,0)
QACSPRD2 ;HINES/CEW - Spreadsheet report selections ;7/17/95  11:17
"RTN","QACSPRD2",2,0)
 ;;2.0;Patient Representative;**3,9**;07/25/1995
"RTN","QACSPRD2",3,0)
CODE ;
"RTN","QACSPRD2",4,0)
 ;Sub-routine to count total number of issues for each issue code
"RTN","QACSPRD2",5,0)
 S QACTITLE="Issue Code "
"RTN","QACSPRD2",6,0)
 S QACRTN="CODETSK^QACSPRD2"
"RTN","QACSPRD2",7,0)
 S QACIFLG=1
"RTN","QACSPRD2",8,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACD0) G:$G(QACPOP) EXIT
"RTN","QACSPRD2",9,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD2",10,0)
CODETSK ;
"RTN","QACSPRD2",11,0)
 ;Tasked entry point for CODE
"RTN","QACSPRD2",12,0)
 S QACROU="CODETSK1^QACSPRD2"
"RTN","QACSPRD2",13,0)
 D TSK
"RTN","QACSPRD2",14,0)
 Q
"RTN","QACSPRD2",15,0)
CODETSK1 ;
"RTN","QACSPRD2",16,0)
 D ICLOOP
"RTN","QACSPRD2",17,0)
 S QACRR=0
"RTN","QACSPRD2",18,0)
 F  S QACRR=$O(QACODE(QACRR)) Q:QACRR']""  D
"RTN","QACSPRD2",19,0)
 . I '$D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",20,0)
 . I $D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDIV,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",21,0)
 . Q
"RTN","QACSPRD2",22,0)
 Q
"RTN","QACSPRD2",23,0)
LOC ;
"RTN","QACSPRD2",24,0)
 ;Sub-routine to count total number of issues for Location of Event
"RTN","QACSPRD2",25,0)
 S QACTITLE="Location "
"RTN","QACSPRD2",26,0)
 S QACRTN="LOCTSK^QACSPRD2"
"RTN","QACSPRD2",27,0)
 S QACIFLG=1
"RTN","QACSPRD2",28,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACD0) G:$G(QACPOP) EXIT
"RTN","QACSPRD2",29,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD2",30,0)
LOCTSK ;
"RTN","QACSPRD2",31,0)
 ;Tasked entry point for LOC
"RTN","QACSPRD2",32,0)
 S QACROU="LOCTSK1^QACSPRD2"
"RTN","QACSPRD2",33,0)
 D TSK
"RTN","QACSPRD2",34,0)
 Q
"RTN","QACSPRD2",35,0)
LOCTSK1 ;
"RTN","QACSPRD2",36,0)
 D ICLOOP
"RTN","QACSPRD2",37,0)
 S QACLNUM=$P(^QA(745.1,QACD0,0),U,12) Q:QACLNUM=""  D
"RTN","QACSPRD2",38,0)
 . S QACLOC=$P($G(^SC(+QACLNUM,0)),U,1)
"RTN","QACSPRD2",39,0)
 Q:$G(QACLOC)']""
"RTN","QACSPRD2",40,0)
 S QACRR=0
"RTN","QACSPRD2",41,0)
 F  S QACRR=$O(QACODE(QACRR)) Q:QACRR']""  D
"RTN","QACSPRD2",42,0)
 . I '$D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACLOC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",43,0)
 . I $D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDIV,QACLOC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",44,0)
 . Q
"RTN","QACSPRD2",45,0)
 Q
"RTN","QACSPRD2",46,0)
SERVICE ;
"RTN","QACSPRD2",47,0)
 ;Sub-routine to count total number of issues for Service
"RTN","QACSPRD2",48,0)
 ;This field is the old service/section involved field, no longer used
"RTN","QACSPRD2",49,0)
 ;after 10/01/97.  Report is kept for records entered prior to that date.
"RTN","QACSPRD2",50,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS G:POP EXIT
"RTN","QACSPRD2",51,0)
 I $D(IO("Q")) D  G EXIT
"RTN","QACSPRD2",52,0)
 . S (ZTSAVE("QAQNBEG"),ZTSAVE("QAQNEND"))=""
"RTN","QACSPRD2",53,0)
 . S ZTSAVE("^TMP(""QACSPRD2"",$J,")=""
"RTN","QACSPRD2",54,0)
 . S ZTDESC="Patient Rep Service Spreadsheet"
"RTN","QACSPRD2",55,0)
 . S ZTRTN="SERVTSK^QACSPRD2" D ^%ZTLOAD
"RTN","QACSPRD2",56,0)
 . Q
"RTN","QACSPRD2",57,0)
SERVTSK ;
"RTN","QACSPRD2",58,0)
 ;Tasked entry point for SERVICE
"RTN","QACSPRD2",59,0)
 U IO
"RTN","QACSPRD2",60,0)
 S QACDT=QAQNBEG-.0000001 F  S QACDT=$O(^QA(745.1,"D",QACDT)) Q:(QACDT'>0)!(QACDT>QAQNEND)!(QACDT\1'?7N)  D
"RTN","QACSPRD2",61,0)
 . S QACD0=0 F  S QACD0=$O(^QA(745.1,"D",QACDT,QACD0)) Q:QACD0'>0  D
"RTN","QACSPRD2",62,0)
 .. Q:'$D(^QA(745.1,QACD0,3,0))
"RTN","QACSPRD2",63,0)
 .. S QACCN=0 F  S QACCN=$O(^QA(745.1,QACD0,3,QACCN)) Q:QACCN'>0  D
"RTN","QACSPRD2",64,0)
 ... S QACCIEN=$P($G(^QA(745.1,QACD0,3,QACCN,0)),U,1) Q:QACCIEN=""
"RTN","QACSPRD2",65,0)
 ... S QACICODE=$P($G(^QA(745.2,QACCIEN,0)),U,1) Q:QACICODE=""  D
"RTN","QACSPRD2",66,0)
 .... Q:'$D(^QA(745.1,QACD0,3,QACCN,1,0))
"RTN","QACSPRD2",67,0)
 .... S QACSIEN=0 F  S QACSIEN=$O(^QA(745.1,QACD0,3,QACCN,1,"B",QACSIEN)) Q:QACSIEN'>0  D
"RTN","QACSPRD2",68,0)
 ..... S QACSERV=$$EN4^QACUTIL(+QACSIEN)
"RTN","QACSPRD2",69,0)
 ..... S ^TMP("QACSPRD2",$J,QACSERV,QACICODE,QACD0)=""
"RTN","QACSPRD2",70,0)
 ..... Q
"RTN","QACSPRD2",71,0)
 .... Q
"RTN","QACSPRD2",72,0)
 ... Q
"RTN","QACSPRD2",73,0)
 .. Q
"RTN","QACSPRD2",74,0)
 . Q
"RTN","QACSPRD2",75,0)
 S QACSERV="" F  S QACSERV=$O(^TMP("QACSPRD2",$J,QACSERV)) Q:QACSERV=""  D
"RTN","QACSPRD2",76,0)
 . S QACICODE="",QACTOT=0 F  S QACICODE=$O(^TMP("QACSPRD2",$J,QACSERV,QACICODE)) Q:QACICODE=""  D
"RTN","QACSPRD2",77,0)
 .. S QACREC=0 F  S QACREC=$O(^TMP("QACSPRD2",$J,QACSERV,QACICODE,QACREC)) Q:QACREC'>0  D
"RTN","QACSPRD2",78,0)
 ... S QACTOT=QACTOT+1
"RTN","QACSPRD2",79,0)
 ... Q
"RTN","QACSPRD2",80,0)
 .. Q
"RTN","QACSPRD2",81,0)
 . W !,QACSERV_","_QACTOT
"RTN","QACSPRD2",82,0)
 . Q
"RTN","QACSPRD2",83,0)
 D EXIT
"RTN","QACSPRD2",84,0)
 Q
"RTN","QACSPRD2",85,0)
DISC ; Sub-routine to count total issue per discipline
"RTN","QACSPRD2",86,0)
 S QACTITLE="Discipline "
"RTN","QACSPRD2",87,0)
 S QACRTN="DISCTSK^QACSPRD2"
"RTN","QACSPRD2",88,0)
 S QACIFLG=1
"RTN","QACSPRD2",89,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACD0) G:$G(QACPOP) EXIT
"RTN","QACSPRD2",90,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD2",91,0)
DISCTSK ; Tasked entry point for DISCIPLINE
"RTN","QACSPRD2",92,0)
 S QACROU="DISCTSK1^QACSPRD2"
"RTN","QACSPRD2",93,0)
 D TSK
"RTN","QACSPRD2",94,0)
 Q
"RTN","QACSPRD2",95,0)
DISCTSK1 ;
"RTN","QACSPRD2",96,0)
 D ICLOOP
"RTN","QACSPRD2",97,0)
 ;Q:'$D(^QA(745.1,QACD0,3,QACCN,3,0))
"RTN","QACSPRD2",98,0)
 S QACRR=0
"RTN","QACSPRD2",99,0)
 F  S QACRR=$O(QACODE(QACRR)) Q:QACRR'>0  D
"RTN","QACSPRD2",100,0)
 . ;Q:'$D(^QA(745.1,QACD0,3,QACODE(QACRR),3,0))
"RTN","QACSPRD2",101,0)
 . S QACWW=0
"RTN","QACSPRD2",102,0)
 . F  S QACWW=$O(^QA(745.1,QACD0,3,QACCODE(QACRR),3,"B",QACWW)) Q:QACWW'>0  D
"RTN","QACSPRD2",103,0)
 . . S QACDIEN=$P(^QA(745.55,QACWW,0),U,3)
"RTN","QACSPRD2",104,0)
 . . S QACDISC=$$EN7^QACUTIL(+QACDIEN)
"RTN","QACSPRD2",105,0)
 . . I '$D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDISC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",106,0)
 . . I $D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDIV,QACDISC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD2",107,0)
 . . Q
"RTN","QACSPRD2",108,0)
 . Q
"RTN","QACSPRD2",109,0)
 Q
"RTN","QACSPRD2",110,0)
EXIT ;
"RTN","QACSPRD2",111,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACSPRD2",112,0)
 K ^TMP("QACSPRD2",$J),IOP,POP,ZTRTN,ZTSAVE,ZTDESC,%ZIS
"RTN","QACSPRD2",113,0)
 K COUNT,QAC1,QAC1DIV,QAC2,QAC3,QAC4,QACCIEN,QACCODE,QACCN,QACD0
"RTN","QACSPRD2",114,0)
 K QACDD,QACDIV,QACDIEN,QACDISC,QACDV,QACDNUM,QACDT,QACEE,QACICODE
"RTN","QACSPRD2",115,0)
 K QACIFLG,QACISSUE,QACLOC,QACLNUM,QACMM,QACNUM,QACPN,QACPOP,QACREC
"RTN","QACSPRD2",116,0)
 K QACROU,QACRR,QACRTN,QACSERV,QACSIEN,QACTITLE,QACTOT,QACWW,QACXFLG
"RTN","QACSPRD2",117,0)
 K QAQNBEG,QAQNEND
"RTN","QACSPRD2",118,0)
 Q
"RTN","QACSPRD2",119,0)
ICLOOP ;
"RTN","QACSPRD2",120,0)
 U IO
"RTN","QACSPRD2",121,0)
 K QACODE
"RTN","QACSPRD2",122,0)
 Q:'$D(^QA(745.1,QACD0,3,0))
"RTN","QACSPRD2",123,0)
 S QACEE=0 F  S QACEE=$O(^QA(745.1,QACD0,3,"B",QACEE)) Q:QACEE'>0  D
"RTN","QACSPRD2",124,0)
 . S QACODE(QACEE)=$P($G(^QA(745.2,QACEE,0)),U,1) I QACODE(QACEE)="" K QACODE(QACEE) Q
"RTN","QACSPRD2",125,0)
 . ;get the issue code IEN so that in DISCTSK1 can get the discpline
"RTN","QACSPRD2",126,0)
 . S QACMM=0 S QACMM=$O(^QA(745.1,QACD0,3,"B",QACEE,QACMM)) I $G(QACMM)>0 S QACCODE(QACEE)=QACMM
"RTN","QACSPRD2",127,0)
 Q
"RTN","QACSPRD2",128,0)
COUNT ;
"RTN","QACSPRD2",129,0)
 N QACCNT,QACCNT2,QACCNT3,QACCNT4,QACTOT
"RTN","QACSPRD2",130,0)
 S QAC1=""
"RTN","QACSPRD2",131,0)
 S (QACCNT2,QACCNT3,QACCNT4)=0
"RTN","QACSPRD2",132,0)
 F  S QAC1=$O(^TMP("QACSPRD2",$J,QAC1)) Q:QAC1']""  D
"RTN","QACSPRD2",133,0)
 . I $D(QAC1DIV) D
"RTN","QACSPRD2",134,0)
 . . I $G(QAC1)>0 D INST^QACUTL0(QAC1,.QACDV)
"RTN","QACSPRD2",135,0)
 . . W !!?5,"Division: "_$S(QAC1=0:"Unknown",1:QACDV)
"RTN","QACSPRD2",136,0)
 . S QAC2=""
"RTN","QACSPRD2",137,0)
 . F  S QAC2=$O(^TMP("QACSPRD2",$J,QAC1,QAC2)) Q:QAC2']""  D
"RTN","QACSPRD2",138,0)
 . . S QACCNT2=$G(QACCNT2)+1
"RTN","QACSPRD2",139,0)
 . . S QAC3=""
"RTN","QACSPRD2",140,0)
 . .; S QACTOT=0
"RTN","QACSPRD2",141,0)
 . . F  S QAC3=$O(^TMP("QACSPRD2",$J,QAC1,QAC2,QAC3)) Q:QAC3']""  D
"RTN","QACSPRD2",142,0)
 . . . S QACCNT3=$G(QACCNT3)+1
"RTN","QACSPRD2",143,0)
 . . . S QAC4=""
"RTN","QACSPRD2",144,0)
 . . . F  S QAC4=$O(^TMP("QACSPRD2",$J,QAC1,QAC2,QAC3,QAC4)) Q:QAC4']""  D
"RTN","QACSPRD2",145,0)
 . . . . S QACCNT4=$G(QACCNT4)+1
"RTN","QACSPRD2",146,0)
 . . I $D(QAC1DIV) W !,QAC2_", "_$S($G(QACCNT4)>0:QACCNT4,1:QACCNT3) S (QACCNT3,QACCNT4)=0
"RTN","QACSPRD2",147,0)
 . I '$D(QAC1DIV) W !?5,QAC1_", "_$S($G(QACCNT3)>0:QACCNT3,1:QACCNT2) S (QACCNT3,QACCNT2)=0
"RTN","QACSPRD2",148,0)
 ;. . S (QACCNT3,QACCNT4)=0
"RTN","QACSPRD2",149,0)
 Q
"RTN","QACSPRD2",150,0)
TSK ;
"RTN","QACSPRD2",151,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACSPRD2",152,0)
 D WRIT^QACSPRD1
"RTN","QACSPRD2",153,0)
 D COUNT
"RTN","QACSPRD2",154,0)
 D EXIT
"RTN","QACSPRD2",155,0)
 Q
"RTN","QACSPRD2",156,0)
LOOP2 ;
"RTN","QACSPRD2",157,0)
 S (QACDD,QACTOT)=0
"RTN","QACSPRD2",158,0)
 F  S QACDD=$O(^TMP("QACSPRD2",$J,QAC1,QAC2,QACDD)) Q:QACDD']""  D
"RTN","QACSPRD2",159,0)
 . S QACTOT=QACTOT+1
"RTN","QACSPRD2",160,0)
 W !,QAC2_", "_QACTOT
"RTN","QACSPRD2",161,0)
 I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE^QACGEN S QACPFLG=1 D WRIT^QACSPRD1
"RTN","QACSPRD2",162,0)
 S QACTOT=0
"RTN","QACSPRD2",163,0)
 K QACPFLG
"RTN","QACSPRD2",164,0)
 Q
"RTN","QACSPRD3")
0^18^B27226725
"RTN","QACSPRD3",1,0)
QACSPRD3 ;HINES/CEW - Spreadsheet report selections ;7/17/95  11:22
"RTN","QACSPRD3",2,0)
 ;;2.0;Patient Representative;**3,5,9**;07/25/1995
"RTN","QACSPRD3",3,0)
SEX ;
"RTN","QACSPRD3",4,0)
 ;Sub-routine to count total number of issues for each sex
"RTN","QACSPRD3",5,0)
 S QACRTN="SEXTSK^QACSPRD3",QACTITLE="Sex "
"RTN","QACSPRD3",6,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD3",7,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD3",8,0)
SEXTSK ;
"RTN","QACSPRD3",9,0)
 ;Tasked entry point for SEX
"RTN","QACSPRD3",10,0)
 U IO
"RTN","QACSPRD3",11,0)
 S QACROU="SEXTSK1^QACSPRD3"
"RTN","QACSPRD3",12,0)
 S QACPCE(1)="M",QACLABEL(1)="Male"
"RTN","QACSPRD3",13,0)
 S QACPCE(3)="",QACCNT=2
"RTN","QACSPRD3",14,0)
 S QACPCE(2)="F",QACLABEL(2)="Female"
"RTN","QACSPRD3",15,0)
 I '$D(QAC1DIV) D SET2^QACSPRD1
"RTN","QACSPRD3",16,0)
 I $D(QAC1DIV) D SET1^QACSPRD1
"RTN","QACSPRD3",17,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACSPRD3",18,0)
 D WRIT^QACSPRD1
"RTN","QACSPRD3",19,0)
 D EXIT
"RTN","QACSPRD3",20,0)
 Q
"RTN","QACSPRD3",21,0)
SEXTSK1 ;
"RTN","QACSPRD3",22,0)
 Q:'$D(^QA(745.1,QACD0,3))
"RTN","QACSPRD3",23,0)
 D ICLOOP^QACSPRD2
"RTN","QACSPRD3",24,0)
 S QACPN=$P(^QA(745.1,QACD0,0),U,3) Q:QACPN=""
"RTN","QACSPRD3",25,0)
 S QACSEX=$P($G(^DPT(QACPN,0)),U,2) Q:QACSEX=""
"RTN","QACSPRD3",26,0)
 S QACEE=0 F  S QACEE=$O(^QA(745.1,QACD0,3,QACEE)) Q:QACEE'>0  D
"RTN","QACSPRD3",27,0)
 . D TALL^QACSPRD1(QACSEX)
"RTN","QACSPRD3",28,0)
 Q
"RTN","QACSPRD3",29,0)
HEAD ;
"RTN","QACSPRD3",30,0)
 ;Sub-routine to count total number of issues for each Issue Code Heading
"RTN","QACSPRD3",31,0)
 S QACTITLE="Issue Code Heading "
"RTN","QACSPRD3",32,0)
 S QACRTN="HEADTSK^QACSPRD3"
"RTN","QACSPRD3",33,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD3",34,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD3",35,0)
HEADTSK ;
"RTN","QACSPRD3",36,0)
 ;Tasked entry point for HEAD
"RTN","QACSPRD3",37,0)
 U IO
"RTN","QACSPRD3",38,0)
 S QACROU="HEADTSK1^QACSPRD3"
"RTN","QACSPRD3",39,0)
 S QACPCE(1)="CA",QACLABEL(1)="Patient Care"
"RTN","QACSPRD3",40,0)
 S QACPCE(2)="CC",QACLABEL(2)="Courtesy/Communication"
"RTN","QACSPRD3",41,0)
 S QACPCE(3)="CM",QACLABEL(3)="Compliments"
"RTN","QACSPRD3",42,0)
 S QACPCE(4)="ED",QACLABEL(4)="Patient Education"
"RTN","QACSPRD3",43,0)
 S QACPCE(5)="EL",QACLABEL(5)="Eligibility"
"RTN","QACSPRD3",44,0)
 S QACPCE(6)="EN",QACLABEL(6)="Environment"
"RTN","QACSPRD3",45,0)
 S QACPCE(7)="IN",QACLABEL(7)="Information/Assistance"
"RTN","QACSPRD3",46,0)
 S QACPCE(8)="MR",QACLABEL(8)="Medical Records"
"RTN","QACSPRD3",47,0)
 S QACPCE(9)="PP",QACLABEL(9)="Personal Property"
"RTN","QACSPRD3",48,0)
 S QACPCE(10)="TI",QACLABEL(10)="Timeliness"
"RTN","QACSPRD3",49,0)
 S QACPCE(11)=""
"RTN","QACSPRD3",50,0)
 S QACCNT=10
"RTN","QACSPRD3",51,0)
 I '$D(QAC1DIV) D SET2^QACSPRD1
"RTN","QACSPRD3",52,0)
 I $D(QAC1DIV) D SET1^QACSPRD1
"RTN","QACSPRD3",53,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACSPRD3",54,0)
 D WRIT^QACSPRD1
"RTN","QACSPRD3",55,0)
 D EXIT
"RTN","QACSPRD3",56,0)
 Q
"RTN","QACSPRD3",57,0)
HEADTSK1 ;
"RTN","QACSPRD3",58,0)
 Q:'$D(^QA(745.1,QACD0,3,0))
"RTN","QACSPRD3",59,0)
 D ICLOOP^QACSPRD2
"RTN","QACSPRD3",60,0)
 S QACEE=0
"RTN","QACSPRD3",61,0)
 F  S QACEE=$O(QACODE(QACEE)) Q:QACEE']""  D
"RTN","QACSPRD3",62,0)
 . S QACHEAD=$E(QACODE(QACEE),1,2)
"RTN","QACSPRD3",63,0)
 . D TALL^QACSPRD1(QACHEAD)
"RTN","QACSPRD3",64,0)
 Q
"RTN","QACSPRD3",65,0)
DIVC ; Sub-routine counts total number of contacts by Division
"RTN","QACSPRD3",66,0)
 S QACRTN="DIVCTSK^QACSPRD3",QACTITLE="Contacts "
"RTN","QACSPRD3",67,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD3",68,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD3",69,0)
DIVCTSK ;
"RTN","QACSPRD3",70,0)
 S QACROU="DIVC1^QACSPRD3"
"RTN","QACSPRD3",71,0)
 D DVTSK(QACROU)
"RTN","QACSPRD3",72,0)
 Q
"RTN","QACSPRD3",73,0)
DIVC1 ;for each entry from #745.1 in the date range, check for the division
"RTN","QACSPRD3",74,0)
 S QACDIV=$P($G(^QA(745.1,QACD0,0)),U,16) ;Q:$G(QACDIV)']""
"RTN","QACSPRD3",75,0)
 I $G(QACDIV)']"" S QACDIV=0
"RTN","QACSPRD3",76,0)
 S QACEE=""
"RTN","QACSPRD3",77,0)
 I $O(^QA(740,1,"QAC2","B",QACDIV,QACEE))']"" S QACDIV=0
"RTN","QACSPRD3",78,0)
 S COUNT(QACDIV)=$G(COUNT(QACDIV))+1
"RTN","QACSPRD3",79,0)
 Q
"RTN","QACSPRD3",80,0)
WRITEDIV ;display or print the final tally
"RTN","QACSPRD3",81,0)
 W @IOF
"RTN","QACSPRD3",82,0)
 S Y=QAQNBEG D DD^%DT S QACBEG=Y
"RTN","QACSPRD3",83,0)
 S Y=QAQNEND D DD^%DT S QACEND=Y
"RTN","QACSPRD3",84,0)
 W !!?12,"Patient Rep "_QACTITLE_"by Division Spreadsheet Report"
"RTN","QACSPRD3",85,0)
 W !?20,"Date Range: "_QACBEG_" to "_QACEND
"RTN","QACSPRD3",86,0)
 S QACEE=""
"RTN","QACSPRD3",87,0)
 F  S QACEE=$O(COUNT(QACEE)) Q:QACEE']""  D 
"RTN","QACSPRD3",88,0)
 . I QACEE>0 D INST^QACUTL0(QACEE,.QACDV)
"RTN","QACSPRD3",89,0)
 . W !,$S(QACEE=0:"Unknown",1:QACDV),", ",COUNT(QACEE)
"RTN","QACSPRD3",90,0)
 . I $Y>(IOSL-5) D:$E(IOST)="C" PAUSE^QACGEN S QACPFLG=1 D WRIT^QACSPRD1
"RTN","QACSPRD3",91,0)
 . K QACPFLG
"RTN","QACSPRD3",92,0)
 Q
"RTN","QACSPRD3",93,0)
DIVI ;
"RTN","QACSPRD3",94,0)
 ; Sub-routine to count total issues by Division
"RTN","QACSPRD3",95,0)
 S QACRTN="DIVITSK^QACSPRD3",QACTITLE="Issues "
"RTN","QACSPRD3",96,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD3",97,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD3",98,0)
DIVITSK ;
"RTN","QACSPRD3",99,0)
 S QACROU="DIVI1^QACSPRD3"
"RTN","QACSPRD3",100,0)
 D DVTSK(QACROU)
"RTN","QACSPRD3",101,0)
 Q
"RTN","QACSPRD3",102,0)
DIVI1 ;for each entry in 745.1 loop through Issue code and count by code/div
"RTN","QACSPRD3",103,0)
 S QACDIV=$P($G(^QA(745.1,QACD0,0)),U,16)
"RTN","QACSPRD3",104,0)
 I $G(QACDIV)']"" S QACDIV=0
"RTN","QACSPRD3",105,0)
 S QACEE=""
"RTN","QACSPRD3",106,0)
 I $O(^QA(740,1,"QAC2","B",QACDIV,QACEE))']"" S QACDIV=0
"RTN","QACSPRD3",107,0)
 S QACISS=0 F  S QACISS=$O(^QA(745.1,QACD0,3,QACISS)) Q:QACISS'>0  D
"RTN","QACSPRD3",108,0)
 . I $G(^QA(745.1,QACD0,3,QACISS,0))]"" D
"RTN","QACSPRD3",109,0)
 . . S COUNT(QACDIV)=$G(COUNT(QACDIV))+1
"RTN","QACSPRD3",110,0)
 Q
"RTN","QACSPRD3",111,0)
DVTSK(QACROU) ;
"RTN","QACSPRD3",112,0)
 U IO
"RTN","QACSPRD3",113,0)
 I $P($G(^QA(740,1,"QAC")),U,3)<1 W !!,"Site is not multi-divisional for Patient Representative - no report created." Q
"RTN","QACSPRD3",114,0)
 D LOOP1^QACSPRD(QACROU,QAQNBEG,QAQNEND,.QACD0)
"RTN","QACSPRD3",115,0)
 D WRITEDIV
"RTN","QACSPRD3",116,0)
 D EXIT
"RTN","QACSPRD3",117,0)
 Q
"RTN","QACSPRD3",118,0)
SRVDS ;Sub-routine gives total issues by Service/Discipline
"RTN","QACSPRD3",119,0)
 S QACIFLG=1
"RTN","QACSPRD3",120,0)
 S QACTITLE="Service/Discipline "
"RTN","QACSPRD3",121,0)
 S QACRTN="SVDSTSK^QACSPRD3"
"RTN","QACSPRD3",122,0)
 D ZIS1^QACSPRD(QACRTN,QACTITLE,.QACXFLG) G:$G(QACPOP) EXIT
"RTN","QACSPRD3",123,0)
 I $G(QACXFLG) G EXIT
"RTN","QACSPRD3",124,0)
SVDSTSK ;  Tasked entry point for Service/Discipline
"RTN","QACSPRD3",125,0)
 S QACROU="SVDSTSK1^QACSPRD3"
"RTN","QACSPRD3",126,0)
 D TSK^QACSPRD2
"RTN","QACSPRD3",127,0)
 Q
"RTN","QACSPRD3",128,0)
SVDSTSK1 ;
"RTN","QACSPRD3",129,0)
 D ICLOOP^QACSPRD2
"RTN","QACSPRD3",130,0)
 S QACRR=0
"RTN","QACSPRD3",131,0)
 F  S QACRR=$O(QACODE(QACRR)) Q:QACRR'>0  D
"RTN","QACSPRD3",132,0)
 . S QACWW=0
"RTN","QACSPRD3",133,0)
 . F  S QACWW=$O(^QA(745.1,QACD0,3,QACCODE(QACRR),3,"B",QACWW)) Q:QACWW'>0  D
"RTN","QACSPRD3",134,0)
 . . S QACDISC=$$EN8^QACUTIL(+QACWW)
"RTN","QACSPRD3",135,0)
 . . I '$D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDISC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD3",136,0)
 . . I $D(QAC1DIV) S ^TMP("QACSPRD2",$J,QACDIV,QACDISC,QACODE(QACRR),QACD0)=""
"RTN","QACSPRD3",137,0)
 . . Q
"RTN","QACSPRD3",138,0)
 . Q
"RTN","QACSPRD3",139,0)
 Q
"RTN","QACSPRD3",140,0)
EXIT ;
"RTN","QACSPRD3",141,0)
 W ! D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@"
"RTN","QACSPRD3",142,0)
 K ^TMP("QACSPRD2",$J),COUNT,ZTRTN,ZTSAVE,ZTDESC,%ZIS,IOP,POP
"RTN","QACSPRD3",143,0)
 K QAC1DIV,QACBEG,QACCIEN,QACCNT,QACCODE,QACD0,QACDISC,QACDIV,QACDT
"RTN","QACSPRD3",144,0)
 K QACDV,QACEE,QACEND,QACHEAD,QACICODE,QACIFLG,QACISS,QACISSUE,QACLABEL
"RTN","QACSPRD3",145,0)
 K QACODE,QACPCE,QACPN,QACPOP,QACRR,QACRTN,QACSEX,QACTITLE,QACWW,QACXFLG
"RTN","QACSPRD3",146,0)
 K QAQNBEG,QAQNEND
"RTN","QACSPRD3",147,0)
 Q
"RTN","QACSRV")
0^19^B1023295
"RTN","QACSRV",1,0)
QACSRV ;WCIOFO/ERC - Report of Service/Discipline Iss Tot ;9/22/97
"RTN","QACSRV",2,0)
 ;;2.0;Patient Representative;**3,5,9**;07/25/1995
"RTN","QACSRV",3,0)
DATE ;
"RTN","QACSRV",4,0)
 N QACDIS,QACDSC,QACFLG S QACFLG=0
"RTN","QACSRV",5,0)
 D DATDIV^QACUTL0 G:QAQPOP EXIT^QACDISC
"RTN","QACSRV",6,0)
 S QACTEXT="Service/Discipline "
"RTN","QACSRV",7,0)
 S DIC="^QA(745.55,"
"RTN","QACSRV",8,0)
 D DIR^QACDISC(QACTEXT,DIC,.Y)
"RTN","QACSRV",9,0)
 S QACDSC=$P(Y,U,2)
"RTN","QACSRV",10,0)
 I $G(QACFLG)=1 S QACDSP=+Y
"RTN","QACSRV",11,0)
 K %ZIS,IOP S %ZIS="MQ" W ! D ^%ZIS G:POP EXIT^QACDISC
"RTN","QACSRV",12,0)
 I $D(IO("Q")) D  G EXIT^QACDISC
"RTN","QACSRV",13,0)
 . S (ZTSAVE("QACSRPT0"),ZTSAVE("QACSRPT1"),ZTSAVE("QACSRPT2"))=""
"RTN","QACSRV",14,0)
 . S ZTDESC="Patient Rep Service Report"
"RTN","QACSRV",15,0)
 . S ZTRTN="TSK^QACSRV"
"RTN","QACSRV",16,0)
 . D TASK^QACUTL0
"RTN","QACSRV",17,0)
 . Q
"RTN","QACSRV",18,0)
TSK ;
"RTN","QACSRV",19,0)
 S QACPIECE=1
"RTN","QACSRV",20,0)
 S QACSUB=2
"RTN","QACSRV",21,0)
 D TSK1^QACDISC(QACPIECE,QACSUB)
"RTN","QACSRV",22,0)
 Q
"RTN","QACUTL0")
0^22^B4109337
"RTN","QACUTL0",1,0)
QACUTL0 ;WCIOFO/ERC/VAD - Utility for Patient Rep reports ;29 Dec 98
"RTN","QACUTL0",2,0)
 ;;2.0;Patient Representative;**10,9**;07/25/1995
"RTN","QACUTL0",3,0)
 ;
"RTN","QACUTL0",4,0)
DATDIV ;
"RTN","QACUTL0",5,0)
 D DATE Q:QAQPOP
"RTN","QACUTL0",6,0)
 D DIV Q:QAQPOP
"RTN","QACUTL0",7,0)
 Q
"RTN","QACUTL0",8,0)
 ;
"RTN","QACUTL0",9,0)
DATE ;select date range for Patient Rep
"RTN","QACUTL0",10,0)
 S QAQPOP=0
"RTN","QACUTL0",11,0)
 W !!,"Select the date range you want to print."
"RTN","QACUTL0",12,0)
 D ^QAQDATE I QAQQUIT S QAQPOP=1 Q
"RTN","QACUTL0",13,0)
 I QAQNBEG>DT W !,"*** Beginning date must be today or earlier! ***",$C(7) G DATE
"RTN","QACUTL0",14,0)
 Q
"RTN","QACUTL0",15,0)
 ;
"RTN","QACUTL0",16,0)
DIV ;select Patient Rep division
"RTN","QACUTL0",17,0)
 K QACDV,QAC1DIV
"RTN","QACUTL0",18,0)
 S QAQPOP=0
"RTN","QACUTL0",19,0)
 S QACDV=$P($G(^QA(740,1,"QAC")),U,3)
"RTN","QACUTL0",20,0)
 I QACDV'=1 Q     ; division report not enabled.
"RTN","QACUTL0",21,0)
 ;
"RTN","QACUTL0",22,0)
 N DIR,DIRUT,DTOUT,DUOUT
"RTN","QACUTL0",23,0)
 S DIR(0)="YA"
"RTN","QACUTL0",24,0)
 S DIR("A")="Select ALL Divisions? "
"RTN","QACUTL0",25,0)
 S DIR("B")="YES"
"RTN","QACUTL0",26,0)
 D ^DIR K DIR I $D(DIRUT) S QAQPOP=1 Q
"RTN","QACUTL0",27,0)
 I Y S QAC1DIV="" Q
"RTN","QACUTL0",28,0)
 N DIC
"RTN","QACUTL0",29,0)
 S DIC="^QA(740,1,""QAC2"","
"RTN","QACUTL0",30,0)
 S DIC(0)="AEMZQ"
"RTN","QACUTL0",31,0)
 S DIC("A")="Enter Division: "
"RTN","QACUTL0",32,0)
 S QACDVSN=$O(^QA(740,1,"QAC2",0)) Q:$G(QACDVSN)'>0
"RTN","QACUTL0",33,0)
 D INST($G(^QA(740,1,"QAC2",QACDVSN,0)),.QACDVN)
"RTN","QACUTL0",34,0)
 S DIC("B")=$G(QACDVN)
"RTN","QACUTL0",35,0)
 D ^DIC K DIC
"RTN","QACUTL0",36,0)
 I +Y>0 S QAC1DIV=Y(0)
"RTN","QACUTL0",37,0)
 Q
"RTN","QACUTL0",38,0)
 ;
"RTN","QACUTL0",39,0)
TASK ;set variables for call to ^%ZTLOAD
"RTN","QACUTL0",40,0)
 S (ZTSAVE("QAQNBEG"),ZTSAVE("QAQNEND"))=""
"RTN","QACUTL0",41,0)
 S ZTSAVE("QAQ2HED")=""
"RTN","QACUTL0",42,0)
 S (ZTSAVE("QACDIV"),ZTSAVE("QAC1DIV"))=""
"RTN","QACUTL0",43,0)
 S (ZTSAVE("QACTEXT"),ZTSAVE("QACDESC"))=""
"RTN","QACUTL0",44,0)
 D ^%ZTLOAD
"RTN","QACUTL0",45,0)
 I $G(ZTSK) W !,"Task Number: ",ZTSK
"RTN","QACUTL0",46,0)
 Q
"RTN","QACUTL0",47,0)
INST(QACIEN,QACDV) ;uses FileMan for name of a division from the Institution file (#4)
"RTN","QACUTL0",48,0)
 N DIC
"RTN","QACUTL0",49,0)
 K QACDV
"RTN","QACUTL0",50,0)
 S DIC="^DIC(4,"
"RTN","QACUTL0",51,0)
 S DIC(0)="NZX"
"RTN","QACUTL0",52,0)
 S DIC("S")="I $D(^QA(740,1,""QAC2"",""B"",X))"
"RTN","QACUTL0",53,0)
 S X=QACIEN
"RTN","QACUTL0",54,0)
 D ^DIC K DIC
"RTN","QACUTL0",55,0)
 I Y<0 S QACDV="Unknown" Q
"RTN","QACUTL0",56,0)
 S QACDV=Y(0,0)
"RTN","QACUTL0",57,0)
 Q
"RTN","QACUTL0",58,0)
SITE(QACIEN,QACSIT) ;uses FM for node 99 of Inst file (#4)
"RTN","QACUTL0",59,0)
 N DIC,DA,DR
"RTN","QACUTL0",60,0)
 K QACSIT,QACSITE
"RTN","QACUTL0",61,0)
 S DIC="^DIC(4,"
"RTN","QACUTL0",62,0)
 S DA=QACIEN
"RTN","QACUTL0",63,0)
 S DR=99
"RTN","QACUTL0",64,0)
 S DIQ="QACSITE"
"RTN","QACUTL0",65,0)
 D EN^DIQ1
"RTN","QACUTL0",66,0)
 S QACSIT=QACSITE(4,QACIEN,99)
"RTN","QACUTL0",67,0)
 Q
"VER")
8.0^21.0
**END**
**END**
