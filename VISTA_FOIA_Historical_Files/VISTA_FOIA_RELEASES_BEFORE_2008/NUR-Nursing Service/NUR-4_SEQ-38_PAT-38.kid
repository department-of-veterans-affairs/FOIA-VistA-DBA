Released NUR*4*38 SEQ #38
Extracted from mail message
**KIDS**:NUR*4.0*38^

**INSTALL NAME**
NUR*4.0*38
"BLD",3482,0)
NUR*4.0*38^NURSING SERVICE^0^3030425^y
"BLD",3482,1,0)
^^3^3^3030228^
"BLD",3482,1,1,0)
This is a maintenance patch that fixes known problems in the Nursing 
"BLD",3482,1,2,0)
package as identified by NOISes SAJ-0301-71155, HIN-0601-40523, 
"BLD",3482,1,3,0)
FGH-0402-32096, UNY-1202-11134 and ANN-0203-41275.
"BLD",3482,4,0)
^9.64PA^210^1
"BLD",3482,4,210,0)
210
"BLD",3482,4,210,2,0)
^9.641^210^1
"BLD",3482,4,210,2,210,0)
NURS STAFF  (File-top level)
"BLD",3482,4,210,2,210,1,0)
^9.6411^4^1
"BLD",3482,4,210,2,210,1,4,0)
PRIMARY FACILITY
"BLD",3482,4,210,222)
y^n^p^^^^n
"BLD",3482,4,"APDD",210,210)

"BLD",3482,4,"APDD",210,210,4)

"BLD",3482,4,"B",210,210)

"BLD",3482,"KRN",0)
^9.67PA^8989.52^19
"BLD",3482,"KRN",.4,0)
.4
"BLD",3482,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",3482,"KRN",.4,"NM",1,0)
NURS-P-STF    FILE #210^210^0
"BLD",3482,"KRN",.4,"NM","B","NURS-P-STF    FILE #210",1)

"BLD",3482,"KRN",.401,0)
.401
"BLD",3482,"KRN",.402,0)
.402
"BLD",3482,"KRN",.403,0)
.403
"BLD",3482,"KRN",.5,0)
.5
"BLD",3482,"KRN",.84,0)
.84
"BLD",3482,"KRN",3.6,0)
3.6
"BLD",3482,"KRN",3.8,0)
3.8
"BLD",3482,"KRN",9.2,0)
9.2
"BLD",3482,"KRN",9.8,0)
9.8
"BLD",3482,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",3482,"KRN",9.8,"NM",1,0)
NURA9K^^0^B30313325
"BLD",3482,"KRN",9.8,"NM",2,0)
NURSUT0^^0^B30181021
"BLD",3482,"KRN",9.8,"NM",3,0)
NURAFSD^^0^B15353754
"BLD",3482,"KRN",9.8,"NM",4,0)
NURA6K2^^0^B21161279
"BLD",3482,"KRN",9.8,"NM",5,0)
NURACHDC^^0^B15066285
"BLD",3482,"KRN",9.8,"NM",6,0)
NURSUT3^^0^B30070649
"BLD",3482,"KRN",9.8,"NM","B","NURA6K2",4)

"BLD",3482,"KRN",9.8,"NM","B","NURA9K",1)

"BLD",3482,"KRN",9.8,"NM","B","NURACHDC",5)

"BLD",3482,"KRN",9.8,"NM","B","NURAFSD",3)

"BLD",3482,"KRN",9.8,"NM","B","NURSUT0",2)

"BLD",3482,"KRN",9.8,"NM","B","NURSUT3",6)

"BLD",3482,"KRN",19,0)
19
"BLD",3482,"KRN",19.1,0)
19.1
"BLD",3482,"KRN",101,0)
101
"BLD",3482,"KRN",409.61,0)
409.61
"BLD",3482,"KRN",771,0)
771
"BLD",3482,"KRN",870,0)
870
"BLD",3482,"KRN",8989.51,0)
8989.51
"BLD",3482,"KRN",8989.52,0)
8989.52
"BLD",3482,"KRN",8994,0)
8994
"BLD",3482,"KRN","B",.4,.4)

"BLD",3482,"KRN","B",.401,.401)

"BLD",3482,"KRN","B",.402,.402)

"BLD",3482,"KRN","B",.403,.403)

"BLD",3482,"KRN","B",.5,.5)

"BLD",3482,"KRN","B",.84,.84)

"BLD",3482,"KRN","B",3.6,3.6)

"BLD",3482,"KRN","B",3.8,3.8)

"BLD",3482,"KRN","B",9.2,9.2)

"BLD",3482,"KRN","B",9.8,9.8)

"BLD",3482,"KRN","B",19,19)

"BLD",3482,"KRN","B",19.1,19.1)

"BLD",3482,"KRN","B",101,101)

"BLD",3482,"KRN","B",409.61,409.61)

"BLD",3482,"KRN","B",771,771)

"BLD",3482,"KRN","B",870,870)

"BLD",3482,"KRN","B",8989.51,8989.51)

"BLD",3482,"KRN","B",8989.52,8989.52)

"BLD",3482,"KRN","B",8994,8994)

"BLD",3482,"QUES",0)
^9.62^^
"BLD",3482,"REQB",0)
^9.611^5^5
"BLD",3482,"REQB",1,0)
NUR*4.0*13^2
"BLD",3482,"REQB",2,0)
NUR*4.0*14^2
"BLD",3482,"REQB",3,0)
NUR*4.0*34^2
"BLD",3482,"REQB",4,0)
NUR*4.0*17^2
"BLD",3482,"REQB",5,0)
NUR*4.0*33^2
"BLD",3482,"REQB","B","NUR*4.0*13",1)

"BLD",3482,"REQB","B","NUR*4.0*14",2)

"BLD",3482,"REQB","B","NUR*4.0*17",4)

"BLD",3482,"REQB","B","NUR*4.0*33",5)

"BLD",3482,"REQB","B","NUR*4.0*34",3)

"FIA",210)
NURS STAFF
"FIA",210,0)
^NURSF(210,
"FIA",210,0,0)
210IOP
"FIA",210,0,1)
y^n^p^^^^n
"FIA",210,0,10)

"FIA",210,0,11)

"FIA",210,0,"RLRO")

"FIA",210,0,"VR")
4.0^NUR
"FIA",210,210)
1
"FIA",210,210,4)

"KRN",.4,291,-1)
0^1
"KRN",.4,291,0)
NURS-P-STF^2981214.1057^^210^^^3030304
"KRN",.4,291,"DXS",1,9.2)
S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^NURSF(210,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^VA(200,+D0,0)) D0=-1 S DIP(101)=$S($D(^VA(200,D0,.11)):^(.11),1:"")
"KRN",.4,291,"DXS",2,9.2)
S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^NURSF(210,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^VA(200,+D0,0)) D0=-1 S DIP(101)=$S($D(^VA(200,D0,.11)):^(.11),1:"")
"KRN",.4,291,"DXS",3,9.2)
S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^NURSF(210,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^VA(200,+D0,0)) D0=-1 S DIP(101)=$S($D(^VA(200,D0,.11)):^(.11),1:"")
"KRN",.4,291,"DXS",4,9.2)
S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^NURSF(210,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^VA(200,+D0,0)) D0=-1 S DIP(101)=$S($D(^VA(200,D0,.11)):^(.11),1:"")
"KRN",.4,291,"DXS",5,9.2)
S I(0,0)=$S($D(D0):D0,1:""),DIP(1)=$S($D(^NURSF(210,D0,0)):^(0),1:""),D0=$P(DIP(1),U,1) S:'$D(^VA(200,+D0,0)) D0=-1 S DIP(101)=$S($D(^VA(200,D0,.11)):^(.11),1:"")
"KRN",.4,291,"DXS",6,"N")
NO
"KRN",.4,291,"DXS",6,"Y")
YES
"KRN",.4,291,"DXS",7,"N")
NEIGHBOR
"KRN",.4,291,"DXS",7,"O")
OTHER
"KRN",.4,291,"DXS",7,"R")
RELATIVE
"KRN",.4,291,"DXS",7,"S")
SELF
"KRN",.4,291,"DXS",8,0)
NO SERVICE
"KRN",.4,291,"DXS",8,1)
NONE
"KRN",.4,291,"DXS",8,2)
5 PT.
"KRN",.4,291,"DXS",8,3)
10 PT. DISAB.
"KRN",.4,291,"DXS",8,4)
10 PT. COMP.
"KRN",.4,291,"DXS",8,5)
10 PT. OTHER
"KRN",.4,291,"DXS",8,6)
10 PT./30% COMP
"KRN",.4,291,"DXS",9,"A")
SPECIAL ADVANCEMENT FOR ACHIEVEMENT
"KRN",.4,291,"DXS",9,"E")
ADVANCEMENT TO NEXT LEVEL
"KRN",.4,291,"DXS",9,"G")
PROMOTION TO NEXT GRADE
"KRN",.4,291,"DXS",9,"N")
NOT PROMOTED AT THIS TIME
"KRN",.4,291,"DXS",9,"P")
SPECIAL ADVANCEMENT FOR PERFORMANCE
"KRN",.4,291,"DXS",9,"S")
WITHIN GRADE STEP INCREASE
"KRN",.4,291,"DXS",10,"N")
NO
"KRN",.4,291,"DXS",10,"Y")
YES
"KRN",.4,291,"F",1)
"INDIVIDUAL STAFF REPORT";C28;S2~"-----------------------";C28~"NAME: ";C1;S1~.01;C7~"SSN: ";C37~1;C42~"DATE: ";C55~
"KRN",.4,291,"F",2)
S X=DT S Y=X D DT K DIP;C61;L18;Z;"TODAY"~"DOB: ";C2~7;C7;L18~"AGE: ";C37~7.5;C42~"SEX: ";C56~8;C61~"----------------------------------------";C1~
"KRN",.4,291,"F",3)
"----------------------------------------";C41~"CURRENT FTEE INFORMATION";C28~"------------------------";C28~D EN1^NURASPL;Z;"D EN1^NURASPL"~
"KRN",.4,291,"F",4)
"GRADE/STEP:";C15~6.5;C27~"UNIFORM ALLOWANCE:";C8~6.7;C27~K NURSX S $P(NURSX,"-",80)="" W !,NURSX;Z;"K NURSX S $P(NURSX,"-",80)="" W !,NURSX"~
"KRN",.4,291,"F",5)
"ADDRESS/TELEPHONE";C28~W $E(NURSX,1,17);C28;Z;"W $E(NURSX,1,17)"~"HOME ADDRESS INFORMATION";C1;S1~"------------------------";C1~"STREET: ";C7;S1~
"KRN",.4,291,"F",6)
X DXS(1,9.2) S X=$P(DIP(101),U,1) S D0=I(0,0) W X K DIP;C15;Z;".01:.111"~X DXS(2,9.2) S X=$P(DIP(101),U,2) S D0=I(0,0) W X K DIP;C15;Z;".01:.112"~
"KRN",.4,291,"F",7)
X DXS(3,9.2) S X=$P(DIP(101),U,3) S D0=I(0,0) W X K DIP;C15;Z;".01:.113"~"CITY: ";C9~
"KRN",.4,291,"F",8)
X DXS(4,9.2) S X=$P(DIP(101),U,4) S D0=I(0,0) W X K DIP;C15;Z;".01:CITY"~"STATE: ";C8~12;C15~"ZIP";C48~
"KRN",.4,291,"F",9)
X DXS(5,9.2) S X=$P(DIP(101),U,6) S D0=I(0,0) W X K DIP;C53;Z;".01:ZIP CODE"~"MAILING ADDRESS INFORMATION";C1;S1~"---------------------------";C1~
"KRN",.4,291,"F",10)
"STREET: ";C7;S1~13.3;C15~13.35;C15~13.4;C15~"CITY: ";C9~13.5;C15~"STATE: ";C8~13.7;C15~"ZIP: ";C48~13.9;C53~"TELEPHONE NUMBER INFORMATION";C1;S1~
"KRN",.4,291,"F",11)
"----------------------------";C1~14,"NUMBER: ";C7;S1~14,.01;C15~14,"OWNER: ";C8~14,1;C15~14,"OTHER OWNER: ";C2~14,2;C15~
"KRN",.4,291,"F",12)
"EMERGENCY CONTACT INFORMATION";C1;S1~"-----------------------------";C1~15,"NAME: ";C9;S1~15,.01;C15~15,"RELATIONSHIP: ";C1~15,1;C15~15,"STREET: ";C7~
"KRN",.4,291,"F",13)
15,2;C15~15,"CITY: ";C9~15,4;C15~15,"STATE: ";C8~15,5;C15~15,"ZIP: ";C48~15,6;C53~15,"PHONE NUMBER: ";C1~15,7;C15~
"KRN",.4,291,"F",14)
"----------------------------------------";C1~"----------------------------------------";C41~"VA EMPLOYMENT INFORMATION";C28~
"KRN",.4,291,"F",15)
"-------------------------";C28~"STATION ENTRY ON DUTY DATE: ";C1;S1~17;C29;L18~"SERVICE COMPUTATION DATE: ";C3~19;C29;L18~"VA STARTING DATE:";C11~
"KRN",.4,291,"F",16)
18;C29;L18~"VETERAN PREFERENCE:";C9~16.5;C29;L18~"END OF PROBATIONARY PERIOD:";C1~19.5;C29;L18~19.61,"DATE OF PROMOTION: ";C10;S1~19.61,.01;C29~
"KRN",.4,291,"F",17)
19.61,"TYPE: ";C23~19.61,1;C29~W !,NURSX;Z;"W !,NURSX"~"EVALUATIONS/BOARD REVIEWS";C28~"-------------------------";C28~
"KRN",.4,291,"F",18)
19.86,"DATE PROFICIENCY/NARRATIVE IS DUE: ";C1;S1~19.86,.01;C36~19.86,"NAME OF EVALUATOR: ";C17~19.86,1;C36~19.86,"DATE WORK COPY SENT OUT: ";C11~
"KRN",.4,291,"F",19)
19.86,3;C36~19.86,"DATE PROF RETURNED FOR TYPING: ";C5~19.86,4;C36~19.86,"TENTATIVE DATE FOR BOARD ACTION: ";C3~19.86,5;C36~
"KRN",.4,291,"F",20)
19.86,"ACTUAL DATE OF BOARD ACTION: ";C7~19.86,2;C36~19.86,"DATE OF NEXT BOARD ACTION: ";C7~19.86,6;C36~W !,NURSX;Z;"W !,NURSX"~
"KRN",.4,291,"F",21)
"PROFESSIONAL LICENSE INFORMATION";C28~"-------------------------------";C28~16,"STATE: ";C19;S1~16,.01;C26~16,"LICENSE NUMBER: ";C10~16,1;C26~
"KRN",.4,291,"F",22)
16,"EXPIRATION DATE: ";C9~16,2;C26~16,"VERIFIED BY: ";C13~16,1.6;C26~W !,NURSX;Z;"W !,NURSX"~"PROFESSIONAL EDUCATION";C28~"----------------------";C28~
"KRN",.4,291,"F",23)
"HIGHEST NURSING DEGREE: ";C2;S1~21.5;C26;L30~"HIGHEST ACADEMIC DEGREE: ";C1~21.7;C26;L30~21.3,"DEGREE: ";C18;S1~21.3,.01;C26~21.3,"MAJOR: ";C19~21.3,1;C26~
"KRN",.4,291,"F",24)
21.3,"COLLEGE/UNIVERSITY: ";C6~21.3,2;C26~21.3,"YEAR COMPLETED: ";C10~21.3,3;C26;L11~"FACULTY: ";C17~23.1;C26~23.2,"TYPE OF APPOINTMENT: ";C5~
"KRN",.4,291,"F",25)
23.2,.01;C26;L45~23.2,"INSTITUTION: ";C13~23.2,1;C26;L45~W !,NURSX;Z;"W !,NURSX"~"NATIONAL CERTIFICATION";C28~"----------------------";C28~
"KRN",.4,291,"F",26)
24,"NAME OF CERTIFICATION: ";C1;S1~24,.05;C24~24,"CERTIFYING AGENCY: ";C5~24,1;C24~24,"DATE OF CERTIFICATION: ";C1~24,2;C24~24,"DATE OF EXPIRATION: ";C4~
"KRN",.4,291,"F",27)
24,3;C24~W !,NURSX;Z;"W !,NURSX"~"PROFESSIONAL EXPERIENCE";C28~"-----------------------";C28~22.5,"LOCATION: ";C25;S1~22.5,3;C35~
"KRN",.4,291,"F",28)
22.5,"TYPE OF EXPERIENCE: ";C15~22.5,.01;C35~22.5,"TITLE/POSITION: ";C19~22.5,1;C35~22.5,"DATE PREVIOUS ASSIGNMENT STARTED: ";C1~22.5,2.1;C35~
"KRN",.4,291,"F",29)
22.5,"DATE PREVIOUS ASSIGNMENT ENDED: ";C3~22.5,2.5;C35~W !,NURSX;Z;"W !,NURSX"~"MILITARY EXPERIENCE";C28~"-------------------";C28~
"KRN",.4,291,"F",30)
D EN5^NURSAUTL;Z;"D EN5^NURSAUTL"~W !,NURSX;Z;"W !,NURSX"~"PRIVILEGES";C28~"----------";C28~29,"PRIVILEGE: ";C4;S1~29,.01;C15~29,"DATE GRANTED: ";C1~
"KRN",.4,291,"F",31)
29,1;C15~29,"COMMENTS: ";C5~29,2,.01;C15~
"KRN",.4,291,"H")
@
"KRN",.4,291,"IOM")
80
"KRN",.4,291,"LAST")
3
"KRN",.4,291,"ROU")
^NURSPA
"KRN",.4,291,"ROUOLD")
NURSPA
"KRN",.4,291,"SUB")
1
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"PKG",28,-1)
1^1
"PKG",28,0)
NURSING SERVICE^NUR^Nursing Service General Module
"PKG",28,22,0)
^9.49I^1^1
"PKG",28,22,1,0)
4.0^2970509^2970619^11713
"PKG",28,22,1,"PAH",1,0)
38^3030425
"PKG",28,22,1,"PAH",1,1,0)
^^3^3^3030425
"PKG",28,22,1,"PAH",1,1,1,0)
This is a maintenance patch that fixes known problems in the Nursing 
"PKG",28,22,1,"PAH",1,1,2,0)
package as identified by NOISes SAJ-0301-71155, HIN-0601-40523, 
"PKG",28,22,1,"PAH",1,1,3,0)
FGH-0402-32096, UNY-1202-11134 and ANN-0203-41275.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","NURA6K2")
0^4^B21161279
"RTN","NURA6K2",1,0)
NURA6K2 ;HIRMFO/MD,FT-NURSING SERVICE PROFICIENCY REPORT BY SERVICE ; 1/3/03 1:14pm
"RTN","NURA6K2",2,0)
 ;;4.0;NURSING SERVICE;**38**;Apr 25, 1997
"RTN","NURA6K2",3,0)
 Q:'$D(^DIC(213.9,1,"OFF"))  Q:$P(^DIC(213.9,1,"OFF"),"^",1)=1
"RTN","NURA6K2",4,0)
 S (NURQUIT,NURQUEUE,NUROUT)=0,NURHOSP=1
"RTN","NURA6K2",5,0)
 D EN1^NURSAUTL G QUIT:NUROUT
"RTN","NURA6K2",6,0)
 I NURMDSW S DIC(0)="AEQMZ" S NURPLSCR=0 D EN5^NURSAGSP G QUIT:$G(NUROUT)
"RTN","NURA6K2",7,0)
 I NURMDSW=0,NURPLSW=1 S NURPLSCR=0 D PRD^NURSAGSP K NURPLSCR I $G(NUROUT) G QUIT
"RTN","NURA6K2",8,0)
 D EN4^NURSAGP1 G QUIT:NUROUT
"RTN","NURA6K2",9,0)
 W ! S ZTDESC="Nursing Service Proficiency Report by Service",ZTRTN="START^NURA6K2",NURS132=1 D EN7^NURSUT0 G:POP!($D(ZTSK)) QUIT
"RTN","NURA6K2",10,0)
START ;
"RTN","NURA6K2",11,0)
 K ^TMP($J)
"RTN","NURA6K2",12,0)
 S X="",(NURQUIT,NURSW1,NURPAGE)=0 F  S X=$O(^NURSF(210,"AC",X)) Q:X=""  I X'="R" F DA=0:0 S DA=$O(^NURSF(210,"AC",X,DA)) Q:DA'>0  I $D(^NURSF(210,DA,0)),+$P(^(0),U) S DA(1)=$P(^(0),U) W:$R(100)&($E(IOST)="C") "." D SORT
"RTN","NURA6K2",13,0)
 S X=$O(^TMP($J,"")) I X="" D NHDR W !,"THERE IS NO DATA FOR THIS REPORT" S DIR(0)="E" D:$E(IOST)="C" ^DIR S NUROUT=1 G QUIT
"RTN","NURA6K2",14,0)
 U IO D NPRINT
"RTN","NURA6K2",15,0)
QUIT K ^TMP($J) D CLOSE^NURSUT1,^NURAKILL
"RTN","NURA6K2",16,0)
 Q
"RTN","NURA6K2",17,0)
SORT ; POSITION SORT
"RTN","NURA6K2",18,0)
 F NURNODE4=0:0 S NURNODE4=$O(^NURSF(211.8,"C",DA(1),NURNODE4)) Q:NURNODE4'>0  F NURNODE5=0:0 S NURNODE5=$O(^NURSF(211.8,"C",DA(1),NURNODE4,NURNODE5)) Q:NURNODE5'>0  D
"RTN","NURA6K2",19,0)
 .I $D(^NURSF(211.8,NURNODE4,1,NURNODE5,0)),$P(^(0),U)'>DT&(('$P(^(0),U,6))!($P(^(0),U,6)'<DT)) D SORT1
"RTN","NURA6K2",20,0)
 .Q
"RTN","NURA6K2",21,0)
 Q
"RTN","NURA6K2",22,0)
SORT1 Q:NURSZAP>7&(NURSZDA'=DA)  S NURSZORT=1 D EN3^NURSAUTL:NURSZAP>6,EN2^NURSAUTL:NURSZORT&NURSZAP Q:'NURSZORT
"RTN","NURA6K2",23,0)
 S NURNEN=1 D SETFAC^NURAAGS1,SETPROG^NURAAGS1
"RTN","NURA6K2",24,0)
 I $D(^VA(200,DA(1),0)) S N1=$S($P(^(0),"^",1)'="":$P(^(0),"^",1),1:"  BLANK")
"RTN","NURA6K2",25,0)
 I $D(^VA(200,DA(1),1)) S SSN=$S($P(^(1),"^",9)'="":$P(^(1),"^",9),1:"  BLANK")
"RTN","NURA6K2",26,0)
 S NLO=$S($D(^NURSF(211.8,NURNODE4,0))&$P(^NURSF(211.8,NURNODE4,0),"^")'="":$P(^(0),"^"),1:"  BLANK")
"RTN","NURA6K2",27,0)
 I $D(^NURSF(211.4,"B",+NLO)) S NLO(1)=$O(^NURSF(211.4,"B",+NLO,0)) I $D(^NURSF(211.4,+NLO(1),"I")),$E($P(^("I"),"^"))="I" Q
"RTN","NURA6K2",28,0)
 D EN2^NURSUT0 S NURSER=$G(NPSPOS(1))
"RTN","NURA6K2",29,0)
 S NPWARD=NLO D EN7^NURSAUTL S NL1=$S(NPWARD'="":NPWARD,1:"  BLANK")
"RTN","NURA6K2",30,0)
 Q:NURSER=""!'(NURSER="R")
"RTN","NURA6K2",31,0)
 I '$D(^NURSF(210,DA,14,0)) Q
"RTN","NURA6K2",32,0)
 S NURPROG("TST")=$G(NURPROG(2))
"RTN","NURA6K2",33,0)
 S NN=0 F II=0:0 S NN=$O(^NURSF(210,DA,14,NN)) Q:NN'>0  D NGO
"RTN","NURA6K2",34,0)
 K NURPROG("TST")
"RTN","NURA6K2",35,0)
 Q
"RTN","NURA6K2",36,0)
NGO I '$D(^NURSF(210,DA,14,NN,0)) Q
"RTN","NURA6K2",37,0)
 S NDATA=^NURSF(210,DA,14,NN,0),NDD=$S($P(NDATA,"^")'="":$P(NDATA,"^"),1:"  BLANK"),NEV=$S($P(NDATA,"^",2)>0:$P(^VA(200,+$P(NDATA,"^",2),0),"^"),1:"  BLANK")
"RTN","NURA6K2",38,0)
 I 'NURHOSP,'$D(NURSNLOC(NLO)) Q
"RTN","NURA6K2",39,0)
 I 'NSP,NDD<NSPC!(NDD>NSPC(2)) Q
"RTN","NURA6K2",40,0)
 I NURMDSW,'$G(NURFAC),$G(NURFAC(1))'=$G(NURFAC(2)) Q
"RTN","NURA6K2",41,0)
 I NURPLSW,'$G(NURPROG),$G(NURPROG(1))'=NURPROG("TST") Q
"RTN","NURA6K2",42,0)
 S:NURPROG(2)="NURSING" NURPROG(2)=" "_NURPROG(2)
"RTN","NURA6K2",43,0)
 S ^TMP($J,NURFAC(2),NURPROG(2),NDD,NL1,N1,SSN,NEV,DA,NN)=""
"RTN","NURA6K2",44,0)
 Q
"RTN","NURA6K2",45,0)
NPRINT S NURFAC(2)="" F  S NURFAC(2)=$O(^TMP($J,NURFAC(2))) Q:NURFAC(2)=""!NURQUIT  D NM Q:NURQUIT
"RTN","NURA6K2",46,0)
 Q
"RTN","NURA6K2",47,0)
NM S NURPROG(2)="" F  S NURPROG(2)=$O(^TMP($J,NURFAC(2),NURPROG(2))) Q:NURPROG(2)=""!NURQUIT  D:NURSW1 NHDR Q:NURQUIT  D NN Q:NURQUIT
"RTN","NURA6K2",48,0)
 Q
"RTN","NURA6K2",49,0)
NN S NDD="" F  S NDD=$O(^TMP($J,NURFAC(2),NURPROG(2),NDD)) Q:NDD=""  D NO Q:NURQUIT
"RTN","NURA6K2",50,0)
 Q
"RTN","NURA6K2",51,0)
NO S NL1="" F  S NL1=$O(^TMP($J,NURFAC(2),NURPROG(2),NDD,NL1)) Q:NL1=""  D NR Q:NURQUIT
"RTN","NURA6K2",52,0)
 Q
"RTN","NURA6K2",53,0)
NR S N1="" F  S N1=$O(^TMP($J,NURFAC(2),NURPROG(2),NDD,NL1,N1)) Q:N1=""  S SSN=$O(^(N1,"")),NEV=$O(^(SSN,"")),DA=$O(^(NEV,0)),D1=$O(^(DA,0)) D NPPRINT Q:NURQUIT
"RTN","NURA6K2",54,0)
 Q
"RTN","NURA6K2",55,0)
NPPRINT I ($Y>(IOSL-10))!'(NURSW1) D NHDR Q:NURQUIT
"RTN","NURA6K2",56,0)
 W !
"RTN","NURA6K2",57,0)
 W:N1'="  BLANK" $E(N1,1,20)
"RTN","NURA6K2",58,0)
 W ?23,$E(SSN,1,3),"-",$E(SSN,4,5),"-",$E(SSN,6,9)
"RTN","NURA6K2",59,0)
 W:NL1'="  BLANK" ?40,$E(NL1,1,10)
"RTN","NURA6K2",60,0)
 S Y=NDD D:Y'="  BLANK" D^DIQ W:Y'="  BLANK" ?51,Y
"RTN","NURA6K2",61,0)
 W:NEV'="  BLANK" ?65,NEV
"RTN","NURA6K2",62,0)
 S DATA=$G(^NURSF(210,DA,14,D1,0)) F I=4,5 I +$P(DATA,U,I) S Y=$P(DATA,U,I) D D^DIQ S ZZ=$S(I=4:91,1:105) W ?ZZ,Y
"RTN","NURA6K2",63,0)
 Q
"RTN","NURA6K2",64,0)
NHDR I 'NURQUEUE,NURSW1,$E(IOST)="C" D ENDPG^NURSUT1 S:NUROUT NURQUIT=+NUROUT Q:NURQUIT
"RTN","NURA6K2",65,0)
 I 'NURSW1 S NURSW1=1
"RTN","NURA6K2",66,0)
 S NURPAGE=NURPAGE+1 W:$E(IOST)="C"!(NURPAGE>1) @IOF
"RTN","NURA6K2",67,0)
 I $G(NURMDSW) W !,?$$CNTR^NURSUT2(NURFAC(2)),$$FACL^NURSUT2(NURFAC(2))
"RTN","NURA6K2",68,0)
 W !,"NURSING SERVICE PROFICIENCY PROFILE" S X="T" D ^%DT D:+Y D^DIQ W ?90,Y,?105,"PAGE: ",NURPAGE
"RTN","NURA6K2",69,0)
 W !!,?51,"DATE",?91,"WORK COPY",?105,"COPY RET'D"
"RTN","NURA6K2",70,0)
 W !,"NAME",?23,"SSN",?40,"LOCATION",?51,"DUE",?65,"EVALUATOR",?91,"SENT OUT",?105,"FOR TYPING",!
"RTN","NURA6K2",71,0)
 S X="",$P(X,"-",132)="" W X,!
"RTN","NURA6K2",72,0)
 I $G(NURPLSW),$G(NURPROG(2))'="" N Z S Z=$$PROD^NURSUT2(NURPROG(2)) W !?$$CNTR^NURSUT2(Z),Z,!?$$CNTR^NURSUT2(Z),$$REPEAT^XLFSTR("-",$L(Z)+1),!
"RTN","NURA6K2",73,0)
 Q
"RTN","NURA9K")
0^1^B30313325
"RTN","NURA9K",1,0)
NURA9K ;HIRMFO/MD,FT-NURSING SERVICE PROFICIENCY REPORT BY LOCATION ; 1/3/03 1:08pm
"RTN","NURA9K",2,0)
 ;;4.0;NURSING SERVICE;**3,13,38**;Apr 25, 1997
"RTN","NURA9K",3,0)
 Q:'$D(^DIC(213.9,1,"OFF"))  Q:$P(^DIC(213.9,1,"OFF"),"^",1)=1
"RTN","NURA9K",4,0)
 S (NURQUIT,NURQUEUE,NUROUT)=0
"RTN","NURA9K",5,0)
 D EN1^NURSAUTL G QUIT:$G(NUROUT)
"RTN","NURA9K",6,0)
 I NURMDSW S DIC(0)="AEQMZ",NURPLSCR=1 D EN5^NURSAGSP G QUIT:$G(NUROUT)
"RTN","NURA9K",7,0)
 I NURMDSW=0,NURPLSW=1 S NURPLSCR=1 D PRD^NURSAGSP K NURPLSCR I $G(NUROUT) G QUIT
"RTN","NURA9K",8,0)
 W ! D EN1^NURSAGSP G QUIT:$G(NUROUT)
"RTN","NURA9K",9,0)
 D EN4^NURSAGP1 W ! G QUIT:$G(NUROUT)
"RTN","NURA9K",10,0)
 S ZTDESC="Nursing Proficiency Report by Location",ZTRTN="START^NURA9K",NURS132=1,ZTIO=ION D EN7^NURSUT0 G:POP!($D(ZTSK)) QUIT
"RTN","NURA9K",11,0)
START ;
"RTN","NURA9K",12,0)
 K ^TMP($J),^TMP("NURLOC",$J) U IO S (NURQUIT,NURPAGE,NURSW1)=0
"RTN","NURA9K",13,0)
 S X="" F  S X=$O(^NURSF(210,"AC",X)) Q:X=""  I '(X="R") F DA=0:0 S DA=$O(^NURSF(210,"AC",X,DA)) Q:DA'>0  I $D(^NURSF(210,DA,0)),+^(0) S DA(1)=+^(0) W:$R(100)&($E(IOST)="C") "." D SORT
"RTN","NURA9K",14,0)
 D:NURSZAP=7 EN4^NURSAUTL S X=$O(^TMP($J,""))
"RTN","NURA9K",15,0)
 I $O(^TMP($J,""))="",'$D(NURSNLOC) S NURFAC(2)=$S($G(NURFAC)=0:$G(NURFAC(1)),1:""),NURPROG(2)=$S($G(NURPROG)=0:$G(NURPROG(1)),1:"") D NHDR W !!,"THERE IS NO DATA FOR THIS REPORT"
"RTN","NURA9K",16,0)
 I $O(^TMP($J,""))="",$D(NURSNLOC) S NURFAC(2)=$S($G(NURFAC)=0:$G(NURFAC(1)),1:""),NURPROG(2)=$S($G(NURPROG)=0:$G(NURPROG(1)),1:"") D NHDR S NL1="" F  S NL1=$O(NURSNLOC(NL1)) Q:NL1=""  D NODATA^NURSUT1
"RTN","NURA9K",17,0)
 I $O(^TMP($J,""))'="",$D(NURSNLOC) D  I NURSW1=1 D ENDPG^NURSUT1 S NURSW1=0
"RTN","NURA9K",18,0)
 .  S (NURY,NURZ,NURX)="" F  S NURY=$O(^TMP($J,NURY)) Q:NURY=""  F  S NURZ=$O(^TMP($J,NURY,NURZ)) Q:NURZ=""  F  S NURX=$O(^TMP($J,NURY,NURZ,NURX)) Q:NURX=""  S ^TMP("NURLOC",$J,NURX)=""
"RTN","NURA9K",19,0)
 .  S NL1="" F  S NL1=$O(NURSNLOC(NL1)) Q:NL1=""  I '$D(^TMP("NURLOC",$J,NL1)) D
"RTN","NURA9K",20,0)
 .  .  S NURFAC(2)=$S($G(NURFAC)=0:$G(NURFAC(1)),1:""),NURPROG(2)=$S($G(NURPROG)=0:$G(NURPROG(1)),1:"") D:NURSW1=0 NHDR S NURSW1=1 D NODATA^NURSUT1
"RTN","NURA9K",21,0)
 .  .  Q
"RTN","NURA9K",22,0)
 .  Q
"RTN","NURA9K",23,0)
 U IO D NPRINT
"RTN","NURA9K",24,0)
QUIT ;
"RTN","NURA9K",25,0)
 K ^TMP($J) D CLOSE^NURSUT1,^NURAKILL
"RTN","NURA9K",26,0)
 Q
"RTN","NURA9K",27,0)
SORT ; POSITION SORT
"RTN","NURA9K",28,0)
 F NURNODE4=0:0 S NURNODE4=$O(^NURSF(211.8,"C",DA(1),NURNODE4)) Q:NURNODE4'>0  F NURNODE5=0:0 S NURNODE5=$O(^NURSF(211.8,"C",DA(1),NURNODE4,NURNODE5)) Q:NURNODE5'>0  D
"RTN","NURA9K",29,0)
 .I $D(^NURSF(211.8,NURNODE4,1,NURNODE5,0)),$P(^(0),U)'>DT&(('$P(^(0),U,6))!($P(^(0),U,6)'<DT)) D SORT1
"RTN","NURA9K",30,0)
 .Q
"RTN","NURA9K",31,0)
 Q
"RTN","NURA9K",32,0)
SORT1 Q:NURSZAP>7&(NURSZDA'=DA)  S NURSZORT=1 D EN3^NURSAUTL:NURSZAP>6,EN2^NURSAUTL:NURSZORT&NURSZAP Q:'NURSZORT
"RTN","NURA9K",33,0)
 S NURNEN=3 D SETFAC^NURAAGS1,SETPROG^NURAAGS1
"RTN","NURA9K",34,0)
 I $D(^VA(200,DA(1),0)) S N1=$S($P(^(0),"^",1)'="":$P(^(0),"^",1),1:"  BLANK")
"RTN","NURA9K",35,0)
 I $D(^VA(200,DA(1),1)) S SSN=$S($P(^(1),"^",9)'="":$P(^(1),"^",9),1:"  BLANK")
"RTN","NURA9K",36,0)
 S NLO=$S($D(^NURSF(211.8,NURNODE4,0))&$P(^NURSF(211.8,NURNODE4,0),"^")'="":$P(^(0),"^"),1:"  BLANK")
"RTN","NURA9K",37,0)
 I $D(^NURSF(211.4,"B",+NLO)) S NLO(1)=$O(^NURSF(211.4,"B",+NLO,0)) I $D(^NURSF(211.4,NLO(1),"I")),$E($P(^("I"),"^"))="I" Q
"RTN","NURA9K",38,0)
 D EN2^NURSUT0 S NURSER=$G(NPSPOS(1))
"RTN","NURA9K",39,0)
 S NPWARD=NLO D EN7^NURSAUTL S NL1=$S(NPWARD'="":$E(NPWARD,1,10),1:"  BLANK")
"RTN","NURA9K",40,0)
 Q:NURSER=""!'(NURSER="R")
"RTN","NURA9K",41,0)
 I '$D(^NURSF(210,DA,14,0)) Q
"RTN","NURA9K",42,0)
 S NURPROG("TST")=$G(NURPROG(2))
"RTN","NURA9K",43,0)
 S NN=0 F II=0:0 S NN=$O(^NURSF(210,DA,14,NN)) Q:NN'>0  D NGO
"RTN","NURA9K",44,0)
 K NURPROG("TST")
"RTN","NURA9K",45,0)
 Q
"RTN","NURA9K",46,0)
NGO I '$D(^NURSF(210,DA,14,NN,0)) Q
"RTN","NURA9K",47,0)
 S NDATA=^NURSF(210,DA,14,NN,0),NDD=$S($P(NDATA,"^")'="":$P(NDATA,"^"),1:"  BLANK"),NEV=$S($P(NDATA,"^",2)>0:$P(^VA(200,+$P(NDATA,"^",2),0),"^"),1:"  BLANK")
"RTN","NURA9K",48,0)
 I 'NURHOSP,'$D(NURSNLOC(NL1)) Q
"RTN","NURA9K",49,0)
 I 'NSP,NDD<NSPC!(NDD>NSPC(2)) Q
"RTN","NURA9K",50,0)
 I NURMDSW,'$G(NURFAC),$G(NURFAC(1))'=$G(NURFAC(2)) Q
"RTN","NURA9K",51,0)
 I NURPLSW,'$G(NURPROG),$G(NURPROG(1))'=NURPROG("TST") Q
"RTN","NURA9K",52,0)
 S:NURPROG(2)="NURSING" NURPROG(2)=" "_NURPROG(2)
"RTN","NURA9K",53,0)
 S ^TMP($J,NURFAC(2),NURPROG(2),NL1,NDD,N1,SSN,NEV,DA,NN)=""
"RTN","NURA9K",54,0)
 Q
"RTN","NURA9K",55,0)
NPRINT S NURFAC(2)="" F  S NURFAC(2)=$O(^TMP($J,NURFAC(2))) Q:NURFAC(2)=""!NURQUIT  D NM Q:NURQUIT
"RTN","NURA9K",56,0)
 Q
"RTN","NURA9K",57,0)
NM S NURPROG(2)="" F  S NURPROG(2)=$O(^TMP($J,NURFAC(2),NURPROG(2))) Q:NURPROG(2)=""!(NURQUIT)  D NN Q:NURQUIT
"RTN","NURA9K",58,0)
 Q
"RTN","NURA9K",59,0)
NN S NL1="" F  S NL1=$O(^TMP($J,NURFAC(2),NURPROG(2),NL1)) Q:NL1=""  D NHDR Q:NURQUIT  D NO Q:NURQUIT
"RTN","NURA9K",60,0)
 Q
"RTN","NURA9K",61,0)
NO F NDD=0:0 S NDD=$O(^TMP($J,NURFAC(2),NURPROG(2),NL1,NDD)) Q:NDD'>0  D NR Q:NURQUIT
"RTN","NURA9K",62,0)
 Q
"RTN","NURA9K",63,0)
NR S N1="" F  S N1=$O(^TMP($J,NURFAC(2),NURPROG(2),NL1,NDD,N1)) Q:N1=""  D NP Q:NURQUIT
"RTN","NURA9K",64,0)
 Q
"RTN","NURA9K",65,0)
NP S SSN="" F  S SSN=$O(^TMP($J,NURFAC(2),NURPROG(2),NL1,NDD,N1,SSN)) Q:SSN=""  D NQ Q:NURQUIT
"RTN","NURA9K",66,0)
 Q
"RTN","NURA9K",67,0)
NQ S NEV="" F  S NEV=$O(^TMP($J,NURFAC(2),NURPROG(2),NL1,NDD,N1,SSN,NEV)) Q:NEV=""  F DA=0:0 S DA=$O(^(NEV,DA)) Q:DA'>0  F D1=0:0 S D1=$O(^(DA,D1)) Q:D1'>0  D NPPRINT Q:NURQUIT
"RTN","NURA9K",68,0)
 Q
"RTN","NURA9K",69,0)
NPPRINT I 'NURSW1!($Y>(IOSL-6)) D NHDR Q:NURQUIT
"RTN","NURA9K",70,0)
 W !
"RTN","NURA9K",71,0)
 W:N1'="  BLANK" $E(N1,1,20)
"RTN","NURA9K",72,0)
 W:$D(SSN) ?25,$E(SSN,1,3),"-",$E(SSN,4,5),"-",$E(SSN,6,9)
"RTN","NURA9K",73,0)
 W:NL1'="  BLANK" ?40,$E(NL1,1,10)
"RTN","NURA9K",74,0)
 I NDD'="  BLANK" S Y=NDD D:+Y D^DIQ W:$D(Y) ?51,Y
"RTN","NURA9K",75,0)
 W:NEV'="  BLANK" ?65,$E(NEV,1,20)
"RTN","NURA9K",76,0)
 S DATA=$G(^NURSF(210,DA,14,D1,0)) F I=4,5 I +$P(DATA,U,I) S Y=$P(DATA,U,I) D D^DIQ S ZZ=$S(I=4:91,1:105) W ?ZZ,Y
"RTN","NURA9K",77,0)
 Q
"RTN","NURA9K",78,0)
NHDR I 'NURQUEUE,NURSW1,$E(IOST)="C" W $C(7),!!,"Press return to continue or ""^"" to exit: " R X:DTIME I '$T!(X="^") S NURQUIT=1 Q
"RTN","NURA9K",79,0)
 S NURPAGE=NURPAGE+1,NURSW1=1 W:$E(IOST)="C"!(NURPAGE>1) @IOF
"RTN","NURA9K",80,0)
 I $G(NURMDSW),$L($G(NURFAC(2)))>1 W !,?$$CNTR^NURSUT2(NURFAC(2)),$$FACL^NURSUT2(NURFAC(2))
"RTN","NURA9K",81,0)
 W !,"NURSING SERVICE PROFICIENCY PROFILE BY LOCATION" S X="T" D ^%DT D:+Y D^DIQ W ?90,Y,?105,"PAGE:  ",NURPAGE
"RTN","NURA9K",82,0)
 W !!,?51,"DATE",?91,"WORK COPY",?105,"COPY RET'D"
"RTN","NURA9K",83,0)
 W !,"NAME",?25,"SSN",?40,"LOCATION",?51,"DUE",?65,"EVALUATOR",?91,"SENT OUT",?105,"FOR TYPING",!
"RTN","NURA9K",84,0)
 S X="",$P(X,"-",132)="" W X
"RTN","NURA9K",85,0)
 I $G(NURPLSW),$L($G(NURPROG(2)))>1 N Z S Z=$$PROD^NURSUT2(NURPROG(2)) W !?$$CNTR^NURSUT2(Z),Z,!?$$CNTR^NURSUT2(Z),$$REPEAT^XLFSTR("-",$L(Z)+1),!
"RTN","NURA9K",86,0)
 Q
"RTN","NURACHDC")
0^5^B15066285
"RTN","NURACHDC",1,0)
NURACHDC ;HIRMFO/MD,FT-HEMODIALYSIS PATIENTS TO ACUITY TOTALS ; 3/20/03 12:44pm
"RTN","NURACHDC",2,0)
 ;;4.0;NURSING SERVICE;**7,17,38**;Apr 25, 1997
"RTN","NURACHDC",3,0)
EN1 ;ADD HEMODIALYSIS PATIENT TO AMIS COUNT
"RTN","NURACHDC",4,0)
 Q:'$D(^DIC(213.9,1,"OFF"))  Q:$P(^DIC(213.9,1,"OFF"),"^",1)=1
"RTN","NURACHDC",5,0)
 S HRSW=$O(^NURSF(213.3,"B","HEMODIALYSIS",0))_"^H",(NACT,NUROUT)=0 G PATCK
"RTN","NURACHDC",6,0)
EN2 ;ADD RECOVERY ROOM PATIENT TO AMIS COUNT
"RTN","NURACHDC",7,0)
 Q:'$D(^DIC(213.9,1,"OFF"))  Q:$P(^DIC(213.9,1,"OFF"),"^")=1
"RTN","NURACHDC",8,0)
 S HRSW=$O(^NURSF(213.3,"B","RECOVERY ROOM",0))_"^R",NUROUT=0,NACT=1
"RTN","NURACHDC",9,0)
PATCK S NASK=1,DIC(0)="EQM" D EN5^NURSCUTL
"RTN","NURACHDC",10,0)
 G:DFN'>0 QUIT
"RTN","NURACHDC",11,0)
 S PATNAM=$P(Y,"^",2)
"RTN","NURACHDC",12,0)
 S X="N",%DT="T" D ^%DT S NDATEX=+Y S:$E(NDATEX,8)'="." NDATEX=$E(NDATEX,1,7)_".00001" S NDATEX(0)=(+Y\1),HRSW(0)=$P(HRSW,U,2)
"RTN","NURACHDC",13,0)
 F DA(1)=0:0 S DA(1)=$O(^NURSA(214.6,"ACNT",NDATEX(0),DA(1))) Q:DA(1)'>0!(NUROUT)  F DA=0:0 S DA=$O(^NURSA(214.6,"ACNT",NDATEX(0),DA(1),HRSW(0),DA)) Q:DA'>0!(NUROUT)  I $P(^NURSA(214.6,DA,0),U,2)=DFN D EDIT Q
"RTN","NURACHDC",14,0)
 G:NUROUT QUIT
"RTN","NURACHDC",15,0)
 D CONTPRO G:NUROUT QUIT
"RTN","NURACHDC",16,0)
 G PATCK
"RTN","NURACHDC",17,0)
QUIT ; KILL LOCAL VARIABLES
"RTN","NURACHDC",18,0)
 K ^TMP($J) D ^NURAKILL
"RTN","NURACHDC",19,0)
 Q
"RTN","NURACHDC",20,0)
CONTPRO ; UPDATE ACUITY TOTALS
"RTN","NURACHDC",21,0)
 W !,$S($P(HRSW,"^",2)="H":"The Nurse who performed the hemodialysis is from which unit: ",$P(HRSW,"^",2)="R":"Recovery Room Location: ",1:"")
"RTN","NURACHDC",22,0)
 I $P(HRSW,"^",2)="R",+HRSW S NURDEFLT=$$LOCDEF^NURACHDC() W:NURDEFLT'="" NURDEFLT_"//"
"RTN","NURACHDC",23,0)
 R WARD:DTIME
"RTN","NURACHDC",24,0)
 I WARD["^"!'$T S NUROUT=1 Q
"RTN","NURACHDC",25,0)
 I $D(NURDEFLT),WARD="" S WARD=NURDEFLT
"RTN","NURACHDC",26,0)
 K NURDEFLT
"RTN","NURACHDC",27,0)
 S X=WARD,DIC="^NURSF(211.4,",DIC(0)="QEMZ",DIC("S")="I $S('$D(^(""I"")):1,$P(^(""I""),U)'=""I"":1,1:0),$S('$D(^(1)):1,$P(^(1),U)=""A"":1,1:0)" D ^DIC K DIC G:+Y'>0 CONTPRO
"RTN","NURACHDC",28,0)
 S WARD=+Y
"RTN","NURACHDC",29,0)
LOCK S DA=($P(^NURSA(214.6,0),"^",3)+1) L +^NURSA(214.6,DA,0):0 I '$T!$D(^NURSA(214.6,DA)) G LOCK
"RTN","NURACHDC",30,0)
CHK I $$DUPCLAS^NURSCUTL($G(NDATEX),DFN) S NDATEX=(NDATEX+.00001) G CHK
"RTN","NURACHDC",31,0)
 S X=NDATEX_"^"_DFN_"^"_1_"^"_"N/A"_"^"_"C"_"^"_DUZ_"^^"_WARD_"^"_HRSW,^NURSA(214.6,DA,0)=X
"RTN","NURACHDC",32,0)
 S ^NURSA(214.6,"AA",$P(X,"^",2),9999999-$P(X,"^"),DA)=""
"RTN","NURACHDC",33,0)
 S ^NURSA(214.6,"B",$E($P(X,"^",1),1,30),DA)=""
"RTN","NURACHDC",34,0)
 S ^NURSA(214.6,"C",$E($P(X,"^",2),1,30),DA)=""
"RTN","NURACHDC",35,0)
 S ^NURSA(214.6,"E",$E($P(X,"^",8),1,30),DA)=""
"RTN","NURACHDC",36,0)
 S ^NURSA(214.6,"ACNT",$P(X,"^")\1,WARD,$E($P(X,"^",10),1,30),DA)=""
"RTN","NURACHDC",37,0)
 S $P(^NURSA(214.6,0),"^",3,4)=DA_"^"_($P(^NURSA(214.6,0),"^",4)+1) L -^NURSA(214.6,DA,0)
"RTN","NURACHDC",38,0)
 W !!,PATNAM," HAS BEEN ADDED TO THE "_$S($P(HRSW,"^",2)="H":"HEMODIALYSIS",$P(HRSW,"^",2)="R":"RECOVERY ROOM")_" COUNT."
"RTN","NURACHDC",39,0)
 Q
"RTN","NURACHDC",40,0)
EDIT S NDATA=DA_"^"_^NURSA(214.6,DA,0) S Y=+$P(NDATA,U,2) D D^DIQ S NDATA(1)=Y W !!,"CLASSIFICATION DATE/TIME: "_Y_"//" R X:DTIME I X="^"!('$T) S NUROUT=1 Q
"RTN","NURACHDC",41,0)
 I X="@" D DELETE Q
"RTN","NURACHDC",42,0)
 S:X="" X=NDATA(1) S %DT="R" D ^%DT I X["?"!'((+Y\1)=($P(NDATA,U,2)\1)) W $C(7),!!,"Enter a date/time on "_$P(NDATA(1),"@") G EDIT
"RTN","NURACHDC",43,0)
 S NDATEX(2)=+Y,DIE="^NURSA(214.6,",DR=".01////^S X=NDATEX(2);5//;6//" D ^DIE
"RTN","NURACHDC",44,0)
 I '($P(NDATA,"^",2,11)=^NURSA(214.6,+DA,0)) S $P(^(0),"^",6)=DUZ
"RTN","NURACHDC",45,0)
 S NUROUT=1
"RTN","NURACHDC",46,0)
 Q
"RTN","NURACHDC",47,0)
DELETE W !!,$C(7),?3,"SURE YOU WANT TO DELETE THE "_NDATA(1)_" ENTRY " D YN^DICN I '(%>0) W !!,?5,"ANSWER YES OR NO" K % G DELETE
"RTN","NURACHDC",48,0)
 I %=1 S DIK="^NURSA(214.6," D ^DIK S (DA,DA(1))=""
"RTN","NURACHDC",49,0)
 S NUROUT=1 Q
"RTN","NURACHDC",50,0)
LOCDEF() ; find first active Nurs Location file (211.4) entry which has a
"RTN","NURACHDC",51,0)
 ; Recovery Room bedsection
"RTN","NURACHDC",52,0)
 N NURFOUND,NURBED,NURLOC S (NURFOUND,NURLOC)=0
"RTN","NURACHDC",53,0)
 F  S NURLOC=$O(^NURSF(211.4,"D","A",NURLOC)) Q:NURFOUND!(NURLOC'>0)  D  Q:NURFOUND
"RTN","NURACHDC",54,0)
 .  S NURBED=0 F  S NURBED=$O(^NURSF(211.4,NURLOC,4,NURBED)) Q:NURFOUND!(NURBED'>0)  I +$P($G(^NURSF(211.4,NURLOC,4,NURBED,0)),U)=+HRSW S NURFOUND=1
"RTN","NURACHDC",55,0)
 .   Q
"RTN","NURACHDC",56,0)
 Q $S(NURFOUND=1:$P($G(^SC($P(^NURSF(211.4,+NURLOC,0),U),0)),U),1:"")
"RTN","NURACHDC",57,0)
 ;
"RTN","NURAFSD")
0^3^B15353754
"RTN","NURAFSD",1,0)
NURAFSD ;HIRMFO/MD-EMPLOYEE ACT/SEP MANUAL AND TASKED REPORTS ; 4/25/03 2:37pm
"RTN","NURAFSD",2,0)
 ;;4.0;NURSING SERVICE;**2,14,38**;Apr 25, 1997
"RTN","NURAFSD",3,0)
 Q:'$D(^DIC(213.9,1,"OFF"))  Q:$P(^DIC(213.9,1,"OFF"),U,1)=1
"RTN","NURAFSD",4,0)
 W ! S (NURMDSW,NQSW,NUROUT)=0,X="T-30" D ^%DT S %DT(0)=Y,%DT("A")="Select Date of Staff Activation/Separation Report: ",%DT("B")="T-1",%DT="AE" D ^%DT K %DT I +Y'>0 S NUROUT=1 G QUIT
"RTN","NURAFSD",5,0)
 S NURSDATE=+Y
"RTN","NURAFSD",6,0)
 D EN9^NURSAGSP I NURMDSW W ! S DIC(0)="AEMQZ" D EN8^NURSAGSP G QUIT:$G(NUROUT)
"RTN","NURAFSD",7,0)
 W ! S ZTRTN="START^NURAFSD" D EN7^NURSUT0 I POP!($D(ZTSK)) S NUROUT=1 G QUIT
"RTN","NURAFSD",8,0)
START ;
"RTN","NURAFSD",9,0)
 K ^TMP($J)
"RTN","NURAFSD",10,0)
 S (NURSW1,NTCNT)=0,X=NURSDATE,DIC="^NURSA(213.5,",DIC(0)="",DIC("S")="I $P(^(0),U,2)=0" D ^DIC K DIC I '(+Y>0) S Y=NURSDATE D:+Y D^DIQ S NURSDATE=Y D HDGING W !,"NO DATA FOR "_NURSDATE G QUIT
"RTN","NURAFSD",11,0)
 S NURSDA=$S(Y'>0:"",1:+Y)
"RTN","NURAFSD",12,0)
 I $G(NURSDA) S DA(1)=NURSDA F DA=0:0 S DA=$O(^NURSA(213.5,+DA(1),2,+DA)) Q:DA'>0  I $D(^NURSA(213.5,+DA(1),2,+DA,0)) D
"RTN","NURAFSD",13,0)
 .  S NURSWARD=+$P($G(^NURSA(213.5,+DA(1),2,+DA,0)),U,5)
"RTN","NURAFSD",14,0)
 .  I NURMDSW S NURFAC(2)=$S($$EN12^NURSUT3(NURSWARD)'="":$$EN12^NURSUT3(NURSWARD),1:"  BLANK")
"RTN","NURAFSD",15,0)
 .  E  S NURFAC(2)="  BLANK"
"RTN","NURAFSD",16,0)
 .  I $G(NURFAC)=0,NURFAC(2)'="  BLANK",NURFAC(2)'=NURFAC(1) Q
"RTN","NURAFSD",17,0)
 .  S ^TMP($J,NURFAC(2),DA(1),DA)=""
"RTN","NURAFSD",18,0)
 .  Q
"RTN","NURAFSD",19,0)
 S DA=0 F  S DA=$O(^NURSA(213.2,DA)) Q:DA'>0  S Y=+^NURSA(213.2,+DA,0) I Y S X=$P(^DIC(4,+Y,0),U) D
"RTN","NURAFSD",20,0)
 .  I $G(NURFAC)=0,NURFAC(1)'="  BLANK",NURFAC(1)'=X Q
"RTN","NURAFSD",21,0)
 .  S:$G(X)'="" NURSFAC(X)=""
"RTN","NURAFSD",22,0)
 .  Q
"RTN","NURAFSD",23,0)
 I $G(NURMDSW)=1 S NURS="" F  S NURS=$O(NURSFAC(NURS)) Q:NURS=""  I '$D(^TMP($J,NURS)) D
"RTN","NURAFSD",24,0)
 . S NURFAC(2)=$S($G(NURS)="":"",1:NURS) D HDGING W !,"NO EMPLOYEES SEPARATED/ACTIVATED ON ",Y,! D ENDPG^NURSUT1
"RTN","NURAFSD",25,0)
 . Q
"RTN","NURAFSD",26,0)
 I $G(NURMDSW)=0 S NURS=$O(^TMP($J,"")) S NURFAC(2)=$S($G(NURS)="":"",1:NURS) I NURFAC(2)="" D
"RTN","NURAFSD",27,0)
 .  D HDGING W !,"NO EMPLOYEES SEPARARTED/ACTIVATED ON ",Y,! D ENDPG^NURSUT1
"RTN","NURAFSD",28,0)
 .  Q
"RTN","NURAFSD",29,0)
 S NURFAC(2)="" F  S NURFAC(2)=$O(^TMP($J,NURFAC(2))) Q:NURFAC(2)=""  D TOTAL,HDGING S DA(1)=0 F  S DA(1)=$O(^TMP($J,NURFAC(2),DA(1))) Q:DA(1)'>0  S DA=0 F  S DA=$O(^TMP($J,NURFAC(2),DA(1),DA)) Q:DA'>0  D PRINT
"RTN","NURAFSD",30,0)
 D TOTAL
"RTN","NURAFSD",31,0)
QUIT D CLOSE^NURSUT1,^NURAKILL
"RTN","NURAFSD",32,0)
 K ^TMP($J)
"RTN","NURAFSD",33,0)
 Q
"RTN","NURAFSD",34,0)
TOTAL ;
"RTN","NURAFSD",35,0)
 S:'+NTCNT NUROUT=1 I +NTCNT W !!,"TOTAL EMPLOYEES SEPARATED/ACTIVATED: ",NTCNT
"RTN","NURAFSD",36,0)
 Q
"RTN","NURAFSD",37,0)
PRINT ;
"RTN","NURAFSD",38,0)
 I ($Y>(IOSL-10))!'(NURSW1) D HDGING
"RTN","NURAFSD",39,0)
 S NURSEMP=^NURSA(213.5,DA(1),2,DA,0) I $D(^VA(200,$P(NURSEMP,U),0)) W !,$E($P(^(0),U),1,20)
"RTN","NURAFSD",40,0)
 W ?20,$S($P(NURSEMP,U,2)="S":"SEP",$P(NURSEMP,U,2)="A":"ACT",1:"") S NPWARD=$P(NURSEMP,U,5) D EN6^NURSAUTL W ?29,$E(NPWARD,1,10)
"RTN","NURAFSD",41,0)
 S Y=$P(NURSEMP,U,3) W ?39," " D DT^DIQ W:$D(^NURSF(211.3,+$P(NURSEMP,U,6),0)) ?53,$P(^(0),U) W:$D(^NURSF(211.9,+$P(NURSEMP,U,4),0)) ?64,$E($P(^(0),U,2),1,15) S NTCNT=NTCNT+1
"RTN","NURAFSD",42,0)
 Q
"RTN","NURAFSD",43,0)
HDGING ;
"RTN","NURAFSD",44,0)
 I $G(NUROUT) I '$G(NURQUEUE),$E(IOST)="C",$G(NURSW1) D ENDPG^NURSUT1 S:NUROUT=1 NURQUIT=+NUROUT Q:$G(NURQUIT)
"RTN","NURAFSD",45,0)
 W:$Y>0 @IOF
"RTN","NURAFSD",46,0)
 W !,"ON THE REPORT DATE, ASSIGNMENTS FOR THE FOLLOWING EMPLOYEES WERE",!,"ACTIVATED/SEPARATED.  THE STATUS INDICATORS WERE MODIFIED APPROPRIATELY:",!
"RTN","NURAFSD",47,0)
 I NURMDSW,$G(NURFAC(2))'="" W !,?$$CNTR^NURSUT2(NURFAC(2)),$$FACL^NURSUT2(NURFAC(2))
"RTN","NURAFSD",48,0)
 S Y=NURSDATE D:+Y D^DIQ W !,?15,"EMPLOYEE ACTIVATION/SEPARATION REPORT "_Y S NURSW1=1
"RTN","NURAFSD",49,0)
 W !,"NAME",?20,"ACT/SEP",?29,"LOCATION",?40,"ST/VAC DT",?53,"POSITION",?63,"REASON",!,$$REPEAT^XLFSTR("-",80)
"RTN","NURAFSD",50,0)
 S NURSW1=1
"RTN","NURAFSD",51,0)
 Q
"RTN","NURSUT0")
0^2^B30181021
"RTN","NURSUT0",1,0)
NURSUT0 ;HIRMFO/MD,RM,FT-NURS STAFF FILE EDIT UTILITY ; 1/17/03 2:54pm
"RTN","NURSUT0",2,0)
 ;;4.0;NURSING SERVICE;**1,16,18,33,34,38**;Apr 25, 1997
"RTN","NURSUT0",3,0)
 ;
"RTN","NURSUT0",4,0)
 ; Reference to File #452.3 is supported by IA #1400
"RTN","NURSUT0",5,0)
 ; Reference to ^PRSPC is supported by IA #1402
"RTN","NURSUT0",6,0)
 ; File #200 is covered by supported reference #10060
"RTN","NURSUT0",7,0)
 ;
"RTN","NURSUT0",8,0)
EN1(NURSEMP,NURSDT) ; DETERMINE IF EMPLOYEE HAS ANY ACTIVE ASSIGNMENTS
"RTN","NURSUT0",9,0)
 ;VARIBLES NURSDT=TODAY, AND NURSEMP=EMPLOYEE POINTER TO FILE 200
"RTN","NURSUT0",10,0)
 ;ARE PASSED INTO THE ROUTINE AND VARIBLE NURSTAT IS RETURNED=1 IF AN
"RTN","NURSUT0",11,0)
 ;ACTIVE POSITION EXISTS AND NURSTAT=0 IF NO ACTIVE POSITIONS EXIST.
"RTN","NURSUT0",12,0)
 ;ACTIVE POSITIONS HAVE A START DATE '>TODAY AND NO VACANCY DATE OR A
"RTN","NURSUT0",13,0)
 ;VACANCY DATE '<TODAY
"RTN","NURSUT0",14,0)
 S NURSTAT=0,NURSDT=$P(NURSDT,".") D
"RTN","NURSUT0",15,0)
 .F NI(1)=0:0 S NI(1)=$O(^NURSF(211.8,"C",+NURSEMP,NI(1))) Q:NI(1)'>0  F NI=0:0 S NI=$O(^NURSF(211.8,"C",+NURSEMP,NI(1),NI)) Q:NI'>0  I +^NURSF(211.8,NI(1),1,NI,0)'>NURSDT&(('+$P(^(0),U,6))!(+$P(^(0),U,6)'<NURSDT)) S NURSTAT=1
"RTN","NURSUT0",16,0)
 .K NURSDT,NURSEMP,NURI
"RTN","NURSUT0",17,0)
 .Q
"RTN","NURSUT0",18,0)
 Q $S(NURSTAT=1:1,1:0)
"RTN","NURSUT0",19,0)
EN2 ; FIND PRIMARY SERVICE POSITION
"RTN","NURSUT0",20,0)
 Q:'$D(^NURSF(210,DA,0))  S ID=+^(0) Q:ID'>0  S (NOD1,NOD2,NPSPOS,NPSPOS(0),NPSPOS(1))=""
"RTN","NURSUT0",21,0)
 I '($P(^NURSF(210,DA,0),U,2)="R") D EN3 G SVPOS
"RTN","NURSUT0",22,0)
 I $D(^NURSF(211.8,"AE",ID)) F NURSX=0:0 S NURSX=$O(^NURSF(211.8,"AE",ID,1,NURSX)) Q:NURSX'>0  F NURSZ=0:0 S NURSZ=$O(^NURSF(211.8,"AE",ID,1,NURSX,NURSZ)) Q:NURSZ'>0  I +$G(^NURSF(211.8,NURSX,1,NURSZ,0)) D
"RTN","NURSUT0",23,0)
 .  S NURS("AE",(9999999-+$G(^NURSF(211.8,NURSX,1,NURSZ,0))),NURSX,NURSZ)=""
"RTN","NURSUT0",24,0)
 .  Q
"RTN","NURSUT0",25,0)
 I $O(NURS("AE",0)) S NURSX=$O(NURS("AE",0)),NOD1=$O(NURS("AE",NURSX,0)),NOD2=$O(NURS("AE",NURSX,NOD1,0))
"RTN","NURSUT0",26,0)
SVPOS Q:'$D(^NURSF(211.8,+NOD1,1,+NOD2,0))  S NPNT=$P(^NURSF(211.8,NOD1,1,NOD2,0),U,3) S NPSPOS=$S('$D(^NURSF(211.3,NPNT,0)):"",1:$P(^(0),U)),NPSPOS(0)=NPNT,NPSPOS(1)=$S('$D(^NURSF(211.3,NPNT,0)):"",1:$P(^(0),U,5))
"RTN","NURSUT0",27,0)
 S SC44DA=+$G(^NURSF(211.8,NOD1,0)),NUR2114D=$O(^NURSF(211.4,"B",SC44DA,0))
"RTN","NURSUT0",28,0)
 S NPNT(1)=+$P(^NURSF(211.3,NPNT,0),U,7),NURFLAG=1
"RTN","NURSUT0",29,0)
 ; GET PRODUCT LINE/FACILITY OF PRIMARY POSITION
"RTN","NURSUT0",30,0)
 S NPSPOS(2)=$S(NPNT(1):$$GET1^DIQ(212.7,NPNT(1),.01,"I"),1:"")
"RTN","NURSUT0",31,0)
 S (NPSPOS(3),NPSPOS(4))="" I NOD1 D
"RTN","NURSUT0",32,0)
 .  S NPSPOS(3)=$$EN11^NURSUT3(NOD1)
"RTN","NURSUT0",33,0)
 .  S NPSPOS(4)=$$EN13^NURSUT3(NOD1)
"RTN","NURSUT0",34,0)
 K NURS,NURFLAG,NPI,NPNT,NPI1,ID Q
"RTN","NURSUT0",35,0)
 Q
"RTN","NURSUT0",36,0)
EN3 ; SELECT FIRST ACTIVE PRIMARY ASSIGNMENT
"RTN","NURSUT0",37,0)
 S (NOD1,NOD2)="",NURFLAG=0,ID=$S($P($G(^NURSF(210,+DA,0)),U):$P(^(0),U),1:"") Q:ID=""
"RTN","NURSUT0",38,0)
 F NUI(1)=0:0 S NUI(1)=$O(^NURSF(211.8,"AE",ID,1,NUI(1))) Q:NUI(1)'>0!(NURFLAG=1)  F NUI=0:0 S NUI=$O(^NURSF(211.8,"AE",ID,1,NUI(1),NUI)) Q:NUI'>0!(NURFLAG=1)  D CHECK
"RTN","NURSUT0",39,0)
 K NUI,ID
"RTN","NURSUT0",40,0)
 Q
"RTN","NURSUT0",41,0)
CHECK ;
"RTN","NURSUT0",42,0)
 I +$P(^NURSF(211.8,NUI(1),1,NUI,0),U)'>DT&(('+$P(^(0),U,6))!($P(^(0),U,6)'<DT)) S NOD1=NUI(1),NOD2=NUI,NOD2(1)=$P(^(0),U) S NURFLAG=1
"RTN","NURSUT0",43,0)
 Q
"RTN","NURSUT0",44,0)
EN4 ;SET LOGIC FOR DE XREF OF 211.82 SUBFILE
"RTN","NURSUT0",45,0)
 S:+$P(NUR,U,3) ^NURSF(211.8,"AD",X,$P(NUR,U,3),DA(1),DA)="" S:+$P(NUR,U,9) ^NURSF(211.8,"AE",X,$P(NUR,U,9),DA(1),DA)="" K NUR
"RTN","NURSUT0",46,0)
 Q
"RTN","NURSUT0",47,0)
EN5 ;KILL LOGIC FOR DE XREF 0F 211.82 SUBFILE
"RTN","NURSUT0",48,0)
 K:+$P(NUR,U,3) ^NURSF(211.8,"AD",X,$P(NUR,U,3),DA(1),DA) K:+$P(NUR,U,9) ^NURSF(211.8,"AE",X,$P(NUR,U,9),DA(1),DA) K NUR
"RTN","NURSUT0",49,0)
 Q
"RTN","NURSUT0",50,0)
EN6 ; SELECT MULTIPLE REPORT COPIES
"RTN","NURSUT0",51,0)
 W !?5,"How many copies of this report are required: 1// " R NCOPY:DTIME
"RTN","NURSUT0",52,0)
 I NCOPY=U!('$T) S NURQUIT=1 Q
"RTN","NURSUT0",53,0)
 S:NCOPY="" NCOPY=1 I NCOPY'=+NCOPY!(NCOPY<1)!(NCOPY>20) W !,$C(7),?5,"ANSWER WITH A NUMBER BETWEEN 1 AND 20",!! G EN6
"RTN","NURSUT0",54,0)
 Q
"RTN","NURSUT0",55,0)
EN7 ; NURS DEVICE HANDLING/QUEUEING LOGIC
"RTN","NURSUT0",56,0)
 K ZTSK S %ZIS="Q" S:$G(NURS132) %ZIS("B")=""
"RTN","NURSUT0",57,0)
 D ^%ZIS K %ZIS K:POP IO("Q") I POP S (NUROUT,NURQUIT)=1 Q
"RTN","NURSUT0",58,0)
 I IO'=IO(0),$E(IOST)="P",'$D(IO("Q")),'$D(IO("S")),IOST'["P-MESSAGE-HFS" S XQH="NURS-PRINTER QUEUE" W $C(7) D EN^XQH K XQH G EN7
"RTN","NURSUT0",59,0)
 I $G(NURS132),IOM<132 D ^%ZISC W !,$C(7)," ** THIS REPORT MUST BE SENT TO A 132 COLUMN DEVICE **",! K IO("Q"),IO("C") G EN7
"RTN","NURSUT0",60,0)
 I '$D(ZTDESC) S ZTDESC=$S($D(ZTRTN):ZTRTN,1:"Unknown NURSING option")
"RTN","NURSUT0",61,0)
 F X="A*","B*","C*","D*","E*","F*","G*","H*","I*","J*","K*","L*","M*","N*","O*","P*","Q*","R*","S*","T*","U*","V*","W*","Y*","Z*" S ZTSAVE(X)=""
"RTN","NURSUT0",62,0)
 S NURQUEUE=0 I $D(IO("Q")) K IO("Q"),IO("C") S NURQUEUE=1,ZTIO=ION_";"_IOST_";"_IOM_";"_IOSL D ^%ZTLOAD S NURQUEUE=0 S:'$D(ZTSK) POP=1
"RTN","NURSUT0",63,0)
 Q
"RTN","NURSUT0",64,0)
EN8 ; INPUT TRANSFORM FOR 2.1 & 2.5 SUBFIELDS OF FIELD 22.5
"RTN","NURSUT0",65,0)
 ;OF FILE 210
"RTN","NURSUT0",66,0)
 S NURS(0)=$S($D(^NURSF(210,DA(1),20,DA,0)):^(0),1:""),NURS("HELP")="DATE MUST BE "_$P("GREATER THAN DATE STARTED OR A VALID DATE ^LESS THAN DATE ENDED OR A VALID DATE ",U,NURS*10=21+1)
"RTN","NURSUT0",67,0)
 S %DT(0)=+($E("-",NURS*10=21)_$P(NURS(0),U,$E(56,NURS*10=21+1)))
"RTN","NURSUT0",68,0)
 S NURS(1)=$S(NURS=2.5&%DT(0)=0:1,1:0)
"RTN","NURSUT0",69,0)
 K:%DT(0)=0 %DT(0) S %DT="E" D ^%DT S X=Y I Y<1 W !?5,NURS("HELP") K X,NURS Q
"RTN","NURSUT0",70,0)
 S %DT(0)="-"_DT,%DT="E" D ^%DT S X=Y I Y<1 W !?5,"DATE MUST BE A CURRENT OR PAST DATE" K X,NURS Q
"RTN","NURSUT0",71,0)
 I NURS(1) S $P(^NURSF(210,DA(1),20,DA,0),U,5)=X
"RTN","NURSUT0",72,0)
 K %DT,NURS
"RTN","NURSUT0",73,0)
 Q
"RTN","NURSUT0",74,0)
EN9 ; FIND TOUR OF DUTY FROM STAFF FILE
"RTN","NURSUT0",75,0)
 D EN3^NURSUT0 S NUR=$S('$D(^NURSF(211.8,+NOD1,1,+NOD2,0)):"",1:$P(^(0),U,10)),NUR(1)=$S('$D(^NURSF(211.6,+NUR,0)):"",1:$P(^(0),U))
"RTN","NURSUT0",76,0)
 K NOD1,NOD2
"RTN","NURSUT0",77,0)
 Q
"RTN","NURSUT0",78,0)
EN11(D0) ; PRINT EMPLOYEE MI REVIEW GROUPS
"RTN","NURSUT0",79,0)
 S VA200DA=+$G(^NURSF(210,D0,0)),SSN=$P($G(^VA(200,+VA200DA,1)),U,9),PDA=$S(SSN="":0,1:$O(^PRSPC("SSN",SSN,0)))
"RTN","NURSUT0",80,0)
 I PDA>0 W !,?$S($G(EDIT)=1:0,1:9),"MI REVIEW GROUP: " F D1=0:0 S D1=$O(^PRSPC(PDA,5,D1)) Q:D1'>0  I $G(^PRSPC(PDA,5,D1,0))'="" S PRSE=+$G(^(0)) W ?$S($G(EDIT)=1:18,1:26),$P($G(^PRSE(452.3,+PRSE,0)),U) W:$O(^PRSPC(PDA,5,D1)) !
"RTN","NURSUT0",81,0)
 Q
"RTN","NURSUT0",82,0)
EN12(DA) ; PRINT EMPLOYEE SALARY
"RTN","NURSUT0",83,0)
 N X,Y,DM,D0,DE,DC,DG,DI,DIC,DIEL,DIFLD,DK,DQ,DP,DH,DL,DIE,DR
"RTN","NURSUT0",84,0)
 S SDA=DA,(PDA,XXX)=0,DA200=+$G(^NURSF(210,DA,0)),SSN=$P($G(^VA(200,+DA200,1)),U,9) S:$G(SSN)'="" PDA=$O(^PRSPC("SSN",SSN,0))
"RTN","NURSUT0",85,0)
 I PDA>0 S XXX=$P($G(^PRSPC(PDA,0)),U,29),Y=$P($G(^(0)),U,28) D:+Y>0 D^DIQ S $P(XXX,U,2)=Y S DA=SDA K PDA,SSN,DA200
"RTN","NURSUT0",86,0)
 Q XXX
"RTN","NURSUT0",87,0)
EN13(DA) ; LATEST PROMOTION DATE
"RTN","NURSUT0",88,0)
 N X,Y,DM,D0,DE,DC,DG,DI,DIC,DIEL,DIFLD,DK,DQ,DP,DH,DL,DIE,DR
"RTN","NURSUT0",89,0)
 S SDA=DA,Z=$O(^NURSF(210,DA,9,"AA",0)),Y=(9999999-Z) D:+Y>0 D^DIQ S XXX=Y
"RTN","NURSUT0",90,0)
 Q XXX
"RTN","NURSUT3")
0^6^B30070649
"RTN","NURSUT3",1,0)
NURSUT3 ;HIRMFO/RM,MD-UTILITIES FOR FILES 210 AND 211.8 ; 3/4/03 10:51am
"RTN","NURSUT3",2,0)
 ;;4.0;NURSING SERVICE;**33,38**;Apr 25, 1997
"RTN","NURSUT3",3,0)
 ;
"RTN","NURSUT3",4,0)
 ; Reference to ^SC is supported by IA #1416
"RTN","NURSUT3",5,0)
 ; Reference to File #454.1 is supported by IA #1404
"RTN","NURSUT3",6,0)
 ; ^XSEC is covered by supported reference #10076 
"RTN","NURSUT3",7,0)
 ;
"RTN","NURSUT3",8,0)
EN1 ; INPUT TRANSFORM FOR THE VACANCY DATE (#3) OF THE OCCUPANCY/TRANS.
"RTN","NURSUT3",9,0)
 ; DATE (#2) FIELD OF THE POSITION CONTROL FILE.
"RTN","NURSUT3",10,0)
 S NUR(0)=$P($G(^NURSF(211.8,DA(1),0)),U,1,2)_U_$S($D(^NURSF(211.8,DA(1),1,DA,0)):^(0),1:""),NURSBAD=$S(Y'>+NUR(0):"1^3",1:0)
"RTN","NURSUT3",11,0)
 I 'NURSBAD S $P(NUR(0),U,8)=X D EN3^NURSUT2
"RTN","NURSUT3",12,0)
 K:NURSBAD X D EN4
"RTN","NURSUT3",13,0)
 Q
"RTN","NURSUT3",14,0)
EN2 ; ENTRY FROM INPUT TRANSFORM FOR 1 & 1.5 SUBFIELDS OF FIELD 27
"RTN","NURSUT3",15,0)
 ; OF FILE 210
"RTN","NURSUT3",16,0)
 S NURS(0)=$S($D(^NURSF(210,DA(1),18,DA,0)):^(0),1:""),NURS("HELP")="DATE MUST BE "_$P("GREATER THAN DATE STARTED ^LESS THAN DATE ENDED ",U,NURS*10=10+1),%DT(0)=+($E("-",NURS*10=10)_$P(NURS(0),U,$E(24,NURS*10=10+1)))
"RTN","NURSUT3",17,0)
 K:%DT(0)=0 %DT(0) S %DT="E" D ^%DT S X=Y I Y<1 W !?5,NURS("HELP") K X
"RTN","NURSUT3",18,0)
 K %DT,NURS
"RTN","NURSUT3",19,0)
 Q
"RTN","NURSUT3",20,0)
EN3 ; ENTRY FROM INPUT TRANSFORM ON SUBFIELD .01 OF SUBFIELD 5.5 OF
"RTN","NURSUT3",21,0)
 ; FIELD 27 IN FILE 20
"RTN","NURSUT3",22,0)
 S NURS=0 F D1=0:0 S D1=$O(^NURSF(210,DA(2),18,D1)) Q:D1'>0  F D2=0:0 S D2=$O(^NURSF(210,DA(2),18,D1,1,D2)) Q:D2'>0  I $D(^NURSF(210,DA(2),18,D1,1,D2,0)) S NURS(0)=$P(^(0),U) S:X=$P(NURS(0),U) NURS=1
"RTN","NURSUT3",23,0)
 I '+NURS W !!,$C(7),?5,"NO FUNDS WERE REQUESTED FOR "_$S(X="T":"TRAVEL",X="A":"AIRFARE",X="P":"PER DIEM",1:"REGISTRATION")_":" K X
"RTN","NURSUT3",24,0)
 K NURS
"RTN","NURSUT3",25,0)
 Q
"RTN","NURSUT3",26,0)
EN4 ; PRINT ERROR MESSAGE BASED ON WHAT IS RETURNED FROM EN3
"RTN","NURSUT3",27,0)
 ; INPUT VARIABLES: NURSBAD=$S(0:NO PROB,1:PROB)^$S(1:FTEE>1,2:DUP PRI,
"RTN","NURSUT3",28,0)
 ;                                               3:STARTDT>VACDT,4:DUP)
"RTN","NURSUT3",29,0)
 ;                                               SERVICE POS,5:NO PRI)
"RTN","NURSUT3",30,0)
 ;                                               ASS:ERR,7:DUP DUTY
"RTN","NURSUT3",31,0)
 ;                                               TOURS)
"RTN","NURSUT3",32,0)
 I NURSBAD W !!?5,$C(7) W:'($P(NURSBAD,U,2)=5) "DUE TO CHANGES THAT HAVE BEEN MADE, "
"RTN","NURSUT3",33,0)
 I  W $S($P(NURSBAD,U,2)=1:"THE TOTAL FTEE",$P(NURSBAD,U,2)=2:"TWO PRIMARY ASSIGNMENTS EXIST FOR",$P(NURSBAD,U,2)=3:"THE START DATE IS GREATER THAN",$P(NURSBAD,U,2)=4:"DUPLICATE SERVICE POSITIONS ON THE",1:"")
"RTN","NURSUT3",34,0)
 I  W $S($P(NURSBAD,U,2)=7:"DUPLICATE DUTY TOURS ON THE",1:"")
"RTN","NURSUT3",35,0)
 I  W $S($P(NURSBAD,U,2)=1:"",$P(NURSBAD,U,2)=2:"",$P(NURSBAD,U,2)=3:"",$P(NURSBAD,U,2)=4:"",$P(NURSBAD,U,2)=5:"NO PRIMARY POSITION WAS DESIGNATED, THIS POSITION WILL BE PRIMARY",$P(NURSBAD,U,2)=7:"",1:"")
"RTN","NURSUT3",36,0)
 I  W $S($P(NURSBAD,U,2)=1:"",$P(NURSBAD,U,2)=2:"",$P(NURSBAD,U,2)=3:"",$P(NURSBAD,U,2)=4:"",$P(NURSBAD,U,2)=5:"",$P(NURSBAD,U,2)=6:"NO PRIMARY POSITION EXISTS FOR THIS ",$P(NURSBAD,U,2)=7:"",1:"INVALID DATA EXISTS FOR THIS")
"RTN","NURSUT3",37,0)
 I  W !?5,$S($P(NURSBAD,U,2)=1:"WOULD BE GREATER THAN 1 FOR THIS ",$P(NURSBAD,U,2)=2:"THIS ",$P(NURSBAD,U,2)=3:"THE VACANCY DATE FOR THIS ",$P(NURSBAD,U,2)=4!($P(NURSBAD,U,2)=7):"SAME LOCATION EXIST FOR THIS ",1:"")
"RTN","NURSUT3",38,0)
 I  W:'($P(NURSBAD,U,2)=5) "EMPLOYEE. PLEASE RETRY THE CHANGE.",!
"RTN","NURSUT3",39,0)
 K NURSBAD,NX
"RTN","NURSUT3",40,0)
 Q
"RTN","NURSUT3",41,0)
EN5 ; ENTRY FROM INPUT TRANSFORM FOR 2 & 3 SUBFIELDS OF FIELD 24
"RTN","NURSUT3",42,0)
 ; OF FILE 210
"RTN","NURSUT3",43,0)
 S NURS(0)=$S($D(^NURSF(210,DA(1),12,DA,0)):^(0),1:""),NURS("HELP")="DATE MUST BE "_$P("GREATER THAN DATE STARTED ^LESS THAN DATE ENDED ",U,NURS*10=20+1),%DT(0)=+($E("-",NURS*10=20)_$P(NURS(0),U,$E(23,NURS*10=20+1)))
"RTN","NURSUT3",44,0)
 S:%DT(0)=0 %DT(0)=2500101 ;this check stops erroneous years from being entered if user responds with 010100 and FileMan returns 1/1/1900
"RTN","NURSUT3",45,0)
 K:%DT(0)=0 %DT(0) S %DT="E" D ^%DT S X=Y I Y<1 W !?5,NURS("HELP") K X
"RTN","NURSUT3",46,0)
 K %DT,NURS
"RTN","NURSUT3",47,0)
 Q
"RTN","NURSUT3",48,0)
EN6(DA) ; SCREEN IF EMPLOYEE IS AUTHORIZED TO VIEW THIS LOCATION
"RTN","NURSUT3",49,0)
 ;   VARIABLES ARE SET BASED ON DIC("S") TO FILE 210.
"RTN","NURSUT3",50,0)
 ;
"RTN","NURSUT3",51,0)
 S NURSZORT=1
"RTN","NURSUT3",52,0)
 N NURNODE4,NUR200DA,NUR21182,NURDATA,NURSSEE
"RTN","NURSUT3",53,0)
 S NUR200DA=+$G(^NURSF(210,+Y,0)) I NUR200DA'>0 S NURSZORT=0
"RTN","NURSUT3",54,0)
 I NURSZORT D
"RTN","NURSUT3",55,0)
 .  I $G(NURSZAP)>6 D  Q:'NURSZORT  ; Check location security.
"RTN","NURSUT3",56,0)
 .  .  S NURSZORT=0
"RTN","NURSUT3",57,0)
 .  .  S NURNODE4=0 F  S NURNODE4=$O(^NURSF(211.8,"C",NUR200DA,NURNODE4)) Q:NURNODE4'>0  D  Q:NURSZORT
"RTN","NURSUT3",58,0)
 .  .  .  S NUR21182=0 F  S NUR21182=$O(^NURSF(211.8,"C",NUR200DA,NURNODE4,NUR21182)) Q:NUR21182'>0  D  Q:NURSZORT
"RTN","NURSUT3",59,0)
 .  .  .  .  S NURDATA=$G(^NURSF(211.8,NURNODE4,1,NUR21182,0)) Q:NURDATA=""
"RTN","NURSUT3",60,0)
 .  .  .  .  Q:$P(NURDATA,U)=""!($P(NURDATA,U)>DT)!($P(NURDATA,U,6)'=""&($P(NURDATA,U,6)'>DT))
"RTN","NURSUT3",61,0)
 .  .  .  .  S NURSZORT=1 D EN3^NURSAUTL
"RTN","NURSUT3",62,0)
 .  .  .  .  Q
"RTN","NURSUT3",63,0)
 .  .  .  Q
"RTN","NURSUT3",64,0)
 .  .  Q
"RTN","NURSUT3",65,0)
 .  D EN2^NURSAUTL:$G(NURSZAP) ; Check service position security.
"RTN","NURSUT3",66,0)
 .  Q
"RTN","NURSUT3",67,0)
 Q +$G(NURSZORT)
"RTN","NURSUT3",68,0)
 ;
"RTN","NURSUT3",69,0)
EN7(DUZ) ; PRSE TRAIN SECURITY KEY CHECK
"RTN","NURSUT3",70,0)
 Q $S($D(^XUSEC("PRSE TRAIN",DUZ)):1,1:0)
"RTN","NURSUT3",71,0)
EN8(DUZ) ; PRSE SUP SECURITY KEY CHECK
"RTN","NURSUT3",72,0)
 Q $S($D(^XUSEC("PRSE SUP",DUZ)):1,1:0)
"RTN","NURSUT3",73,0)
EN9(DUZ) ; PRSE CORD SECURITY KEY CHECK
"RTN","NURSUT3",74,0)
 Q $S($D(^XUSEC("PRSE CORD",DUZ)):1,1:0)
"RTN","NURSUT3",75,0)
EN10(DUZ) ;
"RTN","NURSUT3",76,0)
 I NURSZAP>0,+$$EN8^NURSUT3($G(DUZ)) S NURSZAP=0 Q
"RTN","NURSUT3",77,0)
 I NURSZAP>0,+$$EN9^NURSUT3($G(DUZ)) S NURSZAP=0 Q
"RTN","NURSUT3",78,0)
 I NURSZAP>7,+$$EN7^NURSUT3($G(DUZ)) S NURSZAP=7
"RTN","NURSUT3",79,0)
 Q
"RTN","NURSUT3",80,0)
EN11(DA) ; GET FACILITY WITH POSITION CONTROL IEN IN THE NURS POSITION
"RTN","NURSUT3",81,0)
 ; CONTROL 211.8 FILE. THE VALUE OF THE FUNCTION WILL BE "" IF THERE
"RTN","NURSUT3",82,0)
 ; IS NO FACILITY ASSOCIATED WITH THIS HOSPITAL LOCATION, OR THE
"RTN","NURSUT3",83,0)
 ; FREE TEXT VALUE OF THE FACILITY
"RTN","NURSUT3",84,0)
 S XXX="",DIC44DA=+$$GET1^DIQ(211.8,DA,.01,"I")
"RTN","NURSUT3",85,0)
 I DIC44DA S DIC4DA=+$$GET1^DIQ(44,DIC44DA,3,"I") I DIC4DA S XXX=$$GET1^DIQ(4,+DIC4DA,.01,"I")
"RTN","NURSUT3",86,0)
 S:XXX="" XXX=$S($G(NURMDSW):"  BLANK",$G(^NURSA(213.2,1,0)):$$GET1^DIQ(4,+$G(^NURSA(213.2,1,0)),.01,"I"),1:"")
"RTN","NURSUT3",87,0)
 K DIC44DA,DIC4DA
"RTN","NURSUT3",88,0)
 Q XXX
"RTN","NURSUT3",89,0)
EN12(DA) ; GET FACILITY WITH IEN FROM THE NURS LOCATION 211.4 FILE
"RTN","NURSUT3",90,0)
 ; THE VALUE OF THE FUNCTION WILL BE " BLANK" IF THERE IS NO FACILITY ASSOCIATED
"RTN","NURSUT3",91,0)
 ; WITH THIS NURS LOCATION OR THE FREE TEXT VALUE OF THE FACILITY
"RTN","NURSUT3",92,0)
 S XXX="",DIC4DA=+$P($G(^SC(+$G(^NURSF(211.4,+DA,0)),0)),U,4),XXX=$$GET1^DIQ(4,+DIC4DA,.01,"I") S:XXX="" XXX="  BLANK" K DIC4DA
"RTN","NURSUT3",93,0)
 Q XXX
"RTN","NURSUT3",94,0)
EN13(NOD1) ; GET PRODUCT LINE OF PRIMARY NURS LOCATIO WITH IEN FROM THE
"RTN","NURSUT3",95,0)
 ; POSITION CONTROL FILE THE VALUE OF THE FUNCTION WILL BE " BLANK
"RTN","NURSUT3",96,0)
 ; IF THERE IS NO PRODUCT LINE ASSOCIATED WITH THIS NURS LOCATION OR THE
"RTN","NURSUT3",97,0)
 ; FREE TEXT VALUE OF THE PRODUCT LINE
"RTN","NURSUT3",98,0)
 N NURUNIT,SC44DA,NUR2127 S SC44DA=+$G(^NURSF(211.8,NOD1,0)),NURUNIT=$O(^NURSF(211.4,"B",SC44DA,0))
"RTN","NURSUT3",99,0)
 S XXX=" BLANK",NUR2127=+$P($G(^NURSF(211.4,+NURUNIT,1)),U,4) I NUR2127 S XXX=$$GET1^DIQ(212.7,+NUR2127,.01,"I")
"RTN","NURSUT3",100,0)
 Q XXX
"RTN","NURSUT3",101,0)
GETSER() ; THIS PROCEDURE WILL RETURN THE VALUE FOR NURSING IN THE
"RTN","NURSUT3",102,0)
 ; PAID COST CENTER ORGANIZATION CODE (454.1) FILE.  THE VALUE
"RTN","NURSUT3",103,0)
 ; OF THE FUNCTION WILL BE "" IF THERE ARE NO NURSING ENTRIES, OR
"RTN","NURSUT3",104,0)
 ; A LIST OF NURSING ENTRY IEN's SEPARATED BY ^'s.
"RTN","NURSUT3",105,0)
 N FXN
"RTN","NURSUT3",106,0)
 S FXN(1)=$O(^PRSP(454.1,"B","NURSING",0))
"RTN","NURSUT3",107,0)
 S FXN(2)=$O(^PRSP(454.1,"B","NURSING SERVICE",0))
"RTN","NURSUT3",108,0)
 I FXN(1)!FXN(2) S FXN=U_$S(FXN(1):FXN(1)_U,1:"")_$S(FXN(2):FXN(2)_U,1:"")
"RTN","NURSUT3",109,0)
 E  S FXN=""
"RTN","NURSUT3",110,0)
 Q FXN
"VER")
8.0^22.0
"^DD",210,210,4,0)
PRIMARY FACILITY^CJ30X^^ ; ^S DA=+D0 D EN2^NURSUT0 Q:'NOD1  S X=$$GET1^DIQ(4,+$P($G(^SC(+$G(^NURSF(211.8,NOD1,0)),0)),U,4),.01,"I")
"^DD",210,210,4,9)
^
"^DD",210,210,4,9.01)

"^DD",210,210,4,9.1)
S DA=+D0 D EN2^NURSUT0 Q:'NOD1  S X=$$GET1^DIQ(4,+$P($G(^SC(+$G(^NURSF(211.8,NOD1,0)),0)),U,4),.01,"I")
"^DD",210,210,4,21,0)
^^2^2^2960416^^^^
"^DD",210,210,4,21,1,0)
This field indicates the Institution/Division associated with the employee's
"^DD",210,210,4,21,2,0)
primary assignment.
"^DD",210,210,4,"DT")
3030304
**END**
**END**
