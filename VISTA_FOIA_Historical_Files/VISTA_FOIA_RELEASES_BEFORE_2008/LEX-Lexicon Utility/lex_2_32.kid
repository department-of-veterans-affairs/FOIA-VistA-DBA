KIDS Distribution saved on Apr 20, 2005@14:35:51
LEX*2.0*32/ICD*18.0*15/ICPT*6.0*22
**KIDS**:LEX*2.0*32^ICD*18.0*15^ICPT*6.0*22^

**INSTALL NAME**
LEX*2.0*32
"BLD",5392,0)
LEX*2.0*32^LEXICON UTILITY^0^3050420^y
"BLD",5392,1,0)
^^2^2^3050316^^
"BLD",5392,1,1,0)
Please see the National Patch Module for details of the enhancements 
"BLD",5392,1,2,0)
included in this patch.
"BLD",5392,4,0)
^9.64PA^^
"BLD",5392,"INI")

"BLD",5392,"INID")
^y^
"BLD",5392,"INIT")
POST^LEX2032P
"BLD",5392,"KRN",0)
^9.67PA^8989.52^19
"BLD",5392,"KRN",.4,0)
.4
"BLD",5392,"KRN",.401,0)
.401
"BLD",5392,"KRN",.402,0)
.402
"BLD",5392,"KRN",.403,0)
.403
"BLD",5392,"KRN",.5,0)
.5
"BLD",5392,"KRN",.84,0)
.84
"BLD",5392,"KRN",3.6,0)
3.6
"BLD",5392,"KRN",3.8,0)
3.8
"BLD",5392,"KRN",9.2,0)
9.2
"BLD",5392,"KRN",9.8,0)
9.8
"BLD",5392,"KRN",9.8,"NM",0)
^9.68A^10^10
"BLD",5392,"KRN",9.8,"NM",1,0)
LEXXII^^0^B28358070
"BLD",5392,"KRN",9.8,"NM",2,0)
LEXXFI^^0^B37167734
"BLD",5392,"KRN",9.8,"NM",3,0)
LEXXFI2^^0^B31838706
"BLD",5392,"KRN",9.8,"NM",4,0)
LEXXFI3^^0^B36032723
"BLD",5392,"KRN",9.8,"NM",5,0)
LEXXFI4^^0^B23614617
"BLD",5392,"KRN",9.8,"NM",6,0)
LEXXFI5^^0^B9998256
"BLD",5392,"KRN",9.8,"NM",7,0)
LEXXFI6^^0^B7377365
"BLD",5392,"KRN",9.8,"NM",8,0)
LEXXFI7^^0^B41759245
"BLD",5392,"KRN",9.8,"NM",9,0)
LEXXFI8^^0^B38145534
"BLD",5392,"KRN",9.8,"NM",10,0)
LEXASO^^0^B14424663
"BLD",5392,"KRN",9.8,"NM","B","LEXASO",10)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI",2)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI2",3)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI3",4)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI4",5)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI5",6)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI6",7)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI7",8)

"BLD",5392,"KRN",9.8,"NM","B","LEXXFI8",9)

"BLD",5392,"KRN",9.8,"NM","B","LEXXII",1)

"BLD",5392,"KRN",19,0)
19
"BLD",5392,"KRN",19.1,0)
19.1
"BLD",5392,"KRN",101,0)
101
"BLD",5392,"KRN",409.61,0)
409.61
"BLD",5392,"KRN",771,0)
771
"BLD",5392,"KRN",870,0)
870
"BLD",5392,"KRN",8989.51,0)
8989.51
"BLD",5392,"KRN",8989.52,0)
8989.52
"BLD",5392,"KRN",8994,0)
8994
"BLD",5392,"KRN","B",.4,.4)

"BLD",5392,"KRN","B",.401,.401)

"BLD",5392,"KRN","B",.402,.402)

"BLD",5392,"KRN","B",.403,.403)

"BLD",5392,"KRN","B",.5,.5)

"BLD",5392,"KRN","B",.84,.84)

"BLD",5392,"KRN","B",3.6,3.6)

"BLD",5392,"KRN","B",3.8,3.8)

"BLD",5392,"KRN","B",9.2,9.2)

"BLD",5392,"KRN","B",9.8,9.8)

"BLD",5392,"KRN","B",19,19)

"BLD",5392,"KRN","B",19.1,19.1)

"BLD",5392,"KRN","B",101,101)

"BLD",5392,"KRN","B",409.61,409.61)

"BLD",5392,"KRN","B",771,771)

"BLD",5392,"KRN","B",870,870)

"BLD",5392,"KRN","B",8989.51,8989.51)

"BLD",5392,"KRN","B",8989.52,8989.52)

"BLD",5392,"KRN","B",8994,8994)

"BLD",5392,"QUES",0)
^9.62^^
"BLD",5392,"REQB",0)
^9.611^3^3
"BLD",5392,"REQB",1,0)
LEX*2.0*30^2
"BLD",5392,"REQB",2,0)
ICD*18.0*12^2
"BLD",5392,"REQB",3,0)
ICPT*6.0*19^2
"BLD",5392,"REQB","B","ICD*18.0*12",2)

"BLD",5392,"REQB","B","ICPT*6.0*19",3)

"BLD",5392,"REQB","B","LEX*2.0*30",1)

"INIT")
POST^LEX2032P
"MBREQ")
0
"PKG",167,-1)
1^1
"PKG",167,0)
LEXICON UTILITY^LEX^Medical and Biomedical Terminology System.^^^3030115
"PKG",167,20,0)
^9.402P^^
"PKG",167,22,0)
^9.49I^1^1
"PKG",167,22,1,0)
2.0^2960915
"PKG",167,22,1,"PAH",1,0)
32^3050420^1118
"PKG",167,22,1,"PAH",1,1,0)
^^2^2^3050420
"PKG",167,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements 
"PKG",167,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
11
"RTN","LEX2032P")
0^^B66991561
"RTN","LEX2032P",1,0)
LEX2032P ;ISL/KER - Post-Install               ; 02/17/2005
"RTN","LEX2032P",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEX2032P",3,0)
 Q
"RTN","LEX2032P",4,0)
 ;                     
"RTN","LEX2032P",5,0)
 ; Global Variables
"RTN","LEX2032P",6,0)
 ;   ^ICD9(
"RTN","LEX2032P",7,0)
 ;   ^LEX(757
"RTN","LEX2032P",8,0)
 ;   ^LEX(757.001
"RTN","LEX2032P",9,0)
 ;   ^LEX(757.01
"RTN","LEX2032P",10,0)
 ;   ^LEX(757.02
"RTN","LEX2032P",11,0)
 ;   ^LEX(757.1
"RTN","LEX2032P",12,0)
 ;                        
"RTN","LEX2032P",13,0)
 ; External References
"RTN","LEX2032P",14,0)
 ;   ^DIK
"RTN","LEX2032P",15,0)
 ;   IX1^DIK
"RTN","LEX2032P",16,0)
 ;   ^DIM
"RTN","LEX2032P",17,0)
 ;   POST^LEXXFI
"RTN","LEX2032P",18,0)
 ;   BMES^XPDUTL
"RTN","LEX2032P",19,0)
 ;   MES^XPDUTL
"RTN","LEX2032P",20,0)
 ;                                
"RTN","LEX2032P",21,0)
POST ; Main Entry Point - Post Install
"RTN","LEX2032P",22,0)
 N LEXREQP,LEXBUILD,LEXTLT,LEXCOMB,LEXCRE,LEXIGHF
"RTN","LEX2032P",23,0)
 D IMP,BM((" "_LEXTLT)),MSG H 3 S U="^"
"RTN","LEX2032P",24,0)
 D FIX,POST^LEXXFI
"RTN","LEX2032P",25,0)
 Q
"RTN","LEX2032P",26,0)
 ;            
"RTN","LEX2032P",27,0)
IMP ;   Import names
"RTN","LEX2032P",28,0)
 ;            
"RTN","LEX2032P",29,0)
 ;     This is a series of variables used by either
"RTN","LEX2032P",30,0)
 ;     Environment Check, Pre-Install, Post-Install or
"RTN","LEX2032P",31,0)
 ;     Installation Message.
"RTN","LEX2032P",32,0)
 ;
"RTN","LEX2032P",33,0)
 ;     LEXREQP  - Required Patches (string ';' delimited)
"RTN","LEX2032P",34,0)
 S LEXREQP="LEX*2.0*30;ICD*18.0*12;ICPT*6.0*19"
"RTN","LEX2032P",35,0)
 ;     LEXBUILD - Name of the current Build
"RTN","LEX2032P",36,0)
 S LEXBUILD="LEX*2.0*32"
"RTN","LEX2032P",37,0)
 ;     LEXTLT   - Title
"RTN","LEX2032P",38,0)
 S LEXTLT="Code Set Update 2nd Quarter FYO5"
"RTN","LEX2032P",39,0)
 ;     LEXCOMB  - Combined Build (string ';' delimited)
"RTN","LEX2032P",40,0)
 S LEXCOMB="LEX*2.0*32;ICD*18.0*15;ICPT*6.0*22"
"RTN","LEX2032P",41,0)
 ;     LEXCRE   - Date build was created (FM format)
"RTN","LEX2032P",42,0)
 S LEXCRE=3050217
"RTN","LEX2032P",43,0)
 ;     LEXIGHF  - Name of the export global host file
"RTN","LEX2032P",44,0)
 S LEXIGHF=""
"RTN","LEX2032P",45,0)
 Q
"RTN","LEX2032P",46,0)
 ;                      
"RTN","LEX2032P",47,0)
MSG ; Message
"RTN","LEX2032P",48,0)
 N TXT S TXT="   This patch fixes various software defects reported in NOIS reports" D BM(TXT)
"RTN","LEX2032P",49,0)
 S TXT="   that involve Code Sets in either the Lexicon, the ICD classification" D M(TXT)
"RTN","LEX2032P",50,0)
 S TXT="   system (DRG package) or the CPT-4/HCPCS classification systems." D M(TXT)
"RTN","LEX2032P",51,0)
 Q
"RTN","LEX2032P",52,0)
 ;            
"RTN","LEX2032P",53,0)
FIX ; Fix NOIS Reported Problems
"RTN","LEX2032P",54,0)
 D F1,F2,F3,F4,F5,F6,F7,F8
"RTN","LEX2032P",55,0)
 D M("   ")
"RTN","LEX2032P",56,0)
 Q
"RTN","LEX2032P",57,0)
 ;                            
"RTN","LEX2032P",58,0)
F1 ; ISL-0904-50297
"RTN","LEX2032P",59,0)
 ;                           
"RTN","LEX2032P",60,0)
 ;   There was a conflict between the Preferred
"RTN","LEX2032P",61,0)
 ;   Term and the Primary Code.  This was resolved
"RTN","LEX2032P",62,0)
 ;   by making the code entry for the Preferred 
"RTN","LEX2032P",63,0)
 ;   Term the Primary Code.
"RTN","LEX2032P",64,0)
 ;
"RTN","LEX2032P",65,0)
 D BM("   ISL-0904-50297 - Preferred Term for 300.09")
"RTN","LEX2032P",66,0)
 S DA=9702,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="9200^300.00^1^1869^1^^1"
"RTN","LEX2032P",67,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2781001^1",^LEX(757.02,DA,4,"B",2781001,1)="" D IX1^DIK
"RTN","LEX2032P",68,0)
 S DA=306438,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="9195^300.09^1^1869^0^^0"
"RTN","LEX2032P",69,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2781001^1",^LEX(757.02,DA,4,"B",2781001,1)="" D IX1^DIK
"RTN","LEX2032P",70,0)
 Q
"RTN","LEX2032P",71,0)
 ;                           
"RTN","LEX2032P",72,0)
F2 ; LEB-0704-21999
"RTN","LEX2032P",73,0)
 ;                           
"RTN","LEX2032P",74,0)
 ;   Lexicon term "Fibromyalgia" was incorrectly
"RTN","LEX2032P",75,0)
 ;   coded as ICD 729.0 and is re-coded to 729.1
"RTN","LEX2032P",76,0)
 ;
"RTN","LEX2032P",77,0)
 D M("   LEB-0704-21999 - Fibromyalgia re-code to 729.1")
"RTN","LEX2032P",78,0)
 S DA=48897,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="46261^729.1^1^9577^0^^1"
"RTN","LEX2032P",79,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2781001^1",^LEX(757.02,DA,4,"B",2781001,1)="" D IX1^DIK
"RTN","LEX2032P",80,0)
 S DA=48891,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="46262^729.0^1^9577^0^^0"
"RTN","LEX2032P",81,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2781001^1",^LEX(757.02,DA,4,"B",2781001,1)="" D IX1^DIK
"RTN","LEX2032P",82,0)
 Q
"RTN","LEX2032P",83,0)
 ;                           
"RTN","LEX2032P",84,0)
F3 ; DUR-1104-30753
"RTN","LEX2032P",85,0)
 ;                           
"RTN","LEX2032P",86,0)
 ;   The PRIMARY FLAG for codes 294.8 and 298.9 
"RTN","LEX2032P",87,0)
 ;   were reversed, returning the wrong code.
"RTN","LEX2032P",88,0)
 ;
"RTN","LEX2032P",89,0)
 D M("   DUR-1104-30753 - Primary Flag wrong for 294.8/298.9")
"RTN","LEX2032P",90,0)
 S DA=316014,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="31655^294.8^1^6652^0^^1"
"RTN","LEX2032P",91,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2781001^1",^LEX(757.02,DA,4,"B",2781001,1)="" D IX1^DIK
"RTN","LEX2032P",92,0)
 S DA=33605,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="31655^298.9^1^6652^0^^0"
"RTN","LEX2032P",93,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2781001^1",^LEX(757.02,DA,4,"B",2781001,1)="" D IX1^DIK
"RTN","LEX2032P",94,0)
 Q
"RTN","LEX2032P",95,0)
 ;                        
"RTN","LEX2032P",96,0)
F4 ; SBY-0704-30593
"RTN","LEX2032P",97,0)
 ;                           
"RTN","LEX2032P",98,0)
 ;   DSM-IV term "Neuroleptic-Induced Tardive
"RTN","LEX2032P",99,0)
 ;   Dyskinesia" with DSM code 333.82 was not
"RTN","LEX2032P",100,0)
 ;   linked to an ICD code.  DSM-IV codes are
"RTN","LEX2032P",101,0)
 ;   consistent with ICD-9-CM.  This term has
"RTN","LEX2032P",102,0)
 ;   now been linked with ICD-9 code 333.82.
"RTN","LEX2032P",103,0)
 ;
"RTN","LEX2032P",104,0)
 D M("   SBY-0704-30593 - DSM-IV/ICD-9 333.82 Linked")
"RTN","LEX2032P",105,0)
 S DA=316313,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="303696^333.82^6^163668^1^^0"
"RTN","LEX2032P",106,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2960923^1",^LEX(757.02,DA,4,"B",2960923,1)="" D IX1^DIK
"RTN","LEX2032P",107,0)
 S DA=316332,DIK="^LEX(757.02," D:$D(^LEX(757.02,DA)) ^DIK S ^LEX(757.02,DA,0)="303696^333.82^1^163668^0^^1"
"RTN","LEX2032P",108,0)
 S ^LEX(757.02,DA,4,0)="^757.28D^1^1",^LEX(757.02,DA,4,1,0)="2781001^1",^LEX(757.02,DA,4,"B",2781001,1)="" D IX1^DIK
"RTN","LEX2032P",109,0)
 Q
"RTN","LEX2032P",110,0)
 ;                           
"RTN","LEX2032P",111,0)
F5 ; PUG-0504-51717
"RTN","LEX2032P",112,0)
 ;                           
"RTN","LEX2032P",113,0)
 ;   Correct the spelling of "Unspecified" for
"RTN","LEX2032P",114,0)
 ;   ICD Code 428.0.
"RTN","LEX2032P",115,0)
 ;
"RTN","LEX2032P",116,0)
 D M("   PUG-0504-51717 - Correct spelling of 'Unspecified'")
"RTN","LEX2032P",117,0)
 S DA=9061,DIK="^ICD9(" D:$D(^ICD9(DA)) ^DIK
"RTN","LEX2032P",118,0)
 S ^ICD9(DA,0)="428.0^HJAVXC^CONGEST HEART FAIL UNSPECIFIED^^5^^1^^^^^^^^^2781001"
"RTN","LEX2032P",119,0)
 S ^ICD9(DA,1)="CONGESTIVE HEART FAILURE, UNSPECIFIED",^ICD9(DA,2,0)="^80.03P^22^22"
"RTN","LEX2032P",120,0)
 S ^ICD9(DA,2,1,0)="2474",^ICD9(DA,2,2,0)="2478",^ICD9(DA,2,3,0)="2479"
"RTN","LEX2032P",121,0)
 S ^ICD9(DA,2,4,0)="2480",^ICD9(DA,2,5,0)="DA",^ICD9(DA,2,6,0)="2567"
"RTN","LEX2032P",122,0)
 S ^ICD9(DA,2,7,0)="13636",^ICD9(DA,2,8,0)="13637",^ICD9(DA,2,9,0)="13638"
"RTN","LEX2032P",123,0)
 S ^ICD9(DA,2,10,0)="13639",^ICD9(DA,2,11,0)="13640",^ICD9(DA,2,12,0)="13641"
"RTN","LEX2032P",124,0)
 S ^ICD9(DA,2,13,0)="13642",^ICD9(DA,2,14,0)="13643",^ICD9(DA,2,15,0)="13644"
"RTN","LEX2032P",125,0)
 S ^ICD9(DA,2,16,0)="13645",^ICD9(DA,2,17,0)="13646",^ICD9(DA,2,18,0)="13647"
"RTN","LEX2032P",126,0)
 S ^ICD9(DA,2,19,0)="2568",^ICD9(DA,2,20,0)="2685",^ICD9(DA,2,21,0)="2686"
"RTN","LEX2032P",127,0)
 S ^ICD9(DA,2,22,0)="2799",^ICD9(DA,66,0)="^80.066DA^1^1"
"RTN","LEX2032P",128,0)
 S ^ICD9(DA,66,1,0)="2781001^1",^ICD9(DA,66,1,"DRG")="115^121^124^127^^"
"RTN","LEX2032P",129,0)
 S ^ICD9(DA,66,"B",2781001,1)="",^ICD9(DA,67,0)="^80.067D^1^1"
"RTN","LEX2032P",130,0)
 S ^ICD9(DA,67,1,0)="2781001^CONGEST HEART FAIL UNSPECIFIED"
"RTN","LEX2032P",131,0)
 S ^ICD9(DA,67,"B",2781001,1)="",^ICD9(DA,68,0)="^80.068D^1^1"
"RTN","LEX2032P",132,0)
 S ^ICD9(DA,68,1,0)="2781001"
"RTN","LEX2032P",133,0)
 S ^ICD9(DA,68,1,1)="CONGESTIVE HEART FAILURE, UNSPECIFIED"
"RTN","LEX2032P",134,0)
 S ^ICD9(DA,68,"B",2781001,1)="",^ICD9(DA,"DRG")="115^121^124^127"
"RTN","LEX2032P",135,0)
 D IX1^DIK
"RTN","LEX2032P",136,0)
 Q
"RTN","LEX2032P",137,0)
 ;                         
"RTN","LEX2032P",138,0)
F6 ; BOI-0804-50696
"RTN","LEX2032P",139,0)
 ;                        
"RTN","LEX2032P",140,0)
 ;   The ICD code V66.2 has been change and is
"RTN","LEX2032P",141,0)
 ;   no longer unacceptable as a principal 
"RTN","LEX2032P",142,0)
 ;   diagnosis.
"RTN","LEX2032P",143,0)
 ;
"RTN","LEX2032P",144,0)
 D M("   BOI-0804-50696 - V66.2 acceptable as principal DX")
"RTN","LEX2032P",145,0)
 S DA=11696,DIK="^ICD9(" D:$D(^ICD9(DA)) ^DIK
"RTN","LEX2032P",146,0)
 S ^ICD9(DA,0)="V66.2^^CHEMOTHERAPY CONVALESCEN^^23^^^^^^^^^^^2781001"
"RTN","LEX2032P",147,0)
 S ^ICD9(DA,1)="CONVALESCENCE FOLLOWING CHEMOTHERAPY"
"RTN","LEX2032P",148,0)
 S ^ICD9(DA,66,0)="^80.066DA^1^1",^ICD9(DA,66,1,0)="2781001^1"
"RTN","LEX2032P",149,0)
 S ^ICD9(DA,66,1,"DRG")="467^^^^^",^ICD9(DA,66,"B",2781001,1)=""
"RTN","LEX2032P",150,0)
 S ^ICD9(DA,67,0)="^80.067D^1^1",^ICD9(DA,67,1,0)="2781001^CHEMOTHERAPY CONVALESCEN"
"RTN","LEX2032P",151,0)
 S ^ICD9(DA,67,"B",2781001,1)="",^ICD9(DA,68,0)="^80.068D^1^1",^ICD9(DA,68,1,0)="2781001"
"RTN","LEX2032P",152,0)
 S ^ICD9(DA,68,1,1)="CONVALESCENCE FOLLOWING CHEMOTHERAPY"
"RTN","LEX2032P",153,0)
 S ^ICD9(DA,68,"B",2781001,1)="",^ICD9(DA,"DRG")="467" D IX1^DIK
"RTN","LEX2032P",154,0)
 Q
"RTN","LEX2032P",155,0)
 ;                      
"RTN","LEX2032P",156,0)
F7 ; WPB-1204-30035
"RTN","LEX2032P",157,0)
 ;                 
"RTN","LEX2032P",158,0)
 ;   ICD Code 041.10 Diagnosis does not match
"RTN","LEX2032P",159,0)
 ;   description
"RTN","LEX2032P",160,0)
 ;                     
"RTN","LEX2032P",161,0)
 D M("   WPB-1204-30035 - ICD code 041.10 description")
"RTN","LEX2032P",162,0)
 N CODE,DA,DIC,DIK,EX,IEN,MC,SM,SO
"RTN","LEX2032P",163,0)
 S MC=153265,EX=293212,SM=221331,SO=304491
"RTN","LEX2032P",164,0)
 S ^LEX(757,MC,0)=(EX_"^"),^LEX(757.001,MC,0)=(MC_"^4^4")
"RTN","LEX2032P",165,0)
 S ^LEX(757.01,EX,0)="Bacterial Infection due to unspecified Staphylococcus"
"RTN","LEX2032P",166,0)
 S ^LEX(757.01,EX,1)=(MC_"^1^D^10"),^LEX(757.1,SM,0)=(MC_"^6^47")
"RTN","LEX2032P",167,0)
 S DA=MC,DIK="^LEX(757," D IX1^DIK S DA=MC,DIK="^LEX(757.001," D IX1^DIK
"RTN","LEX2032P",168,0)
 S DA=EX,DIK="^LEX(757.01," D IX1^DIK S DA=SO,DIK="^LEX(757.02," D ^DIK
"RTN","LEX2032P",169,0)
 S ^LEX(757.02,SO,0)=(EX_"^041.10^1^"_MC_"^1^^0"),^LEX(757.02,SO,4,0)="^757.28D^1^1"
"RTN","LEX2032P",170,0)
 S ^LEX(757.02,SO,4,1,0)="2781001^1",^LEX(757.02,SO,4,"B",2781001,1)=""
"RTN","LEX2032P",171,0)
 S DA=SO,DIK="^LEX(757.02," D IX1^DIK S DA=SM,DIK="^LEX(757.1," D IX1^DIK
"RTN","LEX2032P",172,0)
 S (IEN,DA)=12689,DIK="^ICD9(",DA=IEN D ^DIK
"RTN","LEX2032P",173,0)
 S ^ICD9(12689,0)="041.10^^STAPHYLOCOCCUS,UNSPECIFIED^^18^^^^^^^^^^^2781001"
"RTN","LEX2032P",174,0)
 S ^ICD9(12689,1)="BACTERIAL INFECTION DUE TO UNSPECIFIED STAPHYLOCOCCUS"
"RTN","LEX2032P",175,0)
 S ^ICD9(12689,66,0)="^80.066DA^1^1",^ICD9(12689,66,1,0)="2781001^1"
"RTN","LEX2032P",176,0)
 S ^ICD9(12689,66,1,"DRG")="423^^^^^",^ICD9(12689,66,"B",2781001,1)=""
"RTN","LEX2032P",177,0)
 S ^ICD9(12689,67,0)="^80.067D^1^1",^ICD9(12689,67,1,0)="2781001^STAPHYLOCOCCUS,UNSPECIFIED"
"RTN","LEX2032P",178,0)
 S ^ICD9(12689,67,"B",2781001,1)="",^ICD9(12689,68,0)="^80.068D^1^1"
"RTN","LEX2032P",179,0)
 S ^ICD9(12689,68,1,0)="2781001",^ICD9(12689,68,1,1)="BACTERIAL INFECTION DUE TO UNSPECIFIED STAPHYLOCOCCUS"
"RTN","LEX2032P",180,0)
 S ^ICD9(12689,68,"B",2781001,1)="",^ICD9(12689,"DRG")="423"
"RTN","LEX2032P",181,0)
 S (IEN,DA)=12689,DIK="^ICD9(",DA=IEN D IX1^DIK
"RTN","LEX2032P",182,0)
 Q
"RTN","LEX2032P",183,0)
 ;
"RTN","LEX2032P",184,0)
F8 ; ISL-1104-50684
"RTN","LEX2032P",185,0)
 ;            
"RTN","LEX2032P",186,0)
 ;   An extraneous node in file 80.2 (DRG file)
"RTN","LEX2032P",187,0)
 ;   has been discovered.  This node is located at 
"RTN","LEX2032P",188,0)
 ;   ^ICD(D0,2) and will be deleted.
"RTN","LEX2032P",189,0)
 ;
"RTN","LEX2032P",190,0)
 D M("   ISL-1104-50684 - Remove extraneous node ^ICD(DO,2)")
"RTN","LEX2032P",191,0)
 N DA,DIK,LEXA,%X,%Y,LEXA,LEXN,LEXC,LEXS,LEXD,LEXCM,LEXCT,LEXT,X K LEXA
"RTN","LEX2032P",192,0)
 S DA=0,U="^" F  S DA=$O(^ICD(DA)) Q:+DA'>0  D
"RTN","LEX2032P",193,0)
 . Q:'$L($G(^ICD(DA,2)))  S LEXN="^ICD("_DA_")",LEXC="^ICD("_DA_",",LEXCT=0,LEXT=""
"RTN","LEX2032P",194,0)
 . K LEXA F  S LEXN=$Q(@LEXN) Q:LEXN=""!(LEXN'[LEXC)  D
"RTN","LEX2032P",195,0)
 . . Q:LEXN'[(LEXC_"2")  S LEXCM=$S(LEXN[(LEXC_"2)"):"K",LEXN'[(LEXC_"2)")&(LEXN[(LEXC_"2")):"S",1:"")
"RTN","LEX2032P",196,0)
 . . Q:LEXCM=""  S LEXT=LEXCM_" "_LEXN_"="""_@LEXN_""""
"RTN","LEX2032P",197,0)
 . . S:LEXCM="K" LEXT=LEXCM_" "_LEXN S X=LEXT D ^DIM S:'$D(X) LEXT=""
"RTN","LEX2032P",198,0)
 . . Q:'$L(LEXT)  S LEXCT=LEXCT+1,LEXA(LEXCT)=LEXT
"RTN","LEX2032P",199,0)
 . S LEXCT=0 F  S LEXCT=$O(LEXA(LEXCT)) Q:+LEXCT'>0  D
"RTN","LEX2032P",200,0)
 . . S (X,LEXCM)=$G(LEXA(LEXCT)) D ^DIM Q:'$D(X)  X LEXCM
"RTN","LEX2032P",201,0)
 Q
"RTN","LEX2032P",202,0)
 ;                      
"RTN","LEX2032P",203,0)
 ; Miscellaneous
"RTN","LEX2032P",204,0)
BM(X) ;   Blank Line with Message
"RTN","LEX2032P",205,0)
 D BMES^XPDUTL($G(X)) Q
"RTN","LEX2032P",206,0)
M(X) ;   Message
"RTN","LEX2032P",207,0)
 D MES^XPDUTL($G(X)) Q
"RTN","LEXASO")
0^10^B14424663
"RTN","LEXASO",1,0)
LEXASO ; ISL/KER Look-up Display String (Sources) ; 05/14/2003
"RTN","LEXASO",2,0)
 ;;2.0;LEXICON UTILITY;**25,32**;Sep 23, 1996
"RTN","LEXASO",3,0)
 ;
"RTN","LEXASO",4,0)
 ; Entry S X=$$SO^LEXASO(IEN,SAB,ALL,DATE)
"RTN","LEXASO",5,0)
 ;
"RTN","LEXASO",6,0)
 ;       IEN is an internal entry number in file 757.01
"RTN","LEXASO",7,0)
 ;           representing an expression
"RTN","LEXASO",8,0)
 ;
"RTN","LEXASO",9,0)
 ;       SAB is the source abbreviation of the classification
"RTN","LEXASO",10,0)
 ;           coding system, i.e., ICD, CPT, DSM, etc.
"RTN","LEXASO",11,0)
 ;
"RTN","LEXASO",12,0)
 ;       ALL is a flag 
"RTN","LEXASO",13,0)
 ;
"RTN","LEXASO",14,0)
 ;           0 - do not display all codes associated of the
"RTN","LEXASO",15,0)
 ;               major concept, display the codes only for the
"RTN","LEXASO",16,0)
 ;               expression
"RTN","LEXASO",17,0)
 ;
"RTN","LEXASO",18,0)
 ;           1 - display all codes associated for the major 
"RTN","LEXASO",19,0)
 ;               concept
"RTN","LEXASO",20,0)
 ;
"RTN","LEXASO",21,0)
 ;       DATE is used to screen out inactive codes
"RTN","LEXASO",22,0)
 ;
"RTN","LEXASO",23,0)
 ; LEXCC(   Array of classification codes
"RTN","LEXASO",24,0)
 ;
"RTN","LEXASO",25,0)
 ; LEXA     Flag - 1 All codes, 0 only the expression codes
"RTN","LEXASO",26,0)
 ; LEXM     Flag - M Major Concept
"RTN","LEXASO",27,0)
 ;
"RTN","LEXASO",28,0)
 ; LEXC     Counter, # $Piece of string LEXSA (SAB)
"RTN","LEXASO",29,0)
 ;
"RTN","LEXASO",30,0)
 ; LEXMC    IEN in file 757      Major Concept
"RTN","LEXASO",31,0)
 ; LEXME    IEN in file 757.01   Major Concept Expression
"RTN","LEXASO",32,0)
 ; LEXEX    IEN in file 757.01   Expression
"RTN","LEXASO",33,0)
 ; LEXSO    IEN in file 757.02   Sources
"RTN","LEXASO",34,0)
 ;
"RTN","LEXASO",35,0)
 ; LEXSA    Source Abbreviation i.e., ICD or ICD/CPT
"RTN","LEXASO",36,0)
 ; LEXSC    Source Classification Code
"RTN","LEXASO",37,0)
 ; LEXSR    Source Abbreviation single only i.e., ICD, CPT
"RTN","LEXASO",38,0)
 ; LEXST    String of classification sources and codes
"RTN","LEXASO",39,0)
 ;
"RTN","LEXASO",40,0)
 ; LEXX     Return value
"RTN","LEXASO",41,0)
 ;
"RTN","LEXASO",42,0)
SO(LEXX,LEXSA,LEXA,LEXVDT) ; Return string of source codes for LEXX SAB
"RTN","LEXASO",43,0)
 Q:+($G(LEXX))=0!('$L($G(LEXSA))) ""
"RTN","LEXASO",44,0)
 Q:'$L($G(^LEX(757.01,LEXX,0))) ""
"RTN","LEXASO",45,0)
 ;
"RTN","LEXASO",46,0)
 N LEXCC,LEXM,LEXC,LEXMC,LEXME,LEXEX,LEXSO,LEXSC,LEXSR,LEXST
"RTN","LEXASO",47,0)
 ;
"RTN","LEXASO",48,0)
 S LEXEX=+LEXX,LEXX="",LEXA=+($G(LEXA)),LEXMC=0
"RTN","LEXASO",49,0)
 S LEXM=$P($G(^LEX(757.01,LEXEX,1)),"^",2),LEXST=""
"RTN","LEXASO",50,0)
 ; Codes for an expression     D EXP
"RTN","LEXASO",51,0)
 I LEXM'=1!(+($G(LEXA))=0) D EXP G EXIT
"RTN","LEXASO",52,0)
 ; Codes for a major concept   D MAJ
"RTN","LEXASO",53,0)
 I LEXM=1 S LEXMC=LEXEX D MAJ
"RTN","LEXASO",54,0)
EXIT ; Clean up and quit
"RTN","LEXASO",55,0)
 Q LEXX
"RTN","LEXASO",56,0)
EXP ; Source string for an expression
"RTN","LEXASO",57,0)
 I LEXSA'["/" D CODES(LEXEX,LEXSA,$G(LEXVDT)) S LEXX=$$ASSEM Q
"RTN","LEXASO",58,0)
 I LEXSA["/" D  S LEXX=$$ASSEM
"RTN","LEXASO",59,0)
 . N LEXC F LEXC=1:1:$L(LEXSA,"/") D
"RTN","LEXASO",60,0)
 . . D CODES(LEXEX,$P(LEXSA,"/",LEXC),$G(LEXVDT))
"RTN","LEXASO",61,0)
 Q
"RTN","LEXASO",62,0)
MAJ ; Source string for a major concept
"RTN","LEXASO",63,0)
 S LEXMC=$P($G(^LEX(757.01,LEXEX,1)),"^",1),LEXEX=0
"RTN","LEXASO",64,0)
 S LEXEX=0 F  S LEXEX=$O(^LEX(757.02,"AMC",LEXMC,LEXEX)) Q:+LEXEX=0  D
"RTN","LEXASO",65,0)
 . N LEXME S LEXME=+($G(^LEX(757.02,LEXEX,0)))
"RTN","LEXASO",66,0)
 . I LEXSA'["/" D CODES(LEXME,LEXSA,$G(LEXVDT)) Q
"RTN","LEXASO",67,0)
 . I LEXSA["/" D  Q
"RTN","LEXASO",68,0)
 . . N LEXC F LEXC=1:1:$L(LEXSA,"/") D
"RTN","LEXASO",69,0)
 . . . D CODES(LEXME,$P(LEXSA,"/",LEXC),$G(LEXVDT))
"RTN","LEXASO",70,0)
 S LEXX=$$ASSEM
"RTN","LEXASO",71,0)
 Q
"RTN","LEXASO",72,0)
CODES(LEXEX,LEXSA,LEXVDT) ; Get Source Codes
"RTN","LEXASO",73,0)
 Q:$L($G(LEXSA))'=3  N LEXSO,LEXSR,LEXST,LEXSTA,LEXCD S LEXST=""
"RTN","LEXASO",74,0)
 S LEXSO=0 F  S LEXSO=$O(^LEX(757.02,"B",LEXEX,LEXSO)) Q:+LEXSO=0  D
"RTN","LEXASO",75,0)
 . S LEXCD=$P($G(^LEX(757.02,LEXSO,0)),"^",2) Q:'$L(LEXCD)
"RTN","LEXASO",76,0)
 . S LEXSTA=$$STATCHK^LEXSRC2(LEXCD,$G(LEXVDT)) Q:+LEXSTA'>0
"RTN","LEXASO",77,0)
 . I $E($G(^LEX(757.03,$P($G(^LEX(757.02,LEXSO,0)),"^",3),0)),1,3)=LEXSA D
"RTN","LEXASO",78,0)
 . . S LEXSR=$P($G(^LEX(757.03,$P($G(^LEX(757.02,LEXSO,0)),"^",3),0)),"^",2)
"RTN","LEXASO",79,0)
 . . S LEXCC(LEXSR,(($P($G(^LEX(757.02,LEXSO,0)),"^",2))_" "))=""
"RTN","LEXASO",80,0)
 . . ; Primary Code Saved - p32
"RTN","LEXASO",81,0)
 . . S:$P($G(^LEX(757.02,LEXSO,0)),"^",7)=1 LEXCC(LEXSR,"P",(($P($G(^LEX(757.02,LEXSO,0)),"^",2))_" "))=""
"RTN","LEXASO",82,0)
 Q
"RTN","LEXASO",83,0)
ASSEM(LEXX) ; Assemble display string  (SOURCE CODE/CODE/CODE)
"RTN","LEXASO",84,0)
 Q:'$D(LEXCC) ""
"RTN","LEXASO",85,0)
 Q:$O(LEXCC(""))="" ""
"RTN","LEXASO",86,0)
 N LEXSR,LEXST S LEXSR=""
"RTN","LEXASO",87,0)
 F  S LEXSR=$O(LEXCC(LEXSR)) Q:LEXSR=""  D
"RTN","LEXASO",88,0)
 . N LEXSC S LEXSC="",LEXST="("_LEXSR_" "
"RTN","LEXASO",89,0)
 . ; Primary Code listed first - p32
"RTN","LEXASO",90,0)
 . I $D(LEXCC(LEXSR,"P")) D
"RTN","LEXASO",91,0)
 . . N LEXSC S LEXSC=$O(LEXCC(LEXSR,"P",""))
"RTN","LEXASO",92,0)
 . . S:$L(LEXSC) LEXST=LEXST_$$TRIM(LEXSC)_"/"
"RTN","LEXASO",93,0)
 . . K LEXCC(LEXSR,"P") K:$L(LEXSC) LEXCC(LEXSR,LEXSC)
"RTN","LEXASO",94,0)
 . S LEXSC="" F  S LEXSC=$O(LEXCC(LEXSR,LEXSC)) Q:LEXSC=""  D
"RTN","LEXASO",95,0)
 . . S LEXST=LEXST_$$TRIM(LEXSC)_"/"
"RTN","LEXASO",96,0)
 . . K LEXCC(LEXSR,LEXSC)
"RTN","LEXASO",97,0)
 . S LEXCC(LEXSR)=$E(LEXST,1,($L(LEXST)-1))_")"
"RTN","LEXASO",98,0)
 S (LEXST,LEXSR)=""
"RTN","LEXASO",99,0)
 F  S LEXSR=$O(LEXCC(LEXSR)) Q:LEXSR=""  D
"RTN","LEXASO",100,0)
 . S LEXST=LEXST_" "_LEXCC(LEXSR)
"RTN","LEXASO",101,0)
 F  Q:$E(LEXST,1)'=" "  S LEXST=$E(LEXST,2,$L(LEXST))
"RTN","LEXASO",102,0)
 S LEXX=LEXST Q LEXX
"RTN","LEXASO",103,0)
TRIM(LEXX) ; Trim spaces
"RTN","LEXASO",104,0)
 F  Q:$E(LEXX,1)'=" "  S LEXX=$E(LEXX,2,$L(LEXX))
"RTN","LEXASO",105,0)
 F  Q:$E(LEXX,$L(LEXX))'=" "  S LEXX=$E(LEXX,1,($L(LEXX)-1))
"RTN","LEXASO",106,0)
 Q LEXX
"RTN","LEXXFI")
0^2^B37167734
"RTN","LEXXFI",1,0)
LEXXFI ; ISL/KER - File Info                     ; 07/28/2004
"RTN","LEXXFI",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI",3,0)
 Q
"RTN","LEXXFI",4,0)
 ;            
"RTN","LEXXFI",5,0)
 ; Global Variables
"RTN","LEXXFI",6,0)
 ;   ^TMP("LEXCNT",$J    SACC 2.3.2.5.1  
"RTN","LEXXFI",7,0)
 ;   ^TMP("LEXCS",$J     SACC 2.3.2.5.1
"RTN","LEXXFI",8,0)
 ;   ^TMP("LEXI",$J      SACC 2.3.2.5.1
"RTN","LEXXFI",9,0)
 ;   ^TMP("LEXINS",$J    SACC 2.3.2.5.1
"RTN","LEXXFI",10,0)
 ;   ^TMP("LEXKID",$J    SACC 2.3.2.5.1
"RTN","LEXXFI",11,0)
 ;   ^TMP("LEXMSG",$J    SACC 2.3.2.5.1
"RTN","LEXXFI",12,0)
 ;                   
"RTN","LEXXFI",13,0)
 ; External References
"RTN","LEXXFI",14,0)
 ;   DBIA 10086  HOME^%ZIS           
"RTN","LEXXFI",15,0)
 ;   DBIA 10089  ^%ZISC
"RTN","LEXXFI",16,0)
 ;   DBIA 10063  ^%ZTLOAD
"RTN","LEXXFI",17,0)
 ;   DBIA  2056  $$GET1^DIQ (file #200)
"RTN","LEXXFI",18,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","LEXXFI",19,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXFI",20,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","LEXXFI",21,0)
 ;   DBIA 10070  ^XMD
"RTN","LEXXFI",22,0)
 ;                   
"RTN","LEXXFI",23,0)
EN ; Checksum For a File(s)
"RTN","LEXXFI",24,0)
 N LEXENV,LEXMET,LEXID S LEXENV=$$ENV Q:+LEXENV'>0  S LEXMET=$$MT^LEXXFI7
"RTN","LEXXFI",25,0)
 I '$L(LEXMET) W !!," Checksum Files (One or All) not Selected" Q
"RTN","LEXXFI",26,0)
 I $L($T(@(LEXMET_"^LEXXFI")))>0 W ! D @LEXMET
"RTN","LEXXFI",27,0)
 Q
"RTN","LEXXFI",28,0)
ONE ; Checksum for ONE file
"RTN","LEXXFI",29,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J)
"RTN","LEXXFI",30,0)
 N LEXBEG,LEXELP,LEXEND,LEXFC,LEXFI,LEXLDR,LEXMOD,LEXMUL,LEXNM,LEXTCS
"RTN","LEXXFI",31,0)
 N LEXTND,LEXTT,LEXTXT
"RTN","LEXXFI",32,0)
 S LEXBEG=$$TIC^LEXXFI8,LEXMUL=0,LEXMOD=0
"RTN","LEXXFI",33,0)
 S LEXFI=$$FI^LEXXFI7 I +LEXFI'>0 W !!," Checksum File not Selected" Q
"RTN","LEXXFI",34,0)
 S LEXLDR=$$LDR^LEXXFI8(LEXFI),LEXMOD=LEXMOD+($$MOD^LEXXFI8(LEXFI))
"RTN","LEXXFI",35,0)
 S LEXNM=$$FN^LEXXFI8(LEXFI),LEXTT=" "
"RTN","LEXXFI",36,0)
 W ! D ONE^LEXXFI2(LEXFI),ONE^LEXXFI3(LEXFI),ONE^LEXXFI5(LEXFI)
"RTN","LEXXFI",37,0)
 S LEXEND=$$TIC^LEXXFI8,LEXELP=$$ELAP^LEXXFI8(LEXBEG,LEXEND)
"RTN","LEXXFI",38,0)
 S:LEXELP="" LEXELP="00:00:00"
"RTN","LEXXFI",39,0)
 I +LEXBEG>0,LEXEND>0,$L(LEXELP) D TIM
"RTN","LEXXFI",40,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J)
"RTN","LEXXFI",41,0)
 Q
"RTN","LEXXFI",42,0)
ALL ; Checksum for ALL files
"RTN","LEXXFI",43,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J)
"RTN","LEXXFI",44,0)
 K ^TMP("LEXINS",$J),^TMP("LEXKID",$J) S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXXFI",45,0)
 N LEXBEG,LEXELP,LEXEND,LEXFC,LEXMOD,LEXMUL,LEXTCS,LEXTND,LEXID
"RTN","LEXXFI",46,0)
 S LEXID="LEXKID",LEXBEG=$$TIC^LEXXFI8,LEXMUL=1,(LEXTND,LEXTCS,LEXMOD,LEXFC)=0
"RTN","LEXXFI",47,0)
 H:$D(LEXPOST) 45 D:'$D(LEXPOST) HDR D ALL^LEXXFI5,ALL^LEXXFI2,ALL^LEXXFI3
"RTN","LEXXFI",48,0)
 S LEXEND=$$TIC^LEXXFI8 S LEXELP=$$ELAP^LEXXFI8(LEXBEG,LEXEND)
"RTN","LEXXFI",49,0)
 S:LEXELP="" LEXELP="00:00:00"
"RTN","LEXXFI",50,0)
 I +LEXBEG>0,LEXEND>0,$L(LEXELP) D TIM
"RTN","LEXXFI",51,0)
 D:$D(LEXSEND)!($D(LEXPOST)) EN^LEXXII
"RTN","LEXXFI",52,0)
 D:$D(ZTQUEUED) MAIL H:$D(ZTQUEUED) 45 D KILL
"RTN","LEXXFI",53,0)
 Q
"RTN","LEXXFI",54,0)
POST ; Entry Point for Post-Install Message
"RTN","LEXXFI",55,0)
SEND ; Send Message
"RTN","LEXXFI",56,0)
 N LEXDESC,LEXENV,LEXPOST,LEXSEND,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK
"RTN","LEXXFI",57,0)
 S LEXENV=$$ENV Q:+LEXENV'>0  S LEXSEND="",LEXPOST=""
"RTN","LEXXFI",58,0)
 S ZTRTN="ALL^LEXXFI",ZTSAVE("LEXSEND")=""
"RTN","LEXXFI",59,0)
 S:$D(LEXCOUNT) ZTSAVE("LEXCOUNT")=""
"RTN","LEXXFI",60,0)
 ;
"RTN","LEXXFI",61,0)
 S ZTSAVE("LEXPOST")=""
"RTN","LEXXFI",62,0)
 S:$D(LEXLREV) ZTSAVE("LEXLREV")=""
"RTN","LEXXFI",63,0)
 S:$D(LEXREQP) ZTSAVE("LEXREQP")=""
"RTN","LEXXFI",64,0)
 S:$D(LEXBUILD) ZTSAVE("LEXBUILD")=""
"RTN","LEXXFI",65,0)
 S:$D(LEXIGHF) ZTSAVE("LEXIGHF")=""
"RTN","LEXXFI",66,0)
 S:$D(LEXCRE) ZTSAVE("LEXCRE")=""
"RTN","LEXXFI",67,0)
 S:$D(LEXID) ZTSAVE("LEXID")=""
"RTN","LEXXFI",68,0)
 S:$D(XPDA) ZTSAVE("XPDA")=""
"RTN","LEXXFI",69,0)
 ;
"RTN","LEXXFI",70,0)
 S (LEXDESC,ZTDESC)="Post-Install LEX/ICD/CPT File Counts ",ZTDTH=$H
"RTN","LEXXFI",71,0)
 S ZTIO="" D ^%ZTLOAD
"RTN","LEXXFI",72,0)
 W:+($G(ZTSK))>0 !!,"  ",LEXDESC,!,"  Queued Task #",+($G(ZTSK)),!
"RTN","LEXXFI",73,0)
 D ^%ZISC
"RTN","LEXXFI",74,0)
 Q
"RTN","LEXXFI",75,0)
HDR ; Header
"RTN","LEXXFI",76,0)
 N LEXD,LEXP,LEXN,LEXT,LEXU,LEXA,LEXI,LEXF,LEXMUL S LEXF=0
"RTN","LEXXFI",77,0)
 S LEXA=$$U^LEXXFI7,LEXU=$$P^LEXXFI7,LEXD=$$A^LEXXFI7 D TT^LEXXFI8("","Status")
"RTN","LEXXFI",78,0)
 S LEXT="" S:$L(LEXD) LEXT="   As of:       "_LEXD
"RTN","LEXXFI",79,0)
 I $L(LEXD) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",80,0)
 S LEXT="",LEXI=$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEXXFI",81,0)
 S:$L(LEXI)&($L($P(LEXA,"^",2))) LEXI=LEXI_"  "_$P(LEXA,"^",2)
"RTN","LEXXFI",82,0)
 S LEXT="" S:$L(LEXI) LEXT="   In Account:  "_LEXI
"RTN","LEXXFI",83,0)
 I $L(LEXT) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",84,0)
 S LEXN=$P(LEXU,"^",1),LEXP=$P(LEXU,"^",2)
"RTN","LEXXFI",85,0)
 S LEXT="" S:$L(LEXN) LEXT="   Maint By:    "
"RTN","LEXXFI",86,0)
 S:$L(LEXN) LEXT=LEXT_LEXN S:$L(LEXP)&($L(LEXN)) LEXT=LEXT_"   "_LEXP
"RTN","LEXXFI",87,0)
 I $L(LEXT) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",88,0)
 S LEXT="" S:$L($G(LEXBUILD)) LEXT="   Build:       "_$G(LEXBUILD)
"RTN","LEXXFI",89,0)
 D:$L(LEXT) TL^LEXXFI8(LEXT) D BL^LEXXFI8
"RTN","LEXXFI",90,0)
 Q
"RTN","LEXXFI",91,0)
TIM ; Time
"RTN","LEXXFI",92,0)
 Q:$D(LEXPOST)  Q:+($G(LEXBEG))'>0  Q:+($G(LEXEND))'>0  Q:'$L($G(LEXELP))
"RTN","LEXXFI",93,0)
 D BL^LEXXFI8,TL^LEXXFI8(("   Started:   "_$TR($$FMTE^XLFDT(LEXBEG),"@"," ")))
"RTN","LEXXFI",94,0)
 D TL^LEXXFI8(("   Finished:  "_$TR($$FMTE^XLFDT(LEXEND),"@"," ")))
"RTN","LEXXFI",95,0)
 D TL^LEXXFI8(("   Elapsed:   "_LEXELP)),BL^LEXXFI8
"RTN","LEXXFI",96,0)
 Q
"RTN","LEXXFI",97,0)
MAIL ; Mail global array in message
"RTN","LEXXFI",98,0)
 N DIFROM,LEXPRI,LEXADR,LEXI,LEXM,LEXSUB,XCNP,XMDUZ,XMSCR,XMSUB,XMTEXT,XMY,XMZ
"RTN","LEXXFI",99,0)
 G:+($G(^TMP("LEXCS",$J,0)))'>0 MAILQ K ^TMP("LEXMSG",$J)
"RTN","LEXXFI",100,0)
 S LEXSUB="Lexicon/ICD/CPT Installation"
"RTN","LEXXFI",101,0)
 S:$L($G(LEXBUILD)) LEXSUB=$G(LEXBUILD)_" Installation"
"RTN","LEXXFI",102,0)
 S LEXPRI=$$ADR^LEXXFI8 G:'$L(LEXPRI) MAILQ S LEXPRI="G.LEXINS@"_LEXPRI
"RTN","LEXXFI",103,0)
 S LEXADR=$$GET1^DIQ(200,+($G(DUZ)),.01) G:'$L(LEXADR) MAILQ
"RTN","LEXXFI",104,0)
 S U="^",XMSUB="LEX/ICD/CPT File Checksums - "_$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","LEXXFI",105,0)
 S:$D(LEXCOUNT) XMSUB="LEX/ICD/CPT File Checksums/Counts - "_$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","LEXXFI",106,0)
 S:$L($G(LEXBUILD)) XMSUB=$G(LEXBUILD)_" File Checksums"
"RTN","LEXXFI",107,0)
 S:$L($G(LEXBUILD))&($D(LEXCOUNT)) XMSUB=$G(LEXBUILD)_" File Checksums/Counts"
"RTN","LEXXFI",108,0)
 S:$D(LEXPOST) XMSUB=LEXSUB
"RTN","LEXXFI",109,0)
 S LEXI=0 F  S LEXI=$O(^TMP("LEXKID",$J,LEXI)) Q:+LEXI=0  D
"RTN","LEXXFI",110,0)
 . S LEXM=+($O(^TMP("LEXMSG",$J," "),-1))+1
"RTN","LEXXFI",111,0)
 . S ^TMP("LEXMSG",$J,LEXM,0)=$E($G(^TMP("LEXKID",$J,LEXI)),1,79)
"RTN","LEXXFI",112,0)
 . S ^TMP("LEXMSG",$J,0)=LEXM
"RTN","LEXXFI",113,0)
 S LEXI=0 F  S LEXI=$O(^TMP("LEXCS",$J,LEXI)) Q:+LEXI=0  D
"RTN","LEXXFI",114,0)
 . S LEXM=+($O(^TMP("LEXMSG",$J," "),-1))+1
"RTN","LEXXFI",115,0)
 . S ^TMP("LEXMSG",$J,LEXM,0)=$E($G(^TMP("LEXCS",$J,LEXI)),1,79)
"RTN","LEXXFI",116,0)
 . S ^TMP("LEXMSG",$J,0)=LEXM
"RTN","LEXXFI",117,0)
 G:'$D(^TMP("LEXMSG",$J)) MAILQ G:+($G(^TMP("LEXMSG",$J,0)))'>0 MAILQ
"RTN","LEXXFI",118,0)
 S XMY(LEXPRI)="",XMY(LEXADR)="",XMTEXT="^TMP(""LEXMSG"",$J,",XMDUZ=.5 D ^XMD
"RTN","LEXXFI",119,0)
MAILQ ; Quit Mail
"RTN","LEXXFI",120,0)
 D KILL K %Z,XCNP,XMSCR,XMDUZ,XMY,XMZ,XMSUB,XMY,XMTEXT,XMDUZ
"RTN","LEXXFI",121,0)
 Q
"RTN","LEXXFI",122,0)
ENV(X) ; Environment check
"RTN","LEXXFI",123,0)
 N LEXNM D HOME^%ZIS S U="^",DT=$$DT^XLFDT
"RTN","LEXXFI",124,0)
 I +($G(DUZ))'>0 W !!,"    User (DUZ) not defined",! Q 0
"RTN","LEXXFI",125,0)
 S LEXNM=$$GET1^DIQ(200,+($G(DUZ)),.01) I '$L(LEXNM) W !!,"    Invalid User (DUZ) defined",! Q 0
"RTN","LEXXFI",126,0)
 S DTIME=$$DTIME^XUP(+($G(DUZ)))
"RTN","LEXXFI",127,0)
 Q 1
"RTN","LEXXFI",128,0)
CLR ; Clear ^TMP("LEXCS",$J)
"RTN","LEXXFI",129,0)
 K ^TMP("LEXCS",$J) Q
"RTN","LEXXFI",130,0)
KILL ; Kill all ^TMP("LEX**"
"RTN","LEXXFI",131,0)
 K ^TMP("LEXCNT",$J),^TMP("LEXCS",$J),^TMP("LEXI",$J)
"RTN","LEXXFI",132,0)
 K ^TMP("LEXINS",$J),^TMP("LEXMSG",$J),^TMP("LEXKID",$J)
"RTN","LEXXFI",133,0)
 Q
"RTN","LEXXFI",134,0)
 ;;
"RTN","LEXXFI",135,0)
 ;;
"RTN","LEXXFI",136,0)
FILES ;;
"RTN","LEXXFI",137,0)
 ;;;;757
"RTN","LEXXFI",138,0)
 ;;1;;757.001
"RTN","LEXXFI",139,0)
 ;;1;;757.01
"RTN","LEXXFI",140,0)
 ;;;;757.011
"RTN","LEXXFI",141,0)
 ;;;;757.014
"RTN","LEXXFI",142,0)
 ;;;;757.02
"RTN","LEXXFI",143,0)
 ;;;;757.03
"RTN","LEXXFI",144,0)
 ;;1;;757.04
"RTN","LEXXFI",145,0)
 ;;1;;757.05
"RTN","LEXXFI",146,0)
 ;;1;;757.06
"RTN","LEXXFI",147,0)
 ;;;;757.1
"RTN","LEXXFI",148,0)
 ;;;;757.11
"RTN","LEXXFI",149,0)
 ;;;;757.12
"RTN","LEXXFI",150,0)
 ;;;;757.13
"RTN","LEXXFI",151,0)
 ;;;;757.14
"RTN","LEXXFI",152,0)
 ;;1;;757.2
"RTN","LEXXFI",153,0)
 ;;1;;757.21
"RTN","LEXXFI",154,0)
 ;;;;757.3
"RTN","LEXXFI",155,0)
 ;;;;757.31
"RTN","LEXXFI",156,0)
 ;;1;;757.4
"RTN","LEXXFI",157,0)
 ;;1;;757.41
"RTN","LEXXFI",158,0)
 ;;1;;757.9
"RTN","LEXXFI",159,0)
 ;;;;757.901
"RTN","LEXXFI",160,0)
 ;;;;757.902
"RTN","LEXXFI",161,0)
 ;;1;;757.903
"RTN","LEXXFI",162,0)
 ;;1;;757.91
"RTN","LEXXFI",163,0)
 ;;;;80
"RTN","LEXXFI",164,0)
 ;;;;80.1
"RTN","LEXXFI",165,0)
 ;;1;;80.2
"RTN","LEXXFI",166,0)
 ;;;;80.3
"RTN","LEXXFI",167,0)
 ;;;;81
"RTN","LEXXFI",168,0)
 ;;;;81.1
"RTN","LEXXFI",169,0)
 ;;1;;81.2
"RTN","LEXXFI",170,0)
 ;;;;81.3
"RTN","LEXXFI",171,0)
 ;;
"RTN","LEXXFI",172,0)
 ;;
"RTN","LEXXFI",173,0)
 ;;
"RTN","LEXXFI",174,0)
 Q
"RTN","LEXXFI2")
0^3^B31838706
"RTN","LEXXFI2",1,0)
LEXXFI2 ; ISL/KER - File Info - Checksums            ; 07/28/2004
"RTN","LEXXFI2",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI2",3,0)
 Q
"RTN","LEXXFI2",4,0)
 ;            
"RTN","LEXXFI2",5,0)
 ; Global Variables
"RTN","LEXXFI2",6,0)
 ;   None
"RTN","LEXXFI2",7,0)
 ;                   
"RTN","LEXXFI2",8,0)
 ; External References
"RTN","LEXXFI2",9,0)
 ;   None
"RTN","LEXXFI2",10,0)
 ;            
"RTN","LEXXFI2",11,0)
 Q
"RTN","LEXXFI2",12,0)
ONE(X) ; Checksum for ONE file
"RTN","LEXXFI2",13,0)
 N LEXENV S LEXENV=$$ENV^LEXXFI Q:+LEXENV'>0
"RTN","LEXXFI2",14,0)
 N LEXFI,LEXFC,LEXMOD,LEXMUL,LEXNM,LEXTXT,LEXTT,LEXLDR,LEXTND
"RTN","LEXXFI2",15,0)
 N LEXTSND,LEXTCS,LEXTSCS,LEXEX,LEXLINE,LEXCTLC
"RTN","LEXXFI2",16,0)
 S (LEXTND,LEXTSND,LEXTCS,LEXTSCS,LEXMOD,LEXMUL)=0,LEXFI=$G(X) Q:+LEXFI'>0
"RTN","LEXXFI2",17,0)
 S LEXLDR=$$LDR^LEXXFI8(LEXFI),LEXMOD=LEXMOD+($$MOD^LEXXFI8(LEXFI))
"RTN","LEXXFI2",18,0)
 S LEXNM=$$FN^LEXXFI8(LEXFI),LEXTT=" "
"RTN","LEXXFI2",19,0)
 D TT^LEXXFI8(LEXFI,"Checksum"),BL^LEXXFI8
"RTN","LEXXFI2",20,0)
 D CS,CTLD,MF^LEXXFI8(LEXMOD),CTLD
"RTN","LEXXFI2",21,0)
 Q
"RTN","LEXXFI2",22,0)
ALL ; Checksum for ALL files
"RTN","LEXXFI2",23,0)
 N LEXENV S LEXENV=$$ENV^LEXXFI Q:+LEXENV'>0
"RTN","LEXXFI2",24,0)
 N LEXA,LEXCTR,LEXD,LEXEX,LEXF,LEXFC,LEXFI,LEXI,LEXLDR,LEXMOD,LEXMUL
"RTN","LEXXFI2",25,0)
 N LEXN,LEXND,LEXP,LEXRTN,LEXT,LEXTAG,LEXTND,LEXTSND,LEXTCS,LEXTSCS,LEXU
"RTN","LEXXFI2",26,0)
 S LEXMUL=1,(LEXTND,LEXTSND,LEXTCS,LEXTSCS,LEXMOD,LEXFC)=0
"RTN","LEXXFI2",27,0)
 D TT^LEXXFI8("","Checksums"),BL^LEXXFI8
"RTN","LEXXFI2",28,0)
 S LEXFI="",LEXTAG="FILES",LEXRTN="LEXXFI",LEXCTR=0
"RTN","LEXXFI2",29,0)
 F  D  Q:LEXFI=""
"RTN","LEXXFI2",30,0)
 . S LEXCTR=LEXCTR+1,LEXEX="S LEXLINE=$T("_LEXTAG_"+"_LEXCTR_"^"_LEXRTN_")"
"RTN","LEXXFI2",31,0)
 . X LEXEX S LEXFI=$P(LEXLINE,";;",2,3) Q:'$L(LEXFI)
"RTN","LEXXFI2",32,0)
 . S LEXLDR=$P(LEXFI,";;",1),LEXFI=$P(LEXFI,";;",2) Q:'$L(LEXFI)
"RTN","LEXXFI2",33,0)
 . S LEXLDR=$S(+LEXLDR>0:" * ",1:"   ")
"RTN","LEXXFI2",34,0)
 . S:LEXLDR["*" LEXMOD=+($G(LEXMOD))+1 D CS
"RTN","LEXXFI2",35,0)
 I +LEXTND>0 D
"RTN","LEXXFI2",36,0)
 . I +($G(LEXTCS))>0,+($G(LEXTSCS))>0,+($G(LEXTND))>0,+($G(LEXTSND))>0 D
"RTN","LEXXFI2",37,0)
 . . Q:+LEXTSND>LEXTND  Q:+LEXTSCS>LEXTCS
"RTN","LEXXFI2",38,0)
 . . D BL^LEXXFI8,TL^LEXXFI8("   Totals"),TL^LEXXFI8("   ------")
"RTN","LEXXFI2",39,0)
 . . D TL^LEXXFI8($$FMT("   ","Static Files",LEXTSND,LEXTSCS))
"RTN","LEXXFI2",40,0)
 . . D TL^LEXXFI8($$FMT(" * ","Variable Files",(LEXTND-LEXTSND),(LEXTCS-LEXTSCS)))
"RTN","LEXXFI2",41,0)
 . . D TL^LEXXFI8($$FMT("   ","All Files",LEXTND,LEXTCS))
"RTN","LEXXFI2",42,0)
 D MF^LEXXFI8(LEXMOD),CTLD
"RTN","LEXXFI2",43,0)
 Q
"RTN","LEXXFI2",44,0)
CS ; Checksum for File X
"RTN","LEXXFI2",45,0)
 N LEXCS,LEXND,LEX S LEXFI=+($G(LEXFI)) Q:+LEXFI'>0
"RTN","LEXXFI2",46,0)
 D DDI^LEXXFI6(+LEXFI,.LEX) Q:'$D(LEX("DIC",LEXFI,0,"GL"))  Q:+LEXFI=757.09
"RTN","LEXXFI2",47,0)
 S LEXLDR=$G(LEXLDR),LEXCS=$$CHECKSUM(LEXFI,.LEX),LEXND=+($P(LEXCS,"^",2)),LEXCS=+($P(LEXCS,"^",1))
"RTN","LEXXFI2",48,0)
 S LEXTND=+($G(LEXTND))+LEXND,LEXTCS=+($G(LEXTCS))+LEXCS,LEXFC=+($G(LEXFC))+1
"RTN","LEXXFI2",49,0)
 S:$G(LEXLDR)'["*" LEXTSCS=+($G(LEXTSCS))+LEXCS,LEXTSND=+($G(LEXTSND))+LEXND
"RTN","LEXXFI2",50,0)
 D:LEXFC=1 TL^LEXXFI8($$FMT("   ","File #","Nodes",$S(+LEXMUL>0:"Checksums",1:"Checksum")))
"RTN","LEXXFI2",51,0)
 D:LEXFC=1 TL^LEXXFI8($$FMT("   ","------------","----------","---------------"))
"RTN","LEXXFI2",52,0)
 D TL^LEXXFI8($$FMT(LEXLDR,LEXFI,LEXND,LEXCS))
"RTN","LEXXFI2",53,0)
 Q
"RTN","LEXXFI2",54,0)
FMT(X,LEXFI,LEXND,LEXCS)        ; Format Line
"RTN","LEXXFI2",55,0)
 N LEXT S LEXT=$G(X)_$G(LEXFI) S LEXT=LEXT_$J("",(18-$L(LEXT)))_$J($G(LEXND),10)
"RTN","LEXXFI2",56,0)
 S X=LEXT_$J("",(31-$L(LEXT)))_$J($G(LEXCS),15)
"RTN","LEXXFI2",57,0)
 Q X
"RTN","LEXXFI2",58,0)
CHECKSUM(X,LEX) ; Return CHECKSUM^NODES
"RTN","LEXXFI2",59,0)
 N DIC,LEXC,LEXCNT,LEXCTR,LEXD,LEXE,LEXFI,LEXGCS,LEXN,LEXP,LEXRT,LEXT
"RTN","LEXXFI2",60,0)
 N LEXTYP,LEXID,LEXRC,LEXIC,LEXCTL
"RTN","LEXXFI2",61,0)
 S (LEXRC,LEXIC)=0
"RTN","LEXXFI2",62,0)
 S LEXFI=+($G(X)) Q:+LEXFI'>0 "0^0"  Q:'$D(LEX("DIC",LEXFI,0,"GL")) "0^0"
"RTN","LEXXFI2",63,0)
 S DIC=$G(LEX("DIC",LEXFI,0,"GL")) Q:'$L(DIC) "0^0"
"RTN","LEXXFI2",64,0)
 S LEXRT=$S(DIC[",":($E(DIC,1,($L(DIC)-1))_")"),1:$E(DIC,1,($L(DIC)-1))),LEXC=DIC
"RTN","LEXXFI2",65,0)
 S LEXN=LEXRT,(LEXCNT,LEXCTR,LEXGCS)=0
"RTN","LEXXFI2",66,0)
 F  S LEXN=$Q(@LEXN) Q:LEXN=""!(LEXN'[LEXC)  D
"RTN","LEXXFI2",67,0)
 . S LEXCTR=LEXCTR+1,LEXD=@LEXN
"RTN","LEXXFI2",68,0)
 . S LEXT=LEXN_"="_LEXD,LEXE=$L(LEXT)
"RTN","LEXXFI2",69,0)
 . S LEXID=$P(LEXN,DIC,2,200)
"RTN","LEXXFI2",70,0)
 . S:LEXID["," LEXID=$P(LEXID,",",1)
"RTN","LEXXFI2",71,0)
 . S:LEXID[")" LEXID=$P(LEXID,")",1)
"RTN","LEXXFI2",72,0)
 . S LEXTYP="UNK" S:+LEXID=LEXID LEXTYP="REC"
"RTN","LEXXFI2",73,0)
 . S:+LEXID'=LEXID LEXTYP="IDX"
"RTN","LEXXFI2",74,0)
 . S LEXCTL=$$CTL(LEXT) I +LEXCTL>0 D
"RTN","LEXXFI2",75,0)
 . . Q:LEXTYP="UNK"  N LEXTOT S LEXTOT=0
"RTN","LEXXFI2",76,0)
 . . S:LEXTYP="REC" (LEXTOT,LEXRC)=LEXRC+LEXCTL
"RTN","LEXXFI2",77,0)
 . . S:LEXTYP="IDX" (LEXTOT,LEXIC)=LEXIC+LEXCTL
"RTN","LEXXFI2",78,0)
 . . S $P(LEXCTLC(+LEXFI,LEXTYP),"^",1)=$P($G(LEXCTLC(+LEXFI,LEXTYP)),"^",1)+1
"RTN","LEXXFI2",79,0)
 . . S $P(LEXCTLC(+LEXFI,LEXTYP),"^",2)=LEXTOT
"RTN","LEXXFI2",80,0)
 . ;
"RTN","LEXXFI2",81,0)
 . F LEXP=1:1:LEXE S LEXGCS=$A(LEXT,LEXP)*LEXP+LEXGCS
"RTN","LEXXFI2",82,0)
 S X=LEXGCS_"^"_LEXCTR D CTLC
"RTN","LEXXFI2",83,0)
 Q X
"RTN","LEXXFI2",84,0)
CTLD ; Control Characters (Display)
"RTN","LEXXFI2",85,0)
 Q:$G(LEXCTLC(0))'>0
"RTN","LEXXFI2",86,0)
 N LEXFI,LEXFIN,LEXFINC,LEXFII,LEXFIIC,LEXLN,LEXTH,LEXT1,LEXT2
"RTN","LEXXFI2",87,0)
 S (LEXFI,LEXFIN,LEXFINC,LEXFII,LEXFIIC,LEXLN)=0
"RTN","LEXXFI2",88,0)
 F  S LEXFI=$O(LEXCTLC(LEXFI)) Q:+LEXFI=0  D
"RTN","LEXXFI2",89,0)
 . S LEXFIN=$G(LEXCTLC(LEXFI,"REC"))
"RTN","LEXXFI2",90,0)
 . S LEXFINC=$P(LEXFIN,"^",2),LEXFIN=$P(LEXFIN,"^",1)
"RTN","LEXXFI2",91,0)
 . S LEXFII=$G(LEXCTLC(LEXFI,"IDX"))
"RTN","LEXXFI2",92,0)
 . S LEXFIIC=$P(LEXFII,"^",2),LEXFII=$P(LEXFII,"^",1)
"RTN","LEXXFI2",93,0)
 . S LEXTH=$$FN^LEXXFI8(LEXFI) Q:'$L(LEXTH)
"RTN","LEXXFI2",94,0)
 . S LEXTH=" "_LEXTH_" file #"_LEXFI S (LEXT1,LEXT2)=""
"RTN","LEXXFI2",95,0)
 . I LEXFIN>0,LEXFINC>0 D
"RTN","LEXXFI2",96,0)
 . . S LEXT1=" "_$J(LEXFIN,4)_" Data Record"_$S(LEXFIN>0:"s",1:"")_" with "_LEXFINC_" control character"_$S(LEXFINC>0:"s",1:"")
"RTN","LEXXFI2",97,0)
 . I LEXFII>0,LEXFIIC>0 D
"RTN","LEXXFI2",98,0)
 . . S LEXT2=" "_$J(LEXFII,4)_" Cross-Reference entr"_$S(LEXFII>0:"ies",1:"y")_" with "_LEXFIIC_" control character"_$S(LEXFIIC>0:"s",1:"")
"RTN","LEXXFI2",99,0)
 . Q:'$L(LEXT1)&('$L(LEXT2))
"RTN","LEXXFI2",100,0)
 . S LEXLN=LEXLN+1 I LEXLN=1 D
"RTN","LEXXFI2",101,0)
 . . D BL^LEXXFI8,TL^LEXXFI8(" Control Character(s) Found")
"RTN","LEXXFI2",102,0)
 . . D TL^LEXXFI8(" =========================="),BL^LEXXFI8
"RTN","LEXXFI2",103,0)
 . D TL^LEXXFI8(LEXTH)
"RTN","LEXXFI2",104,0)
 . D:$L(LEXT1) TL^LEXXFI8(LEXT1)
"RTN","LEXXFI2",105,0)
 . D:$L(LEXT2) TL^LEXXFI8(LEXT2)
"RTN","LEXXFI2",106,0)
 Q
"RTN","LEXXFI2",107,0)
CTL(X) ; Control Characters
"RTN","LEXXFI2",108,0)
 N TXT S TXT=$G(X)
"RTN","LEXXFI2",109,0)
 N I,CHR S X=0 F I=1:1 S CHR=$E($G(TXT),I) Q:'$L(CHR)  D
"RTN","LEXXFI2",110,0)
 . I $A(CHR)<32!($A(CHR)>126) S X=X+1
"RTN","LEXXFI2",111,0)
 Q X
"RTN","LEXXFI2",112,0)
CTLC ; Control Character Array
"RTN","LEXXFI2",113,0)
 N LEXFI,LEXND,LEXCC,LEXFIC,LEXNDC,LEXCCC
"RTN","LEXXFI2",114,0)
 S (LEXFI,LEXND,LEXCC,LEXFIC,LEXNDC,LEXCCC)=0
"RTN","LEXXFI2",115,0)
 F  S LEXFI=$O(LEXCTLC(LEXFI)) Q:+LEXFI=0  D
"RTN","LEXXFI2",116,0)
 . S LEXFIC=LEXFIC+1,(LEXNDC,LEXCCC)=0
"RTN","LEXXFI2",117,0)
 . S LEXND=$P($G(LEXCTLC(LEXFI,"REC")),"^",1)
"RTN","LEXXFI2",118,0)
 . S LEXCC=$P($G(LEXCTLC(LEXFI,"REC")),"^",2)
"RTN","LEXXFI2",119,0)
 . S LEXNDC=LEXNDC+LEXND,LEXCCC=LEXCCC+LEXCC
"RTN","LEXXFI2",120,0)
 . S LEXND=$P($G(LEXCTLC(LEXFI,"IDX")),"^",1)
"RTN","LEXXFI2",121,0)
 . S LEXCC=$P($G(LEXCTLC(LEXFI,"IDX")),"^",2)
"RTN","LEXXFI2",122,0)
 . S LEXNDC=LEXNDC+LEXND,LEXCCC=LEXCCC+LEXCC
"RTN","LEXXFI2",123,0)
 . S LEXCTLC(LEXFI,0)=LEXNDC_"^"_LEXCCC
"RTN","LEXXFI2",124,0)
 . S LEXCTLC(0)=LEXFIC
"RTN","LEXXFI2",125,0)
 Q
"RTN","LEXXFI2",126,0)
TT ;
"RTN","LEXXFI2",127,0)
 S LEXCTLC(0)=1
"RTN","LEXXFI2",128,0)
 S LEXCTLC(80,0)="43^43"
"RTN","LEXXFI2",129,0)
 S LEXCTLC(80,"IDX")="12^14"
"RTN","LEXXFI2",130,0)
 S LEXCTLC(80,"REC")="8^10"
"RTN","LEXXFI2",131,0)
 S LEXCTLC(81,0)="43^43"
"RTN","LEXXFI2",132,0)
 S LEXCTLC(81,"IDX")="20^28"
"RTN","LEXXFI2",133,0)
 S LEXCTLC(81,"REC")="23^26"
"RTN","LEXXFI2",134,0)
 Q
"RTN","LEXXFI3")
0^4^B36032723
"RTN","LEXXFI3",1,0)
LEXXFI3 ; ISL/KER - File Info - Record Count            ; 07/28/2004
"RTN","LEXXFI3",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI3",3,0)
 Q
"RTN","LEXXFI3",4,0)
 ;            
"RTN","LEXXFI3",5,0)
 ; Global Variables
"RTN","LEXXFI3",6,0)
 ;   ^TMP("LEXCNT",$J    SACC 2.3.2.5.1
"RTN","LEXXFI3",7,0)
 ;                
"RTN","LEXXFI3",8,0)
 ; External References
"RTN","LEXXFI3",9,0)
 ;   None
"RTN","LEXXFI3",10,0)
 ;                      
"RTN","LEXXFI3",11,0)
ONE(X) ; Record Count for a File
"RTN","LEXXFI3",12,0)
 N LEXFI K ^TMP("LEXCNT",$J) S LEXFI=+($G(X)) Q:+X'>0  K LEXMD D CNT(LEXFI),DSP^LEXXFI4
"RTN","LEXXFI3",13,0)
 Q
"RTN","LEXXFI3",14,0)
ALL ; Record Count for a File(s)
"RTN","LEXXFI3",15,0)
 N LEXCTR,LEXEX,LEXFI,LEXLINE,LEXRTN,LEXTAG K ^TMP("LEXCNT",$J)
"RTN","LEXXFI3",16,0)
 S LEXFI="",LEXTAG="FILES",LEXRTN="LEXXFI",LEXCTR=0
"RTN","LEXXFI3",17,0)
 F  D  Q:LEXFI=""
"RTN","LEXXFI3",18,0)
 . S LEXCTR=LEXCTR+1,LEXEX="S LEXLINE=$T("_LEXTAG_"+"_LEXCTR_"^"_LEXRTN_")" X LEXEX
"RTN","LEXXFI3",19,0)
 . S LEXFI=$P(LEXLINE,";;",3) I '$L(LEXFI) K LEXMD D DSP^LEXXFI4 Q
"RTN","LEXXFI3",20,0)
 . Q:'$L(LEXFI)  D CNT(LEXFI)
"RTN","LEXXFI3",21,0)
 Q
"RTN","LEXXFI3",22,0)
CNT(X) ; Count Entries for file X
"RTN","LEXXFI3",23,0)
 N DIC,LEX,LEXCFI,LEXCNT,LEXCRT,LEXEXIT,LEXFF,LEXFI,LEXI,LEXIEN
"RTN","LEXXFI3",24,0)
 N LEXIENS,LEXIND,LEXLS,LEXNCT,LEXOF,LEXOND,LEXPCD,LEXPCE,LEXPCI
"RTN","LEXXFI3",25,0)
 N LEXPCO,LEXPCT,LEXREC,LEXSL
"RTN","LEXXFI3",26,0)
 S LEXFF=$G(X) Q:'$L(LEXFF)  Q:+LEXFF'>0
"RTN","LEXXFI3",27,0)
 D DDI^LEXXFI6(LEXFF,.LEX) Q:'$D(LEX("DD",+LEXFF))
"RTN","LEXXFI3",28,0)
 S LEXFI=$$PAR(+LEXFF) Q:+LEXFI'>0  K LEX
"RTN","LEXXFI3",29,0)
 I '$D(LEX("DD",LEXFI)) D DDI^LEXXFI6(LEXFI,.LEX)
"RTN","LEXXFI3",30,0)
 Q:'$D(LEX("DD",+LEXFI))  Q:'$D(LEX("DIC",+LEXFI,0,"GL"))
"RTN","LEXXFI3",31,0)
 Q:$D(^TMP("LEXCNT",$J,"B",+LEXFI))  S ^TMP("LEXCNT",$J,"B",+LEXFI)=""
"RTN","LEXXFI3",32,0)
 S ^TMP("LEXCNT",$J,"CNT")=+($G(^TMP("LEXCNT",$J,"CNT")))+1
"RTN","LEXXFI3",33,0)
 S (LEXEXIT,LEXNCT,LEXIENS,LEXREC,LEXPCO)=0,DIC=$G(LEX("DIC",+LEXFI,0,"GL"))
"RTN","LEXXFI3",34,0)
 Q:'$L(DIC)  S LEXOND=DIC_"0)",LEXCRT=DIC,LEXOF=$P(@LEXOND,"^",4)
"RTN","LEXXFI3",35,0)
 S:$E(DIC,$L(DIC))="(" LEXCRT=$E(DIC,1,($L(DIC)-1))
"RTN","LEXXFI3",36,0)
 S:$E(DIC,$L(DIC))="," LEXCRT=$E(DIC,1,($L(DIC)-1))_")"
"RTN","LEXXFI3",37,0)
 F  S LEXOND=$Q(@LEXOND) Q:LEXOND=""!(LEXOND'[DIC)  D NODE Q:LEXEXIT
"RTN","LEXXFI3",38,0)
 D:+($O(LEXCNT(0)))>0 SAV
"RTN","LEXXFI3",39,0)
 S:+LEXIENS>0 ^TMP("LEXCNT",$J,"IENS",+LEXFI)=(LEXIENS+1)
"RTN","LEXXFI3",40,0)
 I $D(^TMP("LEXCNT","EXIT")) S LEXEXIT=1 K ^TMP("LEXCNT","EXIT")
"RTN","LEXXFI3",41,0)
 Q
"RTN","LEXXFI3",42,0)
NODE ; Count a Node as a Record?
"RTN","LEXXFI3",43,0)
 ;   Do not Count Non-Zero Nodes
"RTN","LEXXFI3",44,0)
 Q:$E(LEXOND,($L(LEXOND)-2),$L(LEXOND))'[",0)"
"RTN","LEXXFI3",45,0)
 ;   Do not Count Header Nodes
"RTN","LEXXFI3",46,0)
 I DIC'[",",LEXOND[",0)",$L(LEXOND,",")#2>0 Q
"RTN","LEXXFI3",47,0)
 I DIC[",",LEXOND[",0)",$L(LEXOND,",")#2'>0 Q
"RTN","LEXXFI3",48,0)
 S LEXIND=$P(LEXOND,DIC,2),LEXIEN=$P(LEXIND,",0)",1) S:+LEXIEN=LEXIEN LEXIENS=LEXIENS+1
"RTN","LEXXFI3",49,0)
 ;   Do not Count Cross-References (Exit Loop)
"RTN","LEXXFI3",50,0)
 I +($P(LEXIND,",",1))'=$P(LEXIND,",",1) S LEXEXIT=1 Q
"RTN","LEXXFI3",51,0)
 ;   Quit if no Sub-Script List
"RTN","LEXXFI3",52,0)
 S LEXSL=$P(LEXIND,")",1) I '$L(LEXSL) S LEXEXIT=1 Q
"RTN","LEXXFI3",53,0)
 ; Percent Complete
"RTN","LEXXFI3",54,0)
 S (LEXPCT,LEXPCE)="",LEXPCI=LEXPCO I LEXIENS>0,LEXOF>0 D
"RTN","LEXXFI3",55,0)
 . S LEXPCT=(LEXIENS/LEXOF)*100,LEXPCI=+($P(LEXPCT,".",1)),LEXPCD=+($E($P(LEXPCT,".",2),1,2))
"RTN","LEXXFI3",56,0)
 . S:$L(LEXPCD)=1 LEXPCD=LEXPCD_"0" S:$L(LEXPCD)=1 LEXPCD=LEXPCD_"0" S LEXPCE=LEXPCI_"%"
"RTN","LEXXFI3",57,0)
 S LEXPCO=LEXPCI
"RTN","LEXXFI3",58,0)
 ;   List Subscripts
"RTN","LEXXFI3",59,0)
 S LEXNCT=LEXNCT+1 K LEXLS D LS(LEXSL,LEXFI) Q:'$D(LEXLS)
"RTN","LEXXFI3",60,0)
 S LEXCFI=$G(LEXLS("FIL")) Q:+LEXCFI'>0  Q:'$D(LEX("DD",+LEXCFI,0))
"RTN","LEXXFI3",61,0)
 S LEXCNT(+LEXCFI)=+($G(LEXCNT(+LEXCFI)))+1,LEXREC=LEXREC+1
"RTN","LEXXFI3",62,0)
 I LEXREC#10000'>0 S:$D(^TMP("LEXCNT","EXIT")) LEXEXIT=1
"RTN","LEXXFI3",63,0)
 Q
"RTN","LEXXFI3",64,0)
LS(X,Y) ; List Subscripts    X = Subscripts Y = File
"RTN","LEXXFI3",65,0)
 N LEXFI,LEXFLD,LEXI,LEXND,LEXNDI,LEXSB,LEXSF,LEXSFI,LEXSFN,LEXSL
"RTN","LEXXFI3",66,0)
 S LEXSL=X Q:'$L(LEXSL)  S LEXFI=+($G(Y)) Q:+LEXFI'>0  Q:'$D(LEX("DIC",+LEXFI,0,"GL"))
"RTN","LEXXFI3",67,0)
 K LEXLS S LEXLS("CNT")=1 F LEXI=1:1 Q:'$L($P(LEXSL,",",LEXI))  D
"RTN","LEXXFI3",68,0)
 . S LEXSB=$P(LEXSL,",",LEXI) I LEXI#2 D
"RTN","LEXXFI3",69,0)
 . . S LEXLS("DA",0)=+($G(LEXLS("DA",0)))+1,LEXLS("DA",+($G(LEXLS("DA",0))))=LEXSB
"RTN","LEXXFI3",70,0)
 . . S:+LEXSB'=LEXSB LEXLS("CNT")=0 S:LEXSB="0" LEXLS("CNT")=0
"RTN","LEXXFI3",71,0)
 . I '(LEXI#2) D
"RTN","LEXXFI3",72,0)
 . . S LEXLS("ND",0)=+($G(LEXLS("ND",0)))+1,LEXLS("ND",+($G(LEXLS("ND",0))))=LEXSB
"RTN","LEXXFI3",73,0)
 S LEXSF=LEXFI,LEXSFN=0,LEXNDI=0 F  S LEXNDI=$O(LEXLS("ND",LEXNDI)) Q:+LEXNDI=0  D
"RTN","LEXXFI3",74,0)
 . S LEXND=$G(LEXLS("ND",LEXNDI)) Q:'$L(LEXND)
"RTN","LEXXFI3",75,0)
 . S LEXND=$TR(LEXND,"""","") I '$L(LEXND) S LEXSF="ERR" Q
"RTN","LEXXFI3",76,0)
 . I '$O(LEX("DD",+LEXSF,"GL",LEXND,0))>0 S LEXSFN=LEXND
"RTN","LEXXFI3",77,0)
 . Q:'$D(LEX("DD",+LEXSF,"GL",LEXND,0))
"RTN","LEXXFI3",78,0)
 . S LEXFLD=$O(LEX("DD",+LEXSF,"GL",LEXND,0,0)) I +LEXFLD'>0 S LEXSF="ERR" Q
"RTN","LEXXFI3",79,0)
 . S LEXSFI=$G(LEX("DD",+LEXSF,+LEXFLD,0))
"RTN","LEXXFI3",80,0)
 . S LEXSFI=+($P(LEXSFI,"^",2)) I +LEXSFI'>0 S LEXSF="ERR" Q
"RTN","LEXXFI3",81,0)
 . S:$D(LEX("DD",+LEXSFI,0)) LEXSF=+LEXSFI
"RTN","LEXXFI3",82,0)
 S LEXLS("FIL")=LEXSF
"RTN","LEXXFI3",83,0)
 S LEXLS("ND")=LEXSFN
"RTN","LEXXFI3",84,0)
 K:LEXSF="ERR" LEXLS("FIL")
"RTN","LEXXFI3",85,0)
 K:+($G(LEXLS("CNT")))'>0 LEXLS
"RTN","LEXXFI3",86,0)
 I $O(LEXLS("ND"," "),-1)>0,$G(LEXLS("ND",$O(LEXLS("ND"," "),-1)))'="0" K LEXLS
"RTN","LEXXFI3",87,0)
 Q
"RTN","LEXXFI3",88,0)
SAV ; Save Counts in ^TMP("LEXCNT",$J)
"RTN","LEXXFI3",89,0)
 N LEXGRND,LEXID,LEXFI,LEXLVL,LEXNAM,LEXPAR,LECTITL,LEXTOT,LEXTYP
"RTN","LEXXFI3",90,0)
 S LEXFI=0 F  S LEXFI=$O(LEXCNT(LEXFI)) Q:+LEXFI=0  D
"RTN","LEXXFI3",91,0)
 . N LEXNAM,LEXTITL,LEXTOT,LEXTYP
"RTN","LEXXFI3",92,0)
 . S LEXNAM=$O(LEX("DD",LEXFI,0,"NM","")) Q:'$L(LEXNAM)
"RTN","LEXXFI3",93,0)
 . S LEXPAR=$$PAR(+LEXFI) Q:+LEXPAR=0  Q:'$D(LEX("DIC",+LEXPAR,0,"GL"))
"RTN","LEXXFI3",94,0)
 . S LEXTOT=+($G(LEXCNT(LEXFI))),LEXGRND=+($G(LEXGRND))+LEXTOT
"RTN","LEXXFI3",95,0)
 . S LEXTYP=$S($D(LEX("DD",+LEXFI))&('$D(LEX("DIC",+LEXFI))):"Sub-File",1:"File")
"RTN","LEXXFI3",96,0)
 . S LEXTITL=LEXTYP_" #"_LEXFI,^TMP("LEXCNT",$J,LEXPAR,0)=LEXGRND
"RTN","LEXXFI3",97,0)
 . S ^TMP("LEXCNT",$J,LEXPAR,LEXFI)=LEXTOT_"^"_LEXNAM_"^"_LEXTITL
"RTN","LEXXFI3",98,0)
 . S LEXID=$$ID(LEXFI),LEXLVL=$$LVL(LEXFI)
"RTN","LEXXFI3",99,0)
 . S:$L(LEXID) ^TMP("LEXCNT",$J,"ORDER",+LEXPAR,(LEXID_";"))=LEXPAR_"^"_LEXFI_"^"_LEXLVL
"RTN","LEXXFI3",100,0)
 . S:'$D(^TMP("LEXCNT",$J,"LVL")) ^TMP("LEXCNT",$J,"LVL")=1
"RTN","LEXXFI3",101,0)
 . S:'$D(^TMP("LEXCNT",$J,"HSF")) ^TMP("LEXCNT",$J,"HSF")=0
"RTN","LEXXFI3",102,0)
 . S:'$D(^TMP("LEXCNT",$J,"SUB")) ^TMP("LEXCNT",$J,"SUB")=0
"RTN","LEXXFI3",103,0)
 . S:+LEXLVL>+($G(^TMP("LEXCNT",$J,"LVL"))) ^TMP("LEXCNT",$J,"LVL")=+LEXLVL
"RTN","LEXXFI3",104,0)
 . S:$L((LEXID_";"),";")>2 ^TMP("LEXCNT",$J,"HSF")=1
"RTN","LEXXFI3",105,0)
 . S:$L((LEXID_";"),";")>2 ^TMP("LEXCNT",$J,"SUB")=+($G(^TMP("LEXCNT",$J,"SUB")))+1
"RTN","LEXXFI3",106,0)
 . S LEXID=$P(LEXID,";",1) S:$L(LEXID) LEXID=LEXID_";~;"
"RTN","LEXXFI3",107,0)
 . S:$L(LEXID) ^TMP("LEXCNT",$J,"ORDER",+LEXPAR,(LEXID_";"))=LEXPAR_"^0^0"
"RTN","LEXXFI3",108,0)
 Q
"RTN","LEXXFI3",109,0)
PAR(X) ; Parent File        X = File/Sub-File Number
"RTN","LEXXFI3",110,0)
 N LEXPAR,LEXSUB S LEXSUB=$G(X)  Q:+LEXSUB'>0 ""
"RTN","LEXXFI3",111,0)
 I '$D(LEX("DD",+LEXSUB)) D DDI^LEXXFI6(+LEXSUB,.LEX)
"RTN","LEXXFI3",112,0)
 Q:'$D(LEX("DD",+LEXSUB,0)) ""  I '$D(LEX("DD",+LEXSUB,0,"UP")) S X=LEXSUB Q X
"RTN","LEXXFI3",113,0)
 S LEXPAR=LEXSUB F  Q:('$D(LEX("DD",+LEXSUB,0,"UP")))  D
"RTN","LEXXFI3",114,0)
 . S (LEXSUB,LEXPAR)=$G(LEX("DD",+LEXSUB,0,"UP"))
"RTN","LEXXFI3",115,0)
 S X=LEXPAR
"RTN","LEXXFI3",116,0)
 Q X
"RTN","LEXXFI3",117,0)
LVL(X) ; Level of File      X = File/Sub-File Number
"RTN","LEXXFI3",118,0)
 N LEXLVL,LEXPAR,LEXSUB S LEXSUB=$G(X)  Q:+LEXSUB'>0 0
"RTN","LEXXFI3",119,0)
 I '$D(LEX("DD",+LEXSUB)) D DDI^LEXXFI6(+LEXSUB,.LEX)
"RTN","LEXXFI3",120,0)
 Q:'$D(LEX("DD",+LEXSUB,0)) 0  Q:'$D(LEX("DD",+LEXSUB,0,"UP")) 1
"RTN","LEXXFI3",121,0)
 S LEXLVL=1,LEXPAR=LEXSUB F  Q:('$D(LEX("DD",+LEXSUB,0,"UP")))  D
"RTN","LEXXFI3",122,0)
 . S (LEXSUB,LEXPAR)=$G(LEX("DD",+LEXSUB,0,"UP")),LEXLVL=LEXLVL+1
"RTN","LEXXFI3",123,0)
 S X=LEXLVL Q X
"RTN","LEXXFI3",124,0)
ID(X) ; Unique Identifier  X = File/Sub-File Number
"RTN","LEXXFI3",125,0)
 N LEXID,LEXPAR,LEXSUB S LEXID="",LEXSUB=$G(X)  Q:+LEXSUB'>0 ""
"RTN","LEXXFI3",126,0)
 I '$D(LEX("DD",+LEXSUB)) D DDI^LEXXFI6(+LEXSUB,.LEX)
"RTN","LEXXFI3",127,0)
 Q:'$D(LEX("DD",+LEXSUB,0)) ""  Q:'$D(LEX("DD",+LEXSUB,0,"UP")) +LEXSUB
"RTN","LEXXFI3",128,0)
 S LEXID=+LEXSUB,LEXPAR=LEXSUB F  Q:('$D(LEX("DD",+LEXSUB,0,"UP")))  D
"RTN","LEXXFI3",129,0)
 . S (LEXSUB,LEXPAR)=$G(LEX("DD",+LEXSUB,0,"UP"))
"RTN","LEXXFI3",130,0)
 . S:$L(LEXSUB) LEXID=LEXSUB_";"_LEXID
"RTN","LEXXFI3",131,0)
 S X=LEXID
"RTN","LEXXFI3",132,0)
 Q X
"RTN","LEXXFI4")
0^5^B23614617
"RTN","LEXXFI4",1,0)
LEXXFI4 ; ISL/KER - File Info - Record Counts (2)      ; 07/28/2004
"RTN","LEXXFI4",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI4",3,0)
 Q
"RTN","LEXXFI4",4,0)
 ;                    
"RTN","LEXXFI4",5,0)
 ; Global Variables
"RTN","LEXXFI4",6,0)
 ;   ^TMP("LEXCNT",$J   SACC 2.3.2.5.1  
"RTN","LEXXFI4",7,0)
 ;              
"RTN","LEXXFI4",8,0)
 ; External References
"RTN","LEXXFI4",9,0)
 ;   DBIA 10103  $$FMDIFF^XLFDT
"RTN","LEXXFI4",10,0)
 ;                    
"RTN","LEXXFI4",11,0)
DSP ; Display Results
"RTN","LEXXFI4",12,0)
 N LEXFP,LEXCT,LEXFI,LEXGTOT,LEXHSF,LEXJOB,LEXMD,LEXX,LEXLVL,LEXML
"RTN","LEXXFI4",13,0)
 N LEXNCFI,LEXNFI,LEXNPAR,LEXOPAR,LEXO,LEXPAR,LEXTAB,LEXTXT
"RTN","LEXXFI4",14,0)
 S (LEXCT,LEXGTOT,LEXML)=0,LEXOPAR=""
"RTN","LEXXFI4",15,0)
 S LEXJOB=$J S:+($G(LEXMD))>0 LEXJOB=+($G(LEXMD))
"RTN","LEXXFI4",16,0)
 K:$D(LEXMD) LEXMD S LEXFP="" S LEXFP=""
"RTN","LEXXFI4",17,0)
 F  S LEXFP=$O(^TMP("LEXCNT",LEXJOB,"ORDER",LEXFP)) Q:LEXFP=""  D
"RTN","LEXXFI4",18,0)
 . S LEXO=""
"RTN","LEXXFI4",19,0)
 . F  S LEXO=$O(^TMP("LEXCNT",LEXJOB,"ORDER",LEXFP,LEXO)) Q:LEXO=""  D
"RTN","LEXXFI4",20,0)
 . . N LEXFI,LEXPAR,LEXLVL,LEXTAB,LEXTXT,LEXHSF,LEXX
"RTN","LEXXFI4",21,0)
 . . S LEXTAB="",LEXHSF=0
"RTN","LEXXFI4",22,0)
 . . S LEXPAR=$G(^TMP("LEXCNT",LEXJOB,"ORDER",LEXFP,LEXO))
"RTN","LEXXFI4",23,0)
 . . S LEXFI=+($P(LEXPAR,"^",2)),LEXLVL=+($P(LEXPAR,"^",3))
"RTN","LEXXFI4",24,0)
 . . S LEXPAR=+($P(LEXPAR,"^",1)) Q:LEXPAR=0
"RTN","LEXXFI4",25,0)
 . . S LEXNFI=$O(^TMP("LEXCNT",LEXJOB,LEXPAR,LEXPAR))
"RTN","LEXXFI4",26,0)
 . . S:LEXNFI>0&(LEXNFI'=LEXPAR) LEXHSF=1
"RTN","LEXXFI4",27,0)
 . . S LEXX=$G(^TMP("LEXCNT",LEXJOB,LEXPAR,LEXFI)),LEXCT=LEXCT+1
"RTN","LEXXFI4",28,0)
 . . S LEXNPAR=$O(^TMP("LEXCNT",LEXJOB,"ORDER",LEXFP,LEXO))
"RTN","LEXXFI4",29,0)
 . . S LEXNPAR=$P(LEXNPAR,";",1)
"RTN","LEXXFI4",30,0)
 . . S LEXNCFI=$O(^TMP("LEXCNT",LEXJOB,"ORDER",LEXFP))
"RTN","LEXXFI4",31,0)
 . . I '$L(LEXNPAR),$L(LEXNCFI) S LEXML=1
"RTN","LEXXFI4",32,0)
 . . I LEXCT=1 D TTL,HDR
"RTN","LEXXFI4",33,0)
 . . I +LEXFI>0 D TSF
"RTN","LEXXFI4",34,0)
 . . I +LEXFI'>0,+($G(LEXHSF))>0 D GTSF
"RTN","LEXXFI4",35,0)
 D GT,CK
"RTN","LEXXFI4",36,0)
 Q
"RTN","LEXXFI4",37,0)
TSF ;   Total for a Single File/Sub-File
"RTN","LEXXFI4",38,0)
 N LEXNM,LEXTAB,LEXTOT,LEXTXT,LEXTYP
"RTN","LEXXFI4",39,0)
 S LEXX=$G(LEXX),LEXTOT=+LEXX,LEXNM=$P(LEXX,"^",2)
"RTN","LEXXFI4",40,0)
 S LEXTYP=$P(LEXX,"^",3),LEXTAB=""
"RTN","LEXXFI4",41,0)
 Q:+LEXTOT'>0  Q:'$L(LEXNM)  Q:'$L(LEXTYP)
"RTN","LEXXFI4",42,0)
 S $P(LEXTAB," ",(+($G(LEXLVL))*2))=""
"RTN","LEXXFI4",43,0)
 S LEXTXT="  "_LEXTAB_LEXNM_" ("_LEXTYP_")"
"RTN","LEXXFI4",44,0)
 S LEXTXT=LEXTXT_$J("",(60-$L(LEXTXT)))_$J(LEXTOT,9)
"RTN","LEXXFI4",45,0)
 S LEXGTOT=+($G(LEXGTOT))+LEXTOT D TL^LEXXFI8(LEXTXT)
"RTN","LEXXFI4",46,0)
 Q
"RTN","LEXXFI4",47,0)
GTSF ;   Grand Total for a Single File
"RTN","LEXXFI4",48,0)
 N LEXLVL,LEXNM,LEXTAB,LEXTOT,LEXTXT,LEXTYP,LEXX
"RTN","LEXXFI4",49,0)
 S LEXX=$G(^TMP("LEXCNT",LEXJOB,LEXPAR,LEXPAR)),LEXLVL=+($$ML)+2
"RTN","LEXXFI4",50,0)
 S LEXNM=$P(LEXX,"^",2),LEXTYP=$P(LEXX,"^",3) Q:'$L(LEXNM)  Q:'$L(LEXTYP)
"RTN","LEXXFI4",51,0)
 S LEXTAB="",LEXX=$G(^TMP("LEXCNT",LEXJOB,LEXPAR,0))
"RTN","LEXXFI4",52,0)
 S LEXTOT=+LEXX,$P(LEXTAB," ",(LEXLVL*2))=""
"RTN","LEXXFI4",53,0)
 S LEXTXT="  "_LEXTAB_" - Total Records for "_LEXTYP
"RTN","LEXXFI4",54,0)
 S LEXTXT=LEXTXT_$J("",(60-$L(LEXTXT)))_$J(LEXTOT,9)
"RTN","LEXXFI4",55,0)
 D TL^LEXXFI8(LEXTXT)
"RTN","LEXXFI4",56,0)
 Q
"RTN","LEXXFI4",57,0)
GT ;   Grand Totals for Multiple Files
"RTN","LEXXFI4",58,0)
 N LEXCT,LEXFI,LEXTXT S LEXCT=0,LEXFI="" I +($G(LEXGTOT))>0,+($G(LEXML))>0 D
"RTN","LEXXFI4",59,0)
 . D BL^LEXXFI8 S LEXTXT="   GRAND TOTAL (ALL FILES) "
"RTN","LEXXFI4",60,0)
 . S LEXTXT=LEXTXT_$J("",(50-$L(LEXTXT)))_$J(LEXGTOT,19) D TL^LEXXFI8(LEXTXT)
"RTN","LEXXFI4",61,0)
 Q
"RTN","LEXXFI4",62,0)
TTL ; Record Count Title
"RTN","LEXXFI4",63,0)
 D:+($G(LEXMUL))>0 TT^LEXXFI8("","Record Counts")
"RTN","LEXXFI4",64,0)
 D:+($G(LEXMUL))'>0 TT^LEXXFI8($G(LEXFI),"Record Count")
"RTN","LEXXFI4",65,0)
 D BL^LEXXFI8
"RTN","LEXXFI4",66,0)
 Q
"RTN","LEXXFI4",67,0)
HDR ; Record Count Header
"RTN","LEXXFI4",68,0)
 N LEXTXT S LEXTXT="   Name (File Number)"
"RTN","LEXXFI4",69,0)
 S LEXTXT=LEXTXT_$J("",(60-$L(LEXTXT)))_$J("Entries",9) D TL^LEXXFI8(LEXTXT)
"RTN","LEXXFI4",70,0)
 S LEXTXT="   -------------------------------------------------"
"RTN","LEXXFI4",71,0)
 S LEXTXT=LEXTXT_$J("",(60-$L(LEXTXT)))_$J("-------",9) D TL^LEXXFI8(LEXTXT)
"RTN","LEXXFI4",72,0)
 Q
"RTN","LEXXFI4",73,0)
CK ; Records Checked
"RTN","LEXXFI4",74,0)
 N LEXF,LEXS,LEXFT,LEXST,LEXJ S LEXJ=$S(+($G(LEXJOB))>0:+($G(LEXJOB)),1:$J)
"RTN","LEXXFI4",75,0)
 S LEXF=+($G(^TMP("LEXCNT",LEXJ,"CNT")))
"RTN","LEXXFI4",76,0)
 S LEXFT=$S(LEXF=1:"1 File",LEXF>1:(LEXF_" Files"),1:"")
"RTN","LEXXFI4",77,0)
 S LEXS=+($G(^TMP("LEXCNT",LEXJ,"SUB")))
"RTN","LEXXFI4",78,0)
 S LEXST=$S(LEXS=1:"1 Sub-File",LEXS>1:(LEXS_" Sub-Files"),1:"")
"RTN","LEXXFI4",79,0)
 I (LEXF+LEXS)>1 D
"RTN","LEXXFI4",80,0)
 . S LEXTXT="   " S:$L(LEXFT) LEXTXT=LEXTXT_LEXFT
"RTN","LEXXFI4",81,0)
 . S:$L(LEXFT)&($L(LEXST)) LEXTXT=LEXTXT_" and "_LEXST
"RTN","LEXXFI4",82,0)
 . S:'$L(LEXFT)&($L(LEXST)) LEXTXT=LEXTXT_LEXST
"RTN","LEXXFI4",83,0)
 . I $L(LEXFT)!($L(LEXST)) S LEXTXT=LEXTXT_" Checked" D
"RTN","LEXXFI4",84,0)
 . . D BL^LEXXFI8,TL^LEXXFI8(LEXTXT)
"RTN","LEXXFI4",85,0)
 Q
"RTN","LEXXFI4",86,0)
ML(X) ; Maximum Level
"RTN","LEXXFI4",87,0)
 N LEXJ S LEXJ=$S(+($G(LEXJOB))>0:+($G(LEXJOB)),1:$J)
"RTN","LEXXFI4",88,0)
 S X=+($G(^TMP("LEXCNT",LEXJ,"LVL"))) S:+X'>0 X=1
"RTN","LEXXFI4",89,0)
 Q X
"RTN","LEXXFI4",90,0)
NF(X) ; Number of Files
"RTN","LEXXFI4",91,0)
 N LEXJ S LEXJ=$S(+($G(LEXJOB))>0:+($G(LEXJOB)),1:$J)
"RTN","LEXXFI4",92,0)
 S X=+($G(^TMP("LEXCNT",LEXJ,"CNT")))
"RTN","LEXXFI4",93,0)
 Q X
"RTN","LEXXFI4",94,0)
NS(X) ; Number of Sub-Files
"RTN","LEXXFI4",95,0)
 N LEXJ S LEXJ=$S(+($G(LEXJOB))>0:+($G(LEXJOB)),1:$J)
"RTN","LEXXFI4",96,0)
 S X=+($G(^TMP("LEXCNT",LEXJ,"SUB")))
"RTN","LEXXFI4",97,0)
 Q X
"RTN","LEXXFI4",98,0)
ST ; Show TMP Array
"RTN","LEXXFI4",99,0)
 N NN,NC S NN="^TMP(""LEXCNT"")",NC="^TMP(""LEXCNT"","
"RTN","LEXXFI4",100,0)
 F  S NN=$Q(@NN) Q:NN=""!(NN'[NC)  D
"RTN","LEXXFI4",101,0)
 . W !,NN,"=",@NN
"RTN","LEXXFI4",102,0)
 Q
"RTN","LEXXFI4",103,0)
EP(X,Y) ;   Elapsed Time (Begin, End)
"RTN","LEXXFI4",104,0)
 N LEXTIM,LEXBEG,LEXEND
"RTN","LEXXFI4",105,0)
 S LEXBEG=$G(X),LEXEND=$G(Y) Q:+LEXBEG'>0 ""  Q:+LEXEND'>0 ""
"RTN","LEXXFI4",106,0)
 S LEXTIM=$$FMDIFF^XLFDT(LEXEND,LEXBEG,2) Q:+LEXTIM'>0 "00:00:00"
"RTN","LEXXFI4",107,0)
 S LEXTIM=$$TIM(LEXTIM)
"RTN","LEXXFI4",108,0)
 Q LEXTIM
"RTN","LEXXFI4",109,0)
TIM(X) ;   Format Time Elapsed
"RTN","LEXXFI4",110,0)
 N LEXD,LEXH,LEXM,LEXS,LEXT,LEXV S X=+($G(X)) Q:X'>0 "00:00:00"
"RTN","LEXXFI4",111,0)
 S LEXD=X\86400 S LEXV=LEXD*86400 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXFI4",112,0)
 S LEXH=X\3600 S LEXV=LEXH*3600 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXFI4",113,0)
 S:$L(LEXH)<2 LEXH="0"_LEXH S:$L(LEXH)<2 LEXH="0"_LEXH
"RTN","LEXXFI4",114,0)
 S LEXM=X\60 S LEXV=LEXM*60 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXFI4",115,0)
 S:$L(LEXM)<2 LEXM="0"_LEXM S:$L(LEXM)<2 LEXM="0"_LEXM
"RTN","LEXXFI4",116,0)
 S LEXS=X S:$L(LEXS)<2 LEXS="0"_LEXS S:$L(LEXS)<2 LEXS="0"_LEXS
"RTN","LEXXFI4",117,0)
 S LEXT="" S:+LEXD>0 LEXT=+LEXD_" day"_$S(+LEXD>1:"s",1:"")_" "
"RTN","LEXXFI4",118,0)
 S LEXT=LEXT_LEXH_":"_LEXM_":"_LEXS,X=LEXT
"RTN","LEXXFI4",119,0)
 Q X
"RTN","LEXXFI5")
0^6^B9998256
"RTN","LEXXFI5",1,0)
LEXXFI5 ; ISL/KER - File Info - Versions/Revisions     ; 07/28/2004
"RTN","LEXXFI5",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI5",3,0)
 Q
"RTN","LEXXFI5",4,0)
 ;                    
"RTN","LEXXFI5",5,0)
 ; Global Variables
"RTN","LEXXFI5",6,0)
 ;    None
"RTN","LEXXFI5",7,0)
 ;                        
"RTN","LEXXFI5",8,0)
 ; External References
"RTN","LEXXFI5",9,0)
 ;    None
"RTN","LEXXFI5",10,0)
 ;                    
"RTN","LEXXFI5",11,0)
ONE(X) ; Version/Revision - One File
"RTN","LEXXFI5",12,0)
 N LEXCTL,LEXCTR,LEXEX,LEXFC,LEXFI,LEXLINE,LEXRTN,LEXTAG
"RTN","LEXXFI5",13,0)
 Q:'$L(X)  S LEXCTL=+($G(X)) Q:+LEXCTL'>0
"RTN","LEXXFI5",14,0)
 S LEXFI="",LEXTAG="FILES",LEXRTN="LEXXFI",(LEXCTR,LEXFC)=0
"RTN","LEXXFI5",15,0)
 F  D  Q:LEXFI=""
"RTN","LEXXFI5",16,0)
 . S LEXCTR=LEXCTR+1,LEXEX="S LEXLINE=$T("_LEXTAG_"+"_LEXCTR_"^"_LEXRTN_")"
"RTN","LEXXFI5",17,0)
 . X LEXEX S LEXFI=$P(LEXLINE,";;",3) Q:'$L(LEXFI)  Q:LEXFI'=LEXCTL  D VR(LEXFI)
"RTN","LEXXFI5",18,0)
 Q
"RTN","LEXXFI5",19,0)
ALL ; Version/Revision
"RTN","LEXXFI5",20,0)
 N LEXCTR,LEXEX,LEXFC,LEXFI,LEXLINE,LEXRTN,LEXTAG
"RTN","LEXXFI5",21,0)
 S LEXFI="",LEXTAG="FILES",LEXRTN="LEXXFI",(LEXCTR,LEXFC)=0
"RTN","LEXXFI5",22,0)
 F  D  Q:LEXFI=""
"RTN","LEXXFI5",23,0)
 . S LEXCTR=LEXCTR+1,LEXEX="S LEXLINE=$T("_LEXTAG_"+"_LEXCTR_"^"_LEXRTN_")"
"RTN","LEXXFI5",24,0)
 . X LEXEX S LEXFI=$P(LEXLINE,";;",3) Q:'$L(LEXFI)  D VR(LEXFI)
"RTN","LEXXFI5",25,0)
 Q
"RTN","LEXXFI5",26,0)
VR(X) ; Get Version/Revision
"RTN","LEXXFI5",27,0)
 N LEXDD,LEXFI,LEXFIT,LEXFN,LEXIN,LEXLDR,LEXR,LEXRD,LEXRT,LEXT
"RTN","LEXXFI5",28,0)
 N LEXV,LEXVD,LEXVT S LEXFI=+($G(X)) Q:+LEXFI'>0
"RTN","LEXXFI5",29,0)
 S LEXFIT=$J($P(LEXFI,".",1),3)
"RTN","LEXXFI5",30,0)
 S:LEXFI["."&($L($P(LEXFI,".",2))) LEXFIT=LEXFIT_"."_$P(LEXFI,".",2)
"RTN","LEXXFI5",31,0)
 F  Q:$L(LEXFIT)'<7  S LEXFIT=LEXFIT_" "
"RTN","LEXXFI5",32,0)
 S LEXFN=$E($$FN^LEXXFI8(LEXFI),1,25)
"RTN","LEXXFI5",33,0)
 F  Q:LEXFN'["CATEGORY"  S LEXFN=$P(LEXFN,"CATEGORY",1)_"CAT"_$P(LEXFN,"CATEGORY",2)
"RTN","LEXXFI5",34,0)
 F  Q:LEXFN'["PROCEDURE"  S LEXFN=$P(LEXFN,"PROCEDURE",1)_"PROC"_$P(LEXFN,"PROCEDURE",2)
"RTN","LEXXFI5",35,0)
 F  Q:LEXFN'["NARRATIVES"  S LEXFN=$P(LEXFN,"NARRATIVES",1)_"NARR"_$P(LEXFN,"NARRATIVES",2)
"RTN","LEXXFI5",36,0)
 F  Q:$L(LEXFN)'<20  S LEXFN=LEXFN_" "
"RTN","LEXXFI5",37,0)
 S LEXV=$$VR^LEXXFI8(LEXFI)
"RTN","LEXXFI5",38,0)
 S LEXVD=$P(LEXV,"^",2) S:'$L(LEXVD) LEXVD="--/--/----" F  Q:$L(LEXVD)'<10  S LEXVD=LEXVD_" "
"RTN","LEXXFI5",39,0)
 S LEXDD=$P(LEXV,"^",3)
"RTN","LEXXFI5",40,0)
 S LEXLDR="   "
"RTN","LEXXFI5",41,0)
 S LEXV=$P(LEXV,"^",1)
"RTN","LEXXFI5",42,0)
 S LEXVT=$J($P(LEXV,".",1),3)
"RTN","LEXXFI5",43,0)
 S:LEXV["."&($L($P(LEXV,".",2))) LEXVT=LEXVT_"."_$P(LEXV,".",2)
"RTN","LEXXFI5",44,0)
 F  Q:$L(LEXVT)'<4  S LEXVT=LEXVT_" "
"RTN","LEXXFI5",45,0)
 S LEXR=$$RV^LEXXFI8(LEXFI)
"RTN","LEXXFI5",46,0)
 S LEXRD=$P(LEXR,"^",2)
"RTN","LEXXFI5",47,0)
 S:'$L(LEXRD) LEXRD="--/--/----" F  Q:$L(LEXRD)'<10  S LEXRD=LEXRD_" "
"RTN","LEXXFI5",48,0)
 S LEXR=$P(LEXR,"^",1) S:'$L(LEXR) LEXR="--" S LEXR=$J(LEXR,2)
"RTN","LEXXFI5",49,0)
 S LEXIN=$$INS^LEXXFI8(LEXFI) S:LEXIN="" LEXIN="--/--/----"
"RTN","LEXXFI5",50,0)
 S LEXFC=LEXFC+1 I LEXFC=1 D
"RTN","LEXXFI5",51,0)
 . D:+($G(LEXMUL))>0 TT^LEXXFI8("","Versions/Revisions")
"RTN","LEXXFI5",52,0)
 . D:+($G(LEXMUL))'>0 TT^LEXXFI8(LEXFI,"Version/Revision")
"RTN","LEXXFI5",53,0)
 . D BL^LEXXFI8 S LEXT="                                        Version         Revision    Install"
"RTN","LEXXFI5",54,0)
 . D TL^LEXXFI8(LEXT)
"RTN","LEXXFI5",55,0)
 . S LEXT="   File #  File Name              VR      Date     RV     Date        Date"
"RTN","LEXXFI5",56,0)
 . D TL^LEXXFI8(LEXT)
"RTN","LEXXFI5",57,0)
 . S LEXT="   ------- --------------------  ----  ----------  --  ----------  ----------"
"RTN","LEXXFI5",58,0)
 . D TL^LEXXFI8(LEXT)
"RTN","LEXXFI5",59,0)
 S LEXT=LEXLDR_LEXFIT_" "_LEXFN_" "_LEXVT_"  "_LEXVD_"  "_LEXR_"  "_LEXRD_"  "_LEXIN
"RTN","LEXXFI5",60,0)
 D TL^LEXXFI8(LEXT)
"RTN","LEXXFI5",61,0)
 Q
"RTN","LEXXFI6")
0^7^B7377365
"RTN","LEXXFI6",1,0)
LEXXFI6 ; ISL/KER - File Info - DD Information      ; 07/28/2004
"RTN","LEXXFI6",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI6",3,0)
 Q
"RTN","LEXXFI6",4,0)
 ;                        
"RTN","LEXXFI6",5,0)
 ; Global Variables
"RTN","LEXXFI6",6,0)
 ;   ^TMP("LEXI",$J      SACC 2.3.2.5.1
"RTN","LEXXFI6",7,0)
 ;                       
"RTN","LEXXFI6",8,0)
 ; External References
"RTN","LEXXFI6",9,0)
 ;   DBIA 10022  %XY^%RCR
"RTN","LEXXFI6",10,0)
 ;                            
"RTN","LEXXFI6",11,0)
DDI(X,LEX) ; Data Dictionary Information
"RTN","LEXXFI6",12,0)
 N %X,%Y,LEXFI,LEXFLD,LEXLOC,LEXND,LEXNDD,LEXNM,LEXSF
"RTN","LEXXFI6",13,0)
 K ^TMP("LEXI",$J) S LEXFI=+($G(X)) Q:+LEXFI'>0
"RTN","LEXXFI6",14,0)
 S %X="^DD("_LEXFI_",",%Y="^TMP(""LEXI"",$J,"_LEXFI_"," D %XY^%RCR
"RTN","LEXXFI6",15,0)
 S LEX("DD",LEXFI,0)=$G(^TMP("LEXI",$J,LEXFI,0))
"RTN","LEXXFI6",16,0)
 S LEXNM=$O(^TMP("LEXI",$J,LEXFI,0,"NM",""))
"RTN","LEXXFI6",17,0)
 S:$L(LEXNM) LEX("DD",LEXFI,0,"NM",LEXNM)=""
"RTN","LEXXFI6",18,0)
 S LEXFLD=0 F  S LEXFLD=$O(^TMP("LEXI",$J,LEXFI,LEXFLD)) Q:+LEXFLD=0  D
"RTN","LEXXFI6",19,0)
 . S LEXLOC=$G(^TMP("LEXI",$J,LEXFI,LEXFLD,0))
"RTN","LEXXFI6",20,0)
 . Q:+($P($P(LEXLOC,"^",4),";",2))>0
"RTN","LEXXFI6",21,0)
 . S LEX("DD",LEXFI,LEXFLD,0)=$G(^TMP("LEXI",$J,LEXFI,LEXFLD,0))
"RTN","LEXXFI6",22,0)
 S LEXND="" F  S LEXND=$O(^TMP("LEXI",$J,LEXFI,"GL",LEXND)) Q:LEXND=""  D
"RTN","LEXXFI6",23,0)
 . S LEXLOC="" F  S LEXLOC=$O(^TMP("LEXI",$J,LEXFI,"GL",LEXND,LEXLOC)) Q:LEXLOC=""  D
"RTN","LEXXFI6",24,0)
 . . Q:+LEXLOC>0  S LEXFLD=0
"RTN","LEXXFI6",25,0)
 . . F  S LEXFLD=$O(^TMP("LEXI",$J,LEXFI,"GL",LEXND,LEXLOC,LEXFLD)) Q:+LEXFLD=0  D
"RTN","LEXXFI6",26,0)
 . . . S LEXNDD=$G(^TMP("LEXI",$J,LEXFI,LEXFLD,0))
"RTN","LEXXFI6",27,0)
 . . . S LEXSF=+($P(LEXNDD,"^",2)) Q:+LEXSF=0
"RTN","LEXXFI6",28,0)
 . . . S LEX("DD",LEXFI,"GL",LEXND,LEXLOC,LEXFLD)=""
"RTN","LEXXFI6",29,0)
 . . . S:+LEXSF>0 LEX("DD",LEXFI,"GL",LEXND,LEXLOC,LEXFLD)=+LEXSF
"RTN","LEXXFI6",30,0)
 S LEXSF=0 F  S LEXSF=$O(^TMP("LEXI",$J,LEXFI,"SB",LEXSF)) Q:+LEXSF=0  D
"RTN","LEXXFI6",31,0)
 . S LEXFLD=0 F  S LEXFLD=$O(^TMP("LEXI",$J,LEXFI,"SB",LEXSF,LEXFLD)) Q:+LEXFLD=0  D
"RTN","LEXXFI6",32,0)
 . . S LEX("DD",LEXFI,"SB",LEXSF,LEXFLD)=""
"RTN","LEXXFI6",33,0)
 I $L($G(^TMP("LEXI",$J,LEXFI,0,"UP"))) D
"RTN","LEXXFI6",34,0)
 . S LEX("DD",LEXFI,0,"UP")=$G(^TMP("LEXI",$J,LEXFI,0,"UP"))
"RTN","LEXXFI6",35,0)
 K ^TMP("LEXI",$J,LEXFI)
"RTN","LEXXFI6",36,0)
 S %X="^DIC("_LEXFI_",",%Y="^TMP(""LEXI"",$J,"_LEXFI_"," D %XY^%RCR
"RTN","LEXXFI6",37,0)
 I $D(^TMP("LEXI",$J,LEXFI,0)) D
"RTN","LEXXFI6",38,0)
 . S LEX("DIC",LEXFI,0)=$G(^TMP("LEXI",$J,LEXFI,0))
"RTN","LEXXFI6",39,0)
 I $D(^TMP("LEXI",$J,LEXFI,0,"GL")) D
"RTN","LEXXFI6",40,0)
 . S LEX("DIC",LEXFI,0,"GL")=$G(^TMP("LEXI",$J,LEXFI,0,"GL"))
"RTN","LEXXFI6",41,0)
 K ^TMP("LEXI",$J,LEXFI)
"RTN","LEXXFI6",42,0)
 S LEXSF=0 F  S LEXSF=$O(LEX("DD",LEXFI,"SB",LEXSF)) Q:+LEXSF'>0  D DDI2
"RTN","LEXXFI6",43,0)
 I $D(LEX("DD",LEXFI,0,"UP")) D DDI3
"RTN","LEXXFI6",44,0)
 Q
"RTN","LEXXFI6",45,0)
DDI2 ; Sub-Files
"RTN","LEXXFI6",46,0)
 Q:+($G(LEXSF))'>0  Q:$D(LEX("DD",LEXSF))
"RTN","LEXXFI6",47,0)
 N LEXTSF,LEXTFI S LEXTSF=LEXSF,LEXTFI=LEXFI
"RTN","LEXXFI6",48,0)
 N LEXFI S LEXFI=+LEXTSF K ^TMP("LEXI",$J,LEXTFI)
"RTN","LEXXFI6",49,0)
 D DDI(LEXFI,.LEX)
"RTN","LEXXFI6",50,0)
 Q
"RTN","LEXXFI6",51,0)
DDI3 ; Parent Files
"RTN","LEXXFI6",52,0)
 Q:'$D(LEX("DD",LEXFI,0,"UP"))
"RTN","LEXXFI6",53,0)
 N LEXUP,LEXTFI
"RTN","LEXXFI6",54,0)
 S LEXUP=+($G(LEX("DD",LEXFI,0,"UP"))) Q:$D(LEX("DD",LEXUP))
"RTN","LEXXFI6",55,0)
 S LEXTFI=LEXFI N LEXFI S LEXFI=+LEXUP
"RTN","LEXXFI6",56,0)
 D DDI(LEXFI,.LEX)
"RTN","LEXXFI6",57,0)
 Q
"RTN","LEXXFI7")
0^8^B41759245
"RTN","LEXXFI7",1,0)
LEXXFI7 ; ISL/KER - File Info - Prompts and Header   ; 07/28/2004
"RTN","LEXXFI7",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI7",3,0)
 Q
"RTN","LEXXFI7",4,0)
 ;                    
"RTN","LEXXFI7",5,0)
 ; Global Variables
"RTN","LEXXFI7",6,0)
 ;   ^%ZOSF("UCI")       DBIA 10096
"RTN","LEXXFI7",7,0)
 ;   ^%ZOSF("PROD")      DBIA 10096
"RTN","LEXXFI7",8,0)
 ;
"RTN","LEXXFI7",9,0)
 ; External References
"RTN","LEXXFI7",10,0)
 ;   DBIA 10026  ^DIR
"RTN","LEXXFI7",11,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXFI7",12,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","LEXXFI7",13,0)
 ;   DBIA  2056  $$GET1^DIQ (file #200)
"RTN","LEXXFI7",14,0)
 ;   DBIA 10096  ^%ZOSF("UCI")
"RTN","LEXXFI7",15,0)
 ;   DBIA 10096  ^%ZOSF("PROD")
"RTN","LEXXFI7",16,0)
 ;                    
"RTN","LEXXFI7",17,0)
MT(X) ; Method - One or All Files
"RTN","LEXXFI7",18,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,Y
"RTN","LEXXFI7",19,0)
 S DIR(0)="SAO^O:Checksum for ONE file;A:Checksum for ALL files (LEX/ICD/CPT)"
"RTN","LEXXFI7",20,0)
 S DIR("A",1)=" Compute Checksum for:",DIR("A",2)=" "
"RTN","LEXXFI7",21,0)
 S DIR("A",3)="   One Lexicon, ICD or CPT file"
"RTN","LEXXFI7",22,0)
 S DIR("A",4)="   All Lexicon, ICD or CPT files (757*/80*/81*)"
"RTN","LEXXFI7",23,0)
 S DIR("A",5)=" ",DIR("A")=" Select One or All:  (O/A)  "
"RTN","LEXXFI7",24,0)
 S DIR("B")="O",(DIR("?"),DIR("??"))="^D MTH^LEXXFI7"
"RTN","LEXXFI7",25,0)
 W ! D ^DIR S X=$S(Y="O":"ONE",Y="A":"ALL",1:"")
"RTN","LEXXFI7",26,0)
 Q X
"RTN","LEXXFI7",27,0)
MTH ;   Method Help
"RTN","LEXXFI7",28,0)
 W !,"     Do you wish to compute the checksum for a single Lexicon, ICD"
"RTN","LEXXFI7",29,0)
 W !,"     or CPT file or all Lexicon, ICD and CPT files (757*/80*/81*)"
"RTN","LEXXFI7",30,0)
 W:$G(X)["??" !,"     Answer either 'O'ne or 'A'll or '^' to exit"
"RTN","LEXXFI7",31,0)
 Q
"RTN","LEXXFI7",32,0)
 ;                             
"RTN","LEXXFI7",33,0)
CC(X) ; Checksum AND Count
"RTN","LEXXFI7",34,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,Y
"RTN","LEXXFI7",35,0)
 S DIR(0)="YAO",DIR("A")=" Include a Record Count with the Checksum?  (Y/N)  "
"RTN","LEXXFI7",36,0)
 S DIR("B")="N",(DIR("?"),DIR("??"))="^D CCH^LEXXFI7"
"RTN","LEXXFI7",37,0)
 W ! D ^DIR S X=$S(+Y>0:1,1:0)
"RTN","LEXXFI7",38,0)
 Q X
"RTN","LEXXFI7",39,0)
CCH ;   Checksum AND Count Help
"RTN","LEXXFI7",40,0)
 W !,"     Answer 'Yes' to include a count of the total the number of records"
"RTN","LEXXFI7",41,0)
 W !,"     in the file/sub-file along with the checksum"
"RTN","LEXXFI7",42,0)
 Q
"RTN","LEXXFI7",43,0)
 ;                        
"RTN","LEXXFI7",44,0)
FI(X) ; Select Lexicon/ICD File
"RTN","LEXXFI7",45,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,Y
"RTN","LEXXFI7",46,0)
 S DIR(0)="FAO^1:45"
"RTN","LEXXFI7",47,0)
 S DIR("A")=" Select File:  "
"RTN","LEXXFI7",48,0)
 S (DIR("?"),DIR("??"))="^D FIH^LEXXFI7" D ^DIR S X=$$FOT(Y)
"RTN","LEXXFI7",49,0)
 Q X
"RTN","LEXXFI7",50,0)
FIH ;   File Help
"RTN","LEXXFI7",51,0)
 W !,"     Select either a Lexicon, ICD or CPT file:"
"RTN","LEXXFI7",52,0)
 W !!,"                          Lexicon                           ICD       CPT"
"RTN","LEXXFI7",53,0)
 W !,"     ---------------------------------------------------    ----      ----"
"RTN","LEXXFI7",54,0)
 W !,"     757        757.03     757.12     757.31     757.903    80        81"
"RTN","LEXXFI7",55,0)
 W !,"     757.001    757.03     757.13     757.4      757.91     80.1      81.1"
"RTN","LEXXFI7",56,0)
 W !,"     757.01     757.05     757.14     757.41                80.2      81.3"
"RTN","LEXXFI7",57,0)
 W !,"     757.011    757.06     757.2      757.9                 80.3"
"RTN","LEXXFI7",58,0)
 W !,"     757.014    757.1      757.21     757.901"
"RTN","LEXXFI7",59,0)
 W !,"     757.02     757.11     757.3      757.902"
"RTN","LEXXFI7",60,0)
 Q
"RTN","LEXXFI7",61,0)
FOT(X) ;   File Output Transform
"RTN","LEXXFI7",62,0)
 N LEX,LEXX
"RTN","LEXXFI7",63,0)
 S LEXX=$G(X) Q:'$L(X) "^"  D ARY(LEXX,.LEX)
"RTN","LEXXFI7",64,0)
 S:+($G(LEX(0)))=1 LEXX=$$ONE(X,.LEX)
"RTN","LEXXFI7",65,0)
 S:+($G(LEX(0)))>1 LEXX=$$MULT(X,.LEX)
"RTN","LEXXFI7",66,0)
 S X=$S(+LEXX>0:+LEXX,1:"^")
"RTN","LEXXFI7",67,0)
 Q X
"RTN","LEXXFI7",68,0)
ONE(X,LEX) ;   One Entry
"RTN","LEXXFI7",69,0)
 S X=+($G(LEX(1)))
"RTN","LEXXFI7",70,0)
 I $L($P($G(LEX(1)),"^",2)),+X>0 D
"RTN","LEXXFI7",71,0)
 . W "    ",$P($G(LEX(1)),"^",2)," (#",+X,")"
"RTN","LEXXFI7",72,0)
 Q:+X'>0 "^"  Q X
"RTN","LEXXFI7",73,0)
MULT(X,LEX) ;   Multiple Entries
"RTN","LEXXFI7",74,0)
 N LEXE,LEXEX,LEXFI,LEXI,LEXM,LEXMAX,LEXNAM,LEXS
"RTN","LEXXFI7",75,0)
 S LEXMAX=$G(LEX(0)) Q:+LEXMAX'>1  W ! W !," ",LEXMAX," matches found"
"RTN","LEXXFI7",76,0)
 S LEXS=0,LEXEX=0 F LEXI=1:1:LEXMAX Q:((LEXS>0)&(LEXS<LEXI+1))  Q:LEXEX  D  Q:LEXEX
"RTN","LEXXFI7",77,0)
 . S LEXE=$G(LEX(LEXI)),LEXNAM=$P(LEXE,"^",2),LEXFI=+LEXE Q:'$L(LEXNAM)  Q:+LEXFI'>0  S LEXM=LEXI
"RTN","LEXXFI7",78,0)
 . W:LEXI#5=1 ! W !," ",$J(LEXI,4),".  ",LEXNAM," (#",+LEXFI,")"
"RTN","LEXXFI7",79,0)
 . W:LEXI#5=0 ! S:LEXI#5=0 LEXS=$$SEL(LEXM,.LEX) S:LEXS["^" LEXEX=1
"RTN","LEXXFI7",80,0)
 I LEXI#5'=0,+LEXS=0 W ! S LEXS=$$SEL(LEXM,.LEX) S:LEXS["^" LEXEX=1
"RTN","LEXXFI7",81,0)
 S X="^" S:'LEXEX&(+LEXS>0) X=+LEXS S:+X'>0 X="^"
"RTN","LEXXFI7",82,0)
 Q X
"RTN","LEXXFI7",83,0)
SEL(X,LEX) ;     Select Multiple
"RTN","LEXXFI7",84,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,LEXM,Y S LEXM=+($G(X)) Q:LEXM=0 -1
"RTN","LEXXFI7",85,0)
 S:+($O(LEX(+($G(LEXI)))))>0 DIR("A")=" Select 1-"_LEXM_" or '^' to exit:  "
"RTN","LEXXFI7",86,0)
 S:+($O(LEX(+($G(LEXI)))))'>0 DIR("A")=" Select 1-"_LEXM_":  "
"RTN","LEXXFI7",87,0)
 S (DIR("?"),DIR("??"))="Answer must be from 1 to "_LEXM_", or <Return> to continue  "
"RTN","LEXXFI7",88,0)
 S DIR(0)="NAO^1:"_LEXM_":0" D ^DIR S X="" S:$D(DTOUT)!(X[U) X=U
"RTN","LEXXFI7",89,0)
 I $L($P($G(LEX(+Y)),"^",2)),+($G(LEX(+Y)))>0 D
"RTN","LEXXFI7",90,0)
 . W "    ",$P($G(LEX(+Y)),"^",2)," (#",+($G(LEX(+Y))),")"
"RTN","LEXXFI7",91,0)
 . S X=+($G(LEX(+Y)))
"RTN","LEXXFI7",92,0)
 Q X
"RTN","LEXXFI7",93,0)
ARY(X,LEX) ;   Build Array  of Files
"RTN","LEXXFI7",94,0)
 N LEXF,LEXNM,LEXO,LEXX,Y
"RTN","LEXXFI7",95,0)
 S LEXX=$TR($G(X),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ") N X,Y
"RTN","LEXXFI7",96,0)
 Q:'$L(LEXX) ""  I +LEXX=LEXX D  Q
"RTN","LEXXFI7",97,0)
 . N LEXO,LEXN,LEXC S LEXO=LEXX-.00000001
"RTN","LEXXFI7",98,0)
 . F  S LEXO=$O(@("^DIC("_LEXO_")")) Q:+LEXO=0!($E(LEXO,1,$L(LEXX))'=LEXX)  D
"RTN","LEXXFI7",99,0)
 . . N LEXNM S LEXNM=$$FN^LEXXFI8(LEXO) Q:'$L(LEXNM)  S LEX(0)=($O(LEX(" "),-1)+1),LEX(+LEX(0))=+LEXO_"^"_LEXNM
"RTN","LEXXFI7",100,0)
 S LEXO=$E(LEXX,1,($L(LEXX)-1))_$C($A($E(LEXX,$L(LEXX)))-1)_"~"
"RTN","LEXXFI7",101,0)
 F  S LEXO=$O(@("^DIC(""B"","_LEXO_")")) Q:LEXO=""  Q:$E(LEXO,1,$L(LEXX))'[LEXX  D
"RTN","LEXXFI7",102,0)
 . S LEXF=0 F  S LEXF=$O(@("^DIC(""B"","_LEXO_","_LEXF_")")) Q:+LEXF'>0  D
"RTN","LEXXFI7",103,0)
 . . Q:+($$LEX^LEXXFI8(LEXF))'>0&(+($$IC^LEXXFI8(LEXF))'>0)  N LEXNM S LEXNM=$$FN^LEXXFI8(LEXF)
"RTN","LEXXFI7",104,0)
 . . Q:'$L(LEXNM)  S LEX(0)=($O(LEX(" "),-1)+1),LEX(+LEX(0))=+LEXF_"^"_LEXNM
"RTN","LEXXFI7",105,0)
 Q
"RTN","LEXXFI7",106,0)
 ;                          
"RTN","LEXXFI7",107,0)
 ; Miscellaneous
"RTN","LEXXFI7",108,0)
U(X) ;   UCI where Lexicon is installed
"RTN","LEXXFI7",109,0)
 N LEXU,LEXP,LEXT,Y X ^%ZOSF("UCI")
"RTN","LEXXFI7",110,0)
 S LEXU=Y S:Y=^%ZOSF("PROD")!($P(Y,",",1)=^%ZOSF("PROD")) LEXP=" (Production)"
"RTN","LEXXFI7",111,0)
 S:Y'=^%ZOSF("PROD")&($P(Y,",",1)'=^%ZOSF("PROD")) LEXP=" (Test)"
"RTN","LEXXFI7",112,0)
 S:LEXU["DEM" LEXP=" (Demo)" S X="",$P(X,"^",1)=LEXU,$P(X,"^",2)=LEXP
"RTN","LEXXFI7",113,0)
 Q X
"RTN","LEXXFI7",114,0)
A(X) ;   As of date/time
"RTN","LEXXFI7",115,0)
 N LEXX S LEXX=$$NOW^XLFDT,LEXX=$$FMTE^XLFDT(LEXX,"1")
"RTN","LEXXFI7",116,0)
 S:LEXX["@" LEXX=$P(LEXX,"@",1)_"  "_$P(LEXX,"@",2,299)
"RTN","LEXXFI7",117,0)
 S X=LEXX
"RTN","LEXXFI7",118,0)
 Q X
"RTN","LEXXFI7",119,0)
P(X) ;   Person
"RTN","LEXXFI7",120,0)
 N LEXDUZ,LEXPH,LEXNM
"RTN","LEXXFI7",121,0)
 S LEXDUZ=+($G(DUZ)),LEXNM=$$GET1^DIQ(200,+($G(LEXDUZ)),.01) Q:'$L(LEXNM) "UNKNOWN^"
"RTN","LEXXFI7",122,0)
 S LEXDUZ=+($G(DUZ)) S LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.132)
"RTN","LEXXFI7",123,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.133)
"RTN","LEXXFI7",124,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.134)
"RTN","LEXXFI7",125,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.135)
"RTN","LEXXFI7",126,0)
 S LEXDUZ=$$PM(LEXNM)
"RTN","LEXXFI7",127,0)
 S X=LEXDUZ_"^"_LEXPH
"RTN","LEXXFI7",128,0)
 Q X
"RTN","LEXXFI7",129,0)
PM(X) ;     Person, Mixed Case
"RTN","LEXXFI7",130,0)
 N LEXF,LEXL,LEXP S LEXP=$G(X),LEXL=$$MX($P(LEXP,",",1)),LEXF=$P(LEXP,",",2)
"RTN","LEXXFI7",131,0)
 S LEXL(1)=$$MX($P(LEXL,"-",1)),LEXL(2)=$$MX($P(LEXL(1)," ",2,2)),LEXL(1)=$$MX($P(LEXL(1)," ",1))
"RTN","LEXXFI7",132,0)
 S:$L(LEXL(1))&($L(LEXL(2))) LEXL(1)=LEXL(1)_" "_LEXL(2)
"RTN","LEXXFI7",133,0)
 S LEXL(3)=$$MX($P(LEXL,"-",2)),LEXL(4)=$$MX($P(LEXL(3)," ",2,2)),LEXL(3)=$$MX($P(LEXL(3)," ",1))
"RTN","LEXXFI7",134,0)
 S:$L(LEXL(3))&($L(LEXL(4))) LEXL(3)=LEXL(3)_" "_LEXL(4)
"RTN","LEXXFI7",135,0)
 S LEXL=LEXL(1) S:$L(LEXL(1))&($L(LEXL(3))) LEXL=LEXL(1)_"-"_LEXL(3)
"RTN","LEXXFI7",136,0)
 S LEXF=$$MX($P(LEXP,",",1)),LEXF=$P(LEXP,",",2)
"RTN","LEXXFI7",137,0)
 S LEXF(1)=$$MX($P(LEXF,"-",1)),LEXF(2)=$$MX($P(LEXF(1)," ",2,2)),LEXF(1)=$$MX($P(LEXF(1)," ",1))
"RTN","LEXXFI7",138,0)
 S:$L(LEXF(1))&($L(LEXF(2))) LEXF(1)=LEXF(1)_" "_LEXF(2)
"RTN","LEXXFI7",139,0)
 S LEXF(3)=$$MX($P(LEXF,"-",2)),LEXF(4)=$$MX($P(LEXF(3)," ",2,2)),LEXF(3)=$$MX($P(LEXF(3)," ",1))
"RTN","LEXXFI7",140,0)
 S:$L(LEXF(3))&($L(LEXF(4))) LEXF(3)=LEXF(3)_" "_LEXF(4)
"RTN","LEXXFI7",141,0)
 S LEXF=LEXF(1) S:$L(LEXF(1))&($L(LEXF(3))) LEXF=LEXF(1)_"-"_LEXF(3)
"RTN","LEXXFI7",142,0)
 S LEXP=LEXL_", "_LEXF,X=LEXP
"RTN","LEXXFI7",143,0)
 Q X
"RTN","LEXXFI7",144,0)
MX(X) ;     Mix Case
"RTN","LEXXFI7",145,0)
 Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","LEXXFI8")
0^9^B38145534
"RTN","LEXXFI8",1,0)
LEXXFI8 ; ISL/KER - File Info - Miscellaneous      ; 07/28/2004
"RTN","LEXXFI8",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXFI8",3,0)
 Q
"RTN","LEXXFI8",4,0)
 ;                    
"RTN","LEXXFI8",5,0)
 ; Global Variables
"RTN","LEXXFI8",6,0)
 ;   ^TMP("LEXCS",$J     SACC 2.3.2.5.1
"RTN","LEXXFI8",7,0)
 ;   ^TMP("LEXINS",$J    SACC 2.3.2.5.1
"RTN","LEXXFI8",8,0)
 ;                      
"RTN","LEXXFI8",9,0)
 ; External References
"RTN","LEXXFI8",10,0)
 ;   DBIA 10003  ^%DT
"RTN","LEXXFI8",11,0)
 ;   DBIA 10022  %XY^%RCR
"RTN","LEXXFI8",12,0)
 ;   DBIA 10006  ^DIC (file 4.2 and 9.4)
"RTN","LEXXFI8",13,0)
 ;   DBIA 10006  IX^DIC
"RTN","LEXXFI8",14,0)
 ;   DBIA  2052  FILE^DID
"RTN","LEXXFI8",15,0)
 ;   DBIA  2056  $$GET1^DIQ (file 81.2)
"RTN","LEXXFI8",16,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXFI8",17,0)
 ;                          
"RTN","LEXXFI8",18,0)
LEX(X) ; LEX* File
"RTN","LEXXFI8",19,0)
 N LEXN S X=$G(X) Q:+X=0 0  S LEXN=$$GL(X) Q:$E(LEXN,1,4)="^LEX" 1
"RTN","LEXXFI8",20,0)
 Q 0
"RTN","LEXXFI8",21,0)
IC(X) ; IC* File
"RTN","LEXXFI8",22,0)
 S X=$G(X) I "^80^80.1^80.2^80.3^81^81.1^81.3^"[("^"_+X_"^") Q 1
"RTN","LEXXFI8",23,0)
 Q 0
"RTN","LEXXFI8",24,0)
GL(X) ; Global Location
"RTN","LEXXFI8",25,0)
 N DIERR,LEXE,LEXN S X=$G(X) Q:+X=0 ""  D FILE^DID(+X,"N","GLOBAL NAME","LEXN","LEXE")
"RTN","LEXXFI8",26,0)
 S X="" S:'$D(DIERR) X=$G(LEXN("GLOBAL NAME"))
"RTN","LEXXFI8",27,0)
 Q X
"RTN","LEXXFI8",28,0)
FN(X) ; File Name
"RTN","LEXXFI8",29,0)
 N DIERR,LEXE,LEXN S X=$G(X) D FILE^DID(+X,"N","NAME","LEXN","LEXE")
"RTN","LEXXFI8",30,0)
 S X="" S:'$D(DIERR) X=$G(LEXN("NAME"))
"RTN","LEXXFI8",31,0)
 Q X
"RTN","LEXXFI8",32,0)
INS(X) ; Installed
"RTN","LEXXFI8",33,0)
 N %X,%Y,LEXFI,LEXIN,LEXPH,LEXPK,LEXPV,LEXRV,LEXSQ,LEXVR K ^TMP("LEXINS",$J)
"RTN","LEXXFI8",34,0)
 S LEXFI=+($G(X)) Q:+LEXFI'>0 ""
"RTN","LEXXFI8",35,0)
 S LEXVR=$P($$VR(LEXFI),"^",1) Q:'$L(LEXVR) ""  Q:+LEXVR'>0 ""
"RTN","LEXXFI8",36,0)
 S LEXRV=$P($$RV(LEXFI),"^",1) Q:'$L(LEXRV) ""  Q:+LEXRV'>0 ""
"RTN","LEXXFI8",37,0)
 S LEXPK=$$PKG(LEXFI) Q:'$L(LEXPK) ""  Q:+LEXPK'>0 ""
"RTN","LEXXFI8",38,0)
 S LEXPV=$$PH(LEXPK,LEXVR) Q:+LEXPV'>0 ""
"RTN","LEXXFI8",39,0)
 S %X="^DIC(9.4,"_LEXPK_",22,"_LEXPV_",""PAH"",",%Y="^TMP(""LEXINS"","_$J_",""PAH""," D %XY^%RCR
"RTN","LEXXFI8",40,0)
 S LEXPH=$O(^TMP("LEXINS",$J,"PAH","B",LEXRV,0)) I LEXPH'>0 D
"RTN","LEXXFI8",41,0)
 . S LEXPH="",LEXSQ=$O(^TMP("LEXINS",$J,"PAH","B",(LEXRV_" ")))
"RTN","LEXXFI8",42,0)
 . Q:'$L(LEXSQ)  Q:$E(LEXSQ,1,$L(LEXRV))'=LEXRV
"RTN","LEXXFI8",43,0)
 . S LEXPH=$O(^TMP("LEXINS",$J,"PAH","B",LEXSQ,0))
"RTN","LEXXFI8",44,0)
 S LEXIN=$P($P($G(^TMP("LEXINS",$J,"PAH",+LEXPH,0)),"^",2),".",1)
"RTN","LEXXFI8",45,0)
 S X=$S(+LEXIN>0:$$SD(+LEXIN),1:"") S:$L(X)'=10 X=""
"RTN","LEXXFI8",46,0)
 K ^TMP("LEXINS",$J)
"RTN","LEXXFI8",47,0)
 Q X
"RTN","LEXXFI8",48,0)
VR(X) ; File Version
"RTN","LEXXFI8",49,0)
 N DIERR,LEXCDT,LEXE,LEXEX,LEXFI,LEXL,LEXN,LEXRTN,LEXVR,LEXVRD
"RTN","LEXXFI8",50,0)
 S LEXFI=$G(X) N DIERR,LEXN,LEXNM,LEXE,LEXEX,LEXL,LEXRTN
"RTN","LEXXFI8",51,0)
 D FILE^DID(+LEXFI,"N","VERSION","LEXN","LEXE") S LEXVR="" I '$D(DIERR) D
"RTN","LEXXFI8",52,0)
 . S LEXVR=$G(LEXN("VERSION")) S LEXRTN=$S($P(+LEXFI,".",1)=757:"LEXA",$P(+LEXFI,".",1)=80:"ICDCODE",$P(+LEXFI,".",1)=81:"ICPTCOD",1:"")
"RTN","LEXXFI8",53,0)
 . Q:'$L(LEXRTN)  S LEXEX="S LEXL=$T(+2^"_LEXRTN_")" X LEXEX
"RTN","LEXXFI8",54,0)
 . Q:'$L(LEXL)  I $P(LEXL,";",3)=LEXVR,$L($P(LEXL,";",6)) S LEXVRD=$$LTS($P(LEXL,";",6))
"RTN","LEXXFI8",55,0)
 S LEXCDT="" S:LEXFI=81.2 LEXCDT=$$DDT
"RTN","LEXXFI8",56,0)
 S X=$G(LEXVR) S:$L($G(LEXVR))&($L($G(LEXVRD))) X=X_"^"_$G(LEXVRD)
"RTN","LEXXFI8",57,0)
 S:$L($G(LEXVR))&($L($G(LEXVRD)))&($L(LEXCDT)) X=X_"^"_$G(LEXCDT)
"RTN","LEXXFI8",58,0)
 Q X
"RTN","LEXXFI8",59,0)
RV(X) ; File Revision
"RTN","LEXXFI8",60,0)
 N DIERR,LEXE,LEXN S X=$G(X)
"RTN","LEXXFI8",61,0)
 D FILE^DID(+X,"N","PACKAGE REVISION DATA","LEXN","LEXE")
"RTN","LEXXFI8",62,0)
 S X="" S:'$D(DIERR) X=$G(LEXN("PACKAGE REVISION DATA"))
"RTN","LEXXFI8",63,0)
 S:+$P(X,"^",2) $P(X,"^",2)=$$SD($P(X,"^",2))
"RTN","LEXXFI8",64,0)
 Q X
"RTN","LEXXFI8",65,0)
DDT(X) ; CPT Distribution Date
"RTN","LEXXFI8",66,0)
 N LEXDDT S LEXDDT=$$GET1^DIQ(81.2,"1,",.02,"I") Q:'$L(LEXDDT) ""  Q:+LEXDDT'>0 ""  S X=$$SD(LEXDDT)
"RTN","LEXXFI8",67,0)
 Q X
"RTN","LEXXFI8",68,0)
ADR(LEX) ; Mailing Address
"RTN","LEXXFI8",69,0)
 N DIC,DTOUT,DUOUT,X,Y S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXXFI8",70,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="ISC-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXXFI8",71,0)
 Q "ISC-SLC.VA.GOV"
"RTN","LEXXFI8",72,0)
MX(X) ; Mix Case
"RTN","LEXXFI8",73,0)
 Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","LEXXFI8",74,0)
LTS(X) ; Long to Short Date
"RTN","LEXXFI8",75,0)
 N %DT,Y S X=$G(X) Q:'$L(X) ""  S %DT="T" D ^%DT S X=$$SD(Y)
"RTN","LEXXFI8",76,0)
 Q X
"RTN","LEXXFI8",77,0)
SD(X) ; Short Date
"RTN","LEXXFI8",78,0)
 S X=$G(X),X=$TR($$FMTE^XLFDT($P(X,".",1),"5DZ"),"@"," ")
"RTN","LEXXFI8",79,0)
 Q X
"RTN","LEXXFI8",80,0)
PKG(X) ; Package
"RTN","LEXXFI8",81,0)
 N D,DIC,DTOUT,DUOUT,LEXFI,LEXN S LEXFI=+($G(X)) Q:+LEXFI'>0 ""
"RTN","LEXXFI8",82,0)
 S LEXN=$S($P(LEXFI,".",1)=757:"LEXICON UTILITY",$P(LEXFI,".",1)=80:"DRG GROUPER",$P(LEXFI,".",1)=81:"CPT/HCPCS CODES",1:"")
"RTN","LEXXFI8",83,0)
 Q:'$L(LEXN)  N X,Y S DIC="^DIC(9.4,",D="B",DIC(0)="X",X=LEXN D IX^DIC
"RTN","LEXXFI8",84,0)
 S X=+($G(Y))
"RTN","LEXXFI8",85,0)
 Q X
"RTN","LEXXFI8",86,0)
PH(X,Y) ; Patch History
"RTN","LEXXFI8",87,0)
 N DA,DIC,DTOUT,DUOUT,LEXPK,LEXVR
"RTN","LEXXFI8",88,0)
 S (DA(1),LEXPK)=+($G(X)) Q:+LEXPK'>0 ""  S LEXVR=$G(Y) Q:'$L(LEXVR) ""  Q:+LEXVR'>0 ""
"RTN","LEXXFI8",89,0)
 S DIC="^DIC(9.4,"_DA(1)_",22,",X=LEXVR,DIC(0)="X"
"RTN","LEXXFI8",90,0)
 D ^DIC S X=+($G(Y)) S:+Y'>0 X=""
"RTN","LEXXFI8",91,0)
 Q X
"RTN","LEXXFI8",92,0)
TIC(X) ; Time
"RTN","LEXXFI8",93,0)
 Q $$NOW^XLFDT
"RTN","LEXXFI8",94,0)
ELAP(X,Y) ; Elapsed Time (start,end)
"RTN","LEXXFI8",95,0)
 Q $TR($$FMDIFF^XLFDT(+($G(Y)),+($G(X)),3)," ","0")
"RTN","LEXXFI8",96,0)
LDR(X) ; Leader
"RTN","LEXXFI8",97,0)
 N LEXFI,LEXMOD S LEXFI=+($G(X)) Q:LEXFI'>0 0  S LEXMOD=$$MOD(LEXFI),X=$S(+LEXMOD>0:" * ",1:"   ")
"RTN","LEXXFI8",98,0)
 Q X
"RTN","LEXXFI8",99,0)
MOD(X) ; Modifier File
"RTN","LEXXFI8",100,0)
 N LEXFI,LEXSRC,LEXE,LEXTAG,LEXRTN,LEXCTR,LEXLDR,LEXMOD
"RTN","LEXXFI8",101,0)
 S LEXSRC=+($G(X)) Q:LEXSRC'>0 0
"RTN","LEXXFI8",102,0)
 S LEXFI="",LEXE=0,LEXTAG="FILES",LEXRTN="LEXXFI",LEXCTR=0,LEXMOD=0
"RTN","LEXXFI8",103,0)
 F  D  Q:LEXFI=""  Q:+LEXE>0
"RTN","LEXXFI8",104,0)
 . S LEXCTR=LEXCTR+1
"RTN","LEXXFI8",105,0)
 . S LEXEX="S LEXLINE=$T("_LEXTAG_"+"_LEXCTR_"^"_LEXRTN_")" X LEXEX
"RTN","LEXXFI8",106,0)
 . S LEXFI=$P(LEXLINE,";;",2,3)
"RTN","LEXXFI8",107,0)
 . S LEXLDR=$P(LEXFI,";;",1),LEXFI=$P(LEXFI,";;",2)
"RTN","LEXXFI8",108,0)
 . Q:'$L(LEXFI)  Q:+LEXFI'=LEXSRC
"RTN","LEXXFI8",109,0)
 . S LEXMOD=$S(+LEXLDR>0:1,1:0) S:LEXMOD>0 LEXE=1
"RTN","LEXXFI8",110,0)
 S X=LEXMOD
"RTN","LEXXFI8",111,0)
 Q X
"RTN","LEXXFI8",112,0)
MF(X) ; Modified Files
"RTN","LEXXFI8",113,0)
 N LEXMOD,LEXT S LEXMOD=+($G(X)) Q:LEXMOD'>0
"RTN","LEXXFI8",114,0)
 S LEXT=" * "_$S(LEXMOD>1:"These ",1:"This ")_"file"
"RTN","LEXXFI8",115,0)
 S LEXT=LEXT_$S(LEXMOD>1:"s ",1:" ")
"RTN","LEXXFI8",116,0)
 S LEXT=LEXT_"contain"_$S(LEXMOD>1:" ",1:"s ")
"RTN","LEXXFI8",117,0)
 S LEXT=LEXT_"fields that may be modified at the site."
"RTN","LEXXFI8",118,0)
 D BL^LEXXFI8,TL^LEXXFI8(LEXT)
"RTN","LEXXFI8",119,0)
 S LEXT="   The Checksum"_$S(LEXMOD>1:"s ",1:" ")
"RTN","LEXXFI8",120,0)
 S LEXT=LEXT_"for "_$S(LEXMOD>1:"these ",1:"this ")
"RTN","LEXXFI8",121,0)
 S LEXT=LEXT_"file"_$S(LEXMOD>1:"s ",1:" ")
"RTN","LEXXFI8",122,0)
 S LEXT=LEXT_"may vary from site to site."
"RTN","LEXXFI8",123,0)
 D TL^LEXXFI8(LEXT)
"RTN","LEXXFI8",124,0)
 Q
"RTN","LEXXFI8",125,0)
BL ; Blank Line
"RTN","LEXXFI8",126,0)
 N LEXI,LEXT S LEXI=+($O(^TMP("LEXCS",$J," "),-1)),LEXT=$G(^TMP("LEXCS",$J,+LEXI))
"RTN","LEXXFI8",127,0)
 Q:(LEXI+1)'>1  D:LEXT'="   " TL("   ")
"RTN","LEXXFI8",128,0)
 Q
"RTN","LEXXFI8",129,0)
TL(X) ; Text Line
"RTN","LEXXFI8",130,0)
 S X=$G(X) W:'$D(ZTQUEUED) !,X
"RTN","LEXXFI8",131,0)
 N LEXI S LEXI=+($O(^TMP("LEXCS",$J," "),-1))+1,^TMP("LEXCS",$J,LEXI)=X,^TMP("LEXCS",$J,0)=LEXI
"RTN","LEXXFI8",132,0)
 Q
"RTN","LEXXFI8",133,0)
TT(X,Y) ; Title Line
"RTN","LEXXFI8",134,0)
 N LEXFI,LEXTT,LEXT,LEXN,LEXNM S LEXFI=$G(X),LEXTT=$G(Y) S:+($$IF(LEXFI))'>0 LEXFI=""
"RTN","LEXXFI8",135,0)
 S:+LEXFI>0 LEXNM=$$FN(LEXFI)_" File (#"_+LEXFI_")" S:+LEXFI'>0 LEXNM="Lexicon/ICD/CPT File"
"RTN","LEXXFI8",136,0)
 S LEXT=" "_LEXNM_" "_$G(LEXTT) S:+($G(LEXMUL))>0&($E(LEXT,$L(LEXT))'="s") LEXT=LEXT_"s"
"RTN","LEXXFI8",137,0)
 D BL,TL(LEXT) S $P(LEXN,"=",$L(LEXT))="",LEXN=" "_LEXN D TL(LEXN)
"RTN","LEXXFI8",138,0)
 Q
"RTN","LEXXFI8",139,0)
IF(X) ; Is File on the List of Files
"RTN","LEXXFI8",140,0)
 N LEXTAG,LEXRTN,LEXCTR,LEXCTL,LEXFI,LEXLINE,LEXOK S LEXCTL=$G(X) Q:'$L(LEXCTL) 0  Q:+LEXCTL'>0 0
"RTN","LEXXFI8",141,0)
 S LEXFI="",LEXTAG="FILES",LEXRTN="LEXXFI",(LEXCTR,LEXOK)=0
"RTN","LEXXFI8",142,0)
 F  D  Q:LEXFI=""  Q:+LEXOK>0
"RTN","LEXXFI8",143,0)
 . S LEXCTR=LEXCTR+1
"RTN","LEXXFI8",144,0)
 . S LEXEX="S LEXLINE=$T("_LEXTAG_"+"_LEXCTR_"^"_LEXRTN_")" X LEXEX
"RTN","LEXXFI8",145,0)
 . S LEXFI=$P(LEXLINE,";;",2,3),LEXFI=$P(LEXFI,";;",2)
"RTN","LEXXFI8",146,0)
 . Q:'$L(LEXFI)  S:+LEXFI=+LEXCTL LEXOK=1
"RTN","LEXXFI8",147,0)
 S X=LEXOK
"RTN","LEXXFI8",148,0)
 Q X
"RTN","LEXXII")
0^1^B28358070
"RTN","LEXXII",1,0)
LEXXII ; ISL/KER - Lexicon Status (Install Info) ; 10/27/2003
"RTN","LEXXII",2,0)
 ;;2.0;LEXICON UTILITY;**32**;Sep 23, 1996
"RTN","LEXXII",3,0)
 ;            
"RTN","LEXXII",4,0)
 ; Global Variables
"RTN","LEXXII",5,0)
 ;   DBIA 10096  ^%ZOSF("PROD"
"RTN","LEXXII",6,0)
 ;   DBIA 10096  ^%ZOSF("UCI"
"RTN","LEXXII",7,0)
 ;   DBIA 10060  ^VA(200 
"RTN","LEXXII",8,0)
 ;                           
"RTN","LEXXII",9,0)
 ; External References
"RTN","LEXXII",10,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXII",11,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","LEXXII",12,0)
 ;   DBIA  2056  $$GET1^DIQ (file #200)
"RTN","LEXXII",13,0)
 ;                        
"RTN","LEXXII",14,0)
EN ; Main Entry
"RTN","LEXXII",15,0)
 N LEXSUB S LEXSUB=$G(LEXID) S:LEXSUB="" LEXSUB="LEXXII" K ^TMP(LEXSUB,$J)
"RTN","LEXXII",16,0)
 D II D:$D(TEST) ST
"RTN","LEXXII",17,0)
 Q
"RTN","LEXXII",18,0)
 ;                               
"RTN","LEXXII",19,0)
II ; Install Information
"RTN","LEXXII",20,0)
 N LEXT,LEXA,LEXB,LEXD,LEXE,LEXL,LEXU,LEXN,LEXP,LEXDA H 2
"RTN","LEXXII",21,0)
 S LEXT="Lexicon/ICD/CPT Installation" D TL(LEXT)
"RTN","LEXXII",22,0)
 S LEXT="============================" D TL(LEXT),BL
"RTN","LEXXII",23,0)
 S LEXD=$$ASOF,LEXA=$$UCI,LEXU=$$USR,LEXN=$P(LEXU,"^",1)
"RTN","LEXXII",24,0)
 S LEXP=$P(LEXU,"^",2),LEXN=$$PM^LEXXFI7(LEXN)
"RTN","LEXXII",25,0)
 S:$L(LEXD) LEXT="  As of:       "_LEXD
"RTN","LEXXII",26,0)
 D:$L(LEXD) TL(LEXT)
"RTN","LEXXII",27,0)
 S LEXT="" S:$L(LEXA) LEXT="  In Account:  "_$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEXXII",28,0)
 S:$L(LEXT)&($L($P(LEXA,"^",2))) LEXT=LEXT_"  "_$P(LEXA,"^",2)
"RTN","LEXXII",29,0)
 D:$L(LEXA) TL(LEXT)
"RTN","LEXXII",30,0)
 S LEXT="" S:$L(LEXU) LEXT="  Maint By:    "
"RTN","LEXXII",31,0)
 S:$L(LEXN) LEXT=LEXT_LEXN
"RTN","LEXXII",32,0)
 S:$L(LEXP)&($L(LEXN)) LEXT=LEXT_"   "_LEXP
"RTN","LEXXII",33,0)
 D:$L(LEXT)&(LEXT'["UNKNOWN") TL(LEXT)
"RTN","LEXXII",34,0)
 S LEXT="" S:$L($G(LEXBUILD)) LEXT="  Build:       "_$G(LEXBUILD)
"RTN","LEXXII",35,0)
 D:$L(LEXT) TL(LEXT)
"RTN","LEXXII",36,0)
 S LEXT="" S:$L($G(LEXIGHF)) LEXT="  Host File:   "_$G(LEXIGHF)
"RTN","LEXXII",37,0)
 S:$L(LEXT)&($L($G(LEXCRE)))&($P($G(LEXCRE),".",1)?7N) LEXT=LEXT_" (Created "_$$ED($G(LEXCRE))_")"
"RTN","LEXXII",38,0)
 S:'$L(LEXT)&($L($G(LEXCRE)))&($P($G(LEXCRE),".",1)?7N) LEXT="  Created:     "_$$ED($G(LEXCRE))
"RTN","LEXXII",39,0)
 D:$L(LEXT) TL(LEXT)
"RTN","LEXXII",40,0)
 S LEXB=$$SS($G(LEXBUILD)),LEXE=$P(LEXB,"^",2),LEXL=$P(LEXB,"^",3),LEXB=$P(LEXB,"^",1)
"RTN","LEXXII",41,0)
 I $P(LEXB,".",1)?7N!($P(LEXB,".",2)?7N)!($P(LEXB,".",3)[":") D
"RTN","LEXXII",42,0)
 . D BL
"RTN","LEXXII",43,0)
 . I $P(LEXB,".",1)?7N D
"RTN","LEXXII",44,0)
 . . S LEXT="" S LEXT="  Started:     "_$$ED($G(LEXB)) D TL(LEXT)
"RTN","LEXXII",45,0)
 . I $P(LEXE,".",1)?7N D
"RTN","LEXXII",46,0)
 . . S LEXT="" S LEXT="  Finished:    "_$$ED($G(LEXE)) D TL(LEXT)
"RTN","LEXXII",47,0)
 . I $L(LEXL) D
"RTN","LEXXII",48,0)
 . . S LEXT="" S LEXT="  Elapsed:     "_$$ED($G(LEXL)) D TL(LEXT)
"RTN","LEXXII",49,0)
 D BL
"RTN","LEXXII",50,0)
 Q
"RTN","LEXXII",51,0)
 ;                             
"RTN","LEXXII",52,0)
 ; Miscellaneous
"RTN","LEXXII",53,0)
UCI(LEX) ;   UCI where Lexicon is installed
"RTN","LEXXII",54,0)
 N LEXU,LEXP,LEXT X ^%ZOSF("UCI") S LEXU=Y S:Y=^%ZOSF("PROD") LEXP=" (PROD)"
"RTN","LEXXII",55,0)
 S:Y'=^%ZOSF("PROD") LEXP=" (TEST)" S:LEXU["VHA,ROU" LEXP=" (PROD)"
"RTN","LEXXII",56,0)
 S:LEXU["DEM" LEXP=" (DEMO)" S LEX="",$P(LEX,"^",1)=LEXU,$P(LEX,"^",2)=LEXP
"RTN","LEXXII",57,0)
 Q LEX
"RTN","LEXXII",58,0)
USR(LEX) ;   User/Person
"RTN","LEXXII",59,0)
 N LEXDUZ,LEXPH,LEXNM
"RTN","LEXXII",60,0)
 S LEX=+($G(DUZ)),LEXNM=$$GET1^DIQ(200,+LEX,.01) Q:'$L(LEXNM) "UNKNOWN^"
"RTN","LEXXII",61,0)
 S LEXDUZ=LEX S LEXPH=$$GET1^DIQ(200,+LEXDUZ,.132) S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXDUZ,.131)
"RTN","LEXXII",62,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXDUZ,.133) S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXDUZ,.134)
"RTN","LEXXII",63,0)
 S LEXDUZ=$$GET1^DIQ(200,+LEX,.01),LEX=LEXDUZ_"^"_LEXPH Q LEX
"RTN","LEXXII",64,0)
SS(LEX) ;   Start/Stop Times
"RTN","LEXXII",65,0)
 N LEXDA,LEXOUT,LEXIENS,LEXB,LEXBUILD,LEXB,LEXE,LEXL
"RTN","LEXXII",66,0)
 S LEXBUILD=$G(LEX),LEXD=0 S:$L(LEXBUILD) LEXD=$$DDA(LEXBUILD)
"RTN","LEXXII",67,0)
 S LEXDA=+($G(XPDA))
"RTN","LEXXII",68,0)
 I +LEXDA>0 D
"RTN","LEXXII",69,0)
 . S LEXIENS=LEXDA_","
"RTN","LEXXII",70,0)
 . D GETS^DIQ(9.7,LEXIENS,"11;17","I","LEXOUT")
"RTN","LEXXII",71,0)
 . S LEXL=0,LEXB=$G(LEXOUT(9.7,LEXIENS,11,"I"))
"RTN","LEXXII",72,0)
 . S LEXE=$G(LEXOUT(9.7,LEXIENS,17,"I"))
"RTN","LEXXII",73,0)
 . S:+LEXE'>0 LEXE=$$NOW^XLFDT
"RTN","LEXXII",74,0)
 . S:+LEXB>0&(+LEXE>0) LEXL=$$EP(LEXB,LEXE)
"RTN","LEXXII",75,0)
 . S LEX=LEXB_"^"_LEXE S:$L(LEXL) $P(LEX,"^",3)=LEXL
"RTN","LEXXII",76,0)
 I +LEXDA=0 D
"RTN","LEXXII",77,0)
 . S LEX="" S LEXDA=+($G(LEXD)) Q:+LEXDA'>0
"RTN","LEXXII",78,0)
 . S LEXL="",LEXB=$P($G(LEXD),"^",2) Q:$P(LEXB,".",1)'?7N
"RTN","LEXXII",79,0)
 . S LEXE=$P($G(LEXD),"^",3) Q:$P(LEXE,".",1)'?7N
"RTN","LEXXII",80,0)
 . S:+LEXB>0&(+LEXE>0) LEXL=$$EP(LEXB,LEXE)
"RTN","LEXXII",81,0)
 . S LEX=LEXB_"^"_LEXE S:$L(LEXL) $P(LEX,"^",3)=LEXL
"RTN","LEXXII",82,0)
 Q LEX
"RTN","LEXXII",83,0)
DDA(LEX) ;   Get Default DA of Build LEX
"RTN","LEXXII",84,0)
 N LEXB,LEXE,LEXOUT,LEXMSG,LEXI S LEXB=$G(LEX) Q:'$L(LEXB) ""
"RTN","LEXXII",85,0)
 D FIND^DIC(9.7,,"11I;17I","BP",LEXB,,"B",,,"LEXOUT","LEXMSG")
"RTN","LEXXII",86,0)
 S LEXI=+($O(LEXOUT("DILIST"," "),-1))
"RTN","LEXXII",87,0)
 S LEXB=$G(LEXOUT("DILIST",+LEXI,0))
"RTN","LEXXII",88,0)
 S LEXI=$P(LEXB,"^",1),LEXE=$P(LEXB,"^",4),LEXB=$P(LEXB,"^",3)
"RTN","LEXXII",89,0)
 Q:+($G(LEXI))'>0 ""  Q:+($G(LEXB))'>0 ""  S:+LEXE'>0 LEXE=$$NOW^XLFDT
"RTN","LEXXII",90,0)
 S LEX=LEXI_"^"_LEXB_"^"_LEXE
"RTN","LEXXII",91,0)
 Q LEX
"RTN","LEXXII",92,0)
 ;   Date
"RTN","LEXXII",93,0)
ASOF(LEX) ;     As of date/time
"RTN","LEXXII",94,0)
 S X=$$ED($$NOW^XLFDT) Q X
"RTN","LEXXII",95,0)
ED(LEX) ;     External Date MM/DD/YYYY TT:TT
"RTN","LEXXII",96,0)
 S LEX=$$FMTE^XLFDT($G(LEX),"1Z")
"RTN","LEXXII",97,0)
 S:LEX["@" LEX=$P(LEX,"@",1)_"  "_$P(LEX,"@",2,299) Q LEX
"RTN","LEXXII",98,0)
 Q LEX
"RTN","LEXXII",99,0)
 ;   Time
"RTN","LEXXII",100,0)
EP(X,Y) ;     Elapsed Time (Begin, End)
"RTN","LEXXII",101,0)
 N LEXTIM,LEXBEG,LEXEND
"RTN","LEXXII",102,0)
 S LEXBEG=$G(X),LEXEND=$G(Y) Q:+LEXBEG'>0 ""  Q:+LEXEND'>0 ""
"RTN","LEXXII",103,0)
 S LEXTIM=$$FMDIFF^XLFDT(LEXEND,LEXBEG,2) Q:+LEXTIM'>0 "00:00:00"
"RTN","LEXXII",104,0)
 S LEXTIM=$$TIM(LEXTIM)
"RTN","LEXXII",105,0)
 Q LEXTIM
"RTN","LEXXII",106,0)
TIM(X) ;     Format Time Elapsed
"RTN","LEXXII",107,0)
 N LEXD,LEXH,LEXM,LEXS,LEXT,LEXV S X=+($G(X)) Q:X'>0 "00:00:00"
"RTN","LEXXII",108,0)
 S LEXD=X\86400 S LEXV=LEXD*86400 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXII",109,0)
 S LEXH=X\3600 S LEXV=LEXH*3600 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXII",110,0)
 S:$L(LEXH)<2 LEXH="0"_LEXH S:$L(LEXH)<2 LEXH="0"_LEXH
"RTN","LEXXII",111,0)
 S LEXM=X\60 S LEXV=LEXM*60 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXII",112,0)
 S:$L(LEXM)<2 LEXM="0"_LEXM S:$L(LEXM)<2 LEXM="0"_LEXM
"RTN","LEXXII",113,0)
 S LEXS=X S:$L(LEXS)<2 LEXS="0"_LEXS S:$L(LEXS)<2 LEXS="0"_LEXS
"RTN","LEXXII",114,0)
 S LEXT="" S:+LEXD>0 LEXT=+LEXD_" day"_$S(+LEXD>1:"s",1:"")_" "
"RTN","LEXXII",115,0)
 S LEXT=LEXT_LEXH_":"_LEXM_":"_LEXS,X=LEXT
"RTN","LEXXII",116,0)
 Q X
"RTN","LEXXII",117,0)
 ;   Save Text
"RTN","LEXXII",118,0)
BL ;     Blank Line
"RTN","LEXXII",119,0)
 D TL("") Q
"RTN","LEXXII",120,0)
TL(LEXX) ;     Text Line
"RTN","LEXXII",121,0)
 S LEXSUB=$G(LEXSUB) S:'$L(LEXSUB) LEXSUB="LEXXII"
"RTN","LEXXII",122,0)
 I '$D(^TMP(LEXSUB,$J,1)) S ^TMP(LEXSUB,$J,1)=" ",^TMP(LEXSUB,$J,0)=1
"RTN","LEXXII",123,0)
 N LEXNX S LEXNX=$O(^TMP(LEXSUB,$J," "),-1),LEXNX=LEXNX+1
"RTN","LEXXII",124,0)
 S ^TMP(LEXSUB,$J,LEXNX)=" "_$G(LEXX),^TMP(LEXSUB,$J,0)=LEXNX
"RTN","LEXXII",125,0)
 Q
"RTN","LEXXII",126,0)
ST ;   Show Temp Array
"RTN","LEXXII",127,0)
 S LEXSUB=$G(LEXSUB) S:'$L(LEXSUB) LEXSUB="LEXXII"
"RTN","LEXXII",128,0)
 N LEXN,LEXC S LEXN="^TMP("""_LEXSUB_""","_$J_")",LEXC="^TMP("""_LEXSUB_""","_$J_","
"RTN","LEXXII",129,0)
 F  S LEXN=$Q(@LEXN) Q:LEXN=""!(LEXN'[LEXC)  D
"RTN","LEXXII",130,0)
 . Q:LEXN[",0)"  W ! W:$D(FULL) LEXN,"=" W @LEXN
"RTN","LEXXII",131,0)
 Q
"VER")
8.0^22.0
**INSTALL NAME**
ICD*18.0*15
"BLD",5393,0)
ICD*18.0*15^DRG GROUPER^0^3050420^y
"BLD",5393,1,0)
^^2^2^3050124^
"BLD",5393,1,1,0)
Please see the National Patch Module for details of the enhancements 
"BLD",5393,1,2,0)
included in this patch.
"BLD",5393,4,0)
^9.64PA^^
"BLD",5393,"KRN",0)
^9.67PA^8989.52^19
"BLD",5393,"KRN",.4,0)
.4
"BLD",5393,"KRN",.401,0)
.401
"BLD",5393,"KRN",.402,0)
.402
"BLD",5393,"KRN",.403,0)
.403
"BLD",5393,"KRN",.5,0)
.5
"BLD",5393,"KRN",.84,0)
.84
"BLD",5393,"KRN",3.6,0)
3.6
"BLD",5393,"KRN",3.8,0)
3.8
"BLD",5393,"KRN",9.2,0)
9.2
"BLD",5393,"KRN",9.8,0)
9.8
"BLD",5393,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5393,"KRN",9.8,"NM",1,0)
ICDID^^0^B14387573
"BLD",5393,"KRN",9.8,"NM",2,0)
ICDAPIU^^0^B36736755
"BLD",5393,"KRN",9.8,"NM","B","ICDAPIU",2)

"BLD",5393,"KRN",9.8,"NM","B","ICDID",1)

"BLD",5393,"KRN",19,0)
19
"BLD",5393,"KRN",19.1,0)
19.1
"BLD",5393,"KRN",101,0)
101
"BLD",5393,"KRN",409.61,0)
409.61
"BLD",5393,"KRN",771,0)
771
"BLD",5393,"KRN",870,0)
870
"BLD",5393,"KRN",8989.51,0)
8989.51
"BLD",5393,"KRN",8989.52,0)
8989.52
"BLD",5393,"KRN",8994,0)
8994
"BLD",5393,"KRN","B",.4,.4)

"BLD",5393,"KRN","B",.401,.401)

"BLD",5393,"KRN","B",.402,.402)

"BLD",5393,"KRN","B",.403,.403)

"BLD",5393,"KRN","B",.5,.5)

"BLD",5393,"KRN","B",.84,.84)

"BLD",5393,"KRN","B",3.6,3.6)

"BLD",5393,"KRN","B",3.8,3.8)

"BLD",5393,"KRN","B",9.2,9.2)

"BLD",5393,"KRN","B",9.8,9.8)

"BLD",5393,"KRN","B",19,19)

"BLD",5393,"KRN","B",19.1,19.1)

"BLD",5393,"KRN","B",101,101)

"BLD",5393,"KRN","B",409.61,409.61)

"BLD",5393,"KRN","B",771,771)

"BLD",5393,"KRN","B",870,870)

"BLD",5393,"KRN","B",8989.51,8989.51)

"BLD",5393,"KRN","B",8989.52,8989.52)

"BLD",5393,"KRN","B",8994,8994)

"BLD",5393,"QUES",0)
^9.62^^
"BLD",5393,"REQB",0)
^9.611^1^1
"BLD",5393,"REQB",1,0)
ICD*18.0*12^2
"BLD",5393,"REQB","B","ICD*18.0*12",1)

"MBREQ")
0
"PKG",283,-1)
1^1
"PKG",283,0)
DRG GROUPER^ICD^DRG GROUPER^^^3010710
"PKG",283,20,0)
^9.402P^^
"PKG",283,22,0)
^9.49I^1^1
"PKG",283,22,1,0)
18.0^3001024^3001114^1119
"PKG",283,22,1,"PAH",1,0)
15^3050420^1118
"PKG",283,22,1,"PAH",1,1,0)
^^2^2^3050420
"PKG",283,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements 
"PKG",283,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","ICDAPIU")
0^2^B36736755
"RTN","ICDAPIU",1,0)
ICDAPIU ;DLS/DEK/KER - ICD UTILITIES FOR APIS ; 04/18/2004
"RTN","ICDAPIU",2,0)
 ;;18.0;DRG Grouper;**6,11,12,15**;Oct 20, 2000
"RTN","ICDAPIU",3,0)
 ;
"RTN","ICDAPIU",4,0)
 ; External References
"RTN","ICDAPIU",5,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","ICDAPIU",6,0)
 ;
"RTN","ICDAPIU",7,0)
DTBR(CDT,CS) ; Date Business Rules
"RTN","ICDAPIU",8,0)
 ; Input:
"RTN","ICDAPIU",9,0)
 ;   CDT - Code Date to check (FileMan format, default=Today)
"RTN","ICDAPIU",10,0)
 ;   CS - Code System (0:ICD, 1:CPT/HCPCS, 2:DRG, Default=0)
"RTN","ICDAPIU",11,0)
 ;
"RTN","ICDAPIU",12,0)
 ; Output:
"RTN","ICDAPIU",13,0)
 ;   If CDT < 2781001 and CS=0, use 2781001
"RTN","ICDAPIU",14,0)
 ;   If CDT < 2890101 and CS=1, use 2890101
"RTN","ICDAPIU",15,0)
 ;   If CDT < 2821001 and CS=2, use 2821001
"RTN","ICDAPIU",16,0)
 ;   If CDT is year only, use first of the year
"RTN","ICDAPIU",17,0)
 ;   If CDT is year and month only, use first of the month
"RTN","ICDAPIU",18,0)
 ;
"RTN","ICDAPIU",19,0)
 Q:'$G(CDT) $$DT^XLFDT ;nothing passed - use today
"RTN","ICDAPIU",20,0)
 Q:$L($P(CDT,"."))'=7 $$DT^XLFDT ;bad date format - use today
"RTN","ICDAPIU",21,0)
 N BRDAT ;Business rule date
"RTN","ICDAPIU",22,0)
 S CS=+$G(CS) S:CS>2!(CS<0) CS=0
"RTN","ICDAPIU",23,0)
 S BRDAT=+$P("2781001^2890101^2821001","^",CS+1)
"RTN","ICDAPIU",24,0)
 I CDT#10000=0 S CDT=CDT+101
"RTN","ICDAPIU",25,0)
 S:CDT#100=0 CDT=CDT+1
"RTN","ICDAPIU",26,0)
 Q $S(CDT<BRDAT:BRDAT,1:CDT)
"RTN","ICDAPIU",27,0)
 ;
"RTN","ICDAPIU",28,0)
MSG(CDT,CS) ; inform of code text inaccuracy
"RTN","ICDAPIU",29,0)
 ; Input:
"RTN","ICDAPIU",30,0)
 ;   CDT - Code Date to check (FileMan format, Default = today)
"RTN","ICDAPIU",31,0)
 ;   CS - Code System (0:ICD, 1:CPT/HCPCS, 2:DRG, 3:LEX, Default=0)
"RTN","ICDAPIU",32,0)
 ; Output: User Alert
"RTN","ICDAPIU",33,0)
 ;
"RTN","ICDAPIU",34,0)
 S CS=+$G(CS) S:CS>3!(CS<0) CS=0
"RTN","ICDAPIU",35,0)
 S CDT=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR(CDT,CS))
"RTN","ICDAPIU",36,0)
 N MSGTXT,MSGDAT S MSGDAT=3021001,MSGTXT="CODE TEXT MAY BE INACCURATE"
"RTN","ICDAPIU",37,0)
 I CS<3 Q $S(CDT<MSGDAT:MSGTXT,1:"")
"RTN","ICDAPIU",38,0)
 I CS=3,CDT'<3031001 Q ""
"RTN","ICDAPIU",39,0)
 Q MSGTXT
"RTN","ICDAPIU",40,0)
 ;
"RTN","ICDAPIU",41,0)
STATCHK(CODE,CDT) ; Check Status of ICD Code
"RTN","ICDAPIU",42,0)
 ; Input:
"RTN","ICDAPIU",43,0)
 ;    CODE - ICD Code  REQUIRED
"RTN","ICDAPIU",44,0)
 ;    CDT - Date to screen against (FileMan format, default = today)
"RTN","ICDAPIU",45,0)
 ; Output:
"RTN","ICDAPIU",46,0)
 ;    2-Piece String containing the code's status
"RTN","ICDAPIU",47,0)
 ;    and the IEN if the code exists, else -1.
"RTN","ICDAPIU",48,0)
 ;    The following are possible outputs:
"RTN","ICDAPIU",49,0)
 ;         1^IEN    Active Code
"RTN","ICDAPIU",50,0)
 ;         0^IEN    Inactive Code
"RTN","ICDAPIU",51,0)
 ;         0^-1     Code not Found
"RTN","ICDAPIU",52,0)
 ;
"RTN","ICDAPIU",53,0)
 ; This API requires the ACT Cross-Reference
"RTN","ICDAPIU",54,0)
 ;     ^ICD9("ACT",<code>,<status>,<date>,<ien>)
"RTN","ICDAPIU",55,0)
 ;     ^ICD0("ACT",<code>,<status>,<date>,<ien>)
"RTN","ICDAPIU",56,0)
 ;
"RTN","ICDAPIU",57,0)
 N ICDC,ICDD,ICDIEN,ICDI,ICDA,ICDG,ICDR,X
"RTN","ICDAPIU",58,0)
 S ICDC=$G(CODE) Q:'$L(ICDC) "0^-1"
"RTN","ICDAPIU",59,0)
 ;    Case 1:  Not Valid                           0^-1
"RTN","ICDAPIU",60,0)
 ;             Fails Pattern Match for Code
"RTN","ICDAPIU",61,0)
 S CODE=$$CODEN^ICDCODE(CODE),ICDG=$P(CODE,"~",2),ICDIEN=+CODE
"RTN","ICDAPIU",62,0)
 Q:ICDIEN<1 "0^-1"
"RTN","ICDAPIU",63,0)
 ;    Case 2:  Never Active                        0^IEN
"RTN","ICDAPIU",64,0)
 ;             No Active/Inactive Date
"RTN","ICDAPIU",65,0)
 S ICDD=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR($G(CDT),1)),ICDD=ICDD+.001
"RTN","ICDAPIU",66,0)
 S ICDR=$$ACTROOT(ICDG,ICDC,1,ICDD),ICDA=$O(@(ICDR_")"),-1)
"RTN","ICDAPIU",67,0)
 I '$L(ICDA) D  Q X
"RTN","ICDAPIU",68,0)
 . S ICDA=$O(@(ICDR_")")),X="0^-1" Q:'$L(ICDA)
"RTN","ICDAPIU",69,0)
 . S ICDR=$$ACTROOT(ICDG,ICDC,1,ICDA)
"RTN","ICDAPIU",70,0)
 . S ICDIEN=$O(@(ICDR_",0)")) S:+ICDIEN<1 ICDIEN=-1
"RTN","ICDAPIU",71,0)
 . S X="0^"_ICDIEN
"RTN","ICDAPIU",72,0)
 ;    Case 3:  Active, Never Inactive              1^IEN
"RTN","ICDAPIU",73,0)
 ;             Has an Activation Date
"RTN","ICDAPIU",74,0)
 ;             No Inactivation Date
"RTN","ICDAPIU",75,0)
 S ICDR=$$ACTROOT(ICDG,ICDC,0,ICDD),ICDI=$O(@(ICDR_")"),-1)
"RTN","ICDAPIU",76,0)
 I $L(ICDA),'$L(ICDI) D  Q X
"RTN","ICDAPIU",77,0)
 . S ICDR=$$ACTROOT(ICDG,ICDC,1,ICDA),ICDIEN=$O(@(ICDR_",0)"))
"RTN","ICDAPIU",78,0)
 . S X=$S(+ICDIEN=0:"0^-1",1:"1^"_ICDIEN)
"RTN","ICDAPIU",79,0)
 ;    Case 4:  Active, but later Inactivated       0^IEN
"RTN","ICDAPIU",80,0)
 ;             Has an Activation Date
"RTN","ICDAPIU",81,0)
 ;             Has an Inactivation Date
"RTN","ICDAPIU",82,0)
 I $L(ICDA),$L(ICDI),ICDI>ICDA,ICDI<ICDD D  Q X
"RTN","ICDAPIU",83,0)
 . S ICDR=$$ACTROOT(ICDG,ICDC,0,ICDI),ICDIEN=$O(@(ICDR_",0)"))
"RTN","ICDAPIU",84,0)
 . S X=$S(+ICDIEN=0:"0^-1",1:"0^"_ICDIEN)
"RTN","ICDAPIU",85,0)
 ;    Case 5:  Active, and not later Inactivated   1^IEN
"RTN","ICDAPIU",86,0)
 ;             Has an Activation Date
"RTN","ICDAPIU",87,0)
 ;             Has an Inactivation Date
"RTN","ICDAPIU",88,0)
 ;             Has a Newer Activation Date
"RTN","ICDAPIU",89,0)
 I $L(ICDA),$L(ICDI),ICDI'>ICDA D  Q X
"RTN","ICDAPIU",90,0)
 . S ICDR=$$ACTROOT(ICDG,ICDC,0,ICDI),ICDIEN=$O(@(ICDR_",1)"))
"RTN","ICDAPIU",91,0)
 . S X=$S(+$O(@(ICDR_",0)"))=0:"0^-1",1:"1^"_ICDIEN)
"RTN","ICDAPIU",92,0)
 ;    Case 6:  Fails Time Test                     0^-1
"RTN","ICDAPIU",93,0)
 Q ("0^"_$S(+($G(ICDIEN))>0:+($G(ICDIEN)),1:"-1"))
"RTN","ICDAPIU",94,0)
 ;
"RTN","ICDAPIU",95,0)
NEXT(CODE) ; Next ICD Code (active or inactive)
"RTN","ICDAPIU",96,0)
 ; Input:
"RTN","ICDAPIU",97,0)
 ;    CODE = ICD Code   REQUIRED
"RTN","ICDAPIU",98,0)
 ; Output:
"RTN","ICDAPIU",99,0)
 ;    The Next ICD Code, Null if none
"RTN","ICDAPIU",100,0)
 ;
"RTN","ICDAPIU",101,0)
 N ICDC,ICDG S ICDC=$G(CODE) Q:'$L(ICDC) ""
"RTN","ICDAPIU",102,0)
 Q:ICDC?1.9N ""  ;app passed an IEN
"RTN","ICDAPIU",103,0)
 S ICDG=$P($$CODEN^ICDCODE(ICDC),"~",2)
"RTN","ICDAPIU",104,0)
 Q:ICDG="INVALID CODE" ""
"RTN","ICDAPIU",105,0)
 S ICDC=$O(@(ICDG_"""BA"","""_ICDC_" "")"))
"RTN","ICDAPIU",106,0)
 Q $S(ICDC="":"",1:$E(ICDC,1,$L(ICDC)-1))
"RTN","ICDAPIU",107,0)
 ;
"RTN","ICDAPIU",108,0)
PREV(CODE) ; Previous ICD Code (active or inactive)
"RTN","ICDAPIU",109,0)
 ; Input:
"RTN","ICDAPIU",110,0)
 ;    CODE = ICD Code   REQUIRED
"RTN","ICDAPIU",111,0)
 ; Output:
"RTN","ICDAPIU",112,0)
 ;    The Previous ICD Code, Null if none
"RTN","ICDAPIU",113,0)
 ;
"RTN","ICDAPIU",114,0)
 N ICDC,ICDG
"RTN","ICDAPIU",115,0)
 S ICDC=$G(CODE) Q:'$L(ICDC) ""
"RTN","ICDAPIU",116,0)
 Q:ICDC?1.9N ""  ;app passed an IEN
"RTN","ICDAPIU",117,0)
 S ICDG=$P($$CODEN^ICDCODE(ICDC),"~",2)
"RTN","ICDAPIU",118,0)
 Q:ICDG="INVALID CODE" ""
"RTN","ICDAPIU",119,0)
 S ICDC=$O(@(ICDG_"""BA"","""_ICDC_" "")"),-1)
"RTN","ICDAPIU",120,0)
 Q $S(ICDC="":"",1:$E(ICDC,1,$L(ICDC)-1))
"RTN","ICDAPIU",121,0)
 ;
"RTN","ICDAPIU",122,0)
HIST(CODE,ARY)  ; Activation History
"RTN","ICDAPIU",123,0)
 ; Input:
"RTN","ICDAPIU",124,0)
 ;    CODE - ICD Code                     REQUIRED
"RTN","ICDAPIU",125,0)
 ;    .ARY - Array, passed by Reference   REQUIRED
"RTN","ICDAPIU",126,0)
 ;
"RTN","ICDAPIU",127,0)
 ; Output:    Mirrors ARY(0) (or, -1 on error)
"RTN","ICDAPIU",128,0)
 ;    ARY(0) = Number of Activation History Entries
"RTN","ICDAPIU",129,0)
 ;    ARY(<date>) = status    where: 1 is Active
"RTN","ICDAPIU",130,0)
 ;    ARY("IEN") = <ien>
"RTN","ICDAPIU",131,0)
 ;
"RTN","ICDAPIU",132,0)
 Q:$G(CODE)="" -1
"RTN","ICDAPIU",133,0)
 N ICDC,ICDI,ICDA,ICDN,ICDD,ICDG,ICDF
"RTN","ICDAPIU",134,0)
 S ICDI=$$CODEN^ICDCODE(CODE),ICDG=$P(ICDI,"~",2)
"RTN","ICDAPIU",135,0)
 S ICDI=+ICDI Q:ICDI<1 -1
"RTN","ICDAPIU",136,0)
 S ARY("IEN")=ICDI,ICDA="" M ICDA=@(ICDG_ICDI_",66)")
"RTN","ICDAPIU",137,0)
 K ICDA("B") S ARY(0)=+($P($G(ICDA(0)),"^",4))
"RTN","ICDAPIU",138,0)
 S:+ARY(0)=0 ARY(0)=-1 K:ARY(0)=-1 ARY("IEN")
"RTN","ICDAPIU",139,0)
 S (ICDI,ICDC)=0 F  S ICDI=$O(ICDA(ICDI)) Q:+ICDI=0  D
"RTN","ICDAPIU",140,0)
 . S ICDD=$P($G(ICDA(ICDI,0)),"^",1) Q:+ICDD=0
"RTN","ICDAPIU",141,0)
 . S ICDF=$P($G(ICDA(ICDI,0)),"^",2) Q:'$L(ICDF)
"RTN","ICDAPIU",142,0)
 . S ICDC=ICDC+1,ARY(0)=ICDC,ARY(ICDD)=ICDF
"RTN","ICDAPIU",143,0)
 Q ARY(0)
"RTN","ICDAPIU",144,0)
 ;
"RTN","ICDAPIU",145,0)
PERIOD(CODE,ARY) ; return Activation/Inactivation Period in ARY
"RTN","ICDAPIU",146,0)
 ;
"RTN","ICDAPIU",147,0)
 ; Input:   CODE  ICD Code (required)
"RTN","ICDAPIU",148,0)
 ;          ARY   Array, passed by Reference (required)
"RTN","ICDAPIU",149,0)
 ;
"RTN","ICDAPIU",150,0)
 ; Output:  ARY(0) = IEN^Selectable
"RTN","ICDAPIU",151,0)
 ;            Where IEN = -1 if error
"RTN","ICDAPIU",152,0)
 ;            Selectable = 0 for VA Only codes
"RTN","ICDAPIU",153,0)
 ;
"RTN","ICDAPIU",154,0)
 ;          ARY(Activation Date) = Inactivation Date^Short Name
"RTN","ICDAPIU",155,0)
 ;
"RTN","ICDAPIU",156,0)
 ;            Where the Short Name is the Versioned text (field 1 of the 67
"RTN","ICDAPIU",157,0)
 ;            multiple), and the text is versioned as follows:
"RTN","ICDAPIU",158,0)
 ;
"RTN","ICDAPIU",159,0)
 ;               Period is active - Versioned text for TODAY's date
"RTN","ICDAPIU",160,0)
 ;               Period is inactive - Versioned text for inactivation date
"RTN","ICDAPIU",161,0)
 ;
"RTN","ICDAPIU",162,0)
 ;           or
"RTN","ICDAPIU",163,0)
 ;
"RTN","ICDAPIU",164,0)
 ;         -1^0 (no period or error)
"RTN","ICDAPIU",165,0)
 ;
"RTN","ICDAPIU",166,0)
 I $G(CODE)="" S ARY(0)="-1^0" Q
"RTN","ICDAPIU",167,0)
 N ICDC,ICDI,ICDA,ICDG,ICDF,ICDBA,ICDBI,ICDST,ICDS,ICDZ,ICDV,ICDN,ICDCA
"RTN","ICDAPIU",168,0)
 S ICDC=$$CODEN^ICDCODE(CODE),ICDG=$P(ICDC,"~",2),ICDC=+ICDC
"RTN","ICDAPIU",169,0)
 I ICDC<1 S ARY(0)="-1^0" Q
"RTN","ICDAPIU",170,0)
 S ICDI=$S(ICDG="^ICD9(":3,1:4),ICDZ=$G(@(ICDG_ICDC_",0)"))
"RTN","ICDAPIU",171,0)
 ; Versioned text for TODAY
"RTN","ICDAPIU",172,0)
 S ICDN=$$VST^ICDCODE(ICDC,$$DT^XLFDT,ICDG)
"RTN","ICDAPIU",173,0)
 S ICDS=$P(ICDZ,"^",ICDI),ARY(0)=ICDC_"^"_'$P(ICDZ,"^",8)
"RTN","ICDAPIU",174,0)
 S (ICDA,ICDBA)=0,ICDG=ICDG_ICDC_",66,"
"RTN","ICDAPIU",175,0)
 F  Q:ICDBA  D
"RTN","ICDAPIU",176,0)
 . S ICDA=$O(@(ICDG_"""B"","_ICDA_")"))
"RTN","ICDAPIU",177,0)
 . I ICDA="" S ICDBA=1 Q
"RTN","ICDAPIU",178,0)
 . S ICDF=$O(@(ICDG_"""B"","_ICDA_",0)"))
"RTN","ICDAPIU",179,0)
 . I '+ICDF S ICDBA=1 Q
"RTN","ICDAPIU",180,0)
 . S ICDST=$P($G(@(ICDG_ICDF_",0)")),"^",2)
"RTN","ICDAPIU",181,0)
 . Q:'ICDST  ;outer loop looks for active
"RTN","ICDAPIU",182,0)
 . ; Versioned text for activation date
"RTN","ICDAPIU",183,0)
 . S ICDV=$$VST^ICDCODE(ICDC,ICDA,ICDG),ICDCA=1
"RTN","ICDAPIU",184,0)
 . S:$L(ICDV) ICDS=ICDV
"RTN","ICDAPIU",185,0)
 . S ARY(ICDA)="^"_ICDS,ICDBI=0,ICDI=ICDA
"RTN","ICDAPIU",186,0)
 . F  Q:ICDBI  D
"RTN","ICDAPIU",187,0)
 . . S ICDI=$O(@(ICDG_"""B"","_ICDI_")"))
"RTN","ICDAPIU",188,0)
 . . ; If no inactivation date for ICDA then use TODAY's text
"RTN","ICDAPIU",189,0)
 . . I ICDI="" S ARY(ICDA)="^"_ICDN,(ICDBI,ICDBA)=1 Q
"RTN","ICDAPIU",190,0)
 . . S ICDF=$O(@(ICDG_"""B"","_ICDI_",0)"))
"RTN","ICDAPIU",191,0)
 . . ; If no effective date ICDF for ICDI then use TODAY's text
"RTN","ICDAPIU",192,0)
 . . I '+ICDF S ARY(ICDA)="^"_ICDN,(ICDBI,ICDBA)=1 Q
"RTN","ICDAPIU",193,0)
 . . S ICDST=$P($G(@(ICDG_ICDF_",0)")),"^",2)
"RTN","ICDAPIU",194,0)
 . . ; If Status ICDST not Inactive then use TODAY's text
"RTN","ICDAPIU",195,0)
 . . I ICDST S ARY(ICDA)="^"_ICDN,ICDBI=1 Q
"RTN","ICDAPIU",196,0)
 . . ; Versioned text for inactive date
"RTN","ICDAPIU",197,0)
 . . S ICDV=$$VST^ICDCODE(ICDC,ICDI,ICDG)
"RTN","ICDAPIU",198,0)
 . . S:$L(ICDV) $P(ARY(ICDA),"^",2)=ICDV
"RTN","ICDAPIU",199,0)
 . . S $P(ARY(ICDA),"^")=ICDI
"RTN","ICDAPIU",200,0)
 . . S ICDBI=1,ICDA=ICDI,ICDCA=0
"RTN","ICDAPIU",201,0)
 Q
"RTN","ICDAPIU",202,0)
 ;
"RTN","ICDAPIU",203,0)
ACTROOT(ICDG,ICDC,ICDS,ICDD)  ; Return "ACT" root
"RTN","ICDAPIU",204,0)
 Q (ICDG_"""ACT"","""_ICDC_" "","_ICDS_","_ICDD)
"RTN","ICDID")
0^1^B14387573
"RTN","ICDID",1,0)
ICDID ;SLC/KER - ICD IDENTIFIERS ; 04/18/2004
"RTN","ICDID",2,0)
 ;;18.0;DRG Grouper;**12,15**;Oct 20, 2000
"RTN","ICDID",3,0)
 ;
"RTN","ICDID",4,0)
 ;
"RTN","ICDID",5,0)
 ; External References
"RTN","ICDID",6,0)
 ;   DBIA   2056  $$GET1^DIQ
"RTN","ICDID",7,0)
 ;   DBIA  10103  $$DT^XLFDT
"RTN","ICDID",8,0)
 ;                 
"RTN","ICDID",9,0)
 Q
"RTN","ICDID",10,0)
 ; Versioned Identifiers use the following
"RTN","ICDID",11,0)
 ; input parameters:
"RTN","ICDID",12,0)
 ;                   
"RTN","ICDID",13,0)
 ;    Y    Fileman's Internal Entry Number
"RTN","ICDID",14,0)
 ;    X    DD Field Number
"RTN","ICDID",15,0)
 ;                   
"RTN","ICDID",16,0)
 ; Format for using Identifiers
"RTN","ICDID",17,0)
 ;                   
"RTN","ICDID",18,0)
 ;   ^DD(file,0,"ID",field)=
"RTN","ICDID",19,0)
 ;        D EN^DDIOL(("   "_$$IDDX^ICDID(+Y,field)),"","?0")
"RTN","ICDID",20,0)
 ;                       
"RTN","ICDID",21,0)
IDDX(Y,X) ; ICD Diagnosis Identifiers (versioned)
"RTN","ICDID",22,0)
 N FLD,MSG,CODE S FLD=+($G(X)),Y=+($G(Y)) Q:+FLD'>0 ""  Q:+Y'>0 ""
"RTN","ICDID",23,0)
 I '$D(ICDVDT) N ICDVDT S ICDVDT=$$DT^XLFDT
"RTN","ICDID",24,0)
 S MSG=$$MSG^ICDAPIU($G(ICDVDT)),CODE=$P($G(^ICD9(+Y,0)),U,1)
"RTN","ICDID",25,0)
 I FLD=3 S X=$$VSTD^ICDCODE(+Y,$G(ICDVDT))_$S($L(MSG):("  ("_MSG_")"),1:"") Q X
"RTN","ICDID",26,0)
 I FLD=10 S X=$$VLTD^ICDCODE(+Y,$G(ICDVDT))_$S($L(MSG):("  ("_MSG_")"),1:"") Q X
"RTN","ICDID",27,0)
 I FLD=100 S X=$$STA(+($$STATCHK^ICDAPIU(CODE,$G(ICDVDT)))) Q X
"RTN","ICDID",28,0)
 I FLD=20!(FLD=30)!(FLD=40)!(FLD=66)!(FLD=67)!(FLD=68) Q ""
"RTN","ICDID",29,0)
 S X=$$GET1^DIQ(80,(+($G(Y))_","),FLD)
"RTN","ICDID",30,0)
 Q X
"RTN","ICDID",31,0)
IDDXS(Y) ; ICD Diagnosis Identifiers (versioned - short)
"RTN","ICDID",32,0)
 N ICID,MSG,CODE,ST,ND,CC,X S Y=+($G(Y)) Q:+Y'>0 ""  S ND=$G(^ICD9(+Y,0))
"RTN","ICDID",33,0)
 I '$D(ICDVDT) N ICDVDT S ICDVDT=$$DT^XLFDT
"RTN","ICDID",34,0)
 S MSG=$$MSG^ICDAPIU($G(ICDVDT)) S:MSG["CODE " MSG="Text may be inaccurate"
"RTN","ICDID",35,0)
 S CODE=$P(ND,U,1)
"RTN","ICDID",36,0)
 S ICID=$$VSTD^ICDCODE(+Y,$G(ICDVDT)) S:$L(MSG) ICID=ICID_"  ("_MSG_")"
"RTN","ICDID",37,0)
 S ST=$$STA(+($$STATCHK^ICDAPIU(CODE,$G(ICDVDT))))
"RTN","ICDID",38,0)
 S CC=+$P(ND,U,7),CC=$S(CC>0:"C/C",1:"")
"RTN","ICDID",39,0)
 S:$L(CC) ICID=ICID_$S('$L(MSG):" ",1:"")_"("_CC_")"
"RTN","ICDID",40,0)
 S:$L(ST) ICID=ICID_$S('$L(MSG)&('$L(CC)):" ",1:"")_" "_ST
"RTN","ICDID",41,0)
 F  Q:$E(ICID,1)'=" "  S ICID=$E(ICID,2,$L(ICID))
"RTN","ICDID",42,0)
 S Y=ICID
"RTN","ICDID",43,0)
 Q Y
"RTN","ICDID",44,0)
IDOP(Y,X) ; ICD Procedure Identifiers (versioned)
"RTN","ICDID",45,0)
 N FLD,MSG,CODE S FLD=+($G(X)),Y=+($G(Y)) Q:+FLD'>0 ""  Q:+Y'>0 ""
"RTN","ICDID",46,0)
 I '$D(ICDVDT) N ICDVDT S ICDVDT=$$DT^XLFDT
"RTN","ICDID",47,0)
 S MSG=$$MSG^ICDAPIU($G(ICDVDT)),CODE=$P($G(^ICD0(+Y,0)),U,1)
"RTN","ICDID",48,0)
 I FLD=4 S X=$$VSTP^ICDCODE(+Y,$G(ICDVDT))_$S($L(MSG):("  ("_MSG_")"),1:"") Q X
"RTN","ICDID",49,0)
 I FLD=10 S X=$$VLTP^ICDCODE(+Y,$G(ICDVDT))_$S($L(MSG):("  ("_MSG_")"),1:"") Q X
"RTN","ICDID",50,0)
 I FLD=100 S X=$$STA(+($$STATCHK^ICDAPIU(CODE,$G(ICDVDT)))) Q X
"RTN","ICDID",51,0)
 I FLD=7!(FLD=66)!(FLD=67)!(FLD=68) Q ""
"RTN","ICDID",52,0)
 S X=$$GET1^DIQ(80.1,(+($G(Y))_","),FLD)
"RTN","ICDID",53,0)
 Q X
"RTN","ICDID",54,0)
IDOPS(Y) ; ICD Procedure Identifiers (versioned - short)
"RTN","ICDID",55,0)
 N ICID,MSG,CODE,ST,X S Y=+($G(Y)) Q:+Y'>0 ""
"RTN","ICDID",56,0)
 I '$D(ICDVDT) N ICDVDT S ICDVDT=$$DT^XLFDT
"RTN","ICDID",57,0)
 S MSG=$$MSG^ICDAPIU($G(ICDVDT)) S:MSG["CODE " MSG="Text may be inaccurate"
"RTN","ICDID",58,0)
 S CODE=$P($G(^ICD0(+Y,0)),U,1)
"RTN","ICDID",59,0)
 S ICID=$$VSTP^ICDCODE(+Y,$G(ICDVDT)) S:$L(MSG) ICID=ICID_"  ("_MSG_")"
"RTN","ICDID",60,0)
 S ST=$$STA(+($$STATCHK^ICDAPIU(CODE,$G(ICDVDT))))
"RTN","ICDID",61,0)
 S:$L(ST) ICID=ICID_$S('$L(MSG):" ",1:"")_" "_ST
"RTN","ICDID",62,0)
 F  Q:$E(ICID,1)'=" "  S ICID=$E(ICID,2,$L(ICID))
"RTN","ICDID",63,0)
 S Y=ICID
"RTN","ICDID",64,0)
 Q Y
"RTN","ICDID",65,0)
IDDG(Y,X) ; DRG Identifiers (versioned)
"RTN","ICDID",66,0)
 N FLD,MSG S FLD=+($G(X)),Y=+($G(Y)) Q:+FLD'>0 ""  Q:+Y'>0 ""
"RTN","ICDID",67,0)
 I '$D(ICDVDT) N ICDVDT S ICDVDT=$$DT^XLFDT
"RTN","ICDID",68,0)
 S MSG=$$MSG^ICDAPIU($G(ICDVDT)) I FLD=1 D  Q X
"RTN","ICDID",69,0)
 . N DRG D VLTDR^ICDGTDRG(+Y,$G(ICDVDT),.DRG)
"RTN","ICDID",70,0)
 . S X=$G(DRG(1)) S:$L(MSG) X=X_"  ("_MSG_")"
"RTN","ICDID",71,0)
 I FLD=15 D  Q X
"RTN","ICDID",72,0)
 . N VD,I,ST S VD=$O(^ICD(+Y,66,"B"," "),-1)
"RTN","ICDID",73,0)
 . S I=$O(^ICD(+Y,66,"B",+VD," "),-1),X=$$STA(+($P($G(^ICD(+Y,66,+I,0)),U,3)))
"RTN","ICDID",74,0)
 I FLD=20!(FLD=30)!(FLD=66)!(FLD=68) Q ""
"RTN","ICDID",75,0)
 S X=$$GET1^DIQ(80.2,(+($G(Y))_","),FLD)
"RTN","ICDID",76,0)
 Q X
"RTN","ICDID",77,0)
IDDGS(Y) ; DRG Identifiers (versioned - Short)
"RTN","ICDID",78,0)
 N MSG,X,ICDRG,ICID,VD,I,ST S Y=+($G(Y)) Q:+Y'>0 ""
"RTN","ICDID",79,0)
 I '$D(ICDVDT) N ICDVDT S ICDVDT=$$DT^XLFDT
"RTN","ICDID",80,0)
 S MSG=$$MSG^ICDAPIU($G(ICDVDT)) S:MSG["CODE " MSG="Text may be inaccurate"
"RTN","ICDID",81,0)
 D VLTDR^ICDGTDRG(+Y,$G(ICDVDT),.ICDRG)
"RTN","ICDID",82,0)
 S ICID=$G(ICDRG(1)) S:$L(MSG) ICID=ICID_"  ("_MSG_")"
"RTN","ICDID",83,0)
 S VD=$O(^ICD(+Y,66,"B"," "),-1)
"RTN","ICDID",84,0)
 S I=$O(^ICD(+Y,66,"B",+VD," "),-1)
"RTN","ICDID",85,0)
 S ST=$$STA(+($P($G(^ICD(+Y,66,+I,0)),U,3)))
"RTN","ICDID",86,0)
 S:$L(ST) ICID=ICID_$S('$L(MSG):" ",1:"")_" "_ST
"RTN","ICDID",87,0)
 F  Q:$E(ICID,1)'=" "  S ICID=$E(ICID,2,$L(ICID))
"RTN","ICDID",88,0)
 S Y=ICID
"RTN","ICDID",89,0)
 Q Y
"RTN","ICDID",90,0)
STA(X) ; Status
"RTN","ICDID",91,0)
 Q $S(+($G(X)):"",1:"INACTIVE")
"VER")
8.0^22.0
**INSTALL NAME**
ICPT*6.0*22
"BLD",5507,0)
ICPT*6.0*22^CPT/HCPCS CODES^0^3050420^y
"BLD",5507,1,0)
^^2^2^3050124^
"BLD",5507,1,1,0)
Please see the National Patch Module for details of the enhancements 
"BLD",5507,1,2,0)
included in this patch.
"BLD",5507,4,0)
^9.64PA^^
"BLD",5507,"KRN",0)
^9.67PA^8989.52^19
"BLD",5507,"KRN",.4,0)
.4
"BLD",5507,"KRN",.401,0)
.401
"BLD",5507,"KRN",.402,0)
.402
"BLD",5507,"KRN",.403,0)
.403
"BLD",5507,"KRN",.5,0)
.5
"BLD",5507,"KRN",.84,0)
.84
"BLD",5507,"KRN",3.6,0)
3.6
"BLD",5507,"KRN",3.8,0)
3.8
"BLD",5507,"KRN",9.2,0)
9.2
"BLD",5507,"KRN",9.8,0)
9.8
"BLD",5507,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5507,"KRN",9.8,"NM",1,0)
ICPTAPIU^^0^B46396417
"BLD",5507,"KRN",9.8,"NM","B","ICPTAPIU",1)

"BLD",5507,"KRN",19,0)
19
"BLD",5507,"KRN",19.1,0)
19.1
"BLD",5507,"KRN",101,0)
101
"BLD",5507,"KRN",409.61,0)
409.61
"BLD",5507,"KRN",771,0)
771
"BLD",5507,"KRN",870,0)
870
"BLD",5507,"KRN",8989.51,0)
8989.51
"BLD",5507,"KRN",8989.52,0)
8989.52
"BLD",5507,"KRN",8994,0)
8994
"BLD",5507,"KRN","B",.4,.4)

"BLD",5507,"KRN","B",.401,.401)

"BLD",5507,"KRN","B",.402,.402)

"BLD",5507,"KRN","B",.403,.403)

"BLD",5507,"KRN","B",.5,.5)

"BLD",5507,"KRN","B",.84,.84)

"BLD",5507,"KRN","B",3.6,3.6)

"BLD",5507,"KRN","B",3.8,3.8)

"BLD",5507,"KRN","B",9.2,9.2)

"BLD",5507,"KRN","B",9.8,9.8)

"BLD",5507,"KRN","B",19,19)

"BLD",5507,"KRN","B",19.1,19.1)

"BLD",5507,"KRN","B",101,101)

"BLD",5507,"KRN","B",409.61,409.61)

"BLD",5507,"KRN","B",771,771)

"BLD",5507,"KRN","B",870,870)

"BLD",5507,"KRN","B",8989.51,8989.51)

"BLD",5507,"KRN","B",8989.52,8989.52)

"BLD",5507,"KRN","B",8994,8994)

"BLD",5507,"QUES",0)
^9.62^^
"BLD",5507,"REQB",0)
^9.611^1^1
"BLD",5507,"REQB",1,0)
ICPT*6.0*19^2
"BLD",5507,"REQB","B","ICPT*6.0*19",1)

"MBREQ")
0
"PKG",302,-1)
1^1
"PKG",302,0)
CPT/HCPCS CODES^ICPT^ICPT/HCPCS CODES
"PKG",302,20,0)
^9.402P^^
"PKG",302,22,0)
^9.49I^1^1
"PKG",302,22,1,0)
6.0^2970519^2970530^1294
"PKG",302,22,1,"PAH",1,0)
22^3050420^1118
"PKG",302,22,1,"PAH",1,1,0)
^^2^2^3050420
"PKG",302,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements 
"PKG",302,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ICPTAPIU")
0^1^B46396417
"RTN","ICPTAPIU",1,0)
ICPTAPIU  ;ALB/DEK/KER - CPT UTILITIES FOR APIS ; 04/18/2004
"RTN","ICPTAPIU",2,0)
 ;;6.0;CPT/HCPCS;**1,6,12,14,16,19,22**;May 19, 1997
"RTN","ICPTAPIU",3,0)
 ;
"RTN","ICPTAPIU",4,0)
 ; External References
"RTN","ICPTAPIU",5,0)
 ;   DBIA 10011  ^DIWP
"RTN","ICPTAPIU",6,0)
 ;   DBIA 10029  ^DIWW
"RTN","ICPTAPIU",7,0)
 ;   DBIA 10103  $$DT^XLFDT 
"RTN","ICPTAPIU",8,0)
 ;                          
"RTN","ICPTAPIU",9,0)
CPTDIST() ; Distribution Date
"RTN","ICPTAPIU",10,0)
 ;  Input:  none (extrinsic variable)
"RTN","ICPTAPIU",11,0)
 ; Output:  returns DISTRIBUTION DATE, date codes effective in Austin
"RTN","ICPTAPIU",12,0)
 Q $P($G(^DIC(81.2,1,0)),"^",2)
"RTN","ICPTAPIU",13,0)
 ;
"RTN","ICPTAPIU",14,0)
CAT(CAT,DFN) ; Return CATEGORY NAME given IEN
"RTN","ICPTAPIU",15,0)
 ;   Input:  CAT = category ien REQUIRED
"RTN","ICPTAPIU",16,0)
 ;           DFN - not in use but included in anticipation of future need
"RTN","ICPTAPIU",17,0)
 ;
"RTN","ICPTAPIU",18,0)
 ;  Output:  STR = CATEGORY NAME^SOURCE (C or H)^MAJOR CATEGORY IEN^MAJOR CATEGORY NAME  
"RTN","ICPTAPIU",19,0)
 ;           STR = -1^error message, if error condition occurred
"RTN","ICPTAPIU",20,0)
 ;
"RTN","ICPTAPIU",21,0)
 N CATN,STR,MCATIEN,MCATNM
"RTN","ICPTAPIU",22,0)
 S (MCATIEN,MCATNM)=""
"RTN","ICPTAPIU",23,0)
 I $G(CAT)="" S STR="-1^NO CATEGORY SELECTED" G CATQ
"RTN","ICPTAPIU",24,0)
 I '$G(CAT) S STR="-1^INVALID CATEGORY FORMAT" G CATQ
"RTN","ICPTAPIU",25,0)
 S STR=$G(^DIC(81.1,+CAT,0))
"RTN","ICPTAPIU",26,0)
 I '$L(STR) S STR="-1^NO SUCH CATEGORY" G CATQ
"RTN","ICPTAPIU",27,0)
 I $P(STR,"^",2)="" S STR="-1^TYPE OF CATEGORY UNSPECIFIED" G CATQ
"RTN","ICPTAPIU",28,0)
 S CATN=$P(STR,"^")
"RTN","ICPTAPIU",29,0)
 I $P(STR,"^",2)="m" S MCATNM=CATN,MCATIEN=+CAT
"RTN","ICPTAPIU",30,0)
 I $P(STR,"^",2)="s" D
"RTN","ICPTAPIU",31,0)
 . S MCATIEN=$P(STR,"^",3)
"RTN","ICPTAPIU",32,0)
 . I MCATIEN S MCATNM=$P($G(^DIC(81.1,MCATIEN,0)),"^")
"RTN","ICPTAPIU",33,0)
 S STR=CATN_"^"_$P(STR,"^",6)_"^"_MCATIEN_"^"_MCATNM
"RTN","ICPTAPIU",34,0)
CATQ Q STR
"RTN","ICPTAPIU",35,0)
 ;
"RTN","ICPTAPIU",36,0)
NUM(Y) ; Convert CPT/HCPCS Code to Numeric
"RTN","ICPTAPIU",37,0)
 ;    Convert HCPCS to $A() of Alpha _ Numeric Portion
"RTN","ICPTAPIU",38,0)
 ;
"RTN","ICPTAPIU",39,0)
 ;   Input:  Y - CPT or HCPCS code
"RTN","ICPTAPIU",40,0)
 ;
"RTN","ICPTAPIU",41,0)
 ;  Output:  'plussed' value for CPT code,
"RTN","ICPTAPIU",42,0)
 ;         numeric for HCPCS based on $A of 1st character (alpha)
"RTN","ICPTAPIU",43,0)
 ;          concatenated with the 4-digit portion of code
"RTN","ICPTAPIU",44,0)
 ;
"RTN","ICPTAPIU",45,0)
 ;  **This does not convert to ien**
"RTN","ICPTAPIU",46,0)
 ;  This converts to a numeric that may be used for range sorting
"RTN","ICPTAPIU",47,0)
 ;
"RTN","ICPTAPIU",48,0)
 ;Q $S(Y:+Y,1:$A(Y)_$E(Y,2,5))
"RTN","ICPTAPIU",49,0)
 ; modified in 2002 to handle few CPT codes that end with "T"
"RTN","ICPTAPIU",50,0)
 ; needed to add multiplier to create higher and unique number
"RTN","ICPTAPIU",51,0)
 ; e.g. "Z9999"=909999 and "0001T"=8400001
"RTN","ICPTAPIU",52,0)
 Q $S(Y?1.N:+Y,Y?4N1A:$A($E(Y,5))*10_$E(Y,1,4),1:$A(Y)_$E(Y,2,5))
"RTN","ICPTAPIU",53,0)
 ;
"RTN","ICPTAPIU",54,0)
COPY ; API to Print Copyright Information
"RTN","ICPTAPIU",55,0)
 ;
"RTN","ICPTAPIU",56,0)
 N DIR,DIWL,DIWR,DIWF,VARR,VAXX,X
"RTN","ICPTAPIU",57,0)
 Q:'$D(^DIC(81.2,1))  K ^UTILITY($J,"W")
"RTN","ICPTAPIU",58,0)
 W !!! S DIWL=1,DIWR=80,DIWF="W"
"RTN","ICPTAPIU",59,0)
 F VARR=0:0 S VARR=$O(^DIC(81.2,1,1,VARR)) Q:VARR'>0  S VAXX=^(VARR,0),X=VAXX D ^DIWP
"RTN","ICPTAPIU",60,0)
 D:$D(VAXX) ^DIWW
"RTN","ICPTAPIU",61,0)
 Q
"RTN","ICPTAPIU",62,0)
 ;                   
"RTN","ICPTAPIU",63,0)
STATCHK(CODE,CDT) ; Check Status of CPT Code or Modifier
"RTN","ICPTAPIU",64,0)
 ; Input:
"RTN","ICPTAPIU",65,0)
 ;    CODE - CPT Code/Modifier    REQUIRED
"RTN","ICPTAPIU",66,0)
 ;    CDT - Date to screen against (FileMan format, default = today)
"RTN","ICPTAPIU",67,0)
 ;
"RTN","ICPTAPIU",68,0)
 ; Output:
"RTN","ICPTAPIU",69,0)
 ;    2-Piece String containing the status of the code/modifier
"RTN","ICPTAPIU",70,0)
 ;    and the IEN if the code/modifier exists, else -1.
"RTN","ICPTAPIU",71,0)
 ;    The following are possible outputs:
"RTN","ICPTAPIU",72,0)
 ;        1 ^ IEN    Active Code/Modifier
"RTN","ICPTAPIU",73,0)
 ;        0 ^ IEN    Inactive Code/Modifier
"RTN","ICPTAPIU",74,0)
 ;        0 ^ -1     Code/Modifier not Found
"RTN","ICPTAPIU",75,0)
 ;
"RTN","ICPTAPIU",76,0)
 ; This API requires the ACT Cross-Reference
"RTN","ICPTAPIU",77,0)
 ;    ^ICPT("ACT",<code>,<status>,<date>,<ien>)
"RTN","ICPTAPIU",78,0)
 ;    ^DIC(81.3,"ACT",<code>,<status>,<date>,<ien>)
"RTN","ICPTAPIU",79,0)
 ;
"RTN","ICPTAPIU",80,0)
 N ICPTC,ICPTD,ICPTIEN,ICPTA,ICPTI,X,ICPTG,ICPTR,ICPTD
"RTN","ICPTAPIU",81,0)
 S ICPTC=$G(CODE) Q:'$L(ICPTC) "0^-1"
"RTN","ICPTAPIU",82,0)
 ;    Case 1:  Not Valid                           0^-1
"RTN","ICPTAPIU",83,0)
 ;             Fails Pattern Match for Code
"RTN","ICPTAPIU",84,0)
 S ICPTG=$$GBL^ICPTSUPT(ICPTC) Q:ICPTG="" "0^-1"
"RTN","ICPTAPIU",85,0)
 ;    Case 2:  Never Active                        0^IEN
"RTN","ICPTAPIU",86,0)
 ;             No In/Active Date
"RTN","ICPTAPIU",87,0)
 S ICPTD=$S($G(CDT)="":$$DT^XLFDT,1:$$DTBR^ICPTSUPT($G(CDT))),ICPTD=ICPTD+.001
"RTN","ICPTAPIU",88,0)
 S ICPTR=$$ACT(ICPTG,ICPTC,1,ICPTD),ICPTA=$O(@(ICPTR_")"),-1)
"RTN","ICPTAPIU",89,0)
 I '$L(ICPTA) D  Q X
"RTN","ICPTAPIU",90,0)
 . S ICPTA=$O(@(ICPTR_")")),X="0^-1" Q:'$L(ICPTA)
"RTN","ICPTAPIU",91,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,1,ICPTA)
"RTN","ICPTAPIU",92,0)
 . S ICPTIEN=$O(@(ICPTR_",0)")) S:+ICPTIEN<1 ICPTIEN=-1
"RTN","ICPTAPIU",93,0)
 . S X="0^"_ICPTIEN
"RTN","ICPTAPIU",94,0)
 ;    Case 3:  Active, Never Inactive              1^IEN
"RTN","ICPTAPIU",95,0)
 ;             Has an Activation Date
"RTN","ICPTAPIU",96,0)
 ;             No Inactivation Date
"RTN","ICPTAPIU",97,0)
 S ICPTR=$$ACT(ICPTG,ICPTC,0,ICPTD),ICPTI=$O(@(ICPTR_")"),-1)
"RTN","ICPTAPIU",98,0)
 I $L(ICPTA),'$L(ICPTI) D  Q X
"RTN","ICPTAPIU",99,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,1,ICPTA),ICPTIEN=$O(@(ICPTR_",0)"))
"RTN","ICPTAPIU",100,0)
 . S X=$S(+ICPTIEN=0:"0^-1",1:"1^"_ICPTIEN)
"RTN","ICPTAPIU",101,0)
 ;    Case 4:  Active, but later Inactivated       0^IEN
"RTN","ICPTAPIU",102,0)
 ;             Has an In/Activation Date
"RTN","ICPTAPIU",103,0)
 I $L(ICPTA),$L(ICPTI),ICPTI>ICPTA,ICPTI<ICPTD D  Q X
"RTN","ICPTAPIU",104,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,0,ICPTI),ICPTIEN=$O(@(ICPTR_",0)"))
"RTN","ICPTAPIU",105,0)
 . S X=$S(+ICPTIEN=0:"0^-1",1:"0^"_ICPTIEN)
"RTN","ICPTAPIU",106,0)
 ;    Case 5:  Active, and not later Inactivated   1^IEN
"RTN","ICPTAPIU",107,0)
 ;             Has an In/Activation Date
"RTN","ICPTAPIU",108,0)
 ;             Has a Newer Activation Date
"RTN","ICPTAPIU",109,0)
 I $L(ICPTA),$L(ICPTI),ICPTI'>ICPTA D  Q X
"RTN","ICPTAPIU",110,0)
 . S ICPTR=$$ACT(ICPTG,ICPTC,0,ICPTI),ICPTIEN=$O(@(ICPTR_",1)"))
"RTN","ICPTAPIU",111,0)
 . S X=$S(+$O(@(ICPTR_",0)"))=0:"0^-1",1:"1^"_ICPTIEN)
"RTN","ICPTAPIU",112,0)
 ;    Case 6:  Fails Time Test                     0^-1
"RTN","ICPTAPIU",113,0)
 Q ("0^"_$S(+($G(ICPTIEN))>0:+($G(ICPTIEN)),1:"-1"))
"RTN","ICPTAPIU",114,0)
 ;
"RTN","ICPTAPIU",115,0)
NEXT(CODE) ; Next CPT Code or Modifier (active or inactive)
"RTN","ICPTAPIU",116,0)
 ; Input:
"RTN","ICPTAPIU",117,0)
 ;    CODE = CPT Code/Modifier   REQUIRED
"RTN","ICPTAPIU",118,0)
 ;
"RTN","ICPTAPIU",119,0)
 ; Output:
"RTN","ICPTAPIU",120,0)
 ;    The Next CPT Code/Modifier, Null if none
"RTN","ICPTAPIU",121,0)
 ;
"RTN","ICPTAPIU",122,0)
 N ICPTC,ICPTG
"RTN","ICPTAPIU",123,0)
 S ICPTC=$G(CODE) Q:'$L(ICPTC) ""
"RTN","ICPTAPIU",124,0)
 S ICPTG=$$GBL^ICPTSUPT(ICPTC) Q:'$L(ICPTG) ""
"RTN","ICPTAPIU",125,0)
 S ICPTC=$O(@(ICPTG_"""BA"","""_ICPTC_" "")"))
"RTN","ICPTAPIU",126,0)
 Q $S(ICPTC="":"",1:$E(ICPTC,1,$L(ICPTC)-1))
"RTN","ICPTAPIU",127,0)
 ;
"RTN","ICPTAPIU",128,0)
PREV(CODE) ; Previous CPT Code or Modifier (active or inactive)
"RTN","ICPTAPIU",129,0)
 ; Input:
"RTN","ICPTAPIU",130,0)
 ;    CODE = CPT Code/Modifier   REQUIRED
"RTN","ICPTAPIU",131,0)
 ;
"RTN","ICPTAPIU",132,0)
 ; Output:
"RTN","ICPTAPIU",133,0)
 ;    The Previous CPT Code/Modifier, Null if none
"RTN","ICPTAPIU",134,0)
 ;
"RTN","ICPTAPIU",135,0)
 N ICPTC,ICPTG
"RTN","ICPTAPIU",136,0)
 S ICPTC=$G(CODE) Q:'$L(ICPTC) ""
"RTN","ICPTAPIU",137,0)
 S ICPTG=$$GBL^ICPTSUPT(ICPTC) Q:'$L(ICPTG) ""
"RTN","ICPTAPIU",138,0)
 S ICPTC=$O(@(ICPTG_"""BA"","""_ICPTC_" "")"),-1)
"RTN","ICPTAPIU",139,0)
 Q $S(ICPTC="":"",1:$E(ICPTC,1,$L(ICPTC)-1))
"RTN","ICPTAPIU",140,0)
 ;
"RTN","ICPTAPIU",141,0)
HIST(CODE,ARY) ; Activation History
"RTN","ICPTAPIU",142,0)
 ; Input:
"RTN","ICPTAPIU",143,0)
 ;    CODE - CPT Code or Modifier          REQUIRED
"RTN","ICPTAPIU",144,0)
 ;    .ARY - Array, passed by Reference    REQUIRED
"RTN","ICPTAPIU",145,0)
 ;
"RTN","ICPTAPIU",146,0)
 ; Output:    Mirrors ARY(0) (or, -1 on error)
"RTN","ICPTAPIU",147,0)
 ;    ARY(0) = Number of Activation History Entries
"RTN","ICPTAPIU",148,0)
 ;    ARY(<date>) = status    where: 1 is Active
"RTN","ICPTAPIU",149,0)
 ;    ARY("IEN") = <ien>
"RTN","ICPTAPIU",150,0)
 ;
"RTN","ICPTAPIU",151,0)
 Q:$G(CODE)="" -1
"RTN","ICPTAPIU",152,0)
 N ICPTC,ICPTI,ICPTN,ICPTD,ICPTG,ICPTF,ICPTO
"RTN","ICPTAPIU",153,0)
 S ICPTG=$$GBL^ICPTSUPT(CODE) Q:'$L(ICPTG) -1
"RTN","ICPTAPIU",154,0)
 S ICPTI=$O(@(ICPTG_"""BA"","""_CODE_" "",0)")) Q:'$L(ICPTI) -1
"RTN","ICPTAPIU",155,0)
 S ARY("IEN")=ICPTI,ICPTO="" M ICPTO=@(ICPTG_ICPTI_",60)")
"RTN","ICPTAPIU",156,0)
 K ICPT0("B") S ARY(0)=+($P($G(ICPTO(0)),"^",4))
"RTN","ICPTAPIU",157,0)
 S:+ARY(0)=0 ARY(0)=-1 K:ARY(0)=-1 ARY("IEN")
"RTN","ICPTAPIU",158,0)
 S (ICPTI,ICPTC)=0 F  S ICPTI=$O(ICPTO(ICPTI)) Q:+ICPTI=0  D
"RTN","ICPTAPIU",159,0)
 . S ICPTD=$P($G(ICPTO(ICPTI,0)),"^",1) Q:+ICPTD=0
"RTN","ICPTAPIU",160,0)
 . S ICPTF=$P($G(ICPTO(ICPTI,0)),"^",2) Q:'$L(ICPTF)
"RTN","ICPTAPIU",161,0)
 . S ICPTC=ICPTC+1,ARY(0)=ICPTC,ARY(ICPTD)=ICPTF
"RTN","ICPTAPIU",162,0)
 Q ARY(0)
"RTN","ICPTAPIU",163,0)
 ;
"RTN","ICPTAPIU",164,0)
PERIOD(CODE,ARY) ; return Activation/Inactivation Period in ARY
"RTN","ICPTAPIU",165,0)
 ;
"RTN","ICPTAPIU",166,0)
 ; Output:  ARY(0) = String: IEN^Selectable
"RTN","ICPTAPIU",167,0)
 ; 
"RTN","ICPTAPIU",168,0)
 ;          Where the pieces are:
"RTN","ICPTAPIU",169,0)
 ; 
"RTN","ICPTAPIU",170,0)
 ;            1  Internal Entry Number of code in ^ICPT or ^DIC(81.3,
"RTN","ICPTAPIU",171,0)
 ;            2  0:unselectable; 1:selectable
"RTN","ICPTAPIU",172,0)
 ; 
"RTN","ICPTAPIU",173,0)
 ;          ARY(Activation Date) = Inactivation Date^Short Name
"RTN","ICPTAPIU",174,0)
 ;             Where the Short Name is the Versioned text (field 1 of the 61
"RTN","ICPTAPIU",175,0)
 ;             multiple), and the text is versioned as follows:
"RTN","ICPTAPIU",176,0)
 ; 
"RTN","ICPTAPIU",177,0)
 ;                Period is active - Versioned text for TODAY's date
"RTN","ICPTAPIU",178,0)
 ;                Period is inactive - Versioned text for inactivation date
"RTN","ICPTAPIU",179,0)
 ; 
"RTN","ICPTAPIU",180,0)
 ;            or
"RTN","ICPTAPIU",181,0)
 ; 
"RTN","ICPTAPIU",182,0)
 ;          -1^0 (no period or error)
"RTN","ICPTAPIU",183,0)
 ;        
"RTN","ICPTAPIU",184,0)
 I $G(CODE)="" S ARY(0)="-1^0" Q
"RTN","ICPTAPIU",185,0)
 N ICPTC,ICPTI,ICPTA,ICPTG,ICPTF,ICPTBA,ICPTBI,ICPTST,ICPTS,ICPTZ,ICPTV,ICPTN,ICPTCA
"RTN","ICPTAPIU",186,0)
 S ICPTG=$$GBL^ICPTSUPT(CODE) I ICPTG="" S ARY(0)="-1^0" Q
"RTN","ICPTAPIU",187,0)
 S ICPTC=$O(@(ICPTG_"""BA"","""_CODE_" "",0)")) I ICPTC="" S ARY(0)="-1^0" Q
"RTN","ICPTAPIU",188,0)
 S (ARY(0),ICPTC)=+ICPTC,ICPTZ=$G(@(ICPTG_ICPTC_",0)")),ICPTS=$P(ICPTZ,"^",2)
"RTN","ICPTAPIU",189,0)
 S $P(ARY(0),"^",2)=$S(ICPTG="^ICPT(":$P(ICPTZ,"^",6)'="L",1:$P(ICPTZ,"^",4)'="V")
"RTN","ICPTAPIU",190,0)
 S (ICPTA,ICPTBA)=0,ICPTG=ICPTG_ICPTC_",60,"
"RTN","ICPTAPIU",191,0)
 ; Versioned text for TODAY
"RTN","ICPTAPIU",192,0)
 S ICPTN=$$VST^ICPTCOD(ICPTC,$$DT^XLFDT,ICPTG)
"RTN","ICPTAPIU",193,0)
 F  Q:ICPTBA  D
"RTN","ICPTAPIU",194,0)
 . S ICPTA=$O(@(ICPTG_"""B"","_ICPTA_")"))
"RTN","ICPTAPIU",195,0)
 . I ICPTA="" S ICPTBA=1 Q
"RTN","ICPTAPIU",196,0)
 . S ICPTF=$O(@(ICPTG_"""B"","_ICPTA_",0)"))
"RTN","ICPTAPIU",197,0)
 . I '+ICPTF S ICPTBA=1 Q
"RTN","ICPTAPIU",198,0)
 . S ICPTST=$P($G(@(ICPTG_ICPTF_",0)")),"^",2)
"RTN","ICPTAPIU",199,0)
 . Q:'ICPTST  ;outer loop looks for active
"RTN","ICPTAPIU",200,0)
 . ; Versioned text for activation date
"RTN","ICPTAPIU",201,0)
 . S ICPTV=$$VST^ICPTCOD(ICPTC,ICPTA,ICPTG),ICPTCA=1
"RTN","ICPTAPIU",202,0)
 . S ARY(ICPTA)="^"_ICPTS,ICPTBI=0,ICPTI=ICPTA
"RTN","ICPTAPIU",203,0)
 . S:$L(ICPTV) $P(ARY(ICPTA),"^",2)=ICPTV
"RTN","ICPTAPIU",204,0)
 . F  Q:ICPTBI  D
"RTN","ICPTAPIU",205,0)
 . . S ICPTI=$O(@(ICPTG_"""B"","_ICPTI_")"))
"RTN","ICPTAPIU",206,0)
 . . ; If no inactivation date for ICPTA then use TODAY's text
"RTN","ICPTAPIU",207,0)
 . . I ICPTI="" S ARY(ICPTA)="^"_ICPTN,(ICPTBI,ICPTBA)=1 Q
"RTN","ICPTAPIU",208,0)
 . . S ICPTF=$O(@(ICPTG_"""B"","_ICPTI_",0)"))
"RTN","ICPTAPIU",209,0)
 . . ; If no effective date ICPTF for ICPTI then use TODAY's text
"RTN","ICPTAPIU",210,0)
 . . I '+ICPTF S ARY(ICPTA)="^"_ICPTN,(ICPTBI,ICPTBA)=1 Q
"RTN","ICPTAPIU",211,0)
 . . S ICPTST=$P($G(@(ICPTG_ICPTF_",0)")),"^",2)
"RTN","ICPTAPIU",212,0)
 . . ; If Status ICPTST not Inactive then use TODAY's text
"RTN","ICPTAPIU",213,0)
 . . I ICPTST S ARY(ICPTA)="^"_ICPTN,ICPTBI=1 Q
"RTN","ICPTAPIU",214,0)
 . . ; Versioned text for inactive date
"RTN","ICPTAPIU",215,0)
 . . S ICPTV=$$VST^ICPTCOD(ICPTC,ICPTI,ICPTG)
"RTN","ICPTAPIU",216,0)
 . . S $P(ARY(ICPTA),"^")=ICPTI
"RTN","ICPTAPIU",217,0)
 . . S:$L(ICPTV) $P(ARY(ICPTA),"^",2)=ICPTV
"RTN","ICPTAPIU",218,0)
 . . S ICPTCA=0,ICPTBI=1,ICPTA=ICPTI
"RTN","ICPTAPIU",219,0)
 Q
"RTN","ICPTAPIU",220,0)
 ;
"RTN","ICPTAPIU",221,0)
ACT(ICPTG,ICPTC,ICPTS,ICPTD) ; return "ACT" root
"RTN","ICPTAPIU",222,0)
 Q ICPTG_"""ACT"","""_ICPTC_" "","_ICPTS_","_ICPTD
"VER")
8.0^22.0
**END**
**END**
