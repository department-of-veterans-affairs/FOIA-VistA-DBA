Released QAN*2*31 SEQ #31
Extracted from mail message
**KIDS**:QAN*2.0*31^

**INSTALL NAME**
QAN*2.0*31
"BLD",4343,0)
QAN*2.0*31^INCIDENT REPORTING^0^3030826^y
"BLD",4343,1,0)
^^1^1^3030826^^
"BLD",4343,1,1,0)
Incident reports not printing.
"BLD",4343,4,0)
^9.64PA^^
"BLD",4343,"ABPKG")
n
"BLD",4343,"KRN",0)
^9.67PA^8989.52^19
"BLD",4343,"KRN",.4,0)
.4
"BLD",4343,"KRN",.401,0)
.401
"BLD",4343,"KRN",.402,0)
.402
"BLD",4343,"KRN",.403,0)
.403
"BLD",4343,"KRN",.5,0)
.5
"BLD",4343,"KRN",.84,0)
.84
"BLD",4343,"KRN",3.6,0)
3.6
"BLD",4343,"KRN",3.8,0)
3.8
"BLD",4343,"KRN",9.2,0)
9.2
"BLD",4343,"KRN",9.8,0)
9.8
"BLD",4343,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4343,"KRN",9.8,"NM",1,0)
QANPSDO^^0^B17724513
"BLD",4343,"KRN",9.8,"NM","B","QANPSDO",1)

"BLD",4343,"KRN",19,0)
19
"BLD",4343,"KRN",19.1,0)
19.1
"BLD",4343,"KRN",101,0)
101
"BLD",4343,"KRN",409.61,0)
409.61
"BLD",4343,"KRN",771,0)
771
"BLD",4343,"KRN",870,0)
870
"BLD",4343,"KRN",8989.51,0)
8989.51
"BLD",4343,"KRN",8989.52,0)
8989.52
"BLD",4343,"KRN",8994,0)
8994
"BLD",4343,"KRN","B",.4,.4)

"BLD",4343,"KRN","B",.401,.401)

"BLD",4343,"KRN","B",.402,.402)

"BLD",4343,"KRN","B",.403,.403)

"BLD",4343,"KRN","B",.5,.5)

"BLD",4343,"KRN","B",.84,.84)

"BLD",4343,"KRN","B",3.6,3.6)

"BLD",4343,"KRN","B",3.8,3.8)

"BLD",4343,"KRN","B",9.2,9.2)

"BLD",4343,"KRN","B",9.8,9.8)

"BLD",4343,"KRN","B",19,19)

"BLD",4343,"KRN","B",19.1,19.1)

"BLD",4343,"KRN","B",101,101)

"BLD",4343,"KRN","B",409.61,409.61)

"BLD",4343,"KRN","B",771,771)

"BLD",4343,"KRN","B",870,870)

"BLD",4343,"KRN","B",8989.51,8989.51)

"BLD",4343,"KRN","B",8989.52,8989.52)

"BLD",4343,"KRN","B",8994,8994)

"BLD",4343,"QUES",0)
^9.62^^
"BLD",4343,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",362,-1)
1^1
"PKG",362,0)
INCIDENT REPORTING^QAN^This package is designed to track a hospital incident.
"PKG",362,20,0)
^9.402P^^
"PKG",362,22,0)
^9.49I^1^1
"PKG",362,22,1,0)
2.0^2921015^2950914
"PKG",362,22,1,"PAH",1,0)
31^3030826
"PKG",362,22,1,"PAH",1,1,0)
^^1^1^3030826
"PKG",362,22,1,"PAH",1,1,1,0)
Incident reports not printing.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","QANPSDO")
0^1^B17724513
"RTN","QANPSDO",1,0)
QANPSDO ;HISC/GJC Pseudo VA 10-2633 ; 10/1/92
"RTN","QANPSDO",2,0)
 ;;2.0;Incident Reporting;**1,31**;08/07/1992
"RTN","QANPSDO",3,0)
 ;
"RTN","QANPSDO",4,0)
 ;CHOOSE PATIENT, THEN THE INCIDENT PUT INTO REPORT OPTION
"RTN","QANPSDO",5,0)
 ;***QANDFN IS FILE 742'S IEN ***:*** QANIEN IS FILE 742.4'S IEN ***
"RTN","QANPSDO",6,0)
PAT ;
"RTN","QANPSDO",7,0)
 S QANXIT=0 K DIR S DIR("A")="Do you wish to generate a blank 10-2633? "
"RTN","QANPSDO",8,0)
 S DIR(0)="YA",DIR("?")="Enter 'Y' for yes, 'N' for no."
"RTN","QANPSDO",9,0)
 D ^DIR K DIR G:$D(DIRUT)!($D(DIROUT)) KILL
"RTN","QANPSDO",10,0)
 S QANBLNK=+Y G:QANBLNK SETUP
"RTN","QANPSDO",11,0)
 K DIC S DIC="^QA(742,",DIC(0)="QEAMZ",DIC("A")="Select Patient: "
"RTN","QANPSDO",12,0)
 S DIC("S1")="I ""013""[+$P(^QA(742.4,+$P(^QA(742,+Y,0),U,3),0),U,8)"
"RTN","QANPSDO",13,0)
 S DIC("S2")="&('$D(^QA(742,""BPRS"",-1,+Y)))"
"RTN","QANPSDO",14,0)
 S DIC("S")=DIC("S1")_DIC("S2")
"RTN","QANPSDO",15,0)
 S DIC("W")="D DICW^QANUTL1",D="B^BS5" D MIX^DIC1 K D,DIC
"RTN","QANPSDO",16,0)
 I +Y=-1 S QANXIT=1 W !!,*7,"Patient not selected, exiting!!" G EXIT
"RTN","QANPSDO",17,0)
PAT1 W !?5,Y(0,0)_" OK" S %=1 D YN^DICN G:%=2 PAT
"RTN","QANPSDO",18,0)
 S:%<0 QANXIT=1 W:QANXIT !!,*7,"Patient not selected, exiting!!" G:QANXIT EXIT
"RTN","QANPSDO",19,0)
 I %=0 W !!,*7,"Enter ""Y""es if the patient choice is correct, ""N""o if the patient choice is ",!,"incorrect.",! G PAT
"RTN","QANPSDO",20,0)
 S QANDFN=+Y,QANIEN=$P(Y(0),U,3),QANAME=Y(0,0)
"RTN","QANPSDO",21,0)
 I '$D(QANIEN)!('$D(QANDFN)) W !!,*7,"Incomplete data, exiting the report." Q
"RTN","QANPSDO",22,0)
 S QAN742=$G(^QA(742,QANDFN,0)),QAN7424=$G(^QA(742.4,QANIEN,0)),QANPAT=$P(QAN742,U) Q:+QANPAT<1
"RTN","QANPSDO",23,0)
SETUP ;"Jump" here to set up vars for blank report, fall through for normal.
"RTN","QANPSDO",24,0)
 S QANHEAD="PATIENT INCIDENT WORKSHEET",PAGE=0,$P(QANEQ,"=",81)="",$P(QANEQ1,"-",81)="",QANFLAG=0
"RTN","QANPSDO",25,0)
TASK ;Task off to a device.
"RTN","QANPSDO",26,0)
 S Y=DT X ^DD("DD") S TODAY=Y,QANFIN=""
"RTN","QANPSDO",27,0)
 ;*** Choose device ***
"RTN","QANPSDO",28,0)
 K IOP,%ZIS S %ZIS("A")="Print on device: ",%ZIS="MQ" W ! D ^%ZIS W !!
"RTN","QANPSDO",29,0)
 G:POP KILL
"RTN","QANPSDO",30,0)
 I $D(IO("Q")) S ZTRTN="STRT^QANPSDO",ZTDESC="Generate Patient Incident Worksheet(s)." D QLOOP,^%ZTLOAD W !,$S($D(ZTSK):"Request queued!",1:"Request cancelled!"),! G EXIT
"RTN","QANPSDO",31,0)
STRT ;
"RTN","QANPSDO",32,0)
 U IO D HDR G:QANBLNK BLANK
"RTN","QANPSDO",33,0)
 S QANAME=$P($P(^DPT(QANPAT,0),U),",",2)_" "_$P($P(^DPT(QANPAT,0),U),","),QANPID=$P(QAN742,U,2),QANSSN=$E($P(^DPT(QANPAT,0),U,9),1,3)_"-"_$E($P(^DPT(QANPAT,0),U,9),4,5)_"-"_$E($P(^DPT(QANPAT,0),U,9),6,9),QANCASE=$P(QAN7424,U)
"RTN","QANPSDO",34,0)
 S QANDOB=$P(^DPT(QANPAT,0),U,3),X=DT,X1=X,X2=QANDOB,X="" D:+X2>0 ^%DTC S X=X\365.25,QANAGE=X K X,X1,X2,QANDOB
"RTN","QANPSDO",35,0)
 K C,Y S Y=$P(QAN742,U,4),C=$P(^DD(742,.04,0),U,2) D:Y]"" Y^DIQ S QANADMT=Y K C,Y
"RTN","QANPSDO",36,0)
 K C,Y S Y=$P(QAN742,U,6),C=$P(^DD(742,.06,0),U,2) D:Y]"" Y^DIQ S QANWARD=Y K C,Y
"RTN","QANPSDO",37,0)
 K C,Y S Y=$P(QAN742,U,8),C=$P(^DD(742,.08,0),U,2) D:Y]"" Y^DIQ S QANSERV=Y K C,Y
"RTN","QANPSDO",38,0)
 K C,Y S Y=$P(QAN7424,U,2),C=$P(^DD(742.4,.02,0),U,2) D:Y]"" Y^DIQ S QANINCD=Y K C,Y
"RTN","QANPSDO",39,0)
 K C,Y S Y=$P(QAN7424,U,11),C=$P(^DD(742.4,.12,0),U,2) D:Y]"" Y^DIQ S QANLREV=Y K C,Y
"RTN","QANPSDO",40,0)
 K C,Y S Y=$P(QAN7424,U,4),C=$P(^DD(742.4,.04,0),U,2) D:Y]"" Y^DIQ S QANILOC=Y K C,Y
"RTN","QANPSDO",41,0)
 K C,Y S Y=$P(QAN7424,U,9),C=$P(^DD(742.4,.1,0),U,2) D:Y]"" Y^DIQ S QANINIT=Y K C,Y
"RTN","QANPSDO",42,0)
 K C,Y S Y=$P(QAN7424,U,3),C=$P(^DD(742.4,.03,0),U,2) D:Y]"" Y^DIQ S QANDATE=Y K C,Y
"RTN","QANPSDO",43,0)
 K C,Y S Y=$P(QAN742,U,10),C=$P(^DD(742,.1,0),U,2) D:Y]"" Y^DIQ S QANSLVL=Y K C,Y
"RTN","QANPSDO",44,0)
 K C,Y S Y=$P(QAN7424,U,7),C=$P(^DD(742.4,.08,0),U,2) D:Y]"" Y^DIQ S QANWIT=Y K C,Y
"RTN","QANPSDO",45,0)
BLANK D ^QANPSD1 ; Do prints
"RTN","QANPSDO",46,0)
 I $E(IOST)'="C" F  W ! W:$Y>(IOSL-4) "VA Form 10-2633" Q:$Y>(IOSL-4)
"RTN","QANPSDO",47,0)
EXIT W ! D ^%ZISC,HOME^%ZIS
"RTN","QANPSDO",48,0)
KILL ;Kill and Quit
"RTN","QANPSDO",49,0)
 K %T,%W,%Y,DTOUT,DUOUT,DIROUT,DIRUT,QANBLNK,QANLNCT
"RTN","QANPSDO",50,0)
 K %,%ZIS,BA,C,D,DIC,DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,PAGE
"RTN","QANPSDO",51,0)
 K POP,QAN,QAN742,QAN7424,QANADMT,QANAGE,QANAME,QANCASE,QANDATE,QANDFN
"RTN","QANPSDO",52,0)
 K QANDOB,QANEQ,QANEQ1,QANFIN,QANFLAG,QANHEAD,QANIEN,QANILOC,QANINCD
"RTN","QANPSDO",53,0)
 K QANINIT,QANLBL,QANLREV,QANMN,QANPAT,QANPID,QANSERV,QANSLVL,QANSSN
"RTN","QANPSDO",54,0)
 K QANTYPE,QANWARD,QANWIT,QANXIT,QANXXX,TODAY,X,X1,X2,Y,Z,ZTDESC,ZTRTN
"RTN","QANPSDO",55,0)
 K X3,ZTSAVE,ZTSK
"RTN","QANPSDO",56,0)
 Q
"RTN","QANPSDO",57,0)
QLOOP ;
"RTN","QANPSDO",58,0)
 F BA="^UTILITY($J,","PAGE","TODAY","QAN*","QAQ*" S ZTSAVE(BA)=""
"RTN","QANPSDO",59,0)
 Q
"RTN","QANPSDO",60,0)
HDR ;Header generator.
"RTN","QANPSDO",61,0)
 I PAGE,($E(IOST)'="C") W !,"VA Form 10-2633"
"RTN","QANPSDO",62,0)
 S PAGE=PAGE+1 W @IOF,!?69,TODAY,!?69,"Page: ",PAGE,!!
"RTN","QANPSDO",63,0)
 W ?(IOM-$L(QANHEAD)\2),QANHEAD,!
"RTN","QANPSDO",64,0)
 ;D EN6^QAQAUTL
"RTN","QANPSDO",65,0)
 W QANEQ1,!,QANEQ1,!
"RTN","QANPSDO",66,0)
 W:$D(QANPID) !,"PATIENT ID: ",QANPID,!
"RTN","QANPSDO",67,0)
 W:QANFLAG&($D(QANLBL)) !?5,QANLBL_"(cont)"
"RTN","QANPSDO",68,0)
 Q
"RTN","QANPSDO",69,0)
HDH ;Check for end of screen.
"RTN","QANPSDO",70,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR K DIR S:+Y=0 QANFIN="^"
"RTN","QANPSDO",71,0)
 Q:QANFIN["^"  D HDR
"RTN","QANPSDO",72,0)
 Q
"VER")
8.0^22.0
**END**
**END**
