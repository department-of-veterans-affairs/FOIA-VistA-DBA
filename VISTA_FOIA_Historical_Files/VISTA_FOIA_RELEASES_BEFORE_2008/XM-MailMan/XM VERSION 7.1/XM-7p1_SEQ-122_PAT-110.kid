Released XM*7.1*110 SEQ #122
Extracted from mail message
**KIDS**:XM*7.1*110^

**INSTALL NAME**
XM*7.1*110
"BLD",204,0)
XM*7.1*110^MAILMAN^0^3000310^y
"BLD",204,1,0)
^^153^153^3000310^
"BLD",204,1,1,0)
Patch XM*7.1*110
"BLD",204,1,2,0)
 
"BLD",204,1,3,0)
NOIS:  ALN-1199-12259
"BLD",204,1,4,0)
Test Site:  Albany, NY
"BLD",204,1,5,0)
When you save a new message to a different basket, it updates the last message
"BLD",204,1,6,0)
arrival date, and MailMan may tell you that a new message arrived, when it
"BLD",204,1,7,0)
really didn't.  This patch fixes that.
"BLD",204,1,8,0)
 
"BLD",204,1,9,0)
NOIS:  DAY-0899-41718
"BLD",204,1,10,0)
Test Site:  Dayton, OH
"BLD",204,1,11,0)
Don't display user's DUZ when displaying a list of latered messages from which
"BLD",204,1,12,0)
to choose.
"BLD",204,1,13,0)
 
"BLD",204,1,14,0)
NOIS:  ISD-0200-71796
"BLD",204,1,15,0)
Test Site:  CIOFO-Dallas
"BLD",204,1,16,0)
If you copy a PackMan or KIDS message and send it "priority", MailMan might
"BLD",204,1,17,0)
not recognize the copy as a PackMan or KIDS message.  This patch fixes that.
"BLD",204,1,18,0)
 
"BLD",204,1,19,0)
NOIS:  TAM-0200-32595
"BLD",204,1,20,0)
Test Site:  Tampa, FL
"BLD",204,1,21,0)
The bulletin APIs SENDBULL^XMXAPI and TASKBULL^XMXAPI are changed so that
"BLD",204,1,22,0)
they don't insist on having XMBODY, which is an optional parameter.
"BLD",204,1,23,0)
 
"BLD",204,1,24,0)
NOIS:  WAS-1299-20453
"BLD",204,1,25,0)
Test Site:  Washington, DC
"BLD",204,1,26,0)
If a scrambled message with no hint is sent to a remote site, MailMan does
"BLD",204,1,27,0)
not recognize that it is scrambled.  This patch fixes that.
"BLD",204,1,28,0)
 
"BLD",204,1,29,0)
NOIS:  WBP-0100-21166
"BLD",204,1,30,0)
Test Site:  Wilkes Barre, PA
"BLD",204,1,31,0)
If you queue a range of messages to print later, and then delete the messages
"BLD",204,1,32,0)
you queued, MailMan won't print them.  This patch fixes that.
"BLD",204,1,33,0)
 
"BLD",204,1,34,0)
E3R 12092, 13084 - Provide "new toggle" command to make messages new if
"BLD",204,1,35,0)
they're not new, and make them not new if they're new.  The command is "NT".
"BLD",204,1,36,0)
Help frames have been updated to include the new command, and a new help
"BLD",204,1,37,0)
frame, XM-U-M-NEW-2, explains it.  New API: NTOGLMSG^XMXAPI
"BLD",204,1,38,0)
 
"BLD",204,1,39,0)
E3R 12169 - Provide a command to add the user's network signature to an
"BLD",204,1,40,0)
original message.  The command is "NS", and is available at the transmit
"BLD",204,1,41,0)
prompt when sending a new message.  It is also available when editing a
"BLD",204,1,42,0)
message sent only to oneself.  Help frames have been updated to include the
"BLD",204,1,43,0)
new command, and a new help frame, XM-U-M-NETWORK SIGNATURE, explains it.
"BLD",204,1,44,0)
New API: NETSIG^XMXEDIT
"BLD",204,1,45,0)
 
"BLD",204,1,46,0)
E3R 13400 - Upon return from ANSWER, COPY, or WRITE command, redisplay
"BLD",204,1,47,0)
message header to make it clear that you are back at original message. 
"BLD",204,1,48,0)
 
"BLD",204,1,49,0)
Additional enhancements:
"BLD",204,1,50,0)
- When editing a message the user has sent only to himself, the user may now
"BLD",204,1,51,0)
scramble or unscramble the message, and add his network signature to the
"BLD",204,1,52,0)
message, too.
"BLD",204,1,53,0)
- When answering a message, if the user doesn't have a network signature,
"BLD",204,1,54,0)
MailMan now asks the user if he would like to create one.
"BLD",204,1,55,0)
- Added entry and exit action to option XMEDITMG so that MailMan knows that
"BLD",204,1,56,0)
a user is interactively editing a mail group.
"BLD",204,1,57,0)
 
"BLD",204,1,58,0)
NOTE: This patch should be installed after hours, when user activity is at a
"BLD",204,1,59,0)
minimum.  It requires FileMan patch DI*22.0*17 and MailMan patches XM*7.1*72,
"BLD",204,1,60,0)
XM*7.1*79, XM*7.1*95, XM*7.1*100, XM*7.1*101, and XM*7.1*121.
"BLD",204,1,61,0)
============================================================================ 
"BLD",204,1,62,0)
 
"BLD",204,1,63,0)
ROUTINES:
"BLD",204,1,64,0)
The second line of the routine now looks like:
"BLD",204,1,65,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",204,1,66,0)
 
"BLD",204,1,67,0)
              Before          After
"BLD",204,1,68,0)
Name          Checksum        Checksum        Patch List
"BLD",204,1,69,0)
--------------------------------------------------------------
"BLD",204,1,70,0)
XMA0            585506          305822        15,36,50,107,110
"BLD",204,1,71,0)
XMA2R          3921855         3986868        27,50,105,107,110
"BLD",204,1,72,0)
XMJBM         12165199        10706426        50,110
"BLD",204,1,73,0)
XMJDIR         2003843         5974273        50,110
"BLD",204,1,74,0)
XMJMA          2991838         3663986        50,110
"BLD",204,1,75,0)
XMJMC          8264139         9725999        50,79,110
"BLD",204,1,76,0)
XMJMCODE      11042686        11817911        50,110
"BLD",204,1,77,0)
XMJMD          7370688         9220624        50,104,110
"BLD",204,1,78,0)
XMJMFA         6204287         6600695        50,110
"BLD",204,1,79,0)
XMJMFB        15137131        15590623        50,110
"BLD",204,1,80,0)
XMJMLN        13240819        13840736        50,110
"BLD",204,1,81,0)
XMJMLR        13545823        14100278        50,110
"BLD",204,1,82,0)
XMJMLR1        7836320         6891665        50,72,110
"BLD",204,1,83,0)
XMJMOI        17103064        16677374        50,87,89,110
"BLD",204,1,84,0)
XMJMOI1        * NEW *         3117776        110
"BLD",204,1,85,0)
XMJMOIE        4582157         2143008        50,110
"BLD",204,1,86,0)
XMJMOR        14209869        13211462        50,75,110
"BLD",204,1,87,0)
XMJMORX       14790879        14207041        50,110
"BLD",204,1,88,0)
XMJMORX1       2472219         2575833        50,110
"BLD",204,1,89,0)
XMJMP         16560016        13553026        50,75,100,110
"BLD",204,1,90,0)
XMJMP1        14502445        16386050        40,50,75,110
"BLD",204,1,91,0)
XMJMP2         * NEW *         2711990        110
"BLD",204,1,92,0)
XMJMQ         16042167        15891582        40,57,70,50,96,110
"BLD",204,1,93,0)
XMJMQ1         3608941         7395902        40,50,110
"BLD",204,1,94,0)
XMJMRO         2478663         4304954        50,89,110
"BLD",204,1,95,0)
XMJMSO        12952439         7280605        50,110
"BLD",204,1,96,0)
XMTDO          2076731         1653155        50,107,121,110
"BLD",204,1,97,0)
XMVVITA        4257402         4785601        50,101,110
"BLD",204,1,98,0)
XMXANSER       2242310         1893573        50,110
"BLD",204,1,99,0)
XMXAPI         6705900         6992361        50,110
"BLD",204,1,100,0)
XMXEDIT        3880586         7247978        50,110
"BLD",204,1,101,0)
XMXMSGS       10966038         9819629        50,110
"BLD",204,1,102,0)
XMXMSGS2       6491081         7686410        50,106,110
"BLD",204,1,103,0)
XMXSEC        18599731        21173851        50,110
"BLD",204,1,104,0)
XMXSEC1       13791136        11938650        50,95,110
"BLD",204,1,105,0)
XMXSEC2       21310509        27323685        50,89,95,110
"BLD",204,1,106,0)
XMXSEC3        * NEW *         4290614        110
"BLD",204,1,107,0)
 
"BLD",204,1,108,0)
* Checksums produced by CHECK^XTSUMBLD
"BLD",204,1,109,0)
 
"BLD",204,1,110,0)
This patch introduces the following new routines:
"BLD",204,1,111,0)
 
"BLD",204,1,112,0)
Routine      Callable at     Description
"BLD",204,1,113,0)
---------------------------------------------------------------------------
"BLD",204,1,114,0)
XMJMOI1      N/A
"BLD",204,1,115,0)
XMJMP2       N/A
"BLD",204,1,116,0)
XMXSEC3      N/A
"BLD",204,1,117,0)
===========================================================================
"BLD",204,1,118,0)
 
"BLD",204,1,119,0)
INSTALLATION:
"BLD",204,1,120,0)
NOTE: This patch should be installed after hours, when user activity is at a
"BLD",204,1,121,0)
minimum.  It requires FileMan patch DI*22.0*17 and MailMan patches XM*7.1*72,
"BLD",204,1,122,0)
XM*7.1*79, XM*7.1*95, XM*7.1*100, XM*7.1*101, and XM*7.1*121.
"BLD",204,1,123,0)
1.  Users may be on the system during patch installation.
"BLD",204,1,124,0)
2.  DSM Sites: If any of these routines is mapped, disable mapping for the 
"BLD",204,1,125,0)
    affected routine(s).  
"BLD",204,1,126,0)
3.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads 
"BLD",204,1,127,0)
    the patch into a Transport Global on your system.  
"BLD",204,1,128,0)
4.  You do not need to stop TaskMan or the background filer.  Users may be
"BLD",204,1,129,0)
    on the system.
"BLD",204,1,130,0)
5.  On the KIDS:Installation menu, use the following options to install the
"BLD",204,1,131,0)
    Transport Global:
"BLD",204,1,132,0)
       Verify Checksums in Transport Global
"BLD",204,1,133,0)
       Print Transport Global
"BLD",204,1,134,0)
       Compare Transport Global to Current System
"BLD",204,1,135,0)
       Backup a Transport Global
"BLD",204,1,136,0)
       Install Package(s)
"BLD",204,1,137,0)
 Select INSTALL NAME:    XM*7.1*110    Loaded from Distribution  <date/time>
"BLD",204,1,138,0)
                         ==========
"BLD",204,1,139,0)
 Install Questions:
"BLD",204,1,140,0)
 Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// YES
"BLD",204,1,141,0)
                                                                   ===
"BLD",204,1,142,0)
 Want KIDS to INHIBIT LOGONs during the install? YES// NO
"BLD",204,1,143,0)
                                                       ==
"BLD",204,1,144,0)
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"BLD",204,1,145,0)
                                                                       ==
"BLD",204,1,146,0)
 Enter the Device you want to print the Install messages.
"BLD",204,1,147,0)
 You can queue the install by enter a 'Q' at the device prompt.
"BLD",204,1,148,0)
 Enter a '^' to abort the install.
"BLD",204,1,149,0)
 
"BLD",204,1,150,0)
 DEVICE: HOME// <It's up to you.  You may queue it if you wish.>
"BLD",204,1,151,0)
                ------------------------------------------------
"BLD",204,1,152,0)
6.  DSM Sites: After patch has installed, rebuild your map set, if necessary.
"BLD",204,1,153,0)
===========================================================================
"BLD",204,4,0)
^9.64PA^^
"BLD",204,"ABPKG")
n
"BLD",204,"INI")

"BLD",204,"INID")
^^
"BLD",204,"KRN",0)
^9.67PA^19^15
"BLD",204,"KRN",.4,0)
.4
"BLD",204,"KRN",.4,"NM",0)
^9.68A^^
"BLD",204,"KRN",.401,0)
.401
"BLD",204,"KRN",.402,0)
.402
"BLD",204,"KRN",.403,0)
.403
"BLD",204,"KRN",.5,0)
.5
"BLD",204,"KRN",.84,0)
.84
"BLD",204,"KRN",.84,"NM",0)
^9.68A^393^388
"BLD",204,"KRN",.84,"NM",1,0)
34015^^0
"BLD",204,"KRN",.84,"NM",2,0)
34016^^0
"BLD",204,"KRN",.84,"NM",3,0)
34017^^0
"BLD",204,"KRN",.84,"NM",4,0)
34018^^0
"BLD",204,"KRN",.84,"NM",5,0)
34020^^0
"BLD",204,"KRN",.84,"NM",6,0)
34021^^0
"BLD",204,"KRN",.84,"NM",7,0)
34030^^0
"BLD",204,"KRN",.84,"NM",8,0)
34031^^0
"BLD",204,"KRN",.84,"NM",9,0)
34032^^0
"BLD",204,"KRN",.84,"NM",10,0)
34034^^0
"BLD",204,"KRN",.84,"NM",11,0)
34035^^0
"BLD",204,"KRN",.84,"NM",12,0)
34050^^0
"BLD",204,"KRN",.84,"NM",13,0)
34051^^0
"BLD",204,"KRN",.84,"NM",14,0)
34051.1^^0
"BLD",204,"KRN",.84,"NM",15,0)
34052^^0
"BLD",204,"KRN",.84,"NM",16,0)
34053^^0
"BLD",204,"KRN",.84,"NM",17,0)
34054^^0
"BLD",204,"KRN",.84,"NM",18,0)
34055^^0
"BLD",204,"KRN",.84,"NM",19,0)
34056^^0
"BLD",204,"KRN",.84,"NM",20,0)
34057^^0
"BLD",204,"KRN",.84,"NM",21,0)
34058^^0
"BLD",204,"KRN",.84,"NM",22,0)
34059^^0
"BLD",204,"KRN",.84,"NM",23,0)
34060^^0
"BLD",204,"KRN",.84,"NM",24,0)
34061^^0
"BLD",204,"KRN",.84,"NM",25,0)
34065^^0
"BLD",204,"KRN",.84,"NM",26,0)
34066^^0
"BLD",204,"KRN",.84,"NM",27,0)
34067^^0
"BLD",204,"KRN",.84,"NM",28,0)
34070^^0
"BLD",204,"KRN",.84,"NM",29,0)
34071^^0
"BLD",204,"KRN",.84,"NM",30,0)
34072^^0
"BLD",204,"KRN",.84,"NM",31,0)
34075^^0
"BLD",204,"KRN",.84,"NM",32,0)
34076^^0
"BLD",204,"KRN",.84,"NM",33,0)
34077^^0
"BLD",204,"KRN",.84,"NM",34,0)
34078^^0
"BLD",204,"KRN",.84,"NM",35,0)
34079^^0
"BLD",204,"KRN",.84,"NM",36,0)
34081^^0
"BLD",204,"KRN",.84,"NM",37,0)
34082^^0
"BLD",204,"KRN",.84,"NM",38,0)
34216^^0
"BLD",204,"KRN",.84,"NM",39,0)
34217^^0
"BLD",204,"KRN",.84,"NM",40,0)
34301^^0
"BLD",204,"KRN",.84,"NM",41,0)
34302^^0
"BLD",204,"KRN",.84,"NM",42,0)
34303^^0
"BLD",204,"KRN",.84,"NM",43,0)
34305^^0
"BLD",204,"KRN",.84,"NM",44,0)
34306^^0
"BLD",204,"KRN",.84,"NM",45,0)
34306.1^^0
"BLD",204,"KRN",.84,"NM",46,0)
34308^^0
"BLD",204,"KRN",.84,"NM",47,0)
34309^^0
"BLD",204,"KRN",.84,"NM",48,0)
34309.1^^0
"BLD",204,"KRN",.84,"NM",49,0)
34309.2^^0
"BLD",204,"KRN",.84,"NM",50,0)
34309.3^^0
"BLD",204,"KRN",.84,"NM",51,0)
34311^^0
"BLD",204,"KRN",.84,"NM",52,0)
34312^^0
"BLD",204,"KRN",.84,"NM",53,0)
34312.1^^0
"BLD",204,"KRN",.84,"NM",54,0)
34314^^0
"BLD",204,"KRN",.84,"NM",55,0)
34315^^0
"BLD",204,"KRN",.84,"NM",56,0)
34315.1^^0
"BLD",204,"KRN",.84,"NM",57,0)
34317^^0
"BLD",204,"KRN",.84,"NM",58,0)
34317.1^^0
"BLD",204,"KRN",.84,"NM",59,0)
34318^^0
"BLD",204,"KRN",.84,"NM",60,0)
34318.1^^0
"BLD",204,"KRN",.84,"NM",61,0)
34318.2^^0
"BLD",204,"KRN",.84,"NM",62,0)
34318.3^^0
"BLD",204,"KRN",.84,"NM",63,0)
34318.4^^0
"BLD",204,"KRN",.84,"NM",64,0)
34319^^0
"BLD",204,"KRN",.84,"NM",65,0)
34320^^0
"BLD",204,"KRN",.84,"NM",66,0)
34320.1^^0
"BLD",204,"KRN",.84,"NM",67,0)
34321^^0
"BLD",204,"KRN",.84,"NM",68,0)
34323^^0
"BLD",204,"KRN",.84,"NM",69,0)
34324^^0
"BLD",204,"KRN",.84,"NM",70,0)
34324.1^^0
"BLD",204,"KRN",.84,"NM",71,0)
34324.2^^0
"BLD",204,"KRN",.84,"NM",72,0)
34324.3^^0
"BLD",204,"KRN",.84,"NM",73,0)
34325^^0
"BLD",204,"KRN",.84,"NM",74,0)
34325.1^^0
"BLD",204,"KRN",.84,"NM",75,0)
34325.9^^0
"BLD",204,"KRN",.84,"NM",76,0)
34326^^0
"BLD",204,"KRN",.84,"NM",77,0)
34326.1^^0
"BLD",204,"KRN",.84,"NM",78,0)
34328^^0
"BLD",204,"KRN",.84,"NM",79,0)
34329^^0
"BLD",204,"KRN",.84,"NM",80,0)
34329.1^^0
"BLD",204,"KRN",.84,"NM",81,0)
34330^^0
"BLD",204,"KRN",.84,"NM",82,0)
34330.1^^0
"BLD",204,"KRN",.84,"NM",83,0)
34331^^0
"BLD",204,"KRN",.84,"NM",84,0)
34331.1^^0
"BLD",204,"KRN",.84,"NM",85,0)
34333^^0
"BLD",204,"KRN",.84,"NM",86,0)
34334^^0
"BLD",204,"KRN",.84,"NM",87,0)
34334.1^^0
"BLD",204,"KRN",.84,"NM",88,0)
34335^^0
"BLD",204,"KRN",.84,"NM",89,0)
34335.1^^0
"BLD",204,"KRN",.84,"NM",90,0)
34350^^0
"BLD",204,"KRN",.84,"NM",92,0)
34352^^0
"BLD",204,"KRN",.84,"NM",93,0)
34353^^0
"BLD",204,"KRN",.84,"NM",94,0)
34401^^0
"BLD",204,"KRN",.84,"NM",95,0)
34402^^0
"BLD",204,"KRN",.84,"NM",96,0)
34500^^0
"BLD",204,"KRN",.84,"NM",97,0)
34501^^0
"BLD",204,"KRN",.84,"NM",98,0)
34502^^0
"BLD",204,"KRN",.84,"NM",99,0)
34503^^0
"BLD",204,"KRN",.84,"NM",100,0)
34504^^0
"BLD",204,"KRN",.84,"NM",101,0)
34505^^0
"BLD",204,"KRN",.84,"NM",102,0)
34506^^0
"BLD",204,"KRN",.84,"NM",103,0)
34507^^0
"BLD",204,"KRN",.84,"NM",104,0)
34508^^0
"BLD",204,"KRN",.84,"NM",105,0)
34510^^0
"BLD",204,"KRN",.84,"NM",106,0)
34511^^0
"BLD",204,"KRN",.84,"NM",107,0)
34512^^0
"BLD",204,"KRN",.84,"NM",108,0)
34513^^0
"BLD",204,"KRN",.84,"NM",109,0)
34514^^0
"BLD",204,"KRN",.84,"NM",110,0)
34515^^0
"BLD",204,"KRN",.84,"NM",111,0)
34516^^0
"BLD",204,"KRN",.84,"NM",112,0)
34518^^0
"BLD",204,"KRN",.84,"NM",113,0)
34519^^0
"BLD",204,"KRN",.84,"NM",114,0)
34520^^0
"BLD",204,"KRN",.84,"NM",115,0)
34521^^0
"BLD",204,"KRN",.84,"NM",116,0)
34530^^0
"BLD",204,"KRN",.84,"NM",117,0)
34531^^0
"BLD",204,"KRN",.84,"NM",118,0)
34532^^0
"BLD",204,"KRN",.84,"NM",119,0)
34533^^0
"BLD",204,"KRN",.84,"NM",120,0)
34534^^0
"BLD",204,"KRN",.84,"NM",121,0)
34536^^0
"BLD",204,"KRN",.84,"NM",122,0)
34537^^0
"BLD",204,"KRN",.84,"NM",123,0)
34538^^0
"BLD",204,"KRN",.84,"NM",124,0)
34539^^0
"BLD",204,"KRN",.84,"NM",125,0)
34534.1^^0
"BLD",204,"KRN",.84,"NM",126,0)
34540^^0
"BLD",204,"KRN",.84,"NM",127,0)
34541^^0
"BLD",204,"KRN",.84,"NM",128,0)
34542^^0
"BLD",204,"KRN",.84,"NM",129,0)
34543^^0
"BLD",204,"KRN",.84,"NM",130,0)
34544^^0
"BLD",204,"KRN",.84,"NM",131,0)
34545^^0
"BLD",204,"KRN",.84,"NM",132,0)
34546^^0
"BLD",204,"KRN",.84,"NM",133,0)
34550^^0
"BLD",204,"KRN",.84,"NM",134,0)
34551^^0
"BLD",204,"KRN",.84,"NM",135,0)
34552^^0
"BLD",204,"KRN",.84,"NM",136,0)
34554^^0
"BLD",204,"KRN",.84,"NM",137,0)
34555^^0
"BLD",204,"KRN",.84,"NM",138,0)
34556^^0
"BLD",204,"KRN",.84,"NM",139,0)
34557^^0
"BLD",204,"KRN",.84,"NM",140,0)
34557.1^^0
"BLD",204,"KRN",.84,"NM",141,0)
34559^^0
"BLD",204,"KRN",.84,"NM",142,0)
34560^^0
"BLD",204,"KRN",.84,"NM",143,0)
34561^^0
"BLD",204,"KRN",.84,"NM",144,0)
34562^^0
"BLD",204,"KRN",.84,"NM",145,0)
34562.1^^0
"BLD",204,"KRN",.84,"NM",146,0)
34564^^0
"BLD",204,"KRN",.84,"NM",147,0)
34565^^0
"BLD",204,"KRN",.84,"NM",148,0)
34566^^0
"BLD",204,"KRN",.84,"NM",149,0)
34567^^0
"BLD",204,"KRN",.84,"NM",150,0)
34568^^0
"BLD",204,"KRN",.84,"NM",151,0)
34570^^0
"BLD",204,"KRN",.84,"NM",152,0)
34571^^0
"BLD",204,"KRN",.84,"NM",153,0)
34572^^0
"BLD",204,"KRN",.84,"NM",154,0)
34573^^0
"BLD",204,"KRN",.84,"NM",155,0)
34574^^0
"BLD",204,"KRN",.84,"NM",156,0)
34575^^0
"BLD",204,"KRN",.84,"NM",157,0)
34576^^0
"BLD",204,"KRN",.84,"NM",158,0)
34577^^0
"BLD",204,"KRN",.84,"NM",159,0)
34578^^0
"BLD",204,"KRN",.84,"NM",160,0)
34580^^0
"BLD",204,"KRN",.84,"NM",161,0)
34581^^0
"BLD",204,"KRN",.84,"NM",162,0)
34582^^0
"BLD",204,"KRN",.84,"NM",163,0)
34583^^0
"BLD",204,"KRN",.84,"NM",164,0)
34584^^0
"BLD",204,"KRN",.84,"NM",165,0)
34585^^0
"BLD",204,"KRN",.84,"NM",166,0)
34586^^0
"BLD",204,"KRN",.84,"NM",167,0)
34587^^0
"BLD",204,"KRN",.84,"NM",168,0)
34588^^0
"BLD",204,"KRN",.84,"NM",169,0)
34590^^0
"BLD",204,"KRN",.84,"NM",170,0)
34591^^0
"BLD",204,"KRN",.84,"NM",171,0)
34592^^0
"BLD",204,"KRN",.84,"NM",172,0)
34593^^0
"BLD",204,"KRN",.84,"NM",173,0)
34595^^0
"BLD",204,"KRN",.84,"NM",174,0)
34596^^0
"BLD",204,"KRN",.84,"NM",175,0)
34597^^0
"BLD",204,"KRN",.84,"NM",176,0)
34598^^0
"BLD",204,"KRN",.84,"NM",177,0)
34600^^0
"BLD",204,"KRN",.84,"NM",178,0)
34601^^0
"BLD",204,"KRN",.84,"NM",179,0)
34602^^0
"BLD",204,"KRN",.84,"NM",180,0)
34603^^0
"BLD",204,"KRN",.84,"NM",181,0)
34604^^0
"BLD",204,"KRN",.84,"NM",182,0)
34605^^0
"BLD",204,"KRN",.84,"NM",183,0)
34606^^0
"BLD",204,"KRN",.84,"NM",184,0)
34607^^0
"BLD",204,"KRN",.84,"NM",185,0)
34608^^0
"BLD",204,"KRN",.84,"NM",186,0)
34610^^0
"BLD",204,"KRN",.84,"NM",187,0)
34611^^0
"BLD",204,"KRN",.84,"NM",188,0)
34612^^0
"BLD",204,"KRN",.84,"NM",189,0)
34615^^0
"BLD",204,"KRN",.84,"NM",190,0)
34616^^0
"BLD",204,"KRN",.84,"NM",191,0)
34617^^0
"BLD",204,"KRN",.84,"NM",192,0)
34618^^0
"BLD",204,"KRN",.84,"NM",193,0)
34619^^0
"BLD",204,"KRN",.84,"NM",194,0)
34620^^0
"BLD",204,"KRN",.84,"NM",195,0)
34621^^0
"BLD",204,"KRN",.84,"NM",196,0)
34622^^0
"BLD",204,"KRN",.84,"NM",197,0)
34623^^0
"BLD",204,"KRN",.84,"NM",198,0)
34630^^0
"BLD",204,"KRN",.84,"NM",199,0)
34631^^0
"BLD",204,"KRN",.84,"NM",200,0)
34632^^0
"BLD",204,"KRN",.84,"NM",201,0)
34633^^0
"BLD",204,"KRN",.84,"NM",202,0)
34634^^0
"BLD",204,"KRN",.84,"NM",203,0)
34635^^0
"BLD",204,"KRN",.84,"NM",204,0)
34636^^0
"BLD",204,"KRN",.84,"NM",205,0)
34635.1^^0
"BLD",204,"KRN",.84,"NM",206,0)
34636.1^^0
"BLD",204,"KRN",.84,"NM",207,0)
34637^^0
"BLD",204,"KRN",.84,"NM",208,0)
34638^^0
"BLD",204,"KRN",.84,"NM",209,0)
34639^^0
"BLD",204,"KRN",.84,"NM",210,0)
37100^^0
"BLD",204,"KRN",.84,"NM",211,0)
37101^^0
"BLD",204,"KRN",.84,"NM",212,0)
37102^^0
"BLD",204,"KRN",.84,"NM",213,0)
37201^^0
"BLD",204,"KRN",.84,"NM",214,0)
37201.1^^0
"BLD",204,"KRN",.84,"NM",215,0)
37201.2^^0
"BLD",204,"KRN",.84,"NM",216,0)
37202^^0
"BLD",204,"KRN",.84,"NM",217,0)
37203^^0
"BLD",204,"KRN",.84,"NM",218,0)
37204^^0
"BLD",204,"KRN",.84,"NM",219,0)
37204.1^^0
"BLD",204,"KRN",.84,"NM",220,0)
37204.2^^0
"BLD",204,"KRN",.84,"NM",221,0)
37205^^0
"BLD",204,"KRN",.84,"NM",222,0)
37206^^0
"BLD",204,"KRN",.84,"NM",223,0)
37207^^0
"BLD",204,"KRN",.84,"NM",224,0)
37208^^0
"BLD",204,"KRN",.84,"NM",225,0)
37209^^0
"BLD",204,"KRN",.84,"NM",226,0)
37211^^0
"BLD",204,"KRN",.84,"NM",227,0)
37212^^0
"BLD",204,"KRN",.84,"NM",228,0)
37213^^0
"BLD",204,"KRN",.84,"NM",229,0)
37214^^0
"BLD",204,"KRN",.84,"NM",230,0)
37219^^0
"BLD",204,"KRN",.84,"NM",231,0)
37221^^0
"BLD",204,"KRN",.84,"NM",232,0)
37222^^0
"BLD",204,"KRN",.84,"NM",233,0)
37223^^0
"BLD",204,"KRN",.84,"NM",234,0)
37231^^0
"BLD",204,"KRN",.84,"NM",235,0)
37232^^0
"BLD",204,"KRN",.84,"NM",236,0)
37241^^0
"BLD",204,"KRN",.84,"NM",237,0)
37251^^0
"BLD",204,"KRN",.84,"NM",238,0)
37261^^0
"BLD",204,"KRN",.84,"NM",239,0)
37301^^0
"BLD",204,"KRN",.84,"NM",240,0)
37301.6^^0
"BLD",204,"KRN",.84,"NM",241,0)
37301.9^^0
"BLD",204,"KRN",.84,"NM",242,0)
37303^^0
"BLD",204,"KRN",.84,"NM",243,0)
37303.1^^0
"BLD",204,"KRN",.84,"NM",244,0)
37303.2^^0
"BLD",204,"KRN",.84,"NM",245,0)
37303.9^^0
"BLD",204,"KRN",.84,"NM",246,0)
37304^^0
"BLD",204,"KRN",.84,"NM",247,0)
37305^^0
"BLD",204,"KRN",.84,"NM",248,0)
37306^^0
"BLD",204,"KRN",.84,"NM",249,0)
37306.1^^0
"BLD",204,"KRN",.84,"NM",250,0)
37306.2^^0
"BLD",204,"KRN",.84,"NM",251,0)
37307^^0
"BLD",204,"KRN",.84,"NM",252,0)
37307.9^^0
"BLD",204,"KRN",.84,"NM",253,0)
37308^^0
"BLD",204,"KRN",.84,"NM",254,0)
37308.9^^0
"BLD",204,"KRN",.84,"NM",255,0)
37309^^0
"BLD",204,"KRN",.84,"NM",256,0)
37309.1^^0
"BLD",204,"KRN",.84,"NM",257,0)
37309.2^^0
"BLD",204,"KRN",.84,"NM",258,0)
37309.3^^0
"BLD",204,"KRN",.84,"NM",259,0)
37309.4^^0
"BLD",204,"KRN",.84,"NM",260,0)
37309.5^^0
"BLD",204,"KRN",.84,"NM",261,0)
37309.9^^0
"BLD",204,"KRN",.84,"NM",262,0)
37311^^0
"BLD",204,"KRN",.84,"NM",263,0)
37311.9^^0
"BLD",204,"KRN",.84,"NM",264,0)
37312^^0
"BLD",204,"KRN",.84,"NM",265,0)
37312.9^^0
"BLD",204,"KRN",.84,"NM",266,0)
37313^^0
"BLD",204,"KRN",.84,"NM",267,0)
37313.9^^0
"BLD",204,"KRN",.84,"NM",268,0)
37314^^0
"BLD",204,"KRN",.84,"NM",269,0)
37314.9^^0
"BLD",204,"KRN",.84,"NM",270,0)
37315^^0
"BLD",204,"KRN",.84,"NM",271,0)
37315.4^^0
"BLD",204,"KRN",.84,"NM",272,0)
37315.8^^0
"BLD",204,"KRN",.84,"NM",273,0)
37315.9^^0
"BLD",204,"KRN",.84,"NM",274,0)
37316^^0
"BLD",204,"KRN",.84,"NM",275,0)
37316.8^^0
"BLD",204,"KRN",.84,"NM",276,0)
37316.9^^0
"BLD",204,"KRN",.84,"NM",277,0)
37317^^0
"BLD",204,"KRN",.84,"NM",278,0)
37317.1^^0
"BLD",204,"KRN",.84,"NM",279,0)
37317.9^^0
"BLD",204,"KRN",.84,"NM",280,0)
37318^^0
"BLD",204,"KRN",.84,"NM",281,0)
37318.9^^0
"BLD",204,"KRN",.84,"NM",282,0)
37319^^0
"BLD",204,"KRN",.84,"NM",283,0)
37319.9^^0
"BLD",204,"KRN",.84,"NM",284,0)
37320^^0
"BLD",204,"KRN",.84,"NM",285,0)
37320.6^^0
"BLD",204,"KRN",.84,"NM",286,0)
37320.9^^0
"BLD",204,"KRN",.84,"NM",287,0)
37331^^0
"BLD",204,"KRN",.84,"NM",288,0)
37332^^0
"BLD",204,"KRN",.84,"NM",289,0)
37333^^0
"BLD",204,"KRN",.84,"NM",290,0)
37333.1^^0
"BLD",204,"KRN",.84,"NM",291,0)
37333.2^^0
"BLD",204,"KRN",.84,"NM",292,0)
37333.8^^0
"BLD",204,"KRN",.84,"NM",293,0)
37333.9^^0
"BLD",204,"KRN",.84,"NM",294,0)
37334^^0
"BLD",204,"KRN",.84,"NM",295,0)
37341^^0
"BLD",204,"KRN",.84,"NM",296,0)
37342^^0
"BLD",204,"KRN",.84,"NM",297,0)
37401^^0
"BLD",204,"KRN",.84,"NM",298,0)
37401.1^^0
"BLD",204,"KRN",.84,"NM",299,0)
37401.2^^0
"BLD",204,"KRN",.84,"NM",300,0)
37401.3^^0
"BLD",204,"KRN",.84,"NM",301,0)
37401.4^^0
"BLD",204,"KRN",.84,"NM",302,0)
37401.5^^0
"BLD",204,"KRN",.84,"NM",303,0)
37402^^0
"BLD",204,"KRN",.84,"NM",304,0)
37402.1^^0
"BLD",204,"KRN",.84,"NM",305,0)
37403^^0
"BLD",204,"KRN",.84,"NM",306,0)
37403.1^^0
"BLD",204,"KRN",.84,"NM",307,0)
37403.2^^0
"BLD",204,"KRN",.84,"NM",308,0)
37403.4^^0
"BLD",204,"KRN",.84,"NM",309,0)
37403.5^^0
"BLD",204,"KRN",.84,"NM",310,0)
37403.6^^0
"BLD",204,"KRN",.84,"NM",311,0)
37404^^0
"BLD",204,"KRN",.84,"NM",312,0)
37404.1^^0
"BLD",204,"KRN",.84,"NM",313,0)
37404.5^^0
"BLD",204,"KRN",.84,"NM",314,0)
37405^^0
"BLD",204,"KRN",.84,"NM",315,0)
37405.1^^0
"BLD",204,"KRN",.84,"NM",316,0)
37405.2^^0
"BLD",204,"KRN",.84,"NM",317,0)
37405.3^^0
"BLD",204,"KRN",.84,"NM",318,0)
37405.4^^0
"BLD",204,"KRN",.84,"NM",319,0)
37406^^0
"BLD",204,"KRN",.84,"NM",320,0)
37406.1^^0
"BLD",204,"KRN",.84,"NM",321,0)
37406.6^^0
"BLD",204,"KRN",.84,"NM",322,0)
37407^^0
"BLD",204,"KRN",.84,"NM",323,0)
37408^^0
"BLD",204,"KRN",.84,"NM",324,0)
37409^^0
"BLD",204,"KRN",.84,"NM",325,0)
37409.9^^0
"BLD",204,"KRN",.84,"NM",326,0)
37408.9^^0
"BLD",204,"KRN",.84,"NM",327,0)
37409.1^^0
"BLD",204,"KRN",.84,"NM",328,0)
37409.5^^0
"BLD",204,"KRN",.84,"NM",329,0)
37411^^0
"BLD",204,"KRN",.84,"NM",330,0)
37411.9^^0
"BLD",204,"KRN",.84,"NM",331,0)
37412^^0
"BLD",204,"KRN",.84,"NM",332,0)
37412.1^^0
"BLD",204,"KRN",.84,"NM",333,0)
37412.9^^0
"BLD",204,"KRN",.84,"NM",334,0)
37413^^0
"BLD",204,"KRN",.84,"NM",335,0)
37414^^0
"BLD",204,"KRN",.84,"NM",336,0)
37414.9^^0
"BLD",204,"KRN",.84,"NM",337,0)
37415^^0
"BLD",204,"KRN",.84,"NM",338,0)
37415.9^^0
"BLD",204,"KRN",.84,"NM",339,0)
37416^^0
"BLD",204,"KRN",.84,"NM",340,0)
37416.4^^0
"BLD",204,"KRN",.84,"NM",341,0)
37417^^0
"BLD",204,"KRN",.84,"NM",342,0)
37418^^0
"BLD",204,"KRN",.84,"NM",343,0)
37419^^0
"BLD",204,"KRN",.84,"NM",344,0)
37420^^0
"BLD",204,"KRN",.84,"NM",345,0)
37420.1^^0
"BLD",204,"KRN",.84,"NM",346,0)
37422^^0
"BLD",204,"KRN",.84,"NM",347,0)
37422.1^^0
"BLD",204,"KRN",.84,"NM",348,0)
37422.2^^0
"BLD",204,"KRN",.84,"NM",349,0)
37422.4^^0
"BLD",204,"KRN",.84,"NM",350,0)
37422.5^^0
"BLD",204,"KRN",.84,"NM",351,0)
37422.6^^0
"BLD",204,"KRN",.84,"NM",352,0)
37423^^0
"BLD",204,"KRN",.84,"NM",353,0)
37424^^0
"BLD",204,"KRN",.84,"NM",354,0)
37425^^0
"BLD",204,"KRN",.84,"NM",355,0)
37425.1^^0
"BLD",204,"KRN",.84,"NM",356,0)
37426^^0
"BLD",204,"KRN",.84,"NM",357,0)
37427^^0
"BLD",204,"KRN",.84,"NM",358,0)
37428^^0
"BLD",204,"KRN",.84,"NM",359,0)
37428.1^^0
"BLD",204,"KRN",.84,"NM",360,0)
37428.2^^0
"BLD",204,"KRN",.84,"NM",361,0)
37441^^0
"BLD",204,"KRN",.84,"NM",362,0)
37442^^0
"BLD",204,"KRN",.84,"NM",363,0)
37443^^0
"BLD",204,"KRN",.84,"NM",364,0)
37444^^0
"BLD",204,"KRN",.84,"NM",365,0)
37444.5^^0
"BLD",204,"KRN",.84,"NM",366,0)
37451^^0
"BLD",204,"KRN",.84,"NM",367,0)
37452^^0
"BLD",204,"KRN",.84,"NM",368,0)
37453^^0
"BLD",204,"KRN",.84,"NM",369,0)
37455^^0
"BLD",204,"KRN",.84,"NM",370,0)
37456^^0
"BLD",204,"KRN",.84,"NM",371,0)
37457^^0
"BLD",204,"KRN",.84,"NM",372,0)
37458^^0
"BLD",204,"KRN",.84,"NM",373,0)
37461^^0
"BLD",204,"KRN",.84,"NM",374,0)
37462^^0
"BLD",204,"KRN",.84,"NM",375,0)
37470^^0
"BLD",204,"KRN",.84,"NM",376,0)
37471^^0
"BLD",204,"KRN",.84,"NM",377,0)
37472^^0
"BLD",204,"KRN",.84,"NM",382,0)
34302.1^^0
"BLD",204,"KRN",.84,"NM",383,0)
34302.2^^0
"BLD",204,"KRN",.84,"NM",384,0)
34303.1^^0
"BLD",204,"KRN",.84,"NM",385,0)
37302^^0
"BLD",204,"KRN",.84,"NM",386,0)
37302.9^^0
"BLD",204,"KRN",.84,"NM",387,0)
37304.9^^0
"BLD",204,"KRN",.84,"NM",388,0)
34250^^0
"BLD",204,"KRN",.84,"NM",389,0)
34251^^0
"BLD",204,"KRN",.84,"NM",390,0)
34252^^0
"BLD",204,"KRN",.84,"NM",391,0)
34253^^0
"BLD",204,"KRN",.84,"NM",392,0)
34254^^0
"BLD",204,"KRN",.84,"NM",393,0)
34255^^0
"BLD",204,"KRN",.84,"NM","B",34015,1)

"BLD",204,"KRN",.84,"NM","B",34016,2)

"BLD",204,"KRN",.84,"NM","B",34017,3)

"BLD",204,"KRN",.84,"NM","B",34018,4)

"BLD",204,"KRN",.84,"NM","B",34020,5)

"BLD",204,"KRN",.84,"NM","B",34021,6)

"BLD",204,"KRN",.84,"NM","B",34030,7)

"BLD",204,"KRN",.84,"NM","B",34031,8)

"BLD",204,"KRN",.84,"NM","B",34032,9)

"BLD",204,"KRN",.84,"NM","B",34034,10)

"BLD",204,"KRN",.84,"NM","B",34035,11)

"BLD",204,"KRN",.84,"NM","B",34050,12)

"BLD",204,"KRN",.84,"NM","B",34051,13)

"BLD",204,"KRN",.84,"NM","B",34051.1,14)

"BLD",204,"KRN",.84,"NM","B",34052,15)

"BLD",204,"KRN",.84,"NM","B",34053,16)

"BLD",204,"KRN",.84,"NM","B",34054,17)

"BLD",204,"KRN",.84,"NM","B",34055,18)

"BLD",204,"KRN",.84,"NM","B",34056,19)

"BLD",204,"KRN",.84,"NM","B",34057,20)

"BLD",204,"KRN",.84,"NM","B",34058,21)

"BLD",204,"KRN",.84,"NM","B",34059,22)

"BLD",204,"KRN",.84,"NM","B",34060,23)

"BLD",204,"KRN",.84,"NM","B",34061,24)

"BLD",204,"KRN",.84,"NM","B",34065,25)

"BLD",204,"KRN",.84,"NM","B",34066,26)

"BLD",204,"KRN",.84,"NM","B",34067,27)

"BLD",204,"KRN",.84,"NM","B",34070,28)

"BLD",204,"KRN",.84,"NM","B",34071,29)

"BLD",204,"KRN",.84,"NM","B",34072,30)

"BLD",204,"KRN",.84,"NM","B",34075,31)

"BLD",204,"KRN",.84,"NM","B",34076,32)

"BLD",204,"KRN",.84,"NM","B",34077,33)

"BLD",204,"KRN",.84,"NM","B",34078,34)

"BLD",204,"KRN",.84,"NM","B",34079,35)

"BLD",204,"KRN",.84,"NM","B",34081,36)

"BLD",204,"KRN",.84,"NM","B",34082,37)

"BLD",204,"KRN",.84,"NM","B",34216,38)

"BLD",204,"KRN",.84,"NM","B",34217,39)

"BLD",204,"KRN",.84,"NM","B",34250,388)

"BLD",204,"KRN",.84,"NM","B",34251,389)

"BLD",204,"KRN",.84,"NM","B",34252,390)

"BLD",204,"KRN",.84,"NM","B",34253,391)

"BLD",204,"KRN",.84,"NM","B",34254,392)

"BLD",204,"KRN",.84,"NM","B",34255,393)

"BLD",204,"KRN",.84,"NM","B",34301,40)

"BLD",204,"KRN",.84,"NM","B",34302,41)

"BLD",204,"KRN",.84,"NM","B",34302.1,382)

"BLD",204,"KRN",.84,"NM","B",34302.2,383)

"BLD",204,"KRN",.84,"NM","B",34303,42)

"BLD",204,"KRN",.84,"NM","B",34303.1,384)

"BLD",204,"KRN",.84,"NM","B",34305,43)

"BLD",204,"KRN",.84,"NM","B",34306,44)

"BLD",204,"KRN",.84,"NM","B",34306.1,45)

"BLD",204,"KRN",.84,"NM","B",34308,46)

"BLD",204,"KRN",.84,"NM","B",34309,47)

"BLD",204,"KRN",.84,"NM","B",34309.1,48)

"BLD",204,"KRN",.84,"NM","B",34309.2,49)

"BLD",204,"KRN",.84,"NM","B",34309.3,50)

"BLD",204,"KRN",.84,"NM","B",34311,51)

"BLD",204,"KRN",.84,"NM","B",34312,52)

"BLD",204,"KRN",.84,"NM","B",34312.1,53)

"BLD",204,"KRN",.84,"NM","B",34314,54)

"BLD",204,"KRN",.84,"NM","B",34315,55)

"BLD",204,"KRN",.84,"NM","B",34315.1,56)

"BLD",204,"KRN",.84,"NM","B",34317,57)

"BLD",204,"KRN",.84,"NM","B",34317.1,58)

"BLD",204,"KRN",.84,"NM","B",34318,59)

"BLD",204,"KRN",.84,"NM","B",34318.1,60)

"BLD",204,"KRN",.84,"NM","B",34318.2,61)

"BLD",204,"KRN",.84,"NM","B",34318.3,62)

"BLD",204,"KRN",.84,"NM","B",34318.4,63)

"BLD",204,"KRN",.84,"NM","B",34319,64)

"BLD",204,"KRN",.84,"NM","B",34320,65)

"BLD",204,"KRN",.84,"NM","B",34320.1,66)

"BLD",204,"KRN",.84,"NM","B",34321,67)

"BLD",204,"KRN",.84,"NM","B",34323,68)

"BLD",204,"KRN",.84,"NM","B",34324,69)

"BLD",204,"KRN",.84,"NM","B",34324.1,70)

"BLD",204,"KRN",.84,"NM","B",34324.2,71)

"BLD",204,"KRN",.84,"NM","B",34324.3,72)

"BLD",204,"KRN",.84,"NM","B",34325,73)

"BLD",204,"KRN",.84,"NM","B",34325.1,74)

"BLD",204,"KRN",.84,"NM","B",34325.9,75)

"BLD",204,"KRN",.84,"NM","B",34326,76)

"BLD",204,"KRN",.84,"NM","B",34326.1,77)

"BLD",204,"KRN",.84,"NM","B",34328,78)

"BLD",204,"KRN",.84,"NM","B",34329,79)

"BLD",204,"KRN",.84,"NM","B",34329.1,80)

"BLD",204,"KRN",.84,"NM","B",34330,81)

"BLD",204,"KRN",.84,"NM","B",34330.1,82)

"BLD",204,"KRN",.84,"NM","B",34331,83)

"BLD",204,"KRN",.84,"NM","B",34331.1,84)

"BLD",204,"KRN",.84,"NM","B",34333,85)

"BLD",204,"KRN",.84,"NM","B",34334,86)

"BLD",204,"KRN",.84,"NM","B",34334.1,87)

"BLD",204,"KRN",.84,"NM","B",34335,88)

"BLD",204,"KRN",.84,"NM","B",34335.1,89)

"BLD",204,"KRN",.84,"NM","B",34350,90)

"BLD",204,"KRN",.84,"NM","B",34352,92)

"BLD",204,"KRN",.84,"NM","B",34353,93)

"BLD",204,"KRN",.84,"NM","B",34401,94)

"BLD",204,"KRN",.84,"NM","B",34402,95)

"BLD",204,"KRN",.84,"NM","B",34500,96)

"BLD",204,"KRN",.84,"NM","B",34501,97)

"BLD",204,"KRN",.84,"NM","B",34502,98)

"BLD",204,"KRN",.84,"NM","B",34503,99)

"BLD",204,"KRN",.84,"NM","B",34504,100)

"BLD",204,"KRN",.84,"NM","B",34505,101)

"BLD",204,"KRN",.84,"NM","B",34506,102)

"BLD",204,"KRN",.84,"NM","B",34507,103)

"BLD",204,"KRN",.84,"NM","B",34508,104)

"BLD",204,"KRN",.84,"NM","B",34510,105)

"BLD",204,"KRN",.84,"NM","B",34511,106)

"BLD",204,"KRN",.84,"NM","B",34512,107)

"BLD",204,"KRN",.84,"NM","B",34513,108)

"BLD",204,"KRN",.84,"NM","B",34514,109)

"BLD",204,"KRN",.84,"NM","B",34515,110)

"BLD",204,"KRN",.84,"NM","B",34516,111)

"BLD",204,"KRN",.84,"NM","B",34518,112)

"BLD",204,"KRN",.84,"NM","B",34519,113)

"BLD",204,"KRN",.84,"NM","B",34520,114)

"BLD",204,"KRN",.84,"NM","B",34521,115)

"BLD",204,"KRN",.84,"NM","B",34530,116)

"BLD",204,"KRN",.84,"NM","B",34531,117)

"BLD",204,"KRN",.84,"NM","B",34532,118)

"BLD",204,"KRN",.84,"NM","B",34533,119)

"BLD",204,"KRN",.84,"NM","B",34534,120)

"BLD",204,"KRN",.84,"NM","B",34534.1,125)

"BLD",204,"KRN",.84,"NM","B",34536,121)

"BLD",204,"KRN",.84,"NM","B",34537,122)

"BLD",204,"KRN",.84,"NM","B",34538,123)

"BLD",204,"KRN",.84,"NM","B",34539,124)

"BLD",204,"KRN",.84,"NM","B",34540,126)

"BLD",204,"KRN",.84,"NM","B",34541,127)

"BLD",204,"KRN",.84,"NM","B",34542,128)

"BLD",204,"KRN",.84,"NM","B",34543,129)

"BLD",204,"KRN",.84,"NM","B",34544,130)

"BLD",204,"KRN",.84,"NM","B",34545,131)

"BLD",204,"KRN",.84,"NM","B",34546,132)

"BLD",204,"KRN",.84,"NM","B",34550,133)

"BLD",204,"KRN",.84,"NM","B",34551,134)

"BLD",204,"KRN",.84,"NM","B",34552,135)

"BLD",204,"KRN",.84,"NM","B",34554,136)

"BLD",204,"KRN",.84,"NM","B",34555,137)

"BLD",204,"KRN",.84,"NM","B",34556,138)

"BLD",204,"KRN",.84,"NM","B",34557,139)

"BLD",204,"KRN",.84,"NM","B",34557.1,140)

"BLD",204,"KRN",.84,"NM","B",34559,141)

"BLD",204,"KRN",.84,"NM","B",34560,142)

"BLD",204,"KRN",.84,"NM","B",34561,143)

"BLD",204,"KRN",.84,"NM","B",34562,144)

"BLD",204,"KRN",.84,"NM","B",34562.1,145)

"BLD",204,"KRN",.84,"NM","B",34564,146)

"BLD",204,"KRN",.84,"NM","B",34565,147)

"BLD",204,"KRN",.84,"NM","B",34566,148)

"BLD",204,"KRN",.84,"NM","B",34567,149)

"BLD",204,"KRN",.84,"NM","B",34568,150)

"BLD",204,"KRN",.84,"NM","B",34570,151)

"BLD",204,"KRN",.84,"NM","B",34571,152)

"BLD",204,"KRN",.84,"NM","B",34572,153)

"BLD",204,"KRN",.84,"NM","B",34573,154)

"BLD",204,"KRN",.84,"NM","B",34574,155)

"BLD",204,"KRN",.84,"NM","B",34575,156)

"BLD",204,"KRN",.84,"NM","B",34576,157)

"BLD",204,"KRN",.84,"NM","B",34577,158)

"BLD",204,"KRN",.84,"NM","B",34578,159)

"BLD",204,"KRN",.84,"NM","B",34580,160)

"BLD",204,"KRN",.84,"NM","B",34581,161)

"BLD",204,"KRN",.84,"NM","B",34582,162)

"BLD",204,"KRN",.84,"NM","B",34583,163)

"BLD",204,"KRN",.84,"NM","B",34584,164)

"BLD",204,"KRN",.84,"NM","B",34585,165)

"BLD",204,"KRN",.84,"NM","B",34586,166)

"BLD",204,"KRN",.84,"NM","B",34587,167)

"BLD",204,"KRN",.84,"NM","B",34588,168)

"BLD",204,"KRN",.84,"NM","B",34590,169)

"BLD",204,"KRN",.84,"NM","B",34591,170)

"BLD",204,"KRN",.84,"NM","B",34592,171)

"BLD",204,"KRN",.84,"NM","B",34593,172)

"BLD",204,"KRN",.84,"NM","B",34595,173)

"BLD",204,"KRN",.84,"NM","B",34596,174)

"BLD",204,"KRN",.84,"NM","B",34597,175)

"BLD",204,"KRN",.84,"NM","B",34598,176)

"BLD",204,"KRN",.84,"NM","B",34600,177)

"BLD",204,"KRN",.84,"NM","B",34601,178)

"BLD",204,"KRN",.84,"NM","B",34602,179)

"BLD",204,"KRN",.84,"NM","B",34603,180)

"BLD",204,"KRN",.84,"NM","B",34604,181)

"BLD",204,"KRN",.84,"NM","B",34605,182)

"BLD",204,"KRN",.84,"NM","B",34606,183)

"BLD",204,"KRN",.84,"NM","B",34607,184)

"BLD",204,"KRN",.84,"NM","B",34608,185)

"BLD",204,"KRN",.84,"NM","B",34610,186)

"BLD",204,"KRN",.84,"NM","B",34611,187)

"BLD",204,"KRN",.84,"NM","B",34612,188)

"BLD",204,"KRN",.84,"NM","B",34615,189)

"BLD",204,"KRN",.84,"NM","B",34616,190)

"BLD",204,"KRN",.84,"NM","B",34617,191)

"BLD",204,"KRN",.84,"NM","B",34618,192)

"BLD",204,"KRN",.84,"NM","B",34619,193)

"BLD",204,"KRN",.84,"NM","B",34620,194)

"BLD",204,"KRN",.84,"NM","B",34621,195)

"BLD",204,"KRN",.84,"NM","B",34622,196)

"BLD",204,"KRN",.84,"NM","B",34623,197)

"BLD",204,"KRN",.84,"NM","B",34630,198)

"BLD",204,"KRN",.84,"NM","B",34631,199)

"BLD",204,"KRN",.84,"NM","B",34632,200)

"BLD",204,"KRN",.84,"NM","B",34633,201)

"BLD",204,"KRN",.84,"NM","B",34634,202)

"BLD",204,"KRN",.84,"NM","B",34635,203)

"BLD",204,"KRN",.84,"NM","B",34635.1,205)

"BLD",204,"KRN",.84,"NM","B",34636,204)

"BLD",204,"KRN",.84,"NM","B",34636.1,206)

"BLD",204,"KRN",.84,"NM","B",34637,207)

"BLD",204,"KRN",.84,"NM","B",34638,208)

"BLD",204,"KRN",.84,"NM","B",34639,209)

"BLD",204,"KRN",.84,"NM","B",37100,210)

"BLD",204,"KRN",.84,"NM","B",37101,211)

"BLD",204,"KRN",.84,"NM","B",37102,212)

"BLD",204,"KRN",.84,"NM","B",37201,213)

"BLD",204,"KRN",.84,"NM","B",37201.1,214)

"BLD",204,"KRN",.84,"NM","B",37201.2,215)

"BLD",204,"KRN",.84,"NM","B",37202,216)

"BLD",204,"KRN",.84,"NM","B",37203,217)

"BLD",204,"KRN",.84,"NM","B",37204,218)

"BLD",204,"KRN",.84,"NM","B",37204.1,219)

"BLD",204,"KRN",.84,"NM","B",37204.2,220)

"BLD",204,"KRN",.84,"NM","B",37205,221)

"BLD",204,"KRN",.84,"NM","B",37206,222)

"BLD",204,"KRN",.84,"NM","B",37207,223)

"BLD",204,"KRN",.84,"NM","B",37208,224)

"BLD",204,"KRN",.84,"NM","B",37209,225)

"BLD",204,"KRN",.84,"NM","B",37211,226)

"BLD",204,"KRN",.84,"NM","B",37212,227)

"BLD",204,"KRN",.84,"NM","B",37213,228)

"BLD",204,"KRN",.84,"NM","B",37214,229)

"BLD",204,"KRN",.84,"NM","B",37219,230)

"BLD",204,"KRN",.84,"NM","B",37221,231)

"BLD",204,"KRN",.84,"NM","B",37222,232)

"BLD",204,"KRN",.84,"NM","B",37223,233)

"BLD",204,"KRN",.84,"NM","B",37231,234)

"BLD",204,"KRN",.84,"NM","B",37232,235)

"BLD",204,"KRN",.84,"NM","B",37241,236)

"BLD",204,"KRN",.84,"NM","B",37251,237)

"BLD",204,"KRN",.84,"NM","B",37261,238)

"BLD",204,"KRN",.84,"NM","B",37301,239)

"BLD",204,"KRN",.84,"NM","B",37301.6,240)

"BLD",204,"KRN",.84,"NM","B",37301.9,241)

"BLD",204,"KRN",.84,"NM","B",37302,385)

"BLD",204,"KRN",.84,"NM","B",37302.9,386)

"BLD",204,"KRN",.84,"NM","B",37303,242)

"BLD",204,"KRN",.84,"NM","B",37303.1,243)

"BLD",204,"KRN",.84,"NM","B",37303.2,244)

"BLD",204,"KRN",.84,"NM","B",37303.9,245)

"BLD",204,"KRN",.84,"NM","B",37304,246)

"BLD",204,"KRN",.84,"NM","B",37304.9,387)

"BLD",204,"KRN",.84,"NM","B",37305,247)

"BLD",204,"KRN",.84,"NM","B",37306,248)

"BLD",204,"KRN",.84,"NM","B",37306.1,249)

"BLD",204,"KRN",.84,"NM","B",37306.2,250)

"BLD",204,"KRN",.84,"NM","B",37307,251)

"BLD",204,"KRN",.84,"NM","B",37307.9,252)

"BLD",204,"KRN",.84,"NM","B",37308,253)

"BLD",204,"KRN",.84,"NM","B",37308.9,254)

"BLD",204,"KRN",.84,"NM","B",37309,255)

"BLD",204,"KRN",.84,"NM","B",37309.1,256)

"BLD",204,"KRN",.84,"NM","B",37309.2,257)

"BLD",204,"KRN",.84,"NM","B",37309.3,258)

"BLD",204,"KRN",.84,"NM","B",37309.4,259)

"BLD",204,"KRN",.84,"NM","B",37309.5,260)

"BLD",204,"KRN",.84,"NM","B",37309.9,261)

"BLD",204,"KRN",.84,"NM","B",37311,262)

"BLD",204,"KRN",.84,"NM","B",37311.9,263)

"BLD",204,"KRN",.84,"NM","B",37312,264)

"BLD",204,"KRN",.84,"NM","B",37312.9,265)

"BLD",204,"KRN",.84,"NM","B",37313,266)

"BLD",204,"KRN",.84,"NM","B",37313.9,267)

"BLD",204,"KRN",.84,"NM","B",37314,268)

"BLD",204,"KRN",.84,"NM","B",37314.9,269)

"BLD",204,"KRN",.84,"NM","B",37315,270)

"BLD",204,"KRN",.84,"NM","B",37315.4,271)

"BLD",204,"KRN",.84,"NM","B",37315.8,272)

"BLD",204,"KRN",.84,"NM","B",37315.9,273)

"BLD",204,"KRN",.84,"NM","B",37316,274)

"BLD",204,"KRN",.84,"NM","B",37316.8,275)

"BLD",204,"KRN",.84,"NM","B",37316.9,276)

"BLD",204,"KRN",.84,"NM","B",37317,277)

"BLD",204,"KRN",.84,"NM","B",37317.1,278)

"BLD",204,"KRN",.84,"NM","B",37317.9,279)

"BLD",204,"KRN",.84,"NM","B",37318,280)

"BLD",204,"KRN",.84,"NM","B",37318.9,281)

"BLD",204,"KRN",.84,"NM","B",37319,282)

"BLD",204,"KRN",.84,"NM","B",37319.9,283)

"BLD",204,"KRN",.84,"NM","B",37320,284)

"BLD",204,"KRN",.84,"NM","B",37320.6,285)

"BLD",204,"KRN",.84,"NM","B",37320.9,286)

"BLD",204,"KRN",.84,"NM","B",37331,287)

"BLD",204,"KRN",.84,"NM","B",37332,288)

"BLD",204,"KRN",.84,"NM","B",37333,289)

"BLD",204,"KRN",.84,"NM","B",37333.1,290)

"BLD",204,"KRN",.84,"NM","B",37333.2,291)

"BLD",204,"KRN",.84,"NM","B",37333.8,292)

"BLD",204,"KRN",.84,"NM","B",37333.9,293)

"BLD",204,"KRN",.84,"NM","B",37334,294)

"BLD",204,"KRN",.84,"NM","B",37341,295)

"BLD",204,"KRN",.84,"NM","B",37342,296)

"BLD",204,"KRN",.84,"NM","B",37401,297)

"BLD",204,"KRN",.84,"NM","B",37401.1,298)

"BLD",204,"KRN",.84,"NM","B",37401.2,299)

"BLD",204,"KRN",.84,"NM","B",37401.3,300)

"BLD",204,"KRN",.84,"NM","B",37401.4,301)

"BLD",204,"KRN",.84,"NM","B",37401.5,302)

"BLD",204,"KRN",.84,"NM","B",37402,303)

"BLD",204,"KRN",.84,"NM","B",37402.1,304)

"BLD",204,"KRN",.84,"NM","B",37403,305)

"BLD",204,"KRN",.84,"NM","B",37403.1,306)

"BLD",204,"KRN",.84,"NM","B",37403.2,307)

"BLD",204,"KRN",.84,"NM","B",37403.4,308)

"BLD",204,"KRN",.84,"NM","B",37403.5,309)

"BLD",204,"KRN",.84,"NM","B",37403.6,310)

"BLD",204,"KRN",.84,"NM","B",37404,311)

"BLD",204,"KRN",.84,"NM","B",37404.1,312)

"BLD",204,"KRN",.84,"NM","B",37404.5,313)

"BLD",204,"KRN",.84,"NM","B",37405,314)

"BLD",204,"KRN",.84,"NM","B",37405.1,315)

"BLD",204,"KRN",.84,"NM","B",37405.2,316)

"BLD",204,"KRN",.84,"NM","B",37405.3,317)

"BLD",204,"KRN",.84,"NM","B",37405.4,318)

"BLD",204,"KRN",.84,"NM","B",37406,319)

"BLD",204,"KRN",.84,"NM","B",37406.1,320)

"BLD",204,"KRN",.84,"NM","B",37406.6,321)

"BLD",204,"KRN",.84,"NM","B",37407,322)

"BLD",204,"KRN",.84,"NM","B",37408,323)

"BLD",204,"KRN",.84,"NM","B",37408.9,326)

"BLD",204,"KRN",.84,"NM","B",37409,324)

"BLD",204,"KRN",.84,"NM","B",37409.1,327)

"BLD",204,"KRN",.84,"NM","B",37409.5,328)

"BLD",204,"KRN",.84,"NM","B",37409.9,325)

"BLD",204,"KRN",.84,"NM","B",37411,329)

"BLD",204,"KRN",.84,"NM","B",37411.9,330)

"BLD",204,"KRN",.84,"NM","B",37412,331)

"BLD",204,"KRN",.84,"NM","B",37412.1,332)

"BLD",204,"KRN",.84,"NM","B",37412.9,333)

"BLD",204,"KRN",.84,"NM","B",37413,334)

"BLD",204,"KRN",.84,"NM","B",37414,335)

"BLD",204,"KRN",.84,"NM","B",37414.9,336)

"BLD",204,"KRN",.84,"NM","B",37415,337)

"BLD",204,"KRN",.84,"NM","B",37415.9,338)

"BLD",204,"KRN",.84,"NM","B",37416,339)

"BLD",204,"KRN",.84,"NM","B",37416.4,340)

"BLD",204,"KRN",.84,"NM","B",37417,341)

"BLD",204,"KRN",.84,"NM","B",37418,342)

"BLD",204,"KRN",.84,"NM","B",37419,343)

"BLD",204,"KRN",.84,"NM","B",37420,344)

"BLD",204,"KRN",.84,"NM","B",37420.1,345)

"BLD",204,"KRN",.84,"NM","B",37422,346)

"BLD",204,"KRN",.84,"NM","B",37422.1,347)

"BLD",204,"KRN",.84,"NM","B",37422.2,348)

"BLD",204,"KRN",.84,"NM","B",37422.4,349)

"BLD",204,"KRN",.84,"NM","B",37422.5,350)

"BLD",204,"KRN",.84,"NM","B",37422.6,351)

"BLD",204,"KRN",.84,"NM","B",37423,352)

"BLD",204,"KRN",.84,"NM","B",37424,353)

"BLD",204,"KRN",.84,"NM","B",37425,354)

"BLD",204,"KRN",.84,"NM","B",37425.1,355)

"BLD",204,"KRN",.84,"NM","B",37426,356)

"BLD",204,"KRN",.84,"NM","B",37427,357)

"BLD",204,"KRN",.84,"NM","B",37428,358)

"BLD",204,"KRN",.84,"NM","B",37428.1,359)

"BLD",204,"KRN",.84,"NM","B",37428.2,360)

"BLD",204,"KRN",.84,"NM","B",37441,361)

"BLD",204,"KRN",.84,"NM","B",37442,362)

"BLD",204,"KRN",.84,"NM","B",37443,363)

"BLD",204,"KRN",.84,"NM","B",37444,364)

"BLD",204,"KRN",.84,"NM","B",37444.5,365)

"BLD",204,"KRN",.84,"NM","B",37451,366)

"BLD",204,"KRN",.84,"NM","B",37452,367)

"BLD",204,"KRN",.84,"NM","B",37453,368)

"BLD",204,"KRN",.84,"NM","B",37455,369)

"BLD",204,"KRN",.84,"NM","B",37456,370)

"BLD",204,"KRN",.84,"NM","B",37457,371)

"BLD",204,"KRN",.84,"NM","B",37458,372)

"BLD",204,"KRN",.84,"NM","B",37461,373)

"BLD",204,"KRN",.84,"NM","B",37462,374)

"BLD",204,"KRN",.84,"NM","B",37470,375)

"BLD",204,"KRN",.84,"NM","B",37471,376)

"BLD",204,"KRN",.84,"NM","B",37472,377)

"BLD",204,"KRN",3.6,0)
3.6
"BLD",204,"KRN",3.8,0)
3.8
"BLD",204,"KRN",9.2,0)
9.2
"BLD",204,"KRN",9.2,"NM",0)
^9.68A^12^12
"BLD",204,"KRN",9.2,"NM",1,0)
XM-U-M-NETWORK SIGNATURE^^0
"BLD",204,"KRN",9.2,"NM",2,0)
XM-U-M-REPLY INCLUDE^^0
"BLD",204,"KRN",9.2,"NM",3,0)
XM-U-M-NEW^^0
"BLD",204,"KRN",9.2,"NM",4,0)
XM-U-M-NEW-2^^0
"BLD",204,"KRN",9.2,"NM",5,0)
XM-U-BO-CLASSIC^^0
"BLD",204,"KRN",9.2,"NM",6,0)
XM-U-BO-FULL SCREEN^^0
"BLD",204,"KRN",9.2,"NM",7,0)
XM-U-MO-EDIT^^0
"BLD",204,"KRN",9.2,"NM",8,0)
XM-U-M-EDIT SUBJECT^^0
"BLD",204,"KRN",9.2,"NM",9,0)
XM-U-M-EDIT TEXT^^0
"BLD",204,"KRN",9.2,"NM",10,0)
XM-U-MO-REPLY^^0
"BLD",204,"KRN",9.2,"NM",11,0)
XM-U-MO-SEND^^0
"BLD",204,"KRN",9.2,"NM",12,0)
XM-U-BO-FULL SCREEN LIST^^0
"BLD",204,"KRN",9.2,"NM","B","XM-U-BO-CLASSIC",5)

"BLD",204,"KRN",9.2,"NM","B","XM-U-BO-FULL SCREEN",6)

"BLD",204,"KRN",9.2,"NM","B","XM-U-BO-FULL SCREEN LIST",12)

"BLD",204,"KRN",9.2,"NM","B","XM-U-M-EDIT SUBJECT",8)

"BLD",204,"KRN",9.2,"NM","B","XM-U-M-EDIT TEXT",9)

"BLD",204,"KRN",9.2,"NM","B","XM-U-M-NETWORK SIGNATURE",1)

"BLD",204,"KRN",9.2,"NM","B","XM-U-M-NEW",3)

"BLD",204,"KRN",9.2,"NM","B","XM-U-M-NEW-2",4)

"BLD",204,"KRN",9.2,"NM","B","XM-U-M-REPLY INCLUDE",2)

"BLD",204,"KRN",9.2,"NM","B","XM-U-MO-EDIT",7)

"BLD",204,"KRN",9.2,"NM","B","XM-U-MO-REPLY",10)

"BLD",204,"KRN",9.2,"NM","B","XM-U-MO-SEND",11)

"BLD",204,"KRN",9.8,0)
9.8
"BLD",204,"KRN",9.8,"NM",0)
^9.68A^37^37
"BLD",204,"KRN",9.8,"NM",1,0)
XMXSEC1^^0^B41493935
"BLD",204,"KRN",9.8,"NM",2,0)
XMXSEC2^^0^B65152384
"BLD",204,"KRN",9.8,"NM",3,0)
XMXSEC^^0^B61916559
"BLD",204,"KRN",9.8,"NM",4,0)
XMJMOI^^0^B71095558
"BLD",204,"KRN",9.8,"NM",5,0)
XMJDIR^^0^B16354335
"BLD",204,"KRN",9.8,"NM",6,0)
XMJBM^^0^B49597406
"BLD",204,"KRN",9.8,"NM",7,0)
XMJMLR1^^0^B21990915
"BLD",204,"KRN",9.8,"NM",8,0)
XMJMFA^^0^B14710003
"BLD",204,"KRN",9.8,"NM",9,0)
XMJMFB^^0^B65353970
"BLD",204,"KRN",9.8,"NM",10,0)
XMJMLN^^0^B54444130
"BLD",204,"KRN",9.8,"NM",11,0)
XMJMLR^^0^B72945716
"BLD",204,"KRN",9.8,"NM",12,0)
XMJMC^^0^B33661798
"BLD",204,"KRN",9.8,"NM",13,0)
XMJMOR^^0^B68946250
"BLD",204,"KRN",9.8,"NM",14,0)
XMJMORX^^0^B79210536
"BLD",204,"KRN",9.8,"NM",15,0)
XMJMORX1^^0^B5297814
"BLD",204,"KRN",9.8,"NM",16,0)
XMXMSGS^^0^B37131574
"BLD",204,"KRN",9.8,"NM",17,0)
XMXMSGS2^^0^B35236145
"BLD",204,"KRN",9.8,"NM",18,0)
XMXAPI^^0^B36076134
"BLD",204,"KRN",9.8,"NM",19,0)
XMJMD^^0^B29415386
"BLD",204,"KRN",9.8,"NM",20,0)
XMJMOIE^^0^B6462183
"BLD",204,"KRN",9.8,"NM",21,0)
XMJMSO^^0^B31691805
"BLD",204,"KRN",9.8,"NM",22,0)
XMJMRO^^0^B7678503
"BLD",204,"KRN",9.8,"NM",23,0)
XMXEDIT^^0^B25336057
"BLD",204,"KRN",9.8,"NM",24,0)
XMJMCODE^^0^B34895416
"BLD",204,"KRN",9.8,"NM",25,0)
XMXSEC3^^0^B5676742
"BLD",204,"KRN",9.8,"NM",26,0)
XMJMP^^0^B67038144
"BLD",204,"KRN",9.8,"NM",27,0)
XMJMQ^^0^B62823014
"BLD",204,"KRN",9.8,"NM",28,0)
XMJMOI1^^0^B4607562
"BLD",204,"KRN",9.8,"NM",29,0)
XMJMP1^^0^B55975309
"BLD",204,"KRN",9.8,"NM",30,0)
XMJMP2^^0^B6112689
"BLD",204,"KRN",9.8,"NM",31,0)
XMJMQ1^^0^B18614734
"BLD",204,"KRN",9.8,"NM",32,0)
XMXANSER^^0^B5554926
"BLD",204,"KRN",9.8,"NM",33,0)
XMJMA^^0^B7043405
"BLD",204,"KRN",9.8,"NM",34,0)
XMA2R^^0^B13830156
"BLD",204,"KRN",9.8,"NM",35,0)
XMVVITA^^0^B20731933
"BLD",204,"KRN",9.8,"NM",36,0)
XMA0^^0^B975726
"BLD",204,"KRN",9.8,"NM",37,0)
XMTDO^^0^B3423711
"BLD",204,"KRN",9.8,"NM","B","XMA0",36)

"BLD",204,"KRN",9.8,"NM","B","XMA2R",34)

"BLD",204,"KRN",9.8,"NM","B","XMJBM",6)

"BLD",204,"KRN",9.8,"NM","B","XMJDIR",5)

"BLD",204,"KRN",9.8,"NM","B","XMJMA",33)

"BLD",204,"KRN",9.8,"NM","B","XMJMC",12)

"BLD",204,"KRN",9.8,"NM","B","XMJMCODE",24)

"BLD",204,"KRN",9.8,"NM","B","XMJMD",19)

"BLD",204,"KRN",9.8,"NM","B","XMJMFA",8)

"BLD",204,"KRN",9.8,"NM","B","XMJMFB",9)

"BLD",204,"KRN",9.8,"NM","B","XMJMLN",10)

"BLD",204,"KRN",9.8,"NM","B","XMJMLR",11)

"BLD",204,"KRN",9.8,"NM","B","XMJMLR1",7)

"BLD",204,"KRN",9.8,"NM","B","XMJMOI",4)

"BLD",204,"KRN",9.8,"NM","B","XMJMOI1",28)

"BLD",204,"KRN",9.8,"NM","B","XMJMOIE",20)

"BLD",204,"KRN",9.8,"NM","B","XMJMOR",13)

"BLD",204,"KRN",9.8,"NM","B","XMJMORX",14)

"BLD",204,"KRN",9.8,"NM","B","XMJMORX1",15)

"BLD",204,"KRN",9.8,"NM","B","XMJMP",26)

"BLD",204,"KRN",9.8,"NM","B","XMJMP1",29)

"BLD",204,"KRN",9.8,"NM","B","XMJMP2",30)

"BLD",204,"KRN",9.8,"NM","B","XMJMQ",27)

"BLD",204,"KRN",9.8,"NM","B","XMJMQ1",31)

"BLD",204,"KRN",9.8,"NM","B","XMJMRO",22)

"BLD",204,"KRN",9.8,"NM","B","XMJMSO",21)

"BLD",204,"KRN",9.8,"NM","B","XMTDO",37)

"BLD",204,"KRN",9.8,"NM","B","XMVVITA",35)

"BLD",204,"KRN",9.8,"NM","B","XMXANSER",32)

"BLD",204,"KRN",9.8,"NM","B","XMXAPI",18)

"BLD",204,"KRN",9.8,"NM","B","XMXEDIT",23)

"BLD",204,"KRN",9.8,"NM","B","XMXMSGS",16)

"BLD",204,"KRN",9.8,"NM","B","XMXMSGS2",17)

"BLD",204,"KRN",9.8,"NM","B","XMXSEC",3)

"BLD",204,"KRN",9.8,"NM","B","XMXSEC1",1)

"BLD",204,"KRN",9.8,"NM","B","XMXSEC2",2)

"BLD",204,"KRN",9.8,"NM","B","XMXSEC3",25)

"BLD",204,"KRN",19,0)
19
"BLD",204,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",204,"KRN",19,"NM",1,0)
XMEDITMG^^0
"BLD",204,"KRN",19,"NM","B","XMEDITMG",1)

"BLD",204,"KRN",19.1,0)
19.1
"BLD",204,"KRN",101,0)
101
"BLD",204,"KRN",409.61,0)
409.61
"BLD",204,"KRN",8994,0)
8994
"BLD",204,"KRN","B",.4,.4)

"BLD",204,"KRN","B",.401,.401)

"BLD",204,"KRN","B",.402,.402)

"BLD",204,"KRN","B",.403,.403)

"BLD",204,"KRN","B",.5,.5)

"BLD",204,"KRN","B",.84,.84)

"BLD",204,"KRN","B",3.6,3.6)

"BLD",204,"KRN","B",3.8,3.8)

"BLD",204,"KRN","B",9.2,9.2)

"BLD",204,"KRN","B",9.8,9.8)

"BLD",204,"KRN","B",19,19)

"BLD",204,"KRN","B",19.1,19.1)

"BLD",204,"KRN","B",101,101)

"BLD",204,"KRN","B",409.61,409.61)

"BLD",204,"KRN","B",8994,8994)

"BLD",204,"QUES",0)
^9.62^^
"BLD",204,"REQB",0)
^9.611^10^7
"BLD",204,"REQB",1,0)
XM*7.1*72^1
"BLD",204,"REQB",2,0)
XM*7.1*79^1
"BLD",204,"REQB",3,0)
XM*7.1*95^1
"BLD",204,"REQB",6,0)
DI*22.0*17^1
"BLD",204,"REQB",7,0)
XM*7.1*100^1
"BLD",204,"REQB",9,0)
XM*7.1*101^1
"BLD",204,"REQB",10,0)
XM*7.1*121^1
"BLD",204,"REQB","B","DI*22.0*17",6)

"BLD",204,"REQB","B","XM*7.1*100",7)

"BLD",204,"REQB","B","XM*7.1*101",9)

"BLD",204,"REQB","B","XM*7.1*121",10)

"BLD",204,"REQB","B","XM*7.1*72",1)

"BLD",204,"REQB","B","XM*7.1*79",2)

"BLD",204,"REQB","B","XM*7.1*95",3)

"KRN",.84,34015,-1)
0^1
"KRN",.84,34015,0)
34015^2^^MAILMAN^You have no new messages in this basket.
"KRN",.84,34015,2,0)
^^1^1^2991216^
"KRN",.84,34015,2,1,0)
You have no new messages in this basket.
"KRN",.84,34015,5,0)
^.841^1^1
"KRN",.84,34015,5,1,0)
XMJMLN
"KRN",.84,34015,5,"B","XMJMLN",1)

"KRN",.84,34016,-1)
0^2
"KRN",.84,34016,0)
34016^2^^MAILMAN^You have no new priority messages in this
"KRN",.84,34016,2,0)
^^1^1^2991216^
"KRN",.84,34016,2,1,0)
You have no new priority messages in this basket.
"KRN",.84,34016,5,0)
^.841^1^1
"KRN",.84,34016,5,1,0)
XMJMLN
"KRN",.84,34016,5,"B","XMJMLN",1)

"KRN",.84,34017,-1)
0^3
"KRN",.84,34017,0)
34017^2^^MAILMAN^You have no new messages.
"KRN",.84,34017,2,0)
^^1^1^2991216^
"KRN",.84,34017,2,1,0)
You have no new messages.
"KRN",.84,34017,5,0)
^.841^1^1
"KRN",.84,34017,5,1,0)
XMJMLN
"KRN",.84,34017,5,"B","XMJMLN",1)

"KRN",.84,34018,-1)
0^4
"KRN",.84,34018,0)
34018^2^^MAILMAN^You have no new priority messages.
"KRN",.84,34018,2,0)
^^1^1^2991216^
"KRN",.84,34018,2,1,0)
You have no new priority messages.
"KRN",.84,34018,5,0)
^.841^1^1
"KRN",.84,34018,5,1,0)
XMJMLN
"KRN",.84,34018,5,"B","XMJMLN",1)

"KRN",.84,34020,-1)
0^5
"KRN",.84,34020,0)
34020^2^^MAILMAN^End reached.  Begin again
"KRN",.84,34020,2,0)
^^1^1^2991216^
"KRN",.84,34020,2,1,0)
End reached.  Begin again
"KRN",.84,34020,5,0)
^.841^1^1
"KRN",.84,34020,5,1,0)
XMJMLR
"KRN",.84,34020,5,"B","XMJMLR",1)

"KRN",.84,34021,-1)
0^6
"KRN",.84,34021,0)
34021^3^^MAILMAN^Enter 'Yes' if you wish to continue read
"KRN",.84,34021,2,0)
^^1^1^2991216^
"KRN",.84,34021,2,1,0)
Enter 'Yes' if you wish to continue reading messages; 'No' if you don't.
"KRN",.84,34021,5,0)
^.841^1^1
"KRN",.84,34021,5,1,0)
XMJMLR
"KRN",.84,34021,5,"B","XMJMLR",1)

"KRN",.84,34030,-1)
0^7
"KRN",.84,34030,0)
34030^2^y^MAILMAN^|1| Basket Message: |2|// 
"KRN",.84,34030,1,0)
^^1^1^2991215^
"KRN",.84,34030,1,1,0)
Note: there's one blank character at the end of this dialog.
"KRN",.84,34030,2,0)
^^1^1^2991215^
"KRN",.84,34030,2,1,0)
|1| Basket Message: |2|// 
"KRN",.84,34030,3,0)
^.845^2^2
"KRN",.84,34030,3,1,0)
1^basket name
"KRN",.84,34030,3,2,0)
2^message sequence number in basket
"KRN",.84,34030,5,0)
^.841^1^1
"KRN",.84,34030,5,1,0)
XMJBM
"KRN",.84,34030,5,"B","XMJBM",1)

"KRN",.84,34031,-1)
0^8
"KRN",.84,34031,0)
34031^2^y^MAILMAN^Subj: |1|   From: |2|
"KRN",.84,34031,2,0)
^^1^1^2991215^
"KRN",.84,34031,2,1,0)
Subj: |1|   From: |2|
"KRN",.84,34031,3,0)
^.845^2^2
"KRN",.84,34031,3,1,0)
1^message subject
"KRN",.84,34031,3,2,0)
2^message sender
"KRN",.84,34031,5,0)
^.841^1^1
"KRN",.84,34031,5,1,0)
XMJBM
"KRN",.84,34031,5,"B","XMJBM",1)

"KRN",.84,34032,-1)
0^9
"KRN",.84,34032,0)
34032^3^y^MAILMAN^Press ENTER to read message |1|.  Enter
"KRN",.84,34032,2,0)
^^9^9^2991216^^^
"KRN",.84,34032,2,1,0)
Press ENTER to read message |1|.  Enter a message number (|2|-|3|) to read
"KRN",.84,34032,2,2,0)
a message in this basket.  Enter an internal message number to read any
"KRN",.84,34032,2,3,0)
message still on the system, which you ever sent or received.  Enter:
"KRN",.84,34032,2,4,0)
 ? or ??        Display a summary or detailed list of messages in this basket
"KRN",.84,34032,2,5,0)
 ???? or ?HELP  Display detailed help
"KRN",.84,34032,2,6,0)
 ?string        Search for messages in this basket whose subject
"KRN",.84,34032,2,7,0)
                contains the specified string
"KRN",.84,34032,2,8,0)
 ??string       Search for messages you once sent or received
"KRN",.84,34032,2,9,0)
                whose subject begins with the specified string
"KRN",.84,34032,3,0)
^.845^3^3
"KRN",.84,34032,3,1,0)
1^message sequence number in basket
"KRN",.84,34032,3,2,0)
2^first message sequence number in basket
"KRN",.84,34032,3,3,0)
3^last message sequence number in basket
"KRN",.84,34032,5,0)
^.841^1^1
"KRN",.84,34032,5,1,0)
XMJBM
"KRN",.84,34032,5,"B","XMJBM",1)

"KRN",.84,34034,-1)
0^10
"KRN",.84,34034,0)
34034^1^^MAILMAN^This references a message which doesn't ex
"KRN",.84,34034,2,0)
^^1^1^2991215^
"KRN",.84,34034,2,1,0)
This references a message which doesn't exist - deleting it.
"KRN",.84,34034,5,0)
^.841^1^1
"KRN",.84,34034,5,1,0)
XMJBM
"KRN",.84,34034,5,"B","XMJBM",1)

"KRN",.84,34035,-1)
0^11
"KRN",.84,34035,0)
34035^2^^MAILMAN^Resequencing ...
"KRN",.84,34035,2,0)
^^1^1^2991215^
"KRN",.84,34035,2,1,0)
Resequencing ...
"KRN",.84,34035,5,0)
^.841^1^1
"KRN",.84,34035,5,1,0)
XMJBM
"KRN",.84,34035,5,"B","XMJBM",1)

"KRN",.84,34050,-1)
0^12
"KRN",.84,34050,0)
34050^2^^MAILMAN^Enter message number or command: 
"KRN",.84,34050,1,0)
^^1^1^2991215^
"KRN",.84,34050,1,1,0)
Note: there's a blank character at the end of this dialog.
"KRN",.84,34050,2,0)
^^1^1^2991215^
"KRN",.84,34050,2,1,0)
Enter message number or command: 
"KRN",.84,34050,5,0)
^.841^1^1
"KRN",.84,34050,5,1,0)
XMJMLR1
"KRN",.84,34050,5,"B","XMJMLR1",1)

"KRN",.84,34051,-1)
0^13
"KRN",.84,34051,0)
34051^3^y^MAILMAN^Enter a message number (|1|-|2|) to read a
"KRN",.84,34051,2,0)
^^3^3^2991216^^^^
"KRN",.84,34051,2,1,0)
Enter a message number (|1|-|2|) to read a message in this basket.
"KRN",.84,34051,2,2,0)
Enter an internal message number to read any message still on the system,
"KRN",.84,34051,2,3,0)
which you ever sent or received.  Enter: 
"KRN",.84,34051,3,0)
^.845^2^2
"KRN",.84,34051,3,1,0)
1^first message sequence number in basket
"KRN",.84,34051,3,2,0)
2^last message sequence number in basket
"KRN",.84,34051,5,0)
^.841^1^1
"KRN",.84,34051,5,1,0)
XMJMLR1
"KRN",.84,34051,5,"B","XMJMLR1",1)

"KRN",.84,34051.1,-1)
0^14
"KRN",.84,34051.1,0)
34051.1^3^y^MAILMAN^Enter a message number (|1|-|2|) to read a
"KRN",.84,34051.1,2,0)
^^1^1^2991216^
"KRN",.84,34051.1,2,1,0)
Enter a message number (|1|-|2|) to read a message.  Enter:
"KRN",.84,34051.1,3,0)
^.845^2^2
"KRN",.84,34051.1,3,1,0)
1^first message sequence number
"KRN",.84,34051.1,3,2,0)
2^last message sequence number
"KRN",.84,34051.1,5,0)
^.841^1^1
"KRN",.84,34051.1,5,1,0)
XMJMLR1
"KRN",.84,34051.1,5,"B","XMJMLR1",1)

"KRN",.84,34052,-1)
0^15
"KRN",.84,34052,0)
34052^3^^MAILMAN^ ?string             Search for messages
"KRN",.84,34052,2,0)
^^4^4^2991216^^^
"KRN",.84,34052,2,1,0)
 ?string             Search for messages in this basket whose subject
"KRN",.84,34052,2,2,0)
                     contains the specified string
"KRN",.84,34052,2,3,0)
 ??string            Search for messages you once sent or received
"KRN",.84,34052,2,4,0)
                     whose subject begins with the specified string
"KRN",.84,34052,5,0)
^.841^1^1
"KRN",.84,34052,5,1,0)
XMJMLR1
"KRN",.84,34052,5,"B","XMJMLR1",1)

"KRN",.84,34053,-1)
0^16
"KRN",.84,34053,0)
34053^3^^MAILMAN^ .(-)n or n-m,a,c-d  (de)select message n
"KRN",.84,34053,2,0)
^^2^2^2991216^^
"KRN",.84,34053,2,1,0)
 .(-)n or n-m,a,c-d  (de)select message n or a list of messages
"KRN",.84,34053,2,2,0)
 .(-)*               (de)select all messages
"KRN",.84,34053,5,0)
^.841^1^1
"KRN",.84,34053,5,1,0)
XMJMLR1
"KRN",.84,34053,5,"B","XMJMLR1",1)

"KRN",.84,34054,-1)
0^17
"KRN",.84,34054,0)
34054^2^^MAILMAN^Enter a code from the list.
"KRN",.84,34054,2,0)
^^1^1^2991216^
"KRN",.84,34054,2,1,0)
Enter a code from the list.
"KRN",.84,34054,5,0)
^.841^1^1
"KRN",.84,34054,5,1,0)
XMJDIR
"KRN",.84,34054,5,"B","XMJDIR",1)

"KRN",.84,34055,-1)
0^18
"KRN",.84,34055,0)
34055^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34055,2,0)
^^3^3^2991215^
"KRN",.84,34055,2,1,0)
Press ENTER or + to go to the next page.  Enter +n to page forward n pages.
"KRN",.84,34055,2,2,0)
Enter - to go to the previous page.  Enter -n to page back n pages.
"KRN",.84,34055,2,3,0)
Enter 0 to go to the first page; = to refresh this page; ^ to exit.
"KRN",.84,34055,5,0)
^.841^1^1
"KRN",.84,34055,5,1,0)
XMJMLR1
"KRN",.84,34055,5,"B","XMJMLR1",1)

"KRN",.84,34056,-1)
0^19
"KRN",.84,34056,0)
34056^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34056,2,0)
^^3^3^2991215^
"KRN",.84,34056,2,1,0)
Press ENTER or + to go to the next page.
"KRN",.84,34056,2,2,0)
Enter - to go to the previous page.
"KRN",.84,34056,2,3,0)
Enter 0 to go to the first page; = to refresh this page; ^ to exit.
"KRN",.84,34056,5,0)
^.841^1^1
"KRN",.84,34056,5,1,0)
XMJMLR1
"KRN",.84,34056,5,"B","XMJMLR1",1)

"KRN",.84,34057,-1)
0^20
"KRN",.84,34057,0)
34057^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34057,2,0)
^^2^2^2991215^
"KRN",.84,34057,2,1,0)
Press ENTER or + to go to the next page.  Enter +n to page forward n pages.
"KRN",.84,34057,2,2,0)
Enter = to refresh this page; ^ to exit this list.
"KRN",.84,34057,5,0)
^.841^1^1
"KRN",.84,34057,5,1,0)
XMJMLR1
"KRN",.84,34057,5,"B","XMJMLR1",1)

"KRN",.84,34058,-1)
0^21
"KRN",.84,34058,0)
34058^3^^MAILMAN^Press ENTER or + to go to the next page.
"KRN",.84,34058,2,0)
^^2^2^2991215^
"KRN",.84,34058,2,1,0)
Press ENTER or + to go to the next page.
"KRN",.84,34058,2,2,0)
Enter = to refresh this page; ^ to exit this list.
"KRN",.84,34058,5,0)
^.841^1^1
"KRN",.84,34058,5,1,0)
XMJMLR1
"KRN",.84,34058,5,"B","XMJMLR1",1)

"KRN",.84,34059,-1)
0^22
"KRN",.84,34059,0)
34059^3^^MAILMAN^Press ENTER or U to exit this list.
"KRN",.84,34059,2,0)
^^1^1^2991215^
"KRN",.84,34059,2,1,0)
Press ENTER or ^ to exit this list.  Enter = to refresh this page.
"KRN",.84,34059,5,0)
^.841^1^1
"KRN",.84,34059,5,1,0)
XMJMLR1
"KRN",.84,34059,5,"B","XMJMLR1",1)

"KRN",.84,34060,-1)
0^23
"KRN",.84,34060,0)
34060^3^^MAILMAN^Press ENTER or U to exit this list.
"KRN",.84,34060,2,0)
^^3^3^2991215^
"KRN",.84,34060,2,1,0)
Press ENTER or ^ to exit this list.
"KRN",.84,34060,2,2,0)
Enter - to go to the previous page.  Enter -n to page back n pages.
"KRN",.84,34060,2,3,0)
Enter 0 to go to the first page; = to refresh this page.
"KRN",.84,34060,5,0)
^.841^1^1
"KRN",.84,34060,5,1,0)
XMJMLR1
"KRN",.84,34060,5,"B","XMJMLR1",1)

"KRN",.84,34061,-1)
0^24
"KRN",.84,34061,0)
34061^3^^MAILMAN^Press ENTER or U to exit this list.
"KRN",.84,34061,2,0)
^^3^3^2991215^
"KRN",.84,34061,2,1,0)
Press ENTER or ^ to exit this list.
"KRN",.84,34061,2,2,0)
Enter - to go to the previous page.
"KRN",.84,34061,2,3,0)
Enter 0 to go to the first page; = to refresh this page.
"KRN",.84,34061,5,0)
^.841^1^1
"KRN",.84,34061,5,1,0)
XMJMLR1
"KRN",.84,34061,5,"B","XMJMLR1",1)

"KRN",.84,34065,-1)
0^25
"KRN",.84,34065,0)
34065^2^y^MAILMAN^Enter message action (in |1| basket): 
"KRN",.84,34065,1,0)
^^1^1^2991216^
"KRN",.84,34065,1,1,0)
Note: there's one blank character at the end of this dialog.
"KRN",.84,34065,2,0)
^^1^1^2991216^
"KRN",.84,34065,2,1,0)
Enter message action (in |1| basket): 
"KRN",.84,34065,3,0)
^.845^1^1
"KRN",.84,34065,3,1,0)
1^basket name
"KRN",.84,34065,5,0)
^.841^1^1
"KRN",.84,34065,5,1,0)
XMJMOI
"KRN",.84,34065,5,"B","XMJMOI",1)

"KRN",.84,34066,-1)
0^26
"KRN",.84,34066,0)
34066^2^^MAILMAN^Select Edit option: 
"KRN",.84,34066,1,0)
^^1^1^2991216^
"KRN",.84,34066,1,1,0)
Note: there's one blank character at the end of this dialog.
"KRN",.84,34066,2,0)
^^1^1^2991216^
"KRN",.84,34066,2,1,0)
Select Edit option: 
"KRN",.84,34066,5,0)
^.841^1^1
"KRN",.84,34066,5,1,0)
XMJMOIE
"KRN",.84,34066,5,"B","XMJMOIE",1)

"KRN",.84,34067,-1)
0^27
"KRN",.84,34067,0)
34067^2^^MAILMAN^Select Message option: 
"KRN",.84,34067,1,0)
^^1^1^2991216^
"KRN",.84,34067,1,1,0)
Note: there is one blank at the end of this dialog
"KRN",.84,34067,2,0)
^^1^1^2991216^
"KRN",.84,34067,2,1,0)
Select Message option: 
"KRN",.84,34067,5,0)
^.841^2^2
"KRN",.84,34067,5,1,0)
XMJMRO
"KRN",.84,34067,5,2,0)
XMJMSO
"KRN",.84,34067,5,"B","XMJMRO",1)

"KRN",.84,34067,5,"B","XMJMSO",2)

"KRN",.84,34070,-1)
0^28
"KRN",.84,34070,0)
34070^2^^MAILMAN^Finished with the 'Answer' command.
"KRN",.84,34070,2,0)
^^1^1^3000110^^
"KRN",.84,34070,2,1,0)
Finished with the 'Answer' command.
"KRN",.84,34070,5,0)
^.841^1^1
"KRN",.84,34070,5,1,0)
XMJMOI
"KRN",.84,34070,5,"B","XMJMOI",1)

"KRN",.84,34071,-1)
0^29
"KRN",.84,34071,0)
34071^2^^MAILMAN^Finished with the 'Copy' command.
"KRN",.84,34071,2,0)
^^1^1^3000110^^
"KRN",.84,34071,2,1,0)
Finished with the 'Copy' command.
"KRN",.84,34071,5,0)
^.841^1^1
"KRN",.84,34071,5,1,0)
XMJMOI
"KRN",.84,34071,5,"B","XMJMOI",1)

"KRN",.84,34072,-1)
0^30
"KRN",.84,34072,0)
34072^2^^MAILMAN^Finished with the 'Write' command.
"KRN",.84,34072,2,0)
^^1^1^3000110^^
"KRN",.84,34072,2,1,0)
Finished with the 'Write' command.
"KRN",.84,34072,5,0)
^.841^1^1
"KRN",.84,34072,5,1,0)
XMJMOI
"KRN",.84,34072,5,"B","XMJMOI",1)

"KRN",.84,34075,-1)
0^31
"KRN",.84,34075,0)
34075^2^^MAILMAN^Now back to:
"KRN",.84,34075,2,0)
^^1^1^3000105^
"KRN",.84,34075,2,1,0)
Now back to:
"KRN",.84,34075,5,0)
^.841^1^1
"KRN",.84,34075,5,1,0)
XMJMOI1
"KRN",.84,34075,5,"B","XMJMOI1",1)

"KRN",.84,34076,-1)
0^32
"KRN",.84,34076,0)
34076^2^^MAILMAN^KIDS build
"KRN",.84,34076,1,0)
^^1^1^3000105^
"KRN",.84,34076,1,1,0)
used as input into 34078 & 34079.
"KRN",.84,34076,2,0)
^^1^1^3000105^
"KRN",.84,34076,2,1,0)
KIDS build
"KRN",.84,34076,5,0)
^.841^1^1
"KRN",.84,34076,5,1,0)
XMJMOI
"KRN",.84,34076,5,"B","XMJMOI",1)

"KRN",.84,34077,-1)
0^33
"KRN",.84,34077,0)
34077^2^^MAILMAN^PackMan Message
"KRN",.84,34077,1,0)
^^1^1^3000105^
"KRN",.84,34077,1,1,0)
used as input into 34078 & 34079.
"KRN",.84,34077,2,0)
^^1^1^3000105^
"KRN",.84,34077,2,1,0)
PackMan message
"KRN",.84,34077,5,0)
^.841^1^1
"KRN",.84,34077,5,1,0)
XMJMOI
"KRN",.84,34077,5,"B","XMJMOI",1)

"KRN",.84,34078,-1)
0^34
"KRN",.84,34078,0)
34078^2^y^MAILMAN^Print just the descriptive text of this |1
"KRN",.84,34078,2,0)
^^1^1^3000105^
"KRN",.84,34078,2,1,0)
Print just the descriptive text of this |1|
"KRN",.84,34078,3,0)
^.845^1^1
"KRN",.84,34078,3,1,0)
1^KIDS or PackMan
"KRN",.84,34078,5,0)
^.841^1^1
"KRN",.84,34078,5,1,0)
XMJMOI
"KRN",.84,34078,5,"B","XMJMOI",1)

"KRN",.84,34079,-1)
0^35
"KRN",.84,34079,0)
34079^3^y^MAILMAN^This is a |1|.
"KRN",.84,34079,2,0)
^^3^3^3000105^
"KRN",.84,34079,2,1,0)
This is a |1|.
"KRN",.84,34079,2,2,0)
Answer YES to print just the descriptive text.
"KRN",.84,34079,2,3,0)
Answer NO to print the whole thing (|2| lines) and/or any responses.
"KRN",.84,34079,3,0)
^.845^2^2
"KRN",.84,34079,3,1,0)
1^KIDS build or PackMan message
"KRN",.84,34079,3,2,0)
2^number of lines in the message
"KRN",.84,34079,5,0)
^.841^1^1
"KRN",.84,34079,5,1,0)
XMJMOI
"KRN",.84,34079,5,"B","XMJMOI",1)

"KRN",.84,34081,-1)
0^36
"KRN",.84,34081,0)
34081^2^^MAILMAN^This message is a priority message.
"KRN",.84,34081,2,0)
^^2^2^3000105^
"KRN",.84,34081,2,1,0)
This message is a priority message.
"KRN",.84,34081,2,2,0)
Deliver future responses to this message as Priority Mail
"KRN",.84,34081,5,0)
^.841^1^1
"KRN",.84,34081,5,1,0)
XMJMOI1
"KRN",.84,34081,5,"B","XMJMOI1",1)

"KRN",.84,34082,-1)
0^37
"KRN",.84,34082,0)
34082^3^^MAILMAN^Your answer determines, for this message,
"KRN",.84,34082,2,0)
^^7^7^3000105^
"KRN",.84,34082,2,1,0)
Your answer determines, for this message,
"KRN",.84,34082,2,2,0)
how MailMan delivers responses to you.
"KRN",.84,34082,2,3,0)
 
"KRN",.84,34082,2,4,0)
Note: Recipients can determine for themselves, on a message by message
"KRN",.84,34082,2,5,0)
basis, how responses to priority messages are delivered to them.
"KRN",.84,34082,2,6,0)
It follows that responses to priority messages are not necessarily
"KRN",.84,34082,2,7,0)
delivered as Priority Mail to all recipients.
"KRN",.84,34082,5,0)
^.841^1^1
"KRN",.84,34082,5,1,0)
XMJMOI1
"KRN",.84,34082,5,"B","XMJMOI1",1)

"KRN",.84,34216,-1)
0^38
"KRN",.84,34216,0)
34216^2^^MAILMAN^  Sending local reply...
"KRN",.84,34216,2,0)
^^1^1^2991216^
"KRN",.84,34216,2,1,0)
  Sending local reply...
"KRN",.84,34216,5,0)
^.841^1^1
"KRN",.84,34216,5,1,0)
XMJMRO
"KRN",.84,34216,5,"B","XMJMRO",1)

"KRN",.84,34217,-1)
0^39
"KRN",.84,34217,0)
34217^2^y^MAILMAN^  Sending [|1|]...
"KRN",.84,34217,2,0)
^^1^1^2991216^^
"KRN",.84,34217,2,1,0)
Sending [|1|]...
"KRN",.84,34217,3,0)
^.845^1^1
"KRN",.84,34217,3,1,0)
1^message ien in message file
"KRN",.84,34217,5,0)
^.841^1^1
"KRN",.84,34217,5,1,0)
XMJMSO
"KRN",.84,34217,5,"B","XMJMSO",1)

"KRN",.84,34250,-1)
0^388
"KRN",.84,34250,0)
34250^2^^MAILMAN^answering
"KRN",.84,34250,2,0)
^^1^1^3000107^
"KRN",.84,34250,2,1,0)
answering
"KRN",.84,34250,5,0)
^.841^1^1
"KRN",.84,34250,5,1,0)
XMJMA
"KRN",.84,34250,5,"B","XMJMA",1)

"KRN",.84,34251,-1)
0^389
"KRN",.84,34251,0)
34251^1^^MAILMAN^This message has too many lines to 'Answer
"KRN",.84,34251,2,0)
^^2^2^3000107^
"KRN",.84,34251,2,1,0)
This message has too many lines to 'Answer'.
"KRN",.84,34251,2,2,0)
Use 'Write' or 'Reply', instead.
"KRN",.84,34251,5,0)
^.841^1^1
"KRN",.84,34251,5,1,0)
XMJMA
"KRN",.84,34251,5,"B","XMJMA",1)

"KRN",.84,34252,-1)
0^390
"KRN",.84,34252,0)
34252^2^^MAILMAN^Copying original message and network signa
"KRN",.84,34252,2,0)
^^1^1^3000110^^
"KRN",.84,34252,2,1,0)
Copying original message and network signature ...
"KRN",.84,34252,5,0)
^.841^1^1
"KRN",.84,34252,5,1,0)
XMJMA
"KRN",.84,34252,5,"B","XMJMA",1)

"KRN",.84,34253,-1)
0^391
"KRN",.84,34253,0)
34253^2^y^MAILMAN^Addressing answer to: |1|
"KRN",.84,34253,2,0)
^^1^1^3000107^
"KRN",.84,34253,2,1,0)
Addressing answer to: |1|
"KRN",.84,34253,3,0)
^.845^1^1
"KRN",.84,34253,3,1,0)
1^to whom
"KRN",.84,34253,5,0)
^.841^1^1
"KRN",.84,34253,5,1,0)
XMJMA
"KRN",.84,34253,5,"B","XMJMA",1)

"KRN",.84,34254,-1)
0^392
"KRN",.84,34254,0)
34254^2^^MAILMAN^Addressing answer to sender:
"KRN",.84,34254,2,0)
^^1^1^3000107^^
"KRN",.84,34254,2,1,0)
Addressing answer to sender:
"KRN",.84,34254,5,0)
^.841^1^1
"KRN",.84,34254,5,1,0)
XMJMA
"KRN",.84,34254,5,"B","XMJMA",1)

"KRN",.84,34255,-1)
0^393
"KRN",.84,34255,0)
34255^1^y^MAILMAN^Failed in addressing answer to: |1|
"KRN",.84,34255,2,0)
^^1^1^3000107^
"KRN",.84,34255,2,1,0)
Failed in addressing answer to: |1|
"KRN",.84,34255,3,0)
^.845^1^1
"KRN",.84,34255,3,1,0)
1^bad address
"KRN",.84,34255,5,0)
^.841^1^1
"KRN",.84,34255,5,1,0)
XMJMA
"KRN",.84,34255,5,"B","XMJMA",1)

"KRN",.84,34301,-1)
0^40
"KRN",.84,34301,0)
34301^2^^MAILMAN^Delete which messages
"KRN",.84,34301,2,0)
^^1^1^2991214^
"KRN",.84,34301,2,1,0)
Delete which messages
"KRN",.84,34301,5,0)
^.841^2^2
"KRN",.84,34301,5,1,0)
XMJMOR
"KRN",.84,34301,5,2,0)
XMJMORX
"KRN",.84,34301,5,"B","XMJMOR",1)

"KRN",.84,34301,5,"B","XMJMORX",2)

"KRN",.84,34302,-1)
0^41
"KRN",.84,34302,0)
34302^2^y^MAILMAN^|1| messages deleted.
"KRN",.84,34302,2,0)
^^1^1^2991214^
"KRN",.84,34302,2,1,0)
|1| messages deleted.
"KRN",.84,34302,3,0)
^.845^1^1
"KRN",.84,34302,3,1,0)
1^number of messages
"KRN",.84,34302,5,0)
^.841^3^3
"KRN",.84,34302,5,1,0)
XMJMOR
"KRN",.84,34302,5,2,0)
XMJMORX
"KRN",.84,34302,5,3,0)
XMXMSGS
"KRN",.84,34302,5,"B","XMJMOR",1)

"KRN",.84,34302,5,"B","XMJMORX",2)

"KRN",.84,34302,5,"B","XMXMSGS",3)

"KRN",.84,34302.1,-1)
0^382
"KRN",.84,34302.1,0)
34302.1^2^^MAILMAN^1 message deleted.
"KRN",.84,34302.1,2,0)
^^1^1^2991214^
"KRN",.84,34302.1,2,1,0)
1 message deleted.
"KRN",.84,34302.1,5,0)
^.841^3^3
"KRN",.84,34302.1,5,1,0)
XMJMOR
"KRN",.84,34302.1,5,2,0)
XMJMORX
"KRN",.84,34302.1,5,3,0)
XMXMSGS
"KRN",.84,34302.1,5,"B","XMJMOR",1)

"KRN",.84,34302.1,5,"B","XMJMORX",2)

"KRN",.84,34302.1,5,"B","XMXMSGS",3)

"KRN",.84,34302.2,-1)
0^383
"KRN",.84,34302.2,0)
34302.2^2^^MAILMAN^Message deleted.
"KRN",.84,34302.2,2,0)
^^1^1^2991214^
"KRN",.84,34302.2,2,1,0)
Message deleted.
"KRN",.84,34302.2,5,0)
^.841^1^1
"KRN",.84,34302.2,5,1,0)
XMJMOI
"KRN",.84,34302.2,5,"B","XMJMOI",1)

"KRN",.84,34303,-1)
0^42
"KRN",.84,34303,0)
34303^2^^MAILMAN^Are you sure you want to delete the sel
"KRN",.84,34303,2,0)
^^1^1^2991214^
"KRN",.84,34303,2,1,0)
Are you sure you want to delete the selected messages
"KRN",.84,34303,5,0)
^.841^2^2
"KRN",.84,34303,5,1,0)
XMJMOR
"KRN",.84,34303,5,2,0)
XMJMORX
"KRN",.84,34303,5,"B","XMJMOR",1)

"KRN",.84,34303,5,"B","XMJMORX",2)

"KRN",.84,34303.1,-1)
0^384
"KRN",.84,34303.1,0)
34303.1^2^^MAILMAN^Do you really want to delete these mess
"KRN",.84,34303.1,2,0)
^^1^1^2991214^
"KRN",.84,34303.1,2,1,0)
Do you really want to delete these messages
"KRN",.84,34303.1,5,0)
^.841^2^2
"KRN",.84,34303.1,5,1,0)
XMJMOR
"KRN",.84,34303.1,5,2,0)
XMJMORX
"KRN",.84,34303.1,5,"B","XMJMOR",1)

"KRN",.84,34303.1,5,"B","XMJMORX",2)

"KRN",.84,34305,-1)
0^43
"KRN",.84,34305,0)
34305^2^^MAILMAN^Filter which messages
"KRN",.84,34305,2,0)
^^1^1^2991214^
"KRN",.84,34305,2,1,0)
Filter which messages
"KRN",.84,34305,5,0)
^.841^2^2
"KRN",.84,34305,5,1,0)
XMJMOR
"KRN",.84,34305,5,2,0)
XMJMORX
"KRN",.84,34305,5,"B","XMJMOR",1)

"KRN",.84,34305,5,"B","XMJMORX",2)

"KRN",.84,34306,-1)
0^44
"KRN",.84,34306,0)
34306^2^y^MAILMAN^|1| messages filtered.
"KRN",.84,34306,2,0)
^^1^1^2991214^
"KRN",.84,34306,2,1,0)
|1| messages filtered.
"KRN",.84,34306,3,0)
^.845^1^1
"KRN",.84,34306,3,1,0)
1^number of messages
"KRN",.84,34306,5,0)
^.841^3^3
"KRN",.84,34306,5,1,0)
XMJMOR
"KRN",.84,34306,5,2,0)
XMJMORX
"KRN",.84,34306,5,3,0)
XMXMSGS
"KRN",.84,34306,5,"B","XMJMOR",1)

"KRN",.84,34306,5,"B","XMJMORX",2)

"KRN",.84,34306,5,"B","XMXMSGS",3)

"KRN",.84,34306.1,-1)
0^45
"KRN",.84,34306.1,0)
34306.1^2^^MAILMAN^1 message filtered.
"KRN",.84,34306.1,2,0)
^^1^1^2991214^
"KRN",.84,34306.1,2,1,0)
1 message filtered.
"KRN",.84,34306.1,5,0)
^.841^3^3
"KRN",.84,34306.1,5,1,0)
XMJMOR
"KRN",.84,34306.1,5,2,0)
XMJMORX
"KRN",.84,34306.1,5,3,0)
XMXMSGS
"KRN",.84,34306.1,5,"B","XMJMOR",1)

"KRN",.84,34306.1,5,"B","XMJMORX",2)

"KRN",.84,34306.1,5,"B","XMXMSGS",3)

"KRN",.84,34308,-1)
0^46
"KRN",.84,34308,0)
34308^2^^MAILMAN^Forward which messages
"KRN",.84,34308,2,0)
^^1^1^2991214^
"KRN",.84,34308,2,1,0)
Forward which messages
"KRN",.84,34308,5,0)
^.841^2^2
"KRN",.84,34308,5,1,0)
XMJMOR
"KRN",.84,34308,5,2,0)
XMJMORX
"KRN",.84,34308,5,"B","XMJMOR",1)

"KRN",.84,34308,5,"B","XMJMORX",2)

"KRN",.84,34309,-1)
0^47
"KRN",.84,34309,0)
34309^2^y^MAILMAN^|1| messages forwarded.
"KRN",.84,34309,2,0)
^^1^1^2991214^
"KRN",.84,34309,2,1,0)
|1| messages forwarded.
"KRN",.84,34309,3,0)
^.845^1^1
"KRN",.84,34309,3,1,0)
1^number of messages
"KRN",.84,34309,5,0)
^.841^3^3
"KRN",.84,34309,5,1,0)
XMJMOR
"KRN",.84,34309,5,2,0)
XMJMORX
"KRN",.84,34309,5,3,0)
XMXMSGS
"KRN",.84,34309,5,"B","XMJMOR",1)

"KRN",.84,34309,5,"B","XMJMORX",2)

"KRN",.84,34309,5,"B","XMXMSGS",3)

"KRN",.84,34309.1,-1)
0^48
"KRN",.84,34309.1,0)
34309.1^2^^MAILMAN^1 message forwarded.
"KRN",.84,34309.1,2,0)
^^1^1^2991214^
"KRN",.84,34309.1,2,1,0)
1 message forwarded.
"KRN",.84,34309.1,5,0)
^.841^3^3
"KRN",.84,34309.1,5,1,0)
XMJMOR
"KRN",.84,34309.1,5,2,0)
XMJMORX
"KRN",.84,34309.1,5,3,0)
XMXMSGS
"KRN",.84,34309.1,5,"B","XMJMOR",1)

"KRN",.84,34309.1,5,"B","XMJMORX",2)

"KRN",.84,34309.1,5,"B","XMXMSGS",3)

"KRN",.84,34309.2,-1)
0^49
"KRN",.84,34309.2,0)
34309.2^2^^MAILMAN^Message forwarded.
"KRN",.84,34309.2,2,0)
^^1^1^2991214^
"KRN",.84,34309.2,2,1,0)
Message forwarded.
"KRN",.84,34309.2,5,0)
^.841^2^2
"KRN",.84,34309.2,5,1,0)
XMJMOI
"KRN",.84,34309.2,5,2,0)
XMJMOR
"KRN",.84,34309.2,5,"B","XMJMOI",1)

"KRN",.84,34309.2,5,"B","XMJMOR",2)

"KRN",.84,34309.3,-1)
0^50
"KRN",.84,34309.3,0)
34309.3^2^^MAILMAN^No messages forwarded.
"KRN",.84,34309.3,2,0)
^^1^1^2991214^^
"KRN",.84,34309.3,2,1,0)
No messages forwarded.
"KRN",.84,34309.3,5,0)
^.841^2^2
"KRN",.84,34309.3,5,1,0)
XMJMOR
"KRN",.84,34309.3,5,2,0)
XMJMORX
"KRN",.84,34309.3,5,"B","XMJMOR",1)

"KRN",.84,34309.3,5,"B","XMJMORX",2)

"KRN",.84,34311,-1)
0^51
"KRN",.84,34311,0)
34311^2^^MAILMAN^Later which messages
"KRN",.84,34311,2,0)
^^1^1^2991214^
"KRN",.84,34311,2,1,0)
Later which messages
"KRN",.84,34311,5,0)
^.841^2^2
"KRN",.84,34311,5,1,0)
XMJMOR
"KRN",.84,34311,5,2,0)
XMJMORX
"KRN",.84,34311,5,"B","XMJMOR",1)

"KRN",.84,34311,5,"B","XMJMORX",2)

"KRN",.84,34312,-1)
0^52
"KRN",.84,34312,0)
34312^2^y^MAILMAN^|1| messages latered.
"KRN",.84,34312,2,0)
^^1^1^2991214^
"KRN",.84,34312,2,1,0)
|1| messages latered.
"KRN",.84,34312,3,0)
^.845^1^1
"KRN",.84,34312,3,1,0)
1^number of messages
"KRN",.84,34312,5,0)
^.841^3^3
"KRN",.84,34312,5,1,0)
XMJMOR
"KRN",.84,34312,5,2,0)
XMJMORX
"KRN",.84,34312,5,3,0)
XMXMSGS
"KRN",.84,34312,5,"B","XMJMOR",1)

"KRN",.84,34312,5,"B","XMJMORX",2)

"KRN",.84,34312,5,"B","XMXMSGS",3)

"KRN",.84,34312.1,-1)
0^53
"KRN",.84,34312.1,0)
34312.1^2^^MAILMAN^1 message latered.
"KRN",.84,34312.1,2,0)
^^1^1^2991214^
"KRN",.84,34312.1,2,1,0)
1 message latered.
"KRN",.84,34312.1,5,0)
^.841^3^3
"KRN",.84,34312.1,5,1,0)
XMJMOR
"KRN",.84,34312.1,5,2,0)
XMJMORX
"KRN",.84,34312.1,5,3,0)
XMXMSGS
"KRN",.84,34312.1,5,"B","XMJMOR",1)

"KRN",.84,34312.1,5,"B","XMJMORX",2)

"KRN",.84,34312.1,5,"B","XMXMSGS",3)

"KRN",.84,34314,-1)
0^54
"KRN",.84,34314,0)
34314^2^^MAILMAN^New Toggle which messages
"KRN",.84,34314,2,0)
^^1^1^2991214^
"KRN",.84,34314,2,1,0)
New Toggle which messages
"KRN",.84,34314,5,0)
^.841^2^2
"KRN",.84,34314,5,1,0)
XMJMOR
"KRN",.84,34314,5,2,0)
XMJMORX
"KRN",.84,34314,5,"B","XMJMOR",1)

"KRN",.84,34314,5,"B","XMJMORX",2)

"KRN",.84,34315,-1)
0^55
"KRN",.84,34315,0)
34315^2^y^MAILMAN^|1| messages new toggled.
"KRN",.84,34315,2,0)
^^1^1^2991214^^
"KRN",.84,34315,2,1,0)
|1| messages new toggled.
"KRN",.84,34315,3,0)
^.845^1^1
"KRN",.84,34315,3,1,0)
1^number of messages
"KRN",.84,34315,5,0)
^.841^3^3
"KRN",.84,34315,5,1,0)
XMJMOR
"KRN",.84,34315,5,2,0)
XMJMORX
"KRN",.84,34315,5,3,0)
XMXMSGS
"KRN",.84,34315,5,"B","XMJMOR",1)

"KRN",.84,34315,5,"B","XMJMORX",2)

"KRN",.84,34315,5,"B","XMXMSGS",3)

"KRN",.84,34315.1,-1)
0^56
"KRN",.84,34315.1,0)
34315.1^2^^MAILMAN^1 message new toggled.
"KRN",.84,34315.1,2,0)
^^1^1^2991214^
"KRN",.84,34315.1,2,1,0)
1 message new toggled.
"KRN",.84,34315.1,5,0)
^.841^3^3
"KRN",.84,34315.1,5,1,0)
XMJMOR
"KRN",.84,34315.1,5,2,0)
XMJMORX
"KRN",.84,34315.1,5,3,0)
XMXMSGS
"KRN",.84,34315.1,5,"B","XMJMOR",1)

"KRN",.84,34315.1,5,"B","XMJMORX",2)

"KRN",.84,34315.1,5,"B","XMXMSGS",3)

"KRN",.84,34317,-1)
0^57
"KRN",.84,34317,0)
34317^2^^MAILMAN^Print which messages
"KRN",.84,34317,2,0)
^^1^1^2991214^
"KRN",.84,34317,2,1,0)
Print which messages
"KRN",.84,34317,5,0)
^.841^2^2
"KRN",.84,34317,5,1,0)
XMJMOR
"KRN",.84,34317,5,2,0)
XMJMORX
"KRN",.84,34317,5,"B","XMJMOR",1)

"KRN",.84,34317,5,"B","XMJMORX",2)

"KRN",.84,34317.1,-1)
0^58
"KRN",.84,34317.1,0)
34317.1^2^^MAILMAN^Print which messages without headers
"KRN",.84,34317.1,2,0)
^^1^1^2991214^
"KRN",.84,34317.1,2,1,0)
Print which messages without headers
"KRN",.84,34317.1,5,0)
^.841^2^2
"KRN",.84,34317.1,5,1,0)
XMJMOR
"KRN",.84,34317.1,5,2,0)
XMJMORX
"KRN",.84,34317.1,5,"B","XMJMOR",1)

"KRN",.84,34317.1,5,"B","XMJMORX",2)

"KRN",.84,34318,-1)
0^59
"KRN",.84,34318,0)
34318^2^y^MAILMAN^|1| messages printed.
"KRN",.84,34318,2,0)
^^1^1^2991214^
"KRN",.84,34318,2,1,0)
|1| messages printed.
"KRN",.84,34318,3,0)
^.845^1^1
"KRN",.84,34318,3,1,0)
1^number of messages
"KRN",.84,34318,5,0)
^.841^3^3
"KRN",.84,34318,5,1,0)
XMJMOR
"KRN",.84,34318,5,2,0)
XMJMORX
"KRN",.84,34318,5,3,0)
XMXMSGS
"KRN",.84,34318,5,"B","XMJMOR",1)

"KRN",.84,34318,5,"B","XMJMORX",2)

"KRN",.84,34318,5,"B","XMXMSGS",3)

"KRN",.84,34318.1,-1)
0^60
"KRN",.84,34318.1,0)
34318.1^2^^MAILMAN^1 message printed.
"KRN",.84,34318.1,2,0)
^^1^1^2991214^^
"KRN",.84,34318.1,2,1,0)
1 message printed.
"KRN",.84,34318.1,5,0)
^.841^3^3
"KRN",.84,34318.1,5,1,0)
XMJMOR
"KRN",.84,34318.1,5,2,0)
XMJMORX
"KRN",.84,34318.1,5,3,0)
XMXMSGS
"KRN",.84,34318.1,5,"B","XMJMOR",1)

"KRN",.84,34318.1,5,"B","XMJMORX",2)

"KRN",.84,34318.1,5,"B","XMXMSGS",3)

"KRN",.84,34318.2,-1)
0^61
"KRN",.84,34318.2,0)
34318.2^2^^MAILMAN^Message printed.
"KRN",.84,34318.2,2,0)
^^1^1^2991214^
"KRN",.84,34318.2,2,1,0)
Message printed.
"KRN",.84,34318.2,5,0)
^.841^1^1
"KRN",.84,34318.2,5,1,0)
XMJMOR
"KRN",.84,34318.2,5,"B","XMJMOR",1)

"KRN",.84,34318.3,-1)
0^62
"KRN",.84,34318.3,0)
34318.3^2^^MAILMAN^No messages printed.
"KRN",.84,34318.3,2,0)
^^1^1^2991214^
"KRN",.84,34318.3,2,1,0)
No messages printed.
"KRN",.84,34318.3,5,0)
^.841^1^1
"KRN",.84,34318.3,5,1,0)
XMJMOR
"KRN",.84,34318.3,5,"B","XMJMOR",1)

"KRN",.84,34318.4,-1)
0^63
"KRN",.84,34318.4,0)
34318.4^2^^MAILMAN^Message not printed.
"KRN",.84,34318.4,2,0)
^^1^1^2991214^
"KRN",.84,34318.4,2,1,0)
Message not printed.
"KRN",.84,34318.4,5,0)
^.841^1^1
"KRN",.84,34318.4,5,1,0)
XMJMOR
"KRN",.84,34318.4,5,"B","XMJMOR",1)

"KRN",.84,34319,-1)
0^64
"KRN",.84,34319,0)
34319^2^^MAILMAN^No valid messages selected.
"KRN",.84,34319,2,0)
^^1^1^2991214^
"KRN",.84,34319,2,1,0)
No valid messages selected.
"KRN",.84,34319,5,0)
^.841^1^1
"KRN",.84,34319,5,1,0)
XMJMORX
"KRN",.84,34319,5,"B","XMJMORX",1)

"KRN",.84,34320,-1)
0^65
"KRN",.84,34320,0)
34320^2^y^MAILMAN^|1| messages sent to printer.
"KRN",.84,34320,2,0)
^^1^1^2991214^^
"KRN",.84,34320,2,1,0)
|1| messages sent to printer.
"KRN",.84,34320,3,0)
^.845^1^1
"KRN",.84,34320,3,1,0)
1^number of messages
"KRN",.84,34320,5,0)
^.841^1^1
"KRN",.84,34320,5,1,0)
XMXMSGS
"KRN",.84,34320,5,"B","XMXMSGS",1)

"KRN",.84,34320.1,-1)
0^66
"KRN",.84,34320.1,0)
34320.1^2^^MAILMAN^1 message sent to printer.
"KRN",.84,34320.1,2,0)
^^1^1^2991214^
"KRN",.84,34320.1,2,1,0)
1 message sent to printer.
"KRN",.84,34320.1,5,0)
^.841^1^1
"KRN",.84,34320.1,5,1,0)
XMXMSGS
"KRN",.84,34320.1,5,"B","XMXMSGS",1)

"KRN",.84,34321,-1)
0^67
"KRN",.84,34321,0)
34321^1^^MAILMAN^No messages sent to printer.  TaskMan prob
"KRN",.84,34321,2,0)
^^1^1^2991214^
"KRN",.84,34321,2,1,0)
No messages sent to printer.  TaskMan problem.
"KRN",.84,34321,5,0)
^.841^1^1
"KRN",.84,34321,5,1,0)
XMXMSGS
"KRN",.84,34321,5,"B","XMXMSGS",1)

"KRN",.84,34323,-1)
0^68
"KRN",.84,34323,0)
34323^2^^MAILMAN^Save which messages
"KRN",.84,34323,2,0)
^^1^1^2991214^
"KRN",.84,34323,2,1,0)
Save which messages
"KRN",.84,34323,5,0)
^.841^2^2
"KRN",.84,34323,5,1,0)
XMJMOR
"KRN",.84,34323,5,2,0)
XMJMORX
"KRN",.84,34323,5,"B","XMJMOR",1)

"KRN",.84,34323,5,"B","XMJMORX",2)

"KRN",.84,34324,-1)
0^69
"KRN",.84,34324,0)
34324^2^y^MAILMAN^|1| messages saved.
"KRN",.84,34324,2,0)
^^1^1^2991214^
"KRN",.84,34324,2,1,0)
|1| messages saved.
"KRN",.84,34324,3,0)
^.845^1^1
"KRN",.84,34324,3,1,0)
1^number of messages
"KRN",.84,34324,5,0)
^.841^3^3
"KRN",.84,34324,5,1,0)
XMJMOR
"KRN",.84,34324,5,2,0)
XMJMORX
"KRN",.84,34324,5,3,0)
XMXMSGS
"KRN",.84,34324,5,"B","XMJMOR",1)

"KRN",.84,34324,5,"B","XMJMORX",2)

"KRN",.84,34324,5,"B","XMXMSGS",3)

"KRN",.84,34324.1,-1)
0^70
"KRN",.84,34324.1,0)
34324.1^2^^MAILMAN^1 message saved.
"KRN",.84,34324.1,2,0)
^^1^1^2991214^
"KRN",.84,34324.1,2,1,0)
1 message saved.
"KRN",.84,34324.1,5,0)
^.841^3^3
"KRN",.84,34324.1,5,1,0)
XMJMOR
"KRN",.84,34324.1,5,2,0)
XMJMORX
"KRN",.84,34324.1,5,3,0)
XMXMSGS
"KRN",.84,34324.1,5,"B","XMJMOR",1)

"KRN",.84,34324.1,5,"B","XMJMORX",2)

"KRN",.84,34324.1,5,"B","XMXMSGS",3)

"KRN",.84,34324.2,-1)
0^71
"KRN",.84,34324.2,0)
34324.2^2^^MAILMAN^Message saved.
"KRN",.84,34324.2,2,0)
^^1^1^2991214^
"KRN",.84,34324.2,2,1,0)
Message saved.
"KRN",.84,34324.2,5,0)
^.841^1^1
"KRN",.84,34324.2,5,1,0)
XMJMOI
"KRN",.84,34324.2,5,"B","XMJMOI",1)

"KRN",.84,34324.3,-1)
0^72
"KRN",.84,34324.3,0)
34324.3^2^^MAILMAN^No messages saved.
"KRN",.84,34324.3,2,0)
^^1^1^2991214^
"KRN",.84,34324.3,2,1,0)
No messages saved.
"KRN",.84,34324.3,5,0)
^.841^1^1
"KRN",.84,34324.3,5,1,0)
XMJMOR
"KRN",.84,34324.3,5,"B","XMJMOR",1)

"KRN",.84,34325,-1)
0^73
"KRN",.84,34325,0)
34325^2^^MAILMAN^Save messages to which basket? 
"KRN",.84,34325,1,0)
^^1^1^2991214^
"KRN",.84,34325,1,1,0)
Note:  there must be one blank character at the end of this dialog.
"KRN",.84,34325,2,0)
^^1^1^2991214^
"KRN",.84,34325,2,1,0)
Save messages to which basket? 
"KRN",.84,34325,5,0)
^.841^2^2
"KRN",.84,34325,5,1,0)
XMJMOR
"KRN",.84,34325,5,2,0)
XMJMORX
"KRN",.84,34325,5,"B","XMJMOR",1)

"KRN",.84,34325,5,"B","XMJMORX",2)

"KRN",.84,34325.1,-1)
0^74
"KRN",.84,34325.1,0)
34325.1^2^^MAILMAN^Save message into basket:  
"KRN",.84,34325.1,1,0)
^^1^1^2991214^
"KRN",.84,34325.1,1,1,0)
Note: this dialog has to blank characters at the end.
"KRN",.84,34325.1,2,0)
^^1^1^2991214^
"KRN",.84,34325.1,2,1,0)
Save message into basket:  
"KRN",.84,34325.1,5,0)
^.841^1^1
"KRN",.84,34325.1,5,1,0)
XMJMOI
"KRN",.84,34325.1,5,"B","XMJMOI",1)

"KRN",.84,34325.9,-1)
0^75
"KRN",.84,34325.9,0)
34325.9^2^y^MAILMAN^Message saved to |1| basket.
"KRN",.84,34325.9,2,0)
^^1^1^2991216^^
"KRN",.84,34325.9,2,1,0)
Message saved to |1| basket.
"KRN",.84,34325.9,3,0)
^.845^1^1
"KRN",.84,34325.9,3,1,0)
1^basket name
"KRN",.84,34325.9,5,0)
^.841^1^1
"KRN",.84,34325.9,5,1,0)
XMJMOI
"KRN",.84,34325.9,5,"B","XMJMOI",1)

"KRN",.84,34326,-1)
0^76
"KRN",.84,34326,0)
34326^1^^MAILMAN^Same basket.  No messages saved.
"KRN",.84,34326,2,0)
^^1^1^2991214^
"KRN",.84,34326,2,1,0)
Same basket.  No messages saved.
"KRN",.84,34326,5,0)
^.841^2^2
"KRN",.84,34326,5,1,0)
XMJMOR
"KRN",.84,34326,5,2,0)
XMJMORX
"KRN",.84,34326,5,"B","XMJMOR",1)

"KRN",.84,34326,5,"B","XMJMORX",2)

"KRN",.84,34326.1,-1)
0^77
"KRN",.84,34326.1,0)
34326.1^2^^MAILMAN^That's the same basket the message is al
"KRN",.84,34326.1,2,0)
^^1^1^2991214^
"KRN",.84,34326.1,2,1,0)
That's the same basket the message is already in.
"KRN",.84,34326.1,5,0)
^.841^1^1
"KRN",.84,34326.1,5,1,0)
XMJMOI
"KRN",.84,34326.1,5,"B","XMJMOI",1)

"KRN",.84,34328,-1)
0^78
"KRN",.84,34328,0)
34328^2^^MAILMAN^Terminate which messages
"KRN",.84,34328,2,0)
^^1^1^2991214^
"KRN",.84,34328,2,1,0)
Terminate which messages
"KRN",.84,34328,5,0)
^.841^2^2
"KRN",.84,34328,5,1,0)
XMJMOR
"KRN",.84,34328,5,2,0)
XMJMORX
"KRN",.84,34328,5,"B","XMJMOR",1)

"KRN",.84,34328,5,"B","XMJMORX",2)

"KRN",.84,34329,-1)
0^79
"KRN",.84,34329,0)
34329^2^y^MAILMAN^|1| messages terminated.
"KRN",.84,34329,2,0)
^^1^1^2991214^
"KRN",.84,34329,2,1,0)
|1| messages terminated.
"KRN",.84,34329,3,0)
^.845^1^1
"KRN",.84,34329,3,1,0)
1^number of messages
"KRN",.84,34329,5,0)
^.841^3^3
"KRN",.84,34329,5,1,0)
XMJMOR
"KRN",.84,34329,5,2,0)
XMJMORX
"KRN",.84,34329,5,3,0)
XMXMSGS
"KRN",.84,34329,5,"B","XMJMOR",1)

"KRN",.84,34329,5,"B","XMJMORX",2)

"KRN",.84,34329,5,"B","XMXMSGS",3)

"KRN",.84,34329.1,-1)
0^80
"KRN",.84,34329.1,0)
34329.1^2^^MAILMAN^1 message terminated.
"KRN",.84,34329.1,2,0)
^^1^1^2991214^
"KRN",.84,34329.1,2,1,0)
1 message terminated.
"KRN",.84,34329.1,5,0)
^.841^3^3
"KRN",.84,34329.1,5,1,0)
XMJMOR
"KRN",.84,34329.1,5,2,0)
XMJMORX
"KRN",.84,34329.1,5,3,0)
XMXMSGS
"KRN",.84,34329.1,5,"B","XMJMOR",1)

"KRN",.84,34329.1,5,"B","XMJMORX",2)

"KRN",.84,34329.1,5,"B","XMXMSGS",3)

"KRN",.84,34330,-1)
0^81
"KRN",.84,34330,0)
34330^2^^MAILMAN^Are you sure you want to terminate the sel
"KRN",.84,34330,2,0)
^^1^1^2991214^
"KRN",.84,34330,2,1,0)
Are you sure you want to terminate the selected messages
"KRN",.84,34330,5,0)
^.841^2^2
"KRN",.84,34330,5,1,0)
XMJMOR
"KRN",.84,34330,5,2,0)
XMJMORX
"KRN",.84,34330,5,"B","XMJMOR",1)

"KRN",.84,34330,5,"B","XMJMORX",2)

"KRN",.84,34330.1,-1)
0^82
"KRN",.84,34330.1,0)
34330.1^2^^MAILMAN^Do you really want to terminate these mess
"KRN",.84,34330.1,2,0)
^^1^1^2991214^
"KRN",.84,34330.1,2,1,0)
Do you really want to terminate these messages
"KRN",.84,34330.1,5,0)
^.841^2^2
"KRN",.84,34330.1,5,1,0)
XMJMOR
"KRN",.84,34330.1,5,2,0)
XMJMORX
"KRN",.84,34330.1,5,"B","XMJMOR",1)

"KRN",.84,34330.1,5,"B","XMJMORX",2)

"KRN",.84,34331,-1)
0^83
"KRN",.84,34331,0)
34331^2^^MAILMAN^You won't see future responses.  (In WASTE
"KRN",.84,34331,2,0)
^^1^1^2991214^
"KRN",.84,34331,2,1,0)
You won't see future responses.  (In WASTE basket)
"KRN",.84,34331,5,0)
^.841^2^2
"KRN",.84,34331,5,1,0)
XMJMOR
"KRN",.84,34331,5,2,0)
XMJMORX
"KRN",.84,34331,5,"B","XMJMOR",1)

"KRN",.84,34331,5,"B","XMJMORX",2)

"KRN",.84,34331.1,-1)
0^84
"KRN",.84,34331.1,0)
34331.1^2^^MAILMAN^You won't see future responses.
"KRN",.84,34331.1,2,0)
^^1^1^2991214^
"KRN",.84,34331.1,2,1,0)
You won't see future responses.
"KRN",.84,34331.1,5,0)
^.841^2^2
"KRN",.84,34331.1,5,1,0)
XMJMOR
"KRN",.84,34331.1,5,2,0)
XMJMORX
"KRN",.84,34331.1,5,"B","XMJMOR",1)

"KRN",.84,34331.1,5,"B","XMJMORX",2)

"KRN",.84,34333,-1)
0^85
"KRN",.84,34333,0)
34333^2^^MAILMAN^Toggle xmit priority for which messages
"KRN",.84,34333,2,0)
^^1^1^2991214^
"KRN",.84,34333,2,1,0)
Toggle xmit priority for which messages
"KRN",.84,34333,5,0)
^.841^2^2
"KRN",.84,34333,5,1,0)
XMJMOR
"KRN",.84,34333,5,2,0)
XMJMORX
"KRN",.84,34333,5,"B","XMJMOR",1)

"KRN",.84,34333,5,"B","XMJMORX",2)

"KRN",.84,34334,-1)
0^86
"KRN",.84,34334,0)
34334^2^y^MAILMAN^|1| messages xmit priority toggled.
"KRN",.84,34334,2,0)
^^1^1^2991214^
"KRN",.84,34334,2,1,0)
|1| messages xmit priority toggled.
"KRN",.84,34334,3,0)
^.845^1^1
"KRN",.84,34334,3,1,0)
1^number of messages
"KRN",.84,34334,5,0)
^.841^3^3
"KRN",.84,34334,5,1,0)
XMJMOR
"KRN",.84,34334,5,2,0)
XMJMORX
"KRN",.84,34334,5,3,0)
XMXMSGS
"KRN",.84,34334,5,"B","XMJMOR",1)

"KRN",.84,34334,5,"B","XMJMORX",2)

"KRN",.84,34334,5,"B","XMXMSGS",3)

"KRN",.84,34334.1,-1)
0^87
"KRN",.84,34334.1,0)
34334.1^2^^MAILMAN^1 message xmit priority toggled.
"KRN",.84,34334.1,2,0)
^^1^1^2991214^
"KRN",.84,34334.1,2,1,0)
1 message xmit priority toggled.
"KRN",.84,34334.1,5,0)
^.841^3^3
"KRN",.84,34334.1,5,1,0)
XMJMOR
"KRN",.84,34334.1,5,2,0)
XMJMORX
"KRN",.84,34334.1,5,3,0)
XMXMSGS
"KRN",.84,34334.1,5,"B","XMJMOR",1)

"KRN",.84,34334.1,5,"B","XMJMORX",2)

"KRN",.84,34334.1,5,"B","XMXMSGS",3)

"KRN",.84,34335,-1)
0^88
"KRN",.84,34335,0)
34335^2^^MAILMAN^Are you sure you want to toggle the xmit
"KRN",.84,34335,2,0)
^^1^1^2991214^
"KRN",.84,34335,2,1,0)
Are you sure you want to toggle the xmit priority for the selected messages
"KRN",.84,34335,5,0)
^.841^2^2
"KRN",.84,34335,5,1,0)
XMJMOR
"KRN",.84,34335,5,2,0)
XMJMORX
"KRN",.84,34335,5,"B","XMJMOR",1)

"KRN",.84,34335,5,"B","XMJMORX",2)

"KRN",.84,34335.1,-1)
0^89
"KRN",.84,34335.1,0)
34335.1^2^^MAILMAN^Do you really want to xmit priority toggle
"KRN",.84,34335.1,2,0)
^^1^1^2991214^
"KRN",.84,34335.1,2,1,0)
Do you really want to xmit priority toggle these messages
"KRN",.84,34335.1,5,0)
^.841^2^2
"KRN",.84,34335.1,5,1,0)
XMJMOR
"KRN",.84,34335.1,5,2,0)
XMJMORX
"KRN",.84,34335.1,5,"B","XMJMOR",1)

"KRN",.84,34335.1,5,"B","XMJMORX",2)

"KRN",.84,34350,-1)
0^90
"KRN",.84,34350,0)
34350^1^y^MAILMAN^Range '|1|-|2|' invalid.
"KRN",.84,34350,2,0)
^^1^1^2991220^
"KRN",.84,34350,2,1,0)
Range '|1|-|2|' invalid.
"KRN",.84,34350,3,0)
^.845^2^2
"KRN",.84,34350,3,1,0)
1^start of message range
"KRN",.84,34350,3,2,0)
2^end of message range
"KRN",.84,34350,5,0)
^.841^1^1
"KRN",.84,34350,5,1,0)
XMXMSGS
"KRN",.84,34350,5,"B","XMXMSGS",1)

"KRN",.84,34352,-1)
0^92
"KRN",.84,34352,0)
34352^1^y^MAILMAN^Message '|1|' (message '|2|' in basket '|3
"KRN",.84,34352,2,0)
^^1^1^2991220^
"KRN",.84,34352,2,1,0)
Message '|1|' (message '|2|' in basket '|3|') does not exist.
"KRN",.84,34352,3,0)
^.845^3^3
"KRN",.84,34352,3,1,0)
1^message ien in message file
"KRN",.84,34352,3,2,0)
2^message sequence number in basket
"KRN",.84,34352,3,3,0)
3^basket ien
"KRN",.84,34352,5,0)
^.841^2^2
"KRN",.84,34352,5,1,0)
XMXMSGS
"KRN",.84,34352,5,2,0)
XMXSEC1
"KRN",.84,34352,5,"B","XMXMSGS",1)

"KRN",.84,34352,5,"B","XMXSEC1",2)

"KRN",.84,34353,-1)
0^93
"KRN",.84,34353,0)
34353^1^^MAILMAN^XMZ message ranges are not allowed.
"KRN",.84,34353,2,0)
^^1^1^2991220^
"KRN",.84,34353,2,1,0)
XMZ message ranges are not allowed.
"KRN",.84,34353,5,0)
^.841^1^1
"KRN",.84,34353,5,1,0)
XMXMSGS
"KRN",.84,34353,5,"B","XMXMSGS",1)

"KRN",.84,34401,-1)
0^94
"KRN",.84,34401,0)
34401^2^^MAILMAN^  No matches found.
"KRN",.84,34401,2,0)
^^1^1^2991221^
"KRN",.84,34401,2,1,0)
  No matches found.
"KRN",.84,34401,5,0)
^.841^2^2
"KRN",.84,34401,5,1,0)
XMJMFA
"KRN",.84,34401,5,2,0)
XMJMFB
"KRN",.84,34401,5,"B","XMJMFA",1)

"KRN",.84,34401,5,"B","XMJMFB",2)

"KRN",.84,34402,-1)
0^95
"KRN",.84,34402,0)
34402^2^^MAILMAN^Search finished.
"KRN",.84,34402,2,0)
^^1^1^2991221^
"KRN",.84,34402,2,1,0)
Search finished.
"KRN",.84,34402,5,0)
^.841^2^2
"KRN",.84,34402,5,1,0)
XMJMFA
"KRN",.84,34402,5,2,0)
XMJMFB
"KRN",.84,34402,5,"B","XMJMFA",1)

"KRN",.84,34402,5,"B","XMJMFB",2)

"KRN",.84,34500,-1)
0^96
"KRN",.84,34500,0)
34500^2^^MAILMAN^Print
"KRN",.84,34500,2,0)
^^1^1^3000103^
"KRN",.84,34500,2,1,0)
Print
"KRN",.84,34500,5,0)
^.841^1^1
"KRN",.84,34500,5,1,0)
XMJMP
"KRN",.84,34500,5,"B","XMJMP",1)

"KRN",.84,34501,-1)
0^97
"KRN",.84,34501,0)
34501^2^^MAILMAN^MailMan: Print
"KRN",.84,34501,2,0)
^^1^1^3000103^
"KRN",.84,34501,2,1,0)
MailMan: Print
"KRN",.84,34501,5,0)
^.841^1^1
"KRN",.84,34501,5,1,0)
XMJMP
"KRN",.84,34501,5,"B","XMJMP",1)

"KRN",.84,34502,-1)
0^98
"KRN",.84,34502,0)
34502^2^y^MAILMAN^MailMan message for |1|
"KRN",.84,34502,2,0)
^^1^1^3000103^
"KRN",.84,34502,2,1,0)
MailMan message for |1|
"KRN",.84,34502,3,0)
^.845^1^1
"KRN",.84,34502,3,1,0)
1^user name
"KRN",.84,34502,5,0)
^.841^1^1
"KRN",.84,34502,5,1,0)
XMJMP
"KRN",.84,34502,5,"B","XMJMP",1)

"KRN",.84,34503,-1)
0^99
"KRN",.84,34503,0)
34503^2^y^MAILMAN^Printed at |1|  |2|
"KRN",.84,34503,2,0)
^^1^1^3000103^
"KRN",.84,34503,2,1,0)
Printed at |1|  |2|
"KRN",.84,34503,3,0)
^.845^2^2
"KRN",.84,34503,3,1,0)
1^site name
"KRN",.84,34503,3,2,0)
2^current date/time
"KRN",.84,34503,5,0)
^.841^1^1
"KRN",.84,34503,5,1,0)
XMJMP
"KRN",.84,34503,5,"B","XMJMP",1)

"KRN",.84,34504,-1)
0^100
"KRN",.84,34504,0)
34504^2^^MAILMAN^Print recipient list
"KRN",.84,34504,2,0)
^^1^1^3000103^
"KRN",.84,34504,2,1,0)
Print recipient list
"KRN",.84,34504,5,0)
^.841^1^1
"KRN",.84,34504,5,1,0)
XMJMP
"KRN",.84,34504,5,"B","XMJMP",1)

"KRN",.84,34505,-1)
0^101
"KRN",.84,34505,0)
34505^3^^MAILMAN^Answer 'Yes' if you want the recipients
"KRN",.84,34505,2,0)
^^1^1^3000103^
"KRN",.84,34505,2,1,0)
Answer 'Yes' if you want the recipients printed at the end.
"KRN",.84,34505,5,0)
^.841^1^1
"KRN",.84,34505,5,1,0)
XMJMP
"KRN",.84,34505,5,"B","XMJMP",1)

"KRN",.84,34506,-1)
0^102
"KRN",.84,34506,0)
34506^2^^MAILMAN^D:Detail
"KRN",.84,34506,2,0)
^^1^1^3000103^^
"KRN",.84,34506,2,1,0)
D:Detail
"KRN",.84,34506,5,0)
^.841^1^1
"KRN",.84,34506,5,1,0)
XMJMP
"KRN",.84,34506,5,"B","XMJMP",1)

"KRN",.84,34507,-1)
0^103
"KRN",.84,34507,0)
34507^2^^MAILMAN^S:Summary
"KRN",.84,34507,2,0)
^^1^1^3000103^
"KRN",.84,34507,2,1,0)
S:Summary
"KRN",.84,34507,5,0)
^.841^1^1
"KRN",.84,34507,5,1,0)
XMJMP
"KRN",.84,34507,5,"B","XMJMP",1)

"KRN",.84,34508,-1)
0^104
"KRN",.84,34508,0)
34508^2^^MAILMAN^Print Detail or Summary recipient chain
"KRN",.84,34508,2,0)
^^1^1^3000103^
"KRN",.84,34508,2,1,0)
Print Detail or Summary recipient chain
"KRN",.84,34508,5,0)
^.841^1^1
"KRN",.84,34508,5,1,0)
XMJMP
"KRN",.84,34508,5,"B","XMJMP",1)

"KRN",.84,34510,-1)
0^105
"KRN",.84,34510,0)
34510^2^y^MAILMAN^>> You haven't read responses |1|-|2|.
"KRN",.84,34510,2,0)
^^1^1^3000103^
"KRN",.84,34510,2,1,0)
>> You haven't read responses |1|-|2|.  You may backup to see them. <<
"KRN",.84,34510,3,0)
^.845^2^2
"KRN",.84,34510,3,1,0)
1^first response not read
"KRN",.84,34510,3,2,0)
2^last response not read
"KRN",.84,34510,5,0)
^.841^1^1
"KRN",.84,34510,5,1,0)
XMJMP
"KRN",.84,34510,5,"B","XMJMP",1)

"KRN",.84,34511,-1)
0^106
"KRN",.84,34511,0)
34511^2^y^MAILMAN^>> You haven't read response |1|.  You may
"KRN",.84,34511,2,0)
^^1^1^3000103^
"KRN",.84,34511,2,1,0)
>> You haven't read response |1|.  You may backup to see it. <<
"KRN",.84,34511,3,0)
^.845^1^1
"KRN",.84,34511,3,1,0)
1^response not read
"KRN",.84,34511,5,0)
^.841^1^1
"KRN",.84,34511,5,1,0)
XMJMP
"KRN",.84,34511,5,"B","XMJMP",1)

"KRN",.84,34512,-1)
0^107
"KRN",.84,34512,0)
34512^2^y^MAILMAN^>> Response |1| has arrived - you may back
"KRN",.84,34512,2,0)
^^1^1^3000103^
"KRN",.84,34512,2,1,0)
>> Response |1| has arrived - you may backup to see it. <<
"KRN",.84,34512,3,0)
^.845^1^1
"KRN",.84,34512,3,1,0)
1^latest response
"KRN",.84,34512,5,0)
^.841^1^1
"KRN",.84,34512,5,1,0)
XMJMP
"KRN",.84,34512,5,"B","XMJMP",1)

"KRN",.84,34513,-1)
0^108
"KRN",.84,34513,0)
34513^2^^MAILMAN^Backup to
"KRN",.84,34513,2,0)
^^1^1^3000103^
"KRN",.84,34513,2,1,0)
Backup to
"KRN",.84,34513,5,0)
^.841^1^1
"KRN",.84,34513,5,1,0)
XMJMP
"KRN",.84,34513,5,"B","XMJMP",1)

"KRN",.84,34514,-1)
0^109
"KRN",.84,34514,0)
34514^2^y^MAILMAN^There is 1 response.  Response 0 is the
"KRN",.84,34514,2,0)
^^1^1^3000104^^^^
"KRN",.84,34514,2,1,0)
There is 1 response.  Response 0 is the original message.  (?? shows index)
"KRN",.84,34514,3,0)
^.845^1^1
"KRN",.84,34514,3,1,0)
1^prompt
"KRN",.84,34514,5,0)
^.841^1^1
"KRN",.84,34514,5,1,0)
XMJMP
"KRN",.84,34514,5,"B","XMJMP",1)

"KRN",.84,34515,-1)
0^110
"KRN",.84,34515,0)
34515^2^y^MAILMAN^There are |1| responses.  Response 0 is
"KRN",.84,34515,2,0)
^^1^1^3000104^^^
"KRN",.84,34515,2,1,0)
There are |1| responses.  Response 0 is the original message.  (?? shows index)
"KRN",.84,34515,3,0)
^.845^1^1
"KRN",.84,34515,3,1,0)
1^number of responses
"KRN",.84,34515,5,0)
^.841^1^1
"KRN",.84,34515,5,1,0)
XMJMP
"KRN",.84,34515,5,"B","XMJMP",1)

"KRN",.84,34516,-1)
0^111
"KRN",.84,34516,0)
34516^2^y^MAILMAN^Select the responses to |1|: 
"KRN",.84,34516,1,0)
^^1^1^3000103^^
"KRN",.84,34516,1,1,0)
Note: there is one blank at the end of this dialog.
"KRN",.84,34516,2,0)
^^1^1^3000103^^
"KRN",.84,34516,2,1,0)
Select the responses to |1|: 
"KRN",.84,34516,3,0)
^.845^1^1
"KRN",.84,34516,3,1,0)
1^prompt
"KRN",.84,34516,5,0)
^.841^1^1
"KRN",.84,34516,5,1,0)
XMJMP
"KRN",.84,34516,5,"B","XMJMP",1)

"KRN",.84,34518,-1)
0^112
"KRN",.84,34518,0)
34518^2^y^MAILMAN^|1|:  
"KRN",.84,34518,1,0)
^^1^1^3000103^
"KRN",.84,34518,1,1,0)
Note: there are two blanks at the end of this dialog.
"KRN",.84,34518,2,0)
^^1^1^3000103^
"KRN",.84,34518,2,1,0)
|1|:  
"KRN",.84,34518,3,0)
^.845^1^1
"KRN",.84,34518,3,1,0)
1^prompt
"KRN",.84,34518,5,0)
^.841^1^1
"KRN",.84,34518,5,1,0)
XMJMP
"KRN",.84,34518,5,"B","XMJMP",1)

"KRN",.84,34519,-1)
0^113
"KRN",.84,34519,0)
34519^2^y^MAILMAN^|1|:  Original message  
"KRN",.84,34519,1,0)
^^1^1^3000103^^
"KRN",.84,34519,1,1,0)
Note: there are two blanks at the end of this dialog.
"KRN",.84,34519,2,0)
^^1^1^3000103^^
"KRN",.84,34519,2,1,0)
|1|:  Original message  
"KRN",.84,34519,3,0)
^.845^1^1
"KRN",.84,34519,3,1,0)
1^prompt
"KRN",.84,34519,5,0)
^.841^1^1
"KRN",.84,34519,5,1,0)
XMJMP
"KRN",.84,34519,5,"B","XMJMP",1)

"KRN",.84,34520,-1)
0^114
"KRN",.84,34520,0)
34520^3^y^MAILMAN^If you select 0, you will |1| the original
"KRN",.84,34520,2,0)
^^2^2^3000103^
"KRN",.84,34520,2,1,0)
If you select 0, you will |1| the original message.
"KRN",.84,34520,2,2,0)
If you select one of the responses, you will |1| it.
"KRN",.84,34520,3,0)
^.845^1^1
"KRN",.84,34520,3,1,0)
1^prompt
"KRN",.84,34520,5,0)
^.841^1^1
"KRN",.84,34520,5,1,0)
XMJMP
"KRN",.84,34520,5,"B","XMJMP",1)

"KRN",.84,34521,-1)
0^115
"KRN",.84,34521,0)
34521^2^^MAILMAN^This message has been secured with a pass
"KRN",.84,34521,2,0)
^^4^4^3000103^
"KRN",.84,34521,2,1,0)
This message has been secured with a password.
"KRN",.84,34521,2,2,0)
When a range of messages is queued to print,
"KRN",.84,34521,2,3,0)
those messages with passwords cannot be printed,
"KRN",.84,34521,2,4,0)
because there is no opportunity to ask for the password.
"KRN",.84,34521,5,0)
^.841^1^1
"KRN",.84,34521,5,1,0)
XMJMP
"KRN",.84,34521,5,"B","XMJMP",1)

"KRN",.84,34530,-1)
0^116
"KRN",.84,34530,0)
34530^2^^MAILMAN^There is 1 response.  Response 0 is the
"KRN",.84,34530,2,0)
^^1^1^3000104^
"KRN",.84,34530,2,1,0)
There is 1 response.  Response 0 is the original message.
"KRN",.84,34530,5,0)
^.841^1^1
"KRN",.84,34530,5,1,0)
XMJMP1
"KRN",.84,34530,5,"B","XMJMP1",1)

"KRN",.84,34531,-1)
0^117
"KRN",.84,34531,0)
34531^2^y^MAILMAN^There are |1| responses.  Response 0 is
"KRN",.84,34531,2,0)
^^1^1^3000104^
"KRN",.84,34531,2,1,0)
There are |1| responses.  Response 0 is the original message.
"KRN",.84,34531,3,0)
^.845^1^1
"KRN",.84,34531,3,1,0)
1^number of responses
"KRN",.84,34531,5,0)
^.841^1^1
"KRN",.84,34531,5,1,0)
XMJMP1
"KRN",.84,34531,5,"B","XMJMP1",1)

"KRN",.84,34532,-1)
0^118
"KRN",.84,34532,0)
34532^2^^MAILMAN^Response
"KRN",.84,34532,2,0)
^^1^1^3000104^
"KRN",.84,34532,2,1,0)
Response
"KRN",.84,34532,5,0)
^.841^1^1
"KRN",.84,34532,5,1,0)
XMJMP1
"KRN",.84,34532,5,"B","XMJMP1",1)

"KRN",.84,34533,-1)
0^119
"KRN",.84,34533,0)
34533^2^y^MAILMAN^(Sender: |1|)
"KRN",.84,34533,2,0)
^^1^1^3000104^
"KRN",.84,34533,2,1,0)
(Sender: |1|)
"KRN",.84,34533,3,0)
^.845^1^1
"KRN",.84,34533,3,1,0)
1^message sender
"KRN",.84,34533,5,0)
^.841^1^1
"KRN",.84,34533,5,1,0)
XMJMP1
"KRN",.84,34533,5,"B","XMJMP1",1)

"KRN",.84,34534,-1)
0^120
"KRN",.84,34534,0)
34534^2^y^MAILMAN^|1| lines
"KRN",.84,34534,2,0)
^^1^1^3000106^^^^
"KRN",.84,34534,2,1,0)
|1| lines
"KRN",.84,34534,3,0)
^.845^1^1
"KRN",.84,34534,3,1,0)
1^number of lines
"KRN",.84,34534,5,0)
^.841^1^1
"KRN",.84,34534,5,1,0)
XMJMP1
"KRN",.84,34534,5,"B","XMJMP1",1)

"KRN",.84,34534.1,-1)
0^125
"KRN",.84,34534.1,0)
34534.1^2^^MAILMAN^1 line
"KRN",.84,34534.1,2,0)
^^1^1^3000106^^^
"KRN",.84,34534.1,2,1,0)
1 line
"KRN",.84,34534.1,3,0)
^.845^^0
"KRN",.84,34534.1,5,0)
^.841^1^1
"KRN",.84,34534.1,5,1,0)
XMJMP1
"KRN",.84,34534.1,5,"B","XMJMP1",1)

"KRN",.84,34536,-1)
0^121
"KRN",.84,34536,0)
34536^2^y^MAILMAN^Subj: |1|
"KRN",.84,34536,2,0)
^^1^1^3000104^
"KRN",.84,34536,2,1,0)
Subj: |1|
"KRN",.84,34536,3,0)
^.845^1^1
"KRN",.84,34536,3,1,0)
1^message subject
"KRN",.84,34536,5,0)
^.841^3^3
"KRN",.84,34536,5,1,0)
XMJMP1
"KRN",.84,34536,5,2,0)
XMJMP2
"KRN",.84,34536,5,3,0)
XMJMQ
"KRN",.84,34536,5,"B","XMJMP1",1)

"KRN",.84,34536,5,"B","XMJMP2",2)

"KRN",.84,34536,5,"B","XMJMQ",3)

"KRN",.84,34537,-1)
0^122
"KRN",.84,34537,0)
34537^2^y^MAILMAN^[#|1|]
"KRN",.84,34537,2,0)
^^1^1^3000104^
"KRN",.84,34537,2,1,0)
[#|1|]
"KRN",.84,34537,3,0)
^.845^1^1
"KRN",.84,34537,3,1,0)
1^message ien in message file
"KRN",.84,34537,5,0)
^.841^4^4
"KRN",.84,34537,5,1,0)
XMJMP1
"KRN",.84,34537,5,2,0)
XMJMP2
"KRN",.84,34537,5,3,0)
XMJMQ
"KRN",.84,34537,5,4,0)
XMJMC
"KRN",.84,34537,5,"B","XMJMC",4)

"KRN",.84,34537,5,"B","XMJMP1",1)

"KRN",.84,34537,5,"B","XMJMP2",2)

"KRN",.84,34537,5,"B","XMJMQ",3)

"KRN",.84,34538,-1)
0^123
"KRN",.84,34538,0)
34538^2^y^MAILMAN^From: |1|
"KRN",.84,34538,2,0)
^^1^1^3000104^
"KRN",.84,34538,2,1,0)
From: |1|
"KRN",.84,34538,3,0)
^.845^1^1
"KRN",.84,34538,3,1,0)
1^message from
"KRN",.84,34538,5,0)
^.841^3^3
"KRN",.84,34538,5,1,0)
XMJMP1
"KRN",.84,34538,5,2,0)
XMJMP2
"KRN",.84,34538,5,3,0)
XMJMC
"KRN",.84,34538,5,"B","XMJMC",3)

"KRN",.84,34538,5,"B","XMJMP1",1)

"KRN",.84,34538,5,"B","XMJMP2",2)

"KRN",.84,34539,-1)
0^124
"KRN",.84,34539,0)
34539^2^y^MAILMAN^In '|1|' basket.
"KRN",.84,34539,2,0)
^^1^1^3000104^
"KRN",.84,34539,2,1,0)
In '|1|' basket.
"KRN",.84,34539,3,0)
^.845^1^1
"KRN",.84,34539,3,1,0)
1^basket name
"KRN",.84,34539,5,0)
^.841^1^1
"KRN",.84,34539,5,1,0)
XMJMP1
"KRN",.84,34539,5,"B","XMJMP1",1)

"KRN",.84,34540,-1)
0^126
"KRN",.84,34540,0)
34540^2^^MAILMAN^>> Confirmation message sent to sender. <<
"KRN",.84,34540,2,0)
^^1^1^3000104^
"KRN",.84,34540,2,1,0)
>> Confirmation message sent to sender. <<
"KRN",.84,34540,5,0)
^.841^1^1
"KRN",.84,34540,5,1,0)
XMJMP1
"KRN",.84,34540,5,"B","XMJMP1",1)

"KRN",.84,34541,-1)
0^127
"KRN",.84,34541,0)
34541^2^^MAILMAN^Page 1
"KRN",.84,34541,2,0)
^^1^1^3000104^
"KRN",.84,34541,2,1,0)
Page 1
"KRN",.84,34541,5,0)
^.841^1^1
"KRN",.84,34541,5,1,0)
XMJMP1
"KRN",.84,34541,5,"B","XMJMP1",1)

"KRN",.84,34542,-1)
0^128
"KRN",.84,34542,0)
34542^2^y^MAILMAN^Page |1|
"KRN",.84,34542,2,0)
^^1^1^3000104^
"KRN",.84,34542,2,1,0)
Page |1|
"KRN",.84,34542,3,0)
^.845^1^1
"KRN",.84,34542,3,1,0)
1^page number
"KRN",.84,34542,5,0)
^.841^3^3
"KRN",.84,34542,5,1,0)
XMJMP1
"KRN",.84,34542,5,2,0)
XMJMD
"KRN",.84,34542,5,3,0)
XMUT2
"KRN",.84,34542,5,"B","XMJMD",2)

"KRN",.84,34542,5,"B","XMJMP1",1)

"KRN",.84,34542,5,"B","XMUT2",3)

"KRN",.84,34543,-1)
0^129
"KRN",.84,34543,0)
34543^2^^MAILMAN^Priority!
"KRN",.84,34543,2,0)
^^1^1^3000104^
"KRN",.84,34543,2,1,0)
Priority!
"KRN",.84,34543,5,0)
^.841^2^2
"KRN",.84,34543,5,1,0)
XMJMP1
"KRN",.84,34543,5,2,0)
XMJMQ
"KRN",.84,34543,5,"B","XMJMP1",1)

"KRN",.84,34543,5,"B","XMJMQ",2)

"KRN",.84,34544,-1)
0^130
"KRN",.84,34544,0)
34544^2^^MAILMAN^*New*
"KRN",.84,34544,2,0)
^^1^1^3000104^
"KRN",.84,34544,2,1,0)
*New*
"KRN",.84,34544,5,0)
^.841^1^1
"KRN",.84,34544,5,1,0)
XMJMP1
"KRN",.84,34544,5,"B","XMJMP1",1)

"KRN",.84,34545,-1)
0^131
"KRN",.84,34545,0)
34545^2^y^MAILMAN^|1| of 1 response read.
"KRN",.84,34545,2,0)
^^1^1^3000104^^^
"KRN",.84,34545,2,1,0)
|1| of 1 response read.
"KRN",.84,34545,3,0)
^.845^1^1
"KRN",.84,34545,3,1,0)
1^number of responses read
"KRN",.84,34545,5,0)
^.841^1^1
"KRN",.84,34545,5,1,0)
XMJMP1
"KRN",.84,34545,5,"B","XMJMP1",1)

"KRN",.84,34546,-1)
0^132
"KRN",.84,34546,0)
34546^2^y^MAILMAN^|1| of |2| responses read.
"KRN",.84,34546,2,0)
^^1^1^3000104^
"KRN",.84,34546,2,1,0)
|1| of |2| responses read.
"KRN",.84,34546,3,0)
^.845^2^2
"KRN",.84,34546,3,1,0)
1^number of responses read
"KRN",.84,34546,3,2,0)
2^number of responses
"KRN",.84,34546,5,0)
^.841^1^1
"KRN",.84,34546,5,1,0)
XMJMP1
"KRN",.84,34546,5,"B","XMJMP1",1)

"KRN",.84,34550,-1)
0^133
"KRN",.84,34550,0)
34550^2^^MAILMAN^This message originated locally.  There
"KRN",.84,34550,2,0)
^^1^1^3000104^
"KRN",.84,34550,2,1,0)
This message originated locally.  There is no network header.
"KRN",.84,34550,5,0)
^.841^1^1
"KRN",.84,34550,5,1,0)
XMJMQ1
"KRN",.84,34550,5,"B","XMJMQ1",1)

"KRN",.84,34551,-1)
0^134
"KRN",.84,34551,0)
34551^2^y^MAILMAN^Envelope From:|1|
"KRN",.84,34551,2,0)
^^1^1^3000104^^
"KRN",.84,34551,2,1,0)
Envelope From:|1|
"KRN",.84,34551,3,0)
^.845^1^1
"KRN",.84,34551,3,1,0)
1^message envelope from
"KRN",.84,34551,5,0)
^.841^1^1
"KRN",.84,34551,5,1,0)
XMJMQ1
"KRN",.84,34551,5,"B","XMJMQ1",1)

"KRN",.84,34552,-1)
0^135
"KRN",.84,34552,0)
34552^2^^MAILMAN^Network header:
"KRN",.84,34552,2,0)
^^1^1^3000104^
"KRN",.84,34552,2,1,0)
Network header:
"KRN",.84,34552,5,0)
^.841^1^1
"KRN",.84,34552,5,1,0)
XMJMQ1
"KRN",.84,34552,5,"B","XMJMQ1",1)

"KRN",.84,34554,-1)
0^136
"KRN",.84,34554,0)
34554^2^y^MAILMAN^Searching for recipients that match '|1|'.
"KRN",.84,34554,2,0)
^^1^1^3000104^^
"KRN",.84,34554,2,1,0)
Searching for recipients that match '|1|'.
"KRN",.84,34554,3,0)
^.845^1^1
"KRN",.84,34554,3,1,0)
1^search string
"KRN",.84,34554,5,0)
^.841^1^1
"KRN",.84,34554,5,1,0)
XMJMQ1
"KRN",.84,34554,5,"B","XMJMQ1",1)

"KRN",.84,34555,-1)
0^137
"KRN",.84,34555,0)
34555^2^^MAILMAN^Enter the person's name or partial name
"KRN",.84,34555,2,0)
^^1^1^3000104^
"KRN",.84,34555,2,1,0)
Enter the person's name or partial name
"KRN",.84,34555,5,0)
^.841^1^1
"KRN",.84,34555,5,1,0)
XMJMQ
"KRN",.84,34555,5,"B","XMJMQ",1)

"KRN",.84,34556,-1)
0^138
"KRN",.84,34556,0)
34556^3^^MAILMAN^Name must be from 1 to 30 characters,
"KRN",.84,34556,2,0)
^^2^2^3000104^
"KRN",.84,34556,2,1,0)
Name must be from 1 to 30 characters,
"KRN",.84,34556,2,2,0)
and must not contain ^, or begin with comma or space.
"KRN",.84,34556,5,0)
^.841^1^1
"KRN",.84,34556,5,1,0)
XMJMQ
"KRN",.84,34556,5,"B","XMJMQ",1)

"KRN",.84,34557,-1)
0^139
"KRN",.84,34557,0)
34557^2^y^MAILMAN^|1| responses
"KRN",.84,34557,2,0)
^^1^1^3000106^^
"KRN",.84,34557,2,1,0)
|1| responses
"KRN",.84,34557,3,0)
^.845^1^1
"KRN",.84,34557,3,1,0)
1^number of responses
"KRN",.84,34557,5,0)
^.841^1^1
"KRN",.84,34557,5,1,0)
XMJMQ
"KRN",.84,34557,5,"B","XMJMQ",1)

"KRN",.84,34557.1,-1)
0^140
"KRN",.84,34557.1,0)
34557.1^2^^MAILMAN^1 response
"KRN",.84,34557.1,2,0)
^^1^1^3000106^
"KRN",.84,34557.1,2,1,0)
1 response
"KRN",.84,34557.1,5,0)
^.841^1^1
"KRN",.84,34557.1,5,1,0)
XMJMQ
"KRN",.84,34557.1,5,"B","XMJMQ",1)

"KRN",.84,34559,-1)
0^141
"KRN",.84,34559,0)
34559^2^y^MAILMAN^Local Message-ID: |1|
"KRN",.84,34559,2,0)
^^1^1^3000104^
"KRN",.84,34559,2,1,0)
Local Message-ID: |1|
"KRN",.84,34559,3,0)
^.845^1^1
"KRN",.84,34559,3,1,0)
1^local message id
"KRN",.84,34559,5,0)
^.841^1^1
"KRN",.84,34559,5,1,0)
XMJMQ
"KRN",.84,34559,5,"B","XMJMQ",1)

"KRN",.84,34560,-1)
0^142
"KRN",.84,34560,0)
34560^2^^MAILMAN^[SPOOL]
"KRN",.84,34560,2,0)
^^1^1^3000104^
"KRN",.84,34560,2,1,0)
[SPOOL]
"KRN",.84,34560,5,0)
^.841^1^1
"KRN",.84,34560,5,1,0)
XMJMQ
"KRN",.84,34560,5,"B","XMJMQ",1)

"KRN",.84,34561,-1)
0^143
"KRN",.84,34561,0)
34561^2^^MAILMAN^<RESPONSE>
"KRN",.84,34561,2,0)
^^1^1^3000104^
"KRN",.84,34561,2,1,0)
<RESPONSE>
"KRN",.84,34561,5,0)
^.841^1^1
"KRN",.84,34561,5,1,0)
XMJMQ
"KRN",.84,34561,5,"B","XMJMQ",1)

"KRN",.84,34562,-1)
0^144
"KRN",.84,34562,0)
34562^2^y^MAILMAN^(|1| recipients)
"KRN",.84,34562,2,0)
^^1^1^3000106^^
"KRN",.84,34562,2,1,0)
(|1| recipients)
"KRN",.84,34562,3,0)
^.845^1^1
"KRN",.84,34562,3,1,0)
1^number of recipients
"KRN",.84,34562,5,0)
^.841^1^1
"KRN",.84,34562,5,1,0)
XMJMQ
"KRN",.84,34562,5,"B","XMJMQ",1)

"KRN",.84,34562.1,-1)
0^145
"KRN",.84,34562.1,0)
34562.1^2^^MAILMAN^(1 recipient)
"KRN",.84,34562.1,2,0)
^^1^1^3000106^
"KRN",.84,34562.1,2,1,0)
(1 recipient)
"KRN",.84,34562.1,5,0)
^.841^1^1
"KRN",.84,34562.1,5,1,0)
XMJMQ
"KRN",.84,34562.1,5,"B","XMJMQ",1)

"KRN",.84,34564,-1)
0^146
"KRN",.84,34564,0)
34564^2^^MAILMAN^Confirmation requested.
"KRN",.84,34564,2,0)
^^1^1^3000104^
"KRN",.84,34564,2,1,0)
Confirmation requested.
"KRN",.84,34564,5,0)
^.841^1^1
"KRN",.84,34564,5,1,0)
XMJMQ
"KRN",.84,34564,5,"B","XMJMQ",1)

"KRN",.84,34565,-1)
0^147
"KRN",.84,34565,0)
34565^2^^MAILMAN^Scramble Hint: None.
"KRN",.84,34565,2,0)
^^1^1^3000104^
"KRN",.84,34565,2,1,0)
Scramble Hint: None.
"KRN",.84,34565,5,0)
^.841^1^1
"KRN",.84,34565,5,1,0)
XMJMQ
"KRN",.84,34565,5,"B","XMJMQ",1)

"KRN",.84,34566,-1)
0^148
"KRN",.84,34566,0)
34566^2^y^MAILMAN^Scramble Hint: |1|.
"KRN",.84,34566,2,0)
^^1^1^3000104^
"KRN",.84,34566,2,1,0)
Scramble Hint: |1|.
"KRN",.84,34566,3,0)
^.845^1^1
"KRN",.84,34566,3,1,0)
1^scramble hint
"KRN",.84,34566,5,0)
^.841^1^1
"KRN",.84,34566,5,1,0)
XMJMQ
"KRN",.84,34566,5,"B","XMJMQ",1)

"KRN",.84,34567,-1)
0^149
"KRN",.84,34567,0)
34567^2^^MAILMAN^Closed.
"KRN",.84,34567,2,0)
^^1^1^3000104^
"KRN",.84,34567,2,1,0)
Closed.
"KRN",.84,34567,5,0)
^.841^1^1
"KRN",.84,34567,5,1,0)
XMJMQ
"KRN",.84,34567,5,"B","XMJMQ",1)

"KRN",.84,34568,-1)
0^150
"KRN",.84,34568,0)
34568^2^^MAILMAN^Confidential.
"KRN",.84,34568,2,0)
^^1^1^3000104^
"KRN",.84,34568,2,1,0)
Confidential.
"KRN",.84,34568,5,0)
^.841^1^1
"KRN",.84,34568,5,1,0)
XMJMQ
"KRN",.84,34568,5,"B","XMJMQ",1)

"KRN",.84,34570,-1)
0^151
"KRN",.84,34570,0)
34570^2^^MAILMAN^'Information only' for all recipients.
"KRN",.84,34570,2,0)
^^1^1^3000104^
"KRN",.84,34570,2,1,0)
'Information only' for all recipients.
"KRN",.84,34570,5,0)
^.841^1^1
"KRN",.84,34570,5,1,0)
XMJMQ
"KRN",.84,34570,5,"B","XMJMQ",1)

"KRN",.84,34571,-1)
0^152
"KRN",.84,34571,0)
34571^2^y^MAILMAN^Delivery basket: |1|
"KRN",.84,34571,2,0)
^^1^1^3000104^
"KRN",.84,34571,2,1,0)
Delivery basket: |1|
"KRN",.84,34571,3,0)
^.845^1^1
"KRN",.84,34571,3,1,0)
1^delivery basket name
"KRN",.84,34571,5,0)
^.841^1^1
"KRN",.84,34571,5,1,0)
XMJMQ
"KRN",.84,34571,5,"B","XMJMQ",1)

"KRN",.84,34572,-1)
0^153
"KRN",.84,34572,0)
34572^2^y^MAILMAN^Automatic Deletion Date: |1|
"KRN",.84,34572,2,0)
^^1^1^3000104^
"KRN",.84,34572,2,1,0)
Automatic Deletion Date: |1|
"KRN",.84,34572,3,0)
^.845^1^1
"KRN",.84,34572,3,1,0)
1^automatic deletion date
"KRN",.84,34572,5,0)
^.841^1^1
"KRN",.84,34572,5,1,0)
XMJMQ
"KRN",.84,34572,5,"B","XMJMQ",1)

"KRN",.84,34573,-1)
0^154
"KRN",.84,34573,0)
34573^2^^MAILMAN^Attachment(s).
"KRN",.84,34573,2,0)
^^1^1^3000104^
"KRN",.84,34573,2,1,0)
Attachment(s).
"KRN",.84,34573,5,0)
^.841^2^2
"KRN",.84,34573,5,1,0)
XMJMP1
"KRN",.84,34573,5,2,0)
XMJMQ
"KRN",.84,34573,5,"B","XMJMP1",1)

"KRN",.84,34573,5,"B","XMJMQ",2)

"KRN",.84,34574,-1)
0^155
"KRN",.84,34574,0)
34574^2^^MAILMAN^ Not read.
"KRN",.84,34574,2,0)
^^1^1^3000104^
"KRN",.84,34574,2,1,0)
 Not read.
"KRN",.84,34574,5,0)
^.841^1^1
"KRN",.84,34574,5,1,0)
XMJMQ
"KRN",.84,34574,5,"B","XMJMQ",1)

"KRN",.84,34575,-1)
0^156
"KRN",.84,34575,0)
34575^2^y^MAILMAN^Last read: |1|
"KRN",.84,34575,2,0)
^^1^1^3000104^
"KRN",.84,34575,2,1,0)
Last read: |1|
"KRN",.84,34575,3,0)
^.845^1^1
"KRN",.84,34575,3,1,0)
1^date/time msg was last read
"KRN",.84,34575,5,0)
^.841^1^1
"KRN",.84,34575,5,1,0)
XMJMQ
"KRN",.84,34575,5,"B","XMJMQ",1)

"KRN",.84,34576,-1)
0^157
"KRN",.84,34576,0)
34576^2^y^MAILMAN^(|1| of |2|)
"KRN",.84,34576,1,0)
^^2^2^3000104^
"KRN",.84,34576,1,1,0)
tells how many of the message's responses the user has read.
"KRN",.84,34576,1,2,0)
Parameter 2 is created by dialogs 34557 or 34558.
"KRN",.84,34576,2,0)
^^1^1^3000104^
"KRN",.84,34576,2,1,0)
(|1| of |2|)
"KRN",.84,34576,3,0)
^.845^2^2
"KRN",.84,34576,3,1,0)
1^number of responses user has read
"KRN",.84,34576,3,2,0)
2^number of responses in the message
"KRN",.84,34576,5,0)
^.841^1^1
"KRN",.84,34576,5,1,0)
XMJMQ
"KRN",.84,34576,5,"B","XMJMQ",1)

"KRN",.84,34577,-1)
0^158
"KRN",.84,34577,0)
34577^2^y^MAILMAN^[First read: |1|]
"KRN",.84,34577,2,0)
^^1^1^3000104^
"KRN",.84,34577,2,1,0)
[First read: |1|]
"KRN",.84,34577,3,0)
^.845^1^1
"KRN",.84,34577,3,1,0)
1^date/time the user first read the msg
"KRN",.84,34577,5,0)
^.841^1^1
"KRN",.84,34577,5,1,0)
XMJMQ
"KRN",.84,34577,5,"B","XMJMQ",1)

"KRN",.84,34578,-1)
0^159
"KRN",.84,34578,0)
34578^2^y^MAILMAN^Copied: |1|
"KRN",.84,34578,2,0)
^^1^1^3000104^
"KRN",.84,34578,2,1,0)
Copied: |1|
"KRN",.84,34578,3,0)
^.845^1^1
"KRN",.84,34578,3,1,0)
1^date/time the user copied the msg
"KRN",.84,34578,5,0)
^.841^1^1
"KRN",.84,34578,5,1,0)
XMJMQ
"KRN",.84,34578,5,"B","XMJMQ",1)

"KRN",.84,34580,-1)
0^160
"KRN",.84,34580,0)
34580^2^y^MAILMAN^Surrogate: |1|
"KRN",.84,34580,2,0)
^^1^1^3000104^
"KRN",.84,34580,2,1,0)
Surrogate: |1|
"KRN",.84,34580,3,0)
^.845^1^1
"KRN",.84,34580,3,1,0)
1^surrogate who last read this msg
"KRN",.84,34580,5,0)
^.841^1^1
"KRN",.84,34580,5,1,0)
XMJMQ
"KRN",.84,34580,5,"B","XMJMQ",1)

"KRN",.84,34581,-1)
0^161
"KRN",.84,34581,0)
34581^2^y^MAILMAN^Terminated: |1|
"KRN",.84,34581,2,0)
^^1^1^3000104^
"KRN",.84,34581,2,1,0)
Terminated: |1|
"KRN",.84,34581,3,0)
^.845^1^1
"KRN",.84,34581,3,1,0)
1^date/time the user terminated the msg
"KRN",.84,34581,5,0)
^.841^1^1
"KRN",.84,34581,5,1,0)
XMJMQ
"KRN",.84,34581,5,"B","XMJMQ",1)

"KRN",.84,34582,-1)
0^162
"KRN",.84,34582,0)
34582^2^y^MAILMAN^Sent to fax: |1|
"KRN",.84,34582,2,0)
^^1^1^3000104^
"KRN",.84,34582,2,1,0)
Sent to fax: |1|
"KRN",.84,34582,3,0)
^.845^1^1
"KRN",.84,34582,3,1,0)
1^date/time the msg was sent to the fax software
"KRN",.84,34582,5,0)
^.841^1^1
"KRN",.84,34582,5,1,0)
XMJMQ
"KRN",.84,34582,5,"B","XMJMQ",1)

"KRN",.84,34583,-1)
0^163
"KRN",.84,34583,0)
34583^2^y^MAILMAN^Status: |1|
"KRN",.84,34583,2,0)
^^1^1^3000104^
"KRN",.84,34583,2,1,0)
Status: |1|
"KRN",.84,34583,3,0)
^.845^1^1
"KRN",.84,34583,3,1,0)
1^msg status
"KRN",.84,34583,5,0)
^.841^1^1
"KRN",.84,34583,5,1,0)
XMJMQ
"KRN",.84,34583,5,"B","XMJMQ",1)

"KRN",.84,34584,-1)
0^164
"KRN",.84,34584,0)
34584^2^y^MAILMAN^Fax ID: |1|
"KRN",.84,34584,2,0)
^^1^1^3000104^
"KRN",.84,34584,2,1,0)
Fax ID: |1|
"KRN",.84,34584,3,0)
^.845^1^1
"KRN",.84,34584,3,1,0)
1^fax id
"KRN",.84,34584,5,0)
^.841^1^1
"KRN",.84,34584,5,1,0)
XMJMQ
"KRN",.84,34584,5,"B","XMJMQ",1)

"KRN",.84,34585,-1)
0^165
"KRN",.84,34585,0)
34585^2^y^MAILMAN^Sent: |1|
"KRN",.84,34585,2,0)
^^1^1^3000104^
"KRN",.84,34585,2,1,0)
Sent: |1|
"KRN",.84,34585,3,0)
^.845^1^1
"KRN",.84,34585,3,1,0)
1^date/time the msg was sent
"KRN",.84,34585,5,0)
^.841^2^2
"KRN",.84,34585,5,1,0)
XMJMQ
"KRN",.84,34585,5,2,0)
XMJMC
"KRN",.84,34585,5,"B","XMJMC",2)

"KRN",.84,34585,5,"B","XMJMQ",1)

"KRN",.84,34586,-1)
0^166
"KRN",.84,34586,0)
34586^2^^MAILMAN^Time: 1 second
"KRN",.84,34586,2,0)
^^1^1^3000104^
"KRN",.84,34586,2,1,0)
Time: 1 second
"KRN",.84,34586,5,0)
^.841^1^1
"KRN",.84,34586,5,1,0)
XMJMQ
"KRN",.84,34586,5,"B","XMJMQ",1)

"KRN",.84,34587,-1)
0^167
"KRN",.84,34587,0)
34587^2^y^MAILMAN^Time: |1| seconds
"KRN",.84,34587,2,0)
^^1^1^3000104^
"KRN",.84,34587,2,1,0)
Time: |1| seconds
"KRN",.84,34587,3,0)
^.845^1^1
"KRN",.84,34587,3,1,0)
1^number of seconds the transmission took
"KRN",.84,34587,5,0)
^.841^1^1
"KRN",.84,34587,5,1,0)
XMJMQ
"KRN",.84,34587,5,"B","XMJMQ",1)

"KRN",.84,34588,-1)
0^168
"KRN",.84,34588,0)
34588^2^y^MAILMAN^Path: |1|
"KRN",.84,34588,2,0)
^^1^1^3000104^
"KRN",.84,34588,2,1,0)
Path: |1|
"KRN",.84,34588,3,0)
^.845^1^1
"KRN",.84,34588,3,1,0)
1^path the transmission took
"KRN",.84,34588,5,0)
^.841^1^1
"KRN",.84,34588,5,1,0)
XMJMQ
"KRN",.84,34588,5,"B","XMJMQ",1)

"KRN",.84,34590,-1)
0^169
"KRN",.84,34590,0)
34590^2^y^MAILMAN^Message ID: |1|
"KRN",.84,34590,2,0)
^^1^1^3000104^
"KRN",.84,34590,2,1,0)
Message ID: |1|
"KRN",.84,34590,3,0)
^.845^1^1
"KRN",.84,34590,3,1,0)
1^remote message id
"KRN",.84,34590,5,0)
^.841^1^1
"KRN",.84,34590,5,1,0)
XMJMQ
"KRN",.84,34590,5,"B","XMJMQ",1)

"KRN",.84,34591,-1)
0^170
"KRN",.84,34591,0)
34591^2^y^MAILMAN^Date: |1|
"KRN",.84,34591,2,0)
^^1^1^3000104^
"KRN",.84,34591,2,1,0)
Date: |1|
"KRN",.84,34591,3,0)
^.845^1^1
"KRN",.84,34591,3,1,0)
1^date of status
"KRN",.84,34591,5,0)
^.841^1^1
"KRN",.84,34591,5,1,0)
XMJMQ
"KRN",.84,34591,5,"B","XMJMQ",1)

"KRN",.84,34592,-1)
0^171
"KRN",.84,34592,0)
34592^2^y^MAILMAN^Forwarded on: |1|
"KRN",.84,34592,2,0)
^^1^1^3000104^
"KRN",.84,34592,2,1,0)
Forwarded on: |1|
"KRN",.84,34592,3,0)
^.845^1^1
"KRN",.84,34592,3,1,0)
1^date/time msg was forwarded
"KRN",.84,34592,5,0)
^.841^1^1
"KRN",.84,34592,5,1,0)
XMJMQ
"KRN",.84,34592,5,"B","XMJMQ",1)

"KRN",.84,34593,-1)
0^172
"KRN",.84,34593,0)
34593^2^y^MAILMAN^Forwarded by: |1|
"KRN",.84,34593,2,0)
^^1^1^3000104^
"KRN",.84,34593,2,1,0)
Forwarded by: |1|
"KRN",.84,34593,3,0)
^.845^1^1
"KRN",.84,34593,3,1,0)
1^who forwarded the msg
"KRN",.84,34593,5,0)
^.841^1^1
"KRN",.84,34593,5,1,0)
XMJMQ
"KRN",.84,34593,5,"B","XMJMQ",1)

"KRN",.84,34595,-1)
0^173
"KRN",.84,34595,0)
34595^2^^MAILMAN^Message will be NEW on: 
"KRN",.84,34595,1,0)
^^1^1^3000104^
"KRN",.84,34595,1,1,0)
Note: there is one blank at this end of this dialog
"KRN",.84,34595,2,0)
^^1^1^3000104^^
"KRN",.84,34595,2,1,0)
Message will be NEW on: 
"KRN",.84,34595,5,0)
^.841^1^1
"KRN",.84,34595,5,1,0)
XMJMQ
"KRN",.84,34595,5,"B","XMJMQ",1)

"KRN",.84,34596,-1)
0^174
"KRN",.84,34596,0)
34596^2^^MAILMAN^This message has no summary recipient list
"KRN",.84,34596,2,0)
^^2^2^3000104^^
"KRN",.84,34596,2,1,0)
This message has no summary recipient list.
"KRN",.84,34596,2,2,0)
Only the Detail Query (QD) is available.
"KRN",.84,34596,5,0)
^.841^1^1
"KRN",.84,34596,5,1,0)
XMJMQ1
"KRN",.84,34596,5,"B","XMJMQ1",1)

"KRN",.84,34597,-1)
0^175
"KRN",.84,34597,0)
34597^2^^MAILMAN^This message was addressed as follows:
"KRN",.84,34597,2,0)
^^1^1^3000104^
"KRN",.84,34597,2,1,0)
This message was addressed as follows:
"KRN",.84,34597,5,0)
^.841^1^1
"KRN",.84,34597,5,1,0)
XMJMQ1
"KRN",.84,34597,5,"B","XMJMQ1",1)

"KRN",.84,34598,-1)
0^176
"KRN",.84,34598,0)
34598^2^y^MAILMAN^for delivery |1| by |2|
"KRN",.84,34598,2,0)
^^1^1^3000104^
"KRN",.84,34598,2,1,0)
for delivery |1| by |2|
"KRN",.84,34598,3,0)
^.845^2^2
"KRN",.84,34598,3,1,0)
1^date/time to deliver the msg
"KRN",.84,34598,3,2,0)
2^who later'd delivery to this user
"KRN",.84,34598,5,0)
^.841^1^1
"KRN",.84,34598,5,1,0)
XMJMQ1
"KRN",.84,34598,5,"B","XMJMQ1",1)

"KRN",.84,34600,-1)
0^177
"KRN",.84,34600,0)
34600^2^^MAILMAN^copy
"KRN",.84,34600,2,0)
^^1^1^3000105^^
"KRN",.84,34600,2,1,0)
copy
"KRN",.84,34600,5,0)
^.841^1^1
"KRN",.84,34600,5,1,0)
XMJMC
"KRN",.84,34600,5,"B","XMJMC",1)

"KRN",.84,34601,-1)
0^178
"KRN",.84,34601,0)
34601^3^^MAILMAN^You may use the 'Transfer' option of the
"KRN",.84,34601,2,0)
^^2^2^3000105^
"KRN",.84,34601,2,1,0)
You may use the 'Transfer' option of the FileMan Editor
"KRN",.84,34601,2,2,0)
to move text from this mesage or its responses into a new message.
"KRN",.84,34601,5,0)
^.841^1^1
"KRN",.84,34601,5,1,0)
XMJMC
"KRN",.84,34601,5,"B","XMJMC",1)

"KRN",.84,34602,-1)
0^179
"KRN",.84,34602,0)
34602^2^^MAILMAN^List original recipients in text
"KRN",.84,34602,2,0)
^^1^1^3000105^
"KRN",.84,34602,2,1,0)
List original recipients in text
"KRN",.84,34602,5,0)
^.841^1^1
"KRN",.84,34602,5,1,0)
XMJMC
"KRN",.84,34602,5,"B","XMJMC",1)

"KRN",.84,34603,-1)
0^180
"KRN",.84,34603,0)
34603^2^^MAILMAN^Deliver to the same recipients
"KRN",.84,34603,2,0)
^^1^1^3000105^
"KRN",.84,34603,2,1,0)
Deliver to the same recipients
"KRN",.84,34603,5,0)
^.841^1^1
"KRN",.84,34603,5,1,0)
XMJMC
"KRN",.84,34603,5,"B","XMJMC",1)

"KRN",.84,34604,-1)
0^181
"KRN",.84,34604,0)
34604^2^^MAILMAN^LOCAL recipients (NOT recipients on remote
"KRN",.84,34604,2,0)
^^1^1^3000105^
"KRN",.84,34604,2,1,0)
LOCAL recipients (NOT recipients on remote network nodes) will be copied.
"KRN",.84,34604,5,0)
^.841^1^1
"KRN",.84,34604,5,1,0)
XMJMC
"KRN",.84,34604,5,"B","XMJMC",1)

"KRN",.84,34605,-1)
0^182
"KRN",.84,34605,0)
34605^2^y^MAILMAN^Copy of: |1|
"KRN",.84,34605,2,0)
^^1^1^3000105^^
"KRN",.84,34605,2,1,0)
Copy of: |1|
"KRN",.84,34605,3,0)
^.845^1^1
"KRN",.84,34605,3,1,0)
1^msg subject
"KRN",.84,34605,5,0)
^.841^1^1
"KRN",.84,34605,5,1,0)
XMJMC
"KRN",.84,34605,5,"B","XMJMC",1)

"KRN",.84,34606,-1)
0^183
"KRN",.84,34606,0)
34606^2^^MAILMAN^copying
"KRN",.84,34606,2,0)
^^1^1^3000105^
"KRN",.84,34606,2,1,0)
copying
"KRN",.84,34606,5,0)
^.841^1^1
"KRN",.84,34606,5,1,0)
XMJMC
"KRN",.84,34606,5,"B","XMJMC",1)

"KRN",.84,34607,-1)
0^184
"KRN",.84,34607,0)
34607^2^^MAILMAN^Copying text...
"KRN",.84,34607,2,0)
^^1^1^3000110^^
"KRN",.84,34607,2,1,0)
Copying text...
"KRN",.84,34607,5,0)
^.841^1^1
"KRN",.84,34607,5,1,0)
XMJMC
"KRN",.84,34607,5,"B","XMJMC",1)

"KRN",.84,34608,-1)
0^185
"KRN",.84,34608,0)
34608^2^^MAILMAN^Original Recipients
"KRN",.84,34608,2,0)
^^1^1^3000105^
"KRN",.84,34608,2,1,0)
Original Recipients
"KRN",.84,34608,5,0)
^.841^1^1
"KRN",.84,34608,5,1,0)
XMJMC
"KRN",.84,34608,5,"B","XMJMC",1)

"KRN",.84,34610,-1)
0^186
"KRN",.84,34610,0)
34610^2^^MAILMAN^Copying recipients into text and onto mess
"KRN",.84,34610,2,0)
^^1^1^3000110^^
"KRN",.84,34610,2,1,0)
Copying recipients into text and onto message...
"KRN",.84,34610,5,0)
^.841^1^1
"KRN",.84,34610,5,1,0)
XMJMC
"KRN",.84,34610,5,"B","XMJMC",1)

"KRN",.84,34611,-1)
0^187
"KRN",.84,34611,0)
34611^2^^MAILMAN^Copying recipients into text...
"KRN",.84,34611,2,0)
^^1^1^3000110^^
"KRN",.84,34611,2,1,0)
Copying recipients into text...
"KRN",.84,34611,5,0)
^.841^1^1
"KRN",.84,34611,5,1,0)
XMJMC
"KRN",.84,34611,5,"B","XMJMC",1)

"KRN",.84,34612,-1)
0^188
"KRN",.84,34612,0)
34612^2^^MAILMAN^Copying recipients onto message...
"KRN",.84,34612,2,0)
^^1^1^3000110^^
"KRN",.84,34612,2,1,0)
Copying recipients onto message...
"KRN",.84,34612,5,0)
^.841^1^1
"KRN",.84,34612,5,1,0)
XMJMC
"KRN",.84,34612,5,"B","XMJMC",1)

"KRN",.84,34615,-1)
0^189
"KRN",.84,34615,0)
34615^2^^MAILMAN^Scrambling...
"KRN",.84,34615,2,0)
^^1^1^3000105^
"KRN",.84,34615,2,1,0)
Scrambling...
"KRN",.84,34615,5,0)
^.841^1^1
"KRN",.84,34615,5,1,0)
XMJMCODE
"KRN",.84,34615,5,"B","XMJMCODE",1)

"KRN",.84,34616,-1)
0^190
"KRN",.84,34616,0)
34616^2^^MAILMAN^UnScrambling...
"KRN",.84,34616,2,0)
^^1^1^3000105^
"KRN",.84,34616,2,1,0)
UnScrambling...
"KRN",.84,34616,5,0)
^.841^1^1
"KRN",.84,34616,5,1,0)
XMJMCODE
"KRN",.84,34616,5,"B","XMJMCODE",1)

"KRN",.84,34617,-1)
0^191
"KRN",.84,34617,0)
34617^2^^MAILMAN^Enter Scramble Hint
"KRN",.84,34617,2,0)
^^1^1^3000105^
"KRN",.84,34617,2,1,0)
Enter Scramble Hint
"KRN",.84,34617,5,0)
^.841^1^1
"KRN",.84,34617,5,1,0)
XMJMCODE
"KRN",.84,34617,5,"B","XMJMCODE",1)

"KRN",.84,34618,-1)
0^192
"KRN",.84,34618,0)
34618^2^^MAILMAN^Enter Scramble Password: 
"KRN",.84,34618,1,0)
^^1^1^3000105^
"KRN",.84,34618,1,1,0)
note: there is a blank at the end of this dialog.
"KRN",.84,34618,2,0)
^^1^1^3000105^
"KRN",.84,34618,2,1,0)
Enter Scramble Password: 
"KRN",.84,34618,5,0)
^.841^1^1
"KRN",.84,34618,5,1,0)
XMJMCODE
"KRN",.84,34618,5,"B","XMJMCODE",1)

"KRN",.84,34619,-1)
0^193
"KRN",.84,34619,0)
34619^3^^MAILMAN^The scramble password is a secret code,
"KRN",.84,34619,2,0)
^^4^4^3000105^
"KRN",.84,34619,2,1,0)
The scramble password is a secret code, which must be entered by the reader
"KRN",.84,34619,2,2,0)
in order to see the message.  Upper and lower case characters are treated
"KRN",.84,34619,2,3,0)
the same.  (The password is not case sensitive.)  The password must be from
"KRN",.84,34619,2,4,0)
3 to 20 characters long.
"KRN",.84,34619,5,0)
^.841^1^1
"KRN",.84,34619,5,1,0)
XMJMCODE
"KRN",.84,34619,5,"B","XMJMCODE",1)

"KRN",.84,34620,-1)
0^194
"KRN",.84,34620,0)
34620^2^y^MAILMAN^This message was scrambled with the scram
"KRN",.84,34620,2,0)
^^1^1^3000105^^
"KRN",.84,34620,2,1,0)
This message was scrambled with the scramble hint: '|1|'
"KRN",.84,34620,3,0)
^.845^1^1
"KRN",.84,34620,3,1,0)
1^scramble hint
"KRN",.84,34620,5,0)
^.841^1^1
"KRN",.84,34620,5,1,0)
XMJMCODE
"KRN",.84,34620,5,"B","XMJMCODE",1)

"KRN",.84,34621,-1)
0^195
"KRN",.84,34621,0)
34621^1^y^MAILMAN^  Not the proper password.  Strike |1|.
"KRN",.84,34621,2,0)
^^1^1^3000110^^^
"KRN",.84,34621,2,1,0)
  Not the proper password.  Strike |1|.
"KRN",.84,34621,3,0)
^.845^1^1
"KRN",.84,34621,3,1,0)
1^number of unsuccessful tries
"KRN",.84,34621,5,0)
^.841^1^1
"KRN",.84,34621,5,1,0)
XMJMCODE
"KRN",.84,34621,5,"B","XMJMCODE",1)

"KRN",.84,34622,-1)
0^196
"KRN",.84,34622,0)
34622^1^^MAILMAN^  Yer out!
"KRN",.84,34622,2,0)
^^1^1^3000105^
"KRN",.84,34622,2,1,0)
  Yer out!
"KRN",.84,34622,5,0)
^.841^1^1
"KRN",.84,34622,5,1,0)
XMJMCODE
"KRN",.84,34622,5,"B","XMJMCODE",1)

"KRN",.84,34623,-1)
0^197
"KRN",.84,34623,0)
34623^1^^MAILMAN^The key is not correct.
"KRN",.84,34623,2,0)
^^1^1^3000105^
"KRN",.84,34623,2,1,0)
The key is not correct.
"KRN",.84,34623,5,0)
^.841^1^1
"KRN",.84,34623,5,1,0)
XMXEDIT
"KRN",.84,34623,5,"B","XMXEDIT",1)

"KRN",.84,34630,-1)
0^198
"KRN",.84,34630,0)
34630^2^^MAILMAN^No Later'd Messages
"KRN",.84,34630,2,0)
^^1^1^3000105^
"KRN",.84,34630,2,1,0)
No Later'd Messages
"KRN",.84,34630,5,0)
^.841^1^1
"KRN",.84,34630,5,1,0)
XMJMD
"KRN",.84,34630,5,"B","XMJMD",1)

"KRN",.84,34631,-1)
0^199
"KRN",.84,34631,0)
34631^2^y^MAILMAN^Later'd Messages Report for: |1|
"KRN",.84,34631,2,0)
^^1^1^3000105^
"KRN",.84,34631,2,1,0)
Later'd Messages Report for: |1|
"KRN",.84,34631,3,0)
^.845^1^1
"KRN",.84,34631,3,1,0)
1^user name
"KRN",.84,34631,5,0)
^.841^1^1
"KRN",.84,34631,5,1,0)
XMJMD
"KRN",.84,34631,5,"B","XMJMD",1)

"KRN",.84,34632,-1)
0^200
"KRN",.84,34632,0)
34632^2^^MAILMAN^Date
"KRN",.84,34632,2,0)
^^1^1^3000105^
"KRN",.84,34632,2,1,0)
Date
"KRN",.84,34632,5,0)
^.841^1^1
"KRN",.84,34632,5,1,0)
XMJMD
"KRN",.84,34632,5,"B","XMJMD",1)

"KRN",.84,34633,-1)
0^201
"KRN",.84,34633,0)
34633^2^^MAILMAN^Msg ID
"KRN",.84,34633,2,0)
^^1^1^3000105^
"KRN",.84,34633,2,1,0)
Msg ID
"KRN",.84,34633,5,0)
^.841^2^2
"KRN",.84,34633,5,1,0)
XMJMD
"KRN",.84,34633,5,2,0)
XMUT2
"KRN",.84,34633,5,"B","XMJMD",1)

"KRN",.84,34633,5,"B","XMUT2",2)

"KRN",.84,34634,-1)
0^202
"KRN",.84,34634,0)
34634^2^^MAILMAN^A:Add another date on which this message
"KRN",.84,34634,2,0)
^^1^1^3000105^
"KRN",.84,34634,2,1,0)
A:Add another date on which this message should appear new
"KRN",.84,34634,5,0)
^.841^1^1
"KRN",.84,34634,5,1,0)
XMJMD
"KRN",.84,34634,5,"B","XMJMD",1)

"KRN",.84,34635,-1)
0^203
"KRN",.84,34635,0)
34635^2^^MAILMAN^C:Change this date
"KRN",.84,34635,2,0)
^^1^1^3000105^
"KRN",.84,34635,2,1,0)
C:Change this date
"KRN",.84,34635,5,0)
^.841^1^1
"KRN",.84,34635,5,1,0)
XMJMD
"KRN",.84,34635,5,"B","XMJMD",1)

"KRN",.84,34635.1,-1)
0^205
"KRN",.84,34635.1,0)
34635.1^2^^MAILMAN^C:Change a date
"KRN",.84,34635.1,2,0)
^^1^1^3000105^
"KRN",.84,34635.1,2,1,0)
C:Change a date
"KRN",.84,34635.1,5,0)
^.841^1^1
"KRN",.84,34635.1,5,1,0)
XMJMD
"KRN",.84,34635.1,5,"B","XMJMD",1)

"KRN",.84,34636,-1)
0^204
"KRN",.84,34636,0)
34636^2^^MAILMAN^D:Delete this date
"KRN",.84,34636,2,0)
^^1^1^3000105^
"KRN",.84,34636,2,1,0)
D:Delete this date
"KRN",.84,34636,5,0)
^.841^1^1
"KRN",.84,34636,5,1,0)
XMJMD
"KRN",.84,34636,5,"B","XMJMD",1)

"KRN",.84,34636.1,-1)
0^206
"KRN",.84,34636.1,0)
34636.1^2^^MAILMAN^D:Delete a date
"KRN",.84,34636.1,2,0)
^^1^1^3000105^
"KRN",.84,34636.1,2,1,0)
D:Delete a date
"KRN",.84,34636.1,5,0)
^.841^1^1
"KRN",.84,34636.1,5,1,0)
XMJMD
"KRN",.84,34636.1,5,"B","XMJMD",1)

"KRN",.84,34637,-1)
0^207
"KRN",.84,34637,0)
34637^2^^MAILMAN^... deleted.
"KRN",.84,34637,2,0)
^^1^1^3000105^
"KRN",.84,34637,2,1,0)
... deleted.
"KRN",.84,34637,5,0)
^.841^1^1
"KRN",.84,34637,5,1,0)
XMJMD
"KRN",.84,34637,5,"B","XMJMD",1)

"KRN",.84,34638,-1)
0^208
"KRN",.84,34638,0)
34638^2^^MAILMAN^You have no Later'd messages.
"KRN",.84,34638,2,0)
^^1^1^3000105^
"KRN",.84,34638,2,1,0)
You have no Later'd messages.
"KRN",.84,34638,5,0)
^.841^1^1
"KRN",.84,34638,5,1,0)
XMJMD
"KRN",.84,34638,5,"B","XMJMD",1)

"KRN",.84,34639,-1)
0^209
"KRN",.84,34639,0)
34639^2^^MAILMAN^MailMan: Report on Later'd Messages
"KRN",.84,34639,2,0)
^^1^1^3000105^
"KRN",.84,34639,2,1,0)
MailMan: Report on Later'd Messages
"KRN",.84,34639,5,0)
^.841^1^1
"KRN",.84,34639,5,1,0)
XMJMD
"KRN",.84,34639,5,"B","XMJMD",1)

"KRN",.84,37100,-1)
0^210
"KRN",.84,37100,0)
37100^1^y^MAILMAN^You may not access any message prior to
"KRN",.84,37100,2,0)
^^2^2^2991203^
"KRN",.84,37100,2,1,0)
You may not access any message prior to |1|,
"KRN",.84,37100,2,2,0)
unless someone forwards it to you.
"KRN",.84,37100,3,0)
^.845^1^1
"KRN",.84,37100,3,1,0)
1^cutoff date
"KRN",.84,37100,5,0)
^.841^1^1
"KRN",.84,37100,5,1,0)
XMXSEC
"KRN",.84,37100,5,"B","XMXSEC",1)

"KRN",.84,37101,-1)
0^211
"KRN",.84,37101,0)
37101^1^y^MAILMAN^Message |1| is a response to message |2|.
"KRN",.84,37101,2,0)
^^1^1^2991203^
"KRN",.84,37101,2,1,0)
Message |1| is a response to message |2|.
"KRN",.84,37101,3,0)
^.845^2^2
"KRN",.84,37101,3,1,0)
1^message reply ien
"KRN",.84,37101,3,2,0)
2^original message ien
"KRN",.84,37101,5,0)
^.841^1^1
"KRN",.84,37101,5,1,0)
XMXSEC
"KRN",.84,37101,5,"B","XMXSEC",1)

"KRN",.84,37102,-1)
0^212
"KRN",.84,37102,0)
37102^1^^MAILMAN^You are neither the originator nor a recip
"KRN",.84,37102,2,0)
^^2^2^2991203^^
"KRN",.84,37102,2,1,0)
You are neither the originator nor a recipient of this message.
"KRN",.84,37102,2,2,0)
If you need to see it, ask someone to forward it to you.
"KRN",.84,37102,5,0)
^.841^1^1
"KRN",.84,37102,5,1,0)
XMXSEC
"KRN",.84,37102,5,"B","XMXSEC",1)

"KRN",.84,37201,-1)
0^213
"KRN",.84,37201,0)
37201^2^^MAILMAN^C:Change the name of this basket
"KRN",.84,37201,2,0)
^^1^1^2991207^^
"KRN",.84,37201,2,1,0)
C:Change the name of this basket
"KRN",.84,37201,5,0)
^.841^1^1
"KRN",.84,37201,5,1,0)
XMXSEC1
"KRN",.84,37201,5,"B","XMXSEC1",1)

"KRN",.84,37201.1,-1)
0^214
"KRN",.84,37201.1,0)
37201.1^1^^MAILMAN^The name of this basket may not be changed
"KRN",.84,37201.1,2,0)
^^1^1^2991207^
"KRN",.84,37201.1,2,1,0)
The name of this basket may not be changed.
"KRN",.84,37201.1,5,0)
^.841^1^1
"KRN",.84,37201.1,5,1,0)
XMXSEC1
"KRN",.84,37201.1,5,"B","XMXSEC1",1)

"KRN",.84,37201.2,-1)
0^215
"KRN",.84,37201.2,0)
37201.2^1^y^MAILMAN^The '|1|' basket name may not be changed.
"KRN",.84,37201.2,2,0)
^^1^1^2991207^
"KRN",.84,37201.2,2,1,0)
The '|1|' basket name may not be changed.
"KRN",.84,37201.2,3,0)
^.845^1^1
"KRN",.84,37201.2,3,1,0)
1^correct name of this basket
"KRN",.84,37201.2,5,0)
^.841^1^1
"KRN",.84,37201.2,5,1,0)
XMXSEC1
"KRN",.84,37201.2,5,"B","XMXSEC1",1)

"KRN",.84,37202,-1)
0^216
"KRN",.84,37202,0)
37202^2^^MAILMAN^D:Delete messages
"KRN",.84,37202,2,0)
^^1^1^2991207^^
"KRN",.84,37202,2,1,0)
D:Delete messages
"KRN",.84,37202,5,0)
^.841^1^1
"KRN",.84,37202,5,1,0)
XMXSEC1
"KRN",.84,37202,5,"B","XMXSEC1",1)

"KRN",.84,37203,-1)
0^217
"KRN",.84,37203,0)
37203^2^^MAILMAN^F:Forward messages
"KRN",.84,37203,2,0)
^^1^1^2991207^^
"KRN",.84,37203,2,1,0)
F:Forward messages
"KRN",.84,37203,5,0)
^.841^1^1
"KRN",.84,37203,5,1,0)
XMXSEC1
"KRN",.84,37203,5,"B","XMXSEC1",1)

"KRN",.84,37204,-1)
0^218
"KRN",.84,37204,0)
37204^2^^MAILMAN^FI:Filter messages
"KRN",.84,37204,2,0)
^^1^1^2991207^^
"KRN",.84,37204,2,1,0)
FI:Filter messages
"KRN",.84,37204,5,0)
^.841^1^1
"KRN",.84,37204,5,1,0)
XMXSEC1
"KRN",.84,37204,5,"B","XMXSEC1",1)

"KRN",.84,37204.1,-1)
0^219
"KRN",.84,37204.1,0)
37204.1^1^^MAILMAN^You have no message filters defined.
"KRN",.84,37204.1,2,0)
^^1^1^2991207^
"KRN",.84,37204.1,2,1,0)
You have no message filters defined.
"KRN",.84,37204.1,5,0)
^.841^1^1
"KRN",.84,37204.1,5,1,0)
XMXSEC1
"KRN",.84,37204.1,5,"B","XMXSEC1",1)

"KRN",.84,37204.2,-1)
0^220
"KRN",.84,37204.2,0)
37204.2^1^y^MAILMAN^|1| has no message filters defined.
"KRN",.84,37204.2,2,0)
^^1^1^2991207^
"KRN",.84,37204.2,2,1,0)
|1| has no message filters defined.
"KRN",.84,37204.2,3,0)
^.845^1^1
"KRN",.84,37204.2,3,1,0)
1^surrogate name
"KRN",.84,37204.2,5,0)
^.841^1^1
"KRN",.84,37204.2,5,1,0)
XMXSEC1
"KRN",.84,37204.2,5,"B","XMXSEC1",1)

"KRN",.84,37205,-1)
0^221
"KRN",.84,37205,0)
37205^2^^MAILMAN^H:Headerless Print messages
"KRN",.84,37205,2,0)
^^1^1^2991207^
"KRN",.84,37205,2,1,0)
H:Headerless Print messages
"KRN",.84,37205,5,0)
^.841^1^1
"KRN",.84,37205,5,1,0)
XMXSEC1
"KRN",.84,37205,5,"B","XMXSEC1",1)

"KRN",.84,37206,-1)
0^222
"KRN",.84,37206,0)
37206^2^^MAILMAN^L:Later messages
"KRN",.84,37206,2,0)
^^1^1^2991207^
"KRN",.84,37206,2,1,0)
L:Later messages
"KRN",.84,37206,5,0)
^.841^1^1
"KRN",.84,37206,5,1,0)
XMXSEC1
"KRN",.84,37206,5,"B","XMXSEC1",1)

"KRN",.84,37207,-1)
0^223
"KRN",.84,37207,0)
37207^2^^MAILMAN^N:New message list
"KRN",.84,37207,2,0)
^^1^1^2991207^
"KRN",.84,37207,2,1,0)
N:New message list
"KRN",.84,37207,5,0)
^.841^1^1
"KRN",.84,37207,5,1,0)
XMXSEC1
"KRN",.84,37207,5,"B","XMXSEC1",1)

"KRN",.84,37208,-1)
0^224
"KRN",.84,37208,0)
37208^2^^MAILMAN^NT:New Toggle messages
"KRN",.84,37208,2,0)
^^1^1^2991207^
"KRN",.84,37208,2,1,0)
NT:New Toggle messages
"KRN",.84,37208,5,0)
^.841^1^1
"KRN",.84,37208,5,1,0)
XMXSEC1
"KRN",.84,37208,5,"B","XMXSEC1",1)

"KRN",.84,37209,-1)
0^225
"KRN",.84,37209,0)
37209^2^^MAILMAN^P:Print messages
"KRN",.84,37209,2,0)
^^1^1^2991207^
"KRN",.84,37209,2,1,0)
P:Print messages
"KRN",.84,37209,5,0)
^.841^1^1
"KRN",.84,37209,5,1,0)
XMXSEC1
"KRN",.84,37209,5,"B","XMXSEC1",1)

"KRN",.84,37211,-1)
0^226
"KRN",.84,37211,0)
37211^2^^MAILMAN^Q:Query (search for) messages
"KRN",.84,37211,2,0)
^^1^1^2991207^
"KRN",.84,37211,2,1,0)
Q:Query (search for) messages
"KRN",.84,37211,5,0)
^.841^1^1
"KRN",.84,37211,5,1,0)
XMXSEC1
"KRN",.84,37211,5,"B","XMXSEC1",1)

"KRN",.84,37212,-1)
0^227
"KRN",.84,37212,0)
37212^2^^MAILMAN^R:Resequence messages
"KRN",.84,37212,2,0)
^^1^1^2991207^
"KRN",.84,37212,2,1,0)
R:Resequence messages
"KRN",.84,37212,5,0)
^.841^1^1
"KRN",.84,37212,5,1,0)
XMXSEC1
"KRN",.84,37212,5,"B","XMXSEC1",1)

"KRN",.84,37213,-1)
0^228
"KRN",.84,37213,0)
37213^2^^MAILMAN^S:Save messages to another basket
"KRN",.84,37213,2,0)
^^1^1^2991207^
"KRN",.84,37213,2,1,0)
S:Save messages to another basket
"KRN",.84,37213,5,0)
^.841^1^1
"KRN",.84,37213,5,1,0)
XMXSEC1
"KRN",.84,37213,5,"B","XMXSEC1",1)

"KRN",.84,37214,-1)
0^229
"KRN",.84,37214,0)
37214^2^^MAILMAN^T:Terminate messages
"KRN",.84,37214,2,0)
^^1^1^2991207^
"KRN",.84,37214,2,1,0)
T:Terminate messages
"KRN",.84,37214,5,0)
^.841^1^1
"KRN",.84,37214,5,1,0)
XMXSEC1
"KRN",.84,37214,5,"B","XMXSEC1",1)

"KRN",.84,37219,-1)
0^230
"KRN",.84,37219,0)
37219^2^^MAILMAN^X:Xmit priority toggle
"KRN",.84,37219,2,0)
^^1^1^2991207^
"KRN",.84,37219,2,1,0)
X:Xmit priority toggle
"KRN",.84,37219,5,0)
^.841^1^1
"KRN",.84,37219,5,1,0)
XMXSEC1
"KRN",.84,37219,5,"B","XMXSEC1",1)

"KRN",.84,37221,-1)
0^231
"KRN",.84,37221,0)
37221^2^^MAILMAN^CD:Change Detail
"KRN",.84,37221,2,0)
^^1^1^2991207^
"KRN",.84,37221,2,1,0)
CD:Change Detail
"KRN",.84,37221,5,0)
^.841^2^2
"KRN",.84,37221,5,1,0)
XMXSEC1
"KRN",.84,37221,5,2,0)
XMJMLR1
"KRN",.84,37221,5,"B","XMJMLR1",2)

"KRN",.84,37221,5,"B","XMXSEC1",1)

"KRN",.84,37222,-1)
0^232
"KRN",.84,37222,0)
37222^2^^MAILMAN^O:Opposite selection toggle
"KRN",.84,37222,2,0)
^^1^1^2991207^
"KRN",.84,37222,2,1,0)
O:Opposite selection toggle
"KRN",.84,37222,5,0)
^.841^2^2
"KRN",.84,37222,5,1,0)
XMXSEC1
"KRN",.84,37222,5,2,0)
XMJMLR1
"KRN",.84,37222,5,"B","XMJMLR1",2)

"KRN",.84,37222,5,"B","XMXSEC1",1)

"KRN",.84,37223,-1)
0^233
"KRN",.84,37223,0)
37223^2^^MAILMAN^Z:Zoom selection toggle
"KRN",.84,37223,2,0)
^^1^1^2991207^
"KRN",.84,37223,2,1,0)
Z:Zoom selection toggle
"KRN",.84,37223,5,0)
^.841^2^2
"KRN",.84,37223,5,1,0)
XMXSEC1
"KRN",.84,37223,5,2,0)
XMJMLR1
"KRN",.84,37223,5,"B","XMJMLR1",2)

"KRN",.84,37223,5,"B","XMXSEC1",1)

"KRN",.84,37231,-1)
0^234
"KRN",.84,37231,0)
37231^1^^MAILMAN^You can't do this unless messages are sele
"KRN",.84,37231,2,0)
^^1^1^2991207^
"KRN",.84,37231,2,1,0)
You can't do this unless messages are selected.
"KRN",.84,37231,5,0)
^.841^2^2
"KRN",.84,37231,5,1,0)
XMXSEC1
"KRN",.84,37231,5,2,0)
XMJMLR1
"KRN",.84,37231,5,"B","XMJMLR1",2)

"KRN",.84,37231,5,"B","XMXSEC1",1)

"KRN",.84,37232,-1)
0^235
"KRN",.84,37232,0)
37232^1^^MAILMAN^You can't do this with messages selected.
"KRN",.84,37232,2,0)
^^1^1^2991207^
"KRN",.84,37232,2,1,0)
You can't do this with messages selected.
"KRN",.84,37232,5,0)
^.841^2^2
"KRN",.84,37232,5,1,0)
XMXSEC1
"KRN",.84,37232,5,2,0)
XMJMLR1
"KRN",.84,37232,5,"B","XMJMLR1",2)

"KRN",.84,37232,5,"B","XMXSEC1",1)

"KRN",.84,37241,-1)
0^236
"KRN",.84,37241,0)
37241^2^^MAILMAN^I:Ignore this message
"KRN",.84,37241,2,0)
^^1^1^2991207^
"KRN",.84,37241,2,1,0)
I:Ignore this message
"KRN",.84,37241,5,0)
^.841^1^1
"KRN",.84,37241,5,1,0)
XMJBM
"KRN",.84,37241,5,"B","XMJBM",1)

"KRN",.84,37251,-1)
0^237
"KRN",.84,37251,0)
37251^1^^MAILMAN^You may not do this with messages in the
"KRN",.84,37251,2,0)
^^1^1^2991207^
"KRN",.84,37251,2,1,0)
You may not do this with messages in the transmit queues.
"KRN",.84,37251,5,0)
^.841^1^1
"KRN",.84,37251,5,1,0)
XMXSEC1
"KRN",.84,37251,5,"B","XMXSEC1",1)

"KRN",.84,37261,-1)
0^238
"KRN",.84,37261,0)
37261^1^^MAILMAN^You must hold the XMMGR key or be a POSTM
"KRN",.84,37261,2,0)
^^2^2^2991207^
"KRN",.84,37261,2,1,0)
You must hold the XMMGR key or be a POSTMASTER surrogate
"KRN",.84,37261,2,2,0)
to do this in SHARED,MAIL.
"KRN",.84,37261,5,0)
^.841^1^1
"KRN",.84,37261,5,1,0)
XMXSEC1
"KRN",.84,37261,5,"B","XMXSEC1",1)

"KRN",.84,37301,-1)
0^239
"KRN",.84,37301,0)
37301^2^^MAILMAN^C:Confidential (surrogate can't read)
"KRN",.84,37301,2,0)
^^1^1^2991208^
"KRN",.84,37301,2,1,0)
C:Confidential (surrogate can't read)
"KRN",.84,37301,5,0)
^.841^1^1
"KRN",.84,37301,5,1,0)
XMXSEC2
"KRN",.84,37301,5,"B","XMXSEC2",1)

"KRN",.84,37301.6,-1)
0^240
"KRN",.84,37301.6,0)
37301.6^1^^MAILMAN^Messages addressed to SHARED,MAIL may not
"KRN",.84,37301.6,2,0)
^^1^1^2991208^^
"KRN",.84,37301.6,2,1,0)
Messages addressed to SHARED,MAIL may not be 'Confidential'.
"KRN",.84,37301.6,5,0)
^.841^1^1
"KRN",.84,37301.6,5,1,0)
XMXSEC2
"KRN",.84,37301.6,5,"B","XMXSEC2",1)

"KRN",.84,37301.9,-1)
0^241
"KRN",.84,37301.9,0)
37301.9^2^^MAILMAN^Message flagged 'Confidential'.
"KRN",.84,37301.9,2,0)
^^1^1^2991208^
"KRN",.84,37301.9,2,1,0)
Message flagged 'Confidential'.
"KRN",.84,37301.9,5,0)
^.841^2^2
"KRN",.84,37301.9,5,1,0)
XMJMSO
"KRN",.84,37301.9,5,2,0)
XMXEDIT
"KRN",.84,37301.9,5,"B","XMJMSO",1)

"KRN",.84,37301.9,5,"B","XMXEDIT",2)

"KRN",.84,37302,-1)
0^385
"KRN",.84,37302,0)
37302^2^^MAILMAN^C:UnConfidential (surrogate may read)
"KRN",.84,37302,2,0)
^^1^1^2991208^
"KRN",.84,37302,2,1,0)
C:UnConfidential (surrogate may read)
"KRN",.84,37302,5,0)
^.841^1^1
"KRN",.84,37302,5,1,0)
XMXSEC2
"KRN",.84,37302,5,"B","XMXSEC2",1)

"KRN",.84,37302.9,-1)
0^386
"KRN",.84,37302.9,0)
37302.9^2^^MAILMAN^'Confidential' flag removed.
"KRN",.84,37302.9,2,0)
^^1^1^2991208^
"KRN",.84,37302.9,2,1,0)
'Confidential' flag removed.
"KRN",.84,37302.9,5,0)
^.841^2^2
"KRN",.84,37302.9,5,1,0)
XMJMSO
"KRN",.84,37302.9,5,2,0)
XMXEDIT
"KRN",.84,37302.9,5,"B","XMJMSO",1)

"KRN",.84,37302.9,5,"B","XMXEDIT",2)

"KRN",.84,37303,-1)
0^242
"KRN",.84,37303,0)
37303^2^^MAILMAN^D:Delivery basket set
"KRN",.84,37303,2,0)
^^1^1^2991208^
"KRN",.84,37303,2,1,0)
D:Delivery basket set
"KRN",.84,37303,5,0)
^.841^1^1
"KRN",.84,37303,5,1,0)
XMXSEC2
"KRN",.84,37303,5,"B","XMXSEC2",1)

"KRN",.84,37303.1,-1)
0^243
"KRN",.84,37303.1,0)
37303.1^2^^MAILMAN^The delivery basket is the basket to which
"KRN",.84,37303.1,2,0)
^^16^16^2991221^
"KRN",.84,37303.1,2,1,0)
The delivery basket is the basket to which this message should be delivered
"KRN",.84,37303.1,2,2,0)
for all recipients (even future ones, should the message be forwarded).
"KRN",.84,37303.1,2,3,0)
Any message filters, which the recipient might have, are ignored.
"KRN",.84,37303.1,2,4,0)
If the basket does not exist, it will be created.
"KRN",.84,37303.1,2,5,0)
 
"KRN",.84,37303.1,2,6,0)
Note: The recipients must have chosen to allow delivery baskets by setting
"KRN",.84,37303.1,2,7,0)
ACCEPT DELIVERY BASKET? under 'Personal Preferences|Delivery Basket Edit'
"KRN",.84,37303.1,2,8,0)
to one of the following:
"KRN",.84,37303.1,2,9,0)
 YES    - If basket doesn't exist, create it, and deliver the message to it.
"KRN",.84,37303.1,2,10,0)
 EXIST  - If the basket already exists, then deliver the message to it.
"KRN",.84,37303.1,2,11,0)
          Else, just deliver the message as usual.
"KRN",.84,37303.1,2,12,0)
 SELECT - If the basket already exists AND accepts such messages,
"KRN",.84,37303.1,2,13,0)
          then deliver the message to it.
"KRN",.84,37303.1,2,14,0)
          Else, just deliver the message as usual.
"KRN",.84,37303.1,2,15,0)
If the recipient has not set this field or has set it to NO, then
"KRN",.84,37303.1,2,16,0)
the message would be delivered as usual.
"KRN",.84,37303.1,5,0)
^.841^1^1
"KRN",.84,37303.1,5,1,0)
XMJMSO
"KRN",.84,37303.1,5,"B","XMJMSO",1)

"KRN",.84,37303.2,-1)
0^244
"KRN",.84,37303.2,0)
37303.2^2^^MAILMAN^Select delivery basket: 
"KRN",.84,37303.2,1,0)
^^1^1^2991221^
"KRN",.84,37303.2,1,1,0)
Note: there is one blank character at the end of this dialog.
"KRN",.84,37303.2,2,0)
^^1^1^2991221^
"KRN",.84,37303.2,2,1,0)
Select delivery basket: 
"KRN",.84,37303.2,5,0)
^.841^1^1
"KRN",.84,37303.2,5,1,0)
XMJMSO
"KRN",.84,37303.2,5,"B","XMJMSO",1)

"KRN",.84,37303.9,-1)
0^245
"KRN",.84,37303.9,0)
37303.9^2^^MAILMAN^Delivery basket set.
"KRN",.84,37303.9,2,0)
^^1^1^2991208^
"KRN",.84,37303.9,2,1,0)
Delivery basket set.
"KRN",.84,37303.9,5,0)
^.841^2^2
"KRN",.84,37303.9,5,1,0)
XMJMSO
"KRN",.84,37303.9,5,2,0)
XMXEDIT
"KRN",.84,37303.9,5,"B","XMJMSO",1)

"KRN",.84,37303.9,5,"B","XMXEDIT",2)

"KRN",.84,37304,-1)
0^246
"KRN",.84,37304,0)
37304^2^^MAILMAN^D:Delivery basket remove
"KRN",.84,37304,2,0)
^^1^1^2991208^
"KRN",.84,37304,2,1,0)
D:Delivery basket remove
"KRN",.84,37304,5,0)
^.841^1^1
"KRN",.84,37304,5,1,0)
XMXSEC2
"KRN",.84,37304,5,"B","XMXSEC2",1)

"KRN",.84,37304.9,-1)
0^387
"KRN",.84,37304.9,0)
37304.9^2^^MAILMAN^Delivery basket removed.
"KRN",.84,37304.9,2,0)
^^1^1^2991208^
"KRN",.84,37304.9,2,1,0)
Delivery basket removed.
"KRN",.84,37304.9,5,0)
^.841^2^2
"KRN",.84,37304.9,5,1,0)
XMJMSO
"KRN",.84,37304.9,5,2,0)
XMXEDIT
"KRN",.84,37304.9,5,"B","XMJMSO",1)

"KRN",.84,37304.9,5,"B","XMXEDIT",2)

"KRN",.84,37305,-1)
0^247
"KRN",.84,37305,0)
37305^2^^MAILMAN^ES:Edit Subject
"KRN",.84,37305,2,0)
^^1^1^2991208^
"KRN",.84,37305,2,1,0)
ES:Edit Subject
"KRN",.84,37305,5,0)
^.841^1^1
"KRN",.84,37305,5,1,0)
XMXSEC2
"KRN",.84,37305,5,"B","XMXSEC2",1)

"KRN",.84,37306,-1)
0^248
"KRN",.84,37306,0)
37306^2^^MAILMAN^ET:Edit Text
"KRN",.84,37306,2,0)
^^1^1^2991208^
"KRN",.84,37306,2,1,0)
ET:Edit Text
"KRN",.84,37306,5,0)
^.841^1^1
"KRN",.84,37306,5,1,0)
XMXSEC2
"KRN",.84,37306,5,"B","XMXSEC2",1)

"KRN",.84,37306.1,-1)
0^249
"KRN",.84,37306.1,0)
37306.1^2^^MAILMAN^W A R N I N G
"KRN",.84,37306.1,2,0)
^^12^12^2991221^
"KRN",.84,37306.1,2,1,0)
                    W A R N I N G
"KRN",.84,37306.1,2,2,0)
 
"KRN",.84,37306.1,2,3,0)
  You are about to edit what appears to be a PackMan message.
"KRN",.84,37306.1,2,4,0)
  Please note the following:
"KRN",.84,37306.1,2,5,0)
 
"KRN",.84,37306.1,2,6,0)
  1. If you edit this message you may compromise its integrity.
"KRN",.84,37306.1,2,7,0)
  2. If you must edit it,
"KRN",.84,37306.1,2,8,0)
     - Do not edit the code.
"KRN",.84,37306.1,2,9,0)
     - Confine your editing to the text (the lines between $TXT and $ENDTXT).
"KRN",.84,37306.1,2,10,0)
     - You may insert lines in the text.
"KRN",.84,37306.1,2,11,0)
     - Do not begin any line with a '$' (dollar sign).
"KRN",.84,37306.1,2,12,0)
     - Be careful!
"KRN",.84,37306.1,5,0)
^.841^1^1
"KRN",.84,37306.1,5,1,0)
XMJMSO
"KRN",.84,37306.1,5,"B","XMJMSO",1)

"KRN",.84,37306.2,-1)
0^250
"KRN",.84,37306.2,0)
37306.2^2^^MAILMAN^Are you sure you want to edit this message
"KRN",.84,37306.2,2,0)
^^1^1^2991221^
"KRN",.84,37306.2,2,1,0)
Are you sure you want to edit this message
"KRN",.84,37306.2,5,0)
^.841^1^1
"KRN",.84,37306.2,5,1,0)
XMJMSO
"KRN",.84,37306.2,5,"B","XMJMSO",1)

"KRN",.84,37307,-1)
0^251
"KRN",.84,37307,0)
37307^2^^MAILMAN^I:Information only (recipients may not rep
"KRN",.84,37307,2,0)
^^1^1^2991208^
"KRN",.84,37307,2,1,0)
I:Information only (recipients may not reply)
"KRN",.84,37307,5,0)
^.841^1^1
"KRN",.84,37307,5,1,0)
XMXSEC2
"KRN",.84,37307,5,"B","XMXSEC2",1)

"KRN",.84,37307.9,-1)
0^252
"KRN",.84,37307.9,0)
37307.9^2^^MAILMAN^Message flagged 'Information only'.
"KRN",.84,37307.9,2,0)
^^1^1^2991208^
"KRN",.84,37307.9,2,1,0)
Message flagged 'Information only'.
"KRN",.84,37307.9,5,0)
^.841^2^2
"KRN",.84,37307.9,5,1,0)
XMJMSO
"KRN",.84,37307.9,5,2,0)
XMXEDIT
"KRN",.84,37307.9,5,"B","XMJMSO",1)

"KRN",.84,37307.9,5,"B","XMXEDIT",2)

"KRN",.84,37308,-1)
0^253
"KRN",.84,37308,0)
37308^2^^MAILMAN^I:UnInformation only (recipients may reply
"KRN",.84,37308,2,0)
^^1^1^2991208^
"KRN",.84,37308,2,1,0)
I:UnInformation only (recipients may reply)
"KRN",.84,37308,5,0)
^.841^1^1
"KRN",.84,37308,5,1,0)
XMXSEC2
"KRN",.84,37308,5,"B","XMXSEC2",1)

"KRN",.84,37308.9,-1)
0^254
"KRN",.84,37308.9,0)
37308.9^2^^MAILMAN^'Information only' flag removed.
"KRN",.84,37308.9,2,0)
^^1^1^2991208^
"KRN",.84,37308.9,2,1,0)
'Information only' flag removed.
"KRN",.84,37308.9,5,0)
^.841^2^2
"KRN",.84,37308.9,5,1,0)
XMJMSO
"KRN",.84,37308.9,5,2,0)
XMXEDIT
"KRN",.84,37308.9,5,"B","XMJMSO",1)

"KRN",.84,37308.9,5,"B","XMXEDIT",2)

"KRN",.84,37309,-1)
0^255
"KRN",.84,37309,0)
37309^2^^MAILMAN^NS:Add Network Signature
"KRN",.84,37309,2,0)
^^1^1^2991208^
"KRN",.84,37309,2,1,0)
NS:Add Network Signature
"KRN",.84,37309,5,0)
^.841^1^1
"KRN",.84,37309,5,1,0)
XMXSEC2
"KRN",.84,37309,5,"B","XMXSEC2",1)

"KRN",.84,37309.1,-1)
0^256
"KRN",.84,37309.1,0)
37309.1^1^^MAILMAN^You have no Network Signature.
"KRN",.84,37309.1,2,0)
^^1^1^2991208^
"KRN",.84,37309.1,2,1,0)
You have no Network Signature.
"KRN",.84,37309.1,5,0)
^.841^1^1
"KRN",.84,37309.1,5,1,0)
XMXSEC2
"KRN",.84,37309.1,5,"B","XMXSEC2",1)

"KRN",.84,37309.2,-1)
0^257
"KRN",.84,37309.2,0)
37309.2^1^^MAILMAN^Network Signature has already been added.
"KRN",.84,37309.2,2,0)
^^1^1^2991208^
"KRN",.84,37309.2,2,1,0)
Network Signature has already been added.
"KRN",.84,37309.2,5,0)
^.841^2^2
"KRN",.84,37309.2,5,1,0)
XMJMOIE
"KRN",.84,37309.2,5,2,0)
XMJMSO
"KRN",.84,37309.2,5,"B","XMJMOIE",1)

"KRN",.84,37309.2,5,"B","XMJMSO",2)

"KRN",.84,37309.3,-1)
0^258
"KRN",.84,37309.3,0)
37309.3^1^^MAILMAN^|1| has no Network Signature.
"KRN",.84,37309.3,2,0)
^^1^1^2991208^
"KRN",.84,37309.3,2,1,0)
|1| has no Network Signature.
"KRN",.84,37309.3,5,0)
^.841^1^1
"KRN",.84,37309.3,5,1,0)
XMXSEC2
"KRN",.84,37309.3,5,"B","XMXSEC2",1)

"KRN",.84,37309.4,-1)
0^259
"KRN",.84,37309.4,0)
37309.4^1^^MAILMAN^You may not add a Network Signature to a K
"KRN",.84,37309.4,2,0)
^^1^1^2991216^^
"KRN",.84,37309.4,2,1,0)
You may not add a Network Signature to a KIDS or PackMan message.
"KRN",.84,37309.4,5,0)
^.841^1^1
"KRN",.84,37309.4,5,1,0)
XMXSEC2
"KRN",.84,37309.4,5,"B","XMXSEC2",1)

"KRN",.84,37309.5,-1)
0^260
"KRN",.84,37309.5,0)
37309.5^2^^MAILMAN^Would you like to create a Network Signat
"KRN",.84,37309.5,2,0)
^^1^1^2991221^
"KRN",.84,37309.5,2,1,0)
Would you like to create a Network Signature now
"KRN",.84,37309.5,5,0)
^.841^1^1
"KRN",.84,37309.5,5,1,0)
XMJMSO
"KRN",.84,37309.5,5,"B","XMJMSO",1)

"KRN",.84,37309.9,-1)
0^261
"KRN",.84,37309.9,0)
37309.9^2^^MAILMAN^Network Signature added.
"KRN",.84,37309.9,2,0)
^^1^1^2991208^
"KRN",.84,37309.9,2,1,0)
Network Signature added.
"KRN",.84,37309.9,5,0)
^.841^2^2
"KRN",.84,37309.9,5,1,0)
XMJMSO
"KRN",.84,37309.9,5,2,0)
XMXEDIT
"KRN",.84,37309.9,5,"B","XMJMSO",1)

"KRN",.84,37309.9,5,"B","XMXEDIT",2)

"KRN",.84,37311,-1)
0^262
"KRN",.84,37311,0)
37311^2^^MAILMAN^P:Priority delivery
"KRN",.84,37311,2,0)
^^1^1^2991208^
"KRN",.84,37311,2,1,0)
P:Priority delivery
"KRN",.84,37311,5,0)
^.841^1^1
"KRN",.84,37311,5,1,0)
XMXSEC2
"KRN",.84,37311,5,"B","XMXSEC2",1)

"KRN",.84,37311.9,-1)
0^263
"KRN",.84,37311.9,0)
37311.9^2^^MAILMAN^Message flagged 'Priority'.
"KRN",.84,37311.9,2,0)
^^1^1^2991208^
"KRN",.84,37311.9,2,1,0)
Message flagged 'Priority'.
"KRN",.84,37311.9,5,0)
^.841^2^2
"KRN",.84,37311.9,5,1,0)
XMJMSO
"KRN",.84,37311.9,5,2,0)
XMXSEC2
"KRN",.84,37311.9,5,"B","XMJMSO",1)

"KRN",.84,37311.9,5,"B","XMXSEC2",2)

"KRN",.84,37312,-1)
0^264
"KRN",.84,37312,0)
37312^2^^MAILMAN^P:Normal delivery
"KRN",.84,37312,2,0)
^^1^1^2991208^
"KRN",.84,37312,2,1,0)
P:Normal delivery
"KRN",.84,37312,5,0)
^.841^1^1
"KRN",.84,37312,5,1,0)
XMXSEC2
"KRN",.84,37312,5,"B","XMXSEC2",1)

"KRN",.84,37312.9,-1)
0^265
"KRN",.84,37312.9,0)
37312.9^2^^MAILMAN^'Priority' flag removed.
"KRN",.84,37312.9,2,0)
^^1^1^2991208^
"KRN",.84,37312.9,2,1,0)
'Priority' flag removed.
"KRN",.84,37312.9,5,0)
^.841^2^2
"KRN",.84,37312.9,5,1,0)
XMJMSO
"KRN",.84,37312.9,5,2,0)
XMXEDIT
"KRN",.84,37312.9,5,"B","XMJMSO",1)

"KRN",.84,37312.9,5,"B","XMXEDIT",2)

"KRN",.84,37313,-1)
0^266
"KRN",.84,37313,0)
37313^2^^MAILMAN^R:Confirm Receipt
"KRN",.84,37313,2,0)
^^1^1^2991208^^
"KRN",.84,37313,2,1,0)
R:Confirm Receipt
"KRN",.84,37313,5,0)
^.841^1^1
"KRN",.84,37313,5,1,0)
XMXSEC2
"KRN",.84,37313,5,"B","XMXSEC2",1)

"KRN",.84,37313.9,-1)
0^267
"KRN",.84,37313.9,0)
37313.9^2^^MAILMAN^Message flagged 'Confirm Receipt Requested
"KRN",.84,37313.9,2,0)
^^1^1^2991208^
"KRN",.84,37313.9,2,1,0)
Message flagged 'Confirm Receipt Requested'.
"KRN",.84,37313.9,5,0)
^.841^2^2
"KRN",.84,37313.9,5,1,0)
XMJMSO
"KRN",.84,37313.9,5,2,0)
XMXEDIT
"KRN",.84,37313.9,5,"B","XMJMSO",1)

"KRN",.84,37313.9,5,"B","XMXEDIT",2)

"KRN",.84,37314,-1)
0^268
"KRN",.84,37314,0)
37314^2^^MAILMAN^R:No Confirm Receipt
"KRN",.84,37314,2,0)
^^1^1^2991208^^
"KRN",.84,37314,2,1,0)
R:No Confirm Receipt
"KRN",.84,37314,5,0)
^.841^1^1
"KRN",.84,37314,5,1,0)
XMXSEC2
"KRN",.84,37314,5,"B","XMXSEC2",1)

"KRN",.84,37314.9,-1)
0^269
"KRN",.84,37314.9,0)
37314.9^2^^MAILMAN^'Confirm Receipt Requested' flag removed.
"KRN",.84,37314.9,2,0)
^^1^1^2991208^
"KRN",.84,37314.9,2,1,0)
'Confirm Receipt Requested' flag removed.
"KRN",.84,37314.9,5,0)
^.841^2^2
"KRN",.84,37314.9,5,1,0)
XMJMSO
"KRN",.84,37314.9,5,2,0)
XMXEDIT
"KRN",.84,37314.9,5,"B","XMJMSO",1)

"KRN",.84,37314.9,5,"B","XMXEDIT",2)

"KRN",.84,37315,-1)
0^270
"KRN",.84,37315,0)
37315^2^^MAILMAN^S:Scramble text with password
"KRN",.84,37315,2,0)
^^1^1^2991208^^
"KRN",.84,37315,2,1,0)
S:Scramble text with password
"KRN",.84,37315,5,0)
^.841^1^1
"KRN",.84,37315,5,1,0)
XMXSEC2
"KRN",.84,37315,5,"B","XMXSEC2",1)

"KRN",.84,37315.4,-1)
0^271
"KRN",.84,37315.4,0)
37315.4^1^^MAILMAN^Sorry, but we can't (un)secure a KIDS or
"KRN",.84,37315.4,2,0)
^^1^1^2991208^^
"KRN",.84,37315.4,2,1,0)
Sorry, but we can't (un)secure a KIDS or PackMan message here.
"KRN",.84,37315.4,5,0)
^.841^1^1
"KRN",.84,37315.4,5,1,0)
XMXSEC2
"KRN",.84,37315.4,5,"B","XMXSEC2",1)

"KRN",.84,37315.8,-1)
0^272
"KRN",.84,37315.8,0)
37315.8^1^^MAILMAN^Scramble aborted.
"KRN",.84,37315.8,2,0)
^^1^1^2991221^
"KRN",.84,37315.8,2,1,0)
Scramble aborted.
"KRN",.84,37315.8,5,0)
^.841^1^1
"KRN",.84,37315.8,5,1,0)
XMJMSO
"KRN",.84,37315.8,5,"B","XMJMSO",1)

"KRN",.84,37315.9,-1)
0^273
"KRN",.84,37315.9,0)
37315.9^2^^MAILMAN^Message text scrambled.
"KRN",.84,37315.9,2,0)
^^1^1^2991208^
"KRN",.84,37315.9,2,1,0)
Message text scrambled.
"KRN",.84,37315.9,5,0)
^.841^2^2
"KRN",.84,37315.9,5,1,0)
XMJMSO
"KRN",.84,37315.9,5,2,0)
XMXEDIT
"KRN",.84,37315.9,5,"B","XMJMSO",1)

"KRN",.84,37315.9,5,"B","XMXEDIT",2)

"KRN",.84,37316,-1)
0^274
"KRN",.84,37316,0)
37316^2^^MAILMAN^S:UnScramble text
"KRN",.84,37316,2,0)
^^1^1^2991208^
"KRN",.84,37316,2,1,0)
S:UnScramble text
"KRN",.84,37316,5,0)
^.841^1^1
"KRN",.84,37316,5,1,0)
XMXSEC2
"KRN",.84,37316,5,"B","XMXSEC2",1)

"KRN",.84,37316.8,-1)
0^275
"KRN",.84,37316.8,0)
37316.8^2^^MAILMAN^Scramble removed.
"KRN",.84,37316.8,2,0)
^^1^1^2991209^
"KRN",.84,37316.8,2,1,0)
Scramble removed.
"KRN",.84,37316.8,5,0)
^.841^1^1
"KRN",.84,37316.8,5,1,0)
XMJMSO
"KRN",.84,37316.8,5,"B","XMJMSO",1)

"KRN",.84,37316.9,-1)
0^276
"KRN",.84,37316.9,0)
37316.9^2^^MAILMAN^Message text unscrambled.
"KRN",.84,37316.9,2,0)
^^1^1^2991208^
"KRN",.84,37316.9,2,1,0)
Message text unscrambled.
"KRN",.84,37316.9,5,0)
^.841^2^2
"KRN",.84,37316.9,5,1,0)
XMJMSO
"KRN",.84,37316.9,5,2,0)
XMXEDIT
"KRN",.84,37316.9,5,"B","XMJMSO",1)

"KRN",.84,37316.9,5,"B","XMXEDIT",2)

"KRN",.84,37317,-1)
0^277
"KRN",.84,37317,0)
37317^2^^MAILMAN^V:Vaporize date set
"KRN",.84,37317,2,0)
^^1^1^2991208^
"KRN",.84,37317,2,1,0)
V:Vaporize date set
"KRN",.84,37317,5,0)
^.841^1^1
"KRN",.84,37317,5,1,0)
XMXSEC2
"KRN",.84,37317,5,"B","XMXSEC2",1)

"KRN",.84,37317.1,-1)
0^278
"KRN",.84,37317.1,0)
37317.1^2^^MAILMAN^Enter Vaporize Date
"KRN",.84,37317.1,2,0)
^^1^1^2991221^
"KRN",.84,37317.1,2,1,0)
Enter Vaporize Date
"KRN",.84,37317.1,5,0)
^.841^1^1
"KRN",.84,37317.1,5,1,0)
XMJMSO
"KRN",.84,37317.1,5,"B","XMJMSO",1)

"KRN",.84,37317.9,-1)
0^279
"KRN",.84,37317.9,0)
37317.9^2^^MAILMAN^Vaporize date set.
"KRN",.84,37317.9,2,0)
^^1^1^2991208^
"KRN",.84,37317.9,2,1,0)
Vaporize date set.
"KRN",.84,37317.9,5,0)
^.841^2^2
"KRN",.84,37317.9,5,1,0)
XMJMSO
"KRN",.84,37317.9,5,2,0)
XMXEDIT
"KRN",.84,37317.9,5,"B","XMJMSO",1)

"KRN",.84,37317.9,5,"B","XMXEDIT",2)

"KRN",.84,37318,-1)
0^280
"KRN",.84,37318,0)
37318^2^^MAILMAN^V:Vaporize date remove
"KRN",.84,37318,2,0)
^^1^1^2991208^
"KRN",.84,37318,2,1,0)
V:Vaporize date remove
"KRN",.84,37318,5,0)
^.841^1^1
"KRN",.84,37318,5,1,0)
XMXSEC2
"KRN",.84,37318,5,"B","XMXSEC2",1)

"KRN",.84,37318.9,-1)
0^281
"KRN",.84,37318.9,0)
37318.9^2^^MAILMAN^Vaporize date removed.
"KRN",.84,37318.9,2,0)
^^1^1^2991208^
"KRN",.84,37318.9,2,1,0)
Vaporize date removed.
"KRN",.84,37318.9,5,0)
^.841^2^2
"KRN",.84,37318.9,5,1,0)
XMJMSO
"KRN",.84,37318.9,5,2,0)
XMXEDIT
"KRN",.84,37318.9,5,"B","XMJMSO",1)

"KRN",.84,37318.9,5,"B","XMXEDIT",2)

"KRN",.84,37319,-1)
0^282
"KRN",.84,37319,0)
37319^2^^MAILMAN^X:Close (no forward allowed)
"KRN",.84,37319,2,0)
^^1^1^2991208^
"KRN",.84,37319,2,1,0)
X:Close (no forward allowed)
"KRN",.84,37319,5,0)
^.841^1^1
"KRN",.84,37319,5,1,0)
XMXSEC2
"KRN",.84,37319,5,"B","XMXSEC2",1)

"KRN",.84,37319.9,-1)
0^283
"KRN",.84,37319.9,0)
37319.9^2^^MAILMAN^Message flagged 'Closed'.
"KRN",.84,37319.9,2,0)
^^1^1^2991208^
"KRN",.84,37319.9,2,1,0)
Message flagged 'Closed'.
"KRN",.84,37319.9,5,0)
^.841^2^2
"KRN",.84,37319.9,5,1,0)
XMJMSO
"KRN",.84,37319.9,5,2,0)
XMXEDIT
"KRN",.84,37319.9,5,"B","XMJMSO",1)

"KRN",.84,37319.9,5,"B","XMXEDIT",2)

"KRN",.84,37320,-1)
0^284
"KRN",.84,37320,0)
37320^2^^MAILMAN^X:UnClose (forward allowed)
"KRN",.84,37320,2,0)
^^1^1^2991208^
"KRN",.84,37320,2,1,0)
X:UnClose (forward allowed)
"KRN",.84,37320,5,0)
^.841^1^1
"KRN",.84,37320,5,1,0)
XMXSEC2
"KRN",.84,37320,5,"B","XMXSEC2",1)

"KRN",.84,37320.6,-1)
0^285
"KRN",.84,37320.6,0)
37320.6^1^^MAILMAN^Messages addressed to SHARED,MAIL may not
"KRN",.84,37320.6,2,0)
^^1^1^2991208^^
"KRN",.84,37320.6,2,1,0)
Messages addressed to SHARED,MAIL may not be 'Closed'.
"KRN",.84,37320.6,5,0)
^.841^1^1
"KRN",.84,37320.6,5,1,0)
XMXSEC2
"KRN",.84,37320.6,5,"B","XMXSEC2",1)

"KRN",.84,37320.9,-1)
0^286
"KRN",.84,37320.9,0)
37320.9^2^^MAILMAN^'Closed' flag removed.
"KRN",.84,37320.9,2,0)
^^1^1^2991208^
"KRN",.84,37320.9,2,1,0)
'Closed' flag removed.
"KRN",.84,37320.9,5,0)
^.841^2^2
"KRN",.84,37320.9,5,1,0)
XMJMSO
"KRN",.84,37320.9,5,2,0)
XMXEDIT
"KRN",.84,37320.9,5,"B","XMJMSO",1)

"KRN",.84,37320.9,5,"B","XMXEDIT",2)

"KRN",.84,37331,-1)
0^287
"KRN",.84,37331,0)
37331^2^^MAILMAN^B:Backup to review message
"KRN",.84,37331,2,0)
^^1^1^2991208^
"KRN",.84,37331,2,1,0)
B:Backup to review message
"KRN",.84,37331,5,0)
^.841^2^2
"KRN",.84,37331,5,1,0)
XMJMOI
"KRN",.84,37331,5,2,0)
XMJMOSO
"KRN",.84,37331,5,"B","XMJMOI",1)

"KRN",.84,37331,5,"B","XMJMOSO",2)

"KRN",.84,37332,-1)
0^288
"KRN",.84,37332,0)
37332^2^^MAILMAN^ER:Edit Recipients
"KRN",.84,37332,2,0)
^^1^1^2991208^^
"KRN",.84,37332,2,1,0)
ER:Edit Recipients
"KRN",.84,37332,5,0)
^.841^1^1
"KRN",.84,37332,5,1,0)
XMJMSO
"KRN",.84,37332,5,"B","XMJMSO",1)

"KRN",.84,37333,-1)
0^289
"KRN",.84,37333,0)
37333^2^^MAILMAN^L:Transmit Later
"KRN",.84,37333,2,0)
^^1^1^2991208^^^
"KRN",.84,37333,2,1,0)
L:Transmit Later
"KRN",.84,37333,5,0)
^.841^1^1
"KRN",.84,37333,5,1,0)
XMJMSO
"KRN",.84,37333,5,"B","XMJMSO",1)

"KRN",.84,37333.1,-1)
0^290
"KRN",.84,37333.1,0)
37333.1^2^^MAILMAN^Enter Date@time at which to send this mess
"KRN",.84,37333.1,2,0)
^^1^1^2991221^
"KRN",.84,37333.1,2,1,0)
Enter Date@time at which to send this message
"KRN",.84,37333.1,5,0)
^.841^1^1
"KRN",.84,37333.1,5,1,0)
XMJMSO
"KRN",.84,37333.1,5,"B","XMJMSO",1)

"KRN",.84,37333.2,-1)
0^291
"KRN",.84,37333.2,0)
37333.2^2^^MAILMAN^  Latering ...
"KRN",.84,37333.2,2,0)
^^1^1^2991221^
"KRN",.84,37333.2,2,1,0)
  Latering ...
"KRN",.84,37333.2,5,0)
^.841^1^1
"KRN",.84,37333.2,5,1,0)
XMJMSO
"KRN",.84,37333.2,5,"B","XMJMSO",1)

"KRN",.84,37333.8,-1)
0^292
"KRN",.84,37333.8,0)
37333.8^1^^MAILMAN^Latering was not successful.
"KRN",.84,37333.8,2,0)
^^1^1^2991221^
"KRN",.84,37333.8,2,1,0)
Latering was not successful.  Try again or transmit now.
"KRN",.84,37333.8,5,0)
^.841^1^1
"KRN",.84,37333.8,5,1,0)
XMJMSO
"KRN",.84,37333.8,5,"B","XMJMSO",1)

"KRN",.84,37333.9,-1)
0^293
"KRN",.84,37333.9,0)
37333.9^2^y^MAILMAN^ Latered (Task #|1|)
"KRN",.84,37333.9,2,0)
^^1^1^2991221^
"KRN",.84,37333.9,2,1,0)
 Latered (Task #|1|)
"KRN",.84,37333.9,3,0)
^.845^1^1
"KRN",.84,37333.9,3,1,0)
1^task number
"KRN",.84,37333.9,5,0)
^.841^1^1
"KRN",.84,37333.9,5,1,0)
XMJMSO
"KRN",.84,37333.9,5,"B","XMJMSO",1)

"KRN",.84,37334,-1)
0^294
"KRN",.84,37334,0)
37334^2^^MAILMAN^T:Transmit now
"KRN",.84,37334,2,0)
^^1^1^2991208^
"KRN",.84,37334,2,1,0)
T:Transmit now
"KRN",.84,37334,5,0)
^.841^1^1
"KRN",.84,37334,5,1,0)
XMJMSO
"KRN",.84,37334,5,"B","XMJMSO",1)

"KRN",.84,37341,-1)
0^295
"KRN",.84,37341,0)
37341^2^^MAILMAN^E:Edit reply
"KRN",.84,37341,2,0)
^^1^1^2991208^
"KRN",.84,37341,2,1,0)
E:Edit reply
"KRN",.84,37341,5,0)
^.841^1^1
"KRN",.84,37341,5,1,0)
XMJMRO
"KRN",.84,37341,5,"B","XMJMRO",1)

"KRN",.84,37342,-1)
0^296
"KRN",.84,37342,0)
37342^2^^MAILMAN^I:Include previous responses in reply
"KRN",.84,37342,2,0)
^^1^1^2991208^
"KRN",.84,37342,2,1,0)
I:Include previous responses in reply
"KRN",.84,37342,5,0)
^.841^1^1
"KRN",.84,37342,5,1,0)
XMJMRO
"KRN",.84,37342,5,"B","XMJMRO",1)

"KRN",.84,37401,-1)
0^297
"KRN",.84,37401,0)
37401^2^^MAILMAN^A:Answer
"KRN",.84,37401,2,0)
^^1^1^2991207^
"KRN",.84,37401,2,1,0)
A:Answer
"KRN",.84,37401,5,0)
^.841^1^1
"KRN",.84,37401,5,1,0)
XMXSEC2
"KRN",.84,37401,5,"B","XMXSEC2",1)

"KRN",.84,37401.1,-1)
0^298
"KRN",.84,37401.1,0)
37401.1^1^^MAILMAN^You must have a Network Signature to Answe
"KRN",.84,37401.1,2,0)
^^1^1^2991207^
"KRN",.84,37401.1,2,1,0)
You must have a Network Signature to Answer a message.
"KRN",.84,37401.1,5,0)
^.841^1^1
"KRN",.84,37401.1,5,1,0)
XMXSEC2
"KRN",.84,37401.1,5,"B","XMXSEC2",1)

"KRN",.84,37401.2,-1)
0^299
"KRN",.84,37401.2,0)
37401.2^1^^MAILMAN^You may not Answer a scrambled message.
"KRN",.84,37401.2,2,0)
^^1^1^2991207^
"KRN",.84,37401.2,2,1,0)
You may not Answer a scrambled message.  Use Reply.
"KRN",.84,37401.2,5,0)
^.841^1^1
"KRN",.84,37401.2,5,1,0)
XMXSEC2
"KRN",.84,37401.2,5,"B","XMXSEC2",1)

"KRN",.84,37401.3,-1)
0^300
"KRN",.84,37401.3,0)
37401.3^1^^MAILMAN^|1| must have a Network Signature to Answe
"KRN",.84,37401.3,2,0)
^^1^1^2991207^
"KRN",.84,37401.3,2,1,0)
|1| must have a Network Signature to Answer a message.
"KRN",.84,37401.3,5,0)
^.841^1^1
"KRN",.84,37401.3,5,1,0)
XMXSEC2
"KRN",.84,37401.3,5,"B","XMXSEC2",1)

"KRN",.84,37401.4,-1)
0^301
"KRN",.84,37401.4,0)
37401.4^1^^MAILMAN^You may not Answer a KIDS or PackMan mess
"KRN",.84,37401.4,2,0)
^^1^1^2991207^
"KRN",.84,37401.4,2,1,0)
You may not Answer a KIDS or PackMan message.
"KRN",.84,37401.4,5,0)
^.841^1^1
"KRN",.84,37401.4,5,1,0)
XMXSEC2
"KRN",.84,37401.4,5,"B","XMXSEC2",1)

"KRN",.84,37401.5,-1)
0^302
"KRN",.84,37401.5,0)
37401.5^1^^MAILMAN^You need 'send' privilege to Answer a mess
"KRN",.84,37401.5,2,0)
^^1^1^2991207^
"KRN",.84,37401.5,2,1,0)
You need 'send' privilege to Answer a message.
"KRN",.84,37401.5,5,0)
^.841^1^1
"KRN",.84,37401.5,5,1,0)
XMXSEC2
"KRN",.84,37401.5,5,"B","XMXSEC2",1)

"KRN",.84,37402,-1)
0^303
"KRN",.84,37402,0)
37402^2^^MAILMAN^AA:Access Attachments
"KRN",.84,37402,2,0)
^^1^1^2991207^^
"KRN",.84,37402,2,1,0)
AA:Access Attachments
"KRN",.84,37402,5,0)
^.841^1^1
"KRN",.84,37402,5,1,0)
XMXSEC2
"KRN",.84,37402,5,"B","XMXSEC2",1)

"KRN",.84,37402.1,-1)
0^304
"KRN",.84,37402.1,0)
37402.1^1^^MAILMAN^This message has no attachments.
"KRN",.84,37402.1,2,0)
^^1^1^2991207^
"KRN",.84,37402.1,2,1,0)
This message has no attachments.
"KRN",.84,37402.1,5,0)
^.841^1^1
"KRN",.84,37402.1,5,1,0)
XMXSEC2
"KRN",.84,37402.1,5,"B","XMXSEC2",1)

"KRN",.84,37403,-1)
0^305
"KRN",.84,37403,0)
37403^2^^MAILMAN^C:Copy
"KRN",.84,37403,2,0)
^^1^1^2991207^
"KRN",.84,37403,2,1,0)
C:Copy
"KRN",.84,37403,5,0)
^.841^1^1
"KRN",.84,37403,5,1,0)
XMXSEC2
"KRN",.84,37403,5,"B","XMXSEC2",1)

"KRN",.84,37403.1,-1)
0^306
"KRN",.84,37403.1,0)
37403.1^1^^MAILMAN^Only the originator may Copy a 'closed' me
"KRN",.84,37403.1,2,0)
^^1^1^2991220^^^
"KRN",.84,37403.1,2,1,0)
Only the originator may Copy a 'closed' message.
"KRN",.84,37403.1,5,0)
^.841^1^1
"KRN",.84,37403.1,5,1,0)
XMXSEC2
"KRN",.84,37403.1,5,"B","XMXSEC2",1)

"KRN",.84,37403.2,-1)
0^307
"KRN",.84,37403.2,0)
37403.2^1^^MAILMAN^You may not Copy a scrambled message.
"KRN",.84,37403.2,2,0)
^^1^1^2991207^
"KRN",.84,37403.2,2,1,0)
You may not Copy a scrambled message.
"KRN",.84,37403.2,5,0)
^.841^1^1
"KRN",.84,37403.2,5,1,0)
XMXSEC2
"KRN",.84,37403.2,5,"B","XMXSEC2",1)

"KRN",.84,37403.4,-1)
0^308
"KRN",.84,37403.4,0)
37403.4^1^^MAILMAN^You may not Copy a secure KIDS or PackMan
"KRN",.84,37403.4,2,0)
^^1^1^2991207^
"KRN",.84,37403.4,2,1,0)
You may not Copy a secure KIDS or PackMan message.
"KRN",.84,37403.4,5,0)
^.841^1^1
"KRN",.84,37403.4,5,1,0)
XMXSEC2
"KRN",.84,37403.4,5,"B","XMXSEC2",1)

"KRN",.84,37403.5,-1)
0^309
"KRN",.84,37403.5,0)
37403.5^1^^MAILMAN^You need 'send' privilege to Copy a messag
"KRN",.84,37403.5,2,0)
^^1^1^2991207^
"KRN",.84,37403.5,2,1,0)
You need 'send' privilege to Copy a message.
"KRN",.84,37403.5,5,0)
^.841^1^1
"KRN",.84,37403.5,5,1,0)
XMXSEC2
"KRN",.84,37403.5,5,"B","XMXSEC2",1)

"KRN",.84,37403.6,-1)
0^310
"KRN",.84,37403.6,0)
37403.6^1^^MAILMAN^Only the originator may Copy a message in
"KRN",.84,37403.6,2,0)
^^1^1^2991220^
"KRN",.84,37403.6,2,1,0)
Only the originator may Copy a message in SHARED,MAIL.
"KRN",.84,37403.6,5,0)
^.841^1^1
"KRN",.84,37403.6,5,1,0)
XMXSEC3
"KRN",.84,37403.6,5,"B","XMXSEC3",1)

"KRN",.84,37404,-1)
0^311
"KRN",.84,37404,0)
37404^2^^MAILMAN^D:Delete
"KRN",.84,37404,2,0)
^^1^1^2991207^^
"KRN",.84,37404,2,1,0)
D:Delete
"KRN",.84,37404,5,0)
^.841^1^1
"KRN",.84,37404,5,1,0)
XMXSEC2
"KRN",.84,37404,5,"B","XMXSEC2",1)

"KRN",.84,37404.1,-1)
0^312
"KRN",.84,37404.1,0)
37404.1^1^^MAILMAN^This message has already been deleted.
"KRN",.84,37404.1,2,0)
^^1^1^2991207^
"KRN",.84,37404.1,2,1,0)
This message has already been deleted.  It's not in a basket.
"KRN",.84,37404.1,5,0)
^.841^1^1
"KRN",.84,37404.1,5,1,0)
XMXSEC2
"KRN",.84,37404.1,5,"B","XMXSEC2",1)

"KRN",.84,37404.5,-1)
0^313
"KRN",.84,37404.5,0)
37404.5^1^^MAILMAN^You need 'send' privilege to Edit a mess
"KRN",.84,37404.5,2,0)
^^1^1^2991207^
"KRN",.84,37404.5,2,1,0)
You need 'send' privilege to Edit a message.
"KRN",.84,37404.5,5,0)
^.841^1^1
"KRN",.84,37404.5,5,1,0)
XMXSEC2
"KRN",.84,37404.5,5,"B","XMXSEC2",1)

"KRN",.84,37405,-1)
0^314
"KRN",.84,37405,0)
37405^2^^MAILMAN^E:Edit
"KRN",.84,37405,2,0)
^^1^1^2991207^
"KRN",.84,37405,2,1,0)
E:Edit
"KRN",.84,37405,5,0)
^.841^1^1
"KRN",.84,37405,5,1,0)
XMXSEC2
"KRN",.84,37405,5,"B","XMXSEC2",1)

"KRN",.84,37405.1,-1)
0^315
"KRN",.84,37405.1,0)
37405.1^1^^MAILMAN^Only the originator may Edit a message.
"KRN",.84,37405.1,2,0)
^^1^1^2991220^^^^
"KRN",.84,37405.1,2,1,0)
Only the originator may Edit a message.
"KRN",.84,37405.1,5,0)
^.841^1^1
"KRN",.84,37405.1,5,1,0)
XMXSEC2
"KRN",.84,37405.1,5,"B","XMXSEC2",1)

"KRN",.84,37405.2,-1)
0^316
"KRN",.84,37405.2,0)
37405.2^1^^MAILMAN^You may not Edit a message you have alread
"KRN",.84,37405.2,2,0)
^^2^2^2991216^^
"KRN",.84,37405.2,2,1,0)
You may not Edit a message you have already sent to someone else.
"KRN",.84,37405.2,2,2,0)
You may toggle the 'information only' switch, if you wish.
"KRN",.84,37405.2,5,0)
^.841^1^1
"KRN",.84,37405.2,5,1,0)
XMXSEC2
"KRN",.84,37405.2,5,"B","XMXSEC2",1)

"KRN",.84,37405.3,-1)
0^317
"KRN",.84,37405.3,0)
37405.3^1^^MAILMAN^You may not Edit a message which has a r
"KRN",.84,37405.3,2,0)
^^1^1^2991216^^
"KRN",.84,37405.3,2,1,0)
You may not Edit a message which has a reply.
"KRN",.84,37405.3,5,0)
^.841^1^1
"KRN",.84,37405.3,5,1,0)
XMXSEC2
"KRN",.84,37405.3,5,"B","XMXSEC2",1)

"KRN",.84,37405.4,-1)
0^318
"KRN",.84,37405.4,0)
37405.4^1^^MAILMAN^You may not Edit a secure KIDS or PackMan
"KRN",.84,37405.4,2,0)
^^1^1^2991216^
"KRN",.84,37405.4,2,1,0)
You may not Edit a secure KIDS or PackMan message.
"KRN",.84,37405.4,5,0)
^.841^1^1
"KRN",.84,37405.4,5,1,0)
XMXSEC2
"KRN",.84,37405.4,5,"B","XMXSEC2",1)

"KRN",.84,37406,-1)
0^319
"KRN",.84,37406,0)
37406^2^^MAILMAN^F:Forward
"KRN",.84,37406,2,0)
^^1^1^2991207^
"KRN",.84,37406,2,1,0)
F:Forward
"KRN",.84,37406,5,0)
^.841^1^1
"KRN",.84,37406,5,1,0)
XMXSEC2
"KRN",.84,37406,5,"B","XMXSEC2",1)

"KRN",.84,37406.1,-1)
0^320
"KRN",.84,37406.1,0)
37406.1^1^^MAILMAN^Only the originator may forward a 'closed'
"KRN",.84,37406.1,2,0)
^^1^1^2991207^
"KRN",.84,37406.1,2,1,0)
Only the originator may forward a 'closed' message.
"KRN",.84,37406.1,5,0)
^.841^1^1
"KRN",.84,37406.1,5,1,0)
XMXSEC2
"KRN",.84,37406.1,5,"B","XMXSEC2",1)

"KRN",.84,37406.6,-1)
0^321
"KRN",.84,37406.6,0)
37406.6^1^^MAILMAN^Only the originator may forward a message
"KRN",.84,37406.6,2,0)
^^1^1^2991207^
"KRN",.84,37406.6,2,1,0)
Only the originator may forward a message in SHARED,MAIL.
"KRN",.84,37406.6,5,0)
^.841^1^1
"KRN",.84,37406.6,5,1,0)
XMXSEC2
"KRN",.84,37406.6,5,"B","XMXSEC2",1)

"KRN",.84,37407,-1)
0^322
"KRN",.84,37407,0)
37407^2^^MAILMAN^H:Headerless Print
"KRN",.84,37407,2,0)
^^1^1^2991207^
"KRN",.84,37407,2,1,0)
H:Headerless Print
"KRN",.84,37407,5,0)
^.841^1^1
"KRN",.84,37407,5,1,0)
XMXSEC2
"KRN",.84,37407,5,"B","XMXSEC2",1)

"KRN",.84,37408,-1)
0^323
"KRN",.84,37408,0)
37408^2^^MAILMAN^IN:Information only
"KRN",.84,37408,2,0)
^^1^1^2991207^
"KRN",.84,37408,2,1,0)
IN:Information only
"KRN",.84,37408,5,0)
^.841^1^1
"KRN",.84,37408,5,1,0)
XMXSEC2
"KRN",.84,37408,5,"B","XMXSEC2",1)

"KRN",.84,37408.9,-1)
0^326
"KRN",.84,37408.9,0)
37408.9^2^^MAILMAN^Message is now 'Information only'.  No one
"KRN",.84,37408.9,2,0)
^^1^1^2991216^
"KRN",.84,37408.9,2,1,0)
Message is now 'Information only'.  No one may reply.
"KRN",.84,37408.9,5,0)
^.841^1^1
"KRN",.84,37408.9,5,1,0)
XMJMOI
"KRN",.84,37408.9,5,"B","XMJMOI",1)

"KRN",.84,37409,-1)
0^324
"KRN",.84,37409,0)
37409^2^^MAILMAN^IN:UnInformation only
"KRN",.84,37409,2,0)
^^1^1^2991207^
"KRN",.84,37409,2,1,0)
IN:UnInformation only
"KRN",.84,37409,5,0)
^.841^1^1
"KRN",.84,37409,5,1,0)
XMXSEC2
"KRN",.84,37409,5,"B","XMXSEC2",1)

"KRN",.84,37409.1,-1)
0^327
"KRN",.84,37409.1,0)
37409.1^1^^MAILMAN^Only the originator may toggle 'Informat
"KRN",.84,37409.1,2,0)
^^1^1^2991207^
"KRN",.84,37409.1,2,1,0)
Only the originator may toggle 'Information only'.
"KRN",.84,37409.1,5,0)
^.841^1^1
"KRN",.84,37409.1,5,1,0)
XMXSEC2
"KRN",.84,37409.1,5,"B","XMXSEC2",1)

"KRN",.84,37409.5,-1)
0^328
"KRN",.84,37409.5,0)
37409.5^1^^MAILMAN^You need 'send' privilege to toggle 'Info
"KRN",.84,37409.5,2,0)
^^1^1^2991207^
"KRN",.84,37409.5,2,1,0)
You need 'send' privilege to toggle 'Information only'.
"KRN",.84,37409.5,5,0)
^.841^1^1
"KRN",.84,37409.5,5,1,0)
XMXSEC2
"KRN",.84,37409.5,5,"B","XMXSEC2",1)

"KRN",.84,37409.9,-1)
0^325
"KRN",.84,37409.9,0)
37409.9^2^^MAILMAN^Message is no longer 'Information only'.
"KRN",.84,37409.9,2,0)
^^1^1^2991216^
"KRN",.84,37409.9,2,1,0)
Message is no longer 'Information only'.
"KRN",.84,37409.9,5,0)
^.841^1^1
"KRN",.84,37409.9,5,1,0)
XMJMOI
"KRN",.84,37409.9,5,"B","XMJMOI",1)

"KRN",.84,37411,-1)
0^329
"KRN",.84,37411,0)
37411^2^^MAILMAN^K:Priority replies
"KRN",.84,37411,2,0)
^^1^1^2991207^
"KRN",.84,37411,2,1,0)
K:Priority replies
"KRN",.84,37411,5,0)
^.841^1^1
"KRN",.84,37411,5,1,0)
XMXSEC2
"KRN",.84,37411,5,"B","XMXSEC2",1)

"KRN",.84,37411.9,-1)
0^330
"KRN",.84,37411.9,0)
37411.9^2^^MAILMAN^Responses will be delivered as Priority
"KRN",.84,37411.9,2,0)
^^1^1^2991216^
"KRN",.84,37411.9,2,1,0)
Responses will be delivered as Priority Mail.
"KRN",.84,37411.9,5,0)
^.841^1^1
"KRN",.84,37411.9,5,1,0)
XMJMOI
"KRN",.84,37411.9,5,"B","XMJMOI",1)

"KRN",.84,37412,-1)
0^331
"KRN",.84,37412,0)
37412^2^^MAILMAN^K:UnPriority replies
"KRN",.84,37412,2,0)
^^1^1^2991207^
"KRN",.84,37412,2,1,0)
K:UnPriority replies
"KRN",.84,37412,5,0)
^.841^1^1
"KRN",.84,37412,5,1,0)
XMXSEC2
"KRN",.84,37412,5,"B","XMXSEC2",1)

"KRN",.84,37412.1,-1)
0^332
"KRN",.84,37412.1,0)
37412.1^1^^MAILMAN^The message must be 'priority' in order to
"KRN",.84,37412.1,2,0)
^^1^1^2991207^
"KRN",.84,37412.1,2,1,0)
The message must be 'priority' in order to toggle 'Priority replies'.
"KRN",.84,37412.1,5,0)
^.841^1^1
"KRN",.84,37412.1,5,1,0)
XMXSEC2
"KRN",.84,37412.1,5,"B","XMXSEC2",1)

"KRN",.84,37412.9,-1)
0^333
"KRN",.84,37412.9,0)
37412.9^2^^MAILMAN^Responses will not be delivered as Pri
"KRN",.84,37412.9,2,0)
^^1^1^2991216^
"KRN",.84,37412.9,2,1,0)
Responses will not be delivered as Priority Mail.
"KRN",.84,37412.9,5,0)
^.841^1^1
"KRN",.84,37412.9,5,1,0)
XMJMOI
"KRN",.84,37412.9,5,"B","XMJMOI",1)

"KRN",.84,37413,-1)
0^334
"KRN",.84,37413,0)
37413^2^^MAILMAN^L:Later
"KRN",.84,37413,2,0)
^^1^1^2991207^
"KRN",.84,37413,2,1,0)
L:Later
"KRN",.84,37413,5,0)
^.841^1^1
"KRN",.84,37413,5,1,0)
XMXSEC2
"KRN",.84,37413,5,"B","XMXSEC2",1)

"KRN",.84,37414,-1)
0^335
"KRN",.84,37414,0)
37414^2^^MAILMAN^N:New
"KRN",.84,37414,2,0)
^^1^1^2991207^
"KRN",.84,37414,2,1,0)
N:New
"KRN",.84,37414,5,0)
^.841^1^1
"KRN",.84,37414,5,1,0)
XMXSEC2
"KRN",.84,37414,5,"B","XMXSEC2",1)

"KRN",.84,37414.9,-1)
0^336
"KRN",.84,37414.9,0)
37414.9^2^^MAILMAN^Message will be new next time.
"KRN",.84,37414.9,2,0)
^^1^1^2991216^
"KRN",.84,37414.9,2,1,0)
Message will be new next time.
"KRN",.84,37414.9,5,0)
^.841^1^1
"KRN",.84,37414.9,5,1,0)
XMJMOI
"KRN",.84,37414.9,5,"B","XMJMOI",1)

"KRN",.84,37415,-1)
0^337
"KRN",.84,37415,0)
37415^2^^MAILMAN^N:UnNew
"KRN",.84,37415,2,0)
^^1^1^2991207^
"KRN",.84,37415,2,1,0)
N:UnNew
"KRN",.84,37415,5,0)
^.841^1^1
"KRN",.84,37415,5,1,0)
XMXSEC2
"KRN",.84,37415,5,"B","XMXSEC2",1)

"KRN",.84,37415.9,-1)
0^338
"KRN",.84,37415.9,0)
37415.9^2^^MAILMAN^Message will NOT be new next time.
"KRN",.84,37415.9,2,0)
^^1^1^2991216^
"KRN",.84,37415.9,2,1,0)
Message will NOT be new next time.
"KRN",.84,37415.9,5,0)
^.841^1^1
"KRN",.84,37415.9,5,1,0)
XMJMOI
"KRN",.84,37415.9,5,"B","XMJMOI",1)

"KRN",.84,37416,-1)
0^339
"KRN",.84,37416,0)
37416^2^^MAILMAN^P:Print
"KRN",.84,37416,2,0)
^^1^1^2991207^
"KRN",.84,37416,2,1,0)
P:Print
"KRN",.84,37416,5,0)
^.841^1^1
"KRN",.84,37416,5,1,0)
XMXSEC2
"KRN",.84,37416,5,"B","XMXSEC2",1)

"KRN",.84,37416.4,-1)
0^340
"KRN",.84,37416.4,0)
37416.4^1^^MAILMAN^You may not Print a secure KIDS or PackMan
"KRN",.84,37416.4,2,0)
^^1^1^2991207^
"KRN",.84,37416.4,2,1,0)
You may not Print a secure KIDS or PackMan message.
"KRN",.84,37416.4,5,0)
^.841^2^2
"KRN",.84,37416.4,5,1,0)
XMXSEC2
"KRN",.84,37416.4,5,2,0)
XMJMP
"KRN",.84,37416.4,5,"B","XMJMP",2)

"KRN",.84,37416.4,5,"B","XMXSEC2",1)

"KRN",.84,37417,-1)
0^341
"KRN",.84,37417,0)
37417^2^^MAILMAN^Q:Query
"KRN",.84,37417,2,0)
^^1^1^2991207^
"KRN",.84,37417,2,1,0)
Q:Query
"KRN",.84,37417,5,0)
^.841^1^1
"KRN",.84,37417,5,1,0)
XMXSEC2
"KRN",.84,37417,5,"B","XMXSEC2",1)

"KRN",.84,37418,-1)
0^342
"KRN",.84,37418,0)
37418^1^^MAILMAN^QD:Query Detailed
"KRN",.84,37418,2,0)
^^1^1^2991207^
"KRN",.84,37418,2,1,0)
QD:Query Detailed
"KRN",.84,37418,5,0)
^.841^1^1
"KRN",.84,37418,5,1,0)
XMXSEC2
"KRN",.84,37418,5,"B","XMXSEC2",1)

"KRN",.84,37419,-1)
0^343
"KRN",.84,37419,0)
37419^2^^MAILMAN^QN:Query Network
"KRN",.84,37419,2,0)
^^1^1^2991207^
"KRN",.84,37419,2,1,0)
QN:Query Network
"KRN",.84,37419,5,0)
^.841^1^1
"KRN",.84,37419,5,1,0)
XMXSEC2
"KRN",.84,37419,5,"B","XMXSEC2",1)

"KRN",.84,37420,-1)
0^344
"KRN",.84,37420,0)
37420^2^^MAILMAN^QR:Query Recipients
"KRN",.84,37420,2,0)
^^1^1^2991207^
"KRN",.84,37420,2,1,0)
QR:Query Recipients
"KRN",.84,37420,5,0)
^.841^1^1
"KRN",.84,37420,5,1,0)
XMXSEC2
"KRN",.84,37420,5,"B","XMXSEC2",1)

"KRN",.84,37420.1,-1)
0^345
"KRN",.84,37420.1,0)
37420.1^2^^MAILMAN^Q xxx:Query recipient(s) xxx
"KRN",.84,37420.1,2,0)
^^1^1^2991207^
"KRN",.84,37420.1,2,1,0)
Q xxx:Query recipient(s) xxx
"KRN",.84,37420.1,5,0)
^.841^1^1
"KRN",.84,37420.1,5,1,0)
XMJMOI
"KRN",.84,37420.1,5,"B","XMJMOI",1)

"KRN",.84,37422,-1)
0^346
"KRN",.84,37422,0)
37422^2^^MAILMAN^R:Reply
"KRN",.84,37422,2,0)
^^1^1^2991207^
"KRN",.84,37422,2,1,0)
R:Reply
"KRN",.84,37422,5,0)
^.841^1^1
"KRN",.84,37422,5,1,0)
XMXSEC2
"KRN",.84,37422,5,"B","XMXSEC2",1)

"KRN",.84,37422.1,-1)
0^347
"KRN",.84,37422.1,0)
37422.1^1^^MAILMAN^Only the originator may reply to an 'Info
"KRN",.84,37422.1,2,0)
^^1^1^2991207^
"KRN",.84,37422.1,2,1,0)
Only the originator may reply to an 'Information only' message.
"KRN",.84,37422.1,5,0)
^.841^1^1
"KRN",.84,37422.1,5,1,0)
XMXSEC2
"KRN",.84,37422.1,5,"B","XMXSEC2",1)

"KRN",.84,37422.2,-1)
0^348
"KRN",.84,37422.2,0)
37422.2^1^^MAILMAN^'Information only' recipients may not repl
"KRN",.84,37422.2,2,0)
^^1^1^2991220^^
"KRN",.84,37422.2,2,1,0)
'Information only' recipients may not reply to a message.
"KRN",.84,37422.2,5,0)
^.841^1^1
"KRN",.84,37422.2,5,1,0)
XMXSEC2
"KRN",.84,37422.2,5,"B","XMXSEC2",1)

"KRN",.84,37422.4,-1)
0^349
"KRN",.84,37422.4,0)
37422.4^1^^MAILMAN^You may not Reply to a secure KIDS or Pack
"KRN",.84,37422.4,2,0)
^^1^1^2991207^
"KRN",.84,37422.4,2,1,0)
You may not Reply to a secure KIDS or PackMan message.
"KRN",.84,37422.4,5,0)
^.841^1^1
"KRN",.84,37422.4,5,1,0)
XMXSEC2
"KRN",.84,37422.4,5,"B","XMXSEC2",1)

"KRN",.84,37422.5,-1)
0^350
"KRN",.84,37422.5,0)
37422.5^1^^MAILMAN^You may not Reply to a message from a remo
"KRN",.84,37422.5,2,0)
^^1^1^2991220^
"KRN",.84,37422.5,2,1,0)
You may not Reply to a message from a remote Postmaster.
"KRN",.84,37422.5,5,0)
^.841^1^1
"KRN",.84,37422.5,5,1,0)
XMXSEC
"KRN",.84,37422.5,5,"B","XMXSEC",1)

"KRN",.84,37422.6,-1)
0^351
"KRN",.84,37422.6,0)
37422.6^1^^MAILMAN^SHARED,MAIL may not Reply to a message.
"KRN",.84,37422.6,2,0)
^^1^1^2991207^
"KRN",.84,37422.6,2,1,0)
SHARED,MAIL may not Reply to a message.
"KRN",.84,37422.6,5,0)
^.841^1^1
"KRN",.84,37422.6,5,1,0)
XMXSEC2
"KRN",.84,37422.6,5,"B","XMXSEC2",1)

"KRN",.84,37423,-1)
0^352
"KRN",.84,37423,0)
37423^2^^MAILMAN^S:Save
"KRN",.84,37423,2,0)
^^1^1^2991207^
"KRN",.84,37423,2,1,0)
S:Save
"KRN",.84,37423,5,0)
^.841^1^1
"KRN",.84,37423,5,1,0)
XMXSEC2
"KRN",.84,37423,5,"B","XMXSEC2",1)

"KRN",.84,37424,-1)
0^353
"KRN",.84,37424,0)
37424^2^^MAILMAN^T:Terminate
"KRN",.84,37424,2,0)
^^1^1^2991207^
"KRN",.84,37424,2,1,0)
T:Terminate
"KRN",.84,37424,5,0)
^.841^1^1
"KRN",.84,37424,5,1,0)
XMXSEC2
"KRN",.84,37424,5,"B","XMXSEC2",1)

"KRN",.84,37425,-1)
0^354
"KRN",.84,37425,0)
37425^2^^MAILMAN^V:Vaporize date edit
"KRN",.84,37425,2,0)
^^1^1^2991207^
"KRN",.84,37425,2,1,0)
V:Vaporize date edit
"KRN",.84,37425,5,0)
^.841^1^1
"KRN",.84,37425,5,1,0)
XMXSEC2
"KRN",.84,37425,5,"B","XMXSEC2",1)

"KRN",.84,37425.1,-1)
0^355
"KRN",.84,37425.1,0)
37425.1^1^^MAILMAN^This message has already been vaporized.
"KRN",.84,37425.1,2,0)
^^1^1^2991207^
"KRN",.84,37425.1,2,1,0)
This message has already been vaporized.  It's not in a basket.
"KRN",.84,37425.1,5,0)
^.841^1^1
"KRN",.84,37425.1,5,1,0)
XMXSEC2
"KRN",.84,37425.1,5,"B","XMXSEC2",1)

"KRN",.84,37426,-1)
0^356
"KRN",.84,37426,0)
37426^2^^MAILMAN^X:Xtract
"KRN",.84,37426,2,0)
^^1^1^2991207^
"KRN",.84,37426,2,1,0)
X:Xtract
"KRN",.84,37426,5,0)
^.841^1^1
"KRN",.84,37426,5,1,0)
XMXSEC2
"KRN",.84,37426,5,"B","XMXSEC2",1)

"KRN",.84,37427,-1)
0^357
"KRN",.84,37427,0)
37427^2^^MAILMAN^X:Xtract KIDS
"KRN",.84,37427,2,0)
^^1^1^2991207^
"KRN",.84,37427,2,1,0)
X:Xtract KIDS
"KRN",.84,37427,5,0)
^.841^1^1
"KRN",.84,37427,5,1,0)
XMXSEC2
"KRN",.84,37427,5,"B","XMXSEC2",1)

"KRN",.84,37428,-1)
0^358
"KRN",.84,37428,0)
37428^2^^MAILMAN^X:Xtract PackMan
"KRN",.84,37428,2,0)
^^1^1^2991207^
"KRN",.84,37428,2,1,0)
X:Xtract PackMan
"KRN",.84,37428,5,0)
^.841^1^1
"KRN",.84,37428,5,1,0)
XMXSEC2
"KRN",.84,37428,5,"B","XMXSEC2",1)

"KRN",.84,37428.1,-1)
0^359
"KRN",.84,37428.1,0)
37428.1^1^^MAILMAN^This message is neither KIDS nor Packman.
"KRN",.84,37428.1,2,0)
^^1^1^2991207^
"KRN",.84,37428.1,2,1,0)
This message is neither KIDS nor Packman.
"KRN",.84,37428.1,5,0)
^.841^1^1
"KRN",.84,37428.1,5,1,0)
XMXSEC2
"KRN",.84,37428.1,5,"B","XMXSEC2",1)

"KRN",.84,37428.2,-1)
0^360
"KRN",.84,37428.2,0)
37428.2^1^^MAILMAN^You must hold the XUPROGMODE key to extr
"KRN",.84,37428.2,2,0)
^^1^1^2991207^
"KRN",.84,37428.2,2,1,0)
You must hold the XUPROGMODE key to extract KIDS or PackMan messages.
"KRN",.84,37428.2,5,0)
^.841^1^1
"KRN",.84,37428.2,5,1,0)
XMXSEC2
"KRN",.84,37428.2,5,"B","XMXSEC2",1)

"KRN",.84,37441,-1)
0^361
"KRN",.84,37441,0)
37441^2^^MAILMAN^B:Backup
"KRN",.84,37441,2,0)
^^1^1^2991207^
"KRN",.84,37441,2,1,0)
B:Backup
"KRN",.84,37441,5,0)
^.841^1^1
"KRN",.84,37441,5,1,0)
XMXSEC2
"KRN",.84,37441,5,"B","XMXSEC2",1)

"KRN",.84,37442,-1)
0^362
"KRN",.84,37442,0)
37442^2^^MAILMAN^I:Ignore
"KRN",.84,37442,2,0)
^^1^1^2991207^
"KRN",.84,37442,2,1,0)
I:Ignore
"KRN",.84,37442,5,0)
^.841^1^1
"KRN",.84,37442,5,1,0)
XMXSEC2
"KRN",.84,37442,5,"B","XMXSEC2",1)

"KRN",.84,37443,-1)
0^363
"KRN",.84,37443,0)
37443^2^^MAILMAN^RI:Reply and Include responses
"KRN",.84,37443,2,0)
^^1^1^2991207^
"KRN",.84,37443,2,1,0)
RI:Reply and Include responses
"KRN",.84,37443,5,0)
^.841^1^1
"KRN",.84,37443,5,1,0)
XMXSEC2
"KRN",.84,37443,5,"B","XMXSEC2",1)

"KRN",.84,37444,-1)
0^364
"KRN",.84,37444,0)
37444^2^^MAILMAN^W:Write
"KRN",.84,37444,2,0)
^^1^1^2991207^
"KRN",.84,37444,2,1,0)
W:Write
"KRN",.84,37444,5,0)
^.841^1^1
"KRN",.84,37444,5,1,0)
XMXSEC2
"KRN",.84,37444,5,"B","XMXSEC2",1)

"KRN",.84,37444.5,-1)
0^365
"KRN",.84,37444.5,0)
37444.5^1^^MAILMAN^You need 'send' privilege to Write (send)
"KRN",.84,37444.5,2,0)
^^1^1^2991207^
"KRN",.84,37444.5,2,1,0)
You need 'send' privilege to Write (send) a message.
"KRN",.84,37444.5,5,0)
^.841^1^1
"KRN",.84,37444.5,5,1,0)
XMXSEC2
"KRN",.84,37444.5,5,"B","XMXSEC2",1)

"KRN",.84,37451,-1)
0^366
"KRN",.84,37451,0)
37451^1^^MAILMAN^'Confidential' messages are off-limits to
"KRN",.84,37451,1,0)
^^2^2^2991220^^
"KRN",.84,37451,1,1,0)
Surrogates may not read or do anything with or to 'confidential'
"KRN",.84,37451,1,2,0)
messages, except save them to other baskets or new toggle or later them.
"KRN",.84,37451,2,0)
^^1^1^2991220^^
"KRN",.84,37451,2,1,0)
'Confidential' messages are off-limits to surrogates.
"KRN",.84,37451,5,0)
^.841^1^1
"KRN",.84,37451,5,1,0)
XMXSEC
"KRN",.84,37451,5,"B","XMXSEC",1)

"KRN",.84,37452,-1)
0^367
"KRN",.84,37452,0)
37452^1^y^MAILMAN^Surrogates may not |1| 'confidential' mess
"KRN",.84,37452,2,0)
^^1^1^2991220^^
"KRN",.84,37452,2,1,0)
Surrogates may not |1| 'confidential' messages.
"KRN",.84,37452,3,0)
^.845^1^1
"KRN",.84,37452,3,1,0)
1^type of access attempted
"KRN",.84,37452,5,0)
^.841^1^1
"KRN",.84,37452,5,1,0)
XMXSEC
"KRN",.84,37452,5,"B","XMXSEC",1)

"KRN",.84,37453,-1)
0^368
"KRN",.84,37453,0)
37453^1^^MAILMAN^This session is concurrent with another.
"KRN",.84,37453,2,0)
^^1^1^2991207^
"KRN",.84,37453,2,1,0)
This session is concurrent with another.  You may not do this.
"KRN",.84,37453,5,0)
^.841^2^2
"KRN",.84,37453,5,1,0)
XMJMOI
"KRN",.84,37453,5,2,0)
XMJMS
"KRN",.84,37453,5,"B","XMJMOI",1)

"KRN",.84,37453,5,"B","XMJMS",2)

"KRN",.84,37455,-1)
0^369
"KRN",.84,37455,0)
37455^1^y^MAILMAN^You do not have 'read' privilege for |1|.
"KRN",.84,37455,2,0)
^^1^1^2991220^
"KRN",.84,37455,2,1,0)
You do not have 'read' privilege for |1|.
"KRN",.84,37455,3,0)
^.845^1^1
"KRN",.84,37455,3,1,0)
1^surrogate name
"KRN",.84,37455,5,0)
^.841^1^1
"KRN",.84,37455,5,1,0)
XMXSEC
"KRN",.84,37455,5,"B","XMXSEC",1)

"KRN",.84,37456,-1)
0^370
"KRN",.84,37456,0)
37456^1^y^MAILMAN^You do not have 'send' privilege for |1|.
"KRN",.84,37456,2,0)
^^1^1^2991220^^
"KRN",.84,37456,2,1,0)
You do not have 'send' privilege for |1|.
"KRN",.84,37456,3,0)
^.845^1^1
"KRN",.84,37456,3,1,0)
1^surrogate name
"KRN",.84,37456,5,0)
^.841^1^1
"KRN",.84,37456,5,1,0)
XMXSEC
"KRN",.84,37456,5,"B","XMXSEC",1)

"KRN",.84,37457,-1)
0^371
"KRN",.84,37457,0)
37457^1^y^MAILMAN^You do not have 'read' or 'send' privilege
"KRN",.84,37457,2,0)
^^1^1^2991220^^
"KRN",.84,37457,2,1,0)
You do not have 'read' or 'send' privilege for |1|.
"KRN",.84,37457,3,0)
^.845^1^1
"KRN",.84,37457,3,1,0)
1^surrogate name
"KRN",.84,37457,5,0)
^.841^1^1
"KRN",.84,37457,5,1,0)
XMXSEC
"KRN",.84,37457,5,"B","XMXSEC",1)

"KRN",.84,37458,-1)
0^372
"KRN",.84,37458,0)
37458^1^^MAILMAN^Only a POSTMASTER surrogate or XMMGR key
"KRN",.84,37458,2,0)
^^1^1^2991220^
"KRN",.84,37458,2,1,0)
Only a POSTMASTER surrogate or XMMGR key holder may do this.
"KRN",.84,37458,5,0)
^.841^1^1
"KRN",.84,37458,5,1,0)
XMXSEC
"KRN",.84,37458,5,"B","XMXSEC",1)

"KRN",.84,37461,-1)
0^373
"KRN",.84,37461,0)
37461^1^^MAILMAN^You must be the message originator, hold
"KRN",.84,37461,2,0)
^^2^2^2991207^
"KRN",.84,37461,2,1,0)
You must be the message originator, hold the XMMGR key,
"KRN",.84,37461,2,2,0)
or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"KRN",.84,37461,5,0)
^.841^1^1
"KRN",.84,37461,5,1,0)
XMXSEC2
"KRN",.84,37461,5,"B","XMXSEC2",1)

"KRN",.84,37462,-1)
0^374
"KRN",.84,37462,0)
37462^1^^MAILMAN^You may not do this in SHARED,MAIL.
"KRN",.84,37462,2,0)
^^1^1^2991207^
"KRN",.84,37462,2,1,0)
You may not do this in SHARED,MAIL.
"KRN",.84,37462,5,0)
^.841^2^2
"KRN",.84,37462,5,1,0)
XMXSEC1
"KRN",.84,37462,5,2,0)
XMXSEC2
"KRN",.84,37462,5,"B","XMXSEC1",1)

"KRN",.84,37462,5,"B","XMXSEC2",2)

"KRN",.84,37470,-1)
0^375
"KRN",.84,37470,0)
37470^1^y^MAILMAN^You may not copy more than the site limit
"KRN",.84,37470,2,0)
^^1^1^2991221^
"KRN",.84,37470,2,1,0)
You may not copy more than the site limit of |1| lines.
"KRN",.84,37470,3,0)
^.845^1^1
"KRN",.84,37470,3,1,0)
1^max number of lines
"KRN",.84,37470,5,0)
^.841^1^1
"KRN",.84,37470,5,1,0)
XMXSEC1
"KRN",.84,37470,5,"B","XMXSEC1",1)

"KRN",.84,37471,-1)
0^376
"KRN",.84,37471,0)
37471^1^y^MAILMAN^You may not copy more than the site limit
"KRN",.84,37471,2,0)
^^1^1^2991221^
"KRN",.84,37471,2,1,0)
You may not copy more than the site limit of |1| responses.
"KRN",.84,37471,3,0)
^.845^1^1
"KRN",.84,37471,3,1,0)
1^max number of responses
"KRN",.84,37471,5,0)
^.841^1^1
"KRN",.84,37471,5,1,0)
XMXSEC1
"KRN",.84,37471,5,"B","XMXSEC1",1)

"KRN",.84,37472,-1)
0^377
"KRN",.84,37472,0)
37472^1^y^MAILMAN^Because this message has more than the si
"KRN",.84,37472,2,0)
^^3^3^2991221^^
"KRN",.84,37472,2,1,0)
Because this message has more than the site limit of |1| recipients,
"KRN",.84,37472,2,2,0)
we will neither list them in the text of the copy,
"KRN",.84,37472,2,3,0)
nor will we deliver the copy to them.
"KRN",.84,37472,3,0)
^.845^1^1
"KRN",.84,37472,3,1,0)
1^max number of recipients
"KRN",.84,37472,5,0)
^.841^1^1
"KRN",.84,37472,5,1,0)
XMXSEC1
"KRN",.84,37472,5,"B","XMXSEC1",1)

"KRN",9.2,379,-1)
0^3
"KRN",9.2,379,0)
XM-U-M-NEW^MAKE NEW MESSAGES NOT NEW AND VICE VERSA^2991213.1443^^
"KRN",9.2,379,1,0)
^^14^14^2991213^^^
"KRN",9.2,379,1,1,0)
 
"KRN",9.2,379,1,2,0)
The New Toggle action code allows you to make existing messages appear new
"KRN",9.2,379,1,3,0)
or make new messages not new.  The toggle works as follows:
"KRN",9.2,379,1,4,0)
 
"KRN",9.2,379,1,5,0)
  * Make a message 'new' - MailMan adds the new flag (i.e., '*' asterisk)
"KRN",9.2,379,1,6,0)
    next to the message, as if it hasn't been opened/read yet.
"KRN",9.2,379,1,7,0)
 
"KRN",9.2,379,1,8,0)
  * Make a 'new' message not appear as 'new' (i.e., Un New) - MailMan
"KRN",9.2,379,1,9,0)
    removes the new flag (i.e., '*' asterisk) next to the message, as if
"KRN",9.2,379,1,10,0)
    it was already opened/read.
"KRN",9.2,379,1,11,0)
 
"KRN",9.2,379,1,12,0)
You can toggle between these two actions with this one action code.
"KRN",9.2,379,1,13,0)
 
"KRN",9.2,379,1,14,0)
 [MORE]...
"KRN",9.2,379,2,0)
^9.22^2^1
"KRN",9.2,379,2,2,0)
MORE^XM-U-M-NEW-2
"KRN",9.2,458,-1)
0^8
"KRN",9.2,458,0)
XM-U-M-EDIT SUBJECT^EDIT THE SUBJECT OF A MESSAGE^2991213.1335^^
"KRN",9.2,458,1,0)
^^13^13^2991213^^^^
"KRN",9.2,458,1,1,0)
 
"KRN",9.2,458,1,2,0)
You can use the Edit Subject action code (i.e., 'ES') to change the
"KRN",9.2,458,1,3,0)
subject text of a message you intend on sending.
"KRN",9.2,458,1,4,0)
 
"KRN",9.2,458,1,5,0)
The subject of the message is shown whenever the message is displayed. It
"KRN",9.2,458,1,6,0)
can be from 3 to 65 characters in length. Any leading and trailing blanks
"KRN",9.2,458,1,7,0)
are deleted. Also, any sequence of three or more blanks is reduced to two
"KRN",9.2,458,1,8,0)
blanks.
"KRN",9.2,458,1,9,0)
 
"KRN",9.2,458,1,10,0)
To edit the subject of a message prior to sending it, enter an 'ES' at the
"KRN",9.2,458,1,11,0)
'Select Message option:  Transmit now//' prompt or enter an 'E' at the
"KRN",9.2,458,1,12,0)
'Enter message option' prompt and then enter 'ES' at the 'Select Edit
"KRN",9.2,458,1,13,0)
option:' prompt.
"KRN",9.2,459,-1)
0^9
"KRN",9.2,459,0)
XM-U-M-EDIT TEXT^EDIT THE TEXT OF A MESSAGE^2991213.1336^^
"KRN",9.2,459,1,0)
^^9^9^2991213^^
"KRN",9.2,459,1,1,0)
 
"KRN",9.2,459,1,2,0)
You can use the Edit Text action code (i.e., 'ET') to change the text
"KRN",9.2,459,1,3,0)
(body) of the message you intend on sending. You can add to, modify, or
"KRN",9.2,459,1,4,0)
delete any part of the text within the body of the message.
"KRN",9.2,459,1,5,0)
 
"KRN",9.2,459,1,6,0)
To edit the text of a message prior to sending it, enter an 'ET' at the
"KRN",9.2,459,1,7,0)
'Select Message option:  Transmit now//' prompt or enter an 'E' at the
"KRN",9.2,459,1,8,0)
'Enter message option' prompt and then enter 'ET' at the 'Select Edit
"KRN",9.2,459,1,9,0)
option:' prompt.
"KRN",9.2,491,-1)
0^5
"KRN",9.2,491,0)
XM-U-BO-CLASSIC^CLASSIC READER BASKET MESSAGE ACTIONS^2991213.1325^^
"KRN",9.2,491,1,0)
^^21^21^2991213^^
"KRN",9.2,491,1,1,0)
 
"KRN",9.2,491,1,2,0)
Enter ^ to exit, or press <Enter> to read the default message, or enter:
"KRN",9.2,491,1,3,0)
 
"KRN",9.2,491,1,4,0)
 ? or ??  See a [SUMMARY] or [DETAILED] list of messages in this basket,
"KRN",9.2,491,1,5,0)
          beginning with the default message.
"KRN",9.2,491,1,6,0)
 n        Read message n, where n is a sequence [NUMBER] in this basket or
"KRN",9.2,491,1,7,0)
          an internal message ID of any message on the system.
"KRN",9.2,491,1,8,0)
 
"KRN",9.2,491,1,9,0)
The following commands act on one or more messages in this basket. You
"KRN",9.2,491,1,10,0)
will be asked to specify a [RANGE] of messages after entering the command.
"KRN",9.2,491,1,11,0)
 [D]        Delete messages.
"KRN",9.2,491,1,12,0)
 [F]        Forward messages.
"KRN",9.2,491,1,13,0)
 [FI]       Filter messages.
"KRN",9.2,491,1,14,0)
 [L]        Later messages.
"KRN",9.2,491,1,15,0)
 [P] or [H]   Print messages with or without a header.
"KRN",9.2,491,1,16,0)
 [NT]       New Toggle messages.
"KRN",9.2,491,1,17,0)
 [S]        Save messages to another basket.
"KRN",9.2,491,1,18,0)
 [T]        Terminate messages.
"KRN",9.2,491,1,19,0)
 [X]        Toggle transmit priority in remote message queues. (POSTMASTER only)
"KRN",9.2,491,1,20,0)
 
"KRN",9.2,491,1,21,0)
 [MORE]...
"KRN",9.2,491,2,0)
^9.22^15^15
"KRN",9.2,491,2,1,0)
D^XM-U-M-DELETE
"KRN",9.2,491,2,2,0)
F^XM-U-M-FORWARD
"KRN",9.2,491,2,3,0)
FI^XM-U-B-FILTER
"KRN",9.2,491,2,4,0)
H^XM-U-M-PRINT NO HEADER
"KRN",9.2,491,2,5,0)
L^XM-U-M-LATER
"KRN",9.2,491,2,6,0)
MORE^XM-U-BO-CLASSIC-2
"KRN",9.2,491,2,7,0)
NUMBER^XM-U-B-NAVIGATE CLASSIC
"KRN",9.2,491,2,8,0)
P^XM-U-M-PRINT
"KRN",9.2,491,2,9,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,491,2,10,0)
S^XM-U-M-SAVE
"KRN",9.2,491,2,11,0)
T^XM-U-M-TERMINATE
"KRN",9.2,491,2,12,0)
X^XM-U-B-XMIT PRIORITY TOGGLE
"KRN",9.2,491,2,13,0)
DETAILED^XM-U-B-READER DETAILED
"KRN",9.2,491,2,14,0)
SUMMARY^XM-U-B-READER SUMMARY
"KRN",9.2,491,2,15,0)
NT^XM-U-M-NEW
"KRN",9.2,491,3,0)
^9.23A^1^1
"KRN",9.2,491,3,1,0)
XMJBM
"KRN",9.2,494,-1)
0^6
"KRN",9.2,494,0)
XM-U-BO-FULL SCREEN^FULL SCREEN READER BASKET MESSAGE ACTIONS^2991213.1341^^
"KRN",9.2,494,1,0)
^^21^21^2991213^^^^
"KRN",9.2,494,1,1,0)
 
"KRN",9.2,494,1,2,0)
Enter ^ to exit, or enter one of the [PAGE] commands to see more messages,
"KRN",9.2,494,1,3,0)
or enter one of the following:
"KRN",9.2,494,1,4,0)
 
"KRN",9.2,494,1,5,0)
 n        Read message n, where n is a sequence number in this basket or
"KRN",9.2,494,1,6,0)
          an internal message ID of any message on the system.
"KRN",9.2,494,1,7,0)
 
"KRN",9.2,494,1,8,0)
The following commands act on one or more messages in this basket.
"KRN",9.2,494,1,9,0)
You can [SELECT] the messages prior to entering the command or 
"KRN",9.2,494,1,10,0)
specify a [RANGE] of messages after entering the command.
"KRN",9.2,494,1,11,0)
 [D]        Delete messages.
"KRN",9.2,494,1,12,0)
 [F]        Forward messages.
"KRN",9.2,494,1,13,0)
 [FI]       Filter messages.
"KRN",9.2,494,1,14,0)
 [L]        Later messages.
"KRN",9.2,494,1,15,0)
 [P] or [H]   Print messages with or without a header.
"KRN",9.2,494,1,16,0)
 [NT]       New Toggle messages.
"KRN",9.2,494,1,17,0)
 [S]        Save messages to another basket.
"KRN",9.2,494,1,18,0)
 [T]        Terminate messages.
"KRN",9.2,494,1,19,0)
 [X]        Toggle transmit priority in remote message queues. (POSTMASTER only)
"KRN",9.2,494,1,20,0)
 
"KRN",9.2,494,1,21,0)
 [MORE]...
"KRN",9.2,494,2,0)
^9.22^15^14
"KRN",9.2,494,2,1,0)
D^XM-U-M-DELETE
"KRN",9.2,494,2,2,0)
F^XM-U-M-FORWARD
"KRN",9.2,494,2,3,0)
FI^XM-U-B-FILTER
"KRN",9.2,494,2,4,0)
H^XM-U-M-PRINT NO HEADER
"KRN",9.2,494,2,5,0)
L^XM-U-M-LATER
"KRN",9.2,494,2,6,0)
MORE^XM-U-BO-FULL SCREEN-2
"KRN",9.2,494,2,8,0)
P^XM-U-M-PRINT
"KRN",9.2,494,2,9,0)
PAGE^XM-U-B-NAVIGATE FULL SCREEN
"KRN",9.2,494,2,10,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,494,2,11,0)
S^XM-U-M-SAVE
"KRN",9.2,494,2,12,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,494,2,13,0)
T^XM-U-M-TERMINATE
"KRN",9.2,494,2,14,0)
X^XM-U-B-XMIT PRIORITY TOGGLE
"KRN",9.2,494,2,15,0)
NT^XM-U-M-NEW
"KRN",9.2,494,3,0)
^9.23A^2^2
"KRN",9.2,494,3,1,0)
XMJMLR
"KRN",9.2,494,3,2,0)
XMJMLR1
"KRN",9.2,502,-1)
0^12
"KRN",9.2,502,0)
XM-U-BO-FULL SCREEN LIST^FULL SCREEN READER MESSAGE LIST ACTIONS^2991214.0743^^
"KRN",9.2,502,1,0)
^^20^20^2991214^^^^
"KRN",9.2,502,1,1,0)
 
"KRN",9.2,502,1,2,0)
Enter ^ to exit, or enter one of the [PAGE] commands to see more messages,
"KRN",9.2,502,1,3,0)
or enter one of the following:
"KRN",9.2,502,1,4,0)
 
"KRN",9.2,502,1,5,0)
 n        Read message n, where n is a sequence number of a message in this
"KRN",9.2,502,1,6,0)
          list, or an internal message ID of any message on the system.
"KRN",9.2,502,1,7,0)
 [CD]       Change detail. (Toggle between summary and detailed readers.)
"KRN",9.2,502,1,8,0)
 
"KRN",9.2,502,1,9,0)
The following commands act on one or more messages in this list.
"KRN",9.2,502,1,10,0)
You can [SELECT] the messages prior to entering the command or
"KRN",9.2,502,1,11,0)
specify a [RANGE] of messages after entering the command.
"KRN",9.2,502,1,12,0)
 
"KRN",9.2,502,1,13,0)
 [D]        Delete messages.
"KRN",9.2,502,1,14,0)
 [F]        Forward messages.
"KRN",9.2,502,1,15,0)
 [FI]       Filter messages.
"KRN",9.2,502,1,16,0)
 [L]        Later messages.
"KRN",9.2,502,1,17,0)
 [NT]       New Toggle messages.
"KRN",9.2,502,1,18,0)
 [P] or [H]   Print messages with or without headers.
"KRN",9.2,502,1,19,0)
 [S]        Save messages to another basket.
"KRN",9.2,502,1,20,0)
 [T]        Terminate messages.
"KRN",9.2,502,2,0)
^9.22^15^13
"KRN",9.2,502,2,3,0)
F^XM-U-M-FORWARD
"KRN",9.2,502,2,4,0)
FI^XM-U-B-FILTER
"KRN",9.2,502,2,5,0)
H^XM-U-M-PRINT NO HEADER
"KRN",9.2,502,2,6,0)
L^XM-U-M-LATER
"KRN",9.2,502,2,7,0)
P^XM-U-M-PRINT
"KRN",9.2,502,2,8,0)
PAGE^XM-U-B-NAVIGATE FULL SCREEN
"KRN",9.2,502,2,9,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,502,2,10,0)
S^XM-U-M-SAVE
"KRN",9.2,502,2,11,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,502,2,12,0)
T^XM-U-M-TERMINATE
"KRN",9.2,502,2,13,0)
CD^XM-U-B-CHANGE DETAIL
"KRN",9.2,502,2,14,0)
D^XM-U-M-DELETE
"KRN",9.2,502,2,15,0)
NT^XM-U-M-NEW
"KRN",9.2,502,3,0)
^9.23A^2^2
"KRN",9.2,502,3,1,0)
XMJMLN
"KRN",9.2,502,3,2,0)
XMJMLR1
"KRN",9.2,507,-1)
0^10
"KRN",9.2,507,0)
XM-U-MO-REPLY^REPLYING TO A MESSAGE - OPTIONS AT THE 'Transmit' PROMPT^2981229.1237^^
"KRN",9.2,507,1,0)
^^9^9^2990427^
"KRN",9.2,507,1,1,0)
 
"KRN",9.2,507,1,2,0)
Enter ^ to abort the reply or press <Enter> to transmit it, or enter any
"KRN",9.2,507,1,3,0)
of the following options before transmitting your reply:
"KRN",9.2,507,1,4,0)
 
"KRN",9.2,507,1,5,0)
 [B]       Back up and read/review the original message or any responses.
"KRN",9.2,507,1,6,0)
 [E]       Edit your reply.
"KRN",9.2,507,1,7,0)
 [I]       Include the original message or any responses in your reply.
"KRN",9.2,507,1,8,0)
 [Q]       Query recipients or network header info (Q, QD, or QN).
"KRN",9.2,507,1,9,0)
 [T]       Transmit your reply now.
"KRN",9.2,507,2,0)
^9.22^5^5
"KRN",9.2,507,2,1,0)
B^XM-U-M-BACKUP
"KRN",9.2,507,2,2,0)
E^XM-U-M-EDIT TEXT
"KRN",9.2,507,2,3,0)
I^XM-U-M-REPLY INCLUDE
"KRN",9.2,507,2,4,0)
Q^XM-U-M-QUERY
"KRN",9.2,507,2,5,0)
T^XM-U-M-TRANSMIT NOW
"KRN",9.2,507,3,0)
^9.23A^1^1
"KRN",9.2,507,3,1,0)
XMJMRO
"KRN",9.2,509,-1)
0^11
"KRN",9.2,509,0)
XM-U-MO-SEND^SENDING A MESSAGE - OPTIONS AT THE 'Transmit' PROMPT^2991213.1525^^
"KRN",9.2,509,1,0)
^^13^13^2991213^^
"KRN",9.2,509,1,1,0)
 
"KRN",9.2,509,1,2,0)
Enter ^ to abort the message or press <Enter> to transmit it, or enter any
"KRN",9.2,509,1,3,0)
of the following commands before sending it:
"KRN",9.2,509,1,4,0)
 
"KRN",9.2,509,1,5,0)
 [B]       Back up and review the message.
"KRN",9.2,509,1,6,0)
 [ER]      Edit the Recipients of the message.
"KRN",9.2,509,1,7,0)
 [ES]      Edit the Subject of the message.
"KRN",9.2,509,1,8,0)
 [ET]      Edit the Text of the message.
"KRN",9.2,509,1,9,0)
 [L]       Transmit your message later.  (You'll be asked when.)
"KRN",9.2,509,1,10,0)
 [NS]      Add your network signature to the message.
"KRN",9.2,509,1,11,0)
 [T]       Transmit your message now.
"KRN",9.2,509,1,12,0)
 
"KRN",9.2,509,1,13,0)
 [MORE]...
"KRN",9.2,509,2,0)
^9.22^17^8
"KRN",9.2,509,2,1,0)
B^XM-U-M-BACKUP BEFORE SENDING
"KRN",9.2,509,2,4,0)
ER^XM-U-M-EDIT RECIPIENTS
"KRN",9.2,509,2,5,0)
ES^XM-U-M-EDIT SUBJECT
"KRN",9.2,509,2,6,0)
ET^XM-U-M-EDIT TEXT
"KRN",9.2,509,2,8,0)
L^XM-U-M-TRANSMIT LATER
"KRN",9.2,509,2,13,0)
T^XM-U-M-TRANSMIT NOW
"KRN",9.2,509,2,16,0)
MORE^XM-U-MO-SEND-2
"KRN",9.2,509,2,17,0)
NS^XM-U-M-NETWORK SIGNATURE
"KRN",9.2,509,3,0)
^9.23A^1^1
"KRN",9.2,509,3,1,0)
XMJMSO
"KRN",9.2,514,-1)
0^7
"KRN",9.2,514,0)
XM-U-MO-EDIT^EDITING A MESSAGE^2991213.1338^^
"KRN",9.2,514,1,0)
^^17^17^2991213^^^
"KRN",9.2,514,1,1,0)
 
"KRN",9.2,514,1,2,0)
You can use the Edit action code (i.e., 'E') to edit any message created
"KRN",9.2,514,1,3,0)
by you and sent only to yourself, but not yet to other recipients.
"KRN",9.2,514,1,4,0)
Such a message is regarded as a work in progress, and still subject to change.
"KRN",9.2,514,1,5,0)
Once you send it to anyone else, or reply to it, you can no longer edit it.
"KRN",9.2,514,1,6,0)
 
"KRN",9.2,514,1,7,0)
To edit a message enter an 'E' at the 'Enter message option' prompt. You
"KRN",9.2,514,1,8,0)
can choose to edit the message as follows:
"KRN",9.2,514,1,9,0)
 
"KRN",9.2,514,1,10,0)
 [ES]        Edit the Subject of the message.
"KRN",9.2,514,1,11,0)
 [ET]        Edit the Text of the message.
"KRN",9.2,514,1,12,0)
 [NS]        Add your Network Signature to the message.
"KRN",9.2,514,1,13,0)
 
"KRN",9.2,514,1,14,0)
 [MORE]...
"KRN",9.2,514,1,15,0)
 
"KRN",9.2,514,1,16,0)
When you complete your edits, press <Enter> to return to this menu and
"KRN",9.2,514,1,17,0)
then [FORWARD] the message to the recipients.
"KRN",9.2,514,2,0)
^9.22^5^5
"KRN",9.2,514,2,1,0)
FORWARD^XM-U-M-FORWARD
"KRN",9.2,514,2,2,0)
MORE^XM-U-MO-SEND-2
"KRN",9.2,514,2,3,0)
ES^XM-U-M-EDIT SUBJECT
"KRN",9.2,514,2,4,0)
ET^XM-U-M-EDIT TEXT
"KRN",9.2,514,2,5,0)
NS^XM-U-M-NETWORK SIGNATURE
"KRN",9.2,644,-1)
0^4
"KRN",9.2,644,0)
XM-U-M-NEW-2^MAKE NEW MESSAGES NOT NEW AND VICE VERSA (CONTINUED)^2991213.1444^^
"KRN",9.2,644,1,0)
^^20^20^2991213^^^
"KRN",9.2,644,1,1,0)

"KRN",9.2,644,1,2,0)
To toggle messages from New to 'Un New' or vice versa, do the following: 
"KRN",9.2,644,1,3,0)
  
"KRN",9.2,644,1,4,0)
  * Individually - After reading a message, enter an 'N' at the 'Enter 
"KRN",9.2,644,1,5,0)
    message action' prompt.  
"KRN",9.2,644,1,6,0)
 
"KRN",9.2,644,1,7,0)
  * Group of Messages - Enter an 'NT' at the basket option or command prompt.  
"KRN",9.2,644,1,8,0)
 
"KRN",9.2,644,1,9,0)
     - MailMan will first ask you to select which messages you want to 
"KRN",9.2,644,1,10,0)
       new toggle, including a [RANGE] of messages.  Also, if you are using 
"KRN",9.2,644,1,11,0)
       a full-screen reader, you can pre-[SELECT] messages and then new 
"KRN",9.2,644,1,12,0)
       toggle them as a group.  
"KRN",9.2,644,1,13,0)
  
"KRN",9.2,644,1,14,0)
     - MailMan will then make any new messages 'not new' and vice versa.  
"KRN",9.2,644,1,15,0)
  
"KRN",9.2,644,1,16,0)
Enter an 'L' ([LATER]) at the 'Enter message action' prompt to make the 
"KRN",9.2,644,1,17,0)
message appear new at a later date and time (even later today). The message
"KRN",9.2,644,1,18,0)
will be made new at the requested time. These actions can be used when a
"KRN",9.2,644,1,19,0)
message cannot be handled immediately, or as a reminder of important
"KRN",9.2,644,1,20,0)
activities, making MailMan a personal reminder.  
"KRN",9.2,644,2,0)
^9.22^3^3
"KRN",9.2,644,2,1,0)
LATER^XM-U-M-LATER
"KRN",9.2,644,2,2,0)
RANGE^XM-U-M-CHOOSE RANGE
"KRN",9.2,644,2,3,0)
SELECT^XM-U-M-CHOOSE SELECT
"KRN",9.2,645,-1)
0^1
"KRN",9.2,645,0)
XM-U-M-NETWORK SIGNATURE^ADD YOUR NETWORK SIGNATURE TO A MESSAGE^2991213.152^^
"KRN",9.2,645,1,0)
^^12^12^2991213^^
"KRN",9.2,645,1,1,0)
 
"KRN",9.2,645,1,2,0)
You can use the Add Network Signature action code (i.e., 'NS') to add
"KRN",9.2,645,1,3,0)
your network signature to the end of your message.
"KRN",9.2,645,1,4,0)
 
"KRN",9.2,645,1,5,0)
You can create a [NETWORK SIGNATURE] using the User Options Edit option
"KRN",9.2,645,1,6,0)
of the Personal Preferences menu.
"KRN",9.2,645,1,7,0)
 
"KRN",9.2,645,1,8,0)
To add your network signature to a message, enter 'NS' at the 'Select
"KRN",9.2,645,1,9,0)
Message option:  Transmit now//' prompt.
"KRN",9.2,645,1,10,0)
 
"KRN",9.2,645,1,11,0)
Be careful.  This is not a toggle.  MailMan will add your network signature
"KRN",9.2,645,1,12,0)
to the message every time you invoke the NS command.
"KRN",9.2,645,2,0)
^9.22^1^1
"KRN",9.2,645,2,1,0)
NETWORK SIGNATURE^XM-U-P-NETWORK SIGNATURE
"KRN",9.2,646,-1)
0^2
"KRN",9.2,646,0)
XM-U-M-REPLY INCLUDE^INCLUDE PREVIOUS RESPONSES IN YOUR REPLY^2991213.1546^^
"KRN",9.2,646,1,0)
^^14^14^2991213^^
"KRN",9.2,646,1,1,0)
 
"KRN",9.2,646,1,2,0)
Entering an 'I' at the 'Select Message option:  Transmit now//' prompt
"KRN",9.2,646,1,3,0)
enables you to add previous responses to your reply.  You can then go back
"KRN",9.2,646,1,4,0)
and edit your reply to comment on those responses you just added.
"KRN",9.2,646,1,5,0)
 
"KRN",9.2,646,1,6,0)
(The usual method for commenting on previous responses is to enter 'RI'
"KRN",9.2,646,1,7,0)
at the 'Enter message action' prompt to tell MailMan that you want to reply
"KRN",9.2,646,1,8,0)
and include previous responses.  The 'I' command is for those times when
"KRN",9.2,646,1,9,0)
you forgot to include responses before you composed your reply, and need
"KRN",9.2,646,1,10,0)
to do it afterwards.)
"KRN",9.2,646,1,11,0)
 
"KRN",9.2,646,1,12,0)
If you enter 'I', you will be able to include the original message 
"KRN",9.2,646,1,13,0)
and/or any [COMBINATION] of responses in your reply. (With this feature, 
"KRN",9.2,646,1,14,0)
you can more easily respond to what someone wrote, point by point.) 
"KRN",9.2,646,2,0)
^9.22^1^1
"KRN",9.2,646,2,1,0)
COMBINATION^XM-U-M-CHOOSE RESPONSES
"KRN",19,459,-1)
0^1
"KRN",19,459,0)
XMEDITMG^Mail group edit^^E^^^XM-U-I-GROUP^^^^^MAILMAN^^1^1
"KRN",19,459,1,0)
^19.06^2^2^2970723^^^^
"KRN",19,459,1,1,0)
This option is used to edit the mail group file, which controls the
"KRN",19,459,1,2,0)
distribution of messages to groups of users.
"KRN",19,459,15)
K XMIA
"KRN",19,459,20)
S XMIA=1
"KRN",19,459,30)
3.8
"KRN",19,459,31)
AEQMZL
"KRN",19,459,34)
S %=$S($D(XMDUZ):XMDUZ,1:DUZ) I $S('$P(^(0),U,6):1,'$D(^(3)):1,$P(^(3),U)=%:1,1:0)
"KRN",19,459,50)
3.8
"KRN",19,459,51)
0:7.9;10.1:99
"KRN",19,459,99)
55595,47667
"KRN",19,459,"U")
MAIL GROUP EDIT
"MBREQ")
0
"ORD",1,9.2)
9.2;1;;;HELP^XPDTA1;HLPF1^XPDIA1;HLPE1^XPDIA1;HLPF2^XPDIA1;;HLPDEL^XPDIA1
"ORD",1,9.2,0)
HELP FRAME
"ORD",9,.84)
.84;9;;;EDEOUT^DIFROMSO(.84,DA,"",XPDA);FPRE^DIFROMSI(.84,"",XPDA);EPRE^DIFROMSI(.84,DA,"",XPDA,"",OLDA);;EPOST^DIFROMSI(.84,DA,"",XPDA);DEL^DIFROMSK(.84,"",%)
"ORD",9,.84,0)
DIALOG
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",8,-1)
1^1
"PKG",8,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",8,20,0)
^9.402P^^
"PKG",8,22,0)
^9.49I^1^1
"PKG",8,22,1,0)
7.1^2940602^2951128
"PKG",8,22,1,"PAH",1,0)
110^3000310
"PKG",8,22,1,"PAH",1,1,0)
^^153^153^3000310
"PKG",8,22,1,"PAH",1,1,1,0)
Patch XM*7.1*110
"PKG",8,22,1,"PAH",1,1,2,0)
 
"PKG",8,22,1,"PAH",1,1,3,0)
NOIS:  ALN-1199-12259
"PKG",8,22,1,"PAH",1,1,4,0)
Test Site:  Albany, NY
"PKG",8,22,1,"PAH",1,1,5,0)
When you save a new message to a different basket, it updates the last message
"PKG",8,22,1,"PAH",1,1,6,0)
arrival date, and MailMan may tell you that a new message arrived, when it
"PKG",8,22,1,"PAH",1,1,7,0)
really didn't.  This patch fixes that.
"PKG",8,22,1,"PAH",1,1,8,0)
 
"PKG",8,22,1,"PAH",1,1,9,0)
NOIS:  DAY-0899-41718
"PKG",8,22,1,"PAH",1,1,10,0)
Test Site:  Dayton, OH
"PKG",8,22,1,"PAH",1,1,11,0)
Don't display user's DUZ when displaying a list of latered messages from which
"PKG",8,22,1,"PAH",1,1,12,0)
to choose.
"PKG",8,22,1,"PAH",1,1,13,0)
 
"PKG",8,22,1,"PAH",1,1,14,0)
NOIS:  ISD-0200-71796
"PKG",8,22,1,"PAH",1,1,15,0)
Test Site:  CIOFO-Dallas
"PKG",8,22,1,"PAH",1,1,16,0)
If you copy a PackMan or KIDS message and send it "priority", MailMan might
"PKG",8,22,1,"PAH",1,1,17,0)
not recognize the copy as a PackMan or KIDS message.  This patch fixes that.
"PKG",8,22,1,"PAH",1,1,18,0)
 
"PKG",8,22,1,"PAH",1,1,19,0)
NOIS:  TAM-0200-32595
"PKG",8,22,1,"PAH",1,1,20,0)
Test Site:  Tampa, FL
"PKG",8,22,1,"PAH",1,1,21,0)
The bulletin APIs SENDBULL^XMXAPI and TASKBULL^XMXAPI are changed so that
"PKG",8,22,1,"PAH",1,1,22,0)
they don't insist on having XMBODY, which is an optional parameter.
"PKG",8,22,1,"PAH",1,1,23,0)
 
"PKG",8,22,1,"PAH",1,1,24,0)
NOIS:  WAS-1299-20453
"PKG",8,22,1,"PAH",1,1,25,0)
Test Site:  Washington, DC
"PKG",8,22,1,"PAH",1,1,26,0)
If a scrambled message with no hint is sent to a remote site, MailMan does
"PKG",8,22,1,"PAH",1,1,27,0)
not recognize that it is scrambled.  This patch fixes that.
"PKG",8,22,1,"PAH",1,1,28,0)
 
"PKG",8,22,1,"PAH",1,1,29,0)
NOIS:  WBP-0100-21166
"PKG",8,22,1,"PAH",1,1,30,0)
Test Site:  Wilkes Barre, PA
"PKG",8,22,1,"PAH",1,1,31,0)
If you queue a range of messages to print later, and then delete the messages
"PKG",8,22,1,"PAH",1,1,32,0)
you queued, MailMan won't print them.  This patch fixes that.
"PKG",8,22,1,"PAH",1,1,33,0)
 
"PKG",8,22,1,"PAH",1,1,34,0)
E3R 12092, 13084 - Provide "new toggle" command to make messages new if
"PKG",8,22,1,"PAH",1,1,35,0)
they're not new, and make them not new if they're new.  The command is "NT".
"PKG",8,22,1,"PAH",1,1,36,0)
Help frames have been updated to include the new command, and a new help
"PKG",8,22,1,"PAH",1,1,37,0)
frame, XM-U-M-NEW-2, explains it.  New API: NTOGLMSG^XMXAPI
"PKG",8,22,1,"PAH",1,1,38,0)
 
"PKG",8,22,1,"PAH",1,1,39,0)
E3R 12169 - Provide a command to add the user's network signature to an
"PKG",8,22,1,"PAH",1,1,40,0)
original message.  The command is "NS", and is available at the transmit
"PKG",8,22,1,"PAH",1,1,41,0)
prompt when sending a new message.  It is also available when editing a
"PKG",8,22,1,"PAH",1,1,42,0)
message sent only to oneself.  Help frames have been updated to include the
"PKG",8,22,1,"PAH",1,1,43,0)
new command, and a new help frame, XM-U-M-NETWORK SIGNATURE, explains it.
"PKG",8,22,1,"PAH",1,1,44,0)
New API: NETSIG^XMXEDIT
"PKG",8,22,1,"PAH",1,1,45,0)
 
"PKG",8,22,1,"PAH",1,1,46,0)
E3R 13400 - Upon return from ANSWER, COPY, or WRITE command, redisplay
"PKG",8,22,1,"PAH",1,1,47,0)
message header to make it clear that you are back at original message. 
"PKG",8,22,1,"PAH",1,1,48,0)
 
"PKG",8,22,1,"PAH",1,1,49,0)
Additional enhancements:
"PKG",8,22,1,"PAH",1,1,50,0)
- When editing a message the user has sent only to himself, the user may now
"PKG",8,22,1,"PAH",1,1,51,0)
scramble or unscramble the message, and add his network signature to the
"PKG",8,22,1,"PAH",1,1,52,0)
message, too.
"PKG",8,22,1,"PAH",1,1,53,0)
- When answering a message, if the user doesn't have a network signature,
"PKG",8,22,1,"PAH",1,1,54,0)
MailMan now asks the user if he would like to create one.
"PKG",8,22,1,"PAH",1,1,55,0)
- Added entry and exit action to option XMEDITMG so that MailMan knows that
"PKG",8,22,1,"PAH",1,1,56,0)
a user is interactively editing a mail group.
"PKG",8,22,1,"PAH",1,1,57,0)
 
"PKG",8,22,1,"PAH",1,1,58,0)
NOTE: This patch should be installed after hours, when user activity is at a
"PKG",8,22,1,"PAH",1,1,59,0)
minimum.  It requires FileMan patch DI*22.0*17 and MailMan patches XM*7.1*72,
"PKG",8,22,1,"PAH",1,1,60,0)
XM*7.1*79, XM*7.1*95, XM*7.1*100, XM*7.1*101, and XM*7.1*121.
"PKG",8,22,1,"PAH",1,1,61,0)
============================================================================ 
"PKG",8,22,1,"PAH",1,1,62,0)
 
"PKG",8,22,1,"PAH",1,1,63,0)
ROUTINES:
"PKG",8,22,1,"PAH",1,1,64,0)
The second line of the routine now looks like:
"PKG",8,22,1,"PAH",1,1,65,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",8,22,1,"PAH",1,1,66,0)
 
"PKG",8,22,1,"PAH",1,1,67,0)
              Before          After
"PKG",8,22,1,"PAH",1,1,68,0)
Name          Checksum        Checksum        Patch List
"PKG",8,22,1,"PAH",1,1,69,0)
--------------------------------------------------------------
"PKG",8,22,1,"PAH",1,1,70,0)
XMA0            585506          305822        15,36,50,107,110
"PKG",8,22,1,"PAH",1,1,71,0)
XMA2R          3921855         3986868        27,50,105,107,110
"PKG",8,22,1,"PAH",1,1,72,0)
XMJBM         12165199        10706426        50,110
"PKG",8,22,1,"PAH",1,1,73,0)
XMJDIR         2003843         5974273        50,110
"PKG",8,22,1,"PAH",1,1,74,0)
XMJMA          2991838         3663986        50,110
"PKG",8,22,1,"PAH",1,1,75,0)
XMJMC          8264139         9725999        50,79,110
"PKG",8,22,1,"PAH",1,1,76,0)
XMJMCODE      11042686        11817911        50,110
"PKG",8,22,1,"PAH",1,1,77,0)
XMJMD          7370688         9220624        50,104,110
"PKG",8,22,1,"PAH",1,1,78,0)
XMJMFA         6204287         6600695        50,110
"PKG",8,22,1,"PAH",1,1,79,0)
XMJMFB        15137131        15590623        50,110
"PKG",8,22,1,"PAH",1,1,80,0)
XMJMLN        13240819        13840736        50,110
"PKG",8,22,1,"PAH",1,1,81,0)
XMJMLR        13545823        14100278        50,110
"PKG",8,22,1,"PAH",1,1,82,0)
XMJMLR1        7836320         6891665        50,72,110
"PKG",8,22,1,"PAH",1,1,83,0)
XMJMOI        17103064        16677374        50,87,89,110
"PKG",8,22,1,"PAH",1,1,84,0)
XMJMOI1        * NEW *         3117776        110
"PKG",8,22,1,"PAH",1,1,85,0)
XMJMOIE        4582157         2143008        50,110
"PKG",8,22,1,"PAH",1,1,86,0)
XMJMOR        14209869        13211462        50,75,110
"PKG",8,22,1,"PAH",1,1,87,0)
XMJMORX       14790879        14207041        50,110
"PKG",8,22,1,"PAH",1,1,88,0)
XMJMORX1       2472219         2575833        50,110
"PKG",8,22,1,"PAH",1,1,89,0)
XMJMP         16560016        13553026        50,75,100,110
"PKG",8,22,1,"PAH",1,1,90,0)
XMJMP1        14502445        16386050        40,50,75,110
"PKG",8,22,1,"PAH",1,1,91,0)
XMJMP2         * NEW *         2711990        110
"PKG",8,22,1,"PAH",1,1,92,0)
XMJMQ         16042167        15891582        40,57,70,50,96,110
"PKG",8,22,1,"PAH",1,1,93,0)
XMJMQ1         3608941         7395902        40,50,110
"PKG",8,22,1,"PAH",1,1,94,0)
XMJMRO         2478663         4304954        50,89,110
"PKG",8,22,1,"PAH",1,1,95,0)
XMJMSO        12952439         7280605        50,110
"PKG",8,22,1,"PAH",1,1,96,0)
XMTDO          2076731         1653155        50,107,121,110
"PKG",8,22,1,"PAH",1,1,97,0)
XMVVITA        4257402         4785601        50,101,110
"PKG",8,22,1,"PAH",1,1,98,0)
XMXANSER       2242310         1893573        50,110
"PKG",8,22,1,"PAH",1,1,99,0)
XMXAPI         6705900         6992361        50,110
"PKG",8,22,1,"PAH",1,1,100,0)
XMXEDIT        3880586         7247978        50,110
"PKG",8,22,1,"PAH",1,1,101,0)
XMXMSGS       10966038         9819629        50,110
"PKG",8,22,1,"PAH",1,1,102,0)
XMXMSGS2       6491081         7686410        50,106,110
"PKG",8,22,1,"PAH",1,1,103,0)
XMXSEC        18599731        21173851        50,110
"PKG",8,22,1,"PAH",1,1,104,0)
XMXSEC1       13791136        11938650        50,95,110
"PKG",8,22,1,"PAH",1,1,105,0)
XMXSEC2       21310509        27323685        50,89,95,110
"PKG",8,22,1,"PAH",1,1,106,0)
XMXSEC3        * NEW *         4290614        110
"PKG",8,22,1,"PAH",1,1,107,0)
 
"PKG",8,22,1,"PAH",1,1,108,0)
* Checksums produced by CHECK^XTSUMBLD
"PKG",8,22,1,"PAH",1,1,109,0)
 
"PKG",8,22,1,"PAH",1,1,110,0)
This patch introduces the following new routines:
"PKG",8,22,1,"PAH",1,1,111,0)
 
"PKG",8,22,1,"PAH",1,1,112,0)
Routine      Callable at     Description
"PKG",8,22,1,"PAH",1,1,113,0)
---------------------------------------------------------------------------
"PKG",8,22,1,"PAH",1,1,114,0)
XMJMOI1      N/A
"PKG",8,22,1,"PAH",1,1,115,0)
XMJMP2       N/A
"PKG",8,22,1,"PAH",1,1,116,0)
XMXSEC3      N/A
"PKG",8,22,1,"PAH",1,1,117,0)
===========================================================================
"PKG",8,22,1,"PAH",1,1,118,0)
 
"PKG",8,22,1,"PAH",1,1,119,0)
INSTALLATION:
"PKG",8,22,1,"PAH",1,1,120,0)
NOTE: This patch should be installed after hours, when user activity is at a
"PKG",8,22,1,"PAH",1,1,121,0)
minimum.  It requires FileMan patch DI*22.0*17 and MailMan patches XM*7.1*72,
"PKG",8,22,1,"PAH",1,1,122,0)
XM*7.1*79, XM*7.1*95, XM*7.1*100, XM*7.1*101, and XM*7.1*121.
"PKG",8,22,1,"PAH",1,1,123,0)
1.  Users may be on the system during patch installation.
"PKG",8,22,1,"PAH",1,1,124,0)
2.  DSM Sites: If any of these routines is mapped, disable mapping for the 
"PKG",8,22,1,"PAH",1,1,125,0)
    affected routine(s).  
"PKG",8,22,1,"PAH",1,1,126,0)
3.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads 
"PKG",8,22,1,"PAH",1,1,127,0)
    the patch into a Transport Global on your system.  
"PKG",8,22,1,"PAH",1,1,128,0)
4.  You do not need to stop TaskMan or the background filer.  Users may be
"PKG",8,22,1,"PAH",1,1,129,0)
    on the system.
"PKG",8,22,1,"PAH",1,1,130,0)
5.  On the KIDS:Installation menu, use the following options to install the
"PKG",8,22,1,"PAH",1,1,131,0)
    Transport Global:
"PKG",8,22,1,"PAH",1,1,132,0)
       Verify Checksums in Transport Global
"PKG",8,22,1,"PAH",1,1,133,0)
       Print Transport Global
"PKG",8,22,1,"PAH",1,1,134,0)
       Compare Transport Global to Current System
"PKG",8,22,1,"PAH",1,1,135,0)
       Backup a Transport Global
"PKG",8,22,1,"PAH",1,1,136,0)
       Install Package(s)
"PKG",8,22,1,"PAH",1,1,137,0)
 Select INSTALL NAME:    XM*7.1*110    Loaded from Distribution  <date/time>
"PKG",8,22,1,"PAH",1,1,138,0)
                         ==========
"PKG",8,22,1,"PAH",1,1,139,0)
 Install Questions:
"PKG",8,22,1,"PAH",1,1,140,0)
 Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// YES
"PKG",8,22,1,"PAH",1,1,141,0)
                                                                   ===
"PKG",8,22,1,"PAH",1,1,142,0)
 Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",8,22,1,"PAH",1,1,143,0)
                                                       ==
"PKG",8,22,1,"PAH",1,1,144,0)
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",8,22,1,"PAH",1,1,145,0)
                                                                       ==
"PKG",8,22,1,"PAH",1,1,146,0)
 Enter the Device you want to print the Install messages.
"PKG",8,22,1,"PAH",1,1,147,0)
 You can queue the install by enter a 'Q' at the device prompt.
"PKG",8,22,1,"PAH",1,1,148,0)
 Enter a '^' to abort the install.
"PKG",8,22,1,"PAH",1,1,149,0)
 
"PKG",8,22,1,"PAH",1,1,150,0)
 DEVICE: HOME// <It's up to you.  You may queue it if you wish.>
"PKG",8,22,1,"PAH",1,1,151,0)
                ------------------------------------------------
"PKG",8,22,1,"PAH",1,1,152,0)
6.  DSM Sites: After patch has installed, rebuild your map set, if necessary.
"PKG",8,22,1,"PAH",1,1,153,0)
===========================================================================
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
37
"RTN","XMA0")
0^36^B975726
"RTN","XMA0",1,0)
XMA0 ;(WASH ISC)/CAP/THM-Print Message ;01/20/2000  06:56
"RTN","XMA0",2,0)
 ;;7.1;MailMan;**15,36,50,107,110**;Jun 02, 1994
"RTN","XMA0",3,0)
 ; Entry points (DBIA 1230):
"RTN","XMA0",4,0)
 ; ENTPRT  Print a message (interactive)
"RTN","XMA0",5,0)
 ; HDR     Print a message (headerless)
"RTN","XMA0",6,0)
 ; PR2     Print a message
"RTN","XMA0",7,0)
 ;
"RTN","XMA0",8,0)
ENTPRT ; Print a message (interactive)
"RTN","XMA0",9,0)
 ; Needs:
"RTN","XMA0",10,0)
 ; DUZ
"RTN","XMA0",11,0)
 ; XMZ  Message number
"RTN","XMA0",12,0)
 ; XMK  Basket number
"RTN","XMA0",13,0)
 N XMV
"RTN","XMA0",14,0)
 D INITAPI^XMVVITAE
"RTN","XMA0",15,0)
 D PRINT^XMJMP(XMDUZ,XMK,XMZ)
"RTN","XMA0",16,0)
 Q
"RTN","XMA0",17,0)
HDR ; Print a message (headerless)
"RTN","XMA0",18,0)
 ; Needs:
"RTN","XMA0",19,0)
 ; DUZ
"RTN","XMA0",20,0)
 ; XMK    basket number
"RTN","XMA0",21,0)
 ; XMZ    message number
"RTN","XMA0",22,0)
 ; IO     output device
"RTN","XMA0",23,0)
 ; Optional:
"RTN","XMA0",24,0)
 ; XMDUZ
"RTN","XMA0",25,0)
 ; $P(XMTYPE,";",6) response from which to start printing
"RTN","XMA0",26,0)
 D PRINTIT(0,$G(XMTYPE))
"RTN","XMA0",27,0)
 Q
"RTN","XMA0",28,0)
PR2 ; Print a message
"RTN","XMA0",29,0)
 ; Needs:
"RTN","XMA0",30,0)
 ; DUZ
"RTN","XMA0",31,0)
 ; XMK    basket number
"RTN","XMA0",32,0)
 ; XMZ    message number
"RTN","XMA0",33,0)
 ; IO     output device
"RTN","XMA0",34,0)
 ; Optional:
"RTN","XMA0",35,0)
 ; XMDUZ
"RTN","XMA0",36,0)
 ; $P(XMTYPE,";",6) response from which to start printing
"RTN","XMA0",37,0)
 D PRINTIT(1,$G(XMTYPE))
"RTN","XMA0",38,0)
 Q
"RTN","XMA0",39,0)
PRINTIT(XMPRTHDR,XMTYPE) ;
"RTN","XMA0",40,0)
 N XMV,XMWHICH
"RTN","XMA0",41,0)
 Q:XMTYPE=U
"RTN","XMA0",42,0)
 D INITAPI^XMVVITAE
"RTN","XMA0",43,0)
 S XMWHICH=+$P(XMTYPE,";",6)_"-"  ; print from
"RTN","XMA0",44,0)
 D PRTMSG^XMJMP(XMDUZ,XMK,XMZ,XMWHICH,0,XMPRTHDR)
"RTN","XMA0",45,0)
 Q
"RTN","XMA2R")
0^34^B13830156
"RTN","XMA2R",1,0)
XMA2R ;(WASH ISC)/CAP- Reply/Answer API ;01/07/2000  14:11
"RTN","XMA2R",2,0)
 ;;7.1;MailMan;**27,50,105,107,110**;Jun 02, 1994
"RTN","XMA2R",3,0)
 ; Entry points (DBIA 1145):
"RTN","XMA2R",4,0)
 ; ENT  function for non-interactive reply to a message.
"RTN","XMA2R",5,0)
 ;      Reply is sent to all local recipients of the message.
"RTN","XMA2R",6,0)
 ;      If message if from a remote sender, the reply is sent to
"RTN","XMA2R",7,0)
 ;      the remote sender, too.
"RTN","XMA2R",8,0)
 ; ENTA function for non-interactive answer to a message
"RTN","XMA2R",9,0)
 ;
"RTN","XMA2R",10,0)
ENT(XMZ,XMSUBJ,XMTEXT,XMSTRIP,XMDUZ,XMNET) ; Send response to a message
"RTN","XMA2R",11,0)
 ;Call as follows:
"RTN","XMA2R",12,0)
 ; S var=$$ENT^XMA2R(XMZ,XMSUBJ,.XMTEXT,XMSTRIP,XMDUZ,XMNET)
"RTN","XMA2R",13,0)
 ;Where:  XMZ     = Message being responded to
"RTN","XMA2R",14,0)
 ;        XMSUBJ  = Subject of the response
"RTN","XMA2R",15,0)
 ;                  (ignored, unless message is from a remote sender)
"RTN","XMA2R",16,0)
 ;        .XMTEXT = Array containing text
"RTN","XMA2R",17,0)
 ;        XMSTRIP = Characters to be stripped from text
"RTN","XMA2R",18,0)
 ;        XMDUZ   = Sender of response (DUZ or free text)
"RTN","XMA2R",19,0)
 ;        XMNET   = Send reply over the net? (0=no (DEFAULT); 1=yes)
"RTN","XMA2R",20,0)
 ;                  (ignored, unless message is from a remote sender)
"RTN","XMA2R",21,0)
 ;
"RTN","XMA2R",22,0)
 ;OUTPUT: If results okay = internal pointer to response in file 3.9
"RTN","XMA2R",23,0)
 ;        If bad result, the letter "E" followed by a number,
"RTN","XMA2R",24,0)
 ;        followed by a space, then a human readable explanation.
"RTN","XMA2R",25,0)
 N XMV,XMZR,XMINSTR,XMMG,XMSECURE,XMZREC
"RTN","XMA2R",26,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA2R",27,0)
 I '$D(^XMB(3.9,XMZ,0)) Q "E5 Message "_XMZ_" does not exist."
"RTN","XMA2R",28,0)
 I '$O(^XMB(3.9,XMZ,1,0)) Q "E6 Message "_XMZ_" has no recipients."
"RTN","XMA2R",29,0)
 I $D(XMTEXT)<9 Q "E2 No message text !"
"RTN","XMA2R",30,0)
 I '$O(XMTEXT(0)) Q "E4 No message text !"
"RTN","XMA2R",31,0)
 S XMDUZ=$G(XMDUZ,DUZ)
"RTN","XMA2R",32,0)
 I XMDUZ'?.N D  Q:$D(XMMG) "E10 "_$P(XMMG,"= ",2)
"RTN","XMA2R",33,0)
 . D SETFROM^XMD(.XMDUZ,.XMINSTR)
"RTN","XMA2R",34,0)
 D INITAPI^XMVVITAE
"RTN","XMA2R",35,0)
 D CRE8XMZ^XMXSEND("R"_XMZ,.XMZR) Q:XMZR<1 $$ERR("E9")
"RTN","XMA2R",36,0)
 D MOVETEXT(XMZR,.XMTEXT)
"RTN","XMA2R",37,0)
 D CHEKBODY^XMXSEND(XMZR,$G(XMSTRIP))
"RTN","XMA2R",38,0)
 D DOREPLY^XMXREPLY(XMDUZ,XMZ,XMZR,.XMINSTR)
"RTN","XMA2R",39,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMA2R",40,0)
 I $P(XMZREC,U,2)'["@"!'$G(XMNET) Q XMZR
"RTN","XMA2R",41,0)
 I '$D(XMSUBJ) Q "E1 No subject !"
"RTN","XMA2R",42,0)
 I $L(XMSUBJ)<3!($L(XMSUBJ)>65) Q "E3 Subject too long or short !"
"RTN","XMA2R",43,0)
 S XMSUBJ=$$SCRUB^XMXUTIL1(XMSUBJ)
"RTN","XMA2R",44,0)
 S:XMSUBJ[U XMSUBJ=$$ENCODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMA2R",45,0)
 N XMFROM,XMREPLTO
"RTN","XMA2R",46,0)
 D REPLYTO^XMXREPLY(XMZ,.XMFROM,.XMREPLTO)
"RTN","XMA2R",47,0)
 D INIT^XMXADDR
"RTN","XMA2R",48,0)
 D CHKADDR^XMXADDR(XMDUZ,$$REMADDR^XMXADDR3($G(XMREPLTO,XMFROM)),.XMINSTR) Q:$D(XMERR) $$ERR("E12")
"RTN","XMA2R",49,0)
 D NETREPLY^XMXREPLY(XMDUZ,XMZ,XMZR,XMSUBJ,.XMINSTR)
"RTN","XMA2R",50,0)
 D CLEANUP^XMXADDR
"RTN","XMA2R",51,0)
 Q XMZR
"RTN","XMA2R",52,0)
MOVETEXT(XMZ,XMTEXT,XMAPPEND) ;
"RTN","XMA2R",53,0)
 N I,XMLINE
"RTN","XMA2R",54,0)
 S XMLINE=$S($G(XMAPPEND):$O(^XMB(3.9,XMZ,2,":"),-1),1:0)
"RTN","XMA2R",55,0)
 S I=0
"RTN","XMA2R",56,0)
 F  S I=$O(XMTEXT(I)) Q:'I  D
"RTN","XMA2R",57,0)
 . S XMLINE=XMLINE+1
"RTN","XMA2R",58,0)
 . S ^XMB(3.9,XMZ,2,XMLINE,0)=$S($D(XMTEXT(I,0)):XMTEXT(I,0),1:XMTEXT(I))
"RTN","XMA2R",59,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMLINE_U_XMLINE
"RTN","XMA2R",60,0)
 Q
"RTN","XMA2R",61,0)
ENTA(XMZ,XMSUBJ,XMTEXT,XMSTRIP,XMDUZ) ; Send Response Only to Sender of Original Message
"RTN","XMA2R",62,0)
 ;Call as follows:
"RTN","XMA2R",63,0)
 ; S var=$$ENT^XMA2R(XMZ,XMSUBJ,.XMTEXT,XMSTRIP,XMDUZ)
"RTN","XMA2R",64,0)
 ;Where:  XMZ     = Message being responded to
"RTN","XMA2R",65,0)
 ;        XMSUBJ  = Subject of the response
"RTN","XMA2R",66,0)
 ;        .XMTEXT = Array containing text
"RTN","XMA2R",67,0)
 ;        XMSTRIP = Characters to be stripped from text
"RTN","XMA2R",68,0)
 ;        XMDUZ   = Sender of response (DUZ or free text)
"RTN","XMA2R",69,0)
 ;
"RTN","XMA2R",70,0)
 ;OUTPUT: If results okay = internal pointer to response in file 3.9
"RTN","XMA2R",71,0)
 ;        If bad result, the letter "E" followed by a number,
"RTN","XMA2R",72,0)
 ;        followed by a space, then a human readable explanation.
"RTN","XMA2R",73,0)
 N XMV,XMZR,XMINSTR,XMMG,XMSECURE,XMZSENDR,XMZREC,XMTO
"RTN","XMA2R",74,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA2R",75,0)
 I '$D(^XMB(3.9,XMZ,0)) Q "E5 Message "_XMZ_" does not exist."
"RTN","XMA2R",76,0)
 I '$D(XMSUBJ) Q "E1 No subject !"
"RTN","XMA2R",77,0)
 I $D(XMTEXT)<9 Q "E2 No message text !"
"RTN","XMA2R",78,0)
 I $L(XMSUBJ)<3!($L(XMSUBJ)>65) Q "E3 Subject too long or short !"
"RTN","XMA2R",79,0)
 I '$O(XMTEXT(0)) Q "E4 No message text !"
"RTN","XMA2R",80,0)
 S XMDUZ=$G(XMDUZ,DUZ)
"RTN","XMA2R",81,0)
 I XMDUZ'?.N D  Q:$D(XMMG) "E10 "_$P(XMMG,"= ",2)
"RTN","XMA2R",82,0)
 . D SETFROM^XMD(.XMDUZ,.XMINSTR)
"RTN","XMA2R",83,0)
 D INITAPI^XMVVITAE
"RTN","XMA2R",84,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMA2R",85,0)
 S XMZSENDR=$P(XMZREC,U,2)
"RTN","XMA2R",86,0)
 S:XMZSENDR["@" XMZSENDR=$$REPLYTO1^XMXREPLY(XMZ)
"RTN","XMA2R",87,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZR) Q:XMZR<1 $$ERR("E9")
"RTN","XMA2R",88,0)
 D COPY^XMXANSER(XMZ,$P(XMZREC,U,1),XMZSENDR,$P(XMZREC,U,3),XMZR)
"RTN","XMA2R",89,0)
 D MOVETEXT(XMZR,.XMTEXT,1)
"RTN","XMA2R",90,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZR)
"RTN","XMA2R",91,0)
 D CHEKBODY^XMXSEND(XMZR,$G(XMSTRIP))
"RTN","XMA2R",92,0)
 S XMTO(XMZSENDR)=""
"RTN","XMA2R",93,0)
 S XMTO(XMDUZ)=""
"RTN","XMA2R",94,0)
 S XMINSTR("ADDR FLAGS")="R"  ; No addressing restrictions
"RTN","XMA2R",95,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZR,.XMTO,.XMINSTR)
"RTN","XMA2R",96,0)
 Q:$D(XMERR) $$ERR("E11")
"RTN","XMA2R",97,0)
 Q XMZR
"RTN","XMA2R",98,0)
ERR(XMER) ;
"RTN","XMA2R",99,0)
 S XMER=XMER_" "_^TMP("XMERR",$J,1,"TEXT",1)
"RTN","XMA2R",100,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMA2R",101,0)
 Q XMER
"RTN","XMJBM")
0^6^B49597406
"RTN","XMJBM",1,0)
XMJBM ;ISC-SF/GMB-Manage Mail in Mailbox ;01/21/2000  10:45
"RTN","XMJBM",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJBM",3,0)
 ; Replaces ^XMA0,^XMA01 (ISC-WASH/CAP/THM)
"RTN","XMJBM",4,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJBM",5,0)
 ; MANAGE   XMREAD
"RTN","XMJBM",6,0)
MANAGE ; Manage existing mail in your Mailbox
"RTN","XMJBM",7,0)
 N XMABORT,XMK,XMKN,XMRDR
"RTN","XMJBM",8,0)
 S XMABORT=0
"RTN","XMJBM",9,0)
 D INIT^XMJBM1(.XMDUZ,.XMRDR,.XMABORT) Q:XMABORT
"RTN","XMJBM",10,0)
 F  D ASKBSKT^XMJBM1(XMDUZ,XMRDR,.XMK,.XMKN,.XMABORT) Q:XMABORT  D  Q:XMABORT
"RTN","XMJBM",11,0)
 . D:XMRDR="C" CLASSIC(XMDUZ,XMK,XMKN,.XMABORT) ; Classic Reader
"RTN","XMJBM",12,0)
 . D:XMRDR="D" LIST^XMJMLR(XMDUZ,XMK,.XMKN,1,.XMABORT) ; Full Screen Detail
"RTN","XMJBM",13,0)
 . D:XMRDR="S" LIST^XMJMLR(XMDUZ,XMK,.XMKN,0,.XMABORT) ; Full Screen Summary
"RTN","XMJBM",14,0)
 . I XMABORT,XMDUZ=.6 S XMABORT=0
"RTN","XMJBM",15,0)
 . I '$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",0)) D NOMSGS^XMJBM1(XMDUZ,XMK,XMKN)
"RTN","XMJBM",16,0)
 Q
"RTN","XMJBM",17,0)
CLASSIC(XMDUZ,XMK,XMKN,XMABORT) ; Read Message
"RTN","XMJBM",18,0)
 N XMFIRST,XMLAST,XMZ,XMNEXT,XMKZ,XMORDER,XMPARM
"RTN","XMJBM",19,0)
 I XMDUZ=.5,XMK>999 S XMORDER=XMV("ORDER"),XMV("ORDER")=1
"RTN","XMJBM",20,0)
 S XMKZ=""
"RTN","XMJBM",21,0)
 F  D  Q:XMABORT
"RTN","XMJBM",22,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:'XMKZ  Q:XMDUZ=DUZ  Q:'$$SURRCONF^XMXSEC(XMDUZ,$O(^(XMKZ,"")))
"RTN","XMJBM",23,0)
 . I XMKZ="" D  Q:XMABORT
"RTN","XMJBM",24,0)
 . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:'XMKZ  Q:XMDUZ=DUZ  Q:'$$SURRCONF^XMXSEC(XMDUZ,$O(^(XMKZ,"")))
"RTN","XMJBM",25,0)
 . . I XMKZ="" S XMABORT=1 Q
"RTN","XMJBM",26,0)
 . . D AGAIN^XMJMLR(.XMABORT)
"RTN","XMJBM",27,0)
 . S XMFIRST=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJBM",28,0)
 . S XMLAST=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJBM",29,0)
 . ; have the user pick from first to last, or any xmz
"RTN","XMJBM",30,0)
 . N XMY,XMOPT,XMOX,XMPREVU
"RTN","XMJBM",31,0)
 . D SETCMD(XMDUZ,XMK,.XMOPT,.XMOX)
"RTN","XMJBM",32,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",33,0)
 . S XMNEXT=0
"RTN","XMJBM",34,0)
 . F  D  Q:XMNEXT!XMABORT
"RTN","XMJBM",35,0)
 . . W ! W:XMV("PREVU") !,XMPREVU
"RTN","XMJBM",36,0)
 . . S XMPARM(1)=XMKN,XMPARM(2)=XMKZ
"RTN","XMJBM",37,0)
 . . W !,$$EZBLD^DIALOG(34030,.XMPARM) ; XMKN," Basket Message: ",XMKZ,"// "
"RTN","XMJBM",38,0)
 . . R XMY:DTIME I '$T S XMABORT=1 Q
"RTN","XMJBM",39,0)
 . . I XMY[U S XMABORT=1 Q
"RTN","XMJBM",40,0)
 . . I XMY="" S XMY=XMKZ D NUMBER Q
"RTN","XMJBM",41,0)
 . . I XMY?.N D NUMBER Q
"RTN","XMJBM",42,0)
 . . I $E(XMY)="?" D QUESTION Q
"RTN","XMJBM",43,0)
 . . S XMY=$$COMMAND^XMJDIR(.XMOPT,.XMOX,XMY)
"RTN","XMJBM",44,0)
 . . I XMY=-1 D HELPSCR Q
"RTN","XMJBM",45,0)
 . . I $D(XMOPT(XMY,"?")) D SHOWERR^XMJDIR(.XMOPT,.XMY) Q
"RTN","XMJBM",46,0)
 . . D @XMY
"RTN","XMJBM",47,0)
 . . S:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",+XMKZ)) XMNEXT=1
"RTN","XMJBM",48,0)
 I $D(XMORDER) S XMV("ORDER")=XMORDER
"RTN","XMJBM",49,0)
 Q
"RTN","XMJBM",50,0)
PREVU(XMDUZ,XMK,XMKN,XMKZ) ;
"RTN","XMJBM",51,0)
 Q:XMKZ="" ""
"RTN","XMJBM",52,0)
 N XMZ,XMZREC,XMSUBJ,XMFROM,XMLEN,XMSL,XMFL,XMPARM
"RTN","XMJBM",53,0)
 S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJBM",54,0)
 I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJBM",55,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJBM",56,0)
 S XMSUBJ=$$SUBJ^XMXUTIL2(XMZREC)
"RTN","XMJBM",57,0)
 S XMFROM=$$NAME^XMXUTIL($P(XMZREC,U,2))
"RTN","XMJBM",58,0)
 S XMSL=$L(XMSUBJ)
"RTN","XMJBM",59,0)
 S XMFL=$L(XMFROM)
"RTN","XMJBM",60,0)
 S XMLEN=64
"RTN","XMJBM",61,0)
 I XMSL+XMFL>XMLEN D
"RTN","XMJBM",62,0)
 . I XMSL<36 S XMFROM=$E(XMFROM,1,XMLEN-XMSL) Q
"RTN","XMJBM",63,0)
 . I XMFL<26 S XMSUBJ=$E(XMSUBJ,1,XMLEN-XMFL) Q
"RTN","XMJBM",64,0)
 . S XMSL=XMSL-(XMSL+XMFL-XMLEN\2)
"RTN","XMJBM",65,0)
 . S XMSUBJ=$E(XMSUBJ,1,XMSL)
"RTN","XMJBM",66,0)
 . S XMFROM=$E(XMFROM,1,XMLEN-XMSL)
"RTN","XMJBM",67,0)
 S XMPARM(1)=XMSUBJ,XMPARM(2)=XMFROM
"RTN","XMJBM",68,0)
 Q $$EZBLD^DIALOG(34031,.XMPARM) ; "Subj: "_XMSUBJ_"   From: "_XMFROM
"RTN","XMJBM",69,0)
SETCMD(XMDUZ,XMK,XMOPT,XMOX) ;
"RTN","XMJBM",70,0)
 D OPTGRP^XMXSEC1(XMDUZ,XMK,.XMOPT,.XMOX)
"RTN","XMJBM",71,0)
 I XMDUZ=.5,XMK>999 Q
"RTN","XMJBM",72,0)
 D SET^XMXSEC1("I",37241,.XMOPT,.XMOX) ; Ignore this message
"RTN","XMJBM",73,0)
 Q
"RTN","XMJBM",74,0)
NUMBER ;
"RTN","XMJBM",75,0)
 ; See ENTM^XMA03 to see how MM7.1 handles this
"RTN","XMJBM",76,0)
 I $L(XMY)>25 W *7,"?" Q
"RTN","XMJBM",77,0)
 I XMY<XMFIRST D  Q
"RTN","XMJBM",78,0)
 . S (XMKZ,DIR("B"))=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJBM",79,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",80,0)
 . W *7,"?"
"RTN","XMJBM",81,0)
 I $D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMY)) D  Q
"RTN","XMJBM",82,0)
 . S XMKZ=XMY
"RTN","XMJBM",83,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJBM",84,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJBM",85,0)
 . D READMSG(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",86,0)
 . S XMNEXT=1
"RTN","XMJBM",87,0)
 I XMFIRST'>XMY,XMY'>XMLAST D  Q
"RTN","XMJBM",88,0)
 . S (XMKZ,DIR("B"))=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMY),XMV("ORDER"))
"RTN","XMJBM",89,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",90,0)
 . W *7,"?"
"RTN","XMJBM",91,0)
 I $D(^XMB(3.9,XMY,0)) D NUMBERZ Q
"RTN","XMJBM",92,0)
 I XMY>XMLAST D  Q
"RTN","XMJBM",93,0)
 . S (XMKZ,DIR("B"))=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJBM",94,0)
 . S:XMV("PREVU") XMPREVU=$$PREVU(XMDUZ,XMK,XMKN,XMKZ)
"RTN","XMJBM",95,0)
 . W *7,"?"
"RTN","XMJBM",96,0)
 W *7,"?"
"RTN","XMJBM",97,0)
 Q
"RTN","XMJBM",98,0)
NUMBERZ ;
"RTN","XMJBM",99,0)
 I $D(^XMB(3.7,"M",XMY,XMDUZ)) D  Q
"RTN","XMJBM",100,0)
 . S XMZ=XMY
"RTN","XMJBM",101,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ)) D
"RTN","XMJBM",102,0)
 . . ; It's in another basket
"RTN","XMJBM",103,0)
 . . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMJBM",104,0)
 . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMJBM",105,0)
 . S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMJBM",106,0)
 . I 'XMKZ D ADDITM^XMUT4A(XMDUZ,XMK,XMZ,.XMKZ)
"RTN","XMJBM",107,0)
 . D READMSG(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",108,0)
 . S XMNEXT=1
"RTN","XMJBM",109,0)
 . ; *** MM7.1 checks to see if XMK=.5 (WASTE).  If so, it moves it to the IN basket.  I disagree.
"RTN","XMJBM",110,0)
 I $D(^XMB(3.9,XMY,0)) D  Q
"RTN","XMJBM",111,0)
 . S XMZ=XMY
"RTN","XMJBM",112,0)
 . I $D(XMERR) K XMERR,^TMP("XMERR",$J)
"RTN","XMJBM",113,0)
 . I '$$ACCESS^XMXSEC(XMDUZ,XMZ,^XMB(3.9,XMZ,0)) D  Q
"RTN","XMJBM",114,0)
 . . W "?"
"RTN","XMJBM",115,0)
 . . D SHOW^XMJERR
"RTN","XMJBM",116,0)
 . D PUTMSG^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ) ; User is a recipient, so save to user's basket
"RTN","XMJBM",117,0)
 . D READMSG(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",118,0)
 . S XMNEXT=1
"RTN","XMJBM",119,0)
 Q
"RTN","XMJBM",120,0)
QUESTION ;
"RTN","XMJBM",121,0)
 I XMY="?" D LIST^XMJML(XMDUZ,XMK,XMKN,XMKZ,0) Q
"RTN","XMJBM",122,0)
 I XMY="??" D LIST^XMJML(XMDUZ,XMK,XMKN,XMKZ,1) Q
"RTN","XMJBM",123,0)
 I XMY="???" D HELPSCR Q
"RTN","XMJBM",124,0)
 I XMY?4."?"!("?HELP"[$$UP^XLFSTR(XMY)) D  Q
"RTN","XMJBM",125,0)
 . N XQH
"RTN","XMJBM",126,0)
 . S XQH="XM-U-BO-CLASSIC"
"RTN","XMJBM",127,0)
 . D EN^XQH
"RTN","XMJBM",128,0)
 I XMY?1"??".E D  Q
"RTN","XMJBM",129,0)
 . ; Search for messages whose subject starts with string
"RTN","XMJBM",130,0)
 . I $E(XMY,3,99)?.N,$D(^XMB(3.9,$E(XMY,3,999),0)) D  Q
"RTN","XMJBM",131,0)
 . . S XMY=$E(XMY,3,99)
"RTN","XMJBM",132,0)
 . . D NUMBERZ
"RTN","XMJBM",133,0)
 . D FIND^XMJMFA(XMDUZ,$E(XMY,3,99))
"RTN","XMJBM",134,0)
 I XMY?1"?".E D  Q
"RTN","XMJBM",135,0)
 . ; Search for messages whose subject contains string
"RTN","XMJBM",136,0)
 . N XMF
"RTN","XMJBM",137,0)
 . S XMF("BSKT")=XMK
"RTN","XMJBM",138,0)
 . S XMF("SUBJ")=$E(XMY,2,99)
"RTN","XMJBM",139,0)
 . D FIND1^XMJMFB(XMDUZ,.XMF)
"RTN","XMJBM",140,0)
 Q
"RTN","XMJBM",141,0)
HELPSCR ;
"RTN","XMJBM",142,0)
 N XMTEXT,XMLINES,XMPARM
"RTN","XMJBM",143,0)
 W !
"RTN","XMJBM",144,0)
 S XMPARM(1)=XMKZ,XMPARM(2)=XMFIRST,XMPARM(3)=XMLAST
"RTN","XMJBM",145,0)
 D BLD^DIALOG(34032,.XMPARM,"","XMTEXT","F")
"RTN","XMJBM",146,0)
 ; Press ENTER to read message _XMKZ_.  Enter message number (_XMFIRST_-_XMLAST_) to read
"RTN","XMJBM",147,0)
 ; a message in this basket.  Enter internal message number to read any
"RTN","XMJBM",148,0)
 ; message still on the system, which you ever sent or received.  Enter:
"RTN","XMJBM",149,0)
 ; ? or ??        Display a summary or detailed list of messages in this basket
"RTN","XMJBM",150,0)
 ; ???? or ?HELP  Display detailed help
"RTN","XMJBM",151,0)
 ; ?string        Search for messages in this basket whose subject
"RTN","XMJBM",152,0)
 ;                contains the specified string
"RTN","XMJBM",153,0)
 ; ??string       Search for messages you once sent or received
"RTN","XMJBM",154,0)
 ;                whose subject begins with the specified string
"RTN","XMJBM",155,0)
 S XMLINES=IOSL-DIHELP-3
"RTN","XMJBM",156,0)
 D MSG^DIALOG("WH","",$G(IOM),"","XMTEXT")
"RTN","XMJBM",157,0)
 D HELPCMD^XMJDIR(.XMOPT,.XMOX,XMLINES)
"RTN","XMJBM",158,0)
 Q
"RTN","XMJBM",159,0)
READMSG(XMDUZ,XMK,XMKN,XMZ) ;
"RTN","XMJBM",160,0)
 I '$D(^XMB(3.9,XMZ,0)) D ZAPIT(XMDUZ,XMK,XMZ) Q
"RTN","XMJBM",161,0)
 I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,$G(^XMB(3.9,XMZ,0))) D  Q  ; "read"
"RTN","XMJBM",162,0)
 . D SHOW^XMJERR
"RTN","XMJBM",163,0)
 . I $G(XMRDR)'="C" D WAIT^XMXUTIL
"RTN","XMJBM",164,0)
 N XMSECURE,XMPAKMAN,XMSECBAD ; Important 'new' - part of scramble and packman handling
"RTN","XMJBM",165,0)
 D DISPMSG^XMJMP(XMDUZ,XMK,XMKN,XMZ,.XMSECBAD) Q:$G(XMSECBAD)
"RTN","XMJBM",166,0)
 D READMSG^XMJMOI(0,XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJBM",167,0)
 Q
"RTN","XMJBM",168,0)
ZAPIT(XMDUZ,XMK,XMZ) ;
"RTN","XMJBM",169,0)
 W !,*7,$$EZBLD^DIALOG(34034) ; This references a message which doesn't exist - deleting it.
"RTN","XMJBM",170,0)
 D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ)
"RTN","XMJBM",171,0)
 Q
"RTN","XMJBM",172,0)
C ; Change the name of the basket
"RTN","XMJBM",173,0)
 D NAMEBSKT^XMJBU(XMDUZ,XMK,.XMKN)
"RTN","XMJBM",174,0)
 Q
"RTN","XMJBM",175,0)
D ; Delete
"RTN","XMJBM",176,0)
 D DELETE^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",177,0)
 Q
"RTN","XMJBM",178,0)
F ; Forward
"RTN","XMJBM",179,0)
 D FORWARD^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",180,0)
 Q
"RTN","XMJBM",181,0)
FI ; Filter
"RTN","XMJBM",182,0)
 D FILTER^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",183,0)
 Q
"RTN","XMJBM",184,0)
H ; Headerless Print
"RTN","XMJBM",185,0)
 D PRINT^XMJMOR(XMDUZ,XMK,0)
"RTN","XMJBM",186,0)
 Q
"RTN","XMJBM",187,0)
I ; Ignore this message
"RTN","XMJBM",188,0)
 S XMNEXT=1
"RTN","XMJBM",189,0)
 Q
"RTN","XMJBM",190,0)
L ; Later
"RTN","XMJBM",191,0)
LA ; Later
"RTN","XMJBM",192,0)
 D LATER^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",193,0)
 Q
"RTN","XMJBM",194,0)
LM ; List Messages (can't read)
"RTN","XMJBM",195,0)
 D LIST^XMJML(XMDUZ,XMK,XMKN,"",1)
"RTN","XMJBM",196,0)
 Q
"RTN","XMJBM",197,0)
LN ; List New Messages
"RTN","XMJBM",198,0)
 D LISTONE^XMJMLN(XMDUZ,XMK,XMKN,"N0")
"RTN","XMJBM",199,0)
 Q
"RTN","XMJBM",200,0)
LP ; List Priority Messages
"RTN","XMJBM",201,0)
 D LISTONE^XMJMLN(XMDUZ,XMK,XMKN,"N")
"RTN","XMJBM",202,0)
 Q
"RTN","XMJBM",203,0)
N ; List New Messages (can't read)
"RTN","XMJBM",204,0)
 D LISTNEW^XMJML(XMDUZ,XMK,XMKN)
"RTN","XMJBM",205,0)
 Q
"RTN","XMJBM",206,0)
NT ; New Toggle messages
"RTN","XMJBM",207,0)
 D NEWTOGL^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",208,0)
 Q
"RTN","XMJBM",209,0)
P ; Print
"RTN","XMJBM",210,0)
 D PRINT^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",211,0)
 Q
"RTN","XMJBM",212,0)
Q ; Query by subject, sender, and/or date
"RTN","XMJBM",213,0)
 D FINDBSKT^XMJMF(XMDUZ,XMK,XMKN)
"RTN","XMJBM",214,0)
 Q
"RTN","XMJBM",215,0)
R ; Resequence
"RTN","XMJBM",216,0)
 N XMMSG
"RTN","XMJBM",217,0)
 W !,$$EZBLD^DIALOG(34035) ; Resequencing ...
"RTN","XMJBM",218,0)
 D RSEQBSKT^XMXBSKT(XMDUZ,XMK,.XMMSG)
"RTN","XMJBM",219,0)
 W !,XMMSG
"RTN","XMJBM",220,0)
 S XMKZ=""
"RTN","XMJBM",221,0)
 Q
"RTN","XMJBM",222,0)
S ; Save
"RTN","XMJBM",223,0)
 D SAVE^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",224,0)
 Q
"RTN","XMJBM",225,0)
T ; Terminate
"RTN","XMJBM",226,0)
 D TERM^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",227,0)
 Q
"RTN","XMJBM",228,0)
X ; Xmit Priority toggle (for Postmaster only)
"RTN","XMJBM",229,0)
 D XMTPRI^XMJMOR(XMDUZ,XMK)
"RTN","XMJBM",230,0)
 Q
"RTN","XMJDIR")
0^5^B16354335
"RTN","XMJDIR",1,0)
XMJDIR ;ISC-SF/GMB- MailMan's DIR ;02/15/2000  09:35
"RTN","XMJDIR",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJDIR",3,0)
XMDIR(XMDIR,XMOPT,XMOX,XMY,XMABORT) ;
"RTN","XMJDIR",4,0)
 N XMX
"RTN","XMJDIR",5,0)
 K XMY
"RTN","XMJDIR",6,0)
 F  D  Q:$D(XMY)!XMABORT
"RTN","XMJDIR",7,0)
 . W !!,XMDIR("A"),$S($D(XMDIR("B")):$P(XMDIR("B"),":",2,99)_"// ",1:"")
"RTN","XMJDIR",8,0)
 . R XMX:DTIME I '$T S XMABORT=DTIME Q
"RTN","XMJDIR",9,0)
 . I XMX[U S XMABORT=1 Q
"RTN","XMJDIR",10,0)
 . I XMX="" D  Q
"RTN","XMJDIR",11,0)
 . . I '$D(XMDIR("B")) S XMABORT=1 Q
"RTN","XMJDIR",12,0)
 . . S XMY=$P(XMDIR("B"),":",1)
"RTN","XMJDIR",13,0)
 . I XMX="?" D HELPSCR(.XMOPT,.XMOX) Q
"RTN","XMJDIR",14,0)
 . I $E(XMX)="?" D  Q
"RTN","XMJDIR",15,0)
 . . N XQH
"RTN","XMJDIR",16,0)
 . . S XQH=$G(XMDIR("??"),"XM-U-MO-READ")
"RTN","XMJDIR",17,0)
 . . D EN^XQH
"RTN","XMJDIR",18,0)
 . I $D(XMDIR("PRE")) X XMDIR("PRE")
"RTN","XMJDIR",19,0)
 . S XMY=$$COMMAND(.XMOPT,.XMOX,XMX)
"RTN","XMJDIR",20,0)
 . I $D(XMOPT(XMY)),'$D(XMOPT(XMY,"?")) Q
"RTN","XMJDIR",21,0)
 . I XMY=-1 D
"RTN","XMJDIR",22,0)
 . . W *7 D HELPSCR(.XMOPT,.XMOX)
"RTN","XMJDIR",23,0)
 . E  D SHOWERR(.XMOPT,XMY) I $D(XMOPT(XMY,"?X")) X XMOPT(XMY,"?X") I $T Q
"RTN","XMJDIR",24,0)
 . K XMY
"RTN","XMJDIR",25,0)
 Q
"RTN","XMJDIR",26,0)
SHOWERR(XMOPT,XMY) ; Show error message
"RTN","XMJDIR",27,0)
 W *7,!
"RTN","XMJDIR",28,0)
 I $D(XMOPT(XMY,"?",1)) D
"RTN","XMJDIR",29,0)
 . N I
"RTN","XMJDIR",30,0)
 . S I=0
"RTN","XMJDIR",31,0)
 . F  S I=$O(XMOPT(XMY,"?",I)) Q:'I  W !,XMOPT(XMY,"?",I)
"RTN","XMJDIR",32,0)
 W !,XMOPT(XMY,"?")
"RTN","XMJDIR",33,0)
 Q
"RTN","XMJDIR",34,0)
COMMAND(XMOPT,XMOX,XMY) ;
"RTN","XMJDIR",35,0)
 S XMY=$$UP^XLFSTR(XMY)
"RTN","XMJDIR",36,0)
 I XMY?.E1C.E Q -1
"RTN","XMJDIR",37,0)
 I $L(XMY)>64 Q -1
"RTN","XMJDIR",38,0)
 I $D(XMOX("X",XMY)) Q XMOX("X",XMY)
"RTN","XMJDIR",39,0)
 I '$D(XMOX("X",$E(XMY))) Q -1
"RTN","XMJDIR",40,0)
 N XMCMD,XMLEN
"RTN","XMJDIR",41,0)
 S XMLEN=$L(XMY)
"RTN","XMJDIR",42,0)
 S XMCMD=$CHAR($A($E(XMY))-1)_"~"
"RTN","XMJDIR",43,0)
 F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""  Q:$$UP^XLFSTR($E(XMOPT(XMOX("X",XMCMD)),1,XMLEN))=XMY!($E(XMCMD)'=$E(XMY))
"RTN","XMJDIR",44,0)
 I $E(XMCMD)=$E(XMY) Q $P(XMCMD," ")  ; for Q xxx
"RTN","XMJDIR",45,0)
 Q -1
"RTN","XMJDIR",46,0)
HELPSCR(XMOPT,XMOX) ;
"RTN","XMJDIR",47,0)
 W !!,$$EZBLD^DIALOG(34054),! ; Enter a code from the list.
"RTN","XMJDIR",48,0)
 D HELPCMD(.XMOPT,.XMOX)
"RTN","XMJDIR",49,0)
 Q
"RTN","XMJDIR",50,0)
HELPCMD(XMOPT,XMOX,XMPMAX) ;
"RTN","XMJDIR",51,0)
 N XMCNT,XMCMD,XMROWS,I,XMHELP,XMLEN
"RTN","XMJDIR",52,0)
 S (XMCNT,XMLEN)=0,XMCMD=""
"RTN","XMJDIR",53,0)
 F  S XMCMD=$O(XMOPT(XMCMD)) Q:XMCMD=""  I '$D(XMOPT(XMCMD,"?")) S XMCNT=XMCNT+1 I $L(XMOX("X",XMCMD))>XMLEN S XMLEN=$L(XMOX("X",XMCMD))
"RTN","XMJDIR",54,0)
 I XMCNT<$G(XMPMAX,IOSL-4) D  Q
"RTN","XMJDIR",55,0)
 . F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""  D
"RTN","XMJDIR",56,0)
 . . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJDIR",57,0)
 . . W !,?9,$E(XMCMD_"         ",1,10)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJDIR",58,0)
 S XMROWS=XMCNT+1\2
"RTN","XMJDIR",59,0)
 S I=0
"RTN","XMJDIR",60,0)
 F  D  Q:I=XMROWS
"RTN","XMJDIR",61,0)
 . S XMCMD=$O(XMOX("X",XMCMD))
"RTN","XMJDIR",62,0)
 . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJDIR",63,0)
 . S I=I+1
"RTN","XMJDIR",64,0)
 . S XMHELP(I)=" "_$E(XMCMD_"      ",1,XMLEN+2)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJDIR",65,0)
 S I=0
"RTN","XMJDIR",66,0)
 F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""  D
"RTN","XMJDIR",67,0)
 . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJDIR",68,0)
 . S I=I+1
"RTN","XMJDIR",69,0)
 . W !,$E(XMHELP(I)_"                                   ",1,39)_"  "_$E(XMCMD_"      ",1,XMLEN+2)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJDIR",70,0)
 S I=I+1
"RTN","XMJDIR",71,0)
 W:$D(XMHELP(I)) !,XMHELP(I)
"RTN","XMJDIR",72,0)
 Q
"RTN","XMJDIR",73,0)
XCOMMAND(XMOPT,XMOX,XMY) ; This is an experiment.  It is not currently used.
"RTN","XMJDIR",74,0)
 ; It is designed to replace $$COMMAND.  If the user enters something,
"RTN","XMJDIR",75,0)
 ; which is ambiguous, ^DIR is called to ask the user to choose one.
"RTN","XMJDIR",76,0)
 ; (Also returns XMABORT.)  This function should be turned into a
"RTN","XMJDIR",77,0)
 ; subroutine call.
"RTN","XMJDIR",78,0)
 S XMY=$$UP^XLFSTR(XMY)
"RTN","XMJDIR",79,0)
 I XMY?.E1C.E Q -1
"RTN","XMJDIR",80,0)
 I $L(XMY)>64 Q -1
"RTN","XMJDIR",81,0)
 I $D(XMOX("X",XMY)) Q XMOX("X",XMY)
"RTN","XMJDIR",82,0)
 N XMTXT,XMCMD,XMLEN,XMCHOOSE
"RTN","XMJDIR",83,0)
 S XMCMD=""
"RTN","XMJDIR",84,0)
 F  S XMCMD=$O(XMOPT(XMCMD)) Q:XMCMD=""  S:'$D(XMOPT(XMCMD,"?")) XMTXT(XMOPT(XMCMD))=XMCMD
"RTN","XMJDIR",85,0)
 S XMLEN=$L(XMY)
"RTN","XMJDIR",86,0)
 S XMCMD=$CHAR($A($E(XMY))-1)_"~"
"RTN","XMJDIR",87,0)
 F  S XMCMD=$O(XMTXT(XMCMD)) Q:XMCMD=""!($E(XMCMD)'=$E(XMY))  I $$UP^XLFSTR($E(XMCMD,1,XMLEN))=XMY S XMCHOOSE(XMCMD)=""
"RTN","XMJDIR",88,0)
 S XMCMD=$CHAR($A($E(XMY))-1)_"~"
"RTN","XMJDIR",89,0)
 F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""!($E(XMCMD)'=$E(XMY))  I $$UP^XLFSTR($E(XMCMD,1,XMLEN))=XMY S:'$D(XMOPT(XMOX("X",XMCMD),"?")) XMCHOOSE(XMOPT(XMOX("X",XMCMD)))=""
"RTN","XMJDIR",90,0)
 I '$D(XMCHOOSE) Q -1
"RTN","XMJDIR",91,0)
 N I,XMX,DIR,Y,X
"RTN","XMJDIR",92,0)
 S I=0,(DIR(0),XMX)=""
"RTN","XMJDIR",93,0)
 F  S XMX=$O(XMCHOOSE(XMX)) Q:XMX=""  S I=I+1,DIR(0)=DIR(0)_I_":"_XMX_";",XMX(I)=XMTXT(XMCHOOSE(XMX))
"RTN","XMJDIR",94,0)
 I I=1 Q $P(XMX(1)," ")  ; for Q xxx
"RTN","XMJDIR",95,0)
 S DIR(0)="S^"_$E(DIR(0),1,$L(DIR(0))-1)
"RTN","XMJDIR",96,0)
 D ^DIR
"RTN","XMJDIR",97,0)
 I $D(DTOUT) S XMABORT=DTIME Q -1
"RTN","XMJDIR",98,0)
 I $D(DIRUT) S XMABORT=1 Q -1
"RTN","XMJDIR",99,0)
 Q $P(XMX(Y)," ")  ; for Q xxx
"RTN","XMJMA")
0^33^B7043405
"RTN","XMJMA",1,0)
XMJMA ;ISC-SF/GMB-Interactive Answer ;01/07/2000  15:06
"RTN","XMJMA",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMA",3,0)
 ; Replaces ^XMA11A,^XMA11B,SH^XMA1B,^XMA2,^XMA20 (ISC-WASH/CAP/THM)
"RTN","XMJMA",4,0)
ANSWER(XMDUZ,XMZO,XMZOSUBJ,XMZOFROM) ;
"RTN","XMJMA",5,0)
 N XMABORT,XMZ,XMINSTR,XMSUBJ,XMZODATE
"RTN","XMJMA",6,0)
 S XMABORT=0
"RTN","XMJMA",7,0)
 D INIT(XMDUZ,XMZO,.XMZODATE,.XMINSTR,.XMABORT) Q:XMABORT
"RTN","XMJMA",8,0)
 S XMSUBJ=$E($$EZBLD^DIALOG(37006)_XMZOSUBJ,1,65) ; Re:
"RTN","XMJMA",9,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMA",10,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ,1) I XMZ<1 S XMABORT=1 Q
"RTN","XMJMA",11,0)
 D EDITON^XMJMS(XMDUZ,XMZ)
"RTN","XMJMA",12,0)
 D PROCESS(XMDUZ,XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ,XMSUBJ,.XMINSTR,.XMABORT)
"RTN","XMJMA",13,0)
 D CLEANUP^XMXADDR
"RTN","XMJMA",14,0)
 D:XMABORT=DTIME HALT^XMJMS($$EZBLD^DIALOG(34250)) ; answering
"RTN","XMJMA",15,0)
 D EDITOFF^XMJMS(XMDUZ)
"RTN","XMJMA",16,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMA",17,0)
 Q
"RTN","XMJMA",18,0)
INIT(XMDUZ,XMZO,XMZODATE,XMINSTR,XMABORT) ;
"RTN","XMJMA",19,0)
 D INIT^XMJMS(XMDUZ,.XMABORT) Q:XMABORT
"RTN","XMJMA",20,0)
 S XMZODATE=$P($G(^XMB(3.9,XMZO,0)),U,3)
"RTN","XMJMA",21,0)
 Q:$$COPYAMT^XMXSEC1(XMZO,0)
"RTN","XMJMA",22,0)
 S XMABORT=1
"RTN","XMJMA",23,0)
 D SHOW^XMJERR
"RTN","XMJMA",24,0)
 ;This message has too many lines to 'Answer'.
"RTN","XMJMA",25,0)
 ;Use 'Write' or 'Reply', instead.
"RTN","XMJMA",26,0)
 N XMTEXT
"RTN","XMJMA",27,0)
 D BLD^DIALOG(34251,"","","XMTEXT","F")
"RTN","XMJMA",28,0)
 D MSG^DIALOG("WE","","","","XMTEXT")
"RTN","XMJMA",29,0)
 Q
"RTN","XMJMA",30,0)
PROCESS(XMDUZ,XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ,XMSUBJ,XMINSTR,XMABORT) ;
"RTN","XMJMA",31,0)
 N XMRESTR
"RTN","XMJMA",32,0)
 W !,$$EZBLD^DIALOG(34252) ; Copying original message and network signature ...
"RTN","XMJMA",33,0)
 D COPY^XMXANSER(XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ)
"RTN","XMJMA",34,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZ)
"RTN","XMJMA",35,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT) Q:XMABORT
"RTN","XMJMA",36,0)
 I XMZOFROM["@" D  Q:XMABORT
"RTN","XMJMA",37,0)
 . D REPLYTO^XMJMR(XMZO,.XMZOFROM,.XMABORT) Q:XMABORT
"RTN","XMJMA",38,0)
 . S XMRESTR("FLAGS")="O" ; Match on exact domain name, if possible
"RTN","XMJMA",39,0)
 . W !,$$EZBLD^DIALOG(34253,XMZOFROM) ; Addressing answer to:
"RTN","XMJMA",40,0)
 E  D
"RTN","XMJMA",41,0)
 . W !,$$EZBLD^DIALOG(34254) ; Addressing answer to sender:
"RTN","XMJMA",42,0)
 D INIT^XMXADDR
"RTN","XMJMA",43,0)
 D ADDR^XMXADDR(XMDUZ,XMZOFROM,.XMINSTR,.XMRESTR)
"RTN","XMJMA",44,0)
 I '$D(^TMP("XMY",$J)) W !,$$EZBLD^DIALOG(34255,$$NAME^XMXUTIL(XMZOFROM)) ; Failed in addressing answer to:
"RTN","XMJMA",45,0)
 K XMRESTR("FLAGS")
"RTN","XMJMA",46,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; Send
"RTN","XMJMA",47,0)
 D SENDMSG^XMJMSO(XMDUZ,XMZ,XMSUBJ,.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT
"RTN","XMJMA",48,0)
 Q
"RTN","XMJMC")
0^12^B33661798
"RTN","XMJMC",1,0)
XMJMC ;ISC-SF/GMB-Copy message ;02/23/2000  15:34
"RTN","XMJMC",2,0)
 ;;7.1;MailMan;**50,79,110**;Jun 02, 1994
"RTN","XMJMC",3,0)
 ; Replaces ^XMA2C,^XMA2C0 (ISC-WASH/CAP)
"RTN","XMJMC",4,0)
COPY(XMDUZ,XMK,XMZ,XMFROM) ;
"RTN","XMJMC",5,0)
 N XMABORT,XMWHICH,XMLR,XMSAME,XMZREC
"RTN","XMJMC",6,0)
 D INIT(XMDUZ,XMK,XMZ,XMFROM,.XMZREC,.XMWHICH,.XMLR,.XMSAME,.XMABORT) Q:XMABORT
"RTN","XMJMC",7,0)
 D COPYIT(XMDUZ,XMZ,$P(XMZREC,U,1),XMFROM,$P(XMZREC,U,3),XMWHICH,XMLR,XMSAME)
"RTN","XMJMC",8,0)
 Q
"RTN","XMJMC",9,0)
INIT(XMDUZ,XMK,XMZ,XMFROM,XMZREC,XMWHICH,XMLR,XMSAME,XMABORT) ;
"RTN","XMJMC",10,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMC",11,0)
 S XMABORT=0
"RTN","XMJMC",12,0)
 D INIT^XMJMS(XMDUZ,.XMABORT) Q:XMABORT
"RTN","XMJMC",13,0)
 S XMWHICH=0
"RTN","XMJMC",14,0)
 D WHICH(XMZ,$$EZBLD^DIALOG(34600),.XMWHICH,.XMABORT) Q:XMABORT  ; copy
"RTN","XMJMC",15,0)
 I '$$COPYRECP^XMXSEC1(XMZ) D  Q
"RTN","XMJMC",16,0)
 . S (XMLR,XMSAME)=0
"RTN","XMJMC",17,0)
 . D SHOW^XMJERR
"RTN","XMJMC",18,0)
 D LISTR(.XMLR,.XMABORT) Q:XMABORT
"RTN","XMJMC",19,0)
 D TOSAME(.XMSAME,.XMABORT)
"RTN","XMJMC",20,0)
 Q
"RTN","XMJMC",21,0)
WHICH(XMZ,XMVERB,XMWHICH,XMABORT) ;
"RTN","XMJMC",22,0)
 N XMRESPS
"RTN","XMJMC",23,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMC",24,0)
 I XMRESPS=0 S XMWHICH=0
"RTN","XMJMC",25,0)
 E  D WHICH^XMJMP(XMZ,XMRESPS,XMVERB,.XMWHICH,.XMABORT) Q:XMABORT!'$D(XMWHICH)
"RTN","XMJMC",26,0)
 Q:$$COPYAMT^XMXSEC1(XMZ,XMWHICH)
"RTN","XMJMC",27,0)
 S XMABORT=1
"RTN","XMJMC",28,0)
 D SHOW^XMJERR
"RTN","XMJMC",29,0)
 ;You may use the 'Transfer' option of the FileMan Editor
"RTN","XMJMC",30,0)
 ;to move text from this message or its responses into a new message.
"RTN","XMJMC",31,0)
 N XMTEXT
"RTN","XMJMC",32,0)
 D BLD^DIALOG(34601,"","","XMTEXT","F")
"RTN","XMJMC",33,0)
 D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMC",34,0)
 Q
"RTN","XMJMC",35,0)
LISTR(XMLR,XMABORT) ;
"RTN","XMJMC",36,0)
 N DIR,Y
"RTN","XMJMC",37,0)
 S DIR("A")=$$EZBLD^DIALOG(34602) ; List original recipients in text
"RTN","XMJMC",38,0)
 S DIR("B")=$$EZBLD^DIALOG(39053),DIR(0)="Y",DIR("??")="XM-U-M-COPY-2" ; No
"RTN","XMJMC",39,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMC",40,0)
 S XMLR=Y
"RTN","XMJMC",41,0)
 Q
"RTN","XMJMC",42,0)
TOSAME(XMSAME,XMABORT) ;
"RTN","XMJMC",43,0)
 N DIR,Y
"RTN","XMJMC",44,0)
 S DIR("A")=$$EZBLD^DIALOG(34603) ; Deliver to the same recipients
"RTN","XMJMC",45,0)
 S DIR("B")=$$EZBLD^DIALOG(39053),DIR(0)="Y",DIR("??")="XM-U-M-COPY-2" ; No
"RTN","XMJMC",46,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMC",47,0)
 S XMSAME=Y
"RTN","XMJMC",48,0)
 Q:'XMSAME
"RTN","XMJMC",49,0)
 ;LOCAL recipients (NOT Recipients on remote network nodes) will be copied.
"RTN","XMJMC",50,0)
 N XMTEXT
"RTN","XMJMC",51,0)
 W !
"RTN","XMJMC",52,0)
 D BLD^DIALOG(34604,"","","XMTEXT","F")
"RTN","XMJMC",53,0)
 D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMJMC",54,0)
 Q
"RTN","XMJMC",55,0)
COPYIT(XMDUZ,XMZO,XMSUBJO,XMFROM,XMDATEO,XMWHICH,XMLR,XMSAME) ;
"RTN","XMJMC",56,0)
 ; XMWHICH   List of responses to copy
"RTN","XMJMC",57,0)
 ; XMLR     1=list original recipients in msg; 0=don't
"RTN","XMJMC",58,0)
 ; XMSAME   1=deliver to the original recipients; 0=don't
"RTN","XMJMC",59,0)
 N XMZ,XMSUBJ,XMABORT
"RTN","XMJMC",60,0)
 S XMABORT=0
"RTN","XMJMC",61,0)
 D INIT^XMXADDR
"RTN","XMJMC",62,0)
 S XMSUBJ=$E($$EZBLD^DIALOG(34605,XMSUBJO),1,65) ; Copy of:
"RTN","XMJMC",63,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMC",64,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ,1) I XMZ<1 S XMABORT=1 Q
"RTN","XMJMC",65,0)
 D:'$G(XMPAKMAN) EDITON^XMJMS(XMDUZ,XMZ)
"RTN","XMJMC",66,0)
 D CPROCESS(XMDUZ,XMZO,XMSUBJO,XMFROM,XMDATEO,XMWHICH,XMLR,XMSAME,XMZ,XMSUBJ,.XMABORT)
"RTN","XMJMC",67,0)
 D:XMABORT=DTIME HALT^XMJMS($$EZBLD^DIALOG(34606)) ; copying
"RTN","XMJMC",68,0)
 D:'$G(XMPAKMAN) EDITOFF^XMJMS(XMDUZ)
"RTN","XMJMC",69,0)
 D:XMABORT KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMC",70,0)
 Q
"RTN","XMJMC",71,0)
CPROCESS(XMDUZ,XMZO,XMSUBJO,XMFROM,XMDATEO,XMWHICH,XMLR,XMSAME,XMZ,XMSUBJ,XMABORT) ;
"RTN","XMJMC",72,0)
 N XMINSTR,XMRESTR,XMC
"RTN","XMJMC",73,0)
 D COPYTEXT(XMZO,XMSUBJO,XMFROM,XMDATEO,XMZ,XMWHICH,.XMC)
"RTN","XMJMC",74,0)
 D:XMLR!XMSAME COPYRECP(XMLR,XMSAME,XMZO,XMZ,.XMINSTR,.XMC)
"RTN","XMJMC",75,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_XMC_U_XMC_U_DT
"RTN","XMJMC",76,0)
 D ET^XMJMSO Q:XMABORT
"RTN","XMJMC",77,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; Send to add'l recipients
"RTN","XMJMC",78,0)
 I $G(XMPAKMAN) S XMINSTR("TYPE")=$S($P(^XMB(3.9,XMZO,0),U,7)["K":"K",1:"X")
"RTN","XMJMC",79,0)
 D SENDMSG^XMJMSO(XMDUZ,XMZ,XMSUBJ,.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; transmit prompt
"RTN","XMJMC",80,0)
 N XMIEN
"RTN","XMJMC",81,0)
 S XMIEN=+$O(^XMB(3.9,XMZO,1,"C",XMDUZ,0))
"RTN","XMJMC",82,0)
 I XMIEN S ^XMB(3.9,XMZO,1,XMIEN,"C")=$$NOW^XLFDT
"RTN","XMJMC",83,0)
 Q
"RTN","XMJMC",84,0)
COPYTEXT(XMZO,XMSUBJO,XMFROM,XMDATEO,XMZ,XMWHICH,XMC) ;
"RTN","XMJMC",85,0)
 N I,XMRESP,XMRANGE
"RTN","XMJMC",86,0)
 W !,$$EZBLD^DIALOG(34607) ; Copying text
"RTN","XMJMC",87,0)
 D COPYHEAD(XMZO,XMSUBJO,XMFROM,XMDATEO,XMZ,"C",.XMC)
"RTN","XMJMC",88,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMC",89,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMC",90,0)
 . Q:XMRANGE=""  ; (XMWHICH can end with a ",", giving us a null piece.)
"RTN","XMJMC",91,0)
 . F XMRESP=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMC",92,0)
 . . I XMRESP=0 D COPYRESP(XMRESP,XMZO,XMZ,.XMC) Q
"RTN","XMJMC",93,0)
 . . D COPYRESP(XMRESP,+$G(^XMB(3.9,XMZO,3,XMRESP,0)),XMZ,.XMC)
"RTN","XMJMC",94,0)
 Q
"RTN","XMJMC",95,0)
COPYHEAD(XMZO,XMSUBJ,XMFROM,XMDATE,XMZ,XMTYPE,XMC) ;
"RTN","XMJMC",96,0)
 N XMPRE
"RTN","XMJMC",97,0)
 S XMPRE=$S(XMTYPE="C":"",1:">")
"RTN","XMJMC",98,0)
 S ^XMB(3.9,XMZ,2,1,0)=XMPRE_$$EZBLD^DIALOG(34205)_": """_XMSUBJ_""""_$S(XMTYPE="C":" "_$$EZBLD^DIALOG(34537,XMZO),1:"") ; Original message:
"RTN","XMJMC",99,0)
 S ^XMB(3.9,XMZ,2,2,0)=XMPRE_$$EZBLD^DIALOG(34538,$$NAME^XMXUTIL(XMFROM)) ; From
"RTN","XMJMC",100,0)
 S ^XMB(3.9,XMZ,2,3,0)=XMPRE_$$EZBLD^DIALOG(34585,$$MMDT^XMXUTIL1(XMDATE)) ; Sent:
"RTN","XMJMC",101,0)
 S XMC=3
"RTN","XMJMC",102,0)
 Q
"RTN","XMJMC",103,0)
COPYRESP(XMRESP,XMZR,XMZ,XMC) ;
"RTN","XMJMC",104,0)
 N XMF,XMFROM,XMDT,XMZREC
"RTN","XMJMC",105,0)
 S XMC=XMC+1
"RTN","XMJMC",106,0)
 S ^XMB(3.9,XMZ,2,XMC,0)=""
"RTN","XMJMC",107,0)
 I XMRESP D
"RTN","XMJMC",108,0)
 . S XMZREC=$G(^XMB(3.9,XMZR,0))
"RTN","XMJMC",109,0)
 . S XMFROM=$$NAME^XMXUTIL($P(XMZREC,U,2))
"RTN","XMJMC",110,0)
 . S XMDT=$P(XMZREC,U,3)
"RTN","XMJMC",111,0)
 . S XMC=XMC+1
"RTN","XMJMC",112,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=$$EZBLD^DIALOG(34204,XMRESP)_": "_XMFROM_"    "_$$MMDT^XMXUTIL1(XMDT) ; Response #
"RTN","XMJMC",113,0)
 S XMF=.999999
"RTN","XMJMC",114,0)
 F  S XMF=$O(^XMB(3.9,XMZR,2,XMF)) Q:XMF=""  D
"RTN","XMJMC",115,0)
 . S XMC=XMC+1
"RTN","XMJMC",116,0)
 . W:XMC#50=0 "."
"RTN","XMJMC",117,0)
 . S ^XMB(3.9,XMZ,2,XMC,0)=^XMB(3.9,XMZR,2,XMF,0)
"RTN","XMJMC",118,0)
 Q
"RTN","XMJMC",119,0)
COPYRECP(XMLR,XMSAME,XMZO,XMZ,XMINSTR,XMC) ;
"RTN","XMJMC",120,0)
 N XMTO,XMNAME
"RTN","XMJMC",121,0)
 I XMLR D
"RTN","XMJMC",122,0)
 . W !,$$EZBLD^DIALOG($S(XMSAME:34610,1:34611)) ; Copying recipients into text (and onto message)
"RTN","XMJMC",123,0)
 . N XMTEXT,X
"RTN","XMJMC",124,0)
 . S XMTEXT=$$EZBLD^DIALOG(34608) ; Original Recipients
"RTN","XMJMC",125,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=""
"RTN","XMJMC",126,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=XMTEXT
"RTN","XMJMC",127,0)
 . S X="",$P(X,"-",$L(XMTEXT)+1)="" ; "-------------------"
"RTN","XMJMC",128,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=X
"RTN","XMJMC",129,0)
 E  W !,$$EZBLD^DIALOG(34612) ; Copying recipients onto message
"RTN","XMJMC",130,0)
 S XMTO=""
"RTN","XMJMC",131,0)
 F  S XMTO=$O(^XMB(3.9,XMZO,1,"C",XMTO)) Q:XMTO=""  D
"RTN","XMJMC",132,0)
 . I XMSAME,XMTO=+XMTO W ! D ADDR^XMXADDR(XMDUZ,"`"_XMTO,.XMINSTR)
"RTN","XMJMC",133,0)
 . Q:'XMLR
"RTN","XMJMC",134,0)
 . I +XMTO=XMTO S XMNAME=$$NAME^XMXUTIL(XMTO)
"RTN","XMJMC",135,0)
 . E  I $L(XMTO)<30 S XMNAME=XMTO
"RTN","XMJMC",136,0)
 . E  S XMNAME=$P($G(^XMB(3.9,XMZO,1,$O(^XMB(3.9,XMZO,1,"C",XMTO,0)),0)),U,1)
"RTN","XMJMC",137,0)
 . S XMC=XMC+1,^XMB(3.9,XMZ,2,XMC,0)=XMNAME
"RTN","XMJMC",138,0)
 Q
"RTN","XMJMCODE")
0^24^B34895416
"RTN","XMJMCODE",1,0)
XMJMCODE ;ISC-SF/GMB-Message En/Decryption ;02/23/2000  15:33
"RTN","XMJMCODE",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMCODE",3,0)
 ; Replaces ^XME,^XME1 (ISC-WASH/CAP/THM)
"RTN","XMJMCODE",4,0)
ENCMSG(XMZ) ; Encode a message
"RTN","XMJMCODE",5,0)
 N I
"RTN","XMJMCODE",6,0)
 W:$G(XMIA) !,$$EZBLD^DIALOG(34615) ; Scrambling...
"RTN","XMJMCODE",7,0)
 S I=.999999
"RTN","XMJMCODE",8,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I'>0  S ^(0)=$$ENCSTR(^XMB(3.9,XMZ,2,I,0))
"RTN","XMJMCODE",9,0)
 Q
"RTN","XMJMCODE",10,0)
ENCSTR(XMCLEAR) ; Encode a string
"RTN","XMJMCODE",11,0)
 N I,XMCODED
"RTN","XMJMCODE",12,0)
 S XMCODED=""
"RTN","XMJMCODE",13,0)
 F I=1:1:$L(XMCLEAR) S XMCODED=XMCODED_$C($F(XMSECURE(I#XMSECURE+1),$E(XMCLEAR,I))+30)
"RTN","XMJMCODE",14,0)
 Q XMCODED
"RTN","XMJMCODE",15,0)
DECMSG(XMZ) ; Decode a message
"RTN","XMJMCODE",16,0)
 N I
"RTN","XMJMCODE",17,0)
 W:$G(XMIA) !,$$EZBLD^DIALOG(34616) ; UnScrambling...
"RTN","XMJMCODE",18,0)
 S I=.999999
"RTN","XMJMCODE",19,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I'>0  S ^(0)=$$DECSTR(^XMB(3.9,XMZ,2,I,0))
"RTN","XMJMCODE",20,0)
 Q
"RTN","XMJMCODE",21,0)
DECSTR(XMCODED) ; Decode a string
"RTN","XMJMCODE",22,0)
 N I,XMCLEAR
"RTN","XMJMCODE",23,0)
 S XMCLEAR=""
"RTN","XMJMCODE",24,0)
 F I=1:1:$L(XMCODED) S XMCLEAR=XMCLEAR_$E(XMSECURE(I#XMSECURE+1),$A(XMCODED,I)-31)
"RTN","XMJMCODE",25,0)
 Q XMCLEAR
"RTN","XMJMCODE",26,0)
CRE8KEY(XMKEY,XMHINT,XMABORT) ;
"RTN","XMJMCODE",27,0)
 D ASKKEY(.XMKEY,.XMABORT) Q:XMABORT
"RTN","XMJMCODE",28,0)
 N DIR,X,Y
"RTN","XMJMCODE",29,0)
 S DIR(0)="3.9,1.8"
"RTN","XMJMCODE",30,0)
 S DIR("A")=$$EZBLD^DIALOG(34617) ; Enter Scramble Hint
"RTN","XMJMCODE",31,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S XMABORT=1 Q
"RTN","XMJMCODE",32,0)
 S XMHINT=Y
"RTN","XMJMCODE",33,0)
 Q
"RTN","XMJMCODE",34,0)
KEYOK(XMZ,XMHINT) ; Ask user for key and make sure it's right
"RTN","XMJMCODE",35,0)
 N XMKEY,XMTRY,XMOK,XMABORT
"RTN","XMJMCODE",36,0)
 I " "'[XMHINT D
"RTN","XMJMCODE",37,0)
 . U IO(0)
"RTN","XMJMCODE",38,0)
 . ;This message was scrambled with the scramble hint: '_XMHINT_'
"RTN","XMJMCODE",39,0)
 . W !,$$EZBLD^DIALOG(34620,XMHINT)
"RTN","XMJMCODE",40,0)
 S (XMOK,XMABORT)=0
"RTN","XMJMCODE",41,0)
 F XMTRY=1:1:3 D  Q:XMOK!XMABORT
"RTN","XMJMCODE",42,0)
 . D ASKKEY(.XMKEY,.XMABORT) Q:XMABORT
"RTN","XMJMCODE",43,0)
 . I $$GOODKEY(XMZ,XMKEY) S XMOK=1 Q
"RTN","XMJMCODE",44,0)
 . W *7,$$EZBLD^DIALOG(34621,XMTRY) ; "   Not the proper password.  Strike _XMTRY_.
"RTN","XMJMCODE",45,0)
 I 'XMOK,'XMABORT W $$EZBLD^DIALOG(34622) ; "  Yer out!
"RTN","XMJMCODE",46,0)
 I 'XMOK!XMABORT K XMSECURE
"RTN","XMJMCODE",47,0)
 Q 'XMABORT&XMOK
"RTN","XMJMCODE",48,0)
ASKKEY(XMKEY,XMABORT) ;
"RTN","XMJMCODE",49,0)
 F  D  Q:XMKEY'="?"!XMABORT
"RTN","XMJMCODE",50,0)
 . W !,$$EZBLD^DIALOG(34618) ; "Enter Scramble Password: "
"RTN","XMJMCODE",51,0)
 . X ^%ZOSF("EOFF") R XMKEY:15 S:'$T XMKEY=U X ^%ZOSF("EON") U IO
"RTN","XMJMCODE",52,0)
 . I XMKEY[U S XMABORT=1 Q
"RTN","XMJMCODE",53,0)
 . I $L(XMKEY)>2,$L(XMKEY)<21 Q
"RTN","XMJMCODE",54,0)
 . S XMKEY="?"
"RTN","XMJMCODE",55,0)
 . ;The scramble password is a secret code which must be entered by the
"RTN","XMJMCODE",56,0)
 . ;reader in order to see the message.  Upper and lower case characters
"RTN","XMJMCODE",57,0)
 . ;are treated the same.  (The password is not case sensitive.)
"RTN","XMJMCODE",58,0)
 . ;The password must be from 3 to 20 characters long.
"RTN","XMJMCODE",59,0)
 . W !
"RTN","XMJMCODE",60,0)
 . D BLD^DIALOG(34619,"","","XMTEXT","F")
"RTN","XMJMCODE",61,0)
 . D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMCODE",62,0)
 . W !
"RTN","XMJMCODE",63,0)
 Q
"RTN","XMJMCODE",64,0)
GOODKEY(XMZ,XMKEY) ; Function checks key and make sure it's right.
"RTN","XMJMCODE",65,0)
 ; If it is, XMSECURE is defined, and function returns 1;
"RTN","XMJMCODE",66,0)
 ; Else XMSECURE is not defined, and function returns 0
"RTN","XMJMCODE",67,0)
 D LOADCODE
"RTN","XMJMCODE",68,0)
 D ADJUST(.XMKEY)
"RTN","XMJMCODE",69,0)
 I $$ENCSTR(XMKEY)=$E($G(^XMB(3.9,XMZ,"K")),2,99) Q 1
"RTN","XMJMCODE",70,0)
 K XMSECURE
"RTN","XMJMCODE",71,0)
 Q 0
"RTN","XMJMCODE",72,0)
ADJUST(XMKEY) ; Capitalize the key, pad the key, & adjust cylinder with key
"RTN","XMJMCODE",73,0)
 N I,J,XMRW
"RTN","XMJMCODE",74,0)
 S:XMKEY?.E1L.E XMKEY=$$UP^XLFSTR(XMKEY)
"RTN","XMJMCODE",75,0)
 F  Q:$L(XMKEY)>XMSECURE  S XMKEY=XMKEY_XMKEY
"RTN","XMJMCODE",76,0)
 S XMKEY=$E(XMKEY,1,XMSECURE)
"RTN","XMJMCODE",77,0)
 S XMRW=0
"RTN","XMJMCODE",78,0)
 F I=1:1:XMSECURE S XMRW=XMRW+$A(XMKEY,I)
"RTN","XMJMCODE",79,0)
 S XMRW=XMRW#96
"RTN","XMJMCODE",80,0)
 S:$G(XMPAKMAN) XMPAKMAN("XMRW")=XMRW
"RTN","XMJMCODE",81,0)
 F I=1:1:XMSECURE D
"RTN","XMJMCODE",82,0)
 . S J=$F(XMSECURE(I),$E(XMKEY,I))-1+XMRW#40
"RTN","XMJMCODE",83,0)
 . S XMSECURE(I)=$E(XMSECURE(I),J,999)_$E(XMSECURE(I),1,J-1)
"RTN","XMJMCODE",84,0)
 Q
"RTN","XMJMCODE",85,0)
LOADCODE ; Load Bazeries Cylinder
"RTN","XMJMCODE",86,0)
 N XMLINE,I
"RTN","XMJMCODE",87,0)
 F I=1:1 S XMLINE=$P($T(Z+I),";",3,9) Q:XMLINE=""  S XMSECURE(I)=XMLINE
"RTN","XMJMCODE",88,0)
 S XMSECURE=I-1
"RTN","XMJMCODE",89,0)
 Q
"RTN","XMJMCODE",90,0)
Z ;;
"RTN","XMJMCODE",91,0)
 ;;j+?F}hmi<Q#uZ|]Jdgwb'52NBr,fP6&:{s./*E(4an)A-Y 7cKMt[Ce;OGD=op"~UL0Xy89x%1lv!VH@\>_R3zkTS$`WI^q
"RTN","XMJMCODE",92,0)
 ;;~7C|(lbZo5f&mz3*}E{ `eVtGSMN"I>WBy48K/THiu^[1Fcaqp,_L=h.j]X<AP?O$@YQ\d!rU9;:D)2gk+n%J-wR6vs'0x#
"RTN","XMJMCODE",93,0)
 ;;j+?F}hmi<Q#uZ|]Jdgwb'52NBr,fP6&:{s./*E(4an)A-Y 7cKMt[Ce;OGD=op"~UL0Xy89x%1lv!VH@\>_R3zkTS$`WI^q
"RTN","XMJMCODE",94,0)
 ;;:eR^K{=o1$+VM3qd@h8ks<W;Hzpu-wbrmTNix?7GYQSlv'*~(4a".c}g[E|%>9O#/0JIF\yj2!Ptn)_D B]C6A&`ZfX,U5L
"RTN","XMJMCODE",95,0)
 ;;CNl<v_F8sDZfGmUy&ui'%T:+z]$>OVxMw)^n.6d *ge;oY(kjHq,[QE-|WRh2~SP1/}aBLK"3J45t{cbpr09A`!7XI#?=@\
"RTN","XMJMCODE",96,0)
 ;;~7C|(lbZo5f&mz3*}E{ `eVtGSMN"I>WBy48K/THiu^[1Fcaqp,_L=h.j]X<AP?O$@YQ\d!rU9;:D)2gk+n%J-wR6vs'0x#
"RTN","XMJMCODE",97,0)
 ;;q^,M?Q$+E%:ICN"PxdHc3w_~k[-m.s/}u|5 zOh4'8#;v!`FeSV7t(2U]fJlpTa&D=96@\n>ZGiRKAX)1jr0bLBgYy*<o{W
"RTN","XMJMCODE",98,0)
 ;;`kC4xY$)*8-1o3NXJ.2 ;n0bK|=?d}g{HQUmsShGc[Ai<l>#F5Iqf9BMRpu~V&Z/a:!7TLtz6Ery,wePjD+v(_%^"O'@W\]
"RTN","XMJMCODE",99,0)
 ;; 6[2F5ETNc/mjglK0bZ<CHvp-)~IV%,=}79Y:i+r(yeGD;zJ"4'qd.sh?*on#&kM3XfA\!_S]BWLQO@U8RtP$`^|u>wx{1a
"RTN","XMJMCODE",100,0)
 ;;$7q_@*0u<\E~t(zW/QbT,3yR>v?}U1D^4:J|h{"nerGxsPH[ C'K8I2g)Ya&oZ#9dSi.kNjfB6A!`XF]l+-wpm=cMO;5L%V
"RTN","XMJMCODE",101,0)
 ;;fk&A^NROib:7sa>JIyo'Z;]H-)qx/dDX9FgwL8|01@r.pSQ6~432_5"}?<EC+UzntWG=,Vm*jK\#h!`M TcB{YvPeu(%l$[
"RTN","XMJMCODE",102,0)
 ;;(wFr,+[Lylm=RPJ:9DI)|_UNMT~;K/{8k6-% vzBj7q3'x\"ZgE*dHus#V4Ytpc!GCb1O0@WQah}25o&`$eS>fn<.Xi^?]A
"RTN","XMJMCODE",103,0)
 ;;`B8Fr{$hy]L,NeKXtc'asxbp*@nA~PiVQ -OoJ)R;/v_9}(?|UD<lMIz%\Y6Sw2C4=g&7u":+d!E#T.5k[j^1GHmZ0f>3qW
"RTN","XMJMCODE",104,0)
 ;;ex3:uFt*+L-hR$Mp4(<Y[ryl\~TK>1"'Pi7Nd}G5#/2WXInQ9|j{. 6!SJ0Oz8V%wA_D@Uvac=g,o;Hk?mb]EBq&f^`C)sZ
"RTN","XMJMCODE",105,0)
 ;;kO;/"1r?[x#EloIz.<Vpb|8WL{K&a%:tny}`Quv5h-m2U0>9M]j)fNX7S@PYD$='T_Cg!JAq+H^FGs(i,6ce Bwd*~RZ\43
"RTN","XMJMCODE",106,0)
 ;;(r{dz)P5F1H'a=sm^g"Eu-%7&\.UJxy<h q?vw*o+#2TV}W|L0QI9iXtOB:Y]e3>4$`p6fnj8cSM;Kb_Z[GC/A!@NlDkR~,
"RTN","XMJMCODE",107,0)
 ;;Z#;Fr|WdD\5=U{kf`XR0w~[A&L>}p"!mIMY4t2q8)1gx^hi K.Vco<7TJ3/*@QO(-SvB:y6N$a_bGj'Heu]l+%zsn9?P,EC
"RTN","XMJMCODE",108,0)
 ;;M|.y]37'\p6{UAz^fm4Ik"9c&gn;D#le+=VB*J8bG%Z2hQtu_>,~vW/}ji:X`NY0[w5rHq)O- LSo?a!T1KE@P<FxsR$C(d
"RTN","XMJMCODE",109,0)
 ;;|Qv<[=NC#}!zO$GtF/,KjU;W6S9rV+%@'-:R3e&D7TBq8(o.?k"g>L_Z)2*Pyx{X05diHaphb41fM]Im`\lYAncs~EwJ^ u
"RTN","XMJMCODE",110,0)
 ;;B*6IQt9jf|YH7%gdi<cO3\mN5{&'Uv1/^Gl0V)w>`z@#A4_To b]DnJx$Zyk+Ku8pCrPRSq!?:MaEs[,-=L2WFeX~;h(}."
"RTN","XMJMCODE",111,0)
 ;;
"RTN","XMJMD")
0^19^B29415386
"RTN","XMJMD",1,0)
XMJMD ;ISC-SF/GMB-Later Messages ;01/07/2000  10:18
"RTN","XMJMD",2,0)
 ;;7.1;MailMan;**50,104,110**;Jun 02, 1994
"RTN","XMJMD",3,0)
 ; Replaces ^XMB1 (ISC-WASH/THM/CAP)
"RTN","XMJMD",4,0)
 ; Entry points are:
"RTN","XMJMD",5,0)
 ; EDIT     Change/Delete Later'd messages for a particular user
"RTN","XMJMD",6,0)
 ; REPORT   Report on Later'd messages for a particular user
"RTN","XMJMD",7,0)
 ; LATER    Add/Edit Later'd Dates for a particular user/message
"RTN","XMJMD",8,0)
 ; LTRADD   Add Later'd delivery date for a particular user/message
"RTN","XMJMD",9,0)
 ; DELUSER  Delete all Later'd messages for a particular user
"RTN","XMJMD",10,0)
 ; DELMSG   Delete all Later'd dates for a particular message
"RTN","XMJMD",11,0)
 ;
"RTN","XMJMD",12,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMJMD",13,0)
 ; EDIT     XMLATER-EDIT
"RTN","XMJMD",14,0)
 ; REPORT   XMLATER-REPORT
"RTN","XMJMD",15,0)
REPORT ; Report on later'd messages
"RTN","XMJMD",16,0)
 N ZTSAVE,ZTDESC,ZTRTN,I
"RTN","XMJMD",17,0)
 D CHECK^XMVVITAE
"RTN","XMJMD",18,0)
 S ZTDESC=$$EZBLD^DIALOG(34639) ; MailMan: Report on Later'd Messages
"RTN","XMJMD",19,0)
 S ZTRTN="RPTLATER^XMJMD"
"RTN","XMJMD",20,0)
 F I="XMDUZ","XMV(""NAME"")" S ZTSAVE(I)=""
"RTN","XMJMD",21,0)
 D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE)
"RTN","XMJMD",22,0)
 Q
"RTN","XMJMD",23,0)
RPTLATER ;
"RTN","XMJMD",24,0)
 ; XMDUZ,XMV("NAME") are provided
"RTN","XMJMD",25,0)
 N XMZ,XMABORT,XMWHEN,XMIEN,XMREC,XMZREC,XMPAGE,XMLEN,XMK,XMKN
"RTN","XMJMD",26,0)
 S XMLEN("DATE")=16
"RTN","XMJMD",27,0)
 S XMLEN("XMZ")=$L($O(^XMB(3.9,":"),-1))
"RTN","XMJMD",28,0)
 S:XMLEN("XMZ")<7 XMLEN("XMZ")=7
"RTN","XMJMD",29,0)
 S XMLEN("BSKT")=10
"RTN","XMJMD",30,0)
 S XMLEN("SUBJ")=79-XMLEN("DATE")-XMLEN("XMZ")-XMLEN("BSKT")-6
"RTN","XMJMD",31,0)
 S (XMPAGE,XMABORT)=0
"RTN","XMJMD",32,0)
 W:IOST["C-" @IOF
"RTN","XMJMD",33,0)
 D RPTHDR(.XMLEN,.XMPAGE)
"RTN","XMJMD",34,0)
 S XMIEN=""
"RTN","XMJMD",35,0)
 F  S XMIEN=$O(^XMB(3.73,"C",XMDUZ,XMIEN)) Q:XMIEN=""  D  Q:XMABORT
"RTN","XMJMD",36,0)
 . S XMREC=$G(^XMB(3.73,XMIEN,0)) I XMREC="" K ^XMB(3.73,"C",XMDUZ,XMIEN) Q
"RTN","XMJMD",37,0)
 . S XMZ=$P(XMREC,U,3)
"RTN","XMJMD",38,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0)) I XMZREC="" D DELDATE(XMIEN) Q
"RTN","XMJMD",39,0)
 . S XMWHEN=$P(XMREC,U,1)
"RTN","XMJMD",40,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMJMD",41,0)
 . S XMKN=$S('XMK:$$EZBLD^DIALOG(34014),1:$P($G(^XMB(3.7,XMDUZ,2,XMK,0)),U)) ; * N/A *
"RTN","XMJMD",42,0)
 . I $Y+3>IOSL D  Q:XMABORT
"RTN","XMJMD",43,0)
 . . I IOST["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJMD",44,0)
 . . W @IOF D RPTHDR(.XMLEN,.XMPAGE)
"RTN","XMJMD",45,0)
 . W !,$$LJ^XLFSTR($$FMTE^XLFDT($E(XMWHEN,1,12),5),XMLEN("DATE")),"  ",$$LJ^XLFSTR($E(XMKN,1,XMLEN("BSKT")),XMLEN("BSKT")),"  ",$J(XMZ,XMLEN("XMZ")),"  ",$E($$SUBJ^XMXUTIL2(XMZREC),1,XMLEN("SUBJ"))
"RTN","XMJMD",46,0)
 W:$O(^XMB(3.73,"C",XMDUZ,""))="" !,$$EZBLD^DIALOG(34630) ; No Later'd Messages
"RTN","XMJMD",47,0)
 I IOST["C-",'XMABORT D WAIT^XMXUTIL
"RTN","XMJMD",48,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMJMD",49,0)
 Q
"RTN","XMJMD",50,0)
RPTHDR(XMLEN,XMPAGE) ;
"RTN","XMJMD",51,0)
 S XMPAGE=XMPAGE+1
"RTN","XMJMD",52,0)
 W $$EZBLD^DIALOG(34631,XMV("NAME")),?70,$$EZBLD^DIALOG(34542,XMPAGE) ; Later'd Messages Report for: / Page
"RTN","XMJMD",53,0)
 W !,$$LJ^XLFSTR($$EZBLD^DIALOG(34632),XMLEN("DATE")),"  ",$$LJ^XLFSTR($$EZBLD^DIALOG(34011),XMLEN("BSKT")),"  ",$$RJ^XLFSTR($$EZBLD^DIALOG(34633),XMLEN("XMZ")),"  ",$$EZBLD^DIALOG(34002) ; Date / Basket / Msg ID / Subject
"RTN","XMJMD",54,0)
 W !,$$REPEAT^XLFSTR("-",79)
"RTN","XMJMD",55,0)
 Q
"RTN","XMJMD",56,0)
DELUSER(XMDUZ) ; Delete all Later'd messages for a particular user
"RTN","XMJMD",57,0)
 N XMIEN
"RTN","XMJMD",58,0)
 S XMIEN=""
"RTN","XMJMD",59,0)
 F  S XMIEN=$O(^XMB(3.73,"C",XMDUZ,XMIEN)) Q:XMIEN=""  D DELDATE(XMIEN)
"RTN","XMJMD",60,0)
 Q
"RTN","XMJMD",61,0)
DELDATE(XMIEN) ; Delete a particular Later'd message date
"RTN","XMJMD",62,0)
 N DIK
"RTN","XMJMD",63,0)
 S DIK="^XMB(3.73,",DA=XMIEN
"RTN","XMJMD",64,0)
 D ^DIK
"RTN","XMJMD",65,0)
 Q
"RTN","XMJMD",66,0)
DELMSG(XMZ) ; Delete all Later'd dates for a particular message
"RTN","XMJMD",67,0)
 N XMDUZ,XMIEN
"RTN","XMJMD",68,0)
 S (XMDUZ,XMIEN)=""
"RTN","XMJMD",69,0)
 F  S XMDUZ=$O(^XMB(3.73,"AC",XMZ,XMDUZ)) Q:XMDUZ=""  D
"RTN","XMJMD",70,0)
 . F  S XMIEN=$O(^XMB(3.73,"AC",XMZ,XMDUZ,XMIEN)) Q:XMIEN=""  D DELDATE(XMIEN)
"RTN","XMJMD",71,0)
 Q
"RTN","XMJMD",72,0)
LATER(XMDUZ,XMZ) ; For a particular message,
"RTN","XMJMD",73,0)
 ; let user edit any existing latered times or add a new one.
"RTN","XMJMD",74,0)
 N XMABORT,XMWHEN
"RTN","XMJMD",75,0)
 S XMABORT=0
"RTN","XMJMD",76,0)
 I $D(^XMB(3.73,"AC",XMZ,XMDUZ)) D
"RTN","XMJMD",77,0)
 . W @IOF
"RTN","XMJMD",78,0)
 . D LATER^XMJMQ(XMDUZ,XMZ,"","","","",.XMABORT)
"RTN","XMJMD",79,0)
 . S XMABORT=0
"RTN","XMJMD",80,0)
 . N DIR,XMIEN,XMADD,XMCHG,XMDEL
"RTN","XMJMD",81,0)
 . S XMIEN=$O(^XMB(3.73,"AC",XMZ,XMDUZ,0))
"RTN","XMJMD",82,0)
 . I $O(^XMB(3.73,"AC",XMZ,XMDUZ,XMIEN)) S XMIEN=0
"RTN","XMJMD",83,0)
 . S XMADD=$$EZBLD^DIALOG(34634) ; A:Add another date on which this message should appear new
"RTN","XMJMD",84,0)
 . S XMCHG=$$EZBLD^DIALOG($S(XMIEN:34635,1:34635.1)) ; C:Change this / a date
"RTN","XMJMD",85,0)
 . S XMDEL=$$EZBLD^DIALOG($S(XMIEN:34636,1:34636.1)) ; D:Delete this / a date
"RTN","XMJMD",86,0)
 . S DIR(0)="SO^"_XMADD_";"_XMCHG_";"_XMDEL
"RTN","XMJMD",87,0)
 . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMD",88,0)
 . I Y=$P(XMADD,":",1) D  Q
"RTN","XMJMD",89,0)
 . . D LTRDATE(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",90,0)
 . . D LTRADD(XMDUZ,XMZ,XMWHEN)
"RTN","XMJMD",91,0)
 . I 'XMIEN D WHICH(XMDUZ,XMZ,.XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",92,0)
 . I Y=$P(XMCHG,":",1) D CHGDATE(XMIEN) Q
"RTN","XMJMD",93,0)
 . D DELDATE(XMIEN) ; Delete this date
"RTN","XMJMD",94,0)
 . W $$EZBLD^DIALOG(34637) ; " ... deleted."
"RTN","XMJMD",95,0)
 E  D
"RTN","XMJMD",96,0)
 . D LTRDATE(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",97,0)
 . D LTRADD(XMDUZ,XMZ,XMWHEN)
"RTN","XMJMD",98,0)
 Q
"RTN","XMJMD",99,0)
EDIT ; Change/delete later'd messages
"RTN","XMJMD",100,0)
 I '$D(^XMB(3.73,"C",XMDUZ)) W !!,*7,$$EZBLD^DIALOG(34638) Q  ; You have no Later'd messages.
"RTN","XMJMD",101,0)
 D LTREDIT($G(XMDUZ,DUZ))
"RTN","XMJMD",102,0)
 Q
"RTN","XMJMD",103,0)
LTREDIT(XMDUZ,XMZ) ;
"RTN","XMJMD",104,0)
 N X,Y,XMIEN,XMDEL,DIR,DIE,DR,DA,DIRUT,XMABORT
"RTN","XMJMD",105,0)
 S XMABORT=0
"RTN","XMJMD",106,0)
 D WHICH(XMDUZ,.XMZ,.XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMD",107,0)
 ; The user has chosen a record to edit (and change the later'd date)
"RTN","XMJMD",108,0)
 S XMDEL=$$EZBLD^DIALOG(34636) ; D:Delete this date
"RTN","XMJMD",109,0)
 S DIR(0)="S^"_$$EZBLD^DIALOG(34635)_";"_XMDEL ; C:Change this date
"RTN","XMJMD",110,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMD",111,0)
 I Y=$P(XMDEL,":",1) D  Q
"RTN","XMJMD",112,0)
 . D DELDATE(XMIEN) ; Delete this date
"RTN","XMJMD",113,0)
 . W $$EZBLD^DIALOG(34637) ; " ... deleted."
"RTN","XMJMD",114,0)
 K DIR,X,Y,DIRUT
"RTN","XMJMD",115,0)
 D CHGDATE(XMIEN) ; Change this date
"RTN","XMJMD",116,0)
 Q
"RTN","XMJMD",117,0)
WHICH(XMDUZ,XMZ,XMIEN,XMABORT) ;
"RTN","XMJMD",118,0)
 N DIC,D,X,Y
"RTN","XMJMD",119,0)
 W !
"RTN","XMJMD",120,0)
 S DIC="^XMB(3.73,"
"RTN","XMJMD",121,0)
 S DIC(0)="NEU"
"RTN","XMJMD",122,0)
 S D="C"
"RTN","XMJMD",123,0)
 I $D(XMZ) S DIC("S")="I $D(^XMB(3.73,""AC"","_XMZ_","_$G(XMDUZ,DUZ)_",Y))"
"RTN","XMJMD",124,0)
 E  S DIC("S")="I $D(^XMB(3.73,""C"","_$G(XMDUZ,DUZ)_",Y))"
"RTN","XMJMD",125,0)
 S X=$G(XMDUZ,DUZ)
"RTN","XMJMD",126,0)
 D IX^DIC I Y=-1 S XMABORT=1 Q
"RTN","XMJMD",127,0)
 S XMIEN=+Y
"RTN","XMJMD",128,0)
 Q
"RTN","XMJMD",129,0)
CHGDATE(DA) ; Change a date
"RTN","XMJMD",130,0)
 N DIE,DR,DIDEL
"RTN","XMJMD",131,0)
 S DIDEL=3.73
"RTN","XMJMD",132,0)
 S DIE=3.73
"RTN","XMJMD",133,0)
 S DR=.01
"RTN","XMJMD",134,0)
 D ^DIE
"RTN","XMJMD",135,0)
 Q
"RTN","XMJMD",136,0)
LTRDATE(Y,XMABORT) ;
"RTN","XMJMD",137,0)
 N DIR
"RTN","XMJMD",138,0)
 S DIR(0)="3.73,.01"
"RTN","XMJMD",139,0)
 S DIR("B")="T+1"
"RTN","XMJMD",140,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMD",141,0)
 Q
"RTN","XMJMD",142,0)
LTRADD(XMDUZ,XMZ,XMWHEN) ;
"RTN","XMJMD",143,0)
 N XMFDA
"RTN","XMJMD",144,0)
 Q:$D(^XMB(3.73,"AB",XMWHEN,XMDUZ,XMZ))  ; Already scheduled?
"RTN","XMJMD",145,0)
 S XMFDA(3.73,"+1,",.01)=XMWHEN
"RTN","XMJMD",146,0)
 ;S XMFDA(3.73,"+1,",1)=XMDUZ  Not needed, because done by trigger
"RTN","XMJMD",147,0)
 S XMFDA(3.73,"+1,",2)=XMZ
"RTN","XMJMD",148,0)
 D UPDATE^DIE("","XMFDA")
"RTN","XMJMD",149,0)
 Q
"RTN","XMJMD",150,0)
 ;
"RTN","XMJMD",151,0)
 ;#34002 = Subject
"RTN","XMJMD",152,0)
 ;#34011 = Basket
"RTN","XMJMFA")
0^8^B14710003
"RTN","XMJMFA",1,0)
XMJMFA ;ISC-SF/GMB-Search: Subject starts with ;12/21/99  15:49
"RTN","XMJMFA",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMFA",3,0)
 ; Search for message subjects that partial match input.
"RTN","XMJMFA",4,0)
 ; Replaces ^XMA03 (ISC-WASH/CAP/THM)
"RTN","XMJMFA",5,0)
FIND(XMDUZ,XMSTRING,XMWAIT) ;
"RTN","XMJMFA",6,0)
 N XMKZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMMORE,XMFLAGS,XMSCREEN,XMFROM,XMZOOM,XMCD,XMOPT,XMOX
"RTN","XMJMFA",7,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFA",8,0)
 S (XMKZ,XMZ,XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1,XMPMAX=IOSL-3
"RTN","XMJMFA",9,0)
 D INIT(XMDUZ,XMDETAIL,.XMLEN,.XMFLAGS,.XMSCREEN)
"RTN","XMJMFA",10,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMFA",11,0)
 F  D  Q:XMABORT
"RTN","XMJMFA",12,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT(XMDUZ,XMDETAIL,.XMLEN,.XMSCREEN)
"RTN","XMJMFA",13,0)
 . D DISPLAY(XMDUZ,XMSTRING,XMFLAGS,XMSCREEN,.XMFROM,XMDETAIL,.XMKZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMFA",14,0)
 . I XMCNT=0 S XMABORT=1 Q
"RTN","XMJMFA",15,0)
 . D CHOOSE^XMJMLN(XMDUZ,1,0,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG^XMJMFA",.XMABORT)
"RTN","XMJMFA",16,0)
 . S:'$D(^TMP("XM",$J,"MSG")) XMABORT=1
"RTN","XMJMFA",17,0)
 I XMCNT=0 D
"RTN","XMJMFA",18,0)
 . W $$EZBLD^DIALOG(34401) ;   No matches found.
"RTN","XMJMFA",19,0)
 . Q:'$G(XMWAIT)
"RTN","XMJMFA",20,0)
 . W ! D WAIT^XMXUTIL
"RTN","XMJMFA",21,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFA",22,0)
 Q
"RTN","XMJMFA",23,0)
INIT(XMDUZ,XMDETAIL,XMLEN,XMFLAGS,XMSCREEN) ;
"RTN","XMJMFA",24,0)
 S XMLEN("BSKT")=10
"RTN","XMJMFA",25,0)
 S XMLEN("XMKZ")=3
"RTN","XMJMFA",26,0)
 D INIT^XMJML(XMDUZ,"","",XMDETAIL,.XMLEN)
"RTN","XMJMFA",27,0)
 S XMSCREEN="",XMFLAGS=$S(XMV("ORDER")=-1:"B",1:"")
"RTN","XMJMFA",28,0)
 I XMDUZ=.5 S XMFLAGS=XMFLAGS_"U" Q  ; Ignore file screen
"RTN","XMJMFA",29,0)
 S XMSCREEN=XMSCREEN_"N X S X=^(0)"
"RTN","XMJMFA",30,0)
 N XMMIN
"RTN","XMJMFA",31,0)
 S XMMIN=$P(^XMB(3.7,XMDUZ,0),U,7)
"RTN","XMJMFA",32,0)
 ; If minimum date, don't choose lower date unless already in user's bskt
"RTN","XMJMFA",33,0)
 I XMMIN>0 S XMSCREEN=" I ^(.6)'<"_XMMIN_"!$D(^XMB(3.7,""M"",Y,XMDUZ))"
"RTN","XMJMFA",34,0)
 ; Msg must not be SPOOL, msg must not be a reply.
"RTN","XMJMFA",35,0)
 S XMSCREEN=XMSCREEN_" I $P(X,U,7)'=""S"",$S($P(X,U,8):0,$P(X,U)?1""R"".N:0,1:1)"
"RTN","XMJMFA",36,0)
 Q
"RTN","XMJMFA",37,0)
DISPLAY(XMDUZ,XMSTRING,XMFLAGS,XMSCREEN,XMFROM,XMDETAIL,XMKZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMFA",38,0)
 N XMREC
"RTN","XMJMFA",39,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMFA",40,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN)
"RTN","XMJMFA",41,0)
 I XMZOOM D  Q
"RTN","XMJMFA",42,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFA",43,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFA",44,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFA",45,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFA",46,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFA",47,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFA",48,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMFA",49,0)
 ; File screen ^DD(3.9,0,"SCR") insists that user be author or recipient.
"RTN","XMJMFA",50,0)
 ; If FLAGS["U", then file screen is ignored.
"RTN","XMJMFA",51,0)
 D LIST^DIC(3.9,"","",XMFLAGS,XMPMAX-$Y+1,.XMFROM,XMSTRING,"",XMSCREEN)
"RTN","XMJMFA",52,0)
 S:$P(^TMP("DILIST",$J,0),U,3)=0 XMMORE=0
"RTN","XMJMFA",53,0)
 D LISTMSG(XMDUZ,XMDETAIL,.XMCNT,.XMLEN)
"RTN","XMJMFA",54,0)
 S XMKZ=XMCNT
"RTN","XMJMFA",55,0)
 K ^TMP("DILIST",$J)
"RTN","XMJMFA",56,0)
 W:'XMMORE !,$$EZBLD^DIALOG(34402) ; Search finished.
"RTN","XMJMFA",57,0)
 Q
"RTN","XMJMFA",58,0)
LISTMSG(XMDUZ,XMDETAIL,XMCNT,XMLEN) ; Check and List
"RTN","XMJMFA",59,0)
 N XMK,XMKN,XMZ,I
"RTN","XMJMFA",60,0)
 S I=""
"RTN","XMJMFA",61,0)
 F  S I=$O(^TMP("DILIST",$J,2,I),XMV("ORDER")) Q:I'>0  D
"RTN","XMJMFA",62,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMFA",63,0)
 . S XMZ=^TMP("DILIST",$J,2,I)
"RTN","XMJMFA",64,0)
 . S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFA",65,0)
 . S XMKN=$S(XMK:$P(^XMB(3.7,XMDUZ,2,XMK,0),U),1:$$EZBLD^DIALOG(34014)) ; * N/A *
"RTN","XMJMFA",66,0)
 . I XMK,'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITM^XMUT4A(XMDUZ,XMK,XMZ)
"RTN","XMJMFA",67,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMCNT,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMFA",68,0)
 . S ^TMP("XM",$J,"MSG",XMCNT)=XMK_U_XMKN_U_XMZ
"RTN","XMJMFA",69,0)
 Q
"RTN","XMJMFA",70,0)
READMSG ; (XMDUZ,XMKZ,XMREC) <- needed!
"RTN","XMJMFA",71,0)
 N XMK,XMKN,XMZ,XMRDR  ; $G(XMRDR) is checked in READMSG^XMJBM
"RTN","XMJMFA",72,0)
 S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2),XMZ=$P(XMREC,U,3)
"RTN","XMJMFA",73,0)
 I XMDUZ=.5,'XMK,'$$ACCESS^XMXSEC(XMDUZ,XMZ,$G(^XMB(3.9,XMZ,0))) D  Q
"RTN","XMJMFA",74,0)
 . D SHOW^XMJERR
"RTN","XMJMFA",75,0)
 . D WAIT^XMXUTIL
"RTN","XMJMFA",76,0)
 D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMFA",77,0)
 Q:$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK))
"RTN","XMJMFA",78,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFA",79,0)
 S ^TMP("XM",$J,"MSG",XMKZ)=XMK_U_$S(XMK=0:$$EZBLD^DIALOG(34014),1:$P(^XMB(3.7,XMDUZ,2,XMK,0),U))_U_XMZ ; * N/A *
"RTN","XMJMFA",80,0)
 Q
"RTN","XMJMFB")
0^9^B65353970
"RTN","XMJMFB",1,0)
XMJMFB ;ISC-SF/GMB-Find message: multiple conditions ;12/21/99  15:52
"RTN","XMJMFB",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMFB",3,0)
 ; Replaces ^XMAL0,^XMAL0A (ISC-WASH/JSH/CAP)
"RTN","XMJMFB",4,0)
 ; XMF("BSKT")  =number - Look in this basket ONLY
"RTN","XMJMFB",5,0)
 ;              =*      - Look in all baskets
"RTN","XMJMFB",6,0)
 ; XMF("SUBJ")  Subject contains this string
"RTN","XMJMFB",7,0)
 ; XMF("SUBJ","S") Look for this string in the subject
"RTN","XMJMFB",8,0)
 ; XMF("FROM")  Message is from this person
"RTN","XMJMFB",9,0)
 ; XMF("TO")    Message is to this person
"RTN","XMJMFB",10,0)
 ; XMF("FDATE") Message was sent on or after this date
"RTN","XMJMFB",11,0)
 ; XMF("TDATE") Message was sent on or before this date
"RTN","XMJMFB",12,0)
 ; XMF("RFROM") Message has a response from this person
"RTN","XMJMFB",13,0)
 ; XMF("TEXT")  Message contains this string
"RTN","XMJMFB",14,0)
 ; XMF("TEXT","S") Look for this string in the message
"RTN","XMJMFB",15,0)
 ; XMF("TEXT","L") =1 - Look in message only
"RTN","XMJMFB",16,0)
 ;                 =2 - Look in both message and responses
"RTN","XMJMFB",17,0)
 ;                 =3 - Look in responses only
"RTN","XMJMFB",18,0)
 ; XMF("TEXT","C") =0 - Search is not case-sensitive
"RTN","XMJMFB",19,0)
 ;                 =1 - Search is case-sensitive
"RTN","XMJMFB",20,0)
FIND1(XMDUZ,XMF,XMWAIT) ;
"RTN","XMJMFB",21,0)
 N XMK,XMKN,XMKZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMMORE,XMZOOM,XMCD,XMOPT,XMOX
"RTN","XMJMFB",22,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",23,0)
 S XMKZ="",(XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1,XMPMAX=IOSL-3
"RTN","XMJMFB",24,0)
 D INIT1(XMDUZ,.XMF,XMDETAIL,XMPMAX,.XMK,.XMKN,.XMLEN)
"RTN","XMJMFB",25,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMFB",26,0)
 F  D  Q:XMABORT
"RTN","XMJMFB",27,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT1(XMDUZ,.XMF,XMDETAIL,XMPMAX,.XMK,.XMKN,.XMLEN)
"RTN","XMJMFB",28,0)
 . D DISPLAY1(XMDUZ,.XMF,XMDETAIL,.XMK,XMKN,.XMKZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMFB",29,0)
 . I XMCNT=0 S XMABORT=1 Q
"RTN","XMJMFB",30,0)
 . D CHOOSE^XMJMLN(XMDUZ,0,XMK,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG^XMJMFB",.XMABORT)
"RTN","XMJMFB",31,0)
 . S:'$D(^TMP("XM",$J,"MSG")) XMABORT=1
"RTN","XMJMFB",32,0)
 I XMCNT=0 D
"RTN","XMJMFB",33,0)
 . W *7,$$EZBLD^DIALOG(34401) ;   No matches found.
"RTN","XMJMFB",34,0)
 . Q:'$G(XMWAIT)
"RTN","XMJMFB",35,0)
 . W ! D WAIT^XMXUTIL
"RTN","XMJMFB",36,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",37,0)
 Q
"RTN","XMJMFB",38,0)
INIT1(XMDUZ,XMF,XMDETAIL,XMPMAX,XMK,XMKN,XMLEN) ;
"RTN","XMJMFB",39,0)
 S:$D(XMF("SUBJ")) XMF("SUBJ","S")=$$UP^XLFSTR(XMF("SUBJ"))
"RTN","XMJMFB",40,0)
 S:$D(XMF("TEXT")) XMF("TEXT","S")=$S('XMF("TEXT","C"):$$UP^XLFSTR(XMF("TEXT")),1:XMF("TEXT"))
"RTN","XMJMFB",41,0)
 S XMK=XMF("BSKT")
"RTN","XMJMFB",42,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMFB",43,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMFB",44,0)
 Q
"RTN","XMJMFB",45,0)
DISPLAY1(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMFB",46,0)
 N XMREC,XMZ
"RTN","XMJMFB",47,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMFB",48,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,XMDUZ,XMK,XMKN)
"RTN","XMJMFB",49,0)
 I XMZOOM D  Q
"RTN","XMJMFB",50,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",51,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",52,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",53,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",54,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",55,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",56,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMFB",57,0)
 D CHKNLST1(XMDUZ,.XMF,XMDETAIL,XMK,XMKN,.XMKZ,.XMCNT,XMPMAX,.XMLEN)
"RTN","XMJMFB",58,0)
 S:XMKZ'>0 XMMORE=0
"RTN","XMJMFB",59,0)
 W:'XMMORE !,$$EZBLD^DIALOG(34402) ; Search finished.
"RTN","XMJMFB",60,0)
 Q
"RTN","XMJMFB",61,0)
CHKNLST1(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZ,XMCNT,XMPMAX,XMLEN) ; Check and List
"RTN","XMJMFB",62,0)
 N XMZ
"RTN","XMJMFB",63,0)
 S:XMKZ="" XMKZ=$O(^TMP("XM",$J,"MSG",""),-XMV("ORDER"))
"RTN","XMJMFB",64,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:XMKZ'>0  D  Q:$Y>XMPMAX
"RTN","XMJMFB",65,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,0))
"RTN","XMJMFB",66,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJMFB",67,0)
 . Q:'$$GOODMSG(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMJMFB",68,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMFB",69,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMFB",70,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=XMK_U_XMKN_U_XMZ
"RTN","XMJMFB",71,0)
 Q
"RTN","XMJMFB",72,0)
FINDALL(XMDUZ,XMF) ;
"RTN","XMJMFB",73,0)
 N XMK,XMKN,XMKZZ,XMKZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMMORE,XMZOOM,XMCD,XMOPT,XMOX
"RTN","XMJMFB",74,0)
 S (XMKZ,XMKZZ)="",(XMK,XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1,XMPMAX=IOSL-3
"RTN","XMJMFB",75,0)
 D INITA(XMDUZ,.XMF,.XMK,.XMKN,.XMKZZ,.XMLEN,.XMABORT) Q:XMABORT
"RTN","XMJMFB",76,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMFB",77,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",78,0)
 F  D  Q:XMABORT
"RTN","XMJMFB",79,0)
 . D DISPLAYA(XMDUZ,.XMF,.XMDETAIL,.XMK,XMKN,.XMKZZ,.XMKZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMFB",80,0)
 . D CHOOSE^XMJMLN(XMDUZ,1,0,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG^XMJMFB",.XMABORT)
"RTN","XMJMFB",81,0)
 . S:'$D(^TMP("XM",$J,"MSG")) XMABORT=1
"RTN","XMJMFB",82,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMFB",83,0)
 Q
"RTN","XMJMFB",84,0)
INITA(XMDUZ,XMF,XMK,XMKN,XMKZZ,XMLEN,XMABORT) ;
"RTN","XMJMFB",85,0)
 S:$D(XMF("SUBJ")) XMF("SUBJ","S")=$$UP^XLFSTR(XMF("SUBJ"))
"RTN","XMJMFB",86,0)
 S:$D(XMF("TEXT")) XMF("TEXT","S")=$S('XMF("TEXT","C"):$$UP^XLFSTR(XMF("TEXT")),1:XMF("TEXT"))
"RTN","XMJMFB",87,0)
 S XMLEN("XMKZ")=0
"RTN","XMJMFB",88,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:XMK'>0  D  Q:$D(XMKN)
"RTN","XMJMFB",89,0)
 . F  S XMKZZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ),XMV("ORDER")) Q:XMKZZ'>0  D  Q:$D(XMKN)
"RTN","XMJMFB",90,0)
 . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ,0))
"RTN","XMJMFB",91,0)
 . . Q:'$$GOODMSG(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMJMFB",92,0)
 . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMFB",93,0)
 I $D(XMKN) S XMKZZ=XMKZZ-XMV("ORDER") Q
"RTN","XMJMFB",94,0)
 S XMABORT=1
"RTN","XMJMFB",95,0)
 W *7,$$EZBLD^DIALOG(34401),! ;   No matches found.
"RTN","XMJMFB",96,0)
 D WAIT^XMXUTIL
"RTN","XMJMFB",97,0)
 Q
"RTN","XMJMFB",98,0)
DISPLAYA(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZZ,XMKZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMFB",99,0)
 N XMREC,XMZ
"RTN","XMJMFB",100,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMFB",101,0)
 I XMCD D
"RTN","XMJMFB",102,0)
 . S XMCD=0,XMDETAIL='XMDETAIL
"RTN","XMJMFB",103,0)
 . D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN)
"RTN","XMJMFB",104,0)
 E  I $L(XMCNT+XMPMAX)>XMLEN("XMKZ") D
"RTN","XMJMFB",105,0)
 . S XMLEN("XMKZ")=$L(XMCNT+XMPMAX)
"RTN","XMJMFB",106,0)
 . D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN)
"RTN","XMJMFB",107,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN)
"RTN","XMJMFB",108,0)
 I XMZOOM D  Q
"RTN","XMJMFB",109,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",110,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",111,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",112,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMFB",113,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMFB",114,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMFB",115,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMFB",116,0)
 S XMK=XMK-.01
"RTN","XMJMFB",117,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,2,XMK)) Q:XMK'>0  D  Q:$Y>XMPMAX
"RTN","XMJMFB",118,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMFB",119,0)
 . D CHKNLSTA(XMDUZ,.XMF,XMDETAIL,XMK,XMKN,.XMKZZ,.XMCNT,XMPMAX,.XMLEN)
"RTN","XMJMFB",120,0)
 I XMK'>0,XMKZZ'>0 S XMMORE=0
"RTN","XMJMFB",121,0)
 S XMKZ=XMCNT
"RTN","XMJMFB",122,0)
 W:'XMMORE !,$$EZBLD^DIALOG(34402) ; Search finished.
"RTN","XMJMFB",123,0)
 Q
"RTN","XMJMFB",124,0)
CHKNLSTA(XMDUZ,XMF,XMDETAIL,XMK,XMKN,XMKZZ,XMCNT,XMPMAX,XMLEN) ; Check and List
"RTN","XMJMFB",125,0)
 N XMZ
"RTN","XMJMFB",126,0)
 F  S XMKZZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ),XMV("ORDER")) Q:XMKZZ'>0  D  Q:$Y>XMPMAX
"RTN","XMJMFB",127,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZZ,0))
"RTN","XMJMFB",128,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZZ)
"RTN","XMJMFB",129,0)
 . Q:'$$GOODMSG(XMDUZ,XMK,XMZ,.XMF)
"RTN","XMJMFB",130,0)
 . I $L(XMKN)>$G(XMLEN("BSKT")) D
"RTN","XMJMFB",131,0)
 . . S XMLEN("BSKT")=$$MIN^XLFMTH($L(XMKN),10)
"RTN","XMJMFB",132,0)
 . . D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN)
"RTN","XMJMFB",133,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMFB",134,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMCNT,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMFB",135,0)
 . S ^TMP("XM",$J,"MSG",XMCNT)=XMK_U_XMKN_U_XMZ
"RTN","XMJMFB",136,0)
 Q
"RTN","XMJMFB",137,0)
GOODMSG(XMDUZ,XMK,XMZ,XMF) ;
"RTN","XMJMFB",138,0)
 N XMZREC,XMNOGOOD,XMZFROM,XMZDATE
"RTN","XMJMFB",139,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMFB",140,0)
 I XMZREC="" D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q 0
"RTN","XMJMFB",141,0)
 I $D(XMF("SUBJ")),$$UP^XLFSTR($P(XMZREC,U,1))'[XMF("SUBJ","S") Q 0
"RTN","XMJMFB",142,0)
 I $D(XMF("FROM")) Q:'$$GOODFROM(XMZREC,XMF("FROM")) 0
"RTN","XMJMFB",143,0)
 I $D(XMF("FDATE"))!$D(XMF("TDATE")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",144,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",145,0)
 . S XMZDATE=$P(XMZREC,U,3)
"RTN","XMJMFB",146,0)
 . S:XMZDATE'=+XMZDATE XMZDATE=$$CONVERT^XMXUTIL1(XMZDATE)
"RTN","XMJMFB",147,0)
 . S XMZDATE=$P(XMZDATE,".")
"RTN","XMJMFB",148,0)
 . I $D(XMF("FDATE")),XMZDATE<XMF("FDATE") Q
"RTN","XMJMFB",149,0)
 . I $D(XMF("TDATE")),XMF("TDATE")<XMZDATE Q
"RTN","XMJMFB",150,0)
 . S XMNOGOOD=0
"RTN","XMJMFB",151,0)
 I $D(XMF("TO")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",152,0)
 . I $D(^XMB(3.9,XMZ,6,"B",XMF("TO"))) S XMNOGOOD=0 Q
"RTN","XMJMFB",153,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",154,0)
 . Q:XMF("TO")'["@"
"RTN","XMJMFB",155,0)
 . N XMTOX,XMTO
"RTN","XMJMFB",156,0)
 . S XMTO=""
"RTN","XMJMFB",157,0)
 . F  S XMTO=$O(^XMB(3.9,XMZ,6,"B",XMTO)) Q:XMTO=""  D  Q:'XMNOGOOD
"RTN","XMJMFB",158,0)
 . . Q:XMTO'["@"
"RTN","XMJMFB",159,0)
 . . S XMTOX=$$UP^XLFSTR(XMTO)
"RTN","XMJMFB",160,0)
 . . Q:$P(XMTOX,"@")'[$P(XMF("TO"),"@")
"RTN","XMJMFB",161,0)
 . . Q:$P(XMTOX,"@",2)'[$P(XMF("TO"),"@",2)
"RTN","XMJMFB",162,0)
 . . S XMNOGOOD=0
"RTN","XMJMFB",163,0)
 I $D(XMF("RFROM")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",164,0)
 . N XMIEN,XMZR
"RTN","XMJMFB",165,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",166,0)
 . S XMIEN=0
"RTN","XMJMFB",167,0)
 . F  S XMIEN=$O(^XMB(3.9,XMZ,3,XMIEN)) Q:'XMIEN  S XMZR=^(XMIEN,0) I $$GOODFROM($G(^XMB(3.9,XMZR,0)),XMF("RFROM")) S XMNOGOOD=0 Q
"RTN","XMJMFB",168,0)
 I $D(XMF("TEXT")) D  Q:XMNOGOOD 0
"RTN","XMJMFB",169,0)
 . S XMNOGOOD=1
"RTN","XMJMFB",170,0)
 . I XMF("TEXT","L")<3 D  Q:XMF("TEXT","L")=1!(XMNOGOOD=0)
"RTN","XMJMFB",171,0)
 . . S:$$GOODTEXT(XMZ,XMF("TEXT","S"),XMF("TEXT","C")) XMNOGOOD=0
"RTN","XMJMFB",172,0)
 . N XMIEN,XMZR
"RTN","XMJMFB",173,0)
 . S XMIEN=0
"RTN","XMJMFB",174,0)
 . F  S XMIEN=$O(^XMB(3.9,XMZ,3,XMIEN)) Q:'XMIEN  S XMZR=^(XMIEN,0) I $$GOODTEXT(XMZR,XMF("TEXT","S"),XMF("TEXT","C")) S XMNOGOOD=0 Q
"RTN","XMJMFB",175,0)
 Q 1
"RTN","XMJMFB",176,0)
GOODFROM(XMZREC,XMF) ; Returns 1 if msg is from XMF; 0 if not
"RTN","XMJMFB",177,0)
 N XMZFROM
"RTN","XMJMFB",178,0)
 S XMZFROM=$P(XMZREC,U,2)
"RTN","XMJMFB",179,0)
 I XMF=+XMF,XMF=XMZFROM Q 1
"RTN","XMJMFB",180,0)
 Q:XMF'["@" 0
"RTN","XMJMFB",181,0)
 S XMZFROM=$$UP^XLFSTR(XMZFROM)
"RTN","XMJMFB",182,0)
 Q:$P(XMZFROM,"@")'[$P(XMF,"@") 0
"RTN","XMJMFB",183,0)
 Q:$P(XMZFROM,"@",2)'[$P(XMF,"@",2) 0
"RTN","XMJMFB",184,0)
 Q 1
"RTN","XMJMFB",185,0)
GOODTEXT(XMZ,XMF,XMFMATTR) ; Returns positive number if msg contains XMF; 0 if not
"RTN","XMJMFB",186,0)
 N I
"RTN","XMJMFB",187,0)
 S I=.999999
"RTN","XMJMFB",188,0)
 I XMFMATTR D
"RTN","XMJMFB",189,0)
 . F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  Q:^(I,0)[XMF
"RTN","XMJMFB",190,0)
 E  D
"RTN","XMJMFB",191,0)
 . F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:'I  Q:$$UP^XLFSTR(^(I,0))[XMF
"RTN","XMJMFB",192,0)
 Q +I
"RTN","XMJMFB",193,0)
READMSG ; (XMDUZ,XMKZ,XMREC) <- needed!
"RTN","XMJMFB",194,0)
 N XMK,XMKN,XMZ,XMRDR  ; $G(XMRDR) is checked in READMSG^XMJBM
"RTN","XMJMFB",195,0)
 S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2),XMZ=$P(XMREC,U,3)
"RTN","XMJMFB",196,0)
 D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMFB",197,0)
 Q:$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK))
"RTN","XMJMFB",198,0)
 I XMF("BSKT")=XMK K ^TMP("XM",$J,"MSG",XMKZ) Q
"RTN","XMJMFB",199,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMFB",200,0)
 S ^TMP("XM",$J,"MSG",XMKZ)=XMK_U_$S(XMK=0:$$EZBLD^DIALOG(34014),1:$P(^XMB(3.7,XMDUZ,2,XMK,0),U))_U_XMZ ; * N/A *
"RTN","XMJMFB",201,0)
 Q
"RTN","XMJMLN")
0^10^B54444130
"RTN","XMJMLN",1,0)
XMJMLN ;ISC-SF/GB-List/Read new messages ;12/21/99  07:15
"RTN","XMJMLN",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMLN",3,0)
 ; Replaces LIST,PRIO^XMA0A (ISC-WASH/CAP)
"RTN","XMJMLN",4,0)
LISTONE(XMDUZ,XMK,XMKN,XMTYPE) ; List new/priority messages in one basket
"RTN","XMJMLN",5,0)
 ; XMTYPE   N0=New; N=Priority
"RTN","XMJMLN",6,0)
 N XMKZ,XMZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMKALL,XMIA,XMZOOM,XMMORE,XMCD,XMOPT,XMOX
"RTN","XMJMLN",7,0)
 S XMIA=1 ; Interactive
"RTN","XMJMLN",8,0)
 I '$D(^XMB(3.7,XMDUZ,XMTYPE,XMK)) D  Q
"RTN","XMJMLN",9,0)
 . W !!,$$EZBLD^DIALOG($S(XMTYPE="N":34016,1:34015)) ; You have no new (priority) messages in this basket.
"RTN","XMJMLN",10,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",11,0)
 S (XMKZ,XMZ)="",(XMPAGE,XMCNT,XMKALL,XMZOOM,XMCD,XMABORT)=0,(XMDETAIL,XMMORE)=1
"RTN","XMJMLN",12,0)
 S XMPMAX=IOSL-3
"RTN","XMJMLN",13,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMLN",14,0)
 S XMLEN("XMKZ")=$L($P(^XMB(3.7,XMDUZ,2,XMK,0),U,2))
"RTN","XMJMLN",15,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLN",16,0)
 F  D  Q:XMABORT
"RTN","XMJMLN",17,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLN",18,0)
 . D DISPLAY(XMDUZ,XMKALL,XMTYPE,XMDETAIL,XMK,XMKN,.XMKZ,.XMZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMLN",19,0)
 . D CHOOSE(XMDUZ,XMKALL,XMK,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG",.XMABORT)
"RTN","XMJMLN",20,0)
 . S:'$D(^XMB(3.7,XMDUZ,XMTYPE,XMK)) XMABORT=1
"RTN","XMJMLN",21,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",22,0)
 Q
"RTN","XMJMLN",23,0)
LISTALL(XMDUZ,XMTYPE) ; List new/priority messages in all baskets
"RTN","XMJMLN",24,0)
 ; XMTYPE   N0=New; N=Priority
"RTN","XMJMLN",25,0)
 N XMK,XMKZ,XMZ,XMCNT,XMABORT,XMLEN,XMFIRST,XMPAGE,XMDETAIL,XMPMAX,XMKALL,XMIA,XMZOOM,XMMORE,XMCD,XMOPT,XMOX
"RTN","XMJMLN",26,0)
 S XMIA=1 ; Interactive
"RTN","XMJMLN",27,0)
 I '$D(^XMB(3.7,XMDUZ,XMTYPE)) D  Q
"RTN","XMJMLN",28,0)
 . W !!,$$EZBLD^DIALOG($S(XMTYPE="N":34018,1:34017)) ; You have no new (priority) messages.
"RTN","XMJMLN",29,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",30,0)
 S (XMKZ,XMZ)="",(XMPAGE,XMCNT,XMZOOM,XMCD,XMABORT)=0,(XMK,XMDETAIL,XMMORE,XMKALL)=1
"RTN","XMJMLN",31,0)
 S XMPMAX=IOSL-3
"RTN","XMJMLN",32,0)
 D SETOPT^XMJMLR1(XMDUZ,0,.XMOPT,.XMOX)
"RTN","XMJMLN",33,0)
 D INIT(XMDUZ,XMTYPE,XMDETAIL,0,.XMLEN)
"RTN","XMJMLN",34,0)
 F  D  Q:XMABORT
"RTN","XMJMLN",35,0)
 . I XMCD S XMCD=0,XMDETAIL='XMDETAIL D INIT(XMDUZ,XMTYPE,XMDETAIL,0,.XMLEN)
"RTN","XMJMLN",36,0)
 . D DISPLAY(XMDUZ,XMKALL,XMTYPE,XMDETAIL,.XMK,"",.XMKZ,.XMZ,.XMCNT,.XMFIRST,.XMPAGE,.XMMORE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMLN",37,0)
 . D CHOOSE(XMDUZ,XMKALL,0,.XMKZ,.XMFIRST,.XMPAGE,XMMORE,.XMLEN,.XMZOOM,.XMOPT,.XMOX,"READMSG",.XMABORT)
"RTN","XMJMLN",38,0)
 . S:'$D(^XMB(3.7,XMDUZ,XMTYPE)) XMABORT=1
"RTN","XMJMLN",39,0)
 K ^TMP("XM",$J,"MSG"),^TMP("XM",$J,".")
"RTN","XMJMLN",40,0)
 Q
"RTN","XMJMLN",41,0)
INIT(XMDUZ,XMTYPE,XMDETAIL,XMACTUAL,XMLEN) ;
"RTN","XMJMLN",42,0)
 ; XMACTUAL 1/0=do/do not use actual XMKZ
"RTN","XMJMLN",43,0)
 N XMK,XMKN,XMKNMAX,XMKZL
"RTN","XMJMLN",44,0)
 S XMLEN("XMKZ")=$S(XMACTUAL:0,1:$L($P(^XMB(3.7,XMDUZ,0),U,6)))
"RTN","XMJMLN",45,0)
 S XMK=0,XMKNMAX=""
"RTN","XMJMLN",46,0)
 F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:XMK=""  D
"RTN","XMJMLN",47,0)
 . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMJMLN",48,0)
 . S:$L(XMKN)>$L(XMKNMAX) XMKNMAX=XMKN
"RTN","XMJMLN",49,0)
 . Q:'XMACTUAL
"RTN","XMJMLN",50,0)
 . S XMKZL=$L($O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1))
"RTN","XMJMLN",51,0)
 . S:XMKZL>XMLEN("XMKZ") XMLEN("XMKZ")=XMKZL
"RTN","XMJMLN",52,0)
 D INIT^XMJML(XMDUZ,"",XMKNMAX,XMDETAIL,.XMLEN)
"RTN","XMJMLN",53,0)
 Q
"RTN","XMJMLN",54,0)
DISPLAY(XMDUZ,XMKALL,XMTYPE,XMDETAIL,XMK,XMKN,XMKZ,XMZ,XMCNT,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMLN",55,0)
 N XMREC
"RTN","XMJMLN",56,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLN",57,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,XMDUZ,XMK,XMKN)
"RTN","XMJMLN",58,0)
 I XMZOOM D  Q
"RTN","XMJMLN",59,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",60,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMLN",61,0)
 . . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMLN",62,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",63,0)
 . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMLN",64,0)
 . D LISTMSG^XMJML($P(XMREC,U,1),$P(XMREC,U,2),XMKZ,$P(XMREC,U,3),XMDETAIL,.XMLEN)
"RTN","XMJMLN",65,0)
 Q:$Y>XMPMAX!'XMMORE
"RTN","XMJMLN",66,0)
 I XMKALL D
"RTN","XMJMLN",67,0)
 . S XMK=XMK-.01
"RTN","XMJMLN",68,0)
 . F  S XMK=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)) Q:XMK=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",69,0)
 . . S XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U)
"RTN","XMJMLN",70,0)
 . . D LISTBSKT(XMDUZ,XMTYPE,XMDETAIL,XMK,XMKN,.XMZ,.XMCNT,.XMLEN,XMPMAX)
"RTN","XMJMLN",71,0)
 . S XMMORE=$S('XMK:0,$O(^XMB(3.7,XMDUZ,XMTYPE,XMK)):1,XMZ="":0,$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")):1,1:0)
"RTN","XMJMLN",72,0)
 E  D
"RTN","XMJMLN",73,0)
 . D LISTBSKT(XMDUZ,XMTYPE,XMDETAIL,XMK,XMKN,.XMZ,.XMCNT,.XMLEN,XMPMAX)
"RTN","XMJMLN",74,0)
 . S XMMORE=$S(XMZ="":0,$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")):1,1:0)
"RTN","XMJMLN",75,0)
 S XMKZ=XMCNT
"RTN","XMJMLN",76,0)
 Q
"RTN","XMJMLN",77,0)
LISTBSKT(XMDUZ,XMTYPE,XMDETAIL,XMK,XMKN,XMZ,XMCNT,XMLEN,XMPMAX) ;
"RTN","XMJMLN",78,0)
 F  S XMZ=$O(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ),XMV("ORDER")) Q:XMZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLN",79,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITN^XMUT4A(XMDUZ,XMTYPE,XMK,XMZ)
"RTN","XMJMLN",80,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJMLN",81,0)
 . S XMCNT=XMCNT+1
"RTN","XMJMLN",82,0)
 . S ^TMP("XM",$J,"MSG",XMCNT)=XMK_U_XMKN_U_XMZ
"RTN","XMJMLN",83,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMCNT,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMLN",84,0)
 Q
"RTN","XMJMLN",85,0)
CHOOSE(XMDUZ,XMKALL,XMK,XMKZ,XMFIRST,XMPAGE,XMMORE,XMLEN,XMZOOM,XMOPT,XMOX,XMREAD,XMABORT) ;
"RTN","XMJMLN",86,0)
 N XMY,XMHI,XMLO
"RTN","XMJMLN",87,0)
 I XMZOOM D
"RTN","XMJMLN",88,0)
 . S XMMORE=$S(XMKZ="":0,1:1)
"RTN","XMJMLN",89,0)
 E  I $O(XMFIRST(XMPAGE)),XMKZ,$O(^TMP("XM",$J,"MSG",XMKZ)) D
"RTN","XMJMLN",90,0)
 . S XMMORE=1
"RTN","XMJMLN",91,0)
 . S XMFIRST(XMPAGE+1)=XMKZ
"RTN","XMJMLN",92,0)
 S XMLO=$O(^TMP("XM",$J,"MSG",""))
"RTN","XMJMLN",93,0)
 S XMHI=$O(^TMP("XM",$J,"MSG",""),-1)
"RTN","XMJMLN",94,0)
 D XMDIR^XMJMLR1(XMDUZ,XMLO,XMHI,XMPAGE,XMMORE,"XM-U-BO-FULL SCREEN LIST","",.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMLN",95,0)
 I '$D(XMY) S XMKZ=XMFIRST(XMPAGE) Q
"RTN","XMJMLN",96,0)
 I XMY=""!($E(XMY)="+") D  Q  ; Next page
"RTN","XMJMLN",97,0)
 . I XMMORE S XMPAGE=XMPAGE+1 Q
"RTN","XMJMLN",98,0)
 . I XMPAGE=0 S XMABORT=1 Q
"RTN","XMJMLN",99,0)
 . D AGAIN^XMJMLR(.XMABORT) Q:XMABORT
"RTN","XMJMLN",100,0)
 . S XMPAGE=0
"RTN","XMJMLN",101,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",102,0)
 I $E(XMY)="." D  Q  ; (De)Select messages
"RTN","XMJMLN",103,0)
 . D DODOT
"RTN","XMJMLN",104,0)
 . I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",105,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",106,0)
 I XMY>0 D  Q
"RTN","XMJMLN",107,0)
 . N XMREC
"RTN","XMJMLN",108,0)
 . S XMREC=$G(^TMP("XM",$J,"MSG",XMY))
"RTN","XMJMLN",109,0)
 . I XMREC="" D
"RTN","XMJMLN",110,0)
 . . W *7
"RTN","XMJMLN",111,0)
 . E  D
"RTN","XMJMLN",112,0)
 . . N XMKZ
"RTN","XMJMLN",113,0)
 . . S XMKZ=XMY
"RTN","XMJMLN",114,0)
 . . D @XMREAD
"RTN","XMJMLN",115,0)
 . . I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",116,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",117,0)
 I XMY=0 D  Q  ; First page
"RTN","XMJMLN",118,0)
 . S XMPAGE=0
"RTN","XMJMLN",119,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",120,0)
 I $E(XMY)="-" D  Q  ; Previous page
"RTN","XMJMLN",121,0)
 . S:XMPAGE>0 XMPAGE=XMPAGE-1
"RTN","XMJMLN",122,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",123,0)
 D @XMY
"RTN","XMJMLN",124,0)
 S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLN",125,0)
 Q
"RTN","XMJMLN",126,0)
READMSG ; (XMDUZ,XMKZ,XMREC,XMTYPE) <- needed!
"RTN","XMJMLN",127,0)
 N XMK,XMKN,XMZ
"RTN","XMJMLN",128,0)
 S XMK=$P(XMREC,U,1),XMKN=$P(XMREC,U,2),XMZ=$P(XMREC,U,3)
"RTN","XMJMLN",129,0)
 I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,$G(^XMB(3.9,XMZ,0))) D  Q  ; "read"
"RTN","XMJMLN",130,0)
 . D SHOW^XMJERR
"RTN","XMJMLN",131,0)
 . D WAIT^XMXUTIL
"RTN","XMJMLN",132,0)
 D READNEW^XMJBN(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMLN",133,0)
 Q:$D(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ))
"RTN","XMJMLN",134,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMLN",135,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLN",136,0)
 Q
"RTN","XMJMLN",137,0)
DODOT ;
"RTN","XMJMLN",138,0)
 N I,XMSTRIKE,XM1,XMN,XMKZ
"RTN","XMJMLN",139,0)
 I $E(XMY,2)="-" S XMSTRIKE=1,XMY=$E(XMY,3,999)
"RTN","XMJMLN",140,0)
 E  S XMSTRIKE=0,XMY=$E(XMY,2,999)
"RTN","XMJMLN",141,0)
 I XMY="*" D  Q
"RTN","XMJMLN",142,0)
 . I XMSTRIKE K ^TMP("XM",$J,".") Q
"RTN","XMJMLN",143,0)
 . S XMKZ=""
"RTN","XMJMLN",144,0)
 . F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:'XMKZ  S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",145,0)
 F I=1:1:$L(XMY,",") D
"RTN","XMJMLN",146,0)
 . S XMKZ=$P(XMY,",",I)
"RTN","XMJMLN",147,0)
 . I XMKZ["-" D  Q
"RTN","XMJMLN",148,0)
 . . S XM1=$P(XMKZ,"-")
"RTN","XMJMLN",149,0)
 . . S XMN=$P(XMKZ,"-",2) S:XMN="" XMN=XMHI
"RTN","XMJMLN",150,0)
 . . S XMKZ=XM1-.1
"RTN","XMJMLN",151,0)
 . . I 'XMSTRIKE D  Q
"RTN","XMJMLN",152,0)
 . . . F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ>XMN!'XMKZ  D
"RTN","XMJMLN",153,0)
 . . . . S:'$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",154,0)
 . . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:XMKZ>XMN!'XMKZ  K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLN",155,0)
 . I 'XMSTRIKE D  Q
"RTN","XMJMLN",156,0)
 . . I $D(^TMP("XM",$J,"MSG",XMKZ)),'$D(^TMP("XM",$J,".",XMKZ)) S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",157,0)
 . I $D(^TMP("XM",$J,".",XMKZ)) K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLN",158,0)
 Q
"RTN","XMJMLN",159,0)
CD ; Change Detail
"RTN","XMJMLN",160,0)
 S XMCD=1
"RTN","XMJMLN",161,0)
 Q
"RTN","XMJMLN",162,0)
D ; Delete messages
"RTN","XMJMLN",163,0)
 D DELETE^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",164,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",165,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",166,0)
 Q
"RTN","XMJMLN",167,0)
F ; Forward messages
"RTN","XMJMLN",168,0)
 D FORWARD^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",169,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",170,0)
 Q
"RTN","XMJMLN",171,0)
FI ; Filter messages
"RTN","XMJMLN",172,0)
 D FILTER^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",173,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",174,0)
 Q
"RTN","XMJMLN",175,0)
H ; Headerless Print messages
"RTN","XMJMLN",176,0)
 D PRINT^XMJMORX(XMDUZ,0)
"RTN","XMJMLN",177,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",178,0)
 Q
"RTN","XMJMLN",179,0)
L ; Later messages
"RTN","XMJMLN",180,0)
 D LATER^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",181,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",182,0)
 Q
"RTN","XMJMLN",183,0)
NT ; New Toggle messages
"RTN","XMJMLN",184,0)
 D NEWTOGL^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",185,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",186,0)
 Q
"RTN","XMJMLN",187,0)
O ; Opposite toggle
"RTN","XMJMLN",188,0)
 N XMKZ
"RTN","XMJMLN",189,0)
 S XMKZ=0
"RTN","XMJMLN",190,0)
 F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:'XMKZ  D
"RTN","XMJMLN",191,0)
 . I $D(^TMP("XM",$J,".",XMKZ)) K ^TMP("XM",$J,".",XMKZ) Q
"RTN","XMJMLN",192,0)
 . S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLN",193,0)
 S XMPAGE=0
"RTN","XMJMLN",194,0)
 Q
"RTN","XMJMLN",195,0)
P ; Print messages
"RTN","XMJMLN",196,0)
 D PRINT^XMJMORX(XMDUZ,1)
"RTN","XMJMLN",197,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",198,0)
 Q
"RTN","XMJMLN",199,0)
S ; Save messages
"RTN","XMJMLN",200,0)
 D SAVE^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",201,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",202,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",203,0)
 Q
"RTN","XMJMLN",204,0)
T ; Terminate messages
"RTN","XMJMLN",205,0)
 D TERM^XMJMORX(XMDUZ,XMKALL,XMK)
"RTN","XMJMLN",206,0)
 D WAIT^XMXUTIL
"RTN","XMJMLN",207,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLN",208,0)
 Q
"RTN","XMJMLN",209,0)
Z ; Zoom toggle
"RTN","XMJMLN",210,0)
 N I
"RTN","XMJMLN",211,0)
 I XMZOOM D
"RTN","XMJMLN",212,0)
 . S XMZOOM=0
"RTN","XMJMLN",213,0)
 . S I=""
"RTN","XMJMLN",214,0)
 . F  S I=$O(XMFIRST(0,I)) Q:I=""  S XMFIRST(I)=XMFIRST(0,I)
"RTN","XMJMLN",215,0)
 . S XMPAGE=XMPAGE(0)
"RTN","XMJMLN",216,0)
 E  D
"RTN","XMJMLN",217,0)
 . S XMZOOM=1
"RTN","XMJMLN",218,0)
 . S I=""
"RTN","XMJMLN",219,0)
 . F  S I=$O(XMFIRST(I)) Q:I=""  S XMFIRST(0,I)=XMFIRST(I)
"RTN","XMJMLN",220,0)
 . S XMPAGE(0)=XMPAGE
"RTN","XMJMLN",221,0)
 . S XMPAGE=0
"RTN","XMJMLN",222,0)
 Q
"RTN","XMJMLR")
0^11^B72945716
"RTN","XMJMLR",1,0)
XMJMLR ;ISC-SF/GMB-List/Read messages in basket ;01/19/2000  14:33
"RTN","XMJMLR",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMLR",3,0)
 ; Replaces 1^XMAL0 (ISC-WASH/THM/CAP)
"RTN","XMJMLR",4,0)
LIST(XMDUZ,XMK,XMKN,XMDETAIL,XMABORT) ; List messages in basket 
"RTN","XMJMLR",5,0)
 ; XMDETAIL 0=Summary; 1=Detailed
"RTN","XMJMLR",6,0)
 N XMKZ,XMLEN,XMFIRST,XMPAGE,XMPMAX,XMZOOM,XMINSTR,XMOPT,XMOX,XMORDER
"RTN","XMJMLR",7,0)
 I XMDUZ=.5,XMK>999 S XMORDER=XMV("ORDER"),XMV("ORDER")=1
"RTN","XMJMLR",8,0)
 S XMINSTR("GOTO")=1  ; may go to another page
"RTN","XMJMLR",9,0)
 D SETOPT^XMJMLR1(XMDUZ,XMK,.XMOPT,.XMOX)
"RTN","XMJMLR",10,0)
 K ^TMP("XM",$J,".")
"RTN","XMJMLR",11,0)
 S XMKZ="",(XMPAGE,XMZOOM)=0,XMPMAX=IOSL-3
"RTN","XMJMLR",12,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",13,0)
 F  D  Q:XMABORT!'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C"))
"RTN","XMJMLR",14,0)
 . D DISPLAY(XMDUZ,XMDETAIL,XMK,XMKN,.XMKZ,.XMFIRST,.XMPAGE,.XMLEN,XMZOOM,XMPMAX)
"RTN","XMJMLR",15,0)
 . D CHOOSE(XMDUZ,.XMK,.XMKZ,.XMFIRST,.XMPAGE,.XMLEN,.XMZOOM,.XMINSTR,.XMOPT,.XMOX,.XMABORT)
"RTN","XMJMLR",16,0)
 K ^TMP("XM",$J,".")
"RTN","XMJMLR",17,0)
 I $D(XMORDER) S XMV("ORDER")=XMORDER
"RTN","XMJMLR",18,0)
 Q
"RTN","XMJMLR",19,0)
DISPLAY(XMDUZ,XMDETAIL,XMK,XMKN,XMKZ,XMFIRST,XMPAGE,XMLEN,XMZOOM,XMPMAX) ;
"RTN","XMJMLR",20,0)
 N XMZ
"RTN","XMJMLR",21,0)
 S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLR",22,0)
 D HEADER^XMJML(XMDETAIL,.XMLEN,XMDUZ,XMK,XMKN,1)
"RTN","XMJMLR",23,0)
 I XMZOOM D  Q
"RTN","XMJMLR",24,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLR",25,0)
 . . D LISTMSG^XMJML(XMK,XMKN,XMKZ,$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")),XMDETAIL,.XMLEN)
"RTN","XMJMLR",26,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")) Q:XMKZ=""  D  Q:$Y>XMPMAX
"RTN","XMJMLR",27,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJMLR",28,0)
 . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJMLR",29,0)
 . I '$D(^XMB(3.9,XMZ,0)) D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJMLR",30,0)
 . D LISTMSG^XMJML(XMK,XMKN,XMKZ,XMZ,XMDETAIL,.XMLEN)
"RTN","XMJMLR",31,0)
 Q
"RTN","XMJMLR",32,0)
CHOOSE(XMDUZ,XMK,XMKZ,XMFIRST,XMPAGE,XMLEN,XMZOOM,XMINSTR,XMOPT,XMOX,XMABORT) ;
"RTN","XMJMLR",33,0)
 N XMY,XMZ,XMMORE,XMHI,XMLO
"RTN","XMJMLR",34,0)
 S XMMORE=$S(XMKZ="":0,'$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMV("ORDER")):0,1:1)
"RTN","XMJMLR",35,0)
 S XMLO=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJMLR",36,0)
 S XMHI=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJMLR",37,0)
 D XMDIR^XMJMLR1(XMDUZ,XMLO,XMHI,XMPAGE,XMMORE,"XM-U-BO-FULL SCREEN",.XMINSTR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMLR",38,0)
 I '$D(XMY) S XMKZ=XMFIRST(XMPAGE) Q
"RTN","XMJMLR",39,0)
 I XMY=""!($E(XMY)="+") D  Q  ; Page forward
"RTN","XMJMLR",40,0)
 . I XMMORE D PFWD Q
"RTN","XMJMLR",41,0)
 . I XMPAGE=0 S XMABORT=1 Q
"RTN","XMJMLR",42,0)
 . D AGAIN(.XMABORT) Q:XMABORT
"RTN","XMJMLR",43,0)
 . S XMPAGE=0
"RTN","XMJMLR",44,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",45,0)
 I $E(XMY)="." D  Q  ; (De)Select messages
"RTN","XMJMLR",46,0)
 . D DODOT
"RTN","XMJMLR",47,0)
 . I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",48,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",49,0)
 I XMY>0 D  Q  ;
"RTN","XMJMLR",50,0)
 . N XMKZLAST
"RTN","XMJMLR",51,0)
 . S XMKZLAST=XMKZ
"RTN","XMJMLR",52,0)
 . S XMKZ=XMY
"RTN","XMJMLR",53,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJMLR",54,0)
 . I XMZ D
"RTN","XMJMLR",55,0)
 . . I '$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITC^XMUT4A(XMDUZ,XMK,XMZ,XMKZ)
"RTN","XMJMLR",56,0)
 . . D READMSG(XMDUZ,XMK,XMKN,XMKZ,XMZ,XMZOOM)
"RTN","XMJMLR",57,0)
 . . D FINDXMKZ(XMDUZ,XMK,.XMFIRST,.XMPAGE,XMKZLAST,XMKZ)
"RTN","XMJMLR",58,0)
 . E  D
"RTN","XMJMLR",59,0)
 . . S XMZ=XMY
"RTN","XMJMLR",60,0)
 . . I $D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D  Q
"RTN","XMJMLR",61,0)
 . . . S XMKZ=$P(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0),U,2)
"RTN","XMJMLR",62,0)
 . . . I 'XMKZ D ADDITM^XMUT4A(XMDUZ,XMK,XMZ,.XMKZ)
"RTN","XMJMLR",63,0)
 . . . D READMSG(XMDUZ,XMK,XMKN,XMKZ,XMZ,XMZOOM)
"RTN","XMJMLR",64,0)
 . . . D FINDXMKZ(XMDUZ,XMK,.XMFIRST,.XMPAGE,XMKZLAST,XMKZ)
"RTN","XMJMLR",65,0)
 . . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMJMLR",66,0)
 . . . W *7
"RTN","XMJMLR",67,0)
 . . . Q:XMZ>$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJMLR",68,0)
 . . . S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMZ),XMV("ORDER"))
"RTN","XMJMLR",69,0)
 . . . I 'XMKZ S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMZ),-XMV("ORDER"))
"RTN","XMJMLR",70,0)
 . . . D FINDXMKZ(XMDUZ,XMK,.XMFIRST,.XMPAGE,XMKZLAST,XMKZ)
"RTN","XMJMLR",71,0)
 . . N XMK,XMKN,XMOK
"RTN","XMJMLR",72,0)
 . . S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMJMLR",73,0)
 . . I 'XMK D  Q:'XMOK
"RTN","XMJMLR",74,0)
 . . . I $D(XMERR) K XMERR,^TMP("XMERR",$J)
"RTN","XMJMLR",75,0)
 . . . S XMOK=$$ACCESS^XMXSEC(XMDUZ,XMZ,^XMB(3.9,XMZ,0))
"RTN","XMJMLR",76,0)
 . . . Q:'$D(XMERR)
"RTN","XMJMLR",77,0)
 . . . D SHOW^XMJERR
"RTN","XMJMLR",78,0)
 . . . D WAIT^XMXUTIL
"RTN","XMJMLR",79,0)
 . . S XMKN=$S(XMK:$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1),1:$$EZBLD^DIALOG(34014)) ; * N/A *
"RTN","XMJMLR",80,0)
 . . I XMK,'$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D ADDITM^XMUT4A(XMDUZ,XMK,XMZ)
"RTN","XMJMLR",81,0)
 . . D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMLR",82,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",83,0)
 I XMY=0 D  Q  ; First page
"RTN","XMJMLR",84,0)
 . S XMPAGE=0
"RTN","XMJMLR",85,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",86,0)
 I $E(XMY)="-" D  Q  ; Page back
"RTN","XMJMLR",87,0)
 . N XMCNT
"RTN","XMJMLR",88,0)
 . S XMCNT=$E(XMY,2,99)
"RTN","XMJMLR",89,0)
 . S:XMCNT="" XMCNT=1
"RTN","XMJMLR",90,0)
 . S XMPAGE=XMPAGE-XMCNT
"RTN","XMJMLR",91,0)
 . S:XMPAGE<0 XMPAGE=0
"RTN","XMJMLR",92,0)
 . S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",93,0)
 D @XMY
"RTN","XMJMLR",94,0)
 S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",95,0)
 Q
"RTN","XMJMLR",96,0)
PFWD ;
"RTN","XMJMLR",97,0)
 N XMCNT,XMPDEST
"RTN","XMJMLR",98,0)
 S XMCNT=$E(XMY,2,99)
"RTN","XMJMLR",99,0)
 S:XMCNT="" XMCNT=1
"RTN","XMJMLR",100,0)
 I XMCNT=1 S XMPAGE=XMPAGE+1 Q
"RTN","XMJMLR",101,0)
 S XMPDEST=XMPAGE+XMCNT
"RTN","XMJMLR",102,0)
 D FINDPAGE(.XMFIRST,.XMPAGE,XMKZ,XMPDEST)
"RTN","XMJMLR",103,0)
 S XMKZ=XMFIRST(XMPAGE)
"RTN","XMJMLR",104,0)
 Q
"RTN","XMJMLR",105,0)
FINDPAGE(XMFIRST,XMPAGE,XMKZ,XMPDEST) ;
"RTN","XMJMLR",106,0)
 N XMO,I
"RTN","XMJMLR",107,0)
 S XMO=$S(XMPDEST>XMPAGE:1,1:-1)
"RTN","XMJMLR",108,0)
 F XMPAGE=XMPAGE+XMO:XMO S XMFIRST(XMPAGE)=XMKZ Q:XMPAGE=XMPDEST  D  Q:XMKZ=""
"RTN","XMJMLR",109,0)
 . F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),XMO*XMV("ORDER")) Q:XMKZ=""
"RTN","XMJMLR",110,0)
 I '$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMFIRST(XMPAGE)),XMO*XMV("ORDER")) S XMPAGE=XMPAGE-XMO Q
"RTN","XMJMLR",111,0)
 Q
"RTN","XMJMLR",112,0)
FINDXMKZ(XMDUZ,XMK,XMFIRST,XMPAGE,XMKZLAST,XMKZF) ; Find the page with XMKZF on it
"RTN","XMJMLR",113,0)
 Q:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZF))
"RTN","XMJMLR",114,0)
 I XMV("ORDER")=-1 D  Q
"RTN","XMJMLR",115,0)
 . I $S(XMFIRST(XMPAGE):XMFIRST(XMPAGE)>XMKZF,1:1),XMKZF'<XMKZLAST Q
"RTN","XMJMLR",116,0)
 . N XMKZ,I
"RTN","XMJMLR",117,0)
 . I XMKZF<XMKZLAST D  Q  ; Go forward
"RTN","XMJMLR",118,0)
 . . S XMKZ=XMKZLAST
"RTN","XMJMLR",119,0)
 . . F XMPAGE=XMPAGE+1:1 D  Q:XMKZ=XMKZF
"RTN","XMJMLR",120,0)
 . . . S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLR",121,0)
 . . . F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),-1) Q:XMKZ=XMKZF
"RTN","XMJMLR",122,0)
 . E  D  ; Go back
"RTN","XMJMLR",123,0)
 . . F XMPAGE=XMPAGE-1:-1 Q:XMFIRST(XMPAGE)>XMKZF!'XMPAGE
"RTN","XMJMLR",124,0)
 . . ;S XMKZ=XMFIRST(XMPAGE)-1
"RTN","XMJMLR",125,0)
 . . ;F XMPAGE=XMPAGE-1:-1 D  Q:XMFIRST(XMPAGE)>XMKZF
"RTN","XMJMLR",126,0)
 . . ;. F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ=""
"RTN","XMJMLR",127,0)
 . . ;. S XMFIRST(XMPAGE)=$S(XMKZ:XMKZ+1,1:XMKZ)
"RTN","XMJMLR",128,0)
 I XMFIRST(XMPAGE)<XMKZF,$S(XMKZLAST:XMKZF'>XMKZLAST,1:1) Q
"RTN","XMJMLR",129,0)
 N XMKZ,I
"RTN","XMJMLR",130,0)
 I XMKZF>XMKZLAST D  Q  ; Go forward
"RTN","XMJMLR",131,0)
 . S XMKZ=XMKZLAST
"RTN","XMJMLR",132,0)
 . F XMPAGE=XMPAGE+1:1 D  Q:XMKZ=XMKZF
"RTN","XMJMLR",133,0)
 . . S XMFIRST(XMPAGE)=XMKZ
"RTN","XMJMLR",134,0)
 . . F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ=XMKZF
"RTN","XMJMLR",135,0)
 E  D  ; Go back
"RTN","XMJMLR",136,0)
 . F XMPAGE=XMPAGE-1:-1 Q:XMFIRST(XMPAGE)<XMKZF!'XMPAGE
"RTN","XMJMLR",137,0)
 . ;S XMKZ=XMFIRST(XMPAGE)-1
"RTN","XMJMLR",138,0)
 . ;F XMPAGE=XMPAGE-1:-1 D  Q:XMFIRST(XMPAGE)<XMKZF
"RTN","XMJMLR",139,0)
 . ;. F I=1:1:XMPMAX S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ),-1) Q:XMKZ=""
"RTN","XMJMLR",140,0)
 . ;. S XMFIRST(XMPAGE)=$S(XMKZ:XMKZ+1,1:XMKZ)
"RTN","XMJMLR",141,0)
 Q
"RTN","XMJMLR",142,0)
READMSG(XMDUZ,XMK,XMKN,XMKZ,XMZ,XMZOOM) ;
"RTN","XMJMLR",143,0)
 D READMSG^XMJBM(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMLR",144,0)
 I $D(^TMP("XM",$J,".",XMKZ)),'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,XMZ)) K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMLR",145,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",146,0)
 Q
"RTN","XMJMLR",147,0)
AGAIN(XMABORT) ;
"RTN","XMJMLR",148,0)
 N DIR,Y
"RTN","XMJMLR",149,0)
 W !
"RTN","XMJMLR",150,0)
 S DIR("A")=$$EZBLD^DIALOG(34020) ; End reached.  Begin again
"RTN","XMJMLR",151,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMLR",152,0)
 D BLD^DIALOG(34021,"","","DIR(""?"")") ; Enter 'Yes' if you wish to continue reading messages; 'No' if you don't.
"RTN","XMJMLR",153,0)
 D ^DIR
"RTN","XMJMLR",154,0)
 Q:Y=1        ; Yes, begin again
"RTN","XMJMLR",155,0)
 S XMABORT=1  ; No, exit.
"RTN","XMJMLR",156,0)
 Q
"RTN","XMJMLR",157,0)
DODOT ;
"RTN","XMJMLR",158,0)
 N I,XMSTRIKE,XM1,XMN,XMKZ
"RTN","XMJMLR",159,0)
 I $E(XMY,2)="-" S XMSTRIKE=1,XMY=$E(XMY,3,999)
"RTN","XMJMLR",160,0)
 E  S XMSTRIKE=0,XMY=$E(XMY,2,999)
"RTN","XMJMLR",161,0)
 I XMY="*" D  Q
"RTN","XMJMLR",162,0)
 . I XMSTRIKE K ^TMP("XM",$J,".") Q
"RTN","XMJMLR",163,0)
 . S XMKZ=""
"RTN","XMJMLR",164,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ  S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLR",165,0)
 F I=1:1:$L(XMY,",") D
"RTN","XMJMLR",166,0)
 . S XMKZ=$P(XMY,",",I)
"RTN","XMJMLR",167,0)
 . I XMKZ["-" D  Q
"RTN","XMJMLR",168,0)
 . . S XM1=$P(XMKZ,"-")
"RTN","XMJMLR",169,0)
 . . S XMN=$P(XMKZ,"-",2) S:XMN="" XMN=XMHI
"RTN","XMJMLR",170,0)
 . . S XMKZ=XM1-.1
"RTN","XMJMLR",171,0)
 . . I 'XMSTRIKE D  Q
"RTN","XMJMLR",172,0)
 . . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ>XMN!'XMKZ  S:'$D(^TMP("XM",$J,".",XMKZ)) ^(XMKZ)=""
"RTN","XMJMLR",173,0)
 . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ>XMN!'XMKZ  K:$D(^TMP("XM",$J,".",XMKZ)) ^(XMKZ)
"RTN","XMJMLR",174,0)
 . I 'XMSTRIKE D  Q
"RTN","XMJMLR",175,0)
 . . I $D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)),'$D(^TMP("XM",$J,".",XMKZ)) S ^(XMKZ)=""
"RTN","XMJMLR",176,0)
 . K:$D(^TMP("XM",$J,".",XMKZ)) ^(XMKZ)
"RTN","XMJMLR",177,0)
 Q
"RTN","XMJMLR",178,0)
C ; Change the name of this basket
"RTN","XMJMLR",179,0)
 D NAMEBSKT^XMJBU(XMDUZ,XMK,.XMKN)
"RTN","XMJMLR",180,0)
 K XMLEN
"RTN","XMJMLR",181,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",182,0)
 Q
"RTN","XMJMLR",183,0)
CD ; Change Detail
"RTN","XMJMLR",184,0)
 S XMDETAIL='XMDETAIL
"RTN","XMJMLR",185,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",186,0)
 Q
"RTN","XMJMLR",187,0)
D ; Delete messages
"RTN","XMJMLR",188,0)
 D DELETE^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",189,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",190,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",191,0)
 Q
"RTN","XMJMLR",192,0)
F ; Forward messages
"RTN","XMJMLR",193,0)
 D FORWARD^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",194,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",195,0)
 Q
"RTN","XMJMLR",196,0)
FI ; Filter messages
"RTN","XMJMLR",197,0)
 D FILTER^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",198,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",199,0)
 Q
"RTN","XMJMLR",200,0)
H ; Headerless Print messages
"RTN","XMJMLR",201,0)
 D PRINT^XMJMOR(XMDUZ,XMK,0)
"RTN","XMJMLR",202,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",203,0)
 Q
"RTN","XMJMLR",204,0)
L ; Later messages
"RTN","XMJMLR",205,0)
 D LATER^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",206,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",207,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",208,0)
 Q
"RTN","XMJMLR",209,0)
N ; New message list
"RTN","XMJMLR",210,0)
 D LISTONE^XMJMLN(XMDUZ,XMK,XMKN,"N0")
"RTN","XMJMLR",211,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",212,0)
 Q
"RTN","XMJMLR",213,0)
NT ; New Toggle messages
"RTN","XMJMLR",214,0)
 D NEWTOGL^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",215,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",216,0)
 Q
"RTN","XMJMLR",217,0)
O ; Opposite toggle
"RTN","XMJMLR",218,0)
 N XMKZ
"RTN","XMJMLR",219,0)
 S XMKZ=0
"RTN","XMJMLR",220,0)
 F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ  D
"RTN","XMJMLR",221,0)
 . I $D(^TMP("XM",$J,".",XMKZ)) K ^TMP("XM",$J,".",XMKZ) Q
"RTN","XMJMLR",222,0)
 . S ^TMP("XM",$J,".",XMKZ)=""
"RTN","XMJMLR",223,0)
 S XMPAGE=0
"RTN","XMJMLR",224,0)
 Q
"RTN","XMJMLR",225,0)
P ; Print messages
"RTN","XMJMLR",226,0)
 D PRINT^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",227,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",228,0)
 Q
"RTN","XMJMLR",229,0)
Q ; Query messages
"RTN","XMJMLR",230,0)
 D FINDBSKT^XMJMF(XMDUZ,XMK,XMKN)
"RTN","XMJMLR",231,0)
 Q
"RTN","XMJMLR",232,0)
Q1 ; ?string - search for messages in this basket whose subject contains string.
"RTN","XMJMLR",233,0)
 N XMF
"RTN","XMJMLR",234,0)
 S XMF("BSKT")=XMK
"RTN","XMJMLR",235,0)
 S XMF("SUBJ")=XMY(0)
"RTN","XMJMLR",236,0)
 D FIND1^XMJMFB(XMDUZ,.XMF,1)
"RTN","XMJMLR",237,0)
 Q
"RTN","XMJMLR",238,0)
Q2 ; ??string - search for messages whose subject starts with string.
"RTN","XMJMLR",239,0)
 D FIND^XMJMFA(XMDUZ,XMY(0),1)
"RTN","XMJMLR",240,0)
 Q
"RTN","XMJMLR",241,0)
R ; Resequence messages
"RTN","XMJMLR",242,0)
 D R^XMJBM
"RTN","XMJMLR",243,0)
 S XMPAGE=0
"RTN","XMJMLR",244,0)
 K XMLEN,XMFIRST
"RTN","XMJMLR",245,0)
 S XMFIRST(0)=""
"RTN","XMJMLR",246,0)
 D INIT^XMJML(XMDUZ,XMK,XMKN,XMDETAIL,.XMLEN,1)
"RTN","XMJMLR",247,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",248,0)
 Q
"RTN","XMJMLR",249,0)
S ; Save messages
"RTN","XMJMLR",250,0)
 D SAVE^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",251,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",252,0)
 Q
"RTN","XMJMLR",253,0)
T ; Terminate messages
"RTN","XMJMLR",254,0)
 D TERM^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",255,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",256,0)
 I XMZOOM,'$D(^TMP("XM",$J,".")) D Z
"RTN","XMJMLR",257,0)
 Q
"RTN","XMJMLR",258,0)
X ; Xmit priority toggle messages
"RTN","XMJMLR",259,0)
 D XMTPRI^XMJMOR(XMDUZ,XMK)
"RTN","XMJMLR",260,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR",261,0)
 Q
"RTN","XMJMLR",262,0)
Z ; Zoom toggle
"RTN","XMJMLR",263,0)
 N I
"RTN","XMJMLR",264,0)
 I XMZOOM D
"RTN","XMJMLR",265,0)
 . S XMZOOM=0
"RTN","XMJMLR",266,0)
 . S I=""
"RTN","XMJMLR",267,0)
 . F  S I=$O(XMFIRST(0,I)) Q:I=""  S XMFIRST(I)=XMFIRST(0,I)
"RTN","XMJMLR",268,0)
 . S XMPAGE=XMPAGE(0)
"RTN","XMJMLR",269,0)
 E  D
"RTN","XMJMLR",270,0)
 . S XMZOOM=1
"RTN","XMJMLR",271,0)
 . S I=""
"RTN","XMJMLR",272,0)
 . F  S I=$O(XMFIRST(I)) Q:I=""  S XMFIRST(0,I)=XMFIRST(I)
"RTN","XMJMLR",273,0)
 . S XMPAGE(0)=XMPAGE
"RTN","XMJMLR",274,0)
 . S XMPAGE=0
"RTN","XMJMLR",275,0)
 Q
"RTN","XMJMLR1")
0^7^B21990915
"RTN","XMJMLR1",1,0)
XMJMLR1 ;ISC-SF/GMB-List/Read messages in basket (continued) ;12/16/99  10:34
"RTN","XMJMLR1",2,0)
 ;;7.1;MailMan;**50,72,110**;Jun 02, 1994
"RTN","XMJMLR1",3,0)
 ; Replaces 1^XMAL0 (ISC-WASH/THM/CAP)
"RTN","XMJMLR1",4,0)
XMDIR(XMDUZ,XMLO,XMHI,XMPAGE,XMMORE,XMHELP,XMINSTR,XMOPT,XMOX,Y,XMABORT) ;
"RTN","XMJMLR1",5,0)
 N DIR,I,XMCMD,X,XMTEXT,XMPARM
"RTN","XMJMLR1",6,0)
 D ZOOMOPT(.XMOPT)
"RTN","XMJMLR1",7,0)
 S DIR(0)="FOA^1:100^K:'$$XMDIROK^XMJMLR1() X"
"RTN","XMJMLR1",8,0)
 S DIR("A")=$$EZBLD^DIALOG(34050) ; Enter message number or command:
"RTN","XMJMLR1",9,0)
 S DIR("??")=XMHELP
"RTN","XMJMLR1",10,0)
 S XMPARM(1)=XMLO,XMPARM(2)=XMHI
"RTN","XMJMLR1",11,0)
 D BLD^DIALOG($S($G(XMINSTR("GOTO")):34051,1:34051.1),.XMPARM,"","XMTEXT") ; Enter a message number (_XMLO_-_XMHI_) to read a message.
"RTN","XMJMLR1",12,0)
 I $D(XMOPT("Q")),'$D(XMOPT("Q","?")) D BLD^DIALOG(34052,"","","XMTEXT","S")
"RTN","XMJMLR1",13,0)
 ; ?string             Search for messages in this basket whose subject
"RTN","XMJMLR1",14,0)
 ;                     contains the specified string
"RTN","XMJMLR1",15,0)
 ; ??string            Search for messages you once sent or received
"RTN","XMJMLR1",16,0)
 ;                     whose subject begins with the specified string
"RTN","XMJMLR1",17,0)
 D BLD^DIALOG(34053,"","","XMTEXT","S")
"RTN","XMJMLR1",18,0)
 ; .(-)n or n-m,a,c-d  (de)select message n or a list of messages
"RTN","XMJMLR1",19,0)
 ; .(-)*               (de)select all messages
"RTN","XMJMLR1",20,0)
 D HELPCMD(.XMOPT,.XMOX,.XMTEXT)
"RTN","XMJMLR1",21,0)
 I XMMORE D
"RTN","XMJMLR1",22,0)
 . I XMPAGE D BLD^DIALOG($S($G(XMINSTR("GOTO")):34055,1:34056),"","","XMTEXT","S") Q
"RTN","XMJMLR1",23,0)
 . D BLD^DIALOG($S($G(XMINSTR("GOTO")):34057,1:34058),"","","XMTEXT","S")
"RTN","XMJMLR1",24,0)
 E  D
"RTN","XMJMLR1",25,0)
 . I XMPAGE D BLD^DIALOG($S($G(XMINSTR("GOTO")):34060,1:34061),"","","XMTEXT","S") Q
"RTN","XMJMLR1",26,0)
 . D BLD^DIALOG(34059,"","","XMTEXT","S")
"RTN","XMJMLR1",27,0)
 ; Press ENTER or + to go to the next page.  Enter +n to page forward n pages.
"RTN","XMJMLR1",28,0)
 ; Enter - to go to the previous page.  Enter -n to page back n pages.
"RTN","XMJMLR1",29,0)
 ; Enter 0 to go to the first page; = to refresh this page; ^ to exit.
"RTN","XMJMLR1",30,0)
 S I=$O(XMTEXT(""),-1)
"RTN","XMJMLR1",31,0)
 S XMTEXT=XMTEXT(I)
"RTN","XMJMLR1",32,0)
 K XMTEXT(I)
"RTN","XMJMLR1",33,0)
 M DIR("?")=XMTEXT
"RTN","XMJMLR1",34,0)
 K XMTEXT
"RTN","XMJMLR1",35,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMJMLR1",36,0)
 I Y="=" K Y Q
"RTN","XMJMLR1",37,0)
 Q:Y'?.A!(Y="")
"RTN","XMJMLR1",38,0)
 I $D(XMOPT(Y)),'$D(XMOPT(Y,"?")) Q
"RTN","XMJMLR1",39,0)
 D SHOWERR^XMJDIR(.XMOPT,Y)
"RTN","XMJMLR1",40,0)
 D WAIT^XMXUTIL
"RTN","XMJMLR1",41,0)
 K Y
"RTN","XMJMLR1",42,0)
 Q
"RTN","XMJMLR1",43,0)
XMDIROK() ;
"RTN","XMJMLR1",44,0)
 N XMLO
"RTN","XMJMLR1",45,0)
 S XMLO=0
"RTN","XMJMLR1",46,0)
 I X?1N.N Q:$L(X)>25 0  S X=+X,Y=+Y Q $S(X'<XMLO&(X'>XMHI):1,$D(^XMB(3.9,X,0)):1,1:0)
"RTN","XMJMLR1",47,0)
 I $E(X)="." Q $$DOT()
"RTN","XMJMLR1",48,0)
 I X?1"-".N Q:$L(X)>25 0  Q 1
"RTN","XMJMLR1",49,0)
 I X?1"+".N Q:$L(X)>25 0  Q 1
"RTN","XMJMLR1",50,0)
 I X="=" Q 1
"RTN","XMJMLR1",51,0)
 S Y=$$COMMAND^XMJDIR(.XMOPT,.XMOX,X)
"RTN","XMJMLR1",52,0)
 Q:Y'=-1 1
"RTN","XMJMLR1",53,0)
 I X'?1"?".E!'$D(XMOPT("Q")) Q 0
"RTN","XMJMLR1",54,0)
 I $D(XMOPT("Q","?")) S Y="Q" Q 1
"RTN","XMJMLR1",55,0)
 I X?1"??".E D  Q 1
"RTN","XMJMLR1",56,0)
 . I $E(X,3,99)?1N.N,$D(^XMB(3.9,$E(X,3,99),0)) S Y=$E(X,3,99) Q
"RTN","XMJMLR1",57,0)
 . S Y="Q2",Y(0)=$E(X,3,99)
"RTN","XMJMLR1",58,0)
 S Y="Q1",Y(0)=$E(X,2,99)
"RTN","XMJMLR1",59,0)
 Q 1
"RTN","XMJMLR1",60,0)
DOT() ;
"RTN","XMJMLR1",61,0)
 N XMXR,I,XMOK,XMX,XMSTRIKE
"RTN","XMJMLR1",62,0)
 S XMOK=1
"RTN","XMJMLR1",63,0)
 S XMX=$TR(X," ")
"RTN","XMJMLR1",64,0)
 I $E(XMX,2)="-" S XMSTRIKE=1,XMX=$E(XMX,3,999)
"RTN","XMJMLR1",65,0)
 E  S XMSTRIKE=0,XMX=$E(XMX,2,999)
"RTN","XMJMLR1",66,0)
 I XMX="*" S Y="."_$S(XMSTRIKE:"-",1:"")_XMX Q 1
"RTN","XMJMLR1",67,0)
 F I=1:1:$L(XMX,",") D  Q:'XMOK
"RTN","XMJMLR1",68,0)
 . S XMXR=$P(XMX,",",I)
"RTN","XMJMLR1",69,0)
 . I XMXR?1.25N1"-"1.25N D  Q
"RTN","XMJMLR1",70,0)
 . . I $P(XMXR,"-",1)<XMLO S XMOK=0 Q
"RTN","XMJMLR1",71,0)
 . . I $P(XMXR,"-",2)>XMHI S XMOK=0 Q
"RTN","XMJMLR1",72,0)
 . . I $P(XMXR,"-",1)>$P(XMXR,"-",2) S XMOK=0
"RTN","XMJMLR1",73,0)
 . I XMXR?1.25N D  Q
"RTN","XMJMLR1",74,0)
 . . I XMXR<XMLO S XMOK=0 Q
"RTN","XMJMLR1",75,0)
 . . I XMXR>XMHI S XMOK=0
"RTN","XMJMLR1",76,0)
 . I XMXR?1.25N1"-" D  Q
"RTN","XMJMLR1",77,0)
 . . I $P(XMXR,"-",1)<XMLO S XMOK=0 Q
"RTN","XMJMLR1",78,0)
 . . I $P(XMXR,"-",1)>XMHI S XMOK=0
"RTN","XMJMLR1",79,0)
 . S XMOK=0
"RTN","XMJMLR1",80,0)
 I XMOK S Y="."_$S(XMSTRIKE:"-",1:"")_XMX Q 1
"RTN","XMJMLR1",81,0)
 Q 0
"RTN","XMJMLR1",82,0)
SETOPT(XMDUZ,XMK,XMOPT,XMOX) ;
"RTN","XMJMLR1",83,0)
 D OPTGRP^XMXSEC1(XMDUZ,XMK,.XMOPT,.XMOX)
"RTN","XMJMLR1",84,0)
 D SET^XMXSEC1("CD",37221,.XMOPT,.XMOX) ; Change Detail
"RTN","XMJMLR1",85,0)
 D SET^XMXSEC1("O",37222,.XMOPT,.XMOX) ; Opposite selection toggle
"RTN","XMJMLR1",86,0)
 D SET^XMXSEC1("Z",37223,.XMOPT,.XMOX) ; Zoom selection toggle
"RTN","XMJMLR1",87,0)
 Q
"RTN","XMJMLR1",88,0)
ZOOMOPT(XMOPT) ;
"RTN","XMJMLR1",89,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMLR1",90,0)
 . I $D(XMOPT("Z","?")) K XMOPT("O","?"),XMOPT("Z","?")
"RTN","XMJMLR1",91,0)
 . Q:'$D(XMOPT("Q"))
"RTN","XMJMLR1",92,0)
 . S XMOPT("Q","?")=$$EZBLD^DIALOG(37232) ; You can't do this with messages selected.
"RTN","XMJMLR1",93,0)
 . S XMOPT("N","?")=XMOPT("Q","?")
"RTN","XMJMLR1",94,0)
 . S XMOPT("R","?")=XMOPT("Q","?")
"RTN","XMJMLR1",95,0)
 S XMOPT("O","?")=$$EZBLD^DIALOG(37231) ; You can't do this unless messages are selected.
"RTN","XMJMLR1",96,0)
 S XMOPT("Z","?")=XMOPT("O","?")
"RTN","XMJMLR1",97,0)
 Q:'$D(XMOPT("Q"))
"RTN","XMJMLR1",98,0)
 K XMOPT("Q","?"),XMOPT("N","?"),XMOPT("R","?")
"RTN","XMJMLR1",99,0)
 Q
"RTN","XMJMLR1",100,0)
HELPCMD(XMOPT,XMOX,XMHELP) ;
"RTN","XMJMLR1",101,0)
 N XMCNT,XMCMD,XMROWS,I,XMLEN,XMSAVE
"RTN","XMJMLR1",102,0)
 S (XMCNT,XMLEN)=0,XMCMD=""
"RTN","XMJMLR1",103,0)
 F  S XMCMD=$O(XMOPT(XMCMD)) Q:XMCMD=""  I '$D(XMOPT(XMCMD,"?")) S XMCNT=XMCNT+1 I $L(XMOX("X",XMCMD))>XMLEN S XMLEN=$L(XMOX("X",XMCMD))
"RTN","XMJMLR1",104,0)
 S I=$O(XMHELP(""),-1)
"RTN","XMJMLR1",105,0)
 I XMCNT<(IOSL-I-4) D  Q
"RTN","XMJMLR1",106,0)
 . F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""  D
"RTN","XMJMLR1",107,0)
 . . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJMLR1",108,0)
 . . S I=I+1,XMHELP(I)=" "_$E(XMCMD_"                   ",1,20)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJMLR1",109,0)
 S XMROWS=(XMCNT+1\2)+I
"RTN","XMJMLR1",110,0)
 S XMSAVE=I
"RTN","XMJMLR1",111,0)
 F  D  Q:I=XMROWS
"RTN","XMJMLR1",112,0)
 . S XMCMD=$O(XMOX("X",XMCMD))
"RTN","XMJMLR1",113,0)
 . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJMLR1",114,0)
 . S I=I+1,XMHELP(I)=" "_$E(XMCMD_"      ",1,XMLEN+2)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJMLR1",115,0)
 S I=XMSAVE
"RTN","XMJMLR1",116,0)
 F  S XMCMD=$O(XMOX("X",XMCMD)) Q:XMCMD=""  D
"RTN","XMJMLR1",117,0)
 . Q:$D(XMOPT(XMOX("X",XMCMD),"?"))
"RTN","XMJMLR1",118,0)
 . S I=I+1,XMHELP(I)=$E(XMHELP(I)_"                                   ",1,39)_"  "_$E(XMCMD_"      ",1,XMLEN+2)_XMOPT(XMOX("X",XMCMD))
"RTN","XMJMLR1",119,0)
 Q
"RTN","XMJMOI")
0^4^B71095558
"RTN","XMJMOI",1,0)
XMJMOI ;ISC-SF/GMB-Options at Ignore prompt ;02/22/2000  13:08
"RTN","XMJMOI",2,0)
 ;;7.1;MailMan;**50,87,89,110**;Jun 02, 1994
"RTN","XMJMOI",3,0)
 ; Replaces ^XMA1,^XMA10 (ISC-WASH/CAP/THM)
"RTN","XMJMOI",4,0)
READMSG(XMNEWS,XMDUZ,XMK,XMKN,XMZ,XMABORT) ;
"RTN","XMJMOI",5,0)
 N XMFINISH,XMFROM,XMINSTR,XMRESTR,XMIEN,XMSUBJ,XMSETPRI,XMRESPSO,XMRESP,XMORIGN8,XMDIR,XMY,XMOPT,XMOX,XMINCL
"RTN","XMJMOI",6,0)
 D INIT^XMJMOI1(XMDUZ,XMZ,.XMSUBJ,.XMFROM,.XMORIGN8,.XMINSTR,.XMRESTR,.XMIEN,.XMRESPSO,.XMRESP)
"RTN","XMJMOI",7,0)
 S (XMFINISH,XMABORT)=0
"RTN","XMJMOI",8,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMJMOI",9,0)
 . N XMNAME
"RTN","XMJMOI",10,0)
 . D READSET(XMDUZ,XMK,XMKN,XMZ,XMFROM,XMORIGN8,.XMINSTR,XMIEN,.XMDIR,.XMOPT,.XMOX,.XMINCL)
"RTN","XMJMOI",11,0)
 . I XMIEN,'$D(XMOPT("B","?")) D CHKRESP^XMJMP(XMDUZ,XMZ,XMRESPSO,XMRESP)
"RTN","XMJMOI",12,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT)
"RTN","XMJMOI",13,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMOI",14,0)
 . Q:XMABORT
"RTN","XMJMOI",15,0)
 . D @XMY
"RTN","XMJMOI",16,0)
 D:XMINSTR("FLAGS")["P" PRIORITY^XMJMOI1
"RTN","XMJMOI",17,0)
 I XMINSTR("FLAGS")["N" D  Q
"RTN","XMJMOI",18,0)
 . I XMNEWS D  Q
"RTN","XMJMOI",19,0)
 . . I $D(^TMP("XM",$J,"MAKENEW",XMZ)),$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",20,0)
 . D MAKENEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",21,0)
 ;I 'XMABORT,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),+XMRESP=+$P($G(^XMB(3.9,XMZ,3,0)),U,4) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",22,0)
 I 'XMABORT,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",23,0)
 I XMABORT,XMNEWS,'$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) S ^TMP("XM",$J,"MAKENEW",XMZ)=""
"RTN","XMJMOI",24,0)
 Q
"RTN","XMJMOI",25,0)
READSET(XMDUZ,XMK,XMKN,XMZ,XMFROM,XMORIGN8,XMINSTR,XMIEN,XMDIR,XMOPT,XMOX,XMINCL) ;
"RTN","XMJMOI",26,0)
 N XMIM,XMIU,XMDEF
"RTN","XMJMOI",27,0)
 S XMIM("FROM")=XMFROM
"RTN","XMJMOI",28,0)
 S XMIU("ORIGN8")=XMORIGN8
"RTN","XMJMOI",29,0)
 S XMIU("IEN")=XMIEN
"RTN","XMJMOI",30,0)
 D OPTMSG^XMXSEC2(XMDUZ,XMK,XMZ,.XMIM,.XMINSTR,.XMIU,.XMOPT,.XMOX)
"RTN","XMJMOI",31,0)
 K XMOPT("QR"),XMOX("X",XMOX("O","QR")),XMOX("O","QR")
"RTN","XMJMOI",32,0)
 D SET^XMXSEC1("Q xxx",37420.1,.XMOPT,.XMOX) ; Query recipient(s) xxx
"RTN","XMJMOI",33,0)
 I XMV("NOSEND") D
"RTN","XMJMOI",34,0)
 . N XMNO,I
"RTN","XMJMOI",35,0)
 . S XMNO=$$EZBLD^DIALOG(37453) ; This session is concurrent with another.  You may not do this.
"RTN","XMJMOI",36,0)
 . F I="A","C","R","W" S XMOPT(I,"?")=XMNO
"RTN","XMJMOI",37,0)
 E  I $D(XMOPT("A","?")),XMOPT("A","?")=$$EZBLD^DIALOG(37401.1) S XMOPT("A","?X")="D CRE8NS^XMVVITA"
"RTN","XMJMOI",38,0)
 ; Activate this line:
"RTN","XMJMOI",39,0)
 ;S XMINCL="?"  ; When "R", ask user if responses should be included
"RTN","XMJMOI",40,0)
 ; Or the next three lines:
"RTN","XMJMOI",41,0)
 S XMINCL=0    ; When "R", do not include responses
"RTN","XMJMOI",42,0)
 M XMOPT("RI")=XMOPT("R") ; This will get any restrictions placed on Reply.
"RTN","XMJMOI",43,0)
 D SET^XMXSEC1("RI",37443,.XMOPT,.XMOX) ; Reply and Include responses
"RTN","XMJMOI",44,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34065,XMKN) ; Enter message action (in _XMKN_ basket):
"RTN","XMJMOI",45,0)
 ;S XMDIR("B")=XMOPT($S(XMDUZ=.6:"I",XMINSTR("FLAGS")["N":"I",XMK=1:XMV("MSG DEF"),1:"I"))
"RTN","XMJMOI",46,0)
 S XMDEF=$S(XMDUZ=.6:"I",XMINSTR("FLAGS")["N":"I",XMK=1:XMV("MSG DEF"),1:"I")
"RTN","XMJMOI",47,0)
 S XMDIR("B")=XMOX("O",XMDEF)_":"_XMOPT(XMDEF)
"RTN","XMJMOI",48,0)
 S XMDIR("PRE")="I XMX?1(1"""_XMOX("O","Q")_" "",1"""_$$LOW^XLFSTR(XMOX("O","Q"))_" "",1"""_XMOX("O","QD")_" "",1"""_$$LOW^XLFSTR(XMOX("O","QD"))_" "").E S XMNAME=$P(XMX,"" "",2,99),XMX="""_XMOX("O","QD")_""""
"RTN","XMJMOI",49,0)
 ;S XMDIR("PRE")="I XMX?1(1""Q "",1""q "",1""QD "",1""qd "").E S XMNAME=$P(XMX,"" "",2,99),XMX=""QD"""
"RTN","XMJMOI",50,0)
 Q
"RTN","XMJMOI",51,0)
A ; Answer to sender only
"RTN","XMJMOI",52,0)
 D ANSWER^XMJMA(XMDUZ,XMZ,XMSUBJ,XMFROM)
"RTN","XMJMOI",53,0)
 D IMBACK^XMJMOI1(34070) ; Finished with 'Answer' command.
"RTN","XMJMOI",54,0)
 Q
"RTN","XMJMOI",55,0)
AA ; Access Attachments
"RTN","XMJMOI",56,0)
 N XMAPBLOB
"RTN","XMJMOI",57,0)
 I $G(IOT)="IMPC" D BLOB^XMAPBLOB Q
"RTN","XMJMOI",58,0)
 D NODISP^XMAPBLOB
"RTN","XMJMOI",59,0)
 Q
"RTN","XMJMOI",60,0)
B ; Backup
"RTN","XMJMOI",61,0)
 D BACKUP^XMJMP(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",62,0)
 S XMRESP=$P($G(^XMB(3.9,XMZ,1,XMIEN,0)),U,2)
"RTN","XMJMOI",63,0)
 Q
"RTN","XMJMOI",64,0)
C ; Copy
"RTN","XMJMOI",65,0)
 D COPY^XMJMC(XMDUZ,XMK,XMZ,XMFROM)
"RTN","XMJMOI",66,0)
 D IMBACK^XMJMOI1(34071) ; Finished with 'Copy' command.
"RTN","XMJMOI",67,0)
 Q
"RTN","XMJMOI",68,0)
D ; Delete
"RTN","XMJMOI",69,0)
 D DEL^XMXMSGS2(XMDUZ,XMK,XMZ)
"RTN","XMJMOI",70,0)
 W !,$$EZBLD^DIALOG(34302.2) ; Message deleted.
"RTN","XMJMOI",71,0)
 S XMFINISH=1
"RTN","XMJMOI",72,0)
 Q:XMINSTR("FLAGS")'["N"
"RTN","XMJMOI",73,0)
 S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"N")
"RTN","XMJMOI",74,0)
 K:XMNEWS ^TMP("XM",$J,"MAKENEW",XMZ)
"RTN","XMJMOI",75,0)
 Q
"RTN","XMJMOI",76,0)
E ; Edit
"RTN","XMJMOI",77,0)
 D EDIT^XMJMOIE(XMDUZ,XMK,XMZ,.XMSUBJ,.XMINSTR,.XMRESTR)
"RTN","XMJMOI",78,0)
 Q
"RTN","XMJMOI",79,0)
F ; Forward
"RTN","XMJMOI",80,0)
 N XMABORT
"RTN","XMJMOI",81,0)
 S XMABORT=0
"RTN","XMJMOI",82,0)
 D INIT^XMXADDR
"RTN","XMJMOI",83,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,.XMRESTR,.XMABORT)  ; Find out to whom to forward
"RTN","XMJMOI",84,0)
 I 'XMABORT D
"RTN","XMJMOI",85,0)
 . D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMOI",86,0)
 . W !,$$EZBLD^DIALOG(34309.2) ; Message forwarded.
"RTN","XMJMOI",87,0)
 D CLEANUP^XMXADDR
"RTN","XMJMOI",88,0)
 Q
"RTN","XMJMOI",89,0)
H ; Headerless Print
"RTN","XMJMOI",90,0)
 D PRINT^XMJMP(XMDUZ,XMK,XMZ,0)
"RTN","XMJMOI",91,0)
 S XMRESP=$P($G(^XMB(3.9,XMZ,1,XMIEN,0)),U,2)
"RTN","XMJMOI",92,0)
 Q
"RTN","XMJMOI",93,0)
I ; Ignore
"RTN","XMJMOI",94,0)
 S XMFINISH=1
"RTN","XMJMOI",95,0)
 Q
"RTN","XMJMOI",96,0)
IN ; Information Only toggle
"RTN","XMJMOI",97,0)
 I $G(XMINSTR("FLAGS"))["I" D
"RTN","XMJMOI",98,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"I")
"RTN","XMJMOI",99,0)
 . S $P(^XMB(3.9,XMZ,0),U,12)=""
"RTN","XMJMOI",100,0)
 . W !,$$EZBLD^DIALOG(37409.9) ; Message is no longer 'Information only'.
"RTN","XMJMOI",101,0)
 E  D
"RTN","XMJMOI",102,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_"I"
"RTN","XMJMOI",103,0)
 . S $P(^XMB(3.9,XMZ,0),U,12)="y"
"RTN","XMJMOI",104,0)
 . W !,$$EZBLD^DIALOG(37408.9) ; Message is now 'Information only'.  No one may reply.
"RTN","XMJMOI",105,0)
 Q
"RTN","XMJMOI",106,0)
K ; Toggle Priority of future replies
"RTN","XMJMOI",107,0)
 I $G(XMINSTR("FLAGS"))["K" D
"RTN","XMJMOI",108,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"K")
"RTN","XMJMOI",109,0)
 . S $P(^XMB(3.9,XMZ,1,XMIEN,0),U,9)=1
"RTN","XMJMOI",110,0)
 . W !,$$EZBLD^DIALOG(37412.9) ; Responses will not be delivered as Priority Mail.
"RTN","XMJMOI",111,0)
 E  D
"RTN","XMJMOI",112,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_"K"
"RTN","XMJMOI",113,0)
 . S $P(^XMB(3.9,XMZ,1,XMIEN,0),U,9)=""
"RTN","XMJMOI",114,0)
 . W !,$$EZBLD^DIALOG(37411.9) ; Responses will be delivered as Priority Mail.
"RTN","XMJMOI",115,0)
 S XMSETPRI=1
"RTN","XMJMOI",116,0)
 Q
"RTN","XMJMOI",117,0)
L ; Later
"RTN","XMJMOI",118,0)
 D LATER^XMJMD(XMDUZ,XMZ)
"RTN","XMJMOI",119,0)
 Q
"RTN","XMJMOI",120,0)
N ; Toggle New
"RTN","XMJMOI",121,0)
 I XMINSTR("FLAGS")["N" D
"RTN","XMJMOI",122,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"N")
"RTN","XMJMOI",123,0)
 . K:XMNEWS ^TMP("XM",$J,"MAKENEW",XMZ)
"RTN","XMJMOI",124,0)
 . W !,$$EZBLD^DIALOG(37415.9) ; Message will NOT be new next time.
"RTN","XMJMOI",125,0)
 E  D
"RTN","XMJMOI",126,0)
 . S XMINSTR("FLAGS")=XMINSTR("FLAGS")_"N"
"RTN","XMJMOI",127,0)
 . S:XMNEWS ^TMP("XM",$J,"MAKENEW",XMZ)=""
"RTN","XMJMOI",128,0)
 . W !,$$EZBLD^DIALOG(37414.9) ; Message will be new next time.
"RTN","XMJMOI",129,0)
 . I XMK>.5!XMNEWS Q
"RTN","XMJMOI",130,0)
 . D SAVEMSG(XMDUZ,.XMK,.XMKN,XMZ,XMSUBJ,XMFROM,$G(XMINSTR("RCPT BSKT")))
"RTN","XMJMOI",131,0)
 Q
"RTN","XMJMOI",132,0)
P ; Print
"RTN","XMJMOI",133,0)
 N XMABORT
"RTN","XMJMOI",134,0)
 S XMABORT=0
"RTN","XMJMOI",135,0)
 I XMINSTR("TYPE")["K"!(XMINSTR("TYPE")["X") D  Q:XMABORT
"RTN","XMJMOI",136,0)
 . N DIR,XMMSG,XMPARM
"RTN","XMJMOI",137,0)
 . S XMMSG=$$EZBLD^DIALOG($S(XMINSTR("TYPE")["K":34076,1:34077)) ; KIDS build / PackMan message
"RTN","XMJMOI",138,0)
 . D BLD^DIALOG(34078,XMMSG,"","DIR(""A"")") ; Print just the descriptive text of this _XMMSG
"RTN","XMJMOI",139,0)
 . ;This is a _XMMSG_.
"RTN","XMJMOI",140,0)
 . ;Answer YES to print just the descriptive text.
"RTN","XMJMOI",141,0)
 . ;Answer NO to print the whole thing (x lines) and/or any responses.
"RTN","XMJMOI",142,0)
 . S XMPARM(1)=XMMSG,XMPARM(2)=$$LINE^XMXUTIL2(XMZ)
"RTN","XMJMOI",143,0)
 . D BLD^DIALOG(34079,.XMPARM,"","DIR(""?"")") ; Print just the descriptive text of this _XMMSG
"RTN","XMJMOI",144,0)
 . S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39054) ; Yes
"RTN","XMJMOI",145,0)
 . D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMOI",146,0)
 . Q:'Y
"RTN","XMJMOI",147,0)
 . N A,DIE,DIF,X,XCF,XCN,XMR
"RTN","XMJMOI",148,0)
 . S XMR=^XMB(3.9,XMZ,0)
"RTN","XMJMOI",149,0)
 . D XT^XMP2
"RTN","XMJMOI",150,0)
 . S XMABORT=1
"RTN","XMJMOI",151,0)
 D PRINT^XMJMP(XMDUZ,XMK,XMZ)
"RTN","XMJMOI",152,0)
 S XMRESP=$P($G(^XMB(3.9,XMZ,1,XMIEN,0)),U,2)
"RTN","XMJMOI",153,0)
 Q
"RTN","XMJMOI",154,0)
Q ; Query
"RTN","XMJMOI",155,0)
 D Q^XMJMQ(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",156,0)
 Q
"RTN","XMJMOI",157,0)
QD ; Query Detailed
"RTN","XMJMOI",158,0)
 I $D(XMNAME) D QNAMEX^XMJMQ(XMDUZ,XMK,XMKN,XMZ,XMNAME) Q
"RTN","XMJMOI",159,0)
 D QD^XMJMQ(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",160,0)
 Q
"RTN","XMJMOI",161,0)
QN ; Query Network
"RTN","XMJMOI",162,0)
 D QN^XMJMQ(XMDUZ,XMK,XMKN,XMZ)
"RTN","XMJMOI",163,0)
 Q
"RTN","XMJMOI",164,0)
RI ; Reply, Include previous response(s)
"RTN","XMJMOI",165,0)
 S XMINCL=1
"RTN","XMJMOI",166,0)
R ; Reply
"RTN","XMJMOI",167,0)
 I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),+XMRESP=+$P($G(^XMB(3.9,XMZ,3,0)),U,4) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",168,0)
 D REPLY^XMJMR(XMDUZ,.XMK,.XMKN,XMZ,XMSUBJ,XMFROM,.XMINSTR,XMIEN,XMRESPSO,XMINCL,.XMRESP)
"RTN","XMJMOI",169,0)
 Q
"RTN","XMJMOI",170,0)
S ; Save (replaces S^XMA1B)
"RTN","XMJMOI",171,0)
 N XMKTO,XMDIC
"RTN","XMJMOI",172,0)
 I XMK S XMDIC("B")="@" ; no default basket
"RTN","XMJMOI",173,0)
 E  D
"RTN","XMJMOI",174,0)
 . N XMKTO
"RTN","XMJMOI",175,0)
 . S XMKTO=0
"RTN","XMJMOI",176,0)
 . D CHEKBSKT^XMTDL2(XMDUZ,.XMKTO,XMSUBJ,XMFROM,$G(XMINSTR("RCPT BSKT")))
"RTN","XMJMOI",177,0)
 . S XMDIC("B")=$P(^XMB(3.7,XMDUZ,2,XMKTO,0),U)
"RTN","XMJMOI",178,0)
 D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325.1),"L",.XMDIC,.XMKTO) Q:XMKTO=U  ; Save message into basket:
"RTN","XMJMOI",179,0)
 I XMKTO=XMK D
"RTN","XMJMOI",180,0)
 . W !,$$EZBLD^DIALOG(34326.1) ; That's the same basket the message is already in.
"RTN","XMJMOI",181,0)
 E  D
"RTN","XMJMOI",182,0)
 . I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMOI",183,0)
 . D MOVE^XMXMSGS2(XMDUZ,XMK,XMZ,XMKTO)
"RTN","XMJMOI",184,0)
 . W !,$$EZBLD^DIALOG(34324.2) ; Message saved.
"RTN","XMJMOI",185,0)
 . S XMK=XMKTO
"RTN","XMJMOI",186,0)
 S XMFINISH=1
"RTN","XMJMOI",187,0)
 Q
"RTN","XMJMOI",188,0)
T ; Terminate (replaces T^XMA1)
"RTN","XMJMOI",189,0)
 D TERM^XMXMSGS2(XMDUZ,XMK,XMZ)
"RTN","XMJMOI",190,0)
 W !,$$EZBLD^DIALOG($S(XMK<1:34331.1,1:34331)) ; You won't see future replies.  (In WASTE basket)
"RTN","XMJMOI",191,0)
 S XMFINISH=1
"RTN","XMJMOI",192,0)
 S:XMINSTR("FLAGS")["P" XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"P")
"RTN","XMJMOI",193,0)
 Q:XMINSTR("FLAGS")'["N"
"RTN","XMJMOI",194,0)
 S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),"N")
"RTN","XMJMOI",195,0)
 K:XMNEWS ^TMP("XM",$J,"MAKENEW",XMZ)
"RTN","XMJMOI",196,0)
 Q
"RTN","XMJMOI",197,0)
V ; Set Vaporize date for msg in basket (replaces DATE^XMA11A)
"RTN","XMJMOI",198,0)
 N DIE,DA,DR
"RTN","XMJMOI",199,0)
 L +^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)
"RTN","XMJMOI",200,0)
 S DIE="^XMB(3.7,"_XMDUZ_",2,"_XMK_",1,"
"RTN","XMJMOI",201,0)
 S DA(2)=XMDUZ,DA(1)=XMK,DA=XMZ
"RTN","XMJMOI",202,0)
 S DR=5
"RTN","XMJMOI",203,0)
 D ^DIE
"RTN","XMJMOI",204,0)
 L -^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)
"RTN","XMJMOI",205,0)
 Q
"RTN","XMJMOI",206,0)
W ; Write a new msg
"RTN","XMJMOI",207,0)
 N XMSECURE,XMPAKMAN,XMSECBAD  ; Needed!  (In case Write from KIDS msg.)
"RTN","XMJMOI",208,0)
 D SEND^XMJMS
"RTN","XMJMOI",209,0)
 D IMBACK^XMJMOI1(34072) ; Finished with 'Write' command.
"RTN","XMJMOI",210,0)
 Q
"RTN","XMJMOI",211,0)
X ; Xtract PackMan msg
"RTN","XMJMOI",212,0)
 N X,DIC,C,I,ER,J,K,T,X2,XCF,XCM,XCN,XMKEY,XMKEYTRY,XMLOC,XMN,XMP0,XMR,XMRW,XMS
"RTN","XMJMOI",213,0)
 S X=XMZ,DIC(0)="N"
"RTN","XMJMOI",214,0)
 D MM^XMP
"RTN","XMJMOI",215,0)
 Q
"RTN","XMJMOI",216,0)
SAVEMSG(XMDUZ,XMK,XMKN,XMZ,XMSUBJ,XMFROM,XMZBSKT) ;
"RTN","XMJMOI",217,0)
 ; The message is currently in the waste basket or no basket.
"RTN","XMJMOI",218,0)
 ; Save it to an appropriate (not waste) basket.
"RTN","XMJMOI",219,0)
 N XMKTO
"RTN","XMJMOI",220,0)
 S XMKTO=0
"RTN","XMJMOI",221,0)
 D CHEKBSKT^XMTDL2(XMDUZ,.XMKTO,XMSUBJ,XMFROM,$G(XMINSTR("RCPT BSKT")))
"RTN","XMJMOI",222,0)
 S:XMKTO=.5 XMKTO=1
"RTN","XMJMOI",223,0)
 S XMKN=$P(^XMB(3.7,XMDUZ,2,XMKTO,0),U,1)
"RTN","XMJMOI",224,0)
 I 'XMK D
"RTN","XMJMOI",225,0)
 . D PUTMSG^XMXMSGS2(XMDUZ,XMKTO,XMKN,XMZ)
"RTN","XMJMOI",226,0)
 E  D
"RTN","XMJMOI",227,0)
 . ; Message is in waste basket
"RTN","XMJMOI",228,0)
 . D COPYIT^XMXMSGS2(XMDUZ,.5,XMZ,XMKTO)
"RTN","XMJMOI",229,0)
 . D ZAPIT^XMXMSGS2(XMDUZ,.5,XMZ)
"RTN","XMJMOI",230,0)
 S XMK=XMKTO
"RTN","XMJMOI",231,0)
 W !,$$EZBLD^DIALOG(34325.9) ; Message saved to _XMKN_ basket.
"RTN","XMJMOI",232,0)
 Q
"RTN","XMJMOI1")
0^28^B4607562
"RTN","XMJMOI1",1,0)
XMJMOI1 ;ISC-SF/GMB-Options at Ignore prompt (continued) ;01/07/2000  10:02
"RTN","XMJMOI1",2,0)
 ;;7.1;MailMan;**110**;Jun 02, 1994
"RTN","XMJMOI1",3,0)
INIT(XMDUZ,XMZ,XMSUBJ,XMFROM,XMORIGN8,XMINSTR,XMRESTR,XMIEN,XMRESPSO,XMRESP) ;
"RTN","XMJMOI1",4,0)
 N XMZREC,XMIM,XMIU
"RTN","XMJMOI1",5,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMOI1",6,0)
 D INMSG^XMXUTIL2(XMDUZ,0,XMZ,XMZREC,"I",.XMIM,.XMINSTR,.XMIU)
"RTN","XMJMOI1",7,0)
 S XMSUBJ=XMIM("SUBJ")
"RTN","XMJMOI1",8,0)
 S XMFROM=XMIM("FROM")
"RTN","XMJMOI1",9,0)
 S XMRESPSO=XMIM("RESPS")
"RTN","XMJMOI1",10,0)
 S XMIEN=XMIU("IEN")
"RTN","XMJMOI1",11,0)
 S XMORIGN8=XMIU("ORIGN8")
"RTN","XMJMOI1",12,0)
 S XMRESP=XMIU("RESP")
"RTN","XMJMOI1",13,0)
 D GETRESTR^XMXSEC1(XMDUZ,XMZ,XMZREC,.XMINSTR,.XMRESTR) ; Get restrictions
"RTN","XMJMOI1",14,0)
 I $D(XMRESTR("FLAGS")) K XMRESTR("FLAGS") ; We'll have these in XMINSTR("FLAGS"), and they may be changed during user edit.
"RTN","XMJMOI1",15,0)
 Q
"RTN","XMJMOI1",16,0)
IMBACK(XMDIALOG) ;
"RTN","XMJMOI1",17,0)
 W *7,!!,$$EZBLD^DIALOG(XMDIALOG),!,$$EZBLD^DIALOG(34075),!! ; Finished.  Now back to:
"RTN","XMJMOI1",18,0)
 D HEADER^XMJMP1(XMDUZ,XMK,XMKN,XMZ,$$ZREAD^XMXUTIL2(XMDUZ,XMZ),^XMB(3.9,XMZ,0),$$EZBLD^DIALOG(34536,XMSUBJ),$$EZBLD^DIALOG(34537,XMZ)) ; Subj: _XMSUBJ / [#_XMZ_]
"RTN","XMJMOI1",19,0)
 Q
"RTN","XMJMOI1",20,0)
PRIORITY ; For priority msgs, ask user if replies should be priority.
"RTN","XMJMOI1",21,0)
 ; Don't ask if the user has already issued a priority toggle,
"RTN","XMJMOI1",22,0)
 ; or if the user has chosen never to be asked.
"RTN","XMJMOI1",23,0)
 Q:XMDUZ=.5&(XMK>999)
"RTN","XMJMOI1",24,0)
 Q:$G(XMSETPRI)!$P(^XMB(3.7,DUZ,0),U,12)
"RTN","XMJMOI1",25,0)
 N DIR,Y,DIRUT
"RTN","XMJMOI1",26,0)
 ;This message is a priority message.
"RTN","XMJMOI1",27,0)
 ;Deliver future responses to this message as Priority Mail
"RTN","XMJMOI1",28,0)
 W !
"RTN","XMJMOI1",29,0)
 S DIR(0)="Y"
"RTN","XMJMOI1",30,0)
 D BLD^DIALOG(34081,"","","DIR(""A"")")
"RTN","XMJMOI1",31,0)
 S DIR("B")=$$EZBLD^DIALOG($S(XMINSTR("FLAGS")["K":39054,1:39053)) ; Yes / No
"RTN","XMJMOI1",32,0)
 S DIR("??")="^D QQPRI^XMJMOI1"
"RTN","XMJMOI1",33,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMOI1",34,0)
 I (XMINSTR("FLAGS")["K"&(Y=0))!(XMINSTR("FLAGS")'["K"&(Y=1)) D K^XMJMOI
"RTN","XMJMOI1",35,0)
 Q
"RTN","XMJMOI1",36,0)
QQPRI ;
"RTN","XMJMOI1",37,0)
 N XMTEXT
"RTN","XMJMOI1",38,0)
 D BLD^DIALOG(34082,"","","XMTEXT","F")
"RTN","XMJMOI1",39,0)
 D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMOI1",40,0)
 ;Your answer determines, for this message,
"RTN","XMJMOI1",41,0)
 ;how MailMan delivers responses to you.
"RTN","XMJMOI1",42,0)
 ;Note: Recipients can determine for themselves, on a message by message
"RTN","XMJMOI1",43,0)
 ;basis, how responses to priority messages are delivered to them.
"RTN","XMJMOI1",44,0)
 ;It follows that responses to priority messages are not necessarily
"RTN","XMJMOI1",45,0)
 ;delivered as Priority Mail to all recipients.
"RTN","XMJMOI1",46,0)
 Q
"RTN","XMJMOIE")
0^20^B6462183
"RTN","XMJMOIE",1,0)
XMJMOIE ;ISC-SF/GMB-Edit msg that user has sent to self ;01/20/2000  15:51
"RTN","XMJMOIE",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMOIE",3,0)
EDIT(XMDUZ,XMK,XMZ,XMSUBJ,XMINSTR,XMRESTR) ;
"RTN","XMJMOIE",4,0)
 N XMABORT,XMDIR,XMOPT,XMOX,XMY
"RTN","XMJMOIE",5,0)
 S XMABORT=0
"RTN","XMJMOIE",6,0)
 F  D  Q:XMABORT
"RTN","XMJMOIE",7,0)
 . D SENDSET(.XMINSTR,.XMOPT,.XMOX,.XMDIR)
"RTN","XMJMOIE",8,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMOIE",9,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMOIE",10,0)
 . D @XMY
"RTN","XMJMOIE",11,0)
 Q
"RTN","XMJMOIE",12,0)
SENDSET(XMINSTR,XMOPT,XMOX,XMDIR) ;
"RTN","XMJMOIE",13,0)
 D OPTEDIT^XMXSEC2(.XMINSTR,.XMOPT,.XMOX)
"RTN","XMJMOIE",14,0)
 I $D(XMOPT("NS","?")),XMOPT("NS","?")=$$EZBLD^DIALOG(37309.1) S XMOPT("NS","?X")="D CRE8NS^XMVVITA"
"RTN","XMJMOIE",15,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34066) ; Select Edit option:
"RTN","XMJMOIE",16,0)
 S XMDIR("??")="XM-U-MO-EDIT"
"RTN","XMJMOIE",17,0)
 Q
"RTN","XMJMOIE",18,0)
C ; Confidential msg
"RTN","XMJMOIE",19,0)
 N XMMSG
"RTN","XMJMOIE",20,0)
 D CONFID^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",21,0)
 I $D(XMERR) D SHOW^XMJERR Q
"RTN","XMJMOIE",22,0)
 W !,XMMSG
"RTN","XMJMOIE",23,0)
 Q
"RTN","XMJMOIE",24,0)
D ; Delivery basket
"RTN","XMJMOIE",25,0)
 N XMMSG
"RTN","XMJMOIE",26,0)
 I $D(XMINSTR("RCPT BSKT")) D  Q
"RTN","XMJMOIE",27,0)
 . D DELIVER^XMXEDIT(XMZ,"@",.XMINSTR,.XMMSG)
"RTN","XMJMOIE",28,0)
 . W !,XMMSG
"RTN","XMJMOIE",29,0)
 D D^XMJMSO
"RTN","XMJMOIE",30,0)
 Q:'$D(XMINSTR("RCPT BSKT"))
"RTN","XMJMOIE",31,0)
 D DELIVER^XMXEDIT(XMZ,XMINSTR("RCPT BSKT"),.XMINSTR,.XMMSG)
"RTN","XMJMOIE",32,0)
 Q
"RTN","XMJMOIE",33,0)
ES ; Edit Subject
"RTN","XMJMOIE",34,0)
 D ES^XMJMSO
"RTN","XMJMOIE",35,0)
 Q
"RTN","XMJMOIE",36,0)
ET ; Edit Text
"RTN","XMJMOIE",37,0)
 I $G(XMPAKMAN) Q:$$NOPAKEDT^XMJMSO
"RTN","XMJMOIE",38,0)
 I $D(XMSECURE) D
"RTN","XMJMOIE",39,0)
 . N XMIA S XMIA=1
"RTN","XMJMOIE",40,0)
 . D DECMSG^XMJMCODE(XMZ)
"RTN","XMJMOIE",41,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR)
"RTN","XMJMOIE",42,0)
 I $D(XMSECURE) D
"RTN","XMJMOIE",43,0)
 . N XMIA S XMIA=1
"RTN","XMJMOIE",44,0)
 . D ENCMSG^XMJMCODE(XMZ)
"RTN","XMJMOIE",45,0)
 Q
"RTN","XMJMOIE",46,0)
I ; Information only msg
"RTN","XMJMOIE",47,0)
 N XMMSG
"RTN","XMJMOIE",48,0)
 D INFO^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",49,0)
 W !,XMMSG
"RTN","XMJMOIE",50,0)
 Q
"RTN","XMJMOIE",51,0)
NS ; Add Network Signature
"RTN","XMJMOIE",52,0)
 D NS^XMJMSO
"RTN","XMJMOIE",53,0)
 Q
"RTN","XMJMOIE",54,0)
P ; Priority msg
"RTN","XMJMOIE",55,0)
 N XMMSG
"RTN","XMJMOIE",56,0)
 D PRIORITY^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",57,0)
 W !,XMMSG
"RTN","XMJMOIE",58,0)
 Q
"RTN","XMJMOIE",59,0)
R ; Confirm receipt of msg
"RTN","XMJMOIE",60,0)
 N XMMSG
"RTN","XMJMOIE",61,0)
 D CONFIRM^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",62,0)
 W !,XMMSG
"RTN","XMJMOIE",63,0)
 Q
"RTN","XMJMOIE",64,0)
S ; Scramble msg
"RTN","XMJMOIE",65,0)
 N XMMSG
"RTN","XMJMOIE",66,0)
 I $D(XMSECURE) D  Q
"RTN","XMJMOIE",67,0)
 . D SCRAMBLE^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",68,0)
 . W !,XMMSG
"RTN","XMJMOIE",69,0)
 D S^XMJMSO
"RTN","XMJMOIE",70,0)
 Q:'$D(XMINSTR("SCR KEY"))
"RTN","XMJMOIE",71,0)
 D SCRAMBLE^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",72,0)
 Q
"RTN","XMJMOIE",73,0)
V ; Vaporize date
"RTN","XMJMOIE",74,0)
 N XMMSG
"RTN","XMJMOIE",75,0)
 I $G(XMINSTR("VAPOR")) D  Q
"RTN","XMJMOIE",76,0)
 . D VAPOR^XMXEDIT(XMZ,"@",.XMINSTR,.XMMSG)
"RTN","XMJMOIE",77,0)
 . W !,XMMSG
"RTN","XMJMOIE",78,0)
 D V^XMJMSO
"RTN","XMJMOIE",79,0)
 Q:'$D(XMINSTR("VAPOR"))
"RTN","XMJMOIE",80,0)
 D VAPOR^XMXEDIT(XMZ,XMINSTR("VAPOR"),.XMINSTR,.XMMSG)
"RTN","XMJMOIE",81,0)
 Q
"RTN","XMJMOIE",82,0)
X ; Closed msg
"RTN","XMJMOIE",83,0)
 N XMMSG
"RTN","XMJMOIE",84,0)
 D CLOSED^XMXEDIT(XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMOIE",85,0)
 I $D(XMERR) D SHOW^XMJERR Q
"RTN","XMJMOIE",86,0)
 W !,XMMSG
"RTN","XMJMOIE",87,0)
 Q
"RTN","XMJMOR")
0^13^B68946250
"RTN","XMJMOR",1,0)
XMJMOR ;ISC-SF/GMB-Range actions ;01/20/2000  09:40
"RTN","XMJMOR",2,0)
 ;;7.1;MailMan;**50,75,110**;Jun 02, 1994
"RTN","XMJMOR",3,0)
 ; Replaces ^XMA0,^XMA01 (ISC-WASH/CAP)
"RTN","XMJMOR",4,0)
DELETE(XMDUZ,XMK) ; Delete a range of messages
"RTN","XMJMOR",5,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",6,0)
 S XMABORT=0
"RTN","XMJMOR",7,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",8,0)
 . D SELMSG^XMJMORX(XMDUZ,0,0,XMK,"XDEL^XMJMORX1",34302,34303,.XMMSG,.XMABORT)
"RTN","XMJMOR",9,0)
 . ;K ^TMP("XM",$J,".")
"RTN","XMJMOR",10,0)
 E  D
"RTN","XMJMOR",11,0)
 . D WHICH(XMDUZ,XMK,34301,34303.1,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",12,0)
 . D DELMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",13,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",14,0)
 Q:XMABORT
"RTN","XMJMOR",15,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",16,0)
 Q
"RTN","XMJMOR",17,0)
FILTER(XMDUZ,XMK) ; Filter a range of messages
"RTN","XMJMOR",18,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",19,0)
 S XMABORT=0
"RTN","XMJMOR",20,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",21,0)
 . N XMKZ
"RTN","XMJMOR",22,0)
 . D SELMSG(XMDUZ,XMK,"XFLTR^XMXMSGS2",34306,.XMMSG)
"RTN","XMJMOR",23,0)
 . S XMKZ=""
"RTN","XMJMOR",24,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  K:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMOR",25,0)
 E  D
"RTN","XMJMOR",26,0)
 . D WHICH(XMDUZ,XMK,34305,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",27,0)
 . D FLTRMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",28,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",29,0)
 Q:XMABORT
"RTN","XMJMOR",30,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",31,0)
 Q
"RTN","XMJMOR",32,0)
FORWARD(XMDUZ,XMK) ; Forward a range of messages
"RTN","XMJMOR",33,0)
 N XMWHICH,XMMSG,XMABORT,XMINSTR
"RTN","XMJMOR",34,0)
 S XMABORT=0
"RTN","XMJMOR",35,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMOR",36,0)
 . N XMKZ
"RTN","XMJMOR",37,0)
 . D INIT^XMXADDR
"RTN","XMJMOR",38,0)
 . S XMKZ=$O(^TMP("XM",$J,".",""))
"RTN","XMJMOR",39,0)
 . I '$O(^TMP("XM",$J,".",XMKZ)) D  Q
"RTN","XMJMOR",40,0)
 . . D FWDONE(XMDUZ,$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")),.XMINSTR,.XMABORT)
"RTN","XMJMOR",41,0)
 . D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMOR",42,0)
 . D SELMSG(XMDUZ,XMK,"XFWD^XMXMSGS1",34309,.XMMSG)
"RTN","XMJMOR",43,0)
 . D CLEANUP^XMXADDR
"RTN","XMJMOR",44,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",45,0)
 . W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",46,0)
 D WHICH(XMDUZ,XMK,34308,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",47,0)
 D INIT^XMXADDR
"RTN","XMJMOR",48,0)
 I $P(XMWHICH,",",2,99)="",$P(XMWHICH,",",1)=+XMWHICH D  Q
"RTN","XMJMOR",49,0)
 . N XMZ
"RTN","XMJMOR",50,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",+XMWHICH,""))
"RTN","XMJMOR",51,0)
 . I 'XMZ W !,$$EZBLD^DIALOG(34309.3) Q  ; No messages forwarded.
"RTN","XMJMOR",52,0)
 . D FWDONE(XMDUZ,XMZ,.XMINSTR,.XMABORT)
"RTN","XMJMOR",53,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMOR",54,0)
 S XMINSTR("ADDR FLAGS")="I"
"RTN","XMJMOR",55,0)
 D FWDMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,"",.XMINSTR,.XMMSG)
"RTN","XMJMOR",56,0)
 D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",57,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",58,0)
 Q
"RTN","XMJMOR",59,0)
FWDONE(XMDUZ,XMZ,XMINSTR,XMABORT) ; Forward just one message
"RTN","XMJMOR",60,0)
 N XMZREC,XMRESTR
"RTN","XMJMOR",61,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMOR",62,0)
 I '$$FORWARD^XMXSEC(XMDUZ,XMZ,XMZREC) D SHOW^XMJERR Q
"RTN","XMJMOR",63,0)
 D GETRESTR^XMXSEC1(XMDUZ,XMZ,XMZREC,"",.XMRESTR) ; Get restrictions on the msg
"RTN","XMJMOR",64,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,.XMRESTR,.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMOR",65,0)
 D FWD^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMOR",66,0)
 D CLEANUP^XMXADDR
"RTN","XMJMOR",67,0)
 W !,$$EZBLD^DIALOG(34309.2) ; Message forwarded.
"RTN","XMJMOR",68,0)
 Q
"RTN","XMJMOR",69,0)
LATER(XMDUZ,XMK) ; Later a range of messages
"RTN","XMJMOR",70,0)
 N XMWHICH,XMMSG,XMABORT,XMWHEN
"RTN","XMJMOR",71,0)
 S XMABORT=0
"RTN","XMJMOR",72,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",73,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMOR",74,0)
 . D SELMSG(XMDUZ,XMK,"XLATER^XMXMSGS2",34312,.XMMSG)
"RTN","XMJMOR",75,0)
 E  D
"RTN","XMJMOR",76,0)
 . N XMINSTR
"RTN","XMJMOR",77,0)
 . D WHICH(XMDUZ,XMK,34311,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",78,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMOR",79,0)
 . S XMINSTR("LATER")=XMWHEN
"RTN","XMJMOR",80,0)
 . D LATERMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMINSTR,.XMMSG)
"RTN","XMJMOR",81,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",82,0)
 Q:XMABORT
"RTN","XMJMOR",83,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",84,0)
 Q
"RTN","XMJMOR",85,0)
NEWTOGL(XMDUZ,XMK) ; New Toggle a range of messages
"RTN","XMJMOR",86,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",87,0)
 S XMABORT=0
"RTN","XMJMOR",88,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",89,0)
 . N XMKZ
"RTN","XMJMOR",90,0)
 . D SELMSG(XMDUZ,XMK,"XNTOGL^XMXMSGS2",34315,.XMMSG)
"RTN","XMJMOR",91,0)
 . S XMKZ=""
"RTN","XMJMOR",92,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  K:'$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMOR",93,0)
 E  D
"RTN","XMJMOR",94,0)
 . D WHICH(XMDUZ,XMK,34314,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",95,0)
 . D NTOGLMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",96,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",97,0)
 Q:XMABORT
"RTN","XMJMOR",98,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",99,0)
 Q
"RTN","XMJMOR",100,0)
PRINT(XMDUZ,XMK,XMPRTHDR) ; Print a range of messages
"RTN","XMJMOR",101,0)
 N XMWHICH,XMMSG,XMRECIPS,XMABORT
"RTN","XMJMOR",102,0)
 ; XMPRTHDR 1=Print header
"RTN","XMJMOR",103,0)
 ;          0=don't (headerless print)
"RTN","XMJMOR",104,0)
 ; XMRECIPS 0=Don't print recipients
"RTN","XMJMOR",105,0)
 ;          1=Print summary recipients
"RTN","XMJMOR",106,0)
 ;          2=Print detail recipients
"RTN","XMJMOR",107,0)
 N XMSAVE,XMMSG,XMZLIST,I
"RTN","XMJMOR",108,0)
 S XMABORT=0
"RTN","XMJMOR",109,0)
 S:$G(XMPRTHDR)="" XMPRTHDR=1  ; default is to print with headers
"RTN","XMJMOR",110,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",111,0)
 . D LISTSEL(XMDUZ,XMK,.XMZLIST)
"RTN","XMJMOR",112,0)
 E  D  Q:XMABORT
"RTN","XMJMOR",113,0)
 . N XMWHICH
"RTN","XMJMOR",114,0)
 . D WHICH(XMDUZ,XMK,$S(XMPRTHDR:34317,1:34317.1),0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",115,0)
 . D LIST(XMDUZ,XMK,.XMWHICH,.XMZLIST)
"RTN","XMJMOR",116,0)
 I '$D(XMZLIST) W !!,$$EZBLD^DIALOG(34319) Q  ; No valid messages selected.
"RTN","XMJMOR",117,0)
 I +XMZLIST(1)=XMZLIST(1) D PRTONE(XMDUZ,XMK,XMZLIST(1),XMPRTHDR,.XMABORT) Q
"RTN","XMJMOR",118,0)
 D QRECIP^XMJMP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMOR",119,0)
 F I="DUZ","XMDUZ","XMV(","XMZLIST(","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMOR",120,0)
 D EN^XUTMDEVQ("PLISTX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJMOR",121,0)
 Q:XMABORT
"RTN","XMJMOR",122,0)
 W:$D(XMMSG) !!,XMMSG
"RTN","XMJMOR",123,0)
 Q
"RTN","XMJMOR",124,0)
LISTSEL(XMDUZ,XMK,XMZLIST) ;
"RTN","XMJMOR",125,0)
 N XMKZ,J,XMZ
"RTN","XMJMOR",126,0)
 S (XMKZ,J)=0
"RTN","XMJMOR",127,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMOR",128,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")) Q:'XMZ
"RTN","XMJMOR",129,0)
 . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMOR",130,0)
 . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMOR",131,0)
 . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMOR",132,0)
 Q
"RTN","XMJMOR",133,0)
LIST(XMDUZ,XMK,XMWHICH,XMZLIST) ;
"RTN","XMJMOR",134,0)
 N I,J,XMRANGE,XMKZ,XMZ,XMLAST
"RTN","XMJMOR",135,0)
 S J=0
"RTN","XMJMOR",136,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMOR",137,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMOR",138,0)
 . Q:'XMRANGE
"RTN","XMJMOR",139,0)
 . S XMKZ=$P(XMRANGE,"-",1)-.1
"RTN","XMJMOR",140,0)
 . S XMLAST=$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE)
"RTN","XMJMOR",141,0)
 . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ!(XMKZ>XMLAST)  D
"RTN","XMJMOR",142,0)
 . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,"")) Q:'XMZ
"RTN","XMJMOR",143,0)
 . . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMOR",144,0)
 . . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMOR",145,0)
 . . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMOR",146,0)
 Q
"RTN","XMJMOR",147,0)
PRTONE(XMDUZ,XMK,XMZ,XMPRTHDR,XMABORT) ;
"RTN","XMJMOR",148,0)
 D PONE^XMJMP(XMDUZ,XMK,XMZ,XMPRTHDR,.XMABORT)
"RTN","XMJMOR",149,0)
 W !!,$$EZBLD^DIALOG($S(XMABORT:34318.4,1:34318.1)) ; Message (not) printed.
"RTN","XMJMOR",150,0)
 Q
"RTN","XMJMOR",151,0)
SAVE(XMDUZ,XMK) ; Save a range of messages to another basket
"RTN","XMJMOR",152,0)
 N XMWHICH,XMMSG,XMABORT,XMKTO,XMDIC
"RTN","XMJMOR",153,0)
 S XMABORT=0
"RTN","XMJMOR",154,0)
 S XMDIC("B")="@"  ; no default basket
"RTN","XMJMOR",155,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",156,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO) ; Save messages to which basket?
"RTN","XMJMOR",157,0)
 . I XMKTO=U S XMMSG=$$EZBLD^DIALOG(34324.3) Q  ; No messages saved.
"RTN","XMJMOR",158,0)
 . I XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMOR",159,0)
 . D SELMSG(XMDUZ,XMK,"XMOVE^XMXMSGS2",34324,.XMMSG)
"RTN","XMJMOR",160,0)
 . K ^TMP("XM",$J,".")
"RTN","XMJMOR",161,0)
 E  D
"RTN","XMJMOR",162,0)
 . D WHICH(XMDUZ,XMK,34323,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",163,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO) ; Save messages to which basket?
"RTN","XMJMOR",164,0)
 . I XMKTO=U S XMMSG=$$EZBLD^DIALOG(34324.3) Q  ; No messages saved.
"RTN","XMJMOR",165,0)
 . I XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMOR",166,0)
 . D MOVEMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,XMKTO,.XMMSG)
"RTN","XMJMOR",167,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",168,0)
 Q:XMABORT
"RTN","XMJMOR",169,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",170,0)
 Q
"RTN","XMJMOR",171,0)
TERM(XMDUZ,XMK) ; Terminate a range of messages
"RTN","XMJMOR",172,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",173,0)
 S XMABORT=0
"RTN","XMJMOR",174,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",175,0)
 . D SELMSG^XMJMORX(XMDUZ,0,0,XMK,"XTERM^XMJMORX1",34329,34330,.XMMSG,.XMABORT)
"RTN","XMJMOR",176,0)
 . ;K ^TMP("XM",$J,".")
"RTN","XMJMOR",177,0)
 E  D
"RTN","XMJMOR",178,0)
 . D WHICH(XMDUZ,XMK,34328,34330.1,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",179,0)
 . D TERMMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",180,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",181,0)
 Q:XMABORT
"RTN","XMJMOR",182,0)
 Q:'$D(XMMSG)
"RTN","XMJMOR",183,0)
 W !,XMMSG
"RTN","XMJMOR",184,0)
 I XMMSG W !,$$EZBLD^DIALOG($S(XMK<1:34331.1,1:34331)) ; You won't see future responses.  (In WASTE basket)
"RTN","XMJMOR",185,0)
 Q
"RTN","XMJMOR",186,0)
XMTPRI(XMDUZ,XMK) ; Toggle transmission priority for a range of msgs
"RTN","XMJMOR",187,0)
 ; XMDUZ better be .5 and XMK better be > 999!
"RTN","XMJMOR",188,0)
 N XMWHICH,XMMSG,XMABORT
"RTN","XMJMOR",189,0)
 S XMABORT=0
"RTN","XMJMOR",190,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMOR",191,0)
 . D SELMSG^XMJMORX(XMDUZ,0,0,XMK,"XXP^XMXMSGS1",34334,34335,.XMMSG,.XMABORT)
"RTN","XMJMOR",192,0)
 E  D
"RTN","XMJMOR",193,0)
 . D WHICH(XMDUZ,XMK,34333,34335.1,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMOR",194,0)
 . D XPMSG^XMXMSGS(XMDUZ,XMK,XMWHICH,.XMMSG)
"RTN","XMJMOR",195,0)
 . D:$D(XMERR) ZSHOW^XMJERR
"RTN","XMJMOR",196,0)
 Q:XMABORT
"RTN","XMJMOR",197,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMOR",198,0)
 Q
"RTN","XMJMOR",199,0)
WHICH(XMDUZ,XMK,XMPROMPT,XMCONFRM,XMWHICH,XMABORT) ;
"RTN","XMJMOR",200,0)
 N DIR,Y,XMHI,XMLO
"RTN","XMJMOR",201,0)
 S XMLO=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""))
"RTN","XMJMOR",202,0)
 S XMHI=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",""),-1)
"RTN","XMJMOR",203,0)
 S DIR("A")=$$EZBLD^DIALOG(XMPROMPT) ; ... which messages?
"RTN","XMJMOR",204,0)
 S DIR("??")="XM-U-M-CHOOSE RANGE"
"RTN","XMJMOR",205,0)
 S DIR(0)="LC^"_XMLO_":"_XMHI
"RTN","XMJMOR",206,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMOR",207,0)
 S XMWHICH=Y
"RTN","XMJMOR",208,0)
 I XMCONFRM D CONFIRM(XMCONFRM,.XMABORT)
"RTN","XMJMOR",209,0)
 Q
"RTN","XMJMOR",210,0)
CONFIRM(XMCONFRM,XMABORT) ;
"RTN","XMJMOR",211,0)
 N DIR
"RTN","XMJMOR",212,0)
 D BLD^DIALOG(XMCONFRM,"","","DIR(""A"")") ; Do you really want to ... these messages?
"RTN","XMJMOR",213,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMOR",214,0)
 S DIR(0)="Y"
"RTN","XMJMOR",215,0)
 D ^DIR I $D(DIRUT)!'Y S XMABORT=1
"RTN","XMJMOR",216,0)
 Q
"RTN","XMJMOR",217,0)
POSTPRIV() ;
"RTN","XMJMOR",218,0)
 Q:$$POSTPRIV^XMXSEC 1
"RTN","XMJMOR",219,0)
 D SHOW^XMJERR
"RTN","XMJMOR",220,0)
 Q 0
"RTN","XMJMOR",221,0)
SELMSG(XMDUZ,XMK,XMRTN,XMSUM,XMMSG) ;
"RTN","XMJMOR",222,0)
 N XMCNT,XMKZ,XMZ,XMKALL
"RTN","XMJMOR",223,0)
 S (XMCNT,XMKZ)=0
"RTN","XMJMOR",224,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMOR",225,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJMOR",226,0)
 . D @XMRTN
"RTN","XMJMOR",227,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMJMOR",228,0)
 Q
"RTN","XMJMORX")
0^14^B79210536
"RTN","XMJMORX",1,0)
XMJMORX ;ISC-SF/GMB-Range actions for ^TMP message lists ;01/20/2000  09:33
"RTN","XMJMORX",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMORX",3,0)
 ; Similar to ^XMJMOR
"RTN","XMJMORX",4,0)
DELETE(XMDUZ,XMKALL,XMK) ; Delete a range of messages
"RTN","XMJMORX",5,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",6,0)
 S XMABORT=0
"RTN","XMJMORX",7,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",8,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XDEL^XMJMORX1",34302,34303,.XMMSG,.XMABORT)
"RTN","XMJMORX",9,0)
 . ;K:'XMKALL ^TMP("XM",$J,".")
"RTN","XMJMORX",10,0)
 E  D
"RTN","XMJMORX",11,0)
 . D ACTWHICH(XMDUZ,1,XMKALL,XMK,"XDEL^XMJMORX1",34301,34302,34303.1,.XMMSG,.XMABORT)
"RTN","XMJMORX",12,0)
 Q:XMABORT
"RTN","XMJMORX",13,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",14,0)
 Q
"RTN","XMJMORX",15,0)
FILTER(XMDUZ,XMKALL,XMK) ; Filter a range of messages
"RTN","XMJMORX",16,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",17,0)
 S XMABORT=0
"RTN","XMJMORX",18,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",19,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XFLTR^XMJMORX1",34306,0,.XMMSG)
"RTN","XMJMORX",20,0)
 E  D
"RTN","XMJMORX",21,0)
 . D ACTWHICH(XMDUZ,1,XMKALL,XMK,"XFLTR^XMJMORX1",34305,34306,0,.XMMSG,.XMABORT)
"RTN","XMJMORX",22,0)
 Q:XMABORT
"RTN","XMJMORX",23,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",24,0)
 Q
"RTN","XMJMORX",25,0)
FORWARD(XMDUZ,XMKALL,XMK) ; Forward a range of messages
"RTN","XMJMORX",26,0)
 N XMWHICH,XMMSG,XMABORT,XMINSTR
"RTN","XMJMORX",27,0)
 S XMABORT=0
"RTN","XMJMORX",28,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMORX",29,0)
 . N XMKZ
"RTN","XMJMORX",30,0)
 . D INIT^XMXADDR
"RTN","XMJMORX",31,0)
 . S XMKZ=$O(^TMP("XM",$J,".",""))
"RTN","XMJMORX",32,0)
 . I '$O(^TMP("XM",$J,".",XMKZ)) D  Q
"RTN","XMJMORX",33,0)
 . . D FWDONE^XMJMOR(XMDUZ,$P(^TMP("XM",$J,"MSG",XMKZ),U,3),.XMINSTR,.XMABORT)
"RTN","XMJMORX",34,0)
 . D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMORX",35,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XFWD^XMXMSGS1",34309,0,.XMMSG)
"RTN","XMJMORX",36,0)
 . D CLEANUP^XMXADDR
"RTN","XMJMORX",37,0)
 . I $D(XMERR) D ZSHOW^XMJERR
"RTN","XMJMORX",38,0)
 . W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",39,0)
 D WHICH(34308,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",40,0)
 D INIT^XMXADDR
"RTN","XMJMORX",41,0)
 I $P(XMWHICH,",",2,99)="",$P(XMWHICH,",",1)=+XMWHICH D  Q
"RTN","XMJMORX",42,0)
 . N XMZ
"RTN","XMJMORX",43,0)
 . S XMZ=$P($G(^TMP("XM",$J,"MSG",+XMWHICH)),U,3)
"RTN","XMJMORX",44,0)
 . I 'XMZ W !,$$EZBLD^DIALOG(34309.3) Q  ; No messages forwarded.
"RTN","XMJMORX",45,0)
 . D FWDONE^XMJMOR(XMDUZ,XMZ,.XMINSTR,.XMABORT)
"RTN","XMJMORX",46,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34111),.XMINSTR,"",.XMABORT) Q:XMABORT  ; Forward
"RTN","XMJMORX",47,0)
 D ACTMSG(XMDUZ,1,XMKALL,XMK,XMWHICH,"XFWD^XMXMSGS1",34309,.XMMSG)
"RTN","XMJMORX",48,0)
 D CLEANUP^XMXADDR
"RTN","XMJMORX",49,0)
 I $D(XMERR) D ZSHOW^XMJERR
"RTN","XMJMORX",50,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",51,0)
 Q
"RTN","XMJMORX",52,0)
LATER(XMDUZ,XMKALL,XMK) ; Later a range of messages
"RTN","XMJMORX",53,0)
 N XMWHICH,XMMSG,XMABORT,XMWHEN
"RTN","XMJMORX",54,0)
 S XMABORT=0
"RTN","XMJMORX",55,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",56,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMORX",57,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XLATER^XMXMSGS2",34312,0,.XMMSG)
"RTN","XMJMORX",58,0)
 E  D
"RTN","XMJMORX",59,0)
 . D WHICH(34311,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",60,0)
 . D LTRDATE^XMJMD(.XMWHEN,.XMABORT) Q:XMABORT
"RTN","XMJMORX",61,0)
 . D ACTMSG(XMDUZ,1,XMKALL,XMK,XMWHICH,"XLATER^XMXMSGS2",34312,.XMMSG)
"RTN","XMJMORX",62,0)
 Q:XMABORT
"RTN","XMJMORX",63,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",64,0)
 Q
"RTN","XMJMORX",65,0)
NEWTOGL(XMDUZ,XMKALL,XMK) ; New Toggle a range of messages
"RTN","XMJMORX",66,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",67,0)
 S XMABORT=0
"RTN","XMJMORX",68,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",69,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XNTOGL^XMJMORX1",34315,0,.XMMSG)
"RTN","XMJMORX",70,0)
 E  D
"RTN","XMJMORX",71,0)
 . D ACTWHICH(XMDUZ,1,XMKALL,XMK,"XNTOGL^XMJMORX1",34314,34315,0,.XMMSG,.XMABORT)
"RTN","XMJMORX",72,0)
 Q:XMABORT
"RTN","XMJMORX",73,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",74,0)
 Q
"RTN","XMJMORX",75,0)
PRINT(XMDUZ,XMPRTHDR) ; Print a range of messages (Needs XMTYPE)
"RTN","XMJMORX",76,0)
 N XMRECIPS,XMABORT,XMSAVE,XMMSG,XMWHICH,XMZLIST,I
"RTN","XMJMORX",77,0)
 ; XMPRTHDR 1=Print header
"RTN","XMJMORX",78,0)
 ;          0=don't (headerless print)
"RTN","XMJMORX",79,0)
 ; XMRECIPS 0=Don't print recipients
"RTN","XMJMORX",80,0)
 ;          1=Print summary recipients
"RTN","XMJMORX",81,0)
 ;          2=Print detail recipients
"RTN","XMJMORX",82,0)
 S XMABORT=0
"RTN","XMJMORX",83,0)
 S:$G(XMPRTHDR)="" XMPRTHDR=1  ; default is to print with headers
"RTN","XMJMORX",84,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",85,0)
 . D LISTSEL(.XMZLIST)
"RTN","XMJMORX",86,0)
 E  D  Q:XMABORT
"RTN","XMJMORX",87,0)
 . D WHICH($S(XMPRTHDR:34317,1:34317.1),0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",88,0)
 . D LIST(.XMWHICH,.XMZLIST)
"RTN","XMJMORX",89,0)
 I '$D(XMZLIST) W !!,$$EZBLD^DIALOG(34319) Q  ; No valid messages selected.
"RTN","XMJMORX",90,0)
 I +XMZLIST(1)=XMZLIST(1) D
"RTN","XMJMORX",91,0)
 . D PRTONE^XMJMOR(XMDUZ,$$BSKT^XMXUTIL2(XMDUZ,XMZLIST(1)),XMZLIST(1),XMPRTHDR,.XMABORT)
"RTN","XMJMORX",92,0)
 E  D
"RTN","XMJMORX",93,0)
 . D QRECIP^XMJMP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMORX",94,0)
 . F I="DUZ","XMDUZ","XMV(","XMZLIST(","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMORX",95,0)
 . D EN^XUTMDEVQ("PLISTX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJMORX",96,0)
 . W:$D(XMMSG) !!,XMMSG
"RTN","XMJMORX",97,0)
 Q:$G(XMTYPE)'["N"!XMABORT
"RTN","XMJMORX",98,0)
 N XMKZ,XMZ,XMRANGE
"RTN","XMJMORX",99,0)
 I $D(^TMP("XM",$J,".")) D  Q
"RTN","XMJMORX",100,0)
 . S XMKZ=""
"RTN","XMJMORX",101,0)
 . F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMORX",102,0)
 . . S XMZ=$P(^TMP("XM",$J,"MSG",XMKZ),U,3)
"RTN","XMJMORX",103,0)
 . . Q:$D(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ))
"RTN","XMJMORX",104,0)
 . . K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX",105,0)
 . . K ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX",106,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMORX",107,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMORX",108,0)
 . Q:'XMRANGE
"RTN","XMJMORX",109,0)
 . F XMKZ=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMORX",110,0)
 . . Q:'$D(^TMP("XM",$J,"MSG",XMKZ))
"RTN","XMJMORX",111,0)
 . . S XMZ=$P(^TMP("XM",$J,"MSG",XMKZ),U,3)
"RTN","XMJMORX",112,0)
 . . K:'$D(^XMB(3.7,XMDUZ,XMTYPE,XMK,XMZ)) ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX",113,0)
 Q
"RTN","XMJMORX",114,0)
LISTSEL(XMZLIST) ;
"RTN","XMJMORX",115,0)
 N XMKZ,J,XMZ
"RTN","XMJMORX",116,0)
 S (XMKZ,J)=0
"RTN","XMJMORX",117,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMORX",118,0)
 . S XMZ=$P(^TMP("XM",$J,"MSG",XMKZ),U,3)
"RTN","XMJMORX",119,0)
 . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMORX",120,0)
 . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMORX",121,0)
 . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMORX",122,0)
 Q
"RTN","XMJMORX",123,0)
LIST(XMWHICH,XMZLIST) ;
"RTN","XMJMORX",124,0)
 N I,J,XMRANGE,XMKZ,XMZ
"RTN","XMJMORX",125,0)
 S J=0
"RTN","XMJMORX",126,0)
 F I=1:1:$L(XMWHICH,",") D
"RTN","XMJMORX",127,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMORX",128,0)
 . Q:'XMRANGE
"RTN","XMJMORX",129,0)
 . F XMKZ=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMJMORX",130,0)
 . . S XMZ=$P($G(^TMP("XM",$J,"MSG",XMKZ)),U,3) Q:'XMZ
"RTN","XMJMORX",131,0)
 . . I J=0 S J=1,XMZLIST(1)=XMZ Q
"RTN","XMJMORX",132,0)
 . . I $L(XMZLIST(J))+$L(XMZ)>240 S J=J+1,XMZLIST(J)=XMZ Q
"RTN","XMJMORX",133,0)
 . . S XMZLIST(J)=XMZLIST(J)_","_XMZ
"RTN","XMJMORX",134,0)
 Q
"RTN","XMJMORX",135,0)
SAVE(XMDUZ,XMKALL,XMK) ; Save a range of messages to another basket
"RTN","XMJMORX",136,0)
 N XMWHICH,XMMSG,XMABORT,XMKTO,XMDIC,XMKNTO
"RTN","XMJMORX",137,0)
 S XMABORT=0
"RTN","XMJMORX",138,0)
 S XMDIC("B")="@" ; no default bskt
"RTN","XMJMORX",139,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",140,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO,.XMKNTO) I XMKTO=U S XMABORT=1 Q  ; Save messages to which basket?
"RTN","XMJMORX",141,0)
 . I 'XMKALL,XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMORX",142,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XSAVE^XMJMORX1",34324,0,.XMMSG)
"RTN","XMJMORX",143,0)
 . K:'XMKALL ^TMP("XM",$J,".")
"RTN","XMJMORX",144,0)
 E  D
"RTN","XMJMORX",145,0)
 . D WHICH(34323,0,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",146,0)
 . D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(34325),"L",.XMDIC,.XMKTO,.XMKNTO) ; Save messages to which basket?
"RTN","XMJMORX",147,0)
 . I XMKTO=U S XMABORT=1 Q
"RTN","XMJMORX",148,0)
 . I 'XMKALL,XMKTO=XMK S XMMSG=$$EZBLD^DIALOG(34326) Q  ; Same basket.  No messages saved.
"RTN","XMJMORX",149,0)
 . D ACTMSG(XMDUZ,1,XMKALL,XMK,XMWHICH,"XSAVE^XMJMORX1",34324,.XMMSG)
"RTN","XMJMORX",150,0)
 Q:XMABORT
"RTN","XMJMORX",151,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",152,0)
 Q
"RTN","XMJMORX",153,0)
TERM(XMDUZ,XMKALL,XMK) ; Terminate a range of messages
"RTN","XMJMORX",154,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",155,0)
 S XMABORT=0
"RTN","XMJMORX",156,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",157,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XTERM^XMJMORX1",34329,34330,.XMMSG,.XMABORT)
"RTN","XMJMORX",158,0)
 . ;K:'XMKALL ^TMP("XM",$J,".")
"RTN","XMJMORX",159,0)
 E  D
"RTN","XMJMORX",160,0)
 . D ACTWHICH(XMDUZ,1,XMKALL,XMK,"XTERM^XMJMORX1",34328,34329,34330.1,.XMMSG,.XMABORT)
"RTN","XMJMORX",161,0)
 Q:XMABORT
"RTN","XMJMORX",162,0)
 Q:'$D(XMMSG)
"RTN","XMJMORX",163,0)
 W !,XMMSG
"RTN","XMJMORX",164,0)
 I XMMSG W !,$$EZBLD^DIALOG($S(XMK<1:34331.1,1:34331)) ; You won't see future responses.  (In WASTE basket)
"RTN","XMJMORX",165,0)
 Q
"RTN","XMJMORX",166,0)
XMTPRI(XMDUZ,XMKALL,XMK) ; Toggle transmit priority for a range of messages
"RTN","XMJMORX",167,0)
 ; XMDUZ better be .5 and XMK better be > 1000!
"RTN","XMJMORX",168,0)
 N XMMSG,XMABORT
"RTN","XMJMORX",169,0)
 S XMABORT=0
"RTN","XMJMORX",170,0)
 I $D(^TMP("XM",$J,".")) D
"RTN","XMJMORX",171,0)
 . D SELMSG(XMDUZ,1,XMKALL,XMK,"XXP^XMXMSGS1",34334,34335,.XMMSG,.XMABORT)
"RTN","XMJMORX",172,0)
 E  D
"RTN","XMJMORX",173,0)
 . D ACTWHICH(XMDUZ,1,XMKALL,XMK,"XXP^XMXMSGS1",34333,34334,34335.1,.XMMSG,XMABORT)
"RTN","XMJMORX",174,0)
 Q:XMABORT
"RTN","XMJMORX",175,0)
 W:$D(XMMSG) !,XMMSG
"RTN","XMJMORX",176,0)
 Q
"RTN","XMJMORX",177,0)
ACTWHICH(XMDUZ,XMTMP,XMKALL,XMK,XMRTN,XMPROMPT,XMSUM,XMCONFRM,XMMSG,XMABORT) ;,XMKTO)
"RTN","XMJMORX",178,0)
 N XMWHICH
"RTN","XMJMORX",179,0)
 D WHICH(XMPROMPT,XMCONFRM,.XMWHICH,.XMABORT) Q:XMABORT
"RTN","XMJMORX",180,0)
 D ACTMSG(XMDUZ,XMTMP,XMKALL,XMK,XMWHICH,XMRTN,XMSUM,.XMMSG)
"RTN","XMJMORX",181,0)
 Q
"RTN","XMJMORX",182,0)
WHICH(XMPROMPT,XMCONFRM,XMWHICH,XMABORT) ;
"RTN","XMJMORX",183,0)
 N DIR,Y,XMHI,XMLO
"RTN","XMJMORX",184,0)
 S XMLO=$O(^TMP("XM",$J,"MSG",""))
"RTN","XMJMORX",185,0)
 S XMHI=$O(^TMP("XM",$J,"MSG",""),-1)
"RTN","XMJMORX",186,0)
 S DIR("A")=$$EZBLD^DIALOG(XMPROMPT) ; ... which messages?
"RTN","XMJMORX",187,0)
 S DIR("??")="XM-U-M-CHOOSE RANGE"
"RTN","XMJMORX",188,0)
 S DIR(0)="LC^"_XMLO_":"_XMHI
"RTN","XMJMORX",189,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMORX",190,0)
 S XMWHICH=Y
"RTN","XMJMORX",191,0)
 I XMCONFRM D CONFIRM^XMJMOR(XMCONFRM,.XMABORT)
"RTN","XMJMORX",192,0)
 Q
"RTN","XMJMORX",193,0)
ACTMSG(XMDUZ,XMTMP,XMKALL,XMK,XMKZA,XMRTN,XMSUM,XMMSG) ;,XMKTO)
"RTN","XMJMORX",194,0)
 ; XMKZA    Array of msg numbers  DEL("1-3,7,11-15")
"RTN","XMJMORX",195,0)
 ; XMKZL    List of msg numbers   1-3,7,11-15
"RTN","XMJMORX",196,0)
 ;          (It is OK if the list ends with a comma)
"RTN","XMJMORX",197,0)
 ; XMKZR    Range of msg numbers  1-3
"RTN","XMJMORX",198,0)
 ; XMKZ1    First number in range 1
"RTN","XMJMORX",199,0)
 ; XMKZN    Last number in range  3
"RTN","XMJMORX",200,0)
 N XMKZ,XMREC,XMKZL,XMKZR,I,XMKZ1,XMKZN,XMZ,XMCNT,XMPIECES
"RTN","XMJMORX",201,0)
 S XMCNT=0
"RTN","XMJMORX",202,0)
 ; is this an array or a variable?
"RTN","XMJMORX",203,0)
 I $G(XMKZA)]"",$O(XMKZA(""))="" S XMKZA(XMKZA)=""
"RTN","XMJMORX",204,0)
 S XMKZL=""
"RTN","XMJMORX",205,0)
 F  S XMKZL=$O(XMKZA(XMKZL)) Q:XMKZL=""  D
"RTN","XMJMORX",206,0)
 . S XMPIECES=$L(XMKZL,",")
"RTN","XMJMORX",207,0)
 . S:'$P(XMKZL,",",XMPIECES) XMPIECES=XMPIECES-1
"RTN","XMJMORX",208,0)
 . F I=1:1:XMPIECES D
"RTN","XMJMORX",209,0)
 . . S XMKZR=$P(XMKZL,",",I)
"RTN","XMJMORX",210,0)
 . . I XMKZR["-" D  Q
"RTN","XMJMORX",211,0)
 . . . ; deal with a range of msg #s
"RTN","XMJMORX",212,0)
 . . . S XMKZ1=$P(XMKZR,"-",1)
"RTN","XMJMORX",213,0)
 . . . S XMKZN=$P(XMKZR,"-",2)
"RTN","XMJMORX",214,0)
 . . . S XMKZ=XMKZ1-.1
"RTN","XMJMORX",215,0)
 . . . I XMTMP D  Q
"RTN","XMJMORX",216,0)
 . . . . F  S XMKZ=$O(^TMP("XM",$J,"MSG",XMKZ)) Q:XMKZ>XMKZN!'XMKZ  D
"RTN","XMJMORX",217,0)
 . . . . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX",218,0)
 . . . . . S:XMKALL XMK=$P(XMREC,U,1)
"RTN","XMJMORX",219,0)
 . . . . . S XMZ=$P(XMREC,U,3)
"RTN","XMJMORX",220,0)
 . . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX",221,0)
 . . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:XMKZ>XMKZN!'XMKZ  D
"RTN","XMJMORX",222,0)
 . . . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,0))
"RTN","XMJMORX",223,0)
 . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX",224,0)
 . . S XMKZ=XMKZR
"RTN","XMJMORX",225,0)
 . . I XMTMP D  Q
"RTN","XMJMORX",226,0)
 . . . S XMREC=$G(^TMP("XM",$J,"MSG",XMKZ))
"RTN","XMJMORX",227,0)
 . . . I XMREC="" S XMZ=0 Q
"RTN","XMJMORX",228,0)
 . . . S:XMKALL XMK=$P(XMREC,U,1)
"RTN","XMJMORX",229,0)
 . . . S XMZ=$P(XMREC,U,3)
"RTN","XMJMORX",230,0)
 . . . I XMZ D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX",231,0)
 . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,0))
"RTN","XMJMORX",232,0)
 . . I XMZ D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX",233,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMJMORX",234,0)
 Q
"RTN","XMJMORX",235,0)
SELMSG(XMDUZ,XMTMP,XMKALL,XMK,XMRTN,XMSUM,XMCONFRM,XMMSG,XMABORT) ;,XMKTO,XMWHEN)
"RTN","XMJMORX",236,0)
 I XMCONFRM D CONFIRM^XMJMOR(XMCONFRM,.XMABORT) Q:XMABORT
"RTN","XMJMORX",237,0)
 N XMCNT,XMKZ,XMREC,XMZ
"RTN","XMJMORX",238,0)
 S (XMCNT,XMKZ)=0
"RTN","XMJMORX",239,0)
 F  S XMKZ=$O(^TMP("XM",$J,".",XMKZ)) Q:'XMKZ  D
"RTN","XMJMORX",240,0)
 . I XMTMP D  Q
"RTN","XMJMORX",241,0)
 . . S XMREC=^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX",242,0)
 . . S:XMKALL XMK=$P(XMREC,U,1)
"RTN","XMJMORX",243,0)
 . . S XMZ=$P(XMREC,U,3)
"RTN","XMJMORX",244,0)
 . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX",245,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMJMORX",246,0)
 . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMJMORX",247,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMJMORX",248,0)
 Q
"RTN","XMJMORX1")
0^15^B5297814
"RTN","XMJMORX1",1,0)
XMJMORX1 ;ISC-SF/GMB-^XMJMORX (cont.) ;01/20/2000  10:09
"RTN","XMJMORX1",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMORX1",3,0)
 ;DELMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",4,0)
XDEL ;
"RTN","XMJMORX1",5,0)
 Q:'XMK
"RTN","XMJMORX1",6,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJMORX1",7,0)
 D DEL^XMXMSGS2(XMDUZ,XMK,XMZ,.XMCNT)
"RTN","XMJMORX1",8,0)
 I $D(XMERR) D ZSHOW^XMJERR Q
"RTN","XMJMORX1",9,0)
 I XMKALL,$G(XMTYPE)'["N" D  Q
"RTN","XMJMORX1",10,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=$S(XMK'=.5:".5^"_$$EZBLD^DIALOG(37004),1:"0^"_$$EZBLD^DIALOG(34014))_U_XMZ ; "WASTE" / "* N/A *"
"RTN","XMJMORX1",11,0)
 K:XMTMP ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",12,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",13,0)
 Q
"RTN","XMJMORX1",14,0)
 ;FLTRMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",15,0)
XFLTR ;
"RTN","XMJMORX1",16,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMJMORX1",17,0)
 S XMKN=$P(^TMP("XM",$J,"MSG",XMKZ),U,2)
"RTN","XMJMORX1",18,0)
 D FLTR^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ,.XMCNT,.XMKTO,.XMKNTO)
"RTN","XMJMORX1",19,0)
 I XMKALL D  Q
"RTN","XMJMORX1",20,0)
 . S:XMKN'=XMKNTO ^TMP("XM",$J,"MSG",XMKZ)=XMKTO_U_XMKNTO_U_XMZ
"RTN","XMJMORX1",21,0)
 Q:XMKN=XMKNTO
"RTN","XMJMORX1",22,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",23,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",24,0)
 Q
"RTN","XMJMORX1",25,0)
 ;NTOGLMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",26,0)
XNTOGL ;
"RTN","XMJMORX1",27,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMJMORX1",28,0)
 S XMKN=$P(^TMP("XM",$J,"MSG",XMKZ),U,2)
"RTN","XMJMORX1",29,0)
 D NTOGL^XMXMSGS2(XMDUZ,XMK,XMKN,XMZ,.XMCNT,.XMKTO,.XMKNTO)
"RTN","XMJMORX1",30,0)
 I XMKALL D  Q
"RTN","XMJMORX1",31,0)
 . S:XMKN'=XMKNTO ^TMP("XM",$J,"MSG",XMKZ)=XMKTO_U_XMKNTO_U_XMZ
"RTN","XMJMORX1",32,0)
 Q:XMKN=XMKNTO
"RTN","XMJMORX1",33,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",34,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",35,0)
 Q
"RTN","XMJMORX1",36,0)
 ;SAVEMSG(XMDUZ,XMK,XMKTO,XMKNTO,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",37,0)
XSAVE ;
"RTN","XMJMORX1",38,0)
 Q:XMK=XMKTO
"RTN","XMJMORX1",39,0)
 D MOVE^XMXMSGS2(XMDUZ,XMK,XMZ,XMKTO,.XMCNT)
"RTN","XMJMORX1",40,0)
 I XMKALL D  Q
"RTN","XMJMORX1",41,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=XMKTO_U_XMKNTO_U_XMZ
"RTN","XMJMORX1",42,0)
 K ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",43,0)
 ;K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",44,0)
 Q
"RTN","XMJMORX1",45,0)
 ;TERMMSG(XMDUZ,XMK,XMKZ,XMZ,XMCNT)
"RTN","XMJMORX1",46,0)
XTERM ;
"RTN","XMJMORX1",47,0)
 Q:'XMK
"RTN","XMJMORX1",48,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJMORX1",49,0)
 D TERM^XMXMSGS2(XMDUZ,XMK,XMZ,.XMCNT)
"RTN","XMJMORX1",50,0)
 I $D(XMERR) D ZSHOW^XMJERR Q
"RTN","XMJMORX1",51,0)
 I XMKALL,$G(XMTYPE)'["N" D  Q
"RTN","XMJMORX1",52,0)
 . S ^TMP("XM",$J,"MSG",XMKZ)=$S(XMK'=.5:".5^"_$$EZBLD^DIALOG(37004),1:"0^"_$$EZBLD^DIALOG(34014))_U_XMZ ; "WASTE" / "* N/A *"
"RTN","XMJMORX1",53,0)
 K:XMTMP ^TMP("XM",$J,"MSG",XMKZ)
"RTN","XMJMORX1",54,0)
 K:$D(^TMP("XM",$J,".",XMKZ)) ^TMP("XM",$J,".",XMKZ)
"RTN","XMJMORX1",55,0)
 Q
"RTN","XMJMP")
0^26^B67038144
"RTN","XMJMP",1,0)
XMJMP ;ISC-SF/GMB-Print,Backup messages ;01/20/2000  08:06
"RTN","XMJMP",2,0)
 ;;7.1;MailMan;**50,75,100,110**;Jun 02, 1994
"RTN","XMJMP",3,0)
 ; PRINT  Replaces ENTPRT^XMA0,^XMA02,ENTPRT^XMAP,QE2^XMA5
"RTN","XMJMP",4,0)
 ; BACKUP Replaces E^XMA1,ENT8^XMAH,ENTR^XMAP,ENTBCK^XMAP
"RTN","XMJMP",5,0)
 ; (ISC-WASH/CAP/THM)
"RTN","XMJMP",6,0)
PRINT(XMDUZ,XMK,XMZ,XMPRTHDR) ; Print
"RTN","XMJMP",7,0)
 ; XMPRTHDR 1=Print header
"RTN","XMJMP",8,0)
 ;          0=don't (headerless print)
"RTN","XMJMP",9,0)
 ; XMRECIPS 0=Don't print recipients
"RTN","XMJMP",10,0)
 ;          1=Print summary recipients
"RTN","XMJMP",11,0)
 ;          2=Print detail recipients
"RTN","XMJMP",12,0)
 N XMWHICH,XMRESPS,XMABORT,XMRECIPS,XMSAVE
"RTN","XMJMP",13,0)
 S XMABORT=0
"RTN","XMJMP",14,0)
 D QRECIP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMP",15,0)
 S XMRESPS=$$RESP^XMXUTIL2(XMZ)
"RTN","XMJMP",16,0)
 I XMRESPS D  Q:XMABORT
"RTN","XMJMP",17,0)
 . S XMWHICH="0-"_XMRESPS
"RTN","XMJMP",18,0)
 . D WHICH(XMZ,XMRESPS,$$EZBLD^DIALOG(34500),.XMWHICH,.XMABORT) ; Print
"RTN","XMJMP",19,0)
 E  S XMWHICH=0
"RTN","XMJMP",20,0)
 S:$G(XMPRTHDR)="" XMPRTHDR=1  ; default is to print with headers
"RTN","XMJMP",21,0)
 F I="DUZ","XMDUZ","XMV(","XMK","XMZ","XMWHICH","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMP",22,0)
 I $D(XMSECURE) F I="XMPAKMAN","XMSECURE","XMSECURE(" S XMSAVE(I)=""
"RTN","XMJMP",23,0)
 D EN^XUTMDEVQ("PRTMSGX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJMP",24,0)
 Q
"RTN","XMJMP",25,0)
PRTMSG(XMDUZ,XMK,XMZ,XMWHICH,XMRECIPS,XMPRTHDR) ;
"RTN","XMJMP",26,0)
PRTMSGX ;
"RTN","XMJMP",27,0)
PRINTMSG ;
"RTN","XMJMP",28,0)
 N XMKN,XMRESPS,XMZREC,XMPTR
"RTN","XMJMP",29,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0)) Q:XMZREC=""
"RTN","XMJMP",30,0)
 D BSKT(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMP",31,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR)
"RTN","XMJMP",32,0)
 W:$G(IOST)["C-" @IOF
"RTN","XMJMP",33,0)
 D:XMPRTHDR IDHDR(XMDUZ)
"RTN","XMJMP",34,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMWHICH,XMRECIPS,0,XMPRTHDR)
"RTN","XMJMP",35,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMJMP",36,0)
 Q
"RTN","XMJMP",37,0)
BSKT(XMDUZ,XMZ,XMK,XMKN) ;
"RTN","XMJMP",38,0)
 I +$G(XMK),$D(^XMB(3.7,"M",XMZ,XMDUZ,XMK)) S XMKN=$$BSKTNAME^XMXUTIL(XMDUZ,XMK) Q
"RTN","XMJMP",39,0)
 N XMKSTR
"RTN","XMJMP",40,0)
 S XMKSTR=$$BSKT^XMXUTIL2(XMDUZ,XMZ,1)
"RTN","XMJMP",41,0)
 S XMK=$P(XMKSTR,U,1),XMKN=$S(XMK:$P(XMKSTR,U,2),1:$$EZBLD^DIALOG(34014)) ; * N/A *
"RTN","XMJMP",42,0)
 Q
"RTN","XMJMP",43,0)
IDHDR(XMDUZ) ; Header: "MailMan msg for..."
"RTN","XMJMP",44,0)
 N XMREC,XMPARM
"RTN","XMJMP",45,0)
 S XMREC=$G(^VA(200,XMDUZ,0))
"RTN","XMJMP",46,0)
 W *13,$$EZBLD^DIALOG(34502,XMV("NAME")) ; MailMan message for
"RTN","XMJMP",47,0)
 I $P(XMREC,U,9)'="",$D(^DIC(3.1,+$P(XMREC,U,9),0)) W "  ",$P(^(0),U,1) ; VA TITLE
"RTN","XMJMP",48,0)
 S XMPARM(1)=^XMB("NETNAME"),XMPARM(2)=$$MMDT^XMXUTIL1($$NOW^XLFDT)
"RTN","XMJMP",49,0)
 W !,$$EZBLD^DIALOG(34503,.XMPARM),! ; Printed at site  date
"RTN","XMJMP",50,0)
 Q
"RTN","XMJMP",51,0)
QRECIP(XMRECIPS,XMABORT) ;
"RTN","XMJMP",52,0)
 N DIR,DIRUT,Y,XMSUMRY
"RTN","XMJMP",53,0)
 S DIR(0)="Y"
"RTN","XMJMP",54,0)
 S DIR("A")=$$EZBLD^DIALOG(34504) ; Print recipient list
"RTN","XMJMP",55,0)
 S DIR("B")=$$EZBLD^DIALOG(39053) ; No
"RTN","XMJMP",56,0)
 D BLD^DIALOG(34505,"","","DIR(""?"")")
"RTN","XMJMP",57,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMP",58,0)
 I Y=0 S XMRECIPS=0 Q
"RTN","XMJMP",59,0)
 S XMSUMRY=$$EZBLD^DIALOG(34507)
"RTN","XMJMP",60,0)
 S DIR(0)="SM^"_$$EZBLD^DIALOG(34506)_";"_XMSUMRY
"RTN","XMJMP",61,0)
 S DIR("A")=$$EZBLD^DIALOG(34508) ; Print Detail or Summary recipient chain
"RTN","XMJMP",62,0)
 S DIR("B")=$P(XMSUMRY,":",2,99) ; Summary
"RTN","XMJMP",63,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMP",64,0)
 S XMRECIPS=$S(Y=$P(XMSUMRY,":",1):1,1:2)
"RTN","XMJMP",65,0)
 Q
"RTN","XMJMP",66,0)
DISPMSG(XMDUZ,XMK,XMKN,XMZ,XMSECBAD) ; Display message
"RTN","XMJMP",67,0)
 N XMRESPS,XMRESP,XMPTR,XMZREC
"RTN","XMJMP",68,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMP",69,0)
 S XMPAKMAN=$$PAKMAN^XMXSEC1(XMZ,XMZREC)
"RTN","XMJMP",70,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR,.XMRESP)
"RTN","XMJMP",71,0)
 I XMRESP'="",XMRESPS S XMRESP=XMRESP+1
"RTN","XMJMP",72,0)
 I XMDUZ=.5,XMK>999 S XMRESP=XMRESPS+1
"RTN","XMJMP",73,0)
 E  I $D(^XMB(3.9,XMZ,"K")),'$D(XMSECURE),'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10)) S XMSECBAD=1 Q
"RTN","XMJMP",74,0)
 W @IOF
"RTN","XMJMP",75,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,+XMRESP_"-",0,1,1)
"RTN","XMJMP",76,0)
 Q
"RTN","XMJMP",77,0)
RESPONSE(XMDUZ,XMZ,XMRESPS,XMPTR,XMRESP) ;
"RTN","XMJMP",78,0)
 ; XMRESP="" if the user hasn't read the message at all
"RTN","XMJMP",79,0)
 ;        0  if the user has read the original message only
"RTN","XMJMP",80,0)
 ;        n  if the user has read thru response n
"RTN","XMJMP",81,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMP",82,0)
 ;S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",$S(XMDUZ=.6:DUZ,1:XMDUZ),0))
"RTN","XMJMP",83,0)
 S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMJMP",84,0)
 S XMRESP=$P($G(^XMB(3.9,XMZ,1,XMPTR,0)),U,2)
"RTN","XMJMP",85,0)
 Q
"RTN","XMJMP",86,0)
CHKRESP(XMDUZ,XMZO,XMRESPSO,XMRESP) ;
"RTN","XMJMP",87,0)
 N XMZ,XMFROM,XMRESPS,XMNEW,XMSEEN
"RTN","XMJMP",88,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZO,3,0)),U,4)
"RTN","XMJMP",89,0)
 Q:XMRESPS=+XMRESP  ; No new responses
"RTN","XMJMP",90,0)
 I XMRESPSO>XMRESP D  Q:XMRESPSO=XMRESPS
"RTN","XMJMP",91,0)
 . I XMRESPSO-1>XMRESP D
"RTN","XMJMP",92,0)
 . . ; >> You haven't read responses |1|-|2|.  You may backup to see them. <<
"RTN","XMJMP",93,0)
 . . N XMPARM
"RTN","XMJMP",94,0)
 . . S XMPARM(1)=XMRESP+1,XMPARM(2)=XMRESPSO
"RTN","XMJMP",95,0)
 . . W !,$$EZBLD^DIALOG(34510,.XMPARM)
"RTN","XMJMP",96,0)
 . E  W !,$$EZBLD^DIALOG(34511,XMRESP+1) ; >> You haven't read response |1|.  You may backup to see it. <<
"RTN","XMJMP",97,0)
 . S XMRESP=XMRESPSO
"RTN","XMJMP",98,0)
 S XMNEW=0,XMSEEN=""
"RTN","XMJMP",99,0)
 F XMRESP=XMRESP+1:1:XMRESPS D  Q:XMNEW
"RTN","XMJMP",100,0)
 . S XMZ=$P(^XMB(3.9,XMZO,3,XMRESP,0),U,1)
"RTN","XMJMP",101,0)
 . S XMFROM=$P($G(^XMB(3.9,XMZ,0)),U,2)
"RTN","XMJMP",102,0)
 . I XMFROM'=XMDUZ S XMNEW=1 Q
"RTN","XMJMP",103,0)
 . S XMSEEN=XMSEEN_","_XMRESP
"RTN","XMJMP",104,0)
 Q:'XMNEW
"RTN","XMJMP",105,0)
 W !,$$EZBLD^DIALOG(34512,XMRESP) ; >> Response |1| has arrived - you may backup to see it. <<
"RTN","XMJMP",106,0)
 Q
"RTN","XMJMP",107,0)
BACKUP(XMDUZ,XMK,XMKN,XMZ) ; Backup
"RTN","XMJMP",108,0)
 N XMWHICH,XMRESPS,XMABORT,XMZREC,XMPTR
"RTN","XMJMP",109,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMP",110,0)
 I $D(^XMB(3.9,XMZ,"K")),'$D(XMSECURE) Q:'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10))
"RTN","XMJMP",111,0)
 S XMABORT=0
"RTN","XMJMP",112,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR,.XMWHICH)
"RTN","XMJMP",113,0)
 I XMRESPS D HOWMUCH(XMZ,XMRESPS,$$EZBLD^DIALOG(34513),.XMWHICH,.XMABORT) Q:XMABORT  ; Backup to
"RTN","XMJMP",114,0)
 W @IOF
"RTN","XMJMP",115,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMWHICH,0,1,1)
"RTN","XMJMP",116,0)
 Q
"RTN","XMJMP",117,0)
WHICH(XMZ,XMRESPS,XMVERB,XMWHICH,XMABORT) ;
"RTN","XMJMP",118,0)
 N DIR,DIRUT,Y,XMTEXT
"RTN","XMJMP",119,0)
 ; There is 1 response. / There are X responses. Response 0 is the original message.  (?? shows index)
"RTN","XMJMP",120,0)
 D BLD^DIALOG($S(XMRESPS=1:34514,1:34515),XMRESPS,"","XMTEXT")
"RTN","XMJMP",121,0)
 M DIR("A")=XMTEXT
"RTN","XMJMP",122,0)
 S DIR("A")=$$EZBLD^DIALOG(34516,XMVERB) ; Select the responses to |1|:
"RTN","XMJMP",123,0)
 S:$D(XMWHICH) DIR("B")=XMWHICH
"RTN","XMJMP",124,0)
 S DIR("PRE")="I X?.E1N1""-"" S X=X_XMRESPS W XMRESPS"
"RTN","XMJMP",125,0)
 S DIR(0)="LACO^0:"_XMRESPS
"RTN","XMJMP",126,0)
 S DIR("??")="^D HELPRESP^XMJMP1(XMZ,XMRESPS)"
"RTN","XMJMP",127,0)
 D ^DIR I $D(DTOUT)!$D(DUOUT) S XMABORT=1 Q
"RTN","XMJMP",128,0)
 S:X'="" XMWHICH=$E(Y,1,$L(Y)-1)
"RTN","XMJMP",129,0)
 Q
"RTN","XMJMP",130,0)
HOWMUCH(XMZ,XMRESPS,XMPROMPT,XMWHICH,XMABORT) ;
"RTN","XMJMP",131,0)
 N DIR,DIRUT,Y,XMRESP,XMTEXT
"RTN","XMJMP",132,0)
 ; There is 1 response. / There are X responses. Response 0 is the original message.  (?? shows index)
"RTN","XMJMP",133,0)
 D BLD^DIALOG($S(XMRESPS=1:34514,1:34515),XMRESPS,"","XMTEXT")
"RTN","XMJMP",134,0)
 M DIR("A")=XMTEXT
"RTN","XMJMP",135,0)
 I XMWHICH<XMRESPS D
"RTN","XMJMP",136,0)
 . S DIR("A")=$$EZBLD^DIALOG(34518,XMPROMPT) ; |1|:
"RTN","XMJMP",137,0)
 . S DIR("B")=XMWHICH+1
"RTN","XMJMP",138,0)
 E  D
"RTN","XMJMP",139,0)
 . S DIR("A")=$$EZBLD^DIALOG(34519,XMPROMPT) ; |1|:  Original message
"RTN","XMJMP",140,0)
 . S DIR("B")=0
"RTN","XMJMP",141,0)
 S DIR(0)="NA^-"_XMRESPS_":"_XMRESPS
"RTN","XMJMP",142,0)
 D BLD^DIALOG(34520,XMPROMPT,"","DIR(""?"")")
"RTN","XMJMP",143,0)
 ;If you select 0, you will _XMPROMPT_ the original message.
"RTN","XMJMP",144,0)
 ;If you select one of the responses, you will _XMPROMPT_ it.
"RTN","XMJMP",145,0)
 S DIR("??")="^D HELPRESP^XMJMP1(XMZ,XMRESPS)"
"RTN","XMJMP",146,0)
 D ^DIR I $D(DIRUT) S XMABORT=1 Q
"RTN","XMJMP",147,0)
 S XMRESP=$S(Y<0:XMRESPS+Y+1,1:Y)
"RTN","XMJMP",148,0)
 S XMWHICH=$S(XMRESP=XMRESPS:XMRESP,1:XMRESP_"-"_XMRESPS)
"RTN","XMJMP",149,0)
 Q
"RTN","XMJMP",150,0)
PONE(XMDUZ,XMK,XMZ,XMPRTHDR,XMABORT) ;
"RTN","XMJMP",151,0)
PONEX ; Print one message.  Check it to see if
"RTN","XMJMP",152,0)
 ; the user is allowed to see it.  (confidential, scrambled)
"RTN","XMJMP",153,0)
 ; If not, print an error message.
"RTN","XMJMP",154,0)
 N XMZREC
"RTN","XMJMP",155,0)
 I $G(XMK)="" S XMK=$$BSKT^XMXUTIL2(XMDUZ,XMZ)
"RTN","XMJMP",156,0)
 I '$D(^XMB(3.9,XMZ,0)),XMK D ZAPIT^XMJBM(XMDUZ,XMK,XMZ) S XMABORT=1 Q
"RTN","XMJMP",157,0)
 S XMZREC=^XMB(3.9,XMZ,0)
"RTN","XMJMP",158,0)
 I XMDUZ'=DUZ,'$$SURRACC^XMXSEC(XMDUZ,"",XMZ,XMZREC) D  Q  ; "access"
"RTN","XMJMP",159,0)
 . D SHOW^XMJERR
"RTN","XMJMP",160,0)
 . S XMABORT=1
"RTN","XMJMP",161,0)
 N XMSECURE,XMPAKMAN ; Important 'new' - part of scramble and packman handling
"RTN","XMJMP",162,0)
 S XMPAKMAN=$$PAKMAN^XMXSEC1(XMZ,XMZREC)
"RTN","XMJMP",163,0)
 I $D(^XMB(3.9,XMZ,"K")),'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10)) S XMABORT=1 Q
"RTN","XMJMP",164,0)
 N XMRECIPS,XMRESPS,XMWHICH
"RTN","XMJMP",165,0)
 D QRECIP(.XMRECIPS,.XMABORT) Q:XMABORT
"RTN","XMJMP",166,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,"",.XMWHICH)
"RTN","XMJMP",167,0)
 I XMRESPS D  Q:XMABORT
"RTN","XMJMP",168,0)
 . N XMRESP
"RTN","XMJMP",169,0)
 . S XMRESP=XMWHICH
"RTN","XMJMP",170,0)
 . I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),XMRESP S:XMRESP'=XMRESPS XMRESP=XMRESP+1
"RTN","XMJMP",171,0)
 . E  S XMRESP=0
"RTN","XMJMP",172,0)
 . I XMRESP=XMRESPS S XMWHICH=XMRESP
"RTN","XMJMP",173,0)
 . E  S XMWHICH=XMRESP_"-"_XMRESPS
"RTN","XMJMP",174,0)
 . D WHICH(XMZ,XMRESPS,$$EZBLD^DIALOG(34500),.XMWHICH,.XMABORT) ; Print
"RTN","XMJMP",175,0)
 E  S XMWHICH=0
"RTN","XMJMP",176,0)
 F I="DUZ","XMDUZ","XMV(","XMK","XMZ","XMWHICH","XMRECIPS","XMPRTHDR" S XMSAVE(I)=""
"RTN","XMJMP",177,0)
 I $D(XMSECURE) F I="XMPAKMAN","XMSECURE","XMSECURE(" S XMSAVE(I)=""
"RTN","XMJMP",178,0)
 D EN^XUTMDEVQ("PRTMSGX^XMJMP",$$EZBLD^DIALOG(34501),.XMSAVE) ; MailMan: Print
"RTN","XMJMP",179,0)
 Q
"RTN","XMJMP",180,0)
 ;PLIST(XMDUZ,XMZLIST,XMRECIPS,XMPRTHDR,XMMSG)
"RTN","XMJMP",181,0)
PLISTX ;
"RTN","XMJMP",182,0)
 ; Print a list of messages.
"RTN","XMJMP",183,0)
 ; Check each message as we come to it to see if
"RTN","XMJMP",184,0)
 ; the user is allowed to see it.  (confidential, scrambled)
"RTN","XMJMP",185,0)
 ; If not, print an error message.
"RTN","XMJMP",186,0)
 N I,J,XMK,XMKN,XMZ,XMFIRST,XMCNT,XMABORT
"RTN","XMJMP",187,0)
 S XMFIRST=1,(XMCNT,XMABORT,I)=0
"RTN","XMJMP",188,0)
 F  S I=$O(XMZLIST(I)) Q:'I  D  Q:XMABORT
"RTN","XMJMP",189,0)
 . F J=1:1:$L(XMZLIST(I),",") D  Q:XMABORT
"RTN","XMJMP",190,0)
 . . S XMZ=$P(XMZLIST(I),",",J)
"RTN","XMJMP",191,0)
 . . Q:'$D(^XMB(3.9,XMZ,0))
"RTN","XMJMP",192,0)
 . . D BSKT(XMDUZ,XMZ,.XMK,.XMKN)
"RTN","XMJMP",193,0)
 . . D PRTMULT(XMDUZ,XMK,XMKN,XMZ,XMRECIPS,XMPRTHDR,.XMFIRST,.XMCNT,.XMABORT)
"RTN","XMJMP",194,0)
 Q:$D(ZTQUEUED)
"RTN","XMJMP",195,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:34318.1,1:34318),XMCNT)
"RTN","XMJMP",196,0)
 Q
"RTN","XMJMP",197,0)
PRTMULT(XMDUZ,XMK,XMKN,XMZ,XMRECIPS,XMPRTHDR,XMFIRST,XMCNT,XMABORT) ; Multiple message print
"RTN","XMJMP",198,0)
 N XMNOGO,XMZREC,XMRESPS,XMRESP,XMPTR,XMSECURE,XMPAKMAN
"RTN","XMJMP",199,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","XMJMP",200,0)
 S XMNOGO=0
"RTN","XMJMP",201,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMP",202,0)
 I XMZREC="" D ZAPIT^XMXMSGS2(XMDUZ,XMK,XMZ) Q
"RTN","XMJMP",203,0)
 S XMPAKMAN=$$PAKMAN^XMXSEC1(XMZ,XMZREC)
"RTN","XMJMP",204,0)
 D CHECK^XMJMP2(XMDUZ,XMZ,XMZREC,.XMNOGO)  Q:XMNOGO&'$D(ZTQUEUED)
"RTN","XMJMP",205,0)
 I IOST["C-"!'XMFIRST W @IOF
"RTN","XMJMP",206,0)
 S XMFIRST=0
"RTN","XMJMP",207,0)
 D:XMPRTHDR IDHDR(XMDUZ)
"RTN","XMJMP",208,0)
 I XMNOGO D NOGOMSG^XMJMP2(XMDUZ,XMZ,XMZREC,.XMNOGO) Q
"RTN","XMJMP",209,0)
 D RESPONSE(XMDUZ,XMZ,.XMRESPS,.XMPTR,.XMRESP)
"RTN","XMJMP",210,0)
 I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),XMRESP S:XMRESP'=XMRESPS XMRESP=XMRESP+1
"RTN","XMJMP",211,0)
 E  S XMRESP=0
"RTN","XMJMP",212,0)
 D PRINTIT^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMRESP_"-",XMRECIPS,0,XMPRTHDR,1,.XMABORT)
"RTN","XMJMP",213,0)
 S XMCNT=XMCNT+1
"RTN","XMJMP",214,0)
 ;Q:XMABORT
"RTN","XMJMP",215,0)
 ;I IOST["C-" D PAGE^XMXUTIL(.XMABORT)
"RTN","XMJMP",216,0)
 Q
"RTN","XMJMP1")
0^29^B55975309
"RTN","XMJMP1",1,0)
XMJMP1 ;ISC-SF/GMB-Print,Backup continued ;01/18/2000  15:31
"RTN","XMJMP1",2,0)
 ;;7.1;MailMan;**40,50,75,110**;Jun 02, 1994
"RTN","XMJMP1",3,0)
HELPRESP(XMZ,XMRESPS) ;
"RTN","XMJMP1",4,0)
 N XMRESP,XMLEN,XMABORT
"RTN","XMJMP1",5,0)
 S XMABORT=0
"RTN","XMJMP1",6,0)
 W @IOF,$$EZBLD^DIALOG($S(XMRESPS=1:34530,1:34531),XMRESPS)
"RTN","XMJMP1",7,0)
 ;There is 1 response / There are _XMRESPS_ responses.  Response 0 is the original message.
"RTN","XMJMP1",8,0)
 S XMRESP=$S(XMV("ORDER")=1:0,1:XMRESPS+1)
"RTN","XMJMP1",9,0)
 W ! D HRHDR(XMRESPS,XMRESP,.XMLEN)
"RTN","XMJMP1",10,0)
 D:XMV("ORDER")=1 HRLINE(XMZ,0)
"RTN","XMJMP1",11,0)
 F  S XMRESP=$O(^XMB(3.9,XMZ,3,XMRESP),XMV("ORDER")) Q:XMRESP'>0  D  Q:XMABORT
"RTN","XMJMP1",12,0)
 . I $Y+3>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D 
"RTN","XMJMP1",13,0)
 . . W @IOF D HRHDR(XMRESPS,XMRESP,.XMLEN)
"RTN","XMJMP1",14,0)
 . D HRLINE($P(^XMB(3.9,XMZ,3,XMRESP,0),U),XMRESP)
"RTN","XMJMP1",15,0)
 Q:XMABORT
"RTN","XMJMP1",16,0)
 Q:XMV("ORDER")=1
"RTN","XMJMP1",17,0)
 I $Y+3>IOSL D PAGE^XMXUTIL(.XMABORT) Q:XMABORT  D
"RTN","XMJMP1",18,0)
 . W @IOF D HRHDR(XMRESPS,XMRESP,.XMLEN)
"RTN","XMJMP1",19,0)
 D HRLINE(XMZ,0)
"RTN","XMJMP1",20,0)
 Q
"RTN","XMJMP1",21,0)
HRHDR(XMRESPS,XMRESP,XMLEN) ;
"RTN","XMJMP1",22,0)
 S XMLEN("RESP")=$S(XMV("ORDER")=1:$L($$MIN^XLFMTH(XMRESPS,XMRESP+IOSL)),1:$L(XMRESP))
"RTN","XMJMP1",23,0)
 S XMLEN("DATE")=9
"RTN","XMJMP1",24,0)
 S XMLEN("LINE")=5
"RTN","XMJMP1",25,0)
 S XMLEN("FROM")=79-XMLEN("RESP")-XMLEN("DATE")-XMLEN("LINE")-3
"RTN","XMJMP1",26,0)
 W $$LJ^XLFSTR($$EZBLD^DIALOG(34532),XMLEN("RESP")+XMLEN("DATE")+3,"."),$$LJ^XLFSTR($$EZBLD^DIALOG(34006),XMLEN("FROM"),"."),$$EZBLD^DIALOG(34003.1) ; "Response"/"From"/"Lines"
"RTN","XMJMP1",27,0)
 Q
"RTN","XMJMP1",28,0)
HRLINE(XMZ,XMRESP) ;
"RTN","XMJMP1",29,0)
 N XMZREC
"RTN","XMJMP1",30,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMP1",31,0)
 W !,$J(XMRESP,XMLEN("RESP")),") ",$E($$DATE^XMXUTIL2(XMZREC,0),1,XMLEN("DATE"))," ",$$MELD^XMXUTIL1($$NAME^XMXUTIL($P(XMZREC,U,2),1),+$P($G(^XMB(3.9,XMZ,2,0)),U,4),XMLEN("FROM")+XMLEN("LINE"))
"RTN","XMJMP1",32,0)
 Q
"RTN","XMJMP1",33,0)
RESPHDR(XMZ,XMRESP) ;
"RTN","XMJMP1",34,0)
 N XMZREC
"RTN","XMJMP1",35,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMJMP1",36,0)
 D WL(XMRESP_") "_$$NAME^XMXUTIL($P(XMZREC,U,2),1))
"RTN","XMJMP1",37,0)
 D:$P(XMZREC,U,4)'="" W(" ",$$EZBLD^DIALOG(34533,$$NAME^XMXUTIL($P(XMZREC,U,4),1))) ; (Sender: x)
"RTN","XMJMP1",38,0)
 D W("  ",$$DATE($P(XMZREC,U,3)))
"RTN","XMJMP1",39,0)
 D W("  ",$$LINES(XMZ))
"RTN","XMJMP1",40,0)
 Q
"RTN","XMJMP1",41,0)
DATE(XMDT) ;
"RTN","XMJMP1",42,0)
 Q:XMDT'=+XMDT XMDT
"RTN","XMJMP1",43,0)
 Q $$MMDT^XMXUTIL1(XMDT)
"RTN","XMJMP1",44,0)
LINES(XMZ) ;
"RTN","XMJMP1",45,0)
 N XMLINES
"RTN","XMJMP1",46,0)
 S XMLINES=+$P($G(^XMB(3.9,XMZ,2,0)),U,4)
"RTN","XMJMP1",47,0)
 Q $$EZBLD^DIALOG($S(XMLINES=1:34534.1,1:34534),XMLINES)  ; line/lines
"RTN","XMJMP1",48,0)
PRINTIT(XMDUZ,XMK,XMKN,XMZ,XMZREC,XMRESPS,XMPTR,XMWHICH,XMRECIPS,XMDISP,XMPRTHDR,XMMULT,XMABORT) ;
"RTN","XMJMP1",49,0)
 N XMSUBJ,XMPAGE,XMZSTR,I,XMRESP,XMRANGE
"RTN","XMJMP1",50,0)
 S:'$D(XMABORT) XMABORT=0
"RTN","XMJMP1",51,0)
 S XMSUBJ=$P(XMZREC,U,1) S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMP1",52,0)
 S XMSUBJ=$$EZBLD^DIALOG(34536,XMSUBJ),XMZSTR=$$EZBLD^DIALOG(34537,XMZ) ; Subj: x / [#x]
"RTN","XMJMP1",53,0)
 S XMPAGE=1
"RTN","XMJMP1",54,0)
 D:XMPRTHDR HEADER(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR)
"RTN","XMJMP1",55,0)
 I XMWHICH>XMRESPS D:$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1) Q
"RTN","XMJMP1",56,0)
 F I=1:1:$L(XMWHICH,",") D  Q:XMABORT
"RTN","XMJMP1",57,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMJMP1",58,0)
 . S:$E(XMRANGE,$L(XMRANGE))="-" XMRANGE=XMRANGE_XMRESPS
"RTN","XMJMP1",59,0)
 . F XMRESP=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D  Q:XMABORT
"RTN","XMJMP1",60,0)
 . . I XMRESP>0 D RESPONSE(XMZ,.XMRESP,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT) Q
"RTN","XMJMP1",61,0)
 . . D BODY(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",62,0)
 D:XMPTR LASTACC(XMDUZ,XMK,XMZ,XMZREC,XMSUBJ,XMPTR,XMRESP,+$G(XMMULT))
"RTN","XMJMP1",63,0)
 Q:XMABORT
"RTN","XMJMP1",64,0)
 D:XMRECIPS PRECIPS(XMDUZ,XMK,XMZ,XMRECIPS,XMSUBJ,XMZSTR,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",65,0)
 I XMK,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)),+XMRESP=+$P($G(^XMB(3.9,XMZ,3,0)),U,4) D NONEW^XMXUTIL(XMDUZ,XMK,XMZ,1)
"RTN","XMJMP1",66,0)
 Q
"RTN","XMJMP1",67,0)
LASTACC(XMDUZ,XMK,XMZ,XMZREC,XMSUBJ,XMPTR,XMRESP,XMMULT) ; Note first, last accesses, number of responses read
"RTN","XMJMP1",68,0)
 N XMIM,XMIU,XMINSTR,XMCONFRM
"RTN","XMJMP1",69,0)
 S XMIM("SUBJ")=$P(XMSUBJ," ",2,99)
"RTN","XMJMP1",70,0)
 S XMIM("FROM")=$P(XMZREC,U,2)
"RTN","XMJMP1",71,0)
 S XMINSTR("FLAGS")=$S("^Y^y^"[(U_$P(XMZREC,U,5)_U):"R",1:"")
"RTN","XMJMP1",72,0)
 S XMIU("IEN")=XMPTR
"RTN","XMJMP1",73,0)
 S XMIU("RESP")=XMRESP
"RTN","XMJMP1",74,0)
 D LASTACC^XMXUTIL(XMDUZ,XMK,XMZ,XMRESP,.XMIM,.XMINSTR,.XMIU,.XMCONFRM)
"RTN","XMJMP1",75,0)
 Q:'XMCONFRM!$D(ZTQUEUED)
"RTN","XMJMP1",76,0)
 U IO(0)
"RTN","XMJMP1",77,0)
 D:XMMULT NOGOID^XMJMP2(XMZ,XMZREC)
"RTN","XMJMP1",78,0)
 W !,$$EZBLD^DIALOG(34540) ; >> Confirmation message sent to sender. <<
"RTN","XMJMP1",79,0)
 U IO
"RTN","XMJMP1",80,0)
 Q
"RTN","XMJMP1",81,0)
PRECIPS(XMDUZ,XMK,XMZ,XMRECIPS,XMSUBJ,XMZSTR,XMPRTHDR,XMPAGE,XMABORT) ; Print recipients (replaces QE2^XMA5)
"RTN","XMJMP1",82,0)
 D INFO^XMJMQ(XMDUZ,XMK,XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT) Q:XMABORT
"RTN","XMJMP1",83,0)
 D LATER^XMJMQ(XMDUZ,XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT) Q:XMABORT
"RTN","XMJMP1",84,0)
 I XMRECIPS=1 D
"RTN","XMJMP1",85,0)
 . D SUMMARY^XMJMQ1(XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",86,0)
 E  D DETAIL^XMJMQ(XMZ,XMPRTHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",87,0)
 Q
"RTN","XMJMP1",88,0)
HEADER(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR) ;
"RTN","XMJMP1",89,0)
 D PAGE1HDR(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR)
"RTN","XMJMP1",90,0)
 D W("   ",$$EZBLD^DIALOG(34541)) ; Page 1
"RTN","XMJMP1",91,0)
 I XMK,$D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D W("  ",$$EZBLD^DIALOG($S($D(^XMB(3.7,XMDUZ,"N",XMK,XMZ)):34543,1:34544))) ; Priority! /  *New*
"RTN","XMJMP1",92,0)
 D LINE
"RTN","XMJMP1",93,0)
 Q
"RTN","XMJMP1",94,0)
LINE ;
"RTN","XMJMP1",95,0)
 W !,"-------------------------------------------------------------------------------"
"RTN","XMJMP1",96,0)
 Q
"RTN","XMJMP1",97,0)
PAGE1HDR(XMDUZ,XMK,XMKN,XMZ,XMRESPS,XMZREC,XMSUBJ,XMZSTR) ;
"RTN","XMJMP1",98,0)
 W XMSUBJ
"RTN","XMJMP1",99,0)
 D W("  ",XMZSTR)
"RTN","XMJMP1",100,0)
 D W(" ",$$DATE($P(XMZREC,U,3)))
"RTN","XMJMP1",101,0)
 D W("  ",$$LINES(XMZ))
"RTN","XMJMP1",102,0)
 ;D:$O(^XMB(3.9,XMZ,2005,0)) W(" ",$$EZBLD^DIALOG(34573)) ; Attachment(s).
"RTN","XMJMP1",103,0)
 D WL($$EZBLD^DIALOG(34538,$$NAME^XMXUTIL($P(XMZREC,U,2),1))) ; From:
"RTN","XMJMP1",104,0)
 D:$P(XMZREC,U,4)'="" W(" ",$$EZBLD^DIALOG(34533,$$NAME^XMXUTIL($P(XMZREC,U,4),1))) ; (Sender: x)
"RTN","XMJMP1",105,0)
 I XMRESPS>0 D
"RTN","XMJMP1",106,0)
 . N XMPTR,XMRESP,XMPARM
"RTN","XMJMP1",107,0)
 . ;S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",$S(XMDUZ=.6:DUZ,1:XMDUZ),0))
"RTN","XMJMP1",108,0)
 . S XMPTR=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMJMP1",109,0)
 . S XMRESP=+$P($G(^XMB(3.9,XMZ,1,XMPTR,0)),U,2)
"RTN","XMJMP1",110,0)
 . S XMPARM(1)=XMRESP,XMPARM(2)=XMRESPS
"RTN","XMJMP1",111,0)
 . D W("  ",$$EZBLD^DIALOG($S(XMRESPS=1:34545,1:34546),.XMPARM)) ; XMRESP_ of _XMRESPS_ response(s) read.
"RTN","XMJMP1",112,0)
 D W("  ",$$EZBLD^DIALOG(34539,XMKN)) ; In '_XMKN_' basket.
"RTN","XMJMP1",113,0)
 I XMK D
"RTN","XMJMP1",114,0)
 . N XMVAPOR
"RTN","XMJMP1",115,0)
 . S XMVAPOR=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,5)
"RTN","XMJMP1",116,0)
 . I XMVAPOR W !,$$EZBLD^DIALOG(34572,$$MMDT^XMXUTIL1(XMVAPOR)) ; Automatic Deletion Date:
"RTN","XMJMP1",117,0)
 Q
"RTN","XMJMP1",118,0)
WL(XMSTRING) ;
"RTN","XMJMP1",119,0)
 I $L(XMSTRING)'<IOM,IOM>1 F  D  Q:$L(XMSTRING)<IOM
"RTN","XMJMP1",120,0)
 . W !,$E(XMSTRING,1,IOM-1)
"RTN","XMJMP1",121,0)
 . S XMSTRING=$E(XMSTRING,IOM,999)
"RTN","XMJMP1",122,0)
 W !,XMSTRING
"RTN","XMJMP1",123,0)
 Q
"RTN","XMJMP1",124,0)
W(XMSPACE,XMSTRING) ;
"RTN","XMJMP1",125,0)
 I $X+$L(XMSPACE)+$L(XMSTRING)>IOM D WL(XMSTRING) Q
"RTN","XMJMP1",126,0)
 W XMSPACE,XMSTRING
"RTN","XMJMP1",127,0)
 Q
"RTN","XMJMP1",128,0)
BODY(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,XMPAGE,XMABORT) ;
"RTN","XMJMP1",129,0)
 N XMTEXT,I,J
"RTN","XMJMP1",130,0)
 S I=.999999
"RTN","XMJMP1",131,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I'>0  D  Q:XMABORT
"RTN","XMJMP1",132,0)
 . S XMTEXT=^XMB(3.9,XMZ,2,I,0)
"RTN","XMJMP1",133,0)
 . I $D(XMSECURE),'$G(XMPAKMAN) S XMTEXT=$$DECSTR^XMJMCODE(XMTEXT) ; PackMan messages are never scrambled, just "secured".
"RTN","XMJMP1",134,0)
 . I $E(XMTEXT,1)="$",$F("$TXT$END",$E(XMTEXT,1,4))#4=1 S XMTEXT=$P(XMTEXT,U) ; hide code for secured packman msg.
"RTN","XMJMP1",135,0)
 . I XMTEXT["|TAB|" F  S J=$F(XMTEXT,"|TAB|")-6 Q:J<0  S XMTEXT=$E(XMTEXT,1,J)_$E("         ",1,9-(J-(J\9*9)))_$E(XMTEXT,J+6,999)
"RTN","XMJMP1",136,0)
 . ; A site was sending a print to a device whose IOM was 0.
"RTN","XMJMP1",137,0)
 . ; In such a case, we should ignore IOM.
"RTN","XMJMP1",138,0)
 . F  D  Q:$L(XMTEXT)<IOM!XMABORT!(IOM<2)  S XMTEXT=$E(XMTEXT,IOM,999)
"RTN","XMJMP1",139,0)
 . . I $Y+3+($G(IOST)["C-")>IOSL D  Q:XMABORT
"RTN","XMJMP1",140,0)
 . . . D PAGE(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",141,0)
 . . E  W !
"RTN","XMJMP1",142,0)
 . . W $S(IOM>1:$E(XMTEXT,1,IOM-1),1:XMTEXT)
"RTN","XMJMP1",143,0)
 Q
"RTN","XMJMP1",144,0)
PAGE(XMZ,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,XMPAGE,XMABORT) ;
"RTN","XMJMP1",145,0)
 I $G(IOST)["C-",XMDISP W ! D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJMP1",146,0)
 W @IOF
"RTN","XMJMP1",147,0)
 D:XMPRTHDR PAGE2HDR(XMSUBJ,XMZSTR,.XMPAGE)
"RTN","XMJMP1",148,0)
 Q
"RTN","XMJMP1",149,0)
PAGE2HDR(XMSUBJ,XMZSTR,XMPAGE) ;
"RTN","XMJMP1",150,0)
 S XMPAGE=XMPAGE+1
"RTN","XMJMP1",151,0)
 W XMSUBJ
"RTN","XMJMP1",152,0)
 D W("  ",XMZSTR)
"RTN","XMJMP1",153,0)
 D W("   ",$$EZBLD^DIALOG(34542,XMPAGE)) ; Page x
"RTN","XMJMP1",154,0)
 D LINE
"RTN","XMJMP1",155,0)
 W !
"RTN","XMJMP1",156,0)
 Q
"RTN","XMJMP1",157,0)
RESPONSE(XMZ,XMRESP,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,XMPAGE,XMABORT) ;
"RTN","XMJMP1",158,0)
 N XMRSUBJ,XMREMOTE,XMZR
"RTN","XMJMP1",159,0)
 S XMZR=$P(^XMB(3.9,XMZ,3,XMRESP,0),U)
"RTN","XMJMP1",160,0)
 I '$D(^XMB(3.9,XMZR,0)) D  Q
"RTN","XMJMP1",161,0)
 . ;N DA,DIK
"RTN","XMJMP1",162,0)
 . ;S DA(1)=XMZ,DA=XMRESP
"RTN","XMJMP1",163,0)
 . ;S DIK="^XMB(3.9,XMZ,3,"
"RTN","XMJMP1",164,0)
 . ;D ^DIK
"RTN","XMJMP1",165,0)
 S XMRSUBJ=$P(^XMB(3.9,XMZR,0),U)
"RTN","XMJMP1",166,0)
 S XMREMOTE=$S(XMRSUBJ?1"R".N:0,1:1)
"RTN","XMJMP1",167,0)
 I $Y+XMREMOTE+7+($G(IOST)["C-")>IOSL D  Q:XMABORT
"RTN","XMJMP1",168,0)
 . D PAGE(XMZR,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",169,0)
 . S:XMABORT XMRESP=XMRESP-1
"RTN","XMJMP1",170,0)
 E  W !
"RTN","XMJMP1",171,0)
 D RESPHDR(XMZR,XMRESP)
"RTN","XMJMP1",172,0)
 I XMREMOTE D
"RTN","XMJMP1",173,0)
 . W !,"   ",$$EZBLD^DIALOG(34536,$S(XMRSUBJ["~U~":$$DECODEUP^XMXUTIL1(XMRSUBJ),1:XMRSUBJ)) ; Subj:
"RTN","XMJMP1",174,0)
 W !
"RTN","XMJMP1",175,0)
 D BODY(XMZR,XMSUBJ,XMZSTR,XMDISP,XMPRTHDR,.XMPAGE,.XMABORT)
"RTN","XMJMP1",176,0)
 Q
"RTN","XMJMP2")
0^30^B6112689
"RTN","XMJMP2",1,0)
XMJMP2 ;ISC-SF/GMB-Print,Backup continued ;02/22/2000  16:04
"RTN","XMJMP2",2,0)
 ;;7.1;MailMan;**110**;Jun 02, 1994
"RTN","XMJMP2",3,0)
CHECK(XMDUZ,XMZ,XMZREC,XMNOGO) ;
"RTN","XMJMP2",4,0)
 D CONFID(XMDUZ,XMZ,XMZREC,.XMNOGO) Q:XMNOGO
"RTN","XMJMP2",5,0)
 D SCRAMBLE(XMZ,XMZREC,.XMNOGO)
"RTN","XMJMP2",6,0)
 Q
"RTN","XMJMP2",7,0)
CONFID(XMDUZ,XMZ,XMZREC,XMNOGO) ; Check to see if msg is confidential
"RTN","XMJMP2",8,0)
 Q:XMDUZ=DUZ
"RTN","XMJMP2",9,0)
 Q:$$SURRACC^XMXSEC(XMDUZ,"",XMZ,XMZREC)  ; "access"
"RTN","XMJMP2",10,0)
 S XMNOGO=1
"RTN","XMJMP2",11,0)
 I $D(ZTQUEUED) D  Q
"RTN","XMJMP2",12,0)
 . S XMNOGO(1)=^TMP("XMERR",$J,XMERR,"TEXT",1)
"RTN","XMJMP2",13,0)
 . K XMERR,^TMP("XMERR",$J)
"RTN","XMJMP2",14,0)
 U IO(0)  ; In case we are not printing to terminal
"RTN","XMJMP2",15,0)
 D NOGOID(XMZ,XMZREC)
"RTN","XMJMP2",16,0)
 W !,^TMP("XMERR",$J,XMERR,"TEXT",1)
"RTN","XMJMP2",17,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMJMP2",18,0)
 U IO
"RTN","XMJMP2",19,0)
 Q
"RTN","XMJMP2",20,0)
SCRAMBLE(XMZ,XMZREC,XMNOGO) ;
"RTN","XMJMP2",21,0)
 ; If '$D(ZTQUEUED), and scrambled, ask the user for the password.
"RTN","XMJMP2",22,0)
 Q:'$D(^XMB(3.9,XMZ,"K"))!$D(XMSECURE)
"RTN","XMJMP2",23,0)
 I XMPAKMAN D  Q
"RTN","XMJMP2",24,0)
 . N XMERRMSG
"RTN","XMJMP2",25,0)
 . S XMERRMSG=$$EZBLD^DIALOG(37416.4) ; You may not Print a secure KIDS or PackMan message.
"RTN","XMJMP2",26,0)
 . S XMNOGO=1
"RTN","XMJMP2",27,0)
 . I $D(ZTQUEUED) D  Q
"RTN","XMJMP2",28,0)
 . . S XMNOGO(1)=XMERRMSG
"RTN","XMJMP2",29,0)
 . U IO(0)  ; In case we are not printing to terminal
"RTN","XMJMP2",30,0)
 . D NOGOID(XMZ,XMZREC)
"RTN","XMJMP2",31,0)
 . W !,XMERRMSG
"RTN","XMJMP2",32,0)
 . U IO
"RTN","XMJMP2",33,0)
 I $D(ZTQUEUED) D  Q
"RTN","XMJMP2",34,0)
 . S XMNOGO=1
"RTN","XMJMP2",35,0)
 . ;This message has been secured with a password.
"RTN","XMJMP2",36,0)
 . ;When a range of messages is queued to print,
"RTN","XMJMP2",37,0)
 . ;those messages with passwords cannot be printed because
"RTN","XMJMP2",38,0)
 . ;there is no opportunity to ask for the password.
"RTN","XMJMP2",39,0)
 . D BLD^DIALOG(34521,"","","XMNOGO")
"RTN","XMJMP2",40,0)
 U IO(0)  ; In case we are not printing to terminal
"RTN","XMJMP2",41,0)
 D NOGOID(XMZ,XMZREC)
"RTN","XMJMP2",42,0)
 S:'$$KEYOK^XMJMCODE(XMZ,$P(XMZREC,U,10)) XMNOGO=1
"RTN","XMJMP2",43,0)
 U IO
"RTN","XMJMP2",44,0)
 Q
"RTN","XMJMP2",45,0)
NOGOID(XMZ,XMZREC) ;
"RTN","XMJMP2",46,0)
 N XMSUBJ
"RTN","XMJMP2",47,0)
 S XMSUBJ=$P(XMZREC,U,1)
"RTN","XMJMP2",48,0)
 S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMP2",49,0)
 W !,$$EZBLD^DIALOG(34536,XMSUBJ),"  ",$$EZBLD^DIALOG(34537,XMZ) ; Subj: _XMSUBJ_  _[#_XMZ_]
"RTN","XMJMP2",50,0)
 W !,$$EZBLD^DIALOG(34538,$$NAME^XMXUTIL($P(XMZREC,U,2),1)),! ; From:
"RTN","XMJMP2",51,0)
 Q
"RTN","XMJMP2",52,0)
NOGOMSG(XMDUZ,XMZ,XMZREC,XMNOGO) ;
"RTN","XMJMP2",53,0)
 N I
"RTN","XMJMP2",54,0)
 D NOGOID(XMZ,XMZREC)
"RTN","XMJMP2",55,0)
 S I=""
"RTN","XMJMP2",56,0)
 F  S I=$O(XMNOGO(I)) Q:I=""  D
"RTN","XMJMP2",57,0)
 . W !,XMNOGO(I)
"RTN","XMJMP2",58,0)
 Q
"RTN","XMJMQ")
0^27^B62823014
"RTN","XMJMQ",1,0)
XMJMQ ;ISC-SF/GMB- Q,QD,QN Query recipients ;01/10/2000  09:27
"RTN","XMJMQ",2,0)
 ;;7.1;MailMan;**40,57,70,50,96,110**;Jun 02, 1994
"RTN","XMJMQ",3,0)
 ; Replaces ^XMA5,^XMA5A (ISC-WASH/THM/CAP)
"RTN","XMJMQ",4,0)
Q(XMDUZ,XMK,XMKN,XMZ) ; Query
"RTN","XMJMQ",5,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",6,0)
 D QINIT(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",7,0)
 D SUMMARY^XMJMQ1(XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ",8,0)
 Q
"RTN","XMJMQ",9,0)
QD(XMDUZ,XMK,XMKN,XMZ) ; Query Detail
"RTN","XMJMQ",10,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",11,0)
 D QINIT(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",12,0)
 D DETAIL(XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ",13,0)
 Q
"RTN","XMJMQ",14,0)
QN(XMDUZ,XMK,XMKN,XMZ) ; Query Network
"RTN","XMJMQ",15,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",16,0)
 D QINIT(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",17,0)
 D NETWORK^XMJMQ1(XMZ,.XMABORT) Q:XMABORT
"RTN","XMJMQ",18,0)
 D DETAIL(XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ",19,0)
 Q
"RTN","XMJMQ",20,0)
QNAME(XMDUZ,XMK,XMKN,XMZ) ; Query someone's name
"RTN","XMJMQ",21,0)
 N XMRESPM,XMABORT,DIR,Y,DIRUT,XMNAME
"RTN","XMJMQ",22,0)
 F  D  Q:$D(DIRUT)
"RTN","XMJMQ",23,0)
 . S DIR(0)="FO^1:30^K:"", ""[$E(X) X"
"RTN","XMJMQ",24,0)
 . S DIR("A")=$$EZBLD^DIALOG(34555) ; Enter the person's name or partial name
"RTN","XMJMQ",25,0)
 . D BLD^DIALOG(34556,"","","DIR(""?"")")
"RTN","XMJMQ",26,0)
 . ;Name must be from 1 to 30 characters,
"RTN","XMJMQ",27,0)
 . ;and must not contain ^, or begin with comma or space.
"RTN","XMJMQ",28,0)
 . D ^DIR Q:$D(DIRUT)
"RTN","XMJMQ",29,0)
 . S XMNAME=Y
"RTN","XMJMQ",30,0)
 . D QINIT(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",31,0)
 . D SEARCH^XMJMQ1(XMZ,XMNAME,XMRESPM)
"RTN","XMJMQ",32,0)
 Q
"RTN","XMJMQ",33,0)
QNAMEX(XMDUZ,XMK,XMKN,XMZ,XMNAME) ; Query someone's name (name is supplied)
"RTN","XMJMQ",34,0)
 N XMRESPM,XMABORT
"RTN","XMJMQ",35,0)
 I ($L(XMNAME)<1)!($L(XMNAME)>30)!(XMNAME[U)!(", "[$E(XMNAME,1)) D  Q
"RTN","XMJMQ",36,0)
 . N XMTEXT
"RTN","XMJMQ",37,0)
 . W *7
"RTN","XMJMQ",38,0)
 . D BLD^DIALOG(34556,"","","XMTEXT","F")
"RTN","XMJMQ",39,0)
 . D MSG^DIALOG("WH","","","","XMTEXT")
"RTN","XMJMQ",40,0)
 . ;Name must be from 1 to 30 characters,
"RTN","XMJMQ",41,0)
 . ;and must not contain ^, or begin with comma or space.
"RTN","XMJMQ",42,0)
 D QINIT(XMDUZ,XMK,XMKN,XMZ,.XMRESPM,.XMABORT)
"RTN","XMJMQ",43,0)
 D SEARCH^XMJMQ1(XMZ,XMNAME,XMRESPM)
"RTN","XMJMQ",44,0)
 Q
"RTN","XMJMQ",45,0)
QINIT(XMDUZ,XMK,XMKN,XMZ,XMRESPM,XMABORT) ;
"RTN","XMJMQ",46,0)
 N XMZSTR,XMSUBJ,XMRESPS
"RTN","XMJMQ",47,0)
 S XMABORT=0
"RTN","XMJMQ",48,0)
 S XMZSTR=$$EZBLD^DIALOG(34537,XMZ) ; [#_XMZ_]
"RTN","XMJMQ",49,0)
 S XMSUBJ=$P(^XMB(3.9,XMZ,0),U)
"RTN","XMJMQ",50,0)
 S:XMSUBJ["~U~" XMSUBJ=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMJMQ",51,0)
 S XMSUBJ=$$EZBLD^DIALOG(34536,XMSUBJ) ; Subj: _XMSUBJ
"RTN","XMJMQ",52,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMQ",53,0)
 S XMRESPM=$$EZBLD^DIALOG($S(XMRESPS=1:34557.1,1:34557),XMRESPS) ; XMRESPS_ response / responses
"RTN","XMJMQ",54,0)
 W @IOF
"RTN","XMJMQ",55,0)
 D PAGE1HDR^XMJMP1(XMDUZ,XMK,XMKN,XMZ,XMRESPS,^XMB(3.9,XMZ,0),XMSUBJ,XMZSTR)
"RTN","XMJMQ",56,0)
 D INFO(XMDUZ,XMK,XMZ,0,"","","",.XMABORT)
"RTN","XMJMQ",57,0)
 Q
"RTN","XMJMQ",58,0)
INFO(XMDUZ,XMK,XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ;
"RTN","XMJMQ",59,0)
 N XMREC,XMRECIPS,XMDIALOG
"RTN","XMJMQ",60,0)
 S XMREC=^XMB(3.9,XMZ,0)
"RTN","XMJMQ",61,0)
 I $Y+4>IOSL D  Q:XMABORT
"RTN","XMJMQ",62,0)
 . D PAGE(.XMABORT)
"RTN","XMJMQ",63,0)
 E  W !
"RTN","XMJMQ",64,0)
 W !,$$EZBLD^DIALOG(34559,XMZ_"@"_^XMB("NETNAME")) ; Local Message-ID:
"RTN","XMJMQ",65,0)
 S XMDIALOG=$S($P(XMREC,U,7)["P":34543,$P(XMREC,U,7)["S":34560,$P(XMREC,U,8):34561,1:0) I XMDIALOG D W(XMDIALOG) ; Priority! / [SPOOL] / <RESPONSE>
"RTN","XMJMQ",66,0)
 S XMRECIPS=+$P($G(^XMB(3.9,XMZ,1,0)),U,4)
"RTN","XMJMQ",67,0)
 I XMRECIPS D W($S(XMRECIPS=1:34562.1,1:34562),XMRECIPS) ; (_XMRECIPS_ Recipient(s))
"RTN","XMJMQ",68,0)
 I "^Y^y^"[(U_$P(XMREC,U,5)_U) D W(34564) ; Confirmation requested.
"RTN","XMJMQ",69,0)
 I $D(^XMB(3.9,XMZ,"K")) D W($S(" "[$P(XMREC,U,10):34565,1:34566),$P(XMREC,U,10)) ; Scramble Hint:
"RTN","XMJMQ",70,0)
 I $O(^XMB(3.9,XMZ,2005,0)) D LIST^XMA2B ; MIME body parts
"RTN","XMJMQ",71,0)
 I "^Y^y^"[(U_$P(XMREC,U,9)_U) D W(34567) ; Closed.
"RTN","XMJMQ",72,0)
 I "^Y^y^"[(U_$P(XMREC,U,11)_U) D W(34568) ; Confidential.
"RTN","XMJMQ",73,0)
 I "^Y^y^"[(U_$P(XMREC,U,12)_U) D W(34570) ; 'Information only' for all recipients.
"RTN","XMJMQ",74,0)
 I $D(^XMB(3.9,XMZ,.5)) D
"RTN","XMJMQ",75,0)
 . S XMREC=^XMB(3.9,XMZ,.5)
"RTN","XMJMQ",76,0)
 . I $P(XMREC,U,1)'="" D W(34571,$P(XMREC,U,1)) ; Delivery basket:
"RTN","XMJMQ",77,0)
 I $D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)) D
"RTN","XMJMQ",78,0)
 . N XMVAPOR
"RTN","XMJMQ",79,0)
 . S XMVAPOR=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,5)
"RTN","XMJMQ",80,0)
 . I XMVAPOR D W(34572,$$MMDT^XMXUTIL1(XMVAPOR)) ; Automatic Deletion Date:
"RTN","XMJMQ",81,0)
 D LATER(XMDUZ,XMZ,XMPHDR,XMSUBJ,XMZSTR,.XMPAGE,.XMABORT)
"RTN","XMJMQ",82,0)
 Q
"RTN","XMJMQ",83,0)
DETAIL(XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ;
"RTN","XMJMQ",84,0)
 ; XMRESPM  Last part msg: of Number of responses in msg
"RTN","XMJMQ",85,0)
 N XMTO,XMRESPM,XMNAME,XMIEN,XMTYPE
"RTN","XMJMQ",86,0)
 I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",87,0)
 W !
"RTN","XMJMQ",88,0)
 S XMRESPM=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMJMQ",89,0)
 S XMRESPM=$$EZBLD^DIALOG($S(XMRESPM=1:34557.1,1:34557),XMRESPM) ; XMRESPM_ response / responses
"RTN","XMJMQ",90,0)
 S XMTO=""
"RTN","XMJMQ",91,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,1,"C",XMTO)) Q:XMTO=""  D  Q:XMABORT
"RTN","XMJMQ",92,0)
 . S XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMTO,""))
"RTN","XMJMQ",93,0)
 . I XMTO=+XMTO D
"RTN","XMJMQ",94,0)
 . . S XMNAME=$$NAME^XMXUTIL(XMTO)
"RTN","XMJMQ",95,0)
 . E  D
"RTN","XMJMQ",96,0)
 . . I $L(XMTO)>29 S XMNAME=$P(^XMB(3.9,XMZ,1,XMIEN,0),U,1) Q
"RTN","XMJMQ",97,0)
 . . S XMNAME=XMTO
"RTN","XMJMQ",98,0)
 . D WNAME(XMZ,XMNAME,XMIEN,XMRESPM,.XMTYPE,.XMABORT)
"RTN","XMJMQ",99,0)
 Q
"RTN","XMJMQ",100,0)
WNAME(XMZ,XMNAME,XMIEN,XMRESPM,XMTYPE,XMABORT) ;
"RTN","XMJMQ",101,0)
 N XMREC
"RTN","XMJMQ",102,0)
 S XMREC=^XMB(3.9,XMZ,1,XMIEN,0)
"RTN","XMJMQ",103,0)
 I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",104,0)
 W !
"RTN","XMJMQ",105,0)
 I $D(^XMB(3.9,XMZ,1,XMIEN,"T")) D  ; CC: Info: Thru:
"RTN","XMJMQ",106,0)
 . S XMTYPE=$P(^XMB(3.9,XMZ,1,XMIEN,"T"),U,1)
"RTN","XMJMQ",107,0)
 . Q:XMTYPE=""
"RTN","XMJMQ",108,0)
 . S:'$D(XMTYPE(XMTYPE)) XMTYPE(XMTYPE)=$$EXTERNAL^DILFD(3.91,6.5,"",XMTYPE)
"RTN","XMJMQ",109,0)
 . W XMTYPE(XMTYPE),": "
"RTN","XMJMQ",110,0)
 W XMNAME
"RTN","XMJMQ",111,0)
 W:$X<20 ?20
"RTN","XMJMQ",112,0)
 I +$P(XMREC,U,1)=$P(XMREC,U,1) D  Q  ; local user
"RTN","XMJMQ",113,0)
 . I $P(XMREC,U,3)="" D
"RTN","XMJMQ",114,0)
 . . W $$EZBLD^DIALOG(34574) ; " Not read."
"RTN","XMJMQ",115,0)
 . E  D  Q:XMABORT
"RTN","XMJMQ",116,0)
 . . D W3(34575,$$MMDT^XMXUTIL1($P(XMREC,U,3)),.XMABORT) Q:XMABORT  ; Last read:
"RTN","XMJMQ",117,0)
 . . I $P(XMREC,U,2) D  Q:XMABORT
"RTN","XMJMQ",118,0)
 . . . N XMPARM
"RTN","XMJMQ",119,0)
 . . . S XMPARM(1)=$P(XMREC,U,2),XMPARM(2)=XMRESPM
"RTN","XMJMQ",120,0)
 . . . D W3(34576,.XMPARM,.XMABORT) ; (x of y responses)
"RTN","XMJMQ",121,0)
 . . I $P(XMREC,U,10)'="" D W3(34577,$$MMDT^XMXUTIL1($P(XMREC,U,10)),.XMABORT) Q:XMABORT  ; [First read: x]
"RTN","XMJMQ",122,0)
 . . I $D(^XMB(3.9,XMZ,1,XMIEN,"C")) D W3(34578,$$MMDT^XMXUTIL1(^("C")),.XMABORT) Q:XMABORT  ; Copied:
"RTN","XMJMQ",123,0)
 . . I $D(^XMB(3.9,XMZ,1,XMIEN,"S")) D W3(34580,^("S"),.XMABORT) Q:XMABORT  ; Surrogate:
"RTN","XMJMQ",124,0)
 . . I $D(^XMB(3.9,XMZ,1,XMIEN,"D")),^("D") D W3(34581,$$MMDT^XMXUTIL1(^("D")),.XMABORT) Q:XMABORT  ; Terminated:
"RTN","XMJMQ",125,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",126,0)
 I $E(XMNAME,1,2)="F.",$P(XMREC,U,12)'=""!$P(XMREC,U,11) D  Q
"RTN","XMJMQ",127,0)
 . I $P(XMREC,U,5)'="" D W3(34582,$$MMDT^XMXUTIL1($P(XMREC,U,5)),.XMABORT) Q:XMABORT  ; Sent to fax:
"RTN","XMJMQ",128,0)
 . I $P(XMREC,U,6)'="" D W3(34583,$P(XMREC,U,6),.XMABORT) Q:XMABORT  ; Status:
"RTN","XMJMQ",129,0)
 . I $P(XMREC,U,12)'="" D W3(34584,$P(XMREC,U,12),.XMABORT) Q:XMABORT  ; Fax ID:
"RTN","XMJMQ",130,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",131,0)
 I XMNAME["@" D  Q
"RTN","XMJMQ",132,0)
 . I $P(XMREC,U,5)'="" D W3(34585,$$MMDT^XMXUTIL1($P(XMREC,U,5)),.XMABORT) Q:XMABORT  ; Sent:
"RTN","XMJMQ",133,0)
 . I $P(XMREC,U,8)'="" D W3($S($P(XMREC,U,8)=1:34586,1:34587),$P(XMREC,U,8),.XMABORT) Q:XMABORT  ; Time: x seconds
"RTN","XMJMQ",134,0)
 . I $P(XMREC,U,7)'="",$D(^DIC(4.2,$P(XMREC,U,7),0)) D W3(34588,$P(^(0),U),.XMABORT) Q:XMABORT  ; Path:
"RTN","XMJMQ",135,0)
 . I $P(XMREC,U,4)'="" D W3(34590,$P(XMREC,U,4),.XMABORT) Q:XMABORT  ; Message ID:
"RTN","XMJMQ",136,0)
 . I $P(XMREC,U,6)'="" D W3(34583,$P(XMREC,U,6),.XMABORT) Q:XMABORT  ; Status:
"RTN","XMJMQ",137,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",138,0)
 I $E(XMNAME,1,3)="* (" D  Q  ; Broadcast
"RTN","XMJMQ",139,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT)
"RTN","XMJMQ",140,0)
 I $E(XMNAME,1,2)="D."!($E(XMNAME,1,2)="S.") D  Q
"RTN","XMJMQ",141,0)
 . I $P(XMREC,U,3)'="" D W3(34591,$$MMDT^XMXUTIL1($P(XMREC,U,3)),.XMABORT) Q:XMABORT  ; Date:
"RTN","XMJMQ",142,0)
 . I $P(XMREC,U,6)'="" D W3(34583,$P(XMREC,U,6),.XMABORT) Q:XMABORT  ; Status:
"RTN","XMJMQ",143,0)
 . I $D(^XMB(3.9,XMZ,1,XMIEN,"F")) D FWD(XMZ,XMIEN,.XMABORT) Q:XMABORT
"RTN","XMJMQ",144,0)
 Q
"RTN","XMJMQ",145,0)
FWD(XMZ,XMIEN,XMABORT) ;
"RTN","XMJMQ",146,0)
 N XMFWDBY
"RTN","XMJMQ",147,0)
 S XMFWDBY=$P(^XMB(3.9,XMZ,1,XMIEN,"F"),U)
"RTN","XMJMQ",148,0)
 I $E(XMFWDBY,1)=" " D W3(34592,XMFWDBY,.XMABORT) Q  ; Forwarded on:
"RTN","XMJMQ",149,0)
 I $E(XMFWDBY,1)?1N!($E(XMFWDBY,1)=".") D W3(34593,$$NAME^XMXUTIL(+XMFWDBY)_" "_$P(XMFWDBY," ",2,99),.XMABORT) Q  ; Forwarded by:
"RTN","XMJMQ",150,0)
 D W3(34593,XMFWDBY,.XMABORT) ; Forwarded by:
"RTN","XMJMQ",151,0)
 Q
"RTN","XMJMQ",152,0)
W(XMPIECE,XMPARM) ;
"RTN","XMJMQ",153,0)
 S XMPIECE=$$EZBLD^DIALOG(XMPIECE,.XMPARM)
"RTN","XMJMQ",154,0)
 I 1+$L(XMPIECE)+$X>IOM D  Q:XMABORT
"RTN","XMJMQ",155,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",156,0)
 . W !
"RTN","XMJMQ",157,0)
 W " ",XMPIECE
"RTN","XMJMQ",158,0)
 Q
"RTN","XMJMQ",159,0)
W3(XMPIECE,XMPARM,XMABORT) ;
"RTN","XMJMQ",160,0)
 S XMPIECE=$$EZBLD^DIALOG(XMPIECE,.XMPARM)
"RTN","XMJMQ",161,0)
 I 1+$L(XMPIECE)+$X>IOM D  Q:XMABORT
"RTN","XMJMQ",162,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",163,0)
 . W !,?20
"RTN","XMJMQ",164,0)
 W " ",XMPIECE
"RTN","XMJMQ",165,0)
 Q
"RTN","XMJMQ",166,0)
 ;PAGE(XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT);
"RTN","XMJMQ",167,0)
PAGE(XMABORT) ;
"RTN","XMJMQ",168,0)
 I $G(IOST)["C-" D PAGE^XMXUTIL(.XMABORT) Q:XMABORT
"RTN","XMJMQ",169,0)
 W @IOF
"RTN","XMJMQ",170,0)
 Q:'XMPHDR
"RTN","XMJMQ",171,0)
 D PAGE2HDR^XMJMP1(XMSUBJ,XMZSTR,.XMPAGE)
"RTN","XMJMQ",172,0)
 Q
"RTN","XMJMQ",173,0)
LATER(XMDUZ,XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ; List dates message will be new on 'later'
"RTN","XMJMQ",174,0)
 Q:'$O(^XMB(3.73,"AC",XMZ,XMDUZ,0))
"RTN","XMJMQ",175,0)
 N XMIEN,XMSEP
"RTN","XMJMQ",176,0)
 I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",177,0)
 W !,$$EZBLD^DIALOG(34595) ; Message will be NEW on:
"RTN","XMJMQ",178,0)
 S XMIEN="",XMSEP=" "
"RTN","XMJMQ",179,0)
 F  S XMIEN=$O(^XMB(3.73,"AC",XMZ,XMDUZ,XMIEN)) Q:XMIEN=""  D
"RTN","XMJMQ",180,0)
 . D W2(XMSEP,$$FMTE^XLFDT($E($P(^XMB(3.73,XMIEN,0),U),1,12)),.XMABORT)
"RTN","XMJMQ",181,0)
 . S XMSEP=", "
"RTN","XMJMQ",182,0)
 Q
"RTN","XMJMQ",183,0)
W2(XMSEP,XMPIECE,XMABORT) ;
"RTN","XMJMQ",184,0)
 I $X+$L(XMSEP)+$L(XMPIECE)>IOM D  Q:XMABORT
"RTN","XMJMQ",185,0)
 . I $Y+3>IOSL D PAGE(.XMABORT) Q:XMABORT
"RTN","XMJMQ",186,0)
 . W !,XMPIECE
"RTN","XMJMQ",187,0)
 E  W XMSEP,XMPIECE
"RTN","XMJMQ",188,0)
 Q
"RTN","XMJMQ1")
0^31^B18614734
"RTN","XMJMQ1",1,0)
XMJMQ1 ;ISC-SF/GMB- Q,QD,QN Query recipients (continued) ;01/10/2000  08:10
"RTN","XMJMQ1",2,0)
 ;;7.1;MailMan;**40,50,110**;Jun 02, 1994
"RTN","XMJMQ1",3,0)
 ; Replaces ^XMA5,^XMA5A (ISC-WASH/THM/CAP)
"RTN","XMJMQ1",4,0)
NETWORK(XMZ,XMABORT) ;
"RTN","XMJMQ1",5,0)
 N I,J,XMLINE,XMPOS,XMPHDR
"RTN","XMJMQ1",6,0)
 I $O(^XMB(3.9,XMZ,2,0))'<1 D  Q
"RTN","XMJMQ1",7,0)
 . W !!,$$EZBLD^DIALOG(34550) ; This message originated locally.  There is no network header.
"RTN","XMJMQ1",8,0)
 I $D(^XMB(3.9,XMZ,.7)) W !!,$$EZBLD^DIALOG(34551,$P(^XMB(3.9,XMZ,.7),U,1)) ; Envelope From:
"RTN","XMJMQ1",9,0)
 W !!,$$EZBLD^DIALOG(34552),! ; Network header:
"RTN","XMJMQ1",10,0)
 S (I,XMPHDR)=0
"RTN","XMJMQ1",11,0)
 F  S I=$O(^XMB(3.9,XMZ,2,I)) Q:I=""!(I'<1)  D  Q:XMABORT
"RTN","XMJMQ1",12,0)
 . S XMLINE=^XMB(3.9,XMZ,2,I,0)
"RTN","XMJMQ1",13,0)
 . I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",14,0)
 . I $L(XMLINE)<IOM W !,XMLINE Q
"RTN","XMJMQ1",15,0)
 . S XMPOS=0
"RTN","XMJMQ1",16,0)
 . F  D  Q:XMLINE=""!XMABORT
"RTN","XMJMQ1",17,0)
 . . I $L(XMLINE)+XMPOS+1>IOM F J=IOM-XMPOS-1:-1:IOM-XMPOS-20 Q:", -;)"[$E(XMLINE,J)
"RTN","XMJMQ1",18,0)
 . . I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",19,0)
 . . W !,?XMPOS,$E(XMLINE,1,J)
"RTN","XMJMQ1",20,0)
 . . S XMPOS=10
"RTN","XMJMQ1",21,0)
 . . S XMLINE=$E(XMLINE,J+1,999)
"RTN","XMJMQ1",22,0)
 Q
"RTN","XMJMQ1",23,0)
SUMMARY(XMZ,XMPHDR,XMSUBJ,XMZSTR,XMPAGE,XMABORT) ;
"RTN","XMJMQ1",24,0)
 N XMTYPE
"RTN","XMJMQ1",25,0)
 I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",26,0)
 W !
"RTN","XMJMQ1",27,0)
 I '$O(^XMB(3.9,XMZ,6,0)),'$O(^XMB(3.9,XMZ,7,0)) D  Q
"RTN","XMJMQ1",28,0)
 . N XMTEXT
"RTN","XMJMQ1",29,0)
 . D BLD^DIALOG(34596,"","","XMTEXT","F")
"RTN","XMJMQ1",30,0)
 . D MSG^DIALOG("WM","","","","XMTEXT")
"RTN","XMJMQ1",31,0)
 . ;This is an old message which has no summary recipient list.
"RTN","XMJMQ1",32,0)
 . ;Only the Detail Query (QD) is available.
"RTN","XMJMQ1",33,0)
 W !,$$EZBLD^DIALOG(34597),! ; This message was addressed as follows:
"RTN","XMJMQ1",34,0)
 D PRTADDR(XMZ,6,.XMTYPE,.XMABORT) Q:XMABORT  ; addressed to
"RTN","XMJMQ1",35,0)
 D PRTADDR(XMZ,7,.XMTYPE,.XMABORT)            ; deliver later to
"RTN","XMJMQ1",36,0)
 Q
"RTN","XMJMQ1",37,0)
PRTADDR(XMZ,XMNODE,XMTYPE,XMABORT) ;
"RTN","XMJMQ1",38,0)
 N XMTO
"RTN","XMJMQ1",39,0)
 ;List Groups first
"RTN","XMJMQ1",40,0)
 S XMTO="G."
"RTN","XMJMQ1",41,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,XMNODE,"B",XMTO)) Q:$E(XMTO,1,2)'="G."  D PRTSUMRY(XMZ,XMNODE,XMTO,.XMTYPE,.XMABORT)  Q:XMABORT
"RTN","XMJMQ1",42,0)
 Q:XMABORT
"RTN","XMJMQ1",43,0)
 S XMTO=""  ; Now list the rest
"RTN","XMJMQ1",44,0)
 F  S XMTO=$O(^XMB(3.9,XMZ,XMNODE,"B",XMTO)) Q:XMTO=""  D  Q:XMABORT
"RTN","XMJMQ1",45,0)
 . Q:$E(XMTO,1,2)="G."
"RTN","XMJMQ1",46,0)
 . D PRTSUMRY(XMZ,XMNODE,XMTO,.XMTYPE,.XMABORT)
"RTN","XMJMQ1",47,0)
 Q
"RTN","XMJMQ1",48,0)
PRTSUMRY(XMZ,XMNODE,XMTO,XMTYPE,XMABORT) ;
"RTN","XMJMQ1",49,0)
 N XMIEN,XMREC
"RTN","XMJMQ1",50,0)
 S XMIEN=$O(^XMB(3.9,XMZ,XMNODE,"B",XMTO,0)) Q:'XMIEN
"RTN","XMJMQ1",51,0)
 S XMREC=$G(^XMB(3.9,XMZ,XMNODE,XMIEN,0)) Q:XMREC=""
"RTN","XMJMQ1",52,0)
 I $Y+3>IOSL D PAGE^XMJMQ(.XMABORT) Q:XMABORT
"RTN","XMJMQ1",53,0)
 I $P(XMREC,U,2)'="" D
"RTN","XMJMQ1",54,0)
 . S XMTYPE=$P(XMREC,U,2)
"RTN","XMJMQ1",55,0)
 . I '$D(XMTYPE(XMTYPE)) S XMTYPE(XMTYPE)=$$EXTERNAL^DILFD(3.91,6.5,"",XMTYPE) I $D(DIERR) S XMTYPE(XMTYPE)=XMTYPE
"RTN","XMJMQ1",56,0)
 . W !,XMTYPE(XMTYPE),":",$P(XMREC,U,1)
"RTN","XMJMQ1",57,0)
 E  W !,$P(XMREC,U,1)
"RTN","XMJMQ1",58,0)
 Q:XMNODE=6
"RTN","XMJMQ1",59,0)
 N XMPARM
"RTN","XMJMQ1",60,0)
 S XMPARM(1)=$$MMDT^XMXUTIL1($P(XMREC,U,5)),XMPARM(2)=$P(XMREC,U,4)
"RTN","XMJMQ1",61,0)
 D W^XMJMQ(34598,.XMPARM) ; for delivery x by y
"RTN","XMJMQ1",62,0)
 Q
"RTN","XMJMQ1",63,0)
SEARCH(XMZ,XMNAME,XMRESPM) ;
"RTN","XMJMQ1",64,0)
 N XMPHDR
"RTN","XMJMQ1",65,0)
 S XMPHDR=0
"RTN","XMJMQ1",66,0)
 I $Y+5>IOSL D  Q:XMABORT
"RTN","XMJMQ1",67,0)
 . D PAGE^XMJMQ(.XMABORT)
"RTN","XMJMQ1",68,0)
 E  W !
"RTN","XMJMQ1",69,0)
 W !,$$EZBLD^DIALOG(34554,XMNAME),! ; Searching for recipients that match '_XMNAME_'.
"RTN","XMJMQ1",70,0)
 D FIND^DIC(200,"","","A",XMNAME,"","B^BB^C^D","I $D(^XMB(3.9,XMZ,1,""C"",+Y))")
"RTN","XMJMQ1",71,0)
 I '$D(DIERR) D PSEARCH(200,XMZ,XMRESPM,.XMABORT) Q:XMABORT
"RTN","XMJMQ1",72,0)
 Q:$O(^XMB(3.9,XMZ,1,"C",":"))=""  ; Quit if there aren't any non-local addressees
"RTN","XMJMQ1",73,0)
 N XMSCREEN
"RTN","XMJMQ1",74,0)
 S XMSCREEN=$S(+XMNAME=XMNAME:"I '$D(^XMB(3.9,XMZ,1,""C"",XMNAME))",1:"")
"RTN","XMJMQ1",75,0)
 D FIND^DIC(3.91,","_XMZ_",","","C",XMNAME,"","C",XMSCREEN)
"RTN","XMJMQ1",76,0)
 I '$D(DIERR) D PSEARCH(3.91,XMZ,XMRESPM,.XMABORT)
"RTN","XMJMQ1",77,0)
 Q:$E(XMNAME)'?1U  ; Quit if the search string does not begin with an upper case letter
"RTN","XMJMQ1",78,0)
 Q:$O(^XMB(3.9,XMZ,1,"C","`"))=""  ; Quit if there aren't any lower case addressees
"RTN","XMJMQ1",79,0)
 ; FM will translate lower case to upper case in its search, but won't
"RTN","XMJMQ1",80,0)
 ; translate upper to lower, so we do it here.
"RTN","XMJMQ1",81,0)
 S XMSCREEN="I ^(0)]""`""" ; Limit search to lower case addresses
"RTN","XMJMQ1",82,0)
 D FIND^DIC(3.91,","_XMZ_",","","C",$$LOW^XLFSTR(XMNAME),"","C",XMSCREEN)
"RTN","XMJMQ1",83,0)
 I '$D(DIERR) D PSEARCH(3.91,XMZ,XMRESPM,.XMABORT)
"RTN","XMJMQ1",84,0)
 Q
"RTN","XMJMQ1",85,0)
PSEARCH(XMFILE,XMZ,XMRESPM,XMABORT) ; Print search results
"RTN","XMJMQ1",86,0)
 N I,XMIEN,XMTYPE
"RTN","XMJMQ1",87,0)
 S I=0
"RTN","XMJMQ1",88,0)
 F  S I=$O(^TMP("DILIST",$J,1,I)) Q:I=""  D  Q:XMABORT
"RTN","XMJMQ1",89,0)
 . S XMIEN=^TMP("DILIST",$J,2,I)
"RTN","XMJMQ1",90,0)
 . S:XMFILE=200 XMIEN=$O(^XMB(3.9,XMZ,1,"C",XMIEN,0))
"RTN","XMJMQ1",91,0)
 . D WNAME^XMJMQ(XMZ,^TMP("DILIST",$J,1,I),XMIEN,XMRESPM,.XMTYPE,.XMABORT)
"RTN","XMJMQ1",92,0)
 Q
"RTN","XMJMRO")
0^22^B7678503
"RTN","XMJMRO",1,0)
XMJMRO ;ISC-SF/GMB-Options at 'reply' transmit prompt ;01/31/2000  13:38
"RTN","XMJMRO",2,0)
 ;;7.1;MailMan;**50,89,110**;Jun 02, 1994
"RTN","XMJMRO",3,0)
 ; Replaces ^XMA22 (ISC-WASH/CAP/THM)
"RTN","XMJMRO",4,0)
REPLYMSG(XMDUZ,XMK,XMKN,XMZO,XMZ,XMSUBJ,XMRESTR,XMPTR,XMRESPSO,XMRESP,XMABORT) ;
"RTN","XMJMRO",5,0)
 N XMFINISH,XMLINE,XMDIR,XMY,XMOPT,XMOX
"RTN","XMJMRO",6,0)
 S XMFINISH=0
"RTN","XMJMRO",7,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMJMRO",8,0)
 . N XMNAME
"RTN","XMJMRO",9,0)
 . I XMPTR D CHKRESP^XMJMP(XMDUZ,XMZO,XMRESPSO,XMRESP)
"RTN","XMJMRO",10,0)
 . D REPLYSET(XMDUZ,.XMOPT,.XMOX,.XMDIR)
"RTN","XMJMRO",11,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMRO",12,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMRO",13,0)
 . D @XMY
"RTN","XMJMRO",14,0)
 Q
"RTN","XMJMRO",15,0)
REPLYSET(XMDUZ,XMOPT,XMOX,XMDIR) ;
"RTN","XMJMRO",16,0)
 D SET^XMXSEC2("B",37331,.XMOPT,.XMOX) ; Backup to review message
"RTN","XMJMRO",17,0)
 D SET^XMXSEC2("E",37341,.XMOPT,.XMOX) ; Edit Reply
"RTN","XMJMRO",18,0)
 D SET^XMXSEC2("I",37342,.XMOPT,.XMOX) ; Include previous responses in reply
"RTN","XMJMRO",19,0)
 D SET^XMXSEC2("Q",37417,.XMOPT,.XMOX) ; Query
"RTN","XMJMRO",20,0)
 D SET^XMXSEC2("Q xxx",37420.1,.XMOPT,.XMOX) ; Query recipient(s) xxx
"RTN","XMJMRO",21,0)
 D SET^XMXSEC2("QD",37418,.XMOPT,.XMOX) ; Query Detailed
"RTN","XMJMRO",22,0)
 D SET^XMXSEC2("QN",37419,.XMOPT,.XMOX) ; Query Network
"RTN","XMJMRO",23,0)
 D SET^XMXSEC2("T",37334,.XMOPT,.XMOX) ; Transmit now
"RTN","XMJMRO",24,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34067) ; Select Message option:
"RTN","XMJMRO",25,0)
 S XMDIR("B")=XMOX("O","T")_":"_XMOPT("T")
"RTN","XMJMRO",26,0)
 S XMDIR("PRE")="I XMX?1(1"""_XMOX("O","Q")_" "",1"""_$$LOW^XLFSTR(XMOX("O","Q"))_" "",1"""_XMOX("O","QD")_" "",1"""_$$LOW^XLFSTR(XMOX("O","QD"))_" "").E S XMNAME=$P(XMX,"" "",2,99),XMX="""_XMOX("O","QD")_""""
"RTN","XMJMRO",27,0)
 S XMDIR("??")="XM-U-MO-REPLY"
"RTN","XMJMRO",28,0)
 Q
"RTN","XMJMRO",29,0)
B ; Backup to review message
"RTN","XMJMRO",30,0)
 D BACKUP^XMJMP(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",31,0)
 S XMRESP=$P($G(^XMB(3.9,XMZO,1,XMPTR,0)),U,2)
"RTN","XMJMRO",32,0)
 Q
"RTN","XMJMRO",33,0)
E ; Edit msg
"RTN","XMJMRO",34,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT)
"RTN","XMJMRO",35,0)
 Q
"RTN","XMJMRO",36,0)
I ; Include previous response in reply
"RTN","XMJMRO",37,0)
 N XMWHICH,XMNO
"RTN","XMJMRO",38,0)
 S XMNO=0
"RTN","XMJMRO",39,0)
 D WHICH^XMJMC(XMZO,$$EZBLD^DIALOG(34209),.XMWHICH,.XMNO) Q:XMNO  ; include
"RTN","XMJMRO",40,0)
 Q:'$D(XMWHICH)
"RTN","XMJMRO",41,0)
 D COPYTEXT^XMJMR(XMZO,XMZ,XMWHICH)
"RTN","XMJMRO",42,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT)
"RTN","XMJMRO",43,0)
 Q
"RTN","XMJMRO",44,0)
Q ; Query
"RTN","XMJMRO",45,0)
 D Q^XMJMQ(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",46,0)
 Q
"RTN","XMJMRO",47,0)
QD ; Query Detailed
"RTN","XMJMRO",48,0)
 I $D(XMNAME) D QNAMEX^XMJMQ(XMDUZ,XMK,XMKN,XMZO,XMNAME) Q
"RTN","XMJMRO",49,0)
 D QD^XMJMQ(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",50,0)
 Q
"RTN","XMJMRO",51,0)
QN ; Query Network
"RTN","XMJMRO",52,0)
 D QN^XMJMQ(XMDUZ,XMK,XMKN,XMZO)
"RTN","XMJMRO",53,0)
 Q
"RTN","XMJMRO",54,0)
T ; Transmit now
"RTN","XMJMRO",55,0)
 S XMFINISH=1
"RTN","XMJMRO",56,0)
 W $$EZBLD^DIALOG(34216) ; Sending local reply...
"RTN","XMJMRO",57,0)
 D DOREPLY^XMXREPLY(XMDUZ,XMZO,XMZ)
"RTN","XMJMRO",58,0)
 W !,$$EZBLD^DIALOG(34213) ;   Sent
"RTN","XMJMRO",59,0)
 Q
"RTN","XMJMSO")
0^21^B31691805
"RTN","XMJMSO",1,0)
XMJMSO ;ISC-SF/GMB-Options at 'send' transmit prompt ;01/31/2000  13:39
"RTN","XMJMSO",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMJMSO",3,0)
 ; Replaces ^XMA22 (ISC-WASH/CAP/THM)
"RTN","XMJMSO",4,0)
SENDMSG(XMDUZ,XMZ,XMSUBJ,XMINSTR,XMRESTR,XMABORT) ;
"RTN","XMJMSO",5,0)
 N XMFINISH,XMDIR,XMY,XMOPT,XMOX
"RTN","XMJMSO",6,0)
 S XMFINISH=0
"RTN","XMJMSO",7,0)
 F  D  Q:XMFINISH!XMABORT
"RTN","XMJMSO",8,0)
 . D SENDSET(.XMINSTR,.XMOPT,.XMOX,.XMDIR)
"RTN","XMJMSO",9,0)
 . D XMDIR^XMJDIR(.XMDIR,.XMOPT,.XMOX,.XMY,.XMABORT) Q:XMABORT
"RTN","XMJMSO",10,0)
 . K XMDIR,XMOPT,XMOX
"RTN","XMJMSO",11,0)
 . D @XMY
"RTN","XMJMSO",12,0)
 Q
"RTN","XMJMSO",13,0)
SENDSET(XMINSTR,XMOPT,XMOX,XMDIR) ;
"RTN","XMJMSO",14,0)
 D OPTEDIT^XMXSEC2(.XMINSTR,.XMOPT,.XMOX)
"RTN","XMJMSO",15,0)
 D SET^XMXSEC2("B",37331,.XMOPT,.XMOX) ; Backup to review message
"RTN","XMJMSO",16,0)
 D SET^XMXSEC2("ER",37332,.XMOPT,.XMOX) ; Edit Recipients
"RTN","XMJMSO",17,0)
 D SET^XMXSEC2("L",37333,.XMOPT,.XMOX) ; Transmit later
"RTN","XMJMSO",18,0)
 D SET^XMXSEC2("T",37334,.XMOPT,.XMOX) ; Transmit now
"RTN","XMJMSO",19,0)
 I $D(XMOPT("NS","?")),XMOPT("NS","?")=$$EZBLD^DIALOG(37309.1) S XMOPT("NS","?X")="D CRE8NS^XMVVITA"
"RTN","XMJMSO",20,0)
 S XMDIR("A")=$$EZBLD^DIALOG(34067) ; Select Message option:
"RTN","XMJMSO",21,0)
 S XMDIR("B")=XMOX("O","T")_":"_XMOPT("T") ; Transmit now
"RTN","XMJMSO",22,0)
 S XMDIR("??")="XM-U-MO-SEND"
"RTN","XMJMSO",23,0)
 Q
"RTN","XMJMSO",24,0)
B ; Backup to review message
"RTN","XMJMSO",25,0)
 D BACKUP^XMJMP(XMDUZ,0,"",XMZ)
"RTN","XMJMSO",26,0)
 ; OR D PRINTIT^XMJMP1(....)
"RTN","XMJMSO",27,0)
 Q
"RTN","XMJMSO",28,0)
FLAGTOGL(XMINSTR,XMFLAG,XMSET,XMREMOVE) ; Flag Toggle
"RTN","XMJMSO",29,0)
 I $G(XMINSTR("FLAGS"))[XMFLAG D
"RTN","XMJMSO",30,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),XMFLAG)
"RTN","XMJMSO",31,0)
 . W !,$$EZBLD^DIALOG(XMREMOVE)
"RTN","XMJMSO",32,0)
 E  D
"RTN","XMJMSO",33,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_XMFLAG
"RTN","XMJMSO",34,0)
 . W !,$$EZBLD^DIALOG(XMSET)
"RTN","XMJMSO",35,0)
 Q
"RTN","XMJMSO",36,0)
C ; Confidential msg
"RTN","XMJMSO",37,0)
 D FLAGTOGL(.XMINSTR,"C",37301.9,37302.9)
"RTN","XMJMSO",38,0)
 Q
"RTN","XMJMSO",39,0)
D ; Deliver to recipient basket
"RTN","XMJMSO",40,0)
 I $D(XMINSTR("RCPT BSKT")) D  Q
"RTN","XMJMSO",41,0)
 . K XMINSTR("RCPT BSKT")
"RTN","XMJMSO",42,0)
 . W !,$$EZBLD^DIALOG(37304.9) ; Delivery basket removed.
"RTN","XMJMSO",43,0)
 N XMTEXT
"RTN","XMJMSO",44,0)
 W !
"RTN","XMJMSO",45,0)
 D BLD^DIALOG(37303.1,"","","XMTEXT","F")
"RTN","XMJMSO",46,0)
 D MSG^DIALOG("WM","",80,"","XMTEXT")
"RTN","XMJMSO",47,0)
 W !
"RTN","XMJMSO",48,0)
 ;The delivery basket is the basket to which this message should be delivered
"RTN","XMJMSO",49,0)
 ;for all recipients (even future ones, should the message be forwarded).
"RTN","XMJMSO",50,0)
 ;Any message filters, which the recipient might have, are ignored."
"RTN","XMJMSO",51,0)
 ;If the basket does not exist, it will be created."
"RTN","XMJMSO",52,0)
 ;Note: The recipients must have chosen to allow delivery baskets by setting
"RTN","XMJMSO",53,0)
 ;ACCEPT DELIVERY BASKET? under 'Personal Preferences|Delivery Basket Edit'
"RTN","XMJMSO",54,0)
 ;to one of the following:
"RTN","XMJMSO",55,0)
 ; YES    - If basket doesn't exist, create it, and deliver the message to it.
"RTN","XMJMSO",56,0)
 ; EXIST  - If the basket already exists, then deliver the message to it.
"RTN","XMJMSO",57,0)
 ;          Else, just deliver the message as usual.
"RTN","XMJMSO",58,0)
 ; SELECT - If the basket already exists AND accepts such messages,
"RTN","XMJMSO",59,0)
 ;          then deliver the message to it.
"RTN","XMJMSO",60,0)
 ;          Else, just deliver the message as usual.
"RTN","XMJMSO",61,0)
 ;If the recipient has not set this field or has set it to NO, then
"RTN","XMJMSO",62,0)
 ;the message would be delivered as usual.
"RTN","XMJMSO",63,0)
 N XMDIC,XMK,XMKN
"RTN","XMJMSO",64,0)
 S XMDIC("B")="@"
"RTN","XMJMSO",65,0)
 S XMDIC("S")="I Y>1"
"RTN","XMJMSO",66,0)
 D SELBSKT^XMJBU(XMDUZ,$$EZBLD^DIALOG(37303.2),"L",.XMDIC,.XMK,.XMKN) ; Select delivery basket:
"RTN","XMJMSO",67,0)
 Q:XMK=U
"RTN","XMJMSO",68,0)
 S XMINSTR("RCPT BSKT")=XMKN
"RTN","XMJMSO",69,0)
 Q
"RTN","XMJMSO",70,0)
ER ; Additional Recipients
"RTN","XMJMSO",71,0)
 D TOWHOM^XMJMT(XMDUZ,$$EZBLD^DIALOG(34110),.XMINSTR,.XMRESTR,.XMABORT) ; Send
"RTN","XMJMSO",72,0)
 Q
"RTN","XMJMSO",73,0)
ES ; Edit Subject
"RTN","XMJMSO",74,0)
 N XMOLDSUB,XMABORT
"RTN","XMJMSO",75,0)
 S XMOLDSUB=XMSUBJ,XMABORT=0
"RTN","XMJMSO",76,0)
 D SUBJ^XMJMS(.XMSUBJ,.XMABORT) Q:XMABORT
"RTN","XMJMSO",77,0)
 Q:XMSUBJ=XMOLDSUB
"RTN","XMJMSO",78,0)
 N XMFDA
"RTN","XMJMSO",79,0)
 S XMFDA(3.9,XMZ_",",.01)=XMSUBJ
"RTN","XMJMSO",80,0)
 D FILE^DIE("","XMFDA")
"RTN","XMJMSO",81,0)
 Q
"RTN","XMJMSO",82,0)
ET ; Edit msg
"RTN","XMJMSO",83,0)
 I $G(XMPAKMAN) Q:$$NOPAKEDT
"RTN","XMJMSO",84,0)
 D BODY^XMJMS(XMDUZ,XMZ,XMSUBJ,.XMRESTR,.XMABORT)
"RTN","XMJMSO",85,0)
 Q
"RTN","XMJMSO",86,0)
NOPAKEDT() ; Function returns 0 if OK to edit; 1, if not OK.
"RTN","XMJMSO",87,0)
 I $D(XMSECURE) W !,$$EZBLD^DIALOG(37405.4) Q 1  ; You may not edit a secure KIDS or PackMan message.
"RTN","XMJMSO",88,0)
 N DIR,X,Y,DIRUT
"RTN","XMJMSO",89,0)
 W @IOF
"RTN","XMJMSO",90,0)
 N XMTEXT
"RTN","XMJMSO",91,0)
 D BLD^DIALOG(37306.1,"","","XMTEXT","F")
"RTN","XMJMSO",92,0)
 D MSG^DIALOG("WM","",80,"","XMTEXT")
"RTN","XMJMSO",93,0)
 ;                    W A R N I N G
"RTN","XMJMSO",94,0)
 ;  You are about to edit what appears to be a PackMan message.
"RTN","XMJMSO",95,0)
 ;  Please note the following:
"RTN","XMJMSO",96,0)
 ;  1. If you edit this message you may compromise its integrity.
"RTN","XMJMSO",97,0)
 ;  2. If you must edit it,
"RTN","XMJMSO",98,0)
 ;     - Do not edit the code.
"RTN","XMJMSO",99,0)
 ;     - Confine your editing to the text (the lines between $TXT and $ENDTXT).
"RTN","XMJMSO",100,0)
 ;     - You may insert lines in the text.
"RTN","XMJMSO",101,0)
 ;     - Do not begin any line with a '$' (dollar sign).
"RTN","XMJMSO",102,0)
 ;     - Be careful!
"RTN","XMJMSO",103,0)
 S DIR(0)="Y"
"RTN","XMJMSO",104,0)
 S DIR("A")=$$EZBLD^DIALOG(37306.2) ; Are you sure you want to edit this message
"RTN","XMJMSO",105,0)
 S DIR("B")=$$EZBLD^DIALOG(390053) ; NO
"RTN","XMJMSO",106,0)
 D ^DIR
"RTN","XMJMSO",107,0)
 Q 'Y
"RTN","XMJMSO",108,0)
I ; Information only msg
"RTN","XMJMSO",109,0)
 D FLAGTOGL(.XMINSTR,"I",37307.9,37308.9)
"RTN","XMJMSO",110,0)
 Q
"RTN","XMJMSO",111,0)
L ; Transmit Later
"RTN","XMJMSO",112,0)
 N DIR,X,Y,XMWHEN,ZTRTN,ZTDTH,ZTDESC,ZTIO,ZTSAVE,ZTSK,XMROOT,I
"RTN","XMJMSO",113,0)
 S DIR(0)="D^NOW:"_$$SCH^XLFDT("12M",DT)_":ETX"
"RTN","XMJMSO",114,0)
 S DIR("A")=$$EZBLD^DIALOG(37333.1) ; Enter Date@time at which to send this message
"RTN","XMJMSO",115,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMSO",116,0)
 S XMWHEN=Y
"RTN","XMJMSO",117,0)
 W !,$$EZBLD^DIALOG(37333.2) ;  Latering ...
"RTN","XMJMSO",118,0)
 S ZTIO=""
"RTN","XMJMSO",119,0)
 S ZTRTN="LATER^XMXSEND"
"RTN","XMJMSO",120,0)
 S ZTDTH=$$FMTH^XLFDT(XMWHEN)
"RTN","XMJMSO",121,0)
 S ZTDESC=$$EZBLD^DIALOG(39310) ; MailMan: Send Message Later
"RTN","XMJMSO",122,0)
 S XMROOT=$$GET1^DIQ(3.9,XMZ_",",3,"","^TMP(""XM"",$J,""BODY"")")
"RTN","XMJMSO",123,0)
 F I="DUZ","XMDUZ","XMSUBJ","^TMP(""XMY0"",$J,","^TMP(""XM"",$J,""BODY"",","XMINSTR(" S ZTSAVE(I)=""
"RTN","XMJMSO",124,0)
 D ^%ZTLOAD
"RTN","XMJMSO",125,0)
 D HOME^%ZIS
"RTN","XMJMSO",126,0)
 I $D(ZTSK) D
"RTN","XMJMSO",127,0)
 . S XMFINISH=1
"RTN","XMJMSO",128,0)
 . W $$EZBLD^DIALOG(37333.9,ZTSK) ;  Latered (Task #_ZTSK_)
"RTN","XMJMSO",129,0)
 . D KILLMSG^XMXUTIL(XMZ)
"RTN","XMJMSO",130,0)
 . D CLEANUP^XMXADDR
"RTN","XMJMSO",131,0)
 E  D
"RTN","XMJMSO",132,0)
 . W !,*7,$$EZBLD^DIALOG(37333.8) ; Latering was not successful.  Try again or transmit now.
"RTN","XMJMSO",133,0)
 K ^TMP("XM",$J,"BODY")
"RTN","XMJMSO",134,0)
 Q
"RTN","XMJMSO",135,0)
NS ; Add Network Signature
"RTN","XMJMSO",136,0)
 N XMMSG
"RTN","XMJMSO",137,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZ,.XMINSTR,.XMMSG)
"RTN","XMJMSO",138,0)
 W !,XMMSG
"RTN","XMJMSO",139,0)
 Q
"RTN","XMJMSO",140,0)
P ; Priority msg
"RTN","XMJMSO",141,0)
 D FLAGTOGL(.XMINSTR,"P",37311.9,37312.9)
"RTN","XMJMSO",142,0)
 Q
"RTN","XMJMSO",143,0)
R ; Confirm receipt of msg
"RTN","XMJMSO",144,0)
 D FLAGTOGL(.XMINSTR,"R",37313.9,37314.9)
"RTN","XMJMSO",145,0)
 Q
"RTN","XMJMSO",146,0)
S ; Scramble text
"RTN","XMJMSO",147,0)
 I $D(XMINSTR("SCR KEY")) D  Q
"RTN","XMJMSO",148,0)
 . K XMINSTR("SCR KEY"),XMINSTR("SCR HINT")
"RTN","XMJMSO",149,0)
 . W !,$$EZBLD^DIALOG(37316.8) ; Scramble removed
"RTN","XMJMSO",150,0)
 N XMKEY,XMHINT,XMABORT
"RTN","XMJMSO",151,0)
 S XMABORT=0
"RTN","XMJMSO",152,0)
 D CRE8KEY^XMJMCODE(.XMKEY,.XMHINT,.XMABORT)
"RTN","XMJMSO",153,0)
 I XMABORT W !,$$EZBLD^DIALOG(37315.8) Q  ; Scramble aborted.
"RTN","XMJMSO",154,0)
 S XMINSTR("SCR KEY")=XMKEY
"RTN","XMJMSO",155,0)
 S XMINSTR("SCR HINT")=XMHINT
"RTN","XMJMSO",156,0)
 Q
"RTN","XMJMSO",157,0)
T ; Transmit now
"RTN","XMJMSO",158,0)
 S XMFINISH=1
"RTN","XMJMSO",159,0)
 W $$EZBLD^DIALOG(34217,XMZ) ;   Sending [_XMZ_]...
"RTN","XMJMSO",160,0)
 D MOVEPART^XMXSEND(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMSO",161,0)
 D SEND^XMKP(XMDUZ,XMZ,.XMINSTR)
"RTN","XMJMSO",162,0)
 D CHECK^XMKPL
"RTN","XMJMSO",163,0)
 W !,$$EZBLD^DIALOG(34213) ;   Sent"
"RTN","XMJMSO",164,0)
 Q
"RTN","XMJMSO",165,0)
V ; Vaporize date
"RTN","XMJMSO",166,0)
 I $G(XMINSTR("VAPOR")) D  Q
"RTN","XMJMSO",167,0)
 . K XMINSTR("VAPOR")
"RTN","XMJMSO",168,0)
 . W !,$$EZBLD^DIALOG(37318.9) ; Vaporize Date removed
"RTN","XMJMSO",169,0)
 N DIR,X,Y,DIRUT
"RTN","XMJMSO",170,0)
 S DIR(0)="3.9,1.6"
"RTN","XMJMSO",171,0)
 S DIR("A")=$$EZBLD^DIALOG(37317.1) ; Enter Vaporize Date
"RTN","XMJMSO",172,0)
 S DIR("B")=$$MMDT^XMXUTIL1($$FMADD^XLFDT(DT,30))
"RTN","XMJMSO",173,0)
 D ^DIR Q:$D(DIRUT)
"RTN","XMJMSO",174,0)
 S XMINSTR("VAPOR")=Y
"RTN","XMJMSO",175,0)
 Q
"RTN","XMJMSO",176,0)
X ; Closed msg
"RTN","XMJMSO",177,0)
 D FLAGTOGL(.XMINSTR,"X",37319.9,37320.9)
"RTN","XMJMSO",178,0)
 Q
"RTN","XMTDO")
0^37^B3423711
"RTN","XMTDO",1,0)
XMTDO ;ISC-SF/GMB-Deliver other (server,device) ;03/02/2000  15:38
"RTN","XMTDO",2,0)
 ;;7.1;MailMan;**50,107,121,110**;Jun 02, 1994
"RTN","XMTDO",3,0)
 ; Replaces ZSER^, ZDEV^XMS1 (ISC-WASH/THM/CAP)
"RTN","XMTDO",4,0)
SERVER ; S.server TASKMAN ENTRY
"RTN","XMTDO",5,0)
 ; Variables supplied by TaskMan:  XMZ,XMSERVER,XMSVIENS
"RTN","XMTDO",6,0)
 ; XMSERVER  Name of the server option (includes leading S.)
"RTN","XMTDO",7,0)
 N XMZREC,XMFROM,XMSERR,XMSUBJ
"RTN","XMTDO",8,0)
 D DUZ^XUP(.5)
"RTN","XMTDO",9,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0)) I XMZREC="" D  Q
"RTN","XMTDO",10,0)
 . N XMPARM,XMINSTR
"RTN","XMTDO",11,0)
 . S XMINSTR("FROM")=.5
"RTN","XMTDO",12,0)
 . S XMPARM(1)=XMSERVER
"RTN","XMTDO",13,0)
 . S XMPARM(2)=ZTSK
"RTN","XMTDO",14,0)
 . D TASKBULL^XMXBULL(.5,"XM SEND ERR SERVER MSG",.XMPARM,"",.5,.XMINSTR)
"RTN","XMTDO",15,0)
 S XMSUBJ=$P(XMZREC,U,1)
"RTN","XMTDO",16,0)
 S:XMSUBJ["~U~" XMSUB=$$DECODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMTDO",17,0)
 S XMFROM=$P(XMZREC,U,2)
"RTN","XMTDO",18,0)
 S:XMFROM["@" XMFROM=$$REPLYTO1^XMXREPLY(XMZ)
"RTN","XMTDO",19,0)
 D SETSTAT(XMSVIENS,$$EZBLD^DIALOG(39300)) ; Server hand off ready
"RTN","XMTDO",20,0)
 D DOSERV($E(XMSERVER,3,99),XMZ,XMFROM,XMSUBJ,.XMSERR)
"RTN","XMTDO",21,0)
 D SETSTAT(XMSVIENS,$S($D(XMSERR):XMSERR,1:$$EZBLD^DIALOG(39301))) ; Served (hand off done)
"RTN","XMTDO",22,0)
 S ZTREQ="@"
"RTN","XMTDO",23,0)
 Q
"RTN","XMTDO",24,0)
DOSERV(XMXX,XMZ,XMFROM,XMSUBJ,XQSRVOK) ;
"RTN","XMTDO",25,0)
 N XMCHAN,X,XMSEN,XMREC,XMOPEN,XMCLOSE,XMSVIENS
"RTN","XMTDO",26,0)
 S XMCHAN="SERVER"
"RTN","XMTDO",27,0)
 D GET^XML
"RTN","XMTDO",28,0)
 S X=XMXX_U_XMZ_U_XMFROM_U_XMSUBJ
"RTN","XMTDO",29,0)
 D ^XQSRV
"RTN","XMTDO",30,0)
 ; ^XQSRV1 calls SETSB^XMA1C to put the msg in the postmaster's bskt.
"RTN","XMTDO",31,0)
 ; Instead, that line could read:
"RTN","XMTDO",32,0)
 ; D:XQSRV PUTSERV^XMXMSGS1(XQSOP,XQMSG)
"RTN","XMTDO",33,0)
 Q
"RTN","XMTDO",34,0)
DEVICE ; D.device TASKMAN ENTRY
"RTN","XMTDO",35,0)
 ; Variables supplied by TaskMan:  XMDUZ,XMZ,XMDVIENS
"RTN","XMTDO",36,0)
 ; TaskMan opens and closes the device.
"RTN","XMTDO",37,0)
 N XMV
"RTN","XMTDO",38,0)
 I '$G(DUZ) D DUZ^XUP(XMDUZ)
"RTN","XMTDO",39,0)
 D INITAPI^XMVVITAE
"RTN","XMTDO",40,0)
 D PRTMSG^XMJMP(XMDUZ,"?",XMZ,"0-",0,1)
"RTN","XMTDO",41,0)
 D SETSTAT(XMDVIENS,$$EZBLD^DIALOG(39302)) ; Printed
"RTN","XMTDO",42,0)
 S ZTREQ="@"
"RTN","XMTDO",43,0)
 Q
"RTN","XMTDO",44,0)
SETSTAT(XMIENS,XMSTATUS) ; Record Time/Status in msg file
"RTN","XMTDO",45,0)
 N XMFDA
"RTN","XMTDO",46,0)
 S XMFDA(3.91,XMIENS,2)=$$NOW^XLFDT
"RTN","XMTDO",47,0)
 S XMFDA(3.91,XMIENS,5)=XMSTATUS
"RTN","XMTDO",48,0)
 D FILE^DIE("","XMFDA")
"RTN","XMTDO",49,0)
 Q
"RTN","XMVVITA")
0^35^B20731933
"RTN","XMVVITA",1,0)
XMVVITA ;ISC-SF/GMB-Edit User's MailMan Variables ;01/13/2000  14:01
"RTN","XMVVITA",2,0)
 ;;7.1;MailMan;**50,101,110**;Jun 02, 1994
"RTN","XMVVITA",3,0)
 ; Replaces ^XMGAPI1,FWD^XMA21FWD,BANNER^XMA6,EDIT^XMA7 (ISC-WASH/CAP)
"RTN","XMVVITA",4,0)
 ;
"RTN","XMVVITA",5,0)
 ; Entry points used by MailMan options (not covered by DBIA):
"RTN","XMVVITA",6,0)
 ; BANNER   XMBANNER       - Edit user's banner
"RTN","XMVVITA",7,0)
 ; EDIT     XMEDITUSER     - Edit user's preferences
"RTN","XMVVITA",8,0)
 ; FILTER   XM FILTER EDIT - Edit user's message filters
"RTN","XMVVITA",9,0)
 ; BASKET   XM DELIVERY BASKET EDIT - Edit user's delivery basket preferences
"RTN","XMVVITA",10,0)
 ; FORWARD  XMEDITFWD      - Edit user's forwarding address
"RTN","XMVVITA",11,0)
 ; SURR     XMEDITSURR     - Edit user's surrogates
"RTN","XMVVITA",12,0)
FORWARD ; Edit forwarding address
"RTN","XMVVITA",13,0)
 N XMIA
"RTN","XMVVITA",14,0)
 S XMIA=1
"RTN","XMVVITA",15,0)
 N DIE,DA,DR
"RTN","XMVVITA",16,0)
 S DIE=3.7
"RTN","XMVVITA",17,0)
 S DA=DUZ
"RTN","XMVVITA",18,0)
 S DR="2;2.1"
"RTN","XMVVITA",19,0)
 D ^DIE
"RTN","XMVVITA",20,0)
 Q
"RTN","XMVVITA",21,0)
XMFWD(XMADDR,XMIA) ; Serves as input transform for 'forwarding address'
"RTN","XMVVITA",22,0)
 N XMERROR,XMRESTR,XMINSTR,XMFULL
"RTN","XMVVITA",23,0)
 I XMADDR'["@","^D.^d.^S.^s.^"'[(U_$E(XMADDR,1,2)_U) K XMADDR Q
"RTN","XMVVITA",24,0)
 S XMINSTR("ADDR FLAGS")="X" ; do not create ^TMP(, just check.
"RTN","XMVVITA",25,0)
 D ADDRESS^XMXADDR(DUZ,XMADDR,.XMFULL,.XMERROR)
"RTN","XMVVITA",26,0)
 I $D(XMERROR) K XMADDR Q
"RTN","XMVVITA",27,0)
 I XMFULL'["@" D
"RTN","XMVVITA",28,0)
 . ; Remote address is really local.  OK if device or server.
"RTN","XMVVITA",29,0)
 . I "^D.^S.^"[(U_$E(XMFULL,1,2)_U) S XMFULL=XMFULL_"@"_^XMB("NETNAME")
"RTN","XMVVITA",30,0)
 I XMFULL'["@" D  Q
"RTN","XMVVITA",31,0)
 . ; Remote address is really local
"RTN","XMVVITA",32,0)
 . K XMADDR
"RTN","XMVVITA",33,0)
 . D EN^DDIOL("You can't have your mail forwarded to a local address.")
"RTN","XMVVITA",34,0)
 S XMADDR=XMFULL
"RTN","XMVVITA",35,0)
 Q
"RTN","XMVVITA",36,0)
DELFWD(XMUSER,XMFWD,XMERROR) ; Delete a user's invalid forwarding address.
"RTN","XMVVITA",37,0)
 S XMFDA(3.7,XMUSER_",",2)="@"
"RTN","XMVVITA",38,0)
 D FILE^DIE("","XMFDA")
"RTN","XMVVITA",39,0)
 N XMPARM,XMINSTR
"RTN","XMVVITA",40,0)
 S XMINSTR("FROM")=.5
"RTN","XMVVITA",41,0)
 S XMPARM(1)=XMFWD,XMPARM(2)=XMERROR
"RTN","XMVVITA",42,0)
 D TASKBULL^XMXBULL(.5,"XM FWD ADDRESS DELETE",.XMPARM,"",XMUSER,.XMINSTR)
"RTN","XMVVITA",43,0)
 Q
"RTN","XMVVITA",44,0)
BANNER ; Edit banner
"RTN","XMVVITA",45,0)
 N DIE,DA,DR
"RTN","XMVVITA",46,0)
 S DIE=3.7
"RTN","XMVVITA",47,0)
 S (XMDUZ,DA)=$G(XMDUZ,DUZ)
"RTN","XMVVITA",48,0)
 S DR=4
"RTN","XMVVITA",49,0)
 D ^DIE
"RTN","XMVVITA",50,0)
 D SETBAN^XMVVITAE(XMDUZ,.XMV)
"RTN","XMVVITA",51,0)
 Q
"RTN","XMVVITA",52,0)
FILTER ; Edit filters
"RTN","XMVVITA",53,0)
 N DIE,DA,DR
"RTN","XMVVITA",54,0)
 S DIE=3.7
"RTN","XMVVITA",55,0)
 S DA=DUZ
"RTN","XMVVITA",56,0)
 S DR="16;15"     ; Message filters flag ; Message filters
"RTN","XMVVITA",57,0)
 D ^DIE
"RTN","XMVVITA",58,0)
 Q:$D(^XMB(3.7,DUZ,15,"AF"))
"RTN","XMVVITA",59,0)
 W !,*7,"Note that you have no active filters."
"RTN","XMVVITA",60,0)
 Q
"RTN","XMVVITA",61,0)
BASKET ; Edit delivery baskets
"RTN","XMVVITA",62,0)
 N DIE,DA,DR
"RTN","XMVVITA",63,0)
 S DIE=3.7
"RTN","XMVVITA",64,0)
 S DA=DUZ
"RTN","XMVVITA",65,0)
 S DR="16.2;S:X'=""S"" Y=0;1"     ; Accept delivery basket? ; Select basket.
"RTN","XMVVITA",66,0)
 S DR(2,3.701)="3" ; Is this a delivery basket?
"RTN","XMVVITA",67,0)
 D ^DIE
"RTN","XMVVITA",68,0)
 Q
"RTN","XMVVITA",69,0)
SURR ; Edit Surrogates
"RTN","XMVVITA",70,0)
 N DIE,DA,DR
"RTN","XMVVITA",71,0)
 S DIE="^XMB(3.7,"
"RTN","XMVVITA",72,0)
 S DA=DUZ
"RTN","XMVVITA",73,0)
 S DR="8"         ; surrogate
"RTN","XMVVITA",74,0)
 D ^DIE
"RTN","XMVVITA",75,0)
 Q
"RTN","XMVVITA",76,0)
EDIT ; Edit User Preferences
"RTN","XMVVITA",77,0)
 N DIE,DA,DR
"RTN","XMVVITA",78,0)
 D CHECK^XMVVITAE
"RTN","XMVVITA",79,0)
 W !!,"Editing data in the MAILBOX file:"
"RTN","XMVVITA",80,0)
 S DIE="^XMB(3.7,"
"RTN","XMVVITA",81,0)
 S DA=DUZ
"RTN","XMVVITA",82,0)
 S DR=""
"RTN","XMVVITA",83,0)
 S DR=DR_";4"         ; banner
"RTN","XMVVITA",84,0)
 S DR=DR_";17"        ; message display order
"RTN","XMVVITA",85,0)
 S DR=DR_";18"        ; message reader default
"RTN","XMVVITA",86,0)
 S DR=DR_";19"        ; message reader prompt
"RTN","XMVVITA",87,0)
 S DR=DR_";6"         ; show message preview
"RTN","XMVVITA",88,0)
 S DR=DR_";11"        ; message action default
"RTN","XMVVITA",89,0)
 S DR=DR_";12"        ; ask basket
"RTN","XMVVITA",90,0)
 S DR=DR_";13"        ; show titles
"RTN","XMVVITA",91,0)
 S DR=DR_";14"        ; priority responses flag
"RTN","XMVVITA",92,0)
 S DR=DR_";14.1"      ; priority responses prompt
"RTN","XMVVITA",93,0)
 S DR=DR_";16.3"      ; p-message queued from
"RTN","XMVVITA",94,0)
 S DR=DR_";9"         ; mailman institution
"RTN","XMVVITA",95,0)
 S DR=DR_";2.21:2.23" ; network signature lines
"RTN","XMVVITA",96,0)
 S DR=DR_";4.5"       ; introduction
"RTN","XMVVITA",97,0)
 S DR=$E(DR,2,99)
"RTN","XMVVITA",98,0)
 D ^DIE
"RTN","XMVVITA",99,0)
 W !!,"Editing data in the NEW PERSON file:"
"RTN","XMVVITA",100,0)
 S DIE="^VA(200,"
"RTN","XMVVITA",101,0)
 S DA=DUZ
"RTN","XMVVITA",102,0)
 S DR=""
"RTN","XMVVITA",103,0)
 S DR=DR_";31.3"      ; preferred editor
"RTN","XMVVITA",104,0)
 S DR=DR_";.111"      ; street address 1
"RTN","XMVVITA",105,0)
 S DR=DR_";.112"      ; street address 2
"RTN","XMVVITA",106,0)
 S DR=DR_";.113"      ; street address 3
"RTN","XMVVITA",107,0)
 S DR=DR_";.114"      ; city
"RTN","XMVVITA",108,0)
 S DR=DR_";.115"      ; state
"RTN","XMVVITA",109,0)
 S DR=DR_";.116"      ; zip
"RTN","XMVVITA",110,0)
 S DR=DR_";.132"      ; office phone
"RTN","XMVVITA",111,0)
 S DR=DR_";.136"      ; fax #
"RTN","XMVVITA",112,0)
 S DR=DR_";.137"      ; voice pager
"RTN","XMVVITA",113,0)
 S DR=DR_";.138"      ; digital pager
"RTN","XMVVITA",114,0)
 S DR=DR_";.133ADD'L PHONE 1"      ; phone #3
"RTN","XMVVITA",115,0)
 S DR=DR_";.134ADD'L PHONE 2"      ; phone #4
"RTN","XMVVITA",116,0)
 S DR=$E(DR,2,99)
"RTN","XMVVITA",117,0)
 D ^DIE
"RTN","XMVVITA",118,0)
 D PREFER^XMVVITAE(DUZ,.XMV,.XMDISPI)
"RTN","XMVVITA",119,0)
 D SETBAN^XMVVITAE(XMDUZ,.XMV)
"RTN","XMVVITA",120,0)
 D SETNET^XMVVITAE(XMDUZ,.XMV)
"RTN","XMVVITA",121,0)
 Q
"RTN","XMVVITA",122,0)
GOTNS(XMDUZ) ; Function: Does the user have a network signature? (1=yes; 0=no)
"RTN","XMVVITA",123,0)
 Q "^^"'[$G(^XMB(3.7,XMDUZ,"NS1"))
"RTN","XMVVITA",124,0)
CRE8NS ; The user does not have a network signature.
"RTN","XMVVITA",125,0)
 ; Does the user want to create a network signature now?
"RTN","XMVVITA",126,0)
 ; If the user creates one, routine sets $T to true; else false
"RTN","XMVVITA",127,0)
 N DIR,X,Y
"RTN","XMVVITA",128,0)
 S DIR(0)="Y",DIR("B")=$$EZBLD^DIALOG(39054)
"RTN","XMVVITA",129,0)
 S DIR("A")=$$EZBLD^DIALOG(37309.5) ; Would you like to create a Network Signature now
"RTN","XMVVITA",130,0)
 D ^DIR
"RTN","XMVVITA",131,0)
 I Y D  I $$GOTNS(DUZ)
"RTN","XMVVITA",132,0)
 . K DIR
"RTN","XMVVITA",133,0)
 . D EDITNS
"RTN","XMVVITA",134,0)
 Q
"RTN","XMVVITA",135,0)
EDITNS ; Edit network signature
"RTN","XMVVITA",136,0)
 N DIE,DA,DR
"RTN","XMVVITA",137,0)
 S DIE="^XMB(3.7,",DA=DUZ,DR="2.21:2.23" D ^DIE
"RTN","XMVVITA",138,0)
 Q
"RTN","XMXANSER")
0^32^B5554926
"RTN","XMXANSER",1,0)
XMXANSER ;ISC-SF/GMB-Answer a msg ;01/10/2000  08:18
"RTN","XMXANSER",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMXANSER",3,0)
 ; Replaces ^XMA11A (ISC-WASH/CAP/THM)
"RTN","XMXANSER",4,0)
 ; XMDUZ             DUZ of who the msg is from
"RTN","XMXANSER",5,0)
 ; XMSUBJ            Subject of the msg (defaults to 'Re:' original subject)
"RTN","XMXANSER",6,0)
 ; XMBODY            Closed root of Body of the msg
"RTN","XMXANSER",7,0)
 ;                   Must be closed root, passed by value.  See WP_ROOT
"RTN","XMXANSER",8,0)
 ;                   definition for WP^DIE(), FM word processing filer.
"RTN","XMXANSER",9,0)
 ; XMTO              Additional addressees, besides msg originator
"RTN","XMXANSER",10,0)
 ; XMINSTR("FROM")   String saying from whom (default is user)
"RTN","XMXANSER",11,0)
 ; XMINSTR("SELF BSKT") Basket to deliver to if sender is recipient
"RTN","XMXANSER",12,0)
 ; XMINSTR("SHARE BSKT") Basket to deliver to if recipient is "SHARED,MAIL"
"RTN","XMXANSER",13,0)
 ; XMINSTR("SHARE DATE") Delete date if recipient is "SHARED,MAIL"
"RTN","XMXANSER",14,0)
 ; XMINSTR("RCPT BSKT") Basket name (only) to deliver to for other recipients
"RTN","XMXANSER",15,0)
 ; XMINSTR("VAPOR")  Date on which to vaporize (delete) this message
"RTN","XMXANSER",16,0)
 ;                   from recipient baskets
"RTN","XMXANSER",17,0)
 ; XMINSTR("LATER")  Date on which to send this msg, if not now
"RTN","XMXANSER",18,0)
 ; XMINSTR("FLAGS")  Any or all of the following:
"RTN","XMXANSER",19,0)
 ;                   P Priority
"RTN","XMXANSER",20,0)
 ;                   I Information only (may not be replied to)
"RTN","XMXANSER",21,0)
 ;                   X Closed msg (may not be forwarded)
"RTN","XMXANSER",22,0)
 ;                   C Confidential (surrogates may not read)
"RTN","XMXANSER",23,0)
 ;                   S Send to sender (make sender a recipient)
"RTN","XMXANSER",24,0)
 ;                   R Confirm receipt
"RTN","XMXANSER",25,0)
 ; XMINSTR("SCR KEY")   Scramble key (implies that msg should be scrambled)
"RTN","XMXANSER",26,0)
 ; XMINSTR("SCR HINT")  Hint (to guess the scramble key)
"RTN","XMXANSER",27,0)
 ; XMINSTR("KEYS")   List of keys needed by recipient to read msg (NOT IMPLEMENTED)
"RTN","XMXANSER",28,0)
 ; XMINSTR("TYPE")   Msg type is one of the following:
"RTN","XMXANSER",29,0)
 ;                   D Document
"RTN","XMXANSER",30,0)
 ;                   S Spooled Document
"RTN","XMXANSER",31,0)
 ;                   X DIFROM
"RTN","XMXANSER",32,0)
 ;                   O ODIF
"RTN","XMXANSER",33,0)
 ;                   B BLOB
"RTN","XMXANSER",34,0)
 ;                   K KIDS
"RTN","XMXANSER",35,0)
 ;
"RTN","XMXANSER",36,0)
 ; Output:
"RTN","XMXANSER",37,0)
 ; XMZR              The number of the message containing the answer.
"RTN","XMXANSER",38,0)
ANSRMSG(XMDUZ,XMK,XMKZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMZR) ;
"RTN","XMXANSER",39,0)
 N XMZ,XMZREC,XMZSENDR
"RTN","XMXANSER",40,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXANSER",41,0)
 D CHKMSG^XMXSEC1(XMDUZ,.XMK,.XMKZ,.XMZ,.XMZREC) Q:$D(XMERR)
"RTN","XMXANSER",42,0)
 Q:'$$ANSWER^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXANSER",43,0)
 S:$G(XMSUBJ)="" XMSUBJ=$E($$EZBLD^DIALOG(37006)_$P(XMZREC,U,1),1,65) ; Re:
"RTN","XMXANSER",44,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZR) Q:$D(XMERR)
"RTN","XMXANSER",45,0)
 S XMZSENDR=$P(XMZREC,U,2)
"RTN","XMXANSER",46,0)
 S:XMZSENDR["@" XMZSENDR=$$REPLYTO1^XMXREPLY(XMZ)
"RTN","XMXANSER",47,0)
 D COMPOSE(XMDUZ,XMZ,$P(XMZREC,U,1),XMZSENDR,$P(XMZREC,U,3),XMZR,XMBODY)
"RTN","XMXANSER",48,0)
 S XMTO(XMZSENDR)=""
"RTN","XMXANSER",49,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZR,.XMTO,.XMINSTR)
"RTN","XMXANSER",50,0)
 Q
"RTN","XMXANSER",51,0)
COMPOSE(XMDUZ,XMZ,XMZSUBJ,XMZSENDR,XMZDATE,XMZR,XMBODY) ;
"RTN","XMXANSER",52,0)
 D COPY(XMZ,XMZSUBJ,XMZSENDR,XMZDATE,XMZR)
"RTN","XMXANSER",53,0)
 ; File XMBODY, with the "append" option
"RTN","XMXANSER",54,0)
 D MOVEBODY^XMXSEND(XMZR,XMBODY,"A") ; Put the msg body in place
"RTN","XMXANSER",55,0)
 D NETSIG^XMXEDIT(XMDUZ,XMZR)
"RTN","XMXANSER",56,0)
 Q
"RTN","XMXANSER",57,0)
COPY(XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ) ; Copy the original msg, putting ">" in front of each line.
"RTN","XMXANSER",58,0)
 N I,J
"RTN","XMXANSER",59,0)
 D COPYHEAD^XMJMC(XMZO,XMZOSUBJ,XMZOFROM,XMZODATE,XMZ,"A",.J)
"RTN","XMXANSER",60,0)
 S J=J+1,^XMB(3.9,XMZ,2,J,0)=">"
"RTN","XMXANSER",61,0)
 S I=.999999
"RTN","XMXANSER",62,0)
 F  S I=$O(^XMB(3.9,XMZO,2,I)) Q:I=""  S J=J+1,^XMB(3.9,XMZ,2,J,0)=$E(">"_^(I,0),1,254)
"RTN","XMXANSER",63,0)
 S J=J+1,^XMB(3.9,XMZ,2,J,0)=""
"RTN","XMXANSER",64,0)
 S J=J+1,^XMB(3.9,XMZ,2,J,0)=""
"RTN","XMXANSER",65,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_J_U_J_U_DT
"RTN","XMXANSER",66,0)
 Q
"RTN","XMXAPI")
0^18^B36076134
"RTN","XMXAPI",1,0)
XMXAPI ;ISC-SF/GMB- APIs ;02/28/2000  06:49
"RTN","XMXAPI",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMXAPI",3,0)
 ; All entry points covered by DBIA 2729.
"RTN","XMXAPI",4,0)
 ; Variables input:
"RTN","XMXAPI",5,0)
 ; XMATTACH  Imaging system BLOB attachment array
"RTN","XMXAPI",6,0)
 ; XMBODY    Message text (MUST NOT BE "XMBODY")
"RTN","XMXAPI",7,0)
 ;              (must be closed root, passed by value.  See WP_ROOT
"RTN","XMXAPI",8,0)
 ;               definition for WP^DIE(), FM word processing filer)
"RTN","XMXAPI",9,0)
 ; XMDUZ     User's DUZ, or enough of user's name for a positive ID
"RTN","XMXAPI",10,0)
 ;              eg: 1301 or "lastname,firs"
"RTN","XMXAPI",11,0)
 ; XMK       Basket number, or enough of a name for a positive ID
"RTN","XMXAPI",12,0)
 ;              eg: 1 or "IN"
"RTN","XMXAPI",13,0)
 ; XMKZ      Message number in basket XMK
"RTN","XMXAPI",14,0)
 ;           OR
"RTN","XMXAPI",15,0)
 ;           if $G(XMK)="", Message number in ^XMB(3.9
"RTN","XMXAPI",16,0)
 ; XMKZA     Message number list or list array in basket XMK
"RTN","XMXAPI",17,0)
 ;              eg: "1,3,5-7" or ARRAY("1,3")=""
"RTN","XMXAPI",18,0)
 ;                               ARRAY("5-7")=""
"RTN","XMXAPI",19,0)
 ;              (list may end in comma)
"RTN","XMXAPI",20,0)
 ;              (ARRAY must be passed by reference)
"RTN","XMXAPI",21,0)
 ;           OR
"RTN","XMXAPI",22,0)
 ;           if $G(XMK)="", Message number list or list array in ^XMB(3.9
"RTN","XMXAPI",23,0)
 ;              (same rules, but number ranges are NOT allowed)
"RTN","XMXAPI",24,0)
 ; XMSUBJ    Message subject
"RTN","XMXAPI",25,0)
 ; XMTO      Addressee or addressee array
"RTN","XMXAPI",26,0)
 ;              (array must be passed by reference)
"RTN","XMXAPI",27,0)
 ;           User's DUZ, or enough of user's name for a positive ID
"RTN","XMXAPI",28,0)
 ;              eg: 1301 or "lastname,firs" or ARRAY(1301)=""
"RTN","XMXAPI",29,0)
 ;                                             ARRAY("lastname,firs")=""
"RTN","XMXAPI",30,0)
 ;           G.group name (enough for positive ID)
"RTN","XMXAPI",31,0)
 ;           S.server name (enough for positive ID)
"RTN","XMXAPI",32,0)
 ;           D.device name (enough for positive ID)
"RTN","XMXAPI",33,0)
 ;           prefix above (except devices and servers) by:
"RTN","XMXAPI",34,0)
 ;              I: for 'information only' recipient (may not reply)
"RTN","XMXAPI",35,0)
 ;                 eg: "I:1301" or "I:lastname,firs"
"RTN","XMXAPI",36,0)
 ;              C: for 'copy' recipient (not expected to reply)
"RTN","XMXAPI",37,0)
 ;                 eg: "C:1301" or "C:lastname,firs"
"RTN","XMXAPI",38,0)
 ;              L@datetime: for when (in future) to send to this recipient
"RTN","XMXAPI",39,0)
 ;                 (datetime may be anything accepted by FM)
"RTN","XMXAPI",40,0)
 ;                 eg: "L@25 DEC@0500:1301" or "L@1 JAN:lastname,firs"
"RTN","XMXAPI",41,0)
 ;                     or "L@2981225.05:1301"
"RTN","XMXAPI",42,0)
 ;              (may combine IL@datetime:  or  CL@datetime:)
"RTN","XMXAPI",43,0)
 ;           To delete recipient, prefix by -
"RTN","XMXAPI",44,0)
 ;                 eg: -1301 or "-lastname,firs"
"RTN","XMXAPI",45,0)
 ; XMZ       message number in ^XMB(3.9,
"RTN","XMXAPI",46,0)
 ;
"RTN","XMXAPI",47,0)
 ; Variables output (must be passed by reference):
"RTN","XMXAPI",48,0)
 ; XMFULL    expanded address of last addressee
"RTN","XMXAPI",49,0)
 ; XMMSG     simple message telling how many messages were acted on
"RTN","XMXAPI",50,0)
 ; XMZ       message number created in ^XMB(3.9,
"RTN","XMXAPI",51,0)
 ;
"RTN","XMXAPI",52,0)
 ; Errors
"RTN","XMXAPI",53,0)
 ; XMERR     if there's any errors, then XMERR is set to the number of
"RTN","XMXAPI",54,0)
 ;           errors, otherwise XMERR is undefined.
"RTN","XMXAPI",55,0)
 ;           ^TMP("XMERR",$J,error number,"TEXT",line number)=error text
"RTN","XMXAPI",56,0)
ANSRMSG(XMDUZ,XMK,XMKZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMZR) ; Answer a msg (Send new msg with copy of original msg inside)
"RTN","XMXAPI",57,0)
 ; In:  User, basket, msg #
"RTN","XMXAPI",58,0)
 ; Out: XMZR (message number of answer)
"RTN","XMXAPI",59,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",60,0)
 D ANSRMSG^XMXPARM(.XMDUZ,.XMK,.XMKZ,.XMSUBJ,.XMBODY,.XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",61,0)
 D ANSRMSG^XMXANSER(XMDUZ,.XMK,XMKZ,.XMSUBJ,XMBODY,.XMTO,.XMINSTR,.XMZR)
"RTN","XMXAPI",62,0)
 Q
"RTN","XMXAPI",63,0)
DELMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Delete msgs from a basket
"RTN","XMXAPI",64,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",65,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",66,0)
 D DELMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",67,0)
 Q
"RTN","XMXAPI",68,0)
FLTRMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Filters msgs in a basket
"RTN","XMXAPI",69,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",70,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",71,0)
 D FLTRMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",72,0)
 Q
"RTN","XMXAPI",73,0)
FWDMSG(XMDUZ,XMK,XMKZA,XMTO,XMINSTR,XMMSG) ; Forward msgs
"RTN","XMXAPI",74,0)
 ; XMINSTR("SHARE DATE")
"RTN","XMXAPI",75,0)
 ; XMINSTR("SHARE BSKT")
"RTN","XMXAPI",76,0)
 ; XMINSTR("SELF BSKT")
"RTN","XMXAPI",77,0)
 ; XMINSTR("FWD BY") substitute any string instead of XMDUZ name
"RTN","XMXAPI",78,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",79,0)
 D FWDMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",80,0)
 D FWDMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMTO,.XMINSTR,.XMMSG)
"RTN","XMXAPI",81,0)
 Q
"RTN","XMXAPI",82,0)
LATERMSG(XMDUZ,XMK,XMKZA,XMINSTR,XMMSG) ; Later msgs
"RTN","XMXAPI",83,0)
 ; XMINSTR("LATER")
"RTN","XMXAPI",84,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",85,0)
 D LATERMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",86,0)
 D LATERMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXAPI",87,0)
 Q
"RTN","XMXAPI",88,0)
MOVEMSG(XMDUZ,XMK,XMKZA,XMKTO,XMMSG) ; Move msgs from one basket to another
"RTN","XMXAPI",89,0)
 ; XMKTO   Basket number, or enough of a name for a positive ID.
"RTN","XMXAPI",90,0)
 ;         Identifies basket to move to
"RTN","XMXAPI",91,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",92,0)
 D MOVEMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMKTO) Q:$D(XMERR)
"RTN","XMXAPI",93,0)
 D MOVEMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,XMKTO,.XMMSG)
"RTN","XMXAPI",94,0)
 Q
"RTN","XMXAPI",95,0)
NTOGLMSG(XMDUZ,XMK,XMKZA,XMMSG) ; New Toggle msgs
"RTN","XMXAPI",96,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",97,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",98,0)
 D NTOGLMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",99,0)
 Q
"RTN","XMXAPI",100,0)
PRTMSG(XMDUZ,XMK,XMKZA,XMPRTTO,XMINSTR,XMMSG,XMTASK,XMSUBJ,XMTO) ; Print msgs
"RTN","XMXAPI",101,0)
 ; XMINSTR("HDR"), "RESPS", "RECIPS", "WHEN"
"RTN","XMXAPI",102,0)
 ; XMPRTTO Printer name
"RTN","XMXAPI",103,0)
 ; XMSUBJ & XMTO used only if XMPRTTO is a P-MESSAGE device.  Even then, they're optional.
"RTN","XMXAPI",104,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",105,0)
 D PRTMSG^XMXPARM(.XMDUZ,.XMK,.XMKZA,.XMPRTTO,.XMINSTR,.XMSUBJ,.XMTO) Q:$D(XMERR)
"RTN","XMXAPI",106,0)
 D PRTMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,XMPRTTO,.XMINSTR,.XMMSG,.XMTASK,.XMSUBJ,.XMTO)
"RTN","XMXAPI",107,0)
 Q
"RTN","XMXAPI",108,0)
PUTSERV(XMKN,XMZ) ; Put a message in a server basket
"RTN","XMXAPI",109,0)
 ; XMKN   full server name, including "S."
"RTN","XMXAPI",110,0)
 D SERV^XMXPARMB(.XMKN,.XMZ) Q:$D(XMERR)
"RTN","XMXAPI",111,0)
 D PUTSERV^XMXMSGS1(XMKN,XMZ)
"RTN","XMXAPI",112,0)
 Q
"RTN","XMXAPI",113,0)
REPLYMSG(XMDUZ,XMK,XMKZ,XMBODY,XMINSTR,XMZR) ; Reply to msg (Attach reply to original msg)
"RTN","XMXAPI",114,0)
 ; XMINSTR("NET REPLY") 1=send over the network; 0=don't (default)
"RTN","XMXAPI",115,0)
 ; XMINSTR("NET SUBJ")  Network Reply subject (see XMSUBJ)
"RTN","XMXAPI",116,0)
 ; Out: XMZR (message number of answer)
"RTN","XMXAPI",117,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",118,0)
 D REPLYMSG^XMXPARM(.XMDUZ,.XMK,.XMKZ,.XMBODY,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",119,0)
 D REPLYMSG^XMXREPLY(XMDUZ,.XMK,XMKZ,XMBODY,.XMINSTR,.XMZR)
"RTN","XMXAPI",120,0)
 Q
"RTN","XMXAPI",121,0)
SENDBULL(XMDUZ,XMBN,XMPARM,XMBODY,XMTO,XMINSTR,XMZ,XMATTACH) ; Send a bulletin (returns XMZ)
"RTN","XMXAPI",122,0)
 ; In:  User, bulletin name, bulletin parameters, add'l text,
"RTN","XMXAPI",123,0)
 ;      add'l recipients, send now or later (when?), opt'l BLOB
"RTN","XMXAPI",124,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",125,0)
 D BULLETIN^XMXPARM(.XMDUZ,.XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMATTACH) Q:$D(XMERR)
"RTN","XMXAPI",126,0)
 D SENDBULL^XMXBULL(XMDUZ,XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMZ,.XMATTACH)
"RTN","XMXAPI",127,0)
 Q
"RTN","XMXAPI",128,0)
SENDMSG(XMDUZ,XMSUBJ,XMBODY,XMTO,XMINSTR,XMZ,XMATTACH) ; Send a msg
"RTN","XMXAPI",129,0)
 ; In:  User, basket (if you are recipient), all msg parts,
"RTN","XMXAPI",130,0)
 ;      priority?, closed?, (info?,cc?), send now or later (when?),
"RTN","XMXAPI",131,0)
 ;      (KIDS,MIME,text,PackMan), delete date (if to shared,mail)
"RTN","XMXAPI",132,0)
 ; XMINSTR("RCPT BSKT")
"RTN","XMXAPI",133,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",134,0)
 D SENDMSG^XMXPARM(.XMDUZ,.XMSUBJ,.XMBODY,.XMTO,.XMINSTR,.XMATTACH) Q:$D(XMERR)
"RTN","XMXAPI",135,0)
 D SENDMSG^XMXSEND(XMDUZ,XMSUBJ,XMBODY,.XMTO,.XMINSTR,.XMZ,.XMATTACH)
"RTN","XMXAPI",136,0)
 Q
"RTN","XMXAPI",137,0)
TASKBULL(XMDUZ,XMBN,XMPARM,XMBODY,XMTO,XMINSTR,XMTASK,XMATTACH) ; Send a bulletin (Task it - does not return XMZ)
"RTN","XMXAPI",138,0)
 ; XMBN     Bulletin name (must be full name)
"RTN","XMXAPI",139,0)
 ; XMPARM   Array of parameters necessary for bulletin
"RTN","XMXAPI",140,0)
 ;             ARRAY(1)="parameter 1"
"RTN","XMXAPI",141,0)
 ;             ARRAY(2)="parameter 2"
"RTN","XMXAPI",142,0)
 ; XMBODY   Additional text to append to the bulletin text
"RTN","XMXAPI",143,0)
 ;              (must be closed root, passed by value.  See WP_ROOT
"RTN","XMXAPI",144,0)
 ;               definition for WP^DIE(), FM word processing filer)
"RTN","XMXAPI",145,0)
 ; XMTO     Additional addressee(s)
"RTN","XMXAPI",146,0)
 ; XMINSTR("SELF BSKT")
"RTN","XMXAPI",147,0)
 ;  ***ETC.***
"RTN","XMXAPI",148,0)
 ; In:  User, bulletin name, bulletin parameters, add'l text,
"RTN","XMXAPI",149,0)
 ;      add'l recipients, send now or later (when?), opt'l BLOB
"RTN","XMXAPI",150,0)
 ; Out: XMTASK (task number)
"RTN","XMXAPI",151,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",152,0)
 D BULLETIN^XMXPARM(.XMDUZ,.XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMATTACH) Q:$D(XMERR)
"RTN","XMXAPI",153,0)
 D TASKBULL^XMXBULL(XMDUZ,XMBN,.XMPARM,.XMBODY,.XMTO,.XMINSTR,.XMTASK,.XMATTACH)
"RTN","XMXAPI",154,0)
 Q
"RTN","XMXAPI",155,0)
TERMMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Terminate msgs
"RTN","XMXAPI",156,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",157,0)
 D ACTMSGS^XMXPARM(.XMDUZ,.XMK,.XMKZA) Q:$D(XMERR)
"RTN","XMXAPI",158,0)
 D TERMMSG^XMXMSGS(XMDUZ,.XMK,.XMKZA,.XMMSG)
"RTN","XMXAPI",159,0)
 Q
"RTN","XMXAPI",160,0)
ZAPSERV(XMKN,XMZ) ; Delete a message from a server basket
"RTN","XMXAPI",161,0)
 ; XMKN   full server name, including "S."
"RTN","XMXAPI",162,0)
 D SERV^XMXPARMB(.XMKN,.XMZ) Q:$D(XMERR)
"RTN","XMXAPI",163,0)
 D ZAPSERV^XMXMSGS1(XMKN,XMZ)
"RTN","XMXAPI",164,0)
 Q
"RTN","XMXAPI",165,0)
 ; ***** other actions
"RTN","XMXAPI",166,0)
ADDRNSND(XMDUZ,XMZ,XMTO,XMINSTR) ; Build a message part 2 (address and send)
"RTN","XMXAPI",167,0)
 ; XMZ (in)
"RTN","XMXAPI",168,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",169,0)
 D ADDRNSND^XMXPARM(.XMDUZ,.XMZ,.XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",170,0)
 D ADDRNSND^XMXSEND(XMDUZ,XMZ,.XMTO,.XMINSTR)
"RTN","XMXAPI",171,0)
 Q
"RTN","XMXAPI",172,0)
CRE8XMZ(XMSUBJ,XMZ) ; Build a message part 1 (create)
"RTN","XMXAPI",173,0)
 ; In:  subject
"RTN","XMXAPI",174,0)
 ; Out: XMZ
"RTN","XMXAPI",175,0)
 D VSUBJ^XMXPARM(.XMSUBJ) Q:$D(XMERR)
"RTN","XMXAPI",176,0)
 D CRE8XMZ^XMXSEND(XMSUBJ,.XMZ)
"RTN","XMXAPI",177,0)
 Q
"RTN","XMXAPI",178,0)
TOWHOM(XMDUZ,XMZ,XMTYPE,XMTO,XMINSTR,XMFULL) ; Check ONE msg addressee
"RTN","XMXAPI",179,0)
 ; XMFULL   Expanded address of the addressee
"RTN","XMXAPI",180,0)
 I '$D(XMV) N XMV,XMDISPI,XMDUN,XMNOSEND,XMPRIV
"RTN","XMXAPI",181,0)
 D TOWHOM^XMXPARM(.XMDUZ,.XMZ,.XMTYPE,XMTO,.XMINSTR) Q:$D(XMERR)
"RTN","XMXAPI",182,0)
 D TOWHOM^XMXTO(XMDUZ,.XMZ,XMTYPE,XMTO,.XMINSTR,.XMFULL)
"RTN","XMXAPI",183,0)
 Q
"RTN","XMXAPI",184,0)
VSUBJ(XMSUBJ) ; Validate a subject
"RTN","XMXAPI",185,0)
 D VSUBJ^XMXPARM(.XMSUBJ)
"RTN","XMXAPI",186,0)
 Q
"RTN","XMXEDIT")
0^23^B25336057
"RTN","XMXEDIT",1,0)
XMXEDIT ;ISC-SF/GMB-Edit msg that user has sent to self ;01/06/2000  08:42
"RTN","XMXEDIT",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMXEDIT",3,0)
 ; All entry points covered by DBIA 2730.
"RTN","XMXEDIT",4,0)
 ; These entry points edit a message.  They do not perform any checks to
"RTN","XMXEDIT",5,0)
 ; see whether it is appropriate to do so.  That is the responsibility
"RTN","XMXEDIT",6,0)
 ; of the calling routine.
"RTN","XMXEDIT",7,0)
 ; For these entry points, it is expected that:
"RTN","XMXEDIT",8,0)
 ; OPTMSG^XMXSEC2  has been called and has given its permission to
"RTN","XMXEDIT",9,0)
 ;                 edit the message or to toggle information only.
"RTN","XMXEDIT",10,0)
 ; OPTEDIT^XMXSEC2 has been called and has given its permission to
"RTN","XMXEDIT",11,0)
 ;                 edit the particular thing we are editing here.
"RTN","XMXEDIT",12,0)
 ; INMSG2^XMXUTIL2 has been called to set XMINSTR.  These routines expect
"RTN","XMXEDIT",13,0)
 ;                 that XMINSTR has been correctly set.  They will change
"RTN","XMXEDIT",14,0)
 ;                 XMINSTR according to the edit.
"RTN","XMXEDIT",15,0)
CLOSED(XMZ,XMINSTR,XMMSG) ; Toggle Closed msg
"RTN","XMXEDIT",16,0)
 I $D(^TMP("XMY",$J,.6)) D ERRSET^XMXUTIL(37320.6) Q  ; Messages addressed to SHARED,MAIL may not be closed
"RTN","XMXEDIT",17,0)
 D FLAGTOGL(XMZ,1.95,.XMINSTR,"X",37319.9,37320.9,.XMMSG)
"RTN","XMXEDIT",18,0)
 Q
"RTN","XMXEDIT",19,0)
CONFID(XMZ,XMINSTR,XMMSG) ; Toggle Confidential msg
"RTN","XMXEDIT",20,0)
 I $D(^TMP("XMY",$J,.6)) D ERRSET^XMXUTIL(37301.6) Q  ; Messages addressed to SHARED,MAIL may not be confidential
"RTN","XMXEDIT",21,0)
 D FLAGTOGL(XMZ,1.96,.XMINSTR,"C",37301.9,37302.9,.XMMSG)
"RTN","XMXEDIT",22,0)
 Q
"RTN","XMXEDIT",23,0)
CONFIRM(XMZ,XMINSTR,XMMSG) ; Toggle Confirm receipt of msg
"RTN","XMXEDIT",24,0)
 D FLAGTOGL(XMZ,1.3,.XMINSTR,"R",37313.9,37314.9,.XMMSG)
"RTN","XMXEDIT",25,0)
 Q
"RTN","XMXEDIT",26,0)
DELIVER(XMZ,XMDBSKT,XMINSTR,XMMSG) ; Delivery basket
"RTN","XMXEDIT",27,0)
 I XMDBSKT="@" D  Q
"RTN","XMXEDIT",28,0)
 . K XMINSTR("RCPT BSKT")
"RTN","XMXEDIT",29,0)
 . S XMFDA(3.9,XMZ_",",21)="@"
"RTN","XMXEDIT",30,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",31,0)
 . S XMMSG=$$EZBLD^DIALOG(37304.9) ; Delivery basket removed
"RTN","XMXEDIT",32,0)
 S XMINSTR("RCPT BSKT")=XMDBSKT
"RTN","XMXEDIT",33,0)
 S XMFDA(3.9,XMZ_",",21)=XMINSTR("RCPT BSKT")
"RTN","XMXEDIT",34,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",35,0)
 S XMMSG=$$EZBLD^DIALOG(37303.9) ; Delivery basket set
"RTN","XMXEDIT",36,0)
 Q
"RTN","XMXEDIT",37,0)
INFO(XMZ,XMINSTR,XMMSG) ; Toggle Information only msg
"RTN","XMXEDIT",38,0)
 D FLAGTOGL(XMZ,1.97,.XMINSTR,"I",37307.9,37308.9,.XMMSG)
"RTN","XMXEDIT",39,0)
 Q
"RTN","XMXEDIT",40,0)
NETSIG(XMDUZ,XMZ,XMINSTR,XMMSG) ; Add Network Signature
"RTN","XMXEDIT",41,0)
 N I,XMNSIG
"RTN","XMXEDIT",42,0)
 S XMNSIG(.1)=""
"RTN","XMXEDIT",43,0)
 S XMNSIG(.2)=""
"RTN","XMXEDIT",44,0)
 S XMNSIG(.3)=$$REPEAT^XLFSTR("-",79)
"RTN","XMXEDIT",45,0)
 S XMNSIG=$G(^XMB(3.7,XMDUZ,"NS1"))
"RTN","XMXEDIT",46,0)
 F I=1:1:3 S:$P(XMNSIG,U,I)'="" XMNSIG(I)=$P(XMNSIG,U,I)
"RTN","XMXEDIT",47,0)
 N XMABORT
"RTN","XMXEDIT",48,0)
 I $D(^XMB(3.9,XMZ,"K")) D  Q:XMABORT
"RTN","XMXEDIT",49,0)
 . ; If XMSECURE does not exist, then XMINSTR("SCR KEY") must hold the
"RTN","XMXEDIT",50,0)
 . ; correct scramble key.
"RTN","XMXEDIT",51,0)
 . I '$D(XMSECURE) N XMSECURE
"RTN","XMXEDIT",52,0)
 . I '$D(XMSECURE),'$$GOODKEY^XMJMCODE(XMZ,XMINSTR("SCR KEY")) D  Q
"RTN","XMXEDIT",53,0)
 . . D ERRSET^XMXUTIL(34623) ; The key is not correct.
"RTN","XMXEDIT",54,0)
 . . S XMABORT=1
"RTN","XMXEDIT",55,0)
 . S XMABORT=0
"RTN","XMXEDIT",56,0)
 . S I=0
"RTN","XMXEDIT",57,0)
 . F  S I=$O(XMNSIG(I)) Q:'I  S XMNSIG(I)=$$ENCSTR^XMJMCODE(XMNSIG(I))
"RTN","XMXEDIT",58,0)
 D MOVEBODY^XMXSEND(XMZ,"XMNSIG","A") ; Add the network signature
"RTN","XMXEDIT",59,0)
 S XMMSG=$$EZBLD^DIALOG(37309.9) ; Network Signature added
"RTN","XMXEDIT",60,0)
 Q
"RTN","XMXEDIT",61,0)
PRIORITY(XMZ,XMINSTR,XMMSG) ; Toggle Priority msg
"RTN","XMXEDIT",62,0)
 D FLAGTOGL(XMZ,1.7,.XMINSTR,"P",37311.9,37312.9,.XMMSG)
"RTN","XMXEDIT",63,0)
 Q
"RTN","XMXEDIT",64,0)
SCRAMBLE(XMZ,XMINSTR,XMMSG) ; Scramble or Unscramble the message text
"RTN","XMXEDIT",65,0)
 N XMFDA,XMIENS
"RTN","XMXEDIT",66,0)
 S XMIENS=XMZ_","
"RTN","XMXEDIT",67,0)
 I $D(^XMB(3.9,XMZ,"K")) D  Q
"RTN","XMXEDIT",68,0)
 . ; Unscramble the text.
"RTN","XMXEDIT",69,0)
 . ; If XMSECURE does not exist, then XMINSTR("SCR KEY") must hold the
"RTN","XMXEDIT",70,0)
 . ; correct scramble key.
"RTN","XMXEDIT",71,0)
 . I '$D(XMSECURE),'$$GOODKEY^XMJMCODE(XMZ,XMINSTR("SCR KEY")) D ERRSET^XMXUTIL(34623) Q  ; The key is not correct.
"RTN","XMXEDIT",72,0)
 . S XMFDA(3.9,XMIENS,1.8)="@"
"RTN","XMXEDIT",73,0)
 . S XMFDA(3.9,XMIENS,1.85)="@"
"RTN","XMXEDIT",74,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",75,0)
 . D DECMSG^XMJMCODE(XMZ)
"RTN","XMXEDIT",76,0)
 . K XMSECURE,XMINSTR("SCR KEY"),XMINSTR("SCR HINT"),^XMB(3.9,XMZ,"K")
"RTN","XMXEDIT",77,0)
 . S XMMSG=$$EZBLD^DIALOG(37316.9) ; Message text UnScrambled
"RTN","XMXEDIT",78,0)
 ; Scramble the text.
"RTN","XMXEDIT",79,0)
 N XMKEY
"RTN","XMXEDIT",80,0)
 K XMSECURE
"RTN","XMXEDIT",81,0)
 S XMFDA(3.9,XMIENS,1.8)=$S($G(XMINSTR("SCR HINT"))="":" ",1:XMINSTR("SCR HINT"))
"RTN","XMXEDIT",82,0)
 D LOADCODE^XMJMCODE ; XMSECURE is created here
"RTN","XMXEDIT",83,0)
 S XMKEY=XMINSTR("SCR KEY")
"RTN","XMXEDIT",84,0)
 D ADJUST^XMJMCODE(.XMKEY) ; XMSECURE is adjusted here
"RTN","XMXEDIT",85,0)
 S XMFDA(3.9,XMIENS,1.85)="1"_$$ENCSTR^XMJMCODE(XMKEY)
"RTN","XMXEDIT",86,0)
 D ENCMSG^XMJMCODE(XMZ)
"RTN","XMXEDIT",87,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",88,0)
 S XMMSG=$$EZBLD^DIALOG(37315.9) ; Message text Scrambled
"RTN","XMXEDIT",89,0)
 Q
"RTN","XMXEDIT",90,0)
SUBJ(XMZ,XMSUBJ,XMIM) ; Replace Subject
"RTN","XMXEDIT",91,0)
 I $G(XMSUBJ)="" S XMSUBJ=$$EZBLD^DIALOG(34012)
"RTN","XMXEDIT",92,0)
 S (XMIM("SUBJ"),XMFDA(3.9,XMZ_",",.01))=$$ENCODEUP^XMXUTIL1(XMSUBJ)
"RTN","XMXEDIT",93,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",94,0)
 Q
"RTN","XMXEDIT",95,0)
TEXT(XMZ,XMBODY) ; Replace Text
"RTN","XMXEDIT",96,0)
 D WP^DIE(3.9,XMZ_",",3,"",XMBODY)
"RTN","XMXEDIT",97,0)
 Q
"RTN","XMXEDIT",98,0)
VAPOR(XMZ,XMVAPOR,XMINSTR,XMMSG) ; Vaporize date
"RTN","XMXEDIT",99,0)
 I XMVAPOR="@" D  Q
"RTN","XMXEDIT",100,0)
 . K XMINSTR("VAPOR")
"RTN","XMXEDIT",101,0)
 . S XMFDA(3.9,XMZ_",",1.6)="@"
"RTN","XMXEDIT",102,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",103,0)
 . S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",5)="@"
"RTN","XMXEDIT",104,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",105,0)
 . S XMMSG=$$EZBLD^DIALOG(37318.9) ; Vaporize Date removed
"RTN","XMXEDIT",106,0)
 S XMINSTR("VAPOR")=XMVAPOR
"RTN","XMXEDIT",107,0)
 S XMFDA(3.9,XMZ_",",1.6)=XMINSTR("VAPOR")
"RTN","XMXEDIT",108,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",109,0)
 S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",5)=XMINSTR("VAPOR")
"RTN","XMXEDIT",110,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",111,0)
 S XMMSG=$$EZBLD^DIALOG(37317.9) ; Vaporize Date set
"RTN","XMXEDIT",112,0)
 Q
"RTN","XMXEDIT",113,0)
FLAGTOGL(XMZ,XMFIELD,XMINSTR,XMFLAG,XMSET,XMREMOVE,XMMSG) ; Flag Toggle
"RTN","XMXEDIT",114,0)
 N XMFDA
"RTN","XMXEDIT",115,0)
 I $G(XMINSTR("FLAGS"))[XMFLAG D
"RTN","XMXEDIT",116,0)
 . S XMINSTR("FLAGS")=$TR(XMINSTR("FLAGS"),XMFLAG)
"RTN","XMXEDIT",117,0)
 . S XMMSG=$$EZBLD^DIALOG(XMREMOVE)
"RTN","XMXEDIT",118,0)
 . I XMFLAG="P" D
"RTN","XMXEDIT",119,0)
 . . S XMFDA(3.9,XMZ_",",XMFIELD)=$S($G(XMINSTR("TYPE"))="":"@",1:XMINSTR("TYPE"))
"RTN","XMXEDIT",120,0)
 . E  S XMFDA(3.9,XMZ_",",XMFIELD)="@"
"RTN","XMXEDIT",121,0)
 E  D
"RTN","XMXEDIT",122,0)
 . S XMINSTR("FLAGS")=$G(XMINSTR("FLAGS"))_XMFLAG
"RTN","XMXEDIT",123,0)
 . S XMMSG=$$EZBLD^DIALOG(XMSET)
"RTN","XMXEDIT",124,0)
 . I XMFLAG="P" S XMFDA(3.9,XMZ_",",XMFIELD)=$G(XMINSTR("TYPE"))_"P"
"RTN","XMXEDIT",125,0)
 . E  S XMFDA(3.9,XMZ_",",XMFIELD)="y"
"RTN","XMXEDIT",126,0)
 D FILE^DIE("","XMFDA")
"RTN","XMXEDIT",127,0)
 Q
"RTN","XMXEDIT",128,0)
 ;
"RTN","XMXEDIT",129,0)
 ;#34012 = * No Subject *
"RTN","XMXMSGS")
0^16^B37131574
"RTN","XMXMSGS",1,0)
XMXMSGS ;ISC-SF/GMB- Message APIs ;01/06/2000  07:47
"RTN","XMXMSGS",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMXMSGS",3,0)
DELMSG(XMDUZ,XMK,XMKZA,XMMSG) ;
"RTN","XMXMSGS",4,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",5,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",6,0)
 D ACTMSG("XDEL^XMXMSGS2",34302) ;,XMDUZ,XMK,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",7,0)
 Q
"RTN","XMXMSGS",8,0)
MOVEMSG(XMDUZ,XMK,XMKZA,XMKTO,XMMSG) ;
"RTN","XMXMSGS",9,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",10,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",11,0)
 Q:XMK=XMKTO
"RTN","XMXMSGS",12,0)
 D ACTMSG("XMOVE^XMXMSGS2",34324) ;,XMDUZ,XMK,.XMKZA,XMKTO,.XMMSG)
"RTN","XMXMSGS",13,0)
 Q
"RTN","XMXMSGS",14,0)
TERMMSG(XMDUZ,XMK,XMKZA,XMMSG) ;
"RTN","XMXMSGS",15,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",16,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",17,0)
 D ACTMSG("XTERM^XMXMSGS2",34329) ;,XMDUZ,XMK,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",18,0)
 Q
"RTN","XMXMSGS",19,0)
FLTRMSG(XMDUZ,XMK,XMKZA,XMMSG) ;
"RTN","XMXMSGS",20,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMXMSGS",21,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",22,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",23,0)
 I XMK'=.5,'$D(^XMB(3.7,XMDUZ,15,"AF")) D ERRSET^XMXUTIL(37204.1) Q  ; You have no message filters defined.
"RTN","XMXMSGS",24,0)
 S:XMK XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS",25,0)
 D ACTMSG("XFLTR^XMXMSGS2",34306) ;,XMDUZ,XMK,XMKN,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",26,0)
 Q
"RTN","XMXMSGS",27,0)
FWDMSG(XMDUZ,XMK,XMKZA,XMTO,XMINSTR,XMMSG) ;
"RTN","XMXMSGS",28,0)
 ; XMINSTR("SHARE DATE")  delete date if SHARED,MAIL is recipient
"RTN","XMXMSGS",29,0)
 ; XMINSTR("SHARE BSKT")  basket if SHARED,MAIL is recipient
"RTN","XMXMSGS",30,0)
 N XMRTN
"RTN","XMXMSGS",31,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",32,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",33,0)
 I $$ONEMSG(.XMKZA) D
"RTN","XMXMSGS",34,0)
 . S XMRTN="XFWDONE^XMXMSGS1" ; just one msg
"RTN","XMXMSGS",35,0)
 E  D
"RTN","XMXMSGS",36,0)
 . S XMRTN="XFWD^XMXMSGS1"
"RTN","XMXMSGS",37,0)
 . I $G(XMINSTR("ADDR FLAGS"))'["I" D INIT^XMXADDR
"RTN","XMXMSGS",38,0)
 . D CHKADDR^XMXADDR(XMDUZ,.XMTO,.XMINSTR)
"RTN","XMXMSGS",39,0)
 D ACTMSG(XMRTN,34309) ;,XMDUZ,XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXMSGS",40,0)
 D CLEANUP^XMXADDR
"RTN","XMXMSGS",41,0)
 Q
"RTN","XMXMSGS",42,0)
ONEMSG(XMKZA) ; Function decides if just one message
"RTN","XMXMSGS",43,0)
 N XMONE,XMMSGS
"RTN","XMXMSGS",44,0)
 I $G(XMKZA)]"" D  Q XMONE
"RTN","XMXMSGS",45,0)
 . I $O(XMKZA(""))="",+XMKZA=XMKZA S XMONE=1 Q
"RTN","XMXMSGS",46,0)
 . S XMONE=0
"RTN","XMXMSGS",47,0)
 S XMMSGS=$O(XMKZA(""))
"RTN","XMXMSGS",48,0)
 I $O(XMKZA(XMMSGS))'="" Q 0
"RTN","XMXMSGS",49,0)
 I +XMMSGS=XMMSGS Q 1
"RTN","XMXMSGS",50,0)
 Q 0
"RTN","XMXMSGS",51,0)
LATERMSG(XMDUZ,XMK,XMKZA,XMINSTR,XMMSG) ;
"RTN","XMXMSGS",52,0)
 ; XMINSTR("LATER")  FM date/time when msg should be made new.
"RTN","XMXMSGS",53,0)
 N XMWHEN
"RTN","XMXMSGS",54,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",55,0)
 Q:'$$LATER^XMXSEC(XMDUZ)
"RTN","XMXMSGS",56,0)
 D ACTMSG("XLATER^XMXMSGS2",34312) ;,XMDUZ,XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXMSGS",57,0)
 Q
"RTN","XMXMSGS",58,0)
NTOGLMSG(XMDUZ,XMK,XMKZA,XMMSG) ;
"RTN","XMXMSGS",59,0)
 N XMKN,XMKTO,XMKNTO
"RTN","XMXMSGS",60,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",61,0)
 Q:'$$LATER^XMXSEC(XMDUZ)
"RTN","XMXMSGS",62,0)
 S:XMK XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS",63,0)
 D ACTMSG("XNTOGL^XMXMSGS2",34315) ;,XMDUZ,XMK,XMKN,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",64,0)
 Q
"RTN","XMXMSGS",65,0)
PRTMSG(XMDUZ,XMK,XMKZA,XMPRTTO,XMINSTR,XMMSG,XMTASK,XMSUBJ,XMTO) ;
"RTN","XMXMSGS",66,0)
 K XMERR,^TMP("XMERR",$J),^TMP("XM",$J,"XMZ")
"RTN","XMXMSGS",67,0)
 D ACTMSG("XPRT^XMXMSGS1",34320) ;,XMDUZ,XMK,.XMKZA,.XMINSTR,.XMMSG)
"RTN","XMXMSGS",68,0)
 Q:+XMMSG=0
"RTN","XMXMSGS",69,0)
 I +XMMSG=1 D
"RTN","XMXMSGS",70,0)
 . D PRINT1^XMXPRT(XMDUZ,$O(^TMP("XM",$J,"XMZ","")),XMPRTTO,.XMINSTR,.XMTASK,.XMSUBJ,.XMTO)
"RTN","XMXMSGS",71,0)
 E  D
"RTN","XMXMSGS",72,0)
 . D PRINTM^XMXPRT(XMDUZ,XMPRTTO,.XMINSTR,.XMTASK,.XMSUBJ,.XMTO)
"RTN","XMXMSGS",73,0)
 K ^TMP("XM",$J,"XMZ")
"RTN","XMXMSGS",74,0)
 Q:$D(XMTASK)
"RTN","XMXMSGS",75,0)
 S XMMSG=$$EZBLD^DIALOG(34321) ; 0 messages sent to printer.  TaskMan Problem.
"RTN","XMXMSGS",76,0)
 D ERRSET^XMXUTIL(34311) ; Task creation not successful.
"RTN","XMXMSGS",77,0)
 Q
"RTN","XMXMSGS",78,0)
XPMSG(XMDUZ,XMK,XMKZA,XMMSG) ; Postmaster transmit priority toggle
"RTN","XMXMSGS",79,0)
 K XMERR,^TMP("XMERR",$J)
"RTN","XMXMSGS",80,0)
 I XMDUZ'=DUZ,'$$RPRIV^XMXSEC Q
"RTN","XMXMSGS",81,0)
 I XMDUZ'=.5!(XMK'>999) D ERRSET^XMXUTIL(37219.5) Q  ;Transmission Priority toggle valid only for Postmaster Transmission Queues.
"RTN","XMXMSGS",82,0)
 D ACTMSG("XXP^XMXMSGS1",34334) ;,XMDUZ,XMK,.XMKZA,"",.XMMSG)
"RTN","XMXMSGS",83,0)
 Q
"RTN","XMXMSGS",84,0)
ACTMSG(XMRTN,XMSUM) ;,XMDUZ,XMK,XMKZA,XMKTO,XMMSG)
"RTN","XMXMSGS",85,0)
 ; XMKZA    Array of msg numbers  DEL("1-3,7,11-15")
"RTN","XMXMSGS",86,0)
 ; XMKZL    List of msg numbers   1-3,7,11-15
"RTN","XMXMSGS",87,0)
 ;          (It is OK if the list ends with a comma)
"RTN","XMXMSGS",88,0)
 ; XMKZR    Range of msg numbers  1-3
"RTN","XMXMSGS",89,0)
 ; XMKZ1    First number in range 1
"RTN","XMXMSGS",90,0)
 ; XMKZN    Last number in range  3
"RTN","XMXMSGS",91,0)
 ; XMKZ     Message number
"RTN","XMXMSGS",92,0)
 N XMCNT,XMI,XMZ,XMPIECES
"RTN","XMXMSGS",93,0)
 S XMCNT=0
"RTN","XMXMSGS",94,0)
 I $G(XMK) D
"RTN","XMXMSGS",95,0)
 . N XMKZ,XMKZL,XMKZR,XMKZ1,XMKZN
"RTN","XMXMSGS",96,0)
 . ; is this an array or a variable?
"RTN","XMXMSGS",97,0)
 . I $G(XMKZA)]"",$O(XMKZA(""))="" S XMKZA(XMKZA)=""
"RTN","XMXMSGS",98,0)
 . S XMKZL=""
"RTN","XMXMSGS",99,0)
 . F  S XMKZL=$O(XMKZA(XMKZL)) Q:XMKZL=""  D
"RTN","XMXMSGS",100,0)
 . . S XMPIECES=$L(XMKZL,",")
"RTN","XMXMSGS",101,0)
 . . S:$P(XMKZL,",",XMPIECES)="" XMPIECES=XMPIECES-1
"RTN","XMXMSGS",102,0)
 . . F XMI=1:1:XMPIECES D
"RTN","XMXMSGS",103,0)
 . . . S XMKZR=$P(XMKZL,",",XMI)
"RTN","XMXMSGS",104,0)
 . . . I XMKZR["-" D
"RTN","XMXMSGS",105,0)
 . . . . ; deal with a range of msg #s
"RTN","XMXMSGS",106,0)
 . . . . S XMKZ1=$P(XMKZR,"-",1)
"RTN","XMXMSGS",107,0)
 . . . . S XMKZN=$P(XMKZR,"-",2)
"RTN","XMXMSGS",108,0)
 . . . . I XMKZ1>XMKZN D  Q
"RTN","XMXMSGS",109,0)
 . . . . . N XMPARM
"RTN","XMXMSGS",110,0)
 . . . . . S XMPARM(1)=XMKZ1,XMPARM(2)=XMKZN
"RTN","XMXMSGS",111,0)
 . . . . . D ERRSET^XMXUTIL(34350,.XMPARM) ; Range '_XMKZ1_-_XMKZN_' invalid.
"RTN","XMXMSGS",112,0)
 . . . . S XMKZ=XMKZ1-.1
"RTN","XMXMSGS",113,0)
 . . . . F  S XMKZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q:'XMKZ!(XMKZ>XMKZN)  D
"RTN","XMXMSGS",114,0)
 . . . . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMXMSGS",115,0)
 . . . . . I 'XMZ D  Q
"RTN","XMXMSGS",116,0)
 . . . . . . N XMPARM
"RTN","XMXMSGS",117,0)
 . . . . . . S XMPARM(1)=XMKZ,XMPARM(2)=XMK
"RTN","XMXMSGS",118,0)
 . . . . . . D ERRSET^XMXUTIL(34351,.XMPARM) ; Message _XMKZ_ in basket _XMK_ does not exist.
"RTN","XMXMSGS",119,0)
 . . . . . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMXMSGS",120,0)
 . . . . . . N XMPARM
"RTN","XMXMSGS",121,0)
 . . . . . . S XMPARM(1)=XMZ,XMPARM(2)=XMKZ,XMPARM(3)=XMK
"RTN","XMXMSGS",122,0)
 . . . . . . D ERRSET^XMXUTIL(34352,.XMPARM) ; Message '_XMZ_' (message _XMKZ_ in basket _XMK_) does not exist.
"RTN","XMXMSGS",123,0)
 . . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS",124,0)
 . . . E  D
"RTN","XMXMSGS",125,0)
 . . . . S XMKZ=XMKZR
"RTN","XMXMSGS",126,0)
 . . . . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMXMSGS",127,0)
 . . . . I 'XMZ D  Q
"RTN","XMXMSGS",128,0)
 . . . . . N XMPARM
"RTN","XMXMSGS",129,0)
 . . . . . S XMPARM(1)=XMKZ,XMPARM(2)=XMK
"RTN","XMXMSGS",130,0)
 . . . . . D ERRSET^XMXUTIL(34351,.XMPARM) ; Message _XMKZ_ in basket _XMK_ does not exist.
"RTN","XMXMSGS",131,0)
 . . . . I '$D(^XMB(3.9,XMZ,0)) D  Q
"RTN","XMXMSGS",132,0)
 . . . . . N XMPARM
"RTN","XMXMSGS",133,0)
 . . . . . S XMPARM(1)=XMZ,XMPARM(2)=XMKZ,XMPARM(3)=XMK
"RTN","XMXMSGS",134,0)
 . . . . . D ERRSET^XMXUTIL(34352,.XMPARM) ; Message '_XMZ_' (message _XMKZ_ in basket _XMK_) does not exist.
"RTN","XMXMSGS",135,0)
 . . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS",136,0)
 E  D
"RTN","XMXMSGS",137,0)
 . N XMZL,XMZREC
"RTN","XMXMSGS",138,0)
 . ; is this an array or a variable?
"RTN","XMXMSGS",139,0)
 . I $G(XMKZA)]"",$O(XMKZA(""))="" S XMKZA(XMKZA)=""
"RTN","XMXMSGS",140,0)
 . S XMZL=""
"RTN","XMXMSGS",141,0)
 . F  S XMZL=$O(XMKZA(XMZL)) Q:XMZL=""  D
"RTN","XMXMSGS",142,0)
 . . I XMZL["-" D ERRSET^XMXUTIL(34353) Q  ; XMZ message ranges are not allowed.
"RTN","XMXMSGS",143,0)
 . . S XMPIECES=$L(XMZL,",")
"RTN","XMXMSGS",144,0)
 . . S:'$P(XMZL,",",XMPIECES) XMPIECES=XMPIECES-1
"RTN","XMXMSGS",145,0)
 . . F XMI=1:1:XMPIECES D
"RTN","XMXMSGS",146,0)
 . . . N XMK
"RTN","XMXMSGS",147,0)
 . . . S XMZ=$P(XMZL,",",XMI)
"RTN","XMXMSGS",148,0)
 . . . I '$D(^XMB(3.9,XMZ,0)) D ERRSET^XMXUTIL(34354,XMZ) Q  ; Message '_XMZ_' does not exist."
"RTN","XMXMSGS",149,0)
 . . . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXMSGS",150,0)
 . . . Q:'$$ACCESS^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXMSGS",151,0)
 . . . D @XMRTN ;(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS",152,0)
 S XMMSG=$$EZBLD^DIALOG($S(XMCNT=1:XMSUM+.1,1:XMSUM),XMCNT)
"RTN","XMXMSGS",153,0)
 Q
"RTN","XMXMSGS2")
0^17^B35236145
"RTN","XMXMSGS2",1,0)
XMXMSGS2 ;ISC-SF/GMB- Message APIs cont'd ;12/14/99  08:17
"RTN","XMXMSGS2",2,0)
 ;;7.1;MailMan;**50,106,110**;Jun 02, 1994
"RTN","XMXMSGS2",3,0)
DEL(XMDUZ,XMK,XMZ,XMCNT) ;
"RTN","XMXMSGS2",4,0)
XDEL ;
"RTN","XMXMSGS2",5,0)
 ; See ENTB^XMAH:  May only delete spooled document from msg action prompt.  Why?****************
"RTN","XMXMSGS2",6,0)
 I XMDUZ'=DUZ,'$$DELETE^XMXSEC(XMDUZ,XMK,XMZ,$G(^XMB(3.9,XMZ,0))) Q
"RTN","XMXMSGS2",7,0)
 I '$G(XMK) S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,"")) Q:'XMK
"RTN","XMXMSGS2",8,0)
 S XMCNT=$G(XMCNT)+1
"RTN","XMXMSGS2",9,0)
 D ZAPIT(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS2",10,0)
 D WASTEIT(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS2",11,0)
 Q
"RTN","XMXMSGS2",12,0)
MOVE(XMDUZ,XMK,XMZ,XMKTO,XMCNT) ;
"RTN","XMXMSGS2",13,0)
XMOVE ;
"RTN","XMXMSGS2",14,0)
 I XMDUZ=.6,'$$MOVE^XMXSEC(XMDUZ,XMZ,$G(^XMB(3.9,XMZ,0))) Q
"RTN","XMXMSGS2",15,0)
 S:'$G(XMK) XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",16,0)
 Q:XMK=XMKTO
"RTN","XMXMSGS2",17,0)
 I XMK D
"RTN","XMXMSGS2",18,0)
 . D COPYIT(XMDUZ,XMK,XMZ,XMKTO)
"RTN","XMXMSGS2",19,0)
 . D ZAPIT(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS2",20,0)
 ; The message is not in the user's mailbox
"RTN","XMXMSGS2",21,0)
 E  D PUTMSG(XMDUZ,XMKTO,$P(^XMB(3.7,XMDUZ,2,XMKTO,0),U),XMZ)
"RTN","XMXMSGS2",22,0)
 S XMCNT=$G(XMCNT)+1
"RTN","XMXMSGS2",23,0)
 Q
"RTN","XMXMSGS2",24,0)
TERM(XMDUZ,XMK,XMZ,XMCNT) ;
"RTN","XMXMSGS2",25,0)
XTERM ;
"RTN","XMXMSGS2",26,0)
 N XMIEN
"RTN","XMXMSGS2",27,0)
 I XMDUZ'=DUZ,'$$DELETE^XMXSEC(XMDUZ,XMK,XMZ,$G(^XMB(3.9,XMZ,0))) Q
"RTN","XMXMSGS2",28,0)
 S:'$G(XMK) XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",29,0)
 I XMK D
"RTN","XMXMSGS2",30,0)
 . D ZAPIT(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS2",31,0)
 . D WASTEIT(XMDUZ,XMK,XMZ)
"RTN","XMXMSGS2",32,0)
 S XMIEN=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMXMSGS2",33,0)
 S:XMIEN ^XMB(3.9,XMZ,1,XMIEN,"D")=DT
"RTN","XMXMSGS2",34,0)
 S XMCNT=$G(XMCNT)+1
"RTN","XMXMSGS2",35,0)
 Q
"RTN","XMXMSGS2",36,0)
ZAPIT(XMDUZ,XMK,XMZ) ;
"RTN","XMXMSGS2",37,0)
 N XMFDA
"RTN","XMXMSGS2",38,0)
 S XMFDA(3.702,XMZ_","_XMK_","_XMDUZ_",",.01)="@" ; delete msg
"RTN","XMXMSGS2",39,0)
 I $D(^XMB(3.7,XMDUZ,"N0",XMK,XMZ)) D  Q
"RTN","XMXMSGS2",40,0)
 . L +^XMB(3.7,XMDUZ) ; It's a new msg, reduce count of...
"RTN","XMXMSGS2",41,0)
 . S $P(^(0),U,6)=$P(^XMB(3.7,XMDUZ,0),U,6)-1 ; new msgs in all bskts
"RTN","XMXMSGS2",42,0)
 . S $P(^(0),U,2)=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,2)-1 ; new msgs in bskt
"RTN","XMXMSGS2",43,0)
 . D FILE^DIE("","XMFDA")
"RTN","XMXMSGS2",44,0)
 . L -^XMB(3.7,XMDUZ)
"RTN","XMXMSGS2",45,0)
 N XMTRIES
"RTN","XMXMSGS2",46,0)
 ;L +^XMB(3.7,XMDUZ,2,XMK)
"RTN","XMXMSGS2",47,0)
ZAPTRY ;
"RTN","XMXMSGS2",48,0)
 D FILE^DIE("SK","XMFDA")
"RTN","XMXMSGS2",49,0)
 ;L -^XMB(3.7,XMDUZ,2,XMK)
"RTN","XMXMSGS2",50,0)
 Q:'$D(DIERR)
"RTN","XMXMSGS2",51,0)
 S XMTRIES=$G(XMTRIES)+1
"RTN","XMXMSGS2",52,0)
 ;I XMTRIES#1000=0 S ^ZZGXMB("ZAP",DT,XMDUZ,XMK,XMZ,$$NOW^XLFDT)="1000 tries locking duz/xmk/xmz"
"RTN","XMXMSGS2",53,0)
 I $D(^TMP("DIERR",$J,"E",110)) H 1 G ZAPTRY  ; Try again if can't lock
"RTN","XMXMSGS2",54,0)
 Q
"RTN","XMXMSGS2",55,0)
COPYIT(XMDUZ,XMK,XMZ,XMKTO) ;
"RTN","XMXMSGS2",56,0)
 Q:$D(^XMB(3.7,XMDUZ,2,XMKTO,1,XMZ))  ; Message already exists at destination
"RTN","XMXMSGS2",57,0)
 N XMFDA,XMKREC,XMIENS,XMIEN
"RTN","XMXMSGS2",58,0)
 S XMKREC=^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)
"RTN","XMXMSGS2",59,0)
 S XMIENS="+1,"_XMKTO_","_XMDUZ_","
"RTN","XMXMSGS2",60,0)
 S XMIEN(1)=XMZ
"RTN","XMXMSGS2",61,0)
 S XMFDA(3.702,XMIENS,.01)=XMZ
"RTN","XMXMSGS2",62,0)
 I $P(XMKREC,U,3),XMKTO'=.5 S XMFDA(3.702,XMIENS,3)=$P(XMKREC,U,3) ; new flag
"RTN","XMXMSGS2",63,0)
 S:$P(XMKREC,U,4) XMFDA(3.702,XMIENS,4)=$P(XMKREC,U,4) ; date last accessed
"RTN","XMXMSGS2",64,0)
 I '$P(XMKREC,U,7),$P(XMKREC,U,5) S XMFDA(3.702,XMIENS,5)=$P(XMKREC,U,5) ; vapor date
"RTN","XMXMSGS2",65,0)
 S:$P(XMKREC,U,6) XMFDA(3.702,XMIENS,6)=$P(XMKREC,U,6) ; ntwk msg flag
"RTN","XMXMSGS2",66,0)
 L +^XMB(3.7,XMDUZ)
"RTN","XMXMSGS2",67,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMXMSGS2",68,0)
 I $P(XMKREC,U,3),XMKTO'=.5 D INCRNEW^XMXUTIL(XMDUZ,XMKTO) ; Increment new counts
"RTN","XMXMSGS2",69,0)
 L -^XMB(3.7,XMDUZ)
"RTN","XMXMSGS2",70,0)
 D:XMK=.5 RESURECT(XMDUZ,XMZ)
"RTN","XMXMSGS2",71,0)
 Q
"RTN","XMXMSGS2",72,0)
RESURECT(XMDUZ,XMZ) ; If msg was terminated, "unterminate" it.
"RTN","XMXMSGS2",73,0)
 N XMIEN
"RTN","XMXMSGS2",74,0)
 S XMIEN=+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0))
"RTN","XMXMSGS2",75,0)
 K:XMIEN ^XMB(3.9,XMZ,1,XMIEN,"D")
"RTN","XMXMSGS2",76,0)
 Q
"RTN","XMXMSGS2",77,0)
WASTEIT(XMDUZ,XMK,XMZ) ;
"RTN","XMXMSGS2",78,0)
 Q:XMK=.5
"RTN","XMXMSGS2",79,0)
 Q:$D(^XMB(3.7,XMDUZ,2,.5,1,XMZ))  ; Already in wastebasket
"RTN","XMXMSGS2",80,0)
 N XMFDA,XMIENS,XMIEN
"RTN","XMXMSGS2",81,0)
 S XMK=.5
"RTN","XMXMSGS2",82,0)
 L +^XMB(3.7,XMDUZ)
"RTN","XMXMSGS2",83,0)
 D:'$D(^XMB(3.7,XMDUZ,2,.5,0)) MAKEBSKT^XMXBSKT(XMDUZ,.5,"WASTE")
"RTN","XMXMSGS2",84,0)
 S XMIENS="+1,"_XMK_","_XMDUZ_","
"RTN","XMXMSGS2",85,0)
 S XMIEN(1)=XMZ
"RTN","XMXMSGS2",86,0)
 S XMFDA(3.702,XMIENS,.01)=XMZ
"RTN","XMXMSGS2",87,0)
 S XMFDA(3.702,XMIENS,4)=DT  ; date last accessed
"RTN","XMXMSGS2",88,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMXMSGS2",89,0)
 L -^XMB(3.7,XMDUZ)
"RTN","XMXMSGS2",90,0)
 Q
"RTN","XMXMSGS2",91,0)
LATER(XMDUZ,XMZ,XMWHEN,XMCNT) ;
"RTN","XMXMSGS2",92,0)
XLATER ;
"RTN","XMXMSGS2",93,0)
 S XMCNT=$G(XMCNT)+1
"RTN","XMXMSGS2",94,0)
 S:'$D(XMWHEN) XMWHEN=XMINSTR("LATER")
"RTN","XMXMSGS2",95,0)
 D LTRADD^XMJMD(XMDUZ,XMZ,XMWHEN)
"RTN","XMXMSGS2",96,0)
 Q
"RTN","XMXMSGS2",97,0)
NTOGL(XMDUZ,XMK,XMKN,XMZ,XMCNT,XMKTO,XMKNTO) ;
"RTN","XMXMSGS2",98,0)
XNTOGL ;
"RTN","XMXMSGS2",99,0)
 ; If XMK>.5, then it's simple.  Just toggle the 'new' flag.
"RTN","XMXMSGS2",100,0)
 ; If XMK<1, we know the message is not new, and we need to make it new.
"RTN","XMXMSGS2",101,0)
 ; Filter it, but if it filters to the WASTE basket put it in the IN.
"RTN","XMXMSGS2",102,0)
 ; Then make it new.
"RTN","XMXMSGS2",103,0)
 S XMCNT=$G(XMCNT)+1
"RTN","XMXMSGS2",104,0)
 I '$G(XMK) D
"RTN","XMXMSGS2",105,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",106,0)
 . S:XMK XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS2",107,0)
 I XMK<1 D
"RTN","XMXMSGS2",108,0)
 . I $D(^XMB(3.7,XMDUZ,15,"AF")) D
"RTN","XMXMSGS2",109,0)
 . . N XMZREC
"RTN","XMXMSGS2",110,0)
 . . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXMSGS2",111,0)
 . . D FILTER^XMTDF(XMDUZ,XMZ,$P(XMZREC,U,1),$P(XMZREC,U,2),.XMKTO,.XMKNTO)
"RTN","XMXMSGS2",112,0)
 . . I XMKTO=1,XMK>1 S XMKTO=XMK,XMKNTO=XMKN Q
"RTN","XMXMSGS2",113,0)
 . . I XMKTO<1 S XMKTO=1,XMKNTO=$$EZBLD^DIALOG(37005) ; "IN"
"RTN","XMXMSGS2",114,0)
 . E  I XMK>1 S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",115,0)
 . E  S XMKTO=1,XMKNTO=$$EZBLD^DIALOG(37005) ; "IN"
"RTN","XMXMSGS2",116,0)
 . Q:XMK=XMKTO
"RTN","XMXMSGS2",117,0)
 . I XMK D MOVE(XMDUZ,XMK,XMZ,XMKTO) Q
"RTN","XMXMSGS2",118,0)
 . D PUTMSG(XMDUZ,XMKTO,XMKNTO,XMZ)
"RTN","XMXMSGS2",119,0)
 E  S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",120,0)
 I $$NEW^XMXUTIL2(XMDUZ,XMKTO,XMZ) D NONEW^XMXUTIL(XMDUZ,XMKTO,XMZ) Q
"RTN","XMXMSGS2",121,0)
 D MAKENEW^XMXUTIL(XMDUZ,XMKTO,XMZ)
"RTN","XMXMSGS2",122,0)
 Q
"RTN","XMXMSGS2",123,0)
FLTR(XMDUZ,XMK,XMKN,XMZ,XMCNT,XMKTO,XMKNTO) ; Filter message
"RTN","XMXMSGS2",124,0)
XFLTR ;
"RTN","XMXMSGS2",125,0)
 ; XMK    (in) the basket # the message is currently in.  (May be 0 if
"RTN","XMXMSGS2",126,0)
 ;             the message isn't currently in a basket.)
"RTN","XMXMSGS2",127,0)
 ; XMKN   (in) the name of basket XMK
"RTN","XMXMSGS2",128,0)
 ; XMKTO  (out) the basket # this routine decides to put the message in
"RTN","XMXMSGS2",129,0)
 ; XMKNTO (out) the name of basket XMKTO
"RTN","XMXMSGS2",130,0)
 ; This routine decides which basket the message belongs in.
"RTN","XMXMSGS2",131,0)
 ; If this is the same basket it is currently in, it sets XMKTO and
"RTN","XMXMSGS2",132,0)
 ; XMKNTO to the current basket.
"RTN","XMXMSGS2",133,0)
 ; Otherwise, it moves the message (from the current basket) to the
"RTN","XMXMSGS2",134,0)
 ; decided-upon basket and sets XMKTO and XMKNTO to that basket.
"RTN","XMXMSGS2",135,0)
 ; If the message is in the WASTE basket, and no filters are defined,
"RTN","XMXMSGS2",136,0)
 ; it will be moved to the IN basket.
"RTN","XMXMSGS2",137,0)
 I '$G(XMK) D
"RTN","XMXMSGS2",138,0)
 . S XMK=$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXMSGS2",139,0)
 . S:XMK XMKN=$P(^XMB(3.7,XMDUZ,2,XMK,0),U,1)
"RTN","XMXMSGS2",140,0)
 I XMDUZ=.6,XMK'=.5,'$$MOVE^XMXSEC(XMDUZ,XMZ,$G(^XMB(3.9,XMZ,0))) Q
"RTN","XMXMSGS2",141,0)
 S XMCNT=$G(XMCNT)+1
"RTN","XMXMSGS2",142,0)
 I $D(^XMB(3.7,XMDUZ,15,"AF")) D
"RTN","XMXMSGS2",143,0)
 . N XMZREC
"RTN","XMXMSGS2",144,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXMSGS2",145,0)
 . D FILTER^XMTDF(XMDUZ,XMZ,$P(XMZREC,U,1),$P(XMZREC,U,2),.XMKTO,.XMKNTO)
"RTN","XMXMSGS2",146,0)
 . I XMKTO=1,XMK>1 S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",147,0)
 E  I XMK>1 S XMKTO=XMK,XMKNTO=XMKN
"RTN","XMXMSGS2",148,0)
 E  S XMKTO=1,XMKNTO=$$EZBLD^DIALOG(37005) ; "IN"
"RTN","XMXMSGS2",149,0)
 Q:XMK=XMKTO
"RTN","XMXMSGS2",150,0)
 I XMK D MOVE(XMDUZ,XMK,XMZ,XMKTO) Q
"RTN","XMXMSGS2",151,0)
 D PUTMSG(XMDUZ,XMKTO,XMKNTO,XMZ)
"RTN","XMXMSGS2",152,0)
 Q
"RTN","XMXMSGS2",153,0)
PUTMSG(XMDUZ,XMK,XMKN,XMZ) ; For internal MM use only.
"RTN","XMXMSGS2",154,0)
 ; Replaces SETSB^XMA1C, SET^XMS1, & part of MAIL^XMR0B
"RTN","XMXMSGS2",155,0)
 ; Put a msg in the Postmaster's (or anyone else's) basket.
"RTN","XMXMSGS2",156,0)
 ; The msg is NOT made new.
"RTN","XMXMSGS2",157,0)
 ; The basket has a specific name and number.
"RTN","XMXMSGS2",158,0)
 ; If the basket doesn't exist, create it.
"RTN","XMXMSGS2",159,0)
 ; XMK      Basket number
"RTN","XMXMSGS2",160,0)
 ; XMKN     Basket name
"RTN","XMXMSGS2",161,0)
 ; XMZ      Msg number
"RTN","XMXMSGS2",162,0)
 N XMFDA,XMIEN,XMTRIES
"RTN","XMXMSGS2",163,0)
 Q:$D(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0))
"RTN","XMXMSGS2",164,0)
 I $D(^XMB(3.7,XMDUZ,2,XMK)) D  Q
"RTN","XMXMSGS2",165,0)
 . S XMFDA(3.702,"+1,"_XMK_","_XMDUZ_",",.01)=XMZ
"RTN","XMXMSGS2",166,0)
 . S XMIEN(1)=XMZ
"RTN","XMXMSGS2",167,0)
 . ;L +^XMB(3.7,XMDUZ,2,XMK)
"RTN","XMXMSGS2",168,0)
PUTTRY . ;
"RTN","XMXMSGS2",169,0)
 . D UPDATE^DIE("S","XMFDA","XMIEN")
"RTN","XMXMSGS2",170,0)
 . ;L -^XMB(3.7,XMDUZ,2,XMK)
"RTN","XMXMSGS2",171,0)
 . Q:'$D(DIERR)
"RTN","XMXMSGS2",172,0)
 . S XMTRIES=$G(XMTRIES)+1
"RTN","XMXMSGS2",173,0)
 . ;I XMTRIES#1000=0 S ^ZZGXMB("PUT",DT,XMDUZ,XMK,XMZ,$$NOW^XLFDT)="1000 tries locking duz/xmk/xmz"
"RTN","XMXMSGS2",174,0)
 . I $D(^TMP("DIERR",$J,"E",110)) H 1 G PUTTRY  ; Try again if can't lock
"RTN","XMXMSGS2",175,0)
 S XMFDA(3.701,"+1,"_XMDUZ_",",.01)=XMKN
"RTN","XMXMSGS2",176,0)
 S XMFDA(3.702,"+2,+1,"_XMDUZ_",",.01)=XMZ
"RTN","XMXMSGS2",177,0)
 S XMIEN(1)=XMK
"RTN","XMXMSGS2",178,0)
 S XMIEN(2)=XMZ
"RTN","XMXMSGS2",179,0)
 L +^XMB(3.7,XMDUZ,2)
"RTN","XMXMSGS2",180,0)
 D UPDATE^DIE("","XMFDA","XMIEN")
"RTN","XMXMSGS2",181,0)
 L -^XMB(3.7,XMDUZ,2)
"RTN","XMXMSGS2",182,0)
 Q
"RTN","XMXSEC")
0^3^B61916559
"RTN","XMXSEC",1,0)
XMXSEC ;ISC-SF/GMB-Message security and restrictions ;02/22/2000  10:17
"RTN","XMXSEC",2,0)
 ;;7.1;MailMan;**50,110**;Jun 02, 1994
"RTN","XMXSEC",3,0)
 ; All entry points covered by DBIA 2731.
"RTN","XMXSEC",4,0)
BCAST(XMZ) ; 0=msg was not broadcast; 1=msg was broadcast
"RTN","XMXSEC",5,0)
 N XMBCAST
"RTN","XMXSEC",6,0)
 S XMBCAST=$$EZBLD^DIALOG(39006) ; * (Broadcast to all local users)
"RTN","XMXSEC",7,0)
 Q:$D(^XMB(3.9,XMZ,1,"C",$E(XMBCAST,1,30))) 1
"RTN","XMXSEC",8,0)
 Q:$D(^XMB(3.9,XMZ,1,"C",XMBCAST)) 1
"RTN","XMXSEC",9,0)
 Q 0
"RTN","XMXSEC",10,0)
ZCLOSED(XMZ) ;
"RTN","XMXSEC",11,0)
 Q $$CLOSED($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",12,0)
CLOSED(XMZREC) ; 0=msg is not closed; 1=msg is closed
"RTN","XMXSEC",13,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,9)_U)
"RTN","XMXSEC",14,0)
ZCONFID(XMZ) ;
"RTN","XMXSEC",15,0)
 Q $$CONFID($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",16,0)
CONFID(XMZREC) ; 0=msg is not confidential; 1=msg is confidential
"RTN","XMXSEC",17,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,11)_U)
"RTN","XMXSEC",18,0)
ZCONFIRM(XMZ) ;
"RTN","XMXSEC",19,0)
 Q $$CONFIRM($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",20,0)
CONFIRM(XMZREC) ; 0=msg is not confirm receipt requested; 1=msg is confirm
"RTN","XMXSEC",21,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,5)_U)
"RTN","XMXSEC",22,0)
ZINFO(XMZ) ;
"RTN","XMXSEC",23,0)
 Q $$INFO($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",24,0)
INFO(XMZREC) ; 0=msg is not information only; 1=msg is information only
"RTN","XMXSEC",25,0)
 Q "^Y^y^"[(U_$P(XMZREC,U,12)_U)
"RTN","XMXSEC",26,0)
ZORIGIN8(XMDUZ,XMZ) ;
"RTN","XMXSEC",27,0)
 Q $$ORIGIN8R(XMDUZ,$G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",28,0)
ORIGIN8R(XMDUZ,XMZREC) ; Did the user send the message?
"RTN","XMXSEC",29,0)
 ; 1=user is the originator ; 0=user is NOT the originator
"RTN","XMXSEC",30,0)
 Q:XMDUZ=$P(XMZREC,U,2) 1
"RTN","XMXSEC",31,0)
 Q:XMDUZ=$P(XMZREC,U,4) 1
"RTN","XMXSEC",32,0)
 Q:XMDUZ=DUZ 0
"RTN","XMXSEC",33,0)
 Q:DUZ=$P(XMZREC,U,2) 1
"RTN","XMXSEC",34,0)
 Q:DUZ=$P(XMZREC,U,4) 1
"RTN","XMXSEC",35,0)
 Q 0
"RTN","XMXSEC",36,0)
ZPRI(XMZ) ;
"RTN","XMXSEC",37,0)
 Q $$PRIORITY($G(^XMB(3.9,XMZ,0)))
"RTN","XMXSEC",38,0)
PRIORITY(XMZREC) ; 0=msg is not priority; 1=msg is priority
"RTN","XMXSEC",39,0)
 Q $P(XMZREC,U,7)["P"
"RTN","XMXSEC",40,0)
SURRCONF(XMDUZ,XMZ) ; 0=msg is not confidential; 1=msg is confidential, and surrogate may not read it.
"RTN","XMXSEC",41,0)
 ; We already know that XMDUZ'=DUZ.
"RTN","XMXSEC",42,0)
 ; But the surrogate may read a confidential message if it was the
"RTN","XMXSEC",43,0)
 ; surrogate who sent it.
"RTN","XMXSEC",44,0)
 Q:"^Y^y^"'[(U_$P($G(^XMB(3.9,+XMZ,0)),U,11)_U) 0
"RTN","XMXSEC",45,0)
 Q:DUZ=$P(^(0),U,2) 0  ; naked ref from above
"RTN","XMXSEC",46,0)
 Q:DUZ=$P(^(0),U,4) 0  ; naked ref from above
"RTN","XMXSEC",47,0)
 Q 1
"RTN","XMXSEC",48,0)
ACCESS(XMDUZ,XMZ,XMZREC) ; Determines user access to a message.
"RTN","XMXSEC",49,0)
 ; 1=user may access; 0=user may not access
"RTN","XMXSEC",50,0)
 Q:$D(^XMB(3.7,"M",XMZ,XMDUZ)) 1  ; Message is in user's mailbox
"RTN","XMXSEC",51,0)
 N XMPRE
"RTN","XMXSEC",52,0)
 S XMPRE=$P(^XMB(3.7,XMDUZ,0),U,7)
"RTN","XMXSEC",53,0)
 I XMPRE,$P($G(^XMB(3.9,XMZ,.6)),U,1)<XMPRE D  Q 0
"RTN","XMXSEC",54,0)
 . D ERRSET^XMXUTIL(37100,$$MMDT^XMXUTIL1(XMPRE),XMZ) ; You may not access any message prior to _X_ unless someone forwards it to you.
"RTN","XMXSEC",55,0)
 Q:$D(^XMB(3.9,XMZ,1,"C",XMDUZ)) 1  ; User is recipient
"RTN","XMXSEC",56,0)
 ;Q:$D(^XMB(3.9,XMZ,1,"C",DUZ)) 1 ; Surrogate is a recipient.
"RTN","XMXSEC",57,0)
 Q:$$BCAST(XMZ) 1
"RTN","XMXSEC",58,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",59,0)
 I $P(XMZREC,U,8) D  Q 0
"RTN","XMXSEC",60,0)
 . N XMPARM
"RTN","XMXSEC",61,0)
 . S XMPARM(1)=XMZ,XMPARM(2)=$P(XMZREC,U,8)
"RTN","XMXSEC",62,0)
 . D ERRSET^XMXUTIL(37101,.XMPARM,XMZ) ; Message _XMZ_ is a response to message _$P(XMZREC,U,8)_.
"RTN","XMXSEC",63,0)
 I $$ORIGIN8R(XMDUZ,XMZREC) D  Q 1  ; User is sender
"RTN","XMXSEC",64,0)
 . D ADDRECP^XMTDL(XMZ,$P(XMZREC,U,7)["P",XMDUZ)
"RTN","XMXSEC",65,0)
 . ;D LASTREAD^XMTDL(XMZ,XMDUZ,$P(XMZREC,U,3))
"RTN","XMXSEC",66,0)
 D ERRSET^XMXUTIL(37102,"",XMZ) ; You are neither a sender nor a recipient of this message.  If you need to see it, ask someone to forward it to you.
"RTN","XMXSEC",67,0)
 Q 0
"RTN","XMXSEC",68,0)
SURRACC(XMDUZ,XMACCESS,XMZ,XMZREC) ; Determines surrogate access to a message.
"RTN","XMXSEC",69,0)
 ; 1=surrogate may access; 0=surrogate may not access
"RTN","XMXSEC",70,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",71,0)
 Q:'$$CONFID(XMZREC) 1  ; Message isn't confidential.
"RTN","XMXSEC",72,0)
 Q:DUZ=$P(XMZREC,U,2) 1 ; Surrogate sent the message.
"RTN","XMXSEC",73,0)
 Q:DUZ=$P(XMZREC,U,4) 1 ; Surrogate sent the message.
"RTN","XMXSEC",74,0)
 ;Q:$D(^XMB(3.9,XMZ,1,"C",DUZ)) 1 ; Surrogate is a recipient.
"RTN","XMXSEC",75,0)
 I $G(XMACCESS)'="" D ERRSET^XMXUTIL(37452,XMACCESS,XMZ) Q 0  ; Surrogates may not _XMACCESS_ CONFIDENTIAL messages.
"RTN","XMXSEC",76,0)
 D ERRSET^XMXUTIL(37451,XMZ) ; Surrogates may not access or do anything to Confidential messages.
"RTN","XMXSEC",77,0)
 Q 0
"RTN","XMXSEC",78,0)
ANSWER(XMDUZ,XMZ,XMZREC) ; Answer (1=may, 0=may not)
"RTN","XMXSEC",79,0)
 I DUZ=.6!(XMDUZ=.6) D ERRSET^XMXUTIL(37462,"",XMZ) Q 0  ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC",80,0)
 I XMDUZ'=DUZ Q:'$$WPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "answer"
"RTN","XMXSEC",81,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",82,0)
 I $$PAKMAN^XMXSEC1(XMZ,XMZREC) D ERRSET^XMXUTIL(37401.4,"",XMZ) Q 0  ; May not answer a PackMan message.
"RTN","XMXSEC",83,0)
 I $D(^XMB(3.9,XMZ,"K")) D ERRSET^XMXUTIL(47401.2,"",XMZ) Q 0  ; May not answer a scrambled message.  Use Reply.
"RTN","XMXSEC",84,0)
 I '$$GOTNS^XMVVITA(XMDUZ) D ERRSET^XMXUTIL($S(XMDUZ=DUZ:37401.1,1:37401.3),XMV("NAME"),XMZ) Q 0  ; You / X must have a network signature in order to answer a message.
"RTN","XMXSEC",85,0)
 Q 1
"RTN","XMXSEC",86,0)
COPY(XMDUZ,XMZ,XMZREC) ; Copy (1=may, 0=may not)
"RTN","XMXSEC",87,0)
 I XMDUZ'=DUZ Q:'$$WPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "copy"
"RTN","XMXSEC",88,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",89,0)
 I $$CLOSED(XMZREC),'$$ORIGIN8R(XMDUZ,XMZREC) D ERRSET^XMXUTIL(37403.1,"",XMZ) Q 0  ; Only the message originator may copy CLOSED messages.
"RTN","XMXSEC",90,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4) D ERRSET^XMXUTIL(37403.6,"",XMZ) Q 0  ; Only the originator may copy messages in SHARED,MAIL.
"RTN","XMXSEC",91,0)
 I $D(^XMB(3.9,XMZ,"K")) D ERRSET^XMXUTIL(37403.2,"",XMZ) Q 0  ; May not copy a scrambled message.
"RTN","XMXSEC",92,0)
 Q 1
"RTN","XMXSEC",93,0)
DELETE(XMDUZ,XMK,XMZ,XMZREC) ; Delete, Terminate (1=may, 0=may not)
"RTN","XMXSEC",94,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",95,0)
 Q:'$$RWPRIV 0
"RTN","XMXSEC",96,0)
 I XMDUZ=.5,XMK>999 Q 1
"RTN","XMXSEC",97,0)
 Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "delete"
"RTN","XMXSEC",98,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",99,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4),'$D(^XUSEC("XMMGR",DUZ)),'$D(^XMB(3.7,"AB",DUZ,.5,0)) D  Q 0
"RTN","XMXSEC",100,0)
 . D ERRSET^XMXUTIL(37461,"",XMZ) ; Only the originator, postmaster surrogate, or XMMGR key holder may do this in SHARED,MAIL.
"RTN","XMXSEC",101,0)
 Q 1
"RTN","XMXSEC",102,0)
FORWARD(XMDUZ,XMZ,XMZREC) ; Forward (1=may, 0=may not)
"RTN","XMXSEC",103,0)
 I XMDUZ'=DUZ Q:'$$RWPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "forward"
"RTN","XMXSEC",104,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",105,0)
 I $$CLOSED(XMZREC),'$$ORIGIN8R(XMDUZ,XMZREC) D ERRSET^XMXUTIL(37406.1,"",XMZ) Q 0  ; Only the message originator may forward CLOSED messages.
"RTN","XMXSEC",106,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4) D ERRSET^XMXUTIL(37406.6,"",XMZ) Q 0  ; Only the originator may forward messages in SHARED,MAIL.
"RTN","XMXSEC",107,0)
 Q 1
"RTN","XMXSEC",108,0)
LATER(XMDUZ) ; Later or New Toggle (1=may, 0=may not)
"RTN","XMXSEC",109,0)
 I DUZ=.6!(XMDUZ=.6) D ERRSET^XMXUTIL(37462) Q 0  ; SHARED,MAIL may not 'later' or 'new toggle' a message.
"RTN","XMXSEC",110,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",111,0)
 Q $$RWPRIV
"RTN","XMXSEC",112,0)
MOVE(XMDUZ,XMZ,XMZREC) ; Save or Filter (1=may, 0=may not)
"RTN","XMXSEC",113,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",114,0)
 Q:'$$RWPRIV 0
"RTN","XMXSEC",115,0)
 ;Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "save"
"RTN","XMXSEC",116,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",117,0)
 I XMDUZ=.6,DUZ'=$P(XMZREC,U,2),DUZ'=$P(XMZREC,U,4),'$D(^XUSEC("XMMGR",DUZ)),'$D(^XMB(3.7,"AB",DUZ,.5,0)) D  Q 0
"RTN","XMXSEC",118,0)
 . D ERRSET^XMXUTIL(37461,"",XMZ) ; Only the originator, postmaster surrogate, or XMMGR key holder may do this in SHARED,MAIL.
"RTN","XMXSEC",119,0)
 Q 1
"RTN","XMXSEC",120,0)
READ(XMDUZ,XMZ,XMZREC) ; Read or Print (1=may, 0=may not)
"RTN","XMXSEC",121,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",122,0)
 Q $$SURRACC(XMDUZ,"",XMZ,.XMZREC)  ; "access"
"RTN","XMXSEC",123,0)
REPLY(XMDUZ,XMZ,XMZREC) ; Reply (1=may, 0=may not)
"RTN","XMXSEC",124,0)
 I DUZ=.6 D ERRSET^XMXUTIL(37422.6,"",XMZ) Q 0  ; May not reply to message as SHARED,MAIL.
"RTN","XMXSEC",125,0)
 I XMDUZ'=DUZ Q:'$$RWPRIV 0  Q:'$$SURRACC(XMDUZ,"",XMZ,.XMZREC) 0  ; "reply to"
"RTN","XMXSEC",126,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC",127,0)
 I $D(^XMB(3.9,XMZ,"K")),$$PAKMAN^XMXSEC1(XMZ,XMZREC) D ERRSET^XMXUTIL(37422.4,"",XMZ) Q 0  ; May not reply to secure PackMan message.
"RTN","XMXSEC",128,0)
 Q:$$ORIGIN8R(XMDUZ,XMZREC) 1
"RTN","XMXSEC",129,0)
 I $$INFO(XMZREC) D ERRSET^XMXUTIL(37422.1,"",XMZ) Q 0  ; Only originator may reply to 'INFORMATION ONLY' message.
"RTN","XMXSEC",130,0)
 I $P($G(^XMB(3.9,XMZ,1,+$O(^XMB(3.9,XMZ,1,"C",XMDUZ,0)),"T")),U,1)["I" D ERRSET^XMXUTIL(37422.2,"",XMZ) Q 0  ; 'INFORMATION ONLY' recipient may not reply to message.
"RTN","XMXSEC",131,0)
 I $P(XMZREC,U,2)["POSTMASTER@" D ERRSET^XMXUTIL(37422.5,"",XMZ) Q 0  ; You may not reply to a message from a remote Postmaster."
"RTN","XMXSEC",132,0)
 Q 1
"RTN","XMXSEC",133,0)
SEND(XMDUZ,XMINSTR) ; Send (1=may, 0=may not)
"RTN","XMXSEC",134,0)
 I DUZ=.6!(XMDUZ=.6) D ERRSET^XMXUTIL(37462) Q 0  ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC",135,0)
 Q:XMDUZ=DUZ 1
"RTN","XMXSEC",136,0)
 Q:$D(XMINSTR("FROM")) 1
"RTN","XMXSEC",137,0)
 Q:XMDUZ=.5 1
"RTN","XMXSEC",138,0)
 Q $$WPRIV
"RTN","XMXSEC",139,0)
RWPRIV() ; Does the surrogate have 'read' or 'send' privilege? (1=yes, 0=no)
"RTN","XMXSEC",140,0)
 Q:$G(XMV("PRIV"))["R"!($G(XMV("PRIV"))["W") 1
"RTN","XMXSEC",141,0)
 D ERRSET^XMXUTIL(37457,XMV("NAME")) ; You do not have 'read' or 'send' privilege for "_XMV("NAME")
"RTN","XMXSEC",142,0)
 Q 0
"RTN","XMXSEC",143,0)
RPRIV() ; Does the surrogate have 'read' privilege? (1=yes, 0=no)
"RTN","XMXSEC",144,0)
 Q:$G(XMV("PRIV"))["R" 1
"RTN","XMXSEC",145,0)
 D ERRSET^XMXUTIL(37455,XMV("NAME")) ; You do not have 'read' privilege for "_XMV("NAME")
"RTN","XMXSEC",146,0)
 Q 0
"RTN","XMXSEC",147,0)
WPRIV() ; Does the surrogate have 'send' privilege? (1=yes, 0=no)
"RTN","XMXSEC",148,0)
 Q:$G(XMV("PRIV"))["W" 1
"RTN","XMXSEC",149,0)
 D ERRSET^XMXUTIL(37456,XMV("NAME")) ; You do not have 'send' privilege for "_XMV("NAME")
"RTN","XMXSEC",150,0)
 Q 0
"RTN","XMXSEC",151,0)
POSTPRIV() ; Perform postmaster actions (1=may, 0=may not)
"RTN","XMXSEC",152,0)
 ; This includes permission to perform group message actions in Shared,Mail.
"RTN","XMXSEC",153,0)
 I '$D(^XUSEC("XMMGR",DUZ)),'$D(^XMB(3.7,"AB",DUZ,.5)) D ERRSET^XMXUTIL(37458) Q 0  ; Only a POSTMASTER surrogate or XMMGR key holder may do this.
"RTN","XMXSEC",154,0)
 Q 1
"RTN","XMXSEC",155,0)
ZPOSTPRV() ; Perform postmaster actions (1=may, 0=may not)
"RTN","XMXSEC",156,0)
 ; This includes permission to perform group message actions in Shared,Mail.
"RTN","XMXSEC",157,0)
 Q:$D(^XUSEC("XMMGR",DUZ)) 1
"RTN","XMXSEC",158,0)
 Q:$D(^XMB(3.7,"AB",DUZ,.5)) 1
"RTN","XMXSEC",159,0)
 Q 0
"RTN","XMXSEC1")
0^1^B41493935
"RTN","XMXSEC1",1,0)
XMXSEC1 ;ISC-SF/GMB-Message security and restrictions (cont'd) ;3/10/00  05:22
"RTN","XMXSEC1",2,0)
 ;;7.1;MailMan;**50,95,110**;Jun 02, 1994
"RTN","XMXSEC1",3,0)
 ; All entry points covered by DBIA 2732.
"RTN","XMXSEC1",4,0)
GETRESTR(XMDUZ,XMZ,XMZREC,XMINSTR,XMRESTR) ;
"RTN","XMXSEC1",5,0)
 ; If a message is closed, it may not be forwarded to SHARED,MAIL, even by the sender
"RTN","XMXSEC1",6,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",7,0)
 S:"^Y^y^"[(U_$P(XMZREC,U,9)_U) XMRESTR("FLAGS")=$G(XMRESTR("FLAGS"))_"X"
"RTN","XMXSEC1",8,0)
 ; If a message is confidential, it may not be forwarded to SHARED,MAIL
"RTN","XMXSEC1",9,0)
 S:"^Y^y^"[(U_$P(XMZREC,U,11)_U) XMRESTR("FLAGS")=$G(XMRESTR("FLAGS"))_"C"
"RTN","XMXSEC1",10,0)
 Q:$G(XMINSTR("ADDR FLAGS"))["R"
"RTN","XMXSEC1",11,0)
 ; If a message is priority, it may not be forwarded to groups unless
"RTN","XMXSEC1",12,0)
 ; the user is the originator or possesses the proper security key.
"RTN","XMXSEC1",13,0)
 I $P(XMZREC,U,7)["P",'$$ORIGIN8R^XMXSEC(XMDUZ,XMZREC),'$D(^XUSEC("XM GROUP PRIORITY",XMDUZ)) S XMRESTR("NOFPG")=""
"RTN","XMXSEC1",14,0)
 ; If a message is more lines than the limit, then it may not be sent/forwarded to a remote site
"RTN","XMXSEC1",15,0)
 D CHKLINES(XMDUZ,XMZ,.XMRESTR)
"RTN","XMXSEC1",16,0)
 Q
"RTN","XMXSEC1",17,0)
CHKLINES(XMDUZ,XMZ,XMRESTR) ; Replaces NO^XMA21A
"RTN","XMXSEC1",18,0)
 N XMLIMIT
"RTN","XMXSEC1",19,0)
 Q:$D(^XUSEC("XMMGR",XMDUZ))
"RTN","XMXSEC1",20,0)
 S XMLIMIT=$P($G(^XMB(1,1,"NETWORK-LIMIT")),U)
"RTN","XMXSEC1",21,0)
 I XMLIMIT,$P($G(^XMB(3.9,XMZ,2,0)),U,4)>XMLIMIT S XMRESTR("NONET")=XMLIMIT
"RTN","XMXSEC1",22,0)
 Q
"RTN","XMXSEC1",23,0)
CHKMSG(XMDUZ,XMK,XMKZ,XMZ,XMZREC) ; Is the message where the calling routine says it is,
"RTN","XMXSEC1",24,0)
 ; and is the user authorized to access it?
"RTN","XMXSEC1",25,0)
 I $G(XMK) D  Q
"RTN","XMXSEC1",26,0)
 . S XMZ=$O(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ,""))
"RTN","XMXSEC1",27,0)
 . I 'XMZ D  Q
"RTN","XMXSEC1",28,0)
 . . N XMPARM
"RTN","XMXSEC1",29,0)
 . . S XMPARM(1)=XMKZ,XMPARM(2)=XMK
"RTN","XMXSEC1",30,0)
 . . D ERRSET^XMXUTIL(34351,.XMPARM) ; Message _XMKZ_ in basket _XMK_ does not exist.
"RTN","XMXSEC1",31,0)
 . S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",32,0)
 . Q:XMZREC'=""
"RTN","XMXSEC1",33,0)
 . N XMPARM
"RTN","XMXSEC1",34,0)
 . S XMPARM(1)=XMZ,XMPARM(2)=XMKZ,XMPARM(3)=XMK
"RTN","XMXSEC1",35,0)
 . D ERRSET^XMXUTIL(34352,.XMPARM) ; Message _XMZ_ (message _XMKZ_ in basket _XMK_) does not exist.
"RTN","XMXSEC1",36,0)
 S XMZ=XMKZ
"RTN","XMXSEC1",37,0)
 S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",38,0)
 I XMZREC="" D ERRSET^XMXUTIL(34354,XMZ) Q  ; Message _XMZ_ does not exist.
"RTN","XMXSEC1",39,0)
 Q:'$$ACCESS^XMXSEC(XMDUZ,XMZ,XMZREC)
"RTN","XMXSEC1",40,0)
 S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,""))
"RTN","XMXSEC1",41,0)
 Q:'XMK
"RTN","XMXSEC1",42,0)
 S XMKZ=$P($G(^XMB(3.7,XMDUZ,2,XMK,1,XMZ,0)),U,2)
"RTN","XMXSEC1",43,0)
 I 'XMKZ D ADDITM^XMUT4A(XMDUZ,XMK,XMZ,.XMKZ)
"RTN","XMXSEC1",44,0)
 Q
"RTN","XMXSEC1",45,0)
PAKMAN(XMZ,XMZREC) ; Returns 1 if this is a packman msg; 0 if not.
"RTN","XMXSEC1",46,0)
 ; Unfortunately, there isn't always an "X" in piece 7 of the zero node,
"RTN","XMXSEC1",47,0)
 ; so we must go check out the first line of text.
"RTN","XMXSEC1",48,0)
 N XMTYPE
"RTN","XMXSEC1",49,0)
 I $G(XMZREC)="" S XMZREC=$G(^XMB(3.9,XMZ,0))
"RTN","XMXSEC1",50,0)
 S XMTYPE=$P(XMZREC,U,7)
"RTN","XMXSEC1",51,0)
 I "P"[XMTYPE D  Q XMTYPE  ; "P" means priority, and it exists along with
"RTN","XMXSEC1",52,0)
 . ; message type in piece 7 in all MailMan versions thru 7.*
"RTN","XMXSEC1",53,0)
 . N XMREC,XMI
"RTN","XMXSEC1",54,0)
 . S XMTYPE=0
"RTN","XMXSEC1",55,0)
 . S XMI=$O(^XMB(3.9,XMZ,2,.999999)) I 'XMI Q
"RTN","XMXSEC1",56,0)
 . S XMREC=^XMB(3.9,XMZ,2,XMI,0)
"RTN","XMXSEC1",57,0)
 . Q:$E(XMREC,1)'="$"
"RTN","XMXSEC1",58,0)
 . I XMREC?1"$TXT Created by".E1" at ".E1" on ".E S XMTYPE=1 Q  ; Unsecured PackMan
"RTN","XMXSEC1",59,0)
 . I XMREC?1"$TXT PACKMAN BACKUP".E S XMTYPE=1 Q  ; PackMan Backup
"RTN","XMXSEC1",60,0)
 . I XMREC?1"$TXT ^Created by".E1" at ".E1" on ".E S XMTYPE=1 Q  ; Secured PackMan
"RTN","XMXSEC1",61,0)
 Q:XMTYPE="K"!(XMTYPE="X") 1  ; PackMan message (KIDS or regular)
"RTN","XMXSEC1",62,0)
 Q 0
"RTN","XMXSEC1",63,0)
OPTGRP(XMDUZ,XMK,XMOPT,XMOX) ; What may the user do at the basket/message group level?
"RTN","XMXSEC1",64,0)
 I XMK D
"RTN","XMXSEC1",65,0)
 . I XMDUZ=.5,XMK>999 D OPTPOST(.XMOPT,.XMOX) Q
"RTN","XMXSEC1",66,0)
 . D OPTUSER1(XMDUZ,.XMOPT,.XMOX)
"RTN","XMXSEC1",67,0)
 . D OPTUSER2(XMK,.XMOPT,.XMOX)
"RTN","XMXSEC1",68,0)
 E  D
"RTN","XMXSEC1",69,0)
 . D OPTUSER1(XMDUZ,.XMOPT,.XMOX)
"RTN","XMXSEC1",70,0)
 Q
"RTN","XMXSEC1",71,0)
SET(XMCD,XMDN,XMOPT,XMOX) ;
"RTN","XMXSEC1",72,0)
 N XMDREC
"RTN","XMXSEC1",73,0)
 S XMDREC=$$EZBLD^DIALOG(XMDN)
"RTN","XMXSEC1",74,0)
 S XMOPT(XMCD)=$P(XMDREC,":",2,99)
"RTN","XMXSEC1",75,0)
 S XMOX("O",XMCD)=$P(XMDREC,":",1) ; "O"=original english to foreign
"RTN","XMXSEC1",76,0)
 S XMOX("X",$P(XMDREC,":",1))=XMCD ; "X"=translate foreign to english
"RTN","XMXSEC1",77,0)
 Q
"RTN","XMXSEC1",78,0)
OPTUSER1(XMDUZ,XMOPT,XMOX) ;
"RTN","XMXSEC1",79,0)
 D SET("D",37202,.XMOPT,.XMOX) ; Delete messages
"RTN","XMXSEC1",80,0)
 D SET("F",37203,.XMOPT,.XMOX) ; Forward messages
"RTN","XMXSEC1",81,0)
 D SET("FI",37204,.XMOPT,.XMOX) ; Filter messages
"RTN","XMXSEC1",82,0)
 D SET("H",37205,.XMOPT,.XMOX) ; Headerless Print messages
"RTN","XMXSEC1",83,0)
 D SET("L",37206,.XMOPT,.XMOX) ; Later messages
"RTN","XMXSEC1",84,0)
 D SET("NT",37208,.XMOPT,.XMOX) ; New Toggle messages
"RTN","XMXSEC1",85,0)
 D SET("P",37209,.XMOPT,.XMOX) ; Print messages
"RTN","XMXSEC1",86,0)
 D SET("S",37213,.XMOPT,.XMOX) ; Save messages to another basket
"RTN","XMXSEC1",87,0)
 D SET("T",37214,.XMOPT,.XMOX) ; Terminate messages
"RTN","XMXSEC1",88,0)
 I '$D(^XMB(3.7,XMDUZ,15,"AF")) S XMOPT("FI","?")=$S(XMDUZ=DUZ:$$EZBLD^DIALOG(37204.1),1:$$EZBLD^DIALOG(37204.2,XMV("NAME"))) ; no message filters defined
"RTN","XMXSEC1",89,0)
 Q:XMDUZ'=.6
"RTN","XMXSEC1",90,0)
 ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC1",91,0)
 S XMOPT("L","?")=$$EZBLD^DIALOG(37462)
"RTN","XMXSEC1",92,0)
 S XMOPT("NT","?")=XMOPT("L","?")
"RTN","XMXSEC1",93,0)
 Q:$$ZPOSTPRV^XMXSEC()
"RTN","XMXSEC1",94,0)
 N DIR
"RTN","XMXSEC1",95,0)
 ; You must hold the XMMGR key or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"RTN","XMXSEC1",96,0)
 D BLD^DIALOG(37261,"","","DIR(""?"")")
"RTN","XMXSEC1",97,0)
 M XMOPT("D","?")=DIR("?")
"RTN","XMXSEC1",98,0)
 M XMOPT("F","?")=DIR("?")
"RTN","XMXSEC1",99,0)
 M XMOPT("FI","?")=DIR("?")
"RTN","XMXSEC1",100,0)
 M XMOPT("S","?")=DIR("?")
"RTN","XMXSEC1",101,0)
 M XMOPT("T","?")=DIR("?")
"RTN","XMXSEC1",102,0)
 Q
"RTN","XMXSEC1",103,0)
OPTUSER2(XMK,XMOPT,XMOX) ;
"RTN","XMXSEC1",104,0)
 D SET("C",37201,.XMOPT,.XMOX) ; Change the name of this basket
"RTN","XMXSEC1",105,0)
 D SET("N",37207,.XMOPT,.XMOX) ; New message list
"RTN","XMXSEC1",106,0)
 D SET("Q",37211,.XMOPT,.XMOX) ; Query (search for) messages in this basket
"RTN","XMXSEC1",107,0)
 D SET("R",37212,.XMOPT,.XMOX) ; Resequence messages
"RTN","XMXSEC1",108,0)
 I XMK'>1 S XMOPT("C","?")=$$EZBLD^DIALOG(37201.1) ; The name of this basket may not be changed.
"RTN","XMXSEC1",109,0)
 ;"The name of "_$S(XMK=1:"the IN",XMK=.5:"the WASTE",1:"this")_" basket may not be changed."
"RTN","XMXSEC1",110,0)
 Q:XMDUZ'=.6!$$ZPOSTPRV^XMXSEC()
"RTN","XMXSEC1",111,0)
 N DIR
"RTN","XMXSEC1",112,0)
 ; You must hold the XMMGR key or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"RTN","XMXSEC1",113,0)
 D BLD^DIALOG(37261,"","","DIR(""?"")")
"RTN","XMXSEC1",114,0)
 M XMOPT("C","?")=DIR("?")
"RTN","XMXSEC1",115,0)
 Q
"RTN","XMXSEC1",116,0)
OPTPOST(XMOPT,XMOX) ;
"RTN","XMXSEC1",117,0)
 D SET("D",37202,.XMOPT,.XMOX) ; Delete messages
"RTN","XMXSEC1",118,0)
 D SET("F",37203,.XMOPT,.XMOX) ; Forward messages (Added so that postmaster could reroute messages which for some reason were addressed to the wrong domain.)
"RTN","XMXSEC1",119,0)
 D SET("R",37212,.XMOPT,.XMOX) ; Resequence messages
"RTN","XMXSEC1",120,0)
 D SET("X",37219,.XMOPT,.XMOX) ; Xmit Priority toggle
"RTN","XMXSEC1",121,0)
 Q
"RTN","XMXSEC1",122,0)
COPYAMT(XMZ,XMWHICH) ; Checks total number of lines to be copied and total number of responses to be copied.
"RTN","XMXSEC1",123,0)
 ; Function returns 1 if OK; 0 if not OK.
"RTN","XMXSEC1",124,0)
 ; XMWHICH string of which responses to copy (0=original msg).
"RTN","XMXSEC1",125,0)
 ;         Default = original msg and all responses.
"RTN","XMXSEC1",126,0)
 N XMLIMIT,XMRESPS,XMABORT
"RTN","XMXSEC1",127,0)
 S XMABORT=0
"RTN","XMXSEC1",128,0)
 S XMLIMIT=$$COPYLIMS
"RTN","XMXSEC1",129,0)
 S XMRESPS=+$P($G(^XMB(3.9,XMZ,3,0)),U,4)
"RTN","XMXSEC1",130,0)
 I XMRESPS=0 D TOOMANY(+$P($G(^XMB(3.9,XMZ,2,0)),U,4),$P(XMLIMIT,U,3),37470,.XMABORT) Q 'XMABORT
"RTN","XMXSEC1",131,0)
 N I,J,XMRANGE,XMLINES
"RTN","XMXSEC1",132,0)
 S:'$D(XMWHICH) XMWHICH="0-"_XMRESPS
"RTN","XMXSEC1",133,0)
 S (XMRESPS,XMLINES)=0
"RTN","XMXSEC1",134,0)
 F I=1:1:$L(XMWHICH,",")-1 D
"RTN","XMXSEC1",135,0)
 . S XMRANGE=$P(XMWHICH,",",I)
"RTN","XMXSEC1",136,0)
 . F J=$P(XMRANGE,"-",1):1:$S(XMRANGE["-":$P(XMRANGE,"-",2),1:XMRANGE) D
"RTN","XMXSEC1",137,0)
 . . S XMRESPS=XMRESPS+1
"RTN","XMXSEC1",138,0)
 . . I J=0 S XMLINES=XMLINES+$P($G(^XMB(3.9,XMZ,2,0)),U,4) Q
"RTN","XMXSEC1",139,0)
 . . S XMLINES=XMLINES+$P($G(^XMB(3.9,+$G(^XMB(3.9,XMZ,3,J,0)),2,0)),U,4)
"RTN","XMXSEC1",140,0)
 D TOOMANY(XMLINES,$P(XMLIMIT,U,3),37470,.XMABORT) Q:XMABORT 0
"RTN","XMXSEC1",141,0)
 D TOOMANY(XMRESPS,$P(XMLIMIT,U,2),37471,.XMABORT) Q:XMABORT 0
"RTN","XMXSEC1",142,0)
 Q 1
"RTN","XMXSEC1",143,0)
TOOMANY(HOWMANY,XMLIMIT,XMDIALOG,XMABORT) ;
"RTN","XMXSEC1",144,0)
 Q:HOWMANY'>XMLIMIT
"RTN","XMXSEC1",145,0)
 S XMABORT=1
"RTN","XMXSEC1",146,0)
 D ERRSET^XMXUTIL(XMDIALOG,XMLIMIT) ; You may not copy more than the site limit of _XMLIMIT_ lines / responses.
"RTN","XMXSEC1",147,0)
 Q
"RTN","XMXSEC1",148,0)
COPYLIMS() ; Function returns copy limits string.
"RTN","XMXSEC1",149,0)
 ; limits:  # recipients^# responses^# lines
"RTN","XMXSEC1",150,0)
 N I
"RTN","XMXSEC1",151,0)
 S XMLIMIT=$G(^XMB(1,1,.11))
"RTN","XMXSEC1",152,0)
 F I=1:1:3 I '$P(XMLIMIT,U,I) S $P(XMLIMIT,U,I)=$P("2999^99^3999",U,I)
"RTN","XMXSEC1",153,0)
 Q XMLIMIT
"RTN","XMXSEC1",154,0)
COPYRECP(XMZ) ; Checks total number of recipients to see if it's OK to list them in the copy text and send the copy to them, too.
"RTN","XMXSEC1",155,0)
 ; Function returns 1 if OK; 0 if not OK.
"RTN","XMXSEC1",156,0)
 N XMLIMIT
"RTN","XMXSEC1",157,0)
 S XMLIMIT=$$COPYLIMS
"RTN","XMXSEC1",158,0)
 Q:$P($G(^XMB(3.9,XMZ,1,0)),U,4)'>$P(XMLIMIT,U,1) 1
"RTN","XMXSEC1",159,0)
 D ERRSET^XMXUTIL(37472,$P(XMLIMIT,U,1))
"RTN","XMXSEC1",160,0)
 ;Because this message has more than the site limit of _X_ recipients,
"RTN","XMXSEC1",161,0)
 ;we will neither list them in the text of the copy,
"RTN","XMXSEC1",162,0)
 ;nor will we deliver the copy to them.
"RTN","XMXSEC1",163,0)
 Q 0
"RTN","XMXSEC2")
0^2^B65152384
"RTN","XMXSEC2",1,0)
XMXSEC2 ;ISC-SF/GMB-Message security and restrictions ;01/13/2000  15:07
"RTN","XMXSEC2",2,0)
 ;;7.1;MailMan;**50,89,95,110**;Jun 02, 1994
"RTN","XMXSEC2",3,0)
 ; All entry points covered by DBIA 2733.
"RTN","XMXSEC2",4,0)
EDIT(XMDUZ,XMZ,XMZREC) ; May the user edit the message? (1=may, 0=may not)
"RTN","XMXSEC2",5,0)
 I '$$ORIGIN8R^XMXSEC(XMDUZ,.XMZREC) D ERRSET^XMXUTIL(37405.1) Q 0  ; Only the originator may Edit a message.
"RTN","XMXSEC2",6,0)
 I $P($G(^XMB(3.9,XMZ,1,0)),U,4)>1!($P(XMZREC,U,2)'=$O(^XMB(3.9,XMZ,1,"C",0))) D ERRSET^XMXUTIL(37405.2) Q 0  ; You may not Edit a message you have already sent to someone else.
"RTN","XMXSEC2",7,0)
 I $O(^XMB(3.9,XMZ,3,0)) D ERRSET^XMXUTIL(37405.3) Q 0  ; You may not Edit a message which has a reply.
"RTN","XMXSEC2",8,0)
 I $D(^XMB(3.9,XMZ,"K")),XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") D ERRSET^XMXUTIL(37405.4) ; You may not Edit a secure KIDS or PackMan message.
"RTN","XMXSEC2",9,0)
 Q 1
"RTN","XMXSEC2",10,0)
OPTEDIT(XMINSTR,XMOPT,XMOX) ; We know the user may edit the message.
"RTN","XMXSEC2",11,0)
 ; Now, what, exactly, may be edited?
"RTN","XMXSEC2",12,0)
 D SET("C",$S($G(XMINSTR("FLAGS"))["C":37302,1:37301),.XMOPT,.XMOX) ; UnConfidential (surrogate may read) / Confidential (surrogate can't read)
"RTN","XMXSEC2",13,0)
 D SET("D",$S($D(XMINSTR("RCPT BSKT")):37304,1:37303),.XMOPT,.XMOX) ; Delivery basket remove / Delivery basket set
"RTN","XMXSEC2",14,0)
 D SET("I",$S($G(XMINSTR("FLAGS"))["I":37308,1:37307),.XMOPT,.XMOX) ; UnInformation only / Information only
"RTN","XMXSEC2",15,0)
 D SET("NS",37309,.XMOPT,.XMOX) ; Add Network Signature
"RTN","XMXSEC2",16,0)
 D SET("P",$S($G(XMINSTR("FLAGS"))["P":37312,1:37311),.XMOPT,.XMOX) ; Normal delivery / Priority delivery
"RTN","XMXSEC2",17,0)
 D SET("R",$S($G(XMINSTR("FLAGS"))["R":37314,1:37313),.XMOPT,.XMOX) ; No Confirm receipt / Confirm receipt
"RTN","XMXSEC2",18,0)
 D SET("ES",37305,.XMOPT,.XMOX) ; Edit Subject
"RTN","XMXSEC2",19,0)
 D SET("ET",37306,.XMOPT,.XMOX) ; Edit Text
"RTN","XMXSEC2",20,0)
 D SET("V",$S($G(XMINSTR("VAPOR")):37318,1:37317),.XMOPT,.XMOX) ; Vaporize date remove / Vaporize date set
"RTN","XMXSEC2",21,0)
 D SET("X",$S($G(XMINSTR("FLAGS"))["X":37320,1:37319),.XMOPT,.XMOX) ; UnClose (forward allowed) / Closed (no forward allowed)
"RTN","XMXSEC2",22,0)
 D SET("S",$S($D(^XMB(3.9,XMZ,"K")):37316,$D(XMINSTR("SCR KEY")):37316,1:37315),.XMOPT,.XMOX) ; UnScramble / Scramble message text
"RTN","XMXSEC2",23,0)
 I $G(XMPAKMAN)!($G(XMINSTR("TYPE"))["X")!($G(XMINSTR("TYPE"))["K") D
"RTN","XMXSEC2",24,0)
 . S XMOPT("NS","?")=$$EZBLD^DIALOG(37309.4)
"RTN","XMXSEC2",25,0)
 . S XMOPT("S","?")=$$EZBLD^DIALOG(37315.4)
"RTN","XMXSEC2",26,0)
 I '$D(XMOPT("NS","?")),'$$GOTNS^XMVVITA(XMDUZ) D
"RTN","XMXSEC2",27,0)
 . ; pgmr note: this must be the last place that sets XMOPT("NS","?").
"RTN","XMXSEC2",28,0)
 . S XMOPT("NS","?")=$$EZBLD^DIALOG($S(XMDUZ=DUZ:37309.1,1:37309.3),XMV("NAME")) ; You have/ X has no Network Signature.
"RTN","XMXSEC2",29,0)
 I $D(^TMP("XMY",$J,.6)) D
"RTN","XMXSEC2",30,0)
 . S XMOPT("C","?")=$$EZBLD^DIALOG(37301.6) ; Messages addressed to SHARED,MAIL may not be 'Confidential'.
"RTN","XMXSEC2",31,0)
 . S XMOPT("X","?")=$$EZBLD^DIALOG(37320.6) ; Messages addressed to SHARED,MAIL may not be 'Closed'.
"RTN","XMXSEC2",32,0)
 Q
"RTN","XMXSEC2",33,0)
SET(XMCD,XMDN,XMOPT,XMOX) ;
"RTN","XMXSEC2",34,0)
 N XMDREC
"RTN","XMXSEC2",35,0)
 S XMDREC=$$EZBLD^DIALOG(XMDN)
"RTN","XMXSEC2",36,0)
 S XMOPT(XMCD)=$P(XMDREC,":",2,99)
"RTN","XMXSEC2",37,0)
 S XMOX("O",XMCD)=$P(XMDREC,":",1) ; "O"=original english to foreign
"RTN","XMXSEC2",38,0)
 S XMOX("X",$P(XMDREC,":",1))=XMCD ; "X"=translate foreign to english
"RTN","XMXSEC2",39,0)
 Q
"RTN","XMXSEC2",40,0)
OPTMSG(XMDUZ,XMK,XMZ,XMIM,XMINSTR,XMIU,XMOPT,XMOX) ; The user has access to the message.  Now what may the user do with it?
"RTN","XMXSEC2",41,0)
 ; in:
"RTN","XMXSEC2",42,0)
 ; XMDUZ  = the user
"RTN","XMXSEC2",43,0)
 ; XMK    = basket IEN if message is in a basket
"RTN","XMXSEC2",44,0)
 ;        = 0 otherwise
"RTN","XMXSEC2",45,0)
 ; XMZ    = the message IEN
"RTN","XMXSEC2",46,0)
 ; The following are set by INMSG1 and INMSG2^XMXUTIL2
"RTN","XMXSEC2",47,0)
 ; XMIM("FROM")  = piece 2 of the message's zero node
"RTN","XMXSEC2",48,0)
 ; XMINSTR       = special instructions
"RTN","XMXSEC2",49,0)
 ; XMIU("ORIGN8")=
"RTN","XMXSEC2",50,0)
 ; XMIU("IEN")   = the user's IEN in the message's recipient multiple
"RTN","XMXSEC2",51,0)
 ; out:
"RTN","XMXSEC2",52,0)
 ; XMOPT(<opt>) Possible options
"RTN","XMXSEC2",53,0)
 ; '$D(XMOPT(<opt>,"?")) User may do these things.
"RTN","XMXSEC2",54,0)
 ;  $D(XMOPT(<opt>,"?")) User may NOT do these things.
"RTN","XMXSEC2",55,0)
 N XMSECPAK ;,XMK
"RTN","XMXSEC2",56,0)
 ;S XMK=+$O(^XMB(3.7,"M",XMZ,XMDUZ,0))
"RTN","XMXSEC2",57,0)
 I $D(^XMB(3.9,XMZ,"K")),XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") S XMSECPAK=1 ; secure packman
"RTN","XMXSEC2",58,0)
 E  S XMSECPAK=0
"RTN","XMXSEC2",59,0)
 K XMOPT,XMOX
"RTN","XMXSEC2",60,0)
 D SET("A",37401,.XMOPT,.XMOX) ; Answer
"RTN","XMXSEC2",61,0)
 D SET("AA",37402,.XMOPT,.XMOX) ; Access Attachments
"RTN","XMXSEC2",62,0)
 D SET("B",37441,.XMOPT,.XMOX) ; Backup
"RTN","XMXSEC2",63,0)
 D SET("C",37403,.XMOPT,.XMOX) ; Copy
"RTN","XMXSEC2",64,0)
 D SET("D",37404,.XMOPT,.XMOX) ; Delete
"RTN","XMXSEC2",65,0)
 D SET("E",37405,.XMOPT,.XMOX) ; Edit
"RTN","XMXSEC2",66,0)
 D SET("F",37406,.XMOPT,.XMOX) ; Forward
"RTN","XMXSEC2",67,0)
 D SET("I",37442,.XMOPT,.XMOX) ; Ignore
"RTN","XMXSEC2",68,0)
 D SET("IN",$S($G(XMINSTR("FLAGS"))["I":37409,1:37408),.XMOPT,.XMOX) ; UnInformation only / Information only
"RTN","XMXSEC2",69,0)
 D SET("H",37407,.XMOPT,.XMOX) ; Headerless Print
"RTN","XMXSEC2",70,0)
 D SET("K",$S($G(XMINSTR("FLAGS"))["K":37412,1:37411),.XMOPT,.XMOX) ; UnPriority replies / Priority replies
"RTN","XMXSEC2",71,0)
 D SET("L",37413,.XMOPT,.XMOX) ; Later
"RTN","XMXSEC2",72,0)
 D SET("N",$S($G(XMINSTR("FLAGS"))["N":37415,1:37414),.XMOPT,.XMOX) ; UnNew / New
"RTN","XMXSEC2",73,0)
 D SET("P",37416,.XMOPT,.XMOX) ; Print
"RTN","XMXSEC2",74,0)
 D SET("Q",37417,.XMOPT,.XMOX) ; Query
"RTN","XMXSEC2",75,0)
 D SET("QD",37418,.XMOPT,.XMOX) ; Query Detailed
"RTN","XMXSEC2",76,0)
 D SET("QN",37419,.XMOPT,.XMOX) ; Query Network
"RTN","XMXSEC2",77,0)
 D SET("QR",37420,.XMOPT,.XMOX) ; Query Recipients
"RTN","XMXSEC2",78,0)
 D SET("R",37422,.XMOPT,.XMOX) ; Reply
"RTN","XMXSEC2",79,0)
 D SET("S",37423,.XMOPT,.XMOX) ; Save
"RTN","XMXSEC2",80,0)
 D SET("T",37424,.XMOPT,.XMOX) ; Terminate
"RTN","XMXSEC2",81,0)
 D SET("V",37425,.XMOPT,.XMOX) ; Vaporize date edit
"RTN","XMXSEC2",82,0)
 D SET("W",37444,.XMOPT,.XMOX) ; Write
"RTN","XMXSEC2",83,0)
 D SET("X",$S($G(XMINSTR("TYPE"))["K":37427,$G(XMINSTR("TYPE"))["X":37428,1:37426),.XMOPT,.XMOX) ; Xtract KIDS / Xtract PackMan / Xtract
"RTN","XMXSEC2",84,0)
 I XMDUZ=DUZ!($G(XMV("PRIV"))["W") D
"RTN","XMXSEC2",85,0)
 . D OPTW(XMDUZ,XMZ,XMIM("FROM"),XMIU("ORIGN8"),XMSECPAK,.XMINSTR)
"RTN","XMXSEC2",86,0)
 E  D
"RTN","XMXSEC2",87,0)
 . D OPTWNO^XMXSEC3(XMIU("ORIGN8"))
"RTN","XMXSEC2",88,0)
 D OPTR(XMDUZ,XMK,XMZ,.XMIU,XMSECPAK,.XMINSTR)
"RTN","XMXSEC2",89,0)
 I DUZ=.6 S XMOPT("R","?")=$$EZBLD^DIALOG(37422.6) ; SHARED,MAIL may not Reply to a message.
"RTN","XMXSEC2",90,0)
 I XMDUZ=.6 D DOSHARE^XMXSEC3(XMDUZ,XMK,XMIU("ORIGN8"),.XMINSTR) Q
"RTN","XMXSEC2",91,0)
 I XMDUZ=.5,XMK>999 D DOPOST^XMXSEC3
"RTN","XMXSEC2",92,0)
 Q
"RTN","XMXSEC2",93,0)
OPTW(XMDUZ,XMZ,XMFROM,XMORIGN8,XMSECPAK,XMINSTR) ; User must be self or have 'write' privilege as surrogate.
"RTN","XMXSEC2",94,0)
 I XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") S XMOPT("A","?")=$$EZBLD^DIALOG(37401.4) ; You may not Answer a KIDS or PackMan message.
"RTN","XMXSEC2",95,0)
 I XMINSTR("FLAGS")["X",'XMORIGN8 S XMOPT("C","?")=$$EZBLD^DIALOG(37403.1) ; Only the originator may Copy a 'closed' message.
"RTN","XMXSEC2",96,0)
 I $D(^XMB(3.9,XMZ,"K")) D
"RTN","XMXSEC2",97,0)
 . I XMSECPAK S XMOPT("C","?")=$$EZBLD^DIALOG(37403.4) ; You may not Copy a secure KIDS or PackMan message.
"RTN","XMXSEC2",98,0)
 . E  D
"RTN","XMXSEC2",99,0)
 . . S:'$D(XMOPT("A","?")) XMOPT("A","?")=$$EZBLD^DIALOG(37401.2) ; You may not Answer a scrambled message.  Use Reply.
"RTN","XMXSEC2",100,0)
 . . S:'$D(XMOPT("C","?")) XMOPT("C","?")=$$EZBLD^DIALOG(37403.2) ; You may not Copy a scrambled message.
"RTN","XMXSEC2",101,0)
 I '$D(XMOPT("A","?")),'$$GOTNS^XMVVITA(XMDUZ) D
"RTN","XMXSEC2",102,0)
 . ; pgmr note: this must be the last place that sets XMOPT("A","?").
"RTN","XMXSEC2",103,0)
 . S XMOPT("A","?")=$$EZBLD^DIALOG($S(XMDUZ=DUZ:37401.1,1:37401.3),XMV("NAME")) ; You/X must have a Network Signature to Answer a message.
"RTN","XMXSEC2",104,0)
 I 'XMORIGN8 D  Q
"RTN","XMXSEC2",105,0)
 . S XMOPT("IN","?")=$$EZBLD^DIALOG(37409.1) ; Only the originator may toggle 'Information only'.
"RTN","XMXSEC2",106,0)
 . S XMOPT("E","?")=$$EZBLD^DIALOG(37405.1) ; Only the originator may Edit a message.
"RTN","XMXSEC2",107,0)
 I $P($G(^XMB(3.9,XMZ,1,0)),U,4)>1!(XMFROM'=$O(^XMB(3.9,XMZ,1,"C",0))) D  Q
"RTN","XMXSEC2",108,0)
 . N DIR
"RTN","XMXSEC2",109,0)
 . ; You may not Edit a message you have already sent to someone else.
"RTN","XMXSEC2",110,0)
 . ; You may toggle the 'information only' switch, if you wish.
"RTN","XMXSEC2",111,0)
 . D BLD^DIALOG(37405.2,"","","DIR(""?"")")
"RTN","XMXSEC2",112,0)
 . M XMOPT("E","?")=DIR("?")
"RTN","XMXSEC2",113,0)
 I $O(^XMB(3.9,XMZ,3,0)) S XMOPT("E","?")=$$EZBLD^DIALOG(37405.3) Q  ; You may not Edit a message which has a reply.
"RTN","XMXSEC2",114,0)
 I XMSECPAK S XMOPT("E","?")=$$EZBLD^DIALOG(37405.4) ; You may not Edit a secure KIDS or PackMan message.
"RTN","XMXSEC2",115,0)
 Q
"RTN","XMXSEC2",116,0)
OPTR(XMDUZ,XMK,XMZ,XMIU,XMSECPAK,XMINSTR) ; User must be self or have 'read' privilege as surrogate.
"RTN","XMXSEC2",117,0)
 S:'$O(^XMB(3.9,XMZ,2005,0)) XMOPT("AA","?")=$$EZBLD^DIALOG(37402.1) ; This message has no Attachments.
"RTN","XMXSEC2",118,0)
 I 'XMK D
"RTN","XMXSEC2",119,0)
 . S XMOPT("D","?")=$$EZBLD^DIALOG(37404.1) ; This message has already been deleted.  It's not in a basket.
"RTN","XMXSEC2",120,0)
 . S XMOPT("V","?")=$$EZBLD^DIALOG(37425.1) ; This message has already vaporized.  It's not in a basket.
"RTN","XMXSEC2",121,0)
 I XMINSTR("FLAGS")'["P" S XMOPT("K","?")=$$EZBLD^DIALOG(37412.1) ; The message must be 'priority' in order to toggle 'Priority replies'.
"RTN","XMXSEC2",122,0)
 I XMINSTR("FLAGS")["X",'XMIU("ORIGN8") S XMOPT("F","?")=$$EZBLD^DIALOG(37406.1) ; Only the originator may forward a 'closed' message.
"RTN","XMXSEC2",123,0)
 I XMSECPAK D
"RTN","XMXSEC2",124,0)
 . S XMOPT("P","?")=$$EZBLD^DIALOG(37416.4) ; You may not Print a secure KIDS or PackMan message.
"RTN","XMXSEC2",125,0)
 . S XMOPT("H","?")=XMOPT("P","?")
"RTN","XMXSEC2",126,0)
 . S XMOPT("R","?")=$$EZBLD^DIALOG(37422.4) ; You may not Reply to a secure KIDS or PackMan message.
"RTN","XMXSEC2",127,0)
 E  I 'XMIU("ORIGN8"),XMINSTR("FLAGS")["I" S XMOPT("R","?")=$$EZBLD^DIALOG(37422.1) ; Only the originator may Reply to an 'Information only' message.
"RTN","XMXSEC2",128,0)
 E  I 'XMIU("ORIGN8"),$P($G(^XMB(3.9,XMZ,1,XMIU("IEN"),"T")),U,1)="I" D
"RTN","XMXSEC2",129,0)
 . S XMOPT("R","?")=$$EZBLD^DIALOG(37422.2) ; 'Information only' recipients may not reply to a message.
"RTN","XMXSEC2",130,0)
 I XMINSTR("TYPE")["X"!(XMINSTR("TYPE")["K") D
"RTN","XMXSEC2",131,0)
 . S:'$D(^XUSEC("XUPROGMODE",DUZ)) XMOPT("X","?")=$$EZBLD^DIALOG(37428.2) ; You must hold the XUPROGMODE key to extract KIDS or PackMan messages.
"RTN","XMXSEC2",132,0)
 E  S XMOPT("X","?")=$$EZBLD^DIALOG(37428.1) ; This message is neither KIDS nor PackMan.
"RTN","XMXSEC2",133,0)
 Q
"RTN","XMXSEC3")
0^25^B5676742
"RTN","XMXSEC3",1,0)
XMXSEC3 ;ISC-SF/GMB-XMXSEC2 continued ;12/20/99  10:38
"RTN","XMXSEC3",2,0)
 ;;7.1;MailMan;**110**;Jun 02, 1994
"RTN","XMXSEC3",3,0)
 ; All entry points covered by DBIA 2733.
"RTN","XMXSEC3",4,0)
OPTWNO(XMORIGN8) ; Surrogate does not have 'write' privilege.
"RTN","XMXSEC3",5,0)
 S XMOPT("A","?")=$$EZBLD^DIALOG(37401.5) ; You need 'send' privilege to Answer a message.
"RTN","XMXSEC3",6,0)
 S XMOPT("C","?")=$$EZBLD^DIALOG(37403.5) ; You need 'send' privilege to Copy a message.
"RTN","XMXSEC3",7,0)
 S XMOPT("E","?")=$$EZBLD^DIALOG(37405.5) ; You need 'send' privilege to Edit a message.
"RTN","XMXSEC3",8,0)
 I XMORIGN8 S XMOPT("IN","?")=$$EZBLD^DIALOG(37409.5) ; You need 'send' privilege to toggle 'Information only'.
"RTN","XMXSEC3",9,0)
 E  S XMOPT("IN","?")=$$EZBLD^DIALOG(37409.1) ; Only the originator may toggle 'Information only'.
"RTN","XMXSEC3",10,0)
 S XMOPT("W","?")=$$EZBLD^DIALOG(37444.5) ; You need 'send' privilege to Write (send) a message.
"RTN","XMXSEC3",11,0)
 Q
"RTN","XMXSEC3",12,0)
DOSHARE(XMDUZ,XMK,XMORIGN8,XMINSTR) ;
"RTN","XMXSEC3",13,0)
 N I,XMNO
"RTN","XMXSEC3",14,0)
 S XMNO=$$EZBLD^DIALOG(37462) ; You may not do this in SHARED,MAIL.
"RTN","XMXSEC3",15,0)
 F I="A","E","IN","K","L","N","W","X" S XMOPT(I,"?")=XMNO
"RTN","XMXSEC3",16,0)
 I 'XMORIGN8 D
"RTN","XMXSEC3",17,0)
 . S XMOPT("C","?")=$$EZBLD^DIALOG(37403.6) ; Only the originator may Copy a message in SHARED,MAIL.
"RTN","XMXSEC3",18,0)
 . S XMOPT("F","?")=$$EZBLD^DIALOG(37406.6) ; Only the originator may forward a message from SHARED,MAIL.
"RTN","XMXSEC3",19,0)
 I XMK,$S(XMORIGN8:0,$D(^XUSEC("XMMGR",DUZ)):0,$D(^XMB(3.7,"AB",DUZ,.5)):0,1:1) D
"RTN","XMXSEC3",20,0)
 . ; You must be the originator, hold the XMMGR key,
"RTN","XMXSEC3",21,0)
 . ; or be a POSTMASTER surrogate to do this in SHARED,MAIL.
"RTN","XMXSEC3",22,0)
 . N DIR,I
"RTN","XMXSEC3",23,0)
 . D BLD^DIALOG(37461,"","","DIR(""?"")")
"RTN","XMXSEC3",24,0)
 . F I="D","S","T","V" M XMOPT(I,"?")=DIR("?")
"RTN","XMXSEC3",25,0)
 Q
"RTN","XMXSEC3",26,0)
DOPOST ; You may not do this with messages in the transmit queues.
"RTN","XMXSEC3",27,0)
 N XMNO,I
"RTN","XMXSEC3",28,0)
 S XMNO=$$EZBLD^DIALOG(37251)
"RTN","XMXSEC3",29,0)
 F I="A","AA","B","C","E","IN","H","K","L","N","P","R","S","T","V","W","X" S XMOPT(I,"?")=XMNO
"RTN","XMXSEC3",30,0)
 Q
"VER")
8.0^22.0
**END**
**END**
