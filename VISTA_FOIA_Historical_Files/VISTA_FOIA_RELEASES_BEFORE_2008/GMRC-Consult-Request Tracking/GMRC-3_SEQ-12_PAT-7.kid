Released GMRC*3*7 SEQ #12
Extracted from mail message
**KIDS**:GMRC*3.0*7^

**INSTALL NAME**
GMRC*3.0*7
"BLD",1254,0)
GMRC*3.0*7^CONSULT/REQUEST TRACKING^0^3000505^y
"BLD",1254,1,0)
^^11^11^3000424^^^^
"BLD",1254,1,1,0)
Changes to the Completion Time Statistics and Service Consults By
"BLD",1254,1,2,0)
Status (including Service Consults Pending Resolution) reports.
"BLD",1254,1,3,0)

"BLD",1254,1,4,0)
Do to a problem with KIDS and List Templates the template "GMRC PENDING 
"BLD",1254,1,5,0)
CONSULTS" would not work correctly.  There will be a Post Install routine 
"BLD",1254,1,6,0)
(GMRC7L) that will install the "GMRC PENDING CONSULTS" template.
"BLD",1254,1,7,0)

"BLD",1254,1,8,0)
KIDS will install the other List Template (GMRC REQUEST COMPLETE STAT).
"BLD",1254,1,9,0)
 
"BLD",1254,1,10,0)
A description of the this build can be found on the NATIONAL PATCH MODULE 
"BLD",1254,1,11,0)
UNDER GMRC*3.0*7.
"BLD",1254,4,0)
^9.64PA^^
"BLD",1254,"INID")
^y
"BLD",1254,"INIT")
GMRC7L
"BLD",1254,"KRN",0)
^9.67PA^19^18
"BLD",1254,"KRN",.4,0)
.4
"BLD",1254,"KRN",.401,0)
.401
"BLD",1254,"KRN",.402,0)
.402
"BLD",1254,"KRN",.403,0)
.403
"BLD",1254,"KRN",.5,0)
.5
"BLD",1254,"KRN",.84,0)
.84
"BLD",1254,"KRN",3.6,0)
3.6
"BLD",1254,"KRN",3.8,0)
3.8
"BLD",1254,"KRN",9.2,0)
9.2
"BLD",1254,"KRN",9.8,0)
9.8
"BLD",1254,"KRN",9.8,"NM",0)
^9.68A^12^10
"BLD",1254,"KRN",9.8,"NM",3,0)
GMRCPC^^0^B10209189
"BLD",1254,"KRN",9.8,"NM",4,0)
GMRCST^^0^B6271112
"BLD",1254,"KRN",9.8,"NM",5,0)
GMRCSTU^^0^B57743004
"BLD",1254,"KRN",9.8,"NM",6,0)
GMRCSTLM^^0^B43094602
"BLD",1254,"KRN",9.8,"NM",7,0)
GMRCSTU1^^0^B39143573
"BLD",1254,"KRN",9.8,"NM",8,0)
GMRCSTL1^^0^B8907927
"BLD",1254,"KRN",9.8,"NM",9,0)
GMRCPC1^^0^B11383355
"BLD",1254,"KRN",9.8,"NM",10,0)
GMRCSTL2^^0^B9332990
"BLD",1254,"KRN",9.8,"NM",11,0)
GMRCSUBS^^0^B3817453
"BLD",1254,"KRN",9.8,"NM",12,0)
GMRCSPD^^0^B2608177
"BLD",1254,"KRN",9.8,"NM","B","GMRCPC",3)

"BLD",1254,"KRN",9.8,"NM","B","GMRCPC1",9)

"BLD",1254,"KRN",9.8,"NM","B","GMRCSPD",12)

"BLD",1254,"KRN",9.8,"NM","B","GMRCST",4)

"BLD",1254,"KRN",9.8,"NM","B","GMRCSTL1",8)

"BLD",1254,"KRN",9.8,"NM","B","GMRCSTL2",10)

"BLD",1254,"KRN",9.8,"NM","B","GMRCSTLM",6)

"BLD",1254,"KRN",9.8,"NM","B","GMRCSTU",5)

"BLD",1254,"KRN",9.8,"NM","B","GMRCSTU1",7)

"BLD",1254,"KRN",9.8,"NM","B","GMRCSUBS",11)

"BLD",1254,"KRN",19,0)
19
"BLD",1254,"KRN",19,"NM",0)
^9.68A^17^15
"BLD",1254,"KRN",19,"NM",1,0)
GMRC RPT COMPLETE CONSULTS^^0
"BLD",1254,"KRN",19,"NM",2,0)
GMRC RPT COMPLETE/PENDING^^0
"BLD",1254,"KRN",19,"NM",3,0)
GMRC RPT PENDING CONSULTS^^0^
"BLD",1254,"KRN",19,"NM",5,0)
GMRC RPT NUMBERED CONSULTS^^0
"BLD",1254,"KRN",19,"NM",6,0)
GMRC RPT CONSULTS BY STATUS^^0
"BLD",1254,"KRN",19,"NM",7,0)
GMRC DUPLICATE SUB-SERVICE^^0
"BLD",1254,"KRN",19,"NM",8,0)
GMRC MGR^^3
"BLD",1254,"KRN",19,"NM",9,0)
GMRC PRINT COMPLETION STAT^^0
"BLD",1254,"KRN",19,"NM",10,0)
GMRC PRINT RPT NUMBERED^^0
"BLD",1254,"KRN",19,"NM",11,0)
GMRC NOTIFICATION RECIPS^^0
"BLD",1254,"KRN",19,"NM",12,0)
GMRC NOTIFCATION RECIPS^^1^
"BLD",1254,"KRN",19,"NM",14,0)
GMRC REPORTS^^0
"BLD",1254,"KRN",19,"NM",15,0)
GMRC PROTOCOL DETAILED REPORT^^0
"BLD",1254,"KRN",19,"NM",16,0)
GMRC PROTOCOL LIST^^0
"BLD",1254,"KRN",19,"NM",17,0)
GMRC COMPLETION STATISTICS^^0
"BLD",1254,"KRN",19,"NM","B","GMRC COMPLETION STATISTICS",17)

"BLD",1254,"KRN",19,"NM","B","GMRC DUPLICATE SUB-SERVICE",7)

"BLD",1254,"KRN",19,"NM","B","GMRC MGR",8)

"BLD",1254,"KRN",19,"NM","B","GMRC NOTIFCATION RECIPS",12)

"BLD",1254,"KRN",19,"NM","B","GMRC NOTIFICATION RECIPS",11)

"BLD",1254,"KRN",19,"NM","B","GMRC PRINT COMPLETION STAT",9)

"BLD",1254,"KRN",19,"NM","B","GMRC PRINT RPT NUMBERED",10)

"BLD",1254,"KRN",19,"NM","B","GMRC PROTOCOL DETAILED REPORT",15)

"BLD",1254,"KRN",19,"NM","B","GMRC PROTOCOL LIST",16)

"BLD",1254,"KRN",19,"NM","B","GMRC REPORTS",14)

"BLD",1254,"KRN",19,"NM","B","GMRC RPT COMPLETE CONSULTS",1)

"BLD",1254,"KRN",19,"NM","B","GMRC RPT COMPLETE/PENDING",2)

"BLD",1254,"KRN",19,"NM","B","GMRC RPT CONSULTS BY STATUS",6)

"BLD",1254,"KRN",19,"NM","B","GMRC RPT NUMBERED CONSULTS",5)

"BLD",1254,"KRN",19,"NM","B","GMRC RPT PENDING CONSULTS",3)

"BLD",1254,"KRN",19.1,0)
19.1
"BLD",1254,"KRN",101,0)
101
"BLD",1254,"KRN",101,"NM",0)
^9.68A^24^24
"BLD",1254,"KRN",101,"NM",1,0)
GMRC OUTSTD CONSLTS SELECT SERVICE^^0
"BLD",1254,"KRN",101,"NM",2,0)
GMRC QC OUTSTANDING CONSULTS^^0
"BLD",1254,"KRN",101,"NM",3,0)
GMRC COMPLETE STATISTICS^^0
"BLD",1254,"KRN",101,"NM",4,0)
GMRC COMP STAT SELECT SERVICE^^0
"BLD",1254,"KRN",101,"NM",5,0)
GMRC OUTSTD CONSLTS SELECT STATUS^^0
"BLD",1254,"KRN",101,"NM",6,0)
GMRC OUTSTD CONSLTS SELECT NUMBERED^^0
"BLD",1254,"KRN",101,"NM",7,0)
GMRC COLUMN WIDTH HIDDEN MENU^^0
"BLD",1254,"KRN",101,"NM",8,0)
GMRC COLUMN WIDTH MESSAGE^^0
"BLD",1254,"KRN",101,"NM",9,0)
GMRC COLUMN WIDTH PRINT LIST^^0
"BLD",1254,"KRN",101,"NM",10,0)
VALM NEXT SCREEN^^4^
"BLD",1254,"KRN",101,"NM",11,0)
VALM PREVIOUS SCREEN^^4^
"BLD",1254,"KRN",101,"NM",12,0)
VALM UP ONE LINE^^4^
"BLD",1254,"KRN",101,"NM",13,0)
VALM DOWN A LINE^^4^
"BLD",1254,"KRN",101,"NM",14,0)
VALM REFRESH^^4^
"BLD",1254,"KRN",101,"NM",15,0)
VALM PRINT SCREEN^^4^
"BLD",1254,"KRN",101,"NM",16,0)
VALM RIGHT^^4^
"BLD",1254,"KRN",101,"NM",17,0)
VALM LEFT^^4^
"BLD",1254,"KRN",101,"NM",18,0)
VALM TURN ON/OFF MENUS^^4^
"BLD",1254,"KRN",101,"NM",19,0)
VALM SEARCH LIST^^4^
"BLD",1254,"KRN",101,"NM",20,0)
VALM QUIT^^4^
"BLD",1254,"KRN",101,"NM",21,0)
VALM LAST SCREEN^^4^
"BLD",1254,"KRN",101,"NM",22,0)
VALM FIRST SCREEN^^4^
"BLD",1254,"KRN",101,"NM",23,0)
VALM GOTO PAGE^^4^
"BLD",1254,"KRN",101,"NM",24,0)
VALM PRINT LIST^^4^
"BLD",1254,"KRN",101,"NM","B","GMRC COLUMN WIDTH HIDDEN MENU",7)

"BLD",1254,"KRN",101,"NM","B","GMRC COLUMN WIDTH MESSAGE",8)

"BLD",1254,"KRN",101,"NM","B","GMRC COLUMN WIDTH PRINT LIST",9)

"BLD",1254,"KRN",101,"NM","B","GMRC COMP STAT SELECT SERVICE",4)

"BLD",1254,"KRN",101,"NM","B","GMRC COMPLETE STATISTICS",3)

"BLD",1254,"KRN",101,"NM","B","GMRC OUTSTD CONSLTS SELECT NUMBERED",6)

"BLD",1254,"KRN",101,"NM","B","GMRC OUTSTD CONSLTS SELECT SERVICE",1)

"BLD",1254,"KRN",101,"NM","B","GMRC OUTSTD CONSLTS SELECT STATUS",5)

"BLD",1254,"KRN",101,"NM","B","GMRC QC OUTSTANDING CONSULTS",2)

"BLD",1254,"KRN",101,"NM","B","VALM DOWN A LINE",13)

"BLD",1254,"KRN",101,"NM","B","VALM FIRST SCREEN",22)

"BLD",1254,"KRN",101,"NM","B","VALM GOTO PAGE",23)

"BLD",1254,"KRN",101,"NM","B","VALM LAST SCREEN",21)

"BLD",1254,"KRN",101,"NM","B","VALM LEFT",17)

"BLD",1254,"KRN",101,"NM","B","VALM NEXT SCREEN",10)

"BLD",1254,"KRN",101,"NM","B","VALM PREVIOUS SCREEN",11)

"BLD",1254,"KRN",101,"NM","B","VALM PRINT LIST",24)

"BLD",1254,"KRN",101,"NM","B","VALM PRINT SCREEN",15)

"BLD",1254,"KRN",101,"NM","B","VALM QUIT",20)

"BLD",1254,"KRN",101,"NM","B","VALM REFRESH",14)

"BLD",1254,"KRN",101,"NM","B","VALM RIGHT",16)

"BLD",1254,"KRN",101,"NM","B","VALM SEARCH LIST",19)

"BLD",1254,"KRN",101,"NM","B","VALM TURN ON/OFF MENUS",18)

"BLD",1254,"KRN",101,"NM","B","VALM UP ONE LINE",12)

"BLD",1254,"KRN",409.61,0)
409.61
"BLD",1254,"KRN",409.61,"NM",0)
^9.68A^2^1
"BLD",1254,"KRN",409.61,"NM",2,0)
GMRC REQUEST COMPLETE STAT^^0
"BLD",1254,"KRN",409.61,"NM","B","GMRC REQUEST COMPLETE STAT",2)

"BLD",1254,"KRN",771,0)
771
"BLD",1254,"KRN",869.2,0)
869.2
"BLD",1254,"KRN",870,0)
870
"BLD",1254,"KRN",8994,0)
8994
"BLD",1254,"KRN",8994,"NM",0)
^9.68A^2^2
"BLD",1254,"KRN",8994,"NM",1,0)
GMRCSTLM SERVICE AND STATUS^^0
"BLD",1254,"KRN",8994,"NM",2,0)
GMRCSTU COMPLETION STATISTICS^^0
"BLD",1254,"KRN",8994,"NM","B","GMRCSTLM SERVICE AND STATUS",1)

"BLD",1254,"KRN",8994,"NM","B","GMRCSTU COMPLETION STATISTICS",2)

"BLD",1254,"KRN","B",.4,.4)

"BLD",1254,"KRN","B",.401,.401)

"BLD",1254,"KRN","B",.402,.402)

"BLD",1254,"KRN","B",.403,.403)

"BLD",1254,"KRN","B",.5,.5)

"BLD",1254,"KRN","B",.84,.84)

"BLD",1254,"KRN","B",3.6,3.6)

"BLD",1254,"KRN","B",3.8,3.8)

"BLD",1254,"KRN","B",9.2,9.2)

"BLD",1254,"KRN","B",9.8,9.8)

"BLD",1254,"KRN","B",19,19)

"BLD",1254,"KRN","B",19.1,19.1)

"BLD",1254,"KRN","B",101,101)

"BLD",1254,"KRN","B",409.61,409.61)

"BLD",1254,"KRN","B",771,771)

"BLD",1254,"KRN","B",869.2,869.2)

"BLD",1254,"KRN","B",870,870)

"BLD",1254,"KRN","B",8994,8994)

"BLD",1254,"QUES",0)
^9.62^^
"BLD",1254,"REQB",0)
^9.611^2^2
"BLD",1254,"REQB",1,0)
GMRC*3.0*1^2
"BLD",1254,"REQB",2,0)
GMRC*3.0*14^2
"BLD",1254,"REQB","B","GMRC*3.0*1",1)

"BLD",1254,"REQB","B","GMRC*3.0*14",2)

"INIT")
GMRC7L
"KRN",19,2046,-1)
3^8
"KRN",19,2046,0)
GMRC MGR^Consult Management^^M^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",19,2046,1,0)
^19.06^2^2^3000424^^^^
"KRN",19,2046,1,1,0)
Contains utilities which aid in the management of consultation
"KRN",19,2046,1,2,0)
requests site setup and maintenance.
"KRN",19,2046,10,0)
^19.01IP^17^16
"KRN",19,2046,10,2,0)
4142^RPT^1
"KRN",19,2046,10,2,"^")
GMRC REPORTS
"KRN",19,2046,10,14,0)
7821^NR^28
"KRN",19,2046,10,14,"^")
GMRC NOTIFICATION RECIPS
"KRN",19,2046,10,16,0)
7978^DS
"KRN",19,2046,10,16,"^")
GMRC DUPLICATE SUB-SERVICE
"KRN",19,2046,99)
58183,51684
"KRN",19,2046,99.1)
58197,41060
"KRN",19,2046,"U")
CONSULT MANAGEMENT
"KRN",19,2384,-1)
0^16
"KRN",19,2384,0)
GMRC PROTOCOL LIST^List GMRC Protocols^^R^^^^^^^y^CONSULT/REQUEST TRACKING
"KRN",19,2384,1,0)
^^7^7^2970703^^^^
"KRN",19,2384,1,1,0)
This option is used to list the Name and Item Text of all protocols
"KRN",19,2384,1,2,0)
used by the Consult/Request Tracking Package.  These are all defined
"KRN",19,2384,1,3,0)
with a GMRC prefix.
"KRN",19,2384,1,4,0)
  
"KRN",19,2384,1,5,0)
For a detailed description of these protocols use the "Detailed Report of
"KRN",19,2384,1,6,0)
GMRC Protocols".  The header on the detailed report provides naming
"KRN",19,2384,1,7,0)
convention key for your review.
"KRN",19,2384,25)
EN^GMRCPR
"KRN",19,2384,60)
ORD(101,
"KRN",19,2384,62)
0
"KRN",19,2384,63)
[GMRC PROTOCOL LIST]
"KRN",19,2384,64)
[GMRC PROTOCOLS]
"KRN",19,2384,65)
GMRC
"KRN",19,2384,66)
GMRCZZZ
"KRN",19,2384,"U")
LIST GMRC PROTOCOLS
"KRN",19,2385,-1)
0^15
"KRN",19,2385,0)
GMRC PROTOCOL DETAILED REPORT^Detailed Report of GMRC Protocols^^R^^^^^^^y^CONSULT/REQUEST TRACKING
"KRN",19,2385,1,0)
^^10^10^2970508^^^^
"KRN",19,2385,1,1,0)
This option provides a report listing detailed information about the
"KRN",19,2385,1,2,0)
GMRC* protocols used in the Consult/Request Package.
"KRN",19,2385,1,3,0)
  
"KRN",19,2385,1,4,0)
The descriptions should be reviewed BEFORE EVER MAKING changes to
"KRN",19,2385,1,5,0)
the GMRC protocols.  Certain GMRC Protocols should NOT be altered.
"KRN",19,2385,1,6,0)
The descriptions will indicate which protocols have this requirement.
"KRN",19,2385,1,7,0)
  
"KRN",19,2385,1,8,0)
The key in the header describes the naming conventions used to define
"KRN",19,2385,1,9,0)
the GMRC protocols.  Please adhere to these guidelines as you add
"KRN",19,2385,1,10,0)
site specific protocols to be used by the GMRC package.
"KRN",19,2385,25)
EN^GMRCPP
"KRN",19,2385,60)
ORD(101,
"KRN",19,2385,62)
0
"KRN",19,2385,63)
[GMRC PROTOCOL RPT]
"KRN",19,2385,64)
[GMRC PROTOCOLS]
"KRN",19,2385,65)
GMRC
"KRN",19,2385,66)
GMRCZZZ
"KRN",19,2385,"U")
DETAILED REPORT OF GMRC PROTOC
"KRN",19,4141,-1)
0^3
"KRN",19,4141,0)
GMRC RPT PENDING CONSULTS^Service Consults Pending Resolution^^R^^^^^^^^CONSULT/REQUEST TRACKING^^1
"KRN",19,4141,20)
S GMRCSTAT="3,4,5,6,8,9,11,99"
"KRN",19,4141,25)
EN^GMRCPC
"KRN",19,4141,"U")
SERVICE CONSULTS PENDING RESOL
"KRN",19,4142,-1)
0^14
"KRN",19,4142,0)
GMRC REPORTS^Consult Tracking Reports^^M^^^^^^^^
"KRN",19,4142,10,0)
^19.01IP^12^11
"KRN",19,4142,10,1,0)
2384^
"KRN",19,4142,10,1,"^")
GMRC PROTOCOL LIST
"KRN",19,4142,10,2,0)
2385^
"KRN",19,4142,10,2,"^")
GMRC PROTOCOL DETAILED REPORT
"KRN",19,4142,10,3,0)
4141^PC^5
"KRN",19,4142,10,3,"^")
GMRC RPT PENDING CONSULTS
"KRN",19,4142,10,5,0)
5452^ST^3
"KRN",19,4142,10,5,"^")
GMRC COMPLETION STATISTICS
"KRN",19,4142,10,6,0)
7799^CP
"KRN",19,4142,10,6,"^")
GMRC RPT COMPLETE/PENDING
"KRN",19,4142,10,7,0)
7800^CC
"KRN",19,4142,10,7,"^")
GMRC RPT COMPLETE CONSULTS
"KRN",19,4142,10,8,0)
7957^SC
"KRN",19,4142,10,8,"^")
GMRC RPT CONSULTS BY STATUS
"KRN",19,4142,10,9,0)
7962^NU
"KRN",19,4142,10,9,"^")
GMRC RPT NUMBERED CONSULTS
"KRN",19,4142,10,10,0)
7987
"KRN",19,4142,10,10,"^")
GMRC PRINT COMPLETION STAT
"KRN",19,4142,10,11,0)
7988
"KRN",19,4142,10,11,"^")
GMRC PRINT RPT NUMBERED
"KRN",19,4142,99)
58199,41260
"KRN",19,4142,"U")
CONSULT TRACKING REPORTS
"KRN",19,5452,-1)
0^17
"KRN",19,5452,0)
GMRC COMPLETION STATISTICS^Completion Time Statistics^^R^^^^^^^^CONSULT/REQUEST TRACKING^^
"KRN",19,5452,1,0)
^19.06^5^5^3000314^^^^
"KRN",19,5452,1,1,0)
Collect and display (vis List Manager) the mean number of days that
"KRN",19,5452,1,2,0)
consults/requests take to be filled, from the time that they are
"KRN",19,5452,1,3,0)
accepted by the service to the time that they are entered as Complete
"KRN",19,5452,1,4,0)
in the computer.  Also lists the Standard Deviation and number of
"KRN",19,5452,1,5,0)
consults that were found for a date range.
"KRN",19,5452,10.1)
Completion Time Statistics
"KRN",19,5452,20)

"KRN",19,5452,25)
EN^GMRCST
"KRN",19,5452,"U")
COMPLETION TIME STATISTICS
"KRN",19,7799,-1)
0^2
"KRN",19,7799,0)
GMRC RPT COMPLETE/PENDING^Service Consults Completed or Pending Resolution^^R^^^^^^^^CONSULT/REQUEST TRACKING^^1
"KRN",19,7799,20)
S GMRCSTAT="2,3,4,5,6,8,9,11,99"
"KRN",19,7799,25)
EN^GMRCPC
"KRN",19,7799,"U")
SERVICE CONSULTS COMPLETED OR 
"KRN",19,7800,-1)
0^1
"KRN",19,7800,0)
GMRC RPT COMPLETE CONSULTS^Service Consults Completed^^R^^^^^^^^CONSULT/REQUEST TRACKING^^1
"KRN",19,7800,20)
S GMRCSTAT="2"
"KRN",19,7800,25)
EN^GMRCPC
"KRN",19,7800,"U")
SERVICE CONSULTS COMPLETED
"KRN",19,7821,-1)
0^11
"KRN",19,7821,0)
GMRC NOTIFICATION RECIPS^Determine notification recipients for a service^^R^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",19,7821,25)
EN^GMRCNOTF
"KRN",19,7821,"U")
DETERMINE NOTIFICATION RECIPIE
"KRN",19,7957,-1)
0^6
"KRN",19,7957,0)
GMRC RPT CONSULTS BY STATUS^Service Consults By Status^^R^^^^^^^^CONSULT/REQUEST TRACKING^^
"KRN",19,7957,20)

"KRN",19,7957,25)
ENSTS^GMRCPC1
"KRN",19,7957,"U")
SERVICE CONSULTS BY STATUS
"KRN",19,7962,-1)
0^5
"KRN",19,7962,0)
GMRC RPT NUMBERED CONSULTS^Service Consults with Consults Numbers^^R^^^^^^^^CONSULT/REQUEST TRACKING^^1
"KRN",19,7962,20)
S GMRCCTRL=120
"KRN",19,7962,25)
ENSTS^GMRCPC1
"KRN",19,7962,"U")
SERVICE CONSULTS WITH CONSULTS
"KRN",19,7978,-1)
0^7
"KRN",19,7978,0)
GMRC DUPLICATE SUB-SERVICE^Duplicate Sub-Service^^R^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",19,7978,1,0)
^^2^2^3000118^
"KRN",19,7978,1,1,0)
This check if any Consult/Request Tracking REQUEST SERVICES (file #123.5)
"KRN",19,7978,1,2,0)
are Sub-Services of more than one Service.
"KRN",19,7978,25)
EN^GMRCSUBS
"KRN",19,7978,"U")
DUPLICATE SUB-SERVICE
"KRN",19,7987,-1)
0^9
"KRN",19,7987,0)
GMRC PRINT COMPLETION STAT^Print Completion Time Statistics Report^^R^^^^^^^^
"KRN",19,7987,1,0)
^19.06^3^3^3000314^^
"KRN",19,7987,1,1,0)
Sends the Completion Time Statistics report to a device without going
"KRN",19,7987,1,2,0)
throuh the List Manager display of the report and waiting for the list to
"KRN",19,7987,1,3,0)
be built.
"KRN",19,7987,25)
PRNTONLY^GMRCST
"KRN",19,7987,"U")
PRINT COMPLETION TIME STATISTI
"KRN",19,7988,-1)
0^10
"KRN",19,7988,0)
GMRC PRINT RPT NUMBERED^Print Service Consults by Status^^R^^^^^^^^^^
"KRN",19,7988,1,0)
^19.06^3^3^3000314^^
"KRN",19,7988,1,1,0)
Sends the Service Consults By Status report to a device without going
"KRN",19,7988,1,2,0)
throuh the List Manager display of the report and waiting for the list to
"KRN",19,7988,1,3,0)
be built.
"KRN",19,7988,20)

"KRN",19,7988,25)
PRNTONLY^GMRCPC(120)
"KRN",19,7988,"U")
PRINT SERVICE CONSULTS BY STAT
"KRN",19,8073,-1)
1^12
"KRN",19,8073,0)
GMRC NOTIFCATION RECIPS
"KRN",101,2759,-1)
4^10
"KRN",101,2759,0)
VALM NEXT SCREEN
"KRN",101,2760,-1)
4^11
"KRN",101,2760,0)
VALM PREVIOUS SCREEN
"KRN",101,2761,-1)
4^14
"KRN",101,2761,0)
VALM REFRESH
"KRN",101,2762,-1)
4^21
"KRN",101,2762,0)
VALM LAST SCREEN
"KRN",101,2763,-1)
4^22
"KRN",101,2763,0)
VALM FIRST SCREEN
"KRN",101,2764,-1)
4^12
"KRN",101,2764,0)
VALM UP ONE LINE
"KRN",101,2765,-1)
4^13
"KRN",101,2765,0)
VALM DOWN A LINE
"KRN",101,2767,-1)
4^20
"KRN",101,2767,0)
VALM QUIT
"KRN",101,2768,-1)
4^15
"KRN",101,2768,0)
VALM PRINT SCREEN
"KRN",101,2769,-1)
4^24
"KRN",101,2769,0)
VALM PRINT LIST
"KRN",101,2771,-1)
4^18
"KRN",101,2771,0)
VALM TURN ON/OFF MENUS
"KRN",101,2773,-1)
4^19
"KRN",101,2773,0)
VALM SEARCH LIST
"KRN",101,2780,-1)
4^16
"KRN",101,2780,0)
VALM RIGHT
"KRN",101,2781,-1)
4^17
"KRN",101,2781,0)
VALM LEFT
"KRN",101,2783,-1)
4^23
"KRN",101,2783,0)
VALM GOTO PAGE
"KRN",101,3739,-1)
0^2
"KRN",101,3739,0)
GMRC QC OUTSTANDING CONSULTS^Print Outstanding Consults By Service^^M^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",101,3739,1,0)
^^3^3^3000202^^^^
"KRN",101,3739,1,1,0)
List Manager Protocol to print outstanding consults by service for QC
"KRN",101,3739,1,2,0)
purposes.  In this option, ALL SERVICES is not allowed to be entered
"KRN",101,3739,1,3,0)
at the SERVICE: prompt.
"KRN",101,3739,2,0)
^101.02A^^0
"KRN",101,3739,4)
18
"KRN",101,3739,10,0)
^101.01PA^4^4
"KRN",101,3739,10,1,0)
3740^^1^
"KRN",101,3739,10,1,1)

"KRN",101,3739,10,1,"^")
GMRC OUTSTD CONSLTS SELECT SERVICE
"KRN",101,3739,10,2,0)
5548^^2^
"KRN",101,3739,10,2,1)

"KRN",101,3739,10,2,"^")
GMRC OUTSTD CONSLTS SELECT STATUS
"KRN",101,3739,10,3,0)
5596^^4^
"KRN",101,3739,10,3,"^")
GMRC COLUMN WIDTH PRINT LIST
"KRN",101,3739,10,4,0)
5549^^3^
"KRN",101,3739,10,4,"^")
GMRC OUTSTD CONSLTS SELECT NUMBERED
"KRN",101,3739,15)

"KRN",101,3739,20)

"KRN",101,3739,26)
D SHOW^VALM
"KRN",101,3739,99)
58106,35391
"KRN",101,3740,-1)
0^1
"KRN",101,3740,0)
GMRC OUTSTD CONSLTS SELECT SERVICE^Service^^A^^^^^^^^
"KRN",101,3740,1,0)
^^2^2^2991202^^^^
"KRN",101,3740,1,1,0)
List Manager Protocol:  Select a new service for displaying consults
"KRN",101,3740,1,2,0)
still pending resolution (all consults not discontinued or complete.)
"KRN",101,3740,2,0)
^101.02A^1^1
"KRN",101,3740,2,1,0)
SS
"KRN",101,3740,2,"B","SS",1)

"KRN",101,3740,4)
24^2
"KRN",101,3740,15)
S VALMBCK="R"
"KRN",101,3740,20)
D EN^GMRCSTLM Q:$D(GMRCQUT)  D ENORLM^GMRCSTLM,INIT^GMRCPC,HDR^GMRCPC S VALMBG=1
"KRN",101,3740,99)
58044,59686
"KRN",101,4404,-1)
0^3
"KRN",101,4404,0)
GMRC COMPLETE STATISTICS^List Manager Protocol. Days To Complete Consult Statistics.^^M^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",101,4404,1,0)
^^7^7^2980528^^^^
"KRN",101,4404,1,1,0)
List Manager Protocol.  Uses List Template 'GMRC COMPLETE STATS' List
"KRN",101,4404,1,2,0)
Manager template.  This protocol is used to display Statistics pertaining
"KRN",101,4404,1,3,0)
to how long a service takes to complete a consult/request, from the time
"KRN",101,4404,1,4,0)
that the consult/request is accepted by the service to the time it is
"KRN",101,4404,1,5,0)
completed.  Also gives Mean and Standard Deviation statistics.  I broken
"KRN",101,4404,1,6,0)
out by Total Consults completed, Inpatient Consults Completed, and
"KRN",101,4404,1,7,0)
Outpatient Consults Completed.
"KRN",101,4404,4)
26^4
"KRN",101,4404,10,0)
^101.01PA^2^2
"KRN",101,4404,10,2,0)
5426^SS^1^
"KRN",101,4404,10,2,"^")
GMRC COMP STAT SELECT SERVICE
"KRN",101,4404,20)
Q:$D(GMRCQUT)
"KRN",101,4404,26)
D SHOW^VALM
"KRN",101,4404,99)
57953,53069
"KRN",101,5426,-1)
0^4
"KRN",101,5426,0)
GMRC COMP STAT SELECT SERVICE^Select Service^^A^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",101,5426,1,0)
^^4^4^2990910^^^
"KRN",101,5426,1,1,0)
List Manager Protocol:  Select a new service for displaying 
"KRN",101,5426,1,2,0)
consults Statistics pertaining to how long a service takes to 
"KRN",101,5426,1,3,0)
complete a consult/request, from the time that the consult/request 
"KRN",101,5426,1,4,0)
is accepted by the service to the time it is completed.
"KRN",101,5426,2,0)
^101.02A^1^1
"KRN",101,5426,2,1,0)
SS
"KRN",101,5426,2,"B","SS",1)

"KRN",101,5426,15)
S VALMBCK="R"
"KRN",101,5426,20)
D EN^GMRCSTU,ODT^GMRCSTU,INIT^GMRCST,HDR^GMRCST S VALMBG=1
"KRN",101,5426,21,0)
^101.021A^^0
"KRN",101,5426,99)
57912,42566
"KRN",101,5548,-1)
0^5
"KRN",101,5548,0)
GMRC OUTSTD CONSLTS SELECT STATUS^Status^^A^^^^^^^^
"KRN",101,5548,1,0)
^^2^2^2991201^
"KRN",101,5548,1,1,0)
List Manager Protocol:  Select a list of statuses for displaying consults
"KRN",101,5548,1,2,0)
still pending resolution (all consults not discontinued or complete.)
"KRN",101,5548,2,0)
^101.02A^2^1
"KRN",101,5548,2,2,0)
ST
"KRN",101,5548,2,"B","ST",2)

"KRN",101,5548,4)
24^2^^
"KRN",101,5548,15)
S VALMBCK="R"
"KRN",101,5548,20)
D NEWSTS^GMRCPC1 Q:$D(GMRCQUT)  D ENORLM^GMRCSTLM,INIT^GMRCPC,HDR^GMRCPC S VALMBG=1
"KRN",101,5548,99)
58044,59703
"KRN",101,5549,-1)
0^6
"KRN",101,5549,0)
GMRC OUTSTD CONSLTS SELECT NUMBERED^Number on/off^^A^^^^^^^^
"KRN",101,5549,1,0)
^^2^2^2991203^
"KRN",101,5549,1,1,0)
List Manager Protocol:  Togles on and off the display of the consult
"KRN",101,5549,1,2,0)
number in the report.
"KRN",101,5549,2,0)
^101.02A^^0
"KRN",101,5549,4)
24^2
"KRN",101,5549,15)
S VALMBCK="R"
"KRN",101,5549,20)
D NUMBER^GMRCPC1 Q:$D(GMRCQUT)  D ENORLM^GMRCSTLM,INIT^GMRCPC,HDR^GMRCPC S VALMBG=1
"KRN",101,5549,99)
58045,42959
"KRN",101,5596,-1)
0^9
"KRN",101,5596,0)
GMRC COLUMN WIDTH PRINT LIST^Print List^^X^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",101,5596,10,0)
^101.01PA^3^2
"KRN",101,5596,10,2,0)
2769^^2^
"KRN",101,5596,10,2,"^")
VALM PRINT LIST
"KRN",101,5596,10,3,0)
5597^^1^
"KRN",101,5596,10,3,"^")
GMRC COLUMN WIDTH MESSAGE
"KRN",101,5596,20)

"KRN",101,5596,99)
58108,39509
"KRN",101,5597,-1)
0^8
"KRN",101,5597,0)
GMRC COLUMN WIDTH MESSAGE^COLUMN WIDTH PRINT OUT^^A^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",101,5597,10,0)
^101.01PA^^0
"KRN",101,5597,20)
D PWIDTH^GMRCPC($G(GMRCCTRL))
"KRN",101,5597,99)
58108,39509
"KRN",101,5598,-1)
0^7
"KRN",101,5598,0)
GMRC COLUMN WIDTH HIDDEN MENU^COLUMN WIDTH HIDDEN MENU^^M^^^^^^^^LIST MANAGER
"KRN",101,5598,4)
26
"KRN",101,5598,10,0)
^101.01PA^15^15
"KRN",101,5598,10,1,0)
2759^+^11^
"KRN",101,5598,10,1,"^")
VALM NEXT SCREEN
"KRN",101,5598,10,2,0)
2760^-^12^
"KRN",101,5598,10,2,"^")
VALM PREVIOUS SCREEN
"KRN",101,5598,10,3,0)
2764^UP^13^
"KRN",101,5598,10,3,"^")
VALM UP ONE LINE
"KRN",101,5598,10,4,0)
2765^DN^14^
"KRN",101,5598,10,4,"^")
VALM DOWN A LINE
"KRN",101,5598,10,5,0)
2761^RD^24^
"KRN",101,5598,10,5,"^")
VALM REFRESH
"KRN",101,5598,10,6,0)
2768^PS^25^
"KRN",101,5598,10,6,"^")
VALM PRINT SCREEN
"KRN",101,5598,10,7,0)
5596^PL^26^
"KRN",101,5598,10,7,"^")
GMRC COLUMN WIDTH PRINT LIST
"KRN",101,5598,10,8,0)
2780^>^15^
"KRN",101,5598,10,8,"^")
VALM RIGHT
"KRN",101,5598,10,9,0)
2781^<^16^
"KRN",101,5598,10,9,"^")
VALM LEFT
"KRN",101,5598,10,10,0)
2771^ADPL^32^
"KRN",101,5598,10,10,"^")
VALM TURN ON/OFF MENUS
"KRN",101,5598,10,11,0)
2773^SL^31^
"KRN",101,5598,10,11,"^")
VALM SEARCH LIST
"KRN",101,5598,10,12,0)
2767^Q^33^
"KRN",101,5598,10,12,"^")
VALM QUIT
"KRN",101,5598,10,13,0)
2762^LS^22^
"KRN",101,5598,10,13,"^")
VALM LAST SCREEN
"KRN",101,5598,10,14,0)
2763^FS^21^
"KRN",101,5598,10,14,"^")
VALM FIRST SCREEN
"KRN",101,5598,10,15,0)
2783^GO^23^
"KRN",101,5598,10,15,"^")
VALM GOTO PAGE
"KRN",101,5598,99)
58108,39575
"KRN",409.61,539,-1)
0^2
"KRN",409.61,539,0)
GMRC REQUEST COMPLETE STAT^1^^80^5^20^1^1^DAYS TO COMPLETE CONSULT STATS^GMRC COMPLETE STATISTICS^DAYS TO COMPLETE CONSULT STATS^1^^1
"KRN",409.61,539,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,539,"ARRAY")
 ^TMP("GMRCR",$J,"PRL")
"KRN",409.61,539,"COL",0)
^409.621
"KRN",409.61,539,"FNL")
D KILL^VALM10(),CLEAR^VALM1,EXIT^GMRCST
"KRN",409.61,539,"HDR")
D HDR^GMRCST
"KRN",409.61,539,"HLP")
D HELP^GMRCST
"KRN",409.61,539,"INIT")
D INIT^GMRCST
"KRN",8994,1185,-1)
0^1
"KRN",8994,1185,0)
GMRCSTLM SERVICE AND STATUS^ENOR^GMRCSTLM^4^A
"KRN",8994,1185,1,0)
^8994.01^2^2^3000505^^^^
"KRN",8994,1185,1,1,0)
This returns a report of consults for a service/grouper for a
"KRN",8994,1185,1,2,0)
given set of statuses and date range.
"KRN",8994,1185,2,0)
^8994.02A^5^5
"KRN",8994,1185,2,1,0)
SERVICE^4^^0^1
"KRN",8994,1185,2,1,1,0)
^^2^2^2990909^
"KRN",8994,1185,2,1,1,1,0)
The service or grouper to create the list for.  The default if none is
"KRN",8994,1185,2,1,1,2,0)
passed is "1" for ALL SERVICES.
"KRN",8994,1185,2,2,0)
START DATE^1^7^0^2
"KRN",8994,1185,2,2,1,0)
^^2^2^2990909^
"KRN",8994,1185,2,2,1,1,0)
This is the start date range for the report or "ALL" for all dates.  The
"KRN",8994,1185,2,2,1,2,0)
default if none is passed is "ALL" and the END DATE will not be used.
"KRN",8994,1185,2,3,0)
END DATE^1^7^0^3
"KRN",8994,1185,2,3,1,0)
^^2^2^2990909^^
"KRN",8994,1185,2,3,1,1,0)
This is the ending date range for the report.  Not used if the START DATE
"KRN",8994,1185,2,3,1,2,0)
is "ALL" for all dates.
"KRN",8994,1185,2,4,0)
STATUSES^1^^0^4
"KRN",8994,1185,2,4,1,0)
^^3^3^2990916^^^
"KRN",8994,1185,2,4,1,1,0)
This is a comma separated list of the statuses to include in the report.
"KRN",8994,1185,2,4,1,2,0)
If none is passed the default list is "3,4,5,6,8,9,11,99" which is all the
"KRN",8994,1185,2,4,1,3,0)
status that are pending resolution.
"KRN",8994,1185,2,5,0)
LIST CONTROL^1^1^0^5
"KRN",8994,1185,2,5,1,0)
^8994.021^9^9^3000505^^
"KRN",8994,1185,2,5,1,1,0)
   0, null or not define then just the display list is displayed
"KRN",8994,1185,2,5,1,2,0)
   1 then the list will be two pieces with the first being the ien of the
"KRN",8994,1185,2,5,1,3,0)
        consult for selection in the gui and the second piece being the
"KRN",8994,1185,2,5,1,4,0)
        display text.
"KRN",8994,1185,2,5,1,5,0)
  10 then the consults will have a line number on them for selection
"KRN",8994,1185,2,5,1,6,0)
  20 then the consults will have the consult number displayed
"KRN",8994,1185,2,5,1,7,0)
 100 then use abbreviations for the statuses
"KRN",8994,1185,2,5,1,8,0)
 
"KRN",8994,1185,2,5,1,9,0)
1, (10 or 20) and 100 can be added together to add there features
"KRN",8994,1185,2,"B","END DATE",3)

"KRN",8994,1185,2,"B","LIST CONTROL",5)

"KRN",8994,1185,2,"B","SERVICE",1)

"KRN",8994,1185,2,"B","START DATE",2)

"KRN",8994,1185,2,"B","STATUSES",4)

"KRN",8994,1185,2,"PARAMSEQ",1,1)

"KRN",8994,1185,2,"PARAMSEQ",2,2)

"KRN",8994,1185,2,"PARAMSEQ",3,3)

"KRN",8994,1185,2,"PARAMSEQ",4,4)

"KRN",8994,1185,2,"PARAMSEQ",5,5)

"KRN",8994,1187,-1)
0^2
"KRN",8994,1187,0)
GMRCSTU COMPLETION STATISTICS^ENOR^GMRCSTU^4^A
"KRN",8994,1187,1,0)
^^2^2^2990916^
"KRN",8994,1187,1,1,0)
This returns a report of completion time statistics for a consult
"KRN",8994,1187,1,2,0)
service/grouper for a given set of statuses and date range.
"KRN",8994,1187,2,0)
^8994.02A^3^3
"KRN",8994,1187,2,1,0)
SERVICE^4^^0^1
"KRN",8994,1187,2,1,1,0)
^^2^2^2990916^^
"KRN",8994,1187,2,1,1,1,0)
The service or grouper to create the list for.  The default if none is
"KRN",8994,1187,2,1,1,2,0)
passed is "1" for ALL SERVICES.
"KRN",8994,1187,2,2,0)
START DATE^1^7^0^2
"KRN",8994,1187,2,2,1,0)
^^2^2^2990916^^
"KRN",8994,1187,2,2,1,1,0)
This is the start date range for the report or "ALL" for all dates.  The
"KRN",8994,1187,2,2,1,2,0)
default if none is passed is "ALL" and the END DATE will not be used.
"KRN",8994,1187,2,3,0)
END DATE^1^7^0^3
"KRN",8994,1187,2,3,1,0)
^^2^2^2990916^^^
"KRN",8994,1187,2,3,1,1,0)
This is the ending date range for the report.  Not used if the START DATE
"KRN",8994,1187,2,3,1,2,0)
is "ALL" for all dates.
"KRN",8994,1187,2,"B","END DATE",3)

"KRN",8994,1187,2,"B","SERVICE",1)

"KRN",8994,1187,2,"B","START DATE",2)

"KRN",8994,1187,2,"PARAMSEQ",1,1)

"KRN",8994,1187,2,"PARAMSEQ",2,2)

"KRN",8994,1187,2,"PARAMSEQ",3,3)

"MBREQ")
0
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",17,409.61)
409.61;17;1;;;;;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",128,-1)
1^1
"PKG",128,0)
CONSULT/REQUEST TRACKING^GMRC^CONSULTS/REQUESTS
"PKG",128,20,0)
^9.402P^^
"PKG",128,22,0)
^9.49I^1^1
"PKG",128,22,1,0)
3.0^2980101
"PKG",128,22,1,"PAH",1,0)
7^3000505
"PKG",128,22,1,"PAH",1,1,0)
^^11^11^3000505
"PKG",128,22,1,"PAH",1,1,1,0)
Changes to the Completion Time Statistics and Service Consults By
"PKG",128,22,1,"PAH",1,1,2,0)
Status (including Service Consults Pending Resolution) reports.
"PKG",128,22,1,"PAH",1,1,3,0)

"PKG",128,22,1,"PAH",1,1,4,0)
Do to a problem with KIDS and List Templates the template "GMRC PENDING 
"PKG",128,22,1,"PAH",1,1,5,0)
CONSULTS" would not work correctly.  There will be a Post Install routine 
"PKG",128,22,1,"PAH",1,1,6,0)
(GMRC7L) that will install the "GMRC PENDING CONSULTS" template.
"PKG",128,22,1,"PAH",1,1,7,0)

"PKG",128,22,1,"PAH",1,1,8,0)
KIDS will install the other List Template (GMRC REQUEST COMPLETE STAT).
"PKG",128,22,1,"PAH",1,1,9,0)
 
"PKG",128,22,1,"PAH",1,1,10,0)
A description of the this build can be found on the NATIONAL PATCH MODULE 
"PKG",128,22,1,"PAH",1,1,11,0)
UNDER GMRC*3.0*7.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
11
"RTN","GMRC7L")
0^^B2461198
"RTN","GMRC7L",1,0)
GMRC7L ; List Template Exporter ; 21-APR-2000
"RTN","GMRC7L",2,0)
 ;; ;
"RTN","GMRC7L",3,0)
 W !,"'GMRC PENDING CONSULTS' List Template..."
"RTN","GMRC7L",4,0)
 S DA=$O(^SD(409.61,"B","GMRC PENDING CONSULTS",0)),DIK="^SD(409.61," D ^DIK:DA
"RTN","GMRC7L",5,0)
 K DO,DD S DIC(0)="L",DIC="^SD(409.61,",X="GMRC PENDING CONSULTS" D FILE^DICN S VALM=+Y
"RTN","GMRC7L",6,0)
 I VALM>0 D
"RTN","GMRC7L",7,0)
 .S ^SD(409.61,VALM,0)="GMRC PENDING CONSULTS^1^1^102^5^20^1^1^^GMRC QC OUTSTANDING CONSULTS^Service Consults by Status^1^^1"
"RTN","GMRC7L",8,0)
 .S ^SD(409.61,VALM,1)="^GMRC COLUMN WIDTH HIDDEN MENU"
"RTN","GMRC7L",9,0)
 .S ^SD(409.61,VALM,"ARRAY")=" ^TMP(""GMRCR"",$J,""CP"")"
"RTN","GMRC7L",10,0)
 .S ^SD(409.61,VALM,"COL",0)="^409.621^1^1"
"RTN","GMRC7L",11,0)
 .S ^SD(409.61,VALM,"COL",1,0)="CAPTION LINE^2^79^"
"RTN","GMRC7L",12,0)
 .S ^SD(409.61,VALM,"FNL")="D KILL^VALM10(),CLEAR^VALM1,EXIT^GMRCPC"
"RTN","GMRC7L",13,0)
 .S ^SD(409.61,VALM,"HDR")="D HDR^GMRCPC"
"RTN","GMRC7L",14,0)
 .S ^SD(409.61,VALM,"HLP")="D HELP^GMRCPC"
"RTN","GMRC7L",15,0)
 .S ^SD(409.61,VALM,"INIT")="D ENORLM^GMRCSTLM"
"RTN","GMRC7L",16,0)
 .S DA=VALM,DIK="^SD(409.61," D IX1^DIK K DA,DIK
"RTN","GMRC7L",17,0)
 .W "Filed."
"RTN","GMRC7L",18,0)
 ;
"RTN","GMRC7L",19,0)
 K DIC,DIK,VALM,X,DA
"RTN","GMRC7L",20,0)
 ; Do to being only to have only one post-install routine I am
"RTN","GMRC7L",21,0)
 ; changing the post-install Denis had orginally added in
"RTN","GMRC7L",22,0)
 ; "POST^GMRCSUBS" and replacing it with GMRC7L that will update
"RTN","GMRC7L",23,0)
 ; the List Template global and also run Denis's post-install.
"RTN","GMRC7L",24,0)
 D POST^GMRCSUBS
"RTN","GMRC7L",25,0)
 Q
"RTN","GMRCPC")
0^3^B10209189
"RTN","GMRCPC",1,0)
GMRCPC ;SLC/DCM,dee - List Manager Routine: Collect and display consults by service and status ;02/03/00
"RTN","GMRCPC",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,7**;DEC 27, 1997
"RTN","GMRCPC",3,0)
EN ;GMRC List Manager Routine -- main entry point for GMRC PENDING CONSULTS
"RTN","GMRCPC",4,0)
 K GMRCSVC,GMRCSVCP
"RTN","GMRCPC",5,0)
 I $D(GMRCEACT),$L(GMRCEACT) D  I '$D(^GMR(123.5,$G(GMRCSVC),0)) D EXIT Q
"RTN","GMRCPC",6,0)
 .S GMRCSVCP=GMRCEACT
"RTN","GMRCPC",7,0)
 .S GMRCSVC=$O(^GMR(123.5,"B",GMRCSVCP,0))
"RTN","GMRCPC",8,0)
 .Q:'$D(^GMR(123.5,$G(GMRCSVC),0))
"RTN","GMRCPC",9,0)
 .;Build service array
"RTN","GMRCPC",10,0)
 .S GMRCDG=GMRCSVC
"RTN","GMRCPC",11,0)
 .D SERV1^GMRCASV
"RTN","GMRCPC",12,0)
 .S GMRCDT1="ALL"
"RTN","GMRCPC",13,0)
 .S GMRCDT2=0
"RTN","GMRCPC",14,0)
 .D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCPC",15,0)
 ;If no service ask for one
"RTN","GMRCPC",16,0)
 I '$L($G(GMRCSVC)) D EN^GMRCSTLM I $D(GMRCQUT) D EXIT Q
"RTN","GMRCPC",17,0)
 ;Quit if no array of services
"RTN","GMRCPC",18,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 D EXIT Q
"RTN","GMRCPC",19,0)
 ;
"RTN","GMRCPC",20,0)
 D EN^VALM("GMRC PENDING CONSULTS")
"RTN","GMRCPC",21,0)
 ;
"RTN","GMRCPC",22,0)
HDR ; -- header code
"RTN","GMRCPC",23,0)
 Q:$D(GMRCQUT)!'$D(GMRCCT)
"RTN","GMRCPC",24,0)
 S VALMHDR(1)="To Service:  "_GMRCHEAD
"RTN","GMRCPC",25,0)
 S VALMHDR(2)="From: "_$G(GMRCEDT1)_"   To: "_$G(GMRCEDT2)
"RTN","GMRCPC",26,0)
 I $G(GMRCCTRL)=1 S VALMCAP="     "_VALMCAP
"RTN","GMRCPC",27,0)
 Q
"RTN","GMRCPC",28,0)
 ;
"RTN","GMRCPC",29,0)
INIT ; -- init variables and list array
"RTN","GMRCPC",30,0)
 ;This entry is not used ENORLM^GMRCSTLM is used instead.
"RTN","GMRCPC",31,0)
 Q
"RTN","GMRCPC",32,0)
 ;
"RTN","GMRCPC",33,0)
HELP ; -- help code
"RTN","GMRCPC",34,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","GMRCPC",35,0)
 Q
"RTN","GMRCPC",36,0)
 ;
"RTN","GMRCPC",37,0)
EXIT ; -- exit code
"RTN","GMRCPC",38,0)
 K CNT,CTRLCOL,GMRCCT,GMRCQUT,GMRCSVC,GMRCSVCP,VALMHDR,GMRCCOMP
"RTN","GMRCPC",39,0)
 K GMRCEDT1,GMRCEDT2
"RTN","GMRCPC",40,0)
 K GMRCHEAD,GMRCCTRL,GMRCSTAT
"RTN","GMRCPC",41,0)
 K ^TMP("GMRCS",$J),^TMP("GMRCSLIST",$J),^TMP("GMRCR",$J,"CP"),^TMP("GMRCRINDEX",$J)
"RTN","GMRCPC",42,0)
 Q
"RTN","GMRCPC",43,0)
 ;
"RTN","GMRCPC",44,0)
EXPND ; -- expand code
"RTN","GMRCPC",45,0)
 Q
"RTN","GMRCPC",46,0)
 ;
"RTN","GMRCPC",47,0)
CWIDTH(GMRCCTRL) ;Prints a message about how wide the report is.
"RTN","GMRCPC",48,0)
 N WIDTH
"RTN","GMRCPC",49,0)
 S WIDTH=92
"RTN","GMRCPC",50,0)
 I GMRCCTRL#100\10 D
"RTN","GMRCPC",51,0)
 .I GMRCCTRL#100\10=1 S WIDTH=WIDTH+5
"RTN","GMRCPC",52,0)
 .E  S WIDTH=WIDTH+10
"RTN","GMRCPC",53,0)
 I GMRCCTRL#1000\100 S WIDTH=WIDTH-6
"RTN","GMRCPC",54,0)
 Q WIDTH
"RTN","GMRCPC",55,0)
 ;
"RTN","GMRCPC",56,0)
PWIDTH(GMRCCTRL) ;Prints a message about how wide the report is.
"RTN","GMRCPC",57,0)
 W !!,"This print out is "_$$CWIDTH(GMRCCTRL)_" columns wide."
"RTN","GMRCPC",58,0)
 Q
"RTN","GMRCPC",59,0)
 ;
"RTN","GMRCPC",60,0)
PRNTONLY(GMRCCTRL) ;Option to just send the report to a device.
"RTN","GMRCPC",61,0)
 N GMRCQUT,RETURN,GMRCDG,GMRCSTAT,VALMBCK
"RTN","GMRCPC",62,0)
 N GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2
"RTN","GMRCPC",63,0)
 ;Get the statuses
"RTN","GMRCPC",64,0)
 S GMRCSTAT=$$STS^GMRCPC1
"RTN","GMRCPC",65,0)
 I $D(GMRCQUT) D EXIT Q
"RTN","GMRCPC",66,0)
 ;Get the service and date range.
"RTN","GMRCPC",67,0)
 D EN^GMRCSTLM
"RTN","GMRCPC",68,0)
 I $D(GMRCQUT) D EXIT Q
"RTN","GMRCPC",69,0)
 ;Quit if no array of services
"RTN","GMRCPC",70,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 D EXIT Q
"RTN","GMRCPC",71,0)
 I '($D(GMRCCTRL)#2) S GMRCCTRL=0 ;default to just the list
"RTN","GMRCPC",72,0)
 D PWIDTH(GMRCCTRL)
"RTN","GMRCPC",73,0)
 ;Get the device
"RTN","GMRCPC",74,0)
 D PRNTASK^GMRCSTU
"RTN","GMRCPC",75,0)
 I $D(GMRCQUT) D EXIT Q
"RTN","GMRCPC",76,0)
 ;Save some things if the report is queued
"RTN","GMRCPC",77,0)
 I $D(IO("Q")) D
"RTN","GMRCPC",78,0)
 .S ZTSAVE("GMRCSTAT")=""
"RTN","GMRCPC",79,0)
 .S ZTSAVE("GMRCCTRL")=""
"RTN","GMRCPC",80,0)
 ;Create the report if not queued
"RTN","GMRCPC",81,0)
 E  D ENOR^GMRCSTLM(.RETURN,GMRCDG,GMRCDT1,GMRCDT2,GMRCSTAT,GMRCCTRL)
"RTN","GMRCPC",82,0)
 ;Print the report
"RTN","GMRCPC",83,0)
 D PRNTIT^GMRCSTU("CP","PRNTQ^GMRCPC","CONSULT/REQUEST PACKAGE PRINT SERVICE CONSULTS BY STATUS FROM OPTION")
"RTN","GMRCPC",84,0)
 D EXIT
"RTN","GMRCPC",85,0)
 Q
"RTN","GMRCPC",86,0)
 ;
"RTN","GMRCPC",87,0)
PRNTQ ;Print Queued report from ^TMP global then kill off ^TMP & ^XTMP
"RTN","GMRCPC",88,0)
 ;Create the report
"RTN","GMRCPC",89,0)
 N RETURN,INDEX
"RTN","GMRCPC",90,0)
 D ENOR^GMRCSTLM(.RETURN,GMRCDG,GMRCDT1,GMRCDT2,GMRCSTAT,GMRCCTRL)
"RTN","GMRCPC",91,0)
 U IO
"RTN","GMRCPC",92,0)
 S INDEX=""
"RTN","GMRCPC",93,0)
 F  S INDEX=$O(^TMP("GMRCR",$J,TMPNAME,INDEX)) Q:INDEX=""  W ^TMP("GMRCR",$J,TMPNAME,INDEX,0),!
"RTN","GMRCPC",94,0)
 K ^TMP("GMRCR",$J,TMPNAME),^XTMP("GMRCR",J,DOLLARH,"PRINT"),J,DOLLARH
"RTN","GMRCPC",95,0)
 D ^%ZISC
"RTN","GMRCPC",96,0)
 D EXIT
"RTN","GMRCPC",97,0)
 Q
"RTN","GMRCPC",98,0)
 ;
"RTN","GMRCPC1")
0^9^B11383355
"RTN","GMRCPC1",1,0)
GMRCPC1 ;SLC/dee - List Manager Routine: Collect and display consults by service and status ;1/27/00
"RTN","GMRCPC1",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**7**;DEC 27, 1997
"RTN","GMRCPC1",3,0)
 Q
"RTN","GMRCPC1",4,0)
 ;
"RTN","GMRCPC1",5,0)
ENSTS ;GMRC List Manager Routine -- Second entry point for GMRC PENDING CONSULTS with user selected statuses
"RTN","GMRCPC1",6,0)
 S GMRCSTAT=$$STS
"RTN","GMRCPC1",7,0)
 I $D(GMRCQUT) D EXIT^GMRCPC Q
"RTN","GMRCPC1",8,0)
 D EN^GMRCPC
"RTN","GMRCPC1",9,0)
 Q
"RTN","GMRCPC1",10,0)
 ;
"RTN","GMRCPC1",11,0)
NEWSTS ;
"RTN","GMRCPC1",12,0)
 N TEMPSTAT
"RTN","GMRCPC1",13,0)
 S TEMPSTAT=GMRCSTAT
"RTN","GMRCPC1",14,0)
 S GMRCSTAT=$$STS
"RTN","GMRCPC1",15,0)
 S:$D(GMRCQUT) GMRCSTAT=TEMPSTAT
"RTN","GMRCPC1",16,0)
 Q
"RTN","GMRCPC1",17,0)
 ;
"RTN","GMRCPC1",18,0)
STS() ;Select a set of status for view.
"RTN","GMRCPC1",19,0)
 I $D(IOTM),$D(IOBM),$D(IOSTBM) D FULL^VALM1
"RTN","GMRCPC1",20,0)
 N DIR,X,Y,GMRCSTCK
"RTN","GMRCPC1",21,0)
STSAGAIN ;Loop to get another status.
"RTN","GMRCPC1",22,0)
 ;The following commented line would as for all of the statuses.
"RTN","GMRCPC1",23,0)
 ;S DIR(0)="SAOM^al:All Status's;ap:All Pending;dc:Discont.;c:Completed;h:On Hold;f:Flagged;p:Pending;a:Active;e:Expired;s:Scheduled;pr:Incomplete;d:Delayed;u:Unreleased;dce:Discont/Ed;x:Cancelled;l:Lapsed;rn:Renewed;':No Status"
"RTN","GMRCPC1",24,0)
 S DIR(0)="SAOM^al:All Status's;ap:All Pending;dc:Discont.;c:Completed;p:Pending;a:Active;s:Scheduled;pr:Incomplete;x:Cancelled"
"RTN","GMRCPC1",25,0)
 S DIR("A")="Only Display Consults With Status of: "
"RTN","GMRCPC1",26,0)
 S DIR("B")="All Status's"
"RTN","GMRCPC1",27,0)
 I $G(GMRCSTCK) D
"RTN","GMRCPC1",28,0)
 . S DIR("A")="Another Status to display: "
"RTN","GMRCPC1",29,0)
 . K DIR("B")
"RTN","GMRCPC1",30,0)
 D ^DIR
"RTN","GMRCPC1",31,0)
 I $D(DUOUT)!($D(DTOUT)) S GMRCQUT=1 G END
"RTN","GMRCPC1",32,0)
 I '$L(Y) G END
"RTN","GMRCPC1",33,0)
 D STCK($$LOW^XLFSTR(Y))
"RTN","GMRCPC1",34,0)
 G:$G(GMRCSTCK)'="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,99" STSAGAIN
"RTN","GMRCPC1",35,0)
END Q $S($D(GMRCSTCK):GMRCSTCK,1:"")
"RTN","GMRCPC1",36,0)
 ;
"RTN","GMRCPC1",37,0)
STCK(RES)     ;change code to status
"RTN","GMRCPC1",38,0)
 N CODE
"RTN","GMRCPC1",39,0)
 ; al:All Status's;dc:Discont.;c:Completed;h:On Hold;f:Flagged;p:Pending;a:Active;e:Expired;s:Scheduled
"RTN","GMRCPC1",40,0)
 ;;pr:Incomplete;d:Delayed;u:Unreleased;dce:Discont/Ed;x:Cancelled;l:Lapsed;rn:Renewed;':No Status")
"RTN","GMRCPC1",41,0)
CASE ;
"RTN","GMRCPC1",42,0)
 I RES="al" S GMRCSTCK="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,99" Q  ;All Status's
"RTN","GMRCPC1",43,0)
 ;                                display     no.  file name      file abbr.
"RTN","GMRCPC1",44,0)
 I RES="ap" D  Q
"RTN","GMRCPC1",45,0)
 .F CODE=3,4,5,6,8,9,11,99 D CKCODE(CODE) ;   All Pending Statuses
"RTN","GMRCPC1",46,0)
 I RES="dc" D CKCODE(1) Q  ;  Discont.     1  DISCONTINUED       dc
"RTN","GMRCPC1",47,0)
 I RES="c" D CKCODE(2) Q  ;   Completed    2  COMPLETE           c
"RTN","GMRCPC1",48,0)
 I RES="h" D CKCODE(3) Q  ;   On Hold      3  HOLD               h
"RTN","GMRCPC1",49,0)
 I RES="f" D CKCODE(4) Q  ;   Flagged      4  FLAGGED           "?"
"RTN","GMRCPC1",50,0)
 I RES="p" D CKCODE(5) Q  ;   Pending      5  PENDING            p
"RTN","GMRCPC1",51,0)
 I RES="a" D CKCODE(6) Q  ;   Active       6  ACTIVE             a
"RTN","GMRCPC1",52,0)
 I RES="e" D CKCODE(7) Q  ;   Expired      7  EXPIRED            e
"RTN","GMRCPC1",53,0)
 I RES="s" D CKCODE(8) Q  ;   Scheduled    8  SCHEDULED          s
"RTN","GMRCPC1",54,0)
 I RES="pr" D CKCODE(9) Q  ;  Incomplete   9  PARTIAL RESULTS    pr
"RTN","GMRCPC1",55,0)
 I RES="d" D CKCODE(10) Q  ;  Delayed     10  DELAYED            d
"RTN","GMRCPC1",56,0)
 I RES="u" D CKCODE(11) Q  ;  Unreseased  11  UNRELEASED         u
"RTN","GMRCPC1",57,0)
 I RES="dce" D CKCODE(12) Q  ;Discont/Ed  12  DISCONTINUED/EDIT  dce
"RTN","GMRCPC1",58,0)
 I RES="x" D CKCODE(13) Q  ;  Cancelled   13  CANCELLED          x
"RTN","GMRCPC1",59,0)
 I RES="l" D CKCODE(14) Q  ;  Lapsed      14  LAPSED             l
"RTN","GMRCPC1",60,0)
 I RES="rn" D CKCODE(15) Q  ; Renewed     15  RENEWED            rn
"RTN","GMRCPC1",61,0)
 I RES="'" D CKCODE(99) Q  ;  No Status   99  NO STATUS          '
"RTN","GMRCPC1",62,0)
ENDCASE Q
"RTN","GMRCPC1",63,0)
 ;
"RTN","GMRCPC1",64,0)
CKCODE(CODE) ;
"RTN","GMRCPC1",65,0)
 I $D(GMRCSTCK),$$FND(CODE) W $C(7),!,"Already selected" Q
"RTN","GMRCPC1",66,0)
 I +$G(GMRCSTCK) S GMRCSTCK=GMRCSTCK_","_CODE
"RTN","GMRCPC1",67,0)
 E  S GMRCSTCK=CODE
"RTN","GMRCPC1",68,0)
 Q
"RTN","GMRCPC1",69,0)
 ;
"RTN","GMRCPC1",70,0)
FND(CD) ;status already selected?
"RTN","GMRCPC1",71,0)
 I GMRCSTCK=CD Q 1
"RTN","GMRCPC1",72,0)
 I $F(GMRCSTCK,(CD_",")) Q 1
"RTN","GMRCPC1",73,0)
 I $E(GMRCSTCK,$L(GMRCSTCK))=CD Q 1
"RTN","GMRCPC1",74,0)
 Q 0
"RTN","GMRCPC1",75,0)
 ;
"RTN","GMRCPC1",76,0)
NUMBER ;
"RTN","GMRCPC1",77,0)
 I GMRCCTRL'=120 S GMRCCTRL=120
"RTN","GMRCPC1",78,0)
 E  S GMRCCTRL=0
"RTN","GMRCPC1",79,0)
 Q
"RTN","GMRCPC1",80,0)
 ;
"RTN","GMRCSPD")
0^12^B2608177
"RTN","GMRCSPD",1,0)
GMRCSPD ;SLC/DCM,JFR - Change Date Range in CSLT Tracking Module ;4/19/00  14:32
"RTN","GMRCSPD",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,14,7**;DEC 27, 1997
"RTN","GMRCSPD",3,0)
 ; 19 APR 00 - MA - Date "GMRCDT2" was not being reset - KILLED GMRCDT2
"RTN","GMRCSPD",4,0)
EN ;START HERE
"RTN","GMRCSPD",5,0)
 N DTOUT,DIR,DUOUT,DIRUT,X,Y,GMRCDTS1,GMRCDTS2
"RTN","GMRCSPD",6,0)
 I $D(GMRCDT1)&($D(GMRCDT2)) D DTSAV
"RTN","GMRCSPD",7,0)
 K GMRCQUT
"RTN","GMRCSPD",8,0)
EN1 S DIR(0)="FA^1:45",DIR("A")="List From Starting Date: "
"RTN","GMRCSPD",9,0)
 S DIR("B")="ALL DATES" D ^DIR
"RTN","GMRCSPD",10,0)
 I $D(DUOUT)!($D(DTOUT)) D DTRES S GMRCQUT=1 Q
"RTN","GMRCSPD",11,0)
 S GMRCDT1=$$CHECK(X) I 'GMRCDT1,GMRCDT1'="ALL" G EN1
"RTN","GMRCSPD",12,0)
 I GMRCDT1="ALL" S GMRCDT2=0 Q
"RTN","GMRCSPD",13,0)
 K DIR
"RTN","GMRCSPD",14,0)
 S DIR(0)="DA^::E",DIR("A")="List To This Ending Date: " D ^DIR
"RTN","GMRCSPD",15,0)
 I $D(DTOUT)!($D(DUOUT)) K GMRCDT1 D DTRES S GMRCQUT=1 Q
"RTN","GMRCSPD",16,0)
 I +Y<GMRCDT1 S GMRCDT2=GMRCDT1,GMRCDT1=+Y
"RTN","GMRCSPD",17,0)
 S:'$D(GMRCDT2) GMRCDT2=+Y
"RTN","GMRCSPD",18,0)
 I $D(GMRC("NMBR")) D RESET^GMRCSLMV(GMRC("NMBR")) K GMRC("NMBR")
"RTN","GMRCSPD",19,0)
 Q
"RTN","GMRCSPD",20,0)
DTSAV ;Save old dates in case user '^'s out.
"RTN","GMRCSPD",21,0)
 I $D(GMRCDT1),$S(GMRCDT1>0:1,GMRCDT1="ALL":1,1:0) S GMRCDTS1=GMRCDT1,GMRCDT1=""
"RTN","GMRCSPD",22,0)
 I $D(GMRCDT2),GMRCDT2>0 S GMRCDTS2=GMRCDT2 K GMRCDT2
"RTN","GMRCSPD",23,0)
 I GMRCDTS1="ALL" K GMRCDT2
"RTN","GMRCSPD",24,0)
 Q
"RTN","GMRCSPD",25,0)
DTRES ;Restore old date in case user '^' out.
"RTN","GMRCSPD",26,0)
 I $D(GMRCDTS1) S GMRCDT1=GMRCDTS1
"RTN","GMRCSPD",27,0)
 I $D(GMRCDTS2) S GMRCDT2=GMRCDTS2
"RTN","GMRCSPD",28,0)
 K GMRCDTS1,GMRCDTS2 Q
"RTN","GMRCSPD",29,0)
CHECK(GMRCDAT) ;CHECK FREE TEXT INPUT 
"RTN","GMRCSPD",30,0)
 N %DT,X,Y
"RTN","GMRCSPD",31,0)
 ;I "ALL DATES"[$$UP^XLFSTR(GMRCDAT) Q "ALL"
"RTN","GMRCSPD",32,0)
 I $E("ALL DATES",1,$L(GMRCDAT))=$$UP^XLFSTR(GMRCDAT) Q "ALL"
"RTN","GMRCSPD",33,0)
 S %DT="E",X=GMRCDAT D ^%DT I Y<1 Q 0
"RTN","GMRCSPD",34,0)
 Q +Y
"RTN","GMRCST")
0^4^B6271112
"RTN","GMRCST",1,0)
GMRCST ;SLC/DCM,dee - Statistics on how how long to complete consult/requests for a service ;02/03/00
"RTN","GMRCST",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,7**;DEC 27, 1997
"RTN","GMRCST",3,0)
EN ; -- main entry point for GMRC REQUEST COMPLETE STAT
"RTN","GMRCST",4,0)
 K GMRCSVC,GMRCSVCP
"RTN","GMRCST",5,0)
 I $D(GMRCEACT),$L(GMRCEACT) D  I '$D(^GMR(123.5,$G(GMRCSVC),0)) D EXIT Q
"RTN","GMRCST",6,0)
 .S GMRCSVCP=GMRCEACT
"RTN","GMRCST",7,0)
 .S GMRCSVC=$O(^GMR(123.5,"B",GMRCSVCP,0))
"RTN","GMRCST",8,0)
 .Q:'$D(^GMR(123.5,$G(GMRCSVC),0))
"RTN","GMRCST",9,0)
 .;Build service array
"RTN","GMRCST",10,0)
 .S GMRCDG=GMRCSVC
"RTN","GMRCST",11,0)
 .D SERV1^GMRCASV
"RTN","GMRCST",12,0)
 .;Set date range to ALL
"RTN","GMRCST",13,0)
 .S GMRCDT1="ALL"
"RTN","GMRCST",14,0)
 .S GMRCDT2=0
"RTN","GMRCST",15,0)
 .D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCST",16,0)
 ;If no service ask for one
"RTN","GMRCST",17,0)
 I '$L($G(GMRCSVC)) D EN^GMRCSTU I $D(GMRCQUT) D EXIT Q
"RTN","GMRCST",18,0)
 ;Quit if no array of services
"RTN","GMRCST",19,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 D EXIT Q
"RTN","GMRCST",20,0)
 ;
"RTN","GMRCST",21,0)
 D ODT^GMRCSTU Q:$D(GMRCQUT)
"RTN","GMRCST",22,0)
 D EN^VALM("GMRC REQUEST COMPLETE STAT")
"RTN","GMRCST",23,0)
 Q
"RTN","GMRCST",24,0)
 ;
"RTN","GMRCST",25,0)
HDR ; -- header code
"RTN","GMRCST",26,0)
 S VALMHDR(1)="Number Of Days To Complete A Consult For Services Statistics."
"RTN","GMRCST",27,0)
 S VALMHDR(2)="FROM: "_$G(GMRCEDT1)_"   TO: "_$G(GMRCEDT2)
"RTN","GMRCST",28,0)
 Q
"RTN","GMRCST",29,0)
 ;
"RTN","GMRCST",30,0)
INIT ; -- init variables and list array
"RTN","GMRCST",31,0)
 S VALMCNT=$G(GMRCCT),VALMBCK="R"
"RTN","GMRCST",32,0)
 Q
"RTN","GMRCST",33,0)
 ;
"RTN","GMRCST",34,0)
HELP ; -- help code
"RTN","GMRCST",35,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","GMRCST",36,0)
 Q
"RTN","GMRCST",37,0)
 ;
"RTN","GMRCST",38,0)
EXIT ; -- exit code
"RTN","GMRCST",39,0)
 K ^TMP("GMRCR",$J,"PRL")
"RTN","GMRCST",40,0)
 K GMRCCT,GMRCSVC,GMRCEDT1,GMRCEDT2
"RTN","GMRCST",41,0)
 Q
"RTN","GMRCST",42,0)
 ;
"RTN","GMRCST",43,0)
EXPND ; -- expand code
"RTN","GMRCST",44,0)
 Q
"RTN","GMRCST",45,0)
 ;
"RTN","GMRCST",46,0)
PRNTONLY ;Option to just send the report to a device.
"RTN","GMRCST",47,0)
 ;Get the service and date range.
"RTN","GMRCST",48,0)
 N GMRCQUT,RETURN,GMRCDG,VALMBCK
"RTN","GMRCST",49,0)
 N GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2
"RTN","GMRCST",50,0)
 D EN^GMRCSTU
"RTN","GMRCST",51,0)
 I $D(GMRCQUT) D EXIT Q
"RTN","GMRCST",52,0)
 ;Quit if no array of services
"RTN","GMRCST",53,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 D EXIT Q
"RTN","GMRCST",54,0)
 ;Get the device
"RTN","GMRCST",55,0)
 D PRNTASK^GMRCSTU
"RTN","GMRCST",56,0)
 I $D(GMRCQUT) D EXIT Q
"RTN","GMRCST",57,0)
 ;Create the report if not queued
"RTN","GMRCST",58,0)
 I '$D(IO("Q")) D ENOR^GMRCSTU(.RETURN,GMRCDG,GMRCDT1,GMRCDT2)
"RTN","GMRCST",59,0)
 ;Print the report
"RTN","GMRCST",60,0)
 D PRNTIT^GMRCSTU("PRL","PRNTQ^GMRCST","CONSULT/REQUEST PACKAGE PRINT COMPLETION TIME STATISTICS FROM OPTION")
"RTN","GMRCST",61,0)
 D EXIT
"RTN","GMRCST",62,0)
 Q
"RTN","GMRCST",63,0)
 ;
"RTN","GMRCST",64,0)
PRNTQ ;Print Queued report from ^TMP global then kill off ^TMP & ^XTMP
"RTN","GMRCST",65,0)
 ;Create the report
"RTN","GMRCST",66,0)
 N RETURN,INDEX
"RTN","GMRCST",67,0)
 D ENOR^GMRCSTU(.RETURN,GMRCDG,GMRCDT1,GMRCDT2)
"RTN","GMRCST",68,0)
 U IO
"RTN","GMRCST",69,0)
 S INDEX=""
"RTN","GMRCST",70,0)
 F  S INDEX=$O(^TMP("GMRCR",$J,TMPNAME,INDEX)) Q:INDEX=""  W ^TMP("GMRCR",$J,TMPNAME,INDEX,0),!
"RTN","GMRCST",71,0)
 K ^TMP("GMRCR",$J,TMPNAME),^XTMP("GMRCR",J,DOLLARH,"PRINT"),J,DOLLARH
"RTN","GMRCST",72,0)
 D ^%ZISC
"RTN","GMRCST",73,0)
 D EXIT
"RTN","GMRCST",74,0)
 Q
"RTN","GMRCST",75,0)
 ;
"RTN","GMRCSTL1")
0^8^B8907927
"RTN","GMRCSTL1",1,0)
GMRCSTL1 ;SLC/DCM,dee - List Manager Format Routine - Get Active Consults by service - pending,active,scheduled,incomplete,etc. ;9/16/99
"RTN","GMRCSTL1",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**7**;DEC 27, 1997
"RTN","GMRCSTL1",3,0)
 Q
"RTN","GMRCSTL1",4,0)
STATNAME(STATUS) ;Return the name for the status number
"RTN","GMRCSTL1",5,0)
 I STATUS<9 Q $S(STATUS=1:"Discont.",STATUS=2:"Completed",STATUS=3:"On Hold",STATUS=4:"Flagged",STATUS=5:"Pending",STATUS=6:"Active",STATUS=7:"Expired",STATUS=8:"Scheduled",1:"No Status")
"RTN","GMRCSTL1",6,0)
 E  Q $S(STATUS=9:"Incomplete",STATUS=10:"Delayed",STATUS=11:"Unreleased",STATUS=12:"Discont/Ed",STATUS=13:"Cancelled",STATUS=14:"Lapsed",STATUS=15:"Renewed",1:"No Status")
"RTN","GMRCSTL1",7,0)
 Q
"RTN","GMRCSTL1",8,0)
 ;
"RTN","GMRCSTL1",9,0)
STATABBR(STATUS) ;Return the name for the status number
"RTN","GMRCSTL1",10,0)
 Q ^ORD(100.01,STATUS,.1)
"RTN","GMRCSTL1",11,0)
 ;
"RTN","GMRCSTL1",12,0)
LISTTOT(COUNT,GEN,INDEX,NAME,GROUPNAM,CONTROL) ;
"RTN","GMRCSTL1",13,0)
 N LOOP,STATUS,STS,CTRLTEMP
"RTN","GMRCSTL1",14,0)
 S CTRLTEMP=$S(CONTROL#2:"^",1:"")
"RTN","GMRCSTL1",15,0)
 I GEN=2 D
"RTN","GMRCSTL1",16,0)
 . S COUNT=COUNT+1
"RTN","GMRCSTL1",17,0)
 . S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP
"RTN","GMRCSTL1",18,0)
 . S COUNT=COUNT+1
"RTN","GMRCSTL1",19,0)
 . S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP_"          GROUPER: "_NAME_" Totals:"
"RTN","GMRCSTL1",20,0)
 F LOOP=1:1:$L(GMRCSTAT,",") S STATUS=$P(GMRCSTAT,",",LOOP) I GMRCTOT(GEN,INDEX,STATUS)>0 D
"RTN","GMRCSTL1",21,0)
 .S COUNT=COUNT+1
"RTN","GMRCSTL1",22,0)
 .S STS=$$STATNAME(STATUS)
"RTN","GMRCSTL1",23,0)
 .I GEN=1 S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP_"To Service "_NAME_" Total Requests "_STS_$J(GMRCTOT(1,INDEX,STATUS),6,0)
"RTN","GMRCSTL1",24,0)
 .E  S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP_"To Grouper "_NAME_" Total Requests "_STS_$J(GMRCTOT(2,INDEX,STATUS),6,0)
"RTN","GMRCSTL1",25,0)
 ;If any printed are pending then print the total that are pending for all pending status.
"RTN","GMRCSTL1",26,0)
 I GMRCTOT(GEN,INDEX,"P")>0 D
"RTN","GMRCSTL1",27,0)
 .S COUNT=COUNT+1
"RTN","GMRCSTL1",28,0)
 .I GEN=1 S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP_"Total Requests Pending Resolution To Service "_NAME_": "_$J(GMRCTOT(1,INDEX,"P"),6,0)
"RTN","GMRCSTL1",29,0)
 .E  S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP_"Total Requests Pending Resolution To Grouper "_NAME_": "_$J(GMRCTOT(2,INDEX,"P"),6,0)
"RTN","GMRCSTL1",30,0)
 S COUNT=COUNT+1
"RTN","GMRCSTL1",31,0)
 I GEN=1 S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP_"Total Requests To Service "_NAME_": "_$J(GMRCTOT(1,INDEX,"T"),6,0)
"RTN","GMRCSTL1",32,0)
 E  S ^TMP("GMRCR",$J,"CP",COUNT,0)=CTRLTEMP_"Total Requests To Grouper "_NAME_": "_$J(GMRCTOT(2,INDEX,"T"),6,0)
"RTN","GMRCSTL1",33,0)
 Q
"RTN","GMRCSTL1",34,0)
 ;
"RTN","GMRCSTL2")
0^10^B9332990
"RTN","GMRCSTL2",1,0)
GMRCSTL2 ;SLC/DCM,dee - List Manager Format Routine - Get Active Consults by service - pending,active,scheduled,incomplete,etc. ;4/19/00  14:33
"RTN","GMRCSTL2",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**7**;DEC 27, 1997
"RTN","GMRCSTL2",3,0)
 Q
"RTN","GMRCSTL2",4,0)
 ;
"RTN","GMRCSTL2",5,0)
ONESTAT ;Process one status
"RTN","GMRCSTL2",6,0)
 S GMRCTOT(1,GMRCSVC,STATUS)=0
"RTN","GMRCSTL2",7,0)
 S GMRCTOT(2,GMRCSVC,STATUS)=0
"RTN","GMRCSTL2",8,0)
 S GMRCXDT=$S(GMRCDT1="ALL":0,1:9999999-GMRCDT2-.6)
"RTN","GMRCSTL2",9,0)
 F  S GMRCXDT=$O(^GMR(123,"AE",GMRCSVC,STATUS,GMRCXDT)) Q:GMRCXDT=""!(GMRCXDT>(9999999-GMRCDT1))  D
"RTN","GMRCSTL2",10,0)
 .S GMRCPT=0
"RTN","GMRCSTL2",11,0)
ONE .;Loop for one consult at a time
"RTN","GMRCSTL2",12,0)
 .F  S GMRCPT=$O(^GMR(123,"AE",GMRCSVC,STATUS,GMRCXDT,GMRCPT)) Q:GMRCPT=""  D
"RTN","GMRCSTL2",13,0)
 ..I GMRCTOT(1,GMRCSVC,"T")=0 D
"RTN","GMRCSTL2",14,0)
 ...S GMRCCT=GMRCCT+1
"RTN","GMRCSTL2",15,0)
 ...S ^TMP("GMRCR",$J,"CP",GMRCCT,0)=CTRLTEMP
"RTN","GMRCSTL2",16,0)
 ...S GMRCCT=GMRCCT+1
"RTN","GMRCSTL2",17,0)
 ...S TEMP="SERVICE: "_GMRCSVCP
"RTN","GMRCSTL2",18,0)
 ...S:GMRCSVCG>0 TEMP=TEMP_" in Group: "_$P(^GMR(123.5,GMRCSVCG,0),"^",1)
"RTN","GMRCSTL2",19,0)
 ...S ^TMP("GMRCR",$J,"CP",GMRCCT,0)=CTRLTEMP_TEMP
"RTN","GMRCSTL2",20,0)
 ...S NUMCLIN=NUMCLIN+1
"RTN","GMRCSTL2",21,0)
 ..S X=9999999-GMRCXDT
"RTN","GMRCSTL2",22,0)
 ..D REGDTM^GMRCU
"RTN","GMRCSTL2",23,0)
 ..S GMRCDT=$P(X," ",1)
"RTN","GMRCSTL2",24,0)
 ..S GMRCDLA=$P(X," ",1)
"RTN","GMRCSTL2",25,0)
 ..S GMRCD(0)=^GMR(123,GMRCPT,0)
"RTN","GMRCSTL2",26,0)
 ..S GMRCPTN=$P(^DPT($P(GMRCD(0),"^",2),0),"^",1)
"RTN","GMRCSTL2",27,0)
 ..S GMRCPTN=$P(GMRCPTN,",",1)_","_$E($P(GMRCPTN,",",2),1)_"."
"RTN","GMRCSTL2",28,0)
 ..S GMRCPTSN="("_$E($P(^(0),"^",9),6,9)_")"
"RTN","GMRCSTL2",29,0)
 ..S GMRCD=0
"RTN","GMRCSTL2",30,0)
 ..S GMRCD=$O(^GMR(123,GMRCPT,40,"B",GMRCD))
"RTN","GMRCSTL2",31,0)
 ..I GMRCD]"" D
"RTN","GMRCSTL2",32,0)
 ...S GMRCDA=""
"RTN","GMRCSTL2",33,0)
 ...S GMRCDA=$O(^GMR(123,+GMRCPT,40,"B",GMRCD,GMRCDA))
"RTN","GMRCSTL2",34,0)
 ..S GMRCDLA=$E($P($G(^GMR(123.1,$P(GMRCD(0),"^",13),0)),"^"),1,19)
"RTN","GMRCSTL2",35,0)
 ..S GMRCLOC=$P(GMRCD(0),"^",4)
"RTN","GMRCSTL2",36,0)
 ..S:$L(GMRCLOC) GMRCLOC=$E($P($G(^SC(GMRCLOC,0)),"^",1),1,30) ;DBIA#10040
"RTN","GMRCSTL2",37,0)
 ..S LINETEMP=""
"RTN","GMRCSTL2",38,0)
CTRL ..I GMRCCTRL#100\10 D
"RTN","GMRCSTL2",39,0)
 ...I GMRCCTRL#100\10=1 D
"RTN","GMRCSTL2",40,0)
 ....S GMRCLINE=GMRCLINE+1
"RTN","GMRCSTL2",41,0)
 ....S ^TMP("GMRCRINDEX",$J,GMRCLINE)=GMRCPT
"RTN","GMRCSTL2",42,0)
 ....S LINETEMP=$J(GMRCLINE,4)_" "
"RTN","GMRCSTL2",43,0)
 ...E  S LINETEMP=$J(GMRCPT,9)_" "
"RTN","GMRCSTL2",44,0)
 ..I GMRCCTRL#2 S LINETEMP=GMRCPT_"^"_LINETEMP
"RTN","GMRCSTL2",45,0)
 ..I GMRCCTRL#1000\100 D
"RTN","GMRCSTL2",46,0)
 ...S STS=$$STATABBR^GMRCSTL1(STATUS)
"RTN","GMRCSTL2",47,0)
 ...S STS=STS_$J("",4-$L(STS)+1)
"RTN","GMRCSTL2",48,0)
 ..E  D
"RTN","GMRCSTL2",49,0)
 ...S STS=$$STATNAME^GMRCSTL1(STATUS)
"RTN","GMRCSTL2",50,0)
 ...S STS=STS_$J("",10-$L(STS)+1)
"RTN","GMRCSTL2",51,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTL2",52,0)
 ..S ^TMP("GMRCR",$J,"CP",GMRCCT,0)=LINETEMP_STS_GMRCDLA_$J("",20-$L(GMRCDLA))_GMRCDT_" "_GMRCPTN_" "_GMRCPTSN_$J("",12-$L(GMRCPTN)+5)_GMRCLOC
"RTN","GMRCSTL2",53,0)
 ..;
"RTN","GMRCSTL2",54,0)
ADDTOT ..;Add to totals
"RTN","GMRCSTL2",55,0)
 ..;  for all status for this service
"RTN","GMRCSTL2",56,0)
 ..S GMRCTOT(1,GMRCSVC,"T")=GMRCTOT(1,GMRCSVC,"T")+1
"RTN","GMRCSTL2",57,0)
 ..;  pending for this service
"RTN","GMRCSTL2",58,0)
 ..S:",3,4,5,6,8,9,11,99,"[(","_STATUS_",") GMRCTOT(1,GMRCSVC,"P")=GMRCTOT(1,GMRCSVC,"P")+1
"RTN","GMRCSTL2",59,0)
 ..;  this status (STATUS) for this service
"RTN","GMRCSTL2",60,0)
 ..S GMRCTOT(1,GMRCSVC,STATUS)=GMRCTOT(1,GMRCSVC,STATUS)+1
"RTN","GMRCSTL2",61,0)
 ;  this status (STATUS) for services to all of its groupers
"RTN","GMRCSTL2",62,0)
 F GRP=GROUPER:-1:1 S GMRCTOT(2,GROUPER(GRP),STATUS)=$G(GMRCTOT(2,GROUPER(GRP),STATUS))+GMRCTOT(1,GMRCSVC,STATUS)
"RTN","GMRCSTL2",63,0)
 Q
"RTN","GMRCSTL2",64,0)
 ;
"RTN","GMRCSTLM")
0^6^B43094602
"RTN","GMRCSTLM",1,0)
GMRCSTLM ;SLC/DCM,dee - List Manager Format Routine - Get Active Consults by service - pending,active,scheduled,incomplete,etc. ;02/03/00
"RTN","GMRCSTLM",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,7**;DEC 27, 1997
"RTN","GMRCSTLM",3,0)
 Q
"RTN","GMRCSTLM",4,0)
 ;
"RTN","GMRCSTLM",5,0)
EN ;Ask for new service and date range
"RTN","GMRCSTLM",6,0)
 K GMRCQUT
"RTN","GMRCSTLM",7,0)
 N DIROUT,DTOUT,DUOUT,DIR
"RTN","GMRCSTLM",8,0)
 ;
"RTN","GMRCSTLM",9,0)
 ;Ask for service
"RTN","GMRCSTLM",10,0)
 D ASRV^GMRCASV
"RTN","GMRCSTLM",11,0)
 I $D(GMRCQUT)!'$O(^TMP("GMRCSLIST",$J,0)) S VALMBCK="Q" Q
"RTN","GMRCSTLM",12,0)
 ;
"RTN","GMRCSTLM",13,0)
 ;Ask for date range
"RTN","GMRCSTLM",14,0)
 D ^GMRCSPD
"RTN","GMRCSTLM",15,0)
 I $D(GMRCQUT) S VALMBCK="Q" G EXIT
"RTN","GMRCSTLM",16,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTLM",17,0)
 Q
"RTN","GMRCSTLM",18,0)
 ;
"RTN","GMRCSTLM",19,0)
ENOR(RETURN,GMRCSVC,GMRCDT1,GMRCDT2,GMRCSTAT,GMRCCTRL) ;Entry point for GUI interface.
"RTN","GMRCSTLM",20,0)
 ;.RETURN:   This is the root to the returned temp array.
"RTN","GMRCSTLM",21,0)
 ;GMRCSVC:  Service for which consults are to be displayed.
"RTN","GMRCSTLM",22,0)
 ;GMRCDT1:  Starting date or "ALL"
"RTN","GMRCSTLM",23,0)
 ;GMRCDT2:  Ending date if not GMRCDT1="ALL"
"RTN","GMRCSTLM",24,0)
 ;GMRCSTAT: The list of status to include separated by commas
"RTN","GMRCSTLM",25,0)
 ;GMRCCTRL:   0, null or not define then just the display list is 
"RTN","GMRCSTLM",26,0)
 ;                displayed
"RTN","GMRCSTLM",27,0)
 ;            1 then the list will be two pieces with the first piece 
"RTN","GMRCSTLM",28,0)
 ;                being the ien of the consult for selection in the gui
"RTN","GMRCSTLM",29,0)
 ;                and the second piece being the display text.
"RTN","GMRCSTLM",30,0)
 ;           10 then the consults will have a line number on them for
"RTN","GMRCSTLM",31,0)
 ;                selection
"RTN","GMRCSTLM",32,0)
 ;           20 then the consults will have the consult number displayed
"RTN","GMRCSTLM",33,0)
 ;          100 then use abbreviations for the statuses
"RTN","GMRCSTLM",34,0)
 ;      1, (10 or 20) and 100 can be added together to add there features
"RTN","GMRCSTLM",35,0)
 ;
"RTN","GMRCSTLM",36,0)
 ;This temp array is used internally by the report:
"RTN","GMRCSTLM",37,0)
 ;^TMP("GMRCSLIST",$J,n)=ien^name^parient ien^"+" if grouper^status
"RTN","GMRCSTLM",38,0)
 ;  status is "" tracking and/or grouper
"RTN","GMRCSTLM",39,0)
 ;            1  grouper only
"RTN","GMRCSTLM",40,0)
 ;            2  tracking only
"RTN","GMRCSTLM",41,0)
 ;            9  disabled
"RTN","GMRCSTLM",42,0)
 ;
"RTN","GMRCSTLM",43,0)
 N GMRCEDT1,GMRCEDT2,GMRCDG,GMRCHEAD,GMRCCT,GMRCGRP,VALMCNT,VALMBCK
"RTN","GMRCSTLM",44,0)
 K ^TMP("GMRCR",$J,"CP")
"RTN","GMRCSTLM",45,0)
 S RETURN="^TMP(""GMRCR"",$J,""CP"")"
"RTN","GMRCSTLM",46,0)
 I '($D(GMRCSVC)#2) S GMRCSVC=1
"RTN","GMRCSTLM",47,0)
 Q:'$D(^GMR(123.5,$G(GMRCSVC),0))
"RTN","GMRCSTLM",48,0)
 ;Build service array
"RTN","GMRCSTLM",49,0)
 S GMRCDG=GMRCSVC
"RTN","GMRCSTLM",50,0)
 D SERV1^GMRCASV
"RTN","GMRCSTLM",51,0)
 ;Get external form of date range
"RTN","GMRCSTLM",52,0)
 I '($D(GMRCDT1)#2) S GMRCDT1="ALL"
"RTN","GMRCSTLM",53,0)
 S:GMRCDT1="ALL" GMRCDT2=0
"RTN","GMRCSTLM",54,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,$G(GMRCDT2),.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTLM",55,0)
 G ENORSTR
"RTN","GMRCSTLM",56,0)
 ;
"RTN","GMRCSTLM",57,0)
ENORLM ;Entry point for List Manager interface.
"RTN","GMRCSTLM",58,0)
 D WAIT^DICD
"RTN","GMRCSTLM",59,0)
 ;
"RTN","GMRCSTLM",60,0)
ENORSTR ;Common part
"RTN","GMRCSTLM",61,0)
 N GMRCDA,NUMCLIN,INDEX,STATUS,LOOP,GROUPER
"RTN","GMRCSTLM",62,0)
 N STS,GMRCD,GMRCDT,GMRCTOT,GMRCSVCG,TEMP
"RTN","GMRCSTLM",63,0)
 N GMRCPT,CTRLTEMP,LINETEMP,GMRCLINE
"RTN","GMRCSTLM",64,0)
 N GMRCPTN,GMRCPTSN,GMRCDLA,GMRCXDT,GMRCLOC,GMRCSVCP
"RTN","GMRCSTLM",65,0)
 N GRP
"RTN","GMRCSTLM",66,0)
 ;
"RTN","GMRCSTLM",67,0)
 K ^TMP("GMRCR",$J,"CP"),^TMP("GMRCRINDEX",$J)
"RTN","GMRCSTLM",68,0)
 ;
"RTN","GMRCSTLM",69,0)
 S GMRCCT=0
"RTN","GMRCSTLM",70,0)
 S NUMCLIN=0
"RTN","GMRCSTLM",71,0)
 S GMRCLINE=0
"RTN","GMRCSTLM",72,0)
 S GROUPER=0
"RTN","GMRCSTLM",73,0)
 S GROUPER(0)=0
"RTN","GMRCSTLM",74,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTLM",75,0)
 I '($D(GMRCCTRL)#2) S GMRCCTRL=0 ;default to just the list
"RTN","GMRCSTLM",76,0)
 S CTRLTEMP=$S(GMRCCTRL#2:"^",1:"")
"RTN","GMRCSTLM",77,0)
 S ^TMP("GMRCR",$J,"CP",GMRCCT,0)=CTRLTEMP_$J("",28)_"Consult/Request By Status"
"RTN","GMRCSTLM",78,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTLM",79,0)
 S TEMP="FROM: "_GMRCEDT1_"   TO: "_GMRCEDT2
"RTN","GMRCSTLM",80,0)
 S ^TMP("GMRCR",$J,"CP",GMRCCT,0)=CTRLTEMP_$J("",40-($L(TEMP)/2)+.5)_TEMP
"RTN","GMRCSTLM",81,0)
 ;
"RTN","GMRCSTLM",82,0)
 I '($D(GMRCSVC)#2) S GMRCSVC=1
"RTN","GMRCSTLM",83,0)
 I '($D(GMRCDT1)#2) S GMRCDT1="ALL",GMRCDT2=0
"RTN","GMRCSTLM",84,0)
 I '($D(GMRCDT2)#2) S GMRCDT2=""
"RTN","GMRCSTLM",85,0)
 I '($D(GMRCSTAT)#2) S GMRCSTAT="3,4,5,6,8,9,11,99" ;pending consults
"RTN","GMRCSTLM",86,0)
 ;
"RTN","GMRCSTLM",87,0)
CAPTION ;Set the List Mangager Caption Line
"RTN","GMRCSTLM",88,0)
 ; Does GMRCCTRL contain 10 i.e. display line numbers
"RTN","GMRCSTLM",89,0)
 ;                    or 20 i.e. display consult number
"RTN","GMRCSTLM",90,0)
 I $G(VALMAR)="^TMP(""GMRCR"",$J,""CP"")" D
"RTN","GMRCSTLM",91,0)
 .I GMRCCTRL#100\10 D
"RTN","GMRCSTLM",92,0)
 ..I GMRCCTRL#100\10=1 D
"RTN","GMRCSTLM",93,0)
 ...; Does GMRCCTRL contain 100 i.e. use abbreviations for the statuses
"RTN","GMRCSTLM",94,0)
 ...I GMRCCTRL#1000\100 D CHGCAP^VALM("CAPTION LINE","     St    Last Action   Request Date  Patient Name         Pt Location")
"RTN","GMRCSTLM",95,0)
 ...; Do not use abbreviations for the statuses
"RTN","GMRCSTLM",96,0)
 ...E  D CHGCAP^VALM("CAPTION LINE","     Status      Last Action   Request Date  Patient Name         Pt Location")
"RTN","GMRCSTLM",97,0)
 ..; Do not display consult number
"RTN","GMRCSTLM",98,0)
 ..E  D
"RTN","GMRCSTLM",99,0)
 ...; Does GMRCCTRL contain 100 i.e. use abbreviations for the statuses
"RTN","GMRCSTLM",100,0)
 ...I GMRCCTRL#1000\100 D CHGCAP^VALM("CAPTION LINE"," Number   St    Last Action   Request Date  Patient Name         Pt Location")
"RTN","GMRCSTLM",101,0)
 ...; Do not use abbreviations for the statuses
"RTN","GMRCSTLM",102,0)
 ...E  D CHGCAP^VALM("CAPTION LINE"," Number   Status      Last Action   Request Date  Patient Name         Pt Location")
"RTN","GMRCSTLM",103,0)
 .E  D
"RTN","GMRCSTLM",104,0)
 ..; Does GMRCCTRL contain 100 i.e. use abbreviations for the statuses
"RTN","GMRCSTLM",105,0)
 ..I GMRCCTRL#1000\100 D CHGCAP^VALM("CAPTION LINE","St    Last Action   Request Date  Patient Name         Pt Location")
"RTN","GMRCSTLM",106,0)
 ..; Do not use abbreviations for the statuses
"RTN","GMRCSTLM",107,0)
 ..E  D CHGCAP^VALM("CAPTION LINE","Status      Last Action      Request Date  Patient Name      Pt Location")
"RTN","GMRCSTLM",108,0)
 ;Set screen width
"RTN","GMRCSTLM",109,0)
 S VALM("RM")=$$CWIDTH^GMRCPC(GMRCCTRL)
"RTN","GMRCSTLM",110,0)
 ;
"RTN","GMRCSTLM",111,0)
 S GMRCHEAD=$P($G(^TMP("GMRCSLIST",$J,+$O(^TMP("GMRCSLIST",$J,"")))),"^",2)
"RTN","GMRCSTLM",112,0)
 S INDEX=""
"RTN","GMRCSTLM",113,0)
SVC ;Loop on Service
"RTN","GMRCSTLM",114,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX)) Q:INDEX=""  D
"RTN","GMRCSTLM",115,0)
 .S GMRCSVC=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTLM",116,0)
 .S GMRCSVCP=$P(^TMP("GMRCSLIST",$J,INDEX),"^",2)
"RTN","GMRCSTLM",117,0)
 .S GMRCSVCG=$P(^TMP("GMRCSLIST",$J,INDEX),"^",3)
"RTN","GMRCSTLM",118,0)
 .S GMRCTOT(1,GMRCSVC,"T")=0
"RTN","GMRCSTLM",119,0)
 .S GMRCTOT(1,GMRCSVC,"P")=0
"RTN","GMRCSTLM",120,0)
 .S GMRCTOT(2,GMRCSVC,"T")=0
"RTN","GMRCSTLM",121,0)
 .S GMRCTOT(2,GMRCSVC,"P")=0
"RTN","GMRCSTLM",122,0)
GROUPER .;Check if starting a new Grouper
"RTN","GMRCSTLM",123,0)
 .F  Q:GROUPER(GROUPER)=GMRCSVCG  D
"RTN","GMRCSTLM",124,0)
 ..;End of a group so print the group totals
"RTN","GMRCSTLM",125,0)
 ..D LISTTOT^GMRCSTL1(.GMRCCT,2,GROUPER(GROUPER),$P(^GMR(123.5,GROUPER(GROUPER),0),"^",1),"",GMRCCTRL)
"RTN","GMRCSTLM",126,0)
 ..;pop grouper from stack
"RTN","GMRCSTLM",127,0)
 ..S GROUPER=GROUPER-1
"RTN","GMRCSTLM",128,0)
 .I $P(^TMP("GMRCSLIST",$J,INDEX),"^",4)="+" D
"RTN","GMRCSTLM",129,0)
 ..;Start of a new group so print the group heading.
"RTN","GMRCSTLM",130,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTLM",131,0)
 ..S ^TMP("GMRCR",$J,"CP",GMRCCT,0)=CTRLTEMP
"RTN","GMRCSTLM",132,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTLM",133,0)
 ..S TEMP="GROUPER: "_GMRCSVCP
"RTN","GMRCSTLM",134,0)
 ..S:GMRCSVCG>0 TEMP=TEMP_"  in Group: "_$P(^GMR(123.5,GMRCSVCG,0),"^",1)
"RTN","GMRCSTLM",135,0)
 ..S ^TMP("GMRCR",$J,"CP",GMRCCT,0)=CTRLTEMP_$J("",40-(($L(TEMP)/2)+.5))_TEMP
"RTN","GMRCSTLM",136,0)
 ..;push new grouper on stack
"RTN","GMRCSTLM",137,0)
 ..S GROUPER=GROUPER+1
"RTN","GMRCSTLM",138,0)
 ..S GROUPER(GROUPER)=GMRCSVC
"RTN","GMRCSTLM",139,0)
STAT .;Loop for one status at a time
"RTN","GMRCSTLM",140,0)
 .F LOOP=1:1:$L(GMRCSTAT,",") S STATUS=$P(GMRCSTAT,",",LOOP) D ONESTAT^GMRCSTL2
"RTN","GMRCSTLM",141,0)
 .F GRP=GROUPER:-1:1 D
"RTN","GMRCSTLM",142,0)
 ..;  pending for this service to all of its groupers
"RTN","GMRCSTLM",143,0)
 ..S GMRCTOT(2,GROUPER(GRP),"P")=$G(GMRCTOT(2,GROUPER(GRP),"P"))+GMRCTOT(1,GMRCSVC,"P")
"RTN","GMRCSTLM",144,0)
 ..;  for all status for this service to all of its groupers
"RTN","GMRCSTLM",145,0)
 ..S GMRCTOT(2,GROUPER(GRP),"T")=$G(GMRCTOT(2,GROUPER(GRP),"T"))+GMRCTOT(1,GMRCSVC,"T")
"RTN","GMRCSTLM",146,0)
 .;
"RTN","GMRCSTLM",147,0)
PRINTST .;Print the totals for this service that are >0
"RTN","GMRCSTLM",148,0)
 .I GMRCTOT(1,GMRCSVC,"T")>0 D LISTTOT^GMRCSTL1(.GMRCCT,1,GMRCSVC,GMRCSVCP,$P($G(^GMR(123.5,GMRCSVCG,0)),"^",1),GMRCCTRL)
"RTN","GMRCSTLM",149,0)
 ;
"RTN","GMRCSTLM",150,0)
 ;Done so
"RTN","GMRCSTLM",151,0)
 ;Now list the group totals for the current groups
"RTN","GMRCSTLM",152,0)
 F GROUPER=GROUPER:-1:1 D
"RTN","GMRCSTLM",153,0)
 .D LISTTOT^GMRCSTL1(.GMRCCT,2,GROUPER(GROUPER),$P(^GMR(123.5,GROUPER(GROUPER),0),"^",1),"",GMRCCTRL)
"RTN","GMRCSTLM",154,0)
 ;
"RTN","GMRCSTLM",155,0)
 S VALMCNT=GMRCCT
"RTN","GMRCSTLM",156,0)
 I $D(IOBM),$D(IOTM) S VALMBCK="R"
"RTN","GMRCSTLM",157,0)
EXIT Q
"RTN","GMRCSTLM",158,0)
 ;
"RTN","GMRCSTU")
0^5^B57743004
"RTN","GMRCSTU",1,0)
GMRCSTU ;SLC/DCM,dee - Statistic Utilities for Consult/Request Package ;02/03/00
"RTN","GMRCSTU",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**1,7**;DEC 27, 1997
"RTN","GMRCSTU",3,0)
 Q
"RTN","GMRCSTU",4,0)
 ;
"RTN","GMRCSTU",5,0)
GETDT(GMRCO) ;get the date that the consult/request was accepted by service
"RTN","GMRCSTU",6,0)
 N ND,GMRCDA
"RTN","GMRCSTU",7,0)
 S COMPLDT=9999999
"RTN","GMRCSTU",8,0)
 S ND=0 F  S ND=$O(^GMR(123,GMRCO,40,ND)) Q:ND?1A.E!(ND="")  D
"RTN","GMRCSTU",9,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=21 GMRCDA=$P(^(0),"^",1)
"RTN","GMRCSTU",10,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=1 GMRCDA(1)=$P(^(0),"^",1)
"RTN","GMRCSTU",11,0)
 .S:$P(^GMR(123,GMRCO,40,ND,0),"^",2)=15 GMRCDA(15)=$P(^(0),"^",3)
"RTN","GMRCSTU",12,0)
 .I $P(^GMR(123,GMRCO,40,ND,0),"^",2)=10,$P(^(0),"^",3)<COMPLDT S COMPLDT=$P(^(0),"^",3)
"RTN","GMRCSTU",13,0)
 S RCVDT=$S($D(GMRCDA)#2:GMRCDA,$D(GMRCDA(1)):GMRCDA(1),$D(GMRCDA(15)):GMRCDA(15),1:$P(^GMR(123,GMRCO,0),"^",1))
"RTN","GMRCSTU",14,0)
 Q
"RTN","GMRCSTU",15,0)
EN ;
"RTN","GMRCSTU",16,0)
 K ^TMP("GMRCSLIST",$J),GMRCQUT
"RTN","GMRCSTU",17,0)
 ;Get the service/grouper
"RTN","GMRCSTU",18,0)
 D ASRV^GMRCASV
"RTN","GMRCSTU",19,0)
 G:$D(GMRCQUT) KILL
"RTN","GMRCSTU",20,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 G KILL
"RTN","GMRCSTU",21,0)
 ;Get the date range
"RTN","GMRCSTU",22,0)
 D ^GMRCSPD
"RTN","GMRCSTU",23,0)
 G:$D(GMRCQUT) KILL
"RTN","GMRCSTU",24,0)
 Q
"RTN","GMRCSTU",25,0)
 ;
"RTN","GMRCSTU",26,0)
ENOR(RETURN,GMRCSRVC,GMRCDT1,GMRCDT2) ;Entry point for GUI interface.
"RTN","GMRCSTU",27,0)
 ;.RETURN:   This is the root to the returned temp array.
"RTN","GMRCSTU",28,0)
 ;GMRCSRVC:  Service for which consults are to be displayed.
"RTN","GMRCSTU",29,0)
 ;GMRCDT1:  Starting date or "ALL"
"RTN","GMRCSTU",30,0)
 ;GMRCDT2:  Ending date if not GMRCDT1="ALL"
"RTN","GMRCSTU",31,0)
 ;
"RTN","GMRCSTU",32,0)
 ;^TMP("GMRCSLIST",$J,n)=ien^name^parient ien^"+" if grouper^status
"RTN","GMRCSTU",33,0)
 ;  status is "" tracking and/or grouper
"RTN","GMRCSTU",34,0)
 ;            1  grouper only
"RTN","GMRCSTU",35,0)
 ;            2  tracking only
"RTN","GMRCSTU",36,0)
 ;            9  disabled
"RTN","GMRCSTU",37,0)
 ;
"RTN","GMRCSTU",38,0)
 N GMRCEDT1,GMRCEDT2,GMRCDG,GMRCHEAD,GMRCCT,GMRCGRP,VALMCNT,VALMBCK
"RTN","GMRCSTU",39,0)
 N GMRCWRIT
"RTN","GMRCSTU",40,0)
 S GMRCWRIT=0
"RTN","GMRCSTU",41,0)
 K ^TMP("GMRCR",$J,"PRL")
"RTN","GMRCSTU",42,0)
 S RETURN="^TMP(""GMRCR"",$J,""PRL"")"
"RTN","GMRCSTU",43,0)
 I '($D(GMRCSRVC)#2) S GMRCSRVC=1
"RTN","GMRCSTU",44,0)
 Q:'$D(^GMR(123.5,$G(GMRCSRVC),0))
"RTN","GMRCSTU",45,0)
 ;Build service array
"RTN","GMRCSTU",46,0)
 S GMRCDG=GMRCSRVC
"RTN","GMRCSTU",47,0)
 D SERV1^GMRCASV
"RTN","GMRCSTU",48,0)
 ;Get external form of date range
"RTN","GMRCSTU",49,0)
 I '($D(GMRCDT1)#2) S GMRCDT1="ALL"
"RTN","GMRCSTU",50,0)
 S:GMRCDT1="ALL" GMRCDT2=0
"RTN","GMRCSTU",51,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,$G(GMRCDT2),.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTU",52,0)
 G ODTSTR
"RTN","GMRCSTU",53,0)
 ;
"RTN","GMRCSTU",54,0)
ODT ;List Manager entry point
"RTN","GMRCSTU",55,0)
 N GMRCWRIT
"RTN","GMRCSTU",56,0)
 S GMRCWRIT=1
"RTN","GMRCSTU",57,0)
 D WAIT^DICD
"RTN","GMRCSTU",58,0)
 ;
"RTN","GMRCSTU",59,0)
ODTSTR ;Find the mean, standard deviation of how long to complete a consult from when it is accepted in the service to when it is complete
"RTN","GMRCSTU",60,0)
 N RCVDT,COMPLDT,INDEX,TEMPTMP,GROUPER,TAB
"RTN","GMRCSTU",61,0)
 N GMRCDG,GMRCDGT,GMRCDT
"RTN","GMRCSTU",62,0)
 N GMRCGRP,GMRCND,GMRCO,ND,X,X1,X2
"RTN","GMRCSTU",63,0)
 I '$O(^TMP("GMRCSLIST",$J,0)) S GMRCQUT=1 G KILL
"RTN","GMRCSTU",64,0)
 S INDEX=0
"RTN","GMRCSTU",65,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX)) Q:INDEX=""  D
"RTN","GMRCSTU",66,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",67,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",68,0)
 .S GMRCSVC(1,ND,"T")="0^0^0^0^0^0"
"RTN","GMRCSTU",69,0)
 .S GMRCSVC(1,ND,"I")="0^0^0^0^0"
"RTN","GMRCSTU",70,0)
 .S GMRCSVC(1,ND,"O")="0^0^0^0^0"
"RTN","GMRCSTU",71,0)
 .S GMRCSVC(1,ND,"U")="0^0^0^0^0"
"RTN","GMRCSTU",72,0)
 .S GMRCSVC(2,ND,"T")="0^0^0^0^0^0"
"RTN","GMRCSTU",73,0)
 .S GMRCSVC(2,ND,"I")="0^0^0^0^0"
"RTN","GMRCSTU",74,0)
 .S GMRCSVC(2,ND,"O")="0^0^0^0^0"
"RTN","GMRCSTU",75,0)
 .S GMRCSVC(2,ND,"U")="0^0^0^0^0"
"RTN","GMRCSTU",76,0)
 S GMRCND=0
"RTN","GMRCSTU",77,0)
 S INDEX=""
"RTN","GMRCSTU",78,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX),-1) Q:INDEX=""  D
"RTN","GMRCSTU",79,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",80,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",81,0)
 .Q:$P(GMRCSVC(1,ND,"T"),"^",2)>0
"RTN","GMRCSTU",82,0)
 .I $P(^TMP("GMRCSLIST",$J,INDEX),"^",5)'=1 D
"RTN","GMRCSTU",83,0)
 ..S GMRCDT=""
"RTN","GMRCSTU",84,0)
 ..F  S GMRCDT=$O(^GMR(123,"AE",ND,2,GMRCDT)) Q:GMRCDT=""  D
"RTN","GMRCSTU",85,0)
 ...S GMRCO=0
"RTN","GMRCSTU",86,0)
 ...F  S GMRCO=$O(^GMR(123,"AE",ND,2,GMRCDT,GMRCO)) Q:GMRCO=""  D  W:GMRCWRIT&'(GMRCND#25) "."
"RTN","GMRCSTU",87,0)
 ....D GETDT(GMRCO)
"RTN","GMRCSTU",88,0)
 ....I COMPLDT<9999999,$S(GMRCDT1="ALL":1,RCVDT'<GMRCDT1&(RCVDT'>GMRCDT2):1,1:0) D
"RTN","GMRCSTU",89,0)
 .....S X1=COMPLDT
"RTN","GMRCSTU",90,0)
 .....S X2=RCVDT
"RTN","GMRCSTU",91,0)
 .....D ^%DTC
"RTN","GMRCSTU",92,0)
 .....S $P(GMRCSVC(1,ND,"T"),"^",1)=$P(GMRCSVC(1,ND,"T"),"^",1)+X
"RTN","GMRCSTU",93,0)
 .....S $P(GMRCSVC(1,ND,"T"),"^",2)=$P(GMRCSVC(1,ND,"T"),"^",2)+1
"RTN","GMRCSTU",94,0)
 .....S $P(GMRCSVC(1,ND,"T"),"^",3)=$P(GMRCSVC(1,ND,"T"),"^",3)+(X*X)
"RTN","GMRCSTU",95,0)
 .....I $P(^GMR(123,GMRCO,0),"^",18)="I" D
"RTN","GMRCSTU",96,0)
 ......S $P(GMRCSVC(1,ND,"I"),"^",1)=$P(GMRCSVC(1,ND,"I"),"^",1)+X
"RTN","GMRCSTU",97,0)
 ......S $P(GMRCSVC(1,ND,"I"),"^",2)=$P(GMRCSVC(1,ND,"I"),"^",2)+1
"RTN","GMRCSTU",98,0)
 ......S $P(GMRCSVC(1,ND,"I"),"^",3)=$P(GMRCSVC(1,ND,"I"),"^",3)+(X*X)
"RTN","GMRCSTU",99,0)
 .....E  I $P(^GMR(123,GMRCO,0),"^",18)="O" D
"RTN","GMRCSTU",100,0)
 ......S $P(GMRCSVC(1,ND,"O"),"^",1)=$P(GMRCSVC(1,ND,"O"),"^",1)+X
"RTN","GMRCSTU",101,0)
 ......S $P(GMRCSVC(1,ND,"O"),"^",2)=$P(GMRCSVC(1,ND,"O"),"^",2)+1
"RTN","GMRCSTU",102,0)
 ......S $P(GMRCSVC(1,ND,"O"),"^",3)=$P(GMRCSVC(1,ND,"O"),"^",3)+(X*X)
"RTN","GMRCSTU",103,0)
 .....E  D
"RTN","GMRCSTU",104,0)
 ......S $P(GMRCSVC(1,ND,"U"),"^",1)=$P(GMRCSVC(1,ND,"U"),"^",1)+X
"RTN","GMRCSTU",105,0)
 ......S $P(GMRCSVC(1,ND,"U"),"^",2)=$P(GMRCSVC(1,ND,"U"),"^",2)+1
"RTN","GMRCSTU",106,0)
 ......S $P(GMRCSVC(1,ND,"U"),"^",3)=$P(GMRCSVC(1,ND,"U"),"^",3)+(X*X)
"RTN","GMRCSTU",107,0)
 .....S GMRCND=GMRCND+1
"RTN","GMRCSTU",108,0)
 .D PARENTS^GMRCSTU1(ND,+$P(^TMP("GMRCSLIST",$J,INDEX),"^",3))
"RTN","GMRCSTU",109,0)
 S ND=0
"RTN","GMRCSTU",110,0)
STAT ;Do the statistics
"RTN","GMRCSTU",111,0)
 F  S ND=$O(GMRCSVC(2,ND)) Q:ND=""  D
"RTN","GMRCSTU",112,0)
 .I $P($G(GMRCSVC(1,ND,"T")),"^",1)>0 D DOSTAT^GMRCSTU1(1,ND)
"RTN","GMRCSTU",113,0)
 .I $P(GMRCSVC(2,ND,"T"),"^",1)>0 D DOSTAT^GMRCSTU1(2,ND)
"RTN","GMRCSTU",114,0)
 K ^TMP("GMRCR",$J,"PRL")
"RTN","GMRCSTU",115,0)
 S GMRCCT=0
"RTN","GMRCSTU",116,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCSTU",117,0)
 S TAB=""
"RTN","GMRCSTU",118,0)
 S $P(TAB," ",40)=""
"RTN","GMRCSTU",119,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",120,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,19)_"Consult/Request Completion Time Statistics"
"RTN","GMRCSTU",121,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",122,0)
 S TEMPTMP="FROM: "_GMRCEDT1_"   TO: "_GMRCEDT2
"RTN","GMRCSTU",123,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,40-($L(TEMPTMP)/2))_TEMPTMP
"RTN","GMRCSTU",124,0)
 S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",125,0)
 S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=""
"RTN","GMRCSTU",126,0)
 S INDEX=0
"RTN","GMRCSTU",127,0)
 S GROUPER=0
"RTN","GMRCSTU",128,0)
 S GROUPER(0)=0
"RTN","GMRCSTU",129,0)
 F  S INDEX=$O(^TMP("GMRCSLIST",$J,INDEX)) Q:INDEX=""  D
"RTN","GMRCSTU",130,0)
 .S ND=$P(^TMP("GMRCSLIST",$J,INDEX),"^",1)
"RTN","GMRCSTU",131,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9&'$D(GMRCSVC(2,ND))
"RTN","GMRCSTU",132,0)
 .F  Q:GROUPER(GROUPER)=$P(^TMP("GMRCSLIST",$J,INDEX),"^",3)  D
"RTN","GMRCSTU",133,0)
 ..;End of a group so print the group totals
"RTN","GMRCSTU",134,0)
 ..D SERVSTAT^GMRCSTU1(.GMRCCT,2,GROUPER(GROUPER),GROUPER(GROUPER))
"RTN","GMRCSTU",135,0)
 ..;pop grouper from stack
"RTN","GMRCSTU",136,0)
 ..S GROUPER=GROUPER-1
"RTN","GMRCSTU",137,0)
 .I $P(^TMP("GMRCSLIST",$J,INDEX),"^",4)="+" D
"RTN","GMRCSTU",138,0)
 ..;Start of a new group so print the group heading.
"RTN","GMRCSTU",139,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",140,0)
 ..S TEMPTMP="GROUPER: "_$P(^GMR(123.5,ND,0),"^",1)
"RTN","GMRCSTU",141,0)
 ..S:$P(^TMP("GMRCSLIST",$J,INDEX),"^",3)>0 TEMPTMP=TEMPTMP_"  in Group: "_$P(^GMR(123.5,$P(^TMP("GMRCSLIST",$J,INDEX),"^",3),0),"^",1)
"RTN","GMRCSTU",142,0)
 ..S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,40-(($L(TEMPTMP)/2)+.5))_TEMPTMP
"RTN","GMRCSTU",143,0)
 ..S GMRCCT=GMRCCT+1
"RTN","GMRCSTU",144,0)
 ..S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=""
"RTN","GMRCSTU",145,0)
 ..;push new grouper on stack
"RTN","GMRCSTU",146,0)
 ..S GROUPER=GROUPER+1
"RTN","GMRCSTU",147,0)
 ..S GROUPER(GROUPER)=ND
"RTN","GMRCSTU",148,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=1
"RTN","GMRCSTU",149,0)
 .Q:$P(^TMP("GMRCSLIST",$J,INDEX),"^",5)=9
"RTN","GMRCSTU",150,0)
 .D SERVSTAT^GMRCSTU1(.GMRCCT,1,ND,GROUPER(GROUPER))
"RTN","GMRCSTU",151,0)
 ;Now list the group totals for the current groups.
"RTN","GMRCSTU",152,0)
 F GROUPER=GROUPER:-1:1 D
"RTN","GMRCSTU",153,0)
 .;End of a group so print the group totals
"RTN","GMRCSTU",154,0)
 .D SERVSTAT^GMRCSTU1(.GMRCCT,2,GROUPER(GROUPER),GROUPER(GROUPER))
"RTN","GMRCSTU",155,0)
 ;Done building list.
"RTN","GMRCSTU",156,0)
 S VALMCNT=GMRCCT,VALMBCK="R"
"RTN","GMRCSTU",157,0)
KILL ;kill variables and exit
"RTN","GMRCSTU",158,0)
 S:$D(GMRCQUT) VALMBCK="Q"
"RTN","GMRCSTU",159,0)
 K ^TMP("GMRCS",$J),^TMP("GMRCSLIST",$J)
"RTN","GMRCSTU",160,0)
 Q
"RTN","GMRCSTU",161,0)
PRNT ;print statistics to a printer
"RTN","GMRCSTU",162,0)
 ;Called from a List Manager action
"RTN","GMRCSTU",163,0)
 Q:'$D(^TMP("GMRCR",$J,"PRL",2,0))
"RTN","GMRCSTU",164,0)
 I $D(IOTM),$D(IOBM),$D(IOSTBM) D FULL^VALM1
"RTN","GMRCSTU",165,0)
 D PRNTASK
"RTN","GMRCSTU",166,0)
 D PRNTIT("PRL","PRNTQ^GMRCSTU","CONSULT/REQUEST PACKAGE PRINT COMPLETION TIME STATISTICS FROM LIST MANAGER DISPLAY")
"RTN","GMRCSTU",167,0)
 Q
"RTN","GMRCSTU",168,0)
 ;
"RTN","GMRCSTU",169,0)
PRNTASK ;Ask for device
"RTN","GMRCSTU",170,0)
 N POP
"RTN","GMRCSTU",171,0)
 K GMRCQUT
"RTN","GMRCSTU",172,0)
 S POP=0
"RTN","GMRCSTU",173,0)
 S %ZIS="MQ"
"RTN","GMRCSTU",174,0)
 D ^%ZIS
"RTN","GMRCSTU",175,0)
 I POP D  Q
"RTN","GMRCSTU",176,0)
 .S GMRCMSG="Printer Busy. Try Again Later."
"RTN","GMRCSTU",177,0)
 .D EXAC^GMRCADC(GMRCMSG)
"RTN","GMRCSTU",178,0)
 .K GMRCMSG
"RTN","GMRCSTU",179,0)
 .S GMRCQUT=1
"RTN","GMRCSTU",180,0)
 Q
"RTN","GMRCSTU",181,0)
 ;
"RTN","GMRCSTU",182,0)
PRNTIT(TMPNAME,QUERTN,QUEDESC) ;Send list to printer
"RTN","GMRCSTU",183,0)
 N ANSWER,INDEX,DOLLARH
"RTN","GMRCSTU",184,0)
 I $D(IO("Q")) D  Q
"RTN","GMRCSTU",185,0)
 .S DOLLARH=$H
"RTN","GMRCSTU",186,0)
 .M ^XTMP("GMRCR","$"_$J,DOLLARH,"PRINT")=^TMP("GMRCR",$J,TMPNAME)
"RTN","GMRCSTU",187,0)
 .S ZTRTN=QUERTN
"RTN","GMRCSTU",188,0)
 .S ZTDESC=QUEDESC
"RTN","GMRCSTU",189,0)
 .S ZTSAVE("J")="$"_$J
"RTN","GMRCSTU",190,0)
 .S ZTSAVE("DOLLARH")=""
"RTN","GMRCSTU",191,0)
 .S ZTSAVE("TMPNAME")=""
"RTN","GMRCSTU",192,0)
 .S ZTSAVE("GMRCDG")=""
"RTN","GMRCSTU",193,0)
 .S ZTSAVE("GMRCDT1")=""
"RTN","GMRCSTU",194,0)
 .S ZTSAVE("GMRCDT2")=""
"RTN","GMRCSTU",195,0)
 .D ^%ZTLOAD,^%ZISC
"RTN","GMRCSTU",196,0)
 .S VALMBCK="R"
"RTN","GMRCSTU",197,0)
 U IO
"RTN","GMRCSTU",198,0)
 S ANSWER=""
"RTN","GMRCSTU",199,0)
 S INDEX=""
"RTN","GMRCSTU",200,0)
 F  S INDEX=$O(^TMP("GMRCR",$J,TMPNAME,INDEX)) Q:INDEX=""  W ^TMP("GMRCR",$J,TMPNAME,INDEX,0),! I IOST["C-",$S($D(IOSL)#2:$Y>(IOSL-2),1:$Y>22) R "Press <ENTER> To Continue, '^' To Quit: ",ANSWER:DTIME Q:'$T!(ANSWER["^")  W @IOF
"RTN","GMRCSTU",201,0)
 I ANSWER'["^",IOST["C-",$Y>1 R !,"Press <ENTER> To Continue: ",ANSWER:DTIME
"RTN","GMRCSTU",202,0)
 U IO(0)
"RTN","GMRCSTU",203,0)
 D ^%ZISC
"RTN","GMRCSTU",204,0)
 S VALMBCK="R"
"RTN","GMRCSTU",205,0)
 Q
"RTN","GMRCSTU",206,0)
 ;
"RTN","GMRCSTU",207,0)
PRNTQ ;Print Queued report from ^XTMP global then kill off ^XTMP
"RTN","GMRCSTU",208,0)
 N INDEX
"RTN","GMRCSTU",209,0)
 U IO
"RTN","GMRCSTU",210,0)
 S INDEX=""
"RTN","GMRCSTU",211,0)
 F  S INDEX=$O(^XTMP("GMRCR",J,DOLLARH,"PRINT",INDEX)) Q:INDEX=""  W ^XTMP("GMRCR",J,DOLLARH,"PRINT",INDEX,0),!
"RTN","GMRCSTU",212,0)
 K ^XTMP("GMRCR",J,DOLLARH,"PRINT"),J,DOLLARH
"RTN","GMRCSTU",213,0)
 D ^%ZISC
"RTN","GMRCSTU",214,0)
 Q
"RTN","GMRCSTU1")
0^7^B39143573
"RTN","GMRCSTU1",1,0)
GMRCSTU1 ;SLC/DCM,dee - Statistic Utilities for Consult/Request Package ;2/1/00
"RTN","GMRCSTU1",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**7**;DEC 27, 1997
"RTN","GMRCSTU1",3,0)
 Q
"RTN","GMRCSTU1",4,0)
 ;
"RTN","GMRCSTU1",5,0)
SQRT(X) ;calculate the square root of number X
"RTN","GMRCSTU1",6,0)
 Q X**.5
"RTN","GMRCSTU1",7,0)
 ;
"RTN","GMRCSTU1",8,0)
PARENTS(ND,PARENT) ;Add totals for service to itself as a parent and to its parent service
"RTN","GMRCSTU1",9,0)
 ; ND      This service in GMRCSVC
"RTN","GMRCSTU1",10,0)
 ; PARENT  This services grouper in GMRCSVC
"RTN","GMRCSTU1",11,0)
 N ND2
"RTN","GMRCSTU1",12,0)
 F ND2="T","I","O","U" D
"RTN","GMRCSTU1",13,0)
 .S $P(GMRCSVC(2,ND,ND2),"^",1)=$P(GMRCSVC(2,ND,ND2),"^",1)+$P(GMRCSVC(1,ND,ND2),"^",1)
"RTN","GMRCSTU1",14,0)
 .S $P(GMRCSVC(2,ND,ND2),"^",2)=$P(GMRCSVC(2,ND,ND2),"^",2)+$P(GMRCSVC(1,ND,ND2),"^",2)
"RTN","GMRCSTU1",15,0)
 .S $P(GMRCSVC(2,ND,ND2),"^",3)=$P(GMRCSVC(2,ND,ND2),"^",3)+$P(GMRCSVC(1,ND,ND2),"^",3)
"RTN","GMRCSTU1",16,0)
 .I PARENT D
"RTN","GMRCSTU1",17,0)
 ..S $P(GMRCSVC(2,PARENT,ND2),"^",1)=$P($G(GMRCSVC(2,PARENT,ND2)),"^",1)+$P(GMRCSVC(2,ND,ND2),"^",1)
"RTN","GMRCSTU1",18,0)
 ..S $P(GMRCSVC(2,PARENT,ND2),"^",2)=$P($G(GMRCSVC(2,PARENT,ND2)),"^",2)+$P(GMRCSVC(2,ND,ND2),"^",2)
"RTN","GMRCSTU1",19,0)
 ..S $P(GMRCSVC(2,PARENT,ND2),"^",3)=$P($G(GMRCSVC(2,PARENT,ND2)),"^",3)+$P(GMRCSVC(2,ND,ND2),"^",3)
"RTN","GMRCSTU1",20,0)
 Q
"RTN","GMRCSTU1",21,0)
 ;
"RTN","GMRCSTU1",22,0)
DOSTAT(GEN,ND) ;Do the number crunching for the statistics
"RTN","GMRCSTU1",23,0)
 ; GEN    1 if service
"RTN","GMRCSTU1",24,0)
 ;        2 if grouper
"RTN","GMRCSTU1",25,0)
 ; ND      This service in GMRCSVC
"RTN","GMRCSTU1",26,0)
 N VAR,SUMX
"RTN","GMRCSTU1",27,0)
 S VAR=$P(GMRCSVC(GEN,ND,"T"),"^",2)
"RTN","GMRCSTU1",28,0)
 S $P(GMRCSVC(GEN,ND,"T"),"^",4)=$P(GMRCSVC(GEN,ND,"T"),"^",1)/VAR
"RTN","GMRCSTU1",29,0)
 I VAR>1 D
"RTN","GMRCSTU1",30,0)
 .S SUMX=$P(GMRCSVC(GEN,ND,"T"),"^",1)
"RTN","GMRCSTU1",31,0)
 .S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",32,0)
 .S SUMX=($P(GMRCSVC(GEN,ND,"T"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",33,0)
 .S $P(GMRCSVC(GEN,ND,"T"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",34,0)
 E  S $P(GMRCSVC(GEN,ND,"T"),"^",5)="N<2"
"RTN","GMRCSTU1",35,0)
 S VAR=$P(GMRCSVC(GEN,ND,"I"),"^",2)
"RTN","GMRCSTU1",36,0)
 I VAR>0 D
"RTN","GMRCSTU1",37,0)
 .S $P(GMRCSVC(GEN,ND,"I"),"^",4)=$P(GMRCSVC(GEN,ND,"I"),"^",1)/VAR
"RTN","GMRCSTU1",38,0)
 .I VAR>1 D
"RTN","GMRCSTU1",39,0)
 ..S SUMX=$P(GMRCSVC(GEN,ND,"I"),"^",1)
"RTN","GMRCSTU1",40,0)
 ..S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",41,0)
 ..S SUMX=($P(GMRCSVC(GEN,ND,"I"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",42,0)
 ..S $P(GMRCSVC(GEN,ND,"I"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",43,0)
 .E  S $P(GMRCSVC(GEN,ND,"I"),"^",5)="N<2"
"RTN","GMRCSTU1",44,0)
 S VAR=$P(GMRCSVC(GEN,ND,"O"),"^",2)
"RTN","GMRCSTU1",45,0)
 I VAR>0 D
"RTN","GMRCSTU1",46,0)
 .S $P(GMRCSVC(GEN,ND,"O"),"^",4)=$P(GMRCSVC(GEN,ND,"O"),"^",1)/VAR
"RTN","GMRCSTU1",47,0)
 .I VAR>1 D
"RTN","GMRCSTU1",48,0)
 ..S SUMX=$P(GMRCSVC(GEN,ND,"O"),"^",1)
"RTN","GMRCSTU1",49,0)
 ..S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",50,0)
 ..S SUMX=($P(GMRCSVC(GEN,ND,"O"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",51,0)
 ..S $P(GMRCSVC(GEN,ND,"O"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",52,0)
 .E  S $P(GMRCSVC(GEN,ND,"O"),"^",5)="N<2"
"RTN","GMRCSTU1",53,0)
 S VAR=$P(GMRCSVC(GEN,ND,"U"),"^",2)
"RTN","GMRCSTU1",54,0)
 I VAR>0 D
"RTN","GMRCSTU1",55,0)
 .S $P(GMRCSVC(GEN,ND,"U"),"^",4)=$P(GMRCSVC(GEN,ND,"U"),"^",1)/VAR
"RTN","GMRCSTU1",56,0)
 .I VAR>1 D
"RTN","GMRCSTU1",57,0)
 ..S SUMX=$P(GMRCSVC(GEN,ND,"U"),"^",1)
"RTN","GMRCSTU1",58,0)
 ..S SUMX=SUMX*SUMX/VAR
"RTN","GMRCSTU1",59,0)
 ..S SUMX=($P(GMRCSVC(GEN,ND,"U"),"^",3)-SUMX)/(VAR-1)
"RTN","GMRCSTU1",60,0)
 ..S $P(GMRCSVC(GEN,ND,"U"),"^",5)=$$SQRT(SUMX)
"RTN","GMRCSTU1",61,0)
 .E  S $P(GMRCSVC(GEN,ND,"U"),"^",5)="N<2"
"RTN","GMRCSTU1",62,0)
 Q
"RTN","GMRCSTU1",63,0)
 ;
"RTN","GMRCSTU1",64,0)
LISTDATE(GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2) ;Change dates to display format
"RTN","GMRCSTU1",65,0)
 ; Input:
"RTN","GMRCSTU1",66,0)
 ;  GMRCDT1  Start date in FM format, can be "ALL" for all dates
"RTN","GMRCSTU1",67,0)
 ;  GMRCDT2  End date in FM format, can be null if GMRCDT1 is "ALL"
"RTN","GMRCSTU1",68,0)
 ; Output:
"RTN","GMRCSTU1",69,0)
 ;  GMRCEDT1 Start date in external format
"RTN","GMRCSTU1",70,0)
 ;  GMRCEDT2 End date in extenal format
"RTN","GMRCSTU1",71,0)
 ;
"RTN","GMRCSTU1",72,0)
 S GMRCEDT1=$$FMTE^XLFDT(GMRCDT1)
"RTN","GMRCSTU1",73,0)
 S GMRCEDT2=$$FMTE^XLFDT(GMRCDT2)
"RTN","GMRCSTU1",74,0)
 I GMRCEDT1'="ALL" D
"RTN","GMRCSTU1",75,0)
 .S Y=GMRCEDT1
"RTN","GMRCSTU1",76,0)
 .X ^DD("DD")
"RTN","GMRCSTU1",77,0)
 .S GMRCEDT1=$P(Y,"@",1)
"RTN","GMRCSTU1",78,0)
 .K %,%DT,%H,%I
"RTN","GMRCSTU1",79,0)
 I GMRCEDT2=0 D
"RTN","GMRCSTU1",80,0)
 .S X="NOW"
"RTN","GMRCSTU1",81,0)
 .D NOW^%DTC
"RTN","GMRCSTU1",82,0)
 .S Y=%
"RTN","GMRCSTU1",83,0)
 .K %,%DT,%H,%I
"RTN","GMRCSTU1",84,0)
 .X ^DD("DD")
"RTN","GMRCSTU1",85,0)
 .S GMRCEDT2=$P(Y,"@",1)
"RTN","GMRCSTU1",86,0)
 Q
"RTN","GMRCSTU1",87,0)
 ;
"RTN","GMRCSTU1",88,0)
SERVSTAT(COUNT,GEN,ND,GRP) ;Build list for a service or a grouper
"RTN","GMRCSTU1",89,0)
 ; COUNT  subscript in to the array ^TMP("GMRCR"
"RTN","GMRCSTU1",90,0)
 ; GEN    1 if service
"RTN","GMRCSTU1",91,0)
 ;        2 if grouper
"RTN","GMRCSTU1",92,0)
 ; ND     Pointer to this this service in GMRCSVC
"RTN","GMRCSTU1",93,0)
 ; GRP    Pointer to grouper that this service is in ^GMR(123.5
"RTN","GMRCSTU1",94,0)
 ;        (If this is not a grouper i.e. GEN=2)
"RTN","GMRCSTU1",95,0)
 ;
"RTN","GMRCSTU1",96,0)
 N TEMP,NUMBER
"RTN","GMRCSTU1",97,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",98,0)
 I GEN=1 D
"RTN","GMRCSTU1",99,0)
 .S TEMP="SERVICE: "_$P(^GMR(123.5,ND,0),"^",1)
"RTN","GMRCSTU1",100,0)
 .S:GRP>0 TEMP=TEMP_"  in Group: "_$P(^GMR(123.5,GRP,0),"^",1)
"RTN","GMRCSTU1",101,0)
 .S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=TEMP
"RTN","GMRCSTU1",102,0)
 E  D
"RTN","GMRCSTU1",103,0)
 .S TEMP="GROUPER: "_$P(^GMR(123.5,ND,0),"^",1)_" Totals:"
"RTN","GMRCSTU1",104,0)
 .S ^TMP("GMRCR",$J,"PRL",GMRCCT,0)=$E(TAB,1,10)_TEMP
"RTN","GMRCSTU1",105,0)
 S NUMBER=$P(GMRCSVC(GEN,ND,"T"),"^",2)
"RTN","GMRCSTU1",106,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",107,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total Number Of Consults Completed: "_NUMBER
"RTN","GMRCSTU1",108,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",109,0)
 S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",110,0)
 S:NUMBER>0 TEMP=TEMP_$J($P(GMRCSVC(GEN,ND,"T"),"^",4),4,1)
"RTN","GMRCSTU1",111,0)
 S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",112,0)
 I NUMBER>0 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP_$S($P(GMRCSVC(GEN,ND,"T"),"^",5)=+$P(GMRCSVC(GEN,ND,"T"),"^",5):$J($P(GMRCSVC(GEN,ND,"T"),"^",5),4,1),1:$P(GMRCSVC(GEN,ND,"T"),"^",5))
"RTN","GMRCSTU1",113,0)
 E  S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",114,0)
 S NUMBER=$P(GMRCSVC(GEN,ND,"I"),"^",2)
"RTN","GMRCSTU1",115,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",116,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total INPATIENT Consults: "_NUMBER
"RTN","GMRCSTU1",117,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",118,0)
 S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",119,0)
 S:NUMBER>0 TEMP=TEMP_$J($P(GMRCSVC(GEN,ND,"I"),"^",4),4,1)
"RTN","GMRCSTU1",120,0)
 S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",121,0)
 I NUMBER>0 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP_$S($P(GMRCSVC(GEN,ND,"I"),"^",5)=+$P(GMRCSVC(GEN,ND,"I"),"^",5):$J($P(GMRCSVC(GEN,ND,"I"),"^",5),4,1),1:$P(GMRCSVC(GEN,ND,"I"),"^",5))
"RTN","GMRCSTU1",122,0)
 E  S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",123,0)
 S NUMBER=$P(GMRCSVC(GEN,ND,"O"),"^",2)
"RTN","GMRCSTU1",124,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",125,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total OUTPATIENT Consults: "_NUMBER
"RTN","GMRCSTU1",126,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",127,0)
 S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",128,0)
 S:NUMBER>0 TEMP=TEMP_$J($P(GMRCSVC(GEN,ND,"O"),"^",4),4,1)
"RTN","GMRCSTU1",129,0)
 S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",130,0)
 I NUMBER>0 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP_$S($P(GMRCSVC(GEN,ND,"O"),"^",5)=+$P(GMRCSVC(GEN,ND,"O"),"^",5):$J($P(GMRCSVC(GEN,ND,"O"),"^",5),4,1),1:$P(GMRCSVC(GEN,ND,"O"),"^",5))
"RTN","GMRCSTU1",131,0)
 E  S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",132,0)
 I $P(GMRCSVC(GEN,ND,"U"),"^",2)>0 D
"RTN","GMRCSTU1",133,0)
 .S NUMBER=$P(GMRCSVC(GEN,ND,"U"),"^",2)
"RTN","GMRCSTU1",134,0)
 .S COUNT=COUNT+1
"RTN","GMRCSTU1",135,0)
 .S ^TMP("GMRCR",$J,"PRL",COUNT,0)="Total Unclassified Consults: "_NUMBER
"RTN","GMRCSTU1",136,0)
 .S COUNT=COUNT+1
"RTN","GMRCSTU1",137,0)
 .S TEMP="Mean Days To Complete: "
"RTN","GMRCSTU1",138,0)
 .S:NUMBER>0 TEMP=TEMP_$J($P(GMRCSVC(GEN,ND,"U"),"^",4),4,1)
"RTN","GMRCSTU1",139,0)
 .S TEMP=TEMP_$E(TAB,1,50-$L(TEMP))_"Standard Deviation: "
"RTN","GMRCSTU1",140,0)
 .I NUMBER>0 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP_$S($P(GMRCSVC(GEN,ND,"U"),"^",5)=+$P(GMRCSVC(GEN,ND,"U"),"^",5):$J($P(GMRCSVC(GEN,ND,"U"),"^",5),4,1),1:$P(GMRCSVC(GEN,ND,"U"),"^",5))
"RTN","GMRCSTU1",141,0)
 .E  S ^TMP("GMRCR",$J,"PRL",COUNT,0)=TEMP
"RTN","GMRCSTU1",142,0)
 I +$P(GMRCSVC(GEN,ND,"T"),"^",6)>0 S COUNT=COUNT+1,^TMP("GMRCR",$J,"PRL",COUNT,0)="No. With Unresolved Accepted in Service Times: "_$J($P(GMRCSVC(GEN,ND,"T"),"^",6),3)_"  (Not Included In Statistics)"
"RTN","GMRCSTU1",143,0)
 S COUNT=COUNT+1
"RTN","GMRCSTU1",144,0)
 S ^TMP("GMRCR",$J,"PRL",COUNT,0)=""
"RTN","GMRCSTU1",145,0)
 Q
"RTN","GMRCSUBS")
0^11^B3817453
"RTN","GMRCSUBS",1,0)
GMRCSUBS ;SLC/dee - Routine to check if a Service has more that one parient service ;1/18/00
"RTN","GMRCSUBS",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**7**;DEC 27, 1997
"RTN","GMRCSUBS",3,0)
 ;
"RTN","GMRCSUBS",4,0)
 Q
"RTN","GMRCSUBS",5,0)
EN ;Check the service hierarchy (file #123.5) for services
"RTN","GMRCSUBS",6,0)
 ; that have more than are in more than one grouper.
"RTN","GMRCSUBS",7,0)
 N SERVICE,PARENT,COUNT,NUMBER
"RTN","GMRCSUBS",8,0)
 S NUMBER=0
"RTN","GMRCSUBS",9,0)
 ;$Order though all Services
"RTN","GMRCSUBS",10,0)
 S SERVICE=0
"RTN","GMRCSUBS",11,0)
 F  S SERVICE=$O(^GMR(123.5,SERVICE)) Q:'+SERVICE  D
"RTN","GMRCSUBS",12,0)
 . S PARENT=0
"RTN","GMRCSUBS",13,0)
 . ;Check if they are a subservice to more than one service.
"RTN","GMRCSUBS",14,0)
 . F COUNT=0:1 S PARENT=$O(^GMR(123.5,"APC",SERVICE,PARENT)) Q:'+PARENT  D
"RTN","GMRCSUBS",15,0)
 .. ;
"RTN","GMRCSUBS",16,0)
 . ;Print message about which services this service is a subservice of.
"RTN","GMRCSUBS",17,0)
 . I COUNT>1 D
"RTN","GMRCSUBS",18,0)
 .. W !,"Service ",$P(^GMR(123.5,SERVICE,0),"^",1)," is a sub service of:"
"RTN","GMRCSUBS",19,0)
 .. S PARENT=0
"RTN","GMRCSUBS",20,0)
 .. F  S PARENT=$O(^GMR(123.5,"APC",SERVICE,PARENT)) Q:'+PARENT  W !,"   ",$P(^GMR(123.5,PARENT,0),"^",1)
"RTN","GMRCSUBS",21,0)
 .. S NUMBER=NUMBER+1
"RTN","GMRCSUBS",22,0)
 ;Print totals.
"RTN","GMRCSUBS",23,0)
 I NUMBER=0 W !!,"No Services are sub-services for more than one service."
"RTN","GMRCSUBS",24,0)
 E  I NUMBER=1 W !!,"There is ",NUMBER," service that is a sub-service for more than one service."
"RTN","GMRCSUBS",25,0)
 E  W !!,"There are ",NUMBER," services that are sub-services for more than one service."
"RTN","GMRCSUBS",26,0)
 Q
"RTN","GMRCSUBS",27,0)
 ;
"RTN","GMRCSUBS",28,0)
CLEANAE ;Post-init for patch GMRC*3*7
"RTN","GMRCSUBS",29,0)
 ;This will delete the AE cross-reference and then rebuild it.
"RTN","GMRCSUBS",30,0)
 ;This is to make sure that the AE cross-reference does not contain
"RTN","GMRCSUBS",31,0)
 ; any bad entries.
"RTN","GMRCSUBS",32,0)
 N DIK
"RTN","GMRCSUBS",33,0)
 K ^GMR(123,"AE")
"RTN","GMRCSUBS",34,0)
 S DIK="^GMR(123,",DIK(1)="1^AE"
"RTN","GMRCSUBS",35,0)
 D ENALL^DIK
"RTN","GMRCSUBS",36,0)
 Q
"RTN","GMRCSUBS",37,0)
 ;
"RTN","GMRCSUBS",38,0)
POST ;Post install routine for patch 7
"RTN","GMRCSUBS",39,0)
 D BMES^XPDUTL("Running POST^GMRCSUBS")
"RTN","GMRCSUBS",40,0)
 D CLEANAE
"RTN","GMRCSUBS",41,0)
 Q
"RTN","GMRCSUBS",42,0)
 ;
"VER")
8.0^22.0
**END**
**END**
