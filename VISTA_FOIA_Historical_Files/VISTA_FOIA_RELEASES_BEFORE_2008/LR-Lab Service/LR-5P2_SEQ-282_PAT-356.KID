Released LR*5.2*356 SEQ #282
Extracted from mail message
**KIDS**:LR*5.2*356^

**INSTALL NAME**
LR*5.2*356
"BLD",6760,0)
LR*5.2*356^LAB SERVICE^0^3070302^y
"BLD",6760,1,0)
^^11^11^3070302^
"BLD",6760,1,1,0)
This patch will correct a problem with the display of Reference, Critical
"BLD",6760,1,2,0)
& Therapeutic ranges in the Laboratory Test Description in the Lab Test 
"BLD",6760,1,3,0)
Information option of the Tools menu in CPRS GUI by routine LR7OR4. It 
"BLD",6760,1,4,0)
will correct a problem with the display of reference ranges with a 
"BLD",6760,1,5,0)
patient's laboratory test data in both CPRS GUI and the Laboratory 
"BLD",6760,1,6,0)
Package by routines LR7OGMC, LR7OGU, and LRRP1.
"BLD",6760,1,7,0)
 
"BLD",6760,1,8,0)
In the SITE/SPECIMEN SUB-FILE (60.01) the description for fields REFERENCE
"BLD",6760,1,9,0)
 LOW (60.01,1), REFERENCE HIGH (60.01,2), CRITICAL LOW (60.01,3), CRITICAL
"BLD",6760,1,10,0)
HIGH (60.01), THERAPEUTIC LOW (60.01,9.2), and THERAPEUTIC HIGH (60.01, 
"BLD",6760,1,11,0)
9.3) has been changed.
"BLD",6760,4,0)
^9.64PA^60^1
"BLD",6760,4,60,0)
60
"BLD",6760,4,60,2,0)
^9.641^60.01^1
"BLD",6760,4,60,2,60.01,0)
SITE/SPECIMEN  (sub-file)
"BLD",6760,4,60,2,60.01,1,0)
^9.6411^9.3^6
"BLD",6760,4,60,2,60.01,1,1,0)
REFERENCE LOW
"BLD",6760,4,60,2,60.01,1,2,0)
REFERENCE HIGH
"BLD",6760,4,60,2,60.01,1,3,0)
CRITICAL LOW
"BLD",6760,4,60,2,60.01,1,4,0)
CRITICAL HIGH
"BLD",6760,4,60,2,60.01,1,9.2,0)
THERAPEUTIC LOW
"BLD",6760,4,60,2,60.01,1,9.3,0)
THERAPEUTIC HIGH
"BLD",6760,4,60,222)
y^n^p^^^^n^^n
"BLD",6760,4,60,224)

"BLD",6760,4,"APDD",60,60.01)

"BLD",6760,4,"APDD",60,60.01,1)

"BLD",6760,4,"APDD",60,60.01,2)

"BLD",6760,4,"APDD",60,60.01,3)

"BLD",6760,4,"APDD",60,60.01,4)

"BLD",6760,4,"APDD",60,60.01,9.2)

"BLD",6760,4,"APDD",60,60.01,9.3)

"BLD",6760,4,"B",60,60)

"BLD",6760,6)
16^
"BLD",6760,6.3)
8
"BLD",6760,"ABPKG")
n
"BLD",6760,"KRN",0)
^9.67PA^8989.52^19
"BLD",6760,"KRN",.4,0)
.4
"BLD",6760,"KRN",.401,0)
.401
"BLD",6760,"KRN",.402,0)
.402
"BLD",6760,"KRN",.403,0)
.403
"BLD",6760,"KRN",.5,0)
.5
"BLD",6760,"KRN",.84,0)
.84
"BLD",6760,"KRN",3.6,0)
3.6
"BLD",6760,"KRN",3.8,0)
3.8
"BLD",6760,"KRN",9.2,0)
9.2
"BLD",6760,"KRN",9.8,0)
9.8
"BLD",6760,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",6760,"KRN",9.8,"NM",1,0)
LR7OR4^^0^B40408681
"BLD",6760,"KRN",9.8,"NM",2,0)
LR7OGMC^^0^B10197738
"BLD",6760,"KRN",9.8,"NM",3,0)
LRRP1^^0^B22566819
"BLD",6760,"KRN",9.8,"NM",4,0)
LR7OSUM5^^0^B34508107
"BLD",6760,"KRN",9.8,"NM",5,0)
LR7OSUM6^^0^B13903521
"BLD",6760,"KRN",9.8,"NM","B","LR7OGMC",2)

"BLD",6760,"KRN",9.8,"NM","B","LR7OR4",1)

"BLD",6760,"KRN",9.8,"NM","B","LR7OSUM5",4)

"BLD",6760,"KRN",9.8,"NM","B","LR7OSUM6",5)

"BLD",6760,"KRN",9.8,"NM","B","LRRP1",3)

"BLD",6760,"KRN",19,0)
19
"BLD",6760,"KRN",19,"NM",0)
^9.68A^^
"BLD",6760,"KRN",19.1,0)
19.1
"BLD",6760,"KRN",101,0)
101
"BLD",6760,"KRN",409.61,0)
409.61
"BLD",6760,"KRN",771,0)
771
"BLD",6760,"KRN",870,0)
870
"BLD",6760,"KRN",8989.51,0)
8989.51
"BLD",6760,"KRN",8989.52,0)
8989.52
"BLD",6760,"KRN",8994,0)
8994
"BLD",6760,"KRN","B",.4,.4)

"BLD",6760,"KRN","B",.401,.401)

"BLD",6760,"KRN","B",.402,.402)

"BLD",6760,"KRN","B",.403,.403)

"BLD",6760,"KRN","B",.5,.5)

"BLD",6760,"KRN","B",.84,.84)

"BLD",6760,"KRN","B",3.6,3.6)

"BLD",6760,"KRN","B",3.8,3.8)

"BLD",6760,"KRN","B",9.2,9.2)

"BLD",6760,"KRN","B",9.8,9.8)

"BLD",6760,"KRN","B",19,19)

"BLD",6760,"KRN","B",19.1,19.1)

"BLD",6760,"KRN","B",101,101)

"BLD",6760,"KRN","B",409.61,409.61)

"BLD",6760,"KRN","B",771,771)

"BLD",6760,"KRN","B",870,870)

"BLD",6760,"KRN","B",8989.51,8989.51)

"BLD",6760,"KRN","B",8989.52,8989.52)

"BLD",6760,"KRN","B",8994,8994)

"BLD",6760,"QUES",0)
^9.62^^
"BLD",6760,"REQB",0)
^9.611^2^2
"BLD",6760,"REQB",1,0)
LR*5.2*256^2
"BLD",6760,"REQB",2,0)
LR*5.2*286^2
"BLD",6760,"REQB","B","LR*5.2*256",1)

"BLD",6760,"REQB","B","LR*5.2*286",2)

"FIA",60)
LABORATORY TEST
"FIA",60,0)
^LAB(60,
"FIA",60,0,0)
60I
"FIA",60,0,1)
y^n^p^^^^n^^n
"FIA",60,0,10)

"FIA",60,0,11)

"FIA",60,0,"RLRO")

"FIA",60,0,"VR")
5.2^LR
"FIA",60,60)
1
"FIA",60,60.01)
1
"FIA",60,60.01,1)

"FIA",60,60.01,2)

"FIA",60,60.01,3)

"FIA",60,60.01,4)

"FIA",60,60.01,9.2)

"FIA",60,60.01,9.3)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)
 
"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
356^3070302^33274
"PKG",26,22,1,"PAH",1,1,0)
^^11^11^3070302
"PKG",26,22,1,"PAH",1,1,1,0)
This patch will correct a problem with the display of Reference, Critical
"PKG",26,22,1,"PAH",1,1,2,0)
& Therapeutic ranges in the Laboratory Test Description in the Lab Test 
"PKG",26,22,1,"PAH",1,1,3,0)
Information option of the Tools menu in CPRS GUI by routine LR7OR4. It 
"PKG",26,22,1,"PAH",1,1,4,0)
will correct a problem with the display of reference ranges with a 
"PKG",26,22,1,"PAH",1,1,5,0)
patient's laboratory test data in both CPRS GUI and the Laboratory 
"PKG",26,22,1,"PAH",1,1,6,0)
Package by routines LR7OGMC, LR7OGU, and LRRP1.
"PKG",26,22,1,"PAH",1,1,7,0)
 
"PKG",26,22,1,"PAH",1,1,8,0)
In the SITE/SPECIMEN SUB-FILE (60.01) the description for fields REFERENCE
"PKG",26,22,1,"PAH",1,1,9,0)
 LOW (60.01,1), REFERENCE HIGH (60.01,2), CRITICAL LOW (60.01,3), CRITICAL
"PKG",26,22,1,"PAH",1,1,10,0)
HIGH (60.01), THERAPEUTIC LOW (60.01,9.2), and THERAPEUTIC HIGH (60.01, 
"PKG",26,22,1,"PAH",1,1,11,0)
9.3) has been changed.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","LR7OGMC")
0^2^B10197738^B9576583
"RTN","LR7OGMC",1,0)
LR7OGMC ;DALOI/STAFF- Interim report rpc memo chem ; Aug 16, 2004
"RTN","LR7OGMC",2,0)
 ;;5.2;LAB SERVICE;**187,230,312,286,356**;Sep 27, 1994;Build 8
"RTN","LR7OGMC",3,0)
 ;
"RTN","LR7OGMC",4,0)
 ; sets lab data into ^TMP("LR7OG",$J,"TP"
"RTN","LR7OGMC",5,0)
 ; ^TMP("LR7OG",$J,"G")=dfn^pnm^lrdfn^age^sex^lrcw
"RTN","LR7OGMC",6,0)
 ; ^TMP("LR7OG",$J,"TMP",test subscript in data)=zero node of test
"RTN","LR7OGMC",7,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time)=zero node from data
"RTN","LR7OGMC",8,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time,printorder)=test#^name^printname^^printcode^dataname^result^flag^units^range^performing site
"RTN","LR7OGMC",9,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time,printorder,#)=interpretation
"RTN","LR7OGMC",10,0)
 ; ^TMP("LR7OG",$J,"TP",collect date/time,"C",#)=comment
"RTN","LR7OGMC",11,0)
 ;
"RTN","LR7OGMC",12,0)
 ;
"RTN","LR7OGMC",13,0)
CH(LRDFN,IDT,ALL,OUTCNT,FORMAT,DONE) ; from LR7OGM
"RTN","LR7OGMC",14,0)
 N CDT,CHSUB,CMNT,INTP,LABSUB,PNODE,PORDER,SPEC,TCNT,TESTNUM,TESTSUB,ZERO
"RTN","LR7OGMC",15,0)
 S ZERO=$G(^LR(LRDFN,"CH",IDT,0))
"RTN","LR7OGMC",16,0)
 I '$P(ZERO,U,3) Q
"RTN","LR7OGMC",17,0)
 S CDT=+ZERO,LABSUB="CH",TCNT=0,SPEC=$P(ZERO,U,5)
"RTN","LR7OGMC",18,0)
 S CHSUB=1
"RTN","LR7OGMC",19,0)
 F  S CHSUB=$O(^LR(LRDFN,"CH",IDT,CHSUB)) Q:CHSUB=""  I ALL!$D(^TMP("LR7OG",$J,"TMP",CHSUB)) D  Q
"RTN","LR7OGMC",20,0)
 . I FORMAT D
"RTN","LR7OGMC",21,0)
 .. S ^TMP("LR7OGX",$J,"OUTPUT",OUTCNT)="0^CH^"_(9999999-IDT)
"RTN","LR7OGMC",22,0)
 .. S OUTCNT=OUTCNT+1
"RTN","LR7OGMC",23,0)
 .. S DONE=1
"RTN","LR7OGMC",24,0)
 . K ^TMP("LR7OG",$J,"TP")
"RTN","LR7OGMC",25,0)
 . I ALL S TESTSUB=1 F  S TESTSUB=$O(^LR(LRDFN,"CH",IDT,TESTSUB)) Q:TESTSUB<1  S TESTNUM=$O(^LAB(60,"C","CH;"_TESTSUB_";1",0)) D CHSETUP
"RTN","LR7OGMC",26,0)
 . I 'ALL S TESTSUB=1 F  S TESTSUB=$O(^TMP("LR7OG",$J,"TMP",TESTSUB)) Q:TESTSUB<1  S TESTNUM=+^(TESTSUB) D CHSETUP
"RTN","LR7OGMC",27,0)
 . I TCNT D
"RTN","LR7OGMC",28,0)
 .. S ^TMP("LR7OG",$J,"TP",CDT)=ZERO,CMNT=0
"RTN","LR7OGMC",29,0)
 .. F  S CMNT=+$O(^LR(LRDFN,LABSUB,IDT,1,CMNT)) Q:CMNT<1  S ^TMP("LR7OG",$J,"TP",CDT,"C",CMNT)=^(CMNT,0) S TCNT=TCNT+1
"RTN","LR7OGMC",30,0)
 . I FORMAT D GRID^LR7OGMG(.OUTCNT)
"RTN","LR7OGMC",31,0)
 . I 'FORMAT D PRINT^LR7OGMP(.OUTCNT)
"RTN","LR7OGMC",32,0)
 . K ^TMP("LR7OG",$J,"TP")
"RTN","LR7OGMC",33,0)
 Q
"RTN","LR7OGMC",34,0)
 ;
"RTN","LR7OGMC",35,0)
 ;
"RTN","LR7OGMC",36,0)
CHSETUP ; within scope of CH
"RTN","LR7OGMC",37,0)
 ;
"RTN","LR7OGMC",38,0)
 N LRX
"RTN","LR7OGMC",39,0)
 I 'TESTNUM Q
"RTN","LR7OGMC",40,0)
 Q:'$D(^LAB(60,TESTNUM,.1))  S PNODE=^(.1) I '("BO"[$P($G(^(0)),U,3)) Q
"RTN","LR7OGMC",41,0)
 Q:'$D(^LR(LRDFN,LABSUB,IDT,TESTSUB))  Q:'$L($P(^(TESTSUB),U))
"RTN","LR7OGMC",42,0)
 ;
"RTN","LR7OGMC",43,0)
 S PORDER=$P(PNODE,U,6),PORDER=$S(PORDER:PORDER,1:TESTSUB/1000000)
"RTN","LR7OGMC",44,0)
 F  Q:'$D(^TMP("LR7OG",$J,"TP",CDT,PORDER))  Q:TESTNUM=+^(PORDER)  S PORDER=PORDER+1
"RTN","LR7OGMC",45,0)
 ;
"RTN","LR7OGMC",46,0)
 I $D(^TMP("LR7OG",$J,"TP",CDT,PORDER)) Q
"RTN","LR7OGMC",47,0)
 ;
"RTN","LR7OGMC",48,0)
 S LRX=$$TSTRES^LRRPU(LRDFN,LABSUB,IDT,TESTSUB,TESTNUM)
"RTN","LR7OGMC",49,0)
 S ^TMP("LR7OG",$J,"TP",CDT,PORDER)=TESTNUM_U_$P(^LAB(60,TESTNUM,0),U)_U_$P(PNODE,U)_U_$P(PNODE,U,2)_U_$P(PNODE,U,3)_U_$P(^(0),U,5)_U_$P(LRX,U)_U_$P(LRX,U,2)_U_$P(LRX,U,5)_U_$$RS($P(LRX,U,3),$P(LRX,U,4))_U_$P(LRX,U,6)
"RTN","LR7OGMC",50,0)
 ;
"RTN","LR7OGMC",51,0)
 ; Save performing lab ien in list
"RTN","LR7OGMC",52,0)
 I $P(LRX,U,6) S ^TMP("LRPLS",$J,$P(LRX,U,6))=""
"RTN","LR7OGMC",53,0)
 ;
"RTN","LR7OGMC",54,0)
 S TCNT=TCNT+1
"RTN","LR7OGMC",55,0)
 I $D(^LAB(60,TESTNUM,1,SPEC,1,0)) D
"RTN","LR7OGMC",56,0)
 . S INTP=0
"RTN","LR7OGMC",57,0)
 . F  S INTP=+$O(^LAB(60,TESTNUM,1,SPEC,1,INTP)) Q:INTP<1  D
"RTN","LR7OGMC",58,0)
 . . S ^TMP("LR7OG",$J,"TP",CDT,PORDER,INTP)=^(INTP,0)
"RTN","LR7OGMC",59,0)
 . . S TCNT=TCNT+1
"RTN","LR7OGMC",60,0)
 Q
"RTN","LR7OGMC",61,0)
RS(RLV,RHV) ;Range Set - Added to support LR*5.2*356
"RTN","LR7OGMC",62,0)
 ;RLV - Reference Range Low Value contained in the third piece of variable LRX : $P(LRX,U,3)
"RTN","LR7OGMC",63,0)
 ;RHV - Referance Range High Value contained in the forth piece of variable LRX : $P(LRX,U,4)
"RTN","LR7OGMC",64,0)
 I RLV="",RHV="" Q RLV
"RTN","LR7OGMC",65,0)
 I RLV'="",RHV="" S RLV=$S(RLV?.AP:RLV,1:"low: "_RLV) Q RLV
"RTN","LR7OGMC",66,0)
 I RLV="",RHV'="" S RHV=$S(RHV?.AP:RHV,1:"high: "_RHV) Q RHV
"RTN","LR7OGMC",67,0)
 Q RLV_" to "_RHV
"RTN","LR7OR4")
0^1^B40408681^B15588318
"RTN","LR7OR4",1,0)
LR7OR4 ;slc/dcm - Get Lab TEST Info ;8/11/97
"RTN","LR7OR4",2,0)
 ;;5.2;LAB SERVICE;**256,356**;Sep 27, 1994;Build 8
"RTN","LR7OR4",3,0)
 ;Entry points:  EN
"RTN","LR7OR4",4,0)
GET(TEST) ;Get TEST ifn
"RTN","LR7OR4",5,0)
 I '$D(TEST) Q ""
"RTN","LR7OR4",6,0)
 I TEST'?1N.N S TEST=$O(^LAB(60,"B",TEST,0)) Q:'TEST ""
"RTN","LR7OR4",7,0)
 I TEST?1N.N Q:'$D(^LAB(60,TEST)) ""
"RTN","LR7OR4",8,0)
 Q TEST
"RTN","LR7OR4",9,0)
ONE(Y,TEST) ;Gets parameters for one test
"RTN","LR7OR4",10,0)
 N CNT
"RTN","LR7OR4",11,0)
 Q:'$L($G(TEST))
"RTN","LR7OR4",12,0)
 S CNT=0,TEST=+TEST
"RTN","LR7OR4",13,0)
 D EN
"RTN","LR7OR4",14,0)
 Q
"RTN","LR7OR4",15,0)
ALL(Y,TESTS) ;Gets Lab Test ordering parameters from file 60
"RTN","LR7OR4",16,0)
 ;TEST=Lab TEST (can be either name or internal #)
"RTN","LR7OR4",17,0)
 N I,CNT
"RTN","LR7OR4",18,0)
 Q:'$O(TESTS(0))
"RTN","LR7OR4",19,0)
 S (I,CNT)=0
"RTN","LR7OR4",20,0)
 F  S I=$O(TESTS(I)) Q:'I  S TEST=+TESTS(I) D EN S CNT=CNT+1,Y(CNT)="---------------------"
"RTN","LR7OR4",21,0)
 Q
"RTN","LR7OR4",22,0)
EN Q:'$D(TEST)
"RTN","LR7OR4",23,0)
 N X0
"RTN","LR7OR4",24,0)
 S TEST=$$GET(TEST) Q:'TEST
"RTN","LR7OR4",25,0)
 S X0=^LAB(60,TEST,0),CNT=CNT+1,Y(CNT)=$P(X0,"^",1)
"RTN","LR7OR4",26,0)
 I $L($P(X0,"^",11)) S Y(CNT)=Y(CNT)_"   $"_$J($P(X0,"^",11),4,2)
"RTN","LR7OR4",27,0)
 D URG
"RTN","LR7OR4",28,0)
 D GCOM
"RTN","LR7OR4",29,0)
 I $P(X0,"^",8),$O(^LAB(60,TEST,3,0)) S X=$G(^($O(^(0)),0)),CNT=CNT+1,Y(CNT)="Unique collection sample: "_$$SAMP(+X) ;$P($G(^LAB(62,+X,0)),"^")
"RTN","LR7OR4",30,0)
 I $P(X0,"^",9) S I=0 F  S I=$O(^LAB(60,TEST,3,I)) Q:I<1  S X=+^(I,0) I X=$P(X0,"^",9) S CNT=CNT+1,Y(CNT)="Lab collect sample: "_$$SAMP(X) Q  ;$P($G(^LAB(62,X,0)),"^") Q
"RTN","LR7OR4",31,0)
 ;I $O(^LAB(60,TEST,3,0)) S X=$G(^($O(^(0)),0)),CNT=CNT+1,Y(CNT)="Default collection sample: "_$P($G(^LAB(62,+X,0)),"^")
"RTN","LR7OR4",32,0)
 D COLL,SUB
"RTN","LR7OR4",33,0)
 Q
"RTN","LR7OR4",34,0)
COLL ;Get Collection Sample-Specimen data
"RTN","LR7OR4",35,0)
 N I,J,X,SAMP,SPEC,CHK
"RTN","LR7OR4",36,0)
 S I=0
"RTN","LR7OR4",37,0)
 F  S I=$O(^LAB(60,TEST,3,I)) Q:I<1  S X=^(I,0) D
"RTN","LR7OR4",38,0)
 . S CNT=CNT+1,Y(CNT)="Collection sample: "_$$SAMP(X,$P(X0,"^",19))
"RTN","LR7OR4",39,0)
 . I $L($P(X,"^",2)) S CNT=CNT+1,Y(CNT)="     Form name/number: "_$P(X,"^",2)
"RTN","LR7OR4",40,0)
 . I $L($P(X,"^",4)) S CNT=CNT+1,Y(CNT)="     Minimum volume (in mls): "_$P(X,"^",4)
"RTN","LR7OR4",41,0)
 . I $L($P(X,"^",5)) S CNT=CNT+1,Y(CNT)="     Maximum order frequency: "_$P(X,"^",5)
"RTN","LR7OR4",42,0)
 . I $L($P(X,"^",7)) S CNT=CNT+1,Y(CNT)="     Maximum daily order frequency: "_$P(X,"^",7)
"RTN","LR7OR4",43,0)
 . I $O(^LAB(60,TEST,3,I,1,0)) S CNT=CNT+1,Y(CNT)="     Collection sample instructions: " D
"RTN","LR7OR4",44,0)
 .. S J=0 F  S J=$O(^LAB(60,TEST,3,I,1,J)) Q:J<1  S CNT=CNT+1,Y(CNT)="          "_^(J,0)
"RTN","LR7OR4",45,0)
 ;. I $O(^LAB(60,TEST,3,I,2,0)) S CNT=CNT+1,Y(CNT)="     Collection sample LAB processing instructions: " D
"RTN","LR7OR4",46,0)
 ;.. S J=0 F  S J=$O(^LAB(60,TEST,3,I,2,J)) Q:J<1  S CNT=CNT+1,Y(CNT)="          "_^(J,0)
"RTN","LR7OR4",47,0)
 S I=0
"RTN","LR7OR4",48,0)
 F  S I=$O(^LAB(60,TEST,1,I)) Q:I<1  S X=^(I,0) D
"RTN","LR7OR4",49,0)
 . S CNT=CNT+1,Y(CNT)="Site/Specimen: "_$P($G(^LAB(61,+X,0)),"^")
"RTN","LR7OR4",50,0)
 . I $L($P(X,"^",2,3))>1 D CRRV("Reference range",$P(X,"^",2,3))
"RTN","LR7OR4",51,0)
 . I $L($P(X,"^",11,12))>1 D CRRV("Therapeutic range",$P(X,"^",11,12))
"RTN","LR7OR4",52,0)
 . I $L($P(X,"^",4,5))>1 D CRRV("Critical",$P(X,"^",4,5))
"RTN","LR7OR4",53,0)
 . I $L($P(X,"^",7)) S CNT=CNT+1,Y(CNT)="     Units: "_$P(X,"^",7)
"RTN","LR7OR4",54,0)
 . I $O(^LAB(60,TEST,1,I,1,0)) S CNT=CNT+1,Y(CNT)="     Interpretation: "
"RTN","LR7OR4",55,0)
 . S J=0 F  S J=$O(^LAB(60,TEST,1,I,1,J)) Q:'J  S X=^(J,0),CNT=CNT+1,Y(CNT)="          "_X
"RTN","LR7OR4",56,0)
 Q
"RTN","LR7OR4",57,0)
URG ;Get Urgency params for TEST
"RTN","LR7OR4",58,0)
 N I,X,URG
"RTN","LR7OR4",59,0)
 I $P(X0,"^",18) S CNT=CNT+1,Y(CNT)="Default urgency: "_$P($G(^LAB(62.05,+$P(X0,"^",18),0)),"^")
"RTN","LR7OR4",60,0)
 I $P(X0,"^",16) S CNT=CNT+1,Y(CNT)="Highest urgency allowed: "_$P($G(^LAB(62.05,+$P(X0,"^",16),0)),"^")
"RTN","LR7OR4",61,0)
 Q
"RTN","LR7OR4",62,0)
SAMP(X,REQ) ;Build Collection Sample data
"RTN","LR7OR4",63,0)
 ;X=zero node from ^LAB(60,TEST,3,ifn,0) or ptr to 62
"RTN","LR7OR4",64,0)
 ;REQ=Required comment from $P(^LAB(60,TEST,0),"^",19)
"RTN","LR7OR4",65,0)
 N X0,Y1
"RTN","LR7OR4",66,0)
 Q:'$D(^LAB(62,+X,0)) "" S X0=^(0)
"RTN","LR7OR4",67,0)
 ;S REQ=$S($P(X,"^",6):$P(X,"^",6),$G(REQ):REQ,1:""),REQ=$S(REQ:$P($G(^LAB(62.07,REQ,0)),"^"),1:"")
"RTN","LR7OR4",68,0)
 ;S Y1=+X_"^"_$P(X0,"^")_"^"_$P(X0,"^",2)_"^"_$P(X0,"^",3)_"^"_$P(X,"^",5)_"^"_$P(X,"^",7)_"^"_$P(X0,"^",7)_"^"_REQ
"RTN","LR7OR4",69,0)
 S Y1=$P(X0,"^")_"  "_$P(X0,"^",3)
"RTN","LR7OR4",70,0)
 Q Y1
"RTN","LR7OR4",71,0)
GCOM ;Get General Ward & Lab Instructions
"RTN","LR7OR4",72,0)
 ;TEST=ptr to TEST in file 60
"RTN","LR7OR4",73,0)
 N I
"RTN","LR7OR4",74,0)
 S I=0
"RTN","LR7OR4",75,0)
 I $O(^LAB(60,+$G(TEST),6,0)) S CNT=CNT+1,Y(CNT)="General instructions: "
"RTN","LR7OR4",76,0)
 F  S I=$O(^LAB(60,TEST,6,I)) Q:'I  S CNT=CNT+1,Y(CNT)="     "_^(I,0)
"RTN","LR7OR4",77,0)
 S I=0
"RTN","LR7OR4",78,0)
 ;I $O(^LAB(60,+$G(TEST),7,0)) S CNT=CNT+1,Y(CNT)="General LAB processing instructions: "
"RTN","LR7OR4",79,0)
 ;F  S I=$O(^LAB(60,TEST,7,I)) Q:'I  S CNT=CNT+1,Y(CNT)="     "_^(I,0)
"RTN","LR7OR4",80,0)
 Q
"RTN","LR7OR4",81,0)
SUB ;Tests in panel
"RTN","LR7OR4",82,0)
 N I
"RTN","LR7OR4",83,0)
 S I=0
"RTN","LR7OR4",84,0)
 I $O(^LAB(60,+$G(TEST),2,0)) S I=0,CNT=CNT+1,Y(CNT)="Tests included in panel: "
"RTN","LR7OR4",85,0)
 F  S I=$O(^LAB(60,TEST,2,I)) Q:'I  S X=^(I,0),CNT=CNT+1,Y(CNT)="     "_$P($G(^LAB(60,+X,0)),"^")
"RTN","LR7OR4",86,0)
 Q
"RTN","LR7OR4",87,0)
 ;Added to support LR*5.2*356, PSI-06-025
"RTN","LR7OR4",88,0)
CRRV(RT,RV) ;Convert Referance Range Values - convert embedded M code into a more readable format
"RTN","LR7OR4",89,0)
 ;Variables passed in:
"RTN","LR7OR4",90,0)
 ;RT - Refereance range Text
"RTN","LR7OR4",91,0)
 ;RV - Refereance range Value
"RTN","LR7OR4",92,0)
 ;       1st piece holds low value
"RTN","LR7OR4",93,0)
 ;       2nd piece holds high value
"RTN","LR7OR4",94,0)
 ;Routine variables
"RTN","LR7OR4",95,0)
 ;Y() - The return array with the lab test information
"RTN","LR7OR4",96,0)
 ;CNT - The counter variable used to create nodes in the Y array variable
"RTN","LR7OR4",97,0)
 ;Local variables
"RTN","LR7OR4",98,0)
 ;SP5 - 5 embedded spaces for output alinement
"RTN","LR7OR4",99,0)
 ;SP10 - 10 embedded spaces for output alinement
"RTN","LR7OR4",100,0)
 ;X - Work variable
"RTN","LR7OR4",101,0)
 N SP5,SP10,X
"RTN","LR7OR4",102,0)
 S SP5="     ",SP10=SP5_SP5,X=""
"RTN","LR7OR4",103,0)
 I RV'["$S(" D  Q
"RTN","LR7OR4",104,0)
 . I $L($P(RV,"^")),'$L($P(RV,"^",2)),$P(RV,"^")?.ANP S CNT=CNT+1,Y(CNT)=SP5_RT_$S($P(RV,"^")?.N:" low : "_$TR($P(RV,"^"),""""),1:"  : "_$TR($P(RV,"^"),"""")) Q
"RTN","LR7OR4",105,0)
 . I '$L($P(RV,"^")),$L($P(RV,"^",2)),$P(RV,"^",2)?.ANP S CNT=CNT+1,Y(CNT)=SP5_RT_$S($P(RV,"^",2)?.N:" high : "_$TR($P(RV,"^",2),""""),1:" : "_$TR($P(RV,"^",2),"""")) Q
"RTN","LR7OR4",106,0)
 . I $L($P(RV,"^")) S CNT=CNT+1,Y(CNT)=SP5_RT_" low  : "_$TR($P(RV,"^"),"""")
"RTN","LR7OR4",107,0)
 . I $L($P(RV,"^",2)) S CNT=CNT+1,Y(CNT)=SP5_RT_" high : "_$TR($P(RV,"^",2),"""")
"RTN","LR7OR4",108,0)
 . ;I $L($P(RV,"^")) S CNT=CNT+1,Y(CNT)=SP5_RT_$S($P(RV,"^")?.AP:" : "_$TR($P(RV,"^"),""""),1:" low  : "_$TR($P(RV,"^"),""""))
"RTN","LR7OR4",109,0)
 . ;I $L($P(RV,"^",2)) S CNT=CNT+1,Y(CNT)=SP5_RT_$S($P(RV,"^",2)?.AP:" : "_$TR($P(RV,"^",2),""""),1:" high : "_$TR($P(RV,"^",2),""""))
"RTN","LR7OR4",110,0)
 I RV["SEX" D  Q
"RTN","LR7OR4",111,0)
 . I RV["AGE" S CNT=CNT+1,Y(CNT)=SP5_RT_" - Age and sex dependent range values, please contact lab for specifics." Q
"RTN","LR7OR4",112,0)
 . S CNT=CNT+1,Y(CNT)=SP5_RT
"RTN","LR7OR4",113,0)
 . I $L($$GSV($P(RV,"^"),"M")) S CNT=CNT+1,Y(CNT)=SP10_"Male "_$S($$GSV($P(RV,"^"),"M")?.AP:": "_$TR($$GSV($P(RV,"^"),"M"),""""),1:"low  : "_$TR($$GSV($P(RV,"^"),"M"),""""))
"RTN","LR7OR4",114,0)
 . I $L($$GSV($P(RV,"^",2),"M")) S CNT=CNT+1,Y(CNT)=SP10_"Male "_$S($$GSV($P(RV,"^",2),"M")?.AP:$TR($$GSV($P(RV,"^",2),"M"),""""),1:"high : "_$TR($$GSV($P(RV,"^",2),"M"),""""))
"RTN","LR7OR4",115,0)
 . I $L($$GSV($P(RV,"^"),"F")) S CNT=CNT+1,Y(CNT)=SP10_"Female "_$S($$GSV($P(RV,"^"),"F")?.AP:": "_$TR($$GSV($P(RV,"^"),"F"),""""),1:"low  : "_$TR($$GSV($P(RV,"^"),"F"),""""))
"RTN","LR7OR4",116,0)
 . I $L($$GSV($P(RV,"^",2),"F")) S CNT=CNT+1,Y(CNT)=SP10_"Female "_$S($$GSV($P(RV,"^",2),"F")?.AP:$TR($$GSV($P(RV,"^",2),"F"),""""),1:"high : "_$TR($$GSV($P(RV,"^",2),"F"),""""))
"RTN","LR7OR4",117,0)
 I RV["AGE" D  Q
"RTN","LR7OR4",118,0)
 . S CNT=CNT+1,Y(CNT)=SP5_RT
"RTN","LR7OR4",119,0)
 . I $L($P(RV,"^")) D FAVO($P(RV,"^"),"low")
"RTN","LR7OR4",120,0)
 . I $L($P(RV,"^",2)) D FAVO($P(RV,"^",2),"high")
"RTN","LR7OR4",121,0)
GSV(X,SEX) ;Get Sex Value
"RTN","LR7OR4",122,0)
 ;Variables passed in:
"RTN","LR7OR4",123,0)
 ;X - Work variable low/high range value
"RTN","LR7OR4",124,0)
 ;SEX - Patient's sex
"RTN","LR7OR4",125,0)
 ;Subroutine variables:
"RTN","LR7OR4",126,0)
 ;X1 - Return value variable with the resolved low/high value
"RTN","LR7OR4",127,0)
 N X1
"RTN","LR7OR4",128,0)
 S @("X1="_$S($L(X):X,1:""""""))
"RTN","LR7OR4",129,0)
 Q X1
"RTN","LR7OR4",130,0)
FAVO(X,HL) ;Format Age Value Output
"RTN","LR7OR4",131,0)
 ;Variables passed in:
"RTN","LR7OR4",132,0)
 ;X - Work variable with low/high range value
"RTN","LR7OR4",133,0)
 ;HL - This will be for either a low or high reference range
"RTN","LR7OR4",134,0)
 ;Subroutine variables:
"RTN","LR7OR4",135,0)
 ;AT0 - Common text for output
"RTN","LR7OR4",136,0)
 ;AT1 - Embedded M code tested for 
"RTN","LR7OR4",137,0)
 ;AT2 - Text description for embedded M code for output
"RTN","LR7OR4",138,0)
 ;IO  - Counter to piece the low/high range value
"RTN","LR7OR4",139,0)
 ;I1  - Counter to reformat the embedded M code
"RTN","LR7OR4",140,0)
 ;SP10 - 10 embedded spaces for output alinement
"RTN","LR7OR4",141,0)
 ;X0,X1,X2  - Work variables used in converting the low/high range value
"RTN","LR7OR4",142,0)
 N AT0,AT1,AT2,I0,I1,SP10,X0,X1,X2
"RTN","LR7OR4",143,0)
 S AT0="If Age is "
"RTN","LR7OR4",144,0)
 S AT1="",AT1(1)="AGE<",AT1(2)="AGE>",AT1(3)="AGE'<",AT1(4)="AGE'>",AT1(5)="AGE="
"RTN","LR7OR4",145,0)
 S AT2="",AT2(1)="less than ",AT2(2)="greater than "
"RTN","LR7OR4",146,0)
 S AT2(3)="not less than ",AT2(4)="not greater than ",AT2(5)="equal to "
"RTN","LR7OR4",147,0)
 S SP10="          "
"RTN","LR7OR4",148,0)
 S X0=$E(X,4,$L(X)-1),(X1,X2)=""
"RTN","LR7OR4",149,0)
 F I0=1:1 S X1=$P(X0,",",I0) Q:X1=""  D
"RTN","LR7OR4",150,0)
 . I $P(X1,":")=1 S X2=SP10_"Default "_HL_": "_$P(X1,":",2),CNT=CNT+1,Y(CNT)=$TR(X2,"""")
"RTN","LR7OR4",151,0)
 . E  D
"RTN","LR7OR4",152,0)
 . . F I1=1:1:5 I $P(X1,":")[AT1(I1) S X2=SP10_AT0_AT2(I1)_$E($P(X1,":"),$L(AT1(I1))+1,$L($P(X1,":")))_" the "_HL_" is "_$P(X1,":",2),CNT=CNT+1,Y(CNT)=$TR(X2,"""")
"RTN","LR7OR4",153,0)
 Q
"RTN","LR7OSUM5")
0^4^B34508107^B25373064
"RTN","LR7OSUM5",1,0)
LR7OSUM5 ;slc/dcm - Silent Patient cum cont. ;8/11/97
"RTN","LR7OSUM5",2,0)
 ;;5.2;LAB SERVICE;**121,187,228,241,250,251,256,356**;Sep 27, 1994;Build 8
"RTN","LR7OSUM5",3,0)
TS ;from  LR7OSUM3
"RTN","LR7OSUM5",4,0)
 N A,B,I,J,LRII,LRCTR,LRFALT,LRCL,LRCW,LRTLOC,X,XZ,Z
"RTN","LR7OSUM5",5,0)
 I LRACT'=0 S X="",$P(X,"=",GIOM)="" D LN S ^TMP("LRC",$J,GCNT,0)=X
"RTN","LR7OSUM5",6,0)
 S I=0,LRII=0
"RTN","LR7OSUM5",7,0)
 F  S LRII=$O(^LAB(64.5,1,1,LRMH,1,LRSH,1,LRII)) Q:LRII<1  S I=I+1,I(I)=LRII
"RTN","LR7OSUM5",8,0)
 S LRFALT=0,LRCTR=0,LRACT=LRACT+1,J=LRJS+1,LRCL=20
"RTN","LR7OSUM5",9,0)
 I J'>LRSHD D LINE^LR7OSUM4,LN S ^TMP("LRC",$J,GCNT,0)="",^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(CCNT,CCNT,LRTOPP)_$$S^LR7OS(LRCL,CCNT,"")
"RTN","LR7OSUM5",10,0)
 F I=J:1:LRSHD S Z=^LAB(64.5,1,1,LRMH,1,LRSH,1,I(I),0),LRCW=$P(Z,U,2) Q:(GIOM-LRCL)<LRCW  D
"RTN","LR7OSUM5",11,0)
 . S LRCL=LRCL+LRCW,A=$L($P(Z,U,3))\2,B=LRCW\2,^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,$J($E($P(Z,U,3),1,(LRCW-1)),(A+B)))_$$S^LR7OS(LRCL,CCNT,"")
"RTN","LR7OSUM5",12,0)
 . S:'$P($G(^TMP("LRT",$J,$P(Z,"^",3))),"^",2) $P(^TMP("LRT",$J,$P(Z,"^",3)),"^",2)=GCNT
"RTN","LR7OSUM5",13,0)
 S LRJS=(I-1)
"RTN","LR7OSUM5",14,0)
 S:LRACT=LRPL LRJS=LRJS+1
"RTN","LR7OSUM5",15,0)
 F I=J:1:LRJS Q:'$D(^LAB(64.5,"A",1,LRMH,LRSH,I(I)))  S Z=^(I(I)) S:$L($P(Z,U,2))!$L($P(Z,U,11)) LRFALT=1
"RTN","LR7OSUM5",16,0)
 I LRFALT D
"RTN","LR7OSUM5",17,0)
 . D LN S ^TMP("LRC",$J,GCNT,0)="" D
"RTN","LR7OSUM5",18,0)
 . . S LRCL=20
"RTN","LR7OSUM5",19,0)
 . . S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(CCNT,CCNT,$S($L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(J)),U,11)):"Therapeutic low",1:"Ref range low"))_$$S^LR7OS(LRCL,CCNT,"")
"RTN","LR7OSUM5",20,0)
 . . D TS1
"RTN","LR7OSUM5",21,0)
 . D LN S ^TMP("LRC",$J,GCNT,0)="" D
"RTN","LR7OSUM5",22,0)
 . . S LRCL=20
"RTN","LR7OSUM5",23,0)
 . . S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(CCNT,CCNT,$S($L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(J)),U,11)):"Therapeutic high",1:"Ref range high"))_$$S^LR7OS(LRCL,CCNT,"")
"RTN","LR7OSUM5",24,0)
 . . D TS2
"RTN","LR7OSUM5",25,0)
 F I=J:1:LRJS Q:'$D(^LAB(64.5,"A",1,LRMH,LRSH,I(I)))  S:$L($P(^(I(I)),U,7)) LRFALT=1
"RTN","LR7OSUM5",26,0)
 I LRFALT S LRCL=20 D LN S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(LRCL,CCNT,"") F I=J:1:LRJS D TS3
"RTN","LR7OSUM5",27,0)
 S LRFALT=0,XZ="",$P(XZ,"-",GIOM)=""
"RTN","LR7OSUM5",28,0)
 D LN
"RTN","LR7OSUM5",29,0)
 S ^TMP("LRC",$J,GCNT,0)=XZ
"RTN","LR7OSUM5",30,0)
LRFDT ;
"RTN","LR7OSUM5",31,0)
 S:LRNP LRFFDT=LRFDT,LRNP=0
"RTN","LR7OSUM5",32,0)
 S LRFDT=$O(^TMP($J,LRDFN,LRMH,LRSH,LRFDT)) G:LRFDT<1 LOOP^LR7OSUM3 S LRTLOC=$P(^(LRFDT,0),U,1)
"RTN","LR7OSUM5",33,0)
 S:LRFDT>LRLFDT LRLFDT=LRFDT
"RTN","LR7OSUM5",34,0)
GOUT ;
"RTN","LR7OSUM5",35,0)
 D QRS
"RTN","LR7OSUM5",36,0)
 I LRCTR>LRLNS&(LRACT'<LRPL) S LRFULL=1 D TXT1 G:$O(^TMP($J,LRDFN,LRMH,LRSH,LRLFDT))<1 LRSH^LR7OSUM3 D HEAD^LR7OSUM6,LRLNS^LR7OSUM3 S LRFULL=0,LRFDT=LRLFDT G TS
"RTN","LR7OSUM5",37,0)
 I LRCTR>LRLNS&(LRACT<LRPL) S LRFDT=LRFFDT G TS
"RTN","LR7OSUM5",38,0)
 G LRFDT
"RTN","LR7OSUM5",39,0)
QRS ;
"RTN","LR7OSUM5",40,0)
 S LRCTR=LRCTR+1
"RTN","LR7OSUM5",41,0)
 F I=J:1:LRJS I $D(^TMP($J,LRDFN,LRMH,LRSH,LRFDT,I(I))) S:$L(^(I(I))) LRFALT=1
"RTN","LR7OSUM5",42,0)
 Q:'LRFALT
"RTN","LR7OSUM5",43,0)
 S LRFALT=0,LRTM=1
"RTN","LR7OSUM5",44,0)
 D UDT^LR7OSUM3
"RTN","LR7OSUM5",45,0)
 S LRCL=20,LRTM=0
"RTN","LR7OSUM5",46,0)
 D LN
"RTN","LR7OSUM5",47,0)
 S ^TMP("LRC",$J,GCNT,0)=""
"RTN","LR7OSUM5",48,0)
 S:'LRNXSW ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(2,CCNT,""),^(0)=^(0)_$$S^LR7OS(3,CCNT,"")
"RTN","LR7OSUM5",49,0)
 S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,LRUDT)
"RTN","LR7OSUM5",50,0)
 F I=J:1:LRJS S LRG=^LAB(64.5,1,1,LRMH,1,LRSH,1,I(I),0) S X=^(0) D QRS1
"RTN","LR7OSUM5",51,0)
 Q
"RTN","LR7OSUM5",52,0)
QRS1 ;
"RTN","LR7OSUM5",53,0)
 S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(LRCL,CCNT,""),LRCW=$P(LRG,U,2),LRDP=$P(X,U,6)
"RTN","LR7OSUM5",54,0)
 Q:(GIOM-LRCL)<LRCW
"RTN","LR7OSUM5",55,0)
 S LRCL=LRCL+LRCW
"RTN","LR7OSUM5",56,0)
 I $D(^TMP($J,LRDFN,LRMH,LRSH,LRFDT,I(I))) S X=^(I(I)) D C(.X,.X1) S:$L($P(LRG,U,4))&($L(X)) @("X="_$P(LRG,U,4)),^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,X_X1) D
"RTN","LR7OSUM5",57,0)
 . I '$L($P(LRG,U,4)) S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,X_X1)
"RTN","LR7OSUM5",58,0)
 Q
"RTN","LR7OSUM5",59,0)
TXT ;from LR7OSUM4
"RTN","LR7OSUM5",60,0)
 S LRVAR=0,LRIV=0
"RTN","LR7OSUM5",61,0)
 F  S LRIV=$O(^TMP($J,LRDFN,LRMH,LRSH,LRFDT,"TX",LRIV)) Q:LRIV<1  S X=^(LRIV,0),LRVAR=LRVAR+1 D
"RTN","LR7OSUM5",62,0)
 . I LRVAR>1 D LN S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(3,CCNT,"")
"RTN","LR7OSUM5",63,0)
 . S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,X)
"RTN","LR7OSUM5",64,0)
 Q
"RTN","LR7OSUM5",65,0)
LRLO ;from LR7OSUM4
"RTN","LR7OSUM5",66,0)
 S @("LRLO="_$S($L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,2)):$P(^(I(I)),U,2),$L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,11)):$P(^(I(I)),U,11),1:""""""))
"RTN","LR7OSUM5",67,0)
LRHI S @("LRHI="_$S($L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,3)):$P(^(I(I)),U,3),$L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,12)):$P(^(I(I)),U,12),1:"""""")),P7=$P(^(I(I)),U,7)
"RTN","LR7OSUM5",68,0)
 I LRLO'="",LRHI'="" S LRLOHI=LRLO_" to "_LRHI Q
"RTN","LR7OSUM5",69,0)
 I LRLO'="",LRHI="" S LRLOHI=$S(LRLO?.AP:LRLO,1:"low: "_LRLO) Q
"RTN","LR7OSUM5",70,0)
 I LRLO="",LRHI'="" S LRLOHI=$S(LRHI?.AP:LRHI,1:"high: "_LRHI) Q
"RTN","LR7OSUM5",71,0)
 S LRLOHI=""
"RTN","LR7OSUM5",72,0)
 Q
"RTN","LR7OSUM5",73,0)
TXT1 ;from LR7OSUM3, LR7OSUM4
"RTN","LR7OSUM5",74,0)
 S XZ="",$P(XZ,"=",GIOM)=""
"RTN","LR7OSUM5",75,0)
 Q:'$D(LRTM(0))
"RTN","LR7OSUM5",76,0)
 N C6,I,L
"RTN","LR7OSUM5",77,0)
 S C6=0
"RTN","LR7OSUM5",78,0)
 F  S C6=$O(^TMP($J,"TM",C6)) Q:C6<1  S X=^(C6) D
"RTN","LR7OSUM5",79,0)
 . D LN
"RTN","LR7OSUM5",80,0)
 . S I=$S($L($P(X,"^"))>1:2,1:3),^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(I,CCNT,$P(X,U)_". "),L(0)=0,L=0 D
"RTN","LR7OSUM5",81,0)
 . F  S L=$O(^TMP($J,"TM",C6,L)) Q:L<1  S X=^(L),L(0)=L(0)+1 D
"RTN","LR7OSUM5",82,0)
 .. I L(0)>1 D LN S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(6,CCNT,"")
"RTN","LR7OSUM5",83,0)
 .. S ^(0)=^TMP("LRC",$J,GCNT,0)_X
"RTN","LR7OSUM5",84,0)
 Q
"RTN","LR7OSUM5",85,0)
C(X,X1)    ;
"RTN","LR7OSUM5",86,0)
 N X2
"RTN","LR7OSUM5",87,0)
 S X1=" "_$P(X,U,2),X=$P(X,U,1)
"RTN","LR7OSUM5",88,0)
 I $L($P(LRG,U,4)) S LRCW=LRCW-3 Q
"RTN","LR7OSUM5",89,0)
 I "<>"[$E(X,1),$E(X,2,$L(X))?.N.P1N S X2=$E(X,1),X=$E(X,2,$L(X))
"RTN","LR7OSUM5",90,0)
 S LRCW(1)=LRCW-3
"RTN","LR7OSUM5",91,0)
 I X?.N.P1N!(LRDP="")!(X?.N1".".N) S X=$S(LRDP="":$J(X,LRCW(1)),1:$J(X,LRCW(1),LRDP)) D C2(.X,.X2)
"RTN","LR7OSUM5",92,0)
 Q
"RTN","LR7OSUM5",93,0)
C1(X,X1) ;from LR7OSUM4
"RTN","LR7OSUM5",94,0)
 S LRCW=$S('$L(X1):7,1:10),X1=$S($L(X1)=1:" "_X1_" ",$L(X1)=0:X1,1:" "_X1)
"RTN","LR7OSUM5",95,0)
 I $L($P(LRG,U,4)) S LRCW=7 Q
"RTN","LR7OSUM5",96,0)
 S X=$S($L(X1):X_X1,1:X)
"RTN","LR7OSUM5",97,0)
 Q
"RTN","LR7OSUM5",98,0)
C2(X,X2) ;
"RTN","LR7OSUM5",99,0)
 Q:'$D(X2)
"RTN","LR7OSUM5",100,0)
 Q:'$D(X)
"RTN","LR7OSUM5",101,0)
 N X3
"RTN","LR7OSUM5",102,0)
 F X3=1:1:$L(X) I $E(X,X3)'=" " S X=$E(X,1,X3-2)_X2_$E(X,X3,$L(X)) Q
"RTN","LR7OSUM5",103,0)
 Q
"RTN","LR7OSUM5",104,0)
TS1 ;Print low therapeutic or reference range values
"RTN","LR7OSUM5",105,0)
 F I=J:1:LRJS S LRCW=$P(^LAB(64.5,1,1,LRMH,1,LRSH,1,I(I),0),U,2),LRCL=LRCL+LRCW D
"RTN","LR7OSUM5",106,0)
 . S @("LRLO="_$S($L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,2)):$P(^(I(I)),U,2),$L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,11)):$P(^(I(I)),U,11),1:""""""))
"RTN","LR7OSUM5",107,0)
 . S A=$L(LRLO)\2,B=LRCW\2
"RTN","LR7OSUM5",108,0)
 . S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,$J(LRLO,(A+B))),^(0)=^(0)_$$S^LR7OS(LRCL,CCNT,"")
"RTN","LR7OSUM5",109,0)
 Q
"RTN","LR7OSUM5",110,0)
TS2 ;Print high therapeutic or reference range values
"RTN","LR7OSUM5",111,0)
 F I=J:1:LRJS S LRCW=$P(^LAB(64.5,1,1,LRMH,1,LRSH,1,I(I),0),U,2),LRCL=LRCL+LRCW D
"RTN","LR7OSUM5",112,0)
 . S @("LRHI="_$S($L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,3)):$P(^(I(I)),U,3),$L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,12)):$P(^(I(I)),U,12),1:"""""")),P7=$P(^(I(I)),U,7)
"RTN","LR7OSUM5",113,0)
 . S A=$L(LRHI)\2,B=LRCW\2
"RTN","LR7OSUM5",114,0)
 . S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,$J(LRHI,(A+B))),^(0)=^(0)_$$S^LR7OS(LRCL,CCNT,"")
"RTN","LR7OSUM5",115,0)
 Q
"RTN","LR7OSUM5",116,0)
TS3 ;Print units
"RTN","LR7OSUM5",117,0)
 S LRCW=$P(^LAB(64.5,1,1,LRMH,1,LRSH,1,I(I),0),U,2)
"RTN","LR7OSUM5",118,0)
 Q:(GIOM-LRCL)<LRCW
"RTN","LR7OSUM5",119,0)
 S LRCL=LRCL+LRCW,A=$L($P(^LAB(64.5,"A",1,LRMH,LRSH,I(I)),U,7))\2,B=LRCW\2,X=^(I(I))
"RTN","LR7OSUM5",120,0)
 S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(CCNT,CCNT,$J($P(X,U,7),(A+B)))
"RTN","LR7OSUM5",121,0)
 S ^TMP("LRC",$J,GCNT,0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(LRCL,CCNT,""),LRFALT=0
"RTN","LR7OSUM5",122,0)
 Q
"RTN","LR7OSUM5",123,0)
LN ;
"RTN","LR7OSUM5",124,0)
 S GCNT=GCNT+1,CCNT=1
"RTN","LR7OSUM5",125,0)
 Q
"RTN","LR7OSUM6")
0^5^B13903521^B12942824
"RTN","LR7OSUM6",1,0)
LR7OSUM6 ;DALOI/dcm - Silent Patient cum cont. ;Mar 11, 2003
"RTN","LR7OSUM6",2,0)
 ;;5.2;LAB SERVICE;**121,201,187,286,356**;Sep 27, 1994;Build 8
"RTN","LR7OSUM6",3,0)
 ;
"RTN","LR7OSUM6",4,0)
LRUDT(X) ;Get output date/time
"RTN","LR7OSUM6",5,0)
 N LRTIM,I
"RTN","LR7OSUM6",6,0)
 S LRTIM=$E(X,9,12) F I=0:0 Q:$L(LRTIM)=4  S LRTIM=LRTIM_0
"RTN","LR7OSUM6",7,0)
 S LRTIM=$S(LRTIM?4"0":"     ",1:$E(LRTIM,1,2)_":"_$E(LRTIM,3,4)),LRUDT=$$FMTE^XLFDT($P(X,"."),"5Z")_" "_$J(LRTIM,5)_" "
"RTN","LR7OSUM6",8,0)
 Q LRUDT
"RTN","LR7OSUM6",9,0)
 ;
"RTN","LR7OSUM6",10,0)
 ;
"RTN","LR7OSUM6",11,0)
HEAD ;from LR7OSUM3, LR7OSUM4, LR7OSUM5
"RTN","LR7OSUM6",12,0)
 D LRBOT,TOP
"RTN","LR7OSUM6",13,0)
 Q
"RTN","LR7OSUM6",14,0)
 ;
"RTN","LR7OSUM6",15,0)
 ;
"RTN","LR7OSUM6",16,0)
LRBOT ;from LR7OSUM3
"RTN","LR7OSUM6",17,0)
 N L1 D LINE^LR7OSUM4
"RTN","LR7OSUM6",18,0)
Y D LINE^LR7OSUM4
"RTN","LR7OSUM6",19,0)
 Q
"RTN","LR7OSUM6",20,0)
 ;
"RTN","LR7OSUM6",21,0)
 ;
"RTN","LR7OSUM6",22,0)
TOP ;from LR7OSUM3
"RTN","LR7OSUM6",23,0)
 S LRAG=0
"RTN","LR7OSUM6",24,0)
 Q
"RTN","LR7OSUM6",25,0)
 ;
"RTN","LR7OSUM6",26,0)
 ;
"RTN","LR7OSUM6",27,0)
KILL D HEAD Q
"RTN","LR7OSUM6",28,0)
 Q
"RTN","LR7OSUM6",29,0)
 ;
"RTN","LR7OSUM6",30,0)
 ;
"RTN","LR7OSUM6",31,0)
LRMISC S LRFDT=0,LRPG=1 D TOP
"RTN","LR7OSUM6",32,0)
 ;
"RTN","LR7OSUM6",33,0)
MHI S LRMHN=$P(^TMP($J,LRDFN,LRMH),U,1),LRCNT=12 D WR
"RTN","LR7OSUM6",34,0)
 ;
"RTN","LR7OSUM6",35,0)
MDT S LRFDT=$O(^TMP($J,LRDFN,"MISC",LRFDT)) G:LRFDT<1 END
"RTN","LR7OSUM6",36,0)
 S LRUDT=$$LRUDT(9999999-LRFDT) D LRCNT S LRMIT=0
"RTN","LR7OSUM6",37,0)
 ;
"RTN","LR7OSUM6",38,0)
LRMIT S LRMIT=$O(^TMP($J,LRDFN,"MISC",LRFDT,LRMIT)) G:LRMIT="TX" TXT G:LRMIT="" MDT S X=^(LRMIT) G:LRMIT=.1 MSG
"RTN","LR7OSUM6",39,0)
 ;
"RTN","LR7OSUM6",40,0)
 S LRVAL=$P(X,U,1),LRSPE=$P(X,U,2),LRTEST=$P(X,U,3),X1=$P(X,U,4)
"RTN","LR7OSUM6",41,0)
 ;S LRLO="",LRHI=","LRUNT=""
"RTN","LR7OSUM6",42,0)
 S LRLO=$P(X,"^",6),LRHI=$P(X,"^",7),LRUNT=$P(X,"^",8)
"RTN","LR7OSUM6",43,0)
 S LRSPEM=$S($L(LRSPE):$P(^LAB(61,LRSPE,0),U,1),1:"")
"RTN","LR7OSUM6",44,0)
 G:'LRTEST COMM
"RTN","LR7OSUM6",45,0)
 S LRNAME=$P(^LAB(60,LRTEST,.1),U,1)
"RTN","LR7OSUM6",46,0)
 ;S:$L(LRSPE)&($D(^LAB(60,LRTEST,1,LRSPE,0))) X=^(0),@("LRLO="_$S($L($P(X,U,2)):$P(X,U,2),1:"""""")),@("LRHI="_$S($L($P(X,U,3)):$P(X,U,3),1:"""""")),LRUNT=$P(X,U,7)
"RTN","LR7OSUM6",47,0)
 ;
"RTN","LR7OSUM6",48,0)
WR1 D LINE^LR7OSUM4
"RTN","LR7OSUM6",49,0)
 S LRREF=""
"RTN","LR7OSUM6",50,0)
 I LRLO'="",LRHI'="" S LRREF=LRLO_" to "_LRHI
"RTN","LR7OSUM6",51,0)
 I LRLO'="",LRHI="" S LRREF=$S(LRLO?.AP:LRLO,1:"low: "_LRLO)
"RTN","LR7OSUM6",52,0)
 I LRLO="",LRHI'="" S LRREF=$S(LRHI?.AP:LRHI,1:"high: "_LRHI)
"RTN","LR7OSUM6",53,0)
 S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(1,CCNT,LRUDT)_$$S^LR7OS(19,CCNT,$E(LRSPEM,1,16))_$$S^LR7OS(37,CCNT,LRNAME_":")_$$S^LR7OS(50,CCNT,LRVAL_" "_X1_"  "_LRUNT)_$$S^LR7OS(67,CCNT,LRREF)
"RTN","LR7OSUM6",54,0)
 S:'$P($G(^TMP("LRT",$J,LRNAME)),"^",2) $P(^(LRNAME),"^",2)=GCNT
"RTN","LR7OSUM6",55,0)
 K LRREF
"RTN","LR7OSUM6",56,0)
 G LRMIT
"RTN","LR7OSUM6",57,0)
 ;
"RTN","LR7OSUM6",58,0)
 ;
"RTN","LR7OSUM6",59,0)
MSG D LINE^LR7OSUM4,LINE^LR7OSUM4
"RTN","LR7OSUM6",60,0)
 X X ;Need to see what is in X
"RTN","LR7OSUM6",61,0)
 G LRMIT
"RTN","LR7OSUM6",62,0)
 ;
"RTN","LR7OSUM6",63,0)
 ;
"RTN","LR7OSUM6",64,0)
COMM D LN
"RTN","LR7OSUM6",65,0)
 S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(1,CCNT,"COMMENT: "_LRVAL)
"RTN","LR7OSUM6",66,0)
 G LRMIT
"RTN","LR7OSUM6",67,0)
 ;
"RTN","LR7OSUM6",68,0)
 ;
"RTN","LR7OSUM6",69,0)
WR ;
"RTN","LR7OSUM6",70,0)
 D LINE^LR7OSUM4
"RTN","LR7OSUM6",71,0)
 S X=GIOM/2-($L(LRMHN)/2+5)
"RTN","LR7OSUM6",72,0)
 S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(X,CCNT,"---- "_LRMHN_" ----"),^TMP("LRH",$J,LRMHN)=GCNT
"RTN","LR7OSUM6",73,0)
 D LINE^LR7OSUM4
"RTN","LR7OSUM6",74,0)
 D LN S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(4,CCNT,"DATE    TIME   SPECIMEN")_$$S^LR7OS(37,CCNT,"TEST")_$$S^LR7OS(50,CCNT,"VALUE")_$$S^LR7OS(64,CCNT,"Ref ranges")
"RTN","LR7OSUM6",75,0)
 D LN S X="",$P(X,"-",GIOM)="",^TMP("LRC",$J,GCNT,0)=X
"RTN","LR7OSUM6",76,0)
 Q
"RTN","LR7OSUM6",77,0)
 ;
"RTN","LR7OSUM6",78,0)
 ;
"RTN","LR7OSUM6",79,0)
TXT S I=0
"RTN","LR7OSUM6",80,0)
 F  S I=$O(^TMP($J,LRDFN,"MISC",LRFDT,"TX",I)) Q:I<1  S GCNT=GCNT+1,^TMP("LRC",$J,GCNT,0)=^(I,0)
"RTN","LR7OSUM6",81,0)
 G LRMIT
"RTN","LR7OSUM6",82,0)
 ;
"RTN","LR7OSUM6",83,0)
 ;
"RTN","LR7OSUM6",84,0)
END S X="",$P(X,"=",GIOM)="",GCNT=GCNT+1,^TMP("LRC",$J,GCNT,0)=X
"RTN","LR7OSUM6",85,0)
 D LRBOT S LRLO=""
"RTN","LR7OSUM6",86,0)
 K LRSB,LRMISC
"RTN","LR7OSUM6",87,0)
 Q
"RTN","LR7OSUM6",88,0)
 ;
"RTN","LR7OSUM6",89,0)
 ;
"RTN","LR7OSUM6",90,0)
PRE ;from LR7OSUM3
"RTN","LR7OSUM6",91,0)
 Q:$D(^TMP($J,LRDFN,"MISC"))'=11
"RTN","LR7OSUM6",92,0)
 S LRMISC=1,LRPG=0,LRMH="MISC"
"RTN","LR7OSUM6",93,0)
 G LRMISC
"RTN","LR7OSUM6",94,0)
 ;
"RTN","LR7OSUM6",95,0)
 ;
"RTN","LR7OSUM6",96,0)
LRCNT ;
"RTN","LR7OSUM6",97,0)
 S LRCNT=0,I=0
"RTN","LR7OSUM6",98,0)
 F  S I=$O(^TMP($J,LRDFN,LRMH,LRFDT,I)) Q:I<1  S LRCNT=LRCNT+1
"RTN","LR7OSUM6",99,0)
 S LRCTN=0
"RTN","LR7OSUM6",100,0)
 I $D(^TMP($J,LRDFN,LRMH,LRFDT,"TX")) D
"RTN","LR7OSUM6",101,0)
 . S J=0
"RTN","LR7OSUM6",102,0)
 . F  S J=$O(^TMP($J,LRDFN,LRMH,LRFDT,"TX",J)) Q:J<1  S LRCTN=LRCTN+1
"RTN","LR7OSUM6",103,0)
 S LRCNT=LRCNT*2+5+LRCTN
"RTN","LR7OSUM6",104,0)
 Q
"RTN","LR7OSUM6",105,0)
 ;
"RTN","LR7OSUM6",106,0)
 ;
"RTN","LR7OSUM6",107,0)
LN ;
"RTN","LR7OSUM6",108,0)
 S CCNT=1,GCNT=GCNT+1
"RTN","LR7OSUM6",109,0)
 Q
"RTN","LRRP1")
0^3^B22566819^B21441496
"RTN","LRRP1",1,0)
LRRP1 ;DALOI/RWF/BA-PRINT THE DATA FOR INTERIM REPORTS ;11/9/88  17:31
"RTN","LRRP1",2,0)
 ;;5.2;LAB SERVICE;**153,221,283,286,356**;Sep 27, 1994;Build 8
"RTN","LRRP1",3,0)
 ;from LRRP, LRRP2, LRRP3
"RTN","LRRP1",4,0)
 ;
"RTN","LRRP1",5,0)
PRINT S:'$L($G(SEX)) SEX="M" S:'$L($G(DOB)) DOB="UNKNOWN"
"RTN","LRRP1",6,0)
 S LRAAO=0 F  S LRAAO=$O(^TMP("LR",$J,"TP",LRAAO)) Q:LRAAO<1  D ORDER Q:LRSTOP
"RTN","LRRP1",7,0)
 K ^TMP("LR",$J,"TP")
"RTN","LRRP1",8,0)
 Q
"RTN","LRRP1",9,0)
 ;
"RTN","LRRP1",10,0)
 ;
"RTN","LRRP1",11,0)
ORDER N LRCAN
"RTN","LRRP1",12,0)
 S LRCDT=0
"RTN","LRRP1",13,0)
 F  S LRCDT=$O(^TMP("LR",$J,"TP",LRAAO,LRCDT)) Q:LRCDT<1  D
"RTN","LRRP1",14,0)
 . S LRCAN=0
"RTN","LRRP1",15,0)
 . I LRSS="CH" D
"RTN","LRRP1",16,0)
 . . S LRIDT=+^TMP("LR",$J,"TP",LRAAO,LRCDT,-2)
"RTN","LRRP1",17,0)
 . . F  S LRCAN=+$O(^LR(LRDFN,"CH",LRIDT,1,LRCAN)) Q:LRCAN<1  Q:$E($G(^(LRCAN,0)))="*"
"RTN","LRRP1",18,0)
 . D TEST Q:LRSTOP
"RTN","LRRP1",19,0)
 Q
"RTN","LRRP1",20,0)
 ;
"RTN","LRRP1",21,0)
 ;
"RTN","LRRP1",22,0)
TEST ;
"RTN","LRRP1",23,0)
 S LRIDT=+^TMP("LR",$J,"TP",LRAAO,LRCDT,-2)
"RTN","LRRP1",24,0)
 S LRSS=$P(^TMP("LR",$J,"TP",LRAAO),U,2)
"RTN","LRRP1",25,0)
 S LR0=$S($D(^(LRAAO,LRCDT))#2:^(LRCDT),1:""),LRTC=$P(LR0,U,12)
"RTN","LRRP1",26,0)
 I LRSS="MI" D  Q
"RTN","LRRP1",27,0)
 . S LRH=1 D:LRFOOT FOOT Q:LRSTOP
"RTN","LRRP1",28,0)
 . D EN1^LRMIPC
"RTN","LRRP1",29,0)
 . S LRHF=1,LRFOOT=0
"RTN","LRRP1",30,0)
 . K A,Z,LRH
"RTN","LRRP1",31,0)
 . S:LREND LREND=0,LRSTOP=1
"RTN","LRRP1",32,0)
 ;
"RTN","LRRP1",33,0)
 Q:'$G(LRCAN)&('$P(LR0,U,3))  D @$S(LRHF:"HDR",1:"CHECK") Q:LRSTOP
"RTN","LRRP1",34,0)
 S LRSPEC=+$P(LR0,U,5),X=$P(LR0,U,10) D DOC^LRX
"RTN","LRRP1",35,0)
 ;
"RTN","LRRP1",36,0)
 W !!,?7,"Provider: ",LRDOC
"RTN","LRRP1",37,0)
 W !,?7,"Specimen: ",$P(^LAB(61,LRSPEC,0),U)
"RTN","LRRP1",38,0)
 D ORU
"RTN","LRRP1",39,0)
 W !!,?30,"Specimen Collection Date: ",$$FMTE^XLFDT(LRCDT,"M")
"RTN","LRRP1",40,0)
 W !?5,"Test name",?30,"Result    units",?51,"Ref.   range",?66,"Site Code"
"RTN","LRRP1",41,0)
 S LRPO=0
"RTN","LRRP1",42,0)
 F  S LRPO=$O(^TMP("LR",$J,"TP",LRAAO,LRCDT,LRPO)) Q:LRPO'>0  S LRDATA=^(LRPO) D DATA Q:LRSTOP
"RTN","LRRP1",43,0)
 Q:LRSTOP
"RTN","LRRP1",44,0)
 ;
"RTN","LRRP1",45,0)
 I $D(^TMP("LR",$J,"TP",LRAAO,LRCDT,"C")) D
"RTN","LRRP1",46,0)
 . W !,"Comment: " S LRCMNT=0
"RTN","LRRP1",47,0)
 . F  S LRCMNT=+$O(^TMP("LR",$J,"TP",LRAAO,LRCDT,"C",LRCMNT)) Q:LRCMNT<1  D  Q:LRSTOP
"RTN","LRRP1",48,0)
 . . W ^TMP("LR",$J,"TP",LRAAO,LRCDT,"C",LRCMNT)
"RTN","LRRP1",49,0)
 . . D CONT Q:LRSTOP
"RTN","LRRP1",50,0)
 . . W:$O(^TMP("LR",$J,"TP",LRAAO,LRCDT,"C",LRCMNT)) !?9
"RTN","LRRP1",51,0)
 Q:LRSTOP  D EQUALS^LRX
"RTN","LRRP1",52,0)
 W !?7,"KEY: ""L""=Abnormal low, ""H""=Abnormal high, ""*""=Critical value"
"RTN","LRRP1",53,0)
 S LRFOOT=1
"RTN","LRRP1",54,0)
 Q
"RTN","LRRP1",55,0)
 ;
"RTN","LRRP1",56,0)
 ;
"RTN","LRRP1",57,0)
DATA ;
"RTN","LRRP1",58,0)
 N LR63DATA
"RTN","LRRP1",59,0)
 ;
"RTN","LRRP1",60,0)
 S LRTSTS=+LRDATA,LRPC=$P(LRDATA,U,5),LRSUB=$P(LRDATA,U,6)
"RTN","LRRP1",61,0)
 S X=$P(LRDATA,U,7) Q:X=""
"RTN","LRRP1",62,0)
 S LR63DATA=$$TSTRES^LRRPU(LRDFN,LRSS,LRIDT,$P(LRDATA,U,10),LRTSTS)
"RTN","LRRP1",63,0)
 S LRLO=$P(LR63DATA,"^",3),LRHI=$P(LR63DATA,"^",4),LRPLS=$P(LR63DATA,"^",6),LRTHER=$P(LR63DATA,"^",7)
"RTN","LRRP1",64,0)
 I LRPLS S LRPLS(LRPLS)=LRPLS
"RTN","LRRP1",65,0)
 ;
"RTN","LRRP1",66,0)
 W !?5,$S($L($P(LRDATA,U,2))>20:$P(LRDATA,U,3),1:$P(LRDATA,U,2))
"RTN","LRRP1",67,0)
 S X=$P(LR63DATA,"^")
"RTN","LRRP1",68,0)
 W ?27,@$S(LRPC="":"$J(X,LRCW)",1:LRPC)," ",$P(LR63DATA,"^",2)
"RTN","LRRP1",69,0)
 I $X>39 W !
"RTN","LRRP1",70,0)
 W ?40,$P(LR63DATA,U,5)
"RTN","LRRP1",71,0)
 I $X>50 W !
"RTN","LRRP1",72,0)
 W ?51
"RTN","LRRP1",73,0)
 I LRLO'="",LRHI'="" W $J(LRLO,4)_" to "_$J(LRHI,4)
"RTN","LRRP1",74,0)
 I LRLO'="",LRHI="" W $J($S(LRLO?.AP:LRLO,1:"low: "_LRLO),4)
"RTN","LRRP1",75,0)
 I LRLO="",LRHI'="" W $J($S(LRHI?.AP:LRHI,1:"high: "_LRHI),4)
"RTN","LRRP1",76,0)
 ;
"RTN","LRRP1",77,0)
 I LRPLS'="" D
"RTN","LRRP1",78,0)
 . I $X>67 W !
"RTN","LRRP1",79,0)
 . W ?68,"[",LRPLS,"]"
"RTN","LRRP1",80,0)
 D CONT Q:LRSTOP
"RTN","LRRP1",81,0)
 ;
"RTN","LRRP1",82,0)
 I $O(^TMP("LR",$J,"TP",LRAAO,LRCDT,LRPO,0))>0 D  Q:LRSTOP
"RTN","LRRP1",83,0)
 . S LRINTP=0
"RTN","LRRP1",84,0)
 . F  S LRINTP=+$O(^TMP("LR",$J,"TP",LRAAO,LRCDT,LRPO,LRINTP)) Q:LRINTP<1  W !?7,"Eval: ",^(LRINTP) D CONT Q:LRSTOP
"RTN","LRRP1",85,0)
 ;
"RTN","LRRP1",86,0)
 Q
"RTN","LRRP1",87,0)
 ;
"RTN","LRRP1",88,0)
 ;
"RTN","LRRP1",89,0)
CHECK I LRTC+11>(IOSL-$Y) D FOOT Q:LRSTOP  D HDR
"RTN","LRRP1",90,0)
 Q
"RTN","LRRP1",91,0)
 ;
"RTN","LRRP1",92,0)
 ;
"RTN","LRRP1",93,0)
CONT I $Y+5>IOSL D FOOT Q:LRSTOP  D HDR W !?20,">> CONTINUATION OF ",$P(LR0,U,6)," <<",!
"RTN","LRRP1",94,0)
 Q
"RTN","LRRP1",95,0)
FOOT ;from LRRP, LRRP2, LRRP3
"RTN","LRRP1",96,0)
 Q:LRSTOP  F I=$Y:1:IOSL-4 W !
"RTN","LRRP1",97,0)
 I $E(IOST,1,2)'="C-" W !,PNM,?40,"  ",SSN,"  ",$$HTE^XLFDT($H,"M"),! Q
"RTN","LRRP1",98,0)
 W !,PNM,?25,"  ",SSN,"  ",$$HTE^XLFDT($H,"MP"),?59," PRESS '^' TO STOP "
"RTN","LRRP1",99,0)
 R X:DTIME S:X="" X=1 S:(".^"[X)!('$T) LRSTOP=1
"RTN","LRRP1",100,0)
 Q
"RTN","LRRP1",101,0)
 ;
"RTN","LRRP1",102,0)
 ;
"RTN","LRRP1",103,0)
HDR ; Add Printed at, page #, change age to dob 7/2002 cka
"RTN","LRRP1",104,0)
 W:($G(LRJ02))!($G(LRJ0))!($E(IOST,1,2)="C-") @IOF
"RTN","LRRP1",105,0)
 S LRHF=0,LRJ02=1
"RTN","LRRP1",106,0)
 I '$D(LRPG) S LRPG=0
"RTN","LRRP1",107,0)
 S LRPG=LRPG+1
"RTN","LRRP1",108,0)
 I $E(IOST,1)="P" D
"RTN","LRRP1",109,0)
 .W !!!!
"RTN","LRRP1",110,0)
 .S X="CLINICAL LABORATORY REPORT"
"RTN","LRRP1",111,0)
 .W ?(80-$L(X)\2),X,!
"RTN","LRRP1",112,0)
 I $D(DUZ("AG")),$L(DUZ("AG")),"ARMYAFN"[DUZ("AG") D ^LRAIPRIV W !
"RTN","LRRP1",113,0)
 W "Printed at: ",?65,"page ",LRPG
"RTN","LRRP1",114,0)
 W !,$$NAME^XUAF4(DUZ(2))," (",DUZ(2),")"
"RTN","LRRP1",115,0)
 S X=$$PADD^XUAF4(DUZ(2))
"RTN","LRRP1",116,0)
 W !,$P(X,U)," ",$P(X,U,2),", ",$P(X,U,3)," ",$P(X,U,4)
"RTN","LRRP1",117,0)
 W !!,PNM,?44,"Report date: ",$$HTE^XLFDT($H,"M")
"RTN","LRRP1",118,0)
 W !?5,"SSN: ",SSN,"    SEX: ",SEX,"    DOB: ",$$FMTE^XLFDT(DOB),"    LOC: ",LROC
"RTN","LRRP1",119,0)
 Q
"RTN","LRRP1",120,0)
 ;
"RTN","LRRP1",121,0)
ORU ; Display remote ordering info if available
"RTN","LRRP1",122,0)
 N LRX,IENS
"RTN","LRRP1",123,0)
 S LRX=$G(^LR(LRDFN,"CH",LRIDT,"ORU")),IENS=LRIDT_","_LRDFN_","
"RTN","LRRP1",124,0)
 D EN^DDIOL("Accession [UID]: "_$P(LR0,"^",6)_" ["_$P(LRX,"^")_"]","","!")
"RTN","LRRP1",125,0)
 I $P(LRX,"^",3) D
"RTN","LRRP1",126,0)
 . D EN^DDIOL("Ordering Site: "_$$GET1^DIQ(63.04,IENS,.33,""),"","!?2")
"RTN","LRRP1",127,0)
 . D EN^DDIOL(" Ordering Site UID: "_$P(LRX,"^",5),"","?43")
"RTN","LRRP1",128,0)
 I $P(LRX,"^",2) D EN^DDIOL("Collecting Site: "_$$GET1^DIQ(63.04,IENS,.32,""),"","!")
"RTN","LRRP1",129,0)
 Q
"UP",60,60.01,-1)
60^1
"UP",60,60.01,0)
60.01
"VER")
8.0^22.0
"^DD",60,60.01,1,0)
REFERENCE LOW^FX^^0;2^K:$L(X)>50!($E(X,1)?1A)!(X["^") X I $D(X) S X="S X="_X D ^DIM Q:'$D(X)  S X=$P(X,"=",2,99)
"^DD",60,60.01,1,3)
ANSWER MUST BE 0-50 CHARACTERS IN LENGTH (USE "QUOTES" AROUND TEXT)
"^DD",60,60.01,1,21,0)
^.001^16^16^3070301^^
"^DD",60,60.01,1,21,1,0)
This is the user entered reference low value for this test.
"^DD",60,60.01,1,21,2,0)
If both the low and high are defined it will print in this manner:
"^DD",60,60.01,1,21,3,0)
        low : 10
"^DD",60,60.01,1,21,4,0)
        high : 50
"^DD",60,60.01,1,21,5,0)
If only the low is defined and it is numeric it will print in this
"^DD",60,60.01,1,21,6,0)
manner:
"^DD",60,60.01,1,21,7,0)
        low: 10
"^DD",60,60.01,1,21,8,0)
If only the low is defined and it is alphanumeric it will print in 
"^DD",60,60.01,1,21,9,0)
this manner:
"^DD",60,60.01,1,21,10,0)
        NORMAL
"^DD",60,60.01,1,21,11,0)
If only the high is defined and it is numeric it will print in this 
"^DD",60,60.01,1,21,12,0)
manner:
"^DD",60,60.01,1,21,13,0)
        high: 50
"^DD",60,60.01,1,21,14,0)
If only the high is defined and it is alphanumeric it will print in
"^DD",60,60.01,1,21,15,0)
this manner:
"^DD",60,60.01,1,21,16,0)
        >1000
"^DD",60,60.01,1,"DT")
3070124
"^DD",60,60.01,2,0)
REFERENCE HIGH^FX^^0;3^K:$L(X)>50!($E(X,1)?1A)!(X["^") X I $D(X) S X="S X="_X D ^DIM Q:'$D(X)  S X=$P(X,"=",2,99)
"^DD",60,60.01,2,3)
ANSWER MUST BE 0-50 CHARACTERS IN LENGTH (USE "QUOTES" AROUND TEXT)
"^DD",60,60.01,2,21,0)
^^16^16^3070124^
"^DD",60,60.01,2,21,1,0)
This is the user entered reference high value for this test.
"^DD",60,60.01,2,21,2,0)
If both the low and high are defined it will print in this manner:
"^DD",60,60.01,2,21,3,0)
        low : 10
"^DD",60,60.01,2,21,4,0)
        high : 50
"^DD",60,60.01,2,21,5,0)
If only the low is defined and it is numeric it will print in this
"^DD",60,60.01,2,21,6,0)
manner: 
"^DD",60,60.01,2,21,7,0)
        low: 10
"^DD",60,60.01,2,21,8,0)
If only the low is defined and it is alphanumeric it will print in 
"^DD",60,60.01,2,21,9,0)
this manner:
"^DD",60,60.01,2,21,10,0)
        NORMAL
"^DD",60,60.01,2,21,11,0)
If only the high is defined and it is numeric it will print in this 
"^DD",60,60.01,2,21,12,0)
manner:
"^DD",60,60.01,2,21,13,0)
        high: 50
"^DD",60,60.01,2,21,14,0)
If only the high is defined and it is alphanumeric it will print in
"^DD",60,60.01,2,21,15,0)
this manner:
"^DD",60,60.01,2,21,16,0)
        >1000
"^DD",60,60.01,2,"DT")
3070124
"^DD",60,60.01,3,0)
CRITICAL LOW^FX^^0;4^K:$L(X)>50!($E(X,1)?1A)!(X["^") X I $D(X) S X="S X="_X D ^DIM Q:'$D(X)  S X=$P(X,"=",2,99)
"^DD",60,60.01,3,3)
ANSWER MUST BE 0-50 CHARACTERS IN LENGTH (USE "QUOTES" AROUND TEXT)
"^DD",60,60.01,3,21,0)
^^17^17^3070124^
"^DD",60,60.01,3,21,1,0)
This is the user entered critical low value for this test.
"^DD",60,60.01,3,21,2,0)
Used to flag results.
"^DD",60,60.01,3,21,3,0)
If both the low and high are defined it will print in this manner:
"^DD",60,60.01,3,21,4,0)
        low : 10
"^DD",60,60.01,3,21,5,0)
        high : 50
"^DD",60,60.01,3,21,6,0)
If only the low is defined and it is numeric it will print in this
"^DD",60,60.01,3,21,7,0)
manner: 
"^DD",60,60.01,3,21,8,0)
        low: 10
"^DD",60,60.01,3,21,9,0)
If only the low is defined and it is alphanumeric it will print in 
"^DD",60,60.01,3,21,10,0)
this manner:
"^DD",60,60.01,3,21,11,0)
        NORMAL
"^DD",60,60.01,3,21,12,0)
If only the high is defined and it is numeric it will print in this 
"^DD",60,60.01,3,21,13,0)
manner:
"^DD",60,60.01,3,21,14,0)
        high: 50
"^DD",60,60.01,3,21,15,0)
If only the high is defined and it is alphanumeric it will print in
"^DD",60,60.01,3,21,16,0)
this manner:
"^DD",60,60.01,3,21,17,0)
        >1000
"^DD",60,60.01,3,"DT")
3070124
"^DD",60,60.01,4,0)
CRITICAL HIGH^FX^^0;5^K:$L(X)>50!($E(X,1)?1A)!(X["^") X I $D(X) S X="S X="_X D ^DIM Q:'$D(X)  S X=$P(X,"=",2,99)
"^DD",60,60.01,4,3)
ANSWER MUST BE 0-50 CHARACTERS IN LENGTH (USE "QUOTES" AROUND TEXT)
"^DD",60,60.01,4,21,0)
^^16^16^3070124^
"^DD",60,60.01,4,21,1,0)
This is the user entered critical high value of this test.  Used to flag results.
"^DD",60,60.01,4,21,2,0)
If both the low and high are defined it will print in this manner:
"^DD",60,60.01,4,21,3,0)
        low : 10
"^DD",60,60.01,4,21,4,0)
        high : 50
"^DD",60,60.01,4,21,5,0)
If only the low is defined and it is numeric it will print in this
"^DD",60,60.01,4,21,6,0)
manner: 
"^DD",60,60.01,4,21,7,0)
        low: 10
"^DD",60,60.01,4,21,8,0)
If only the low is defined and it is alphanumeric it will print in 
"^DD",60,60.01,4,21,9,0)
this manner:
"^DD",60,60.01,4,21,10,0)
        NORMAL
"^DD",60,60.01,4,21,11,0)
If only the high is defined and it is numeric it will print in this 
"^DD",60,60.01,4,21,12,0)
manner:
"^DD",60,60.01,4,21,13,0)
        high: 50
"^DD",60,60.01,4,21,14,0)
If only the high is defined and it is alphanumeric it will print in
"^DD",60,60.01,4,21,15,0)
this manner:
"^DD",60,60.01,4,21,16,0)
        >1000
"^DD",60,60.01,4,"DT")
3070124
"^DD",60,60.01,9.2,0)
THERAPEUTIC LOW^FX^^0;11^K:$L(X)>30!($L(X)<1)!(X["^") X I $D(X) S X="S X="_X D ^DIM I $D(X) S X=$E(X,5,256)
"^DD",60,60.01,9.2,3)
ENTER LOW END OF THERAPEUTIC RANGE (USE "QUOTES" AROUND TEXT)
"^DD",60,60.01,9.2,21,0)
^^16^16^3070124^
"^DD",60,60.01,9.2,21,1,0)
This is the low end value of the therapeutic range.  Used to flag results.
"^DD",60,60.01,9.2,21,2,0)
If both the low and high are defined it will print in this manner:
"^DD",60,60.01,9.2,21,3,0)
        low : 10
"^DD",60,60.01,9.2,21,4,0)
        high : 50
"^DD",60,60.01,9.2,21,5,0)
If only the low is defined and it is numeric it will print in this
"^DD",60,60.01,9.2,21,6,0)
manner: 
"^DD",60,60.01,9.2,21,7,0)
        low: 10
"^DD",60,60.01,9.2,21,8,0)
If only the low is defined and it is alphanumeric it will print in 
"^DD",60,60.01,9.2,21,9,0)
this manner:
"^DD",60,60.01,9.2,21,10,0)
        NORMAL
"^DD",60,60.01,9.2,21,11,0)
If only the high is defined and it is numeric it will print in this 
"^DD",60,60.01,9.2,21,12,0)
manner:
"^DD",60,60.01,9.2,21,13,0)
        high: 50
"^DD",60,60.01,9.2,21,14,0)
If only the high is defined and it is alphanumeric it will print in
"^DD",60,60.01,9.2,21,15,0)
this manner:
"^DD",60,60.01,9.2,21,16,0)
        >1000
"^DD",60,60.01,9.2,"DT")
3070124
"^DD",60,60.01,9.3,0)
THERAPEUTIC HIGH^FX^^0;12^K:$L(X)>30!($L(X)<1)!(X["^") X I $D(X) S X="S X="_X D ^DIM I $D(X) S X=$E(X,5,256)
"^DD",60,60.01,9.3,3)
ENTER HIGH END OF THERAPEUTIC RANGE (USE "QUOTES" AROUND TEXT)
"^DD",60,60.01,9.3,21,0)
^^16^16^3070124^
"^DD",60,60.01,9.3,21,1,0)
This is the high end value of the therapeutic range.  Used to flag results.
"^DD",60,60.01,9.3,21,2,0)
If both the low and high are defined it will print in this manner:
"^DD",60,60.01,9.3,21,3,0)
        low : 10
"^DD",60,60.01,9.3,21,4,0)
        high : 50
"^DD",60,60.01,9.3,21,5,0)
If only the low is defined and it is numeric it will print in this
"^DD",60,60.01,9.3,21,6,0)
manner: 
"^DD",60,60.01,9.3,21,7,0)
        low: 10
"^DD",60,60.01,9.3,21,8,0)
If only the low is defined and it is alphanumeric it will print in 
"^DD",60,60.01,9.3,21,9,0)
this manner:
"^DD",60,60.01,9.3,21,10,0)
        NORMAL
"^DD",60,60.01,9.3,21,11,0)
If only the high is defined and it is numeric it will print in this 
"^DD",60,60.01,9.3,21,12,0)
manner:
"^DD",60,60.01,9.3,21,13,0)
        high: 50
"^DD",60,60.01,9.3,21,14,0)
If only the high is defined and it is alphanumeric it will print in
"^DD",60,60.01,9.3,21,15,0)
this manner:
"^DD",60,60.01,9.3,21,16,0)
        >1000
"^DD",60,60.01,9.3,"DT")
3070124
"BLD",6760,6)
^282
**END**
**END**
