$TXT Created by HUA,PATRICK at CARVDD.FO-ALBANY.MED.VA.GOV  (KIDS) on Wednesday, 01/05/05 at 14:03
=============================================================================
Run Date: JAN 07, 2005                     Designation: IVM*2*94
Package : IVM - INCOME VERIFICATION MATCH     Priority: Mandatory
Version : 2        SEQ #87                      Status: Released
                  Compliance Date: FEB 07, 2005
=============================================================================

Associated patches: (v)IVM*2*9     <<= must be installed BEFORE `IVM*2*94'
                    (v)IVM*2*14    <<= must be installed BEFORE `IVM*2*94'
                    (v)DG*5.3*570  <<= must be installed BEFORE `IVM*2*94'
                    (v)IVM*2*95    <<= must be installed BEFORE `IVM*2*94'
                    (v)IB*2*267    <<= must be installed BEFORE `IVM*2*94'

Subject: IB/AR ENCAPSULATION W/IVM

Category: 
  - Routine

Description:
============

 This patch is in support of the Billing Replacement - Encapsulation 
 Project.  The objective of this project is to standardize existing VistA 
 Integrated Billing and Accounts Receivable functionality so that a new 
 COTS billing/AR product may be effectively integrated into the VistA 
 suite.  This will be accomplished by replacing direct IB and AR touch 
 points with standard authorized APIs available to all VistA packages.
  
 This patch will replace with new APIs, all current direct access of
 Insurance Information from FileMan globals and the use of IB APIs being
 retired (DBIA10145 and DBIA10146) in the VistA Income Verification 
 Matching package. These IAs provided supported APIs to retrieve and
 display insurance information.  A new supported API, $$INSUR^IBBAPI
 (DBIA4419), is being provided to retrieve insurance information.  A new
 private API, DISP^DGIBDSP (DBIA4408), will provide a generic display of a
 patient's current insurance information. The IBBAPI calls were released
 with patch IB*2*256, IB INSURANCE API.
  
 This patch addresses the following E3R(s):
 ------------------------------------------
 There are no E3Rs associated with this patch.
  
  
 This patch addresses the following NOIS message(s):
 ---------------------------------------------------
 There are no NOIS messages associated with this patch.
  
  
 Test Sites:
 -----------
 Clarksburg, WV - VAMC
 EL PASO VA HEALTH CARE CENTER
 MANCHESTER, NH -VAMC 
  
  
  
        ================INSTALLATION INSTRUCTIONS =================
   
 If installed during the normal workday, it is recommended that the 
 following menu options (File #19) and all of their descendants be 
 disabled to prevent possible conflicts while running the KIDS Install. 
 Other VISTA users will not be affected.
   
            Insurance Upload
   
   
 Install Time - 5 MINUTES
  
  
   1.   LOAD TRANSPORT GLOBAL 
        ---------------------
        Choose the PackMan message containing this patch and invoke the 
        INSTALL/CHECK MESSAGE PackMan option.
  
   2.   DISABLE ROUTINE MAPPING   (DSM for Open VMS sites only) 
        -----------------------
        Disable routine mapping on all systems for the routines listed in 
        step 3 below.
  
        NOTE:  If the routines included in this patch are not currently in 
               your mapped routine set, please skip this step.
  
   3.   COMPONENTS SENT WITH PATCH 
        ------------------------
        The following is a list of the routines included in this patch.  
        The second line of each of these routines now looks like:
  
      <tab>;;2.0;INCOME VERIFICATION MATCH;**[patch list]**; 21-OCT-94
  
                             CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  IVMLINS                7177198              7168402            14,94
  IVMLINS1              10127041             10129135            14,94
  IVMPINS                1464291              1470216            9,94
  IVMUFNC                6385950              6406389        3,11,17,34,95
                                                                   94
  
     Total number of routines - 4
  
  
   4.   START UP KIDS 
        -------------
        Start up the Kernel Installation and Distribution System Menu 
        [XPD MAIN]:
  
             Edits and Distribution ...  
             Utilities ...  
             Installation ...
  
   Select Kernel Installation & Distribution System Option: INStallation 
                                                            ---
             Load a Distribution 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Install Package(s) 
             Restart Install of Package(s) 
             Unload a Distribution 
             Backup a Transport Global 
  
   Select Installation Option:
  
   5.   Select Installation Option: 
        --------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter IVM*2.0*94):
  
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
  
   6.   Select Installation Option: Install Package(s) 
                                    ----------------
        **This is the step to start the installation of this KIDS patch: 
  
        a.  Choose the Install Package(s) option to start the patch 
            install.
        b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? 
            YES//' answer NO
        c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
            Options, and Protocols? YES//' answer YES 
        d.  When prompted 'Enter options you wish to mark as 'Out Of
            Order':'  Enter the following options:
  
         [IVM UPLOAD INS]   Insurance Upload
  
        e.  When prompted 'Enter protocols you wish to mark as 'Out Of 
            Order':' press <return>.
  
   7.   REBUILD MAPPED ROUTINE(S)  (DSM for Open VMS sites only)
        -------------------------
        Optional - Include the routines distributed with this patch
        in the mapped routine set.
  
        NOTE: This step is only necessary if you performed step 2 or 
              if you wish to include the routines in your mapped set.

Routine Information:
====================

Routine Name:
  - IVMLINS

 Before
 ======
  
     ..;
     ..; - check if patient has active insurance
     ..S IVMINS=$$INSURED^IBCNS1(DFN,DT),IVMINS=$S(IVMINS=1:"YES",1:"NO")
     ..;
     ..; - build line for list manager display
     ..D BLDLINE
     ;
  
  
 After
 =====
  
     ..;
     ..; - check if patient has active insurance
     ..S IVMINS=$$INSUR^IBBAPI(DFN,DT),IVMINS=$S(IVMINS=1:"YES",1:"NO")
     ..;
     ..; - build line for list manager display
     ..D BLDLINE
     ;

Routine Checksum:

Routine Name:
  - IVMPINS

 Before
 ======
  
     ;
     ; - determine changes in insurance status
     S IVMINSP=$$PRIOR(IVMDA)
     S IVMINSA=$$INSURED^IBCNS1(DFN)
     ;
     ; - queue transmission if status has changed
     I IVMDA,(IVMINSP&'IVMINSA)!('IVMINSP&IVMINSA) I $$SETSTAT^IVMPLOG(
 IVMDA,.EVENTS)
  
  
 After
 =====
  
     ;
     ; - determine changes in insurance status
     S IVMINSP=$$PRIOR(IVMDA)
     S IVMINSA=$$INSUR^IBBAPI(DFN)
     ;
     ; - queue transmission if status has changed
     I IVMDA,(IVMINSP&'IVMINSA)!('IVMINSP&IVMINSA=1) I $$SETSTAT^IVMPLOG(
 IVMDA,.EVENTS)
     ;

Routine Checksum:

Routine Name:
  - IVMUFNC

 Before
 ======
  
  59 INS(DFN,IVMDT) --
             ; extrinsic function to see if pt has active insurance
  60        ;
  61        ;  Input - DFN as internal entry number of PATIENT file
  62        ;          IVMDT [optional] as date to compute ins coverage for
  63        ;
  64        ; Output - 1 if yes, 0 if no
  65        ;
  66        Q $$INSURED^IBCNS1(DFN,$G(IVMDT))
  67        ;
  
  
 After
 =====
  
  59 INS(DFN,IVMDT) --
             ; extrinsic function to see if pt has active insurance
  60        ;
  61        ;  Input - DFN as internal entry number of PATIENT file
  62        ;          IVMDT [optional] as date to compute ins coverage for
  63        ;
  64        ; Output - 1 if yes, 0 if no
  65        ;
  66        Q $S($$INSUR^IBBAPI(DFN,$G(IVMDT))=1:1,1:0)
  67        ;

Routine Checksum:

Routine Name:
  - IVMLINS1

 Before
 ======
  
  54 ALL    ; - display all insurance company information for patient in DHCP
  55        ;
  56        W !,?22,"INSURANCE POLICIES CURRENTLY ON FILE"
  57        ; - write dashed line
  58        W !,?7,$TR($J("",66)," ","*")
  59        ;
  60        ; - IB call to display all DHCP ins co. information
  61        D DISP^IBCNS
  62        W !
  63        Q
  64        ;
  
  
 After
 =====
  
  54 ALL    ; - display all insurance company information for patient in DHCP
  55        ;
  56        W !,?22,"INSURANCE POLICIES CURRENTLY ON FILE"
  57        ; - write dashed line
  58        W !,?7,$TR($J("",66)," ","*")
  59        ;
  60        ; - IB call to display all DHCP ins co. information
  61        D DISP^DGIBDSP
  62        W !
  63        Q
  64        ;

Routine Checksum:

=============================================================================
User Information:
Entered By  : MULLER,RICHARD                Date Entered  : NOV 14, 2003
Completed By: HUA,PATRICK                   Date Completed: JAN 07, 2005
Released By : GANUS,MAUNETTE                Date Released : JAN 07, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
