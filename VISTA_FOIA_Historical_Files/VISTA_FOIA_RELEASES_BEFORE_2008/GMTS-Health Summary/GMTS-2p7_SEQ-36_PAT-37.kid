Released GMTS*2.7*37 SEQ #36
Extracted from mail message
**KIDS**:GMTS*2.7*37^

**INSTALL NAME**
GMTS*2.7*37
"BLD",2130,0)
GMTS*2.7*37^HEALTH SUMMARY^0^3000726^y
"BLD",2130,1,0)
^^2^2^3000705^
"BLD",2130,1,1,0)
The description of this patch may be found on the National Patch Module 
"BLD",2130,1,2,0)
under GMTS*2.7*37.
"BLD",2130,4,0)
^9.64PA^142.1^2
"BLD",2130,4,142,0)
142
"BLD",2130,4,142,222)
y^y^f^^^^n
"BLD",2130,4,142.1,0)
142.1
"BLD",2130,4,142.1,222)
y^y^f^^^^n
"BLD",2130,4,"B",142,142)

"BLD",2130,4,"B",142.1,142.1)

"BLD",2130,"INIT")
POST^GMTSP37
"BLD",2130,"KRN",0)
^9.67PA^19^17
"BLD",2130,"KRN",.4,0)
.4
"BLD",2130,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",2130,"KRN",.401,0)
.401
"BLD",2130,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",2130,"KRN",.402,0)
.402
"BLD",2130,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",2130,"KRN",.403,0)
.403
"BLD",2130,"KRN",.5,0)
.5
"BLD",2130,"KRN",.5,"NM",0)
^9.68A^^0
"BLD",2130,"KRN",.84,0)
.84
"BLD",2130,"KRN",3.6,0)
3.6
"BLD",2130,"KRN",3.8,0)
3.8
"BLD",2130,"KRN",9.2,0)
9.2
"BLD",2130,"KRN",9.8,0)
9.8
"BLD",2130,"KRN",9.8,"NM",0)
^9.68A^31^27
"BLD",2130,"KRN",9.8,"NM",3,0)
GMTSLOAD^^0^B14661203
"BLD",2130,"KRN",9.8,"NM",5,0)
GMTSRO^^0^B32490168
"BLD",2130,"KRN",9.8,"NM",6,0)
GMTSROE^^0^B60909758
"BLD",2130,"KRN",9.8,"NM",7,0)
GMTSRON^^0^B22782266
"BLD",2130,"KRN",9.8,"NM",9,0)
GMTS1^^0^B21363277
"BLD",2130,"KRN",9.8,"NM",10,0)
GMTSPXU1^^0^B9810010
"BLD",2130,"KRN",9.8,"NM",11,0)
GMTSUMX^^0^B18981122
"BLD",2130,"KRN",9.8,"NM",12,0)
GMTSUMX2^^0^B70871216
"BLD",2130,"KRN",9.8,"NM",13,0)
GMTSUMX3^^0^B30116533
"BLD",2130,"KRN",9.8,"NM",14,0)
GMTSPXOP^^0^B43252002
"BLD",2130,"KRN",9.8,"NM",15,0)
GMTSXPD3^^0^B52302276
"BLD",2130,"KRN",9.8,"NM",16,0)
GMTSADH1^^0^B14479938
"BLD",2130,"KRN",9.8,"NM",17,0)
GMTSADH2^^0^B23089017
"BLD",2130,"KRN",9.8,"NM",18,0)
GMTSADH4^^0^B6003157
"BLD",2130,"KRN",9.8,"NM",19,0)
GMTSADH5^^0^B36851550
"BLD",2130,"KRN",9.8,"NM",20,0)
GMTSPSO^^0^B9775330
"BLD",2130,"KRN",9.8,"NM",21,0)
GMTSPSO7^^0^B8298625
"BLD",2130,"KRN",9.8,"NM",22,0)
GMTSRAE^^0^B59484513
"BLD",2130,"KRN",9.8,"NM",23,0)
GMTSRAI^^0^B7342296
"BLD",2130,"KRN",9.8,"NM",24,0)
GMTSRAS^^0^B40431610
"BLD",2130,"KRN",9.8,"NM",25,0)
GMTSRASP^^0^B10464783
"BLD",2130,"KRN",9.8,"NM",26,0)
GMTSRM1^^0^B21018400
"BLD",2130,"KRN",9.8,"NM",27,0)
GMTSRM5^^0^B7479939
"BLD",2130,"KRN",9.8,"NM",28,0)
GMTSU^^0^B27886130
"BLD",2130,"KRN",9.8,"NM",29,0)
GMTSXPS3^^0^B34107288
"BLD",2130,"KRN",9.8,"NM",30,0)
GMTSLRPE^^0^B8303746
"BLD",2130,"KRN",9.8,"NM",31,0)
GMTSLRME^^0^B22143639
"BLD",2130,"KRN",9.8,"NM","B","GMTS1",9)

"BLD",2130,"KRN",9.8,"NM","B","GMTSADH1",16)

"BLD",2130,"KRN",9.8,"NM","B","GMTSADH2",17)

"BLD",2130,"KRN",9.8,"NM","B","GMTSADH4",18)

"BLD",2130,"KRN",9.8,"NM","B","GMTSADH5",19)

"BLD",2130,"KRN",9.8,"NM","B","GMTSLOAD",3)

"BLD",2130,"KRN",9.8,"NM","B","GMTSLRME",31)

"BLD",2130,"KRN",9.8,"NM","B","GMTSLRPE",30)

"BLD",2130,"KRN",9.8,"NM","B","GMTSPSO",20)

"BLD",2130,"KRN",9.8,"NM","B","GMTSPSO7",21)

"BLD",2130,"KRN",9.8,"NM","B","GMTSPXOP",14)

"BLD",2130,"KRN",9.8,"NM","B","GMTSPXU1",10)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRAE",22)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRAI",23)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRAS",24)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRASP",25)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRM1",26)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRM5",27)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRO",5)

"BLD",2130,"KRN",9.8,"NM","B","GMTSROE",6)

"BLD",2130,"KRN",9.8,"NM","B","GMTSRON",7)

"BLD",2130,"KRN",9.8,"NM","B","GMTSU",28)

"BLD",2130,"KRN",9.8,"NM","B","GMTSUMX",11)

"BLD",2130,"KRN",9.8,"NM","B","GMTSUMX2",12)

"BLD",2130,"KRN",9.8,"NM","B","GMTSUMX3",13)

"BLD",2130,"KRN",9.8,"NM","B","GMTSXPD3",15)

"BLD",2130,"KRN",9.8,"NM","B","GMTSXPS3",29)

"BLD",2130,"KRN",19,0)
19
"BLD",2130,"KRN",19,"NM",0)
^9.68A^^0
"BLD",2130,"KRN",19.1,0)
19.1
"BLD",2130,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",2130,"KRN",101,0)
101
"BLD",2130,"KRN",101,"NM",0)
^9.68A^^0
"BLD",2130,"KRN",409.61,0)
409.61
"BLD",2130,"KRN",771,0)
771
"BLD",2130,"KRN",870,0)
870
"BLD",2130,"KRN",8994,0)
8994
"BLD",2130,"KRN","B",.4,.4)

"BLD",2130,"KRN","B",.401,.401)

"BLD",2130,"KRN","B",.402,.402)

"BLD",2130,"KRN","B",.403,.403)

"BLD",2130,"KRN","B",.5,.5)

"BLD",2130,"KRN","B",.84,.84)

"BLD",2130,"KRN","B",3.6,3.6)

"BLD",2130,"KRN","B",3.8,3.8)

"BLD",2130,"KRN","B",9.2,9.2)

"BLD",2130,"KRN","B",9.8,9.8)

"BLD",2130,"KRN","B",19,19)

"BLD",2130,"KRN","B",19.1,19.1)

"BLD",2130,"KRN","B",101,101)

"BLD",2130,"KRN","B",409.61,409.61)

"BLD",2130,"KRN","B",771,771)

"BLD",2130,"KRN","B",870,870)

"BLD",2130,"KRN","B",8994,8994)

"BLD",2130,"QUES",0)
^9.62^^
"BLD",2130,"REQB",0)
^9.611^5^4
"BLD",2130,"REQB",1,0)
GMTS*2.7*35^2
"BLD",2130,"REQB",3,0)
PX*1.0*88^2
"BLD",2130,"REQB",4,0)
SR*3.0*88^2
"BLD",2130,"REQB",5,0)
RA*5.0*10^2
"BLD",2130,"REQB","B","GMTS*2.7*35",1)

"BLD",2130,"REQB","B","PX*1.0*88",3)

"BLD",2130,"REQB","B","RA*5.0*10",5)

"BLD",2130,"REQB","B","SR*3.0*88",4)

"FIA",142)
HEALTH SUMMARY TYPE
"FIA",142,0)
^GMT(142,
"FIA",142,0,0)
142
"FIA",142,0,1)
y^y^f^^^^n
"FIA",142,0,10)

"FIA",142,0,11)

"FIA",142,0,"RLRO")

"FIA",142,0,"VR")
2.7^GMTS
"FIA",142,142)
0
"FIA",142,142.01)
0
"FIA",142,142.14)
0
"FIA",142,142.2)
0
"FIA",142.1)
HEALTH SUMMARY COMPONENT
"FIA",142.1,0)
^GMT(142.1,
"FIA",142.1,0,0)
142.1I
"FIA",142.1,0,1)
y^y^f^^^^n
"FIA",142.1,0,10)

"FIA",142.1,0,11)

"FIA",142.1,0,"RLRO")

"FIA",142.1,0,"VR")
2.7^GMTS
"FIA",142.1,142.1)
0
"FIA",142.1,142.11)
0
"FIA",142.1,142.17)
0
"FIA",142.1,142.35)
0
"INIT")
POST^GMTSP37
"MBREQ")
0
"PKG",126,-1)
1^1
"PKG",126,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools
"PKG",126,20,0)
^9.402P^^
"PKG",126,22,0)
^9.49I^1^1
"PKG",126,22,1,0)
2.7^2951020^2951020^11
"PKG",126,22,1,"PAH",1,0)
37^3000726
"PKG",126,22,1,"PAH",1,1,0)
^^2^2^3000726
"PKG",126,22,1,"PAH",1,1,1,0)
The description of this patch may be found on the National Patch Module 
"PKG",126,22,1,"PAH",1,1,2,0)
under GMTS*2.7*37.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
28
"RTN","GMTS1")
0^9^B21363277
"RTN","GMTS1",1,0)
GMTS1 ; SLC/JER,KER - Health Summary Driver ; 07/18/2000
"RTN","GMTS1",2,0)
 ;;2.7;Health Summary;**7,16,24,28,37**;Oct 20, 1995
"RTN","GMTS1",3,0)
EN ; ***** ENTRY TO GENERATE A SUMMARY
"RTN","GMTS1",4,0)
 ; ***** REQUIRES DFN,GMTSTITL,GMTSEG(),GMTSEGI(),GMTSEGC,DUZ(2)
"RTN","GMTS1",5,0)
 ; ***** $I & IO MUST BE VALID, CALLER MUST CLOSE OUTPUT DEVICE
"RTN","GMTS1",6,0)
 ;
"RTN","GMTS1",7,0)
START ;
"RTN","GMTS1",8,0)
 N GMSUPRES,GMTSICF,GMTSPXD1,GMTSPXD2,GMTSBEG,GMTSEND
"RTN","GMTS1",9,0)
 S GMSUPRES=$P($G(^GMT(142,+$G(GMTSTYP),0)),U,5)
"RTN","GMTS1",10,0)
 U IO S GMTSLO=3,GMTSLPG=0
"RTN","GMTS1",11,0)
 D DEM^GMTSU
"RTN","GMTS1",12,0)
 W:$E(IOST)="C" @IOF D OUTPUT
"RTN","GMTS1",13,0)
 K GMTSCVD,GMTSCKP,GMTSNPG,GMTSPG,GMTSQIT,GMTSHDR,GMTSHD2,GMTSBRK,GMTSLCMP,GMTSDTC
"RTN","GMTS1",14,0)
 K GMTSEGN,GMTSE,GMTSEGR,GMTSEQ,GMTSEGH,GMTSEGL,GMTSDLM,GMTSDLS,GMTSNDM,GMTSN,GMTSQ
"RTN","GMTS1",15,0)
 Q
"RTN","GMTS1",16,0)
 ;
"RTN","GMTS1",17,0)
OUTPUT ; Loop through GMTSEG()
"RTN","GMTS1",18,0)
 ; DBIA 10000 call NOW^%DTC
"RTN","GMTS1",19,0)
 D NOW^%DTC S X=% D REGDTM4^GMTSU S GMTSDTM=X
"RTN","GMTS1",20,0)
 I +$G(GMTSPX1)&+$G(GMTSPX2) D  ;Allows date range for data
"RTN","GMTS1",21,0)
 . S GMTS2=9999999-$P(GMTSPX2,"."),GMTS1=9999999-$P(GMTSPX1,".")-.24
"RTN","GMTS1",22,0)
 . ;For GMTS1 want to get everything till Midnight
"RTN","GMTS1",23,0)
 . S X=GMTSPX1 D REGDT4^GMTSU S GMTSPXD1=X
"RTN","GMTS1",24,0)
 . S X=GMTSPX2 D REGDT4^GMTSU S GMTSPXD2=X
"RTN","GMTS1",25,0)
 D HEADER^GMTSUP
"RTN","GMTS1",26,0)
 K GMTSQIT S GMTSEGN=""
"RTN","GMTS1",27,0)
 F  S GMTSEGN=$O(GMTSEG(GMTSEGN)) Q:GMTSEGN=""  K GMTSQIT S GMTSEQ=$P(GMTSEG(GMTSEGN),U,1),GMTSE=$P(GMTSEG(GMTSEGN),U,2) D SEGMNT D:GMTSEGN=GMTSEGC LASTPG I $D(GMTSQIT),(GMTSQIT="") Q
"RTN","GMTS1",28,0)
 S GMTSHDR=$E(GMTSHDR,1,3)_" END "_$E(GMTSHDR,9,79)
"RTN","GMTS1",29,0)
 W:$E(IOST)'="C" !,GMTSHDR,!
"RTN","GMTS1",30,0)
 H:$E(IOST)="C" 1
"RTN","GMTS1",31,0)
 W:'+$G(GMPSAP) @IOF
"RTN","GMTS1",32,0)
 I $D(GMTSQIT) D EXIT
"RTN","GMTS1",33,0)
 Q
"RTN","GMTS1",34,0)
 ;
"RTN","GMTS1",35,0)
LASTPG ;ALLOWS USER TO BRANCH TO AN EARLIER COMPONENT ON THE LAST PAGE
"RTN","GMTS1",36,0)
 Q:$E(IOST)'="C"!(IOT="HFS")!$D(GMTSQIT)
"RTN","GMTS1",37,0)
 I +$G(GMPSAP),IOSL>998,$G(GMPAT(+$O(GMPAT(0),-1)))'=DFN Q
"RTN","GMTS1",38,0)
 ; Don't do footer when IOSL > 998 and action profile is printed.
"RTN","GMTS1",39,0)
 I IOSL>998,+$G(GMPSAP) Q
"RTN","GMTS1",40,0)
 ; Don't do footer when IOSL > 998 and this isn't the last patient.
"RTN","GMTS1",41,0)
 I IOSL>998,$G(GMPAT(+$O(GMPAT(""),-1)))'=$G(DFN) Q
"RTN","GMTS1",42,0)
 F I=$Y:1:$S((IOSL-GMTSLO)'>64:(IOSL-GMTSLO),1:(24-GMTSLO)) W !
"RTN","GMTS1",43,0)
 I $D(GMTSQIT),(GMTSQIT>0) K GMTSQIT
"RTN","GMTS1",44,0)
 S GMTSLPG=1 D CKP^GMTSUP
"RTN","GMTS1",45,0)
 Q
"RTN","GMTS1",46,0)
 ;
"RTN","GMTS1",47,0)
EXIT K ZTSK
"RTN","GMTS1",48,0)
 Q
"RTN","GMTS1",49,0)
 ;
"RTN","GMTS1",50,0)
SEGMNT ; OUTPUT A COMPONENT TYPE
"RTN","GMTS1",51,0)
 N GMTSLOCK,GMTSDBL,GMOOTXT,GMPXICDF,GMPXHLOC,GMPXNARR,GMPXCMOD,GMPXCM,GMTSWRIT,GMSEL
"RTN","GMTS1",52,0)
 I $D(GMTSQIT),(GMTSQIT]"") K GMTSQIT
"RTN","GMTS1",53,0)
 S X=^GMT(142.1,GMTSE,0),GMTSEGH=$S($P(X,U,4)]"":$P(X,U,4)_" - ",1:"")_$S($P(GMTSEG(GMTSEGN),U,5)]"":$P(GMTSEG(GMTSEGN),U,5),$P(X,U,9)]"":$P(X,U,9),1:" "_$P(X,U,1)),GMTSEGR=$P(X,"^",2) Q:GMTSEGR=""
"RTN","GMTS1",54,0)
 S GMTSLOCK=$P(X,U,7),GMTSDBL=$P(X,U,6),GMOOTXT=$P(X,U,8),GMPXCM=$P(X,U,14)
"RTN","GMTS1",55,0)
 S GMPXHLOC=$P(GMTSEG(GMTSEGN),U,6),GMPXNARR=$P(GMTSEG(GMTSEGN),U,8)
"RTN","GMTS1",56,0)
 S GMPXCMOD=$P(GMTSEG(GMTSEGN),U,9) S:GMPXCM'="Y" GMPXCMOD="N"
"RTN","GMTS1",57,0)
 S GMPXICDF=$P(GMTSEG(GMTSEGN),U,7)
"RTN","GMTS1",58,0)
 S GMTSNDM=$P(GMTSEG(GMTSEGN),U,3),GMTSDLM=$P(GMTSEG(GMTSEGN),U,4) S:GMTSNDM="" GMTSNDM=-1
"RTN","GMTS1",59,0)
 S:+$G(GMTSPX1)&+$G(GMTSPX2) GMTSDLM="" ;Allows date range for data
"RTN","GMTS1",60,0)
 S GMTSDLS=""
"RTN","GMTS1",61,0)
 I GMTSDLM?1N.N!(GMTSDLM?1N.N1"D") S GMTSDLS=+GMTSDLM_" day"
"RTN","GMTS1",62,0)
 S:GMTSDLM?1N.N1"W" GMTSDLS=+GMTSDLM_" week",GMTSDLM=+GMTSDLM*7
"RTN","GMTS1",63,0)
 S:GMTSDLM?1N.N1"M" GMTSDLS=+GMTSDLM_" month",GMTSDLM=+GMTSDLM*30.4
"RTN","GMTS1",64,0)
 S:GMTSDLM?1N.N1"Y" GMTSDLS=+GMTSDLM_" year",GMTSDLM=+GMTSDLM*365.25
"RTN","GMTS1",65,0)
 S GMTSDLM=+GMTSDLM
"RTN","GMTS1",66,0)
 S:+GMTSDLS>1 GMTSDLS=GMTSDLS_"s"
"RTN","GMTS1",67,0)
 S GMTSEGL="" I GMTSNDM>0!(GMTSDLM>0) S GMTSEGL=" (max "_$S(GMTSNDM>0:GMTSNDM_$S(GMTSNDM=1:" occurrence",1:" occurrences")_$S(GMTSDLM>0:" or ",1:""),1:"")_$S(GMTSDLM>0:GMTSDLS,1:"")_")"
"RTN","GMTS1",68,0)
 K GMTSDLS,GMTSN
"RTN","GMTS1",69,0)
 ; DBIA 10000 call NOW^%DTC
"RTN","GMTS1",70,0)
 D NOW^%DTC S GMTSDTC=%,DT=$P(%,".") K %,%H,%I
"RTN","GMTS1",71,0)
 I +$G(GMTSPX1)'>0!(+$G(GMTSPX2)'>0) D  ;Use date range unless variables empty
"RTN","GMTS1",72,0)
 . ; DBIA 10000 call C^%DTC
"RTN","GMTS1",73,0)
 . I GMTSDLM'>0 S (GMTS2,GMTSDLM)=9999999,GMTS1=6666666 ;GMTS1=MOST RECENT INVERTED DATE,GMTS2=TO DATE IN PAST IN INVERTED FORMAT
"RTN","GMTS1",74,0)
 . E  S X1=GMTSDTC,X2=-GMTSDLM D C^%DTC S GMTSDLM=9999999-X,GMTS2=GMTSDLM,GMTS1=9999999-(GMTSDTC+.0001) K X1,X2
"RTN","GMTS1",75,0)
 ; Set GMTSBEG to be GMTS2 uninverted
"RTN","GMTS1",76,0)
 S GMTSBEG=$S(GMTS2=9999999:1,1:9999999-GMTS2)
"RTN","GMTS1",77,0)
 ; Set GMTSEND to be GMTS1 uninverted
"RTN","GMTS1",78,0)
 S GMTSEND=$S(GMTS1=6666666:9999999,1:$P(9999999-GMTS1,".")_".235959")
"RTN","GMTS1",79,0)
 S GMTSWRIT=1 ;Variable is used to print component heading on 1st write
"RTN","GMTS1",80,0)
 I GMTSDBL]"",("PT"[GMTSDBL) D  Q
"RTN","GMTS1",81,0)
 . D:GMTSDBL="T" TDISBLD^GMTS2
"RTN","GMTS1",82,0)
 . D:GMTSDBL="P"&$D(GMTSPRM) PDISBLD^GMTS2
"RTN","GMTS1",83,0)
 ; DBIA 10076 access to ^XUSEC
"RTN","GMTS1",84,0)
 I GMTSLOCK]"",('$D(^XUSEC(GMTSLOCK,DUZ))) D NOMATCH^GMTS2 Q
"RTN","GMTS1",85,0)
 S GMSEL=$P($G(^GMT(142.1,GMTSE,1,1,0)),U)
"RTN","GMTS1",86,0)
 I GMSEL]"",$O(GMTSEG(GMTSEGN,GMSEL,0))'>0 D NOSELECT^GMTS2 Q
"RTN","GMTS1",87,0)
 S GMTSNPG=0
"RTN","GMTS1",88,0)
 D @($P(GMTSEGR,";",1)_U_$P(GMTSEGR,";",2))
"RTN","GMTS1",89,0)
 D NODATA^GMTS2
"RTN","GMTS1",90,0)
 K GMTSDLM
"RTN","GMTS1",91,0)
 Q
"RTN","GMTSADH1")
0^16^B14479938
"RTN","GMTSADH1",1,0)
GMTSADH1 ;SLC/JER,MAM - Ad Hoc Summary Driver ; 07/18/2000
"RTN","GMTSADH1",2,0)
 ;;2.7;Health Summary;**1,37**;Oct 20, 1995
"RTN","GMTSADH1",3,0)
 ;
"RTN","GMTSADH1",4,0)
GETLIM ; Drives acquisition of new time and occurrence limits, sel items,
"RTN","GMTSADH1",5,0)
 ; hospital loc display, ICD text display and Provider Narr display
"RTN","GMTSADH1",6,0)
 N LISTFLG,GMCHANGE,GMW,QUIT
"RTN","GMTSADH1",7,0)
 S GMCHANGE=0 D LIST
"RTN","GMTSADH1",8,0)
 F  S LISTFLG=0 D ASKCMPS Q:$D(QUIT)!$D(DIROUT)
"RTN","GMTSADH1",9,0)
 Q
"RTN","GMTSADH1",10,0)
LIST ; Lists defaults for ad hoc summary
"RTN","GMTSADH1",11,0)
 S LISTFLG=1,GMCHANGE=0
"RTN","GMTSADH1",12,0)
 W @IOF,!,"                      Default Limits and Selection Items",!!
"RTN","GMTSADH1",13,0)
 W "     Component              Occ    Time   Hosp  ICD  Prov  CPT  Selection",!
"RTN","GMTSADH1",14,0)
 W "                            Limit  Limit  Loc   Txt  Narr  Mod  Item(s)",!
"RTN","GMTSADH1",15,0)
 ;                              2      3      4     4    5     5    6
"RTN","GMTSADH1",16,0)
 ;  01234567890123456789012345678901234567890123456789012345678901234
"RTN","GMTSADH1",17,0)
 N FLG,DTOUT S FLG=0
"RTN","GMTSADH1",18,0)
LIST1 ; Called by GMTSUP to list components at help prompt
"RTN","GMTSADH1",19,0)
 ; GMTSUP sets FLG=1 for AD HOC HST, FLG=2 for other HST
"RTN","GMTSADH1",20,0)
 N GMI,DIR,DUOUT,GMW
"RTN","GMTSADH1",21,0)
 S DIR(0)="E"
"RTN","GMTSADH1",22,0)
 S GMI=0 F  S GMI=$O(GMTSEG(GMI)) Q:GMI'>0  D SCRNLNTH Q:$D(DUOUT)!($D(DTOUT))  D LISTLIM D:($D(GMTSEG(GMI))=11)&('FLG) LISTSEL Q:$D(DUOUT)!($D(DTOUT))
"RTN","GMTSADH1",23,0)
 Q
"RTN","GMTSADH1",24,0)
SCRNLNTH ; Checks screen length
"RTN","GMTSADH1",25,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH1",26,0)
 I $Y>(IOSL-4) W ! D ^DIR S:$D(DTOUT) DIROUT="" Q:$D(DUOUT)!($D(DTOUT))  W @IOF
"RTN","GMTSADH1",27,0)
 Q
"RTN","GMTSADH1",28,0)
LISTLIM ; Lists abbr, name, and, if not called by GMTSUP, limits for 
"RTN","GMTSADH1",29,0)
 ; particular component. Includes Hosp Loc, ICD Text, & Provider Narr.
"RTN","GMTSADH1",30,0)
 N CREC S CREC=^GMT(142.1,$P(GMTSEG(GMI),U,2),0) W ! I FLG=2 D STAR
"RTN","GMTSADH1",31,0)
 W $P(CREC,U,4),?5,$S($L($P(GMTSEG(GMI),U,5)):$P(GMTSEG(GMI),U,5),$L($P(CREC,U,9)):$P(CREC,U,9),1:$E($P(CREC,U),1,24))
"RTN","GMTSADH1",32,0)
 W:'FLG ?28,$P(GMTSEG(GMI),U,3),?35,$P(GMTSEG(GMI),U,4)
"RTN","GMTSADH1",33,0)
 W:'FLG ?42,$P(GMTSEG(GMI),U,6),?48,$E($P(GMTSEG(GMI),U,7),1,5)
"RTN","GMTSADH1",34,0)
 W:'FLG ?53,$P(GMTSEG(GMI),U,8),?59,$P(GMTSEG(GMI),U,9)
"RTN","GMTSADH1",35,0)
 Q
"RTN","GMTSADH1",36,0)
STAR ; Writes * to indicate added component when called by GMTSUP
"RTN","GMTSADH1",37,0)
 ; for HST other than AD HOC
"RTN","GMTSADH1",38,0)
 I $D(^GMT(142,+($G(GMTSTYP)),1,"C",$P(GMTSEG(GMI),U,2))) W " "
"RTN","GMTSADH1",39,0)
 E  W "*"
"RTN","GMTSADH1",40,0)
 Q
"RTN","GMTSADH1",41,0)
LISTSEL ; Lists default selection items for particular component
"RTN","GMTSADH1",42,0)
 N GMW,GMJ,GML
"RTN","GMTSADH1",43,0)
 S GMJ=$O(GMTSEG(GMI,0)),GML=0
"RTN","GMTSADH1",44,0)
 F GMW=1:1 S GML=$O(GMTSEG(GMI,GMJ,GML)) Q:GML=""  D SCRNLNTH Q:$D(DUOUT)!($D(DTOUT))  W:GMW'=1 ! W ?64,$E($P(@(GMTSEG(GMI,GMJ,0)_GMTSEG(GMI,GMJ,GML)_",0)"),U),1,15)
"RTN","GMTSADH1",45,0)
 Q
"RTN","GMTSADH1",46,0)
ASKCMPS ; Asks for components for new limits/sel items, or new components
"RTN","GMTSADH1",47,0)
 N GMI,GMW,GMX,ASKCPQIT,DIC,X,XQORM,Y
"RTN","GMTSADH1",48,0)
 I LISTFLG D
"RTN","GMTSADH1",49,0)
 . W !!,"To change limits, selection items, hospital location display, ICD"
"RTN","GMTSADH1",50,0)
 . W !,"text display, provider narrative display, or CPT Modifiers, enter "
"RTN","GMTSADH1",51,0)
 . W !,"components, one at a time or more than one, separated by commas."
"RTN","GMTSADH1",52,0)
 . W !,"You may select new components if you wish."
"RTN","GMTSADH1",53,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM("??")="D HELP^GMTSADH3"
"RTN","GMTSADH1",54,0)
 S XQORM(0)="A",XQORM("A")="Select COMPONENT(S) to EDIT or other COMPONENT(S) to ADD: "
"RTN","GMTSADH1",55,0)
 ; DBIA 10140 call EN^XQORM
"RTN","GMTSADH1",56,0)
 D EN^XQORM
"RTN","GMTSADH1",57,0)
 S:$D(DTOUT)!(X="^^") (DIROUT,QUIT)=1 I $D(DIROUT) Q
"RTN","GMTSADH1",58,0)
 I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G ASKCMPS
"RTN","GMTSADH1",59,0)
 I $S(X="^":1,X=""&(GMCHANGE=0):1,1:0) S QUIT="" Q
"RTN","GMTSADH1",60,0)
 I X="",GMCHANGE D ASKLIST Q
"RTN","GMTSADH1",61,0)
 I X["^" W "  ??" Q
"RTN","GMTSADH1",62,0)
 S GMCHANGE=1
"RTN","GMTSADH1",63,0)
 S GMI=0 F  S GMI=$O(Y(GMI)) Q:GMI=""  S GMX=^GMT(142,+GMTSTYP,1,+Y(GMI),0) W !!,$P(Y(GMI),U,3) D CMPCOND Q:$D(DUOUT)!($D(DIROUT))
"RTN","GMTSADH1",64,0)
 S:'$D(DIROUT) LISTFLG=1
"RTN","GMTSADH1",65,0)
 Q
"RTN","GMTSADH1",66,0)
CMPCOND ; Deals with particular component for new limits/sel items, or new comp
"RTN","GMTSADH1",67,0)
 N OLD,SBS,CREC,SREC,STRN,CPCDQIT
"RTN","GMTSADH1",68,0)
 S OLD=0 I $D(GMTSEGI($P(GMX,U,2))) S SBS=GMTSEGI($P(GMX,U,2)),OLD=1
"RTN","GMTSADH1",69,0)
 S CREC=^GMT(142.1,$P(GMX,U,2),0)
"RTN","GMTSADH1",70,0)
 I OLD=0 S GMTSEGC=GMTSEGC+1,SREC=GMX,STRN=+GMX D LOAD1^GMTSADH S SBS=GMJ
"RTN","GMTSADH1",71,0)
 D CMPLIM^GMTSADH2
"RTN","GMTSADH1",72,0)
 Q
"RTN","GMTSADH1",73,0)
ASKLIST ; Asks whether to relist Component Limits and Sel Items
"RTN","GMTSADH1",74,0)
 N DIR,X,Y
"RTN","GMTSADH1",75,0)
 S DIR(0)="YA",DIR("A")="Would you like to see Component Limits and Selection Items again?  (Y/N): ",DIR("B")="NO" W !
"RTN","GMTSADH1",76,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH1",77,0)
 D ^DIR
"RTN","GMTSADH1",78,0)
 I Y'>0,(GMCHANGE=1) S QUIT=1 Q
"RTN","GMTSADH1",79,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH1",80,0)
 I $D(DIRUT),'$D(DUOUT) W "  ??"
"RTN","GMTSADH1",81,0)
 I $D(DIRUT)!(Y=0) Q
"RTN","GMTSADH1",82,0)
 D LIST
"RTN","GMTSADH1",83,0)
 Q
"RTN","GMTSADH2")
0^17^B23089017
"RTN","GMTSADH2",1,0)
GMTSADH2 ;SLC/JER,MAM - Ad Hoc Summary Driver ; 07/18/2000
"RTN","GMTSADH2",2,0)
 ;;2.7;Health Summary;**12,37**;Oct 20, 1995
"RTN","GMTSADH2",3,0)
 ;
"RTN","GMTSADH2",4,0)
CMPLIM ; Gets limits and sel items for particular component, if applicable
"RTN","GMTSADH2",5,0)
 N GMTSFUNC
"RTN","GMTSADH2",6,0)
 I $P(CREC,U,5)="Y" D GETOCC^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",7,0)
 I $P(CREC,U,3)="Y" D GETIME^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",8,0)
 I $P(CREC,U,10)="Y" D GETHOSP^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",9,0)
 I $P(CREC,U,11)="Y" D GETICD^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",10,0)
 I $P(CREC,U,12)="Y" D GETPROV^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",11,0)
 I $P(CREC,U,14)="Y" D GETCPTM^GMTSADH4 I $D(DIROUT)!($D(DUOUT)) Q
"RTN","GMTSADH2",12,0)
 D GETNAME^GMTSADH4 I $D(DIROUT)!$D(DUOUT) Q
"RTN","GMTSADH2",13,0)
 N SEL I $D(^GMT(142.1,$P(GMTSEG(SBS),U,2),1,1,0)) S SEL=$P(^(0),U,1) I SEL D SELECT
"RTN","GMTSADH2",14,0)
 Q
"RTN","GMTSADH2",15,0)
SELECT ; Gets Selection Items, where applicable
"RTN","GMTSADH2",16,0)
 N GMTSF,GMTSJ,GETSLQIT,GMI,DIC,X,Y,TEMP,SELCNT
"RTN","GMTSADH2",17,0)
 S GMTSJ=$O(GMTSEG(SBS,0)),GMTSF=1
"RTN","GMTSADH2",18,0)
 I GMTSJ W !,"Default selection items are   " D SHOWDEF
"RTN","GMTSADH2",19,0)
 S SELCNT=$P(^GMT(142.1,$P(GMTSEG(SBS),U,2),1,1,0),U,2)
"RTN","GMTSADH2",20,0)
 W ! W:GMTSJ "Push Return at the first prompt to select default items.",!
"RTN","GMTSADH2",21,0)
 W "Select new "_$$FNAM^GMTSU(+SEL)_" items one at a time in the sequence",!,"you want them displayed. "
"RTN","GMTSADH2",22,0)
 W "You may select " I SELCNT="" W "any number of items.",!
"RTN","GMTSADH2",23,0)
 E  W "up to ",SELCNT," items.",!
"RTN","GMTSADH2",24,0)
 F GMI=1:1 D GETSEL Q:$D(DIROUT)!(Y=-1)!$S(+SELCNT:(GMI'<+SELCNT),1:0)
"RTN","GMTSADH2",25,0)
 I +SELCNT,(GMI'<+SELCNT) W !?2,$C(7),"MAXIMUM # OF ITEMS SELECTED.",!
"RTN","GMTSADH2",26,0)
 Q
"RTN","GMTSADH2",27,0)
GETSEL ;updates GMTSEG array with selections
"RTN","GMTSADH2",28,0)
 ;Using read so that can do special processing when entering a "?".
"RTN","GMTSADH2",29,0)
 I SEL=8925.1 W !,"Select TITLE: "
"RTN","GMTSADH2",30,0)
 E  W !,"Select "_$$FNAM^GMTSU(+SEL)_" Selection Item: "
"RTN","GMTSADH2",31,0)
 R X:DTIME
"RTN","GMTSADH2",32,0)
 I X="^^" S Y=0,DIROUT=1 Q
"RTN","GMTSADH2",33,0)
 I X="^" S Y=-1,(GETSLQIT,ASKCPQIT)="" Q
"RTN","GMTSADH2",34,0)
 I X["?" W:$O(GMTSEG(SBS,0)) !!,"Current Selection items are   " D SHOWDEF
"RTN","GMTSADH2",35,0)
 S DIC(0)="EMQ",DIC=$$FLOC^GMTSU(+SEL)
"RTN","GMTSADH2",36,0)
 I SEL=60 S DIC("S")="I $P(^(0),U,4)=""CH"",""BO""[$P(^(0),U,3)"
"RTN","GMTSADH2",37,0)
 I SEL=9999999.64 S DIC("S")="I $P(^(0),U,10)=""C"",+$P(^(0),U,11)'=1"
"RTN","GMTSADH2",38,0)
 I SEL=811.9 S DIC("S")="I +$P(^(0),U,6)'=1"
"RTN","GMTSADH2",39,0)
 I SEL=8925.1 S DIC("S")="I $P(^TIU(8925.1,+Y,0),U,4)=""DOC"",+$$ISA^TIULX(+Y,3)"
"RTN","GMTSADH2",40,0)
 D ^DIC
"RTN","GMTSADH2",41,0)
 I $D(DTOUT) S DIROUT=1
"RTN","GMTSADH2",42,0)
 I $D(DIROUT) Q
"RTN","GMTSADH2",43,0)
 I $D(DUOUT) S (GETSLQIT,ASKCPQIT)="" Q
"RTN","GMTSADH2",44,0)
 I X["?" S Y="",GMI=GMI-1 Q
"RTN","GMTSADH2",45,0)
 I X]"",Y=-1 S Y=0,GMI=GMI-1 Q  ;Continue selecting items when incorrect item entered
"RTN","GMTSADH2",46,0)
 Q:Y=-1
"RTN","GMTSADH2",47,0)
 I GMTSF&(X'="") K GMTSEG(SBS,SEL) S GMTSF=0,GMTSEG(SBS,SEL,0)=DIC
"RTN","GMTSADH2",48,0)
 ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH2",49,0)
 I DIC="^LAB(60,",'$L($P(^LAB(60,+Y,0),U,5)) D RESOLVE(+Y,.GMTSEG,.GMI) Q
"RTN","GMTSADH2",50,0)
 S GMTSEG(SBS,SEL,GMI)=+Y
"RTN","GMTSADH2",51,0)
 Q
"RTN","GMTSADH2",52,0)
SHOWDEF ; Writes out loaded (default) selection items
"RTN","GMTSADH2",53,0)
 N GMTSN,GMTSWHL
"RTN","GMTSADH2",54,0)
 I $G(GMTSJ)']"" S GMTSJ=$O(GMTSEG(SBS,0)) I GMTSJ']"" W !!,"No SELECTION ITEMS chosen.",! Q
"RTN","GMTSADH2",55,0)
 S GMTSN=0 F GMTSWHL=1:1 S GMTSN=$O(GMTSEG(SBS,+GMTSJ,GMTSN)) Q:GMTSN=""  W:GMTSWHL>1 ! W ?30,$P(@(GMTSEG(SBS,GMTSJ,0)_GMTSEG(SBS,GMTSJ,GMTSN)_",0)"),U)
"RTN","GMTSADH2",56,0)
 Q
"RTN","GMTSADH2",57,0)
RESOLVE(GMREF,GMTSEG,GMI) ; Call ORUS to resolve compound items
"RTN","GMTSADH2",58,0)
 N SELCT,GMJ,GMHEAD,X,Y
"RTN","GMTSADH2",59,0)
 ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",60,0)
 K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW")
"RTN","GMTSADH2",61,0)
 S GMI=GMI-1 ;This subroutine will increment GMI if any item are picked
"RTN","GMTSADH2",62,0)
 ;            Need to decrement by one so it works right
"RTN","GMTSADH2",63,0)
 I +$G(SELCNT) S SELCT=SELCNT-GMI ;Don't exceed allowed # of selection
"RTN","GMTSADH2",64,0)
 ; items. Needed if other items were selected before starting this call.
"RTN","GMTSADH2",65,0)
 ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH2",66,0)
 S GMHEAD="-- "_$P($G(^LAB(60,+GMREF,.1)),U)_" --"
"RTN","GMTSADH2",67,0)
 ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",68,0)
 S ^XUTL("OR",$J,"GMTS",0)="LAB TEST^1^^0" D COMPILE(+GMREF)
"RTN","GMTSADH2",69,0)
 ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",70,0)
 I $P(^XUTL("OR",$J,"GMTS",0),U,4)'>0 D  Q
"RTN","GMTSADH2",71,0)
 . ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",72,0)
 . K ^XUTL("OR",$J,"GMTS")
"RTN","GMTSADH2",73,0)
 . W $C(7),"  INVALID TEST...Please choose another." ;S GMI=GMI-1
"RTN","GMTSADH2",74,0)
 ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",75,0)
 S ORUS="^XUTL(""OR"","_$J_",""GMTS"",",ORUS(0)="40MN"_$S(+$G(SELCT):U_$S($P(^XUTL("OR",$J,"GMTS",0),U,4)'<SELCT:SELCT,1:$P(^XUTL("OR",$J,"GMTS",0),U,4)),1:""),ORUS("T")="D HEADER^GMTSADH2"
"RTN","GMTSADH2",76,0)
 S ORUS("A")="Select"_$S(+$P(ORUS(0),U,2):" 1 - "_+$P(ORUS(0),U,2),1:"")_" LAB TEST(s): "
"RTN","GMTSADH2",77,0)
 S ORUS("B")=$S(+$P(ORUS(0),U,2):"1-"_+$P(ORUS(0),U,2),1:"ALL")
"RTN","GMTSADH2",78,0)
 ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",79,0)
 D EN^ORUS K ^XUTL("OR",$J,"GMTS"),^("ORU"),^("ORV"),^("ORW")
"RTN","GMTSADH2",80,0)
 Q:+Y'>0
"RTN","GMTSADH2",81,0)
 S GMJ=0
"RTN","GMTSADH2",82,0)
 F  S GMJ=$O(Y(GMJ)) Q:GMJ'>0  D  ;Q:+SELCNT&(GMI'<+SELCNT)
"RTN","GMTSADH2",83,0)
 . S GMI=GMI+1
"RTN","GMTSADH2",84,0)
 . S GMTSEG(SBS,SEL,GMI)=+Y(GMJ)
"RTN","GMTSADH2",85,0)
 Q
"RTN","GMTSADH2",86,0)
COMPILE(GMTEST) ; Compile menu for ORUS call
"RTN","GMTSADH2",87,0)
 N GMC,GMI,GMJ,GMROOT
"RTN","GMTSADH2",88,0)
 ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH2",89,0)
 S GMI=0 F  S GMI=$O(^LAB(60,GMTEST,2,GMI)) Q:GMI'>0  D
"RTN","GMTSADH2",90,0)
 . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH2",91,0)
 . S GMJ=+$G(^LAB(60,GMTEST,2,+GMI,0))
"RTN","GMTSADH2",92,0)
 . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH2",93,0)
 . S GMROOT=$G(^LAB(60,+GMJ,0))
"RTN","GMTSADH2",94,0)
 . I $L($P(GMROOT,U,5)),("BO"[$P(GMROOT,U,3)) D
"RTN","GMTSADH2",95,0)
 . . ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",96,0)
 . . S GMC=+$P($G(^XUTL("OR",$J,"GMTS",0)),U,4)+1
"RTN","GMTSADH2",97,0)
 . . ; DBIA 2160 access ^XUTL("OR",$J)
"RTN","GMTSADH2",98,0)
 . . S ^XUTL("OR",$J,"GMTS",GMJ,0)=$P(GMROOT,U),$P(^XUTL("OR",$J,"GMTS",0),U,4)=GMC
"RTN","GMTSADH2",99,0)
 . E  D
"RTN","GMTSADH2",100,0)
 . . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH2",101,0)
 . . D COMPILE(+$G(^LAB(60,GMTEST,2,GMI,0)))
"RTN","GMTSADH2",102,0)
 Q
"RTN","GMTSADH2",103,0)
HEADER ; Write Header
"RTN","GMTSADH2",104,0)
 W !!?15,"Select the tests which you wish to include, in the",!?19,"sequence in which you wish them to appear."
"RTN","GMTSADH2",105,0)
 W !!?((80-$L(GMHEAD))\2),GMHEAD,!
"RTN","GMTSADH2",106,0)
 Q
"RTN","GMTSADH4")
0^18^B6003157
"RTN","GMTSADH4",1,0)
GMTSADH4 ; SLC/SBW - Ad Hoc Summary Driver (Cont)      ; 07/18/2000
"RTN","GMTSADH4",2,0)
 ;;2.7;Health Summary;*37*;Oct 20, 1995
"RTN","GMTSADH4",3,0)
 ;
"RTN","GMTSADH4",4,0)
GETOCC ; Gets Occurrence Limit, where applicable
"RTN","GMTSADH4",5,0)
 N DIR,X,Y
"RTN","GMTSADH4",6,0)
 S DIR(0)="142.01,2O",DIR("A")="OCCURRENCE LIMIT",DIR("B")=$P(GMTSEG(SBS),U,3)
"RTN","GMTSADH4",7,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH4",8,0)
 D ^DIR
"RTN","GMTSADH4",9,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH4",10,0)
 I $D(DUOUT) Q
"RTN","GMTSADH4",11,0)
 I X["^" W "  ??" G GETOCC
"RTN","GMTSADH4",12,0)
 S $P(GMTSEG(SBS),U,3)=Y
"RTN","GMTSADH4",13,0)
 Q
"RTN","GMTSADH4",14,0)
GETIME ; Gets Time Limit, where applicable
"RTN","GMTSADH4",15,0)
 N DIR,X,Y
"RTN","GMTSADH4",16,0)
 S DIR(0)="142.01,3O",DIR("A")="TIME LIMIT",DIR("B")=$P(GMTSEG(SBS),U,4)
"RTN","GMTSADH4",17,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH4",18,0)
 D ^DIR
"RTN","GMTSADH4",19,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH4",20,0)
 I $D(DUOUT) Q
"RTN","GMTSADH4",21,0)
 I X["^" W "  ??" G GETIME
"RTN","GMTSADH4",22,0)
 S $P(GMTSEG(SBS),U,4)=Y
"RTN","GMTSADH4",23,0)
 Q
"RTN","GMTSADH4",24,0)
GETNAME ; Gets Header Name for Component
"RTN","GMTSADH4",25,0)
 N DIR,X,Y
"RTN","GMTSADH4",26,0)
 S DIR(0)="142.01,5O" S:$L($P(GMTSEG(SBS),U,5)) DIR("B")=$P(GMTSEG(SBS),U,5)
"RTN","GMTSADH4",27,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH4",28,0)
 D ^DIR
"RTN","GMTSADH4",29,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH4",30,0)
 I $D(DUOUT) Q
"RTN","GMTSADH4",31,0)
 I X["^" W "  ??" G GETIME
"RTN","GMTSADH4",32,0)
 S $P(GMTSEG(SBS),U,5)=Y
"RTN","GMTSADH4",33,0)
 Q
"RTN","GMTSADH4",34,0)
GETHOSP ; Gets Hospital Location displayed, where applicable
"RTN","GMTSADH4",35,0)
 N DIR,X,Y
"RTN","GMTSADH4",36,0)
 S DIR(0)="142.01,6O",DIR("A")="Hospital Location displayed",DIR("B")=$P(GMTSEG(SBS),U,6)
"RTN","GMTSADH4",37,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH4",38,0)
 D ^DIR
"RTN","GMTSADH4",39,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH4",40,0)
 I $D(DUOUT) Q
"RTN","GMTSADH4",41,0)
 I X["^" W "  ??" G GETHOSP
"RTN","GMTSADH4",42,0)
 S $P(GMTSEG(SBS),U,6)=Y
"RTN","GMTSADH4",43,0)
 Q
"RTN","GMTSADH4",44,0)
GETICD ; Gets ICD Text displayed, where applicable
"RTN","GMTSADH4",45,0)
 N DIR,X,Y
"RTN","GMTSADH4",46,0)
 S DIR(0)="142.01,7O",DIR("A")="ICD Text displayed",DIR("B")=$P(GMTSEG(SBS),U,7)
"RTN","GMTSADH4",47,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH4",48,0)
 D ^DIR
"RTN","GMTSADH4",49,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH4",50,0)
 I $D(DUOUT) Q
"RTN","GMTSADH4",51,0)
 I X["^" W "  ??" G GETICD
"RTN","GMTSADH4",52,0)
 S $P(GMTSEG(SBS),U,7)=Y
"RTN","GMTSADH4",53,0)
 Q
"RTN","GMTSADH4",54,0)
GETPROV ; Gets Provider Narrative displayed, where applicable
"RTN","GMTSADH4",55,0)
 N DIR,X,Y
"RTN","GMTSADH4",56,0)
 S DIR(0)="142.01,8O",DIR("A")="Provider Narrative displayed",DIR("B")=$P(GMTSEG(SBS),U,8)
"RTN","GMTSADH4",57,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH4",58,0)
 D ^DIR
"RTN","GMTSADH4",59,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH4",60,0)
 I $D(DUOUT) Q
"RTN","GMTSADH4",61,0)
 I X["^" W "  ??" G GETPROV
"RTN","GMTSADH4",62,0)
 S $P(GMTSEG(SBS),U,8)=Y
"RTN","GMTSADH4",63,0)
 Q
"RTN","GMTSADH4",64,0)
GETCPTM ; Gets CPT Modifier displayed, where applicable
"RTN","GMTSADH4",65,0)
 N DIR,X,Y
"RTN","GMTSADH4",66,0)
 S DIR(0)="142.01,9O",DIR("A")="CPT Modifier displayed",DIR("B")=$P(GMTSEG(SBS),U,8) S:DIR("B")="" DIR("B")="Y"
"RTN","GMTSADH4",67,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSADH4",68,0)
 D ^DIR
"RTN","GMTSADH4",69,0)
 S:$D(DTOUT) DIROUT=1 I $D(DIROUT) Q
"RTN","GMTSADH4",70,0)
 I $D(DUOUT) Q
"RTN","GMTSADH4",71,0)
 I X["^" W "  ??" G GETCPTM
"RTN","GMTSADH4",72,0)
 S $P(GMTSEG(SBS),U,9)=Y
"RTN","GMTSADH4",73,0)
 Q
"RTN","GMTSADH5")
0^19^B36851550
"RTN","GMTSADH5",1,0)
GMTSADH5 ; DCM/SLC - Health Summary Ad Hoc RPC's ; 07/18/2000
"RTN","GMTSADH5",2,0)
 ;;2.7;Health Summary;**36,35,37**;Oct 20, 1995
"RTN","GMTSADH5",3,0)
 ;                     
"RTN","GMTSADH5",4,0)
COMP(Y) ; Get ADHOC sub components (FILE 142.1)
"RTN","GMTSADH5",5,0)
 ;
"RTN","GMTSADH5",6,0)
 ;  Y(i)=(1)I;IFN^(2)Component Name [Abb]^(3)Occ Limit^
"RTN","GMTSADH5",7,0)
 ;       (4)Time Limit^(5)Header Name^(6)Hosp Loc Disp^
"RTN","GMTSADH5",8,0)
 ;       (7)ICD Text Disp^(8)Prov Narr Disp^
"RTN","GMTSADH5",9,0)
 ;       (9)CPT Modifier Disp^(10)Summary Order
"RTN","GMTSADH5",10,0)
 ;
"RTN","GMTSADH5",11,0)
 N GMTSI,GMTSII,GMTSIFN,GMTSC,X,X1
"RTN","GMTSADH5",12,0)
 S Y(1)=$O(^GMT(142,"B","GMTS HS ADHOC OPTION",0))
"RTN","GMTSADH5",13,0)
 I 'Y(1) S Y(1)=-1 Q  ; Error, no ADHOC type defined
"RTN","GMTSADH5",14,0)
 S (GMTSC,GMTSI)=0,GMTSII=Y(1)
"RTN","GMTSADH5",15,0)
 F  S GMTSI=$O(^GMT(142,GMTSII,1,GMTSI)) Q:'GMTSI  S X=^(GMTSI,0) D
"RTN","GMTSADH5",16,0)
 . S GMTSIFN=$P(X,"^",2),X1=$G(^GMT(142.1,+GMTSIFN,0))
"RTN","GMTSADH5",17,0)
 . Q:'$L(X1)  Q:$P(X1,"^",6)="P"  S GMTSC=GMTSC+1
"RTN","GMTSADH5",18,0)
 . S Y(GMTSC)=GMTSI_";"_GMTSIFN
"RTN","GMTSADH5",19,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$P(X1,"^")_" ["_$P(X1,"^",4)_"]"
"RTN","GMTSADH5",20,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$S($P(X1,"^",5)="Y":$P(X,"^",3),1:"")
"RTN","GMTSADH5",21,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$S($P(X1,"^",3)="Y":$P(X,"^",4),1:"")
"RTN","GMTSADH5",22,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$S($L($P(X1,"^",9)):$P(X1,"^",9),1:$P(X,"^",5))
"RTN","GMTSADH5",23,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$S($P(X1,"^",10)="Y":$P(X,"^",6),1:"")
"RTN","GMTSADH5",24,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$S($P(X1,"^",11)="Y":$P(X,"^",7),1:"")
"RTN","GMTSADH5",25,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$S($P(X1,"^",12)="Y":$P(X,"^",8),1:"")
"RTN","GMTSADH5",26,0)
 . S Y(GMTSC)=Y(GMTSC)_"^"_$P(X,"^")
"RTN","GMTSADH5",27,0)
 Q
"RTN","GMTSADH5",28,0)
 ;
"RTN","GMTSADH5",29,0)
COMPSUB(Y,GMTSUB) ; Get subcomponents from a predefined ADHOC component
"RTN","GMTSADH5",30,0)
 ; GMTSUB=desired Adhoc subcomponent
"RTN","GMTSADH5",31,0)
 ; Y(i)=ifn of pointed to file entry^name
"RTN","GMTSADH5",32,0)
 Q:'$G(GMTSUB)
"RTN","GMTSADH5",33,0)
 N GMTSI,GMTSII,GMTSIFN,GMTSC,X,X1
"RTN","GMTSADH5",34,0)
 S X=$O(^GMT(142,"B","GMTS HS ADHOC OPTION",0))
"RTN","GMTSADH5",35,0)
 I 'X Q  ; Error, no ADHOC type defined
"RTN","GMTSADH5",36,0)
 S (GMTSC,GMTSI)=0,GMTSII=X
"RTN","GMTSADH5",37,0)
 F  S GMTSI=$O(^GMT(142,GMTSII,1,GMTSUB,1,GMTSI)) Q:'GMTSI  S X=^(GMTSI,0) D
"RTN","GMTSADH5",38,0)
 . S GMTSIFN=+X,X1=$P(X,";",2)
"RTN","GMTSADH5",39,0)
 . I '$D(@("^"_X1_+X_",0)")) Q
"RTN","GMTSADH5",40,0)
 . S X=@("^"_X1_+X_",0)"),GMTSC=GMTSC+1,Y(GMTSC)=GMTSIFN_"^"_$P(X,"^")
"RTN","GMTSADH5",41,0)
 Q
"RTN","GMTSADH5",42,0)
 ;                 
"RTN","GMTSADH5",43,0)
FILES(Y,GMTSCP)   ; Get Files to select from for a component
"RTN","GMTSADH5",44,0)
 Q:'$G(GMTSCP)  Q:'$D(^GMT(142.1,GMTSCP,1))  N GMTSI,GMTSC,X S (GMTSI,GMTSC)=0
"RTN","GMTSADH5",45,0)
 F  S GMTSI=$O(^GMT(142.1,GMTSCP,1,GMTSI)) Q:'GMTSI  S X=^(GMTSI,0),GMTSC=GMTSC+1,Y(GMTSC)=GMTSI_"^"_$$FNAM^GMTSU(+X)_"^"_X
"RTN","GMTSADH5",46,0)
 Q
"RTN","GMTSADH5",47,0)
 ;                     
"RTN","GMTSADH5",48,0)
FILESEL(GMTSRT,GMTSFI,GMTSFM,DIR) ; Get file entries
"RTN","GMTSADH5",49,0)
 Q:'$G(GMTSFI)
"RTN","GMTSADH5",50,0)
 K ^TMP("ORDATA",$J)
"RTN","GMTSADH5",51,0)
 N GMTSI,GMTSJ,GMTSC,X,GMTSGL,GMTSGLB,GMTSCNT
"RTN","GMTSADH5",52,0)
 S GMTSI=$G(GMTSFM),GMTSCNT=44,GMTSC=0,GMTSRT=$NA(^TMP("ORDATA",$J,1))
"RTN","GMTSADH5",53,0)
 S:'$D(DIR) DIR=1
"RTN","GMTSADH5",54,0)
 I GMTSFI=60 D  Q
"RTN","GMTSADH5",55,0)
 . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH5",56,0)
 . F  Q:GMTSC'<GMTSCNT  S GMTSI=$O(^LAB(60,"B",GMTSI),DIR) Q:GMTSI=""  S GMTSJ=0 F  S GMTSJ=$O(^LAB(60,"B",GMTSI,GMTSJ)) Q:'GMTSJ  D
"RTN","GMTSADH5",57,0)
 . . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH5",58,0)
 . . I $D(^LAB(60,GMTSJ,0)) S X=^(0) I $P(X,"^",4)="CH","BO"[$P(X,"^",3) S GMTSC=GMTSC+1,^TMP("ORDATA",$J,1,GMTSC)=GMTSJ_"^"_GMTSI
"RTN","GMTSADH5",59,0)
 I GMTSFI=9999999.64 D  Q
"RTN","GMTSADH5",60,0)
 . ; DBIA 1989 access ^AUTTHF (file 9999999.64)
"RTN","GMTSADH5",61,0)
 . F  Q:GMTSC'<GMTSCNT  S GMTSI=$O(^AUTTHF("B",GMTSI),DIR) Q:GMTSI=""  S GMTSJ=0 F  S GMTSJ=$O(^AUTTHF("B",GMTSI,GMTSJ)) Q:'GMTSJ  I $D(^AUTTHF(GMTSJ,0)) S X=^(0) D
"RTN","GMTSADH5",62,0)
 . . I $P(X,"^",10)="C",+$P(X,"^",11)'=1 S GMTSC=GMTSC+1,^TMP("ORDATA",$J,1,GMTSC)=GMTSJ_"^"_GMTSI
"RTN","GMTSADH5",63,0)
 I GMTSFI=811.9 D  Q
"RTN","GMTSADH5",64,0)
 . ; DBIA 1256 access ^PXD (file 811.9)
"RTN","GMTSADH5",65,0)
 . F  Q:GMTSC'<GMTSCNT  S GMTSI=$O(^PXD(811.9,"B",GMTSI),DIR) Q:GMTSI=""  S GMTSJ=0 F  S GMTSJ=$O(^PXD(811.9,"B",GMTSI,GMTSJ)) Q:'GMTSJ  I $D(^PXD(811.9,GMTSJ,0)) S X=^(0) D
"RTN","GMTSADH5",66,0)
 . . I $P(X,"^",6)'=1 S GMTSC=GMTSC+1,^TMP("ORDATA",$J,1,GMTSC)=GMTSJ_"^"_GMTSI
"RTN","GMTSADH5",67,0)
 I GMTSFI=8925.1 D  Q
"RTN","GMTSADH5",68,0)
 . ; DBIA 3059 access ^TIU (file 8925.1)
"RTN","GMTSADH5",69,0)
 . F  Q:GMTSC'<GMTSCNT  S GMTSI=$O(^TIU(8925.1,"B",GMTSI),DIR) Q:GMTSI=""  S GMTSJ=0 F  S GMTSJ=$O(^TIU(8925.1,"B",GMTSI,GMTSJ)) Q:'GMTSJ  I $D(^TIU(8925.1,GMTSJ,0)) S X=^(0) D
"RTN","GMTSADH5",70,0)
 . . ; DBIA 3058 call $$ISA^TIULX
"RTN","GMTSADH5",71,0)
 . . I $P(X,"^",4)="DOC",$$ISA^TIULX(GMTSJ,3) S GMTSC=GMTSC+1,^TMP("ORDATA",$J,1,GMTSC)=GMTSJ_"^"_GMTSI
"RTN","GMTSADH5",72,0)
 ;I GMTSFI=81 D  Q
"RTN","GMTSADH5",73,0)
 ;. F  Q:GMTSC'<GMTSCNT  S GMTSI=$O(^ICPT("C",GMTSI),DIR) Q:GMTSI=""  S GMTSJ=0 F  S GMTSJ=$O(^ICPT("C",GMTSI,GMTSJ)) Q:'GMTSJ   I $D(^ICPT(GMTSJ,0)) S X=^(0) D
"RTN","GMTSADH5",74,0)
 ;. . S GMTSC=GMTSC+1,^TMP("ORDATA",$J,1,GMTSC)=GMTSJ_"^"_$P(X,"^",2)_" ["_$P(X,"^")_"]"
"RTN","GMTSADH5",75,0)
 S GMTSGL=$$FCLR^GMTSU(+GMTSFI) I $L(GMTSGL) S GMTSGLB=$$FLOC^GMTSU(+GMTSFI)_"""B"")" D
"RTN","GMTSADH5",76,0)
 . F  Q:GMTSC'<GMTSCNT  S GMTSI=$O(@GMTSGLB@(GMTSI),DIR) Q:GMTSI=""  S GMTSJ=0 F  S GMTSJ=$O(@GMTSGLB@(GMTSI,GMTSJ)) Q:'GMTSJ  I $D(@GMTSGL@(GMTSJ,0)) S X=^(0) D
"RTN","GMTSADH5",77,0)
 . . S GMTSC=GMTSC+1,^TMP("ORDATA",$J,1,GMTSC)=GMTSJ_"^"_GMTSI
"RTN","GMTSADH5",78,0)
 Q
"RTN","GMTSADH5",79,0)
 ;                     
"RTN","GMTSADH5",80,0)
REPORT(GMTSEG,GMTSEGC,GMTSEGI,GMTSCPS,DFN) ; Build Report
"RTN","GMTSADH5",81,0)
 ; Uses array of Components passed in GMTSCPS()
"RTN","GMTSADH5",82,0)
 ;   GMTSCPS(i)=array of subcomponents chosen,
"RTN","GMTSADH5",83,0)
 ;   value is pointer at ^GMT(142,DA(1),1,DA)
"RTN","GMTSADH5",84,0)
 Q:'$G(DFN)
"RTN","GMTSADH5",85,0)
 N GMTSCNT,DIC,DIZ,DIW,DIWI,DIWT,DIWTC,X,GMTSI,GMTSJ,GMTSK,GMTSTYP,GMTSTITL
"RTN","GMTSADH5",86,0)
 S X="GMTS HS ADHOC",DIC=142,DIZ(0)="ZF"
"RTN","GMTSADH5",87,0)
 ; DBIA 10006 call ^DIC
"RTN","GMTSADH5",88,0)
 D ^DIC Q:'Y
"RTN","GMTSADH5",89,0)
 S GMTSTYP=+Y,GMTSTITL="AD HOC",(GMTSJ,GMTSI)=0,GMTSEGC=$O(GMTSCPS(99999999),-1)
"RTN","GMTSADH5",90,0)
 F  S GMTSI=$O(GMTSCPS(GMTSI)) Q:'GMTSI  D
"RTN","GMTSADH5",91,0)
 . N GMTSREC,GMTSS2,GMTSSJ,GMTSEL
"RTN","GMTSADH5",92,0)
 . S GMTSREC=^GMT(142,GMTSTYP,1,+GMTSCPS(GMTSI),0),GMTSJ=GMTSJ+1
"RTN","GMTSADH5",93,0)
 . S GMTSEG(GMTSJ)=GMTSREC,GMTSEGI($P(GMTSREC,U,2))=GMTSJ,GMTSS2=0,GMTSSJ=GMTSJ
"RTN","GMTSADH5",94,0)
 . S $P(GMTSEG(GMTSJ),"^",3)=$P(GMTSCPS(GMTSI),"^",2)
"RTN","GMTSADH5",95,0)
 . S $P(GMTSEG(GMTSJ),"^",4)=$P(GMTSCPS(GMTSI),"^",3)
"RTN","GMTSADH5",96,0)
 . I $L($P(GMTSCPS(GMTSI),"^",4)) S $P(GMTSEG(GMTSJ),"^",5)=$P(GMTSCPS(GMTSI),"^",4)
"RTN","GMTSADH5",97,0)
 . I $L($P(GMTSCPS(GMTSI),"^",5)) S $P(GMTSEG(GMTSJ),"^",6)=$P(GMTSCPS(GMTSI),"^",5)
"RTN","GMTSADH5",98,0)
 . S $P(GMTSEG(GMTSJ),"^",7)=$P(GMTSCPS(GMTSI),"^",6)
"RTN","GMTSADH5",99,0)
 . I $L($P(GMTSCPS(GMTSI),"^",7)) S $P(GMTSEG(GMTSJ),"^",8)=$P(GMTSCPS(GMTSI),"^",7)
"RTN","GMTSADH5",100,0)
 . S (GMTSCNT,GMTSK)=0
"RTN","GMTSADH5",101,0)
 . F  S GMTSK=$O(GMTSCPS(GMTSK)) Q:'GMTSK  I +GMTSCPS(GMTSI)=+GMTSCPS(GMTSK),$P(GMTSCPS(GMTSK),"^",9),$P(GMTSCPS(GMTSK),"^",10) D
"RTN","GMTSADH5",102,0)
 . . S GMTSCNT=GMTSCNT+1
"RTN","GMTSADH5",103,0)
 . . ; DBIA 2052 call $$GET1^DID
"RTN","GMTSADH5",104,0)
 . . S:'$D(GMTSEG(GMTSJ,$P(GMTSCPS(GMTSK),"^",9),0)) GMTSEG(GMTSJ,$P(GMTSCPS(GMTSK),"^",9),0)=$$GET1^DID($P(GMTSCPS(GMTSK),"^",9),,,"GLOBAL NAME")
"RTN","GMTSADH5",105,0)
 . . S GMTSEG(GMTSJ,$P(GMTSCPS(GMTSK),"^",9),GMTSCNT)=$P(GMTSCPS(GMTSK),"^",10)
"RTN","GMTSADH5",106,0)
 . . K GMTSCPS(GMTSK)
"RTN","GMTSADH5",107,0)
 Q
"RTN","GMTSADH5",108,0)
 ;                     
"RTN","GMTSADH5",109,0)
SUBITEM(Y,GMTSTEST) ; Get Subitems for a Test Panel
"RTN","GMTSADH5",110,0)
 Q:'$G(GMTSTEST)  N GMTSCNT S GMTSCNT=0
"RTN","GMTSADH5",111,0)
 ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH5",112,0)
 I '$L($P(^LAB(60,GMTSTEST,0),"^",5)),$O(^LAB(60,GMTSTEST,2,0)) D COMPILE(GMTSTEST,GMTSCNT)
"RTN","GMTSADH5",113,0)
 Q
"RTN","GMTSADH5",114,0)
 ;                     
"RTN","GMTSADH5",115,0)
COMPILE(GMTSTEST,GMTSCNT) ; Expand lab panels
"RTN","GMTSADH5",116,0)
 N GMTSI,GMTSJ,GMTSRT S GMTSI=0
"RTN","GMTSADH5",117,0)
 ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH5",118,0)
 F  S GMTSI=$O(^LAB(60,GMTSTEST,2,GMTSI)) Q:GMTSI'>0  D
"RTN","GMTSADH5",119,0)
 . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH5",120,0)
 . S GMTSJ=+$G(^LAB(60,GMTSTEST,2,+GMTSI,0))
"RTN","GMTSADH5",121,0)
 . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH5",122,0)
 . S GMTSRT=$G(^LAB(60,+GMTSJ,0))
"RTN","GMTSADH5",123,0)
 . I $L($P(GMTSRT,U,5)),("BO"[$P(GMTSRT,U,3)) D
"RTN","GMTSADH5",124,0)
 . . S GMTSCNT=GMTSCNT+1
"RTN","GMTSADH5",125,0)
 . . S Y(GMTSCNT)=+GMTSJ_"^"_GMTSRT
"RTN","GMTSADH5",126,0)
 . E  D
"RTN","GMTSADH5",127,0)
 . . ; DBIA 67 access ^LAB (file 60)
"RTN","GMTSADH5",128,0)
 . . D COMPILE(+$G(^LAB(60,GMTSTEST,2,GMTSI,0)),GMTSCNT)
"RTN","GMTSADH5",129,0)
 Q
"RTN","GMTSLOAD")
0^3^B14661203
"RTN","GMTSLOAD",1,0)
GMTSLOAD ;SLC/JER - Loads Ad Hoc Summary Type ; 07/18/2000
"RTN","GMTSLOAD",2,0)
 ;;2.7;Health Summary;**23,30,36,37**;Oct 20, 1995
"RTN","GMTSLOAD",3,0)
 ;
"RTN","GMTSLOAD",4,0)
MAIN ; Controls branching and execution
"RTN","GMTSLOAD",5,0)
 N DIC,DIROUT,DIRUT,DIR,GMI,GMW,GMTJ,GMTNM,GMTSEG,GMTSFUNC,GMTSI,GMTSIFN,GMTSWHL,INCLUDE,S2,X,Y
"RTN","GMTSLOAD",6,0)
 W !!,"This option rebuilds the Ad Hoc Health Summary to include ALL components",!
"RTN","GMTSLOAD",7,0)
 W "alphabetized by name.  If you wish, you may exclude DISABLED components.",!
"RTN","GMTSLOAD",8,0)
 S DIR(0)="Y",DIR("A")="Do you wish to continue",DIR("B")="NO",DIR("?")="Answer ""Y"" or ""N"", ""NO"" to exit this option."
"RTN","GMTSLOAD",9,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSLOAD",10,0)
 D ^DIR Q:Y=0  W !
"RTN","GMTSLOAD",11,0)
 I $S($D(DIRUT):1,$D(DIROUT):1,1:0) Q
"RTN","GMTSLOAD",12,0)
 S DIR("?")="Answer ""Y"" or ""N"", ""YES"" to include DISABLED components."
"RTN","GMTSLOAD",13,0)
 S DIR("A")="Should DISABLED components be included",DIR("B")="YES"
"RTN","GMTSLOAD",14,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSLOAD",15,0)
 D ^DIR
"RTN","GMTSLOAD",16,0)
 I $S($D(DIRUT):1,$D(DIROUT):1,1:0) Q
"RTN","GMTSLOAD",17,0)
 S INCLUDE=Y
"RTN","GMTSLOAD",18,0)
ENPOST ; Entry point from Post-init
"RTN","GMTSLOAD",19,0)
 ; call with INCLUDE=0 to exclude DISABLED components
"RTN","GMTSLOAD",20,0)
 ; call with INCLUDE=1 to include DISABLED components
"RTN","GMTSLOAD",21,0)
 N NEWREC,GMTSTYP,DLAYGO
"RTN","GMTSLOAD",22,0)
 S DLAYGO=142
"RTN","GMTSLOAD",23,0)
 S DIC=142,DIC(0)="LXF",X="GMTS HS ADHOC OPTION" S Y=$$TYPE^GMTSULT K DIC
"RTN","GMTSLOAD",24,0)
 I +Y'>0 D NOFILE Q
"RTN","GMTSLOAD",25,0)
 S (GMTSIFN,GMTSTYP)=+Y,NEWREC=+$P(Y,U,3)
"RTN","GMTSLOAD",26,0)
 S:'$D(^GMT(142,GMTSIFN,1,0)) ^(0)="^142.01IA^0^0"
"RTN","GMTSLOAD",27,0)
 S GMTNM="" F GMI=1:1 S GMTNM=$O(^GMT(142.1,"B",GMTNM)) Q:GMTNM']""  S GMTJ=$O(^(GMTNM,0)) Q:GMTJ'>0  D LOAD
"RTN","GMTSLOAD",28,0)
 S GMTSI=0 I 'NEWREC F  S GMTSI=$O(^GMT(142,GMTSIFN,1,GMTSI)) Q:GMTSI'>0  D PURGE^GMTSRN
"RTN","GMTSLOAD",29,0)
 ; DBIA 10141 call BMES^XPDUTL
"RTN","GMTSLOAD",30,0)
 D BMES^XPDUTL(" Rebuilding Ad Hoc Summary")
"RTN","GMTSLOAD",31,0)
 D RNMBR^GMTSRN
"RTN","GMTSLOAD",32,0)
 ; DBIA 10141 call MES^XPDUTL
"RTN","GMTSLOAD",33,0)
 D MES^XPDUTL(" Done")
"RTN","GMTSLOAD",34,0)
 Q
"RTN","GMTSLOAD",35,0)
NOFILE ; Handles case where GMTS HS ADHOC OPTION Summary Type is missing
"RTN","GMTSLOAD",36,0)
 ; DBIA 10141 call MES^XPDUTL
"RTN","GMTSLOAD",37,0)
 D MES^XPDUTL(" ")
"RTN","GMTSLOAD",38,0)
 ; DBIA 10141 call BMES^XPDUTL
"RTN","GMTSLOAD",39,0)
 D BMES^XPDUTL("** GMTS AD HOC OPTION Summary Type is missing **")
"RTN","GMTSLOAD",40,0)
 Q
"RTN","GMTSLOAD",41,0)
LOAD ; Loads GMTSEG(GMI)=SEQUENCE^COMPONENT^OCCURRENCE LIMIT^
"RTN","GMTSLOAD",42,0)
 ;   TIME LIMIT^NULL^HOSP LOC DISPLAYED^ICD TEXT DISPLAYED^
"RTN","GMTSLOAD",43,0)
 ;   PROVIDER NARR DISPLAYED^CPT MODIFIER DISPLAYED
"RTN","GMTSLOAD",44,0)
 ; 
"RTN","GMTSLOAD",45,0)
 ; Needs GMTJ     Pointer to Component  142.1
"RTN","GMTSLOAD",46,0)
 ;       GMTSTYP  Pointer to Type       142
"RTN","GMTSLOAD",47,0)
 ;       GMI      Pointer to Structure  142.01 in GMTSEG(GMI)
"RTN","GMTSLOAD",48,0)
 ;
"RTN","GMTSLOAD",49,0)
 N COMP,TYPE,OCC,TIME,GMSEQ,HOSPLOC,ICDTEXT,PROVNARR,CPTMOD
"RTN","GMTSLOAD",50,0)
 Q:'$D(^GMT(142.1,GMTJ,0))
"RTN","GMTSLOAD",51,0)
 S GMSEQ=$O(^GMT(142,"AE",GMTJ,GMTSTYP,0))
"RTN","GMTSLOAD",52,0)
 I GMSEQ>0 D
"RTN","GMTSLOAD",53,0)
 . S COMP=$P($G(^GMT(142.1,GMTJ,0)),U,5),TYPE=$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,3)
"RTN","GMTSLOAD",54,0)
 . S OCC=$S(COMP="Y":TYPE,1:"")
"RTN","GMTSLOAD",55,0)
 . S COMP=$P($G(^GMT(142.1,GMTJ,0)),U,3),TYPE=$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,4)
"RTN","GMTSLOAD",56,0)
 . S TIME=$S(COMP="Y":TYPE,1:"")
"RTN","GMTSLOAD",57,0)
 . S COMP=$P($G(^GMT(142.1,GMTJ,0)),U,10),TYPE=$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,6)
"RTN","GMTSLOAD",58,0)
 . S HOSPLOC=$S(COMP="Y":TYPE,1:"")
"RTN","GMTSLOAD",59,0)
 . S COMP=$P($G(^GMT(142.1,GMTJ,0)),U,11),TYPE=$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,7)
"RTN","GMTSLOAD",60,0)
 . S ICDTEXT=$S(COMP="Y":TYPE,1:"")
"RTN","GMTSLOAD",61,0)
 . S COMP=$P($G(^GMT(142.1,GMTJ,0)),U,12),TYPE=$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,8)
"RTN","GMTSLOAD",62,0)
 . S PROVNARR=$S(COMP="Y":TYPE,1:"")
"RTN","GMTSLOAD",63,0)
 . S COMP=$P($G(^GMT(142.1,GMTJ,0)),U,14),TYPE=$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,9)
"RTN","GMTSLOAD",64,0)
 . S CPTMOD=$S((COMP="Y"&(TYPE'="N")):"Y",(COMP="Y"&(TYPE="N")):"N",1:"")
"RTN","GMTSLOAD",65,0)
 E  D
"RTN","GMTSLOAD",66,0)
 . S OCC=$S($P(^GMT(142.1,GMTJ,0),U,5)="Y":10,1:"")
"RTN","GMTSLOAD",67,0)
 . S TIME=$S($P(^GMT(142.1,GMTJ,0),U,3)="Y":"1Y",1:"")
"RTN","GMTSLOAD",68,0)
 . S HOSPLOC=$S($P(^GMT(142.1,GMTJ,0),U,10)="Y":"Y",1:"")
"RTN","GMTSLOAD",69,0)
 . S ICDTEXT=$S($P(^GMT(142.1,GMTJ,0),U,11)="Y":"L",1:"")
"RTN","GMTSLOAD",70,0)
 . S PROVNARR=$S($P(^GMT(142.1,GMTJ,0),U,12)="Y":"Y",1:"")
"RTN","GMTSLOAD",71,0)
 . S CPTMOD=$S($P(^GMT(142.1,GMTJ,0),U,14)="Y":"Y",1:"")
"RTN","GMTSLOAD",72,0)
 D SETSEG
"RTN","GMTSLOAD",73,0)
 Q
"RTN","GMTSLOAD",74,0)
SETSEG ; Set GMTSEG(GMI)
"RTN","GMTSLOAD",75,0)
 S GMI=+($G(GMI)) Q:GMI=0  N OFF S OFF=$S($P(^GMT(142.1,GMTJ,0),U,6)="P":1,$P(^(0),U,6)="T":1,1:0)
"RTN","GMTSLOAD",76,0)
 I (+($G(INCLUDE))=0),(OFF=1) Q
"RTN","GMTSLOAD",77,0)
 S GMTSEG(GMI)=(5*GMI)_U_GMTJ_U_OCC_U_TIME_U_U_HOSPLOC_U_ICDTEXT_U_PROVNARR_U_CPTMOD
"RTN","GMTSLOAD",78,0)
 I GMSEQ>0 D SETSEL
"RTN","GMTSLOAD",79,0)
 Q
"RTN","GMTSLOAD",80,0)
SETSEL ; Sets up selection items in GMTSEG(GMI,GMSEL)=Selection item
"RTN","GMTSLOAD",81,0)
 N GMSEL,GMITEM,GMW,S2
"RTN","GMTSLOAD",82,0)
 S GMSEL=0 F  S GMSEL=$O(^GMT(142,GMTSTYP,1,+GMSEQ,1,GMSEL)) Q:GMSEL'>0  S GMITEM=^(GMSEL,0) S GMTSEG(GMI,GMSEL)=GMITEM
"RTN","GMTSLOAD",83,0)
 Q
"RTN","GMTSLRME")
0^31^B22143639
"RTN","GMTSLRME",1,0)
GMTSLRME ; SLC/JER,KER - Microbiology Extract Routine ; 07/18/2000
"RTN","GMTSLRME",2,0)
 ;;2.7;Health Summary;**25,28,37**;Oct 20, 1995
"RTN","GMTSLRME",3,0)
XTRCT N ACC,CDT,SS,CS,X,DIC,DIQ,DA,DR,MICRO,LOC,RDT,MICCOM
"RTN","GMTSLRME",4,0)
 K ^TMP("LRM",$J)
"RTN","GMTSLRME",5,0)
 S X=$P(^LR(LRDFN,"MI",IX,0),U),RDT=$P(^(0),U,3),ACC=$P(^(0),U,6),LOC=$P(^(0),U,8) D REGDTM4^GMTSU S CDT=X K X
"RTN","GMTSLRME",6,0)
 D LABTEST($P(^LR(LRDFN,"MI",IX,0),U),ACC)
"RTN","GMTSLRME",7,0)
 ; External format of site/specimen, collection sample, and comment
"RTN","GMTSLRME",8,0)
 S DIC=63,DIQ="MICRO",DIQ(0)="E",DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)=".05;.055;.99"
"RTN","GMTSLRME",9,0)
 D EN^DIQ1
"RTN","GMTSLRME",10,0)
 S SS=MICRO(63.05,IX,.05,"E")
"RTN","GMTSLRME",11,0)
 S CS=MICRO(63.05,IX,.055,"E"),MICCOM=MICRO(63.05,IX,.99,"E")
"RTN","GMTSLRME",12,0)
 S ^TMP("LRM",$J,0)=CDT_U_ACC_U_SS I $D(EXPAND) S ^TMP("LRM",$J,0)=^TMP("LRM",$J,0)_U_RDT_U_LOC
"RTN","GMTSLRME",13,0)
 S $P(^TMP("LRM",$J,0),U,6)=CS_U_MICCOM
"RTN","GMTSLRME",14,0)
 D ABXLEV,BACT,GRAM,STER,PARA^GMTSLRMX,MYCO^GMTSLRMX,TB^GMTSLRMX,VIRO^GMTSLRMX
"RTN","GMTSLRME",15,0)
 Q
"RTN","GMTSLRME",16,0)
BACT ; Get Bacteriology Work-up
"RTN","GMTSLRME",17,0)
 N DA,DIC,DIQ,DR,STATUS,ISO,ORG,RMK,COM,SMEAR
"RTN","GMTSLRME",18,0)
 I $D(^LR(LRDFN,"MI",IX,1)) D
"RTN","GMTSLRME",19,0)
 . S DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)="11.5;11.51;11.57;11.58",DIQ="STATUS"
"RTN","GMTSLRME",20,0)
 . S DIQ(0)="E" D EN^DIQ1
"RTN","GMTSLRME",21,0)
 . ;Include Status, sputum screen, and urine screen
"RTN","GMTSLRME",22,0)
 . S ^TMP("LRM",$J,"BACT",0)=$E($P(STATUS(63.05,IX,11.5,"E")," ",1),1,6)_U_STATUS(63.05,IX,11.58,"E")_U_STATUS(63.05,IX,11.57,"E")
"RTN","GMTSLRME",23,0)
 . ; Include sterility control
"RTN","GMTSLRME",24,0)
 . S ^TMP("LRM",$J,"BSTER",0)=STATUS(63.05,IX,11.51,"E")
"RTN","GMTSLRME",25,0)
 S ISO=0 F  S ISO=$O(^LR(LRDFN,"MI",IX,3,ISO)) Q:+ISO'>0  D
"RTN","GMTSLRME",26,0)
 . D ORGNSM S ^TMP("LRM",$J,"BACT",ISO)=$S($D(EXPAND):ISO_";"_ORG,1:ORG)
"RTN","GMTSLRME",27,0)
 . I $O(^LR(LRDFN,"MI",IX,3,ISO,1)) D ANTIBX
"RTN","GMTSLRME",28,0)
 . ;comment
"RTN","GMTSLRME",29,0)
 . S COM=0
"RTN","GMTSLRME",30,0)
 . F  S COM=$O(^LR(LRDFN,"MI",IX,3,ISO,1,COM)) Q:COM'>0  S ^TMP("LRM",$J,"BACT",ISO,"COM",COM)=^(COM,0)
"RTN","GMTSLRME",31,0)
 ; Bacteriology smear/prep
"RTN","GMTSLRME",32,0)
 S SMEAR=0
"RTN","GMTSLRME",33,0)
 F  S SMEAR=$O(^LR(LRDFN,"MI",IX,25,SMEAR)) Q:SMEAR'>0  S ^TMP("LRM",$J,"BACT","SMEAR",SMEAR)=^(SMEAR,0)
"RTN","GMTSLRME",34,0)
 ; remark
"RTN","GMTSLRME",35,0)
 S RMK=0
"RTN","GMTSLRME",36,0)
 F  S RMK=$O(^LR(LRDFN,"MI",IX,4,RMK)) Q:RMK=""  S ^TMP("LRM",$J,"BACT","R",RMK)=^(RMK,0)
"RTN","GMTSLRME",37,0)
 Q
"RTN","GMTSLRME",38,0)
ORGNSM N QTY
"RTN","GMTSLRME",39,0)
 S ORG=+^LR(LRDFN,"MI",IX,3,ISO,0),QTY=$P(^(0),U,2)
"RTN","GMTSLRME",40,0)
 S ORG=$$GET1^DIQ(61.2,ORG,.01,"I")
"RTN","GMTSLRME",41,0)
 S ORG=ORG_U_QTY
"RTN","GMTSLRME",42,0)
 Q
"RTN","GMTSLRME",43,0)
ANTIBX ; Get Antibitiotic susceptibility results on demand
"RTN","GMTSLRME",44,0)
 N ABX S ABX=1
"RTN","GMTSLRME",45,0)
 F  S ABX=$O(^LR(LRDFN,"MI",IX,3,ISO,ABX)) Q:ABX=""!(ABX'<3)  D ABXSET
"RTN","GMTSLRME",46,0)
 Q
"RTN","GMTSLRME",47,0)
ABXSET ; Set Antibiotic Susceptability data, when appropriate
"RTN","GMTSLRME",48,0)
 ; Separate out by Susceptable, Intermediate, and Resistant
"RTN","GMTSLRME",49,0)
 N FOUND,GMTSR,GMABX,ABXI,ABXNM,ABXN
"RTN","GMTSLRME",50,0)
 S ABXI=$$ABXI(ABX),ABXNM=$$ABXNM(ABXI),ABXN=ABX_";"_ABXNM
"RTN","GMTSLRME",51,0)
 I $P(ABXN,";",2)']"" S $P(ABXN,";",2)="UNKNOWN"
"RTN","GMTSLRME",52,0)
 I ("A"[$P(^LR(LRDFN,"MI",IX,3,ISO,ABX),U,3)) D
"RTN","GMTSLRME",53,0)
 . S GMABX=$G(^LR(LRDFN,"MI",IX,3,ISO,ABX))
"RTN","GMTSLRME",54,0)
 . ;Check for interpreted result being S, I, or R first
"RTN","GMTSLRME",55,0)
 . S FOUND=0
"RTN","GMTSLRME",56,0)
 . S GMTSR=$P(GMABX,U,2) D SAVE Q:FOUND
"RTN","GMTSLRME",57,0)
 . ;If not found then check reported result for S, I, or R
"RTN","GMTSLRME",58,0)
 . S GMTSR=$P(GMABX,U) D SAVE Q:FOUND
"RTN","GMTSLRME",59,0)
 . ;Neither interpreted nor reported result equaled S, I, or R so we'll store it in the "other" list provided that reported and interpreted are both not null
"RTN","GMTSLRME",60,0)
 . S:$P(GMABX,U)'=""&($P(GMABX,U,2)'="") ^TMP("LRM",$J,"BACT",ISO,"SUSC","O",$P($P(ABXN,U),";",2))=ABXN_U_GMABX
"RTN","GMTSLRME",61,0)
 Q
"RTN","GMTSLRME",62,0)
ABXI(X) ; Antibiotic Susceptability IEN
"RTN","GMTSLRME",63,0)
 S X=$G(X) Q:'$L(X) 0 N DIC,DTOUT,DUOUT,Y S DIC="^LAB(62.06,",D="AD",DIC(0)="" D MIX^DIC1 S X=+($G(Y)) S:X'>0 X=0 Q X
"RTN","GMTSLRME",64,0)
ABXNM(X) ; Antibiotic Susceptability Name
"RTN","GMTSLRME",65,0)
 S X=$G(X) Q:+X'>0 "" S X=$$GET1^DIQ(62.06,+X,.01) Q X
"RTN","GMTSLRME",66,0)
ABXLEV ; Get Serum antibiotic level
"RTN","GMTSLRME",67,0)
 Q:'$D(^LR(LRDFN,"MI",IX,14))  N GMI S GMI=0
"RTN","GMTSLRME",68,0)
 F  S GMI=$O(^LR(LRDFN,"MI",IX,14,GMI)) Q:GMI'>0  S ^TMP("LRM",$J,"CABXL",GMI)=$G(^(GMI,0))
"RTN","GMTSLRME",69,0)
 Q
"RTN","GMTSLRME",70,0)
STER ; Get sterility results if they exist
"RTN","GMTSLRME",71,0)
 N RESULT,STER
"RTN","GMTSLRME",72,0)
 S STER=0
"RTN","GMTSLRME",73,0)
 F  S STER=$O(^LR(LRDFN,"MI",IX,31,STER)) Q:STER'>0  D
"RTN","GMTSLRME",74,0)
 . S DIQ(0)="E",DIC=63,DA=LRDFN,DA(63.05)=IX,DR=5,DR(63.05)=11.52
"RTN","GMTSLRME",75,0)
 . S DR(63.292)=.01,DIQ="RESULT"
"RTN","GMTSLRME",76,0)
 . S DA(63.292)=STER
"RTN","GMTSLRME",77,0)
 . D EN^DIQ1
"RTN","GMTSLRME",78,0)
 . S ^TMP("LRM",$J,"BSTER",STER)=RESULT(63.292,STER,.01,"E")
"RTN","GMTSLRME",79,0)
 Q
"RTN","GMTSLRME",80,0)
GRAM ; Get Gram Stain Results
"RTN","GMTSLRME",81,0)
 N ISO
"RTN","GMTSLRME",82,0)
 Q:'$D(^LR(LRDFN,"MI",IX,2))
"RTN","GMTSLRME",83,0)
 S ISO=0
"RTN","GMTSLRME",84,0)
 F  S ISO=$O(^LR(LRDFN,"MI",IX,2,ISO)) Q:ISO=""  S ^TMP("LRM",$J,"GRAM",ISO)=^(ISO,0)
"RTN","GMTSLRME",85,0)
 Q
"RTN","GMTSLRME",86,0)
LABTEST(SDT,LRACC) ;Get lab test names and results
"RTN","GMTSLRME",87,0)
 N X,Y,LRAA,LRAN,LRAD,LRBRR,LRTSTS,LRTS
"RTN","GMTSLRME",88,0)
 S LRAD=+$E(SDT)_$P(LRACC," ",2)_"0000",X=$P(LRACC," "),DIC=68,DIC(0)="M"
"RTN","GMTSLRME",89,0)
 Q:'$L(X)  D ^DIC S LRAA=+Y,LRAN=+$P(LRACC," ",3)
"RTN","GMTSLRME",90,0)
 S LRBRR=0
"RTN","GMTSLRME",91,0)
 F  S LRBRR=+$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR)) Q:LRBRR'>0  D
"RTN","GMTSLRME",92,0)
 . S LRTS=+^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR,0),LRTS(1)=$P(^(0),U,5)
"RTN","GMTSLRME",93,0)
 . Q:"BO"'[$P($G(^LAB(60,LRTS,0)),U,3)
"RTN","GMTSLRME",94,0)
 . S LRTSTS=$S($D(^LAB(60,LRTS,0)):$P(^(0),U),1:"deleted test")
"RTN","GMTSLRME",95,0)
 . ;Lab test name and results in print order
"RTN","GMTSLRME",96,0)
 . S ^TMP("LRM",$J,0,"TEST",$S($D(^LAB(60,LRTS,.1)):$P(^(.1),U,6),1:"")_","_U_LRBRR)=LRTSTS_U_LRTS(1)
"RTN","GMTSLRME",97,0)
 Q
"RTN","GMTSLRME",98,0)
SAVE ;If result = S, I, or R then save
"RTN","GMTSLRME",99,0)
 I $S(GMTSR="I":1,GMTSR="R":1,GMTSR="S":1,1:0) S ^TMP("LRM",$J,"BACT",ISO,"SUSC",GMTSR,$P($P(ABXN,U),";",2))=ABXN_U_GMABX S FOUND=1
"RTN","GMTSLRME",100,0)
 Q
"RTN","GMTSLRPE")
0^30^B8303746
"RTN","GMTSLRPE",1,0)
GMTSLRPE ; SLC/JER,KER - Cytopathology Extract Routine ; 07/18/2000
"RTN","GMTSLRPE",2,0)
 ;;2.7;Health Summary;**3,28,37**;Oct 20, 1995
"RTN","GMTSLRPE",3,0)
XTRCT N IX0,IX
"RTN","GMTSLRPE",4,0)
 K ^TMP("LRCY",$J)
"RTN","GMTSLRPE",5,0)
 S IX=GMTS1 F IX0=1:0:MAX S IX=$O(^LR(LRDFN,"CY",IX)) Q:IX'>0!(IX>GMTS2)  D CYSET
"RTN","GMTSLRPE",6,0)
 Q
"RTN","GMTSLRPE",7,0)
CYSET ; Sets ^TMP("LRCY",$J, with appropriate data elements
"RTN","GMTSLRPE",8,0)
 N ACC,CDT,D1,D2,D3,DA,DIC,DIQ,DR,DX,ICD,OT,SR,RELEASE,SITE,SN,X,YR
"RTN","GMTSLRPE",9,0)
 S CDT=$P(^LR(LRDFN,"CY",IX,0),U),ACC=$P(^(0),U,6),RELEASE=$P(^(0),U,11)
"RTN","GMTSLRPE",10,0)
 I $D(ACC) S IX0=IX0+1
"RTN","GMTSLRPE",11,0)
 S X=CDT D REGDT4^GMTSU S CDT=X K X
"RTN","GMTSLRPE",12,0)
 S ^TMP("LRCY",$J,IX,0)=CDT_U_ACC
"RTN","GMTSLRPE",13,0)
 I $D(^LR(LRDFN,"CY",IX,.1)) S ^TMP("LRCY",$J,IX,1)="Site/Specimen"_U_RELEASE
"RTN","GMTSLRPE",14,0)
 Q:'RELEASE
"RTN","GMTSLRPE",15,0)
 S SN=0 F  S SN=$O(^LR(LRDFN,"CY",IX,.1,SN)) Q:SN'>0  S ^TMP("LRCY",$J,IX,1,SN)=$P(^LR(LRDFN,"CY",IX,.1,SN,0),U)
"RTN","GMTSLRPE",16,0)
 S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,.2,OT)) Q:+OT'>0  S ^TMP("LRCY",$J,IX,"AH",OT)=$G(^LR(LRDFN,"CY",IX,.2,OT,0))
"RTN","GMTSLRPE",17,0)
 S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1,OT)) Q:OT'>0  S ^TMP("LRCY",$J,IX,"G",OT)=^LR(LRDFN,"CY",IX,1,OT,0)
"RTN","GMTSLRPE",18,0)
 S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1.1,OT)) Q:OT'>0  S ^TMP("LRCY",$J,IX,"MI",OT)=^LR(LRDFN,"CY",IX,1.1,OT,0)
"RTN","GMTSLRPE",19,0)
 S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1.2,OT)) Q:OT'>0  D
"RTN","GMTSLRPE",20,0)
 . Q:+$P($G(^LR(LRDFN,"CY",IX,1.2,OT,0)),U,2)'>0
"RTN","GMTSLRPE",21,0)
 . S ^TMP("LRCY",$J,IX,"SR",OT,0)=$P($G(^LR(LRDFN,"CY",IX,1.2,OT,0)),U)
"RTN","GMTSLRPE",22,0)
 . S SR=0 F  S SR=$O(^LR(LRDFN,"CY",IX,1.2,OT,1,SR)) Q:SR'>0  D
"RTN","GMTSLRPE",23,0)
 . . S ^TMP("LRCY",$J,IX,"SR",OT,SR)=$P($G(^LR(LRDFN,"CY",IX,1.2,OT,1,SR,0)),U)
"RTN","GMTSLRPE",24,0)
 S OT=0 F  S OT=$O(^LR(LRDFN,"CY",IX,1.4,OT)) Q:+OT'>0  S ^TMP("LRCY",$J,IX,"NDX",OT)=$P($G(^LR(LRDFN,"CY",IX,1.4,OT,0)),U)
"RTN","GMTSLRPE",25,0)
 Q
"RTN","GMTSLRPE",26,0)
D ; Get Disease Field data
"RTN","GMTSLRPE",27,0)
 N GMI,GMD,DIS S GMD=0 F  S GMD=$O(^LR(LRDFN,"CY",IX,2,OT,1,GMD)) Q:GMD=""  D
"RTN","GMTSLRPE",28,0)
 . S GMI=+^LR(LRDFN,"CY",IX,2,OT,1,GMD,0)
"RTN","GMTSLRPE",29,0)
 . ; ^LAB(61.4          0;1
"RTN","GMTSLRPE",30,0)
 . S ^TMP("LRCY",$J,IX,"OT"_OT,"D"_GMD)=$$GET1^DIQ(61.4,GMI,.01,"I")
"RTN","GMTSLRPE",31,0)
 Q
"RTN","GMTSLRPE",32,0)
M ; Get Morphology Field data
"RTN","GMTSLRPE",33,0)
 N GMI,GMM,MORPH S GMM=0 F  S GMM=$O(^LR(LRDFN,"CY",IX,2,OT,2,GMM)) Q:GMM=""  D
"RTN","GMTSLRPE",34,0)
 . S GMI=+^LR(LRDFN,"CY",IX,2,OT,1,GMD,0)
"RTN","GMTSLRPE",35,0)
 . ; ^LAB(61.1          0;1
"RTN","GMTSLRPE",36,0)
 . S ^TMP("LRCY",$J,IX,"OT"_OT,"M"_GMM)=$$GET1^DIQ(61.1,GMI,.01,"I")
"RTN","GMTSLRPE",37,0)
 . D E
"RTN","GMTSLRPE",38,0)
 Q
"RTN","GMTSLRPE",39,0)
E ; Get Etiology Field data
"RTN","GMTSLRPE",40,0)
 N GMI,GME,ETIOL S GME=0 F  S GME=$O(^LR(LRDFN,"CY",IX,2,OT,2,GMM,1,GME)) Q:GME'>0  D
"RTN","GMTSLRPE",41,0)
 . S GMI=+^LR(LRDFN,"CY",IX,2,OT,2,GMM,1,GME,0)
"RTN","GMTSLRPE",42,0)
 . ; ^LAB(61.2          0;1
"RTN","GMTSLRPE",43,0)
 . S ^TMP("LRCY",$J,IX,"OT"_OT,"M"_GMM,"E"_GME)=$$GET1^DIQ(61.2,GMI,.01,"I")
"RTN","GMTSLRPE",44,0)
 Q
"RTN","GMTSLRPE",45,0)
P ; Get Procedure Field data
"RTN","GMTSLRPE",46,0)
 N GMI,GMP,PROC S GMP=0 F  S GMP=$O(^LR(LRDFN,"CY",IX,2,OT,4,GMP)) Q:GMP=""  D
"RTN","GMTSLRPE",47,0)
 . S GMI=+^LR(LRDFN,"CY",IX,2,OT,4,GMP,0)
"RTN","GMTSLRPE",48,0)
 . ; ^LAB(61.5          0;1
"RTN","GMTSLRPE",49,0)
 . S ^TMP("LRCY",$J,IX,"OT"_OT,"P"_GMP)=$$GET1^DIQ(61.5,GMI,.01,"I")
"RTN","GMTSLRPE",50,0)
 Q
"RTN","GMTSP37")
0^^B10375971
"RTN","GMTSP37",1,0)
GMTSP37 ; CIO/SLC - Post Install GMTS*2.7*37    ; 07/18/2000
"RTN","GMTSP37",2,0)
 ;;2.7;Health Summary;**37**;Oct 20, 1995
"RTN","GMTSP37",3,0)
 ;
"RTN","GMTSP37",4,0)
 Q
"RTN","GMTSP37",5,0)
POST ; Post Install
"RTN","GMTSP37",6,0)
 D BM(" Setting up CPT Modifiers in Health Summary Components"),BL K ^TMP("GMTSP37")
"RTN","GMTSP37",7,0)
 N GMTSABR F GMTSABR="RP","OE","SR","SRO","NSR","SNSR" D COM,TYP K ^TMP("GMTSP37")
"RTN","GMTSP37",8,0)
MSG N GMTSBLD,GMTSINST,GMTSHORT I +$$ROK("GMTSXPS1")>0 S GMTSHORT="",GMTSINST="",GMTSBLD="GMTS*2.7*37" D SEND^GMTSXPS1
"RTN","GMTSP37",9,0)
 Q
"RTN","GMTSP37",10,0)
COM ; Update Health Summary Components
"RTN","GMTSP37",11,0)
 Q:'$L($G(GMTSABR))  N GMTSCI,GMTSCNM,GMTST,GMTSTI,GMTSSI
"RTN","GMTSP37",12,0)
 S GMTSCI=+($O(^GMT(142.1,"C",GMTSABR,0))) Q:GMTSCI=0  S GMTSCNM=$P($G(^GMT(142.1,+GMTSCI,0)),"^",9) S:'$L(GMTSCNM) GMTSCNM=$P($G(^GMT(142.1,+GMTSCI,0)),"^") Q:'$L(GMTSCNM)  S GMTST=GMTSCNM F  Q:$L(GMTST)>22  S GMTST=GMTST_" "
"RTN","GMTSP37",13,0)
 S GMTST="    "_GMTST_"  "_GMTSABR D M(GMTST),EDC S GMTSTI=0 F  S GMTSTI=$O(^GMT(142,"AE",GMTSCI,GMTSTI)) Q:+GMTSTI=0  S GMTSSI=0 F  S GMTSSI=$O(^GMT(142,"AE",GMTSCI,GMTSTI,GMTSSI)) Q:+GMTSSI=0  S ^TMP("GMTSP37",GMTSTI,GMTSSI,GMTSCI)=""
"RTN","GMTSP37",14,0)
 Q
"RTN","GMTSP37",15,0)
EDC ; Edit Component
"RTN","GMTSP37",16,0)
 N X,Y,DIC,DIE,DTOUT,DA S DA=+($G(GMTSCI)) Q:DA=0  Q:'$D(^GMT(142.1,DA,0))
"RTN","GMTSP37",17,0)
 S (DIC,DIE)="^GMT(142.1,",DR="14///Y"
"RTN","GMTSP37",18,0)
 ; DBIA 10018 call ^DIE
"RTN","GMTSP37",19,0)
 D ^DIE
"RTN","GMTSP37",20,0)
 Q
"RTN","GMTSP37",21,0)
TYP ; Update Health Summary Types
"RTN","GMTSP37",22,0)
 N GMTSTI,GMTSTN,GMTSSI,GMTSCI,GMTSCN,GMTST,GMTSC,GMTSCT S (GMTSC,GMTSCT,GMTSTI)=0 F  S GMTSTI=$O(^TMP("GMTSP37",GMTSTI)) Q:+GMTSTI=0  D
"RTN","GMTSP37",23,0)
 . S (GMTSCT,GMTSSI)=0 F  S GMTSSI=$O(^TMP("GMTSP37",GMTSTI,GMTSSI)) Q:+GMTSSI=0  D
"RTN","GMTSP37",24,0)
 . . S GMTSCT=GMTSCT+1,GMTSCI=0 F  S GMTSCI=$O(^TMP("GMTSP37",GMTSTI,GMTSSI,GMTSCI)) Q:+GMTSCI=0  D
"RTN","GMTSP37",25,0)
 . . . S GMTSTN=$P($G(^GMT(142,GMTSTI,0)),"^",1),GMTSC=GMTSC+1 D:GMTSC=1 BM(" Setting up CPT Modifiers in Health Summary Types"),BL S GMTST="    "_GMTSTN_" " D:GMTSCT=1 M(GMTST) D EDT
"RTN","GMTSP37",26,0)
 Q
"RTN","GMTSP37",27,0)
EDT ; Edit Type
"RTN","GMTSP37",28,0)
 N X,Y,DIC,DIE,DTOUT,DA Q:+($G(GMTSTI))=0  Q:+($G(GMTSSI))=0  S DA(1)=+($G(GMTSTI)),DA=+($G(GMTSSI)),(DIC,DIE)="^GMT(142,"_DA(1)_",1,",DR="9///Y" D ^DIE
"RTN","GMTSP37",29,0)
 Q
"RTN","GMTSP37",30,0)
BM(X) ;   Blank Line with Message
"RTN","GMTSP37",31,0)
 Q:$D(GMTSQT)
"RTN","GMTSP37",32,0)
 ; DBIA 10141 call BMES^XPDUTL
"RTN","GMTSP37",33,0)
 D:$D(XPDNM) BMES^XPDUTL($G(X)) W:'$D(XPDNM) !!,$G(X) Q
"RTN","GMTSP37",34,0)
BL ;   Blank Line with w/o Message
"RTN","GMTSP37",35,0)
 Q:$D(GMTSQT)
"RTN","GMTSP37",36,0)
 ; DBIA 10141 call MES^XPDUTL
"RTN","GMTSP37",37,0)
 D:$D(XPDNM) MES^XPDUTL(" ") W:'$D(XPDNM) !," " Q
"RTN","GMTSP37",38,0)
M(X) ;   Message
"RTN","GMTSP37",39,0)
 Q:$D(GMTSQT)
"RTN","GMTSP37",40,0)
 ; DBIA 10141 call MES^XPDUTL
"RTN","GMTSP37",41,0)
 D:$D(XPDNM) MES^XPDUTL($G(X)) W:'$D(XPDNM) !,$G(X) Q
"RTN","GMTSP37",42,0)
ROK(X) ; Routine OK
"RTN","GMTSP37",43,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0
"RTN","GMTSP37",44,0)
 ; DBIA 10096 access ^%ZOSF
"RTN","GMTSP37",45,0)
 X ^%ZOSF("TEST")
"RTN","GMTSP37",46,0)
 Q:$T 1 Q 0
"RTN","GMTSPSO")
0^20^B9775330
"RTN","GMTSPSO",1,0)
GMTSPSO ; SLC/JER,KER/NDBI - OP Rx Summary Component (V6) ; 07/18/2000
"RTN","GMTSPSO",2,0)
 ;;2.7;Health Summary;**15,28,37**;Oct 20, 1995
"RTN","GMTSPSO",3,0)
MAIN ; OP Rx HS Comp
"RTN","GMTSPSO",4,0)
 ; Check for version 7   GMTSPSO7
"RTN","GMTSPSO",5,0)
 ; DBIA 10141 call $$VERSION^XPDUTL
"RTN","GMTSPSO",6,0)
 I $$VERSION^XPDUTL("PSO")'<7 G MAIN^GMTSPSO7
"RTN","GMTSPSO",7,0)
 ; If not version 7      GMTSPSO
"RTN","GMTSPSO",8,0)
 N ECD,GMR,IX,PSOBEGIN,PSOACT,GMX,GMTOP
"RTN","GMTSPSO",9,0)
 S PSOBEGIN=$S(GMTS2'=9999999:(9999999-GMTS2),1:"")
"RTN","GMTSPSO",10,0)
 I PSOBEGIN="" S PSOACT=1 K PSOBEGIN
"RTN","GMTSPSO",11,0)
 K ^TMP("PSOO",$J)
"RTN","GMTSPSO",12,0)
 ; DBIA 2931 call HS^A7RPSOHS
"RTN","GMTSPSO",13,0)
 D:$$ROK^GMTSU("A7RPSOHS")&($$NDBI^GMTSU) HS^A7RPSOHS(DFN)
"RTN","GMTSPSO",14,0)
 ; DBIA 522 access ^PS (file 55)
"RTN","GMTSPSO",15,0)
 I '$D(^PS(55,DFN,"P")),'$D(^("ARC")),'$D(^TMP("PSOO",$J)) Q
"RTN","GMTSPSO",16,0)
 ; DBIA 522 access ^PS (file 55)
"RTN","GMTSPSO",17,0)
 I '$O(^PS(55,DFN,"P",0)),$D(^PS(55,DFN,"ARC")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Patient Has Archived OP Prescriptions",!
"RTN","GMTSPSO",18,0)
 ; DBIA 60 call ^PSOHCSUM
"RTN","GMTSPSO",19,0)
 D ^PSOHCSUM D:$$ROK^GMTSU("A7RPSOHS")&($$NDBI^GMTSU) HS^A7RPSOHS(DFN) I '$D(^TMP("PSOO",$J)) Q
"RTN","GMTSPSO",20,0)
 S GMTSLO=GMTSLO+3
"RTN","GMTSPSO",21,0)
 S (GMX,GMTOP,IX)=0
"RTN","GMTSPSO",22,0)
 F  S IX=$O(^TMP("PSOO",$J,IX)) Q:IX'>0  S GMR=$G(^(IX,0)) D WRT
"RTN","GMTSPSO",23,0)
 S GMTSLO=GMTSLO-3
"RTN","GMTSPSO",24,0)
 K ^TMP("PSOO",$J)
"RTN","GMTSPSO",25,0)
 Q
"RTN","GMTSPSO",26,0)
WRT ; Writes OP Pharmacy Segment Record
"RTN","GMTSPSO",27,0)
 N ID,LFD,X,MI,NL,CF,GMD,GMV,GMI,GUI S GUI=$$HF^GMTSU
"RTN","GMTSPSO",28,0)
 S ID=$P(GMR,U),LFD=$P(GMR,U,2),ECD=$P(GMR,U,11),CF=$P(GMR,U,10)
"RTN","GMTSPSO",29,0)
 ; Don't display when issue date is after To Date
"RTN","GMTSPSO",30,0)
 Q:+$G(GMRANGE)&(ID>(9999999-GMTS1))
"RTN","GMTSPSO",31,0)
 F GMV="ID","LFD","ECD" S X=@GMV D REGDT4^GMTSU S @GMV=X K X
"RTN","GMTSPSO",32,0)
 S MI=$G(^TMP("PSOO",$J,IX,1)),NL=0 I $L(MI)>73 D PARSE
"RTN","GMTSPSO",33,0)
 S GMD=$P($P(GMR,U,4),";",2)
"RTN","GMTSPSO",34,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPSO",35,0)
 D:GMTSNPG!(GMX'>0) HEAD W:'GMTOP ! S GMTOP=0 W $P($P(GMR,U,3),";",2)
"RTN","GMTSPSO",36,0)
 W !,?22,$P(GMR,U,6),?35,$P($P(GMR,U,5),";"),?39,$P(GMR,U,7),?54,ID,?65,LFD,?76,"("_$P(GMR,U,8)_")",!
"RTN","GMTSPSO",37,0)
 S GMX=1 I 'NL D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?2,"SIG: ",MI,! S GMTOP=0
"RTN","GMTSPSO",38,0)
 F GMI=1:1:NL D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W:GMI=1 ?2,"SIG: " W ?7,MI(GMI),! S GMTOP=0
"RTN","GMTSPSO",39,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?4,"Provider: ",$E(GMD,1,22) W:CF ?37,"Cost/Fill: $",$J(CF,6,2)
"RTN","GMTSPSO",40,0)
 I "EC"[$P($P(GMR,U,5),";"),ECD]"" W ?57,"Exp/Can Dt: "_ECD
"RTN","GMTSPSO",41,0)
 W ! S GMTOP=0
"RTN","GMTSPSO",42,0)
 Q
"RTN","GMTSPSO",43,0)
PARSE ; Parses Medication Instructions
"RTN","GMTSPSO",44,0)
 N GMI,NW,WPL
"RTN","GMTSPSO",45,0)
 S NL=$S(($L(MI)/73)>($L(MI)\73):($L(MI)\73)+1,1:$L(MI)\73)
"RTN","GMTSPSO",46,0)
 S NW=$L(MI," "),WPL=$S((NW/NL)>(NW\NL):(NW\NL)+1,1:NW\NL)
"RTN","GMTSPSO",47,0)
 F GMI=1:1:NL S MI(GMI)=$P(MI," ",(GMI-1)*WPL+1,GMI*WPL)
"RTN","GMTSPSO",48,0)
 Q
"RTN","GMTSPSO",49,0)
HEAD ; Prints Header
"RTN","GMTSPSO",50,0)
 S GMTOP=1
"RTN","GMTSPSO",51,0)
 ; DBIA 10035 access ^DPT (file 2)
"RTN","GMTSPSO",52,0)
 ; DBIA 3136 access ^PS (file 59)
"RTN","GMTSPSO",53,0)
 I GMX'>0,$D(^DPT(DFN,.1)),^(.1)]"",+($P($G(^PS(59.7,1,40.1)),"^")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Outpatient prescriptions are cancelled 72 hours after admission",!
"RTN","GMTSPSO",54,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Drug....................................",?65,"Last",!
"RTN","GMTSPSO",55,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPSO",56,0)
 W ?22,"Rx #",?34,"Stat",?39,"Qty",?54,"Issued",?65,"Filled",?76,"Rem"
"RTN","GMTSPSO",57,0)
 W:$Y'>(IOSL-GMTSLO)!(+($G(GUI))>0) !
"RTN","GMTSPSO",58,0)
 Q
"RTN","GMTSPSO7")
0^21^B8298625
"RTN","GMTSPSO7",1,0)
GMTSPSO7 ; SLC/JER/KER - OP Rx Summary Component (V6) ; 07/18/2000
"RTN","GMTSPSO7",2,0)
 ;;2.7;Health Summary;**15,28,37**;Oct 20, 1995
"RTN","GMTSPSO7",3,0)
MAIN ; OP Rx HS Component
"RTN","GMTSPSO7",4,0)
 N ECD,GMR,IX,PSOBEGIN,PSOACT,GMX,GMTOP
"RTN","GMTSPSO7",5,0)
 S PSOBEGIN=$S(GMTS2'=9999999:(9999999-GMTS2),1:"")
"RTN","GMTSPSO7",6,0)
 I PSOBEGIN="" S PSOACT=1 K PSOBEGIN
"RTN","GMTSPSO7",7,0)
 K ^TMP("PSOO",$J)
"RTN","GMTSPSO7",8,0)
 ; DBIA 522 access ^PS (file 55)
"RTN","GMTSPSO7",9,0)
 I '$D(^PS(55,DFN,"P")),'$D(^("ARC")) Q
"RTN","GMTSPSO7",10,0)
 ; DBIA 522 access ^PS (file 55)
"RTN","GMTSPSO7",11,0)
 I '$O(^PS(55,DFN,"P",0)),$D(^PS(55,DFN,"ARC")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Patient Has Archived OP Prescriptions",!
"RTN","GMTSPSO7",12,0)
 ; DBIA 60 call ^PSOHCSUM
"RTN","GMTSPSO7",13,0)
 D ^PSOHCSUM I '$D(^TMP("PSOO",$J)) Q
"RTN","GMTSPSO7",14,0)
 S GMTSLO=GMTSLO+3
"RTN","GMTSPSO7",15,0)
 S (GMTOP,GMX,IX)=0
"RTN","GMTSPSO7",16,0)
 F  S IX=$O(^TMP("PSOO",$J,IX)) Q:IX'>0  S GMR=$G(^(IX,0)) D WRT
"RTN","GMTSPSO7",17,0)
 S GMTSLO=GMTSLO-3
"RTN","GMTSPSO7",18,0)
 K ^TMP("PSOO",$J),^UTILITY($J,"W")
"RTN","GMTSPSO7",19,0)
 Q
"RTN","GMTSPSO7",20,0)
WRT ; Writes OP Pharmacy Segment Record
"RTN","GMTSPSO7",21,0)
 N ID,LFD,X,MI,NL,CF,GMD,GMV,GMI,DIWL,DIWR,DIWF,GMSIG,GUI S GUI=$$HF^GMTSU
"RTN","GMTSPSO7",22,0)
 S ID=$P(GMR,U),LFD=$P(GMR,U,2),ECD=$P(GMR,U,11),CF=$P(GMR,U,10)
"RTN","GMTSPSO7",23,0)
 ; Don't display when issue date is after To Date
"RTN","GMTSPSO7",24,0)
 Q:+$G(GMRANGE)&(ID>(9999999-GMTS1))
"RTN","GMTSPSO7",25,0)
 F GMV="ID","LFD","ECD" S X=@GMV D REGDT4^GMTSU S @GMV=X K X
"RTN","GMTSPSO7",26,0)
 S NL=0,DIWL=1,DIWR=73,DIWF="" K ^UTILITY($J,"W")
"RTN","GMTSPSO7",27,0)
 F  S NL=$O(^TMP("PSOO",$J,IX,NL)) Q:NL'>0  D
"RTN","GMTSPSO7",28,0)
 . S X=$G(^TMP("PSOO",$J,IX,NL,0))
"RTN","GMTSPSO7",29,0)
 . ; DBIA 10011 call ^DIWP
"RTN","GMTSPSO7",30,0)
 . D ^DIWP
"RTN","GMTSPSO7",31,0)
 S GMD=$P($P(GMR,U,4),";",2)
"RTN","GMTSPSO7",32,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPSO7",33,0)
 D:GMTSNPG!(GMX'>0) HEAD W:'GMTOP ! S GMTOP=0 W $P($P(GMR,U,3),";",2)
"RTN","GMTSPSO7",34,0)
 W !,?22,$P(GMR,U,6),?35,$P($P(GMR,U,5),";"),?39,$P(GMR,U,7),?54,ID,?65,LFD,?76,"("_$P(GMR,U,8)_")",!
"RTN","GMTSPSO7",35,0)
 S GMX=1,GMI=0,GMSIG=1
"RTN","GMTSPSO7",36,0)
 F  S GMI=$O(^UTILITY($J,"W",DIWL,GMI)) Q:GMI'>0!$D(GMTSQIT)  D
"RTN","GMTSPSO7",37,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD
"RTN","GMTSPSO7",38,0)
 . S MI=$G(^UTILITY($J,"W",DIWL,GMI,0))
"RTN","GMTSPSO7",39,0)
 . W:GMSIG=1 ?2,"SIG: " S:GMSIG=1 GMSIG=0 W ?7,MI,! S GMTOP=0
"RTN","GMTSPSO7",40,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D:GMTSNPG HEAD W ?4,"Provider: ",$E(GMD,1,22) W:CF ?37,"Cost/Fill: $",$J(CF,6,2)
"RTN","GMTSPSO7",41,0)
 I "EC"[$P($P(GMR,U,5),";"),ECD]"" W ?57,"Exp/Can Dt: "_ECD
"RTN","GMTSPSO7",42,0)
 W ! S GMTOP=0
"RTN","GMTSPSO7",43,0)
 Q
"RTN","GMTSPSO7",44,0)
HEAD ; Prints Header
"RTN","GMTSPSO7",45,0)
 ; Only write the next line when there is data
"RTN","GMTSPSO7",46,0)
 S GMTOP=1
"RTN","GMTSPSO7",47,0)
 ; DBIA 10035 access ^DPT (file 2)
"RTN","GMTSPSO7",48,0)
 ; DBIA 3136 access ^PS (file 59)
"RTN","GMTSPSO7",49,0)
 I GMX'>0,$D(^DPT(DFN,.1)),^(.1)]"",+($P($G(^PS(59.7,1,40.1)),"^")) D CKP^GMTSUP Q:$D(GMTSQIT)  W "Outpatient prescriptions are cancelled 72 hours after admission",!
"RTN","GMTSPSO7",50,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"Drug....................................",?65,"Last",!
"RTN","GMTSPSO7",51,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPSO7",52,0)
 W ?22,"Rx #",?34,"Stat",?39,"Qty",?54,"Issued",?65,"Filled",?76,"Rem"
"RTN","GMTSPSO7",53,0)
 W:$Y'>(IOSL-GMTSLO)!(+($G(GUI))>0) !
"RTN","GMTSPSO7",54,0)
 Q
"RTN","GMTSPXOP")
0^14^B43252002
"RTN","GMTSPXOP",1,0)
GMTSPXOP ; SLC/SBW,KER - PCE Outpatient Encounter comp ; 07/18/2000
"RTN","GMTSPXOP",2,0)
 ;;2.7;Health Summary;**8,10,28,37**;Oct 20, 1995
"RTN","GMTSPXOP",3,0)
 ;
"RTN","GMTSPXOP",4,0)
PURPOSE ; Entry point to show outpatient encounters with ICD9 data
"RTN","GMTSPXOP",5,0)
 ; and providers
"RTN","GMTSPXOP",6,0)
 N DTYPE S DTYPE="DP" D MAIN
"RTN","GMTSPXOP",7,0)
 Q
"RTN","GMTSPXOP",8,0)
OUTPT ; Entry point to show outpatient encounters with ICD9 data,
"RTN","GMTSPXOP",9,0)
 ; CPT data, and providers
"RTN","GMTSPXOP",10,0)
 N DTYPE S DTYPE="CDP" D MAIN
"RTN","GMTSPXOP",11,0)
 Q
"RTN","GMTSPXOP",12,0)
MAIN ;
"RTN","GMTSPXOP",13,0)
 N GMTSIVD,GMTSDAT,GMTSDTU,GMTSOVT,GMTSLOC,DIWL,GMTAB,GMTSN,GMCKP,GMTSX
"RTN","GMTSPXOP",14,0)
 N GMTSITE,GMTSICL,GMTSLOC,GMTSELIG,X,GMTSVDF,GMTSCPTM
"RTN","GMTSPXOP",15,0)
 ; GMTSCPTM    Component uses CPT Modifiers 1 yes 0 no
"RTN","GMTSPXOP",16,0)
 S GMTSCPTM=+($$CPT^GMTSU(+($G(GMTSEGN)))) S:$G(GMPXCMOD)="N" GMTSCPTM=0
"RTN","GMTSPXOP",17,0)
 ; GMTSICL     # of blank left columns for support data of a visit
"RTN","GMTSPXOP",18,0)
 S GMTSICL=14
"RTN","GMTSPXOP",19,0)
 ; DIWL        Used in TXTFMT call & to print returned data
"RTN","GMTSPXOP",20,0)
 S DIWL=0
"RTN","GMTSPXOP",21,0)
 ; GMTAB       Used to offset data from TXTFMT call after 1st line
"RTN","GMTSPXOP",22,0)
 S GMTAB=2
"RTN","GMTSPXOP",23,0)
 ; GMTSOVT     This is the set of Service Categories for AICTSORE
"RTN","GMTSPXOP",24,0)
 ;                A  Ambulatory
"RTN","GMTSPXOP",25,0)
 ;                I  Inpatient
"RTN","GMTSPXOP",26,0)
 ;                C  Chart Review
"RTN","GMTSPXOP",27,0)
 ;                T  Telecommunications
"RTN","GMTSPXOP",28,0)
 ;                S  Day Surgery
"RTN","GMTSPXOP",29,0)
 ;                O  Observation
"RTN","GMTSPXOP",30,0)
 ;                R  Nursing Home Encounters
"RTN","GMTSPXOP",31,0)
 ;                E  Event (Historical)
"RTN","GMTSPXOP",32,0)
 ;
"RTN","GMTSPXOP",33,0)
 ;             Note: Hospitalization and Ancillary 
"RTN","GMTSPXOP",34,0)
 ;                   encounters are not included
"RTN","GMTSPXOP",35,0)
 S GMTSOVT="AICTSORE"
"RTN","GMTSPXOP",36,0)
 ;
"RTN","GMTSPXOP",37,0)
 ; DBIA 1238 call VISIT^PXRHS01
"RTN","GMTSPXOP",38,0)
 D VISIT^PXRHS01(DFN,GMTSEND,GMTSBEG,GMTSNDM,GMTSOVT,DTYPE,1)
"RTN","GMTSPXOP",39,0)
 Q:'$D(^TMP("PXHSV",$J))
"RTN","GMTSPXOP",40,0)
 S GMTSIVD=0
"RTN","GMTSPXOP",41,0)
 F  S GMTSIVD=$O(^TMP("PXHSV",$J,GMTSIVD)) Q:GMTSIVD']""  D  Q:$D(GMTSQIT)
"RTN","GMTSPXOP",42,0)
 . S GMTSVDF=0
"RTN","GMTSPXOP",43,0)
 . F  S GMTSVDF=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF)) Q:GMTSVDF'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXOP",44,0)
 . . S GMTSN=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,0))
"RTN","GMTSPXOP",45,0)
 . . S X=$P(GMTSN,U,1) D REGDT4^GMTSU S GMTSDAT=X
"RTN","GMTSPXOP",46,0)
 . . S GMTSDTU=0
"RTN","GMTSPXOP",47,0)
 . . S GMTSLOC=""
"RTN","GMTSPXOP",48,0)
 . . S GMTSITE=$S($P(GMTSN,U,3)]"":$E($P(GMTSN,U,3),1,10),$P(GMTSN,U,8)]"":$E($P(GMTSN,U,8),1,10),1:"No Site")
"RTN","GMTSPXOP",49,0)
 . . I $G(GMPXHLOC)="Y" S GMTSLOC=$E($P(GMTSN,U,6),1,30)
"RTN","GMTSPXOP",50,0)
 . . I '$L(GMTSLOC) S GMTSLOC=$P(GMTSN,U,9)
"RTN","GMTSPXOP",51,0)
 . . S GMTSELIG=$E($P(GMTSN,U,12),1,17)
"RTN","GMTSPXOP",52,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS
"RTN","GMTSPXOP",53,0)
 . . D DSPPROV Q:$D(GMTSQIT)
"RTN","GMTSPXOP",54,0)
 . . D DSPPOV Q:$D(GMTSQIT)
"RTN","GMTSPXOP",55,0)
 . . D DSPCPT
"RTN","GMTSPXOP",56,0)
 . . W !
"RTN","GMTSPXOP",57,0)
 K ^TMP("PXHSV",$J)
"RTN","GMTSPXOP",58,0)
 Q
"RTN","GMTSPXOP",59,0)
 ;
"RTN","GMTSPXOP",60,0)
DSPPOV ; Display Purpose of visit
"RTN","GMTSPXOP",61,0)
 Q:$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",""))=""
"RTN","GMTSPXOP",62,0)
 Q:$G(GMPXICDF)="N"&($G(GMPXNARR)="N")
"RTN","GMTSPXOP",63,0)
 N GMTSN,GMTSMOD,GMTSICD,GMTSNARR,GMTSPDN,GMTS,GMTSQTY,GMTSPRI,COMMENT
"RTN","GMTSPXOP",64,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS W ?3,"Diagnosis:"
"RTN","GMTSPXOP",65,0)
 S GMCKP=0,GMTSPDN="",GMTSQTY=""
"RTN","GMTSPXOP",66,0)
 F  S GMTSPDN=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",GMTSPDN)) Q:GMTSPDN'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXOP",67,0)
 . S GMTSN=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",GMTSPDN))
"RTN","GMTSPXOP",68,0)
 . S GMTSMOD=$P(GMTSN,U,2)
"RTN","GMTSPXOP",69,0)
 . S GMTSICD=$P(GMTSN,U) D GETICDDX^GMTSPXU1(.GMTSICD,$G(GMPXICDF),GMTSMOD)
"RTN","GMTSPXOP",70,0)
 . S GMTSNARR=""
"RTN","GMTSPXOP",71,0)
 . S:$G(GMPXNARR)'="N" GMTSNARR=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",GMTSPDN,"N"))
"RTN","GMTSPXOP",72,0)
 . I $P(GMTSICD,"-",2,10)=$G(GMTSNARR) S GMTSNARR=""
"RTN","GMTSPXOP",73,0)
 . S GMTSPRI="" I $P(GMTSN,U,5)]"",$E($P(GMTSN,U,5),1)="P" S GMTSPRI=" (P)"
"RTN","GMTSPXOP",74,0)
 . D TXTFMT^GMTSPXU1(GMTSICD,$G(GMTSNARR),GMTSICL,GMTAB,DIWL,GMTSQTY,GMTSPRI)
"RTN","GMTSPXOP",75,0)
 . I '$D(^UTILITY($J,"W")) Q
"RTN","GMTSPXOP",76,0)
 . S GMTSX=0
"RTN","GMTSPXOP",77,0)
 . F  S GMTSX=$O(^UTILITY($J,"W",DIWL,GMTSX)) Q:GMTSX'>0!$D(GMTSQIT)  D
"RTN","GMTSPXOP",78,0)
 . . I GMCKP>0 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS
"RTN","GMTSPXOP",79,0)
 . . S GMCKP=1
"RTN","GMTSPXOP",80,0)
 . . W ?GMTSICL+$S(GMTSX>1:GMTAB,1:0),$G(^UTILITY($J,"W",DIWL,GMTSX,0)),!
"RTN","GMTSPXOP",81,0)
 . S COMMENT="",COMMENT=$P($G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"D",GMTSPDN,"COM")),U)
"RTN","GMTSPXOP",82,0)
 . I COMMENT]"" S GMICL=20,GMTAB=2 D FORMAT I $D(^UTILITY($J,"W")) D
"RTN","GMTSPXOP",83,0)
 . . F GMTSLN=1:1:^UTILITY($J,"W",DIWL) D LINE Q:$D(GMTSQIT)
"RTN","GMTSPXOP",84,0)
 Q
"RTN","GMTSPXOP",85,0)
DSPCPT ; Display Procedures performed during the visit
"RTN","GMTSPXOP",86,0)
 Q:$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",""))=""
"RTN","GMTSPXOP",87,0)
 N GMTSNARR,GMTSPDN,GMTSN,GMTSICD,GMTSNARR,GMTSCPT,GMTSQTY,GMTSPRIM,GMTSPRI
"RTN","GMTSPXOP",88,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS W ?3,"Procedure:"
"RTN","GMTSPXOP",89,0)
 S GMCKP=0,GMTSPDN="",GMTSPRI=""
"RTN","GMTSPXOP",90,0)
 F  S GMTSPDN=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",GMTSPDN)) Q:GMTSPDN'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXOP",91,0)
 . S GMTSN=$G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",GMTSPDN))
"RTN","GMTSPXOP",92,0)
 . S GMTSNARR=$P(GMTSN,U,2),GMTSQTY=$P(GMTSN,U,3),GMTSPRIM=$P(GMTSN,U,4)
"RTN","GMTSPXOP",93,0)
 . S GMTSCPT=$$GETCPT^GMTSPXU1($P(GMTSN,U)) I $P(GMTSCPT,"-",2,10)=GMTSNARR S GMTSNARR=""
"RTN","GMTSPXOP",94,0)
 . S GMTSPRI="" S:$G(GMTSQTY)]"" GMTSQTY=" ("_GMTSQTY_")" S:$G(GMTSPRIM)="Y" GMTSPRI="(P)"
"RTN","GMTSPXOP",95,0)
 . D TXTFMT^GMTSPXU1(GMTSCPT,GMTSNARR,GMTSICL,GMTAB,DIWL,GMTSQTY,GMTSPRI)
"RTN","GMTSPXOP",96,0)
 . Q:'$D(^UTILITY($J,"W"))  D DCPT
"RTN","GMTSPXOP",97,0)
 Q
"RTN","GMTSPXOP",98,0)
DCPT ; Display CPT Comments
"RTN","GMTSPXOP",99,0)
 N GMTSLN,GMTSMOK,GMTSX S (GMTSMOK,GMTSX)=0
"RTN","GMTSPXOP",100,0)
 F  S GMTSX=$O(^UTILITY($J,"W",DIWL,GMTSX)) Q:GMTSX'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSPXOP",101,0)
 . I GMCKP>0 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS Q:$D(GMTSQIT)
"RTN","GMTSPXOP",102,0)
 . S (GMTSMOK,GMCKP)=1 W ?GMTSICL+$S(GMTSX>1:GMTAB,1:0)
"RTN","GMTSPXOP",103,0)
 . W $G(^UTILITY($J,"W",DIWL,GMTSX,0))
"RTN","GMTSPXOP",104,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPXOP",105,0)
 Q:DTYPE="DP"
"RTN","GMTSPXOP",106,0)
 S COMMENT=$P($G(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",GMTSPDN,"COM")),U)
"RTN","GMTSPXOP",107,0)
 I COMMENT]"" W !,COMMENT,! S GMICL=20,GMTAB=2 D FORMAT I $D(^UTILITY($J,"W")) D
"RTN","GMTSPXOP",108,0)
 . F GMTSLN=1:1:^UTILITY($J,"W",DIWL) D LINE Q:$D(GMTSQIT)
"RTN","GMTSPXOP",109,0)
 S:+($G(GMTSCPTM))=0 GMTSMOK=0 D:GMTSMOK DMOD
"RTN","GMTSPXOP",110,0)
 Q
"RTN","GMTSPXOP",111,0)
DMOD ; Display CPT Modifier Comments
"RTN","GMTSPXOP",112,0)
 N GMTSM,GMTSI S GMTSM=""
"RTN","GMTSPXOP",113,0)
 F  S GMTSM=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"C",GMTSPDN,GMTSM)) Q:GMTSM=""  D  Q:$D(GMTSQIT)
"RTN","GMTSPXOP",114,0)
 . S GMTSI=$$MODI(GMTSM) Q:GMTSI'>0  N COMMENT S COMMENT=$$FCM(+GMTSI) Q:'$L(COMMENT)
"RTN","GMTSPXOP",115,0)
 . S GMICL=26,GMTAB=2 D FORMAT I $D(^UTILITY($J,"W")) D
"RTN","GMTSPXOP",116,0)
 . . F GMTSLN=1:1:^UTILITY($J,"W",DIWL) D LINE2 Q:$D(GMTSQIT)
"RTN","GMTSPXOP",117,0)
 Q
"RTN","GMTSPXOP",118,0)
MODI(X) ; CPT Modifer IEN
"RTN","GMTSPXOP",119,0)
 N DIC,Y,DTOUT,DUOUT S X=$G(X) Q:'$L(X) 0
"RTN","GMTSPXOP",120,0)
 S DIC="^DIC(81.3,",DIC(0)="B" D ^DIC S X=+($G(Y)) Q X
"RTN","GMTSPXOP",121,0)
DSPPROV ; Display Providers for visit
"RTN","GMTSPXOP",122,0)
 Q:$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"P",""))=""
"RTN","GMTSPXOP",123,0)
 N GMCNT,GMPROV
"RTN","GMTSPXOP",124,0)
 D ORDERPRO^GMTSPXU1(.GMPROV,20)
"RTN","GMTSPXOP",125,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS W ?3," Provider:"
"RTN","GMTSPXOP",126,0)
 S GMCNT=0
"RTN","GMTSPXOP",127,0)
 F  S GMCNT=$O(GMPROV(GMCNT)) Q:GMCNT'>0  D  Q:GMCNT'>0!$D(GMTSQIT)
"RTN","GMTSPXOP",128,0)
 . I GMCNT>1 D CKP^GMTSUP Q:$D(GMTSQIT)  D DSPVIS
"RTN","GMTSPXOP",129,0)
 . W ?GMTSICL,GMPROV(GMCNT) S GMCNT=$O(GMPROV(GMCNT)) Q:GMCNT'>0
"RTN","GMTSPXOP",130,0)
 . W ?37,GMPROV(GMCNT) S GMCNT=$O(GMPROV(GMCNT)) Q:GMCNT'>0
"RTN","GMTSPXOP",131,0)
 . W ?60,GMPROV(GMCNT)
"RTN","GMTSPXOP",132,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W:$O(GMPROV(GMCNT)) !
"RTN","GMTSPXOP",133,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPXOP",134,0)
 Q
"RTN","GMTSPXOP",135,0)
DSPVIS ; Display outpatient visit data
"RTN","GMTSPXOP",136,0)
 Q:GMTSNPG'>0&(GMTSDTU>0)  D:GMTSNPG HDR I GMTSNPG!(+GMTSDTU'>0) D
"RTN","GMTSPXOP",137,0)
 . W GMTSDAT,?14,GMTSITE,?29,GMTSLOC,?61,GMTSELIG
"RTN","GMTSPXOP",138,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPXOP",139,0)
 . S GMTSDTU=1
"RTN","GMTSPXOP",140,0)
 Q
"RTN","GMTSPXOP",141,0)
HDR ; Display header
"RTN","GMTSPXOP",142,0)
 W ?3,"Date"
"RTN","GMTSPXOP",143,0)
 W ?14,"Facility"
"RTN","GMTSPXOP",144,0)
 W ?29,"Hospital Location"
"RTN","GMTSPXOP",145,0)
 W ?61,"Encounter Elig."
"RTN","GMTSPXOP",146,0)
 W !!
"RTN","GMTSPXOP",147,0)
 Q
"RTN","GMTSPXOP",148,0)
FORMAT ; Formats Diagnosis/Procedure line of text
"RTN","GMTSPXOP",149,0)
 N DIWR,DIWF,X S DIWL=3,DIWR=80-(GMICL+GMTAB) K ^UTILITY($J,"W")
"RTN","GMTSPXOP",150,0)
 S X=COMMENT
"RTN","GMTSPXOP",151,0)
 ; DBIA 10011 call ^DIWP
"RTN","GMTSPXOP",152,0)
 D ^DIWP
"RTN","GMTSPXOP",153,0)
 Q
"RTN","GMTSPXOP",154,0)
FCM(X) ; Format CPT Modifier comment
"RTN","GMTSPXOP",155,0)
 S X=+($G(X)) Q:X=0 ""
"RTN","GMTSPXOP",156,0)
 N GMTSC,GMTSS,GMTST
"RTN","GMTSPXOP",157,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSPXOP",158,0)
 S GMTSC=$$GET1^DIQ(81.3,+X,.01,"E")
"RTN","GMTSPXOP",159,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSPXOP",160,0)
 S GMTSS=$$GET1^DIQ(81.3,+X,.02,"E")
"RTN","GMTSPXOP",161,0)
 S GMTST=$$EN2^GMTSUMX(GMTSS)
"RTN","GMTSPXOP",162,0)
 S X="" S:$L(GMTST)&($L(GMTSC)) X=GMTSC_"-"_GMTST
"RTN","GMTSPXOP",163,0)
 S:'$L(GMTST)&($L(GMTSS))&($L(GMTSC)) X=GMTSC_"-"_GMTSS
"RTN","GMTSPXOP",164,0)
 S:'$L(GMTST)&('$L(GMTSS))&($L(GMTSC)) X=GMTSC
"RTN","GMTSPXOP",165,0)
 S:X["-" X="Modifier "_X Q X
"RTN","GMTSPXOP",166,0)
LINE ; Writes formatted lines
"RTN","GMTSPXOP",167,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXOP",168,0)
 W ?20,^UTILITY($J,"W",DIWL,GMTSLN,0),! Q
"RTN","GMTSPXOP",169,0)
LINE2 ; Writes indented formatted lines
"RTN","GMTSPXOP",170,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSPXOP",171,0)
 N GMTST S GMTST=20 S:+($G(GMTSLN))>1 GMTST=31
"RTN","GMTSPXOP",172,0)
 W ?GMTST,^UTILITY($J,"W",DIWL,GMTSLN,0),! Q
"RTN","GMTSPXU1")
0^10^B9810010
"RTN","GMTSPXU1",1,0)
GMTSPXU1 ; SLC/SBW - PCE Utilites sub-routines ; 07/18/2000
"RTN","GMTSPXU1",2,0)
 ;;2.7;Health Summary;**10,37**;Oct 20, 1995
"RTN","GMTSPXU1",3,0)
 ;
"RTN","GMTSPXU1",4,0)
GETICDDX(GMTSICD,GMTSICF,GMMOD) ; Entry point to get ICD9 data
"RTN","GMTSPXU1",5,0)
 N DIC,DIQ,DR,DA,REC,CODE,NAME,DESC
"RTN","GMTSPXU1",6,0)
 S DIC=80,DA=GMTSICD,DIQ="REC(",DIQ(0)="IE",DR=".01;3;10"
"RTN","GMTSPXU1",7,0)
 ; DBIA 10015 call EN^DIQ1
"RTN","GMTSPXU1",8,0)
 D EN^DIQ1
"RTN","GMTSPXU1",9,0)
 Q:'$D(REC)
"RTN","GMTSPXU1",10,0)
 S CODE=REC(80,DA,.01,"I")
"RTN","GMTSPXU1",11,0)
 S NAME=REC(80,DA,3,"E")
"RTN","GMTSPXU1",12,0)
 S DESC=REC(80,DA,10,"E")
"RTN","GMTSPXU1",13,0)
 S:GMTSICF="L"!(GMTSICF="") GMTSICD=CODE_"-"_DESC
"RTN","GMTSPXU1",14,0)
 S:GMTSICF="S" GMTSICD=CODE_"-"_NAME
"RTN","GMTSPXU1",15,0)
 S:GMTSICF="C" GMTSICD=CODE
"RTN","GMTSPXU1",16,0)
 S:GMTSICF="T" GMTSICD=DESC
"RTN","GMTSPXU1",17,0)
 I $G(GMMOD)]"" S GMMOD=$P(GMMOD,","),GMTSICD=GMMOD_" "_GMTSICD
"RTN","GMTSPXU1",18,0)
 S:GMTSICF="N" GMTSICD=""
"RTN","GMTSPXU1",19,0)
 Q
"RTN","GMTSPXU1",20,0)
 ;
"RTN","GMTSPXU1",21,0)
GETICDOP ; Entry point to get ICD0 data
"RTN","GMTSPXU1",22,0)
 N DIC,DIQ,DR,DA,REC,CODE,NAME,DESC
"RTN","GMTSPXU1",23,0)
 S DIC=80.1,DA=GMTSICD,DIQ="REC(",DIQ(0)="IE",DR=".01;4;10"
"RTN","GMTSPXU1",24,0)
 ; DBIA 10015 call EN^DIQ1
"RTN","GMTSPXU1",25,0)
 D EN^DIQ1
"RTN","GMTSPXU1",26,0)
 Q:'$D(REC)
"RTN","GMTSPXU1",27,0)
 S CODE=REC(80.1,DA,.01,"I")
"RTN","GMTSPXU1",28,0)
 S NAME=REC(80.1,DA,4,"E")
"RTN","GMTSPXU1",29,0)
 S DESC=REC(80.1,DA,10,"E")
"RTN","GMTSPXU1",30,0)
 S:GMTSICF="L"!(GMTSICF="") GMTSICD=CODE_"-"_DESC
"RTN","GMTSPXU1",31,0)
 S:GMTSICF="S" GMTSICD=CODE_"-"_NAME
"RTN","GMTSPXU1",32,0)
 S:GMTSICF="C" GMTSICD=CODE
"RTN","GMTSPXU1",33,0)
 S:GMTSICF="T" GMTSICD=DESC
"RTN","GMTSPXU1",34,0)
 S:GMTSICF="N" GMTSICD=""
"RTN","GMTSPXU1",35,0)
 Q
"RTN","GMTSPXU1",36,0)
 ;
"RTN","GMTSPXU1",37,0)
GETCPT(GMTSCPT) ; Entry point to get CPT data
"RTN","GMTSPXU1",38,0)
 N DIC,DIQ,DR,DA,REC
"RTN","GMTSPXU1",39,0)
 S DIC=81,DA=GMTSCPT,DIQ="REC(",DIQ(0)="IE",DR=".01;2"
"RTN","GMTSPXU1",40,0)
 ; DBIA 10015 call EN^DIQ1
"RTN","GMTSPXU1",41,0)
 D EN^DIQ1
"RTN","GMTSPXU1",42,0)
 Q:'$D(REC) ""
"RTN","GMTSPXU1",43,0)
 Q REC(81,DA,.01,"I")_"-"_REC(81,DA,2,"E")
"RTN","GMTSPXU1",44,0)
 ;
"RTN","GMTSPXU1",45,0)
TXTFMT(GMTSICD,GMTSNARR,GMICL,GMTAB,DIWL,GMTSQTY,GMTSPRIM) ; Formats GMTSICD & GMTSNARR together
"RTN","GMTSPXU1",46,0)
 I GMTSICD="",GMTSNARR="" Q
"RTN","GMTSPXU1",47,0)
 N DIWR,DIWF,X
"RTN","GMTSPXU1",48,0)
 S DIWR=80-(GMICL+GMTAB)
"RTN","GMTSPXU1",49,0)
 K ^UTILITY($J,"W")
"RTN","GMTSPXU1",50,0)
 I $G(GMTSICD)]"" S X=GMTSICD S:$G(GMTSNARR)]"" X=X_"; "
"RTN","GMTSPXU1",51,0)
 I $G(GMTSNARR)]"" S X=$G(X)_GMTSNARR D
"RTN","GMTSPXU1",52,0)
 . I $G(GMTSPRIM)]"" S X=X_GMTSPRIM
"RTN","GMTSPXU1",53,0)
 . I $G(GMTSQTY)]"" S X=X_GMTSQTY
"RTN","GMTSPXU1",54,0)
 . ; DBIA 10011 call ^DIWP
"RTN","GMTSPXU1",55,0)
 . D ^DIWP
"RTN","GMTSPXU1",56,0)
 I $G(GMTSNARR)']"" D
"RTN","GMTSPXU1",57,0)
 . I $G(GMTSQTY)]"" S X=$G(X)_GMTSQTY
"RTN","GMTSPXU1",58,0)
 . I $G(GMTSPRIM)]"" S X=X_GMTSPRIM
"RTN","GMTSPXU1",59,0)
 . ; DBIA 10011 call ^DIWP
"RTN","GMTSPXU1",60,0)
 . D ^DIWP
"RTN","GMTSPXU1",61,0)
 Q
"RTN","GMTSPXU1",62,0)
 ;
"RTN","GMTSPXU1",63,0)
ORDERPRO(GMPROV,GMLEN) ; Re-order and format providers for visit
"RTN","GMTSPXU1",64,0)
 N GMCNT,GMTSP,GMNODE,GMP
"RTN","GMTSPXU1",65,0)
 S GMCNT=0
"RTN","GMTSPXU1",66,0)
 F GMP="P","S","Z" S GMTSP="" F  S GMTSP=$O(^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"P",GMP,GMTSP)) Q:GMTSP'>0  D
"RTN","GMTSPXU1",67,0)
 . S GMNODE=^TMP("PXHSV",$J,GMTSIVD,GMTSVDF,"P",GMP,GMTSP)
"RTN","GMTSPXU1",68,0)
 . Q:GMNODE']""
"RTN","GMTSPXU1",69,0)
 . S GMCNT=GMCNT+1
"RTN","GMTSPXU1",70,0)
 . S GMPROV(GMCNT)=$E($P(GMNODE,U),1,GMLEN-4)_$S(GMP="P"!(GMP="S"):" ("_GMP_")",1:"")
"RTN","GMTSPXU1",71,0)
 Q
"RTN","GMTSPXU1",72,0)
 ;
"RTN","GMTSPXU1",73,0)
 ; The following code segments are called from "ROUTINE" type
"RTN","GMTSPXU1",74,0)
 ; Menu Options to display items in a file
"RTN","GMTSPXU1",75,0)
 ;
"RTN","GMTSPXU1",76,0)
LM ; Entry Point - for GMTS Measurement Panel
"RTN","GMTSPXU1",77,0)
 S GMTSLST="^GMT(142.7," G DSPLST
"RTN","GMTSPXU1",78,0)
 ;
"RTN","GMTSPXU1",79,0)
DSPLST ; Common code for Health Summary MNX Lists
"RTN","GMTSPXU1",80,0)
 K DIR
"RTN","GMTSPXU1",81,0)
 I '$D(@(GMTSLST_"""B"")")) W !,"NO ",$P(@(GMTSLST_"0)"),U),"S DEFINED.",! Q
"RTN","GMTSPXU1",82,0)
 W @IOF,!!,"Existing ",$P(@(GMTSLST_"0)"),U),"S:",! S GMTSCNT=""
"RTN","GMTSPXU1",83,0)
CONT F  S GMTSCNT=$O(@(GMTSLST_"""B"",GMTSCNT)")) Q:GMTSCNT=""  D  G:1'[$G(Y)&($L($G(Y))) QUIT
"RTN","GMTSPXU1",84,0)
 . N DIR K Y W !,?5,GMTSCNT I (IOSL-3)<$Y S DIR(0)="E" D
"RTN","GMTSPXU1",85,0)
 . . ; DBIA 10026 call ^DIR
"RTN","GMTSPXU1",86,0)
 . . D ^DIR W @IOF
"RTN","GMTSPXU1",87,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSPXU1",88,0)
 K DIR S DIR(0)="E" D ^DIR W !
"RTN","GMTSPXU1",89,0)
QUIT K DIR,X,Y,GMTSLST,GMTSCNT
"RTN","GMTSPXU1",90,0)
 Q
"RTN","GMTSRAE")
0^22^B59484513
"RTN","GMTSRAE",1,0)
GMTSRAE ;SLC/JER HIN/GJC Selected Radiology Extract ; 07/18/2000
"RTN","GMTSRAE",2,0)
 ;;2.7;Health Summary;**14,25,30,37**;Oct 20, 1995
"RTN","GMTSRAE",3,0)
 ;
"RTN","GMTSRAE",4,0)
MAINSEL(MODE,TEST) ; Controls branching and execution for components with
"RTN","GMTSRAE",5,0)
 ; selection items
"RTN","GMTSRAE",6,0)
 N GMTSIDT,GMTSCNT,GMTSPN,GMTSMAX
"RTN","GMTSRAE",7,0)
 S GMTSMAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
"RTN","GMTSRAE",8,0)
 K ^TMP("RAE",$J)
"RTN","GMTSRAE",9,0)
 S GMTSCNT=0,GMTSIDT=GMTS1+.9999,GMTS2=GMTS2+.9999
"RTN","GMTSRAE",10,0)
 ; DBIA 3125 access ^RADPT (file 70)
"RTN","GMTSRAE",11,0)
 F  S GMTSIDT=$O(^RADPT(DFN,"DT","AP",TEST,GMTSIDT)) Q:GMTSIDT'>0!(GMTSIDT>GMTS2)!(GMTSCNT=GMTSMAX)  D
"RTN","GMTSRAE",12,0)
 . Q:'$D(^RADPT(DFN,"DT",GMTSIDT,0))  ; missing data node, quit
"RTN","GMTSRAE",13,0)
 . N GMTS7002,GMTSPSET,GMTSXSET
"RTN","GMTSRAE",14,0)
 . S GMTS7002=$G(^RADPT(DFN,"DT",GMTSIDT,0))
"RTN","GMTSRAE",15,0)
 . ; Exam Set
"RTN","GMTSRAE",16,0)
 . S GMTSXSET=+$P(GMTS7002,"^",5)
"RTN","GMTSRAE",17,0)
 . S GMTSPN=0 F  S GMTSPN=$O(^RADPT(DFN,"DT","AP",TEST,GMTSIDT,GMTSPN)) Q:GMTSPN'>0!(GMTSCNT=GMTSMAX)  D
"RTN","GMTSRAE",18,0)
 . . S GMTSCNT=GMTSCNT+1 D GET
"RTN","GMTSRAE",19,0)
 Q
"RTN","GMTSRAE",20,0)
MAIN(MODE) ; Controls branching and execution
"RTN","GMTSRAE",21,0)
 N GMTSIDT,GMTSCNT,GMTSPN,GMTSMAX
"RTN","GMTSRAE",22,0)
 S GMTSMAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
"RTN","GMTSRAE",23,0)
 K ^TMP("RAE",$J)
"RTN","GMTSRAE",24,0)
 S GMTSCNT=0,GMTSIDT=GMTS1+.9999,GMTS2=GMTS2+.9999
"RTN","GMTSRAE",25,0)
 ; DBIA 3125 access ^RADPT (file 70)
"RTN","GMTSRAE",26,0)
 F  S GMTSIDT=$O(^RADPT(DFN,"DT",GMTSIDT)) Q:GMTSIDT'>0!(GMTSIDT>GMTS2)!(GMTSCNT=GMTSMAX)  D
"RTN","GMTSRAE",27,0)
 . Q:'$D(^RADPT(DFN,"DT",GMTSIDT,0))  ; missing data node, quit
"RTN","GMTSRAE",28,0)
 . N GMTS7002,GMTSPSET,GMTSXSET
"RTN","GMTSRAE",29,0)
 . S GMTS7002=$G(^RADPT(DFN,"DT",GMTSIDT,0))
"RTN","GMTSRAE",30,0)
 . ; Exam Set
"RTN","GMTSRAE",31,0)
 . S GMTSXSET=+$P(GMTS7002,"^",5)
"RTN","GMTSRAE",32,0)
 . S GMTSPN=0 F  S GMTSPN=$O(^RADPT(DFN,"DT",GMTSIDT,"P",GMTSPN)) Q:GMTSPN'>0!(GMTSCNT=GMTSMAX)  D
"RTN","GMTSRAE",33,0)
 . . S GMTSCNT=GMTSCNT+1 D GET
"RTN","GMTSRAE",34,0)
 Q
"RTN","GMTSRAE",35,0)
GET ; Gets data associated with study and sets ^TMP("RAE",$J,
"RTN","GMTSRAE",36,0)
 ; global variable definitions:
"RTN","GMTSRAE",37,0)
 ; where: 
"RTN","GMTSRAE",38,0)
 ;          GMTSIDT = reverse exam date/time
"RTN","GMTSRAE",39,0)
 ;          GMTSPN    = case ien
"RTN","GMTSRAE",40,0)
 ;
"RTN","GMTSRAE",41,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,0)= <exam date> ^ <procedure> ^
"RTN","GMTSRAE",42,0)
 ;                                  <exam status> ^ <report status> ^
"RTN","GMTSRAE",43,0)
 ;                                  <prim interpreting resident> ^
"RTN","GMTSRAE",44,0)
 ;                                  <primary interpreting staff> ^
"RTN","GMTSRAE",45,0)
 ;                                  <CPT code> ^ <technologist> ^
"RTN","GMTSRAE",46,0)
 ;                                  <case number>
"RTN","GMTSRAE",47,0)
 ;
"RTN","GMTSRAE",48,0)
 ; ^TMP("RAE",$J,GMTSIDT,"EXAMSET")
"RTN","GMTSRAE",49,0)
 ;
"RTN","GMTSRAE",50,0)
 ;      Indicates if all exams for this 
"RTN","GMTSRAE",51,0)
 ;      date/time are part of an exam set
"RTN","GMTSRAE",52,0)
 ;
"RTN","GMTSRAE",53,0)
 ; ^TMP("RAE",$J,GMTSIDT,"PRINTSET")
"RTN","GMTSRAE",54,0)
 ;
"RTN","GMTSRAE",55,0)
 ;      Indicates if all exams for this
"RTN","GMTSRAE",56,0)
 ;      exam set share the same report
"RTN","GMTSRAE",57,0)
 ;
"RTN","GMTSRAE",58,0)
 ; Only if the report is verified 
"RTN","GMTSRAE",59,0)
 ; -OR-
"RTN","GMTSRAE",60,0)
 ; released will these nodes be set
"RTN","GMTSRAE",61,0)
 ;
"RTN","GMTSRAE",62,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,"D",seq #) = Dx codes (seq # = 1: Pri. Dx)
"RTN","GMTSRAE",63,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,"D",seq #) = Dx codes (seq # > 1: Sec. Dx)
"RTN","GMTSRAE",64,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,"H",line #)= Clinical History line #
"RTN","GMTSRAE",65,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",line #)= Impression Text line #
"RTN","GMTSRAE",66,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,"R",line #)= Report Text line #
"RTN","GMTSRAE",67,0)
 ;
"RTN","GMTSRAE",68,0)
 ; Fileman
"RTN","GMTSRAE",69,0)
 N %,D0,DA,DIC,DIQ,DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,DR
"RTN","GMTSRAE",70,0)
 N GMTSCPT,GMTSED,GMTSCN,GMTSRP,GMTSRPI,GMTSST,GMTSPTR,GMTSTA
"RTN","GMTSRAE",71,0)
 N GMTSTAI,GMTSI,GMTSRAD,GMTSRRAD,GMTSSRAD,GMTSTC
"RTN","GMTSRAE",72,0)
 ; Exam Date
"RTN","GMTSRAE",73,0)
 S GMTSED=+$P(GMTS7002,"^")
"RTN","GMTSRAE",74,0)
 ; Exam Set
"RTN","GMTSRAE",75,0)
 S:GMTSXSET&('$D(^TMP("RAE",$J,GMTSIDT,"EXAMSET"))) ^TMP("RAE",$J,GMTSIDT,"EXAMSET")=""
"RTN","GMTSRAE",76,0)
 S DIC="^RADPT("_DFN_",""DT"","_GMTSIDT_",""P"",",DA=GMTSPN,DIQ="GMTSRAD("
"RTN","GMTSRAE",77,0)
 ; Get
"RTN","GMTSRAE",78,0)
 ;       Case Number                      .01   GMTSCN
"RTN","GMTSRAE",79,0)
 ;       Procedure                         2    GMTSRP/GMTSRPI
"RTN","GMTSRAE",80,0)
 ;       Exam Status                       3    GMTSST
"RTN","GMTSRAE",81,0)
 ;       Primary Interpreting Resident    12    GMTSRRAD
"RTN","GMTSRAE",82,0)
 ;       Primary Diagnostic Code          13    GMTSDX
"RTN","GMTSRAE",83,0)
 ;       Primary Interpreting Staff       15    GMTSSRAD
"RTN","GMTSRAE",84,0)
 ;       Report Text                      17    
"RTN","GMTSRAE",85,0)
 ;       Member of Set                    25
"RTN","GMTSRAE",86,0)
 ;
"RTN","GMTSRAE",87,0)
 S DIQ(0)="IE",DR=".01;2;3;12;13;15;17;25" D TECH
"RTN","GMTSRAE",88,0)
 ; DBIA 10015 call EN^DIQ1
"RTN","GMTSRAE",89,0)
 D EN^DIQ1
"RTN","GMTSRAE",90,0)
 S GMTSCN=$G(GMTSRAD(70.03,GMTSPN,.01,"E"))
"RTN","GMTSRAE",91,0)
 S GMTSRP=$G(GMTSRAD(70.03,GMTSPN,2,"E"))
"RTN","GMTSRAE",92,0)
 S GMTSRPI=$G(GMTSRAD(70.03,GMTSPN,2,"I"))
"RTN","GMTSRAE",93,0)
 S GMTSST=$G(GMTSRAD(70.03,GMTSPN,3,"E"))
"RTN","GMTSRAE",94,0)
 I GMTSTC S GMTSTC(0)=$E($G(GMTSRAD(70.12,GMTSTC,.01,"E")),1,18)
"RTN","GMTSRAE",95,0)
 S GMTSRRAD=$E($G(GMTSRAD(70.03,GMTSPN,12,"E")),1,18)
"RTN","GMTSRAE",96,0)
 S GMTSSRAD=$E($G(GMTSRAD(70.03,GMTSPN,15,"E")),1,18)
"RTN","GMTSRAE",97,0)
 S GMTSPTR=$G(GMTSRAD(70.03,GMTSPN,17,"I"))
"RTN","GMTSRAE",98,0)
 ;
"RTN","GMTSRAE",99,0)
 ; Exam Set/Report
"RTN","GMTSRAE",100,0)
 ;
"RTN","GMTSRAE",101,0)
 ;     If GMTSPSET = ""   single exam
"RTN","GMTSRAE",102,0)
 ;     If GMTSPSET = 1    exam set, single report
"RTN","GMTSRAE",103,0)
 ;     If GMTSPSET = 2    exam set, combined report
"RTN","GMTSRAE",104,0)
 ;
"RTN","GMTSRAE",105,0)
 S GMTSPSET=$G(GMTSRAD(70.03,GMTSPN,25,"I"))
"RTN","GMTSRAE",106,0)
 ; Procedure/CPT Modifiers
"RTN","GMTSRAE",107,0)
 D PMOD,CMOD
"RTN","GMTSRAE",108,0)
 ; Report Status                     5
"RTN","GMTSRAE",109,0)
 I +GMTSPTR>0 S DIC="^RARPT(",DA=GMTSPTR,DIQ="GMTSRAD(",DIQ(0)="IE",DR="5" D
"RTN","GMTSRAE",110,0)
 . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSRAE",111,0)
 . D EN^DIQ1
"RTN","GMTSRAE",112,0)
 S GMTSTA=$G(GMTSRAD(74,+GMTSPTR,5,"E"))
"RTN","GMTSRAE",113,0)
 S GMTSTAI=$G(GMTSRAD(74,+GMTSPTR,5,"I"))
"RTN","GMTSRAE",114,0)
 I $L(GMTSTAI),("VR"[$E(GMTSTAI)) D GETDX(GMTSPN_","_GMTSIDT_","_DFN_",")
"RTN","GMTSRAE",115,0)
 ; CPT Code (Internal)
"RTN","GMTSRAE",116,0)
 ; DBIA 2056 call GET1^DIQ
"RTN","GMTSRAE",117,0)
 S GMTSCPT=$$GET1^DIQ(71,+GMTSRPI,9,"I")
"RTN","GMTSRAE",118,0)
 ; DBIA 1995 call $$CPT^ICPTCOD
"RTN","GMTSRAE",119,0)
 ; CPT Code (External)
"RTN","GMTSRAE",120,0)
 S GMTSCPT=$S(+GMTSCPT>0:$P($$CPT^ICPTCOD(+GMTSCPT),"^",2),1:"")
"RTN","GMTSRAE",121,0)
 S ^TMP("RAE",$J,GMTSIDT,GMTSPN,0)=GMTSED_U_GMTSRP_U_GMTSST_U_GMTSTA_U_GMTSRRAD_U_GMTSSRAD_U_GMTSCPT_U_$G(GMTSTC(0))_U_GMTSCN
"RTN","GMTSRAE",122,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSRAD(70.1,GMTSI)) Q:+GMTSI'>0  D
"RTN","GMTSRAE",123,0)
 . S ^TMP("RAE",$J,GMTSIDT,GMTSPN,"M",GMTSI)=$G(GMTSRAD(70.1,GMTSI,.01,"E"))
"RTN","GMTSRAE",124,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSRAD(70.1,GMTSI)) Q:+GMTSI'>0  D
"RTN","GMTSRAE",125,0)
 . S ^TMP("RAE",$J,GMTSIDT,GMTSPN,"M",GMTSI)=$G(GMTSRAD(70.1,GMTSI,.01,"E"))
"RTN","GMTSRAE",126,0)
 ;
"RTN","GMTSRAE",127,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSRAD(70.3135,GMTSI)) Q:+GMTSI'>0  D
"RTN","GMTSRAE",128,0)
 . Q:'$L($G(GMTSRAD(70.3135,GMTSI,.01,"M")))  Q:'$L($G(GMTSRAD(70.3135,GMTSI,.01,"N")))  N I S I=+($G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",0)))+1
"RTN","GMTSRAE",129,0)
 . S ^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",I)=$G(GMTSRAD(70.3135,GMTSI,.01,"M"))_"^"_$$UP^XLFSTR($G(GMTSRAD(70.3135,GMTSI,.01,"N")))_"^"_$G(GMTSRAD(70.3135,GMTSI,.01,"N")),^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",0)=I
"RTN","GMTSRAE",130,0)
 ;
"RTN","GMTSRAE",131,0)
 ; Only verified reports can be printed
"RTN","GMTSRAE",132,0)
 I GMTSTAI'="V",($E(IOST)="P") D  Q
"RTN","GMTSRAE",133,0)
 . S:GMTSPSET=2 ^TMP("RAE",$J,GMTSIDT,"PRINTSET")=""
"RTN","GMTSRAE",134,0)
 ;
"RTN","GMTSRAE",135,0)
 ; Only verified and Released/Unverified can be seen on the terminal
"RTN","GMTSRAE",136,0)
 I $S(GMTSTAI="V":0,GMTSTAI="R":0,1:1) D  Q
"RTN","GMTSRAE",137,0)
 . S:GMTSPSET=2 ^TMP("RAE",$J,GMTSIDT,"PRINTSET")=""
"RTN","GMTSRAE",138,0)
 ;
"RTN","GMTSRAE",139,0)
 ; Print set, same report
"RTN","GMTSRAE",140,0)
 Q:$D(^TMP("RAE",$J,GMTSIDT,"PRINTSET"))
"RTN","GMTSRAE",141,0)
 ; Impression, History and Report
"RTN","GMTSRAE",142,0)
 D GETIMP D:$G(MODE)=2 GETHIS,GETREP
"RTN","GMTSRAE",143,0)
 ; Print Set
"RTN","GMTSRAE",144,0)
 S:GMTSPSET=2 ^TMP("RAE",$J,GMTSIDT,"PRINTSET")=""
"RTN","GMTSRAE",145,0)
 Q
"RTN","GMTSRAE",146,0)
GETIMP ; Gets Radiologist's Impression
"RTN","GMTSRAE",147,0)
 ; DBIA 501 access ^RARPT (file 74)
"RTN","GMTSRAE",148,0)
 ; DBIA 2056 call GET1^DIQ
"RTN","GMTSRAE",149,0)
 N X,GMTSLN S X=$$GET1^DIQ(74,GMTSPTR,300,,"GMTST")
"RTN","GMTSRAE",150,0)
 K ^UTILITY($J,"W") N X,GMTSI S GMTSI=0 F  S GMTSI=$O(GMTST(GMTSI)) Q:+GMTSI=0  S X=$G(GMTST(GMTSI)) D FORMAT
"RTN","GMTSRAE",151,0)
 I $D(^UTILITY($J,"W")) F GMTSLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",GMTSLN)=^UTILITY($J,"W",3,GMTSLN,0)
"RTN","GMTSRAE",152,0)
 K ^UTILITY($J,"W"),GMTST Q
"RTN","GMTSRAE",153,0)
GETHIS ; Gets Clinical History
"RTN","GMTSRAE",154,0)
 ; DBIA 501 access ^RARPT (file 74)
"RTN","GMTSRAE",155,0)
 ; DBIA 2056 call GET1^DIQ
"RTN","GMTSRAE",156,0)
 N X,GMTSLN S X=$$GET1^DIQ(74,GMTSPTR,400,,"GMTST")
"RTN","GMTSRAE",157,0)
 K ^UTILITY($J,"W") N X,GMTSI S GMTSI=0 F  S GMTSI=$O(GMTST(GMTSI)) Q:+GMTSI=0  S X=$G(GMTST(GMTSI)) D FORMAT
"RTN","GMTSRAE",158,0)
 I $D(^UTILITY($J,"W")) F GMTSLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMTSIDT,GMTSPN,"H",GMTSLN)=^UTILITY($J,"W",3,GMTSLN,0)
"RTN","GMTSRAE",159,0)
 K ^UTILITY($J,"W"),GMTST Q
"RTN","GMTSRAE",160,0)
GETREP ; Gets Radiologist's Report
"RTN","GMTSRAE",161,0)
 ; DBIA 501 access ^RARPT (file 74)
"RTN","GMTSRAE",162,0)
 ; DBIA 2056 call GET1^DIQ
"RTN","GMTSRAE",163,0)
 N X,GMTSLN S X=$$GET1^DIQ(74,GMTSPTR,200,,"GMTST")
"RTN","GMTSRAE",164,0)
 K ^UTILITY($J,"W") N X,I S GMTSI=0 F  S GMTSI=$O(GMTST(GMTSI)) Q:+GMTSI=0  S X=$G(GMTST(GMTSI)) D FORMAT
"RTN","GMTSRAE",165,0)
 I $D(^UTILITY($J,"W")) F GMTSLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMTSIDT,GMTSPN,"R",GMTSLN)=^UTILITY($J,"W",3,GMTSLN,0)
"RTN","GMTSRAE",166,0)
 K ^UTILITY($J,"W"),GMTST Q
"RTN","GMTSRAE",167,0)
 ;
"RTN","GMTSRAE",168,0)
PMOD ; Procedure Modifiers
"RTN","GMTSRAE",169,0)
 ;
"RTN","GMTSRAE",170,0)
 ; DIC="^RADPT("_DFN_",""DT"","_GMTSIDT_",""P"","
"RTN","GMTSRAE",171,0)
 ; DA=GMTSPN
"RTN","GMTSRAE",172,0)
 ; DIQ="GMTSRAD("
"RTN","GMTSRAE",173,0)
 ;
"RTN","GMTSRAE",174,0)
 N GMTS,GMTSI S GMTS=$G(DIC) Q:'$L(DIC)  S GMTSI=+($G(DA)) Q:+GMTSI=0
"RTN","GMTSRAE",175,0)
 N DIC,DA,DR S DIC=GMTS_GMTSI_",""M"","
"RTN","GMTSRAE",176,0)
 S DA=0 F  S DA=$O(@(DIC_DA_")")) Q:+DA'>0  S DR=".01" D
"RTN","GMTSRAE",177,0)
 . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSRAE",178,0)
 . D EN^DIQ1
"RTN","GMTSRAE",179,0)
 Q
"RTN","GMTSRAE",180,0)
CMOD ; Procedure Modifiers
"RTN","GMTSRAE",181,0)
 ;
"RTN","GMTSRAE",182,0)
 ; DIC="^RADPT("_DFN_",""DT"","_GMTSIDT_",""P"","
"RTN","GMTSRAE",183,0)
 ; DA=GMTSPN
"RTN","GMTSRAE",184,0)
 ; DIQ="GMTSRAD("
"RTN","GMTSRAE",185,0)
 ;
"RTN","GMTSRAE",186,0)
 N GMTS,GMTSI,GMTSC,GMTSCM,GMTSCN S GMTS=$G(DIC) Q:'$L(DIC)  S GMTSI=+($G(DA)) Q:+GMTSI=0
"RTN","GMTSRAE",187,0)
 N DIC,DA,DR S DIC=GMTS_GMTSI_",""CMOD"","
"RTN","GMTSRAE",188,0)
 S DA=0 F  S DA=$O(@(DIC_DA_")")) Q:+DA'>0  S DR=".01" D
"RTN","GMTSRAE",189,0)
 . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSRAE",190,0)
 . D EN^DIQ1
"RTN","GMTSRAE",191,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSRAD(70.3135,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSRAE",192,0)
 . S GMTSC=$G(GMTSRAD(70.3135,GMTSI,.01,"I")) Q:+GMTSC=0
"RTN","GMTSRAE",193,0)
 . S GMTSCM=$$GET1^DIQ(81.3,GMTSC,.01,"E") Q:'$L(GMTSCM)
"RTN","GMTSRAE",194,0)
 . S GMTSCN=$$GET1^DIQ(81.3,GMTSC,.02,"E") Q:'$L(GMTSCN)
"RTN","GMTSRAE",195,0)
 . S GMTSRAD(70.3135,GMTSI,.01,"M")=GMTSCM
"RTN","GMTSRAE",196,0)
 . S GMTSRAD(70.3135,GMTSI,.01,"N")=$$EN2^GMTSUMX(GMTSCN)
"RTN","GMTSRAE",197,0)
 Q
"RTN","GMTSRAE",198,0)
FORMAT ; Calls ^DIWP to format each line of text
"RTN","GMTSRAE",199,0)
 N %,D0,DIW,DIWI,DIWT,DIWTC,DIWX,DIWF,DIWL,DIWR,I,J,Y,Z
"RTN","GMTSRAE",200,0)
 S DIWL=3,DIWR=($S(MODE=1:76,1:80))
"RTN","GMTSRAE",201,0)
 ; DBIA 10011 call ^DIWP
"RTN","GMTSRAE",202,0)
 D ^DIWP Q
"RTN","GMTSRAE",203,0)
TECH ; Technician
"RTN","GMTSRAE",204,0)
 S GMTSTC=+$O(^RADPT(DFN,"DT",GMTSIDT,"P",GMTSPN,"TC",0))
"RTN","GMTSRAE",205,0)
 I GMTSTC S DR=$G(DR)_";175",DR(70.12)=.01,DA(70.12)=GMTSTC F  Q:$E(DR,1)'=";"  S DR=$E(DR,2,$L(DR))
"RTN","GMTSRAE",206,0)
 Q
"RTN","GMTSRAE",207,0)
GETDX(GMTSIEN) ; Set the data node with diagnostic code info.
"RTN","GMTSRAE",208,0)
 ;
"RTN","GMTSRAE",209,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,"D",seq #) = Dx codes (seq # = 1: Pri. Dx)
"RTN","GMTSRAE",210,0)
 ; ^TMP("RAE",$J,GMTSIDT,GMTSPN,"D",seq #) = Dx codes (seq # > 1: Sec. Dx)
"RTN","GMTSRAE",211,0)
 ; Input: GMTSIEN=case ien_","_rev exam date/time_","_patient dfn_","
"RTN","GMTSRAE",212,0)
 ;
"RTN","GMTSRAE",213,0)
 S ^TMP("RAE",$J,$P(GMTSIEN,",",2),$P(GMTSIEN,","),"D",1)=$G(GMTSRAD(70.03,$P(GMTSIEN,","),13,"E")) ; Get the Primary Dx code
"RTN","GMTSRAE",214,0)
 N GMTSI,GMTSII,GMTSDX S GMTSI=1
"RTN","GMTSRAE",215,0)
 ; DBIA 2056 call GETS^DIQ
"RTN","GMTSRAE",216,0)
 D GETS^DIQ(70.03,GMTSIEN,"13.1*","E","GMTSDX")
"RTN","GMTSRAE",217,0)
 S GMTSII="" F  S GMTSII=$O(GMTSDX(70.14,GMTSII)) Q:GMTSII=""  D
"RTN","GMTSRAE",218,0)
 . S GMTSI=GMTSI+1 S ^TMP("RAE",$J,$P(GMTSIEN,",",2),$P(GMTSIEN,","),"D",GMTSI)=$G(GMTSDX(70.14,GMTSII,.01,"E")) ; Get the Secondary Dx code
"RTN","GMTSRAE",219,0)
 Q
"RTN","GMTSRAI")
0^23^B7342296
"RTN","GMTSRAI",1,0)
GMTSRAI ; SLC/JER,KER - Radiology Impression Comp       ; 07/18/2000
"RTN","GMTSRAI",2,0)
 ;;2.7;Health Summary;**28,37**;Oct 20, 1995
"RTN","GMTSRAI",3,0)
 ;
"RTN","GMTSRAI",4,0)
ENSRA ; Controls branching
"RTN","GMTSRAI",5,0)
 Q:+($G(DFN))=0  Q:+($G(DFN))'=+($$RP(+($G(DFN))))
"RTN","GMTSRAI",6,0)
 N GMDATA D MAIN^GMTSRAE(1) Q:'$D(^TMP("RAE",$J))
"RTN","GMTSRAI",7,0)
 D LOOP K ^TMP("RAE",$J)
"RTN","GMTSRAI",8,0)
 Q
"RTN","GMTSRAI",9,0)
LOOP ; Loops through ^TMP("RAE",$J,
"RTN","GMTSRAI",10,0)
 N GMTSIDT,GMTSPN,GMTSPC S (GMTSIDT,GMTSPC)=0 F  S GMTSIDT=$O(^TMP("RAE",$J,GMTSIDT)) Q:GMTSIDT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRAI",11,0)
 . S GMTSPN=0 F  S GMTSPN=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN)) Q:GMTSPN'>0  D WRT  Q:$D(GMTSQIT)
"RTN","GMTSRAI",12,0)
 Q
"RTN","GMTSRAI",13,0)
WRT ; Writes component data
"RTN","GMTSRAI",14,0)
 Q:$D(GMTSQIT)  N X,GMTSEDT S GMDATA=1,X=+^TMP("RAE",$J,GMTSIDT,GMTSPN,0) D REGDT4^GMTSU S GMTSEDT=X
"RTN","GMTSRAI",15,0)
 D HD S GMTSPC=+($G(GMTSCP))+1 Q:$D(GMTSQIT)  D HD Q:$D(GMTSQIT)  W GMTSEDT D PRO,IMP Q
"RTN","GMTSRAI",16,0)
 ;D CKP^GMTSUP Q:$D(GMTSQIT)  W GMTSEDT D PRO,IMP Q
"RTN","GMTSRAI",17,0)
 Q
"RTN","GMTSRAI",18,0)
PRO ; Procedure
"RTN","GMTSRAI",19,0)
 N GMTSPRO,GMTSTA,GMTSCPT,GMTSI,GMTSCN
"RTN","GMTSRAI",20,0)
 S GMTSPRO=$P(^TMP("RAE",$J,GMTSIDT,GMTSPN,0),"^",2),GMTSTA=$P(^(0),"^",4),GMTSCPT=$P(^(0),"^",7),GMTSCN=$P(^(0),"^",9)
"RTN","GMTSRAI",21,0)
 S GMTSTA=$S(GMTSTA="RELEASED/NOT VERIFIED":"REL/NOT VER",GMTSTA="PROBLEM DRAFT":"PROB DRAFT",1:GMTSTA)
"RTN","GMTSRAI",22,0)
 S GMTSTA=$$EN2^GMTSUMX(GMTSTA) I $L(GMTSPRO)>31 S GMTSPRO=$$WRAP^GMTSORC(GMTSPRO,31)
"RTN","GMTSRAI",23,0)
 D HD Q:$D(GMTSQIT) 
"RTN","GMTSRAI",24,0)
 ;D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAI",25,0)
 W ?12,$P(GMTSPRO,"|"),?46,GMTSCPT,?52,$E(GMTSTA,1,11),?64,$G(GMTSCN),!
"RTN","GMTSRAI",26,0)
 F GMTSI=2:1:$L(GMTSPRO,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRAI",27,0)
 . D HD Q:$D(GMTSQIT) 
"RTN","GMTSRAI",28,0)
 . ;D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAI",29,0)
 . W:$P(GMTSPRO,"|",GMTSI)]"" ?14,$P(GMTSPRO,"|",GMTSI),!
"RTN","GMTSRAI",30,0)
 Q
"RTN","GMTSRAI",31,0)
IMP ; Impression
"RTN","GMTSRAI",32,0)
 Q:$D(GMTSQIT)  N GMTSI,GMTST,DIWF,DIWL,DIWR
"RTN","GMTSRAI",33,0)
 S GMTST=12 Q:'$D(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I"))  K ^UTILITY($J,"W")
"RTN","GMTSRAI",34,0)
 S DIWF="C"_(78-GMTST),DIWL=0,DIWR=0,GMTSI=0
"RTN","GMTSRAI",35,0)
 F  S GMTSI=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",GMTSI)) Q:+GMTSI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRAI",36,0)
 . S X=$G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",GMTSI))
"RTN","GMTSRAI",37,0)
 . ; DBIA 10011 call ^DIWP
"RTN","GMTSRAI",38,0)
 . D ^DIWP
"RTN","GMTSRAI",39,0)
 S GMTSI=0 F  S GMTSI=$O(^UTILITY($J,"W",0,GMTSI)) Q:+GMTSI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRAI",40,0)
 . D HD Q:$D(GMTSQIT) 
"RTN","GMTSRAI",41,0)
 . ;D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAI",42,0)
 .  W ?GMTST,$G(^UTILITY($J,"W",0,GMTSI,0)),!
"RTN","GMTSRAI",43,0)
 K ^UTILITY($J,"W")
"RTN","GMTSRAI",44,0)
 Q
"RTN","GMTSRAI",45,0)
HD ; Header/Page Check
"RTN","GMTSRAI",46,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)  Q:+($G(GMTSNPG))=0&(+($G(GMTSPC))>0)
"RTN","GMTSRAI",47,0)
 W "Date",?12,"Procedure",?46,"CPT",?52,"Status",?64,"Case #",!
"RTN","GMTSRAI",48,0)
 Q
"RTN","GMTSRAI",49,0)
 ;
"RTN","GMTSRAI",50,0)
RP(X) ; Radiology Patient
"RTN","GMTSRAI",51,0)
 N Y S X=+($G(X))
"RTN","GMTSRAI",52,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSRAI",53,0)
 S Y=$$GET1^DIQ(70,X,.01,"I") S X=Y Q X
"RTN","GMTSRAS")
0^24^B40431610
"RTN","GMTSRAS",1,0)
GMTSRAS ; SLC/JER,KER HIN/GJC - Radiology Profile       ; 07/18/2000
"RTN","GMTSRAS",2,0)
 ;;2.7;Health Summary;**14,25,28,37**;Oct 20, 1995
"RTN","GMTSRAS",3,0)
 ;
"RTN","GMTSRAS",4,0)
ENSRA ; Controls branching
"RTN","GMTSRAS",5,0)
 Q:+($G(DFN))=0  Q:+($G(DFN))'=+($$RP(+($G(DFN))))
"RTN","GMTSRAS",6,0)
 N GMDATA D MAIN^GMTSRAE(2) Q:'$D(^TMP("RAE",$J))
"RTN","GMTSRAS",7,0)
 D LOOP K ^TMP("RAE",$J) Q
"RTN","GMTSRAS",8,0)
LOOP ; Loops through ^TMP("RAE",$J,
"RTN","GMTSRAS",9,0)
 N GMW,GMTSIDT,GMTSPN,GMLN,GMPSET,GMXSET S GMTSIDT=0
"RTN","GMTSRAS",10,0)
 F  S GMTSIDT=$O(^TMP("RAE",$J,GMTSIDT)) Q:GMTSIDT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRAS",11,0)
 . S GMPSET=$S($D(^TMP("RAE",$J,GMTSIDT,"PRINTSET")):1,1:0)
"RTN","GMTSRAS",12,0)
 . S GMXSET=$S($D(^TMP("RAE",$J,GMTSIDT,"EXAMSET")):1,1:0)
"RTN","GMTSRAS",13,0)
 . S GMTSPN=0 F  S GMTSPN=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN)) Q:GMTSPN'>0  D
"RTN","GMTSRAS",14,0)
 . . D WRT D:+$O(^TMP("RAE",$J,GMTSIDT,GMTSPN)) BL Q:$D(GMTSQIT)
"RTN","GMTSRAS",15,0)
 . D:+$O(^TMP("RAE",$J,GMTSIDT)) BL Q:$D(GMTSQIT)
"RTN","GMTSRAS",16,0)
 Q
"RTN","GMTSRAS",17,0)
WRT ; Writes component data
"RTN","GMTSRAS",18,0)
 Q:$D(GMTSQIT)  N X,GMI,GMTMP S GMDATA=1,GMTMP=$G(^TMP("RAE",$J,GMTSIDT,GMTSPN,0))
"RTN","GMTSRAS",19,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",20,0)
 D DAT,PRO D:'GMPSET SSET D:GMPSET PSET
"RTN","GMTSRAS",21,0)
 Q
"RTN","GMTSRAS",22,0)
SSET ; Output for Non-Printsets (single exam) (GMPSET=0)
"RTN","GMTSRAS",23,0)
 ;
"RTN","GMTSRAS",24,0)
 ;  Procedure Modifiers, Procedure Status, CPT Code, CPT Modifiers,
"RTN","GMTSRAS",25,0)
 ;  Interpreting Staff, Interpreting Resident, Report Status, 
"RTN","GMTSRAS",26,0)
 ;  Technologist, Report Text
"RTN","GMTSRAS",27,0)
 ; 
"RTN","GMTSRAS",28,0)
 D:$D(^TMP("RAE",$J,GMTSIDT,GMTSPN,"M")) PMD D CPT,CMD,INS,INR,CAS,EST,STT,RPT
"RTN","GMTSRAS",29,0)
 Q
"RTN","GMTSRAS",30,0)
PSET ; Output for Printsets (GMPSET=1)
"RTN","GMTSRAS",31,0)
 ;
"RTN","GMTSRAS",32,0)
 ;  Procedure Modifiers, Procedure Status, CPT Code, CPT Modifiers
"RTN","GMTSRAS",33,0)
 ;
"RTN","GMTSRAS",34,0)
 ;  Procedure Modifiers, Procedure Status, CPT Code, CPT Modifier,
"RTN","GMTSRAS",35,0)
 ;  Report Status, Technologist
"RTN","GMTSRAS",36,0)
 ;
"RTN","GMTSRAS",37,0)
 D:$D(^TMP("RAE",$J,GMTSIDT,GMTSPN,"M")) PMD D CPT,CMD
"RTN","GMTSRAS",38,0)
 D:'+$O(^TMP("RAE",$J,GMTSIDT,GMTSPN)) LSET
"RTN","GMTSRAS",39,0)
 Q
"RTN","GMTSRAS",40,0)
LSET ; Last Set/Case in Printset
"RTN","GMTSRAS",41,0)
 ;
"RTN","GMTSRAS",42,0)
 ;  Interpreting Staff, Interpreting Resident, Report Status, 
"RTN","GMTSRAS",43,0)
 ;  Technologist, Report Text
"RTN","GMTSRAS",44,0)
 ;
"RTN","GMTSRAS",45,0)
 D BL,INS,INR,CAS,EST,STT N GMTSPN S GMTSPN=$O(^TMP("RAE",$J,GMTSIDT,0)) D:GMTSPN RPT
"RTN","GMTSRAS",46,0)
 Q
"RTN","GMTSRAS",47,0)
DAT ; Date                                  +1
"RTN","GMTSRAS",48,0)
 Q:'$L($G(GMTMP))  Q:+($G(GMTMP))=0  Q:'$D(GMXSET)  Q:'$D(GMTSPN)  Q:+($G(GMTSIDT))=0
"RTN","GMTSRAS",49,0)
 N X,GMTSDT S X=+GMTMP D REGDT4^GMTSU S GMTSDT=X
"RTN","GMTSRAS",50,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W:+($G(GMXSET))=0 GMTSDT
"RTN","GMTSRAS",51,0)
 W:(+($G(GMXSET))>0)&(GMTSPN=$O(^TMP("RAE",$J,GMTSIDT,0))) GMTSDT
"RTN","GMTSRAS",52,0)
 Q
"RTN","GMTSRAS",53,0)
PRO ; Procedure                              2
"RTN","GMTSRAS",54,0)
 Q:'$L($G(GMTMP))  N GMTS1,GMTS2 S GMTS1=$P($G(GMTMP),"^",2)
"RTN","GMTSRAS",55,0)
 S:$L(GMTS1)>65 GMTS1=$$WRAP^GMTSORC(GMTS1,65)
"RTN","GMTSRAS",56,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,$P(GMTS1,"|"),!
"RTN","GMTSRAS",57,0)
 F GMTS2=2:1:$L(GMTS1,"|") D  Q:$D(GMTSQIT) 
"RTN","GMTSRAS",58,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",59,0)
 . W:$P(GMTS1,"|",GMTS2)]"" ?23,$P(GMTS1,"|",GMTS2),!
"RTN","GMTSRAS",60,0)
 Q
"RTN","GMTSRAS",61,0)
CAS ; Case Number                            9
"RTN","GMTSRAS",62,0)
 Q:'$L($G(GMTMP))  N GMTS1 S GMTS1=$P(GMTMP,"^",9) Q:GMTS=""
"RTN","GMTSRAS",63,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",64,0)
 W ?12,"Exam Case Number:",?33,GMTS1,!
"RTN","GMTSRAS",65,0)
 Q
"RTN","GMTSRAS",66,0)
EST ; Exam Status                            3
"RTN","GMTSRAS",67,0)
 Q:'$L($G(GMTMP))  N GMTS1 S GMTS1=$P(GMTMP,"^",3) Q:GMTS=""
"RTN","GMTSRAS",68,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",69,0)
 W ?12,"Exam Status:",?33,GMTS1,!
"RTN","GMTSRAS",70,0)
 Q
"RTN","GMTSRAS",71,0)
RST ; Report Status                          4
"RTN","GMTSRAS",72,0)
 Q:'$L($G(GMTMP))  N GMTS1 S GMTS1=$P(GMTMP,"^",4) Q:GMTS1=""
"RTN","GMTSRAS",73,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",74,0)
 W ?12,"Rpt Status:  ",GMTS1,!
"RTN","GMTSRAS",75,0)
 Q
"RTN","GMTSRAS",76,0)
INR ; Interpreting Resident                  5
"RTN","GMTSRAS",77,0)
 Q:'$L($G(GMTMP))  N GMTS1 S GMTS1=$P(GMTMP,"^",5) Q:GMTS1=""
"RTN","GMTSRAS",78,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",79,0)
 W ?12,"Interpreting Res.:",?33,GMTS1,!
"RTN","GMTSRAS",80,0)
 Q
"RTN","GMTSRAS",81,0)
INS ; Interpreting Staff                     6
"RTN","GMTSRAS",82,0)
 Q:'$L($G(GMTMP))  N GMTS1 S GMTS1=$P(GMTMP,"^",6) Q:GMTS1=""
"RTN","GMTSRAS",83,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",84,0)
 W ?12,"Interpreting Staff:",?33,GMTS1,!
"RTN","GMTSRAS",85,0)
 Q
"RTN","GMTSRAS",86,0)
CPT ; CPT Code                               7
"RTN","GMTSRAS",87,0)
 Q:'$L($G(GMTMP))  N GMTS1 S GMTS1=$P($G(GMTMP),"^",7)
"RTN","GMTSRAS",88,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",89,0)
 W ?12,"CPT Code:",?25,GMTS1,!
"RTN","GMTSRAS",90,0)
 Q
"RTN","GMTSRAS",91,0)
TEC ; Technologist                           8
"RTN","GMTSRAS",92,0)
 Q:'$L($G(GMTMP))  N GMTS1 S GMTS1=$P($G(GMTMP),"^",8) Q:GMTS1=""
"RTN","GMTSRAS",93,0)
 Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",94,0)
 W ?12," Technologist: ",GMTS1,!
"RTN","GMTSRAS",95,0)
 Q
"RTN","GMTSRAS",96,0)
STT ; Report Status/Technologist            4/8
"RTN","GMTSRAS",97,0)
 Q:'$L($G(GMTMP))  N GMTS1,GMTS2 S GMTS1=$P(GMTMP,"^",4),GMTS2=$P(GMTMP,"^",8)
"RTN","GMTSRAS",98,0)
 Q:($G(GMTS1)_$G(GMTS2))=""  Q:$D(GMTSQIT)  D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",99,0)
 W ?12,"Rpt Status:  ",$E($G(GMTS1),1,18) W ?45," Technologist: ",$G(GMTS2),!
"RTN","GMTSRAS",100,0)
 Q
"RTN","GMTSRAS",101,0)
CMD ; CPT Modifiers
"RTN","GMTSRAS",102,0)
 N GMTSCPTM
"RTN","GMTSRAS",103,0)
 S GMTSCPTM=+($$CPT^GMTSU(+($G(GMTSEGN)))) S:$G(GMPXCMOD)="N" GMTSCPTM=0
"RTN","GMTSRAS",104,0)
 Q:'GMTSCPTM  Q:'$L($G(GMTMP))  N GMTSC,GMTSCM,GMTSCT,GMTSI,GMTSCNT S (GMTSC,GMTSCNT)=0
"RTN","GMTSRAS",105,0)
 F  S GMTSC=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)) Q:+GMTSC=0  D
"RTN","GMTSRAS",106,0)
 . S GMTSCM=$P($G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)),"^",1) Q:'$L(GMTSCM)
"RTN","GMTSRAS",107,0)
 . S GMTSCT=$P($G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)),"^",3) Q:'$L(GMTSCT)
"RTN","GMTSRAS",108,0)
 . S GMTSCT=GMTSCM_" - "_GMTSCT
"RTN","GMTSRAS",109,0)
 . S GMTSCNT=GMTSCNT+1
"RTN","GMTSRAS",110,0)
 . S:$L(GMTSCT)>47 GMTSCT=$$WRAP^GMTSORC(GMTSCT,47)
"RTN","GMTSRAS",111,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",112,0)
 . W:GMTSCNT=1 ?12,"CPT Modifier:" W ?28,$P(GMTSCT,"|"),!
"RTN","GMTSRAS",113,0)
 . F GMTSI=2:1:$L(GMTSCT,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRAS",114,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSCT,"|",GMTSI)]"" ?33,$P(GMTSCT,"|",GMTSI),!
"RTN","GMTSRAS",115,0)
 Q
"RTN","GMTSRAS",116,0)
PMD ; Display modifiers
"RTN","GMTSRAS",117,0)
 Q:'$L($G(GMTMP))  D CKP^GMTSUP Q:$D(GMTSQIT)  W:+($O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"M",0)))>0 ?12,"Procedure Modifier:"
"RTN","GMTSRAS",118,0)
 S GMI=0 F  S GMI=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"M",GMI)) Q:+GMI'>0  D
"RTN","GMTSRAS",119,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRAS",120,0)
 . W ?33,^TMP("RAE",$J,GMTSIDT,GMTSPN,"M",GMI),!
"RTN","GMTSRAS",121,0)
 Q
"RTN","GMTSRAS",122,0)
RPT ; Report Text
"RTN","GMTSRAS",123,0)
 N GMTSL F GMTSL="H","R","I","D" D TXT(GMTSL)
"RTN","GMTSRAS",124,0)
 Q
"RTN","GMTSRAS",125,0)
TXT(X) ;
"RTN","GMTSRAS",126,0)
 N GMTST S GMTST=$E($G(X),1) Q:(GMTST="")!("^H^R^I^D^"'[GMTST)!(GMTST="^")  Q:+($G(GMTSIDT))=0  Q:+($G(GMTSPN))=0  Q:'$D(^TMP("RAE",$J,GMTSIDT,GMTSPN,GMTST))
"RTN","GMTSRAS",127,0)
 K ^UTILITY($J,"W") N GMTSI,GMTSII,GMTSIND,DIWF,DIWL,DIWR S GMTSIND=12,DIWF="C"_(78-(GMTSIND+2)),DIWL=0,DIWR=0,GMTSI=0
"RTN","GMTSRAS",128,0)
 D:$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,GMTST,0))>0 BL
"RTN","GMTSRAS",129,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?GMTSIND,$S(GMTST="H":"History: ",GMTST="R":"Report: ",GMTST="I":"Impression: ",GMTST="D":"DX Codes: ",1:"Text:"),!
"RTN","GMTSRAS",130,0)
 I GMTST'="D" D
"RTN","GMTSRAS",131,0)
 . S GMTSI=0 F  S GMTSI=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,GMTST,GMTSI)) Q:GMTSI'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRAS",132,0)
 . . S X=$G(^TMP("RAE",$J,GMTSIDT,GMTSPN,GMTST,GMTSI))
"RTN","GMTSRAS",133,0)
 . . ; DBIA 10011 call ^DIWP
"RTN","GMTSRAS",134,0)
 . . D ^DIWP
"RTN","GMTSRAS",135,0)
 I GMTST="D" D
"RTN","GMTSRAS",136,0)
 . S GMTSI=0 F  S GMTSI=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,GMTST,GMTSI)) Q:GMTSI'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRAS",137,0)
 . . S X=$G(^TMP("RAE",$J,GMTSIDT,GMTSPN,GMTST,GMTSI)) S:$L(X)>(78-(GMTSIND+4)) X=$$WRAP^GMTSORC(X,(78-(GMTSIND+4)))
"RTN","GMTSRAS",138,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?(GMTSIND+2),$P(X,"|",1),! F GMTSII=2:1:$L(X,"|") D  Q:$D(GMTSQIT) 
"RTN","GMTSRAS",139,0)
 . . . D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(X,"|",GMTSII)]"" ?(GMTSIND+4),$P(X,"|",GMTSII),!
"RTN","GMTSRAS",140,0)
 I $D(^UTILITY($J,"W")) D
"RTN","GMTSRAS",141,0)
 . S GMTSI=0 F  S GMTSI=$O(^UTILITY($J,"W",0,GMTSI)) Q:+GMTSI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRAS",142,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?(GMTSIND+2),$G(^UTILITY($J,"W",0,GMTSI,0)),!
"RTN","GMTSRAS",143,0)
 K ^UTILITY($J,"W")
"RTN","GMTSRAS",144,0)
 Q
"RTN","GMTSRAS",145,0)
BL ; Blank Line
"RTN","GMTSRAS",146,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSRAS",147,0)
 Q
"RTN","GMTSRAS",148,0)
RP(X) ; Radiology Patient
"RTN","GMTSRAS",149,0)
 N Y S X=+($G(X))
"RTN","GMTSRAS",150,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSRAS",151,0)
 S Y=$$GET1^DIQ(70,X,.01,"I") S X=Y Q X
"RTN","GMTSRASP")
0^25^B10464783
"RTN","GMTSRASP",1,0)
GMTSRASP ; SLC/JER,KER - Selected Radiology ; 07/18/2000
"RTN","GMTSRASP",2,0)
 ;;2.7;Health Summary;**28,37**;Oct 20, 1995
"RTN","GMTSRASP",3,0)
 ;
"RTN","GMTSRASP",4,0)
MAIN ; Controls branching
"RTN","GMTSRASP",5,0)
 Q:+($G(DFN))=0  Q:+($G(DFN))'=+($$RP(+($G(DFN))))
"RTN","GMTSRASP",6,0)
 N GMTSI,GMW,MAX,GMTSTEST
"RTN","GMTSRASP",7,0)
 S MAX=$S(+$G(GMTSNDM)>0:GMTSNDM,1:999)
"RTN","GMTSRASP",8,0)
 I '$O(GMTSEG(GMTSEGN,71,0)) Q
"RTN","GMTSRASP",9,0)
 S GMTSI=0 F  S GMTSI=$O(GMTSEG(GMTSEGN,71,GMTSI)) Q:GMTSI'>0  D
"RTN","GMTSRASP",10,0)
 . S GMTSTEST=GMTSEG(GMTSEGN,71,GMTSI)
"RTN","GMTSRASP",11,0)
 . D MAINSEL^GMTSRAE(1,GMTSTEST),LOOP:$D(^TMP("RAE",$J))
"RTN","GMTSRASP",12,0)
 K ^TMP("RAE",$J)
"RTN","GMTSRASP",13,0)
 Q
"RTN","GMTSRASP",14,0)
LOOP ; Loops through ^TMP("RAE",$J,
"RTN","GMTSRASP",15,0)
 N GMW,GMTSIDT,GMTSPN,GMLN
"RTN","GMTSRASP",16,0)
 S GMTSIDT=0 F  S GMTSIDT=$O(^TMP("RAE",$J,GMTSIDT)) Q:GMTSIDT'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRASP",17,0)
 . S GMTSPN=0 F  S GMTSPN=$O(^(GMTSIDT,GMTSPN)) Q:GMTSPN'>0  D WRT Q:$D(GMTSQIT)
"RTN","GMTSRASP",18,0)
 Q
"RTN","GMTSRASP",19,0)
WRT ; Writes component data
"RTN","GMTSRASP",20,0)
 Q:$D(GMTSQIT)  N X,GMTSEDT S GMDATA=1,X=+^TMP("RAE",$J,GMTSIDT,GMTSPN,0) D REGDT4^GMTSU S GMTSEDT=X
"RTN","GMTSRASP",21,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W GMTSEDT D PRO,CMD,IMP
"RTN","GMTSRASP",22,0)
 Q
"RTN","GMTSRASP",23,0)
PRO ; Procedure
"RTN","GMTSRASP",24,0)
 N GMTSPRO,GMTSTA,GMTSCPT,GMTSI
"RTN","GMTSRASP",25,0)
 S GMTSPRO=$P(^TMP("RAE",$J,GMTSIDT,GMTSPN,0),"^",2),GMTSTA=$P(^(0),"^",4),GMTSCPT=$P(^(0),"^",7)
"RTN","GMTSRASP",26,0)
 I $L(GMTSPRO)>35 S GMTSPRO=$$WRAP^GMTSORC(GMTSPRO,35)
"RTN","GMTSRASP",27,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?12,$P(GMTSPRO,"|"),?52,"CPT ",GMTSCPT,?62,$E(GMTSTA,1,17),!
"RTN","GMTSRASP",28,0)
 F GMTSI=2:1:$L(GMTSPRO,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSPRO,"|",GMTSI)]"" ?23,$P(GMTSPRO,"|",GMTSI),!
"RTN","GMTSRASP",29,0)
 Q
"RTN","GMTSRASP",30,0)
CMD ; CPT Modifiers
"RTN","GMTSRASP",31,0)
 ;
"RTN","GMTSRASP",32,0)
 ; Quit - CPT Modifiers will not be used with 
"RTN","GMTSRASP",33,0)
 ;        Radiology Impression (RI) and Radiology
"RTN","GMTSRASP",34,0)
 ;        Impression Selected (SRI) at this time
"RTN","GMTSRASP",35,0)
 Q
"RTN","GMTSRASP",36,0)
 N GMTSCPTM
"RTN","GMTSRASP",37,0)
 S GMTSCPTM=+($$CPT^GMTSU(+($G(GMTSEGN)))) S:$G(GMPXCMOD)="N" GMTSCPTM=0
"RTN","GMTSRASP",38,0)
 Q:'GMTSCPTM
"RTN","GMTSRASP",39,0)
 N GMTSC,GMTSCM,GMTSCT,GMTSI S GMTSC=0 F  S GMTSC=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)) Q:+GMTSC=0  D
"RTN","GMTSRASP",40,0)
 . S GMTSCM=$P($G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)),"^",1) Q:'$L(GMTSCM)  S GMTSCT=$P($G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"CM",GMTSC)),"^",3) Q:'$L(GMTSCT)
"RTN","GMTSRASP",41,0)
 . S GMTSCT=GMTSCT_" (CPT Mod "_GMTSCM_")" S:$L(GMTSCT)>35 GMTSCT=$$WRAP^GMTSORC(GMTSCT,62) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?14,$P(GMTSCT,"|"),!
"RTN","GMTSRASP",42,0)
 . F GMTSI=2:1:$L(GMTSCT,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W:$P(GMTSCT,"|",GMTSI)]"" ?16,$P(GMTSCT,"|",GMTSI),!
"RTN","GMTSRASP",43,0)
 Q
"RTN","GMTSRASP",44,0)
IMP ; Impression
"RTN","GMTSRASP",45,0)
 Q:$D(GMTSQIT)  N GMTSI,GMTST,DIWF,DIWL,DIWR
"RTN","GMTSRASP",46,0)
 S GMTST=12 Q:'$D(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I"))  K ^UTILITY($J,"W")
"RTN","GMTSRASP",47,0)
 S DIWF="C"_(78-GMTST),DIWL=0,DIWR=0,GMTSI=0
"RTN","GMTSRASP",48,0)
 F  S GMTSI=$O(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",GMTSI)) Q:+GMTSI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRASP",49,0)
 . S X=$G(^TMP("RAE",$J,GMTSIDT,GMTSPN,"I",GMTSI))
"RTN","GMTSRASP",50,0)
 . ; DBIA 10011 call ^DIWP
"RTN","GMTSRASP",51,0)
 . D ^DIWP
"RTN","GMTSRASP",52,0)
 S GMTSI=0 F  S GMTSI=$O(^UTILITY($J,"W",0,GMTSI)) Q:+GMTSI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRASP",53,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?GMTST,$G(^UTILITY($J,"W",0,GMTSI,0)),!
"RTN","GMTSRASP",54,0)
 K ^UTILITY($J,"W")
"RTN","GMTSRASP",55,0)
 Q
"RTN","GMTSRASP",56,0)
RP(X) ; Radiology Patient
"RTN","GMTSRASP",57,0)
 N Y S X=+($G(X))
"RTN","GMTSRASP",58,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSRASP",59,0)
 S Y=$$GET1^DIQ(70,X,.01,"I") S X=Y Q X
"RTN","GMTSRM1")
0^26^B21018400
"RTN","GMTSRM1",1,0)
GMTSRM1 ;SLC/JER,DLT - Create/Modify Health Summary (cont'd) ; 07/18/2000
"RTN","GMTSRM1",2,0)
 ;;2.7;Health Summary;**7,36,37**;Oct 20, 1995
"RTN","GMTSRM1",3,0)
 ;
"RTN","GMTSRM1",4,0)
NXTCMP ; Edit, add, or delete components from existing structure
"RTN","GMTSRM1",5,0)
 N CMP,D,D0,DI,DIC,DIR,OLDSO,SEL,X,Y K DIRUT
"RTN","GMTSRM1",6,0)
 K DUOUT S GMTSQIT=0,GMTSNEW=0
"RTN","GMTSRM1",7,0)
 S DIC="^GMT(142.1,",DIC(0)="AEMQ",D="B",DIC("W")="W ?40,"" "",$P(^(0),U,4)",DIC("A")="Select COMPONENT: ",DIC("S")="I $P(^(0),U,6)'=""P""" S:$D(GMCMP) DIC("B")=$P(^GMT(142.1,+GMCMP,0),U)
"RTN","GMTSRM1",8,0)
 ; DBIA 10006 call ^DIC
"RTN","GMTSRM1",9,0)
 D ^DIC K DIC S:('$D(DTOUT)&('$D(DUOUT))&(Y=-1)) GMTSQIT=2 S:(Y=-1&(X'="^LOOP")) DUOUT=1
"RTN","GMTSRM1",10,0)
 I $D(DUOUT),(X="^LOOP") K DUOUT D LOOP K DUOUT Q
"RTN","GMTSRM1",11,0)
 I $D(DUOUT) Q
"RTN","GMTSRM1",12,0)
 D CHKCMP Q:$D(DUOUT)!(GMTSQIT)!(GMTSQIT="D")
"RTN","GMTSRM1",13,0)
 S DIR(0)="142.01,.01",DIR("B")=+$G(CNT)
"RTN","GMTSRM1",14,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSRM1",15,0)
 D ^DIR K DIR K:$D(DUOUT) DUOUT D:'$D(DIRUT) CHKSO^GMTSRM1A Q:$D(DIRUT)!(GMTSQIT)
"RTN","GMTSRM1",16,0)
 D ASKCMP I $D(GMCMP) S DUOUT=""
"RTN","GMTSRM1",17,0)
 Q
"RTN","GMTSRM1",18,0)
LOOP ; Loop through STRUCTURE multiple and call ASKCMP for each
"RTN","GMTSRM1",19,0)
 N GMI,GMJ
"RTN","GMTSRM1",20,0)
 S GMI=0 F  S GMI=$O(^GMT(142,GMTSIFN,1,GMI))  Q:GMI'>0!$D(DUOUT)!+GMTSQIT!(GMTSQIT="D")  D
"RTN","GMTSRM1",21,0)
 . N CMP,DIR,X,Y
"RTN","GMTSRM1",22,0)
 . S CMP=$P(^GMT(142,GMTSIFN,1,GMI,0),U,2),CMP("NM")=$P($G(^GMT(142.1,+CMP,0)),U),CMP(1)=+CMP
"RTN","GMTSRM1",23,0)
 . S CMP(0)=$G(^GMT(142,+GMTSIFN,1,+GMI,0))
"RTN","GMTSRM1",24,0)
 . S CMP(.01)=GMI
"RTN","GMTSRM1",25,0)
 . S GMJ=0 F  S GMJ=$O(^GMT(142,+GMTSIFN,1,+GMI,1,GMJ)) Q:+GMJ'>0  D
"RTN","GMTSRM1",26,0)
 . . S CMP(142.14,GMJ)=$G(^GMT(142,GMTSIFN,1,GMI,1,GMJ,0))
"RTN","GMTSRM1",27,0)
 . W !!?3,CMP("NM")
"RTN","GMTSRM1",28,0)
 . S (NXTCMP,NXTCMP(0))=NXTCMP+1 D ASKCMP I $D(Y),'$D(DTOUT) D
"RTN","GMTSRM1",29,0)
 . . S DIR(0)="Y",DIR("A")="WANT TO STOP LOOPING",DIR("B")="YES"
"RTN","GMTSRM1",30,0)
 . . ; DBIA 10026 call ^DIR
"RTN","GMTSRM1",31,0)
 . . D ^DIR K DIR W ! I +Y S GMTSQIT="D" W !!?4,"LOOP ENDED!",!!
"RTN","GMTSRM1",32,0)
 Q
"RTN","GMTSRM1",33,0)
ASKCMP ; Ask parameters for each component
"RTN","GMTSRM1",34,0)
 N IEN,MAXOCC,TIME,OCC,HOSP,ICD,PROV,CPT,SELCNT,GMTSNCNT
"RTN","GMTSRM1",35,0)
 N OLDLIM,OLDOCC,OLDHEAD,OLDSO,OLDHOSP,OLDICD,OLDPROV,OLDCPT,SUMORD,CMPNAM
"RTN","GMTSRM1",36,0)
 S MAXOCC=$S($P($G(^GMT(142.1,CMP(1),0)),U,5)="Y":1,1:0)
"RTN","GMTSRM1",37,0)
 S TIME=$S($P($G(^GMT(142.1,CMP(1),0)),U,3)="Y":1,1:0)
"RTN","GMTSRM1",38,0)
 S HOSP=$S($P($G(^GMT(142.1,CMP(1),0)),U,10)="Y":1,1:0)
"RTN","GMTSRM1",39,0)
 S ICD=$S($P($G(^GMT(142.1,CMP(1),0)),U,11)="Y":1,1:0)
"RTN","GMTSRM1",40,0)
 S PROV=$S($P($G(^GMT(142.1,CMP(1),0)),U,12)="Y":1,1:0)
"RTN","GMTSRM1",41,0)
 S CPT=$S($P($G(^GMT(142.1,CMP(1),0)),U,14)="Y":1,1:0)
"RTN","GMTSRM1",42,0)
 S OLDOCC=$P($G(CMP(0)),U,3),OLDLIM=$P($G(CMP(0)),U,4)
"RTN","GMTSRM1",43,0)
 S OLDHOSP=$P($G(CMP(0)),U,6),OLDICD=$P($G(CMP(0)),U,7)
"RTN","GMTSRM1",44,0)
 S OLDPROV=$P($G(CMP(0)),U,8),OLDCPT=$P($G(CMP(0)),U,9)
"RTN","GMTSRM1",45,0)
 S OLDHEAD=$S($L($P($G(CMP(0)),U,5)):$P($G(CMP(0)),U,5),$L($P(^GMT(142.1,+CMP(1),0),U,9)):$P(^(0),U,9),1:"")
"RTN","GMTSRM1",46,0)
 S SEL=$O(^GMT(142.1,CMP(1),1,0))
"RTN","GMTSRM1",47,0)
 I SEL D
"RTN","GMTSRM1",48,0)
 . S SEL(0)=^GMT(142.1,CMP(1),1,SEL,0),SEL=$P(SEL(0),U),SELCNT=$P(SEL(0),U,2)
"RTN","GMTSRM1",49,0)
 . I SEL S DIC("V")="I +Y(0)=SEL",IEN=0,DIC(0)="AEMQ" F  S IEN=$O(CMP(142.14,IEN)) Q:'IEN  D LOADSEL^GMTSRM1A
"RTN","GMTSRM1",50,0)
 I EXISTS=0 S EXISTS=1
"RTN","GMTSRM1",51,0)
 I '$D(^GMT(142,GMTSIFN,1,0)) S ^(0)="^142.01IA^0^0",GMTSNEW=1
"RTN","GMTSRM1",52,0)
 S SUMORD=$G(CMP(.01)),CMPNAM=$G(CMP(1))
"RTN","GMTSRM1",53,0)
 ;
"RTN","GMTSRM1",54,0)
 ; New           .01  Summary Order        N .001-9999.999
"RTN","GMTSRM1",55,0)
 ; New/Existing    1  Component Name       P 142.1
"RTN","GMTSRM1",56,0)
 ;
"RTN","GMTSRM1",57,0)
 I +($G(GMTSNEW)) D
"RTN","GMTSRM1",58,0)
 . S DR=".01///^S X=SUMORD;1///^S X=CMPNAM;2///^S X=OLDOCC;3///^S X=OLDLIM;6///^S X=OLDHOSP;7///^S X=OLDICD;8///^S X=OLDPROV;9///^S X=OLDCPT;"
"RTN","GMTSRM1",59,0)
 E  S DR="1///^S X=CMPNAM;"
"RTN","GMTSRM1",60,0)
 ;
"RTN","GMTSRM1",61,0)
 ; First Edit      2  Occurrence Limit     N 1-99999
"RTN","GMTSRM1",62,0)
 ;                 3  Time Limit           F 1-5
"RTN","GMTSRM1",63,0)
 ;                 6  Hospital Loc Disp    Y/N/""
"RTN","GMTSRM1",64,0)
 ;                 7  ICD Text Displayed   L/S/C/T/N
"RTN","GMTSRM1",65,0)
 ;                 8  Provider Narr Disp   Y/N/""
"RTN","GMTSRM1",66,0)
 ;                 9  CPT Mod Displayed    Y/N/""
"RTN","GMTSRM1",67,0)
 ;
"RTN","GMTSRM1",68,0)
 S:+($G(MAXOCC))>0 DR=DR_"2//"_OLDOCC_";" S:+($G(TIME))>0 DR=DR_"3//"_OLDLIM_";"
"RTN","GMTSRM1",69,0)
 S:+($G(HOSP))>0 DR=DR_"6//"_OLDHOSP_";" S:+($G(ICD))>0 DR=DR_"7//"_OLDICD_";"
"RTN","GMTSRM1",70,0)
 S:+($G(PROV))>0 DR=DR_"8//"_OLDPROV_";" S:+($G(CPT))>0 DR=DR_"9//"_OLDCPT_";"
"RTN","GMTSRM1",71,0)
 S DIE="^GMT(142,"_GMTSIFN_",1,",DA(1)=GMTSIFN,DA=CMP(.01)
"RTN","GMTSRM1",72,0)
 ; DBIA 10018 call ^DIE
"RTN","GMTSRM1",73,0)
 D ^DIE Q:$D(Y)
"RTN","GMTSRM1",74,0)
 ;
"RTN","GMTSRM1",75,0)
 ; Second Edit     4  Selection Item       142.14 Items
"RTN","GMTSRM1",76,0)
 ;                 5  Header Name          F 2-20
"RTN","GMTSRM1",77,0)
 ;
"RTN","GMTSRM1",78,0)
 S DR(2,142.14)=".01;D EXIT^GMTSRM3 I +SELCNT,(GMTSNCNT'<SELCNT) S DTOUT="""""
"RTN","GMTSRM1",79,0)
 S DR="5//^S X=$G(OLDHEAD);I 'SEL S Y=0;D EN^GMTSRM3;4"
"RTN","GMTSRM1",80,0)
 ; DBIA 10018 call ^DIE
"RTN","GMTSRM1",81,0)
 D ^DIE K DIC("V")
"RTN","GMTSRM1",82,0)
 Q
"RTN","GMTSRM1",83,0)
CHKCMP ; Checks selected component for duplication
"RTN","GMTSRM1",84,0)
 N DIR,SEL,SO,SOACTION
"RTN","GMTSRM1",85,0)
 K OLDSO
"RTN","GMTSRM1",86,0)
 S SOACTION="",CMP=+Y,CMP("NM")=$P(Y,U,2),(NXTCMP(0),NXTCMP)=NXTCMP+1
"RTN","GMTSRM1",87,0)
 I '$D(^GMT(142,GMTSIFN,1,"C",+CMP)) D  Q
"RTN","GMTSRM1",88,0)
 . S CMP(1)=+CMP,CNT=$$GETCNT^GMTSRM(GMTSIFN)
"RTN","GMTSRM1",89,0)
 . I +CMP>300,$O(^GMT(142.1,+CMP(1),1,0)),'$D(CMP(142.14)) D GETSEL^GMTSRM1A(.CMP)
"RTN","GMTSRM1",90,0)
 S SO=$O(^GMT(142,GMTSIFN,1,"C",+CMP,0))
"RTN","GMTSRM1",91,0)
 W !,$P(Y,U,2)," is already a component of this summary."
"RTN","GMTSRM1",92,0)
 S DIR(0)="SO^E:Edit component parameters;D:Delete component from summary;"
"RTN","GMTSRM1",93,0)
 S DIR("A")="Select Action"
"RTN","GMTSRM1",94,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSRM1",95,0)
 D ^DIR K DIR
"RTN","GMTSRM1",96,0)
 I $D(DUOUT) S NXTCMP=NXTCMP-1 Q
"RTN","GMTSRM1",97,0)
 I $D(DIRUT)&('$D(DTOUT)) S GMTSQIT=$S('$D(GMCMP):"D",1:1) W ! Q
"RTN","GMTSRM1",98,0)
 I $D(DIRUT) S GMTSQIT=1 Q
"RTN","GMTSRM1",99,0)
 S OLDSO=SO I Y="D" S SOACTION="D" D DELCMP^GMTSRM4 W ! S GMTSQIT="D" Q
"RTN","GMTSRM1",100,0)
 S SOACTION="E",CMP(1)=+CMP,CNT=SO K Y
"RTN","GMTSRM1",101,0)
 S CMP(0)=^GMT(142,GMTSIFN,1,SO,0)
"RTN","GMTSRM1",102,0)
 S SEL=0 F  S SEL=$O(^GMT(142,GMTSIFN,1,SO,1,SEL)) Q:+SEL'>0  S CMP(142.14,SEL)=^(SEL,0)
"RTN","GMTSRM1",103,0)
 I +CMP>100,$O(^GMT(142.1,+CMP(1),1,0)),'$D(CMP(142.14)) D
"RTN","GMTSRM1",104,0)
 . D GETSEL^GMTSRM1A(.CMP)
"RTN","GMTSRM1",105,0)
 Q
"RTN","GMTSRM5")
0^27^B7479939
"RTN","GMTSRM5",1,0)
GMTSRM5 ;SLC/DLT - Create/Modify - Copy from existing type ; 07/18/2000
"RTN","GMTSRM5",2,0)
 ;;2.7;Health Summary;**30,37**;Oct 20, 1995
"RTN","GMTSRM5",3,0)
 ;
"RTN","GMTSRM5",4,0)
SELCMP ;Select components from existing health summary type
"RTN","GMTSRM5",5,0)
 N DIC,DIR,GMI,GMTSEG,GMTSEGI,GMTSTITL,GMTSTYP,I,SEQ,X,XQORM,Y
"RTN","GMTSRM5",6,0)
 W ! S DIR(0)="Y",DIR("A")="Do you wish to copy COMPONENTS from an existing Health Summary Type",DIR("B")="YES"
"RTN","GMTSRM5",7,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSRM5",8,0)
 D ^DIR S:+Y'>0 EXISTS=0 S:$D(DTOUT)!($D(DIROUT)) GMTSQIT=1 K DIR Q:+Y'>0
"RTN","GMTSRM5",9,0)
 W ! S GMTSQIT=0,DIC=142,DIC(0)="AEFQMZ",DIC("A")="Select Health Summary Type to copy from: "
"RTN","GMTSRM5",10,0)
 S Y=$$TYPE^GMTSULT K DIC S:Y=-1 GMTSQIT=1 Q:GMTSQIT  S GMTSTYP=+Y,GMTSTITL=$P(Y,U,2)
"RTN","GMTSRM5",11,0)
 W @IOF,"The Following Components are Available:",!
"RTN","GMTSRM5",12,0)
 S XQORM("S")="I $P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""Y"""
"RTN","GMTSRM5",13,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="DA",XQORM("A")="Select COMPONENTS(S): ",XQORM("??")="D HELP^GMTSRM2"
"RTN","GMTSRM5",14,0)
 ; DBIA 10140 call EN^XQORM
"RTN","GMTSRM5",15,0)
 D EN^XQORM I Y'>0 S GMTSQIT=1 K XQORM,Y Q
"RTN","GMTSRM5",16,0)
 S (X,GMI,SEQ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  S X=^GMT(142,GMTSTYP,1,+Y(GMI),0) I $P(X,U,2) S SEQ=SEQ+1,GMTSEG(SEQ)=X,GMTSEGI($P(X,U,2))=SEQ D SETUPSEL
"RTN","GMTSRM5",17,0)
 ;Load global from GMTSEG() array.
"RTN","GMTSRM5",18,0)
 S:'$D(^GMT(142,GMTSIFN,1,0)) ^(0)="^142.01IA^0^0"
"RTN","GMTSRM5",19,0)
 W !!,"Loading components into the Health Summary Type with defaults"
"RTN","GMTSRM5",20,0)
 S EXISTS=1
"RTN","GMTSRM5",21,0)
 S SEQ=0 F  S SEQ=$O(GMTSEG(SEQ)) Q:'SEQ  D LOADCMP
"RTN","GMTSRM5",22,0)
 Q
"RTN","GMTSRM5",23,0)
LOADCMP ; Call DIE to stuff STRUCTURE multiple for each component
"RTN","GMTSRM5",24,0)
 N ISEQ,DA,DIE,DR,CNT,SDA,S2
"RTN","GMTSRM5",25,0)
 S (ISEQ,DA)=SEQ*5,DIE="^GMT(142,"_GMTSIFN_",1,",DA(1)=GMTSIFN
"RTN","GMTSRM5",26,0)
 S DR=".01///"_DA_";1///"_$P(GMTSEG(SEQ),U,2)_";2///"_$P(GMTSEG(SEQ),U,3)
"RTN","GMTSRM5",27,0)
 S DR=DR_";3///"_$P(GMTSEG(SEQ),U,4)_";5///"_$P(GMTSEG(SEQ),U,5)
"RTN","GMTSRM5",28,0)
 S DR=DR_";6///"_$P(GMTSEG(SEQ),U,6)_";7///"_$P(GMTSEG(SEQ),U,7)
"RTN","GMTSRM5",29,0)
 S DR=DR_";8///"_$P(GMTSEG(SEQ),U,8)_";9///"_$P(GMTSEG(SEQ),U,9)
"RTN","GMTSRM5",30,0)
 ; DBIA 10018 call ^DIE
"RTN","GMTSRM5",31,0)
 D ^DIE
"RTN","GMTSRM5",32,0)
 S (CNT,S2)=0 F  S S2=$O(GMTSEG(SEQ,S2)) Q:'S2  D LOADSEL
"RTN","GMTSRM5",33,0)
 I CNT>0 S:'$D(^GMT(142,GMTSIFN,1,ISEQ,1,0)) ^(0)="^142.14V^"_SDA_"^"_CNT
"RTN","GMTSRM5",34,0)
 Q
"RTN","GMTSRM5",35,0)
LOADSEL ; Loads selection item multiple
"RTN","GMTSRM5",36,0)
 N DIE,DA,DR
"RTN","GMTSRM5",37,0)
 S:'$D(^GMT(142,GMTSIFN,1,ISEQ,1,0)) ^(0)="^142.14V^^"
"RTN","GMTSRM5",38,0)
 S DIE="^GMT(142,"_GMTSIFN_",1,"_ISEQ_",1,",DA(2)=GMTSIFN,DA(1)=ISEQ,DA=S2,DR=".01////"_"^S X=GMTSEG(SEQ,S2)"
"RTN","GMTSRM5",39,0)
 ; DBIA 10018 call ^DIE
"RTN","GMTSRM5",40,0)
 D ^DIE S SDA=DA,CNT=CNT+1
"RTN","GMTSRM5",41,0)
 Q
"RTN","GMTSRM5",42,0)
SETUPSEL ;Setup default selection items into new summary type
"RTN","GMTSRM5",43,0)
 N S2,SEL
"RTN","GMTSRM5",44,0)
 S S2=0 F  S S2=$O(^GMT(142,GMTSTYP,1,+Y(GMI),1,S2)) Q:'S2  S SEL=^(S2,0) S GMTSEG(SEQ,S2)=SEL
"RTN","GMTSRM5",45,0)
 Q
"RTN","GMTSRO")
0^5^B32490168
"RTN","GMTSRO",1,0)
GMTSRO ; SLC/JER,KER - All Surgery Reports ; 07/18/2000
"RTN","GMTSRO",2,0)
 ;;2.7;Health Summary;**9,11,28,37**;Oct 20, 1995
"RTN","GMTSRO",3,0)
 ;                               
"RTN","GMTSRO",4,0)
ENSRO ;Entry point for Surgery Only Component
"RTN","GMTSRO",5,0)
 S GMTSSO=1
"RTN","GMTSRO",6,0)
 ;                               
"RTN","GMTSRO",7,0)
ENSR ; Entry point for SURGERY REPORT component, includes NON-OR procedures
"RTN","GMTSRO",8,0)
 N GMTSMX,GMCOUNT,GMIDT,GMN,SURG,GMTSGL S GMTSGL=$$GL^GMTSROE Q:'$L(GMTSGL)  Q:'$D(@(GMTSGL_"""B"","_DFN_")"))
"RTN","GMTSRO",9,0)
 S GMTSMX=999 I $D(GMTSNDM),(GMTSNDM>0) S GMTSMX=GMTSNDM
"RTN","GMTSRO",10,0)
 S GMN=0 F  S GMN=$O(@(GMTSGL_"""B"","_DFN_","_GMN_")")) Q:GMN'>0  D SORT
"RTN","GMTSRO",11,0)
 Q:'$D(SURG)  S (GMCOUNT,GMIDT)=0 F  S GMIDT=$O(SURG(GMIDT)) Q:GMIDT'>0!(GMCOUNT'<GMTSMX)  S GMN=SURG(GMIDT) D WRT Q:$D(GMTSQIT)
"RTN","GMTSRO",12,0)
 K GMTSSO Q
"RTN","GMTSRO",13,0)
 ;                               
"RTN","GMTSRO",14,0)
SORT ; Sort surgeries by inverted date
"RTN","GMTSRO",15,0)
 N GMDT S GMDT=$P($G(@(GMTSGL_GMN_",0)")),U,9) I GMDT>GMTSBEG&(GMDT<GMTSEND) D
"RTN","GMTSRO",16,0)
 . F  Q:'$D(SURG(9999999-GMDT))  S GMDT=GMDT+.0001
"RTN","GMTSRO",17,0)
 . S SURG(9999999-GMDT)=GMN
"RTN","GMTSRO",18,0)
 Q
"RTN","GMTSRO",19,0)
 ;                               
"RTN","GMTSRO",20,0)
WRT ; Write surgical case record
"RTN","GMTSRO",21,0)
 N REC,X,GMI,GMJ,GMDT,GMTSTR D ONE^GMTSROE(GMN)
"RTN","GMTSRO",22,0)
 ;
"RTN","GMTSRO",23,0)
NONOP ;   Non-Op Procedure
"RTN","GMTSRO",24,0)
 I $G(REC(130,GMN,118,"I"))="Y" Q:$G(GMTSSO)  D WRT^GMTSRON Q
"RTN","GMTSRO",25,0)
 S GMCOUNT=GMCOUNT+1
"RTN","GMTSRO",26,0)
OPER ;   Operative Procedure
"RTN","GMTSRO",27,0)
SS ;     Date/Specialty/Surgeon
"RTN","GMTSRO",28,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRO",29,0)
 S GMDT=$G(REC(130,GMN,.09,"S")) S:'$L(GMDT) GMDT=$$ED^GMTSU($G(REC(130,GMN,.09,"I")))
"RTN","GMTSRO",30,0)
 S GMTSTR=$G(REC(130,GMN,.04,"S")) S:$L($G(GMTSTR))>25 GMTSTR=$$WRAP^GMTSORC(GMTSTR,25)
"RTN","GMTSRO",31,0)
 W $G(GMDT),?21,$P($G(GMTSTR),"|"),?47,"Surgeon:",?56,$G(REC(130,GMN,.14,"E")),!
"RTN","GMTSRO",32,0)
 F GMI=2:1:$L($G(GMTSTR),"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?23,$P($G(GMTSTR),"|",GMI),!
"RTN","GMTSRO",33,0)
 ;
"RTN","GMTSRO",34,0)
SPA ;     Status/Principal Anesthetist
"RTN","GMTSRO",35,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRO",36,0)
 W ?13,"Status:",?21,$G(REC(130,GMN,"STATUS"))
"RTN","GMTSRO",37,0)
 W ?44,"Prin Anest:",?56,$G(REC(130,GMN,.31,"E")),!
"RTN","GMTSRO",38,0)
PREDX ;     Principal Pre-Op Diagnosis
"RTN","GMTSRO",39,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?5,"Pre-op Diag(s):"
"RTN","GMTSRO",40,0)
 S GMTSTR=$G(REC(130,GMN,32,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,32,"E"))
"RTN","GMTSRO",41,0)
 S:$L(GMTSTR)&($L($G(REC(130,GMN,"VERIFIED")))) GMTSTR=GMTSTR_" "_$G(REC(130,GMN,"VERIFIED")) S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRO",42,0)
 F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRO",43,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ) W !
"RTN","GMTSRO",44,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRO",45,0)
OPREDX ;       Other Pre-Op Diagnosis
"RTN","GMTSRO",46,0)
 S GMI=0 F  S GMI=$O(REC(130,GMN,130.17,GMI)) Q:GMI'>0  D
"RTN","GMTSRO",47,0)
 . S GMTSTR=$G(REC(130,GMN,130.17,GMI,.01,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,130.17,GMI,.01,"E"))
"RTN","GMTSRO",48,0)
 . S:$L(GMTSTR)&($L($G(REC(130,GMN,"VERIFIED")))) GMTSTR=GMTSTR_" "_$G(REC(130,GMN,"VERIFIED")) S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRO",49,0)
 . F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRO",50,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ) W !
"RTN","GMTSRO",51,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRO",52,0)
PSTDX ;     Post-Op Diagnosis
"RTN","GMTSRO",53,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?4,"Post-op Diag(s):"
"RTN","GMTSRO",54,0)
 S GMTSTR=$G(REC(130,GMN,34,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,34,"E")) S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRO",55,0)
 F GMJ=1:1:$L(GMTSTR,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ) W:GMJ=1&(GMTSTR?1.A.E) " ",$G(REC(130,GMN,"VERIFIED")) W !
"RTN","GMTSRO",56,0)
OPSTDX ;       Other Post-Op Diagnosis
"RTN","GMTSRO",57,0)
 S GMI=0 F  S GMI=$O(REC(130,GMN,130.18,GMI)) Q:GMI'>0  D
"RTN","GMTSRO",58,0)
 . S GMTSTR=$G(REC(130,GMN,130.18,GMI,.01,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,130.18,GMI,.01,"E")) S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRO",59,0)
 . F GMJ=1:1:$L(GMTSTR,"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ) W:GMJ=1&(GMTSTR?1.A.E) " ",$G(REC(130,GMN,"VERIFIED")) W !
"RTN","GMTSRO",60,0)
OP ;     Operative Procedures
"RTN","GMTSRO",61,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?2,"Operative Proc(s):" S GMTSTR=$G(REC(130,GMN,26,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,26,"E")) S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRO",62,0)
 F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRO",63,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRO",64,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRO",65,0)
OPM ;       Operative Procedures (Modifiers)
"RTN","GMTSRO",66,0)
 S GMI=0 F  S GMI=$O(REC(130,GMN,130.028,GMI)) Q:GMI'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRO",67,0)
 . S GMTSTR=$G(REC(130,GMN,130.028,GMI,.01,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,130.028,GMI,.01,"E")) S:$L(GMTSTR)>54 GMTSTR=$$WRAP^GMTSORC(GMTSTR,54)
"RTN","GMTSRO",68,0)
 . F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRO",69,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:25,1:26),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRO",70,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRO",71,0)
OOP ;     Other Procedures
"RTN","GMTSRO",72,0)
 S GMI=0 F  S GMI=$O(REC(130,GMN,130.16,GMI)) Q:GMI'>0  D
"RTN","GMTSRO",73,0)
 . S GMTSTR=$G(REC(130,GMN,130.16,GMI,.01,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,130.16,GMI,.01,"E")) S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRO",74,0)
 . F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRO",75,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRO",76,0)
 . . W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRO",77,0)
OOPM . ;       Other Operative Procedures (Modifiers)
"RTN","GMTSRO",78,0)
 . N GMM S GMM=0 F  S GMM=$O(REC(130,GMN,130.16,GMI,130.164,GMM)) Q:+GMM=0  D
"RTN","GMTSRO",79,0)
 . . S GMTSTR=$G(REC(130,GMN,130.16,GMI,130.164,GMM,.01,"S")) S:'$L(GMTSTR) GMTSTR=$G(REC(130,GMN,130.16,GMI,130.164,GMM,.01,"E")) S:$L(GMTSTR)>54 GMTSTR=$$WRAP^GMTSORC(GMTSTR,54)
"RTN","GMTSRO",80,0)
 . . F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRO",81,0)
 . . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:25,1:26),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRO",82,0)
 . Q:$D(GMTSQIT)
"RTN","GMTSRO",83,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRO",84,0)
LAB ;     Lab Work
"RTN","GMTSRO",85,0)
 I $L($G(REC(130,GMN,"LAB"))) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?11,"Lab Work: ",$G(REC(130,GMN,"LAB")),!
"RTN","GMTSRO",86,0)
RPTDT ;     Dates
"RTN","GMTSRO",87,0)
DICDT ;       Dictation Date
"RTN","GMTSRO",88,0)
 S GMTSTR=$G(REC(130,GMN,15,"S")) S:'$L(GMTSTR) GMTSTR=$G(REC(130,GMN,15,"E"))
"RTN","GMTSRO",89,0)
 I $L(GMTSTR) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?5,"Dictation Time:",?21,GMTSTR
"RTN","GMTSRO",90,0)
TRCDT ;       Transcription Time
"RTN","GMTSRO",91,0)
 S GMTSTR=$G(REC(130,GMN,39,"S")) S:'$L(GMTSTR) GMTSTR=$G(REC(130,GMN,39,"E"))
"RTN","GMTSRO",92,0)
 I $L(GMTSTR) D CKP^GMTSUP Q:$D(GMTSQIT)  W ?41,"Transcription Time:",?61,GMTSTR
"RTN","GMTSRO",93,0)
 D:$L(REC(130,GMN,15,"I"))!($L(REC(130,GMN,39,"I"))) CKP^GMTSUP Q:$D(GMTSQIT)  W:$L(REC(130,GMN,15,"I"))!($L(REC(130,GMN,39,"I"))) !
"RTN","GMTSRO",94,0)
RPT ;     Dictation
"RTN","GMTSRO",95,0)
 I $O(REC(130,GMN,1.15,0))>0 D
"RTN","GMTSRO",96,0)
 . N GMI D CKP^GMTSUP Q:$D(GMTSQIT)  W "Surgeon's Dictation:",!
"RTN","GMTSRO",97,0)
 . S GMI=0 F  S GMI=$O(REC(130,GMN,1.15,GMI)) Q:+GMI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRO",98,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?2,$G(REC(130,GMN,1.15,GMI)),!
"RTN","GMTSRO",99,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRO",100,0)
 Q
"RTN","GMTSROE")
0^6^B60909758
"RTN","GMTSROE",1,0)
GMTSROE ; SLC/KER - Surgery Extract                   ; 07/18/2000
"RTN","GMTSROE",2,0)
 ;;2.7;Health Summary;**37**;Oct 20, 1995
"RTN","GMTSROE",3,0)
 ;
"RTN","GMTSROE",4,0)
 Q
"RTN","GMTSROE",5,0)
ONE(X) ;
"RTN","GMTSROE",6,0)
 K REC N GMTSCPTM,GMSG,DA,DR,DIC,DIQ,IEN,IENS,FILE,FLD,FLDS,FLDI
"RTN","GMTSROE",7,0)
 N FLDA,FLDB,FLDR,FLDRT,IEN,GMTSI,GMTSRT,GMTST,GMTSS,GMTSC,GMTSCS
"RTN","GMTSROE",8,0)
 S GMTSCPTM=+($$CPT^GMTSU(+($G(GMTSEGN)))) S:$G(GMPXCMOD)="N" GMTSCPTM=0
"RTN","GMTSROE",9,0)
 ; DBIA 641 access ^SRF
"RTN","GMTSROE",10,0)
 Q:'$D(^SRF(X,0))  S (IENS,IEN,X)=+($G(X)),U="^"
"RTN","GMTSROE",11,0)
 ; DBIA 10103 call $$HTFM^XLFDT
"RTN","GMTSROE",12,0)
 S:'$D(DT) DT=$$HTFM^XLFDT($H,1) S:'$D(DTIME) DTIME=300
"RTN","GMTSROE",13,0)
 S (FILE,DIC)=130,DA=+($G(X)),DIQ="REC(",DIQ(0)="IE"
"RTN","GMTSROE",14,0)
 S GMSG=$$SG(IEN),REC(130,IEN,118,"E")=$S(GMSG=0:"YES",1:""),REC(130,IEN,118,"I")=$S(GMSG=0:"Y",1:"")
"RTN","GMTSROE",15,0)
 S:+GMSG DR=".09;.04;.14;.205;.22;.23;.31;1.15;10;15;17;26;27;32;34;36;39;43;49"
"RTN","GMTSROE",16,0)
 S:'GMSG DR=".09;.31;26;27;33;55;59;66;1.15;121;122;123;124;125"
"RTN","GMTSROE",17,0)
 ; DBIA 10015 call EN^DIQ1
"RTN","GMTSROE",18,0)
 D EN^DIQ1 S REC(130,IEN,"STATUS")=$$OS(IEN) S:+GMSG REC(130,IEN,"VERIFIED")=$S($G(REC(130,IEN,43,"I"))'="Y":"(Unverified)",1:"")
"RTN","GMTSROE",19,0)
 S GMTSM=$G(REC(130,IEN,27,"I")) I GMTSM>0 D
"RTN","GMTSROE",20,0)
 . S GMTSC=$$CPT^ICPTCOD(GMTSM),(GMTSCS,GMTSS)=$$EN2^GMTSUMX($P(GMTSC,"^",3))
"RTN","GMTSROE",21,0)
 . S REC(130,IEN,27,"X")=$P(GMTSC,"^",2)_"^"_$P(GMTSC,"^",3)
"RTN","GMTSROE",22,0)
 . S GMTSC=$P(GMTSC,"^",2),GMTST=$$EN2^GMTSUMX($G(REC(130,IEN,26,"E")))
"RTN","GMTSROE",23,0)
 . S:$L(GMTSS)&(GMTSS'=GMTST) GMTST=GMTST_" - "_GMTSS
"RTN","GMTSROE",24,0)
 . S:$L(GMTSC)=5 GMTST=GMTST_" (CPT "_GMTSC_")",GMTSCS=GMTSCS_" (CPT "_GMTSC_")"
"RTN","GMTSROE",25,0)
 . S REC(130,IEN,27,"N")=GMTSS
"RTN","GMTSROE",26,0)
 . S (REC(130,IEN,26,"S"),REC(130,IEN,27,"S"))=GMTST
"RTN","GMTSROE",27,0)
 . S REC(130,IEN,27,"S")=GMTSCS
"RTN","GMTSROE",28,0)
 D SUB
"RTN","GMTSROE",29,0)
 S:$D(REC(130,IEN,32)) REC(130,IEN,32,"S")=$$EN2^GMTSUMX($G(REC(130,IEN,32,"E")))
"RTN","GMTSROE",30,0)
 S:$D(REC(130,IEN,33)) REC(130,IEN,33,"S")=$$EN2^GMTSUMX($G(REC(130,IEN,33,"E")))
"RTN","GMTSROE",31,0)
 S:$D(REC(130,IEN,34)) REC(130,IEN,34,"S")=$$EN2^GMTSUMX($G(REC(130,IEN,34,"E")))
"RTN","GMTSROE",32,0)
 S:$D(REC(130,IEN,.04)) REC(130,IEN,.04,"S")=$$EN2^GMTSUMX($G(REC(130,IEN,.04,"E")))
"RTN","GMTSROE",33,0)
 S:$D(REC(130,IEN,125)) REC(130,IEN,125,"S")=$$EN2^GMTSUMX($G(REC(130,IEN,125,"E")))
"RTN","GMTSROE",34,0)
 I $L($G(REC(130,IEN,33,"S"))) D
"RTN","GMTSROE",35,0)
 . S:'$L($G(REC(130,IEN,66,"E"))) REC(130,IEN,33,"S")=$G(REC(130,IEN,33,"S"))_" (Unknown)"
"RTN","GMTSROE",36,0)
 . S:$L($G(REC(130,IEN,66,"E"))) REC(130,IEN,33,"S")=$G(REC(130,IEN,33,"S"))_" (ICD "_$G(REC(130,IEN,66,"E"))_")"
"RTN","GMTSROE",37,0)
 S:+($G(REC(130,IEN,.09,"I")))>0 REC(130,IEN,.09,"S")=$$ED^GMTSU($G(REC(130,IEN,.09,"I")))
"RTN","GMTSROE",38,0)
 S:+($G(REC(130,IEN,15,"I")))>0 REC(130,IEN,15,"S")=$$EDT^GMTSU($G(REC(130,IEN,15,"I")))
"RTN","GMTSROE",39,0)
 S:+($G(REC(130,IEN,39,"I"))) REC(130,IEN,39,"S")=$$EDT^GMTSU($G(REC(130,IEN,39,"I")))
"RTN","GMTSROE",40,0)
 S:+GMSG REC(130,IEN,"LAB")=$S($O(REC(130,IEN,49,0))>0:"Yes",1:"")
"RTN","GMTSROE",41,0)
 I 'GMSG D:+($O(REC(130,IEN,55,0)))>0 WP(IEN,55,58) D:+($O(REC(130,IEN,59,0)))>0 WP(IEN,59,58)
"RTN","GMTSROE",42,0)
 Q
"RTN","GMTSROE",43,0)
WP(X,Y,Z) ;
"RTN","GMTSROE",44,0)
 N GMTSI,GMTSF,GMTSW,GMI,DIWF,DIWL,DIWR
"RTN","GMTSROE",45,0)
 S GMTSI=+($G(X)) Q:GMTSI=0!('$D(REC(130,GMTSI)))
"RTN","GMTSROE",46,0)
 S GMTSF=+($G(Y)) Q:GMTSF=0!('$D(REC(130,GMTSI,GMTSF)))
"RTN","GMTSROE",47,0)
 S GMTSW=+($G(Z)) Q:GMTSW'>0!(GMTSW>79)
"RTN","GMTSROE",48,0)
 Q:+($O(REC(130,GMTSI,GMTSF,0)))'>0
"RTN","GMTSROE",49,0)
 K ^UTILITY($J,"W") S DIWF="C"_GMTSW,DIWL=0,DIWR=0,GMI=0
"RTN","GMTSROE",50,0)
 F  S GMI=$O(REC(130,GMTSI,GMTSF,GMI)) Q:+GMI=0  D
"RTN","GMTSROE",51,0)
 . S X=$G(REC(130,GMTSI,GMTSF,GMI))
"RTN","GMTSROE",52,0)
 . ; DBIA 10011 call ^DIWP
"RTN","GMTSROE",53,0)
 . D ^DIWP
"RTN","GMTSROE",54,0)
 S GMI=0 F  S GMI=$O(^UTILITY($J,"W",0,GMI)) Q:+GMI=0  D
"RTN","GMTSROE",55,0)
 . S REC(130,GMTSI,GMTSF,"S",GMI)=$G(^UTILITY($J,"W",0,GMI,0))
"RTN","GMTSROE",56,0)
 . S REC(130,GMTSI,GMTSF,"S",0)=$G(REC(130,GMTSI,GMTSF,"S",0))+1
"RTN","GMTSROE",57,0)
 K ^UTILITY($J,"W")
"RTN","GMTSROE",58,0)
 Q
"RTN","GMTSROE",59,0)
OS(X) ; Obtains status for OR procedures
"RTN","GMTSROE",60,0)
 N GMN S GMN=+($G(X)) S X="" I $G(REC(130,GMN,118,"I"))="Y" D  Q X
"RTN","GMTSROE",61,0)
 . S:+($G(REC(130,GMN,122,"I")))>0 X="(Completed)"
"RTN","GMTSROE",62,0)
 . S:+($G(REC(130,GMN,121,"I")))>0&(+($G(REC(130,GMN,122,"I")))'>0) X="Incomplete"
"RTN","GMTSROE",63,0)
 . S:X="" X="Unknown"
"RTN","GMTSROE",64,0)
 I +($G(REC(130,GMN,17,"I")))>0 D  Q X
"RTN","GMTSROE",65,0)
 . S X=$S(+($G(REC(130,GMN,.205,"I")))>0:"(Aborted)",1:"Cancelled")
"RTN","GMTSROE",66,0)
 I +($G(REC(130,GMN,.23,"I")))>0 S X="(Completed)" Q X
"RTN","GMTSROE",67,0)
 I +($G(REC(130,GMN,.22,"I")))>0 S X="Incomplete" Q X
"RTN","GMTSROE",68,0)
 I +($G(REC(130,GMN,10,"I")))>0 S X="Scheduled" Q X
"RTN","GMTSROE",69,0)
 I +($G(REC(130,GMN,36,"I")))>0,+($G(REC(130,GMN,.22,"I")))'>0 S X="Requested" Q X
"RTN","GMTSROE",70,0)
 S X="Unknown"
"RTN","GMTSROE",71,0)
 Q X
"RTN","GMTSROE",72,0)
SUB ;
"RTN","GMTSROE",73,0)
 N DA,DR,DIC,DIQ,IENS,FILE,FLD,FLDS,FLDI,FLDA,FLDB,FLDR,FLDRT,GMTSM,GMTSC,GMTSI,GMTSJ,STXT,SNAM,SCOD,SUB
"RTN","GMTSROE",74,0)
 I +GMSG D
"RTN","GMTSROE",75,0)
 . ;
"RTN","GMTSROE",76,0)
 . ;------------------------------------------------------------------
"RTN","GMTSROE",77,0)
 . ;
"RTN","GMTSROE",78,0)
 . ; ^SRF(DO,14,I)                .72  Other Preop Diag    14;0  130.17
"RTN","GMTSROE",79,0)
 . ; $P(^SRF(DO,14,I,0),U)        .01  Other Preop Diag     0;1  Text
"RTN","GMTSROE",80,0)
 . ;
"RTN","GMTSROE",81,0)
 . S DA=IEN,(FILE,DIC)=130,SUB=130.17,DR=.72,DR(SUB)=".01",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","GMTSROE",82,0)
 . ; DBIA 2491 access ^SRF
"RTN","GMTSROE",83,0)
 . K REC(SUB) S GMTSI=0 F  S GMTSI=$O(^SRF(+($G(IEN)),14,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSROE",84,0)
 . . S DA(SUB)=GMTSI
"RTN","GMTSROE",85,0)
 . . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSROE",86,0)
 . . D EN^DIQ1
"RTN","GMTSROE",87,0)
 . . S REC(130,IEN,130.17,GMTSI,.01,"S")=$$EN2^GMTSUMX($G(REC(130,IEN,130.17,GMTSI,.01,"E")))
"RTN","GMTSROE",88,0)
 . ;
"RTN","GMTSROE",89,0)
 . ;------------------------------------------------------------------
"RTN","GMTSROE",90,0)
 . ;
"RTN","GMTSROE",91,0)
 . ; ^SRF(DO,15,I)                .74  Other Postop Diags  15;0  130.18
"RTN","GMTSROE",92,0)
 . ; $P(^SRF(DO,15,I,0),U)        .01  Other Postop Diags   0;1  Text
"RTN","GMTSROE",93,0)
 . ;
"RTN","GMTSROE",94,0)
 . S DA=IEN,(FILE,DIC)=130,SUB=130.18,DR=.74,DR(SUB)=".01",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","GMTSROE",95,0)
 . ; DBIA 2491 access ^SRF
"RTN","GMTSROE",96,0)
 . K REC(SUB) S GMTSI=0 F  S GMTSI=$O(^SRF(+($G(IEN)),15,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSROE",97,0)
 . . S DA(SUB)=GMTSI
"RTN","GMTSROE",98,0)
 . . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSROE",99,0)
 . . D EN^DIQ1
"RTN","GMTSROE",100,0)
 . . S REC(130,IEN,130.18,GMTSI,.01,"S")=$$EN2^GMTSUMX($G(REC(130,IEN,130.18,GMTSI,.01,"E")))
"RTN","GMTSROE",101,0)
 ;
"RTN","GMTSROE",102,0)
 ;--------------------------------------------------------------------
"RTN","GMTSROE",103,0)
 ;
"RTN","GMTSROE",104,0)
 ; ^SRF(GMN,"OPMOD",I)           28  Pri Pro CPT Mod  OPMOD;0  130.028
"RTN","GMTSROE",105,0)
 ; $P(^SRF(GMN,"OPMOD",I,0),U)  .01  Pri Pro CPT Mod      0;1  Ptr 81.3
"RTN","GMTSROE",106,0)
 ;
"RTN","GMTSROE",107,0)
 I GMTSCPTM D
"RTN","GMTSROE",108,0)
 . S DA=IEN,(FILE,DIC)=130,SUB=130.028,DR=28,DR(SUB)=".01",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","GMTSROE",109,0)
 . ; DBIA 2491 access ^SRF
"RTN","GMTSROE",110,0)
 . K REC(SUB) S GMTSI=0 F  S GMTSI=$O(^SRF(+($G(IEN)),"OPMOD",GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSROE",111,0)
 . . S DA(SUB)=GMTSI
"RTN","GMTSROE",112,0)
 . . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSROE",113,0)
 . . D EN^DIQ1
"RTN","GMTSROE",114,0)
 . . S GMTSM=+($G(REC(130,+($G(IEN)),SUB,+($G(GMTSI)),.01,"I")))
"RTN","GMTSROE",115,0)
 . . I GMTSM>0 D
"RTN","GMTSROE",116,0)
 . . . ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSROE",117,0)
 . . . S GMTSC=$$GET1^DIQ(81.3,+GMTSM,.01,"E")
"RTN","GMTSROE",118,0)
 . . . ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSROE",119,0)
 . . . S GMTSS=$$GET1^DIQ(81.3,+GMTSM,.02,"E")
"RTN","GMTSROE",120,0)
 . . . S REC(130,IEN,SUB,GMTSI,.01,"MID")=GMTSC
"RTN","GMTSROE",121,0)
 . . . S REC(130,IEN,SUB,GMTSI,.01,"MOD")=GMTSS
"RTN","GMTSROE",122,0)
 . . . S GMTST=$$EN2^GMTSUMX(GMTSS)
"RTN","GMTSROE",123,0)
 . . . S:$L(GMTSC) GMTST=GMTST_" (CPT Mod "_GMTSC_")"
"RTN","GMTSROE",124,0)
 . . . S REC(130,IEN,SUB,GMTSI,.01,"S")=GMTST
"RTN","GMTSROE",125,0)
 ;
"RTN","GMTSROE",126,0)
 ;--------------------------------------------------------------------
"RTN","GMTSROE",127,0)
 ;
"RTN","GMTSROE",128,0)
 ; ^SRF(DO,13,I)                .42  Other Proc          13;0  130.16
"RTN","GMTSROE",129,0)
 ; $P(^SRF(DO,13,I,0),U)        .01  Other Proc           0;1  Text      
"RTN","GMTSROE",130,0)
 ; $P(^SRF(DO,13,I,2),U)          3  Other Proc CPT Code  2;1  Ptr 81
"RTN","GMTSROE",131,0)
 ;
"RTN","GMTSROE",132,0)
 S DA=IEN,(FILE,DIC)=130,SUB=130.16,DR=.42,DR(SUB)=".01;3",DIQ="REC(130,"_IEN_",",DIQ(0)="IE"
"RTN","GMTSROE",133,0)
 ; DBIA 2491 access ^SRF
"RTN","GMTSROE",134,0)
 K REC(SUB) S GMTSI=0 F  S GMTSI=$O(^SRF(+($G(IEN)),13,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSROE",135,0)
 . S DA(SUB)=GMTSI
"RTN","GMTSROE",136,0)
 . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSROE",137,0)
 . D EN^DIQ1 S GMTSM=+($G(REC(130,IEN,130.16,GMTSI,3,"I")))
"RTN","GMTSROE",138,0)
 . ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSROE",139,0)
 . S:GMTSM>0 REC(130,IEN,130.16,GMTSI,3,"N")=$$GET1^DIQ(81,+GMTSM,2,"E")
"RTN","GMTSROE",140,0)
 . N GMTST,GMTSS,GMTSC S GMTSM=$G(REC(130,IEN,130.16,GMTSI,3,"I")) I GMTSM>0 D
"RTN","GMTSROE",141,0)
 . . S GMTSC=$$CPT^ICPTCOD(GMTSM),(GMTSCS,GMTSS)=$$EN2^GMTSUMX($P(GMTSC,"^",3))
"RTN","GMTSROE",142,0)
 . . S REC(130,IEN,130.16,GMTSI,3,"X")=$P(GMTSC,"^",2)_"^"_$P(GMTSC,"^",3)
"RTN","GMTSROE",143,0)
 . . S GMTSC=$P(GMTSC,"^",2)
"RTN","GMTSROE",144,0)
 . . S GMTST=$$EN2^GMTSUMX($G(REC(130,IEN,130.16,GMTSI,.01,"E")))
"RTN","GMTSROE",145,0)
 . . S:$L(GMTSS)&(GMTSS'=GMTST) GMTST=GMTST_" - "_$$EN2^GMTSUMX(GMTSS)
"RTN","GMTSROE",146,0)
 . . S:$L(GMTSC)=5 GMTST=GMTST_" (CPT "_GMTSC_")",GMTSCS=GMTSCS_" (CPT "_GMTSC_")"
"RTN","GMTSROE",147,0)
 . . S REC(130,IEN,130.16,GMTSI,3,"N")=GMTSS
"RTN","GMTSROE",148,0)
 . . S REC(130,IEN,130.16,GMTSI,.01,"S")=GMTST
"RTN","GMTSROE",149,0)
 . . S REC(130,IEN,130.16,GMTSI,3,"S")=GMTSCS
"RTN","GMTSROE",150,0)
 . ;
"RTN","GMTSROE",151,0)
 . ;--------------------------------------------------------------------
"RTN","GMTSROE",152,0)
 . ;
"RTN","GMTSROE",153,0)
 . ;     ^SRF(8,13,2,"MOD",0)       4  Oth Proc CPT Mod   MOD;0  130.164
"RTN","GMTSROE",154,0)
 . ;     ^SRF(8,13,2,"MOD",1,0)   .01  Oth Proc CPT Mod     0;1  Ptr 81.3
"RTN","GMTSROE",155,0)
 . ;
"RTN","GMTSROE",156,0)
 . I GMTSCPTM D
"RTN","GMTSROE",157,0)
 . . ; DBIA 2491 access ^SRF
"RTN","GMTSROE",158,0)
 . . N GMTSJ S GMTSJ=0 F  S GMTSJ=$O(^SRF(+($G(IEN)),13,GMTSI,"MOD",GMTSJ)) Q:+GMTSJ=0  D
"RTN","GMTSROE",159,0)
 . . . N DA,FILE,DIC,SUB,DR,DIQ S DA=IEN,DR=.42,FILE=130,SUB=130.16,DR(SUB)="4",DA(SUB)=GMTSI,SUB=130.164,DR(SUB)=".01",DA(SUB)=GMTSJ,DIC=130,DIQ="REC(130,"_IEN_",130.16,"_GMTSI_",",DIQ(0)="IE"
"RTN","GMTSROE",160,0)
 . . . ; DBIA 10015 call EN^DIQ1
"RTN","GMTSROE",161,0)
 . . . D EN^DIQ1
"RTN","GMTSROE",162,0)
 . . . S GMTSM=+($G(REC(130,IEN,130.16,GMTSI,130.164,GMTSJ,.01,"I")))
"RTN","GMTSROE",163,0)
 . . . I GMTSM>0 D
"RTN","GMTSROE",164,0)
 . . . . ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSROE",165,0)
 . . . . S GMTSC=$$GET1^DIQ(81.3,+GMTSM,.01,"E")
"RTN","GMTSROE",166,0)
 . . . . ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSROE",167,0)
 . . . . S GMTSS=$$GET1^DIQ(81.3,+GMTSM,.02,"E")
"RTN","GMTSROE",168,0)
 . . . . S REC(130,IEN,130.16,GMTSI,SUB,GMTSJ,.01,"MID")=GMTSC
"RTN","GMTSROE",169,0)
 . . . . S REC(130,IEN,130.16,GMTSI,SUB,GMTSJ,.01,"MOD")=GMTSS
"RTN","GMTSROE",170,0)
 . . . . S REC(130,IEN,130.16,GMTSI,SUB,GMTSJ,.01,"X")=GMTSC_"^"_GMTSS
"RTN","GMTSROE",171,0)
 . . . . S GMTST=$$EN2^GMTSUMX(GMTSS) S:$L(GMTSC) GMTST=GMTST_" (CPT Mod "_GMTSC_")"
"RTN","GMTSROE",172,0)
 . . . . S REC(130,IEN,130.16,GMTSI,SUB,GMTSJ,.01,"S")=GMTST
"RTN","GMTSROE",173,0)
 . . . K REC(130,IEN,130.16,GMTSI,130)
"RTN","GMTSROE",174,0)
 Q
"RTN","GMTSROE",175,0)
SORT ; Sort surgeries by inverted date
"RTN","GMTSROE",176,0)
 N GMDT
"RTN","GMTSROE",177,0)
 ; DBIA 641 access ^SRF
"RTN","GMTSROE",178,0)
 S GMDT=$P(^SRF(GMN,0),U,9) I GMDT>GMTSBEG&(GMDT<GMTSEND) D
"RTN","GMTSROE",179,0)
 . F  Q:'$D(SURG(9999999-GMDT))  S GMDT=GMDT+.0001
"RTN","GMTSROE",180,0)
 . S SURG(9999999-GMDT)=GMN
"RTN","GMTSROE",181,0)
 Q
"RTN","GMTSROE",182,0)
GL(X) ; Global Location
"RTN","GMTSROE",183,0)
 N FIL
"RTN","GMTSROE",184,0)
 ; DBIA 2052 call FILE^DID
"RTN","GMTSROE",185,0)
 D FILE^DID(130,"N","GLOBAL NAME","FIL","FIL(""ERR"")") S X=$G(FIL("GLOBAL NAME"))
"RTN","GMTSROE",186,0)
 S:$E(X,1)'="^"!($E(X,2,$L(X))["^")!($L($E(X,2,$L(X)))<2)!($L($E(X,2,$L(X)))>8)!($E(X,2,$L(X))'["(") X=""
"RTN","GMTSROE",187,0)
 I $L(X) S:'$D(@($P(X,"(",1))) X=""
"RTN","GMTSROE",188,0)
 Q X
"RTN","GMTSROE",189,0)
SG(X) ; Surgical (Operative) Record
"RTN","GMTSROE",190,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSROE",191,0)
 S X=$$GET1^DIQ(130,+($G(X)),118,"I") S X=$S(X["Y":0,1:1) Q X
"RTN","GMTSRON")
0^7^B22782266
"RTN","GMTSRON",1,0)
GMTSRON ; SLC/JER,KER - Surgery Reports ; 07/18/2000
"RTN","GMTSRON",2,0)
 ;;2.7;Health Summary;**11,28,37**;Oct 20, 1995
"RTN","GMTSRON",3,0)
 ;
"RTN","GMTSRON",4,0)
ENSR ; Entry point for component
"RTN","GMTSRON",5,0)
 N REC,GMTSMX,GMCOUNT,GMIDT,GMJ,GMN,SURG,GMTSGL
"RTN","GMTSRON",6,0)
 S GMTSGL=$$GL^GMTSROE Q:'$L(GMTSGL)  Q:'$D(@(GMTSGL_"""B"","_DFN_")"))
"RTN","GMTSRON",7,0)
 S GMTSMX=999 I $D(GMTSNDM),(GMTSNDM>0) S GMTSMX=GMTSNDM
"RTN","GMTSRON",8,0)
 S GMN=0 F  S GMN=$O(@(GMTSGL_"""B"","_DFN_","_GMN_")")) Q:GMN'>0  D SORT
"RTN","GMTSRON",9,0)
 Q:'$D(SURG)  S (GMCOUNT,GMIDT)=0 F  S GMIDT=$O(SURG(GMIDT)) Q:GMIDT'>0!(GMCOUNT'<GMTSMX)  D
"RTN","GMTSRON",10,0)
 . S GMN=SURG(GMIDT) K REC D WRT:$$CHK
"RTN","GMTSRON",11,0)
 K REC
"RTN","GMTSRON",12,0)
 Q
"RTN","GMTSRON",13,0)
 ;                               
"RTN","GMTSRON",14,0)
SORT ; Sort surgeries by inverted date
"RTN","GMTSRON",15,0)
 N GMDT S GMDT=$P($G(@(GMTSGL_GMN_",0)")),U,9) I GMDT>GMTSBEG&(GMDT<GMTSEND) D
"RTN","GMTSRON",16,0)
 . F  Q:'$D(SURG(9999999-GMDT))  S GMDT=GMDT+.0001
"RTN","GMTSRON",17,0)
 . S SURG(9999999-GMDT)=GMN
"RTN","GMTSRON",18,0)
 Q
"RTN","GMTSRON",19,0)
 ;                               
"RTN","GMTSRON",20,0)
WRT ; Write surgical case record
"RTN","GMTSRON",21,0)
 S GMN=+($G(GMN)) D:'$D(REC) ONE^GMTSROE(GMN)
"RTN","GMTSRON",22,0)
 N X,Y,GMI,GMDT,GMTSTR
"RTN","GMTSRON",23,0)
 ;-------------------------------------------------------
"RTN","GMTSRON",24,0)
 Q:$G(REC(130,GMN,118,"I"))'="Y"  S GMCOUNT=GMCOUNT+1
"RTN","GMTSRON",25,0)
NONOR ; NON-OR information
"RTN","GMTSRON",26,0)
SP ;     Date/Specialty/Provider
"RTN","GMTSRON",27,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRON",28,0)
 S GMDT=$G(REC(130,GMN,.09,"S")) S:'$L(GMDT) GMDT=$$ED^GMTSU($G(REC(130,GMN,.09,"I")))
"RTN","GMTSRON",29,0)
 S GMTSTR=$G(REC(130,GMN,125,"S")) S:$L($G(GMTSTR))>25 GMTSTR=$$WRAP^GMTSORC(GMTSTR,25)
"RTN","GMTSRON",30,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRON",31,0)
 W GMDT,?21,$P($G(GMTSTR),"|"),?47,"Provider: ",?56,$G(REC(130,GMN,123,"E")),!
"RTN","GMTSRON",32,0)
 F GMI=2:1:$L($G(GMTSTR),"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?23,$P($G(GMTSTR),"|",GMI),!
"RTN","GMTSRON",33,0)
 ;
"RTN","GMTSRON",34,0)
SA ;     Status/Attending
"RTN","GMTSRON",35,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRON",36,0)
 W ?13,"Status:",?21,$G(REC(130,GMN,"STATUS"))
"RTN","GMTSRON",37,0)
 W ?46,"Attending: ",?56,$G(REC(130,GMN,124,"E")),!
"RTN","GMTSRON",38,0)
PA ;     Principal Anesthetist
"RTN","GMTSRON",39,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRON",40,0)
 W ?45,"Prin Anest: ",?56,$G(REC(130,GMN,.31,"E")),!
"RTN","GMTSRON",41,0)
PD ;     Principle Diagnosis
"RTN","GMTSRON",42,0)
 S GMTSTR=$G(REC(130,GMN,33,"S")) S:'$L(GMTSTR) GMTSTR=$G(REC(130,GMN,33,"E"))
"RTN","GMTSRON",43,0)
 S:$L($G(GMTSTR))>39 GMTSTR=$$WRAP^GMTSORC(GMTSTR,39)
"RTN","GMTSRON",44,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?9,"Princ Diag: ",$P($G(GMTSTR),"|"),!
"RTN","GMTSRON",45,0)
 F GMI=2:1:$L($G(GMTSTR),"|") D CKP^GMTSUP Q:$D(GMTSQIT)  W ?21,$P($G(GMTSTR),"|",GMI),!
"RTN","GMTSRON",46,0)
PP ;     Principal Procedure
"RTN","GMTSRON",47,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W ?5,"Proc Performed: "
"RTN","GMTSRON",48,0)
 S GMTSTR=$G(REC(130,GMN,26,"S"))
"RTN","GMTSRON",49,0)
 S:GMTSTR="" GMTSTR=$G(REC(130,GMN,26,"E"))
"RTN","GMTSRON",50,0)
 S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRON",51,0)
 F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRON",52,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRON",53,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRON",54,0)
PPM ;     Principal Procedure (Modifiers)
"RTN","GMTSRON",55,0)
 S GMI=0 F  S GMI=$O(REC(130,GMN,130.028,GMI)) Q:GMI'>0  D  Q:$D(GMTSQIT)
"RTN","GMTSRON",56,0)
 . S GMTSTR=$G(REC(130,GMN,130.028,GMI,.01,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,130.028,GMI,.01,"E")) S:$L(GMTSTR)>54 GMTSTR=$$WRAP^GMTSORC(GMTSTR,54)
"RTN","GMTSRON",57,0)
 . F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRON",58,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:25,1:26),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRON",59,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRON",60,0)
OPP ;     Other Procedure Performed
"RTN","GMTSRON",61,0)
 S GMI=0 F  S GMI=$O(REC(130,GMN,130.16,GMI)) Q:GMI'>0  D
"RTN","GMTSRON",62,0)
 . S GMTSTR=$G(REC(130,GMN,130.16,GMI,.01,"S")) S:GMTSTR="" GMTSTR=$G(REC(130,GMN,130.16,GMI,.01,"E")) S:$L(GMTSTR)>58 GMTSTR=$$WRAP^GMTSORC(GMTSTR,58)
"RTN","GMTSRON",63,0)
 . F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRON",64,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)
"RTN","GMTSRON",65,0)
 . . W ?$S(GMJ=1:21,1:22),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRON",66,0)
OPPM . ;       Other Procedure Performed (Modifiers)
"RTN","GMTSRON",67,0)
 . N GMM S GMM=0
"RTN","GMTSRON",68,0)
 . F  S GMM=$O(REC(130,GMN,130.16,GMI,130.164,GMM)) Q:+GMM=0  D
"RTN","GMTSRON",69,0)
 . . S GMTSTR=$G(REC(130,GMN,130.16,GMI,130.164,GMM,.01,"S")) S:'$L(GMTSTR) GMTSTR=$G(REC(130,GMN,130.16,GMI,130.164,GMM,.01,"E")) S:$L(GMTSTR)>54 GMTSTR=$$WRAP^GMTSORC(GMTSTR,54)
"RTN","GMTSRON",70,0)
 . . F GMJ=1:1:$L(GMTSTR,"|") D  Q:$D(GMTSQIT)
"RTN","GMTSRON",71,0)
 . . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?$S(GMJ=1:25,1:26),$P(GMTSTR,"|",GMJ),!
"RTN","GMTSRON",72,0)
 . Q:$D(GMTSQIT)
"RTN","GMTSRON",73,0)
 Q:$D(GMTSQIT)
"RTN","GMTSRON",74,0)
IND ;     Indications for Surgery
"RTN","GMTSRON",75,0)
 I $G(REC(130,GMN,55,"S",0))>0 D  Q:$D(GMTSQIT)
"RTN","GMTSRON",76,0)
 . N GMI,GMC S (GMI,GMC)=0 F  S GMI=$O(REC(130,GMN,55,"S",GMI)) Q:+GMI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRON",77,0)
 . . S GMC=+GMC+1 D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMC=1 "Indication for Proc:" W ?21,$G(REC(130,GMN,55,"S",GMI)),!
"RTN","GMTSRON",78,0)
FIND ;     Findings
"RTN","GMTSRON",79,0)
 I $G(REC(130,GMN,59,"S",0))>0 D  Q:$D(GMTSQIT)
"RTN","GMTSRON",80,0)
 . N GMI,GMC S (GMI,GMC)=0 F  S GMI=$O(REC(130,GMN,59,"S",GMI)) Q:+GMI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRON",81,0)
 . . S GMC=+GMC+1 D CKP^GMTSUP Q:$D(GMTSQIT)  W:GMC=1 " Operative Findings:" W ?21,$G(REC(130,GMN,59,"S",GMI)),!
"RTN","GMTSRON",82,0)
DICT ;     Dictation
"RTN","GMTSRON",83,0)
 I $O(REC(130,GMN,1.15,0))>0 D
"RTN","GMTSRON",84,0)
 . N GMI D CKP^GMTSUP Q:$D(GMTSQIT)  W "Surgeon's Dictation:",!
"RTN","GMTSRON",85,0)
 . S GMI=0 F  S GMI=$O(REC(130,GMN,1.15,GMI)) Q:+GMI=0  D  Q:$D(GMTSQIT)
"RTN","GMTSRON",86,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W ?2,$G(REC(130,GMN,1.15,GMI)),!
"RTN","GMTSRON",87,0)
 Q
"RTN","GMTSRON",88,0)
 ;--------------------------------------------------------------------
"RTN","GMTSRON",89,0)
CHK() ; For selected procedures see if you have a match
"RTN","GMTSRON",90,0)
 N GMTSI,GMTSF,GMTSC
"RTN","GMTSRON",91,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSRON",92,0)
 S GMTSC=$$GET1^DIQ(130,+($G(GMN)),27,"I") Q:'$D(GMTSEG(GMTSEGN,81)) 1
"RTN","GMTSRON",93,0)
 S GMTSF=0 F GMTSI=0:0 S GMTSI=$O(GMTSEG(GMTSEGN,81,GMTSI)) Q:'+GMTSI!GMTSF  S:GMTSEG(GMTSEGN,81,GMTSI)=GMTSC GMTSF=1 Q:GMTSF
"RTN","GMTSRON",94,0)
 Q GMTSF
"RTN","GMTSU")
0^28^B27886130
"RTN","GMTSU",1,0)
GMTSU ; SLC/JER,KER/NDBI - Health Summary Utilities ; 07/18/2000
"RTN","GMTSU",2,0)
 ;;2.7;Health Summary;**27,28,31,35,37**;Oct 20, 1995
"RTN","GMTSU",3,0)
 ;
"RTN","GMTSU",4,0)
MTIM ;CONVERT TIME from X=2890313.1304 INTO X=13:04
"RTN","GMTSU",5,0)
 S X=$P(X,".",2) Q:'$L(X)
"RTN","GMTSU",6,0)
 S X=$S(X:$E(X,1,2)_$E("00",0,2-$L($E(X,1,2)))_":"_$E(X,3,4)_$E("00",0,2-$L($E(X,3,4))),1:"")
"RTN","GMTSU",7,0)
 Q
"RTN","GMTSU",8,0)
PROK(X,Y) ; Routine and Patch # OK (in UCI)
"RTN","GMTSU",9,0)
 N GMTS,GMTSI,GMTSO S X=$G(X),Y=$G(Y) Q:'$L(X) 0 Q:Y'=""&(+Y=0)
"RTN","GMTSU",10,0)
 S Y=+Y,GMTS=$$ROK(X) Q:'GMTS 0 Q:+Y=0 1 S GMTSO=0,GMTS=$T(@("+2^"_X)),GMTS=$P($P(GMTS,"**",2),"**",1)
"RTN","GMTSU",11,0)
 F GMTSI=1:1:$L(GMTS,",") S:+($P(GMTS,",",GMTSI))=Y GMTSO=1 Q:GMTSO=1
"RTN","GMTSU",12,0)
 S X=GMTSO Q X
"RTN","GMTSU",13,0)
ROK(X) ; Routine OK (in UCI) (NDBI)
"RTN","GMTSU",14,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0
"RTN","GMTSU",15,0)
 ; DBIA 10096 access ^%ZOSF
"RTN","GMTSU",16,0)
 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSU",17,0)
NDBI(X) ; National Database Integration site 1 = yes  0 = no
"RTN","GMTSU",18,0)
 N R,G S X="A7RDUP"
"RTN","GMTSU",19,0)
 ; DBIA 10096 access ^%ZOSF
"RTN","GMTSU",20,0)
 X ^%ZOSF("TEST") S R=$T
"RTN","GMTSU",21,0)
 ; DBIA 2934 access ^A7RCP
"RTN","GMTSU",22,0)
 S G=$S($D(^A7RCP):1,1:0),X=R+G,X=$S(X=2:1,1:0) Q X
"RTN","GMTSU",23,0)
CPT(X) ; Use CPT Modifiers  Needs GMTSEG Array
"RTN","GMTSU",24,0)
 S X=+($G(X)) N GMTSN,GMTSC,GMTSM,GMTSA,GMTSI S GMTSN=$G(GMTSEG(X))
"RTN","GMTSU",25,0)
 S GMTSC=+($P(GMTSN,"^",2)) Q:'GMTSC 0
"RTN","GMTSU",26,0)
 S GMTSM=$S($P(GMTSN,"^",9)="N":0,$P(GMTSN,"^",9)="":1,1:1) Q:'GMTSM 0
"RTN","GMTSU",27,0)
 S GMTSA=$S(+($$CMU(+GMTSC))>0:1,1:0) Q:'GMTSA 0
"RTN","GMTSU",28,0)
 Q 1
"RTN","GMTSU",29,0)
CMU(X) ; Component Uses CPT Modifiers
"RTN","GMTSU",30,0)
 N GMTSA,GMTSN,GMTSI S X=$G(X) Q:'$L(X) 0 S GMTSI=+X
"RTN","GMTSU",31,0)
 S GMTSA=$O(^GMT(142.1,"C",X,0)),GMTSN=$O(^GMT(142.1,"D",X,0)) S:GMTSI=0&(+GMTSA>0) GMTSI=GMTSA S:GMTSI=0&(+GMTSN>0) GMTSI=GMTSN
"RTN","GMTSU",32,0)
 Q:+GMTSI=0 0 S GMTSA=$S($P($G(^GMT(142.1,+GMTSI,0)),"^",14)="Y":1,1:0) Q:'GMTSA 0
"RTN","GMTSU",33,0)
 Q 1
"RTN","GMTSU",34,0)
ED(X) ; External Date
"RTN","GMTSU",35,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","GMTSU",36,0)
 D REGDT4 Q X
"RTN","GMTSU",37,0)
EDT(X) ; External Date and Time
"RTN","GMTSU",38,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","GMTSU",39,0)
 D REGDTM4 Q X
"RTN","GMTSU",40,0)
REGDT ; Receives X in internal date.time, and returns X in MM/DD/YY format
"RTN","GMTSU",41,0)
 ; DBIA 10103 call $$FMTE^XLFDT
"RTN","GMTSU",42,0)
 S X=$TR($$FMTE^XLFDT(X,"2DZ"),"@"," ") Q
"RTN","GMTSU",43,0)
REGDT4 ; Receives X in internal date.time, and returns X in MM/DD/YYYY format
"RTN","GMTSU",44,0)
 ; DBIA 10103 call $$FMTE^XLFDT
"RTN","GMTSU",45,0)
 S X=$TR($$FMTE^XLFDT(X,"5DZ"),"@"," ") Q
"RTN","GMTSU",46,0)
REGDTM ;Receives X in internal date.time, and returns X in MM/DD/YY TT:TT
"RTN","GMTSU",47,0)
 ; DBIA 10103 call $$FMTE^XLFDT
"RTN","GMTSU",48,0)
 S X=$TR($$FMTE^XLFDT(X,"2ZM"),"@"," ") Q
"RTN","GMTSU",49,0)
REGDTM4 ;Receives X in internal date.time, and returns X in MM/DD/YYYY TT:TT
"RTN","GMTSU",50,0)
 ; DBIA 10103 call $$FMTE^XLFDT
"RTN","GMTSU",51,0)
 S X=$TR($$FMTE^XLFDT(X,"5ZM"),"@"," ") Q
"RTN","GMTSU",52,0)
SIDT ; Receives X as internal date/time and returns X in DD MMM YY
"RTN","GMTSU",53,0)
 N MON,MM
"RTN","GMTSU",54,0)
 S X=$P(X,".") I 'X S X="" Q
"RTN","GMTSU",55,0)
 S MON="JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC"
"RTN","GMTSU",56,0)
 S MM=$E(X,4,5),MM=$S(MM:$P(MON,U,MM),1:"")
"RTN","GMTSU",57,0)
 S X=$E(X,6,7)_" "_MM_" "_$E(X,2,3)
"RTN","GMTSU",58,0)
 Q
"RTN","GMTSU",59,0)
 ;                       
"RTN","GMTSU",60,0)
HF(X) ; Host File - Used to distinguish from Host Files that are intended
"RTN","GMTSU",61,0)
 ; for Printers and Host Files for other purposes (windows/files)
"RTN","GMTSU",62,0)
 ;       1  -  if Device Type is HFS and not a TCP/IP Printer
"RTN","GMTSU",63,0)
 ;       0  -  if Device Type is not HFS or device is a Printer
"RTN","GMTSU",64,0)
 ;                       
"RTN","GMTSU",65,0)
 Q:$G(IOT)'="HFS" 0 Q:$E($G(ION),1,4)["OR W" 1 Q:$G(IO)["$PRT"!($G(IO)["PRN|") 0
"RTN","GMTSU",66,0)
 S X=0 S:$G(ION)["HOST FILE" X=1 S:$E($G(IOST),1,5)["P-OTH" X=1
"RTN","GMTSU",67,0)
 Q X
"RTN","GMTSU",68,0)
FMHL7DTM ; Recieves X as internal date/time and returns X in CCYYMMDDHHMM
"RTN","GMTSU",69,0)
 N T
"RTN","GMTSU",70,0)
 S T=$P(X,".",2)
"RTN","GMTSU",71,0)
 S T=$S(T:$E(T,1,2)_$E("00",0,2-$L($E(T,1,2)))_$E(T,3,4)_$E("00",0,2-$L($E(T,3,4))),1:"0000")
"RTN","GMTSU",72,0)
 S X=($E($P(X,"."),1,3)+1700)_$E($P(X,"."),4,7)_T
"RTN","GMTSU",73,0)
 Q
"RTN","GMTSU",74,0)
HL7FMDTM ; Recieves X as CCYYMMDDHHMM and returns X as internal date/time
"RTN","GMTSU",75,0)
 N DATE,TIME
"RTN","GMTSU",76,0)
 S DATE=$E(X,1,8),TIME=$E(X,9,12)
"RTN","GMTSU",77,0)
 S DATE=DATE-17000000,X=DATE_"."_TIME
"RTN","GMTSU",78,0)
 Q
"RTN","GMTSU",79,0)
DEM ; Gets Demographic Data from VADPT
"RTN","GMTSU",80,0)
 ; Receives: DFN
"RTN","GMTSU",81,0)
 ; Returns: GMTSPNM,GMTSSN,GMTSDOB,SEX,GMTSWARD,GMTSRB,GMTSAGE
"RTN","GMTSU",82,0)
 K VAHOW
"RTN","GMTSU",83,0)
 ; DBIA 10061 call OERR^VADPT
"RTN","GMTSU",84,0)
 D OERR^VADPT
"RTN","GMTSU",85,0)
 S GMTSPNM=VADM(1)
"RTN","GMTSU",86,0)
 S GMTSSN=$S($D(VA("PID")):VA("PID"),1:$P(VADM(2),"^",2))
"RTN","GMTSU",87,0)
 S GMTSAGE=$S(+VADM(4)>0:+VADM(4),1:99),SEX=$P(VADM(5),"^")
"RTN","GMTSU",88,0)
 S GMTSWARD=$P(VAIN(4),"^",2),GMTSRB=VAIN(5)
"RTN","GMTSU",89,0)
 S X=$P(VADM(3),"^") D REGDT4 S GMTSDOB=X
"RTN","GMTSU",90,0)
 K VA
"RTN","GMTSU",91,0)
 ;Establish the information for the patient header.
"RTN","GMTSU",92,0)
 K GMTSPHDR
"RTN","GMTSU",93,0)
 N DOB,LWARDRB,NMSSN,NMSSNE,WARDRB,WARDRBE,WARDRBS
"RTN","GMTSU",94,0)
 S NMSSN=GMTSPNM_"    "_GMTSSN
"RTN","GMTSU",95,0)
 S NMSSNE=$L(NMSSN)+2
"RTN","GMTSU",96,0)
 S WARDRB=GMTSWARD_" "_GMTSRB
"RTN","GMTSU",97,0)
 S LWARDRB=$L(WARDRB)
"RTN","GMTSU",98,0)
 S WARDRBS=40-(LWARDRB/2),WARDRBE=WARDRBS+LWARDRB
"RTN","GMTSU",99,0)
 S DOB="DOB: "_GMTSDOB
"RTN","GMTSU",100,0)
 S GMTSPHDR("NMSSN")=NMSSN
"RTN","GMTSU",101,0)
 S GMTSPHDR("WARDRB")=WARDRB
"RTN","GMTSU",102,0)
 S GMTSPHDR("WARDRBS")=WARDRBS
"RTN","GMTSU",103,0)
 S GMTSPHDR("DOB")=DOB
"RTN","GMTSU",104,0)
 S GMTSPHDR("DOBS")=64
"RTN","GMTSU",105,0)
 I (NMSSNE'<WARDRBS)!(WARDRBE'<64) S GMTSPHDR("TWO")=1
"RTN","GMTSU",106,0)
 Q
"RTN","GMTSU",107,0)
NAME ; Format names ;6/30/89  11:20 ;
"RTN","GMTSU",108,0)
 ; Recieves: FILE (3 for User, 16 for Person, 6 for Provider)
"RTN","GMTSU",109,0)
 ;           IFN (Internal file # for above file),
"RTN","GMTSU",110,0)
 ;           NML (Desired length for name to be returned)
"RTN","GMTSU",111,0)
 ;           FNF (Flag to specify first name format: 0 for FI, 1 for FN)
"RTN","GMTSU",112,0)
 ; Returns: Lastname,First(name/initial) to specified length as NM
"RTN","GMTSU",113,0)
 ;
"RTN","GMTSU",114,0)
 N DIC,RAWNM,LN,FN,FA,NI,CH,X,Y
"RTN","GMTSU",115,0)
 S DIC=FILE,DIC(0)="NXZ",X=IFN
"RTN","GMTSU",116,0)
 ; DBIA 10006 call ^DIC
"RTN","GMTSU",117,0)
 D ^DIC S RAWNM=$S($D(Y(0,0)):Y(0,0),1:"UNKNOWN")
"RTN","GMTSU",118,0)
 S LN=$P(RAWNM,","),FN=$P(RAWNM,",",2)
"RTN","GMTSU",119,0)
 S FA=0 I $L(FN) F NI=1:1 S CH=$E(FN,NI) Q:CH?1A  S FA=NI
"RTN","GMTSU",120,0)
 I FA S FN=$E(FN,FA+1,$L(FN))
"RTN","GMTSU",121,0)
 I 'FNF S FN=$E(FN,1)
"RTN","GMTSU",122,0)
 S NM=$S($L(FN):LN_","_FN,1:LN),NM=$E(NM,1,NML)
"RTN","GMTSU",123,0)
 K FILE,IFN,NML,FNF
"RTN","GMTSU",124,0)
 Q
"RTN","GMTSU",125,0)
GETRANGE(FROMDATE,TODATE) ; Selection by Date Range (from and to dates)
"RTN","GMTSU",126,0)
 ;      VARIABLES LIST (OUTPUT)
"RTN","GMTSU",127,0)
 ; FROMDATE = FROM DATE
"RTN","GMTSU",128,0)
 ; TODATE = TO DATE
"RTN","GMTSU",129,0)
 N DIR,X,Y,DTOUT,DIRUT S DIR(0)="DO^:DT",DIR("A")="Enter Beginning Date (MM/DD/YY)" W !
"RTN","GMTSU",130,0)
 ; DBIA 10026 call ^DIR
"RTN","GMTSU",131,0)
 D ^DIR I $D(DIROUT)!$D(DUOUT)!$D(DTOUT)!$D(DIRUT) W ! Q
"RTN","GMTSU",132,0)
 S FROMDATE=Y I +FROMDATE>0 D
"RTN","GMTSU",133,0)
 . ; DBIA 10104 call $$UP^XLFSTR
"RTN","GMTSU",134,0)
 . ; DBIA 10103 call $$FMTE^XLFDT
"RTN","GMTSU",135,0)
 . W "  (",$$UP^XLFSTR($$FMTE^XLFDT(+FROMDATE,1)),")"
"RTN","GMTSU",136,0)
 . N DIR,X,Y S DIR(0)="DO^::EX",DIR("A")="Enter Ending Date (MM/DD/YY)" S DIR("B")="TODAY"
"RTN","GMTSU",137,0)
 . ; DBIA 10026 call ^DIR
"RTN","GMTSU",138,0)
 . D ^DIR I $D(DIROUT)!$D(DUOUT)!$D(DTOUT)!$D(DIRUT) K FROMDATE Q
"RTN","GMTSU",139,0)
 . I Y'>0 K FROMDATE Q
"RTN","GMTSU",140,0)
 . S TODATE=Y Q:TODATE>FROMDATE!(TODATE=FROMDATE) 
"RTN","GMTSU",141,0)
 . ; If 2nd date older than 1st date entered (Dates entered in reverse order)
"RTN","GMTSU",142,0)
 . N FRDT S FRDT=FROMDATE,FROMDATE=TODATE,TODATE=FRDT
"RTN","GMTSU",143,0)
 W !
"RTN","GMTSU",144,0)
 Q
"RTN","GMTSU",145,0)
FCLR(X) ; File Closed Root
"RTN","GMTSU",146,0)
 S X=$G(X) Q:+X=0 "" N GMTSL S GMTSL=$$FLOC(X),X=$S($E(GMTSL,$L(GMTSL))=",":$P(GMTSL,",")_")",1:$E(GMTSL,1,$L(GMTSL)-1)) Q:'$L(X) "" S:'$D(@X) X=""
"RTN","GMTSU",147,0)
 Q X
"RTN","GMTSU",148,0)
FNAM(X) ; File Name
"RTN","GMTSU",149,0)
 S X=$G(X) Q:+X=0 "" N DIERR,GMTSN,GMTSE
"RTN","GMTSU",150,0)
 ; DBIA 2052 call FILE^DID
"RTN","GMTSU",151,0)
 D FILE^DID(+X,"N","NAME","GMTSN","GMTSE")
"RTN","GMTSU",152,0)
 S X="" S:'$D(DIERR) X=$G(GMTSN("NAME")) Q X
"RTN","GMTSU",153,0)
FLOC(X) ; File location
"RTN","GMTSU",154,0)
 S X=$G(X) Q:+X=0 "" N DIERR,GMTSN,GMTSE
"RTN","GMTSU",155,0)
 ; DBIA 2052 call FILE^DID
"RTN","GMTSU",156,0)
 D FILE^DID(+X,"N","GLOBAL NAME","GMTSN","GMTSE")
"RTN","GMTSU",157,0)
 S X="" S:'$D(DIERR) X=$G(GMTSN("GLOBAL NAME")) Q X
"RTN","GMTSUMX")
0^11^B18981122
"RTN","GMTSUMX",1,0)
GMTSUMX ; SLC/KER - Convert Text to Mix Case   ; 07/18/2000
"RTN","GMTSUMX",2,0)
 ;;2.7;Health Summary;**30,37**;Oct 20, 1995
"RTN","GMTSUMX",3,0)
 Q
"RTN","GMTSUMX",4,0)
EN(X) ; Convert Case
"RTN","GMTSUMX",5,0)
 N Y,GMTSOK,GMTSOC,GMTSWORD,GMTSPC,GMTSLEAD,GMTSTLR,GMTSTR,GMTSCTR,GMTSPRE
"RTN","GMTSUMX",6,0)
 S (GMTSTR,GMTSWORD,GMTSPC)="",X=$$UP(X)
"RTN","GMTSUMX",7,0)
 ; Parse by Spaces
"RTN","GMTSUMX",8,0)
 F GMTSCTR=1:1:$L(X," ") D
"RTN","GMTSUMX",9,0)
 . S GMTSWORD=$P(X," ",GMTSCTR)
"RTN","GMTSUMX",10,0)
 . S (GMTSPC,GMTSLEAD,GMTSTLR)=""
"RTN","GMTSUMX",11,0)
 . I $E(GMTSWORD,1)="(" S GMTSWORD=$E(GMTSWORD,2,$L(GMTSWORD)),GMTSLEAD="("
"RTN","GMTSUMX",12,0)
 . I $E(GMTSWORD,$L(GMTSWORD))=")" S GMTSWORD=$E(GMTSWORD,1,($L(GMTSWORD)-1)),GMTSTLR=")"
"RTN","GMTSUMX",13,0)
 . ; String contains special characters
"RTN","GMTSUMX",14,0)
 . S GMTSOK=1 F GMTSOC="(",")","-","*","+","{","&","}","[","]","/","\","|",",","'" S:GMTSWORD[GMTSOC GMTSOK=0 Q:'GMTSOK
"RTN","GMTSUMX",15,0)
 . I 'GMTSOK D SP
"RTN","GMTSUMX",16,0)
 . I GMTSOK D GMTSWORD
"RTN","GMTSUMX",17,0)
 . S:GMTSLEAD'="" GMTSWORD=GMTSLEAD_GMTSWORD
"RTN","GMTSUMX",18,0)
 . S:GMTSTLR'="" GMTSWORD=GMTSWORD_GMTSTLR
"RTN","GMTSUMX",19,0)
 . S GMTSTR=GMTSTR_" "_GMTSWORD
"RTN","GMTSUMX",20,0)
 S X=$$TRIM(GMTSTR) Q X
"RTN","GMTSUMX",21,0)
EN2(X) ; Convert Case 2
"RTN","GMTSUMX",22,0)
 S X=$$CK($$EN($G(X))) Q X
"RTN","GMTSUMX",23,0)
SP ; Special Characters
"RTN","GMTSUMX",24,0)
 ; Special Cases of Special Characters
"RTN","GMTSUMX",25,0)
 I $$UP(GMTSWORD)="W/&W/O" S GMTSWORD="w/&w/o" Q
"RTN","GMTSUMX",26,0)
 I $$UP(GMTSWORD)="W&W/O" S GMTSWORD="w&w/o" Q
"RTN","GMTSUMX",27,0)
 I $$UP(GMTSWORD)="&/OR" S GMTSWORD="&/or" Q
"RTN","GMTSUMX",28,0)
 I GMTSWORD="W/O" S GMTSWORD="w/o" Q
"RTN","GMTSUMX",29,0)
 N GMTSOK,GMTSWD1,GMTSWD2,GMTSW,GMTSWCTR,GMTSCHR
"RTN","GMTSUMX",30,0)
 S GMTSWD1=GMTSWORD,GMTSWD2="",GMTSW=""
"RTN","GMTSUMX",31,0)
 F GMTSWCTR=1:1:$L(GMTSWD1) D
"RTN","GMTSUMX",32,0)
 . S GMTSCHR=$E(GMTSWD1,GMTSWCTR) I "()-*+{}'&[]/\|,"[GMTSCHR,$L(GMTSW) D  Q
"RTN","GMTSUMX",33,0)
 . . S GMTSPRE=""
"RTN","GMTSUMX",34,0)
 . . S:$E(GMTSW,1,2)="ZZ"&($L(GMTSW)>2) GMTSPRE="ZZ",GMTSW=$E(GMTSW,3,$L(GMTSW))
"RTN","GMTSUMX",35,0)
 . . S GMTSW=GMTSPRE_$$CASE(GMTSW,GMTSCHR)
"RTN","GMTSUMX",36,0)
 . . S GMTSWD2=GMTSWD2_GMTSW_GMTSCHR,GMTSW=""
"RTN","GMTSUMX",37,0)
 . S GMTSW=GMTSW_GMTSCHR
"RTN","GMTSUMX",38,0)
 I $L(GMTSW) D
"RTN","GMTSUMX",39,0)
 . N GMTSPSN F GMTSPSN=1:1:$L(GMTSW) Q:"()-*+{}'&[]/\|,"'[$E(GMTSW,GMTSPSN)
"RTN","GMTSUMX",40,0)
 . N GMTSOW,GMTSLW S GMTSLW=$E(GMTSW,0,(GMTSPSN-1))
"RTN","GMTSUMX",41,0)
 . S GMTSOW=$E(GMTSW,GMTSPSN,$L(GMTSW))
"RTN","GMTSUMX",42,0)
 . S GMTSPRE="" S:$E(GMTSOW,1,2)="ZZ"&($L(GMTSOW)>2) GMTSPRE="ZZ",GMTSOW=$E(GMTSOW,3,$L(GMTSOW))
"RTN","GMTSUMX",43,0)
 . S GMTSOW=GMTSPRE_$$CASE(GMTSOW,$E($G(GMTSWD2),$L($G(GMTSWD2))))
"RTN","GMTSUMX",44,0)
 . S GMTSW=GMTSLW_GMTSOW
"RTN","GMTSUMX",45,0)
 . S GMTSWD2=GMTSWD2_GMTSW
"RTN","GMTSUMX",46,0)
 S GMTSWORD=GMTSWD2 S:GMTSCTR=1 GMTSWORD=$$LD(GMTSWORD)
"RTN","GMTSUMX",47,0)
 K GMTSWD1,GMTSWD2
"RTN","GMTSUMX",48,0)
 Q
"RTN","GMTSUMX",49,0)
GMTSWORD ; Convert word
"RTN","GMTSUMX",50,0)
 S GMTSPRE="" S:$E(GMTSWORD,1,2)="ZZ"&($L(GMTSWORD)>2) GMTSPRE="ZZ",GMTSWORD=$E(GMTSWORD,3,$L(GMTSWORD))
"RTN","GMTSUMX",51,0)
 S GMTSWORD=GMTSPRE_$$CASE(GMTSWORD,"")
"RTN","GMTSUMX",52,0)
 Q
"RTN","GMTSUMX",53,0)
CASE(X,J) ; Set to Mixed/lower/UPPER case
"RTN","GMTSUMX",54,0)
 N GMTSTAG,GMTSRTN,Y S X=$$UP($G(X)),Y="",GMTSTAG=$L(X),GMTSRTN="GMTSUMX2"
"RTN","GMTSUMX",55,0)
 S:+GMTSTAG>4 GMTSRTN="GMTSUMX3" S:+GMTSTAG>9 GMTSTAG="M"
"RTN","GMTSUMX",56,0)
 Q:+GMTSTAG=0&(GMTSTAG'="M") X
"RTN","GMTSUMX",57,0)
 S GMTSRTN=GMTSTAG_"^"_GMTSRTN D @GMTSRTN
"RTN","GMTSUMX",58,0)
 I $L(Y) S X=Y Q X
"RTN","GMTSUMX",59,0)
 S X=$$MX(X)
"RTN","GMTSUMX",60,0)
 Q X
"RTN","GMTSUMX",61,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX",62,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSUMX",63,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX",64,0)
LD(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","GMTSUMX",65,0)
TRIM(X) S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSUMX",66,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSUMX",67,0)
 Q X
"RTN","GMTSUMX",68,0)
CK(X) ;
"RTN","GMTSUMX",69,0)
 S X=$G(X)
"RTN","GMTSUMX",70,0)
 F  Q:X'["(S)"  S X=$P(X,"(S)",1)_"(s)"_$P(X,"(S)",2,299)
"RTN","GMTSUMX",71,0)
 F  Q:X'[" A "  S X=$P(X," A ",1)_" a "_$P(X," A ",2,229)
"RTN","GMTSUMX",72,0)
 I X["Class a" F  Q:X'["Class a"  S X=$P(X,"Class a",1)_"Class A"_$P(X,"Class a",2,229)
"RTN","GMTSUMX",73,0)
 I X["Type a" F  Q:X'["Type a"  S X=$P(X,"Type a",1)_"Type A"_$P(X,"Type a",2,229)
"RTN","GMTSUMX",74,0)
 F  Q:X'["'S"  S X=$P(X,"'S",1)_"'s"_$P(X,"'S",2,229)
"RTN","GMTSUMX",75,0)
 I X["mg Diet" F  Q:X'["mg Diet"  S X=$P(X,"mg Diet",1)_"MG Diet"_$P(X,"mg Diet",2,229)
"RTN","GMTSUMX",76,0)
 I X["LO-Fat" F  Q:X'["LO-Fat"  S X=$P(X,"LO-Fat",1)_"Lo-Fat"_$P(X,"LO-Fat",2,229)
"RTN","GMTSUMX",77,0)
 I $E(X,1)="'" S X="'"_$$LD($E(X,2,$L(X)))
"RTN","GMTSUMX",78,0)
 S X=$TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","GMTSUMX",79,0)
 Q X
"RTN","GMTSUMX",80,0)
TYPES ;
"RTN","GMTSUMX",81,0)
 N GMTSIEN S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,GMTSIEN)) Q:+GMTSIEN=0  D
"RTN","GMTSUMX",82,0)
 . N GMTSTXT S GMTSTXT=$P($G(^GMT(142,GMTSIEN,0)),"^",1)
"RTN","GMTSUMX",83,0)
 . I $L(GMTSTXT) W !!,GMTSTXT,!,$$EN^GMTSUMX(GMTSTXT)
"RTN","GMTSUMX",84,0)
 Q
"RTN","GMTSUMX2")
0^12^B70871216
"RTN","GMTSUMX2",1,0)
GMTSUMX2 ; SLC/KER - Convert Text to Mix Case (1-4) ; 07/18/2000
"RTN","GMTSUMX2",2,0)
 ;;2.7;Health Summary;**30,37**;Oct 20, 1995
"RTN","GMTSUMX2",3,0)
 ;         
"RTN","GMTSUMX2",4,0)
1 I "^B^C^D^E^F^G^H^I^J^K^M^N^O^P^Q^S^T^U^V^X^Y^Z^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",5,0)
 I "^W^L^R^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",6,0)
 I "^MM^CM^IN^FT^CM^CC^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",7,0)
 Q
"RTN","GMTSUMX2",8,0)
2 ; 2 Characters
"RTN","GMTSUMX2",9,0)
 S J=$G(J)
"RTN","GMTSUMX2",10,0)
 I J'="",J'=" ","^OR^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",11,0)
 S:X="DA" Y="dA" S:X="DC" Y="dC" S:X="DG" Y="dG" S:X="DT" Y="dT" S:X="DU" Y="dU" S:X="GB" Y="gB" S:X="GC" Y="gC" S:X="GH" Y="gH" S:X="KB" Y="kB" Q:$L($G(Y))
"RTN","GMTSUMX2",12,0)
 S:X="KD" Y="kD" S:X="PH" Y="pH" S:X="PX" Y="pX" Q:$L($G(Y))
"RTN","GMTSUMX2",13,0)
 I "^WO^W/^IN^IS^IT^AT^OR^TO^OF^ON^BE^BY^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",14,0)
 I "^ST^"[X S Y=$$MX(X) Q
"RTN","GMTSUMX2",15,0)
 I "^DG^DI^DS^EC^EN^ES^FB^ID^FH^HL^IB^LA^LR^MD^MC^NS^OR^PX^RA^RG^RT^SD^SR^SW^VA^WV^XH^XM^XT^XU^YS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",16,0)
 I "^BA^BT^CD^CH^CM^CN^CP^CR^CY^BW^7S^OL^CA^MC^EP^II^RO^ZP^ZY^SH^ES^MF^GP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",17,0)
 I "^CW^DD^DI^DS^EM^HF^IM^LH^LO^OD^OE^PN^RI^RP^RS^SP^SR^ST^SW^TP^TR^TS^VS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",18,0)
 I "^EP^AA^AB^AC^AD^AF^AG^AH^AP^AR^AV^BA^BB^BC^BE^BG^BH^BK^BL^BM^BP^BR^BS^BW^CA^CB^CD^CE^CF^CG^CH^CI^CK^CL^CO^CP^CR^CS^CT^CV^DB^DD^DL^DM^DN^DP^DQ^DR^EA^EB^EC^EF^EM^EO^EP^ET^FA^FD^FK^FR^FU^GA^GI^GL^GP^GR^GS^GT^HA^HB^HC^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",19,0)
 I "^HC^HL^HO^HP^HR^HS^HT^HU^HX^IA^IB^IE^IF^II^IL^IP^IV^IX^KO^KS^LA^LD^LE^LF^LH^LL^LR^LY^MA^MB^MC^ME^MF^MI^MK^MP^MR^MS^MT^NA^NB^NF^NG^NH^NK^NL^NP^NS^NT^OC^OD^OH^OP^OT^OX^PA^PC^PD^PE^PF^PG^PI^PK^PL^PM^PP^PR^PS^PT^PZ^RA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",20,0)
 I "^RA^RC^RF^RH^RI^RP^RR^RS^RX^SA^SB^SC^SD^SE^SF^SG^SH^SI^SK^SL^SM^SP^SR^SS^SV^TA^TB^TC^TF^TH^TI^TK^TL^TP^TT^UK^UD^UV^VA^VC^VH^VI^VO^VP^VZ^WB^WS^XI^YM^YY^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",21,0)
 I "^AN^AS^AT^BY^CM^DE^IN^MG^NO^OF^ON^OR^SQ^TO^UP^YL^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",22,0)
 Q
"RTN","GMTSUMX2",23,0)
3 ; 3 Characters
"RTN","GMTSUMX2",24,0)
 S:X="BRZ" Y="BrZ" S:X="COA" Y="CoA" S:X="COM" Y="CoM" S:X="EIF" Y="eIF" S:X="HGH" Y="hGH" S:X="HPR" Y="HPr" S:X="IGA" Y="IgA" S:X="IGD" Y="IgD" S:X="IGE" Y="IgE" Q:$L($G(Y))
"RTN","GMTSUMX2",25,0)
 S:X="IGG" Y="IgG" S:X="IGM" Y="IgM" S:X="IIB" Y="IIb" S:X="KDA" Y="kDa" S:X="MEC" Y="MeC" S:X="MEO" Y="MeO" S:X="NAC" Y="NAc" S:X="NIA" Y="NIa" S:X="OET" Y="OEt" Q:$L($G(Y))
"RTN","GMTSUMX2",26,0)
 S:X="OME" Y="OMe" S:X="PNA" Y="pNA" S:X="PRP" Y="PrP" S:X="SMB" Y="SmB" S:X="VPG" Y="VPg" Q:$L($G(Y))
"RTN","GMTSUMX2",27,0)
 I "^DIR^MED^APR^AUG^BAY^FEB^HOT^JAN^JCT^JUL^JUN^LAS^LOS^MAR^FAC^MAY^MTN^NEW^NOV^OCT^OUT^SAN^SEP^SKY^"[X S Y=$$MX(X) Q
"RTN","GMTSUMX2",28,0)
 I "^ALL^AND^ARE^BUT^SET^NOW^ANY^HAD^DUE^MED^TOO^FAR^OWN^MIN^ITS^HIM^OUR^HIS^HER^NEW^LOW^ITS^MAY^HOW^OUT^WAS^W/O^FOR^NOT^THE^CAN^PUT^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",29,0)
 I "^ADC^ADR^ADT^BDS^BLO^BPN^BSR^CRS^OER^OEX^CVF^CVP^DCS^DEM^EDL^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",30,0)
 I "^MIC^NSR^NTM^OPC^ORC^PLA^PLI^PLL^PRC^SCD^SHF^SLT^SPN^SRI^SRO^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",31,0)
 I "^CWT^IOL^SVS^VSO^EES^EPO^DVC^ASC^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",32,0)
 I "^ICU^NOS^NEC^SLC^ISC^A3A^A3F^A7R^DPT^DVB^ECT^ECX^EDR^EEO^GEC^IBD^IBJ^CPT^ICD^IMR^IVM^LA7^LEX^LRS^LRX^MC2^MPR^NUR^PCE^ORA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",33,0)
 I "^NLM^DIC^DIR^DIK^XMB^ORB^PRC^PRS^PSA^PSD^PSG^PSJ^PSN^PSO^PSS^PSU^PSX^QAC^QAM^QAN^QAO^QAP^QAQ^QAR^QIE^QIP^RTY^SPN^TIU^USR^VAQ^VON^XPD^XUC^XWB^YSA^ZDG^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",34,0)
 I "^ABA^ABC^ABO^ABP^ACE^ACP^ADA^ADH^ADV^ADP^AFO^AII^ALS^AMC^AMP^ANF^ANP^ASA^ATF^ATP^ATX^AVP^AVT^AZT^BAM^BCG^BCP^BDB^BDS^BIM^BLS^BMP^BNP^BOC^BPV^BRL^BSA^BSP^CAD^CAF^CAM^CAP^CAT^CAZ^CBC^CBZ^CCK^CDP^CDR^CEA^CEF^CFA^CGP^CGS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",35,0)
 I "^CGS^CHO^CMC^CMF^CMP^CMV^CNP^CNS^CPE^CPK^CRF^CRH^CSF^CTP^CYT^DAB^DAP^DAT^DBP^DDE^DDT^DFA^DHP^DIP^DJD^DME^DNA^DNP^DTP^EAP^EBP^EBV^ECE^ECG^EEE^EEG^EGF^EHV^EIA^EKG^EMD^EMG^EMS^ENA^ENK^FAD^FAP^FDA^FDP^FGF^FMN^FSH^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",36,0)
 I "^FSH^FSP^FTC^GAP^GDP^GLP^GMP^GPC^GPD^GRF^GRP^GSH^GTH^GTP^GVP^HBP^HCG^HCL^HCO^HCT^HCV^HDL^HFO^HHV^HIB^HIV^HLA^HLH^HMG^HNF^HNP^HOE^HPA^HPC^HPV^HRP^HSA^HSV^IAA^ICI^ICP^IDA^IFN^IGF^IIA^III^IMP^ITF^IUD^JMV^KAP^KLH^LAI^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",37,0)
 I "^LAI^LAP^LAV^LDH^LDL^LPH^LSD^LSO^MAA^MAM^MAP^MBP^MCA^MCP^MDL^MDP^MDV^MEA^MEN^MEP^MHC^MIF^MIP^MPA^MPS^MRA^MRC^MRI^MRP^MSA^MSH^MTP^NAD^NAG^NAP^NBD^NCA^NCS^NEC^NGF^NHE^NKA^NMN^NOS^NPY^NSC^NYU^OMP^OMT^ORF^OTF^PAF^PAL^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",38,0)
 I "^PAL^PAP^PAS^PBP^PCA^PCP^PEG^PEP^PET^PHA^PIP^PIV^PKI^PLP^POC^PPD^PPP^PRV^PSA^PSP^PTB^PTC^PTH^PTT^PTX^RAB^RAG^RAP^RBC^RBP^RGD^RII^RMI^RNA^RNP^RSV^SAA^SAM^SAP^SCP^SDZ^SEO^SER^SFV^SHV^SIV^SKF^SKN^SMP^SOD^SOS^SPM^SRV^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",39,0)
 I "^RAS^SRV^STP^TAG^TAP^TCF^TCP^TDP^TEF^TEM^TFA^TGF^TMV^TNF^TNP^TPA^TPN^TRH^TRP^TSA^TSH^TTP^TTR^UDP^UMP^URO^USF^UTP^VII^VIP^VLA^VSG^VZV^WBC^WGA^WHO^XII^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",40,0)
 I "^MAA^MPP^NEC^NOS^ZTA^CPD^R/O^MDA^3MC^ACP^SFN^URR^SNF^SLC^ISC^III^ATP^CMP^AAF^APV^LSD^PCP^HTP^RNA^DNA^ISC^NLM^IMP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",41,0)
 I "^ONE^TWO^SIX^TEN^AND^ANY^BIS^BUT^CIS^DES^DUE^FOR^LPM^NON^NOT^OXO^PER^PRE^PRO^PSI^THE^USE^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",42,0)
 Q
"RTN","GMTSUMX2",43,0)
4 ; 4 Characters
"RTN","GMTSUMX2",44,0)
 S:X="APOA" Y="ApoA" S:X="BBVI" Y="BbvI" S:X="BPTH" Y="bPTH" S:X="BSUE" Y="BsuE" S:X="CAMP" Y="cAMP" S:X="CGMP" Y="cGMP" S:X="COTE" Y="CotE" S:X="DATP" Y="dATP" Q:$L($G(Y))
"RTN","GMTSUMX2",45,0)
 S:X="DCMP" Y="dCMP" S:X="DCTP" Y="dCTP" S:X="DGMP" Y="dGMP" S:X="DGTP" Y="dGTP" S:X="DSBA" Y="dsbA" S:X="DTDP" Y="dTDP" S:X="DTTP" Y="dTTP" S:X="DUMP" Y="dUMP" Q:$L($G(Y))
"RTN","GMTSUMX2",46,0)
 S:X="DURD" Y="dUrd" S:X="DUTP" Y="dUTP" S:X="ECAI" Y="EcaI" S:X="ECOK" Y="EcoK" S:X="ERBB" Y="erbB" S:X="FELV" Y="FeLV" S:X="FMET" Y="fMet" S:X="GNRH" Y="GnRH" Q:$L($G(Y))
"RTN","GMTSUMX2",47,0)
 S:X="GPII" Y="gpII" S:X="HARG" Y="hArg" S:X="HELA" Y="HeLa" S:X="HGRF" Y="hGRF" S:X="HHAI" Y="HhaI" S:X="HPAI" Y="HpaI" S:X="HPTH" Y="hPTH" S:X="IIIA" Y="IIIa" Q:$L($G(Y))
"RTN","GMTSUMX2",48,0)
 S:X="KPNI" Y="KpnI" S:X="MCRB" Y="McrB" S:X="MESH" Y="MeSH" S:X="MRNA" Y="mRNA" S:X="NHET" Y="NHEt" S:X="NHME" Y="NHMe" S:X="OBZL" Y="OBzl" S:X="OTBU" Y="OtBu" Q:$L($G(Y))
"RTN","GMTSUMX2",49,0)
 S:X="PGLU" Y="pGlu" S:X="PSTI" Y="PstI" S:X="REGA" Y="regA" S:X="RRNA" Y="rRNA" S:X="SCEI" Y="SceI" S:X="TAQI" Y="TaqI" S:X="TRFA" Y="TrfA" S:X="TRKA" Y="trkA" Q:$L($G(Y))
"RTN","GMTSUMX2",50,0)
 S:X="TRKB" Y="trkB" S:X="TRNA" Y="tRNA" Q:$L($G(Y))
"RTN","GMTSUMX2",51,0)
 I "^BATH^CITH^CITY^EAST^ERIE^FORT^HOME^IOWA^IRON^JUAN^JULY^JUNE^LAKE^LOMA^LONG^LYON^PALM^PALO^PARK^RENO^ROCK^SALT^SIDE^WACO^WEST^YORK^"[X S Y=$$MX(X) Q
"RTN","GMTSUMX2",52,0)
 I "^BADR^BDEM^BMIC^EADT^MAGI^MEDA^MEDB^MEDC^MEDF^MHPE^RXIV^RXOP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",53,0)
 I "^RXUD^SCL1^SCL2^HISA^HPSA^CRNA^HCFA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",54,0)
 ;I "^^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",55,0)
 I "^A1B5^A1BG^A4A7^A4A8^A6K7^ABSV^ACKQ^DENT^DGHI^DGPW^DGY1^DGY3^DGYA^DGYB^DGYC^DGYD^DGYF^DGYG^DGYJ^DGYK^DGYL^DGYN^DGYO^DGYP^DGYQ^DGYR^DGYS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",56,0)
 I "^DGYU^DGYV^DGYW^DGYX^DGYZ^DIPK^DVBA^DVBC^DVBQ^DVBT^DVBU^DVBW^DVBX^DVBY^EEOA^EEOP^ENXE^ENXF^ENXG^ENXI^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",57,0)
 I "^ENXJ^ENXK^FBAA^GECD^GECP^GECS^GMAA^GMD1^GMN1^GMN2^GMN3^GMN4^GMN5^GMPL^GMPT^GMRA^GMRC^GMRD^GMRE^GMRG"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",58,0)
 I "^GMRP^GMRQ^GMRR^GMRS^GMRV^GMRY^GMTS^HBHC^IBDE^IBDP^IBQL^IBQY^IBY3^IBY4^IBY5^IBY6^IBY7^IBY8^IBY9^IBYA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",59,0)
 I "^IBYB^IBYC^IBYD^IBYE^IBYF^IBYG^IBYH^IBYK^IBYL^IBYN^ICPT^LBRN^LBRT^LBRY^LR00^LR01^LR03^LRAR^LRLS^MCXX^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",60,0)
 I "^NURA^NURC^NURE^NURQ^NURX^ONCO^PRCA^PRCP^PRMQ^PRPF^PRSX^PRX0^PRX1^PRX8^PRXB^PRXC^PRXE^PRXF^PRXG^PRXI^PRXJ^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",61,0)
 I "^PRXK^PRXP^PRYA^PRYB^PRYC^PRYD^PRYF^PRYH^PRYJ^PRYL^PRYN^PRYP^PSA1^PSD1^PSGW^PSIV^PSJ1^PSJ4^PSOA^PSOB^PSOC^PSOD^PSOE^PSOG^PSOH^PSOJ^PSOL^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",62,0)
 I "^PSOY^PSW1^PSXC^QAN1^QAR1^QAR2^QARF^QARY^RAAA^RAAB^RAAC^RAAE^RAAF^RMPC^RMPF^RMPJ^RMPR^RMPT^RTYB^RTYC^RTYD^SDYA^SDYM^SDYN^SDYP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",63,0)
 I "^SOWA^SOWC^SOWK^SROA^SRRS^SRRT^TIUJ^TIUW^TIUX^VALM^VEEM^VSIT^XQOR^XUFI^YS01^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",64,0)
 I "^AIDS^ANCA^ARPP^ATLV^BPDE^BUSI^CENP^CGRP^COOH^CPAP^CPEP^DHEA^DMBA^DSIP^DTPA^EBNA^EDTA^ERCC^ERCP^ESRD^FANA^FITC^FKBP^GABA^GATA^GHRH^GLUT^GYKI^HCMV^HIDA^HMSN^HSAN^HTLV^IDDM^INTP^IPPB^KAFO^LATS^LHRH^MAGE^MLVP^MPTP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",65,0)
 I "^ANIT^CAMP^DOPS^MPTP^HETE^OERR^GMPT^GMPL^MTLU^UMLS^BPDE^DMBA^PABA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",66,0)
 I "^MPTP^NADH^NADP^NAPS^NETT^NGFI^NRDC^NSCL^PAPS^POMC^PSAP^RTEM^SACH^SGOT^SNAP^SRIF^SRIH^TAPA^TATA^TCDD^TENS^TIMP^TLSO^UDPG^VIII^VLDL^WHFO^XIII^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",67,0)
 I "^USED^EACH^DTMN,FOUR^FIVE^NINE^HOUR^INTO^LESS^LIKE^MORE^ONLY^OPEN^OVER^PART^SITE^THAN^TYPE^WITH^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",68,0)
 I "^BEST^IT'S^LATE^SITE^FROM^SOME^WITH^UPON^THEY^THEN^INTO^MORE^THAN^THAT^THIS^THUS^HAVE^BEEN^NOTE^DONE^MUST^MERE^SURE^KIND^WHEN^WHAT^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",69,0)
 I "^LOST^LIKE^OURS^ALSO^EACH^ONLY^HERE^SUCH^SEEN^SAME^LESS^AREA^MANY^EVEN^LEFT^MOST^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",70,0)
 Q
"RTN","GMTSUMX2",71,0)
 ;          
"RTN","GMTSUMX2",72,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX2",73,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSUMX2",74,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX3")
0^13^B30116533
"RTN","GMTSUMX3",1,0)
GMTSUMX3 ; SLC/KER - Convert Text to Mix Case (5+) ; 07/18/2000
"RTN","GMTSUMX3",2,0)
 ;;2.7;Health Summary;**30,37**;Oct 20, 1995
"RTN","GMTSUMX3",3,0)
 ;;
"RTN","GMTSUMX3",4,0)
 ;              
"RTN","GMTSUMX3",5,0)
5 ; 5 Characters
"RTN","GMTSUMX3",6,0)
 S:X="CAMPS" Y="cAMPS" S:X="CVIBI" Y="CviBI" S:X="DNASE" Y="DNase" S:X="ECORI" Y="EcoRI" S:X="GROEL" Y="GroEL" S:X="HAEII" Y="HaeII" S:X="HBSAG" Y="HBsAg" Q:$L($G(Y))
"RTN","GMTSUMX3",7,0)
 S:X="HINFI" Y="HinfI" S:X="HNRNP" Y="hnRNP" S:X="HPAII" Y="HpaII" S:X="HPGRF" Y="hpGRF" S:X="MBOII" Y="MboII" S:X="MELEU" Y="MeLeu" S:X="MEPHE" Y="MePhe" Q:$L($G(Y))
"RTN","GMTSUMX3",8,0)
 S:X="MEPRO" Y="MePro" S:X="NEUAC" Y="NeuAc" S:X="PTHRP" Y="PTHrP" S:X="RNASE" Y="RNase" S:X="SALGI" Y="SalGI" S:X="SNRNP" Y="snRNP" Q:$L($G(Y))
"RTN","GMTSUMX3",9,0)
 I "^APRIL^ARBOR^BARRE^BEACH^BLACK^BLUFF^BRONX^CLOUD^CREEK^DIEGO^DRIVE^FALLS^FARGO^GOISE^GRAND^HAVEN^HILLS^HINES^JUNCT^LINDA^LOUIS^LYONS^MARCH^MEADE^MIAMI^MILES^NORTH^OMAHA^PASSO^PERRY^PINES^PITTS^POINT^PUGET^RIVER^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",10,0)
 I "^RIVER^SAINT^SALEM^SIOUX^SOUND^SOUTH^TAMPA^TEXAS^TOGUS^TOMAH^VEGAS^WALLA^WAYNE^WHITE^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",11,0)
 I "^CALLA^CCAAT^CTLSO^DPDPE^HKAFO^IGFBP^NADPH^NIDDM^PACAP^SAIDS^SPECT^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX3",12,0)
 I "^DOPAC^ZPACK^EPSDT^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX3",13,0)
 I "^BELOW^FIRST^FOUND^HOURS^SIXTH^FIFTH^LOWER^MAJOR^OTHER^SITES^STATE^THIRD^THREE^UPPER^"[$$UP(X) S Y=$$LO(X) Q
"RTN","GMTSUMX3",14,0)
 I "^GIVEN^FORTH^THESE^WHERE^OFTEN^AFTER^RIGHT^WOULD^COULD^OUTER^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",15,0)
 Q
"RTN","GMTSUMX3",16,0)
6 ; 6 Characters
"RTN","GMTSUMX3",17,0)
 S:X="DESGLY" Y="desGly" S:X="ECORII" Y="EcoRII" S:X="GALNAC" Y="GalNAc" S:X="GLCNAC" Y="GlcNAc" S:X="GTPASE" Y="GTPase" S:X="LEFORT" Y="LeFort" S:X="MURNAC" Y="MurNAc" Q:$L($G(Y))
"RTN","GMTSUMX3",18,0)
 S:X="PTDINS" Y="PtdIns" S:X="STYLTI" Y="StyLTI" S:X="UVRABC" Y="uvrABC" Q:$L($G(Y))
"RTN","GMTSUMX3",19,0)
 I "^RETURN^ANGLES^AUGUST^BATTLE^BILOXI^BONHAM^BOSTON^BUTLER^CASTLE^CLINIC^DALLAS^DAYTON^DENVER^DUBLIN^DURHAM^FRESNO^HEALTH^HGHLND^HOWARD^HUDSON^ISLAND^JERSEY^KANSAS^LESSER^LITTLE^MANILA^MARION^MARLIN^MOINES^ORANGE^POPLAR^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",20,0)
 I "^POPLAR^SPRING^TACOMA^TEMPLE^TOPEKA^TUCSON^VALLEY^WILKES^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",21,0)
 I "^DMEPOS^PEPPTS^"[$$UP(X) S Y=$$UP(X) Q
"RTN","GMTSUMX3",22,0)
 I "^INSIDE^FILING^FOURTH^CLOSED^CYCLIC^DEGREE^DEVICE^DURING^EFFECT^EXCEPT^FACTOR^LENGTH^"[$$UP(X) S Y=$$LO(X) Q
"RTN","GMTSUMX3",23,0)
 I "^MOLDED^BEFORE^ITSELF^WITHIN^REGION^RETURN^SECOND^SINGLE^"[$$UP(X) S Y=$$LO(X) Q
"RTN","GMTSUMX3",24,0)
 Q
"RTN","GMTSUMX3",25,0)
7 ; 7 Characters
"RTN","GMTSUMX3",26,0)
 I "^ALTOONA^ANTONIO^ATLANTA^AUGUSTA^BATAVIA^BECKLEY^BEDFORD^BUFFALO^CENTRAL^CHICAGO^EASTERN^FLORIDA^GEORGIA^GREATER^HAMPTON^HOUSTON^JACKSON^JANUARY^LEBANON^LINCOLN^MADISON^MEMPHIS^OCTOBER^ORLEANS^PATIENT^PHOENIX^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",27,0)
 I "^PHOENIX^SAGINAW^SEATTLE^SPOKANE^SPRINGS^WESTERN^WICHITA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",28,0)
 I "^APHAKIC^"[$$UP(X) S Y=$$UP(X) Q
"RTN","GMTSUMX3",29,0)
 I "^EFFECTS^BETWEEN^ONESELF^HERSELF^HIMSELF^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",30,0)
 I "^OUTSIDE^ANOTHER^THEREBY^WITHOUT^MENTION^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",31,0)
 Q
"RTN","GMTSUMX3",32,0)
8 ; 8 Characters
"RTN","GMTSUMX3",33,0)
 I "^BROCKTON^BROOKLYN^CHEYENNE^COLUMBIA^COLUMBUS^DANVILLE^DECEMBER^FAYETTVL^FEBRUARY^HARRISON^HIGHLAND^HONOLULU^JUNCTION^MARTINEZ^MARYLAND^MONTROSE^MOUNTAIN^MOUNTIAN^MUSKOGEE^NEBRASKA^NORTHERN^OKLAHOMA^PORTLAND^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",34,0)
 I "^PORTLAND^PRESCOTT^RICHMOND^ROSEBURG^SHERIDAN^SOUTHERN^SYRACUSE^TUSKEGEE^VETERANS^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",35,0)
 I "^ALTHOUGH^INJURING^INCLUDES^EXCLUDES^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",36,0)
 Q
"RTN","GMTSUMX3",37,0)
9 ; 9 Characters
"RTN","GMTSUMX3",38,0)
 I "^ASHEVILLE^BALTIMORE^CLEVELAND^FRANCISCO^KERRVILLE^KNOXVILLE^LEXINGTON^LIVERMORE^MILWAUKEE^NASHVILLE^NEWINGTON^NORTHPORT^SALISBURY^SEPTEMBER^SEPULVEDA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",39,0)
 I "^OTHERWISE^SPECIFIED^INCLUDING^EXCLUDING^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",40,0)
 Q
"RTN","GMTSUMX3",41,0)
M ; 10 or more Characters
"RTN","GMTSUMX3",42,0)
10 S:X="GDPMANNOSE" Y="GDPmannose" S:X="UDPGLUCOSE" Y="UDPglucose" Q:$L($G(Y))
"RTN","GMTSUMX3",43,0)
 I "^BIRMINGHAM^CALIFORNIA^CHARLESTON^CINCINNATI^CLARKSBURG^HEALTHCARE^HUNTINGTON^LOUISVILLE^MANCHESTER^MONTGOMERY^PITTSBURGH^PROVIDENCE^SHREVEPORT^TUSCALOOSA^UNIVERSITY^WASHINGTON^WILMINGTON^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",44,0)
11 I "^CANANDAIGUA^CHILLICOTHE^COATESVILLE^CONNECTICUT^GAINESVILLE^LEAVENWORTH^MARTINSBURG^MINNEAPOLIS^NORTHAMPTON^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",45,0)
 I "^UNSPECIFIED^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",46,0)
12 I "^INDIANAPOLIS^MURFREESBORO^PHILADELPHIA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",47,0)
 Q
"RTN","GMTSUMX3",48,0)
 Q
"RTN","GMTSUMX3",49,0)
 ;          
"RTN","GMTSUMX3",50,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX3",51,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSUMX3",52,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX3",53,0)
LD(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","GMTSUMX3",54,0)
TRIM(X) S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSUMX3",55,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSUMX3",56,0)
 Q X
"RTN","GMTSXPD3")
0^15^B52302276
"RTN","GMTSXPD3",1,0)
GMTSXPD3 ; SLC/KER - Health Summary Dist (Index/ADH)     ; 07/18/2000
"RTN","GMTSXPD3",2,0)
 ;;2.7;Health Summary;**35,37**;Oct 20, 1995
"RTN","GMTSXPD3",3,0)
 Q
"RTN","GMTSXPD3",4,0)
 ;                      
"RTN","GMTSXPD3",5,0)
BUILD ; Rebuild AD Hoc Health Summary 
"RTN","GMTSXPD3",6,0)
 ;   Set Variable GMTSQT for QUIET Rebuild
"RTN","GMTSXPD3",7,0)
 N GMTSENV,DIK,DA,X,Y,INCLUDE S GMTSENV=$$ENV Q:'GMTSENV  S INCLUDE=0 D M(" "),RC,RT,RB
"RTN","GMTSXPD3",8,0)
 Q
"RTN","GMTSXPD3",9,0)
BUILDQ ; Quiet Rebuild
"RTN","GMTSXPD3",10,0)
 N GMTSQT S GMTSQT="" D BUILD Q
"RTN","GMTSXPD3",11,0)
 ;
"RTN","GMTSXPD3",12,0)
TSK(X) ; Tasked Rebuild 
"RTN","GMTSXPD3",13,0)
 ;   Returns   0  Not tasked
"RTN","GMTSXPD3",14,0)
 ;            -1  Currently running
"RTN","GMTSXPD3",15,0)
 ;             #  Task Number
"RTN","GMTSXPD3",16,0)
 ;
"RTN","GMTSXPD3",17,0)
 S X=0,ZTRTN="TSKB^GMTSXPD3",ZTDESC="Rebuilding AD Hoc Health Summary",ZTIO="",ZTDTH=$H
"RTN","GMTSXPD3",18,0)
 S:$D(^TMP("GMTSXPD3")) X=-1 Q:X<0 X
"RTN","GMTSXPD3",19,0)
 ; DBIA 10063 call ^%ZTLOAD
"RTN","GMTSXPD3",20,0)
 I '$D(^TMP("GMTSXPD3")) S ^TMP("GMTSXPD3")="" D ^%ZTLOAD
"RTN","GMTSXPD3",21,0)
 S X=+($G(ZTSK))
"RTN","GMTSXPD3",22,0)
 ; DBIA 10086 call HOME^%ZIS
"RTN","GMTSXPD3",23,0)
 D HOME^%ZIS K ZTSAVE,ZTRTN,ZTDESC,ZTIO,ZTDTH,ZTSK
"RTN","GMTSXPD3",24,0)
 Q X
"RTN","GMTSXPD3",25,0)
TSKB S ^TMP("GMTSXPD3")="" S:$D(ZTQUEUED) ZTREQ="@" D BUILDQ K ^TMP("GMTSXPD3")
"RTN","GMTSXPD3",26,0)
 Q
"RTN","GMTSXPD3",27,0)
TO(GMTSCOM,GMTSTIM,GMTSOCC) ;  Update Ad Hoc default time and occurrences
"RTN","GMTSXPD3",28,0)
 N GMTSTAD,GMTSTAS,GMTSTAN,GMTSTNN,GMTSTOT,GMTSTOC,GMTSTOO,GMTSTAV
"RTN","GMTSXPD3",29,0)
 N GMTSTTA,GMTSTOA,GMTSTQN,GMTST1,GMTST2,GMTSTLL,GMTSOLL
"RTN","GMTSXPD3",30,0)
 S GMTSCOM=$G(GMTSCOM) Q:'$L(GMTSCOM)  S GMTSTIM=$$UP($G(GMTSTIM)),GMTSTAD=$$A S:+GMTSTIM=0 GMTSTIM=""
"RTN","GMTSXPD3",31,0)
 S GMTSOCC=+($G(GMTSOCC)) S:GMTSOCC=0 GMTSOCC="" S GMTSCOM=$$R(GMTSCOM),GMTSTOC=$$C(GMTSCOM),GMTSTTA=0 S:GMTSCOM=GMTSTOC GMTSTTA=$$TA(GMTSCOM)
"RTN","GMTSXPD3",32,0)
 S GMTSTOA=0 S:GMTSCOM=GMTSTOC GMTSTOA=$$OA(GMTSCOM) S GMTSTOT=$$T(GMTSTIM),GMTSTOO=$$O(GMTSOCC)
"RTN","GMTSXPD3",33,0)
 S GMTSTAD=$$A,GMTSTAS=$$S(GMTSTAD,GMTSTOC),GMTSTAN=$$N(GMTSTAD,GMTSTAS),GMTSTAV=""
"RTN","GMTSXPD3",34,0)
 S:$L(GMTSTAN) GMTSTAV=@GMTSTAN S GMTSTNN=GMTSTAV,GMTSTQN="" S:$L(GMTSTNN,"^")>2&(GMTSTOO=GMTSOCC) $P(GMTSTNN,"^",3)=GMTSOCC
"RTN","GMTSXPD3",35,0)
 S:$L(GMTSOCC)&(GMTSTOO=GMTSOCC) $P(GMTSTNN,"^",3)=GMTSOCC S:$L(GMTSTNN,"^")>3&(GMTSTOT=GMTSTIM) $P(GMTSTNN,"^",4)=GMTSTIM
"RTN","GMTSXPD3",36,0)
 S:$L(GMTSTIM)&(GMTSTOT=GMTSTIM) $P(GMTSTNN,"^",4)=GMTSTIM S:'GMTSTTA&($L(GMTSTNN,"^")>3) GMTSTNN=$P(GMTSTNN,"^",1,3)
"RTN","GMTSXPD3",37,0)
 S:'GMTSTTA&($P(GMTSTNN,"^",3)="") GMTSTNN=$P(GMTSTNN,"^",1,2) S:'GMTSTOA&($L(GMTSTNN,"^")=3) GMTSTNN=$P(GMTSTNN,"^",1,2)
"RTN","GMTSXPD3",38,0)
 S:'GMTSTOA&($L(GMTSTNN,"^")>3) $P(GMTSTNN,"^",3)=""
"RTN","GMTSXPD3",39,0)
 S:+GMTSTAS>0&($D(^GMT(142,+($G(GMTSTAD)),1,+GMTSTAS,0))) $P(GMTSTQN,"^",1)=GMTSTAS
"RTN","GMTSXPD3",40,0)
 S:+GMTSTOC>0&(GMTSTOC=GMTSCOM)&($D(^GMT(142.1,+($G(GMTSTOC)),0))) $P(GMTSTQN,"^",2)=GMTSTOC
"RTN","GMTSXPD3",41,0)
 S:+GMTSTOA>0&($L(GMTSTOO)) $P(GMTSTQN,"^",3)=GMTSTOO,GMTSOCC=GMTSTOO
"RTN","GMTSXPD3",42,0)
 S:+GMTSTTA>0&($L(GMTSTOT)) $P(GMTSTQN,"^",4)=GMTSTOT,GMTSTIM=GMTSTOT
"RTN","GMTSXPD3",43,0)
 S:+GMTSTOA=0&($L(GMTSTOO)) GMTSTOO="" S:+GMTSTTA=0&($L(GMTSTOT)) GMTSTOT=""
"RTN","GMTSXPD3",44,0)
 Q:'$L(GMTSTAN)  Q:'$L(GMTSTQN)  Q:'$D(^GMT(142,+($G(GMTSTAD)),0))  Q:'$D(^GMT(142,+($G(GMTSTAD)),1,+($G(GMTSTAS)),0))
"RTN","GMTSXPD3",45,0)
 Q:GMTSTOT'=GMTSTIM  Q:GMTSTOO'=GMTSOCC  Q:GMTSCOM'=GMTSTOC  Q:$P(GMTSTNN,"^",1,2)'=$P(GMTSTQN,"^",1,2)
"RTN","GMTSXPD3",46,0)
 S GMTSCOM=$P(GMTSTQN,"^",2),GMTSOCC=$P(GMTSTQN,"^",3),GMTSTIM=$P(GMTSTQN,"^",4)
"RTN","GMTSXPD3",47,0)
 Q:+GMTSCOM=0  S GMTSCOM=$P($G(^GMT(142.1,+GMTSCOM,0)),"^",1) Q:'$L(GMTSCOM)
"RTN","GMTSXPD3",48,0)
 S GMTST1=" Setting time and occurrence limits for GMTS HS ADHOC OPTION component" D BM(GMTST1)
"RTN","GMTSXPD3",49,0)
 S GMTSOLL=$$OLL(+GMTSOCC),GMTSTLL=$$TLL(GMTSTIM)
"RTN","GMTSXPD3",50,0)
 I $L(GMTSOLL),$L(GMTSTLL) D
"RTN","GMTSXPD3",51,0)
 . S GMTST1=" "_GMTSCOM_" (Limits - "_GMTSTLL_" and "_GMTSOLL_")" D M(GMTST1)
"RTN","GMTSXPD3",52,0)
 I '$L(GMTSOLL)!('$L(GMTSTLL)) D
"RTN","GMTSXPD3",53,0)
 . S GMTST1=" "_GMTSCOM D M(GMTST1)
"RTN","GMTSXPD3",54,0)
 . S GMTST1=$S($L($G(GMTSTIM))&($L($G(GMTSTLL))):"   Limits:        ",1:"   Time Limits:        ")
"RTN","GMTSXPD3",55,0)
 . S GMTST2=$S($L($G(GMTSTIM))&('$L($G(GMTSTLL))):GMTSTIM,$L($G(GMTSTIM))&($L($G(GMTSTLL))):GMTSTLL,1:"No time limit <null>") D M((GMTST1_GMTST2))
"RTN","GMTSXPD3",56,0)
 . S GMTST1=$S($L($G(GMTSTIM))&($L($G(GMTSTLL))):"                  ",1:"   Occurrence Limits:  ")
"RTN","GMTSXPD3",57,0)
 . S GMTST2=$S($L($G(GMTSOCC))&('$L($G(GMTSOLL))):GMTSOCC,$L($G(GMTSOCC))&($L($G(GMTSOLL))):GMTSOLL,1:"No occurrence limit <null>") D M((GMTST1_GMTST2))
"RTN","GMTSXPD3",58,0)
 S @GMTSTAN=GMTSTQN
"RTN","GMTSXPD3",59,0)
 Q
"RTN","GMTSXPD3",60,0)
 ;                      
"RTN","GMTSXPD3",61,0)
 ; Indexing                     
"RTN","GMTSXPD3",62,0)
RT ;   Re-Index HS Type File
"RTN","GMTSXPD3",63,0)
 N GMTST,GMTSL,GMTSQ,GMTSC,GMTSE,DA,DIK,DIC,X,Y
"RTN","GMTSXPD3",64,0)
 S U="^",GMTSE=59,GMTST=" Re-Indexing Health Summary Type file "
"RTN","GMTSXPD3",65,0)
 S GMTSL=$L(GMTST),(GMTSC,DA)=0 F  S DA=$O(^GMT(142,DA)) Q:+DA=0  S GMTSC=GMTSC+1
"RTN","GMTSXPD3",66,0)
 S GMTSC=GMTSC-1,GMTSQ=GMTSC\(GMTSE-$L(GMTST)) S:GMTSQ'>0 GMTSQ=1 D M(GMTST)
"RTN","GMTSXPD3",67,0)
 S DIK="^GMT(142,",(GMTSC,DA)=0 F  S DA=$O(^GMT(142,DA)) Q:+DA=0  D
"RTN","GMTSXPD3",68,0)
 . ; DBIA 10013 call IX^DIK
"RTN","GMTSXPD3",69,0)
 . D IX^DIK Q:$D(GMTSQT)
"RTN","GMTSXPD3",70,0)
 . S GMTSC=GMTSC+1 S:GMTSC#GMTSQ=0 GMTSL=GMTSL+1 Q:GMTSL>GMTSE
"RTN","GMTSXPD3",71,0)
 . W:GMTSC#GMTSQ=0 "."
"RTN","GMTSXPD3",72,0)
 I '$D(GMTSQT),GMTSL'>GMTSE F  S GMTSL=GMTSL+1 Q:GMTSL>GMTSE  W "."
"RTN","GMTSXPD3",73,0)
 W:'$D(GMTSQT) ?GMTSE," < done >"
"RTN","GMTSXPD3",74,0)
 Q
"RTN","GMTSXPD3",75,0)
RC ;   Re-Index HS Component File
"RTN","GMTSXPD3",76,0)
 N GMTST,GMTSL,GMTSQ,GMTSC,GMTSE,DA,DIK,DIC,X,Y
"RTN","GMTSXPD3",77,0)
 S U="^",GMTSE=59,GMTST=" Re-Indexing Health Summary Component file ",GMTSL=$L(GMTST),(GMTSC,DA)=0
"RTN","GMTSXPD3",78,0)
 F  S DA=$O(^GMT(142.1,DA)) Q:+DA=0  S GMTSC=GMTSC+1
"RTN","GMTSXPD3",79,0)
 S GMTSC=GMTSC-1,GMTSQ=GMTSC\(GMTSE-$L(GMTST)) S:GMTSQ'>0 GMTSQ=1 D M(GMTST)
"RTN","GMTSXPD3",80,0)
 S DIK="^GMT(142.1,",(GMTSC,DA)=0 F  S DA=$O(^GMT(142.1,DA)) Q:+DA=0  D
"RTN","GMTSXPD3",81,0)
 . ; DBIA 10013 call IX^DIK
"RTN","GMTSXPD3",82,0)
 . D IX^DIK Q:$D(GMTSQT)
"RTN","GMTSXPD3",83,0)
 . S GMTSC=GMTSC+1 S:GMTSC#GMTSQ=0 GMTSL=GMTSL+1 Q:GMTSL>GMTSE
"RTN","GMTSXPD3",84,0)
 . W:GMTSC#GMTSQ=0 "."
"RTN","GMTSXPD3",85,0)
 I '$D(GMTSQT),GMTSL'>GMTSE F  S GMTSL=GMTSL+1 Q:GMTSL>GMTSE  W "."
"RTN","GMTSXPD3",86,0)
 W:'$D(GMTSQT) ?GMTSE," < done >"
"RTN","GMTSXPD3",87,0)
 Q
"RTN","GMTSXPD3",88,0)
RA ;   Re-Index HS Type "Ad Hoc"
"RTN","GMTSXPD3",89,0)
 ; DBIA 10013 call IX1^DIK
"RTN","GMTSXPD3",90,0)
 N GMTST,DA,DIK S DIK="^GMT(142,",DA=$$A,U="^" Q:+DA=0  D IX1^DIK
"RTN","GMTSXPD3",91,0)
 Q
"RTN","GMTSXPD3",92,0)
RB ;   Re-Build Ad Hoc Health Summary Type
"RTN","GMTSXPD3",93,0)
 D RB^GMTSXPD4 Q
"RTN","GMTSXPD3",94,0)
 ;                      
"RTN","GMTSXPD3",95,0)
 ; Check Input
"RTN","GMTSXPD3",96,0)
T(X) ;   Time Input Transform
"RTN","GMTSXPD3",97,0)
 ; DBIA 10104 call $$UP^XLFSTR
"RTN","GMTSXPD3",98,0)
 S X=$$UP^XLFSTR($G(X)) S:$L(X)>5!($L(X)<1)!'((X?1N.N1U)!(X?1N.N1"D")!(X?1N.N1"W")!(X?1N.N1"M")!(X?1N.N1"Y")) X="1Y" Q X
"RTN","GMTSXPD3",99,0)
O(X) ;   Occurrence Input Transform
"RTN","GMTSXPD3",100,0)
 S X=$G(X) S:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X="10" Q X
"RTN","GMTSXPD3",101,0)
C(X) ;   Component Input Transform
"RTN","GMTSXPD3",102,0)
 S X=$G(X) Q:'$L(X) "Error" Q:+X'>0 "Error" Q:'$D(^GMT(142.1,+X,0)) "Error" S X=+X Q X
"RTN","GMTSXPD3",103,0)
R(X) ;   Resolve Pointer
"RTN","GMTSXPD3",104,0)
 S X=$G(X) Q:'$L(X) "" N GMTSA S GMTSA=X I $D(^GMT(142.1,+X,0)) S X=+X Q X
"RTN","GMTSXPD3",105,0)
 S:$D(^GMT(142.1,"B",X)) GMTSA=+($O(^GMT(142.1,"B",X,0))) S:GMTSA=X&($D(^GMT(142.1,"B",$$UP(X)))) GMTSA=+($O(^GMT(142.1,"B",$$UP(X),0))) I GMTSA'=X S X=GMTSA Q X
"RTN","GMTSXPD3",106,0)
 S:GMTSA=X&($D(^GMT(142.1,"C",X))) GMTSA=+($O(^GMT(142.1,"C",X,0))) S:GMTSA=X&($D(^GMT(142.1,"C",$$UP(X)))) GMTSA=+($O(^GMT(142.1,"C",$$UP(X),0))) I GMTSA'=X S X=GMTSA Q X
"RTN","GMTSXPD3",107,0)
 S:GMTSA=X&($D(^GMT(142.1,"D",X))) GMTSA=+($O(^GMT(142.1,"D",X,0))) S:GMTSA=X&($D(^GMT(142.1,"D",$$UP(X)))) GMTSA=+($O(^GMT(142.1,"D",$$UP(X),0))) I GMTSA'=X S X=GMTSA Q X
"RTN","GMTSXPD3",108,0)
 Q ""
"RTN","GMTSXPD3",109,0)
A(X) ;   Ad Hoc IEN
"RTN","GMTSXPD3",110,0)
 S X=0 S X=+($O(^GMT(142,"AB","GMTS HS ADHOC OPTION",0))) Q:+X>0 +X
"RTN","GMTSXPD3",111,0)
 S X=+($O(^GMT(142,"B","GMTS HS ADHOC OPTION",0))) Q:+X>0 +X
"RTN","GMTSXPD3",112,0)
 S X=+($O(^GMT(142,"E","Ad Hoc Health Summary Type",0))) Q:+X>0 +X Q 0
"RTN","GMTSXPD3",113,0)
S(GMTSA,GMTSC) ;   Structure IEN
"RTN","GMTSXPD3",114,0)
 N GMTST1,GMTST2 S GMTSA=+($G(GMTSA)) Q:GMTSA=0 ""
"RTN","GMTSXPD3",115,0)
 S GMTSC=+($G(GMTSC)) Q:GMTSC=0 ""
"RTN","GMTSXPD3",116,0)
 Q:'$D(^GMT(142,GMTSA,1,"C",GMTSC)) ""
"RTN","GMTSXPD3",117,0)
 Q:'$D(^GMT(142,"AE",GMTSC,GMTSA)) ""
"RTN","GMTSXPD3",118,0)
 S GMTST1=+($O(^GMT(142,GMTSA,1,"C",GMTSC,0)))
"RTN","GMTSXPD3",119,0)
 S GMTST2=+($O(^GMT(142,"AE",GMTSC,GMTSA,0)))
"RTN","GMTSXPD3",120,0)
 Q:GMTST1'=GMTST2!(GMTST1=0)!(GMTST2=0) "" S GMTSA=GMTST1 Q GMTSA
"RTN","GMTSXPD3",121,0)
N(GMTSA,GMTSC) ;   Structure IEN
"RTN","GMTSXPD3",122,0)
 N GMTST1,GMTST2
"RTN","GMTSXPD3",123,0)
 S GMTSA=+($G(GMTSA)) Q:GMTSA=0 "" S GMTSC=+($G(GMTSC)) Q:GMTSC=0 ""
"RTN","GMTSXPD3",124,0)
 S GMTST1="^GMT(142,"_GMTSA_",1,"_GMTSC_",0)",GMTST2=$G(@GMTST1)
"RTN","GMTSXPD3",125,0)
 Q:'$D(@GMTST1) "" Q:'$L(GMTST2) "" S GMTSA=GMTST1 Q GMTSA
"RTN","GMTSXPD3",126,0)
 Q
"RTN","GMTSXPD3",127,0)
TA(X) ;   Time Limits Applicable             S   Y:yes     0;3
"RTN","GMTSXPD3",128,0)
 N GMTSA S GMTSA=$P($G(^GMT(142.1,+($G(X)),0)),"^",3),X=$S(GMTSA="Y":1,1:0) Q X
"RTN","GMTSXPD3",129,0)
OA(X) ;   Maximum Occurrences Applicable     S   Y:yes     0;5
"RTN","GMTSXPD3",130,0)
 N GMTSA S GMTSA=$P($G(^GMT(142.1,+($G(X)),0)),"^",5),X=$S(GMTSA="Y":1,1:0) Q X
"RTN","GMTSXPD3",131,0)
TLL(X) ;   Time Limits (Litteral)
"RTN","GMTSXPD3",132,0)
 S X=$$UP($G(X))
"RTN","GMTSXPD3",133,0)
 N GMTSU,GMTSQ S GMTSQ=+X,GMTSU=$E(X,$L(X)) Q:GMTSU="^"!(GMTSU="") "" Q:GMTSQ=0 ""
"RTN","GMTSXPD3",134,0)
 Q:"^D^W^M^Y^"'[GMTSU "" S GMTSU=$S(GMTSU="D":" day",GMTSU="W":" week",GMTSU="M":" month",GMTSU="Y":" year",1:"") Q:'$L(GMTSU) ""
"RTN","GMTSXPD3",135,0)
 S GMTSU=$S(+GMTSQ>1:(GMTSU_"s"),1:GMTSU) S X=+GMTSQ_GMTSU
"RTN","GMTSXPD3",136,0)
 Q X
"RTN","GMTSXPD3",137,0)
OLL(X) ;   Occurrence Limits (Litteral)
"RTN","GMTSXPD3",138,0)
 S X=+($G(X)) Q:X=0 ""
"RTN","GMTSXPD3",139,0)
 N GMTSU,GMTSQ S GMTSQ=+X,GMTSU=" occurrence",GMTSU=$S(+GMTSQ>1:(GMTSU_"s"),1:GMTSU) S X=+GMTSQ_GMTSU
"RTN","GMTSXPD3",140,0)
 Q X
"RTN","GMTSXPD3",141,0)
 ;                      
"RTN","GMTSXPD3",142,0)
 ; Other
"RTN","GMTSXPD3",143,0)
ENV(X) ;   Environment check
"RTN","GMTSXPD3",144,0)
 ; DBIA 10086 call HOME^%ZIS
"RTN","GMTSXPD3",145,0)
 D HOME^%ZIS
"RTN","GMTSXPD3",146,0)
 ; DBIA 2056 call $$GET1^DIQ
"RTN","GMTSXPD3",147,0)
 I '$L($$GET1^DIQ(200,+($G(DUZ)),.01)) D BM("    Invalid User (DUZ)"),M("") Q 0
"RTN","GMTSXPD3",148,0)
 Q 1
"RTN","GMTSXPD3",149,0)
BM(X) ;   Blank Line with Message
"RTN","GMTSXPD3",150,0)
 ; DBIA 10141 call BMES^XPDUTL
"RTN","GMTSXPD3",151,0)
 Q:$D(GMTSQT)  D:$D(XPDNM) BMES^XPDUTL($G(X)) W:'$D(XPDNM) !!,$G(X) Q
"RTN","GMTSXPD3",152,0)
M(X) ;   Message
"RTN","GMTSXPD3",153,0)
 ; DBIA 10141 call MES^XPDUTL
"RTN","GMTSXPD3",154,0)
 Q:$D(GMTSQT)  D:$D(XPDNM) MES^XPDUTL($G(X)) W:'$D(XPDNM) !,$G(X) Q
"RTN","GMTSXPD3",155,0)
UP(X) ;   Uppercase
"RTN","GMTSXPD3",156,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSXPS3")
0^29^B34107288
"RTN","GMTSXPS3",1,0)
GMTSXPS3 ; SLC/KER - Health Summary Status                      ; 07/18/2000
"RTN","GMTSXPS3",2,0)
 ;;2.7;Health Summary;**35,34,37**;Oct 20, 1995
"RTN","GMTSXPS3",3,0)
 ;
"RTN","GMTSXPS3",4,0)
 Q
"RTN","GMTSXPS3",5,0)
STA ; Status of Components
"RTN","GMTSXPS3",6,0)
 D CLR,EXP,CHK,CLR Q
"RTN","GMTSXPS3",7,0)
CHK ;   Check Health Summary Components
"RTN","GMTSXPS3",8,0)
 N GMTSI,GMTSSNM,GMTSSAB,GMTSSDF,GMTSENM,GMTSEAB,GMTSEDF,GMTSCNT,GMTSDUP,X
"RTN","GMTSXPS3",9,0)
 S (GMTSCNT,GMTSI)=0 F  S GMTSI=$O(^GMT(142.1,GMTSI)) Q:+GMTSI=0  D IE
"RTN","GMTSXPS3",10,0)
 S GMTSI=0 F  S GMTSI=$O(^TMP($J,"GMTSST",GMTSI)) Q:+GMTSI=0  D EI
"RTN","GMTSXPS3",11,0)
 Q
"RTN","GMTSXPS3",12,0)
IE ;     Compare Installed to Exported
"RTN","GMTSXPS3",13,0)
 S GMTSSNM=$P($G(^GMT(142.1,GMTSI,0)),"^",1),GMTSSAB=$P($G(^GMT(142.1,GMTSI,0)),"^",4),GMTSSDF=$P($G(^GMT(142.1,GMTSI,0)),"^",6)
"RTN","GMTSXPS3",14,0)
 I GMTSI<501,'$D(^TMP($J,"GMTSST",GMTSI)) S X="      "_GMTSSNM_" not exported ("_GMTSI_")" D CL(X) Q
"RTN","GMTSXPS3",15,0)
 S GMTSENM=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",1),GMTSEAB=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",2),GMTSEDF=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",3)
"RTN","GMTSXPS3",16,0)
 I GMTSI<501,$L(GMTSSNM),GMTSENM="",'$D(^GMT(142.1,"B",GMTSSNM)) S X="      "_GMTSSNM_" not exported" D CL(X) Q
"RTN","GMTSXPS3",17,0)
 I GMTSI<501,$L(GMTSSNM),GMTSENM="",$D(^GMT(142.1,"B",GMTSSNM)) S GMTSDUP=0 D DP Q:+GMTSDUP>1
"RTN","GMTSXPS3",18,0)
 I GMTSI<501,$L(GMTSSNM),GMTSENM="",$D(^GMT(142.1,"B",GMTSSNM)) S X="      "_GMTSSNM_" w/wrong IEN ("_GMTSI_")" D CL(X) Q
"RTN","GMTSXPS3",19,0)
 I GMTSI<501,GMTSSNM'=GMTSENM S X="      "_"Not exported as "_GMTSSNM D CL(X) Q
"RTN","GMTSXPS3",20,0)
 I GMTSI<501,GMTSSDF="P",GMTSEDF'="P" S X="      "_GMTSSNM_" disabled at site" D CL(X) Q
"RTN","GMTSXPS3",21,0)
 I GMTSI<501,GMTSSDF="",GMTSEDF="P" S X="      Disable component "_GMTSSNM_" in use" D CL(X) Q
"RTN","GMTSXPS3",22,0)
 I GMTSI>500,GMTSENM="" S X="      "_GMTSSNM_" (local component)" D CL(X) Q
"RTN","GMTSXPS3",23,0)
 Q
"RTN","GMTSXPS3",24,0)
EI ;     Compare Exported to Installed
"RTN","GMTSXPS3",25,0)
 S GMTSSNM=$P($G(^GMT(142.1,GMTSI,0)),"^",1),GMTSSAB=$P($G(^GMT(142.1,GMTSI,0)),"^",4),GMTSSDF=$P($G(^GMT(142.1,GMTSI,0)),"^",6)
"RTN","GMTSXPS3",26,0)
 S GMTSENM=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",1),GMTSEAB=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",2),GMTSEDF=$P($G(^TMP($J,"GMTSST",GMTSI)),"^",3)
"RTN","GMTSXPS3",27,0)
 I GMTSI<501,GMTSSNM="" S X="      "_GMTSENM_" exported/not found" D CL(X) Q
"RTN","GMTSXPS3",28,0)
 I GMTSI<501,GMTSSNM'=GMTSENM S X="      "_GMTSSNM_" exported/modified" D CL(X) Q
"RTN","GMTSXPS3",29,0)
 Q
"RTN","GMTSXPS3",30,0)
DP ;     Duplicate Components
"RTN","GMTSXPS3",31,0)
 N X,GMTSI,GMTSIS Q:'$L($G(GMTSSNM))
"RTN","GMTSXPS3",32,0)
 S GMTSIS="",GMTSI=0 F  S GMTSI=$O(^GMT(142.1,"B",GMTSSNM,GMTSI)) Q:+GMTSI=0  D
"RTN","GMTSXPS3",33,0)
 . S GMTSDUP=+($G(GMTSDUP))+1,GMTSIS=GMTSIS_"/"_GMTSI
"RTN","GMTSXPS3",34,0)
 S:$E(GMTSIS,1)="/" GMTSIS=$E(GMTSIS,2,$L(GMTSIS)) S:GMTSIS'["/" GMTSDUP=1
"RTN","GMTSXPS3",35,0)
 I +($G(GMTSDUP))>1 S X="      "_GMTSSNM_" duplicated ("_GMTSIS_")" D CL(X)
"RTN","GMTSXPS3",36,0)
 Q
"RTN","GMTSXPS3",37,0)
 ;                            
"RTN","GMTSXPS3",38,0)
 ; Miscellaneous
"RTN","GMTSXPS3",39,0)
EXP ;   Retrieve Exported Components
"RTN","GMTSXPS3",40,0)
 N GMTSEX,GMTSTXT,GMTSI,GMTSCI,GMTSNM,GMTSAB,GMTSDF S GMTSTXT="" F GMTSI=1:1 D  Q:'$L(GMTSTXT)
"RTN","GMTSXPS3",41,0)
 . S GMTSTXT="" S GMTSEX="S GMTSTXT=$T(COMP+"_GMTSI_")" X GMTSEX S GMTSTXT=$P(GMTSTXT,";",3,299) Q:GMTSTXT=""  S GMTSCI=+($P(GMTSTXT,";",1)) Q:GMTSCI=0  S GMTSNM=$P(GMTSTXT,";",2) Q:GMTSNM=""
"RTN","GMTSXPS3",42,0)
 . S GMTSAB=$P(GMTSTXT,";",3) Q:GMTSAB=""  S GMTSDF=$P(GMTSTXT,";",4),^TMP($J,"GMTSST",GMTSCI)=GMTSNM_"^"_GMTSAB_"^"_GMTSDF
"RTN","GMTSXPS3",43,0)
 Q
"RTN","GMTSXPS3",44,0)
CLR ;   Clean up
"RTN","GMTSXPS3",45,0)
 K ^TMP($J,"GMTSST") Q
"RTN","GMTSXPS3",46,0)
CL(X) ;   Component Status Line
"RTN","GMTSXPS3",47,0)
 S X=$G(X) S:$L(X) GMTSCNT=+($G(GMTSCNT))+1 D:GMTSCNT=1 TL^GMTSXPS1("    Component Status:")
"RTN","GMTSXPS3",48,0)
 D TL^GMTSXPS1(X) Q
"RTN","GMTSXPS3",49,0)
COMP ;   Components List (exported)
"RTN","GMTSXPS3",50,0)
 ;;1;ADVERSE REACTIONS/ALLERGIES;ADR
"RTN","GMTSXPS3",51,0)
 ;;2;MAS DEMOGRAPHICS BRIEF;BDEM
"RTN","GMTSXPS3",52,0)
 ;;3;LAB CHEMISTRY & HEMATOLOGY;CH
"RTN","GMTSXPS3",53,0)
 ;;4;CLINICAL WARNINGS;CW
"RTN","GMTSXPS3",54,0)
 ;;5;CRISIS NOTES;CN
"RTN","GMTSXPS3",55,0)
 ;;6;MAS DEMOGRAPHICS;DEM
"RTN","GMTSXPS3",56,0)
 ;;7;DIETETICS;DI
"RTN","GMTSXPS3",57,0)
 ;;8;MAS DISCHARGES;DC
"RTN","GMTSXPS3",58,0)
 ;;9;MAS CLINIC VISITS FUTURE;CVF
"RTN","GMTSXPS3",59,0)
 ;;10;MAS ADMISSIONS/DISCHARGES;ADC
"RTN","GMTSXPS3",60,0)
 ;;11;MAS DISCHARGE DIAGNOSIS;DD
"RTN","GMTSXPS3",61,0)
 ;;12;MAS SURGERIES ICD CODES;OPC
"RTN","GMTSXPS3",62,0)
 ;;14;MAS CLINIC VISITS PAST;CVP
"RTN","GMTSXPS3",63,0)
 ;;15;PROGRESS NOTES;PN
"RTN","GMTSXPS3",64,0)
 ;;16;MAS TRANSFERS;TR
"RTN","GMTSXPS3",65,0)
 ;;17;MAS TREATING SPECIALTY;TS
"RTN","GMTSXPS3",66,0)
 ;;18;LAB CUMULATIVE SELECTED 1;SCL1
"RTN","GMTSXPS3",67,0)
 ;;19;LAB CUMULATIVE SELECTED 2;SCL2
"RTN","GMTSXPS3",68,0)
 ;;20;LAB CUMULATIVE SELECTED 3;SCL3
"RTN","GMTSXPS3",69,0)
 ;;21;LAB CUMULATIVE SELECTED 4;SCL4
"RTN","GMTSXPS3",70,0)
 ;;23;SURGERY REPORTS;SR
"RTN","GMTSXPS3",71,0)
 ;;24;MAS DISABILITIES;DS
"RTN","GMTSXPS3",72,0)
 ;;25;ADVANCE DIRECTIVE;CD
"RTN","GMTSXPS3",73,0)
 ;;26;PROGRESS NOTES BRIEF;BPN
"RTN","GMTSXPS3",74,0)
 ;;27;SURGERY REPORTS BRIEF;BSR
"RTN","GMTSXPS3",75,0)
 ;;28;PHARMACY OUTPATIENT;RXOP
"RTN","GMTSXPS3",76,0)
 ;;29;PHARMACY UNIT DOSE;RXUD
"RTN","GMTSXPS3",77,0)
 ;;30;PHARMACY INTRAVENOUS;RXIV
"RTN","GMTSXPS3",78,0)
 ;;31;LAB ORDERS BRIEF;BLO
"RTN","GMTSXPS3",79,0)
 ;;32;LAB ORDERS;LO
"RTN","GMTSXPS3",80,0)
 ;;33;LAB TESTS SELECTED;SLT
"RTN","GMTSXPS3",81,0)
 ;;34;RADIOLOGY STATUS;RS
"RTN","GMTSXPS3",82,0)
 ;;35;RADIOLOGY PROFILE;RP
"RTN","GMTSXPS3",83,0)
 ;;36;LAB BLOOD TRANSFUSIONS;BT
"RTN","GMTSXPS3",84,0)
 ;;37;LAB MICROBIOLOGY BRIEF;BMIC
"RTN","GMTSXPS3",85,0)
 ;;38;LAB MICROBIOLOGY;MIC
"RTN","GMTSXPS3",86,0)
 ;;43;LAB CUMULATIVE SELECTED;SCLU
"RTN","GMTSXPS3",87,0)
 ;;45;LAB BLOOD AVAILABILITY;BA
"RTN","GMTSXPS3",88,0)
 ;;46;LAB SURGICAL PATHOLOGY;SP
"RTN","GMTSXPS3",89,0)
 ;;47;VITAL SIGNS;VS
"RTN","GMTSXPS3",90,0)
 ;;48;LAB CYTOPATHOLOGY;CY
"RTN","GMTSXPS3",91,0)
 ;;49;VITAL SIGNS SELECTED;SVS
"RTN","GMTSXPS3",92,0)
 ;;50;MAS PROCEDURES ICD CODES;PRC
"RTN","GMTSXPS3",93,0)
 ;;51;MEDICINE SUMMARY;MEDS
"RTN","GMTSXPS3",94,0)
 ;;52;RADIOLOGY IMPRESSION;RI
"RTN","GMTSXPS3",95,0)
 ;;54;ORDERS CURRENT;ORC
"RTN","GMTSXPS3",96,0)
 ;;55;MAS ADT HISTORY;ADT
"RTN","GMTSXPS3",97,0)
 ;;56;RADIOLOGY IMPRESSION SELECTED;SRI
"RTN","GMTSXPS3",98,0)
 ;;57;DISCHARGE SUMMARY;DCS
"RTN","GMTSXPS3",99,0)
 ;;58;DISCHARGE SUMMARY BRIEF;BDS
"RTN","GMTSXPS3",100,0)
 ;;59;PROBLEM LIST ACTIVE;PLA
"RTN","GMTSXPS3",101,0)
 ;;60;PROBLEM LIST INACTIVE;PLI
"RTN","GMTSXPS3",102,0)
 ;;61;PROBLEM LIST ALL;PLL
"RTN","GMTSXPS3",103,0)
 ;;62;SOCIAL WORK;SW
"RTN","GMTSXPS3",104,0)
 ;;64;MAS ADT HISTORY EXPANDED;EADT
"RTN","GMTSXPS3",105,0)
 ;;65;COMPENSATION AND PENSION EXAMS;CP
"RTN","GMTSXPS3",106,0)
 ;;66;MEDICINE ABNORMAL BRIEF;MEDA
"RTN","GMTSXPS3",107,0)
 ;;67;MEDICINE BRIEF REPORT;MEDB
"RTN","GMTSXPS3",108,0)
 ;;68;MEDICINE FULL CAPTIONED;MEDC
"RTN","GMTSXPS3",109,0)
 ;;69;MEDICINE FULL REPORT;MEDF
"RTN","GMTSXPS3",110,0)
 ;;71;MENTAL HEALTH PHYSICAL EXAM;MHPE
"RTN","GMTSXPS3",111,0)
 ;;72;LAB ELECTRON MICROSCOPY;EM
"RTN","GMTSXPS3",112,0)
 ;;73;ADVERSE REACTIONS/ALLERG BRIEF;BADR
"RTN","GMTSXPS3",113,0)
 ;;74;SPINAL CORD DYSFUNCTION;SCD
"RTN","GMTSXPS3",114,0)
 ;;75;VITAL SIGNS OUTPATIENT;VSO
"RTN","GMTSXPS3",115,0)
 ;;76;VITAL SIGNS SELECTED OUTPAT.;SVSO
"RTN","GMTSXPS3",116,0)
 ;;77;SURGERY ONLY REPORTS;SRO
"RTN","GMTSXPS3",117,0)
 ;;78;SURGERY NON OR PROCEDURES;NSR
"RTN","GMTSXPS3",118,0)
 ;;79;SURGERY SEL NON OR PROCEDURES;SNSR
"RTN","GMTSXPS3",119,0)
 ;;201;PCE LOCATION OF HOME;LH;P
"RTN","GMTSXPS3",120,0)
 ;;202;CLINICAL REMINDERS DUE;CR
"RTN","GMTSXPS3",121,0)
 ;;203;PCE HEALTH FACTORS SELECTED;SHF;P
"RTN","GMTSXPS3",122,0)
 ;;204;PCE HEALTH FACTORS ALL;HF;P
"RTN","GMTSXPS3",123,0)
 ;;205;PCE OUTPATIENT ENCOUNTERS;OE
"RTN","GMTSXPS3",124,0)
 ;;206;PCE MEASUREMENTS NON-TABULAR;NTM;P
"RTN","GMTSXPS3",125,0)
 ;;207;PCE IMMUNIZATIONS;IM;P
"RTN","GMTSXPS3",126,0)
 ;;208;PCE SKIN TESTS;ST;P
"RTN","GMTSXPS3",127,0)
 ;;209;PCE MEASUREMENTS SELECTED;MEAS;P
"RTN","GMTSXPS3",128,0)
 ;;212;PCE EDUCATION;ED
"RTN","GMTSXPS3",129,0)
 ;;213;PCE EDUCATION LATEST;EDL
"RTN","GMTSXPS3",130,0)
 ;;220;PCE OUTPATIENT DIAGNOSIS;OD;P
"RTN","GMTSXPS3",131,0)
 ;;230;PCE EXAMS LATEST;EXAM;P
"RTN","GMTSXPS3",132,0)
 ;;231;PCE TREATMENTS PROVIDED;TP;P
"RTN","GMTSXPS3",133,0)
 ;;232;CLINICAL REMINDERS MAINTENANCE;CM
"RTN","GMTSXPS3",134,0)
 ;;233;PROGRESS NOTES SELECTED;SPN
"RTN","GMTSXPS3",135,0)
 ;;234;CLINICAL REMINDERS SUMMARY;CRS
"RTN","GMTSXPS3",136,0)
 ;;235;MAG IMAGING;MAGI
"RTN","GMTSXPS3",137,0)
 ;;236;ONCOLOGY;ONC
"RTN","GMTSXPS3",138,0)
 ;;237;VITAL SIGNS DETAILED DISPLAY;VSD
"RTN","GMTSXPS3",139,0)
 ;;238;GLOBAL ASSESSMENT FUNCTIONING;GAF
"SEC","^DIC",142,142,0,"AUDIT")
@
"SEC","^DIC",142,142,0,"DD")
@
"SEC","^DIC",142,142,0,"LAYGO")
@
"SEC","^DIC",142.1,142.1,0,"AUDIT")
@
"SEC","^DIC",142.1,142.1,0,"DD")
@
"SEC","^DIC",142.1,142.1,0,"DEL")
@
"SEC","^DIC",142.1,142.1,0,"LAYGO")
@
"SEC","^DIC",142.1,142.1,0,"WR")
@
"VER")
8.0^22.0
"^DD",142,142,0)
FIELD^^.09^10
"^DD",142,142,0,"DDA")
N
"^DD",142,142,0,"DT")
3000726
"^DD",142,142,0,"IX","AB",142,.01)

"^DD",142,142,0,"IX","AE",142.01,1)

"^DD",142,142,0,"IX","AM",142,99)

"^DD",142,142,0,"IX","AW",142,.01)

"^DD",142,142,0,"IX","AW2",142,.02)

"^DD",142,142,0,"IX","AW3",142.2,.01)

"^DD",142,142,0,"IX","AWO",142,.06)

"^DD",142,142,0,"IX","B",142,.01)

"^DD",142,142,0,"IX","C",142,.06)

"^DD",142,142,0,"IX","D",142.2,.01)

"^DD",142,142,0,"IX","E",142,.02)

"^DD",142,142,0,"NM","HEALTH SUMMARY TYPE")

"^DD",142,142,0,"PT",43,43)

"^DD",142,142,0,"PT",71,13)

"^DD",142,142,0,"PT",350.9,2.08)

"^DD",142,142,0,"PT",350.9,2.09)

"^DD",142,142,0,"PT",357.6,.11)

"^DD",142,142,0,"PT",358.6,.11)

"^DD",142,142,0,"VRPK")
GMTS
"^DD",142,142,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",142,142,.01,1,0)
^.1
"^DD",142,142,.01,1,1,0)
142^B
"^DD",142,142,.01,1,1,1)
S ^GMT(142,"B",$E(X,1,30),DA)=""
"^DD",142,142,.01,1,1,2)
K ^GMT(142,"B",$E(X,1,30),DA)
"^DD",142,142,.01,1,1,"%D",0)
^^2^2^2950731^^
"^DD",142,142,.01,1,1,"%D",1,0)
This REGULAR "B" cross-reference is used for Health Summary Type look-up
"^DD",142,142,.01,1,1,"%D",2,0)
by name.
"^DD",142,142,.01,1,2,0)
142^AW^MUMPS
"^DD",142,142,.01,1,2,1)
D STNT^GMTSUIX
"^DD",142,142,.01,1,2,2)
D KTNT^GMTSUIX
"^DD",142,142,.01,1,2,"DT")
2981214
"^DD",142,142,.01,1,3,0)
142^AB^MUMPS
"^DD",142,142,.01,1,3,1)
S ^GMT(142,"AB",$$UP^XLFSTR($E(X,1,30)),DA)=""
"^DD",142,142,.01,1,3,2)
K ^GMT(142,"AB",$$UP^XLFSTR($E(X,1,30)),DA)
"^DD",142,142,.01,1,3,"%D",0)
^^3^3^2990201^
"^DD",142,142,.01,1,3,"%D",1,0)
^GMT(142,"AB",UP,IEN) - Where UP is an uppercase version of the Health 
"^DD",142,142,.01,1,3,"%D",2,0)
Summary Type and IEN is the location where the Health Summary Type is 
"^DD",142,142,.01,1,3,"%D",3,0)
stored.
"^DD",142,142,.01,1,3,"DT")
2990201
"^DD",142,142,.01,3)
Answer must be 3-30 characters in length.
"^DD",142,142,.01,21,0)
^^7^7^2950728^^^^
"^DD",142,142,.01,21,1,0)
Enter the NAME of the Health Summary Type.  This name will appear
"^DD",142,142,.01,21,2,0)
in the health summary header.  The word "CONFIDENTIAL" will appear
"^DD",142,142,.01,21,3,0)
in front of this name and the word "SUMMARY" will appear at the end
"^DD",142,142,.01,21,4,0)
to complete the header.  For example:
"^DD",142,142,.01,21,5,0)
 
"^DD",142,142,.01,21,6,0)
    Name entered: ICU
"^DD",142,142,.01,21,7,0)
Generated header: CONFIDENTIAL ICU SUMMARY
"^DD",142,142,.01,"DEL",1,0)
I $P(^GMT(142,DA,0),U,4)="Y" W $C(7),!,"CANNOT DELETE THIS HEALTH SUMMARY TYPE!!  IT IS USED BY THE AD HOC OPTION"
"^DD",142,142,.01,"DT")
2990201
"^DD",142,142,.02,0)
TITLE^F^^T;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
"^DD",142,142,.02,1,0)
^.1
"^DD",142,142,.02,1,1,0)
142^E
"^DD",142,142,.02,1,1,1)
S ^GMT(142,"E",$E(X,1,30),DA)=""
"^DD",142,142,.02,1,1,2)
K ^GMT(142,"E",$E(X,1,30),DA)
"^DD",142,142,.02,1,1,"%D",0)
^^2^2^2920227^
"^DD",142,142,.02,1,1,"%D",1,0)
This whole-file, regular FileMan cross-reference is used for look-ups
"^DD",142,142,.02,1,1,"%D",2,0)
of Health Summary Types by TITLE.
"^DD",142,142,.02,1,2,0)
142^AW2^MUMPS
"^DD",142,142,.02,1,2,1)
D STNT^GMTSUIX
"^DD",142,142,.02,1,2,2)
D KTNT^GMTSUIX
"^DD",142,142,.02,1,2,"DT")
2981214
"^DD",142,142,.02,3)
ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
"^DD",142,142,.02,21,0)
5^^7^7^2920928^^^^
"^DD",142,142,.02,21,1,0)
Enter the TITLE only if you wish to replace NAME with title in the health
"^DD",142,142,.02,21,2,0)
summary header.  For Example:
"^DD",142,142,.02,21,3,0)
 
"^DD",142,142,.02,21,4,0)
    Name entered: ICU
"^DD",142,142,.02,21,5,0)
   Title entered: INTENSIVE CARE UNIT
"^DD",142,142,.02,21,6,0)
Generated header: CONFIDENTIAL INTENSIVE CARE UNIT SUMMARY
"^DD",142,142,.02,21,7,0)
 
"^DD",142,142,.02,"DT")
2981214
"^DD",142,142,.05,0)
LOCK^FX^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<1) X I $D(X) Q:$D(^DIC(19.1,"B",X))  W !,$C(7),"Lock name must match exactly with a key in the SECURITY KEY file." K X
"^DD",142,142,.05,3)
Enter the name of the security key required to modify this summary type
"^DD",142,142,.05,21,0)
^^9^9^2950731^^^^
"^DD",142,142,.05,21,1,0)
When a Health Summary Type contains a Lock, edit access is normally
"^DD",142,142,.05,21,2,0)
restricted to persons who hold a security key in the SECURITY KEY
"^DD",142,142,.05,21,3,0)
file which is the same as the Lock value. If a Health Summary Type
"^DD",142,142,.05,21,4,0)
contains a Lock, users who hold that security key are NOT restricted
"^DD",142,142,.05,21,5,0)
by Ownership. A holder of the GMTSMGR security key is NOT restricted
"^DD",142,142,.05,21,6,0)
by Locks or Ownership.
"^DD",142,142,.05,21,7,0)
 
"^DD",142,142,.05,21,8,0)
NOTE: Generic Health Summary Types issued with the Health Summary
"^DD",142,142,.05,21,9,0)
package contain the Lock GMTSMGR.
"^DD",142,142,.05,"DT")
2950731
"^DD",142,142,.06,0)
OWNER^P200'^VA(200,^0;3^Q
"^DD",142,142,.06,1,0)
^.1
"^DD",142,142,.06,1,1,0)
142^C
"^DD",142,142,.06,1,1,1)
S ^GMT(142,"C",$E(X,1,30),DA)=""
"^DD",142,142,.06,1,1,2)
K ^GMT(142,"C",$E(X,1,30),DA)
"^DD",142,142,.06,1,1,"%D",0)
^^2^2^2920227^
"^DD",142,142,.06,1,1,"%D",1,0)
This whole-file, regular FileMan cross-reference is used by the Health
"^DD",142,142,.06,1,1,"%D",2,0)
Summary Type selection to look-up summary types by OWNER.
"^DD",142,142,.06,1,2,0)
142^AWO^MUMPS
"^DD",142,142,.06,1,2,1)
D STO^GMTSUIX
"^DD",142,142,.06,1,2,2)
D KTO^GMTSUIX
"^DD",142,142,.06,1,2,"DT")
2990422
"^DD",142,142,.06,21,0)
15^^14^14^2950728^^
"^DD",142,142,.06,21,1,0)
Edit access to each health summary type is normally restricted to
"^DD",142,142,.06,21,2,0)
its Owner.
"^DD",142,142,.06,21,3,0)
 
"^DD",142,142,.06,21,4,0)
Exception 1: Holders of the GMTSMGR security key are NOT restricted
"^DD",142,142,.06,21,5,0)
             by Ownership.
"^DD",142,142,.06,21,6,0)
 
"^DD",142,142,.06,21,7,0)
Exception 2: If a health summary type contains a lock, users who hold
"^DD",142,142,.06,21,8,0)
             that lock key are NOT restricted by Ownership.
"^DD",142,142,.06,21,9,0)
 
"^DD",142,142,.06,21,10,0)
NOTE: When a new health summary type is created, the creator's entry
"^DD",142,142,.06,21,11,0)
number in the new Person File is AUTOMATICALLY entered as Owner unless
"^DD",142,142,.06,21,12,0)
the creator holds the GMTSMGR security key.  A creator who holds the
"^DD",142,142,.06,21,13,0)
GMTSMGR key may enter an Owner (IFN from new Person file) of his/her
"^DD",142,142,.06,21,14,0)
choice.
"^DD",142,142,.06,"DT")
2990422
"^DD",142,142,.07,0)
RESTRICT DELETION^SI^Y:YES;^0;4^Q
"^DD",142,142,.07,21,0)
^^3^3^2920914^
"^DD",142,142,.07,21,1,0)
This field is referred to by the Create/Modify and Delete Health Summary
"^DD",142,142,.07,21,2,0)
Type options for the screening of certain summary types (esp., GMTS HS
"^DD",142,142,.07,21,3,0)
ADHOC OPTION) from deletion.
"^DD",142,142,.07,"DT")
2901227
"^DD",142,142,.08,0)
SUPPRESS COMP WITHOUT DATA^S^Y:yes;N:no;^0;5^Q
"^DD",142,142,.08,.1)
SUPPRESS PRINT OF COMPONENTS WITHOUT DATA
"^DD",142,142,.08,21,0)
^^6^6^2950731^^
"^DD",142,142,.08,21,1,0)
This field allows health summary types to be set up to suppress printing
"^DD",142,142,.08,21,2,0)
of components that contain no data when health summaries are printed from
"^DD",142,142,.08,21,3,0)
a device. When health summary types are displayed on the screen,
"^DD",142,142,.08,21,4,0)
components that contain no data will still be displayed with a "No data
"^DD",142,142,.08,21,5,0)
available" message. This is done to eliminate any confusion that may occur
"^DD",142,142,.08,21,6,0)
when jumping between components.
"^DD",142,142,.08,"DT")
2950815
"^DD",142,142,.09,0)
NATIONALLY EXPORTED TYPE^S^1:Nationally Exported, Site Editable;2:Nationally Exported, Uneditable;^VA;1^Q
"^DD",142,142,.09,21,0)
^^3^3^3000224^^
"^DD",142,142,.09,21,1,0)
This field is used to distinguish between nationally exported Health Summary 
"^DD",142,142,.09,21,2,0)
Types and Health Summary Types created at the site.  It serves to protect 
"^DD",142,142,.09,21,3,0)
nationally exported Health Summary Types from being deleted at the site.
"^DD",142,142,.09,"DT")
3000224
"^DD",142,142,1,0)
STRUCTURE^142.01IA^^1;0
"^DD",142,142,1,21,0)
^^4^4^3000329^^^^
"^DD",142,142,1,21,1,0)
This multiple contains the components to be included in any given health
"^DD",142,142,1,21,2,0)
summary type, along with the time and occurrence limits, selection items
"^DD",142,142,1,21,3,0)
to be used, hospital location displayed, ICD text displayed, and provider
"^DD",142,142,1,21,4,0)
narrative displayed.
"^DD",142,142,20,0)
LOCATION(S) USING THE SUMMARY^142.2P^^20;0
"^DD",142,142,20,21,0)
^^3^3^2950731^^^^
"^DD",142,142,20,21,1,0)
Allows the entry of the hospital location (ward or clinic) which has
"^DD",142,142,20,21,2,0)
requested automatic nightly queueing of one or more health summary
"^DD",142,142,20,21,3,0)
types to a specified device.
"^DD",142,142,99,0)
TIMESTAMP^F^^99;1^K:$L(X)>15!($L(X)<1) X
"^DD",142,142,99,1,0)
^.1
"^DD",142,142,99,1,1,0)
142^AM^MUMPS
"^DD",142,142,99,1,1,1)
D SET^GMTSDD
"^DD",142,142,99,1,1,2)
D KILL^GMTSDD
"^DD",142,142,99,1,1,"%D",0)
^^5^5^2950731^
"^DD",142,142,99,1,1,"%D",1,0)
This MUMPS type cross-reference is used to maintain the navigational menus
"^DD",142,142,99,1,1,"%D",2,0)
when changes occur in the structure of a given Health Summary Type. The
"^DD",142,142,99,1,1,"%D",3,0)
executed code will rebuild navigational menus when the TIMESTAMP field is
"^DD",142,142,99,1,1,"%D",4,0)
modified. The ^XUTL("XQORM", global is used by the Unwinder utility to
"^DD",142,142,99,1,1,"%D",5,0)
generate the ad hoc and navigational menus.
"^DD",142,142,99,3)
Answer must be 1-15 characters in length.
"^DD",142,142,99,9)
^
"^DD",142,142,99,21,0)
^^6^6^2950731^
"^DD",142,142,99,21,1,0)
This is the $H formatted time associated with the most recent modification
"^DD",142,142,99,21,2,0)
to this health summary type. It is compared with the timestamp in the
"^DD",142,142,99,21,3,0)
^XUTL( multiple associated with this summary type, when ^XQORM is called
"^DD",142,142,99,21,4,0)
to generate help menus for interactive navigation. If a difference exists,
"^DD",142,142,99,21,5,0)
then the menus are "recompiled." This field is NOT to be edited
"^DD",142,142,99,21,6,0)
interactively under any circumstances!
"^DD",142,142,99,"DT")
2900111
"^DD",142,142.01,0)
STRUCTURE SUB-FIELD^^9^10
"^DD",142,142.01,0,"DT")
3000726
"^DD",142,142.01,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^GMT(142.1,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(142.1,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",142,142.01,0,"IX","AM",142.01,.01)

"^DD",142,142.01,0,"IX","AM1",142.01,1)

"^DD",142,142.01,0,"IX","AM5",142.01,5)

"^DD",142,142.01,0,"IX","B",142.01,.01)

"^DD",142,142.01,0,"IX","C",142.01,1)

"^DD",142,142.01,0,"NM","STRUCTURE")

"^DD",142,142.01,0,"UP")
142
"^DD",142,142.01,.01,0)
SUMMARY ORDER^MRNJ8,3XO^^0;1^K:+X'=X!(X>9999.999)!(X<.001)!(X'?1.4N.E) X S:$D(X) DINUM=X
"^DD",142,142.01,.01,1,0)
^.1
"^DD",142,142.01,.01,1,1,0)
142.01^B
"^DD",142,142.01,.01,1,1,1)
S ^GMT(142,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",142,142.01,.01,1,1,2)
K ^GMT(142,DA(1),1,"B",$E(X,1,30),DA)
"^DD",142,142.01,.01,1,1,"%D",0)
^^3^3^2920302^^
"^DD",142,142.01,.01,1,1,"%D",1,0)
This REGULAR "B" cross-reference is created by FileMan and because the
"^DD",142,142.01,.01,1,1,"%D",2,0)
multiple is DINUM'ed by SUMMARY ORDER, it serves little useful function
"^DD",142,142.01,.01,1,1,"%D",3,0)
in either look-up or sorting.
"^DD",142,142.01,.01,1,2,0)
142.01^AM^MUMPS
"^DD",142,142.01,.01,1,2,1)
D REDOX^GMTSDD
"^DD",142,142.01,.01,1,2,2)
D REDOX^GMTSDD
"^DD",142,142.01,.01,1,2,"%D",0)
^^4^4^2950731^^^^
"^DD",142,142.01,.01,1,2,"%D",1,0)
This MUMPS-type cross-reference is used to rebuild the ad hoc and
"^DD",142,142.01,.01,1,2,"%D",2,0)
navigational menus when the sequence of components within any Health
"^DD",142,142.01,.01,1,2,"%D",3,0)
Summary Type is changed. The ^XUTL("XQORM", global is used by the Unwinder
"^DD",142,142.01,.01,1,2,"%D",4,0)
utility to generate the ad hoc and navigational menus.
"^DD",142,142.01,.01,2)
S Y(0)=Y S Y=Y
"^DD",142,142.01,.01,2.1)
S Y=Y
"^DD",142,142.01,.01,3)
Type a Number between .001 and 9999.999
"^DD",142,142.01,.01,21,0)
^^4^4^2950821^^^^
"^DD",142,142.01,.01,21,1,0)
This is the sequence in which each successive component is to appear
"^DD",142,142.01,.01,21,2,0)
within the health summary.  By default, it will be an integer number,
"^DD",142,142.01,.01,21,3,0)
beginning with five, and incremented by five, so as to allow insertion
"^DD",142,142.01,.01,21,4,0)
of new components as necessary.
"^DD",142,142.01,.01,"DT")
2900418
"^DD",142,142.01,1,0)
COMPONENT NAME^RP142.1'^GMT(142.1,^0;2^Q
"^DD",142,142.01,1,1,0)
^.1
"^DD",142,142.01,1,1,1,0)
142.01^C
"^DD",142,142.01,1,1,1,1)
S ^GMT(142,DA(1),1,"C",$E(X,1,30),DA)=""
"^DD",142,142.01,1,1,1,2)
K ^GMT(142,DA(1),1,"C",$E(X,1,30),DA)
"^DD",142,142.01,1,1,1,"%D",0)
^^4^4^2920714^^^
"^DD",142,142.01,1,1,1,"%D",1,0)
This REGULAR FileMan type cross-reference is used both in look-ups of
"^DD",142,142.01,1,1,1,"%D",2,0)
components and to determine whether the selected component already
"^DD",142,142.01,1,1,1,"%D",3,0)
exists in the current Health Summary Type during the Create/Modify
"^DD",142,142.01,1,1,1,"%D",4,0)
process.
"^DD",142,142.01,1,1,2,0)
142.01^AM1^MUMPS
"^DD",142,142.01,1,1,2,1)
D REDOX^GMTSDD
"^DD",142,142.01,1,1,2,2)
D REDOX^GMTSDD
"^DD",142,142.01,1,1,2,"%D",0)
^^4^4^2950731^
"^DD",142,142.01,1,1,2,"%D",1,0)
This MUMPS type cross-reference is used to recompile the navigational and
"^DD",142,142.01,1,1,2,"%D",2,0)
ad hoc menus when components are added to/deleted from a given Health
"^DD",142,142.01,1,1,2,"%D",3,0)
Summary Type. The ^XUTL("XQORM", global is used by the Unwinder utility to
"^DD",142,142.01,1,1,2,"%D",4,0)
generate the ad hoc and navigational menus.
"^DD",142,142.01,1,1,3,0)
142^AE
"^DD",142,142.01,1,1,3,1)
S ^GMT(142,"AE",$E(X,1,30),DA(1),DA)=""
"^DD",142,142.01,1,1,3,2)
K ^GMT(142,"AE",$E(X,1,30),DA(1),DA)
"^DD",142,142.01,1,1,3,"%D",0)
^^4^4^2920302^^
"^DD",142,142.01,1,1,3,"%D",1,0)
This cross-reference is used by the routine ^GMTSDD to build the navigational
"^DD",142,142.01,1,1,3,"%D",2,0)
menu for each Health Summary Type, and by ^GMTSLOAD when saving the current
"^DD",142,142.01,1,1,3,"%D",3,0)
default parameters, prior to deleting and rebuilding the Ad Hoc Health
"^DD",142,142.01,1,1,3,"%D",4,0)
Summary Type.
"^DD",142,142.01,1,3)
Enter the name of the segment (e.g., DEMOGRAPHICS)
"^DD",142,142.01,1,21,0)
^^3^3^2950829^^^
"^DD",142,142.01,1,21,1,0)
This is the name of the next health summary component to be included in
"^DD",142,142.01,1,21,2,0)
the report (e.g., SURGERY REPORTS, or CHEMISTRY & HEMATOLOGY).  Valid
"^DD",142,142.01,1,21,3,0)
abbreviations (e.g., SR or CH) or partial names may also be entered.
"^DD",142,142.01,1,"DT")
2900329
"^DD",142,142.01,2,0)
OCCURRENCE LIMIT^NJ5,0^^0;3^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
"^DD",142,142.01,2,3)
Enter occurrence limit of information to display.  Omit if no limit.  Occurrence limit displays are based on most recent information first. 
"^DD",142,142.01,2,21,0)
^^6^6^2940418^^
"^DD",142,142.01,2,21,1,0)
This is an integer number describing the number of occurrences (e.g., lab
"^DD",142,142.01,2,21,2,0)
orders, surgeries, radiology procedures, etc.) to be reported by the
"^DD",142,142.01,2,21,3,0)
component.  For example, if 5 is entered the component will only present
"^DD",142,142.01,2,21,4,0)
the five most recent occurrences.  If no limit is entered, the component
"^DD",142,142.01,2,21,5,0)
will report as many occurrences as may be found within the specified
"^DD",142,142.01,2,21,6,0)
time interval.
"^DD",142,142.01,3,0)
TIME LIMIT^FX^^0;4^S X=$$UP^XLFSTR(X) K:$L(X)>5!($L(X)<1)!'((X?1N.N1U)!(X?1N.N1"D")!(X?1N.N1"W")!(X?1N.N1"M")!(X?1N.N1"Y")) X
"^DD",142,142.01,3,3)
Enter time limit to display (e.g., 20D, 8W, 3M, 5Y).  Omit if no limit. Time limit displays are based on most recent information first.
"^DD",142,142.01,3,21,0)
^^8^8^2940914^
"^DD",142,142.01,3,21,1,0)
This is a code describing how far back the component should search for a
"^DD",142,142.01,3,21,2,0)
given patient's data.  It will be a number, followed by the letter D for
"^DD",142,142.01,3,21,3,0)
days, W for weeks, M for months or Y for years (e.g., 30D would denote the
"^DD",142,142.01,3,21,4,0)
past 30 days' patient data should be included in the component).  If no
"^DD",142,142.01,3,21,5,0)
limit is indicated, the component assumes an indefinite time interval.
"^DD",142,142.01,3,21,6,0)
Exceptions are the Outpatient, Unit Dose and Intravenous Pharmacy
"^DD",142,142.01,3,21,7,0)
components, which will show active orders only when no time limit is
"^DD",142,142.01,3,21,8,0)
entered.
"^DD",142,142.01,3,"DT")
2950823
"^DD",142,142.01,4,0)
SELECTION ITEM^142.14VA^^1;0
"^DD",142,142.01,4,21,0)
^^7^7^2960910^^^^
"^DD",142,142.01,4,21,1,0)
If the component allows selection of specific items, they will be selected
"^DD",142,142.01,4,21,2,0)
here.  Component examples are Lab Tests Selected, Lab Cumulatives
"^DD",142,142.01,4,21,3,0)
Selected, Radiology Impressions Selected, and Vital Signs Selected.
"^DD",142,142.01,4,21,4,0)
 
"^DD",142,142.01,4,21,5,0)
You will be asked to enter selection items such as Lab Tests, Radiology
"^DD",142,142.01,4,21,6,0)
Procedures, Vital Sign Types, Measurement Panel, Clinical
"^DD",142,142.01,4,21,7,0)
Reminder/Maintenance, Health Factor, depending on the component.
"^DD",142,142.01,4,21,8,0)
Factor, depending on the component.
"^DD",142,142.01,4,22)

"^DD",142,142.01,5,0)
HEADER NAME^F^^0;5^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<2) X
"^DD",142,142.01,5,1,0)
^.1
"^DD",142,142.01,5,1,1,0)
142.01^AM5^MUMPS
"^DD",142,142.01,5,1,1,1)
D REDOX^GMTSDD
"^DD",142,142.01,5,1,1,2)
D REDOX^GMTSDD
"^DD",142,142.01,5,1,1,"%D",0)
^^3^3^2950731^
"^DD",142,142.01,5,1,1,"%D",1,0)
This MUMPS type cross reference will recompile the AD HOC menu when an
"^DD",142,142.01,5,1,1,"%D",2,0)
entry is modified. The ^XUTL("XQORM", global is used by the Unwinder
"^DD",142,142.01,5,1,1,"%D",3,0)
utility to generate the ad hoc menu.
"^DD",142,142.01,5,1,1,"DT")
2911212
"^DD",142,142.01,5,3)
Answer must be 2-20 characters in length.
"^DD",142,142.01,5,21,0)
^^4^4^2911127^^^^
"^DD",142,142.01,5,21,1,0)
This is the name that will appear in both menus and headers within this
"^DD",142,142.01,5,21,2,0)
Health Summary type.  (e.g., if you are setting up the LAB SELECTED
"^DD",142,142.01,5,21,3,0)
CUMULATIVE component, and would like it to include the tests from a Chem 7,
"^DD",142,142.01,5,21,4,0)
you might enter Chem 7).
"^DD",142,142.01,5,"DT")
2911212
"^DD",142,142.01,6,0)
HOSPITAL LOCATION DISPLAYED^S^Y:yes;N:no;^0;6^Q
"^DD",142,142.01,6,3)
Enter Yes if Hospital Location abbreviation should appear in this component.
"^DD",142,142.01,6,21,0)
^^4^4^2950728^^^
"^DD",142,142.01,6,21,1,0)
This field controls whether or not the hospital location abbreviation will
"^DD",142,142.01,6,21,2,0)
be displayed in any components where hospital location applies (e.g., PCE
"^DD",142,142.01,6,21,3,0)
Outpatient Encounters, PCE Outpatient Diagnosis). The text displayed is
"^DD",142,142.01,6,21,4,0)
obtained from the Hospital Location file.
"^DD",142,142.01,6,"DT")
2940418
"^DD",142,142.01,7,0)
ICD TEXT DISPLAYED^S^L:long text;S:short text;C:code only;T:text only;N:none;^0;7^Q
"^DD",142,142.01,7,3)
Indicate whether the long form, short form, code only, text only, or no form of ICD diagnosis text should appear in applicable components.
"^DD",142,142.01,7,21,0)
^^7^7^2950728^
"^DD",142,142.01,7,21,1,0)
This field controls hows ICD text is displayed in components where ICD
"^DD",142,142.01,7,21,2,0)
Text applies (e.g., PCE Outpatient Encounters, PCE Outpatient Diagnosis
"^DD",142,142.01,7,21,3,0)
and Problem List All). The applicable component display/print can be
"^DD",142,142.01,7,21,4,0)
customized to include ICD Text in the following format: code and long
"^DD",142,142.01,7,21,5,0)
description, code and short description, code only, long description only
"^DD",142,142.01,7,21,6,0)
or nothing. This control is independent of whether provider narrative is
"^DD",142,142.01,7,21,7,0)
displayed -- either or both may be specified.
"^DD",142,142.01,7,"DT")
2950119
"^DD",142,142.01,8,0)
PROVIDER NARRATIVE DISPLAYED^S^Y:yes;N:no;^0;8^Q
"^DD",142,142.01,8,3)
Enter 'N' to eliminate the provider narrative from component display.
"^DD",142,142.01,8,21,0)
^^6^6^3000329^^
"^DD",142,142.01,8,21,1,0)
This field controls whether provider narrative is displayed or not. It
"^DD",142,142.01,8,21,2,0)
applies to components where provider narrative is applicable (e.g., PCE
"^DD",142,142.01,8,21,3,0)
Outpatient Encounters, PCE Outpatient Diagnosis, Problem List All). This
"^DD",142,142.01,8,21,4,0)
control is independent of whether or not ICD text is displayed -- either
"^DD",142,142.01,8,21,5,0)
or both may be specified. If not specified, provider narrative will be
"^DD",142,142.01,8,21,6,0)
displayed by default.
"^DD",142,142.01,8,"DT")
2940419
"^DD",142,142.01,9,0)
CPT MODIFIERS DISPLAYED^S^Y:YES;N:NO;^0;9^Q
"^DD",142,142.01,9,3)
Enter 'N' to eliminate the CPT Modifiers from component display. 
"^DD",142,142.01,9,21,0)
^^4^4^3000329^
"^DD",142,142.01,9,21,1,0)
This field controls whether CPT Modifiers are displayed or not. It applies to 
"^DD",142,142.01,9,21,2,0)
components where CPT Modifiers are applicable (e.g. surgical components) This 
"^DD",142,142.01,9,21,3,0)
control is independent of whether or not CPT text is displayed.  If not 
"^DD",142,142.01,9,21,4,0)
specified, CPT Modifiers will be displayed by default.
"^DD",142,142.01,9,"DT")
3000329
"^DD",142,142.14,0)
SELECTION ITEM SUB-FIELD^^.01^1
"^DD",142,142.14,0,"DT")
3000726
"^DD",142,142.14,0,"IX","B",142.14,.01)

"^DD",142,142.14,0,"NM","SELECTION ITEM")

"^DD",142,142.14,0,"UP")
142.01
"^DD",142,142.14,.01,0)
SELECTION ITEM^MVM^^0;1^Q
"^DD",142,142.14,.01,1,0)
^.1
"^DD",142,142.14,.01,1,1,0)
142.14^B
"^DD",142,142.14,.01,1,1,1)
S ^GMT(142,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",142,142.14,.01,1,1,2)
K ^GMT(142,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",142,142.14,.01,1,1,3)
Required Index for Variable Pointer
"^DD",142,142.14,.01,1,1,"%D",0)
^^2^2^2920302^
"^DD",142,142.14,.01,1,1,"%D",1,0)
This REGULAR FileMan type cross-reference is used in look-ups of selection
"^DD",142,142.14,.01,1,1,"%D",2,0)
items during the Create/Modify and parameter collection dialogues.
"^DD",142,142.14,.01,3)
Selection items can only be selected when appropriate for the component.
"^DD",142,142.14,.01,21,0)
^^7^7^3000726^^^^
"^DD",142,142.14,.01,21,1,0)
When a given component allows the selection of specific items, (e.g., lab
"^DD",142,142.14,.01,21,2,0)
tests, radiology procedures, vital measurements, measurement panels,
"^DD",142,142.14,.01,21,3,0)
clinical reminders/maintenance items, health factors, etc.), you may
"^DD",142,142.14,.01,21,4,0)
select the item by simply entering its name (e.g., POTASSIUM, or PULSE, as
"^DD",142,142.14,.01,21,5,0)
appropriate). If a limit has been specified for the number of items to be
"^DD",142,142.14,.01,21,6,0)
selected, then the build health summary option will restrict you to that
"^DD",142,142.14,.01,21,7,0)
number.
"^DD",142,142.14,.01,"DT")
3000726
"^DD",142,142.14,.01,"V",0)
^.12P^7^7
"^DD",142,142.14,.01,"V",1,0)
60^LABORATORY TEST^1^L^y^n
"^DD",142,142.14,.01,"V",1,1)
S DIC("S")="I ($P(^(0),U,4)=""CH""),(""BO""[$P(^(0),U,3))"
"^DD",142,142.14,.01,"V",1,2)
Only Chemistry & Hematology tests may be selected.
"^DD",142,142.14,.01,"V",2,0)
120.51^VITAL TYPE^2^V^n^n
"^DD",142,142.14,.01,"V",3,0)
71^RADIOLOGY TEST^3^R^n^n
"^DD",142,142.14,.01,"V",4,0)
811.9^CLINICAL REMINDER/MAINTENANCE^5^C^y^n
"^DD",142,142.14,.01,"V",4,1)
S DIC("S")="I +$P(^(0),U,6)'=1"
"^DD",142,142.14,.01,"V",4,2)
Allow selection of items that aren't inactive.
"^DD",142,142.14,.01,"V",5,0)
9999999.64^HEALTH FACTOR^6^F^y^n
"^DD",142,142.14,.01,"V",5,1)
S DIC("S")="I $P(^(0),U,10)=""C"",+$P(^(0),U,11)'=1"
"^DD",142,142.14,.01,"V",5,2)
Forces selection of health factor categories rather than individual health factors and forces selection of health factor categories that aren't inactive.
"^DD",142,142.14,.01,"V",6,0)
8925.1^PROGRESS NOTE TITLE^8^PN^y^n
"^DD",142,142.14,.01,"V",6,1)
S DIC("S")="I $P(^TIU(8925.1,+Y,0),U,4)=""DOC"",+$$ISA^TIULX(+Y,3)"
"^DD",142,142.14,.01,"V",6,2)
Only a PROGRESS NOTE TITLE may be selected.
"^DD",142,142.14,.01,"V",7,0)
81^CPT^7^CPT^n^n
"^DD",142,142.2,0)
LOCATION(S) USING THE SUMMARY SUB-FIELD^^.04^4
"^DD",142,142.2,0,"DT")
2920210
"^DD",142,142.2,0,"IX","B",142.2,.01)

"^DD",142,142.2,0,"NM","LOCATION(S) USING THE SUMMARY")

"^DD",142,142.2,0,"UP")
142
"^DD",142,142.2,.01,0)
LOCATION(S) USING THE SUMMARY^MP44'^SC(^0;1^Q
"^DD",142,142.2,.01,1,0)
^.1
"^DD",142,142.2,.01,1,1,0)
142.2^B
"^DD",142,142.2,.01,1,1,1)
S ^GMT(142,DA(1),20,"B",$E(X,1,30),DA)=""
"^DD",142,142.2,.01,1,1,2)
K ^GMT(142,DA(1),20,"B",$E(X,1,30),DA)
"^DD",142,142.2,.01,1,1,"%D",0)
^^2^2^2920302^
"^DD",142,142.2,.01,1,1,"%D",1,0)
This REGULAR FileMan type cross-reference is used for look-ups of locations
"^DD",142,142.2,.01,1,1,"%D",2,0)
for which Health Summaries are scheduled.
"^DD",142,142.2,.01,1,2,0)
142^D
"^DD",142,142.2,.01,1,2,1)
S ^GMT(142,"D",$E(X,1,30),DA(1),DA)=""
"^DD",142,142.2,.01,1,2,2)
K ^GMT(142,"D",$E(X,1,30),DA(1),DA)
"^DD",142,142.2,.01,1,2,"%D",0)
^^2^2^2920302^^^^
"^DD",142,142.2,.01,1,2,"%D",1,0)
This whole-file, REGULAR FileMan cross-reference is used for look-ups
"^DD",142,142.2,.01,1,2,"%D",2,0)
of the Health Summary types which are queued for each location.
"^DD",142,142.2,.01,1,3,0)
142^AW3^MUMPS
"^DD",142,142.2,.01,1,3,1)
D STL^GMTSUIX
"^DD",142,142.2,.01,1,3,2)
D KTL^GMTSUIX
"^DD",142,142.2,.01,1,3,"DT")
2981214
"^DD",142,142.2,.01,21,0)
^^3^3^2920214^^
"^DD",142,142.2,.01,21,1,0)
Enter the name of the hospital location (ward or clinic) which is to have
"^DD",142,142.2,.01,21,2,0)
this health summary type generated on a nightly basis to the device
"^DD",142,142.2,.01,21,3,0)
specified below.
"^DD",142,142.2,.01,"DT")
2981214
"^DD",142,142.2,.02,0)
DEVICE FOR NIGHTLY PRINT^P3.5'^%ZIS(1,^0;2^Q
"^DD",142,142.2,.02,3)
Specify the printer nearest LOCATION.
"^DD",142,142.2,.02,21,0)
^^3^3^2950731^^
"^DD",142,142.2,.02,21,1,0)
Enter the name of the device on which the summaries for this location
"^DD",142,142.2,.02,21,2,0)
are to be queued to run each night. Preferably the printer nearest to
"^DD",142,142.2,.02,21,3,0)
the specified location.
"^DD",142,142.2,.02,"DT")
2900904
"^DD",142,142.2,.03,0)
PRINT ACTION PROFILE^S^Y:yes;N:no;^0;3^Q
"^DD",142,142.2,.03,3)
Enter 'Y'es to queue the OUTPATIENT Action Profile with Health Summary
"^DD",142,142.2,.03,21,0)
^^3^3^2920210^
"^DD",142,142.2,.03,21,1,0)
This flag will cause the scheduled option GMTS TASK STARTUP to queue the
"^DD",142,142.2,.03,21,2,0)
OUTPATIENT PHARMACY Action Profile "in tandem" with the Health Summary
"^DD",142,142.2,.03,21,3,0)
for any location where the Health Summary may be queued to print.
"^DD",142,142.2,.03,"DT")
2920210
"^DD",142,142.2,.04,0)
PRINT DAYS AHEAD^NJ2,0^^0;4^K:+X'=X!(X>10)!(X<0)!(X?.E1"."1N.N) X
"^DD",142,142.2,.04,3)
0 means available early morning on day of clinic, 1 means available early morning one day before clinic,etc
"^DD",142,142.2,.04,21,0)
^^5^5^2901017^
"^DD",142,142.2,.04,21,1,0)
Determines the number of days prior to scheduled appointments you wish
"^DD",142,142.2,.04,21,2,0)
to have health summaries printed for a given clinic.  That is, if you
"^DD",142,142.2,.04,21,3,0)
wish to have summaries printed on the night before the patients are
"^DD",142,142.2,.04,21,4,0)
scheduled for clinic, enter 0.  If you wish them to be printed two days
"^DD",142,142.2,.04,21,5,0)
in advance of scheduled visits enter 2, etc.
"^DD",142,142.2,.04,"DT")
2900904
"^DD",142.1,142.1,0)
FIELD^^14^18
"^DD",142.1,142.1,0,"DDA")
N
"^DD",142.1,142.1,0,"DT")
3000329
"^DD",142.1,142.1,0,"IX","AM",142.1,5)

"^DD",142.1,142.1,0,"IX","AM1",142.1,.01)

"^DD",142.1,142.1,0,"IX","AM2",142.1,3)

"^DD",142.1,142.1,0,"IX","AM9",142.1,9)

"^DD",142.1,142.1,0,"IX","B",142.1,.01)

"^DD",142.1,142.1,0,"IX","C",142.1,3)

"^DD",142.1,142.1,0,"IX","D",142.1,9)

"^DD",142.1,142.1,0,"NM","HEALTH SUMMARY COMPONENT")

"^DD",142.1,142.1,0,"PT",142.01,1)

"^DD",142.1,142.1,0,"PT",394.71,.04)

"^DD",142.1,142.1,0,"VRPK")
GMTS
"^DD",142.1,142.1,.001,0)
NUMBER^NJ10,0X^^ ^K:+X'=X!(X>9999999999)!(X<0)!(X?.E1"."1N.N) X I $D(X) D CHKNUM^GMTSDD
"^DD",142.1,142.1,.001,3)
Enter your station number, followed by 001 to 999.
"^DD",142.1,142.1,.001,21,0)
^^4^4^2920914^^^^
"^DD",142.1,142.1,.001,21,1,0)
This is the internal record number of the component record.  If you are
"^DD",142.1,142.1,.001,21,2,0)
creating a new component, then this should be a sequential number,
"^DD",142.1,142.1,.001,21,3,0)
preceded by your station number (e.g., station number 660 should number
"^DD",142.1,142.1,.001,21,4,0)
custom-built components from 660001-660999, etc.).
"^DD",142.1,142.1,.001,"DT")
2920914
"^DD",142.1,142.1,.01,0)
NAME^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X D:$D(X) CHKNAME^GMTSDD
"^DD",142.1,142.1,.01,1,0)
^.1
"^DD",142.1,142.1,.01,1,1,0)
142.1^B
"^DD",142.1,142.1,.01,1,1,1)
S ^GMT(142.1,"B",$E(X,1,30),DA)=""
"^DD",142.1,142.1,.01,1,1,2)
K ^GMT(142.1,"B",$E(X,1,30),DA)
"^DD",142.1,142.1,.01,1,1,"%D",0)
^^2^2^2920302^
"^DD",142.1,142.1,.01,1,1,"%D",1,0)
This whole-file, REGULAR FileMan cross-reference is used for look-ups of
"^DD",142.1,142.1,.01,1,1,"%D",2,0)
components by NAME.
"^DD",142.1,142.1,.01,1,2,0)
142.1^AM1^MUMPS
"^DD",142.1,142.1,.01,1,2,1)
D REDO^GMTSDD
"^DD",142.1,142.1,.01,1,2,2)
D REDO^GMTSDD
"^DD",142.1,142.1,.01,1,2,"%D",0)
^^4^4^2950731^
"^DD",142.1,142.1,.01,1,2,"%D",1,0)
This MUMPS type cross-reference is used to rebuild the ad hoc and
"^DD",142.1,142.1,.01,1,2,"%D",2,0)
navigational menus when the NAME of a given component is modified. The
"^DD",142.1,142.1,.01,1,2,"%D",3,0)
^XUTL("XQORM", global is used by the Unwinder utility to generate the ad
"^DD",142.1,142.1,.01,1,2,"%D",4,0)
hoc and navigational menus.
"^DD",142.1,142.1,.01,3)
Answer must be 3-30 characters in length.
"^DD",142.1,142.1,.01,21,0)
^^3^3^2920109^^^^
"^DD",142.1,142.1,.01,21,1,0)
This is the name of the health summary component, which both uniquely
"^DD",142.1,142.1,.01,21,2,0)
identifies the component's record for look-ups, sorts, etc. and is also
"^DD",142.1,142.1,.01,21,3,0)
displayed in the component header, when the health summary is run.
"^DD",142.1,142.1,.01,"DEL",1,0)
I $S(+$G(DUZ(2))'>0:1,DUZ(2)=5000:0,(DA'<(DUZ(2)_"001")&(DA'>(DUZ(2)_"999"))):0,1:1) W !,$S(+$G(DUZ(2)):"ONLY Components Created at your site can be deleted",1:"DUZ(2) MUST equal your STATION NUMBER")
"^DD",142.1,142.1,.01,"DEL",2,0)
I '$D(GMCMP) W $C(7),!!,"You may only delete COMPONENTS using the GMTS IRM COMP ENTER/EDIT OPTION.",!
"^DD",142.1,142.1,.01,"DT")
2911212
"^DD",142.1,142.1,1,0)
PRINT ROUTINE^RFX^^0;2^K:$L(X)>17!($L(X)<3)!'(X?1U1.7UN1";"1U1.7UN) X I $D(X) D CHKRTN^GMTSDD
"^DD",142.1,142.1,1,3)
Component Print Routine in form LINETAG;ROUTINENAME (e.g., MAIN;GMTSLRC)
"^DD",142.1,142.1,1,8.5)
@
"^DD",142.1,142.1,1,9)
@
"^DD",142.1,142.1,1,21,0)
3^^3^3^2990428^^
"^DD",142.1,142.1,1,21,1,0)
This is the entry point and routine to be called when the component is
"^DD",142.1,142.1,1,21,2,0)
run for a given health summary type.  Enter the line label, followed by
"^DD",142.1,142.1,1,21,3,0)
a semi-colon, followed by the routine name (e.g., MAIN;GMTSLRC).
"^DD",142.1,142.1,1,"DT")
2920109
"^DD",142.1,142.1,1.1,0)
EXTERNAL/EXTRACT ROUTINE^142.11^^.1;0
"^DD",142.1,142.1,1.1,21,0)
^^1^1^2990616^^^^
"^DD",142.1,142.1,1.1,21,1,0)
Source of Health Summary Component data.
"^DD",142.1,142.1,2,0)
TIME LIMITS APPLICABLE^S^Y:yes;^0;3^Q
"^DD",142.1,142.1,2,3)
Enter YES if time limits apply to this component.
"^DD",142.1,142.1,2,21,0)
^^3^3^2950728^^^^
"^DD",142.1,142.1,2,21,1,0)
This field is set up by the programmer to indicate whether the routine to
"^DD",142.1,142.1,2,21,2,0)
print this component will allow a time range to be applied to the data
"^DD",142.1,142.1,2,21,3,0)
to be displayed in the Health Summary.
"^DD",142.1,142.1,2,"DT")
2920109
"^DD",142.1,142.1,3,0)
ABBREVIATION^F^^0;4^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>4!($L(X)<2)!'(X?2.4UN) X
"^DD",142.1,142.1,3,1,0)
^.1
"^DD",142.1,142.1,3,1,1,0)
142.1^C
"^DD",142.1,142.1,3,1,1,1)
S ^GMT(142.1,"C",$E(X,1,30),DA)=""
"^DD",142.1,142.1,3,1,1,2)
K ^GMT(142.1,"C",$E(X,1,30),DA)
"^DD",142.1,142.1,3,1,1,"%D",0)
^^2^2^2920302^
"^DD",142.1,142.1,3,1,1,"%D",1,0)
This whole-file, REGULAR FileMan cross-reference is used in look-ups of
"^DD",142.1,142.1,3,1,1,"%D",2,0)
components by ABBREVIATION.
"^DD",142.1,142.1,3,1,2,0)
142.1^AM2^MUMPS
"^DD",142.1,142.1,3,1,2,1)
D REDO^GMTSDD
"^DD",142.1,142.1,3,1,2,2)
D REDO^GMTSDD
"^DD",142.1,142.1,3,1,2,"%D",0)
^^4^4^2950731^^
"^DD",142.1,142.1,3,1,2,"%D",1,0)
This MUMPS type cross-reference is used to rebuild the ad hoc and
"^DD",142.1,142.1,3,1,2,"%D",2,0)
navigational menus when the ABBREVIATION of a given component is modified.
"^DD",142.1,142.1,3,1,2,"%D",3,0)
The ^XUTL("XQORM", global is used by the Unwinder utility to generate the
"^DD",142.1,142.1,3,1,2,"%D",4,0)
ad hoc and navigational menus.
"^DD",142.1,142.1,3,3)
Answer must be 2-4 characters in length.
"^DD",142.1,142.1,3,21,0)
^^4^4^2950731^^^^
"^DD",142.1,142.1,3,21,1,0)
This 2-4 character abbreviation should uniquely identify the component,
"^DD",142.1,142.1,3,21,2,0)
since it is used both for lookup in the build health summary and ad hoc
"^DD",142.1,142.1,3,21,3,0)
health summary options, and for navigation between components when the
"^DD",142.1,142.1,3,21,4,0)
health summary is run interactively.
"^DD",142.1,142.1,3,"DT")
2920110
"^DD",142.1,142.1,3.5,0)
DESCRIPTION^142.35^^3.5;0
"^DD",142.1,142.1,4,0)
MAXIMUM OCCURRENCES APPLICABLE^S^Y:yes;^0;5^Q
"^DD",142.1,142.1,4,3)
Enter YES if maximum occurrence limits apply to this component.
"^DD",142.1,142.1,4,21,0)
^^3^3^2950728^^^^
"^DD",142.1,142.1,4,21,1,0)
This field is used by the programmer to indicate whether the routine which
"^DD",142.1,142.1,4,21,2,0)
prints this component is set up to handle maximum occurrence limits
"^DD",142.1,142.1,4,21,3,0)
on the Health Summary.
"^DD",142.1,142.1,4,"DT")
2920109
"^DD",142.1,142.1,5,0)
DISABLE FLAG^S^T:temporary;P:permanent;^0;6^Q
"^DD",142.1,142.1,5,1,0)
^.1
"^DD",142.1,142.1,5,1,1,0)
142.1^AM^MUMPS
"^DD",142.1,142.1,5,1,1,1)
D REDO^GMTSDD
"^DD",142.1,142.1,5,1,1,2)
D REDO^GMTSDD
"^DD",142.1,142.1,5,1,1,"%D",0)
^^4^4^2950731^
"^DD",142.1,142.1,5,1,1,"%D",1,0)
This MUMPS type cross-reference is used to rebuild the ad hoc and
"^DD",142.1,142.1,5,1,1,"%D",2,0)
navigational menus when a given component is DISABLED. The ^XUTL("XQORM",
"^DD",142.1,142.1,5,1,1,"%D",3,0)
global is used by the Unwinder utility to generate the ad hoc and
"^DD",142.1,142.1,5,1,1,"%D",4,0)
navigational menus.
"^DD",142.1,142.1,5,21,0)
^^10^10^2951017^^^^
"^DD",142.1,142.1,5,21,1,0)
IRM Staff or Clin Coordinator:  Use this field to disable (inactivate)
"^DD",142.1,142.1,5,21,2,0)
a health summary component (e.g., Lab Orders).  Setting this DISABLE
"^DD",142.1,142.1,5,21,3,0)
FLAG field to P(ermanent) causes a component to be non-selectable for use,
"^DD",142.1,142.1,5,21,4,0)
and prevents the component from being printed in any Health Summary
"^DD",142.1,142.1,5,21,5,0)
in which it is included.  Setting DISABLE FLAG to T(emporary) causes
"^DD",142.1,142.1,5,21,6,0)
a component to be non-selectable for use, but its OUT OF ORDER MESSAGE
"^DD",142.1,142.1,5,21,7,0)
will appear in any Health Summary in which it is included.
"^DD",142.1,142.1,5,21,8,0)
 
"^DD",142.1,142.1,5,21,9,0)
Use the at-sign (@) at the DISABLE FLAG: permanent (or temporary)// prompt,
"^DD",142.1,142.1,5,21,10,0)
to enable the component for use.
"^DD",142.1,142.1,5,"DT")
2911122
"^DD",142.1,142.1,6,0)
LOCK^FX^^0;7^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<1) X I $D(X) Q:$D(^DIC(19.1,"B",X))  K X W !,$C(7),"Lock name must match exactly with a key in the SECURITY KEY file."
"^DD",142.1,142.1,6,3)
Enter the name of the security key required to have access to this component.
"^DD",142.1,142.1,6,21,0)
^^2^2^2901017^^^^
"^DD",142.1,142.1,6,21,1,0)
To be used for components such as psychology test results
"^DD",142.1,142.1,6,21,2,0)
Restricts viewing access under Print Health Summary Menu
"^DD",142.1,142.1,6,"DT")
2950816
"^DD",142.1,142.1,7,0)
SELECTION FILE^142.17P^^1;0
"^DD",142.1,142.1,7,21,0)
^^10^10^2960808^
"^DD",142.1,142.1,7,21,1,0)
Enter the name or number of the file from which selection items (e.g., lab
"^DD",142.1,142.1,7,21,2,0)
tests (file 60), radiology procedures (file 71), vital signs (file
"^DD",142.1,142.1,7,21,3,0)
120.51), PCE reminder/maintenance item (file 811.9) may be chosen for this
"^DD",142.1,142.1,7,21,4,0)
component.
"^DD",142.1,142.1,7,21,5,0)
 
"^DD",142.1,142.1,7,21,6,0)
The file you identify here must have its "Application Group"
"^DD",142.1,142.1,7,21,7,0)
multiple include "GMTS" BEFORE it can be selected as a selection file.
"^DD",142.1,142.1,7,21,8,0)
 
"^DD",142.1,142.1,7,21,9,0)
Components which require selection of items should have its component
"^DD",142.1,142.1,7,21,10,0)
name include the word "SELECTED".
"^DD",142.1,142.1,8,0)
OUT OF ORDER MESSAGE^F^^0;8^K:$L(X)>78!($L(X)<3) X
"^DD",142.1,142.1,8,3)
Answer must be 3-78 characters in length.
"^DD",142.1,142.1,8,21,0)
^^3^3^2910117^
"^DD",142.1,142.1,8,21,1,0)
This field is used when a health summary component is temporarily disabled.
"^DD",142.1,142.1,8,21,2,0)
If it is filled in, the message here will be displayed whenever the user
"^DD",142.1,142.1,8,21,3,0)
attempts to select the component
"^DD",142.1,142.1,8,"DT")
2910117
"^DD",142.1,142.1,9,0)
DEFAULT HEADER NAME^F^^0;9^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<2) X
"^DD",142.1,142.1,9,1,0)
^.1
"^DD",142.1,142.1,9,1,1,0)
142.1^AM9^MUMPS
"^DD",142.1,142.1,9,1,1,1)
D REDO^GMTSDD
"^DD",142.1,142.1,9,1,1,2)
D REDO^GMTSDD
"^DD",142.1,142.1,9,1,1,"%D",0)
^^4^4^2950731^
"^DD",142.1,142.1,9,1,1,"%D",1,0)
This MUMPS type cross-reference is used to recompile the ad hoc and
"^DD",142.1,142.1,9,1,1,"%D",2,0)
navigational menus when the DEFAULT HEADER NAME of a given component is
"^DD",142.1,142.1,9,1,1,"%D",3,0)
modified. The ^XUTL("XQORM", global is used by the Unwinder utility to
"^DD",142.1,142.1,9,1,1,"%D",4,0)
generate the ad hoc and navigational menus.
"^DD",142.1,142.1,9,1,1,"DT")
2911122
"^DD",142.1,142.1,9,1,2,0)
142.1^D^MUMPS
"^DD",142.1,142.1,9,1,2,1)
S ^GMT(142.1,"D",$$UP^XLFSTR(X),DA)=""
"^DD",142.1,142.1,9,1,2,2)
K ^GMT(142.1,"D",$$UP^XLFSTR(X),DA)
"^DD",142.1,142.1,9,1,2,"%D",0)
^^2^2^2951016^
"^DD",142.1,142.1,9,1,2,"%D",1,0)
This MUMPS type cross-reference is used in look-ups of components
"^DD",142.1,142.1,9,1,2,"%D",2,0)
by DEFAULT HEADER NAME.
"^DD",142.1,142.1,9,1,2,"DT")
2951016
"^DD",142.1,142.1,9,3)
Answer must be 2-20 characters in length.
"^DD",142.1,142.1,9,21,0)
^^5^5^2920928^^^^
"^DD",142.1,142.1,9,21,1,0)
The DEFAULT HEADER NAME will appear in menus and component headers in
"^DD",142.1,142.1,9,21,2,0)
preference to the COMPONENT NAME, but NOT in preference to the local
"^DD",142.1,142.1,9,21,3,0)
HEADER NAME, if it is defined for that component within a given Health 
"^DD",142.1,142.1,9,21,4,0)
Summary Type.  If defined the local HEADER NAME will have precedence
"^DD",142.1,142.1,9,21,5,0)
within a given Health Summary Type.
"^DD",142.1,142.1,9,"DT")
2951016
"^DD",142.1,142.1,10,0)
HOSPITAL LOCATION APPLICABLE^S^Y:yes;^0;10^Q
"^DD",142.1,142.1,10,3)
Enter YES if Hospital Location abbreviation display applies to this component.
"^DD",142.1,142.1,10,21,0)
^^3^3^2950731^
"^DD",142.1,142.1,10,21,1,0)
This field is used by the programmer to indicate whether the routine which
"^DD",142.1,142.1,10,21,2,0)
prints this component is set up to handle the display of the hospital
"^DD",142.1,142.1,10,21,3,0)
location abbreviation on the Health Summary.
"^DD",142.1,142.1,10,21,4,0)
file related components (PCE related components).
"^DD",142.1,142.1,10,"DT")
2940418
"^DD",142.1,142.1,11,0)
ICD TEXT APPLICABLE^S^Y:yes;^0;11^Q
"^DD",142.1,142.1,11,3)
Enter YES if ICD Text display applies to this component.
"^DD",142.1,142.1,11,21,0)
^^3^3^2950731^
"^DD",142.1,142.1,11,21,1,0)
This field is used by the programmer to indicate whether the routine which
"^DD",142.1,142.1,11,21,2,0)
prints this component is set up to handle the display of standardized ICD
"^DD",142.1,142.1,11,21,3,0)
text on the Health Summary.
"^DD",142.1,142.1,11,21,4,0)
(PCE related components).
"^DD",142.1,142.1,11,"DT")
2940418
"^DD",142.1,142.1,12,0)
PROVIDER NARRATIVE APPLICABLE^S^Y:yes;^0;12^Q
"^DD",142.1,142.1,12,3)
Enter YES if Provider Narrative display applies to this component.
"^DD",142.1,142.1,12,21,0)
^^3^3^3000329^^^
"^DD",142.1,142.1,12,21,1,0)
This field is used by the programmer to indicate whether the routine which
"^DD",142.1,142.1,12,21,2,0)
prints this component is set up to handle the display of the provider
"^DD",142.1,142.1,12,21,3,0)
narrative on the Health Summary.
"^DD",142.1,142.1,12,21,4,0)
(PCE related components).
"^DD",142.1,142.1,12,"DT")
2940418
"^DD",142.1,142.1,13,0)
PREFIX^F^^0;13^K:$L(X)>4!($L(X)<2) X
"^DD",142.1,142.1,13,3)
Answer must be 2-4 characters in length.
"^DD",142.1,142.1,13,21,0)
^^1^1^2990617^
"^DD",142.1,142.1,13,21,1,0)
Namespace of the component's supporting package.
"^DD",142.1,142.1,13,"DT")
2990617
"^DD",142.1,142.1,14,0)
CPT MODIFIER APPLICABLE^S^Y:YES;^0;14^Q
"^DD",142.1,142.1,14,21,0)
^^3^3^3000329^^^
"^DD",142.1,142.1,14,21,1,0)
This field is used by the programmer to indicate whether the routine which
"^DD",142.1,142.1,14,21,2,0)
prints this component is set up to handle the display of CPT Modifiers
"^DD",142.1,142.1,14,21,3,0)
on the Health Summary.
"^DD",142.1,142.1,14,"DT")
3000329
"^DD",142.1,142.11,0)
EXTERNAL/EXTRACT ROUTINE SUB-FIELD^^.01^1
"^DD",142.1,142.11,0,"DT")
2990616
"^DD",142.1,142.11,0,"IX","B",142.11,.01)

"^DD",142.1,142.11,0,"NM","EXTERNAL/EXTRACT ROUTINE")

"^DD",142.1,142.11,0,"UP")
142.1
"^DD",142.1,142.11,.01,0)
EXTERNAL/EXTRACT ROUTINE^MF^^0;1^K:$L(X)>40!($L(X)<3) X
"^DD",142.1,142.11,.01,.1)
ROUTINE
"^DD",142.1,142.11,.01,1,0)
^.1
"^DD",142.1,142.11,.01,1,1,0)
142.11^B
"^DD",142.1,142.11,.01,1,1,1)
S ^GMT(142.1,DA(1),.1,"B",$E(X,1,30),DA)=""
"^DD",142.1,142.11,.01,1,1,2)
K ^GMT(142.1,DA(1),.1,"B",$E(X,1,30),DA)
"^DD",142.1,142.11,.01,3)
Answer must be 3-40 characters in length.
"^DD",142.1,142.11,.01,21,0)
^^5^5^2990616^^
"^DD",142.1,142.11,.01,21,1,0)
This is the entry point and routine to be called by the Health Summary 
"^DD",142.1,142.11,.01,21,2,0)
component print routine to extract report data.  This entry point may be in 
"^DD",142.1,142.11,.01,21,3,0)
the Health Summary namespace or an external call with an associated Database 
"^DD",142.1,142.11,.01,21,4,0)
Integration Agreement.  Enter the line label, followed by a semi-colon, 
"^DD",142.1,142.11,.01,21,5,0)
followed by the routine name (e.g., MAIN;GMTSLRCE)
"^DD",142.1,142.11,.01,"DT")
2990616
"^DD",142.1,142.17,0)
SELECTION FILE SUB-FIELD^^1^2
"^DD",142.1,142.17,0,"DT")
2910103
"^DD",142.1,142.17,0,"IX","B",142.17,.01)

"^DD",142.1,142.17,0,"NM","SELECTION FILE")

"^DD",142.1,142.17,0,"UP")
142.1
"^DD",142.1,142.17,.01,0)
SELECTION FILE^M*P1'^DIC(^0;1^S DIC("S")="I $D(^DIC(""AC"",""GMTS"",+Y))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",142.1,142.17,.01,1,0)
^.1
"^DD",142.1,142.17,.01,1,1,0)
142.17^B
"^DD",142.1,142.17,.01,1,1,1)
S ^GMT(142.1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",142.1,142.17,.01,1,1,2)
K ^GMT(142.1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",142.1,142.17,.01,1,1,"%D",0)
^^2^2^2920302^
"^DD",142.1,142.17,.01,1,1,"%D",1,0)
This REGULAR FileMan type cross-reference is used during look-ups of
"^DD",142.1,142.17,.01,1,1,"%D",2,0)
selection items in the Create/Modify and parameter edit dialogues.
"^DD",142.1,142.17,.01,12)
Only files that belong to the "GMTS" application group are allowed.
"^DD",142.1,142.17,.01,12.1)
S DIC("S")="I $D(^DIC(""AC"",""GMTS"",+Y))"
"^DD",142.1,142.17,.01,21,0)
^^3^3^2940714^^^^
"^DD",142.1,142.17,.01,21,1,0)
Enter the names or numbers of the files from which selection items
"^DD",142.1,142.17,.01,21,2,0)
(e.g., lab tests (file 60), radiology procedures (file 71), or vital 
"^DD",142.1,142.17,.01,21,3,0)
signs (file 120.51)) may be chosen for this component.
"^DD",142.1,142.17,.01,"DT")
2910103
"^DD",142.1,142.17,1,0)
SELECTION COUNT LIMIT^NJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",142.1,142.17,1,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",142.1,142.17,1,21,0)
^^4^4^2901017^
"^DD",142.1,142.17,1,21,1,0)
Enter the MAXIMUM number of selection items which may be selected for
"^DD",142.1,142.17,1,21,2,0)
any single appearance of this component in a given health summary type.
"^DD",142.1,142.17,1,21,3,0)
That is, a value of 7 will allow the user to select as many as seven
"^DD",142.1,142.17,1,21,4,0)
items, etc.
"^DD",142.1,142.17,1,"DT")
2900521
"^DD",142.1,142.35,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",142.1,142.35,0,"DT")
2910103
"^DD",142.1,142.35,0,"NM","DESCRIPTION")

"^DD",142.1,142.35,0,"UP")
142.1
"^DD",142.1,142.35,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",142.1,142.35,.01,"DT")
2910103
"^DIC",142,142,0)
HEALTH SUMMARY TYPE^142
"^DIC",142,142,0,"GL")
^GMT(142,
"^DIC",142,142,"%D",0)
^^11^11^2980401^^^^
"^DIC",142,142,"%D",1,0)
This file contains the structure of a Health Summary.  Components from the
"^DIC",142,142,"%D",2,0)
Health Summary Components file (142.1) may be selected and restricted by
"^DIC",142,142,"%D",3,0)
number of occurrences or time limits. The original creator of a type of 
"^DIC",142,142,"%D",4,0)
Health Summary is the owner of that type.  Health Summaries that are
"^DIC",142,142,"%D",5,0)
"owned" may not be modified or deleted by anyone else, except the Clinical
"^DIC",142,142,"%D",6,0)
Coordinator.  "Owned" Health Summaries may be used by other users to
"^DIC",142,142,"%D",7,0)
print patient information.  
"^DIC",142,142,"%D",8,0)
  
"^DIC",142,142,"%D",9,0)
The GMTSMGR security key is included on generic Health Summaries sent out 
"^DIC",142,142,"%D",10,0)
with the Health Summary Package.  These types of Health Summaries should 
"^DIC",142,142,"%D",11,0)
not be deleted.
"^DIC",142,142,"%D",12,0)
 
"^DIC",142,142,"%D",13,0)
Fields 2,3,4,5 and 6 are used ONLY by Indian Health Service.
"^DIC",142,142,"%D",14,0)
Specifically, fields 4 (MEASUREMENT PANEL) and 6 (SURVEILLANCE PANEL)
"^DIC",142,142,"%D",15,0)
point to files 9001017 and 9001018 respectively, which WILL NOT be
"^DIC",142,142,"%D",16,0)
present at non-PCC sites.
"^DIC",142,"B","HEALTH SUMMARY TYPE",142)

"^DIC",142.1,142.1,0)
HEALTH SUMMARY COMPONENT^142.1I
"^DIC",142.1,142.1,0,"GL")
^GMT(142.1,
"^DIC",142.1,142.1,"%D",0)
^^5^5^2980401^^^^
"^DIC",142.1,142.1,"%D",1,0)
This file contains all components which may be used to create a Health
"^DIC",142.1,142.1,"%D",2,0)
Summary. These entries are typically defined by a programmer. Components
"^DIC",142.1,142.1,"%D",3,0)
which represent packages which are not in use may be disabled, so they
"^DIC",142.1,142.1,"%D",4,0)
will not be selected by users to build new types of Health Summary
"^DIC",142.1,142.1,"%D",5,0)
reports.
"^DIC",142.1,"B","HEALTH SUMMARY COMPONENT",142.1)

**END**
**END**
