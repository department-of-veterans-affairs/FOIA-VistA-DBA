$TXT Created by FORT,WALLY at NXT.KERNEL.FO-OAKLAND.MED.VA.GOV  (KIDS) on THURSDAY, 02/20/03 at 14:52
=============================================================================
Run Date: JUL 02, 2003                     Designation: XU*8*288
Package : XU - KERNEL                          Priority: Mandatory
Version : 8       SEQ #255                       Status: Released
                  Compliance Date: AUG 02, 2003
=============================================================================

Associated patches: (v)XU*8*267    <<= must be installed BEFORE `XU*8*288'

Subject: Updated DEA~XUSER API.

Category: 
  - Routine

Description: 
============

 Patch Tracking #: 35769911
 Test Sites: Salt Lake V&DC; Seattle VAMC 
 Blood Bank Clearance: 6/16/2003
  
 This patch updates the DEA API that was added with patch XU*8*267.
 The changes are to allow a USER IEN to be passed in to use inplace of
 the current DUZ.  The second update is that if the institution doesn't
 have a DEA# on file a check is done to get the PARENT FACILITY and see if
 there is a DEA# for that entry.
  
  
 The DEA/VA PKI pilot project requires an API to obtain the value stored 
 in the DEA# field (#53.2) in the NEW PERSON file (#200). This patch 
 provides this new API. The specific API information follows:
  
      $$DEA^XUSER([FLAG][,USERIEN])
      Reference type: Supported, Category: PKI, Integration Agreement #2343 
  
      Description:
      This routine will return a user's DEA number, if it exists in the 
      DEA# field (#53.2) of the NEW PERSON file (#200). If the DEA# field 
      value is null, the value returned depends on the optional FLAG 
      input parameter, see below.
  
      Input Parameter
      FLAG   (optional) This flag controls what is returned when the user 
      does not have a value in the DEA# field (#53.2) of the NEW PERSON 
      file (#200).
  
             * FLAG is null or "0" -- This routine will check to see if 
             the user has values in the VA# field (#53.3) of the NEW 
             PERSON file (#200) and the (new) FACILITY DEA NUMBER field 
             (#52) of the INSTITUTION file (#4). If values are found in 
             both of those fields, this routine will return the 
             following:
  
                    FACILITY DEA NUMBER field (#52)_"-"_VA# field(#53.3)
  
             * FLAG is "1" -- This routine will check to see if the user 
             has a value in the VA# field (#53.3) of the NEW PERSON file 
             (#200). If a value is found in that field, this routine will 
             return that field value. Otherwise, this routine returns an 
             empty string. 
  
      USERIEN  (optional) This value can be used to get the DEA# of some 
      user besides the one that signed in.  In CPRS to check that a students 
      teacher has the required DEA#.
  
      Output
      DEA#   DEA# field (#53.2) value or the value returned based on the 
      (optional) FLAG input parameter, see "Input Parameter" above.
  
      Example 1
  
      DEA# (#53.2) field is "AB1234567"
      FACILITY DEA NUMBER field (#52) is "VA7654321"              
      VA# field (#53.3) is "789"
  
      If the FLAG input parameter is null or "0", this API would return 
      "AB1234567".
  
      If the FLAG input parameter is "1", this API would return "AB1234567".
  
  
      Example 2
  
      DEA# (#53.2) field is null
      FACILITY DEA NUMBER field (#52) is "VA7654321"              
      VA# field (#53.3) is "789"
  
      If the FLAG input parameter is null or "0", this API would return 
      "VA7654321-789".
  
      If the FLAG input parameter is "1", this API would return "789"
  
  
      Example 3
  
      DEA# (#53.2) field is null
      FACILITY DEA NUMBER field (#52) is "VA7654321"              
      VA# field (#53.3) is null
  
      If the FLAG input parameter is null or "0", this API would return "".
  
      If the FLAG input parameter is "1", this API would return "" 
      In both cases it returns an empty string.
  
 It adds a menu item "Institution DEA# edit" (XU-INSTITUTION-DEA), to the 
 Kernel Management Menu (XUKERNEL) to allow the entry/edit of the 
 institution DEA# value.    
  
 Routine Summary
 The following routines are included in this patch.  The second line of each
 of these routines now looks like:
  ;;8.0;KERNEL;**[Patch List]**;Jul 10, 1995
  
                  Checksum
 Routine         Old       New      Patch List
 XUSER         2431785   2773911    **75,97,99,150,226,267,288**
  
 List of preceding patches: 267
 Sites should use CHECK^XTSUMBLD to verify checksums.
  
 =========================================================================
 Installation:
  
 >>>Users may remain on the system.
 >>>TaskMan does *not* need to be stopped.
  
   1.  DSM sites - If the XUSER routine is mapped,
       so you will need to disable mapping for that routine.
  
   2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
       option will load the KIDS package onto your system.
  
   3.  The patch has now been loaded into a Transport global on your
       system. You now need to use KIDS to install the Transport global.
       On the KIDS menu, under the 'Installation' menu, use the following
       options:
  
          Verify Checksums in Transport Global
          Print Transport Global
          Compare Transport Global to Current System
          Backup a Transport Global
  
   4.  Users can remain on the system. This patch can be loaded any
       non-peak time.
       TaskMan can remain running.
  
   5.  Installation will take less than 2 minutes.
       On the KIDS menu, under the 'Installation' menu, use the following
       option:
         Install Package(s)  'XU*8.0*288'
                              ==========
  
       Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// YES
         
       Want KIDS to INHIBIT LOGONs during the install? YES// NO
  
       Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
  
   6.  DSM Sites, after patch has installed, rebuild your map set.
  
 =========================================================================

Routine Information:
====================

Routine Name:
  - XUSER


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : FORT,WALLY                     Date Entered : FEB 20, 2003
Completed By: SINGH,GURBIR                  Date Completed: JUN 25, 2003
Released By : TILLIS,LEWIS                  Date Released : JUL 02, 2003
=============================================================================


Packman Mail Message:
=====================

$END TXT
