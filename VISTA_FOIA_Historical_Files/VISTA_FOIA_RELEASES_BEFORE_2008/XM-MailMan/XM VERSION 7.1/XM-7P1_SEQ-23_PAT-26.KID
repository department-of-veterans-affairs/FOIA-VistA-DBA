Released XM*7.1*26 SEQ #23
Extracted from mail message
**KIDS**:XM*7.1*26^

**INSTALL NAME**
XM*7.1*26
"BLD",5,0)
XM*7.1*26^MAILMAN^0^2960314^n
"BLD",5,1,0)
^^45^45^2960314^
"BLD",5,1,1,0)
 This patch corrects a missing node in bulletins that was introduced
"BLD",5,1,2,0)
 with patch XM*7.1*24.  NOIS MIN-0396-4104
"BLD",5,1,3,0)

"BLD",5,1,4,0)
 This MailMan patch is in KIDS format.  Please make sure you follow the
"BLD",5,1,5,0)
 Installation instructions.
"BLD",5,1,6,0)

"BLD",5,1,7,0)
===========================================================================
"BLD",5,1,8,0)
 This patch should be installed after hours, when there is minimum users on
"BLD",5,1,9,0)
 the system.  You should put the XMUSER Option out of order.
"BLD",5,1,10,0)
  
"BLD",5,1,11,0)
===========================================================================
"BLD",5,1,12,0)
INSTALLATION:
"BLD",5,1,13,0)
  1.  This routine is usually mapped on systems that allow mapping,
"BLD",5,1,14,0)
      so you will need to disable mapping for this routine.
"BLD",5,1,15,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",5,1,16,0)
      option will load the KIDS package onto your system.
"BLD",5,1,17,0)
  3.  Answer NO to the question:
"BLD",5,1,18,0)
      'Shall I preserve what is on disk in a separate back-up message ?'.
"BLD",5,1,19,0)
  4.  The patch has now been loaded into a Transport global on your
"BLD",5,1,20,0)
      system. You now need to use KIDS to install the Transport global.
"BLD",5,1,21,0)
  5.  On the KIDS menu, under the 'Installation' menu, use the option 
"BLD",5,1,22,0)
      'Verify Checksum in Transport Global' and verify that all routines
"BLD",5,1,23,0)
      have the correct checksums.
"BLD",5,1,24,0)
  6.  On the KIDS menu, under the 'Installation' menu, use the option 
"BLD",5,1,25,0)
      'Install Package(s)'. Select the package 'XM*7.1*26' and proceed
"BLD",5,1,26,0)
      with install.
"BLD",5,1,27,0)
  7.  Answer YES to the question:
"BLD",5,1,28,0)
      'Want to DISABLE Scheduled Options and Menu Options?'
"BLD",5,1,29,0)
  8.  Enter XMUSER at the question:
"BLD",5,1,30,0)
      'Enter options you wish to mark as 'Out Of Order':'
"BLD",5,1,31,0)
  9.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",5,1,32,0)
      other CPUs?'.
"BLD",5,1,33,0)
 10.  AXP Sites, after patch has installed, rebuild your map set.
"BLD",5,1,34,0)
 ====================================================================  
"BLD",5,1,35,0)
  
"BLD",5,1,36,0)
 ROUTINES:
"BLD",5,1,37,0)
   The second line of the routine now looks like:
"BLD",5,1,38,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",5,1,39,0)
 
"BLD",5,1,40,0)
 Name          Checksum          Patch List
"BLD",5,1,41,0)
 ----------------------------------------------------------
"BLD",5,1,42,0)
 XMB           7219230           3,7,24,26
"BLD",5,1,43,0)
 
"BLD",5,1,44,0)

"BLD",5,1,45,0)

"BLD",5,4,0)
^9.64PA^^
"BLD",5,"KRN",0)
^9.67PA^.84^11
"BLD",5,"KRN",.4,0)
.4
"BLD",5,"KRN",.401,0)
.401
"BLD",5,"KRN",.402,0)
.402
"BLD",5,"KRN",.403,0)
.403
"BLD",5,"KRN",.5,0)
.5
"BLD",5,"KRN",.84,0)
.84
"BLD",5,"KRN",3.6,0)
3.6
"BLD",5,"KRN",9.2,0)
9.2
"BLD",5,"KRN",9.8,0)
9.8
"BLD",5,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5,"KRN",9.8,"NM",1,0)
XMB^^0^B16862399
"BLD",5,"KRN",9.8,"NM","B","XMB",1)

"BLD",5,"KRN",19,0)
19
"BLD",5,"KRN",19.1,0)
19.1
"BLD",5,"KRN","B",.4,.4)

"BLD",5,"KRN","B",.401,.401)

"BLD",5,"KRN","B",.402,.402)

"BLD",5,"KRN","B",.403,.403)

"BLD",5,"KRN","B",.5,.5)

"BLD",5,"KRN","B",.84,.84)

"BLD",5,"KRN","B",3.6,3.6)

"BLD",5,"KRN","B",9.2,9.2)

"BLD",5,"KRN","B",9.8,9.8)

"BLD",5,"KRN","B",19,19)

"BLD",5,"KRN","B",19.1,19.1)

"PKG",6,-1)
1^1
"PKG",6,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.1^2940602^2950925
"PKG",6,22,1,"PAH",1,0)
26^2960314
"PKG",6,22,1,"PAH",1,1,0)
^^45^45^2960314
"PKG",6,22,1,"PAH",1,1,1,0)
 This patch corrects a missing node in bulletins that was introduced
"PKG",6,22,1,"PAH",1,1,2,0)
 with patch XM*7.1*24.  NOIS MIN-0396-4104
"PKG",6,22,1,"PAH",1,1,3,0)

"PKG",6,22,1,"PAH",1,1,4,0)
 This MailMan patch is in KIDS format.  Please make sure you follow the
"PKG",6,22,1,"PAH",1,1,5,0)
 Installation instructions.
"PKG",6,22,1,"PAH",1,1,6,0)

"PKG",6,22,1,"PAH",1,1,7,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,8,0)
 This patch should be installed after hours, when there is minimum users on
"PKG",6,22,1,"PAH",1,1,9,0)
 the system.  You should put the XMUSER Option out of order.
"PKG",6,22,1,"PAH",1,1,10,0)
  
"PKG",6,22,1,"PAH",1,1,11,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,12,0)
INSTALLATION:
"PKG",6,22,1,"PAH",1,1,13,0)
  1.  This routine is usually mapped on systems that allow mapping,
"PKG",6,22,1,"PAH",1,1,14,0)
      so you will need to disable mapping for this routine.
"PKG",6,22,1,"PAH",1,1,15,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",6,22,1,"PAH",1,1,16,0)
      option will load the KIDS package onto your system.
"PKG",6,22,1,"PAH",1,1,17,0)
  3.  Answer NO to the question:
"PKG",6,22,1,"PAH",1,1,18,0)
      'Shall I preserve what is on disk in a separate back-up message ?'.
"PKG",6,22,1,"PAH",1,1,19,0)
  4.  The patch has now been loaded into a Transport global on your
"PKG",6,22,1,"PAH",1,1,20,0)
      system. You now need to use KIDS to install the Transport global.
"PKG",6,22,1,"PAH",1,1,21,0)
  5.  On the KIDS menu, under the 'Installation' menu, use the option 
"PKG",6,22,1,"PAH",1,1,22,0)
      'Verify Checksum in Transport Global' and verify that all routines
"PKG",6,22,1,"PAH",1,1,23,0)
      have the correct checksums.
"PKG",6,22,1,"PAH",1,1,24,0)
  6.  On the KIDS menu, under the 'Installation' menu, use the option 
"PKG",6,22,1,"PAH",1,1,25,0)
      'Install Package(s)'. Select the package 'XM*7.1*26' and proceed
"PKG",6,22,1,"PAH",1,1,26,0)
      with install.
"PKG",6,22,1,"PAH",1,1,27,0)
  7.  Answer YES to the question:
"PKG",6,22,1,"PAH",1,1,28,0)
      'Want to DISABLE Scheduled Options and Menu Options?'
"PKG",6,22,1,"PAH",1,1,29,0)
  8.  Enter XMUSER at the question:
"PKG",6,22,1,"PAH",1,1,30,0)
      'Enter options you wish to mark as 'Out Of Order':'
"PKG",6,22,1,"PAH",1,1,31,0)
  9.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",6,22,1,"PAH",1,1,32,0)
      other CPUs?'.
"PKG",6,22,1,"PAH",1,1,33,0)
 10.  AXP Sites, after patch has installed, rebuild your map set.
"PKG",6,22,1,"PAH",1,1,34,0)
 ====================================================================  
"PKG",6,22,1,"PAH",1,1,35,0)
  
"PKG",6,22,1,"PAH",1,1,36,0)
 ROUTINES:
"PKG",6,22,1,"PAH",1,1,37,0)
   The second line of the routine now looks like:
"PKG",6,22,1,"PAH",1,1,38,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",6,22,1,"PAH",1,1,39,0)
 
"PKG",6,22,1,"PAH",1,1,40,0)
 Name          Checksum          Patch List
"PKG",6,22,1,"PAH",1,1,41,0)
 ----------------------------------------------------------
"PKG",6,22,1,"PAH",1,1,42,0)
 XMB           7219230           3,7,24,26
"PKG",6,22,1,"PAH",1,1,43,0)
 
"PKG",6,22,1,"PAH",1,1,44,0)

"PKG",6,22,1,"PAH",1,1,45,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options and Menu Options
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XMB")
0^1^B16862399
"RTN","XMB",1,0)
XMB ;(WASH ISC)/THM/RWF/CAP-Bulletins & TaskMan ;03/14/96  14:11
"RTN","XMB",2,0)
 ;;7.1;MailMan;**3,7,24,26**;Jun 02, 1994
"RTN","XMB",3,0)
 ; The entry point ^XMB delivers a bulletin in background.  The
"RTN","XMB",4,0)
 ; recipients of the message will include any entries in the XMY
"RTN","XMB",5,0)
 ; array that the caller has defined and the members of mail group
"RTN","XMB",6,0)
 ; that are included in the definition of the entry in the Bulletin
"RTN","XMB",7,0)
 ; file (#3.6) at the time of delivery.  There must be valid
"RTN","XMB",8,0)
 ; recipients or the message will not be delivered.
"RTN","XMB",9,0)
 ; Inputs:
"RTN","XMB",10,0)
 ;    XMB=The name of a bulletin (an entry in File #3.6)
"RTN","XMB",11,0)
 ;    XMB(parameter#)=The value to be stuffed into the bulletin for each
"RTN","XMB",12,0)
 ;       required parameter.  (eg. XMB(1)=data for parameter#1
"RTN","XMB",13,0)
 ;    XMTEXT=The text of the message (Optional)
"RTN","XMB",14,0)
 ;    XMY=An array of recipients of a bulletin (Optional)
"RTN","XMB",15,0)
 ;    XMDUZ=Sender #
"RTN","XMB",16,0)
 ;    XMDT=Current date/time
"RTN","XMB",17,0)
 ;
"RTN","XMB",18,0)
 ; Output:
"RTN","XMB",19,0)
 ;    XMZ=Message number if successful
"RTN","XMB",20,0)
 D SW^XMBPOST K XMTEXT
"RTN","XMB",21,0)
 N %,A,B,C,D,DA,DIC,DIE,DR,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,V,W,XMA0,XMB0,XMC0,XMCHAN,XMINST,XMM,XMMG,XMIO,XMJ,XMRDOM,XMSCR,XMSCRN,XMSDOM,XMSITE,Y,Z
"RTN","XMB",22,0)
 S XMCHAN=1
"RTN","XMB",23,0)
 ;XMBTMP is set in XMA1A - confirmation message
"RTN","XMB",24,0)
 I '$D(XMBTMP) K ^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMB",25,0)
 S XMB("TYPE")=2 S:'$D(XMDT) XMDT="N"
"RTN","XMB",26,0)
 D D
"RTN","XMB",27,0)
 G PK^XMBPOST:'$D(^TMP("XMY",$J))
"RTN","XMB",28,0)
 D ^XMBPOST
"RTN","XMB",29,0)
 K XMY,XMY0,^TMP("XMY",$J),^TMP("XMY0",$J),^TMP("XMBTEXT",$J)
"RTN","XMB",30,0)
 Q
"RTN","XMB",31,0)
EN ;Interactive Bulletin Entry Point
"RTN","XMB",32,0)
 D SW^XMBPOST K XMTEXT
"RTN","XMB",33,0)
 N %,A,B,C,D,DA,DIC,DIE,DR,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,V,W,XMA0,XMB0,XMC0,XMCHAN,XMINST,XMM,XMMG,XMIO,XMJ,XMRDOM,XMSCR,XMSCRN,XMSDOM,XMSITE,Y,Z
"RTN","XMB",34,0)
 S XMCHAN=1 I '$D(XMBTMP) K ^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMB",35,0)
 S XMBDUZ=$D(XMDUZ) S:'XMBDUZ XMDUZ=DUZ D D Q:XMM<0  I '$D(^TMP("XMY",$J)) Q
"RTN","XMB",36,0)
 S XMSUB=$P(^XMB(3.6,XMM,0),U,2)
"RTN","XMB",37,0)
 I XMSUB["|" S XMF=XMSUB D FILL S XMSUB=XMF
"RTN","XMB",38,0)
XMZ D XMZ^XMA2 G OK:XMZ>0 I $D(ZTQUEUED) S ZTREQ="900S" Q
"RTN","XMB",39,0)
 W !!,"Waiting for the Message File",*7,! F %=1:1:10 W "." H 1
"RTN","XMB",40,0)
 G XMZ
"RTN","XMB",41,0)
OK I $D(XMYBLOB)>9 S X=$$MULTI^XMBBLOB(XMZ)
"RTN","XMB",42,0)
 D MOVE I 'XMBDUZ S X=$S($D(XMDUN):XMDUN,$D(^VA(200,DUZ,0)):"<"_$P(^(0),U)_">",1:"<Postmaster>") S $P(^XMB(3.9,XMZ,0),U,2)=X
"RTN","XMB",43,0)
 D REDO^XMA21,ENT1^XMAD1 K:'XMBDUZ XMDUZ K XMBDUZ
"RTN","XMB",44,0)
 G KILL
"RTN","XMB",45,0)
MOVE N I,J,XMF,XMT,Y
"RTN","XMB",46,0)
 S XMT=^XMB(3.6,XMM,1,0)
"RTN","XMB",47,0)
 F I=1:1:$P(XMT,U,4) S XMF=^XMB(3.6,XMM,1,I,0) D FILL:XMF["|" S ^XMB(3.9,XMZ,2,I,0)=XMF
"RTN","XMB",48,0)
 I $D(^TMP("XMBTEXT",$J)) D
"RTN","XMB",49,0)
 .;J=0 if text is on node ^(Y,0), =1 if on ^(Y)
"RTN","XMB",50,0)
 .S J=$D(^($O(^TMP("XMBTEXT",$J,0))))#2,Y=0
"RTN","XMB",51,0)
 .F I=I+1:1 S Y=$O(^TMP("XMBTEXT",$J,Y)) Q:'Y  S X=$S(J:$G(^(Y)),1:$G(^(Y,0))),^XMB(3.9,XMZ,2,I,0)=X
"RTN","XMB",52,0)
 .S I=I-1
"RTN","XMB",53,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92A^"_I_U_I
"RTN","XMB",54,0)
 Q
"RTN","XMB",55,0)
FILL N I,K
"RTN","XMB",56,0)
 F I=1:1 Q:$P(XMF,"|",2,99)=""  S K=+$P(XMF,"|",2),XMF=$P(XMF,"|",1)_$S($D(XMB(K)):XMB(K),1:"")_$P(XMF,"|",3,999)
"RTN","XMB",57,0)
 Q
"RTN","XMB",58,0)
FAIL S XMB=-1
"RTN","XMB",59,0)
END K XMU,XMT Q
"RTN","XMB",60,0)
D S XMJ=0,XMM=$O(^XMB(3.6,"B",XMB,0)) G FAIL:'XMM S XMN=0 K XMFINAL
"RTN","XMB",61,0)
 I $D(XMY) S %X="XMY(",%Y="^TMP(""XMY"","_$J_"," D %XY^%RCR
"RTN","XMB",62,0)
D0 S XMJ=$O(^XMB(3.6,XMM,2,XMJ)) I XMJ S (I,Y)=+^(XMJ,0),%=$G(^XMB(3.8,Y,0)) G D0:%="" S Y=Y_U_$P(%,U),XME0=$P(%,U,6) D GO^XMA21G G D0
"RTN","XMB",63,0)
 K XMN,XMJ,XM1 Q
"RTN","XMB",64,0)
 ;
"RTN","XMB",65,0)
 ;
"RTN","XMB",66,0)
ZTSK ;ENTRY POINT FROM THE TASK MANAGER
"RTN","XMB",67,0)
 S XMTSK=ZTSK S:'$D(XMDT) XMDT="N"
"RTN","XMB",68,0)
 S:'$D(XMIO) XMIO="" D KILL:"236"'[XMB("TYPE")
"RTN","XMB",69,0)
 S:'$D(XMDUZ) XMDUZ=.5 G @(XMB("TYPE"))
"RTN","XMB",70,0)
1 G ZTSK^XMA1 ; TICKLER MESSAGES
"RTN","XMB",71,0)
2 K:'$G(XMBTMP) ^TMP("XMY",$J),^TMP("XMY0",$J) K XMDT S XMB=XMB("A") G EN ; BULLETIN
"RTN","XMB",72,0)
3 G ZTSK^XMS0 ; REMOTE TRANSMISSION
"RTN","XMB",73,0)
4 G ZDEV^XMS1 ; PRINT MESSAGE ON DEVICE
"RTN","XMB",74,0)
5 G ZSER^XMS1 ; PUMP INTO SERVER
"RTN","XMB",75,0)
6 G ZTSK^XMS1 ; POLLER
"RTN","XMB",76,0)
7 G TASKER^XMR ;INTER-UCI TRANSFER
"RTN","XMB",77,0)
 Q
"RTN","XMB",78,0)
BULL ;MANUALLY POST A BULLETIN
"RTN","XMB",79,0)
 S DIC(0)="AEQMZ",DIC="^XMB(3.6," D ^DIC
"RTN","XMB",80,0)
 I Y<0 K %H,%I,DIC,XM1,XMA,XMB,XMDT,XMM,XMT,Y Q
"RTN","XMB",81,0)
 S XMB=$P(Y(0),U,1),XMJ=0 F I=1:1 S XMJ=$O(^XMB(3.6,+Y,1,XMJ)) Q:'XMJ  W !,^(XMJ,0)
"RTN","XMB",82,0)
 F I=1:1 W !,"ENTER PARAMETER ",I,": " R XMB(I):$S($D(DTIME):DTIME,1:300) S:'$T XMB(I)=U Q:XMB(I)=""!(XMB(I)[U)
"RTN","XMB",83,0)
 R !,"ENTER POSTING DATE: NOW// ",XMDT:$S($D(DTIME):DTIME,1:300) S:'$T XMDT=U Q:XMDT[U  K:XMDT="" XMDT S XMT=0 K XMY,XMY0,^TMP("XMY",$J),^TMP("XMY0",$J)
"RTN","XMB",84,0)
 G XMB
"RTN","XMB",85,0)
KILL ;KILL TASK ZTSK
"RTN","XMB",86,0)
 S %=$S($D(XMSCR):XMSCR,$D(XMINST):XMINST,1:0) I % K ^XMBS(4.2999,%,3)
"RTN","XMB",87,0)
 S ZTREQ="@" Q
"RTN","XMB",88,0)
NEW ;this tag is no longer called, XM*7.1*24
"RTN","XMB",89,0)
 Q
"VER")
8.0^21.0
**END**
**END**
