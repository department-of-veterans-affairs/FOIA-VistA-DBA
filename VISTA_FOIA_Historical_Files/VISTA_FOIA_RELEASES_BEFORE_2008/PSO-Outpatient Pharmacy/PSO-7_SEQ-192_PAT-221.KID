Released PSO*7*221 SEQ #192
Extracted from mail message
**KIDS**:PSO*7.0*221^

**INSTALL NAME**
PSO*7.0*221
"BLD",6090,0)
PSO*7.0*221^OUTPATIENT PHARMACY^0^3050916^y
"BLD",6090,1,0)
^^1^1^3050915^^
"BLD",6090,1,1,0)
PFP PSO*7.0*221 UPDATE TO PSO*7.0*174
"BLD",6090,4,0)
^9.64PA^^
"BLD",6090,"KRN",0)
^9.67PA^8989.52^19
"BLD",6090,"KRN",.4,0)
.4
"BLD",6090,"KRN",.401,0)
.401
"BLD",6090,"KRN",.402,0)
.402
"BLD",6090,"KRN",.403,0)
.403
"BLD",6090,"KRN",.5,0)
.5
"BLD",6090,"KRN",.84,0)
.84
"BLD",6090,"KRN",3.6,0)
3.6
"BLD",6090,"KRN",3.8,0)
3.8
"BLD",6090,"KRN",9.2,0)
9.2
"BLD",6090,"KRN",9.8,0)
9.8
"BLD",6090,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6090,"KRN",9.8,"NM",1,0)
PSOMGCOM^^0^B20999263
"BLD",6090,"KRN",9.8,"NM","B","PSOMGCOM",1)

"BLD",6090,"KRN",19,0)
19
"BLD",6090,"KRN",19.1,0)
19.1
"BLD",6090,"KRN",101,0)
101
"BLD",6090,"KRN",409.61,0)
409.61
"BLD",6090,"KRN",771,0)
771
"BLD",6090,"KRN",870,0)
870
"BLD",6090,"KRN",8989.51,0)
8989.51
"BLD",6090,"KRN",8989.52,0)
8989.52
"BLD",6090,"KRN",8994,0)
8994
"BLD",6090,"KRN","B",.4,.4)

"BLD",6090,"KRN","B",.401,.401)

"BLD",6090,"KRN","B",.402,.402)

"BLD",6090,"KRN","B",.403,.403)

"BLD",6090,"KRN","B",.5,.5)

"BLD",6090,"KRN","B",.84,.84)

"BLD",6090,"KRN","B",3.6,3.6)

"BLD",6090,"KRN","B",3.8,3.8)

"BLD",6090,"KRN","B",9.2,9.2)

"BLD",6090,"KRN","B",9.8,9.8)

"BLD",6090,"KRN","B",19,19)

"BLD",6090,"KRN","B",19.1,19.1)

"BLD",6090,"KRN","B",101,101)

"BLD",6090,"KRN","B",409.61,409.61)

"BLD",6090,"KRN","B",771,771)

"BLD",6090,"KRN","B",870,870)

"BLD",6090,"KRN","B",8989.51,8989.51)

"BLD",6090,"KRN","B",8989.52,8989.52)

"BLD",6090,"KRN","B",8994,8994)

"BLD",6090,"QUES",0)
^9.62^^
"BLD",6090,"REQB",0)
^9.611^1^1
"BLD",6090,"REQB",1,0)
PSO*7.0*174^1
"BLD",6090,"REQB","B","PSO*7.0*174",1)

"MBREQ")
0
"PKG",170,-1)
1^1
"PKG",170,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",170,22,0)
^9.49I^1^1
"PKG",170,22,1,0)
7.0^2971216^2981113^1
"PKG",170,22,1,"PAH",1,0)
221^3050916
"PKG",170,22,1,"PAH",1,1,0)
^^1^1^3050916
"PKG",170,22,1,"PAH",1,1,1,0)
PFP PSO*7.0*221 UPDATE TO PSO*7.0*174
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSOMGCOM")
0^1^B20999263
"RTN","PSOMGCOM",1,0)
PSOMGCOM ;BHAM ISC/JMB,SAB - management compile/recompile routine ;9/13/05 8:54am
"RTN","PSOMGCOM",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**20,28,174,221**;DEC 1997
"RTN","PSOMGCOM",3,0)
 ;External Ref. to ELIG^VADPT is supp. by DBIA# 10061
"RTN","PSOMGCOM",4,0)
 ;External Ref. to ^PSDRUG( is supp. by DBIA# 221
"RTN","PSOMGCOM",5,0)
COM1 D:DA=0 ORI D:DA>0 REF Q:'$D(^PSRX(REC,1,DA,0))&(DA>0)  D STA
"RTN","PSOMGCOM",6,0)
 Q
"RTN","PSOMGCOM",7,0)
ORI Q:'$D(^PSRX(REC,0))  S RX0=^PSRX(REC,0),DV=$S($P($G(^PSRX(REC,2)),"^",9):$P(^PSRX(REC,2),"^",9),1:$O(^PS(59,0)))
"RTN","PSOMGCOM",8,0)
 S NEW(DV)=NEW(DV)+1 S:$P(RX0,"^",11)="W" WIND(DV)=WIND(DV)+1 S:$P(RX0,"^",11)="M" MAIL(DV)=MAIL(DV)+1 S DATE=$P(^PSRX(REC,0),"^",2)-.01
"RTN","PSOMGCOM",9,0)
 S COST=$P(RX0,"^",7)*$S(+$P(RX0,"^",17):$P(RX0,"^",17),1:+$P($G(^PSDRUG(+$P(RX0,"^",6),660)),"^",6))
"RTN","PSOMGCOM",10,0)
 D DAYS Q
"RTN","PSOMGCOM",11,0)
DAYS S TFIL=TFIL+1,TFCT=TFCT+COST,EQCOST(DV)=EQCOST(DV)+COST I DAYS<31 S QTY30(DV)=QTY30(DV)+1 Q
"RTN","PSOMGCOM",12,0)
 I DAYS>30&(DAYS<61) S QTY60(DV)=QTY60(DV)+1 Q
"RTN","PSOMGCOM",13,0)
 I DAYS>60&(DAYS<91) S QTY90(DV)=QTY90(DV)+1 Q
"RTN","PSOMGCOM",14,0)
 I DAYS>90&(DAYS<120) S QTY120(DV)=QTY120(DV)+1 Q
"RTN","PSOMGCOM",15,0)
 I DAYS>120&(DAYS<180) S QTY179(DV)=QTY179(DV)+1 Q
"RTN","PSOMGCOM",16,0)
 I DAYS=180 S QTY180(DV)=QTY180(DV)+1
"RTN","PSOMGCOM",17,0)
 Q
"RTN","PSOMGCOM",18,0)
REF Q:'$D(^PSRX(REC,1,DA,0))  S RXF=^PSRX(REC,1,DA,0),DV=$S($P(RXF,"^",9):$P(RXF,"^",9),1:$O(^PS(59,0))),REF(DV)=REF(DV)+1 S:$P(RXF,"^",2)="W" WIND(DV)=WIND(DV)+1 S:$P(RXF,"^",2)="M" MAIL(DV)=MAIL(DV)+1 S DATE=$P(^PSRX(REC,1,DA,0),"^")-.01
"RTN","PSOMGCOM",19,0)
 S COST=$P(RXF,"^",4)*$S($P(RXF,"^",11):$P(RXF,"^",11),1:+$P($G(^PSDRUG(+$P(^PSRX(REC,0),"^",6),660)),"^",6)) D DAYS
"RTN","PSOMGCOM",20,0)
 Q
"RTN","PSOMGCOM",21,0)
CLE F DV=0:0 S DV=$O(^PS(59,DV)) Q:'+DV  D
"RTN","PSOMGCOM",22,0)
 .S METHAD(DV)=$S($D(^PS(59,DV,5)):$P(^PS(59,DV,5),"^",2),1:0)
"RTN","PSOMGCOM",23,0)
 .S (CATA(DV),CATC(DV),OTH(DV),CAT(DV),CATCOST(DV),QTY30(DV),QTY60(DV),QTY90(DV),QTY120(DV),QTY179(DV),QTY180(DV),EQFL(DV),EQCOST(DV))=0
"RTN","PSOMGCOM",24,0)
 .S (METH(DV),METHCOST(DV),PCPP(DV),PP(DV),PPCOST(DV),PREQ(DV),FEE(DV),FCOST(DV),STAFF(DV),STCOST(DV),NEW(DV),REF(DV),WIND(DV),MAIL(DV),INV(DV))=0
"RTN","PSOMGCOM",25,0)
 S (TFIL,TFTY,TFCT)=0 Q
"RTN","PSOMGCOM",26,0)
STA S:$P($G(^PSDRUG(+$P(^PSRX(REC,0),"^",6),0)),"^",3)["I" INV(DV)=INV(DV)+1
"RTN","PSOMGCOM",27,0)
 I $D(METHAD(DV)),DRUG=METHAD(DV) S METH(DV)=METH(DV)+1,METHCOST(DV)=METHCOST(DV)+COST
"RTN","PSOMGCOM",28,0)
 E  K PCAT D CAT
"RTN","PSOMGCOM",29,0)
 I $P($G(^VA(200,+$G(PHYS),"PS")),"^",6)=4 S FEE(DV)=FEE(DV)+1,FCOST(DV)=FCOST(DV)+COST
"RTN","PSOMGCOM",30,0)
 E  S STAFF(DV)=STAFF(DV)+1,STCOST(DV)=STCOST(DV)+COST
"RTN","PSOMGCOM",31,0)
 I '$D(^TMP($J,DV,DFN)) S ^TMP($J,DV,DFN)=$G(PCAT),PREQ(DV)=PREQ(DV)+1
"RTN","PSOMGCOM",32,0)
 Q
"RTN","PSOMGCOM",33,0)
CAT I '$D(^TMP($J,DV,DFN)) D ELIG^VADPT S PCAT=$P($G(VAEL(9)),"^"),CATCOST(DV)=CATCOST(DV)+COST S:PCAT="A" CATA(DV)=CATA(DV)+1 S:PCAT="C" CATC(DV)=CATC(DV)+1 S:PCAT'="A"&(PCAT'="C") OTH(DV)=OTH(DV)+1 Q
"RTN","PSOMGCOM",34,0)
 S PCAT=$G(^TMP($J,DV,DFN)),CATCOST(DV)=CATCOST(DV)+COST S:PCAT="A" CATA(DV)=CATA(DV)+1 S:PCAT="C" CATC(DV)=CATC(DV)+1 S:PCAT'="A"&(PCAT'="C") OTH(DV)=OTH(DV)+1 Q
"RTN","PSOMGCOM",35,0)
BUILD ;SET GLOBAL NODE
"RTN","PSOMGCOM",36,0)
 F DV=0:0 S DV=$O(^PS(59,DV)) Q:'+DV  D BLD
"RTN","PSOMGCOM",37,0)
 Q
"RTN","PSOMGCOM",38,0)
BLD S EQFL(DV)=QTY30(DV)+(QTY60(DV)*2)+(QTY90(DV)*3)+(QTY120(DV)*4)+(QTY179(DV)*5)+(QTY180(DV)*6)
"RTN","PSOMGCOM",39,0)
 S CAT(DV)=CATA(DV)+CATC(DV)+OTH(DV)
"RTN","PSOMGCOM",40,0)
 S RXPREQ(DV)=$FN($S(CAT(DV)=0!(PREQ(DV)=0):0,1:CAT(DV)/PREQ(DV)),"",1)
"RTN","PSOMGCOM",41,0)
 S EQPREQ(DV)=$FN($S(EQFL(DV)=0!(PREQ(DV)=0):0,1:EQFL(DV)/PREQ(DV)),"",0)
"RTN","PSOMGCOM",42,0)
 S NODE1=EQFL(DV)_"^"_METH(DV)_"^"_(NEW(DV)+REF(DV))_"^"_(EQFL(DV)+METH(DV))_"^"_PREQ(DV)_"^"_RXPREQ(DV)_"^"_EQPREQ(DV)_"^"_INV(DV)
"RTN","PSOMGCOM",43,0)
 S ^PS(59.12,PDATE,1,DV,0)=DV_"^"_CATA(DV)_"^"_CATC(DV)_"^"_OTH(DV)_"^"_CAT(DV)_"^"_QTY30(DV)_"^"_QTY60(DV)_"^"_QTY90(DV)_"^^"_NODE1
"RTN","PSOMGCOM",44,0)
 ;
"RTN","PSOMGCOM",45,0)
 S COSTPST(DV)=$FN($S(STCOST(DV)=0!(STAFF(DV)=0):0,1:STCOST(DV)/STAFF(DV)),"",2)
"RTN","PSOMGCOM",46,0)
 S ^PS(59.12,PDATE,2,DV,0)=DV_"^^"_FEE(DV)_"^"_STAFF(DV)_"^"_(FEE(DV)+STAFF(DV))_"^"_NEW(DV)_"^"_REF(DV)_"^"_(NEW(DV)+REF(DV))_"^"_WIND(DV)_"^"_MAIL(DV)_"^"_(WIND(DV)+MAIL(DV))_"^^"_PP(DV)_"^"_PCPP(DV)
"RTN","PSOMGCOM",47,0)
 ;
"RTN","PSOMGCOM",48,0)
 S AVGFEE(DV)=$FN($S(FCOST(DV)=0!(FEE(DV)=0):0,1:FCOST(DV)/FEE(DV)),"",2)
"RTN","PSOMGCOM",49,0)
 S AVGST(DV)=$FN($S(STCOST(DV)=0!(STAFF(DV)=0):0,1:STCOST(DV)/STAFF(DV)),"",2)
"RTN","PSOMGCOM",50,0)
 S AVGCAT(DV)=$FN($S(CATCOST(DV)=0!(CAT(DV)=0):0,1:CATCOST(DV)/CAT(DV)),"",2)
"RTN","PSOMGCOM",51,0)
 S AVGEQFL(DV)=$FN($S(EQCOST(DV)=0!(EQFL(DV)=0):0,1:(EQCOST(DV)-METHCOST(DV)/EQFL(DV))),"",2)
"RTN","PSOMGCOM",52,0)
 S AVGMETH(DV)=$FN($S(METHCOST(DV)=0!(METH(DV)=0):0,1:METHCOST(DV)/METH(DV)),"",2)
"RTN","PSOMGCOM",53,0)
 S ^PS(59.12,PDATE,3,DV,0)=DV_"^"_AVGST(DV)_"^"_AVGFEE(DV)_"^"_AVGCAT(DV)_"^"_AVGEQFL(DV)_"^"_AVGMETH(DV)_"^"_$FN((CATCOST(DV)+METHCOST(DV)),"",2)_"^"_$FN(METHCOST(DV),"",2)_"^0.00^0.00"
"RTN","PSOMGCOM",54,0)
 Q
"VER")
8.0^22.0
"BLD",6090,6)
^SEQ #192
**END**
**END**
