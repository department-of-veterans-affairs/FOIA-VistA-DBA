EMERGENCY Released PRCA*4.5*255 SEQ #227
Extracted from mail message
**KIDS**:PRCA*4.5*255^

**INSTALL NAME**
PRCA*4.5*255
"BLD",7441,0)
PRCA*4.5*255^ACCOUNTS RECEIVABLE^0^3071018^y
"BLD",7441,1,0)
^^2^2^3071018^
"BLD",7441,1,1,0)
This patch will update the deposit ticket number series with
"BLD",7441,1,2,0)
"569"xxx for the EDI Lockbox process.
"BLD",7441,4,0)
^9.64PA^344.3^1
"BLD",7441,4,344.3,0)
344.3
"BLD",7441,4,344.3,2,0)
^9.641^344.3^1
"BLD",7441,4,344.3,2,344.3,0)
EDI LOCKBOX DEPOSIT  (File-top level)
"BLD",7441,4,344.3,2,344.3,1,0)
^9.6411^.03^1
"BLD",7441,4,344.3,2,344.3,1,.03,0)
AR DEPOSIT RECORD
"BLD",7441,4,344.3,222)
y^n^p^^^^n^^n
"BLD",7441,4,344.3,224)

"BLD",7441,4,"APDD",344.3,344.3)

"BLD",7441,4,"APDD",344.3,344.3,.03)

"BLD",7441,4,"B",344.3,344.3)

"BLD",7441,6.3)
1
"BLD",7441,"KRN",0)
^9.67PA^8989.52^19
"BLD",7441,"KRN",.4,0)
.4
"BLD",7441,"KRN",.401,0)
.401
"BLD",7441,"KRN",.402,0)
.402
"BLD",7441,"KRN",.403,0)
.403
"BLD",7441,"KRN",.5,0)
.5
"BLD",7441,"KRN",.84,0)
.84
"BLD",7441,"KRN",3.6,0)
3.6
"BLD",7441,"KRN",3.8,0)
3.8
"BLD",7441,"KRN",9.2,0)
9.2
"BLD",7441,"KRN",9.8,0)
9.8
"BLD",7441,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",7441,"KRN",9.8,"NM",1,0)
RCDPESR3^^0^B57443767
"BLD",7441,"KRN",9.8,"NM",2,0)
RCDPEM^^0^B54871682
"BLD",7441,"KRN",9.8,"NM","B","RCDPEM",2)

"BLD",7441,"KRN",9.8,"NM","B","RCDPESR3",1)

"BLD",7441,"KRN",19,0)
19
"BLD",7441,"KRN",19.1,0)
19.1
"BLD",7441,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",7441,"KRN",101,0)
101
"BLD",7441,"KRN",409.61,0)
409.61
"BLD",7441,"KRN",771,0)
771
"BLD",7441,"KRN",870,0)
870
"BLD",7441,"KRN",8989.51,0)
8989.51
"BLD",7441,"KRN",8989.52,0)
8989.52
"BLD",7441,"KRN",8994,0)
8994
"BLD",7441,"KRN","B",.4,.4)

"BLD",7441,"KRN","B",.401,.401)

"BLD",7441,"KRN","B",.402,.402)

"BLD",7441,"KRN","B",.403,.403)

"BLD",7441,"KRN","B",.5,.5)

"BLD",7441,"KRN","B",.84,.84)

"BLD",7441,"KRN","B",3.6,3.6)

"BLD",7441,"KRN","B",3.8,3.8)

"BLD",7441,"KRN","B",9.2,9.2)

"BLD",7441,"KRN","B",9.8,9.8)

"BLD",7441,"KRN","B",19,19)

"BLD",7441,"KRN","B",19.1,19.1)

"BLD",7441,"KRN","B",101,101)

"BLD",7441,"KRN","B",409.61,409.61)

"BLD",7441,"KRN","B",771,771)

"BLD",7441,"KRN","B",870,870)

"BLD",7441,"KRN","B",8989.51,8989.51)

"BLD",7441,"KRN","B",8989.52,8989.52)

"BLD",7441,"KRN","B",8994,8994)

"BLD",7441,"QUES",0)
^9.62^^
"BLD",7441,"REQB",0)
^9.611^1^1
"BLD",7441,"REQB",1,0)
PRCA*4.5*208^2
"BLD",7441,"REQB","B","PRCA*4.5*208",1)

"FIA",344.3)
EDI LOCKBOX DEPOSIT
"FIA",344.3,0)
^RCY(344.3,
"FIA",344.3,0,0)
344.3I
"FIA",344.3,0,1)
y^n^p^^^^n^^n
"FIA",344.3,0,10)

"FIA",344.3,0,11)

"FIA",344.3,0,"RLRO")

"FIA",344.3,0,"VR")
4.5^PRCA
"FIA",344.3,344.3)
1
"FIA",344.3,344.3,.03)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
255^3071018
"PKG",142,22,1,"PAH",1,1,0)
^^2^2^3071018
"PKG",142,22,1,"PAH",1,1,1,0)
This patch will update the deposit ticket number series with
"PKG",142,22,1,"PAH",1,1,2,0)
"569"xxx for the EDI Lockbox process.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","RCDPEM")
0^2^B54871682^B54610957
"RTN","RCDPEM",1,0)
RCDPEM ;ALB/TMK - POST EFT, ERA MATCHING TO EFT ;05-NOV-02
"RTN","RCDPEM",2,0)
 ;;4.5;Accounts Receivable;**173,255**;Mar 20, 1995;Build 1
"RTN","RCDPEM",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCDPEM",4,0)
 ; IA 4050 covers call to SPL1^IBCEOBAR
"RTN","RCDPEM",5,0)
 Q
"RTN","RCDPEM",6,0)
 ; Note - keep processing in line with RCDPXPAP 
"RTN","RCDPEM",7,0)
EN ; Post EFT deposits, auto-match EFT's and ERA's 
"RTN","RCDPEM",8,0)
 ;
"RTN","RCDPEM",9,0)
 K ^TMP($J,"RCDPETOT")
"RTN","RCDPEM",10,0)
 ; ^TMP($J,"RCDPETOT",344.3 or 344.31,file ien)=
"RTN","RCDPEM",11,0)
 ;  (1) match (0/1/-1)   (2) total $   (3) posted (0/1)  (4) error ref
"RTN","RCDPEM",12,0)
 ;  (5) EFT deposit ien 344.1 if added for EFT
"RTN","RCDPEM",13,0)
 ;
"RTN","RCDPEM",14,0)
 N RCZ,RCSUM,RCDEP,RECTDA,RC0,RCER,RCDUZ,Z,Z0,Z1,DA,X,Y,DIE,DR
"RTN","RCDPEM",15,0)
 M RCDUZ=DUZ
"RTN","RCDPEM",16,0)
 N DUZ S DUZ=+$O(^VA(200,"B","EDILOCKBOX,AUTOMATIC",0)),DUZ(0)="" S:'DUZ DUZ=.5
"RTN","RCDPEM",17,0)
 K ^TMP($J,"RCXM"),^TMP($J,"RCTOT")
"RTN","RCDPEM",18,0)
 S ZTREQ="@"
"RTN","RCDPEM",19,0)
 L +^RCY(344.3,"ALOCK"):5 I '$T D  G ENQ ; Lock record
"RTN","RCDPEM",20,0)
 . ; Send bulletin that job could not be run
"RTN","RCDPEM",21,0)
 . S ^TMP($J,"RCXM",1)="The nightly job to post EFT deposits and match EFTs to ERAs could not be run",^TMP($J,"RCXM",2)="Another match process was already running (lock on ^RCY(344.3,""ALOCK"") )"
"RTN","RCDPEM",22,0)
 . D SENDBULL^RCDPEM1
"RTN","RCDPEM",23,0)
 ;
"RTN","RCDPEM",24,0)
 ; Post deposits for any unposted EFTs in file 344.3
"RTN","RCDPEM",25,0)
 ; 'Unposted' EFTs have a 0 in AMOUNT POSTED field
"RTN","RCDPEM",26,0)
 S ^TMP($J,"RCTOT","EFT_DEP")=0
"RTN","RCDPEM",27,0)
 S RCZ=0 F  S RCZ=$O(^RCY(344.3,"APOST",0,RCZ)) Q:'RCZ  S RC0=$G(^RCY(344.3,RCZ,0))  I RC0'="",$P(RC0,U,8),($E($P(RC0,U,6),1,3)="469")!($E($P(RC0,U,6),1,3)="569") D
"RTN","RCDPEM",28,0)
 . S ^TMP($J,"RCTOT","EFT_DEP")=^TMP($J,"RCTOT","EFT_DEP")+1
"RTN","RCDPEM",29,0)
 . ; Verify check sums
"RTN","RCDPEM",30,0)
 . S RCSUM=$$CHKSUM^RCDPESR3(RCZ)
"RTN","RCDPEM",31,0)
 . I RCSUM'=$P(RC0,U,9) D  Q
"RTN","RCDPEM",32,0)
 .. ; Bulletin that check sums do not match
"RTN","RCDPEM",33,0)
 .. ; Update record error list and checksum error field
"RTN","RCDPEM",34,0)
 .. S RCER(1)=$$SETERR^RCDPEM0(2)
"RTN","RCDPEM",35,0)
 .. S RCER(2)="  Checksum is invalid and the EFT deposit record is corrupted.",RCER(3)="  Stored Checksum = "_$P(RC0,U,9)_" Calculated Checksum: "_RCSUM,RCER(4)="  This EFT deposit cannot be sent to FMS.  You must ask for it to be"
"RTN","RCDPEM",36,0)
 .. S RCER(5)="   retransmitted to your site."
"RTN","RCDPEM",37,0)
 .. D BULL^RCDPEM1(344.3,RC0,.RCER)
"RTN","RCDPEM",38,0)
 .. S $P(^TMP($J,"RCDPETOT",344.3,RCZ),U,4)=+$G(^TMP($J,"RCXM",0))
"RTN","RCDPEM",39,0)
 .. D STORERR^RCDPEM0(RCZ,.RCER)
"RTN","RCDPEM",40,0)
 .. S DIE="^RCY(344.3,",DA=RCZ,DR=".1////1" D ^DIE
"RTN","RCDPEM",41,0)
 .. S ^TMP($J,"RCTOT","CSUM")=$G(^TMP($J,"RCTOT","CSUM"))+1
"RTN","RCDPEM",42,0)
 . ;
"RTN","RCDPEM",43,0)
 . S RCDEP=+$P(RC0,U,3),RECTDA=+$O(^RCY(344,"AD",RCDEP,0))
"RTN","RCDPEM",44,0)
 . I RCDEP D LOCKDEP(RCDEP,1)
"RTN","RCDPEM",45,0)
 . I 'RCDEP!'RECTDA D  ;  Add deposit and/or receipt to files 344.1, 344
"RTN","RCDPEM",46,0)
 .. I 'RCDEP D  ; Add dep record RCDEP, update field .03 with the pointer
"RTN","RCDPEM",47,0)
 ... S RCDEP=+$$ADDDEP^RCDPEM0($P(RC0,U,6),$P(RC0,U,7),RCZ)
"RTN","RCDPEM",48,0)
 ... S ^TMP($J,"RCTOT","DEPOSIT")=$G(^TMP($J,"RCTOT","DEPOSIT"))+1
"RTN","RCDPEM",49,0)
 .. ;
"RTN","RCDPEM",50,0)
 .. I 'RECTDA,RCDEP D  ; Add receipt record, post to rev source cd 8NZZ
"RTN","RCDPEM",51,0)
 ... S RECTDA=+$$ADDREC^RCDPEM0(RCDEP,RCZ)
"RTN","RCDPEM",52,0)
 .. ;
"RTN","RCDPEM",53,0)
 . I RCDEP D LOCKDEP(RCDEP,0)
"RTN","RCDPEM",54,0)
 . ;
"RTN","RCDPEM",55,0)
 . I 'RCDEP!'RECTDA D  Q  ; Could not add entry to file 344.1 or 344 
"RTN","RCDPEM",56,0)
 .. ; Send a bulletin, update error text
"RTN","RCDPEM",57,0)
 .. S RCER(1)=$$SETERR^RCDPEM0(2),RCER(2)="  "_$S('RCDEP:"Neither a deposit nor a receipt were able",1:"A receipt was not able")_" to be added - no match attempted"
"RTN","RCDPEM",58,0)
 .. I RCDEP,'RECTDA S RCER(3)="  Deposit Ticket # created: "_$P($G(^RCY(344.1,+$P(RC0,U,3),0)),U)
"RTN","RCDPEM",59,0)
 .. S RCER($O(RCER(""),-1)+1)="This EFT deposit can't be sent to FMS.  You must ask Austin to retransmit"
"RTN","RCDPEM",60,0)
 .. D BULL^RCDPEM1(344.3,RC0,.RCER)
"RTN","RCDPEM",61,0)
 .. S $P(^TMP($J,"RCDPETOT",344.3,RCZ),U,4)=+$G(^TMP($J,"RCXM",0))
"RTN","RCDPEM",62,0)
 .. D STORERR^RCDPEM0(RCZ,.RCER)
"RTN","RCDPEM",63,0)
 .. S ^TMP($J,"RCTOT","ERR")=$G(^TMP($J,"RCTOT","ERR"))+1
"RTN","RCDPEM",64,0)
 . ;
"RTN","RCDPEM",65,0)
 . S DIE="^RCY(344.31," S Z=0 F  S Z=$O(^RCY(344.31,"B",RCZ,Z)) Q:'Z  S DA=Z,DR=".11////1" D ^DIE
"RTN","RCDPEM",66,0)
 ;
"RTN","RCDPEM",67,0)
 D MATCH(0,1)
"RTN","RCDPEM",68,0)
 L -^RCY(344.3,"ALOCK")
"RTN","RCDPEM",69,0)
ENQ K ^TMP($J,"RCDPETOT")
"RTN","RCDPEM",70,0)
 Q
"RTN","RCDPEM",71,0)
 ;
"RTN","RCDPEM",72,0)
MATCH(RCMAN,RCPROC) ; Try to matched unmatched EFTs
"RTN","RCDPEM",73,0)
 ; RCMAN = 1 if job run manually, outside of nightly processing
"RTN","RCDPEM",74,0)
 ; RCPROC = 1 if called from EFT-EOB automatch, 0 if from manual match
"RTN","RCDPEM",75,0)
 ;
"RTN","RCDPEM",76,0)
 N RC0,RCER,RCZ,RCHAC
"RTN","RCDPEM",77,0)
 I '$O(^RCY(344.31,"AMATCH",0,0)) D  G MATCHQ
"RTN","RCDPEM",78,0)
 . ; Send bulletin - no unmatched EFTs found
"RTN","RCDPEM",79,0)
 . N RCT
"RTN","RCDPEM",80,0)
 . S RCT=+$O(^TMP($J,"RCXM"," "),-1)+1
"RTN","RCDPEM",81,0)
 . S ^TMP($J,"RCXM",RCT)=$S('$G(RCMAN):"The nightly job",1:"The manual option")_" to match EFTs has found no EFTs are currently unmatched on your system"
"RTN","RCDPEM",82,0)
 . I $G(RCMAN) S ^TMP($J,"RCXM",RCT+1)="The action was initiated by "_$P($G(^VA(200,DUZ,0)),U)
"RTN","RCDPEM",83,0)
 . D SENDBULL^RCDPEM1
"RTN","RCDPEM",84,0)
 ;
"RTN","RCDPEM",85,0)
 S RCZ=0 F  S RCZ=$O(^RCY(344.31,"AMATCH",0,RCZ)) Q:'RCZ  D
"RTN","RCDPEM",86,0)
 . K RCER
"RTN","RCDPEM",87,0)
 . S RC0=$G(^RCY(344.31,RCZ,0)),RCHAC=($E($P($G(^RCY(344.3,+RC0,0)),U,6),1,3)="HAC")
"RTN","RCDPEM",88,0)
 . Q:RC0=""  ; Bad xref
"RTN","RCDPEM",89,0)
 . Q:$S('RCHAC:'$P(RC0,U,11),1:0)  ; EFT deposit must have been recorded
"RTN","RCDPEM",90,0)
 . S ^TMP($J,"RCTOT","EFT")=$G(^TMP($J,"RCTOT","EFT"))+1
"RTN","RCDPEM",91,0)
 . I RCHAC S ^TMP($J,"RCTOT","EFT_HAC")=$G(^TMP($J,"RCTOT","EFT_HAC"))+1
"RTN","RCDPEM",92,0)
 . S ^TMP($J,"RCDPETOT",344.31,RCZ)=""
"RTN","RCDPEM",93,0)
 . ;
"RTN","RCDPEM",94,0)
 . D MATCH^RCDPEM0(RCZ,RCPROC)
"RTN","RCDPEM",95,0)
 ;
"RTN","RCDPEM",96,0)
 I '$O(^TMP($J,"RCXM",0)) K RCER S RCER(1)="",RCER(2)="NO EXCEPTIONS WHILE MATCHING EFTs-ERAs OR IN RECORDING THE DEPOSITS TO FMS" D BULL^RCDPEM1("","",.RCER) K RCER
"RTN","RCDPEM",97,0)
 D EN2^RCDPEM1,BULL^RCDPEM1("","",.RCER)
"RTN","RCDPEM",98,0)
 D SENDBULL^RCDPEM1
"RTN","RCDPEM",99,0)
 ;
"RTN","RCDPEM",100,0)
MATCHQ K ^TMP($J,"RCDPETOT"),^TMP($J,"RCTOT")
"RTN","RCDPEM",101,0)
 Q
"RTN","RCDPEM",102,0)
 ;
"RTN","RCDPEM",103,0)
LOCKDEP(RCDEP,LOCK) ; Lock/confirm deposit ien RCDEP file 341.1
"RTN","RCDPEM",104,0)
 ; If LOCK = 1 lock deposit
"RTN","RCDPEM",105,0)
 ; If LOCK = 0 unlock deposit
"RTN","RCDPEM",106,0)
 I $G(LOCK) D
"RTN","RCDPEM",107,0)
 . L +^RCY(344.1,RCDEP,0)
"RTN","RCDPEM",108,0)
 . D CONFIRM^RCDPUDEP(RCDEP) ; confirm to prevent changes
"RTN","RCDPEM",109,0)
 I '$G(LOCK) L -^RCY(344.1,RCDEP,0)
"RTN","RCDPEM",110,0)
 Q
"RTN","RCDPEM",111,0)
 ;
"RTN","RCDPEM",112,0)
RCPTDET(RCRZ,RECTDA1,RCER) ; Adds detail to a receipt based on file 344.49
"RTN","RCDPEM",113,0)
 ; RCRZ = ien of ERA entry in file 344.49
"RTN","RCDPEM",114,0)
 ; RECTDA1 = ien of receipt entry in file 344
"RTN","RCDPEM",115,0)
 ; RCER = error array returned if passed by reference
"RTN","RCDPEM",116,0)
 ;
"RTN","RCDPEM",117,0)
 N RCR,RCSPL,RCZ0,RCTRANDA,RCQ,DR,DA,DIE,X,Y,Q,Z0,Z1,Z
"RTN","RCDPEM",118,0)
 ;
"RTN","RCDPEM",119,0)
 S RCR=0 F  S RCR=$O(^RCY(344.49,RCRZ,1,RCR)) Q:'RCR  D
"RTN","RCDPEM",120,0)
 . S RCZ0=$G(^RCY(344.49,RCRZ,1,RCR,0))
"RTN","RCDPEM",121,0)
 . I $P(RCZ0,U)'["." S RCSPL(+RCZ0)=$P(RCZ0,U,9) Q
"RTN","RCDPEM",122,0)
 . I $S(+$P(RCZ0,U,3)=0:$P($G(^RCY(344.49,RCRZ,0)),U,3),1:$P(RCZ0,U,3)<0) S RCSPL(RCZ0\1,+RCZ0)=RCZ0 Q
"RTN","RCDPEM",123,0)
 . S RCTRANDA=$$ADDTRAN^RCDPURET(RECTDA1)
"RTN","RCDPEM",124,0)
 . ;
"RTN","RCDPEM",125,0)
 . I 'RCTRANDA D  Q  ; Error adding receipt detail
"RTN","RCDPEM",126,0)
 .. S RCER(1)=$$SETERR^RCDPEM0() S RCER($O(RCER(""),-1)+1)="  NO DETAIL LINE ADDED TO RECEIPT "_$P($G(^RCY(344,RECTDA1,0)),U)_" FOR LINE #"_$P(RCZ0,U)_" IN EEOB WORKLIST SCRATCH PAD"
"RTN","RCDPEM",127,0)
 . ;
"RTN","RCDPEM",128,0)
 . ;Store receipt line detail
"RTN","RCDPEM",129,0)
 . D DET(RCRZ,RCR,RECTDA1,RCTRANDA)
"RTN","RCDPEM",130,0)
 . S RCSPL(RCZ0\1,+RCZ0)=RCZ0
"RTN","RCDPEM",131,0)
 S Z=0 F  S Z=$O(RCSPL(Z)) Q:'Z  S RCQ=+$G(RCSPL(Z)) I RCQ D
"RTN","RCDPEM",132,0)
 . S Z1=$O(RCSPL(Z,"")) Q:$O(RCSPL(Z,""),-1)=Z1  ; No split occurred
"RTN","RCDPEM",133,0)
 . S Z1=0 F  S Z1=$O(RCSPL(Z,Z1)) Q:'Z1  S Z0=$G(RCSPL(Z,Z1)) D
"RTN","RCDPEM",134,0)
 .. S Q=+$P($G(^RCY(344.4,RCRZ,1,RCQ,0)),U,2) ; EOB detail rec
"RTN","RCDPEM",135,0)
 .. Q:'Q
"RTN","RCDPEM",136,0)
 .. I '$P(Z0,U,7)!($P(Z0,U,2)="") D  ; Suspensed
"RTN","RCDPEM",137,0)
 ... D SPL1^IBCEOBAR(Q,$S($P(Z0,U,2)="":"NO BILL",1:$P(Z0,U,2)),"",$P(Z0,U,6)) ; IA 4050
"RTN","RCDPEM",138,0)
 .. E  D
"RTN","RCDPEM",139,0)
 ... D SPL1^IBCEOBAR(Q,$P(Z0,U,2),$P(Z0,U,7),$P(Z0,U,6)) ; Add the split bill # ; IA 4050
"RTN","RCDPEM",140,0)
 ;
"RTN","RCDPEM",141,0)
 Q
"RTN","RCDPEM",142,0)
 ;
"RTN","RCDPEM",143,0)
DET(RCZ,RCR,RECTDA1,RCTRANDA) ; Store receipt detail
"RTN","RCDPEM",144,0)
 ; RCZ = ien of entry file 344.49
"RTN","RCDPEM",145,0)
 ; RCR = ien of entry in file 344.491
"RTN","RCDPEM",146,0)
 ; RCPROC = Function calling this subroutine
"RTN","RCDPEM",147,0)
 ;        = 1 EFT match to ERA   = 0 manual add receipt
"RTN","RCDPEM",148,0)
 ; RECTDA1 = ien of entry in file 344
"RTN","RCDPEM",149,0)
 ; RCTRANDA = ien of entry in subfile 344.01
"RTN","RCDPEM",150,0)
 ;
"RTN","RCDPEM",151,0)
 N DIE,DA,DR,X,Y,Z,RCUP,RCCOM,RCZ0,RC0
"RTN","RCDPEM",152,0)
 S RC0=$G(^RCY(344.49,RCZ,0))
"RTN","RCDPEM",153,0)
 S RCZ0=$G(^RCY(344.49,RCZ,1,RCR,0))
"RTN","RCDPEM",154,0)
 S DR="",RCUP=+$O(^RCY(344.49,RCZ,1,"B",+RCZ0/1,0)),RCUP=$G(^RCY(344.49,RCZ,1,RCUP,0))
"RTN","RCDPEM",155,0)
 I $P(RCZ0,U,7) S DR=".09////^S X="_+$P(RCZ0,U,7)_"_$C(59)_""PRCA(430,"";"
"RTN","RCDPEM",156,0)
 S DR=DR_".04////"_(+$P(RCZ0,U,3))_";"_$S($P(RC0,U,4)'="":".13////"_$P(RC0,U,4)_";",1:"")_".27////"_RCR_";"
"RTN","RCDPEM",157,0)
 I $P(RC0,U,5)'="" S DR=DR_".1////"_$P(RC0,U,5)_";"
"RTN","RCDPEM",158,0)
 I $P(RC0,U,6)'="" S DR=DR_".08////"_$P(RC0,U,6)_";"
"RTN","RCDPEM",159,0)
 S RCCOM=$P(RCZ0,U,10)
"RTN","RCDPEM",160,0)
 S Z=0 F  S Z=$O(^RCY(344.49,RCZ,1,RCR,1,Z)) Q:'Z  I $P($G(^(Z,0)),U,5)=1 S DR=DR_".28////1;" Q  ; Update receipt line with dec adj flag
"RTN","RCDPEM",161,0)
 I $P(RCUP,U,2)["**ADJ" S DR=DR_"1.02////"_$E($S(RCCOM'="":RCCOM_"/",1:"")_$S($P($P(RCUP,U,2),"ADJ",2):"ERA adjustment - no bill referenced",1:"Total of EFT mismatched to ERA"),1,60)_";"
"RTN","RCDPEM",162,0)
 I $P($G(^RCY(344.49,RCZ,0)),U,4)'="" S DR=DR_".07////"_$P($G(^RCY(344.49,RCZ,0)),U,4)_";"
"RTN","RCDPEM",163,0)
 S DA(1)=RECTDA1,DA=RCTRANDA,DIE="^RCY(344,"_DA(1)_",1,"
"RTN","RCDPEM",164,0)
 D ^DIE
"RTN","RCDPEM",165,0)
 Q
"RTN","RCDPEM",166,0)
 ;
"RTN","RCDPESR3")
0^1^B57443767^B57118992
"RTN","RCDPESR3",1,0)
RCDPESR3 ;ALB/TMK - Server auto-update utilities - EDI Lockbox ;06/06/02
"RTN","RCDPESR3",2,0)
 ;;4.5;Accounts Receivable;**173,214,208,255**;Mar 20, 1995;Build 1
"RTN","RCDPESR3",3,0)
 Q
"RTN","RCDPESR3",4,0)
 ;
"RTN","RCDPESR3",5,0)
EFTIN(RCTXN,RCD,XMZ,RCGBL,RCEFLG) ; Adds a new EFT record to AR file 344.3
"RTN","RCDPESR3",6,0)
 ;  from Lockbox EFT msg
"RTN","RCDPESR3",7,0)
 ; RCTXN = the data on the header record of the message text
"RTN","RCDPESR3",8,0)
 ; RCD = array containing formatted mail message header data
"RTN","RCDPESR3",9,0)
 ; XMZ = the mail message number
"RTN","RCDPESR3",10,0)
 ; RCGBL = the name of the array or global where the message is stored
"RTN","RCDPESR3",11,0)
 ; RCEFLG = error flag returned if passed by reference
"RTN","RCDPESR3",12,0)
 ;
"RTN","RCDPESR3",13,0)
 N CT,RC,RC1,RCLAST,RCEFT,RCTDA,RCERR,RCTYP1,DA,DIK,RCZ,Z,Z0,DLAYGO
"RTN","RCDPESR3",14,0)
 ;
"RTN","RCDPESR3",15,0)
 ; Take data out of mail message
"RTN","RCDPESR3",16,0)
 S (RCEFLG,RCLAST)=0,CT=0,RCTYP1="835EFT"
"RTN","RCDPESR3",17,0)
 F  X XMREC Q:XMER<0  D  Q:RCLAST
"RTN","RCDPESR3",18,0)
 . I +XMRG=99,$P(XMRG,U,2)="$" S RCLAST=1 Q
"RTN","RCDPESR3",19,0)
 . S:XMRG'="" CT=CT+1,@RCGBL@(2,"D",CT)=XMRG
"RTN","RCDPESR3",20,0)
 ;
"RTN","RCDPESR3",21,0)
 I 'RCLAST,'$G(RCERR) K @RCGBL S RCERR=2 ;No $ as last character of msg
"RTN","RCDPESR3",22,0)
 ;
"RTN","RCDPESR3",23,0)
 I $G(RCERR)>0 D  G EFTQ
"RTN","RCDPESR3",24,0)
 . D ERRUPD^RCDPESR1(RCGBL,.RCD,RCTYP1,.RCERR)
"RTN","RCDPESR3",25,0)
 . S RCEFLG=1
"RTN","RCDPESR3",26,0)
 ;
"RTN","RCDPESR3",27,0)
 ; Add top-level entry to file 344.3
"RTN","RCDPESR3",28,0)
 S RCEFT=$$ADDEFT(RCTXN,XMZ,RCGBL,.RCERR)
"RTN","RCDPESR3",29,0)
 ;
"RTN","RCDPESR3",30,0)
 I $G(RCERR) D  G EFTQ ; 'BAD' EFT's
"RTN","RCDPESR3",31,0)
 . D ERRUPD^RCDPESR1(RCGBL,.RCD,RCTYP1,.RCERR)
"RTN","RCDPESR3",32,0)
 . S RCEFLG=1
"RTN","RCDPESR3",33,0)
 ;
"RTN","RCDPESR3",34,0)
 G:'RCEFT EFTQ
"RTN","RCDPESR3",35,0)
 ;
"RTN","RCDPESR3",36,0)
 ; Add the detail data to file 344.31 for this EFT record
"RTN","RCDPESR3",37,0)
 S Z=0 F  S Z=$O(^RCY(344.31,"B",RCEFT,Z)) Q:'Z  S DA=Z,DIK="^RCY(344.31," D ^DIK ; Delete any detail data already there
"RTN","RCDPESR3",38,0)
 ;
"RTN","RCDPESR3",39,0)
 S (RC,RC1,RCZ)=0
"RTN","RCDPESR3",40,0)
 F  S RCZ=$O(@RCGBL@(2,"D",RCZ)) Q:'RCZ  S Z0=$G(^(RCZ)) I Z0'="" D  Q:$G(RCERR)
"RTN","RCDPESR3",41,0)
 . I $P(Z0,U)="01" D  ; Each payer's data
"RTN","RCDPESR3",42,0)
 .. N DA,DIE,DR,X,Y,DO,DD,DIC
"RTN","RCDPESR3",43,0)
 .. S X=RCEFT
"RTN","RCDPESR3",44,0)
 .. S DIC("DR")=".11////0;.04////"_$P(Z0,U,2)_";.08////0"_$S($P(Z0,U,5)'="":";.02////"_$P(Z0,U,5),1:"")_$S($P(Z0,U,6)'="":";.03////"_$P(Z0,U,6),1:"")_";.07////"_$J(+$P(Z0,U,4)/100,"",2)_";.06////"_$S($P(Z0,U,8)'="":1,1:0)
"RTN","RCDPESR3",45,0)
 .. S DIC("DR")=DIC("DR")_";.12///"_$$FDT^RCDPESR9($P(Z0,U,3))_";.13////"_DT_$S($P(Z0,U,7)'="":";.05////"_$P(Z0,U,7),1:"")_$S($P(Z0,U,9)'="":";.15////"_$P(Z0,U,9),1:"")
"RTN","RCDPESR3",46,0)
 .. ;
"RTN","RCDPESR3",47,0)
 .. I $P(Z0,U,8)'="" D  ; tax id error
"RTN","RCDPESR3",48,0)
 ... D TAXERR^RCDPESR1("EFT",$P(Z0,U,5)_"  Payer ID: "_$P(RCTXN,U,6),$P(RCTXN,U,7),$P(RCTXN,U,8)) ; Send bad tax id bulletin
"RTN","RCDPESR3",49,0)
 .. ;
"RTN","RCDPESR3",50,0)
 .. S DIC(0)="L",DIC="^RCY(344.31,",DLAYGO=344.31 D FILE^DICN K DIC,DLAYGO,DO,DD
"RTN","RCDPESR3",51,0)
 .. I Y'>0 D  ; Error filing data
"RTN","RCDPESR3",52,0)
 ... S DIK="^RCY(344.3,",DA=RCEFT D ^DIK
"RTN","RCDPESR3",53,0)
 ... S Z=0 F  S Z=$O(^RCY(344.31,"B",RCEFT,Z)) Q:'Z  S DIK="^RCY(344.31,",DA=Z D ^DIK
"RTN","RCDPESR3",54,0)
 ... S RCEFLG=1,RCERR=3
"RTN","RCDPESR3",55,0)
 ... D ERRUPD^RCDPESR1(RCGBL,.RCD,RCTYP1,RCERR)
"RTN","RCDPESR3",56,0)
 ;
"RTN","RCDPESR3",57,0)
 I '$G(RCEFLG) D
"RTN","RCDPESR3",58,0)
 . S DIE="^RCY(344.3,",DA=RCEFT,DR=".09////"_$$CHKSUM(RCEFT) D ^DIE
"RTN","RCDPESR3",59,0)
 ;
"RTN","RCDPESR3",60,0)
EFTQ ;
"RTN","RCDPESR3",61,0)
 D CLEAN^DILF
"RTN","RCDPESR3",62,0)
 Q
"RTN","RCDPESR3",63,0)
 ;
"RTN","RCDPESR3",64,0)
ADDEFT(RCTXN,RCXMZ,RCGBL,RCERR) ; File EFT TOTAL record in file 344.3
"RTN","RCDPESR3",65,0)
 ; RCTXN = the data on the header record of the message text
"RTN","RCDPESR3",66,0)
 ; RCXMZ = the mail message number
"RTN","RCDPESR3",67,0)
 ; RCGBL = the name of the array or global where the message is stored
"RTN","RCDPESR3",68,0)
 ; Function returns the ien of the total record found/added
"RTN","RCDPESR3",69,0)
 ;    and also returns RCERR if passed by reference
"RTN","RCDPESR3",70,0)
 ;
"RTN","RCDPESR3",71,0)
 N RCTDA,RCRCPT,RCDUP,RCHAC,Z,Z0
"RTN","RCDPESR3",72,0)
 S (RCERR,RCTDA)=""
"RTN","RCDPESR3",73,0)
 ;
"RTN","RCDPESR3",74,0)
 I $E($P(RCTXN,U,6),1,3)'="469",$E($P(RCTXN,U,6),1,3)'="569",$E($P(RCTXN,U,6),1,3)'="HAC" D  G ADDQ ; Invalid EFT deposit number
"RTN","RCDPESR3",75,0)
 . N RCDXM,RCCT
"RTN","RCDPESR3",76,0)
 . S RCCT=0
"RTN","RCDPESR3",77,0)
 . S RCCT=RCCT+1,RCDXM(RCCT)="This EFT has an invalid deposit number for EDI Lockbox and has been rejected.",RCCT=RCCT+1,RCDXM(RCCT)=" "
"RTN","RCDPESR3",78,0)
 . S RCCT=RCCT+1,RCDXM(RCCT)=" ",RCCT=RCCT+1,RCDXM(RCCT)="Here are the contents of this message:"
"RTN","RCDPESR3",79,0)
 . D DISP("EDI LBOX INVALID EFT DEPOSIT #",RCCT,.RCDXM,RCXMZ)
"RTN","RCDPESR3",80,0)
 ;
"RTN","RCDPESR3",81,0)
 ; Make sure it's not already there or if so, it has no ptr to a deposit
"RTN","RCDPESR3",82,0)
 ; or if a deposit exists, that the deposit does not yet have a receipt
"RTN","RCDPESR3",83,0)
 S RCDUP=0,RCHAC=$E($P(RCTXN,U,6),1,3)="HAC" ; This is a HAC deposit
"RTN","RCDPESR3",84,0)
 I $P(RCTXN,U,6)'="" D
"RTN","RCDPESR3",85,0)
 . S Z=0 ; Lookup deposit by deposit #
"RTN","RCDPESR3",86,0)
 . F  S Z=$O(^RCY(344.3,"C",$P(RCTXN,U,6),Z)) Q:'Z  S Z0=$G(^RCY(344.3,Z,0)) S:'$P(Z0,U,3) RCTDA=Z Q:RCTDA  D  Q
"RTN","RCDPESR3",87,0)
 .. ; Deposit found - find receipt
"RTN","RCDPESR3",88,0)
 .. I $O(^RCY(344,"AD",$P(Z0,U,3),0)) S RCDUP=Z Q
"RTN","RCDPESR3",89,0)
 .. S RCTDA=Z
"RTN","RCDPESR3",90,0)
 ;
"RTN","RCDPESR3",91,0)
 I RCDUP D  ; Send bulletin that duplicate EFT received
"RTN","RCDPESR3",92,0)
 . N RCDXM,RCCT
"RTN","RCDPESR3",93,0)
 . S RCCT=0
"RTN","RCDPESR3",94,0)
 . S RCCT=RCCT+1,RCDXM(RCCT)="This EFT appears to be a duplicate transaction and has been rejected.",RCCT=RCCT+1,RCDXM(RCCT)=" "
"RTN","RCDPESR3",95,0)
 . S RCCT=RCCT+1,RCDXM(RCCT)=" ",RCCT=RCCT+1,RCDXM(RCCT)="Here are the contents of this message:"
"RTN","RCDPESR3",96,0)
 . D DISP("EDI LBOX DUP EFT DEPOSIT RECEIVED",RCCT,.RCDXM,RCXMZ)
"RTN","RCDPESR3",97,0)
 ;
"RTN","RCDPESR3",98,0)
 I 'RCDUP D  ; Add or update the record
"RTN","RCDPESR3",99,0)
 . N RCX,RCDTTM,DIE,DIC,DLAYGO,DD,DA,DO,DR,X,Y,%DT,DINUM
"RTN","RCDPESR3",100,0)
 . ;
"RTN","RCDPESR3",101,0)
 . S X=$$FDT^RCDPESR9($P(RCTXN,U,3))_"@"_$P(RCTXN,U,4)
"RTN","RCDPESR3",102,0)
 . S %DT="XTS" D ^%DT S:Y>0 RCDTTM=Y
"RTN","RCDPESR3",103,0)
 . ;
"RTN","RCDPESR3",104,0)
 . S DIC("DR")=""
"RTN","RCDPESR3",105,0)
 . S DIC("DR")=$S(RCDTTM'="":".02////"_RCDTTM,1:"")
"RTN","RCDPESR3",106,0)
 . S DIC("DR")=DIC("DR")_$S(DIC("DR")'="":";",1:"")_".06////"_$P(RCTXN,U,6)_";.07///"_$$FDT^RCDPESR9($P(RCTXN,U,7))
"RTN","RCDPESR3",107,0)
 . S DIC("DR")=DIC("DR")_";.08////"_$$ZERO^RCDPESR9($P(RCTXN,U,8),1)_";.13////"_$$NOW^XLFDT()_";.05////"_RCXMZ_";.14////0;.12////0"
"RTN","RCDPESR3",108,0)
 . ;
"RTN","RCDPESR3",109,0)
 . I RCTDA D  ; Overwrite the data already there
"RTN","RCDPESR3",110,0)
 .. L +^RCY(344.3,RCTDA):1 I '$T S RCTDA=-1 Q
"RTN","RCDPESR3",111,0)
 .. S DIE="^RCY(344.3,",DA=RCTDA,DR=DIC("DR") K DIC D ^DIE
"RTN","RCDPESR3",112,0)
 .. L -^RCY(344.3,RCTDA)
"RTN","RCDPESR3",113,0)
 . ;
"RTN","RCDPESR3",114,0)
 . I 'RCTDA D
"RTN","RCDPESR3",115,0)
 .. S RCX=+$O(^RCY(344.3," "),-1)
"RTN","RCDPESR3",116,0)
 .. F RCX=RCX+1:1 I '$D(^RCY(344.3,RCX,0)) L +^RCY(344.3,RCX,0):1 I $T S X=RCX Q
"RTN","RCDPESR3",117,0)
 .. S DIC(0)="L",DIC="^RCY(344.3,",DLAYGO=344.3,DINUM=RCX
"RTN","RCDPESR3",118,0)
 .. D FILE^DICN K DO,DD,DLAYGO,DIC,DINUM
"RTN","RCDPESR3",119,0)
 .. L -^RCY(344.3,RCX,0)
"RTN","RCDPESR3",120,0)
 .. S RCTDA=$S(Y<0:"",1:+Y)
"RTN","RCDPESR3",121,0)
 . ;
"RTN","RCDPESR3",122,0)
 . I 'RCTDA S RCERR=3 ; Error in add of EFT record to file 344.3 
"RTN","RCDPESR3",123,0)
 ;
"RTN","RCDPESR3",124,0)
ADDQ Q $S(RCTDA>0:RCTDA,1:"")
"RTN","RCDPESR3",125,0)
 ;
"RTN","RCDPESR3",126,0)
CHKSUM(RCTDA) ; Calc the checksum for EFT record stored in RCTDA in 344.3
"RTN","RCDPESR3",127,0)
 ;
"RTN","RCDPESR3",128,0)
 N RCDPCSUM,RCDPDATA,X,Y,Z,Z0
"RTN","RCDPESR3",129,0)
 ;
"RTN","RCDPESR3",130,0)
 S (RCDPCSUM,X)=0,Z0=$G(^RCY(344.3,RCTDA,0))
"RTN","RCDPESR3",131,0)
 ; Use pcs 1-8, leaving out piece 3
"RTN","RCDPESR3",132,0)
 S RCDPDATA=$P(Z0,U,1,8),$P(RCDPDATA,U,3)=""
"RTN","RCDPESR3",133,0)
 S X=RCDPCSUM_RCDPDATA X $S($G(^%ZOSF("LPC"))'="":^("LPC"),1:"S Y=""""") S RCDPCSUM=Y
"RTN","RCDPESR3",134,0)
 ; Use detail iens and pieces 3,4,7 to complete the checksum
"RTN","RCDPESR3",135,0)
 S Z=0 F  S Z=$O(^RCY(344.31,"B",RCTDA,Z)) Q:'Z  S Z0=$G(^RCY(344.31,Z,0)),RCDPDATA=Z_U_$P(Z0,U,3,4)_U_$P(Z0,U,7),X=RCDPCSUM_RCDPDATA X $S($G(^%ZOSF("LPC"))'="":^("LPC"),1:"S Y=""""") S RCDPCSUM=Y
"RTN","RCDPESR3",136,0)
 Q RCDPCSUM
"RTN","RCDPESR3",137,0)
 ;
"RTN","RCDPESR3",138,0)
DISP(RCTIT,RCCT,RCDXM,RCXMZ) ; Sends bulletin with formatted data from message
"RTN","RCDPESR3",139,0)
 ; RCTIT = title of bulletin
"RTN","RCDPESR3",140,0)
 ; RCCT = # of lines previously populated
"RTN","RCDPESR3",141,0)
 ; RCXDM = array containing the text of the bulletin
"RTN","RCDPESR3",142,0)
 N RC,Z
"RTN","RCDPESR3",143,0)
 K ^TMP("RC1",$J),^TMP("RC",$J),^TMP("RCTEMP",$J)
"RTN","RCDPESR3",144,0)
 S RC=1,^TMP("RCTEMP",$J,RC)=$G(^TMP("RCMSGH",$J,0))
"RTN","RCDPESR3",145,0)
 S Z=0 F  S Z=$O(^TMP("RCMSG",$J,2,"D",Z)) Q:'Z  S RC=RC+1,^TMP("RCTEMP",$J,RC)=$G(^TMP("RCMSG",$J,2,"D",Z))
"RTN","RCDPESR3",146,0)
 D DISP^RCDPESR8("^TMP(""RCTEMP"",$J)","^TMP(""RC1"",$J)",1,"^TMP(""RC"",$J)",75)
"RTN","RCDPESR3",147,0)
 S Z=0 F  S Z=$O(^TMP("RC",$J,Z)) Q:'Z  S RCCT=RCCT+1,RCDXM(RCCT)=$G(^TMP("RC",$J,Z))
"RTN","RCDPESR3",148,0)
 D BULLEFT^RCDPESR0("",RCXMZ,RCTIT,.RCDXM)
"RTN","RCDPESR3",149,0)
 K ^TMP("RC1",$J),^TMP("RC",$J),^TMP("RCTEMP",$J)
"RTN","RCDPESR3",150,0)
 Q
"RTN","RCDPESR3",151,0)
 ;
"RTN","RCDPESR3",152,0)
DUP(RCM,RCIFN,RCAMT,RCAMT1) ; EOB in mail message already stored in 361.1?
"RTN","RCDPESR3",153,0)
 ; RCM = msg # EOB was received in
"RTN","RCDPESR3",154,0)
 ; RCIFN = bill ien
"RTN","RCDPESR3",155,0)
 ; RCAMT = amt pd
"RTN","RCDPESR3",156,0)
 ; RCAMT1 = amt reported billed
"RTN","RCDPESR3",157,0)
 ; Returns 0 if none found, entry #^message checksum on file if found
"RTN","RCDPESR3",158,0)
 N Z,DUP,DUP1
"RTN","RCDPESR3",159,0)
 S (DUP,DUP1,Z)=0
"RTN","RCDPESR3",160,0)
 F  S Z=$O(^IBM(361.1,"AC",RCM,Z)) Q:'Z  I +$G(^IBM(361.1,Z,0))=RCIFN D  Q:DUP
"RTN","RCDPESR3",161,0)
 . I '$P($G(^IBM(361.1,Z,100)),U,5) S DUP1=Z Q  ; Partially filed before
"RTN","RCDPESR3",162,0)
 . I +$G(^IBM(361.1,Z,1))=+RCAMT,+$P($G(^IBM(361.1,1,Z,2)),U,4)=+RCAMT1 S DUP=Z_U_+$P($G(^IBM(361.1,Z,100)),U,5) Q
"RTN","RCDPESR3",163,0)
 I 'DUP,DUP1 S DUP=DUP1_"^0"
"RTN","RCDPESR3",164,0)
 Q DUP
"RTN","RCDPESR3",165,0)
 ;
"RTN","RCDPESR3",166,0)
DUPERA(DUP,RCNOUPD) ; Msg for duplicate ERA
"RTN","RCDPESR3",167,0)
 ; RCNOUPD = # of message with duplicate data
"RTN","RCDPESR3",168,0)
 ; DUP = flag = -1 if duplicate message received in same mail msg #
"RTN","RCDPESR3",169,0)
 K ^TMP("RCERR1",$J)
"RTN","RCDPESR3",170,0)
 S ^TMP("RCERR1",$J,1)=$S(DUP>0:"This an exact duplicate of an ERA received previously in mail msg "_RCNOUPD,1:"This ERA message was already fully processed - message was ignored")
"RTN","RCDPESR3",171,0)
 Q
"RTN","RCDPESR3",172,0)
 ;
"RTN","RCDPESR3",173,0)
BULLS(RCFILE,RCTDA,DUP,RCXMSG) ; Error bulletins for ERA
"RTN","RCDPESR3",174,0)
 I RCFILE=5 D BULL1^RCDPESR5(RCTDA,"^TMP(""RCERR1"",$J)",$S($G(DUP)>0:$G(DUP),1:""))
"RTN","RCDPESR3",175,0)
 I RCFILE=4 D BULL2^RCDPESR5(RCTDA,"^TMP(""RCERR1"",$J)",RCXMSG)
"RTN","RCDPESR3",176,0)
 Q
"RTN","RCDPESR3",177,0)
 ;
"RTN","RCDPESR3",178,0)
ADJERR(RCERR) ; Set up adj error text in RCERR(n) - pass by ref
"RTN","RCDPESR3",179,0)
 ; Function returns # of lines for error text
"RTN","RCDPESR3",180,0)
 S RCERR(1)="At least 1 adjustment transaction has been found on this ERA.  Before the",RCERR(2)="   receipt for this ERA can be processed, the appropriate adjustments",RCERR(3)="   must be made using the EEOB Worklist",RCERR(4)=" "
"RTN","RCDPESR3",181,0)
 Q 4
"RTN","RCDPESR3",182,0)
 ;
"VER")
8.0^22.0
"^DD",344.3,344.3,.03,0)
AR DEPOSIT RECORD^*P344.1'X^RCY(344.1,^0;3^S DIC("S")="I ($E($P(^(0),U),1,3)=""469"")!($E($P(^(0),U),1,3)=""569"")" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",344.3,344.3,.03,1,0)
^.1
"^DD",344.3,344.3,.03,1,1,0)
344.3^ARDEP
"^DD",344.3,344.3,.03,1,1,1)
S ^RCY(344.3,"ARDEP",$E(X,1,30),DA)=""
"^DD",344.3,344.3,.03,1,1,2)
K ^RCY(344.3,"ARDEP",$E(X,1,30),DA)
"^DD",344.3,344.3,.03,1,1,3)
Do not delete
"^DD",344.3,344.3,.03,1,1,"DT")
3030123
"^DD",344.3,344.3,.03,3)
Enter the AR Deposit ticket # that was created by this EFT.
"^DD",344.3,344.3,.03,12)
Deposit number must begin with 469 or 569
"^DD",344.3,344.3,.03,12.1)
S DIC("S")="I ($E($P(^(0),U),1,3)=""469"")!($E($P(^(0),U),1,3)=""569"")"
"^DD",344.3,344.3,.03,21,0)
^^2^2^3020930^
"^DD",344.3,344.3,.03,21,1,0)
This is the reference to the deposit ticket in AR that was created by
"^DD",344.3,344.3,.03,21,2,0)
this EFT.
"^DD",344.3,344.3,.03,"DT")
3071016
"BLD",7441,6)
^227
**END**
**END**
