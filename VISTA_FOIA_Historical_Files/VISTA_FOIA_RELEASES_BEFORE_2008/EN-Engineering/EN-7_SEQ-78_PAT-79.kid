Released EN*7*79 SEQ #78
Extracted from mail message
**KIDS**:EN*7.0*79^

**INSTALL NAME**
EN*7.0*79
"BLD",4777,0)
EN*7.0*79^ENGINEERING^0^3031013^y
"BLD",4777,1,0)
^^1^1^3030527^
"BLD",4777,1,1,0)
CoreFLS Data Cleansing Reports for Engineering Employee File (#6929)
"BLD",4777,4,0)
^9.64PA^^
"BLD",4777,"KRN",0)
^9.67PA^8989.52^19
"BLD",4777,"KRN",.4,0)
.4
"BLD",4777,"KRN",.401,0)
.401
"BLD",4777,"KRN",.402,0)
.402
"BLD",4777,"KRN",.403,0)
.403
"BLD",4777,"KRN",.5,0)
.5
"BLD",4777,"KRN",.84,0)
.84
"BLD",4777,"KRN",3.6,0)
3.6
"BLD",4777,"KRN",3.8,0)
3.8
"BLD",4777,"KRN",9.2,0)
9.2
"BLD",4777,"KRN",9.8,0)
9.8
"BLD",4777,"KRN",9.8,"NM",0)
^9.68A^45^6
"BLD",4777,"KRN",9.8,"NM",39,0)
ENH6929^^0^B8893166
"BLD",4777,"KRN",9.8,"NM",41,0)
ENH6929I^^0^B53796727
"BLD",4777,"KRN",9.8,"NM",42,0)
ENH6929L^^0^B24097010
"BLD",4777,"KRN",9.8,"NM",43,0)
ENH6929M^^0^B41967563
"BLD",4777,"KRN",9.8,"NM",44,0)
ENH6929P^^0^B40869127
"BLD",4777,"KRN",9.8,"NM",45,0)
ENH6929U^^0^B2982413
"BLD",4777,"KRN",9.8,"NM","B","ENH6929",39)

"BLD",4777,"KRN",9.8,"NM","B","ENH6929I",41)

"BLD",4777,"KRN",9.8,"NM","B","ENH6929L",42)

"BLD",4777,"KRN",9.8,"NM","B","ENH6929M",43)

"BLD",4777,"KRN",9.8,"NM","B","ENH6929P",44)

"BLD",4777,"KRN",9.8,"NM","B","ENH6929U",45)

"BLD",4777,"KRN",19,0)
19
"BLD",4777,"KRN",19,"NM",0)
^9.68A^7^6
"BLD",4777,"KRN",19,"NM",2,0)
ENH DATA CLEANSING^^2
"BLD",4777,"KRN",19,"NM",3,0)
ENH ENGINEERING EMPLOYEE^^0
"BLD",4777,"KRN",19,"NM",4,0)
ENH 6929 SUMMARY REPORT^^0
"BLD",4777,"KRN",19,"NM",5,0)
ENH 6929 REQUIRED RPT^^0
"BLD",4777,"KRN",19,"NM",6,0)
ENH 6929 LOOKUP RPT^^0
"BLD",4777,"KRN",19,"NM",7,0)
ENH 6929 NON-REQUIRED RPT^^0
"BLD",4777,"KRN",19,"NM","B","ENH 6929 LOOKUP RPT",6)

"BLD",4777,"KRN",19,"NM","B","ENH 6929 NON-REQUIRED RPT",7)

"BLD",4777,"KRN",19,"NM","B","ENH 6929 REQUIRED RPT",5)

"BLD",4777,"KRN",19,"NM","B","ENH 6929 SUMMARY REPORT",4)

"BLD",4777,"KRN",19,"NM","B","ENH DATA CLEANSING",2)

"BLD",4777,"KRN",19,"NM","B","ENH ENGINEERING EMPLOYEE",3)

"BLD",4777,"KRN",19.1,0)
19.1
"BLD",4777,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",4777,"KRN",101,0)
101
"BLD",4777,"KRN",409.61,0)
409.61
"BLD",4777,"KRN",771,0)
771
"BLD",4777,"KRN",870,0)
870
"BLD",4777,"KRN",8989.51,0)
8989.51
"BLD",4777,"KRN",8989.52,0)
8989.52
"BLD",4777,"KRN",8994,0)
8994
"BLD",4777,"KRN","B",.4,.4)

"BLD",4777,"KRN","B",.401,.401)

"BLD",4777,"KRN","B",.402,.402)

"BLD",4777,"KRN","B",.403,.403)

"BLD",4777,"KRN","B",.5,.5)

"BLD",4777,"KRN","B",.84,.84)

"BLD",4777,"KRN","B",3.6,3.6)

"BLD",4777,"KRN","B",3.8,3.8)

"BLD",4777,"KRN","B",9.2,9.2)

"BLD",4777,"KRN","B",9.8,9.8)

"BLD",4777,"KRN","B",19,19)

"BLD",4777,"KRN","B",19.1,19.1)

"BLD",4777,"KRN","B",101,101)

"BLD",4777,"KRN","B",409.61,409.61)

"BLD",4777,"KRN","B",771,771)

"BLD",4777,"KRN","B",870,870)

"BLD",4777,"KRN","B",8989.51,8989.51)

"BLD",4777,"KRN","B",8989.52,8989.52)

"BLD",4777,"KRN","B",8994,8994)

"BLD",4777,"QUES",0)
^9.62^^
"BLD",4777,"REQB",0)
^9.611^^
"KRN",19,11578,-1)
2^2
"KRN",19,11578,0)
ENH DATA CLEANSING^CoreFLS AEMS/MERS Data Cleansing Reports^^M^101009^ENH DATA CLEANSING^^^^^^33
"KRN",19,11578,10,0)
^19.01IP^7^7
"KRN",19,11578,10,5,0)
11702^5^5
"KRN",19,11578,10,5,"^")
ENH ENGINEERING EMPLOYEE
"KRN",19,11578,"U")
COREFLS AEMS/MERS DATA CLEANSI
"KRN",19,11702,-1)
0^3
"KRN",19,11702,0)
ENH ENGINEERING EMPLOYEE^Engineering Employee - 6929^^M^^ENH DATA CLEANSING^^^^^^ENGINEERING
"KRN",19,11702,1,0)
^^2^2^3030916^
"KRN",19,11702,1,1,0)
This menu displays all of the CoreFLS Data Cleansing report options for
"KRN",19,11702,1,2,0)
AEMS/MERS ENG EMPLOYEE (#6929) file.
"KRN",19,11702,10,0)
^19.01IP^4^4
"KRN",19,11702,10,1,0)
11736^1^1
"KRN",19,11702,10,1,"^")
ENH 6929 SUMMARY REPORT
"KRN",19,11702,10,2,0)
11737^2^2
"KRN",19,11702,10,2,"^")
ENH 6929 REQUIRED RPT
"KRN",19,11702,10,3,0)
11738^3^3
"KRN",19,11702,10,3,"^")
ENH 6929 LOOKUP RPT
"KRN",19,11702,10,4,0)
11739^4^4
"KRN",19,11702,10,4,"^")
ENH 6929 NON-REQUIRED RPT
"KRN",19,11702,25)

"KRN",19,11702,99)
59344,65175
"KRN",19,11702,"U")
ENGINEERING EMPLOYEE - 6929
"KRN",19,11736,-1)
0^4
"KRN",19,11736,0)
ENH 6929 SUMMARY REPORT^Summary Report^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11736,1,0)
^^5^5^3030929^
"KRN",19,11736,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Summary Report
"KRN",19,11736,1,2,0)
for the ENG EMPLOYEE (#6929) file. The report shows the fields being
"KRN",19,11736,1,3,0)
checked and the total number of times that required fields and
"KRN",19,11736,1,4,0)
non-required fields are missing data and the total number of times that
"KRN",19,11736,1,5,0)
lookup fields have invalid data.
"KRN",19,11736,20)
S ENHRPT=1
"KRN",19,11736,25)
REPTYP^ENH6929
"KRN",19,11736,"U")
SUMMARY REPORT
"KRN",19,11737,-1)
0^5
"KRN",19,11737,0)
ENH 6929 REQUIRED RPT^Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11737,1,0)
^^3^3^3030929^
"KRN",19,11737,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Required Fields
"KRN",19,11737,1,2,0)
Missing Data Report for the ENG EMPLOYEE (#6929) file. The report lists
"KRN",19,11737,1,3,0)
the required fields that are empty and that you must correct.
"KRN",19,11737,20)
S ENHRPT=2
"KRN",19,11737,25)
REPTYP^ENH6929
"KRN",19,11737,"U")
REQUIRED FIELDS MISSING DATA R
"KRN",19,11738,-1)
0^6
"KRN",19,11738,0)
ENH 6929 LOOKUP RPT^Lookup Fields w/ Invalid Data Report^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11738,1,0)
^^4^4^3030929^
"KRN",19,11738,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Lookup Fields w/
"KRN",19,11738,1,2,0)
Invalid Data Report for the ENG EMPLOYEE (#6929) file. The report lists
"KRN",19,11738,1,3,0)
the lookup fields that contain an invalid value in a pointer field that
"KRN",19,11738,1,4,0)
you must correct.
"KRN",19,11738,20)
S ENHRPT=3
"KRN",19,11738,25)
REPTYP^ENH6929
"KRN",19,11738,"U")
LOOKUP FIELDS W/ INVALID DATA 
"KRN",19,11739,-1)
0^7
"KRN",19,11739,0)
ENH 6929 NON-REQUIRED RPT^Non-Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11739,1,0)
^^3^3^3030929^
"KRN",19,11739,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Non-Required
"KRN",19,11739,1,2,0)
Fields Missing Data Report for the ENG EMPLOYEE (#6929) file. The report
"KRN",19,11739,1,3,0)
lists the non-required fields that are empty and that you should correct.
"KRN",19,11739,20)
S ENHRPT=4
"KRN",19,11739,25)
REPTYP^ENH6929
"KRN",19,11739,"U")
NON-REQUIRED FIELDS MISSING DA
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
79^3031013
"PKG",33,22,1,"PAH",1,1,0)
^^1^1^3031013
"PKG",33,22,1,"PAH",1,1,1,0)
CoreFLS Data Cleansing Reports for Engineering Employee File (#6929)
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","ENH6929")
0^39^B8893166
"RTN","ENH6929",1,0)
ENH6929 ;WOIFO/DAC/EEN - Engineering Employee Report Driver (AMES/MERS) - CoreFLS ;09/30/03 15:25
"RTN","ENH6929",2,0)
 ;;7.0;Engineering;**79**;Aug 17,1993
"RTN","ENH6929",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6929",4,0)
 ;
"RTN","ENH6929",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH6929",6,0)
 ;
"RTN","ENH6929",7,0)
 ;This routine is the entry point for all Building File reports
"RTN","ENH6929",8,0)
 ;
"RTN","ENH6929",9,0)
REPTYP ; Entry point for all options
"RTN","ENH6929",10,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH6929",11,0)
 D HOME^%ZIS
"RTN","ENH6929",12,0)
 K ^TMP("ENH6929",$J)
"RTN","ENH6929",13,0)
 S ABORT=0
"RTN","ENH6929",14,0)
 I ENHRPT=1 D
"RTN","ENH6929",15,0)
 . S PRTRTN="OPT1^ENH6929P"
"RTN","ENH6929",16,0)
 I ENHRPT=2 D
"RTN","ENH6929",17,0)
 . S PRTRTN="OPT2^ENH6929P"
"RTN","ENH6929",18,0)
 I ENHRPT=3 D
"RTN","ENH6929",19,0)
 . S PRTRTN="OPT3^ENH6929P"
"RTN","ENH6929",20,0)
 I ENHRPT=4 D
"RTN","ENH6929",21,0)
 . S PRTRTN="OPT4^ENH6929P"
"RTN","ENH6929",22,0)
 D DIVM I ABORT G EXIT Q
"RTN","ENH6929",23,0)
 D INST^ENH6929U I ABORT G EXIT Q
"RTN","ENH6929",24,0)
 D DEVICE
"RTN","ENH6929",25,0)
 G EXIT
"RTN","ENH6929",26,0)
 Q
"RTN","ENH6929",27,0)
 ;
"RTN","ENH6929",28,0)
DIVM ; Print by Station Prompt
"RTN","ENH6929",29,0)
 ;
"RTN","ENH6929",30,0)
 K DIR,ENDIVFG,Y,STAT
"RTN","ENH6929",31,0)
 S IEN=0
"RTN","ENH6929",32,0)
 F  S IEN=$O(^ENG("EMP",IEN)) Q:'IEN  D
"RTN","ENH6929",33,0)
 . S STAT=$P(^ENG("EMP",IEN,0),U,8) I STAT="" S STAT="ZZ no station"
"RTN","ENH6929",34,0)
 . I '$D(STAT(STAT)) S STAT(STAT)=""
"RTN","ENH6929",35,0)
 W !!," This report is sorted by station. You may select a single station or ALL.",!
"RTN","ENH6929",36,0)
 S DIVDIR="S^1:ALL",CNT=1,STAT=""
"RTN","ENH6929",37,0)
 F  S STAT=$O(STAT(STAT)) Q:STAT=""  D
"RTN","ENH6929",38,0)
 . S CNT=CNT+1
"RTN","ENH6929",39,0)
 . S DIVDIR=DIVDIR_";"_CNT_":"_STAT
"RTN","ENH6929",40,0)
 S DIR(0)=DIVDIR
"RTN","ENH6929",41,0)
 S DIR("A")="Please select a station (1-"_CNT_")"
"RTN","ENH6929",42,0)
 S DIR("A",1)=" "
"RTN","ENH6929",43,0)
 S DIR("B")=1
"RTN","ENH6929",44,0)
 S DIR("?")=" "
"RTN","ENH6929",45,0)
 S DIR("?",1)=" The list below contains the stations that have been"
"RTN","ENH6929",46,0)
 S DIR("?",2)=" found in the STATION (#2.4) field in the ENG EMPLOYEE"
"RTN","ENH6929",47,0)
 S DIR("?",3)=" (#6929) file."
"RTN","ENH6929",48,0)
 S DIR("?",4)=" "
"RTN","ENH6929",49,0)
 S DIR("?",5)=" Select ""ZZ no station"" to display the records with no"
"RTN","ENH6929",50,0)
 S DIR("?",6)=" entry in the STATION (#2.4) field."
"RTN","ENH6929",51,0)
 D ^DIR K DIR
"RTN","ENH6929",52,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6929",53,0)
 S ENDIVFG=Y(0)
"RTN","ENH6929",54,0)
 Q
"RTN","ENH6929",55,0)
 ;
"RTN","ENH6929",56,0)
DEVICE ; Ask the user for a device to print to (queuing is allowed).
"RTN","ENH6929",57,0)
 W !
"RTN","ENH6929",58,0)
 S %ZIS="Q"
"RTN","ENH6929",59,0)
 D ^%ZIS I POP S ABORT=1 Q
"RTN","ENH6929",60,0)
 ;User has decided to Queue report
"RTN","ENH6929",61,0)
 I $D(IO("Q")) D  Q
"RTN","ENH6929",62,0)
 . S ZTSAVE("ENHRPT")="",ZTSAVE("ENDIVFG")="",ZTSAVE("ENHDR")=""
"RTN","ENH6929",63,0)
 . S ZTSAVE("ENHDIV")="",ZTSAVE("ENHINST")="",ZTRTN=PRTRTN
"RTN","ENH6929",64,0)
 . S ZTDESC="CoreFLS DATA QUALITY REPORT (File# 6929 - ENGINEERING EMPLOYEE)"
"RTN","ENH6929",65,0)
 . D ^%ZTLOAD,HOME^%ZIS
"RTN","ENH6929",66,0)
 . K ZTSK,ZTSAVE,ZTRTN,ZTDESC
"RTN","ENH6929",67,0)
 D @PRTRTN
"RTN","ENH6929",68,0)
 Q
"RTN","ENH6929",69,0)
 ;
"RTN","ENH6929",70,0)
EXIT ;
"RTN","ENH6929",71,0)
 K P,L,ABORT,ENFLG,TOTANA,CRITREC,BPTREC,DESREC,TYP,FLDNAME,I,IEN,EN4
"RTN","ENH6929",72,0)
 K DIR,ENHRPT,ENDIVFG,ENHDIV,ENHDR,DIV,FLD,RECIEN,RECNUM,FLDNUM,TOTFLD
"RTN","ENH6929",73,0)
 K CNT,DIVDIR,DTOUT,DUOUT,POP,Y,PTEDFIL,DESFLD,PRTRTN,TOTREC,EN1,EN2,EN3
"RTN","ENH6929",74,0)
 K CSERIDES,CTITLDES,DIVN,ENHINST,NMCRIT,SHOPDES,SHOPBPT,ENHINST,ENDIVNM
"RTN","ENH6929",75,0)
 K %ZIS
"RTN","ENH6929",76,0)
 Q
"RTN","ENH6929I")
0^41^B53796727
"RTN","ENH6929I",1,0)
ENH6929I ;WOIFO/DAC/EEN - Engineering Employee Instructions (AMES/MERS) - CoreFLS ;09/30/03 15:25
"RTN","ENH6929I",2,0)
 ;;7.0;Engineering;**79**;Aug 17,1993
"RTN","ENH6929I",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6929I",4,0)
 ;
"RTN","ENH6929I",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH6929I",6,0)
 ;
"RTN","ENH6929I",7,0)
PRT1 ; Print Instructions for Summary Report
"RTN","ENH6929I",8,0)
 ;
"RTN","ENH6929I",9,0)
 S (P,L,ABORT)=0
"RTN","ENH6929I",10,0)
 S ENHDR="SUMMARY"
"RTN","ENH6929I",11,0)
 S ENHDR1="Instructions"
"RTN","ENH6929I",12,0)
 U IO
"RTN","ENH6929I",13,0)
 D HDR^ENH6929U
"RTN","ENH6929I",14,0)
 W !!,"The purpose of this report is to display the total number of records in the"
"RTN","ENH6929I",15,0)
 W !,"ENG EMPLOYEE (#6929) file that have invalid or missing (empty) values"
"RTN","ENH6929I",16,0)
 W !,"in the fields that are being converted into the CoreFLS system.  The report"
"RTN","ENH6929I",17,0)
 W !,"examines four fields to determine if there is a valid value in each. If there"
"RTN","ENH6929I",18,0)
 W !,"is no value in the field, it is considered to be empty. If there is a value"
"RTN","ENH6929I",19,0)
 W !,"in a lookup-type (a.k.a. pointer) field, the report examines the value to"
"RTN","ENH6929I",20,0)
 W !,"ensure that it is valid."
"RTN","ENH6929I",21,0)
 S L=L+8
"RTN","ENH6929I",22,0)
 I L+11>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",23,0)
 W !!,"This report examines the following fields:"
"RTN","ENH6929I",24,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6929I",25,0)
 W !,"to the field number"
"RTN","ENH6929I",26,0)
 W !!,"     NAME (#.01)"
"RTN","ENH6929I",27,0)
 W !,"     SHOP (#.3)"
"RTN","ENH6929I",28,0)
 W !,"     CLASSIFICATION SERIES (#10.5) - ""Class. Series"""
"RTN","ENH6929I",29,0)
 W !,"     CLASSIFICATION TITLE (#12) - ""Class. Title"""
"RTN","ENH6929I",30,0)
 S L=L+9
"RTN","ENH6929I",31,0)
 I L+7>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",32,0)
 W !!,"The report is sorted by station. When printing or viewing this report, you"
"RTN","ENH6929I",33,0)
 W !,"may select a single station or ALL. Select ""ZZ no station"" to display the"
"RTN","ENH6929I",34,0)
 W !,"records with no entry in the STATION (#2.4) field. The report lists the overall"
"RTN","ENH6929I",35,0)
 W !,"count of the number of problem records and fields detected."
"RTN","ENH6929I",36,0)
 S L=L+5
"RTN","ENH6929I",37,0)
 I L+4>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",38,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6929I",39,0)
 S L=L+2
"RTN","ENH6929I",40,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",41,0)
 W !!,"Total records analyzed - number of records in the ENG EMPLOYEE (#6929) file"
"RTN","ENH6929I",42,0)
 W !,"     assigned to the station"
"RTN","ENH6929I",43,0)
 S L=L+3
"RTN","ENH6929I",44,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",45,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6929I",46,0)
 W !,"     at least one empty required field"
"RTN","ENH6929I",47,0)
 S L=L+3
"RTN","ENH6929I",48,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",49,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records that have"
"RTN","ENH6929I",50,0)
 W !,"     invalid data in any of the lookup fields"
"RTN","ENH6929I",51,0)
 S L=L+3
"RTN","ENH6929I",52,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",53,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records that"
"RTN","ENH6929I",54,0)
 W !,"     have nothing in at least one non-required field"
"RTN","ENH6929I",55,0)
 S L=L+3
"RTN","ENH6929I",56,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",57,0)
 W !!,"Next, the report lists the counts for each individual field. The fields are"
"RTN","ENH6929I",58,0)
 W !,"listed in alphabetical order. Each row consists of the following columns:"
"RTN","ENH6929I",59,0)
 S L=L+3
"RTN","ENH6929I",60,0)
 I L+7>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",61,0)
 W !!,"DATA QUALITY CHECK TYPE - tells whether the field was examined for:"
"RTN","ENH6929I",62,0)
 W !,"     REQ: required fields missing data"
"RTN","ENH6929I",63,0)
 W !,"     INV: invalid data"
"RTN","ENH6929I",64,0)
 W !,"     NREQ: non-required fields missing data"
"RTN","ENH6929I",65,0)
 S L=L+5
"RTN","ENH6929I",66,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",67,0)
 W !!,"FIELD NAME - name or abbreviation of the field from the ENG EMPLOYEE (#6929)"
"RTN","ENH6929I",68,0)
 W !,"     file"
"RTN","ENH6929I",69,0)
 S L=L+3
"RTN","ENH6929I",70,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",71,0)
 W !!,"REQUIRED FIELDS MISSING DATA - count of the number of empty required fields"
"RTN","ENH6929I",72,0)
 W !,"     (""N/A"" appears in this column if the field is not required by CoreFLS.)"
"RTN","ENH6929I",73,0)
 S L=L+3
"RTN","ENH6929I",74,0)
 I L+6>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",75,0)
 W !!,"LOOKUP FIELDS W/ INVALID DATA - count of the number of lookup fields that"
"RTN","ENH6929I",76,0)
 W !,"     contain an invalid value  (""N/A"" appears in this column if the field"
"RTN","ENH6929I",77,0)
 W !,"     is not a lookup field.)"
"RTN","ENH6929I",78,0)
 S L=L+4
"RTN","ENH6929I",79,0)
 I L+7>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",80,0)
 W !!,"NON-REQ. FIELDS WITH MISSING DATA - count of the number of empty"
"RTN","ENH6929I",81,0)
 W !,"     non-required fields (""N/A"" appears in this column if non-required does"
"RTN","ENH6929I",82,0)
 W !,"     not apply to this field.)"
"RTN","ENH6929I",83,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6929I",84,0)
 W @IOF
"RTN","ENH6929I",85,0)
 K P,L,Y,ENHDR,ENHDR1
"RTN","ENH6929I",86,0)
 Q
"RTN","ENH6929I",87,0)
 ;
"RTN","ENH6929I",88,0)
PRT2 ; Print Instructions for Required Fields Missing Data Report
"RTN","ENH6929I",89,0)
 ;
"RTN","ENH6929I",90,0)
 U IO
"RTN","ENH6929I",91,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH6929I",92,0)
 S ENHDR1="Instructions"
"RTN","ENH6929I",93,0)
 S (P,L,ABORT)=0
"RTN","ENH6929I",94,0)
 D HDR^ENH6929U
"RTN","ENH6929I",95,0)
 W !!,"The purpose of this report is to display a list of all ENG EMPLOYEE (#6929)"
"RTN","ENH6929I",96,0)
 W !,"items with missing (empty) data for the fields that are required in the"
"RTN","ENH6929I",97,0)
 W !,"CoreFLS system. CoreFLS is unable to function when a required field is empty;"
"RTN","ENH6929I",98,0)
 W !,"therefore, you must enter valid data in these fields prior to conversion."
"RTN","ENH6929I",99,0)
 W !!,"This report examines the following required field:"
"RTN","ENH6929I",100,0)
 W !,"NOTE: Abbreviation for the field name used on this report appears in quotes"
"RTN","ENH6929I",101,0)
 W !,"next to the field number"
"RTN","ENH6929I",102,0)
 W !,"     NAME (#.01) - ""Employee Name"""
"RTN","ENH6929I",103,0)
 S L=L+10
"RTN","ENH6929I",104,0)
 I L+6>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",105,0)
 W !!,"The report is sorted by station. When printing or viewing this report, you"
"RTN","ENH6929I",106,0)
 W !,"may select a single station or ALL. Select ""ZZ no station"" to display the"
"RTN","ENH6929I",107,0)
 W !,"records with no entry in the STATION (#2.4) field."
"RTN","ENH6929I",108,0)
 S L=L+4
"RTN","ENH6929I",109,0)
 I L+7>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",110,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6929I",111,0)
 W !!,"Total records analyzed - number of records in the ENG EMPLOYEE (#6929) file"
"RTN","ENH6929I",112,0)
 W !,"     assigned to the station"
"RTN","ENH6929I",113,0)
 S L=L+5
"RTN","ENH6929I",114,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",115,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH6929I",116,0)
 W !,"     an empty required field"
"RTN","ENH6929I",117,0)
 S L=L+3
"RTN","ENH6929I",118,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",119,0)
 W !!,"Total fields with Required Fields Missing Data - number of required fields"
"RTN","ENH6929I",120,0)
 W !,"     that are empty"
"RTN","ENH6929I",121,0)
 S L=L+3
"RTN","ENH6929I",122,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",123,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6929I",124,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6929I",125,0)
 S L=L+3
"RTN","ENH6929I",126,0)
 I L+4>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",127,0)
 W !!,"REC IEN - lists the ENG EMPLOYEE (#6929) file internal record number"
"RTN","ENH6929I",128,0)
 S L=L+2
"RTN","ENH6929I",129,0)
 I L+4>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",130,0)
 W !!,"EMPLOYEE NAME - listed as ""ZZ no name"" since there is no entry in the NAME"
"RTN","ENH6929I",131,0)
 W !,"     (#.01) field"
"RTN","ENH6929I",132,0)
 S L=L+2
"RTN","ENH6929I",133,0)
 I L+4>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",134,0)
 W !!,"FIELD NAME - abbreviation of the required field"
"RTN","ENH6929I",135,0)
 S L=L+2
"RTN","ENH6929I",136,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",137,0)
 W !!,"You cannot correct the records that appear on this report using AEMS/MERS"
"RTN","ENH6929I",138,0)
 W !,"options. Contact the IRM or ADPAC for assistance."
"RTN","ENH6929I",139,0)
 S L=L+3
"RTN","ENH6929I",140,0)
 I L+8>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929I",141,0)
 W !!,"*** Conversion Note **********************************************"
"RTN","ENH6929I",142,0)
 W !,"If any NAME (#.01) field remains empty at the time of conversion,"
"RTN","ENH6929I",143,0)
 W !,"the record will not be converted into CoreFLS."
"RTN","ENH6929I",144,0)
 W !,"******************************************************************"
"RTN","ENH6929I",145,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6929I",146,0)
 W @IOF
"RTN","ENH6929I",147,0)
 K Y,L,P,ENHDR,ENHDR1
"RTN","ENH6929I",148,0)
 Q
"RTN","ENH6929L")
0^42^B24097010
"RTN","ENH6929L",1,0)
ENH6929L ;WOIFO/DAC/EEN - Engineering Employee Report Loop (AEMS/MERS) - CoreFLS ;09/30/03 15:25
"RTN","ENH6929L",2,0)
 ;;7.0;ENGINEERING;**79**;Aug 17,1993
"RTN","ENH6929L",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6929L",4,0)
 ;
"RTN","ENH6929L",5,0)
INIT ; Initialize Variables
"RTN","ENH6929L",6,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH6929L",7,0)
 K ^TMP("ENH6929",$J)
"RTN","ENH6929L",8,0)
 S (ENIEN,ENDIVCT,ENDIVNM)=0
"RTN","ENH6929L",9,0)
 ;
"RTN","ENH6929L",10,0)
LOOP ; Initialize TMP global with records in file 6929 Engineering Employee
"RTN","ENH6929L",11,0)
 ;
"RTN","ENH6929L",12,0)
 F  S ENIEN=$O(^ENG("EMP",ENIEN)) Q:'ENIEN  D
"RTN","ENH6929L",13,0)
 . S (CRITFLD,BPTFLD,DESFLD,CRITFLG,BPTFLG,DESFLG)=0
"RTN","ENH6929L",14,0)
 . S (ENHDIV,ENAME,SHOPPTER)=""
"RTN","ENH6929L",15,0)
 . ;
"RTN","ENH6929L",16,0)
 . ; Get Station if NULL then set to "ZZ no station"
"RTN","ENH6929L",17,0)
 . S ENHDIV=$P($G(^ENG("EMP",ENIEN,0)),U,8)
"RTN","ENH6929L",18,0)
 . I ENHDIV="" S ENHDIV="ZZ no station"
"RTN","ENH6929L",19,0)
 . ;
"RTN","ENH6929L",20,0)
 . ; Set Station node in ^TMP and initialize nodes for Station
"RTN","ENH6929L",21,0)
 . I '$D(^TMP("ENH6929",$J,"DIV",ENHDIV)) D
"RTN","ENH6929L",22,0)
 .. S ENDIVCT=ENDIVNM+1,ENDIVNM=ENDIVNM+1
"RTN","ENH6929L",23,0)
 .. S ^TMP("ENH6929",$J,"DIV",ENHDIV)=ENDIVCT
"RTN","ENH6929L",24,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,0)=ENHDIV
"RTN","ENH6929L",25,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"SUM")="0^0^0^0"
"RTN","ENH6929L",26,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"CRIT")="0"
"RTN","ENH6929L",27,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"BPT")=0
"RTN","ENH6929L",28,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES")=0
"RTN","ENH6929L",29,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"CRIT",.01)=0
"RTN","ENH6929L",30,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"BPT",.3)=0
"RTN","ENH6929L",31,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",.3)=0
"RTN","ENH6929L",32,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",10.5)=0
"RTN","ENH6929L",33,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",12)=0
"RTN","ENH6929L",34,0)
 . ;
"RTN","ENH6929L",35,0)
 . ; Nodes that have been initialized or that already exist
"RTN","ENH6929L",36,0)
 . I $D(^TMP("ENH6929",$J,"DIV",ENHDIV)) D
"RTN","ENH6929L",37,0)
 .. S ENDIVCT=^TMP("ENH6929",$J,"DIV",ENHDIV)
"RTN","ENH6929L",38,0)
 . ;
"RTN","ENH6929L",39,0)
 . ; Get Name (.01 field)
"RTN","ENH6929L",40,0)
 . S ENAME=$P($G(^ENG("EMP",ENIEN,0)),U,1)
"RTN","ENH6929L",41,0)
 . ; S ^TMP("XDAC",ENIEN)=ENAME
"RTN","ENH6929L",42,0)
 . ;
"RTN","ENH6929L",43,0)
 . ; **Add up Critical Null fields**
"RTN","ENH6929L",44,0)
 . ; -- Room Number (Check for Crit Null) --
"RTN","ENH6929L",45,0)
 . I ENAME="" D
"RTN","ENH6929L",46,0)
 .. S CRITFLD=CRITFLD+1,CRITFLG=1
"RTN","ENH6929L",47,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"CRIT",.01)=^TMP("ENH6929",$J,ENDIVCT,"CRIT",.01)+1
"RTN","ENH6929L",48,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"CRIT",.01,ENIEN)=ENIEN_U_ENAME_U_"Employee Name"_U_"6929,.01"_U_"N/A"_U_"N/A"
"RTN","ENH6929L",49,0)
 . ;
"RTN","ENH6929L",50,0)
 . ; **Add up Broken Pointer fields**
"RTN","ENH6929L",51,0)
 . ; -- Shop Pointer (Check for Broken Pter) --
"RTN","ENH6929L",52,0)
 . S SHOPPTER=$P($G(^ENG("EMP",ENIEN,0)),U,10)
"RTN","ENH6929L",53,0)
 . I SHOPPTER'="" D
"RTN","ENH6929L",54,0)
 .. I '$D(^DIC(6922,SHOPPTER,0))!($P($G(^DIC(6922,SHOPPTER,0)),U,1)="") D
"RTN","ENH6929L",55,0)
 ... S BPTFLD=BPTFLD+1,BPTFLG=1
"RTN","ENH6929L",56,0)
 ... S ^TMP("ENH6929",$J,ENDIVCT,"BPT",.3)=^TMP("ENH6929",$J,ENDIVCT,"BPT",.3)+1
"RTN","ENH6929L",57,0)
 ... S ^TMP("ENH6929",$J,ENDIVCT,"BPT",.3,ENIEN)=ENIEN_U_ENAME_U_"Shop"_U_"6929,.3"_U_"N/A"_U_SHOPPTER_U_"6922"
"RTN","ENH6929L",58,0)
 . ;
"RTN","ENH6929L",59,0)
 . ; **Add up the Desirable Null fields**
"RTN","ENH6929L",60,0)
 . ; -- Class. Series (Check for Desirable Null) --
"RTN","ENH6929L",61,0)
 . I $P($G(^ENG("EMP",ENIEN,0)),U,10)="" D
"RTN","ENH6929L",62,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6929L",63,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",.3)=^TMP("ENH6929",$J,ENDIVCT,"DES",.3)+1
"RTN","ENH6929L",64,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",.3,ENIEN)=ENIEN_U_ENAME_U_"Shop"_U_"6929,.3"_U_"N/A"_U_"N/A"
"RTN","ENH6929L",65,0)
 . ; -- Class. Series (Check for Desirable Null) --
"RTN","ENH6929L",66,0)
 . I $P($G(^ENG("EMP",ENIEN,0)),U,9)="" D
"RTN","ENH6929L",67,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6929L",68,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",10.5)=^TMP("ENH6929",$J,ENDIVCT,"DES",10.5)+1
"RTN","ENH6929L",69,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",10.5,ENIEN)=ENIEN_U_ENAME_U_"Classification Series"_U_"6929,10.5"_U_"N/A"_U_"N/A"
"RTN","ENH6929L",70,0)
 . ;
"RTN","ENH6929L",71,0)
 . ; -- Class. Title (Check for Desirable Null) --
"RTN","ENH6929L",72,0)
 . I $P($G(^ENG("EMP",ENIEN,0)),U,12)="" D
"RTN","ENH6929L",73,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH6929L",74,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",12)=^TMP("ENH6929",$J,ENDIVCT,"DES",12)+1
"RTN","ENH6929L",75,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES",12,ENIEN)=ENIEN_U_ENAME_U_"Classification Title"_U_"6929,12"_U_"N/A"_U_"N/A"
"RTN","ENH6929L",76,0)
 . ;
"RTN","ENH6929L",77,0)
 . ; Add counters for Total Analyzed, Critical, Broken, and Desirable
"RTN","ENH6929L",78,0)
 . S $P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U)=$P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U)+1
"RTN","ENH6929L",79,0)
 . I CRITFLG D
"RTN","ENH6929L",80,0)
 .. S $P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U,2)=$P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U,2)+1
"RTN","ENH6929L",81,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"CRIT")=^TMP("ENH6929",$J,ENDIVCT,"CRIT")+CRITFLD
"RTN","ENH6929L",82,0)
 . I BPTFLG D
"RTN","ENH6929L",83,0)
 .. S $P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U,3)=$P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U,3)+1
"RTN","ENH6929L",84,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"BPT")=^TMP("ENH6929",$J,ENDIVCT,"BPT")+BPTFLD
"RTN","ENH6929L",85,0)
 . I DESFLG D
"RTN","ENH6929L",86,0)
 .. S $P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U,4)=$P(^TMP("ENH6929",$J,ENDIVCT,"SUM"),U,4)+1
"RTN","ENH6929L",87,0)
 .. S ^TMP("ENH6929",$J,ENDIVCT,"DES")=^TMP("ENH6929",$J,ENDIVCT,"DES")+DESFLD
"RTN","ENH6929L",88,0)
 . ;
"RTN","ENH6929L",89,0)
 . Q
"RTN","ENH6929L",90,0)
SORT ; RE-SORT THE ^TMP GLOBAL BY RECORD
"RTN","ENH6929L",91,0)
 S EN1="",ENFILE="ENH6929",ENFILE1="ENH6929R"
"RTN","ENH6929L",92,0)
 K ^TMP(ENFILE1)
"RTN","ENH6929L",93,0)
 F  S EN1=$O(^TMP(ENFILE,$J,EN1)) Q:EN1=""  D
"RTN","ENH6929L",94,0)
 . S EN2=""
"RTN","ENH6929L",95,0)
 . F  S EN2=$O(^TMP(ENFILE,$J,EN1,EN2)) Q:EN2=""  D
"RTN","ENH6929L",96,0)
 .. S EN3=0
"RTN","ENH6929L",97,0)
 .. F  S EN3=$O(^TMP(ENFILE,$J,EN1,EN2,EN3)) Q:'EN3  D
"RTN","ENH6929L",98,0)
 ... S EN4=0
"RTN","ENH6929L",99,0)
 ... F  S EN4=$O(^TMP(ENFILE,$J,EN1,EN2,EN3,EN4)) Q:'EN4  D
"RTN","ENH6929L",100,0)
 .... S ^TMP(ENFILE1,$J,EN1,EN2,EN4,EN3)=^TMP(ENFILE,$J,EN1,EN2,EN3,EN4)
"RTN","ENH6929L",101,0)
 ;
"RTN","ENH6929L",102,0)
EXIT ; Kill all local variables
"RTN","ENH6929L",103,0)
 K ENIEN,ENHDIV,ENDIVCT,CRITFLD,BPTFLD,ENAME
"RTN","ENH6929L",104,0)
 K DESFLD,CRITFLG,BPTFLG,DESFLG,SHOPPTER,ENFILE,ENFILE1
"RTN","ENH6929L",105,0)
 Q
"RTN","ENH6929M")
0^43^B41967563
"RTN","ENH6929M",1,0)
ENH6929M ;WOIFO/DAC/EEN - Engineering Employee Instructions (AMES/MERS) - CoreFLS ;09/30/03 15:25
"RTN","ENH6929M",2,0)
 ;;7.0;Engineering;**79**;Aug 17,1993
"RTN","ENH6929M",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6929M",4,0)
 ;
"RTN","ENH6929M",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH6929M",6,0)
 ;
"RTN","ENH6929M",7,0)
PRT3 ; Print Instructions for Broken Pointers Report
"RTN","ENH6929M",8,0)
 ;
"RTN","ENH6929M",9,0)
 U IO
"RTN","ENH6929M",10,0)
 S (P,L,ABORT)=0
"RTN","ENH6929M",11,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH6929M",12,0)
 S ENHDR1="Instructions"
"RTN","ENH6929M",13,0)
 D HDR^ENH6929U
"RTN","ENH6929M",14,0)
 W !!,"The purpose of this report is to display a list of all fields in the ENG"
"RTN","ENH6929M",15,0)
 W !,"EMPLOYEE (#6929) file that contain an invalid value in a lookup-type or pointer"
"RTN","ENH6929M",16,0)
 W !,"field.  An invalid value is defined as a value that either does not have an"
"RTN","ENH6929M",17,0)
 W !,"entry in the file to which it points, or the entry in the file pointed to has"
"RTN","ENH6929M",18,0)
 W !,"an empty NAME (#.01) field.  An entry and a name must be present in the file"
"RTN","ENH6929M",19,0)
 W !,"to which a field points."
"RTN","ENH6929M",20,0)
 S L=L+7
"RTN","ENH6929M",21,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",22,0)
 W !!,"This report examines the following lookup field:"
"RTN","ENH6929M",23,0)
 W !,"     SHOP (#.3)"
"RTN","ENH6929M",24,0)
 S L=L+3
"RTN","ENH6929M",25,0)
 I L+8>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",26,0)
 W !!,"The report is sorted by station. When printing or viewing this report, you"
"RTN","ENH6929M",27,0)
 W !,"may select a single station or ALL. Select ""ZZ no station"" to display the"
"RTN","ENH6929M",28,0)
 W !,"records with no entry in the STATION (#2.4) field."
"RTN","ENH6929M",29,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6929M",30,0)
 S L=L+6
"RTN","ENH6929M",31,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",32,0)
 W !!,"Total records analyzed - number of records in the ENG EMPLOYEE (#6929) file"
"RTN","ENH6929M",33,0)
 W !,"     assigned to the station"
"RTN","ENH6929M",34,0)
 S L=L+3
"RTN","ENH6929M",35,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",36,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records that have"
"RTN","ENH6929M",37,0)
 W !,"     an invalid value in the lookup field"
"RTN","ENH6929M",38,0)
 S L=L+3
"RTN","ENH6929M",39,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",40,0)
 W !!,"Total fields with Lookup Fields w/ Invalid Data - number of lookup fields with"
"RTN","ENH6929M",41,0)
 W !,"     invalid data"
"RTN","ENH6929M",42,0)
 S L=L+3
"RTN","ENH6929M",43,0)
 I L+7>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",44,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6929M",45,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6929M",46,0)
 W !!,"REC IEN - lists the ENG EMPLOYEE (#6929) file internal record number"
"RTN","ENH6929M",47,0)
 S L=L+5
"RTN","ENH6929M",48,0)
 I L+6>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",49,0)
 W !!,"EMPLOYEE NAME - name of the Engineering employee (#.01 field)"
"RTN","ENH6929M",50,0)
 W !!,"FIELD NAME - name of the lookup field"
"RTN","ENH6929M",51,0)
 S L=L+4
"RTN","ENH6929M",52,0)
 I L+11>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",53,0)
 W !!,"You must correct every field that appears on this report prior to conversion."
"RTN","ENH6929M",54,0)
 W !,"Use AEMS/MERS to enter a valid value in each lookup field listed."
"RTN","ENH6929M",55,0)
 W !!,"*** Conversion Note **********************************************"
"RTN","ENH6929M",56,0)
 W !,"If any lookup field on this report is left with invalid data,"
"RTN","ENH6929M",57,0)
 W !,"it will be converted as empty into CoreFLS."
"RTN","ENH6929M",58,0)
 W !,"******************************************************************"
"RTN","ENH6929M",59,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6929M",60,0)
 W @IOF
"RTN","ENH6929M",61,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH6929M",62,0)
 Q
"RTN","ENH6929M",63,0)
 ;
"RTN","ENH6929M",64,0)
PRT4 ; Print Instructions for Desirable Nulls Report
"RTN","ENH6929M",65,0)
 ;
"RTN","ENH6929M",66,0)
 U IO
"RTN","ENH6929M",67,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH6929M",68,0)
 S ENHDR1="Instructions"
"RTN","ENH6929M",69,0)
 S (P,L,ABORT)=0
"RTN","ENH6929M",70,0)
 D HDR^ENH6929U
"RTN","ENH6929M",71,0)
 W !!,"The purpose of this report is to display a list of all ENG EMPLOYEE (#6929)"
"RTN","ENH6929M",72,0)
 W !,"items with missing (empty) data for the fields that are not required in the"
"RTN","ENH6929M",73,0)
 W !,"CoreFLS system.  If fields appearing on this report are left empty, the"
"RTN","ENH6929M",74,0)
 W !,"conversion will either default to a value or convert the field as empty into"
"RTN","ENH6929M",75,0)
 W !,"the CoreFLS system."
"RTN","ENH6929M",76,0)
 W !!,"This report examines the following non-required fields:"
"RTN","ENH6929M",77,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH6929M",78,0)
 W !,"to the field number"
"RTN","ENH6929M",79,0)
 W !!,"     SHOP (#.3)"
"RTN","ENH6929M",80,0)
 W !,"     CLASSIFICATION SERIES (#10.5) - ""Class. Series"""
"RTN","ENH6929M",81,0)
 W !,"     CLASSIFICATION TITLE (#12) - ""Class. Title"""
"RTN","ENH6929M",82,0)
 S L=L+14
"RTN","ENH6929M",83,0)
 I L+6>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",84,0)
 W !!,"The report is sorted by station. When printing or viewing this report, you"
"RTN","ENH6929M",85,0)
 W !,"may select a single station or ALL. Select ""ZZ no station"" to display the"
"RTN","ENH6929M",86,0)
 W !,"records with no entry in the STATION (#2.4) field."
"RTN","ENH6929M",87,0)
 S L=L+4
"RTN","ENH6929M",88,0)
 I L+7>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",89,0)
 W !!,"The totals for each station are as follows:"
"RTN","ENH6929M",90,0)
 W !!,"Total records analyzed - number of records in the ENG EMPLOYEE (#6929) file"
"RTN","ENH6929M",91,0)
 W !,"     assigned to the station"
"RTN","ENH6929M",92,0)
 S L=L+5
"RTN","ENH6929M",93,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",94,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records that"
"RTN","ENH6929M",95,0)
 W !,"     have one or more empty non-required fields"
"RTN","ENH6929M",96,0)
 S L=L+3
"RTN","ENH6929M",97,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",98,0)
 W !!,"Total fields with Non-Required Fields Missing Data - number of non-required"
"RTN","ENH6929M",99,0)
 W !,"     fields that are empty"
"RTN","ENH6929M",100,0)
 S L=L+3
"RTN","ENH6929M",101,0)
 I L+5>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",102,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH6929M",103,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH6929M",104,0)
 S L=L+3
"RTN","ENH6929M",105,0)
 I L+4>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",106,0)
 W !!,"REC IEN - lists the ENG EMPLOYEE (#6929) file internal record number"
"RTN","ENH6929M",107,0)
 S L=L+2
"RTN","ENH6929M",108,0)
 I L+4>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",109,0)
 W !!,"EMPLOYEE NAME - name of the Engineering employee (#.01 field)"
"RTN","ENH6929M",110,0)
 S L=L+2
"RTN","ENH6929M",111,0)
 I L+4>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",112,0)
 W !!,"FIELD NAME - name or abbreviation of the non-required field"
"RTN","ENH6929M",113,0)
 S L=L+2
"RTN","ENH6929M",114,0)
 I L+6>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",115,0)
 W !!,"You should correct every field that appears on the report prior to conversion."
"RTN","ENH6929M",116,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed."
"RTN","ENH6929M",117,0)
 S L=L+3
"RTN","ENH6929M",118,0)
 I L+10>IOSL D HDR^ENH6929U Q:ABORT
"RTN","ENH6929M",119,0)
 W !!,"*** Conversion Note **********************************************"
"RTN","ENH6929M",120,0)
 W !,"If any non-required field on this report is left with missing data,"
"RTN","ENH6929M",121,0)
 W !,"it will be converted as empty into CoreFLS."
"RTN","ENH6929M",122,0)
 W !,"******************************************************************"
"RTN","ENH6929M",123,0)
 ;W !!,"The missing data for these records and fields do not necessarily have to be"
"RTN","ENH6929M",124,0)
 ;W !,"fixed for CoreFLS.  However, in doing so, it would increase the functionality"
"RTN","ENH6929M",125,0)
 ;W !,"of CoreFLS and provide the site with more usable data in CoreFLS after"
"RTN","ENH6929M",126,0)
 ;W !,"conversion. To fix these records, select the record in AEMS/MERS and enter data"
"RTN","ENH6929M",127,0)
 ;W !,"for the non-required fields shown on the report. Once data is entered for all"
"RTN","ENH6929M",128,0)
 ;W !,"non-required fields, this report should not show any remaining records to be"
"RTN","ENH6929M",129,0)
 ;W !,"fixed."
"RTN","ENH6929M",130,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6929M",131,0)
 W @IOF
"RTN","ENH6929M",132,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH6929M",133,0)
 Q
"RTN","ENH6929P")
0^44^B40869127
"RTN","ENH6929P",1,0)
ENH6929P ;WOIFO/DAC/EEN - Engineering Employee Report Print (AMES/MERS) - CoreFLS ;09/30/03 15:25
"RTN","ENH6929P",2,0)
 ;;7.0;Engineering;**79**;Aug 17,1993
"RTN","ENH6929P",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6929P",4,0)
 ;
"RTN","ENH6929P",5,0)
 ; This routine prints Summary and Detailed Reports for the
"RTN","ENH6929P",6,0)
 ; Engineering Employee File (#6929)
"RTN","ENH6929P",7,0)
 ;
"RTN","ENH6929P",8,0)
 Q  ;This routine is not callable from the top
"RTN","ENH6929P",9,0)
 ;
"RTN","ENH6929P",10,0)
INIT ; Initialize Variables
"RTN","ENH6929P",11,0)
 S (P,L,ABORT,ENFLG,TOTANA,CRITREC,BPTREC,DESREC)=0
"RTN","ENH6929P",12,0)
 S (TYP,FLDNAME,FLDNUM)=""
"RTN","ENH6929P",13,0)
 Q
"RTN","ENH6929P",14,0)
 ;
"RTN","ENH6929P",15,0)
OPT1 ; Print Summary Report
"RTN","ENH6929P",16,0)
 I ENHINST=1 D PRT1^ENH6929I Q:ABORT
"RTN","ENH6929P",17,0)
 I '$D(^TMP("ENH6929",$J)) D ^ENH6929L
"RTN","ENH6929P",18,0)
 D INIT
"RTN","ENH6929P",19,0)
 S ENHDR="SUMMARY"
"RTN","ENH6929P",20,0)
 I ENDIVFG="ALL" D
"RTN","ENH6929P",21,0)
 . S DIVN=""
"RTN","ENH6929P",22,0)
 . F  S DIVN=$O(^TMP("ENH6929",$J,"DIV",DIVN)) Q:(DIVN="")!(ENFLG=1)  D
"RTN","ENH6929P",23,0)
 .. S DIV=^TMP("ENH6929",$J,"DIV",DIVN)
"RTN","ENH6929P",24,0)
 .. D L1
"RTN","ENH6929P",25,0)
 I ENDIVFG'="ALL" D
"RTN","ENH6929P",26,0)
 . S DIV=^TMP("ENH6929",$J,"DIV",ENDIVFG),DIVN=ENDIVFG
"RTN","ENH6929P",27,0)
 . D L1
"RTN","ENH6929P",28,0)
 D EORT^ENH6929U
"RTN","ENH6929P",29,0)
 Q
"RTN","ENH6929P",30,0)
L1 U IO
"RTN","ENH6929P",31,0)
 D HDR^ENH6929U I ABORT S ENFLG=1 Q
"RTN","ENH6929P",32,0)
 S TOTANA=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U)
"RTN","ENH6929P",33,0)
 S CRITREC=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U,2)
"RTN","ENH6929P",34,0)
 S BPTREC=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U,3)
"RTN","ENH6929P",35,0)
 S DESREC=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U,4)
"RTN","ENH6929P",36,0)
 S NMCRIT=^TMP("ENH6929",$J,DIV,"CRIT",.01)
"RTN","ENH6929P",37,0)
 S SHOPBPT=^TMP("ENH6929",$J,DIV,"BPT",.3)
"RTN","ENH6929P",38,0)
 S SHOPDES=^TMP("ENH6929",$J,DIV,"DES",.3)
"RTN","ENH6929P",39,0)
 S CSERIDES=^TMP("ENH6929",$J,DIV,"DES",10.5)
"RTN","ENH6929P",40,0)
 S CTITLDES=^TMP("ENH6929",$J,DIV,"DES",12)
"RTN","ENH6929P",41,0)
 D SHDR
"RTN","ENH6929P",42,0)
 W !,"NREQ",?15,"Class. Series",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH6929P",43,0)
 W ?69,$J(CSERIDES,5)
"RTN","ENH6929P",44,0)
 W !,"NREQ",?15,"Class. Title",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH6929P",45,0)
 W ?69,$J(CTITLDES,5)
"RTN","ENH6929P",46,0)
 W !,"REQ",?15,"Name",?35,$J(NMCRIT,5),?52,$J("N/A",5),?69,$J("N/A",5)
"RTN","ENH6929P",47,0)
 W !,"INV, NREQ",?15,"Shop",?35,$J("N/A",5),?52,$J(SHOPBPT,5)
"RTN","ENH6929P",48,0)
 W ?69,$J(SHOPDES,5),!
"RTN","ENH6929P",49,0)
 S L=L+5
"RTN","ENH6929P",50,0)
 I ENDIVFG'="ALL" S ENFLG=1 ; Stop print if single station is picked
"RTN","ENH6929P",51,0)
 Q
"RTN","ENH6929P",52,0)
 ;
"RTN","ENH6929P",53,0)
OPT2 ; Required Fields Missing Data Report
"RTN","ENH6929P",54,0)
 I ENHINST=1 D PRT2^ENH6929I Q:ABORT
"RTN","ENH6929P",55,0)
 I '$D(^TMP("ENH6929",$J))!('$D(^TMP("ENH6929R",$J))) D ^ENH6929L
"RTN","ENH6929P",56,0)
 D INIT
"RTN","ENH6929P",57,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA",TYP="CRIT",ENFILE="ENH6929R"
"RTN","ENH6929P",58,0)
 G PRT
"RTN","ENH6929P",59,0)
 Q
"RTN","ENH6929P",60,0)
 ;
"RTN","ENH6929P",61,0)
OPT3 ; Lookup Fields with Invalid Data Report
"RTN","ENH6929P",62,0)
 I ENHINST=1 D PRT3^ENH6929M Q:ABORT
"RTN","ENH6929P",63,0)
 I '$D(^TMP("ENH6929",$J))!('$D(^TMP("ENH6929R",$J))) D ^ENH6929L
"RTN","ENH6929P",64,0)
 D INIT
"RTN","ENH6929P",65,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA",TYP="BPT",ENFILE="ENH6929R"
"RTN","ENH6929P",66,0)
 G PRT
"RTN","ENH6929P",67,0)
 Q
"RTN","ENH6929P",68,0)
 ;
"RTN","ENH6929P",69,0)
OPT4 ; Non-Required Fields Missing Data Report
"RTN","ENH6929P",70,0)
 I ENHINST=1 D PRT4^ENH6929M Q:ABORT
"RTN","ENH6929P",71,0)
 I '$D(^TMP("ENH6929",$J))!('$D(^TMP("ENH6929R",$J))) D ^ENH6929L
"RTN","ENH6929P",72,0)
 D INIT
"RTN","ENH6929P",73,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA",TYP="DES",ENFILE="ENH6929R"
"RTN","ENH6929P",74,0)
 G PRT
"RTN","ENH6929P",75,0)
 Q
"RTN","ENH6929P",76,0)
 ;
"RTN","ENH6929P",77,0)
PRT ; Start printing of detailed report by station
"RTN","ENH6929P",78,0)
 I ENDIVFG="ALL" D
"RTN","ENH6929P",79,0)
 . S DIVN=""
"RTN","ENH6929P",80,0)
 . F  S DIVN=$O(^TMP("ENH6929",$J,"DIV",DIVN)) Q:(DIVN="")!(ENFLG=1)  D
"RTN","ENH6929P",81,0)
 .. S DIV=^TMP("ENH6929",$J,"DIV",DIVN)
"RTN","ENH6929P",82,0)
 .. D LOOP
"RTN","ENH6929P",83,0)
 I ENDIVFG'="ALL" D
"RTN","ENH6929P",84,0)
 . S DIV=^TMP("ENH6929",$J,"DIV",ENDIVFG),DIVN=ENDIVFG
"RTN","ENH6929P",85,0)
 . D LOOP
"RTN","ENH6929P",86,0)
 D EORT^ENH6929U
"RTN","ENH6929P",87,0)
 K DIVN,TYP
"RTN","ENH6929P",88,0)
 Q
"RTN","ENH6929P",89,0)
 ;
"RTN","ENH6929P",90,0)
LOOP ; Loop through bad records and print
"RTN","ENH6929P",91,0)
 U IO
"RTN","ENH6929P",92,0)
 Q:'$D(TYP)!('$D(DIV))
"RTN","ENH6929P",93,0)
 S TOTANA=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U)
"RTN","ENH6929P",94,0)
 I TYP="CRIT" S TOTREC=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U,2)
"RTN","ENH6929P",95,0)
 I TYP="BPT" S TOTREC=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U,3)
"RTN","ENH6929P",96,0)
 I TYP="DES" S TOTREC=$P($G(^TMP("ENH6929",$J,DIV,"SUM")),U,4)
"RTN","ENH6929P",97,0)
 S TOTFLD=^TMP("ENH6929",$J,DIV,TYP)
"RTN","ENH6929P",98,0)
 D HDR^ENH6929U I ABORT S ENFLG=1 Q
"RTN","ENH6929P",99,0)
 I TYP="CRIT" D CHDR
"RTN","ENH6929P",100,0)
 I TYP="BPT" D BHDR
"RTN","ENH6929P",101,0)
 I TYP="DES" D DHDR
"RTN","ENH6929P",102,0)
 I TOTFLD=0&(TOTREC=0) D  Q
"RTN","ENH6929P",103,0)
 . W !!,"**NO DATA TO PRINT**",!
"RTN","ENH6929P",104,0)
 . S L=L+3
"RTN","ENH6929P",105,0)
 . I ENDIVFG'="ALL" S ENFLG=1
"RTN","ENH6929P",106,0)
 S RECIEN=0
"RTN","ENH6929P",107,0)
 F  S RECIEN=$O(^TMP(ENFILE,$J,DIV,TYP,RECIEN)) Q:'RECIEN!(ENFLG=1)  D
"RTN","ENH6929P",108,0)
 . S FLD=0
"RTN","ENH6929P",109,0)
 . F  S FLD=$O(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD)) Q:'FLD!(ENFLG=1)  D
"RTN","ENH6929P",110,0)
 .. S ENAME=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,2)
"RTN","ENH6929P",111,0)
 .. I ENAME="" S ENAME="ZZ no name"
"RTN","ENH6929P",112,0)
 .. S FLDNAME=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,3)
"RTN","ENH6929P",113,0)
 .. S FLDNUM=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,4)
"RTN","ENH6929P",114,0)
 .. ;S SFIEN=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,5)
"RTN","ENH6929P",115,0)
 .. ;S SFNAME=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,6)
"RTN","ENH6929P",116,0)
 .. W !,$J(RECIEN,8),?10,ENAME,?45,FLDNAME
"RTN","ENH6929P",117,0)
 .. S L=L+1
"RTN","ENH6929P",118,0)
 .. I L+3>IOSL D  Q
"RTN","ENH6929P",119,0)
 ... D HDR^ENH6929U I ABORT S ENFLG=1 Q
"RTN","ENH6929P",120,0)
 ... D OHDR
"RTN","ENH6929P",121,0)
 I ENDIVFG'="ALL" S ENFLG=1 ; Stop Print if single station is picked
"RTN","ENH6929P",122,0)
 Q
"RTN","ENH6929P",123,0)
 ;
"RTN","ENH6929P",124,0)
SHDR ; Summary Report Header
"RTN","ENH6929P",125,0)
 W !!,"Totals for the """_DIVN_""" Station:"
"RTN","ENH6929P",126,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH6929P",127,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH6929P",128,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(CRITREC,5)
"RTN","ENH6929P",129,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(BPTREC,5)
"RTN","ENH6929P",130,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(DESREC,5)
"RTN","ENH6929P",131,0)
 W !!,"DATA QUALITY",?15,"FIELD",?31,"REQUIRED FIELDS",?48,"LOOKUP FIELDS",?65,"NON-REQ. FIELDS"
"RTN","ENH6929P",132,0)
 W !,"CHECK TYPE",?15,"NAME",?31,"MISSING DATA",?48,"W/ INVALID DATA",?65,"MISSING DATA"
"RTN","ENH6929P",133,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6929P",134,0)
 S L=L+11
"RTN","ENH6929P",135,0)
 Q
"RTN","ENH6929P",136,0)
 ;
"RTN","ENH6929P",137,0)
CHDR ; Required Fields w/ Missing Data Report Header
"RTN","ENH6929P",138,0)
 W !!,"Totals for the """_DIVN_""" Station:"
"RTN","ENH6929P",139,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH6929P",140,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH6929P",141,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(TOTREC,5)
"RTN","ENH6929P",142,0)
 W !,"Total fields with Required Fields Missing Data",?55,$J(TOTFLD,5)
"RTN","ENH6929P",143,0)
 W !!,"REC",?10,"EMPLOYEE",?45,"FIELD"
"RTN","ENH6929P",144,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH6929P",145,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6929P",146,0)
 S L=L+10
"RTN","ENH6929P",147,0)
 Q
"RTN","ENH6929P",148,0)
 ;
"RTN","ENH6929P",149,0)
BHDR ; Lookup Fields w/ Invalid Data Report Header
"RTN","ENH6929P",150,0)
 W !!,"Totals for the """_DIVN_""" Station:"
"RTN","ENH6929P",151,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH6929P",152,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH6929P",153,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(TOTREC,5)
"RTN","ENH6929P",154,0)
 W !,"Total fields with Lookup Fields w/ Invalid Data",?55,$J(TOTFLD,5)
"RTN","ENH6929P",155,0)
 W !!,"REC",?10,"EMPLOYEE",?45,"FIELD"
"RTN","ENH6929P",156,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH6929P",157,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6929P",158,0)
 S L=L+10
"RTN","ENH6929P",159,0)
 Q
"RTN","ENH6929P",160,0)
 ;
"RTN","ENH6929P",161,0)
DHDR ; Non-Required Fields w/ Missing Data Report Header
"RTN","ENH6929P",162,0)
 W !!,"Totals for the """_DIVN_""" Station:"
"RTN","ENH6929P",163,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH6929P",164,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH6929P",165,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(TOTREC,5)
"RTN","ENH6929P",166,0)
 W !,"Total fields with Non-Required Fields Missing Data",?55,$J(TOTFLD,5)
"RTN","ENH6929P",167,0)
 W !!,"REC",?10,"EMPLOYEE",?45,"FIELD"
"RTN","ENH6929P",168,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH6929P",169,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6929P",170,0)
 S L=L+10
"RTN","ENH6929P",171,0)
 Q
"RTN","ENH6929P",172,0)
 ;
"RTN","ENH6929P",173,0)
OHDR ; Header for subsequent pages for detailed reports
"RTN","ENH6929P",174,0)
 W !!,"Totals for the """_DIVN_""" Station:"
"RTN","ENH6929P",175,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH6929P",176,0)
 W !!,"REC",?10,"EMPLOYEE",?45,"FIELD"
"RTN","ENH6929P",177,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH6929P",178,0)
 W ! F I=1:1:80 W "="
"RTN","ENH6929P",179,0)
 S L=L+7
"RTN","ENH6929P",180,0)
 Q
"RTN","ENH6929U")
0^45^B2982413
"RTN","ENH6929U",1,0)
ENH6929U ;WOIFO/DAC/EEN - Engineering Employee Report Utilities (AMES/MERS) - CoreFLS ;09/30/03 15:25
"RTN","ENH6929U",2,0)
 ;;7.0;Engineering;**79**;Aug 17,1993
"RTN","ENH6929U",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH6929U",4,0)
 ;
"RTN","ENH6929U",5,0)
HDR ; Print the standard report header.
"RTN","ENH6929U",6,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH6929U",7,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH6929U",8,0)
 ; Do not print a form feed before first page on printer.
"RTN","ENH6929U",9,0)
 ; Top of form is set at end of previous report.
"RTN","ENH6929U",10,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH6929U",11,0)
 S P=P+1,L=4
"RTN","ENH6929U",12,0)
 W !,"ENG EMPLOYEE (#6929) - "_$G(ENHDR),?67,"Page: ",$J(P,5,0)
"RTN","ENH6929U",13,0)
 W !,"CoreFLS Data Cleansing Report ",$G(ENHDR1),?58,"Printed ",$$FMTE^XLFDT(DT)
"RTN","ENH6929U",14,0)
 Q
"RTN","ENH6929U",15,0)
 ;
"RTN","ENH6929U",16,0)
EORT ; Report completed
"RTN","ENH6929U",17,0)
 I 'ABORT D
"RTN","ENH6929U",18,0)
 . W !!,"<End of Report>"
"RTN","ENH6929U",19,0)
 . I $E(IOST,1,2)="C-" W " Enter RETURN to continue" R Y:DTIME
"RTN","ENH6929U",20,0)
 I ABORT W !,"<Report Aborted>"
"RTN","ENH6929U",21,0)
 D ^%ZISC
"RTN","ENH6929U",22,0)
 K L,P,X,Y,ABORT
"RTN","ENH6929U",23,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH6929U",24,0)
 Q
"RTN","ENH6929U",25,0)
 ;
"RTN","ENH6929U",26,0)
INST ; Print Instructions for Summary Report
"RTN","ENH6929U",27,0)
 ;
"RTN","ENH6929U",28,0)
 ;  Variables:
"RTN","ENH6929U",29,0)
 ;    ENHRPT = Type of report
"RTN","ENH6929U",30,0)
 ;           1 - Summary Report
"RTN","ENH6929U",31,0)
 ;           2 - Critical Fields Report
"RTN","ENH6929U",32,0)
 ;           3 - Broken Pointers Report
"RTN","ENH6929U",33,0)
 ;           4 - Desirable Fields Report
"RTN","ENH6929U",34,0)
 ;
"RTN","ENH6929U",35,0)
 D HOME^%ZIS
"RTN","ENH6929U",36,0)
 ;W @IOF
"RTN","ENH6929U",37,0)
 K DIR
"RTN","ENH6929U",38,0)
 S DIR(0)="Y"
"RTN","ENH6929U",39,0)
 S DIR("A")="Do you wish to print the instructions for this report"
"RTN","ENH6929U",40,0)
 S DIR("A",1)=" "
"RTN","ENH6929U",41,0)
 S DIR("B")="NO"
"RTN","ENH6929U",42,0)
 S DIR("?")="Please enter Y to print the instructions or N to skip the instructions"
"RTN","ENH6929U",43,0)
 D ^DIR K DIR
"RTN","ENH6929U",44,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH6929U",45,0)
 S ENHINST=Y
"RTN","ENH6929U",46,0)
 Q
"VER")
8.0^22
**END**
**END**
