Released DI*22*138 SEQ #122
Extracted from mail message
**KIDS**:DI*22.0*138^

**INSTALL NAME**
DI*22.0*138
"BLD",536,0)
DI*22.0*138^VA FILEMAN^0^3040321^y
"BLD",536,1,0)
^^2^2^3040317^
"BLD",536,1,1,0)
See patch DI*22*138 in the National Patch Module on FORUM for complete
"BLD",536,1,2,0)
information on this patch.
"BLD",536,4,0)
^9.64PA^^
"BLD",536,"KRN",0)
^9.67PA^8989.52^19
"BLD",536,"KRN",.4,0)
.4
"BLD",536,"KRN",.401,0)
.401
"BLD",536,"KRN",.402,0)
.402
"BLD",536,"KRN",.403,0)
.403
"BLD",536,"KRN",.5,0)
.5
"BLD",536,"KRN",.84,0)
.84
"BLD",536,"KRN",3.6,0)
3.6
"BLD",536,"KRN",3.8,0)
3.8
"BLD",536,"KRN",9.2,0)
9.2
"BLD",536,"KRN",9.8,0)
9.8
"BLD",536,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",536,"KRN",9.8,"NM",1,0)
DIO0^^0^B16657571
"BLD",536,"KRN",9.8,"NM","B","DIO0",1)

"BLD",536,"KRN",19,0)
19
"BLD",536,"KRN",19.1,0)
19.1
"BLD",536,"KRN",101,0)
101
"BLD",536,"KRN",409.61,0)
409.61
"BLD",536,"KRN",771,0)
771
"BLD",536,"KRN",870,0)
870
"BLD",536,"KRN",8989.51,0)
8989.51
"BLD",536,"KRN",8989.52,0)
8989.52
"BLD",536,"KRN",8994,0)
8994
"BLD",536,"KRN","B",.4,.4)

"BLD",536,"KRN","B",.401,.401)

"BLD",536,"KRN","B",.402,.402)

"BLD",536,"KRN","B",.403,.403)

"BLD",536,"KRN","B",.5,.5)

"BLD",536,"KRN","B",.84,.84)

"BLD",536,"KRN","B",3.6,3.6)

"BLD",536,"KRN","B",3.8,3.8)

"BLD",536,"KRN","B",9.2,9.2)

"BLD",536,"KRN","B",9.8,9.8)

"BLD",536,"KRN","B",19,19)

"BLD",536,"KRN","B",19.1,19.1)

"BLD",536,"KRN","B",101,101)

"BLD",536,"KRN","B",409.61,409.61)

"BLD",536,"KRN","B",771,771)

"BLD",536,"KRN","B",870,870)

"BLD",536,"KRN","B",8989.51,8989.51)

"BLD",536,"KRN","B",8989.52,8989.52)

"BLD",536,"KRN","B",8994,8994)

"BLD",536,"QUES",0)
^9.62^^
"BLD",536,"REQB",0)
^9.611^1^1
"BLD",536,"REQB",1,0)
DI*22.0*23^2
"BLD",536,"REQB","B","DI*22.0*23",1)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
VA FILEMAN^DI^FM INIT
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
22.0^2990330^3030110^41
"PKG",5,22,1,"PAH",1,0)
138^3040321
"PKG",5,22,1,"PAH",1,1,0)
^^2^2^3040321
"PKG",5,22,1,"PAH",1,1,1,0)
See patch DI*22*138 in the National Patch Module on FORUM for complete
"PKG",5,22,1,"PAH",1,1,2,0)
information on this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DIO0")
0^1^B16657571
"RTN","DIO0",1,0)
DIO0 ;SFISC/GFT,TKW-BUILD SORT AND SUB-HDR ;1:17 PM  21 Mar 2004
"RTN","DIO0",2,0)
 ;;22.0;VA FileMan;**2,23,138**;Mar 30, 1999
"RTN","DIO0",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","DIO0",4,0)
 ;
"RTN","DIO0",5,0)
 S C=",",Z=Z+1,DE=$P(DN,C,Z)_"=$O("_DI_$P(DN,C,1,Z)_")),DN="_(Z+1) ;22*138
"RTN","DIO0",6,0)
 I Z=1,$G(DPP(DJK,"PTRIX"))]"" D
"RTN","DIO0",7,0)
DIOO1 . S DE="DIOO1=$O("_DPP(DJK,"PTRIX")_"DIOO1)),DN=1.5,DD00=0"
"RTN","DIO0",8,0)
 . S DY(1.5)="S DD00=$O("_DPP(DJK,"PTRIX")_"DIOO1,DD00)),DN=2 S:'DD00 DN=1"
"RTN","DIO0",9,0)
 . I DPP(DJK,"PTRIX")?.E1"""B""," S DY(1.5)=DY(1.5)_" S:DD00&($G(^(+DD00))!('($D(^(+DD00))=1))) DN=1"
"RTN","DIO0",10,0)
 . Q
"RTN","DIO0",11,0)
 I DPQ,Z=1,$D(DPP(DJK,"IX")),$O(DPP(DJK,0)) D
"RTN","DIO0",12,0)
 .S DXIX=$P(DPP(DJK),U) Q:'DXIX  S DXIX(DXIX)=U_$P(DPP(DJK,"IX"),U,2)_$S($D(DPP(DJK,"PTRIX")):"DD00,D0",1:DN)
"RTN","DIO0",13,0)
 .S W=0,%(1)="" F %=0:0 S W=$O(DPP(DJK,W)) Q:'W  S %=%+1,%(1)=%(1)_C_"D"_%
"RTN","DIO0",14,0)
 .S DXIX(DXIX)=DXIX(DXIX)_%(1)
"RTN","DIO0",15,0)
 .K %,W Q
"RTN","DIO0",16,0)
 I Z<$G(DPP(0)) S Y=$P($G(DPP(Z+1,"F")),U) I Y]""!($G(DPP(Z+1,"T"))]"") S:+$P(Y,"E")'=Y Y=""""_Y_"""" S DE=DE_","_$P(DN,C,Z+1)_"="_Y
"RTN","DIO0",17,0)
 I 'DPQ,$D(DPP(Z)) D H
"RTN","DIO0",18,0)
 I DPQ,Z=DD S DE=DE_" S:D0 DISTP=DISTP+1 D:'(DISTP#100) CSTP"_$P("^DIO2",1,$D(DIBTPGM))_" Q:'DN "
"RTN","DIO0",19,0)
 S X=DE_" I "_$P(DN,C,Z)_$S(DD=Z:"'>0",1:"=""""")
"RTN","DIO0",20,0)
 S Y="" D
"RTN","DIO0",21,0)
 .I Z=1,$D(DPP(DJK,"T")),$D(DPP(DJK,"IX")) S Y=$P(DPP(DJK,"T"),U)
"RTN","DIO0",22,0)
 .I $G(DPP(0)),Z<(DPP(0)+1) S Y=$P($G(DPP(Z,"T")),U)
"RTN","DIO0",23,0)
 .I Y]"",Y'="@",Y'="z" S X=X_"!("_$$AFT^DIOC($P(DN,C,Z),Y)_")"
"RTN","DIO0",24,0)
 .Q
"RTN","DIO0",25,0)
D0 S X=X_" S DN="_$S(Z=DD&($D(DPP(DJK,"PTRIX"))):1.5,1:(Z-1)),Y=Z-1 I Z=1 S X=X_",D0=-1" I $D(DPP(DJK,"PTRIX")) S X=X_" K DD00",$P(DN,C,1)="DD00"
"RTN","DIO0",26,0)
 I 'DPQ,$D(DPP(Y)) S:$P(DPP(Y),U,4)["!" X="DRK=DRK+1,"_X_",DRK=0",DRK=0 D SUB
"RTN","DIO0",27,0)
 S DY(Z)="S "_X
"RTN","DIO0",28,0)
 I $D(DIBTPGM) D
"RTN","DIO0",29,0)
 . S DY(Z)=$S(Z'=1:"DY"_Z,1:"EN")_" Q:'DN  "_DY(Z)_$S(Z=1:" Q",Z=2&($D(DPP(DJK,"PTRIX"))):" G DYP",Z=2:" G EN",1:" G DY"_(Z-1))
"RTN","DIO0",30,0)
 . I $D(DPP(DJK,"PTRIX")),Z=1 S DY(1.5)="DYP Q:'DN  "_DY(1.5)_" G:DN=1 EN"
"RTN","DIO0",31,0)
 . Q
"RTN","DIO0",32,0)
 G DIO0:Z<DD
"RTN","DIO0",33,0)
 F %=1:1 Q:'$D(DPP(%))  K DPP(%,"PTRIX")
"RTN","DIO0",34,0)
 S %=$S($G(DIO("SCR"))=1:"O",$D(DIS)<9:"O",$D(DIS)=11:"SCR",1:"SEARCH")
"RTN","DIO0",35,0)
 S DY(Z+1)="S DN="_Z_" " I DJ["""B"",^" S DY(Z+1)=DY(Z+1)_"I $D("_DI_$P(DN,C,1,Z)_"))'[0,'^(D0) "
"RTN","DIO0",36,0)
 S DY(Z+1)=DY(Z+1)_"D "_%,Y=Z,X=""
"RTN","DIO0",37,0)
 I 'DPQ,$D(DPP(Y)),$P(DPP(Y),U,2)=0 D SUB I  S DY(Z+1)=DY(Z+1)_" S "_$E(X,2,99)
"RTN","DIO0",38,0)
 I A=1 D:$D(DIBTPGM) SETU Q
"RTN","DIO0",39,0)
 S X=C F W=1:1:A-1 S ^DOSV(0,IO(0),"BY",W)=DPP(A(W)),X=X_$P(DN,C,A(W))_C,A(W)="Q"
"RTN","DIO0",40,0)
 S A(W)="S ^DOSV(0,IO(0)"_C_W_X_"V,DE)=Y"
"RTN","DIO0",41,0)
 D:$D(DIBTPGM) SETU Q
"RTN","DIO0",42,0)
 ;
"RTN","DIO0",43,0)
SUB I $P($G(DPP(Y)),U,4)["+" S A(A)=Y,X=X_",A="_A_" D"_$S($D(DIS)<9:"",1:":$D(DIPASS)")_" ^DIO3"_$S($D(DIS)<9:"",1:" K DIPASS"),A=A+1
"RTN","DIO0",44,0)
 Q
"RTN","DIO0",45,0)
 ;
"RTN","DIO0",46,0)
H S DOP=0 I $D(DNP) F W=1:1 G Q:'$D(DPP(W)) I DPP(W)["+" K DNP S DOP=1 Q
"RTN","DIO0",47,0)
 S Y=$P(DN,C,Z),F=$P(DPP(Z),U,5),W=$P(DPP(Z),U,4),X=$P(W,"""",2),V=+$P(DPP(Z),U,2) S:W["-" Y="(999999999-"_Y_")" I F'[""""&'$D(DPQ(+DPP(Z),V+X))&'DOP!(W["@")!(W["'")!$D(DISH) S (Y,V)="" G F:F]"",U
"RTN","DIO0",48,0)
 I F[";TXT" S Y="$E("_Y_",2,$L("_Y_"))"
"RTN","DIO0",49,0)
 S X=$S($D(^DD(+DPP(Z),V,0)):^(0),1:$P(DPP(Z),U,6,9)) I $P(X,U,2)["D" S Y=" S Y="_Y_" D DT"
"RTN","DIO0",50,0)
 E  I $G(DPP(Z,"OUT"))]"" S DPP(Z,"OUT")=" S Y="_Y_" "_DPP(Z,"OUT"),Y=",Y"
"RTN","DIO0",51,0)
 E  I $P(X,U,2)["O"!($P(X,U,4)?.P) S Y=C_Y
"RTN","DIO0",52,0)
 E  D ^DILL
"RTN","DIO0",53,0)
 S V=$P(F,";C",2),V="?"_$S(V:V-1,1:Z*3+5)
"RTN","DIO0",54,0)
F I F[";S" S %=$P(F,";S",2) S:'% %=1 S V=$E("!!!!!!!!!!!!!!!!!!!!!!!!!!!!",1,%)_V,M=M+%
"RTN","DIO0",55,0)
 S F=$P(F,";""",2),%=$S(W["@":"",W["'":"",F]"":$P(F,"""",1,$L(F,"""")-1),Y]"":$P($P(DPP(Z),U,3),"""",1)_": ",1:""),Y=V_$S(%_Y]"":$E(",",V]"")_""""_%_"""",1:"")_Y I Y]"" S Y=" D T"_$G(DPP(Z,"OUT"))_" W "_Y
"RTN","DIO0",56,0)
U S W=W'["#" I W,Y="",$D(DPP(Z+1)) G E
"RTN","DIO0",57,0)
 S ^UTILITY($J,"H",Z)="X ^UTILITY($J,1)"_$P(":$Y>"_(DIOSL-M-2-DD+Z)_"!(DC["","")",U,W)_Y,Y="D H:DI<DN ",DE=DE_$S(Z=1:",DI=0",1:" S:DI>"_Z_" DI="_Z)
"RTN","DIO0",58,0)
 S:^UTILITY($J,99,0)'[Y ^(0)=Y_^(0)
"RTN","DIO0",59,0)
E I DOP S DNP=""
"RTN","DIO0",60,0)
Q K DOP Q
"RTN","DIO0",61,0)
 ;
"RTN","DIO0",62,0)
SETU ;PUT DY ARRAY INTO ^UTILITY FOR LATER COMPILATION
"RTN","DIO0",63,0)
 N DN
"RTN","DIO0",64,0)
 F DN=0:0 S DN=$O(DY(DN)) Q:'DN  D
"RTN","DIO0",65,0)
 .S ^TMP("DIBTC",$J,0,DICNT)=$E(" ",'$O(DY(DN)))_DY(DN),DICNT=DICNT+1
"RTN","DIO0",66,0)
 .I '$O(DY(DN)) S ^TMP("DIBTC",$J,0,DICNT)=$S(DN>2:" G DY"_(DN-1),1:" G EN"),DICNT=DICNT+1
"RTN","DIO0",67,0)
 .Q
"RTN","DIO0",68,0)
 Q
"VER")
8^22.0
**END**
**END**
