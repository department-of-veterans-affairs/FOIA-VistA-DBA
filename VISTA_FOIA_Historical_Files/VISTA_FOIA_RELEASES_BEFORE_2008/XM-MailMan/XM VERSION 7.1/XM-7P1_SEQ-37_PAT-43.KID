Released XM*7.1*43 SEQ #37
Extracted from mail message
**KIDS**:XM*7.1*43^

**INSTALL NAME**
XM*7.1*43
"BLD",26,0)
XM*7.1*43^MAILMAN^0^2970325^n
"BLD",26,1,0)
^^40^40^2970325^^^^
"BLD",26,1,1,0)
MailMan patch XM*7.1*43 contains the following bug fix:
"BLD",26,1,2,0)

"BLD",26,1,3,0)
NOIS:       DAY-0397-41813
"BLD",26,1,4,0)
Rtns:       ^XMAI1
"BLD",26,1,5,0)
Test Site:  Dayton,OH
"BLD",26,1,6,0)
Translate the date of a remote-originated message to FileMan before comparing
"BLD",26,1,7,0)
it to the purge date.
"BLD",26,1,8,0)

"BLD",26,1,9,0)
===========================================================================
"BLD",26,1,10,0)
This patch may be installed at any time, except when the IN-BASKET-PURGE
"BLD",26,1,11,0)
is running.
"BLD",26,1,12,0)
===========================================================================
"BLD",26,1,13,0)
 
"BLD",26,1,14,0)
INSTALLATION:
"BLD",26,1,15,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"BLD",26,1,16,0)
    disable mapping for the affected routine(s).
"BLD",26,1,17,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"BLD",26,1,18,0)
    the patch into a Transport Global on your system.
"BLD",26,1,19,0)
3.  On the KIDS:Installation menu, use the following options to install the
"BLD",26,1,20,0)
    Transport Global:
"BLD",26,1,21,0)
       Verify Checksums in Transport Global
"BLD",26,1,22,0)
       Print Transport Global
"BLD",26,1,23,0)
       Compare Transport Global to Current System
"BLD",26,1,24,0)
       Backup a Transport Global
"BLD",26,1,25,0)
       Install Package(s)
"BLD",26,1,26,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"BLD",26,1,27,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"BLD",26,1,28,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"BLD",26,1,29,0)
============================================================================ 
"BLD",26,1,30,0)
  
"BLD",26,1,31,0)
ROUTINES:
"BLD",26,1,32,0)
The second line of the routine now looks like:
"BLD",26,1,33,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"BLD",26,1,34,0)
 
"BLD",26,1,35,0)
              Before          After
"BLD",26,1,36,0)
Name          Checksum        Checksum        Patch List
"BLD",26,1,37,0)
----------------------------------------------------------
"BLD",26,1,38,0)
XMAI1          7933692         8026797        43
"BLD",26,1,39,0)

"BLD",26,1,40,0)
============================================================================
"BLD",26,4,0)
^9.64PA^^0
"BLD",26,"INI")

"BLD",26,"INIT")

"BLD",26,"KRN",0)
^9.67PA^19^12
"BLD",26,"KRN",.4,0)
.4
"BLD",26,"KRN",.401,0)
.401
"BLD",26,"KRN",.402,0)
.402
"BLD",26,"KRN",.403,0)
.403
"BLD",26,"KRN",.5,0)
.5
"BLD",26,"KRN",.84,0)
.84
"BLD",26,"KRN",3.6,0)
3.6
"BLD",26,"KRN",3.8,0)
3.8
"BLD",26,"KRN",9.2,0)
9.2
"BLD",26,"KRN",9.8,0)
9.8
"BLD",26,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",26,"KRN",9.8,"NM",1,0)
XMAI1^^0^B18157890
"BLD",26,"KRN",9.8,"NM","B","XMAI1",1)

"BLD",26,"KRN",19,0)
19
"BLD",26,"KRN",19,"NM",0)
^9.68A^^
"BLD",26,"KRN",19.1,0)
19.1
"BLD",26,"KRN","B",.4,.4)

"BLD",26,"KRN","B",.401,.401)

"BLD",26,"KRN","B",.402,.402)

"BLD",26,"KRN","B",.403,.403)

"BLD",26,"KRN","B",.5,.5)

"BLD",26,"KRN","B",.84,.84)

"BLD",26,"KRN","B",3.6,3.6)

"BLD",26,"KRN","B",3.8,3.8)

"BLD",26,"KRN","B",9.2,9.2)

"BLD",26,"KRN","B",9.8,9.8)

"BLD",26,"KRN","B",19,19)

"BLD",26,"KRN","B",19.1,19.1)

"BLD",26,"QUES",0)
^9.62^^
"BLD",26,"REQB",0)
^9.611^^
"PKG",6,-1)
1^1
"PKG",6,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
7.1^2940602^2950925
"PKG",6,22,1,"PAH",1,0)
43^2970325
"PKG",6,22,1,"PAH",1,1,0)
^^40^40^2970325
"PKG",6,22,1,"PAH",1,1,1,0)
MailMan patch XM*7.1*43 contains the following bug fix:
"PKG",6,22,1,"PAH",1,1,2,0)

"PKG",6,22,1,"PAH",1,1,3,0)
NOIS:       DAY-0397-41813
"PKG",6,22,1,"PAH",1,1,4,0)
Rtns:       ^XMAI1
"PKG",6,22,1,"PAH",1,1,5,0)
Test Site:  Dayton,OH
"PKG",6,22,1,"PAH",1,1,6,0)
Translate the date of a remote-originated message to FileMan before comparing
"PKG",6,22,1,"PAH",1,1,7,0)
it to the purge date.
"PKG",6,22,1,"PAH",1,1,8,0)

"PKG",6,22,1,"PAH",1,1,9,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,10,0)
This patch may be installed at any time, except when the IN-BASKET-PURGE
"PKG",6,22,1,"PAH",1,1,11,0)
is running.
"PKG",6,22,1,"PAH",1,1,12,0)
===========================================================================
"PKG",6,22,1,"PAH",1,1,13,0)
 
"PKG",6,22,1,"PAH",1,1,14,0)
INSTALLATION:
"PKG",6,22,1,"PAH",1,1,15,0)
1.  If any of these routines is mapped (on systems which allow mapping),
"PKG",6,22,1,"PAH",1,1,16,0)
    disable mapping for the affected routine(s).
"PKG",6,22,1,"PAH",1,1,17,0)
2.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This loads
"PKG",6,22,1,"PAH",1,1,18,0)
    the patch into a Transport Global on your system.
"PKG",6,22,1,"PAH",1,1,19,0)
3.  On the KIDS:Installation menu, use the following options to install the
"PKG",6,22,1,"PAH",1,1,20,0)
    Transport Global:
"PKG",6,22,1,"PAH",1,1,21,0)
       Verify Checksums in Transport Global
"PKG",6,22,1,"PAH",1,1,22,0)
       Print Transport Global
"PKG",6,22,1,"PAH",1,1,23,0)
       Compare Transport Global to Current System
"PKG",6,22,1,"PAH",1,1,24,0)
       Backup a Transport Global
"PKG",6,22,1,"PAH",1,1,25,0)
       Install Package(s)
"PKG",6,22,1,"PAH",1,1,26,0)
4.  MSM Sites - Answer YES to the question 'Want to MOVE routines to
"PKG",6,22,1,"PAH",1,1,27,0)
    other CPUs?'. Enter the names of your Compute and Print server(s).
"PKG",6,22,1,"PAH",1,1,28,0)
5.  AXP Sites, after patch has installed, rebuild your map set.
"PKG",6,22,1,"PAH",1,1,29,0)
============================================================================ 
"PKG",6,22,1,"PAH",1,1,30,0)
  
"PKG",6,22,1,"PAH",1,1,31,0)
ROUTINES:
"PKG",6,22,1,"PAH",1,1,32,0)
The second line of the routine now looks like:
"PKG",6,22,1,"PAH",1,1,33,0)
       ;;7.1;MailMan;**[patch list]**;Jun 02, 1994
"PKG",6,22,1,"PAH",1,1,34,0)
 
"PKG",6,22,1,"PAH",1,1,35,0)
              Before          After
"PKG",6,22,1,"PAH",1,1,36,0)
Name          Checksum        Checksum        Patch List
"PKG",6,22,1,"PAH",1,1,37,0)
----------------------------------------------------------
"PKG",6,22,1,"PAH",1,1,38,0)
XMAI1          7933692         8026797        43
"PKG",6,22,1,"PAH",1,1,39,0)

"PKG",6,22,1,"PAH",1,1,40,0)
============================================================================
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","XMAI1")
0^1^B18157890
"RTN","XMAI1",1,0)
XMAI1 ;(WASH ISC)/CAP-'IN' Basket PURGE / Send Bulletin... ;03/25/97  10:35
"RTN","XMAI1",2,0)
 ;;7.1;MailMan;**43**;Jun 02, 1994
"RTN","XMAI1",3,0)
 ;Variables
"RTN","XMAI1",4,0)
 ;XMA0=Date Messages must be older than or inactive since
"RTN","XMAI1",5,0)
 ;XMB0=Date that messages will be purged after
"RTN","XMAI1",6,0)
 ;XMC0=Count & array of message found that meet criteria
"RTN","XMAI1",7,0)
 ;XMG0=Mail Basket
"RTN","XMAI1",8,0)
 ;XMH0=Process IN Basket only if 0, ALL baskets if 1
"RTN","XMAI1",9,0)
 Q
"RTN","XMAI1",10,0)
ENT S XMAI1=$S($G(XMAI1):XMAI1,1:30),XME0=.999,X="T+"_XMAI1 D ^%DT S XMB0=Y
"RTN","XMAI1",11,0)
 K XMC0,^TMP("XMAI1",$J) S XMH0=$P($G(^XMB(1,1,.15)),U)
"RTN","XMAI1",12,0)
 I '$D(ZTQUEUED) W !!,"Compiling lists of messages to PURGE in 30 days (after "_$E(XMB0,4,5)_"/"_$E(XMB0,6,7)_"/"_$E(XMB0,2,3)_").",!,"from "_$S(XMH0<1:"users IN B",1:"*** ALL *** b")_"askets",!!
"RTN","XMAI1",13,0)
 ;
"RTN","XMAI1",14,0)
 ;Process Mail Box (User)
"RTN","XMAI1",15,0)
A S XME0=$O(^XMB(3.7,XME0)) G Q:+XME0'=XME0 I '$D(ZTQUEUED) W "."
"RTN","XMAI1",16,0)
 I $F($G(XMAI0),":"_XME0_":") G A
"RTN","XMAI1",17,0)
 S XMC0=1,^TMP("XMAI1",$J,1)=""
"RTN","XMAI1",18,0)
 I XMH0<1 S I=0,XMG0="1^IN" D B G S
"RTN","XMAI1",19,0)
 S XMG0=.999
"RTN","XMAI1",20,0)
 F  S XMG0=$O(^XMB(3.7,XME0,2,+XMG0)) Q:+XMG0'=XMG0  S I=0,XMG0=XMG0_"^"_$E($P($G(^(+XMG0,0)),U),1,12) D B
"RTN","XMAI1",21,0)
 G S
"RTN","XMAI1",22,0)
B ;Process Basket
"RTN","XMAI1",23,0)
 N XMZDATE
"RTN","XMAI1",24,0)
 F  S I=$O(^XMB(3.7,XME0,2,+XMG0,1,I)) Q:+I'=I  S X=$G(^(I,0)) D
"RTN","XMAI1",25,0)
 . Q:X=""!(+$P(X,U,3)>0)!$P(X,U,5)!($P(X,U,4)>XMA0)!$D(^XMB(3.73,"AC",I,XME0))
"RTN","XMAI1",26,0)
 . I $P(X,U,4)="" D  Q:XMZDATE>XMA0
"RTN","XMAI1",27,0)
 . . S XMZDATE=$P($G(^XMB(3.9,I,0)),U,3)
"RTN","XMAI1",28,0)
 . . S:XMZDATE'?7N1".".N XMZDATE=$$CONVERT^XMA32A(XMZDATE)
"RTN","XMAI1",29,0)
 . ;Mark message w/delete date, put into x-ref
"RTN","XMAI1",30,0)
 . S $P(^XMB(3.7,XME0,2,+XMG0,1,I,0),U,5)=XMB0_"*"
"RTN","XMAI1",31,0)
 . S ^XMB(3.7,"AC",XMB0,XME0,+XMG0,I)=""
"RTN","XMAI1",32,0)
 . S %=^TMP("XMAI1",$J,XMC0)
"RTN","XMAI1",33,0)
 . I $L(%)>180 S XMC0=XMC0+1,%=""
"RTN","XMAI1",34,0)
 . S %=I_" "_$P(X,U,4)_" "_$P(XMG0,U,2)_U_%
"RTN","XMAI1",35,0)
 . S ^TMP("XMAI1",$J,XMC0)=%
"RTN","XMAI1",36,0)
 Q
"RTN","XMAI1",37,0)
 ;SET UP MESSAGE
"RTN","XMAI1",38,0)
S G A:^TMP("XMAI1",$J,1)=""
"RTN","XMAI1",39,0)
 S XMSUB="'IN' BASKET MAINTENANCE",^TMP("XMY",$J,XME0)="" D GET^XMA2
"RTN","XMAI1",40,0)
 S X=$S(XMH0<1:"'IN Basket'",1:"'Mail Box'")
"RTN","XMAI1",41,0)
 S ^XMB(3.9,XMZ,2,1,0)="The messages listed have been in your "_X_" for more than "_XMD0_" days."
"RTN","XMAI1",42,0)
 S ^XMB(3.9,XMZ,2,2,0)="If these messages remain in your "_X_" until "_XMF0
"RTN","XMAI1",43,0)
 S ^XMB(3.9,XMZ,2,3,0)="without being read"_$S(XMH0<1:", Saved into another basket",1:" ")_" or made NEW, they will be deleted."
"RTN","XMAI1",44,0)
 S ^XMB(3.9,XMZ,2,4,0)=" "
"RTN","XMAI1",45,0)
 S ^XMB(3.9,XMZ,2,5,0)="    Last         Date"
"RTN","XMAI1",46,0)
 S ^XMB(3.9,XMZ,2,6,0)="    Read/      Message     Sender/"
"RTN","XMAI1",47,0)
 S ^XMB(3.9,XMZ,2,7,0)="  {Basket}     [Number]    Subject"
"RTN","XMAI1",48,0)
 S XMC0=8
"RTN","XMAI1",49,0)
S3 ;ENTER MESSAGES INTO TEXT OF MESSAGE
"RTN","XMAI1",50,0)
 ;
"RTN","XMAI1",51,0)
 S ^XMB(3.9,XMZ,2,XMC0,0)=" ",I=0
"RTN","XMAI1",52,0)
S4 S I=$O(^TMP("XMAI1",$J,I)) G F:I="" S A=^(I)
"RTN","XMAI1",53,0)
S5 S %=$P(A,U),A=$P(A,U,2,99) I %="" G S5:A'="",S4
"RTN","XMAI1",54,0)
 S D=$S($D(^XMB(3.9,+%,0)):^(0),1:"")
"RTN","XMAI1",55,0)
 I D="" S XMZ1=XMZ,XMZ=+% D KL^XMA1B S XMZ=XMZ1 K XMZ1 G S5
"RTN","XMAI1",56,0)
 S X=$P(%," ",3),XMC0=XMC0+2
"RTN","XMAI1",57,0)
 S ^XMB(3.9,XMZ,2,XMC0,0)="{"_X_"}"_$E("             ",1,13-$L(X))_"["_+%_"]"_$E("      ",7-$L(XMZ),9)_"  Subject: "_$P(D,U)
"RTN","XMAI1",58,0)
 S X=$P(D,U,2) I X,$D(^VA(200,X,0)) S X=$P(^(0),U)
"RTN","XMAI1",59,0)
 S J="From: "_$S(+X=X:"USER NUMBER: "_X,1:X),X=$P(D,U,3) D DT
"RTN","XMAI1",60,0)
 S J=Y_"    "_J,X=$P(%," ",2) D DT
"RTN","XMAI1",61,0)
 E  S X="         "
"RTN","XMAI1",62,0)
 S J=Y_"    "_J,^XMB(3.9,XMZ,2,XMC0-1,0)=J
"RTN","XMAI1",63,0)
 G S5
"RTN","XMAI1",64,0)
DT I X'?7N.E S Y=X Q
"RTN","XMAI1",65,0)
 S Y=$E(X,6,7)_" "_$P("Jan^Feb^Mar^Apr^May^Jun^Jul^Aug^Sep^Oct^Nov^Dec",U,+$E(X,4,5))_" "_$E(X,2,3) Q
"RTN","XMAI1",66,0)
F K XMY,XMY0,^TMP("XMY",$J),^TMP("XMY0",$J),^TMP("XMAI1",$J)
"RTN","XMAI1",67,0)
 S ^TMP("XMY",$J,XME0)="",^TMP("XMY0",$J,XME0)=""
"RTN","XMAI1",68,0)
 S $P(^XMB(3.9,XMZ,0),U,12)="y",^(2,0)="^3.92A^"_XMC0_U_XMC0_U_DT D XMAD1
"RTN","XMAI1",69,0)
 G A
"RTN","XMAI1",70,0)
Q S XMDUZ=XMDUZO
"RTN","XMAI1",71,0)
 K %I,%H,XMA0,XMB0,XMC0,XMD0,XMDUZO,XMF0,XME0,XMG0,XMH0,XMHOLD
"RTN","XMAI1",72,0)
 K XMAI0,XMAI1,XMR,XMSUB,XMZ,X1,X2
"RTN","XMAI1",73,0)
 Q
"RTN","XMAI1",74,0)
XMAD1 N XMA0,XMB0,XMC0,XMD0,XME0,XMF0,XMG0,XMH0 D ENT^XMAD1
"RTN","XMAI1",75,0)
 Q
"RTN","XMAI1",76,0)
HELP ;Executable help text for field 10.01 of file 4.3
"RTN","XMAI1",77,0)
 W !!,"Enter 0 or delete the data in this field if the IN-BASKET-PURGE"
"RTN","XMAI1",78,0)
 W !,"should be run only for users IN Baskets."
"RTN","XMAI1",79,0)
 W !!,"Enter 1 if the IN-BASKET-PURGE should process messages that are"
"RTN","XMAI1",80,0)
 W !,"in ** ALL ** users mail baskets.  This is not the normal way for"
"RTN","XMAI1",81,0)
 W !,"this process to be run.  It is recommended that you discuss this"
"RTN","XMAI1",82,0)
 W !,"with site management and get user input before doing this.",!!
"RTN","XMAI1",83,0)
 Q
"VER")
8.0^21.0
**END**
**END**
