Released PRCA*4.5*201 SEQ #189
Extracted from mail message
**KIDS**:PRCA*4.5*201^

**INSTALL NAME**
PRCA*4.5*201
"BLD",4706,0)
PRCA*4.5*201^ACCOUNTS RECEIVABLE^0^3040728^y
"BLD",4706,1,0)
^^2^2^3031119^
"BLD",4706,1,1,0)
This patch will implement CBO data extraction logic for
"BLD",4706,1,2,0)
the Boston Allocation Resource Center.
"BLD",4706,4,0)
^9.64PA^342^5
"BLD",4706,4,342,0)
342
"BLD",4706,4,342,2,0)
^9.641^342^1
"BLD",4706,4,342,2,342,0)
AR SITE PARAMETER  (File-top level)
"BLD",4706,4,342,2,342,1,0)
^9.6411^20.09^9
"BLD",4706,4,342,2,342,1,20.01,0)
VITRIA STANDARD DIRECTORY
"BLD",4706,4,342,2,342,1,20.02,0)
MAIL GROUP
"BLD",4706,4,342,2,342,1,20.03,0)
DATE OF LAST TRANSMISSION
"BLD",4706,4,342,2,342,1,20.04,0)
CBO STATUS
"BLD",4706,4,342,2,342,1,20.05,0)
MAXIMUM NUMBER RECORDS
"BLD",4706,4,342,2,342,1,20.06,0)
SYSTEM TYPE
"BLD",4706,4,342,2,342,1,20.07,0)
LEGACY SITE?
"BLD",4706,4,342,2,342,1,20.08,0)
PRIMARY DOMAIN
"BLD",4706,4,342,2,342,1,20.09,0)
EXTRACT RUNNING?
"BLD",4706,4,342,222)
y^y^p^^^^n^^n
"BLD",4706,4,342,224)

"BLD",4706,4,348.4,0)
348.4
"BLD",4706,4,348.4,222)
y^y^f^^^^n
"BLD",4706,4,430,0)
430
"BLD",4706,4,430,2,0)
^9.641^430^1
"BLD",4706,4,430,2,430,0)
ACCOUNTS RECEIVABLE  (File-top level)
"BLD",4706,4,430,2,430,1,0)
^9.6411^68.3^7
"BLD",4706,4,430,2,430,1,10,0)
DATE BILL PREPARED
"BLD",4706,4,430,2,430,1,14,0)
DATE STATUS UPDATED
"BLD",4706,4,430,2,430,1,60,0)
DATE ACCOUNT ACTIVATED
"BLD",4706,4,430,2,430,1,64,0)
REFERRAL DATE
"BLD",4706,4,430,2,430,1,68.2,0)
RE-REFERRAL DATE
"BLD",4706,4,430,2,430,1,68.3,0)
RETURNED DATE BY RC/DOJ
"BLD",4706,4,430,2,430,1,68.4,0)
REFERRAL DATE TO COWC
"BLD",4706,4,430,222)
y^n^p^^^^n^^n
"BLD",4706,4,430,224)

"BLD",4706,4,430.3,0)
430.3
"BLD",4706,4,430.3,2,0)
^9.641^430.3^1
"BLD",4706,4,430.3,2,430.3,0)
ACCOUNTS RECEIVABLE TRANS.TYPE  (File-top level)
"BLD",4706,4,430.3,2,430.3,1,0)
^9.6411^5^1
"BLD",4706,4,430.3,2,430.3,1,5,0)
CBOC EXTRACT FLAG
"BLD",4706,4,430.3,222)
y^n^p^^^^n^^n
"BLD",4706,4,430.3,224)

"BLD",4706,4,433,0)
433
"BLD",4706,4,433,2,0)
^9.641^433^1
"BLD",4706,4,433,2,433,0)
AR TRANSACTION  (File-top level)
"BLD",4706,4,433,2,433,1,0)
^9.6411^19^3
"BLD",4706,4,433,2,433,1,11,0)
TRANSACTION DATE
"BLD",4706,4,433,2,433,1,17,0)
TERMINATION REASON
"BLD",4706,4,433,2,433,1,19,0)
DATE ENTERED
"BLD",4706,4,433,222)
y^n^p^^^^n^^n
"BLD",4706,4,433,224)

"BLD",4706,4,"APDD",342,342)

"BLD",4706,4,"APDD",342,342,20.01)

"BLD",4706,4,"APDD",342,342,20.02)

"BLD",4706,4,"APDD",342,342,20.03)

"BLD",4706,4,"APDD",342,342,20.04)

"BLD",4706,4,"APDD",342,342,20.05)

"BLD",4706,4,"APDD",342,342,20.06)

"BLD",4706,4,"APDD",342,342,20.07)

"BLD",4706,4,"APDD",342,342,20.08)

"BLD",4706,4,"APDD",342,342,20.09)

"BLD",4706,4,"APDD",430,430)

"BLD",4706,4,"APDD",430,430,10)

"BLD",4706,4,"APDD",430,430,14)

"BLD",4706,4,"APDD",430,430,60)

"BLD",4706,4,"APDD",430,430,64)

"BLD",4706,4,"APDD",430,430,68.2)

"BLD",4706,4,"APDD",430,430,68.3)

"BLD",4706,4,"APDD",430,430,68.4)

"BLD",4706,4,"APDD",430.3,430.3)

"BLD",4706,4,"APDD",430.3,430.3,5)

"BLD",4706,4,"APDD",433,433)

"BLD",4706,4,"APDD",433,433,11)

"BLD",4706,4,"APDD",433,433,17)

"BLD",4706,4,"APDD",433,433,19)

"BLD",4706,4,"B",342,342)

"BLD",4706,4,"B",348.4,348.4)

"BLD",4706,4,"B",430,430)

"BLD",4706,4,"B",430.3,430.3)

"BLD",4706,4,"B",433,433)

"BLD",4706,"ABPKG")
n
"BLD",4706,"INI")
RCXVS201
"BLD",4706,"INIT")
RCXVP201
"BLD",4706,"KRN",0)
^9.67PA^8989.52^19
"BLD",4706,"KRN",.4,0)
.4
"BLD",4706,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",4706,"KRN",.4,"NM",1,0)
RCXV ACTIVE PRINT    FILE #430^430^0
"BLD",4706,"KRN",.4,"NM","B","RCXV ACTIVE PRINT    FILE #430",1)

"BLD",4706,"KRN",.401,0)
.401
"BLD",4706,"KRN",.401,"NM",0)
^9.68A^1^1
"BLD",4706,"KRN",.401,"NM",1,0)
RCXV ACTIVE SORT    FILE #430^430^0
"BLD",4706,"KRN",.401,"NM","B","RCXV ACTIVE SORT    FILE #430",1)

"BLD",4706,"KRN",.402,0)
.402
"BLD",4706,"KRN",.403,0)
.403
"BLD",4706,"KRN",.5,0)
.5
"BLD",4706,"KRN",.84,0)
.84
"BLD",4706,"KRN",3.6,0)
3.6
"BLD",4706,"KRN",3.8,0)
3.8
"BLD",4706,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",4706,"KRN",3.8,"NM",1,0)
RCXVFTP^^0
"BLD",4706,"KRN",3.8,"NM","B","RCXVFTP",1)

"BLD",4706,"KRN",9.2,0)
9.2
"BLD",4706,"KRN",9.8,0)
9.8
"BLD",4706,"KRN",9.8,"NM",0)
^9.68A^22^22
"BLD",4706,"KRN",9.8,"NM",1,0)
RCXVDEQ^^0^B14701950
"BLD",4706,"KRN",9.8,"NM",2,0)
RCXVTSK^^0^B35416913
"BLD",4706,"KRN",9.8,"NM",3,0)
RCXVP201^^0^B42512490
"BLD",4706,"KRN",9.8,"NM",4,0)
PRCABJ^^0^B31015272
"BLD",4706,"KRN",9.8,"NM",5,0)
RCXVDC^^0^B4216729
"BLD",4706,"KRN",9.8,"NM",6,0)
RCXVDC1^^0^B12509835
"BLD",4706,"KRN",9.8,"NM",7,0)
RCXVDC2^^0^B3091235
"BLD",4706,"KRN",9.8,"NM",8,0)
RCXVDC3^^0^B16047333
"BLD",4706,"KRN",9.8,"NM",9,0)
RCXVDC4^^0^B5716238
"BLD",4706,"KRN",9.8,"NM",10,0)
RCXVDC5^^0^B2946234
"BLD",4706,"KRN",9.8,"NM",11,0)
RCXVDC6^^0^B4436888
"BLD",4706,"KRN",9.8,"NM",12,0)
RCXVDC7^^1^
"BLD",4706,"KRN",9.8,"NM",13,0)
RCXVDC8^^0^B2040377
"BLD",4706,"KRN",9.8,"NM",14,0)
RCXVFTP^^0^B4723718
"BLD",4706,"KRN",9.8,"NM",15,0)
RCXVFTV^^0^B7735519
"BLD",4706,"KRN",9.8,"NM",16,0)
RCXVPARM^^0^B6256393
"BLD",4706,"KRN",9.8,"NM",17,0)
RCXVSRV^^0^B10097008
"BLD",4706,"KRN",9.8,"NM",18,0)
RCXVRMV^^0^B1122235
"BLD",4706,"KRN",9.8,"NM",19,0)
RCXVUTIL^^0^B17859013
"BLD",4706,"KRN",9.8,"NM",20,0)
RCXVACK^^0^B7259901
"BLD",4706,"KRN",9.8,"NM",21,0)
RCXVFTR^^0^B4139175
"BLD",4706,"KRN",9.8,"NM",22,0)
RCXVFTC^^0^B3062600
"BLD",4706,"KRN",9.8,"NM","B","PRCABJ",4)

"BLD",4706,"KRN",9.8,"NM","B","RCXVACK",20)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC",5)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC1",6)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC2",7)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC3",8)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC4",9)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC5",10)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC6",11)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC7",12)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDC8",13)

"BLD",4706,"KRN",9.8,"NM","B","RCXVDEQ",1)

"BLD",4706,"KRN",9.8,"NM","B","RCXVFTC",22)

"BLD",4706,"KRN",9.8,"NM","B","RCXVFTP",14)

"BLD",4706,"KRN",9.8,"NM","B","RCXVFTR",21)

"BLD",4706,"KRN",9.8,"NM","B","RCXVFTV",15)

"BLD",4706,"KRN",9.8,"NM","B","RCXVP201",3)

"BLD",4706,"KRN",9.8,"NM","B","RCXVPARM",16)

"BLD",4706,"KRN",9.8,"NM","B","RCXVRMV",18)

"BLD",4706,"KRN",9.8,"NM","B","RCXVSRV",17)

"BLD",4706,"KRN",9.8,"NM","B","RCXVTSK",2)

"BLD",4706,"KRN",9.8,"NM","B","RCXVUTIL",19)

"BLD",4706,"KRN",19,0)
19
"BLD",4706,"KRN",19,"NM",0)
^9.68A^4^3
"BLD",4706,"KRN",19,"NM",1,0)
PRCA CBO PARAMETERS^^0
"BLD",4706,"KRN",19,"NM",3,0)
RCXVSRV^^0
"BLD",4706,"KRN",19,"NM",4,0)
PRCA SITE PARAMETER^^2
"BLD",4706,"KRN",19,"NM","B","PRCA CBO PARAMETERS",1)

"BLD",4706,"KRN",19,"NM","B","PRCA SITE PARAMETER",4)

"BLD",4706,"KRN",19,"NM","B","RCXVSRV",3)

"BLD",4706,"KRN",19.1,0)
19.1
"BLD",4706,"KRN",101,0)
101
"BLD",4706,"KRN",101,"NM",0)
^9.68A^^0
"BLD",4706,"KRN",409.61,0)
409.61
"BLD",4706,"KRN",771,0)
771
"BLD",4706,"KRN",771,"NM",0)
^9.68A^^0
"BLD",4706,"KRN",870,0)
870
"BLD",4706,"KRN",870,"NM",0)
^9.68A^^0
"BLD",4706,"KRN",8989.51,0)
8989.51
"BLD",4706,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",4706,"KRN",8989.52,0)
8989.52
"BLD",4706,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",4706,"KRN",8994,0)
8994
"BLD",4706,"KRN","B",.4,.4)

"BLD",4706,"KRN","B",.401,.401)

"BLD",4706,"KRN","B",.402,.402)

"BLD",4706,"KRN","B",.403,.403)

"BLD",4706,"KRN","B",.5,.5)

"BLD",4706,"KRN","B",.84,.84)

"BLD",4706,"KRN","B",3.6,3.6)

"BLD",4706,"KRN","B",3.8,3.8)

"BLD",4706,"KRN","B",9.2,9.2)

"BLD",4706,"KRN","B",9.8,9.8)

"BLD",4706,"KRN","B",19,19)

"BLD",4706,"KRN","B",19.1,19.1)

"BLD",4706,"KRN","B",101,101)

"BLD",4706,"KRN","B",409.61,409.61)

"BLD",4706,"KRN","B",771,771)

"BLD",4706,"KRN","B",870,870)

"BLD",4706,"KRN","B",8989.51,8989.51)

"BLD",4706,"KRN","B",8989.52,8989.52)

"BLD",4706,"KRN","B",8994,8994)

"BLD",4706,"QUES",0)
^9.62^2^2
"BLD",4706,"QUES",1,0)
PRE DIREC
"BLD",4706,"QUES",1,1)
F
"BLD",4706,"QUES",1,"A")
CBO AR DATA DIRECTORY
"BLD",4706,"QUES",1,"Q")
Enter the directory name where files will be placed prior to FTP
"BLD",4706,"QUES",1,"Q1",0)
^^2^2^3031023^
"BLD",4706,"QUES",1,"Q1",1,0)
A valid directory or path name must exist in order for a file to
"BLD",4706,"QUES",1,"Q1",2,0)
be created and FTP'd to the Boston Allocation Resource Center.
"BLD",4706,"QUES",2,0)
POS MAIL
"BLD",4706,"QUES",2,1)
F
"BLD",4706,"QUES",2,"A")
Select MailGroup for FTP Error Messages: 
"BLD",4706,"QUES",2,"B")
RCXVFTP
"BLD",4706,"QUES",2,"Q")
Messages with any automatic FTP problems will be sent to this mailgroup.
"BLD",4706,"QUES","B","POS MAIL",2)

"BLD",4706,"QUES","B","PRE DIREC",1)

"BLD",4706,"REQB",0)
^9.611^^
"FIA",342)
AR SITE PARAMETER
"FIA",342,0)
^RC(342,
"FIA",342,0,0)
342P
"FIA",342,0,1)
y^y^p^^^^n^^n
"FIA",342,0,10)

"FIA",342,0,11)

"FIA",342,0,"RLRO")

"FIA",342,0,"VR")
4.5^PRCA
"FIA",342,342)
1
"FIA",342,342,20.01)

"FIA",342,342,20.02)

"FIA",342,342,20.03)

"FIA",342,342,20.04)

"FIA",342,342,20.05)

"FIA",342,342,20.06)

"FIA",342,342,20.07)

"FIA",342,342,20.08)

"FIA",342,342,20.09)

"FIA",348.4)
AR DATA QUEUE
"FIA",348.4,0)
^RCXV(
"FIA",348.4,0,0)
348.4
"FIA",348.4,0,1)
y^y^f^^^^n
"FIA",348.4,0,10)

"FIA",348.4,0,11)

"FIA",348.4,0,"RLRO")

"FIA",348.4,0,"VR")
4.5^PRCA
"FIA",348.4,348.4)
0
"FIA",348.4,348.41)
0
"FIA",348.4,348.42)
0
"FIA",430)
ACCOUNTS RECEIVABLE
"FIA",430,0)
^PRCA(430,
"FIA",430,0,0)
430I
"FIA",430,0,1)
y^n^p^^^^n^^n
"FIA",430,0,10)

"FIA",430,0,11)

"FIA",430,0,"RLRO")

"FIA",430,0,"VR")
4.5^PRCA
"FIA",430,430)
1
"FIA",430,430,10)

"FIA",430,430,14)

"FIA",430,430,60)

"FIA",430,430,64)

"FIA",430,430,68.2)

"FIA",430,430,68.3)

"FIA",430,430,68.4)

"FIA",430.3)
ACCOUNTS RECEIVABLE TRANS.TYPE
"FIA",430.3,0)
^PRCA(430.3,
"FIA",430.3,0,0)
430.3
"FIA",430.3,0,1)
y^n^p^^^^n^^n
"FIA",430.3,0,10)

"FIA",430.3,0,11)

"FIA",430.3,0,"RLRO")

"FIA",430.3,0,"VR")
4.5^PRCA
"FIA",430.3,430.3)
1
"FIA",430.3,430.3,5)

"FIA",433)
AR TRANSACTION
"FIA",433,0)
^PRCA(433,
"FIA",433,0,0)
433NI
"FIA",433,0,1)
y^n^p^^^^n^^n
"FIA",433,0,10)

"FIA",433,0,11)

"FIA",433,0,"RLRO")

"FIA",433,0,"VR")
4.5^PRCA
"FIA",433,433)
1
"FIA",433,433,11)

"FIA",433,433,17)

"FIA",433,433,19)

"INI")
RCXVS201
"INIT")
RCXVP201
"KRN",.4,4700,-1)
0^1
"KRN",.4,4700,0)
RCXV ACTIVE PRINT^3040218.1137^@^430^^@^3040220
"KRN",.4,4700,"DCL","430^.01")
!
"KRN",.4,4700,"DCL","430^11")
&
"KRN",.4,4700,"DNP")
1
"KRN",.4,4700,"F",2)
.01~11~
"KRN",.4,4700,"H")
ACCOUNTS RECEIVABLE STATISTICS
"KRN",.401,4786,-1)
0^1
"KRN",.401,4786,0)
RCXV ACTIVE SORT^3040218.1156^@^430^^@^3040220
"KRN",.401,4786,2,0)
^.4014^2^2
"KRN",.401,4786,2,1,0)
430^^(CURRENT STATUS="ACTIVE")!(CURRENT STATUS="SUSPENDED")^"@B^;L1^^^^^4
"KRN",.401,4786,2,1,3,0)
^.401419^1^1
"KRN",.401,4786,2,1,3,1,0)
OVF0^9.2
"KRN",.401,4786,2,1,3,1,"OVF0")
S Y(1)=$S($D(^PRCA(430,D0,0)):^(0),1:"") S X=$P($G(^PRCA(430.3,+$P(Y(1),U,8),0)),U)="ACTIVE",Y(2)=$G(X) S X=$P($G(^PRCA(430.3,+$P(Y(1),U,8),0)),U)="SUSPENDED"
"KRN",.401,4786,2,1,3,"B","OVF0",1)

"KRN",.401,4786,2,1,"CM")
X DPP(1,"OVF0",9.2) S Y=X,X=Y(2),X=X!Y I D0>0 S DISX(1)=X
"KRN",.401,4786,2,1,"F")
0
"KRN",.401,4786,2,1,"GET")
X DPP(1,"OVF0",9.2) S Y=X,X=Y(2),X=X!Y I D0>0 S DISX(1)=X
"KRN",.401,4786,2,1,"QCON")
I DISX(1)
"KRN",.401,4786,2,1,"T")
1
"KRN",.401,4786,2,1,"TXT")
(CURRENT STATUS=""ACTIVE"")!(CURRENT STATUS=""SUSPENDED"")
"KRN",.401,4786,2,2,0)
430^^CATEGORY^+"2^^^^^^4
"KRN",.401,4786,2,2,"CM")
S Y(1)=$S($D(^PRCA(430,D0,0)):^(0),1:"") S X=$P($G(^PRCA(430.2,+$P(Y(1),U,2),0)),U) I D0>0 S DISX(2)=X
"KRN",.401,4786,2,2,"GET")
S Y(1)=$S($D(^PRCA(430,D0,0)):^(0),1:"") S X=$P($G(^PRCA(430.2,+$P(Y(1),U,2),0)),U) I D0>0 S DISX(2)=X
"KRN",.401,4786,2,2,"QCON")
I DISX(2)'=""
"KRN",.401,4786,2,2,"TXT")
CATEGORY not null
"KRN",.401,4786,2,"B",430,1)

"KRN",.401,4786,2,"B",430,2)

"KRN",.401,4786,"%D",0)
^^1^1^3040218^
"KRN",.401,4786,"%D",1,0)
Active Sort Template for the CBO AR Data Extract project.
"KRN",3.8,4655,-1)
0^1
"KRN",3.8,4655,0)
RCXVFTP^PU^n^^^^
"KRN",3.8,4655,2,0)
^3.801^2^2^3040224^^^^
"KRN",3.8,4655,2,1,0)
This mail group will receive all FTP error messages for the CBO
"KRN",3.8,4655,2,2,0)
AR Data Extracts.
"KRN",3.8,4655,3)

"KRN",19,8809,-1)
2^4
"KRN",19,8809,0)
PRCA SITE PARAMETER^Site Parameter Edit^^M^.5^^^^^^^299
"KRN",19,8809,10,0)
^19.01IP^9^9
"KRN",19,8809,10,8,0)
15325^^99
"KRN",19,8809,10,8,"^")
PRCA CBO PARAMETERS
"KRN",19,8809,"U")
SITE PARAMETER EDIT
"KRN",19,15325,-1)
0^1
"KRN",19,15325,0)
PRCA CBO PARAMETERS^CBO Data Extract Parameters Edit^^R^^^^^^^^ACCOUNTS RECEIVABLE
"KRN",19,15325,1,0)
^19.06^2^2^3030910^^^
"KRN",19,15325,1,1,0)
This option allows the AR supervisor to define certain parameters
"KRN",19,15325,1,2,0)
for the CBO Data Extract.
"KRN",19,15325,25)
EN^RCXVPARM
"KRN",19,15325,"U")
CBO DATA EXTRACT PARAMETERS ED
"KRN",19,15340,-1)
0^3
"KRN",19,15340,0)
RCXVSRV^AR Data Extract Server^^S^^^^^^^^ACCOUNTS RECEIVABLE
"KRN",19,15340,1,0)
^19.06^2^2^3031119^^
"KRN",19,15340,1,1,0)
This program will take an incoming message, parse it and process
"KRN",19,15340,1,2,0)
it as necessary.
"KRN",19,15340,25)
RCXVSRV
"KRN",19,15340,220)
^R^^^Y^N^0^^3
"KRN",19,15340,"U")
AR DATA EXTRACT SERVER
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",6,.401)
.401;6;;;EDEOUT^DIFROMSO(.401,DA,"",XPDA);FPRE^DIFROMSI(.401,"",XPDA);EPRE^DIFROMSI(.401,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.401,DA,"",XPDA);DEL^DIFROMSK(.401,"",%)
"ORD",6,.401,0)
SORT TEMPLATE
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",299,-1)
1^1
"PKG",299,0)
ACCOUNTS RECEIVABLE^PRCA^FMS
"PKG",299,20,0)
^9.402P^1^1
"PKG",299,20,1,0)
2^^PRCAMRG
"PKG",299,20,1,1)

"PKG",299,20,"B",2,1)

"PKG",299,22,0)
^9.49I^1^1
"PKG",299,22,1,0)
4.5^2950913^2951006
"PKG",299,22,1,"PAH",1,0)
201^3040728
"PKG",299,22,1,"PAH",1,1,0)
^^2^2^3040728
"PKG",299,22,1,"PAH",1,1,1,0)
This patch will implement CBO data extraction logic for
"PKG",299,22,1,"PAH",1,1,2,0)
the Boston Allocation Resource Center.
"QUES","POS MAIL",0)
F
"QUES","POS MAIL","?")
Messages with any automatic FTP problems will be sent to this mailgroup.
"QUES","POS MAIL","A")
Select MailGroup for FTP Error Messages: 
"QUES","POS MAIL","B")
RCXVFTP
"QUES","PRE DIREC",0)
F
"QUES","PRE DIREC","?")
Enter the directory name where files will be placed prior to FTP
"QUES","PRE DIREC","?",1)
A valid directory or path name must exist in order for a file to
"QUES","PRE DIREC","?",2)
be created and FTP'd to the Boston Allocation Resource Center.
"QUES","PRE DIREC","A")
CBO AR DATA DIRECTORY
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
23
"RTN","PRCABJ")
0^4^B31015272
"RTN","PRCABJ",1,0)
PRCABJ ;WASH-ISC@ALTOONA,PA/LDB,TJK-NIGHTLY PROCESS FOR ACCOUNTS RECEIVABLE ;11/8/96  3:54 PM
"RTN","PRCABJ",2,0)
 ;;4.5;Accounts Receivable;**11,34,101,114,155,153,141,165,167,173,201**;Mar 20, 1995
"RTN","PRCABJ",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCABJ",4,0)
 ;
"RTN","PRCABJ",5,0)
 ;This routine is called by the PRCA NIGHTLY PROCESS option which should be run nightly to call the following tasks
"RTN","PRCABJ",6,0)
 ;1) Update of interest/admin charges on patients' accounts
"RTN","PRCABJ",7,0)
 ;2) Update statement days
"RTN","PRCABJ",8,0)
 ;3) Print of Patient Statements, Uniform Billing forms, and non-patient follow-up letters
"RTN","PRCABJ",9,0)
 ;4) Purge of Receipts
"RTN","PRCABJ",10,0)
 ;5) Creation of TOP (Treasury Offset Program) documents
"RTN","PRCABJ",11,0)
 ;6) Print of the Follow-up list
"RTN","PRCABJ",12,0)
 ;7) Purge AR Events
"RTN","PRCABJ",13,0)
 ;8) Flag prepayments for refund review
"RTN","PRCABJ",14,0)
 ;9) Print Comment List
"RTN","PRCABJ",15,0)
 ;10) Starts the Repayment Plan Monitor
"RTN","PRCABJ",16,0)
 ;11) Generates Diagnostic Measures Workload Reports
"RTN","PRCABJ",17,0)
 ;12) Matches EFT with ERA
"RTN","PRCABJ",18,0)
 ;13) Generates CBO Data Extract files for Boston ARC
"RTN","PRCABJ",19,0)
 ;
"RTN","PRCABJ",20,0)
 ;Process will first check and Validate AR pointer files 341.1,
"RTN","PRCABJ",21,0)
 ;430.2, and 430.3.
"RTN","PRCABJ",22,0)
 ;Process will terminate and send bulletin if files are not valid
"RTN","PRCABJ",23,0)
 ;
"RTN","PRCABJ",24,0)
EN ;Start of nightly process-check to see if process is already running
"RTN","PRCABJ",25,0)
 L +^RC("PRCABJ"):5 Q:'$T
"RTN","PRCABJ",26,0)
 NEW ERROR S ERROR=0
"RTN","PRCABJ",27,0)
 D VERIFY I ERROR L -^RC("PRCABJ") Q
"RTN","PRCABJ",28,0)
 ;
"RTN","PRCABJ",29,0)
DRIVER ;All processes are called from this point
"RTN","PRCABJ",30,0)
 N CHK,POP,% S CHK=0
"RTN","PRCABJ",31,0)
 D CHK,INT,CHK,EN^RCCPCBJ,CHK,STM,CHK,RECPT,CHK,TOP,CHK,EVNT,CHK,BNUM
"RTN","PRCABJ",32,0)
 D CHK,ENUM,CHK,PURFMS,CHK,EN3^RCFMOBR,CHK,START^RCRJR,CHK,UB
"RTN","PRCABJ",33,0)
 D CHK,STATMNT,CHK,UDLIST^PRCABJ1,CHK,LIST,CHK,COMMENT,CHK,REPAY
"RTN","PRCABJ",34,0)
 D CHK,WRKLD,CHK,EFT,CHK,CBO
"RTN","PRCABJ",35,0)
 D NOW^%DTC S $P(^RC(342,1,0),"^",10)=%
"RTN","PRCABJ",36,0)
 L -^RC("PRCABJ")
"RTN","PRCABJ",37,0)
 K ^RC("PRCABJ")
"RTN","PRCABJ",38,0)
 Q
"RTN","PRCABJ",39,0)
 ;
"RTN","PRCABJ",40,0)
CHK ;checkpoint of process
"RTN","PRCABJ",41,0)
 S CHK=CHK+1 S ^RC("PRCABJ")=CHK
"RTN","PRCABJ",42,0)
 Q
"RTN","PRCABJ",43,0)
 ;
"RTN","PRCABJ",44,0)
VERIFY ;Verifies Pointer Files--Will HALT Process if Pointer Files Invalid
"RTN","PRCABJ",45,0)
 NEW A,B,FILE
"RTN","PRCABJ",46,0)
 F FILE=341.1,430.2,430.3 D  Q:ERROR
"RTN","PRCABJ",47,0)
    .S A=$S(FILE=341.1:"AC;0;2",FILE=430.2:"AC;0;7",1:"AC;0;3")
"RTN","PRCABJ",48,0)
    .S B=$S(FILE=341.1:"",1:"C;0;2")
"RTN","PRCABJ",49,0)
    .D EN1^PRCABJV(FILE,A,B,.ERROR)
"RTN","PRCABJ",50,0)
    .Q:'ERROR
"RTN","PRCABJ",51,0)
    .;SEND BULLETIN HERE IF FILE IN ERROR
"RTN","PRCABJ",52,0)
    .NEW XMB,XMTEXT,XMDUZ
"RTN","PRCABJ",53,0)
    .S XMDUZ="ACCOUNTS RECEIVABLE PACKAGE"
"RTN","PRCABJ",54,0)
    .S XMB="PRCA NIGHTLY PROCESS ABORT"
"RTN","PRCABJ",55,0)
    .S XMTEXT="ERROR("
"RTN","PRCABJ",56,0)
    .D ^XMB
"RTN","PRCABJ",57,0)
    .Q
"RTN","PRCABJ",58,0)
 Q
"RTN","PRCABJ",59,0)
 ;
"RTN","PRCABJ",60,0)
INT ;  update interest and admin charges for non-benefit debts
"RTN","PRCABJ",61,0)
 ;  example: vendor, employee, ex-employee
"RTN","PRCABJ",62,0)
 D NONBENE^RCBECHGS
"RTN","PRCABJ",63,0)
 Q
"RTN","PRCABJ",64,0)
 ;
"RTN","PRCABJ",65,0)
STM ;Update statement days for PERSONS, VENDORS, and Institutions
"RTN","PRCABJ",66,0)
 D STM^PRCABJ1
"RTN","PRCABJ",67,0)
 Q
"RTN","PRCABJ",68,0)
 ;
"RTN","PRCABJ",69,0)
STATMNT ;Print patient statements
"RTN","PRCABJ",70,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH,PRCADEV
"RTN","PRCABJ",71,0)
 S (IOP,PRCADEV)=$P($G(^RC(342,1,0)),"^",8)
"RTN","PRCABJ",72,0)
 I IOP]"" D
"RTN","PRCABJ",73,0)
 .S ZTRTN="PRCAGS",ZTDTH=$H,ZTDESC="Print AR Statements/Letters"
"RTN","PRCABJ",74,0)
 .S %ZIS="N0" D ^%ZIS Q:POP
"RTN","PRCABJ",75,0)
 .S ZTSAVE("PRCADEV")="" D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",76,0)
 Q
"RTN","PRCABJ",77,0)
 ;
"RTN","PRCABJ",78,0)
RECPT ;Manage Receipts and Deposits
"RTN","PRCABJ",79,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH
"RTN","PRCABJ",80,0)
 S ZTIO="",ZTRTN="MAN^RCDPUT",ZTDTH=$H,ZTDESC="Manage Receipts and Deposits"
"RTN","PRCABJ",81,0)
 D ^%ZTLOAD
"RTN","PRCABJ",82,0)
 Q
"RTN","PRCABJ",83,0)
 ;
"RTN","PRCABJ",84,0)
TOP ;Transmit TOP documents
"RTN","PRCABJ",85,0)
 Q:$$DOW^XLFDT(DT,1)'=1
"RTN","PRCABJ",86,0)
 N RCM,RCDOC
"RTN","PRCABJ",87,0)
 ;Run of TOP documents every Monday
"RTN","PRCABJ",88,0)
 I +$E(DT,6,7)>7,$E(DT,6,7)<15 S RCM=1
"RTN","PRCABJ",89,0)
 I '$D(^RCD(340,"TOP")),'$G(RCM) Q
"RTN","PRCABJ",90,0)
 S RCDOC=$S($G(RCM):"M",1:"U")
"RTN","PRCABJ",91,0)
 I $E(DT,4,5)=12,RCDOC="M" S RCDOC="Y"
"RTN","PRCABJ",92,0)
TOPQUE N ZTDESC,ZTASK,ZTDTH,ZTIO,ZTRTN,ARDUZ,ZTSAVE
"RTN","PRCABJ",93,0)
 S ZTIO="",ZTRTN="^RCTOPD",ZTSAVE("RCDOC")=""
"RTN","PRCABJ",94,0)
 S ZTDESC="TOP REFERRAL DOCUMENTS",ZTDTH=$H
"RTN","PRCABJ",95,0)
 D ^%ZTLOAD
"RTN","PRCABJ",96,0)
 Q
"RTN","PRCABJ",97,0)
 ;
"RTN","PRCABJ",98,0)
UB ;Print Uniform Billing forms
"RTN","PRCABJ",99,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH
"RTN","PRCABJ",100,0)
 S ZTIO="",ZTRTN="PRCALT2",ZTDTH=$H,ZTDESC="Print Reimbursable Health Insurance Uniform Billing forms"
"RTN","PRCABJ",101,0)
 D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",102,0)
 Q
"RTN","PRCABJ",103,0)
 ;
"RTN","PRCABJ",104,0)
LIST ;Print Follow-up List
"RTN","PRCABJ",105,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH,BEG,END,PRCADEV
"RTN","PRCABJ",106,0)
 S IOP=$P($G(^RC(342,1,0)),"^",8)
"RTN","PRCABJ",107,0)
 I IOP]"" D
"RTN","PRCABJ",108,0)
 .S %ZIS="N0" D ^%ZIS Q:POP
"RTN","PRCABJ",109,0)
 .S ZTRTN="DQ1^PRCACM",ZTDTH=$H,PRCADEV=ION_";"_IOST_";"_IOM_";"_IOSL_";"_$G(IO("DOC"))
"RTN","PRCABJ",110,0)
 .S (ZTSAVE("BEG"),ZTSAVE("END"))=DT,ZTSAVE("PRCADEV")="",ZTDESC="Bill Comment Follow-Up List"
"RTN","PRCABJ",111,0)
 .D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",112,0)
 Q
"RTN","PRCABJ",113,0)
 ;
"RTN","PRCABJ",114,0)
COMMENT ;Print Comment List
"RTN","PRCABJ",115,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH,BEG,END,PRCADEV
"RTN","PRCABJ",116,0)
 S IOP=$P($G(^RC(342,1,0)),"^",8)
"RTN","PRCABJ",117,0)
 I IOP]"" D
"RTN","PRCABJ",118,0)
 .S %ZIS="N0" D ^%ZIS Q:POP
"RTN","PRCABJ",119,0)
 .S ZTRTN="DQ2^PRCACM",ZTDTH=$H,PRCADEV=ION_";"_IOST_";"_IOM_";"_IOSL_";"_$G(IO("DOC"))
"RTN","PRCABJ",120,0)
 .S (ZTSAVE("BEG"),ZTSAVE("END"))=DT,ZTSAVE("PRCADEV")="",ZTDESC="Debtor Comment Follow-up List"
"RTN","PRCABJ",121,0)
 .D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",122,0)
 Q
"RTN","PRCABJ",123,0)
 ;
"RTN","PRCABJ",124,0)
REPAY ; Starts the Repayment Plan Monitor
"RTN","PRCABJ",125,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","PRCABJ",126,0)
 S ZTIO="",ZTRTN="EN^RCDMB1MT",ZTDTH=$H,ZTDESC="Repayment Plan Monitor"
"RTN","PRCABJ",127,0)
 D ^%ZTLOAD
"RTN","PRCABJ",128,0)
 Q
"RTN","PRCABJ",129,0)
 ;
"RTN","PRCABJ",130,0)
WRKLD ; Generates Diagnostic Measures Workload Reports
"RTN","PRCABJ",131,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","PRCABJ",132,0)
 S ZTIO="",ZTRTN="DQ^RCDMBWLR",ZTDTH=$H,ZTDESC="Diagnostic Measures Workload Reports"
"RTN","PRCABJ",133,0)
 D ^%ZTLOAD
"RTN","PRCABJ",134,0)
 Q
"RTN","PRCABJ",135,0)
 ;
"RTN","PRCABJ",136,0)
EVNT ;Purge AR Events
"RTN","PRCABJ",137,0)
 N IOP,ZTIO,ZTDESC,ZTASK,ZTIO,ZTRTN,ZTSAVE,%ZIS
"RTN","PRCABJ",138,0)
 S ZTIO="",ZTRTN="PUR^RCEVDRV1",ZTDTH=$H,ZTDESC="Purge AR Event Information" D ^%ZTLOAD
"RTN","PRCABJ",139,0)
 Q
"RTN","PRCABJ",140,0)
PURFMS ;Purge FMS documents
"RTN","PRCABJ",141,0)
 NEW ZTRTN,ZTIO,ZTDTH,ZTSK,ZTDESC
"RTN","PRCABJ",142,0)
 S ZTIO="",ZTRTN="EN^RCFMPUR",ZTDESC="AR/FMS DOC PURGE",ZTDTH=$H D ^%ZTLOAD
"RTN","PRCABJ",143,0)
 Q
"RTN","PRCABJ",144,0)
 ;
"RTN","PRCABJ",145,0)
EFT ; Starts matching of EFTs to EOBs job
"RTN","PRCABJ",146,0)
 NEW ZTRTN,ZTIO,ZTDTH,ZTSK,ZTDESC
"RTN","PRCABJ",147,0)
 S ZTIO="",ZTRTN="EN^RCDPEM",ZTDESC="AR/EDI LOCKBOX MATCHING EFTs",ZTDTH=$H D ^%ZTLOAD
"RTN","PRCABJ",148,0)
 Q
"RTN","PRCABJ",149,0)
 ;
"RTN","PRCABJ",150,0)
BNUM ;Check bill numbering series
"RTN","PRCABJ",151,0)
 I $P(^RC(342,1,0),"^",3)="" S $P(^RC(342,1,0),"^",3)="K"_$E($$FY^RCFN01,2)_"00000"
"RTN","PRCABJ",152,0)
 I $E($P(^RC(342,1,0),"^",3),2)'=$E($$FY^RCFN01,2) S $P(^RC(342,1,0),"^",3)="K"_$E($$FY^RCFN01,2)_"00000"
"RTN","PRCABJ",153,0)
 Q
"RTN","PRCABJ",154,0)
ENUM ;Check event numbering series
"RTN","PRCABJ",155,0)
 I $P(^RC(342,1,0),"^",6)="" S $P(^RC(342,1,0),"^",6)="K"_$E($$FY^RCFN01,2)_"A0000"
"RTN","PRCABJ",156,0)
 I $E($P(^RC(342,1,0),"^",6),2)'=$E($$FY^RCFN01,2) S $P(^RC(342,1,0),"^",6)="K"_$E($$FY^RCFN01,2)_"A0000"
"RTN","PRCABJ",157,0)
 Q
"RTN","PRCABJ",158,0)
 ;
"RTN","PRCABJ",159,0)
CBO ; Create Extract Files for ARC
"RTN","PRCABJ",160,0)
 NEW ZTRTN,ZTIO,ZTDTH,ZTSK,ZTDESC
"RTN","PRCABJ",161,0)
 S ZTIO="",ZTRTN="EN^RCXVTSK",ZTDESC="CBO DATA EXTRACT",ZTDTH=$H
"RTN","PRCABJ",162,0)
 D ^%ZTLOAD
"RTN","PRCABJ",163,0)
 Q
"RTN","RCXVACK")
0^20^B7259901
"RTN","RCXVACK",1,0)
RCXVACK ;DAOU/ALA-AR Data Extraction HL7 Query/ACK ;28-JUL-03
"RTN","RCXVACK",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVACK",3,0)
 ;
"RTN","RCXVACK",4,0)
 ;** Program Description **
"RTN","RCXVACK",5,0)
 ;  This program will handle an acknowledgment message
"RTN","RCXVACK",6,0)
 ;  from either Vitria or Boston Allocation Resource
"RTN","RCXVACK",7,0)
 ;  Center
"RTN","RCXVACK",8,0)
 ;
"RTN","RCXVACK",9,0)
EN ;  Entry point
"RTN","RCXVACK",10,0)
 ;
"RTN","RCXVACK",11,0)
 ;  Load the HL7 message into temporary global
"RTN","RCXVACK",12,0)
 K ^TMP($J,"RCXVACK")
"RTN","RCXVACK",13,0)
 F SEGCNT=1:1 X HLNEXT Q:HLQUIT'>0  D
"RTN","RCXVACK",14,0)
 . S CNT=0
"RTN","RCXVACK",15,0)
 . S ^TMP($J,"RCXVACK",SEGCNT,CNT)=HLNODE
"RTN","RCXVACK",16,0)
 . F  S CNT=$O(HLNODE(CNT)) Q:'CNT  D
"RTN","RCXVACK",17,0)
 .. S ^TMP($J,"RCXVACK",SEGCNT,CNT)=HLNODE(CNT)
"RTN","RCXVACK",18,0)
 ;
"RTN","RCXVACK",19,0)
 S SEGMT=$G(^TMP($J,"RCXVACK",1,0))
"RTN","RCXVACK",20,0)
 I $E(SEGMT,1,3)'="MSH" S MSG(1)="MSH Segment is not the first segment found" D ERR G EXIT
"RTN","RCXVACK",21,0)
 S HLFS=$E(SEGMT,4)
"RTN","RCXVACK",22,0)
 S RCI=0,QRY=0,ACK=0
"RTN","RCXVACK",23,0)
 F  S RCI=$O(^TMP($J,"RCXVACK",RCI)) Q:'RCI  D  Q:ACK
"RTN","RCXVACK",24,0)
 . I $P(^TMP($J,"RCXVACK",RCI,0),HLFS,1)="MSA" S ACK=1 D ACK Q
"RTN","RCXVACK",25,0)
 . ;
"RTN","RCXVACK",26,0)
 . I $P(^TMP($J,"RCXVACK",RCI,0),HLFS,1)="QRD" D QRY
"RTN","RCXVACK",27,0)
 ;
"RTN","RCXVACK",28,0)
EXIT K RCI,ACK,QRY,NDAYS,FDATE,RCXSEG,RREFR,RN,RCXVDA,DTMRCD,RCXVBTN,HLFS
"RTN","RCXVACK",29,0)
 K RCVXDSC,RTASKS,ZTDESC,ZTRTN,ZTDTH,RREFR,RCXVFFD,RCXVFTD,CURDT,CDOW
"RTN","RCXVACK",30,0)
 K HL,HLNEXT,HLNODE,HLQUIT,MSG,RCXVUPD,SEGCNT,SEGMT
"RTN","RCXVACK",31,0)
 K ^TMP("RCXVA",$J),^TMP($J,"RCXVACK")
"RTN","RCXVACK",32,0)
 Q
"RTN","RCXVACK",33,0)
 ;
"RTN","RCXVACK",34,0)
ERR ;
"RTN","RCXVACK",35,0)
 Q
"RTN","RCXVACK",36,0)
 ;
"RTN","RCXVACK",37,0)
ACK ;  Set Acknowledgement
"RTN","RCXVACK",38,0)
 S RCI=$O(^TMP($J,"RCXVACK",RCI)) Q:'RCI
"RTN","RCXVACK",39,0)
 I $P(^TMP($J,"RCXVACK",RCI,0),HLFS,1)'="QRD" G ACK
"RTN","RCXVACK",40,0)
 S RREFR="^TMP($J,""RCXVACK"",RCI)"
"RTN","RCXVACK",41,0)
 D SPAR^RCXVUTIL(RREFR)
"RTN","RCXVACK",42,0)
 ;
"RTN","RCXVACK",43,0)
 S DTMRCD=$G(RCXSEG(2)),RCXVBTN=$G(RCXSEG(5))
"RTN","RCXVACK",44,0)
 ;
"RTN","RCXVACK",45,0)
 K ^TMP("RCXVA",$J)
"RTN","RCXVACK",46,0)
 D FIND^DIC(348.4,"","","P",RCXVBTN,"","B","","","^TMP(""RCXVA"",$J)")
"RTN","RCXVACK",47,0)
 S RN=$P($G(^TMP("RCXVA",$J,"DILIST",0)),U,1)
"RTN","RCXVACK",48,0)
 I RN=0 Q
"RTN","RCXVACK",49,0)
 S RCXVDA=$P($G(^TMP("RCXVA",$J,"DILIST",RN,0)),U,1)
"RTN","RCXVACK",50,0)
 S RCXVUPD(348.4,RCXVDA_",",.08)=$$FMDATE^HLFNC(DTMRCD)
"RTN","RCXVACK",51,0)
 S RCXVUPD(348.4,RCXVDA_",",.03)="C"
"RTN","RCXVACK",52,0)
 D FILE^DIE("I","RCXVUPD","RCXVERR")
"RTN","RCXVACK",53,0)
 Q
"RTN","RCXVACK",54,0)
 ;
"RTN","RCXVACK",55,0)
QRY ;  Process Query
"RTN","RCXVACK",56,0)
 S RREFR="^TMP($J,""RCXVACK"",RCI)"
"RTN","RCXVACK",57,0)
 D SPAR^RCXVUTIL(RREFR)
"RTN","RCXVACK",58,0)
 ;
"RTN","RCXVACK",59,0)
 S RCXVFFD=$P($G(RCXSEG(12)),U,1),RCXVFTD=$P($G(RCXSEG(12)),U,2)
"RTN","RCXVACK",60,0)
 S RCXVFFD=$$FMDATE^HLFNC(RCXVFFD)
"RTN","RCXVACK",61,0)
 S RCXVFTD=$$FMDATE^HLFNC(RCXVFTD)
"RTN","RCXVACK",62,0)
 ;
"RTN","RCXVACK",63,0)
 ;  Get the next Saturday date
"RTN","RCXVACK",64,0)
 S CURDT=$$DT^XLFDT()
"RTN","RCXVACK",65,0)
 S CDOW=$$DOW^XLFDT(CURDT,1),NDAYS=6-CDOW
"RTN","RCXVACK",66,0)
 S FDATE=$$FMADD^XLFDT(CURDT,NDAYS)
"RTN","RCXVACK",67,0)
 ;
"RTN","RCXVACK",68,0)
 S RCVXDSC="REQUESTED CBO HISTORICAL EXTRACT"
"RTN","RCXVACK",69,0)
 S ZTDESC=RCVXDSC,ZTRTN="HIS^RCXVTSK",ZTIO=""
"RTN","RCXVACK",70,0)
 S ZTSAVE("RCXVFTD")="",ZTSAVE("RCXVFFD")=""
"RTN","RCXVACK",71,0)
 S ZTDTH=FDATE_".06"
"RTN","RCXVACK",72,0)
 D ^%ZTLOAD
"RTN","RCXVACK",73,0)
 Q
"RTN","RCXVDC")
0^5^B4216729
"RTN","RCXVDC",1,0)
RCXVDC ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC",3,0)
 ;
"RTN","RCXVDC",4,0)
 Q
"RTN","RCXVDC",5,0)
EN ; Entry Point
"RTN","RCXVDC",6,0)
 NEW RCXVD0,RCXVEVDT,RCXVBCN
"RTN","RCXVDC",7,0)
 NEW RCXVI,RCXVCP,RCXVPC,RCXVPFDT,RCXVPTDT
"RTN","RCXVDC",8,0)
 NEW RCXVBLNA,RCXVBLNB,RCXVICN
"RTN","RCXVDC",9,0)
 I DFN="" S DFN=$P($G(^PRCA(430,RCXVBLN,0)),U,7) ; 
"RTN","RCXVDC",10,0)
 K ^TMP($J)
"RTN","RCXVDC",11,0)
 D D430^RCXVDC1
"RTN","RCXVDC",12,0)
 I DFN'="" D D2^RCXVDC2
"RTN","RCXVDC",13,0)
 D D399^RCXVDC3
"RTN","RCXVDC",14,0)
 D D399PC^RCXVDC4
"RTN","RCXVDC",15,0)
 D D350^RCXVDC5
"RTN","RCXVDC",16,0)
 I RCXVRT="D"!(RCXVRT="C") D D433^RCXVDC6
"RTN","RCXVDC",17,0)
 I RCXVRT="H" D D433B^RCXVDC6
"RTN","RCXVDC",18,0)
 ;
"RTN","RCXVDC",19,0)
FILE ;
"RTN","RCXVDC",20,0)
 W "REC:"_RCXVBLNA,!
"RTN","RCXVDC",21,0)
 W "430:"_$G(^TMP($J,RCXVBLN,"1-430A"))_RCXVU
"RTN","RCXVDC",22,0)
 W $G(^TMP($J,RCXVBLN,"1-430B"))_RCXVU
"RTN","RCXVDC",23,0)
 W $G(^TMP($J,RCXVBLN,"1-430C"))
"RTN","RCXVDC",24,0)
 W !
"RTN","RCXVDC",25,0)
 I DFN'="" W "2:"_$G(^TMP($J,RCXVBLN,"2-2A")),!
"RTN","RCXVDC",26,0)
 I $G(^TMP($J,RCXVBLN,"3-399A"))'="" W "399:"_^TMP($J,RCXVBLN,"3-399A")_RCXVU_^TMP($J,RCXVBLN,"3-399B")_RCXVU_^TMP($J,RCXVBLN,"3-399C"),!
"RTN","RCXVDC",27,0)
 F RCXVPC=1:1 Q:('$D(^TMP($J,RCXVBLN,"4-399A",RCXVPC)))  D
"RTN","RCXVDC",28,0)
 . W "399.0304:"
"RTN","RCXVDC",29,0)
 . W $G(^TMP($J,RCXVBLN,"4-399A",RCXVPC))
"RTN","RCXVDC",30,0)
 . W RCXVU
"RTN","RCXVDC",31,0)
 . F RCXVCP=1:1 Q:('$D(^TMP($J,RCXVBLN,"4-399A",RCXVPC,RCXVCP)))  D
"RTN","RCXVDC",32,0)
 . . I RCXVCP>1 W "~"
"RTN","RCXVDC",33,0)
 . . W $G(^TMP($J,RCXVBLN,"4-399A",RCXVPC,RCXVCP))
"RTN","RCXVDC",34,0)
 . . Q
"RTN","RCXVDC",35,0)
 . W !
"RTN","RCXVDC",36,0)
 . I $D(^TMP($J,RCXVBLN,"4-399B",RCXVPC)) W "399.042:"_$G(^TMP($J,RCXVBLN,"4-399B",RCXVPC)),!
"RTN","RCXVDC",37,0)
 . Q
"RTN","RCXVDC",38,0)
 S RCXVI=""
"RTN","RCXVDC",39,0)
 F  S RCXVI=$O(^TMP($J,RCXVBLN,"5-350A",RCXVI)) Q:RCXVI=""  D
"RTN","RCXVDC",40,0)
 . W "350:"_^TMP($J,RCXVBLN,"5-350A",RCXVI),!
"RTN","RCXVDC",41,0)
 ; LOOP THRU ^TMP($J,RCXVBLN,"6-433A",RCXVI)
"RTN","RCXVDC",42,0)
 S RCXVI=""
"RTN","RCXVDC",43,0)
 F  S RCXVI=$O(^TMP($J,RCXVBLN,"6-433A",RCXVI)) Q:RCXVI=""  D 
"RTN","RCXVDC",44,0)
 . W "433:"_$G(^TMP($J,RCXVBLN,"6-433A",RCXVI)),!
"RTN","RCXVDC",45,0)
 . Q
"RTN","RCXVDC",46,0)
 Q
"RTN","RCXVDC1")
0^6^B12509835
"RTN","RCXVDC1",1,0)
RCXVDC1 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC1",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC1",3,0)
 ;
"RTN","RCXVDC1",4,0)
 Q
"RTN","RCXVDC1",5,0)
EN ; Entry Point
"RTN","RCXVDC1",6,0)
 K ^TMP($J)
"RTN","RCXVDC1",7,0)
D430 ; Get #430 data given RCXVBLN 
"RTN","RCXVDC1",8,0)
 N RCXVD,RCXVD1,RCXVD2,RCXVD3,RCXVD4,RCXVP1,RCXVP2
"RTN","RCXVDC1",9,0)
 N RCXVDA,RCXVDB,RCXVDC,RCXVVP1,RCXVVP,RCXVX,RCXVY
"RTN","RCXVDC1",10,0)
 S RCXVD1=$G(^PRCA(430,RCXVBLN,0))
"RTN","RCXVDC1",11,0)
 S RCXVD2=$G(^PRCA(430,RCXVBLN,6))
"RTN","RCXVDC1",12,0)
 S RCXVD3=$G(^PRCA(430,RCXVBLN,7))
"RTN","RCXVDC1",13,0)
 S RCXVD4=$G(^PRCA(430,RCXVBLN,11))
"RTN","RCXVDC1",14,0)
 S RCXVBLNA=$P(RCXVD1,U,1)
"RTN","RCXVDC1",15,0)
 S RCXVBLNB=$P(RCXVBLNA,"-",1)_"-"
"RTN","RCXVDC1",16,0)
 S RCXVDA=RCXVBLNA ; Bill #
"RTN","RCXVDC1",17,0)
 S RCXVP1=$P(RCXVD1,U,2),RCXVP2=""
"RTN","RCXVDC1",18,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430.2,RCXVP1,0)),U,1)
"RTN","RCXVDC1",19,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; Cat (P)
"RTN","RCXVDC1",20,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,3) ; Orig Amt
"RTN","RCXVDC1",21,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,4) ; GL #
"RTN","RCXVDC1",22,0)
 S RCXVP1=$P(RCXVD1,U,8),RCXVP2=""
"RTN","RCXVDC1",23,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430.3,RCXVP1,0)),U,1)
"RTN","RCXVDC1",24,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; Cur Stat (P)
"RTN","RCXVDC1",25,0)
 S RCXVDBN=$$GET1^DIQ(430,RCXVBLN_",",9,"I")
"RTN","RCXVDC1",26,0)
 I RCXVDBN'="" S RCXVDBN=$P(^RCD(340,RCXVDBN,0),U,1)
"RTN","RCXVDC1",27,0)
 I RCXVDBN["DPT",DFN="" S DFN=$P(RCXVDBN,";",1)
"RTN","RCXVDC1",28,0)
 S RCXVVP1=$S(RCXVDBN["DPT":"PATIENT",1:$$GET1^DIQ(430,RCXVBLN_",",9,"E"))
"RTN","RCXVDC1",29,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVVP1 ; Debtor (P)
"RTN","RCXVDC1",30,0)
 S RCXVDT=$P(RCXVD1,U,10)
"RTN","RCXVDC1",31,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT Bill Preprd 
"RTN","RCXVDC1",32,0)
 S RCXVY(430,11,1)=$S($D(^PRCA(430,RCXVBLN,7)):^(7),1:"") ; Cur Bal - Comp
"RTN","RCXVDC1",33,0)
 S RCXVX=$P(RCXVY(430,11,1),U,1)+$P(RCXVY(430,11,1),U,2)+$P(RCXVY(430,11,1),U,3)+$P(RCXVY(430,11,1),U,4)+$P(RCXVY(430,11,1),U,5) S RCXVX=$J(RCXVX,0,2)
"RTN","RCXVDC1",34,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVX ;  Cur. Bal. - computed
"RTN","RCXVDC1",35,0)
 S RCXVDT=$P(RCXVD1,U,14)
"RTN","RCXVDC1",36,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT Stat Upd
"RTN","RCXVDC1",37,0)
 S RCXVDT=$P($P(RCXVD2,U,21),".",1)
"RTN","RCXVDC1",38,0)
 S RCXVDB=$$HLDATE^HLFNC(RCXVDT) ; DT acct actd
"RTN","RCXVDC1",39,0)
 S RCXVDT=$P(RCXVD2,U,1)
"RTN","RCXVDC1",40,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Letter 1 (DT)
"RTN","RCXVDC1",41,0)
 S RCXVDT=$P(RCXVD2,U,4)
"RTN","RCXVDC1",42,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Ref DT
"RTN","RCXVDC1",43,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD2,U,5) ; RF code
"RTN","RCXVDC1",44,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD2,U,6) ; RF amt
"RTN","RCXVDC1",45,0)
 S RCXVDT=$P(RCXVD2,U,10)
"RTN","RCXVDC1",46,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; RF DT
"RTN","RCXVDC1",47,0)
 S RCXVDT=$P(RCXVD2,U,11)
"RTN","RCXVDC1",48,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Rtrn DT
"RTN","RCXVDC1",49,0)
 S RCXVDT=$P(RCXVD2,U,12)
"RTN","RCXVDC1",50,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; RF DT to COWC
"RTN","RCXVDC1",51,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD2,U,13) ; RF amt to COWC
"RTN","RCXVDC1",52,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD4,U,23) ; RSC
"RTN","RCXVDC1",53,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD3,U,1) ; PRIN BAL
"RTN","RCXVDC1",54,0)
 S RCXVDC=$P(RCXVD3,U,2) ; INT BAL
"RTN","RCXVDC1",55,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,3) ; ADMIN COST BAL
"RTN","RCXVDC1",56,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,7) ; TOT PAID PRINC
"RTN","RCXVDC1",57,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,8) ; TOT PAID INT
"RTN","RCXVDC1",58,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,9) ; TOT PAID ADMIN
"RTN","RCXVDC1",59,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD3,U,10) ; TOT PAID MARSHAL FEE
"RTN","RCXVDC1",60,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD4,U,17) ;  FUND
"RTN","RCXVDC1",61,0)
 S RCXVP1=$P(RCXVD4,U,6),RCXVP2=""
"RTN","RCXVDC1",62,0)
 I RCXVP1'="" S RCXVP2=$P($G(^RC(347.3,RCXVP1,0)),U,1)
"RTN","RCXVDC1",63,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; REV SRCE (P)
"RTN","RCXVDC1",64,0)
 S RCXVDT=$$DFP^RCXVUTIL(RCXVBLN)
"RTN","RCXVDC1",65,0)
 S RCXVDC=RCXVDC_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT 1ST PAYMNT
"RTN","RCXVDC1",66,0)
 ; 
"RTN","RCXVDC1",67,0)
 S ^TMP($J,RCXVBLN,"1-430A")=RCXVDA
"RTN","RCXVDC1",68,0)
 S ^TMP($J,RCXVBLN,"1-430B")=RCXVDB
"RTN","RCXVDC1",69,0)
 S ^TMP($J,RCXVBLN,"1-430C")=RCXVDC
"RTN","RCXVDC1",70,0)
 Q
"RTN","RCXVDC1",71,0)
 ;
"RTN","RCXVDC2")
0^7^B3091235
"RTN","RCXVDC2",1,0)
RCXVDC2 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC2",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC2",3,0)
 ;
"RTN","RCXVDC2",4,0)
 ; PATIENT FILE (# 2)
"RTN","RCXVDC2",5,0)
 Q
"RTN","RCXVDC2",6,0)
D2 ; 
"RTN","RCXVDC2",7,0)
 NEW RCXVDT,RCXVD,RCXVD1,RCXVPF,RCXVDA,RCXVENR,RCXVPE,RCXVPE1,RCXVCT
"RTN","RCXVDC2",8,0)
 NEW RCXVCTY,RCXVICN,RCXVELG
"RTN","RCXVDC2",9,0)
 S RCXVD=$G(^DPT(DFN,0))
"RTN","RCXVDC2",10,0)
 S RCXVDT=$P(RCXVD,U,3)
"RTN","RCXVDC2",11,0)
 S RCXVDA=$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT of Birth
"RTN","RCXVDC2",12,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,9) ; SSN
"RTN","RCXVDC2",13,0)
 S RCXVICN=$P($G(^DPT(DFN,"MPI")),U,1)
"RTN","RCXVDC2",14,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVICN ; ICN
"RTN","RCXVDC2",15,0)
 S RCXVDA=RCXVDA_RCXVU_$P($$SITE^VASITE(),U,3)_"v"_DFN ; IEN
"RTN","RCXVDC2",16,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,2) ; SEX
"RTN","RCXVDC2",17,0)
 S RCXVD1=$G(^DPT(DFN,.11))
"RTN","RCXVDC2",18,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,6) ; ZIPCODE
"RTN","RCXVDC2",19,0)
 ;
"RTN","RCXVDC2",20,0)
 NEW VAPA,VAERR
"RTN","RCXVDC2",21,0)
 D ADD^VADPT
"RTN","RCXVDC2",22,0)
 S RCXVCTY=$P($G(VAPA(7)),U,2)
"RTN","RCXVDC2",23,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVCTY ; COUNTY
"RTN","RCXVDC2",24,0)
 ;
"RTN","RCXVDC2",25,0)
 S RCXVPE="",RCXVPE1=""
"RTN","RCXVDC2",26,0)
 S RCXVENR=$P($G(^DPT(DFN,"ENR")),U,1)
"RTN","RCXVDC2",27,0)
 I RCXVENR'="" D
"RTN","RCXVDC2",28,0)
 . S RCXVPE=$P($G(^DGEN(27.11,RCXVENR,0)),U,7) ; Enrollment priority
"RTN","RCXVDC2",29,0)
 . S RCXVPE1=$$GET1^DIQ(27.11,RCXVENR_",",.12,"E") ; Enrollment subgroup
"RTN","RCXVDC2",30,0)
 ;
"RTN","RCXVDC2",31,0)
 ;Primary Eligibility Code
"RTN","RCXVDC2",32,0)
 S RCXVELG=$P($G(^DPT(DFN,.36)),U,1) I RCXVELG'="" S RCXVELG=$P(^DIC(8,RCXVELG,0),U,1)
"RTN","RCXVDC2",33,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVPE_RCXVU_RCXVPE1_RCXVU_RCXVELG
"RTN","RCXVDC2",34,0)
 S ^TMP($J,RCXVBLN,"2-2A")=RCXVDA
"RTN","RCXVDC2",35,0)
 Q
"RTN","RCXVDC2",36,0)
 ;
"RTN","RCXVDC3")
0^8^B16047333
"RTN","RCXVDC3",1,0)
RCXVDC3 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC3",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC3",3,0)
 ;
"RTN","RCXVDC3",4,0)
 ; CLAIMS (# 399)
"RTN","RCXVDC3",5,0)
 Q
"RTN","RCXVDC3",6,0)
D399 ;
"RTN","RCXVDC3",7,0)
 NEW RCXVD,RCXVBC,RCXVDT,RCXVD1,RCXVD2,RCXVD3
"RTN","RCXVDC3",8,0)
 NEW RCXVD4,RCXVD5,RCXVD6,RCXVDA,RCXVDB,RCXVDC
"RTN","RCXVDC3",9,0)
 NEW RCXVP1,RCXVP2,RCXVD0C,RCXVP3,RCXVP4,RCXVCFL
"RTN","RCXVDC3",10,0)
 S RCXVD0=$O(^DGCR(399,"B",$P(RCXVBLNA,"-",2),""))
"RTN","RCXVDC3",11,0)
 I RCXVD0="" Q
"RTN","RCXVDC3",12,0)
 S RCXVD1=$G(^DGCR(399,RCXVD0,0))
"RTN","RCXVDC3",13,0)
 I $G(DFN)="" S DFN=$P(RCXVD1,U,2)
"RTN","RCXVDC3",14,0)
 S RCXVD2=$G(^DGCR(399,RCXVD0,"S"))
"RTN","RCXVDC3",15,0)
 S RCXVD3=$G(^DGCR(399,RCXVD0,"U"))
"RTN","RCXVDC3",16,0)
 S RCXVDA=$P(RCXVD1,U,1) ; BILL #
"RTN","RCXVDC3",17,0)
 S (RCXVEVDT,RCXVDT)=$P($P(RCXVD1,U,3),".",1)
"RTN","RCXVDC3",18,0)
 ;S RCXVDA=RCXVBLNB_RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; EVNT DT
"RTN","RCXVDC3",19,0)
 S RCXVDA=RCXVBLNA_RCXVU_$P(^DPT(DFN,0),U,9) ; SSN
"RTN","RCXVDC3",20,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; EVNT DT
"RTN","RCXVDC3",21,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,5) ; BILL CLASS
"RTN","RCXVDC3",22,0)
 S RCXVP1=$P(RCXVD1,U,7),RCXVP2=""
"RTN","RCXVDC3",23,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DGCR(399.3,RCXVP1,0)),U,1)
"RTN","RCXVDC3",24,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; RATE TYPE (P) 
"RTN","RCXVDC3",25,0)
 S RCXVP1=$P(RCXVD2,U,11),RCXVP2=""
"RTN","RCXVDC3",26,0)
 I RCXVP1'="" S RCXVP2=$P($G(^VA(200,RCXVP1,2,0)),U,1)_RCXVP1 ; SITE_IEN
"RTN","RCXVDC3",27,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVSITE_RCXVP2 ; Authorizer (P)
"RTN","RCXVDC3",28,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,13) ; Stat 
"RTN","RCXVDC3",29,0)
 S RCXVDT=$P(RCXVD1,U,14)
"RTN","RCXVDC3",30,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Stat DT
"RTN","RCXVDC3",31,0)
 S RCXVP1=$P(RCXVD1,U,22),RCXVP2=""
"RTN","RCXVDC3",32,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DG(40.8,RCXVP1,0)),U,2)
"RTN","RCXVDC3",33,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; Default divison
"RTN","RCXVDC3",34,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,24) ; UB92 Location
"RTN","RCXVDC3",35,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,27) ; Bill Chrg type
"RTN","RCXVDC3",36,0)
 S RCXVDT=$P(RCXVD2,U,10)
"RTN","RCXVDC3",37,0)
 S RCXVDB=$E($$HLDATE^HLFNC(RCXVDT),1,8) ; Auth. DT
"RTN","RCXVDC3",38,0)
 S RCXVDT=$P(RCXVD2,U,12)
"RTN","RCXVDC3",39,0)
 S RCXVDB=RCXVDB_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT 1st printd
"RTN","RCXVDC3",40,0)
 S (RCXVP1,RCXVD0C)=$P($G(^DGCR(399,RCXVD0,"M")),U,1),RCXVP2=""
"RTN","RCXVDC3",41,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DIC(36,RCXVP1,0)),U,1)
"RTN","RCXVDC3",42,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2 ; PRIM. INSR (P)
"RTN","RCXVDC3",43,0)
 ;
"RTN","RCXVDC3",44,0)
 ; Type of Plan
"RTN","RCXVDC3",45,0)
 S RCXVP2="",RCXVI=0,RCXVP3="",RCXVP4=""
"RTN","RCXVDC3",46,0)
 F  S RCXVI=$O(^DPT(DFN,.312,RCXVI)) Q:'RCXVI  D
"RTN","RCXVDC3",47,0)
 . I RCXVD0C=$P($G(^DPT(DFN,.312,RCXVI,0)),U,1) D
"RTN","RCXVDC3",48,0)
 .. S RCXVP1=$P($G(^DPT(DFN,.312,RCXVI,0)),U,18),RCXVP2=""
"RTN","RCXVDC3",49,0)
 .. S RCXVP3=$P($G(^DPT(DFN,.312,RCXVI,0)),U,6)
"RTN","RCXVDC3",50,0)
 .. I RCXVP1'="" S RCXVP2=$$GET1^DIQ(355.3,RCXVP1_",",.09,"E")
"RTN","RCXVDC3",51,0)
 .. S RCXVP4=$P($G(^DPT(DFN,.312,RCXVI,1)),U,9)
"RTN","RCXVDC3",52,0)
 .. Q
"RTN","RCXVDC3",53,0)
 . Q
"RTN","RCXVDC3",54,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2_RCXVU_RCXVP3_RCXVU_RCXVP4,RCXVD5="",RCXVD6=""
"RTN","RCXVDC3",55,0)
 ; 
"RTN","RCXVDC3",56,0)
 ; 36, 36.3 ADDRESS/EDI
"RTN","RCXVDC3",57,0)
 I RCXVD0C S RCXVD5=$G(^DIC(36,RCXVD0C,.11))
"RTN","RCXVDC3",58,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,1) ; STRT ADD 1 
"RTN","RCXVDC3",59,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,2) ; STRT ADD 2
"RTN","RCXVDC3",60,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,4) ; CITY
"RTN","RCXVDC3",61,0)
 S RCXVP1=$P(RCXVD5,U,5),RCXVP2=""
"RTN","RCXVDC3",62,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DIC(5,RCXVP1,0)),U,1)
"RTN","RCXVDC3",63,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVP2 ; STATE (P)
"RTN","RCXVDC3",64,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD5,U,6) ; ZIP
"RTN","RCXVDC3",65,0)
 I RCXVD0C'="" S RCXVD6=$G(^DIC(36,RCXVD0C,3))
"RTN","RCXVDC3",66,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD6,U,2) ; EDI - PROF
"RTN","RCXVDC3",67,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD6,U,4) ; EDI - INST
"RTN","RCXVDC3",68,0)
 S RCXVDB=RCXVDB_RCXVU_$$GET1^DIQ(36,RCXVD0C_",",1,"I") ; REIMBURSE?
"RTN","RCXVDC3",69,0)
 ;
"RTN","RCXVDC3",70,0)
 S RCXVPFDT=$P(RCXVD3,U,1)
"RTN","RCXVDC3",71,0)
 S RCXVDC=$$HLDATE^HLFNC(RCXVPFDT) ; STMT COVERS FROM
"RTN","RCXVDC3",72,0)
 S RCXVPTDT=$P(RCXVD3,U,2)
"RTN","RCXVDC3",73,0)
 S RCXVDC=RCXVDC_RCXVU_$$HLDATE^HLFNC(RCXVPTDT) ; STMT COVERS TO
"RTN","RCXVDC3",74,0)
 S RCXVP1=$P(RCXVD3,U,11),RCXVP2=""
"RTN","RCXVDC3",75,0)
 I RCXVP1'="" S RCXVP2=$P($G(^DGCR(399.1,RCXVP1,0)),U,1)
"RTN","RCXVDC3",76,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; DISCH. BED SEC.
"RTN","RCXVDC3",77,0)
 S RCXVD4=$G(^DGCR(399,RCXVD0,"U1"))
"RTN","RCXVDC3",78,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD4,U,1) ; TOT CHRG
"RTN","RCXVDC3",79,0)
 S RCXVDC=RCXVDC_RCXVU_$P(RCXVD4,U,2) ; OFFSET AMT
"RTN","RCXVDC3",80,0)
 ;
"RTN","RCXVDC3",81,0)
 S RCXVP1=$P($G(^DGCR(399,RCXVD0,"U2")),U,10),RCXVP2=""
"RTN","RCXVDC3",82,0)
 I RCXVP1'="" S RCXVP2=$P($G(^IBA(355.93,RCXVP1,0)),U,1)
"RTN","RCXVDC3",83,0)
 S RCXVDC=RCXVDC_RCXVU_RCXVP2 ; NON VA FAC (P)
"RTN","RCXVDC3",84,0)
 ;
"RTN","RCXVDC3",85,0)
 ;  Get VACARE or NONVACARE flag
"RTN","RCXVDC3",86,0)
 NEW RCXVIEN
"RTN","RCXVDC3",87,0)
 D CARE^RCXVUTIL(RCXVD0)
"RTN","RCXVDC3",88,0)
 S RCXVDC=RCXVDC_RCXVU_$S(RCXVCFL=1:"VACARE",1:"NONVACARE")
"RTN","RCXVDC3",89,0)
 S ^TMP($J,RCXVBLN,"3-399A")=RCXVDA
"RTN","RCXVDC3",90,0)
 S ^TMP($J,RCXVBLN,"3-399B")=RCXVDB
"RTN","RCXVDC3",91,0)
 S ^TMP($J,RCXVBLN,"3-399C")=RCXVDC
"RTN","RCXVDC3",92,0)
 Q
"RTN","RCXVDC3",93,0)
 ;
"RTN","RCXVDC4")
0^9^B5716238
"RTN","RCXVDC4",1,0)
RCXVDC4 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC4",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC4",3,0)
 ;
"RTN","RCXVDC4",4,0)
 ; Procedures 
"RTN","RCXVDC4",5,0)
 Q
"RTN","RCXVDC4",6,0)
D399PC ;
"RTN","RCXVDC4",7,0)
 I RCXVD0="" Q
"RTN","RCXVDC4",8,0)
 N RCXVD,RCXVAD,RCXVB,RCXVPC,RCXVP1,RCXVP2
"RTN","RCXVDC4",9,0)
 N RCXVDT3,RCXVCP,RCXVPCDT
"RTN","RCXVDC4",10,0)
 ; RCXVPC=PROC. CODE IEN, RCXVCP=CPT CODE IEN
"RTN","RCXVDC4",11,0)
 ; LOOP THRU PROC.
"RTN","RCXVDC4",12,0)
 F RCXVPC=1:1 Q:'$D(^DGCR(399,RCXVD0,"CP",RCXVPC,0))  D D399PCA
"RTN","RCXVDC4",13,0)
 Q
"RTN","RCXVDC4",14,0)
D399PCA ;
"RTN","RCXVDC4",15,0)
 S RCXVD=$G(^DGCR(399,RCXVD0,"CP",RCXVPC,0))
"RTN","RCXVDC4",16,0)
 S RCXVP1=$P(RCXVD,U,1),RCXVVP="",RCXVVP1=""
"RTN","RCXVDC4",17,0)
 I RCXVP1'="" S RCXVVP="^"_$P(RCXVP1,";",2)_$P(RCXVP1,";",1)_",0)"
"RTN","RCXVDC4",18,0)
 I RCXVVP'="" S RCXVVP1=$P(@RCXVVP,U,1)
"RTN","RCXVDC4",19,0)
 S RCXVDA=RCXVBLNA_RCXVU_RCXVVP1 ; PROC.
"RTN","RCXVDC4",20,0)
 S RCXVDT=$P(RCXVD,U,2)
"RTN","RCXVDC4",21,0)
 S RCXVPCDT=$E($$HLDATE^HLFNC(RCXVDT),1,8)
"RTN","RCXVDC4",22,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVPCDT ; DT 
"RTN","RCXVDC4",23,0)
 S RCXVP1=$P(RCXVD,U,11),RCXVP2=""
"RTN","RCXVDC4",24,0)
 I RCXVP1'="" S RCXVP1=$P(^IBA(362.3,RCXVP1,0),U,1)
"RTN","RCXVDC4",25,0)
 I RCXVP1'="" S RCXVP2=$P($G(^ICD9(RCXVP1,0)),U,1)
"RTN","RCXVDC4",26,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; ASSOC DXN (1)
"RTN","RCXVDC4",27,0)
 S RCXVP1=$P(RCXVD,U,7),RCXVP2=""
"RTN","RCXVDC4",28,0)
 I RCXVP1'="" S RCXVP2=$P($G(^SC(RCXVP1,0)),U,1)
"RTN","RCXVDC4",29,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; ASSC. CLNC (P) 
"RTN","RCXVDC4",30,0)
 S RCXVP1=$P(RCXVD,U,18),RCXVP2=""
"RTN","RCXVDC4",31,0)
 I RCXVP1'="" S RCXVP2=$P($G(^VA(200,RCXVP1,0)),U,1)
"RTN","RCXVDC4",32,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; PRVDR (P)
"RTN","RCXVDC4",33,0)
 S ^TMP($J,RCXVBLN,"4-399A",RCXVPC)=RCXVDA
"RTN","RCXVDC4",34,0)
 ; LOOP THRU CPT
"RTN","RCXVDC4",35,0)
 F RCXVCP=1:1 Q:'($D(^DGCR(399,RCXVD0,"CP",RCXVPC,"MOD",RCXVCP,0)))  D
"RTN","RCXVDC4",36,0)
 . ; ^DGCR(399,D0,CP,D1,MOD,D2,0)= (#.01) CPT MODIFIER SEQUENCE [1N]
"RTN","RCXVDC4",37,0)
 . ; (#.02) CPT ==>MODIFIER [2P:81.3]
"RTN","RCXVDC4",38,0)
 . S RCXVP1=$P($G(^DGCR(399,RCXVD0,"CP",RCXVPC,"MOD",RCXVCP,0)),U,2)
"RTN","RCXVDC4",39,0)
 . I RCXVP1'="" S RCXVP2=$P($G(^DIC(81.3,RCXVP1,0)),U,1)
"RTN","RCXVDC4",40,0)
 . S ^TMP($J,RCXVBLN,"4-399A",RCXVPC,RCXVCP)=RCXVP2
"RTN","RCXVDC4",41,0)
 . Q
"RTN","RCXVDC4",42,0)
D39942 ; CHARGES FROM 399.042
"RTN","RCXVDC4",43,0)
 ; LOOP THRU 399.042
"RTN","RCXVDC4",44,0)
 S RCXVD1=$G(^DGCR(399,RCXVD0,"RC",RCXVPC,0))
"RTN","RCXVDC4",45,0)
 I RCXVD1="" Q
"RTN","RCXVDC4",46,0)
 S RCXVDB=RCXVBLNA_RCXVU_$P(RCXVD1,U,1) ; Revenue Code
"RTN","RCXVDC4",47,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD1,U,6) ; Procedures [P]
"RTN","RCXVDC4",48,0)
 S RCXVDB=RCXVDB_RCXVU_RCXVPCDT ; PROC. DT
"RTN","RCXVDC4",49,0)
 S RCXVDB=RCXVDB_RCXVU_$P(RCXVD1,U,2) ; Charges
"RTN","RCXVDC4",50,0)
 S ^TMP($J,RCXVBLN,"4-399B",RCXVPC)=RCXVDB
"RTN","RCXVDC4",51,0)
 Q
"RTN","RCXVDC4",52,0)
 ;
"RTN","RCXVDC5")
0^10^B2946234
"RTN","RCXVDC5",1,0)
RCXVDC5 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC5",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC5",3,0)
 ;
"RTN","RCXVDC5",4,0)
 ; Integrated Billing Action File (# 350) 
"RTN","RCXVDC5",5,0)
 Q
"RTN","RCXVDC5",6,0)
D350 ; 
"RTN","RCXVDC5",7,0)
 NEW RCXVD,RCXVDA,RCXVDB,RCXVD0A,RCXVDT,RCXVP1,RCXVP2,RCXVPC,RCT
"RTN","RCXVDC5",8,0)
 S RCXVD0A="",RCT=0
"RTN","RCXVDC5",9,0)
 F  S RCXVD0A=$O(^IB("ABIL",RCXVBLNA,RCXVD0A)) Q:RCXVD0A=""  D
"RTN","RCXVDC5",10,0)
 . S RCXVD=$G(^IB(RCXVD0A,0))
"RTN","RCXVDC5",11,0)
 . I $G(DFN)="" S DFN=$P(RCXVD,U,2)
"RTN","RCXVDC5",12,0)
 . ;
"RTN","RCXVDC5",13,0)
 . S RCXVDA=RCXVBLNA_RCXVU_$P(RCXVD,U,1)
"RTN","RCXVDC5",14,0)
 . S RCXVDA=RCXVDA_RCXVU_$$GET1^DIQ(350,RCXVD0A_",",.05,"E")
"RTN","RCXVDC5",15,0)
 . S RCXVP1=$P(RCXVD,U,3),RCXVP2=""
"RTN","RCXVDC5",16,0)
 . I RCXVP1'="" S RCXVP2=$P($G(^IBE(350.1,RCXVP1,0)),U,1)
"RTN","RCXVDC5",17,0)
 . S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; ACTION TYPE (P)
"RTN","RCXVDC5",18,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,6) ; UNITS
"RTN","RCXVDC5",19,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,7) ; TOTAL CHARGE
"RTN","RCXVDC5",20,0)
 . S RCXVDT=$P(RCXVD,U,14)
"RTN","RCXVDC5",21,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT BILLD FROM
"RTN","RCXVDC5",22,0)
 . S RCXVDT=$P(RCXVD,U,15)
"RTN","RCXVDC5",23,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT BILLD TO
"RTN","RCXVDC5",24,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,11) ; AR BILL #
"RTN","RCXVDC5",25,0)
 . S RCXVDT=$P($P($G(^IB(RCXVD0A,1)),U,2),".",1)
"RTN","RCXVDC5",26,0)
 . S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT ENTRY ADDED
"RTN","RCXVDC5",27,0)
 . S RCXVDA=RCXVDA_RCXVU_$P(^DPT(DFN,0),U,9) ; SSN
"RTN","RCXVDC5",28,0)
 . S RCT=RCT+1
"RTN","RCXVDC5",29,0)
 . S ^TMP($J,RCXVBLN,"5-350A",RCT)=RCXVDA
"RTN","RCXVDC5",30,0)
 Q
"RTN","RCXVDC5",31,0)
 ;
"RTN","RCXVDC6")
0^11^B4436888
"RTN","RCXVDC6",1,0)
RCXVDC6 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC6",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC6",3,0)
 ;
"RTN","RCXVDC6",4,0)
 ; Accounts Recv. Trans. File (# 433) 
"RTN","RCXVDC6",5,0)
 Q
"RTN","RCXVDC6",6,0)
D433 ; 
"RTN","RCXVDC6",7,0)
 K ^TMP($J,RCXVBLN,"6-433A")
"RTN","RCXVDC6",8,0)
 ; LOOP THRU(^PRCA(433,"C",RCXVBLN)
"RTN","RCXVDC6",9,0)
 ;
"RTN","RCXVDC6",10,0)
 ;  If the current fiscal year flag is set, must loop for
"RTN","RCXVDC6",11,0)
 ;  all the transactions since the beginning of the fiscal year
"RTN","RCXVDC6",12,0)
 I $G(RCXVCFLG)=1 S RCXVBDT=RCXVFFD
"RTN","RCXVDC6",13,0)
 NEW RCXVD,RCXVDA,RCXVDT,RCXVI,RCXVP1,RCXVP2,RCXVD0B
"RTN","RCXVDC6",14,0)
 S RCXVD0B=""
"RTN","RCXVDC6",15,0)
 F RCXVI=1:1 S RCXVD0B=$O(^PRCA(433,"C",RCXVBLN,RCXVD0B)) Q:RCXVD0B=""  D D433A
"RTN","RCXVDC6",16,0)
 Q
"RTN","RCXVDC6",17,0)
D433A ;
"RTN","RCXVDC6",18,0)
 S RCXVD=$G(^PRCA(433,RCXVD0B,1))
"RTN","RCXVDC6",19,0)
 S RCXVP1=$P($G(^PRCA(433,RCXVD0B,0)),U,2),RCXVP2=""
"RTN","RCXVDC6",20,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430,RCXVP1,0)),U,1)
"RTN","RCXVDC6",21,0)
 S RCXVDA=RCXVP2 ; BILL NUMBER (P) 
"RTN","RCXVDC6",22,0)
 S RCXVDA=RCXVDA_RCXVU_$P($G(^PRCA(433,RCXVD0B,0)),U,1) ; TRANS. #
"RTN","RCXVDC6",23,0)
 S RCXVDT=$P(RCXVD,U,1)
"RTN","RCXVDC6",24,0)
 I RCXVDT<RCXVBDT Q  ;QUIT IF TRANS. IS OLDER THAN BATCH DATE
"RTN","RCXVDC6",25,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; TRANS. DT
"RTN","RCXVDC6",26,0)
 S RCXVP1=$P(RCXVD,U,2),RCXVP2=""
"RTN","RCXVDC6",27,0)
 I RCXVP1'="",+$P(^PRCA(430.3,RCXVP1,0),U,6)=0 Q
"RTN","RCXVDC6",28,0)
 I RCXVP1'="" S RCXVP2=$P($G(^PRCA(430.3,RCXVP1,0)),U,1)
"RTN","RCXVDC6",29,0)
 S RCXVDA=RCXVDA_RCXVU_RCXVP2 ; TRANS TYPE (P)
"RTN","RCXVDC6",30,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC(RCXVDT),1,8) ; DT ENTRD
"RTN","RCXVDC6",31,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD,U,5) ; TRANS AMT
"RTN","RCXVDC6",32,0)
 S RCXVDA=RCXVDA_RCXVU_$$GET1^DIQ(433,RCXVD0B_",",88,"E") ; CONT. ADJ.
"RTN","RCXVDC6",33,0)
 S ^TMP($J,RCXVBLN,"6-433A",RCXVI)=RCXVDA
"RTN","RCXVDC6",34,0)
 Q
"RTN","RCXVDC6",35,0)
 ;
"RTN","RCXVDC6",36,0)
D433B ;
"RTN","RCXVDC6",37,0)
 NEW RCXVDA,RCXVD0B,RCXVI,RQFL
"RTN","RCXVDC6",38,0)
 S RCXVD0B="",RQFL=0
"RTN","RCXVDC6",39,0)
 F RCXVI=1:1 S RCXVD0B=$O(^PRCA(433,"C",RCXVBLN,RCXVD0B)) Q:RCXVD0B=""  D  Q:RQFL
"RTN","RCXVDC6",40,0)
 . S RCXVDA=$$GET1^DIQ(433,RCXVD0B_",",88,"E") ; Contractual Adj
"RTN","RCXVDC6",41,0)
 . I RCXVDA'="" S $P(^TMP($J,RCXVBLN,"6-433A",1),U,7)=RCXVDA,RQFL=1
"RTN","RCXVDC6",42,0)
 Q
"RTN","RCXVDC7")
1^12
"RTN","RCXVDC8")
0^13^B2040377
"RTN","RCXVDC8",1,0)
RCXVDC8 ;DAOU/ALA-AR Data Extraction Data Creation ;02-JUL-03
"RTN","RCXVDC8",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDC8",3,0)
 ;
"RTN","RCXVDC8",4,0)
 ; AR Batch Payment File (# 344) 
"RTN","RCXVDC8",5,0)
 Q
"RTN","RCXVDC8",6,0)
D344 ;
"RTN","RCXVDC8",7,0)
 S RCXVD=$G(^RCY(344,RCXVD0,0)) ;    
"RTN","RCXVDC8",8,0)
 S RCXVP1=$P(RCXVD,U,6) ; PTR TO DEPOSIT TICKET
"RTN","RCXVDC8",9,0)
 I RCXVP1="" Q
"RTN","RCXVDC8",10,0)
 S RCXVD1=$G(^RCY(344.1,RCXVP1,0))
"RTN","RCXVDC8",11,0)
 ;
"RTN","RCXVDC8",12,0)
 S RCXVDA=$P(RCXVD,U,1)
"RTN","RCXVDC8",13,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,1) ; Ticket # (P)
"RTN","RCXVDC8",14,0)
 S RCXVDA=RCXVDA_RCXVU_$E($$HLDATE^HLFNC($P(RCXVD,U,8)),1,8) ; Date/Time Proc
"RTN","RCXVDC8",15,0)
 S RCXVDA=RCXVDA_RCXVU_$P(RCXVD1,U,4) ; (344.1) Amt Deposit
"RTN","RCXVDC8",16,0)
 S RCXVDA=RCXVDA_RCXVU_$$RECTOTAL^RCDPURED(RCXVP1) ; Totl Amt of Receipts (Comp)
"RTN","RCXVDC8",17,0)
 S RCXVDA=RCXVDA_RCXVU_$$RECCOUNT^RCDPURED(RCXVP1) ; Totl Receipts (Comp)
"RTN","RCXVDC8",18,0)
 S ^TMP($J,"RCXVDC8",RCXVD0)=RCXVDA
"RTN","RCXVDC8",19,0)
 W "REC:"_$P(RCXVDA,RCXVU,1),!
"RTN","RCXVDC8",20,0)
 W "344:"_$P(RCXVDA,RCXVU,2,7),!
"RTN","RCXVDC8",21,0)
 ;
"RTN","RCXVDC8",22,0)
 S RCXVI=""
"RTN","RCXVDC8",23,0)
 F  S RCXVI=$O(^TMP($J,"7-162A",RCXVI)) Q:RCXVI=""  D
"RTN","RCXVDC8",24,0)
 . W "162:"_$G(^TMP($J,"7-162A",RCXVI))
"RTN","RCXVDC8",25,0)
 . W !
"RTN","RCXVDC8",26,0)
 Q
"RTN","RCXVDC8",27,0)
 ;
"RTN","RCXVDEQ")
0^1^B14701950
"RTN","RCXVDEQ",1,0)
RCXVDEQ ;DAOU/ALA-AR Data Extract Queue Trigger ;02-JUL-03
"RTN","RCXVDEQ",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVDEQ",3,0)
 ;
"RTN","RCXVDEQ",4,0)
 ;**Program Description**
"RTN","RCXVDEQ",5,0)
 ;  This program will log a record who meets the
"RTN","RCXVDEQ",6,0)
 ;  selection criteria for the VISTA Data Extract
"RTN","RCXVDEQ",7,0)
 ;
"RTN","RCXVDEQ",8,0)
AR ;  Triggers from the Accounts Receivable File (#430)
"RTN","RCXVDEQ",9,0)
 NEW DFN
"RTN","RCXVDEQ",10,0)
 ;
"RTN","RCXVDEQ",11,0)
 S RCXVBLN=D0,RCXVSTAT=$P(^PRCA(430,D0,0),U,8)
"RTN","RCXVDEQ",12,0)
 I '+$P(^PRCA(430.3,RCXVSTAT,0),U,6) Q
"RTN","RCXVDEQ",13,0)
 ;
"RTN","RCXVDEQ",14,0)
 S DFN=$P(^PRCA(430,D0,0),U,7)
"RTN","RCXVDEQ",15,0)
 D FIL("D")
"RTN","RCXVDEQ",16,0)
 ;
"RTN","RCXVDEQ",17,0)
 K RCXVBLN,RCXVSTAT
"RTN","RCXVDEQ",18,0)
 Q
"RTN","RCXVDEQ",19,0)
 ;
"RTN","RCXVDEQ",20,0)
AT ;  Triggers from the Accounts Receivable Transactions (#433)
"RTN","RCXVDEQ",21,0)
 NEW DFN
"RTN","RCXVDEQ",22,0)
 ;
"RTN","RCXVDEQ",23,0)
 S RCXVBLN=$P($G(^PRCA(433,D0,0)),U,2)
"RTN","RCXVDEQ",24,0)
 S RCXVTYP=$P($G(^PRCA(433,D0,1)),U,2)
"RTN","RCXVDEQ",25,0)
 I RCXVTYP="" Q
"RTN","RCXVDEQ",26,0)
 ;
"RTN","RCXVDEQ",27,0)
 I '+$P(^PRCA(430.3,RCXVTYP,0),U,6) Q
"RTN","RCXVDEQ",28,0)
 ;
"RTN","RCXVDEQ",29,0)
 S DFN=$P(^PRCA(430,RCXVBLN,0),U,7)
"RTN","RCXVDEQ",30,0)
 D FIL("D")
"RTN","RCXVDEQ",31,0)
 ;
"RTN","RCXVDEQ",32,0)
 K RCXVBLN,RCXVTYP
"RTN","RCXVDEQ",33,0)
 Q
"RTN","RCXVDEQ",34,0)
 ;
"RTN","RCXVDEQ",35,0)
FIL(RCXVBTY) ;  File the record into the AR Data Queue File (#348.4)
"RTN","RCXVDEQ",36,0)
 ;
"RTN","RCXVDEQ",37,0)
 ;  If a test system has 'turned off' extract, quit
"RTN","RCXVDEQ",38,0)
 I '$$GET1^DIQ(342,"1,",20.04,"I") Q
"RTN","RCXVDEQ",39,0)
 ;
"RTN","RCXVDEQ",40,0)
 ;  Input Parameter
"RTN","RCXVDEQ",41,0)
 ;    RCXVBTY = Batch Type (H=Historical, D=Daily, C=Current Fiscal Year, A=Active)
"RTN","RCXVDEQ",42,0)
 ;    RCXVBLN = Bill IEN
"RTN","RCXVDEQ",43,0)
 ;
"RTN","RCXVDEQ",44,0)
 N FDA,RCXVCURB,RCVXBNM,RCVXBMX
"RTN","RCXVDEQ",45,0)
 ; 
"RTN","RCXVDEQ",46,0)
 ; Where there has been any update/change to the system 
"RTN","RCXVDEQ",47,0)
 ; for a particular bill for the previous days business business (T-1). 
"RTN","RCXVDEQ",48,0)
 ;
"RTN","RCXVDEQ",49,0)
 ; Get current batch
"RTN","RCXVDEQ",50,0)
BTC K ^TMP("RCXVA",$J)
"RTN","RCXVDEQ",51,0)
 D FIND^DIC(348.4,"","","P",DT,"","C","I $P(^(0),U,4)=RCXVBTY","","^TMP(""RCXVA"",$J)")
"RTN","RCXVDEQ",52,0)
 S RCXVCURB=+$P($G(^TMP("RCXVA",$J,"DILIST",0)),U,1)
"RTN","RCXVDEQ",53,0)
 S RCVXCTY="",RCXVBDT="",RCXQFL=0
"RTN","RCXVDEQ",54,0)
 ;
"RTN","RCXVDEQ",55,0)
 ;  If there is no batch for today, create a new batch
"RTN","RCXVDEQ",56,0)
 I RCXVCURB=0 D NBT G CON:'RCXQFL,BTC
"RTN","RCXVDEQ",57,0)
 ;
"RTN","RCXVDEQ",58,0)
 ; Check to see if batch is full.
"RTN","RCXVDEQ",59,0)
 S RCXVCURB=$P(^TMP("RCXVA",$J,"DILIST",RCXVCURB,0),U,1)
"RTN","RCXVDEQ",60,0)
 I RCXVCURB'=0 D
"RTN","RCXVDEQ",61,0)
 . S RCVXBNM=$P($G(^RCXV(RCXVCURB,0)),U,7) ; Number of record in batch
"RTN","RCXVDEQ",62,0)
 . S RCVXCTY=$P($G(^RCXV(RCXVCURB,0)),U,4) ; Current batch type
"RTN","RCXVDEQ",63,0)
 . S RCXVBDT=$P($G(^RCXV(RCXVCURB,0)),U,2) ; Batch Date
"RTN","RCXVDEQ",64,0)
 . S RCXVBST=$P($G(^RCXV(RCXVCURB,0)),U,3) ; Batch Status
"RTN","RCXVDEQ",65,0)
 S RCVXBMX=$P($G(^RC(342,1,20)),U,5) ; Max. # of record per batch
"RTN","RCXVDEQ",66,0)
 ;  OR if the number of records in batch exceeds the
"RTN","RCXVDEQ",67,0)
 ;  maximum number of records per batch --> create new batch
"RTN","RCXVDEQ",68,0)
 I (RCVXBNM>RCVXBMX)!(RCVXBNM=RCVXBMX)!(RCXVBST="T") D NBT G BTC:RCXQFL=1
"RTN","RCXVDEQ",69,0)
 ;
"RTN","RCXVDEQ",70,0)
CON ;  Continue with updating the AR Data Queue file
"RTN","RCXVDEQ",71,0)
 S RCXVDA=$S($G(RCXVCURB)'=0:RCXVCURB,1:RCXVDA)
"RTN","RCXVDEQ",72,0)
 ;
"RTN","RCXVDEQ",73,0)
 ;  If the Batch Type is 'R', quit
"RTN","RCXVDEQ",74,0)
 I RCXVBTY="R" Q
"RTN","RCXVDEQ",75,0)
 ;
"RTN","RCXVDEQ",76,0)
 ;  If this bill number already exists in this batch, quit
"RTN","RCXVDEQ",77,0)
 I $D(^RCXV(RCXVDA,1,RCXVBLN)) Q
"RTN","RCXVDEQ",78,0)
 ;
"RTN","RCXVDEQ",79,0)
 ; File record
"RTN","RCXVDEQ",80,0)
 NEW DIC,DIE,X,DA,DLAYGO,Y,DINUM
"RTN","RCXVDEQ",81,0)
 S DA(1)=RCXVDA,DIC="^RCXV("_DA(1)_",1,",DIE=DIC,(X,DINUM)=RCXVBLN
"RTN","RCXVDEQ",82,0)
 S DLAYGO=348.41,DIC(0)="L",DIC("P")=DLAYGO
"RTN","RCXVDEQ",83,0)
 I '$D(^RCXV(DA(1),1,0)) S ^RCXV(DA(1),1,0)="^348.41^^"
"RTN","RCXVDEQ",84,0)
 D FILE^DICN
"RTN","RCXVDEQ",85,0)
 ;
"RTN","RCXVDEQ",86,0)
 S RCUPD(348.4,RCXVDA_",",.07)=(RCVXBNM+1)
"RTN","RCXVDEQ",87,0)
 S RCUPD(348.41,RCXVBLN_","_RCXVDA_",",.02)=$G(DFN)
"RTN","RCXVDEQ",88,0)
 D FILE^DIE("","RCUPD","RCXVERR")
"RTN","RCXVDEQ",89,0)
 ;
"RTN","RCXVDEQ",90,0)
 K RCXVDA,RCVXBNM,RCXVBLN,RCXVCURB,RCXVBTY,RCVXBMX,RCVXCTY,RCXVBDT
"RTN","RCXVDEQ",91,0)
 K ^TMP("RCXVA",$J),IENARRAY,RCXVBST,RCUPD,RCXVERR,RCXQFL
"RTN","RCXVDEQ",92,0)
 Q
"RTN","RCXVDEQ",93,0)
 ;
"RTN","RCXVDEQ",94,0)
NBT ;  Create a new batch
"RTN","RCXVDEQ",95,0)
 N $ES,$ET
"RTN","RCXVDEQ",96,0)
 S $ET="D ER^RCXVDEQ"
"RTN","RCXVDEQ",97,0)
 L +^RCXVLK:1 E  S RCXQFL=1 Q
"RTN","RCXVDEQ",98,0)
 S RCXVCURB=$P(^RCXV(0),U,3)+1
"RTN","RCXVDEQ",99,0)
 S RCVXBNM=0
"RTN","RCXVDEQ",100,0)
 S FDA(348.4,"+1,",.01)=RCXVCURB
"RTN","RCXVDEQ",101,0)
 S FDA(348.4,"+1,",.02)=DT
"RTN","RCXVDEQ",102,0)
 S FDA(348.4,"+1,",.03)="P"
"RTN","RCXVDEQ",103,0)
 S FDA(348.4,"+1,",.04)=RCXVBTY
"RTN","RCXVDEQ",104,0)
 S FDA(348.4,"+1,",.07)=RCVXBNM
"RTN","RCXVDEQ",105,0)
 D UPDATE^DIE("","FDA","IENARRAY","ERROR")
"RTN","RCXVDEQ",106,0)
 I '$D(ERROR) S RCXVDA=$G(IENARRAY(1))
"RTN","RCXVDEQ",107,0)
 L -^RCXVLK
"RTN","RCXVDEQ",108,0)
 Q
"RTN","RCXVDEQ",109,0)
 ;
"RTN","RCXVDEQ",110,0)
UDR ;  Update Deposits/Receipts subfile
"RTN","RCXVDEQ",111,0)
 ; If this batch payment number already exists in this batch, quit
"RTN","RCXVDEQ",112,0)
 I $D(^RCXV(RCXVDA,2,RCXVD0)) Q
"RTN","RCXVDEQ",113,0)
 ;
"RTN","RCXVDEQ",114,0)
 ; File record
"RTN","RCXVDEQ",115,0)
 NEW DIC,DIE,X,DA,DLAYGO,Y,DINUM
"RTN","RCXVDEQ",116,0)
 S DA(1)=RCXVDA,DIC="^RCXV("_DA(1)_",2,",DIE=DIC,(X,DINUM)=RCXVD0
"RTN","RCXVDEQ",117,0)
 S DLAYGO=348.42,DIC(0)="L",DIC("P")=DLAYGO
"RTN","RCXVDEQ",118,0)
 I '$D(^RCXV(DA(1),2,0)) S ^RCXV(DA(1),2,0)="^348.42^^"
"RTN","RCXVDEQ",119,0)
 D FILE^DICN
"RTN","RCXVDEQ",120,0)
 ;
"RTN","RCXVDEQ",121,0)
 S RCUPD(348.4,RCXVDA_",",.07)=RCXVRNUM
"RTN","RCXVDEQ",122,0)
 D FILE^DIE("","RCUPD","RCXVERR")
"RTN","RCXVDEQ",123,0)
 K RCXVERR,RCUPD
"RTN","RCXVDEQ",124,0)
 Q
"RTN","RCXVDEQ",125,0)
 ;
"RTN","RCXVDEQ",126,0)
ER ; Unlock and log error
"RTN","RCXVDEQ",127,0)
 L -^RCXVLK
"RTN","RCXVDEQ",128,0)
 D ^%ZTER
"RTN","RCXVDEQ",129,0)
 D UNWIND^%ZTER
"RTN","RCXVDEQ",130,0)
 Q
"RTN","RCXVFTC")
0^22^B3062600
"RTN","RCXVFTC",1,0)
RCXVFTC ;DAOU/ALA-FTP for Cache NT ;16-DEC-2003
"RTN","RCXVFTC",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVFTC",3,0)
 ;
"RTN","RCXVFTC",4,0)
OUT ;  Outgoing
"RTN","RCXVFTC",5,0)
 D CTXT
"RTN","RCXVFTC",6,0)
 ;
"RTN","RCXVFTC",7,0)
 S Y=$$GTF^%ZISH($NA(^TMP($J,"RCXVFTP",1,0)),3,RCXVPTH,RCXVBAT)
"RTN","RCXVFTC",8,0)
 K ^TMP($J,"RCXVFTP")
"RTN","RCXVFTC",9,0)
 I 'Y S VALMSG="Not able to create the .COM file" Q
"RTN","RCXVFTC",10,0)
 ;
"RTN","RCXVFTC",11,0)
BAT ;  Create the .COM file
"RTN","RCXVFTC",12,0)
 S RCXVOUT="S X=$ZF(-1,""ftp -n -s:""_RCXVPTH_RCXVBAT_"">""_RCXVPTH_RCXVSCR)"
"RTN","RCXVFTC",13,0)
 ;
"RTN","RCXVFTC",14,0)
 X RCXVOUT
"RTN","RCXVFTC",15,0)
 ;
"RTN","RCXVFTC",16,0)
 Q
"RTN","RCXVFTC",17,0)
 ;
"RTN","RCXVFTC",18,0)
CTXT ;
"RTN","RCXVFTC",19,0)
 S RCXVFTP="RCXVCBO"
"RTN","RCXVFTC",20,0)
 S RCXVSCR=RCXVSCR_".LIS",^TMP("RCXVMSG",$J,RCXVSCR)=""
"RTN","RCXVFTC",21,0)
 S RCXVBAT=RCXVFTP_$S($G(RCXVSYS)="VMS":".COM",1:".BAT")
"RTN","RCXVFTC",22,0)
 S RCXVTXT=RCXVFTP_".TXT"
"RTN","RCXVFTC",23,0)
 ;
"RTN","RCXVFTC",24,0)
 ;  Kill off the .COM and .TXT files
"RTN","RCXVFTC",25,0)
 S RCXVARRY(RCXVTXT)="",RCXVARRY(RCXVBAT)=""
"RTN","RCXVFTC",26,0)
 S Y=$$DEL^%ZISH(RCXVPTH,$NA(RCXVARRY))
"RTN","RCXVFTC",27,0)
 K RCXVARRY
"RTN","RCXVFTC",28,0)
 ;
"RTN","RCXVFTC",29,0)
 S ^TMP($J,"RCXVFTP",1,0)="open "_RCXVIP
"RTN","RCXVFTC",30,0)
 S ^TMP($J,"RCXVFTP",2,0)="user "_RCXVUSR_" "_RCXVPAS
"RTN","RCXVFTC",31,0)
 ;
"RTN","RCXVFTC",32,0)
 ;  A root directory must have a slash for CACHE NT
"RTN","RCXVFTC",33,0)
 ;  but a folder cannot have a slash
"RTN","RCXVFTC",34,0)
 I RCXVPTH?1A1":\" S RCXVROOT=$E(RCXVPTH,1,$L(RCXVPTH))
"RTN","RCXVFTC",35,0)
 I RCXVPTH'?1A1":\" S RCXVROOT=$S($E(RCXVPTH,$L(RCXVPTH),$L(RCXVPTH))="\":$E(RCXVPTH,1,$L(RCXVPTH)-1),1:RCXVPTH)
"RTN","RCXVFTC",36,0)
 ;
"RTN","RCXVFTC",37,0)
 S ^TMP($J,"RCXVFTP",3,0)="lcd "_RCXVROOT
"RTN","RCXVFTC",38,0)
 S ^TMP($J,"RCXVFTP",4,0)="put "_RCXVNME
"RTN","RCXVFTC",39,0)
 S ^TMP($J,"RCXVFTP",5,0)="quit"
"RTN","RCXVFTC",40,0)
 Q
"RTN","RCXVFTP")
0^14^B4723718
"RTN","RCXVFTP",1,0)
RCXVFTP ;DAOU/ALA-FTP AR Data Extract Batch Files ;08-SEP-03
"RTN","RCXVFTP",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVFTP",3,0)
 ;
"RTN","RCXVFTP",4,0)
 ;**Program Description**
"RTN","RCXVFTP",5,0)
 ;  This code will ftp a batch file
"RTN","RCXVFTP",6,0)
 ;
"RTN","RCXVFTP",7,0)
EN(FILE,DIREC) ;
"RTN","RCXVFTP",8,0)
 ;  Input Parameter
"RTN","RCXVFTP",9,0)
 ;    FILE = Filename
"RTN","RCXVFTP",10,0)
 ;    DIREC = Directory
"RTN","RCXVFTP",11,0)
 S RCXVPTH=$S($G(DIREC)'="":DIREC,1:RCXVDIR)
"RTN","RCXVFTP",12,0)
 ;
"RTN","RCXVFTP",13,0)
SYS ;  Get system type
"RTN","RCXVFTP",14,0)
 S RCXVSYS=$$VERSION^%ZOSV(1)
"RTN","RCXVFTP",15,0)
 I RCXVSYS["DSM" S RCXVSYS="VMS",RCXVSYT="DSM"
"RTN","RCXVFTP",16,0)
 I RCXVSYS["MSM" D
"RTN","RCXVFTP",17,0)
 . I RCXVSYS["NT"!(RCXVSYS["PC") S RCXVSYS="MSM",RCXVSYT="MSM" Q
"RTN","RCXVFTP",18,0)
 . E  S RCXVSYS="UNIX",RCXVSYT="MSM"
"RTN","RCXVFTP",19,0)
 I RCXVSYS["Cache" D
"RTN","RCXVFTP",20,0)
 . I RCXVSYS["VMS" S RCXVSYS="VMS",RCXVSYT="CACHE" Q
"RTN","RCXVFTP",21,0)
 . S RCXVSYS="CACHE",RCXVSYT="CACHE"
"RTN","RCXVFTP",22,0)
 ;
"RTN","RCXVFTP",23,0)
 I RCXVSYS="VMS" S RCXVNME=FILE_";1"
"RTN","RCXVFTP",24,0)
 I RCXVSYS'="VMS" S RCXVNME=FILE
"RTN","RCXVFTP",25,0)
 ;
"RTN","RCXVFTP",26,0)
ARC ;  Directly FTP to the Boston Allocation Resource Center
"RTN","RCXVFTP",27,0)
 I $$GET1^DIQ(342,"1,",20.06,"I")="P" D
"RTN","RCXVFTP",28,0)
 . S RCXVIP="MORPHEUS.ARC.MED.VA.GOV"
"RTN","RCXVFTP",29,0)
 . S RCXVUSR="mccf"
"RTN","RCXVFTP",30,0)
 . S RCXVPAS="1qaz2wsx"
"RTN","RCXVFTP",31,0)
 ;
"RTN","RCXVFTP",32,0)
 I $$GET1^DIQ(342,"1,",20.06,"I")'="P" D
"RTN","RCXVFTP",33,0)
 . S RCXVIP="MORPHEUS.ARC.MED.VA.GOV"
"RTN","RCXVFTP",34,0)
 . S RCXVUSR="cbotest"
"RTN","RCXVFTP",35,0)
 . S RCXVPAS="1qaz2wsx"
"RTN","RCXVFTP",36,0)
 ;
"RTN","RCXVFTP",37,0)
 I RCXVSYS="VMS" D ^RCXVFTV
"RTN","RCXVFTP",38,0)
 I RCXVSYS'="VMS" D ^RCXVFTC
"RTN","RCXVFTP",39,0)
 ;
"RTN","RCXVFTP",40,0)
 S RCXVARRY(RCXVTXT)="",RCXVARRY(RCXVBAT)="",RCXVARRY(RCXVNME)=""
"RTN","RCXVFTP",41,0)
 S Y=$$DEL^%ZISH(RCXVPTH,$NA(RCXVARRY))
"RTN","RCXVFTP",42,0)
 K RCXVARRY,%ZISHF,%ZISHO,%ZISUB,DIREC,FILE,I,RCXCT,RCXI,RCXOKAY,RCXVBAT
"RTN","RCXVFTP",43,0)
 K RCXVFTP,RCXVHNDL,RCXVIP,RCXVNME,RCXVOUT,RCXVPAS,RCXVPTH,RCXVSCR,XMY
"RTN","RCXVFTP",44,0)
 K RCXVSYS,RCXVSYT,RCXVTXT,RCXVUSR,RCXVVMS,CNT,QER,QFL,RCXMGRP,XMSUB
"RTN","RCXVFTP",45,0)
 K VALMSG,RCXVROOT
"RTN","RCXVFTP",46,0)
 Q
"RTN","RCXVFTP",47,0)
 ;
"RTN","RCXVFTP",48,0)
FCK ;  Check that file is ready to read
"RTN","RCXVFTP",49,0)
 S QFL=0,CNT=0,QER=0
"RTN","RCXVFTP",50,0)
FQT I QFL Q
"RTN","RCXVFTP",51,0)
 D OPEN^%ZISH(RCXVHNDL,RCXVPTH,RCXVSCR,"R")
"RTN","RCXVFTP",52,0)
 I POP D  G FQT
"RTN","RCXVFTP",53,0)
 . HANG 5
"RTN","RCXVFTP",54,0)
 . S CNT=CNT+1
"RTN","RCXVFTP",55,0)
 . I CNT>10 S QFL=1,QER=1 D CLOSE^%ZISH(RCXVHNDL)
"RTN","RCXVFTP",56,0)
 S QFL=1 D CLOSE^%ZISH(RCXVHNDL)
"RTN","RCXVFTP",57,0)
 G FQT
"RTN","RCXVFTP",58,0)
 ;
"RTN","RCXVFTR")
0^21^B4139175
"RTN","RCXVFTR",1,0)
RCXVFTR ;DAOU/ALA-Retrieve FTP messages ;17-DEC-2003
"RTN","RCXVFTR",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVFTR",3,0)
 ;
"RTN","RCXVFTR",4,0)
 ;**Program Description**
"RTN","RCXVFTR",5,0)
 ;  This program will read all the ftp messages to
"RTN","RCXVFTR",6,0)
 ;  see if they were successful or not
"RTN","RCXVFTR",7,0)
 ;
"RTN","RCXVFTR",8,0)
EN ;  Find all temporary files
"RTN","RCXVFTR",9,0)
 K ^TMP("RCXVIN",$J)
"RTN","RCXVFTR",10,0)
 S CNT=0,QFL=0
"RTN","RCXVFTR",11,0)
 S RCXVDIR=$P($G(^RC(342,1,20)),U,1)
"RTN","RCXVFTR",12,0)
 ;
"RTN","RCXVFTR",13,0)
 ;  Go through and read each one
"RTN","RCXVFTR",14,0)
 S RCVL=""
"RTN","RCXVFTR",15,0)
 F  S RCVL=$O(^TMP("RCXVMSG",$J,RCVL)) Q:RCVL=""  D
"RTN","RCXVFTR",16,0)
 . K ^TMP("RCXVIN",$J)
"RTN","RCXVFTR",17,0)
 . ;
"RTN","RCXVFTR",18,0)
 . S RCXVBTN=$P(RCVL,"_",3),RCXVBTN=$P(RCXVBTN,".",1)
"RTN","RCXVFTR",19,0)
 . S Y=$$FTG^%ZISH(RCXVDIR,RCVL,$NA(^TMP("RCXVIN",$J,1,0)),3)
"RTN","RCXVFTR",20,0)
 . ;
"RTN","RCXVFTR",21,0)
 . I $O(^TMP("RCXVIN",$J,0))="" S ^TMP("RCXVIN",$J,1,0)="No FTP command file found for batch #"_RCXVBTN
"RTN","RCXVFTR",22,0)
 . ;
"RTN","RCXVFTR",23,0)
 . S RCXOKAY=0,RCXI=0
"RTN","RCXVFTR",24,0)
 . F  S RCXI=$O(^TMP("RCXVIN",$J,RCXI)) Q:'RCXI  D
"RTN","RCXVFTR",25,0)
 .. I $E($G(^TMP("RCXVIN",$J,RCXI,0)),1,3)="226" S RCXOKAY=1
"RTN","RCXVFTR",26,0)
 . ;
"RTN","RCXVFTR",27,0)
 . ;  If the transfer does not say complete, send a mail message
"RTN","RCXVFTR",28,0)
 . I 'RCXOKAY D
"RTN","RCXVFTR",29,0)
 .. S RCXMGRP=$$GET1^DIQ(342,"1,",20.02,"E")
"RTN","RCXVFTR",30,0)
 .. I RCXMGRP="" S RCXMGRP="IRM"
"RTN","RCXVFTR",31,0)
 .. S RCXMGRP="G."_RCXMGRP
"RTN","RCXVFTR",32,0)
 .. S XMDUZ="CBO DATA EXTRACT",XMY(RCXMGRP)=""
"RTN","RCXVFTR",33,0)
 .. S XMSUB="CBO/ARC FTP ATTEMPT"
"RTN","RCXVFTR",34,0)
 .. S XMTEXT="^TMP(""RCXVIN"",$J,"
"RTN","RCXVFTR",35,0)
 .. D ^XMD
"RTN","RCXVFTR",36,0)
 .. K XMDUN,XMDUZ,XMZ,XMY
"RTN","RCXVFTR",37,0)
 . ;
"RTN","RCXVFTR",38,0)
 . I RCXOKAY D
"RTN","RCXVFTR",39,0)
 .. S RCXVUP(348.4,RCXVBTN_",",.08)=$$NOW^XLFDT()
"RTN","RCXVFTR",40,0)
 .. I $P(^RCXV(RCXVBTN,0),"^",3)'="C" S RCXVUP(348.4,RCXVBTN_",",.03)="T"
"RTN","RCXVFTR",41,0)
 .. D FILE^DIE("I","RCXVUP","RCXVERR")
"RTN","RCXVFTR",42,0)
 ;
"RTN","RCXVFTR",43,0)
 S Y=$$DEL^%ZISH(RCXVDIR,$NA(^TMP("RCXVMSG",$J)))
"RTN","RCXVFTR",44,0)
 ;
"RTN","RCXVFTR",45,0)
EXIT K C,CNT,RCXOKAY,RCXVUP,RCXVERR,RCXVLST,Y,RCXMGRP,RCXI,RCVL,QFL,RCXVARY,I
"RTN","RCXVFTR",46,0)
 Q
"RTN","RCXVFTR",47,0)
 ;
"RTN","RCXVFTV")
0^15^B7735519
"RTN","RCXVFTV",1,0)
RCXVFTV ;DAOU/ALA-FTP for VMS ;08-SEP-03
"RTN","RCXVFTV",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVFTV",3,0)
 ;
"RTN","RCXVFTV",4,0)
 ;
"RTN","RCXVFTV",5,0)
VMSO ;  Outgoing for VMS systems
"RTN","RCXVFTV",6,0)
 ;
"RTN","RCXVFTV",7,0)
 ;  Set up variables
"RTN","RCXVFTV",8,0)
 ;    RCXVFTP = Executable filename
"RTN","RCXVFTV",9,0)
 ;    RCXVPTH = Path name
"RTN","RCXVFTV",10,0)
 ;    RCXVNME = Outgoing filename
"RTN","RCXVFTV",11,0)
 ;    RCXVTXT = .TXT filename
"RTN","RCXVFTV",12,0)
 ;    RCXVBAT = .COM filename
"RTN","RCXVFTV",13,0)
 ;
"RTN","RCXVFTV",14,0)
 D VTXT
"RTN","RCXVFTV",15,0)
 ;
"RTN","RCXVFTV",16,0)
 S Y=$$GTF^%ZISH($NA(^TMP($J,"RCXVFTP",1,0)),3,RCXVPTH,RCXVBAT)
"RTN","RCXVFTV",17,0)
 K ^TMP($J,"RCXVFTP")
"RTN","RCXVFTV",18,0)
 I 'Y S VALMSG="Not able to create the .COM file" Q
"RTN","RCXVFTV",19,0)
 ;
"RTN","RCXVFTV",20,0)
VOBAT ;  Output and create the .COM file
"RTN","RCXVFTV",21,0)
 ;
"RTN","RCXVFTV",22,0)
 ;  Create the executable commands for the .TXT file
"RTN","RCXVFTV",23,0)
 S ^TMP($J,"RCXVFTP",1,0)="SET TYPE ASCII"
"RTN","RCXVFTV",24,0)
 S ^TMP($J,"RCXVFTP",2,0)="PUT "_RCXVNME
"RTN","RCXVFTV",25,0)
 S ^TMP($J,"RCXVFTP",3,0)="EXIT"
"RTN","RCXVFTV",26,0)
 ;
"RTN","RCXVFTV",27,0)
 ;  Output and create the .TXT file
"RTN","RCXVFTV",28,0)
 S Y=$$GTF^%ZISH($NA(^TMP($J,"RCXVFTP",1,0)),3,RCXVPTH,RCXVTXT)
"RTN","RCXVFTV",29,0)
 K ^TMP($J,"RCXVFTP")
"RTN","RCXVFTV",30,0)
 I 'Y S VALMSG="Not able to create the .TXT file" Q
"RTN","RCXVFTV",31,0)
 ;
"RTN","RCXVFTV",32,0)
 X RCXVOUT
"RTN","RCXVFTV",33,0)
 ;
"RTN","RCXVFTV",34,0)
 HANG 60
"RTN","RCXVFTV",35,0)
 ;
"RTN","RCXVFTV",36,0)
 Q
"RTN","RCXVFTV",37,0)
 ;
"RTN","RCXVFTV",38,0)
VTXT ;  Create the .TXT file
"RTN","RCXVFTV",39,0)
 S RCXVFTP="RCXVCBO"
"RTN","RCXVFTV",40,0)
 S RCXVSCR=RCXVSCR_".LIS",^TMP("RCXVMSG",$J,RCXVSCR_";1")=""
"RTN","RCXVFTV",41,0)
 S RCXVBAT=RCXVFTP_$S($G(RCXVSYS)="VMS":".COM",1:".BAT")
"RTN","RCXVFTV",42,0)
 S RCXVTXT=RCXVFTP_".TXT"
"RTN","RCXVFTV",43,0)
 ;
"RTN","RCXVFTV",44,0)
 I RCXVSYT="DSM" S RCXVOUT="S X=$ZC(%SUBMIT,RCXVPTH_$S($E(RCXVPTH,$L(RCXVPTH))[""]"":"""",1:"":"")_RCXVBAT)"
"RTN","RCXVFTV",45,0)
 I RCXVSYT="CACHE" S RCXVOUT="S X=$ZF(-1,""SUBMIT ""_RCXVPTH_$S($E(RCXVPTH,$L(RCXVPTH))[""]"":"""",1:"":"")_RCXVBAT)"
"RTN","RCXVFTV",46,0)
 ;
"RTN","RCXVFTV",47,0)
 I $G(RCXVVMS)="" S RCXVVMS="U"
"RTN","RCXVFTV",48,0)
 ;
"RTN","RCXVFTV",49,0)
 ;  Kill off the .COM and .TXT files
"RTN","RCXVFTV",50,0)
 S RCXVARRY(RCXVTXT)="",RCXVARRY(RCXVBAT)=""
"RTN","RCXVFTV",51,0)
 S Y=$$DEL^%ZISH(RCXVPTH,$NA(RCXVARRY))
"RTN","RCXVFTV",52,0)
 K RCXVARRY
"RTN","RCXVFTV",53,0)
 ;
"RTN","RCXVFTV",54,0)
 ;  This sets the .COM file name for VMS systems
"RTN","RCXVFTV",55,0)
 I RCXVSYS="VMS" D
"RTN","RCXVFTV",56,0)
 . S ^TMP($J,"RCXVFTP",1,0)="$SET NOON"
"RTN","RCXVFTV",57,0)
 . S ^TMP($J,"RCXVFTP",2,0)="$SET NOVERIFY"
"RTN","RCXVFTV",58,0)
 . S ^TMP($J,"RCXVFTP",3,0)="$SET DEFAULT "_RCXVPTH
"RTN","RCXVFTV",59,0)
 . S ^TMP($J,"RCXVFTP",4,0)="$DEL "_RCXVSCR_";*"
"RTN","RCXVFTV",60,0)
 . S ^TMP($J,"RCXVFTP",5,0)="$DEF SYS$OUTPUT "_RCXVSCR
"RTN","RCXVFTV",61,0)
 . I RCXVVMS="M" S ^TMP($J,"RCXVFTP",6,0)="FTP /TAKE_FILE="_RCXVTXT
"RTN","RCXVFTV",62,0)
 . I RCXVVMS="U" S ^TMP($J,"RCXVFTP",6,0)="FTP "_RCXVIP_" /USERNAME="""_RCXVUSR_""" /PASSWORD="""_RCXVPAS_""" /INPUT="_RCXVTXT
"RTN","RCXVFTV",63,0)
 . S ^TMP($J,"RCXVFTP",7,0)="$DEASSIGN SYS$OUTPUT"
"RTN","RCXVFTV",64,0)
 . S ^TMP($J,"RCXVFTP",8,0)="$SET FILE/PROTECTION=(S:RWED,O:RWED,G:RWED,W:RWED) "_RCXVSCR
"RTN","RCXVFTV",65,0)
 ;
"RTN","RCXVFTV",66,0)
 Q
"RTN","RCXVP201")
0^3^B42512490
"RTN","RCXVP201",1,0)
RCXVP201 ;DAOU/ALA-AR Data Extraction Post-Install Program ;23-JUL-03
"RTN","RCXVP201",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVP201",3,0)
 ;
"RTN","RCXVP201",4,0)
 ;** Program Description **
"RTN","RCXVP201",5,0)
 ;  This program will be run on installation of patch
"RTN","RCXVP201",6,0)
 ;  PRCA*4.5*201 for CBO to ARC Data Extractions
"RTN","RCXVP201",7,0)
 ;
"RTN","RCXVP201",8,0)
EN ; Entry Point
"RTN","RCXVP201",9,0)
 NEW RJ,RCLM,IEN,TXT,VAL
"RTN","RCXVP201",10,0)
 ;
"RTN","RCXVP201",11,0)
 M XPDQUES=^TMP("RCXVINSTALL")
"RTN","RCXVP201",12,0)
 ;
"RTN","RCXVP201",13,0)
 ;  Set up the maximum number of records in a batch
"RTN","RCXVP201",14,0)
 S RCXVUP(342,"1,",20.05)=5000
"RTN","RCXVP201",15,0)
 S RCXVUP(342,"1,",20.01)=$S($G(XPDQUES("PRE DIREC"))'="":$G(XPDQUES("PRE DIREC")),1:"PRT$:[SPOOL]")
"RTN","RCXVP201",16,0)
 S RCXVUP(342,"1,",20.02)=$S($G(XPDQUES("POS MAIL"))'="":$G(XPDQUES("POS MAIL")),1:"RCXVFTP")
"RTN","RCXVP201",17,0)
 S RCXVUP(342,"1,",20.06)=$S($P($$PARAM^HLCS2(),U,3)="P":"PRODUCTION",1:"TEST")
"RTN","RCXVP201",18,0)
 S RCXVUP(342,"1,",20.04)="ON"
"RTN","RCXVP201",19,0)
 ;
"RTN","RCXVP201",20,0)
 D FILE^DIE("E","RCXVUP","ERROR")
"RTN","RCXVP201",21,0)
 ;
"RTN","RCXVP201",22,0)
 ;  Add installer to mail group RCXVFTP
"RTN","RCXVP201",23,0)
 D ADDMBRS^XMXAPIG(DUZ,"RCXVFTP",DUZ)
"RTN","RCXVP201",24,0)
 ;
"RTN","RCXVP201",25,0)
AC ;  Set up the active records into the AR Queue File (#348.4)
"RTN","RCXVP201",26,0)
 S RCXVDSC="CBO ACTIVE BILLS"
"RTN","RCXVP201",27,0)
 S RCXVFL=$$TASK^RCXVUTIL(RCXVDSC)
"RTN","RCXVP201",28,0)
 I 'RCXVFL D
"RTN","RCXVP201",29,0)
 . S ZTDESC=RCXVDSC,ZTRTN="ACT^RCXVTSK",ZTIO=""
"RTN","RCXVP201",30,0)
 . S TIME=$S($G(XPDQUES("PRE HISTM"))'="":$P($G(XPDQUES("PRE HISTM")),".",2),1:"20")
"RTN","RCXVP201",31,0)
 . S ZTDTH=$$DT^XLFDT()_"."_TIME
"RTN","RCXVP201",32,0)
 . D ^%ZTLOAD
"RTN","RCXVP201",33,0)
 ;
"RTN","RCXVP201",34,0)
CUR ;  Set up records since the end of the Fiscal Year 2003
"RTN","RCXVP201",35,0)
 S RCXVDSC="CBO FISCAL YR 2004 (9/26/03-10/31/03)"
"RTN","RCXVP201",36,0)
 S RCXVFFD=3030926,RCXVFTD=3031031,RCXVCFLG=1
"RTN","RCXVP201",37,0)
 S RFDATE=$$SAT^RCXVUTIL(DT) D TSK
"RTN","RCXVP201",38,0)
 ;
"RTN","RCXVP201",39,0)
 S RCXVDSC="CBO FISCAL YR 2004 (11/1/03-11/30/03)"
"RTN","RCXVP201",40,0)
 S RCXVFFD=3031101,RCXVFTD=3031130,RCXVCFLG=1 D TSK
"RTN","RCXVP201",41,0)
 ;
"RTN","RCXVP201",42,0)
 S RCXVDSC="CBO FISCAL YR 2004 (12/1/03-12/31/03)"
"RTN","RCXVP201",43,0)
 S RCXVFFD=3031201,RCXVFTD=3031231,RCXVCFLG=1 D TSK
"RTN","RCXVP201",44,0)
 ;
"RTN","RCXVP201",45,0)
 S RCXVDSC="CBO FISCAL YR 2004 (1/1/04-1/31/04)"
"RTN","RCXVP201",46,0)
 S RCXVFFD=3040101,RCXVFTD=3040131,RCXVCFLG=1 D TSK
"RTN","RCXVP201",47,0)
 ;
"RTN","RCXVP201",48,0)
 S RCXVDSC="CBO FISCAL YR 2004 (2/1/04-2/29/04)"
"RTN","RCXVP201",49,0)
 S RCXVFFD=3040201,RCXVFTD=3040229,RCXVCFLG=1 D TSK
"RTN","RCXVP201",50,0)
 ;
"RTN","RCXVP201",51,0)
 S RCXVDSC="CBO FISCAL YR 2004 (3/1/04-3/31/04)"
"RTN","RCXVP201",52,0)
 S RCXVFFD=3040301,RCXVFTD=3040331,RCXVCFLG=1 D TSK
"RTN","RCXVP201",53,0)
 ;
"RTN","RCXVP201",54,0)
 S RCXVDSC="CBO FISCAL YR 2004 (4/1/04-4/30/04)"
"RTN","RCXVP201",55,0)
 S RCXVFFD=3040401,RCXVFTD=3040430,RCXVCFLG=1 D TSK
"RTN","RCXVP201",56,0)
 ;
"RTN","RCXVP201",57,0)
 I $E(DT,4,5)="05" D
"RTN","RCXVP201",58,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (5/1/04-5/31/04)"
"RTN","RCXVP201",59,0)
 . S RCXVFFD=3040501,RCXVFTD=3040531,RCXVCFLG=1 D TSK
"RTN","RCXVP201",60,0)
 ;
"RTN","RCXVP201",61,0)
 I $E(DT,4,5)="06" D
"RTN","RCXVP201",62,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (5/1/04-5/31/04)"
"RTN","RCXVP201",63,0)
 . S RCXVFFD=3040501,RCXVFTD=3040531,RCXVCFLG=1 D TSK
"RTN","RCXVP201",64,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (6/1/04-6/30/04)"
"RTN","RCXVP201",65,0)
 . S RCXVFFD=3040601,RCXVFTD=3040630,RCXVCFLG=1 D TSK
"RTN","RCXVP201",66,0)
 ;
"RTN","RCXVP201",67,0)
 I $E(DT,4,5)="07" D
"RTN","RCXVP201",68,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (5/1/04-5/31/04)"
"RTN","RCXVP201",69,0)
 . S RCXVFFD=3040501,RCXVFTD=3040531,RCXVCFLG=1 D TSK
"RTN","RCXVP201",70,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (6/1/04-6/30/04)"
"RTN","RCXVP201",71,0)
 . S RCXVFFD=3040601,RCXVFTD=3040630,RCXVCFLG=1 D TSK
"RTN","RCXVP201",72,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (7/1/04-7/31/04)"
"RTN","RCXVP201",73,0)
 . S RCXVFFD=3040701,RCXVFTD=3040731,RCXVCFLG=1 D TSK
"RTN","RCXVP201",74,0)
 ;
"RTN","RCXVP201",75,0)
 I $E(DT,4,5)="08" D
"RTN","RCXVP201",76,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (5/1/04-5/31/04)"
"RTN","RCXVP201",77,0)
 . S RCXVFFD=3040501,RCXVFTD=3040531,RCXVCFLG=1 D TSK
"RTN","RCXVP201",78,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (6/1/04-6/30/04)"
"RTN","RCXVP201",79,0)
 . S RCXVFFD=3040601,RCXVFTD=3040630,RCXVCFLG=1 D TSK
"RTN","RCXVP201",80,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (7/1/04-7/31/04)"
"RTN","RCXVP201",81,0)
 . S RCXVFFD=3040701,RCXVFTD=3040731,RCXVCFLG=1 D TSK
"RTN","RCXVP201",82,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (8/1/04-8/31/04)"
"RTN","RCXVP201",83,0)
 . S RCXVFFD=3040801,RCXVFTD=3040831,RCXVCFLG=1 D TSK
"RTN","RCXVP201",84,0)
 ;
"RTN","RCXVP201",85,0)
 I $E(DT,4,5)="09" D
"RTN","RCXVP201",86,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (5/1/04-5/31/04)"
"RTN","RCXVP201",87,0)
 . S RCXVFFD=3040501,RCXVFTD=3040531,RCXVCFLG=1 D TSK
"RTN","RCXVP201",88,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (6/1/04-6/30/04)"
"RTN","RCXVP201",89,0)
 . S RCXVFFD=3040601,RCXVFTD=3040630,RCXVCFLG=1 D TSK
"RTN","RCXVP201",90,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (7/1/04-7/31/04)"
"RTN","RCXVP201",91,0)
 . S RCXVFFD=3040701,RCXVFTD=3040731,RCXVCFLG=1 D TSK
"RTN","RCXVP201",92,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (8/1/04-8/31/04)"
"RTN","RCXVP201",93,0)
 . S RCXVFFD=3040801,RCXVFTD=3040831,RCXVCFLG=1 D TSK
"RTN","RCXVP201",94,0)
 . S RCXVDSC="CBO FISCAL YR 2004 (9/1/04-9/27/04)"
"RTN","RCXVP201",95,0)
 . S RCXVFFD=3040901,RCXVFTD=3040927,RCXVCFLG=1 D TSK
"RTN","RCXVP201",96,0)
 ;
"RTN","RCXVP201",97,0)
F03 ;  Historical for Fiscal Year 2003
"RTN","RCXVP201",98,0)
 S RCXVDSC="CBO HISTORICAL EXTRACT FY03"
"RTN","RCXVP201",99,0)
 S RCXVFL=$$TASK^RCXVUTIL(RCXVDSC)
"RTN","RCXVP201",100,0)
 I $G(RFDATE)="" S ZTDTH=$$SAT^RCXVUTIL(DT),RFDATE=$$FMADD^XLFDT(ZTDTH,7)
"RTN","RCXVP201",101,0)
 I 'RCXVFL D
"RTN","RCXVP201",102,0)
 . S RCXVFFD=3021001,RCXVFTD=3030925
"RTN","RCXVP201",103,0)
 . S ZTDESC=RCXVDSC,ZTRTN="HIS^RCXVTSK",ZTIO=""
"RTN","RCXVP201",104,0)
 . S ZTSAVE("RCXVFFD")="",ZTSAVE("RCXVFTD")=""
"RTN","RCXVP201",105,0)
 . S ZTDTH=RFDATE_".06",RFDATE=$$FMADD^XLFDT(RFDATE,7)
"RTN","RCXVP201",106,0)
 . D ^%ZTLOAD
"RTN","RCXVP201",107,0)
 ;
"RTN","RCXVP201",108,0)
F02 ;  Historical for Fiscal Year 2002
"RTN","RCXVP201",109,0)
 S RCXVDSC="CBO HISTORICAL EXTRACT FY02"
"RTN","RCXVP201",110,0)
 S RCXVFL=$$TASK^RCXVUTIL(RCXVDSC)
"RTN","RCXVP201",111,0)
 I $G(RFDATE)="" S ZTDTH=$$SAT^RCXVUTIL(DT),RFDATE=$$FMADD^XLFDT(ZTDTH,7)
"RTN","RCXVP201",112,0)
 I 'RCXVFL D
"RTN","RCXVP201",113,0)
 . S RCXVFFD=3011001,RCXVFTD=3020930
"RTN","RCXVP201",114,0)
 . S ZTDESC=RCXVDSC,ZTRTN="HIS^RCXVTSK",ZTIO=""
"RTN","RCXVP201",115,0)
 . S ZTSAVE("RCXVFFD")="",ZTSAVE("RCXVFTD")=""
"RTN","RCXVP201",116,0)
 . S ZTDTH=RFDATE_".06",RFDATE=$$FMADD^XLFDT(RFDATE,7)
"RTN","RCXVP201",117,0)
 . D ^%ZTLOAD
"RTN","RCXVP201",118,0)
 ;
"RTN","RCXVP201",119,0)
F01 ;  Historical for Fiscal Year 2001
"RTN","RCXVP201",120,0)
 S RCXVDSC="CBO HISTORICAL EXTRACT FY01"
"RTN","RCXVP201",121,0)
 S RCXVFL=$$TASK^RCXVUTIL(RCXVDSC)
"RTN","RCXVP201",122,0)
 I $G(RFDATE)="" S ZTDTH=$$SAT^RCXVUTIL(DT),RFDATE=$$FMADD^XLFDT(ZTDTH,7)
"RTN","RCXVP201",123,0)
 I 'RCXVFL D
"RTN","RCXVP201",124,0)
 . S RCXVFFD=3001001,RCXVFTD=3010930
"RTN","RCXVP201",125,0)
 . S ZTDESC=RCXVDSC,ZTRTN="HIS^RCXVTSK",ZTIO=""
"RTN","RCXVP201",126,0)
 . S ZTSAVE("RCXVFFD")="",ZTSAVE("RCXVFTD")=""
"RTN","RCXVP201",127,0)
 . S ZTDTH=RFDATE_".06"
"RTN","RCXVP201",128,0)
 . D ^%ZTLOAD
"RTN","RCXVP201",129,0)
 ;
"RTN","RCXVP201",130,0)
FLG ;  Update with CBO EXTRACT FLAG
"RTN","RCXVP201",131,0)
 F RJ=1:1 S RCLM=$T(TTS+RJ) Q:RCLM=" ;;Q"  D
"RTN","RCXVP201",132,0)
 . S IEN=$P(RCLM,";",3),TXT=$P(RCLM,";",4),VAL=$P(RCLM,";",5)
"RTN","RCXVP201",133,0)
 . I $P(^PRCA(430.3,IEN,0),U,1)=TXT S RCXVUP(430.3,IEN_",",5)=VAL
"RTN","RCXVP201",134,0)
 D FILE^DIE("I","RCXVUP","RCERR")
"RTN","RCXVP201",135,0)
 ;
"RTN","RCXVP201",136,0)
EXIT K RCXVDSC,RTASKS,ZTDESC,ZTRTN,ZTDTH,XPDQUES,RCXVFFD,RCXVFTD
"RTN","RCXVP201",137,0)
 K RCXFY03,RCXVFL,RFDATE,TIME
"RTN","RCXVP201",138,0)
 K ^TMP("RCXVINSTALL")
"RTN","RCXVP201",139,0)
 Q
"RTN","RCXVP201",140,0)
 ;
"RTN","RCXVP201",141,0)
TSK ;  Set up Task for current fiscal year 2004
"RTN","RCXVP201",142,0)
 S ZTDESC=RCXVDSC,ZTRTN="CUR^RCXVTSK",ZTIO=""
"RTN","RCXVP201",143,0)
 S ZTSAVE("RCXVFFD")="",ZTSAVE("RCXVFTD")="",ZTSAVE("RCXVCFLG")=""
"RTN","RCXVP201",144,0)
 S ZTDTH=RFDATE_".06"
"RTN","RCXVP201",145,0)
 D ^%ZTLOAD
"RTN","RCXVP201",146,0)
 S RFDATE=$$FMADD^XLFDT(RFDATE,7)
"RTN","RCXVP201",147,0)
 Q
"RTN","RCXVP201",148,0)
 ;
"RTN","RCXVP201",149,0)
TTS ;  AR TRANSACTION TYPE File (#430.3) Update
"RTN","RCXVP201",150,0)
 ;;1;INCREASE ADJUSTMENT;1
"RTN","RCXVP201",151,0)
 ;;2;PAYMENT (IN PART);1
"RTN","RCXVP201",152,0)
 ;;3;REFER TO RC;1
"RTN","RCXVP201",153,0)
 ;;4;REFER TO DOJ;1
"RTN","RCXVP201",154,0)
 ;;5;REESTABLISH TO RC/DOJ;1
"RTN","RCXVP201",155,0)
 ;;6;RETURNED BY RC/DOJ;1
"RTN","RCXVP201",156,0)
 ;;7;CASH COLLECTION BY RC/DOJ;1
"RTN","RCXVP201",157,0)
 ;;8;TERM.BY FIS.OFFICER;1
"RTN","RCXVP201",158,0)
 ;;9;TERM.BY COMPROMISE;1
"RTN","RCXVP201",159,0)
 ;;10;WAIVED IN FULL;1
"RTN","RCXVP201",160,0)
 ;;11;WAIVED IN PART;1
"RTN","RCXVP201",161,0)
 ;;12;ADMIN.COST CHARGE;1
"RTN","RCXVP201",162,0)
 ;;13;INTEREST/ADM. CHARGE;1
"RTN","RCXVP201",163,0)
 ;;14;EXEMPT INT/ADM. COST;1
"RTN","RCXVP201",164,0)
 ;;15;INCOMPLETE;0
"RTN","RCXVP201",165,0)
 ;;16;ACTIVE;1
"RTN","RCXVP201",166,0)
 ;;17;IN-ACTIVE;
"RTN","RCXVP201",167,0)
 ;;18;NEW BILL;0
"RTN","RCXVP201",168,0)
 ;;19;SUSPENSE;1
"RTN","RCXVP201",169,0)
 ;;20;PENDING APPROVAL;0
"RTN","RCXVP201",170,0)
 ;;21;PENDING CALM CODE;0
"RTN","RCXVP201",171,0)
 ;;22;COLLECTED/CLOSED;1
"RTN","RCXVP201",172,0)
 ;;23;WRITE-OFF;1
"RTN","RCXVP201",173,0)
 ;;24;MARSHAL/COURT COST;1
"RTN","RCXVP201",174,0)
 ;;25;REPAYMENT PLAN;0
"RTN","RCXVP201",175,0)
 ;;26;CANCELLED BILL;1
"RTN","RCXVP201",176,0)
 ;;27;BILL INCOMPLETE;0
"RTN","RCXVP201",177,0)
 ;;28;OLD BILL;0
"RTN","RCXVP201",178,0)
 ;;29;TERM.BY RC/DOJ;1
"RTN","RCXVP201",179,0)
 ;;30;DEBIT VOUCHER (SF 5515);0
"RTN","RCXVP201",180,0)
 ;;31;RETURNED FROM AR (NEW);0
"RTN","RCXVP201",181,0)
 ;;32;RETURNED FOR AMENDMENT;0
"RTN","RCXVP201",182,0)
 ;;33;AMENDED BILL;0
"RTN","RCXVP201",183,0)
 ;;34;PAYMENT (IN FULL);1
"RTN","RCXVP201",184,0)
 ;;35;DECREASE ADJUSTMENT;1
"RTN","RCXVP201",185,0)
 ;;36;DELETE (AMEND);0
"RTN","RCXVP201",186,0)
 ;;37;ADD (AMEND);0
"RTN","RCXVP201",187,0)
 ;;38;AMEND;0
"RTN","RCXVP201",188,0)
 ;;39;CANCELLATION;1
"RTN","RCXVP201",189,0)
 ;;40;SUSPENDED;1
"RTN","RCXVP201",190,0)
 ;;41;REFUNDED;1
"RTN","RCXVP201",191,0)
 ;;42;OPEN;0
"RTN","RCXVP201",192,0)
 ;;43;RE-ESTABLISH;1
"RTN","RCXVP201",193,0)
 ;;44;REFUND REVIEW;1
"RTN","RCXVP201",194,0)
 ;;45;COMMENT;0
"RTN","RCXVP201",195,0)
 ;;46;UNSUSPENDED;1
"RTN","RCXVP201",196,0)
 ;;47;CHARGE SUSPENDED;1
"RTN","RCXVP201",197,0)
 ;;48;PENDING ARCHIVE;0
"RTN","RCXVP201",198,0)
 ;;49;ARCHIVED;0
"RTN","RCXVP201",199,0)
 ;;Q
"RTN","RCXVPARM")
0^16^B6256393
"RTN","RCXVPARM",1,0)
RCXVPARM ;DAOU-AR Paramater File Editor;02-JUL-03
"RTN","RCXVPARM",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVPARM",3,0)
 ;
"RTN","RCXVPARM",4,0)
 ;
"RTN","RCXVPARM",5,0)
 Q  ; Quit routine if not called at Entry Point EN
"RTN","RCXVPARM",6,0)
EN ; Entry Point
"RTN","RCXVPARM",7,0)
 NEW DIC,DIE,DR,DA,VDIR,VNAME,IEN,VUPDT,VDATA,SWITCH
"RTN","RCXVPARM",8,0)
 NEW RCXVFFD,RCXVFTD,RCXVVSD,RCXVMG,RCXVBMX,RCXVSYS,RCXVOFF
"RTN","RCXVPARM",9,0)
 NEW IN,D,DI,D0,DQ,UIN,X,Y,DIR,FILE,REC,DDH,RCXVUP,ERROR
"RTN","RCXVPARM",10,0)
 NEW DISYS,DZ,VBQ,KEEPLOG,RCXVBNM,RCXVLDM
"RTN","RCXVPARM",11,0)
 ;
"RTN","RCXVPARM",12,0)
 S RCXVUP(342,"1,",20.06)=$S($P($$PARAM^HLCS2(),U,3)="P":"PRODUCTION",1:"TEST")
"RTN","RCXVPARM",13,0)
 D FILE^DIE("E","RCXVUP","ERROR")
"RTN","RCXVPARM",14,0)
 ;
"RTN","RCXVPARM",15,0)
 S UIN=1
"RTN","RCXVPARM",16,0)
 W @IOF
"RTN","RCXVPARM",17,0)
 F  D  Q:'UIN                 ; Loop until user declines edit response
"RTN","RCXVPARM",18,0)
 . D DISP W !                 ; Display current parameter settings
"RTN","RCXVPARM",19,0)
 . S UIN=$$PROMPT()           ; Prompt for user edit response
"RTN","RCXVPARM",20,0)
 . I UIN W ! D SET W @IOF     ; If requested allow user to edit
"RTN","RCXVPARM",21,0)
 . Q
"RTN","RCXVPARM",22,0)
ENX ; EN exit point
"RTN","RCXVPARM",23,0)
 Q
"RTN","RCXVPARM",24,0)
 ;
"RTN","RCXVPARM",25,0)
 ;
"RTN","RCXVPARM",26,0)
DISP ; Display Current Settings
"RTN","RCXVPARM",27,0)
 W !!?2,"CURRENT CBO AR Data Extract Site Parameter Settings"
"RTN","RCXVPARM",28,0)
 ; Get all all CBO AR Parameter data
"RTN","RCXVPARM",29,0)
 S FILE=342,REC="1,"
"RTN","RCXVPARM",30,0)
 S RCXVVSD=$$GET1^DIQ(FILE,REC,20.01)      ; Vitria Stndrd Dir.
"RTN","RCXVPARM",31,0)
 S RCXVMG=$$GET1^DIQ(FILE,REC,20.02)       ; Mail Group
"RTN","RCXVPARM",32,0)
 S RCXVBNM=$$GET1^DIQ(FILE,REC,20.05)      ; Max. # of Rec.
"RTN","RCXVPARM",33,0)
 S RCXVSYS=$$GET1^DIQ(FILE,REC,20.06,"I")
"RTN","RCXVPARM",34,0)
 S RCXVOFF=$$GET1^DIQ(FILE,REC,20.04)
"RTN","RCXVPARM",35,0)
 S RCXVLEG=$$GET1^DIQ(FILE,REC,20.07,"E")
"RTN","RCXVPARM",36,0)
 S RCXVLDM=$$GET1^DIQ(FILE,REC,20.08,"E")
"RTN","RCXVPARM",37,0)
 ; Display AR Data Extract Parameter fields
"RTN","RCXVPARM",38,0)
 W !!?6,"FILE DIRECTORY              : ",RCXVVSD
"RTN","RCXVPARM",39,0)
 W !?6,"MAIL GROUP                  : ",RCXVMG
"RTN","RCXVPARM",40,0)
 W !?6,"MAXIMUM NUMBER RECORDS      : ",RCXVBNM
"RTN","RCXVPARM",41,0)
 W !,?6,"LEGACY SITE?                : ",RCXVLEG
"RTN","RCXVPARM",42,0)
 I RCXVLEG="YES" W !,?6,"PRIMARY DOMAIN NAME         : ",RCXVLDM
"RTN","RCXVPARM",43,0)
 I RCXVSYS="P" Q
"RTN","RCXVPARM",44,0)
 W !,?6,"TEST SYSTEM STATUS          : ",RCXVOFF
"RTN","RCXVPARM",45,0)
 Q
"RTN","RCXVPARM",46,0)
 ;
"RTN","RCXVPARM",47,0)
 ;
"RTN","RCXVPARM",48,0)
PROMPT() ; Prompt user to allow user to edit fields
"RTN","RCXVPARM",49,0)
 ; Return user input    0 : "NO" - Do not edit settings
"RTN","RCXVPARM",50,0)
 ;                      1 : "YES" - Edit settings
"RTN","RCXVPARM",51,0)
 S DIR(0)="Y",DIR("A")="  Do you wish to edit these settings"
"RTN","RCXVPARM",52,0)
 S DIR("B")="NO"
"RTN","RCXVPARM",53,0)
 D ^DIR
"RTN","RCXVPARM",54,0)
 Q Y
"RTN","RCXVPARM",55,0)
 ;
"RTN","RCXVPARM",56,0)
 ;
"RTN","RCXVPARM",57,0)
SET ; SET
"RTN","RCXVPARM",58,0)
 ; Set variables for ^DIE call
"RTN","RCXVPARM",59,0)
 S DIE="^RC(342,",DA=1
"RTN","RCXVPARM",60,0)
 S DR="20.01;20.02;20.05"
"RTN","RCXVPARM",61,0)
 I RCXVSYS'="P" S DR=DR_";20.04T~"
"RTN","RCXVPARM",62,0)
 ;
"RTN","RCXVPARM",63,0)
 S DR=DR_";20.07"
"RTN","RCXVPARM",64,0)
 ; Prompt user to enter/edit values in DR and file data
"RTN","RCXVPARM",65,0)
 D ^DIE
"RTN","RCXVPARM",66,0)
 S RCXVLEG=$$GET1^DIQ(FILE,REC,20.07,"E")
"RTN","RCXVPARM",67,0)
 I RCXVLEG="YES" S DR="20.08"
"RTN","RCXVPARM",68,0)
 E  Q
"RTN","RCXVPARM",69,0)
 D ^DIE
"RTN","RCXVPARM",70,0)
 Q
"RTN","RCXVPARM",71,0)
 ;
"RTN","RCXVRMV")
0^18^B1122235
"RTN","RCXVRMV",1,0)
RCXVRMV ;DAOU/ALA-AR Data Extract Remove ;23-OCT-2003
"RTN","RCXVRMV",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVRMV",3,0)
 ;
"RTN","RCXVRMV",4,0)
 ;**Program Description**
"RTN","RCXVRMV",5,0)
 ;
"RTN","RCXVRMV",6,0)
 ;WARNING - This program should only be run by direction
"RTN","RCXVRMV",7,0)
 ;of the NVS team.  It is meant to cleanup possible bill
"RTN","RCXVRMV",8,0)
 ;transmissions to the ARC which were generated by a re-index
"RTN","RCXVRMV",9,0)
 ;of one of the following files; 399, 430, or 433.  A
"RTN","RCXVRMV",10,0)
 ;re-index has serious consequences for a site's billing
"RTN","RCXVRMV",11,0)
 ;process and should only be done after serious consideration
"RTN","RCXVRMV",12,0)
 ;and direction from the IB or AR programmers.
"RTN","RCXVRMV",13,0)
 ;
"RTN","RCXVRMV",14,0)
EN ;  Entry point
"RTN","RCXVRMV",15,0)
 S %DT="AEX",%DT("A")="Enter DATE re-index started: "
"RTN","RCXVRMV",16,0)
 D ^%DT
"RTN","RCXVRMV",17,0)
 I Y<1 G EXIT
"RTN","RCXVRMV",18,0)
 S RCXVSDT=Y
"RTN","RCXVRMV",19,0)
 ;
"RTN","RCXVRMV",20,0)
 S %DT("A")="Enter DATE re-index ended: "
"RTN","RCXVRMV",21,0)
 D ^%DT
"RTN","RCXVRMV",22,0)
 I Y<1 G EXIT
"RTN","RCXVRMV",23,0)
 S RCXVEDT=Y
"RTN","RCXVRMV",24,0)
 ;
"RTN","RCXVRMV",25,0)
 S DIK="^RCXV("
"RTN","RCXVRMV",26,0)
 S RCXVDT=RCXVSDT-.1
"RTN","RCXVRMV",27,0)
 F  S RCXVDT=$O(^RCXV("C",RCXVDT)) Q:RCXVDT=""!(RCXVDT>RCXVEDT)  D
"RTN","RCXVRMV",28,0)
 . S DA=0
"RTN","RCXVRMV",29,0)
 . F  S DA=$O(^RCXV("C",RCXVDT,DA)) Q:DA=""  D ^DIK W "."
"RTN","RCXVRMV",30,0)
 ;
"RTN","RCXVRMV",31,0)
EXIT K %DT,Y,RCXVSDT,RCXVEDT,X,DA,RCXVDT,DIK
"RTN","RCXVRMV",32,0)
 Q
"RTN","RCXVS201")
0^^B94419
"RTN","RCXVS201",1,0)
RCXVS201 ;DAOU/ALA-AR Data Extraction Pre-Install Program ;23-JUL-03
"RTN","RCXVS201",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVS201",3,0)
 ;
"RTN","RCXVS201",4,0)
 ;** Program Description **
"RTN","RCXVS201",5,0)
 ;  This program will be run on installation of patch
"RTN","RCXVS201",6,0)
 ;  PRCA*4.5*201 for CBO to ARC Data Extractions
"RTN","RCXVS201",7,0)
 ;
"RTN","RCXVS201",8,0)
EN ; Entry Point
"RTN","RCXVS201",9,0)
 ;
"RTN","RCXVS201",10,0)
 K ^TMP("RCXVINSTALL")
"RTN","RCXVS201",11,0)
 M ^TMP("RCXVINSTALL")=XPDQUES
"RTN","RCXVS201",12,0)
 ;
"RTN","RCXVS201",13,0)
 Q
"RTN","RCXVSRV")
0^17^B10097008
"RTN","RCXVSRV",1,0)
RCXVSRV ;DAOU/ALA-AR Data Extract Server Program
"RTN","RCXVSRV",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVSRV",3,0)
 ;
"RTN","RCXVSRV",4,0)
 ;**Program Description**
"RTN","RCXVSRV",5,0)
 ;  This program will parse an incoming message
"RTN","RCXVSRV",6,0)
 ;  either as an acknowledgement or as a request
"RTN","RCXVSRV",7,0)
 ;  for a historical extract
"RTN","RCXVSRV",8,0)
 ;
"RTN","RCXVSRV",9,0)
EN ;  Entry point
"RTN","RCXVSRV",10,0)
 K ^TMP("ARCXV")
"RTN","RCXVSRV",11,0)
 S RCXMZ=XMZ,VJOB=$J K ^TMP("RCXVSRV",VJOB)
"RTN","RCXVSRV",12,0)
 S CT=0 F  D  Q:XMER'=0
"RTN","RCXVSRV",13,0)
 . X XMREC Q:XMER'=0
"RTN","RCXVSRV",14,0)
 . S CT=XMPOS
"RTN","RCXVSRV",15,0)
 . S ^TMP("RCXVSRV",VJOB,CT)=$G(XMRG)
"RTN","RCXVSRV",16,0)
 ;
"RTN","RCXVSRV",17,0)
REC ;  Process a record
"RTN","RCXVSRV",18,0)
 S N="",LFN=1
"RTN","RCXVSRV",19,0)
 F  S N=$O(^TMP("RCXVSRV",VJOB,N)) Q:N=""  D
"RTN","RCXVSRV",20,0)
 . I $G(^TMP("RCXVSRV",VJOB,N))["ACK|"!($G(^TMP("RCXVSRV",VJOB,N))["HIS|") S LFN=N
"RTN","RCXVSRV",21,0)
 ;
"RTN","RCXVSRV",22,0)
 S XMRG=$G(^TMP("RCXVSRV",VJOB,LFN)) I XMRG="" Q
"RTN","RCXVSRV",23,0)
 S ^TMP("ARCXV","XMRG")=$G(XMRG)
"RTN","RCXVSRV",24,0)
 ;  If the type of message is not an ACK (acknowledgement)
"RTN","RCXVSRV",25,0)
 ;  or a HIS (historical extract request), quit
"RTN","RCXVSRV",26,0)
 S RCXVTYP=$P(XMRG,"|")
"RTN","RCXVSRV",27,0)
 I RCXVTYP'["ACK"&(RCXVTYP'["HIS") Q
"RTN","RCXVSRV",28,0)
 ;
"RTN","RCXVSRV",29,0)
ACK I RCXVTYP["ACK" D
"RTN","RCXVSRV",30,0)
 . S RCXVNAME=$P(XMRG,"|",2),RCVALUE=$P(XMRG,"|",3),RCFRWD=$P(XMRG,"|",4)
"RTN","RCXVSRV",31,0)
 . S RCXVNAME=$$UP^XLFSTR(RCXVNAME),RCVALUE=$$UP^XLFSTR(RCVALUE)
"RTN","RCXVSRV",32,0)
 . I RCVALUE'["AA" Q
"RTN","RCXVSRV",33,0)
 . S RCXVNAME=$P(RCXVNAME,".TXT",1)
"RTN","RCXVSRV",34,0)
 . I $E(RCXVNAME,1,4)'="RCXV" S RCXVNAME="RCXV"_$P(RCXVNAME,"RCXV",2)
"RTN","RCXVSRV",35,0)
 . S RCXVBTN=$E(RCXVNAME,15,$L(RCXVNAME))
"RTN","RCXVSRV",36,0)
 . ;
"RTN","RCXVSRV",37,0)
 . S ^TMP("ARCXV","BATCH")=$G(RCXVBTN)
"RTN","RCXVSRV",38,0)
 . S ^TMP("ARCXV","FILE")=$G(RCXVNAME)
"RTN","RCXVSRV",39,0)
 . S ^TMP("ARCXV","XMZ")=$G(RCXMZ)
"RTN","RCXVSRV",40,0)
 . S ^TMP("ARCXV","FDOM")=$G(RCFRWD)
"RTN","RCXVSRV",41,0)
 . ;
"RTN","RCXVSRV",42,0)
 . S RCXVLEG=$$GET1^DIQ(342,"1,",20.07,"I")
"RTN","RCXVSRV",43,0)
 . I '+RCXVLEG,$G(RCFRWD)'="" D FWD Q
"RTN","RCXVSRV",44,0)
 . ;  Find the IEN of the batch number
"RTN","RCXVSRV",45,0)
 . K ^TMP("RCXVA",VJOB)
"RTN","RCXVSRV",46,0)
 . D FIND^DIC(348.4,"","","OP",RCXVBTN,"","B","","","^TMP(""RCXVA"",VJOB)")
"RTN","RCXVSRV",47,0)
 . S RCXVDA=$P($G(^TMP("RCXVA",VJOB,"DILIST",0)),U,1)
"RTN","RCXVSRV",48,0)
 . S ^TMP("ARCXV","DA")=$G(RCXVDA)
"RTN","RCXVSRV",49,0)
 . I +RCXVDA=0 Q
"RTN","RCXVSRV",50,0)
 . S DA=$P($G(^TMP("RCXVA",VJOB,"DILIST",RCXVDA,0)),U,1)
"RTN","RCXVSRV",51,0)
 . I +DA=0 Q
"RTN","RCXVSRV",52,0)
 . S RCXVUP(348.4,DA_",",.09)=$$NOW^XLFDT(),RCXVUP(348.4,DA_",",.03)="C"
"RTN","RCXVSRV",53,0)
 . D FILE^DIE("I","RCXVUP","RCXVERR")
"RTN","RCXVSRV",54,0)
 ;
"RTN","RCXVSRV",55,0)
 I RCXVTYP["HIS" D
"RTN","RCXVSRV",56,0)
 . S RCXVFFD=$P(XMRG,"|",2),RCXVFTD=$P(XMRG,"|",3)
"RTN","RCXVSRV",57,0)
 . S RCXVFFD=$$DATE^RCXVUTIL(RCXVFFD)
"RTN","RCXVSRV",58,0)
 . S RCXVFTD=$$DATE^RCXVUTIL(RCXVFTD)
"RTN","RCXVSRV",59,0)
 . ;
"RTN","RCXVSRV",60,0)
 . ;  Get the next Saturday date
"RTN","RCXVSRV",61,0)
 . S CURDT=$$DT^XLFDT()
"RTN","RCXVSRV",62,0)
 . S CDOW=$$DOW^XLFDT(CURDT,1),NDAYS=6-CDOW
"RTN","RCXVSRV",63,0)
 . S FDATE=$$FMADD^XLFDT(CURDT,NDAYS)
"RTN","RCXVSRV",64,0)
 . ;
"RTN","RCXVSRV",65,0)
 . ;  Set up TaskMan
"RTN","RCXVSRV",66,0)
 . S RCVXDSC="CBO HISTORICAL EXTRACT"
"RTN","RCXVSRV",67,0)
 . S ZTDESC=RCVXDSC,ZTRTN="HIS^RCXVTSK",ZTIO=""
"RTN","RCXVSRV",68,0)
 . S ZTSAVE("RCXVFTD")="",ZTSAVE("RCXVFFD")=""
"RTN","RCXVSRV",69,0)
 . S ZTDTH=FDATE_".06"
"RTN","RCXVSRV",70,0)
 . D ^%ZTLOAD
"RTN","RCXVSRV",71,0)
 ;
"RTN","RCXVSRV",72,0)
EXIT K RCXVDA,DA,RCXVUP,RCXVFFD,RCXVFTD,CURDT,CDOW,NDAYS,FDATE,ZTSK
"RTN","RCXVSRV",73,0)
 K ZTDESC,RCXVDSC,ZTSAVE,ZTDTH,ZTIO,ZTRTN,RCXVTYP,RCXVNAME,RCVALUE
"RTN","RCXVSRV",74,0)
 K CT,LFN,N,XMER,XMPOS,XMREC,XMRG,XMZ,RCFRWD,RCVXDSC,RCXMZ,RCXVBTN
"RTN","RCXVSRV",75,0)
 K ^TMP("RCXVA",VJOB),^TMP("RCXVSRV",VJOB),VJOB,XMY,RCXVLEG
"RTN","RCXVSRV",76,0)
 Q
"RTN","RCXVSRV",77,0)
 ;
"RTN","RCXVSRV",78,0)
FWD ;  Forward the mail message
"RTN","RCXVSRV",79,0)
 I $G(DUZ)="" S DUZ=.5
"RTN","RCXVSRV",80,0)
 I $G(XMZ)="" S XMZ=RCXMZ
"RTN","RCXVSRV",81,0)
 S XMY(RCFRWD)=""
"RTN","RCXVSRV",82,0)
 D ENT2^XMD
"RTN","RCXVSRV",83,0)
 Q
"RTN","RCXVTSK")
0^2^B35416913
"RTN","RCXVTSK",1,0)
RCXVTSK ;DAOU/ALA-AR Data Extract Nightly Task ;23-JUL-03
"RTN","RCXVTSK",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVTSK",3,0)
 ;
"RTN","RCXVTSK",4,0)
 ;** Program Description **
"RTN","RCXVTSK",5,0)
 ;  This program is the nightly task program for the
"RTN","RCXVTSK",6,0)
 ;  CBO Data Extract to the Boston Allocation Resource
"RTN","RCXVTSK",7,0)
 ;  Center
"RTN","RCXVTSK",8,0)
 ;
"RTN","RCXVTSK",9,0)
EN ;  Entry point
"RTN","RCXVTSK",10,0)
 ;
"RTN","RCXVTSK",11,0)
 ;  If a test system has 'turned off' extract, quit
"RTN","RCXVTSK",12,0)
 I '$$GET1^DIQ(342,"1,",20.04,"I") Q
"RTN","RCXVTSK",13,0)
 ;
"RTN","RCXVTSK",14,0)
 N $ES,$ET
"RTN","RCXVTSK",15,0)
 S $ET="D ER^RCXVTSK"
"RTN","RCXVTSK",16,0)
 ;
"RTN","RCXVTSK",17,0)
 L +^RCXVTSK:60 E  Q
"RTN","RCXVTSK",18,0)
 ;
"RTN","RCXVTSK",19,0)
 ;  Purge completed batches
"RTN","RCXVTSK",20,0)
 S IEN="",DIK="^RCXV("
"RTN","RCXVTSK",21,0)
 F  S IEN=$O(^RCXV("AC","C",IEN)) Q:IEN=""  D
"RTN","RCXVTSK",22,0)
 . S DA=IEN D ^DIK
"RTN","RCXVTSK",23,0)
 ;
"RTN","RCXVTSK",24,0)
 K ^TMP("RCXVMSG",$J)
"RTN","RCXVTSK",25,0)
 ;
"RTN","RCXVTSK",26,0)
 ;  Find all deposits/receipts
"RTN","RCXVTSK",27,0)
 S RCXVD0="",RCXVRNUM=0,RCXVDT=$$FMADD^XLFDT(DT,-1)
"RTN","RCXVTSK",28,0)
 F  S RCXVD0=$O(^RCY(344,"ASTAT",0,RCXVD0)) Q:RCXVD0=""  D
"RTN","RCXVTSK",29,0)
 . S RCXVEDT=$P($G(^RCY(344,RCXVD0,0)),U,12)\1
"RTN","RCXVTSK",30,0)
 . I RCXVEDT'=RCXVDT Q
"RTN","RCXVTSK",31,0)
 . S RCXVRNUM=RCXVRNUM+1
"RTN","RCXVTSK",32,0)
 . D FIL^RCXVDEQ("R")
"RTN","RCXVTSK",33,0)
 . D UDR^RCXVDEQ
"RTN","RCXVTSK",34,0)
 ;
"RTN","RCXVTSK",35,0)
 K RCXVD0,RCXVRNUM,RCXVDT,RCXVEDT,RCXVDA,RCVXCTY,RCXVBDT
"RTN","RCXVTSK",36,0)
 ;
"RTN","RCXVTSK",37,0)
 S RCXVBTN="",RCXVU="^",RCXVXDT=DT
"RTN","RCXVTSK",38,0)
 ;
"RTN","RCXVTSK",39,0)
 ;  If the CCPC calculation is scheduled to run, don't
"RTN","RCXVTSK",40,0)
 ;  run the nightly task
"RTN","RCXVTSK",41,0)
 S X1=$$STD^RCCPCFN,X2=-3 D C^%DTC I X=DT L -^RCXVTSK Q
"RTN","RCXVTSK",42,0)
 K X1,X2
"RTN","RCXVTSK",43,0)
 ;
"RTN","RCXVTSK",44,0)
NM ;  Find all new batches to be transmitted
"RTN","RCXVTSK",45,0)
 S RBSQ=0,RBTOT=0
"RTN","RCXVTSK",46,0)
 F  S RCXVBTN=$O(^RCXV("AC","P",RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",47,0)
 . I $G(^RCXV(RCXVBTN,0))="" Q
"RTN","RCXVTSK",48,0)
 . S RBSQ=RBSQ+1,RBTOT=RBTOT+1
"RTN","RCXVTSK",49,0)
 . I $P(^RCXV(RCXVBTN,0),U,1)'=RCXVBTN S RCXVUP(348.4,RCXVBTN_",",.01)=RCXVBTN
"RTN","RCXVTSK",50,0)
 . S RCXVUP(348.4,RCXVBTN_",",.05)=RBSQ
"RTN","RCXVTSK",51,0)
 F  S RCXVBTN=$O(RCXVUP(348.4,RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",52,0)
 . S RCXVUP(348.4,RCXVBTN,.06)=RBTOT
"RTN","RCXVTSK",53,0)
 D FILE^DIE("","RCXVUP","RCXVERR")
"RTN","RCXVTSK",54,0)
 K RCXVUP
"RTN","RCXVTSK",55,0)
 ;
"RTN","RCXVTSK",56,0)
 S RCXVBTN=""
"RTN","RCXVTSK",57,0)
STRT ;  Start the build and transmission of batches
"RTN","RCXVTSK",58,0)
 F RCSTAT="T","P" F  S RCXVBTN=$O(^RCXV("AC",RCSTAT,RCXVBTN)) Q:RCXVBTN=""  D
"RTN","RCXVTSK",59,0)
 . S RCXVBLN=0,RQFL=0
"RTN","RCXVTSK",60,0)
 . S RCXVSITE=$P($$SITE^VASITE(),U,3)
"RTN","RCXVTSK",61,0)
 . S RCXVDIR=$P($G(^RC(342,1,20)),U,1)
"RTN","RCXVTSK",62,0)
 . S RCXVBDT=$P($G(^RCXV(RCXVBTN,0)),U,2)
"RTN","RCXVTSK",63,0)
 . S RCXVBTY=$P($G(^RCXV(RCXVBTN,0)),U,4)
"RTN","RCXVTSK",64,0)
 . S RCXVSEQ=$P($G(^RCXV(RCXVBTN,0)),U,5)
"RTN","RCXVTSK",65,0)
 . S RCXVSTOT=$P($G(^RCXV(RCXVBTN,0)),U,6)
"RTN","RCXVTSK",66,0)
 . S RCXVLDOM=$P($G(^RC(342,1,20)),U,8)
"RTN","RCXVTSK",67,0)
 . S RCXVLEG=+$P($G(^RC(342,1,20)),U,7)
"RTN","RCXVTSK",68,0)
 . ;
"RTN","RCXVTSK",69,0)
 . I RCSTAT'="T" D  Q:RQFL
"RTN","RCXVTSK",70,0)
 .. I $G(RCXVSEQ)="" S RQFL=1 Q
"RTN","RCXVTSK",71,0)
 .. I $P(^RCXV(RCXVBTN,0),U,3)="C" S RQFL=1 Q
"RTN","RCXVTSK",72,0)
 .. S RCXVUP(348.4,RCXVBTN_",",.03)="T"
"RTN","RCXVTSK",73,0)
 .. D FILE^DIE("I","RCXVUP","RCXVERR")
"RTN","RCXVTSK",74,0)
 .. K RCXVUP
"RTN","RCXVTSK",75,0)
 . ;
"RTN","RCXVTSK",76,0)
 . ; If a file has been transmitted but no acknowledgement
"RTN","RCXVTSK",77,0)
 . ; has been received after 5 days, resend
"RTN","RCXVTSK",78,0)
 . I RCSTAT="T" D  Q:RQFL
"RTN","RCXVTSK",79,0)
 .. S RCXVTRD=$P($G(^RCXV(RCXVBTN,0)),U,8)\1
"RTN","RCXVTSK",80,0)
 .. S RCXVARD=$P($G(^RCXV(RCXVBTN,0)),U,9)\1
"RTN","RCXVTSK",81,0)
 .. I $$FMADD^XLFDT(RCXVTRD,5)>DT S RQFL=1
"RTN","RCXVTSK",82,0)
 .. ;I RCXVARD=0,RCXVLEG,RCXVTRD'=0 S RQFL=1
"RTN","RCXVTSK",83,0)
 . ;
"RTN","RCXVTSK",84,0)
 . Q:RQFL
"RTN","RCXVTSK",85,0)
 . ; FILENAME=SITE_DATE_BATCH# 
"RTN","RCXVTSK",86,0)
 . S RCXVFILE="RCXV"_RCXVSITE_RCXVBDT_RCXVBTN_".TXT"
"RTN","RCXVTSK",87,0)
 . S RCXVSCR="TMP_RCXV"_RCXVSITE_"_"_RCXVBTN
"RTN","RCXVTSK",88,0)
 . D OPEN^%ZISH("RCXVHNDL",RCXVDIR,RCXVFILE,"W")
"RTN","RCXVTSK",89,0)
 . U IO
"RTN","RCXVTSK",90,0)
 . S RCXVDMN=$P($G(^XTV(8989.3,1,0)),U,1)
"RTN","RCXVTSK",91,0)
 . S RCXVDMN=$P($G(^DIC(4.2,RCXVDMN,0)),U,1)
"RTN","RCXVTSK",92,0)
 . S RCXVRN=$P($G(^RCXV(RCXVBTN,1,0)),U,4) ; # OF REC
"RTN","RCXVTSK",93,0)
 . S RCXVRT=$P($G(^RCXV(RCXVBTN,0)),U,4) ; TYPE OF DATA 
"RTN","RCXVTSK",94,0)
 . W "HDR:"_RCXVSITE_RCXVU_RCXVDMN_RCXVU_RCXVRT_RCXVU_RCXVRN_RCXVU_RCXVBDT_RCXVU_RCXVXDT_RCXVU_RCXVSEQ_RCXVU_RCXVSTOT_RCXVU_RCXVLDOM,!
"RTN","RCXVTSK",95,0)
 . F  S RCXVBLN=$O(^RCXV(RCXVBTN,1,RCXVBLN)) Q:'RCXVBLN  D
"RTN","RCXVTSK",96,0)
 .. S DFN=$P(^RCXV(RCXVBTN,1,RCXVBLN,0),U,2)
"RTN","RCXVTSK",97,0)
 .. D EN^RCXVDC
"RTN","RCXVTSK",98,0)
 . ;
"RTN","RCXVTSK",99,0)
 . S RCXVD0=0
"RTN","RCXVTSK",100,0)
 . F  S RCXVD0=$O(^RCXV(RCXVBTN,2,RCXVD0)) Q:'RCXVD0  D
"RTN","RCXVTSK",101,0)
 .. S RCXVEDT=$P($G(^RCY(344,RCXVD0,0)),U,12)\1
"RTN","RCXVTSK",102,0)
 .. D D344^RCXVDC8
"RTN","RCXVTSK",103,0)
 . ;
"RTN","RCXVTSK",104,0)
 . D CLOSE^%ZISH("RCXVHNDL")
"RTN","RCXVTSK",105,0)
 . ;
"RTN","RCXVTSK",106,0)
 . S $P(^RC(342,1,20),U,9)=$$NOW^XLFDT()
"RTN","RCXVTSK",107,0)
 . ;
"RTN","RCXVTSK",108,0)
 . ;  FTP directly to ARC
"RTN","RCXVTSK",109,0)
 . D EN^RCXVFTP(RCXVFILE,RCXVDIR)
"RTN","RCXVTSK",110,0)
 ;
"RTN","RCXVTSK",111,0)
 ;  Check on FTP transfer messages
"RTN","RCXVTSK",112,0)
 D ^RCXVFTR
"RTN","RCXVTSK",113,0)
 ;
"RTN","RCXVTSK",114,0)
 L -^RCXVTSK
"RTN","RCXVTSK",115,0)
EXIT K IEN,DIK,DA,RCXVBLN,RCXVBTN,RCSTAT,RCXVBDT,RCXVDMN,RCXVXDT,RCXVTRD
"RTN","RCXVTSK",116,0)
 K RCXVSITE,RCXVFILE,RCXVRN,RCXVRT,RCXVDIR,RCXVATP,RCXVU,DTACT,RBSQ,RBTOT
"RTN","RCXVTSK",117,0)
 K RCFDATE,RCXVCFLG,RCXVDBN,RCXVIDT,RCXVSEQ,RCXVSTOT,RCXVTRD,CCT,DTENT
"RTN","RCXVTSK",118,0)
 K RCBLN,RCDBTR,RCDEBT,RCTRAN,RCXVTR,RCBCN,RCXVPFDT,RCXVPTDT,RCXRMB
"RTN","RCXVTSK",119,0)
 K RCXVLDOM,RCXVARD,RCXVSUB
"RTN","RCXVTSK",120,0)
 K ^TMP("RCXVMSG",$J),^TMP("RCXVA",$J),^TMP("RCXVIN",$J)
"RTN","RCXVTSK",121,0)
 Q
"RTN","RCXVTSK",122,0)
 ;
"RTN","RCXVTSK",123,0)
HIS ;  Historical data extract
"RTN","RCXVTSK",124,0)
 ;
"RTN","RCXVTSK",125,0)
 L +^RCXVTSK:60 E  HANG 600 G HIS
"RTN","RCXVTSK",126,0)
 ;
"RTN","RCXVTSK",127,0)
 I $G(DT)="" D DT^DICRW
"RTN","RCXVTSK",128,0)
 ;
"RTN","RCXVTSK",129,0)
 I RCXVFFD="" D
"RTN","RCXVTSK",130,0)
 . S RCFDATE=$$FYCY^IBCU8(DT)
"RTN","RCXVTSK",131,0)
 . S RCXVFFD=$P(RCFDATE,U,3),RCXVFTD=$P(RCFDATE,U,4)
"RTN","RCXVTSK",132,0)
 ;
"RTN","RCXVTSK",133,0)
 S RCXVDAT=RCXVFFD-.01
"RTN","RCXVTSK",134,0)
 F  S RCXVDAT=$O(^PRCA(430,"ACTDT",RCXVDAT)) Q:RCXVDAT=""!(RCXVDAT>RCXVFTD)  D
"RTN","RCXVTSK",135,0)
 . S IEN=""
"RTN","RCXVTSK",136,0)
 . F  S IEN=$O(^PRCA(430,"ACTDT",RCXVDAT,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",137,0)
 .. I $P(^PRCA(430,IEN,0),U,8)=16!($P(^PRCA(430,IEN,0),U,8)=40) Q
"RTN","RCXVTSK",138,0)
 .. S RCXVBLN=IEN,DFN=$P(^PRCA(430,IEN,0),U,7)
"RTN","RCXVTSK",139,0)
 .. D FIL^RCXVDEQ("H")
"RTN","RCXVTSK",140,0)
 ;
"RTN","RCXVTSK",141,0)
 L -^RCXVTSK
"RTN","RCXVTSK",142,0)
 ;
"RTN","RCXVTSK",143,0)
 D EN
"RTN","RCXVTSK",144,0)
 K RCXVDAT,RCFDATE,RCXVFFD,RCXVFTD,IEN,DFN,RCXVBLN
"RTN","RCXVTSK",145,0)
 ;
"RTN","RCXVTSK",146,0)
 Q
"RTN","RCXVTSK",147,0)
 ;
"RTN","RCXVTSK",148,0)
CUR ;  Find all current fiscal year bills
"RTN","RCXVTSK",149,0)
 ;
"RTN","RCXVTSK",150,0)
 L +^RCXVTSK:60 E  HANG 600 G CUR
"RTN","RCXVTSK",151,0)
 ;
"RTN","RCXVTSK",152,0)
 S TTYP=""
"RTN","RCXVTSK",153,0)
 F  S TTYP=$O(^PRCA(433,"AT",TTYP)) Q:TTYP=""  D
"RTN","RCXVTSK",154,0)
 . I '+$P(^PRCA(430.3,TTYP,0),U,6) Q
"RTN","RCXVTSK",155,0)
 . S RDATE=RCXVFFD-.01
"RTN","RCXVTSK",156,0)
 . F  S RDATE=$O(^PRCA(433,"AT",TTYP,RDATE)) Q:RDATE=""!(RDATE\1>RCXVFTD)  D
"RTN","RCXVTSK",157,0)
 .. S IEN=""
"RTN","RCXVTSK",158,0)
 .. F  S IEN=$O(^PRCA(433,"AT",TTYP,RDATE,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",159,0)
 ... S RCXVBLN=$P(^PRCA(433,IEN,0),U,2)
"RTN","RCXVTSK",160,0)
 ... I RCXVBLN="" Q
"RTN","RCXVTSK",161,0)
 ... D FIL^RCXVDEQ("C")
"RTN","RCXVTSK",162,0)
 ;
"RTN","RCXVTSK",163,0)
 L -^RCXVTSK
"RTN","RCXVTSK",164,0)
 ;
"RTN","RCXVTSK",165,0)
 D EN
"RTN","RCXVTSK",166,0)
 K TTYP,RDATE,RCXVFFD,RCXVFTD,RCXVBLN
"RTN","RCXVTSK",167,0)
 Q
"RTN","RCXVTSK",168,0)
 ;
"RTN","RCXVTSK",169,0)
ACT ;  Active data extract
"RTN","RCXVTSK",170,0)
 ;
"RTN","RCXVTSK",171,0)
 L +^RCXVTSK:60 E  HANG 600 G ACT
"RTN","RCXVTSK",172,0)
 ;
"RTN","RCXVTSK",173,0)
 NEW STAT,CSTAT,QFL
"RTN","RCXVTSK",174,0)
 ;  Set up the AR Data Queue for all 'Active' and 'Suspended' bills
"RTN","RCXVTSK",175,0)
 F STAT=16,40 S IEN="" F  S IEN=$O(^PRCA(430,"AC",STAT,IEN)) Q:IEN=""  D
"RTN","RCXVTSK",176,0)
 . S RCXVBLN=IEN,DFN=$P(^PRCA(430,IEN,0),U,7)
"RTN","RCXVTSK",177,0)
 . I $P(^PRCA(430,IEN,0),U,2)="" Q
"RTN","RCXVTSK",178,0)
 . S CSTAT=$P(^PRCA(430,IEN,0),U,8)
"RTN","RCXVTSK",179,0)
 . I CSTAT'=STAT S QFL=0 D  Q:QFL
"RTN","RCXVTSK",180,0)
 .. I CSTAT'=16!(CSTAT'=40) S QFL=1
"RTN","RCXVTSK",181,0)
 . D FIL^RCXVDEQ("A")
"RTN","RCXVTSK",182,0)
 ;
"RTN","RCXVTSK",183,0)
 L -^RCXVTSK
"RTN","RCXVTSK",184,0)
 ;
"RTN","RCXVTSK",185,0)
 D EN
"RTN","RCXVTSK",186,0)
 Q
"RTN","RCXVTSK",187,0)
 ;
"RTN","RCXVTSK",188,0)
ER ; Unlock and log error
"RTN","RCXVTSK",189,0)
 L -^RCXVTSK
"RTN","RCXVTSK",190,0)
 D ^%ZTER
"RTN","RCXVTSK",191,0)
 D UNWIND^%ZTER
"RTN","RCXVTSK",192,0)
 Q
"RTN","RCXVUTIL")
0^19^B17859013
"RTN","RCXVUTIL",1,0)
RCXVUTIL ;DAOU/ALA-AR Data Extract Utility Program ;29-JUL-03
"RTN","RCXVUTIL",2,0)
 ;;4.5;Accounts Receivable;**201**;Mar 20, 1995
"RTN","RCXVUTIL",3,0)
 ;
"RTN","RCXVUTIL",4,0)
SPAR(REF) ;  HL7 Segment Parsing
"RTN","RCXVUTIL",5,0)
 ;  Input Parameter
"RTN","RCXVUTIL",6,0)
 ;    REF = Array or global reference
"RTN","RCXVUTIL",7,0)
 ;       Global or array should end with ')'
"RTN","RCXVUTIL",8,0)
 ;       e.g. ^TMP($J,"XXX",#)
"RTN","RCXVUTIL",9,0)
 ;
"RTN","RCXVUTIL",10,0)
 ;  Output Parameters
"RTN","RCXVUTIL",11,0)
 ;    RCXSEG(#) = Each sequence of the segment in the array
"RTN","RCXVUTIL",12,0)
 ;
"RTN","RCXVUTIL",13,0)
 NEW ISCT,II,IJ,IK,ISDATA,ISPEC,ISBEG,ISEND,IS,LSDATA,IM,NPC
"RTN","RCXVUTIL",14,0)
 ;
"RTN","RCXVUTIL",15,0)
 S ISCT="",II=0,IS=0
"RTN","RCXVUTIL",16,0)
 F  S ISCT=$O(@REF@(ISCT)) Q:ISCT=""  D
"RTN","RCXVUTIL",17,0)
 . S IS=IS+1
"RTN","RCXVUTIL",18,0)
 . S ISDATA(IS)=$G(@REF@(ISCT))
"RTN","RCXVUTIL",19,0)
 . I $O(@REF@(ISCT))="" S ISDATA(IS)=ISDATA(IS)_HLFS
"RTN","RCXVUTIL",20,0)
 . S ISPEC(IS)=$L(ISDATA(IS),HLFS)
"RTN","RCXVUTIL",21,0)
 ;
"RTN","RCXVUTIL",22,0)
 S IM=0,LSDATA=""
"RTN","RCXVUTIL",23,0)
LP S IM=IM+1 Q:IM>IS
"RTN","RCXVUTIL",24,0)
 S LSDATA=LSDATA_ISDATA(IM),NPC=ISPEC(IM)
"RTN","RCXVUTIL",25,0)
 F IJ=1:1:NPC-1 D
"RTN","RCXVUTIL",26,0)
 . S II=II+1,RCXSEG(II)=$$CLNSTR($P(LSDATA,HLFS,IJ),HL("ECH"),$E(HL("ECH")))
"RTN","RCXVUTIL",27,0)
 S LSDATA=$P(LSDATA,HLFS,NPC)
"RTN","RCXVUTIL",28,0)
 G LP
"RTN","RCXVUTIL",29,0)
 ;
"RTN","RCXVUTIL",30,0)
CLNSTR(STRING,CHARS,SUBSEP) ;  Remove extra trailing components and subcomponents
"RTN","RCXVUTIL",31,0)
 ;  in the HL7 segment
"RTN","RCXVUTIL",32,0)
 ;
"RTN","RCXVUTIL",33,0)
 ;  Input parameters
"RTN","RCXVUTIL",34,0)
 ;    STRING - The data value to be 'cleansed'
"RTN","RCXVUTIL",35,0)
 ;    CHARS - The component character to be removed
"RTN","RCXVUTIL",36,0)
 ;    SUSEP - The subcomponent character to be removed
"RTN","RCXVUTIL",37,0)
 ;
"RTN","RCXVUTIL",38,0)
 N RTSTRING,NUMPEC,PEC
"RTN","RCXVUTIL",39,0)
 S RTSTRING=$$RTRIMCH(STRING,CHARS)
"RTN","RCXVUTIL",40,0)
 ; Now we have string without trailing chars, remove from subs
"RTN","RCXVUTIL",41,0)
 S NUMPEC=$L(RTSTRING,SUBSEP)
"RTN","RCXVUTIL",42,0)
 F PEC=1:1:NUMPEC S $P(RTSTRING,SUBSEP,PEC)=$$RTRIMCH($P(RTSTRING,SUBSEP,PEC),CHARS)
"RTN","RCXVUTIL",43,0)
 Q RTSTRING
"RTN","RCXVUTIL",44,0)
 ;
"RTN","RCXVUTIL",45,0)
RTRIMCH(STR,CHRS) ;  Remove the trailing chars from string
"RTN","RCXVUTIL",46,0)
 N R,L
"RTN","RCXVUTIL",47,0)
 S L=1,CHRS=$G(CHRS," ")
"RTN","RCXVUTIL",48,0)
 F R=$L(STR):-1:1 Q:CHRS'[$E(STR,R)
"RTN","RCXVUTIL",49,0)
 I L=R,(CHRS[$E(STR)) S STR=""
"RTN","RCXVUTIL",50,0)
 Q $E(STR,L,R)
"RTN","RCXVUTIL",51,0)
 ;
"RTN","RCXVUTIL",52,0)
DFP(IBN) ;  Date of First Payment Function
"RTN","RCXVUTIL",53,0)
 ;  Input Parameter
"RTN","RCXVUTIL",54,0)
 ;    IBN = IEN of the bill number from file 430
"RTN","RCXVUTIL",55,0)
 ;
"RTN","RCXVUTIL",56,0)
 N VAL,IBPAY,IBT,IBT0,IBT1
"RTN","RCXVUTIL",57,0)
 S VAL=0
"RTN","RCXVUTIL",58,0)
 ;  No payments made.
"RTN","RCXVUTIL",59,0)
 I '$P($G(^PRCA(430,IBN,7)),U,7) Q ""
"RTN","RCXVUTIL",60,0)
 S (IBPAY,IBT)=0 F  S IBT=$O(^PRCA(433,"C",IBN,IBT)) Q:'IBT  D  Q:IBPAY
"RTN","RCXVUTIL",61,0)
 . S IBT0=$G(^PRCA(433,IBT,0)),IBT1=$G(^(1))
"RTN","RCXVUTIL",62,0)
 . I $P(IBT0,U,4)'=2 Q  ;                  Not complete.
"RTN","RCXVUTIL",63,0)
 . I $P(IBT1,U,2)'=2,$P(IBT1,U,2)'=34 Q  ; Not a payment.
"RTN","RCXVUTIL",64,0)
 . S X=$S(+IBT1:+IBT1,1:$P(IBT1,U,9)\1),$P(VAL,U,4)=X,IBPAY=1
"RTN","RCXVUTIL",65,0)
 Q $P(VAL,U,4)
"RTN","RCXVUTIL",66,0)
 ;
"RTN","RCXVUTIL",67,0)
DATE(X) ;  Pass in External Date and get FileMan date format
"RTN","RCXVUTIL",68,0)
 ;
"RTN","RCXVUTIL",69,0)
 ;  Input Parameter
"RTN","RCXVUTIL",70,0)
 ;    X = a date in any regular date format
"RTN","RCXVUTIL",71,0)
 ;  Output Parameter
"RTN","RCXVUTIL",72,0)
 ;    Y = a date in FileMan format
"RTN","RCXVUTIL",73,0)
 ;  Parameters
"RTN","RCXVUTIL",74,0)
 ;    DIC(0) = FileMan date parameter
"RTN","RCXVUTIL",75,0)
 ;
"RTN","RCXVUTIL",76,0)
 I X["@" S %DT="T"
"RTN","RCXVUTIL",77,0)
 I $G(DIC(0))="" S DIC(0)=""
"RTN","RCXVUTIL",78,0)
 D ^%DT
"RTN","RCXVUTIL",79,0)
 I Y=-1 S Y=""
"RTN","RCXVUTIL",80,0)
 K DIC,%DT
"RTN","RCXVUTIL",81,0)
 Q Y
"RTN","RCXVUTIL",82,0)
 ;
"RTN","RCXVUTIL",83,0)
TASK(RCDSC) ;  Check on Task Status
"RTN","RCXVUTIL",84,0)
 ;
"RTN","RCXVUTIL",85,0)
 ;  Input Parameter
"RTN","RCXVUTIL",86,0)
 ;    RCDSC = Task Description
"RTN","RCXVUTIL",87,0)
 ;
"RTN","RCXVUTIL",88,0)
 NEW RTASKS,RTSK,ZTSK,ZTKEY
"RTN","RCXVUTIL",89,0)
 D DESC^%ZTLOAD(RCDSC,"RTASKS")
"RTN","RCXVUTIL",90,0)
 S RTSK=""
"RTN","RCXVUTIL",91,0)
 F  S RTSK=$O(RTASKS(RTSK)) Q:RTSK=""  D
"RTN","RCXVUTIL",92,0)
 . S ZTSK=RTSK D STAT^%ZTLOAD
"RTN","RCXVUTIL",93,0)
 ;
"RTN","RCXVUTIL",94,0)
 K RTASKS
"RTN","RCXVUTIL",95,0)
 I $G(ZTSK(2))="Inactive: Finished" Q 0
"RTN","RCXVUTIL",96,0)
 I $G(ZTSK(2))="Inactive: Interrupted" Q 0
"RTN","RCXVUTIL",97,0)
 I $G(ZTSK(2))="Active: Pending" Q 1
"RTN","RCXVUTIL",98,0)
 Q 0
"RTN","RCXVUTIL",99,0)
 ;
"RTN","RCXVUTIL",100,0)
SAT(RDATE) ;  Find the next Saturday date from the passed in date
"RTN","RCXVUTIL",101,0)
 NEW CDOW,FDATE,NDAYS
"RTN","RCXVUTIL",102,0)
 S CDOW=$$DOW^XLFDT(RDATE,1),NDAYS=6-CDOW
"RTN","RCXVUTIL",103,0)
 I NDAYS=0 S NDAYS=7
"RTN","RCXVUTIL",104,0)
 S FDATE=$$FMADD^XLFDT(RDATE,NDAYS)
"RTN","RCXVUTIL",105,0)
 Q FDATE
"RTN","RCXVUTIL",106,0)
 ;
"RTN","RCXVUTIL",107,0)
CARE(RCXVIEN) ;  Is bill VA or NON-VA care?
"RTN","RCXVUTIL",108,0)
 ;
"RTN","RCXVUTIL",109,0)
 ;  Input parameter
"RTN","RCXVUTIL",110,0)
 ;    RCXVIEN = Bill ien
"RTN","RCXVUTIL",111,0)
 ;
"RTN","RCXVUTIL",112,0)
 ;  Output parameter
"RTN","RCXVUTIL",113,0)
 ;    RCXVCFL = Care Flag
"RTN","RCXVUTIL",114,0)
 ;    0 = Non-VA Care
"RTN","RCXVUTIL",115,0)
 ;    1 = VA Care
"RTN","RCXVUTIL",116,0)
 ;
"RTN","RCXVUTIL",117,0)
 NEW RCXVCARE,RCXVRATE,RCXVODT,RPTF
"RTN","RCXVUTIL",118,0)
 S RCXVCFL=0
"RTN","RCXVUTIL",119,0)
 ;
"RTN","RCXVUTIL",120,0)
 ;  If not Reimbursable Insurance, it's VA CARE
"RTN","RCXVUTIL",121,0)
 S RCXVRATE=$O(^DGCR(399.3,"B","REIMBURSABLE INS.",""))
"RTN","RCXVUTIL",122,0)
 I $P($G(^DGCR(399,RCXVIEN,0)),U,7)'=RCXVRATE S RCXVCFL=1 Q
"RTN","RCXVUTIL",123,0)
 ;
"RTN","RCXVUTIL",124,0)
 ; If prescription, it's VA Care
"RTN","RCXVUTIL",125,0)
 I $D(^IBA(362.4,"C",RCXVIEN))>0 S RCXVCFL=1 Q
"RTN","RCXVUTIL",126,0)
 ;
"RTN","RCXVUTIL",127,0)
 I $P($G(^DGCR(399,RCXVIEN,0)),U,16)'="" Q
"RTN","RCXVUTIL",128,0)
 ;
"RTN","RCXVUTIL",129,0)
 S RCXVCARE=$G(^DGCR(399,RCXVIEN,"U2"))
"RTN","RCXVUTIL",130,0)
 I $P(RCXVCARE,U,10)'="" Q
"RTN","RCXVUTIL",131,0)
 I $P(RCXVCARE,U,11)'="" Q
"RTN","RCXVUTIL",132,0)
 I $P(RCXVCARE,U,12)'="" Q
"RTN","RCXVUTIL",133,0)
 I $P(RCXVCARE,U,13)'="" Q
"RTN","RCXVUTIL",134,0)
 I $P(RCXVCARE,U,14)'="" Q
"RTN","RCXVUTIL",135,0)
 I $P(RCXVCARE,U,15)'="" Q
"RTN","RCXVUTIL",136,0)
 ;
"RTN","RCXVUTIL",137,0)
 ;  Check inpatient
"RTN","RCXVUTIL",138,0)
 I $P($G(^DGCR(399,RCXVIEN,0)),U,5)<3 D  Q:RCXVCFL
"RTN","RCXVUTIL",139,0)
 . S RPTF=$P($G(^DGCR(399,RCXVIEN,0)),U,8)
"RTN","RCXVUTIL",140,0)
 . I RPTF="" Q
"RTN","RCXVUTIL",141,0)
 . I $P($G(^DGPT(RPTF,0)),U,4)=1 Q
"RTN","RCXVUTIL",142,0)
 . S RCXVCFL=1
"RTN","RCXVUTIL",143,0)
 ;
"RTN","RCXVUTIL",144,0)
 ;  Check outpatient encounter
"RTN","RCXVUTIL",145,0)
 NEW IBCBK,IBVAL
"RTN","RCXVUTIL",146,0)
 S IBCBK="I '$P(Y0,U,6) S ^TMP(""RCXVOE"",$J,+$P(Y0,U,8),Y)=Y0"
"RTN","RCXVUTIL",147,0)
 S IBVAL("DFN")=$P(^DGCR(399,RCXVIEN,0),U,2)
"RTN","RCXVUTIL",148,0)
 S RCXVODT=0 K ^TMP("RCXVOE",$J)
"RTN","RCXVUTIL",149,0)
 F  S RCXVODT=$O(^DGCR(399,RCXVIEN,"OP",RCXVODT)) Q:'RCXVODT  D
"RTN","RCXVUTIL",150,0)
 . S IBVAL("BDT")=RCXVODT,IBVAL("EDT")=RCXVODT+.9999
"RTN","RCXVUTIL",151,0)
 . D SCAN^IBSDU("PATIENT/DATE",.IBVAL,"",IBCBK,1)
"RTN","RCXVUTIL",152,0)
 I $O(^TMP("RCXVOE",$J,""))'="" S RCXVCFL=1 K ^TMP("RCXVOE",$J) Q
"RTN","RCXVUTIL",153,0)
 Q
"SEC","^DIC",348.4,348.4,0,"AUDIT")
@
"SEC","^DIC",348.4,348.4,0,"DD")
@
"SEC","^DIC",348.4,348.4,0,"DEL")
@
"SEC","^DIC",348.4,348.4,0,"LAYGO")
@
"SEC","^DIC",348.4,348.4,0,"RD")
@
"SEC","^DIC",348.4,348.4,0,"WR")
@
"VER")
8.0^22.0
"^DD",342,342,20.01,0)
VITRIA STANDARD DIRECTORY^RF^^20;1^K:$L(X)>25!($L(X)<2) X
"^DD",342,342,20.01,3)
Answer must be 2-25 characters in length.
"^DD",342,342,20.01,21,0)
^.001^1^1^3030722^^^
"^DD",342,342,20.01,21,1,0)
This field will contain the name of the specific directory into the nightly task will place the data files.  This will be the standard directory which Vitria will scan for files to retrieve.
"^DD",342,342,20.01,"DT")
3031119
"^DD",342,342,20.02,0)
MAIL GROUP^RP3.8'^XMB(3.8,^20;2^Q
"^DD",342,342,20.02,21,0)
^.001^1^1^3030722^^^
"^DD",342,342,20.02,21,1,0)
This field will point to the mail group that will receive any specific error messages to be received at the user level.
"^DD",342,342,20.02,"DT")
3030722
"^DD",342,342,20.03,0)
DATE OF LAST TRANSMISSION^RD^^20;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",342,342,20.03,21,0)
^.001^4^4^3031017^^^
"^DD",342,342,20.03,21,1,0)
This field will contain the last date that the transmission of
"^DD",342,342,20.03,21,2,0)
a batch occurred.  The field will be used to check the validity
"^DD",342,342,20.03,21,3,0)
of a date field in the event someone re-indexes one of the main
"^DD",342,342,20.03,21,4,0)
files used in the CBO AR Data Extract.
"^DD",342,342,20.03,"DT")
3031017
"^DD",342,342,20.04,0)
CBO STATUS^S^1:ON;0:OFF;^20;4^Q
"^DD",342,342,20.04,.1)
TEST SYSTEM STATUS
"^DD",342,342,20.04,21,0)
^^3^3^3031111^
"^DD",342,342,20.04,21,1,0)
This field will be set to '1' if this system is 'ON' or '0' if 
"^DD",342,342,20.04,21,2,0)
this system is 'OFF'. Only test systems will be allowed to 'turn off' the
"^DD",342,342,20.04,21,3,0)
CBO AR Data Extract.
"^DD",342,342,20.04,"DT")
3031119
"^DD",342,342,20.05,0)
MAXIMUM NUMBER RECORDS^RNJ4,0^^20;5^K:+X'=X!(X>5000)!(X<100)!(X?.E1"."1N.N) X
"^DD",342,342,20.05,3)
Type a Number between 100 and 5000, 0 Decimal Digits
"^DD",342,342,20.05,21,0)
^^1^1^3030717^
"^DD",342,342,20.05,21,1,0)
This field will be used to split up large data extracts into multiple batches.
"^DD",342,342,20.05,"DT")
3030722
"^DD",342,342,20.06,0)
SYSTEM TYPE^S^T:TEST;P:PRODUCTION;^20;6^Q
"^DD",342,342,20.06,21,0)
^^1^1^3031111^
"^DD",342,342,20.06,21,1,0)
Designates whether the system is a Test or Production system.
"^DD",342,342,20.06,"DT")
3031111
"^DD",342,342,20.07,0)
LEGACY SITE?^S^1:YES;0:NO;^20;7^Q
"^DD",342,342,20.07,21,0)
^^3^3^3040129^
"^DD",342,342,20.07,21,1,0)
This field should be answered 'Yes' if the install site is a legacy
"^DD",342,342,20.07,21,2,0)
site.  This field should be answered 'No' if the install site is
"^DD",342,342,20.07,21,3,0)
NOT a legacy site.
"^DD",342,342,20.07,"DT")
3040129
"^DD",342,342,20.08,0)
PRIMARY DOMAIN^F^^20;8^K:$L(X)>30!($L(X)<5) X
"^DD",342,342,20.08,3)
Answer must be 5-30 characters in length inNAME.MED.VA.GOV format.
"^DD",342,342,20.08,21,0)
^^3^3^3040129^
"^DD",342,342,20.08,21,1,0)
This field should be the domain name of the primary VA site for
"^DD",342,342,20.08,21,2,0)
the legacy site.  It is important to have this value in order
"^DD",342,342,20.08,21,3,0)
for acknowledgement messages to be forwarded to the legacy site.
"^DD",342,342,20.08,"DT")
3040129
"^DD",342,342,20.09,0)
EXTRACT RUNNING?^D^^20;9^S %DT="EST" D ^%DT S X=Y K:Y<1 X
"^DD",342,342,20.09,3)

"^DD",342,342,20.09,21,0)
^.001^3^3^3040402^^
"^DD",342,342,20.09,21,1,0)
This field will be set when the running of CBO AR Data Extract
"^DD",342,342,20.09,21,2,0)
starts.  This is to prevent multiple jobs from running at the
"^DD",342,342,20.09,21,3,0)
same time and impacting normal system function.
"^DD",342,342,20.09,"DT")
3040402
"^DD",348.4,348.4,0)
FIELD^^2.01^11
"^DD",348.4,348.4,0,"DDA")
N
"^DD",348.4,348.4,0,"DT")
3040427
"^DD",348.4,348.4,0,"IX","AC",348.4,.03)

"^DD",348.4,348.4,0,"IX","B",348.4,.01)

"^DD",348.4,348.4,0,"IX","C",348.4,.02)

"^DD",348.4,348.4,0,"NM","AR DATA QUEUE")

"^DD",348.4,348.4,.01,0)
BATCH NUMBER^RNJ9,0^^0;1^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.01,1,0)
^.1
"^DD",348.4,348.4,.01,1,1,0)
348.4^B
"^DD",348.4,348.4,.01,1,1,1)
S ^RCXV("B",$E(X,1,30),DA)=""
"^DD",348.4,348.4,.01,1,1,2)
K ^RCXV("B",$E(X,1,30),DA)
"^DD",348.4,348.4,.01,3)
Type a Number between 1 and 999999999, 0 Decimal Digits
"^DD",348.4,348.4,.01,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.01,21,1,0)
The Batch Number is a sequential counter distinguishing each batch of data to be transmitted
"^DD",348.4,348.4,.01,"DT")
3030728
"^DD",348.4,348.4,.02,0)
BATCH DATE^D^^0;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",348.4,348.4,.02,1,0)
^.1
"^DD",348.4,348.4,.02,1,1,0)
348.4^C
"^DD",348.4,348.4,.02,1,1,1)
S ^RCXV("C",$E(X,1,30),DA)=""
"^DD",348.4,348.4,.02,1,1,2)
K ^RCXV("C",$E(X,1,30),DA)
"^DD",348.4,348.4,.02,1,1,"%D",0)
^^1^1^3030728^
"^DD",348.4,348.4,.02,1,1,"%D",1,0)
This cross-reference is used to look up a batch by the batch date.
"^DD",348.4,348.4,.02,1,1,"DT")
3030728
"^DD",348.4,348.4,.02,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.02,21,1,0)
This field will contain the date for which the batch is generated.
"^DD",348.4,348.4,.02,"DT")
3030728
"^DD",348.4,348.4,.03,0)
STATUS^S^P:PENDING;T:TRANSMITTED;C:COMPLETED;^0;3^Q
"^DD",348.4,348.4,.03,1,0)
^.1
"^DD",348.4,348.4,.03,1,1,0)
348.4^AC
"^DD",348.4,348.4,.03,1,1,1)
S ^RCXV("AC",$E(X,1,30),DA)=""
"^DD",348.4,348.4,.03,1,1,2)
K ^RCXV("AC",$E(X,1,30),DA)
"^DD",348.4,348.4,.03,1,1,"%D",0)
^^1^1^3030724^
"^DD",348.4,348.4,.03,1,1,"%D",1,0)
This cross-reference tells the status of the batch.
"^DD",348.4,348.4,.03,1,1,"DT")
3030724
"^DD",348.4,348.4,.03,21,0)
3^.001^3^3^3030716^
"^DD",348.4,348.4,.03,21,1,0)
This field contains the status of the batch. 'Pending' will indicate that the batch is ready for the nightly process. 'Transmitted' will indicate that the batch has been sent to the Vitria server but no completed acknowledgement has been
"^DD",348.4,348.4,.03,21,2,0)
received. If the batch is still at the status of 'Transmitted' the next night, it will be sent to Vitria. 'Completed' will indicate that the batch has been successfully received and processed on the Vitria server and records may now be 
"^DD",348.4,348.4,.03,21,3,0)
available for purging.
"^DD",348.4,348.4,.03,"DT")
3030724
"^DD",348.4,348.4,.04,0)
BATCH TYPE^S^D:DAILY;H:HISTORICAL;A:ACTIVE;R:DEPOSITS/RECEIPTS;C:CURRENT FY;^0;4^Q
"^DD",348.4,348.4,.04,21,0)
^.001^1^1^3031020^^
"^DD",348.4,348.4,.04,21,1,0)
This field contains the type of data contained in this batch.
"^DD",348.4,348.4,.04,"DT")
3040427
"^DD",348.4,348.4,.05,0)
BATCH SEQUENCE NUMBER^NJ4,0^^0;5^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.05,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",348.4,348.4,.05,21,0)
^.001^2^2^3031021^^
"^DD",348.4,348.4,.05,21,1,0)
This field contains the sequence number of the batch where there
"^DD",348.4,348.4,.05,21,2,0)
may be more than one batch transmitted in the daily transmission.
"^DD",348.4,348.4,.05,"DT")
3031021
"^DD",348.4,348.4,.06,0)
TOTAL BATCH SEQUENCE NUMBER^NJ4,0^^0;6^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.06,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",348.4,348.4,.06,21,0)
^.001^2^2^3031021^^
"^DD",348.4,348.4,.06,21,1,0)
This field contains the total number of batches in a daily
"^DD",348.4,348.4,.06,21,2,0)
transmission.
"^DD",348.4,348.4,.06,"DT")
3031021
"^DD",348.4,348.4,.07,0)
NUMBER OF RECORDS^NJ11,0^^0;7^K:+X'=X!(X>99999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",348.4,348.4,.07,3)
Type a Number between 0 and 99999999999, 0 Decimal Digits
"^DD",348.4,348.4,.07,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.07,21,1,0)
This field will contain the number of records contained in this batch.
"^DD",348.4,348.4,.07,"DT")
3030716
"^DD",348.4,348.4,.08,0)
ACK RECEIVED DATE/TIME^D^^0;8^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",348.4,348.4,.08,21,0)
^^1^1^3030716^
"^DD",348.4,348.4,.08,21,1,0)
This field will contain the date and time that the successful acknowledgement was received from the Vitria server.
"^DD",348.4,348.4,.08,"DT")
3030716
"^DD",348.4,348.4,.09,0)
ARC ACK RECEIVED DATE/TIME^D^^0;9^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",348.4,348.4,.09,21,0)
^^3^3^3030924^
"^DD",348.4,348.4,.09,21,1,0)
This field contains the date and time that the Boston Allocation
"^DD",348.4,348.4,.09,21,2,0)
Resource Center sent back an acknowledgement that the data was
"^DD",348.4,348.4,.09,21,3,0)
loaded succesfully.
"^DD",348.4,348.4,.09,"DT")
3030924
"^DD",348.4,348.4,1.01,0)
BILL NUMBER^348.41PA^^1;0
"^DD",348.4,348.4,2.01,0)
AR BATCH PAYMENT^348.42P^^2;0
"^DD",348.4,348.41,0)
BILL NUMBER SUB-FIELD^^.02^2
"^DD",348.4,348.41,0,"DT")
3030722
"^DD",348.4,348.41,0,"IX","B",348.41,.01)

"^DD",348.4,348.41,0,"NM","BILL NUMBER")

"^DD",348.4,348.41,0,"UP")
348.4
"^DD",348.4,348.41,.01,0)
BILL NUMBER^MP430'X^PRCA(430,^0;1^S X=DINUM
"^DD",348.4,348.41,.01,1,0)
^.1
"^DD",348.4,348.41,.01,1,1,0)
348.41^B
"^DD",348.4,348.41,.01,1,1,1)
S ^RCXV(DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",348.4,348.41,.01,1,1,2)
K ^RCXV(DA(1),1,"B",$E(X,1,30),DA)
"^DD",348.4,348.41,.01,21,0)
^^1^1^3030716^
"^DD",348.4,348.41,.01,21,1,0)
This field will contain the IEN of the bill who was triggered to be processed for this BATCH DATE.  This field will be DINUM'd so there will not be any duplicates.
"^DD",348.4,348.41,.01,"DT")
3030723
"^DD",348.4,348.41,.02,0)
PATIENT^P2'^DPT(^0;2^Q
"^DD",348.4,348.41,.02,21,0)
^^1^1^3030930^
"^DD",348.4,348.41,.02,21,1,0)
This is the patient associated with the bill.
"^DD",348.4,348.41,.02,"DT")
3030722
"^DD",348.4,348.42,0)
AR BATCH PAYMENT SUB-FIELD^^.01^1
"^DD",348.4,348.42,0,"DT")
3031022
"^DD",348.4,348.42,0,"IX","B",348.42,.01)

"^DD",348.4,348.42,0,"NM","AR BATCH PAYMENT")

"^DD",348.4,348.42,0,"UP")
348.4
"^DD",348.4,348.42,.01,0)
AR BATCH PAYMENT^MP344'X^RCY(344,^0;1^S DINUM=X Q
"^DD",348.4,348.42,.01,1,0)
^.1
"^DD",348.4,348.42,.01,1,1,0)
348.42^B
"^DD",348.4,348.42,.01,1,1,1)
S ^RCXV(DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",348.4,348.42,.01,1,1,2)
K ^RCXV(DA(1),2,"B",$E(X,1,30),DA)
"^DD",348.4,348.42,.01,21,0)
^^3^3^3031022^
"^DD",348.4,348.42,.01,21,1,0)
This field will contain any batch payments for a specific date.
"^DD",348.4,348.42,.01,21,2,0)
It will be used to transmit information to the Boston Allocation
"^DD",348.4,348.42,.01,21,3,0)
Resource Center or re-transmit as needed.
"^DD",348.4,348.42,.01,"DT")
3031022
"^DD",430,430,10,0)
DATE BILL PREPARED^RDX^^0;10^S %DT="E" D ^%DT S X=Y K:Y<1!(X>DT) X
"^DD",430,430,10,1,0)
^.1
"^DD",430,430,10,1,1,0)
430^AE^MUMPS
"^DD",430,430,10,1,1,1)
D AR^RCXVDEQ
"^DD",430,430,10,1,1,2)
Q
"^DD",430,430,10,1,1,"%D",0)
^^2^2^3030812^
"^DD",430,430,10,1,1,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",430,430,10,1,1,"%D",2,0)
file for transmission to the ARC.
"^DD",430,430,10,1,1,"DT")
3030812
"^DD",430,430,10,1,580000,0)
430^AJK1A^MUMPS
"^DD",430,430,10,1,580000,1)
I $P(^PRCA(430,+DA,0),"^",8)=16 S ^PRCA(430,"AJK1",X,DA)=""
"^DD",430,430,10,1,580000,2)
K ^PRCA(430,"AJK1",X,DA)
"^DD",430,430,10,1,580000,"%D",0)
^.101^2^2^3030812^^
"^DD",430,430,10,1,580000,"%D",1,0)
Maintains cross reference set on CURRENT STATUS field of active bills
"^DD",430,430,10,1,580000,"%D",2,0)
referenced by date prepared.
"^DD",430,430,10,1,580000,"DT")
2961220
"^DD",430,430,10,3)
Enter the date on which the bill was established.
"^DD",430,430,10,21,0)
^^1^1^2880929^^^
"^DD",430,430,10,21,1,0)
The date the bill was prepared. Time is not allowed.
"^DD",430,430,10,"DT")
3030812
"^DD",430,430,14,0)
DATE STATUS UPDATED^D^^0;14^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,14,1,0)
^.1
"^DD",430,430,14,1,1,0)
430^ASDT2^MUMPS
"^DD",430,430,14,1,1,1)
I $P(^PRCA(430,DA,0),U,8) S ^PRCA(430,"ASDT",+$P(^PRCA(430,DA,0),U,8),X,DA)=""
"^DD",430,430,14,1,1,2)
I $P(^PRCA(430,DA,0),U,8) K ^PRCA(430,"ASDT",+$P(^PRCA(430,DA,0),U,8),X,DA)
"^DD",430,430,14,1,1,"%D",0)
^^2^2^2961112^
"^DD",430,430,14,1,1,"%D",1,0)
This cross reference is used to sort bills by the status and the date
"^DD",430,430,14,1,1,"%D",2,0)
the status was last updated.
"^DD",430,430,14,1,1,"DT")
2961112
"^DD",430,430,14,1,2,0)
430^AF^MUMPS
"^DD",430,430,14,1,2,1)
D AR^RCXVDEQ
"^DD",430,430,14,1,2,2)
Q
"^DD",430,430,14,1,2,"%D",0)
^^2^2^3030812^
"^DD",430,430,14,1,2,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",430,430,14,1,2,"%D",2,0)
file for transmission to the ARC.
"^DD",430,430,14,1,2,"DT")
3030812
"^DD",430,430,14,3)
Enter the date the Status of this bill was updated. Time of day is not allowed.
"^DD",430,430,14,5,1,0)
430^8^4
"^DD",430,430,14,"DT")
3030812
"^DD",430,430,60,0)
DATE ACCOUNT ACTIVATED^DX^^6;21^S %DT="T",X="NOW" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,60,1,0)
^.1
"^DD",430,430,60,1,1,0)
430^AK^MUMPS
"^DD",430,430,60,1,1,1)
I $P($G(^RCD(340,+$P(^PRCA(430,DA,0),"^",9),0)),"^")[(";DPT(") S ^PRCA(430,"ATD",$P(^PRCA(430,DA,0),"^",9),$E(X,1,30),DA)=""
"^DD",430,430,60,1,1,2)
I $P(^PRCA(430,DA,0),"^",9) K ^PRCA(430,"ATD",$P(^PRCA(430,DA,0),"^",9),$E(X,1,30),DA)
"^DD",430,430,60,1,1,3)
Needed to set cross-reference of patient activity
"^DD",430,430,60,1,1,"%D",0)
^^2^2^2931115^^^^
"^DD",430,430,60,1,1,"%D",1,0)
This cross-reference is used to track accounts that have been made ACTIVE.
"^DD",430,430,60,1,1,"%D",2,0)
It is used by the patient statement procedures.
"^DD",430,430,60,1,1,"DT")
2931115
"^DD",430,430,60,1,2,0)
430^ACTDT^MUMPS
"^DD",430,430,60,1,2,1)
S ^PRCA(430,"ACTDT",$P(X,"."),DA)=""
"^DD",430,430,60,1,2,2)
K ^PRCA(430,"ACTDT",$P(X,"."),DA)
"^DD",430,430,60,1,2,"%D",0)
^^1^1^2970205^
"^DD",430,430,60,1,2,"%D",1,0)
This cross reference is used to sort bills by the date they are activated.
"^DD",430,430,60,1,2,"DT")
2970205
"^DD",430,430,60,1,3,0)
430^AG^MUMPS
"^DD",430,430,60,1,3,1)
D AR^RCXVDEQ
"^DD",430,430,60,1,3,2)
Q
"^DD",430,430,60,1,3,"%D",0)
^^2^2^3030812^
"^DD",430,430,60,1,3,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",430,430,60,1,3,"%D",2,0)
file for transmission to the ARC.
"^DD",430,430,60,1,3,"DT")
3030812
"^DD",430,430,60,3)
This sets the original date that the account first became active.
"^DD",430,430,60,5,1,0)
430^8^3
"^DD",430,430,60,9)
^
"^DD",430,430,60,"DT")
3030812
"^DD",430,430,64,0)
REFERRAL DATE^D^^6;4^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,64,.1)
RC/DOJ REFERRAL DATE
"^DD",430,430,64,1,0)
^.1
"^DD",430,430,64,1,1,0)
430^AD
"^DD",430,430,64,1,1,1)
S ^PRCA(430,"AD",$E(X,1,30),DA)=""
"^DD",430,430,64,1,1,2)
K ^PRCA(430,"AD",$E(X,1,30),DA)
"^DD",430,430,64,1,1,3)
Needed to look-up bills by referral date
"^DD",430,430,64,1,1,"%D",0)
^^1^1^2931014^^^
"^DD",430,430,64,1,1,"%D",1,0)
This cross-reference is used to look-up bills by Referral Date.
"^DD",430,430,64,1,2,0)
430^AH^MUMPS
"^DD",430,430,64,1,2,1)
D AR^RCXVDEQ
"^DD",430,430,64,1,2,2)
Q
"^DD",430,430,64,1,2,"%D",0)
^^2^2^3030812^
"^DD",430,430,64,1,2,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",430,430,64,1,2,"%D",2,0)
file for transmission to the ARC.
"^DD",430,430,64,1,2,"DT")
3030812
"^DD",430,430,64,3)
Enter the date the account was referred to RC/DOJ.
"^DD",430,430,64,21,0)
^^2^2^2980227^^^^
"^DD",430,430,64,21,1,0)
This is the date the account was referred to the Regional Counsel
"^DD",430,430,64,21,2,0)
or the Department of Justice for collection.
"^DD",430,430,64,"DT")
3030812
"^DD",430,430,68.2,0)
RE-REFERRAL DATE^D^^6;10^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,68.2,1,0)
^.1
"^DD",430,430,68.2,1,1,0)
430^AI^MUMPS
"^DD",430,430,68.2,1,1,1)
D AR^RCXVDEQ
"^DD",430,430,68.2,1,1,2)
Q
"^DD",430,430,68.2,1,1,"%D",0)
^^2^2^3030812^
"^DD",430,430,68.2,1,1,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",430,430,68.2,1,1,"%D",2,0)
file for transmission to the ARC.
"^DD",430,430,68.2,1,1,"DT")
3030812
"^DD",430,430,68.2,3)
Enter the date the account was re-referred to RC/DOJ
"^DD",430,430,68.2,21,0)
^^2^2^2970930^^
"^DD",430,430,68.2,21,1,0)
This is the date the account was re-referred to the Regional Counsel
"^DD",430,430,68.2,21,2,0)
or Department of Justice.
"^DD",430,430,68.2,"DT")
3030812
"^DD",430,430,68.3,0)
RETURNED DATE BY RC/DOJ^D^^6;11^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,68.3,1,0)
^.1
"^DD",430,430,68.3,1,1,0)
430^AL^MUMPS
"^DD",430,430,68.3,1,1,1)
D AR^RCXVDEQ
"^DD",430,430,68.3,1,1,2)
Q
"^DD",430,430,68.3,1,1,"%D",0)
^^2^2^3030812^
"^DD",430,430,68.3,1,1,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",430,430,68.3,1,1,"%D",2,0)
file for transmission to the ARC.
"^DD",430,430,68.3,1,1,"DT")
3030812
"^DD",430,430,68.3,3)
Enter the date the account was returned by RC/DOJ.
"^DD",430,430,68.3,21,0)
^^2^2^2970930^^
"^DD",430,430,68.3,21,1,0)
This is the date a referred account was returned by the Regional Counsel
"^DD",430,430,68.3,21,2,0)
or Department of Justice.
"^DD",430,430,68.3,"DT")
3030812
"^DD",430,430,68.4,0)
REFERRAL DATE TO COWC^D^^6;12^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,68.4,.1)

"^DD",430,430,68.4,1,0)
^.1
"^DD",430,430,68.4,1,1,0)
430^AM^MUMPS
"^DD",430,430,68.4,1,1,1)
D AR^RCXVDEQ
"^DD",430,430,68.4,1,1,2)
Q
"^DD",430,430,68.4,1,1,"%D",0)
^^2^2^3030812^
"^DD",430,430,68.4,1,1,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",430,430,68.4,1,1,"%D",2,0)
file for transmission to the ARC.
"^DD",430,430,68.4,1,1,"DT")
3030812
"^DD",430,430,68.4,3)
Enter the date the account was referred to COWC.
"^DD",430,430,68.4,21,0)
^^2^2^2910516^^
"^DD",430,430,68.4,21,1,0)
This is the date the account was referred to the DVB Committee on
"^DD",430,430,68.4,21,2,0)
Waivers and Compromise.
"^DD",430,430,68.4,"DT")
3030812
"^DD",430.3,430.3,5,0)
CBO EXTRACT FLAG^S^1:Include;0:Do not Include;^0;6^Q
"^DD",430.3,430.3,5,3)
Enter '1' to include records with this transaction type for the data extract.
"^DD",430.3,430.3,5,21,0)
^^5^5^3030722^
"^DD",430.3,430.3,5,21,1,0)
This field will be used as a flag to determine if a record with
"^DD",430.3,430.3,5,21,2,0)
this transaction type should be included in the CBOC data extract.
"^DD",430.3,430.3,5,21,3,0)
  
"^DD",430.3,430.3,5,21,4,0)
'1' will include this type and no entry or '0' will not include this
"^DD",430.3,430.3,5,21,5,0)
type.
"^DD",430.3,430.3,5,"DT")
3031119
"^DD",433,433,11,0)
TRANSACTION DATE^RDX^^1;1^S %DT(0)=-DT,%DT="E" D ^%DT S X=Y K:Y<1 X K %DT
"^DD",433,433,11,1,0)
^.1
"^DD",433,433,11,1,1,0)
433^AD^MUMPS
"^DD",433,433,11,1,1,1)
D AT^RCXVDEQ
"^DD",433,433,11,1,1,2)
Q
"^DD",433,433,11,1,1,"%D",0)
^^2^2^3030812^
"^DD",433,433,11,1,1,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",433,433,11,1,1,"%D",2,0)
file for transmission to the ARC.
"^DD",433,433,11,1,1,"DT")
3030812
"^DD",433,433,11,3)
Type the Date of Transaction.  Transaction date cannot be for future date.
"^DD",433,433,11,21,0)
^^1^1^2930813^^^
"^DD",433,433,11,21,1,0)
This is the date of this transaction.
"^DD",433,433,11,"DT")
3030812
"^DD",433,433,17,0)
TERMINATION REASON^S^1:DEBTOR'S DEATH;2:BANKRUPTCY;3:INABILITY TO LOCATE;4:WAIVED;5:COMPROMISED;6:A DEBT UNDER $25;7:INABILITY TO COLLECT;8:INCORRECT BILLING;9:OTHERS;^1;7^Q
"^DD",433,433,17,1,0)
^.1
"^DD",433,433,17,1,1,0)
433^AH^MUMPS
"^DD",433,433,17,1,1,1)
D AT^RCXVDEQ
"^DD",433,433,17,1,1,2)
Q
"^DD",433,433,17,1,1,"%D",0)
^^2^2^3030812^
"^DD",433,433,17,1,1,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",433,433,17,1,1,"%D",2,0)
file for transmission to the ARC.
"^DD",433,433,17,1,1,"DT")
3030812
"^DD",433,433,17,3)
Enter code for termination reason.
"^DD",433,433,17,21,0)
^^1^1^2930601^^^
"^DD",433,433,17,21,1,0)
This is the reason for terminating an account.
"^DD",433,433,17,"DT")
3030812
"^DD",433,433,19,0)
DATE ENTERED^DX^^1;9^S %DT="T",X="NOW" D ^%DT S X=Y K:Y<1 X
"^DD",433,433,19,1,0)
^.1
"^DD",433,433,19,1,1,0)
433^ATD^MUMPS
"^DD",433,433,19,1,1,1)
I $P($G(^RCD(340,+$P($G(^PRCA(430,+$P(^PRCA(433,DA,0),"^",2),0)),"^",9),0)),"^")[(";DPT(") S ^PRCA(433,"ATD",$P(^PRCA(430,+$P(^PRCA(433,DA,0),"^",2),0),"^",9),$E(X,1,30),DA)=""
"^DD",433,433,19,1,1,2)
I $P($G(^RCD(340,+$P($G(^PRCA(430,+$P(^PRCA(433,DA,0),"^",2),0)),"^",9),0)),"^")[(";DPT(") K ^PRCA(433,"ATD",$P(^PRCA(430,+$P(^PRCA(433,DA,0),"^",2),0),"^",9),$E(X,1,30),DA)
"^DD",433,433,19,1,1,3)
This is the debtor and date entered cross-reference.
"^DD",433,433,19,1,1,"%D",0)
^^4^4^2930603^^^^
"^DD",433,433,19,1,1,"%D",1,0)
This cross-reference is used for the patient statement. It is sorted
"^DD",433,433,19,1,1,"%D",2,0)
by the DEBTOR (field 9, file 430) and DATE ENTERED (field 19, file 433).
"^DD",433,433,19,1,1,"%D",3,0)
We loop through the Debtors transactions (Date Entered) to display his
"^DD",433,433,19,1,1,"%D",4,0)
transactions for a specified time period.
"^DD",433,433,19,1,1,"DT")
2920318
"^DD",433,433,19,1,2,0)
433^AT1^MUMPS
"^DD",433,433,19,1,2,1)
I $P($G(^PRCA(433,DA,1)),U,2) S ^PRCA(433,"AT",+$P(^PRCA(433,DA,1),U,2),$P(X,"."),DA)=""
"^DD",433,433,19,1,2,2)
I $P($G(^PRCA(433,DA,1)),U,2) K ^PRCA(433,"AT",+$P(^PRCA(433,DA,1),U,2),$P(X,"."),DA)
"^DD",433,433,19,1,2,"%D",0)
^^3^3^2961126^^
"^DD",433,433,19,1,2,"%D",1,0)
This cross reference is used by the National Database collector and
"^DD",433,433,19,1,2,"%D",2,0)
by AR reports to look up transactions by transacation type and by date
"^DD",433,433,19,1,2,"%D",3,0)
entered (processed).
"^DD",433,433,19,1,2,"DT")
2961126
"^DD",433,433,19,1,3,0)
433^AC^MUMPS
"^DD",433,433,19,1,3,1)
D AT^RCXVDEQ
"^DD",433,433,19,1,3,2)
Q
"^DD",433,433,19,1,3,"%D",0)
^^2^2^3030812^
"^DD",433,433,19,1,3,"%D",1,0)
This cross-reference will file the entry into the AR Data Queue
"^DD",433,433,19,1,3,"%D",2,0)
file for transmission to the ARC.
"^DD",433,433,19,1,3,"DT")
3030812
"^DD",433,433,19,3)
This sets in the original date that the transaction was processed
"^DD",433,433,19,5,1,0)
433^.03^2
"^DD",433,433,19,9)
^
"^DD",433,433,19,"DT")
3030812
"^DIC",348.4,348.4,0)
AR DATA QUEUE^348.4
"^DIC",348.4,348.4,0,"GL")
^RCXV(
"^DIC",348.4,348.4,"%D",0)
^1.001^4^4^3031022^^
"^DIC",348.4,348.4,"%D",1,0)
This file contains bill entries which based upon certain criteria
"^DIC",348.4,348.4,"%D",2,0)
have been triggered into this file.  These bill entries are used
"^DIC",348.4,348.4,"%D",3,0)
to export data information for CBO to the Boston Allocation
"^DIC",348.4,348.4,"%D",4,0)
Resource Center (ARC).
"^DIC",348.4,"B","AR DATA QUEUE",348.4)

**END**
**END**
