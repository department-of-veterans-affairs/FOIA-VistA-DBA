Released PRC*5.1*56 SEQ #55
Extracted from mail message
**KIDS**:PRC*5.1*56^

**INSTALL NAME**
PRC*5.1*56
"BLD",2860,0)
PRC*5.1*56^IFCAP^0^3030214^y
"BLD",2860,1,0)
^^1^1^3021011^
"BLD",2860,1,1,0)
Remove 'Do you want to send this EDI?:' prompt.
"BLD",2860,4,0)
^9.64PA^^
"BLD",2860,"ABPKG")
n
"BLD",2860,"KRN",0)
^9.67PA^19^17
"BLD",2860,"KRN",.4,0)
.4
"BLD",2860,"KRN",.401,0)
.401
"BLD",2860,"KRN",.402,0)
.402
"BLD",2860,"KRN",.403,0)
.403
"BLD",2860,"KRN",.5,0)
.5
"BLD",2860,"KRN",.84,0)
.84
"BLD",2860,"KRN",3.6,0)
3.6
"BLD",2860,"KRN",3.8,0)
3.8
"BLD",2860,"KRN",9.2,0)
9.2
"BLD",2860,"KRN",9.8,0)
9.8
"BLD",2860,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",2860,"KRN",9.8,"NM",1,0)
PRCHNPO4^^0^B56697456
"BLD",2860,"KRN",9.8,"NM","B","PRCHNPO4",1)

"BLD",2860,"KRN",19,0)
19
"BLD",2860,"KRN",19.1,0)
19.1
"BLD",2860,"KRN",101,0)
101
"BLD",2860,"KRN",409.61,0)
409.61
"BLD",2860,"KRN",771,0)
771
"BLD",2860,"KRN",870,0)
870
"BLD",2860,"KRN",8994,0)
8994
"BLD",2860,"KRN","B",.4,.4)

"BLD",2860,"KRN","B",.401,.401)

"BLD",2860,"KRN","B",.402,.402)

"BLD",2860,"KRN","B",.403,.403)

"BLD",2860,"KRN","B",.5,.5)

"BLD",2860,"KRN","B",.84,.84)

"BLD",2860,"KRN","B",3.6,3.6)

"BLD",2860,"KRN","B",3.8,3.8)

"BLD",2860,"KRN","B",9.2,9.2)

"BLD",2860,"KRN","B",9.8,9.8)

"BLD",2860,"KRN","B",19,19)

"BLD",2860,"KRN","B",19.1,19.1)

"BLD",2860,"KRN","B",101,101)

"BLD",2860,"KRN","B",409.61,409.61)

"BLD",2860,"KRN","B",771,771)

"BLD",2860,"KRN","B",870,870)

"BLD",2860,"KRN","B",8994,8994)

"BLD",2860,"QUES",0)
^9.62^^
"BLD",2860,"REQB",0)
^9.611^1^1
"BLD",2860,"REQB",1,0)
PRC*5.1*51^1
"BLD",2860,"REQB","B","PRC*5.1*51",1)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
56^3030214
"PKG",455,22,1,"PAH",1,1,0)
^^1^1^3030214
"PKG",455,22,1,"PAH",1,1,1,0)
Remove 'Do you want to send this EDI?:' prompt.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PRCHNPO4")
0^1^B56697456
"RTN","PRCHNPO4",1,0)
PRCHNPO4 ;WISC/RSD/RHD-CONT. OF NEW PO--COMPLETE PROCESSING IN SUPPLY ;4/22/98  06:21
"RTN","PRCHNPO4",2,0)
V ;;5.1;IFCAP;**51,56**;Oct 20, 2000
"RTN","PRCHNPO4",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCHNPO4",4,0)
 ;
"RTN","PRCHNPO4",5,0)
PHA S ERROR="" I $G(PRCHPC)'=1 D NEW^PRCOEDC(PRCHPO,.ERROR) I ERROR'="" W !!?5,"Procurement History transaction error " G ERR^PRCHNPO
"RTN","PRCHNPO4",6,0)
 N RBD,RBDT,RBQT,RBFY,CCHK,FCHK,REFMOP S REFMOP=$P($G(^PRC(442,PRCHPO,0)),U,2)
"RTN","PRCHNPO4",7,0)
 I REFMOP=25 S RBDT=$$DATE^PRC0C($P($G(^PRC(442,PRCHPO,1)),U,15),"I"),RBFY=$E(RBDT,3,4),RBQT=$P(RBDT,"^",2),RBD=$$QTRDATE^PRC0D(RBFY,RBQT),RBD=$P(RBD,"^",7)
"RTN","PRCHNPO4",8,0)
 S PRC("CP")=$P($G(^PRC(442,PRCHPO,0)),"^",3)
"RTN","PRCHNPO4",9,0)
 S CCHK=$P($G(^PRC(442,PRCHPO,0)),U,15)
"RTN","PRCHNPO4",10,0)
 I $G(PRCHPC)="",CCHK'="" N BRCHK,BRCOST S BRCHK=$P($G(^PRC(442,PRCHPO,0)),"^",12),BRCOST=$P($G(^PRCS(410,+BRCHK,4)),"^") S:BRCOST'="" CCHK=CCHK-BRCOST
"RTN","PRCHNPO4",11,0)
 I REFMOP=25 S FCHK=$$OVCOM^PRCS0A(PRC("SITE")_"^"_PRC("CP")_"^"_$P($$DATE^PRC0C(RBD,"I"),"^",1,2),CCHK,2) I FCHK'=0 W !,"Insufficient funds for this request." H 2 G ERR^PRCHNPO
"RTN","PRCHNPO4",12,0)
 I $P($G(^PRC(442,PRCHPO,0)),U,2)=25 S FILE=442 D LIMIT^PRCHCD0 I $G(ERROR) K FILE,ERROR G ERR^PRCHNPO
"RTN","PRCHNPO4",13,0)
 ;I $G(PRCHPC)=2 S $P(^PRC(442,PRCHPO,0),U,15)=PRCHTAMT
"RTN","PRCHNPO4",14,0)
 I $P($G(^PRC(442,PRCHPO,23)),U,11)="D" D  G:$G(ERROR) ERR^PRCHNPO
"RTN","PRCHNPO4",15,0)
 . S PRCHITM=0 F  S PRCHITM=$O(^PRC(442,PRCHPO,2,PRCHITM)) Q:'PRCHITM  I $P($G(^PRC(442,PRCHPO,2,PRCHITM,2)),U,2)="" W !!,?5,"One or more of the items on this delivery order",!,?5,"does not contain contract number." S ERROR=1
"RTN","PRCHNPO4",16,0)
 ;
"RTN","PRCHNPO4",17,0)
FS S PRCHN("SFC")=$P(^PRC(442,PRCHPO,0),U,19)
"RTN","PRCHNPO4",18,0)
 ; SET STATUS TO 'Ordered (no Fiscal Action Required)' IF IMPREST FUNDS METHOD OF PROCESSING, OR IF SPECIAL CONTROL POINT FOR SUPPLY FUND (POSTED).
"RTN","PRCHNPO4",19,0)
 ; SET STATUS TO 'Transaction Complete' FOR CERTIFIED INVOICES ORDERED FOR SUPPLY FUND.
"RTN","PRCHNPO4",20,0)
 ; SET STATUS TO 'Pending Fiscal Action' OTHERWISE.
"RTN","PRCHNPO4",21,0)
 S PRCHSTAT=10,%A="Send to Fiscal Service"
"RTN","PRCHNPO4",22,0)
 I PRCHN("SFC")=2!(PRCHN("MP")=25) S PRCHSTAT=22,%A="Print Purchase Order"
"RTN","PRCHNPO4",23,0)
 S FILE=442 D:$D(PRCHPO) CHECK^PRCHSWCH
"RTN","PRCHNPO4",24,0)
 I $G(PRCHOBL)=1 S PRCHSTAT=22,%A="Print Purchase Order "
"RTN","PRCHNPO4",25,0)
 I PRCHN("MP")=2,PRCHN("SFC")=2 S PRCHSTAT=40
"RTN","PRCHNPO4",26,0)
 ;
"RTN","PRCHNPO4",27,0)
ASK I '$G(PRCHPC),'$G(PRCHDELV) D  G Q:%=2&(PRCHN("MP")'=25)!(%<0),FS:%=0
"RTN","PRCHNPO4",28,0)
 . W ! S %A="     "_%A,%B="",%=1 D ^PRCFYN
"RTN","PRCHNPO4",29,0)
 . S NOPRINT="" I %=2 S NOPRINT=1
"RTN","PRCHNPO4",30,0)
 S P=+$P($G(^PRC(442,PRCHPO,1)),U,10),DA=PRCHPO
"RTN","PRCHNPO4",31,0)
 I 'P W !!,"P.O. is missing the Purchasing Agent and must be re-edited !",$C(7) G Q
"RTN","PRCHNPO4",32,0)
 I P'=DUZ W !!,"You must be the Purchasing Agent listed on P.O. to sign it.",$C(7) S DIR(0)="EAO",DIR("A")="Press <Return> to continue " D ^DIR K DIR(0),DIR("A") G Q
"RTN","PRCHNPO4",33,0)
 I $G(PRCHPHAM),$P(^PRC(442,PRCHPO,0),U,15)=0 D  G:%'=1 ERR^PRCHNPO
"RTN","PRCHNPO4",34,0)
 . W !!,?5,"This pharmacy order is a no charge order." S %A="     Would you like to sign this order",%B="",%=2 D ^PRCFYN
"RTN","PRCHNPO4",35,0)
 S X=$P($G(^PRC(442,PRCHPO,1)),U)
"RTN","PRCHNPO4",36,0)
 ;
"RTN","PRCHNPO4",37,0)
 ; Begin modifications for PRC*5.1*56
"RTN","PRCHNPO4",38,0)
 I X]"",$P($G(^PRC(440,X,3)),U,2)="Y",";P;S;"[(";"_$P($G(^PRC(442,PRCHPO,23)),U,11)_";") D
"RTN","PRCHNPO4",39,0)
 . S MSG1="                   This order will not be sent via EDI."
"RTN","PRCHNPO4",40,0)
 . S MSG2="To place a Purchase Card order via EDI please use the Purchasing Agent Menu."
"RTN","PRCHNPO4",41,0)
 . W !!!,"                           ***** TAKE NOTE *****"
"RTN","PRCHNPO4",42,0)
 . W !!,?2,MSG1,!!,MSG2,!!
"RTN","PRCHNPO4",43,0)
 . K MSG1,MSG2
"RTN","PRCHNPO4",44,0)
 . Q
"RTN","PRCHNPO4",45,0)
 ; End modifications for PRC*5.1*56
"RTN","PRCHNPO4",46,0)
 I X]"",$P($G(^PRC(440,X,3)),U,2)="Y",";P;S;"'[(";"_$P($G(^PRC(442,PRCHPO,23)),U,11)_";") D  G:$G(X)="ABORT" Q I $D(DTOUT)!$D(Y) W $C(7),!!,"The 'Do You Want to Send This EDI?' question was bypassed - You must reedit PO" K DTOUT G Q
"RTN","PRCHNPO4",47,0)
 . N PRCY S PRCY=""
"RTN","PRCHNPO4",48,0)
 . I $P($G(^PRC(442,PRCHPO,0)),U,2)=25 D
"RTN","PRCHNPO4",49,0)
 . . N PRCX
"RTN","PRCHNPO4",50,0)
 . . S PRCX=$P($G(^PRC(442,PRCHPO,23)),U,8)
"RTN","PRCHNPO4",51,0)
 . . S:PRCX'="" PRCX=$P($G(^PRC(440.5,PRCX,2)),U,4)
"RTN","PRCHNPO4",52,0)
 . . D NOW^%DTC
"RTN","PRCHNPO4",53,0)
 . . I ($E(PRCX,6,7)>0&(X>PRCX))!(+$E(PRCX,6,7)=0&(X\100>(PRCX\100))) D
"RTN","PRCHNPO4",54,0)
 . . . W !!,"In File #440.5, the Expiration Date for this card is blank or this card has"
"RTN","PRCHNPO4",55,0)
 . . . W !,?5,"expired!  An EDI order will reject.  Please contact your Purchase"
"RTN","PRCHNPO4",56,0)
 . . . W !,?5,"Card Coordinator." S PRCY="NO"
"RTN","PRCHNPO4",57,0)
 . N DIE,DR,DA
"RTN","PRCHNPO4",58,0)
 . S DIE=442,DR="116///@;S Y=""@1"";@1;116Do You Want to Send This EDI?~R",DA=PRCHPO D ^DIE
"RTN","PRCHNPO4",59,0)
 . Q:$D(DTOUT)!$D(Y)
"RTN","PRCHNPO4",60,0)
 . I $P($G(^PRC(442,PRCHPO,12)),U,16)="y",PRCY="NO" D
"RTN","PRCHNPO4",61,0)
 . . S X="ABORT"
"RTN","PRCHNPO4",62,0)
 . . W !,"As you have elected to send this order EDI, please ask the Purchase Card"
"RTN","PRCHNPO4",63,0)
 . . W !,"Coordinator to update the Card's Expiration Date before completing this"
"RTN","PRCHNPO4",64,0)
 . . W !,"Purchase Order. - You must reedit this PO."
"RTN","PRCHNPO4",65,0)
 ; UPDATE STATUS, P.A.SIGNATURE & BOC DATA, IN P.O.
"RTN","PRCHNPO4",66,0)
 S PRCSIG="" D ESIG^PRCUESIG(DUZ,.PRCSIG) S ROUTINE="PRCUESIG" I PRCSIG<1 D QQ G Q
"RTN","PRCHNPO4",67,0)
 ;Following line added in P194: go create new txn # if PC order modified
"RTN","PRCHNPO4",68,0)
 ;to new FCP
"RTN","PRCHNPO4",69,0)
 D CHECKFCP^PRCHNPOA(PRCHPO)
"RTN","PRCHNPO4",70,0)
 ;I $P($G(^PRC(442,PRCHPO,23)),U,11)="D",$P(^PRC(442,PRCHPO,0),U,2)=26 S $P(^PRC(442,PRCHPO,24),U)=1
"RTN","PRCHNPO4",71,0)
 I $G(PRCHPC)!$G(PRCHDELV) D  G Q:%<0,FS:%=0
"RTN","PRCHNPO4",72,0)
 . I $G(PRCPROST) S PRCPROST=3.9,NOPRINT=1,%=2 QUIT
"RTN","PRCHNPO4",73,0)
 . S %A=$S($G(PRCHPC):"Print Purchase Card Order ",1:"Print Delivery Order")
"RTN","PRCHNPO4",74,0)
 . W ! S %A="     "_%A,%B="",%=1 D ^PRCFYN
"RTN","PRCHNPO4",75,0)
 . S NOPRINT="" I %=2 S NOPRINT=1
"RTN","PRCHNPO4",76,0)
 ;
"RTN","PRCHNPO4",77,0)
 S X=$S($G(PRCHPHAM)'="":30,1:PRCHSTAT),DA=PRCHPO D ENS^PRCHSTAT
"RTN","PRCHNPO4",78,0)
 S (D0,DA)=PRCHPO D ^PRCHSF ;CALLS ROUTINE FOR FMS PROCESSING
"RTN","PRCHNPO4",79,0)
 S %DT="T",X="NOW" D ^%DT S PRCSIG="" D ENCODE^PRCHES5(DA,DUZ,.PRCSIG)
"RTN","PRCHNPO4",80,0)
 S ROUTINE=$T(+0) I PRCSIG<1 D QQ G Q
"RTN","PRCHNPO4",81,0)
 S D0=PRCHPO K D1 S:'$D(DT) DT=$P(Y,".",1)
"RTN","PRCHNPO4",82,0)
 ;
"RTN","PRCHNPO4",83,0)
 I $G(PRCHPC)!$G(PRCHDELV) D
"RTN","PRCHNPO4",84,0)
 . I $P($G(^PRC(442,PRCHPO,23)),U,8)]"" D
"RTN","PRCHNPO4",85,0)
 . . S PRCHCD=$P(^PRC(442,PRCHPO,23),U,8)
"RTN","PRCHNPO4",86,0)
 . . S PRCHPOMT=$P(^PRC(442,PRCHPO,0),U,15)
"RTN","PRCHNPO4",87,0)
 . S PODA=DA,DA=CDA S X=$P(^PRC(442,PRCHPO,0),U,15) D ESIG^PRCH410 S DA=PODA K PODA
"RTN","PRCHNPO4",88,0)
 ; IF SUPPLY FUND, NOT CERTIFIED INVOICE, SET FLAG NOTIFYING PPM TO CREATE LOG CODE SHEETS
"RTN","PRCHNPO4",89,0)
 S PRCHPOMT=$P(^PRC(442,PRCHPO,0),U,15),PRCHCD=$P(^PRC(442,PRCHPO,23),U,8)
"RTN","PRCHNPO4",90,0)
 I $P($G(^PRC(442,PRCHPO,0)),U,2)=25,$G(PRCHCD)'="" S $P(^PRC(440.5,PRCHCD,2),U)=+$P($G(^PRC(440.5,PRCHCD,2)),U)+PRCHPOMT
"RTN","PRCHNPO4",91,0)
 I PRCHN("SFC")=2 S $P(^PRC(442,PRCHPO,18),U,12)=1
"RTN","PRCHNPO4",92,0)
 I PRCHN("SFC")=2,PRCHN("MP")'=2 S $P(^PRC(442,PRCHPO,18),U,11)="N",^PRC(442,"AE","N",PRCHPO)=""
"RTN","PRCHNPO4",93,0)
 ; IF SUPPLY FUND, CERTIFIED INVOICE, UPDATE CONTROL POINT OBLIGATED BALANCE.
"RTN","PRCHNPO4",94,0)
 ;
"RTN","PRCHNPO4",95,0)
ISMS ;I PRCHSC=9 ;;I $D(PRCHISMS)   ;CHECK ISMS SWITCH AND IF TRUE CREATE ISMS TRANSACTION
"RTN","PRCHNPO4",96,0)
 ;I PRCHSC=1 D:0 EN11^PRCHEI
"RTN","PRCHNPO4",97,0)
 ;I PRCHSC=9 S PRCHTRAN="PO1" D EN11^PRCHEI(PRCHTRAN)
"RTN","PRCHNPO4",98,0)
 ;
"RTN","PRCHNPO4",99,0)
EDI ;CHECK TO SEE IF IT IS AN EDI PO AND SEND TO AUSTIN
"RTN","PRCHNPO4",100,0)
 ;I $G(PRCHSTAT)'="",PRCHSTAT'=10 N PRCOPODA S PRCOPODA=PRCHPO D ^PRCOEDI
"RTN","PRCHNPO4",101,0)
 I PRCHN("MP")=25 D  S $P(^PRC(442,PRCHPO,24),U)=1 G INV
"RTN","PRCHNPO4",102,0)
 . I $G(PRCHPC)'=1 N PRCOPODA S PRCOPODA=PRCHPO W !!,"...now generating the PHA transaction" D ^PRCOEDI
"RTN","PRCHNPO4",103,0)
 . I '$P($G(^PRC(442,PRCHPO,23)),U,11) D
"RTN","PRCHNPO4",104,0)
 . . I '$P(^PRC(442,PRCHPO,0),U,12) S DA=PRCHPO D START^PRCH410 D  Q
"RTN","PRCHNPO4",105,0)
 . . . S PODA=PRCHPO,DA=CDA S X=$P(^PRC(442,PRCHPO,0),U,15) D ESIG^PRCH410 S DA=PODA K PODA
"RTN","PRCHNPO4",106,0)
 . . I $P(^PRC(442,PRCHPO,0),U,12) D COMM^PRCSPC(PRCHPO,$P(^PRC(442,PRCHPO,0),U,10))
"RTN","PRCHNPO4",107,0)
 I $G(PRCHSTAT)'="",PRCHSTAT'=10 D  S:$P(^PRC(442,PRCHPO,0),U,2)=26 $P(^PRC(442,PRCHPO,24),U)=1 G INV
"RTN","PRCHNPO4",108,0)
 . Q:$P(^PRC(442,PRCHPO,0),U,2)=2
"RTN","PRCHNPO4",109,0)
 . N PRCOPODA S PRCOPODA=PRCHPO D ^PRCOEDI,SUPP^PRCFFMO
"RTN","PRCHNPO4",110,0)
 I $G(PRCHOBL)=2 N PRCOPODA S PRCOPODA=PRCHPO W !!,"...now generating the PHA transaction" D ^PRCOEDI
"RTN","PRCHNPO4",111,0)
 ;I $G(PRCHOBL)=2,$G(PRCHPC)'=1 N PRCOPODA S PRCOPODA=PRCHPO W !!,"...now generating the PHA transaction" D ^PRCOEDI
"RTN","PRCHNPO4",112,0)
 ;I $G(PRCHOBL)'=2,$G(PRCHSTAT)'="",PRCHSTAT'=10 D
"RTN","PRCHNPO4",113,0)
 ;.I $G(PRCHPC)'=1 N PRCOPODA S PRCOPODA=PRCHPO W !!,"...now generating the PHA transaction" D ^PRCOEDI
"RTN","PRCHNPO4",114,0)
 ;.D:PRCHN("MP")'=25 SUPP^PRCFFMO
"RTN","PRCHNPO4",115,0)
 ;.I PRCHN("MP")=25,'$P($G(^PRC(442,PRCHPO,23)),U,11) D
"RTN","PRCHNPO4",116,0)
 ;..I '$P(^PRC(442,PRCHPO,0),U,12) S DA=PRCHPO D START^PRCH410 D  Q
"RTN","PRCHNPO4",117,0)
 ;...S PODA=PRCHPO,DA=CDA S X=$P(^PRC(442,PRCHPO,0),U,15) D ESIG^PRCH410 S DA=PODA K PODA
"RTN","PRCHNPO4",118,0)
 ;..I $P(^PRC(442,PRCHPO,0),U,12) D COMM^PRCSPC(PRCHPO,$P(^PRC(442,PRCHPO,0),U,10))
"RTN","PRCHNPO4",119,0)
 ;update due-ins at the inventory point
"RTN","PRCHNPO4",120,0)
INV G:$P($G(^PRC(442,PRCHPO,23)),U,11)="S" PRT
"RTN","PRCHNPO4",121,0)
 G:$G(PRCHPHAM) PRT
"RTN","PRCHNPO4",122,0)
 S FLG=0 I $P(^PRC(442,PRCHPO,0),U,2)=2 D
"RTN","PRCHNPO4",123,0)
 .S N=0 F  S N=$O(^PRC(442,PRCHPO,2,N)) Q:'N!(FLG)  I $P(^(N,0),U,5)]"" S FLG=1
"RTN","PRCHNPO4",124,0)
 .K N
"RTN","PRCHNPO4",125,0)
 I $P($G(^PRC(442,PRCHPO,23)),U,11)'="S" I '$G(PRCHPHAM) D
"RTN","PRCHNPO4",126,0)
 . I $P(^PRC(442,PRCHPO,0),U,2)'=2 S DA=PRCHPO D UPDATE^PRCPWIU
"RTN","PRCHNPO4",127,0)
 . I ($P(^PRC(442,PRCHPO,0),U,2)=2)&(FLG) S DA=PRCHPO D UPDATE^PRCPWIU
"RTN","PRCHNPO4",128,0)
 K FLG
"RTN","PRCHNPO4",129,0)
 ;S DA=PRCHPO D UPDATE^PRCPWIU
"RTN","PRCHNPO4",130,0)
 ;
"RTN","PRCHNPO4",131,0)
PRT ;IF IMPREST FUND PO, PRINT A COPY ON BOTH IMPREST FUND & FISCAL PRINTER.
"RTN","PRCHNPO4",132,0)
 ;IF SUPPLY FUND PO, PRINT A COPY IN P&C AND ONE IN FISCAL.
"RTN","PRCHNPO4",133,0)
 ; OTHERWISE, PRINT A COPY IN FISCAL
"RTN","PRCHNPO4",134,0)
 ;IF SUPPLY FUND PAYMENT IN ADVANCE, PRINT 2 MORE COPIES IN FISCAL.
"RTN","PRCHNPO4",135,0)
 K PRCHQ S (D0,DA)=PRCHPO,PRCHQ="^PRCHFPNT"
"RTN","PRCHNPO4",136,0)
 ;
"RTN","PRCHNPO4",137,0)
 I PRCHN("MP")=12 S PRCHQ("DEST2")="IFP" D ^PRCHQUE
"RTN","PRCHNPO4",138,0)
 I '$G(NOPRINT) I PRCHN("SFC")=2!(PRCHN("MP")=25) S:PRCHN("MP")'=25 PRCHQ("DEST")="S8" D ^PRCHQUE S (D0,DA)=PRCHPO,PRCHQ="^PRCHFPNT"
"RTN","PRCHNPO4",139,0)
 ;
"RTN","PRCHNPO4",140,0)
 K PRCHQ S (D0,DA)=PRCHPO,PRCHQ="^PRCHFPNT"
"RTN","PRCHNPO4",141,0)
 I PRCHN("MP")'=25 S PRCHQ("DEST")="F" D ^PRCHQUE
"RTN","PRCHNPO4",142,0)
 I PRCHN("SFC")=2,PRCHN("MP")=3 F PRCHI=1,2 S (D0,DA)=PRCHPO,PRCHQ="^PRCHFPNT",PRCHQ("DEST")="F" D ^PRCHQUE
"RTN","PRCHNPO4",143,0)
 G Q
"RTN","PRCHNPO4",144,0)
 ;
"RTN","PRCHNPO4",145,0)
QQ N:'$D(ROUTINE) ROUTINE S:$G(ROUTINE)="" ROUTINE=$T(+0) N DIR
"RTN","PRCHNPO4",146,0)
 W !!,$$ERR^PRCHQQ(ROUTINE,PRCSIG) W:PRCSIG=0!(PRCSIG=-3) !,"Notify Application Coordinator!",$C(7)
"RTN","PRCHNPO4",147,0)
 S DIR(0)="EAO",DIR("A")="Press <return> to continue" D ^DIR K PRCSIG
"RTN","PRCHNPO4",148,0)
 Q
"RTN","PRCHNPO4",149,0)
 ;
"RTN","PRCHNPO4",150,0)
Q L  K PRCH,PRCHAC,PRCHACT,PRCHAM,PRCHAMT,PRCHB,PRCHBO,PRCHCN,PRCHCNT,PRCHD,PRCHDA,PRCHDT,PRCHEC,PRCHEDI,PRCHER,PRCHES,PRCHEST,PRCHESTL,PRCHFPDS,PRCHI,PRCHL0,PRCHL1,PRCHL2,PRCHL3,PRCHLCNT,PRCHLI,PRCSIG,ROUTINE
"RTN","PRCHNPO4",151,0)
 K PRCHN,PRCHNM,PRCHNRQ,PRCHP,PRCHPO,PRCHPONO,PRCHQ,PRCHS,PRCHSC,PRCHSTAT,PRCHTTT,PRCHV,PRCHVAR,PRCHX,PRCHY,DIC,DIE,DR,D0,DA,X,Y,Z,I,J,K,P,ZTSK
"RTN","PRCHNPO4",152,0)
 K ERROR,ITEMCNT,M,M0,PRCHFCP,PRCHLOG,PRCHSTN,ZTDESC,ZTRTN,ZTUCI,A,B,C,V3,PRCHXXD0,F1,I1,POP,PRCHLN,SUBACC,ERROR1,NOPRINT
"RTN","PRCHNPO4",153,0)
 Q
"VER")
8.0^22.0
**END**
**END**
