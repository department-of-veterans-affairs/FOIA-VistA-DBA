Released PRC*5.1*103 SEQ #92
Extracted from mail message
**KIDS**:PRC*5.1*103^

**INSTALL NAME**
PRC*5.1*103
"BLD",5006,0)
PRC*5.1*103^IFCAP^0^3070427^y
"BLD",5006,1,0)
^^3^3^3061222^
"BLD",5006,1,1,0)
THIS IFCAP PATCH WILL DISPLAY DATA FROM IFCAP FILES #441 AND #442
"BLD",5006,1,2,0)
AND FROM PROSTHETICS FILE #664. DBIA #4345 AUTHORIZES READ ACCESS TO
"BLD",5006,1,3,0)
FILE #664.
"BLD",5006,4,0)
^9.64PA^^
"BLD",5006,6)
6^
"BLD",5006,6.3)
25
"BLD",5006,"ABPKG")
n
"BLD",5006,"INID")
n^n^n
"BLD",5006,"KRN",0)
^9.67PA^8989.52^19
"BLD",5006,"KRN",.4,0)
.4
"BLD",5006,"KRN",.401,0)
.401
"BLD",5006,"KRN",.402,0)
.402
"BLD",5006,"KRN",.403,0)
.403
"BLD",5006,"KRN",.5,0)
.5
"BLD",5006,"KRN",.84,0)
.84
"BLD",5006,"KRN",3.6,0)
3.6
"BLD",5006,"KRN",3.8,0)
3.8
"BLD",5006,"KRN",9.2,0)
9.2
"BLD",5006,"KRN",9.8,0)
9.8
"BLD",5006,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5006,"KRN",9.8,"NM",1,0)
PRCHL4^^0^B44518310
"BLD",5006,"KRN",9.8,"NM",2,0)
PRCHL5^^0^B23158748
"BLD",5006,"KRN",9.8,"NM",3,0)
PRCHL6^^0^B11788560
"BLD",5006,"KRN",9.8,"NM","B","PRCHL4",1)

"BLD",5006,"KRN",9.8,"NM","B","PRCHL5",2)

"BLD",5006,"KRN",9.8,"NM","B","PRCHL6",3)

"BLD",5006,"KRN",19,0)
19
"BLD",5006,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",5006,"KRN",19,"NM",1,0)
PRCHL GUI^^0
"BLD",5006,"KRN",19,"NM","B","PRCHL GUI",1)

"BLD",5006,"KRN",19.1,0)
19.1
"BLD",5006,"KRN",101,0)
101
"BLD",5006,"KRN",409.61,0)
409.61
"BLD",5006,"KRN",771,0)
771
"BLD",5006,"KRN",870,0)
870
"BLD",5006,"KRN",8989.51,0)
8989.51
"BLD",5006,"KRN",8989.52,0)
8989.52
"BLD",5006,"KRN",8994,0)
8994
"BLD",5006,"KRN",8994,"NM",0)
^9.68A^3^3
"BLD",5006,"KRN",8994,"NM",1,0)
PRCHL ITEM DET^^0
"BLD",5006,"KRN",8994,"NM",2,0)
PRCHL LIST^^0
"BLD",5006,"KRN",8994,"NM",3,0)
PRCHL LIST X^^0
"BLD",5006,"KRN",8994,"NM","B","PRCHL ITEM DET",1)

"BLD",5006,"KRN",8994,"NM","B","PRCHL LIST",2)

"BLD",5006,"KRN",8994,"NM","B","PRCHL LIST X",3)

"BLD",5006,"KRN","B",.4,.4)

"BLD",5006,"KRN","B",.401,.401)

"BLD",5006,"KRN","B",.402,.402)

"BLD",5006,"KRN","B",.403,.403)

"BLD",5006,"KRN","B",.5,.5)

"BLD",5006,"KRN","B",.84,.84)

"BLD",5006,"KRN","B",3.6,3.6)

"BLD",5006,"KRN","B",3.8,3.8)

"BLD",5006,"KRN","B",9.2,9.2)

"BLD",5006,"KRN","B",9.8,9.8)

"BLD",5006,"KRN","B",19,19)

"BLD",5006,"KRN","B",19.1,19.1)

"BLD",5006,"KRN","B",101,101)

"BLD",5006,"KRN","B",409.61,409.61)

"BLD",5006,"KRN","B",771,771)

"BLD",5006,"KRN","B",870,870)

"BLD",5006,"KRN","B",8989.51,8989.51)

"BLD",5006,"KRN","B",8989.52,8989.52)

"BLD",5006,"KRN","B",8994,8994)

"BLD",5006,"QUES",0)
^9.62^^
"BLD",5006,"REQB",0)
^9.611^^
"KRN",19,12197,-1)
0^1
"KRN",19,12197,0)
PRCHL GUI^LOGISTICS DATA TOOL^^B^^^^^^^^IFCAP
"KRN",19,12197,1,0)
^19.06^4^4^3061115^^^^
"KRN",19,12197,1,1,0)
'B' type option for use after installation of patch PRC*5.1*103.
"KRN",19,12197,1,2,0)
For users to be able to use the LOGISTICS Detail Display GUI
"KRN",19,12197,1,3,0)
front-end, this option must be on either their primary
"KRN",19,12197,1,4,0)
or secondary menu options.  
"KRN",19,12197,99.1)
60739,60353
"KRN",19,12197,"RPC",0)
^19.05P^6^4
"KRN",19,12197,"RPC",2,0)
PRCHL LIST
"KRN",19,12197,"RPC",3,0)
PRCHL LIST X
"KRN",19,12197,"RPC",6,0)
PRCHL ITEM DET
"KRN",19,12197,"U")
LOGISTICS DATA TOOL
"KRN",8994,1339,-1)
0^2
"KRN",8994,1339,0)
PRCHL LIST^EN^PRCHL4^4^A^^^1
"KRN",8994,1339,2,0)
^8994.02A^2^2
"KRN",8994,1339,2,1,0)
DATE1^1^50^1^1
"KRN",8994,1339,2,1,1,0)
^8994.021^1^1^3060824^^^
"KRN",8994,1339,2,1,1,1,0)
The Fileman date to start the query.  The beginning date.
"KRN",8994,1339,2,2,0)
DATE2^1^50^1^2
"KRN",8994,1339,2,2,1,0)
^8994.021^1^1^3060824^^^
"KRN",8994,1339,2,2,1,1,0)
The Fileman date to end the query.  The ending date.
"KRN",8994,1339,2,"B","DATE1",1)

"KRN",8994,1339,2,"B","DATE2",2)

"KRN",8994,1339,2,"PARAMSEQ",1,1)

"KRN",8994,1339,2,"PARAMSEQ",2,2)

"KRN",8994,1339,605001)
34015
"KRN",8994,1340,-1)
0^3
"KRN",8994,1340,0)
PRCHL LIST X^EN^PRCHL5^4^A^^^1
"KRN",8994,1340,1,0)
^^6^6^3061130^
"KRN",8994,1340,1,1,0)
GUI REMOTE PROCEDURE, LIST DATA
"KRN",8994,1340,1,2,0)
 
"KRN",8994,1340,1,3,0)
        ;RESULTS passed to broker in ^TMP($J,
"KRN",8994,1340,1,4,0)
        ;delimited by "^"
"KRN",8994,1340,1,5,0)
        ;piece 1 = DATA TO DISPLAY
"KRN",8994,1340,1,6,0)
        ;piece 2 = FIELD NUMBER
"KRN",8994,1340,605001)
34015
"KRN",8994,1341,-1)
0^1
"KRN",8994,1341,0)
PRCHL ITEM DET^EN^PRCHL6^2^R^0^^0
"KRN",8994,1341,1,0)
^8994.01^13^13^3070228^^^^
"KRN",8994,1341,1,1,0)
A         ;piece 1 - line item number
"KRN",8994,1341,1,2,0)
         ;piece 2 - Item Master number
"KRN",8994,1341,1,3,0)
         ;piece 3 - qty
"KRN",8994,1341,1,4,0)
         ;piece 4 - unit of purchase
"KRN",8994,1341,1,5,0)
         ;piece 5 - BOC
"KRN",8994,1341,1,6,0)
         ;piece 6 - contract BOA
"KRN",8994,1341,1,7,0)
         ;piece 7 - actual unit cost
"KRN",8994,1341,1,8,0)
         ;piece 8 - fed supply classification
"KRN",8994,1341,1,9,0)
         ;piece 9 - vendor stock number
"KRN",8994,1341,1,10,0)
         ;piece 10 - unit conversion factor
"KRN",8994,1341,1,11,0)
         ;piece 11 - total cost
"KRN",8994,1341,1,12,0)
         ;piece 12 - nif number
"KRN",8994,1341,1,13,0)
         ;piece 13 - item master short description 441- .05
"KRN",8994,1341,2,0)
^8994.02A^1^1
"KRN",8994,1341,2,1,0)
IEN^1^50^1^1
"KRN",8994,1341,2,"B","IEN",1)

"KRN",8994,1341,2,"PARAMSEQ",1,1)

"KRN",8994,1341,3,0)
^8994.03^2^2^3070228^^
"KRN",8994,1341,3,1,0)
 
"KRN",8994,1341,3,2,0)
 
"KRN",8994,1341,605001)
34015
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
103^3070427^2425
"PKG",455,22,1,"PAH",1,1,0)
^^3^3^3070427
"PKG",455,22,1,"PAH",1,1,1,0)
THIS IFCAP PATCH WILL DISPLAY DATA FROM IFCAP FILES #441 AND #442
"PKG",455,22,1,"PAH",1,1,2,0)
AND FROM PROSTHETICS FILE #664. DBIA #4345 AUTHORIZES READ ACCESS TO
"PKG",455,22,1,"PAH",1,1,3,0)
FILE #664.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PRCHL4")
0^1^B44518310^n/a
"RTN","PRCHL4",1,0)
PRCHL4 ;VACO/HNC/VAC - REMOTE PROCEDURE, LIST LOGISTICS DATA FILE 442 ; 4/17/07 3:47pm
"RTN","PRCHL4",2,0)
 ;;5.1;IFCAP;**103**;Oct 20, 2000;Build 25
"RTN","PRCHL4",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified
"RTN","PRCHL4",4,0)
 ;DBIA# 4345 giving permission to reference Prosthetics data
"RTN","PRCHL4",5,0)
 ;hnc - Aug 21, 2006 add item detail to main grid
"RTN","PRCHL4",6,0)
 ;VAC - Set limit on 80 po line items
"RTN","PRCHL4",7,0)
 ;
"RTN","PRCHL4",8,0)
 ;RESULTS passed to broker in ^TMP($J,
"RTN","PRCHL4",9,0)
 ;delimited by ^
"RTN","PRCHL4",10,0)
 ;piece 1 = .1 date; display 2
"RTN","PRCHL4",11,0)
 ;piece 2 = 91 cost; display 5
"RTN","PRCHL4",12,0)
 ;piece 3 = 19 agent assigned PO; display 9
"RTN","PRCHL4",13,0)
 ;piece 4 = primary 2237; display 15
"RTN","PRCHL4",14,0)
 ;piece 5 = 93 liq amount; display 17
"RTN","PRCHL4",15,0)
 ;piece 6 = FOB; display 13
"RTN","PRCHL4",16,0)
 ;piece 7 = 1.4 Appropriation; display 14
"RTN","PRCHL4",17,0)
 ;piece 8 = 2 cost center; display 8
"RTN","PRCHL4",18,0)
 ;piece 9 = 5 vendor; display 12
"RTN","PRCHL4",19,0)
 ;piece 10 = 15 number of line items on po; display 11 
"RTN","PRCHL4",20,0)
 ;piece 11 = station, derived from PO Number; display 1
"RTN","PRCHL4",21,0)
 ;piece 12 = 6.4 IEN 442; display 18
"RTN","PRCHL4",22,0)
 ;piece 13 = .02 method; display 4
"RTN","PRCHL4",23,0)
 ;piece 14 = .01 purchase order number; display 3
"RTN","PRCHL4",24,0)
 ;piece 15 = .5 Status; display 6
"RTN","PRCHL4",25,0)
 ;piece 16 = 1 FCP; display 7
"RTN","PRCHL4",26,0)
 ;piece 17 =5.4 Ship To; display 10
"RTN","PRCHL4",27,0)
 ;piece 18 =61 purchase card holder; display 16
"RTN","PRCHL4",28,0)
 ;piece 19 = Optional Flex Field
"RTN","PRCHL4",29,0)
 ;piece 20 = Optional Flex Field
"RTN","PRCHL4",30,0)
 ;piece 21 = Optional Flex Field
"RTN","PRCHL4",31,0)
EN(RESULT,DATE1,DATE2,FLEXF,FLEX2,FLEX3) ;broker entry point
"RTN","PRCHL4",32,0)
 ;
"RTN","PRCHL4",33,0)
 K ^TMP($J)
"RTN","PRCHL4",34,0)
 I '$D(DATE1)!('$D(DATE2)) G EXIT
"RTN","PRCHL4",35,0)
 S DATE=DATE1-1
"RTN","PRCHL4",36,0)
 F  S DATE=$O(^PRC(442,"AB",DATE)) Q:(DATE="")!($P(DATE,".",1)>DATE2)  D
"RTN","PRCHL4",37,0)
 .S RMPRB=0
"RTN","PRCHL4",38,0)
 .F  S RMPRB=$O(^PRC(442,"AB",DATE,RMPRB)) Q:RMPRB=""  D
"RTN","PRCHL4",39,0)
 ..D DATA
"RTN","PRCHL4",40,0)
 S RESULT=$NA(^TMP($J))
"RTN","PRCHL4",41,0)
 K DATE,DFN,HDES,LINE,PHCPCS,RMPRB,RMPRFLD,TYPE,PRCHLB
"RTN","PRCHL4",42,0)
 Q
"RTN","PRCHL4",43,0)
 ;
"RTN","PRCHL4",44,0)
DATA ;
"RTN","PRCHL4",45,0)
 S PRCHLB=RMPRB
"RTN","PRCHL4",46,0)
 I (FLEXF'="")&(FLEXF'="ITM") S RMPRFLD=".1;91;19;.5;2;20;15;.02;.01;7.2;93;1.4;6.4;5.4;1;61;5;.07;"_FLEXF
"RTN","PRCHL4",47,0)
 I (FLEXF="")!(FLEXF="ITM") S RMPRFLD=".1;91;19;.5;2;20;15;.02;.01;7.2;93;1.4;6.4;5.4;1;61;5;.07"
"RTN","PRCHL4",48,0)
 I (FLEX2'="")&(FLEX2'="ITM") S RMPRFLD=RMPRFLD_";"_FLEX2
"RTN","PRCHL4",49,0)
 I (FLEX3'="")&(FLEX3'="ITM") S RMPRFLD=RMPRFLD_";"_FLEX3
"RTN","PRCHL4",50,0)
 D GETS^DIQ(442,PRCHLB,RMPRFLD,"","RMXM")
"RTN","PRCHL4",51,0)
 ;flat data
"RTN","PRCHL4",52,0)
 S $P(^TMP($J,PRCHLB),U,1)=$G(RMXM(442,PRCHLB_",",.1))
"RTN","PRCHL4",53,0)
 S $P(^TMP($J,PRCHLB),U,2)=$G(RMXM(442,PRCHLB_",",91))
"RTN","PRCHL4",54,0)
 S $P(^TMP($J,PRCHLB),U,3)=$G(RMXM(442,PRCHLB_",",19))
"RTN","PRCHL4",55,0)
 S $P(^TMP($J,PRCHLB),U,4)=$G(RMXM(442,PRCHLB_",",.07))
"RTN","PRCHL4",56,0)
 S $P(^TMP($J,PRCHLB),U,5)=$G(RMXM(442,PRCHLB_",",93))
"RTN","PRCHL4",57,0)
 S $P(^TMP($J,PRCHLB),U,6)=PRCHLB
"RTN","PRCHL4",58,0)
 S $P(^TMP($J,PRCHLB),U,7)=$G(RMXM(442,PRCHLB_",",1.4))
"RTN","PRCHL4",59,0)
 S $P(^TMP($J,PRCHLB),U,8)=$G(RMXM(442,PRCHLB_",",2))
"RTN","PRCHL4",60,0)
 S $P(^TMP($J,PRCHLB),U,9)=$G(RMXM(442,PRCHLB_",",5))
"RTN","PRCHL4",61,0)
 S $P(^TMP($J,PRCHLB),U,10)=$G(RMXM(442,PRCHLB_",",15))
"RTN","PRCHL4",62,0)
 S $P(^TMP($J,PRCHLB),U,11)=$P($G(RMXM(442,PRCHLB_",",.01)),"-",1)
"RTN","PRCHL4",63,0)
 S $P(^TMP($J,PRCHLB),U,12)=$G(RMXM(442,PRCHLB_",",6.4))
"RTN","PRCHL4",64,0)
 S $P(^TMP($J,PRCHLB),U,13)=$G(RMXM(442,PRCHLB_",",.02))
"RTN","PRCHL4",65,0)
 S $P(^TMP($J,PRCHLB),U,14)=$G(RMXM(442,PRCHLB_",",.01))
"RTN","PRCHL4",66,0)
 S $P(^TMP($J,PRCHLB),U,15)=$G(RMXM(442,PRCHLB_",",.5))
"RTN","PRCHL4",67,0)
 S $P(^TMP($J,PRCHLB),U,16)=$G(RMXM(442,PRCHLB_",",1))
"RTN","PRCHL4",68,0)
 S $P(^TMP($J,PRCHLB),U,17)=$G(RMXM(442,PRCHLB_",",5.4))
"RTN","PRCHL4",69,0)
 S $P(^TMP($J,PRCHLB),U,18)=$G(RMXM(442,PRCHLB_",",61))
"RTN","PRCHL4",70,0)
 ;
"RTN","PRCHL4",71,0)
 I FLEXF'="" S $P(^TMP($J,PRCHLB),U,19)=$G(RMXM(442,PRCHLB_",",FLEXF))
"RTN","PRCHL4",72,0)
 I FLEXF="" S $P(^TMP($J,PRCHLB),U,19)=""
"RTN","PRCHL4",73,0)
 I FLEX2'="" S $P(^TMP($J,PRCHLB),U,20)=$G(RMXM(442,PRCHLB_",",FLEX2))
"RTN","PRCHL4",74,0)
 I FLEX2="" S $P(^TMP($J,PRCHLB),U,20)=""
"RTN","PRCHL4",75,0)
 I FLEX3'="" S $P(^TMP($J,PRCHLB),U,21)=$G(RMXM(442,PRCHLB_",",FLEX3))
"RTN","PRCHL4",76,0)
 I FLEX3="" S $P(^TMP($J,PRCHLB),U,21)=""
"RTN","PRCHL4",77,0)
 ;
"RTN","PRCHL4",78,0)
 I (FLEXF="ITM")!(FLEX2="ITM")!(FLEX3="ITM") D ITMDET
"RTN","PRCHL4",79,0)
 K RMXM,PRCHLB
"RTN","PRCHL4",80,0)
 Q
"RTN","PRCHL4",81,0)
ITMDET ;item detail
"RTN","PRCHL4",82,0)
 I PRCHLB="" Q
"RTN","PRCHL4",83,0)
 S CNT=0
"RTN","PRCHL4",84,0)
 ;First check number of line items on PO, stop if more than 80
"RTN","PRCHL4",85,0)
 I $P(^TMP($J,PRCHLB),U,10)>80 S $P(^TMP($J,PRCHLB,1),U,10)="<** More than 80 Line Items **>" Q
"RTN","PRCHL4",86,0)
 D GETS^DIQ(442,PRCHLB,"40*;.01","EN","ITM")
"RTN","PRCHL4",87,0)
 S PRCHPO=$G(ITM("442",PRCHLB_",",".01","E"))
"RTN","PRCHL4",88,0)
 S PRCHIEN=""
"RTN","PRCHL4",89,0)
 I PRCHPO'="" S PRCHIEN=$O(^RMPR(664,"G",$P(PRCHPO,"-",2),PRCHIEN))
"RTN","PRCHL4",90,0)
 I PRCHIEN'="" D GETS^DIQ(664,PRCHIEN,"2*;11;12","EN","PITMSTR")
"RTN","PRCHL4",91,0)
 I $D(PITMSTR) D
"RTN","PRCHL4",92,0)
 .;Prosthetic item
"RTN","PRCHL4",93,0)
 .S PRCHB="" F  S PRCHB=$O(PITMSTR(664.02,PRCHB)) Q:'PRCHB  D
"RTN","PRCHL4",94,0)
 .  .S QTY=$G(PITMSTR(664.02,PRCHB,3,"E"))
"RTN","PRCHL4",95,0)
 .  .S UOP=$G(PITMSTR(664.02,PRCHB,4,"E"))
"RTN","PRCHL4",96,0)
 .  .S CBOA=$G(PITMSTR(664.02,PRCHB,13,"E"))
"RTN","PRCHL4",97,0)
 .  .S ITMD=$G(PITMSTR(664.02,PRCHB,1,"E"))
"RTN","PRCHL4",98,0)
 .  .S AUC=$G(PITMSTR(664.02,PRCHB,6,"E"))
"RTN","PRCHL4",99,0)
 .  .I AUC="" S AUC=$G(PITMSTR(664.02,PRCHB,2,"E"))
"RTN","PRCHL4",100,0)
 .  .S HCPCS=$G(PITMSTR(664.02,PRCHB,16,"E"))
"RTN","PRCHL4",101,0)
 .  .S VSN=$G(PITMSTR(664.02,PRCHB,15.4,"E"))
"RTN","PRCHL4",102,0)
 .  .S TCST=QTY*AUC
"RTN","PRCHL4",103,0)
 .  .S CNT=CNT+1
"RTN","PRCHL4",104,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,1)=$G(RMXM(442,PRCHLB_",",.1))
"RTN","PRCHL4",105,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,2)=TCST
"RTN","PRCHL4",106,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,8)=CBOA
"RTN","PRCHL4",107,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,7)=VSN
"RTN","PRCHL4",108,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,11)=$P($G(RMXM(442,PRCHLB_",",.01)),"-",1)
"RTN","PRCHL4",109,0)
 .  .I HCPCS'="" S $P(^TMP($J,PRCHLB,CNT),U,13)="HCPCS: "_HCPCS
"RTN","PRCHL4",110,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,14)=$G(RMXM(442,PRCHLB_",",.01))_"-P "_CNT
"RTN","PRCHL4",111,0)
 .  .I FLEXF="ITM" S $P(^TMP($J,PRCHLB,CNT),U,19)=$TR(ITMD,","," ")
"RTN","PRCHL4",112,0)
 .  .I FLEX2="ITM" S $P(^TMP($J,PRCHLB,CNT),U,20)=$TR(ITMD,","," ")
"RTN","PRCHL4",113,0)
 .  .I FLEX3="ITM" S $P(^TMP($J,PRCHLB,CNT),U,21)=$TR(ITMD,","," ")
"RTN","PRCHL4",114,0)
 .;prosthetic shipping
"RTN","PRCHL4",115,0)
 . S SHIP="",SHIPF=""
"RTN","PRCHL4",116,0)
 . S SHIP=$G(PITMSTR(664,PRCHIEN_",",11,"E"))
"RTN","PRCHL4",117,0)
 . S SHIPF=$G(PITMSTR(664,PRCHIEN_",",12,"E"))
"RTN","PRCHL4",118,0)
 . I SHIPF'="" S SHIP=SHIPF
"RTN","PRCHL4",119,0)
 . I SHIP'="" D
"RTN","PRCHL4",120,0)
 .  .S CNT=CNT+1
"RTN","PRCHL4",121,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,2)=SHIP
"RTN","PRCHL4",122,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,1)=$G(RMXM(442,PRCHLB_",",.1))
"RTN","PRCHL4",123,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,11)=$P($G(RMXM(442,PRCHLB_",",.01)),"-",1)
"RTN","PRCHL4",124,0)
 .  .S $P(^TMP($J,PRCHLB,CNT),U,14)=$G(RMXM(442,PRCHLB_",",.01))_"-P "_CNT
"RTN","PRCHL4",125,0)
 .  .I FLEXF="ITM" S $P(^TMP($J,PRCHLB,CNT),U,19)="Shipping"
"RTN","PRCHL4",126,0)
 .  .I FLEX2="ITM" S $P(^TMP($J,PRCHLB,CNT),U,20)="Shipping"
"RTN","PRCHL4",127,0)
 .  .I FLEX3="ITM" S $P(^TMP($J,PRCHLB,CNT),U,21)="Shipping"
"RTN","PRCHL4",128,0)
 .;IFCAP item
"RTN","PRCHL4",129,0)
 S B="" F  S B=$O(ITM(442.01,B)) Q:'B  D
"RTN","PRCHL4",130,0)
 . S IFITM=$G(ITM(442.01,B,1.5,"E"))
"RTN","PRCHL4",131,0)
 . D GETS^DIQ(441,IFITM,".01;.05;51","E","ITMSTR")
"RTN","PRCHL4",132,0)
 . S ITMD=$G(ITMSTR(441,IFITM_",",.05,"E"))
"RTN","PRCHL4",133,0)
 . S IFITM1=$G(ITMSTR(441,IFITM_",",.01,"E"))
"RTN","PRCHL4",134,0)
 . S NIF=$G(ITMSTR(441,IFITM_",",51,"E"))
"RTN","PRCHL4",135,0)
 . S LICNT=$P(B,",",1)
"RTN","PRCHL4",136,0)
 . S QTY=$G(ITM(442.01,B,2,"E"))
"RTN","PRCHL4",137,0)
 . S UOP=$G(ITM(442.01,B,3,"E"))
"RTN","PRCHL4",138,0)
 . S BOC=$G(ITM(442.01,B,3.5,"E"))
"RTN","PRCHL4",139,0)
 . S CBOA=$G(ITM(442.01,B,4,"E"))
"RTN","PRCHL4",140,0)
 . S AUC=$TR($G(ITM(442.01,B,5,"E")),"$","")
"RTN","PRCHL4",141,0)
 . S FSC=$G(ITM(442.01,B,8,"E"))
"RTN","PRCHL4",142,0)
 . S VSN=$G(ITM(442.01,B,9,"E"))
"RTN","PRCHL4",143,0)
 . S UCF=$G(ITM(442.01,B,9.7,"E"))
"RTN","PRCHL4",144,0)
 . S TCST=$G(ITM(442.01,B,15,"E"))
"RTN","PRCHL4",145,0)
 . S ITMDD=$G(ITM(442.01,B,1,1))
"RTN","PRCHL4",146,0)
 . I ITMD'="" S ITMD=ITMD_" "
"RTN","PRCHL4",147,0)
 . S ITMD=ITMD_"1st Line: "_ITMDD
"RTN","PRCHL4",148,0)
 . K ITMDD
"RTN","PRCHL4",149,0)
 . S CNT=CNT+1
"RTN","PRCHL4",150,0)
 . ;S ^TMP($J,PRCHLB,CNT)="I "_LICNT_U_IFITM1_U_QTY_U_UOP_U_BOC_U_CBOA_U_AUC_U_FSC_U_VSN_U_UCF_U_TCST_U_NIF_U_ITMD
"RTN","PRCHL4",151,0)
 .S $P(^TMP($J,PRCHLB,CNT),U,2)=TCST
"RTN","PRCHL4",152,0)
 .I FLEXF="ITM" S $P(^TMP($J,PRCHLB,CNT),U,19)=$TR(ITMD,","," ")
"RTN","PRCHL4",153,0)
 .I FLEX2="ITM" S $P(^TMP($J,PRCHLB,CNT),U,20)=$TR(ITMD,","," ")
"RTN","PRCHL4",154,0)
 .I FLEX3="ITM" S $P(^TMP($J,PRCHLB,CNT),U,21)=$TR(ITMD,","," ")
"RTN","PRCHL4",155,0)
 .S $P(^TMP($J,PRCHLB,CNT),U,1)=$G(RMXM(442,PRCHLB_",",.1))
"RTN","PRCHL4",156,0)
 .S $P(^TMP($J,PRCHLB,CNT),U,8)=BOC
"RTN","PRCHL4",157,0)
 .S $P(^TMP($J,PRCHLB,CNT),U,9)=VSN
"RTN","PRCHL4",158,0)
 .S $P(^TMP($J,PRCHLB,CNT),U,11)=$P($G(RMXM(442,PRCHLB_",",.01)),"-",1)
"RTN","PRCHL4",159,0)
 .I NIF'="" S IFITM1=IFITM1_" NIF: "_NIF
"RTN","PRCHL4",160,0)
 .I IFITM1'="" S $P(^TMP($J,PRCHLB,CNT),U,13)="Item Master: "_IFITM1
"RTN","PRCHL4",161,0)
 .S $P(^TMP($J,PRCHLB,CNT),U,14)=$G(RMXM(442,PRCHLB_",",.01))_"-I "_LICNT
"RTN","PRCHL4",162,0)
 K PRCHLB,CNT,ITM,ITMSTR,IFITM,ITMD,IFITM1,LICNT,QTY,UOP,BOC,CBOA,AUC,FSC,VSN,UCF,TCST,NIF,B,PRCHPO,PITMSTR,PRCHB,PRCHIEN,HCPCS,SHIP,SHIPF
"RTN","PRCHL4",163,0)
 Q
"RTN","PRCHL4",164,0)
EXIT ;
"RTN","PRCHL4",165,0)
 Q
"RTN","PRCHL4",166,0)
 ;END
"RTN","PRCHL5")
0^2^B23158748^n/a
"RTN","PRCHL5",1,0)
PRCHL5 ;VACO/HNC/VAC -  FLEX FIELD SORT;7/05/06 ; 3/8/07 12:54pm
"RTN","PRCHL5",2,0)
 ;;5.1;IFCAP;**103**;Oct 20, 2000;Build 25
"RTN","PRCHL5",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified
"RTN","PRCHL5",4,0)
 ;
"RTN","PRCHL5",5,0)
 ;hnc - July 5, 2006 removed ;;46;PURCHASE CARD NUMBER
"RTN","PRCHL5",6,0)
 ;hnc - July 19, 2006 removed ;;55;PURCHASE CARD EXT. NO.
"RTN","PRCHL5",7,0)
 ;hnc - July 19, 2006 added FPDS header and FPDS fields below
"RTN","PRCHL5",8,0)
 ;hnc - July 21, 2006 move Primary 2237 to main grid
"RTN","PRCHL5",9,0)
 ;hnc - Aug 21, 2006 add Item Detail to main grid
"RTN","PRCHL5",10,0)
 ;VAC - March 8, 2007 remove Direct Delivery Patient from Detail
"RTN","PRCHL5",11,0)
 ;
"RTN","PRCHL5",12,0)
EN(RESULT,RMPRFLD) ;
"RTN","PRCHL5",13,0)
 ;RESULT passed to broker in ^TMP($J,
"RTN","PRCHL5",14,0)
 ;delimited by "^"
"RTN","PRCHL5",15,0)
 K ^TMP($J)
"RTN","PRCHL5",16,0)
 N RMPRII,RMPRLN
"RTN","PRCHL5",17,0)
 S CNT=0
"RTN","PRCHL5",18,0)
 F RMPRII=1:1 S RMPRLN=$P($T(HLST+RMPRII),";",4) Q:RMPRLN=""  D
"RTN","PRCHL5",19,0)
 .S RMPRFLD=$P($T(HLST+RMPRII),";",3)
"RTN","PRCHL5",20,0)
 .S CNT=CNT+1
"RTN","PRCHL5",21,0)
 .S ^TMP($J,"RMPR",CNT)=RMPRLN_U_RMPRFLD
"RTN","PRCHL5",22,0)
 S RESULT=$NA(^TMP($J))
"RTN","PRCHL5",23,0)
 K CNT
"RTN","PRCHL5",24,0)
 Q
"RTN","PRCHL5",25,0)
HLST ;pick list
"RTN","PRCHL5",26,0)
 ;;ITM;ITEM DETAIL
"RTN","PRCHL5",27,0)
 ;;.03;SPECIAL FUND CONTROL POINT
"RTN","PRCHL5",28,0)
 ;;.04;INVOICE ADDRESS
"RTN","PRCHL5",29,0)
 ;;.06;PRIORITY OF 2237
"RTN","PRCHL5",30,0)
 ;;.08;ESTIMATED ORDER? 
"RTN","PRCHL5",31,0)
 ;;.09;DEPOT VOUCHER NO. 
"RTN","PRCHL5",32,0)
 ;;.2;EMERGENCY ORDER?
"RTN","PRCHL5",33,0)
 ;;.25;LOCAL PROCUREMENT REASON CODE
"RTN","PRCHL5",34,0)
 ;;.3;EXPENDABLE/NONEXPENDABLE
"RTN","PRCHL5",35,0)
 ;;.5;SUPPLY STATUS
"RTN","PRCHL5",36,0)
 ;;.7;SUPPLY STATUS ORDER
"RTN","PRCHL5",37,0)
 ;;.8;FISCAL STATUS ORDER
"RTN","PRCHL5",38,0)
 ;;1.4;APPROPRIATION
"RTN","PRCHL5",39,0)
 ;;3;SUBACCOUNT1
"RTN","PRCHL5",40,0)
 ;;3.4;SUBAMOUNT1
"RTN","PRCHL5",41,0)
 ;;4;SUBACCOUNT2
"RTN","PRCHL5",42,0)
 ;;4.4;SUBAMOUNT2
"RTN","PRCHL5",43,0)
 ;;5;VENDOR
"RTN","PRCHL5",44,0)
 ;;5.1;DEBTOR
"RTN","PRCHL5",45,0)
 ;;5.2;REQUESTING SERVICE
"RTN","PRCHL5",46,0)
 ;;5.4;SHIP TO
"RTN","PRCHL5",47,0)
 ;;5.6;DELIVERY LOCATION
"RTN","PRCHL5",48,0)
 ;;6;VERBAL PURCHASE ORDER 
"RTN","PRCHL5",49,0)
 ;;6.2;CONFIRMATION COPY 
"RTN","PRCHL5",50,0)
 ;;6.4;F.O.B. POINT
"RTN","PRCHL5",51,0)
 ;;6.9;ORIGINAL DELIVERY DATE 
"RTN","PRCHL5",52,0)
 ;;7;DELIVERY DATE
"RTN","PRCHL5",53,0)
 ;;7.2;ESTIMATED COST
"RTN","PRCHL5",54,0)
 ;;8;SOURCE CODE 
"RTN","PRCHL5",55,0)
 ;;8.1;ASTR. FOR SOURCE CODE 
"RTN","PRCHL5",56,0)
 ;;8.2;PROPOSAL 
"RTN","PRCHL5",57,0)
 ;;13;EST. SHIPPING AND/OR HANDLING 
"RTN","PRCHL5",58,0)
 ;;13.05;EST. SHIPPING BOC 
"RTN","PRCHL5",59,0)
 ;;13.1;EST. SHIPPING LINE ITEM NO. 
"RTN","PRCHL5",60,0)
 ;;13.2;GOV'T B/L NO. 
"RTN","PRCHL5",61,0)
 ;;13.3;SHIP VIA 
"RTN","PRCHL5",62,0)
 ;;13.4;GBL P.O.NUMBER
"RTN","PRCHL5",63,0)
 ;;15;LINE ITEM COUNT 
"RTN","PRCHL5",64,0)
 ;;16;PA/PPM/AUTHORIZED BUYER
"RTN","PRCHL5",65,0)
 ;;18;PO PRINTED TIME 
"RTN","PRCHL5",66,0)
 ;;18.6;NEED SPECIAL HANDLING? 
"RTN","PRCHL5",67,0)
 ;;18.7;TYPE OF SPECIAL HANDLING 
"RTN","PRCHL5",68,0)
 ;;19;AGENT ASSIGNED P.O. 
"RTN","PRCHL5",69,0)
 ;;19.2;DATE P.O. ASSIGNED
"RTN","PRCHL5",70,0)
 ;;21;MONTH
"RTN","PRCHL5",71,0)
 ;;22;QUARTER
"RTN","PRCHL5",72,0)
 ;;23;LAST DIGIT OF FISCAL YEAR 
"RTN","PRCHL5",73,0)
 ;;26;BBFY
"RTN","PRCHL5",74,0)
 ;;27;OLD PO RECORD
"RTN","PRCHL5",75,0)
 ;;28;NEW PO RECORD 
"RTN","PRCHL5",76,0)
 ;;29;END DATE FOR SERVICE ORDER 
"RTN","PRCHL5",77,0)
 ;;30;AUTO ACCRUE 
"RTN","PRCHL5",78,0)
 ;;31;SUBSTATION
"RTN","PRCHL5",79,0)
 ;;42;RFQ NBR
"RTN","PRCHL5",80,0)
 ;;44;DISPUTED
"RTN","PRCHL5",81,0)
 ;;47;DELIVERY ORDER 
"RTN","PRCHL5",82,0)
 ;;48;TYPE OF ORDER
"RTN","PRCHL5",83,0)
 ;;51;SORT GROUP 
"RTN","PRCHL5",84,0)
 ;;52;CLASSIFICATION OF REQUEST
"RTN","PRCHL5",85,0)
 ;;53;PCDO VENDOR 
"RTN","PRCHL5",86,0)
 ;;54;RECEIVING REQUIRED?
"RTN","PRCHL5",87,0)
 ;;56;PURCHASE CARD USER
"RTN","PRCHL5",88,0)
 ;;57;APPROVE RECONCILIATION USER 
"RTN","PRCHL5",89,0)
 ;;58;DATE RECONCILED 
"RTN","PRCHL5",90,0)
 ;;60;PURCHASE COST 
"RTN","PRCHL5",91,0)
 ;;61;PURCHASE CARD HOLDER
"RTN","PRCHL5",92,0)
 ;;62;PCDO 2237 
"RTN","PRCHL5",93,0)
 ;;63;PROCESSING REQUIRED IN FISCAL 
"RTN","PRCHL5",94,0)
 ;;64;FREE TEXT VENDOR
"RTN","PRCHL5",95,0)
 ;;65;INTERFACE PACKAGE PREFIX 
"RTN","PRCHL5",96,0)
 ;;70;DEPARTMENT NUMBER
"RTN","PRCHL5",97,0)
 ;;71;DOCUMENT IDENTIFIER CODE
"RTN","PRCHL5",98,0)
 ;;72;ROUTING INDENTIFIER CODE 
"RTN","PRCHL5",99,0)
 ;;72.4;ACTIVITY ADDRESS CODE
"RTN","PRCHL5",100,0)
 ;;73;DEPT.DESIGNATION
"RTN","PRCHL5",101,0)
 ;;73.4;SPECIAL CODE 
"RTN","PRCHL5",102,0)
 ;;74;SIGNAL CODE
"RTN","PRCHL5",103,0)
 ;;75;FUND CODE 
"RTN","PRCHL5",104,0)
 ;;76;DISTRIBUTION CODE 
"RTN","PRCHL5",105,0)
 ;;77;PROJECT CODE 
"RTN","PRCHL5",106,0)
 ;;78;PRIORITY CODE
"RTN","PRCHL5",107,0)
 ;;79;ADVICE CODE
"RTN","PRCHL5",108,0)
 ;;80;MEDIA & STATUS CODE 
"RTN","PRCHL5",109,0)
 ;;83;REASON CODE 
"RTN","PRCHL5",110,0)
 ;;91;TOTAL AMOUNT
"RTN","PRCHL5",111,0)
 ;;92;NET AMOUNT 
"RTN","PRCHL5",112,0)
 ;;93;LIQUIDATED AMOUNT
"RTN","PRCHL5",113,0)
 ;;94;ACTUAL 1358 BALANCE
"RTN","PRCHL5",114,0)
 ;;95;FISCAL 1358 BALANCE 
"RTN","PRCHL5",115,0)
 ;;96;ESTIMATED 1358 BALANCE 
"RTN","PRCHL5",116,0)
 ;;96.5;CONVERTED 1358 
"RTN","PRCHL5",117,0)
 ;;96.6;AUTH. AMOUNT REMAINING
"RTN","PRCHL5",118,0)
 ;;96.7;BULLETIN SENT
"RTN","PRCHL5",119,0)
 ;;97;PROMPT PAY TYPE 
"RTN","PRCHL5",120,0)
 ;;101;PAYABLE CODE 
"RTN","PRCHL5",121,0)
 ;;102;DOCUMENT IDENTIFIER/COMMON NO. 
"RTN","PRCHL5",122,0)
 ;;102.4;REQUISITION NO.
"RTN","PRCHL5",123,0)
 ;;102.5;ISSUE VOUCHER NO.
"RTN","PRCHL5",124,0)
 ;;102.6;ISSUE VOUCHER NO.
"RTN","PRCHL5",125,0)
 ;;103;LOG BATCH NO.
"RTN","PRCHL5",126,0)
 ;;103.5;LOG ACQ.CODE SHEETS DONE?
"RTN","PRCHL5",127,0)
 ;;104;LOG CODE SHEETS SENT BY
"RTN","PRCHL5",128,0)
 ;;105;LOG CODE SH. VALIDATION CODE
"RTN","PRCHL5",129,0)
 ;;105.5;LOG CS VALIDATION VERSION
"RTN","PRCHL5",130,0)
 ;;106;DATE SIGNED 
"RTN","PRCHL5",131,0)
 ;;106.4;SUPPLY FUND ORDER OBLIGATED?
"RTN","PRCHL5",132,0)
 ;;107;RELEASING FACILITY NUMBER
"RTN","PRCHL5",133,0)
 ;;108;CASCA PROJECT NO. 
"RTN","PRCHL5",134,0)
 ;;109;CASCA TRANS TYPE 
"RTN","PRCHL5",135,0)
 ;;111;ISMS BATCH NO.
"RTN","PRCHL5",136,0)
 ;;112;ISMS CODE SHEETS DONE?
"RTN","PRCHL5",137,0)
 ;;113;ISMS CODE SHEETS SENT BY
"RTN","PRCHL5",138,0)
 ;;114.5;ISMS VALIDATION VERSION
"RTN","PRCHL5",139,0)
 ;;115;ISMS DATE SIGNED
"RTN","PRCHL5",140,0)
 ;;116;DO YOU WANT TO SEND THIS EDI?
"RTN","PRCHL5",141,0)
 ;;500.01;BILL #
"RTN","PRCHL5",142,0)
 ;;501;CERTIFIED P.O.
"RTN","PRCHL5",143,0)
 ;;117;REASON NOT COMPETED
"RTN","PRCHL5",144,0)
 ;;118;NUMBER OF OFFERS
"RTN","PRCHL5",145,0)
 ;;119;PRE AWARD SYNOPSIS
"RTN","PRCHL5",146,0)
 ;;120;ALTERNATIVE ADVERTISING
"RTN","PRCHL5",147,0)
 ;;121;SOLICITATION PROCEDURE
"RTN","PRCHL5",148,0)
 ;;122;EVALUATED PREFERENCE
"RTN","PRCHL5",149,0)
 ;;123;FUNDING AGENCY CODE
"RTN","PRCHL5",150,0)
 ;;124;FUNDING AGENCY OFFICE CODE
"RTN","PRCHL5",151,0)
 ;;125;MULTIYEAR
"RTN","PRCHL5",152,0)
 ;;126;EPA DESIGNATED PRODUCT
"RTN","PRCHL5",153,0)
 ;;127;CONTRACT BUNDLING
"RTN","PRCHL5",154,0)
 ;;128;EXTENT COMPETED
"RTN","PRCHL5",155,0)
 ;;129;PERF. BASED SERVICE CONTRACT
"RTN","PRCHL5",156,0)
 ;;130;CLINGER COHEN
"RTN","PRCHL5",157,0)
 ;;131;PLACE OF PERF. THIS STATION?
"RTN","PRCHL5",158,0)
 ;;132;PLACE OF PERFORMANCE
"RTN","PRCHL5",159,0)
 ;;133;SEND TO FPDS?
"RTN","PRCHL5",160,0)
 ;END
"RTN","PRCHL6")
0^3^B11788560^n/a
"RTN","PRCHL6",1,0)
PRCHL6 ;VACO/HNC/VAC - ITEM DETAIL GRID ; 1/31/07 3:38pm
"RTN","PRCHL6",2,0)
 ;;5.1;IFCAP;**103**;Oct 20, 2000;Build 25
"RTN","PRCHL6",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified
"RTN","PRCHL6",4,0)
 ;DBIA# 4345 giving permission to reference Prosthetics data
"RTN","PRCHL6",5,0)
 ;VAC - Limit number of PO line items to 80 or less
"RTN","PRCHL6",6,0)
 ;
"RTN","PRCHL6",7,0)
 ;piece 1 - line item number
"RTN","PRCHL6",8,0)
 ;piece 2 - Item Master number
"RTN","PRCHL6",9,0)
 ;piece 3 - qty
"RTN","PRCHL6",10,0)
 ;piece 4 - unit of purchase
"RTN","PRCHL6",11,0)
 ;piece 5 - BOC
"RTN","PRCHL6",12,0)
 ;piece 6 - contract BOA
"RTN","PRCHL6",13,0)
 ;piece 7 - actual unit cost
"RTN","PRCHL6",14,0)
 ;piece 8 - fed supply classification
"RTN","PRCHL6",15,0)
 ;piece 9 - vendor stock number
"RTN","PRCHL6",16,0)
 ;piece 10 - unit conversion factor
"RTN","PRCHL6",17,0)
 ;piece 11 - total cost
"RTN","PRCHL6",18,0)
 ;piece 12 - nif number
"RTN","PRCHL6",19,0)
 ;piece 13 - item master short description 441- .05
"RTN","PRCHL6",20,0)
 ;
"RTN","PRCHL6",21,0)
 ;roll and scroll testing entry point
"RTN","PRCHL6",22,0)
A1(IEN) G A2
"RTN","PRCHL6",23,0)
 ;
"RTN","PRCHL6",24,0)
EN(RESULTS,IEN) ;broker entry point
"RTN","PRCHL6",25,0)
A2 ;
"RTN","PRCHL6",26,0)
 I IEN="" S RESULTS(0)="No Data"_U_"No Items Found for this PO" Q
"RTN","PRCHL6",27,0)
 ;First check number of line items on PO, stop if more than 80
"RTN","PRCHL6",28,0)
 I $P(^PRC(442,IEN,0),U,14)>80 S RESULTS(0)="MORE THAN 80^TOO MANY" Q
"RTN","PRCHL6",29,0)
 S CNT=0
"RTN","PRCHL6",30,0)
 D GETS^DIQ(442,IEN,"40*;.01","EN","ITM")
"RTN","PRCHL6",31,0)
 S PRCHPO=$G(ITM("442",IEN_",",".01","E"))
"RTN","PRCHL6",32,0)
 S PRCHPIEN=""
"RTN","PRCHL6",33,0)
 I PRCHPO'="" S PRCHPIEN=$O(^RMPR(664,"G",$P(PRCHPO,"-",2),PRCHPIEN))
"RTN","PRCHL6",34,0)
 I PRCHPIEN'="" D GETS^DIQ(664,PRCHPIEN,"2*;11;12","E","PITMSTR")
"RTN","PRCHL6",35,0)
 I $D(PITMSTR) D
"RTN","PRCHL6",36,0)
 .;Prosthetic item
"RTN","PRCHL6",37,0)
 .S PRCHB="" F  S PRCHB=$O(PITMSTR(664.02,PRCHB)) Q:'PRCHB  D
"RTN","PRCHL6",38,0)
 .  .S QTY=$G(PITMSTR(664.02,PRCHB,3,"E"))
"RTN","PRCHL6",39,0)
 .  .S UOP=$G(PITMSTR(664.02,PRCHB,4,"E"))
"RTN","PRCHL6",40,0)
 .  .S CBOA=$G(PITMSTR(664.02,PRCHB,13,"E"))
"RTN","PRCHL6",41,0)
 .  .S ITMD=$G(PITMSTR(664.02,PRCHB,1,"E"))
"RTN","PRCHL6",42,0)
 .  .S AUC=$G(PITMSTR(664.02,PRCHB,6,"E"))
"RTN","PRCHL6",43,0)
 .  .I AUC="" S AUC=$G(PITMSTR(664.02,PRCHB,2,"E"))
"RTN","PRCHL6",44,0)
 .  .S HCPCS=$G(PITMSTR(664.02,PRCHB,16,"E"))
"RTN","PRCHL6",45,0)
 .  .S VSN=$G(PITMSTR(664.02,PRCHB,15.4,"E"))
"RTN","PRCHL6",46,0)
 .  .S TCST=QTY*AUC
"RTN","PRCHL6",47,0)
 .  .S CNT=CNT+1
"RTN","PRCHL6",48,0)
 .  .S RESULTS(CNT)="P "_CNT_U_HCPCS_U_QTY_U_UOP_U_""_U_CBOA_U_AUC_U_""_U_""_U_1_U_TCST_U_""_U_ITMD
"RTN","PRCHL6",49,0)
 . S SHIP="",SHIPF=""
"RTN","PRCHL6",50,0)
 . S SHIP=$G(PITMSTR(664,PRCHPIEN_",",11,"E"))
"RTN","PRCHL6",51,0)
 . S SHIPF=$G(PITMSTR(664,PRCHPIEN_",",12,"E"))
"RTN","PRCHL6",52,0)
 . I SHIPF'="" S SHIP=SHIPF
"RTN","PRCHL6",53,0)
 . I SHIP'="" S CNT=CNT+1,RESULTS(CNT)="P "_CNT_U_"SHIPPING"_U_""_U_""_U_""_U_""_U_""_U_""_U_""_U_1_U_SHIP_U_""_U_"Shipping Cost"
"RTN","PRCHL6",54,0)
 S B="" F  S B=$O(ITM(442.01,B)) Q:'B  D
"RTN","PRCHL6",55,0)
 . S IFITM=$G(ITM(442.01,B,1.5,"E"))
"RTN","PRCHL6",56,0)
 . D GETS^DIQ(441,IFITM,".01;.05;51","E","ITMSTR")
"RTN","PRCHL6",57,0)
 . S ITMD=$G(ITMSTR(441,IFITM_",",.05,"E"))
"RTN","PRCHL6",58,0)
 . S IFITM1=$G(ITMSTR(441,IFITM_",",.01,"E"))
"RTN","PRCHL6",59,0)
 . S NIF=$G(ITMSTR(441,IFITM_",",51,"E"))
"RTN","PRCHL6",60,0)
 . S LICNT=$P(B,",",1)
"RTN","PRCHL6",61,0)
 . S QTY=$G(ITM(442.01,B,2,"E"))
"RTN","PRCHL6",62,0)
 . S UOP=$G(ITM(442.01,B,3,"E"))
"RTN","PRCHL6",63,0)
 . S BOC=$G(ITM(442.01,B,3.5,"E"))
"RTN","PRCHL6",64,0)
 . S CBOA=$G(ITM(442.01,B,4,"E"))
"RTN","PRCHL6",65,0)
 . S AUC=$TR($G(ITM(442.01,B,5,"E")),"$","")
"RTN","PRCHL6",66,0)
 . S FSC=$G(ITM(442.01,B,8,"E"))
"RTN","PRCHL6",67,0)
 . S VSN=$G(ITM(442.01,B,9,"E"))
"RTN","PRCHL6",68,0)
 . S UCF=$G(ITM(442.01,B,9.7,"E"))
"RTN","PRCHL6",69,0)
 . S TCST=$G(ITM(442.01,B,15,"E"))
"RTN","PRCHL6",70,0)
 . S ITMDD=$G(ITM(442.01,B,1,1))
"RTN","PRCHL6",71,0)
 . I ITMD'="" S ITMD=ITMD_" "
"RTN","PRCHL6",72,0)
 . S ITMD=ITMD_"1st Line: "_ITMDD
"RTN","PRCHL6",73,0)
 . K ITMDD
"RTN","PRCHL6",74,0)
 . S CNT=CNT+1
"RTN","PRCHL6",75,0)
 . S RESULTS(CNT)="I "_LICNT_U_IFITM1_U_QTY_U_UOP_U_BOC_U_CBOA_U_AUC_U_FSC_U_VSN_U_UCF_U_TCST_U_NIF_U_ITMD
"RTN","PRCHL6",76,0)
END I '$D(RESULTS) S RESULTS(1)="No Data"_U_"No Item Detail"
"RTN","PRCHL6",77,0)
 K IEN,CNT,ITM,ITMSTR,IFITM,ITMD,IFITM1,LICNT,QTY,UOP,BOC,CBOA,AUC,FSC,VSN,UCF,TCST,NIF,B,PRCHPO,PITMSTR,PRCHB,PRCHPIEN,HCPCS,SHIP,SHIPF
"RTN","PRCHL6",78,0)
 Q
"RTN","PRCHL6",79,0)
 ;END
"VER")
8.0^22.0
"BLD",5006,6)
^92
**END**
**END**
