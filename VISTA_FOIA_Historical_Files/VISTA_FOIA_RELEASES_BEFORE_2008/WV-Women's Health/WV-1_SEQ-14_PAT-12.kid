Released WV*1*12 SEQ #14
Extracted from mail message
**KIDS**:WV*1.0*12^

**INSTALL NAME**
WV*1.0*12
"BLD",2928,0)
WV*1.0*12^WOMEN'S HEALTH^0^3010821^y
"BLD",2928,1,0)
^^2^2^3010718^^
"BLD",2928,1,1,0)
Please read the WV*1*12 patch description on FORUM for an explanation of
"BLD",2928,1,2,0)
what this patch does.
"BLD",2928,4,0)
^9.64PA^^
"BLD",2928,"ABNS",0)
^9.66A^^
"BLD",2928,"ABPKG")
^n
"BLD",2928,"KRN",0)
^9.67PA^19^17
"BLD",2928,"KRN",.4,0)
.4
"BLD",2928,"KRN",.401,0)
.401
"BLD",2928,"KRN",.402,0)
.402
"BLD",2928,"KRN",.403,0)
.403
"BLD",2928,"KRN",.5,0)
.5
"BLD",2928,"KRN",.84,0)
.84
"BLD",2928,"KRN",3.6,0)
3.6
"BLD",2928,"KRN",3.8,0)
3.8
"BLD",2928,"KRN",9.2,0)
9.2
"BLD",2928,"KRN",9.8,0)
9.8
"BLD",2928,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",2928,"KRN",9.8,"NM",1,0)
WVRPPCD^^0^B29444096
"BLD",2928,"KRN",9.8,"NM",2,0)
WVRPPCD1^^0^B47542148
"BLD",2928,"KRN",9.8,"NM",3,0)
WVRPPCD2^^0^B47730542
"BLD",2928,"KRN",9.8,"NM",4,0)
WVRPPCD3^^0^B23259227
"BLD",2928,"KRN",9.8,"NM","B","WVRPPCD",1)

"BLD",2928,"KRN",9.8,"NM","B","WVRPPCD1",2)

"BLD",2928,"KRN",9.8,"NM","B","WVRPPCD2",3)

"BLD",2928,"KRN",9.8,"NM","B","WVRPPCD3",4)

"BLD",2928,"KRN",19,0)
19
"BLD",2928,"KRN",19.1,0)
19.1
"BLD",2928,"KRN",101,0)
101
"BLD",2928,"KRN",409.61,0)
409.61
"BLD",2928,"KRN",771,0)
771
"BLD",2928,"KRN",870,0)
870
"BLD",2928,"KRN",8994,0)
8994
"BLD",2928,"KRN","B",.4,.4)

"BLD",2928,"KRN","B",.401,.401)

"BLD",2928,"KRN","B",.402,.402)

"BLD",2928,"KRN","B",.403,.403)

"BLD",2928,"KRN","B",.5,.5)

"BLD",2928,"KRN","B",.84,.84)

"BLD",2928,"KRN","B",3.6,3.6)

"BLD",2928,"KRN","B",3.8,3.8)

"BLD",2928,"KRN","B",9.2,9.2)

"BLD",2928,"KRN","B",9.8,9.8)

"BLD",2928,"KRN","B",19,19)

"BLD",2928,"KRN","B",19.1,19.1)

"BLD",2928,"KRN","B",101,101)

"BLD",2928,"KRN","B",409.61,409.61)

"BLD",2928,"KRN","B",771,771)

"BLD",2928,"KRN","B",870,870)

"BLD",2928,"KRN","B",8994,8994)

"BLD",2928,"QUES",0)
^9.62^^
"BLD",2928,"REQB",0)
^9.611^2^2
"BLD",2928,"REQB",1,0)
WV*1.0*4^2
"BLD",2928,"REQB",2,0)
WV*1.0*14^2
"BLD",2928,"REQB","B","WV*1.0*14",2)

"BLD",2928,"REQB","B","WV*1.0*4",1)

"MBREQ")
0
"PKG",364,-1)
1^1
"PKG",364,0)
WOMEN'S HEALTH^WV^Tracks health issues specific to female patients.
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
1.0^2980925^2980508^547
"PKG",364,22,1,"PAH",1,0)
12^3010821
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^3010821
"PKG",364,22,1,"PAH",1,1,1,0)
Please read the WV*1*12 patch description on FORUM for an explanation of
"PKG",364,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","WVRPPCD")
0^1^B29444096
"RTN","WVRPPCD",1,0)
WVRPPCD ;HCIOFO/FT,JR-REPORT: PROCEDURES STATISTICS; ;7/23/01  13:33
"RTN","WVRPPCD",2,0)
 ;;1.0;WOMEN'S HEALTH;**12**;Sep 30, 1998
"RTN","WVRPPCD",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVRPPCD",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPPCD",5,0)
 ;;  CALLED BY OPTION: "WV PRINT PROCEDURE STATS".
"RTN","WVRPPCD",6,0)
 ;
"RTN","WVRPPCD",7,0)
 ; This routine uses the following IAs:
"RTN","WVRPPCD",8,0)
 ; <NONE>
"RTN","WVRPPCD",9,0)
 ;
"RTN","WVRPPCD",10,0)
 N N,R,X,T,Y,R,PG,PA,JC,J,TR,TR2,JR,JR2,CM,CM2,WVJRC,FE,FI,WVSB
"RTN","WVRPPCD",11,0)
 K ^TMP("WVRES",$J),^TMP("WVAR",$J),^TMP("WVNOHCF",$J)
"RTN","WVRPPCD",12,0)
 S WVPOP=0 K WVRES
"RTN","WVRPPCD",13,0)
 D TITLE^WVUTL5("PROCEDURE STATISTICS REPORT")
"RTN","WVRPPCD",14,0)
 D DATES                  G:WVPOP EXIT
"RTN","WVRPPCD",15,0)
 D SELECT                 G:WVPOP EXIT
"RTN","WVRPPCD",16,0)
 D BYAGE(.WVAGRG,.WVPOP)  G:WVPOP EXIT
"RTN","WVRPPCD",17,0)
 D FAC                    G:WVPOP EXIT
"RTN","WVRPPCD",18,0)
 D DEVICE                 G:WVPOP EXIT
"RTN","WVRPPCD",19,0)
 D ^WVRPPCD2
"RTN","WVRPPCD",20,0)
 D COPYGBL
"RTN","WVRPPCD",21,0)
 D ^WVRPPCD1
"RTN","WVRPPCD",22,0)
 ;
"RTN","WVRPPCD",23,0)
EXIT ;EP
"RTN","WVRPPCD",24,0)
 K ^TMP("WVRES",$J),^TMP("WVAR",$J),^TMP("WVNOHCF",$J)
"RTN","WVRPPCD",25,0)
 D KILLALL^WVUTL8
"RTN","WVRPPCD",26,0)
 Q
"RTN","WVRPPCD",27,0)
 ;
"RTN","WVRPPCD",28,0)
DATES ;EP
"RTN","WVRPPCD",29,0)
 ;---> ASK DATE RANGE.  RETURN DATES IN WVBEGDT AND WVENDDT.
"RTN","WVRPPCD",30,0)
 D ASKDATES^WVUTL3(.WVBEGDT,.WVENDDT,.WVPOP,"T-365","T")
"RTN","WVRPPCD",31,0)
 Q
"RTN","WVRPPCD",32,0)
 ;
"RTN","WVRPPCD",33,0)
SELECT ;EP
"RTN","WVRPPCD",34,0)
 D SELECT^WVSELECT("Procedure Type",790.2,"WVARR","","",.WVPOP)
"RTN","WVRPPCD",35,0)
 Q
"RTN","WVRPPCD",36,0)
 ;
"RTN","WVRPPCD",37,0)
BYAGE(WVAGRG,WVPOP) ;EP
"RTN","WVRPPCD",38,0)
 ;---> RETURN AGE RANGE IN WVAGRG.
"RTN","WVRPPCD",39,0)
 N DIR,DIRUT,Y S WVPOP=0
"RTN","WVRPPCD",40,0)
 W !!?3,"Do you wish to display statistics by age group?"
"RTN","WVRPPCD",41,0)
 S DIR(0)="Y",DIR("B")="YES" D HELP1
"RTN","WVRPPCD",42,0)
 S DIR("A")="   Enter Yes or No"
"RTN","WVRPPCD",43,0)
 D ^DIR K DIR W !
"RTN","WVRPPCD",44,0)
 S:$D(DIRUT) WVPOP=1
"RTN","WVRPPCD",45,0)
 ;---> IF NOT DISPLAYING BY AGE GROUP, SET WVAGRG (AGE RANGE)=1, QUIT.
"RTN","WVRPPCD",46,0)
 I 'Y S WVAGRG=1 Q
"RTN","WVRPPCD",47,0)
BYAGE1 ;
"RTN","WVRPPCD",48,0)
 W !?5,"Enter the age ranges you wish to select for in the form of:"
"RTN","WVRPPCD",49,0)
 W !?5,"  15-29,30-39,40-105"
"RTN","WVRPPCD",50,0)
 W !?5,"Use a dash ""-"" to separate the limits of a range,"
"RTN","WVRPPCD",51,0)
 W !?5,"use a comma to separate the different ranges."
"RTN","WVRPPCD",52,0)
 W !!?5,"NOTE: Patient ages will reflect the age they were on the"
"RTN","WVRPPCD",53,0)
 W !?5,"      dates of their procedures.  Patient ages will NOT"
"RTN","WVRPPCD",54,0)
 W !?5,"      necessarily be their ages today.",!
"RTN","WVRPPCD",55,0)
 K DIR D HELP2
"RTN","WVRPPCD",56,0)
 S DIR(0)="FOA",DIR("A")="     Enter age ranges: "
"RTN","WVRPPCD",57,0)
 S:$D(^WV(790.72,DUZ,0)) DIR("B")=$P(^(0),U,2)
"RTN","WVRPPCD",58,0)
 D ^DIR K DIR
"RTN","WVRPPCD",59,0)
 I $D(DIRUT) S WVPOP=1 Q
"RTN","WVRPPCD",60,0)
 D CHECK(.Y)
"RTN","WVRPPCD",61,0)
 I Y="" D  G BYAGE1
"RTN","WVRPPCD",62,0)
 .W !!?5,"* INVALID AGE RANGE.  Please begin again. (Enter ? for help.)"
"RTN","WVRPPCD",63,0)
 ;---> WVAGRG=SELECTED AGE RANGE(S).
"RTN","WVRPPCD",64,0)
 S WVAGRG=Y
"RTN","WVRPPCD",65,0)
 D DIC^WVFMAN(790.72,"L",.Y,"","","","`"_DUZ)
"RTN","WVRPPCD",66,0)
 Q:Y<0
"RTN","WVRPPCD",67,0)
 D DIE^WVFMAN(790.72,".02////"_WVAGRG,+Y,.WVPOP,1)
"RTN","WVRPPCD",68,0)
 Q
"RTN","WVRPPCD",69,0)
 ;
"RTN","WVRPPCD",70,0)
FAC ; Select one or more facilities
"RTN","WVRPPCD",71,0)
 D SELECT^WVSELECT("Facility",790.02,"WVSB","",DUZ(2),.WVPOP)
"RTN","WVRPPCD",72,0)
 Q
"RTN","WVRPPCD",73,0)
DEVICE ;EP
"RTN","WVRPPCD",74,0)
 ;---> GET DEVICE AND POSSIBLY QUEUE TO TASKMAN.
"RTN","WVRPPCD",75,0)
 S ZTDESC="Procedure Statistics Report"
"RTN","WVRPPCD",76,0)
 S ZTRTN="DEQUEUE^WVRPPCD"
"RTN","WVRPPCD",77,0)
 F WVSV="AGRG","BEGDT","ENDDT" D
"RTN","WVRPPCD",78,0)
 .I $D(@("WV"_WVSV)) S ZTSAVE("WV"_WVSV)=""
"RTN","WVRPPCD",79,0)
 ;---> SAVE PROCEDURES ARRAY.
"RTN","WVRPPCD",80,0)
 I $D(WVARR) N N S N=0 F  S N=$O(WVARR(N)) Q:N=""  D
"RTN","WVRPPCD",81,0)
 .S ZTSAVE("WVARR("""_N_""")")=""
"RTN","WVRPPCD",82,0)
 ; Save Facility array
"RTN","WVRPPCD",83,0)
 I $D(WVSB) N N S N=0 F  S N=$O(WVSB(N)) Q:N=""  D
"RTN","WVRPPCD",84,0)
 .S ZTSAVE("WVSB("""_N_""")")=""
"RTN","WVRPPCD",85,0)
 .Q
"RTN","WVRPPCD",86,0)
 D ZIS^WVUTL2(.WVPOP,1)
"RTN","WVRPPCD",87,0)
 Q
"RTN","WVRPPCD",88,0)
 ;
"RTN","WVRPPCD",89,0)
COPYGBL ;EP
"RTN","WVRPPCD",90,0)
 ;---> COPY ^TMP("WVRES",$J,"R") TO ^TMP("WVAR",$J, TO MAKE IT FLAT.
"RTN","WVRPPCD",91,0)
 N FE,FI,I,M,N K WVAR
"RTN","WVRPPCD",92,0)
 S I=0,FE=""
"RTN","WVRPPCD",93,0)
 F  S FE=$O(^TMP("WVRES",$J,"R",FE)) Q:FE=""  S FI=0 F  S FI=$O(^TMP("WVRES",$J,"R",FE,FI)) Q:'FI  S N=0 F  S N=$O(^TMP("WVRES",$J,"R",FE,FI,N)) Q:N=""  D
"RTN","WVRPPCD",94,0)
 .S M=0
"RTN","WVRPPCD",95,0)
 .F  S M=$O(^TMP("WVRES",$J,"R",FE,FI,N,M)) Q:M=""  D
"RTN","WVRPPCD",96,0)
 ..S I=I+1,^TMP("WVAR",$J,FE,FI,I)=^TMP("WVRES",$J,"R",FE,FI,N,M)
"RTN","WVRPPCD",97,0)
 Q
"RTN","WVRPPCD",98,0)
 ;
"RTN","WVRPPCD",99,0)
DEQUEUE ;EP
"RTN","WVRPPCD",100,0)
 ;---> TASKMAN QUEUE OF PRINTOUT.
"RTN","WVRPPCD",101,0)
 D SETVARS^WVUTL5,^WVRPPCD2
"RTN","WVRPPCD",102,0)
 I $G(ZTSTOP)=1 D EXIT Q  ;user requested the job to stop
"RTN","WVRPPCD",103,0)
 D COPYGBL,^WVRPPCD1,EXIT
"RTN","WVRPPCD",104,0)
 Q
"RTN","WVRPPCD",105,0)
 ;
"RTN","WVRPPCD",106,0)
HELP1 ;EP
"RTN","WVRPPCD",107,0)
 ;;Answer "YES" to display statistics by age group.  If you choose
"RTN","WVRPPCD",108,0)
 ;;to display by age group, you will be given the opportunity to
"RTN","WVRPPCD",109,0)
 ;;select the age ranges.  For example, you might choose to display
"RTN","WVRPPCD",110,0)
 ;;from ages 15-40,41-65,65-99.
"RTN","WVRPPCD",111,0)
 ;;Answer "NO" to display statistics without grouping by age.
"RTN","WVRPPCD",112,0)
 S WVTAB=5,WVLINL="HELP1" D HELPTX
"RTN","WVRPPCD",113,0)
 Q
"RTN","WVRPPCD",114,0)
 ;
"RTN","WVRPPCD",115,0)
HELP2 ;EP
"RTN","WVRPPCD",116,0)
 ;;Enter each age range you wish to report on by entering the
"RTN","WVRPPCD",117,0)
 ;;earlier age-dash-older age.  For example, 20-29 would report
"RTN","WVRPPCD",118,0)
 ;;on all patients between the ages of 20 and 29 inclusive.
"RTN","WVRPPCD",119,0)
 ;;You may select as many age ranges as you wish.  Age ranges must
"RTN","WVRPPCD",120,0)
 ;;be separated by commas.  For example: 15-19,20-29,30-39
"RTN","WVRPPCD",121,0)
 ;;To select only one age, simply enter that age, with no dashes,
"RTN","WVRPPCD",122,0)
 ;;for example, 30 would report only on women who were 30 years
"RTN","WVRPPCD",123,0)
 ;;of age.
"RTN","WVRPPCD",124,0)
 S WVTAB=5,WVLINL="HELP2" D HELPTX
"RTN","WVRPPCD",125,0)
 Q
"RTN","WVRPPCD",126,0)
 ;
"RTN","WVRPPCD",127,0)
HELPTX ;EP
"RTN","WVRPPCD",128,0)
 ;---> CREATES DIR ARRAY FOR DIR.  REQUIRED VARIABLES: WVTAB,WVLINL.
"RTN","WVRPPCD",129,0)
 N I,T,X S T=$$REPEAT^XLFSTR(" ",WVTAB)
"RTN","WVRPPCD",130,0)
 F I=1:1 S X=$T(@WVLINL+I) Q:X'[";;"  S DIR("?",I)=T_$P(X,";;",2)
"RTN","WVRPPCD",131,0)
 S DIR("?")=DIR("?",I-1) K DIR("?",I-1)
"RTN","WVRPPCD",132,0)
 Q
"RTN","WVRPPCD",133,0)
 ;
"RTN","WVRPPCD",134,0)
CHECK(X) ;EP
"RTN","WVRPPCD",135,0)
 ;---> CHECK SYNTAX OF AGE RANGE STRING.
"RTN","WVRPPCD",136,0)
 ;---> IF X=ONE AGE ONLY, SET IT IN THE FORM X-X AND QUIT.
"RTN","WVRPPCD",137,0)
 I X?1N.N S X=X_"-"_X Q
"RTN","WVRPPCD",138,0)
 ;
"RTN","WVRPPCD",139,0)
 N WV1,FAIL,I,Y,Y1,Y2
"RTN","WVRPPCD",140,0)
 S FAIL=0
"RTN","WVRPPCD",141,0)
 ;---> CHECK EACH RANGE.
"RTN","WVRPPCD",142,0)
 F I=1:1:$L(X,",") S Y=$P(X,",",I) D  Q:FAIL
"RTN","WVRPPCD",143,0)
 .S Y1=$P(Y,"-"),Y2=$P(Y,"-",2)
"RTN","WVRPPCD",144,0)
 .;---> EACH END OF EACH RANGE SHOULD BE A NUMBER.
"RTN","WVRPPCD",145,0)
 .I (Y1'?1N.N)!(Y2'?1N.N) S FAIL=1 Q
"RTN","WVRPPCD",146,0)
 .;---> THE LOWER NUMBER SHOULD BE FIRST.
"RTN","WVRPPCD",147,0)
 .I Y2<Y1 S FAIL=1
"RTN","WVRPPCD",148,0)
 I FAIL S X="" Q
"RTN","WVRPPCD",149,0)
 ;
"RTN","WVRPPCD",150,0)
 ;---> MAKE SURE ORDER IS FROM LOWEST (YOUNGEST) TO HIGHEST (OLDEST).
"RTN","WVRPPCD",151,0)
 F I=1:1:$L(X,",") S Y=$P(X,",",I),Y1=$P(Y,"-"),WV1(Y1)=Y
"RTN","WVRPPCD",152,0)
 S N=0,X=""
"RTN","WVRPPCD",153,0)
 F  S N=$O(WV1(N)) Q:'N  S X=X_WV1(N)_","
"RTN","WVRPPCD",154,0)
 S:$E(X,$L(X))="," X=$E(X,1,($L(X)-1))
"RTN","WVRPPCD",155,0)
 Q
"RTN","WVRPPCD1")
0^2^B47542148
"RTN","WVRPPCD1",1,0)
WVRPPCD1 ;HCIOFO/FT,JR-REPORT: PROCEDURE STATISTICS; ;7/24/01  13:55
"RTN","WVRPPCD1",2,0)
 ;;1.0;WOMEN'S HEALTH;**4,12**;Sep 30, 1998
"RTN","WVRPPCD1",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVRPPCD1",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPPCD1",5,0)
 ;;  DISPLAY CODE FOR PROCEDURE STATISTICS REPORT.  CALLED BY WVRPPCD.
"RTN","WVRPPCD1",6,0)
 ;
"RTN","WVRPPCD1",7,0)
 ; This routine uses the following IAs:
"RTN","WVRPPCD1",8,0)
 ; <NONE>
"RTN","WVRPPCD1",9,0)
 ;
"RTN","WVRPPCD1",10,0)
DISPLAY ;EP
"RTN","WVRPPCD1",11,0)
 ;---> WVTITLE=TITLE AT TOP OF DISPLAY HEADER.
"RTN","WVRPPCD1",12,0)
 ;---> WVSUBH=CODE TO EXECUTE FOR SUBHEADER (COLUMN TITLES).
"RTN","WVRPPCD1",13,0)
 ;---> WVCRT=1 IF OUTPUT IS TO SCREEN (ALLOWS SELECTIONS TO EDIT).
"RTN","WVRPPCD1",14,0)
 ;
"RTN","WVRPPCD1",15,0)
 U IO
"RTN","WVRPPCD1",16,0)
 W:$E(IOST)="C" @IOF
"RTN","WVRPPCD1",17,0)
 S WVTITLE="* * *  WOMEN'S HEALTH: PROCEDURE STATISTICS REPORT  * * *"
"RTN","WVRPPCD1",18,0)
 D CENTERT^WVUTL5(.WVTITLE)
"RTN","WVRPPCD1",19,0)
 S WVSUBH="SUBHEAD^WVRPPCD1"
"RTN","WVRPPCD1",20,0)
 D TOPHEAD^WVUTL7
"RTN","WVRPPCD1",21,0)
 S (WVPOP,N)=0
"RTN","WVRPPCD1",22,0)
 ;
"RTN","WVRPPCD1",23,0)
DISPLAY1 ;EP
"RTN","WVRPPCD1",24,0)
 N WVFAC,WVSB1
"RTN","WVRPPCD1",25,0)
 S FE="",WVFAC=0
"RTN","WVRPPCD1",26,0)
 F  S FE=$O(^TMP("WVAR",$J,FE)) Q:FE=""!(WVPOP)!($G(ZTSTOP)=1)  S FI=0 F  S FI=$O(^TMP("WVAR",$J,FE,FI)) Q:'FI!(WVPOP)!($G(ZTSTOP)=1)  D
"RTN","WVRPPCD1",27,0)
 .I WVFAC'=FI D:WVCRT&(WVFAC) DIRZ^WVUTL3 Q:WVPOP  S WVFAC=FI D HEADER3 Q:$G(ZTSTOP)=1
"RTN","WVRPPCD1",28,0)
 .S N=0 F  S N=$O(^TMP("WVAR",$J,FE,FI,N)) Q:N=""!(WVPOP)  D
"RTN","WVRPPCD1",29,0)
 ..I $Y+12>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D  Q:$G(ZTSTOP)=1
"RTN","WVRPPCD1",30,0)
 ...S WVPAGE=WVPAGE+1
"RTN","WVRPPCD1",31,0)
 ...D HEADER3 Q:$G(ZTSTOP)=1
"RTN","WVRPPCD1",32,0)
 ..S Y=^TMP("WVAR",$J,FE,FI,N)
"RTN","WVRPPCD1",33,0)
 ..S WVARJ=$S($P(Y,U)["MAMMOGRAM":1,$P(Y,U)["ULTRASOUND":1,1:0)
"RTN","WVRPPCD1",34,0)
 ..S WVAGRP=$$WVAGRP($P(Y,U,16))
"RTN","WVRPPCD1",35,0)
 ..;---> QUIT IF DISPLAYING "ALL AGES" ONLY (NOT GROUPED BY AGE).
"RTN","WVRPPCD1",36,0)
 ..Q:WVAGRP=1
"RTN","WVRPPCD1",37,0)
 ..S WVPCD="< "_$P(Y,U)_": "_WVAGRP_" >",WVPCDL=$L(WVPCD)
"RTN","WVRPPCD1",38,0)
 ..S X=$E(WVLINE,1,31-(WVPCDL/2))
"RTN","WVRPPCD1",39,0)
 ..W !!?2,X,WVPCD,X
"RTN","WVRPPCD1",40,0)
 ..I WVARJ W !?68," CREDIT"
"RTN","WVRPPCD1",41,0)
 ..W !?28,"COUNT",?43,"VETS",?56,"NON-VETS"
"RTN","WVRPPCD1",42,0)
 ..I WVARJ W ?66," REG.   NO CR"
"RTN","WVRPPCD1",43,0)
 ..W !?26,"----------",?40,"----------",?55,"----------"
"RTN","WVRPPCD1",44,0)
 ..I WVARJ W ?67,"-----  -----"
"RTN","WVRPPCD1",45,0)
 ..D VERTICAL
"RTN","WVRPPCD1",46,0)
 ..Q
"RTN","WVRPPCD1",47,0)
 .Q
"RTN","WVRPPCD1",48,0)
 I WVPOP!($G(ZTSTOP)=1) D ^%ZISC Q
"RTN","WVRPPCD1",49,0)
 D FACLIST^WVRPPCD3
"RTN","WVRPPCD1",50,0)
 N WVNAME,WVIEN,WVCNT,WVCNT1
"RTN","WVRPPCD1",51,0)
 S WVNAME="",WVCNT=0
"RTN","WVRPPCD1",52,0)
 F  S WVNAME=$O(WVSB1(WVNAME)) Q:WVNAME=""  D
"RTN","WVRPPCD1",53,0)
 .S WVIEN=0
"RTN","WVRPPCD1",54,0)
 .F  S WVIEN=$O(WVSB1(WVNAME,WVIEN)) Q:'WVIEN  D
"RTN","WVRPPCD1",55,0)
 ..Q:$D(^TMP("WVAR",$J,WVNAME,WVIEN))
"RTN","WVRPPCD1",56,0)
 ..S WVCNT=WVCNT+1
"RTN","WVRPPCD1",57,0)
 ..Q
"RTN","WVRPPCD1",58,0)
 .Q
"RTN","WVRPPCD1",59,0)
 I WVCNT=0 G JUMP2
"RTN","WVRPPCD1",60,0)
 I '$D(^TMP("WVAR",$J)) G JUMP1
"RTN","WVRPPCD1",61,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 D  Q:WVPOP
"RTN","WVRPPCD1",62,0)
 .D:WVPOP ^%ZISC
"RTN","WVRPPCD1",63,0)
 .Q
"RTN","WVRPPCD1",64,0)
JUMP1 ;
"RTN","WVRPPCD1",65,0)
 S WVNAME="",WVCNT1=0
"RTN","WVRPPCD1",66,0)
 F  S WVNAME=$O(WVSB1(WVNAME)) Q:WVNAME=""!(WVPOP)!($G(ZTSTOP)=1)  D
"RTN","WVRPPCD1",67,0)
 .S WVIEN=0
"RTN","WVRPPCD1",68,0)
 .F  S WVIEN=$O(WVSB1(WVNAME,WVIEN)) Q:'WVIEN!(WVPOP)!($G(ZTSTOP)=1)  D
"RTN","WVRPPCD1",69,0)
 ..Q:$D(^TMP("WVAR",$J,WVNAME,WVIEN))
"RTN","WVRPPCD1",70,0)
 ..S WVCNT1=WVCNT1+1,WVPAGE=1
"RTN","WVRPPCD1",71,0)
 ..D HEADER4
"RTN","WVRPPCD1",72,0)
 ..Q:$G(ZTSTOP)=1
"RTN","WVRPPCD1",73,0)
 ..Q:WVCNT=WVCNT1
"RTN","WVRPPCD1",74,0)
 ..I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3
"RTN","WVRPPCD1",75,0)
 ..Q
"RTN","WVRPPCD1",76,0)
 .Q
"RTN","WVRPPCD1",77,0)
JUMP2 ;
"RTN","WVRPPCD1",78,0)
 I WVPOP!($G(ZTSTOP)=1) D ^%ZISC Q
"RTN","WVRPPCD1",79,0)
 I $O(^TMP("WVNOHCF",$J,0))'>0 D ENDREP^WVUTL7() Q
"RTN","WVRPPCD1",80,0)
 I WVCRT&('$D(IO("S")))&('WVPOP) D DIRZ^WVUTL3 D  Q:WVPOP
"RTN","WVRPPCD1",81,0)
 .D:WVPOP ^%ZISC
"RTN","WVRPPCD1",82,0)
 .Q
"RTN","WVRPPCD1",83,0)
JUMP3 ;
"RTN","WVRPPCD1",84,0)
 D NOFAC^WVRPPCD3 ;records with no facility
"RTN","WVRPPCD1",85,0)
 D ENDREP^WVUTL7()
"RTN","WVRPPCD1",86,0)
 Q
"RTN","WVRPPCD1",87,0)
 ;
"RTN","WVRPPCD1",88,0)
VERTICAL ;EP
"RTN","WVRPPCD1",89,0)
 ;---> DISPLAY IN VERTICAL FORMAT.
"RTN","WVRPPCD1",90,0)
 F X=1:1:24 S:$P(Y,U,X)="" $P(Y,U,X)=0
"RTN","WVRPPCD1",91,0)
 F X=25:1:40 S:$P(Y,U,X)'>0 $P(Y,U,X)=""
"RTN","WVRPPCD1",92,0)
 D PG
"RTN","WVRPPCD1",93,0)
 W !?14,$S($P(Y,U)="PREGNANCY TEST":"NOT PREG",1:"NORMAL:")
"RTN","WVRPPCD1",94,0)
 W ?24,$J($P(Y,U,4),5),?30,"(",$J($P(Y,U,5),3),"%)"
"RTN","WVRPPCD1",95,0)
 W ?38,$J($P(Y,U,17),5),?44,PG(1),?47,$J($P(Y,U,4)-$P(Y,U,17),8)
"RTN","WVRPPCD1",96,0)
 W ?59,PG(2)
"RTN","WVRPPCD1",97,0)
 I WVARJ W ?64,$J($P(Y,U,25),5),?72,$J($P(Y,U,33),5)
"RTN","WVRPPCD1",98,0)
 W !?2,"PROCEDURES"
"RTN","WVRPPCD1",99,0)
 W ?14,$S($P(Y,U)="PREGNANCY TEST":"PREGNANT:",1:"ABNORMAL:")
"RTN","WVRPPCD1",100,0)
 W ?24,$J($P(Y,U,8),5),?30,"(",$J($P(Y,U,9),3),"%)"
"RTN","WVRPPCD1",101,0)
 W ?38,$J($P(Y,U,19),5),?44,PG(3),?47,$J($P(Y,U,8)-$P(Y,U,19),8)
"RTN","WVRPPCD1",102,0)
 W ?59,PG(4)
"RTN","WVRPPCD1",103,0)
 I WVARJ W ?64,$J($P(Y,U,27),5),?72,$J($P(Y,U,35),5)
"RTN","WVRPPCD1",104,0)
 W !?14,"NO RESULT:",?24,$J($P(Y,U,12),5),?30,"(",$J($P(Y,U,13),3),"%)"
"RTN","WVRPPCD1",105,0)
 W ?38,$J($P(Y,U,21),5),?44,PG(5),?47,$J($P(Y,U,12)-$P(Y,U,21),8)
"RTN","WVRPPCD1",106,0)
 W ?59,PG(6)
"RTN","WVRPPCD1",107,0)
 I WVARJ W ?64,$J($P(Y,U,29),5),?72,$J($P(Y,U,37),5)
"RTN","WVRPPCD1",108,0)
 W !?14,"TOTAL:",?24,$J($P(Y,U,15),5),?38,$J($P(Y,U,23),5)
"RTN","WVRPPCD1",109,0)
 W ?44,PG(7),?47,$J($P(Y,U,15)-$P(Y,U,23),8)
"RTN","WVRPPCD1",110,0)
 W ?59,PG(8)
"RTN","WVRPPCD1",111,0)
 I WVARJ W ?64,$J($P(Y,U,31),5),?72,$J($P(Y,U,39),5)
"RTN","WVRPPCD1",112,0)
 W !!?14,$S($P(Y,U)="PREGNANCY TEST":"NOT PREG:",1:"NORMAL:")
"RTN","WVRPPCD1",113,0)
 W ?24,$J($P(Y,U,2),5),?30,"(",$J($P(Y,U,3),3),"%)"
"RTN","WVRPPCD1",114,0)
 W ?38,$J($P(Y,U,18),5),?44,PG(9),?47,$J($P(Y,U,2)-$P(Y,U,18),8)
"RTN","WVRPPCD1",115,0)
 W ?59,PG(10)
"RTN","WVRPPCD1",116,0)
 I WVARJ W ?64,$J($P(Y,U,26),5),?72,$J($P(Y,U,34),5)
"RTN","WVRPPCD1",117,0)
 W !?2,"PATIENTS"
"RTN","WVRPPCD1",118,0)
 W ?14,$S($P(Y,U)="PREGNANCY TEST":"PREGNANT:",1:"ABNORMAL:")
"RTN","WVRPPCD1",119,0)
 W ?24,$J($P(Y,U,6),5),?30,"(",$J($P(Y,U,7),3),"%)"
"RTN","WVRPPCD1",120,0)
 W ?38,$J($P(Y,U,20),5),?44,PG(11),?47,$J($P(Y,U,6)-$P(Y,U,20),8)
"RTN","WVRPPCD1",121,0)
 W ?59,PG(12)
"RTN","WVRPPCD1",122,0)
 I WVARJ W ?64,$J($P(Y,U,28),5),?72,$J($P(Y,U,36),5)
"RTN","WVRPPCD1",123,0)
 W !?14,"NO RESULT:",?24,$J($P(Y,U,10),5),?30,"(",$J($P(Y,U,11),3),"%)"
"RTN","WVRPPCD1",124,0)
 W ?38,$J($P(Y,U,22),5),?44,PG(13),?47,$J($P(Y,U,10)-$P(Y,U,22),8)
"RTN","WVRPPCD1",125,0)
 W ?59,PG(14)
"RTN","WVRPPCD1",126,0)
 I WVARJ W ?64,$J($P(Y,U,30),5),?72,$J($P(Y,U,38),5)
"RTN","WVRPPCD1",127,0)
 W !?14,"TOTAL:",?24,$J($P(Y,U,14),5),?38,$J($P(Y,U,24),5)
"RTN","WVRPPCD1",128,0)
 W ?44,PG(15),?47,$J($P(Y,U,14)-$P(Y,U,24),8)
"RTN","WVRPPCD1",129,0)
 W ?59,PG(16)
"RTN","WVRPPCD1",130,0)
 I WVARJ W ?64,$J($P(Y,U,32),5),?72,$J($P(Y,U,40),5)
"RTN","WVRPPCD1",131,0)
 Q
"RTN","WVRPPCD1",132,0)
PG ;FIGURES %'S FOR VETS & NON VETS
"RTN","WVRPPCD1",133,0)
 F JC=1:1:25 S PG(JC)=0
"RTN","WVRPPCD1",134,0)
 I $P(Y,U,4)'=0 S PG(1)=100*$P(Y,U,17)/$P(Y,U,4)
"RTN","WVRPPCD1",135,0)
 I $P(Y,U,8)'=0 S PG(3)=100*$P(Y,U,19)/$P(Y,U,8)
"RTN","WVRPPCD1",136,0)
 I $P(Y,U,12)'=0 S PG(5)=100*$P(Y,U,21)/$P(Y,U,12)
"RTN","WVRPPCD1",137,0)
 I $P(Y,U,15)'=0 S PG(7)=100*$P(Y,U,23)/$P(Y,U,15)
"RTN","WVRPPCD1",138,0)
 I $P(Y,U,2)'=0 S PG(9)=100*$P(Y,U,18)/$P(Y,U,2)
"RTN","WVRPPCD1",139,0)
 I $P(Y,U,6)'=0 S PG(11)=100*$P(Y,U,20)/$P(Y,U,6)
"RTN","WVRPPCD1",140,0)
 I $P(Y,U,10)'=0 S PG(13)=100*$P(Y,U,22)/$P(Y,U,10)
"RTN","WVRPPCD1",141,0)
 I $P(Y,U,14)'=0 S PG(15)=100*$P(Y,U,24)/$P(Y,U,14) D T
"RTN","WVRPPCD1",142,0)
 S PG(2)=$S($P(Y,U,4)'=0:100-PG(1),1:0)
"RTN","WVRPPCD1",143,0)
 S PG(4)=$S($P(Y,U,8)'=0:100-PG(3),1:0)
"RTN","WVRPPCD1",144,0)
 S PG(6)=$S($P(Y,U,12)'=0:100-PG(5),1:0)
"RTN","WVRPPCD1",145,0)
 S PG(8)=$S($P(Y,U,15)'=0:100-PG(7),1:0)
"RTN","WVRPPCD1",146,0)
 S PG(10)=$S($P(Y,U,2)'=0:100-PG(9),1:0)
"RTN","WVRPPCD1",147,0)
 S PG(12)=$S($P(Y,U,6)'=0:100-PG(11),1:0)
"RTN","WVRPPCD1",148,0)
 S PG(14)=$S($P(Y,U,10)'=0:100-PG(13),1:0)
"RTN","WVRPPCD1",149,0)
 S PG(16)=$S($P(Y,U,14)'=0:100-PG(15),1:0)
"RTN","WVRPPCD1",150,0)
 ;PAD %'S WITH BLANKS
"RTN","WVRPPCD1",151,0)
 F JC=1:1:16 S PG(JC)="  "_PG(JC) D
"RTN","WVRPPCD1",152,0)
 .S PG(JC)=$E(PG(JC),$L(PG(JC))-2,$L(PG(JC)))
"RTN","WVRPPCD1",153,0)
 .S PG(JC)="("_PG(JC)_"%)"
"RTN","WVRPPCD1",154,0)
 Q
"RTN","WVRPPCD1",155,0)
T ;ELIMINTE DECIMAL POINT IN %
"RTN","WVRPPCD1",156,0)
 N S F S=1,3,5,7,9,11,13,15 D
"RTN","WVRPPCD1",157,0)
 .S:$E($P(PG(S),".",2))'<.5 PG(S)=PG(S)+1 S PG(S)=$P(PG(S),".")
"RTN","WVRPPCD1",158,0)
 Q
"RTN","WVRPPCD1",159,0)
 ;
"RTN","WVRPPCD1",160,0)
WVAGRP(AGE) ;EP
"RTN","WVRPPCD1",161,0)
 ;Q:AGE="ALL" "All ages"
"RTN","WVRPPCD1",162,0)
 Q:AGE="ALL" $S(WVAGRP'=1:"Total for selected ages",1:"All ages")
"RTN","WVRPPCD1",163,0)
 Q:AGE=1 1
"RTN","WVRPPCD1",164,0)
 N I,X,Y,Z S X=WVAGRG
"RTN","WVRPPCD1",165,0)
 F I=1:1:$L(X,",")  S Y=$P($P(X,",",I),"-",2)  Q:AGE'>Y
"RTN","WVRPPCD1",166,0)
 S Z=$P($P(X,",",I),"-")
"RTN","WVRPPCD1",167,0)
 Q:AGE<Z "Under "_Y_" yrs"
"RTN","WVRPPCD1",168,0)
 Q:AGE>Y "Over "_Y_" yrs"
"RTN","WVRPPCD1",169,0)
 Q $P(X,",",I)_" yrs"
"RTN","WVRPPCD1",170,0)
 ;---> PUT A FINAL CHECK IN HERE??  *COMEBACK
"RTN","WVRPPCD1",171,0)
 Q "Unknown age"
"RTN","WVRPPCD1",172,0)
 ;
"RTN","WVRPPCD1",173,0)
 ;
"RTN","WVRPPCD1",174,0)
SUBHEAD ;EP
"RTN","WVRPPCD1",175,0)
 ;---> SUB HEADER FOR PROCEDURE BROWSE OUTPUT.
"RTN","WVRPPCD1",176,0)
 W !?5,"NOTE: Patient numbers are not intended to total.  "
"RTN","WVRPPCD1",177,0)
 W "Patients may be"
"RTN","WVRPPCD1",178,0)
 W !,"           included in more than one category.",!
"RTN","WVRPPCD1",179,0)
 W $$REPEAT^XLFSTR("=",80)
"RTN","WVRPPCD1",180,0)
 Q
"RTN","WVRPPCD1",181,0)
HEADER3 ;EP
"RTN","WVRPPCD1",182,0)
 ;---> REQUIRED VARIABLES: WVBEGDT,WVCRT,WVENDDT,WVPAGE,WVTITLE,DUZ(2)
"RTN","WVRPPCD1",183,0)
 ;---> OPTIONAL VARIABLE:  WVSUBH (SUBHEADER).
"RTN","WVRPPCD1",184,0)
 N X
"RTN","WVRPPCD1",185,0)
 W:$Y>0 @IOF
"RTN","WVRPPCD1",186,0)
 W !,WVTITLE,?70,"page: ",WVPAGE
"RTN","WVRPPCD1",187,0)
 W !,$$RUNDT^WVUTL1A("C")
"RTN","WVRPPCD1",188,0)
 W !!,"Facility: ",$$INSTTX^WVUTL6($S($G(WVFAC):WVFAC,1:DUZ(2)))
"RTN","WVRPPCD1",189,0)
 W ?53,"From: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVRPPCD1",190,0)
 W " to ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVRPPCD1",191,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVRPPCD1",192,0)
 I $D(WVSUBH) D @WVSUBH
"RTN","WVRPPCD1",193,0)
 I $D(ZTQUEUED) D STOPCHK^WVUTL10(1) Q:$G(ZTSTOP)=1
"RTN","WVRPPCD1",194,0)
 Q
"RTN","WVRPPCD1",195,0)
HEADER4 ; Header and message for facilities without data
"RTN","WVRPPCD1",196,0)
 N X
"RTN","WVRPPCD1",197,0)
 W:$Y>0 @IOF
"RTN","WVRPPCD1",198,0)
 W !,WVTITLE,?70,"page: ",WVPAGE
"RTN","WVRPPCD1",199,0)
 W !,$$RUNDT^WVUTL1A("C")
"RTN","WVRPPCD1",200,0)
 W !!,"Facility: "_WVNAME
"RTN","WVRPPCD1",201,0)
 W ?53,"From: ",$$SLDT2^WVUTL5(WVBEGDT)
"RTN","WVRPPCD1",202,0)
 W " to ",$$SLDT2^WVUTL5(WVENDDT)
"RTN","WVRPPCD1",203,0)
 W !,$$REPEAT^XLFSTR("=",80)
"RTN","WVRPPCD1",204,0)
 I $D(ZTQUEUED) D STOPCHK^WVUTL10(1) Q:$G(ZTSTOP)=1
"RTN","WVRPPCD1",205,0)
 W !!?5,"No records match the selected criteria for this facility.",!
"RTN","WVRPPCD1",206,0)
 Q
"RTN","WVRPPCD2")
0^3^B47730542
"RTN","WVRPPCD2",1,0)
WVRPPCD2 ;HCIOFO/FT,JR-REPORT: PROCEDURES STATISTICS; ;7/24/01  14:11
"RTN","WVRPPCD2",2,0)
 ;;1.0;WOMEN'S HEALTH;**12**;Sep 30, 1998
"RTN","WVRPPCD2",3,0)
 ;;  Original routine created by IHS/ANMC/MWR
"RTN","WVRPPCD2",4,0)
 ;;* MICHAEL REMILLARD, DDS * ALASKA NATIVE MEDICAL CENTER *
"RTN","WVRPPCD2",5,0)
 ;;  COLLATING CODE CALLED BY WVRPPCD.
"RTN","WVRPPCD2",6,0)
 ;
"RTN","WVRPPCD2",7,0)
 ; This routine uses the following IAs:
"RTN","WVRPPCD2",8,0)
 ; <NONE>
"RTN","WVRPPCD2",9,0)
 ;
"RTN","WVRPPCD2",10,0)
SORT ;EP
"RTN","WVRPPCD2",11,0)
 ;---> SORT AND STORE LOCAL ARRAY IN ^TMP("WV",$J,1,
"RTN","WVRPPCD2",12,0)
 K ^TMP("WV",$J),WVRES,^TMP("WVX",$J),^TMP("WVNOHCF",$J)
"RTN","WVRPPCD2",13,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","WVRPPCD2",14,0)
 ;---> WVBEGDT1=ONE SECOND BEFORE BEGIN DATE.
"RTN","WVRPPCD2",15,0)
 ;---> WVENDDT1=THE LAST SECOND OF END DATE.
"RTN","WVRPPCD2",16,0)
 N FE,FI,I,WVDFN,WVHCFN,WVHIEN,WVIEN,WVPCD,WVZSTOP,Y
"RTN","WVRPPCD2",17,0)
 S WVBEGDT1=WVBEGDT-.0001,WVENDDT1=WVENDDT+.9999
"RTN","WVRPPCD2",18,0)
 S WVDATE=WVBEGDT1,WVZSTOP=0
"RTN","WVRPPCD2",19,0)
 F  S WVDATE=$O(^WV(790.1,"D",WVDATE)) Q:'WVDATE!(WVDATE>WVENDDT1)!($G(ZTSTOP)=1)  D
"RTN","WVRPPCD2",20,0)
 .S WVIEN=0
"RTN","WVRPPCD2",21,0)
 .F  S WVIEN=$O(^WV(790.1,"D",WVDATE,WVIEN)) Q:'WVIEN!($G(ZTSTOP)=1)  D
"RTN","WVRPPCD2",22,0)
 ..S WVZSTOP=WVZSTOP+1
"RTN","WVRPPCD2",23,0)
 ..;If background task, then every 100 records check if user wants to
"RTN","WVRPPCD2",24,0)
 ..;stop the task.
"RTN","WVRPPCD2",25,0)
 ..I $D(ZTQUEUED),WVZSTOP#100=0 D STOPCHK^WVUTL10(0) Q:$G(ZTSTOP)=1
"RTN","WVRPPCD2",26,0)
 ..S Y=^WV(790.1,WVIEN,0)
"RTN","WVRPPCD2",27,0)
 ..;---> QUIT IF THIS PROCEDURE HAS A RESULT OF "ERROR/DISREGARD".
"RTN","WVRPPCD2",28,0)
 ..Q:$P(Y,U,5)=8
"RTN","WVRPPCD2",29,0)
 ..S WVDFN=$P(Y,U,2),WVPCD=$P(Y,U,4),WVHCF=$P(Y,U,10) ;patient ien, procedure ien, facility ien
"RTN","WVRPPCD2",30,0)
 ..I 'WVHCF S ^TMP("WVNOHCF",$J,WVIEN)="" Q  ;no facility
"RTN","WVRPPCD2",31,0)
 ..S WVHCFN=$$FACNAME(WVHCF)
"RTN","WVRPPCD2",32,0)
 ..I WVHCFN="" S ^TMP("WVNOHCF",$J,WVIEN)="" Q  ;no facility name
"RTN","WVRPPCD2",33,0)
 ..S WVAGE=$$WVAGE(WVDFN,$P(Y,U,12),WVAGRG)
"RTN","WVRPPCD2",34,0)
 ..;---> QUIT IF PATIENT'S AGE IS UNKNOWN OR OUTSIDE OF AGE RANGE.
"RTN","WVRPPCD2",35,0)
 ..Q:'WVAGE
"RTN","WVRPPCD2",36,0)
 ..;---> QUIT IF NOT SELECTING FOR ALL PROCEDURES AND IF THIS IS
"RTN","WVRPPCD2",37,0)
 ..;---> NOT ONE OF THE SELECTED PROCEDURES.
"RTN","WVRPPCD2",38,0)
 ..I '$D(WVARR("ALL")) Q:'$D(WVARR(WVPCD))
"RTN","WVRPPCD2",39,0)
 ..;---> Quit if Facility is not one selected by user
"RTN","WVRPPCD2",40,0)
 ..I '$D(WVSB("ALL")) Q:'$D(WVSB(WVHCF))
"RTN","WVRPPCD2",41,0)
 ..;---> FOR WVRES: 0=NORMAL, 1=ABNORMAL, 2=NO RESULT.
"RTN","WVRPPCD2",42,0)
 ..S WVRES=$$NORMAL^WVUTL4($P(Y,U,5))
"RTN","WVRPPCD2",43,0)
 ..; Below 5 Lines added to gather Rad Credit for rept
"RTN","WVRPPCD2",44,0)
 ..S WVJRC=$P($G(^WV(790.1,WVIEN,0)),U,35) I WVJRC'="" D
"RTN","WVRPPCD2",45,0)
 ...I '$D(^TMP("WVX",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)) D  Q
"RTN","WVRPPCD2",46,0)
 ....S ^TMP("WVX",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)=1
"RTN","WVRPPCD2",47,0)
 ...S X=^TMP("WVX",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)+1
"RTN","WVRPPCD2",48,0)
 ...S ^TMP("WVX",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES,WVJRC)=X
"RTN","WVRPPCD2",49,0)
 ..I '$D(^TMP("WV",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES)) D  Q
"RTN","WVRPPCD2",50,0)
 ...S ^TMP("WV",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES)=1
"RTN","WVRPPCD2",51,0)
 ..S X=^TMP("WV",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES)+1
"RTN","WVRPPCD2",52,0)
 ..S ^TMP("WV",$J,WVHCFN,WVHCF,WVPCD,WVAGE,WVDFN,WVRES)=X
"RTN","WVRPPCD2",53,0)
 ..Q
"RTN","WVRPPCD2",54,0)
 .Q
"RTN","WVRPPCD2",55,0)
 Q:$G(ZTSTOP)=1  ;user stopped the background task
"RTN","WVRPPCD2",56,0)
 ;
"RTN","WVRPPCD2",57,0)
TOTALS ;EP
"RTN","WVRPPCD2",58,0)
 ;---> N=WVPCD, Q=WVAGE, M=WVDFN, P=WVRES (0,1,2), FI=WVHCF(internal)
"RTN","WVRPPCD2",59,0)
 ;---> FE=WVHCF(external)
"RTN","WVRPPCD2",60,0)
 N I,M,N,P,Q
"RTN","WVRPPCD2",61,0)
 S FE=""
"RTN","WVRPPCD2",62,0)
 F  S FE=$O(^TMP("WV",$J,FE)) Q:FE=""  S FI=0 F  S FI=$O(^TMP("WV",$J,FE,FI)) Q:'FI  S N=0 F  S N=$O(^TMP("WV",$J,FE,FI,N)) Q:N=""  D
"RTN","WVRPPCD2",63,0)
 .S Q=0
"RTN","WVRPPCD2",64,0)
 .F  S Q=$O(^TMP("WV",$J,FE,FI,N,Q)) Q:Q=""  D
"RTN","WVRPPCD2",65,0)
 ..F I=0,1,2 S ^TMP("WVRES",$J,FE,FI,N,Q,I,"P")=0 S ^TMP("WVRES",$J,FE,FI,N,Q,I,"T")=0
"RTN","WVRPPCD2",66,0)
 ..S M=0,(^TMP("WVRES",$J,FE,FI,N,Q,"P"),^TMP("WVRES",$J,FE,FI,N,Q,"T"),^TMP("WVRES",$J,FE,FI,N,Q,"VT","P"),^TMP("WVRES",$J,FE,FI,N,Q,"VT","T"))=0
"RTN","WVRPPCD2",67,0)
 ..F  S M=$O(^TMP("WV",$J,FE,FI,N,Q,M)) Q:M=""  D
"RTN","WVRPPCD2",68,0)
 ...S P=-1,^TMP("WVRES",$J,FE,FI,N,Q,"P")=^TMP("WVRES",$J,FE,FI,N,Q,"P")+1
"RTN","WVRPPCD2",69,0)
 ...I $$GET1^DIQ(2,M,1901,"I")="Y" S ^TMP("WVRES",$J,FE,FI,N,Q,"VT","PA")=$G(^TMP("WVRES",$J,FE,FI,N,Q,"VT","PA"))+1
"RTN","WVRPPCD2",70,0)
 ...F  S P=$O(^TMP("WV",$J,FE,FI,N,Q,M,P)) Q:P=""  D
"RTN","WVRPPCD2",71,0)
 ....S ^TMP("WVRES",$J,FE,FI,N,Q,P,"P")=^TMP("WVRES",$J,FE,FI,N,Q,P,"P")+1
"RTN","WVRPPCD2",72,0)
 ....S ^TMP("WVRES",$J,FE,FI,N,Q,P,"T")=^TMP("WVRES",$J,FE,FI,N,Q,P,"T")+^TMP("WV",$J,FE,FI,N,Q,M,P)
"RTN","WVRPPCD2",73,0)
 ....I $$GET1^DIQ(2,M,1901,"I")="Y" D
"RTN","WVRPPCD2",74,0)
 .....S ^TMP("WVRES",$J,FE,FI,N,Q,P,"VT","P")=$G(^TMP("WVRES",$J,FE,FI,N,Q,P,"VT","P"))+1
"RTN","WVRPPCD2",75,0)
 .....S ^TMP("WVRES",$J,FE,FI,N,Q,P,"VT","T")=$G(^TMP("WVRES",$J,FE,FI,N,Q,P,"VT","T"))+^TMP("WV",$J,FE,FI,N,Q,M,P)
"RTN","WVRPPCD2",76,0)
 ....F WVJRC=0,2 D
"RTN","WVRPPCD2",77,0)
 .....I $G(^TMP("WVX",$J,FE,FI,N,Q,M,P,WVJRC))'="" S ^TMP("WVRES",$J,FE,FI,N,Q,"CM","PA",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,Q,"CM","PA",WVJRC))+1 D
"RTN","WVRPPCD2",78,0)
 ......S ^TMP("WVRES",$J,FE,FI,N,Q,P,"CM","P",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,Q,P,"CM","P",WVJRC))+1
"RTN","WVRPPCD2",79,0)
 ......S ^TMP("WVRES",$J,FE,FI,N,Q,P,"CM","T",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,Q,P,"CM","T",WVJRC))+^TMP("WVX",$J,FE,FI,N,Q,M,P,WVJRC)
"RTN","WVRPPCD2",80,0)
 ;---> NOW COMPUTE TOTAL #PROCEDURES FOR EACH PROCEDURE, EACH AGE GROUP.
"RTN","WVRPPCD2",81,0)
 S FE=""
"RTN","WVRPPCD2",82,0)
 F  S FE=$O(^TMP("WVRES",$J,FE)) Q:FE=""  S FI=0 F  S FI=$O(^TMP("WVRES",$J,FE,FI)) Q:'FI  S N=0 F  S N=$O(^TMP("WVRES",$J,FE,FI,N)) Q:'N  D
"RTN","WVRPPCD2",83,0)
 .S Q=0 F  S Q=$O(^TMP("WVRES",$J,FE,FI,N,Q)) Q:'Q  D
"RTN","WVRPPCD2",84,0)
 ..S M=-1 F  S M=$O(^TMP("WVRES",$J,FE,FI,N,Q,M)) Q:M=""!(M'?1N.N)  D
"RTN","WVRPPCD2",85,0)
 ...S ^TMP("WVRES",$J,FE,FI,N,Q,"T")=^TMP("WVRES",$J,FE,FI,N,Q,"T")+^TMP("WVRES",$J,FE,FI,N,Q,M,"T")
"RTN","WVRPPCD2",86,0)
 ...;S ^TMP("WVRES",$J,FE,FI,N,Q,"P")=^TMP("WVRES",$J,FE,FI,N,Q,"P")+^TMP("WVRES",$J,FE,FI,N,Q,M,"P")
"RTN","WVRPPCD2",87,0)
 ...S ^TMP("WVRES",$J,FE,FI,N,Q,"VT","T")=$G(^TMP("WVRES",$J,FE,FI,N,Q,"VT","T"))+$G(^TMP("WVRES",$J,FE,FI,N,Q,M,"VT","T"))
"RTN","WVRPPCD2",88,0)
 ...S ^TMP("WVRES",$J,FE,FI,N,Q,"VT","P")=$G(^TMP("WVRES",$J,FE,FI,N,Q,"VT","P"))+$G(^TMP("WVRES",$J,FE,FI,N,Q,M,"VT","P"))
"RTN","WVRPPCD2",89,0)
 ...;*******************************************
"RTN","WVRPPCD2",90,0)
 ...F WVJRC=0,2 D
"RTN","WVRPPCD2",91,0)
 ....S ^TMP("WVRES",$J,FE,FI,N,Q,"CM","T",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,Q,"CM","T",WVJRC))+$G(^TMP("WVRES",$J,FE,FI,N,Q,M,"CM","T",WVJRC))
"RTN","WVRPPCD2",92,0)
 ....S ^TMP("WVRES",$J,FE,FI,N,Q,"CM","P",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,Q,"CM","P",WVJRC))+$G(^TMP("WVRES",$J,FE,FI,N,Q,M,"CM","P",WVJRC))
"RTN","WVRPPCD2",93,0)
 ...;*******************************************
"RTN","WVRPPCD2",94,0)
 ;
"RTN","WVRPPCD2",95,0)
 ;
"RTN","WVRPPCD2",96,0)
 ;-> NOW COMPUTE TOTAL #PROCEDURES FOR EACH PROCEDURE.
"RTN","WVRPPCD2",97,0)
 ;-> ^TMP("WVRES",$J,FE,FI,N,"P")=TOTAL PATIENTS WHO RECEIVED THIS PROCEDURE
"RTN","WVRPPCD2",98,0)
 ;-> ^TMP("WVRES",$J,FE,FI,N,"T")=TOTAL TIMES THIS PROCEDURE WAS PERFORMED
"RTN","WVRPPCD2",99,0)
 S FE=""
"RTN","WVRPPCD2",100,0)
 F  S FE=$O(^TMP("WVRES",$J,FE)) Q:FE=""  S FI=0 F  S FI=$O(^TMP("WVRES",$J,FE,FI)) Q:'FI  S N=0 F  S N=$O(^TMP("WVRES",$J,FE,FI,N)) Q:'N  D
"RTN","WVRPPCD2",101,0)
 .S Q=0,^TMP("WVRES",$J,FE,FI,N,"P")=0,^TMP("WVRES",$J,FE,FI,N,"T")=0,^TMP("WVRES",$J,FE,FI,N,"VT","P")=0
"RTN","WVRPPCD2",102,0)
 .S ^TMP("WVRES",$J,FE,FI,N,"VT","T")=0,^TMP("WVRES",$J,FE,FI,N,"VT","PA")=0
"RTN","WVRPPCD2",103,0)
 .F WVJRC=0,2 S ^TMP("WVRES",$J,FE,FI,N,"CM","T",WVJRC)=0,^TMP("WVRES",$J,FE,FI,N,"CM","PA",WVJRC)=0
"RTN","WVRPPCD2",104,0)
 .F  S Q=$O(^TMP("WVRES",$J,FE,FI,N,Q)) Q:'Q  D
"RTN","WVRPPCD2",105,0)
 ..S ^TMP("WVRES",$J,FE,FI,N,"P")=^TMP("WVRES",$J,FE,FI,N,"P")+^TMP("WVRES",$J,FE,FI,N,Q,"P")
"RTN","WVRPPCD2",106,0)
 ..S ^TMP("WVRES",$J,FE,FI,N,"T")=^TMP("WVRES",$J,FE,FI,N,"T")+^TMP("WVRES",$J,FE,FI,N,Q,"T")
"RTN","WVRPPCD2",107,0)
 ..S ^TMP("WVRES",$J,FE,FI,N,"VT","P")=^TMP("WVRES",$J,FE,FI,N,"VT","P")+$G(^TMP("WVRES",$J,FE,FI,N,Q,"VT","P"))
"RTN","WVRPPCD2",108,0)
 ..S ^TMP("WVRES",$J,FE,FI,N,"VT","T")=^TMP("WVRES",$J,FE,FI,N,"VT","T")+$G(^TMP("WVRES",$J,FE,FI,N,Q,"VT","T"))
"RTN","WVRPPCD2",109,0)
 ..S ^TMP("WVRES",$J,FE,FI,N,"VT","PA")=^TMP("WVRES",$J,FE,FI,N,"VT","PA")+$G(^TMP("WVRES",$J,FE,FI,N,Q,"VT","PA"))
"RTN","WVRPPCD2",110,0)
 ..F WVJRC=0,2 D
"RTN","WVRPPCD2",111,0)
 ...S ^TMP("WVRES",$J,FE,FI,N,"CM","P",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,"CM","P",WVJRC))+$G(^TMP("WVRES",$J,FE,FI,N,Q,"CM","P",WVJRC))
"RTN","WVRPPCD2",112,0)
 ...S ^TMP("WVRES",$J,FE,FI,N,"CM","T",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,"CM","T",WVJRC))+$G(^TMP("WVRES",$J,FE,FI,N,Q,"CM","T",WVJRC))
"RTN","WVRPPCD2",113,0)
 ...S ^TMP("WVRES",$J,FE,FI,N,"CM","PA",WVJRC)=$G(^TMP("WVRES",$J,FE,FI,N,"CM","PA",WVJRC))+$G(^TMP("WVRES",$J,FE,FI,N,Q,"CM","PA",WVJRC))
"RTN","WVRPPCD2",114,0)
 ;
"RTN","WVRPPCD2",115,0)
 D FLATFL^WVRPPCD3
"RTN","WVRPPCD2",116,0)
 Q
"RTN","WVRPPCD2",117,0)
 ;
"RTN","WVRPPCD2",118,0)
WVAGE(DFN,DATE,X) ;EP
"RTN","WVRPPCD2",119,0)
 ;---> SET AGE CATEGORY.
"RTN","WVRPPCD2",120,0)
 ;---> REQUIRED VARIABLES: DATE=DATE PATIENT RECEIVED THIS PROCEDURE.
"RTN","WVRPPCD2",121,0)
 ;--->                     DFN, X=WVAGRG (AGE RANGE).
"RTN","WVRPPCD2",122,0)
 ;---> IF NOT DISPLAY BY AGE, SET ALL WVAGE=1
"RTN","WVRPPCD2",123,0)
 Q:X=1 1
"RTN","WVRPPCD2",124,0)
 N AGE,Y,Z
"RTN","WVRPPCD2",125,0)
 S AGE=$P($$AGEAT^WVUTL1(DFN,DATE),"y/o")
"RTN","WVRPPCD2",126,0)
 ;---> RETURN 0 IF PATIENT'S AGE IS UNKNOWN.
"RTN","WVRPPCD2",127,0)
 Q:'+AGE 0
"RTN","WVRPPCD2",128,0)
 ;
"RTN","WVRPPCD2",129,0)
 F I=1:1:$L(X,",") S Y=$P($P(X,",",I),"-",2) Q:AGE'>Y
"RTN","WVRPPCD2",130,0)
 S Z=$P($P(X,",",I),"-")
"RTN","WVRPPCD2",131,0)
 ;---> RETURN 0 IF PATIENT IS OUTSIDE DATE RANGE.
"RTN","WVRPPCD2",132,0)
 Q:(AGE<Z!(AGE>Y)) 0
"RTN","WVRPPCD2",133,0)
 Q Y
"RTN","WVRPPCD2",134,0)
FACNAME(IEN) ; Return Facility name
"RTN","WVRPPCD2",135,0)
 ; Check if ien has been looked up already.
"RTN","WVRPPCD2",136,0)
 I $G(WVHIEN(IEN))]"" Q $G(WVHIEN(IEN))
"RTN","WVRPPCD2",137,0)
 N NAME
"RTN","WVRPPCD2",138,0)
 S NAME=$$INSTTX^WVUTL6(IEN) ;get facility name
"RTN","WVRPPCD2",139,0)
 I NAME="" Q ""
"RTN","WVRPPCD2",140,0)
 S WVHIEN(IEN)=NAME ;update local array with name and ien
"RTN","WVRPPCD2",141,0)
 Q NAME
"RTN","WVRPPCD2",142,0)
 ;
"RTN","WVRPPCD3")
0^4^B23259227
"RTN","WVRPPCD3",1,0)
WVRPPCD3 ;HCIOFO/FT,JR-REPORT: PROCEDURES STATISTICS; ;7/23/01  13:33
"RTN","WVRPPCD3",2,0)
 ;;1.0;WOMEN'S HEALTH;**12**;Sep 30, 1998
"RTN","WVRPPCD3",3,0)
 ;
"RTN","WVRPPCD3",4,0)
 ; This routine uses the following IAs:
"RTN","WVRPPCD3",5,0)
 ; <NONE>
"RTN","WVRPPCD3",6,0)
 ;
"RTN","WVRPPCD3",7,0)
FLATFL ;EP
"RTN","WVRPPCD3",8,0)
 ;---> WRITE OUT RESULTS AND PECENTAGES IN A FLAT FILE.
"RTN","WVRPPCD3",9,0)
 ;---> PIECE VALUES: 1=PROC TYPE, 2=NORMAL PATS, 3=NORMAL PATS%
"RTN","WVRPPCD3",10,0)
 ;--->               4=NORMAL PROC    5=NORMAL PROC%   6=ABNORM PATS
"RTN","WVRPPCD3",11,0)
 ;--->               7=ABNORM PATS%   8=ABNORM PROC    9=ABNORM PROC%
"RTN","WVRPPCD3",12,0)
 ;--->               10=NO RES PATS   11=NO RES PATS%  12=NO RES PROC
"RTN","WVRPPCD3",13,0)
 ;--->               13=NO RES PROC%  14=TOTAL PATS    15=TOTAL PROC,
"RTN","WVRPPCD3",14,0)
 ;--->               16=AGE GROUP,             17=NORM VETS PROC. 
"RTN","WVRPPCD3",15,0)
 ;--->               18=NORM VETS PATIENTS,    19=ABN VETS PROC.
"RTN","WVRPPCD3",16,0)
 ;--->               20=ABN VETS PATIENTS,     21=NO RES VETS PROC
"RTN","WVRPPCD3",17,0)
 ;--->               22=NO RES VETS PATIENTS   23=TOT # VET PATIENTS
"RTN","WVRPPCD3",18,0)
 ;--->               24=TOT VET PROCEDURES
"RTN","WVRPPCD3",19,0)
 S FE=""
"RTN","WVRPPCD3",20,0)
 F  S FE=$O(^TMP("WVRES",$J,FE)) Q:FE=""  S FI=0 F  S FI=$O(^TMP("WVRES",$J,FE,FI)) Q:'FI  S N=0 F  S N=$O(^TMP("WVRES",$J,FE,FI,N)) Q:'N  D
"RTN","WVRPPCD3",21,0)
 .S M=0,(WVPN,X)=$P($G(^WV(790.2,N,0)),U)
"RTN","WVRPPCD3",22,0)
 .F  S M=$O(^TMP("WVRES",$J,FE,FI,N,M)) Q:'M  D
"RTN","WVRPPCD3",23,0)
 ..S X=WVPN,(T,P)=0,J=""
"RTN","WVRPPCD3",24,0)
 ..S PA=$G(^TMP("WVRES",$J,FE,FI,N,M,"VT","PA"))
"RTN","WVRPPCD3",25,0)
 ..S CM=$G(^TMP("WVRES",$J,FE,FI,N,M,"CM","PA",0))
"RTN","WVRPPCD3",26,0)
 ..S CM2=$G(^TMP("WVRES",$J,FE,FI,N,M,"CM","PA",2))
"RTN","WVRPPCD3",27,0)
 ..S (TR2,JR2,TR,JR)="" F I=0,1,2 D
"RTN","WVRPPCD3",28,0)
 ...S X=X_U_^TMP("WVRES",$J,FE,FI,N,M,I,"P")
"RTN","WVRPPCD3",29,0)
 ...S X=X_U_$J((^TMP("WVRES",$J,FE,FI,N,M,I,"P")*100/^TMP("WVRES",$J,FE,FI,N,M,"P")),1,0)
"RTN","WVRPPCD3",30,0)
 ...S X=X_U_^TMP("WVRES",$J,FE,FI,N,M,I,"T")
"RTN","WVRPPCD3",31,0)
 ...S X=X_U_$J((^TMP("WVRES",$J,FE,FI,N,M,I,"T")*100/^TMP("WVRES",$J,FE,FI,N,M,"T")),1,0)
"RTN","WVRPPCD3",32,0)
 ...S J=J_U_$G(^TMP("WVRES",$J,FE,FI,N,M,I,"VT","T")) ;# of procedures total/result
"RTN","WVRPPCD3",33,0)
 ...S J=J_U_$G(^TMP("WVRES",$J,FE,FI,N,M,I,"VT","P")) ;# of pat having this procedure
"RTN","WVRPPCD3",34,0)
 ...S T=T+$G(^TMP("WVRES",$J,FE,FI,N,M,I,"VT","T"))
"RTN","WVRPPCD3",35,0)
 ...S JR=$G(JR)_U_$G(^TMP("WVRES",$J,FE,FI,N,M,I,"CM","T",0)) ;# of procedures total/result
"RTN","WVRPPCD3",36,0)
 ...S JR=JR_U_$G(^TMP("WVRES",$J,FE,FI,N,M,I,"CM","P",0)) ;# of pat having this procedure
"RTN","WVRPPCD3",37,0)
 ...S TR=TR+$G(^TMP("WVRES",$J,FE,FI,N,M,I,"CM","T",0))
"RTN","WVRPPCD3",38,0)
 ...S JR2=$G(JR2)_U_$G(^TMP("WVRES",$J,FE,FI,N,M,I,"CM","T",2)) ;# of procedures total/result
"RTN","WVRPPCD3",39,0)
 ...S JR2=JR2_U_$G(^TMP("WVRES",$J,FE,FI,N,M,I,"CM","P",2)) ;# of pat having this procedure
"RTN","WVRPPCD3",40,0)
 ...S TR2=TR2+$G(^TMP("WVRES",$J,FE,FI,N,M,I,"CM","T",2))
"RTN","WVRPPCD3",41,0)
 ..S X=X_U_^TMP("WVRES",$J,FE,FI,N,M,"P")_U_^TMP("WVRES",$J,FE,FI,N,M,"T")_U_M_J_U_T_U_PA_JR_U_TR_U_CM_JR2_U_TR2_U_CM2
"RTN","WVRPPCD3",42,0)
 ..S ^TMP("WVRES",$J,"R",FE,FI,WVPN,M)=X
"RTN","WVRPPCD3",43,0)
 .;--->
"RTN","WVRPPCD3",44,0)
 .;---> NOW GET TOTALS FOR THIS PROCEDURE.
"RTN","WVRPPCD3",45,0)
 .N A,B,C,D,E,F,G,H,I,J,K,L,M,O,WA,WB,WC,WD,WE,WF,WG,WH,WI,WJ,WK,WL
"RTN","WVRPPCD3",46,0)
 .S (A,B,C,D,E,F,G,H,I,K,L,M,R,O,WA,WB,WC,WD,WE,WF,WG,WH,WI,WJ,WK,WL)=0
"RTN","WVRPPCD3",47,0)
 .F  S M=$O(^TMP("WVRES",$J,"R",FE,FI,WVPN,M)) Q:'M  D
"RTN","WVRPPCD3",48,0)
 ..S J=$O(^WV(790.2,"B",WVPN,""))
"RTN","WVRPPCD3",49,0)
 ..S Y=^TMP("WVRES",$J,"R",FE,FI,WVPN,M)
"RTN","WVRPPCD3",50,0)
 ..S A=A+$P(Y,U,2),B=B+$P(Y,U,4),C=C+$P(Y,U,6)
"RTN","WVRPPCD3",51,0)
 ..S D=D+$P(Y,U,8),E=E+$P(Y,U,10),F=F+$P(Y,U,12)
"RTN","WVRPPCD3",52,0)
 ..S H=H+$P(Y,U,17),I=I+$P(Y,U,18),K=K+$P(Y,U,19)
"RTN","WVRPPCD3",53,0)
 ..S L=L+$P(Y,U,20),R=R+$P(Y,U,21),O=O+$P(Y,U,22)
"RTN","WVRPPCD3",54,0)
 ..S WA=WA+$P(Y,U,25),WB=WB+$P(Y,U,26),WC=WC+$P(Y,U,27)
"RTN","WVRPPCD3",55,0)
 ..S WD=WD+$P(Y,U,28),WE=WE+$P(Y,U,29),WF=WF+$P(Y,U,30)
"RTN","WVRPPCD3",56,0)
 ..S WG=WG+$P(Y,U,33),WH=WH+$P(Y,U,34),WI=WI+$P(Y,U,35)
"RTN","WVRPPCD3",57,0)
 ..S WJ=WJ+$P(Y,U,36),WK=WK+$P(Y,U,37),WL=WL+$P(Y,U,38)
"RTN","WVRPPCD3",58,0)
 .S X=WVPN_U_A_U_$J(A*100/^TMP("WVRES",$J,FE,FI,N,"P"),1,0)
"RTN","WVRPPCD3",59,0)
 .S X=X_U_B_U_$J(B*100/^TMP("WVRES",$J,FE,FI,N,"T"),1,0)
"RTN","WVRPPCD3",60,0)
 .S X=X_U_C_U_$J(C*100/^TMP("WVRES",$J,FE,FI,N,"P"),1,0)
"RTN","WVRPPCD3",61,0)
 .S X=X_U_D_U_$J(D*100/^TMP("WVRES",$J,FE,FI,N,"T"),1,0)
"RTN","WVRPPCD3",62,0)
 .S X=X_U_E_U_$J(E*100/^TMP("WVRES",$J,FE,FI,N,"P"),1,0)
"RTN","WVRPPCD3",63,0)
 .S X=X_U_F_U_$J(F*100/^TMP("WVRES",$J,FE,FI,N,"T"),1,0)
"RTN","WVRPPCD3",64,0)
 .S X=X_U_^TMP("WVRES",$J,FE,FI,N,"P")_U_^TMP("WVRES",$J,FE,FI,N,"T")_U_"ALL"
"RTN","WVRPPCD3",65,0)
 .S J=U_H_U_I_U_K_U_L_U_R_U_O_U
"RTN","WVRPPCD3",66,0)
 .S J=J_$G(^TMP("WVRES",$J,FE,FI,N,"VT","T"))_U_$G(^TMP("WVRES",$J,FE,FI,N,"VT","PA"))
"RTN","WVRPPCD3",67,0)
 .S J=J_U_WA_U_WB_U_WC_U_WD_U_WE_U_WF
"RTN","WVRPPCD3",68,0)
 .S J=J_U_$G(^TMP("WVRES",$J,FE,FI,N,"CM","T",0))_U_$G(^TMP("WVRES",$J,FE,FI,N,"CM","PA",0))
"RTN","WVRPPCD3",69,0)
 .S J=J_U_WG_U_WH_U_WI_U_WJ_U_WK_U_WL
"RTN","WVRPPCD3",70,0)
 .S J=J_U_$G(^TMP("WVRES",$J,FE,FI,N,"CM","T",2))_U_$G(^TMP("WVRES",$J,FE,FI,N,"CM","PA",2))
"RTN","WVRPPCD3",71,0)
 .S ^TMP("WVRES",$J,"R",FE,FI,WVPN,"ALL")=X_J
"RTN","WVRPPCD3",72,0)
 Q
"RTN","WVRPPCD3",73,0)
NOFAC ; List records with no health care facility
"RTN","WVRPPCD3",74,0)
 W:$Y>0 @IOF
"RTN","WVRPPCD3",75,0)
 W !!,"The following Women's Health procedures are not associated with a facility:",!
"RTN","WVRPPCD3",76,0)
 N WVAN,WVCMN,WVIEN,WVNODE,WVPN
"RTN","WVRPPCD3",77,0)
 S WVIEN=0
"RTN","WVRPPCD3",78,0)
 F  S WVIEN=$O(^TMP("WVNOHCF",$J,WVIEN)) Q:'WVIEN!(WVPOP)  D
"RTN","WVRPPCD3",79,0)
 .S WVNODE=$G(^WV(790.1,WVIEN,0))
"RTN","WVRPPCD3",80,0)
 .S WVAN=$P(WVNODE,U,1) ;accession #
"RTN","WVRPPCD3",81,0)
 .S:WVAN="" WVAN="IEN is "_WVIEN
"RTN","WVRPPCD3",82,0)
 .S WVPN=+$P(WVNODE,U,2)
"RTN","WVRPPCD3",83,0)
 .S WVCMN=$$CMGR^WVUTL1(WVPN)
"RTN","WVRPPCD3",84,0)
 .I $Y+6>IOSL D:WVCRT DIRZ^WVUTL3 Q:WVPOP  D NOFACHDR
"RTN","WVRPPCD3",85,0)
 .W !,"Accession #: "_WVAN,?30,"Case Manager: "_WVCMN
"RTN","WVRPPCD3",86,0)
 .Q
"RTN","WVRPPCD3",87,0)
 Q
"RTN","WVRPPCD3",88,0)
NOFACHDR ; No Facility Header
"RTN","WVRPPCD3",89,0)
 W:$Y>0 @IOF
"RTN","WVRPPCD3",90,0)
 Q
"RTN","WVRPPCD3",91,0)
FACLIST ; create array to identify facilities chosen
"RTN","WVRPPCD3",92,0)
 N WVIEN,WVIEN1,WVNAME
"RTN","WVRPPCD3",93,0)
 K WVSB1
"RTN","WVRPPCD3",94,0)
 I '$D(WVSB("ALL")) D
"RTN","WVRPPCD3",95,0)
 .S WVIEN=0
"RTN","WVRPPCD3",96,0)
 .F  S WVIEN=$O(WVSB(WVIEN)) Q:'WVIEN  D
"RTN","WVRPPCD3",97,0)
 ..S WVIEN1=$P($G(^WV(790.02,WVIEN,0)),U,1)
"RTN","WVRPPCD3",98,0)
 ..Q:'WVIEN1!(WVIEN'=WVIEN1)
"RTN","WVRPPCD3",99,0)
 ..S WVNAME=$$INSTTX^WVUTL6(WVIEN)
"RTN","WVRPPCD3",100,0)
 ..Q:WVNAME=""
"RTN","WVRPPCD3",101,0)
 ..S WVSB1(WVNAME,WVIEN)=""
"RTN","WVRPPCD3",102,0)
 ..Q
"RTN","WVRPPCD3",103,0)
 .Q
"RTN","WVRPPCD3",104,0)
 I $D(WVSB("ALL")) D
"RTN","WVRPPCD3",105,0)
 .S WVIEN=0
"RTN","WVRPPCD3",106,0)
 .F  S WVIEN=$O(^WV(790.02,WVIEN)) Q:'WVIEN  D
"RTN","WVRPPCD3",107,0)
 ..S WVIEN1=$P($G(^WV(790.02,WVIEN,0)),U,1)
"RTN","WVRPPCD3",108,0)
 ..Q:'WVIEN1!(WVIEN'=WVIEN1)
"RTN","WVRPPCD3",109,0)
 ..S WVNAME=$$INSTTX^WVUTL6(WVIEN)
"RTN","WVRPPCD3",110,0)
 ..Q:WVNAME=""
"RTN","WVRPPCD3",111,0)
 ..S WVSB1(WVNAME,WVIEN)=""
"RTN","WVRPPCD3",112,0)
 ..Q
"RTN","WVRPPCD3",113,0)
 .Q
"RTN","WVRPPCD3",114,0)
 Q
"VER")
8.0^22
**END**
**END**
