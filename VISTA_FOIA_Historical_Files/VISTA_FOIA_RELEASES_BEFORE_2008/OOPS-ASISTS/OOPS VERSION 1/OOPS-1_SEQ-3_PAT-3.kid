Released OOPS*1*3 SEQ #3
Extracted from mail message
**KIDS**:OOPS*1.0*3^

**INSTALL NAME**
OOPS*1.0*3
"BLD",1918,0)
OOPS*1.0*3^ASISTS^0^^y
"BLD",1918,1,0)
^^1^1^2990610^^
"BLD",1918,1,1,0)
Editing and Address Issues
"BLD",1918,4,0)
^9.64PA^2260^1
"BLD",1918,4,2260,0)
2260
"BLD",1918,4,2260,2,0)
^9.641^2260^1
"BLD",1918,4,2260,2,2260,0)
ASISTS ACCIDENT REPORTING  (File-top level)
"BLD",1918,4,2260,2,2260,1,0)
^9.6411^109^2
"BLD",1918,4,2260,2,2260,1,2,0)
PERSONNEL STATUS
"BLD",1918,4,2260,2,2260,1,109,0)
DATE/TIME INJURY OCCURRED
"BLD",1918,4,2260,222)
y^y^p^^^^n
"BLD",1918,4,"APDD",2260,2260)

"BLD",1918,4,"APDD",2260,2260,2)

"BLD",1918,4,"APDD",2260,2260,109)

"BLD",1918,4,"B",2260,2260)

"BLD",1918,"KRN",0)
^9.67PA^19^18
"BLD",1918,"KRN",.4,0)
.4
"BLD",1918,"KRN",.4,"NM",0)
^9.68A^^
"BLD",1918,"KRN",.401,0)
.401
"BLD",1918,"KRN",.401,"NM",0)
^9.68A^^
"BLD",1918,"KRN",.402,0)
.402
"BLD",1918,"KRN",.403,0)
.403
"BLD",1918,"KRN",.5,0)
.5
"BLD",1918,"KRN",.84,0)
.84
"BLD",1918,"KRN",3.6,0)
3.6
"BLD",1918,"KRN",3.8,0)
3.8
"BLD",1918,"KRN",9.2,0)
9.2
"BLD",1918,"KRN",9.8,0)
9.8
"BLD",1918,"KRN",9.8,"NM",0)
^9.68A^10^10
"BLD",1918,"KRN",9.8,"NM",1,0)
OOPSCC^^0^B20074993
"BLD",1918,"KRN",9.8,"NM",2,0)
OOPSDIS^^0^B5087273
"BLD",1918,"KRN",9.8,"NM",3,0)
OOPSEMP1^^0^B57121982
"BLD",1918,"KRN",9.8,"NM",4,0)
OOPSPRT^^0^B33480358
"BLD",1918,"KRN",9.8,"NM",5,0)
OOPSPRT1^^0^B20754278
"BLD",1918,"KRN",9.8,"NM",6,0)
OOPSSUP1^^0^B33022148
"BLD",1918,"KRN",9.8,"NM",7,0)
OOPSSUP2^^0^B56809328
"BLD",1918,"KRN",9.8,"NM",8,0)
OOPSSUP3^^0^B6673672
"BLD",1918,"KRN",9.8,"NM",9,0)
OOPSUTL4^^0^B9219723
"BLD",1918,"KRN",9.8,"NM",10,0)
OOPSVAL1^^0^B16960737
"BLD",1918,"KRN",9.8,"NM","B","OOPSCC",1)

"BLD",1918,"KRN",9.8,"NM","B","OOPSDIS",2)

"BLD",1918,"KRN",9.8,"NM","B","OOPSEMP1",3)

"BLD",1918,"KRN",9.8,"NM","B","OOPSPRT",4)

"BLD",1918,"KRN",9.8,"NM","B","OOPSPRT1",5)

"BLD",1918,"KRN",9.8,"NM","B","OOPSSUP1",6)

"BLD",1918,"KRN",9.8,"NM","B","OOPSSUP2",7)

"BLD",1918,"KRN",9.8,"NM","B","OOPSSUP3",8)

"BLD",1918,"KRN",9.8,"NM","B","OOPSUTL4",9)

"BLD",1918,"KRN",9.8,"NM","B","OOPSVAL1",10)

"BLD",1918,"KRN",19,0)
19
"BLD",1918,"KRN",19.1,0)
19.1
"BLD",1918,"KRN",101,0)
101
"BLD",1918,"KRN",409.61,0)
409.61
"BLD",1918,"KRN",771,0)
771
"BLD",1918,"KRN",869.2,0)
869.2
"BLD",1918,"KRN",870,0)
870
"BLD",1918,"KRN",8994,0)
8994
"BLD",1918,"KRN","B",.4,.4)

"BLD",1918,"KRN","B",.401,.401)

"BLD",1918,"KRN","B",.402,.402)

"BLD",1918,"KRN","B",.403,.403)

"BLD",1918,"KRN","B",.5,.5)

"BLD",1918,"KRN","B",.84,.84)

"BLD",1918,"KRN","B",3.6,3.6)

"BLD",1918,"KRN","B",3.8,3.8)

"BLD",1918,"KRN","B",9.2,9.2)

"BLD",1918,"KRN","B",9.8,9.8)

"BLD",1918,"KRN","B",19,19)

"BLD",1918,"KRN","B",19.1,19.1)

"BLD",1918,"KRN","B",101,101)

"BLD",1918,"KRN","B",409.61,409.61)

"BLD",1918,"KRN","B",771,771)

"BLD",1918,"KRN","B",869.2,869.2)

"BLD",1918,"KRN","B",870,870)

"BLD",1918,"KRN","B",8994,8994)

"BLD",1918,"QUES",0)
^9.62^^
"BLD",1918,"REQB",0)
^9.611^2^2
"BLD",1918,"REQB",1,0)
OOPS*1.0*1^1
"BLD",1918,"REQB",2,0)
OOPS*1.0*2^1
"BLD",1918,"REQB","B","OOPS*1.0*1",1)

"BLD",1918,"REQB","B","OOPS*1.0*2",2)

"FIA",2260)
ASISTS ACCIDENT REPORTING
"FIA",2260,0)
^OOPS(2260,
"FIA",2260,0,0)
2260I
"FIA",2260,0,1)
y^y^p^^^^n
"FIA",2260,0,10)

"FIA",2260,0,11)

"FIA",2260,0,"RLRO")

"FIA",2260,0,"VR")
1.0^OOPS
"FIA",2260,2260)
1
"FIA",2260,2260,2)

"FIA",2260,2260,109)

"MBREQ")
0
"PKG",472,-1)
1^1
"PKG",472,0)
ASISTS^OOPS^Automated Safety Incident Surveillance Tracking System
"PKG",472,20,0)
^9.402P^^
"PKG",472,22,0)
^9.49I^1^1
"PKG",472,22,1,0)
1.0^^2980819^66481
"PKG",472,22,1,"PAH",1,0)
3
"PKG",472,22,1,"PAH",1,1,0)
^^1^1^2990615
"PKG",472,22,1,"PAH",1,1,1,0)
Editing and Address Issues
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
10
"RTN","OOPSCC")
0^1^B20074993
"RTN","OOPSCC",1,0)
OOPSCC ;HINES CIOFO/GWB-CREATE ASISTS CASE ;3/5/98
"RTN","OOPSCC",2,0)
 ;;1.0;ASISTS;**3**;Jun 01, 1998
"RTN","OOPSCC",3,0)
 N SUP,FYEAR,GRP,I,IEN2260,OOPS,IEN450,EMP,IEN200,PAID
"RTN","OOPSCC",4,0)
 D NOW^%DTC
"RTN","OOPSCC",5,0)
 S DATE=X,FYEAR="",FYEAR=$$FYEAR^OOPSCSN(X),NUM=$$NEWR^OOPSCSN(FYEAR)
"RTN","OOPSCC",6,0)
 S (NAME,SEX,SSN,DOB,STN,CCT,OCC,GRD,STP,EDU,ANS,PAID)=""
"RTN","OOPSCC",7,0)
 W @IOF
"RTN","OOPSCC",8,0)
 W !!," Case number ",NUM," will be assigned to this incident.",!
"RTN","OOPSCC",9,0)
 K DD,DO S DIC="^OOPS(2260,",DIC(0)="QLZ",X=NUM D FILE^DICN G:Y=-1 EXIT
"RTN","OOPSCC",10,0)
 S IEN2260=+Y
"RTN","OOPSCC",11,0)
PS K DR S DIE="^OOPS(2260,",DA=IEN2260,DR="2 PERSONNEL STATUS........."
"RTN","OOPSCC",12,0)
 D ^DIE
"RTN","OOPSCC",13,0)
 G:$D(Y)'=0 DELETE S CAT=X
"RTN","OOPSCC",14,0)
 I CAT=1 D  G:Y=-1 DELETE               ; Employee in ^PRSPC (PAID)
"RTN","OOPSCC",15,0)
 .S DIC="^PRSPC(",DIC("A")=" PERSON INVOLVED..........: ",DIC("B")=NAME
"RTN","OOPSCC",16,0)
 .S DIC("W")="W ?30,$E($P(^(0),U,9),6,9)"
"RTN","OOPSCC",17,0)
 .S DIC(0)="QEAMZ" D ^DIC Q:Y=-1
"RTN","OOPSCC",18,0)
 .S IEN450=+Y,NAME=$P(Y,U,2)
"RTN","OOPSCC",19,0)
 .N Y K DIQ S DIC="^PRSPC(",DR="6;8;10;13;16;31;32;38;458;604",DA=IEN450
"RTN","OOPSCC",20,0)
 .S DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSCC",21,0)
 .S STN=OOPS(450,IEN450,6,"I")
"RTN","OOPSCC",22,0)
 .S SSN=OOPS(450,IEN450,8,"I")
"RTN","OOPSCC",23,0)
 .S EDU=OOPS(450,IEN450,10,"E"),EDU=$E(EDU,1)_$$LOW^XLFSTR($E(EDU,2,45))
"RTN","OOPSCC",24,0)
 .S GRD=OOPS(450,IEN450,13,"I")
"RTN","OOPSCC",25,0)
 .S OCC=OOPS(450,IEN450,16,"I")
"RTN","OOPSCC",26,0)
 .S CCT=OOPS(450,IEN450,458,"I")
"RTN","OOPSCC",27,0)
 .S SEX=OOPS(450,IEN450,31,"I")
"RTN","OOPSCC",28,0)
 .S DOB=OOPS(450,IEN450,32,"I")
"RTN","OOPSCC",29,0)
 .S STP=OOPS(450,IEN450,38,"I")
"RTN","OOPSCC",30,0)
 ;
"RTN","OOPSCC",31,0)
 ; New Personnel Status = Non-Paid Employee. Get fields from ^VA(200
"RTN","OOPSCC",32,0)
 ; If Person in PAID file (PAID=1) don't allow adding as non-paid emp
"RTN","OOPSCC",33,0)
 ; If no SSN in file 200, set PAID=1, prevent hard errors
"RTN","OOPSCC",34,0)
 I CAT=6 D  G:(Y=-1!(PAID)) DELETE
"RTN","OOPSCC",35,0)
 .S DIC="^VA(200,",DIC("A")=" PERSON INVOLVED..........: ",DIC("B")=NAME
"RTN","OOPSCC",36,0)
 .S DIC("W")="W ?30,$E($P(^(1),U,9),6,9)"
"RTN","OOPSCC",37,0)
 .S DIC(0)="QEAMZ" D ^DIC Q:Y=-1
"RTN","OOPSCC",38,0)
 .S IEN200=+Y,NAME=$P(Y,U,2)
"RTN","OOPSCC",39,0)
 .; Make sure the person is not a PAID Employee - Patch 3
"RTN","OOPSCC",40,0)
 .S PAID=0
"RTN","OOPSCC",41,0)
 .; If no SSN, Can't continue - Patch 3
"RTN","OOPSCC",42,0)
 .I '$$GET1^DIQ(200,IEN200,9,"I") D  Q
"RTN","OOPSCC",43,0)
 ..W !,"No SSN on file in the New Person file. Must enter to create case."
"RTN","OOPSCC",44,0)
 ..S PAID=1
"RTN","OOPSCC",45,0)
 .N Y K DIQ S DIC="^VA(200,",DR="4;5;9",DA=IEN200
"RTN","OOPSCC",46,0)
 .S DIQ="OOPS",DIQ(0)="IE" D EN^DIQ1
"RTN","OOPSCC",47,0)
 .S SEX=OOPS(200,IEN200,4,"I")
"RTN","OOPSCC",48,0)
 .S DOB=OOPS(200,IEN200,5,"I")
"RTN","OOPSCC",49,0)
 .S SSN=OOPS(200,IEN200,9,"I")
"RTN","OOPSCC",50,0)
 .I $D(^PRSPC("SSN",SSN)) D
"RTN","OOPSCC",51,0)
 ..W !,"This person (SSN) is a 'PAID' Employee, Please Re-enter"
"RTN","OOPSCC",52,0)
 ..S PAID=1
"RTN","OOPSCC",53,0)
 K DR S DIE="^OOPS(2260,",DA=IEN2260,DR=""
"RTN","OOPSCC",54,0)
 I CAT=1 D                           ; Employee in ^PRSPC (PAID)
"RTN","OOPSCC",55,0)
 .S DR(1,2260,1)="1///^S X=NAME"
"RTN","OOPSCC",56,0)
 .S DR(1,2260,2)="5///^S X=SSN"
"RTN","OOPSCC",57,0)
 .S DR(1,2260,3)="6///^S X=DOB"
"RTN","OOPSCC",58,0)
 .S DR(1,2260,4)="7///^S X=SEX"
"RTN","OOPSCC",59,0)
 .S DR(1,2260,5)="13///^S X=STN"
"RTN","OOPSCC",60,0)
 .S DR(1,2260,6)="14///^S X=CCT"
"RTN","OOPSCC",61,0)
 .S DR(1,2260,7)="15///^S X=$E(OCC,1,4)"
"RTN","OOPSCC",62,0)
 .S DR(1,2260,8)="16///^S X=GRD"
"RTN","OOPSCC",63,0)
 .S DR(1,2260,9)="17///^S X=STP"
"RTN","OOPSCC",64,0)
 .S DR(1,2260,10)="18///^S X=EDU"
"RTN","OOPSCC",65,0)
 I CAT=6 D                           ; Employee not in ^PRSPC (Non-PAID)
"RTN","OOPSCC",66,0)
 .S DR(1,2260,1)="1///^S X=NAME"
"RTN","OOPSCC",67,0)
 .S DR(1,2260,2)="5///^S X=SSN"
"RTN","OOPSCC",68,0)
 .S DR(1,2260,3)="6///^S X=DOB"
"RTN","OOPSCC",69,0)
 .S DR(1,2260,4)="7///^S X=SEX"
"RTN","OOPSCC",70,0)
 I CAT'=1&(CAT'=6) D                 ; Everyone else
"RTN","OOPSCC",71,0)
 .S DR(1,2260,1)="1 PERSON INVOLVED.........."
"RTN","OOPSCC",72,0)
 .S DR(1,2260,2)="5 SSN......................"
"RTN","OOPSCC",73,0)
 S DR(1,2260,11)="8 HOME STREET ADDRESS......"
"RTN","OOPSCC",74,0)
 S DR(1,2260,12)="9 CITY....................."
"RTN","OOPSCC",75,0)
 S DR(1,2260,13)="10 STATE...................."
"RTN","OOPSCC",76,0)
 S DR(1,2260,14)="11 ZIP CODE................."
"RTN","OOPSCC",77,0)
 S DR(1,2260,15)="12 HOME PHONE NUMBER........"
"RTN","OOPSCC",78,0)
 S DR(1,2260,16)="52 INJURY/ILLNESS..........."
"RTN","OOPSCC",79,0)
 S DR(1,2260,17)="S Y=$S(X=1:""@1"",1:""@2"")"
"RTN","OOPSCC",80,0)
 S DR(1,2260,18)="@1"
"RTN","OOPSCC",81,0)
 S DR(1,2260,19)="4 DATE/TIME INJURY OCCURRED"
"RTN","OOPSCC",82,0)
 S DR(1,2260,20)="I $P(X,""."",2)="""" W !,""Time is REQUIRED in this response."" S Y=4"
"RTN","OOPSCC",83,0)
 S DR(1,2260,21)="S Y=3"
"RTN","OOPSCC",84,0)
 S DR(1,2260,22)="@2"
"RTN","OOPSCC",85,0)
 S DR(1,2260,23)="4 DATE 1ST AWARE OF ILLNESS"
"RTN","OOPSCC",86,0)
 S DR(1,2260,24)="3 TYPE OF INCIDENT........."
"RTN","OOPSCC",87,0)
 ; Patch 3 removed request Dr. Murphy 5/17/99
"RTN","OOPSCC",88,0)
 ; S DR(1,2260,25)="S:X<11 Y=""@3"""
"RTN","OOPSCC",89,0)
 ; S DR(1,2260,26)="W !!,"" TESTS ORDERED:"",!"
"RTN","OOPSCC",90,0)
 ; S DR(1,2260,27)="19 HEPATITIS B.............."
"RTN","OOPSCC",91,0)
 ; S DR(1,2260,28)="20 HEPATITIS C.............."
"RTN","OOPSCC",92,0)
 ; S DR(1,2260,29)="21 HIV......................"
"RTN","OOPSCC",93,0)
 ; S DR(1,2260,30)="22 OTHER...................."
"RTN","OOPSCC",94,0)
 ; S DR(1,2260,31)="23 DATE ORDERED............."
"RTN","OOPSCC",95,0)
 ; S DR(1,2260,32)="24 DATE DRAWN..............."
"RTN","OOPSCC",96,0)
 ; S DR(1,2260,33)="25 FOLLOW-UP DATE..........."
"RTN","OOPSCC",97,0)
 ; S DR(1,2260,34)="W !"
"RTN","OOPSCC",98,0)
 ; S DR(1,2260,35)="@3"
"RTN","OOPSCC",99,0)
 S SUP=$S((CAT=1!(CAT=6)):" SUPERVISOR...............",CAT=2:" VOLUNTARY SVC SUPERVISOR.",CAT=3:" CONTRACT ADMINISTRATOR...",1:" SAFETY OFFICER...........")
"RTN","OOPSCC",100,0)
 S DR(1,2260,36)="53"_SUP
"RTN","OOPSCC",101,0)
 S DR(1,2260,37)="53.1 SECONDARY SUPERVISOR....."
"RTN","OOPSCC",102,0)
 D ^DIE G:$D(Y)'=0 DELETE
"RTN","OOPSCC",103,0)
 S DIR(0)="S^E:Edit;S:Save;D:Delete",DIR("A")=" Case action" D ^DIR
"RTN","OOPSCC",104,0)
 I Y="E" S ANS="E" G PS
"RTN","OOPSCC",105,0)
 I Y="S" D  D CASE^OOPSMBUL(IEN2260) D:((CAT=1)!(CAT=6))&(SSN'="") BOR^OOPSMBUL(IEN2260):$D(^VA(200,"SSN",SSN)) G EXIT
"RTN","OOPSCC",106,0)
 .K DR S DIE="^OOPS(2260,",DA=IEN2260,DR="51///0" D ^DIE
"RTN","OOPSCC",107,0)
 .W !!," Case number ",NUM," has been saved.",!
"RTN","OOPSCC",108,0)
 I (Y="D")!($D(DIRUT)) G DELETE
"RTN","OOPSCC",109,0)
 G EXIT
"RTN","OOPSCC",110,0)
DELETE ;Delete incomplete case
"RTN","OOPSCC",111,0)
 S DIK="^OOPS(2260,",DA=IEN2260 D ^DIK
"RTN","OOPSCC",112,0)
END W !!," Case ",NUM," deleted"
"RTN","OOPSCC",113,0)
EXIT K NUM,NAME,SEX,SSN,DOB,STN,CCT,OCC,GRD,STP,EDU,ANS
"RTN","OOPSCC",114,0)
 Q
"RTN","OOPSDIS")
0^2^B5087273
"RTN","OOPSDIS",1,0)
OOPSDIS ;HIRMFO/GWB - Display 2162 ;3/5/98
"RTN","OOPSDIS",2,0)
 ;;1.0;ASISTS;**3**;Jun 01, 1998
"RTN","OOPSDIS",3,0)
 W @IOF
"RTN","OOPSDIS",4,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSDIS",5,0)
 ;Include logic for Non_PAID employee, CAT=6
"RTN","OOPSDIS",6,0)
 S SUP=$S((CAT=1!(CAT=6)):" SUPERVISOR.............: ",CAT=2:" VOLUNTARY SVC SUP......: ",CAT=3:" CONTRACT ADMINISTRATOR.: ",1:" SAFETY OFFICER.........: ")
"RTN","OOPSDIS",7,0)
 K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01:99",DA=IEN,DIQ="OOPS" D EN^DIQ1
"RTN","OOPSDIS",8,0)
 W !,"----------------------------------------------------------------------------"
"RTN","OOPSDIS",9,0)
 W !," CASE NUMBER............: ",OOPS(2260,IEN,.01)
"RTN","OOPSDIS",10,0)
 W !," PERSONNEL STATUS.......: ",OOPS(2260,IEN,2)
"RTN","OOPSDIS",11,0)
 W !," TYPE OF INCIDENT.......: ",OOPS(2260,IEN,3)
"RTN","OOPSDIS",12,0)
 W !," CASE STATUS............: ",OOPS(2260,IEN,51)
"RTN","OOPSDIS",13,0)
 W !," INJURY/ILLNESS.........: ",OOPS(2260,IEN,52)
"RTN","OOPSDIS",14,0)
 W !," PERSON INVOLVED........: ",OOPS(2260,IEN,1)
"RTN","OOPSDIS",15,0)
 W !," SSN....................: ",OOPS(2260,IEN,5)
"RTN","OOPSDIS",16,0)
 W !," DATE OF BIRTH..........: ",OOPS(2260,IEN,6)
"RTN","OOPSDIS",17,0)
 W !," SEX....................: ",OOPS(2260,IEN,7)
"RTN","OOPSDIS",18,0)
 W !," HOME ADDRESS...........: ",OOPS(2260,IEN,8)
"RTN","OOPSDIS",19,0)
 I (OOPS(2260,IEN,9)'="")!(OOPS(2260,IEN,10)'="")!(OOPS(2260,IEN,11)'="") W !,"                          ",OOPS(2260,IEN,9),", ",OOPS(2260,IEN,10)," ",OOPS(2260,IEN,11)
"RTN","OOPSDIS",20,0)
 W !," HOME PHONE NUMBER......: ",OOPS(2260,IEN,12)
"RTN","OOPSDIS",21,0)
 W !," STATION NUMBER.........: ",OOPS(2260,IEN,13)
"RTN","OOPSDIS",22,0)
 W !," COST CENTER/ORG........: ",OOPS(2260,IEN,14)
"RTN","OOPSDIS",23,0)
 W !," OCCUPATION.............: ",OOPS(2260,IEN,15)
"RTN","OOPSDIS",24,0)
 W !," GRADE/STEP.............: ",OOPS(2260,IEN,16) W:OOPS(2260,IEN,16)'="" "/" W OOPS(2260,IEN,17)
"RTN","OOPSDIS",25,0)
 W !," EDUCATION..............: ",OOPS(2260,IEN,18)
"RTN","OOPSDIS",26,0)
 W !,SUP,OOPS(2260,IEN,53)
"RTN","OOPSDIS",27,0)
 W !," SECONDARY SUPERVISOR...: ",OOPS(2260,IEN,53.1)
"RTN","OOPSDIS",28,0)
 W !," DATE/TIME OF OCCURRENCE: ",OOPS(2260,IEN,4)
"RTN","OOPSDIS",29,0)
 W !,"----------------------------------------------------------------------------"
"RTN","OOPSDIS",30,0)
 S SUP=OOPS(2260,IEN,53)
"RTN","OOPSDIS",31,0)
 K OOPS,DIQ,DIC,DR,DA,CAT Q
"RTN","OOPSEMP1")
0^3^B57121982
"RTN","OOPSEMP1",1,0)
OOPSEMP1 ;HINES/WAA,GTD - E/E Employee data Routines - 3/25/98 [ 04/17/1998  3:20 PM ]
"RTN","OOPSEMP1",2,0)
 ;;1.0;ASISTS;**1,3**;Jun 01, 1998
"RTN","OOPSEMP1",3,0)
 ;;
"RTN","OOPSEMP1",4,0)
 ;
"RTN","OOPSEMP1",5,0)
 ; Employee/Person Address is now only stored in the 2162A node
"RTN","OOPSEMP1",6,0)
 ; of file 2260.  Prior to patch 3 it was stored in the CA1A and
"RTN","OOPSEMP1",7,0)
 ; CA2A nodes depending on which form was entered.  The address
"RTN","OOPSEMP1",8,0)
 ; is only 'pulled' from this location when printing either form.
"RTN","OOPSEMP1",9,0)
 ;
"RTN","OOPSEMP1",10,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSEMP1",11,0)
 ;INPUT:
"RTN","OOPSEMP1",12,0)
 ;     CALLER = "E" FOR EMPLOYEE
"RTN","OOPSEMP1",13,0)
 ;            = "S" FOR SUPERVISOR
"RTN","OOPSEMP1",14,0)
 ;            = "O" FOR SAFETY OFFICER
"RTN","OOPSEMP1",15,0)
 N SSN,IEN
"RTN","OOPSEMP1",16,0)
 S IEN=0
"RTN","OOPSEMP1",17,0)
 Q:DUZ<1
"RTN","OOPSEMP1",18,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSEMP1",19,0)
 I CALLER="E" D  Q:$G(SSN)=""  Q:$D(^OOPS(2260,"SSN",SSN))<1
"RTN","OOPSEMP1",20,0)
 .S SSN=$P(^VA(200,DUZ,1),U,9)
"RTN","OOPSEMP1",21,0)
 .I '$G(SSN) W !!,"No SSN on file for this Employee" Q
"RTN","OOPSEMP1",22,0)
 .I $D(^OOPS(2260,"SSN",SSN))<1 D
"RTN","OOPSEMP1",23,0)
 ..W !!,"An Accident Report has not been created for this Employee"
"RTN","OOPSEMP1",24,0)
 D  Q:IEN<1
"RTN","OOPSEMP1",25,0)
 .N DIC,X,INT
"RTN","OOPSEMP1",26,0)
 .S DIC="^OOPS(2260,"
"RTN","OOPSEMP1",27,0)
 .I CALLER="E" S DIC("S")="I $$EMP^OOPSUTL1(Y,SSN)"
"RTN","OOPSEMP1",28,0)
 .I CALLER="S" S DIC("S")="I $$SUP^OOPSEMP1(DUZ,Y)"
"RTN","OOPSEMP1",29,0)
 .I CALLER="O" S DIC("S")="I $$SAFE^OOPSEMP1(Y)"
"RTN","OOPSEMP1",30,0)
 .; Added Non-PAID employee to filter
"RTN","OOPSEMP1",31,0)
 .S DIC("S")=DIC("S")_",($$GET1^DIQ(2260,Y,2,""I"")<3!($$GET1^DIQ(2260,Y,2,""I"")=6))"
"RTN","OOPSEMP1",32,0)
 .S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSEMP1",33,0)
 .D ^DIC
"RTN","OOPSEMP1",34,0)
 .Q:Y<1
"RTN","OOPSEMP1",35,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSEMP1",36,0)
 .S IEN=$P(Y,U)
"RTN","OOPSEMP1",37,0)
 .Q
"RTN","OOPSEMP1",38,0)
FORM S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSEMP1",39,0)
 S FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSEMP1",40,0)
 D CLEAR(IEN,FORM)
"RTN","OOPSEMP1",41,0)
 Q:FORM=""
"RTN","OOPSEMP1",42,0)
 D  Q:$D(Y)'=0
"RTN","OOPSEMP1",43,0)
 .N DR,DIE,SIGN2,OOPS
"RTN","OOPSEMP1",44,0)
 .I FORM="CA1" D
"RTN","OOPSEMP1",45,0)
 ..W !!," Federal Employee's Notice of Traumatic Injury and"
"RTN","OOPSEMP1",46,0)
 ..W !," Claim for Continuation of Pay/Compensation (Form CA-1)"
"RTN","OOPSEMP1",47,0)
 ..W !!,"     Employee Data"
"RTN","OOPSEMP1",48,0)
 ..W !,"     -------------"
"RTN","OOPSEMP1",49,0)
 ..K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01;1;2;4;5;6;7;16;17",DA=IEN,DIQ="OOPS",DIQ(0)="IE"
"RTN","OOPSEMP1",50,0)
 ..D EN^DIQ1
"RTN","OOPSEMP1",51,0)
 ..S CAT=OOPS(2260,IEN,2,"I")
"RTN","OOPSEMP1",52,0)
 ..S DR=""
"RTN","OOPSEMP1",53,0)
 ..S:CAT'=1&(CAT'=6) DR(1,2260,.1)="1  1. NAME OF EMPLOYEE......"
"RTN","OOPSEMP1",54,0)
 ..S:CAT=1!(CAT=6) DR(1,2260,.1)="W !,""  1. NAME OF EMPLOYEE......: "",OOPS(2260,IEN,1,""E"")"
"RTN","OOPSEMP1",55,0)
 ..S DR(1,2260,.2)="W !,""  2. SOCIAL SECURITY NUMBER: "",OOPS(2260,IEN,5,""E"")"
"RTN","OOPSEMP1",56,0)
 ..S:CAT'=1&(CAT'=6) DR(1,2260,.3)="6  3. DATE OF BIRTH........."
"RTN","OOPSEMP1",57,0)
 ..S:CAT=1!(CAT=6) DR(1,2260,.3)="W !,""  3. DATE OF BIRTH.........: "",OOPS(2260,IEN,6,""E"")"
"RTN","OOPSEMP1",58,0)
 ..S:CAT'=1&(CAT'=6) DR(1,2260,.4)="7  4. SEX..................."
"RTN","OOPSEMP1",59,0)
 ..S:CAT=1!(CAT=6) DR(1,2260,.4)="W !,""  4. SEX...................: "",OOPS(2260,IEN,7,""E"")"
"RTN","OOPSEMP1",60,0)
 ..S DR(1,2260,1)="12  5. HOME TELEPHONE........"
"RTN","OOPSEMP1",61,0)
 ..S DR(1,2260,2)="W !,""  6. GRADE/STEP............: "",OOPS(2260,IEN,16,""E""),""/"",OOPS(2260,IEN,17,""E"")"
"RTN","OOPSEMP1",62,0)
 ..S DR(1,2260,3)="W !,""  7. EMPLOYEE'S HOME MAILING ADDRESS:"""
"RTN","OOPSEMP1",63,0)
 ..S DR(1,2260,4)="8     STREET ADDRESS........"
"RTN","OOPSEMP1",64,0)
 ..S DR(1,2260,5)="9     CITY.................."
"RTN","OOPSEMP1",65,0)
 ..S DR(1,2260,6)="10     STATE................."
"RTN","OOPSEMP1",66,0)
 ..S DR(1,2260,7)="11     ZIP CODE.............."
"RTN","OOPSEMP1",67,0)
 ..S DR(1,2260,8)="107  8. DEPENDENTS............"
"RTN","OOPSEMP1",68,0)
 ..S DR(1,2260,8.1)="W !!,""     Description of Injury"""
"RTN","OOPSEMP1",69,0)
 ..S DR(1,2260,8.2)="W !,""     ---------------------"""
"RTN","OOPSEMP1",70,0)
 ..S DR(1,2260,9)="108  9. PLACE WHERE INJURY OCCURRED"
"RTN","OOPSEMP1",71,0)
 ..;
"RTN","OOPSEMP1",72,0)
 ..;Default the Date/Time Injury Occurred from the 2162
"RTN","OOPSEMP1",73,0)
 ..S DR(1,2260,10)="109 10. DATE/TIME INJURY OCCURRED..//^S X=OOPS(2260,IEN,4,""E"")"
"RTN","OOPSEMP1",74,0)
 ..S DR(1,2260,10.1)="I $P(X,""."",2)="""" W !,""Time is REQUIRED in this response."" S Y=109"
"RTN","OOPSEMP1",75,0)
 ..S DR(1,2260,11)="110 11. DATE OF THIS NOTICE........"
"RTN","OOPSEMP1",76,0)
 ..S DR(1,2260,12)="111 12. EMPLOYEE'S OCCUPATION......"
"RTN","OOPSEMP1",77,0)
 ..S DR(1,2260,13)="112 13. CAUSE OF INJURY............"
"RTN","OOPSEMP1",78,0)
 ..S DR(1,2260,14)="113 14. NATURE OF INJURY..........."
"RTN","OOPSEMP1",79,0)
 ..S DR(1,2260,14.1)="W !!,""     Employee Signature"""
"RTN","OOPSEMP1",80,0)
 ..S DR(1,2260,14.2)="W !,""     ------------------"""
"RTN","OOPSEMP1",81,0)
 ..S DR(1,2260,15)="114 15. REQUEST PAY OR LEAVE......."
"RTN","OOPSEMP1",82,0)
 ..S DR(1,2260,16)="W !!,""     Witness"""
"RTN","OOPSEMP1",83,0)
 ..S DR(1,2260,17)="W !,""     -------"""
"RTN","OOPSEMP1",84,0)
 ..S DR(1,2260,18)="115 16. NAME OF WITNESS............"
"RTN","OOPSEMP1",85,0)
 ..Q
"RTN","OOPSEMP1",86,0)
 .I FORM="CA2" D
"RTN","OOPSEMP1",87,0)
 ..W !!," Notice of Occupational Disease and Claim for Compensation (Form CA-2)"
"RTN","OOPSEMP1",88,0)
 ..W !!,"     Employee Data"
"RTN","OOPSEMP1",89,0)
 ..W !,"     -------------"
"RTN","OOPSEMP1",90,0)
 ..K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01;1;2;5;6;7;16;17",DA=IEN,DIQ="OOPS",DIQ(0)="IE"
"RTN","OOPSEMP1",91,0)
 ..D EN^DIQ1
"RTN","OOPSEMP1",92,0)
 ..S CAT=OOPS(2260,IEN,2,"I")
"RTN","OOPSEMP1",93,0)
 ..S DR=""
"RTN","OOPSEMP1",94,0)
 ..S:CAT'=1&(CAT'=6) DR(1,2260,.1)="1  1. NAME OF EMPLOYEE......"
"RTN","OOPSEMP1",95,0)
 ..S:CAT=1!(CAT=6) DR(1,2260,.1)="W !,""  1. NAME OF EMPLOYEE......: "",OOPS(2260,IEN,1,""E"")"
"RTN","OOPSEMP1",96,0)
 ..S DR(1,2260,.2)="W !,""  2. SOCIAL SECURITY NUMBER: "",OOPS(2260,IEN,5,""E"")"
"RTN","OOPSEMP1",97,0)
 ..S:CAT'=1&(CAT'=6) DR(1,2260,.3)="6  3. DATE OF BIRTH........."
"RTN","OOPSEMP1",98,0)
 ..S:CAT=1!(CAT=6) DR(1,2260,.3)="W !,""  3. DATE OF BIRTH.........: "",OOPS(2260,IEN,6,""E"")"
"RTN","OOPSEMP1",99,0)
 ..S:CAT'=1&(CAT'=6) DR(1,2260,.4)="7  4. SEX..................."
"RTN","OOPSEMP1",100,0)
 ..S:CAT=1!(CAT=6) DR(1,2260,.4)="W !,""  4. SEX...................: "",OOPS(2260,IEN,7,""E"")"
"RTN","OOPSEMP1",101,0)
 ..S DR(1,2260,1)="12  5. HOME TELEPHONE........"
"RTN","OOPSEMP1",102,0)
 ..S DR(1,2260,2)="W !,""  6. GRADE/STEP............: "",OOPS(2260,IEN,16,""E""),""/"",OOPS(2260,IEN,17,""E"")"
"RTN","OOPSEMP1",103,0)
 ..S DR(1,2260,3)="W !,""  7. EMPLOYEE'S HOME MAILING ADDRESS:"""
"RTN","OOPSEMP1",104,0)
 ..S DR(1,2260,4)="8     STREET ADDRESS........"
"RTN","OOPSEMP1",105,0)
 ..S DR(1,2260,5)="9     CITY.................."
"RTN","OOPSEMP1",106,0)
 ..S DR(1,2260,6)="10     STATE................."
"RTN","OOPSEMP1",107,0)
 ..S DR(1,2260,7)="11     ZIP CODE.............."
"RTN","OOPSEMP1",108,0)
 ..S DR(1,2260,8)="207  8. DEPENDENTS............"
"RTN","OOPSEMP1",109,0)
 ..S DR(1,2260,8.1)="W !!,""     Claim Information"""
"RTN","OOPSEMP1",110,0)
 ..S DR(1,2260,8.2)="W !,""     -----------------"""
"RTN","OOPSEMP1",111,0)
 ..S DR(1,2260,9)="208  9. EMPLOYEE'S OCCUPATION."
"RTN","OOPSEMP1",112,0)
 ..S DR(1,2260,9.1)="W !,"" 10. LOCATION WHERE YOU WORKED WHEN DISEASE OR ILLNESS OCCURRED:"""
"RTN","OOPSEMP1",113,0)
 ..S DR(1,2260,10)="209     LOCATION..............;I X="""" S Y=214;"
"RTN","OOPSEMP1",114,0)
 ..S DR(1,2260,11)="210     STREET ADDRESS........"
"RTN","OOPSEMP1",115,0)
 ..S DR(1,2260,12)="211     CITY.................."
"RTN","OOPSEMP1",116,0)
 ..S DR(1,2260,13)="212     STATE................."
"RTN","OOPSEMP1",117,0)
 ..S DR(1,2260,14)="213     ZIP CODE.............."
"RTN","OOPSEMP1",118,0)
 ..S DR(1,2260,15)="214 11. DATE YOU FIRST BECAME AWARE OF DISEASE OR ILLNESS"
"RTN","OOPSEMP1",119,0)
 ..S DR(1,2260,16)="215 12. DATE YOU FIRST REALIZED THE DISEASE OR ILLNESS WAS CAUSED BY OR AGGRAVATED      BY YOUR EMPLOYMENT"
"RTN","OOPSEMP1",120,0)
 ..S DR(1,2260,17)="216 13. EXPLAIN THE RELATIONSHIP TO YOUR EMPLOYMENT, AND WHY YOU CAME TO THIS           REALIZATION~"
"RTN","OOPSEMP1",121,0)
 ..S DR(1,2260,17.1)="W !"
"RTN","OOPSEMP1",122,0)
 ..S DR(1,2260,18)="217 14. NATURE OF DISEASE OR ILLNESS~"
"RTN","OOPSEMP1",123,0)
 ..S DR(1,2260,18.1)="W !"
"RTN","OOPSEMP1",124,0)
 ..S DR(1,2260,19)="218 15. IF THIS NOTICE AND CLAIM WAS NOT FILED WITH THE EMPLOYING AGENCY WITHIN         30 DAYS AFTER DATE SHOWN ABOVE IN ITEM #12, EXPLAIN THE REASON FOR THE          DELAY~"
"RTN","OOPSEMP1",125,0)
 ..S DR(1,2260,19.1)="W !"
"RTN","OOPSEMP1",126,0)
 ..S DR(1,2260,20)="219 16. IF A SEPARATE NARRATIVE STATEMENT IS NOT SUBMITTED WITH THIS FORM, EXPLAIN      REASON FOR DELAY~"
"RTN","OOPSEMP1",127,0)
 ..S DR(1,2260,20.1)="W !"
"RTN","OOPSEMP1",128,0)
 ..S DR(1,2260,21)="220 17. IF MEDICAL REPORTS ARE NOT SUBMITTED WITH THIS FORM, EXPLAIN REASON FOR         DELAY~"
"RTN","OOPSEMP1",129,0)
 ..Q
"RTN","OOPSEMP1",130,0)
 .S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSEMP1",131,0)
 .D ^DIE
"RTN","OOPSEMP1",132,0)
 .I $D(Y)'=0 Q
"RTN","OOPSEMP1",133,0)
 .N SIGN
"RTN","OOPSEMP1",134,0)
 .D SIGN(FORM)
"RTN","OOPSEMP1",135,0)
 .Q:SIGN=""                   ; Form was not signed
"RTN","OOPSEMP1",136,0)
 .I $P(SIGN,U) D
"RTN","OOPSEMP1",137,0)
 ..I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,1,3)=SIGN
"RTN","OOPSEMP1",138,0)
 ..I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,1,3)=SIGN
"RTN","OOPSEMP1",139,0)
 ..D EMP^OOPSMBUL(IEN)
"RTN","OOPSEMP1",140,0)
 ..Q
"RTN","OOPSEMP1",141,0)
 .Q
"RTN","OOPSEMP1",142,0)
 K HSA,CIT,STA,ZIP Q
"RTN","OOPSEMP1",143,0)
CLEAR(IEN,FORM) ; Clear out the old ES
"RTN","OOPSEMP1",144,0)
 N ES
"RTN","OOPSEMP1",145,0)
 S ES=$S(FORM="CA1":"CA1ES",FORM="CA2":"CA2ES",1:0) Q:ES=0
"RTN","OOPSEMP1",146,0)
 Q:$GET(^OOPS(2260,IEN,ES))=""
"RTN","OOPSEMP1",147,0)
 Q:$P(^OOPS(2260,IEN,ES),U,1,3)="^^"
"RTN","OOPSEMP1",148,0)
 S $P(^OOPS(2260,IEN,ES),U,1,3)="^^"
"RTN","OOPSEMP1",149,0)
 W !,"Your ES has been cleared.  You will need to resign.",!
"RTN","OOPSEMP1",150,0)
 Q
"RTN","OOPSEMP1",151,0)
SAFE(IEN) ; Safety Officer Screen
"RTN","OOPSEMP1",152,0)
 N VIEW,FORM,TYPE
"RTN","OOPSEMP1",153,0)
 S VIEW=1
"RTN","OOPSEMP1",154,0)
 S (TYPE,FORM)=$$GET1^DIQ(2260,IEN,52,"I"),FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSEMP1",155,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,TYPE) S VIEW=0 ; Employee Signed
"RTN","OOPSEMP1",156,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"S"),U,TYPE) S VIEW=0 ; Super Signed
"RTN","OOPSEMP1",157,0)
 I $$GET1^DIQ(2260,IEN,51,"I")'=0 S VIEW=0 ; Case is not open
"RTN","OOPSEMP1",158,0)
 Q VIEW
"RTN","OOPSEMP1",159,0)
SUP(DUZ,IEN) ; Supervisor Screen
"RTN","OOPSEMP1",160,0)
 N VIEW,FORM,SIGN,FORMS
"RTN","OOPSEMP1",161,0)
 S VIEW=1
"RTN","OOPSEMP1",162,0)
 S (FORMS,FORM)=$$GET1^DIQ(2260,IEN,52,"I"),FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSEMP1",163,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,FORMS) S VIEW=0 ; Employee Signed
"RTN","OOPSEMP1",164,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"S"),U,FORMS) S VIEW=0 ; Super Signed
"RTN","OOPSEMP1",165,0)
 I $$GET1^DIQ(2260,IEN,51,"I")'=0 S VIEW=0 ; Case is not open
"RTN","OOPSEMP1",166,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ S VIEW=0 ; Not Supervisor for case
"RTN","OOPSEMP1",167,0)
 Q VIEW
"RTN","OOPSEMP1",168,0)
SIGN(FORM) ; Sign/validate Document
"RTN","OOPSEMP1",169,0)
 N EMP,INC,VALID
"RTN","OOPSEMP1",170,0)
 S VALID=0,SIGN=""
"RTN","OOPSEMP1",171,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSEMP1",172,0)
 W ! D VALIDATE^OOPSUTL4(IEN,FORM,"E",.VALID)
"RTN","OOPSEMP1",173,0)
 I 'VALID Q
"RTN","OOPSEMP1",174,0)
 I CALLER="E" S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSEMP1",175,0)
 Q
"RTN","OOPSPRT")
0^4^B33480358
"RTN","OOPSPRT",1,0)
OOPSPRT ;HIRMFO/GWB - Print Report of Accident ;3/5/98
"RTN","OOPSPRT",2,0)
 ;;1.0;ASISTS;**2,3**;Jun 01, 1998
"RTN","OOPSPRT",3,0)
SUP S DIC="^OOPS(2260,"
"RTN","OOPSPRT",4,0)
 S DIC("S")="I $$GET1^DIQ(2260,Y,53,""I"")=DUZ!($$GET1^DIQ(2260,Y,53.1,""I"")=DUZ)"
"RTN","OOPSPRT",5,0)
 G DIC
"RTN","OOPSPRT",6,0)
SO S DIC="^OOPS(2260,"
"RTN","OOPSPRT",7,0)
DIC S DIC(0)="AEMNZ",DIC("A")="Select case: "
"RTN","OOPSPRT",8,0)
 D ^DIC Q:(Y<1)!($D(DTOUT))!($D(DUOUT))
"RTN","OOPSPRT",9,0)
 S IEN=+Y
"RTN","OOPSPRT",10,0)
 K IOP,%ZIS S %ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KILL
"RTN","OOPSPRT",11,0)
 I $D(IO("Q")) S OOPSLST="IEN^UNION" D TASK G KILL
"RTN","OOPSPRT",12,0)
 U IO D PRT D ^%ZISC K %ZIS,IOP G KILL
"RTN","OOPSPRT",13,0)
PRT N LIN,SUP,AETBF,CAT,PPE
"RTN","OOPSPRT",14,0)
 S PG=0,EX="",LIN=$S(IOST?1"C".E:IOSL-2,1:IOSL-6),IE=IEN
"RTN","OOPSPRT",15,0)
 D NOW^%DTC S DATE=%,Y=DATE X ^DD("DD") S DATE=$P(Y,":",1,2)
"RTN","OOPSPRT",16,0)
 K DIQ,DA,DR S DIC="^OOPS(2260,",DR=".01:99",DA=IEN,DIQ="OOPS" D EN^DIQ1
"RTN","OOPSPRT",17,0)
 I $D(^OOPS(2260,IEN,"2162E")) S EIEN=0 F  S EIEN=$O(^OOPS(2260,IEN,"2162E",EIEN)) Q:EIEN=""  K DIQ S DIC="^OOPS(2260,",DR=39,DA=IEN,DIQ="OOPS",DR(2260.039)=.01,DA(2260.039)=EIEN D EN^DIQ1
"RTN","OOPSPRT",18,0)
 I $D(^OOPS(2260,IEN,"2162F")) S FIEN=0 F  S FIEN=$O(^OOPS(2260,IEN,"2162F",FIEN)) Q:FIEN=""  K DIQ S DIC="^OOPS(2260,",DR=40,DA=IEN,DIQ="OOPS",DR(2260.01)=.01,DA(2260.01)=FIEN D EN^DIQ1
"RTN","OOPSPRT",19,0)
 S CN=OOPS(2260,IEN,.01)
"RTN","OOPSPRT",20,0)
 S CAT=OOPS(2260,IEN,2)
"RTN","OOPSPRT",21,0)
 S TOI=OOPS(2260,IEN,3)
"RTN","OOPSPRT",22,0)
 ; Changed CAT="Emp... to CAT["Emp to allow Non-PAID employees
"RTN","OOPSPRT",23,0)
 S SUP=$S(CAT["Employee":"SUPERVISOR...................:",CAT="Volunteer":"VOLUNTARY SVC SUPERVISOR.....:",CAT="Contractor":"CONTRACT ADMINISTRATOR.......:",1:"SAFETY OFFICER...............:")
"RTN","OOPSPRT",24,0)
 D HDR
"RTN","OOPSPRT",25,0)
 W !,"CASE NUMBER..................: ",OOPS(2260,IEN,.01) D P Q:EX=U
"RTN","OOPSPRT",26,0)
 W !,"PERSONNEL STATUS.............: ",OOPS(2260,IEN,2) D P Q:EX=U
"RTN","OOPSPRT",27,0)
 W !,"TYPE OF INCIDENT.............: ",OOPS(2260,IEN,3) D P Q:EX=U
"RTN","OOPSPRT",28,0)
 W !,"CASE STATUS..................: ",OOPS(2260,IEN,51) D P Q:EX=U
"RTN","OOPSPRT",29,0)
 W !,"INJURY/ILLNESS...............: ",OOPS(2260,IEN,52) D P Q:EX=U
"RTN","OOPSPRT",30,0)
 I $G(UNION)'="Y" W !,"PERSON INVOLVED..............: ",OOPS(2260,IEN,1) D P Q:EX=U
"RTN","OOPSPRT",31,0)
 I $G(UNION)'="Y" W !,"SSN..........................: ",OOPS(2260,IEN,5) D P Q:EX=U
"RTN","OOPSPRT",32,0)
 I $G(UNION)'="Y" W !,"DATE OF BIRTH................: ",OOPS(2260,IEN,6) D P Q:EX=U
"RTN","OOPSPRT",33,0)
 I $G(UNION)'="Y" W !,"SEX..........................: ",OOPS(2260,IEN,7) D P Q:EX=U
"RTN","OOPSPRT",34,0)
 I $G(UNION)'="Y" W !,"HOME ADDRESS.................: ",OOPS(2260,IEN,8) D P Q:EX=U
"RTN","OOPSPRT",35,0)
 I $G(UNION)'="Y",(OOPS(2260,IEN,9)'="")!(OOPS(2260,IEN,10)'="")!(OOPS(2260,IEN,11)'="") W !,"                               ",OOPS(2260,IEN,9),", ",OOPS(2260,IEN,10)," ",OOPS(2260,IEN,11) D P Q:EX=U
"RTN","OOPSPRT",36,0)
 I $G(UNION)'="Y" W !,"HOME PHONE NUMBER............: ",OOPS(2260,IEN,12) D P Q:EX=U
"RTN","OOPSPRT",37,0)
 W !,"STATION NUMBER...............: ",OOPS(2260,IEN,13) D P Q:EX=U
"RTN","OOPSPRT",38,0)
 I $G(UNION)'="Y" W !,"COST CENTER/ORG..............: ",OOPS(2260,IEN,14) D P Q:EX=U
"RTN","OOPSPRT",39,0)
 I $G(UNION)'="Y" W !,"OCCUPATION...................: ",OOPS(2260,IEN,15) D P Q:EX=U
"RTN","OOPSPRT",40,0)
 I $G(UNION)'="Y" W !,"GRADE/STEP...................: ",OOPS(2260,IEN,16) W:OOPS(2260,IEN,16)'="" "/" W OOPS(2260,IEN,17) D P Q:EX=U
"RTN","OOPSPRT",41,0)
 I $G(UNION)'="Y" W !,"EDUCATION....................: ",OOPS(2260,IEN,18) D P Q:EX=U
"RTN","OOPSPRT",42,0)
 I $G(UNION)'="Y" W !,SUP," ",OOPS(2260,IEN,53) D P Q:EX=U
"RTN","OOPSPRT",43,0)
 I $G(UNION)'="Y" W !,"SECONDARY SUPERVISOR.........: ",OOPS(2260,IEN,53.1) D P Q:EX=U
"RTN","OOPSPRT",44,0)
 W !,"DATE/TIME OF OCCURRENCE......: ",OOPS(2260,IEN,4) D P Q:EX=U
"RTN","OOPSPRT",45,0)
 ; Patch 3, removed at request Dr. Murphy
"RTN","OOPSPRT",46,0)
 ; I $G(UNION)'="Y",$P(^OOPS(2260,IEN,0),U,4)>10 D
"RTN","OOPSPRT",47,0)
 ; . W !,"TEST ORDERED:" D P Q:EX=U
"RTN","OOPSPRT",48,0)
 ; .W !," HEPATITIS B.................: ",OOPS(2260,IEN,19) D P Q:EX=U
"RTN","OOPSPRT",49,0)
 ; .W !," HEPATITIS C.................: ",OOPS(2260,IEN,20) D P Q:EX=U
"RTN","OOPSPRT",50,0)
 ; .W !," HIV.........................: ",OOPS(2260,IEN,21) D P Q:EX=U
"RTN","OOPSPRT",51,0)
 ; .W !," OTHER.......................: ",OOPS(2260,IEN,22) D P Q:EX=U
"RTN","OOPSPRT",52,0)
 ; .W !," DATE ORDERED................: ",OOPS(2260,IEN,23) D P Q:EX=U
"RTN","OOPSPRT",53,0)
 ; .W !," DATE DRAWN..................: ",OOPS(2260,IEN,24) D P Q:EX=U
"RTN","OOPSPRT",54,0)
 ; .W !," FOLLOW-UP DATE..............: ",OOPS(2260,IEN,25) D P Q:EX=U
"RTN","OOPSPRT",55,0)
 ;
"RTN","OOPSPRT",56,0)
 W !,"GENERAL SETTING OF INCIDENT..: ",OOPS(2260,IEN,26) D P Q:EX=U
"RTN","OOPSPRT",57,0)
 W !,"LOCATION OF INCIDENT.........: ",OOPS(2260,IEN,27) D P Q:EX=U
"RTN","OOPSPRT",58,0)
 W !,"CHARACTERIZATION OF INJURY...: ",OOPS(2260,IEN,29) D P Q:EX=U
"RTN","OOPSPRT",59,0)
 W !,"BODY PART MOST AFFECTED......: ",OOPS(2260,IEN,30) D P Q:EX=U
"RTN","OOPSPRT",60,0)
 W !,"ADDITIONAL BODY PART AFFECTED: ",OOPS(2260,IEN,30.1) D P Q:EX=U
"RTN","OOPSPRT",61,0)
 W !,"SIDE OF BODY AFFECTED........: ",OOPS(2260,IEN,31) D P Q:EX=U
"RTN","OOPSPRT",62,0)
 W !,"DUTY RETURNED TO.............: ",OOPS(2260,IEN,32) D P Q:EX=U
"RTN","OOPSPRT",63,0)
 W !,"LOST TIME....................: ",OOPS(2260,IEN,33) D P Q:EX=U
"RTN","OOPSPRT",64,0)
 W !,"DESCRIPTION OF INCIDENT......:"
"RTN","OOPSPRT",65,0)
 S DOI=0 F  S DOI=$O(OOPS(2260,IEN,28,DOI)) Q:DOI=""  W !," ",OOPS(2260,IEN,28,DOI) D P Q:EX=U
"RTN","OOPSPRT",66,0)
 I $P(^OOPS(2260,IEN,0),U,4)>10 D  Q:EX=U
"RTN","OOPSPRT",67,0)
 .W !,"PATIENT SOURCE...............: ",OOPS(2260,IEN,34) D P Q:EX=U
"RTN","OOPSPRT",68,0)
 I ($P(^OOPS(2260,IEN,0),U,4)=11)!($P(^OOPS(2260,IEN,0),U,4)=12) D
"RTN","OOPSPRT",69,0)
 .W !,"CONTAMINATION................: ",OOPS(2260,IEN,35) D P Q:EX=U
"RTN","OOPSPRT",70,0)
 .W !,"PURPOSE OF SHARP OBJECT......: ",OOPS(2260,IEN,36) D P Q:EX=U
"RTN","OOPSPRT",71,0)
 .W !,"ACTIVITY AT TIME OF INJURY...: ",OOPS(2260,IEN,37) D P Q:EX=U
"RTN","OOPSPRT",72,0)
 .W !,"OBJECT CAUSING INJURY........: ",OOPS(2260,IEN,38) D P Q:EX=U
"RTN","OOPSPRT",73,0)
 I $P(^OOPS(2260,IEN,0),U,4)=13 D  Q:EX=U
"RTN","OOPSPRT",74,0)
 .W !,"AREA EXPOSED TO BODILY FLUID.: "
"RTN","OOPSPRT",75,0)
 .K IND S AETBF=0 F  S AETBF=$O(OOPS(2260.039,AETBF)) Q:AETBF=""  W ?31,OOPS(2260.039,AETBF,.01),! S IND="" D P Q:EX=U
"RTN","OOPSPRT",76,0)
 .W:'$D(IND) ! W "PERSONAL PROTECTIVE EQUIPMENT: " K IND
"RTN","OOPSPRT",77,0)
 .K IND S PPE=0 F  S PPE=$O(OOPS(2260.01,PPE)) Q:PPE=""  W ?31,OOPS(2260.01,PPE,.01),! S IND="" D P Q:EX=U
"RTN","OOPSPRT",78,0)
 .W:'$D(IND) ! W "BODILY FLUID EXPOSURE SOURCE.: ",OOPS(2260,IEN,41) K IND D P Q:EX=U
"RTN","OOPSPRT",79,0)
 I $P(^OOPS(2260,IEN,0),U,4)>10 D  Q:EX=U
"RTN","OOPSPRT",80,0)
 .W !,"EQUIPMENT/DEVICE FAILURE.....: ",OOPS(2260,IEN,42) D P Q:EX=U
"RTN","OOPSPRT",81,0)
 .W !,"SAFETY DESIGN DEVICE USED....: ",OOPS(2260,IEN,43) D P Q:EX=U
"RTN","OOPSPRT",82,0)
 I $G(UNION)'="Y" W !,"/ES/SUPERVISOR...............: ",OOPS(2260,IEN,44) D P Q:EX=U
"RTN","OOPSPRT",83,0)
 W !,"SUPERVISOR SIGNATURE DATE....: ",OOPS(2260,IEN,46) D P Q:EX=U
"RTN","OOPSPRT",84,0)
 W !,"/ES/SAFETY OFFICER...........: ",OOPS(2260,IEN,48) D P Q:EX=U
"RTN","OOPSPRT",85,0)
 W !,"SAFETY OFFICER SIGNATURE DATE: ",OOPS(2260,IEN,50) D P Q:EX=U
"RTN","OOPSPRT",86,0)
 W !,"CORRECTIVE ACTION............:"
"RTN","OOPSPRT",87,0)
 S (CA,CACNT)=0 F  S CA=$O(OOPS(2260,IEN,47,CA)) Q:CA=""  S CACNT=CACNT+1
"RTN","OOPSPRT",88,0)
 S CA=0 F I=1:1:CACNT S CA=$O(OOPS(2260,IEN,47,CA)) W !," ",OOPS(2260,IEN,47,CA) D:I'=CACNT P Q:EX=U
"RTN","OOPSPRT",89,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR W @IOF
"RTN","OOPSPRT",90,0)
KILL ;Kill Variables and Exit
"RTN","OOPSPRT",91,0)
 K %,DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","OOPSPRT",92,0)
 K CA,CACNT,CN,D0,DA,DASHES,DATE,DIC,DIQ,DIQ2,DOI,DR,EIEN,EX,FIEN,I,IE
"RTN","OOPSPRT",93,0)
 K IEN,OOPS,PG,TOI,SUP,UNION
"RTN","OOPSPRT",94,0)
 Q
"RTN","OOPSPRT",95,0)
P ;Print
"RTN","OOPSPRT",96,0)
 I ($Y'<(LIN-3)) D  Q:EX=U
"RTN","OOPSPRT",97,0)
 .I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","OOPSPRT",98,0)
 .D HDR Q
"RTN","OOPSPRT",99,0)
 Q
"RTN","OOPSPRT",100,0)
TASK ;Queue a task
"RTN","OOPSPRT",101,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE
"RTN","OOPSPRT",102,0)
 S ZTRTN="PRT^OOPSPRT",ZTREQ="@",ZTSAVE("ZTREQ")=""
"RTN","OOPSPRT",103,0)
 S ZTDESC="ASISTS REPORT OF ACCIDENT"
"RTN","OOPSPRT",104,0)
 F V2=1:1 S V1=$P(OOPSLST,"^",V2) Q:V1=""  S ZTSAVE(V1)=""
"RTN","OOPSPRT",105,0)
 D ^%ZTLOAD D ^%ZISC U IO W !,"Request Queued",!
"RTN","OOPSPRT",106,0)
 K V1,V2,OOPSLST,ZTSK Q
"RTN","OOPSPRT",107,0)
HDR ;Header
"RTN","OOPSPRT",108,0)
 W @IOF S PG=PG+1 K DASHES S $P(DASHES,"-",80)="-"
"RTN","OOPSPRT",109,0)
 W !,"Report of Accident ",CN,?73,"Page ",PG
"RTN","OOPSPRT",110,0)
 ;W ?62,ONDATE,!,DASHES
"RTN","OOPSPRT",111,0)
 W !,DASHES
"RTN","OOPSPRT",112,0)
 Q
"RTN","OOPSPRT",113,0)
UNION ; Union Entry point
"RTN","OOPSPRT",114,0)
 S UNION="Y"
"RTN","OOPSPRT",115,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSPRT",116,0)
 S DIC("S")="I $$UNION^OOPSUTL4(Y)"
"RTN","OOPSPRT",117,0)
 G DIC
"RTN","OOPSPRT1")
0^5^B20754278
"RTN","OOPSPRT1",1,0)
OOPSPRT1 ;HINES/WAA - Utilities Routines - 3/24/98
"RTN","OOPSPRT1",2,0)
 ;;1.0;ASISTS;**2,3**;Jun 01, 1998
"RTN","OOPSPRT1",3,0)
 ;;
"RTN","OOPSPRT1",4,0)
 ; This routine is to display all the report that a person has
"RTN","OOPSPRT1",5,0)
 ; access to.
"RTN","OOPSPRT1",6,0)
EN1(CALLER) ;
"RTN","OOPSPRT1",7,0)
 ; Input:
"RTN","OOPSPRT1",8,0)
 ;    Caller O = Safety Officer
"RTN","OOPSPRT1",9,0)
 ;           U = Union
"RTN","OOPSPRT1",10,0)
 ;           S = Supervisor
"RTN","OOPSPRT1",11,0)
 ;           E = Employee
"RTN","OOPSPRT1",12,0)
 ; 
"RTN","OOPSPRT1",13,0)
 N YEAR,OUT,PAGE
"RTN","OOPSPRT1",14,0)
 S OUT=0,PAGE=1
"RTN","OOPSPRT1",15,0)
 S YEAR=""
"RTN","OOPSPRT1",16,0)
 I CALLER="E" D
"RTN","OOPSPRT1",17,0)
 .S SSN=$P(^VA(200,DUZ,1),U,9)
"RTN","OOPSPRT1",18,0)
 .Q:$D(^OOPS(2260,"SSN",SSN))<1
"RTN","OOPSPRT1",19,0)
 .Q
"RTN","OOPSPRT1",20,0)
 D RANGE(.YEAR,.OUT)
"RTN","OOPSPRT1",21,0)
 D:'OUT DEVICE
"RTN","OOPSPRT1",22,0)
 I 'OUT D:'$D(IO("Q")) PRINT
"RTN","OOPSPRT1",23,0)
 D EXIT
"RTN","OOPSPRT1",24,0)
 Q
"RTN","OOPSPRT1",25,0)
EXIT ;
"RTN","OOPSPRT1",26,0)
 K IO("Q")
"RTN","OOPSPRT1",27,0)
 Q
"RTN","OOPSPRT1",28,0)
RANGE(YEAR,OUT) ; This Subroutine will allow the user to select a range.
"RTN","OOPSPRT1",29,0)
 ; Output
"RTN","OOPSPRT1",30,0)
 ;   YEAR = The year that the user what to print
"RTN","OOPSPRT1",31,0)
 ;        = "" all years
"RTN","OOPSPRT1",32,0)
 ;
"RTN","OOPSPRT1",33,0)
 N DIR,DIRUT,Y
"RTN","OOPSPRT1",34,0)
R1 S DIR(0)="NAO^0:9999:0"
"RTN","OOPSPRT1",35,0)
 S DIR("A")="Select the Fiscal Year or RETURN for ALL: "
"RTN","OOPSPRT1",36,0)
 S DIR("??")="Enter the Fiscal Year that you want to print for or RETURN for data in file"
"RTN","OOPSPRT1",37,0)
 D ^DIR
"RTN","OOPSPRT1",38,0)
 I $D(DTOUT)!($D(DUOUT)) S OUT=1 Q
"RTN","OOPSPRT1",39,0)
 I Y'="",$L(Y)'=4 W !,"You must enter a 4 digit year." G R1
"RTN","OOPSPRT1",40,0)
 S YEAR=Y
"RTN","OOPSPRT1",41,0)
 I YEAR'="",'$O(^OOPS(2260,"B",(YEAR_"00000"))) W !,"No date for that Fiscal Year please select again." G R1
"RTN","OOPSPRT1",42,0)
 Q
"RTN","OOPSPRT1",43,0)
DEVICE ; This is the device selection routine.
"RTN","OOPSPRT1",44,0)
 ;
"RTN","OOPSPRT1",45,0)
 S %ZIS="QM" D ^%ZIS I POP S OUT=1 Q
"RTN","OOPSPRT1",46,0)
 I $D(IO("Q")) D  Q
"RTN","OOPSPRT1",47,0)
 .S ZTRTN="PRINT^OOPSPRT1",ZTDESC="Print Accident Report Sign-off list"
"RTN","OOPSPRT1",48,0)
 .S ZTSAVE("YEAR")=""
"RTN","OOPSPRT1",49,0)
 .S ZTSAVE("OUT")=""
"RTN","OOPSPRT1",50,0)
 .S ZTSAVE("CALLER")=""
"RTN","OOPSPRT1",51,0)
 .S ZTSAVE("SSN")=""
"RTN","OOPSPRT1",52,0)
 .S ZTSAVE("PAGE")=""
"RTN","OOPSPRT1",53,0)
 .D ^%ZTLOAD D HOME^%ZIS Q
"RTN","OOPSPRT1",54,0)
 .Q
"RTN","OOPSPRT1",55,0)
 Q
"RTN","OOPSPRT1",56,0)
PRINT ; This is the main print portion of the routine
"RTN","OOPSPRT1",57,0)
 N CNT,LOOP,OUTPUT
"RTN","OOPSPRT1",58,0)
 S CNT=0,OUTPUT=0
"RTN","OOPSPRT1",59,0)
 S LOOP=$S(YEAR'="":YEAR_"-00000",1:0)
"RTN","OOPSPRT1",60,0)
 U IO
"RTN","OOPSPRT1",61,0)
MAIN ; Main Loop
"RTN","OOPSPRT1",62,0)
 F  S LOOP=$O(^OOPS(2260,"B",LOOP)) Q:LOOP<1  D  Q:OUT
"RTN","OOPSPRT1",63,0)
 .N IEN,CASE,NAME,SSN1,DATE,INC,CAT
"RTN","OOPSPRT1",64,0)
 .I YEAR'="",YEAR'=$E(LOOP,1,4) S OUT=1 Q
"RTN","OOPSPRT1",65,0)
 .S IEN=$O(^OOPS(2260,"B",LOOP,0))
"RTN","OOPSPRT1",66,0)
 .I IEN<1 S OUT=1 Q
"RTN","OOPSPRT1",67,0)
 .I $G(^OOPS(2260,IEN,0))="" S OUT=1 Q
"RTN","OOPSPRT1",68,0)
 .D HEAD Q:OUT
"RTN","OOPSPRT1",69,0)
 .S CASE=LOOP
"RTN","OOPSPRT1",70,0)
 .; Only get OPEN cases - field 51 - 0 = OPEN
"RTN","OOPSPRT1",71,0)
 .I $$GET1^DIQ(2260,IEN,51,"I") Q
"RTN","OOPSPRT1",72,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSPRT1",73,0)
 .S NAME=$E($$GET1^DIQ(2260,IEN,1,"E"),1,30)
"RTN","OOPSPRT1",74,0)
 .S SSN1=$$GET1^DIQ(2260,IEN,5,"E")
"RTN","OOPSPRT1",75,0)
 .S DATE=$$GET1^DIQ(2260,IEN,4,"E")
"RTN","OOPSPRT1",76,0)
 .S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSPRT1",77,0)
 .S CNT=CNT+1
"RTN","OOPSPRT1",78,0)
 .I CALLER="E" Q:SSN'=SSN1
"RTN","OOPSPRT1",79,0)
 .I CALLER="S" I ($$GET1^DIQ(2260,IEN,53,"I")'=DUZ),($$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ) Q
"RTN","OOPSPRT1",80,0)
 .W !!,CASE
"RTN","OOPSPRT1",81,0)
 .W:CALLER'="U" ?12,NAME,?42,SSN1
"RTN","OOPSPRT1",82,0)
 .W ?57,DATE S OUTPUT=1
"RTN","OOPSPRT1",83,0)
 .W !,?35,"   CA1   ",?50,"   CA2   ",?65,"  2162   "
"RTN","OOPSPRT1",84,0)
 .W !,?35,"---------",?50,"---------",?65,"---------"
"RTN","OOPSPRT1",85,0)
 .D  ; Employee Data
"RTN","OOPSPRT1",86,0)
 ..N SIGN
"RTN","OOPSPRT1",87,0)
 ..S SIGN=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSPRT1",88,0)
 ..W !,?20,"EMPLOYEE:"
"RTN","OOPSPRT1",89,0)
 ..I INC=1 W ?35
"RTN","OOPSPRT1",90,0)
 ..I INC=2 W ?50
"RTN","OOPSPRT1",91,0)
 ..; Also, not a Non-PAID Employee either
"RTN","OOPSPRT1",92,0)
 ..I CAT>2,(CAT'=6) W "N/A(",$E($$GET1^DIQ(2260,IEN,2,"E"),1,7),")" Q
"RTN","OOPSPRT1",93,0)
 ..W $S($P(SIGN,U,INC):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",94,0)
 ..Q
"RTN","OOPSPRT1",95,0)
 .Q:CALLER="E"
"RTN","OOPSPRT1",96,0)
 .D  ; Supervisor Data
"RTN","OOPSPRT1",97,0)
 ..N SIGN
"RTN","OOPSPRT1",98,0)
 ..S SIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSPRT1",99,0)
 ..W !,?20,"SUPERVISOR:"
"RTN","OOPSPRT1",100,0)
 ..I INC=1 W ?35
"RTN","OOPSPRT1",101,0)
 ..I INC=2 W ?50
"RTN","OOPSPRT1",102,0)
 ..;Also not a Non-Paid Employee either
"RTN","OOPSPRT1",103,0)
 ..I CAT>2,(CAT'=6) W "N/A(",$E($$GET1^DIQ(2260,IEN,2,"E"),1,7),")"
"RTN","OOPSPRT1",104,0)
 ..E  W $S($P(SIGN,U,INC):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",105,0)
 ..W ?65,$S($P(SIGN,U,3):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",106,0)
 ..Q
"RTN","OOPSPRT1",107,0)
 .Q:CALLER="S"
"RTN","OOPSPRT1",108,0)
 .D  ; Safety Officer Data
"RTN","OOPSPRT1",109,0)
 ..N SIGN
"RTN","OOPSPRT1",110,0)
 ..S SIGN=$$EDSTA^OOPSUTL1(IEN,"O")
"RTN","OOPSPRT1",111,0)
 ..W !,?20,"SAFETY OFFICER:"
"RTN","OOPSPRT1",112,0)
 ..W ?65,$S($P(SIGN,U):" ",1:"UN-"),"SIGNED"
"RTN","OOPSPRT1",113,0)
 ..Q
"RTN","OOPSPRT1",114,0)
 .Q
"RTN","OOPSPRT1",115,0)
END ; exit the report
"RTN","OOPSPRT1",116,0)
 I 'OUTPUT W !,?20,"No Data Found for this report."
"RTN","OOPSPRT1",117,0)
 D ^%ZISC
"RTN","OOPSPRT1",118,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","OOPSPRT1",119,0)
 Q
"RTN","OOPSPRT1",120,0)
HEAD ; This is the head portion of the routine
"RTN","OOPSPRT1",121,0)
 I PAGE=1 D
"RTN","OOPSPRT1",122,0)
 .W:$E(IOST,1)="C" @IOF
"RTN","OOPSPRT1",123,0)
 .Q
"RTN","OOPSPRT1",124,0)
 I PAGE'=1 Q:$Y<(IOSL-6)
"RTN","OOPSPRT1",125,0)
 I $E(IOST,1)="C" D  Q:OUT
"RTN","OOPSPRT1",126,0)
 .I PAGE=1 W @IOF Q
"RTN","OOPSPRT1",127,0)
 .I PAGE'=1 D  Q:OUT
"RTN","OOPSPRT1",128,0)
 ..N DIR S DIR(0)="E" D ^DIR I 'Y S OUT=1
"RTN","OOPSPRT1",129,0)
 ..K Y
"RTN","OOPSPRT1",130,0)
 ..Q
"RTN","OOPSPRT1",131,0)
 .Q
"RTN","OOPSPRT1",132,0)
 Q:OUT
"RTN","OOPSPRT1",133,0)
 I PAGE'=1 W @IOF
"RTN","OOPSPRT1",134,0)
 N LINER,TAB
"RTN","OOPSPRT1",135,0)
 W !,$$FMTE^XLFDT($$NOW^XLFDT,1),?70,"PAGE: ",PAGE,!
"RTN","OOPSPRT1",136,0)
 S LINER="Accident Report Status"_$S(YEAR="":"",1:" for the fiscal Year "_YEAR)
"RTN","OOPSPRT1",137,0)
 S TAB=(40-($L(LINER)/2))
"RTN","OOPSPRT1",138,0)
 W ?TAB,LINER
"RTN","OOPSPRT1",139,0)
 W !,"Case No."
"RTN","OOPSPRT1",140,0)
 W:CALLER'="U" ?12,"Name",?46,"SSN"
"RTN","OOPSPRT1",141,0)
 W ?57,"DATE OF INCIDENT"
"RTN","OOPSPRT1",142,0)
 W !,"============================================================================="
"RTN","OOPSPRT1",143,0)
 S PAGE=PAGE+1
"RTN","OOPSPRT1",144,0)
 Q
"RTN","OOPSSUP1")
0^6^B33022148
"RTN","OOPSSUP1",1,0)
OOPSSUP1 ;HINES/WAA - S/E Supervisor Edit routine [ 04/17/1998  3:18 PM ]
"RTN","OOPSSUP1",2,0)
 ;;1.0;ASISTS;**1,3**;Jun 01, 1998
"RTN","OOPSSUP1",3,0)
 ;;
"RTN","OOPSSUP1",4,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSSUP1",5,0)
 S CALLER=$G(CALLER,"S") ; check CALLER
"RTN","OOPSSUP1",6,0)
 N SSN,IEN,EDIT,OUT,FORM,SUP
"RTN","OOPSSUP1",7,0)
 S EDIT=""
"RTN","OOPSSUP1",8,0)
 S (OUT,IEN)=0
"RTN","OOPSSUP1",9,0)
 Q:DUZ<1
"RTN","OOPSSUP1",10,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSSUP1",11,0)
 D INCIDENT(CALLER) Q:IEN<1  ; Select a Employee
"RTN","OOPSSUP1",12,0)
 D DISPLAY ; Display header information
"RTN","OOPSSUP1",13,0)
 D SELECT  ; Select the form to be processed.
"RTN","OOPSSUP1",14,0)
 Q:EDIT=""
"RTN","OOPSSUP1",15,0)
 D FORMS ; Process the forms that ther user selected
"RTN","OOPSSUP1",16,0)
 Q
"RTN","OOPSSUP1",17,0)
DISPLAY ; Display case data
"RTN","OOPSSUP1",18,0)
 D ^OOPSDIS
"RTN","OOPSSUP1",19,0)
 Q
"RTN","OOPSSUP1",20,0)
SELECT ; Select a form
"RTN","OOPSSUP1",21,0)
 ; Injury (2162,CA1)
"RTN","OOPSSUP1",22,0)
 ; Illness (2162,CA2)
"RTN","OOPSSUP1",23,0)
 ; VA form 2162
"RTN","OOPSSUP1",24,0)
 ; Get the type of incident
"RTN","OOPSSUP1",25,0)
 ; If the supporting global doesn't exist force the 
"RTN","OOPSSUP1",26,0)
 ; Supervisor to fill both the 2162 and supporting form.
"RTN","OOPSSUP1",27,0)
 N SIGN,INC,SAFE,CAT
"RTN","OOPSSUP1",28,0)
 S EDIT=""
"RTN","OOPSSUP1",29,0)
 S SIGN=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSSUP1",30,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",31,0)
 S SAFE=+$$EDSTA^OOPSUTL1(IEN,"O")
"RTN","OOPSSUP1",32,0)
 ; Allow Non-PAID employee - CAT=6
"RTN","OOPSSUP1",33,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP1",34,0)
 I CAT>2,CAT'=6,'SAFE S EDIT="2162" Q  ; Person is not EMP/VOL/NONPAID
"RTN","OOPSSUP1",35,0)
 I SAFE S EDIT=$P("CA1^CA2",U,INC) Q
"RTN","OOPSSUP1",36,0)
 ;  ^...The safety officer has sign and ca1 or ca2 can be edited
"RTN","OOPSSUP1",37,0)
 S INCTYP=$P("CA1^CA2",U,INC)
"RTN","OOPSSUP1",38,0)
 I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC) S EDIT="2162" Q
"RTN","OOPSSUP1",39,0)
 I '$$CHECK^OOPSUTL3(IEN,INCTYP) S EDIT="2162^"_INCTYP Q
"RTN","OOPSSUP1",40,0)
 ;     No data has been entered for the ca1/2
"RTN","OOPSSUP1",41,0)
 ; ^^^ Force the Super to edit both and once.
"RTN","OOPSSUP1",42,0)
 S EDIT=""
"RTN","OOPSSUP1",43,0)
 I '$P(SIGN,U,3)
"RTN","OOPSSUP1",44,0)
 N DIR,Y
"RTN","OOPSSUP1",45,0)
 N PROMPT1,PROMPT2,SEL1,SEL2
"RTN","OOPSSUP1",46,0)
 S PROMPT1="1) VA FORM 2162 "
"RTN","OOPSSUP1",47,0)
 S PROMPT2="              2) "_$S(INC=1:"Injury (CA1",INC=2:"Illness (CA2",1:"")_")"
"RTN","OOPSSUP1",48,0)
 W !," Select form: ",PROMPT1
"RTN","OOPSSUP1",49,0)
 W !,PROMPT2
"RTN","OOPSSUP1",50,0)
 S DIR(0)="SAO^1:2162;2:"_$S(INC=1:"CA1",INC=2:"CA2",1:"")
"RTN","OOPSSUP1",51,0)
 S DIR("A")=" Select form: "
"RTN","OOPSSUP1",52,0)
 S DIR("?")=" Select the form to be edited."
"RTN","OOPSSUP1",53,0)
 D ^DIR
"RTN","OOPSSUP1",54,0)
 I '$D(Y(0)) S EDIT="" Q
"RTN","OOPSSUP1",55,0)
 S EDIT=Y(0)
"RTN","OOPSSUP1",56,0)
 Q
"RTN","OOPSSUP1",57,0)
CLEAR(IEN,FORM) ; Clear out the old ES
"RTN","OOPSSUP1",58,0)
 N ES,FLG
"RTN","OOPSSUP1",59,0)
 S FLG=0
"RTN","OOPSSUP1",60,0)
 S ES=$S(FORM="CA1":"CA1ES",FORM="CA2":"CA2ES",FORM="2162":"2162ES",1:0) Q:ES=0
"RTN","OOPSSUP1",61,0)
 Q:$GET(^OOPS(2260,IEN,ES))=""
"RTN","OOPSSUP1",62,0)
 I FORM'=2162 D  I FLG S $P(^OOPS(2260,IEN,ES),U,4,6)="^^"
"RTN","OOPSSUP1",63,0)
 .N I
"RTN","OOPSSUP1",64,0)
 .F I=4:1:6 I $P(^OOPS(2260,IEN,ES),U,I)'="" S FLG=1 Q
"RTN","OOPSSUP1",65,0)
 .Q
"RTN","OOPSSUP1",66,0)
 I FORM=2162 D  I FLG S $P(^OOPS(2260,IEN,ES),U,1,3)="^^"
"RTN","OOPSSUP1",67,0)
 .N I
"RTN","OOPSSUP1",68,0)
 .F I=1:1:3 I $P(^OOPS(2260,IEN,ES),U,I)'="" S FLG=1 Q
"RTN","OOPSSUP1",69,0)
 .Q
"RTN","OOPSSUP1",70,0)
 I FLG W !,"Your ES for ",FORM," has been cleared.  You will need to resign.",!
"RTN","OOPSSUP1",71,0)
 Q
"RTN","OOPSSUP1",72,0)
INCIDENT(CALLER) ; Select a case
"RTN","OOPSSUP1",73,0)
 N DIC,X
"RTN","OOPSSUP1",74,0)
 S DIC="^OOPS(2260,"
"RTN","OOPSSUP1",75,0)
 I CALLER="S" S DIC("S")="I $$SUP^OOPSSUP1(Y)"
"RTN","OOPSSUP1",76,0)
 I CALLER="O" S DIC("S")="I $$SAFETY^OOPSSUP1(Y)"
"RTN","OOPSSUP1",77,0)
 S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSSUP1",78,0)
 D ^DIC
"RTN","OOPSSUP1",79,0)
 Q:Y<1
"RTN","OOPSSUP1",80,0)
 Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSSUP1",81,0)
 S IEN=$P(Y,U)
"RTN","OOPSSUP1",82,0)
 Q
"RTN","OOPSSUP1",83,0)
SUP(IEN) ; Supervisor Screen
"RTN","OOPSSUP1",84,0)
 N VIEW,CAT
"RTN","OOPSSUP1",85,0)
 S VIEW=1
"RTN","OOPSSUP1",86,0)
 I $$GET1^DIQ(2260,IEN,51,"I") S VIEW=0 ; Case is not open
"RTN","OOPSSUP1",87,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ S VIEW=0 ; Not the Super or Alternate Super
"RTN","OOPSSUP1",88,0)
 ; Allow Non-PAID employee - CAT=6
"RTN","OOPSSUP1",89,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP1",90,0)
 I CAT>2&(CAT'=6) D  ; person is not an employee
"RTN","OOPSSUP1",91,0)
 .I +$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0 Q  ; Safety has signed
"RTN","OOPSSUP1",92,0)
 .Q
"RTN","OOPSSUP1",93,0)
 E  D  ; This will filter emps who have sign, sup who sign and safety who sign
"RTN","OOPSSUP1",94,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",95,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),+$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSSUP1",96,0)
 .Q
"RTN","OOPSSUP1",97,0)
 Q VIEW
"RTN","OOPSSUP1",98,0)
SAFETY(IEN) ; Safety officer screen
"RTN","OOPSSUP1",99,0)
 N VIEW,INC
"RTN","OOPSSUP1",100,0)
 S VIEW=1
"RTN","OOPSSUP1",101,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",102,0)
 I $$GET1^DIQ(2260,IEN,51,"I") S VIEW=0 ; Case is not open
"RTN","OOPSSUP1",103,0)
 ;I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ S VIEW=0 ; Not the Super or Alternate Super
"RTN","OOPSSUP1",104,0)
 ; Allow Non-PAID employee - CAT=6
"RTN","OOPSSUP1",105,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP1",106,0)
 I CAT>2&(CAT'=6) D       ; person is not an employee
"RTN","OOPSSUP1",107,0)
 .I +$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0 Q  ; Safety has signed
"RTN","OOPSSUP1",108,0)
 .Q
"RTN","OOPSSUP1",109,0)
 E  D  ; This will filter emps who have sign, sup who sign and safety who sign
"RTN","OOPSSUP1",110,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),+$$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSSUP1",111,0)
 .Q
"RTN","OOPSSUP1",112,0)
 I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ D
"RTN","OOPSSUP1",113,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,3) S VIEW=0
"RTN","OOPSSUP1",114,0)
 .Q
"RTN","OOPSSUP1",115,0)
 Q VIEW
"RTN","OOPSSUP1",116,0)
 ;********CHANGE HERE************
"RTN","OOPSSUP1",117,0)
 ;Listing of events.
"RTN","OOPSSUP1",118,0)
 ;Check to see of open else quit
"RTN","OOPSSUP1",119,0)
 ;check to see if supervisor or alternate
"RTN","OOPSSUP1",120,0)
 ;check to see if super has signed both CA or 2162 quit if both signed
"RTN","OOPSSUP1",121,0)
 ;else show
"RTN","OOPSSUP1",122,0)
 ;N VIEW
"RTN","OOPSSUP1",123,0)
 ;S VIEW=1 D
"RTN","OOPSSUP1",124,0)
 ;.N INC
"RTN","OOPSSUP1",125,0)
 ;.I $$GET1^DIQ(2260,IEN,51,"I") S VIEW=0 Q  ; Closed
"RTN","OOPSSUP1",126,0)
 ;.S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",127,0)
 ;.I ($$GET1^DIQ(2260,IEN,53,"I")=DUZ!($$GET1^DIQ(2260,IEN,53.1,"I")=DUZ)),$P($$EDSTA^OOPSUTL1(IEN,"O"),U,3),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC) S VIEW=0 Q  ; Both the CA and 2162 have been signed supervisor
"RTN","OOPSSUP1",128,0)
 ;.; ^=== The Super or Alternate Super ===^
"RTN","OOPSSUP1",129,0)
 ;.I $P($$EDSTA^OOPSUTL1(IEN,"S"),U,3),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,INC) S VIEW=0 Q  ; Both the CA and 2162 have been signed supervisor
"RTN","OOPSSUP1",130,0)
 ;.Q
"RTN","OOPSSUP1",131,0)
 ;Q VIEW
"RTN","OOPSSUP1",132,0)
FORMS ; Process Form
"RTN","OOPSSUP1",133,0)
 N I
"RTN","OOPSSUP1",134,0)
 F I=1:1 S FORM=$P(EDIT,U,I) Q:FORM=""  D  Q:OUT
"RTN","OOPSSUP1",135,0)
 .N DR,DIE,SIGN,EDIT,I
"RTN","OOPSSUP1",136,0)
 .I ($$GET1^DIQ(2260,IEN,53,"I")=DUZ!($$GET1^DIQ(2260,IEN,53.1,"I")=DUZ)) D CLEAR(IEN,FORM)
"RTN","OOPSSUP1",137,0)
 .I FORM="2162" D ASIST^OOPSSUP3 Q:OUT
"RTN","OOPSSUP1",138,0)
 .I FORM="CA1" D CA1^OOPSSUP2 Q:OUT
"RTN","OOPSSUP1",139,0)
 .I FORM="CA2" D CA2^OOPSSUP2 Q:OUT
"RTN","OOPSSUP1",140,0)
 .S DIE="^OOPS(2260,",DA=IEN
"RTN","OOPSSUP1",141,0)
 .D ^DIE
"RTN","OOPSSUP1",142,0)
 .I ($D(Y)'=0)!($G(DIRUT)=1)  S OUT=1 Q  ; Quit if user exits
"RTN","OOPSSUP1",143,0)
 .I $$GET1^DIQ(2260,IEN,53,"I")'=DUZ,$$GET1^DIQ(2260,IEN,53.1,"I")'=DUZ Q
"RTN","OOPSSUP1",144,0)
 .D SIGNS(FORM) ; Sign/validate Document
"RTN","OOPSSUP1",145,0)
 .Q:'$P(SIGN,U)   ; Quit if user doesn't sign
"RTN","OOPSSUP1",146,0)
 .D FILE ; User Signs and files
"RTN","OOPSSUP1",147,0)
 .Q
"RTN","OOPSSUP1",148,0)
 Q
"RTN","OOPSSUP1",149,0)
SIGNS(FORM) ; Sign/validate Document
"RTN","OOPSSUP1",150,0)
 N EMP,INC,VALID
"RTN","OOPSSUP1",151,0)
 S VALID=0,SIGN=""
"RTN","OOPSSUP1",152,0)
 S EMP=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSSUP1",153,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSSUP1",154,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,"S",.VALID)
"RTN","OOPSSUP1",155,0)
 I FORM'="2162",'$P(EMP,U,INC) D  Q  ;Employee has not signed yet
"RTN","OOPSSUP1",156,0)
 .W !,?10,"The employee has not signed the ",FORM,"." Q
"RTN","OOPSSUP1",157,0)
 .Q
"RTN","OOPSSUP1",158,0)
 I 'VALID Q
"RTN","OOPSSUP1",159,0)
 S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSSUP1",160,0)
 Q
"RTN","OOPSSUP1",161,0)
FILE ;File the ES and send a bull
"RTN","OOPSSUP1",162,0)
 I FORM="2162" S $P(^OOPS(2260,IEN,"2162ES"),U,1,3)=SIGN D SAFETY^OOPSMBUL(IEN)
"RTN","OOPSSUP1",163,0)
 I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,4,6)=SIGN D UNION^OOPSMBUL(IEN)
"RTN","OOPSSUP1",164,0)
 I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,4,6)=SIGN D UNION^OOPSMBUL(IEN)
"RTN","OOPSSUP1",165,0)
 Q
"RTN","OOPSSUP2")
0^7^B56809328
"RTN","OOPSSUP2",1,0)
OOPSSUP2 ;HINES/WAA - S/E Supervisor Edit routine [ 04/15/1998  1:26 PM ]
"RTN","OOPSSUP2",2,0)
 ;;1.0;ASISTS;**3**;Jun 01, 1998
"RTN","OOPSSUP2",3,0)
 ;;
"RTN","OOPSSUP2",4,0)
CA1 ; CA1 FORM
"RTN","OOPSSUP2",5,0)
 N ITEM,DTINJ
"RTN","OOPSSUP2",6,0)
 W !!," Federal Employee's Notice of Traumatic Injury and Claim"
"RTN","OOPSSUP2",7,0)
 W !," for Continuation of Pay/Compensation (Form CA-1)"
"RTN","OOPSSUP2",8,0)
 W !!,"     Witness"
"RTN","OOPSSUP2",9,0)
 W !,"     -------"
"RTN","OOPSSUP2",10,0)
 S DR=""
"RTN","OOPSSUP2",11,0)
 S DR(1,2260,.1)="115 16. NAME OF WITNESS..........."
"RTN","OOPSSUP2",12,0)
 S DR(1,2260,.2)="W !!,""     Supervisor's Report"""
"RTN","OOPSSUP2",13,0)
 S DR(1,2260,.3)="W !,""     -------------------"""
"RTN","OOPSSUP2",14,0)
 S DR(1,2260,1)="130 17. AGENCY NAME..............."
"RTN","OOPSSUP2",15,0)
 S DR(1,2260,2)="131     STREET ADDRESS............"
"RTN","OOPSSUP2",16,0)
 S DR(1,2260,3)="132     CITY......................"
"RTN","OOPSSUP2",17,0)
 S DR(1,2260,4)="133     STATE....................."
"RTN","OOPSSUP2",18,0)
 S DR(1,2260,5)="134     ZIP CODE.................."
"RTN","OOPSSUP2",19,0)
 S DR(1,2260,6)="176 18. EMPLOYEE'S DUTY STATION..."
"RTN","OOPSSUP2",20,0)
 S DR(1,2260,7)="177     STREET ADDRESS............"
"RTN","OOPSSUP2",21,0)
 S DR(1,2260,8)="178     CITY......................"
"RTN","OOPSSUP2",22,0)
 S DR(1,2260,9)="179     STATE....................."
"RTN","OOPSSUP2",23,0)
 S DR(1,2260,10)="180     ZIP CODE.................."
"RTN","OOPSSUP2",24,0)
 S DR(1,2260,11)="W !,"" 19. REGULAR WORK HOURS:"""
"RTN","OOPSSUP2",25,0)
 S DR(1,2260,12)="138     FROM......................"
"RTN","OOPSSUP2",26,0)
 S DR(1,2260,13)="139     TO........................"
"RTN","OOPSSUP2",27,0)
 S DR(1,2260,14)="S ITEM=20 W !,"" 20. REGULAR WORK SCHEDULE.....: ""_$$GET1^DIQ(2260,D0,140,""E"")"
"RTN","OOPSSUP2",28,0)
 S DR(1,2260,15)="K DIR S DIR(""A"")=""                                 "",DIR(""B"")=$$GET1^DIQ(2260,D0,140,""I"") D RWS^OOPSSUP2 S:$D(DIRUT) Y=""@2"""
"RTN","OOPSSUP2",29,0)
 ;
"RTN","OOPSSUP2",30,0)
 ; Default from 2162, require time entry but allow edit
"RTN","OOPSSUP2",31,0)
 ;
"RTN","OOPSSUP2",32,0)
 S DTINJ=$$GET1^DIQ(2260,IEN,4,"E")
"RTN","OOPSSUP2",33,0)
 S DR(1,2260,16)="4 21. DATE/TIME INJURY OCCURRED.......//^S X=DTINJ"
"RTN","OOPSSUP2",34,0)
 S DR(1,2260,16.1)="I $P(X,""."",2)="""" W !,""Time is REQUIRED in this response."" S Y=4"
"RTN","OOPSSUP2",35,0)
 S DR(1,2260,17)="175 22. DATE OF NOTICE RECEIVED..."
"RTN","OOPSSUP2",36,0)
 S DR(1,2260,18)="142 23. DATE/TIME STOPPED WORK...."
"RTN","OOPSSUP2",37,0)
 S DR(1,2260,19)="143 24. DATE PAY STOPPED.........."
"RTN","OOPSSUP2",38,0)
 S DR(1,2260,20)="144 25. DATE 45 DAY PERIOD BEGAN.."
"RTN","OOPSSUP2",39,0)
 S DR(1,2260,21)="145 26. DATE/TIME RETURNED TO WORK"
"RTN","OOPSSUP2",40,0)
 S DR(1,2260,22)="146 27. WAS EMPLOYEE INJURED IN PERFORMANCE OF DUTY;I X=""Y"" S Y=148;"
"RTN","OOPSSUP2",41,0)
 S DR(1,2260,23)="147     EXPLANATION"
"RTN","OOPSSUP2",42,0)
 S DR(1,2260,24)="148 28. WAS INJURY CAUSED BY EMPLOYEE'S WILLFUL MISCONDUCT, INTOXICATION, OR            INTENT TO INJURE SELF OR ANOTHER;I X=""N"" S Y=150;"
"RTN","OOPSSUP2",43,0)
 S DR(1,2260,25)="149     EXPLANATION"
"RTN","OOPSSUP2",44,0)
 S DR(1,2260,26)="150 29. WAS INJURY CAUSED BY 3RD PARTY;I X=""N"" S Y=""@1"""
"RTN","OOPSSUP2",45,0)
 S DR(1,2260,27)="W !,"" 30. NAME AND ADDRESS OF THIRD PARTY:"""
"RTN","OOPSSUP2",46,0)
 S DR(1,2260,28)="151     NAME OF THIRD PARTY.......;I X="""" S Y=""@1"""
"RTN","OOPSSUP2",47,0)
 S DR(1,2260,29)="152     STREET ADDRESS............"
"RTN","OOPSSUP2",48,0)
 S DR(1,2260,30)="153     CITY......................"
"RTN","OOPSSUP2",49,0)
 S DR(1,2260,31)="154     STATE....................."
"RTN","OOPSSUP2",50,0)
 S DR(1,2260,32)="155     ZIP CODE.................."
"RTN","OOPSSUP2",51,0)
 S DR(1,2260,32.1)="@1"
"RTN","OOPSSUP2",52,0)
 S DR(1,2260,33)="W !,"" 31. NAME AND ADDRESS OF PHYSICIAN FIRST PROVIDING MEDICAL CARE:"""
"RTN","OOPSSUP2",53,0)
 S DR(1,2260,34)="156     NAME OF PHYSICIAN.........;I X="""" S Y=161"
"RTN","OOPSSUP2",54,0)
 S DR(1,2260,35)="157     STREET ADDRESS............"
"RTN","OOPSSUP2",55,0)
 S DR(1,2260,36)="158     CITY......................"
"RTN","OOPSSUP2",56,0)
 S DR(1,2260,37)="159     STATE....................."
"RTN","OOPSSUP2",57,0)
 S DR(1,2260,38)="160     ZIP CODE.................."
"RTN","OOPSSUP2",58,0)
 S DR(1,2260,39)="161 32. 1ST DATE MEDICAL CARE RECEIVED"
"RTN","OOPSSUP2",59,0)
 S DR(1,2260,40)="162 33. DO MEDICAL REPORTS SHOW EMPLOYEE IS DISABLED FOR WORK"
"RTN","OOPSSUP2",60,0)
 S DR(1,2260,41)="163 34. DOES YOUR KNOWLEDGE OF THE FACTS AGREE WITH STATEMENTS OF THE EMPLOYEE;I X=""Y"" S Y=165"
"RTN","OOPSSUP2",61,0)
 S DR(1,2260,43)="164     EXPLANATION~"
"RTN","OOPSSUP2",62,0)
 S DR(1,2260,44)="W !"
"RTN","OOPSSUP2",63,0)
 S DR(1,2260,46)="165 35. IF THE EMPLOYING AGENCY CONTROVERTS CONTINUATION OF PAY, STATE THE REASON       IN DETAIL~"
"RTN","OOPSSUP2",64,0)
 S DR(1,2260,47)="W !!,"" 36. PAY RATE WHEN EMPLOYEE STOPPED WORK:"""
"RTN","OOPSSUP2",65,0)
 S DR(1,2260,48)="166     $........................."
"RTN","OOPSSUP2",66,0)
 S DR(1,2260,49)="167     PER......................."
"RTN","OOPSSUP2",67,0)
 S DR(1,2260,50)="W !!,""     Signature of Supervisor and Filing Instructions"""
"RTN","OOPSSUP2",68,0)
 S DR(1,2260,51)="W !,""     -----------------------------------------------"""
"RTN","OOPSSUP2",69,0)
 S DR(1,2260,52)="S ITEM=37 D EXCEPT^OOPSSUP2;168     EXCEPTION"
"RTN","OOPSSUP2",70,0)
 S DR(1,2260,53)="W !,""     NAME OF SUPERVISOR:  ""_SUP"
"RTN","OOPSSUP2",71,0)
 S DR(1,2260,54)="172     SUPERVISOR'S TITLE."
"RTN","OOPSSUP2",72,0)
 S DR(1,2260,55)="173     OFFICE PHONE......."
"RTN","OOPSSUP2",73,0)
 S DR(1,2260,56)="174 38. FILING INSTRUCTIONS"
"RTN","OOPSSUP2",74,0)
 S DR(1,2260,57)="@2"
"RTN","OOPSSUP2",75,0)
 Q
"RTN","OOPSSUP2",76,0)
CA2 ; CA2 FORM
"RTN","OOPSSUP2",77,0)
 N ITEM
"RTN","OOPSSUP2",78,0)
 W !!," Notice of Occupational Disease and Claim for Compensation (Form CA-2)"
"RTN","OOPSSUP2",79,0)
 W !!,"     Supervisor's Report"
"RTN","OOPSSUP2",80,0)
 W !,"     -------------------",!
"RTN","OOPSSUP2",81,0)
 S DR=""
"RTN","OOPSSUP2",82,0)
 S DR(1,2260,1)="230 19. AGENCY NAME..................."
"RTN","OOPSSUP2",83,0)
 S DR(1,2260,2)="231     STREET ADDRESS................"
"RTN","OOPSSUP2",84,0)
 S DR(1,2260,3)="232     CITY.........................."
"RTN","OOPSSUP2",85,0)
 S DR(1,2260,4)="233     STATE........................."
"RTN","OOPSSUP2",86,0)
 S DR(1,2260,5)="234     AGENCY ZIP CODE..............."
"RTN","OOPSSUP2",87,0)
 S DR(1,2260,6)="237 20. EMPLOYEE'S DUTY STATION......."
"RTN","OOPSSUP2",88,0)
 S DR(1,2260,7)="238     STREET ADDRESS................"
"RTN","OOPSSUP2",89,0)
 S DR(1,2260,8)="239     CITY.........................."
"RTN","OOPSSUP2",90,0)
 S DR(1,2260,9)="240     STATE........................."
"RTN","OOPSSUP2",91,0)
 S DR(1,2260,10)="241     ZIP CODE......................"
"RTN","OOPSSUP2",92,0)
 S DR(1,2260,11)="W !,"" 21. REGULAR WORK HOURS:"""
"RTN","OOPSSUP2",93,0)
 S DR(1,2260,12)="242     FROM.........................."
"RTN","OOPSSUP2",94,0)
 S DR(1,2260,13)="243     TO............................"
"RTN","OOPSSUP2",95,0)
 S DR(1,2260,14)="S ITEM=22 W !,"" 22. REGULAR WORK SCHEDULE.........: ""_$$GET1^DIQ(2260,D0,244,""E"")"
"RTN","OOPSSUP2",96,0)
 S DR(1,2260,15)="K DIR S DIR(""A"")=""                                     "",DIR(""B"")=$$GET1^DIQ(2260,D0,244,""I"") D RWS^OOPSSUP2 S:$D(DIRUT) Y=""@2"""
"RTN","OOPSSUP2",97,0)
 S DR(1,2260,16)="W !,"" 23. NAME AND ADDRESS OF PHYSICIAN FIRST PROVIDING MEDICAL CARE"""
"RTN","OOPSSUP2",98,0)
 S DR(1,2260,17)="245     NAME OF PHYSICIAN.............;I X="""" S Y=250"
"RTN","OOPSSUP2",99,0)
 S DR(1,2260,18)="246     STREET ADDRESS................"
"RTN","OOPSSUP2",100,0)
 S DR(1,2260,19)="247     CITY.........................."
"RTN","OOPSSUP2",101,0)
 S DR(1,2260,20)="248     STATE........................."
"RTN","OOPSSUP2",102,0)
 S DR(1,2260,21)="249     ZIP CODE......................"
"RTN","OOPSSUP2",103,0)
 S DR(1,2260,22)="250 24. 1ST DATE MEDICAL CARE RECEIVED"
"RTN","OOPSSUP2",104,0)
 S DR(1,2260,23)="251 25. DO MEDICAL REPORTS SHOW EMPLOYEE IS DISABLED FOR WORK"
"RTN","OOPSSUP2",105,0)
 S DR(1,2260,24)="252 26. DATE EMPLOYEE FIRST REPORTED CONDITION TO SUPERVISOR."
"RTN","OOPSSUP2",106,0)
 S DR(1,2260,25)="253 27. DATE/TIME EMPLOYEE STOPPED WORK.."
"RTN","OOPSSUP2",107,0)
 S DR(1,2260,26)="254 28. DATE/TIME EMPLOYEE'S PAY STOPPED."
"RTN","OOPSSUP2",108,0)
 S DR(1,2260,27)="255 29. DATE EMPLOYEE WAS LAST EXPOSED TO CONDITIONS ALLEGED TO HAVE CAUSED             DISEASE OR ILLNESS..............."
"RTN","OOPSSUP2",109,0)
 S DR(1,2260,28)="256 30. DATE/TIME RETURNED TO WORK......."
"RTN","OOPSSUP2",110,0)
 S DR(1,2260,29)="W !,"" 31. IF EMPLOYEE HAS RETURNED TO WORK AND WORK ASSIGNMENT HAS CHANGED, DESCRIBE      NEW DUTIES"""
"RTN","OOPSSUP2",111,0)
 S DR(1,2260,31)="257     DESCRIPTION~"
"RTN","OOPSSUP2",112,0)
 S DR(1,2260,32)="W !"
"RTN","OOPSSUP2",113,0)
 S DR(1,2260,33)="258 32. WAS INJURY CAUSED BY 3RD PARTY;I X=""N"" S Y=""@1"""
"RTN","OOPSSUP2",114,0)
 S DR(1,2260,34)="259 33. NAME OF THIRD PARTY..........."
"RTN","OOPSSUP2",115,0)
 S DR(1,2260,35)="260     STREET ADDRESS................"
"RTN","OOPSSUP2",116,0)
 S DR(1,2260,36)="261     CITY.........................."
"RTN","OOPSSUP2",117,0)
 S DR(1,2260,37)="262     STATE........................."
"RTN","OOPSSUP2",118,0)
 S DR(1,2260,38)="263     ZIP CODE......................"
"RTN","OOPSSUP2",119,0)
 S DR(1,2260,38.1)="@1"
"RTN","OOPSSUP2",120,0)
 S DR(1,2260,39)="W !!,""     Signature of Supervisor"""
"RTN","OOPSSUP2",121,0)
 S DR(1,2260,40)="W !,""     -----------------------"""
"RTN","OOPSSUP2",122,0)
 S DR(1,2260,41)="S ITEM=34 D EXCEPT^OOPSSUP2;264     EXCEPTION"
"RTN","OOPSSUP2",123,0)
 S DR(1,2260,42)="W !,""     NAME OF SUPERVISOR: ""_SUP"
"RTN","OOPSSUP2",124,0)
 S DR(1,2260,43)="268     SUPERVISOR'S TITLE"
"RTN","OOPSSUP2",125,0)
 S DR(1,2260,44)="269     OFFICE PHONE......"
"RTN","OOPSSUP2",126,0)
 S DR(1,2260,45)="@2"
"RTN","OOPSSUP2",127,0)
 Q
"RTN","OOPSSUP2",128,0)
EXCEPT ; Exception statement
"RTN","OOPSSUP2",129,0)
 W !," ",ITEM,". A supervisor who knowingly certifies to any false statement,"
"RTN","OOPSSUP2",130,0)
 W !,"     misrepresentation, concealment of fact, etc., in respect of"
"RTN","OOPSSUP2",131,0)
 W !,"     this claim may also be subject to appropriate felony criminal"
"RTN","OOPSSUP2",132,0)
 W !,"     prosecution."
"RTN","OOPSSUP2",133,0)
 W !
"RTN","OOPSSUP2",134,0)
 W !,"     I certify that the information given above and that furnished"
"RTN","OOPSSUP2",135,0)
 W !,"     by the employee is true to the best of my knowledge with the"
"RTN","OOPSSUP2",136,0)
 W !,"     following exception."
"RTN","OOPSSUP2",137,0)
 W !
"RTN","OOPSSUP2",138,0)
 Q
"RTN","OOPSSUP2",139,0)
RWS ;Regular Work Schedule
"RTN","OOPSSUP2",140,0)
 N Y S DIR(0)="LA^1:7"
"RTN","OOPSSUP2",141,0)
 S DIR("?",1)="     Enter the employee's work schedule at the time of the incident."
"RTN","OOPSSUP2",142,0)
 S DIR("?",2)="     The numbers 1-7 correspond to the days of the week."
"RTN","OOPSSUP2",143,0)
 S DIR("?",3)="       1 = Sunday"
"RTN","OOPSSUP2",144,0)
 S DIR("?",4)="       2 = Monday"
"RTN","OOPSSUP2",145,0)
 S DIR("?",5)="       3 = Tuesday"
"RTN","OOPSSUP2",146,0)
 S DIR("?",6)="       4 = Wednesday"
"RTN","OOPSSUP2",147,0)
 S DIR("?",7)="       5 = Thursday"
"RTN","OOPSSUP2",148,0)
 S DIR("?",8)="       6 = Friday"
"RTN","OOPSSUP2",149,0)
 S DIR("?",9)="       7 = Saturday"
"RTN","OOPSSUP2",150,0)
 S DIR("?",10)="     Enter the day numbers as a range or list separated by commas."
"RTN","OOPSSUP2",151,0)
 S DIR("?",11)=""
"RTN","OOPSSUP2",152,0)
 S DIR("?",12)="     Examples: For Mon-Fri     enter 2-6 (or 2,3,4,5,6)"
"RTN","OOPSSUP2",153,0)
 S DIR("?",13)="               For Wed-Sat     enter 4-7 (or 4,5,6,7)"
"RTN","OOPSSUP2",154,0)
 S DIR("?")="               For Mon,Wed,Fri enter 2,4,6"
"RTN","OOPSSUP2",155,0)
 D ^DIR
"RTN","OOPSSUP2",156,0)
 I $P(X,"-",2)>7 W !,"     Range exceeds 1-7 limit." G RWS
"RTN","OOPSSUP2",157,0)
 Q:$D(DIRUT)
"RTN","OOPSSUP2",158,0)
 S:ITEM=20 $P(^OOPS(2260,D0,"CA1F"),U,11)=Y
"RTN","OOPSSUP2",159,0)
 S:ITEM=22 $P(^OOPS(2260,D0,"CA2I"),U,8)=Y
"RTN","OOPSSUP3")
0^8^B6673672
"RTN","OOPSSUP3",1,0)
OOPSSUP3 ;HINES/WAA - S/E Supervisor Edit routine 2162 [ 04/15/1998  1:25 PM ]
"RTN","OOPSSUP3",2,0)
 ;;1.0;ASISTS;**3**;Jun 01, 1998
"RTN","OOPSSUP3",3,0)
 ;;
"RTN","OOPSSUP3",4,0)
ASIST ;  2162 FORM
"RTN","OOPSSUP3",5,0)
 N INCID,SUP,CAT
"RTN","OOPSSUP3",6,0)
 S INCID=$$GET1^DIQ(2260,IEN,3,"I")
"RTN","OOPSSUP3",7,0)
 S:INCID'="" INCID=$$GET1^DIQ(2261.2,INCID,.01,"E") ; Getting the type of incident
"RTN","OOPSSUP3",8,0)
 S INCID=U_INCID_U
"RTN","OOPSSUP3",9,0)
 ; Allow edit of supervisor, secondary supervisor
"RTN","OOPSSUP3",10,0)
 ; Also, include logic for Non-PAID employee
"RTN","OOPSSUP3",11,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP3",12,0)
 S SUP=$S((CAT=1!(CAT=6)):" SUPERVISOR...............",CAT=2:" VOLUNTARY SVC SUPERVISOR.",CAT=3:" CONTRACT ADMINISTRATOR...",1:" SAFETY OFFICER...........")
"RTN","OOPSSUP3",13,0)
 S DR=""
"RTN","OOPSSUP3",14,0)
 S DR(1,2260,.1)="53"_SUP
"RTN","OOPSSUP3",15,0)
 S DR(1,2260,.6)="53.1 SECONDARY SUPERVISOR....."
"RTN","OOPSSUP3",16,0)
 S DR(1,2260,1)="26 GENERAL SETTING OF INCIDENT........;S X=X;"
"RTN","OOPSSUP3",17,0)
 S DR(1,2260,2)="27 LOCATION OF INJURY.................;S X=X;D CARE2^OOPSUTL2(IEN);"
"RTN","OOPSSUP3",18,0)
 S DR(1,2260,4)="28 DESCRIPTION OF INCIDENT............"
"RTN","OOPSSUP3",19,0)
 S DR(1,2260,5)="29 CHARACTERIZATION OF INJURY........."
"RTN","OOPSSUP3",20,0)
 S DR(1,2260,6)="30 BODY PART MOST AFFECTED............"
"RTN","OOPSSUP3",21,0)
 S DR(1,2260,6.1)="30.1 ADDITIONAL BODY PART AFFECTED......"
"RTN","OOPSSUP3",22,0)
 S DR(1,2260,7)="31 SIDE OF BODY AFFECTED..............;S X=X;"
"RTN","OOPSSUP3",23,0)
SHARPS ; SHARPS DATA
"RTN","OOPSSUP3",24,0)
 I "^Sharps Exposure^Needlesticks^"'[INCID G FLUID
"RTN","OOPSSUP3",25,0)
 S DR(1,2260,8)="34 PATIENT SOURCE....................."
"RTN","OOPSSUP3",26,0)
 S DR(1,2260,9)="35 CONTAMINATION......................"
"RTN","OOPSSUP3",27,0)
 S DR(1,2260,10)="36 PURPOSE OF SHARP OBJECT..........."
"RTN","OOPSSUP3",28,0)
 S DR(1,2260,11)="37 ACTIVITY AT TIME OF INJURY........"
"RTN","OOPSSUP3",29,0)
 S DR(1,2260,12)="38 OBJECT CAUSING INJURY.............;S X=X;"
"RTN","OOPSSUP3",30,0)
 G ALL
"RTN","OOPSSUP3",31,0)
FLUID ; Body Fluid Exposer
"RTN","OOPSSUP3",32,0)
 I "^Exposure to Body Fluids^"'[INCID G EVERY
"RTN","OOPSSUP3",33,0)
 S DR(1,2260,8)="34 PATIENT SOURCE....................."
"RTN","OOPSSUP3",34,0)
 ;S DR(1,2260,13)="D DISP^OOPSUTL2"
"RTN","OOPSSUP3",35,0)
 S DR(1,2260,14)="39 BODY PART WAS EXPOSED........."
"RTN","OOPSSUP3",36,0)
 S DR(1,2260,15)="40 ITEMS WORN AT TIME OF ESPOSURE"
"RTN","OOPSSUP3",37,0)
 S DR(1,2260,16)="41 BODILY FLUID EXPOSURE SOURCE......."
"RTN","OOPSSUP3",38,0)
ALL ; ALL TYPE OF EXPOSIERS
"RTN","OOPSSUP3",39,0)
 S DR(1,2260,17)="I '$$EQUIP^OOPSUTL2 S Y=43 ;42 EQUIPMENT/DEVICE MANUFACTURER NAME........."
"RTN","OOPSSUP3",40,0)
 S DR(1,2260,18)="43 SAFETY DESIGN DEVICE USED....;S X=X;"
"RTN","OOPSSUP3",41,0)
EVERY ; All Employees
"RTN","OOPSSUP3",42,0)
 ; Include CAT=6 Non-PAID employee as employee
"RTN","OOPSSUP3",43,0)
 N CAT
"RTN","OOPSSUP3",44,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSSUP3",45,0)
 I CAT<3!(CAT=6) D
"RTN","OOPSSUP3",46,0)
 .S DR(1,2260,19)="32 DUTY RETURNED TO..................."
"RTN","OOPSSUP3",47,0)
 .S DR(1,2260,20)="33 LOST TIME..........................;S X=X;"
"RTN","OOPSSUP3",48,0)
 .Q
"RTN","OOPSSUP3",49,0)
 S DR(1,2260,21)="47 CORRECTIVE ACTION............"
"RTN","OOPSSUP3",50,0)
 Q
"RTN","OOPSUTL4")
0^9^B9219723
"RTN","OOPSUTL4",1,0)
OOPSUTL4 ;HINES/WAA - Utilities Routines - 3/24/98
"RTN","OOPSUTL4",2,0)
 ;;1.0;ASISTS;**3**;Jun 01, 1998
"RTN","OOPSUTL4",3,0)
 ;;
"RTN","OOPSUTL4",4,0)
UNION(IEN) ;
"RTN","OOPSUTL4",5,0)
 ; Input: IEN   = Internal Entry Number of entry in file 2260
"RTN","OOPSUTL4",6,0)
 ; Output VALID = 1 Valid to be seen by Union
"RTN","OOPSUTL4",7,0)
 ;              = 0 Not Valid to be seen by Union
"RTN","OOPSUTL4",8,0)
 N VALID
"RTN","OOPSUTL4",9,0)
 S VALID=0
"RTN","OOPSUTL4",10,0)
 I $$EDSTA^OOPSUTL1(IEN,"O"),$P($$EDSTA^OOPSUTL1(IEN,"S"),U,3) S VALID=1
"RTN","OOPSUTL4",11,0)
 Q VALID
"RTN","OOPSUTL4",12,0)
 ;
"RTN","OOPSUTL4",13,0)
VALIDATE(IEN,FORM,CALLER,VALID) ;
"RTN","OOPSUTL4",14,0)
 ;
"RTN","OOPSUTL4",15,0)
 ; Input: IEN    = Internal Entry Number of entry in file 2260
"RTN","OOPSUTL4",16,0)
 ;        FORM   = 2162,CA1, or CA2
"RTN","OOPSUTL4",17,0)
 ;        CALLER = "E" employee
"RTN","OOPSUTL4",18,0)
 ;               = "S" supervisor
"RTN","OOPSUTL4",19,0)
 ;               = "O" safety officer
"RTN","OOPSUTL4",20,0)
 ;        VALID  = RESERVED FOR OUTPUT DATA
"RTN","OOPSUTL4",21,0)
 ; Output:VALID  = 1 ALL REQUIRED DATA FOR FORM IS COMPLETE
"RTN","OOPSUTL4",22,0)
 ;               = 0 DATA IS MISSING
"RTN","OOPSUTL4",23,0)
 N LIST,FLD,CNT,CHK
"RTN","OOPSUTL4",24,0)
 S (FLD,LIST)=""
"RTN","OOPSUTL4",25,0)
 S VALID=1,CHK=0
"RTN","OOPSUTL4",26,0)
 W !,"Validating data on form ",FORM,"."
"RTN","OOPSUTL4",27,0)
 I CALLER="E" D EMP
"RTN","OOPSUTL4",28,0)
 I CALLER="S" D SUP
"RTN","OOPSUTL4",29,0)
 I CALLER="O" D SOF
"RTN","OOPSUTL4",30,0)
 F CNT=1:1 S FLD=$P(LIST,",",CNT) Q:FLD=""  D
"RTN","OOPSUTL4",31,0)
 .N LOC,NODE,PCE,BADFLD,TEXT,WP
"RTN","OOPSUTL4",32,0)
 .S BADFLD=1,WP=0
"RTN","OOPSUTL4",33,0)
 .S LOC=$$GET1^DID(2260,FLD,"","GLOBAL SUBSCRIPT LOCATION")
"RTN","OOPSUTL4",34,0)
 .S NODE=$P(LOC,";")
"RTN","OOPSUTL4",35,0)
 .S PCE=$P(LOC,";",2)
"RTN","OOPSUTL4",36,0)
 .I PCE=0 D  ;Work processing field
"RTN","OOPSUTL4",37,0)
 ..I '$D(^OOPS(2260,IEN,NODE,1,0)) S (BADFLD,VALID)=0
"RTN","OOPSUTL4",38,0)
 ..S WP=1
"RTN","OOPSUTL4",39,0)
 ..Q
"RTN","OOPSUTL4",40,0)
 .E  I $P($G(^OOPS(2260,IEN,NODE)),U,PCE)="" S (BADFLD,VALID)=0
"RTN","OOPSUTL4",41,0)
 .I 'BADFLD D  ; Display error messaged about fields not filled.
"RTN","OOPSUTL4",42,0)
 ..I 'CHK W !!,"The following fields must be completed before the "_FORM_" can be signed.",! S CHK=1
"RTN","OOPSUTL4",43,0)
 ..I WP D  ;Is this a wp field and where to get title
"RTN","OOPSUTL4",44,0)
 ...N NODE
"RTN","OOPSUTL4",45,0)
 ...S NODE=2260_".0"_FLD
"RTN","OOPSUTL4",46,0)
 ...S TEXT=$$GET1^DID(NODE,".01","","TITLE")
"RTN","OOPSUTL4",47,0)
 ...Q
"RTN","OOPSUTL4",48,0)
 ..E  S TEXT=$$GET1^DID(2260,FLD,"","TITLE")
"RTN","OOPSUTL4",49,0)
 ..W !,TEXT
"RTN","OOPSUTL4",50,0)
 ..Q
"RTN","OOPSUTL4",51,0)
 .Q
"RTN","OOPSUTL4",52,0)
 Q
"RTN","OOPSUTL4",53,0)
EMP ;
"RTN","OOPSUTL4",54,0)
 ; Address fields are now all pulled from the 2162A node
"RTN","OOPSUTL4",55,0)
 I FORM="CA1" S LIST="8,9,10,11,12,108,109,110,111,112,113,114"
"RTN","OOPSUTL4",56,0)
 I FORM="CA2" S LIST="8,9,10,11,12,208,209,214,215,216,217"
"RTN","OOPSUTL4",57,0)
 Q
"RTN","OOPSUTL4",58,0)
SUP ;
"RTN","OOPSUTL4",59,0)
 N CAT      ; Include logic for Non PAID employee - CAT=6
"RTN","OOPSUTL4",60,0)
 S CAT=$$GET1^DIQ(2260,IEN,2,"I")
"RTN","OOPSUTL4",61,0)
 I FORM="2162" S LIST="26,27,28,30,31" I CAT<3!(CAT=6) S LIST=LIST_",33"
"RTN","OOPSUTL4",62,0)
 I FORM="CA1" S LIST="130,176,138,139,140,4,175,146,148,150,156,157,158,159,160,161,162,163"
"RTN","OOPSUTL4",63,0)
 I FORM="CA2" S LIST="230,237,242,243,244,245,246,247,248,249,250,251,252,258"
"RTN","OOPSUTL4",64,0)
 Q
"RTN","OOPSUTL4",65,0)
SOF ;
"RTN","OOPSUTL4",66,0)
 I FORM="2162" S LIST="55,47"
"RTN","OOPSUTL4",67,0)
 Q
"RTN","OOPSUTL4",68,0)
UP(IN) ; Translate all lower to upper
"RTN","OOPSUTL4",69,0)
 N OUT
"RTN","OOPSUTL4",70,0)
 S OUT=$TR(IN,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","OOPSUTL4",71,0)
 Q OUT
"RTN","OOPSUTL4",72,0)
RWSOT ;Regular Work Schedule output transform
"RTN","OOPSUTL4",73,0)
 N I,HOLD
"RTN","OOPSUTL4",74,0)
 S HOLD=""
"RTN","OOPSUTL4",75,0)
 F I=1:1:($L(Y)/2) S HOLD=HOLD_$P("Sun,Mon,Tue,Wed,Thu,Fri,Sat",",",$P(Y,",",I))_","
"RTN","OOPSUTL4",76,0)
 S Y=$E(HOLD,1,($L(HOLD)-1))
"RTN","OOPSUTL4",77,0)
 Q 
"RTN","OOPSUTL4",78,0)
RWSIN(X) ;
"RTN","OOPSUTL4",79,0)
 ; X=Sun,Mon,Tue
"RTN","OOPSUTL4",80,0)
 N IN,I,Y,DAY,DOW
"RTN","OOPSUTL4",81,0)
 S X=X_",",DAY=""
"RTN","OOPSUTL4",82,0)
 S IN="1Sun,2Mon,3Tue,4Wed,5Thu,6Fri,7Sat"
"RTN","OOPSUTL4",83,0)
 F I=1:1 S DOW=$P(X,",",I) Q:DOW=""  D
"RTN","OOPSUTL4",84,0)
 .S DAY=DAY_$E(IN,($F(IN,DOW)-4))_","
"RTN","OOPSUTL4",85,0)
 .Q
"RTN","OOPSUTL4",86,0)
 ;I DAY'="" S DAY=$E(DAY,1,($L(DAY)-1))
"RTN","OOPSUTL4",87,0)
 Q DAY
"RTN","OOPSVAL1")
0^10^B16960737
"RTN","OOPSVAL1",1,0)
OOPSVAL1 ;HINES/WAA,GTD - Validate and Sign data Routines - 3/25/98 [ 04/17/1998  3:20 PM ]
"RTN","OOPSVAL1",2,0)
 ;;1.0;ASISTS;**1,3**;Jun 01, 1998
"RTN","OOPSVAL1",3,0)
 ;;
"RTN","OOPSVAL1",4,0)
EN1(CALLER) ;  Main Entry Point
"RTN","OOPSVAL1",5,0)
 ;INPUT:
"RTN","OOPSVAL1",6,0)
 ;     CALLER = "E" FOR EMPLOYEE
"RTN","OOPSVAL1",7,0)
 ;            = "S" FOR SUPERVISOR
"RTN","OOPSVAL1",8,0)
 ;            = "O" FOR SAFETY OFFICER
"RTN","OOPSVAL1",9,0)
 N SSN,IEN,SIGN,EDIT,FORM,GRP,SUP,I,CIT,HSA,STA,ZIP
"RTN","OOPSVAL1",10,0)
 S IEN=0
"RTN","OOPSVAL1",11,0)
 Q:DUZ<1
"RTN","OOPSVAL1",12,0)
 Q:$G(^VA(200,DUZ,1))=""
"RTN","OOPSVAL1",13,0)
 I CALLER="E" S SSN=$P(^VA(200,DUZ,1),U,9) Q:$D(^OOPS(2260,"SSN",SSN))<1
"RTN","OOPSVAL1",14,0)
 D  Q:IEN<1
"RTN","OOPSVAL1",15,0)
 .N DIC,X
"RTN","OOPSVAL1",16,0)
 .S DIC="^OOPS(2260,"
"RTN","OOPSVAL1",17,0)
 .I CALLER="E" S DIC("S")="I $$EMPSCR^OOPSVAL1(Y)"
"RTN","OOPSVAL1",18,0)
 .I CALLER="S" S DIC("S")="I $$SUPSCR^OOPSVAL1(Y)"
"RTN","OOPSVAL1",19,0)
 .I CALLER="O" S DIC("S")="I $$SAFSCR^OOPSVAL1(Y)"
"RTN","OOPSVAL1",20,0)
 .S DIC("S")=DIC("S")_",'$$GET1^DIQ(2260,Y,51,""I"")"
"RTN","OOPSVAL1",21,0)
 .S DIC(0)="AEMNZ",DIC("A")="   Select Case: "
"RTN","OOPSVAL1",22,0)
 .D ^DIC
"RTN","OOPSVAL1",23,0)
 .Q:Y<1
"RTN","OOPSVAL1",24,0)
 .Q:$D(DTOUT)!($D(DUOUT))
"RTN","OOPSVAL1",25,0)
 .S IEN=$P(Y,U)
"RTN","OOPSVAL1",26,0)
 .Q
"RTN","OOPSVAL1",27,0)
 I CALLER="O" S FORM="2162" D FORM Q
"RTN","OOPSVAL1",28,0)
 I CALLER="E" D
"RTN","OOPSVAL1",29,0)
 .S FORM=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",30,0)
 .S FORM=$S(FORM=1:"CA1",FORM=2:"CA2",1:"")
"RTN","OOPSVAL1",31,0)
 .Q:FORM=""
"RTN","OOPSVAL1",32,0)
 .D FORM
"RTN","OOPSVAL1",33,0)
 .Q
"RTN","OOPSVAL1",34,0)
 I CALLER="S" D
"RTN","OOPSVAL1",35,0)
 .N CNT,PAUSE,OUT,FORM,EDIT
"RTN","OOPSVAL1",36,0)
 .S (PAUSE,OUT)=0
"RTN","OOPSVAL1",37,0)
 .D
"RTN","OOPSVAL1",38,0)
 ..N INC,STAT,ESTAT
"RTN","OOPSVAL1",39,0)
 ..S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",40,0)
 ..S STAT=$$EDSTA^OOPSUTL1(IEN,"S")
"RTN","OOPSVAL1",41,0)
 ..; added check for employee having signed CA1
"RTN","OOPSVAL1",42,0)
 ..S ESTAT=$$EDSTA^OOPSUTL1(IEN,"E")
"RTN","OOPSVAL1",43,0)
 ..; if employee signed ok to let super select if no forms signed
"RTN","OOPSVAL1",44,0)
 ..I $P(ESTAT,U,INC) D
"RTN","OOPSVAL1",45,0)
 ...I '$P(STAT,U,INC),'$P(STAT,U,3) D SELECT^OOPSSUP1 Q
"RTN","OOPSVAL1",46,0)
 ...S EDIT=$S('$P(STAT,U,3):2162,'$P(STAT,U,INC):$P("CA1^CA2",U,INC),1:"")
"RTN","OOPSVAL1",47,0)
 ..I '$P(ESTAT,U,INC) D  ;  Employee has not signed CA1/CA2
"RTN","OOPSVAL1",48,0)
 ...I '$P(STAT,U,3) S EDIT=2162 Q
"RTN","OOPSVAL1",49,0)
 ...S EDIT=""
"RTN","OOPSVAL1",50,0)
 .I EDIT="" Q
"RTN","OOPSVAL1",51,0)
 .F CNT=1:1 S FORM=$P(EDIT,U,CNT) Q:FORM=""  D:PAUSE END Q:OUT  D
"RTN","OOPSVAL1",52,0)
 ..D FORM S PAUSE=1
"RTN","OOPSVAL1",53,0)
 ..Q
"RTN","OOPSVAL1",54,0)
 .Q
"RTN","OOPSVAL1",55,0)
 Q
"RTN","OOPSVAL1",56,0)
EMPSCR(IEN) ;
"RTN","OOPSVAL1",57,0)
 N VIEW
"RTN","OOPSVAL1",58,0)
 S VIEW=1
"RTN","OOPSVAL1",59,0)
 I '$$EMP^OOPSUTL1(IEN,SSN) S VIEW=0
"RTN","OOPSVAL1",60,0)
 E  D
"RTN","OOPSVAL1",61,0)
 .N INC
"RTN","OOPSVAL1",62,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",63,0)
 .I $P($$EDSTA^OOPSUTL1(IEN,"E"),U,INC) S VIEW=0
"RTN","OOPSVAL1",64,0)
 .Q
"RTN","OOPSVAL1",65,0)
 Q VIEW
"RTN","OOPSVAL1",66,0)
SUPSCR(IEN) ;
"RTN","OOPSVAL1",67,0)
 N VIEW
"RTN","OOPSVAL1",68,0)
 S VIEW=1
"RTN","OOPSVAL1",69,0)
 I '$$SUPSCR^OOPSUTL2(DUZ,IEN) S VIEW=0
"RTN","OOPSVAL1",70,0)
 E  D
"RTN","OOPSVAL1",71,0)
 .N INC,STAT,ESTAT,CAT
"RTN","OOPSVAL1",72,0)
 .S CAT=$$GET1^DIQ(2260,IEN,2,"I")              ; Personnel status
"RTN","OOPSVAL1",73,0)
 .S INC=$$GET1^DIQ(2260,IEN,52,"I")             ; Injury/Illness
"RTN","OOPSVAL1",74,0)
 .S STAT=$$EDSTA^OOPSUTL1(IEN,"S")              ; sup signed forms
"RTN","OOPSVAL1",75,0)
 .S ESTAT=$$EDSTA^OOPSUTL1(IEN,"E")             ; emp signed forms
"RTN","OOPSVAL1",76,0)
 .; Added Non-PAID employee to check, not emp, 2162 signed
"RTN","OOPSVAL1",77,0)
 .I CAT>2,CAT'=6,$P(STAT,U,3) S VIEW=0 Q
"RTN","OOPSVAL1",78,0)
 .; super signed 2162 and CA1/CA2
"RTN","OOPSVAL1",79,0)
 .I $P(STAT,U,INC),$P(STAT,U,3) S VIEW=0 Q
"RTN","OOPSVAL1",80,0)
 .; emp not signed CA1/CA2, super signed 2162, not signed CA1/CA2 - no
"RTN","OOPSVAL1",81,0)
 .I '$P(ESTAT,U,INC),$P(STAT,U,3),'$P(STAT,U,INC) S VIEW=0 Q
"RTN","OOPSVAL1",82,0)
 .Q
"RTN","OOPSVAL1",83,0)
 Q VIEW
"RTN","OOPSVAL1",84,0)
SAFSCR(IEN) ;
"RTN","OOPSVAL1",85,0)
 N VIEW
"RTN","OOPSVAL1",86,0)
 S VIEW=1
"RTN","OOPSVAL1",87,0)
 I '$$SAFETY^OOPSUTL2(IEN) S VIEW=0
"RTN","OOPSVAL1",88,0)
 I $$EDSTA^OOPSUTL1(IEN,"O") S VIEW=0
"RTN","OOPSVAL1",89,0)
 Q VIEW
"RTN","OOPSVAL1",90,0)
END ;End of Form pause
"RTN","OOPSVAL1",91,0)
 N DIR
"RTN","OOPSVAL1",92,0)
 W !
"RTN","OOPSVAL1",93,0)
 S DIR(0)="E" D ^DIR
"RTN","OOPSVAL1",94,0)
 S:$D(DIRUT) OUT=1 Q
"RTN","OOPSVAL1",95,0)
 Q
"RTN","OOPSVAL1",96,0)
FORM ;Select Form
"RTN","OOPSVAL1",97,0)
 D:'$G(PAUSE,0) DISPLAY^OOPSSUP1
"RTN","OOPSVAL1",98,0)
 D SIGN(FORM)
"RTN","OOPSVAL1",99,0)
 Q:+SIGN=0  ; Form was not signed
"RTN","OOPSVAL1",100,0)
 I CALLER="E" D EMP
"RTN","OOPSVAL1",101,0)
 I CALLER="S" D SUP
"RTN","OOPSVAL1",102,0)
 I CALLER="O" D SAF
"RTN","OOPSVAL1",103,0)
 Q
"RTN","OOPSVAL1",104,0)
SIGN(FORM) ; Sign/validate Document
"RTN","OOPSVAL1",105,0)
 N EMP,INC,VALID,OUT
"RTN","OOPSVAL1",106,0)
 S VALID=0,SIGN=""
"RTN","OOPSVAL1",107,0)
 S INC=$$GET1^DIQ(2260,IEN,52,"I")
"RTN","OOPSVAL1",108,0)
 D VALIDATE^OOPSUTL4(IEN,FORM,CALLER,.VALID)
"RTN","OOPSVAL1",109,0)
 I 'VALID D END Q
"RTN","OOPSVAL1",110,0)
 S SIGN=$$SIG^OOPSESIG(DUZ,IEN)
"RTN","OOPSVAL1",111,0)
 Q
"RTN","OOPSVAL1",112,0)
EMP ; Employee Sign off
"RTN","OOPSVAL1",113,0)
 I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,1,3)=SIGN
"RTN","OOPSVAL1",114,0)
 I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,1,3)=SIGN
"RTN","OOPSVAL1",115,0)
 D EMP^OOPSMBUL(IEN)
"RTN","OOPSVAL1",116,0)
 Q
"RTN","OOPSVAL1",117,0)
SUP ;Supervisor Sign off
"RTN","OOPSVAL1",118,0)
 I FORM="CA1" S $P(^OOPS(2260,IEN,"CA1ES"),U,4,6)=SIGN
"RTN","OOPSVAL1",119,0)
 I FORM="CA2" S $P(^OOPS(2260,IEN,"CA2ES"),U,4,6)=SIGN
"RTN","OOPSVAL1",120,0)
 I FORM="2162" S $P(^OOPS(2260,IEN,"2162ES"),U,1,3)=SIGN D SAFETY^OOPSMBUL(IEN)
"RTN","OOPSVAL1",121,0)
 Q
"RTN","OOPSVAL1",122,0)
SAF ; Safety Officer Sign off
"RTN","OOPSVAL1",123,0)
 I FORM="2162" S $P(^OOPS(2260,IEN,"2162ES"),U,4,6)=SIGN
"RTN","OOPSVAL1",124,0)
 Q
"VER")
8.0^21.0
"^DD",2260,2260,2,0)
PERSONNEL STATUS^RSX^1:Employee;2:Volunteer;3:Contractor;4:Visitor;5:Other;6:Non-PAID Employee;^0;3^Q
"^DD",2260,2260,2,1,0)
^.1
"^DD",2260,2260,2,1,1,0)
2260^AC
"^DD",2260,2260,2,1,1,1)
S ^OOPS(2260,"AC",$E(X,1,30),DA)=""
"^DD",2260,2260,2,1,1,2)
K ^OOPS(2260,"AC",$E(X,1,30),DA)
"^DD",2260,2260,2,1,1,"DT")
2980407
"^DD",2260,2260,2,3)
Enter the status. Non-PAID Employee includes student and resident. 
"^DD",2260,2260,2,21,0)
^^3^3^2990414^^^^
"^DD",2260,2260,2,21,1,0)
The personnel status of the individual involved in the incident is either
"^DD",2260,2260,2,21,2,0)
employee, volunteer, contractor, visitor or other.  Non-PAID Employee
"^DD",2260,2260,2,21,3,0)
includes students and residents.
"^DD",2260,2260,2,"DT")
2990414
"^DD",2260,2260,109,0)
DATE/TIME INJURY OCCURRED^D^^CA1A;10^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
"^DD",2260,2260,109,.1)
10. DATE/TIME INJURY OCCURRED
"^DD",2260,2260,109,3)
Enter a date and time the injury occurred.
"^DD",2260,2260,109,21,0)
^^1^1^2990610^^^
"^DD",2260,2260,109,21,1,0)
This is the date and time the injury occurred.
"^DD",2260,2260,109,"DT")
2990610
**END**
**END**
