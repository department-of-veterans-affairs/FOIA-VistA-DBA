$TXT Created by THEROUX,JOHN at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Friday, 05/05/06 at 14:53
=============================================================================
Run Date: AUG 10, 2006                     Designation: DG*5.3*701
Package : DG - REGISTRATION                   Priority: Mandatory
Version : 5.3       SEQ #627                    Status: Released
                  Compliance Date: SEP 10, 2006
=============================================================================

Associated patches: (v)DG*5.3*635  <<= must be installed BEFORE `DG*5.3*701'
                    (v)DG*5.3*643  <<= must be installed BEFORE `DG*5.3*701'
                    (v)DG*5.3*669  <<= must be installed BEFORE `DG*5.3*701'

Subject: NON-VA PTF CENSUS & OTHER PTF PROBLEMS

Category: 
  - Routine

Description:
============

   This patch deals with non-VA PTF census problems, the inability to
 select certain ICD9 codes on the 501 screen of PTF Load/Edit, and a 
 system error when transferring patients. 
  
  ASSOCIATED Remedy Tickets:
  =========================
 1) HD 127419 - Can't delete open census
    duplicates:
    HD 127397
    HD 127674
    HD 138290
    HD 115635
  
 2) HD 138906 - Codes not selectable on 501 screens
    duplicates:
    HD 138973
    HD 138870
    HD 137342
    HD 142514
    HD 146801
  
 3) HD 106542 - <UNDEFINED>EN+5^DGPTFJC
    duplicates:
    HD 107874
    HD 111240
    HD 112854
    HD 117285
    HD 139187
  
  ASSOCIATED NSR(s):
  ===================
  N/A
  
  PARTICIPATING TEST SITES:
  =========================
 Madison,WI
 El Paso,TX
 Puget Sound HCS
 Denver,CO
 St. Cloud, MN
  
  
  REMEDY OVERVIEW:
  ================
  
 1) HD 127419  Can't delete open census
  
 Problem:
 ========
 When non-VA PTF records are created, the system goes into census mode 
 automatically.
 The screen displays "Census Status: Open" and when user attempts to close 
 the PTF record the 701 screen displays:
  
    PTF   #2769 actions: 1=Edit   C=Close       ^N=Another Screen
 CENSUS  record actions:          L=Close
                         ^=Abort   <RET> to Continue: 
  
 Solution:
 =========
 Routine DGPTC1 was modified to prevent going into census mode if
 admission date is after current census date (last day of last quarter)
 or admission date is before current census date but patient is discharged.
  
 2) HD 138906  Codes not selectable on 501 screen
  
 Problem:
 ========
 Using the PTF Load/Edit, certain ICD9 codes which can be used on
 the 701 screen cannot be used on the 501 screen.
  
 Solution:
 =========
 Routine DGPTF5 was modified to pass DA(1) instead of DA to the 
 $$GETDATE^ICDGTDRG() API when doing the code lookup on the Lexicon.
  
 3) HD 106542  <UNDEFINED>EN+5^DGPTFJC
  
 Problem:
 ========
 Several tickets have reported a system error when using Bed Control 
 and checking for ICD9 codes on the PTF.  One example of this problem
 which has been reproduced involved using the 'Transfer a Patient' 
 option to delete more than one movement after the ICD9 coding had 
 been done.
  
 Solution:
 =========
 Routine DGPTFJC has been modified to set a required variable
 when ICD9 codes are invoked using Bed Control options. 
  
  
  
 INSTALLATION INSTRUCTIONS:
 ===========================
 This patch may be run with users on the system.
  
 Installation will take less than 1 minute.
  
 1.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu to unload
     the KIDS distribution included with this message.
  
     NOTE:  If the required patches are not installed, the transport global
            will be removed.  If the transport global is removed you will
            need to repeat this step.
  
 2.  From the Kernel Installation and Distribution System Menu, select
     the Installation menu.
  
 3.  From this menu, you may elect to use the following options
     (when prompted for INSTALL NAME, enter DG*5.3*701):
     a.  Compare Transport Global to Current System  - this option will
         allow you to view all changes that will be made when the patch
         is installed.  It compares all components of the patch (routines,
         DDs, templates, etc.).
     b.  Verify Checksums in Transport Global - this option will
         allow you to ensure the integrity of the routines that are in
         the transport global.
     c.  Print Transport Global - this option will allow you to view the
         components of the KIDS build.
     d.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
  
 4.  Use the Install Package(s) option and select the package DG*5.3*701.
  
 5.  When prompted 'Want KIDS to INHIBIT LOGONs during the install?
     YES//', respond NO.
  
 6.  When prompted,'Want to DISABLE Scheduled Options, Menu Options, and 
     Protocols? NO//', respond Yes.
     When prompted,'Enter options you wish to mark as 'Out Of Order':',
     enter:
             PTF Menu  [DG PTF MENU]
   
     When prompted,'Enter protocols you wish to mark as 'Out Of Order':', 
     press enter.
  
 ROUTINE SUMMARY:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
  
      <tab>;;5.3;Registration;**[patch list]**;Aug 13, 1993
  
  using old logic:
  
                             CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGPTC1                 8856880              9135507       37,413,643,701
  DGPTF5                 1561769              1790946           669,701
  DGPTFJC               25194203             25496090      158,510,517,590,
                                                               636,635,701

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DGPTC1
    Before: B24771658  After: B26128925  **37,413,643,701**
 Description of Changes:
  **************************************************************************
  *****
  DGPTC1.INT.1
   +2         ;;5.3;Registration;**37,413,643,701**;Aug 13, 1993
  ...................
  |"PATVEE"|DGPTC1.INT.1
   +2         ;;5.3;Registration;**37,413,643**;Aug 13, 1993
  ---------------------------------------
  DGPTC1.INT.1
   +17        ;I $P(DGPTF0,U,4) D FEE G CENQ  ;DG*701 reposition line 
   +18        S DGT=$P(DGCN0,U)_".9" I '$P(DGPTF0,U,4) D WARD I 'Y K DGCN G 
  CENQ
   +19        ;if Fee Basis quit if admit > census date or admit < census 
  date if
   disch
   +20        I $P(DGPTF0,U,4)=1,$P(DGPTF0,U,2)>DGT G CENQ
   +21        I 
  $P(DGPTF0,U,4)=1,+$P($G(^DGPT(PTF,70)),U),$P(DGPTF0,U,2)<DGT G CE
  NQ
   +22        I $P(DGPTF0,U,4)=1 D FEE G CENQ
  ...................
  |"PATVEE"|DGPTC1.INT.1
   +17        I $P(DGPTF0,U,4) D FEE G CENQ
   +18        S DGT=$P(DGCN0,U)_".9" D WARD I 'Y K DGCN G CENQ
  **************************************************************************
  *****

Routine Name: DGPTF5
    Before:  B2579843  After:  B2939565  **669,701**
 Description of Changes:
  **************************************************************************
  *****
  DGPTF5.INT.1
   +2         ;;5.3;Registration;**669,701**;Aug 13, 1993
  ...................
  |"PATVEE"|DGPTF5.INT.1
   +2         ;;5.3;Registration;**669**;Aug 13, 1993
  ---------------------------------------
  DGPTF5.INT.1
   +21        I DA'=$G(DGPTF),DA<25,$G(DA(1))>0 D 
  CONFIG^LEXSET("ICD",,$$GETDATE^
  ICDGTDRG(DA(1)))
   +22        E  D CONFIG^LEXSET("ICD",,$$GETDATE^ICDGTDRG(DA))
  ...................
  |"PATVEE"|DGPTF5.INT.1
   +21        D CONFIG^LEXSET("ICD",,$$GETDATE^ICDGTDRG(DA))
  **************************************************************************
  *****

Routine Name: DGPTFJC
    Before: B46752372  After: B47957071  **158,510,517,590,636,635,701**
 Description of Changes:
  **************************************************************************
  *****
  DGPTFJC.INT.1
   +2         ;;5.3;Registration;**158,510,517,590,636,635,701**;Aug 13, 
  1993
  ...................
  |"PATVEE"|DGPTFJC.INT.1
   +2         ;;5.3;Registration;**158,510,517,590,636,635**;Aug 13, 1993
  ---------------------------------------
  DGPTFJC.INT.1
   +39        I $G(DGPMT) S DGZM0=1,M(DGZM0)="0^"  ; to prevent sys err 
  from TD5^
  DGPTTS2 (DG*701)
  ...................
  |"PATVEE"|DGPTFJC.INT.1
  ---------------------------------------
  DGPTFJC.INT.1
   +50        I $G(DGPMT) K M(DGZM0),DGZM0  ; DG*701
  ...................
  |"PATVEE"|DGPTFJC.INT.1
  **************************************************************************
  *****


=============================================================================
User Information:
Entered By  : THEROUX,JOHN                  Date Entered  : JAN 30, 2006
Completed By: BOWEN,MARY JANE               Date Completed: AUG 01, 2006
Released By : ALEXANDER,DIANNE              Date Released : AUG 10, 2006
=============================================================================


Packman Mail Message:
=====================

$END TXT
