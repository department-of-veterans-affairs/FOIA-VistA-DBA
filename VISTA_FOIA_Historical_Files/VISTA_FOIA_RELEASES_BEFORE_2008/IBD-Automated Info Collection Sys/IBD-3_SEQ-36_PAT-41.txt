
=============================================================================
Run Date: MAY 23, 2001                     Designation: IBD*3*41
Package : IBD - AUTOMATED INFO  SYSPriority: Mandatory
Version : 3        SEQ #36                      Status: Released
=============================================================================


Subject: PURGING AICS FILES

Category: 
  - Informational

Description: 
============

 Capacity Management has completed another review of disk consumption for
 VistA.  As a result of the review, the ENCOUNTER FORM TRACKING (357.96)
 file was found to be causing rapid and unexpected growth of the IBD
 global.  It was discovered that some sites are using AICS to print
 encounter forms but not using AICS to capture encounter data.  If the
 purge parameters are not set appropriately, the file can become extremely
 large.  This patch is a reminder for each site to check parameters and
 insure the parameters are appropriately set.  Below is a guideline for
 setting parameters.    
  
 *** NOTE *** If purging has not been performed before, it may take a long
              time to complete the first time.  Also, the IRM should be
              alerted to check journaling or disable journaling.
  
 INSTRUCTIONS (Non Cache NT Sites) FOR ONE-TIME RUN:
 ===================================================
  
 Encounter Form IRM Options:
  
 Purge Form Tracking files [IBDF MANUAL PURGE FORM TRACK]
  
 This option is locked with the IBDF IRM security key.
  
 Introduction:
 This option is used to clean up old data in AICS files.  Sites are allowed
 to choose the type of data to be deleted, and the number of days of data
 that should be retained.  In addition, sites are allowed to choose whether
 or not to retain data on items where the AICS processing is incomplete.  
  
 Sites that do not scan and do not use AICS Manual Data Entry should purge
 all files completely and retain the minimum amount of data.  
  
 EXAMPLE SET UP:
  
 Do you want to purge Form Tracking?
 Enter Yes or No: YES
  
 Do you want to purge Form Definitions and Form Specifications?
 Enter Yes or No: YES
 Number of Days to Retain:  (60-999): 180// 30
  
      Select one of the following:
  
           0         None
           1         Purge Completed Entries
           2         Purge All Entries
  
 Purge what Entries: 2//   Purge All Entries
 Requested Start Time: NOW//
  
 Sites that are actively scanning may choose to keep data for a longer
 period, and purge only completed records depending upon the speed of
 completing outpatient records.
  
 EXAMPLE:
  
 Do you want to purge Form Tracking?
 Enter Yes or No: YES
  
 Do you want to purge Form Definitions and Form Specifications?
 Enter Yes or No: YES
 Number of Days to Retain:  (60-999): 180// 
  
         Select one of the following:
  
                  0         None
                  1         Purge Completed Entries
                  2         Purge All Entries
  
 Purge what Entries: 1//   Purge Completed Entries 
 Requested Start Time: NOW//
  
 This option needs no device and has no output.  
  
 It is recommended that this task be scheduled to run at least once weekly, 
 either during the weekend or at some other off-peak time.  Use the option 
 IBDF AUTO PURGE FORM TRACKING to automatically queue this option to run on a
 recurring basis.  Ensure ENCOUNTER FORM PARAMETERS (357.09) fields RECORDS TO 
 PURGE (.02) and FORM TRACKING RETENTION DAYS (.03) are populated 
 appropriately.  The task will purge old data from several AICS files 
 including:
  
 FORM DEFINITION file (357.95)
 ENCOUNTER FORM TRACKING file (357.96)
 FORM SPECS file (359.2)
 AICS ERROR AND WARNING LOG file (359.3)
  
 EXAMPLES OF ENCOUNTER FORM PARAMETER FILE SETTINGS
 ==================================================
  
 Sites that do not scan and do not use AICS Manual Data Entry should purge
 all files completely and retain the minimum amount of data.  
  
 RECORDS TO PURGE: ALL// ?
      Choose from: 
        0        NONE
        1        COMPLETED
        2        ALL
 RECORDS TO PURGE: ALL// 
 FORM TRACKING RETENTION DAYS: 60//
  
 Sites that are actively scanning may choose to keep data for a longer
 period, and purge only completed records depending upon the speed of
 completing outpatient records.
  
 RECORDS TO PURGE: COMPLETED// ?
      Choose from: 
        0        NONE
        1        COMPLETED
        2        ALL
 RECORDS TO PURGE: COMPLETED// 
 FORM TRACKING RETENTION DAYS: 180//
  
 INSTRUCTIONS FOR CACHE NT SITES:
 ===============================
  
 If the fields; .02, RECORDS TO PURGE = ALL and field .03, FORM TRACKING
 RETENTION DAYS = 60 in File 357.09, ENCOUNTER FORM PARAMETERS, and you
 already have the option IBDF PURGE scheduled to run on a weekly basis then
 you do not need to manually purge your AICS Files.
  
 In Programmer Mode, in VAH or TST, D ^XUP, to set up variables.  So
 that the purge does not fill your journals and cause your system to hang,
 we will disable journaling just for this purge.  At the programmer prompt:
  
 >"D DISABLE^%NOJRN <CR> 
  
 and now start the purge.
  
 >D AUTO^IBDFPRG
  
 When the Purge has stopped, you should get a printout of the results and
 your cursor will return to the programmers prompt.  The time depends when
 or if you have run the purge before.  If this is your first AICS purge and
 if you have had heavy activity with your encounter forms, it might take
 overnight.  If you need to stop this job or it stops itself before
 completion, you can restart it by repeating the above instructions.  All of
 the kills up to the point where it stopped will have been purged.  Once
 the job has stopped you will need to halt or ENABLE JOURNALING.  The
 command to ENABLE is D ENABLE^%NOJRN.
  
         EXAMPLE OF MANUAL PURGE:
         >D AUTO^IBDFPRG
  
 Purge of Form Tracking Statistics
 Status of Form Tracking Entries Purged .......... All
 Form Tracking entries purged up to ............... Feb 24, 2001
 Number of Form tracking Entries Deleted .........    10000
 Number of Form Definition Entries Deleted .......   1000
 Number of Form Specification Entries Deleted ....  10000
 Number of AICS Error Log Entries Deleted ........   100
 >
 In TASKMANAGER menu, Scheduled Options, queue the IBDF AUTO PURGE
 FORM TRACKING to run once weekly on a recurring basis.
  
 If you are a Cache NT site and you need to perform the manual purge, 
 please call the help desk, between 7 AM CST and 6:30 PM CST, Monday -
 Friday, at 888-596-4357 and we will have someone walk you through the
 procedure.

Routine Information:
====================

=============================================================================
User Information:                               
Entered By  : HARRIS,DONNA H                Date Entered : APR 06, 2001
Completed By: PHELPS,TY                     Date Completed: MAY 23, 2001
Released By : DUGARD,ROBERT                 Date Released : MAY 23, 2001
=============================================================================


Packman Mail Message:
=====================

No routines included
