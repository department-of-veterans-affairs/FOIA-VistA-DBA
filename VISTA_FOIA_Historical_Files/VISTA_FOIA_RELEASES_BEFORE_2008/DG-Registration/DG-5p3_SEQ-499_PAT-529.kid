Released DG*5.3*529 SEQ #499
Extracted from mail message
**KIDS**:DG*5.3*529^

**INSTALL NAME**
DG*5.3*529
"BLD",4972,0)
DG*5.3*529^REGISTRATION^0^3030930^y
"BLD",4972,1,0)
^^4^4^3030916^
"BLD",4972,1,1,0)
This patch fixes reported problems with the DG SCHED AMIT option, MST
"BLD",4972,1,2,0)
Summary Report, the Detailed Demographic Report, Fee Basis PTF records 
"BLD",4972,1,3,0)
with no admit time, CUM ADC Totals on the BSR and printing a blank
"BLD",4972,1,4,0)
lines for 'DON'T DISPLAY' Totals on the BSR.
"BLD",4972,4,0)
^9.64PA^41.1^1
"BLD",4972,4,41.1,0)
41.1
"BLD",4972,4,41.1,2,0)
^9.641^41.1^1
"BLD",4972,4,41.1,2,41.1,0)
SCHEDULED ADMISSION  (File-top level)
"BLD",4972,4,41.1,2,41.1,1,0)
^9.6411^10^2
"BLD",4972,4,41.1,2,41.1,1,8,0)
WARD
"BLD",4972,4,41.1,2,41.1,1,10,0)
WARD OR TREATING SPECIALTY
"BLD",4972,4,41.1,222)
y^n^p^^^^n^^n
"BLD",4972,4,41.1,224)

"BLD",4972,4,"APDD",41.1,41.1)

"BLD",4972,4,"APDD",41.1,41.1,8)

"BLD",4972,4,"APDD",41.1,41.1,10)

"BLD",4972,4,"B",41.1,41.1)

"BLD",4972,"KRN",0)
^9.67PA^8989.52^19
"BLD",4972,"KRN",.4,0)
.4
"BLD",4972,"KRN",.401,0)
.401
"BLD",4972,"KRN",.402,0)
.402
"BLD",4972,"KRN",.403,0)
.403
"BLD",4972,"KRN",.5,0)
.5
"BLD",4972,"KRN",.84,0)
.84
"BLD",4972,"KRN",3.6,0)
3.6
"BLD",4972,"KRN",3.8,0)
3.8
"BLD",4972,"KRN",9.2,0)
9.2
"BLD",4972,"KRN",9.8,0)
9.8
"BLD",4972,"KRN",9.8,"NM",0)
^9.68A^4^2
"BLD",4972,"KRN",9.8,"NM",3,0)
DGPT501^^0^B11017449
"BLD",4972,"KRN",9.8,"NM",4,0)
DGPMBSP3^^0^B13681704
"BLD",4972,"KRN",9.8,"NM","B","DGPMBSP3",4)

"BLD",4972,"KRN",9.8,"NM","B","DGPT501",3)

"BLD",4972,"KRN",19,0)
19
"BLD",4972,"KRN",19.1,0)
19.1
"BLD",4972,"KRN",101,0)
101
"BLD",4972,"KRN",409.61,0)
409.61
"BLD",4972,"KRN",771,0)
771
"BLD",4972,"KRN",870,0)
870
"BLD",4972,"KRN",8989.51,0)
8989.51
"BLD",4972,"KRN",8989.52,0)
8989.52
"BLD",4972,"KRN",8994,0)
8994
"BLD",4972,"KRN","B",.4,.4)

"BLD",4972,"KRN","B",.401,.401)

"BLD",4972,"KRN","B",.402,.402)

"BLD",4972,"KRN","B",.403,.403)

"BLD",4972,"KRN","B",.5,.5)

"BLD",4972,"KRN","B",.84,.84)

"BLD",4972,"KRN","B",3.6,3.6)

"BLD",4972,"KRN","B",3.8,3.8)

"BLD",4972,"KRN","B",9.2,9.2)

"BLD",4972,"KRN","B",9.8,9.8)

"BLD",4972,"KRN","B",19,19)

"BLD",4972,"KRN","B",19.1,19.1)

"BLD",4972,"KRN","B",101,101)

"BLD",4972,"KRN","B",409.61,409.61)

"BLD",4972,"KRN","B",771,771)

"BLD",4972,"KRN","B",870,870)

"BLD",4972,"KRN","B",8989.51,8989.51)

"BLD",4972,"KRN","B",8989.52,8989.52)

"BLD",4972,"KRN","B",8994,8994)

"BLD",4972,"QUES",0)
^9.62^^
"BLD",4972,"REQB",0)
^9.611^3^2
"BLD",4972,"REQB",2,0)
DG*5.3*164^1
"BLD",4972,"REQB",3,0)
DG*5.3*85^1
"BLD",4972,"REQB","B","DG*5.3*164",2)

"BLD",4972,"REQB","B","DG*5.3*85",3)

"FIA",41.1)
SCHEDULED ADMISSION
"FIA",41.1,0)
^DGS(41.1,
"FIA",41.1,0,0)
41.1PIO
"FIA",41.1,0,1)
y^n^p^^^^n^^n
"FIA",41.1,0,10)

"FIA",41.1,0,11)

"FIA",41.1,0,"RLRO")

"FIA",41.1,0,"VR")
5.3^DG
"FIA",41.1,41.1)
1
"FIA",41.1,41.1,8)

"FIA",41.1,41.1,10)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
529^3030930^100850
"PKG",5,22,1,"PAH",1,1,0)
^^4^4^3030930
"PKG",5,22,1,"PAH",1,1,1,0)
This patch fixes reported problems with the DG SCHED AMIT option, MST
"PKG",5,22,1,"PAH",1,1,2,0)
Summary Report, the Detailed Demographic Report, Fee Basis PTF records 
"PKG",5,22,1,"PAH",1,1,3,0)
with no admit time, CUM ADC Totals on the BSR and printing a blank
"PKG",5,22,1,"PAH",1,1,4,0)
lines for 'DON'T DISPLAY' Totals on the BSR.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","DGPMBSP3")
0^4^B13681704
"RTN","DGPMBSP3",1,0)
DGPMBSP3 ;ALB/LM - BSR PRINT, CONT.; 13 JUNE 90 ; 9/16/03 3:47pm
"RTN","DGPMBSP3",2,0)
 ;;5.3;Registration;**59,85,529**;Aug 13, 1993
"RTN","DGPMBSP3",3,0)
 ;
"RTN","DGPMBSP3",4,0)
A S NTOTAL="",(ORDER,CW,CB,CUM,BD,CT)=0
"RTN","DGPMBSP3",5,0)
 ;  ^UTILITY("DGWOR",$J,ORDER)=19 PIECE PRINT/STATS LINE
"RTN","DGPMBSP3",6,0)
 F O1=0:0 S ORDER=$O(^UTILITY("DGWOR",$J,ORDER)) Q:ORDER'>0  S DGWOR=^(ORDER),BDAY=$S($D(^UTILITY("DGWBD",$J,ORDER)):^(ORDER),1:0) D WR
"RTN","DGPMBSP3",7,0)
 K BD,BDAY,C,CB,CW,I,I1,L,N,N1,ORDER,O1,TL,W,X,X1,Y,T,T1,T2,T3,TN,TX,TY,DGWOR,DGWON,DGWNN,DGWTOR
"RTN","DGPMBSP3",8,0)
Q Q
"RTN","DGPMBSP3",9,0)
 ;
"RTN","DGPMBSP3",10,0)
 ;  $P(BDAY,"^",3) = Display on BSR
"RTN","DGPMBSP3",11,0)
WR I $P(BDAY,"^",3) W ! F W=1:1:18 W ?+$P(TAB,"^",W),$J($P(DGWOR,"^",W),$P(JUS,"^",W))
"RTN","DGPMBSP3",12,0)
 ;  $P(BDAY,"^",2) = Include Stats
"RTN","DGPMBSP3",13,0)
 I $P(BDAY,"^",2) D CUM F N1=3:1:16,18 S $P(NTOTAL,"^",N1)=$P(NTOTAL,"^",N1)+$P(DGWOR,"^",N1)
"RTN","DGPMBSP3",14,0)
 Q:$O(^UTILITY("DGWTOR",$J,ORDER,0))'>0
"RTN","DGPMBSP3",15,0)
 S TL=0
"RTN","DGPMBSP3",16,0)
 ;  ^UTILITY("DGWTOR",$J,ORDER,TOTAL LEVEL)=TOTAL NAME ^ PRINT IN CUM TOTALS (ORDER TOTAL)
"RTN","DGPMBSP3",17,0)
 F TL1=0:0 S TL=$O(^UTILITY("DGWTOR",$J,ORDER,TL)) Q:TL'>0  S DGWTOR=^(TL) D TL
"RTN","DGPMBSP3",18,0)
 Q
"RTN","DGPMBSP3",19,0)
 ;
"RTN","DGPMBSP3",20,0)
CUM S CW=CW+1 ; Count Ward
"RTN","DGPMBSP3",21,0)
 S CB=CB+$P(BDAY,"^",4) ;  Cum Beds
"RTN","DGPMBSP3",22,0)
 S BD=BD+BDAY ; Total Elapsed Fiscal Days
"RTN","DGPMBSP3",23,0)
 S DGWON=$S($D(^UTILITY("DGWON",$J,ORDER)):^(ORDER),1:0) ; Last year 0 Node for ward (Old Node)
"RTN","DGPMBSP3",24,0)
 S DGWNN=$S($D(^UTILITY("DGWNN",$J,ORDER)):^(ORDER),1:0) ;  RD's 0 Node for Ward (New Node)
"RTN","DGPMBSP3",25,0)
 S C=0
"RTN","DGPMBSP3",26,0)
 F I=17,29,23,5,6,8,3 F I1=DGWON,DGWNN S C=C+1,$P(CUM,"^",C)=$P(CUM,"^",C)+$P(I1,"^",I)
"RTN","DGPMBSP3",27,0)
 ; CUM=old cum adm^new cum adm^old IWT^new IWT^old cum inter svc xfrs in^new cum inter svc xfers in^old cum disch^new cum disch^old cum inter xfers^new cum inter xfers^old inter svc xfers^new inter svc xfers^old cum bed^new cum bed
"RTN","DGPMBSP3",28,0)
 Q
"RTN","DGPMBSP3",29,0)
 ;
"RTN","DGPMBSP3",30,0)
TL S TC(TL,ORDER)=CUM
"RTN","DGPMBSP3",31,0)
 S TL(TL,ORDER)=NTOTAL
"RTN","DGPMBSP3",32,0)
 S TB(TL,ORDER)=BD_"^"_CW_"^"_CB ;  TOTAL ELAPSED FISCAL DAYS ^ COUNT WARD ^ CUM BED
"RTN","DGPMBSP3",33,0)
 I TL=1 S W=NTOTAL,T2=ORDER D TWR Q
"RTN","DGPMBSP3",34,0)
 S NTOTAL="",T=0
"RTN","DGPMBSP3",35,0)
 F T1=0:0 S T=$O(TL(TL-1,T)) Q:T'>0!(T>ORDER)  S T2=T,TN=TL(TL-1,T),TX=TB(TL-1,T),TY=TC(TL-1,T) D MTL
"RTN","DGPMBSP3",36,0)
 S:$P(DGWTOR,"^",2) CUM(T2,TL)=$P(DGWTOR,"^")_"^"_TC(TL,T2),CT=CT+1 ; CT=CUM TOTAL
"RTN","DGPMBSP3",37,0)
 S CUM="",(W,TL(TL,T2))=NTOTAL D TWR
"RTN","DGPMBSP3",38,0)
 Q
"RTN","DGPMBSP3",39,0)
 ;
"RTN","DGPMBSP3",40,0)
TWR N DGDNTD
"RTN","DGPMBSP3",41,0)
 S DGDNTD=$S($P(DGWTOR,"^")["DON'T DISPLAY":1,1:0)
"RTN","DGPMBSP3",42,0)
 I DGDNTD,TL=1 W:UL["-" ! F L=1:1:131 W UL
"RTN","DGPMBSP3",43,0)
 I 'DGDNTD D
"RTN","DGPMBSP3",44,0)
 .W:$Y<131 ?131,"" W $C(13) W:UL["-" ! F L=1:1:131 W UL
"RTN","DGPMBSP3",45,0)
 .W !
"RTN","DGPMBSP3",46,0)
 .D PTOT ; print line on BSR
"RTN","DGPMBSP3",47,0)
 ; code below updates cums
"RTN","DGPMBSP3",48,0)
 S (CB,BD,CW,NTOTAL)=""
"RTN","DGPMBSP3",49,0)
 I $S('$P(DGWTOR,"^",2):1,TL'=1:1,1:0) S CUM="" Q
"RTN","DGPMBSP3",50,0)
 S CUM(ORDER,TL)=$P(DGWTOR,"^")_"^"_CUM
"RTN","DGPMBSP3",51,0)
 S CUM=""
"RTN","DGPMBSP3",52,0)
 S CT=CT+1 ;  CUM TOTAL
"RTN","DGPMBSP3",53,0)
 Q
"RTN","DGPMBSP3",54,0)
 ;
"RTN","DGPMBSP3",55,0)
PTOT ; Calc Vacant, Overcapacity Beds for Totals
"RTN","DGPMBSP3",56,0)
 S $P(W,"^",11)=$S(+$P(W,"^",13)>+$P(W,"^",6):($P(W,"^",13)-$P(W,"^",6)),1:0) ; Vacant Beds = Operating Beds - Patients Remaining
"RTN","DGPMBSP3",57,0)
 S $P(W,"^",14)=$S(+$P(W,"^",6)>+$P(W,"^",13):($P(W,"^",6)-$P(W,"^",13)),1:0) ; Overcapacity = Patients Remaining - Operating Beds
"RTN","DGPMBSP3",58,0)
 W $P(DGWTOR,"^") ;  Total (level name)
"RTN","DGPMBSP3",59,0)
 F I=3:1:16 W ?+$P(TAB,"^",I),$J($P(W,"^",I),$P(JUS,"^",I))
"RTN","DGPMBSP3",60,0)
 S X(17)=$S($P(TB(TL,T2),"^",3)'>0:0,1:$P(W,"^",18)*100/($P(TB(TL,T2),"^",3))) ;  ADC/(Cum Bed Total/Days into fiscal year)
"RTN","DGPMBSP3",61,0)
 S X(17)=$J(X(17),0,1)_"%" ; Cum Occ Rate
"RTN","DGPMBSP3",62,0)
 S X(18)=$P(W,"^",18) ; Cum Pat Days
"RTN","DGPMBSP3",63,0)
 F I=17:1:18 W ?+$P(TAB,"^",I),$J(X(I),$P(JUS,"^",I))
"RTN","DGPMBSP3",64,0)
 W:$Y<131 ?131,"" W $C(13) W:UL["-" ! F L=1:1:131 W UL
"RTN","DGPMBSP3",65,0)
 I $Y>$S($D(IOSL):(IOSL-5),1:61) D HEAD^DGPMBSP,HEAD2^DGPMBSP
"RTN","DGPMBSP3",66,0)
 Q
"RTN","DGPMBSP3",67,0)
 ;
"RTN","DGPMBSP3",68,0)
MTL F N1=3:1:15,18 S $P(NTOTAL,"^",N1)=$P(NTOTAL,"^",N1)+$P(TN,"^",N1)
"RTN","DGPMBSP3",69,0)
 S T3=$O(TB(TL,T))
"RTN","DGPMBSP3",70,0)
 I T'>T3 S T2=T3
"RTN","DGPMBSP3",71,0)
 F N1=1:1:3 S $P(TB(TL,T2),"^",N1)=$P(TB(TL,T2),"^",N1)+$P(TX,"^",N1)
"RTN","DGPMBSP3",72,0)
 I $P(DGWTOR,"^",2) F N1=1:1:15 S $P(TC(TL,T2),"^",N1)=$P(TC(TL,T2),"^",N1)+$P(TY,"^",N1)
"RTN","DGPMBSP3",73,0)
 K TC(TL-1,T),TL(TL-1,T),TB(TL-1,T),N1,T3
"RTN","DGPMBSP3",74,0)
 Q
"RTN","DGPT501")
0^3^B11017449
"RTN","DGPT501",1,0)
DGPT501 ;ALB/MTC - Set up process 501 transmission ; 8/27/03 10:05am
"RTN","DGPT501",2,0)
 ;;5.3;Registration;**64,164,529**;Aug 13, 1993
"RTN","DGPT501",3,0)
 ;
"RTN","DGPT501",4,0)
EN ;
"RTN","DGPT501",5,0)
 N ERROR
"RTN","DGPT501",6,0)
 S DGPTEDFL=0
"RTN","DGPT501",7,0)
PARSE ; Set up record string, parse record
"RTN","DGPT501",8,0)
 S DGPTSTR=^TMP("AEDIT",$J,NODE,SEQ)
"RTN","DGPT501",9,0)
 D SET^DGPT501P
"RTN","DGPT501",10,0)
DATE ;
"RTN","DGPT501",11,0)
 S DGPTMDT=$E(DGPTSTR,31,40),(X,DGPTMDTS)=$$FMDT^DGPT101($E(DGPTMDT,1,6))_"."_$E(DGPTMDT,7,10) S %DT="XT" D ^%DT K %DT I Y<0 S DGPTERC=505 D ERR G:DGPTEDFL EXIT G ELAPS
"RTN","DGPT501",12,0)
 D DD^%DT S DGPTMDT=$E(Y,5,6)_"-"_$E(Y,1,3)_"-"_$E(Y,9,12)_" "_$S($P(Y,"@",2)]"":$E($P(Y,"@",2),1,5),1:"00:00")
"RTN","DGPT501",13,0)
 I DGPTMDT'?1.2N1"-"3U1"-"4N1" "2N1":"2N S DGPTERC=505 D ERR G:DGPTEDFL EXIT G TSPEC
"RTN","DGPT501",14,0)
 I DGPTMDTS<DGPTDTS S DGPTERC=537 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",15,0)
 I DGPTMDTS>DGPTDDS S DGPTERC=540 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",16,0)
ELAPS ;
"RTN","DGPT501",17,0)
 S DGPTERC=0 S X1=DGPTMDTS D 501^DGPTAE03 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",18,0)
TSPEC ;
"RTN","DGPT501",19,0)
 I DGPTMSC'?2N S DGPTERC=506 D ERR G:DGPTEDFL EXIT G LEAV
"RTN","DGPT501",20,0)
 S DGPTSP1=$E(DGPTMSC,1),DGPTSP2=$E(DGPTMSC,2),DGPTERC=0
"RTN","DGPT501",21,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=506 D ERR G:DGPTEDFL EXIT G LEAV
"RTN","DGPT501",22,0)
 ;-- Active treating specialty edit check
"RTN","DGPT501",23,0)
 I $E(DGPTMSC,1)=0!($E(DGPTMSC,1)=" ") S DGPTMSC=$E(DGPTMSC,2)
"RTN","DGPT501",24,0)
 ;-- If not active treat spec, set flag to print error msg during
"RTN","DGPT501",25,0)
 ;-- PTF close-out error display at WRER^DGPTAEE
"RTN","DGPT501",26,0)
 I '$$ACTIVE^DGACT(42.4,DGPTMSC,DGPTMDTS) S DGPTERC=506,DGPTSER(DGPTMDTS_501)=1 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",27,0)
LEAV ;
"RTN","DGPT501",28,0)
 I DGPTMPD'?1.3N S DGPTERC=508 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",29,0)
SPINL ;
"RTN","DGPT501",30,0)
 D SP^DGPTAE03 I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",31,0)
LOCCDR ;
"RTN","DGPT501",32,0)
 I DGPTMLR'?6N S DGPTERC=575 D ERR G:DGPTEDFL EXIT G LOCTRS
"RTN","DGPT501",33,0)
 ;
"RTN","DGPT501",34,0)
LOCTRS ;
"RTN","DGPT501",35,0)
 I DGPTMLC'?2N&(DGPTMLC'="  ") S DGPTERC=576 D ERR G:DGPTEDFL EXIT G DIAG
"RTN","DGPT501",36,0)
 I DGPTMLC="  "&(DGPTMLR="000000") G DIAG
"RTN","DGPT501",37,0)
 S DGPTSP1=$E(DGPTMLC,1),DGPTSP2=$E(DGPTMLC,2),DGPTERC=0
"RTN","DGPT501",38,0)
 D CHECK^DGPTAE02 I DGPTERC S DGPTERC=576 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",39,0)
DIAG ;
"RTN","DGPT501",40,0)
 D ^DGPT50DI G:DGPTEDFL EXIT
"RTN","DGPT501",41,0)
BSTAT ;
"RTN","DGPT501",42,0)
 I "12345 "'[DGPTMBS S DGPTERC=515 D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",43,0)
FY92 ;
"RTN","DGPT501",44,0)
 I DGPTDDS<2911001 G GOOD
"RTN","DGPT501",45,0)
LEG ; Legionnaires disease
"RTN","DGPT501",46,0)
 S DGPTERC=0 D LEG^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",47,0)
SUI ; Suicide indicator
"RTN","DGPT501",48,0)
 S DGPTERC=0 D SUI^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",49,0)
DRUG ; Drug indicator
"RTN","DGPT501",50,0)
 S DGPTERC=0 D DRUG^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",51,0)
AXES ;Axis 4 and 5
"RTN","DGPT501",52,0)
 I '$P($G(^DIC(42.4,+DGPTMSC,0)),U,4) S (DGPTMXIV,DGPTMXV1,DGPTMXV2)=" " G SERVC
"RTN","DGPT501",53,0)
 S DGPTERC=0 D AXIV^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",54,0)
 S DGPTERC=0 D AXV1^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",55,0)
 S DGPTERC=0 D AXV2^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",56,0)
SERVC ; Service connected indicator
"RTN","DGPT501",57,0)
 S DGPTERC=0 D SRVC^DGPT50MS I DGPTERC D ERR G:DGPTEDFL EXIT
"RTN","DGPT501",58,0)
GOOD ;
"RTN","DGPT501",59,0)
 W:'$D(ERROR) "."
"RTN","DGPT501",60,0)
EXIT ;
"RTN","DGPT501",61,0)
 K DGPTMD1,DGPTMD2,DGPTMD3,DGPTMD4,DGPTMD5,DGPTMDT,DGPTMDTS,DGPTMLC,DGPTMLD,DGPTMLR,DGPTMPD,DGPTMSC,DGPTMSI,DGPTMSR,DGPTMXX,DGPTSTR,DGPTS,DGPTSP1,DGPTSP2
"RTN","DGPT501",62,0)
 K DGPTMLG,DGPTMSU,DGPTMDG,DGPTMXIV,DGPTMXV1,DGPTMXV2,DGPT50SR,DGPTMBS
"RTN","DGPT501",63,0)
 Q
"RTN","DGPT501",64,0)
ERR ;
"RTN","DGPT501",65,0)
 D WRTERR^DGPTAE(DGPTERC,NODE,SEQ)
"RTN","DGPT501",66,0)
 S ERROR=1
"RTN","DGPT501",67,0)
 Q
"VER")
8.0^22
"^DD",41.1,41.1,8,0)
WARD^R*P42'^DIC(42,^0;8^S DIC("S")="I $S($D(^(""I"")):^(""I"")="""",1:1)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",41.1,41.1,8,1,0)
^.1^^-1
"^DD",41.1,41.1,8,1,1,0)
41.1^ARSV
"^DD",41.1,41.1,8,1,1,1)
S ^DGS(41.1,"ARSV",$E(X,1,30),DA)=""
"^DD",41.1,41.1,8,1,1,2)
K ^DGS(41.1,"ARSV",$E(X,1,30),DA)
"^DD",41.1,41.1,8,1,2,0)
^^TRIGGER^41.1^12
"^DD",41.1,41.1,8,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGS(41.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,12),X=X S DIU=X K Y X ^DD(41.1,8,1,2,1.1) X ^DD(41.1,8,1,2,1.4)
"^DD",41.1,41.1,8,1,2,1.1)
S X=DIV S I(0,0)=$S($D(D0):D0,1:""),D0=DIV S:'$D(^DIC(42,+D0,0)) D0=-1 S I(100,0)=$S($D(D0):D0,1:""),Y(101)=X,D0=DIU S:'$D(^DG(40.8,+D0,0)) D0=-1 S X=$S('$D(D0):"",D0<0:"",1:D0) S D0=I(0,0)
"^DD",41.1,41.1,8,1,2,1.4)
S DIH=$S($D(^DGS(41.1,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,12)=DIV,DIH=41.1,DIG=12 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",41.1,41.1,8,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DGS(41.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,12),X=X S DIU=X K Y S X="" X ^DD(41.1,8,1,2,2.4)
"^DD",41.1,41.1,8,1,2,2.4)
S DIH=$S($D(^DGS(41.1,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,12)=DIV,DIH=41.1,DIG=12 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",41.1,41.1,8,1,2,"CREATE VALUE")
WARD:DIVISION:NUMBER
"^DD",41.1,41.1,8,1,2,"DELETE VALUE")
@
"^DD",41.1,41.1,8,1,2,"DT")
2991102
"^DD",41.1,41.1,8,1,2,"FIELD")
DIVISION
"^DD",41.1,41.1,8,5,1,0)
41.1^10^1
"^DD",41.1,41.1,8,12)
Only select active wards.
"^DD",41.1,41.1,8,12.1)
S DIC("S")="I $S($D(^(""I"")):^(""I"")="""",1:1)"
"^DD",41.1,41.1,8,21,0)
^.001^1^1^3030805^^
"^DD",41.1,41.1,8,21,1,0)
Enter the name of the ward this patient will be admitted to.
"^DD",41.1,41.1,8,"DT")
2991102
"^DD",41.1,41.1,10,0)
WARD OR TREATING SPECIALTY^RS^W:WARD;T:TREATING SPECIALTY;^0;10^Q
"^DD",41.1,41.1,10,1,0)
^.1^^-1
"^DD",41.1,41.1,10,1,1,0)
^^TRIGGER^41.1^8
"^DD",41.1,41.1,10,1,1,1)
X ^DD(41.1,10,1,1,1.3) I X S X=DIV S Y(1)=$S($D(^DGS(41.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X="" X ^DD(41.1,10,1,1,1.4)
"^DD",41.1,41.1,10,1,1,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$S($D(^DD(41.1,10,0)):$P(^(0),U,3),1:"") S X=$P($P(Y(1),$C(59)_Y(0)_":",2),$C(59),1)'="WARD"
"^DD",41.1,41.1,10,1,1,1.4)
S DIH=$S($D(^DGS(41.1,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,8)=DIV,DIH=41.1,DIG=8 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",41.1,41.1,10,1,1,2)
Q
"^DD",41.1,41.1,10,1,1,"CREATE CONDITION")
WARD OR TREATING SPECIALTY'="WARD"
"^DD",41.1,41.1,10,1,1,"CREATE VALUE")
@
"^DD",41.1,41.1,10,1,1,"DELETE VALUE")
NO EFFECT
"^DD",41.1,41.1,10,1,1,"DT")
3000417
"^DD",41.1,41.1,10,1,1,"FIELD")
WARD
"^DD",41.1,41.1,10,1,2,0)
^^TRIGGER^41.1^9
"^DD",41.1,41.1,10,1,2,1)
X ^DD(41.1,10,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^DGS(41.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,9),X=X S DIU=X K Y S X="" X ^DD(41.1,10,1,2,1.4)
"^DD",41.1,41.1,10,1,2,1.3)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S Y(1)=$C(59)_$S($D(^DD(41.1,10,0)):$P(^(0),U,3),1:"") S X=$P($P(Y(1),$C(59)_Y(0)_":",2),$C(59),1)'="TREATING SPECIALTY"
"^DD",41.1,41.1,10,1,2,1.4)
S DIH=$S($D(^DGS(41.1,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,9)=DIV,DIH=41.1,DIG=9 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",41.1,41.1,10,1,2,2)
Q
"^DD",41.1,41.1,10,1,2,"CREATE CONDITION")
WARD OR TREATING SPECIALTY'="TREATING SPECIALTY"
"^DD",41.1,41.1,10,1,2,"CREATE VALUE")
@
"^DD",41.1,41.1,10,1,2,"DELETE VALUE")
NO EFFECT
"^DD",41.1,41.1,10,1,2,"DT")
3000417
"^DD",41.1,41.1,10,1,2,"FIELD")
TREATING SPECIALTY
"^DD",41.1,41.1,10,21,0)
^^3^3^2911222^
"^DD",41.1,41.1,10,21,1,0)
Respond W if this patient is being scheduled for an admission to a
"^DD",41.1,41.1,10,21,2,0)
particular ward or T if the sheduled admission is for a particular
"^DD",41.1,41.1,10,21,3,0)
treating specialty.
"^DD",41.1,41.1,10,"DT")
3000417
**END**
**END**
