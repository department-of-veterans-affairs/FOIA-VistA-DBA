Released DVBA*2.7*37 SEQ #37
Extracted from mail message
**KIDS**:DVBA*2.7*37^

**INSTALL NAME**
DVBA*2.7*37
"BLD",3625,0)
DVBA*2.7*37^AUTOMATED MED INFO EXCHANGE^0^3011003^y
"BLD",3625,4,0)
^9.64PA^^
"BLD",3625,"KRN",0)
^9.67PA^19^17
"BLD",3625,"KRN",.4,0)
.4
"BLD",3625,"KRN",.401,0)
.401
"BLD",3625,"KRN",.402,0)
.402
"BLD",3625,"KRN",.403,0)
.403
"BLD",3625,"KRN",.5,0)
.5
"BLD",3625,"KRN",.84,0)
.84
"BLD",3625,"KRN",3.6,0)
3.6
"BLD",3625,"KRN",3.8,0)
3.8
"BLD",3625,"KRN",9.2,0)
9.2
"BLD",3625,"KRN",9.8,0)
9.8
"BLD",3625,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",3625,"KRN",9.8,"NM",1,0)
DVBAB1^^0^B39938858
"BLD",3625,"KRN",9.8,"NM","B","DVBAB1",1)

"BLD",3625,"KRN",19,0)
19
"BLD",3625,"KRN",19.1,0)
19.1
"BLD",3625,"KRN",101,0)
101
"BLD",3625,"KRN",409.61,0)
409.61
"BLD",3625,"KRN",771,0)
771
"BLD",3625,"KRN",870,0)
870
"BLD",3625,"KRN",8994,0)
8994
"BLD",3625,"KRN",8994,"NM",0)
^9.68A^1^1
"BLD",3625,"KRN",8994,"NM",1,0)
DVBAB APPOINTMENT LIST^^0
"BLD",3625,"KRN",8994,"NM","B","DVBAB APPOINTMENT LIST",1)

"BLD",3625,"KRN","B",.4,.4)

"BLD",3625,"KRN","B",.401,.401)

"BLD",3625,"KRN","B",.402,.402)

"BLD",3625,"KRN","B",.403,.403)

"BLD",3625,"KRN","B",.5,.5)

"BLD",3625,"KRN","B",.84,.84)

"BLD",3625,"KRN","B",3.6,3.6)

"BLD",3625,"KRN","B",3.8,3.8)

"BLD",3625,"KRN","B",9.2,9.2)

"BLD",3625,"KRN","B",9.8,9.8)

"BLD",3625,"KRN","B",19,19)

"BLD",3625,"KRN","B",19.1,19.1)

"BLD",3625,"KRN","B",101,101)

"BLD",3625,"KRN","B",409.61,409.61)

"BLD",3625,"KRN","B",771,771)

"BLD",3625,"KRN","B",870,870)

"BLD",3625,"KRN","B",8994,8994)

"BLD",3625,"QUES",0)
^9.62^^
"BLD",3625,"REQB",0)
^9.611^^
"KRN",8994,794,-1)
0^1
"KRN",8994,794,0)
DVBAB APPOINTMENT LIST^DPA^DVBAB1^4^^^^1
"KRN",8994,794,1,0)
^8994.01^1^1^3010928^^^
"KRN",8994,794,1,1,0)
Returns a list of past, future or all appointments.
"KRN",8994,794,2,0)
^8994.02A^2^2
"KRN",8994,794,2,1,0)
VAL1^1^10^1
"KRN",8994,794,2,1,1,0)
^^1^1^3000218^
"KRN",8994,794,2,1,1,1,0)
This is the DFN - the ien for the patient selected
"KRN",8994,794,2,2,0)
VAL2^1^1^1
"KRN",8994,794,2,2,1,0)
^8994.021^2^2^3010928^^^
"KRN",8994,794,2,2,1,1,0)
This is CHOICE - valid input is A (for All appointments), F (for Future
"KRN",8994,794,2,2,1,2,0)
Appointments, or P (for Past Appointments).
"KRN",8994,794,2,"B","VAL1",1)

"KRN",8994,794,2,"B","VAL2",2)

"KRN",8994,794,3,0)
^8994.03^1^1^3010928^^^
"KRN",8994,794,3,1,0)
Returns LIST of appointments for the patient based on value of CHOICE.
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"PKG",223,-1)
1^1
"PKG",223,0)
AUTOMATED MED INFO EXCHANGE^DVBA^The entire AMIE package 7131/2507.
"PKG",223,20,0)
^9.402P^^
"PKG",223,22,0)
^9.49I^1^1
"PKG",223,22,1,0)
2.7^2950410^2950508
"PKG",223,22,1,"PAH",1,0)
37^3011003
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DVBAB1")
0^1^B39938858
"RTN","DVBAB1",1,0)
DVBAB1 ;ALB/SPH - CAPRI UTILITIES ;01/01/00
"RTN","DVBAB1",2,0)
 ;;2.7;AMIE;**35,37**;Apr 10, 1995
"RTN","DVBAB1",3,0)
 ;
"RTN","DVBAB1",4,0)
VERSION(ZMSG) ;
"RTN","DVBAB1",5,0)
 ; Must have a letter at the end of the Version for Delphi
"RTN","DVBAB1",6,0)
 ; compatability
"RTN","DVBAB1",7,0)
 ; 1st piece is version description
"RTN","DVBAB1",8,0)
 ; 2nd piece can be YESOLD or NOOLD
"RTN","DVBAB1",9,0)
 ; YESOLD = Allow old GUI to run with new KID
"RTN","DVBAB1",10,0)
 ; NOOLD = Do not allow old GUI to run with newer version
"RTN","DVBAB1",11,0)
 S ZMSG="CAPRI GUI V2.7*35*18*H^NOOLD"
"RTN","DVBAB1",12,0)
 Q
"RTN","DVBAB1",13,0)
 ;
"RTN","DVBAB1",14,0)
DIVISION(Y) ; Returns Name for an Institution
"RTN","DVBAB1",15,0)
 N DVBARR,DVBERR
"RTN","DVBAB1",16,0)
 S Y=""
"RTN","DVBAB1",17,0)
 Q:$G(DUZ(2))=""
"RTN","DVBAB1",18,0)
 D GETS^DIQ(4,DUZ(2)_",0",".01","I","DVBARR","DVBERR")
"RTN","DVBAB1",19,0)
 Q:$D(DVBERR)
"RTN","DVBAB1",20,0)
 S Y=$G(DVBARR(4,DUZ(2)_",0,",.01,"I"))
"RTN","DVBAB1",21,0)
 Q
"RTN","DVBAB1",22,0)
 ;
"RTN","DVBAB1",23,0)
DT(Y,X1,X2)  ; Returns date X1 minus X2 days
"RTN","DVBAB1",24,0)
 ; change the '00:00' that could be passed so Fileman doesn't reject
"RTN","DVBAB1",25,0)
 ;C^%DTC(X1,X2)
"RTN","DVBAB1",26,0)
 ;S %DT=$G(%DT,"TS") D ^%DT K %DT
"RTN","DVBAB1",27,0)
 ;K %DT,X1,X2
"RTN","DVBAB1",28,0)
 ;Q
"RTN","DVBAB1",29,0)
DPA(LIST,DFN,CHOICE)       ;Display Patient Appointments
"RTN","DVBAB1",30,0)
 N DVBABCNT,CKCHOICE
"RTN","DVBAB1",31,0)
 S LIST="",DVBABCNT=1,CKCHOICE="A,F,P",DFN=$G(DFN),CHOICE=$G(CHOICE) K ^TMP("DVBAAPPT",$J)
"RTN","DVBAB1",32,0)
 I DFN="" S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="MISSING PATIENT NAME",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ)) Q
"RTN","DVBAB1",33,0)
 I CHOICE="" S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="MISSING ALL, PAST, OR FUTURE",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ)) Q
"RTN","DVBAB1",34,0)
 I CKCHOICE'[CHOICE S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="INVALID SELECTION",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ)) Q
"RTN","DVBAB1",35,0)
 I CHOICE["A" D
"RTN","DVBAB1",36,0)
 .S SDT=0
"RTN","DVBAB1",37,0)
 .S X="T+730" D ^%DT
"RTN","DVBAB1",38,0)
 .I Y<0 S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="ERROR IN CALCULATING ENDING DATE RANGE",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ))
"RTN","DVBAB1",39,0)
 .S EDT=Y+.9
"RTN","DVBAB1",40,0)
 I CHOICE["F" D
"RTN","DVBAB1",41,0)
 .S X="T+1" D ^%DT
"RTN","DVBAB1",42,0)
 .I Y<0 S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="ERROR IN CALCULATING START DATE RANGE",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ))
"RTN","DVBAB1",43,0)
 .S SDT=Y
"RTN","DVBAB1",44,0)
 .K X,Y
"RTN","DVBAB1",45,0)
 .S X="T+730" D ^%DT
"RTN","DVBAB1",46,0)
 .I Y<0 S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="ERROR IN CALCULATING ENDING DATE RANGE",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ))
"RTN","DVBAB1",47,0)
 .S EDT=Y+.9
"RTN","DVBAB1",48,0)
 I CHOICE["P" D
"RTN","DVBAB1",49,0)
 .S X="T" D ^%DT
"RTN","DVBAB1",50,0)
 .I Y<0 S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="ERROR IN CALCULATING ENDING DATE RANGE",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ))
"RTN","DVBAB1",51,0)
 .S EDT=Y+.9
"RTN","DVBAB1",52,0)
 .K X,Y
"RTN","DVBAB1",53,0)
 .S SDT=0
"RTN","DVBAB1",54,0)
 Q:LIST["ERROR"
"RTN","DVBAB1",55,0)
 I $O(^DPT(DFN,"S",SDT))'>0 S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)="NO APPOINTMENTS FOUND FOR YOUR DATE RANGE",LIST=$NA(^TMP("DVBAAPPT",$J,DUZ)) Q
"RTN","DVBAB1",56,0)
 F  S SDT=$O(^DPT(DFN,"S",SDT)) Q:'SDT!(SDT>EDT)  D
"RTN","DVBAB1",57,0)
 .S CLN=$P(^DPT(DFN,"S",SDT,0),"^")
"RTN","DVBAB1",58,0)
 .Q:'$D(^SC(CLN,0))
"RTN","DVBAB1",59,0)
 .S CLN=$P(^SC(CLN,0),"^")
"RTN","DVBAB1",60,0)
 .S ZZ=$L(CLN)
"RTN","DVBAB1",61,0)
 .I ZZ<31 D
"RTN","DVBAB1",62,0)
 ..F ZZZ=ZZ:1:30 S CLN=CLN_" "
"RTN","DVBAB1",63,0)
 .S Y=SDT X ^DD("DD")
"RTN","DVBAB1",64,0)
 .S ZZ2=$L(Y)
"RTN","DVBAB1",65,0)
 .I ZZ2<21 D
"RTN","DVBAB1",66,0)
 ..F ZZZ2=ZZ2:1:20 S Y=Y_" "
"RTN","DVBAB1",67,0)
 .S STATUS=$P(^DPT(DFN,"S",SDT,0),"^",2)
"RTN","DVBAB1",68,0)
 .I STATUS'="" D
"RTN","DVBAB1",69,0)
 ..I STATUS="N" S STATUS="NO-SHOW"
"RTN","DVBAB1",70,0)
 ..I STATUS="C" S STATUS="CANCELLED BY CLINIC"
"RTN","DVBAB1",71,0)
 ..I STATUS="CA" S STATUS="CANCELLED BY CLINIC & AUTO RE-BOOK"
"RTN","DVBAB1",72,0)
 ..I STATUS="NA" S STATUS="NO-SHOW & AUTO-REBOOK"
"RTN","DVBAB1",73,0)
 ..I STATUS="I" S STATUS="INPATIENT APPOINTMENT"
"RTN","DVBAB1",74,0)
 ..I STATUS="PC" S STATUS="CANCELLED BY PATIENT"
"RTN","DVBAB1",75,0)
 ..I STATUS="PCA" S STATUS="CANCELLED BY PATIENT & AUTO RE-BOOK"
"RTN","DVBAB1",76,0)
 ..I STATUS="NT" S STATUS="NO ACTION TAKEN"
"RTN","DVBAB1",77,0)
 .S ^TMP("DVBAAPPT",$J,DUZ,DVBABCNT)=CLN_"  "_Y_" "_STATUS,DVBABCNT=DVBABCNT+1
"RTN","DVBAB1",78,0)
 .S LIST=$NA(^TMP("DVBAAPPT",$J,DUZ))
"RTN","DVBAB1",79,0)
 K DFN,X,%DT,CLN,CHOICE,Y,SDT,EDT
"RTN","DVBAB1",80,0)
 Q
"RTN","DVBAB1",81,0)
DTTM(Y) ;
"RTN","DVBAB1",82,0)
 S Y=$$HTE^XLFDT($H,"P")
"RTN","DVBAB1",83,0)
 Q
"RTN","DVBAB1",84,0)
CHKCRED(Y) ;KLB
"RTN","DVBAB1",85,0)
 S Y="[OK]"
"RTN","DVBAB1",86,0)
 I '$D(DUZ(2)) S Y="Your division number is missing." Q
"RTN","DVBAB1",87,0)
 I $D(DUZ)#2=0 S Y="Your user number is invalid." Q
"RTN","DVBAB1",88,0)
 I +DUZ(2)<1 S Y="Invalid division." Q
"RTN","DVBAB1",89,0)
 Q
"RTN","DVBAB1",90,0)
PTINQ(REF,DFN) ; Return formatted pt inquiry report
"RTN","DVBAB1",91,0)
 K ^TMP("ORDATA",$J,1)
"RTN","DVBAB1",92,0)
 D DGINQ^ORCXPND1(DFN)
"RTN","DVBAB1",93,0)
 S REF=$NA(^TMP("ORDATA",$J,1))
"RTN","DVBAB1",94,0)
 K DFN
"RTN","DVBAB1",95,0)
 Q
"RTN","DVBAB1",96,0)
LABLIST(Y) ; Returns list of LAB TEST NAMES
"RTN","DVBAB1",97,0)
 N DVBABCNT,DVBABIEN
"RTN","DVBAB1",98,0)
 S DVBABCNT=0,DVBABIEN=0
"RTN","DVBAB1",99,0)
 F  S DVBABIEN=$O(^LAB(60,DVBABIEN)) Q:'DVBABIEN  D
"RTN","DVBAB1",100,0)
 .S DVBABLNM=$P($G(^LAB(60,DVBABIEN,0)),"^",1)
"RTN","DVBAB1",101,0)
 .S ^TMP("DVBALAB1",DUZ,DVBABCNT)=DVBABLNM_"^"_DVBABIEN_$C(13),DVBABCNT=DVBABCNT+1
"RTN","DVBAB1",102,0)
 S Y=$NA(^TMP("DVBALAB1",DUZ))
"RTN","DVBAB1",103,0)
 K DVBABCNT,DVBABLNM,DVBABIEN
"RTN","DVBAB1",104,0)
 Q
"RTN","DVBAB1",105,0)
 ;
"RTN","DVBAB1",106,0)
INSTLIST(Y) ; Returns full list of Institutions
"RTN","DVBAB1",107,0)
 N DVBABCNT,DVBABIEN,DVBABNM,DVBABSTN,DVBABST,DVBABDS,DVBARR,DVBERR
"RTN","DVBAB1",108,0)
 K Y,^TMP("DVBAINST",DUZ)
"RTN","DVBAB1",109,0)
 S (DVBABCNT,DVBABIEN)=0
"RTN","DVBAB1",110,0)
 F  S DVBABIEN=$O(^DIC(4,DVBABIEN)) Q:'DVBABIEN  D 
"RTN","DVBAB1",111,0)
 . K DVBARR,DVBERR
"RTN","DVBAB1",112,0)
 . D GETS^DIQ(4,DVBABIEN_",0",".01:.02:.03","I","DVBARR","DVBERR")
"RTN","DVBAB1",113,0)
 . Q:$D(DVBERR)
"RTN","DVBAB1",114,0)
 . S DVBABNM=$G(DVBARR(4,DVBABIEN_",0,",.01,"I"))
"RTN","DVBAB1",115,0)
 . Q:DVBABNM=""
"RTN","DVBAB1",116,0)
 . S DVBABSTN=$G(DVBARR(4,DVBABIEN_",0,",.02,"I"))
"RTN","DVBAB1",117,0)
 . Q:DVBABSTN=""
"RTN","DVBAB1",118,0)
 . S DVBABDS=$G(DVBARR(4,DVBABIEN_",0,",.03,"I"))
"RTN","DVBAB1",119,0)
 . K DVBARR,DVBERR
"RTN","DVBAB1",120,0)
 . D GETS^DIQ(5,DVBABSTN_",0",.01,"I","DVBARR","DVBERR")
"RTN","DVBAB1",121,0)
 . Q:$D(DVBERR)
"RTN","DVBAB1",122,0)
 . S DVBABST=$G(DVBARR(5,DVBABSTN_",0,",.01,"I"))
"RTN","DVBAB1",123,0)
 . S ^TMP("DVBAINST",DUZ,DVBABCNT)=DVBABNM_"^"_DVBABST_"^"_DVBABDS_"^"_DVBABIEN_$C(13)
"RTN","DVBAB1",124,0)
 . S DVBABCNT=DVBABCNT+1
"RTN","DVBAB1",125,0)
 S Y=$NA(^TMP("DVBAINST",DUZ))
"RTN","DVBAB1",126,0)
 Q
"RTN","DVBAB1",127,0)
 ;
"RTN","DVBAB1",128,0)
INCEXAM(ZMSG) ;Increased exam # in file  and passes back the # to user
"RTN","DVBAB1",129,0)
 S ZMSG=+$G(^DVB(396.1,1,5))
"RTN","DVBAB1",130,0)
 S ZMSG=ZMSG+1
"RTN","DVBAB1",131,0)
 S ^DVB(396.1,1,5)=ZMSG
"RTN","DVBAB1",132,0)
 Q
"RTN","DVBAB1",133,0)
 ;
"RTN","DVBAB1",134,0)
MSG(ERR,DUZ,XMSUB,XMTEXT,MGN) ;Generate mail message;KLB
"RTN","DVBAB1",135,0)
 S ERR=""
"RTN","DVBAB1",136,0)
 K ^TMP($J,"AMIE")
"RTN","DVBAB1",137,0)
 I '$D(DUZ) S ERR="MISSING DUZ" Q
"RTN","DVBAB1",138,0)
 I '$D(XMSUB) S ERR="MISSING SUBJECT" Q
"RTN","DVBAB1",139,0)
 I '$D(XMTEXT) S ERR="MISSING TEXT" Q
"RTN","DVBAB1",140,0)
 I '$D(MGN) S ERR="MISSING MAIL GROUP NAME" Q
"RTN","DVBAB1",141,0)
 S XMDUZ=DUZ
"RTN","DVBAB1",142,0)
 S J=0
"RTN","DVBAB1",143,0)
 F  S J=$O(XWBS1(J)) Q:'J  S ^TMP($J,"AMIE",J)=$G(XWBS1(J))
"RTN","DVBAB1",144,0)
 S XMTEXT="^TMP($J,""AMIE"","
"RTN","DVBAB1",145,0)
 S DIC="^XMB(3.8,",DIC(0)="QM",X=MGN D ^DIC
"RTN","DVBAB1",146,0)
 S MG=+Y
"RTN","DVBAB1",147,0)
 I +Y<0 S ERR="INVALID MAIL GROUP NAME" Q
"RTN","DVBAB1",148,0)
 S ZZ=0,ZZ1=0
"RTN","DVBAB1",149,0)
 F  S ZZ=$O(^XMB(3.8,MG,1,"B",ZZ)) Q:'ZZ  D
"RTN","DVBAB1",150,0)
 .F  S ZZ1=$O(^XMB(3.8,MG,1,"B",ZZ,ZZ1)) Q:'ZZ1  S XMY(ZZ)=""
"RTN","DVBAB1",151,0)
 S XMY(XMDUZ)=""
"RTN","DVBAB1",152,0)
 D ^XMD
"RTN","DVBAB1",153,0)
 I $D(XMMG) S ERR=XMMG
"RTN","DVBAB1",154,0)
 I '$D(XMMG) S ERR="MESSAGE SENT"
"RTN","DVBAB1",155,0)
 K XMSUB,XMTEXT,MGN,DIC,DIC(0),ZZ,XMY,XWBS1,J,ZZ1,MG,^TMP($J,"AMIE"),XMMG,Y,XMDUZ
"RTN","DVBAB1",156,0)
 Q
"RTN","DVBAB1",157,0)
FINDEXAM(ZMSG,ZIEN) ;Returns list of exams in 396.4 that are linked to ZIEN in 396.3
"RTN","DVBAB1",158,0)
 N DVBABCNT,DVBABIEN
"RTN","DVBAB1",159,0)
 S DVBABCNT=0,DVBABIEN=0
"RTN","DVBAB1",160,0)
 F  S DVBABIEN=$O(^DVB(396.4,"C",ZIEN,DVBABIEN)) Q:'DVBABIEN  D
"RTN","DVBAB1",161,0)
 .S DVBABD1=$P($G(^DVB(396.4,DVBABIEN,0)),"^",2)
"RTN","DVBAB1",162,0)
 .S DVBABD2=$P($G(^DVB(396.6,+$P($G(^DVB(396.4,DVBABIEN,0)),"^",3),0)),"^",1)  ;Name of Exam
"RTN","DVBAB1",163,0)
 .S DVBABD3=$P($G(^DVB(396.4,DVBABIEN,0)),"^",4)
"RTN","DVBAB1",164,0)
 .I DVBABD3="O" S DVBABD3="[OPEN]"
"RTN","DVBAB1",165,0)
 .I DVBABD3="C" S DVBABD3="[COMPLETE]"
"RTN","DVBAB1",166,0)
 .I DVBABD3="X" S DVBABD3="[CANCELED BY MAS]"
"RTN","DVBAB1",167,0)
 .I DVBABD3="RX" S DVBABD3="[CANCELED BY RO]"
"RTN","DVBAB1",168,0)
 .I DVBABD3="T" S DVBABD3="[TRANSFERRED OUT]"
"RTN","DVBAB1",169,0)
 .I ZIEN=DVBABD1 D
"RTN","DVBAB1",170,0)
 ..S ZMSG(DVBABCNT)=DVBABIEN_"^"_DVBABD2_" "_DVBABD3
"RTN","DVBAB1",171,0)
 ..S DVBABCNT=DVBABCNT+1
"RTN","DVBAB1",172,0)
 K DVBABCNT,DVBABIEN,ZIEN,DVBABD1,DVBABD2,DVBABD3
"RTN","DVBAB1",173,0)
 Q
"VER")
8.0^22
**END**
**END**
