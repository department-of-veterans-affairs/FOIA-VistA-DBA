
=============================================================================
Run Date: DEC 17, 2004                     Designation: LR*5.2*286
Package : LR - LAB SERVICE                    Priority: Mandatory
Version : 5.2       SEQ #245                    Status: Released
                  Compliance Date: JAN 17, 2005
=============================================================================

Associated patches: (v)LR*5.2*121  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*153  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*187  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*201  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*202  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*220  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*221  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*222  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*230  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*232  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*256  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*261  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*263  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*269  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*271  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*282  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*283  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*285  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*287  <<= must be installed BEFORE `LR*5.2*286'
                    (v)LR*5.2*312  <<= must be installed BEFORE `LR*5.2*286'

Subject: VA/DOD LAB INTEROPERABILITY

Category: 
  - Enhancement (Mandatory)
  - Data Dictionary
  - Routine
  - Informational

Description:
============

 VISTA Laboratory Package patch LR*5.2*286 contains changes to software
 controlled by VHA DIRECTIVE 99-053, titled VISTA BLOOD BANK SOFTWARE
 VERSION 5.2.  Change includes:
    The addition of the "USE FOR REFERENCE TESTING" field (#13) to the
    "SITE/SPECIMEN SUB-FIELD" (#60.01) of the LABORATORY TEST file (#60).
    The addition of the "USE FOR REFERENCE TESTING" field to the "LR ATOMIC
     TESTS" Input Template.
  
 The above change has been reviewed by the VISTA Blood Bank Developer and
 found to have no impact on the VISTA BLOOD BANK SOFTWARE version 5.2
 control functions.
  
 RISK ANALYSIS:   Changes made by patch LR*5.2*286 have no effect on Blood
 Bank software functionality, therefore RISK is none.
  
 EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS:  Patch LR*5.2*286 does not
 alter or modify any software design safeguards or safety critical elements
 functions.
  
 POTENTIAL IMPACT ON SITES:  This patch contains changes to a Data
 Dictionary identified in Veterans Health Administration (VHA) Directive
 99-053. The changes have no effect in Blood Bank functionality or medical
 device control functions. There is no adverse potential to sites.
  
 VALIDATION REQUIREMENTS BY OPTION:  There are no required validation
 scenarios to be completed by sites after installing LR*5.2*286.
  
 ========================================
  
 Patch LR*5.2*286 VA/DOD LAB INTEROPERABILITY will be distributed and
 installed with patch LA*5.2*64 VA/DOD LAB INTEROPERABILITY
  
 This patch adds support for sending/receiving Laboratory Electronic
 Data Interchange (LEDI) orders/results with Department of Defense (DoD)
 facilities.
  
 Laboratory result verification has been enhanced to allow the designation
 of a performing laboratory and the use of the performing laboratory's
 units, normals, and normalcy status in results reporting.
  
 1. User during the verification process is able to specify the performing
 laboratory. The performing laboratory is selected from the list of
 available entries in the site's INSTITUTION file (#4). The selection of
 entries is screened as follows:
    a. User can select the division they are logged on.
    b. User can select an institution that is configured in the LAB
       SHIPPING CONFIGURATION file (#62.9) as a host facility with their
       division as the collecting facility.
  
 2. During acceptance and verification of results received from a reference
 laboratory via an HL7 interface (LEDI), the performing laboratory, results,
 units, normals and normalcy status contained in the HL7 message are stored
 "as is".
  
 3. Receipt of amended reports from a reference laboratory will generate a
 MailMan bulletin containing the particulars of the amended report. This
 bulletin is sent to the members of the mail group specified for
 "New Result" alerts in LA7 MESSAGE PARAMETER file (#62.48) for the 
 interface.
  
 4. Amended reports received via a LEDI HL7 interface can be processed
 via the Enter/verify/modify data (manual) option [LRENTER].
  
 5. Users using the Enter/verify/modify data (manual) option [LRENTER] to
 enter results manually from a reference laboratory can use the units and
 normals specified in LABORATORY TEST file (#60) by configuring USE FOR
 REFERENCE TESTING field (#13) within the SITE/SPECIMEN subfile (#100).
 If this field is not enabled for reference laboratory result data entry,
 then the user is prompted for units, normals, high and low reference ranges
 to store with the results. The Edit atomic tests option [LRDIEATOMIC]
 allows Labortory Information Manager (LIM) to designate this functionality
 for affected tests.
  
 6. NOIS DEN-1299-52099, NYH-0700-11942, PHI-0803-21507, TAM-0400-31033, and
 WPB-0900-32221 reported the defect of normalcy status (low/high/critical
 low/critical high) being incorrectly evaluated when the test result is
 zero (0). Evaluation of normalcy status will properly deal with test
 results of zero (0).
  
 7. Changing normalcy status and units will trigger the generation of audit
 trail comments.
  
 8. During verification, the ordering provider's phone and pager information
 is displayed.
  
 9. Display of lab results in the Computerized Patient Record System
 Graphical User Interface (CPRS GUI) and Laboratory Interim Reports has
 been modified to display units and normals associated with results at time
 of verification. Results that are derived from a Set of Codes will be
 reported using the external form of the code.
  
 10. Display of performing laboratory has been added to CPRS GUI display of
 results.
  
 11. NOIS DAY-0303-40775 reported a defect in display of lab results with
 embedded spaces. When lab results contained embedded spaces these spaces
 were being removed prior to the display of the lab result. The removal of
 theses spaces resulted in corruption of the result. Routines LR7OB63 and
 LR7OR2 have been corrected to trim leading and trailing spaces but leave
 embedded spaces.
  
 12. Enter/verify data (auto instrument) [LRVR] and Enter/verify/modify
 data (manual) [LRENTER] options will display patient information from
 PAT. INFO. field (#.091) in LAB DATA file (#63) during result verification.
 (E3R #13408)
  
 13. Alignment of test results during verification process has been adjusted
 to avoid display of previous and current test results together. Results
 will be displayed right-justified under the date/time of each specimen.
  
 14. NOIS ALB-0100-50284, FAV-1103-70892 reported a failure of UID creation
 and storage when creating a non-daily accession that is in common with
 another accession area. The failure occurs on the creation of the first
 accession for a given accession area and date. After the first accession
 for an accession date is created and stored in ACCESSION file (#68)
 subsequent accessions have the UID stored properly. Failure was due to
 missing subfile zeroth nodes for the ACCESSION DATE multiple (#68.01) and
 ACCESSION NUMBER multiple (#68.02) of the ACCESSION file (#68) when calling
 FileMan to store the UID. Routine LRWLST1 will now check and set the
 subfile's zeroth nodes before calling FileMan.
  
   FileMan calls have been converted from classic FileMan DIE calls to
 FileMan Database Server calls (DBS). When an error condition is
 encountered during a FileMan DBS call, the Laboratory package will
 generate a mail message with the subject "FileMan DBS call failed during
 accessioning in routine LRWLST1". This message will be sent to the local
 mail group "LMI". It will contain debugging information to assist site
 and National VistA Support in resolving the condition that produced the
 error.
  
 15. NOIS BON-0196-71728 reported a problem with storing the appropriate
 treating specialty associated with an accession. A bad or incorrect
 pointer to FACILITY TREATING SPECIALTY file (#45.7) could be stored in
 the TREATING SPECIALTY (#6.6) field within the ACCESSION NUMBER field
 (#68.02) multiple within the ACCESSION DATE field (#68.01) multiple of
 the ACCESSION file (#68). When a specimen is accessioned for a
 non-inpatient and the user selects an inpatient ordering location the
 software would use the specialty from SPECIALITY file (#42.4) that
 is associated with the WARD LOCATION file (#42) entry linked to the
 HOSPITAL LOCATION file (#44).
  
    Routine LRWLST1 will determine treating specialty based on the
 associated TREATING SPECIALTY field (#9.5) in the HOSPITAL LOCATION file
 (#44) when the patient is not an inpatient. When a patient is an inpatient
 then treating specialty will be determined from the PATIENT file (#2),
 TREATING SPECIALTY field (.103). Treating specialty will only be stored
 in ACCESSION file (#68) when the patient is from PATIENT file (#2).
  
 16. The following defects were identified during the software review as
 part of patch development.
  
   a. Ordering location and ordering provider will not be stored on
 accessions that are related to LAB CONTROL NAME file (#62.3) entries.
  
   b. During accessioning if accession area is locked by another process,
 the message displayed to user was "Accession area is locked by another
 user." Message will now include the name of the accession area that
 the software is waiting on lock.
  
   c. Interim report options and displays will display month portion of
 date/times using the three letter abbreviation instead of the two number
 designation to eliminate potential confusion with day portion of dates.
 Time is displayed using 24 hour time format.
  
   d. Interim report could display the wrong ordering and collecting site
 when the specimen was received from an integrated facility. Report will
 display the correct ordering and collecting site.
  
   e. Referral Patient Multi-purpose Accession option [LR LEDI] was
 prompting the user for CPRS Nature of Order which is not used during
 accessioning of non-PATIENT file (#2) patients. Routine LROW3 is
 modified to only prompt the user for CPRS Nature of Order when
 accessioning a patient from the PATIENT file (#2).
  
   f. Previous test versions of previous LEDI versions may have installed
 two versions of the "D" cross reference in LAB PENDING ORDERS ENTRY file
 (#69.6). The post-install will delete and reindex the "D" cross reference
 on file #69.6.
  
   g. Entering of accession number during lab results verification will
 check for invalid values or numbers out of range (1-999999).
  
 17. Referral Patient Multi-purpose Accession option [LR LEDI] will check
 for pending orders when performing accessioning without a bar code scanner.
 It will display to the user and store order comments that accompanies
 electronic orders with order in LAB ORDER ENTRY file (#69).
  
 18. When using the Enter/verify/modify data (manual) option [LRENTER] to
 amend previously released results user can now enter their verifying
 initials in mixed case.
  
 19. NOIS CHS-0303-40534 reported a defect which prevented results for
 reflex tests added to a LEDI order at the host laboratory being returned
 electronically to the collecting laboratory. Routine LRWLST11 was storing
 the collecting site as both the collecting site and ordering site in the
 order created in LAB ORDER ENTRY file (#69). When a collecting site is a
 member of an integrated facility the collecting site is the site collecting
 the specimen and the ordering site is the primary facility of the
 integrated institution. Reflex test added by the host site would have the
 incorrect ordering site assigned which prevents the LEDI software from
 returning the results of the reflex test to the collecting facility. Defect
 has been corrected to store the correct ordering and collecting sites on
 LEDI accessions.
  
 20. NOIS BRK-0499-10720, MAR-0603-21152 reported a defect during lab
 result verification using option Enter/verify/modify data (manual)
 [LRENTER] which caused the previous patient demographics to be displayed
 when entering results on an accession. If the previous selected accession
 was in an uncollected state, the option was skipping the uncollected
 accession and incrementing the default accession number to the next
 available accession. If the user selects this or another accession, the
 patient demographics of the selected accession were not being displayed.
 Instead, the patient demographics of the uncollected accession were
 displayed. Routine LRVER will now display the patient demographics of the
 currently selected accession.
  
 21. NOIS SFC-1103-60132 reported a defect during display of lab results
 in the CPRS GUI. When a critical flag becomes part of the data for a
 patient in CPRS, the line of data containing the flag becomes split
 after the * following the high or low flag, and the units along with
 the reference range gets bumped to the next line down. Routine LR7OGMP
 increases the space allocated to display this information from 37 to 38
 characters to display units/normals on same line.
  
 22. When displaying results that are a Set of Codes data type, the result
 will be displayed using the external value for the set of codes.
  
 23. NOIS NYH-0700-11942 reported a defect with critical value flag not
 being triggered when entering a value of 0. Value of 0 will be evaluated
 when performing high/low/critical value checks.
  
 24. When verifying results from a reference laboratory using Enter/verify
 data (auto instrument) option [LRVR], any test results that have not
 been verified will be displayed to the user after verification. The display
 will list the test names, results, abnormal flags and units if available.
 This display will list the test(s) as not reviewed. This may indicate that
 additional or reflex testing has been added by the reference laboratory.
 These additional tests may need to be added to the accession to process
 these results.
  
 25. During verification of laboratory results, comments for a previous
 result are displayed along with the previous result when entering
 results manually or by automated instrument for user selected tests
 (E3R #18490). Users can indicate which tests should have previous
 test comments displayed during verification by flagging the test using
 General Lab User Parameters option [LR USER PARAM] located on the
 Information-help menu [LRHELP].
  
 26. NOIS SDC-0904-61304  Reported a defect with the display of text
 results in CPRS when using the Laboratory Results-All Test By Date and
 Laboratory Results-Selected Tests By Date. When a text result was
 displayed that exceeded 10 characters and the test has no units or
 normals specified, the display of the result was corrupted with <spaces>
 inserted into the text. Test results will be displayed without corruption.
 Units, reference ranges, and site codes will be displayed on the following
 line when test results print in area usually reserved for these parameters.
  
 27. NOIS IND-0498-42538 reported a defect in display of test comments during
 lab test result verification when encountering an 'end-of-page' condition.
 All test comments will now be displayed.
  
  
  PATIENT SAFETY ISSUES RESOLVED IN THIS PATCH:
  ============================================
  
  PSI-040260/NOIS HVH-0604-10572 - "Not Performed test Resulted
  - No Alert Generated"
  
 This patch corrects defects in software used to set laboratory tests
 to a Not-Performed (NP) state. The NP state was introduced by patch
 LR*5.2*221 in 1999.  The functionality introduced by this patch replaced
 the "delete-a-test" functionality. Instead of deleting tests, tests are
 now set to a not-performed state.
  
 However, tests in the NP state could still be edited such that the NP
 state is replaced with an actual result. Results entered into NP tests
 were not treated in the same manner as results entered through the normal
 results entry pathways. File updates to ACCESSION file (#68), LAB ORDER
 ENTRY file (#69), and ORDER file (#100) as well as alerts were not
 generated. This situation was documented in NOIS HVH-0604-10572
 - "Not Performed test Resulted - No Alert Generated". This was identified
 as a potential patient safety risk. With concurrence from the Pathology
 & Laboratory Medicine Program Office, the appropriate mechanism for
 handling the situation is to disable editing of NP tests. If the test is
 designated as NP and the user wants to edit the test result, they will
 now have to order the test(s) in a new accession.
  
  
 ASSOCIATED E3R
 --------------
  E3R #13408, ADDING INFECTION WARNING TO PROCESS DATA OPTIONS
  E3R #16060, CORRECT ALIGNMENT PROBLEM
  E3R #17904, LEDI BETWEEN VA AND DOD SITES
  E3R #18490, COMMENTS DISPLAY FORPRVIOUS RESULTS
  
  
 ASSOCIATED NOIS
 ---------------
  ALB-0100-50284
  BRK-0499-10720
  BON-0196-71728
  CHS-0303-40534
  DAY-0303-40775
  DEN-1299-52099
  FAV-1103-70892
  HVH-0604-10572
  IND-0498-42538
  MAR-0603-21152
  NYH-0700-11942
  PHI-0803-21507
  SDC-0904-61304
  SFC-1103-60132
  TAM-0400-31033
  WPB-0900-32221
  
  
 TEST SITES
 ----------
  Albuquerque VAMC - VMS/DSM and VMS/Cache
  Boston HCS - VMS/DSM and VMS/Cache
  El Paso HCS - NT/Cache and VMS/Cache
  Hines VAMC - VMS/DSM and VMS/Cache
  Honolulu VAMC -  NT/Cache
  Manchester VAMC - NT/Cache NT and VMS/Cache
  Milwaukee VAMC - VMS/DSM
  North Chicago VAMC - VMS/DSM
  Salt Lake City VAMC - VMS/DSM
  San Diego VAMC - VMS/DSM and VMS/Cache
  Upstate New York HCS - VMS/DSM and VMS/Cache
  
  
  INSTALLATION FILES:
  ==================
  The following software and documentation files are exported as part of
  this patch:
  
     File Name             Contents                     Retrieval Format
     ---------             --------                     ----------------
  
 LAB_LEDI_III.KID        LA*5.2*64 KIDS build           ASCII
                         LR*5.2*286 KIDS build
  
  
 LAB_LEDI_III_IG.PDF     LABORATORY ELECTRONIC DATA     BINARY
                         INSTALLATION GUIDE
  
 LAB_LEDI_III_IMP_UG.PDF LABORATORY ELECTRONIC DATA     BINARY
                         IMPLEMENTATION AND USER GUIDE
  
  The files listed above may be obtained via FTP.  The preferred method is
  to FTP the files from:
  
     download.vista.med.va.gov
  
  This transmits the files from the first available FTP server.  Sites may
  also elect to retrieve software directly from a specific server as
  follows:
  
     CIO FIELD OFFICE   FTP ADDRESS                 DIRECTORY
     ----------------   -------------------------   --------------------
     Albany             ftp.fo-albany.med.va.gov    [anonymous.software]
     Hines              ftp.fo-hines.med.va.gov     [anonymous.software]
     Salt Lake City     ftp.fo-slc.med.va.gov       [anonymous.software]
  
  
 ROUTINE SUMMARY
 ===============
   The following routines are included in this patch.  The second line
   of each of these routines now looks like:
   <tab> ;;5.2;LAB SERVICE;<patchlist>;Sep 27, 1994
  
                     Checksum       Checksum
    Routine Name     Before Patch   After Patch    Patch List
    ------------     ------------   -----------    ------------
    LR286            N/A            5465218        **286** (Deleted by KIDS)
    LR7OB63          9973912        9132350        **121,187,286**
    LR7OGM           8016197        8279122        **187,220,312,286**
    LR7OGMC          5100174        5463477        **187,230,312,286**
    LR7OGMG          3593445        3973477        **187,230,286**
    LR7OGMP          5548341        6065382        **187,246,282,286**
    LR7OR2           9125008        8919494        **121,187,219,285,286**
    LR7OSUM1         12883059       12868699       **121,187,256,286**
    LR7OSUM6         7911216        5450631        **121,201,187,286**
    LRAFUNC          5202410        5809534        **286**
    LRDIDLE0         5463932        6544739        **140,171,153,286**
    LRDPAREF         5111405        7469302        **153,222,286**
    LRDPAREX         7190033        6456580        **153,286**
    LREVENT          3678954        2907416        **153,286**
    LRFAST           19691126       18799737       **100,121,201,286**
    LRFASTS          6423167        6524547        **30,95,121,271,286**
    LRGP1            3988622        4165501        **112,269,286**
    LROE             14550901       11534796       **100,121,201,221,263,286**
    LRORD            12009917       12806626       **100,121,153,286**
    LRORD1           9848796        9190513        **1,8,121,153,201,286**
    LRORDB           3782224        7231598        **153,222,286**
    LROW3            7497722        6459972        **33,121,286**
    LRRP             11838355       9427993        **195,221,283,286**
    LRRP1            8015031        6556852        **153,221,283,286**
    LRRPU            N/A            3220194        **286**
    LRSTUF1          13209134       11668378       **153,286**
    LRVER            17228890       15441873       **153,286**
    LRVER1           8587449        7330679        **42,153,201,215,239,240,
                                                   263,232,286**
    LRVER3           14311842       13055299       **42,100,121,140,171,153,
                                                   221,286**
    LRVER4           19639169       14489554       **14,42,112,121,140,171,
                                                   153,188,279,283,286**
    LRVER5           14564045       14854455       **42,153,283,286**
    LRVERA           690805         5764794        **153,271,286**
    LRVR             13316120       11130012       **42,153,263,286**
    LRVR1            11269859       11667912       **42,153,221,286**
    LRVR3            10486080       11176919       **42,121,153,286**
    LRVR4            8885642        9645653        **14,42,121,153,221,263,
                                                   279,283,287,286**
    LRVR5            11950773       4666781        **1,42,153,263,283,286**
    LRWLST1          18457202       12664045       **48,65,121,153,261,286**
    LRWLST11         21393713       16883055       **121,128,153,202,286**
  
  List of preceding patches: 187, 202, 222, 230, 232, 256, 261, 269, 271
  282, 283, 285, 287, 312
  Sites should use CHECK^XTSUMBLD to verify checksums.
  
  
 INSTALLATION INSTRUCTIONS
 =========================
  
 See LABORATORY ELECTRONIC DATA INTERCHANGE III (LEDI III) INSTALLATION GUIDE
     LA*5.2*64/LR*5.2*286

Routine Information:
====================

Routine Name:
  - LRDPAREF


Routine Checksum:

Routine Name:
  - LROE


Routine Checksum:

Routine Name:
  - LRRP


Routine Checksum:

Routine Name:
  - LRRPU


Routine Checksum:

Routine Name:
  - LRVER


Routine Checksum:

Routine Name:
  - LRVER3


Routine Checksum:

Routine Name:
  - LRVER4


Routine Checksum:

Routine Name:
  - LRVER5


Routine Checksum:

Routine Name:
  - LRVERA


Routine Checksum:

Routine Name:
  - LRVR


Routine Checksum:

Routine Name:
  - LRVR1


Routine Checksum:

Routine Name:
  - LRVR3


Routine Checksum:

Routine Name:
  - LRVR4


Routine Checksum:

Routine Name:
  - LRVR5


Routine Checksum:

Routine Name:
  - LRWLST1


Routine Checksum:

Routine Name:
  - LRWLST11


Routine Checksum:

Routine Name:
  - LR286


Routine Checksum:

Routine Name:
  - LRRP1


Routine Checksum:

Routine Name:
  - LRDIDLE0


Routine Checksum:

Routine Name:
  - LR7OSUM1


Routine Checksum:

Routine Name:
  - LR7OSUM6


Routine Checksum:

Routine Name:
  - LR7OGMC


Routine Checksum:

Routine Name:
  - LR7OGMG


Routine Checksum:

Routine Name:
  - LR7OR2


Routine Checksum:

Routine Name:
  - LR7OB63


Routine Checksum:

Routine Name:
  - LR7OGMP


Routine Checksum:

Routine Name:
  - LROGM


Routine Checksum:

Routine Name:
  - LRGP1


Routine Checksum:

Routine Name:
  - LRSTUF1


Routine Checksum:

Routine Name:
  - LRORD


Routine Checksum:

Routine Name:
  - LRORDB


Routine Checksum:

Routine Name:
  - LRVER1


Routine Checksum:

Routine Name:
  - LRDPAREX


Routine Checksum:

Routine Name:
  - LRFAST


Routine Checksum:

Routine Name:
  - LRFASTS


Routine Checksum:

Routine Name:
  - LRORD1


Routine Checksum:

Routine Name:
  - LREVENT

  

Routine Checksum:

Routine Name:
  - LRAFUNC


Routine Checksum:

Routine Name:
  - LROW3


Routine Checksum:

=============================================================================
User Information:
Entered By  : STALLING,FRANK                Date Entered  : JUN 12, 2002
Completed By: ELIJAH,VICKEY                 Date Completed: NOV 19, 2004
Released By : LECLAIR,RAY                   Date Released : DEC 17, 2004
=============================================================================


Packman Mail Message:
=====================

No routines included
