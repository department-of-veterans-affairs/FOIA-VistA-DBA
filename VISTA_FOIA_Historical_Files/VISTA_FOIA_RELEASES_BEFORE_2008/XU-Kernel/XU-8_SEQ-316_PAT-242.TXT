$TXT Created by MEIGHAN,MIKE J at NXT.KERNEL.FO-OAKLAND.MED.VA.GOV  (KIDS) on Thursday, 10/30/03 at 08:06
=============================================================================
Run Date: NOV 15, 2005                     Designation: XU*8*242
Package : XU - KERNEL                         Priority: Mandatory
Version : 8       SEQ #316                      Status: Released
                  Compliance Date: DEC 16, 2005
=============================================================================

Associated patches: (v)XU*8*169    <<= must be installed BEFORE `XU*8*242'
                    (v)XU*8*170    <<= must be installed BEFORE `XU*8*242'

Subject: Documenting, Locking, and Scheduling Options

Category: 
  - Routine
  - Data Dictionary

Description:
============

 Patch Tracking #: 36996055, 37014334
 Test Sites: White River VAMC, Clarksburg VAMC, Prescott VAMC, VA Greater
             Los Angeles HCS, and Palo Alto Healthcare System
 Blood Bank Clearance: February 2, 2004
  
 Problem 1: If the user that created a scheduled job leaves or is otherwise
 terminated some jobs will fail to run.  One case is Mailman will not send 
 email from a non-active user.
  
 NOIS: NYH-0400-11069, MAD-0200-41716, WRJ-1299-12874
  
 Fix: We have added a new field, USER TO RUN TASK (#11), to the second page
 of the Schedule/Unschedule Task form that allows a user with the XUMGR key
 to select the actual user that the job will run under.  This is only for
 scheduled jobs, and it is suggested that the "user to run task" be one
 that is always active to prevent having the same problem in the future.
 The task print routine was updated to report if the job has data in the
 USER TO RUN TASK (#11) field.
  
 Problem 2:  It is a SACC requirement that incremental locks be used when
 editing data.  MenuMan has never done this with Edit- type options.
  
 NOIS:  There were none.
  
 Fix:  Incremental locks were added to the routine ^XQ1 for Edit-type 
 options only.
  
 Problem 3:  The Instructions for creating an Edit-type option when using 
 the screen based option editor (OPED) failed to mention that one must set
 the DIC (look up) variable fields in the Option File, as well as the DIE
 (edit) fields because ^DIE first does a ^DIC call to find the file.
  
 NOIS:  There were none. 
  
 Fix: A change was made the MENUMAN QUICK HELP file to explain the 
 issue.
  
  
 File Changes
 1: Modified Data Dictionary of OPTION SCHEDULING FILE (file #19.2) for 
    field #11, USER TO RUN TASK.
  
    19.2,11  USER TO RUN TASK       1.1;1 POINTER TO NEW PERSON FILE (#200)
  
          INPUT TRANSFORM:  S DIC("S")="I $$ACTIVE^XUSER(Y)>0" D ^DIC K DIC
                             S DIC=DIE,X=+Y K:Y<0 X K:'$D(^XUSEC("XUMGR",DU
                            Z)) X
          LAST EDITED:      APR 16, 2003 
          DESCRIPTION:      This field will allow a site to select the user
                            that should run a given scheduled task.  To set
                            this field you must hold the XUMGR key. The
                            user must be an ACTIVE user on the system. This
                            is checked with $$ACTIVE^XUSER() An example
                            would be to have Postmaster run the MailMan
                            background filers.  Or to create a special user
                            to run HL7 background filers.  
  
          SCREEN:           S DIC("S")="I $$ACTIVE^XUSER(Y)>0"
          EXPLANATION:      Only Active users.
          NOTES:            XXXX--CAN'T BE ALTERED EXCEPT BY PROGRAMMER
  
  
 2: Added two new entries to the MENUMAN QUICK HELP (file #19.8) as 
    described in the Fix to Problem 3 above.
  
  
 Routine Summary
 The following routines are included in this patch.  The second line of each
 of these routines now looks like:
  ;;8.0;KERNEL;**[Patch List]**;Jul 10, 1995
  
                  Checksum
 Routine         Old       New      Patch List
 XQ1          12116128  12420822    **1,15,59,67,46,151,170,242**
 XUTMTP       10842367  11245635    **20,86,169,242**
  
 List of preceding patches: 169, 170
 Sites should use CHECK^XTSUMBLD to verify checksums.
  
 =========================================================================
 Installation:
  
 >>>The routine XQ1 is heavily used so the patch should be installed when 
 >>>all users are off the system.
 >>>Do not allow users to log in to the system during installation.
 >>>TaskMan must be put in a wait state.
  
   1.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
       option will load the KIDS package onto your system.
  
   2.  The patch has now been loaded into a Transport global on your
       system. You now need to use KIDS to install the Transport global.
       On the KIDS menu, under the 'Installation' menu, use the following
       options:
  
          Verify Checksums in Transport Global
          Print Transport Global
          Compare Transport Global to Current System
          Backup a Transport Global
  
   3.  Inhibit users from login into the system.
       Get all users off the system.
       Also place TaskMan in a wait state.
       Option: Place TaskMan in a WAIT State
  
  
   4.  Installation will take less than 2 minutes.
 >>>>>   in programmer mode use "D ^XPDKRN" then ***
         Install Package(s)  'XU*8.0*242'
                              ==========
  
       Want KIDS to INHIBIT LOGONs during the install? YES// YES
  
       Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
  
   5.  Remove TaskMan from the wait state.
       Option: Remove TaskMan from WAIT State
  
   6.  Enable user login.
  
 ==========================================================================

Routine Information:
====================
Routine Name: XQ1
Routine Name: XUTMTP

=============================================================================
User Information:
Entered By  : MEIGHAN,MIKE                  Date Entered  : JUN 13, 2002
Completed By: SINGH,GURBIR                  Date Completed: NOV 09, 2005
Released By : TILLIS,LEWIS                  Date Released : NOV 15, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
