
=============================================================================
Run Date: JUN 27, 2003                     Designation: YS*5.01*76
Package : YS - MENTAL HEALTH                  Priority: Mandatory
Version : 5.01        SEQ #66                   Status: Released
                  Compliance Date: JUL 28, 2003
=============================================================================

Associated patches: (v)YS*5.01*38  <<= must be installed BEFORE `YS*5.01*76'
                    (v)YS*5.01*53  <<= must be installed BEFORE `YS*5.01*76'
                    (v)YS*5.01*54  <<= must be installed BEFORE `YS*5.01*76'
                    (v)YS*5.01*67  <<= must be installed BEFORE `YS*5.01*76'
                    (v)YS*5.01*71  <<= must be installed BEFORE `YS*5.01*76'

Subject: Mental Health Assistant GUI Version 2

Category: 
  - Routine
  - Other

Description: 
============

 Enhancements
 ------------
 1.  Four new psychological tests, the Millon Behavioral Medicine Diagnostic
     (MBMD), the Beck Depression Inventory-II (BDI2), the Millon Clinical 
     Multiaxial Inventory-III (MCMI3) and the Brief Symptom Inventory 18 
     (BSI18) have been added to the MH INSTRUMENT (#601) file.  All can now
     be administered using MHA.  The results of the MCMI3, the BSI18, and
     MBMD can be viewed using the multi-scale graph window (the BDI2 is a 
     single scale instrument).  Context sensitive descriptions of the new
     tests were added to the Help file.
  
 2.  Entries to the COPYRIGHT HOLDER file (#601.3) have been made for the new
     psychological tests MBMD, BDI2, MCMI3 and BSI18. 
 
 3.  For the psychological test Minnesota Multiphasic Personality Inventory-2 
     (MMPI2), several changes have been made in the scales that are scored 
     and displayed.  Five new scales are now scored (the PSY-5 Personality 
     Psychopathology Five).  The Subtle-Obvious and Non-K Corrected scales
     are no longer scored or displayed.  The user can choose to display all 
     validity scales at once (Expanded Validity) or just the L, F, K scales 
     (Basic Validity).  In MHA Version 2 the multi-scale graph option has 
     been revised to display the new scales.
 
 4.  On the main window of Test Results, Order Tests, ASI or GAF tabs, a right 
     mouse click brings up a pop-up menu with options for each of the enabled 
     buttons on the active tab.
 
 5.  A pop-up menu was added to the window used for graphically displaying 
     the results of both multi-scale tests and ASI domain scores.  
     The pop-up menu, which is activated by a right-click, permits the user 
     to copy, print or save either a graph or a table.
 
 6.  If MHA is launched from the CPRS Tools menu, MHA accepts parameters 
     (such as Patient DFN) passed by CPRS.  This eliminates the need to 
     select a patient a second time and ensures that the same patient is 
     always selected by both applications if both are open.  When CPRS is 
     closed, MHA will be closed automatically.
 
 7.  MHA can be launched from the CPRS Tools menu without having to sign 
     on a second time if the RPC Broker workstation client software is 
     installed on the PC and single sign-on is enabled on VistA.
 
 8.  Upon closing the staff entry window, the user is given the option 
     of saving the test results to VistA.  Previously, the option of saving 
     results were given only if all the test questions had not been answered.  
     Completed tests were automatically saved.  The change gives the user 
     control over whether the data are saved and makes the exit process the 
     same whether the test was completed or not.
 
 9.  To make the patient selection key sequence the same as that used in 
     CPRS, the Select Patient menu caption was changed from 
     "Select New Patient" to "Select New Patient".
      _                              _
 
 10. If a patient is deceased, the user is notified of that and asked if 
     they want to proceed before allowing entry of a new GAF rating, 
     psychological test, or ASI.  If the user proceeds, the GAF rating date 
     or ASI admission/interview dates cannot be greater than the date of 
     death.  Constraining the date of psychological test data for staff and 
     clerk entry will require a modification to the MH INSTRUMENT file (#601).
 
 11. ASI comment fields were saved to VistA in a way that caused word 
     wrap problems.  The comments fields now are formatted correctly.
 
 12. In MHA Version 1 the ASI data-entry form, when clicking on an up or 
     down arrow in a spin-edit item, the spin-edit item with focus was 
     increased or decreased.  Any up or down arrow click would have its 
     impact on the field with focus, even arrows for other items. The current 
     version allows only the up and down arrows associated with that 
     spin-edit item to have any effect.
 
 13. In MHA Version 1, the executable was named YS50171_MHA.exe to 
     reflect both the associated VistA patch (YS*5.01*71) and the Delphi 
     application build number (123).  However, this method of naming the 
     executable will require a new name with each release, which will
     increase the difficulty of installing future releases.  In MHA Version
     2, the executable is named YS_MHA.exe which will be used for all future
     releases.
 
 Maintenance
 -----------
 1.  In MHA Version 1, some windows were closed by a button captioned "Close"
     and others were closed by a button captioned "Return".  All such buttons
     are now captioned "Close".
 
 2.  On the Staff Entry window, the button that returns the user to a 
     previously answered question was captioned "Back Up".  Because this 
     caption could be misunderstood as meaning data would be saved to a 
     backup archive, the caption was changed to "Previous".
 
 3.  By convention, "OK" buttons appear to the left of "Cancel" buttons, 
     but on some MHA windows their positions were reversed.  These two 
     buttons now appear in conventional order on all windows.
 
 4.  To make them more readable, the ">" captions on the buttons on the 
     Order Tests tab were changed to bold font.
 
 5.  The MMP2S is a short form of the MMPI2.  In MHA Version 1, scores from
     the two forms of the test could not be compared on the multi-scale graph
     window.  The user is now given that option.
 
 6.  When printed, graphs did not include the patient name and yellow 
     lines were not visible on monochrome printers.  Patient name is now a 
     footer on all printed graphs, and the yellow lines have been made black.
 
 7.  The following instruments in the MH INSTRUMENT (#601) file: 16PF, MMPI, 
     M168, MCMI, CES, CPI, FES, FIRO, GES, MYER, WES, and SII are copyrighted 
     tests that VACO does not have a license to use.  When the user selects 
     one of these instruments they receive the message "DEVLIN,MARK is NOT 
     AUTHORIZED to order Instrument GES.".  Now, when the user selects one of
     these instruments the message returned is "[VACO currently does not have 
     a license to use this test]".  This message is only displayed on the list 
     manager version of Mental Health V. 5.01.  In the MHA GUI non
     copyrighted tests that VACO does not have a license to use are not
     viewable from Available Tests box.
   
 8.  The ASI NARRATIVE file (#604.68) data has been edited to correct problems 
     with the logic and executable code to produce a report for the Addiction
     Severity Index that reads like a clinician's written report.  The entries 
     modified are GENERAL, FULL ITEM REPORT, LITE ITEM REPORT, FOLLOWUP ITEM
     REPORT, FOLLOWUP NARRATIVE, ASI-MV ITEM REPORT and the ASI-MV NARRATIVE.
 
 9.  During initialization of the main window of the Test Results tab, the 
     appropriate notice did not appear if the user did not have the YSP 
     key and the first test in the list of previous tests was non-exempt.
 
 10. An error occurred if the Domain Scores button on the main window of the 
     ASI tab was clicked for a patient for whom there were no complete ASI 
     records to display.  This problem was corrected by disabling the button 
     if the patient did not have at least one signed ASI with all questions 
     answered (i.e., not a G-12 record).
 
 11. Short-cut keys were working on the main, staff entry and clerk 
     entry windows even though the Alt key was not pressed.  This has now 
     been corrected to work only when the Alt key has been pressed.
 
 12. Signing an ASI-MV was not possible without first loading the data into 
     the ASI data entry window.  Because there are some differences between 
     the ASI-MV and a regular ASI, loading the ASI-MV into the ASI data 
     entry window caused data validation errors when the record was saved to 
     VistA.  Signing an ASI-MV is now possible without loading the results 
     into the data entry window.
 
 13. Incorrect source code was used to determine whether the user was the 
     ASI interviewer, who is the only person who can sign the interview.  
     Consequently, a new ASI could not be signed without first saving it
     to VistA and then reloading it into the data entry window.  
 
 14. On the main window of the Order Tests tab, if either the list box 
     containing test choices or the list box containing tests that had been 
     selected had focus, context sensitive Help was not available for the 
     selected test in the list box.  The context ID of the selected test now 
     is set on the list box click event.
 
 15. In MHA Version 1 comments in the ASI were not saved for Spiritual Status
     and Leisure Time Status.  In MHA Version 2 these comments are now saved.
 
 16. Sometimes, when MHA Version 1 is run as a server application, the Help
     file could not be found.  In MHA Version 2 the file path is now 
     dynamically set.
 
 17. When using option, Delete unsigned ASI [YSAS ASI DATA DELETION] the user
     received an error %DSM-E-STRLEN, string too long, DSM-I-ATLABEL,
     TLD+11^YSASSEL:1.  This error occurred on a test patient.  An initial ASI
     is administered to a patient once they enter the substance abuse 
     program.  A follow-up ASI is then administered every six months the 
     patient is in the program.  This error has been corrected by lowering
     the $PIECE field position TO from 40 to 20.
 
 18. When a user selects the multi-graph button for multi-graph tests 
     i.e., MMPI2 we are getting an undefined variable error.  This error has
     been corrected.
 
 19. When a user selects the multi-graph button for multi-graph tests for 
     the SF36 and the score equals 100, they received an "invalid integer"
     message.  On the multiscale window, the table now lists the correct
     scale scores (i.e., real numbers, not integers). This has been corrected
     in the MHA GUI source.
 
 20. The instruction text for patient administered tests in MHA Version 1
     are too small and did not contrast well with the grey background.  In 
     MHA Version 2 the font size has been increased 10 and the background
     color has been changed to white.
 
 21. When a user selected the Test Results tab, and from the list of 
     available tests an interview was selected, an undefined error at R1+1
     of YIHISTF resulted.  The problem is that the user should not have been 
     able to select an interview, example the PSOC or MROS.  The API to fill
     the Test List box has been modified to now just pass tests to display 
     for selection.
 
 22. When the user selects options Mental Health [YSUSER], Clinical Record 
     [YSCLINRECORD], Tests and interviews (results) [YSPRINT], selects a
     Patient and then from the list of instruments completed selects the
     instrument 'HX2'.  Because the site had the missing node 
     ^YTD(601.2,YSDFN,1,YSET,1,YSED,U1), the undefined error occurred at
     R1+4^YIHISTF.  This error has been corrected.
 
 23. Routine YTRPWRP has been modified to correct the Salt Lake City VAMC 
     problem with MHA hanging while retrieving of test results when using
     the Test Results tab.
 
 
 508 Compliance
 --------------
 
 1. In MHA Version 1, on the Order Tests tab the only way to move a test 
    from the list of available tests to the list of selected tests (or back) 
    without using the mouse was to use options under the Actions option on 
    the main menu.  In MHA Version 2, it is now also possible to tab to the 
    select, delete, or delete all buttons; and select, delete, and delete 
    all menu options have been added to the pop-up menu.
 
 ---------------------------------------------------------------------------
 
              E3R#:   11433
                      14815
  
   Associated NOIS:   PUG-0403-52263
                      MIW-0403-42105
                      NIN-0403-42361
                      NIN-0303-42233
                      CLE-0303-42095
                      OKL-0203-71821
                      SLC-1202-50678
                      ALB-0902-51763
                      TNV-0902-31708
                      TOG-0902-11863
                      CLE-0802-42348
                      CLE-0802-42183
                      HWH-0802-40375
                      BAY-0802-31043
                      SBY-0702-30380
                      REN-0702-62697
                      BAC-0702-42133
                      CLE-0702-42052
                      DUB-0702-31955
                      NHM-0702-11241
                      DAY-0296-41044
 
 
      Test Site(s):   Miami VAMC, FL
                      Minneapolis VAMC, MN
                      Salt Lake City HCS, UT
                      VA Health Care Network Upstate New York
                      VA N. Florida/S. Georgia Veterans HCS
                      VA North Texas HCS
  
  
  
    ROUTINE SUMMARY:
    ================
    The second line of the routine now looks like:
  
    <tab>   ;;5.01;MENTAL HEALTH;**[patch list]**;Dec 30, 1994
  
                                Checksum Values
  
    Routine Name       Before Patch        After Patch        Patch List
    ------------       ------------        -----------        ----------
    YSASFM                  4829236            4845118        24,30,32,37,38,
                                                              55,76
    YSASNAR                11815417           11861142        24,30,37,38,44,
                                                              55,67,76
    YSASPRT                 2116236            2161961        24,30,38,76
    YSASSEL                 8843928            8843828        24,30,38,76
    YSMTI3                  7243669            7694272        53,71,76
    YTAPI                   9597980            9429919        53,71,76
    YTAPI1                  3829862            3787747        53,71,76
    YTAR                   17157520           17228546        37,54,76
    YTAR1                   6302994            6356397        37,76
    YTBI                   10263261           13766056        76
    YTBSI18                N/A                 2756187        76
    YTCLERK                10603997           10744720        19,76
    YTCLERK1                5889838            5941523        10,19,76
    YTMBMD                 N/A                 7302508        76
    YTMCMI3                N/A                 7153377        76
    YTMCMI3A               N/A                10735202        76
    YTMCMI3R               N/A                 6136574        76
    YTMMPI2B               15991750           17200069        10,31,76
    YTRPWRP                3186347            3199257         71,76
 
    Sites should use CHECK^XTSUMBLD to verify checksums.
  
    SOFTWARE RETRIEVAL:
    ===================
  
    The following software and documentation files are exported as part
    of this patch:
  
     File Name                     Contents             Retrieval Format
     ---------                     --------             ----------------
     YS_501_76.KID                 YS*5.01*76               ASCII
 
     YS50176_Setup_124.EXE         Mental Health Assistant  BINARY
                                   This file is the complete install
                                   for the Mental Health Assistant
                                   GUI version 1.0.2.9 client.
 
     - YS_MHA.exe       MHA2 Executable
     - YS_MHA_SD.exe    Secure Desktop Executable
     - YS_MHA_KH.DLL    Keyboard Hook DLL used by Secure Desktop
     - YS_MHA.Hlp       Online Help file
     - YS_MHA.GID       Online Help configuration file
 
     YS50176_MHA2_IG.PDF        YS_MHA2 Installation Guide        BINARY
     YS50176_MHA2_IG.DOC        YS_MHA2 Installation Guide        BINARY
 
     YS50176_MHA2_UM.PDF        YS_MHA2 User Manual               BINARY
     YS50176_MHA2_UM.DOC        YS_MHA2 User Manual               BINARY
  
    The software files are available on the following OI Field Offices'
    ANONYMOUS.SOFTWARE directories.
  
    All sites are encouraged to use their FTP capability to obtain these
    files.  Use the FTP address "download.vista.med.va.gov" (without the
    quotes) to connect to the first available FTP server where the files
    are located.
  
     OI FIELD OFFICE    FTP ADDRESS                DIRECTORY
     ===============    ===========                =========
     ALBANY             ftp.fo-albany.med.va.gov   [ANONYMOUS.SOFTWARE]
     HINES              ftp.fo-hines.med.va.gov    [ANONYMOUS.SOFTWARE]
     SALT LAKE          ftp.fo-slc.med.va.gov      [ANONYMOUS.SOFTWARE]
  
  
    Installation Instructions:
    ==========================
    1. Use the 'LOAD A DISTRIBUTION' option on the PackMan menu. The
       Host File name is YS_501_76.KID.  Answer YES to the question:
       "Want to Continue with Load? YES//"
  
  
    2. The patch has now been loaded into a Transport global on your
       system. You now need to install the Transport global. 
       On the KIDS menu, under the 'Installation' menu, use the 
       following options:
  
          Print Transport Global
          Compare Transport Global to Current System
          Verify Checksums in Transport Global
          Backup a Transport Global
  
  
    3. Users may remain on the system, but installation should be done 
       at off peak hours.
  
  
    4. Installation will take less than five minutes. 
  
  
    5. From the 'Installation Menu' of the KIDS menu, run the option
       'Install Package(s)' Select the package 'YS*5.01*76'
       and proceed with install.
  
  
    6. When prompted 'Want KIDS to INHIBIT LOGONs during the
       install//', respond NO.
       When prompted 'Want to DISABLE Scheduled Options, Menu Options, 
       and Protocols? YES//', respond NO
 
  
    7. Place the MENTAL HEALTH ASSISTANT VERSION 2 USER MANUAL in a
       location that can be accessed by MHA users.
  
  
    8. Please refer to the POST INSTALLATION INSTRUCTIONS section of the 
       MENTAL HEALTH ASSISTANT VERSION 2 INSTALLATION GUIDE to install the 
       MHA software.
  

Routine Information:
====================

Routine Name:
  - YTBI


Routine Checksum:

Routine Name:
  - YTMBMD


Routine Checksum:

Routine Name:
  - YTAR1


Routine Checksum:

Routine Name:
  - YTMCMI3


Routine Checksum:

Routine Name:
  - YTMCMI3A


Routine Checksum:

Routine Name:
  - YTMCMI3R


Routine Checksum:

Routine Name:
  - YTCLERK


Routine Checksum:

Routine Name:
  - YTCLERK1


Routine Checksum:

Routine Name:
  - YTAPI1


Routine Checksum:

Routine Name:
  - YTBSI18


Routine Checksum:

Routine Name:
  - YTMMPI2B


Routine Checksum:

Routine Name:
  - YSMTI3


Routine Checksum:

Routine Name:
  - YTAR


Routine Checksum:

Routine Name:
  - YSASFM


Routine Checksum:

Routine Name:
  - YSASPRT


Routine Checksum:

Routine Name:
  - YSASNAR


Routine Checksum:

Routine Name:
  - YSASSEL


Routine Checksum:

Routine Name:
  - YTAPI


Routine Checksum:

Routine Name:
  - YTRPWRP


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : DEVLIN,MARK J                 Date Entered : OCT 04, 2002
Completed By: DIBENEDETTO,PETER             Date Completed: JUN 25, 2003
Released By : TASTROM,JOSEPH E             Date Released : JUN 27, 2003
=============================================================================


Packman Mail Message:
=====================

No routines included
