Released DVB*4*55 SEQ #52
Extracted from mail message
**KIDS**:DVB*4.0*55^

**INSTALL NAME**
DVB*4.0*55
"BLD",6094,0)
DVB*4.0*55^HINQ^0^3060321^y
"BLD",6094,4,0)
^9.64PA^^
"BLD",6094,6)
2^
"BLD",6094,"ABNS",0)
^9.66A^1^1
"BLD",6094,"ABNS",1,0)
DVB
"BLD",6094,"ABNS",1,1,0)
^9.661A^^
"BLD",6094,"ABNS","B","DVB",1)

"BLD",6094,"ABPKG")
y^n
"BLD",6094,"KRN",0)
^9.67PA^8989.52^19
"BLD",6094,"KRN",.4,0)
.4
"BLD",6094,"KRN",.401,0)
.401
"BLD",6094,"KRN",.402,0)
.402
"BLD",6094,"KRN",.403,0)
.403
"BLD",6094,"KRN",.5,0)
.5
"BLD",6094,"KRN",.84,0)
.84
"BLD",6094,"KRN",3.6,0)
3.6
"BLD",6094,"KRN",3.8,0)
3.8
"BLD",6094,"KRN",9.2,0)
9.2
"BLD",6094,"KRN",9.8,0)
9.8
"BLD",6094,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",6094,"KRN",9.8,"NM",1,0)
DVBHIQD^^0^B10303650
"BLD",6094,"KRN",9.8,"NM",2,0)
DVBHQDB^^0^B21338351
"BLD",6094,"KRN",9.8,"NM",3,0)
DVBHQDE^^0^B20139073
"BLD",6094,"KRN",9.8,"NM","B","DVBHIQD",1)

"BLD",6094,"KRN",9.8,"NM","B","DVBHQDB",2)

"BLD",6094,"KRN",9.8,"NM","B","DVBHQDE",3)

"BLD",6094,"KRN",19,0)
19
"BLD",6094,"KRN",19.1,0)
19.1
"BLD",6094,"KRN",101,0)
101
"BLD",6094,"KRN",409.61,0)
409.61
"BLD",6094,"KRN",771,0)
771
"BLD",6094,"KRN",870,0)
870
"BLD",6094,"KRN",8989.51,0)
8989.51
"BLD",6094,"KRN",8989.52,0)
8989.52
"BLD",6094,"KRN",8994,0)
8994
"BLD",6094,"KRN","B",.4,.4)

"BLD",6094,"KRN","B",.401,.401)

"BLD",6094,"KRN","B",.402,.402)

"BLD",6094,"KRN","B",.403,.403)

"BLD",6094,"KRN","B",.5,.5)

"BLD",6094,"KRN","B",.84,.84)

"BLD",6094,"KRN","B",3.6,3.6)

"BLD",6094,"KRN","B",3.8,3.8)

"BLD",6094,"KRN","B",9.2,9.2)

"BLD",6094,"KRN","B",9.8,9.8)

"BLD",6094,"KRN","B",19,19)

"BLD",6094,"KRN","B",19.1,19.1)

"BLD",6094,"KRN","B",101,101)

"BLD",6094,"KRN","B",409.61,409.61)

"BLD",6094,"KRN","B",771,771)

"BLD",6094,"KRN","B",870,870)

"BLD",6094,"KRN","B",8989.51,8989.51)

"BLD",6094,"KRN","B",8989.52,8989.52)

"BLD",6094,"KRN","B",8994,8994)

"BLD",6094,"QUES",0)
^9.62^^
"BLD",6094,"REQB",0)
^9.611^3^3
"BLD",6094,"REQB",1,0)
DVB*4.0*38^2
"BLD",6094,"REQB",2,0)
DVB*4.0*52^2
"BLD",6094,"REQB",3,0)
DVB*4.0*49^2
"BLD",6094,"REQB","B","DVB*4.0*38",1)

"BLD",6094,"REQB","B","DVB*4.0*49",3)

"BLD",6094,"REQB","B","DVB*4.0*52",2)

"MBREQ")
0
"PKG",119,-1)
1^1
"PKG",119,0)
HINQ^DVB^HINQ(Hospital Inquiry)
"PKG",119,20,0)
^9.402P^^
"PKG",119,22,0)
^9.49I^1^1
"PKG",119,22,1,0)
4.0^2930615^2920421
"PKG",119,22,1,"PAH",1,0)
55^3060321^123456813
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","DVBHIQD")
0^1^B10303650^B10379914
"RTN","DVBHIQD",1,0)
DVBHIQD ;ISC-ALBANY/XAK,PKE-generate a HINQ request  ;6/1/83@08:00
"RTN","DVBHIQD",2,0)
 ;;4.0;HINQ;**21,52,55**;03/25/92
"RTN","DVBHIQD",3,0)
 ;
"RTN","DVBHIQD",4,0)
TM ;D EN^DVBHQTM I $D(DVBSTOP) K DVBSTOP Q
"RTN","DVBHIQD",5,0)
 S DIC="^DPT(",DIC(0)="QEAMZ" D ^DIC Q:Y<0  S DFN=+Y
"RTN","DVBHIQD",6,0)
 D:'$D(DT) DT^DICRW D EN Q
"RTN","DVBHIQD",7,0)
 ;
"RTN","DVBHIQD",8,0)
EN I $D(^DVB(395.5,DFN,0)),"PNEA"[$P(^(0),U,4) W !,$C(7),"A HINQ Request has already been made for this patient",!,"Do you wish to make another request " S %=2 D YN^DICN Q:%'=1
"RTN","DVBHIQD",9,0)
 ;
"RTN","DVBHIQD",10,0)
PASS X ^%ZOSF("EOFF") R !,"Enter HINQ PASSWORD: ",DVBP:DTIME X ^%ZOSF("EON") S:'$T DVBP="^" Q:'$T!("^."[DVBP)  S X=DVBP X ^DD("FUNC",13,1) S DVBP=X I DVBP'?4E W !,*7,"Please enter 4 characters." G PASS
"RTN","DVBHIQD",11,0)
 ;VBA has changed the format of the HINQ password to allow numbers and 
"RTN","DVBHIQD",12,0)
 ;special characters - DVB*4*55,ERC
"RTN","DVBHIQD",13,0)
 ;
"RTN","DVBHIQD",14,0)
BYPASS Q:'$D(DFN)  I '$D(Y(0)),$D(^DPT(DFN,0)) S Y(0)=^(0)
"RTN","DVBHIQD",15,0)
 N I,I2,I3,I4,I5
"RTN","DVBHIQD",16,0)
 ;
"RTN","DVBHIQD",17,0)
 Q:'$D(Y(0))  S DVBNAM=$P(Y(0),"^",1),I=$P(DVBNAM,",",1),I2=$P(DVBNAM,",",2),I3=$P(I2," ",2,99),I2=$P(I2," ",1)
"RTN","DVBHIQD",18,0)
 F J=$L(I):-1:0 Q:$E(I,J)?1A  S I=$E(I,1,J-1)
"RTN","DVBHIQD",19,0)
 F J=1:1 Q:$F(I," ")=0  S K=$F(I," "),I4=$E(I,K,99),I=$E(I,1,K-2)
"RTN","DVBHIQD",20,0)
 I $D(I4),$L(I4)<4 S I5=""
"RTN","DVBHIQD",21,0)
 E  I $D(I4),$L(I4)>3 I "SRJRIII"[$P(I4," ",2) S:"SRJRIII"'[$P(I4," ") I5=$P(I4," ") S I4=$P(I4," ",2)
"RTN","DVBHIQD",22,0)
 I $D(I4),I4=" " K I4
"RTN","DVBHIQD",23,0)
 I $D(I4) F J=$L(I4):-1:0 Q:$E(I4,J)'=" "  S I4=$E(I4,1,J-1)
"RTN","DVBHIQD",24,0)
 I '$D(I5),$D(I4) S I5=I4 K I4
"RTN","DVBHIQD",25,0)
 F J=0:0 Q:$E(I3)'=" "  S I3=$E(I3,2,99)
"RTN","DVBHIQD",26,0)
 I '$D(I4) S I4=$P(I3," ",2),I3=$P(I3," ",1)
"RTN","DVBHIQD",27,0)
 I I2["-" S I2=$P(I2,"-")_$P(I2,"-",2)
"RTN","DVBHIQD",28,0)
 I I3["-" S I3=$P(I3,"-")_$P(I3,"-",2)
"RTN","DVBHIQD",29,0)
 S DVBNAM=I_$S($D(I5):I5,1:"")_","_I2_$S($D(I3):","_I3,1:"")_$S($D(I4):","_I4,1:"") K I,I2,I3,I4,I5
"RTN","DVBHIQD",30,0)
 I DVBNAM["'" S DVBNAM=$P(DVBNAM,"'")_$P(DVBNAM,"'",2)
"RTN","DVBHIQD",31,0)
 I DVBNAM["." S DVBNAM=$P(DVBNAM,".")_$P(DVBNAM,".",2)
"RTN","DVBHIQD",32,0)
 I DVBNAM["(" S DVBNAM=$P(DVBNAM,"(")
"RTN","DVBHIQD",33,0)
 S:DVBNAM]"" DVBNAM="NM"_$E(DVBNAM,1,30)_"/"
"RTN","DVBHIQD",34,0)
 I $D(^DVB(395,1,0)) S DVBSTN=$P(^DVB(395,1,0),U,2) Q:'DVBSTN
"RTN","DVBHIQD",35,0)
 E  W !,*7,"Station number not defined in HINQ Parameters file." Q
"RTN","DVBHIQD",36,0)
ST ;
"RTN","DVBHIQD",37,0)
 S DVBZ="HINQ"_DVBSTN_" "_"E"_$S($P(Y(0),"^",9)]""&($P(Y(0),"^",9)'["P"):"SS"_$E($P(Y(0),"^",9),1,9),1:"")_DVBNAM
"RTN","DVBHIQD",38,0)
 I $P(Y(0),"^",9)]"",$P(Y(0),"^",9)'["P" S DVBZ="HINQ"_DVBSTN_" "_"E"_"SS"_$E($P(Y(0),"^",9),1,9)_DVBNAM G CN
"RTN","DVBHIQD",39,0)
 S DVBZ="HINQ"_DVBSTN_" "_"E"_DVBNAM
"RTN","DVBHIQD",40,0)
 ;send C#, S#
"RTN","DVBHIQD",41,0)
CN S I=$S($D(^DPT(DFN,.31)):$P(^(.31),"^",3),1:"") G SN:I="",SN:I["P" F J=1:1 Q:$L(I)'<8  S I=0_I
"RTN","DVBHIQD",42,0)
 S:$L(I)=8 I=" "_I S DVBZ=DVBZ_"CN"_I
"RTN","DVBHIQD",43,0)
 G VDI
"RTN","DVBHIQD",44,0)
SN S I=$S($D(^DPT(DFN,.32)):$P(^(.32),"^",8),1:"") G VDI:I="",VDI:I["P",VDI:I'?1N.N,VDI:$L(I)>9 F J=1:1 Q:$L(I)'<8  S I=0_I
"RTN","DVBHIQD",45,0)
 S:$L(I)=8 I=" "_I S DVBZ=DVBZ_"SN"_I
"RTN","DVBHIQD",46,0)
 ;
"RTN","DVBHIQD",47,0)
VDI S DVBZ=DVBZ_DVBP,DVBZ=$E(DVBZ,1,9)_$E(DFN_"              ",1,14)_$E(DVBZ,10,999)
"RTN","DVBHIQD",48,0)
 ;
"RTN","DVBHIQD",49,0)
 K DVBNAM,DVBSTN QUIT
"RTN","DVBHIQD",50,0)
 ;
"RTN","DVBHIQD",51,0)
BYPASS1 I '$D(^DVB(395.5,DFN,"HQ")) D BYPASS QUIT
"RTN","DVBHIQD",52,0)
 E  S DVBZ=^DVB(395.5,DFN,"HQ")_DVBP
"RTN","DVBHIQD",53,0)
 QUIT
"RTN","DVBHQDB")
0^2^B21338351^B21236839
"RTN","DVBHQDB",1,0)
DVBHQDB ;ISC-ALBANY/PKE-HINQ Queue batch processs ;8/4/87  18:04 ; 5/10/01 10:36am
"RTN","DVBHQDB",2,0)
 ;;4.0;HINQ;**12,15,20,33,34,38,55**;03/25/92
"RTN","DVBHQDB",3,0)
 S X="A" X ^%ZOSF("LPC") K X
"RTN","DVBHQDB",4,0)
 I $D(DUZ)#2'=1 W !,"User DUZ not defined" Q
"RTN","DVBHQDB",5,0)
 I $D(^VA(200,DUZ,.1)) S DVBNUM=$P(^(.1),"^",9) I DVBNUM
"RTN","DVBHQDB",6,0)
 E  W !,"  HINQ Employee Number not in New Person file",!,"  Notify System Manager",! G EX
"RTN","DVBHQDB",7,0)
 S U="^" W !,"When you enter your HINQ password all 'P'ending",!,"requests in the Suspense file will be generated.",!
"RTN","DVBHQDB",8,0)
 I $D(^DVB(395,1,"HQ")),'$D(^DVB(395.5,"AD","P")) W !!,?$X+10,"No requests Pending",! H 3 G EX
"RTN","DVBHQDB",9,0)
PASS X ^%ZOSF("EOFF") R !,"Enter HINQ PASSWORD: ",DVBP:DTIME X ^%ZOSF("EON") Q:'$T!("^."[DVBP)  S X=DVBP X ^DD("FUNC",13,1) S DVBP=X I DVBP'?4E W "? ",!,$C(7),"Please enter 4 characters." G PASS
"RTN","DVBHQDB",10,0)
 ;VBA has changed the format of the HINQ password to allow numbers and 
"RTN","DVBHQDB",11,0)
 ;special characters - DVB*4*55,ERC
"RTN","DVBHQDB",12,0)
 I $D(DVBP),$L(DVBP)=4
"RTN","DVBHQDB",13,0)
 E  G EX
"RTN","DVBHQDB",14,0)
 ;
"RTN","DVBHQDB",15,0)
DEV S DVBIP=$P($G(^DVB(395,1,"HQIP")),"^",1)
"RTN","DVBHQDB",16,0)
 I DVBIP,DVBIP?1.3N1P1.3N1P1.3N1P1.3N
"RTN","DVBHQDB",17,0)
 E  W !?3,"RDPC IP Address not defined or invalid in DVB parameter file #395" H 3 G EX
"RTN","DVBHQDB",18,0)
 S DVBDEV=""
"RTN","DVBHQDB",19,0)
 S X=7 F Z=1:1:4 S X=X_(100-$A(DVBP,Z))
"RTN","DVBHQDB",20,0)
 U IO(0) W ?$X+10,"Direct Requests Queued "
"RTN","DVBHQDB",21,0)
 D TSK,^%ZTLOAD W:$G(ZTSK) " #",ZTSK G EX
"RTN","DVBHQDB",22,0)
QUE ;entry from taskman, lock to prevent more than one job at a time
"RTN","DVBHQDB",23,0)
 L +^DVB("DVBHINQ BATCH"):9 E  H 33 S DVBABORT=1,DVBTSK=ZTSK D REQ G EX
"RTN","DVBHQDB",24,0)
 S DVBABORT=0,DVBP=DVBDAY I '$D(^DVB(395.5,"AD","P")) G EX
"RTN","DVBHQDB",25,0)
 I ('$D(DVBNUM)),('$D(DVBP)) G EX
"RTN","DVBHQDB",26,0)
 S U="^",DVBABORT=1,DVBTSK=ZTSK D ENTSK^DVBHQDL I DVBABORT D REQ,BYEF G EX
"RTN","DVBHQDB",27,0)
 S X=DVBP,DVBP="" D UTIL,COD,BYPASS,BYE,MAIL,22,UTIL I DVBABORT,'$D(DVBBADP) D REQ G EX
"RTN","DVBHQDB",28,0)
 ;
"RTN","DVBHQDB",29,0)
 G EX
"RTN","DVBHQDB",30,0)
 ;
"RTN","DVBHQDB",31,0)
COD S X=$E(X,2,7)_$E(X,9,10) F Z=1:2:8 S DVBP=DVBP_$C((100-$E(X,Z,Z+1)))
"RTN","DVBHQDB",32,0)
 Q
"RTN","DVBHQDB",33,0)
BYPASS U IO S (DFN,DVBCS,DVBACT,DVBCT,DVBECT)=0,DVBPCT=1
"RTN","DVBHQDB",34,0)
 ;
"RTN","DVBHQDB",35,0)
LIST Q:'$D(^DVB(395.5,"AD","P"))
"RTN","DVBHQDB",36,0)
 F DVBCT=1:1 S DFN=$O(^DVB(395.5,"AD","P",DFN)) Q:'DFN  I $D(^DVB(395.5,DFN,0)),"PV"[$P(^(0),"^",4) K Y(0),Y,DVBNAM,DVBSTN,DVBZ D BYPASS1^DVBHIQD D:$D(DVBZ) MES^DVBHQD1 Q:'DFN!(DVBABORT=3)  I DVBCT>49 S DFN=0,DVBABORT=99 Q
"RTN","DVBHQDB",37,0)
 Q
"RTN","DVBHQDB",38,0)
 ;
"RTN","DVBHQDB",39,0)
CHK I DVBABORT D BYE,MAIL G EX
"RTN","DVBHQDB",40,0)
 Q
"RTN","DVBHQDB",41,0)
 ;
"RTN","DVBHQDB",42,0)
MAIL S DVBDFN=0
"RTN","DVBHQDB",43,0)
 F  S DVBDFN=$O(^TMP("DVBHINQ",$J,DVBDFN)),DVBCS=0 Q:'DVBDFN  K X S DVBSZ=0 F  S DVBSZ=$O(^TMP("DVBHINQ",$J,DVBDFN,DVBSZ)) S:DVBSZ X(DVBSZ)=^(DVBSZ) D MAL:'DVBSZ,SC^DVBHQST Q:'DVBSZ  D ST
"RTN","DVBHQDB",44,0)
 ;nopend
"RTN","DVBHQDB",45,0)
 Q
"RTN","DVBHQDB",46,0)
 ; first a summary
"RTN","DVBHQDB",47,0)
 ;I $D(X)>9,$D(^DPT(DVBDFN,0)) D A^DVBHQST I $D(^DVB(395,1,0)),$P(^(0),U,4) D A^DVBHIQR,EN^DVBHIQM
"RTN","DVBHQDB",48,0)
MAL I $D(X)>9,$D(^DPT(DVBDFN,0)) DO
"RTN","DVBHQDB",49,0)
 .K DVBERR D A^DVBHQST ;errs
"RTN","DVBHQDB",50,0)
 .D A^DVBHIQR ;variables
"RTN","DVBHQDB",51,0)
 .I '$P(^DVB(395.5,DVBDFN,0),"^",6) DO
"RTN","DVBHQDB",52,0)
 ..I '$D(DVBERR),'$D(DVBNETER),'$D(DVBABREV) S DFN=DVBDFN D EN^DVBHT1
"RTN","DVBHQDB",53,0)
 ..K DVBDIQ
"RTN","DVBHQDB",54,0)
 .I $D(^DVB(395,1,0)),$P(^(0),"^",4) D EN^DVBHIQM Q  ;mail messages
"RTN","DVBHQDB",55,0)
 .I $D(^DVB(395,1,0)),$P(^(0),"^",4)=""!($P(^(0),"^",4)=0) D CLEAN^DVBHUTL1
"RTN","DVBHQDB",56,0)
 Q
"RTN","DVBHQDB",57,0)
TSK S DVBDAY=$E(X,1,7)_"."_$E(X,8,9) X ^%ZOSF("UCI") S ZTUCI=Y
"RTN","DVBHQDB",58,0)
 S ZTRTN="QUE^DVBHQDB",ZTIO=DVBDEV,ZTDTH=$H
"RTN","DVBHQDB",59,0)
TSK1 F J="DVBDAY","DVBNUM","DVBDEV" S ZTSAVE(J)=""
"RTN","DVBHQDB",60,0)
 S ZTDESC="This job is to process the HINQ Suspense file."
"RTN","DVBHQDB",61,0)
 Q
"RTN","DVBHQDB",62,0)
 ;
"RTN","DVBHQDB",63,0)
REQ Q:'$D(DVBTSK)  S DVBAUTO=$P(^DVB(395,1,"HQ"),U,7),DVBATOLM=$P(^("HQ"),U,8),DVBATOCT=$P(^("HQ"),U,9),DVBDIFF=+$P(^("HQ"),U,12)
"RTN","DVBHQDB",64,0)
 I DVBATOCT>(DVBATOLM-1)!(DVBAUTO=0) Q
"RTN","DVBHQDB",65,0)
 D ^DVBHQTM S X1=$P($H,",") I $D(DVBSTOP) S X1=X1+1,X2=28800-(DVBDIFF*3600)
"RTN","DVBHQDB",66,0)
 E  S X2=$P($H,",",2)
"RTN","DVBHQDB",67,0)
 ;Requeue task in 3 hours:  DVB*38  MLR  5.10.01
"RTN","DVBHQDB",68,0)
 I $G(DVBVBA)="NO" S X2=X2+10800 K DVBVBA
"RTN","DVBHQDB",69,0)
 ;S X2=X2+(300),ZTDTH=X1_","_X2
"RTN","DVBHQDB",70,0)
 S X2=X2+($S(DVBABORT=99:60,1:300)),ZTDTH=X1_","_X2
"RTN","DVBHQDB",71,0)
 S ZTIO=DVBDEV,$P(^DVB(395,1,"HQ"),U,9)=DVBATOCT+1,ZTRTN="QUE^DVBHQDB"
"RTN","DVBHQDB",72,0)
 D TSK1,^%ZTLOAD
"RTN","DVBHQDB",73,0)
 Q
"RTN","DVBHQDB",74,0)
EX ;K DVBAS,DVBOS,ZTSK,DVBNUM,XH,X,Y,Y(0),Z,Z1,DVBATOCT,DVBATOLM,DVBAUTO,DVBDFN,DVBBADP,DVBDEV,DVBDAY,DVBT,DVBP,DVBUCI,DFN,DVBABORT,DVBTSK,DVBDIFF,DVBSTOP,J,ZTIO QUIT
"RTN","DVBHQDB",75,0)
 D KILL^XUSCLEAN
"RTN","DVBHQDB",76,0)
 L -^DVB("DVBHINQ BATCH") D CLOSE^%ZISTCP Q
"RTN","DVBHQDB",77,0)
 ;
"RTN","DVBHQDB",78,0)
BYEF I IO']"" Q
"RTN","DVBHQDB",79,0)
 U IO F Z=1:1:30 I $D(X(Z)),X(Z)["???" I DVBLOG'["VHA" W "BYEF",$C(13) Q
"RTN","DVBHQDB",80,0)
 E  W "$%$DIS",$C(13),! Q
"RTN","DVBHQDB",81,0)
 F Z=1:1:6 R X1:1 Q:'$T
"RTN","DVBHQDB",82,0)
 Q
"RTN","DVBHQDB",83,0)
BYE I DVBLOG'["VHA" U IO W "$$$BYEF",$C(13) F G=1:1:9 R X1:3 Q:'$T
"RTN","DVBHQDB",84,0)
 I DVBLOG["VHA" U IO W "$%$DIS",$C(13),! F G=1:1:6 R X1:1 Q:'$T  I X1["0900 BYE" Q
"RTN","DVBHQDB",85,0)
 Q
"RTN","DVBHQDB",86,0)
UTIL K ^TMP("DVBHINQ",$J) Q
"RTN","DVBHQDB",87,0)
 ; leaves mini open but signs off VBA
"RTN","DVBHQDB",88,0)
 ; then mails responses and closes mini
"RTN","DVBHQDB",89,0)
ST K:DVBSZ=1 ^DVB(395.5,DVBDFN,"RS") I '$D(^DVB(395.5,DVBDFN,"RS",0)) S ^(0)="^395.512A^^"
"RTN","DVBHQDB",90,0)
 S $P(^DVB(395.5,DVBDFN,"RS",0),U,3,4)=DVBSZ_"^"_DVBSZ,^(DVBSZ,0)=X(DVBSZ) Q
"RTN","DVBHQDB",91,0)
 ;
"RTN","DVBHQDB",92,0)
22 S XMB="DVB HINQ RESPONSE",XMB(1)=DVBCT,XMB(2)=DVBECT,XMTEXT="DVBTXT(",XMB(3)=DVBACT,XMB(4)=DVBCT-DVBECT-DVBACT,XMB(5)=$S(XMB(3):"(CHECK MAIL MESSAGES)",1:"")
"RTN","DVBHQDB",93,0)
 D ^XMB K DVBTE,DVBCT,XMSUB,XMTEXT,XMY,N,DVBY Q
"RTN","DVBHQDE")
0^3^B20139073^B20242382
"RTN","DVBHQDE",1,0)
DVBHQDE ;ISC-ALBANY/PKE-generate HINQ direct ; 7/19/05 9:43pm
"RTN","DVBHQDE",2,0)
 ;;4.0;HINQ;**52,49,55**;03/25/92 
"RTN","DVBHQDE",3,0)
 G EN
"RTN","DVBHQDE",4,0)
RD R Y:DTIME IF  I Y'="^",Y'["?" S:Y'="" X1(N)=Y S:Y="@" X1(N)="" S:Y="SS"&(N>2) X1(N)=X1(2) Q
"RTN","DVBHQDE",5,0)
 S N=0 Q
"RTN","DVBHQDE",6,0)
 ;
"RTN","DVBHQDE",7,0)
EN ;D EN^DVBHQTM I $D(DVBSTOP) K DVBSTOP Q
"RTN","DVBHQDE",8,0)
 F Z=1:1:4 S X1(Z)=""
"RTN","DVBHQDE",9,0)
 S Y=-1 K Y(0)
"RTN","DVBHQDE",10,0)
NAM ;DVB*4*49 - name queries no longer accepted
"RTN","DVBHQDE",11,0)
 S X1(1)=""
"RTN","DVBHQDE",12,0)
 ;
"RTN","DVBHQDE",13,0)
 ;with DVB*4*49 only one number can be entered - first choice CN, 
"RTN","DVBHQDE",14,0)
 ;then SSN, then SN
"RTN","DVBHQDE",15,0)
TXT W !,"Enter one of the following numbers - Social Security Number, Claim Number",!,"or Service Number."
"RTN","DVBHQDE",16,0)
 W !
"RTN","DVBHQDE",17,0)
 D SS
"RTN","DVBHQDE",18,0)
 I Y?9N G EDIT
"RTN","DVBHQDE",19,0)
 I Y="^" Q
"RTN","DVBHQDE",20,0)
 D CNUM
"RTN","DVBHQDE",21,0)
 I Y?8.9N G EDIT
"RTN","DVBHQDE",22,0)
 I Y="^" Q
"RTN","DVBHQDE",23,0)
 D SNUM
"RTN","DVBHQDE",24,0)
 G EDIT
"RTN","DVBHQDE",25,0)
 Q
"RTN","DVBHQDE",26,0)
SS W !,"Social Security: ",X1(2)_$S($L(X1(2)):"// ",1:"") S N=2 D RD G SS:Y="@" I Y["?" S H=3 D HELP G SS
"RTN","DVBHQDE",27,0)
 Q:'N
"RTN","DVBHQDE",28,0)
 I X1(2)'="",X1(2)'?9N S X1(2)="" W $C(7) S H=4 D HELP S H=3 D HELP G SS G SS
"RTN","DVBHQDE",29,0)
 Q
"RTN","DVBHQDE",30,0)
 ;
"RTN","DVBHQDE",31,0)
CNUM W !,"Claim Number: ",X1(3)_$S($L(X1(3)):"// ",1:"") S N=3 D RD G CNUM:Y="@" I Y["?" S H=10 D HELP G CNUM
"RTN","DVBHQDE",32,0)
 Q:'N
"RTN","DVBHQDE",33,0)
 I X1(3)'="",(X1(3)'?1N.N!($L(X1(3))<1)!($L(X1(3))>9)) S X1(3)="" S H=6 D HELP S H=7 D HELP G CNUM
"RTN","DVBHQDE",34,0)
 Q
"RTN","DVBHQDE",35,0)
 ;
"RTN","DVBHQDE",36,0)
SNUM W !,"Service Number : ",X1(4)_$S($L(X1(4)):"// ",1:"") S N=4 D RD G SNUM:Y="@" S T=$L(X1(4)) I Y["?" S H=7 D HELP G SNUM
"RTN","DVBHQDE",37,0)
 Q:'N
"RTN","DVBHQDE",38,0)
 I X1(4)'="",(X1(4)'?1N.N!($L(X1(4))<4)!($L(X1(4))>9)) S X1(4)="" W $C(7) S H=8 D HELP S H=7 D HELP G SNUM
"RTN","DVBHQDE",39,0)
 Q
"RTN","DVBHQDE",40,0)
 ;
"RTN","DVBHQDE",41,0)
EDIT W !,?4," OK  " S %=1 D YN^DICN
"RTN","DVBHQDE",42,0)
 Q:%Y="^"  G:"Yy"[%Y CHK
"RTN","DVBHQDE",43,0)
 G:"Nn"[$E(%Y_1) NAM
"RTN","DVBHQDE",44,0)
 I %Y["?" W ?17 S H=9 D HELP G EDIT
"RTN","DVBHQDE",45,0)
 Q
"RTN","DVBHQDE",46,0)
 ;
"RTN","DVBHQDE",47,0)
CHK I X1(1)="",X1(2)="",X1(3)="",X1(4)="" Q
"RTN","DVBHQDE",48,0)
 S $P(Y(0),U,1)=X1(1)
"RTN","DVBHQDE",49,0)
 S $P(Y(0),U,9)=X1(2)
"RTN","DVBHQDE",50,0)
 S DVBCN=X1(3)
"RTN","DVBHQDE",51,0)
 S DVBSN=X1(4)
"RTN","DVBHQDE",52,0)
 ;
"RTN","DVBHQDE",53,0)
PASS X ^%ZOSF("EOFF") R !,"Enter HINQ PASSWORD: ",DVBP:DTIME X ^%ZOSF("EON") S:'$T DVBP="^" Q:'$T!("^."[DVBP)  S X=DVBP X ^DD("FUNC",13,1) S DVBP=X I DVBP'?4E W !,*7,"Please enter 4 characters." G PASS
"RTN","DVBHQDE",54,0)
 ;VBA has changed the format of the HINQ password to allow numbers and 
"RTN","DVBHQDE",55,0)
 ;special characters - DVB*4*55,ERC
"RTN","DVBHQDE",56,0)
 ;
"RTN","DVBHQDE",57,0)
BYPASS S DFN="XXXZ"
"RTN","DVBHQDE",58,0)
 N I,I1,I2,I3,I4,I5
"RTN","DVBHQDE",59,0)
 I '$D(Y(0)) S Y=-1 Q
"RTN","DVBHQDE",60,0)
 S DVBNAM=$P(Y(0),"^",1),I=$P(DVBNAM,","),I2=$P(DVBNAM,",",2)
"RTN","DVBHQDE",61,0)
 F J=$L(I):-1:0 Q:$E(I,J)?1A  S I=$E(I,1,J-1)
"RTN","DVBHQDE",62,0)
 F J=1:1 Q:$F(I," ")=0  S K=$F(I," "),I4=$E(I,K,99),I=$E(I,1,K-2)
"RTN","DVBHQDE",63,0)
 I $D(I4),$L(I4)<4 S I5=""
"RTN","DVBHQDE",64,0)
 E  I $D(I4),$L(I4)>3 I "SRJRIII"[$P(I4," ",2) S:"SRJRIII"'[$P(I4," ") I5=$P(I4," ") S I4=$P(I4," ",2)
"RTN","DVBHQDE",65,0)
 I $D(I4),I4=" " K I4
"RTN","DVBHQDE",66,0)
 I $D(I4) F J=$L(I4):-1:0 Q:$E(I4,J)'=" "  S I4=$E(I4,1,J-1)
"RTN","DVBHQDE",67,0)
 I '$D(I5),$D(I4) S I5=I4 K I4
"RTN","DVBHQDE",68,0)
 F J=0:0 Q:$E(I2)'=" "  S I2=$E(I2,2,99)
"RTN","DVBHQDE",69,0)
 F J=$L(I2):-1:0 Q:$E(I2,J)'=" "  S I2=$E(I2,1,J-1)
"RTN","DVBHQDE",70,0)
 I I2[" " S I3=$P(I2," ",2,99),I2=$P(I2," ") F J=0:0 Q:$E(I3)'=" "  S I3=$E(I3,2,99)
"RTN","DVBHQDE",71,0)
 I '$D(I4),$D(I3) S I4=$P(I3," ",2),I3=$P(I3," ",1)
"RTN","DVBHQDE",72,0)
 S DVBNAM=I_$S($D(I5):I5,1:"")_","_I2_$S($D(I3):","_I3,1:"")_$S($D(I4):","_I4,1:"")
"RTN","DVBHQDE",73,0)
 I DVBNAM["'" S DVBNAM=$P(DVBNAM,"'")_$P(DVBNAM,"'",2)
"RTN","DVBHQDE",74,0)
 I DVBNAM["." S DVBNAM=$P(DVBNAM,".")_$P(DVBNAM,".",2)
"RTN","DVBHQDE",75,0)
 I DVBNAM["(" S DVBNAM=$P(DVBNAM,"(")
"RTN","DVBHQDE",76,0)
 I DVBNAM?1"," S DVBNAM=""
"RTN","DVBHQDE",77,0)
 S:DVBNAM]"" DVBNAM="NM"_$E(DVBNAM,1,30)_"/"
"RTN","DVBHQDE",78,0)
 I $D(^DVB(395,1,0)) S DVBSTN=$P(^DVB(395,1,0),U,2) Q:'DVBSTN
"RTN","DVBHQDE",79,0)
 E  W !,*7,"Station number not defined in HINQ Parameters file." Q
"RTN","DVBHQDE",80,0)
ST ;;;CHANGED P TO E FOR TESTING NEW STRING
"RTN","DVBHQDE",81,0)
 S DVBZ="HINQ"_DVBSTN_" "_"E"_$S($P(Y(0),"^",9)]""&($P(Y(0),"^",9)'["P"):"SS"_$P(Y(0),"^",9),1:"")_DVBNAM
"RTN","DVBHQDE",82,0)
CN S I=DVBCN G SN:I="" F J=1:1 Q:$L(I)'<8  S I=0_I
"RTN","DVBHQDE",83,0)
 S:$L(I)=8 I=" "_I S DVBZ=DVBZ_"CN"_I
"RTN","DVBHQDE",84,0)
SN S I=DVBSN G VDI:I="" F J=1:1 Q:$L(I)'<8  S I=0_I
"RTN","DVBHQDE",85,0)
 S:$L(I)=8 I=" "_I S DVBZ=DVBZ_"SN"_I
"RTN","DVBHQDE",86,0)
 ;
"RTN","DVBHQDE",87,0)
VDI S DVBZ=DVBZ_DVBNUM_DVBP,DVBZ=$E(DVBZ,1,9)_"              "_$E(DVBZ,10,999)
"RTN","DVBHQDE",88,0)
 ;
"RTN","DVBHQDE",89,0)
 S Y=0 K %Y,I,I1,I2,I3,I4,I5,DVBNAM,DVBSTN,DVBTGT,Y(0) QUIT
"RTN","DVBHQDE",90,0)
 ;
"RTN","DVBHQDE",91,0)
HELP W "  ",$P($T(HELP+H),";;",2) K H Q
"RTN","DVBHQDE",92,0)
 ;;Enter last name,first name  up to 30 characters
"RTN","DVBHQDE",93,0)
 ;;At the last prompt ' OK ? YES// ' you may enter No to edit
"RTN","DVBHQDE",94,0)
 ;;Enter 9 digits only
"RTN","DVBHQDE",95,0)
 ;;Bad SSN
"RTN","DVBHQDE",96,0)
 ;;Enter 1-9 digits or SS for Social Security
"RTN","DVBHQDE",97,0)
 ;;Bad Claim #
"RTN","DVBHQDE",98,0)
 ;;Enter 4-9 digits or SS for Social Security
"RTN","DVBHQDE",99,0)
 ;;Bad Service #
"RTN","DVBHQDE",100,0)
 ;;Enter No to edit data   Return to continue
"RTN","DVBHQDE",101,0)
 ;;Identifying Number must be 1 - 9 digits
"VER")
8.0^22.0
"BLD",6094,6)
^52
**END**
**END**
