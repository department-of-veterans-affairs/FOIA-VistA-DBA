Released RG*1*46 SEQ #44
Extracted from mail message
**KIDS**:RG*1.0*46^

**INSTALL NAME**
RG*1.0*46
"BLD",6668,0)
RG*1.0*46^CLINICAL INFO RESOURCE NETWORK^0^3060322^y
"BLD",6668,1,0)
^^2^2^3060322^
"BLD",6668,1,1,0)
Patch resolves a problem with the PATIENT AUDIT FILE PRINT [RGMT AUDIT 
"BLD",6668,1,2,0)
PRINT] when tasking the job.  
"BLD",6668,4,0)
^9.64PA^^
"BLD",6668,"KRN",0)
^9.67PA^8989.52^19
"BLD",6668,"KRN",.4,0)
.4
"BLD",6668,"KRN",.401,0)
.401
"BLD",6668,"KRN",.402,0)
.402
"BLD",6668,"KRN",.403,0)
.403
"BLD",6668,"KRN",.5,0)
.5
"BLD",6668,"KRN",.84,0)
.84
"BLD",6668,"KRN",3.6,0)
3.6
"BLD",6668,"KRN",3.8,0)
3.8
"BLD",6668,"KRN",9.2,0)
9.2
"BLD",6668,"KRN",9.8,0)
9.8
"BLD",6668,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6668,"KRN",9.8,"NM",1,0)
RGMTAUDP^^0^B59483224
"BLD",6668,"KRN",9.8,"NM","B","RGMTAUDP",1)

"BLD",6668,"KRN",19,0)
19
"BLD",6668,"KRN",19,"NM",0)
^9.68A^^
"BLD",6668,"KRN",19.1,0)
19.1
"BLD",6668,"KRN",101,0)
101
"BLD",6668,"KRN",409.61,0)
409.61
"BLD",6668,"KRN",771,0)
771
"BLD",6668,"KRN",870,0)
870
"BLD",6668,"KRN",8989.51,0)
8989.51
"BLD",6668,"KRN",8989.52,0)
8989.52
"BLD",6668,"KRN",8994,0)
8994
"BLD",6668,"KRN","B",.4,.4)

"BLD",6668,"KRN","B",.401,.401)

"BLD",6668,"KRN","B",.402,.402)

"BLD",6668,"KRN","B",.403,.403)

"BLD",6668,"KRN","B",.5,.5)

"BLD",6668,"KRN","B",.84,.84)

"BLD",6668,"KRN","B",3.6,3.6)

"BLD",6668,"KRN","B",3.8,3.8)

"BLD",6668,"KRN","B",9.2,9.2)

"BLD",6668,"KRN","B",9.8,9.8)

"BLD",6668,"KRN","B",19,19)

"BLD",6668,"KRN","B",19.1,19.1)

"BLD",6668,"KRN","B",101,101)

"BLD",6668,"KRN","B",409.61,409.61)

"BLD",6668,"KRN","B",771,771)

"BLD",6668,"KRN","B",870,870)

"BLD",6668,"KRN","B",8989.51,8989.51)

"BLD",6668,"KRN","B",8989.52,8989.52)

"BLD",6668,"KRN","B",8994,8994)

"BLD",6668,"QUES",0)
^9.62^^
"BLD",6668,"REQB",0)
^9.611^1^1
"BLD",6668,"REQB",1,0)
RG*1.0*30^1
"BLD",6668,"REQB","B","RG*1.0*30",1)

"MBREQ")
0
"PKG",41,-1)
1^1
"PKG",41,0)
CLINICAL INFO RESOURCE NETWORK^RG^WILSON
"PKG",41,20,0)
^9.402P^1^1
"PKG",41,20,1,0)
2^^RGDRM03
"PKG",41,20,1,1)

"PKG",41,20,"B",2,1)

"PKG",41,22,0)
^9.49I^1^1
"PKG",41,22,1,0)
1.0^2990428^3000810^66481
"PKG",41,22,1,"PAH",1,0)
46^3060322
"PKG",41,22,1,"PAH",1,1,0)
^^2^2^3060322
"PKG",41,22,1,"PAH",1,1,1,0)
Patch resolves a problem with the PATIENT AUDIT FILE PRINT [RGMT AUDIT 
"PKG",41,22,1,"PAH",1,1,2,0)
PRINT] when tasking the job.  
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RGMTAUDP")
0^1^B59483224^B59077738
"RTN","RGMTAUDP",1,0)
RGMTAUDP ;BIR/CML,PTD-MPI/PD AUDIT File Print of Patient Data ;01/06/99
"RTN","RGMTAUDP",2,0)
 ;;1.0;CLINICAL INFO RESOURCE NETWORK;**19,30,46**;30 Apr 99
"RTN","RGMTAUDP",3,0)
 ;Reference to ^DD(2 supported by IA #2695.
"RTN","RGMTAUDP",4,0)
 ;Reference to ^DIA(2 and data derived from the AUDIT file (#1.1)
"RTN","RGMTAUDP",5,0)
 ;supported by IA #2097 and #2602.
"RTN","RGMTAUDP",6,0)
 ;Reference to ^ORD(101 supported by IA #2596
"RTN","RGMTAUDP",7,0)
 ;
"RTN","RGMTAUDP",8,0)
BEGIN ;
"RTN","RGMTAUDP",9,0)
 S QFLG=1
"RTN","RGMTAUDP",10,0)
 W @IOF
"RTN","RGMTAUDP",11,0)
 W !,"This option prints a customized report of information stored in the AUDIT"
"RTN","RGMTAUDP",12,0)
 W !,"file (#1.1) for fields being audited in the PATIENT file (#2).  For a"
"RTN","RGMTAUDP",13,0)
 W !,"specified date range, you can view all audited fields or selected fields."
"RTN","RGMTAUDP",14,0)
 W !,"You can also opt to print only edits that were done by a specific user."
"RTN","RGMTAUDP",15,0)
 W !!,"- If selected fields are viewed, you can choose to see data for all or"
"RTN","RGMTAUDP",16,0)
 W !,"  selected patients."
"RTN","RGMTAUDP",17,0)
 W !,"- If ALL audited fields are viewed, you must choose patients to examine."
"RTN","RGMTAUDP",18,0)
 ;
"RTN","RGMTAUDP",19,0)
ASKFLD ;Ask for Data Fields
"RTN","RGMTAUDP",20,0)
 I '$O(^DD(2,"AUDIT",0)) W !!,"No fields are currently being audited in the PATIENT file (#2)." G QUIT
"RTN","RGMTAUDP",21,0)
 W !
"RTN","RGMTAUDP",22,0)
 K DIR S DIR(0)="SAM^A:ALL;S:SELECTED;"
"RTN","RGMTAUDP",23,0)
 S DIR("A")="Do you want to see (A)LL or (S)ELECTED audited fields? "
"RTN","RGMTAUDP",24,0)
 S DIR("B")="A"
"RTN","RGMTAUDP",25,0)
 S DIR("?",1)="Enter:"
"RTN","RGMTAUDP",26,0)
 S DIR("?",2)=" ""A"" to see ALL audited fields in the PATIENT file (#2)."
"RTN","RGMTAUDP",27,0)
 S DIR("?")=" ""S"" to select specific audited fields."
"RTN","RGMTAUDP",28,0)
 D ^DIR G:$D(DIRUT) QUIT S ANS1=Y
"RTN","RGMTAUDP",29,0)
 ;
"RTN","RGMTAUDP",30,0)
FLDLOOP ;
"RTN","RGMTAUDP",31,0)
 W ! K FLD
"RTN","RGMTAUDP",32,0)
 ;stuff all fields
"RTN","RGMTAUDP",33,0)
 I ANS1="A" D  G ASKPAT
"RTN","RGMTAUDP",34,0)
 .S FLD=0 F  S FLD=$O(^DD(2,"AUDIT",FLD)) Q:'FLD  S FLD(FLD)=""
"RTN","RGMTAUDP",35,0)
 ;ask for specific fields
"RTN","RGMTAUDP",36,0)
 K DIR S DIR(0)="NAOC^.0000001:9999999:7^K:'$D(^DD(2,""AUDIT"",X)) X S RGERR=1"
"RTN","RGMTAUDP",37,0)
 S DIR("A")="Select FIELD NUMBER of audited field (enter ""?"" for list): "
"RTN","RGMTAUDP",38,0)
 S DIR("?")="^D FLDLIST^RGMTAUDP"
"RTN","RGMTAUDP",39,0)
 F QQ=0:0 S RGERR=0 D ^DIR Q:$D(DIRUT)  S FLD(+Y)=""
"RTN","RGMTAUDP",40,0)
 ;
"RTN","RGMTAUDP",41,0)
ASKPAT ;Ask for Patient
"RTN","RGMTAUDP",42,0)
 I '$O(FLD(0))!($D(DUOUT)) S QFLG=1 G QUIT
"RTN","RGMTAUDP",43,0)
 I ANS1="A" S ANS2="S" G PATLOOP
"RTN","RGMTAUDP",44,0)
 K DIR S DIR(0)="SAM^A:ALL;S:SELECTED;"
"RTN","RGMTAUDP",45,0)
 S DIR("A")="Do you want to see audited data for (A)LL or (S)ELECTED patients? "
"RTN","RGMTAUDP",46,0)
 S DIR("B")="S"
"RTN","RGMTAUDP",47,0)
 S DIR("?",1)="Enter:"
"RTN","RGMTAUDP",48,0)
 S DIR("?",2)=" ""A"" to see audited fields for ALL patients."
"RTN","RGMTAUDP",49,0)
 S DIR("?")=" ""S"" to select specific patients(s)."
"RTN","RGMTAUDP",50,0)
 W ! D ^DIR G:$D(DIRUT) QUIT S ANS2=Y
"RTN","RGMTAUDP",51,0)
PATLOOP ;
"RTN","RGMTAUDP",52,0)
 W ! K PAT
"RTN","RGMTAUDP",53,0)
 I ANS2="A" S PAT("ALL")="" G ASKDT
"RTN","RGMTAUDP",54,0)
 ;ask for specific patient(s)
"RTN","RGMTAUDP",55,0)
 F QQ=0:0 S DIC="^DPT(",DIC(0)="QEAM",DIC("A")="Select PATIENT: " D ^DIC K DIC Q:Y<0  S RGDFN=+Y D
"RTN","RGMTAUDP",56,0)
 .I '$O(^DIA(2,"B",RGDFN,0)) W $C(7),!?5,"This patient has no audit data available for any date." Q
"RTN","RGMTAUDP",57,0)
 .S PAT(RGDFN)=""
"RTN","RGMTAUDP",58,0)
 ;
"RTN","RGMTAUDP",59,0)
ASKDT ;Ask for Date Range
"RTN","RGMTAUDP",60,0)
 I '$D(PAT)!($D(DUOUT)) S QFLG=1 G QUIT
"RTN","RGMTAUDP",61,0)
 W !!,"Enter date range for data to be included in report."
"RTN","RGMTAUDP",62,0)
 K DIR,DIRUT,DTOUT,DUOUT S DIR(0)="DAO^:DT:EPX",DIR("A")="Beginning Date:  " D ^DIR K DIR G:$D(DIRUT) QUIT
"RTN","RGMTAUDP",63,0)
 S RGBDT=Y,DIR(0)="DAO^"_RGBDT_":DT:EPX",DIR("A")="Ending Date:  " D ^DIR K DIR G:$D(DIRUT) QUIT S RGEDT=Y
"RTN","RGMTAUDP",64,0)
 ;
"RTN","RGMTAUDP",65,0)
ASKUSER ;Ask if data is wanted only a specific user
"RTN","RGMTAUDP",66,0)
 K USERSCRN
"RTN","RGMTAUDP",67,0)
 W ! S DIR(0)="Y",DIR("B")="No",DIR("A")="Do you want to find only the edits made by a specific user"
"RTN","RGMTAUDP",68,0)
 D ^DIR K DIR I +Y'=1 G DEV
"RTN","RGMTAUDP",69,0)
 ;
"RTN","RGMTAUDP",70,0)
 S DIC="^VA(200,",DIC(0)="QEAM",DIC("A")="Select USER: "
"RTN","RGMTAUDP",71,0)
 D ^DIC K DIC G:+Y<0 QUIT S USERSCRN=+Y
"RTN","RGMTAUDP",72,0)
 ;
"RTN","RGMTAUDP",73,0)
DEV W !!,"The right margin for this report is 80.",!!
"RTN","RGMTAUDP",74,0)
 I ANS2="A" S IOP="Q" W "Because you selected ALL patients, you MUST queue this report.",!!
"RTN","RGMTAUDP",75,0)
 S ZTSAVE("RGBDT")="",ZTSAVE("RGEDT")="",ZTSAVE("ANS2")="",ZTSAVE("FLD(")="",ZTSAVE("PAT(")="",%ZIS("B")=""
"RTN","RGMTAUDP",76,0)
 S ZTSAVE("USERSCRN")=""
"RTN","RGMTAUDP",77,0)
 D EN^XUTMDEVQ("START^RGMTAUDP","MPI/PD - Print AUDIT File Data from the PATIENT file",.ZTSAVE,.%ZIS) I 'POP Q
"RTN","RGMTAUDP",78,0)
 W !,"NO DEVICE SELECTED OR REPORT PRINTED!!"
"RTN","RGMTAUDP",79,0)
 S QFLG=1 G QUIT
"RTN","RGMTAUDP",80,0)
 ;
"RTN","RGMTAUDP",81,0)
START ;
"RTN","RGMTAUDP",82,0)
 K ^TMP("RGMTAUDP",$J),^TMP("RGMTAUDP2",$J) S U="^"
"RTN","RGMTAUDP",83,0)
 S STOP=RGEDT+1
"RTN","RGMTAUDP",84,0)
 I ANS2="A" D
"RTN","RGMTAUDP",85,0)
 .S CNT=0
"RTN","RGMTAUDP",86,0)
 .S RGDFN=0 F  S RGDFN=$O(^DIA(2,"B",RGDFN)) Q:'RGDFN  S CNT=CNT+1 S:'(CNT#10000) ^TMP("RGMTAUDP",$J,"@@@@","CUR DFN")=RGDFN D LOOP
"RTN","RGMTAUDP",87,0)
 I ANS2="S" D
"RTN","RGMTAUDP",88,0)
 .S RGDFN=0 F  S RGDFN=$O(PAT(RGDFN)) Q:'RGDFN  D LOOP
"RTN","RGMTAUDP",89,0)
 G PRT
"RTN","RGMTAUDP",90,0)
 ;
"RTN","RGMTAUDP",91,0)
LOOP ;Loop on "B" xref of the AUDIT file
"RTN","RGMTAUDP",92,0)
 Q:'$D(^DPT(RGDFN,0))
"RTN","RGMTAUDP",93,0)
 I ANS2="S" D
"RTN","RGMTAUDP",94,0)
 . S PATNM=$P(^DPT(RGDFN,0),U)_U_RGDFN
"RTN","RGMTAUDP",95,0)
 . I '$O(^DIA(2,"B",RGDFN,0)) S ^TMP("RGMTAUDP2",$J,"NO AUDIT",PATNM)=" has no audit data available for any date."
"RTN","RGMTAUDP",96,0)
 S IEN=0 F  S IEN=$O(^DIA(2,"B",RGDFN,IEN)) Q:'IEN  D
"RTN","RGMTAUDP",97,0)
 .I $D(^DIA(2,IEN,0)) S IEN0=(^(0)),EDITDT=$P(IEN0,U,2) I EDITDT>RGBDT,EDITDT<STOP D
"RTN","RGMTAUDP",98,0)
 ..S FLD=$P(IEN0,U,3) I $D(FLD(FLD)) D
"RTN","RGMTAUDP",99,0)
 ...S USER=$P(IEN0,U,4)
"RTN","RGMTAUDP",100,0)
 ...I $D(USERSCRN) I USER'=USERSCRN Q
"RTN","RGMTAUDP",101,0)
 ...S PATNM=$P(^DPT(RGDFN,0),U)_U_RGDFN,^TMP("RGMTAUDP",$J,PATNM,EDITDT,IEN)=""
"RTN","RGMTAUDP",102,0)
 I ANS2="S" D
"RTN","RGMTAUDP",103,0)
 . I '$D(^TMP("RGMTAUDP",$J,PATNM)) S ^TMP("RGMTAUDP2",$J,"NO AUDIT",PATNM)=" has no audit data available for selected parameters."
"RTN","RGMTAUDP",104,0)
 Q
"RTN","RGMTAUDP",105,0)
 ;
"RTN","RGMTAUDP",106,0)
PRT ;Print report
"RTN","RGMTAUDP",107,0)
 S (PG,QFLG)=0,U="^",$P(LN,"-",81)="",SITE=$P($$SITE^VASITE(),U,2)
"RTN","RGMTAUDP",108,0)
 S PRGBDT=$$FMTE^XLFDT(RGBDT),PRGEDT=$$FMTE^XLFDT(RGEDT)
"RTN","RGMTAUDP",109,0)
 D NOW^%DTC S HDT=$$FMTE^XLFDT($E(%,1,12))
"RTN","RGMTAUDP",110,0)
 D HDR
"RTN","RGMTAUDP",111,0)
 I '$D(^TMP("RGMTAUDP",$J)) W !!,"No audit data found in this date range for specified parameters." G QUIT
"RTN","RGMTAUDP",112,0)
 S PATNM="@@@@" F  S PATNM=$O(^TMP("RGMTAUDP",$J,PATNM)) Q:PATNM=""  Q:QFLG  D
"RTN","RGMTAUDP",113,0)
 .D:$Y+4>IOSL HDR Q:QFLG
"RTN","RGMTAUDP",114,0)
 .W !!,"==> ",$P(PATNM,U),"  (DFN #",$P(PATNM,U,2),")"
"RTN","RGMTAUDP",115,0)
 .S EDITDT=0 F  S EDITDT=$O(^TMP("RGMTAUDP",$J,PATNM,EDITDT)) Q:QFLG  Q:'EDITDT  D
"RTN","RGMTAUDP",116,0)
 ..S IEN=0 F  S IEN=$O(^TMP("RGMTAUDP",$J,PATNM,EDITDT,IEN)) Q:QFLG  Q:'IEN  D
"RTN","RGMTAUDP",117,0)
 ...S PRTDT=$$FMTE^XLFDT($E(EDITDT,1,12))
"RTN","RGMTAUDP",118,0)
 ...S IEN0=^DIA(2,IEN,0)
"RTN","RGMTAUDP",119,0)
 ...K RGARR D FIELD^DID(2,$P(IEN0,U,3),"","LABEL","RGARR")
"RTN","RGMTAUDP",120,0)
 ...S FLD=$G(RGARR("LABEL"))  Q:FLD=""
"RTN","RGMTAUDP",121,0)
 ...S USER=$P(IEN0,U,4)
"RTN","RGMTAUDP",122,0)
 ...I 'USER S USER="UNKNOWN"
"RTN","RGMTAUDP",123,0)
 ...I USER'="UNKNOWN" S DIC="^VA(200,",DIC(0)="MZO",X="`"_USER D ^DIC S USER=$P(Y,"^",2)
"RTN","RGMTAUDP",124,0)
 ...S OLD=$G(^DIA(2,IEN,2)) I OLD']"" S OLD="<no previous value>"
"RTN","RGMTAUDP",125,0)
 ...S NEW=$G(^DIA(2,IEN,3)) I NEW']"" S NEW="<no current value>"
"RTN","RGMTAUDP",126,0)
 ...K OPTDA1,OPTDA2,OPTION,OPTNM I $G(^DIA(2,IEN,4.1)) D
"RTN","RGMTAUDP",127,0)
 ....S OPTDA1=+$P(^DIA(2,IEN,4.1),"^")
"RTN","RGMTAUDP",128,0)
 ....I OPTDA1 S DIC=19,DR=".01",DA=OPTDA1,DIQ(0)="EI",DIQ="OPTION" D EN^DIQ1 K DIC,DR,DA,DIQ S OPTION=$G(OPTION(19,OPTDA1,.01,"E"))
"RTN","RGMTAUDP",129,0)
 ....S OPTDA2=$P(^DIA(2,IEN,4.1),"^",2)
"RTN","RGMTAUDP",130,0)
 ....I $P(OPTDA2,";",2)="ORD(101," S DIC=101,DR=".01",DA=+OPTDA2,DIQ(0)="EI",DIQ="OPTION" D EN^DIQ1 K DIC,DR,DA,DIQ S OPTNM=$G(OPTION(101,+OPTDA2,.01,"E")) Q
"RTN","RGMTAUDP",131,0)
 ....I +OPTDA2 S DIC=19,DR=".01",DA=+OPTDA2,DIQ(0)="EI",DIQ="OPTION" D EN^DIQ1 K DIC,DR,DA,DIQ S OPTNM=$G(OPTION(19,+OPTDA2,.01,"E")) Q
"RTN","RGMTAUDP",132,0)
 ...D:$Y+5>IOSL HDR Q:QFLG  W !!,PRTDT,?20,FLD,?51,USER,!?20,OLD," / ",NEW
"RTN","RGMTAUDP",133,0)
 ...I $G(OPTION)'="" W !?3,OPTION I $G(OPTNM)'="" W "/",OPTNM
"RTN","RGMTAUDP",134,0)
 I $D(^TMP("RGMTAUDP2",$J,"NO AUDIT")) D
"RTN","RGMTAUDP",135,0)
 . S PATNM="@@@@",RGNAUD="" F  S PATNM=$O(^TMP("RGMTAUDP2",$J,"NO AUDIT",PATNM)) Q:PATNM=""  D
"RTN","RGMTAUDP",136,0)
 .. Q:QFLG
"RTN","RGMTAUDP",137,0)
 .. S RGNAUD=$P(^TMP("RGMTAUDP2",$J,"NO AUDIT",PATNM),U)
"RTN","RGMTAUDP",138,0)
 .. W !!,"==> ",$P(PATNM,U),"  (DFN #",$P(PATNM,U,2),")"_RGNAUD
"RTN","RGMTAUDP",139,0)
 ;
"RTN","RGMTAUDP",140,0)
QUIT ;
"RTN","RGMTAUDP",141,0)
 I $E(IOST,1,2)="C-"&('QFLG) S DIR(0)="E" D  D ^DIR K DIR
"RTN","RGMTAUDP",142,0)
 .S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTAUDP",143,0)
 K ^TMP("RGMTAUDP",$J),^TMP("RGMTAUDP2",$J)
"RTN","RGMTAUDP",144,0)
 K %,%I,ANS1,ANS2,C,CNT,RGDFN,DIR,DIRUT,DTOUT,DUOUT,EDITDT,FLD,FLDLP,FLDNM,HDR
"RTN","RGMTAUDP",145,0)
 K HDT,IEN,IEN0,JJ,LN,NEW,OLD,OPTDA1,OPTDA2,OPTION,OPTNM,PAT,PATNM,PG,PRGBDT,PRGEDT,PRTDT,QFLG,QQ,RGARR,RGBDT,RGNAUD
"RTN","RGMTAUDP",146,0)
 K RGEDT,RGERR,SITE,SS,STOP,USER,X,Y,ZTSK
"RTN","RGMTAUDP",147,0)
 D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@" Q
"RTN","RGMTAUDP",148,0)
 ;
"RTN","RGMTAUDP",149,0)
HDR ;HEADER
"RTN","RGMTAUDP",150,0)
 I $E(IOST,1,2)="C-" S SS=22-$Y F JJ=1:1:SS W !
"RTN","RGMTAUDP",151,0)
 I $E(IOST,1,2)="C-",PG>0 S DIR(0)="E" W ! D ^DIR K DIR I 'Y S QFLG=1 Q
"RTN","RGMTAUDP",152,0)
 S PG=PG+1 W:$Y!($E(IOST,1,2)="C-") @IOF
"RTN","RGMTAUDP",153,0)
 W !,"PATIENT AUDIT LIST at ",SITE," on ",HDT,?72,"Page: ",PG
"RTN","RGMTAUDP",154,0)
 W !,"Date Range: ",PRGBDT," to ",PRGEDT
"RTN","RGMTAUDP",155,0)
 W !!,"Date/Time Edited",?20,"Field Edited",?51,"Edited By",!?20,"Old Value / New Value"
"RTN","RGMTAUDP",156,0)
 W !?3,"Option/Protocol",!,LN
"RTN","RGMTAUDP",157,0)
 Q
"RTN","RGMTAUDP",158,0)
 ;
"RTN","RGMTAUDP",159,0)
FLDLIST ;Help for Field # List
"RTN","RGMTAUDP",160,0)
 K RG N DIR S QFLG=0 I RGERR W $C(7)," ??"
"RTN","RGMTAUDP",161,0)
 S HDR="Select a FIELD NUMBER from the audited field(s) in the PATIENT file:"
"RTN","RGMTAUDP",162,0)
 W @IOF,HDR,!
"RTN","RGMTAUDP",163,0)
 S FLDLP=0 F  S FLDLP=$O(^DD(2,"AUDIT",FLDLP)) Q:'FLDLP  Q:QFLG  D
"RTN","RGMTAUDP",164,0)
 .I $Y+6>IOSL D  Q:QFLG
"RTN","RGMTAUDP",165,0)
 ..S DIR(0)="E" W ! D ^DIR K DIR I 'Y S QFLG=1 Q
"RTN","RGMTAUDP",166,0)
 ..E  W @IOF,HDR,!
"RTN","RGMTAUDP",167,0)
 .K RGARR D FIELD^DID(2,FLDLP,"","LABEL","RGARR")
"RTN","RGMTAUDP",168,0)
 .S FLDNM=$G(RGARR("LABEL")) Q:FLDNM=""
"RTN","RGMTAUDP",169,0)
 .W !,FLDLP,?13,FLDNM
"RTN","RGMTAUDP",170,0)
 Q
"VER")
8.0^22.0
"BLD",6668,6)
^44
**END**
**END**
